(function(){this.MooTools={version:"1.3.1dev",build:"%build%"};var o=this.typeOf=function(s){if(s==null){return"null"}if(s.$family){return s.$family()}if(s.nodeName){if(s.nodeType==1){return"element"}if(s.nodeType==3){return(/\S/).test(s.nodeValue)?"textnode":"whitespace"}}else{if(typeof s.length=="number"){if(s.callee){return"arguments"}if("item" in s){return"collection"}}}return typeof s};var h=this.instanceOf=function(u,s){if(u==null){return false}var t=u.$constructor||u.constructor;while(t){if(t===s){return true}t=t.parent}return u instanceof s};var f=this.Function;var p=true;for(var j in {toString:1}){p=null}if(p){p=["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"]}f.prototype.overloadSetter=function(t){var s=this;return function(v,u){if(v==null){return this}if(t||typeof v!="string"){for(var w in v){s.call(this,w,v[w])}if(p){for(var y=p.length;y--;){w=p[y];if(v.hasOwnProperty(w)){s.call(this,w,v[w])}}}}else{s.call(this,v,u)}return this}};f.prototype.overloadGetter=function(t){var s=this;return function(v){var w,u;if(t||typeof v!="string"){w=v}else{if(arguments.length>1){w=arguments}}if(w){u={};for(var y=0;y<w.length;y++){u[w[y]]=s.call(this,w[y])}}else{u=s.call(this,v)}return u}};f.prototype.extend=function(s,t){this[s]=t}.overloadSetter();f.prototype.implement=function(s,t){this.prototype[s]=t}.overloadSetter();var m=Array.prototype.slice;f.from=function(s){return(o(s)=="function")?s:function(){return s}};Array.from=function(s){if(s==null){return[]}return(a.isEnumerable(s)&&typeof s!="string")?(o(s)=="array")?s:m.call(s):[s]};Number.from=function(t){var s=parseFloat(t);return isFinite(s)?s:null};String.from=function(s){return s+""};f.implement({hide:function(){this.$hidden=true;return this},protect:function(){this.$protected=true;return this}});var a=this.Type=function(v,u){if(v){var t=v.toLowerCase();var s=function(w){return(o(w)==t)};a["is"+v]=s;if(u!=null){u.prototype.$family=(function(){return t}).hide()}}if(u==null){return null}u.extend(this);u.$constructor=a;u.prototype.$constructor=u;return u};var e=Object.prototype.toString;a.isEnumerable=function(s){return(s!=null&&typeof s.length=="number"&&e.call(s)!="[object Function]")};var q={};var r=function(s){var t=o(s.prototype);return q[t]||(q[t]=[])};var b=function(t,y){if(y&&y.$hidden){return this}var s=r(this);for(var u=0;u<s.length;u++){var w=s[u];if(o(w)=="type"){b.call(w,t,y)}else{w.call(this,t,y)}}var v=this.prototype[t];if(v==null||!v.$protected){this.prototype[t]=y}if(this[t]==null&&o(y)=="function"){l.call(this,t,function(z){return y.apply(z,m.call(arguments,1))})}return this};var l=function(s,u){if(u&&u.$hidden){return this}var t=this[s];if(t==null||!t.$protected){this[s]=u}return this};a.implement({implement:b.overloadSetter(),extend:l.overloadSetter(),alias:function(s,t){b.call(this,s,this.prototype[t])}.overloadSetter(),mirror:function(s){r(this).push(s);return this}});new a("Type",a);var d=function(s,w,u){var t=(w!=Object),B=w.prototype;if(t){w=new a(s,w)}for(var y=0,v=u.length;y<v;y++){var C=u[y],A=w[C],z=B[C];if(A){A.protect()}if(t&&z){delete B[C];B[C]=z.protect()}}if(t){w.implement(B)}return d};d("String",String,["charAt","charCodeAt","concat","indexOf","lastIndexOf","match","quote","replace","search","slice","split","substr","substring","toLowerCase","toUpperCase"])("Array",Array,["pop","push","reverse","shift","sort","splice","unshift","concat","join","slice","indexOf","lastIndexOf","filter","forEach","every","map","some","reduce","reduceRight"])("Number",Number,["toExponential","toFixed","toLocaleString","toPrecision"])("Function",f,["apply","call","bind"])("RegExp",RegExp,["exec","test"])("Object",Object,["create","defineProperty","defineProperties","keys","getPrototypeOf","getOwnPropertyDescriptor","getOwnPropertyNames","preventExtensions","isExtensible","seal","isSealed","freeze","isFrozen"])("Date",Date,["now"]);Object.extend=l.overloadSetter();Date.extend("now",function(){return +(new Date)});new a("Boolean",Boolean);Number.prototype.$family=function(){return isFinite(this)?"number":"null"}.hide();Number.extend("random",function(t,s){return Math.floor(Math.random()*(s-t+1)+t)});Object.extend("forEach",function(s,u,v){for(var t in s){if(s.hasOwnProperty(t)){u.call(v,s[t],t,s)}}});Object.each=Object.forEach;Array.implement({forEach:function(u,v){for(var t=0,s=this.length;t<s;t++){if(t in this){u.call(v,this[t],t,this)}}},each:function(s,t){Array.forEach(this,s,t);return this}});var k=function(s){switch(o(s)){case"array":return s.clone();case"object":return Object.clone(s);default:return s}};Array.implement("clone",function(){var s=this.length,t=new Array(s);while(s--){t[s]=k(this[s])}return t});var g=function(t,s,u){switch(o(u)){case"object":if(o(t[s])=="object"){Object.merge(t[s],u)}else{t[s]=Object.clone(u)}break;case"array":t[s]=u.clone();break;default:t[s]=u}return t};Object.extend({merge:function(A,u,t){if(o(u)=="string"){return g(A,u,t)}for(var z=1,s=arguments.length;z<s;z++){var w=arguments[z];for(var y in w){g(A,y,w[y])}}return A},clone:function(s){var u={};for(var t in s){u[t]=k(s[t])}return u},append:function(w){for(var v=1,t=arguments.length;v<t;v++){var s=arguments[v]||{};for(var u in s){w[u]=s[u]}}return w}});["Object","WhiteSpace","TextNode","Collection","Arguments"].each(function(s){new a(s)});var c=Date.now();String.extend("uniqueID",function(){return(c++).toString(36)})})();Array.implement({invoke:function(a){var b=Array.slice(arguments,1);return this.map(function(c){return c[a].apply(c,b)})},every:function(c,d){for(var b=0,a=this.length;b<a;b++){if((b in this)&&!c.call(d,this[b],b,this)){return false}}return true},filter:function(d,e){var c=[];for(var b=0,a=this.length;b<a;b++){if((b in this)&&d.call(e,this[b],b,this)){c.push(this[b])}}return c},clean:function(){return this.filter(function(a){return a!=null})},indexOf:function(c,d){var a=this.length;for(var b=(d<0)?Math.max(0,a+d):d||0;b<a;b++){if(this[b]===c){return b}}return -1},map:function(d,e){var c=[];for(var b=0,a=this.length;b<a;b++){if(b in this){c[b]=d.call(e,this[b],b,this)}}return c},some:function(c,d){for(var b=0,a=this.length;b<a;b++){if((b in this)&&c.call(d,this[b],b,this)){return true}}return false},associate:function(c){var d={},b=Math.min(this.length,c.length);for(var a=0;a<b;a++){d[c[a]]=this[a]}return d},link:function(c){var a={};for(var e=0,b=this.length;e<b;e++){for(var d in c){if(c[d](this[e])){a[d]=this[e];delete c[d];break}}}return a},contains:function(a,b){return this.indexOf(a,b)!=-1},append:function(a){this.push.apply(this,a);return this},getLast:function(){return(this.length)?this[this.length-1]:null},getRandom:function(){return(this.length)?this[Number.random(0,this.length-1)]:null},include:function(a){if(!this.contains(a)){this.push(a)}return this},combine:function(c){for(var b=0,a=c.length;b<a;b++){this.include(c[b])}return this},erase:function(b){for(var a=this.length;a--;){if(this[a]===b){this.splice(a,1)}}return this},empty:function(){this.length=0;return this},flatten:function(){var d=[];for(var b=0,a=this.length;b<a;b++){var c=typeOf(this[b]);if(c=="null"){continue}d=d.concat((c=="array"||c=="collection"||c=="arguments"||instanceOf(this[b],Array))?Array.flatten(this[b]):this[b])}return d},pick:function(){for(var b=0,a=this.length;b<a;b++){if(this[b]!=null){return this[b]}}return null},hexToRgb:function(b){if(this.length!=3){return null}var a=this.map(function(c){if(c.length==1){c+=c}return c.toInt(16)});return(b)?a:"rgb("+a+")"},rgbToHex:function(d){if(this.length<3){return null}if(this.length==4&&this[3]==0&&!d){return"transparent"}var b=[];for(var a=0;a<3;a++){var c=(this[a]-0).toString(16);b.push((c.length==1)?"0"+c:c)}return(d)?b:"#"+b.join("")}});var Event=new Type("Event",function(a,j){if(!j){j=window}var q=j.document;a=a||j.event;if(a.$extended){return a}this.$extended=true;var p=a.type,l=a.target||a.srcElement,o={},c={};while(l&&l.nodeType==3){l=l.parentNode}if(p.indexOf("key")!=-1){var b=a.which||a.keyCode;var s=Object.keyOf(Event.Keys,b);if(p=="keydown"){var d=b-111;if(d>0&&d<13){s="f"+d}}if(!s){s=String.fromCharCode(b).toLowerCase()}}else{if((/click|mouse|menu/i).test(p)){q=(!q.compatMode||q.compatMode=="CSS1Compat")?q.html:q.body;o={x:(a.pageX!=null)?a.pageX:a.clientX+q.scrollLeft,y:(a.pageY!=null)?a.pageY:a.clientY+q.scrollTop};c={x:(a.pageX!=null)?a.pageX-j.pageXOffset:a.clientX,y:(a.pageY!=null)?a.pageY-j.pageYOffset:a.clientY};if((/DOMMouseScroll|mousewheel/).test(p)){var m=(a.wheelDelta)?a.wheelDelta/120:-(a.detail||0)/3}var h=(a.which==3)||(a.button==2),r=null;if((/over|out/).test(p)){r=a.relatedTarget||a[(p=="mouseover"?"from":"to")+"Element"];var k=function(){while(r&&r.nodeType==3){r=r.parentNode}return true};var g=(Browser.firefox2)?k.attempt():k();r=(g)?r:null}}else{if((/gesture|touch/i).test(p)){this.rotation=a.rotation;this.scale=a.scale;this.targetTouches=a.targetTouches;this.changedTouches=a.changedTouches;var f=this.touches=a.touches;if(f&&f[0]){var e=f[0];o={x:e.pageX,y:e.pageY};c={x:e.clientX,y:e.clientY}}}else{if((/drag(enter|leave|over)|drop/i).test(p)){this.dataTransfer=a.dataTransfer}}}}return Object.append(this,{event:a,type:p,page:o,client:c,rightClick:h,wheel:m,relatedTarget:document.id(r),target:document.id(l),code:b,key:s,shift:a.shiftKey,control:a.ctrlKey,alt:a.altKey,meta:a.metaKey})});Event.Keys={enter:13,up:38,down:40,left:37,right:39,esc:27,space:32,backspace:8,tab:9,"delete":46};Event.implement({stop:function(){return this.stopPropagation().preventDefault()},stopPropagation:function(){if(this.event.stopPropagation){this.event.stopPropagation()}else{this.event.cancelBubble=true}return this},preventDefault:function(){if(this.event.preventDefault){this.event.preventDefault()}else{this.event.returnValue=false}return this}});Function.extend({attempt:function(){for(var b=0,a=arguments.length;b<a;b++){try{return arguments[b]()}catch(c){}}return null}});Function.implement({attempt:function(a,c){try{return this.apply(c,Array.from(a))}catch(b){}return null},bind:function(c){var a=this,b=(arguments.length>1)?Array.slice(arguments,1):null;return function(){if(!b&&!arguments.length){return a.call(c)}if(b&&arguments.length){return a.apply(c,b.concat(Array.from(arguments)))}return a.apply(c,b||arguments)}},pass:function(b,c){var a=this;if(b!=null){b=Array.from(b)}return function(){return a.apply(c,b||arguments)}},delay:function(b,c,a){return setTimeout(this.pass((a==null?[]:a),c),b)},periodical:function(c,b,a){return setInterval(this.pass((a==null?[]:a),b),c)}});Number.implement({limit:function(b,a){return Math.min(a,Math.max(b,this))},round:function(a){a=Math.pow(10,a||0).toFixed(a<0?-a:0);return Math.round(this*a)/a},times:function(b,c){for(var a=0;a<this;a++){b.call(c,a,this)}},toFloat:function(){return parseFloat(this)},toInt:function(a){return parseInt(this,a||10)}});Number.alias("each","times");(function(b){var a={};b.each(function(c){if(!Number[c]){a[c]=function(){return Math[c].apply(null,[this].concat(Array.from(arguments)))}}});Number.implement(a)})(["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","log","max","min","pow","sin","sqrt","tan"]);Object.extend({subset:function(c,f){var e={};for(var d=0,a=f.length;d<a;d++){var b=f[d];e[b]=c[b]}return e},map:function(a,d,e){var c={};for(var b in a){if(a.hasOwnProperty(b)){c[b]=d.call(e,a[b],b,a)}}return c},filter:function(a,c,d){var b={};Object.each(a,function(f,e){if(c.call(d,f,e,a)){b[e]=f}});return b},every:function(a,c,d){for(var b in a){if(a.hasOwnProperty(b)&&!c.call(d,a[b],b)){return false}}return true},some:function(a,c,d){for(var b in a){if(a.hasOwnProperty(b)&&c.call(d,a[b],b)){return true}}return false},keys:function(a){var c=[];for(var b in a){if(a.hasOwnProperty(b)){c.push(b)}}return c},values:function(b){var a=[];for(var c in b){if(b.hasOwnProperty(c)){a.push(b[c])}}return a},getLength:function(a){return Object.keys(a).length},keyOf:function(a,c){for(var b in a){if(a.hasOwnProperty(b)&&a[b]===c){return b}}return null},contains:function(a,b){return Object.keyOf(a,b)!=null},toQueryString:function(a,b){var c=[];Object.each(a,function(g,f){if(b){f=b+"["+f+"]"}var e;switch(typeOf(g)){case"object":e=Object.toQueryString(g,f);break;case"array":var d={};g.each(function(j,h){d[h]=j});e=Object.toQueryString(d,f);break;default:e=f+"="+encodeURIComponent(g)}if(g!=null){c.push(e)}});return c.join("&")}});String.implement({test:function(a,b){return((typeOf(a)=="regexp")?a:new RegExp(""+a,b)).test(this)},contains:function(a,b){return(b)?(b+this+b).indexOf(b+a+b)>-1:this.indexOf(a)>-1},trim:function(){return this.replace(/^\s+|\s+$/g,"")},clean:function(){return this.replace(/\s+/g," ").trim()},camelCase:function(){return this.replace(/-\D/g,function(a){return a.charAt(1).toUpperCase()})},hyphenate:function(){return this.replace(/[A-Z]/g,function(a){return("-"+a.charAt(0).toLowerCase())})},capitalize:function(){return this.replace(/\b[a-z]/g,function(a){return a.toUpperCase()})},escapeRegExp:function(){return this.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")},toInt:function(a){return parseInt(this,a||10)},toFloat:function(){return parseFloat(this)},hexToRgb:function(b){var a=this.match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/);return(a)?a.slice(1).hexToRgb(b):null},rgbToHex:function(b){var a=this.match(/\d{1,3}/g);return(a)?a.rgbToHex(b):null},substitute:function(a,b){return this.replace(b||(/\\?\{([^{}]+)\}/g),function(d,c){if(d.charAt(0)=="\\"){return d.slice(1)}return(a[c]!=null)?a[c]:""})}});(function(){var l,p,m,g,a={},c={},o=/\\/g;var e=function(s,r){if(s==null){return null}if(s.Slick===true){return s}s=(""+s).replace(/^\s+|\s+$/g,"");g=!!r;var q=(g)?c:a;if(q[s]){return q[s]}l={Slick:true,expressions:[],raw:s,reverse:function(){return e(this.raw,true)}};p=-1;while(s!=(s=s.replace(k,b))){}l.length=l.expressions.length;return q[s]=(g)?h(l):l};var j=function(q){if(q==="!"){return" "}else{if(q===" "){return"!"}else{if((/^!/).test(q)){return q.replace(/^!/,"")}else{return"!"+q}}}};var h=function(w){var t=w.expressions;for(var r=0;r<t.length;r++){var v=t[r];var s={parts:[],tag:"*",combinator:j(v[0].combinator)};for(var q=0;q<v.length;q++){var u=v[q];if(!u.reverseCombinator){u.reverseCombinator=" "}u.combinator=u.reverseCombinator;delete u.reverseCombinator}v.reverse().push(s)}return w};var f=function(q){return q.replace(/[-[\]{}()*+?.\\^$|,#\s]/g,"\\$&")};var k=new RegExp("^(?:\\s*(,)\\s*|\\s*(<combinator>+)\\s*|(\\s+)|(<unicode>+|\\*)|\\#(<unicode>+)|\\.(<unicode>+)|\\[\\s*(<unicode1>+)(?:\\s*([*^$!~|]?=)(?:\\s*(?:([\"']?)(.*?)\\9)))?\\s*\\](?!\\])|:+(<unicode>+)(?:\\((?:(?:([\"'])([^\\12]*)\\12)|((?:\\([^)]+\\)|[^()]*)+))\\))?)".replace(/<combinator>/,"["+f(">+~`!@$%^&={}\\;</")+"]").replace(/<unicode>/g,"(?:[\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])").replace(/<unicode1>/g,"(?:[:\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])"));function b(A,u,G,C,t,F,s,E,D,B,w,I,y,r,z){if(u||p===-1){l.expressions[++p]=[];m=-1;if(u){return""}}if(G||C||m===-1){G=G||" ";var v=l.expressions[p];if(g&&v[m]){v[m].reverseCombinator=j(G)}v[++m]={combinator:G,tag:"*"}}var q=l.expressions[p][m];if(t){q.tag=t.replace(o,"")}else{if(F){q.id=F.replace(o,"")}else{if(s){s=s.replace(o,"");if(!q.classList){q.classList=[]}if(!q.classes){q.classes=[]}q.classList.push(s);q.classes.push({value:s,regexp:new RegExp("(^|\\s)"+f(s)+"(\\s|$)")})}else{if(I){z=z||r;z=z?z.replace(o,""):null;if(!q.pseudos){q.pseudos=[]}q.pseudos.push({key:I.replace(o,""),value:z})}else{if(E){E=E.replace(o,"");w=(w||"").replace(o,"");var H,J;switch(D){case"^=":J=new RegExp("^"+f(w));break;case"$=":J=new RegExp(f(w)+"$");break;case"~=":J=new RegExp("(^|\\s)"+f(w)+"(\\s|$)");break;case"|=":J=new RegExp("^"+f(w)+"(-|$)");break;case"=":H=function(K){return w==K};break;case"*=":H=function(K){return K&&K.indexOf(w)>-1};break;case"!=":H=function(K){return w!=K};break;default:H=function(K){return !!K}}if(w==""&&(/^[*$^]=$/).test(D)){H=function(){return false}}if(!H){H=function(K){return K&&J.test(K)}}if(!q.attributes){q.attributes=[]}q.attributes.push({key:E,operator:D,value:w,test:H})}}}}}return""}var d=(this.Slick||{});d.parse=function(q){return e(q)};d.escapeRegExp=f;if(!this.Slick){this.Slick=d}}).apply(this);(function(){var b={};b.isNativeCode=function(c){return(/\{\s*\[native code\]\s*\}/).test(""+c)};b.isXML=function(c){return(!!c.xmlVersion)||(!!c.xml)||(Object.prototype.toString.call(c)==="[object XMLDocument]")||(c.nodeType===9&&c.documentElement.nodeName!=="HTML")};b.setDocument=function(p){if(p.nodeType===9){}else{if(p.ownerDocument){p=p.ownerDocument}else{if(p.navigator){p=p.document}else{return}}}if(this.document===p){return}this.document=p;var q=this.root=p.documentElement;this.isXMLDocument=this.isXML(p);this.brokenStarGEBTN=this.starSelectsClosedQSA=this.idGetsName=this.brokenMixedCaseQSA=this.brokenGEBCN=this.brokenCheckedQSA=this.brokenEmptyAttributeQSA=this.isHTMLDocument=false;var j,k,r,l;var m,c;var s=p.createElement("div");q.appendChild(s);try{c="slick_getbyid_test";s.innerHTML='<a id="'+c+'"></a>';this.isHTMLDocument=!!p.getElementById(c)}catch(o){}if(this.isHTMLDocument){s.style.display="none";s.appendChild(p.createComment(""));k=(s.getElementsByTagName("*").length>0);try{s.innerHTML="foo</foo>";m=s.getElementsByTagName("*");j=(m&&m.length&&m[0].nodeName.charAt(0)=="/")}catch(o){}this.brokenStarGEBTN=k||j;if(s.querySelectorAll){try{s.innerHTML="foo</foo>";m=s.querySelectorAll("*");this.starSelectsClosedQSA=(m&&m.length&&m[0].nodeName.charAt(0)=="/")}catch(o){}}try{c="slick_id_gets_name";s.innerHTML='<a name="'+c+'"></a><b id="'+c+'"></b>';this.idGetsName=p.getElementById(c)===s.firstChild}catch(o){}try{s.innerHTML='<a class="MiXedCaSe"></a>';this.brokenMixedCaseQSA=!s.querySelectorAll(".MiXedCaSe").length}catch(o){}try{s.innerHTML='<a class="f"></a><a class="b"></a>';s.getElementsByClassName("b").length;s.firstChild.className="b";l=(s.getElementsByClassName("b").length!=2)}catch(o){}try{s.innerHTML='<a class="a"></a><a class="f b a"></a>';r=(s.getElementsByClassName("a").length!=2)}catch(o){}this.brokenGEBCN=l||r;try{s.innerHTML='<select><option selected="selected">a</option></select>';this.brokenCheckedQSA=(s.querySelectorAll(":checked").length==0)}catch(o){}try{s.innerHTML='<a class=""></a>';this.brokenEmptyAttributeQSA=(s.querySelectorAll('[class*=""]').length!=0)}catch(o){}}q.removeChild(s);s=null;this.hasAttribute=(q&&this.isNativeCode(q.hasAttribute))?function(u,t){return u.hasAttribute(t)}:function(u,t){u=u.getAttributeNode(t);return !!(u&&(u.specified||u.nodeValue))};this.contains=(q&&this.isNativeCode(q.contains))?function(t,u){return t.contains(u)}:(q&&q.compareDocumentPosition)?function(t,u){return t===u||!!(t.compareDocumentPosition(u)&16)}:function(t,u){if(u){do{if(u===t){return true}}while((u=u.parentNode))}return false};this.documentSorter=(q.compareDocumentPosition)?function(u,t){if(!u.compareDocumentPosition||!t.compareDocumentPosition){return 0}return u.compareDocumentPosition(t)&4?-1:u===t?0:1}:("sourceIndex" in q)?function(u,t){if(!u.sourceIndex||!t.sourceIndex){return 0}return u.sourceIndex-t.sourceIndex}:(p.createRange)?function(w,u){if(!w.ownerDocument||!u.ownerDocument){return 0}var v=w.ownerDocument.createRange(),t=u.ownerDocument.createRange();v.setStart(w,0);v.setEnd(w,0);t.setStart(u,0);t.setEnd(u,0);return v.compareBoundaryPoints(Range.START_TO_END,t)}:null;this.getUID=(this.isHTMLDocument)?this.getUIDHTML:this.getUIDXML};b.search=function(k,y,G,q){var w=this.found=(q)?null:(G||[]);if(!k){return w}if(k.navigator){k=k.document}else{if(!k.nodeType){return w}}var t,F;var o=this.uniques={};if(this.document!==(k.ownerDocument||k)){this.setDocument(k)}var z=!!(G&&G.length);if(z){for(F=w.length;F--;){this.uniques[this.getUID(w[F])]=true}}if(typeof y=="string"){for(F=this.overrides.length;F--;){var u=this.overrides[F];if(u.regexp.test(y)){var v=u.method.call(k,y,w,q);if(v===false){continue}if(v===true){return w}return v}}t=this.Slick.parse(y);if(!t.length){return w}}else{if(y==null){return w}else{if(y.Slick){t=y}else{if(this.contains(k.documentElement||k,y)){(w)?w.push(y):w=y;return w}else{return w}}}}this.posNTH={};this.posNTHLast={};this.posNTHType={};this.posNTHTypeLast={};this.push=(!z&&(q||(t.length==1&&t.expressions[0].length==1)))?this.pushArray:this.pushUID;if(w==null){w=[]}var E,C,B;var D,L,A,K,H,s,p;var r,l,c,I,J=t.expressions;search:for(F=0;(l=J[F]);F++){for(E=0;(c=l[E]);E++){D="combinator:"+c.combinator;if(!this[D]){continue search}L=(this.isXMLDocument)?c.tag:c.tag.toUpperCase();A=c.id;K=c.classList;H=c.classes;s=c.attributes;p=c.pseudos;I=(E===(l.length-1));this.bitUniques={};if(I){this.uniques=o;this.found=w}else{this.uniques={};this.found=[]}if(E===0){this[D](k,L,A,H,s,p,K);if(q&&I&&w.length){break search}}else{if(q&&I){for(C=0,B=r.length;C<B;C++){this[D](r[C],L,A,H,s,p,K);if(w.length){break search}}}else{for(C=0,B=r.length;C<B;C++){this[D](r[C],L,A,H,s,p,K)}}}r=this.found}}if(z||(t.expressions.length>1)){this.sort(w)}return(q)?(w[0]||null):w};b.uidx=1;b.uidk="slick:uniqueid";b.getUIDXML=function(j){var c=j.getAttribute(this.uidk);if(!c){c=this.uidx++;j.setAttribute(this.uidk,c)}return c};b.getUIDHTML=function(c){return c.uniqueNumber||(c.uniqueNumber=this.uidx++)};b.sort=function(c){if(!this.documentSorter){return c}c.sort(this.documentSorter);return c};b.cacheNTH={};b.matchNTH=/^([+-]?\d*)?([a-z]+)?([+-]\d+)?$/;b.parseNTHArgument=function(m){var k=m.match(this.matchNTH);if(!k){return false}var l=k[2]||false;var j=k[1]||1;if(j=="-"){j=-1}var c=+k[3]||0;k=(l=="n")?{a:j,b:c}:(l=="odd")?{a:2,b:1}:(l=="even")?{a:2,b:0}:{a:0,b:j};return(this.cacheNTH[m]=k)};b.createNTHPseudo=function(l,j,c,k){return function(p,m){var r=this.getUID(p);if(!this[c][r]){var y=p.parentNode;if(!y){return false}var o=y[l],q=1;if(k){var w=p.nodeName;do{if(o.nodeName!==w){continue}this[c][this.getUID(o)]=q++}while((o=o[j]))}else{do{if(o.nodeType!==1){continue}this[c][this.getUID(o)]=q++}while((o=o[j]))}}m=m||"n";var s=this.cacheNTH[m]||this.parseNTHArgument(m);if(!s){return false}var v=s.a,u=s.b,t=this[c][r];if(v==0){return u==t}if(v>0){if(t<u){return false}}else{if(u<t){return false}}return((t-u)%v)==0}};b.pushArray=function(l,c,o,k,j,m){if(this.matchSelector(l,c,o,k,j,m)){this.found.push(l)}};b.pushUID=function(m,c,p,l,j,o){var k=this.getUID(m);if(!this.uniques[k]&&this.matchSelector(m,c,p,l,j,o)){this.uniques[k]=true;this.found.push(m)}};b.matchNode=function(o,c){var k=this.Slick.parse(c);if(!k){return true}if(k.length==1&&k.expressions[0].length==1){var p=k.expressions[0][0];return this.matchSelector(o,(this.isXMLDocument)?p.tag:p.tag.toUpperCase(),p.id,p.classes,p.attributes,p.pseudos)}var j=this.search(this.document,k);for(var l=0,m;m=j[l++];){if(m===o){return true}}return false};b.matchPseudo=function(m,c,l){var j="pseudo:"+c;if(this[j]){return this[j](m,l)}var k=this.getAttribute(m,c);return(l)?l==k:!!k};b.matchSelector=function(k,r,c,l,m,p){if(r){if(r=="*"){if(k.nodeName<"@"){return false}}else{if(k.nodeName!=r){return false}}}if(c&&k.getAttribute("id")!=c){return false}var o,j,q;if(l){for(o=l.length;o--;){q=("className" in k)?k.className:k.getAttribute("class");if(!(q&&l[o].regexp.test(q))){return false}}}if(m){for(o=m.length;o--;){j=m[o];if(j.operator?!j.test(this.getAttribute(k,j.key)):!this.hasAttribute(k,j.key)){return false}}}if(p){for(o=p.length;o--;){j=p[o];if(!this.matchPseudo(k,j.key,j.value)){return false}}}return true};var a={" ":function(l,s,c,m,o,q,k){var p,r,j;if(this.isHTMLDocument){getById:if(c){r=this.document.getElementById(c);if((!r&&l.all)||(this.idGetsName&&r&&r.getAttributeNode("id").nodeValue!=c)){j=l.all[c];if(!j){return}if(!j[0]){j=[j]}for(p=0;r=j[p++];){if(r.getAttributeNode("id").nodeValue==c){this.push(r,s,null,m,o,q);break}}return}if(!r){if(this.contains(this.document.documentElement,l)){return}else{break getById}}else{if(this.document!==l&&!this.contains(l,r)){return}}this.push(r,s,null,m,o,q);return}getByClass:if(m&&l.getElementsByClassName&&!this.brokenGEBCN){j=l.getElementsByClassName(k.join(" "));if(!(j&&j.length)){break getByClass}for(p=0;r=j[p++];){this.push(r,s,c,null,o,q)}return}}getByTag:{j=l.getElementsByTagName(s);if(!(j&&j.length)){break getByTag}if(!this.brokenStarGEBTN){s=null}for(p=0;r=j[p++];){this.push(r,s,c,m,o,q)}}},">":function(l,c,o,k,j,m){if((l=l.firstChild)){do{if(l.nodeType===1){this.push(l,c,o,k,j,m)}}while((l=l.nextSibling))}},"+":function(l,c,o,k,j,m){while((l=l.nextSibling)){if(l.nodeType===1){this.push(l,c,o,k,j,m);break}}},"^":function(l,c,o,k,j,m){l=l.firstChild;if(l){if(l.nodeType===1){this.push(l,c,o,k,j,m)}else{this["combinator:+"](l,c,o,k,j,m)}}},"~":function(m,c,p,l,j,o){while((m=m.nextSibling)){if(m.nodeType!==1){continue}var k=this.getUID(m);if(this.bitUniques[k]){break}this.bitUniques[k]=true;this.push(m,c,p,l,j,o)}},"++":function(l,c,o,k,j,m){this["combinator:+"](l,c,o,k,j,m);this["combinator:!+"](l,c,o,k,j,m)},"~~":function(l,c,o,k,j,m){this["combinator:~"](l,c,o,k,j,m);this["combinator:!~"](l,c,o,k,j,m)},"!":function(l,c,o,k,j,m){while((l=l.parentNode)){if(l!==this.document){this.push(l,c,o,k,j,m)}}},"!>":function(l,c,o,k,j,m){l=l.parentNode;if(l!==this.document){this.push(l,c,o,k,j,m)}},"!+":function(l,c,o,k,j,m){while((l=l.previousSibling)){if(l.nodeType===1){this.push(l,c,o,k,j,m);break}}},"!^":function(l,c,o,k,j,m){l=l.lastChild;if(l){if(l.nodeType===1){this.push(l,c,o,k,j,m)}else{this["combinator:!+"](l,c,o,k,j,m)}}},"!~":function(m,c,p,l,j,o){while((m=m.previousSibling)){if(m.nodeType!==1){continue}var k=this.getUID(m);if(this.bitUniques[k]){break}this.bitUniques[k]=true;this.push(m,c,p,l,j,o)}}};for(var h in a){b["combinator:"+h]=a[h]}var g={empty:function(c){var j=c.firstChild;return !(j&&j.nodeType==1)&&!(c.innerText||c.textContent||"").length},not:function(c,j){return !this.matchNode(c,j)},contains:function(c,j){return(c.innerText||c.textContent||"").indexOf(j)>-1},"first-child":function(c){while((c=c.previousSibling)){if(c.nodeType===1){return false}}return true},"last-child":function(c){while((c=c.nextSibling)){if(c.nodeType===1){return false}}return true},"only-child":function(k){var j=k;while((j=j.previousSibling)){if(j.nodeType===1){return false}}var c=k;while((c=c.nextSibling)){if(c.nodeType===1){return false}}return true},"nth-child":b.createNTHPseudo("firstChild","nextSibling","posNTH"),"nth-last-child":b.createNTHPseudo("lastChild","previousSibling","posNTHLast"),"nth-of-type":b.createNTHPseudo("firstChild","nextSibling","posNTHType",true),"nth-last-of-type":b.createNTHPseudo("lastChild","previousSibling","posNTHTypeLast",true),index:function(j,c){return this["pseudo:nth-child"](j,""+c+1)},even:function(j,c){return this["pseudo:nth-child"](j,"2n")},odd:function(j,c){return this["pseudo:nth-child"](j,"2n+1")},"first-of-type":function(c){var j=c.nodeName;while((c=c.previousSibling)){if(c.nodeName===j){return false}}return true},"last-of-type":function(c){var j=c.nodeName;while((c=c.nextSibling)){if(c.nodeName===j){return false}}return true},"only-of-type":function(k){var j=k,l=k.nodeName;while((j=j.previousSibling)){if(j.nodeName===l){return false}}var c=k;while((c=c.nextSibling)){if(c.nodeName===l){return false}}return true},enabled:function(c){return(c.disabled===false)},disabled:function(c){return(c.disabled===true)},checked:function(c){return c.checked||c.selected},focus:function(c){return this.isHTMLDocument&&this.document.activeElement===c&&(c.href||c.type||this.hasAttribute(c,"tabindex"))},root:function(c){return(c===this.root)},selected:function(c){return c.selected}};for(var d in g){b["pseudo:"+d]=g[d]}b.attributeGetters={"class":function(){return("className" in this)?this.className:this.getAttribute("class")},"for":function(){return("htmlFor" in this)?this.htmlFor:this.getAttribute("for")},href:function(){return("href" in this)?this.getAttribute("href",2):this.getAttribute("href")},style:function(){return(this.style)?this.style.cssText:this.getAttribute("style")}};b.getAttribute=function(k,c){var l=this.attributeGetters[c];if(l){return l.call(k)}var j=k.getAttributeNode(c);return j?j.nodeValue:null};b.overrides=[];b.override=function(c,j){this.overrides.push({regexp:c,method:j})};var f=/\[.*[*$^]=(?:["']{2})?\]/;b.override(/./,function(q,o,p){if(!this.querySelectorAll||this.nodeType!=9||!b.isHTMLDocument||b.brokenMixedCaseQSA||(b.brokenCheckedQSA&&q.indexOf(":checked")>-1)||(b.brokenEmptyAttributeQSA&&f.test(q))||e.disableQSA){return false}var j,m;try{if(p){return this.querySelector(q)||null}else{j=this.querySelectorAll(q)}}catch(k){return false}var l,c=!!(o.length);if(b.starSelectsClosedQSA){for(l=0;m=j[l++];){if(m.nodeName>"@"&&(!c||!b.uniques[b.getUIDHTML(m)])){o.push(m)}}}else{for(l=0;m=j[l++];){if(!c||!b.uniques[b.getUIDHTML(m)]){o.push(m)}}}if(c){b.sort(o)}return true});b.override(/^[\w-]+$|^\*$/,function(q,o,p){var j=q;if(j=="*"&&b.brokenStarGEBTN){return false}var k=this.getElementsByTagName(j);if(p){return k[0]||null}var l,m,c=!!(o.length);for(l=0;m=k[l++];){if(!c||!b.uniques[b.getUID(m)]){o.push(m)}}if(c){b.sort(o)}return true});b.override(/^\.[\w-]+$/,function(p,r,m){if(!b.isHTMLDocument||(!this.getElementsByClassName&&this.querySelectorAll)){return false}var c,k,l,j=!!(r&&r.length),q=p.substring(1);if(this.getElementsByClassName&&!b.brokenGEBCN){c=this.getElementsByClassName(q);if(m){return c[0]||null}for(l=0;k=c[l++];){if(!j||!b.uniques[b.getUIDHTML(k)]){r.push(k)}}}else{var o=new RegExp("(^|\\s)"+e.escapeRegExp(q)+"(\\s|$)");c=this.getElementsByTagName("*");for(l=0;k=c[l++];){q=k.className;if(!q||!o.test(q)){continue}if(m){return k}if(!j||!b.uniques[b.getUIDHTML(k)]){r.push(k)}}}if(j){b.sort(r)}return(m)?null:true});b.override(/^#[\w-]+$/,function(m,k,l){if(!b.isHTMLDocument||this.nodeType!=9){return false}var o=m.substring(1),j=this.getElementById(o);if(!j){return k}if(b.idGetsName&&j.getAttributeNode("id").nodeValue!=o){return false}if(l){return j||null}var c=!!(k.length);if(!c||!b.uniques[b.getUIDHTML(j)]){k.push(j)}if(c){b.sort(k)}return true});if(typeof document!="undefined"){b.setDocument(document)}var e=b.Slick=(this.Slick||{});e.version="0.9dev";e.search=function(j,k,c){return b.search(j,k,c)};e.find=function(c,j){return b.search(c,j,null,true)};e.contains=function(c,j){b.setDocument(c);return b.contains(c,j)};e.getAttribute=function(j,c){return b.getAttribute(j,c)};e.match=function(j,c){if(!(j&&c)){return false}if(!c||c===j){return true}if(typeof c!="string"){return false}b.setDocument(j);return b.matchNode(j,c)};e.defineAttributeGetter=function(c,j){b.attributeGetters[c]=j;return this};e.lookupAttributeGetter=function(c){return b.attributeGetters[c]};e.definePseudo=function(c,j){b["pseudo:"+c]=function(l,k){return j.call(l,k)};return this};e.lookupPseudo=function(c){var j=b["pseudo:"+c];if(j){return function(k){return j.call(this,k)}}return null};e.override=function(j,c){b.override(j,c);return this};e.isXML=b.isXML;e.uidOf=function(c){return b.getUIDHTML(c)};if(!this.Slick){this.Slick=e}}).apply(this);(function(){var document=this.document;var window=document.window=this;var UID=1;this.$uid=(window.ActiveXObject)?function(item){return(item.uid||(item.uid=[UID++]))[0]}:function(item){return item.uid||(item.uid=UID++)};$uid(window);$uid(document);var ua=navigator.userAgent.toLowerCase(),platform=navigator.platform.toLowerCase(),UA=ua.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],mode=UA[1]=="ie"&&document.documentMode;var Browser=this.Browser={extend:Function.prototype.extend,name:(UA[1]=="version")?UA[3]:UA[1],version:mode||parseFloat((UA[1]=="opera"&&UA[4])?UA[4]:UA[2]),Platform:{name:ua.match(/ip(?:ad|od|hone)/)?"ios":(ua.match(/(?:webos|android)/)||platform.match(/mac|win|linux/)||["other"])[0]},Features:{xpath:!!(document.evaluate),air:!!(window.runtime),query:!!(document.querySelector),json:!!(window.JSON)},Plugins:{}};Browser[Browser.name]=true;Browser[Browser.name+parseInt(Browser.version,10)]=true;Browser.Platform[Browser.Platform.name]=true;Browser.Request=(function(){var XMLHTTP=function(){return new XMLHttpRequest()};var MSXML2=function(){return new ActiveXObject("MSXML2.XMLHTTP")};var MSXML=function(){return new ActiveXObject("Microsoft.XMLHTTP")};return Function.attempt(function(){XMLHTTP();return XMLHTTP},function(){MSXML2();return MSXML2},function(){MSXML();return MSXML})})();Browser.Features.xhr=!!(Browser.Request);var version=(Function.attempt(function(){return navigator.plugins["Shockwave Flash"].description},function(){return new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")})||"0 r0").match(/\d+/g);Browser.Plugins.Flash={version:Number(version[0]||"0."+version[1])||0,build:Number(version[2])||0};Browser.exec=function(text,force){if(!text){return text}if(window.execScript){window.execScript(text)}else{if(Browser.firefox&&force){window.eval(text)}else{var script=document.createElement("script");script.setAttribute("type","text/javascript");script.text=text;document.head.appendChild(script);document.head.removeChild(script)}}return text};String.implement("stripScripts",function(exec,force){var scripts="";var text=this.replace(/<script([^>]*)>([\s\S]*?)<\/script>/gi,function(all,attribs,code){if(/type=['"]text\/html['"]/.test(attribs)&&exec===true){var script=document.createElement("script");script.setAttribute("type","text/html");if(/id=['"]([^'"]+)['"]/.test(attribs)){script.setAttribute("id",RegExp.$1)}script.text=code;document.head.appendChild(script);return""}scripts+=code+"\n";return""});if(exec===true){Browser.exec(scripts,force)}else{if(typeOf(exec)=="function"){exec(scripts,text)}}return text});Browser.extend({Document:this.Document,Window:this.Window,Element:this.Element,Event:this.Event});this.Window=this.$constructor=new Type("Window",function(){});this.$family=Function.from("window").hide();Window.mirror(function(name,method){window[name]=method});this.Document=document.$constructor=new Type("Document",function(){});document.$family=Function.from("document").hide();Document.mirror(function(name,method){document[name]=method});document.html=document.documentElement;document.head=document.getElementsByTagName("head")[0];if(document.execCommand){try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}}if(this.attachEvent&&!this.addEventListener){var unloadEvent=function(){this.detachEvent("onunload",unloadEvent);document.head=document.html=document.window=null};this.attachEvent("onunload",unloadEvent)}var arrayFrom=Array.from;try{arrayFrom(document.html.childNodes)}catch(e){Array.from=function(item){if(typeof item!="string"&&Type.isEnumerable(item)&&typeOf(item)!="array"){var i=item.length,array=new Array(i);while(i--){array[i]=item[i]}return array}return arrayFrom(item)};var prototype=Array.prototype,slice=prototype.slice;["pop","push","reverse","shift","sort","splice","unshift","concat","join","slice"].each(function(name){var method=prototype[name];Array[name]=function(item){return method.apply(Array.from(item),slice.call(arguments,1))}})}})();(function(){var a=this.Class=new Type("Class",function(h){if(instanceOf(h,Function)){h={initialize:h}}var g=function(){e(this);if(g.$prototyping){return this}this.$caller=null;var j=(this.initialize)?this.initialize.apply(this,arguments):this;this.$caller=this.caller=null;return j}.extend(this).implement(h);g.$constructor=a;g.prototype.$constructor=g;g.prototype.parent=c;return g});var c=function(){if(!this.$caller){throw new Error('The method "parent" cannot be called.')}var g=this.$caller.$name,h=this.$caller.$owner.parent,j=(h)?h.prototype[g]:null;if(!j){throw new Error('The method "'+g+'" has no parent.')}return j.apply(this,arguments)};var e=function(g){for(var h in g){var k=g[h];switch(typeOf(k)){case"object":var j=function(){};j.prototype=k;g[h]=e(new j);break;case"array":g[h]=k.clone();break}}return g};var b=function(g,h,k){if(k.$origin){k=k.$origin}var j=function(){if(k.$protected&&this.$caller==null){throw new Error('The method "'+h+'" cannot be called.')}var m=this.caller,o=this.$caller;this.caller=o;this.$caller=j;var l=k.apply(this,arguments);this.$caller=o;this.caller=m;return l}.extend({$owner:g,$origin:k,$name:h});return j};var f=function(h,j,g){if(a.Mutators.hasOwnProperty(h)){j=a.Mutators[h].call(this,j);if(j==null){return this}}if(typeOf(j)=="function"){if(j.$hidden){return this}this.prototype[h]=(g)?j:b(this,h,j)}else{Object.merge(this.prototype,h,j)}return this};var d=function(g){g.$prototyping=true;var h=new g;delete g.$prototyping;return h};a.implement("implement",f.overloadSetter());a.Mutators={Extends:function(g){this.parent=g;this.prototype=d(g)},Implements:function(g){Array.from(g).each(function(k){var h=new k;for(var j in h){f.call(this,j,h[j],true)}},this)}}})();(function(){this.Chain=new Class({$chain:[],chain:function(){this.$chain.append(Array.flatten(arguments));return this},callChain:function(){return(this.$chain.length)?this.$chain.shift().apply(this,arguments):false},clearChain:function(){this.$chain.empty();return this}});var a=function(b){return b.replace(/^on([A-Z])/,function(c,d){return d.toLowerCase()})};this.Events=new Class({$events:{},addEvent:function(d,c,b){d=a(d);this.$events[d]=(this.$events[d]||[]).include(c);if(b){c.internal=true}return this},addEvents:function(b){for(var c in b){this.addEvent(c,b[c])}return this},fireEvent:function(e,c,b){e=a(e);var d=this.$events[e];if(!d){return this}c=Array.from(c);d.each(function(f){if(b){f.delay(b,this,c)}else{f.apply(this,c)}},this);return this},removeEvent:function(e,d){e=a(e);var c=this.$events[e];if(c&&!d.internal){var b=c.indexOf(d);if(b!=-1){delete c[b]}}return this},removeEvents:function(d){var e;if(typeOf(d)=="object"){for(e in d){this.removeEvent(e,d[e])}return this}if(d){d=a(d)}for(e in this.$events){if(d&&d!=e){continue}var c=this.$events[e];for(var b=c.length;b--;){if(b in c){this.removeEvent(e,c[b])}}}return this}});this.Options=new Class({setOptions:function(){var b=this.options=Object.merge.apply(null,[{},this.options].append(arguments));if(this.addEvent){for(var c in b){if(typeOf(b[c])!="function"||!(/^on[A-Z]/).test(c)){continue}this.addEvent(c,b[c]);delete b[c]}}return this}})})();var Element=function(b,g){var h=Element.Constructors[b];if(h){return h(g)}if(typeof b!="string"){return document.id(b).set(g)}if(!g){g={}}if(!(/^[\w-]+$/).test(b)){var e=Slick.parse(b).expressions[0][0];b=(e.tag=="*")?"div":e.tag;if(e.id&&g.id==null){g.id=e.id}var d=e.attributes;if(d){for(var f=0,c=d.length;f<c;f++){var a=d[f];if(a.value!=null&&a.operator=="="&&g[a.key]==null){g[a.key]=a.value}}}if(e.classList&&g["class"]==null){g["class"]=e.classList.join(" ")}}return document.newElement(b,g)};if(Browser.Element){Element.prototype=Browser.Element.prototype}new Type("Element",Element).mirror(function(a){if(Array.prototype[a]){return}var b={};b[a]=function(){var h=[],e=arguments,j=true;for(var g=0,d=this.length;g<d;g++){var f=this[g],c=h[g]=f[a].apply(f,e);j=(j&&typeOf(c)=="element")}return(j)?new Elements(h):h};Elements.implement(b)});if(!Browser.Element){Element.parent=Object;Element.Prototype={"$family":Function.from("element").hide()};Element.mirror(function(a,b){Element.Prototype[a]=b})}Element.Constructors={};var IFrame=new Type("IFrame",function(){var e=Array.link(arguments,{properties:Type.isObject,iframe:function(f){return(f!=null)}});var c=e.properties||{},b;if(e.iframe){b=document.id(e.iframe)}var d=c.onload||function(){};delete c.onload;c.id=c.name=[c.id,c.name,b?(b.id||b.name):"IFrame_"+String.uniqueID()].pick();b=new Element(b||"iframe",c);var a=function(){d.call(b.contentWindow)};if(window.frames[c.id]){a()}else{b.addListener("load",a)}return b});var Elements=this.Elements=function(a){if(a&&a.length){var e={},d;for(var c=0;d=a[c++];){var b=Slick.uidOf(d);if(!e[b]){e[b]=true;this.push(d)}}}};Elements.prototype={length:0};Elements.parent=Array;new Type("Elements",Elements).implement({filter:function(a,b){if(!a){return this}return new Elements(Array.filter(this,(typeOf(a)=="string")?function(c){return c.match(a)}:a,b))}.protect(),push:function(){var d=this.length;for(var b=0,a=arguments.length;b<a;b++){var c=document.id(arguments[b]);if(c){this[d++]=c}}return(this.length=d)}.protect(),unshift:function(){var b=[];for(var c=0,a=arguments.length;c<a;c++){var d=document.id(arguments[c]);if(d){b.push(d)}}return Array.prototype.unshift.apply(this,b)}.protect(),concat:function(){var b=new Elements(this);for(var c=0,a=arguments.length;c<a;c++){var d=arguments[c];if(Type.isEnumerable(d)){b.append(d)}else{b.push(d)}}return b}.protect(),append:function(c){for(var b=0,a=c.length;b<a;b++){this.push(c[b])}return this}.protect(),empty:function(){while(this.length){delete this[--this.length]}return this}.protect()});(function(){var g=Array.prototype.splice,b={"0":0,"1":1,length:2};g.call(b,1,1);if(b[1]==1){Elements.implement("splice",function(){var e=this.length;g.apply(this,arguments);while(e>=this.length){delete this[e--]}return this}.protect())}Elements.implement(Array.prototype);Array.mirror(Elements);var f;try{var a=document.createElement("<input name=x>");f=(a.name=="x")}catch(c){}var d=function(e){return(""+e).replace(/&/g,"&amp;").replace(/"/g,"&quot;")};Document.implement({newElement:function(e,h){if(h&&h.checked!=null){h.defaultChecked=h.checked}if(f&&h){e="<"+e;if(h.name){e+=' name="'+d(h.name)+'"'}if(h.type){e+=' type="'+d(h.type)+'"'}e+=">";delete h.name;delete h.type}return this.id(this.createElement(e)).set(h)}})})();Document.implement({newTextNode:function(a){return this.createTextNode(a)},getDocument:function(){return this},getWindow:function(){return this.window},id:(function(){var a={string:function(d,c,b){d=Slick.find(b,"#"+d.replace(/(\W)/g,"\\$1"));return(d)?a.element(d,c):null},element:function(b,c){$uid(b);if(!c&&!b.$family&&!(/^(?:object|embed)$/i).test(b.tagName)){Object.append(b,Element.Prototype)}return b},object:function(c,d,b){if(c.toElement){return a.element(c.toElement(b),d)}return null}};a.textnode=a.whitespace=a.window=a.document=function(b){return b};return function(c,e,d){if(c&&c.$family&&c.uid){return c}var b=typeOf(c);return(a[b])?a[b](c,e,d||document):null}})()});if(window.$==null){Window.implement("$",function(a,b){return document.id(a,b,this.document)})}Window.implement({getDocument:function(){return this.document},getWindow:function(){return this}});[Document,Element].invoke("implement",{getElements:function(a){return Slick.search(this,a,new Elements)},getElement:function(a){return document.id(Slick.find(this,a))}});if(window.$$==null){Window.implement("$$",function(a){if(arguments.length==1){if(typeof a=="string"){return Slick.search(this.document,a,new Elements)}else{if(Type.isEnumerable(a)){return new Elements(a)}}}return new Elements(arguments)})}(function(){var l={},j={};var p={input:"checked",option:"selected",textarea:"value"};var e=function(r){return(j[r]||(j[r]={}))};var k=function(s){if(s.removeEvents){s.removeEvents()}if(s.clearAttributes){s.clearAttributes()}var r=s.uid;if(r!=null){delete l[r];delete j[r]}return s};var q=["defaultValue","accessKey","cellPadding","cellSpacing","colSpan","frameBorder","maxLength","readOnly","rowSpan","tabIndex","useMap"];var d=["compact","nowrap","ismap","declare","noshade","checked","disabled","readOnly","multiple","selected","noresize","defer","defaultChecked"];var g={html:"innerHTML","class":"className","for":"htmlFor",text:(function(){var r=document.createElement("div");return(r.innerText==null)?"textContent":"innerText"})()};var o=["type"];var h=["value","defaultValue"];var m=/^(?:href|src|usemap)$/i;d=d.associate(d);q=q.associate(q.map(String.toLowerCase));o=o.associate(o);Object.append(g,h.associate(h));var c={before:function(s,r){var t=r.parentNode;if(t){t.insertBefore(s,r)}},after:function(s,r){var t=r.parentNode;if(t){t.insertBefore(s,r.nextSibling)}},bottom:function(s,r){r.appendChild(s)},top:function(s,r){r.insertBefore(s,r.firstChild)}};c.inside=c.bottom;var b=function(u,t){if(!u){return t}u=Slick.parse(u);var s=u.expressions;for(var r=s.length;r--;){s[r][0].combinator=t}return u};Element.implement({set:function(t,s){var r=Element.Properties[t];(r&&r.set)?r.set.call(this,s):this.setProperty(t,s)}.overloadSetter(),get:function(s){var r=Element.Properties[s];return(r&&r.get)?r.get.apply(this):this.getProperty(s)}.overloadGetter(),erase:function(s){var r=Element.Properties[s];(r&&r.erase)?r.erase.apply(this):this.removeProperty(s);return this},setProperty:function(s,t){s=q[s]||s;if(t==null){return this.removeProperty(s)}var r=g[s];(r)?this[r]=t:(d[s])?this[s]=!!t:this.setAttribute(s,""+t);return this},setProperties:function(r){for(var s in r){this.setProperty(s,r[s])}return this},getProperty:function(s){s=q[s]||s;var r=g[s]||o[s];return(r)?this[r]:(d[s])?!!this[s]:(m.test(s)?this.getAttribute(s,2):(r=this.getAttributeNode(s))?r.nodeValue:null)||null},getProperties:function(){var r=Array.from(arguments);return r.map(this.getProperty,this).associate(r)},removeProperty:function(s){s=q[s]||s;var r=g[s];(r)?this[r]="":(d[s])?this[s]=false:this.removeAttribute(s);return this},removeProperties:function(){Array.each(arguments,this.removeProperty,this);return this},hasClass:function(r){return this.className.clean().contains(r," ")},addClass:function(r){if(!this.hasClass(r)){this.className=(this.className+" "+r).clean()}return this},removeClass:function(r){this.className=this.className.replace(new RegExp("(^|\\s)"+r+"(?:\\s|$)"),"$1");return this},toggleClass:function(r,s){if(s==null){s=!this.hasClass(r)}return(s)?this.addClass(r):this.removeClass(r)},adopt:function(){var u=this,r,w=Array.flatten(arguments),v=w.length;if(v>1){u=r=document.createDocumentFragment()}for(var t=0;t<v;t++){var s=document.id(w[t],true);if(s){u.appendChild(s)}}if(r){this.appendChild(r)}return this},appendText:function(s,r){return this.grab(this.getDocument().newTextNode(s),r)},grab:function(s,r){c[r||"bottom"](document.id(s,true),this);return this},inject:function(s,r){c[r||"bottom"](this,document.id(s,true));return this},replaces:function(r){r=document.id(r,true);r.parentNode.replaceChild(this,r);return this},wraps:function(s,r){s=document.id(s,true);return this.replaces(s).grab(s,r)},getPrevious:function(r){return document.id(Slick.find(this,b(r,"!~")))},getAllPrevious:function(r){return Slick.search(this,b(r,"!~"),new Elements)},getNext:function(r){return document.id(Slick.find(this,b(r,"~")))},getAllNext:function(r){return Slick.search(this,b(r,"~"),new Elements)},getFirst:function(r){return document.id(Slick.search(this,b(r,">"))[0])},getLast:function(r){return document.id(Slick.search(this,b(r,">")).getLast())},getParent:function(r){return document.id(Slick.find(this,b(r,"!")))},getParents:function(r){return Slick.search(this,b(r,"!"),new Elements)},getSiblings:function(r){return Slick.search(this,b(r,"~~"),new Elements)},getChildren:function(r){return Slick.search(this,b(r,">"),new Elements)},getWindow:function(){return this.ownerDocument.window},getDocument:function(){return this.ownerDocument},getElementById:function(r){return document.id(Slick.find(this,"#"+(""+r).replace(/(\W)/g,"\\$1")))},getSelected:function(){this.selectedIndex;return new Elements(Array.from(this.options).filter(function(r){return r.selected}))},toQueryString:function(){var r=[];this.getElements("input, select, textarea").each(function(t){var s=t.type;if(!t.name||t.disabled||s=="submit"||s=="reset"||s=="file"||s=="image"){return}var u=(t.get("tag")=="select")?t.getSelected().map(function(v){return document.id(v).get("value")}):((s=="radio"||s=="checkbox")&&!t.checked)?null:t.get("value");Array.from(u).each(function(v){if(typeof v!="undefined"){r.push(encodeURIComponent(t.name)+"="+encodeURIComponent(v))}})});return r.join("&")},destroy:function(){var r=k(this).getElementsByTagName("*");Array.each(r,k);Element.dispose(this);return null},empty:function(){Array.from(this.childNodes).each(Element.dispose);return this},dispose:function(){return(this.parentNode)?this.parentNode.removeChild(this):this},match:function(r){return !r||Slick.match(this,r)}});var a=function(w,v,t){var r=w.getAttributeNode("id");if(r){w.removeAttributeNode(r)}if(t){w.setAttribute("id",v.getAttribute("id"))}if(Browser.ie){w.clearAttributes();w.mergeAttributes(v);w.removeAttribute("uid");if(w.options){var y=w.options,s=v.options;for(var u=y.length;u--;){y[u].selected=s[u].selected}}}var z=p[v.tagName.toLowerCase()];if(z&&v[z]){w[z]=v[z]}};Element.implement("clone",function(t,r){t=t!==false;var z=this.cloneNode(t);if(t){var u=z.getElementsByTagName("*"),w=this.getElementsByTagName("*");for(var s=u.length;s--;){a(u[s],w[s],r)}}a(z,this,r);if(Browser.ie){var v=z.getElementsByTagName("object"),y=this.getElementsByTagName("object");for(var s=v.length;s--;){v[s].outerHTML=y[s].outerHTML}}return document.id(z)});var f={contains:function(r){return Slick.contains(this,r)}};if(!document.contains){Document.implement(f)}if(!document.createElement("div").contains){Element.implement(f)}[Element,Window,Document].invoke("implement",{addListener:function(u,t){if(u=="unload"){var r=t,s=this;t=function(){s.removeListener("unload",t);r()}}else{l[$uid(this)]=this}if(this.addEventListener){this.addEventListener(u,t,!!arguments[2])}else{this.attachEvent("on"+u,t)}return this},removeListener:function(s,r){if(this.removeEventListener){this.removeEventListener(s,r,!!arguments[2])}else{this.detachEvent("on"+s,r)}return this},retrieve:function(s,r){var u=e($uid(this)),t=u[s];if(r!=null&&t==null){t=u[s]=r}return t!=null?t:null},store:function(s,r){var t=e($uid(this));t[s]=r;return this},eliminate:function(r){var s=e($uid(this));delete s[r];return this}});if(window.attachEvent&&!window.addEventListener){window.addListener("unload",function(){Object.each(l,k);if(window.CollectGarbage){CollectGarbage()}})}})();Element.Properties={};Element.Properties.style={set:function(a){this.style.cssText=a},get:function(){return this.style.cssText},erase:function(){this.style.cssText=""}};Element.Properties.tag={get:function(){return this.tagName.toLowerCase()}};(function(a){if(a!=null){Element.Properties.maxlength=Element.Properties.maxLength={get:function(){var b=this.getAttribute("maxLength");return b==a?null:b}}}})(document.createElement("input").getAttribute("maxLength"));Element.Properties.html=(function(){var c=Function.attempt(function(){var e=document.createElement("table");e.innerHTML="<tr><td></td></tr>"});var d=document.createElement("div");var a={table:[1,"<table>","</table>"],select:[1,"<select>","</select>"],tbody:[2,"<table><tbody>","</tbody></table>"],tr:[3,"<table><tbody><tr>","</tr></tbody></table>"]};a.thead=a.tfoot=a.tbody;var b={set:function(){var f=Array.flatten(arguments).join("");var g=(!c&&a[this.get("tag")]);if(g){var h=d;h.innerHTML=g[1]+f+g[2];for(var e=g[0];e--;){h=h.firstChild}this.empty().adopt(h.childNodes)}else{this.innerHTML=f}}};b.erase=b.set;return b})();(function(){var c=document.html;Element.Properties.styles={set:function(f){this.setStyles(f)}};var e=(c.style.opacity!=null);var d=/alpha\(opacity=([\d.]+)\)/i;var b=function(g,f){if(!g.currentStyle||!g.currentStyle.hasLayout){g.style.zoom=1}if(e){g.style.opacity=f}else{f=(f==1)?"":"alpha(opacity="+f*100+")";var h=g.style.filter||g.getComputedStyle("filter")||"";g.style.filter=d.test(h)?h.replace(d,f):h+f}};Element.Properties.opacity={set:function(g){var f=this.style.visibility;if(g==0&&f!="hidden"){this.style.visibility="hidden"}else{if(g!=0&&f!="visible"){this.style.visibility="visible"}}b(this,g)},get:(e)?function(){var f=this.style.opacity||this.getComputedStyle("opacity");return(f=="")?1:f}:function(){var f,g=(this.style.filter||this.getComputedStyle("filter"));if(g){f=g.match(d)}return(f==null||g==null)?1:(f[1]/100)}};var a=(c.style.cssFloat==null)?"styleFloat":"cssFloat";Element.implement({getComputedStyle:function(h){if(this.currentStyle){return this.currentStyle[h.camelCase()]}var g=Element.getDocument(this).defaultView,f=g?g.getComputedStyle(this,null):null;return(f)?f.getPropertyValue((h==a)?"float":h.hyphenate()):null},setOpacity:function(f){b(this,f);return this},getOpacity:function(){return this.get("opacity")},setStyle:function(g,f){switch(g){case"opacity":return this.set("opacity",parseFloat(f));case"float":g=a}g=g.camelCase();if(typeOf(f)!="string"){var h=(Element.Styles[g]||"@").split(" ");f=Array.from(f).map(function(k,j){if(!h[j]){return""}return(typeOf(k)=="number")?h[j].replace("@",Math.round(k)):k}).join(" ")}else{if(f==String(Number(f))){f=Math.round(f)}}this.style[g]=f;return this},getStyle:function(m){switch(m){case"opacity":return this.get("opacity");case"float":m=a}m=m.camelCase();var f=this.style[m];if(!f||m=="zIndex"){f=[];for(var l in Element.ShortStyles){if(m!=l){continue}for(var k in Element.ShortStyles[l]){f.push(this.getStyle(k))}return f.join(" ")}f=this.getComputedStyle(m)}if(f){f=String(f);var h=f.match(/rgba?\([\d\s,]+\)/);if(h){f=f.replace(h[0],h[0].rgbToHex())}}if(Browser.opera||(Browser.ie&&isNaN(parseFloat(f)))){if((/^(height|width)$/).test(m)){var g=(m=="width")?["left","right"]:["top","bottom"],j=0;g.each(function(o){j+=this.getStyle("border-"+o+"-width").toInt()+this.getStyle("padding-"+o).toInt()},this);return this["offset"+m.capitalize()]-j+"px"}if(Browser.opera&&String(f).indexOf("px")!=-1){return f}if((/^border(.+)Width|margin|padding/).test(m)){return"0px"}}return f},setStyles:function(g){for(var f in g){this.setStyle(f,g[f])}return this},getStyles:function(){var f={};Array.flatten(arguments).each(function(g){f[g]=this.getStyle(g)},this);return f}});Element.Styles={left:"@px",top:"@px",bottom:"@px",right:"@px",width:"@px",height:"@px",maxWidth:"@px",maxHeight:"@px",minWidth:"@px",minHeight:"@px",backgroundColor:"rgb(@, @, @)",backgroundPosition:"@px @px",color:"rgb(@, @, @)",fontSize:"@px",letterSpacing:"@px",lineHeight:"@px",clip:"rect(@px @px @px @px)",margin:"@px @px @px @px",padding:"@px @px @px @px",border:"@px @ rgb(@, @, @) @px @ rgb(@, @, @) @px @ rgb(@, @, @)",borderWidth:"@px @px @px @px",borderStyle:"@ @ @ @",borderColor:"rgb(@, @, @) rgb(@, @, @) rgb(@, @, @) rgb(@, @, @)",zIndex:"@",zoom:"@",fontWeight:"@",textIndent:"@px",opacity:"@"};Element.ShortStyles={margin:{},padding:{},border:{},borderWidth:{},borderStyle:{},borderColor:{}};["Top","Right","Bottom","Left"].each(function(m){var l=Element.ShortStyles;var g=Element.Styles;["margin","padding"].each(function(o){var p=o+m;l[o][p]=g[p]="@px"});var k="border"+m;l.border[k]=g[k]="@px @ rgb(@, @, @)";var j=k+"Width",f=k+"Style",h=k+"Color";l[k]={};l.borderWidth[j]=l[k][j]=g[j]="@px";l.borderStyle[f]=l[k][f]=g[f]="@";l.borderColor[h]=l[k][h]=g[h]="rgb(@, @, @)"})})();(function(){var h=document.createElement("div"),e=document.createElement("div");h.style.height="0";h.appendChild(e);var d=(e.offsetParent===h);h=e=null;var m=function(o){return l(o,"position")!="static"||a(o)};var j=function(o){return m(o)||(/^(?:table|td|th)$/i).test(o.tagName)};Element.implement({scrollTo:function(o,p){if(a(this)){this.getWindow().scrollTo(o,p)}else{this.scrollLeft=o;this.scrollTop=p}return this},getSize:function(){if(a(this)){return this.getWindow().getSize()}return{x:this.offsetWidth,y:this.offsetHeight}},getScrollSize:function(){if(a(this)){return this.getWindow().getScrollSize()}return{x:this.scrollWidth,y:this.scrollHeight}},getScroll:function(){if(a(this)){return this.getWindow().getScroll()}return{x:this.scrollLeft,y:this.scrollTop}},getScrolls:function(){var p=this.parentNode,o={x:0,y:0};while(p&&!a(p)){o.x+=p.scrollLeft;o.y+=p.scrollTop;p=p.parentNode}return o},getOffsetParent:d?function(){var o=this;if(a(o)||l(o,"position")=="fixed"){return null}var p=(l(o,"position")=="static")?j:m;while((o=o.parentNode)){if(p(o)){return o}}return null}:function(){var o=this;if(a(o)||l(o,"position")=="fixed"){return null}try{return o.offsetParent}catch(p){}return null},getOffsets:function(){if(this.getBoundingClientRect&&!Browser.Platform.ios){var t=this.getBoundingClientRect(),q=document.id(this.getDocument().documentElement),s=q.getScroll(),v=this.getScrolls(),u=(l(this,"position")=="fixed");return{x:t.left.toInt()+v.x+((u)?0:s.x)-q.clientLeft,y:t.top.toInt()+v.y+((u)?0:s.y)-q.clientTop}}var p=this,o={x:0,y:0};if(a(this)){return o}while(p&&!a(p)){o.x+=p.offsetLeft;o.y+=p.offsetTop;if(Browser.firefox){if(!c(p)){o.x+=b(p);o.y+=g(p)}var r=p.parentNode;if(r&&l(r,"overflow")!="visible"){o.x+=b(r);o.y+=g(r)}}else{if(p!=this&&Browser.safari){o.x+=b(p);o.y+=g(p)}}p=p.offsetParent}if(Browser.firefox&&!c(this)){o.x-=b(this);o.y-=g(this)}return o},getPosition:function(r){if(a(this)){return{x:0,y:0}}var s=this.getOffsets(),p=this.getScrolls();var o={x:s.x-p.x,y:s.y-p.y};if(r&&(r=document.id(r))){var q=r.getPosition();return{x:o.x-q.x-b(r),y:o.y-q.y-g(r)}}return o},getCoordinates:function(q){if(a(this)){return this.getWindow().getCoordinates()}var o=this.getPosition(q),p=this.getSize();var r={left:o.x,top:o.y,width:p.x,height:p.y};r.right=r.left+r.width;r.bottom=r.top+r.height;return r},computePosition:function(o){return{left:o.x-k(this,"margin-left"),top:o.y-k(this,"margin-top")}},setPosition:function(o){return this.setStyles(this.computePosition(o))}});[Document,Window].invoke("implement",{getSize:function(){var o=f(this);return{x:o.clientWidth,y:o.clientHeight}},getScroll:function(){var p=this.getWindow(),o=f(this);return{x:p.pageXOffset||o.scrollLeft,y:p.pageYOffset||o.scrollTop}},getScrollSize:function(){var q=f(this),p=this.getSize(),o=this.getDocument().body;return{x:Math.max(q.scrollWidth,o.scrollWidth,p.x),y:Math.max(q.scrollHeight,o.scrollHeight,p.y)}},getPosition:function(){return{x:0,y:0}},getCoordinates:function(){var o=this.getSize();return{top:0,left:0,bottom:o.y,right:o.x,height:o.y,width:o.x}}});var l=Element.getComputedStyle;function k(o,p){return l(o,p).toInt()||0}function c(o){return l(o,"-moz-box-sizing")=="border-box"}function g(o){return k(o,"border-top-width")}function b(o){return k(o,"border-left-width")}function a(o){return(/^(?:body|html)$/i).test(o.tagName)}function f(o){var p=o.getDocument();return(!p.compatMode||p.compatMode=="CSS1Compat")?p.html:p.body}})();Element.alias({position:"setPosition"});[Window,Document,Element].invoke("implement",{getHeight:function(){return this.getSize().y},getWidth:function(){return this.getSize().x},getScrollTop:function(){return this.getScroll().y},getScrollLeft:function(){return this.getScroll().x},getScrollHeight:function(){return this.getScrollSize().y},getScrollWidth:function(){return this.getScrollSize().x},getTop:function(){return this.getPosition().y},getLeft:function(){return this.getPosition().x}});(function(){Element.Properties.events={set:function(c){this.addEvents(c)}};[Element,Window,Document].invoke("implement",{addEvent:function(g,j){var k=this.retrieve("events",{});if(!k[g]){k[g]={keys:[],values:[]}}if(k[g].keys.contains(j)){return this}k[g].keys.push(j);var h=g,c=Element.Events[g],e=j,l=this;if(c){if(c.onAdd){c.onAdd.call(this,j)}if(c.condition){e=function(m){if(c.condition.call(this,m)){return j.call(this,m)}return true}}h=c.base||h}var f=function(){return j.call(l)};var d=Element.NativeEvents[h];if(d){if(d==2){f=function(m){m=new Event(m,l.getWindow());if(e.call(l,m)===false){m.stop()}}}this.addListener(h,f,arguments[2])}k[g].values.push(f);return this},removeEvent:function(f,e){var d=this.retrieve("events");if(!d||!d[f]){return this}var j=d[f];var c=j.keys.indexOf(e);if(c==-1){return this}var h=j.values[c];delete j.keys[c];delete j.values[c];var g=Element.Events[f];if(g){if(g.onRemove){g.onRemove.call(this,e)}f=g.base||f}return(Element.NativeEvents[f])?this.removeListener(f,h,arguments[2]):this},addEvents:function(c){for(var d in c){this.addEvent(d,c[d])}return this},removeEvents:function(c){var e;if(typeOf(c)=="object"){for(e in c){this.removeEvent(e,c[e])}return this}var d=this.retrieve("events");if(!d){return this}if(!c){for(e in d){this.removeEvents(e)}this.eliminate("events")}else{if(d[c]){d[c].keys.each(function(f){this.removeEvent(c,f)},this);delete d[c]}}return this},fireEvent:function(f,d,c){var e=this.retrieve("events");if(!e||!e[f]){return this}d=Array.from(d);e[f].keys.each(function(g){if(c){g.delay(c,this,d)}else{g.apply(this,d)}},this);return this},cloneEvents:function(f,e){f=document.id(f);var d=f.retrieve("events");if(!d){return this}if(!e){for(var c in d){this.cloneEvents(f,c)}}else{if(d[e]){d[e].keys.each(function(g){this.addEvent(e,g)},this)}}return this}});try{if(typeof HTMLElement!="undefined"){HTMLElement.prototype.fireEvent=Element.prototype.fireEvent}}catch(b){}Element.NativeEvents={click:2,dblclick:2,mouseup:2,mousedown:2,contextmenu:2,mousewheel:2,DOMMouseScroll:2,mouseover:2,mouseout:2,mousemove:2,selectstart:2,selectend:2,keydown:2,keypress:2,keyup:2,orientationchange:2,touchstart:2,touchmove:2,touchend:2,touchcancel:2,gesturestart:2,gesturechange:2,gestureend:2,focus:2,blur:2,change:2,reset:2,select:2,submit:2,load:2,unload:1,beforeunload:2,resize:1,move:1,DOMContentLoaded:1,readystatechange:1,error:1,abort:1,scroll:1};var a=function(c){var d=c.relatedTarget;if(d==null){return true}if(!d){return false}return(d!=this&&d.prefix!="xul"&&typeOf(this)!="document"&&!this.contains(d))};Element.Events={mouseenter:{base:"mouseover",condition:a},mouseleave:{base:"mouseout",condition:a},mousewheel:{base:(Browser.firefox)?"DOMMouseScroll":"mousewheel"}}})();(function(){var f=this.Fx=new Class({Implements:[Chain,Events,Options],options:{fps:60,unit:false,duration:500,frames:null,frameSkip:true,link:"ignore"},initialize:function(g){this.subject=this.subject||this;this.setOptions(g)},getTransition:function(){return function(g){return -(Math.cos(Math.PI*g)-1)/2}},step:function(g){if(this.options.frameSkip){var h=(this.time!=null)?(g-this.time):0,j=h/this.frameInterval;this.time=g;this.frame+=j}else{this.frame++}if(this.frame<this.frames){var k=this.transition(this.frame/this.frames);this.set(this.compute(this.from,this.to,k))}else{this.frame=this.frames;this.set(this.compute(this.from,this.to,1));this.stop()}},set:function(g){return g},compute:function(j,h,g){return f.compute(j,h,g)},check:function(){if(!this.isRunning()){return true}switch(this.options.link){case"cancel":this.cancel();return true;case"chain":this.chain(this.caller.pass(arguments,this));return false}return false},start:function(l,k){if(!this.check(l,k)){return this}this.from=l;this.to=k;this.frame=(this.options.frameSkip)?0:-1;this.time=null;this.transition=this.getTransition();var j=this.options.frames,h=this.options.fps,g=this.options.duration;this.duration=f.Durations[g]||g.toInt();this.frameInterval=1000/h;this.frames=j||Math.round(this.duration/this.frameInterval);this.fireEvent("start",this.subject);b.call(this,h);return this},stop:function(){if(this.isRunning()){this.time=null;d.call(this,this.options.fps);if(this.frames==this.frame){this.fireEvent("complete",this.subject);if(!this.callChain()){this.fireEvent("chainComplete",this.subject)}}else{this.fireEvent("stop",this.subject)}}return this},cancel:function(){if(this.isRunning()){this.time=null;d.call(this,this.options.fps);this.frame=this.frames;this.fireEvent("cancel",this.subject).clearChain()}return this},pause:function(){if(this.isRunning()){this.time=null;d.call(this,this.options.fps)}return this},resume:function(){if((this.frame<this.frames)&&!this.isRunning()){b.call(this,this.options.fps)}return this},isRunning:function(){var g=e[this.options.fps];return g&&g.contains(this)}});f.compute=function(j,h,g){return(h-j)*g+j};f.Durations={"short":250,normal:500,"long":1000};var e={},c={};var a=function(){var h=Date.now();for(var j=this.length;j--;){var g=this[j];if(g){g.step(h)}}};var b=function(h){var g=e[h]||(e[h]=[]);g.push(this);if(!c[h]){c[h]=a.periodical(Math.round(1000/h),g)}};var d=function(h){var g=e[h];if(g){g.erase(this);if(!g.length&&c[h]){delete e[h];c[h]=clearInterval(c[h])}}}})();Fx.CSS=new Class({Extends:Fx,prepare:function(c,d,b){b=Array.from(b);if(b[1]==null){b[1]=b[0];b[0]=c.getStyle(d)}var a=b.map(this.parse);return{from:a[0],to:a[1]}},parse:function(a){a=Function.from(a)();a=(typeof a=="string")?a.split(" "):Array.from(a);return a.map(function(c){c=String(c);var b=false;Object.each(Fx.CSS.Parsers,function(f,e){if(b){return}var d=f.parse(c);if(d||d===0){b={value:d,parser:f}}});b=b||{value:c,parser:Fx.CSS.Parsers.String};return b})},compute:function(d,c,b){var a=[];(Math.min(d.length,c.length)).times(function(e){a.push({value:d[e].parser.compute(d[e].value,c[e].value,b),parser:d[e].parser})});a.$family=Function.from("fx:css:value");return a},serve:function(c,b){if(typeOf(c)!="fx:css:value"){c=this.parse(c)}var a=[];c.each(function(d){a=a.concat(d.parser.serve(d.value,b))});return a},render:function(a,d,c,b){a.setStyle(d,this.serve(c,b))},search:function(a){if(Fx.CSS.Cache[a]){return Fx.CSS.Cache[a]}var c={},b=new RegExp("^"+a.escapeRegExp()+"$");Array.each(document.styleSheets,function(f,e){var d=f.href;if(d&&d.contains("://")&&!d.contains(document.domain)){return}var g=f.rules||f.cssRules;Array.each(g,function(k,h){if(!k.style){return}var j=(k.selectorText)?k.selectorText.replace(/^\w+/,function(l){return l.toLowerCase()}):null;if(!j||!b.test(j)){return}Object.each(Element.Styles,function(m,l){if(!k.style[l]||Element.ShortStyles[l]){return}m=String(k.style[l]);c[l]=((/^rgb/).test(m))?m.rgbToHex():m})})});return Fx.CSS.Cache[a]=c}});Fx.CSS.Cache={};Fx.CSS.Parsers={Color:{parse:function(a){if(a.match(/^#[0-9a-f]{3,6}$/i)){return a.hexToRgb(true)}return((a=a.match(/(\d+),\s*(\d+),\s*(\d+)/)))?[a[1],a[2],a[3]]:false},compute:function(c,b,a){return c.map(function(e,d){return Math.round(Fx.compute(c[d],b[d],a))})},serve:function(a){return a.map(Number)}},Number:{parse:parseFloat,compute:Fx.compute,serve:function(b,a){return(a)?b+a:b}},String:{parse:Function.from(false),compute:function(b,a){return a},serve:function(a){return a}}};Fx.Morph=new Class({Extends:Fx.CSS,initialize:function(b,a){this.element=this.subject=document.id(b);this.parent(a)},set:function(a){if(typeof a=="string"){a=this.search(a)}for(var b in a){this.render(this.element,b,a[b],this.options.unit)}return this},compute:function(e,d,c){var a={};for(var b in e){a[b]=this.parent(e[b],d[b],c)}return a},start:function(b){if(!this.check(b)){return this}if(typeof b=="string"){b=this.search(b)}var e={},d={};for(var c in b){var a=this.prepare(this.element,c,b[c]);e[c]=a.from;d[c]=a.to}return this.parent(e,d)}});Element.Properties.morph={set:function(a){this.get("morph").cancel().setOptions(a);return this},get:function(){var a=this.retrieve("morph");if(!a){a=new Fx.Morph(this,{link:"cancel"});this.store("morph",a)}return a}};Element.implement({morph:function(a){this.get("morph").start(a);return this}});Fx.Tween=new Class({Extends:Fx.CSS,initialize:function(b,a){this.element=this.subject=document.id(b);this.parent(a)},set:function(b,a){if(arguments.length==1){a=b;b=this.property||this.options.property}this.render(this.element,b,a,this.options.unit);return this},start:function(c,e,d){if(!this.check(c,e,d)){return this}var b=Array.flatten(arguments);this.property=this.options.property||b.shift();var a=this.prepare(this.element,this.property,b);return this.parent(a.from,a.to)}});Element.Properties.tween={set:function(a){this.get("tween").cancel().setOptions(a);return this},get:function(){var a=this.retrieve("tween");if(!a){a=new Fx.Tween(this,{link:"cancel"});this.store("tween",a)}return a}};Element.implement({tween:function(a,c,b){this.get("tween").start(arguments);return this},fade:function(c){var e=this.get("tween"),d="opacity",a;c=[c,"toggle"].pick();switch(c){case"in":e.start(d,1);break;case"out":e.start(d,0);break;case"show":e.set(d,1);break;case"hide":e.set(d,0);break;case"toggle":var b=this.retrieve("fade:flag",this.get("opacity")==1);e.start(d,(b)?0:1);this.store("fade:flag",!b);a=true;break;default:e.start(d,arguments)}if(!a){this.eliminate("fade:flag")}return this},highlight:function(c,a){if(!a){a=this.retrieve("highlight:original",this.getStyle("background-color"));a=(a=="transparent")?"#fff":a}var b=this.get("tween");b.start("background-color",c||"#ffff88",a).chain(function(){this.setStyle("background-color",this.retrieve("highlight:original"));b.callChain()}.bind(this));return this}});(function(){var a=("onprogress" in new Browser.Request);var c=this.Request=new Class({Implements:[Chain,Events,Options],options:{url:"",data:"",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*"},async:true,format:false,method:"post",link:"ignore",isSuccess:null,emulation:true,urlEncoded:true,encoding:"utf-8",evalScripts:false,evalResponse:false,timeout:0,noCache:false},initialize:function(d){this.xhr=new Browser.Request();this.setOptions(d);this.headers=this.options.headers},onStateChange:function(){var d=this.xhr;if(d.readyState!=4||!this.running){return}this.running=false;this.status=0;Function.attempt(function(){var e=d.status;this.status=(e==1223)?204:e}.bind(this));d.onreadystatechange=function(){};clearTimeout(this.timer);this.response={text:this.xhr.responseText||"",xml:this.xhr.responseXML};if(this.options.isSuccess.call(this,this.status)){this.success(this.response.text,this.response.xml)}else{this.failure()}},isSuccess:function(){var d=this.status;return(d>=200&&d<300)},isRunning:function(){return !!this.running},processScripts:function(d){if(this.options.evalResponse||(/(ecma|java)script/).test(this.getHeader("Content-type"))){return Browser.exec(d)}return d.stripScripts(this.options.evalScripts,true)},success:function(e,d){this.onSuccess(this.processScripts(e),d)},onSuccess:function(){this.fireEvent("complete",arguments).fireEvent("success",arguments).callChain()},failure:function(){this.onFailure()},onFailure:function(){this.fireEvent("complete").fireEvent("failure",this.xhr)},loadstart:function(d){this.fireEvent("loadstart",[d,this.xhr])},progress:function(d){this.fireEvent("progress",[d,this.xhr])},timeout:function(){this.fireEvent("timeout",this.xhr)},setHeader:function(d,e){this.headers[d]=e;return this},getHeader:function(d){return Function.attempt(function(){return this.xhr.getResponseHeader(d)}.bind(this))},check:function(){if(!this.running){return true}switch(this.options.link){case"cancel":this.cancel();return true;case"chain":this.chain(this.caller.pass(arguments,this));return false}return false},send:function(p){if(!this.check(p)){return this}this.options.isSuccess=this.options.isSuccess||this.isSuccess;this.running=true;var l=typeOf(p);if(l=="string"||l=="element"){p={data:p}}var g=this.options;p=Object.append({data:g.data,url:g.url,method:g.method},p);var j=p.data,e=String(p.url),d=p.method.toLowerCase();switch(typeOf(j)){case"element":j=document.id(j).toQueryString();break;case"object":case"hash":j=Object.toQueryString(j)}if(this.options.format){var m="format="+this.options.format;j=(j)?m+"&"+j:m}if(this.options.emulation&&!["get","post"].contains(d)){var k="_method="+d;j=(j)?k+"&"+j:k;d="post"}if(this.options.urlEncoded&&["post","put"].contains(d)){var f=(this.options.encoding)?"; charset="+this.options.encoding:"";this.headers["Content-type"]="application/x-www-form-urlencoded"+f}if(!e){e=document.location.pathname}var h=e.lastIndexOf("/");if(h>-1&&(h=e.indexOf("#"))>-1){e=e.substr(0,h)}if(this.options.noCache){e+=(e.contains("?")?"&":"?")+String.uniqueID()}if(j&&d=="get"){e+=(e.contains("?")?"&":"?")+j;j=null}var o=this.xhr;if(a){o.onloadstart=this.loadstart.bind(this);o.onprogress=this.progress.bind(this)}o.open(d.toUpperCase(),e,this.options.async,this.options.user,this.options.password);if(this.options.user&&"withCredentials" in o){o.withCredentials=true}o.onreadystatechange=this.onStateChange.bind(this);Object.each(this.headers,function(r,q){try{o.setRequestHeader(q,r)}catch(s){this.fireEvent("exception",[q,r])}},this);this.fireEvent("request");o.send(j);if(!this.options.async){this.onStateChange()}if(this.options.timeout){this.timer=this.timeout.delay(this.options.timeout,this)}return this},cancel:function(){if(!this.running){return this}this.running=false;var d=this.xhr;d.abort();clearTimeout(this.timer);d.onreadystatechange=d.onprogress=d.onloadstart=function(){};this.xhr=new Browser.Request();this.fireEvent("cancel");return this}});var b={};["get","post","put","delete","GET","POST","PUT","DELETE"].each(function(d){b[d]=function(f){var e={method:d};if(f!=null){e.data=f}return this.send(e)}});c.implement(b);Element.Properties.send={set:function(d){var e=this.get("send").cancel();e.setOptions(d);return this},get:function(){var d=this.retrieve("send");if(!d){d=new c({data:this,link:"cancel",method:this.get("method")||"post",url:this.get("action")});this.store("send",d)}return d}};Element.implement({send:function(d){var e=this.get("send");e.send({data:this,url:d||e.options.url});return this}})})();Request.HTML=new Class({Extends:Request,options:{update:false,append:false,evalScripts:true,filter:false,headers:{Accept:"text/html, application/xml, text/xml, */*"}},success:function(e){var d=this.options,b=this.response;b.html=e.stripScripts(function(f){b.javascript=f});var c=b.html.match(/<body[^>]*>([\s\S]*?)<\/body>/i);if(c){b.html=c[1]}var a=new Element("div").set("html",b.html);b.tree=a.childNodes;b.elements=a.getElements("*");if(d.filter){b.tree=b.elements.filter(d.filter)}if(d.update){document.id(d.update).empty().set("html",b.html)}else{if(d.append){document.id(d.append).adopt(a.getChildren())}}if(d.evalScripts){Browser.exec(b.javascript)}this.onSuccess(b.tree,b.elements,b.html,b.javascript)}});Element.Properties.load={set:function(a){var b=this.get("load").cancel();b.setOptions(a);return this},get:function(){var a=this.retrieve("load");if(!a){a=new Request.HTML({data:this,link:"cancel",update:this,method:"get"});this.store("load",a)}return a}};Element.implement({load:function(){this.get("load").send(Array.link(arguments,{data:Type.isObject,url:Type.isString}));return this}});Request.JSON=new Class({Extends:Request,options:{secure:true},initialize:function(a){this.parent(a);Object.append(this.headers,{Accept:"application/json","X-Request":"JSON"})},success:function(c){var b=this.options.secure;var a=this.response.json=Function.attempt(function(){return JSON.decode(c,b)});if(a==null){this.onFailure()}else{this.onSuccess(a,c)}}});var Cookie=new Class({Implements:Options,options:{path:"/",domain:false,duration:false,secure:false,document:document,encode:true},initialize:function(b,a){this.key=b;this.setOptions(a)},write:function(b){if(this.options.encode){b=encodeURIComponent(b)}if(this.options.domain){b+="; domain="+this.options.domain}if(this.options.path){b+="; path="+this.options.path}if(this.options.duration){var a=new Date();a.setTime(a.getTime()+this.options.duration*24*60*60*1000);b+="; expires="+a.toGMTString()}if(this.options.secure){b+="; secure"}this.options.document.cookie=this.key+"="+b;return this},read:function(){var a=this.options.document.cookie.match("(?:^|;)\\s*"+this.key.escapeRegExp()+"=([^;]*)");return(a)?decodeURIComponent(a[1]):null},dispose:function(){new Cookie(this.key,Object.merge({},this.options,{duration:-1})).write("");return this}});Cookie.write=function(b,c,a){return new Cookie(b,a).write(c)};Cookie.read=function(a){return new Cookie(a).read()};Cookie.dispose=function(b,a){return new Cookie(b,a).dispose()};(function(k,m){var o,g,f=[],c,b,p=true;try{p=k.frameElement!=null}catch(j){}var h=function(){clearTimeout(b);if(o){return}Browser.loaded=o=true;m.removeListener("DOMContentLoaded",h).removeListener("readystatechange",a);m.fireEvent("domready");k.fireEvent("domready")};var a=function(){for(var e=f.length;e--;){if(f[e]()){h();return true}}return false};var l=function(){clearTimeout(b);if(!a()){b=setTimeout(l,10)}};m.addListener("DOMContentLoaded",h);var d=m.createElement("div");if(d.doScroll&&!p){f.push(function(){try{d.doScroll();return true}catch(q){}return false});c=true}if(m.readyState){f.push(function(){var e=m.readyState;return(e=="loaded"||e=="complete")})}if("onreadystatechange" in m){m.addListener("readystatechange",a)}else{c=true}if(c){l()}Element.Events.domready={onAdd:function(e){if(o){e.call(this)}}};Element.Events.load={base:"load",onAdd:function(e){if(g&&this==k){e.call(this)}},condition:function(){if(this==k){h();delete Element.Events.load}return true}};k.addEvent("load",function(){g=true})})(window,document);if(typeof JSON=="undefined"){this.JSON={}}Object.append(JSON,{$specialChars:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},$replaceChars:function(a){return JSON.$specialChars[a]||"\\u00"+Math.floor(a.charCodeAt()/16).toString(16)+(a.charCodeAt()%16).toString(16)},encode:function(b){switch(typeOf(b)){case"string":return'"'+b.replace(/[\x00-\x1f\\"]/g,JSON.$replaceChars)+'"';case"array":return"["+String(b.map(JSON.encode).clean())+"]";case"object":case"hash":var a=[];Object.each(b,function(e,d){var c=JSON.encode(e);if(c){a.push(JSON.encode(d)+":"+c)}});return"{"+a+"}";case"number":case"boolean":return String(b);case"null":return"null"}return null},decode:function(string,secure){if(typeOf(string)!="string"||!string.length){return null}if(secure&&!(/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/).test(string.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"/g,""))){return null}return eval("("+string+")")}});Class.Mutators.Binds=function(a){if(!this.prototype.initialize){this.implement("initialize",function(){})}return a};Class.Mutators.initialize=function(a){return function(){Array.from(this.Binds).each(function(b){var c=this[b];if(c){this[b]=c.bind(this)}},this);return a.apply(this,arguments)}};Class.Occlude=new Class({occlude:function(c,b){b=document.id(b||this.element);var a=b.retrieve(c||this.property);if(a&&this.occluded!=null){return this.occluded=a}this.occluded=false;b.store(c||this.property,this);return this.occluded}});Class.refactor=function(b,a){Object.each(a,function(e,d){var c=b.prototype[d];if(c&&c.$origin){c=c.$origin}if(typeof e=="function"){b.implement(d,function(){var f=this.previous;this.previous=c||function(){};var g=e.apply(this,arguments);this.previous=f;return g})}else{b.implement(d,e)}});return b};(function(){var a=function(b){return b!=null};Object.extend({getFromPath:function(e,d){var f=d.split(".");for(var c=0,b=f.length;c<b;c++){if(e.hasOwnProperty(f[c])){e=e[f[c]]}else{return null}}return e},cleanValues:function(b,c){c=c||a;for(key in b){if(!c(b[key])){delete b[key]}}return b},erase:function(b,c){if(b.hasOwnProperty(c)){delete b[c]}return b},run:function(c){var b=Array.slice(arguments,1);for(key in c){if(c[key].apply){c[key].apply(c,b)}}return c}})})();Element.implement({isDisplayed:function(){return this.getStyle("display")!="none"},isVisible:function(){var a=this.offsetWidth,b=this.offsetHeight;return(a==0&&b==0)?false:(a>0&&b>0)?true:this.style.display!="none"},toggle:function(){return this[this.isDisplayed()?"hide":"show"]()},hide:function(){var b;try{b=this.getStyle("display")}catch(a){}if(b=="none"){return this}return this.store("element:_originalDisplay",b||"").setStyle("display","none")},show:function(a){if(!a&&this.isDisplayed()){return this}a=a||this.retrieve("element:_originalDisplay")||"block";return this.setStyle("display",(a=="none")?"block":a)},swapClass:function(a,b){return this.removeClass(a).addClass(b)}});Document.implement({clearSelection:function(){if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){var a=window.getSelection();if(a&&a.removeAllRanges){a.removeAllRanges()}}}}});Fx.Elements=new Class({Extends:Fx.CSS,initialize:function(b,a){this.elements=this.subject=$$(b);this.parent(a)},compute:function(g,h,j){var c={};for(var d in g){var a=g[d],e=h[d],f=c[d]={};for(var b in a){f[b]=this.parent(a[b],e[b],j)}}return c},set:function(b){for(var c in b){if(!this.elements[c]){continue}var a=b[c];for(var d in a){this.render(this.elements[c],d,a[d],this.options.unit)}}return this},start:function(c){if(!this.check(c)){return this}var h={},j={};for(var d in c){if(!this.elements[d]){continue}var f=c[d],a=h[d]={},g=j[d]={};for(var b in f){var e=this.prepare(this.elements[d],b,f[b]);a[b]=e.from;g[b]=e.to}}return this.parent(h,j)}});(function(){var b=null,a={},d={};var c=function(f){if(instanceOf(f,e.Set)){return f}else{return a[f]}};var e=this.Locale={define:function(f,k,h,j){var g;if(instanceOf(f,e.Set)){g=f.name;if(g){a[g]=f}}else{g=f;if(!a[g]){a[g]=new e.Set(g)}f=a[g]}if(k){f.define(k,h,j)}if(!b){b=f}return f},use:function(f){f=c(f);if(f){b=f;this.fireEvent("change",f)}return this},getCurrent:function(){return b},get:function(g,f){return(b)?b.get(g,f):""},inherit:function(f,g,h){f=c(f);if(f){f.inherit(g,h)}return this},list:function(){return Object.keys(a)}};Object.append(e,new Events);e.Set=new Class({sets:{},inherits:{locales:[],sets:{}},initialize:function(f){this.name=f||""},define:function(j,g,h){var f=this.sets[j];if(!f){f={}}if(g){if(typeOf(g)=="object"){f=Object.merge(f,g)}else{f[g]=h}}this.sets[j]=f;return this},get:function(s,j,r){var q=Object.getFromPath(this.sets,s);if(q!=null){var m=typeOf(q);if(m=="function"){q=q.apply(null,Array.from(j))}else{if(m=="object"){q=Object.clone(q)}}return q}var h=s.indexOf("."),p=h<0?s:s.substr(0,h),k=(this.inherits.sets[p]||[]).combine(this.inherits.locales).include("en-US");if(!r){r=[]}for(var g=0,f=k.length;g<f;g++){if(r.contains(k[g])){continue}r.include(k[g]);var o=a[k[g]];if(!o){continue}q=o.get(s,j,r);if(q!=null){return q}}return""},inherit:function(g,h){g=Array.from(g);if(h&&!this.inherits.sets[h]){this.inherits.sets[h]=[]}var f=g.length;while(f--){(h?this.inherits.sets[h]:this.inherits.locales).unshift(g[f])}return this}})})();Locale.define("en-US","Date",{months:["January","February","March","April","May","June","July","August","September","October","November","December"],months_abbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],days_abbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dateOrder:["month","date","year"],shortDate:"%m/%d/%Y",shortTime:"%I:%M%p",AM:"AM",PM:"PM",ordinal:function(a){return(a>3&&a<21)?"th":["th","st","nd","rd","th"][Math.min(a%10,4)]},lessThanMinuteAgo:"less than a minute ago",minuteAgo:"about a minute ago",minutesAgo:"{delta} minutes ago",hourAgo:"about an hour ago",hoursAgo:"about {delta} hours ago",dayAgo:"1 day ago",daysAgo:"{delta} days ago",weekAgo:"1 week ago",weeksAgo:"{delta} weeks ago",monthAgo:"1 month ago",monthsAgo:"{delta} months ago",yearAgo:"1 year ago",yearsAgo:"{delta} years ago",lessThanMinuteUntil:"less than a minute from now",minuteUntil:"about a minute from now",minutesUntil:"{delta} minutes from now",hourUntil:"about an hour from now",hoursUntil:"about {delta} hours from now",dayUntil:"1 day from now",daysUntil:"{delta} days from now",weekUntil:"1 week from now",weeksUntil:"{delta} weeks from now",monthUntil:"1 month from now",monthsUntil:"{delta} months from now",yearUntil:"1 year from now",yearsUntil:"{delta} years from now"});(function(){var a=this.Date;a.Methods={ms:"Milliseconds",year:"FullYear",min:"Minutes",mo:"Month",sec:"Seconds",hr:"Hours"};["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds","Time","TimezoneOffset","Week","Timezone","GMTOffset","DayOfYear","LastMonth","LastDayOfMonth","UTCDate","UTCDay","UTCFullYear","AMPM","Ordinal","UTCHours","UTCMilliseconds","UTCMinutes","UTCMonth","UTCSeconds","UTCMilliseconds"].each(function(u){a.Methods[u.toLowerCase()]=u});var q=function(w,v,u){if(!u){u="0"}return new Array(v-String(w).length+1).join(u)+w};a.implement({set:function(w,v){w=w.toLowerCase();var u=a.Methods;if(u[w]){this["set"+u[w]](v)}return this}.overloadSetter(),get:function(v){v=v.toLowerCase();var u=a.Methods;if(u[v]){return this["get"+u[v]]()}return null},clone:function(){return new a(this.get("time"))},increment:function(u,w){u=u||"day";w=w!=null?w:1;switch(u){case"year":return this.increment("month",w*12);case"month":var v=this.get("date");this.set("date",1).set("mo",this.get("mo")+w);return this.set("date",v.min(this.get("lastdayofmonth")));case"week":return this.increment("day",w*7);case"day":return this.set("date",this.get("date")+w)}if(!a.units[u]){throw new Error(u+" is not a supported interval")}return this.set("time",this.get("time")+w*a.units[u]())},decrement:function(u,v){return this.increment(u,-1*(v!=null?v:1))},isLeapYear:function(){return a.isLeapYear(this.get("year"))},clearTime:function(){return this.set({hr:0,min:0,sec:0,ms:0})},diff:function(v,u){if(typeOf(v)=="string"){v=a.parse(v)}return((v-this)/a.units[u||"day"](3,3)).round()},getLastDayOfMonth:function(){return a.daysInMonth(this.get("mo"),this.get("year"))},getDayOfYear:function(){return(a.UTC(this.get("year"),this.get("mo"),this.get("date")+1)-a.UTC(this.get("year"),0,1))/a.units.day()},getWeek:function(){return(this.get("dayofyear")/7).ceil()},getOrdinal:function(u){return a.getMsg("ordinal",u||this.get("date"))},getTimezone:function(){return this.toString().replace(/^.*? ([A-Z]{3}).[0-9]{4}.*$/,"$1").replace(/^.*?\(([A-Z])[a-z]+ ([A-Z])[a-z]+ ([A-Z])[a-z]+\)$/,"$1$2$3")},getGMTOffset:function(){var u=this.get("timezoneOffset");return((u>0)?"-":"+")+q((u.abs()/60).floor(),2)+q(u%60,2)},setAMPM:function(u){u=u.toUpperCase();var v=this.get("hr");if(v>11&&u=="AM"){return this.decrement("hour",12)}else{if(v<12&&u=="PM"){return this.increment("hour",12)}}return this},getAMPM:function(){return(this.get("hr")<12)?"AM":"PM"},parse:function(u){this.set("time",a.parse(u));return this},isValid:function(u){return !isNaN((u||this).valueOf())},format:function(v){if(!this.isValid()){return"invalid date"}if(!v){v="%x %X"}var u=v.toLowerCase();if(t[u]){return t[u](this)}v=f[u]||v;var w=this;return v.replace(/%([a-z%])/gi,function(z,y){switch(y){case"a":return a.getMsg("days_abbr")[w.get("day")];case"A":return a.getMsg("days")[w.get("day")];case"b":return a.getMsg("months_abbr")[w.get("month")];case"B":return a.getMsg("months")[w.get("month")];case"c":return w.format("%a %b %d %H:%M:%S %Y");case"d":return q(w.get("date"),2);case"e":return q(w.get("date"),2," ");case"H":return q(w.get("hr"),2);case"I":return q((w.get("hr")%12)||12,2);case"j":return q(w.get("dayofyear"),3);case"k":return q(w.get("hr"),2," ");case"l":return q((w.get("hr")%12)||12,2," ");case"L":return q(w.get("ms"),3);case"m":return q((w.get("mo")+1),2);case"M":return q(w.get("min"),2);case"o":return w.get("ordinal");case"p":return a.getMsg(w.get("ampm"));case"s":return Math.round(w/1000);case"S":return q(w.get("seconds"),2);case"U":return q(w.get("week"),2);case"w":return w.get("day");case"x":return w.format(a.getMsg("shortDate"));case"X":return w.format(a.getMsg("shortTime"));case"y":return w.get("year").toString().substr(2);case"Y":return w.get("year");case"T":return w.format("%H:%M:%S");case"z":return w.get("GMTOffset");case"Z":return w.get("Timezone")}return y})},toISOString:function(){return this.format("iso8601")}});a.alias("toJSON","toISOString");a.alias("compare","diff");a.alias("strftime","format");var f={db:"%Y-%m-%d %H:%M:%S",compact:"%Y%m%dT%H%M%S",iso8601:"%Y-%m-%dT%H:%M:%S%z","short":"%d %b %H:%M","long":"%B %d, %Y %H:%M"};var k=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],g=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var t={rfc822:function(u){return k[u.get("day")]+u.format(", %d ")+g[u.get("month")]+u.format(" %Y %H:%M:%S %Z")},rfc2822:function(u){return k[u.get("day")]+u.format(", %d ")+g[u.get("month")]+u.format(" %Y %H:%M:%S %z")}};var c=[];var o=a.parse;var s=function(y,A,w){var v=-1;var z=a.getMsg(y+"s");switch(typeOf(A)){case"object":v=z[A.get(y)];break;case"number":v=z[A];if(!v){throw new Error("Invalid "+y+" index: "+A)}break;case"string":var u=z.filter(function(B){return this.test(B)},new RegExp("^"+A,"i"));if(!u.length){throw new Error("Invalid "+y+" string")}if(u.length>1){throw new Error("Ambiguous "+y)}v=u[0]}return(w)?z.indexOf(v):v};a.extend({getMsg:function(v,u){return Locale.get("Date."+v,u)},units:{ms:Function.from(1),second:Function.from(1000),minute:Function.from(60000),hour:Function.from(3600000),day:Function.from(86400000),week:Function.from(608400000),month:function(v,u){var w=new a;return a.daysInMonth(v!=null?v:w.get("mo"),u!=null?u:w.get("year"))*86400000},year:function(u){u=u||new a().get("year");return a.isLeapYear(u)?31622400000:31536000000}},daysInMonth:function(v,u){return[31,a.isLeapYear(u)?29:28,31,30,31,30,31,31,30,31,30,31][v]},isLeapYear:function(u){return((u%4===0)&&(u%100!==0))||(u%400===0)},parse:function(w){var v=typeOf(w);if(v=="number"){return new a(w)}if(v!="string"){return w}w=w.clean();if(!w.length){return null}var u;c.some(function(z){var y=z.re.exec(w);return(y)?(u=z.handler(y)):false});if(!(u&&u.isValid())){u=new a(o(w));if(!(u&&u.isValid())){u=new a(w.toInt())}}return u},parseDay:function(u,v){return s("day",u,v)},parseMonth:function(v,u){return s("month",v,u)},parseUTC:function(v){var u=new a(v);var w=a.UTC(u.get("year"),u.get("mo"),u.get("date"),u.get("hr"),u.get("min"),u.get("sec"),u.get("ms"));return new a(w)},orderIndex:function(u){return a.getMsg("dateOrder").indexOf(u)+1},defineFormat:function(u,v){f[u]=v},defineFormats:function(u){for(var v in u){a.defineFormat(v,u[v])}},defineParser:function(u){c.push((u.re&&u.handler)?u:l(u))},defineParsers:function(){Array.flatten(arguments).each(a.defineParser)},define2DigitYearStart:function(u){p=u%100;h=u-p}});var h=1900;var p=70;var d=function(u){return new RegExp("(?:"+a.getMsg(u).map(function(v){return v.substr(0,3)}).join("|")+")[a-z]*")};var m=function(u){switch(u){case"T":return"%H:%M:%S";case"x":return((a.orderIndex("month")==1)?"%m[-./]%d":"%d[-./]%m")+"([-./]%y)?";case"X":return"%H([.:]%M)?([.:]%S([.:]%s)?)? ?%p? ?%z?"}return null};var j={d:/[0-2]?[0-9]|3[01]/,H:/[01]?[0-9]|2[0-3]/,I:/0?[1-9]|1[0-2]/,M:/[0-5]?\d/,s:/\d+/,o:/[a-z]*/,p:/[ap]\.?m\.?/,y:/\d{2}|\d{4}/,Y:/\d{4}/,z:/Z|[+-]\d{2}(?::?\d{2})?/};j.m=j.I;j.S=j.M;var e;var b=function(u){e=u;j.a=j.A=d("days");j.b=j.B=d("months");c.each(function(w,v){if(w.format){c[v]=l(w.format)}})};var l=function(w){if(!e){return{format:w}}var u=[];var v=(w.source||w).replace(/%([a-z])/gi,function(z,y){return m(y)||z}).replace(/\((?!\?)/g,"(?:").replace(/ (?!\?|\*)/g,",? ").replace(/%([a-z%])/gi,function(z,y){var A=j[y];if(!A){return y}u.push(y);return"("+A.source+")"}).replace(/\[a-z\]/gi,"[a-z\\u00c0-\\uffff;&]");return{format:w,re:new RegExp("^"+v+"$","i"),handler:function(B){B=B.slice(1).associate(u);var y=new a().clearTime(),A=B.y||B.Y;if(A!=null){r.call(y,"y",A)}if("d" in B){r.call(y,"d",1)}if("m" in B||B.b||B.B){r.call(y,"m",1)}for(var z in B){r.call(y,z,B[z])}return y}}};var r=function(u,v){if(!v){return this}switch(u){case"a":case"A":return this.set("day",a.parseDay(v,true));case"b":case"B":return this.set("mo",a.parseMonth(v,true));case"d":return this.set("date",v);case"H":case"I":return this.set("hr",v);case"m":return this.set("mo",v-1);case"M":return this.set("min",v);case"p":return this.set("ampm",v.replace(/\./g,""));case"S":return this.set("sec",v);case"s":return this.set("ms",("0."+v)*1000);case"w":return this.set("day",v);case"Y":return this.set("year",v);case"y":v=+v;if(v<100){v+=h+(v<p?100:0)}return this.set("year",v);case"z":if(v=="Z"){v="+00"}var w=v.match(/([+-])(\d{2}):?(\d{2})?/);w=(w[1]+"1")*(w[2]*60+(+w[3]||0))+this.getTimezoneOffset();return this.set("time",this-w*60000)}return this};a.defineParsers("%Y([-./]%m([-./]%d((T| )%X)?)?)?","%Y%m%d(T%H(%M%S?)?)?","%x( %X)?","%d%o( %b( %Y)?)?( %X)?","%b( %d%o)?( %Y)?( %X)?","%Y %b( %d%o( %X)?)?","%o %b %d %X %z %Y","%T","%H:%M( ?%p)?");Locale.addEvent("change",function(u){if(Locale.get("Date")){b(u)}}).fireEvent("change",Locale.getCurrent())})();(function(){var a=function(b,c){b=b||"";var d=c?"<"+b+"(?!\\w)[^>]*>([\\s\\S]*?)</"+b+"(?!\\w)>":"</?"+b+"([^>]+)?>";reg=new RegExp(d,"gi");return reg};String.implement({getTags:function(b,c){return this.match(a(b,c))||[]},stripTags:function(b,c){return this.replace(a(b,c),"")}})})();var Asset={javascript:function(f,c){if(!c){c={}}var a=new Element("script",{src:f,type:"text/javascript"}),g=c.document||document,b=0,d=c.onload||c.onLoad;var e=d?function(){if(++b==1){d.call(this)}}:function(){};delete c.onload;delete c.onLoad;delete c.document;return a.addEvents({load:e,readystatechange:function(){if(["loaded","complete"].contains(this.readyState)){e.call(this)}}}).set(c).inject(g.head)},css:function(d,a){if(!a){a={}}var b=new Element("link",{rel:"stylesheet",media:"screen",type:"text/css",href:d});var c=a.onload||a.onLoad,e=a.document||document;delete a.onload;delete a.onLoad;delete a.document;if(c){b.addEvent("load",c)}return b.set(a).inject(e.head)},image:function(c,b){b=Object.merge({onload:function(){},onabort:function(){},onerror:function(){}},b);var d=new Image();var a=document.id(d)||new Element("img");["load","abort","error"].each(function(e){var g="on"+e;var f=e.capitalize();if(b["on"+f]){b[g]=b["on"+f];delete b["on"+f]}var h=b[g];delete b[g];d[g]=function(){if(!d){return}if(!a.parentNode){a.width=d.width;a.height=d.height}d=d.onload=d.onabort=d.onerror=null;h.delay(1,a,a);a.fireEvent(e,a,1)}});d.src=a.src=c;if(d&&d.complete){d.onload.delay(1)}return a.set(b)},images:function(c,b){b=Object.merge({onComplete:function(){},onProgress:function(){},onError:function(){},properties:{}},b);c=Array.from(c);var a=0;return new Elements(c.map(function(e,d){return Asset.image(e,Object.append(b.properties,{onload:function(){a++;b.onProgress.call(this,a,d,e);if(a==c.length){b.onComplete()}},onerror:function(){a++;b.onError.call(this,a,d,e);if(a==c.length){b.onComplete()}}}))}))}};var IframeShim=new Class({Implements:[Options,Events,Class.Occlude],options:{className:"iframeShim",src:'javascript:false;document.write("");',display:false,zIndex:null,margin:0,offset:{x:0,y:0},browsers:(Browser.ie6||(Browser.firefox&&Browser.version<3&&Browser.Platform.mac))},property:"IframeShim",initialize:function(b,a){this.element=document.id(b);if(this.occlude()){return this.occluded}this.setOptions(a);this.makeShim();return this},makeShim:function(){if(this.options.browsers){var c=this.element.getStyle("zIndex").toInt();if(!c){c=1;var b=this.element.getStyle("position");if(b=="static"||!b){this.element.setStyle("position","relative")}this.element.setStyle("zIndex",c)}c=((this.options.zIndex!=null||this.options.zIndex===0)&&c>this.options.zIndex)?this.options.zIndex:c-1;if(c<0){c=1}this.shim=new Element("iframe",{src:this.options.src,scrolling:"no",frameborder:0,styles:{zIndex:c,position:"absolute",border:"none",filter:"progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)"},"class":this.options.className}).store("IframeShim",this);var a=(function(){this.shim.inject(this.element,"after");this[this.options.display?"show":"hide"]();this.fireEvent("inject")}).bind(this);if(!IframeShim.ready){window.addEvent("load",a)}else{a()}}else{this.position=this.hide=this.show=this.dispose=Function.from(this)}},position:function(){if(!IframeShim.ready||!this.shim){return this}var a=this.element.measure(function(){return this.getSize()});if(this.options.margin!=undefined){a.x=a.x-(this.options.margin*2);a.y=a.y-(this.options.margin*2);this.options.offset.x+=this.options.margin;this.options.offset.y+=this.options.margin}this.shim.set({width:a.x,height:a.y}).position({relativeTo:this.element,offset:this.options.offset});return this},hide:function(){if(this.shim){this.shim.setStyle("display","none")}return this},show:function(){if(this.shim){this.shim.setStyle("display","block")}return this.position()},dispose:function(){if(this.shim){this.shim.dispose()}return this},destroy:function(){if(this.shim){this.shim.destroy()}return this}});window.addEvent("load",function(){IframeShim.ready=true});Request.JSONP=new Class({Implements:[Chain,Events,Options],options:{onRequest:function(a){if(this.options.log&&window.console&&console.log){console.log("JSONP retrieving script with url:"+a)}},onError:function(a){if(this.options.log&&window.console&&console.warn){console.warn("JSONP "+a+" will fail in Internet Explorer, which enforces a 2083 bytes length limit on URIs")}},url:"",callbackKey:"callback",injectScript:document.head,data:"",link:"ignore",timeout:0,log:false},initialize:function(a){this.setOptions(a)},send:function(c){if(!Request.prototype.check.call(this,c)){return this}this.running=true;var d=typeOf(c);if(d=="string"||d=="element"){c={data:c}}c=Object.merge(this.options,c||{});var e=c.data;switch(typeOf(e)){case"element":e=document.id(e).toQueryString();break;case"object":case"hash":e=Object.toQueryString(e)}var b=this.index=Request.JSONP.counter++;var f=c.url+(c.url.test("\\?")?"&":"?")+(c.callbackKey)+"=Request.JSONP.request_map.request_"+b+(e?"&"+e:"");if(f.length>2083){this.fireEvent("error",f)}Request.JSONP.request_map["request_"+b]=function(){this.success(arguments,b)}.bind(this);var a=this.getScript(f).inject(c.injectScript);this.fireEvent("request",[a.get("src"),a]);if(c.timeout){this.timeout.delay(c.timeout,this)}return this},getScript:function(a){if(!this.script){this.script=new Element("script[type=text/javascript]",{async:true,src:a})}return this.script},success:function(b,a){if(!this.running){return false}this.clear().fireEvent("complete",b).fireEvent("success",b).callChain()},cancel:function(){if(this.running){this.clear().fireEvent("cancel")}return this},isRunning:function(){return !!this.running},clear:function(){this.running=false;if(this.script){this.script.destroy();this.script=null}return this},timeout:function(){if(this.running){this.running=false;this.fireEvent("timeout",[this.script.get("src"),this.script]).fireEvent("failure").cancel()}return this}});Request.JSONP.counter=0;Request.JSONP.request_map={};
/*
Copyright (c) 2009 Arieh Glazer

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE
*/
(function(a){function b(){}a.instantiate=function(d,g){b.prototype=d.prototype;var e=new b(),c=d.apply(e,g);return c||e};a.implement({instantiate:function(c){return a.instantiate(this,c)}})})(Function);IdleTimer=new Class({Implements:[Events,Options],options:{timeout:60000,events:["mousemove","keydown","mousewheel","mousedown"]},initialize:function(b,a){this.setOptions(a);this.element=$(b);this.activeBound=this.active.bind(this);this.isIdle=false;this.started=false},stop:function(){clearTimeout(this.timer);for(var a in this.options.events){this.element.removeEvent(this.options.events[a],this.activeBound)}this.bound=false;this.started=false;this.fireEvent("stop");return this},active:function(){clearTimeout(this.timer);if(this.isIdle){this.fireEvent("active")}this.isIdle=false;this.start()},idle:function(){if(this.timer){clearTimeout(this.timer)}this.isIdle=true;this.fireEvent("idle")},start:function(){this.timer=this.idle.delay(this.options.timeout,this);this.lastActive=new Date().getTime();if(!this.bound){this.bind()}this.started=true;return this},bind:function(){for(var a in this.options.events){this.element.addEvent(this.options.events[a],this.activeBound)}this.bound=true;this.fireEvent("start")},getIdleTime:function(a){return a?Math.round((Date.now()-this.lastActive)/1000):Date.now()-this.lastActive},setTimeout:function(c,d){var b=this.options.timeout;this.options.timeout=c;if(d){return this}clearTimeout(this.timer);this.fireEvent("timeoutChanged",c);var a=this.getIdleTime();if(a<c&&this.isIdle){this.fireEvent("active");this.isIdle=false}else{if(a>=c){this.idle();return this}}this.timer=this.idle.delay(c-a,this);return this}});Element.Properties.idle={set:function(a){var b=this.retrieve("idle");if(b){b.stop()}return this.eliminate("idle").store("idle:options",a)},get:function(a){if(a||!this.retrieve("idle")){if(a||!this.retrieve("idle:options")){this.set("idle",a)}this.store("idle",new IdleTimer(this,this.retrieve("idle:options")))}return this.retrieve("idle")}};Element.Events.idle={onAdd:function(a){var b=this.get?false:true;var c=b?window.idleTimer:this.get("idle");if(b&&!c){c=window.idleTimer=new IdleTimer(this)}if(!c.started){c.start()}c.addEvent("idle",a)}};Element.Events.active={onAdd:function(a){(this.get?this.get("idle"):window.idleTimer).addEvent("active",a)}};Array.implement({getRandomIndex:function(){return Number.random(0,this.length-1)},copy:function(){return this.splice(0,this.length)},toQueryString:function(){var a=this.map(function(c,b){switch(typeOf(c)){case"element":return ta.id(c).toQueryString();break;case"object":return Object.toQueryString(c)}});return a.join("&")}});Cookie=Class.refactor(Cookie,{write:function(b){if(this.options.encode){b=encodeURIComponent(b)}if(this.options.domain){b+="; domain="+this.options.domain}if(this.options.path){b+="; path="+this.options.path}if(this.options.duration){var a=new Date();a.setTime(a.getTime()+this.options.duration*24*60*60*1000);b+="; expires="+a.toGMTString()}if(this.options.time){var a=new Date();a.setTime(a.getTime()+this.options.time*1000);b+="; expires="+a.toGMTString()}if(this.options.expires){var a=new Date(this.options.expires);b+="; expires="+a.toGMTString()}if(this.options.secure){b+="; secure"}this.options.document.cookie=this.key+"="+b;return this},readRaw:function(a){var b=this.options.document.cookie.match("(?:^|;)\\s*"+this.key.escapeRegExp()+"=([^;]*)");return b?b[1]:false}});Cookie.exist=function(a){return document.cookie.match("(?:^|;)\\s*"+a.escapeRegExp()+"=([^;]*)")!=null};Cookie.readSession=function(c,a){if(a==null){a={}}var b=new Cookie("TASession",{encode:false}).readRaw();var d=a.pattern?a.pattern:"[^\\*]+";var e=new RegExp("(\\*|^)"+c+"\\.("+d+")");if(e.test(b)){return{cookie:b,pattern:e,start:RegExp.$1,value:RegExp.$2}}return{cookie:b,pattern:e}};Cookie.writeSession=function(d,e,c){var a=this.readSession(d,c);if(!a.cookie){return false}var b;if(a.value){b=a.cookie.replace(a.pattern,a.start+d+"."+e)}else{b=a.cookie+"*"+d+"."+e}new Cookie("TASession",{domain:cookieDomain,encode:false}).write(b);return true};Cookie.readRaw=function(a){return new Cookie(a).readRaw()};Element.implement({getParentBySelector:function(a){try{if(!a){return $(this.parentNode)}return this.getParents(a)[0]||null}catch(b){ta.util.error.record(b,"Element.extend - getParentBySelector",null,{selector:a})}},findParentByClass:function(b){if(!this.parentNode){return null}var a=$(this.parentNode);if(a==document){return null}if(a.hasClass(b)){return a}return a.findParentByClass(b)},getLastElement:function(a){return $(this.getElements(a,true).reverse()[0]||false)},centerOnScreen:function(){var a=this.getCoordinates();this.style.left=Math.round((Window.getWidth()-a.width)/2)+Window.getScrollLeft()+"px";this.style.top=Math.round((Window.getHeight()-a.height)/2)+Window.getScrollTop()+"px"},positionOnScreen:function(b,a){this.style.left=Window.getScrollLeft()+b+"px";this.style.top=Window.getScrollTop()+a+"px"},containsEvent:function(b){if(!b||!b.page){return false}b=new Event(b);var a=this.getCoordinates();return(b.page.y>=a.top&&b.page.y<=a.bottom&&b.page.x>=a.left&&b.page.x<=a.right)},overlaps:function(b){var h=this.getCoordinates();var g=b.getCoordinates();var a=(g.left>h.left&&g.left<h.right)||(g.right>h.left&&g.right<h.right);var f=g.top>h.top&&g.top<h.bottom;var d=g.bottom>h.top&&g.bottom<h.bottom;return(f&&a)||(d&&a)},linkify:function(){var b=new Element("a",{"class":this.className,href:"javascript:;"}).set("html",this.innerHTML).replaces(this);_processLink(b);return b},setContent:function(a){if(a instanceof Array||typeOf(a)=="elements"){a.each(function(b){this.adopt($(b))},this)}else{if(typeOf(a)=="string"){this.set("html",a)}else{this.adopt($(a))}}return this},isHidden:function(){return this.getStyle("display")=="none"},inDocument:function(){return this.parentNode!=null&&this.parentNode.nodeType!=11},removePropertyEvent:function(d,b){if(d.substr(0,2)!=="on"){d="on"+d}var j="ta.call(",h=this.getProperty(d),a=h&&h.indexOf(b),g=h&&h.indexOf(")",a),f;if(!h||a<0){return}if(h.charAt(g+1)==";"){g++}if(h.charAt(a+b.length)=="("){f=h.slice(0,a)+h.slice(g+1)}else{if(a>=j.length+1&&h.substr(a-j.length-1,j.length)==j){a-=j.length+1;f=h.slice(0,a)+h.slice(g+1)}}this.setProperty(d,f&&f.trim())}});Function.implement({invokeLater:function(b,c,a){return setTimeout(this.pass(a,c),b)},executeContinuations:function(b,d){var c=Array.prototype.slice.apply(arguments);if(c.length>2){d=c[2]}if(b.length>0){var a=b[0];var e=Function.executeContinuations.partial(b.slice(1),null,d);a(e,d)}else{}},inContinuationPassingForm:function(a){return function(c,b){if(a()){if(c){c()}}else{if(b){b()}}}}});Function.implement({_:{},partial:function(){var d=this;var b=Function._;var a=Array.prototype.slice.call(arguments);var f=[],e;for(var c=0;c<arguments.length;c++){arguments[c]==b&&f.push(c)}return function(){var h=a.concat(Array.prototype.slice.call(arguments,f.length));for(var g=0;g<Math.min(f.length,arguments.length);g++){h[f[g]]=arguments[g]}for(var g=0;g<h.length;g++){if(h[g]==b){return d.partial.apply(d,h)}}return d.apply(this,h)}}});Request=Class.refactor(Request,{initialize:function(b){if(b.url){var a=String(b.url);if(!/^http/.test(a)){b.url=window.location.protocol+"//"+window.location.host+a}else{if(/^(\w+):\/\/([\w.\-]+)\/(.*)/.test(a)&&RegExp.$2!=window.location.host){b.url=RegExp.$1+"://"+window.location.host+"/"+RegExp.$3}}}if(b&&b.data&&b.data.constructor&&(b.data instanceof Array)){b.data=b.data.toQueryString()}try{if(b.trackEvent&&ta&&ta.analytics){var d=ta.analytics._toEvtParams(b.trackEvent);if(b.data){if(typeof b.data=="string"){b.data=b.data+"&"+Object.toQueryString(d)}else{if(typeof b.data=="object"){b.data=Object.merge(b.data,d)}}}else{b.data=d}}}catch(c){if(ta&&ta.util&&ta.util.error&&ta.util.error.record){ta.util.error.record(c,"Request.Absolute.initialize.trackEvent")}}return this.previous(b)},processScripts:function(c){if(this.options.keepScripts){return c}var a=c;try{a=this.previous(c)}catch(b){ta.util.error.record(b,"Request.processScripts",null,{"request url":this.options.url})}return a},send:function(a){var c=this.previous(a);if(ta&&ta.util&&ta.util.cookie){ta.util.cookie.removePIDCookie()}try{if(this.options&&this.options.trackEvent&&ta&&ta.analytics){ta.analytics._trackEventAfterAjax(this.options.trackEvent)}}catch(b){if(ta&&ta.util&&ta.util.error&&ta.util.error.record){ta.util.error.record(b,"Request.Absolute.send.trackEventAfterAjax")}}return c}});(function(){var z=this;var u=z._;var d={};var o=Array.prototype,F=Object.prototype,H=Function.prototype;var m=o.push,w=o.slice,B=o.unshift,A=F.toString,s=F.hasOwnProperty;var r=o.forEach,l=o.map,D=o.reduce,g=o.reduceRight,q=o.filter,b=o.every,C=o.some,y=o.indexOf,h=o.lastIndexOf,e=Array.isArray,E=Object.keys,p=H.bind;var G=function(J){return new k(J)};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=G}exports._=G}else{z._=G}G.VERSION="1.3.3";var f=G.each=G.forEach=function(O,N,M){if(O==null){return}if(r&&O.forEach===r){O.forEach(N,M)}else{if(O.length===+O.length){for(var L=0,J=O.length;L<J;L++){if(N.call(M,O[L],L,O)===d){return}}}else{for(var K in O){if(G.has(O,K)){if(N.call(M,O[K],K,O)===d){return}}}}}};G.defaults=function(J){f(w.call(arguments,1),function(K){for(var L in K){if(J[L]==null){J[L]=K[L]}}});return J};G.extend=function(J){f(w.call(arguments,1),function(K){for(var L in K){J[L]=K[L]}});return J};G.escape=function(J){return(""+J).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};G.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var v=/.^/;var a={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"};for(var I in a){a[a[I]]=I}var c=/\\|'|\r|\n|\t|\u2028|\u2029/g;var j=/\\(\\|'|r|n|t|u2028|u2029)/g;var t=function(J){return J.replace(j,function(K,L){return a[L]})};G.template=function(O,N,L){L=G.defaults(L||{},G.templateSettings);var M="__p+='"+O.replace(c,function(P){return"\\"+a[P]}).replace(L.escape||v,function(P,Q){return"'+\n((__t=("+t(Q)+"))==null?'':_.escape(__t))+\n'"}).replace(L.interpolate||v,function(P,Q){return"'+\n((__t=("+t(Q)+"))==null?'':__t)+\n'"}).replace(L.evaluate||v,function(P,Q){return"';\n"+t(Q)+"\n__p+='"})+"';\n";if(!L.variable){M="with(obj||{}){\n"+M+"}\n"}M="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'')};\n"+M+"return __p;\n";var K=new Function(L.variable||"obj","_",M);if(N){return K(N,G)}var J=function(P){return K.call(this,P,G)};J.source="function("+(L.variable||"obj")+"){\n"+M+"}";return J};var k=function(J){this._wrapped=J}}).call(this);if(window.IS_DEBUG==null){var IS_DEBUG=false}if(window.VERSION_MAP==null){var VERSION_MAP={}}if(window.CDNHOST==null){var CDNHOST=""}ta={overlays:{},maps:{},bmaps:{},common:{},phac:{},servlet:{},support:{},util:{},widgets:{},commerce:{},mobfull:{},photos:{},media:{},hac:{filters:{}},t4b:{},api:{maps:{}},p13n:{}};ta.id=function(a){try{return document.id(a)}catch(b){if(ta.util.error){ta.util.error.record(b,"ta.id - trouble wrapping",null,{elmtArg:ta.util.error.describe(a)})}}};ta.select=function(){if(arguments.length>1){var b=arguments[0];var a=arguments[1]}else{var b=document;var a=arguments[0]}return Slick.search(b,a,new Elements)};ta.invoke=function(a,b){a.each(function(c){c[b]()})};ta.selectInvoke=function(a,b){ta.invoke($$(a),b)};(function(a){var b={};a.store=function(c,d){b[c]=d;return d};a.retrieve=function(c){return b[c]};a.has=function(c){return typeof(b[c])!="undefined"};a.remove=function(c){var d=b[c];delete b[c];return d};a.keep=function(e,f){var d=[];var c=a.retrieve(e);if(c){if(c instanceof Array){d=c}else{d.push(c)}}if(f instanceof Array){d=d.combine(f)}else{d.push(f)}a.store(e,d)};a.merge=function(c,e){var d=a.retrieve(c)||{};a.store(c,Object.merge(d,e))};a.asInt=function(d,c){var e=parseInt(a.retrieve(d));return isNaN(e)?(c||0):e};a.asFloat=function(d,c){var e=parseFloat(a.retrieve(d));return isNaN(e)?(c||0):e}})(ta);ta.load=function(b,f){var e=false;var c=ta.findFileKey(b);if(c){e=VERSION_MAP[c]}if(e){var a=c+"_callback";if(ta.has(a)){var d=ta.retrieve(a);d.push(f);ta.store(a,d)}else{ta.store(a,[function(){delete VERSION_MAP[c];if(f){f()}}]);Asset.javascript(e,{onLoad:function(){var g=ta.remove(a);g.each(function(h){h()})}})}}return e};ta.findFileKey=function(f){if(typeof f!="string"||!VERSION_MAP){return}var d=false;var c=false;if(VERSION_MAP[f]){c=f}else{if(VERSION_MAP[f+".js"]){c=f+".js"}else{var a=f.split(".");var b=0;while(a&&a.length>1&&b<10){a=a.slice(0,-1);var e=a.join("-")+".js";if(e&&VERSION_MAP[e]){c=e;break}b++}}}return c};ta.findFile=function(c){var a=ta.findFileKey(c);var b=false;if(a){b=VERSION_MAP[a];delete VERSION_MAP[a]}return b};(function(ta){ta.call=function(funcName,evnt,elmt){if(evnt==null){if(IS_DEBUG){alert("You must pass the event.\n\nUsage:\nta.call('ta.namespace.Class.function', event);")}return false}if(!/^ta\.[\w\d\.]+$/.test(funcName)){if(IS_DEBUG){alert("Invalid function name. Must be of the form: ta.namespace.Class.function")}return false}var e=new Event(evnt||window.event);if(!elmt){elmt=e.target}elmt=ta.id(elmt);if(!elmt){ta.util.error.record(null,"ta.call re-wrap fail (non-DOM element) - "+funcName,evnt,{elmtArg:ta.util.error.describe(orgElem||{none:"none"}),funcName:funcName});elmt=orgElem}else{if(!elmt.$family){ta.util.error.record(null,"ta.call re-wrap fail - "+funcName,evnt,{elmtArg:ta.util.error.describe(elmt),funcName:funcName})}}var argSet=arguments;var args=Array.from(argSet).slice(3);args.splice(0,0,e,elmt);try{args.unshift({callback:_ta_call_defer,evt:e});args.unshift(funcName);return ta.run.apply(null,args)}catch(_ex){ta.util.error.record(_ex,"ta.call - "+funcName,evnt)}return false};var _ta_call_defer=function(func,options){if(options){delete (options.evt)}ta.run.apply(null,arguments)};ta.run=function(func,options){var argSet=arguments,args=Array.from(argSet).slice(2);try{var fn=ta.fn(func);if(fn&&typeOf(fn)==="function"){var retVal=fn.apply(window,Array.from(args));if(options&&options.onComplete){var completeFun=ta.fn(options.onComplete);if(completeFun){completeFun(retVal)}}return retVal}else{if(options&&options.evt){new Event(options.evt).preventDefault()}}var callback=options&&options.callback;ta.load(func,(callback||ta.run).pass(arguments))}catch(_ex){ta.util.error.record(_ex,"ta.run - "+func)}return false};var EVENT_PASSED=function(args){this.args=args};ta.on=function(name,f){var v=ta.retrieve(name);if(v instanceof EVENT_PASSED){setTimeout(function(){f.attempt(v.args)},0)}else{ta.keep(name,f)}};ta.fireNonRecurringEvent=function(name){var listeners=ta.retrieve(name);var args=Array.from(arguments);args.shift();ta.store(name,new EVENT_PASSED(args));if(listeners instanceof Array){listeners.each(function(x){x.attempt(args)})}};ta.fireEvent=function(){var args=Array.from(arguments);var event=args.shift();var listeners=ta.retrieve(event);if(listeners){listeners.each(function(callback){callback.attempt(args)})}};ta.fireEventAndUnregister=function(){var args=Array.from(arguments),event=args.shift(),listeners=ta.remove(event);listeners&&listeners.each(function(callback){callback.attempt(args)})};var OneTimeFunctionQueue=function(evtName){var _queue=[];var _runNow=false;var _execFn=function(fn,name){try{fn()}catch(_ex){try{ta.util.error.record(_ex,"OneTimeFunctionQueue "+evtName+(name?"-"+name:""))}catch(ignore){}}};var _runQueuedFunctions=function(){_queue.sort(function(a,b){return a.priority-b.priority});for(var i=0;i<_queue.length;++i){_execFn(_queue[i].func,_queue[i].name)}_queue=[]};if(evtName!=null){window.addEvent(evtName,function(){_runNow=true;_runQueuedFunctions()})}this.addToQueue=function(fn,priority,name){if(!fn){ta.util.error.record(null,"addToQueue for "+evtName+" queue - no function");return}if(typeof priority==="string"){name=priority;priority=false}if(_runNow){_execFn(fn,name)}else{priority=priority||(100+_queue.length);_queue.push({func:fn,priority:priority,name:name})}};this.executeQueue=function(){_runQueuedFunctions()}};var _readyQ=new OneTimeFunctionQueue("domready");var _loadQ=new OneTimeFunctionQueue("load");var _lazyImgQ=new OneTimeFunctionQueue(null);ta.queueForReady=function(fn,priority,name){_readyQ.addToQueue(fn,priority,name)};ta.queueForLoad=function(fn,priority,name){_loadQ.addToQueue(fn,priority,name)};ta.queueLazyImg=function(element){var priority;try{priority=element.priority||1000}catch(ignore){return}var _fn=function(){try{if(element.oSRC!=""){element.src=element.oSRC;element.oSRC="";element.priority=""}}catch(e){ta.util.error.record(e,"lazy img",null,{src:element.src,oSRC:element.oSRC})}};_lazyImgQ.addToQueue(_fn,priority)};ta.processLazyImages=function(){_lazyImgQ.executeQueue()};ta.fn=function(fn){switch(typeof(fn)){case"function":return fn;case"string":var f=false;try{f=eval(fn)}catch(e){}if(!f){var ns=fn.split("."),n=ns.pop();try{ns=eval(ns.join("."));f=ns&&ns._magic&&ns._magic.partial(n)}catch(e){}}if(f&&typeof(f)==="function"){return f}break}return null}}(ta));(function(h,e,c){e=h.ta=h.ta||{};e.analytics||(e.analytics={});var f=function(){if(e&&e.util&&e.util.error&&e.util.error.record){e.util.error.record.apply(this,arguments)}};var d=function(o){if(o==c||o==null){return""}if(typeof o!=="string"){o=o.toString()}return o.replace(/!/g,"!!").replace(/\./g,"!.").replace(/\*/g,"!*")};var m=function(r){var o=[];for(var p in r){var q=r[p];o.push(d(p)+"."+d(q))}return o.join("*")};var a=function(o){var p=/(http:\/\/[^\/]+)?\/([^.?-]*)/;var q=p.exec(o);var r={};if(q){if(typeof q[2]!="undefined"){return(q[2])?q[2]:"Home"}}return null};var j=function(){var o=e.analytics.pageData&&e.analytics.pageData.length&&e.analytics.pageData[e.analytics.pageData.length-1];if(o&&o.url){return o.url.substring(1)}else{var p=/\/([^-]*)/.exec(h.location.pathname);return p?p[1]:null}};var b=function(q,o,r){var p=new RegExp("(-"+o+"([0-9]+))|([?&]"+r+"=([0-9]+))");var s=p.exec(q);if(s){if(typeof s[2]!="undefined"){return s[2]}if(typeof s[4]!="undefined"){return s[4]}}return null};var l=function(o){var p=b(o,"d","detail");if(p){return p}var q=b(o,"g","geo");return q};var k=function(q,p){var o={gac:q[1],gaa:q[2],gal:q[3],gav:q[4],gani:q[5],gass:j(),gasl:l(document.location.href),gads:a(p),gadl:l(p)};if(!o.gass){throw new Error("Src servlet undefined")}if(!o.gads){throw new Error("Dst servlet undefined")}Cookie.write("EVT",m(o),{domain:cookieDomain,time:300})};var g=function(o){return new Request({url:"/GARecord",data:{gac:o[1],gaa:o[2],gal:o[3],gav:o[4],gani:o[5],gass:j(),gasl:l(document.location.href)}})};e.analytics._JSON_parse=function(o){if(JSON.parse){return JSON.parse(o)}if(JSON.decode){return JSON.decode(o)}throw new Error("No JSON.parse or JSON.decode")};e.analytics._insertGAScriptElement=function(){try{var q=document.createElement("script");q.type="text/javascript";q.async=true;q.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(q,o)}catch(p){f(p,"loading ga.js problem")}};e.analytics._validatedTrackEventArray=function(q,s,o,r,p){if(!r){r=0}else{if(typeof r!="number"){r=parseFloat(r);if(isNaN(r)){r=0}}}if(typeof p!="boolean"){p=p==true}return["_trackEvent",q,s,o,r,p]};e.analytics._toEvtParams=function(q){try{if(typeof(_gaq)!="undefined"&&_gaq.push){var o={gac:q.module,gaa:q.action,gal:q.context,gav:q.value,gani:q.noninteraction};o.gass=j();o.gasl=l(document.location.href);return o}else{return{}}}catch(p){f(p,"ta.analytics._toEvtParams",null,q)}};e.analytics._trackEventAfterAjax=function(q){try{if(typeof(_gaq)!="undefined"&&_gaq.push){var o=e.analytics._validatedTrackEventArray(q.module,q.action,q.context,q.value,q.noninteraction);_gaq.push(o)}}catch(p){f(p,"ta.analytics._trackEventAfterAjax",null,q)}};e.trackPhysicalCommerce=function(p,o,s){try{if(typeof(_gaq)!="undefined"&&_gaq.push){var q=e.analytics._validatedTrackEventArray(p,"Commerce-Physical",o,s,false);_gaq.push(q);g(q).get()}}catch(r){f(r,"ta.trackPhysicalCommerce",null,arguments)}};e.trackAttemptedCommerce=function(p,o,r,s){try{if(typeof(_gaq)!="undefined"&&_gaq.push){_gaq.push(["_setCustomVar",15,"Provider",r],e.analytics._validatedTrackEventArray(p,"Commerce-Attempted",o,s,false),["_deleteCustomVar",15])}}catch(q){f(q,"ta.trackAttemptedCommerce",null,arguments)}};e.trackEventOnPage=function(p,t,o,s,r){try{if(typeof(_gaq)!="undefined"&&_gaq.push){var q=e.analytics._validatedTrackEventArray(p,t,o,s,r);_gaq.push(q);g(q).get()}}catch(u){f(u,"ta.trackEventOnPage",null,arguments)}};e.setEvtCookie=function(q,t,p,s,o){try{if(typeof(_gaq)!="undefined"&&_gaq.push){var r=e.analytics._validatedTrackEventArray(q,t,p,s,false);k(r,o)}}catch(u){f(u,"ta.setEvtCookie",null,arguments)}}})(window,ta);(function(a){Object.append(a,{isHotelsRedesign2011:function(){if(ta.has("hac.isHotelsRedesign2011")){return ta.retrieve("hac.isHotelsRedesign2011")}var c=ta.id("HAC_SMRY");var b=c&&c.hasClass("hotels_re_2011");ta.store("hac.isHotelsRedesign2011",b);return b},isSmartDealsFilters:function(){if(ta.has("smartdeals.isSmartDealsFilters")){return ta.retrieve("smartdeals.isSmartDealsFilters")}var b=ta.id("DEALS");var c=b&&b.hasClass("sdfilters");ta.store("smartdeals.isSmartDealsFilters",c);return c},isDHTMLCRRedesign2012:function(){if(ta.has("overlays.isDHTMLCRRedesignBasic")){return ta.retrieve("overlays.isDHTMLCRRedesignBasic")}var b=$$(".overlay");var c=b&&b.hasClass("rgba_flyout");ta.store("overlays.isDHTMLCRRedesignBasic",c);return c},isRestaurantsRedesign2012:function(){if(ta.has("eateries.isRestaurants")){return ta.retrieve("eateries.isRestaurants")}var c=ta.id("EATERIES_2012");var b=c&&c.hasClass("gridA");ta.store("eateries.isRestaurants",b);return b},isAttractionsRedesign2012:function(){if(ta.has("attractions.isAttractions")){return ta.retrieve("attractions.isAttractions")}var b=ta.id("ATTRACTIONS_2012");var c=b&&b.hasClass("gridA");ta.store("attractions.isAttractions",c);return c}})})(ta);ta.browser={isIE9orHigher:function(){if(Browser.ie&&Browser.version>=9){return true}return false},isIE10Metro:function(){var b=null,a=(window.innerWidth==screen.width&&window.innerHeight==screen.height);try{b=!!new ActiveXObject("htmlfile")}catch(d){b=false}var c=ta.retrieve("metaCheckRatesDebugFeatureEnabled");if(c){return true}else{return navigator.userAgent.contains("MSIE 10.0")&&!b&&a}}};ta.util.cookie={expireTimeForPID:5,expireTimeForPID_remove:0,cookiePIDName:"NPID",setPIDCookie:function(a){try{Cookie.write(ta.util.cookie.cookiePIDName,a,{domain:cookieDomain,time:ta.util.cookie.expireTimeForPID})}catch(b){var c="";if(typeof cookieDomain!="undefined"){c=cookieDomain}ta.util.error.record(b,"set pid cookie",null,{pid:a,cookieDomain:c})}},removePIDCookie:function(){try{Cookie.write(ta.util.cookie.cookiePIDName,"",{domain:cookieDomain,time:ta.util.cookie.expireTimeForPID_remove})}catch(a){}},setPID:function(b,a){if(ta.id(a).get("tag")!="a"){a=a.getParent("a")}if(pid=a.className.match(/pid(\d+)/)){ta.util.cookie.setPIDCookie(pid[1])}},setPIDNoA:function(a){pid=a.className.match(/pid(\d+)/);if(pid){ta.util.cookie.setPIDCookie(pid[1])}},showCookieBanner:function(){try{var b=ta.id("COOKIE_BANNER"),c=$(document.body);if(b&&c){b.inject(c,"top");b.setStyles({position:"fixed",top:-3000,left:-3000});b.show();var a=b.getHeight();b.setStyle("margin-top",0-a);b.hide();b.setStyles({top:0,left:0,position:"relative"});b.show();b.set("tween",{duration:"long"});b.tween("margin-top",0);Cookie.write("cookieconsent","1",{duration:3600})}}catch(d){ta.util.error.record(d,"ta.util.cookie.showCookieBanner")}}};setPID=ta.util.cookie.setPIDCookie;ta.util.ASDF={asdf:function(b,a){if(a){ta.util.cookie.setPIDCookie(a)}window.location=asdf(b)},asdfPxlAndPid:function(d,b,a){var e="http://ad.doubleclick.net/ad/";var c=";sz=1x1";if(a){ta.util.cookie.setPIDCookie(a)}if(b){new Element("img",{src:e+b+c})}window.location=asdf(d)},asdfPopup:function(b,a){if(a){ta.util.cookie.setPIDCookie(a)}ta.servlet.Popup.open(asdf(b))},asdfPopupEmail:function(a){ta.servlet.Popup.open(asdf(a),"email",580,460,30,25)},asdfPopupGuide:function(a){ta.servlet.Popup.open(asdf(a),"dest_guide",565,700,(screen.width-700)/2,(screen.height-600)/2)},asdfPopupTerms:function(a){ta.servlet.Popup.open(asdf(a),"terms",300,300,30,25)},asdfPopupDir:function(a){new Request({url:"/ActionRecord?action=getDirectionsListings"}).send();ta.servlet.Popup.open(asdf(a),null,800,600)},asdfDcd:function(a){return asdf(a)}};function getOffset(a){if(a>=97&&a<=122){return a-61}if(a>=65&&a<=90){return a-55}if(a>=48&&a<=71){return a-48}return -1}function asdf(d){var g={"":["&","=","p","6","?","H","%","B",".com","k","9",".html","n","M","r","www.","h","b","t","a","0","/","d","O","j","http://","_","L","i","f","1","e","-","2",".","N","m","A","l","4","R","C","y","S","o","+","7","I","3","c","5","u",0,"T","v","s","w","8","P",0,"g",0],q:[0,"__3F__",0,"Photos",0,"https://",".edu","*","Y",">",0,0,0,0,0,0,"`","__2D__","X","<","slot",0,"ShowUrl","Owners",0,"[","q",0,"MemberProfile",0,"ShowUserReviews",'"',"Hotel",0,0,"Expedia","Vacation","Discount",0,"UserReview","Thumbnail",0,"__2F__","Inspiration","V","Map",":","@",0,"F","help",0,0,"Rental",0,"Picture",0,0,0,"hotels",0,"ftp://"],x:[0,0,"J",0,0,"Z",0,0,0,";",0,"Text",0,"(","x","GenericAds","U",0,"careers",0,0,0,"D",0,"members","Search",0,0,0,"Post",0,0,0,"Q",0,"$",0,"K",0,"W",0,"Reviews",0,",","__2E__",0,0,0,0,0,0,0,"{","}",0,"Cheap",")",0,0,0,"#",".org"],z:[0,"Hotels",0,0,"Icon",0,0,0,0,".net",0,0,"z",0,0,"pages",0,"geo",0,0,0,"cnt","~",0,0,"]","|",0,"tripadvisor","Images","BookingBuddy",0,"Commerce",0,0,"partnerKey",0,"area",0,"Deals","from","\\",0,"urlKey",0,"'",0,"WeatherUnderground",0,"MemberSign","Maps",0,"matchID","Packages","E","Amenities","Travel",".htm",0,"!","^","G"]};var b="";for(var a=0;a<d.length;a++){var h=d.charAt(a);var e=h;if(g[h]&&a+1<d.length){a++;e+=d.charAt(a)}else{h=""}var f=getOffset(d.charCodeAt(a));if(f<0||typeof g[h][f]=="String"){b+=e}else{b+=g[h][f]}}return b}ta.util.Doer={doit:function(e,d){var c="/"+e;var b=0;for(var a in d){if(b===0){c+="?"}else{c+="&"}c+=a+"="+d[a];b++}return c},aimdoit:function(j,c,a,k){var b=ta.util.Doer.doit(j,c);new Event(a).preventDefault();var g=475;var d=390;var f=210;var e=5;if(k){g=980;d=800;f=240}else{if(screen.width>=1024&&screen.height>=768&&c&&(c.area=="Text_Photos"||c.area=="Thumbnail")){g=900;d=768;f=240}else{if(screen.width>1024){g=800;d=600;f=240}else{if(screen.width>800){g=620;d=500;f=240}}}}ta.store("commerce.AIMWindow",ta.servlet.Popup.open(b,null,g,d,f,e,false,true));if(ta.retrieve("checkrates.isCRLB")){ta.run("ta.overlays.Factory.loadCheckRatesLBOverlay",{},a,null,c)}},tadoit:function(d,b,c,a){window.location=ta.util.Doer.tadoless(d,b,c,a)},tadoless:function(g,c,f,j,b){var a="/"+g;for(var h in c){a+="-"+h+c[h]}var e=f.length;for(var d=0;d<e;d++){a+="-"+f[d]}if(!b){a+=".html"}if(j.length>0){a+=j}return a}};ta.util.pending={};ta.util.pending.waitForMore=function(e,c,a,b,d){if(ta.has("pending."+e)){ta.util.pending.cancel(e)}ta.store("pending."+e,{timer:c.delay(a,d,b),fn:c,t:"m",n:a})};ta.util.pending.waitForFn=function(id,fn){try{var tmp=eval(fn),data;if(tmp){if(typeOf(tmp)==="function"){if(ta.has("pending.callback."+id)){ta.retrieve("pending.callback."+id)()}else{if(ta.has("pending."+id)){data=ta.retrieve("pending."+id);if(data.evnt){tmp.attempt([data.evnt,data.elmt])}else{tmp.attempt()}}else{tmp.attempt()}}}else{if(IS_DEBUG){alert("fn is not a function: "+typeOf(tmp))}}}else{ta.util.pending.waitForFnAgain(id,fn)}}catch(e){ta.util.pending.waitForFnAgain(id,fn)}};ta.util.pending.WAIT_DELAY=100;ta.util.pending.WAIT_TIMEOUT=50;ta.util.pending.waitForFnAgain=function(c,a){var b=ta.has("pending."+c)?ta.retrieve("pending."+c):{t:"f",fn:a,count:1};if(b.count<ta.util.pending.WAIT_TIMEOUT){b.count++;b.timer=ta.util.pending.waitForFn.invokeLater(ta.util.pending.WAIT_DELAY,null,[c,a]);ta.store("pending."+c,b)}else{if(IS_DEBUG&&!ta.has("pending.ignore."+c)){alert("timed out ("+(ta.util.pending.WAIT_TIMEOUT*ta.util.pending.WAIT_DELAY)+"ms) waiting for function: "+a)}}};ta.util.pending.waitForFile=function(c,a,b){if(ta.load(a)){ta.util.pending.waitForFn(c,b)}};ta.util.pending.waitForHandler=function(d,b,c,a){ta.store("pending."+d,{count:0,t:"f",fn:b,evnt:c,elmt:a});ta.util.pending.waitForFn(d,b)};ta.util.pending.cancel=function(b){var a=ta.remove("pending."+b);if(a&&a.timer){clearTimeout(a.timer)}};ta.util.pending.lock=function(d,b,c,a){if(ta.has("pending."+d)){return[a,false].pick()}ta.store("pending."+d,true);if(c){ta.util.pending.unlock.delay(c,null,d)}return b()};ta.util.pending.unlock=function(b){var a=ta.remove("pending."+b);if(a&&typeof a==="object"){a.count--;if(a.count===0){a.fn()}else{ta.store("pending."+b,a)}}};ta.util.pending.multilock=function(c,a,b){ta.store("pending."+c,{count:b,fn:a})};ta.util.pending.multilockUpdate=function(d,c){var b="pending."+d,a=ta.retrieve(b);if(a){a.count+=c}};ta.util.pending.wait=function(e,c,b,d,a){ta.store("pending."+e,{timer:c.delay(b,d,a)})};ta.util.pending.waitForElement=function(d,a,c){if(ta.has("pending."+d)){return}var b=$(a);if(b){ta.util.pending.cancel("pending."+d);c(b)}else{ta.store("pending."+d,{timer:ta.util.pending.waitForElement.delay(2,null,[d,a,c])})}};ta.util.pending.waitFor=function(a,c,b){if(a()){return c()}setTimeout(function(){ta.util.pending.waitFor(a,c,b)},b);return false};ta.util.load={loadedMap:false,loadingMap:false,callbacks:[]};ta.util.load.GMaps=function loadGMaps(a){return ta.util.load.maps(a)};ta.util.load.maps=function(a){if(ta.util.load.loadedMap){a&&a()}else{if(ta.util.load.loadingMap){ta.util.load.callbacks.push(a)}else{ta.util.load.loadingMap=true;return ta.maps.load.library(function(){ta.util.load.loadedMap=true;ta.util.load.loadingMap=false;a&&a();ta.util.load.callbacks.each(function(b){b&&b()})})}}};ta.util.load.mapsLazy=function(a){return ta.run("ta.maps.load.library",{},a)};ta.util.load.GoogleLoader=function(a){if(ta.has("googleloader.state")){if(ta.retrieve("googleloader.state")=="loaded"){return a()}else{return ta.util.load.GoogleLoader.delay(500,this,a)}}else{ta.store("googleloader.state","loading");ta.store("googleloader.callback",a);new Asset.javascript("http://www.google.com/jsapi?callback=ta.util.load.GoogleLoaderCallback")}};ta.util.load.GoogleLoaderCallback=function(){ta.store("googleloader.state","loaded");var a=ta.remove("googleloader.callback");a()};ta.util.load.LocalSearch=function(a){ta.util.load.GoogleLoader(function(){google.load("search","1",{callback:function(){}})})};ta.util.date={};ta.util.date.MS_IN_DAY=1000*60*60*24;ta.util.date.DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31];ta.util.date.inDateSet=function(c,b){if((c==null)||(b==null)){return false}var e=b.length;for(var d=0;d<e;d++){var f=b[d];if(f.length){var g=f[0].getTime();var a=f[1].getTime();if((g<=c.getTime())&&(a>=c.getTime())){return true}}else{if(c.getTime()==f.getTime()){return true}}}return false};ta.util.date.rangesIntersect=function(a,b){return Math.max(a[0].getTime(),b[0].getTime())<=Math.min(a[1].getTime(),b[1].getTime())};ta.util.date.getDaysInRange=function(b,a){return Math.round((a.getTime()-b.getTime())/ta.util.date.MS_IN_DAY)+1};ta.util.date.inSameMonth=function(b,a){return(b!=null)&&(a!=null)&&(b.getMonth()==a.getMonth())&&(b.getYear()==a.getYear())};ta.util.currency={};ta.util.currency.formatCurrency=function(c,a){var e=a?a:"USD";var b=currencySymbol[e];var d=ta.util.currency.formatThousands(Math.round(c));if(!b[1]){return b[0]+d}else{return d+b[0]}};ta.util.currency.formatThousands=function(b){if(typeof groupingSize=="undefined"||typeof groupingSeparator=="undefined"||groupingSize<1){return b}var a="";var d=""+b;for(var c=1;c<=d.length;c++){a=d.charAt(d.length-c)+a;if(c%groupingSize==0&&c<d.length){a=groupingSeparator+a}}return a};ta.util.Toggle={};ta.util.Toggle.siblings=function(c,b){c.preventDefault();var a=true;if(b.hasClass("closed")){a=false}b.toggleClass("closed sprite-arrow_toggle_blu_lft");b.getParent().getChildren().each(function(d){if(d!=b){d.setStyle("display",a?"none":"block")}})};ta.util.Toggle.parentClass=function(c,a){c.preventDefault();var b=a.getParent(".toggle");b.toggleClass("off")};ta.util.Toggle.toggleTarget=function(d,b,c){d.preventDefault();var a=true;if($(b).hasClass("closed")){a=false}$(b).toggleClass("closed");$(b).toggleClass("open");$(c).setStyle("display",a?"none":"block")};ta.util.Toggle.toggleForm=function(b,d,c){var a=$(b).getParent(".formToggle");if(/sel_(\w+)/.test(a.className)){var e=RegExp.$1;a.removeClass("sel_"+e);a.getElement(".form_"+e).hide();var f=a.getElement(".header_"+e);if(f){f.hide()}}a.addClass("sel_"+d);var f=a.getElement(".header_"+d);if(f){f.show()}a.getElement(".form_"+d).show();return false};ta.util.Toggle.toggleLI=function(e,d,a){var c=e.getNext();for(var b=0;b<1000&&c&&c.id!=d.id;b++){if(a){c.show()}else{c.hide()}c=c.getNext()}if(a){e.hide()}else{e.show()}if(a){d.show()}else{d.hide()}};ta.util.URL={parse:function(c){if(/^(\w+):(.*)/.test(c)){c=RegExp.$2;switch(RegExp.$1){case"DOM":elmt=document.getElement(c);c=(elmt&&elmt.href)?elmt.href:"#";break;case"GMapsLC":if(c.length==0){break}tmp=c.split(",");ops={from:pageServlet,Action:tmp.shift()};tmp.each(function(d){if(/^g(\d+)$/.test(d)){ops.g=RegExp.$1}else{if("ext"==d){ops.ext="y"}else{if(/^(.*)=(.*)$/.test(d)){ops[RegExp.$1]=RegExp.$2}else{ops[d]=""}}}});c="/GMapsLocationController?"+Object.toQueryString(ops);break;case"ABS":var a=(window.location.port=="80"||window.location.port=="")?"":(":"+window.location.port);if(c.charAt(0)!="/"){c="/"+c}c=window.location.protocol+"//"+window.location.hostname+a+c;break;case"ABSPAGE":var a=(window.location.port=="80"||window.location.port=="")?"":(":"+window.location.port);if(c.charAt(0)!="/"){c="/"+c}c=window.location.protocol+"//"+window.location.hostname+a+c;if(c.indexOf(".html")==-1){c+=".html"}break;case"REL":var b=window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/"));if(/\/$/.test(window.location.pathname)){b=window.location.pathname}var a=window.location.port=="80"?"":(":"+window.location.port);if(c.charAt(0)!="/"){c="/"+c}c=window.location.protocol+"//"+window.location.hostname+a+b+c;break;default:c=RegExp.$1+":"+c;break}}return c},getParameter:function(c,a){var b=new RegExp("[?&]"+a+"=([^&]+)");if(b.test(c)){return RegExp.$1}return false}};ta.util.i18n={};ta.util.i18n.isRtl=function(){return ta.id(document.body).hasClass("rtl")};ta.util.element={};ta.util.element.replaceContent=function(f,e,c){var d=f;var b=e;if(!b.getElement(".progresstab")){var a=c+(c.indexOf("?")==-1?"?":"&")+"xhr=true";var g=new Element("div",{"class":"progresstab"});g.inject(b);new Request({url:a,onSuccess:function(h,j){b.empty();b.innerHTML=h;if(window.behavior){window.behavior.apply(b)}b.fireEvent("onContentReplaced",[d,b])},evalScripts:true}).get()}};ta.util.element.spinner=function(b,a){$(a).getParent(".spinnerReplaceable").getChildren().each(function(c){if(c.hasClass("spinner")){c.show()}else{c.hide()}})};ta.util.element.clearDefault=function(b,a){if(a.value==a.defaultValue){a.value=""}};ta.util.element.limitLength=function(b,a,c){if(a.value.length>=c){a.value=a.value.substr(0,c);return false}};ta.util.link={ajaxSubmit:function(a,c,b){if(a){new Event(a).preventDefault()}if(b){ta.util.cookie.setPIDCookie(b)}if(!c.className.match(/\bform_(\w+)\b/)){return}var f=$(RegExp.$1);var e={url:c.href,data:f,onFailure:function(h){if(f){f.removeClass("ajaxInFlight")}ta.util.error.ajaxFailure("link - ajaxSubmit",h)}};var g=window["callback"+f.id];if(c.className.match(/method_(\w+)\b/)){e.method=RegExp["$1"]}if(c.className.match(/\btgt_(\w+)\b/)){e.update=RegExp["$1"]}else{e.onSuccess=function(h){if(f){f.removeClass("ajaxInFlight")}ta.overlays.showInLightbox(h);if(g&&typeOf(g)=="function"){g()}}}var d=window["validate"+f.id];if(d&&typeOf(d)=="function"&&d.apply(f)==false){return}f.addClass("ajaxInFlight");if(c.className.match(/\bevalScripts\b/)){e.evalScripts=true}(e.update?new Request.HTML(e):new Request(e)).send()},ajaxCall:function(a,b){if(a){new Event(a).preventDefault()}if(!(tgt=b.className.match(/\btgt_(\w+)\b/))){return}tgt=$(tgt[1]);new Request.HTML({url:b.href,update:tgt,onFailure:ta.util.error.ajaxFailure.partial("link - ajaxCall")}).send()},popResWidth:function(b,e,d){try{var a=475,f=390,j=210;if(screen.width>1024){a=800;f=600;j=240}else{if(screen.width>800){a=620;f=500;j=240}}var g=Object.merge({width:a,height:f,xOffset:j,yOffset:5},d);ta.util.link.popup(b,e,g)}catch(c){ta.util.error.record(c,"ta.util.link - popCustom",b,g)}},popPhoto:function(a,d,c){try{Cookie.write("PhotoPop","1",{domain:cookieDomain});var e=Object.merge({name:"media",width:782,height:820},c);ta.util.link.popup(a,d,e)}catch(b){ta.util.error.record(b,"ta.util.link - popPhoto",a,e)}},popup:function(o,a,k){try{var g=Object.merge({name:false,width:950,height:610,xOffset:false,yOffset:false,noScroll:0,aHref:false,fullOptions:true,ensureReferrer:false,isAsdf:false},k);new Event(o).preventDefault();var f=false,b="",m=false;var c=1;if(ta.has("ta.popups.popupIndex")&&typeof ta.retrieve("ta.popups.popupIndex")!="undefined"){c=ta.retrieve("ta.popups.popupIndex")}if(!g.aHref){g.aHref=a.href}if(g.isAsdf&&g.aHref){if(ta.util.ASDF.asdfDcd){g.aHref=ta.util.ASDF.asdfDcd(g.aHref).replace(/&amp;/g,"&")}}if(g.aHref&&g.aHref.indexOf("p=HotelsCom")>-1){g.width=Math.max(g.width,960);try{g.height=Math.max(g.height,window.getHeight(),600)}catch(h){g.height=Math.max(g.height,600)}}if(g.width){b+=",width="+g.width}if(g.height){b+=",height="+g.height}if(g.xOffset){b+=",screenX="+g.xOffset+",left="+g.xOffset}if(g.yOffset){b+=",screenY="+g.yOffset+",top="+g.yOffset}if(!Browser.chrome){g.noScroll=1}if(g.fullOptions){var j=1;if(ta.browser.isIE9orHigher()){j=0}b="toolbar=1,resizable=1,menubar="+j+",location=1,status=1,scrollbars="+g.noScroll+b}else{b="toolbar=0,resizable=1,menubar=0,location=0,status=0,scrollbars="+g.noScroll+b}if(!g.name){g.name="p"+(c++)}ta.store("ta.popups.popupIndex",c);if(g.ensureReferrer&&Browser&&Browser.ie){try{m=new Element("a",{target:g.name,href:g.aHref});m.inject(ta.id(document.body),"bottom");f=window.open("",g.name,b);m.click();m.destroy()}catch(d){ta.util.error.record(d,"ta.util.link - pop ensure referrer",o,g)}}else{try{f=window.open(g.aHref,g.name,b)}catch(h){ta.util.error.record(h,"ta.util.link - popping window",o,{href:g.aHref,name:g.name,args:b})}}if(typeof f!="undefined"&&f!==null){try{f.opener=self;f.focus()}catch(d){}}}catch(l){ta.util.error.record(l,"ta.util.link - popup",o,g)}},directionsPop:function(a,c,b,d){if(d){new Request({url:"/ActionRecord?action="+d}).send()}if(ta.trackEventOnPage){ta.trackEventOnPage("map_pin_overlay","directions_click")}ta.util.link.popup(a,c,b)},remTAPD:function(a,b){Cookie.dispose("TAPD",{domain:cookieDomain})},phacRadio:function(a,c,b){if(!ta.has("phacRadioClicked")){ta.store("phacRadioClicked",true);new Request({url:"/ActionRecord?action=HotelReviewSearchTypeChangedTo"+c.value}).send()}showHidePhac(b)}};(function(a){a.util.localstorage={};a.util.localstorage.canUseLocalStore=function(){try{if(window.localStorage){var c="taLsTest";localStorage.setItem(c,"1");var b=localStorage.getItem(c);return(b=="1")}}catch(d){return false}}}(ta));(function(c){c.util||(c.util={});var a=["success","failure","always","progress"];var f={resolved:["success","always"],rejected:["failure","always"]};var h=function(){};for(var e=0;e<a.length;e++){(function(j){h.prototype[j]=function(l,k){return b(this,j,k?l.bind(k):l)}}(a[e]))}c.util.Deferred=function(){var j="pending";var l=new h();l.queue=[];l.args=null;l.status=function(){return j};var k={notify:function(){if(d(j)){throw new Error("Promise has already been fulfilled.")}var o=Array.prototype.slice.call(arguments);var q,p,m;for(p=0,m=l.queue.length;p<m;p++){q=l.queue[p];if(q.hook=="progress"){q.callback.apply(null,o)}}return l},resolve:function(){if(d(j)){throw new Error("Promise has already been fulfilled.")}j="resolved";l.args=Array.prototype.slice.call(arguments);return g(l)},reject:function(){if(d(j)){throw new Error("Promise has already been fulfilled.")}j="rejected";l.args=Array.prototype.slice.call(arguments);return g(l)},promise:function(){return l}};return k};var d=function(j){return j=="resolved"||j=="rejected"};var b=function(k,j,l){k.queue.push({hook:j,callback:l});return g(k)};var g=function(l){var k,j;while(d(l.status())&&(k=l.queue.shift())){if(~f[l.status()].indexOf(k.hook)){j=k.callback.apply(null,l.args);if(j instanceof h){j.queue=j.queue.concat(l.queue);l=j}}}return l}}(ta));ta.util.decoder={base64Decoder:function(g){g=g.replace(/\-/g,"+").replace(/\_/g,"/");if(g.length%4!==0){var h=4-g.length%4;for(var f=0;f<h;f++){g=g+"="}}var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a="",r,p,l="",q,o,k,j="";for(var e=0;e<g.length;e+=4){q=d.indexOf(g.charAt(e));o=d.indexOf(g.charAt(e+1));k=d.indexOf(g.charAt(e+2));j=d.indexOf(g.charAt(e+3));if(q==-1||o==-1||k==-1&&j==-1){ta.util.error.record(null,"Facebook signed request contains invalid base64 letter",null,{code:g});return}r=(q<<2)|(o>>4);p=((o&15)<<4)|(k>>2);l=((k&3)<<6)|j;a=a+String.fromCharCode(r);if(k!=64){a=a+String.fromCharCode(p)}if(j!=64){a=a+String.fromCharCode(l)}r=p=l="";q=o=k=j=""}return unescape(a)}};ta.util.files={reset:function(a){if(Browser.ie){a.clone(false,true).replaces(a)}else{a.value=""}},upload:function(c,e,g){function b(k,h){var l;try{l=document.createElement("<"+k+' name="'+h+'">')}catch(j){l=document.createElement(k);l.setAttribute("name",h)}return l}var f="upload_iframe_"+(Math.random()+"").split(".")[1];var d=b("iframe",f);d.setAttribute("id",f);d.setAttribute("src","about:blank");d.setAttribute("width","0");d.setAttribute("height","0");d.setAttribute("border","0");d.setAttribute("style","width:0; height:0; border:none; display:none; ");document.body.appendChild(d);c.target=f;function a(){ta.id(d).removeEvent("load",a);var h=d.contentWindow.document;g(h);setTimeout(function(){d.parentNode.removeChild(d)},250)}ta.id(d).addEvent("load",a);c.submit()}};ta.common.search={langSelect:function(b,a){if(a.form.elements.q.value.length>0){a.form.submit()}},clearOnFocus:function(b,a){if(a.value==a.defaultValue){a.value="";a.removeClass("focusClear")}},defaultOnBlur:function(b,a){if(a.value==""){a.addClass("focusClear");a.value=a.defaultValue}},validate:function(b,a){if(a.q.value==""||$(a.q).hasClass("focusClear")){return false}setOneTimeCookie("SRCHACT","NEW");return true},selectLang:function(b,d){try{var p=function(q){var e=q.match(/([\d.]+)px/);if(e){return parseFloat(e)}return 0};var g=ta.id("SEARCH_LANG_SELECT_POPUP");if(!g){return false}if(!g.hasClass("hidden")){var f=ta.id("SEARCH_LANG_SELECT_INPUT");var j=ta.id("SEARCH_LANG_SELECTED");if(f){var h=d.id.match(/lang_(.+)/);if(h){var c=h[1];if("all"==c){f.value=""}else{f.value=c}}if(j){j.set("html",ta.id(d).get("html"))}}g.addClass("hidden");if(j&&!ta.common.search.widthfixed){var k=ta.common.search.width;var o=p(j.getStyle("width"));var a=Math.max(k,o);console.log("check width old "+k+" new "+o);if(k!=o){j.setStyle("width",a+"px");ta.common.search.widthfixed=true}}}else{g.removeClass("hidden");var j=ta.id("SEARCH_LANG_SELECTED");if(j&&!ta.common.search.widthfixed){ta.common.search.width=p(j.getStyle("width"))}}}catch(l){ta.util.error.record(l,"select search lang")}},reviews:function(c,b){new Request({url:"/ActionRecord?action=SearchReviews"}).send();if(b&&b.getElement){var a=b.getElement(".searchTestText");if(a){alert(a.innerHTML)}}else{alert("Coming Soon!")}return false}};ta.common.flyout={intlPopup:function(d,b){d.stop();b.onclick=null;if(flagsUrl==null||flagsUrl==""){flagsUrl=document.location.pathname}var c="/StaticVelocityPage?t=intSitesFly.vm&lt=evt&footerFlagFormat="+footerFlagFormat+"&flagsURL="+encodeURIComponent(flagsUrl);if(document.location.search!=""){c+=encodeURIComponent(document.location.search)}if(document.location.hash!=""){c+=encodeURIComponent(document.location.hash)}if(window.modelGeoId){c+="&geo="+modelGeoId}if(window.flagsSettings){for(var a=0;a<flagsSettings.length;a++){c+="&"+flagsSettings[a]+"=true"}}if(window.pageFeature){c+="&pageFeature="+pageFeature}new Asset.css(flagsFlyoutCSS);new ta.overlays.RelativeOverlayBelow({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK,remoteContent:c},b);return false},showRecentLocationSaveOverlay:function(){setPID(3832);new Request({url:"/RecentlyViewedAjax",onSuccess:function(a){if(!a.match("emptyRecentlyViewed")){ta.overlays.showInLightbox(a,{style:"dg s4 RecentlyViewedOverlay"})}},data:{a:"save_overlay"},evalScripts:true,method:"get"}).send()},submitRecentLocationEmail:function(){var a=ta.retrieve("overlays.current");if($("rvEmailSend")){$("rvEmailSend").hide()}if($("rvEmailProgress")){$("rvEmailProgress").show()}setPID(4470);new Request({url:"/RecentlyViewedAjax",onSuccess:function(b){a.hide();if(!b.match("emptyRecentlyViewed")){ta.overlays.showInLightbox(b,{style:"dg s4 RecentlyViewedOverlay"})}},data:$("rvEmailForm"),evalScripts:true}).send()},submitRecentLocationSave:function(){var a=ta.retrieve("overlays.current");if($("rvEmailSend")){$("rvEmailSend").hide()}if($("rvEmailProgress")){$("rvEmailProgress").show()}setPID(4469);new Request({url:"/RecentlyViewedAjax",onSuccess:function(b){a.hide();if(!b.match("emptyRecentlyViewed")){ta.overlays.showInLightbox(b,{style:"dg s4 RecentlyViewedOverlay"})}},data:$("rvEmailForm"),evalScripts:true}).send()},showEmailHotelOverlay:function(a){new Request({url:"/ActionRecord?excludeFromVS=false&action=BusinessListingsEmail&d="+a}).send();new Asset.css(emailHotelCSS);new Request({url:"/EmailHotel",onSuccess:function(b){ta.run("ta.overlays.showInLightbox",{},b,{style:"dg s4"});if(ta.has("emailOwnerShowCaptcha")){ta.t4b.emailhotel.showRecaptcha()}},data:{detail:a},evalScripts:true,method:"get"}).send()},rvInquiryPrivacy:function(b,a){b.stop();a.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:false,activate:ta.overlays.ACTIVATE_HOVER,content:$("rvPrivacyBox").innerHTML},a)},rvClearDefault:function(c,a){var b=$(c);if(b&&b.value==a){b.value="";b.removeClass("rvDefault")}},BLSpecialOffersUrl:function(b,a){b.stop();a.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:false,activate:ta.overlays.ACTIVATE_HOVER,content:$("blLinkMsg").innerHTML},a)},destinationsPopup:function(b,a){b.stop();a.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK,remoteContent:"/vpages/destinationsFly.html?lt=evt"},a)},funStuffPopup:function(b,a){b.stop();a.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK,remoteContent:"/vpages/funStuffFly.html?lt=evt"},a)},bestValue:function(b,a){b.stop();a.onmouseover=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,remoteContent:"/vpages/bestValueFly.html?log=false"},a);return false},starAttribution:function(b,a){b.stop();a.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK},a);return false},amenities:function(d,b,a,c){if(d){d.stop()}b.onclick=null;if(typeof(amenityOverlayCss)!="undefined"&&!ta.retrieve("ta.amenityOverlayCss")){ta.store("ta.amenityOverlayCss",Asset.css(amenityOverlayCss))}if(a&&a>0){setPID(a);new Request({url:"/ActionRecord?excludeFromVS=false&action=HRAmenitiesFlyout"}).send()}if(c){ta.store("amenities.suppressLinks",true)}ta.run("ta.overlays.Factory.createAmenitiesLightbox",{},b);return false}};ta.common.sendmessage={getMessageCode:function(){var e=new Date().getTime();var b="ABCDEFGHIJKLMNOPQRSTUVWXYZ123456";var f=[];for(var a=0;a<32;a++){f[a]=((e&(1<<a))!=0)?1:0}var c=[[],[],[],[],[],[]];for(var a=0;a<30;a++){c[a%(c.length)].push(f[f.length-1-a])}var d="";for(var a=0;a<c.length;a++){d+=b.substr(parseInt(c[a].reverse().join(""),2),1)}return d},communityLightbox:function(e,d){if(!communityEnabled){window.callback_communityLightboxEnable=function(){communityEnabled=true;var g=ta.retrieve("overlays.sendmessage");if(g){g.hide()}ta.common.sendmessage.communityLightbox(e,d)};var a=new StringBuffer();a.append('<p id="inviteStatusField" style="display: none; color: red;"></p>');a.append("<p>"+JS_mem_travelnet_friends_disabledM2M+".</p>");a.append('<p><a href="javascript:void(0)" onclick="ta.common.sendmessage.enableCommunity(window[\'callback_communityLightboxEnable\'], true); return false;">'+JS_common_Clickhere+"</a> "+JS_mem_travelnet_friends_turnOn+".</p>");var f=ta.overlays.showInLightbox(a.toString(),{backdrop:ta.overlays.BACKDROP_NEVER,onHide:ta.common.sendmessage.cancel.bind(this)});f.container.setStyle("z-index","9998");ta.store("overlays.sendmessage",f);return}if(d){var b=function(g){var h=ta.overlays.showInLightbox(g,{backdrop:ta.overlays.BACKDROP_NEVER,permanent:true,onHide:ta.common.sendmessage.cancel.bind(this)});h.container.setStyle("z-index","9998");ta.store("overlays.sendmessage",h);var j=window[d];if(j&&typeOf(j)=="function"){j()}}}else{var b=function(g){var h=ta.overlays.showInLightbox(g,{backdrop:ta.overlays.BACKDROP_NEVER,permanent:true,onHide:ta.common.sendmessage.cancel.bind(this)});h.container.setStyle("z-index","9998");ta.store("overlays.sendmessage",h)}}var c={url:e,onSuccess:b,evalScripts:true,onFailure:ta.util.error.ajaxFailure.partial("SendMessage:communityLightbox")};new Request(c).send()},enableCommunity:function(c,a){var b=c;if(!a){b=function(d){ta.common.sendmessage.enableCommunityResponse(d,c)}}if(typeof(JS_SECURITY_TOKEN)=="undefined"){JS_SECURITY_TOKEN=""}new Request({url:"/MemberSubscriptionsController",data:{Action:"ChangeM2M",set:"on",token:JS_SECURITY_TOKEN},onSuccess:b,onFailure:ta.util.error.ajaxFailure.partial("SendMessage:enableCommunity")}).send()},enableCommunityResponse:function(res,callback){if(txt.match(/^{/)){var data=eval("("+txt+")");if(data.ERROR){document.getElementById("inviteStatusField").innerHTML=data.ERROR;document.getElementById("inviteStatusField").style.display="block"}}else{document.getElementById("inviteStatusField").innerHTML=JS_community_on;document.getElementById("inviteStatusField").style.display="block"}},submitSendMessage:function(h,b){h.stop();b.onclick=null;var a=b.className.match(/LSO_(\w+)/)[1];$("LsoId").value=footprintGetWithSet(a);$("screenWidth").value=screen.width;$("screenHeight").value=screen.height;if(!b.className.match(/\bform_(\w+)\b/)){return}var e=$(RegExp.$1);var d={url:b.href,data:e,evalScripts:true,onFailure:ta.util.error.ajaxFailure.partial("SendMessage:submitSendMessage")};var g=window["callback"+e.id];if(b.className.match(/method_(\w+)\b/)){d.method=RegExp["$1"]}if(b.className.match(/\btgt_(\w+)\b/)){d.update=RegExp["$1"]}else{d.onComplete=function(l,j){var k=ta.overlays.showInLightbox(l,{backdrop:ta.overlays.BACKDROP_NEVER,permanent:true,onHide:ta.common.sendmessage.cancel.bind(this)});ta.store("overlays.sendmessage",k);if(g&&typeOf(g)=="function"){g()}}}var c=window["validate"+e.id];if(c&&typeOf(c)=="function"&&c.apply(e)==false){return}if(b.className.match(/\bevalScripts\b/)){d.evalScripts=true}var f=ta.retrieve("overlays.sendmessage");if(f&&f.options&&f.options.permanent){f.options.permanent=false}new Request(d).send()},cancel:function(a){if(a){return}var b=ta.retrieve("overlays.sendmessage");if(b){ta.remove("overlays.sendmessage")}if(ta.has("community.needsReload")){window.location.reload()}},closeSendMessage:function(c,a){if(c&&c.stop){c.stop()}if(a){a.onclick=null}var b=ta.retrieve("overlays.sendmessage");if(b){b.hide(c)}}};ta.servlet.Inspiration={sortPopularity:function(b,a){sort("popularity")},sortAlphabetical:function(b,a){sort("alphabetical")}};ta.keep("facebook.onAvail",function(){FB.Event.subscribe("edge.create",function(d,f){try{var g=false;if(f&&f.dom){g=$(f.dom)}var a="";var c="";if(g){c=g.getAttribute("href");if(g.className){var b=false;if(b=g.className.match(/track_(\w+)/)){a=b[1]}if(g.hasClass("expanded")){a+="_expanded"}}}new Request({url:"/ActionRecordPlus?action=LIKE&from="+a+"&url="+c}).send()}catch(e){ta.util.error.record(e,"FB like review tracking error")}})});ta.servlet.Reviews={expandCount:0,extraAdAdded:false,PAGING_HEIGHT:1000,expandReview:function(p,d,c){var a=0;if(ta.retrieve("expand_"+c)){return}ta.store("expand_"+c,true);a++;var b=ta.id(c);var o=new Event(p);try{a++;if(!b){ta.util.error.record(null,"expandReview - no container",o,{revId:c});return}var j,l,g=false;if(b.getElement){j=b.getElement(".dyn_full_review");l=b.getElement(".basic_review");g=b.getElement(".revBotContent")}if(!l||!l.hasClass){ta.util.error.record(null,"expandReview - no basic_rev",o,{revId:c});return}a++;var h=l.hasClass("first");if(g&&g.getElement){var f=g.getElement(".fb_like_button")}var k=l.getElement(".helpful");a++;if(j){j.setStyle("display","block");if(f){ta.servlet.Reviews.injectFBLikeIntoFull(f,j)}if(ta.servlet.Reviews.translationRatings.contains(expandedReviewId)){ta.servlet.Reviews.injectTranslationRating(l,j)}l.setStyle("display","none");ta.remove("expand_"+c)}else{a++;ta.servlet.Reviews.expandCount++;var m=l.getElement(".partnerRvw span.linkItem");a++;if(m){m.getElement("img.textArrow_more").setStyle("display","none");new Asset.image(CDNHOST+"/img2/spinner.gif",{"class":"anim_loop"}).inject(m)}a++;new Request({url:"/SingleUserReview-g"+modelGeoId+"-d"+modelLocId+"?review="+c+"&servlet="+pageServlet+"&expand="+ta.servlet.Reviews.expandCount,onSuccess:function(t,u){try{var s=0;j=new Element("div");j.addClass("dyn_full_review");j.set("html",t);j.inject(l,"after");s++;var v=j.getElement(".collapse");if(v){v.addEvent("click",function(){ta.servlet.Reviews.collapseReview(b)})}s++;if(h){j.getElement(".basic_review").addClass("first")}s++;setupTranslationRatingSlider(j);s++;if(typeof processLinks!=="undefined"){processLinks(j)}s++;ta.servlet.Reviews.fixMTHelpfulUrl(j,c);if(l){var z=l.getElement("img.anim_loop");z.dispose()}s++;if(m){var r=m.getElement("img.textArrow_more");if(typeof(r)!="undefined"&&r!=null){r.setStyle("display","inline")}}s++;injectAdsTargeted(j);s++;ta.servlet.Reviews.refreshSidebarAds();s++;var w=ta.retrieve("facebook.data.handlers.FRIEND_NAMES");var q=ta.retrieve("facebook.data.handlers.HIGHLIGHT_FRIENDS");if(w&&typeof(w)=="function"){w()}if(q&&typeof(w)=="function"){q({expanded:true})}if(f){ta.servlet.Reviews.injectFBLikeIntoFull(f,j)}if(k){helpfulVotingKey=k.id.match(/(helpful\w+)_\w+/);if(helpfulVotingKey){helpfulVotingKey=helpfulVotingKey[1];if(ta.retrieve(helpfulVotingKey)){var B=j.getElement(".helpful");if(B){B.innerHTML=k.innerHTML}}}}s++}catch(y){ta.util.error.record(y,"expandReview - post AJAX",null,{postProg:s})}if(l&&l.setStyle){l.setStyle("display","none")}if(g&&g.setStyle){g.setStyle("display","none")}ta.remove("expand_"+c);var A=ta.retrieve("ta.servlet.Reviews.callback");if(A!=null){A()}},evalScripts:true}).send()}}catch(e){ta.util.error.record(e,"expandReview",o,{revId:c,prog:a});ta.remove("expand_"+c)}},expandReviews:function(h,l,j,t,r){if(ta.retrieve("expand_"+j)){return}ta.store("expand_"+j,true);var o=ta.id(j);var q=new Event(h);try{if(!o){ta.util.error.record(null,"expandReviews - no container",q,{revId:j});return}var k,u,B=false;if(o.getElement){k=o.getElement(".dyn_full_review");u=o.getElement(".basic_review");B=o.getElement(".revBotContent")}if(!u||!u.hasClass){ta.util.error.record(null,"expandReviews - no basic_rev",q,{revId:j});return}if(k){ta.servlet.Reviews.showExpandedReview(j,true);ta.remove("expand_"+j)}else{ta.servlet.Reviews.expandCount++;var v=u.getElement(".partnerRvw span.moreLink");if(v){var d=v.getParent().getElement("img.textArrow_more");if(d){d.setStyle("display","none");new Asset.image(CDNHOST+"/img2/spinner.gif",{"class":"anim_loop"}).inject(v,"after")}}var A=$$("#REVIEWS .reviewSelector");var a;for(var w=0;w<A.length;w++){if(A[w].id==j){a=A.slice(w)}}var m=[];if(a&&a.length>0){for(var w=0;w<a.length;w++){var s=a[w].id;if(s&&s.indexOf("review_")===0){var y=a[w].getElement(".dyn_full_review");if(!y){var g=a[w].getElement(".basic_review");if(g){m[m.length]=s.split("_")[1]}else{ta.util.error.record(null,"expandReviews - basic_review content missing",null,{revId:s},"WARN")}}}}}if(m.length>0){var p=m[0];var c=0;if(t){c=t}var f=m.join(",");var b="";var z="";if(ta.servlet.Reviews.expandCount==1&&m.length>2){z=m[2];b="&extraadtarget="+z;ta.servlet.Reviews.extraAdAdded=true}new Request({url:"/ExpandedUserReviews-g"+modelGeoId+"-d"+modelLocId+"?target="+p+"&context="+c+"&reviews="+f+"&servlet="+pageServlet+"&expand="+ta.servlet.Reviews.expandCount+"&extraad="+ta.servlet.Reviews.extraAdAdded+b,trackEvent:{module:"Reviews",action:"expand"},onSuccess:function(J,F){try{var K=[];var C=new Element("div");C.set("html",J);var R=C.getChildren();var I=[];for(var Q=0;Q<R.length;Q++){var G=R[Q];var M=G.id.split("_")[2];var T=ta.id("review_"+M);if(T&&T.getElement){I.push(T.getProperty("id"));var P=T.getElement(".basic_review");if(P){K.push(M);G.erase("id").addClass(P.className.replace("basic_review","dyn_full_review")).inject(P,"after").hide();var V=G.getChildren()[0];if(V){V.removeClass("review")}var L=G.getElement(".collapse");if(L){L.addEvent("click",ta.servlet.Reviews.getCollapseCallback(T))}setupTranslationRatingSlider(G);if(typeof processLinks!=="undefined"){processLinks(G)}if(ta.servlet.Reviews.translationRatings.contains(M)){ta.servlet.Reviews.injectTranslationRating(P,G)}ta.servlet.Reviews.fixMTHelpfulUrl(G,"review_"+M);if(M===p){var D=P.getElement("img.anim_loop");if(D){D.dispose()}ta.servlet.Reviews.refreshSidebarAds();injectAdsTargeted(G);var O=P.getElement(".partnerRvw span.moreLink");if(O){var E=O.getParent().getElement("img.textArrow_more");if(typeof(E)!="undefined"&&E!=null){E.setStyle("display","inline")}}}if(ta.servlet.Reviews.expandCount==1&&(M===z)){injectAdsTargeted(G)}}}}var H=true;for(var Q=0;Q<K.length;Q++){if(Q==1){H=false}var N="review_"+K[Q];ta.servlet.Reviews.showExpandedReview(N,H)}if(lazyImgs!=null){window.setupLazyLoad()}}catch(W){ta.util.error.record(W,"expandReviews - post AJAX",null,{});var D=u.getElement("img.anim_loop");if(D){D.dispose()}var O=u.getElement(".partnerRvw span.moreLink");if(O){var E=O.getParent().getElement("img.textArrow_more");if(typeof(E)!="undefined"&&E!=null){E.setStyle("display","inline")}}}if(Browser.ie&&Browser.version<8){var S=function(){for(var X=0;X<I.length;++X){var Y=ta.id(I[X]);if(Y!==null){Y.addClass("dummy")}}};setTimeout(S,0)}ta.remove("expand_"+j);if(ta.retrieve("isDaoDao")&&ta.retrieve("member_info_redesign")){var U=ta.retrieve("memberTravelMapInstance");if(U){U.getExtendGeos()}}},onFailure:function(C,D){ta.util.error.record(null,"ExpandedUserReviews ajax call failed",null,{reviewIds:f},"WARN");var F=u.getElement("img.anim_loop");if(F){F.dispose()}var G=u.getElement(".partnerRvw span.moreLink");if(G){var E=G.getParent().getElement("img.textArrow_more");if(typeof(E)!="undefined"&&E!=null){E.setStyle("display","inline")}}},evalScripts:true}).send()}}}catch(e){ta.util.error.record(e,"expandReviews",q,{revId:j});ta.remove("expand_"+j)}},getCollapseCallback:function(a){return function(){ta.servlet.Reviews.collapseReview(a)}},showExpandedReview:function(a,b){try{if(typeof(a)==="undefined"){ta.util.error.record(null,"showExpandedReview - reviewId is undefined");return}var e=ta.id(a);if(e){var h,k,f=false;if(e.getElement){h=e.getElement(".dyn_full_review");k=e.getElement(".basic_review");f=e.getElement(".revBotContent")}else{ta.util.error.record(null,"showExpandedReview - recContainer missing getElement attribute",null,{revId:a});return}if(!k){ta.util.error.record(null,"showExpandedReview - basic_rev is null",null,{revId:a});return}if(!k.hasClass){ta.util.error.record(null,"showExpandedReview - basic_rev missing hasClass attribute",null,{revId:a});return}if(f&&f.getElement){var d=f.getElement(".fb_like_button")}var j=k.getElement(".helpful");if(!h){ta.util.error.record(null,"showExpandedReview - no full");return}if(j){var g=j.id.match(/(helpful\w+)_\w+/);if(g){g=g[1];if(ta.retrieve(g)){var l=h.getElement(".helpful");if(l){l.innerHTML=j.innerHTML}}}}if(d){ta.servlet.Reviews.injectFBLikeIntoFull(d,h)}h.show();k.hide()}else{ta.util.error.record(null,"showExpandedReview - revContainer is null",null,{revId:a});return}}catch(c){ta.util.error.record(c,"showExpandedReview")}},fixMTHelpfulUrl:function(c,a){var d=c.getElement("input[name=returnTo]");if(d){var b=document.location.href;if(b.indexOf("#")>=0){b=b.substring(0,b.indexOf("#"))}d.value=b+"#mtreview_"+a}},injectFBLikeIntoFull:function(c,a){try{if(c){var e=c.getFirst();if(e){e.addClass("expanded")}var b=a.getElement(".helpful");if(b){c.inject(b,"after")}}}catch(d){ta.util.error.record(d,"expandReview - like button")}},injectTranslationRating:function(c,b){if(c&&b){var a=c.getElement(".translation"),d=b.getElement(".translation");if(a&&d){d.set("html",a.get("html"))}}},translationRatings:[],refreshSidebarAds:function(){if(ta.retrieve("did_ad_refresh")){return}ta.store("did_ad_refresh",true);var a=Math.floor(Math.random()*99999999);document.getElements("div.sidebar div.adServer iframe").each(function(b){if(b&&b.cloneNode){var c=b.cloneNode(false);c.src=b.src.replace(/ord=\d+/,"ord="+a)+";refresh=true";b.parentNode.replaceChild(c,b)}else{if(b){ta.util.error.record(null,"refreshSidebarAds",null,{revId:reviewId,msg:"iframe var is not a dom elemnt"})}else{ta.util.error.record(null,"refreshSidebarAds",null,{revId:reviewId,msg:"iframe var was null"})}}})},collapseReview:function(a){try{a=ta.id(a);var f=a.getElement(".dyn_full_review");var c=a.getElement(".basic_review");var d=a.getElement(".revBotContent");var b=f.getElement(".fb_like_button");if(c&&c.setStyle){c.setStyle("display","block")}if(d&&d.setStyle){d.setStyle("display","block")}if(b){var j=b.getFirst();if(j){j.addClass("expanded")}if(d){b.inject(d,"inside")}}var h=a.id.replace("review_","");if(ta.servlet.Reviews.translationRatings.contains(h)){ta.servlet.Reviews.injectTranslationRating(f,c)}f.setStyle("display","none")}catch(g){ta.util.error.record(g,"collapseReview")}},findLink:function(b,a){if(/\bt(r[\d]+)\b/.test(a.className)){window.location=$(RegExp.$1).href}},mtSubmitOnClick:function(b,a){if(a.value==="true"){ta.util.cookie.setPIDCookie(25173)}else{if(a.value==="false"){ta.util.cookie.setPIDCookie(25172)}}a.form.submit()},rateMTReview:function(a,d){var c=ta.id(d.form);var h=c.getElement("input[name=translateRating]:checked");if(h){var e=h.value;var f=c.elements.userId.value;var b=c.elements.reviewId.value;ta.servlet.Reviews.translationRatings.push(b);var g=c.action+"?at=true&rateValue="+b+","+f+","+e;new Request({url:g}).send();var j=c.getElement(".thanks").innerHTML;c.getElement(".translationRatingForm").innerHTML=j}},popSocialShare:function(b,a){if(b&&b.href){var c="toolbar=1,location=1,directories=1,status=1,menubar=1,resizable=1,copyhistory=1,scrollbars=1,width=800,height=400,left=40,top=40,screenx=40,screeny=40";window.open(b.href,"SocialShare",c)}new Request({url:"/ActionRecord?action=shareOn"+a}).send();return false},helpfulVoteHandler:function(b,a){new Event(b).preventDefault();var c=a.className.match(/\btgt_(\w+)\b/);if(!c){return}c=c[1];new Request({url:a.href,onSuccess:function(d,f){var g=ta.id(c+"_expanded");var e=ta.id(c+"_collapsed");if(g){g.innerHTML=d}if(e){e.innerHTML=d;ta.store(c,true)}}}).send()},helpfulVoteHandlerOb:function(b,a,c){new Event(b).preventDefault();var d=a.className.match(/\btgt_(\w+)\b/);if(!d){return}d=d[1];c=ta.util.ASDF.asdfDcd(c);new Request({url:c,onSuccess:function(e,g){var h=ta.id(d+"_expanded");var f=ta.id(d+"_collapsed");if(h){h.innerHTML=e}if(f){f.innerHTML=e;ta.store(d,true)}}}).send()},recordUnattached:function(b,a){new Request({url:"/ActionRecord?action=START_UNATTACHED_RVW_SEARCH"}).send();a.removePropertyEvent("keyup","ta.servlet.Reviews.recordUnattached")},changeSearchType:function(e,b){if(window.searchType){$$("span."+window.searchType.id).hide()}window.searchType=b;$$("span."+b.id).setStyle("display","inline");if(b.id!="type_rental"){switch(b.id){case"type_hotel":ta.store("tpAhdType","hotel");break;case"type_attraction":ta.store("tpAhdType","attr");break;case"type_restaurant":ta.store("tpAhdType","eat");break;case"type_location":ta.store("tpAhdType","geo");break}if($("SRCH_BOX_VR")){$("SRCH_BOX_VR").hide()}if($("SRCH_RSLT_VR")){$("SRCH_RSLT_VR").hide()}if($("MAIN_COL")){$("MAIN_COL").hide()}if($("POST_PHOTOS_FORM")){$("POST_PHOTOS_FORM").hide()}$("SRCH_BOX").show();$("UR_SELECT").show();var c=ta.id("query");var a=c.retrieve("typeAhead");if(a){a.changeUrl("/TypeAheadJson?action=SINGLELOCTYPE&types="+ta.retrieve("tpAhdType")+"&global=true");a.query();a.updateChoices()}if(c.value.length>0){searchByType()}c.focus();c.select()}else{$("SRCH_BOX_VR").show();$("SRCH_BOX").hide();$("UR_SELECT").hide();var d=$("reviewGeo");d.focus();d.select()}},unattachedSearchOnFocus:function(c,a){var b=ta.retrieve("tpAhdType");ta.run("ta.widgets.typeahead.factory.global_mutable",{},c,a,"SINGLELOCTYPE","ta.widgets.typeahead.events.onSelectUnattached",{xargs:"&types="+b});a.removePropertyEvent("focus","ta.servlet.Reviews.unattachedSearchOnFocus")},ratingFlyoutScroll:function(b){try{var c=b.getScroll().y,a=b.getScrollSize().y;if(b.retrieve("canFetchMore",true)&&c>a-ta.servlet.Reviews.PAGING_HEIGHT){b.store("canFetchMore",false);ta.servlet.Reviews.fetchRatingPage(b)}}catch(d){ta.util.error.record(d,"ratingFlyoutScroll")}},fetchRatingPage:function(b){var a=b.getElement(".ratingVal").innerHTML,c=b.getElement(".locId").innerHTML,e=b.getElement(".revId"),d=e.innerHTML;if(d!=0){new Request({url:"/RatingPagingAjax",data:{locId:c,ratingVal:a,revId:d},method:"get",onSuccess:function(f,g){e.destroy();b.innerHTML+=f;b.store("canFetchMore",true)}}).send()}}};ta.servlet.Location={distanceUnitsCookieName:"TAdistanceCookie",showMi:function(){$$("#NEARBY .milesOption").each(function(b,a){b.checked=true});$$("#NEARBY .milesLabel").each(function(b,a){$(b).addClass("selected")});$$("#NEARBY .kmLabel").each(function(b,a){$(b).removeClass("selected")});$$("#NEARBY .distanceMiles").show();$$("#NEARBY .distanceKm").hide();Cookie.write(this.distanceUnitsCookieName,0)},showKm:function(){$$("#NEARBY .kmOption").each(function(b,a){b.checked=true});$$("#NEARBY .milesLabel").each(function(b,a){$(b).removeClass("selected")});$$("#NEARBY .kmLabel").each(function(b,a){$(b).addClass("selected")});$$("#NEARBY .distanceMiles").hide();$$("#NEARBY .distanceKm").show();Cookie.write(this.distanceUnitsCookieName,1)},reportClosedVote:function(b,a,c){if(c&&c>0){c=encodeURIComponent(c);new Request({method:"get",url:"/ReportIAP?action=geocodeclosed&id="+c,onSuccess:function(d){ta.overlays.showInLightbox(d,{style:"mg s4",delayedPosition:true})}}).send()}},reportGeoCode:function(d,c,e,b,a){if(e&&e>0){e=encodeURIComponent(e);new Request({method:"get",url:"/ReportIAP?action=geocodebad&id="+e,onSuccess:function(f){ta.overlays.showInLightbox(f,{style:"mg s4",delayedPosition:true})}}).send()}if(ta.trackEventOnPage&&b&&a){ta.trackEventOnPage(b,a,e)}},reportCorrectAddr:function(c,f,l,p,d,j,m,q){if(l&&l>0){l=encodeURIComponent(l);var h=document.getElementById("street").value;var k=document.getElementById("city").value;var b=document.getElementById("state").value;var e=document.getElementById("zip").value;var g=document.getElementById("country").value;var o=document.getElementById("phone").value;var a=document.getElementById("website").value;if(p==h&&d==k&&j==e&&m==o&&q==a){new Request({method:"post",url:"/ReportIAP?action=geocodecorrect&updated=false&id="+l,onSuccess:function(r){ta.overlays.showInLightbox(r,{style:"mg s4",delayedPosition:true})}}).send()}else{h=encodeURIComponent(h);k=encodeURIComponent(k);b=encodeURIComponent(b);e=encodeURIComponent(e);g=encodeURIComponent(g);o=encodeURIComponent(o);a=encodeURIComponent(a);new Request({method:"post",url:"/ReportIAP?action=geocodecorrect&updated=true&id="+l+"&street="+h+"&city="+k+"&state="+b+"&zip="+e+"&country="+g+"&phoneNumber="+o+"&webSite="+a,onSuccess:function(r){ta.overlays.showInLightbox(r,{style:"mg s4",delayedPosition:true})}}).send()}}},reportGeoCodeDialog:function(d,c,e,b,a){if(typeof(incorrectLocation)!="undefined"&&!this.incorrectLocationLink){this.incorrectLocationLink=Asset.css(incorrectLocation)}if(e&&e>0){e=encodeURIComponent(e);new Request({method:"get",url:"/ReportIAP?id="+e+"&action=geocodedialog",onSuccess:function(f){ta.overlays.showInLightbox(f,{style:"mg s4",delayedPosition:true})},evalScripts:true}).send()}if(ta.trackEventOnPage&&b&&a){ta.trackEventOnPage(b,a,e)}},showReportForm:function(b,a,c){if(c&&c>0){c=encodeURIComponent(c);new Request({method:"get",url:"/ReportIAP?id="+c+"&action=geocodeform",onSuccess:function(d){ta.overlays.showInLightbox(d,{style:"mg s4",delayedPosition:true})},evalScripts:true}).send()}},setTrackPID:function(c,b,a){if(a==10022){ta.util.cookie.setPIDCookie(17138)}else{if(a==10021){ta.util.cookie.setPIDCookie(17137)}}},closeLightbox:function(){var a=ta.retrieve("overlays.current");if(a){a.hide()}},activateReportButton:function(){var a=ta.id("REPORT_LOCATION").getElements(".button")[0];a.removeClass("inactive");a.removeProperty("disabled")}};ta.servlet.Popup={index:0,open:function(a,b,c,r,m,l,g,q){try{if(isNaN(parseInt(c))){c=600}else{c=parseInt(c)}if(isNaN(parseInt(r))){r=400}else{r=parseInt(r)}if(isNaN(parseInt(m))){m=0}else{m=parseInt(m)}if(isNaN(parseInt(l))){l=0}else{l=parseInt(l)}if(a.indexOf("p=HotelsCom")>-1){c=Math.max(c,960);r=Math.max(r,window.getHeight(),600)}if(Browser.chrome){g=true}var f=1;if(g){f=0}var k=1;if(ta.browser.isIE9orHigher()){var k=0}var j=false;if(b&&typeof b=="string"){j=b}if(!j){var s=ta.servlet.Popup.index++;j="TripPop"+s}var d="";if(q){d="toolbar=1,resizable=1,location=1,status=1"}else{k=0;d="toolbar=0,resizable=1,location=0,status=0"}d+=",menubar="+k;d+=",scrollbars="+f;d+=",width="+c;d+=",height="+r;d+=",screenX="+m+",left="+m;d+=",screenY="+l+",top="+l;var o=window.open(a,j,d);if(o!=null){try{o.focus();o.opener=self}catch(p){}return o}}catch(h){ta.util.error.record(h,"Popup.open",null,{name:b,width:c,height:r,x:m,y:l,noScroll:g,allOptions:q})}},openSizedPopup:function(d,b){new Event(d).preventDefault();var c=600;var a=400;if(sz=b.className.match(/sz(\d+)x(\d+)/)){c=sz[1];a=sz[2]}ta.servlet.Popup.open(b.href,"photoTPW",c,a,false,false,true,true)},checkrates:function(b,a){b.preventDefault();if(a.get("tag")!="a"){a=a.getParent("a")}ta.servlet.Popup.open(a.href,"cr",245,610,5,5);if(ta.trackEventOnPage){ta.trackEventOnPage("map_pin_overlay","check_rates_click")}},sponsorCheckRates:function(d,b){d.preventDefault();if(b.get("tag")!="span"){b=b.getParent("span")}var a=b.className.match(/id_(\d+)/)[1];var c="/HotelDateSearch?d="+a+"&fromPop=false&sponsid="+ta.retrieve("sponsor.id")+"&area=QC_Button_Map&from=HACSearchButton&returnTo=__2F__GMapsLocationController&sponsdet=mapsHacBottom";ta.servlet.Popup.open(c,"cr",245,610,5,5)},termsPopup:function(b,a){popup.apply(a,[b,"terms",300,300,30,25]);return false},openInParent:function(e,d,c){var a=false;if(window.top&&window.top.opener){a=window.top}else{if(window.opener){a=window}}if(!a){return true}var b="";if(d.get("tag")=="form"){b=d.action+"?"+d.toQueryString()}else{if(d.get("tag")=="a"){b=d.href}else{d=d.getParent("a");b=d.href}}if(b!=""){if(e){e.preventDefault()}a.opener.location=b;if(!(typeof c!="undefined"&&c)){a.close()}else{window.blur()}}},openInParentOrSelf:function(d,c){var a=false;if(window.top&&window.top.opener){a=window.top}else{if(window.opener){a=window}}var b="";if(c.get("tag")=="form"){b=c.action+"?"+c.toQueryString()}else{if(c.get("tag")=="a"){b=c.href}else{c=c.getParent("a");b=c.href}}if(b!=""){if(d){d.preventDefault()}if(!a||(typeof a.opener=="undefined")||!a.opener||(typeof a.opener.closed=="undefined")||a.opener.closed){window.location=b}else{a.opener.location=b;a.close()}}},photoGallery:function(a,d){try{if(!d){return false}if(!d.get||!d.getParentBySelector){d=$(d)}if(!d.get||!d.getParentBySelector){ta.util.error.record(j,"photoGallery - elmt not wrapped");return false}if(d.get("tag")!="a"){d=d.getParentBySelector("a")}}catch(j){ta.util.error.record(j,"photoGallery - get anchor elmt");return false}var b="";var c="1";if(d.className){b=d.className.match(/u_([^ ]*)/)[1];c=d.className.match(/#([0-9]+)/)[1]}try{if(typeof cookieDomain=="undefined"){var g=window.location.hostname.split("."),f=0,l;while(g[f]&&g[f]!="tripadvisor"){f++}l=g.slice(f).join(".");if(l){cookieDomain="."+l}}Cookie.write("PhotoPop",c,{domain:cookieDomain})}catch(j){ta.util.error.record(j,"photoGallery - cookie set")}try{var k="";if(b){k=ta.servlet.Popup.open(b,"media",780,800)}else{}try{if(k&&k.showImage){k.showImage(c)}}catch(j){}}catch(j){ta.util.error.record(j,"photoGallery - pop window")}return false},openAIMLink:function(d,c){new Event(d).preventDefault();var b;if(c.get("tag")=="span"&&c.hasClass("fkASDF")){b=c.className.match(/u_([^ ]*)/)[1]}else{if(c.getParent("div.fkASDF")){b=c.getParent("div.fkASDF").className.match(/u_([^ ]*)/)[1]}else{if(c.get("tag")=="a"){b=c.href}else{if(c.getParent().get("tag")=="a"){b=c.getParent().href}else{return}}}}var a=c.className.match(/win(.+)/);if(a&&a.length>1){a=a[1]}else{a=null}ta.store("commerce.AIMWindow",ta.servlet.Popup.open(b,a,980,800,240,5,false,true));try{if(ta.has("checkrates.lpl_check_rates")&&c.href&&c.href.match(/LocationPhotosLightbox/)){ta.id("MEDIA_GALLERY").hide()}}catch(f){ta.util.error.record(f,"LPL photoGallery - could not hide photo gallery")}},openProviderWindow:function(b,a){new Event(b).preventDefault();ta.servlet.Popup.open(a.href,"photoTPW",1260,922,false,false,true,true)}};ta.servlet.Hotel={detailsTabClicked:function(b,a){showTab(locationId,"tabDetails")},photosTabClicked:function(b,a){showTab(locationId,"tabPhotos")},mapTabClicked:function(b,a){showTab(locationId,"tabMap")},ratingsTabClicked:function(b,a){showTab(locationId,"tabRatings")},setPid:function(a){ta.util.cookie.setPIDCookie(a)},setConceptCookie:function(){if(ta.has("topconcepts.lastconcept")){var a=ta.retrieve("topconcepts.lastconcept");Cookie.write("CONCEPT",a,{domain:cookieDomain,time:5})}return true},voteRecorded:false,recordVote:function(b,g,e,c,a){if(a.checked&&!ta.servlet.Hotel.voteRecorded){ta.servlet.Hotel.voteRecorded=true;new Request({url:"/ActionRecord-g"+b+"-d"+g+"?action=TopConceptsHelpful_"+e}).send();var d=$("preVote");var f=$("postVote");if(d&&f){d.style.display="none";f.style.display="inline"}else{ta.util.error.record(null,"recordVote - cannot find voting spans")}}return true},isHotelsServlet:function(a){if(ta.has("is_hotels_serv")){return ta.retrieve("is_hotels_serv")}var b=ta.id("PAGE");if(b&&typeof b!="undefined"){if(b.hasClass("hotels_like")){ta.store("is_hotels_serv",true);return true}else{if(b.hasClass("non_hotels_like")){ta.store("is_hotels_serv",false);return false}}}if(typeof a!="undefined"){return a}return false}};ta.widgets.Calendar=new Class({Implements:[Options,Events],options:{selectedDate:null,firstDate:null,lastDate:null,dualCalendar:true,invalidDates:null,useLinks:true,dayNames:false,formatter:null,offsetOther:0,choiceLink:null,prevAction:null,nextAction:null,monthHeadingFormat:"",monthspan:11,indicateTurnoverDays:false},initialize:function(b){this.setOptions(b);if(!this.options.firstDate){this.options.firstDate=new Date()}if(!this.options.lastDate){this.setLastDate(this.options.monthspan)}this.today=new Date();this.selectedDate=this.options.selectedDate;this.today.setHours(0,0,0,0);if(this.options.firstDate){this.options.firstDate.setHours(0,0,0,0)}if(this.options.lastDate){this.options.lastDate.setHours(0,0,0,0)}if(this.selectedDate){this.selectedDate.setHours(0,0,0,0)}var a=[];if(this.options.prevAction&&this.options.nextAction){a.push('<div class="navCal">');a.push('<span class="prev"><a style="display: block;" onclick="');a.push(this.options.prevAction);a.push('(event, this);">Previous Month</a></span>');a.push('<span class="next"><a style="display: block;" onclick="');a.push(this.options.nextAction);a.push('(event, this);">Next Month</a></span>');a.push("</div>")}this.container=new Element("div",{"class":"calendar"});this.container.set("html",a.join(""));if(this.options.monthHeadingFormat==""&&DATE_FORMAT_MMM_YYYY){this.options.monthHeadingFormat=DATE_FORMAT_MMM_YYYY}},setLastDate:function(b){if(b==null||b<1){b=11}var e=new Date();e.setDate(1);var a=e.getMonth();var c=a+b;e.setFullYear(e.getFullYear()+c/12);e.setMonth(c%12);this.options.lastDate=e},update:function(){if(this.currentMonth){this.removeTable(null,this.currentMonth)}if(this.nextMonth){this.removeTable(null,this.nextMonth)}var c=this.selectedDate||this.today;if(this.options.firstDate&&c<this.options.firstDate){c=this.options.firstDate}if(this.options.dualCalendar){var f=new Date(c);f.setDate(ta.util.date.DAYS_IN_MONTH[f.getMonth()]);f.setHours(0,0,0,0);if(f>=this.options.lastDate){c=new Date(c);if(c.getMonth()==0){c.setFullYear(c.getFullYear()-1,11,1)}else{c.setMonth(c.getMonth()-1,1)}}}this.currentMonth=this.createMonth(c);if(this.options.dualCalendar){var e=new Date(this.currentMonth.date);var a=e.getDate();var b=e.getMonth()+1;if(a>ta.util.date.DAYS_IN_MONTH[b]){a=ta.util.date.DAYS_IN_MONTH[b]}e.setMonth(b,a);this.nextMonth=this.createMonth(e);if(!ta.util.i18n.isRtl()){this.container.appendChild(this.currentMonth.elmt);this.container.appendChild(this.nextMonth.elmt)}else{this.container.appendChild(this.nextMonth.elmt);this.container.appendChild(this.currentMonth.elmt)}}else{this.container.appendChild(this.currentMonth.elmt)}this.updatePrevNext();return this},reposition:function(){this.currentMonth.elmt.setStyle("left","0px");if(this.options.dualCalendar){if(!ta.util.i18n.isRtl()){this.nextMonth.elmt.setStyle("left",this.currentMonth.elmt.getCoordinates().width+this.options.offsetOther+"px")}else{this.nextMonth.elmt.setStyle("left","0px");this.currentMonth.elmt.setStyle("left",this.nextMonth.elmt.getCoordinates().width+this.options.offsetOther+"px")}}return this},updatePrevNext:function(){var b=this.currentMonth.date;var a=this.options.dualCalendar?this.nextMonth.date:this.currentMonth.date;var d=ta.util.date.inSameMonth(b,this.options.firstDate);var c=ta.util.date.inSameMonth(a,this.options.lastDate);getChildByClass(this.container,"prev").style.display=(d?"none":"block");getChildByClass(this.container,"next").style.display=(c?"none":"block")},createMonth:function(y){var z={date:y};var l=new Date(y);l.setDate(1);l.setHours(0,0,0,0);var o=(l.getDay()-jsGlobalDayOffset+7)%7;if(this.options.indicateTurnoverDays){var v=new Date(y);v.setDate(0);var f=(this.isInvalidDate(v)?0:1);if(v<this.options.firstDate||v>this.options.lastDate){f=-1}}var b=[];var p=y.getFullYear();var q=y.getMonth();var h=new Date();var w=ta.util.date.inSameMonth(h,y)?h.getDate():-1;var m=-1;if(this.selectedDate&&this.selectedDate.getMonth()==q){m=this.selectedDate.getDate()}b.push('<table cellspacing="0" cellpadding="0" border="0"><thead><tr><th class="caption" colspan="7">');b.push(this.options.monthHeadingFormat.replace(/MMM/,jsGlobalMonths[q]).replace(/YYYY/,p));b.push("</th></tr><tr>");for(var t=0;t<jsGlobalDaysShort.length;t++){b.push("<th>");b.push(this.options.dayNames?jsGlobalDaysAbbrev[t]:jsGlobalDaysShort[t]);b.push("</th>")}b.push("</tr></thead><tbody><tr>");for(var t=0;t<o;t++){b.push('<td class="other">&nbsp;</td>')}o--;var s=0;var c=ta.util.date.DAYS_IN_MONTH[z.date.getMonth()];if(z.date.getMonth()==1&&z.date.getYear()%4==0){c+=1}var j=c;while(s<c){o=(o+1)%7;s++;l.setDate(s);var u=s;var e=null;var a=!(l<this.options.firstDate||l>this.options.lastDate);var r=!this.isInvalidDate(l);var k=this.options.choiceLink;if(this.options.formatter){var g=this.options.formatter(l,a,r,o,this.options);e=g.cname;u=g.contents;k=g.link||k}else{if(!r){e="invalid"}else{if(s==w){if(s==m){e="today selected"}else{if(!a){e="today disabled"}else{e="today"}}}else{if(s==m){e="selected"}}}}if(this.options.indicateTurnoverDays){if(r){if(f==0){if(e){e+=" depart"}else{e="depart"}}f=1}else{if(f==1){if(e){e+=" arrive"}else{e="arrive"}}f=0}if(!a){f=-1}}if(o==0){b.push("</tr><tr>")}if(!a){b.push('<td class="');b.push(e||"disabled");b.push('">');b.push(u||s);b.push("</td>")}else{if(e){b.push('<td class="');b.push(e);b.push('">')}else{b.push("<td>")}if(this.options.useLinks&&k){b.push('<a href="javascript:void(0);" onclick="');b.push(k);b.push("(event,");b.push(p);b.push(",");b.push(q);b.push(",");b.push(s);b.push(',this)">');b.push(u);b.push("</a>")}else{b.push(u)}b.push("</td>")}}while(++o<7){b.push("<td class='other'>&nbsp;</td>")}b.push("</tr></tbody></table>");z.elmt=new Element("div",{"class":"month"}).set("html",b.join(""));return z},isInvalidDate:function(a){return ta.util.date.inDateSet(a,this.options.invalidDates)},isValid:function(){if(!this.selectedDate){return true}return this.selectedDate.getTime()>=this.options.firstDate.getTime()&&this.selectedDate.getTime()<=this.options.lastDate.getTime()},prev:function(){if(this.animating){return}var l=this.options.dualCalendar;this.animating=true;var h=new Date(this.currentMonth.date);var g=h.getMonth()-1;if(g<0){g=g+12;h.setFullYear(h.getFullYear()-1)}var j=h.getDate();if(j>ta.util.date.DAYS_IN_MONTH[g]){j=ta.util.date.DAYS_IN_MONTH[g]}h.setMonth(g,j);var k=this.currentMonth.elmt.getCoordinates().width;var f=k+(l?this.nextMonth.elmt.getCoordinates().width:0);var b=this.createMonth(h);if(!ta.util.i18n.isRtl()){b.elmt.style.left="-"+k+"px";b.elmt.inject(this.container.getElement(".navCal"),"after")}else{b.elmt.style.left=f+"px";b.elmt.inject(this.container)}var e=this.container.getElements("div.month");var a;if(!ta.util.i18n.isRtl()){a={"0":{left:[-k,0]},"1":{left:[0,k+this.options.offsetOther]}};if(l){a["2"]={left:[k+this.options.offsetOther,k*2+this.options.offsetOther]}}}else{a={"0":{left:[0,-k]},"1":{left:[k+this.options.offsetOther,0]}};if(l){a["2"]={left:[k*2+this.options.offsetOther,k+this.options.offsetOther]}}}var c=new Fx.Elements(e,{onComplete:this.doneAnimating.bind(this).partial(Function._,this.nextMonth||this.currentMonth)});if(l){this.nextMonth=this.currentMonth}this.currentMonth=b;this.updatePrevNext();c.start(a)},next:function(){if(this.animating){return}var l=this.options.dualCalendar;this.animating=true;var h=new Date(this.currentMonth.date);var g=h.getMonth()+(l?2:1);if(g>11){g=g-12;h.setFullYear(h.getFullYear()+1)}var j=h.getDate();if(j>ta.util.date.DAYS_IN_MONTH[g]){j=ta.util.date.DAYS_IN_MONTH[g]}h.setMonth(g,j);var k=this.currentMonth.elmt.getCoordinates().width;var f=k+(l?this.nextMonth.elmt.getCoordinates().width:0);var b=this.createMonth(h);if(!ta.util.i18n.isRtl()){b.elmt.style.left=f+"px";b.elmt.inject(this.container)}else{b.elmt.style.left="-"+k+"px";b.elmt.inject(this.container.getElement(".navCal"),"after")}var e=this.container.getElements("div.month");var a;if(!ta.util.i18n.isRtl()){a={"0":{left:[0,-k]},"1":{left:[k+this.options.offsetOther,0]}};if(l){a["2"]={left:[k*2+this.options.offsetOther,k+this.options.offsetOther]}}}else{a={"0":{left:[-k,0]},"1":{left:[0,k+this.options.offsetOther]}};if(l){a["2"]={left:[k+this.options.offsetOther,k*2+this.options.offsetOther]}}}var c=new Fx.Elements(e,{onComplete:this.doneAnimating.bind(this).partial(Function._,this.currentMonth)});if(l){this.currentMonth=this.nextMonth;this.nextMonth=b}else{this.currentMonth=b}this.updatePrevNext();c.start(a)},removeTable:function(b,a){a.elmt.dispose()},doneAnimating:function(b,a){this.removeTable(b,a);this.animating=false},select:function(a,b){this.selectedDate=b;this.fireEvent("onSelect",[this,a])},nearbyMonth:function(b,a){var c=b+a;if(c>11){c-=12}else{if(c<0){c+=12}}return c}});ta.widgets.tabContainer=function(d,j){var a=d.getElements(".current");if(a.length!=1){throw new Error("You must have exactly one tab with a class of 'current'.")}else{a=a[0]}var g=a.className.match(/tab(\d+)/);if(g!=null&&g.length>=2){var b=Number(g[1])}else{return}if($("HOMEPAGE")&&window.location.hash){var h=window.location.hash.match(/t(\d)/);if(h&&h.length>0){b=parseInt(h[1]);a.removeClass("current");d.getElements(".tab")[b].addClass("current")}}var c=d.getElements(".tabContainerHead .tab");if(c.length==0){return}var f=d.getElements(".tabContainerBody .tabContent");return new TabSet(c,f,{show:b,onActive:function(m,o,k){var p=o.hasClass("xhr");if(p&&!o.hasClass("xhrComplete")){var e=o.getElement("a").href;if(e){var l=o;k.addEvent("onContentReplaced",function(){l.addClass("xhrComplete")});ta.util.element.replaceContent(m,k,e)}}if(o.hasClass("recordAction")){new Request({url:"/ActionRecord?action="+o.id}).send()}o.addClass("current");if(p&&m){m.stop()}},onBackground:function(k,l,e){l.removeClass("current")}})};ta.widgets.Carousel=new Class({Implements:Options,Binds:["shiftLeft","shiftRight"],options:{width:50,height:50,padding:5,num:7,offset:0,horizontal:true},initialize:function(a,b){this.setOptions(b);this.container=a;this.viewport=this.container.getElement(".viewport");this.leftKnob=this.container.getElement(".shiftLeft");this.rightKnob=this.container.getElement(".shiftRight");this.images=this.viewport.getElements("img");this.offset=this.options.offset;if(this.options.horizontal){this.viewport.setStyles({width:this.options.width*this.options.num+this.options.padding*(this.options.num-1),height:this.options.height})}else{this.viewport.setStyles({width:this.options.width+this.options.padding*2,height:this.options.height*this.options.num+this.options.padding*(this.options.num-1)})}this.leftKnob.addEvent("click",this.shiftLeft);this.rightKnob.addEvent("click",this.shiftRight);this.render()},render:function(){var a=this.offset+this.options.num;for(var b=this.images.length-1;b>=0;b--){if(b<this.offset||b>=a){this.images[b].setStyle("left",-999)}else{if(this.options.horizontal){this.images[b].setStyle("left",(this.options.width+this.options.padding)*(b-this.offset))}else{this.images[b].setStyles({top:(this.options.height+this.options.padding)*(b-this.offset),left:0})}}}if(this.offset==0){this.leftKnob.addClass("disabled")}else{this.leftKnob.removeClass("disabled")}if(this.offset==this.images.length-this.options.num){this.rightKnob.addClass("disabled")}else{this.rightKnob.removeClass("disabled")}},shiftLeft:function(){var a=this.offset;this.offset=Math.max(0,this.offset-this.options.num);if(this.offset!=a){this.render()}},shiftRight:function(){var a=this.offset;this.offset=Math.min(this.offset+this.options.num,this.images.length-this.options.num);if(this.offset!=a){this.render()}}});(function(b){b.util.action={record:function a(g,e,d){var f=Object.merge({url:"/ActionRecord",data:{action:g}},e);d&&(f.trackEvent=d);new Request(f).get()},recordPlus:function c(g,e,d){var f=Object.merge({url:"/ActionRecordPlus",data:{action:g}},e);d&&(f.trackEvent=d);new Request(f).get()}}}(ta));(function(){var e=[];function a(j,m){var f=e.length;e.push({name:j,properties:[]});for(var l in m){var g=true;if(f>0){for(var h=0;g&&h<f;h++){if(e[h].properties.indexOf(l)!=-1){g=false}}}if(g){e[f].properties.push(l)}}}a("node",document.createTextNode(""));a("Element",Element.prototype);e[1].properties.push("uid");a("element",document.createElement("div"));a("input",document.createElement("input"));e[3].properties.push("autocomplete");var d={element:"E",number:"N","function":"F",string:"S","boolean":"B",object:"O",collection:"C",whitespace:"W"};function c(g){var f=typeOf(g);return null==g?"_":(d[f]?d[f]:(f=="null"?"!":f))}ta.util.error={types:e,override:false,record:function(w,g,s,u,o){var q=false;try{q=document.getElement("body").hasClass("js_logging")}catch(A){}if(!q){return}var m={};var B=false;try{if(s||window.event){s=new Event(s||window.event);B=ta.id(s.target);m.eTarg=this.getSelectorString(B)}}catch(r){}if(typeof(debugCacheKey)!="undefined"){m.key=debugCacheKey}var f=window.pageServlet;if(!f){f="unknown"}m.servlet=f;if(!o||typeof o!="string"){o="ERROR"}m.eLogLevel=o;var D={extraInfoError:"Problem storing extra info"};var C="";var l={};try{var j="";try{j=window.navigator.userAgent}catch(t){}var k="";var h="";if(B){k=B.id;h=B.className}var v=false;try{v=doCookieCheck()}catch(A){}var y="";if(typeof serverPool!="undefined"&&serverPool){y=serverPool}l={TARGET_ID:k,TARGET_CLASS:h,USER_AGENT:j,EXTERNAL_JS:ta.util.error.getScriptSrcs(),CLIENT_POOL:y,COOKIES_ENABLED:v}}catch(z){u=D}m.xInfo=ta.util.error._getExtraInfoString(l,u);try{m.eUrl=encodeURIComponent(window.location)}catch(r){}var p="No Error";try{if(w){p=w.name+"-"+w.message;p=p.replace(/[\r\n]/g,"")}}catch(r){}m.eMsg=p;try{m.eBlk=ta.util.error.getErrorBlock(g).substring(0,70)}catch(r){}try{m.eStak=w?ta.util.error.getErrorStack(w):""}catch(r){}try{new Request({url:"/JSErrorRecord",data:m}).send()}catch(A){m={eBlk:"JSErrorRecord Error",servlet:f,eLogLevel:"ERROR",eMsg:"no error retrieved"};new Request({url:"/JSErrorRecord",data:m}).send()}if(IS_DEBUG){(window.ERRORS||(window.ERRORS=[])).push(m)}if(ta.util.error.override){if(ta.util.error.override=~/alert/){ta.util.error.alert(m)}if(ta.util.error.override=~/console/&&console){ta.util.error.console(m)}}},_getExtraInfoString:function(q,f){var l="_extraInfoError_:Problem storing extra info.";var o={};var r="";try{var p=typeOf(f);var h={};if(p==="array"||p==="arguments"){for(var k=0;k<f.length;k++){var g=f[k];var m=typeof g;if(m==="string"||m==="number"||m==="boolean"){h[k]=g}else{h[k]=typeof g}}f=h}o=Object.merge(q,f);r=JSON.encode(o);if(r&&r.length<10000){return r.replace(/[\r\n]/g,"")}}catch(j){}try{o=Object.merge(q,l);r=JSON.encode(o);if(r&&r.length<10000){return r.replace(/[\r\n]/g,"")}}catch(j){}return l},getErrorBlock:function(f){if(typeof f!="undefined"&&f!==null){return f.toString().replace(/[\r\n]/g,"")}return"null or undefined"},getErrorStack:function(m){var k=m.stack;if(k){var o=k.split("\n");o=o.map(function(s){var r=s.lastIndexOf("/");if(r>0){s=s.substr(r+1)}return s});return o.join()}else{if(arguments&&arguments.callee){var p=[];var g=arguments.callee.caller;g=g.caller;var l=0;while(g&&l++<100){var h=g.toString();var f=h.length;var j=f>75?75:f;var q=h.substring(0,j);q=q.replace(/[\s\'\"]/g,"");q+="::";p.push(q);g=g.caller}return p.join(" ")}}return"none"},getSelectorString:function(g){if(!g){return""}var f=[g];while(typeof g!="undefined"&&g&&typeof g.parentNode!="undefined"){f.push(g=g.parentNode)}f=f.map(function(j){if(j&&j.tagName){var h=j.tagName;if(j.id){h+="#"+j.id}if(j.className){h+="."+j.className}return h}return""});f=f.reverse().join(">");f=f.replace(/\s+/g,".");return f},ajaxFailure:function(h,g,f){ta.util.error.record(null,h,null,Object.merge({status:g.status},f))},alert:function(f){var g="";Object.each(f,function(j,h){g=g+h+": "+j+"\n"});window.alert(g)},console:function(f){if(console){console.error(f)}},getScriptSrcs:function(){var f="";Array.each(document.getElementsByTagName("script"),function(j,g){if(j&&j.src){var h="";if(f!=""){h=","}f=f+h+j.src}});return f},describe:function(h){if(null==h){return"_N"}var k=c(h),j=[],m,o;for(var l in h){m=false;for(var g=0;!m&&g<e.length;g++){if(e[g].properties.indexOf(l)!=-1){m=true;if(j.indexOf(e[g].name)==-1){j.push(e[g].name)}}}if(!m){k+=","+l+":"+c(h[l])}}if(j.length>0){k+=","+j.join(",")}return k}};var b=Cookie.read("JS_ERROR_HANDLING");if(b){ta.util.error.override=b}})();ta.util.partials={requestTimeout:1000,maxDataRequests:12,dataRequestCount:0,incompleteDataRegex:/<\!-- incomplete\: ([\w, ]*) -->/,failedDataRegex:/<\!-- failed\: ([\w, ]*) -->/,partialsErrorRegex:/<\!-- error -->/,noOauthTokenRegex:/<\!-- no Oauth Token -->/,requestPartials:function(g,d,f,j){if(ta.util.partials.dataRequestCount>ta.util.partials.maxDataRequests||g.length==0){ta.util.partials.recordGAEvent();return}ta.util.partials.dataRequestCount++;var e=g;var b=f;var c=j;if(ta.has("fb.partial.extraJS")){ta.retrieve("fb.partial.extraJS").each(function(k){new Asset.javascript(k)})}if(ta.has("fb.partial.extraCSS")){ta.retrieve("fb.partial.extraCSS").each(function(k){new Asset.css(k)})}var a=ta.remove("facebook.authcode.param");var h=Object.merge({parts:g.join(","),requestUrl:ta.retrieve("page.urlSafe")},d);if(a!=null){h=Object.merge(h,{FBAuthCode:a})}new Request({url:"/MultiPartAjax",method:"post",data:h,keepScripts:true,onRequest:function(){Cookie.dispose("FacebookAuthCode")},onSuccess:function(k){ta.util.partials.dataAvailable(d,e,b,c,null,null,k)}}).send()},handlePartialPaging:function(h,e,f){var g=f||{};ta.util.partials.dataRequestCount=0;if(!e||e.href==null){ta.util.error.record(null,"handlePartialPaging elmt.href null:"+e,null,null);return false}/parts=([\w,]+)/.test(e.href);var d=RegExp.$1.split(",");ta.store("partial.event.element",e);ta.store("partial.event.params",f);var c=ta.remove("facebook.authcode.param");var a=Object.merge({requestUrl:ta.retrieve("page.urlSafe")},g);var b=Object.clone(a);if(c!=null){a=Object.merge(a,{FBAuthCode:c})}new Request({url:e.href,method:"post",data:a,keepScripts:true,onSuccess:function(j){ta.store("fb.partial.isHandlePartialPaging",true);ta.util.partials.dataAvailable(b,d,"facebook",false,h,e,j)}}).send();return false},dataAvailable:function(d,j,h,o,q,c,f){if(o){var e=ta.util.partials.dataAvailable.pass([d,j,h,false,q,c,f]);o(e,f,j,d,h,o);return}if(f.match(ta.util.partials.noOauthTokenRegex)){if(ta.remove("fb.partial.isHandlePartialPaging")){ta.support.Facebook.pageDataAvailable(q,c,d,f)}return}if(f.match(ta.util.partials.partialsErrorRegex)){if(ta.has(h+".onPartialsError")){ta.remove(h+".onPartialsError").each(function(r){r()})}return}var m=[];var g=[];if(f.match(ta.util.partials.incompleteDataRegex)){m=RegExp.$1.split(",")}if(f.match(ta.util.partials.failedDataRegex)){g=RegExp.$1.split(",")}if(ta.has(h+".onDataAvail")){ta.remove(h+".onDataAvail").each(function(r){r()})}var p=[];var b=null;var l=/<style[^>]*>([\s\S]*?)<\/style>/gi;while((b=l.exec(f))){p.push(b[1])}if(p.length>0){p=p.join("\n");var k=document.createElement("style");k.type="text/css";document.getElementsByTagName("head")[0].appendChild(k);if(Browser.ie){k.styleSheet.cssText=p}else{k.appendChild(document.createTextNode(p))}}f=f.stripScripts(true);f=f.replace(/<style[^>]*>([\s\S]*?)<\/style>/gi,"");var a=ta.id("PARTIAL_DATA")||new Element("div",{id:"PARTIAL_DATA",styles:{display:"none"}}).inject(document.body);a.innerHTML+=f;setTimeout(function(){ta.util.partials.notifyListeners(j,h,m,g,a,d)},0)},notifyListeners:function(d,e,c,b,a,f){d.each(function(l){var q=e+".data.onAvail."+l;var o=c.contains(l);var k=b.contains(l);var r=ta.remove(q);if(r){for(var p=0,m=r.length;p<m;p++){if(r[p](a,o,k)===false){r[p]=null}}r=r.erase(null);if(o){if(r.length>0){ta.store(q,r)}else{c.erase(l)}}}if(!c.contains(l)&&!k){ta.keep("partials.pageProperties",l)}});var h="partials.data.onPage";var g=ta.remove(h);if(g){g.each(function(j){j()})}if(c.length>0){ta.util.partials.requestPartials.invokeLater(ta.util.partials.requestTimeout,null,[c,f,e])}else{ta.util.partials.recordGAEvent()}},recordGAEvent:function(){var b=ta.remove("partials.pageProperties");if(!b||b.length==0){return}var a="-"+b.sort().join("-")+"-";ta.trackEventOnPage("social","show",a)}};ta.util.partials.handleLightbox=ta.util.partials.handlePartialPaging;ta.support.Facebook={ready:false,queue:[],enqueueForFBReady:function(a){if(ta.support.Facebook.ready){a()}else{ta.support.Facebook.queue.push(a)}},dequeueForFBReady:function(){try{ta.support.Facebook.queue.each(function(b){b()})}catch(a){ta.util.error.record(a,"Error calling dequeueForFBReady")}ta.support.Facebook.queue=[]},ipRevoke:function(a){setTimeout(function(){ta.util.pending.lock("fb.revoke.lb",function(){ta.util.pending.unlock("fb.revoke")})},a)},enqueueForFBAvailable:function(a){if(ta.retrieve("facebook.session.available")){a()}else{ta.keep("facebook.onSessionAvail",a)}},init:function(){if(ta.has("facebook.available")){return}ta.util.pending.multilock("facebook.data.canDisplay",ta.support.Facebook.showData,2);var b=ta.support.Facebook.timing=new ta.support.IPTiming();if(!ta.retrieve("facebook.invalidFBCreds")){ta.support.Facebook.initData(true)}ta.support.Facebook.markAvailable();var a=window.documentDomainChanged?"/fb/channel_mod.html":"/fb/channel.html";var c=ta.retrieve("facebook.appId");var d=true;FB.init({appId:c,status:true,cookie:true,xfbml:true,channelUrl:window.location.protocol+"//"+window.location.hostname+a,frictionlessRequests:true,oauth:d});ta.support.Facebook.ready=true;ta.support.Facebook.dequeueForFBReady();if(!ta.retrieve("facebook.disableLogin")){if(ta.retrieve("facebook.skip.session.check")=="true"){ta.support.Facebook.sessionAvailable()}else{FB.getLoginStatus(ta.support.Facebook.onLoginStatus)}}else{if(!ta.has("facebookuserid")){ta.support.Facebook.sessionUnavailable()}}},transformToAuthResponse:function(c){var a=ta.retrieve("facebook.authFailed");var d=ta.retrieve("facebook.authSuccess");var b=c.authResponse;if(!b){if(a){a()}return null}if(c.status=="connected"){b.uid=ta.store("fb.auth.userId",b.userID);b.token=ta.store("fb.auth.token",b.accessToken);if(d){d()}return b}if(a){a()}return null},onLoginStatus:function(b){var a=ta.support.Facebook.transformToAuthResponse(b);if(a){if(ta.has("cached.facebookuid")&&ta.retrieve("cached.facebookuid")!=a.uid){ta.store("facebook.preFailed",true);ta.store("facebook.AuthCode.onAvail.needsReload",function(){window.location.reload()});ta.support.Facebook.receiveCode(ta.support.Facebook.getCodeFromOAuthResponse(a))}if(ta.retrieve("facebook.invalidFBCreds")&&!ta.retrieve("facebook.signout.process")){ta.store("facebook.AuthCode.onAvail",ta.support.Facebook.sessionAvailable);ta.support.Facebook.receiveCode(ta.support.Facebook.getCodeFromOAuthResponse(a))}else{ta.support.Facebook.sessionAvailable()}}else{if(!ta.retrieve("facebook.invalidFBCreds")){ta.store("facebook.preFailed",true);setOneTimeCookie("FacebookAuthCode","NoFBSessionAvailable");new Request({url:"/ActionRecord?action=fb_cached_token_no_session"}).send()}ta.support.Facebook.sessionUnavailable()}},initData:function(a){if(ta.remove("facebook.data.initialRequest.failed")){ta.support.Facebook.loadData({pre:a})}else{ta.util.pending.lock("facebook.data.initialRequest",ta.support.Facebook.loadData.partial({pre:a}))}},loadData:function(b){if(!ta.has("facebook.data.request")){return}ta.support.Facebook.timing.setBeginPartials();var a=ta.retrieve("facebook.data.request");if(!ta.has("facebook.connectBar-counted")&&ta.retrieve("facebook.showWelcomeBar")){if(!b.pre){ta.store("facebook.connectBar-counted",true);FB.api({method:"connect.shouldShowConnectBar"},function(c){if(c==2){a.erase("IP_BAR");a.include("USER_PROFILE_ACTION");ta.merge("facebook.data.params",{bar:"off"})}ta.util.partials.requestPartials(a,Object.merge({},b,ta.retrieve("facebook.data.params")),"facebook",ta.support.Facebook.dataAvailable)})}else{ta.store("facebook.data.initialRequest.failed",true)}}else{ta.util.partials.requestPartials(a,Object.merge({},b,ta.retrieve("facebook.data.params")),"facebook",ta.support.Facebook.dataAvailable)}},receiveCode:function(d){var a=ta.retrieve("facebook.AuthCode.onAvail");if(a!=null){ta.store("facebook.authcode.param",d);setOneTimeCookie("FacebookAuthCode",d);a()}var c=ta.retrieve("facebook.AuthCode.onAvail.needsReload");if(c!=null){setOneTimeCookie("FacebookAuthCode","ConflictedFBAccount");c()}var b=ta.retrieve("facebook.AuthCode.onAvail.paging");if(b!=null){ta.store("facebook.authcode.param",d);setOneTimeCookie("FacebookAuthCode",d);b()}},getCodeFromOAuthResponse:function(b){var d=ta.support.Facebook.parseFBSignedRequest(b.signedRequest).code;var c=ta.remove("facebook.taServerTime");var a=c-3600;var e=null;if(d&&!isNaN(a)){e=d.split(".")}if(e!=null&&e.length>3&&!isNaN(e[3])&&e[3]<a){ta.util.error.record(null,"Facebook sending up expired Code: ",null,{code:d,serverTime:c})}return d},parseFBSignedRequest:function(c){if(!c){return null}var a=c.split(".",2);var d=a[1];if(d){var b=ta.util.decoder.base64Decoder(d);try{return JSON.decode(b)}catch(f){ta.util.error.record(null,"couldn't parse Facebook SignedRequest to JSON object after decode ",null,{signedRequest:c,decoded:b})}}else{ta.util.error.record(null,"Facebook SignedRequest TA received doesn't contain data",null,{signedRequest:c})}},preemptiveRegex:/<\!-- PREEMPTIVE RESPONSE -->/,noOauthTokenRegex:/<\!-- no Oauth Token -->/,limitOfTry:4,dataAvailable:function(c,a,b,e,d,g){if(a.match(ta.support.Facebook.preemptiveRegex)&&ta.remove("facebook.preFailed")){return}if(a.match(ta.support.Facebook.noOauthTokenRegex)){delete e.pre;var f=ta.util.partials.requestPartials.partial(b,e,d,g);ta.store("facebook.AuthCode.onAvail",f);ta.support.Facebook.tryRegetOauthToken()}ta.store("facebook.data.handler",c);ta.util.pending.unlock("facebook.data.canDisplay")},tryRegetOauthToken:function(){var a=ta.retrieve("fb.noOauthToken.counter");if(a==null){a=0}if(a<ta.support.Facebook.limitOfTry){ta.store("fb.noOauthToken.counter",a+1);FB.getLoginStatus(ta.support.Facebook.checkStatusAndGetCode)}},checkStatusAndGetCode:function(b){var a=ta.support.Facebook.transformToAuthResponse(b);if(a){ta.support.Facebook.receiveCode(ta.support.Facebook.getCodeFromOAuthResponse(a))}},pageDataAvailable:function(e,b,d,a){var c=ta.util.partials.handlePartialPaging.partial(e,b,d);ta.store("facebook.AuthCode.onAvail.paging",c);ta.support.Facebook.tryRegetOauthToken()},showData:function(){ta.remove("facebook.data.handler")();ta.support.Facebook.timing.recordEndTimes()},markAvailable:function(){ta.store("facebook.available",true);if(ta.has("facebook.onAvail")){ta.remove("facebook.onAvail").each(function(a){a()})}},sessionAvailable:function(){var a=ta.retrieve("facebook.session.available");ta.store("facebook.session.available",true);ta.support.Facebook.timing.recordLoadTime();if(ta.has("facebook.onSessionAvail")){ta.remove("facebook.onSessionAvail").each(function(b){b()})}if(!a){ta.util.pending.unlock("facebook.data.canDisplay")}ta.support.Facebook.initData(false)},sessionUnavailable:function(){ta.store("facebook.session.available",false);ta.support.Facebook.timing.recordLoadTime();if(ta.has("facebook.onSessionUnavail")){ta.remove("facebook.onSessionUnavail").each(function(a){a()})}$$("#HEAD .FB_login_button").forEach(function(a){a.addEvent("click",function(){new Request({url:"/ActionRecord?action=FBC_Masthead"}).send()})});$$("#WoF_SigninLander .fbcBtnsmall").forEach(function(a){a.addEvent("click",function(){new Request({url:"/ActionRecord?action=WoF_SigninLander"}).send()})})},havePermission:function(b,d,c){var a=ta.retrieve("facebook.permissions");if(a){if(a.indexOf(b)==-1){return c?c():null}return d?d():null}else{FB.api({method:"users.hasAppPermission",ext_perm:b},function(e){if(e!=0){if(d){d()}}else{if(c){c()}}})}},requirePermission:function(a,c,b){ta.support.Facebook.login([a],c,b)},ifLoggedIn:function(b,a){if(ta.retrieve("facebook.session.available")&&b){b()}else{if(a){a()}}},loginButton:function(b,a){ta.support.Facebook.login()},login:function(k,a,d,c,b){k=Array.from(k||[]);if(b!=null&&b.length>0){ta.store("facebook.flow",b)}else{ta.store("facebook.flow","FBC")}var e=userLoggedIn?"Connect":"Login";var f=e=="Login"?"":ta.retrieve("facebook.isFBC")=="true"?"Upgrade":"New";ta.util.action.record("FacebookConnect",null,{module:"social",action:e+"Attempt"+f});var l=function(){ta.util.action.record("FacebookConnect",null,{module:"social",action:e+"Success"+f});if(a){a()}};if(!userLoggedIn||!userFbConnected||c){ta.support.Facebook._doLogin(k,l,d,c);return}var j=[];for(var h=0;h<k.length;h++){j.push(ta.support.Facebook.havePermission.partial(k[h]))}function g(){if(l){l()}}Function.executeContinuations([ta.support.Facebook.ifLoggedIn].concat(j).concat([g]),ta.support.Facebook._doLogin.partial(k,l,d))},_doLogin:function(b,f,a,d){var e=["email","user_education_history","friends_education_history","user_events","friends_events","user_hometown","friends_hometown","user_likes","friends_likes","user_location","friends_location","user_work_history","friends_work_history","user_status","friends_status","friends_photos","publish_actions","user_photos"];var c=d;FB.login(function(h){var g=ta.support.Facebook.transformToAuthResponse(h);if(g){if(g.token){ta.support.Facebook.havePermission("email",function(){ta.support.Facebook.setResultPID();ta.store("facebook.AuthCode.onAvail",function(){ta.support.Facebook.fbcRegistration(c,f)});ta.support.Facebook.receiveCode(ta.support.Facebook.getCodeFromOAuthResponse(g))},function(){ta.util.error.record(null,"user did not grant email permission, user fbid is:"+g.uid,null,{},"WARN")})}else{if(a){a()}}}},{scope:e.join(",")})},setResultPID:function(){var a=ta.retrieve("facebook.trackingpid");if(a){ta.util.cookie.setPIDCookie(a)}},fbcRegistration:function(a,c){var b=!ta.retrieve("facebook.session.available")||!userLoggedIn||!userFbConnected;if(a!=null){b=b||a}if(b){ta.store("facebook.session.available",true);ta.store("registration.action","FB_CONNECT");ta.run("ta.overlays.registration.logAndPost",{},{flow:ta.retrieve("facebook.flow")},"FBC-start",{action:"FB_CONNECT"})}if(c){c()}},loginWithFlow:function(a,b){ta.store("facebook.flow",a);ta.support.Facebook.login(null,null,null,b)},logout:function(){FB.logout(function(){window.location.reload()})},restart:function(){FB.logout(function(){ta.overlays.registration.post({action:"FB_LOGIN"})})},revoke:function(){FB.api({method:"Auth.revokeAuthorization"})},postWall:function(h,f,k,e,c,o,g,d,l,a,j,m,b){FB.ui({method:"feed",message:h,picture:o,link:f,name:k,to:l,caption:e,description:c,display:a,properties:j,actions:[{name:g,link:d}]},function(p){if(p&&p.post_id){if(m){m(p)}}else{if(p&&!p.post_id){ta.util.error.record(null,"Facebook postWall error response from facebook",null,null)}else{if(b){b(p)}}}})},publishStream:function(e,a,g,h,c,f,b,d){FB.login(function(k){var j=ta.support.Facebook.transformToAuthResponse(k);if(j){if(j.token){new Request({url:"/ActionRecord?action=POSTTOWALL_GRANTED"}).send();ta.support.Facebook.postWall(e,a,g,h,c,f,b,d)}}},{scope:"publish_stream"})},loginRequestSpecificPermission:function(b,c,a){FB.login(function(e){var d=ta.support.Facebook.transformToAuthResponse(e);if(d){if(d.token){ta.store("facebook.AuthCode.onAvail",function(){ta.support.Facebook.fbcRegistration(null,c)});ta.support.Facebook.receiveCode(ta.support.Facebook.getCodeFromOAuthResponse(d))}else{if(a){a()}}}},{scope:b})},loginWithFlowAndRequest:function(b,c,d,a){ta.store("facebook.flow",b);ta.support.Facebook.loginRequestSpecificPermission(c,d,a)}};ta.support.IPTiming=new Class({initialize:function(){this.active=ta.has("facebook.iptiming");if(this.active){this.timers=ta.retrieve("facebook.iptiming")}else{}},recordLoadTime:function(){if(this.active){this.sendActionRecord("LoadPage",this.timers.loaded-this.timers.started)}},setBeginPartials:function(){if(this.active&&!this.timers.partials){this.timers.partials=new Date().getTime()}},recordEndTimes:function(){if(this.active){var a=new Date().getTime();this.sendActionRecord("GetPartials",a-this.timers.partials);this.sendActionRecord("LoadAll",a-this.timers.started)}},sent:{},sendActionRecord:function(c,a){if(this.sent[c]){return}this.sent[c]=true;a=Math.round(a/1000);var b;if(a<=10){b=a.toString()}else{if(a>10&&a<=15){b="11-15"}else{if(a>15&&a<=20){b="16-20"}else{b="21+"}}}c+="_";c+=ta.retrieve("facebook.session.available")?"IP_":"NonIP_";c+=b+"_"+this.timers.servletName;if(this.timers.firstPage){c+="_FirstPage"}ta.util.action.record(c)}});(function(a){a.util||(a.util={});var b=function(c){this.constructor=c};a.util.extend=function(g){var d={};var h,j,f,e,c;for(e=1,c=arguments.length;e<c;e++){j=arguments[e];for(f in j){if(j.hasOwnProperty(f)){d[f]=j[f]}}if(j.hasOwnProperty("constructor")){d.constructor=j.constructor}}h=d.hasOwnProperty("constructor")?d.constructor:function(){return g.apply(this,arguments)};b.prototype=g.prototype;h.prototype=new b(h);h.prototype.__super__=g.prototype;for(f in d){h.prototype[f]=d[f]}return h}}(ta));(function(c){c.fb||(c.fb={});var b=new RegExp(["User is already associated","Permissions error"].join("|"));var a=new RegExp(["Timeline is not activated","Requires extended permission","An unexpected error has occurred","An unknown error has occurred","load-error: unknown","Error validating access token","Object at URL.*requires an object of og:type","Could not retrieve data from URL","^unknown error"].join("|"));c.fb.graph={api:function(h,k,j,f){var e=Array.prototype.slice.call(arguments);var d=c.util.Deferred();k||(k="get");j||(j={});f||(f={});f.recordErrors=(f.recordErrors!==false);(function g(l){FB.api(h,k,j,function(o){if(o&&!o.error){d.resolve(o)}else{var p={name:"None",message:"No FB.api response"};var m="ERROR";if(o&&o.error){p.name=o.error.type;p.message=(typeof o.error==="string")?o.error:o.error.message}if(l&&p.message.match("has og:type of '(?:tripadvisortravelmap|civ)")){j.scrape=true;g(false);return}if(a.test(p.message)){m="WARN"}if(f.recordErrors&&!b.test(p.message)){this.recordError(p,{FB_API_ARGS:e,FB_API_RESPONSE:o,FB_AUTH_RESPONSE:FB.getAuthResponse()},m)}d.reject(p)}}.bind(this))}.call(this,true));return d.promise()},remove:function(e,d){d||(d={});d.method="delete";return this.api("/"+e,"delete",d)},recordError:function(e,f,d){if(c.util.error){c.util.error.record(e,"ta.fb.graph.api",null,f,d)}return this}}}(ta));(function(a){a.fb.graph.Base=a.util.extend(Object,{constructor:function b(d,c){this.set(d);this.options=c||{}},set:function(d){for(var c in d){d.hasOwnProperty(c)&&(this[c]=d[c])}return this},api:function(c,f,e){if(!(this.id&&this.accessToken)){var d={name:"Missing auth credentials",message:"Facebook Graph object API calls require an id and access token"};a.fb.graph.recordError(d,{FB_ID:this.id,FB_ACCESS_TOKEN:this.accessToken,FB_API_ARGS:arguments},"WARN");return a.util.Deferred().reject(d)}c||(c="");if(/^\//.test(c)){c=c.slice(1)}e||(e={});e.access_token=this.accessToken;return a.fb.graph.api("/"+this.id+"/"+c,f,e)}})}(ta));(function(a){a.fb.graph.mixin||(a.fb.graph.mixin={});var c=true;var b=new RegExp(["Timeline is not activated","Requires extended permission"].join("|"));a.fb.graph.mixin.OpenGraph={recordOpenGraph:function(e){var d=this.options.MapAction;if(d){Math.random()>0.2||d.record(e)}return this},getActions:function(d){return this.api(this.options.appName+":"+d)},publishAction:function(j,g,f,e){if(!c){return a.util.Deferred().reject("Publishing open graph actions is disabled.")}var d=this.options.appName;var h=this.options.ref;e||(e={});e[g]="http://"+this.options.hostname+f;if(h){e.ref=h}delete e.place;var k=this.api(d+":"+j,"POST",e).success(function(){this.recordOpenGraph("OpenGraph_"+j)},this).failure(function(l){if(b.test(l.message)){c=false}});return k},publishLocatedAction:function(g,f,e,d){d||(d={});d.place="http://"+this.options.hostname+e;return this.publishAction(g,f,e,d)},scrape:function(d){return a.fb.graph.api("/","post",{id:d,scrape:true})}}}(ta));(function(a){a.fb.graph.User=a.util.extend(a.fb.graph.Base,a.fb.graph.mixin.OpenGraph)}(ta));ta.fb.graph.User.prototype.inviteFriends=(function(b){var d=50;function a(e,f,j,h,g){var k=e.splice(0,d);g||(g=[]);FB.ui({method:"apprequests",message:f||"",title:j||"",new_style_message:true,to:k.join(",")},function(l){if(l&&l.to&&l.to.length){g.push.apply(g,l.to);if(!e.length){a(e,f,j,h,g)}else{h.resolve(g,l)}}else{h.reject(g,l)}})}return function c(f,g,h){var e=b.util.Deferred();a(f,g,h,e);return e.promise()}}(ta));ta.fb.graph.User.prototype.getAppRequests=function(a){if(!a&&this.appRequests){return ta.util.Deferred().resolve(this.appRequests)}return this.api("apprequests").success(function(b){this.appRequests=b},this)};ta.fb.graph.User.prototype.recordAndDeleteAppRequests=function(d,c,f){var a=this;d||(d=[]);if(!c){var b=window.location.search.match(/[?&](?:ref|fb_source)=([^&]*)/);c=b&&b[1]}function e(g){var h=[];g.each(function(j){ta.fb.graph.api("/"+j,"delete",null,{recordErrors:false});h.push((f?f+"_":"")+"AppRequestId_"+j)});return a.options.MapAction&&h.length?a.options.MapAction.record(h.join(",")):ta.util.Deferred().resolve()}if(c=="bookmarks"){return this.getAppRequests().success(function(g){g.data.each(function(h){var j=h.id.split("_")[0];~d.indexOf(j)||d.push(j)})}).always(function(){return e(d)})}return e(d)};(function(a){var b=10000;a.fb.graph.TAUser=a.util.extend(a.fb.graph.User,{pin:function(c,f,g){var l=a.util.Deferred();var e=false;var d,h,j,m;if(c){d=/^g(?:eo)?/.test(c.type)?"city":/^a(?:ttraction)?/.test(c.type)?"attraction":/^e(?:atery)?/.test(c.type)?"restaurant":/^h(?:otel)?|^lodging/.test(c.type)?"hotel":null;h=c.url}if(!(d&&c.url&&f&&f.length)){return l.reject()}j=!!(this.location&&this.location.latitude&&this.location.longitude);m=!!(this.hometown&&this.hometown.latitude&&this.hometown.longitude);var k=Array.prototype.each?"each":"forEach";f[k](function(p,q){var s=p=="been"?"pin":p;var r={};if(s=="pin"){var o={};var t;if(j){o.lat=this.location.latitude;o.lng=this.location.longitude}else{if(m){o.lat=this.hometown.latitude;o.lng=this.hometown.latitude}}t=a.travelmap.util.getDistance(c,o,this.locale);if(t){r.distance=t.value;r.distance_unit=t.unit;r.cur_loc_used=j}}else{if(s=="going"){r.end_time="5000-01-01"}}if(g||(s=="pin"&&f.length>1)){r.no_feed_story=1}this.publishLocatedAction(s,d,h,r).failure(function(){e=true}).always(function(){if(q==f.length-1){l[e?"reject":"resolve"]()}})},this);return l.promise()},rate:function(c){var f="rate";var e="attraction";var d=c.url;return this.publishLocatedAction(f,e,d)},earnBadge:function(c){var f="earn";var e="badge";var d="/MemberTravelMap?ns=badge&badgeId="+c;return this.publishAction(f,e,d)},updateMap:function(c){this._needToScrapeMap=true;if(this._intervalID&&!c){return a.util.Deferred().resolve()}this._intervalID||(this._intervalID=window.setInterval(this.scrapeMap.bind(this),b));return this.options.MapAction.getTravelMapMetaData().always(function(d){var h="publish";var g="map";var f="/MemberTravelMap?ns=map&uid="+this.options.guid;var e={};if(d&&d.tmTotalDistance){e={total_distance:Math.round(d.tmTotalDistance),distance_unit:d.tmDistanceUnit}}if(c){e["fb:explicitly_shared"]=true}return this.publishAction(h,g,f,e)},this)},scrapeMap:function(c){if(this._needToScrapeMap||c){this._needToScrapeMap=false;return this.scrape("http://"+this.options.hostname+"/MemberTravelMap?ns=map&uid="+this.options.guid)}return a.util.Deferred().resolve()}})}(ta));ta.common.wisdomoffriends={reloadASAP:function(){window.location.reload()},showWelcome:function(){ta.store("wof.showWelcome",true)}};if(!ta.popups){ta.popups={}}ta.popups.PopUtil={windowType:{CHECK_RATE:0,PROV_WIN:1,HOLDING:2,COMMERCE:3,VFM:4},taPopunderSlots:null,taPopupSlots:null,taHoldingWindowCap:2,taPopWindowSet:[],taWindowCount:0,maxPopunders:4,hwClosed:false,getAndUpWindowCount:function(){return this.taWindowCount++},tryHoldingWindows:function(b,a){try{var g=true;for(var c=0;c<a;c++){var f=this.launchHoldingWindow(b);if(!f.windowObject){g=false}}if(g){return true}}catch(d){ta.util.error.record(d,"try two hw",b)}return false},getPopunderSlots:function(){if(this.taPopunderSlots===null){this.taPopunderSlots=new ta.popups.PopunderSlotSet()}return this.taPopunderSlots},getPopupSlots:function(){if(this.taPopupSlots===null){this.taPopupSlots=new ta.popups.PopupSlotSet()}return this.taPopupSlots},createCheckRatesWindow:function(a){return this.buildNewWindow(this.windowType.CHECK_RATE,a)},createHoldingWindow:function(b){var a=this.buildNewWindow(this.windowType.HOLDING,b);if(a&&ta.has("checkrates.belligerent_hw")&&Browser.version>22){ta.store("checkrates.popunder",a)}return a},createVFMWindow:function(a){return this.buildNewWindow(this.windowType.VFM,a)},buildNewWindow:function(b,d){var a=new ta.popups.TAPopWindow(b,d);if(!a){return false}if(!a.errorOpening&&!a.errorMoving&&a.windowObject){try{if(ta.has("checkrates.add_holding_windows")&&d.windowHook&&d.windowHook.location&&d.windowHook.location.href.test(/RuleBasedPopunder/)){this.taPopWindowSet.unshift(a)}else{this.taPopWindowSet[this.taPopWindowSet.length]=a}if(ta.has("checkrates.add_holding_windows")&&!d.windowHook){this.trackPopunder(d.url,this.numPopundersCheck())}return a}catch(c){ta.util.error.record(c,"Window Popup - could not register new window")}}return false},getHoldingWindowSet:function(){var e=[];for(var b=0;b<this.taPopWindowSet.length;b++){var a=this.taPopWindowSet[b];if(a&&a.type==this.windowType.HOLDING){var c=a.windowObject;if(c&&"closed" in c){if(!c.closed){e[e.length]=a}else{if(ta.has("checkrates.add_holding_windows")&&c.closed){this.hwClosed=true;var d=window.cookieDomain;if(d){Cookie.write("CommercePopunder","SuppressAll",{domain:d,duration:0})}}}}}}return e},attemptHoldingWindowWNumChecked:function(e,b,a,d){var f=new ta.commerce.CheckRatesData({type:d,evnt:e},b,a,true);var c=f.getVendorSet().getCheckedInfo("count");if(this.getHoldingWindowSet().length<(c-1)){this.launchHoldingWindow(b)}},openCloseTab:function(){var a=ta.retrieve("checkrates.popunder");if(ta.has("checkrates.belligerent_hw")&&a&&Browser.version>22){var c=window.open("about:blank");if(c){c.close()}ta.remove("checkrates.popunder");try{if(a.windowObject&&a.isTAWindow()){a.moveBehindMain(a.windowObject)}}catch(b){ta.util.error.record(b,"holding window blur")}}},attemptHoldingWindow:function(a){if(ta.has("checkrates.add_holding_windows")){var b=this.numPopundersCheck();if(b>=this.maxPopunders){return}else{this.launchHoldingWindow(a)}}else{if(this.taHoldingWindowCap>this.getHoldingWindowSet().length){this.launchHoldingWindow(a)}}},launchHoldingWindow:function(b){if((b.className.match(/popEnabled/)||b.id.match(/CHECK_RATE/))&&!ta.browser.isIE10Metro()){var a=b.id.match(/check\w+_(\d+)/);if(!a){a=b.className.match(/id_(\d+)/)}if(a&&a[1]){a=a[1]}else{return false}var c=ta.retrieve("checkrates.holdingWindowURI");if(ta.has("checkrates.avlb_popup_win")){c="http://"+window.location.hostname+"/AlsoViewedLB?checkRatesType=checkRates&avlbType=popup&d="+a}if(c){var d={url:c};return this.createHoldingWindow(d)}}return false},launchAddHoldingWindow:function(b){var a={url:b};return this.createHoldingWindow(a)},popunderReminder:function(b){var a={windowHook:b};this.createHoldingWindow(a)},numPopundersCheck:function(){try{var f=this.getHoldingWindowSet();var b=0;var a=new Cookie("CommercePopunder").readRaw();var d=a?a.match(/\d+/):null;if(!a||!d){b=f.length}else{b=Math.max(f.length,parseInt(d[0]))}return b}catch(c){ta.util.error.record(c,"CommercePopunder - numPopundersCheck")}},trackPopunder:function(g,f){try{if(!f||!g){return}var b=null;var c=null;var a=g.match(/RuleBasedPopunder\?Rule=\d+/);if(a){c=a[0].match(/\d+/)}if(c){b="RuleBasedPopunder_"+c[0]}else{b="CommerceEnhancedPopunder"}ta.trackEventOnPage("CommercePopunder","OpenWindow",b,f,true)}catch(d){ta.util.error.record(d,"CommercePopunder - trackPopunder")}},hasMTPU:function(){try{var c=false;var f=this.getHoldingWindowSet();for(var a=f.length;a--;){var b=f[a].windowObject;if(b.location.href.match(/RuleBasedPopunder/)){c=true;break}}return c}catch(d){ta.util.error.record(d,"CommercePopunder - hasMTPU")}},getProviderWindowDims:function(a,d){var b=null;var f=null;var e=null;var c=null;if(a=="hotels.com"){b=975}if(screen.width>=1280){b=1000;f=897;if(!d){e=0;c=0;if(Browser.chrome){f-=50}else{if(Browser.firefox){f-=87}else{if(Browser.ie){b-=12;f-=179}}}}}return{customWidth:b,customHeight:f,widthOffset:e,heightOffset:c}}};ta.popups.TAPopWindow=new Class({Implements:Options,options:{name:"TAWin",url:"",windowHook:false,customWidth:false,customHeight:false,toolbar:1,location:1,directories:1,status:1,menubar:ta.browser.isIE9orHigher()?0:1,resizable:1,copyhistory:1,scrollbars:1,alwaysRaised:false,alwaysLowered:false,widthOffset:8,heightOffset:164,delayLoad:false},initialize:function(c,b){this.setOptions(b);this.type=c;this.assignSlot();if(this.options.customWidth){this.width=this.options.customWidth}if(this.options.customHeight){this.height=this.options.customHeight}if(this.options.widthOffset!=null){this.widthOffset=this.options.widthOffset}if(this.options.heightOffset!=null){this.heightOffset=this.options.heightOffset}if(this.options.delayLoad){this.delayLoad=this.options.delayLoad}if(this.options.windowHook){this.windowObject=this.options.windowHook;if(!ta.has("checkrates.add_holding_windows")){this.windowObject.refresh()}return true}if(ta.has("checkrates.chrome_dates_entry_holding")){this.options.scrollbars=0}this.url=this.options.url;this.assignWinArgs();try{if(this.type==ta.popups.PopUtil.windowType.HOLDING){ta.util.cookie.setPIDCookie(28962)}this.windowObject=window.open("","_blank",this.winArgs);var a=this.windowObject;if(a&&this.isTAWindow()){if(!this.delayLoad){a.location=this.url}}}catch(d){this.errorOpening=d;ta.util.error.record(this.errorOpening,"pop window opening failure",null,{type:this.type,url:this.url})}if(!ta.has("checkrates.belligerent_hw")&&!(Browser.version>22)){try{var a=this.windowObject;if(a&&this.isTAWindow()){if(this.type==ta.popups.PopUtil.windowType.HOLDING){this.moveBehindMain(a)}}}catch(d){this.errorMoving=d;ta.util.error.record(this.errorMoving,"popunder window moving",null,{type:this.type,url:this.url})}}},repurpose:function(d,b,f){if(this.type==ta.popups.PopUtil.windowType.HOLDING){this.type=ta.popups.PopUtil.windowType.CHECK_RATE;this.slot.occupied=false;this.assignSlot();this.url=d;if(b){this.width=b;this.options.widthOffset=0}if(f){this.height=f;this.options.heightOffset=0}var a=this.windowObject;if(a&&this.isTAWindow()){try{a.moveTo(0,0);a.resizeTo(this.width+this.options.widthOffset,this.height+this.options.heightOffset);a.moveTo(this.x,this.y);if(!this.delayLoad){a.focus()}if(!this.delayLoad){a.location=this.url}}catch(c){ta.util.error.record(this.errorMoving,"repurpose popunder fail",null,{type:this.type,url:this.url})}}return this}return false},assignWinArgs:function(){this.winArgs="toolbar="+this.options.toolbar;this.winArgs+=",location="+this.options.location;this.winArgs+=",directories="+this.options.directories;this.winArgs+=",status="+this.options.status;this.winArgs+=",menubar="+this.options.menubar;this.winArgs+=",resizable="+this.options.resizable;this.winArgs+=",copyhistory="+this.options.copyhistory;this.winArgs+=",scrollbars="+this.options.scrollbars;this.winArgs+=",width="+this.width;this.winArgs+=",height="+this.height;this.winArgs+=",left="+this.x;this.winArgs+=",top="+this.y;this.winArgs+=",screenx="+this.x;this.winArgs+=",screeny="+this.y;if(this.options.alwaysRaised){this.winArgs+=",alwaysRaised"}if(this.options.alwaysLowered){this.winArgs+=",alwaysLowered"}},assignSlot:function(){if(this.type==ta.popups.PopUtil.windowType.HOLDING){this.slot=ta.popups.PopUtil.getPopunderSlots().getOpenSlot();this.width=this.slot.tw;this.height=this.slot.th;this.x=this.slot.tx;this.y=this.slot.ty}else{this.slot=ta.popups.PopUtil.getPopupSlots().getOpenSlot();this.width=this.slot.w+this.options.widthOffset;this.height=this.slot.h+this.options.heightOffset;this.x=this.slot.x;this.y=this.slot.y}this.slot.occupied=this},moveBehindMain:function(c){if(ta.has("checkrates.chrome_dates_entry_holding")&&!(ta.has("checkrates.belligerent_hw")&&Browser.version>22)){try{var a=window.open("about:blank");if(a){a.focus();a.close()}}catch(b){ta.util.error.record(b,"holdingWindow - Chrome blur failed")}}c.blur();c.opener=self;c.moveTo(this.slot.x,this.slot.y);c.resizeTo(this.slot.w,this.slot.h);if(!this.delayLoad){c.location=this.url}window.focus()},isTAWindow:function(){var c=true;try{var a=this.windowObject.location;this.windowObject.status="";if(a==null||a==""){c=false}}catch(b){c=false}return c}});ta.popups.Slot=new Class({initialize:function(c,b,d,a){this.x=c;this.y=b;this.w=d;this.h=a;this.occupied=null}});ta.popups.SlotSet=new Class({initialize:function(){this.nW=525;this.nH=460;this.nXI=24;this.nYI=24;this.totalSlots=20;this.slots=[];try{if(screen.width>1024){this.nW=800;this.nH=600;this.nXI=80;this.nYI=40}else{if(screen.width>800){this.nW=620;this.nH=500;this.nXI=60;this.nYI=30}}}catch(a){this.error=a;ta.util.error.record(this.error,"slot set",null,{"slot set":"general"})}},getUsedCount:function(){var b=0;if(this.slots){for(var a=0;a<this.slots.length;a++){if(this.slots[a].occupied&&!this.slots[a].occupied.closed){b++}}}return b},getOpenSlot:function(f){if(!f||f<0||f>this.totalSlots){f=0}var d=function(m){try{var h=false;var k=false;try{k=this.slots[m].occupied}catch(l){}if(!k){h=true}else{try{var g=k.windowObject;if(!g||g.closed){h=true}}catch(l){h=true}}}catch(l){ta.util.error.record(l,"get open slot - get pop slot",null,{totalSlots:this.totalSlots,slotNumber:m})}if(h){this.slots[m].occupied=null;var j=this.slots[m];j.slotPos=m;return j}return false}.bind(this);try{for(var a=f-1;a>=0;a-=1){var c=d(a);if(c){return c}}for(var a=f;a<this.slots.length;a++){var c=d(a);if(c){return c}}}catch(b){ta.util.error.record(b,"get open slot",null,{totalSlots:this.totalSlots})}return false}});ta.popups.PopunderSlot=new Class({Extends:ta.popups.Slot,initialize:function(b,j,d,f,c,a,e,g){this.parent(b,j,d,f);this.tx=c;this.ty=a;this.tw=e;this.th=g}});ta.popups.PopupSlotSet=new Class({Extends:ta.popups.SlotSet,initialize:function(){this.parent();this.nX=500;var b=1160;try{if(screen.width<1660){if(screen.width>1024&&screen.width<1280){b=960}else{if(screen.width<=1024){b=740}}this.nX=screen.width-b}this.nY=!isNaN(window.screenTop)?window.screenTop:!isNaN(window.screenY)?window.screenY:0}catch(c){this.error=c;this.nY=0;ta.util.error.record(this.error,"slot set",null,{"slot set":"popup"})}for(var a=0;a<this.totalSlots;a++){this.slots[a]=new ta.popups.Slot(this.nX,this.nY,this.nW,this.nH);this.nX=this.nX+this.nXI;this.nY=this.nY+this.nYI}}});ta.popups.PopunderSlotSet=new Class({Extends:ta.popups.PopupSlotSet,initialize:function(){this.parent();try{this.nX=(window.screenLeft||window.screenX);this.nY=(window.screenTop||window.screenY)}catch(b){this.error=b;this.nX=200;this.nY=200}this.w=1;this.h=1;this.x=5000;this.y=5000;this.totalSlots=4;try{if(Browser.ie7){this.w=250;this.h=100}if(Browser.safari||Browser.chrome){this.w=85;this.h=100}if(typeof(this.nX)=="undefined"){this.nX=0;this.nY=0;this.x=this.nX+window.screen.availWidth-this.w;this.y=this.nY+window.screen.availHeight-this.h}else{this.x=this.nX+window.getWidth()-this.w;this.y=this.nY+window.getHeight()-this.h}if(Browser.ie7){this.y=this.y-95;this.x=this.x+13}else{if(Browser.safari||Browser.chrome){this.y=this.y-16}}}catch(b){this.error=b}if(this.error){ta.util.error.record(this.error,"slot set",null,{"slot set":"popunder"})}for(var a=0;a<this.totalSlots;a++){this.slots[a]=new ta.popups.PopunderSlot(this.nX,this.nY,this.nW,this.nH,this.x,this.y,this.w,this.h);this.nX=this.nX+this.nXI;this.nY=this.nY+this.nYI}}});window.setupLazyLoad=function(){var a=new LazyLoad({range:200},lazyImgs,lazyHtml);return a};var LazyLoad=new Class({Implements:[Options,Events],options:{range:200,fireScroll:true,mode:"vertical"},initialize:function(p,m,q){this.setOptions(p);this.container=window;var b=(this.options.mode=="vertical"?"y":"x");this.containerDimension=this.container.getSize()[b];this.start=0;var l=this.containerDimension+this.options.range;var k=ta.retrieve("ta.commerce.obf");if(k){try{var h=k.given.split("");var f=k.replace.split("");var d=k.token}catch(j){ta.util.error.record(j,"obfuscation object corrupted")}}var o=0;this.htmlBlocks=q.filter(function(t){var s=ta.id(t.id);if(s&&(s.getPosition()[b]>l&&t.scroll)){o++;return true}else{if(s){try{var w=t.data.indexOf(d);if(k&&w==0){var u=t.data.substr(d.length).split("");for(var r=u.length;r--;){var v=u[r];var w=f.indexOf(v);if(w!=-1){u[r]=h[w]}}s.innerHTML=u.join("")}else{s.innerHTML=t.data}}catch(y){ta.util.error.record(y,"lazy html",null,{id:t.id})}return false}else{return false}}},this);var c=0;this.images=m.filter(function(r){var e=ta.id(r.id);if(e){e.oSRC=r.src||r.data;e.priority=r.priority||1000;if((!e.isVisible()||e.getPosition()[b]>l)&&r.scroll){c++;return true}else{ta.queueLazyImg(e);return false}}else{return false}},this);ta.processLazyImages();var a=function(){var e=this.getScroll();if(e>this.start){this.load();this.start=e}this.fireEvent("scroll");if(!this.images.length){this.container.removeEvent("scroll",a);this.fireEvent("complete")}}.bind(this);this.load=function(){this.htmlBlocks=this.htmlBlocks.filter(function(s){try{var r=ta.id(s.id);if((r&&r.getPosition&&((this.getScroll()+this.options.range+this.containerDimension)>=r.getPosition()[b]))||(r&&!r.getPosition)){r.innerHTML=s.data;return false}}catch(t){ta.util.error.record(t,"lazy",null,{id:s.id})}return true},this);this.images=this.images.filter(function(s){try{var r=ta.id(s.id);if((r&&r.getPosition&&((this.getScroll()+this.options.range+this.containerDimension)>=r.getPosition()[b]))||(r&&!r.getPosition)){ta.queueLazyImg(r);return false}}catch(t){ta.util.error.record(t,"lazy",null,{src:s.src})}return true},this);ta.processLazyImages()}.bind(this);var g=function(){var e=this.container.getSize()[b];if(e>this.containerDimension){this.containerDimension=e;this.load()}}.bind(this);this.container.addEvent("scroll",a);this.container.addEvent("resize",g);if(this.options.fireScroll){this.container.fireEvent("scroll")}},getScroll:function(){if(this.container&&this.container.getScroll){return this.container.getScroll()[this.options.mode=="vertical"?"y":"x"]}else{return 9000}}});var sTAMGFooterCookieName="hideTAMGFooter";var sFooterDivId="TM_FTR";var hmOngoingHover={};var savedDomain="tripadvisor.com";if(typeof cookieDomain!="undefined"){savedDomain=cookieDomain.substring(1,cookieDomain.length)}function _closeOverlay(){var a=ta.retrieve("overlays.current");if(a){a.hide()}}function setTAMGFooterCookie(d,c){var b=new Date();b.setTime(b.getTime());var e=1000*60*60*24*7;var a=new Date(b.getTime()+(e));document.cookie=sTAMGFooterCookieName+"="+escape(d)+";expires="+a.toGMTString()+";path=/"+((savedDomain)?";domain="+savedDomain:"");hideFooter(c)}function openUrl(b){var a=window.open(b);a.opener=null}function getTAMGFooterCookie(){var e=document.cookie.split(";");var a="";var c="";var d="";var b=false;for(i=0;i<e.length;i++){a=e[i].split("=");c=a[0].replace(/^\s+|\s+$/g,"");if(c==sTAMGFooterCookieName){b=true;if(a.length>1){d=unescape(a[1].replace(/^\s+|\s+$/g,""))}return d;break}a=null;c=""}if(!b){return null}}function hideFooter(b){if(!b){b=sFooterDivId}var a=document.getElementById(b);if(a){a.style.display="none"}}function tamgShowFly(c,d,b,a){hmOngoingHover[d]=true;setTimeout(function(){if(hmOngoingHover[d]){tamgCreateFly(c,b,a)}},250)}function tamgHideFly(a,c,b){var d=b.toElement||b.relatedTarget;while(d&&d!=a){d=d.parentNode}if(d!=a){hmOngoingHover[c]=false;setTimeout(function(){if(hmOngoingHover[c]==false){$$("."+c)[0].hide()}},250)}}function tamgCreateFly(g,j,e){var f=$(g).getElements(".ftrFly")[0];if($(f).getElements("img")[0]){f.show()}else{var k=CDNHOST+"/img2/x.gif";var h="ftrFlyLogo "+j;var d=new Element("img",{"class":h,src:k}).inject(f,"top");d.setProperty("height","25");d.setProperty("width",e);var c=new Element("div",{"class":"triWrap"});var b=new Element("span",{"class":"cssTri"});var a=new Element("span",{"class":"cssTri"});b.inject(a);a.inject(c);c.inject(f,"bottom");f.show()}}function getTAMGFooterViaAjax(d,c,a,b){new Request({url:"/TAMGFooterAjax",onSuccess:function(f){ta.id("TAMGFooterHolder").innerHTML=f},data:{a:"SHOW_FOOTER",dis:d,loc:c,"new":a,serv:b},evalScripts:true,method:"get"}).send()}ta.servlet.Member={memberBenefitsSubscribe:function(a){ta.servlet.Member.processMOSubscribeRequest(a);return false},memberGuideRequest:function(a){processGuideRequest(a)},memberTOGForm:function(a){processTOGForm(a)},processMOSubscribeRequest:function(a){if(!loggedIn){new Event(a).preventDefault();return false}var d=$("MEMONLY_SUBS_FORM");d.elements.action.value="subscribe";var c={url:"/TravelGuides",data:d,onFailure:function(f){alert(f.status+"\n"+f.responseText)}};c.onSuccess=ta.servlet.Member.subscribeRequestResFunc;var b=window["validate"+d.id];new Event(a).preventDefault();new Request(c).send()},subscribeRequestResFunc:function(a){if(a!=""){for(subtype in subtypes){if(subtyperes[subtype].test(a)){if(subtype=="tw"&&ta.retrieve("tcd.refresh")){window.location.reload()}var g=document.getElementById(subtype+"Optin");g.setAttribute("checked","true");g.setAttribute("disabled","true");var c=document.getElementById(subtype+"OptinLbl");c.innerHTML="<b>"+headings[subtype]+"</b> "+tamg_thanks;var f=document.getElementById("OPTINTEXT");f.style.display="none"}}var k={};for(subtype in subtypes){var d=document.getElementById(formids[subtype]);k[subtype]=d.checked}var h=true;var j=true;for(subtype in k){if(subtyperes[subtype].test(a)){h=false}if(!k[subtype]){j=false}}if(j){var e=document.getElementById("NLSUBMITDIV");e.style.display="none"}if(h){var b=document.getElementById("OPTINTEXT");b.innerHTML='<div class="alert">'+no_selection_error+"</div>";b.style.display="block"}}},addTripWatchLocation:function(event,elmt,updateTxt){var mElmt=new Element(elmt);new Event(event).stop();new Request({url:elmt.href,onFailure:ta.util.error.ajaxFailure.partial("Member:addTripWatchLocation"),onSuccess:function(txt,xml){if(txt.match(/^{/)){var data=eval("("+txt+")");if(data.ERROR){ta.overlays.showInLightbox(data.ERROR);return}else{if(data.ALERT){ta.overlays.showInLightbox(data.ALERT);return}}}var spanElt=new Element("span");spanElt.set("html",updateTxt);mElmt.hide();spanElt.inject(mElmt,"after")}}).send()},addTripWatchLocationReload:function(a){new Request({url:a.href,onFailure:ta.util.error.ajaxFailure.partial("Member:addTripWatchLocationReload"),onSuccess:function(b,c){window.location.reload()}}).send()}};ta.servlet.Tourism={bbOfferClicked:function(b,a){b.preventDefault();a=$(a);if(a.get("tag")!="tr"||!a.hasClass("offerRow")){a=a.getParent("tr.offerRow")}offerLink=a.getElement("a");popCommFN=linkMap.js_popComm;popCommFN(offerLink,b)},showGeoDescription:function(b,a){new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,style:"s4 dg descriptionLB",content:"<p>"+ta.id("DESCRIPTION_TEXT").innerHTML+"</p>"})},styleButtonOver:function(a){if(ta.id(a.target).hasClass("sprite-hotelStyleBack")){ta.id(a.target).removeClass("sprite-hotelStyleBack");ta.id(a.target).addClass("sprite-hotelStyleBackHover")}},styleButtonOut:function(a){if(ta.id(a.target).hasClass("sprite-hotelStyleBackHover")){ta.id(a.target).removeClass("sprite-hotelStyleBackHover");ta.id(a.target).addClass("sprite-hotelStyleBack")}},parseHashParams:function(c){var b={};try{var a=c.indexOf("#");if(a>-1){var g=c.substr(a+1).split("&");for(var f=0;f<g.length;f++){var j=g[f].split("=");var d=j[0];if(d!=null&&d!=""){b[d]=j[1]}}}}catch(h){ta.util.error.record(h,"Error parsing hash params in ta.servlet.Tourism.parseHashParams.")}return b}};ta.widgets.slider={handleSeparation:10,isRtl:function(){return ta.util.i18n.isRtl()},getValue:function(c,b){var a="";if(this.isRtl()){if(c.style.right&&c.style.right.trim()!=""){a=c.style.right}else{a=b.style.left}}else{a=c.style.left}if(a!=""){return a.toFloat()}return 0},resetHooks:function(e){var d=e.hasClass("slider_redesign")?e:e.getElement(".slider_redesign");var c=d.className;var b=parseFloat((c.match(/min_(\d+)/)[1]).replace("_","."));var a=parseFloat((c.match(/max_(\d+)/)[1]).replace("_","."));return this.setHooks(e,b,a)},setHooks:function(s,e,g,d,f){var o=s.hasClass("slider_redesign")?s:s.getElement(".slider_redesign");var h=o.className;var q=parseInt(h.match(/steps_(\d+)/)[1]);var l=parseFloat((h.match(/min_(\d+)/)[1]).replace("_","."));if(d&&l!=d){o.removeClass("min_"+l);o.addClass("min_"+d);l=d}var p=parseFloat((h.match(/max_(\d+)/)[1]).replace("_","."));if(f&&p!=f){o.removeClass("max_"+p);o.addClass("max_"+f);p=f}if(e<l){e=l}if(g>p){g=p}var j=parseInt(h.match(/width_(\d+)/)[1])-this.handleSeparation;var c=o.hasClass("maxAllInclusive");var r=j/(q-1);var a=(p-l)/(q-1);var m=(e-l)/a;var t=(g-l)/a;this.updateEnd(o.getElement(".handle-left"),this.isRtl()?t:m,r,true);this.updateEnd(o.getElement(".handle-right"),this.isRtl()?m:t,r,false);this.updateBar(o.getElement(".slider-range"),m,t,r,"set");var b=c&&(g>=p);if(o.id=="priceSelect"){this.priceUpdate(s,e,g,b)}else{if(o.id=="ratingSelect"){this.ratingUpdate(s,e,g,b)}else{if(o.id=="bedroomsSelect"){this.bedroomsUpdate(s,e,g,b)}else{this.simpleUpdate(s,e,g,b)}}}var v=s.getElement(".minMax");var u=v.value;var k=this.updateMinMax(v,m,t,a,q,l);return u!=k},updateMinMax:function(f,g,b,a,c,e){var d=(g<=0?0:g*a+e)+","+(b>=(c-1)?999999:b*a+e);f.value=d;return d},updateEnd:function(d,c,e,b){var a=c*e+(this.isRtl()^b?0:this.handleSeparation);if(this.isRtl()){d.setStyle("right",a+"px");d.setStyle("left","")}else{d.setStyle("left",a+"px");d.setStyle("right","")}return a},updateBar:function(b,g,d,f){if((g>d)){g^=d;d^=g;g^=d}var a=g*f;var c=(d*f+this.handleSeparation)-a;if(c<0){c*=-1}var e=this.isRtl()?"right":"left";if(this.isRtl()){b.setStyle("right",a)}else{b.setStyle("left",a)}b.setStyle("width",c)},initSliderInfo:function(e){var d={};var c=e.className;d.width=parseInt(c.match(/width_(\d+)/)[1])-this.handleSeparation;d.steps=parseInt(c.match(/steps_(\d+)/)[1]);d.min=parseFloat((c.match(/min_(\d+)/)[1]).replace("_","."));d.max=parseFloat((c.match(/max_(\d+)/)[1]).replace("_","."));d.stepSize=(d.max-d.min)/(d.steps-1);d.maxAllInclusive=e.hasClass("maxAllInclusive");d.snapDistance=d.width/(d.steps-1);d.rangeBar=e.getElement(".slider-range");d.minMax=e.getElement(".minMax");d.startMinMax=d.minMax.value;d.singleValue=e.hasClass("singleValue");var f=e.getParent().getElement(".handle-left");var b=e.getParent().getElement(".handle-right");var g=this.getValue(f,b);var a=this.getValue(b,f);if(this.isRtl()){g-=this.handleSeparation}else{a-=this.handleSeparation}d.leftStep=this.getClosestStep(g,d);d.rightStep=this.getClosestStep(a,d);return d},setSliderTarget:function(b,a){if(b.hasClass("handle-left")){a.target=b.getParent().getElement(".handle-left");if(this.isRtl()){a.limits=[a.rightStep+(a.singleValue?0:1),a.steps-1]}else{a.limits=[0,a.rightStep-(a.singleValue?0:1)]}a.isLeftHook=true}else{a.target=b.getParent().getElement(".handle-right");if(this.isRtl()){a.limits=[0,a.leftStep-(a.singleValue?0:1)]}else{a.limits=[a.leftStep+(a.singleValue?0:1),a.steps-1]}a.isLeftHook=false}return a},handleMouseDown:function(f,a){var d=new Event(f);if(d){d.stop();var c=ta.id(d.target);if(c){var b=this.initSliderInfo(c.getParent());b=this.setSliderTarget(c,b);b.snapCallBack=a.bind(this);b.dragHandle=this.handleMouseMove.bind(this);b.upHandle=this.handleMouseUp.bind(this);document.addListener("mousemove",b.dragHandle);document.addListener("mouseup",b.upHandle);document.addListener("touchmove",touchHandler);document.addListener("touchend",touchHandler);b.offset=c.getParent().getCoordinates().left+10+(b.isLeftHook?0:this.handleSeparation);ta.store("slider_info",b)}}},getClosestStep:function(a,b){return Math.round(a/b.snapDistance)},handleMouseMove:function(d){d=new Event(d);var b=ta.retrieve("slider_info");if(b&&b.target){var c=d.page.x-b.offset;var a=this.getClosestStep(c,b);if(this.isRtl()){a=b.steps-a-1}if(a<b.limits[0]){a=b.limits[0]}else{if(b.limits[1]<a){a=b.limits[1]}}this.sliderDrag(d,a,b,c)}d.stop()},sliderDrag:function(d,g,k,j){if(d){d.stop();var a=k.isLeftHook?g:k.leftStep;var h=k.isLeftHook?k.rightStep:g;this.updateEnd(k.target,g,k.snapDistance,k.isLeftHook);this.updateBar(k.rangeBar,a,h,k.snapDistance);this.updateMinMax(k.minMax,a,h,k.stepSize,k.steps,k.min);ta.store("slider_info",k);if(k.snapCallBack){var b=(this.isRtl()?h:a)*k.stepSize+k.min;var f=(this.isRtl()?a:h)*k.stepSize+k.min;var c=k.maxAllInclusive&&(f==(k.steps-1)*k.stepSize+k.min);k.snapCallBack(k.target,b,f,c)}}},handleMouseUp:function(b){b=new Event(b);if(b){b.stop()}var a=ta.remove("slider_info");if(a){document.removeListener("mousemove",a.dragHandle);document.removeListener("mouseup",a.upHandle);document.removeListener("touchmove",touchHandler);document.removeListener("touchend",touchHandler);a.dragHandle=null;a.upHandle=null;if(a.minMax.value!=a.startMinMax){sliderMoved()}}},currencyUpdate:function(){var b=ta.id("l1currency");if(!b){return}var f=ta.retrieve("ta.currencyHash");if(!f){return}var h=f[parseInt(b.value)];var l=ta.id("pricePeriod_w");if((l!=null)&&l.checked){var k=ta.retrieve("ta.weekCurrencyHash");if(k){h=k[parseInt(b.value)]}}var j=ta.id("priceSelect").getParent();var a=j.getElement(".slider_redesign");var g=a.className;var d=currencyCodes[parseInt(j.getElement("select").value)];var c=ta.has("hacform.slider.price.min")?ta.remove("hacform.slider.price.min"):h.selMin;var e=ta.has("hacform.slider.price.max")?ta.remove("hacform.slider.price.max"):h.selMax;a.className=g.replace(/steps_\d+/,"steps_"+h.steps);ta.widgets.slider.setHooks(j,c,e,h.min,h.max)},priceUpdate:function(f,d,b,a){if(!f.hasClass("prcRng")){f=f.getParent(".prcRng")}var g=ta.id("l1currency");var e=currencyCodes[parseInt(g.value)];f.getElement(".s_min").innerHTML=ta.util.currency.formatCurrency(d,e);var c=ta.util.currency.formatCurrency(b,e);if(a){c+="+"}f.getElement(".s_max").innerHTML=c},ratingUpdate:function(g,e,c,b){if(!g.hasClass("tvrRtg")){g=g.getParent(".tvrRtg")}var a=e.toPrecision(2);var h=c.toPrecision(2);g.getElement(".s_min").innerHTML=a;g.getElement(".s_max").innerHTML=h;var d=g.getElement(".sLeft .lmtImg").src;g.getElement(".sLeft .lmtImg").src=d.replace(/\d.\d/,a);var f=g.getElement(".sRight .lmtImg").src;g.getElement(".sRight .lmtImg").src=f.replace(/\d.\d/,h)},bedroomsUpdate:function(d,c,b,a){if(d.tagName!="FIELDSET"){d=d.getParent("FIELDSET")}d.getElement(".s_min").innerHTML=(c==0?js_filter_studio:c);d.getElement(".s_max").innerHTML=(b==0?js_filter_studio:(b+(a?"+":"")))},simpleUpdate:function(d,c,b,a){if(d.tagName!="FIELDSET"){d=d.getParent("FIELDSET")}d.getElement(".s_min").innerHTML=c;d.getElement(".s_max").innerHTML=b+(a?"+":"")}};function touchHandler(c){var d=c.changedTouches,e=d[0],a="";switch(c.type){case"touchmove":a="mousemove";break;case"touchend":a="mouseup";break;default:return}var b=document.createEvent("MouseEvent");b.initMouseEvent(a,true,true,window,1,e.screenX,e.screenY,e.clientX,e.clientY,false,false,false,false,0,null);e.target.dispatchEvent(b);c.preventDefault()}ta.overlays.BACKDROP_NEVER=0;ta.overlays.BACKDROP_ALWAYS=1;ta.overlays.Overlay=new Class({Implements:[Options,Events],Binds:["_hide","show","hide","destroy"],options:{requestData:null,showCloseButton:false,noPadding:false,closeButtonClass:"close",closeLink:"",showArrow:false,arrowClassLeft:null,arrowClassRight:null,arrowClass:"ttarrow",style:"typeO",innerDivClass:"inner",backdrop:ta.overlays.BACKDROP_NEVER,permanent:false,isChild:false,remoteContent:null,keepElementInDocument:false,requestMethod:"get",zIndex:1001,positionType:"absolute",draggable:false,draggingClass:"dragging",title:null,onscroll:null,backdropClickClose:false,offsetRight:0,offsetLeft:0,offsetTop:0,closeOnDocumentClick:false,track:false},initialize:function(a,b){this.setOptions(a);this.source=ta.id(b);this.visible=false;this.backdropOn=false;this.container=new Element("div",{styles:{position:this.options.positionType,left:"-999em",top:"-999em",fontSize:this.options.fontSize||".75em",zIndex:this.options.zIndex},"class":this.options.style+" overlay"});this.container.store("overlay",this);this.container.overlay=this;this._useIframeShim=Browser.ie6;if(this.options.title){this.header=new Element("h1",{"class":"title",html:this.options.title}).inject(this.container);if(this.options.draggable){var f=this.options.draggingClass;var e=function(){};if(this._useIframeShim){e=this.positionShim.bind(this)}this.drag=new Drag(this.container,{handle:this.header,preventDefault:true,stopPropagation:true,onSnap:function(g){g.addClass(f)},onDrag:e,onComplete:function(g){g.removeClass(f)}})}}this.inner=new Element("div",{"class":this.options.innerDivClass}).inject(this.container);var d=this;if(d.options.onscroll){d.inner.addEvent("scroll",function(){d.options.onscroll(d.inner)})}if(this._useIframeShim){this.shim=new IframeShim(this.container,{browsers:true})}var c;if(this.options.content){this.inner.setContent(this.options.content)}else{if(this.options.remoteContent){this.loadRemoteContent(this.options.remoteContent)}else{if(this.source&&(c=this.source.getElement(".overlayContents"))){if(c){this.inner.set("html",c.innerHTML);c.dispose();this.runBehaviorOnFirstShow=true}}}}if(this.options.showCloseButton){this.closeBtn=new Element("div",{styles:{position:"absolute",fontSize:"92.5%",cursor:"pointer"},html:this.options.closeLink,"class":this.options.closeButtonClass,events:{click:(function(){this.fireEvent("onClose",this)}).bind(this)}}).inject(this.container);if(this.header){this.container.addClass("withClose")}else{this.inner.addClass("withClose")}}if(this.options.showArrow){this.arrow=new Element("div",{styles:{position:"absolute"},"class":this.options.arrowClass}).inject(this.container);if(this.header){this.container.addClass("withClose")}else{this.inner.addClass("withClose")}}if(this.options.noPadding){if(this.header){this.container.addClass("noPad")}else{this.inner.addClass("noPad")}}this.container.addEvent("trash",this.destroy)},destroy:function(){this.container.overlay=null;if(this.shim){this.shim.destroy();this.shim=null}},position:function(){if(this.shim){(function(){this.positionShim()}).delay(10,this)}},positionShim:function(){var a=this.container.getCoordinates();if(!a||!a.left){return}this.shim.shim.setStyles({left:a.left,top:a.top})},show:function(a){if(typeof(overlayCss)!="undefined"&&!ta.retrieve("ta.overlayCssAsset")){ta.store("ta.overlayCssAsset",Asset.css(overlayCss));this._show(a)}else{this._show(a)}},_show:function(d){if(this.visible){return}if(d){new Event(d).preventDefault()}var a=ta.util.URL.parse(this.options.remoteContent);if(typeof crPageServlet!=="undefined"&&a&&a.test(/\/{1}(\w*)$/)){ta.store("crPageServlet_orig",crPageServlet);crPageServlet=RegExp.$1}$$(".overlay").each(function(c){if(c.overlay){if(c.overlay==this){return}if(this.parentOverlay&&c.overlay==this.parentOverlay){return}if(c.overlay.options.permanent){return}c.overlay.hide(d)}},this);ta.id(document.body).adopt(this.container);if(this.shim&&this.shim.shim){ta.id(document.body).adopt(this.shim.shim);var b=this.container.getCoordinates();if(b){this.shim.shim.setStyles({display:"block",width:b.width,height:b.height})}}this.position();if(this.options.closeOnDocumentClick){document.addEvent("click",this._hide)}if(this.options.backdrop==ta.overlays.BACKDROP_ALWAYS){this.enableBackdrop()}this.visible=true;this.fireEvent("onShow",this);if(ta.has("overlay.onShow")){ta.remove("overlay.onShow").each(function(c){c.call(this)},this)}return this},_hide:function(a){if(!a||this.container.containsEvent(a)){return}document.removeEvent("click",this._hide);this.hide(a)},hide:function(a){if(window.flyout){window.flyout.hide()}if(this.backdropOn){this.disableBackdrop()}if((this.options.keepElementInDocument&&this.container.style.left=="-999em")||(!this.options.keepElementInDocument&&!this.container.inDocument())){return this}if(this.shim){this.shim.hide().dispose()}this.container.setStyles({left:"-999em",top:"-999em"});if(!this.options.keepElementInDocument){this.container.dispose()}this.visible=false;this.fireEvent("onHide",!a);if(ta.has("crPageServlet_orig")){ta.run("ta.commerce.checkrates.restoreCRPageServlet")}return this},configureBackdrop:function(){this.backdrop=new Element("div",{"class":"overlayBG"});this.backdrop.setStyles({position:"absolute",left:0,top:0,width:"100%",height:window.innerHeight?window.innerHeight:(document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.offsetHeight),backgroundColor:"#000",zIndex:this.options.isChild?"10000":"9997",opacity:0.6});if(this.options.backdropClickClose){this.backdrop.addEvent("click",this.hide)}},updateBackdrop:function(){this.backdrop.setStyles({width:"100%",height:(document.height!==undefined)?document.height:document.body.offsetHeight})},enableBackdrop:function(){try{if(this.backdropOn){return}if(!this.backdrop){this.configureBackdrop()}if(Browser.ie6){var a=this.container;$$("select").each(function(c){if(!a.contains(c)){c.setStyle("visibility","hidden")}else{c.setStyle("visibility","visible")}})}ta.store("overlays.current",this);this.updateBackdrop();if(this.container.inDocument()){this.backdrop.inject(this.container,"before")}else{this.backdrop.inject(document.body)}this.backdropOn=true;this.container.setStyle("z-index",this.options.isChild?"10002":"9998");if(ta.isDHTMLCRRedesign2012()&&this.container.getElement(".check_availability")){if(Browser.ie7||Browser.ie8){this.container.setStyle("border","5px solid #424242")}else{this.container.setStyle("border","5px solid rgba(64,64,64,0.8)")}}}catch(b){ta.util.error.record(b,"Error setting the border property - enableBackdrop")}},disableBackdrop:function(){try{if(!this.backdropOn){return}this.backdrop.dispose();if(ta.retrieve("overlays.current")==this){ta.remove("overlays.current");if(Browser.ie6){$$("select").setStyle("visibility","visible")}}else{if(Browser.ie6&&ta.retrieve("overlays.current")&&!ta.retrieve("overlays.current").backdropOn){$$("select").setStyle("visibility","visible")}}this.backdropOn=false;this.container.setStyle("z-index","1001");if(ta.isDHTMLCRRedesign2012()&&this.container.getElement(".check_availability")){if(Browser.ie7||Browser.ie8){this.container.setStyle("border","5px solid #b2b2b2")}else{this.container.setStyle("border","5px solid rgba(128,128,128,0.6)")}}}catch(a){ta.util.error.record(a,"Error unsetting the border property - disableBackdrop")}},loadRemoteContent:function(c,a){var b={url:ta.util.URL.parse(c),method:this.options.requestMethod,data:this.options.requestData,onSuccess:this.loadRemoteSuccess.bind(this),onFailure:this.loadRemoteFailure.bind(this),evalScripts:true};this.options.track&&(b.trackEvent=this.options.track);if(!a){new Asset.image(CDNHOST+"/img2/generic/site/loop.gif",{onload:this.position.bind(this),"class":"anim_loop"}).inject(this.inner)}new Request(b).send();return this},loadRemoteSuccess:function(a){this.cachedWidth=null;this.inner.setContent(a);this.position();if(typeof behavior!="undefined"&&behavior&&behavior.apply){behavior.apply(this.inner)}this.fireEvent("onLoad",this);this.cachedWidth=this.container.getSize().x;return this},loadRemoteFailure:function(){this.inner.addClass("ajax_failed");this.inner.setStyle("width","383px");this.inner.setStyle("padding","14px 24px 14px 14px");this.inner.set("text",JS_Ajax_failed)}});ta.overlays.getCurrent=function(){var a=$$(".overlay").shift();return a&&a.retrieve("overlay")};ta.overlays.safeCloseCurrent=function(){var a=ta.overlays.getCurrent();return a&&a.hide()};ta.overlays.AbsoluteOverlay=new Class({Extends:ta.overlays.Overlay,options:{xOffset:0,yOffset:0,toWindow:true,repositionOnScroll:false,autoShow:true,stayOpen:false},initialize:function(a,b){a=a||{};a.showCloseButton=[a.showCloseButton,true].pick();this.parent(a,b);if(this.options.showCloseButton&&!this.options.stayOpen){this.closeBtn.addEvent("click",this.hide)}if(this.options.autoShow){this.show()}},show:function(a){this.parent(a);if(this.options.repositionOnScroll){window.addEvent("scroll",this.delayedScroll.bind(this))}},hide:function(a){this.parent(a);if(this.options.repositionOnScroll){window.removeEvent("scroll",this.delayedScroll.bind(this))}},delayedScroll:function(){this.position.delay(500,this)},position:function(){this.container.setStyles({left:this.options.xOffset,top:this.options.yOffset+(this.options.toWindow?window.getScrollTop():0)});this.parent()}});ta.overlays.CenteredOverlay=new Class({Extends:ta.overlays.Overlay,options:{delayedPosition:false,autoShow:true,attachCloseEvent:true,xOffset:-1,yOffset:-1,fixed:false},initialize:function(a,b){a=a||{};a.showCloseButton=[a.showCloseButton,true].pick();a.fixed&&(this.options.positionType="fixed");this.parent(a,b);if(this.options.showCloseButton&&this.options.attachCloseEvent){this.closeBtn.addEvent("click",this.hide)}this.options.autoShow&&this.show()},position:function(d){var b=ta.retrieve("ta.overlays.CenteredOverlay.position.iters");if(!b){b=0}var f=this.container.getCoordinates();if(f.height<=14&&b<10){ta.store("ta.overlays.CenteredOverlay.position.iters",b+1);this.position.delay(100,this,true);return}var a=this.options.xOffset;var e=this.options.yOffset;if(a===-1){a=Math.max(5,window.getWidth()-f.width)/2;!this.options.fixed&&(a+=window.getScrollLeft())}else{a-=f.width/2}if(e===-1){e=Math.max(20,window.getHeight()-f.height)/2;!this.options.fixed&&(e+=window.getScrollTop())}else{e-=f.height/2}this.container.setStyles({left:a,top:e});this.parent()},positionShim:function(){var a=this.container.getCoordinates();if(!a||!a.left){return}this.shim.shim.setStyles({left:a.left,top:a.top,width:a.width,height:a.height})}});ta.overlays.showInLightbox=function(a,b){return new ta.overlays.CenteredOverlay(Object.merge({backdrop:ta.overlays.BACKDROP_ALWAYS},b)).loadRemoteSuccess(a)};ta.overlays.loadInLightbox=function(b,a){return new ta.overlays.CenteredOverlay(Object.merge({backdrop:ta.overlays.BACKDROP_ALWAYS},a)).loadRemoteContent(b)};var lightbox={deactivate:function(){var a=ta.retrieve("overlays.current");a&&a.hide()}};ta.overlays.ACTIVATE_NEVER=0;ta.overlays.ACTIVATE_CLICK=1;ta.overlays.ACTIVATE_HOVER=2;ta.overlays.ACTIVATE_FOCUS=3;ta.overlays.ACTIVATE_HOVER_DELAY=4;ta.overlays.ACTIVATE_BOTH=5;ta.overlays.PINNABLE_NEVER=0;ta.overlays.PINNABLE_ALWAYS=1;ta.overlays.PINNABLE_CLICK=2;ta.overlays.BACKDROP_PINNED=2;ta.overlays.RelativeOverlay=new Class({Extends:ta.overlays.Overlay,Binds:["_hide","show","hide","destroy","hideNow","showWithDelay","hideWithDelay","_pin"],options:{activate:ta.overlays.ACTIVATE_NEVER,pinnable:ta.overlays.PINNABLE_NEVER,autoShow:true},initialize:function(b,c){this.parent(b,c);this.container.addClass("relative");var a=this.source.getParentBySelector(".overlay");if(a){this.container.setStyle("z-index",a.getStyle("z-index")+1);this.parentOverlay=a.overlay}if(this.options.showCloseButton){this.closeBtn.addEvent("click",this.hideNow)}switch(this.options.activate){case ta.overlays.ACTIVATE_CLICK:this.source.addEvent("click",this.show);break;case ta.overlays.ACTIVATE_HOVER:this.source.addEvent("mouseenter",this.show);this.source.addEvent("mouseleave",this.hide);this.container.addEvent("mouseenter",this.show);this.container.addEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_HOVER_DELAY:this.source.addEvent("mouseenter",this.showWithDelay);this.source.addEvent("mouseleave",this.hideWithDelay);this.container.addEvent("mouseenter",this.show);this.container.addEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_FOCUS:this.source.addEvent("focus",this.show);break}switch(this.options.pinnable){case ta.overlays.PINNABLE_CLICK:this.source.addEvent("click",this._pin);break}var e=this.source.getElement(".overlaySrc");if(e){if(e.get("tag")=="a"){this.loadRemoteContent(e.href)}else{this.loadRemoteContent(e.get("text"));e.dispose()}}else{if(!this.options.content&&this.source.get("tag")=="a"){this.loadRemoteContent(this.source.href)}}var d=ta.id(this.source.id+"_CONTENTS");if(d){this.inner.set("html",d.innerHTML);d.dispose();this.runBehaviorOnFirstShow=true}if(this.options.autoShow){this.show()}else{if(this.options.delayShow){this.showWithDelay()}}},show:function(b){b=b||window.event;if(b){new Event(b).stop()}var a=this.visible;this.parent(b);clearTimeout(this.showTimeout);if((this.options.activate==ta.overlays.ACTIVATE_HOVER||this.options.activate==ta.overlays.ACTIVATE_HOVER_DELAY)&&this.hideTimer){clearTimeout(this.hideTimer);this.hideTimer=null}if(a){return}if(this.runBehaviorOnFirstShow){this.runBehaviorOnFirstShow=false;if(typeof behavior!="undefined"&&behavior&&behavior.apply){behavior.apply(this.inner)}}this.cachedWidth=this.container.getSize().x;switch(this.options.activate){case ta.overlays.ACTIVATE_HOVER:case ta.overlays.ACTIVATE_HOVER_DELAY:break;case ta.overlays.ACTIVATE_CLICK:case ta.overlays.ACTIVATE_FOCUS:if(this.options.pinnable==ta.overlays.PINNABLE_NEVER){document.addEvent("click",this.hide)}break}return this},hide:function(b){b=b||window.event;if(!this.visible){return}if(window.flyout){window.flyout.hide()}if(b){var a=new Event(b);if(a.target&&a.target.tagName=="option"){return}if(Browser.ie&&a.target&&a.target.tagName=="select"&&this.container.getElements("select").contains(a.target)){return}}switch(this.options.activate){case ta.overlays.ACTIVATE_HOVER:case ta.overlays.ACTIVATE_HOVER_DELAY:if(!this.hideTimer){this.hideTimer=this.hide.delay(250,this);return}else{clearTimeout(this.hideTimer);this.hideTimer=null}break;case ta.overlays.ACTIVATE_CLICK:case ta.overlays.ACTIVATE_FOCUS:if(b&&this.container.containsEvent(b)){return}if(this.options.pinnable==ta.overlays.PINNABLE_NEVER){document.removeEvent("click",this.hide)}break}return this.hideNow()},hideNow:function(a){if(!this.visible){return this}if(this.backdropOn){this.disableBackdrop()}if(this.shim){this.shim.hide().dispose()}this.container.setStyles({left:"-999em",top:"-999em"}).dispose();this.visible=false;if(this.options.pinnable==ta.overlays.PINNABLE_CLICK){this.unpin()}this.fireEvent("onHide");return this},_pin:function(a){this.pin();this.toggleBackdrop(true)},pin:function(){this.source=ta.id(this.source);switch(this.options.activate){case ta.overlays.ACTIVATE_HOVER:this.source.removeEvent("mouseenter",this.show);this.source.removeEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_HOVER_DELAY:this.source.removeEvent("mouseenter",this.showWithDelay);this.source.removeEvent("mouseleave",this.hideWithDelay);break}this.container.removeEvent("mouseenter",this.show);this.container.removeEvent("mouseleave",this.hide);this.pinned=true;return this},toggleBackdrop:function(a){if(this.options.backdrop==ta.overlays.BACKDROP_PINNED){this.enableBackdrop()}},unpin:function(){this.source=ta.id(this.source);switch(this.options.activate){case ta.overlays.ACTIVATE_HOVER:this.source.addEvent("mouseenter",this.show);this.source.addEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_HOVER_DELAY:this.source.addEvent("mouseenter",this.showWithDelay);this.source.addEvent("mouseleave",this.hideWithDelay);break}this.container.addEvent("mouseenter",this.show);this.container.addEvent("mouseleave",this.hide);if(this.options.backdrop==ta.overlays.BACKDROP_PINNED){this.disableBackdrop()}this.pinned=false;return this},showWithDelay:function(a){a=a||window.event;clearTimeout(this.showTimeout);if(this.visible){return this.show(a)}else{this.showTimeout=this.show.delay(300,this)}},hideWithDelay:function(a){a=a||window.event;if(!this.visible){clearTimeout(this.showTimeout)}else{return this.hide(a)}}});ta.overlays.RelativeOverlayHorizontal=new Class({Extends:ta.overlays.RelativeOverlay,initialize:function(a,b){if(a.onRight==null){if(IS_DEBUG){alert("ERROR: Attempting to create Horizontal Overlay without specifying direction.")}return}this.parent(a,b)},position:function(){if(this.options.onRight){this.positionRight()}else{this.positionLeft()}this.parent()},adjustTop:function(f,j){try{this.source=ta.id(this.source);var l=f+this.options.offsetTop;var g=window.getScrollTop()+window.getHeight();var k=document.getElementById("tamgFooter");if(k){if(k.offsetHeight){g=g-k.offsetHeight}else{if(k.clientHeight){g=g-k.clientHeight}}}if(l+j.height>=g){l=g-j.height-1;if((this.crDHTML_BASIC||this.crDHTML_PNG24)&&this.options.showArrow){var b=this.container.getElement(".check_availability");var d=this.container.getElement(".username");if(b||d){var a=b?b:d;var c=a.getCoordinates().height}l=g-j.height+c-9}}return l}catch(h){ta.util.error.record(h,"adjustTop: RelativeOverlayHorizontal")}},positionLeft:function(){try{this.source=ta.id(this.source);var d=this.source.getCoordinates();var b=this.container.getStyle("margin-top").toInt();var a=ta.id("PAGE").getCoordinates();var h=this.container.getCoordinates();if(!this.flipped&&d.left-a.left-(this.cachedWidth||h.width)<0){this.flipped=true;this.options.onRight=true;if(this.arrow){this.arrow.className=this.options.arrowClassLeft}this.positionRight();return}if(ta.isDHTMLCRRedesign2012()&&this.container.getElement(".check_availability")){this.positionLeftOrRight(d,b,a,h,"left")}else{var f=this.adjustTop(d.top,h);d.left=d.left-this.options.offsetLeft;this.container.setStyles({left:null,right:window.getWidth()-d.left,top:f-b})}}catch(g){ta.util.error.record(g,"positionRight: RelativeOverlayHorizontal")}},positionRight:function(){try{this.source=ta.id(this.source);var d=this.source.getCoordinates();var b=this.container.getStyle("margin-top").toInt();var a=ta.id("PAGE").getCoordinates();var h=this.container.getCoordinates();if(!this.flipped&&a.right-d.right-(this.cachedWidth||h.width)<0){this.flipped=true;this.options.onRight=false;if(this.arrow){this.arrow.className=this.options.arrowClassRight}this.positionLeft();return}if(ta.isDHTMLCRRedesign2012()&&(this.container.getElement(".check_availability")||this.container.getElement(".username"))){this.positionLeftOrRight(d,b,a,h,"right")}else{var f=this.adjustTop(d.top,h);d.right=d.right-this.options.offsetRight;this.container.setStyles({right:null,left:d.right,top:f-b})}}catch(g){ta.util.error.record(g,"positionRight: RelativeOverlayHorizontal")}},positionLeftOrRight:function(p,k,y,w,q){try{var d=this.container.getElement(".check_availability");var f=this.container.getElement(".username");var g=this.adjustTop(p.top,w);var u=d?d:f;var r=u.getCoordinates().height;var l=16;var h=g-r+l/2;var o=d?h:h+5;if(typeof(dhtml_cr_redesign_basic)!="undefined"&&!this.crDHTML_BASIC){this.crDHTML_BASIC=Asset.css(dhtml_cr_redesign_basic)}if(typeof(dhtml_cr_redesign_png24)!="undefined"&&!this.crDHTML_PNG24){this.crDHTML_PNG24=Asset.css(dhtml_cr_redesign_png24)}if(this.crDHTML_BASIC){var b=d?(p.right+13):(p.right-45);if(q=="left"){b=p.left+13}var a=-16}if(this.crDHTML_PNG24){var b=d?(p.right+20):(p.right-45);if(q=="left"){var b=window.getWidth()-p.left+20}var a=d?-21:-24}if(q=="left"){this.container.setStyles({right:b,left:null,top:o})}else{this.container.setStyles({right:null,left:b,top:o})}this.arrow.setStyle("display","block");var j=d?16:0;this.arrow.setStyle("top",r-j);if(q=="left"){this.arrow.setStyle("left",(w.width-13))}else{this.arrow.setStyle("left",a)}try{p=this.source.getCoordinates();w=this.container.getCoordinates();var t=window.getScrollTop()+window.getHeight();var m=p.top-w.top-l/2;var j=d?0:20;if(g+w.height>=t&&m>0){this.arrow.setStyle("top",m+j);if(p.bottom+l/2>=w.bottom){this.container.setStyle("top",o+l*2);this.arrow.setStyle("top",m-l*2+j)}}else{if(m<=0){this.container.setStyle("top",o-r+l)}}}catch(v){ta.util.error.record(v,"bottomEdge - Reposition arrow and container: RelativeOverlayHorizontal")}}catch(v){ta.util.error.record(v,"positionLeftOrRight: RelativeOverlayHorizontal")}}});ta.overlays.RelativeOverlayRight=new Class({Extends:ta.overlays.RelativeOverlayHorizontal,initialize:function(a,b){this.parent(Object.merge({onRight:true},a),b)}});ta.overlays.RelativeOverlayLeft=new Class({Extends:ta.overlays.RelativeOverlayHorizontal,initialize:function(a,b){this.parent(Object.merge({onRight:false},a),b)}});ta.overlays.RelativeOverlayVertical=new Class({Extends:ta.overlays.RelativeOverlay,options:{flipPadding:0},initialize:function(a,b){if(a.below==null){if(IS_DEBUG){alert("ERROR: Attempting to create Vertical Overlay without specifying direction.")}return}this.parent(a,b)},position:function(){if(this.options.below){this.positionBelow()}else{this.positionAbove()}this.parent()},positionBelow:function(){var b=this.source.getCoordinates();var f=this.container.getCoordinates();var e=this.container.getStyle("margin-left").toInt();var a=window.getHeight()+window.getScrollTop();var d=b.bottom;if(this.options.scrollContainer){d-=this.options.scrollContainer.scrollTop}if(!this.flipped&&a-f.height-d<0&&b.top-f.height>0){this.options.below=false;this.flipped=true;d=b.top-f.height-this.options.flipPadding;if(this.options.scrollContainer){d-=this.options.scrollContainer.scrollTop}}this.container.setStyles({left:this.adjustEdge(b.left-e,f.width),top:d})},positionAbove:function(){var b=this.source.getCoordinates();var f=this.container.getCoordinates();var e=this.container.getStyle("margin-left").toInt();var a=window.getScrollTop();var d=b.top-f.height-this.options.flipPadding;if(this.options.scrollContainer){d-=this.options.scrollContainer.scrollTop}if(!this.flipped&&d-a<0){this.options.below=true;this.flipped=true;d=b.bottom;if(this.options.scrollContainer){d-=this.options.scrollContainer.scrollTop}}this.container.setStyles({left:this.adjustEdge(b.left-e,f.width),top:d})},adjustEdge:function(d,c){var a=ta.id("PAGE").getCoordinates();if(d+c>=a.right){var b=this.container.getStyle("margin-right").toInt();d=a.right-c-b-1}return d},hideNow:function(a){this.parent(a);this.flipped=false}});ta.overlays.RelativeOverlayBelow=new Class({Extends:ta.overlays.RelativeOverlayVertical,initialize:function(a,b){this.parent(Object.merge({below:true},a),b)}});ta.overlays.RelativeOverlayAbove=new Class({Extends:ta.overlays.RelativeOverlayVertical,initialize:function(a,b){this.parent(Object.merge({below:false},a),b)}});ta.overlays.RelativeCalloutHorizontal=new Class({Extends:ta.overlays.RelativeOverlayHorizontal,options:{arrowUp:false,arrowDown:false,shadow:true,offset:null},initialize:function(a,b){if(a.onRight==null){if(IS_DEBUG){alert("ERROR: Attempting to create Horizontal Callout without specifying direction.")}return}if($$("body div.overlay").some(function(c){return c!=b})){return}a.style+=" overlayCallout ";this.parent(a,b);if(this.options.arrowDown){this.container.addClass("calloutDown")}else{if(this.options.arrowUp){this.container.addClass("calloutUp")}else{this.container.addClass(this._isRight(this.options)?" calloutRight":" calloutLeft")}}this._setupShadow(this.options,b);this._setupArrow(this.options,b);this._adjustPosition(this.options,b)},adjustTop:function(b,a){return b},show:function(b){this.parent(b);if(this.source&&this.container){this.source.adopt(this.container)}if(Browser.ie6){var a=this.container;$$("select").each(function(c){if(!a.contains(c)){c.setStyle("visibility","hidden")}else{c.setStyle("visibility","visible")}})}this.addEvent("onHide",this._hide)},_hide:function(a){if(Browser.ie6){$$("select").setStyle("visibility","visible")}},_isRight:function(b){var a=this.flipped||false;if(b.onRight===true){return !a}else{return a}},_setupArrow:function(a,b){var c="arrow ";if(this._isRight(a)){if(a.arrowDown){c+="arrowTL"}else{if(a.arrowUp){c+="arrowBL"}else{c+="arrowL"}}}else{if(a.arrowDown){c+="arrowTR"}else{if(a.arrowUp){c+="arrowBR"}else{c+="arrowR"}}}this.arrow=new Element("div",{"class":c}).inject(this.container)},_setupShadow:function(a,b){if(a.shadow===true){this.shadow=new Element("div",{"class":"shadow"}).adopt(this.inner.getChildren()).inject(this.inner)}},_adjustPosition:function(a,b){if(!a.offset.length||a.offset.length<2){a.offset=[0,0]}var c=this.source.getStyles("height","width");this.container.setStyles({left:parseInt((a.onRight?c.width:"0px").replace("px",""))+parseInt(a.offset[0]),top:parseInt(a.offset[1],0)+(a.arrowDown?45:0)})}});(function(){function c(e){if(!e){return null}if(e.get("tag")=="a"){return e.href}var d=e.getElement("a");if(d){return d.href}d=e.getElement(".overlaySrc");if(d){return d.get("text")}return null}var b={left:ta.overlays.RelativeOverlayLeft,right:ta.overlays.RelativeOverlayRight,above:ta.overlays.RelativeOverlayAbove,below:ta.overlays.RelativeOverlayBelow};function a(l,p,g,q){if(p||window.event){new Event(p||window.event).preventDefault()}var o=l.hyphenate().split("-"),j=o.indexOf("h")>=0,f=o.indexOf("lb")>=0,d=o.indexOf("remote")>=0,m=o.indexOf("click")>=0,e=Object.merge({showCloseButton:true},q),k=null,h;switch(o.shift()){case"rel":k=b[o.shift().toLowerCase()];if(f){e.pinnable=ta.overlays.PINNABLE_ALWAYS}break;case"center":k=ta.overlays.CenteredOverlay;break}if(k===null){return null}if(j){e.activate=ta.overlays.ACTIVATE_HOVER}else{if(m){e.activate=ta.overlays.ACTIVATE_CLICK}}if(f){e.backdrop=ta.overlays.BACKDROP_ALWAYS}if(d){e.remoteContent=c(g)}h=new k(e,g);if(g){g.store("overlay",h)}return h}ta.overlays.Factory={_magic:a,relRightRemoteHLB:function(d,f){f=ta.id(f);if(f.get("tag")!="div"){f=f.getParent()}var g=c(f);if(g==null){return}var e=new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_HOVER,pinnable:ta.overlays.PINNABLE_CLICK,backdrop:ta.overlays.BACKDROP_PINNED,style:"commerceOverlay",showCloseButton:true},f)},relRightRemoteHLB_Commerce:function(f,d){if(f||window.event){new Event(f||window.event).preventDefault()}d=ta.id(d);var e=c(d);if(e==null){return}d.onmouseover=null;new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_ALWAYS,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"commerceOverlay",showCloseButton:true},d)},relRightRemoteHLB_CommCopy:function(f,d){if(f||window.event){new Event(f||window.event).preventDefault()}d=ta.id(d);var e=c(d);if(e==null){return}d.onmouseover=null;new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_HOVER,pinnable:ta.overlays.PINNABLE_CLICK,backdrop:ta.overlays.BACKDROP_PINNED,style:"commerceOverlay",showCloseButton:true,onLoad:function(){ta.commerce.checkrates.updateCRForm("_pop")}},d)},relBelowRemoteHLB_Commerce:function(f,d){d=ta.id(d);if(f||window.event){new Event(f||window.event).preventDefault()}var e=c(d);if(e==null){return}d.onclick=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_ALWAYS,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"commerceOverlay",showCloseButton:true},d)},relBelowRemoteHLB_CommCopy:function(f,d){d=ta.id(d);if(f||window.event){new Event(f||window.event).preventDefault()}var e=c(d);if(e==null){return}d.onclick=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_ALWAYS,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"commerceOverlay",showCloseButton:true,onLoad:function(){ta.commerce.checkrates.updateCRForm("_pop")}},d)},relBelowS4Dg:function(e,d){if(e){e.stop()}d.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:true,style:"s4 dg",activate:ta.overlays.ACTIVATE_CLICK},d)},relBelow:function(e,d){if(e){e.stop()}d.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK},d)},relAbove:function(e,d){if(e){e.stop()}d.onclick=null;new ta.overlays.RelativeOverlayAbove({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK},d)},relRight:function(e,d){if(e){e.stop()}d.onclick=null;new ta.overlays.RelativeOverlayRight({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK},d)},relLeft:function(e,d){if(e){e.stop()}d.onclick=null;new ta.overlays.RelativeOverlayLeft({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK},d)},relBelowH_Media:function(e,d){if(e){e.stop()}d.onmouseover=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,style:"typeO mediaBox"},d)},relAboveH_Media:function(e,d){if(e){e.stop()}d.onmouseover=null;new ta.overlays.RelativeOverlayAbove({activate:ta.overlays.ACTIVATE_HOVER,style:"typeO mediaBox"},d)},relAboveH:function(e,d){d.onmouseover=null;new ta.overlays.RelativeOverlayAbove({activate:ta.overlays.ACTIVATE_HOVER},d)},relAboveTAMGFooter:function(f,d){d.onmouseover=null;var e=ta.id("PAGE");if(e){new ta.overlays.RelativeOverlayAbove({activate:ta.overlays.ACTIVATE_HOVER,style:"s3 vdg ovrFooter "+d.className},d)}},relRightH:function(e,d){d.onmouseover=null;new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_HOVER},d)},relLeftH:function(e,d){d.onmouseover=null;new ta.overlays.RelativeOverlayLeft({activate:ta.overlays.ACTIVATE_HOVER},d)},imageLightbox:function(g,d){d.onclick=null;var e="<div><img src="+d.getAttribute("href")+"></div>";var f=new ta.overlays.CenteredOverlay({showCloseButton:true,backdrop:ta.overlays.BACKDROP_ALWAYS}).loadRemoteSuccess(e);d.addEvent("click",f.show)},relRightRemoteHLB_optionalDelay:function(d,j){j=ta.id(j);if(j.get("tag")!="div"){j=j.getParent()}var k=c(j);if(k==null){return}if(typeof(checkRatesCSS)!="undefined"&&!ta.retrieve("ta.checkRatesCSS")){ta.store("ta.checkRatesCSS",Asset.css(checkRatesCSS))}var g=j.className.match(/noDelayFirst/);var h=j.className.match(/delayOpen/);var f=ta.retrieve("delayedFirst");var l=!h||(g&&!f);var e=new ta.overlays.RelativeOverlayRight({activate:(h?ta.overlays.ACTIVATE_HOVER_DELAY:ta.overlays.ACTIVATE_HOVER),pinnable:ta.overlays.PINNABLE_CLICK,backdrop:ta.overlays.BACKDROP_PINNED,style:"commerceOverlay",showCloseButton:true,autoShow:l,delayShow:!l,onLoad:function(){ta.commerce.checkrates.updateCRForm("_pop")},onShow:function(){ta.commerce.checkrates.updateCRForm("_pop");ta.overlays.Factory.checkCRLimitsHelper(e)}},j);ta.store("delayedFirst",true)},relRightRemoteHLB_optionalDelay_showArrow:function(r,g){try{g=ta.id(g);if(g.get("tag")!="div"){g=g.getParent()}var h=c(g);if(h==null){return}var k=g.className.match(/noDelayFirst/);var q=g.className.match(/delayOpen/);var l=ta.retrieve("delayedFirst");var f=!q||(k&&!l);var p="rgba_flyout";var d=true;var m="rgba_arrow";if(ta.has("checkrates.dhtml_cr_redesign_png24_orange")){p+=" orange"}if(typeof(dhtml_cr_redesign_basic)!="undefined"&&!this.crDHTML_BASIC){this.crDHTML_BASIC=Asset.css(dhtml_cr_redesign_basic)}if(typeof(dhtml_cr_redesign_png24)!="undefined"&&!this.crDHTML_PNG24){this.crDHTML_PNG24=Asset.css(dhtml_cr_redesign_png24)}if(this.crDHTML_PNG24){if(ta.has("checkrates.dhtml_cr_redesign_png24_orange")){m=m+" rgba_arrow_png24_orange"}else{cr_arrowClass_right=m+" rgba_arrow_png24_right";m=m+" rgba_arrow_png24"}}var j=new ta.overlays.RelativeOverlayRight({activate:(q?ta.overlays.ACTIVATE_HOVER_DELAY:ta.overlays.ACTIVATE_HOVER),pinnable:ta.overlays.PINNABLE_CLICK,backdrop:ta.overlays.BACKDROP_PINNED,style:p,showArrow:d,arrowClass:m,arrowClassLeft:m,arrowClassRight:cr_arrowClass_right,showCloseButton:true,autoShow:f,delayShow:!f,onLoad:function(){ta.commerce.checkrates.updateCRForm("_pop")},onShow:function(){ta.commerce.checkrates.updateCRForm("_pop");ta.overlays.Factory.checkCRLimitsHelper(j)}},g);ta.store("delayedFirst",true)}catch(o){ta.util.error.record(o,"relRightRemoteHLB_optionalDelay_showArrow: Factory")}},checkCRLimitsHelper:function(f){try{var d=f.container.getElement("#CHECK_RATE_FLYOUT");if(d&&/id_(\d+)/.test(d.className)){ta.commerce.checkrates.checkCRLimits(RegExp.$1)}}catch(g){ta.util.error.record(g,"crLimits check on show overlay")}},fbFriendOverlay:function(d){d.onclick=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,showCloseButton:true,style:"s2 mg"},d)},photosLB:function(d,h){try{if(d||window.event){new Event(d||window.event).preventDefault()}h=ta.id(h);if(h.get("tag")!="a"){if((h.get("tag")=="span"&&h.hasClass("fkASDF"))||(h.get("tag")=="div"&&h.hasClass("fkASDF"))){h=ta.id(h)}else{h=h.getParent("a")}}var g="";if(h.className){g=h.className.match(/u_([^ ]*)/)[1]}else{if(h.href.match(/\/?LocationPhoto.*/)){g=h.href}}ta.overlays.Factory._mediaLBLoadAssets();if(ta.has("photo.viewer.jsAssetsLoaded")){g=g.replace(/\/LocationPhotos\-/,"/LocationPhotosLightbox-");g=g.replace(/\/LocationPhotoDirectLink\-/,"/LocationPhotosLightbox-");g=g.replace(/\#/,"?ff=");if(screen.availHeight<768||screen.availWidth<1024){if(g.match(/\?/)){g=g+"&small=true"}else{g=g+"?small=true"}}var f=ta.overlays.Factory._mediaLBCreateOverlay(ta.overlays.Factory.photoLBHelper,h);f.loadRemoteContent(g);ta.store("photo.viewer.lightbox",f)}else{ta.util.error.record(null,"photo gallery - no assets to load");ta.overlays.Factory.viewerFallback.delay(2000,this,[null,h])}}catch(j){ta.util.error.record(j,"photo gallery overlay",null,{photoUrl:g})}return false},viewerFallback:function(e){var d=ta.remove("photo.viewer.lightbox");if(d){d.hide()}if(e&&e.href&&e.href.match(/LocationPhotos/)){window.location=e.href}else{return ta.servlet.Popup.photoGallery(null,e)}},photoLBCounter:1,photoLBHelper:function(f){var d=ta.retrieve("photo.viewer.initData");if(ta.overlays.Factory.photoLBCounter>16){ta.overlays.Factory.photoLBCounter=1;try{ta.overlays.Factory.viewerFallback.delay(2000,this,f)}catch(g){}return}if(!d||!ta.photos.viewer){ta.overlays.Factory.photoLBCounter++;ta.overlays.Factory.photoLBHelper.delay(500)}else{ta.overlays.Factory.photoLBCounter=1;ta.photos.viewer.photoViewerInit(d)}},mediaLBAutoOpen:function(f){try{ta.overlays.Factory._mediaLBLoadAssets();if(!ta.has("photo.viewer.jsAssetsLoaded")){ta.util.error.record(null,"auto-open media lightbox - no assets to load")}else{f=f.replace(/\/LocationPhotos\-/,"/LocationPhotosLightbox-");f=f.replace(/\/LocationPhotoDirectLink\-/,"/LocationPhotosLightbox-");f=f.replace(/\#/,"?ff=");if(screen.availHeight<768||screen.availWidth<1024){if(f.match(/\?/)){f=f+"&small=true"}else{f=f+"?small=true"}}var d=ta.overlays.Factory._mediaLBCreateOverlay(ta.overlays.Factory.mediaLBAutoOpenHelper,f);d.loadRemoteContent(f);ta.store("photo.viewer.lightbox",d)}}catch(g){ta.util.error.record(g,"ta.overlays.factory.autoOpenMediaLB failed",null,{photoUrl:f})}return false},mediaLBAutoOpenHelper:function(f){var d=ta.retrieve("photo.viewer.initData");var e=16;if(ta.overlays.Factory.photoLBCounter>e){ta.overlays.Factory.photoLBCounter=1;ta.util.error.record(null,"ta.overlays.factory.autoOpenMediaLBHelper is giving up after "+e+" attempts.",null,{photoUrl:f});return}if(!d||!ta.photos.viewer){ta.overlays.Factory.photoLBCounter++;ta.overlays.Factory.mediaLBAutoOpenHelper.delay(500,this,f)}else{ta.overlays.Factory.photoLBCounter=1;ta.photos.viewer.photoViewerInit(d)}},_mediaLBLoadAssets:function(){if(!ta.has("photo.viewer.jsAssetsLoaded")&&typeof cssPhotoViewerAsset!="undefined"&&typeof jsPhotoViewerAsset!="undefined"){ta.store("photo.viewer.jsAssetsLoaded",true);Asset.css(cssPhotoViewerAsset,{media:"screen, print"});if(!ta.photos.viewer){Asset.javascript(jsPhotoViewerAsset)}if(typeof TALSO=="undefined"){Asset.javascript(jsPhotoViewerTALSOAsset)}if(typeof jsPhotosAsset!="undefined"&&!ta.servlet.Photos){Asset.javascript(jsPhotosAsset)}if(!ta.media.jwplayerHelper){Asset.javascript(jsJWPlayerHelperAsset)}}},_mediaLBCreateOverlay:function(e,f){var d=new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,style:"s3 dg",backdropClickClose:true,onLoad:function(){this.position();if(ta.commerce&&ta.commerce.checkrates){ta.commerce.checkrates.updateCRForm("_pto");ta.commerce.checkrates.removePCR()}e(f)},onHide:function(){var g=ta.remove("photo.viewer.lightbox");if(g){g.hide()}ta.run("ta.commerce.checkrates.restoreCRPageServlet");document.removeEvent("keydown",ta.remove("photo.viewer.keydownListener"));if(ta.retrieve("photo.viewer.refreshOnClose")){window.location=window.location}if(ta.has("translationOverlay")){ta.retrieve("translationOverlay").hide()}},permanent:true});return d},AccDetail:function(m,e,j,d){if(m){m.stop()}e=e.getParent();var h="http://"+document.domain;var l=location.pathname;if(l.length>0){if(l.charAt(0)=="/"){l=l.substring(1)}var k=l.indexOf("-");if(k>=0){l=l.substring(0,k)}}var g=j;var f=function(o){var p=ta.id("overlay_description").get("text");if(p.length>1000){ta.id("overlay_description").setStyle("height",210)}};new Asset.css(memoverlayCSS);new ta.overlays.CoverOverlay({yOff:35,onLoad:f,style:"s3 dg rgba_gry",activate:ta.overlays.ACTIVATE_HOVER_DELAY,pinnable:ta.overlays.PINNABLE_CLICK,showCloseButton:true,delayShow:true,requestData:{d:g,tab:"descript",from:l},remoteContent:h+"/LocationTab"},e);return false},memberOverlay:function(s,g,q){if(s){s.stop()}g.onmouseover=null;var p="";var d="";var l="";var m=false;var f=false;var e=true;var o="rgba_arrow_png24";if(g.id&&g.id!=""){var j=g.id.split("-");for(var k=0;k<j.length;k++){var h=j[k];if(h.match(/\bUID_([0-9A-F]+)\b/)){p=RegExp.$1}else{if(h.match(/\bSRC_(\d+)\b/)){d=RegExp.$1}else{if(h.match(/\bCATID_(\d+)\b/)){l=RegExp.$1}else{if(h.match("FUS")){m=true}else{if(h.match("PATT")){f=true}}}}}}}else{ta.util.error.record(err,"memberOverlay - elmt.id check",null,{passedElement:ta.util.error.getSelectorString(g)})}var r="";if(typeof(footprintGet)!="undefined"){r=footprintGet()}new Asset.css(memoverlayCSS);new ta.overlays.RelativeOverlayRight({style:q||"typeO",activate:ta.overlays.ACTIVATE_HOVER_DELAY,pinnable:ta.overlays.PINNABLE_CLICK,showArrow:e,arrowClass:o,showCloseButton:true,autoShow:false,delayShow:true,remoteContent:"/MemberOverlay?uid="+p+"&c="+l+"&src="+d+"&fus="+m+"&partner="+f+"&LsoId="+r},g);return false},createPairedCalendar:function(f,e,d){if(!d){d={validate:true}}if(f){new Event(f).preventDefault()}return new ta.overlays.PairedCalendar(e,d)},createPairedCalendarGeo:function(f,e,d){if(f){new Event(f).preventDefault()}new ta.overlays.PairedCalendar(e,{validate:true,onUpdate:ta.commerce.checkrates.showProviders.bind(ta.commerce.checkrates)});ta.commerce.checkrates.geoId=d},_injectAd:function(d){var f=ta.id(d);try{if(f){injectAdsTargeted(f)}}catch(g){ta.util.error.record(g,"AlsoViewedLB: error injecting ad into elemId="+d)}},createDatedPairedCalendar:function(f,d){if(f){new Event(f).preventDefault()}d=ta.id(d);var e=d.getParent("form");new ta.overlays.PairedCalendar(d,{validate:true,overlayOptions:{onShow:function(){ta.overlays.toggleOffSearchAll(e)}}});ta.overlays.toggleOffSearchAll(e)},recordVRCrossSell:function(){try{var f=ta.id("VR_CROSS_SELL");if(f){var d=f.innerHTML.indexOf("setPID");var h=f.innerHTML.substr(d+7,5);new Request({url:"/ActionRecord?action=VR_CROSS_SELL_"+h}).send()}}catch(g){ta.util.error.record(g,"VR Cross Sell - ActionRecord failed")}},launchAVLBCompleteFn:function(e){ta.overlays.Factory._loadAVCSS();var d=function(){ta.overlays.Factory._injectAd("ALSO_VIEWED_AD")};var f=function(j){var g="alsoViewedTest avStandalone";if(ta.has("ta.av_cr_leavebehind")){g="av_cr_leavebehind"}if(ta.has("checkrates.p13n_test22_six_recos")){g=g+" v6_green"}else{if(ta.has("ta.avlb_hero_photos")){g="avlb_hero_photos";if(ta.has("checkrates.hero_photos_r2xc3")){g=g+" r2xc3"}}}var h;if(ta.has("checkrates.left_overlay")){h=new ta.overlays.AbsoluteOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,style:g,onShow:d.delay(100),onLoad:ta.overlays.Factory.recordVRCrossSell},null).loadRemoteSuccess(j)}else{h=new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,style:g,onShow:d.delay(100),onLoad:ta.overlays.Factory.recordVRCrossSell}).loadRemoteSuccess(j)}var l=false;if(h.inner){var k=ta.id("emptyAlsoViewed");if(k){l=true}else{ta.store("alsoViewedLB",true)}}else{l=true}if(l){h.hide();ta.store("commerce.pwrOverlay",h)}ta.commerce.checkrates.removePCR();ta.commerce.checkrates.loadPackages(true)};new Request({url:e,onSuccess:f,evalScripts:true}).send()},_loadAVCSS:function(){if(typeof(avlbCss)!="undefined"&&!ta.retrieve("ta.avlbCss")){ta.store("ta.avlbCss",Asset.css(avlbCss))}if(typeof(avlbTestCss)!="undefined"&&!ta.retrieve("ta.avlbTestCss")){ta.store("ta.avlbTestCss",Asset.css(avlbTestCss))}if(typeof(VRCrossSellCss)!="undefined"&&!ta.retrieve("ta.VRCrossSellCss")){ta.store("ta.VRCrossSellCss",Asset.css(VRCrossSellCss))}if(typeof(av_cr_leavebehind)!="undefined"&&!ta.retrieve("ta.av_cr_leavebehind")){ta.store("ta.av_cr_leavebehind",Asset.css(av_cr_leavebehind))}if(typeof(avlb_hero_photos)!="undefined"&&!ta.retrieve("ta.avlb_hero_photos")){ta.store("ta.avlb_hero_photos",Asset.css(avlb_hero_photos))}},_loadChkMoreCSS:function(){ta.overlays.Factory._loadAVCSS();if(typeof(chkMoreCss)!="undefined"&&!ta.retrieve("ta.chkMoreCss")){ta.store("ta.chkMoreCss",Asset.css(chkMoreCss))}if(typeof(chkMoreSpritesCss)!="undefined"&&!ta.retrieve("ta.chkMoreSpriteCss")){ta.store("ta.chkMoreSpriteCss",Asset.css(chkMoreSpritesCss))}},loadCheckMoreOverlay:function(f,d){var o=(f.getVendorSet().getCheckedInfo("count")<7);if(ta.has("checkrates.p13n_test22_six_recos")){o=false}var q="";var k=0;var g=0;var m=ta.has("checkrates.check_more_re");var j=ta.has("checkrates.check_more_hero_photos");var p=ta.has("checkrates.doNotAnimateCheckMore");var e=ta.has("checkrates.check_more_re_center_large_hero_photos");var l=ta.has("checkrates.check_more_center_v6");var r=ta.has("checkrates.hero_photos_r2xc3");if(!e&&!r){q="alsoViewedTest check_more_sites"}if(m||j){if(!l){q+=" avlb_hero_photos"}k=5;g=5;if(l){q+=" check_more_center_v6"}else{if(m){q+=" check_more_re"}else{if(j){q+=" check_more_hero_photos"}}}if(r){q+=" r2xc3"}}if(ta.has("checkrates.center_overlay")){var h=new ta.overlays.CenteredOverlay({style:q,backdrop:ta.overlays.BACKDROP_ALWAYS,onLoad:function(){ta.commerce.checkrates.removePCR();if(m||j||p){try{ta.commerce.checkrates.loadPackages(false)}catch(s){ta.util.error.record(s,"hotel packages - loadPackages")}}},onHide:ta.commerce.checkrates.restoreCRPageServlet},f.trigger)}else{var h=new ta.overlays.AbsoluteOverlay({style:q,backdrop:ta.overlays.BACKDROP_ALWAYS,repositionOnScroll:o,xOffset:k,yOffset:g,onLoad:function(){ta.commerce.checkrates.removePCR();if(m||j||p){try{ta.commerce.checkrates.loadPackages(false)}catch(s){ta.util.error.record(s,"hotel packages - loadPackages")}}},onHide:ta.commerce.checkrates.restoreCRPageServlet},f.trigger)}ta.overlays.Factory._loadChkMoreCSS();if(f.type=="checkdeals"){h.loadRemoteSuccess=function(s){this.inner.set("html",s);ta.commerce.smartdeals.popBlockerOverlay(h,f);this.position()}}if(f.isCheckMore){h.addEvent("onClose",ta.commerce.checkrates.recordClose.bind(ta.commerce.checkrates));if(!p&&!m&&!j){h.addEvent("load",ta.commerce.checkrates.showRemainingCheckMore.bind(ta.commerce.checkrates))}}h.loadRemoteContent(d,false)},loadCheckRatesLBOverlay:function(h,e,g){try{var d=new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,style:"s3 dg cr_lb_overlay",requestData:{d:g.detail,s:crPageServlet,a:g.area},remoteContent:"http://"+document.domain+"/CheckRatesLB",showCloseButton:true,closeLink:'<div class="close_text">'+overlayCloseTxt+"</div>",onLoad:function(){ta.commerce.checkrates.removePCR;ta.commerce.checkrates.updateCRForm("_cro")},onHide:ta.commerce.checkrates.restoreCRPageServlet},e);if(typeof(checkRatesLBCss)!="undefined"&&!ta.retrieve("ta.checkRatesLBCss")){ta.store("ta.checkRatesLBCss",Asset.css(checkRatesLBCss))}}catch(f){ta.util.error.record(f,"check rates leave behind")}},loadPCROverlay:function(){try{var f=ta.id("CHECK_RATE");var l=ta.id("PERSISTENT_CHECK_RATES_CONTENT");var d=window.getScroll();if(!l){return}var j=l.hasClass("closeTest");if(!f||!d){l.dispose();return}ta.store("pcr.scrollPoint",f.getPosition().y);if(!d){return}ta.store("pcr.initialYPos",window.getScroll().y);var k=l.get("html");l.dispose();var h="persistentCR";var g=new ta.overlays.AbsoluteOverlay({toWindow:false,autoShow:false,positionType:"fixed",permanent:true,zIndex:"9996",style:h,content:k,closeButtonClass:"sprite-greenX",closeLink:"<div>"+ta.commerce.checkrates.pcrCloseTxt+"</div>",onClose:function(){try{ta.store("pcr.keepHidden",true);Cookie.writeSession("CPCR",1);new Request({url:"/ActionRecord?action=persistent_cr_close"}).send()}catch(o){ta.util.error.record(o,"pcr - onClose")}}});ta.store("pcr.overlay",g);window.removeEvent("scroll",ta.overlays.Factory.loadPCROverlay);window.addEvent("scroll",ta.commerce.checkrates.positionCheckRates)}catch(m){window.removeEvent("scroll",ta.overlays.Factory.loadPCROverlay);ta.util.error.record(m,"pcr - scroll init");return false}},tamgShowLightbox:function(f,e,g){var d="tripadvisor.com";if(typeof cookieDomain!="undefined"){d=cookieDomain.substring(1,cookieDomain.length)}new Asset.css(g);new Request({url:"/TAMGFooterAjax",onSuccess:function(h){ta.overlays.showInLightbox(h,{style:"s0 TAMG_All"})},data:{a:"SHOW_GROUP_OVERLAY",dom:d},evalScripts:true,method:"get"}).send()},intlPopup:function(g,e){if(g){g.stop()}e.onclick=null;if(flagsUrl==null||flagsUrl==""){flagsUrl=document.location.pathname}var f="/StaticVelocityPage?t=intSitesFly.vm&lt=evt&footerFlagFormat="+footerFlagFormat+"&flagsURL="+encodeURIComponent(flagsUrl);if(document.location.search!=""){f+=encodeURIComponent(document.location.search)}if(document.location.hash!=""){f+=encodeURIComponent(document.location.hash)}if(window.modelGeoId){f+="&geo="+modelGeoId}if(window.flagsSettings){for(var d=0;d<flagsSettings.length;d++){f+="&"+flagsSettings[d]+"=true"}}if(window.pageFeature){f+="&pageFeature="+pageFeature}new Asset.css(flagsFlyoutCSS);new ta.overlays.RelativeOverlayBelow({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK,remoteContent:f},e);return false},showRecentLocationEmailOverlay:function(){setPID(3833);if(typeof(recentViewedCSS)!="undefined"&&!ta.retrieve("ta.recentViewedCssAsset")){ta.store("ta.recentViewedCssAsset",Asset.css(recentViewedCSS))}new Request({url:"/RecentlyViewedAjax",onSuccess:function(d){if(!d.match("emptyRecentlyViewed")){ta.overlays.showInLightbox(d,{style:"dg s4 RecentlyViewedOverlay"})}},data:{a:"share_overlay"},evalScripts:true,method:"get"}).send()},expandRecentlyViewed:function(f,e){for(var d=4;d<7;d++){var h=ta.id("recently_viewed_"+d);if(h&&h.hasClass("hidden")){h.removeClass("hidden")}}var g=ta.id("RECENTLY_VIEWED_MORE");if(g){g.addClass("hidden")}},showRecentlyViewedCompareOverLay:function(){ta.util.cookie.setPIDCookie(4898);var e=window.location.protocol+"//"+window.location.hostname+"/CompareHotels?detail=";var d=0;for(d=0;d<7;d++){var f=ta.id("recently_viewed_"+d);if(f){e=e+f.get("locid");d+=1;break}}for(;d<7;d++){var f=ta.id("recently_viewed_"+d);if(f){e=e+"&compareHotelId="+f.get("locid")}}if(typeof(compareHotelCSS)!="undefined"&&!ta.retrieve("ta.compareHotelCssAsset")){ta.store("ta.compareHotelCssAsset",Asset.css(compareHotelCSS))}new Request({url:e,onSuccess:function(g){new ta.overlays.CenteredOverlay({activate:ta.overlays.ACTIVATE_CLICK,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"compareHotel",content:g})}}).send()},clearRecentLocations:function(){var e=ta.id("RECENTLY_VIEWED_LIST");if(e){var d=e.getNext(".bxDivider");e.dispose();if(d){d.dispose()}}new Request({url:"/RecentlyViewedAjax?a=clear"}).send()},removeParticularLocation:function(d,e,p){var g=ta.id("recently_viewed_"+p);if(g){var o=g.get("locid");g.dispose();new Request({url:"/RecentlyViewedAjax?a=remove&locID="+o}).send();for(;p<7;++p){g=ta.id("recently_viewed_"+p);if(g&&g.hasClass("hidden")){g.removeClass("hidden");break}}for(;p<7;++p){g=ta.id("recently_viewed_"+p);if(g&&g.hasClass("hidden")){return}}var h=ta.id("RECENTLY_VIEWED_MORE");if(h&&!h.hasClass("hidden")){h.addClass("hidden")}var m=$$("li.rv_item");var l=0;var f=false;if(m){l=m.length;for(var j=0;j<l;j++){if(!m[j].hasClass("geoItem")){f=true}}}if(!f){var k=ta.id("RV_SAVE");if(k){k.dispose()}}if(l===0){var g=ta.id("RECENTLY_VIEWED_LIST");if(g){g.dispose()}}else{if(l===1){var g=ta.id("COMPARE_HOTELS");if(g){g.getParent().addClass("hidden")}}}}},showSendMessage:function(r,e){if(r){r.stop()}if(ta.has("overlays.sendmessage.loading")){return}else{ta.store("overlays.sendmessage.loading",true);ta.remove.delay(500,null,"overlays.sendmessage.loading")}if(typeof(privateMsgCSS)!="undefined"&&!ta.retrieve("ta.privateMsgCssAsset")){ta.store("ta.privateMsgCssAsset",Asset.css(privateMsgCSS))}var h=ta.retrieve("overlays.sendmessage");var f="";if(e.get("tag")=="span"&&e.hasClass("fkASDF")){f=e.className.match(/u_([^ ]*)/)[1]}else{f=e.href}if(h&&f.match(/notyou=1/)){window.location="/NewsletterSignOut-e__2F__MemberSignIn"}else{if(h){return}}var p=e.className.match(/\b(callback_ShowRecaptcha)\b/);var k;if(p){new Asset.javascript("http://api.recaptcha.net/js/recaptcha_ajax.js");k="callback_ShowRecaptcha"}var d=e.className.match(/\bpm(\d)([A-F0-9]+)\b/);if(!d){return}var m=parseInt(d[1])==1?"cc":"cm";if(!userLoggedIn||migrationMember){var l=m=="cm"?"m2m_singin_greeting_d99":"";var o=d[2];ta.store("community.needsReload",true);window.loginSuccess=function(){if(!reg_overhaul){hideIFrame()}ta.common.sendmessage.communityLightbox(f,k)};if(reg_overhaul){var j=m=="cm"?"PRIVATE_MESSAGE":"COMPLIMENT_USER";ta.overlays.registration.connect({flow:j})}else{var g=!userLoggedIn?login:migrate;g(["tt",m,"greeting",l,"returnTo",getRelativeURL()])}return}var q=m=="cm"&&typeof(footprintGet)!="undefined"?footprintGet():null;if(q){f+="&LsoId="+q}ta.common.sendmessage.communityLightbox(f,k)},showConnectOverlay:function(f,d,e,h,g){ta.overlays.registration.connect(e,h,g)},showLoginOverlay:function(f,e,g,h,d){if(typeof(regflowCss)!="undefined"&&!ta.retrieve("ta.regflowCssAsset")){ta.store("ta.regflowCssAsset",Asset.css(regflowCss))}ta.overlays.registration.request(g,h,d)},showRoomTipsOverlay:function(h,g,l){try{ta.util.cookie.setPIDCookie(4840);var f="http://"+window.location.hostname+"/AccommodationTips?d="+modelLocId;if(l){f=f+"&filterLang="+l}var j=false;var d=new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_NEVER,style:"s3 dg nopadding",permanent:true,zIndex:"9997",showCloseButton:true,remoteContent:f,onLoad:function(){if(d.inner){var e=ta.id("emptyTips");if(e){j=true}}else{j=true}if(j){d.hide()}}},g)}catch(k){ta.util.error.record(k,"showRoomTipsOverlay")}},_loadSummaryCss:function(){if(typeof(conceptsCss)!="undefined"&&!ta.retrieve("ta.conceptsCssAsset")){ta.store("ta.conceptsCssAsset",Asset.css(conceptsCss))}},showReviewSummary:function(m,h,g,d){if(g&&d){ta.overlays.Factory.showSummaryTranslation(m,h,g);return}var j=null;var k=null;var e=null;var l=0;var f=0;if(m){m.stop()}if(h.id&&h.id!=""){j=h.id.replace("concept_","").replace(/_/g," ");ta.store("topconcepts.lastconcept",j);e="/HotelSummary?d="+modelLocId+"&geo="+modelGeoId+"&concept="+j;if(g){e+="&autotrans=true"}}else{ta.util.error.record(null,"showReviewSummary - elmt.id check");return}ta.overlays.Factory._loadSummaryCss();k=new ta.overlays.CenteredOverlay({style:"s3 dg nopadding",autoShow:false,permanent:true,showCloseButton:true,remoteContent:e,onLoad:function(o){ta.store("topconcepts.overlay."+j,this);this.show()}},h);h.onclick=k.show;return false},showSummaryTranslation:function(l,g,k){ta.util.cookie.setPIDCookie(16007);if(l){l.stop()}var e="s3 dg nopadding";ta.overlays.Factory._loadSummaryCss();var j="/MachineTranslation?";if(g.id&&g.id!=""){var h;if(g.id.indexOf("trans_")!=-1){h=g.id.replace("trans_","").replace(/_/g," ")}else{h=g.id.replace("concept_","").replace(/_/g," ")}ta.store("topconcepts.lastconcept",h);j+="page=summary&";j+="d="+modelLocId+"&";j+="concept="+h;j+="&sl=en&tl="+k}var d="topconcepts.overlay."+h;var f=ta.retrieve(d);if(f){f.hide()}f=new ta.overlays.CenteredOverlay({style:e,showCloseButton:true,remoteContent:j,onLoad:function(m){ta.store(d,this);this.show()}},g)},toggleConceptSnippetTranslation:function(l,f){var k=null;var h=null;var j=null;var g=null;var d=null;if(l){l.stop()}if(f){ta.util.cookie.setPIDCookie(4111);j=f.id.replace(/[^_]*_(.*)/,"$1");k=ta.id("SUMMARYOVERLAY_"+j);if(k){h=k.getElements(".snippetText");for(var e=0;e<h.length;e++){if(h[e].isDisplayed()){h[e].hide()}else{h[e].show("inline")}}}g=ta.id("trans_"+j);d=ta.id("en_"+j);if(g.hasClass("activeButton")){g.removeClass("activeButton");g.addClass("inactiveButton")}else{g.removeClass("inactiveButton");g.addClass("activeButton")}if(d.hasClass("activeButton")){d.removeClass("activeButton");d.addClass("inactiveButton")}else{d.removeClass("inactiveButton");d.addClass("activeButton")}if(ta.overlays.Factory.storeReviewSummaryContent){ta.overlays.Factory.storeReviewSummaryContent(j.replace(/_/g," "),k.getParent().get("html"))}}},reviewTranslate:function(j,g,e){ta.util.cookie.setPIDCookie(16009);ta.overlays.Factory._loadSummaryCss();var f=ta.has("photo.viewer.lightbox");var h=1001;if(f){h=10001}var d=new ta.overlays.CenteredOverlay({style:"s4 dg",zIndex:h,showCloseButton:true,remoteContent:e,onLoad:function(k){this.show()}});ta.store("translationOverlay",d)},showRefreshedRecentLocationSaveOverlay:function(){setPID(3832);if(typeof(recentViewedCSS)!="undefined"&&!ta.retrieve("ta.recentViewedCssAsset")){ta.store("ta.recentViewedCssAsset",Asset.css(recentViewedCSS))}var e="";for(var d=1;d<7;d++){var f=ta.id("recently_viewed_"+d);if(f){if(e==""){e+=f.get("locid")}else{e+="-"+f.get("locid")}}}new Request({url:"/RecentlyViewedAjax",onSuccess:function(g){if(!g.match("emptyRecentlyViewed")){ta.overlays.showInLightbox(g,{style:"dg s4 RecentlyViewedOverlay"})}},data:{a:"subset_save_overlay",locNums:e},evalScripts:true,method:"get"}).send()},showRecentLocationSaveOverlay:function(){setPID(3832);if(typeof(recentViewedCSS)!="undefined"&&!ta.retrieve("ta.recentViewedCssAsset")){ta.store("ta.recentViewedCssAsset",Asset.css(recentViewedCSS))}new Request({url:"/RecentlyViewedAjax",onSuccess:function(d){if(!d.match("emptyRecentlyViewed")){ta.overlays.showInLightbox(d,{style:"dg s4 RecentlyViewedOverlay"})}},data:{a:"save_overlay"},evalScripts:true,method:"get"}).send()},createIPPinOverlay:function(e,f){var d;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,style:"s2 mg",onShow:function(){if(typeof(friendStripMouseoverPageAction)=="undefined"||!friendStripMouseoverPageAction){return}d=setTimeout(function(){new Request({url:"/ActionRecord?action="+friendStripMouseoverPageAction}).send();friendStripMouseoverPageAction=null},400)},onHide:function(){clearTimeout(d)},content:f},e)},createFriendActivityOverlay:function(e,f,g){var d;return new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,style:"s2 mg",onShow:function(){g&&ta.util.pending.lock("friendActivityOverlay.pageAction",function(){d=setTimeout(function(){new Request({url:"/ActionRecord?action="+g}).send()},400)})},onHide:function(){clearTimeout(d)},content:f},e)},createFriendActivityLightbox:function(d){return new ta.overlays.CenteredOverlay({activate:ta.overlays.ACTIVATE_CLICK,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"s4 mg friendActivity",content:d})},createCouponAnnouncementOverlayRedirect:function(k,h,j,g,d,f,e){ta.overlays.Factory.createCouponAnnouncementOverlay(null,null,k,h,j,g,d,f,e)},createCouponAnnouncementOverlay:function(e,g,h,m,f,o,l,k,j){ta.util.cookie.setPIDCookie(k);Asset.css(l);var d=new Object();d.act=h;if(j!=null){d.act+="-"+j}else{if(window.pageServlet!=null){d.act+="-"+pageServlet}}new Request({url:"/CouponAjax?"+(m?"couponId="+m+"&":"")+(f?"announcementId="+f+"&":"")+"locationId="+o+"&listing=true",data:d,onSuccess:function(q){var p=ta.overlays.showInLightbox(q,{style:"typeB4 og",delayedPosition:true});p.closeBtn.addEvent("click",ta.servlet.blcoupons.closeHandler)},evalScripts:true}).send()},postVideoLogin:function(e,d,f){if(f){ta.util.cookie.setPIDCookie(f)}ta.overlays.registration.connect({flow:"POST_VIDEO"},"SIGNIN")},fbLogin:function(e,d){ta.support.Facebook.login()},createAmenitiesLightbox:function(e){var j=location.pathname;if(j.length>0){if(j.charAt(0)=="/"){j=j.substring(1)}var h=j.indexOf("-");if(h>=0){j=j.substring(0,h)}}var d=e.id;if(d.indexOf("amenity_")==0){locationId=d.substring(8)}var f="http://"+document.domain;var g=false;if(ta.remove("amenities.suppressLinks")){g=true}new ta.overlays.RelativeOverlayBelow({autoShow:true,style:"s3 dg",showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK,requestData:{d:locationId,tab:"amenities",from:j,suppressLinks:g},remoteContent:f+"/LocationTab"},e)},createAmenitiesLightboxFull:function(j,g,d){if(j){j.stop()}if(typeof(amenityLightboxCss)!="undefined"&&!ta.retrieve("ta.amenityLightboxCss")){ta.store("ta.amenityLightboxCss",Asset.css(amenityLightboxCss))}if(d&&d>0){setPID(d)}var f=g.id;if(f.indexOf("amenity_")==0){locationId=f.substring(8)}var h="http://"+document.domain;var e=new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,style:"s3 dg",onLoad:function(){this.position();ta.commerce.checkrates.updateCRForm("_amo");injectAdsTargeted(document.getElement("#AMENITY_LIGHTBOX"));this.position()},showCloseButton:true,permanent:true,requestData:{d:locationId,tab:"amenities_lightbox",from:pageServlet},remoteContent:h+"/LocationTab"},g);e.show();g.onclick=function(){e.show();ta.commerce.checkrates.updateCRForm("_amo")};return false},openSavesRegflow:function(){ta.widgets.Saves.openSavesRegflow()},openSavesHoverRegflow:function(){ta.widgets.Saves.openSavesHoverRegflow()},openMastheadRegflow:function(){ta.widgets.Saves.openMastheadRegflow()},createGuideOverlay:function(){ta.overlays.registration.connect({flow:"DESTINATION_GUIDE"},"SIGNUP")},createPostPhotosOverlay:function(){ta.overlays.registration.connect({flow:"POST_PHOTOS"},"SIGNUP")},relBelowOverlaySolidGreenBorder:function(e,d){d.onmouseover=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,style:"s3 dg"},d)},createDropDown:function(h,e,g){e=ta.id(e);e.onmouseover=null;try{var d=new ta.overlays.RelativeOverlayBelow({content:g,style:"dropMenu",fontSize:"12px",zIndex:202,activate:ta.overlays.ACTIVATE_HOVER,pinnable:ta.overlays.PINNABLE_CLICK,onShow:function(j){e.addClass("tabLinkShown");e.addClass("arwLinkShown");e.getParent().addClass("tabItemShown");e.getElement("img").addClass("sprite-arrow_dropdown_wht_show")},onHide:function(j){e.removeClass("tabLinkShown");e.removeClass("arwLinkShown");e.getParent().removeClass("tabItemShown");e.getElement("img").removeClass("sprite-arrow_dropdown_wht_show");var k=g.getElements(".text");Array.each(k,function(l){var m=l.retrieve("typeAhead");if(m){m.hideChoices()}})}},e)}catch(f){return}d.pinAndSetUnpin=function(j){d.pin();document.addEvent("click",d.unpinAndSetPin)};d.unpinAndSetPin=function(j){j=new Event(j);if(!d.container.containsEvent(j)&&!j.target.hasClass("dropSelect")){d.hide();d.unpin();document.removeEvent("click",d.unpinAndSetPin);d.container.addEvent("click",d.pinAndSetUnpin)}};d.container.addEvent("click",function(j){d.pinAndSetUnpin(j)})},popConditionsOverlay:function(){var d=ta.id("CONDITIONS");if(d){ta.overlays.showInLightbox(d.innerHTML)}},showCompareOverLay:function(d,h,e){var j=window.location.protocol+"//"+window.location.hostname;var g=j+"/CompareHotels?detail="+e;for(var f=0;f<3;f++){var k=ta.id("compare_hotels_"+f);if(k&&k.checked==true){g=g+"&compareHotelId="+k.value}}new Asset.css(compareHotelCSS);new Request({url:g,onSuccess:function(l){new ta.overlays.CenteredOverlay({activate:ta.overlays.ACTIVATE_CLICK,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"compareHotel",content:l})}}).send()},createNeighborhoodOverlay:function(j,g,d){if(ta.has("nbhdOverlay")){if(g){g.onclick=null}ta.retrieve("nbhdOverlay").show();return}var e=new ta.overlays.RelativeOverlayBelow({showCloseButton:true,permanent:true,zIndex:"997",style:"nbhdOverlay typeO",activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_ALWAYS,onShow:function(){if(d){ta.servlet.HACSearch.filter.update()}},onHide:function(){if(d){ta.servlet.HACSearch.filter.update()}}},"NEIGHBORHOOD_OVERLAY");var f=e.inner;var h=ta.id("NEIGHBORHOOD_FORM");if(f&&h){h.inject(f,"top");h.removeClass("hidden");ta.store("neighborhoodOverlayForm",h)}ta.store("nbhdOverlay",e)},createHACProgressOverlay:function(){try{if(ta.has("ta.hac.progress.overlay")){return ta.retrieve("ta.hac.progress.overlay")}var h=ta.id("HAC_PROGRESS_CONTAINER").dispose();var d=h.get("html");var g=new ta.overlays.CenteredOverlay({style:"s3 dg rgba_gry",showCloseButton:false,content:d});ta.store("ta.hac.progress.overlay",g);return g}catch(f){ta.util.error.record(f,"createHACProgressOverlay")}},getFilterWaitOverlay:function(){var e=ta.retrieve("filters.waitDialog");if(!e){var d="mg s1 fatNotice";if(ta.isHotelsRedesign2011()){d=d+" fatNotice_2011"}e=new ta.overlays.CenteredOverlay({style:d,showCloseButton:false,autoShow:false,delayedPosition:true});e.inner.set("html","<b>"+JS_UpdatingYourResults+"</b>");ta.store("filters.waitDialog",e)}return e},showFilterWaitOverlay:function(e){var d=ta.overlays.Factory.getFilterWaitOverlay();if(d){if(e){d.show();d.position(false)}else{d.hide()}}},showUpdatingMessage:function(){var e=ta.overlays.Factory.getFilterWaitOverlay();e.show();if(ta.remove("filter.map")){e.container.setStyles({left:-9999,top:-9999});var f=ta.id(ta.retrieve("maps.container")).getCoordinates();var d=e.container.getCoordinates();e.container.setStyles({left:f.left+(f.width-d.width)/2,top:f.top+(f.height-d.height)/2})}if(ta.remove("filter.lockout")){e.enableBackdrop()}hideBCPromo()},createPhotoUploaderOverlay:function(d){var e=new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,autoShow:false,style:"s2 dg",innerDivClass:"noPadMarg",attachCloseEvent:true,permanent:true,onLoad:ta.media.uploader.onLoadOverlayHandler,onClose:function(){if(ta.has("tipsOverlay")&&ta.retrieve("tipsOverlay").hide){ta.retrieve("tipsOverlay").hide();ta.remove("tipsOverlay")}}});e.loadRemoteContent(d,true);ta.store("ta.media.uploader.photoUploaderOverlay",e)},createIpDeauthOverlay:function(e,d){new Request({url:"/ActionRecordPlus?action=DEAUTH_IP&id="+e,onSuccess:function(f){new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,showCloseButton:false}).loadRemoteSuccess(f);if(d){ta.support.Facebook.ipRevoke(10000)}},onFailure:ta.util.error.ajaxFailure.partial("partials:ip_disable")}).send()},kinderOverlay:function(j,g){try{g.onclick=null;var h={style:"s4 dg kinder",showCloseButton:true,isChild:true,activate:ta.overlays.ACTIVATE_CLICK};var d=document.getElement(".overlay");if(d){h.onShow=function(){var e=d.overlay;if(!e.pinned){e.unpinOnHide=true;e.pin()}},h.onHide=function(){var e=d.overlay;if(e.unpinOnHide){e.unpinOnHide=false;e.unpin()}}}var f=new ta.overlays.RelativeOverlayBelow(h,g)}catch(k){ta.util.error.record(k,"Error: kinderOverlay")}},loadBLSlideshowOverlay:function(g,f,e,d){new Request({url:"/BusinessListingsAjax",onSuccess:function(h){ta.overlays.showInLightbox(h,{backdrop:ta.overlays.BACKDROP_ALWAYS,style:"g s10px np"})},data:{act:"slideshow",detail:e,pid:d,flash:(Browser.Plugins.Flash.version>=10)},evalScripts:true,method:"get"}).send()},accountMenuFlyout:function(h,d){d.onmouseover=null;try{var g=new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,style:"dropMenu accountMenuFlyout",onShow:function(){this.container.setStyle("margin-left","19px")},onHide:function(){this.container.setStyle("margin-left","0")}},d);ta.store("accountMenuFlyout",g)}catch(f){ta.util.error.record(f,"Error: ta.overlays.Factory.accountMenuFlyout")}},ratingMenuFlyout:function(h,d){d.onmouseover=null;try{var g=new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,style:"dropMenu ja_ratingMenuFlyout"},d);ta.store("ratingMenuFlyout",g)}catch(f){ta.util.error.record(f,"Error: ta.overlays.Factory.ratingMenuFlyout")}},bizListingsMenuFlyout:function(j,d){d.onmouseover=null;try{var g=d.getNext("div"),f=ta.retrieve("accountMenuFlyout");if(g){g=g.get("html")}new ta.overlays.RelativeOverlayRight({content:g,zIndex:2000,style:"dropMenu bizListingsMenuFlyout",activate:ta.overlays.ACTIVATE_HOVER,onShow:function(){if(f){f.pin().show();this.container.addEvent("mouseleave",function(k){if(!f.container.containsEvent(k)){f.hide()}})}},onHide:function(){if(f){f.unpin()}}},d)}catch(h){ta.util.error.record(h,"Error: ta.overlays.Factory.bizListingsMenuFlyout")}},createDrop:function(h,d){d.onmouseover=null;try{var f=d.getNext().getElement(".subNav");ta.run("ta.overlays.Factory.createDropDown",{},h,d,f)}catch(g){ta.util.error.record(g,"Error: ta.overlays.Factory.createDrop")}},createFriendOfFriendOverlay:function(d,e){d.onclick=null;if(e){new ta.overlays.RelativeOverlayAbove({activate:ta.overlays.ACTIVATE_CLICK,style:"s2 mg",showCloseButton:true,content:e},d)}if(lazyImgs!=null){window.setupLazyLoad()}},CLOSE_BTN_RIGHT_OFFSET:15,ratingsFlyout:function(p,d,g,k){if(p){p.stop()}try{var j=d.get("class").match("rating(\\d)")[1];var l=ta.id("ratingsFlyout"+j).get("html");var o=null;var f="";if(g){o=ta.servlet.Reviews.ratingFlyoutScroll}var h="ratingOverlay dg s3 rgba_gry";if(k){f=" fixedHeight";h=h+" overlayWithScroll"}new ta.overlays.RelativeOverlayAbove({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK,content:l,innerDivClass:"ratingFlyout inner"+f,style:h,onscroll:o},d);new Request({url:"/ActionRecord?action=ratingsFlyout&pid=4304"}).send()}catch(m){ta.util.error.record(m,"showRatingsFlyout")}},sameGeoActivityOverlay:function(f,d,e){if(!ta.has("sameGeoActivityCSS")){ta.store("sameGeoActivityCSS",new Asset.css(sameGeoActivityCSS))}new ta.overlays.RelativeOverlayBelow({style:"s3 dg rgba_gry sameGeoActivityOverlay",activate:ta.overlays.ACTIVATE_CLICK,showCloseButton:true,onLoad:function(){this.show()},remoteContent:"/SameGeoActivity",requestData:e},d)},openTourismDescription:function(d){ta.servlet.Tourism.showGeoDescription(d)},memberPassportStampOverlay:function(f,d,e){if(!ta.has("passportStampsCSS")){ta.store("passportStampsCSS",new Asset.css(passportStampsCSS))}e.geos=e.geos.join(",");new ta.overlays.RelativeOverlayRight({style:"s3 dg rgba_gry memberPassportStamps",activate:ta.overlays.ACTIVATE_CLICK,showCloseButton:true,onLoad:function(){this.show()},remoteContent:"/MemberPassportStamps",requestData:e},d);new Request({url:"/ActionRecord?action="+e.actionRecord}).send()},relRightLocalContent:function(f,d,e){d.onmouseover=null;new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_HOVER,style:"s2 og",content:ta.id(e).innerHTML},d)},cookieSettingsPanel:function(g,d){if(g){g.stop()}if(d&&d.onclick){d.onclick=null}var e={};e.en=451;e.da=649;e.sv=650;e.no=677;e["default"]=451;var f;if(posLang in e){f="http://info.evidon.com/pub_info/"+e[posLang]+"?v=1&nt=0"}else{f="http://info.evidon.com/pub_info/"+e["default"]+"?v=1&nt=0"}new ta.overlays.RelativeOverlayBelow({showCloseButton:true,noPadding:true,activate:ta.overlays.ACTIVATE_CLICK,content:new Element("iframe",{src:f,height:562,width:731,styles:{margin:"0"}})},d)},metaCheckRatesOverlay:function(g,f){if(!ta.has("metaCheckRatesCSS")){ta.store("metaCheckRatesCSS",new Asset.css(metaCheckRatesCSS))}var e=ta.retrieve("pcr.overlay");if(e&&e.visible){e.hide()}var d=new ta.overlays.CenteredOverlay({style:"metaCheckRatesOverlay rgba_flyout",backdrop:ta.overlays.BACKDROP_ALWAYS,closeButtonClass:"roundOuterClose",remoteContent:ta.commerce.checkrates.buildMetaHacUrl(g,f,false),onLoad:function(){ta.commerce.checkrates.updateMetaProviders(g);ta.commerce.checkrates.metaTimeout=setTimeout(function(){ta.commerce.checkrates.metaHacRequest(g,f)},1000)},onClose:function(){ta.store("metaCheckRatesOverlay",null)}},null);ta.store("metaCheckRatesOverlay",d)}}})();(function(a){Object.append(a,{injectReviewSummaryContentFromConcept:function(c){try{var b=ta.retrieve("topconcepts.rsContent")[c];if(!b){ta.util.error.record(null,"injectReviewSummaryContentFromConcept - no content")}ta.overlays.Factory.injectReviewSummaryContent(b)}catch(d){ta.util.error.record(d,"injectReviewSummaryContentFromConcept")}},injectReviewSummaryContent:function(c){try{var b=ta.retrieve("reviewSummaryOverlay");if(b){b.inner.setContent(c);b.show()}else{ta.util.error.record(null,"injectReviewSummaryContent - no overlay")}}catch(d){ta.util.error.record(d,"injectReviewSummaryContent")}},storeReviewSummaryContent:function(d,c){var b=ta.retrieve("topconcepts.rsContent");if(!b){b={}}b[d]=c;ta.store("topconcepts.rsContent",b)},addSummaryBoxContentAndShow:function(g,d){try{var b=ta.retrieve("reviewSummaryOverlay");ta.overlays.Factory.injectReviewSummaryContent(d);var j=ta.id("SUMMARYBOX").clone(true,false);var c=b.inner;c.getElement(".title").adopt(j);var k="concept_"+g.replace(/ /g,"_");var f=document.getElement(".overlay .rd_concepts ."+k);if(f){f.removeClass("taLnk").removeClass("hvrIE6").addClass("conceptSelected").onClick=""}Array.each(c.getElements(".rd_concepts .snippetText"),function(e){var m=ta.id(e);m.removeClass("snippetText");var l=m.getElement(".taLnk");if(l){l.setProperty("onclick","ta.util.cookie.setPIDCookie(25223);ta.call('ta.overlays.Factory.showReviewSummaryV2',event, this);")}});ta.overlays.Factory.storeReviewSummaryContent(g,c.get("html"));ta.overlays.Factory.injectReviewSummaryContentFromConcept(g)}catch(h){ta.util.error.record(h,"updateReviewSummaryContent - request.onSuccess")}},updateReviewSummaryContent:function(c,b){try{if(ta.has("reviewSummaryOverlay")&&ta.has("topconcepts.rsContent")&&ta.retrieve("topconcepts.rsContent")[c]){ta.overlays.Factory.injectReviewSummaryContentFromConcept(c);return}if(ta.has("reviewSummaryOverlay")){new Request({url:b,onSuccess:function(e){ta.overlays.Factory.addSummaryBoxContentAndShow(c,e)},evalScripts:true,method:"get"}).send();return}else{ta.util.error.record(null,"updateReviewSummaryContent - no overlay")}}catch(d){ta.util.error.record(d,"updateReviewSummaryContent")}},getReviewSummaryUrl:function(f,e,j,c){ta.store("topconcepts.lastconcept",f);if(typeof modelLocId=="undefined"||typeof modelGeoId=="undefined"){var h=(typeof modelLocId=="undefined")?"undefined":modelLocId;var d=(typeof modelGeoId=="undefined")?"undefined":modelGeoId;ta.util.error.record(null,"getReviewSummaryUrl",null,{locId:h,geoId:d})}if(j&&c){ta.util.cookie.setPIDCookie(16007);var g="/MachineTranslation?";if(e.id){var f;if(e.id.indexOf("trans_")!=-1){f=e.id.replace("trans_","").replace(/_/g," ")}else{f=e.id.replace("concept_","").replace(/_/g," ")}ta.store("topconcepts.lastconcept",f);g+="page=summary&";g+="d="+modelLocId+"&";g+="concept="+f;g+="&sl=en&tl="+j}return g}var b="/HotelSummary?d="+modelLocId+"&geo="+modelGeoId+"&concept="+f;if(j){b+="&autotrans=true"}return b},getReviewSummaryConcept:function(b){try{var c=b.id?b.id:b.className.match("(concept_[a-zA-Z0-9-_]+)")[1];return c.replace("concept_","").replace(/_/g," ")}catch(d){ta.util.error.record(d,"getReviewSummaryConcept",null,{id:b.id,"class":b.className})}return""},showReviewSummaryV2:function(h,e,g,c){if(h){h.stop()}var f=ta.overlays.Factory.getReviewSummaryConcept(e);var b=ta.overlays.Factory.getReviewSummaryUrl(f,e,g,c);if(ta.has("reviewSummaryOverlay")){ta.overlays.Factory.updateReviewSummaryContent(f,b);return}ta.overlays.Factory._loadSummaryCss();var d=new ta.overlays.CenteredOverlay({style:"s3 dg nopadding rgba_gry",autoShow:false,permanent:true,showCloseButton:true,remoteContent:b,onLoad:function(j){try{ta.store("topconcepts.overlay."+f,this);ta.overlays.Factory.addSummaryBoxContentAndShow(f,this.inner.innerHTML);this.show()}catch(k){ta.util.error.record(k,"showReviewSummary - overlay onload")}}},e);ta.store("reviewSummaryOverlay",d)}})})(ta.overlays.Factory);ta.overlays.CalendarOverlay=new Class({Extends:ta.overlays.RelativeOverlayBelow,options:{showCloseButton:true,activate:ta.overlays.ACTIVATE_FOCUS,style:"typeO ocal",autoShow:false,autoShowCal:false,calendarOptions:null,flipPadding:25},initialize:function(a,b){this.input=a.getElement("input[type=text]");this.parent(b,this.input);this.input.overlay=this;this.dayField=a.getElement("input.day");this.monthField=a.getElement("input.month");this.source.addEvent("click",this.show);this.icn=a.getElement("span.icn");if(this.icn){this.icn.onclick="";this.icn.addEvent("click",this.show)}this.calendar=new ta.widgets.Calendar(Object.merge({dualCalendar:true,choiceLink:"ta.overlays.calendarSelect",prevAction:"ta.overlays.calendarPrev",nextAction:"ta.overlays.calendarNext",onSelect:this.select.bind(this)},this.options.calendarOptions));this.inner.adopt(this.calendar.container);this.parentOverlay=a.getParent(".overlay");if(this.parentOverlay){this.parentOverlay=this.parentOverlay.overlay;this.options.isChild=true}if(this.options.autoShowCal){this.show()}},destroy:function(){this.parent();this.input.overlay=null},show:function(b){var a=this.visible;this.parent(b);if(a){return}if(this.parentOverlay&&this.parentOverlay.pin&&this.parentOverlay.options.pinnable==ta.overlays.PINNABLE_CLICK){this.tempPin=!this.parentOverlay.pinned;if(this.tempPin){this.parentOverlay.pin()}}this.loadFields();this.calendar.update();this.calendar.reposition();return this},hide:function(a){if(!this.visible){return}this.parent(a);if(this.parentOverlay&&this.tempPin){this.tempPin=false;this.parentOverlay.unpin()}},hideNow:function(a){if(!this.visible){return this}this.parent(a);if(this.parentOverlay&&this.tempPin){this.tempPin=false;this.parentOverlay.unpin()}},select:function(a,b){if(b){new Event(b).preventDefault()}this.updateFields();this.hide();this.fireEvent("onSelect",this)},loadFields:function(){var b=parseInt(this.dayField.value.replace(/^0/,""));var a=this.monthField.value.split(/\//);if(a.length!=2){return}var c=parseInt(a[1]);a=parseInt(a[0].replace(/^0/,""));this.calendar.selectedDate=new Date(c,a-1,b);return this},updateFields:function(){if(!this.calendar.selectedDate){this.loadFields()}if(!this.calendar.selectedDate){return}var a=this.calendar.selectedDate.getMonth()+1;if(a<10){a="0"+a}this.dayField.value=this.calendar.selectedDate.getDate();this.monthField.value=a+"/"+this.calendar.selectedDate.getFullYear();this.input.value=formatDate(this.calendar.selectedDate.getDate(),this.calendar.selectedDate.getMonth(),this.calendar.selectedDate.getFullYear())},clearFields:function(){this.input.value=JS_DateFormat},validate:function(){var b=this.input.value.match(DATE_FORMAT.pattern);if(b){var c=parseInt(b[DATE_FORMAT.date].replace(/^0/,""));var a=parseInt(b[DATE_FORMAT.month].replace(/^0/,""));var d=parseInt(b[DATE_FORMAT.year].replace(/^0/,""));if(c>0&&c<32&&a>0&&a<13){if(c<10){c="0"+c}if(a<10){a="0"+a}if(d<100){d+=2000}this.dayField.value=c;this.monthField.value=a+"/"+d;this.loadFields();if(!this.calendar.isValid()){return sInvalidDates}}else{return sInvalidDates}}else{return sInvalidDates}return null}});ta.overlays.createCalendar=function(b,a){new Event(b).preventDefault();a.onfocus="";new ta.overlays.CalendarOverlay($(a).getParent(".cal"),{autoShowCal:true})};ta.overlays.calendarSelect=function(f,e,a,c,b){if(ta.has("checkrates.calendarActionRecord")){ta.util.cookie.removePIDCookie();ta.commerce.checkrates.actionRecord(ta.retrieve("checkrates.calendarActionRecord"))}$(b).getParent(".overlay").overlay.calendar.select(f,new Date(e,a,c))};ta.overlays.calendarPrev=function(b,a){$(a).getParent(".overlay").overlay.calendar.prev()};ta.overlays.calendarNext=function(b,a){$(a).getParent(".overlay").overlay.calendar.next()};ta.overlays.PairedCalendar=new Class({Implements:[Options,Events],options:{validate:false,allowSameDay:false,calendarOptions:null,defaultSpan:1,keepDelta:false,clearDatesId:"clearDates",overlayOptions:{}},initialize:function(b,a){this.setOptions(a);b=ta.id(b);this.form=b.get("tag")=="form"?b:b.getParent("form");var c=Object.merge({onSelect:this.adjustRange.bind(this)},this.options.overlayOptions);if(this.options.calendarOptions){c.calendarOptions=this.options.calendarOptions}this.form.getElements(".cal").each(function(d){var f=new ta.overlays.CalendarOverlay(d,c);f.input.onfocus="";if(d.hasClass("first")){this.before=f}else{this.after=f;if(ta.has("isDaoDaoCRRedesign")){this.after.theOtherCal=this.before;this.before.theOtherCal=this.after;var e=this.form.get("qc_area");this.after.qcArea=e;this.before.qcArea=e}}if(b==f.input||b==f.icn){f.show()}},this);if(this.form){this.form.calendar=this;if(this.options.validate){this.form.addEvent("submit",this.validate.bind(this));this.errorDiv=this.form.getElement(".error_msg")}}},getOverlayForCalendar:function(a){if(this.before.calendar==a){return this.before}if(this.after.calendar==a){return this.after}return null},adjustRange:function(c){this.requireFullLoad();if(this.form.searchAll){if(this.form.searchAll.type=="checkbox"){this.form.searchAll.checked=false}else{if(this.form.searchAll.type=="hidden"){this.form.searchAll.value="false"}}}var b=ta.id(this.options.clearDatesId);if(b){b.style.visibility="visible"}if(!this.sameDayEnabled()&&this.after.calendar.selectedDate&&this.after.calendar.selectedDate.getTime()==this.after.calendar.options.firstDate.getTime()){this.before.calendar.selectedDate=new Date(this.before.calendar.options.firstDate);if(this.options.keepDelta){this.options.defaultSpan=1}var j=new Date(this.after.calendar.options.firstDate);j.setDate(j.getDate()+this.options.defaultSpan);this.after.calendar.selectedDate=j;this.before.updateFields();this.after.updateFields()}else{if(c==this.before){if(this.options.keepDelta||!this.isBeforeValid()){var j=new Date(this.before.calendar.selectedDate);j.setDate(j.getDate()+this.options.defaultSpan);this.after.calendar.selectedDate=j}this.after.updateFields()}else{if(c==this.after){if(!this.isAfterValid()){var j=new Date(this.after.calendar.selectedDate);j.setDate(j.getDate()-this.options.defaultSpan);if(j.getTime()<this.before.calendar.options.firstDate.getTime()){j=new Date(this.before.calendar.options.firstDate.getTime())}this.before.calendar.selectedDate=j}this.before.updateFields()}}}if(this.options.keepDelta&&this.before.calendar.selectedDate){this.options.defaultSpan=ta.util.date.getDaysInRange(this.before.calendar.selectedDate,this.after.calendar.selectedDate)-1;if(this.sameDayEnabled()){if(this.options.defaultSpan<0){this.options.defaultSpan=0}}else{if(this.options.defaultSpan<1){this.options.defaultSpan=1}}}this.fireEvent("onUpdate",this);var g=ta.retrieve("calendar.onUpdateCallback");if(g){for(var f=0;f<g.length;f++){if(window[g[f]]){window[g[f]](this,c)}}}this.updateMinStay(this.before.calendar.selectedDate,this.after.calendar.selectedDate);try{var a="before";if(c==this.after){a="after"}ta.commerce.checkrates.triggerAvailCheck.call(this,a);ta.commerce.checkrates.triggerAvailCheck.delay(1500,this,false);ta.store("avail.check.query.complete",true)}catch(h){ta.util.error.record(h,"availability check - paired cal")}},updateMinStay:function(a,c){var b=ta.id("minStay");if(b&&a&&c){b.disabled=true;b.selectedIndex=this.getMinStayIndex(a,c)}},getMinStayIndex:function(a,c){var b=ta.util.date.getDaysInRange(a,c)-1;if(b<7){return b}else{if(b<28){return 7}else{return 8}}},isOneWay:function(){return this.form.oneWay&&this.form.oneWay.checked},sameDayEnabled:function(){return this.options.allowSameDay||this.isOneWay()},searchAllEnabled:function(){return this.form.searchAll&&(this.form.searchAll.checked||(this.form.searchAll.type=="hidden"&&this.form.searchAll.value=="true"))},updateFields:function(){this.before.updateFields();this.after.updateFields()},clearFields:function(){this.before.clearFields();this.after.clearFields()},requireFullLoad:function(){if(!this.before.calendar.selectedDate){this.before.loadFields()}if(!this.after.calendar.selectedDate){this.after.loadFields()}},isBeforeValid:function(){this.requireFullLoad();if(!this.after.calendar.selectedDate){return true}return(this.before.calendar.selectedDate<this.after.calendar.selectedDate)||(this.sameDayEnabled()&&this.before.calendar.selectedDate.getTime()<=this.after.calendar.selectedDate.getTime())},isAfterValid:function(){this.requireFullLoad();if(!this.before.calendar.selectedDate){return true}return(this.after.calendar.selectedDate>this.before.calendar.selectedDate)||(this.sameDayEnabled()&&this.after.calendar.selectedDate.getTime()>=this.before.calendar.selectedDate.getTime())},validate:function(d){if(this.searchAllEnabled()){return true}var a=this.before.validate();var b=this.after.validate();var c=true;if(this.isOneWay()){if(a!=null){c=false;this.setError(a)}}else{if(a!=null||b!=null){c=false;this.setError(a||b)}else{if(!this.isAfterValid()){c=false;this.setError(sInvalidDates)}}}if(!c&&d){new Event(d).stop()}return c},setError:function(a){if(!this.errorDiv){return}this.errorDiv.setContent(a).show()},toggleSearchAll:function(){if(this.searchAllEnabled()){this.before.clearFields();this.after.clearFields()}else{this.requireFullLoad();this.before.updateFields();this.after.updateFields()}}});ta.overlays.createSimplePairedCalendar=function(b,a){new Event(b).stop();new ta.overlays.PairedCalendar(a)};ta.overlays.createSpannedPairedCalendar=function(c,a,b){new Event(c).stop();new ta.overlays.PairedCalendar(a,{defaultSpan:b})};ta.overlays.createPairedCalendar=function(c,b,a){if(!a){a={validate:true}}new Event(c).preventDefault();return new ta.overlays.PairedCalendar(b,a)};ta.overlays.toggleOffSearchAll=function(a){if(a.calendar&&a.searchAll){if(a.searchAll.type=="checkbox"){a.searchAll.checked=false}else{if(a.searchAll.type=="hidden"){a.searchAll.value="false"}}a.calendar.toggleSearchAll()}};ta.overlays.toggleOnSearchAll=function(a){a=ta.id(a);var b=a.getParent("form");if(!b.calendar){new ta.overlays.PairedCalendar(a,{validate:true,clearDatesId:a})}if(b.calendar&&b.searchAll){if(b.searchAll.type=="checkbox"){b.searchAll.checked=true}else{if(b.searchAll.type=="hidden"){b.searchAll.value="true"}}b.calendar.toggleSearchAll()}};ta.overlays.toggleSearchAll=function(d,b,a){b=ta.id(b);b.onclick="";var c=b.getParent("form");if(!a){a={validate:true}}if(!c.calendar){new ta.overlays.PairedCalendar(b,a)}c.calendar.toggleSearchAll(b);b.addEvent("click",c.calendar.toggleSearchAll.bind(c.calendar))};ta.overlays.clearDates=function(c,a){ta.overlays.toggleOnSearchAll(a);ta.id(a).style.visibility="hidden";var b=ta.id("minStay");if(b!==null){b.disabled=false;b.selectedIndex=0;filtersChanged(c)}};ta.overlays.PermanentOverlay=new Class({Extends:ta.overlays.AbsoluteOverlay,initialize:function(a,b){this.parent(Object.merge({permanent:true},a),b)}});ta.overlays.SkinnyOverlay=new Class({Extends:ta.overlays.RelativeOverlayBelow,initialize:function(a,b){this.parent(a,b);this.container.setStyle("max-width","120px");if(Browser.ie6){this.shim.setStyle("max-width","120px")}}});ta.overlays.Registration=new Class({Implements:[Options,Events],Binds:["response","failure"],options:{flow:null,url:"/Registration",isOverlay:true,pageTarget:null,responseCallback:null,completeCallback:null,customOverlayOptions:{}},initialize:function(a){this.setOptions(a);if(this.options.isOverlay){this.overlay=new ta.overlays.CenteredOverlay(Object.merge({backdrop:ta.overlays.BACKDROP_ALWAYS,autoShow:false,style:"s4 dg",attachCloseEvent:false},this.options.customOverlayOptions));if(this.overlay.closeBtn){this.overlay.closeBtn.addEvent("click",this.cancel.bind(this))}}},getRequestData:function(){var a={flow:this.options.flow};if(ta.has("registration.data")){a=Object.merge(a,ta.retrieve("registration.data"))}if(ta.has("page.geo")){a.geo=ta.retrieve("page.geo")}a.source=pageServlet;a=[a];Array.from(arguments).each(function(b){a.push(b)});return a},request:function(b,a){ta.store("registration.method","request");new Request({url:this.options.url,method:"get",evalScripts:true,data:this.getRequestData(a,{action:b}),onSuccess:this.response,onFailure:this.failure}).send();return this},post:function(a){if(ta.has("facebook.authcode.param")){a=Object.merge(a,{FBAuthCode:ta.remove("facebook.authcode.param")})}ta.store("registration.method","post");new Request({url:this.options.url,method:"post",evalScripts:true,data:this.getRequestData(a),onSuccess:this.response,onFailure:this.failure}).send();return this},cancel:function(){ta.store("registration.method","cancel");new Request({url:this.options.url,method:"get",evalScripts:true,data:this.getRequestData({CANCEL:"y",action:ta.retrieve("registration.action")}),onSuccess:this.response,onFailure:this.failure}).send();return this},log:function(a){new Request({url:this.options.url,method:"get",evalScripts:false,data:this.getRequestData({action:"LOG",pageAction:a})}).send();return this},response:function(a){if(!ta.remove("registration.noop")){if(this.options.isOverlay){this.overlay.loadRemoteSuccess(a);if(this.overlay.visible){this.overlay.position()}else{this.overlay.show()}}else{this.options.pageTarget.innerHTML=a}}if(this.options.responseCallback){setTimeout(this.options.responseCallback,1)}if(ta.has("registration.afterUpdate")){ta.remove("registration.afterUpdate").each(function(b){setTimeout(b,1)})}},close:function(){if(this.options.isOverlay){this.overlay.hide()}this.fireEvent("onComplete");if(this.options.completeCallback){this.options.completeCallback()}},failure:function(c){var a=0;var d=ta.remove("registration.method");try{a=c.status}catch(b){}if(a==503){this.overlay.loadRemoteSuccess('<div style="padding:6px;">'+JS_maintenance+"</div>");if(this.overlay.closeBtn){this.overlay.closeBtn.removeEvents("click");this.overlay.closeBtn.addEvent("click",ta.overlays.registration.close)}if(this.overlay.visible){this.overlay.position()}else{this.overlay.show()}}else{if(d=="cancel"){ta.overlays.registration.close()}ta.util.error.ajaxFailure.partial("Registration:"+d)}}});ta.overlays.registration={getInstance:function(a){var b=ta.retrieve("registration.instance");if(!b){if(typeof(regflowCss)!="undefined"&&!ta.retrieve("ta.regflowCss")){ta.store("ta.regflowCssAsset",Asset.css(regflowCss))}b=new ta.overlays.Registration(a);ta.store("registration.instance",b)}return b},connect:function(a,d,c){if(typeof(regflowCss)!="undefined"&&!ta.retrieve("ta.regflowCss")){ta.store("ta.regflowCssAsset",Asset.css(regflowCss))}if(ta.has("facebook.available")&&ta.retrieve("facebook.available")){var e={fbAvailable:true}}else{if(ta.has("registration.forceFBAvailable")){var e={fbAvailableForce:ta.remove("registration.forceFBAvailable")}}}var b="SIGNIN";ta.remove("registration.data");ta.overlays.registration.getInstance(a).request(d||b,Object.merge({},c,e))},post:function(b,a){var c=a||window.event;if(c){new Event(c).stop()}ta.overlays.registration.getInstance().post(b)},request:function(c,b,a){if(c=="SIGNUP"||c=="SIGNIN"){b=Object.merge({fbAvailable:ta.has("facebook.available")&&ta.retrieve("facebook.available")},b)}ta.overlays.registration.getInstance(a).request(c,b)},deferredRequest:function(d,b,e,c,a){ta.overlays.registration.getInstance(a).request(e,c,a)},cancel:function(){ta.overlays.registration.getInstance().cancel(false)},log:function(a){ta.overlays.registration.getInstance().log(a)},close:function(){var a=ta.remove("registration.instance");if(a){a.close()}},switchFlow:function(a){ta.overlays.registration.getInstance().options.flow=a},logAndPost:function(a,c,b){ta.overlays.registration.getInstance(a).log(c).post(b)}};ta.servlet.Registration={realNameDone:function(a){if(ta.id("use_real_name")&&ta.id("use_real_name").getProperty("checked")||ta.id("chooseNameFB")){ta.overlays.registration.post(ta.id("RealName"),a)}else{ta.overlays.registration.cancel()}},screenEdit:function(a){ta.id("screen").set("value","");ta.id("screen").focus();ta.id(a).hide()}};ta.overlays.PopoutOverlay=new Class({Extends:ta.overlays.Overlay,options:{backdrop:ta.overlays.BACKDROP_ALWAYS,showCloseButton:true},initialize:function(a,b){this.parent(a,b);this.placeholder=new Element("div").inject(this.source,"before").adopt(this.source);this.placeholder.setStyles({marginBottom:this.source.style.marginBottom,marginTop:this.source.style.marginTop});this.source.setStyles({marginBottom:0,marginTop:0});if(this.options.showCloseButton){this.closeBtn.addEvent("click",this.hide)}this.show()},show:function(a){this.sourceCoords=this.source.getCoordinates();this.placeholder.setStyles({width:this.sourceCoords.width,height:this.sourceCoords.height});this.inner.adopt(this.source);this.parent(a)},hide:function(a){this.parent(a);this.placeholder.adopt(this.source).setStyles({width:"auto",height:"auto"})},position:function(){var b=parseInt(this.container.getStyle("borderTopWidth").replace(/px/,""));var a=parseInt(this.container.getStyle("borderLeftWidth").replace(/px/,""));this.container.setStyles({left:this.sourceCoords.left-a,top:this.sourceCoords.top-b,width:this.sourceCoords.width,display:"block"});this.parent()}});ta.overlays.PopoutWithOverlay=new Class({Extends:ta.overlays.Overlay,options:{position:"topleft",edge:"topright",offset:{x:-10,y:0},scrollOffset:-20,backdrop:ta.overlays.BACKDROP_ALWAYS,showCloseButton:true},initialize:function(a,b){this.parent(a,b);this.placeholder=new Element("div").inject(this.source,"before").adopt(this.source);this.popout=new Element("div",{styles:{position:"absolute",zIndex:"10002",fontSize:"0.75em",display:"none"}}).inject(document.body);if(this.options.showCloseButton){this.closeBtn.addEvent("click",this.hide)}this.show()},show:function(b){this.parent(b);var a=this.source.getCoordinates();this.placeholder.setStyles({width:a.width,height:a.height,marginBottom:this.source.style.marginBottom,marginTop:this.source.style.marginTop});this.popout.setStyles({left:a.left,top:a.top,width:a.width,display:"block"}).adopt(this.source)},hide:function(a){this.parent(a);this.placeholder.adopt(this.source).setStyles({width:"auto",height:"auto"});this.popout.setStyle("display","none")},position:function(){var a=this.source.getCoordinates();this.container.setStyles({left:null,top:a.top+this.options.offset.y,right:window.getWidth()-(a.left+this.options.offset.x)});this.parent();window.scrollTo(0,a.top+this.options.offset.y+this.options.scrollOffset)}});ta.overlays.CoverOverlay=new Class({Extends:ta.overlays.Overlay,options:{autoShow:true,xOff:0,yOff:0},initialize:function(a,b){this.parent(a,b);if(this.options.showCloseButton){this.closeBtn.addEvent("click",this.hide)}if(this.options.autoShow){this.show()}},position:function(){var b=this.source.getCoordinates();var a=this.container.getCoordinates();this.container.setStyles({left:b.left+(b.width/2-a.width/2)+this.options.xOff,top:b.top+(b.height/2-a.height/2)+this.options.yOff})},updateBackdrop:function(){var a=this.source.getCoordinates();this.backdrop.setStyles({left:a.left,top:a.top,width:a.width,height:a.height})}});ta.commerce.Vendor=new Class({Implements:Options,options:{checkboxID:false,additionalOffer:false,defaultChecked:false,minDaysOut:0,maxDaysOut:0},initialize:function(c,d,e,a,b){this.setOptions(c);this.name=d;this.url=e;this.window=null;this.slot=null;this.opened=false;this.vendorName=a;this.propertyId=b;this.isFlight=false},isChecked:function(){if(this.options.checkboxID){var a=ta.id(this.options.checkboxID);if(!a){a=ta.id(this.options.checkboxID+"_pop")}if(!a){a=ta.id(this.options.checkboxID+"_icr")}if(a){try{var b=ta.id(a).getParent("li");if(b&&b.style.display=="none"){return false}}catch(c){ta.util.error.record(c,"cr checkbox hidden check")}return a.checked}}return this.options.defaultChecked&&(this.options.available||ta.retrieve("checkrates.datesChanged"))},isAvailable:function(){if(!this.isOpened()){return true}return false},isOpened:function(){try{if(!this.opened||!this.hasWindow()){return false}}catch(a){}return true},isDefaultChecked:function(){return this.options.defaultChecked},isHidden:function(){var a=ta.id(this.options.checkboxID);if(!a){a=ta.id(this.options.checkboxID+"_pop")}if(!a){a=ta.id(this.options.checkboxID+"_icr")}if(a){try{var b=ta.id(a).getParent("li");if(b){if(b.style.display=="none"){return true}else{if(this.options.hide){if(b.style.display=="block"){return false}else{return true}}}}}catch(c){ta.util.error.record(c,"checkbox hide check")}}return false},hasWindow:function(){if(!this.window||!this.window.windowObject||!("closed" in this.window.windowObject)||this.window.windowObject.closed){return false}return true},getUrl:function(e){var d=this.url;if(this.isFlight){d+="&"+e.getFlightData()}else{if(e.type!="checkdeals"){var c=e.getUserData();if(!c){c=ta.retrieve("checkrates.avUserData")}d+="&"+c;var f="QC_Inline";var a=e.trigger;if(a){var b=false;if(b=a.className.match(/custom_area_(\w+)/)){f=b[1]}}d=ta.commerce.checkrates.addCustomUrlParams(d,f)}else{if(ta.has("photo.viewer.isPhotoLBClick")){d=ta.commerce.checkrates.addCustomUrlParams(d,"QC_Inline")}}}return d},errorString:function(){var a=[];if(this.name){a.push("&name_");a.push(this.name)}if(this.slot){a.push("&slot_full")}if(this.propertyId){a.push("&propId_");a.push(this.propertyId)}var b=a.join("");if(b&&b[0]){return b.slice(1)}return"noInfo"},hasDateLimits:function(){return this.options.minDaysOut>0||this.options.maxDaysOut>0},getContentID:function(){if(this.url){return ta.util.URL.getParameter(this.url,"src")}return false}});ta.commerce.VendorSet=new Class({Implements:Options,options:{vendorSet:false},initialize:function(b,a){this.setOptions(b);this.vendorSetId=a;if(this.options.vendorSet){this.vendors=this.options.vendorSet}this.vendorsUnchecked=[];this.vendorsDefaultUnchecked=[]},getVendors:function(){if(!this.vendors){this.vendors=ta.retrieve("checkrates.vendors."+this.vendorSetId)}return this.vendors},getVendorsUnchecked:function(){var c=ta.retrieve("checkrates.vendors."+this.vendorSetId);for(var a=0;a<c.length;a++){var b=c[a];if(!b.isChecked()&&!b.isHidden()){this.vendorsUnchecked.push(b)}}return this.vendorsUnchecked},getVendorsDefaultUnchecked:function(){try{var d=ta.retrieve("checkrates.vendors."+this.vendorSetId);for(var a=0;a<d.length;a++){var c=d[a];if(!c.isChecked()&&!c.isHidden()&&!c.isDefaultChecked()){this.vendorsDefaultUnchecked.push(c)}}return this.vendorsDefaultUnchecked}catch(b){ta.util.error.record(b,"vendorSet - default unchecked")}},getCheckedInfo:function(q){var r=0;var p=0;var b=0;var c=[];var g=[];var k=[];var s=[];var d=[];var a=[];var t=[];try{var o=this.getVendors();for(var f=0;f<o.length;f++){var m=o[f];d.push(m.name);d.push("__");if(m.isChecked()){r++;c.push(m.name);c.push("__");g.push(m.vendorName);g.push("__");t.push(m.getContentID());t.push("__")}else{a.push(m.name);a.push("__")}if(m.window&&m.window.closed){m.window=null}else{if(m.isOpened()){p++;k.push(m.name);k.push("__")}}}var l=ta.retrieve("checkrates.vendors."+this.vendorSetId);for(var f=0;f<l.length;f++){var h=l[f];if(h.isHidden()){b++;s.push(h.name);s.push("__")}}if(c.length>0){c.pop()}if(g.length>0){g.pop()}if(k.length>0){k.pop()}if(s.length>0){s.pop()}if(d.length>0){d.pop()}if(a.length>0){a.pop()}if(t.length>0){t.pop()}if(q=="unavail_set"){return{vendorsAvailable:d.join(""),vendorsOpened:k.join("")}}else{if(q=="unchecked"){return{vendorsUnchecked:a.join("")}}else{if(q=="count"){return r}else{if(q=="tpw_string"){return c.join("")}else{if(q=="tpv_string"){return g.join("")}else{if(q=="open_count"){return p}else{if(q=="check_more"){return{vendorsChecked:c.join(""),vendorsOpened:k.join(""),vendorsHidden:s.join("")}}else{if(q=="now_checking"){return{vendorsChecked:c.join("")}}else{if(q=="checked_content_id"){return t.join("")}}}}}}}}}}catch(j){}return{checked:r,tpw_string:c.join(""),tpv_string:g.join(""),open:p,tpw_open_string:k.join("")}},getCheckedCount:function(){return this.getCheckedInfo("count")},getCheckedString:function(){return this.getCheckedInfo("tpw_string")},getCheckedVendor:function(){return this.getCheckedInfo("tpv_string")},getCheckedContentID:function(){return this.getCheckedInfo("checked_content_id")},oneChecked:function(){var a=this.getCheckedCount();if(a==0){alert(js_0001);return false}return true},getOpenCount:function(){return this.getCheckedInfo("open_count")},storeCheckBoxValues:function(){var a={};this.getVendors().each(function(b){a[b.name]=b.isChecked()});ta.store("checkBoxSet_"+this.vendorSetId,a)},errorString:function(){var a=[];var b=this.getVendors();if(!b||b.length<1){return"empty.vendor.set"}a.push("VSet::");b.each(function(d,c){a.push("V");a.push(c);a.push(":");a.push(d.errorString())});return a.join("")}});ta.commerce.CheckRatesData=new Class({Implements:Options,options:{type:"checkRates",evnt:false},initialize:function(e,b,g,c,a){this.setOptions(e);this.trigger=b;this.type=this.options.type;this.vendorSetId=g;this.isCheckMore=c;this.propId=g;this.isLimitChecked=a;this.maxAllowedWin=0;this.maxHoldingWin=2;this.useHoldingWin=false;this.cap=3;this.lbDelay=1000;if(Browser.chrome){if(Browser.version==22){this.maxAllowedWin=2}else{if(Browser.version>22){this.maxAllowedWin=1}}}else{if(Browser.ie){this.maxAllowedWin=1}}var d=null;if(d=b.className.match(/id_(\d+)/)){this.propId=d[1]}if(this.vendorSetId){this.vendorSet=new ta.commerce.VendorSet({},this.vendorSetId)}if(this.trigger){var f=ta.id(this.trigger);this.formElem=f.getParent("form");if(this.formElem){this.infoField=this.formElem.getElement("span.error_msg")||this.formElem.getElement("span.error_msg_geo")}}},showInfo:function(a){if(this.infoField){this.infoField.addClass("errorSpan");this.infoField.setContent(a).show()}},hideInfo:function(){if(this.infoField){this.infoField.hide();this.infoField.removeClass("errorSpan")}},showErrors:function(f,b){var a=[];if(!ta.retrieve("ta.commerce.CheckRatesData.cssAsset")){ta.store("ta.commerce.CheckRatesData.cssAsset",Asset.css(CDNHOST+"/css2/common/validation_error.css"))}if(b instanceof Array&&b.constructor==Array){a=b}else{a.push(b)}for(var e=0;e<a.length;e++){var d=a[e];if(d){d.addClass("errorInput");var c=ta.id("lbl_"+d.id);if(c){c.addClass("errorLabel")}}}this.showInfo(f)},clearErrors:function(a,c){var b=ta.id("lbl_"+a.id);var d=ta.id("lbl_"+c.id);if(a){a.removeClass("errorInput")}if(c){c.removeClass("errorInput")}if(b){b.removeClass("errorLabel")}if(d){d.removeClass("errorLabel")}},validate:function(){if(!this.trigger||!this.vendorSetId||!this.getVendorSet()||!this.getVendorSet().getVendors()){try{var b="NoVendSet";if(this.getVendorSet()){b=this.getVendorSet().errorString()}var a="NoTrigger";if(this.trigger){a=ta.util.error.getSelectorString(this.trigger)}ta.util.error.record(null,"cr data validate",new Event(this.options.evnt),{trigger:a,vendorSetId:this.vendorSetId,vendorSet:b})}catch(c){}return false}if(!this.getVendorSet().oneChecked()||!this.validateDates()){return false}return true},getVendorSet:function(){if(this.reorderedVendorSet){return this.reorderedVendorSet}return this.vendorSet},getAvailVendorSet:function(){if(!this.availVendorSet){this.setAvailVendorSet()}return this.availVendorSet},getOriginalVendorSet:function(){return this.vendorSet},validateDates:function(){var b=ta.id("checkIn_"+this.vendorSetId);var c=ta.id("checkOut_"+this.vendorSetId);var a=false;checkInElemPer=ta.id("checkIn_"+this.vendorSetId+"_per");if(checkInElemPer){b=checkInElemPer;c=ta.id("checkOut_"+this.vendorSetId+"_per")}checkInElemPto=ta.id("checkIn_"+this.vendorSetId+"_pto");if(checkInElemPto){b=checkInElemPto;c=ta.id("checkOut_"+this.vendorSetId+"_pto")}checkInElemMeta=ta.id("checkIn_"+this.vendorSetId+"_met");if(checkInElemMeta){b=checkInElemMeta;c=ta.id("checkOut_"+this.vendorSetId+"_met")}if(!this.formElem||!b||!c||!b.value||!c.value){if(!b){b=ta.id("checkIn_"+this.vendorSetId+"_pop");c=ta.id("checkOut_"+this.vendorSetId+"_pop")}if(!this.formElem||!b||!c||!b.value||!c.value){return true}}this.inDate=this.parseDate(b.value);this.outDate=this.parseDate(c.value);this.clearErrors(b,c);this.errorMsg=this.dateErrorCheck(this.inDate);if(this.errorMsg){this.showErrors(this.errorMsg,b);a=true}this.errorMsg=this.dateErrorCheck(this.outDate);if(this.errorMsg){this.showErrors(this.errorMsg,c);a=true}if(this.inDate&&this.outDate&&(this.outDate.getTime()<=this.inDate.getTime())){this.errorMsg=js_0003;this.showErrors(this.errorMsg,[c,b]);a=true}if(window.cookieDomain==".daodao.com"&&a){new Request({url:"/ActionRecord?action=DaodaoInlineCRClick"}).send();var d=ta.retrieve("daodao.checkrate.error.nodate");if(d!=null){}}return !a},parseDate:function(b){var d=false;if(DATE_FORMAT&&b){var c=b.match(DATE_FORMAT.pattern);if(c){var e=parseInt(c[DATE_FORMAT.date].replace(/^0/,""));var a=parseInt(c[DATE_FORMAT.month].replace(/^0/,""));var f=parseInt(c[DATE_FORMAT.year].replace(/^0/,""));if(e>0&&e<32&&a>0&&a<13){if(e<10){e="0"+e}if(a<10){a="0"+a}if(f<100){f+=2000}d=new Date(a+"/"+e+"/"+f)}}}return d},dateErrorCheck:function(c){if(!c||isNaN(c)){if(js_invalid_dates_text_new2){return js_invalid_dates_text_new2}return" "}var b=new Date();b.setHours(0,0,0,0);var a=new Date(b.getFullYear(),b.getMonth(),b.getDate()+330);if(c.getTime()<b.getTime()){if(js_0002){return js_0002}return" "}if(a.getTime()<c.getTime()){if(js_0004){return js_0004}return" "}return false},getUserData:function(){if(!this.userData){var b=this.vendorSetId;var m=ta.id("qcInMonth_"+b);if(!m){b=this.vendorSetId+"_pop";m=ta.id("qcInMonth_"+b)}if(!m){return false}var g=ta.id("qcOutMonth_"+b);var d=ta.id("qcInDay_"+b);var p=ta.id("qcOutDay_"+b);var o=ta.id("qcAdults_"+b);var h=m.value.split(/\//);var e=g.value.split(/\//);var j=new Date(h[1],h[0]-1,d.value);var f=new Date(e[1],e[0]-1,p.value);var a=new Date();a.setHours(0,0,0,0);if(j.getTime()<a.getTime()||f.getTime()<a.getTime()){alert(js_0002);return false}var l=new Date((new Date()).getTime()+(330*86400000));if(j.getTime()>l.getTime()||f.getTime()>l.getTime()){alert(js_0004);return false}var c=[];c.push("inMonth=");c.push(h[0]);c.push("%20");c.push(h[1]);c.push("&inDay=");c.push(escape(d.value));c.push("&outMonth=");c.push(e[0]);c.push("%20");c.push(e[1]);c.push("&outDay=");c.push(escape(p.value));c.push("&adults=");c.push(o.selectedIndex+1);var k=ta.id("hacPid"+b);if(k==null){k=ta.id("hacPid")}if(k&&k.value){c.push("&pid=");c.push(k.value)}this.userData=c.join("")}return this.userData},getFlightData:function(){var a=this.vendorSetId;var h=ta.id("qcInMonth_"+a);if(!h){a=this.vendorSetId+"_pop";h=ta.id("qcInMonth_"+a)}if(!h){return false}var e=ta.id("qcOutMonth_"+a);var c=ta.id("qcInDay_"+a);var j=ta.id("qcOutDay_"+a);var f=h.value.split(/\//);var d=e.value.split(/\//);var b=[];b.push("date0=");b.push(f[1]);b.push(f[0]);b.push(escape(c.value));b.push("&date1=");b.push(d[1]);b.push(d[0]);b.push(escape(j.value));var g=ta.id("qcFlightOfferPid");if(g&&g.value){b.push("&pid=");b.push(g.value)}return b.join("")},resetVisitedFlags:function(){var c="checkrates.sUserData."+this.vendorSetId;var a=ta.retrieve(c);var b=this.getUserData();if(a&&a!=b){var d=this.getVendorSet().getVendors();for(x=0;x<d.length;x++){d[x].opened=false}}ta.store(c,b)},getCROpenCount:function(b){var a=0;b.each(function(d){var c=d.window;if(d&&d.bOpened&&c&&c.windowObject&&!c.windowObject.closed){a++}});return a},fixPopOrder:function(t){var c=this.getCheckedVendors();var p=ta.popups.PopUtil.getHoldingWindowSet();var m=this.getVendorSet().getOpenCount();var b=p.length+m;var g=this.getVendorSet().getCheckedCount();if((b+1)<g){var a=false;try{a=window.chrome}catch(o){}var l=2;var s=a?true:ta.popups.PopUtil.tryHoldingWindows(this.trigger,l);if(ta.has("checkrates.chrome_dates_entry_holding")&&Browser.chrome){t=Math.min(t,(p.length+this.maxAllowedWin))}if(s&&t<c.length){if(this.isLimitChecked){c.reverse()}else{var h=c.splice(0,t).reverse();c=h.concat(c)}}else{if(s){c=c.reverse()}else{var q=p.length+1;if(ta.has("checkrates.add_holding_windows")){q=Math.min(q,t)}var r=[];for(var f=0;f<q;f++){r.push(c.shift())}for(var d=0;d<r.length;d++){c.unshift(r[d])}}}}else{c=c.reverse()}this.reorderedVendorSet=new ta.commerce.VendorSet({vendorSet:c},this.vendorSetId)},getCheckedVendors:function(){try{var a=this.getVendorSet().getVendors().slice();var b=[];a.map(function(e,d){if(e.isChecked()){b.push(e)}});return b}catch(c){ta.util.error.record(c,"getCheckedVendors")}},setAvailVendorSet:function(){try{var b=[];var h=this.getVendorSet().getVendors();var c=ta.retrieve("availability_check");if(c){for(var a=0;a<h.length;a++){var f=h[a];var g=c.unavailableProviders;if(!g||!g[f.name]){b.push(f)}}this.availVendorSet=new ta.commerce.VendorSet({vendorSet:b},this.vendorSetId)}}catch(d){ta.util.error.record(d,"availability check - crData set vendor set")}}});ta.commerce.checkrates={checkRatesClicked:function(d,b,a,c){ta.commerce.checkrates.displayVendors(new ta.commerce.CheckRatesData({type:c,evnt:d},b,a,false,this.isLimitChecked(b)))},checkRatesCheckMore:function(d,b,a,c){this.initCheckMoreData();var e=new ta.commerce.CheckRatesData({type:c,evnt:d},b,a,true,this.isLimitChecked(b));if(ta.retrieve("p13n_test44_GeoCRLeaveBehind")&&document.URL.indexOf("/Hotel_Review-")>0&&"geocheckrates"==c){this.launchLeaveBehind("avlb",e)}else{ta.commerce.checkrates.displayVendors(e)}},checkRatesCheckMoreFromPop:function(d,b,a,c){var e=ta.retrieve("checkrates.vendors."+a);window.opener.ta.commerce.checkrates.checkRatesCheckMoreToMain(d,b,a,c,e)},checkRatesCheckMoreToMain:function(d,b,a,c,e){ta.store("checkrates.vendors."+a,e);this.checkRatesCheckMore(d,b,a,c)},isLimitChecked:function(a){if(ta.has("checkrates.limit_checked")&&a&&!a.className.match(/custom_area_QC_AlsoViewed_CheckMore/)&&!a.className.match(/custom_area_QC_AlsoViewed_LeaveBehind/)){return true}else{return false}},inTest:function(b,a){if(b&&b.trigger){return b.trigger.hasClass(a)}return false},changePID:function(a){var b=ta.id("hacPid");if(b){b.value=a}},checkDealsClicked:function(c,b,a){ta.commerce.checkrates.displayVendors(new ta.commerce.CheckRatesData({type:"checkdeals",evnt:c},b,a,false))},checkRatesPhotoOverlayClicked:function(d,b,a,c){this.initCheckMoreData();ta.store("photo.viewer.isPhotoLBClick",true);ta.store("crPageServlet_orig",crPageServlet);crPageServlet="LocationPhotosLightbox";var e=ta.commerce.checkrates.displayVendors(new ta.commerce.CheckRatesData({type:c,evnt:d},b,a,true,this.isLimitChecked(b)));ta.remove("photo.viewer.isPhotoLBClick");if(ta.photos.viewer){ta.photos.viewer.afterCheckRates(e)}},restoreCRPageServlet:function(){var a=ta.retrieve("crPageServlet_orig");if(a){crPageServlet=a}},initCheckMoreData:function(){this.checkMoreData={uncheckedProviders:null,alsoViewed:null,VR:null}},displayVendors:function(c){var a=document.getElement(".overlay");if(a&&a.overlay&&a.overlay.pin){a.overlay.pin()}if(!c.validate()){return false}c.hideInfo();try{if(ta.browser.isIE10Metro()&&ta.retrieve("metaCheckRatesFeatureEnabled")){if(c.trigger&&c.trigger.className.contains("QC_Inline_Geo")){if(c.inDate&&c.outDate){var d="geo="+c.vendorSetId+"&inDay="+c.inDate.getDate()+"&inMonth="+(c.inDate.getMonth()+1)+"/"+c.inDate.getFullYear()+"&outDay="+c.outDate.getDate()+"&outMonth="+(c.outDate.getMonth()+1)+"/"+c.outDate.getFullYear();window.location="/HACSearch?"+d}}else{this.openMetaHacOverlay(c)}return}this.popwindows(c);if(!ta.has("checkrates.commerce_drop_to_bottom")){this.addBoomerangTag(c)}}catch(b){}return true},popwindows:function(f){try{if(ta.commerce.checkrates.isAvailCheckTest()&&!window.chrome&&!ta.has("avail.check.query.complete")){if(!ta.has("availability_check")){if(!ta.has("commerce.ac.attempts")){ta.store("commerce.ac.attempts",0);ta.commerce.checkrates.triggerAvailCheck(false)}else{ta.store("commerce.ac.attempts",ta.retrieve("commerce.ac.attempts")+1)}if(ta.retrieve("commerce.ac.attempts")<30){ta.commerce.checkrates.popwindows.delay(100,this,[f]);return}}ta.remove("commerce.ac.attempts")}}catch(d){ta.util.error.record(d,"availability check - popwindows")}if(ta.has("pav.overlay")){ta.retrieve("pav.overlay").hide()}f.resetVisitedFlags();ta.store("checkrates.flightData",f.getFlightData());var a=ta.id("msgbox");if(f.type=="providerWindow"){ta.commerce.commerceHelper.openProviderWindowTest(f);if(js_0014&&a){a.hide().empty()}return false}if(js_0005&&a){a.setContent(js_0005).show()}var b=f.getVendorSet().getVendors().length;if(ta.commerce.checkrates.isAvailCheckTest()){var c=f.getAvailVendorSet();if(c&&c.getVendors()){b=c.getCheckedCount();if(isNaN(b)||b>3){b=3}}}else{if(f.isLimitChecked){b=0}else{if(/win_test_(\d+)/.test(f.trigger.className)){b=parseInt(RegExp.$1)}else{if(f.type=="alsoViewed"){b=3}}}}if(typeof(isIPad)!="undefined"&&isIPad){if(!(typeof(iPadOSVersion)!="undefined"&&iPadOSVersion>=5)){b=1}}if(b>1||f.isLimitChecked){f.fixPopOrder(b)}this.popAll(f,b);if(a){a.hide().empty()}return true},popAll:function(a,p){var h=false;if(/custom_area_(\S+)\s/.test(a.trigger.className)){h=RegExp.$1}var o=a.getVendorSet().getVendors();try{if(ta.commerce.checkrates.isAvailCheckTest()){o=a.getAvailVendorSet().getVendors()}}catch(j){}ta.store("checkrates.avUserData",a.getUserData());ta.store("checkrates.avId",a.propId);ta.trackPhysicalCommerce("CheckRates",h,1);var b=a.maxAllowedWin;if(!b){a.useHoldingWin=true}else{var l=a.getCheckedVendors().length;if(l>a.cap){l=a.cap}if(l>=(b+a.maxHoldingWin)){a.useHoldingWin=true}else{if(l==(b+a.maxHoldingWin-1)){a.useHoldingWin=true;a.skipHoldingWin=true}}}var d=0;for(var f=0;f<o.length;f++){var k=o[f];if(k.isChecked()&&k.isAvailable()){if((p-1<d)&&!a.isLimitChecked){this.popBlock(a);return false}var m=this.popOne(k,a);if(!m){this.popBlock(a);return false}else{ta.trackAttemptedCommerce("CheckRates",h,k.name,f+1);d++}}}var g=false;try{g=(window.cookieDomain==".daodao.com"&&(a.trigger.hasClass("smartdeals_checkmore")||window.pageServlet!="SmartDeals"))&&serverPool!=null&&serverPool.toLowerCase()==="b"&&p<o.length}catch(c){}if(a.isCheckMore||g){this.popBlock(a)}else{if(a.type!="checkdeals"){if(!ta.has("checkrates.commerce_drop_to_bottom")){this.launchAVLBTest(a)}else{this.launchLeaveBehind.delay(a.lbDelay,this,["avlb",a])}}}if(ta.has("pcr.overlay")){ta.retrieve("pcr.overlay").hide()}return true},hideLoading:function(c){var a=document.id(c);if(a){var b=a.getElement(".loading");b.set("styles",{display:"none"})}},showLoading:function(d){var a=document.id(d);if(a){var c=a.getElement(".loading");var b=a.getElement(".grn_chevronRgt");c.set("styles",{display:"block"});b.set("styles",{display:"none"})}},showArrow:function(d){var a=document.id(d);if(a){var c=a.getElement(".loading");var b=a.getElement(".grn_chevronRgt");c.set("styles",{display:"none"});b.set("styles",{display:"block"})}},getDelaySecs:function(){var a=ta.id("CHECK_MORE_SITES_LB");if(a&&a.hasClass("dont_animate")){return 0}return 2000},showRemainingCheckMore:function(){var b=this.checkMoreData;var f=document.id("UNCHECKED_PROVIDERS");var a=document.id("ALSO_VIEWED_LB");var c=ta.id("VR_CROSS_SELL");var d=this.getDelaySecs();b.uncheckedProviders=f;b.alsoViewed=a;b.VR=c;if(f){this.showUncheckedProviders.delay(d,this)}else{if(a){this.showAlsoViewed.delay(d,this)}else{if(c){this.showVR.delay(d,this)}}}try{this.loadPackages(false)}catch(g){ta.util.error.record(g,"hotel packages - loadPackages")}},loadPackages:function(b){if(this.shouldSendPackagesRequest()){var f=$$(".packages");this.checkMoreData.packages=f;var h=ta.id("PACKAGES_HOTEL_ID");var l=ta.id("PACKAGES_HOTEL_NAME");var q=ta.id("PACKAGES_CHECK_IN_DATE");var d=ta.id("PACKAGES_CHECK_OUT_DATE");var j=ta.id("PACKAGES_ADULTS");var o=ta.id("PACKAGES_GEO");if(h&&l&&q&&d&&j&&o){var k=h.get("value");var p=l.get("value");var c=q.get("value");var m=d.get("value");var g=j.get("value");var e=o.get("value");var a=[];$$("#ALSO_VIEWED_LIST a").each(function(r){var s=/-d([0-9]+)-/.exec(r.href);if(s&&s[1]&&s[1]!=""){a.push(s[1])}});this.fireCallCountEvent(1);setTimeout(function(){new Request({url:"/ExpediaPackagesAjax",onSuccess:function(r){try{ta.commerce.checkrates.handlePackages(r,0)}catch(s){ta.util.error.record(s,"hotel packages - handlePackages")}},onFailure:function(r){ta.util.error.record(r.responseText,"hotel packages - call to /ExpediaPackagesAjax")},data:{hotelId:k,hotelName:p,checkInDate:c,checkOutDate:m,adults:g,geo:e,alsoViewedIds:a.join(","),isAlsoViewed:b},evalScripts:true,method:"get"}).send()},500)}}},shouldSendPackagesRequest:function(){var a=$$(".packages").length>0;return a},hasPackagesReturned:function(){return this.hasPackagesResults()||this.hasPackagesNoResults()},hasPackagesResults:function(){return $$("#QUICK_CHECK_LB_PACKAGES .checking_sites").length>0},hasPackagesNoResults:function(){return ta.id("PACKAGES_NO_RESULTS")!=null},isPackagesShowing:function(){var a=ta.id("QUICK_CHECK_LB_PACKAGES");return a&&a.hasClass("show_section")},hasVRCrossSell:function(){return ta.id("VR_CROSS_SELL")!=null},transitionToPackages:function(){this.showPackages.delay(this.getDelaySecs(),this,true)},fireCallCountEvent:function(a){ta.trackEventOnPage("checkRates","packages","callCount",a,true)},handlePackages:function(a,d){this.checkMoreData.packages.set("html",a);var b=ta.id("PACKAGES_REQUERY_KEY");if(b){var c=b.get("value");if(d<20){this.fireCallCountEvent(d+2);setTimeout(function(){new Request({url:c,onSuccess:function(f){try{ta.commerce.checkrates.handlePackages(f,d+1)}catch(g){ta.util.error.record(g,"hotel packages - handlePackages")}},onFailure:function(e){ta.util.error.record(e.responseText,"hotel packages - requery to /ExpediaPackagesAjax")},evalScripts:true,method:"get"}).send()},1000)}}else{if(!ta.id("CHECK_MORE_SITES_LB")){setTimeout(function(){if(!ta.id("AVLB_HERO_PHOTOS")&&$$("#ALSO_VIEWED_PACKAGES .checking_sites")&&$("ALSO_VIEWED_AD")&&$("ALSO_VIEWED_AD").getSize().x>0){$$("#ALSO_VIEWED_PACKAGES .checking_sites").addClass("withAd")}var f=ta.id("ALSO_VIEWED_PACKAGES");if(f&&!ta.commerce.checkrates.hasPackagesNoResults()){f.show()}else{var e=ta.id("VR_CONTAINER");if(e){e.show()}}},2000)}}},showPackagesLoop:function(a){try{if(this.hasPackagesNoResults()){if(this.hasVRCrossSell()){this.showVR()}return}var b=ta.id("QUICK_CHECK_LB_PACKAGES");if(b&&b.hasClass("show_section")){return}if(this.hasPackagesReturned()&&!this.hasPackagesNoResults()){this.showPackages(false)}else{if(a==0){return}else{this.showPackagesLoop.delay(1000,this,a--)}}}catch(c){ta.util.error.record(c,"hotel packages - showPackagesLoop")}},showPackages:function(b){try{var c=$$(".packages")[0];var a=$$(".packages .checking_sites")[0].getSize().y;c.addClass("show_section");c.removeClass("hide_section");var f=new Fx.Tween(c,{duration:"long",property:"height"});f.start(0,a);if(b){f.addEvent("complete",this.transitionToAlsoViewed.bind(this))}}catch(d){ta.util.error.record(d,"hotel packages - showPackages");if(b){this.showAlsoViewed()}}},packagesClick:function(){try{var v="ExpediaPackageMeta2";var a=ta.id("hiddenReferrer");var h=ta.id("hiddenOrigin");var k=ta.id("hiddenDestination");var c=ta.id("hiddenPercentageSaved");var g=ta.id("hiddenGeo");var f=a.get("value");var w=h.get("value");var s=k.get("value");var y=g.get("value");var q=parseFloat(c.get("value"));var u=$$(".packages .savings");var l=u&&u.length>0?true:false;var r="Expedia";var j=ta.id("hiddenSource");if(j){r=j.get("value")}var m=ta.id("CHECK_MORE_SITES_LB")!=null;var b="";var o="";if(m&&l){b="QC_AlsoViewed_Packages1a";o="16221"}else{if(m){b="QC_AlsoViewed_Packages1b";o="16222"}else{if(l){b="QC_AlsoViewed_Packages2a";o="16269"}else{b="QC_AlsoViewed_Packages2b";o="16270"}}}if(r=="Orbitz"){b+="ORB"}var d="";if(q<7.5){d=1}else{if(q<10){d=2}else{if(q<12.5){d=3}else{if(q<15){d=4}else{d=5}}}}var p=window.open("about:blank","packages","width=800,height=600,scrollbars=1");ta.trackAttemptedCommerce("packages",b,v,d);new Request.JSONP({url:"/CheapFlightsCommerce",callbackKey:"jsonp",data:{AirProvider:v,from:f,area:b,slot:d,cnt:"1",Orig:w,Dest:s,geo:y,pid:o},onSuccess:function(z){try{var B=ta.id("hiddenDetailsUrl");if(B){var A=B.get("value");if(typeof(z)!="undefined"&&z!=null){if(typeof(z.icmcid)!="undefined"&&z.icmcid){A+="&icmcid="+z.icmcid}if(typeof(z.icmdtl)!="undefined"&&z.icmdtl){A+="&icmdtl="+z.icmdtl}}p.location=A}}catch(C){ta.util.error.record(C,"hotel packages - commerceClickCallback")}},method:"get"}).send()}catch(t){ta.util.error.record(t,"hotel packages - packagesClick")}return false},avafState:0,avafTimer:null,avafMoreExpandedSize:0,avafIn:function(c,a){try{if(ta.commerce.checkrates.avafState!=0){return}if(a==0){ta.commerce.checkrates.avafExpand()}else{ta.commerce.checkrates.avafWait(c,a)}}catch(b){ta.util.error.record(b,"also viewed - avafIn")}},avafWait:function(c,a){try{ta.commerce.checkrates.avafState=1;ta.commerce.checkrates.avafTimer=setTimeout(function(){ta.commerce.checkrates.avafExpand(c)},a)}catch(b){ta.util.error.record(b,"also viewed - avafWait")}},avafOut:function(d){try{if(ta.commerce.checkrates.avafState!=1){return}if(ta.commerce.checkrates.avafTimer==null){return}if(!d){d=window.event}if(!d){return}var a=(d.relatedTarget)?d.relatedTarget:d.toElement;var c=ta.id("ALSO_VIEWED_LIST");while(a&&a!=c&&a.nodeName!="BODY"){a=a.parentNode}if(a==c){return}clearTimeout(ta.commerce.checkrates.avafTimer);ta.commerce.checkrates.avafTimer=null;ta.commerce.checkrates.avafState=0}catch(b){ta.util.error.record(b,"also viewed - avafOut")}},avafExpand:function(c){try{this.actionRecord("AVAF_HOVER_EXPAND");ta.commerce.checkrates.avafState=2;var a=ta.id("expand_av_on_hover");if(!a){return}a.removeClass("hidden");a.addClass("expanding");var f=a.getSize().y;a.removeClass("expanding");a.addClass("show");var d=new Fx.Tween(a,{duration:"long",property:"height"});d.start(0,f)}catch(b){ta.util.error.record(b,"also viewed - avafExpand")}},avafMore:function(d,b){try{this.actionRecord("AVAF_EXPAND_"+(b?"MORE":"LESS"));if(b){var a=ta.id("hideableMore");if(!a){return}a.addClass("hidden");a=ta.id("expand_av_on_more");if(!a){return}a.removeClass("hidden");if(ta.commerce.checkrates.avafMoreExpandedSize==0){a.addClass("expanding");ta.commerce.checkrates.avafMoreExpandedSize=a.getSize().y;a.removeClass("expanding")}a.addClass("show");new Fx.Tween(a,{duration:"long",property:"height"}).start(0,ta.commerce.checkrates.avafMoreExpandedSize)}else{var a=ta.id("expand_av_on_more");if(!a){return}new Fx.Tween(a,{duration:"long",property:"height"}).start(a.getSize().y,0).chain(function(){a.removeClass("show");a.addClass("hidden");var e=ta.id("hideableMore");if(!e){return}e.removeClass("hidden")})}}catch(c){ta.util.error.record(c,"also viewed - avafMore")}},showUncheckedProviders:function(){var d=this.checkMoreData.uncheckedProviders;var b=this.checkMoreData.alsoViewed;var c=ta.retrieve("vrCrossSellNew");if(d){var a=d.getSize().y;d.addClass("show_section");d.removeClass("hide_section");var e=new Fx.Tween(d,{duration:"long",property:"height"});e.start(0,a);if(this.hasPackagesResults()){e.addEvent("complete",this.transitionToPackages.bind(this))}else{if(b&&!c){e.addEvent("complete",this.transitionToAlsoViewed.bind(this))}else{e.addEvent("complete",this.transitionToVR.bind(this))}}}},actionRecord:function(a){new Request({url:"/ActionRecord?action="+a}).send()},transitionToAlsoViewed:function(){this.showAlsoViewed.delay(this.getDelaySecs(),this)},showAlsoViewed:function(){var a=this.checkMoreData.alsoViewed;var c=ta.retrieve("vrCrossSellNew");if(a){var b=a.getSize().y;a.addClass("show_section");a.removeClass("hide_section");var f=new Fx.Tween(a,{duration:"long",property:"height"});f.start(0,b);try{if(!this.isPackagesShowing()){if(this.shouldSendPackagesRequest()){f.addEvent("complete",this.showPackagesLoop.bind(this,10))}else{if(!c){f.addEvent("complete",this.transitionToVR.bind(this))}}}}catch(d){ta.util.error.record(d,"hotel packages - shouldSendPackagesRequest")}}},transitionToVR:function(){if(this.checkMoreData.VR){if(screen.height>=768){this.showVR.delay(2000,this)}else{this.actionRecord("VR_CROSS_SELL_SMALL_SCREEN")}}},showVR:function(){var b=this.checkMoreData.VR;var a=this.checkMoreData.alsoViewed;var d=ta.retrieve("vrCrossSellNew");if(b){var c=b.getSize().y;b.addClass("show_section");b.removeClass("hide_section");var e=new Fx.Tween(b,{duration:"long",property:"height"});e.start(0,c);ta.overlays.Factory.recordVRCrossSell();if(a&&d){e.addEvent("complete",this.transitionToAlsoViewed.bind(this))}}},recordClose:function(){if(ta.has("pav.overlay")){ta.retrieve("pav.overlay").hide()}this.actionRecord("CheckMore_Close")},buildURLForQuickCheckData:function(c,o,m){var j=c.getUserData();var f="";j=ta.retrieve("checkrates.avUserData");var p=m||c.getVendorSet().getCheckedInfo(o);if(p){f="&vendorsChecked="+p.vendorsChecked+"&vendorsOpened="+p.vendorsOpened+"&vendorsHidden="+p.vendorsHidden;if(ta.commerce.checkrates.isAvailCheckTest()){try{var a=c.getAvailVendorSet().getCheckedInfo("unavail_set");var b=c.getOriginalVendorSet().getCheckedInfo("unchecked");f="&vendorsChecked="+p.vendorsChecked+"&vendorsOpened="+a.vendorsOpened+"&vendorsHidden="+p.vendorsHidden+"&vendorsAvailable="+a.vendorsAvailable+"&vendorsUnchecked="+b.vendorsUnchecked}catch(h){}}}var d=pageServlet;if(crPageServlet){d=crPageServlet}if(!d){d="unknown"}var q="&avLocId=";var g=ta.retrieve("checkrates.avId");if(g){q+=g}else{q+=c.vendorSetId}var l="QC_Button";var k=false;if(k=c.trigger.className.match(/custom_area_(\w+)/)){l=k[1]}return"detail="+c.vendorSetId+"&storedUserData="+encodeURIComponent(j)+f+"&a="+l+"&s="+d+"&av=true"+q},removePCR:function(){var a=ta.retrieve("pcr.overlay");if(a){a.hide()}},popBlock:function(h){try{if(h.trigger.className.match(/custom_area_QC_Inline_Geo/)&&!(crPageServlet=="Hotel_Review"||crPageServlet=="ShowUserReviewsHotels")||h.trigger.className.match(/custom_area_QC_AlsoViewed_Popup/)){return}}catch(g){ta.util.error.record(g,"popBlock - could not check criteria")}try{if(h.isLimitChecked&&!ta.has("checkrates.limit_checked_ie_no_cleanup")){var j=ta.popups.PopUtil.getHoldingWindowSet();while(j.length){var f=j[j.length-1].windowObject;f.close();f=null;j.pop()}}}catch(g){ta.util.error.record(g,"cr close excess holding windows")}h.getVendorSet().storeCheckBoxValues();var a=h.getVendorSet().getCheckedInfo("check_more");var b="/CheckMore?"+this.buildURLForQuickCheckData(h,"check_more",a);var d=h.getOriginalVendorSet().getVendorsUnchecked();var c=h.getOriginalVendorSet().getVendorsDefaultUnchecked();if(!ta.has("force_popup_to_check_more")){if(this.inTest(h,"cmAVTest")&&a&&a.vendorsChecked&&a.vendorsOpened&&((!h.isLimitChecked&&a.vendorsChecked==a.vendorsOpened)||(h.isLimitChecked&&(a.vendorsChecked==a.vendorsOpened)&&!d.length))||(ta.has("checkrates.limit_checked_w_unchecked_excluded")&&(a.vendorsChecked==a.vendorsOpened)&&(d.join("")==c.join("")))){if(!ta.has("checkrates.commerce_drop_to_bottom")){this.launchAVLBTest(h)}else{this.launchLeaveBehind.delay(h.lbDelay,this,["avlb",h])}return}if(/avLightboxSwap/.test(h.trigger.className)){if(!ta.has("checkrates.commerce_drop_to_bottom")){this.launchAVLBTest(h)}else{this.launchLeaveBehind.delay(h.lbDelay,this,["avlb",h])}return}}if(h.type=="checkdeals"){b="ABS:vpages/quickcheckdeals_ie.html"}if(!ta.has("checkrates.commerce_drop_to_bottom")){ta.run("ta.overlays.Factory.loadCheckMoreOverlay",{},h,b)}else{this.launchLeaveBehind.delay(h.lbDelay,this,["checkmore",h,b])}},launchLeaveBehind:function(b,c,a){if(b=="avlb"){this.launchAVLBTest(c)}else{if(b=="checkmore"){ta.run("ta.overlays.Factory.loadCheckMoreOverlay",{},c,a)}}this.addBoomerangTag(c)},daodaoPopTPW:function(o,g,u,s){var l=new ta.commerce.CheckRatesData({type:s,evnt:o},g,u,true);if(!l.validate()){return false}var m=l.getVendorSet().getVendors();var c=0;for(var p=0;p<m.length;p++){var j=m[p];if(j.isChecked()&&j.isAvailable()){c=p;j.opened=true;break}}var t=m[c];var q="daodaoTPW";var d=ta.retrieve("daodaoTPW");var k="/DaoDaoTabbedProviderWindow?first="+t.name+"&locId="+u+"&"+l.getUserData();try{if(d!=null){try{d.windowObject=window.open(k,q,"left=0,top=0,width="+screen.width+",height="+screen.height);d.windowObject.focus()}catch(r){ta.util.error.record(r,"daodao pop tpw one - reuse popup");return false}}else{var h=ta.popups.PopUtil.getHoldingWindowSet();var a=screen.width;if(h.length>0){d=h[h.length-1].repurpose(k,a)}else{var f=1;try{if(window.chrome){f=0}}catch(r){}var b={customWidth:a,customHeight:screen.height,name:q,url:k,scrollbars:f,left:0,top:0};d=ta.popups.PopUtil.createCheckRatesWindow(b)}}}catch(r){ta.util.error.record(r,"pop tpw - general");return false}if(d&&d.windowObject){ta.store("daodaoTPW",d);return d}return false},updateInlineFormElementRadio:function(d){var a=d.getElement("input[type=radio]");if(a){var e=a.id.substring(a.id.length-4);if(this.crSyncExtensions.contains(e)){var b=a.id.substring(0,a.id.length-4);var c=ta.id(b);if(c){c.checked=a.checked;var f=$$("#CHECK_RATES_CONT_SYNC form")[0];if(f){var g=f.getElement("#"+b+"_icr");g.checked=c.checked}}}else{var b=a.id;var c=ta.id(b);this.crSyncExtensions.each(function(j){var h=b+j;h=ta.id(h);if(h){h.checked=c.checked}})}}},popOne:function(a,c){try{if(a.options.trackClick){var h=new Element("img",{src:a.options.trackClick,height:1,width:1,styles:{position:"absolute",bottom:0,left:0}});document.body.appendChild(h)}if(a.hasWindow()){try{var f=a.window;f.windowObject=window.open(a.getUrl(c),f.name,f.winArgs);f.windowObject.focus()}catch(j){ta.util.error.record(j,"pop one - reuse popup");return false}}else{var k=a.name;var l=ta.popups.PopUtil.getProviderWindowDims(k,true);var g=ta.popups.PopUtil.getHoldingWindowSet();if(g.length>0&&c.useHoldingWin){a.window=g[g.length-1].repurpose(a.getUrl(c),l.customWidth,l.customHeight);if(c.skipHoldingWin){c.useHoldingWin=false}if(ta.has("checkrates.add_holding_windows")){if(a.window.type==ta.popups.PopUtil.windowType.CHECK_RATE){var d=ta.popups.PopUtil.getHoldingWindowSet().length;var b=window.cookieDomain;if(b){if(d>0){Cookie.write("CommercePopunder","HW"+d,{domain:b,duration:0})}else{Cookie.dispose("CommercePopunder",{domain:b})}}}}}else{var o=1;try{if(window.chrome){o=0}}catch(j){}var l=ta.popups.PopUtil.getProviderWindowDims(k,false);var m={customWidth:l.customWidth,customHeight:l.customHeight,widthOffset:l.widthOffset,heightOffset:l.heightOffset,name:k,url:a.getUrl(c),scrollbars:o};a.window=ta.popups.PopUtil.createCheckRatesWindow(m)}}}catch(j){ta.util.error.record(j,"pop one - general");return false}if(a.window&&a.window.windowObject){a.opened=true;return a.window}return false},addBoomerangTag:function(f){var a={};var b=ta.id("checkIn_"+f.vendorSetId);var e=ta.id("checkOut_"+f.vendorSetId);var d=ta.id("qcAdults_"+f.vendorSetId);if(!(b&&e&&d)){b=ta.id("checkIn_"+f.vendorSetId+"_pop");e=ta.id("checkOut_"+f.vendorSetId+"_pop");d=ta.id("qcAdults_"+f.vendorSetId+"_pop")}if(b&&e&&d){a.checkIn=b.value;a.checkOut=e.value;a.adults=d.value}else{return}var c={url:"/HotelCheckRates?Action=AddBoomerangTag",data:a};c.onSuccess=function(j,g){var h=ta.id("BOOMERANGTAG");if(!h){h=new Element("div",{id:"BOOMERANGTAG"});h.inject(document.body)}if(!h){return}h.innerHTML=j};new Request(c).send()},launchAVLBTest:function(c){var b=c.propId;if(pageServlet&&b&&window.cookieDomain!=".daodao.com"){var a="http://"+document.domain+"/AlsoViewedLB?d="+b+"&s="+pageServlet+"&"+c.getUserData()+"&checkRatesType=checkRates";if(ta.has("page.geo")){a+="&geo="+ta.retrieve("page.geo")}ta.run("ta.overlays.Factory.launchAVLBCompleteFn",{},a)}},openProviderWindowUrl:function(j,e,b,g){var h=ta.asInt("commerce.provWinNum");h++;ta.store("commerce.provWinNum",h);var a=ta.retrieve("commerce.previousTpwNumbers");var d=a+"_"+h;if(!a){d=h}var f="TAProviderWindow_"+d;j=j+"&otpwn="+d;var k=window.open(j,f,this.getProviderWinArgs(d));k.focus();ta.store("commerce.TPWindow",k);var c=(function(){try{if(k.closed){clearTimeout(c)}else{var m=k.location.href;window.status=m}}catch(l){clearTimeout(c);new Request({url:"/ActionRecord?action=fbProvWin|id_"+e+"|ctrId_"+b+"|cv_"+g}).send()}}).periodical(1500);return k},addCustomUrlParams:function(c,b){var d=new RegExp("(&|\\?)area=[^&]*");c=c.replace(d,"$1area="+b);if(crPageServlet){var a=new RegExp("(&|\\?)from=[^&]*");c=c.replace(a,"$1from=HotelDateSearch_"+crPageServlet)}return c},checkMoreClickRe:function(d,a,f,p){new Event(d).preventDefault();if(a){var h="QC_Button";var g=false;if(g=a.className.match(/custom_area_(\w+)/)){h=g[1]}var k=false;if(k=a.className.match(/custom_refer_(\w+)/)){crPageServlet=k[1]}var b=ta.id(a).hasClass("flightOffer");var j;if(b){j=a.href+"&"+ta.retrieve("checkrates.flightData")}else{var c=ta.retrieve("checkrates.avUserData");j=this.addCustomUrlParams(a.href,h)+"&"+c}var o=1;try{if(window.chrome){o=0}}catch(d){}var l=ta.popups.PopUtil.getProviderWindowDims(f,false);var m={customWidth:l.customWidth,customHeight:l.customHeight,widthOffset:l.widthOffset,heightOffset:l.heightOffset,name:f,url:j,scrollbars:o};var q=ta.popups.PopUtil.createCheckRatesWindow(m)}},checkMoreClick:function(D,s,B,E,g,a){new Event(D).preventDefault();if(s){if(a){ta.commerce.checkrates.showLoading(s.id)}var A="QC_Button";var F=false;if(F=s.className.match(/custom_area_(\w+)/)){A=F[1]}var k=false;if(k=s.className.match(/custom_refer_(\w+)/)){crPageServlet=k[1]}var f=ta.id(s).hasClass("flightOffer");var m;if(f){m=s.href+"&"+ta.retrieve("checkrates.flightData")}else{var q=ta.retrieve("checkrates.avUserData");m=this.addCustomUrlParams(s.href,A)+"&"+q}var p=1;try{if(window.chrome){p=0}}catch(D){}var z=ta.popups.PopUtil.getProviderWindowDims(B,false);var h={customWidth:z.customWidth,customHeight:z.customHeight,widthOffset:z.widthOffset,heightOffset:z.heightOffset,name:B,url:m,scrollbars:p};var l=ta.popups.PopUtil.createCheckRatesWindow(h);if(l&&a){ta.commerce.checkrates.showArrow(s.id)}if(f){ta.id(s).removeClass("sprite-findflights_ylwCnr").addClass("sprite-findflights_ylwCnrChk")}else{ta.id(s).removeClass(E).addClass(g)}if(ta.id(s).getParent("#QUICK_CHECK_LB_PARTNERS")){var G=0;var b=0;var u=document.id("QUICK_CHECK_LB_PARTNERS");var C=u.getElements(".unClickedCount");C.each(function(e){if(ta.id(e).hasClass(E)){G++}if(ta.id(e).hasClass(g)){b++}},this);if(a){if(b>1){var o=document.getElement(".chkOpenedSitesDesc");var y=document.getElement(".oneMoreOpened");ta.id(o).removeClass("hideOne");ta.id(y).addClass("hideOne")}var w=document.getElement(".cs_ps .openedSites");w.innerHTML=b}if(G<1){var v=ta.id("emptyAlsoViewed");if(v){var c=ta.retrieve("overlays.current");if(c){c.hide();ta.remove("overlays.current")}}else{var r=document.getElement(".chkSitesDesc");if(r){r.addClass("hideOne")}var d=document.getElement(".oneMore");if(d){d.addClass("hideOne")}}return}else{if(G<2){var r=document.getElement(".chkSitesDesc");if(r){r.addClass("hideOne")}var d=document.getElement(".oneMore");if(d){d.removeClass("hideOne")}}else{var j=document.getElement(".cs_ps .opnSites");j.innerHTML=G}}}if(window.cookieDomain==".daodao.com"){if(ta.id(s).getElements("span")[0].hasClass("show-price-org")){ta.id(s).getElements("span")[0].removeClass("show-price-org").addClass("show-price-black")}var t=ta.id(s).getParent("li").getParent("ul").getElements(".show-price-org").length;ta.id("remainingCount").set("html",t)}}},showProviders:function(){if(this.validateDates()){var a=$$("div.geoProviderHidden");if(a){a.removeClass("geoProviderHidden");a.addClass("geoProvider")}var c=ta.id("HotelDateSearch")||ta.id("HotelDateSearch_icr");if(c){var b=c.getElement("span.error_msg_geo");if(b){b.hide()}}}},validateDates:function(){var b=ta.id("checkIn_"+this.geoId)||ta.id("checkIn_"+this.geoId+"_icr");var e=ta.id("checkOut_"+this.geoId)||ta.id("checkOut_"+this.geoId+"_icr");if(!b||!e||!b.value||!e.value){return false}var d=this.parseDate(b.value);var c=this.parseDate(e.value);var a=this.dateErrorCheck(d);var f=this.dateErrorCheck(c);if(a&&f){return true}else{return false}},parseDate:function(b){var d=false;if(DATE_FORMAT&&b){var c=b.match(DATE_FORMAT.pattern);if(c){var e=parseInt(c[DATE_FORMAT.date].replace(/^0/,""));var a=parseInt(c[DATE_FORMAT.month].replace(/^0/,""));var f=parseInt(c[DATE_FORMAT.year].replace(/^0/,""));if(e>0&&e<32&&a>0&&a<13){if(e<10){e="0"+e}if(a<10){a="0"+a}if(f<100){f+=2000}d=new Date(a+"/"+e+"/"+f)}}}return d},dateErrorCheck:function(c){if(!c||isNaN(c)){return false}var b=new Date();b.setHours(0,0,0,0);var a=new Date(b.getFullYear(),b.getMonth(),b.getDate()+330);if(c.getTime()<b.getTime()){return false}if(a.getTime()<c.getTime()){return false}return true},updateHiddenDateFields:function(f,b){var e=this.parseDate(b.value);var a=this.dateErrorCheck(e);if(a&&typeof(a)=="string"){if(a.replace(/^\s+|\s+$/g,"").length>0){alert(a)}return}if(window.cookieDomain==".daodao.com"){var c=ta.id("HotelDateSearch");if(c&&c.hasClass("show-meta-prices")){ta.run("dd.hotels.halfmeta.showDaoDaoMetaPrices")}}var d=ta.id(b).overlay;if(d&&d.calendar){d.calendar.select(null,e)}},crSyncExtensions:new Array("_pop","_icr","_pto","_per","_amo","_cro","_met"),_showSuppressedProviders:function(a){if(ta.retrieve("checkrates.datesChanged")){return}try{var b=ta.id(a);b.getElements(".unavailable").each(function(d){d.removeClass("unavailable");if(d.hasClass("js_ua_checked")){d.getElements("input").set("checked",true)}ta.commerce.checkrates.updateCRFormElement(d)});ta.store("checkrates.datesChanged",true)}catch(c){ta.util.error.record(c,"_showSuppressedProviders")}},findInlineCRLocationId:function(){var e=null;var f=ta.id("HotelDateSearch");if(f){var a=f.getElements("input[type=text]");for(var d=a.length;d--;){var b=a[d];var c=b.id.match(/_(\d+)/);if(c.length){e=c[1];break}}}return e},updateCRCalendar:function(c){if(c.form){ta.commerce.checkrates._showSuppressedProviders(c.form)}try{var b=c.before;var a=b.dayField;if(a&&/qcInDay_(\d+)/.test(a.id)){ta.commerce.checkrates.checkCRLimits(RegExp.$1)}}catch(d){ta.util.error.record(d,"update cal crLimits check")}ta.commerce.checkrates.updateCRFormElement(this)},checkCRLimits:function(g){try{if(!g){return}var d=new Date();var p=document.getElement('input[id*="qcInDay_'+g+'"]').value;var q=document.getElement('input[id*="qcInMonth_'+g+'"]').value;q=q.split("/");d.setDate(p);d.setMonth(q[0]-1);d.setFullYear(q[1]);var o=ta.retrieve("checkrates.vendors."+g);for(var h=0;h<o.length;h++){var m=o[h];if(m.hasDateLimits()){var c='input[id*="'+m.options.checkboxID+'"]';var f=document.getElement(c);if(f){var l=true;var b;var a=m.options.minDaysOut;if(a>0){b=new Date();b.setDate(b.getDate()+a);l=(d>=b)}var k=m.options.maxDaysOut;if(k>0&&l){b=new Date();b.setDate(b.getDate()+k);l=(d<=b)}f.getParent("li").style.display=(l?"block":"none")}}}}catch(j){ta.util.error.record(j,"check crLimits")}},updateCRFormElement:function(f){try{f=ta.id(f);var o=f.get("tag").toLowerCase();if(o=="li"){f=f.getElement("input[type=checkbox]")}var g=f.id.split("_")[0];var j=this.findInlineCRLocationId();var m=g+"_"+j;var d=f.id;var b=d.substring(d.length-4);var r=[m,m+"_icr",m+"_per",m+"_met"];if(this.crSyncExtensions.contains(b)){for(var h=r.length;h--;){var m=r[h];if(m!=d){var q=ta.id(m);if(q){if(o=="li"&&b!="_pop"){q.checked=f.checked;var p=f.getParent("li");if(p&&!p.hasClass("unavailable")){var c=q.getParent("li");if(c){c.removeClass("unavailable")}}}else{if(o=="select"){q.selectedIndex=f.selectedIndex}else{if(o=="input"){var a=f.form;if(window.cookieDomain==".daodao.com"){if(a.hasClass("show-meta-prices")){ta.run("dd.hotels.halfmeta.showDaoDaoMetaPrices")}}var l=m.substring(m.length-4);if(!this.crSyncExtensions.contains(l)){l=""}this.updateCRFormElement_In(j,f,b,l)}}}}}}}}catch(k){ta.util.error.record(k,"updateCRFormElement")}},updateCRForm:function(a){try{var r=ta.id("HotelDateSearch"+a);var q=ta.id("HotelDateSearch");var f=["select","input[type=checkbox]","input[type=hidden]","input[type=text]"];if(r&&q){for(var l=f.length;l--;){var c=f[l];var t=q.getElements(c);var d=r.getElements(c);for(var h=d.length;h--;){var s=d[h];var p=s.id.split("_")[0];for(var g=t.length;g--;){var o=t[g];if(o.id.contains(p)){if(c=="input[type=checkbox]"){var u=o.getParent("li");if(u&&!u.hasClass("unavailable")){var b=s.getParent("li");if(b){b.removeClass("unavailable")}}}if(c=="select"){s.selectedIndex=o.selectedIndex}else{if(c=="input[type=checkbox]"&&a!="_pop"){s.checked=o.checked}else{if(!s.id.contains("hacPid")){s.value=o.value}}}}}}}}}catch(m){ta.util.error.record(m,"updateCRForm")}},updateCRFormElement_In:function(l,t,o,q){try{var m=t.id.match(/_(\d+)/)[1];var c=ta.id("checkIn_"+l+q);var b=ta.id("checkOut_"+l+q);var p=ta.id("checkIn_"+m+o);var j=ta.id("checkOut_"+m+o);var f=ta.id("qcInDay_"+l+q);var r=ta.id("qcOutDay_"+l+q);var g=ta.id("qcInDay_"+m+o);var d=ta.id("qcOutDay_"+m+o);var h=ta.id("qcInMonth_"+l+q);var u=ta.id("qcOutMonth_"+l+q);var k=ta.id("qcInMonth_"+m+o);var a=ta.id("qcOutMonth_"+m+o);if(c&&p&&b&&j&&f&&g&&r&&d&&h&&k&&u&&a){c.value=p.value;b.value=j.value;f.value=g.value;r.value=d.value;h.value=k.value;u.value=a.value}}catch(s){ta.util.error.record(s,"updateCRFormElement_In")}},availCheck:function(b){var a=ta.id("availability")&&ta.id("availability").value=="1";var d=ta.id(b).getElement(".overlaySrc");if(a&&d){var c=d.innerHTML;d.innerHTML=c.replace(/cid=(\w+_)?&amp;/,"")}},positionCheckRates:function(){try{var j=window.getScroll();var l=false;try{l=window.location.href}catch(h){}if(l){var f=ta.retrieve("pcr.initialUrl");if(!f){f=l;ta.store("pcr.initialUrl",f)}if(f!=l){ta.store("pcr.initialYPos",j.y);ta.store("pcr.initialUrl",l)}}var d=true;var a=ta.retrieve("pcr.initialYPos");if(a&&a>0){d=(Math.abs(a-j.y)>=100)}var b=j.y>=ta.retrieve("pcr.scrollPoint")&&d;var c=$$(".overlayBG");if(b&&!ta.retrieve("pcr.overlay").visible&&!ta.has("pcr.keepHidden")&&!c.length){ta.store("pcr.initialYPos",-1);if(typeof(persistentCRCss)!="undefined"&&!ta.retrieve("ta.persCrCssAsset")){ta.store("ta.persCrCssAsset",Asset.css(persistentCRCss))}ta.retrieve("pcr.overlay").show();ta.commerce.checkrates.updateCRForm("_per");if(!ta.id("PERSISTENT_CHECK_RATES_WRAP").hasClass("pcrStatic")){ta.retrieve("pcr.overlay").container.set("tween",{duration:"300",transition:"bounce:out"});ta.retrieve("pcr.overlay").container.setStyle("margin-top",-125);ta.retrieve("pcr.overlay").container.tween("margin-top",0)}var g=ta.id("PERSISTENT_CHECK_RATES_WRAP").getParent();if(!g.getElement(".gradient")){var k=new Element("div.gradient");k.inject(g,"bottom")}if(!ta.retrieve("pcr.firstShow")){ta.trackEventOnPage("PersistentCheckRates","shown","",1,true);ta.store("pcr.firstShow",true)}}else{if(!b&&ta.retrieve("pcr.overlay").visible){ta.retrieve("pcr.overlay").hide()}}}catch(h){window.removeEvent("scroll",ta.commerce.checkrates.positionCheckRates);ta.util.error.record(h,"pcr - positionCheckRates");return false}},_updateSecondaryFormElement_CB:function(){var a=ta.id("CHECK_RATES_CONT");if(a){var b=a.getElements("input.chk");b.each(function(f,d){var e=ta.id(f.id+"_pop");var c=ta.id(f.id+"_per");if(e){e.checked=f.checked}if(c){c.checked=f.checked}})}},availCheckQuery:function(d,b,a,c,f,e){new Request.JSON({url:"/AvailabilityCheckJson",method:"get",data:{checkin:d,checkout:b,adults:a,country:f,geo:e,action:c},onSuccess:function(h,g){if(c&&c=="peek"){ta.store("availability_check",h)}}}).send()},isAvailCheckTest:function(){if(!ta.has("avail.check.test")){var a=ta.id("CHECK_RATES_CONT");if(a&&a.hasClass("avail_check")){ta.store("avail.check.test",true)}else{ta.store("avail.check.test",false)}}return ta.retrieve("avail.check.test")},triggerAvailCheck:function(g){try{if(ta.commerce.checkrates.isAvailCheckTest()){var d=ta.id("CHECK_RATES_CONT");var k=ta.commerce.checkrates.normalizeDate(d.getElement("input.checkIn").value);if(!k){return false}var a=new Date(k.getTime());a.setDate(k.getDate()+2);if(d.getElement("input.checkOut").value.match(/\d+/)){a=ta.commerce.checkrates.normalizeDate(d.getElement("input.checkOut").value);if(!a){return false}}var j="2";var h=d.getElement("select");if(h&&!isNaN(h.value)){j=h.value}var c="0";if(accomIdMatch=d.className.match(/did_(\d+)/)){c=accomIdMatch[1]}var l="191";if(countryIdMatch=d.className.match(/cid_(\d+)/)){l=countryIdMatch[1]}var b="peek";if(g){b="query";if(g=="before"){a.setDate(k.getDate()+2)}}ta.commerce.checkrates.availCheckQuery(ta.commerce.checkrates.tacDateFormat(k),ta.commerce.checkrates.tacDateFormat(a),j,b,l,c)}}catch(f){ta.util.error.record(f,"availability select date click")}},tacDateFormat:function(a){var c=a.getDate();var d=a.getMonth();d=d+"";if(d.length<2){d="0"+d}var b=a.getFullYear();return b+"-"+d+"-"+c},normalizeDate:function(b){if(!b||typeof b!="string"){return false}try{var c=b.match(DATE_FORMAT.pattern);if(c){var f=parseInt(c[DATE_FORMAT.date].replace(/^0/,""));var a=parseInt(c[DATE_FORMAT.month].replace(/^0/,""));var g=parseInt(c[DATE_FORMAT.year].replace(/^0/,""));if(f>0&&f<32&&a>0&&a<13){if(g<100){g+=2000}return new Date(g,a,f)}else{return false}}else{return false}}catch(d){}return false},availCheckChangeDates:function(){try{document.getElement(".overlay").overlay.hide()}catch(a){ta.util.error.record(a,"availCheckChangeDates")}},openMetaProvider:function(a,b,e,j){if(!b||!a){return}if(a.target.src){var k=a.target.src;if(k.contains("expandActive")){var g="ta.commerce.checkrates.isExpanded."+e+"."+j;ta.store(g,true);b.addClass("partnerExpanded").removeClass("partnerCollapsed");ta.store("ta.commerce.MetaHacOverlay.crData",c);return}else{if(k.contains("contract")){var g="ta.commerce.checkrates.isExpanded."+e+"."+j;ta.store(g,false);b.addClass("partnerCollapsed").removeClass("partnerExpanded");return}}}if(j){var c=ta.retrieve("ta.commerce.MetaHacOverlay.crData");var f=false;if(c){f=c.getVendorSet()}if(f){var h=f.getVendors();for(var d=0;d<h.length;d++){if(j==h[d].getContentID()){window.open(h[d].getUrl(c));return}}}}},openMetaHacOverlay:function(a){var b=a.getVendorSet().getCheckedContentID();ta.store("ta.commerce.MetaHacOverlay.crData",a);ta.run("ta.overlays.Factory.metaCheckRatesOverlay",{},a,b)},buildMetaHacUrl:function(c,l,m){var k=false;if(/custom_area_(\S+)\s/.test(c.trigger.className)){k=RegExp.$1}var b=c.getUserData();if(!b){var j=ta.id("META_HAC_DATE_SELECTOR");if(!j){return}var q=j.getElement(".chk-in .month"),d=j.getElement(".chk-in .day"),g=j.getElement(".chk-out .month"),s=j.getElement(".chk-out .day"),r=j.getElement(".adults select");if(!q||!d||!g||!s||!r){return}var o=q.value.split(/\//),f=g.value.split(/\//),p=new Date(o[1],o[0]-1,d.value),h=new Date(f[1],f[0]-1,s.value);var e=[];e.push("inMonth=");e.push(o[0]);e.push("%20");e.push(o[1]);e.push("&inDay=");e.push(escape(d.value));e.push("&outMonth=");e.push(f[0]);e.push("%20");e.push(f[1]);e.push("&outDay=");e.push(escape(s.value));e.push("&adults=");e.push(r.selectedIndex+1);b=e.join("")}var a="/MetaCheckRatesAjax?detail="+c.vendorSetId+"&"+b+"&area="+k+"&checkedContentID="+l;if(m){a+="&finalRequest=true"}return a},metaHacRequest:function(h,d){var a=1000;var f=61;var b=ta.retrieve("metaCheckRatesOverlay");if(!h||!b){return}try{b.inner.innerHTML=ta.commerce.checkrates._setCollapseExpand(h,b.inner.innerHTML);if(ta.has("ta.commerce.checkrates.hacAttempt")){var c=ta.retrieve("ta.commerce.checkrates.hacAttempt");if(c>f){ta.store("ta.commerce.checkrates.hacAttempt",0);return}}else{var c=0;ta.store("ta.commerce.checkrates.hacAttempt",0)}if(!b.inner.innerHTML.contains("hacComplete")){setTimeout(function(){new Request({url:ta.commerce.checkrates.buildMetaHacUrl(h,d,true),onSuccess:function(e,j){if(ta.retrieve("metaCheckRatesOverlay")){e=ta.commerce.checkrates._setCollapseExpand(h,e);b.inner.innerHTML=e}ta.commerce.checkrates.updateMetaProviders(h);ta.store("ta.commerce.checkrates.hacAttempt",c+1);ta.commerce.checkrates.metaHacRequest(h,d)}}).send()},a)}else{ta.store("ta.commerce.checkrates.hacAttempt",0)}}catch(g){ta.util.error.record(g,"meta HAC - ajax requests")}},updateMetaProviders:function(c){var g=c.getVendorSet();var k=g.getVendors();for(var d=0;d<k.length;d++){var e=k[d].getContentID();var b=k[d].vendorName;var f=k[d].options.image;var h=ta.id("partner_"+e);if(h&&b){var a="";if(f&&f!=""){a='<div class="partnerImage"><img src="'+CDNHOST+"/img2/"+f+'" alt="'+b+'" width="82"></div>'}else{a='<div class="partnerName">'+b+"</div>"}h.innerHTML=a+h.innerHTML.replace(/@@partnerName@@/g,b)}}var l=document.getElement("#CHECK_RATES_CONT ul.provider");var j=document.getElement("#META_HAC_DATE_SELECTOR .providerContainer");if(l&&l.length>0&&j&&j.length>0){j[0].innerHTML=l[0].outerHTML}},showMetaDateSelector:function(){var b=ta.id("META_HAC_DATE_SELECTOR"),a=ta.id("META_HAC_ROOM_LIST");if(b){if(this.metaTimeout){clearTimeout(this.metaTimeout)}this.checkAllProviders();b.show();if(a){a.hide()}}},checkAllProviders:function(){var a=document.getElements('.provider input[type="checkbox"]');a.each(function(b){b.checked=true})},_setCollapseExpand:function(b,h){var l=b.getVendorSet().getVendors();var f=0;for(var e=0;e<l.length;e++){var k=l[e];var d=k.propertyId;var a=k.getContentID();var j="ta.commerce.checkrates.isExpanded."+d+"."+a;var c=ta.retrieve(j);if(d&&a){var g="collapseExpand_"+d+"_"+a;if(c){h=h.replace(g,"partnerExpanded")}else{h=h.replace(g,"partnerCollapsed")}}}return h}};ta.queueForLoad(function(){var c=false;try{c=window.location.href}catch(b){}if(c){var a=ta.retrieve("pcr.initialUrl");if(!a){a=c;ta.store("pcr.initialUrl",a)}}if(ta.browser.isIE10Metro()){ta.commerce.checkrates.checkAllProviders()}},"pcr.inititalUrl and metro check all providers");ta.common.flyout.memberOverlay=ta.overlays.Factory.memberOverlay;ta.common.flyout.intlPopup=ta.overlays.Factory.intlPopup;ta.common.flyout.showRecentLocationEmailOverlay=ta.overlays.Factory.showRecentLocationEmailOverlay;ta.common.flyout.clearRecentLocations=ta.overlays.Factory.clearRecentLocations;ta.commerce.checkrates.createPairedCalendar=ta.overlays.Factory.createPairedCalendar;ta.commerce.checkrates.pcrInit=ta.overlays.Factory.loadPCROverlay;ta.common.sendmessage.showSendMessage=ta.overlays.Factory.showSendMessage;ta.servlet.Hotel.showRoomTipsOverlay=ta.overlays.Factory.showRoomTipsOverlay;ta.servlet.Hotel.showReviewSummary=ta.overlays.Factory.showReviewSummary;ta.servlet.Hotel.showTranslationReviewSummary=ta.overlays.Factory.showTranslationReviewSummary;tamgShowLightbox=ta.overlays.Factory.tamgShowLightbox;ta.util.taLnk={mouseover:function(b){$(b).addClass("underline")},mouseout:function(b){$(b).removeClass("underline")}};var StringBuffer=new Class({initialize:function(a){this.strings=new Array();if(a){this.append(a)}},append:function(a){this.strings.push(a);return this},toString:function(){return this.strings.join("")},isEmpty:function(){return this.strings.length==0}});var Table=new Class({Implements:[Options],options:{properties:{cellpadding:0,cellspacing:0,border:0},rows:[]},initialize:function(a){this.setOptions(a);this.table=new Element("table").setProperties(this.options.properties);this.tbody=new Element("tbody").inject(this.table);this.options.rows.each(this.push.bind(this))},push:function(d,c,a){var b=new Element("tr").inject(c||this.tbody);d.each(function(e){var f=new Element(a?"th":"td").inject(b);if(e.properties){f.setProperties(e.properties)}if(e.content){f.setContent(e.content)}else{f.setContent(e)}});return this},pushHead:function(a){if(!this.thead){this.thead=new Element("thead").inject(this.table,"top")}this.push(a,this.thead,true);return this},pushFoot:function(a){if(!this.tfoot){this.tfoot=new Element("tfoot").inject(this.table)}this.push(a,this.tfoot);return this},pushCaption:function(a){new Element("caption").setContent(a).inject(this.table,"top");return this}});var TabSet=new Class({Implements:[Options,Events],options:{onActive:function(){},onBackground:function(){},show:0,collapsable:false},initialize:function(){var a,b,c;Array.each(arguments,function(f,e){switch(typeOf(f)){case"object":a=f;break;default:var d=$$(f);if(!b){b=d}else{c=d}}});this.togglers=b||[];this.elements=c||[];this.setOptions(a);this.elements.each(function(e,d){this.togglers[d].addEvent("click",this.display.bind(this).partial(Function._,d));if(this.options.show===d){e.show();this.previous=d;this.fireEvent("onActive",[null,this.togglers[d],e])}else{e.hide()}},this)},display:function(b,a){if(this.options.collapsable&&a==this.previous){if(this.elements[a].isHidden()){this.fireEvent("onActive",[b,this.togglers[a],this.elements[a]]);this.elements[a].show()}else{this.fireEvent("onBackground",[b,this.togglers[a],this.elements[a]]);this.elements[a].hide()}return this}if(this.previous||this.previous===0){this.elements[this.previous].hide();this.fireEvent("onBackground",[b,this.togglers[this.previous],this.elements[this.previous]])}this.previous=a;this.elements[a].show();this.fireEvent("onActive",[b,this.togglers[a],this.elements[a]]);return this}});var ToggleSet=new Class({initialize:function(b,c,a){this.index=a||0;this.togglers=b||[];this.elements=c||[];this.togglers.each(function(e,d){this.togglers[d].addEvent("click",this.display.bind(this,d));this.elements[d].hide()},this)},add:function(c,b){var a=this.togglers.length;this.togglers.push(c);this.elements.push(b);c.addEvent("click",this.display.bind(this,a));b.hide()},expand:function(a){this.togglers[a].addClass("open");this.elements[a].show();return this},collapse:function(a){this.elements[a].hide();this.togglers[a].removeClass("open");return this},display:function(a){if(this.previous==a){if(this.elements[a].isHidden()){this.expand(a)}else{this.collapse(a)}}else{if(this.previous||this.previous===0){this.collapse(this.previous)}this.previous=a;this.expand(a)}return this}});var Slider=new Class({Implements:[Options,Events],Binds:["clickedElement","draggedKnob"],options:{onChange:function(){},onComplete:function(){},onTick:function(a){this.knob.setStyle(this.p,a)},mode:"horizontal",steps:100,offset:0},initialize:function(d,a,b){this.element=$(d);this.knob=$(a);this.setOptions(b);this.previousChange=-1;this.previousEnd=-1;this.step=-1;this.element.addEvent("mousedown",this.clickedElement);var c,f;switch(this.options.mode){case"horizontal":this.z="x";this.p="left";c={x:"left",y:false};f="offsetWidth";break;case"vertical":this.z="y";this.p="top";c={x:false,y:"top"};f="offsetHeight"}this.max=this.element[f]-this.knob[f]+(this.options.offset*2);this.half=this.knob[f]/2;this.getPos=this.element["get"+this.p.capitalize()].bind(this.element);this.knob.setStyle("position","relative").setStyle(this.p,-this.options.offset);var e={};e[this.z]=[-this.options.offset,this.max-this.options.offset];this.drag=new Drag(this.knob,{limit:e,modifiers:c,snap:0,onStart:this.draggedKnob(),onDrag:this.draggedKnob(),onComplete:function(){this.draggedKnob();this.end()}.bind(this)});if(this.options.initialize){this.options.initialize.call(this)}},set:function(a){this.step=a.limit(0,this.options.steps);this.checkStep();this.end();this.fireEvent("onTick",this.toPosition(this.step));return this},setDefault:function(a){if(a>this.options.steps){a=this.options.steps}else{if(a<0){a=0}}this.step=a;this.end();this.knob.setStyle(this.p,this.toPosition(this.step)+"px");return this},scrolledElement:function(a){if(a.wheel<0){this.set(this.step+1)}else{if(a.wheel>0){this.set(this.step-1)}}a.stop()},clickedElement:function(b){var a=b.page[this.z]-this.getPos()-this.half;a=a.limit(-this.options.offset,this.max-this.options.offset);this.step=this.toStep(a);this.checkStep();this.end();this.set(this.step)},draggedKnob:function(){if(!this.drag){return}this.step=this.toStep(this.drag.value.now[this.z]);this.checkStep();this.setDefault(this.step)},checkStep:function(){if(this.previousChange!=this.step){this.previousChange=this.step;this.fireEvent("onChange",this.step)}},end:function(){if(this.previousEnd!==this.step){this.previousEnd=this.step;this.fireEvent("onComplete",this.step+"")}},toStep:function(a){return Math.round((a+this.options.offset)/this.max*this.options.steps)},toPosition:function(a){return this.max*a/this.options.steps}});var rules={};var rulesN={};var ajaxRules={};var Behavior=new Class({register:function(b){this.rules=b;for(var a in this.rules){this.reload(a)}for(var c in rulesN){this.reloadN(c)}return this},reload:function(c){var a=$$(c);for(var d=0;d<a.length;d++){try{this.rules[c](a[d])}catch(b){ta.util.error.record(b,"rules",null,{element:ta.util.error.getSelectorString(a[d]),ruleCount:d})}}return a.length},reloadN:function(b){var a=0;while(n=ta.id(b+(a++))){rulesN[b](n)}return a-1},apply:function(a){processLinks(a);for(var b in this.rules){window.applyLastRule=b;a.getElements(b).each(function(c){this.rules[b](c)},this)}for(var b in ajaxRules){window.applyLastRule=b;a.getElements(b).each(function(c){ajaxRules[b](c)},this)}}});window.behavior=new Behavior();TAReadyEvent=window.TAReadyEvent||"domready";if(Browser.ie&&(typeof semHotelBoxFocus!="undefined")&&semHotelBoxFocus){ta.queueForLoad(behaviorFunction,"Behavior")}else{window.addEvent(TAReadyEvent,behaviorFunction)}var bfCount=0;function behaviorFunction(){if(typeof performancePingbackInit!="undefined"){performancePingbackInit.behaviorStart=new Number(new Date())}if(Browser.ie&&(!$("FOOT")||!$("FOOT").readyState||$("FOOT").readyState!="complete")&&bfCount<10){bfCount++;behaviorFunction.delay(30);return}if(window.hideOnLoad){Array.from(hideOnLoad).each(function(c){var b=$(c);if(b){b.hide()}})}if(!Browser.ie6){searchFocus()}processLinks(document);behavior.register(rules);var a=$("MAIN");if((window.location.hash=="#Calculator")&&($("HOMEPAGE")||(a&&a.hasClass("VacationRentals"))||$("HOTEL_LANDER"))){showDHTMLOverlayOnLoad=function(){};if(typeof vrCalculator!="undefined"){vrCalculator()}}if(typeof performancePingbackInit!="undefined"){performancePingbackInit.behaviorEnd=new Number(new Date());performancePingbackInit.domreadyTimeSet=true;checkAndSendPerformancePingback()}}function searchFocus(){var a=ta.id("mainSearch");if(a&&a.className.match(/\b(focusOnLoad)\b/)){try{a.focus()}catch(b){}}}function checkAndSendPerformancePingback(){if(typeof performancePingbackInit!="undefined"&&performancePingbackInit.enabled&&performancePingbackInit.domreadyTimeSet&&performancePingbackInit.loadTimeSet){var a=performancePingbackInit.behaviorStart-performancePingbackInit.start;var b=performancePingbackInit.loadEnd-performancePingbackInit.start;var d=performancePingbackInit.behaviorEnd-performancePingbackInit.behaviorStart;var c="/PerformancePingback?ppuid="+performancePingbackInit.uid+"&load="+b+"&domready="+a+"&behavior="+d+"&servlet="+performancePingbackInit.servlet;new Request({url:c}).send()}}function onPageLoaded(){if(typeof performancePingbackInit!="undefined"){performancePingbackInit.loadEnd=new Number(new Date());performancePingbackInit.loadTimeSet=true;checkAndSendPerformancePingback()}}window.addEvent("load",onPageLoaded);rulesN.EOBF=function(a){var b=a.innerHTML+"@tripadvisor"+a.title;new Element("a",{href:"mailto:"+b}).setContent(b).replaces(a)};var linkMap={};var popupIndex=0;function popup(s,u,p,m,h,g,b,d,c,r){try{new Event(s).preventDefault();var a="",l=this.className.match(/sz(\d+)x(\d+)/),k=ta.id(document.body),j,t,f;if(l){p=l[1];m=l[2]}if(this.href.indexOf("p=HotelsCom")>-1){p=Math.max(p,960);m=Math.max(m,window.getHeight(),600)}if(p){a+=",width="+p}if(m){a+=",height="+m}if(h){a+=",screenX="+h+",left="+h}if(g){a+=",screenY="+g+",top="+g}if(a!==""){if(c){a="toolbar=1,resizable=1,menubar=1,location=1,status=1,scrollbars=1"+a}else{a="toolbar=0,resizable=1,menubar=0,location=0,status=0,scrollbars="+(b?0:1)+a}}if(!d){d=this.href}t=u||("p"+(popupIndex++));if(r&&Browser.ie){f=new Element("a",{target:t,href:d});f.inject(k,"bottom");j=window.open("",t,a);f.click();f.destroy()}else{j=window.open(d,t,a)}if(j!==null){try{j.opener=self}catch(o){}j.focus()}}catch(q){ta.util.error.record(q,"behavior popup",s);throw q}}linkMap.js_popup=function(a,b){popup.attempt(b,a)};linkMap.js_popComm=function(a,b){popup.attempt([b,null,950,610,null,null,null,null,true],a)};linkMap.js_popMap=function(a,b){Cookie.write("mapPopup","1",{domain:cookieDomain});popup.attempt([b,"map",820,960],a)};linkMap.js_popNoScroll=function(a,b){popup.attempt([b,null,null,null,null,null,true],a)};linkMap.js_popCR=function(a,b){popup.attempt([b,"cr",245,610,5,5],a)};linkMap.js_email=function(a,b){popup.attempt([b,"email",580,460,30,25],a)};linkMap.js_popReview=function(a,b){popup.attempt([b,"review",550,395,30,25],a)};linkMap.js_popPhoto=function(a,b){popup.attempt([b,"photo",650,350],a)};linkMap.js_popGallery=function(a,b){Cookie.write("PhotoPop","1",{domain:cookieDomain});popup.attempt([b,"media",782,820],a)};linkMap.js_popGalleryComm=function(a,b){Cookie.write("PhotoPop","1",{domain:cookieDomain});popup.attempt([b,"media",780,950],a)};linkMap.js_popDMO=function(a,b){popup.attempt([b,"dmo",400,400],a)};linkMap.js_popNxTall=function(a,b){popup.attempt([b,330,680],a)};linkMap.js_popNxWide=function(a,b){popup.attempt([b,730,380],a)};linkMap.js_popNxLogin=function(a,b){popup.attempt([b,"login",795,645],a)};linkMap.js_popFraud=function(a,b){popup.attempt([b,"fraud",640,460],a)};linkMap.js_popDestGd=function(a,b){popup.attempt([b,"dest_guide",565,700,(screen.width-700)/2,(screen.height-600)/2],a)};linkMap.js_popSmall=function(a,b){if(screen.width>1024){popup.attempt([b,null,800,600,240,5,false,false,true],a)}else{if(screen.width>800){popup.attempt([b,null,620,500,240,5,false,false,true],a)}else{popup.attempt([b,null,475,390,210,5,false,false,true],a)}}return a};linkMap.js_popProfPhoto=function(a,b){if(screen.width>1024){popup.attempt([b,null,800,500,240,5,false,false,true],a)}else{if(screen.width>800){popup.attempt([b,null,620,450,240,5,false,false,true],a)}else{popup.attempt([b,null,475,390,210,5,false,false,true],a)}}return a};linkMap.js_popPartner=function(a,b){if(screen.width>1024){popup.attempt([b,null,980,500,240,5,false,false,true],a)}else{if(screen.width>800){popup.attempt([b,null,800,500,240,5,false,false,true],a)}else{popup.attempt([b,null,620,450,210,5,false,false,true],a)}}return a};linkMap.js_noTAPD=function(a,b){Cookie.dispose("TAPD",{domain:cookieDomain})};rules["a#TERMS"]=function(a){a.addEvent("click",popup.bind(a).partial(Function._,"terms",300,300,30,25))};linkMap.js_ajaxSubmit=function(a,f){if(!a.className.match(/\bform_(\w+)\b/)){return}var d=$(RegExp.$1);var c={url:a.href,data:d,onFailure:function(e){if(d){d.removeClass("ajaxInFlight")}ta.util.error.ajaxFailure("behavior:js_ajaxSubmit",e)}};var g=window["callback"+d.id];if(a.className.match(/method_(\w+)\b/)){c.method=RegExp["$1"]}if(a.className.match(/\btgt_(\w+)\b/)){c.update=RegExp["$1"]}else{c.onSuccess=function(e){if(d){d.removeClass("ajaxInFlight")}ta.overlays.showInLightbox(e);if(g&&typeOf(g)=="function"){g()}}}new Event(f).preventDefault();var b=window["validate"+d.id];if(b&&typeOf(b)=="function"&&b.apply(d)==false){return}d.addClass("ajaxInFlight");if(a.className.match(/\bevalScripts\b/)){c.evalScripts=true}(c.update?new Request.HTML(c):new Request(c)).send()};linkMap.js_ajax=function(a,b){new Event(b).preventDefault();if(!(tgt=a.className.match(/\btgt_(\w+)\b/))){return}tgt=$(tgt[1]);new Request.HTML({url:a.href,update:tgt,onFailure:ta.util.error.ajaxFailure.partial("behavior:js_ajax")}).send()};linkMap.js_ajaxlogin=function(b,c){new Event(c).preventDefault();if(!(tgt=b.className.match(/\btgt_(\w+)\b/))){return}var a=b.href;tgt=$(tgt[1]);new Request({url:b.href,onSuccess:function(d,f){var e=(d.indexOf("<!--nologin-->")<0);if(!e){login(["tt","ajax","returnTo",a+"&rd=1","greeting","showuserreviews_vote_25ee"])}else{tgt.innerHTML=d}},onFailure:ta.util.error.ajaxFailure.partial("behavior:js_ajaxLogin")}).send()};linkMap.js_ajaxReport=function(a,b){ajaxReport.attempt(b,a)};var ajaxReport=function(a){new Event(a).preventDefault();ta.overlays.loadInLightbox(this.href)};function toggle(a){new Event(a).preventDefault();this.toggleClass("off")}var toggleMeRule=function(a){if(false==a.hasClass("defaultOpen")){a.addClass("off")}a.getElements(".show").addEvent("click",toggle.bind(a));a.getElements(".hide").addEvent("click",toggle.bind(a))};rules["#TOGGLEME"]=toggleMeRule;rules["#TOGGLEME2"]=toggleMeRule;ajaxRules["div.js_swapBlocks"]=function(b){var a=b.getElement(".js_swapOut");var c=b.getElement(".js_swapIn");var d=b.getElement("a.js_swapTrigger");var e=b.getElement("a.js_swapBackTrigger");if(a&&c&&d){d.addEvent("click",function(f){new Event(f).preventDefault();window.removedBit=a.dispose();c.show()});d.removeClass("js_swapTrigger")}if(a&&c&&e){e.addEvent("click",function(f){new Event(f).preventDefault();c.hide();$("parentOfSwapOut").appendChild(window.removedBit)});e.removeClass("js_swapBackTrigger")}};ajaxRules["#PM_UNBLOCK"]=function(a){a.addEvent("submit",function(c){new Event(c).stop();var b=$("PM_UNBLOCK");if(b.unblock.value=="1"){new Request({url:"/SendMessageRD",data:b,onSuccess:ta.overlays.showInLightbox,onFailure:ta.util.error.ajaxFailure.partial("behavior:#PM_UNBLOCK")}).request()}else{$("unblock-intercept").hide();$("blockedreply").show();b.unblock.value="1"}})};function enableCommunity(c,a){var b=c;if(!a){b=function(d){enableCommunityResponse(d,c)}}if(typeof(JS_SECURITY_TOKEN)=="undefined"){JS_SECURITY_TOKEN=""}new Request({url:"/MemberSubscriptionsController",data:{Action:"ChangeM2M",set:"on",token:JS_SECURITY_TOKEN},onSuccess:b,onFailure:ta.util.error.ajaxFailure.partial("behavior:enableCommunity")}).send()}function enableCommunityResponse(res,callback){var isf=document.getElementById("inviteStatusField");if(txt.match(/^{/)){var data=eval("("+txt+")");if(data.ERROR){isf.innerHTML=data.ERROR;isf.style.display="block"}}else{isf.innerHTML=JS_community_on;isf.style.display="block"}}function getRelativeURL(){return window.location.pathname+window.location.search+window.location.hash}var follow=function(a){return function(){window.location=$(a).href}};function showToggleBlock(a){$$(".js_toggleBlocks .js_toggleBlock").each(function(c,b){c.hide();if(c.hasClass(a)){c.show()}})}linkMap.js_toggleBlockTrigger=function(b,c){var a=b.getProperty("class");a.replace(/toggleBlock[0-9]+/g,function(d){a=d});showToggleBlock(a)};rules["#SWAPBLOCK .js_toggleBlock"]=function(b){if(b.hasClass("js_toggleBlockSelected")){var a=b.getProperty("class");a.replace(/toggleBlock[0-9]+/g,function(c){a=c});showToggleBlock(a)}};var showLastSavesRD=function(){var a=$("LAST_SAVES_PLACEHOLDER");if(typeof savesIncluded!="undefined"){if(!a){return renderLastSaves(SAVES_RECENT_SAVES)}else{a.innerHTML=renderLastSaves(SAVES_RECENT_SAVES);flyout.positionCorners()}}else{if(!a){new Asset.javascript(savesJS);showLastSavesRD.delay(125);return new Element("div",{id:"LAST_SAVES_PLACEHOLDER"})}}};var showSavesWidget=function(d,f,c,b,g,e,a){if(typeof savesIncluded!="undefined"){showSavesWidget2(d,f,c,b,g,e,a)}else{new Asset.javascript(savesJS);showSavesWidget.delay(125,null,[d,f,c,b,g,e,a])}};var savesInlineLoginOnClickHandler=function(c,a,b){if(typeof savesIncluded!="undefined"){savesInlineLoginOnClickHandler2(c,a,b)}else{new Asset.javascript(savesJS);savesInlineLoginOnClickHandler.delay(125,null,[c,a,b])}};linkMap.js_trackDirPop=function(a,b){if(actionToRecord=a.className.match(/ar_(\w+)/)){actionToRecord=actionToRecord[1];new Request({url:"/ActionRecord?action="+actionToRecord}).send()}};function clearPopupForm(){$$("#POPUP_FORM #pass").setProperty("value","");$$("#DHTMLPOPUP .error-message").empty()}linkMap.js_clearPopupForm=function(a,b){clearPopupForm()};function setPopupFormAction(a){$$("#POPUP_FORM #action").setProperty("value",a)}linkMap.js_popupFormAction1=function(a,b){setPopupFormAction("1")};linkMap.js_popupFormAction2=function(a,b){setPopupFormAction("2")};var replaceContent=ta.util.element.replaceContent;linkMap.js_replaceContent=function(d,f){var b=d.className.match(/id_([^\s"]*)?/);if(!b||b.length!=2){throw new Error("Links with behavior js_replaceContent must also have a style class id_??? to indicate which element's contents should be replaced")}b=b[1];var c=$(b);var a=d.href;if(a){replaceContent(f,c,a)}f.stop()};var doBehavior=function(b){var b=new Event(b||window.event);var a=ta.id(b.target);if(a.get("tag")!="a"){a=a.getParent("a")}if(/pid(\d+)/.test(a.className)){ta.util.cookie.setPIDCookie(RegExp.$1)}(a.className.match(/(js_\w+)/g)||[]).each(function(d){linkMap[d](a,b)})};function _processLink(a){if(a.className.indexOf("js_")>=0||a.className.indexOf("pid")>=0){if(a.addEventListener){a.addEventListener("click",doBehavior,false)}else{a.attachEvent("onclick",doBehavior)}try{if(a.className.match(/\b(js_pop)/)&&window.noPopClass){a.className=a.className+" "+window.noPopClass}}catch(b){ta.util.error.record(b,"_processLink - add no pop class")}}}function processLinks(a){var b=Array.from(a.getElementsByTagName("a"));b.each(_processLink);return b.length}if(typeof behavior=="undefined"){ta.queueForLoad(function(){processLinks(document)},"ProcessLinkBehavior")}ta.queueForLoad(function(){Cookie.dispose("TATypeAhead");if(window==window.top&&!window.opener){var f=Cookie.read("ajaxAction");if(f){Cookie.dispose("ajaxAction",{domain:cookieDomain,path:"/"});f=f.split("|");try{var a=f.slice(1);a.unshift({});a.unshift(f[0]);ta.run.apply(null,a)}catch(d){ta.util.error.record(d,"ajaxAction",null,{funcName:f[0]})}}}if(Browser.firefox||Browser.safari||Browser.chrome){var e=window.location.hash;if(e.length>1){e=e.substring(1)}var b=ta.id(e);if(b&&b.getTop()!=window.getScrollTop()){window.scrollTo(0,b.getTop())}}if(/^#save/.test(location.hash)){doSavesPostLoginPopup()}freshVSCookieCheck()},"On_Load_Popups");ta.queueForLoad(function(){if(typeof cpu_run!="undefined"){cpu_run()}},"Commerce Popunder");function freshVSCookieCheck(){if(typeof freshVSTrackingCookie!="undefined"&&freshVSTrackingCookie){var a=new Cookie("v1st").readRaw();if(a){new Request({url:"/VSCookieRequest"}).send()}}}function royBatty(){if(typeof taSecureToken=="undefined"||!taSecureToken){return}try{var d=Cookie.read("roybatty");if(!d){Cookie.write("roybatty",taSecureToken+",1",{domain:cookieDomain});new Request({url:"/CookiePingback"}).send()}else{var b=d.split(",");if(b&&b.length==2){var a=parseInt(b[1],10);Cookie.write("roybatty",taSecureToken+","+a,{domain:cookieDomain})}else{ta.util.error.record(null,"royBatty -- Bad value in cookie: "+d)}}}catch(c){ta.util.error.record(c,"javascript exection bot detection error")}}ta.queueForLoad(function(){if(typeof royBatty!="undefined"){royBatty()}},"RoyBatty");var doSavesPostLoginPopup=function(){if(typeof savesIncluded!="undefined"){handleSavesPostLoginPopup()}else{new Asset.javascript(savesJS);doSavesPostLoginPopup.delay(125)}};if(window.showPopup){showPopup()}var popupConfig={};function DHTMLOverlayRequest(f,e,c,d){var b="?";if(popupConfig.servletUrl.contains(b)){b="&"}if(popupConfig.servletUrl.contains("fromServlet=")){var a=popupConfig.servletUrl+b+"Action="+f}else{var a=popupConfig.servletUrl+b+"Action="+f+"&fromServlet="+pageServlet}new Request({url:a,onSuccess:e,onFailure:c,data:d,evalScripts:true}).send()}function showDHTMLPopup(b,g,d,a,f){try{popupConfig.servlet=b;popupConfig.servletUrl=g;popupConfig.lightbox=d;popupConfig.options=a;if(a&&a.loading&&f){f=new Event(f);ta.id(a.loading).show().inject(document.body).setStyles({left:f.page.x+20,top:f.page.y})}DHTMLOverlayRequest("Open",DHTMLOverlayResponse,null,a?a.data:null)}catch(c){ta.util.error.record(c,"showDHTMLPopup - "+b,f)}}var DHTMLOverlayResponse=function(g){if(!ta.overlays||!ta.overlays.Factory){ta.load("ta-overlays",function(){DHTMLOverlayResponse(g)});return}if(popupConfig.options&&popupConfig.options.forward&&window.popupForward){window.location=window.popupForward}$$("#FLYOUT").each(function(k,j){k.dispose()});window.lightbox.deactivate();$$(".overlay").each(function(k,j){if(k.overlay&&k.overlay.hide){k.overlay.hide()}else{if(k.hide){k.hide()}else{k.dispose()}}});if(popupConfig.options&&popupConfig.options.loading){ta.id(popupConfig.options.loading).hide()}var d;var c={};if(popupConfig.lightbox){c.backdrop=ta.overlays.BACKDROP_ALWAYS}if(popupConfig.options&&popupConfig.options.delayedPosition){c.delayedPosition=popupConfig.options.delayedPosition}if(popupConfig.options&&popupConfig.options.permanent){c.permanent=popupConfig.options.permanent}if(popupConfig.options&&popupConfig.options.center){c.autoShow=false;d=new ta.overlays.CenteredOverlay(c)}else{if(popupConfig.options&&popupConfig.options.permanent){c.xOffset=ta.id("PAGE").getLeft()+100;c.yOffset=ta.id("PAGE").getTop()+220;d=new ta.overlays.PermanentOverlay(c)}else{if(popupConfig.options&&popupConfig.options.daodaoPopup){c.xOffset=ta.id("PAGE").getLeft()+240;c.yOffset=ta.id("PAGE").getTop()+220;d=new ta.overlays.AbsoluteOverlay(c)}else{c.xOffset=ta.id("PAGE").getLeft()+100;c.yOffset=ta.id("PAGE").getTop()+220;d=new ta.overlays.AbsoluteOverlay(c)}}}d.loadRemoteSuccess(g);d.show();var h=function(){if(typeof dhtmlRedirectLink!="undefined"){window.location=dhtmlRedirectLink;return}if(this.inner.getElement(".refreshOnClose")){document.location.reload();return}if(typeof addPopupCloseClass!="undefined"&&!this.inner.getElement(".silentClose")){DHTMLOverlayRequest("Close")}if(this.inner.getElement(".popupBackOnClose")){if(/(?:^|;)\\s*TAReturnTo=\%1\%([^;]*)/.test(document.cookie)){window.location=decodeURIComponent(RegExp.$1)}else{window.location="/"}}};d.addEvent("onHide",h);if(popupConfig.servlet){d.container.addClass(popupConfig.servlet);d.container.addClass("np");if(popupConfig.servlet=="RuleBasedPopup"&&popupConfig.options&&popupConfig.options.cmsDisplayName){d.container.addClass(popupConfig.options.cmsDisplayName)}d.inner.getElements(".popupConvert").each(function(k,j){k.addEvent("click",function(){DHTMLOverlayRequest("Convert")})});d.inner.getElements(".popupDecline").each(function(k,j){k.addEvent("click",function(){DHTMLOverlayRequest("Decline")})});d.inner.getElements(".dhtmlclose").each(function(k,j){k.addEvent("click",function(){var l=d;l.hide()})});var b=function(k){var j=(k.charCode)?k.charCode:((k.which)?k.which:k.keyCode);if(j==13||j==10){e(k)}};var f=function(k){var j=(k.charCode)?k.charCode:((k.which)?k.which:k.keyCode);if(j==13||j==10){new Event(k).preventDefault()}};d.inner.getElements(".popupSubmitOnEnter").each(function(k,j){k.addEvent("keydown",b)});var a=function(j){$$("#POPUP_FORM #sendpass").setProperty("value","true");e(j)};d.inner.getElements(".popupSendForgotEmail").each(function(k,j){k.addEvent("click",a)});var e=function(j){new Event(j).preventDefault();d.inner.getElements(".popupSubmit").each(function(l,k){l.removeEvent("click",e)});d.inner.getElements(".popupSendForgotEmail").each(function(l,k){l.removeEvent("click",a)});d.inner.getElements(".popupSubmitOnEnter").each(function(l,k){l.removeEvent("keydown",b);l.addEvent("keydown",f)});d.inner.getElements(".focusClear").each(function(l,k){l.setProperty("value","")});if(popupConfig.options&&popupConfig.options.disableOnHideForSubmit){d.removeEvent("onHide",h)}DHTMLOverlayRequest("Submit",DHTMLOverlayResponse,null,d.inner.getElementById("POPUP_FORM"))};d.inner.getElements(".popupSubmit").each(function(k,j){k.addEvent("click",e)})}if(popupConfig.options&&popupConfig.options.callback){popupConfig.options.callback(d.container)}};function showOwnersDHTMLPopup(b,c){var a={callback:enableAffilBox};showDHTMLPopup(b,c,true,a)}function enableAffilBox(c){if(typeof c=="undefined"||c==null){return}for(var a=0;a<3;a++){var d="affil_"+a;var b=c.getElementById(d);if(b!=null&&b!=false&&b!=""){b.style.visibility="visible"}}}var cpu_win;function verifyPopunderExists(b){try{if(cpu_win&&cpu_win.location){return}}catch(a){}new Request({url:"/ActionRecord?action=EXITWINDOWLOG_popunderfollowup|fail|delay="+b}).send()}function doCookieCheck(){Cookie.write("SessionTest","true",{duration:0});if(Cookie.read("SessionTest")){Cookie.dispose("SessionTest");return true}return false}var blurPopunder=function(){try{var a=window.open("about:blank");if(a){a.focus();a.close()}}catch(b){ta.util.error.record(b,"commercePopunder - FF/Chrome blur failed")}};var suppressPopOnClick=function(d){var c=new Event(d||window.event);var b=ta.id(c.target);if(b){if(window.noPopClass&&(b.hasClass&&b.hasClass(window.noPopClass))||(b.getParent&&b.getParent("."+window.noPopClass))){return"no_cpu_class"}var a=b.onclick;if(a&&a.toString&&a.toString().match(/window\.open/g)){return"onclick_script"}if(b.target&&"a"===b.get("tag")){return"has_target"}}if(ta.browser.isIE10Metro()){return"ie10metro"}return false};if((typeof cpu_enabled!="undefined"&&cpu_enabled)){var cpu_paused=false;var cpu_go_impl=function(H,q){try{var k=ta.has("checkrates.add_holding_windows");var j=new Cookie("CommercePopunder").readRaw();var L=ta.popups.PopUtil.numPopundersCheck();var g=ta.popups.PopUtil.hasMTPU();if(q=="unload"){if(Browser.chrome){return"Chrome_unload"}else{if(k&&Browser.ie){return"IE_unload"}}}if(cpu_paused&&q=="unload"&&!isTakeOver){return"paused"}if(!doCookieCheck()){return"failed_cookie_check"}if(k&&(ta.popups.PopUtil.hwClosed||j=="SuppressAll")){return"user closed holding window"}if(!k||(k&&L>=ta.popups.PopUtil.maxPopunders)){if(j&&isTakeOver&&q=="click"){return"already_popped"}else{if(j&&!isTakeOver){if(j!="SuppressUnload"||q!="click"){return"already_popped"}}}}var E=typeof IS_MTPU_ENABLED!="undefined"&&IS_MTPU_ENABLED&&typeof MTPU_RULE!="undefined"&&MTPU_RULE>0&&!g;var U=E;if(q=="click"){try{var z=suppressPopOnClick(H);if(ta.has("checkrates.add_holding_windows")&&!E){var v=false;var m=/Hotel_Review|ShowUserReviews|Hotels|SmartDeals/;if(pageServlet&&m.test(pageServlet)){v=true}var C=false;if(H.target&&H.target.href&&m.test(H.target.href)){C=true}if(!v&&!C){z="add holding windows ineligible"}}if(z){return z}}catch(D){ta.util.error.record(D,"commercePopunder - suppressPopOnClick");return"error"}}if(typeof blockPU!="undefined"&&blockPU){return"block_pu"}var G="";if(typeof pageServlet!="undefined"&&pageServlet!==null){G=pageServlet}var O=new Cookie("TASession").readRaw();if(O&&/\*PD(\d+)\.(\d+)/.test(O)&&/\*CC\.(\d+)/.test(O)&&!U){return"commerce_click_happened"}if((!O||!(/\*LL\.(\d+)/.test(O)))&&!U){return"bug_28579"}var M=1;var Q=1;try{if(Browser.ie7){M=250;Q=100}if(Browser.safari||Browser.chrome){M=85;Q=100}}catch(D){ta.util.error.record(D,"commercePopunder - access to window attributes",H,{type:q})}var r=0,o=0;try{r=(window.screenLeft||window.screenX);o=(window.screenTop||window.screenY)}catch(T){ta.util.error.record(D,"commercePopunder - setting nX and nY",H,{type:q});r=undefined;o=undefined}var K=0,J=0;try{if(typeof(r)=="undefined"){r=0;o=0;K=r+window.screen.availWidth-M;J=o+window.screen.availHeight-Q}else{K=r+window.getWidth()-M;J=o+window.getHeight()-Q}}catch(D){ta.util.error.record(D,"commercePopunder - setting x and y",H,{type:q});K=200;J=200}try{if(Browser.ie7){J=J-95;K=K+13}else{if(Browser.safari||Browser.chrome){J=J-16}else{K=5000;J=5000}}}catch(D){ta.util.error.record(D,"commercePopunder - access to window attributes",H,{type:q})}if(!c){c=""}try{if(window.localStorage){localStorage.setItem("CommercePopunder.timeStamp",new Date().getTime())}}catch(R){ta.util.error.record(R,"commercePopunder - localStorage after before pop",null,{},"WARN")}var B="";if(typeof overlayBackupLoc!=undefined&&overlayBackupLoc){B="&backupLoc="+overlayBackupLoc}var s="";try{var b=window.escape(window.location.href);s="http://"+window.location.hostname+"/CommercePopunderEnhanced?mainWindowReturnTo="+b+"&fromServlet="+G+B}catch(D){ta.util.error.record(D,"commercePopunder - error accessing window.location setting cpu_uri",H,{type:q})}var a=790;var f=660;if(E){if(typeof geoParam!="undefined"&&geoParam){s="http://"+window.location.hostname+"/RuleBasedPopunder?Rule="+MTPU_RULE+"&fromServlet="+G+geoParam+B}else{s="http://"+window.location.hostname+"/RuleBasedPopunder?Rule="+MTPU_RULE+"&fromServlet="+G+B}}if(q=="click"){s=s+"&onclick=1"}var S=(s.test(/RuleBasedPopunder\?Rule=286/)||s.test(/RuleBasedPopunder\?Rule=287/))?true:false;if(S){a=740;f=700;if(Browser.ie){a=a+10}}try{var l=1;var d=1;if(ta.browser&&ta.browser.isIE9orHigher&&ta.browser.isIE9orHigher()){l=0}else{if(Browser.chrome||Browser.firefox){if(Browser.chrome){d=0}M=a;Q=f;K=r+(window.getWidth()-a)/2;J=o+(window.getHeight()-f)/2}}if(k){if(ta.has("checkrates.avlb_popup_win")&&!E){var p=ta.id(H.target);var t=["checkRatesType=checkRates","avlbType=popup"];var N=false;var F=false;if(p&&p.href){var u=p.href.match(/-d(\d+)/);if(u){t.push("d="+u[1]);N=true}else{var P=p.href.match(/-g(\d+)/);if(P){t.push("g="+P[1]);F=true}}}else{if(typeof(modelLocId)!="undefined"&&modelLocId){t.push("d="+modelLocId);N=true}else{if(typeof(modelGeoId)!="undefined"&&modelGeoId){t.push("g="+modelGeoId);F=true}}}if(N||F){s="http://"+window.location.hostname+"/AlsoViewedLB?"+t.join("&")}else{return}}cpu_win=ta.popups.PopUtil.launchAddHoldingWindow(s)}else{cpu_win=window.open(s,"CommercePopunder","toolbar=1,location=1,directories=1,status=1,menubar="+l+",resizable=1,copyhistory=1,scrollbars="+d+",width="+M+",height="+Q+",left="+K+",top="+J)}var A=1;var c=window.cookieDomain;if(!c){c=""}if(cpu_win!=null){if(ta.has("checkrates.belligerent_hw")&&Browser.version>22){ta.store("checkrates.popunder",true)}if(!k){try{try{if(((Browser.firefox&&Browser.version>3.6)||(Browser.chrome&&(Browser.version<17||(Browser.version>20&&Browser.version<23))))&&q=="click"){blurPopunder()}}catch(R){ta.util.error.record(R,"commercePopunder - FF/Chrome did not blur")}cpu_win.opener=self;cpu_win.blur();window.focus();try{if(!Browser.chrome&&!Browser.firefox){cpu_win.moveTo(r+(window.getWidth()-a)/2,o+(window.getHeight()-f)/2);cpu_win.resizeTo(a,f)}}catch(R){ta.util.error.record(R,"commercePopunder - after pop, resize/move")}}catch(R){ta.util.error.record(R,"commercePopunder - after pop",null,{},"WARN")}Cookie.write("CommercePopunder","SuppressAll",{domain:c,duration:A})}else{var I=L+1;ta.popups.PopUtil.trackPopunder(s,I);Cookie.write("CommercePopunder","HW"+I,{domain:c,duration:0})}}else{ta.util.error.record(null,"commercePopunder - past rules, no pop",null,{},"WARN");if(q=="unload"){try{if(window.localStorage){localStorage.setItem("CommercePopunder.timeStamp",new Date().getTime())}}catch(R){ta.util.error.record(R,"commercePopunder - localStorage after pop unload fail",null,{},"WARN")}Cookie.write("CommercePopunder","SuppressUnload",{domain:c,duration:A})}}}catch(D){ta.util.error.record(D,"commercePopunder - pop window",H,{type:q})}}catch(R){ta.util.error.record(R,"commercePopunder - general",H,{type:q})}};var cpu_go=function(c,a){var b=cpu_go_impl(c,a);if(false&&document.getElement("#MAIN .poolR")&&b&&!ta.has("popunder.actionrecord")&&(b<4||b>6)){ta.store("popunder.actionrecord",true);new Request({url:"/ActionRecord?action=CPU_block_"+b}).send()}};var cpu_resume=function(){window.cpu_paused=false};var cpu_pause=function(c){var b=new Event(c||window.event);var a=ta.id(b.target);if(!cpu_paused&&a&&(a.get("tag")=="a"||a.getParent("a"))){window.cpu_paused=true;cpu_resume.delay(1000)}};var cpu_run=function(){window.addEvent("beforeunload",function(a){cpu_go(a,"unload")});if(ta.has("checkrates.belligerent_hw")&&Browser.version>22){document.addEvent("mousedown",cpu_pause)}else{document.addEvent("click",cpu_pause)}if(ta.has("checkrates.belligerent_hw")&&Browser.version>22){document.addEvent("mousedown",function(a){cpu_go(a,"click")});document.addEvent("click",ta.popups.PopUtil.openCloseTab)}else{document.addEvent("click",function(a){cpu_go(a,"click")})}}}function expandIframe(c,a,b){if(document.getElementById(c)){document.getElementById(c).width=a;document.getElementById(c).height=b}}function collapseAd(c){var a=ta.id(c);if(a==null){return}var b=ta.id(a.parentNode);if(b&&b.hasClass&&b.hasClass("adServer")){b.addClass("taEmpty")}else{ta.util.error.record(null,"ta.common.ads.collapseAd:fail",null,{},"WARN")}}function injectAds(){var ads=$$(".adServer .details");if(ads.length==0){return}var url="adp/adp.html";if(adpHtml){url=adpHtml}var domainParam=window.documentDomainChanged?"dd+":"";for(var i=0;i<ads.length;i++){var innerDiv=ta.id(ads[i]).getParent(".adInner");if(innerDiv&&innerDiv.hasClass("deferAd")){continue}var id=ads[i].id+"_iframe";if(ta.id(id)){continue}var el=document.createElement("iframe");el.setAttribute("id",id);el.setAttribute("name",id);el.setAttribute("height",0);el.setAttribute("width",0);el.setAttribute("scrolling","no");el.setAttribute("border","0");el.setAttribute("marginheight","0");el.setAttribute("marginwidth","0");el.setAttribute("frameBorder","0");el.setAttribute("src","http://"+document.location.host+"/"+url+"#"+domainParam+eval(ads[i].id));ads[i].getParent().appendChild(el)}}function injectAdsTargeted(elmt,onload){if(!elmt){return}var ads=elmt.getElements(".adServer .details");if(ads.length==0){return}var url="adp/adp.html";if(adpHtml){url=adpHtml}var domainParam=window.documentDomainChanged?"dd+":"";for(var i=0;i<ads.length;i++){var el=document.createElement("iframe");var id=ads[i].id+"_iframe";el.setAttribute("id",id);el.setAttribute("name",id);el.setAttribute("height",0);el.setAttribute("width",0);el.setAttribute("scrolling","no");el.setAttribute("border","0");el.setAttribute("marginheight","0");el.setAttribute("marginwidth","0");el.setAttribute("frameBorder","0");el.setAttribute("src","http://"+document.location.host+"/"+url+"#"+domainParam+eval(ads[i].id));if(onload){ta.id(el).addEvent("load",onload)}ads[i].getParent().appendChild(el)}}window.addEvent("load",function(){injectAds.delay(10)});ta.common.ads={loadMonikers:function(){try{var b=ta.retrieve("ads.monikerUrl");if(b!=null){ta.common.ads._doLoadMonikers(b)}}catch(a){ta.util.error.record(a,"dynamic load of page monikers",null,"URL: $iFrameURL","INFO")}},_doLoadMonikers:function(a){if(!a){return}try{var b=document.createElement("iframe");b.setAttribute("id","Monikers");b.setAttribute("width","1");b.setAttribute("height","1");document.body.appendChild(b);b.setAttribute("src",a)}catch(c){ta.util.error.record(null,"ta.common.ads._doLoadMonikers: failed to append iframe to body.")}},getMetaContent:function(c){var f=document.getElementsByTagName("meta");for(var b=0;b<f.length;b++){var e=f[b];var a=e.name;var d=new RegExp(c,"i");if(a.match(d)){return e.content.replace(/["<>]/g,"")}}return""},loadMonikersAdcomHelper:function(){var a=ta.common.ads.getMetaContent("keywords");var c=ta.common.ads.getMetaContent("description");var d=document.location.href;var e=document.referrer;var b="/uvpages/adcom.html?pageRef="+encodeURIComponent(e)+"&keywords="+encodeURIComponent(a)+"&description="+encodeURIComponent(c)+"&pageUrl="+encodeURIComponent(d);ta.common.ads._doLoadMonikers(b)},refreshAds:function(c,a){for(var b=0;b<c.length;b++){ta.common.ads.refreshAd(document.getElement(c[b]),a)}},refreshAd:function(m,g){if(!m){return}try{var f=ta.id(m).getElement(".adServer");f.removeClass("taEmpty");if(f.hasClass("noFrame")){ta.util.error.record(c,"ta.common.ads.refreshAd: ad to refresh must be in an iframe",null,{servlet:pageServlet});return}var h=m.getElement("script");var l=document.createElement("script");var d=h.text;for(var b in g){var k=g[b];d=ta.common.ads._replaceAdParam(d,b,k)}var j=m.id||m.className;var a=f.getElement(".details");a.inject(f.empty(),"top");l.type="text/javascript";l.text=d;a.empty().adopt(l);if(m.style.display=="none"){m.show()}injectAdsTargeted(m)}catch(c){ta.util.error.record(c,"ta.common.ads.refreshAd")}},_replaceAdParam:function(f,a,e){var b=a+"=";var d=encodeURI(e);if(f.indexOf(b)==-1){return f.replace(/;sz=/gi,";"+b+d+";sz=")}else{var c=new RegExp(b+"\\w+;","gi");return f.replace(c,b+d+";")}},refreshAdAjax:function(b,a,c,d){new Request({url:"/InjectAdAjax?t="+a+"&adParamKey="+c+"&adParamVal="+d,method:"get",evalScripts:true,onSuccess:function(e,f){var g=document.getElement(b);if(g){g.empty();g.set("html",e);injectAdsTargeted(g)}else{ta.util.error.record(null,"ta.common.ads.refreshAdAjax: target not found")}},onFailure:function(e,f){ta.util.error.record(null,"ta.common.ads.refreshAdAjax: request failed")}}).send()},deferAds:function(){var k=ta.retrieve("deferAds.ads");var j=1000;if(!k){return}try{var h=false;for(var d=0,f=k.length;d<f;d++){var c=k[d];if(c.getTop()<=(window.getScroll().y+window.getHeight())){if(c.hasClass("deferAd")){injectAdsTargeted(c);if(c.id=="ad300X250-bottom"){var a=ta.retrieve("scrollAd.enableScroll");if(a){window.ta_handleScroll=ta.common.scrollAd.handleScroll;setTimeout(function(){window.addEvent("scroll",window.ta_handleScroll)},j)}}}h=true;delete k[d]}}if(h){var b=[];for(var d=0,f=k.length;d<f;d++){if(typeof k[d]!="undefined"){b.push(k[d])}}ta.store("deferAds.ads",b);if(b.length<1){window.removeEvent("scroll",window.ta_handleAdDefer)}}}catch(g){ta.util.error.record(g,"ta.common.Ads.deferAds: Error with defer")}}};linkMap.js_modifySub=function(a,b){modifySub.apply(a,[b])};rules["#NEWSLETTER_CALLOUT input.memberUpdateEmail[type=text]"]=function(a){$("memberUpdatesEmailDefault").hide();$(a.form).addEvent("submit",function(b){if(a.value==$("memberUpdatesEmailDefault").innerHTML){a.value=""}})};function alertIfEmpty(a){if(a&&a.value==""){if(msg=a.className.match(/\bmsg_([\w\d]+)\b/)){alert(window[msg[1]])}else{alert("The field can not be empty")}return false}return true}function addNonMember(c,b){if(!b){b=this}popupConfig.clickedElement=b;new Event(c).preventDefault();var a="/MemberBenefitsPopup";if(/pid(\d+)/.test(b.className)){a+="?pid="+RegExp.$1}showDHTMLPopup("MemberBenefitsPopup",a,true)}function processPopDestMOGLink(b,a){if(!a){a=this}if(!loggedIn){addNonMember(b,a)}else{processGuideLink(b,a)}}function clickNonMember(){setTimeout("window.lightbox.deactivate()",500);if(popupConfig.clickedElement==null){return}var a=popupConfig.clickedElement;popupConfig.clickedElement=null;$$("#TRAVEL_GUIDES_LANDER .clickNonMember").each(function(c,b){c.removeEvent("click",addNonMember)});$$("#TRAVEL_GUIDES_FLY .clickNonMember").each(function(c,b){c.removeEvent("click",addNonMember)});if(a.className.match(/\bclickPopDestMOGLink\b/)){processPopDestMOGLink(null,a)}else{if(a.get("tag")=="a"){window.location=a.getProperty("href")}else{a.click()}}}function processPopDestMOGLink(b,a){if(!a){a=this}if(!loggedIn){addNonMember(b,a)}else{processGuideLink(b,a)}}rules["#TRAVEL_GUIDES_LANDER .clickNonMember"]=rules["#TRAVEL_GUIDES_FLY .clickNonMember"]=function(a){if(a.get("tag")!="a"||!a.className.match(/\bskipATag\b/)){a.addEvent("click",addNonMember)}};rules["#TRAVEL_GUIDES_LANDER .clickPopDestMOGLink"]=function(a){a.addEvent("click",processPopDestMOGLink)};rules["#HELP_CENTER dl.js_toggleset"]=function(a){var c=0;var b=new ToggleSet(a.getElements("dt"),a.getElements("dd"));if(window.location.hash&&(hash=window.location.hash.match(/c(\d+)/))){b.display(parseInt(hash[1]))}};rules["#TAB_CONTAINER"]=ta.widgets.tabContainer;linkMap.js_replaceContentSet=function(c,f){var d=c.className.match(/set_([^\s"]*)?/);if(!d||d.length!=2){throw new Error("Links with behavior js_replaceContentSet must also have a style class set_??? to indicate the set of elements the contents of which should be replaced")}var a=c.className.match(/id_([^\s"]*)?/);if(!a||a.length!=2){throw new Error("Links with behavior js_replaceContentSet must also have a style class id_??? to indicate which element's contents should be replaced")}a=a[1];var b=$(a);if(!b){throw new Error("Element of id "+a+" does not exist.")}d=d[1];replaceContentSet(d,f,b.id)};var replaceContentSet=function(h,j,f){j=new Event(j);var b=$$("a.set_"+h);for(var c=0;c<b.length;c++){var k=b[c];var g=k.className.match(/id_([^\s"]*)?/);if(!g||g.length!=2){throw new Error("Links with behavior js_replaceContentSet must also have a style class id_??? to indicate which element's contents should be replaced")}g=g[1];var d=$(g);var a=k.href;if(c==b.length-1&&f){d.addEvent("onContentReplaced",function(){window.setTimeout(function(){window.location.hash=f},200)})}else{if(f){d.removeEvents("onContentReplaced")}}if(a){replaceContent(j,d,a)}}j.stop()};function vrCalculator(c,g){var f=g!=null?new Event(g):null;if(c&&/pid(\d+)/.test(c.className)){ta.util.cookie.setPIDCookie(RegExp.$1)}var b="";var a=$("homePageVRCalcPromo");if(!a){a=$("calculatorOverviewPromo")}if(!a){a=$("calculatorLanderPromo")}if(a&&$("vrCalculatorForm")){var d=a.getElement("#geoName");if(d.hasClass("focusClear")){d.value="";d.removeClass("focusClear")}b="&geoName="+a.getElement("#geoName").value}new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,onReady:function(){this.inner.getElement("input").focus()}}).loadRemoteContent("/VacationRentalCalculator?restart=true"+b);if(f){f.stop()}return false}linkMap.js_submitVRCalculator=function(b,g){var d=g!=null?new Event(g):null;var h=$("vrCalculator");var c=h.getElement("form");var f=h.getElement(".serverErrorMsg");if(f){f.style.display="none"}if(c.geoName.value==""){h.getElement(".errorMsg").style.display=""}else{var a=c.action+"?"+c.toQueryString();replaceContent(g,h.getParent(),a)}if(d){d.stop()}return false};var SocialHistory=function(){var p={f:["http://www.facebook.com/","https://login.facebook.com/login.php","http://www.facebook.com/home.php"]};var l={};function m(u,t,s){if(u.currentStyle){var v=u.currentStyle[s]}else{if(window.getComputedStyle){var v=t.defaultView.getComputedStyle(u,null).getPropertyValue(s)}}return v}function j(s){s.parentNode.removeChild(s)}function q(){var s=document.createElement("iframe");s.style.position="absolute";s.style.visibility="hidden";document.body.appendChild(s);if(s.contentDocument){s.doc=s.contentDocument}else{if(s.contentWindow){s.doc=s.contentWindow.document}}s.doc.open();s.doc.write("<style>");s.doc.write("a{color: #000000; display:none;}");s.doc.write("a:visited {color: #FF0000; display:inline;}");s.doc.write("</style>");s.doc.close();return s}var g=q();function c(t,u){var s=g.doc.createElement("a");s.href=t;s.innerHTML=a;g.doc.body.appendChild(s)}for(var a in p){var o=p[a];for(var h=0;h<o.length;h++){c(o[h],a);if(o[h].match(/www\./)){var e=o[h].replace(/www\./,"");c(e,a)}else{var d=o[h].indexOf("//")+2;var f=o[h].substring(0,d)+"www."+o[h].substring(d);c(f,a)}}}var r=g.doc.body.childNodes;for(var h=0;h<r.length;h++){var k=m(r[h],g.doc,"display");var b=k!="none";if(b){l[r[h].innerHTML]=true}}j(g);return new (function(){var s=[];for(var t in l){s.push(t)}this.visitedSites=function(){return s};this.doesVisit=function(v){if(typeof(p[v])=="undefined"){return -1}return typeof(l[v])!="undefined"};var u=[];for(var t in p){u.push(t)}this.checkedSites=function(){return u}})()};function sniffFacebook(){var d=false;try{var a=SocialHistory();var b=a.visitedSites();if(b[0]=="f"){d=true}}catch(c){}return d}function registerOnLoad(b,a){if(ta&&ta.queueForLoad){ta.queueForLoad(b,a)}else{window.addEvent("load",b)}}function registerOnUnload(a){window.addEvent("unload",a)}function getScrollOffset(){return[window.getScrollLeft(),window.getScrollTop()]}function isIn(h,k,a){var d=getScrollOffset();k=$(k);var g=findPos(k);var e=g[0]-d[0];var j=g[1]-d[1];var c=e+k.clientWidth;var f=j+k.clientHeight;if(a){if(typeof(a)=="number"){e=e-a;j=j-a;c=c+a;f=f+a}else{if(a instanceof Array&&(a.length==2||a.length==4)){j=j-a[0];c=c+a[1];e=e-(a.length==4?a[3]:a[1]);f=f+(a.length==4?a[2]:a[0])}}}return(h[0]>=e&&h[0]<=c&&h[1]>=j&&h[1]<=f)}function setDetails(b,d,a,c){new Event(b).stop();$("title").value=d;$("category").value=a;$("space").value=c;$("newPage").submit()}function setOneTimeCookie(a,b){Cookie.write(a,b,{domain:cookieDomain,time:5});return true}var getChildByClass=function(e,d,c){if(!d||d.length==0){if(c==e.tagName){return e}}else{if(e.className&&(!c||c==e.tagName)){var f=-1;do{f=e.className.indexOf(d,f+1);if(f>=0&&(f==0||e.className.charCodeAt(f-1)==32)&&(f+d.length==e.className.length||e.className.charCodeAt(f+d.length)==32)){return e}}while(f>=0)}}for(var b=0;b<e.childNodes.length;b++){var a=getChildByClass(e.childNodes[b],d,c);if(a){return a}}return null};function showPrivacyPolicy(){window.open("/pages/privacy.html","PrivacyPolicy","toolbar=0,resizable=1,menubar=0,location=0,status=0,scrollbars=3,width=800,height=600,screenX=30,screenY=25,left=30,top=25")}ta.common.header={clear:function(b,a){a=ta.id(a);a.value="";a.removeClass("hasDefault");a.removeEvent("focus","ta.common.header.clear")},clearIfEquals:function(c,a,b){if(a.value==b){ta.run("ta.common.header.clear",{},c,a)}},setSearchText:function(d,b,c){b=ta.id(b);var a=b.getParent().getNext("input");a.value=c;a.addClass("hasDefault");a.addEvent("focus",function(f){ta.call("ta.common.header.clear",f,a)})},changeSearchType:function(h,b,f){b=ta.id(b);var d=b.getParent("form"),a=b.getParent().getNext("input"),e=a.getParent().getNext(),g=a.retrieve("nameTA"),c=a.retrieve("geoTA");ta.run("ta.common.header.setSearchText",{},h,b,f);if(b.id=="dropGeoRadio"){if(g){g.pause()}if(c){c.resume()}else{if(!ta.retrieve("hotelGeoTA")){ta.store("hotelGeoTA",true);ta.run("ta.widgets.typeahead.factory.location_mutable",{onComplete:function(j){a.store("geoTA",j)}},h,a,"GEO",function(){},{minLength:3})}}d.action="/HACSearch";e.show()}else{if(c){c.pause()}if(g){g.resume()}else{if(!ta.retrieve("hotelNameTA")){ta.store("hotelNameTA",true);ta.run("ta.widgets.typeahead.factory.standard_mutable",{onComplete:function(j){a.store("nameTA",j)}},h,a,"LOCATION","ta.widgets.typeahead.events.onSelectHotelDrop",{minLength:3,xargs:"&types=hotel"})}}d.action="/Search";e.hide()}},createDrop:function(c,a){a=ta.id(a);var b=a.getNext().getElement(".subNav");ta.run("ta.overlays.Factory.createDropDown",{},c,a,b)},firstClickHotelText:function(f,b,e){b=ta.id(b);var d=b.getParent("form"),a=ta.id("dropGeoRadio"),c=ta.retrieve("hotelNameTA");hasGeoTA=b.retrieve("hotelGeoTA");if(a.checked){if(!hasGeoTA){ta.store("hotelGeoTA",true);ta.run("ta.widgets.typeahead.factory.location_mutable",{onComplete:function(g){b.store("geoTA",g)}},f,b,"GEO",function(){},{minLength:3})}}else{if(!c){ta.store("hotelNameTA",true);ta.run("ta.widgets.typeahead.factory.standard_mutable",{onComplete:function(g){b.store("nameTA")}},f,b,"LOCATION","ta.widgets.typeahead.events.onSelectHotelDrop",{minLength:3,xargs:"&types=hotel"})}}ta.run("ta.common.header.clear",{},f,b);b.removePropertyEvent("focus","ta.common.header.firstClickHotelText")},stopEventProp:function(b,a){new Event(b).stopPropagation()},submitAndSetPid:function(c,b,a){setPID(a);form=b.getParent("form");if(a&&a==18898&&ta.id("dropVracGeo").value==""){window.location="/VacationRentals"}else{form.submit()}},showFriendsOverlay:function(){var b=ta.id("FRIENDSTAB");var c=new ta.overlays.RelativeOverlayBelow({showCloseButton:true,showArrow:true,arrowClass:"ttarrow",activate:ta.overlays.ACTIVATE_BOTH,style:"fbtt"},b);ta.store("friendsToolTip",c);if(ta.retrieve("friends_1st_resize")){var a=false;window.addEvent("resize",function(){if(!a){a=true}else{ta.common.header.hideFriendsToolTip(true)}})}else{window.addEvent("resize",function(){ta.common.header.hideFriendsToolTip(true)})}},checkFriendsToolTip:function(){if(!ta.util.localstorage||!ta.util.localstorage.canUseLocalStore()){return}var b=false;try{var a="taFriendsToolTipShown";if(!localStorage.getItem(a)){localStorage.setItem(a,true);b=true}}catch(d){ta.util.error.record(d,"checkFriendsToolTip - localStorage",null,{},"WARN")}if(b){var c=ta.id("COOKIE_BANNER");if(!ta.overlays||!ta.overlays.RelativeOverlayBelow){if(typeof(taExtraOverlayJs)!="undefined"){new Asset.javascript(taExtraOverlayJs,{onload:ta.common.header.showFriendsOverlay})}}else{if(typeof(c)!="undefined"&&c){ta.common.header.showFriendsOverlay.delay(2000)}else{ta.common.header.showFriendsOverlay()}}}},hideFriendsToolTip:function(b){var a=ta.retrieve("friendsToolTip");if(a){a.hide();window.removeEvent("resize",ta.common.header.hideFriendsToolTip)}var c=ta.id("FRIENDSTAB");if(c&&(typeof(b)=="undefined"||(b!=true))){c.addClass("hidenew")}},adjustFriendsLink:function(b){var a=$("TAIPPREFS");if(a){if(a.hasClass("auth_ip")){ta.util.cookie.setPIDCookie(18783)}else{if(a.hasClass("auth_fbc")){ta.util.cookie.setPIDCookie(15210)}else{return true}}window.location="/Friends";return false}return true}};