(function(a,c){a.ui=a.ui||{};if(a.ui.version){return}a.extend(a.ui,{version:"1.8.6",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});a.fn.extend({_focus:a.fn.focus,focus:function(d,e){return typeof d==="number"?this.each(function(){var f=this;setTimeout(function(){a(f).focus();if(e){e.call(f)}},d)}):this._focus.apply(this,arguments)},scrollParent:function(){var d;if((a.browser.msie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){d=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test(a.curCSS(this,"position",1))&&(/(auto|scroll)/).test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0)}else{d=this.parents().filter(function(){return(/(auto|scroll)/).test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0)}return(/fixed/).test(this.css("position"))||!d.length?a(document):d},zIndex:function(g){if(g!==c){return this.css("zIndex",g)}if(this.length){var e=a(this[0]),d,f;while(e.length&&e[0]!==document){d=e.css("position");if(d==="absolute"||d==="relative"||d==="fixed"){f=parseInt(e.css("zIndex"),10);if(!isNaN(f)&&f!==0){return f}}e=e.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(d){d.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});a.each(["Width","Height"],function(f,d){var e=d==="Width"?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),j={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};function h(m,k,i,n){a.each(e,function(){k-=parseFloat(a.curCSS(m,"padding"+this,true))||0;if(i){k-=parseFloat(a.curCSS(m,"border"+this+"Width",true))||0}if(n){k-=parseFloat(a.curCSS(m,"margin"+this,true))||0}});return k}a.fn["inner"+d]=function(i){if(i===c){return j["inner"+d].call(this)}return this.each(function(){a(this).css(g,h(this,i)+"px")})};a.fn["outer"+d]=function(i,k){if(typeof i!=="number"){return j["outer"+d].call(this,i)}return this.each(function(){a(this).css(g,h(this,i,true,k)+"px")})}});function b(d){return !a(d).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}a.extend(a.expr[":"],{data:function(f,e,d){return !!a.data(f,d[3])},focusable:function(f){var i=f.nodeName.toLowerCase(),d=a.attr(f,"tabindex");if("area"===i){var h=f.parentNode,g=h.name,e;if(!f.href||!g||h.nodeName.toLowerCase()!=="map"){return false}e=a("img[usemap=#"+g+"]")[0];return !!e&&b(e)}return(/input|select|textarea|button|object/.test(i)?!f.disabled:"a"==i?f.href||!isNaN(d):!isNaN(d))&&b(f)},tabbable:function(e){var d=a.attr(e,"tabindex");return(isNaN(d)||d>=0)&&a(e).is(":focusable")}});a(function(){var d=document.body,e=d.appendChild(e=document.createElement("div"));a.extend(e.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});a.support.minHeight=e.offsetHeight===100;a.support.selectstart="onselectstart" in e;d.removeChild(e).style.display="none"});a.extend(a.ui,{plugin:{add:function(e,f,h){var g=a.ui[e].prototype;for(var d in h){g.plugins[d]=g.plugins[d]||[];g.plugins[d].push([f,h[d]])}},call:function(d,f,e){var h=d.plugins[f];if(!h||!d.element[0].parentNode){return}for(var g=0;g<h.length;g++){if(d.options[h[g][0]]){h[g][1].apply(d.element,e)}}}},contains:function(e,d){return document.compareDocumentPosition?e.compareDocumentPosition(d)&16:e!==d&&e.contains(d)},hasScroll:function(g,e){if(a(g).css("overflow")==="hidden"){return false}var d=(e&&e==="left")?"scrollLeft":"scrollTop",f=false;if(g[d]>0){return true}g[d]=1;f=(g[d]>0);g[d]=0;return f},isOverAxis:function(e,d,f){return(e>d)&&(e<(d+f))},isOver:function(i,e,h,g,d,f){return a.ui.isOverAxis(i,h,d)&&a.ui.isOverAxis(e,g,f)}})})(jQuery);(function(b,d){if(b.cleanData){var c=b.cleanData;b.cleanData=function(e){for(var f=0,g;(g=e[f])!=null;f++){b(g).triggerHandler("remove")}c(e)}}else{var a=b.fn.remove;b.fn.remove=function(e,f){return this.each(function(){if(!f){if(!e||b.filter(e,[this]).length){b("*",this).add([this]).each(function(){b(this).triggerHandler("remove")})}}return a.call(b(this),e,f)})}}b.widget=function(f,h,e){var g=f.split(".")[0],j;f=f.split(".")[1];j=g+"-"+f;if(!e){e=h;h=b.Widget}b.expr[":"][j]=function(k){return !!b.data(k,f)};b[g]=b[g]||{};b[g][f]=function(k,m){if(arguments.length){this._createWidget(k,m)}};var i=new h();i.options=b.extend(true,{},i.options);b[g][f].prototype=b.extend(true,i,{namespace:g,widgetName:f,widgetEventPrefix:b[g][f].prototype.widgetEventPrefix||f,widgetBaseClass:j},e);b.widget.bridge(f,b[g][f])};b.widget.bridge=function(f,e){b.fn[f]=function(i){var g=typeof i==="string",h=Array.prototype.slice.call(arguments,1),j=this;i=!g&&h.length?b.extend.apply(null,[true,i].concat(h)):i;if(g&&i.charAt(0)==="_"){return j}if(g){this.each(function(){var k=b.data(this,f),m=k&&b.isFunction(k[i])?k[i].apply(k,h):k;if(m!==k&&m!==d){j=m;return false}})}else{this.each(function(){var k=b.data(this,f);if(k){k.option(i||{})._init()}else{b.data(this,f,new e(i,this))}})}return j}};b.Widget=function(e,f){if(arguments.length){this._createWidget(e,f)}};b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(f,g){b.data(g,this.widgetName,this);this.element=b(g);this.options=b.extend(true,{},this.options,this._getCreateOptions(),f);var e=this;this.element.bind("remove."+this.widgetName,function(){e.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return b.metadata&&b.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(f,g){var e=f;if(arguments.length===0){return b.extend({},this.options)}if(typeof f==="string"){if(g===d){return this.options[f]}e={};e[f]=g}this._setOptions(e);return this},_setOptions:function(f){var e=this;b.each(f,function(g,h){e._setOption(g,h)});return this},_setOption:function(e,f){this.options[e]=f;if(e==="disabled"){this.widget()[f?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",f)}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(f,g,h){var k=this.options[f];g=b.Event(g);g.type=(f===this.widgetEventPrefix?f:this.widgetEventPrefix+f).toLowerCase();h=h||{};if(g.originalEvent){for(var e=b.event.props.length,j;e;){j=b.event.props[--e];g[j]=g.originalEvent[j]}}this.element.trigger(g,h);return !(b.isFunction(k)&&k.call(this.element[0],g,h)===false||g.isDefaultPrevented())}}})(jQuery);(function(f,g){f.ui=f.ui||{};var d=/left|center|right/,e=/top|center|bottom/,a="center",b=f.fn.position,c=f.fn.offset;f.fn.position=function(i){if(!i||!i.of){return b.apply(this,arguments)}i=f.extend({},i);var n=f(i.of),m=n[0],p=(i.collision||"flip").split(" "),o=i.offset?i.offset.split(" "):[0,0],k,h,j;if(m.nodeType===9){k=n.width();h=n.height();j={top:0,left:0}}else{if(m.setTimeout){k=n.width();h=n.height();j={top:n.scrollTop(),left:n.scrollLeft()}}else{if(m.preventDefault){i.at="left top";k=h=0;j={top:i.of.pageY,left:i.of.pageX}}else{k=n.outerWidth();h=n.outerHeight();j=n.offset()}}}f.each(["my","at"],function(){var q=(i[this]||"").split(" ");if(q.length===1){q=d.test(q[0])?q.concat([a]):e.test(q[0])?[a].concat(q):[a,a]}q[0]=d.test(q[0])?q[0]:a;q[1]=e.test(q[1])?q[1]:a;i[this]=q});if(p.length===1){p[1]=p[0]}o[0]=parseInt(o[0],10)||0;if(o.length===1){o[1]=o[0]}o[1]=parseInt(o[1],10)||0;if(i.at[0]==="right"){j.left+=k}else{if(i.at[0]===a){j.left+=k/2}}if(i.at[1]==="bottom"){j.top+=h}else{if(i.at[1]===a){j.top+=h/2}}j.left+=o[0];j.top+=o[1];return this.each(function(){var t=f(this),v=t.outerWidth(),s=t.outerHeight(),u=parseInt(f.curCSS(this,"marginLeft",true))||0,r=parseInt(f.curCSS(this,"marginTop",true))||0,x=v+u+parseInt(f.curCSS(this,"marginRight",true))||0,y=s+r+parseInt(f.curCSS(this,"marginBottom",true))||0,w=f.extend({},j),q;if(i.my[0]==="right"){w.left-=v}else{if(i.my[0]===a){w.left-=v/2}}if(i.my[1]==="bottom"){w.top-=s}else{if(i.my[1]===a){w.top-=s/2}}w.left=parseInt(w.left);w.top=parseInt(w.top);q={left:w.left-u,top:w.top-r};f.each(["left","top"],function(A,z){if(f.ui.position[p[A]]){f.ui.position[p[A]][z](w,{targetWidth:k,targetHeight:h,elemWidth:v,elemHeight:s,collisionPosition:q,collisionWidth:x,collisionHeight:y,offset:o,my:i.my,at:i.at})}});if(f.fn.bgiframe){t.bgiframe()}t.offset(f.extend(w,{using:i.using}))})};f.ui.position={fit:{left:function(h,i){var k=f(window),j=i.collisionPosition.left+i.collisionWidth-k.width()-k.scrollLeft();h.left=j>0?h.left-j:Math.max(h.left-i.collisionPosition.left,h.left)},top:function(h,i){var k=f(window),j=i.collisionPosition.top+i.collisionHeight-k.height()-k.scrollTop();h.top=j>0?h.top-j:Math.max(h.top-i.collisionPosition.top,h.top)}},flip:{left:function(i,k){if(k.at[0]===a){return}var n=f(window),m=k.collisionPosition.left+k.collisionWidth-n.width()-n.scrollLeft(),h=k.my[0]==="left"?-k.elemWidth:k.my[0]==="right"?k.elemWidth:0,j=k.at[0]==="left"?k.targetWidth:-k.targetWidth,o=-2*k.offset[0];i.left+=k.collisionPosition.left<0?h+j+o:m>0?h+j+o:0},top:function(i,k){if(k.at[1]===a){return}var n=f(window),m=k.collisionPosition.top+k.collisionHeight-n.height()-n.scrollTop(),h=k.my[1]==="top"?-k.elemHeight:k.my[1]==="bottom"?k.elemHeight:0,j=k.at[1]==="top"?k.targetHeight:-k.targetHeight,o=-2*k.offset[1];i.top+=k.collisionPosition.top<0?h+j+o:m>0?h+j+o:0}}};if(!f.offset.setOffset){f.offset.setOffset=function(m,i){if(/static/.test(f.curCSS(m,"position"))){m.style.position="relative"}var k=f(m),o=k.offset(),h=parseInt(f.curCSS(m,"top",true),10)||0,n=parseInt(f.curCSS(m,"left",true),10)||0,j={top:(i.top-o.top)+h,left:(i.left-o.left)+n};if("using" in i){i.using.call(m,j)}else{k.css(j)}};f.fn.offset=function(h){var i=this[0];if(!i||!i.ownerDocument){return null}if(h){return this.each(function(){f.offset.setOffset(this,h)})}return c.call(this)}}}(jQuery));(function(a,b){a.widget("ui.autocomplete",{options:{appendTo:"body",delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},_create:function(){var c=this,e=this.element[0].ownerDocument,d;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(f){if(c.options.disabled||c.element.attr("readonly")){return}d=false;var g=a.ui.keyCode;switch(f.keyCode){case g.PAGE_UP:c._move("previousPage",f);break;case g.PAGE_DOWN:c._move("nextPage",f);break;case g.UP:c._move("previous",f);f.preventDefault();break;case g.DOWN:c._move("next",f);f.preventDefault();break;case g.ENTER:case g.NUMPAD_ENTER:if(c.menu.active){d=true;f.preventDefault()}else{c.close(f);if(c.xhr){c.xhr.abort()}break}case g.TAB:if(!c.menu.active){return}c.menu.select(f);break;case g.ESCAPE:c.element.val(c.term);booking.env.autocompleteESC=true;c.close(f);break;default:if(f.keyCode==g.BACKSPACE&&c.element.val().length<=c.options.minLength){if(c.xhr){c.xhr.abort()}}clearTimeout(c.searching);c.searching=setTimeout(function(){if(c.term!=c.element.val()){c.selectedItem=null;c.search(null,f)}},c.options.delay);break}}).bind("keypress.autocomplete",function(f){if(d){d=false;f.preventDefault()}}).bind("focus.autocomplete",function(){if(c.options.disabled){return}c.selectedItem=null;c.previous=c.element.val()}).bind("blur.autocomplete",function(f){if(c.options.disabled){return}clearTimeout(c.searching);c.closing=setTimeout(function(){c.close(f);c._change(f)},150)});this._initSource();this.response=function(){return c._response.apply(c,arguments)};this.menu=a("<ul></ul>").addClass("ui-autocomplete").appendTo(a(this.options.appendTo||"body",e)[0]).mousedown(function(f){var g=c.menu.element[0];if(!a(f.target).closest(".ui-menu-item").length){setTimeout(function(){a(document).one("mousedown",function(h){if(h.target!==c.element[0]&&h.target!==g&&!a.ui.contains(g,h.target)){c.close()}})},1)}setTimeout(function(){clearTimeout(c.closing)},13)}).menu({focus:function(g,h){var f=h.item.data("item.autocomplete");if(false!==c._trigger("focus",g,{item:f})){if(/^key/.test(g.originalEvent.type)){if(f&&f.value){c.element.val(f.value)}}}},selected:function(h,i){if(typeof(i.item)!=="undefined"&&i.item!==null){var g=i.item.data("item.autocomplete");var f=c.previous;if(c.element[0]!==e.activeElement){c.element.focus();c.previous=f;setTimeout(function(){c.previous=f},1)}if(false!==c._trigger("select",h,{item:g})){if(typeof(g)!=="undefined"){c.element.val(g.value)}}c.term=c.element.val();c.close(h);c.selectedItem=g}},blur:function(f,g){if(c.menu.element.is(":visible")&&(c.element.val()!==c.term)){c.element.val(c.term)}}}).zIndex(this.element.zIndex()+2000).css({top:0,left:0}).hide().data("menu");if(a.fn.bgiframe){this.menu.element.bgiframe()}if(booking.env.search_autocomplete_with_search_history){window.showSearchHistory=(function(g){var f=g;return function(){f._suggest({searchHistory:window.booking.env.history_search_string})}})(this)}},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove();a.Widget.prototype.destroy.call(this)},_setOption:function(c,d){a.Widget.prototype._setOption.apply(this,arguments);if(c==="source"){this._initSource()}if(c==="appendTo"){this.menu.element.appendTo(a(d||"body",this.element[0].ownerDocument)[0])}},_initSource:function(){var d=this,c={},g,h,e,f=booking.env.autocomplete_log;this.ss_log=booking.env.ss_log;if(a.isArray(this.options.source)){h=this.options.source;this.source=function(j,i){i(a.ui.autocomplete.filter(h,j.term))}}else{if(typeof this.options.source==="string"){e=this.options.source;this.source=function(j,i){var k=function(m){if(f){d.ss_log.push({l:(typeof m!=="undefined"&&m!==null&&m.length?m.length:0),ss:j.term})}i(m)};if(d.xhr){d.xhr.abort()}g=e+JSON.stringify(j);if(g in c){k(c[g]);d.xhr=null}else{d.xhr=a.getJSON(e,j,function(n,m,o){if(o===d.xhr){c[g]=n;k(n)}d.xhr=null})}}}else{this.source=this.options.source}}},search:function(d,c){d=d!=null?d:this.element.val();this.term=this.element.val();if(d.length<this.options.minLength){return this.close(c)}clearTimeout(this.closing);if(this._trigger("search",c)===false){return}return this._search(d)},_search:function(d){this.element.addClass("ui-autocomplete-loading");var c=this.options.extraParams||{};c.dest_type=booking.env.search_autocomplete_params.dest_type;c.term=d;this.source(c,this.response)},_response:function(c){if(c&&c.length){c=this._normalize(c);this._suggest(c);this._trigger("open")}else{if(booking.env.b_site_experiment_search_autocomplete_no_results_msg||(((a.isEmptyObject(c)&&booking.env.b_site_experiment_search_autocomplete_no_results_msg)||!a.isEmptyObject(c))&&booking.env.b_site_experiment_search_autocomplete_partitions)){if(booking.env.search_autocomplete_with_search_history){c.searchHistory=a.ui.autocomplete.filter(booking.env.history_search_string,this.element.val())}this._suggest(c);this._trigger("open")}else{this.close()}}this.element.removeClass("ui-autocomplete-loading")},close:function(c){clearTimeout(this.closing);if(this.menu.element.is(":visible")){this._trigger("close",c);this.menu.element.hide();this.menu.deactivate();if(typeof(c)!=="undefined"&&booking.env.autocompleteESC){c.preventDefault();booking.env.autocompleteESC=false}}},_change:function(c){if(this.previous!==this.element.val()){this._trigger("change",c,{item:this.selectedItem})}},_normalize:function(c){if(c&&c.length&&c[0].label&&c[0].value){return c}return a.map(c,function(d){if(typeof d==="string"){return{label:d,value:d}}return a.extend({label:d.label||d.value,value:d.value||d.label},d)})},_suggest:function(d){var f=this.menu.element.empty().zIndex(this.element.zIndex()+2000),e=a(f),g=booking.env.autocomplete_skip_suggestions,c="";this._renderMenu(f,d);if((d.length===0||(a.isEmptyObject(d)&&booking.env.b_site_experiment_search_autocomplete_partitions))&&booking.env.b_site_experiment_search_autocomplete_no_results_msg){g=booking.env.autocomplete_no_results;c='style="margin: 0;border: none;"'}e.append('<li id="autocomplete_skip" class="ui-menu-item" role="menuitem" '+c+'><a id="autocomplete_skip_a" class="ui-corner-all" tabindex="-1">'+g+"</a></li>");this.menu.deactivate();this.menu.refresh();this.menu.element.show().position(a.extend({of:this.element},this.options.position));if(!d.length&&(booking.env.b_action==="hotel"||booking.env.b_action==="searchresults")&&booking.env.b_site_experiment_search_autocomplete_partitions){e.removeClass("ui-autocomplete").css({width:(booking.env.b_is_ie6||booking.env.b_is_ie7)?"40%":"auto"})}else{this._resizeMenu()}},_resizeMenu:function(){var c=this.menu.element;c.outerWidth(this.element.outerWidth())},_renderMenu:function(o,p){var r=this,f=booking.env.autocomplete_log,q=false;if(booking.env.b_site_experiment_search_autocomplete_partitions){var k,g,e,n,h,m=0,d=["city","airport","district","region","country","hotel","landmark","searchHistory"],c=d.length;for(k=0;k<c;k++){h=d[k];if(p[h]){m++;n=r._normalize(p[h]);e=n.length;for(g=0;g<e;g++){if(g===0){n[0].header=h;if(m===1){n[0].first=1}}if(booking.env.user_has_search_history&&h==="searchHistory"&&!q){q=true;o.append('<li class="ui-menu-item" role="menuitem"><strong style="background:#ddd;display:block;font-weight:normal;color:#666;font-size:0.9em;padding:5px;">'+booking.env.search_you_recently_searched+"</strong></li>")}r._renderItem(o,n[g])}}}}else{a.each(p,function(i,j){if(f){j.index=i+1}r._renderItem(o,j)})}},_renderItem:function(g,o){var j=o.label,f="",m="",c="",d="",k="",n=(booking.env.b_site_experiment_search_autocomplete_partitions===2);if(booking.env.b_site_experiment_search_autocomplete_partitions){if(booking.env.search_autocomplete_with_search_history){var e=o.header,i="",h="";if(e){if(e=="searchHistory"){if(o.first){c="search_history_start"}f='<span class="autocomplete_header autocomplete_h_'+o.dest_type+'" style="float:right;position:static;">'+booking.env.autocomplete_search_history_categories[o.dest_type]+"</span>"}else{f='<span class="autocomplete_header autocomplete_h_'+o.dest_type+'" >'+booking.env.autocomplete_categories[o.header]+"</span>";m=(o.first)?"":' style="border-top: 1px solid #CCC;"'}}if(n&&e!="searchHistory"){if(o.hotels===0){booking.env.trackExperiment(booking.env.js_experiment_tracking.search_autocomplete_hotels_nearby);k='<span class="label" style="position: static;color:#888;">&nbsp;('+(booking.env.autocomplete_show_hotels_nearby?booking.env.autocomplete.hotels_nearby:("0 "+booking.env.autocomplete.hotels))+")</span>"}else{k='<span class="label" style="position: static;color:#888;">&nbsp;('+o.hotels+" "+(o.hotels==1?booking.env.autocomplete.hotel:booking.env.autocomplete.hotels)+")</span>"}}else{if(e=="searchHistory"){if(o.has_dates){i='<span class="ck_i_d">'+o.checkin_day+'</span> <span class="ck_i_m" style="display:none;">'+o.checkin_month_number+"</span>"+o.checkin_month+' <span class="ck_i_y">'+o.checkin_year+'</span> - <span class="ck_o_d">'+o.checkout_day+'</span> <span class="ck_o_m" style="display:none;">'+o.checkout_month_number+"</span> "+o.checkout_month+' <span class="ck_o_y">'+o.checkout_year+"</span>";k='<span class="label" style="position: static;color:#888;font-size:0.9em;">&nbsp;'+i+"</span>"}h=" search_history_link"}}j=f+"<span>"+j+k+"</span>";d='class="partition_item'+h+'"'}else{if(o.header){f='<span class="autocomplete_header autocomplete_h_'+o.dest_type+'" >'+booking.env.autocomplete_categories[o.header]+"</span>";m=(o.first)?"":' style="border-top: 1px solid #CCC;"'}if(n){if(o.hotels===0){booking.env.trackExperiment(booking.env.js_experiment_tracking.search_autocomplete_hotels_nearby);k='<span class="label" style="position: static;color:#888;">&nbsp;('+(booking.env.autocomplete_show_hotels_nearby?booking.env.autocomplete.hotels_nearby:("0 "+booking.env.autocomplete.hotels))+")</span>"}else{k='<span class="label" style="position: static;color:#888;">&nbsp;('+o.hotels+" "+(o.hotels==1?booking.env.autocomplete.hotel:booking.env.autocomplete.hotels)+")</span>"}}j=f+"<span>"+j+k+"</span>";d='class="partition_item"'}}else{if(o.hotels>0){j+="<span class='label'><i>&nbsp;</i>"+o.hotels+" "+(o.hotels==1?booking.env.autocomplete.hotel:booking.env.autocomplete.hotels)+"</span>"}else{j+="<span class='label'><i>&nbsp;</i>"+booking.env.autocomplete.hotels_nearby+"</span>"}c=o.dest_type}return a('<li class="'+c+'"'+m+"></li>").data("item.autocomplete",o).append(a("<a "+d+">"+j+"</a>")).appendTo(g)},_move:function(d,c){if(!this.menu.element.is(":visible")){this.search(null,c);return}if(this.menu.first()&&/^previous/.test(d)||this.menu.last()&&/^next/.test(d)){this.element.val(this.term);this.menu.deactivate();return}this.menu[d](c)},widget:function(){return this.menu.element}});a.extend(a.ui.autocomplete,{escapeRegex:function(c){return c.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(e,c){var d=new RegExp(a.ui.autocomplete.escapeRegex(c),"i");return a.grep(e,function(f){return d.test(f.label||f.value||f)})}})}(jQuery));(function(a){a.widget("ui.menu",{_create:function(){var b=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(c){if(!a(c.target).closest(".ui-menu-item a").length){return}c.preventDefault();b.select(c)});this.refresh()},refresh:function(){var c=this;var b=this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem");b.children("a").addClass("ui-corner-all").attr("tabindex",-1).mouseenter(function(d){c.activate(d,a(this).parent())}).mouseleave(function(){c.deactivate()})},activate:function(e,d){this.deactivate();if(this.hasScroll()){var f=d.offset().top-this.element.offset().top,b=this.element.attr("scrollTop"),c=this.element.height();if(f<0){this.element.attr("scrollTop",b+f)}else{if(f>=c){this.element.attr("scrollTop",b+f-c+d.height())}}}this.active=d.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",e,{item:d})},deactivate:function(){if(!this.active){return}this.active.children("a").removeClass("ui-state-hover").removeAttr("id");this._trigger("blur");this.active=null},next:function(b){this.move("next",".ui-menu-item:first",b)},previous:function(b){this.move("prev",".ui-menu-item:last",b)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(e,d,c){if(!this.active){this.activate(c,this.element.children(d));return}var b=this.active[e+"All"](".ui-menu-item").eq(0);if(b.length){this.activate(c,b)}else{this.activate(c,this.element.children(d))}},nextPage:function(d){if(this.hasScroll()){if(!this.active||this.last()){this.activate(d,this.element.children(".ui-menu-item:first"));return}var e=this.active.offset().top,c=this.element.height(),b=this.element.children(".ui-menu-item").filter(function(){var f=a(this).offset().top-e-c+a(this).height();return f<10&&f>-10});if(!b.length){b=this.element.children(".ui-menu-item:last")}this.activate(d,b)}else{this.activate(d,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))}},previousPage:function(c){if(this.hasScroll()){if(!this.active||this.first()){this.activate(c,this.element.children(".ui-menu-item:last"));return}var d=this.active.offset().top,b=this.element.height();result=this.element.children(".ui-menu-item").filter(function(){var e=a(this).offset().top-d+b-a(this).height();return e<10&&e>-10});if(!result.length){result=this.element.children(".ui-menu-item:first")}this.activate(c,result)}else{this.activate(c,this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"))}},hasScroll:function(){return this.element.height()<this.element.attr("scrollHeight")},select:function(b){this._trigger("selected",b,{item:this.active})}})}(jQuery));booking[sNSExperiments].search_autocomplete={priority:9,cur_ui_item:{},init:function(){var a=this,d=$("#destination"),c=d.closest("form"),i=c.find("fieldset"),f=false,e=false,b=false,g=false,h=false;open_calendar=function(){if(!booking.env.b_site_experiment_search_autocomplete_no_auto_cal){booking[sNSStartup].calendar.openPopupCalendar($("#homein .calendarLink").get(0))}},trackExperiments=function(){if(booking.env.autocomplete_more_params){booking.env.trackExperiment(booking.env.autocomplete_more_params)}};booking.env.ss_log=[];booking.env.autocomplete_selected={index:-1,dest_type:"none",dest_id:"none"};$("#destination").keydown(function(j){if(j.keyCode!=13){a.cur_ui_item={}}});d.autocomplete({source:"/autocomplete",extraParams:booking.env.search_autocomplete_params,minLength:2,delay:200,max:10}).bind("autocompleteselect",function(j,k){if(k.item){g=true;a.cur_ui_item=k.item;if(booking.env.autocomplete_log){booking.env.autocomplete_selected=a.cur_ui_item}if(typeof _gaq!="undefined"){booking.google.trackEvent("Click","Autocomplete",document.body.id)}if(booking.env.user_has_dates&&!booking.env.b_site_experiment_search_autocomplete_no_auto_submit){setTimeout(function(){c.submit()},50)}else{if(!$("#availcheck").attr("checked")&&(parseInt($("#checkin_day").val(),10)===0&&parseInt($("#checkout_monthday").val(),10)===0)){setTimeout(function(){if(booking.env.search_autocomplete_with_search_history_clicked){booking.env.search_autocomplete_with_search_history_clicked=false;return}open_calendar()},25)}}}}).bind("autocompleteopen",function(j,k){if($("#calendar_popup").length){booking[sNSStartup].calendar.closePopupCalendar()}if(f===false&&typeof _gaq!="undefined"){f=true;booking.google.trackEvent("View","Autocomplete",document.body.id)}});d.bind("focus",function(j,k){if(booking.env.search_autocomplete_with_search_history){showSearchHistory();$("#autocomplete_skip_a").hide()}if(booking.env.user_has_search_history){booking.env.trackExperiment(booking.env.js_experiment_tracking.search_autocomplete_with_search_history)}});if(booking.env.search_autocomplete_with_search_history){$(".search_history_link").live("click",function(m){if(!booking.env.user_has_dates){booking.env.search_autocomplete_with_search_history_clicked=true;$sel_link=$(this);var k=$sel_link.find(".ck_i_y").text()+"-"+$sel_link.find(".ck_i_m").text(),j=$sel_link.find(".ck_o_y").text()+"-"+$sel_link.find(".ck_o_m").text();$("#checkin_day").val($sel_link.find(".ck_i_d").text());$("#checkout_monthday").val($sel_link.find(".ck_o_d").text());$("#checkin_year_month").val(k);$("#checkout_year_month").val(j)}booking.google.trackEvent(booking.google.clickTracker,"Search history in autocomplete","Click on history")})}if(booking.env.autocomplete_log){d.bind("autocompleteclose",function(j,k){if(!g){booking.env.autocomplete_selected={index:-1,dest_type:"none",dest_id:"none"}}})}$("#autocomplete_skip").live("click",function(){var o=$(this),k=(!booking.env.user_has_dates&&!$("#availcheck").attr("checked")&&(parseInt($("#checkin_day").val(),10)===0&&parseInt($("#checkout_monthday").val(),10)===0));d.autocomplete("close");if(booking.env.autocomplete_log){booking.env.autocomplete_selected={index:0,dest_type:"skip",dest_id:"skip"}}a.cur_ui_item={};if(booking.env.b_site_experiment_search_autocomplete_no_results_msg){var j=$(".bigbluebutton",c);if(!k){var n=true,m=function(){j.animate({"background-color":"#003580"},function(){j.animate({"background-color":"#0896FF"});if(n){n=false;m()}})};m()}}else{if(typeof _gaq!="undefined"){booking.google.trackEvent("Click","Autocomplete Skip"+(booking.env.b_site_experiment_search_autocomplete_skip_copy?" v"+booking.env.b_site_experiment_search_autocomplete_skip_copy:""),document.body.id)}}if(k){open_calendar()}});c.bind("submit",function(n,o){if(a.cur_ui_item.dest_type){i.find("input[name='dest_type'], input[name='dest_id']").remove();i.append($("<input>",{type:"hidden",name:"dest_type",value:a.cur_ui_item.dest_type}));i.append($("<input>",{type:"hidden",name:"dest_id",value:a.cur_ui_item.dest_id}))}else{var k=$("#destination");if((k.attr("placeholder")==k.val())&&booking.env.sess_dest_id&&booking.env.sess_dest_type&&booking.env.normalize_sbox_value){i.find("input[name='dest_type'], input[name='dest_id']").remove();if(!booking.env.keep_search_name_in_autoextend&&!g){i.append($("<input>",{type:"hidden",name:"dest_type",value:booking.env.sess_dest_type}));i.append($("<input>",{type:"hidden",name:"dest_id",value:booking.env.sess_dest_id}))}}}if(booking.env.autocomplete_log&&JSON&&!h){var m=booking.env.autocomplete_selected,k="[";l=booking.env.ss_log.length;for(var j=0;j<l;j++){k+=(j>0?",":"")+JSON.stringify(booking.env.ss_log[j])}k+="]";if(l&&k!=="[]"){$.ajax({url:"/autocomplete_logging",data:{ss:k,index:m.index,d_id:m.dest_id,d_type:m.dest_type,p_id:booking.env.pageview_id}})}setTimeout(function(){c.submit()},25);h=true;return false}});return true}};