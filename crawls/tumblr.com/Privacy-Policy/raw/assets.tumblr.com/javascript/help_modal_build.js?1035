/* help_modal_template.js */
if(typeof($help_support)!="object"){$help_support={}}$help_support.modal_html='<div id="inline_support_modal_container" class="modal_alert big support_modal popover fixed"> <hr style="display:none" /><!-- HR tag is a fix for IE bug where inline styles are not processed when added by prototype.js --> <style type="text/css"> #inline_support_modal_container { border: none; padding: 0; margin-left: -300px; /* override left margin since this has less padding than usual */ -webkit-box-shadow: 0 1px 30px rgba(0,0,0,0.85); -moz-box-shadow: 0 1px 30px rgba(0,0,0,0.85); box-shadow: 0 1px 30px rgba(0,0,0,0.85); padding: 7px; background: #fff url(\'/images/airmail_stripes.png\') top left repeat; background: -webkit-linear-gradient(bottom, rgba(0, 0, 0, 0.18) 0px, rgba(0, 0, 0, 0) 50px), #fff url(\'/images/airmail_stripes.png\') top left repeat; } #inline_support_modal_container.modal_is_visible{ top: 50%; margin-top: -234px; } #inline_support_container{ border-radius: 6px; padding: 32px 25px 25px; background: white; background: -webkit-linear-gradient(bottom, rgba(0, 0, 0, 0.18) 0px, rgba(255, 255, 255, 0) 50px), white; background-position-y: 0; background-position-y: 4px, 0; background-repeat: repeat; background-repeat: repeat-x, repeat; } .support_form{ text-align: initial; text-align: start; position: relative; font-size: 16px; } .support_form label, .support_form input, .support_form textarea { font-family: \'Helvetica Neue\', Helvetica, Arial, sans-serif; } .support_form label{ text-transform: uppercase; font-size: 12px; font-weight: bold; color: #7d7d7d; display: inline-block; min-width: 70px; max-width: 250px; /* position: relative; */ /* right: 12px; */ white-space: nowrap; } .support_form.english label { text-align: right; } .support_inputs_container{ display: block; border: 1px solid #ccc; width: 100%; border-radius: 6px; } .support_form .oneline_option input{ box-sizing: border-box; } .support_form .halfline_option input{ min-width: 185px; max-width: 400px; } /* redundancy because this is resized for internationalization */ .support_form .wholeline_option input{ width: 400px; min-width: 380px; max-width: 400px } .support_form .user_info_container{ margin: 16px 0 0; } .support_form .error{ position: absolute; right: 100px; background-color: lightPink; border: 1px solid red; border-radius: 6px; } .support_form .user_info_container input, .support_form #support_form_subject, .support_form .scrollable_container textarea{ -moz-box-sizing: border-box; /* see: BUG 243412: https://bugzilla.mozilla.org/show_bug.cgi?id=243412 */ box-sizing: border-box; border: none; background: none; font-size: 16px; /* position: relative; */ /* left: -3px; */ } .support_form .oneline_option{ border-bottom: 1px solid #e5e5e5; box-sizing: border-box; whitespace: no-wrap; } .support_form .halfline_option{ min-width: 260px; max-width: 100%; float: left; margin: 0 0 10px; white-space: nowrap; } .support_form .wholeline_option{ width: 100%; } .support_form .subject_container{ padding: 1px 0 0; } .support_form .scrollable_container{ margin: 0; overflow:hidden; height: 1080px; background: #fff url(\'/images/textarea_bkgd_lines.png\'); line-height: 36px; font-size: 14px; } #support_form_body_container{ overflow-x: hidden; overflow-y: scroll; height: 252px; padding: 0; margin: 0 0 25px; } #support_form_body_label { padding: 7px 0 0; } .support_form textarea{ padding: 0 6px 6px 0; width: 436px; resize: none; height: 1000px; vertical-align: text-top; line-height: 36px; overflow: hidden; margin: -11px 2px 0; } .support_form textarea.is_safari{ margin-top: -2px !important; } /* .support_form textarea:first-line{ line-height: 32px; } */ #support_category{ float:left; } .support_form .form_controls{ float: left; } .support_form .upload_file input{ padding: 1px; line-height: initial; white-space: initial; } .support_form .upload_file{ float: right; } .support_form .gibson{ font-family: Gibson, Helvetica Neue, Helvetica, sans-serif; text-align: center; font-weight: bold; font-size: 28px; padding: 0; margin: 0 auto; color: #000; whitespace: nowrap; height: 20px; max-width: 536px; min-width: 400px; } .support_form .gibson h2{ font-family: Gibson, Helvetica Neue, Helvetica, sans-serif; text-align: center; font-weight: bold; font-size: 28px; padding: 0; margin: 0; letter-spacing: 9px; text-transform: uppercase; color: #000; whitespace: nowrap; height: 20px; max-width: 536px; display: inline-block; } .support_form .bottom_row{ padding-top: 3px; } .support_form .chrome{ height: 33px; font-size: 15px; } .support_form #reply_to_email_container { margin-right: 10px; } .support_form #support_form_submit { padding-right: 13px; padding-left: 13px; } .support_form #support_form_cancel { padding-right: 12px; padding-left: 12px; } .support_form ol{ list-style-type: none; padding: 0; margin: 0; } .support_form .background_wrapper{ -webkit-transition: all .25s; -moz-transition: all .25s; -o-transition: all .25s; transition: all .25s; border-radius: 6px; padding: 4px; margin: 0; } #support_form_error_container{ border: 1px solid #fcc; border-radius: 6px; background-color: #efefef; margin: 0; padding: 0; opacity: 0; max-height: 0; overflow: hidden; -webkit-transition-property: max-height, opacity, margin; -webkit-transition-duration: 0.5s; -webkit-transition-timing-function: ease; -moz-transition-property: max-height, opacity, margin; -moz-transition-duration: 0.5s; -moz-transition-timing-function: ease; -o-transition-property: max-height, opacity, margin; -o-transition-duration: 0.5s; -o-transition-timing-function: ease; transition-property: max-height, opacity, margin; transition-duration: 0.5s; transition-timing-function: ease; } .delay { -webkit-transition-delay: 1.0s; -moz-transition-delay: 1.0s; -o-transition-delay: 1.0s; transition-delay: 1.0s; } #support_form_error_container.has_errors{ max-height: 300px; margin-bottom: 15px; opacity: 1; overflow: auto; } .support_form .enumerated_errors{ list-style-type: none; margin: 0; } .support_form .enumerated_errors li{ margin: 0; opacity: 0; max-height: 0; overflow: hidden; -webkit-transition-property: max-height, opacity, margin; -webkit-transition-duration: 0.5s; -webkit-transition-timing-function: ease; -moz-transition-property: max-height, opacity, margin; -moz-transition-duration: 0.5s; -moz-transition-timing-function: ease; -o-transition-property: max-height, opacity, margin; -o-transition-duration: 0.5s; -o-transition-timing-function: ease; transition-property: max-height, opacity, margin; transition-duration: 0.5s; transition-timing-function: ease; } .support_form .enumerated_errors li.is_error{ opacity: 1; max-height: 100px; margin: 5px; } /* .support_form .background_wrapper.active{ background: #fff; border-radius: 6px; -webkit-box-shadow: 0 5px 11px rgba(0,0,0, 0.5); -moz-box-shadow: 0 5px 11px rgba(0,0,0, 0.5); box-shadow: 0 5px 11px rgba(0,0,0, 0.5); padding: 6px; } */ </style> <div class="support_form" id="inline_support_container"> <div> <div class="enter_info"> <div class="gibson"> <h2 id="inline_support_form_header" class="gibson" data-str_key="contact_tumblr" style="display: inline-block;">Contact Tumblr</h2> </div> <form id="inline_support_form" action="/support/ticket/new" src="" method="POST" enctype="multipart/form-data"> <iframe id="support_form_target" name="support_form_target" style="width:0;height:0;border:none;margin:0;padding:0;"></iframe> <input type="hidden" name="jsonp" value="help_modal.evaluate_response"> <input type="hidden" name="support_type" id="support_form_support_type" value=""> <input type="hidden" name="form_key" id="support_form_form_key" value=""> <div class="resizeable_options"> <div class="user_info_container"> <div class="required oneline_option halfline_option" id="reply_to_email_container"> <label for="support_form_user_email" data-str_key="support_form_user_email_label">Email</label> <input type="email" id="support_form_user_email" name="user_email" value="" placeholder="you@example.com" required data-has_placeholder="true" data-str_key="support_form_user_email_placeholder"> </div> <div class="required oneline_option halfline_option" id="reply_to_name_container"> <label for="support_form_user_name" style="text-align: left; min-width:48px;" data-str_key="support_form_user_name_label">Name</label> <input type="text" id="support_form_user_name" name="user_name" value="" placeholder="Your name" required data-has_placeholder="true" data-str_key="support_form_user_name_placeholder"> </div> <div class="clearfix" style="clear:both;"></div> </div> <div class="subject_container"> <div class="required oneline_option wholeline_option"> <label for="support_form_subject" data-str_key="support_form_subject_label"></label> <input id="support_form_subject" name="subject" required data-has_placeholder="true" data-str_key="support_form_subject_placeholder" value=""> </div> <div class="clearfix" style="clear:both;"></div> </div> <div class="required support_option" id="support_form_body_container"> <div class="scrollable_container"> <label for="support_form_body" id="support_form_body_label" data-str_key="support_form_body_label"></label> <textarea id="support_form_body" name="body" required data-has_placeholder="true" data-str_key="support_form_body_placeholder"></textarea> </div> </div> </div> <div id="support_form_error_container"> <div class="form_field_errors"> <ul class="enumerated_errors"> </ul> </div> </div> <div class="bottom_row"> <div class="upload_file" id="file_upload_container"> <label for="attachments_01" style="position:fixed; top:-500px; left:-500px; opacity: 0;" data-str_key="support_form_upload_file_label">Attach a screenshot</label> <div class="background_wrapper"> <ol> <li class="single_file"> <input type="file" name="attachments[]" id="attachments_01" accept="image/gif,image/jpeg,image/jpg,image/png" > </li> </ol> <a href="#" onclick="window.help_modal.add_another_photo(this); return false;" style="font-size: 10px; display: none;" data-str_key="support_form_upload_file_label">Add another photo.</a> </div> </div> <div class="form_controls"> <input id="support_form_submit" type="submit" class="chrome blue" style="margin: 0 6px 0 0;" value="Send" data-str_key="support_form_submit"> <input id="support_form_cancel" type="button" class="chrome white" style="margin: 0;" value="Nevermind" onclick="help_modal.hide()" data-str_key="support_form_cancel"> </div> <div class="clearfix" style="clear:both;"></div> </div> </form> </div> <div class="success" id="inline_support_success"> </div> </div> <div class="clearfix" style="clear:both;"></div> </div> </div> ';/* help_modal.js */
document.observe("dom:loaded",function(){if(typeof(help_modal)=="undefined"){help_modal={}}window.help_modal.create=function(i){i=i||{};window.help_modal=new PopoverAlertWithForm((function(){document.body.insert($help_support.modal_html);var j=$("inline_support_modal_container");return j}()));var c=null;var b=function(){if(!c){return}c=null;window.help_modal.form.querySelector("#support_form_submit").enable();alert(l10n_str.ajax_error)};var d=function(){var j,k;if((j=$("inline_support_form"))){k=j.down("#support_form_target");k.stopObserving("load");k.observe("load",function(l){if(c){clearTimeout(c);c=null}try{if(window.help_modal.form.down("#support_form_target").contentWindow.document.body.id!="support_modal_response"){window.help_modal.form.querySelector("#support_form_submit").enable();alert(l10n_str.ajax_error)}}catch(m){c=setTimeout(b,3000)}})}};var a=window.help_modal;a.context=i.context||{};a.dont_show_on_create=i.dont_show_on_create||false;if(typeof(i.subject)!="undefined"){$("support_form_subject").value=i.subject}if(i.is_safari){var h=a.form.down("textarea");h.addClassName("is_safari");new Form.Element.Observer("support_form_body",0.03,function(j,k){if(k===""){j.addClassName("is_safari")}else{j.removeClassName("is_safari")}})}a.on_show=function(){Event.observe(document,"keydown",function(j){if(Event.KEY_ESC==j.keyCode){a.hide()}})};a.show=function(k){var l;var j=this;a.show_tos_after=false;if((l=$("popover_alert_tos_container"))&&typeof(LegalPrompts)!="undefined"&&LegalPrompts.popover_alert_tos.popover.hasClassName("modal_is_visible")){LegalPrompts.popover_alert_tos.hide();a.show_tos_after=true}k=k||{};if(k.type){window.help_modal.set_category(k.type)}setTimeout(function(){PopoverAlertWithForm.prototype.show.call(j)},1)};a.on_hide=function(){if(typeof(a.show_tos_after)!="undefined"&&a.show_tos_after){setTimeout(function(){LegalPrompts.popover_alert_tos.show.call(LegalPrompts.popover_alert_tos)},1)}};a.form.onsubmit=function(j){window.help_modal.form.target="support_form_target";window.help_modal.form.querySelector("#support_form_submit").disable();d()};a.set_category=function(j){if(j){window.help_modal.form.querySelector("input[name=support_type]").value=j}};var f=i.type||"";a.set_category(f);var g=document.createElement("input");a.use_placeholders=("placeholder" in g);a.localize=function(){var p=a.popover.querySelectorAll("*[data-str_key], input");var q,j,A,v,k,o=p.length;for(q=0;q<o;q+=1){j=p[q];A=j.getAttribute("data-str_key");v=help_modal.context[A];k=help_modal.context[j.id];if(v){if(j.hasAttribute("data-has_placeholder")){j.placeholder=v}else{if(j.tagName.toLowerCase()=="input"){j.value=v}else{j.innerHTML=v}}}if(k){j.value=k}}var s=$("inline_support_container").getLayout();var z=s.get("padding-box-width")-s.get("padding-left")-s.get("padding-right");var y;var x=$("inline_support_form_header");var t=0;var u,m;var r=$$("#inline_support_modal_container .resizeable_options label");var n=0;y=(x.getDimensions()).width;while(y>=z){u=parseInt(x.getStyle("letter-spacing").match(/[0-9]+/),10);m=parseInt(x.getStyle("font-size").match(/[0-9]+/),10);m-=1;u-=1;if(u<0){u=0}x.setStyle({"font-size":m+"px","letter-spacing":u+"px"});y=(x.getDimensions()).width;if(++t>15){break}}r.each(function(l){var w=(l.getDimensions()).width;if(w>n){n=w}});if(n<=71){return}r.each(function(l){var w=l.up("div");var B=w.down("input, textarea");w.setStyle({width:z+"px"});l.style.minWidth=null;y=(z-(l.getDimensions()).width);if(B.id=="support_form_body"){y-=10}B.setStyle({width:y+"px"})})};a.localize();a.add_another_photo=function(k){k=$(k);var l=k.up(".upload_file");var j=l.down(".single_file:last").clone(true);var m=j.down("input").getAttribute("id").substr[-2];m+=1;j.down("input").writeAttribute({id:"attachments_"+(m<10?"0"+m:m)});l.down("ol").insert({bottom:j})};var e=function(k){var j=$$("#error_"+k.target.name);j.invoke("removeClassName","is_error");setTimeout(function(){k.target.stopObserving("focus",e)},1);var l=$("support_form_error_container");if(!l.down(".is_error")){l.removeClassName("delay");l.removeClassName("has_errors")}};a.evaluate_response=function(n){clearTimeout(c);c=null;$("support_form_submit").enable();if(typeof(n.meta)=="undefined"||typeof(n.response)=="undefined"){alert(l10n_str.ajax_error)}if(n.meta.status==201||n.meta.status==200){$("inline_support_success").innerHTML=n.response.message;window.help_modal.show_success();return}var m,k,o,q=false;var p=n.response.errors;var j;var l=$("support_form_error_container").down("ul");while(l.hasChildNodes()){l.removeChild(l.lastChild)}if(!p.length){return}for(m=0,k=p.length;m<k;m+=1){j=$$(".support_form [name="+p[m].name+"]");if(j&&j.length){j=j.first()}else{q=true;break}j.observe("focus",e);o=new Element("li",{id:"error_"+p[m].name});o.innerHTML=p[m].error;o.addClassName("is_error");l.insert(o)}if(q){alert(l10n_str.ajax_error);return}$("support_form_error_container").addClassName("delay").addClassName("has_errors");$("inline_support_modal_container").addClassName("animated").addClassName("shake");setTimeout(function(){$("inline_support_modal_container").removeClassName("animated").removeClassName("shake")},1250)};a.show_success=function(j){help_modal.form.reset();$("inline_support_container").down(".enter_info").hide();$("inline_support_container").down(".success").show();setTimeout(function(){help_modal.hide()},3000)};a.form.observe("click",function(l){var k=this;var j=l.findElement(".upload_file");if(typeof(j)=="undefined"||j==document){j=k.down(".upload_file");j.setStyle({overflow:"hidden"});j.down(".background_wrapper").removeClassName("active")}else{j.down(".background_wrapper").addClassName("active");j.setStyle({overflow:"visible"})}});if(!a.dont_show_on_create){a.show()}};window.help_modal.show=function(a){window.help_modal.create(a)}});