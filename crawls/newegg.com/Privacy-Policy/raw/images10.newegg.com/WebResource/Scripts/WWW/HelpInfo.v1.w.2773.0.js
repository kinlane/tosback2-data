usingNamespace("Biz.HelpInfo")["SearchBar"]={search:function(){var o=Web.UI.Form.getElement("FAQSearchForm","SearchContent");if(o!=null && !String.isNullOrEmpty(o.value)){return true;};return false;}};usingNamespace("Biz.HelpInfo")["SearchContent"]={MarkHighLight:function(obj,hlWords,orignWords){hlWords=this.AnalyzeHighLightWords(hlWords);if(obj==null || hlWords.length==0){return;};if($("SearchContent")){$("SearchContent").value=orignWords;}this.MarkHighLightCore(obj,hlWords);},MarkHighLightCore:function(obj,keyWords){var re=new RegExp(keyWords, "i");for(var i=0; i<obj.childNodes.length; i++){var childObj=obj.childNodes[i];if(childObj.nodeType==3){if(childObj.data.search(re)==-1){continue;};var reResult=new RegExp("("+keyWords+")", "gi");var objResult=document.createElement("span");objResult.innerHTML=childObj.data.replace(reResult,"<span class='highlight'>$1</span>");if(childObj.data==objResult.childNodes[0].innerHTML) {continue;};obj.replaceChild(objResult,childObj);}else if(childObj.nodeType==1){this.MarkHighLightCore(childObj,keyWords);};};},AnalyzeHighLightWords:function(hlWords) {if(hlWords==null) {return "";};hlWords=hlWords.replace(/\s+/g,"|").replace(/\|+/g,"|");hlWords=hlWords.replace(/(^\|*)|(\|*$)/g, "");if(hlWords.length==0) return "";var wordsArr=hlWords.split("|");if(wordsArr.length>1){var resultArr=this.BubbleSort(wordsArr);var result="";for(var i=0;i<resultArr.length;i++){result=result+"|"+resultArr[i];};return result.replace(/(^\|*)|(\|*$)/g, "");}else{return hlWords;};},BubbleSort:function(arr){var temp, exchange;for(var i=0;i<arr.length;i++){exchange=false;for(var j=arr.length-2;j>=i;j--){if((arr[j+1].length)>(arr[j]).length){temp=arr[j+1]; arr[j+1]=arr[j]; arr[j]=temp;exchange=true;};};if(!exchange)break;};return arr;}};usingNamespace("Biz.Info")["ContactUsForm"]={submit:function(){$("Action").value="Submit";if($("bflag").value==1){Biz.Info.ContactUsForm.reSet();return;}if(!Biz.Common.Validation.isEmail($("CustomerEmail").value.trim())){alert(Web.Lang.customerEmailAddressInvalid);$("CustomerEmail").focus();return;}if(!Biz.Common.Validation.isEmail($("ConfirmCustomerEmail").value.trim())){alert(Web.Lang.confirmCustomerEmailAddressInvalid);$("ConfirmCustomerEmail").focus();return;}if($("CustomerEmail").value!=$("ConfirmCustomerEmail").value){alert(Web.Lang.emailAddressNotMatch);$("ConfirmCustomerEmail").focus();return;}if(String.isNullOrEmpty($("UserName").value.trim())){alert(Web.Lang.userNameInvalid);$("UserName").focus();return;}if(document.getElementsByName("required1")){var v=document.getElementsByName("required1");if(v.length>0){for(var i=0;i<v.length;i++){var targetname = v[i].value;var o;if(o=$(targetname)){switch(o.type){case "text":case "textarea":if(String.isNullOrEmpty(o.value.trim())){alert(Web.Lang.pleaseInputValue);o.select();return;}break;case "checkbox":case "radio":var selected=false;if(o=document.getElementsByName(targetname)){for(ilen=0;ilen<o.length;ilen++){if(o[ilen].checked==true){selected = true;break;}}}if(!selected){alert(Web.Lang.pleaseSelect);if(document.getElementsByName(targetname))o[0].focus();return;}break;case "select-one":break;default:break;}}}}}var o = document.getElementsByTagName("textarea");if(o){for(var i=0;i<o.length-1;i++){var nName = o[i].name + "_Len";var nLen  = o[i].value.trim().length;var oNew;if(oNew = $(nName)){if(nLen > parseInt(oNew.value)){var nLable = o[i].name + "_Lable";alert(String.format(Web.Lang.limitTextDescription,oNew.value,$(nLable).value));o[i].value = o[i].value.substr(0,parseInt(oNew.value));o[i].focus();return;}}}}if(String.isNullOrEmpty($("Message").value.trim())){alert(Web.Lang.messageInvalid);$("Message").focus();return;}else if($("Message").value.trim().length>1000){alert(Web.Lang.limitMessageDescription);$("Message").value = $("Message").value.substr(0,1000);$("Message").focus();return;}$("bflag").value=1;Web.StateManager.Cookies.clear("NV_CONTACTUS_COOKIE");Web.UI.Form.submit("frmSubject");},reSet:function(){var o=document.getElementsByTagName("input");for(var i=0;i<o.length;i++){switch(o[i].type){case "text":o[i].value="";break;case "radio":case "checkbox":ochild = document.getElementsByName(o[i].name);if(ochild){for (var j=0;j<ochild.length;j++){ochild[j].checked = false;}}break;case "hidden":break;default:o[i].value="";}}o=document.getElementsByTagName("textarea");if(o){for(var i=0;i<o.length;i++){o[i].value="";$(o[i].id+"_Length").innerHTML = "0";}}$("bflag").value=0;},getCharCount:function(o,maxLen,oLen){if($(oLen)){if(o.value.length>maxLen){o.value = o.value.substr(0,maxLen);$(oLen).innerHTML = maxLen;}else{$(oLen).innerHTML =o.value.length;}}},showBlk:function(x){for(i=1;i<5;i++){document.getElementById("blk"+i).style.display="none";}document.getElementById("blk"+x).style.display="";},getQueryString:function(id){if(id=="select"||id=="empty"){return "null";};var list=id.split("-");var desc=document.getElementById("select"+list[1]);return "Action=show&SubjectID="+list[0]+"&ShortDesc="+desc.value;},jumpTo:function(id){var QueryString=Biz.Info.ContactUsForm.getQueryString(id);if(QueryString=="null"){window.location.href="CustomerService.aspx?Action=show";}else{window.location.href="CustomerService.aspx?"+QueryString;};},showForm:function(){var secs=document.getElementById("ContactUsForm");secs.style.display="";},reSection:function(){var secs=document.getElementById("ContactUsForm");secs.style.display="none";}};usingNamespace("Biz.HelpInfo")["ExtendedWarranty"]={toggle:function(link,isImg){var p=(isImg==1)?link.parentNode:link.parentNode.parentNode;var d=p.nextSibling;var i=p.getElementsByTagName("img")[0];var isrc;while(d.nodeType!=1){d=d.nextSibling;}if(d&&d.tagName!="SCRIPT"){if(p.className=='expOpen'){p.className='expFold';isrc=Web.UI.ResourceManager.Image.build("n1_plus.gif");d.style.display='none';}else{p.className='expOpen';isrc=Web.UI.ResourceManager.Image.build("n1_minus.gif");d.style.display='block';};};link.blur();if(i){i.src=isrc;};return false;},expandInit:function(id){var o=$(id);var bhe=Biz.HelpInfo.ExtendedWarranty;if(o){return bhe.toggle(o,0);}},continueShopping:function(){var o=document.getElementById("IsFAQ");if(o.value==1){window.history.go(-1);}else{window.history.go(-2);}},setBack:function(){$("IsFAQ").value=2;}};usingNamespace("Biz.HelpInfo")["FedexTracking"]={DisplayResult:function(detailInfoObject){var resultTable = "";var bhf=Biz.HelpInfo.FedexTracking;if(detailInfoObject){resultTable = bhf.GetSummaryTable(detailInfoObject) + bhf.GetHistoryTable(detailInfoObject);}var targetDiv=document.getElementById("FedexTrackResult");targetDiv.innerHTML = resultTable;},GetSummaryTable:function(detailInfoObject){var sb = new Sys.Text.StringBuilder();sb.appendLine("<table cellpadding='0' cellspacing='0' class='trackDetailUPS' width='100%'>");sb.appendLine("<tr><td>");if(detailInfoObject.qualifiedTrackNumber.trackingNumber || detailInfoObject.shipmentDatesData[0]){sb.appendLine("<table cellpadding='0' cellspacing='0' class='upsShip' width='100%'>");if(detailInfoObject.qualifiedTrackNumber.trackingNumber){sb.appendLine("<tr><td class='colTitle'>"+Web.Lang.trackingNumber+"</td><td>");sb.appendLine(detailInfoObject.qualifiedTrackNumber.trackingNumber);sb.appendLine("</td></tr>");}if(detailInfoObject.shipmentDatesData[0]){sb.appendLine("<tr><td class='colTitle'>"+Web.Lang.shipDate+"</td><td>");sb.appendLine(detailInfoObject.shipmentDatesData[0]);sb.appendLine("</td></tr>");}if(detailInfoObject.shipmentDatesData[1]){sb.appendLine("</td></tr><tr><td class='colTitle'>"+Web.Lang.deliveryDate+"</td><td>");sb.appendLine(detailInfoObject.shipmentDatesData[1]);sb.appendLine("</td></tr>");}sb.appendLine("</table>");}sb.appendLine("</td><td>");if(detailInfoObject.deliveryLocation || detailInfoObject.statusDescription){sb.appendLine("<table cellpadding='0' cellspacing='0' class='upsDest' width='100%'>");if(detailInfoObject.deliveryLocation){sb.appendLine("<tr><td class='colTitle'>"+Web.Lang.destination+"</td><td>");sb.appendLine(detailInfoObject.deliveryLocation);sb.appendLine("</td></tr>");}if(detailInfoObject.statusDescription){sb.appendLine("<tr><td class='colTitle'>"+Web.Lang.status+"</td><td>");sb.appendLine(detailInfoObject.statusDescription.replace(/\b\w+\b/g, function(word) {return word.substring(0,1).toUpperCase() + word.substring(1);}));sb.appendLine("</td></tr>");}sb.appendLine("</table>");}sb.appendLine("</td></tr>");sb.appendLine("<tr><td>");if(detailInfoObject.serviceType || detailInfoObject.weight || detailInfoObject.altRefList){sb.appendLine("<table cellpadding='0' cellspacing='0' class='upsStatus' width='100%'>");if(detailInfoObject.serviceType){sb.appendLine("<tr><td class='colTitle'>"+Web.Lang.serviceType+"</td><td>");sb.appendLine(detailInfoObject.serviceType);sb.appendLine("</td></tr>");}if(detailInfoObject.weight){sb.appendLine("<tr><td class='colTitle'>"+Web.Lang.weight+"</td><td>");sb.appendLine(detailInfoObject.weight);sb.appendLine("</td></tr>");}if(detailInfoObject.altRefList){for(var i=0; i<detailInfoObject.altRefList.length; i++){sb.appendLine("<tr><td class='colTitle'>");sb.appendLine(detailInfoObject.altRefList[i].label);sb.appendLine("</td><td>");sb.appendLine(detailInfoObject.altRefList[i].value);sb.appendLine("</td></tr>");}}sb.appendLine("</table>");}sb.appendLine("</td></tr>");sb.appendLine("</table>");return sb.toString();},GetHistoryTable:function(detailInfoObject) {if(!detailInfoObject.scans){return "";}var sb = new Sys.Text.StringBuilder();sb.appendLine("<table cellspacing='1' cellpadding='5' class='trackDetailUPSSum' width='100%'>");sb.appendLine("<tr class='sumHead'><th style='text-align: left;'>"+Web.Lang.dateAndTime+"</th><th style='text-align: left;'>"+Web.Lang.activity+"</th><th style='text-align: left;'>"+Web.Lang.location+"</th><th style='text-align: left;'>"+Web.Lang.details+"</th></tr>");var rowFlag = true;for(var i=0; i<detailInfoObject.scans.length;i++){if(rowFlag){sb.appendLine("<tr class='sumRowOdd'>");}else{sb.appendLine("<tr class='sumRowEven'>");}rowFlag = !rowFlag;sb.appendLine("<td>"+detailInfoObject.scans[i].scanDate + " " + detailInfoObject.scans[i].scanTime + "</td>");sb.appendLine("<td>"+detailInfoObject.scans[i].scanStatus + "</td>");if(detailInfoObject.scans[i].scanLocation){sb.appendLine("<td>"+detailInfoObject.scans[i].scanLocation + "</td>");}else{sb.appendLine("<td>&nbsp;</td>");}if(detailInfoObject.scans[i].scanComments){sb.appendLine("<td>"+detailInfoObject.scans[i].scanComments + "</td>");}else{sb.appendLine("<td>&nbsp;</td>");}}return sb.toString();}};usingNamespace("Biz.HelpInfo")["OverView"]={GetSubjectID:function(obj){for(var i=0;i<obj.length;i++){if(obj[i].checked){return obj[i].value;}}},CheckLiveChatStatus:function(){if(Biz.HelpInfo.Config.IsDisplayChat==1){if(helpInfoLiveChatStatus.Status == 0){Web.UI.Control.setAttribute( $('Tab_1'),{"style.display":"none"});Biz.HelpInfo.OverView.TabChange('2');};};},ChatWithUsSumbit:function(){var list=Biz.HelpInfo.Config.SubjectList.newegg;var url="";var id=Biz.HelpInfo.OverView.GetSubjectID(document.getElementsByName("ChatWithUsRadio"));for(var j=0;j<list.length;j++){if(list[j].subjectID==id){url=list[j].liveChatLink;break;};};if(url!=""){var index=url.indexOf("return false");if(index!=-1){url=url.substring(0,index);};eval(url);};},JumpTo:function(name,desc){if(name=="EmialWithUs"){var id=Biz.HelpInfo.OverView.GetSubjectID(document.getElementsByName("EmialWithUsRadio"));var list=Biz.HelpInfo.Config.SubjectList.newegg;var sid;for(var j=0;j<list.length;j++){if(list[j].subjectID==id){sid=list[j].sectionID;break;};};if(id!=""&&id!=null){window.location.href="OverView.aspx?SectionID="+sid+"&SubjectID="+id+"&ShortDesc="+desc+"#ContactUsTab";};};},TabChange:function(id){var style="over";for(var i=1;i<5;i++){if(i==id){if(i==4){style="over end";};$("Tab_"+i).className=style;Web.UI.Control.setAttribute($("ContactUsTab_"+i),{"style.display":"block"});}else{$("Tab_"+i).className="";Web.UI.Control.setAttribute($("ContactUsTab_"+i),{"style.display":"none"});};};Biz.HelpInfo.OverView.AutoHeight();},SectionChange:function(id,obj){var list=Biz.HelpInfo.Config.SubjectList.newegg;for(var i=0;i<list.length;i++){if(list[i].sectionID==id){Web.UI.Control.setAttribute($(obj+"_"+id),{"style.display":"block"});$(obj+"Section_"+list[i].sectionID).className="over";}else{if($(obj+"_"+list[i].sectionID)!=null){Web.UI.Control.setAttribute($(obj+"_"+list[i].sectionID),{"style.display":"none"});$(obj+"Section_"+list[i].sectionID).className="";};};};Biz.HelpInfo.OverView.AutoHeight();},AutoHeight:function(){if($("ChatWithUsTabs")){Web.UI.Control.setAttribute($("ChatWithUsContainer"),{"style.height":"auto"});var chatSection=$("ChatWithUsTabs").offsetHeight-2;var chatSubject=$("ChatWithUsContainer").offsetHeight;if(chatSection>chatSubject){Web.UI.Control.setAttribute($("ChatWithUsContainer"),{"style.height":chatSection+"px"});};};if($("EmialWithUsTabs")){Web.UI.Control.setAttribute($("EmialWithUsContainer"),{"style.height":"auto"});var emailSection=$("EmialWithUsTabs").offsetHeight-2;var emailSubject=$("EmialWithUsContainer").offsetHeight;if(emailSection>emailSubject){Web.UI.Control.setAttribute($("EmialWithUsContainer"),{"style.height":emailSection+"px"});};};},ResetInput:function(){var obj=$("EmailUsInput");var o=obj.getElementsByTagName("input");for(var i=0;i<o.length;i++){switch(o[i].type){case "text":o[i].value="";break;case "radio":case "checkbox":ochild = document.getElementsByName(o[i].name);if(ochild){for (var j=0;j<ochild.length;j++){ochild[j].checked = false;};};break;case "hidden":break;default:o[i].value="";};};o=document.getElementsByTagName("textarea");if(o){for(var i=0;i<o.length;i++){o[i].value="";$(o[i].id+"_Length").innerHTML = "0";};};}};