usingNamespace("Biz.Polls")["checkOption"]=function(o,v){Web.UI.Form.setValue("braFormYouTellUs","viewPoll",v);if((v=="0" && o && !String.isNullOrEmpty(o.value)) || v=="1"){Web.UI.Form.submit("braFormYouTellUs");};};usingNamespace("Biz.Common")["NewsletterSingup"]={sflag:false,verify:function(f){var msg,errorMsg;var emptyField="";f = eval("document." + f);if(String.isNullOrEmpty(f.LoginName.value)){errorMsg = "- "+Web.Lang.emailFieldEmpty;emptyField += "\n" + errorMsg;}else if(!Biz.Common.Validation.isEmail(f.LoginName.value)){errorMsg = "- "+Web.Lang.emailAddressInvalid;emptyField += "\n" + errorMsg;};if(!emptyField){return true;};msg  = "______________________________________________________\n\n";msg += Web.Lang.requestErrorDescription+".\n";msg +=Web.Lang.correctErrorDescription+ ":\n";msg += "______________________________________________________\n";if(emptyField){msg += emptyField + "\n\n";};alert(msg);return false;},hiddenframe:function(oid){var o=$(oid);if(o){Web.UI.Control.setAttribute(o,{"style.display":"none"});};},showframe:function(oid,f,fn){var o=$(oid);if(o){if(Biz.Common.NewsletterSingup.sflag){Web.UI.Control.setAttribute(o,{"style.display":""});Web.UI.Form.setValue(f,fn,Web.Lang.enterEmail);Biz.Common.NewsletterSingup.sflag=false;}else{Web.UI.Control.setAttribute(o,{"style.display":"none"});};};},nSubmit:function(f,fn){Biz.Common.NewsletterSingup.sflag=true;var flag=Biz.Common.NewsletterSingup.verify(f);return flag;},submit:function(f){if (Biz.Common.NewsletterSingup.verify(f)){Web.UI.Form.submit(f);};}};usingNamespace("Biz.Common")["TopNavigation"]={login:function(){var rtv = [];var wces=Web.Config.Environment.SSLPage;var loginName = Web.StateManager.Cookies.get(Web.StateManager.Cookies.Name.LOGIN,"CONTACTWITH");var loginID=Web.StateManager.Cookies.get(Web.StateManager.Cookies.Name.LOGIN,"LOGINID6");if (!String.isNullOrEmpty(loginID)){rtv.push("<span class=\"loginName\">" + loginName.encodeHtml() + "</span>");rtv.push("<span>&nbsp;[<a href=\"" + wces.Loginout + "\" rel=\"nofollow\">"+Web.Lang.logOut+"</a>]</span>");}else{rtv.push("<span class=\"loginName\">[<a href=\"" + wces.Login + "\" rel=\"nofollow\">"+Web.Lang.login+"</a>]</span>");};document.write(rtv.join(""));},cart:function(){var rtv = [];var wces=Web.Config.Environment.SSLPage;var crtUrl=wces.Shoppingcart+"?Submit=view";var cartInfo = Web.StateManager.Cookies.get(Web.StateManager.Cookies.Name.CART).encodeHtml();if (!String.isNullOrEmpty(cartInfo)){var cartList=cartInfo.split("|");if(cartList.length>=3&&cartList[2].trim()=="1"){cartInfo=cartInfo.substring(0,(cartInfo.indexOf("|"))-1)}if (cartInfo.indexOf("|") > 0){rtv.push("<span class=\"item toRight\"><div class=\"toLeft\"><a href=\"" + crtUrl + "\" rel=\"nofollow\">"+ cartInfo.replace("0 Item ",""+Web.Lang.items+" ").replace("Item(s) ",""+Web.Lang.items1+" ").replace(" | ","&nbsp;(") +")</a></div></span>");}else{rtv.push("<span class=\"item toRight\"><div class=\"toLeft\"><a href=\"" + crtUrl + "\" rel=\"nofollow\">"+ cartInfo.replace("0 Item ",""+Web.Lang.items+" ").replace("Item(s) ",""+Web.Lang.items1+" ") +"</a></div></span>");}}else{rtv.push("<span class=\"item toRight\"><div class=\"toLeft\"><a href=\"" + crtUrl + "\" rel=\"nofollow\">"+Web.Lang.items+"&nbsp;("+Web.Lang.currencyCode+" 0.00)</a></div></span>");};if (!String.isNullOrEmpty(cartInfo) && cartInfo.indexOf("(s)") != -1){rtv.push("<span class=\"toRight\"><a href=\"" + crtUrl + "\" class=\"noline\"><img src=\"" + Web.UI.ResourceManager.Image.build("topCartFull.gif") + "\" alt=\""+Web.Lang.shoppingCartwithItems+"\" title=\""+Web.Lang.shoppingCartwithItems+"\" style=\"border:0;\" id=\"shoppingCart\" /></a></span>");}else{rtv.push("<span class=\"toRight\"><a href=\"" + crtUrl + "\" class=\"noline\"><img src=\"" + Web.UI.ResourceManager.Image.build("n1_topCartEmptyD.gif") + "\" alt=\""+Web.Lang.emptyShoppingCart+"\" title=\""+Web.Lang.emptyShoppingCart+"\" style=\"border:0;\" id=\"shoppingCart\" /></a></span>");};document.write(rtv.join(''));},b2bSiteLogoPageHeader2011:function(b2bUrl){var loginID=Web.StateManager.Cookies.get(Web.StateManager.Cookies.Name.LOGIN,"LOGINID6");var locationURL=Web.Config.Environment.Url.WWW.toUpperCase();var theLocation=window.location.href.toUpperCase();var isHomepage=(theLocation==locationURL)||(theLocation.indexOf(locationURL+"INDEX.ASPX")!=-1);var HolidayHeaderBody=Web.UI.Control.getElementsByClassName("holidayHeader11",null,"body");var isHolidayHeader=HolidayHeaderBody&&HolidayHeaderBody.length>0;if(String.isNullOrEmpty(loginID)&&isHomepage){var html="<div class='haInfoBarPromo'><a href='"+b2bUrl+"'><img src='"+Web.UI.ResourceManager.Image.build(isHolidayHeader?"bnrB2Btop_264x29_holiday11.png":"bnrB2Btop_264x29.png")+"' alt='Upgrade to Newegg Business! click here'></a></div>";document.write(html);}},loginPageHeader2011:function(){var rtv = [];var wces=Web.Config.Environment.SSLPage;var loginName = Web.StateManager.Cookies.get(Web.StateManager.Cookies.Name.LOGIN,"CONTACTWITH");var loginID=Web.StateManager.Cookies.get(Web.StateManager.Cookies.Name.LOGIN,"LOGINID6");if (!String.isNullOrEmpty(loginID)){rtv.push("<span class=\"loginName\">");rtv.push("<a title=\""+Web.Lang.account+" \" href=\""+wces.MyAccountIndex+"\"> <img class=\"sprBase account\" alt=\"\" src=\""+Web.UI.ResourceManager.Image.build("none.gif")+"\"/>" + loginName.encodeHtml() + "</a>");rtv.push("<span class=\"loginLabel\"> &nbsp;[<a href=\"" + wces.Loginout + "\" rel=\"nofollow\">"+Web.Lang.logOut+"<span class=\"nohi\"> ]</span></a></span>");rtv.push("</span>")}else{rtv.push("<span class=\"loginName\"><a href=\"" + wces.Login + "\" rel=\"nofollow\">"+Web.Lang.login2011+"</a></span>");};document.write(rtv.join(""));},cartPageHeader2011:function(){var rtv = [];var wces=Web.Config.Environment.SSLPage;var crtUrl=wces.Shoppingcart+"?Submit=view";var cartInfo = Web.StateManager.Cookies.get(Web.StateManager.Cookies.Name.CART).encodeHtml();if(arguments.length==2){var a=arguments[1];if(a!=""){cartInfo=a;};}var imgHTML;var shoppingCartDescription;if (!String.isNullOrEmpty(cartInfo) && cartInfo.indexOf("(s)") != -1){shoppingCartDescription=Web.Lang.shoppingCartwithItems;imgHTML="<img src=\"" + Web.UI.ResourceManager.Image.build("none.gif") + "\" alt=\""+shoppingCartDescription+"\" class=\"sprBase cart_on\"  />";}else{shoppingCartDescription=Web.Lang.emptyShoppingCart;imgHTML="<img src=\"" + Web.UI.ResourceManager.Image.build("none.gif") + "\" alt=\""+shoppingCartDescription+"\"  class=\"sprBase cart_off\"  />";};if (!String.isNullOrEmpty(cartInfo)){var cartList=cartInfo.split("|");if(cartList.length>=3&&cartList[2].trim()=="1"){cartInfo=cartInfo.substring(0,(cartInfo.indexOf("|"))-1)}rtv.push("<span class=\"item toRight\"><div class=\"toLeft\"><a href=\"" + crtUrl + "\" rel=\"nofollow\" title=\""+shoppingCartDescription+"\">");rtv.push(imgHTML);rtv.push("<span>");if (cartInfo.indexOf("|") > 0 && (cartInfo.indexOf("0 Item | $ 0.00") < 0 && cartInfo.indexOf("0 Item | $0") < 0)){var tempStr=cartInfo.replace("0 Item ",""+Web.Lang.items+" ").replace("Item(s) ",""+Web.Lang.items2+" ");var tempIndex=tempStr.indexOf("|");var tempLength=tempStr.length;var pointIndex=tempStr.indexOf(".");try{var tempMoneyStr=tempStr.substring(tempIndex+3,tempLength-3).replace(" ","");if(cartInfo.indexOf("Items(s)")>0){if(tempMoneyStr.length>3){var moneyLen=parseInt(tempMoneyStr.length/3);var startIndex=tempMoneyStr.length-3*parseInt(moneyLen);var result=tempMoneyStr.substring(0,startIndex);for(var i=0;i<moneyLen;i++){result+=(result!=""?",":"")+tempMoneyStr.substring(startIndex+3*i,startIndex+3*(i+1));}tempMoneyStr=result;}}rtv.push(tempStr.substring(tempIndex+2,tempIndex+3)+tempMoneyStr.replace(" ","")+tempStr.substring(pointIndex,tempLength));rtv.push(" ("+tempStr.substring(0,tempIndex-1).replace("Item(s) ",""+Web.Lang.items2+" ").replace("Items(s)",""+Web.Lang.items2)+")");}catch(e){}}else if(cartInfo.indexOf("|") > 0){var tempIndex=cartInfo.indexOf("|");var tempStr=cartInfo.replace("0 Item ",""+Web.Lang.items+" ").replace("Item(s) ",Web.Lang.items2+" ");rtv.push(tempStr.substring(0,tempIndex));}else{rtv.push(cartInfo.replace("0 Item ",""+Web.Lang.items+" ").replace("Item(s) ",Web.Lang.items2+" "));}rtv.push("</span></a></div></span>");}else{rtv.push("<span class=\"item toRight\"><div class=\"toLeft\"><a href=\"" + crtUrl + "\" rel=\"nofollow\" title=\""+shoppingCartDescription+"\">"+imgHTML+"<span>"+Web.Lang.items+"&nbsp;</span></a></div></span>");};if(arguments.length==2){var o=arguments[0];if(o){o.html(rtv.join(''));}else{document.write(rtv.join(''));};}else{document.write(rtv.join(''));};},refleshcartPageHeader2011:function(){var o=jQuery("#haInfoBarCart");if(o){var v="";if(arguments.length==1){v=arguments[0];}Biz.Common.TopNavigation.cartPageHeader2011(o,v);};},shoppingcartnumber:function(){var rtv = [];var wces=Web.Config.Environment.SSLPage;var cartInfo = Web.StateManager.Cookies.get(Web.StateManager.Cookies.Name.CART);if (!String.isNullOrEmpty(cartInfo)){rtv.push(cartInfo.split(" ")[0]);}else{rtv.push("0");};document.write(rtv.join(''));},b2bTopBarInit:function(){var loginID=Web.StateManager.Cookies.get(Web.StateManager.Cookies.Name.LOGIN,"LOGINID6");if(String.isNullOrEmpty(loginID)){$("haInfoBarCenter").style.display="none";$("haInfoBarCombine").style.display="none";$("haInfoBarHelp").style.display="none";}}};usingNamespace("Biz.Common")["B2BLogin"] = function() {var recentOrderUrl = Web.UI.ResourceManager.Url.secure("/NewMyAccount/RecentOrder.aspx");var getRecentOrderData = function() {var script = $("b2bloginAjaxJs");if(script && script != null){document.getElementsByTagName('head')[0].removeChild(script);}script=document.createElement("script");script.type = "text/javascript";script.id= 'b2bloginAjaxJs';script.src = recentOrderUrl;document.getElementsByTagName('head')[0].appendChild(script);};var initLogin = function() {jQuery("#UserName").val(Web.Lang.emailAddress).css("color","#BABABA");jQuery("#UserPwd1").val(Web.Lang.password).css("color","#BABABA");jQuery("#UserPwd2").val("");jQuery("#UserName").focus(function() {if (jQuery(this).val() == Web.Lang.emailAddress) {jQuery(this).val("").css("color","#000").css("border-color","#BABABA");}}).blur(function () {if (jQuery(this).val() == "") {jQuery(this).val(Web.Lang.emailAddress).css("color","#BABABA");}});jQuery("#UserPwd1").focus(function() {jQuery(this).hide();jQuery("#UserPwd2").show().focus().css("color","#000").css("border-color","#BABABA");});jQuery("#UserPwd2").blur(function () {if (jQuery(this).val() == "") {jQuery(this).hide();jQuery("#UserPwd1").show().css("color","#BABABA");}});};return {SetInit : function() {var loginID = Web.StateManager.Cookies.get(Web.StateManager.Cookies.Name.LOGIN, "LOGINID6");if (loginID  && loginID.length >0) {getRecentOrderData();jQuery("#loginBefore").hide();jQuery("#loginAfter").show();}else {initLogin();jQuery("#loginBefore").show();jQuery("#loginAfter").hide();}},SetRecentOrderInit : function(ro){if(ro && ro.code && ro.code == "0" && ro.t&& ro.id && ro.id.length >0&& ro.l && ro.l.length >0) {jQuery("#recentOrderNum").html("<a href=\""+ro.l+"\">"+ro.id+"  - "+ro.t+"</a>").css("text-decoration","none");jQuery("#recentOrderStatus").text(ro.s);}else {jQuery("#recentOrderNum").text(Web.Lang.noOrderRecord).css("text-decoration","none");jQuery("#recentOrderStatus").text("");}},SetSBannerInit:function () {var loginID = Web.StateManager.Cookies.get(Web.StateManager.Cookies.Name.LOGIN, "LOGINID6");if (loginID && loginID.length >0) {jQuery("#SBannerBefore").hide();jQuery("#SBannerAfter").show();}else {jQuery("#SBannerBefore").show();jQuery("#SBannerAfter").hide();}},AccountLogin: function () {if(jQuery("#UserName").val() != Web.Lang.emailAddress && jQuery("#UserPwd2").val() != "") {Web.UI.Form.submit("BusinessLogin");}}};}();usingNamespace("Biz.Common")["Pagination"]={go:function(n,p,e,f,t){var order=$("Order_top");var ssn = null;try{ssn = Biz.SmartSearchPanel.Navigation;}catch(e){ssn = null;}if((order!=undefined && order.value=="10")||(ssn!=null && ssn.preReq.issmart)){var totalPage = parseInt($("totalPage_1").innerHTML,10);if(p<1){p=1;}if(p>totalPage){p=totalPage;}$("currentPage_1").innerHTML = p;Biz.SmartSearchPanel.Navigation.requestData();return;}p=Number.parse(p);var tid=Biz.Store;var cfg=Web.StateManager.Cookies.Name.CFG;if(p>0){if(tid&&!String.isNullOrEmpty(cfg)){if(tid.Subcategory){Web.StateManager.Cookies.save(cfg, {"Tid":tid.Tid});};};if(f){Biz.Common.Window1.loading();};var name=String.isNullOrEmpty(e)?"Page":e;Web.UI.Form.setValue(n,name,p);Web.UI.Form.submit(n);};},goSeoUrl:function(p, f, url){var order=$("Order_top");var ssn = null;try{ssn = Biz.SmartSearchPanel.Navigation;}catch(e){ssn = null;}if((order!=undefined && order.value=="10")||(ssn!=null && ssn.preReq.issmart)){var totalPage = parseInt($("totalPage_1").innerHTML,10);if(p<1){p=1;}if(p>totalPage){p=totalPage;}$("currentPage_1").innerHTML = p;Biz.SmartSearchPanel.Navigation.requestData();return;}p=Number.parse(p);var tid=Biz.Store;var cfg=Web.StateManager.Cookies.Name.CFG;if(p>0){if(tid&&!String.isNullOrEmpty(cfg)){if(tid.Subcategory){Web.StateManager.Cookies.save(cfg, {"Tid":tid.Tid});};};if(f){Biz.Common.Window1.loading();};window.location.href = url;};}};usingNamespace("Biz.Common")["initialize"]=function(){window.attachEvent("onload",(function(){Web.UI.Form.setValue("frmPaginationBottom","Page","");Biz.Common.SearchKeywords.saveExternalSearchKeywords();}));}();usingNamespace("Biz.Common")["Validation"]={isEmail:function(s){var patrn=/^([0-9a-zA-Z]([-.\w\+]*[0-9a-zA-Z_-])*@([0-9a-zA-Z][-.\w]*\.)+[a-zA-Z]{2,9})$/;return patrn.test(s);},getRegexString:function(s){if(String.isNullOrEmpty(s)){return "";};return s.replace("\\", "\\\\").replace("?", "\\?").replace("*", "\\*").replace("$", "\\$").replace("^", "\\^").replace("|", "\\|").replace(".", "\\.").replace("(", "\\(").replace(")", "\\)").replace("[", "\\[").replace("]", "\\]").replace("{", "\\{").replace("}", "\\}").replace("+", "\\+").replace("@", "\\@").replace("#", "\\#").replace("%", "\\%").replace("&", "\\&");}};usingNamespace("Biz.Common")["VeriSign"]={open:function(){var url=Biz.Footer.Config.veriSignUrl;Web.UI.Control.openWindow(url,"_blank",560,500,200,200,"resizable=yes,status=yes");}};usingNamespace("Biz.Common")["saveDepaCookie"]=function(depaID,isRollOver){var n = Web.StateManager.Cookies.Name.CFG;if(String.isNullOrEmpty(n) || String.isNullOrEmpty(depaID)){return;};Web.StateManager.Cookies.save(n, {"DEPA":depaID});if(isRollOver){Web.StateManager.Cookies.save(n, {"w39":"-999"});};};usingNamespace("Biz.Common")["QuickSearch"]={submit:	function(){var item=$("haQuickSearchBox");if(item == null){return false;}else{var description=item.value;if(String.isNullOrEmpty(description.trim())){item.focus();return false;}else{return true;};}},submitPagehHeader2011:function(){var result=false;var input=$("haQuickSearchBox");if(input != null){var inputValue=input.value.trim();if((!String.isNullOrEmpty(inputValue))&&inputValue!=Web.Lang.defaultTextInSearchBox){var haQuickSearchDropdown=document.getElementById("haQuickSearchDropdown");if( haQuickSearchDropdown != null){var selectEl=haQuickSearchDropdown.getElementsByTagName("Select")[0];var wi = Web.UI.Items;var isItem =wi.isINItem(inputValue)|| wi.isCVFItem(inputValue) || wi.isTSItem(inputValue) || wi.isGCItem(inputValue) || wi.isSellerItem(inputValue) || wi.isStandardItem(inputValue) || wi.isNeweggItem(inputValue) || wi.isParentItem(inputValue) || wi.isSFItem(inputValue) || wi.isDVDorBooksItem(inputValue) || wi.isAutoPartsItem(inputValue);if(isItem){var selectedValue = '-1';}else{var selectedValue=selectEl[selectEl.selectedIndex].value;}var inputEls=haQuickSearchDropdown.getElementsByTagName("input");for(var i=0; i<inputEls.length;i++){if(inputEls[i].name=='N'){if(inputEls[i].value == "-1"){inputEls[i].value=selectedValue;}break;}}Biz.Common.SearchKeywords.saveInternalSearchKeywords(inputValue);result=true;}}}return result;},chromeSpeechSearch:function(){if(Web.Environment.Browser.isChrome()){var searchInput=document.getElementById("haQuickSearchBox");searchInput.webkitSpeech=true;searchInput.webkitGrammar="builtin:search";}},inputFocus:function(isFocus){var input=$("haQuickSearchBox");var inputValue=input.value.trim();if(isFocus&&inputValue==Web.Lang.defaultTextInSearchBox){input.value="";}else if((!isFocus)&&inputValue==""){input.value=Web.Lang.defaultTextInSearchBox;}}};usingNamespace("Biz.Common")["AccountLogin"]={login:function(n,f,p){var account = $(n).value.toUpperCase();var pwd = $(p).value;if(account != Web.Lang.emailAddress.toUpperCase() && !String.isNullOrEmpty(pwd)){Web.UI.Form.submit(f)};},initInput:function(n,f,w){if($(n)){if(f == "userName"){if(String.isNullOrEmpty($(n).value)){$(n).value = Web.Lang.emailAddress;};}else{if(String.isNullOrEmpty($(n).value)){$(n).style.display = "none";$(w).style.display = "inline";$(w).value = Web.Lang.password;};};};},emptyInput:function(n,f,w){if($(n)){$(n).value = "";if(f == "userPwd"){$(n).style.display = "none";$(w).style.display = "inline";$(w).focus();};};},pwdInitInput:function(n){if($(n)){$(n).value = "";};},a:function(n,f,w){if(window.event.keyCode==13){Biz.Common.AccountLogin.login(n,f,w);};},onKeyUp:function(n,f,w){$(w).attachEvent("onkeyup",(function(){Biz.Common.AccountLogin.a(n,f,w)}))}};usingNamespace("Web.Survey")["Trigger"]={showNextPollSegment:function(questionID,optionID){var question=Web.Survey.Config.question;if(questionID>0 && optionID>0){var childs;var checkOption;var isCheck;for(i=0;i<question.length;i++){if(question[i].questionID==questionID){if(question[i].option.status && question[i].option.id!=optionID){isCheck=true;checkOption =question[i].option.id;break;};};};if(isCheck){Web.Survey.Trigger.hideNextPollSegment(questionID,checkOption);};for(j=0;j<question.length;j++){if(question[j].questionID==questionID && question[j].option.id == optionID){question[j].option.status=true;childs=question[j].option.childOption.split(",");break;};};for(k=0;k<childs.length;k++){if(!String.isNullOrEmpty(childs[k])){$("choice"+childs[k]).style.display="";};};};Web.Survey.Trigger.displayChoiceAll();return true;},hideNextPollSegment:function(questionID,optionID){var question=Web.Survey.Config.question;if(questionID>0 && optionID>0){var childs=[];for(i=0;i<question.length;i++){if(question[i].questionID == questionID && question[i].option.id==optionID && question[i].option.status){childs=question[i].option.childOption.split(",");break;};};var allChilds = childs;childs = Web.Survey.Trigger.getAllcheckChilds(allChilds);if(childs.length > allChilds.length){childs = Web.Survey.Trigger.getAllcheckChilds(allChilds);};if(childs.length>0){for(var j=0;j<childs.length;j++){if(!String.isNullOrEmpty(childs[j])){question[j].option.status=false;var boxlist;boxlist = document.getElementsByName("OPTION_"+childs[j]);if(typeof boxlist!="undefined" && boxlist.length>0){for(var k=0;k<boxlist.length;k++){boxlist[k].checked =false;};};$("choice"+childs[j]).style.display="none";Web.Survey.Trigger.updateQuestionStatus(childs[j]);};};}else{return true;};};},getAllcheckChilds:function(allChilds){var childs=[];childs=allChilds;if(allChilds.length>0){for(j=0;j<allChilds.length;j++){if(Web.Survey.Trigger.getQuestionStatus(allChilds[j])){var tmpchild = Web.Survey.Trigger.getcheckChilds(allChilds[j]).split(",");if(tmpchild.length>0){childs.concat(tmpchild).uniq;};};};};return childs;},updateQuestionStatus:function(questionID){var question=Web.Survey.Config.question;if(questionID>0){for(i=0;i<question.length;i++){if(question[i].questionID == questionID && question[i].option.status){question[i].option.status=false;};};};},getQuestionStatus:function(questionID){var question=Web.Survey.Config.question;if(questionID>0){for(i=0;i<question.length;i++){if(question[i].questionID == questionID && question[i].option.status){return true;};};};return false;},getcheckChilds:function(questionID){var question=Web.Survey.Config.question;for(i=0;i<question.length;i++){if(question[i].questionID == questionID && question[i].option.status){return question[i].option.childOption;};};return "";},uniq:function(){var temp = {},len =this.length;for(var i=0;i <len;i++){if(typeof temp[this[i]]=="undefined") {temp[this[i]] = 1;};};this.length = 0;len = 0;for(var i in temp) {this[len++] = i;};return this;},ValidateForm:function(){var question=Web.Survey.Config.question;var elname="";var el;el = document.getElementsByTagName("li");if(typeof el!="undefined" && el.length>0){for(var i=0;i<el.length;i++){var eltext;var elinputs;var bcheck = false;if(typeof el!="undefined" && typeof el[i]!="undefined" && el[i].style.display!="none"){var id = i+1;var isCheck=false;for(var k=0;k<question.length;k++){if(question[k].questionID == id){isCheck=question[k].isCheck;break;};};eltext = document.getElementsByTagName("textarea");if(typeof eltext!="undefined" && typeof eltext[i]!="undefined"&&isCheck){if(eltext[i].value.length>500){alert(" - You have exceeded the 500 characters limit. - ");eltext[i].focus();return;};};elinputs=document.getElementsByTagName("input");if(typeof elinputs!="undefined" && elinputs.length>0){var elinput,qid;for(var j=0;j<elinputs.length;j++){if(elinputs[j].id==("OPTION_"+id)){elinput = elinputs[j];qid=j;break;};};if(typeof elinput!="undefined"&&isCheck){var optionlist;optionlist=document.getElementsByName("OPTION_"+id);for(var j=0;j<optionlist.length;j++){if(optionlist[j].checked){bcheck = true;break;};};if(!bcheck&&isCheck){alert(" --Please Check-- ");elinputs[qid].focus();return;};};};};};};document.forms["frmPollContent"].submit();},closeSurveyWindow:function(){window.close();},check:function(popUrl,width,height){var visit=Web.StateManager.Cookies.get(Web.StateManager.Cookies.Name.DEVICEINFO,"SurveyVisit");visit=String.isNullOrEmpty(visit)?1:parseInt(visit);Web.StateManager.Cookies.save(Web.StateManager.Cookies.Name.DEVICEINFO,{"SurveyVisit":(visit+1)});var config=Web.Survey.CFG;var isShowSurvey = false;if(config&&typeof config.preCondition!="undefined"&&config.preCondition.enabled){var isInclude=false;if(config.preCondition.includePageList.length==0){isInclude=true;}else{for(var i=0;i<config.preCondition.includePageList.length;i++){var p=config.preCondition.includePageList[i];if (!String.isNullOrEmpty(p)){p=p.toLowerCase();};if(p=="/index.aspx"&&location.href.toLowerCase()==Web.Config.Environment.Url.WWW.toLowerCase()){isInclude=true;break;};if(location.href.toLowerCase().indexOf(p)!=-1){isInclude=true;break;};};};var isExclude=false;if(config.preCondition.excludePageList.length==0){isExclude=false;}else{for(var i=0;i<config.preCondition.excludePageList.length;i++){var p=config.preCondition.excludePageList[i];if (!String.isNullOrEmpty(p)){p=p.toLowerCase();};if(p=="/index.aspx"&&location.href.toLowerCase()==Web.Config.Environment.Url.WWW.toLowerCase()){isExclude=true;break;};if(location.href.toLowerCase().indexOf(p)!=-1){isExclude=true;break;};};};if(isInclude && !isExclude){var queen=[];for(var i=0;i<config.preCondition.percentage;i++){queen.push(i+1);};var key=parseInt(Math.random()*100);isShowSurvey = queen.contains(key);};};var surveyFlag = Web.StateManager.Cookies.get(Web.StateManager.Cookies.Name.GOOGLEANALYTICS,"SurveyFlag");var flag=false;if(!String.isNullOrEmpty(surveyFlag) && surveyFlag.indexOf("Y") != -1){flag=true;};if(isShowSurvey && parseInt(config.preCondition.minVisit)>0 && visit>=parseInt(config.preCondition.minVisit) && !flag){Web.UI.Control.openWindow(popUrl,'_blank',width,height,200,280,'toolbar=0,menubar=0,location=0,resizable=0,scrollbars=1,status=1');};},displayChoiceAll:function(){$("choiceAll").style.display="";}};usingNamespace("Biz.Common")["SearchKeywords"] = function() {var googleUrl = "google.com";var bingUrl = "bing.com";var queryName = "q";var queryValue = "";var maxKeywords = 10;var maxKeywordsLength = 50;var searchKeywordsArray = [];var searchMaxSplit = "|";var getUrlParameter = function(name) {return decodeURI((RegExp('[?|&]'+name + '=' + '(.+?)(&|$)').exec(document.referrer)||[,""])[1]);};var removeElementFromArray = function(a,ev) {for (var ci = 0; ci < a.length; ci++){if (a[ci].toLowerCase() == ev.toLowerCase()){a.splice(ci, 1);}}return a;};var removeSpace = function(k) {var str="";if(k.length >0) {var array = k.split(" ");var s = "";for(var i=0;i<array.length;i++) {s = array[i];if(s.length>0) {str += s.trim() + " ";}}}return str.trim();};var addRecentlySearchKeywords = function(keyword) {var spReg = new RegExp("[,|]","g");keyword = keyword.replace(spReg," ");keyword = removeSpace(keyword);var cookieValue = Web.StateManager.Cookies.get(Web.StateManager.Cookies.Name.PRDLIST,"ItemSearchKeyWords").trim();if(cookieValue.length>0) {if(cookieValue.indexOf(searchMaxSplit)>0) {maxKeywords = parseInt(cookieValue.split(searchMaxSplit)[0]);cookieValue = cookieValue.split(searchMaxSplit)[1];if(cookieValue.length>0) {searchKeywordsArray = cookieValue.split(",");searchKeywordsArray = removeElementFromArray(searchKeywordsArray,keyword);if (searchKeywordsArray.length >= maxKeywords && searchKeywordsArray.length > 0){searchKeywordsArray.splice(maxKeywords-1,searchKeywordsArray.length-maxKeywords+1);}if (searchKeywordsArray.length < maxKeywords){searchKeywordsArray.unshift(keyword);}cookieValue = maxKeywords.toString() + searchMaxSplit + searchKeywordsArray.toString();Web.StateManager.Cookies.save(Web.StateManager.Cookies.Name.PRDLIST,{"ItemSearchKeyWords":cookieValue});}}} else {cookieValue = maxKeywords.toString() + searchMaxSplit + keyword;Web.StateManager.Cookies.save(Web.StateManager.Cookies.Name.PRDLIST,{"ItemSearchKeyWords":cookieValue});}};return {saveExternalSearchKeywords:function () {var referralUrl = document.referrer;if(referralUrl) {if(referralUrl.indexOf(googleUrl)>0) {queryValue = getUrlParameter(queryName);}else if(referralUrl.indexOf(bingUrl)>0) {queryValue = getUrlParameter(queryName);}if(queryValue.length > 0 && queryValue.length <= maxKeywordsLength) {addRecentlySearchKeywords(queryValue);}}},saveInternalSearchKeywords:function (keyword) {if(keyword.length > 0 && keyword.length <= maxKeywordsLength) {addRecentlySearchKeywords(keyword);}}};}();usingNamespace("Biz.Common")["KeyWordsRule"] = {ForReviewCenter: function (key) {var keyArray = new Array();if (!String.isNullOrEmpty(key)) {key = key.replace(" ", "|").replace(",", "|").replace(";", "|");keyArray = key.split("|");var result = "";if (keyArray.length > 1) {for (var i = 0; i < keyArray.length; i++) {result = result + "|" + keyArray[i];};return result.replace(/(^\|*)|(\|*$)/g, "");}};return keyArray;}};usingNamespace("Biz.Common")["SearchManager"] = {setHightLight: function (container, keyWords) {var re = new RegExp(keyWords, "i");for (var i = 0; i < container.childNodes.length; i++) {var childObj = container.childNodes[i];if (childObj.nodeType == 3) {if (childObj.data.search(re) == -1) { continue; };var reResult = new RegExp("(" + keyWords + ")", "gi");var objResult = document.createElement("span");objResult.innerHTML = childObj.data.replace(reResult, "<span class='highlight'>$1</span>");container.replaceChild(objResult, childObj);}else if (childObj.nodeType == 1) {this.setHightLight(childObj, keyWords);};};},setHightLightForElements: function (elements, keyWords) {if (elements) {var l = elements.length;for (var i = 0; i < l; i++) {this.setHightLight(elements[i], keyWords);};};}};usingNamespace("Biz.Common")["CommonPop"] = {init:function(){jQuery("a[rel='CommonPopup']").unbind().click(function(){switch(jQuery(this).attr("name")){case "a-seller":jQuery('#AlarmPanelNewCommon .title').text(Web.Lang.marketplaceSeller);break;case "ship-free":jQuery('#AlarmPanelNewCommon .title').text(Web.Lang.shippingRestrictions);jQuery('#AlarmPanelNewCommon').attr('class','atnIcon icnInfoNew');break;case "ship-by-newegg":jQuery('#AlarmPanelNewCommon .title').text(Web.Lang.shippedByNewegg);break;case "terms-mfrwarranty":jQuery('#AlarmPanelNewCommon .title').text(Web.Lang.warrantyInfo);break;}Biz.Common.CommonPop.popupDiv(this,400,200);});jQuery("#overlay").click(function(){Biz.Common.CommonPop.closePopup()});Biz.Common.CommonPop.resetPopup();jQuery(document).keypress(function (e) {if(jQuery("#modalCommon").css("display")=="block" && (e.which==0 || e.which==27)){Biz.Common.CommonPop.closePopup();return false;}return true;});},popupDiv:function(o,w,h){o.blur();var vp= Biz.Common.Viewport;var wuc=Web.UI.Control;var pos=jQuery(o).offset();var width=jQuery(o).width();var pX=(pos.left+width<vp.right()-w)?pos.left+width:vp.right()-w;var pY=(pos.top<vp.bottom()-h)?pos.top:vp.bottom()-h;var body=document.getElementsByTagName("body")[0];jQuery("#modalCommon").css({"left":pX+"px","top":pY+"px"});jQuery("#modalCommon").removeClass('objVideo');jQuery("#modalCommon").children(".content").html('');jQuery("#modalCommon").toggleClass('loading');jQuery("#overlay").css("display","block");if(Web.Environment.Browser.currentVersion()==Web.Enum.Browser.IE_6){wuc.setAttribute($("overlay"),{"style.height":(body.scrollHeight+50)+"px"});wuc.setAttribute($("overlay"),{"style.width":(body.scrollWidth)+"px"});$("overlay").innerHTML="<iframe style='position:absolute;width:100%;height:100%;_filter:alpha(opacity=0);opacity=0;border-style:none;'></iframe>";wuc.setAttribute($("modalCommon"),{"style.height":"6em"});};jQuery("#modalCommon").show("fast");if(o.id&& $(o.id+"_Content")){jQuery("#modalCommon").children(".content").html($(o.id+"_Content").innerHTML);}else if(o.name&& $(o.name+"_Content")){jQuery("#modalCommon").children(".content").html($(o.name+"_Content").innerHTML);}return false;},closePopup:function(){jQuery("#modalCommon").hide("fast");jQuery("#overlay").css("display","none");Biz.Common.CommonPop.resetPopup();return true;},resetPopup:function(){jQuery('#AlarmPanelNewCommon').attr('class','atnIcon icnInfo');jQuery('#AlarmPanelNewCommon .title').text('');jQuery('#AlarmPanelNewCommon').find("img").css("display","");}};usingNamespace("Biz.Common")["CheckCANIP"] = {initPopup:function(){var cookieISCANIP = Web.StateManager.Cookies.get(Web.StateManager.Cookies.Name.COUNTRY);var cookieCFG = Web.StateManager.Cookies.get(Web.StateManager.Cookies.Name.CFG,"TransferToCAN");if(cookieISCANIP == "C"){if(cookieCFG=="1"){window.location.href = CANSite + "?cm_sp=CANGEO-_-preference-_-Canada&cm_mmc=CANGEO-_-preference-_-Canada-_-NA";}};if(String.isNullOrEmpty(cookieISCANIP)||String.isNullOrEmpty(cookieCFG)){jQuery(function(){if(!(typeof(noPopup)=="boolean" && noPopup==true)){Biz.Common.CheckCANIP.processAction();};});}},showPop:function(){jQuery("#overlay").show();jQuery('#overlay').addClass("dark").click(function(){jQuery(this).hide();jQuery('#canPopup').fadeOut();});var popup =jQuery("<div id=\"canPopup\"><div class=\"round\"><div class=\"closeIcon\" onclick=\"Biz.Common.CheckCANIP.closeIcon()\" id=\"closeIcon\"></div>"+"<div class=\"grpHeader\"><span class=\"q\">Did you <em>know...?</em></span><img src=\""+Web.UI.ResourceManager.Image.build("nec_logo.png")+"\" class=\"nec_logo\"/>"+"<span class=\"msg\">Newegg has a site just for our <em>Canadian Shoppers!</em></span></div><ul class=bullet><li>All prices in Canadian currency</li><li>Super-fast shipping & Hassle Free returns</li>"+"<li>Thousands of product review</li><li>Exceptional Newegg service</li><li>\"Exactly what you want Guarantied\"</li></ul><a href=\""+CANSite+"?cm_sp=CANGEO-_-popup-_-Canada&cm_mmc=CANGEO-_-popup-_-Canada-_-NA\"  onclick=\"Web.StateManager.Cookies.save(Web.StateManager.Cookies.Name.CFG, {'TransferToCAN':'1'});\" class=\"atnPrimary\">Shop <em>Newegg.ca</em> today!</a>"+"<div href=\""+Web.Config.Environment.Url.WWW+"\" class=\"atnSecondary\">No, take me to <a href=\""+Web.Config.Environment.Url.WWW+"?cm_sp=CANGEO-_-popup-_-USA\" onclick=\"Web.StateManager.Cookies.save(Web.StateManager.Cookies.Name.CFG, {'TransferToCAN':'0'})\"  class=\"link_blue\" >Newegg.com</a>.</div></div></div>");popup.appendTo(document.body);var ileft=(jQuery(window).width()-popup.width())/2+document.documentElement.scrollLeft;var itop=(jQuery(window).height()-popup.height())/2+document.documentElement.scrollTop;popup.css({position:"absolute",top:itop+"px",left:ileft+"px"}).show();},closeIcon:function(){jQuery('#canPopup').fadeOut();jQuery('#overlay').hide();Web.StateManager.Cookies.save(Web.StateManager.Cookies.Name.CFG, {'TransferToCAN':'0'});cmCreateManualLinkClickTag(Web.Config.Environment.Url.WWW + "?cm_sp=CANGEO-_-popup-_-USA");},processAction: function () {var cookieISCANIP = Web.StateManager.Cookies.get(Web.StateManager.Cookies.Name.COUNTRY);if(String.isNullOrEmpty(cookieISCANIP)){jQuery.get(Web.UI.ResourceManager.Url.www("Common/ajax/CheckIsCANIPHandler.aspx"),{Action:"get"},function (data){if(data){Web.StateManager.Cookies.save(Web.StateManager.Cookies.Name.COUNTRY,data);cookieISCANIP=data;if(cookieISCANIP=="C"){Biz.Common.CheckCANIP.showPop();}}});}else if(cookieISCANIP == "C"){var cookieCFG = Web.StateManager.Cookies.get(Web.StateManager.Cookies.Name.CFG,"TransferToCAN");if(cookieCFG=="1"){window.location.href = CANSite + "?cm_sp=CANGEO-_-preference-_-Canada&cm_mmc=CANGEO-_-preference-_-Canada-_-NA";}else if(String.isNullOrEmpty(cookieCFG)){Biz.Common.CheckCANIP.showPop();}}}};usingNamespace("Biz.Common")["NVTC"] = {generateAndUpdate: function () {var utma = Web.StateManager.Cookies.get(Web.StateManager.Cookies.Name.NVTC);var match = location.host.match(/\w+\.(\w+[\.\w+]+)/);var domain;if (match && match.length > 1){domain = match[1];}var siteID = Web.Config.NVTC.SiteID;var expireDate = new Date();expireDate.setFullYear(expireDate.getFullYear() + 2);if (utma) {utma = this.refresh(utma, domain, siteID);}else {utma = this.generate(domain, siteID);}document.cookie = "NVTC=" + utma + "; domain=" + domain + "; expires=" + expireDate.toGMTString() + "; path=/";},generate: function (domain, siteID) {var domainHash = this.getDomainHash(domain);if (domainHash == 0){return "";}var id = this.random;var ct = this.totalSeconds;var utmaAry = new Array(7);utmaAry[0] = domainHash.toString();utmaAry[1] = siteID;utmaAry[2] = id.toString();utmaAry[3] = ct;utmaAry[4] = ct;utmaAry[5] = ct;utmaAry[6] = "1";return this.getUtma(utmaAry);},refresh:function(utma,domain,siteID){var utmaAry = utma.split(".");if (utmaAry.length != 7) {return utma;}var domainHash = this.getDomainHash(domain);if ((domainHash + "." + siteID) != (utmaAry[0] + "." + utmaAry[1])) {return this.generate(domain, siteID);}var currentAccessTime = this.totalSeconds;var lastAccessTime = parseInt(utmaAry[5]);if((lastAccessTime + this.UTMAExpireTime*60 <= currentAccessTime)){utmaAry[4] = utmaAry[5];utmaAry[5] = currentAccessTime.toString();utmaAry[6] = parseInt(utmaAry[6])+1;utma = this.getUtma(utmaAry);}return utma;},getUtma:function (utmaAry){return utmaAry[0] + "." + utmaAry[1] + "." + utmaAry[2] + "." + utmaAry[3] + "." + utmaAry[4] + "." + utmaAry[5] + "." + utmaAry[6];},getDomainHash: function (a) {var b = 1, c = 0, d = 0, b = 0;if (a) {for (d = a.length - 1; 0 <= d; d--) {c = a[d].charCodeAt();b = (b << 6 & 268435455) + c + (c << 14);c = b & 266338304;b = 0 != c ? b ^ c >> 21 : b;}}return b;},totalSeconds: Date.parse(new Date()) / 1000,random: Math.floor(Math.random() * 1000000000),UTMAExpireTime : Web.Config.NVTC.UTMAExpireTime};