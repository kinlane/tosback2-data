(function(){var scope=SA.UsingNamespace("SA.Promotion");scope.SecPagePopup=new function(){var self=this;var emailInput,stocksInput,goBtn,error,loader,eventSource;var buildEventSource=function(unit){eventSource="sec popup";SA.Promotion.Quote.SetEventSource(eventSource);}
this.showOnSecondPage=function(){if(SA.Data.User.loggedIn())return;if(top.location.search=="?source=refreshed"||SA.Utils.SASource.isAutoRefreshed())return;if(top.location.href.match("source=themarkets"))return;if(/^(\/account\/|\/email_preferences)/.test(top.location.pathname))return;if(top.location.pathname=="/")return;if(navigator.userAgent.toLowerCase().indexOf('iphone')!=-1)return;var secPopCount=parseInt(SA.Data.Cache.Get('sec_pop'))||0;if(secPopCount<2){if(secPopCount==1){if(new ABTest("Sec popup",['old','rta']).value=='old'){open_header_log_in_popup_lightbox('login','');SA.Stats.GA.event('RTA','sec popup','page views (old popup)',0,true);}else{new Ajax.Request("/memcached2/email_subscr_count",{method:"GET",onSuccess:function(response){SA.Promotion.SecPagePopup.show(response.responseText);}});}}
SA.Data.Cache.Set('sec_pop',secPopCount+1);}}
this.show=function(numOfPeople){var html=[];html.push('<div class="rta_sec_popup">')
html.push('<div onclick="AlphaBox.Close()" class="close_pop"></div>')
html.push('<div class="title_wrap">')
html.push('  <h1>SEEKING ALPHA REAL-TIME EMAIL ALERTS</h1>')
html.push('  <h2>CRITICAL INFORMATION ON THE STOCKS YOU CARE ABOUT</h2>')
html.push('</div>')
html.push('<h3><span>'+numOfPeople+'</span> people have subscribed to Seeking Alpha alerts</h3>');html.push('<div class="bottom_wrap">');html.push('<input id="rta_popup_stocks" empty="Add stocks you care about (e.g. GOOG, AAPL)" title="Add stocks you care about">');html.push('<input id="rta_popup_email" style="margin-bottom:0;" emailautofill="on" empty="Fill in your email address" title="Fill in your email address">');html.push('<div id="rta_popup_error" style="display:none"></div>');html.push('<div id="rta_popup_go">Get Alerts</div>');html.push('<div id="rta_popup_loader" style="float:right;margin-top:20px;display:none"><img src="http://static3.cdn-seekingalpha.com/images/loader.gif" alt="Loading..." /></div>');html.push('</div>');html.push('</div>');AlphaBox.Loading();AlphaBox.AddHtml(html.join(''));goBtn=new SA.Utils.Button({element:'rta_popup_go',onclick:self.go,loaderObj:'rta_popup_loader'});stocksInput=SA.Utils.Expansion.Input('rta_popup_stocks',{autocomplete:{stocks:true}});emailInput=SA.Utils.Expansion.Input('rta_popup_email',{onEnterKey:goBtn.click});error=$('rta_popup_error');loader=$('rta_popup_loader');buildEventSource();SA.Promotion.Quote.trackPV();}
var showErr=function(text,input){error.update(text).show();if(input)input.ErrorMode();}
var hideErr=function(){if(emailInput)emailInput.ClearErrorMode();if(stocksInput)stocksInput.ClearErrorMode();error.hide();}
this.go=function(){buildEventSource();hideErr();SA.Promotion.Quote.trackEvent('Clicked GO',{value:stocksInput.Empty()?0:(stocksInput.value.match(/[a-z.-]+/gi)||[]).length});if(stocksInput.Empty()){showErr('*Stock can\'t be blank',stocksInput)
SA.Promotion.Quote.trackEvent('Reg err: didn\'t fill stocks');return;}
var stocks=SA.Models.StockModel.stringToStocksArray(stocksInput.value);if(stocks[1].length>0||stocks[0].length==0){showErr("Symbol(s) not recognized: "+stocks[1].join(","))
stocksInput.value=stocks[0].join(",");SA.Promotion.Quote.trackEvent('Reg err: unrecognized stocks');return;}
stocks=stocks[0].join(",");var email=emailInput.GetValue();var regSuccess=function(response){goBtn.UnLock();self.showThankYou(stocks,email);}
var regFailure=function(response){goBtn.UnLock();if(response.errors=='already_registered')self.showLogin(stocks,email);else{var er={'invalid_email':'Invalid Email'}[response.errors]||"Unknown error";showErr(er)
emailInput.ErrorMode();}}
if(emailInput.Empty()){showErr("*Fill your email to continue",emailInput);;SA.Promotion.Quote.trackEvent('Reg err: didn\'t fill email');return;}
goBtn.Lock();SA.Promotion.Quote.Register(email,stocks,regSuccess,regFailure);}
this.showLogin=function(stocks,email){var html=[];html.push('<div class="rta_pop_hp">');html.push('  <div class="rta_pop_hp_close" onclick="AlphaBox.Close()">X</div>');html.push('  <div class="rta_pop_hp_top">');html.push('    <div class="green_title">You\'re already registered with <span id="rta_popup_login_email_placeholder">&nbsp;</span> <div class="please_fill_password">Please fill in your password to continue.</div></div>');html.push('  </div>');html.push('  <div class="rta_pop_hp_bottom">');html.push('   <div class="input_wrapper">');html.push('     <input class="input_password" type="password" title="Password" empty="Password" id="rta_popup_password" />');html.push('     <div class="cleaner"></div>');html.push('     <div class="error" id="rta_popup_login_err"></div>');html.push('     <div class="forgot_password" id="rta_popup_login_fp">Forgot Password?</div>');html.push('   </div>');html.push('   <div class="cleaner"></div>');html.push('   <div class="save next" id="rta_popup_login_next">Next</div>');html.push('   <div style="float:left;margin:10px 0 0 10px;display:none" id="rta_popup_login_loader"><img src="http://static3.cdn-seekingalpha.com/images/loader.gif" alt="Loading..." /></div>');html.push('   <div class="cleaner"></div>');html.push('  </div>');html.push('  <div class="cleaner"></div>');html.push('</div>');AlphaBox.Loading();AlphaBox.AddHtml(html.join('\n'));$('rta_popup_login_email_placeholder').update(email);var loginErr=$('rta_popup_login_err'),password=SA.Utils.Expansion.Input('rta_popup_password'),emailPlaceholder=$('rta_popup_login_email_placeholder'),loginContinue=new SA.Utils.Button({element:$('rta_popup_login_next'),onclick:function(){loginErr.style.display='none';loginContinue.Lock();SA.Promotion.Quote.Login(email,password.GetValue(),function(){loginContinue.UnLock();location.reload();},function(response){loginContinue.UnLock();var er={'invalid_email':'Invalid Email','empty_password':"Password shouldn't be empty",'login_failed':"Wrong password"}[response.errors]||"Unknown error";loginErr.innerHTML=er;loginErr.style.display='block';password.Reset();password.ErrorMode();},{addStocks:stocks,addRTA:true});},loaderObj:'rta_popup_login_loader'}),forgotPassword=new SA.Utils.Button({element:$('rta_popup_login_fp'),onclick:function(){loginErr.style.display='none';forgotPassword.Lock();SA.Promotion.Quote.ForgotPassword(email,function(response){forgotPassword.UnLock();if(AlphaBox.onBeforeClose)AlphaBox.onBeforeClose();SA.Promotion.Quote.ForgotPasswordMsg();},function(response){forgotPassword.UnLock();var er={'invalid_email':'Invalid Email'}[response.errors]||"Unknown error";loginErr.innerHTML=er;loginErr.style.display='block';});},loaderObj:'rta_popup_login_loader'});password.setOnEnterKey(loginContinue.click);loginErr.style.display='none';emailPlaceholder.innerHTML=email;setTimeout(function(){password.focus()},500);}
this.showThankYou=function(stocks,email){var html=[];html.push('<input type="hidden" id="rta_popup_stocks">');html.push('<div class="rta_pop_hp">');html.push('  <div class="rta_pop_hp_close" onclick="AlphaBox.Close()">X</div>');html.push('  <div class="rta_pop_hp_top">');html.push('    <div class="green_title">Thanks for registering for Seeking Alpha real-time email alerts</div>');html.push('    <p>A confirmation email has been sent to <strong id="rta_popup_email_placeholder">&nbsp</strong>.</p>');html.push('    <p class="last_p">Please confirm your registration by clicking the link in the email</p>');html.push('    <p class="if_not_correct_email" id="rta_popup_email_fix_lnk_container">If this isn\'t your correct email address please <span id="rta_popup_email_fix_lnk" class="link">click here</span></p>');html.push('    <div class="cleaner"></div>');html.push('  </div>');html.push('  <div class="rta_pop_hp_bottom" id="rta_popup_container_fix" style="display:none">');html.push('   <div class="input_wrapper">');html.push('     <input type="text" id="rta_popup_email" emailautofill="on" empty="Fill in your email address" />');html.push('     <div class="save" id="rta_popup_go">Save</div>');html.push('   <div style="float:left;margin:10px 0 0 10px;display:none" id="rta_popup_loader"><img src="http://static3.cdn-seekingalpha.com/images/loader.gif" alt="Loading..." /></div>');html.push('     <div class="error" id="rta_popup_error"></div>');html.push('   </div>');html.push('   <div class="cleaner"></div>');html.push('  </div>');html.push('  <div class="cleaner"></div>');html.push('</div>');AlphaBox.Loading();AlphaBox.AddHtml(html.join('\n'));stocksInput=SA.Utils.Expansion.Input('rta_popup_stocks',{autocomplete:{stocks:true},onEnterKey:self.go});stocksInput.SetValue(stocks);emailInput=SA.Utils.Expansion.Input('rta_popup_email');$('rta_popup_email_placeholder').update(email);error=$('rta_popup_error');loader=$('rta_popup_loader');$('rta_popup_email_fix_lnk').observe('click',function(event){$('rta_popup_email_fix_lnk_container').hide();$('rta_popup_container_fix').show();goBtn=new SA.Utils.Button({element:'rta_popup_go',onclick:self.go});});}};})();(function(){var scope=SA.UsingNamespace("SA.Performance");scope.Utils=new function(){this.loadPrintStyle=function(cssFile){if('onbeforeprint'in window){window.onbeforeprint=function(){loadCSS(cssFile,'print');}}else{loadCSS(cssFile,'print');}}
function loadCSS(fileName,media){if(!loadCSS.loaded)
loadCSS.loaded={};if(!(fileName in loadCSS.loaded)){loadCSS.loaded[fileName]=true;var links=document.getElementsByTagName('link'),i=links.length,style;while(i--){if(links[i].href.indexOf(fileName)>-1)
return false;}
style=document.createElement('link');style.type='text/css';style.rel='stylesheet';style.media=media||'screen,handheld,projection';style.href=fileName;document.getElementsByTagName("head")[0].appendChild(style);return style;}
return false;}}})();var chartbeat_domain="seekingalpha.com";var _sf_async_config={uid:23852,domain:chartbeat_domain,authors:false};if(typeof(news_beat_sections)!=='undefined'){_sf_async_config.sections=news_beat_sections;}else{_sf_async_config.sections="N-A";}
if(typeof(news_beat_author)!=='undefined'){_sf_async_config.authors=news_beat_author;}
(function(){function loadChartbeat(){if(location.host!='seekingalpha.com'&&location.host!='www.seekingalpha.com'&&location.host!='m.seekingalpha.com')return;window._sf_endpt=(new Date()).getTime();var e=document.createElement('script');e.setAttribute('language','javascript');e.setAttribute('type','text/javascript');e.setAttribute('src',(("https:"==document.location.protocol)?"https://a248.e.akamai.net/chartbeat.download.akamai.com/102508/":"http://static.chartbeat.com/")+"js/chartbeat.js?v=3");document.body.appendChild(e);}
var oldonload=window.onload;window.onload=(typeof window.onload!='function')?loadChartbeat:function(){oldonload();loadChartbeat();};})();var _qevents=_qevents||[];(function(){var elem=document.createElement('script');elem.src=(document.location.protocol=="https:"?"https://secure":"http://edge")+".quantserve.com/quant.js";elem.async=true;elem.type="text/javascript";var scpt=document.getElementsByTagName('script')[0];scpt.parentNode.insertBefore(elem,scpt);})();_qevents.push({qacct:"p-36Zq38JCUmc3w"});SeekingAlpha.Initializer.LogAndRun(socialSA.init);SeekingAlpha.Initializer.LogAndRun(LightBox.Init);SeekingAlpha.Initializer.Add(application_init);SeekingAlpha.Initializer.AddAfterLoad(social_buttons_init);SeekingAlpha.Initializer.AddAfterLoad(fp_logged_out_user);SeekingAlpha.Initializer.AddAfterLoad(user_profiles);SeekingAlpha.Initializer.AddAfterLoad(handle_tops_cookie);SeekingAlpha.Initializer.AddAfterLoad(function(){Mone.touch(mone_params);});SeekingAlpha.Initializer.AddAfterLoad(SA.Promotion.SecPagePopup.showOnSecondPage);SeekingAlpha.Initializer.AddAfterLoad(SA.Performance.Utils.loadPrintStyle('http://static3.cdn-seekingalpha.com/stylesheets/print.css'));SeekingAlpha.Initializer.AddAfterLoad(function(){var source=window._saSource;if(source){var m=document.referrer.match(/^https?:\/\/(?:(?:.*\.)?seekingalpha.com|([^\/]+))(\/article\/\d+-|\/[^?#]*)/);var ref=m?((m[1]?m[1]:'')+m[2]):'';var event_data=null;if(source=='salogo')event_data=['headtabs','logo',ref];else if((m=source.match(/^headtabs_alerts(_.*)$/)))event_data=['headtabs',"alerts"+m[1],ref];else if(source=='headtabs')event_data=['headtabs',location.pathname,ref];else if(source=='footer')event_data=['footer',location.pathname,ref];if(event_data)pageTracker._trackEvent(event_data[0],event_data[1],event_data[2]);}});SeekingAlpha.Initializer.Run();var source=location.search.toQueryParams().source;if((source=='email_cfa_daily'||source=='bloomberg')&&!is_users_cookie_exists()){adroll_adv_id="ALYVAR3GLJCGJBQO7Z7EMY";adroll_pix_id="EDJ3NNS5SBC2RNZ7PXOVJ7";(function(){var oldonload=window.onload;window.onload=function(){__adroll_loaded=true;var scr=document.createElement("script");scr.setAttribute('async','true');scr.type="text/javascript";scr.src="http://a.adroll.com/j/roundtrip.js";((document.getElementsByTagName('head')||[null])[0]||document.getElementsByTagName('script')[0].parentNode).appendChild(scr);if(oldonload){oldonload()}};}());}