(function(){var scope=SA.UsingNamespace("SA.Promotion");scope.SecPagePopup=new function(){var self=this;var emailInput,stocksInput,goBtn,error,loader,eventSource;var buildEventSource=function(unit){eventSource="sec popup";SA.Promotion.Quote.SetEventSource(eventSource);}
this.showOnSecondPage=function(){var article_road_version=ABTest.identity%10;if(SA.Data.User.loggedIn())return;if(top.location.search=="?source=refreshed"||SA.Utils.SASource.isAutoRefreshed())return;if(top.location.href.match("source=themarkets"))return;if(/^(\/account\/|\/email_preferences)/.test(top.location.pathname))return;if(top.location.pathname=="/")return;if(navigator.userAgent.toLowerCase().indexOf('iphone')!=-1)return;var secPopCount=parseInt(SA.Data.Cache.Get('sec_pop'))||0;if(secPopCount<2){if(secPopCount==1){if(new ABTest("Sec popup",['old','rta']).value=='old'){open_header_log_in_popup_lightbox('login','');SA.Stats.GA.event('RTA','sec popup','page views (old popup)',0,true);}else{new Ajax.Request("/memcached2/email_subscr_count",{method:"GET",onSuccess:function(response){SA.Promotion.SecPagePopup.show(response.responseText);}});}}
SA.Data.Cache.Set('sec_pop',secPopCount+1);}}
this.show=function(numOfPeople){var html=[];html.push('<div class="rta_sec_popup">')
html.push('<div onclick="AlphaBox.Close()" class="close_pop"></div>')
html.push('<div class="title_wrap">')
html.push('  <h1>SEEKING ALPHA REAL-TIME EMAIL ALERTS</h1>')
html.push('  <h2>CRITICAL INFORMATION ON THE STOCKS YOU CARE ABOUT</h2>')
html.push('</div>')
html.push('<h3><span>'+numOfPeople+'</span> people have subscribed to Seeking Alpha alerts</h3>');html.push('<div class="bottom_wrap">');html.push('<input id="rta_popup_stocks" empty="Add stocks you care about (e.g. GOOG, AAPL)" title="Add stocks you care about">');html.push('<input id="rta_popup_email" style="margin-bottom:0;" emailautofill="on" empty="Fill in your email address" title="Fill in your email address">');html.push('<div id="rta_popup_error" style="display:none"></div>');html.push('<div id="rta_popup_go">Get Alerts</div>');html.push('<div id="rta_popup_loader" style="float:right;margin-top:20px;display:none"><img src="http://static3.cdn-seekingalpha.com/images/loader.gif" alt="Loading..." /></div>');html.push('</div>');html.push('</div>');AlphaBox.Loading();AlphaBox.AddHtml(html.join(''));goBtn=new SA.Utils.Button({element:'rta_popup_go',onclick:self.go,loaderObj:'rta_popup_loader'});stocksInput=SA.Utils.Expansion.Input('rta_popup_stocks',{autocomplete:{stocks:true}});emailInput=SA.Utils.Expansion.Input('rta_popup_email',{onEnterKey:goBtn.click});error=$('rta_popup_error');loader=$('rta_popup_loader');buildEventSource();SA.Promotion.Quote.trackPV();}
var showErr=function(text,input){error.update(text).show();if(input)input.ErrorMode();}
var hideErr=function(){if(emailInput)emailInput.ClearErrorMode();if(stocksInput)stocksInput.ClearErrorMode();error.hide();}
this.go=function(){buildEventSource();hideErr();SA.Promotion.Quote.trackEvent('Clicked GO',{value:stocksInput.Empty()?0:(stocksInput.value.match(/[a-z.-]+/gi)||[]).length});if(stocksInput.Empty()){showErr('*Stock can\'t be blank',stocksInput)
SA.Promotion.Quote.trackEvent('Reg err: didn\'t fill stocks');return;}
var stocks=SA.Models.StockModel.stringToStocksArray(stocksInput.value);if(stocks[1].length>0||stocks[0].length==0){showErr("Symbol(s) not recognized: "+stocks[1].join(","))
stocksInput.value=stocks[0].join(",");SA.Promotion.Quote.trackEvent('Reg err: unrecognized stocks');return;}
stocks=stocks[0].join(",");var email=emailInput.GetValue();var regSuccess=function(response){goBtn.UnLock();self.showThankYou(stocks,email);}
var regFailure=function(response){goBtn.UnLock();if(response.errors=='already_registered')self.showLogin(stocks,email);else{var er={'invalid_email':'Invalid Email'}[response.errors]||"Unknown error";showErr(er)
emailInput.ErrorMode();}}
if(emailInput.Empty()){showErr("*Fill your email to continue",emailInput);;SA.Promotion.Quote.trackEvent('Reg err: didn\'t fill email');return;}
goBtn.Lock();SA.Promotion.Quote.Register(email,stocks,regSuccess,regFailure);}
this.showLogin=function(stocks,email){var html=[];html.push('<div class="rta_pop_hp">');html.push('  <div class="rta_pop_hp_close" onclick="AlphaBox.Close()">X</div>');html.push('  <div class="rta_pop_hp_top">');html.push('    <div class="green_title">You\'re already registered with <span id="rta_popup_login_email_placeholder">&nbsp;</span> <div class="please_fill_password">Please fill in your password to continue.</div></div>');html.push('  </div>');html.push('  <div class="rta_pop_hp_bottom">');html.push('   <div class="input_wrapper">');html.push('     <input class="input_password" type="password" title="Password" empty="Password" id="rta_popup_password" />');html.push('     <div class="cleaner"></div>');html.push('     <div class="error" id="rta_popup_login_err"></div>');html.push('     <div class="forgot_password" id="rta_popup_login_fp">Forgot Password?</div>');html.push('   </div>');html.push('   <div class="cleaner"></div>');html.push('   <div class="save next" id="rta_popup_login_next">Next</div>');html.push('   <div style="float:left;margin:10px 0 0 10px;display:none" id="rta_popup_login_loader"><img src="http://static3.cdn-seekingalpha.com/images/loader.gif" alt="Loading..." /></div>');html.push('   <div class="cleaner"></div>');html.push('  </div>');html.push('  <div class="cleaner"></div>');html.push('</div>');AlphaBox.Loading();AlphaBox.AddHtml(html.join('\n'));$('rta_popup_login_email_placeholder').update(email);var loginErr=$('rta_popup_login_err'),password=SA.Utils.Expansion.Input('rta_popup_password'),emailPlaceholder=$('rta_popup_login_email_placeholder'),loginContinue=new SA.Utils.Button({element:$('rta_popup_login_next'),onclick:function(){loginErr.style.display='none';loginContinue.Lock();SA.Promotion.Quote.Login(email,password.GetValue(),function(){loginContinue.UnLock();location.reload();},function(response){loginContinue.UnLock();var er={'invalid_email':'Invalid Email','empty_password':"Password shouldn't be empty",'login_failed':"Wrong password"}[response.errors]||"Unknown error";loginErr.innerHTML=er;loginErr.style.display='block';password.Reset();password.ErrorMode();},{addStocks:stocks,addRTA:true});},loaderObj:'rta_popup_login_loader'}),forgotPassword=new SA.Utils.Button({element:$('rta_popup_login_fp'),onclick:function(){loginErr.style.display='none';forgotPassword.Lock();SA.Promotion.Quote.ForgotPassword(email,function(response){forgotPassword.UnLock();if(AlphaBox.onBeforeClose)AlphaBox.onBeforeClose();SA.Promotion.Quote.ForgotPasswordMsg();},function(response){forgotPassword.UnLock();var er={'invalid_email':'Invalid Email'}[response.errors]||"Unknown error";loginErr.innerHTML=er;loginErr.style.display='block';});},loaderObj:'rta_popup_login_loader'});password.setOnEnterKey(loginContinue.click);loginErr.style.display='none';emailPlaceholder.innerHTML=email;setTimeout(function(){password.focus()},500);}
this.showThankYou=function(stocks,email){var html=[];html.push('<input type="hidden" id="rta_popup_stocks">');html.push('<div class="rta_pop_hp">');html.push('  <div class="rta_pop_hp_close" onclick="AlphaBox.Close()">X</div>');html.push('  <div class="rta_pop_hp_top">');html.push('    <div class="green_title">Thanks for registering for Seeking Alpha real-time email alerts</div>');html.push('    <p>A confirmation email has been sent to <strong id="rta_popup_email_placeholder">&nbsp</strong>.</p>');html.push('    <p class="last_p">Please confirm your registration by clicking the link in the email</p>');html.push('    <p class="if_not_correct_email" id="rta_popup_email_fix_lnk_container">If this isn\'t your correct email address please <span id="rta_popup_email_fix_lnk" class="link">click here</span></p>');html.push('    <div class="cleaner"></div>');html.push('  </div>');html.push('  <div class="rta_pop_hp_bottom" id="rta_popup_container_fix" style="display:none">');html.push('   <div class="input_wrapper">');html.push('     <input type="text" id="rta_popup_email" emailautofill="on" empty="Fill in your email address" />');html.push('     <div class="save" id="rta_popup_go">Save</div>');html.push('   <div style="float:left;margin:10px 0 0 10px;display:none" id="rta_popup_loader"><img src="http://static3.cdn-seekingalpha.com/images/loader.gif" alt="Loading..." /></div>');html.push('     <div class="error" id="rta_popup_error"></div>');html.push('   </div>');html.push('   <div class="cleaner"></div>');html.push('  </div>');html.push('  <div class="cleaner"></div>');html.push('</div>');AlphaBox.Loading();AlphaBox.AddHtml(html.join('\n'));stocksInput=SA.Utils.Expansion.Input('rta_popup_stocks',{autocomplete:{stocks:true},onEnterKey:self.go});stocksInput.SetValue(stocks);emailInput=SA.Utils.Expansion.Input('rta_popup_email');$('rta_popup_email_placeholder').update(email);error=$('rta_popup_error');loader=$('rta_popup_loader');$('rta_popup_email_fix_lnk').observe('click',function(event){$('rta_popup_email_fix_lnk_container').hide();$('rta_popup_container_fix').show();goBtn=new SA.Utils.Button({element:'rta_popup_go',onclick:self.go});});}};})();(function(){var scope=SA.UsingNamespace("SA.Performance");scope.Utils=new function(){this.loadPrintStyle=function(cssFile){if('onbeforeprint'in window){window.onbeforeprint=function(){loadCSS(cssFile,'print');}}else{loadCSS(cssFile,'print');}}
function loadCSS(fileName,media){if(!loadCSS.loaded)
loadCSS.loaded={};if(!(fileName in loadCSS.loaded)){loadCSS.loaded[fileName]=true;var links=document.getElementsByTagName('link'),i=links.length,style;while(i--){if(links[i].href.indexOf(fileName)>-1)
return false;}
style=document.createElement('link');style.type='text/css';style.rel='stylesheet';style.media=media||'screen,handheld,projection';style.href=fileName;document.getElementsByTagName("head")[0].appendChild(style);return style;}
return false;}}})();var chartbeat_domain="seekingalpha.com";var _sf_async_config={uid:23852,domain:chartbeat_domain,authors:false};if(typeof(news_beat_sections)!=='undefined'){_sf_async_config.sections=news_beat_sections;}else{_sf_async_config.sections="N-A";}
if(typeof(news_beat_author)!=='undefined'){_sf_async_config.authors=news_beat_author;}
(function(){function loadChartbeat(){if(location.host!='seekingalpha.com'&&location.host!='www.seekingalpha.com'&&location.host!='m.seekingalpha.com')return;window._sf_endpt=(new Date()).getTime();var e=document.createElement('script');e.setAttribute('language','javascript');e.setAttribute('type','text/javascript');e.setAttribute('src',(("https:"==document.location.protocol)?"https://a248.e.akamai.net/chartbeat.download.akamai.com/102508/":"http://static.chartbeat.com/")+"js/chartbeat.js?v=3");document.body.appendChild(e);}
var oldonload=window.onload;window.onload=(typeof window.onload!='function')?loadChartbeat:function(){oldonload();loadChartbeat();};})();var _qevents=_qevents||[];(function(){var elem=document.createElement('script');elem.src=(document.location.protocol=="https:"?"https://secure":"http://edge")+".quantserve.com/quant.js";elem.async=true;elem.type="text/javascript";var scpt=document.getElementsByTagName('script')[0];scpt.parentNode.insertBefore(elem,scpt);})();_qevents.push({qacct:"p-36Zq38JCUmc3w"});SeekingAlpha.Initializer.LogAndRun(socialSA.init);SeekingAlpha.Initializer.LogAndRun(LightBox.Init);SeekingAlpha.Initializer.Add(application_init);SeekingAlpha.Initializer.AddAfterLoad(social_buttons_init);SeekingAlpha.Initializer.AddAfterLoad(fp_logged_out_user);SeekingAlpha.Initializer.AddAfterLoad(user_profiles);SeekingAlpha.Initializer.AddAfterLoad(handle_tops_cookie);SeekingAlpha.Initializer.AddAfterLoad(function(){Mone.touch(mone_params);});SeekingAlpha.Initializer.AddAfterLoad(SA.Promotion.SecPagePopup.showOnSecondPage);SeekingAlpha.Initializer.AddAfterLoad(function(){var source=window._saSource;if(source){var m=document.referrer.match(/^https?:\/\/(?:(?:.*\.)?seekingalpha.com|([^\/]+))(\/article\/\d+-|\/[^?#]*)/);var ref=m?((m[1]?m[1]:'')+m[2]):'';var event_data=null;if(source=='salogo')event_data=['headtabs','logo',ref];else if((m=source.match(/^headtabs_alerts(_.*)$/)))event_data=['headtabs',"alerts"+m[1],ref];else if(source=='headtabs')event_data=['headtabs',location.pathname,ref];else if(source=='footer')event_data=['footer',location.pathname,ref];if(event_data)pageTracker._trackEvent(event_data[0],event_data[1],event_data[2]);}});SeekingAlpha.Initializer.Run();(function(){var scope=SA.UsingNamespace("SA.Utils");scope.Popup=new function(){this.roadblock_registration=function(version){$('user_settings_wrapper').hide();var html=[];Mone.event(rb.type,rb.source+' Register',"Popup Register shown");html.push("<div id='readlater_register_login' class='customize_pop_bordeaux mail_sent roadblock_registration rbcontrol' style='width:410px' >");html.push("  <div class='fr fs12'>Already registered? <a href='javascript:void(0)' onclick=\"Mone.event(rb.type,rb.source+' Register','Switch to Login');SA.Utils.Popup.roadblock_login();\" class=\"tdn blue\">Sign in</a></div>");html.push(cleaner());html.push("  <div class='bordeaux fs18 mt15'>To use the Seeking Alpha homepage please tell us which stocks you want to follow in your portfolio:</div>");defaultText="Please enter at least 5 stocks, separate with commas";if(version%2){html.push("<div id='acp1'>");html.push("  <input type='text' class='fl mt15 pl4' style='width:400px;height:30px;color:#959595' onfocus=\"handleInput(this,'focus');handleInput(this, 'focus');this.style.color='#000000';\" id=\"autocomplete_roadblock\" class=\"add_stock_text\"  onblur=\"this.style.color=this.value=='' ? '#959595' : '#000000';handleInput(this,'blur');\" title=\""+defaultText+"\" empty=\""+defaultText+"\">");html.push("</div>");}
html.push("<div id='ghost1' class='fl'>");html.push("  <div class='fl mt12 fs14'>Register to save for future visits</div>");html.push('  <input type="text" class="mt10 pl4" id="roadblock_email" style="width:400px;height:30px;color:#959595" empty="Email address" title="Email Address">');html.push('  <input type="password" class="fl mt10 pl4" id="roadblock_password" style="width:400px;height:30px;color:#959595" empty="Choose password">');if(!(version%2)){html.push("  <div class='fl mt12 fs14'>Customize</div>");html.push("<div id='acp2'>");html.push("  <input type='text' class='fl mt10 pl4' style='width:400px;height:45px;color:#959595' onfocus=\"handleInput(this,'focus');handleInput(this, 'focus');this.style.color='#000000';\" id=\"autocomplete_roadblock\" class=\"add_stock_text\"  onblur=\"this.style.color=this.value=='' ? '#959595' : '#000000';handleInput(this,'blur');\" title=\""+defaultText+"\" empty=\""+defaultText+"\">");html.push("</div>");}
html.push(cleaner());html.push('  <div class="fl mt10"><div class="fl"><input style="* position:relative;* top:-3px;left:-1px"id="sendRta" type="checkbox" checked></div>');html.push('     <div class="fl ml9" style="width: 375px;"><span class="fs12">Send me alerts when news and articles are published on my stocks <span id="rta_message"> <b><span id="rta_number"></span></b>&nbsp;Seeking Alpha users get these alerts</span></span></div>');html.push('  </div>');html.push("</div>");html.push('<div class="pro_blue_button mt20" style="width:60px;float:left" onclick="rb.register()">GO!</div>');html.push('<div id="roadblock_error" class="fl red fs12 mt25 ml10"></div>');html.push('<div id="roadblock_loader" class="fl mt25 small_loader" style="display:none"></div>');html.push('<div></div>');openPopup(html,true);stockArea=SA.Utils.Expansion.Input('autocomplete_roadblock',{autocomplete:{stocks:true}});SA.Utils.Expansion.Input('roadblock_username');SA.Utils.Expansion.Input('roadblock_email');SA.Utils.Expansion.Input('roadblock_password');if(typeof(emailSubscrCount)==="undefined"){$('rta_message').hide();}else{$('rta_number').innerHTML=emailSubscrCount;}
$('autocomplete_box_symbols_input_autocomplete_roadblock').style.width="409px";if(version==9){$('ghost1').hide();$('autocomplete_roadblock').onkeypress=function(){setTimeout("$('ghost1').appear()",1000)}}}
this.roadblock_registration_b=function(title,version){$('user_settings_wrapper').hide();var html=[];Mone.event(rb.type,rb.source+' Register',"Popup Register shown");html.push("<div id='readlater_register_login' class='customize_pop_bordeaux mail_sent roadblock_registration rbcontrol' style='width:434px' >");html.push("  <div class='fr fs12'>Already registered? <a href='javascript:void(0)' onclick=\"Mone.event(rb.type,rb.source+' Register','Switch to Login');SA.Utils.Popup.roadblock_login();\" class=\"tdn blue\">Sign in</a></div>");html.push(cleaner());html.push("  <div class='bordeaux fs18 mt15'>"+title+"</div>");defaultText="Enter company names or symbols";if(version==1){html.push("<div class='fl mt15 fs14'>Customize: Enter 5 stocks or more</div>");html.push("  <input type='text' class='pl4 mt3' style='width:427px;height:45px;color:#959595' onfocus=\"handleInput(this,'focus');handleInput(this, 'focus');this.style.color='#000000';\" id=\"autocomplete_roadblock\" class=\"add_stock_text\"  onblur=\"this.style.color=this.value=='' ? '#959595' : '#000000';handleInput(this,'blur');\" title=\""+defaultText+"\" empty=\""+defaultText+"\">");}
html.push("  <div class='fl mt8 fs14'>Register:</div>");html.push('  <input type="text" class="mt3 pl4" id="roadblock_email" style="width:427px;height:30px;color:#959595" empty="Email address" title="Email Address">');html.push('  <input type="password" class="fl mt14 pl4" id="roadblock_password" style="width:427px;height:30px;color:#959595" empty="Password">');if(version!=1){html.push("<div class='fl mt15 fs14'>Customize: Enter 5 stocks or more</div>");html.push("  <input type='text' class='pl4 mt3' style='width:427px;height:45px;color:#959595' onfocus=\"handleInput(this,'focus');handleInput(this, 'focus');this.style.color='#000000';\" id=\"autocomplete_roadblock\" class=\"add_stock_text\"  onblur=\"this.style.color=this.value=='' ? '#959595' : '#000000';handleInput(this,'blur');\" title=\""+defaultText+"\" empty=\""+defaultText+"\">");}
html.push(cleaner());html.push('  <div class="fl mt15"><div class="fl"><input style="* position:relative;* top:-3px;"id="sendRta" type="checkbox" checked></div>');html.push('     <div class="fl ml9" style="width:400px"><span class="fs12">Send me alerts when news and articles are published on my stocks <span id="rta_message"> <b><span id="rta_number"></span></b>&nbsp;Seeking Alpha users get these alerts</span></span></div>');html.push('  </div>');html.push('<div class="pro_blue_button mt10" style="width:60px;float:left" onclick="rb.register()">GO!</div>');html.push('<div id="roadblock_error" class="fl red fs12 mt20 ml10"></div>');html.push('<div id="roadblock_loader" class="fl mt25 small_loader" style="display:none"></div>');html.push('<div></div>');openPopup(html,true);stockArea=SA.Utils.Expansion.Input('autocomplete_roadblock',{autocomplete:{stocks:true}});SA.Utils.Expansion.Input('roadblock_username');SA.Utils.Expansion.Input('roadblock_email');SA.Utils.Expansion.Input('roadblock_password');if(typeof(emailSubscrCount)==="undefined"){$('rta_message').hide();}else{$('rta_number').innerHTML=emailSubscrCount;}
$('autocomplete_box_symbols_input_autocomplete_roadblock').style.width="436px";}
this.roadblock_registration_c=function(){$('user_settings_wrapper').hide();var html=[];Mone.event(rb.type,rb.source+' Register',"Popup Register shown");html.push("<div id='readlater_register_login' class='roadblock_popup roadblock_registration rbcontrol'>");html.push(rb_promo_text("Seeking Alpha’s homepage is designed to provide a custom experience for you centered around the stocks you care about. Please pick 5 or more stocks to get started."));html.push("<div class='fl' style='width:300px;position:relative'>")
html.push("<div class='reg_box mt16'>");html.push(cleaner());html.push("  <div class='bordeaux fs15 mt11 ml20 fl' style='width:100px'>Register</div>");html.push("  <div class='fr fs15 mt10 mr26'><a href='javascript:void(0)' onclick=\"Mone.event(rb.type,rb.source+' Register','Switch to Login');SA.Utils.Popup.roadblock_login_b();\" class=\"tdn bordeaux fs15\">Sign in</a></div>");defaultText="Enter 5 or more stocks";html.push(cleaner());html.push("<div class='fl pl20'>");html.push("<div class='fl mt13 fs12 w100'>Customize:</div>");html.push("  <input type='text' class='pl4 mt7' style='width:309px;height:25px;color:#959595;position:relative' onfocus=\"handleInput(this,'focus');handleInput(this, 'focus');this.style.color='#000000';\" id=\"autocomplete_roadblock\" class=\"add_stock_text\"  onblur=\"this.style.color=this.value=='' ? '#959595' : '#000000';handleInput(this,'blur');\" title=\""+defaultText+"\" empty=\""+defaultText+"\">");html.push("  <div class='fl mt10 fs12'>Register:</div>");html.push('  <input type="text" class="mt7 pl4" id="roadblock_email" style="width:309px;height:25px;color:#959595" empty="Email address" title="Email Address">');html.push('  <input type="password" class="fl mt11 pl4" id="roadblock_password" style="width:309px;height:25px;color:#959595" empty="Choose password">');html.push(cleaner());html.push('  <div class="fl mt7"><div class="fl"><input style="* position:relative;* top:-3px;"id="sendRta" type="checkbox" checked></div>');html.push('     <div class="fl ml9"><span class="fs12">Send me news and article email alerts on my stocks.</span></div>');html.push('  </div>');html.push('<div class="pro_blue_button mt8" style="width:60px;float:left;*margin-top:4px" onclick="rb.register()">GO!</div>');html.push('<div id="roadblock_error" class="fl red fs12 mt15 ml10"></div>');html.push('<div id="roadblock_loader" class="fl mt25 small_loader" style="display:none"></div>');html.push('<div></div></div></div></div>');openPopup(html,true,true);stockArea=SA.Utils.Expansion.Input('autocomplete_roadblock',{autocomplete:{stocks:true}});SA.Utils.Expansion.Input('roadblock_username');SA.Utils.Expansion.Input('roadblock_email');SA.Utils.Expansion.Input('roadblock_password');if($('autocomplete_container_sa_input_autocomplete_roadblock'))$('autocomplete_container_sa_input_autocomplete_roadblock').style.width="318px";}
this.roadblock_registration_d=function(title,version,check_version){var html=[];Mone.event(rb.type,rb.source+' Register',"Popup Register shown");html.push("<div id='readlater_register_login' class='customize_pop_bordeaux mail_sent roadblock_registration rbcontrol' style='width:434px' >");html.push(closer());html.push(cleaner());html.push("  <div class='fr fs12 mt15'>Already registered? <a href='javascript:void(0)' onclick=\"Mone.event(rb.type,rb.source+' Register','Switch to Login');SA.Utils.Popup.roadblock_login_c();\" class=\"tdn blue\">Sign in</a></div>");html.push(cleaner());html.push("  <div class='bordeaux fs18 mt15'>"+title+"</div>");defaultText="Please enter at least 5 stocks, separate with commas";if(version==1){html.push("<div class='fl mt13 fs14 w100'>Choose 5 or more stocks to follow:</div>");html.push("  <input type='text' class='pl4 mt7' style='width:427px;height:45px;color:#959595' onfocus=\"handleInput(this,'focus');handleInput(this, 'focus');this.style.color='#000000';\" id=\"autocomplete_roadblock\" class=\"add_stock_text\"  onblur=\"this.style.color=this.value=='' ? '#959595' : '#000000';handleInput(this,'blur');\" title=\""+defaultText+"\" empty=\""+defaultText+"\">");}
html.push("  <div class='fl mt12 fs14'>Register to save for future visits:</div>");html.push('  <input type="text" class="mt7 pl4" id="roadblock_email" style="width:427px;height:30px;color:#959595" empty="Email address" title="Email Address">');html.push('  <input type="password" class="fl mt14 pl4" id="roadblock_password" style="width:427px;height:30px;color:#959595" empty="Password">');if(version!=1){html.push("<div class='fl mt13 fs14 w100'>Choose 5 or more stocks to follow:</div>");html.push("  <input type='text' class='pl4 mt7' style='width:427px;height:45px;color:#959595' onfocus=\"handleInput(this,'focus');handleInput(this, 'focus');this.style.color='#000000';\" id=\"autocomplete_roadblock\" class=\"add_stock_text\"  onblur=\"this.style.color=this.value=='' ? '#959595' : '#000000';handleInput(this,'blur');\" title=\""+defaultText+"\" empty=\""+defaultText+"\">");}
html.push(cleaner());if(check_version==1){html.push('  <div class="fl mt15" id="box_container"><div class="fl"><input style="* position:relative;* top:-3px;"id="sendRta" type="checkbox" checked></div>');html.push('     <div class="fl ml9" style="width:400px"><span class="fs12">Send me alerts when news and articles are published on my stocks <span id="rta_message"> <b><span id="rta_number"></span></b>&nbsp;Seeking Alpha users get these alerts</span></span></div>');html.push('  </div>');}
html.push('<div class="pro_blue_button mt10" style="width:60px;float:left" onclick="rb.register()">GO!</div>');html.push('<a id="roadblock_nothanks" href="javascript:void(0)" onclick="Mone.event(rb.type,rb.source + \' Register\',\'Popup Register closed on no thanks\');AlphaBox.Close()" class="fl mt15 ml15 fs12">No thanks</a>');html.push('<div id="roadblock_error" class="fl red fs12 mt15 ml10"></div>');html.push('<div id="roadblock_loader" class="fl mt25 small_loader" style="display:none"></div>');html.push('<div></div>');openPopup(html,false);AlphaBox.onAfterClose=function(){Mone.event(rb.type,rb.source+' Register',"Popup Register closed");}
stockArea=SA.Utils.Expansion.Input('autocomplete_roadblock',{autocomplete:{stocks:true}});SA.Utils.Expansion.Input('roadblock_username');SA.Utils.Expansion.Input('roadblock_email');SA.Utils.Expansion.Input('roadblock_password');if(typeof(emailSubscrCount)==="undefined"){if($('rta_message'))$('rta_message').hide();}else{$('rta_number').innerHTML=emailSubscrCount;}
$('autocomplete_box_symbols_input_autocomplete_roadblock').style.width="436px";document.cookie="isawthis=true; path=/";}
this.roadblock_login=function(){var html=[];Mone.event(rb.type,rb.source+' Login',"Popup Login shown");$('user_settings_wrapper').hide();html.push("<div id='readlater_register_login' class='customize_pop_bordeaux mail_sent rbcontrol' style='width:410px'>");html.push("  <div class='fr fs12'>Not yet registered? <a href='javascript:void(0)' onclick=\"Mone.event(rb.type,rb.source+' Login','Switch to Register');rb.register_show()\" class=\"tdn blue\">register</a></div>");html.push(cleaner());html.push("  <div class='bordeaux fs16 mt15 fwb'>Please sign in"+rb.additional_login_title+":</div>");html.push('  <input type="text" class="fl mt10 pl4" id="roadblock_email" emailautofill="on" style="width:400px;height:30px;color:#959595" empty="Email address">');html.push('  <input type="password" class="fl mt10 pl4" id="roadblock_password" style="width:400px;height:30px;color:#959595" empty="Password">');html.push('<div><a href="javascript:void(0)" class="fs12 mt5 tdn blue" style="cursor:pointer;float:right" id="roadblock_login_forgot_password">Forgot password?</a><span id="roadblock_loader_f_password" class="fr small_loader" style="padding:2px 0 0 0;display:none"></span></div>');html.push(cleaner());html.push('<div class="pro_blue_button" style="width:60px;float:left" id="roadblock_login_go">GO!</div>');html.push('<div class="fs12 fl red" style="margin:5px 0 0 5px" id="roadblock_login_errors"></div>')
html.push('<div id="roadblock_loader" class="fl mt5 small_loader" style="display:none"></div>');html.push('</div>');openPopup(html,true);var roadblock_email=SA.Utils.Expansion.Input('roadblock_email');var roadblock_password=SA.Utils.Expansion.Input('roadblock_password');if($('roadblock_email')&&$('roadblock_email').attributes["empty"].value!=$('roadblock_email').value){$('roadblock_email').removeClassName("default_text");}
var error=$("roadblock_login_errors");var forgotPassword=new SA.Utils.Button({element:$('roadblock_login_forgot_password'),onclick:function(){error.innerHTML="";forgotPassword.Lock();SA.Data.User.ForgotPassword(roadblock_email.value,function(){forgotPassword.UnLock();Mone.event(rb.type,rb.source+" Login ","Success forgot password");SA.Utils.Popup.roadblock_forgot_password_thank_you();},function(res){forgotPassword.UnLock();if(res.errors=="invalid_email"||res.errors=="no_user")error.innerHTML="*Invalid email.";Mone.event(rb.type,rb.source+" Login ","Error : "+error.innerHTML);},{activity:'roadblock'});},loaderObj:$("roadblock_loader_f_password")});var button=new SA.Utils.Button({element:$('roadblock_login_go'),onclick:function(){roadblock_email.removeClassName("bcred");error.innerHTML="";if(!roadblock_email.Changed()){onFailure({errors:"invalid_email"});roadblock_email.addClassName("bcred");return;}
if(!roadblock_password.Changed()){onFailure({errors:"invalid_password"});return;}
button.Lock();SA.Data.User.Login(roadblock_email.value,roadblock_password.value,onSuccess,onFailure,{activity:'roadblock'});},loaderObj:$("roadblock_loader")});function onSuccess(res){Mone.event(rb.type,rb.source+" Login ","Success login");setTimeout("top.location.reload(true)",500);}
function onFailure(res){button.UnLock();if(res.errors=="invalid_email")error.innerHTML="*Invalid email.";if(res.errors=="invalid_password")error.innerHTML="*Please enter your password.";if(res.errors=="login_failed")error.innerHTML="*Please check your email and password and try again.";Mone.event(rb.type,rb.source+" Login ","Error : "+error.innerHTML);}
roadblock_email.setOnEnterKey(function(){button.click();});roadblock_password.setOnEnterKey(function(){button.click();});}
this.roadblock_login_b=function(){var html=[];$('user_settings_wrapper').hide();Mone.event(rb.type,rb.source+' Login',"Popup Login shown");html.push("<div id='readlater_register_login' class='roadblock_popup roadblock_registration  rbcontrol' style='width:673px'>");html.push(rb_promo_text("Seeking Alpha’s homepage is designed to provide a custom experience for you centered around the stocks you care about.<br /><br />"));html.push("<div class='fl' style='width:300px'>")
html.push("<div class='log_box mt16'>");html.push(cleaner());html.push("  <div class='fl fs15 mt10 ml20'><a href='javascript:void(0)' onclick=\"Mone.event(rb.type,rb.source+' Login','Switch to Register');rb.register_show()\" class=\"tdn bordeaux\">Register</a></div>");html.push("  <div class='bordeaux fs15 mt10 fr mr26'>Sign in</div>");html.push("<div class='ml20'>");html.push('  <input type="text" class="fl mt40 pl4" id="roadblock_email" emailautofill="on" style="width:309px;height:30px;color:#959595" empty="Email address">');html.push('  <input type="password" class="fl mt20 pl4" id="roadblock_password" style="width:309px;height:30px;color:#959595" empty="Password">');html.push('<div><a href="javascript:void(0)" class="fs12 mt10 mr22 tdn blue" style="cursor:pointer;float:right" id="roadblock_login_forgot_password">Forgot password?</a><span id="roadblock_loader_f_password" class="fr small_loader" style="padding:2px 0 0 0;display:none"></span></div>');html.push(cleaner());html.push('<div class="pro_blue_button" style="width:60px;float:left" id="roadblock_login_go">GO!</div>');html.push('<div class="fs12 fl red" style="margin:5px 0 0 5px" id="roadblock_login_errors"></div>')
html.push('<div id="roadblock_loader" class="fl mt5 small_loader" style="display:none"></div>');html.push('</div></div></div></div>');openPopup(html,true,true);var roadblock_email=SA.Utils.Expansion.Input('roadblock_email');var roadblock_password=SA.Utils.Expansion.Input('roadblock_password');if($('roadblock_email')&&$('roadblock_email').attributes["empty"].value!=$('roadblock_email').value){$('roadblock_email').removeClassName("default_text");}
var error=$("roadblock_login_errors");var forgotPassword=new SA.Utils.Button({element:$('roadblock_login_forgot_password'),onclick:function(){error.innerHTML="";forgotPassword.Lock();SA.Data.User.ForgotPassword(roadblock_email.value,function(){forgotPassword.UnLock();Mone.event(rb.type,rb.source+" Login ","Success forgot password");SA.Utils.Popup.roadblock_forgot_password_thank_you_b();},function(res){forgotPassword.UnLock();if(res.errors=="invalid_email"||res.errors=="no_user")error.innerHTML="*Invalid email.";Mone.event(rb.type,rb.source+" Login ","Error : "+error.innerHTML);},{activity:'roadblock'});},loaderObj:$("roadblock_loader_f_password")});var button=new SA.Utils.Button({element:$('roadblock_login_go'),onclick:function(){roadblock_email.removeClassName("bcred");error.innerHTML="";if(!roadblock_email.Changed()){onFailure({errors:"invalid_email"});roadblock_email.addClassName("bcred");return;}
if(!roadblock_password.Changed()){onFailure({errors:"invalid_password"});return;}
button.Lock();SA.Data.User.Login(roadblock_email.value,roadblock_password.value,onSuccess,onFailure,{activity:'roadblock'});},loaderObj:$("roadblock_loader")});function onSuccess(res){Mone.event(rb.type,rb.source+" Login ","Success login");top.location.reload(true);}
function onFailure(res){button.UnLock();if(res.errors=="invalid_email")error.innerHTML="*Invalid email.";if(res.errors=="invalid_password")error.innerHTML="*Please enter your password.";if(res.errors=="login_failed")error.innerHTML="*Please check your email and password and try again.";Mone.event(rb.type,rb.source+" Login ","Error : "+error.innerHTML);}
roadblock_email.setOnEnterKey(function(){button.click();});roadblock_password.setOnEnterKey(function(){button.click();});}
this.roadblock_login_c=function(){document.cookie="isawthis=true; path=/";var html=[];Mone.event(rb.type,rb.source+' Login',"Popup Login shown");html.push("<div id='readlater_register_login' class='customize_pop_bordeaux mail_sent rbcontrol' style='width:410px'>");html.push(closer());html.push(cleaner());html.push("  <div class='fr fs12 mt15'>Not yet registered? <a href='javascript:void(0)' onclick=\"Mone.event(rb.type,rb.source+' Login','Switch to Register');rb.register_show()\" class=\"tdn blue\">register</a></div>");html.push(cleaner());html.push("  <div class='bordeaux fs16 mt15 fwb'>To use the Seeking Alpha articles, please sign in.</div>");html.push('  <input type="text" class="fl mt10 pl4" id="roadblock_email" emailautofill="on" style="width:400px;height:30px;color:#959595" empty="Email address">');html.push('  <input type="password" class="fl mt10 pl4" id="roadblock_password" style="width:400px;height:30px;color:#959595" empty="Password">');html.push('<div><a href="javascript:void(0)" class="fs12 mt5 tdn blue" style="cursor:pointer;float:right" id="roadblock_login_forgot_password">Forgot password?</a><span id="roadblock_loader_f_password" class="fr small_loader" style="padding:2px 0 0 0;display:none"></span></div>');html.push(cleaner());html.push('<div class="pro_blue_button" style="width:60px;float:left" id="roadblock_login_go">GO!</div>');html.push('<div class="fs12 fl red" style="margin:3px 0 0 15px" id="roadblock_login_errors"></div>')
html.push('<div id="roadblock_loader" class="fl mt5 small_loader" style="display:none"></div>');html.push('</div>');openPopup(html,false);AlphaBox.onAfterClose=function(){Mone.event(rb.type,rb.source+' Login',"Popup Login closed");}
var roadblock_email=SA.Utils.Expansion.Input('roadblock_email');var roadblock_password=SA.Utils.Expansion.Input('roadblock_password');if($('roadblock_email')&&$('roadblock_email').attributes["empty"].value!=$('roadblock_email').value){$('roadblock_email').removeClassName("default_text");}
var error=$("roadblock_login_errors");var forgotPassword=new SA.Utils.Button({element:$('roadblock_login_forgot_password'),onclick:function(){error.innerHTML="";forgotPassword.Lock();SA.Data.User.ForgotPassword(roadblock_email.value,function(){forgotPassword.UnLock();Mone.event(rb.type,rb.source+" Login ","Success forgot password");SA.Utils.Popup.roadblock_forgot_password_thank_you_c();},function(res){forgotPassword.UnLock();if(res.errors=="invalid_email"||res.errors=="no_user")error.innerHTML="*Invalid email.";Mone.event(rb.type,rb.source+" Login ","Error : "+error.innerHTML);},{activity:'roadblock'});},loaderObj:$("roadblock_loader_f_password")});var button=new SA.Utils.Button({element:$('roadblock_login_go'),onclick:function(){roadblock_email.removeClassName("bcred");error.innerHTML="";if(!roadblock_email.Changed()){onFailure({errors:"invalid_email"});roadblock_email.addClassName("bcred");return;}
if(!roadblock_password.Changed()){onFailure({errors:"invalid_password"});return;}
button.Lock();SA.Data.User.Login(roadblock_email.value,roadblock_password.value,onSuccess,onFailure,{activity:'roadblock'});},loaderObj:$("roadblock_loader")});function onSuccess(res){Mone.event(rb.type,rb.source+" Login ","Success login");setTimeout("top.location.reload(true)",1000);}
function onFailure(res){button.UnLock();if(res.errors=="invalid_email")error.innerHTML="*Invalid email.";if(res.errors=="invalid_password")error.innerHTML="*Please enter your password.";if(res.errors=="login_failed")error.innerHTML="*Please check your email and password and try again.";Mone.event(rb.type,rb.source+" Login ","Error : "+error.innerHTML);}
roadblock_email.setOnEnterKey(function(){button.click();});roadblock_password.setOnEnterKey(function(){button.click();});}
this.roadblock_forgot_password_thank_you=function(){var html=[];Mone.event(rb.type,rb.source+' Forgot',"forgot password thank you Popup shown");html.push("<div id='readlater_register_login' class='customize_pop_bordeaux mail_sent'>");html.push("  <div class='bordeaux fs16'>We’ve sent you instructions on how to get a new password. Please check your email account and proceed to <span onclick='Mone.event(rb.type,rb.source+\" - Notice Forgot password\",\"Roadblock Login\");SA.Utils.Popup.roadblock_login();' style='color:#024999;cursor:pointer'>Sign in</sapn>.</div>");html.push('</div>');openPopup(html,true);}
this.roadblock_forgot_password_thank_you_b=function(){var html=[];html.push("<div id='readlater_register_login' class='roadblock_popup light-gray' style='width:340px'>");html.push("<div class='ml25' style='margin-bottom:43px;'>");html.push("<div class='sa_personalized mt36'></div>");html.push("<div style='width:300px'>");html.push("  <div class='fs16 mt20 fwb'>Password sent!</div> <div class='mt17 fs14 ln20'> A new password has been sent to your email! Please check now. </div>");html.push("<div class='mt20 fs14'>Got your password? <span onclick='Mone.event(rb.type,rb.source+\" - Notice Forgot password\",\"Roadblock Login\");SA.Utils.Popup.roadblock_login_b();' style='color:#024999;cursor:pointer'>Sign in</sapn>.</div>");html.push('</div></div></div></div>');openPopup(html,true,true);Mone.event(rb.type,rb.source+' Forgot',"forgot password thank you Popup shown");}
this.roadblock_forgot_password_thank_you_c=function(){var html=[];Mone.event(rb.type,rb.source+' Forgot',"forgot password thank you Popup shown");html.push("<div id='readlater_register_login' class='customize_pop_bordeaux mail_sent' style='width:340px'>");html.push(closer());html.push(cleaner());html.push("<div class='ml25' style='margin-bottom:43px;'>");html.push("<div style='width:300px'>");html.push("  <div class='fs16 mt20 fwb bordeaux'>Password sent!</div> <div class='mt17 fs14 ln20'> A new password has been sent to your email! Please check now. </div>");html.push("<div class='mt20 fs14'>Got your password? <span onclick='Mone.event(rb.type,rb.source+\" Forgot\",\"Roadblock Login from forgot\");SA.Utils.Popup.roadblock_login_c();' style='color:#024999;cursor:pointer'>Sign in</sapn>.</div>");html.push('</div></div></div></div>');openPopup(html,false);AlphaBox.onAfterClose=function(){Mone.event(rb.type,rb.source+' Forgot',"forgot password thank you Popup closed");}}
this.roadblock_confirmation=function(){var html=[];Mone.event(rb.type,rb.source+' Register',"Registration confirmation Popup shown");html.push("<div id='readlater_register_login' class='customize_pop_bordeaux mail_sent' style='width:410px'>");html.push("  <div id='rb_confirm_msg' class='bordeaux fs20 mt15'>Thank you for registering!</div>");html.push("  <div class=' fs14 mt15 ln20'>There's an email waiting in your inbox. Please confirm your registration and enjoy Seeking Alpha</div>");html.push('<div class="mt20 fs14">After Confirming registration, please <a href="javascript:void(0)" onclick="Mone.event(rb.type,rb.source + \' - Complete\',\'Roadblock Login\');SA.Utils.Popup.roadblock_login();" class=\"tdn blue\">Sign in</a></div>');html.push('</div>');openPopup(html,true);}
this.roadblock_confirmation_b=function(){var html=[];Mone.event(rb.type,rb.source+' Register',"Registration confirmation Popup shown");html.push("<div id='readlater_register_login' class='roadblock_popup light-gray' style='width:408px'>");html.push("<div class='sa_personalized mt15'></div>");html.push("  <div id='rb_confirm_msg' class='fs16 mt15 fwb'>Thank you for registering!</div>");html.push("  <div class=' fs14 mt15 ln20'>There's an email waiting in your inbox. Please confirm your registration and enjoy Seeking Alpha</div>");html.push('<div class="mt20 fs14">After Confirming registration, please <a href="javascript:void(0)" onclick="Mone.event(rb.type,rb.source + \' - Complete\',\'Roadblock Login\');SA.Utils.Popup.roadblock_login_b();" class=\"tdn blue\">Sign in</a></div>');html.push('</div>');openPopup(html,true,true);}
this.roadblock_confirmation_c=function(){var html=[];Mone.event(rb.type,rb.source+' Thankyou',"Registration confirmation Popup shown");html.push("<div id='readlater_register_login' class='customize_pop_bordeaux mail_sent' style='width:410px'>");html.push(closer());html.push(cleaner());html.push("  <div id='rb_confirm_msg' class='bordeaux fs20 mt15'>Thank you for registering!</div>");html.push("  <div class=' fs14 mt15 ln20'>There's an email waiting in your inbox. Please confirm your registration and enjoy Seeking Alpha</div>");html.push('<div class="mt20 fs14">After Confirming registration, please <a href="javascript:void(0)" onclick="Mone.event(rb.type,rb.source + \' Thankyou\',\'Roadblock switch to Login\');SA.Utils.Popup.roadblock_login_c();" class=\"tdn blue\">Sign in</a></div>');html.push('</div>');openPopup(html,false);AlphaBox.onAfterClose=function(){Mone.event(rb.type,rb.source+' Thankyou',"Registration confirmation Popup closed");}}
this.display_roadblock_to_logged_in=function(stocks,version,closable){document.cookie="isawthis=true; path=/";Mone.event(rb.type,rb.source+' Complete',"Logged in Popup Shown");currentStocks=stocks?stocks.split(","):[];for(var i=0,s;s=currentStocks[i];i++)currentStocks[i]=s.toUpperCase();var content=[];var needToAdd=5-currentStocks.length;var s=(needToAdd==1?"":"s");content.push("<div style='width:432px; padding:23px;' class='customize_pop_bordeaux mail_sent rbcontrol' id='display_roadblock_to_logged_in'>");if(closable){content.push(closer());content.push(cleaner());}
if(version==1)content.push("<div style='color:#721314;font-size:16px;line-height:22px;' class='fwb'>The Seeking Alpha homepage is now personalized. <br> Please add at least "+needToAdd+" more stock"+s+" to your portfolio:</div>");if(version==2)content.push("<div style='color:#721314;font-size:16px;line-height:22px;' class='fwb'>Seeking Alpha is now customized.<br> Please add at least "+needToAdd+" more stock"+s+" to your portfolio:</div>");content.push("<div class='mt15'><input type='text' style='margin-top:5px;width:416px;height:25px;' class='fs17 pl4' id='autocomplete_roadblock' empty='Enter stocks, separate with a comma'/></div>");if(needToAdd<5)content.push("<div style='color:#999;font-size:14px;margin-top:12px;' class='mb10'>Added so far: "+currentStocks.join(", ")+".</div>");content.push('<div class="pro_blue_button mt10" style="width:60px;float:left" id="display_roadblock_to_logged_in_click_go">GO!</div>');content.push("<div style='line-height:17px;width: 300px;' class='mt10 fs12 fl ml10'><div class='fl'><input type='checkbox' id='display_roadblock_to_logged_in_rta' checked/></div><div>Send me news and alerts on these stocks.</div></div>");content.push('<div class="fs12 fl red" style="margin:3px 0 0 15px;width:300px" id="display_roadblock_to_logged_in_error"></div>');content.push('<div id="roadblock_loader" class="fl mt15 small_loader" style="display:none"></div>');content.push("</div>");if(closable){openPopup(content,false);}else{openPopup(content,true);}
AlphaBox.onAfterClose=function(){Mone.event(rb.type,rb.source+' Complete',"Logged In Popup Popup closed");}
var stockText=SA.Utils.Expansion.Input($("autocomplete_roadblock"),{autocomplete:{stocks:true}});var error=$("display_roadblock_to_logged_in_error");var button=new SA.Utils.Button({element:$('display_roadblock_to_logged_in_click_go'),onclick:function(){stockText.removeClassName('bcred');error.innerHTML='';if(!stockText.Changed()){stockText.addClassName('bcred');Mone.event(rb.type,rb.source+" Add Stocks","Error : Please enter at least "+needToAdd+" stocks.");error.innerHTML="Please enter at least "+needToAdd+" stock"+s+".";return;}
var stocks=SA.Models.StockModel.stringToStocksArray(stockText.value);stocks[0].length>0?stockText.value=stocks[0].join(", "):stockText.Reset();if(stocks[1].length>0){error.innerHTML="*Symbol(s) not recognized: "+SA.Utils.joinWithAnd(stocks[1],", ");Mone.event(rb.type,rb.source+" Add Stocks "," Error : *Symbol(s) not recognized");stockText.addClassName('error');return;}
if(stocks[0].concat(currentStocks).uniq().length<5){stockText.addClassName('error');error.innerHTML="Please enter at least "+needToAdd+" stock"+s+".";Mone.event(rb.type,rb.source+" Add Stocks "," Error : Please enter at least "+needToAdd+" stocks");return;}
var rta=$('display_roadblock_to_logged_in_rta').checked?"rta_market_currents,rta_articles":"";var p=new SA.Models.PortfolioModel();if($('display_roadblock_to_logged_in_rta').checked)
Mone.event(rb.type,rb.source+" Add Stocks ","Add stocks conversion alerts",{data:{before:currentStocks.join(","),after:stocks[0].join(",")}});else Mone.event(rb.type,rb.source+" Add Stocks ","Add stocks conversion no alerts",{data:{before:currentStocks.join(","),after:stocks[0].join(",")}});button.Lock();p.createPortfolio('portfolio',stocks[0].join(","),function(){top.location.reload(true);},function(){button.UnLock()},rta,"Homepage Roadblock Create Portfolio");},loaderObj:$("roadblock_loader")});}
this.display_roadblock_to_logged_in_b=function(stocks){currentStocks=stocks?stocks.split(","):[];for(var i=0,s;s=currentStocks[i];i++)currentStocks[i]=s.toUpperCase();var content=[];var needToAdd=5-currentStocks.length;var s=(needToAdd==1?"":"s");content.push("<div style='width:673px; padding:23px;' class='roadblock_popup rbcontrol' id='display_roadblock_to_logged_in'>");content.push(rb_promo_text("Seeking Alpha’s homepage is designed to provide a custom experience for you centered around the stocks you care about. Please pick 5 or more stocks to get started."));content.push("<div class='fl' style='width:300px'>");content.push("<div class='update_box mt16'>");content.push(cleaner());content.push('<div class=" mt17 ml20 fl">');content.push("<div style='color:#721314;line-height:22px;' class='fwb fs15'>Please customize: add at least "+needToAdd+" more stock"+s+"</div>");content.push("<div class='mt17'><input type='text' style='width:309px;height:41px;' class='fs17 pl4' id='autocomplete_roadblock' empty='Enter stocks, separate with a comma'/></div>");if(needToAdd<5)content.push("<div style='color:#999;font-size:13px;margin-top:12px;' class=''>Added so far: "+currentStocks.join(", ")+".</div>");content.push("<div class='sendNews_cnt'><div class='fl'><input type='checkbox' id='display_roadblock_to_logged_in_rta' checked/></div><div class='sendMe'>Send me news and email alerts on these stocks.</div></div>");content.push('<div class="pro_blue_button" style="width:60px;float:left" id="display_roadblock_to_logged_in_click_go">GO!</div>');content.push('<div class="fs12 fl red" style="margin:8px 0 0 10px" id="display_roadblock_to_logged_in_error"></div>');content.push('<div id="roadblock_loader" class="fl mt15 small_loader" style="display:none"></div>');""
content.push("</div></div></div></div>");openPopup(content,true,true);Mone.event(rb.type,rb.source+' ',"Logged in Popup");var stockText=SA.Utils.Expansion.Input($("autocomplete_roadblock"),{autocomplete:{stocks:true}});var error=$("display_roadblock_to_logged_in_error");if($('autocomplete_container_sa_input_autocomplete_roadblock'))$('autocomplete_container_sa_input_autocomplete_roadblock').style.width="318px";var button=new SA.Utils.Button({element:$('display_roadblock_to_logged_in_click_go'),onclick:function(){stockText.removeClassName('bcred');error.innerHTML='';if(!stockText.Changed()){stockText.addClassName('bcred');Mone.event(rb.type,rb.source+" Add Stocks","Error : Please enter at least "+needToAdd+" stocks.");error.innerHTML="Please enter at least "+needToAdd+" stock"+s+".";return;}
var stocks=SA.Models.StockModel.stringToStocksArray(stockText.value);stocks[0].length>0?stockText.value=stocks[0].join(", "):stockText.Reset();if(stocks[1].length>0){error.innerHTML="*Symbol(s) not recognized: "+SA.Utils.joinWithAnd(stocks[1],", ");Mone.event(rb.type,rb.source+" Add Stocks "," Error : *Symbol(s) not recognized");stockText.addClassName('error');return;}
if(stocks[0].concat(currentStocks).uniq().length<5){stockText.addClassName('error');error.innerHTML="Please enter at least "+needToAdd+" stock"+s+".";Mone.event(rb.type,rb.source+" Add Stocks "," Error : Please enter at least "+needToAdd+" stocks");return;}
var rta=$('display_roadblock_to_logged_in_rta').checked?"rta_market_currents,rta_articles":"";var p=new SA.Models.PortfolioModel();if($('display_roadblock_to_logged_in_rta').checked)
Mone.event(rb.type,rb.source+" Add Stocks ","Add stocks conversion alerts",{data:{before:currentStocks.join(","),after:stocks[0].join(",")}});else Mone.event(rb.type,rb.source+" Add Stocks ","Add stocks conversion no alerts",{data:{before:currentStocks.join(","),after:stocks[0].join(",")}});button.Lock();p.createPortfolio('portfolio',stocks[0].join(","),function(){top.location.reload(true);},function(){button.UnLock()},rta,"Homepage Roadblock Create Portfolio");},loaderObj:$("roadblock_loader")});}
this.pro_singup=function(){var html=[];html.push("<div id='readlater_register_login' class='customize_pop_bordeaux mail_sent'>");html.push("<div class='bordeaux fs20'>Welcome to PRO!</div>");html.push("  <div class='mt10'>Which Stocks do you want to receive Pro alerts on?</div>");html.push("  <input type='text' class='fl m10' style='width:358px;color:#959595' onfocus=\"handleInput(this,'focus');handleInput(this, 'focus');this.style.color='#000000';\" id=\"autocomplete_pro\" class=\"add_stock_text\" autocomplete=\"off\" onblur=\"this.style.color=this.value=='' ? '#959595' : '#000000';handleInput(this,'blur');\" title=\"(example: GLD, GOOG)\" value=\"(example: GLD, GOOG)\">");html.push("  <div id='pro_signup_error' class='fs11 red' style=\"width:350px\"></div>");html.push("  <br><input class=\"rounded_button gray fl mt10 fs12\" type=\"button\" value=\"Save & Continue\" tabindex=\"52\" style=\"font-family:Arial\" onclick=\"create_portfolio()\">");html.push("  <img id=\"loader_while_fetch\" class=\"loader_while_fetch fr\" src=\"http://static3.cdn-seekingalpha.com/images/loader.gif\" style=\"display:none;\">");html.push(cleaner());html.push("  <div class='fs11 mt10'> * The stocks you are tracking wont be shown publicly. In no way should the appearance of securities on this page be interpreted as a recommendation to buy.</div>");html.push("</div>");html.push(cleaner());html.push(closer());html.push('<div></div>');openPopup(html);stockArea=SA.Utils.Expansion.Input('autocomplete_pro');}
this.pro_mail_daily=function(){var html=[];html.push("<div id='readlater_register_login' class='customize_pop_bordeaux mail_sent'>");html.push("<h3 style='font-size: 20px !important;'>Daily emails on the latest Pro articles are an integral part of your Pro subscription. For the best experience please keep this option selected.</h3>");html.push("<div class='cant_see_note mt10'><span class='button_basics keep_button mr20' onclick='$(\"alert_51191\").click();AlphaBox.Close();'>Keep Pro Alerts</span><span class='fl mt2 blue cp' onclick='AlphaBox.Close();'>Remove Pro Alerts</span></div>");html.push("</div>");html.push(cleaner());html.push(closer());html.push('<div></div>');openPopup(html);}
this.showSubscribedFromEmailThankYou=function(email){var html=[];html.push('<div>');html.push('<div class="rta_pop_article thankyou">');html.push(rta_closer());html.push('<div class="rta_pop_article_top">');html.push('<div class="green_title">You will now receive real-time alerts on the tickers in your portfolios.</div>');html.push('<p class="email_msg_popup">You can edit your alerts subscriptions at any time here.</p>');html.push('<p class="last_p">Emails will be sent to <strong>'+email+'</strong></p>');html.push('</div>');html.push(cleaner());html.push('</div>');html.push('</div>');openPopup(html);}
this.showCustomMessagePopup=function(msg){var html=[];html.push('<div>');html.push('<div class="rta_pop_article thankyou">');html.push(rta_closer());html.push('<div class="rta_pop_article_top">');html.push('<div class="green_title">'+msg.escapeHTML()+'</div>');html.push('</div>');html.push(cleaner());html.push('</div>');html.push('</div>');openPopup(html);}
this.email_story_to_friends_html=function(id,mail_to_uri,type){var koko=[];koko.push("<form id=\"email_to_a_friend\" method=\"post\" onsubmit=\"validate_email_to_a_friend_popup('"+type+"');return false;\">")
koko.push("<div id=\"email_to_a_friend_popup\">");koko.push("<div style=\"font-size:0.8em;\"><strong style=\"font-size:18px; color: #891C0D;\">Send "+((type=='Article')||(type=='AcquireStory')?'Article':(type=='InstablogPost'?'Instablog Post':(type=='MarketCurrent'?'this Market Current':'StockTalk')))+"</strong> or ");var title_text=""
if(type=='InstablogPost'){title_text="Instablog post";}else{title_text=(type=='MarketCurrent'?'Market Current':'article')+" on Seeking Alpha";}
koko.push("<a onclick=\"email_story_to_friends_log('"+type+"', 'open_client',"+id+");AlphaBox.Close();\" target=\"_blank\" href=\"mailto:?body= I thought you might find this "+title_text+" interesting: "+mail_to_uri+"?source=from_friend_client\">click here to send it from your default email program</a>");koko.push(" <span style=\"font-style:italic; color:grey;\">e.g. Outlook</span></div>")
koko.push("<div><strong>Send to (up to 10 recipients):</strong></div><div class=\"error_message\" style=\"display:none\" id=\"friend_emails_errors\"></div>");koko.push("<input type=\"text\" class=\"text\" id=\"friend_emails\" name=\"friend_emails\">");koko.push("<div class=\"note\">Enter the email address of the recipient. Separate multiple addresses with commas.</div>");koko.push("<div><strong>Add your own personal message:</strong></div>");koko.push("<textarea rows=\"5\" cols=\"20\" class=\"input_text_switcher2\ id=\"personal_message\" name=\"personal_message\" title=\"I thought you might find this "+title_text+" interesting: \" onfocus=\"handleInput(this,'focus')\" onblur=\"handleInput(this,'blur')\" onkeypress=\"return imposeMaxLength(this, 200);\">I thought you might find this "+title_text+" interesting: </textarea>");if(!is_users_cookie_exists()){koko.push("<div><strong>Enter your name: (required)</strong></div><div class=\"error_message\" style=\"display:none\" id=\"my_name_error\"></div>");koko.push("<input type=\"text\" class=\"text\" id=\"my_name\" name=\"my_name\">");koko.push("<div class=\"alert\">To help us prevent spamming, please answer:</div>");koko.push("<div><strong><span id=\"captcha_question\"></span></strong></div><div class=\"error_message\" style=\"display:none\" id=\"answer_captcha_error\"></div>");koko.push("<input type=\"hidden\" name=\"captcha_id\" id=\"captcha_id\" />");koko.push("<input type=\"text\" class=\"text\" id=\"answer_captcha\" name=\"answer_captcha\">");}
koko.push("<input type=\"submit\" id=\"email_to_a_friend_send_button\" class=\"button\" value=\"Send\">");koko.push("<div class=\"loader\" id=\"email_to_a_friend_loader\" style=\"display:none;\"><img src=\"http://static3.cdn-seekingalpha.com/images/loader.gif\" style=\"clear: both\"/></div>")
koko.push("<input type=\"hidden\" id=\"article_id\" name=\"article_id\" value=\""+id+"\">");koko.push("<span id=\"closeButton\" onclick=\"AlphaBox.Close()\">");koko.push("</div></form>");return koko.join("");}
this.display_sent_story_to_friends_email_html=function(type,article_id,from,to,subject,text){var koko=[];koko.push("<div id='email_to_a_friend_success_screen'>")
koko.push("<div style='margin-top: 35px; font-size:1.6em; color:maroon;'>Success!</div>")
koko.push("<div style='color:green; font-weight:700; margin-bottom:30px;'>Your Message has been sent</div>")
koko.push("<div style='font-style:italic; color:gray; border-bottom:1px dashed gray; margin-bottom:17px; font-size:0.95em; padding-bottom:5px;'>Quoted message</div>")
koko.push("<div style='margin-bottom:5px; font-size:0.8em;'><strong>From: &nbsp;&nbsp;</strong><span>"+from+"</span></div>")
koko.push("<div style='margin-bottom:5px; font-size:0.8em;'><strong>To: &nbsp;&nbsp;</strong><span>"+to+"</span></div>")
koko.push("<div style='font-size:0.8em;'><strong>Subject: &nbsp;&nbsp;</strong><span>"+subject+"</span></div>")
koko.push("<div style='margin-top:20px; font-size:0.8em;'>"+text+"</div>")
koko.push("<div style='font-size:0.8em; border-top:1px dashed gray; padding-top:5px; margin-top:20px; color:gray;'>This page was sent using our Send-to-Friend service</div>")
koko.push("<div style='font-size:0.8em; float:right; margin-top:10px; font-style:italic; color:gray;'>The Seeking Alpha Team.</div>")
koko.push("<span id=\"closeButton\" onclick=\"AlphaBox.Close()\">");koko.push("</div>")
return koko.join("");}
this.updateEmail=function(){var curEmail=SA.Data.User.email(),html=['<div class="customize_pop_bordeaux pro_status_popup settings">','<h3>Update your email address:</h3>','<h4>Your email address is:</h4>','<input type="text" value="'+curEmail+'" id="update_email_input" />',"<div class='error' style='display:none' id='update_email_err'>Invalid password</div>",'<div class="pro_btn_cnt silver">','  <div class="btn" id="update_email_btn">Update<span class="right"></span></div>',"  <img height='16' width='16' id='update_email_loader' src='http://static3.cdn-seekingalpha.com/images/loader.gif' style='margin: 3px 0px 0px 12px;display:none'>",'</div>',closer(),'</div>'];openPopup(html);var err=$('update_email_err'),input=$('update_email_input'),btn=new SA.Utils.Button({element:'update_email_btn',loaderObj:'update_email_loader',onclick:function(){var val=input.value.trim();if(val==curEmail)return AlphaBox.Close();if(!rxEmail.test(input.value))return err.update("Invalid email").show();btn.Lock();err.hide();SA.Utils.ajax("/account/ajax_update_email",{user_email:val},function(){btn.UnLock();var obj=$('cur_email');if(obj)obj.update(val);AlphaBox.Close();},function(response){btn.UnLock();if(/already been taken/.test(response.errors))err.update("This email address is already in use.");else err.update("Something wrong happen while updating email.");err.show();});}});}
this.suggest=function(){if($('autocomplete_roadblock')&&SA.Pages.Article&&typeof(SA.Pages.Article.primary)!="undefined"&&SA.Pages.Article.primary!=""&&(SA.Data.User.hasPortfolio()==null||!contains(SA.Pages.Article.primary,SA.Data.User.hasPortfolio().toUpperCase().split(",")))){$('autocomplete_roadblock').SetValue(SA.Pages.Article.primary.toUpperCase()+",");$('autocomplete_roadblock').removeClassName("default_text");}}
function openPopup(content,special,abtest){if(special){road_version=ABTest.identity%10;var color="white";if(abtest&&road_version<5){color="#000000";}
AlphaBox.Loading({background:color,showHeader:true,Locked:true})
AlphaBox.AddHtml(content.join(''),{force:true});}else{AlphaBox.Loading();AlphaBox.AddHtml(content.join(''));}
setTimeout("SA.Utils.Popup.suggest()",2000);}
function closer(){return"<div class='close_pop_bordeaux' onclick='AlphaBox.Close();'></div>";}
function rta_closer(){return'<div class="rta_pop_article_close" onclick="AlphaBox.Close()">X</div>';}
function cleaner(){return'<div class="cleaner"></div>';}
function rb_promo_text(text){unit="<div class='fl mt10 fs14 light-gray' style='width:313px;'>";unit+="<div class='sa_personalized'></div>";unit+="<div class='mt16 ln28' style='width:270px'>";unit+=text;unit+="</div>";if(users_on_site)unit+="<div class='mt50'>Join "+users_on_site+" other registered users.</div>";unit+="<div class='fwb mt12'>It’s easy, and it’s free.</div>";unit+="</div>";return unit;}}})();