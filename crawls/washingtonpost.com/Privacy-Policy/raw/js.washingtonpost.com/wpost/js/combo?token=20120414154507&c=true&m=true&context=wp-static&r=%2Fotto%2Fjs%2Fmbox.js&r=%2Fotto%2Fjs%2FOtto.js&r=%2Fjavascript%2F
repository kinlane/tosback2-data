var mboxCopyright="&copy; 2003-2009. Omniture, Inc. All rights reserved.";var mboxAddScript=function(C){var B=document.getElementsByTagName("head");if(B.length){var A=document.createElement("script");A.type="text/javascript";A.src=C;B[0].appendChild(A);}};var mboxAddCss=function(B){var C=document.getElementsByTagName("head");if(C.length){var A=document.createElement("style");A.type="text/css";if(A.styleSheet){A.styleSheet.cssText=B;}else{A.appendChild(document.createTextNode(B));}C[0].appendChild(A);}};var mboxPrependBodyHTML=function(C,D){D=(!isNaN(D)&&D>=0)?Math.floor(D):10;var A=document.getElementsByTagName("body")[0];if(A){if(A.childNodes[0]){var E=document.createElement("div");E.innerHTML=C;for(var B=E.childNodes.length-1;B>=0;B--){A.insertBefore(E.childNodes[B],A.childNodes[0]);}}else{setTimeout(function(){mboxPrependBodyHTML(C);},D);}}else{setTimeout(function(){mboxPrependBodyHTML(C);},D);}};mboxUrlBuilder=function(B,A){this.a=B;this.b=A;this.c=new Array();this.d=function(C){return C;};this.f=null;};mboxUrlBuilder.prototype.addParameter=function(F,E){var D=new RegExp("('|\")");if(D.exec(F)){throw"Parameter '"+F+"' contains invalid characters";}for(var C=0;C<this.c.length;C++){var B=this.c[C];if(B.name==F){B.value=E;return this;}}var A=new Object();A.name=F;A.value=E;this.c[this.c.length]=A;return this;};mboxUrlBuilder.prototype.addParameters=function(C){if(!C){return this;}for(var B=0;B<C.length;B++){var A=C[B].indexOf("=");if(A==-1||A==0){continue;}this.addParameter(C[B].substring(0,A),C[B].substring(A+1,C[B].length));}return this;};mboxUrlBuilder.prototype.setServerType=function(A){this.o=A;};mboxUrlBuilder.prototype.setBasePath=function(A){this.f=A;};mboxUrlBuilder.prototype.setUrlProcessAction=function(A){this.d=A;};mboxUrlBuilder.prototype.buildUrl=function(){var E=this.f?this.f:"/m2/"+this.b+"/mbox/"+this.o;var D=document.location.protocol=="file:"?"http:":document.location.protocol;var F=D+"//"+this.a+E;var C=F.indexOf("?")!=-1?"&":"?";for(var B=0;B<this.c.length;B++){var A=this.c[B];F+=C+encodeURIComponent(A.name)+"="+encodeURIComponent(A.value);C="&";}return this.t(this.d(F));};mboxUrlBuilder.prototype.getParameters=function(){return this.c;};mboxUrlBuilder.prototype.setParameters=function(A){this.c=A;};mboxUrlBuilder.prototype.clone=function(){var B=new mboxUrlBuilder(this.a,this.b);B.setServerType(this.o);B.setBasePath(this.f);B.setUrlProcessAction(this.d);for(var A=0;A<this.c.length;A++){B.addParameter(this.c[A].name,this.c[A].value);}return B;};mboxUrlBuilder.prototype.t=function(A){return A.replace(/\"/g,"&quot;").replace(/>/g,"&gt;");};mboxStandardFetcher=function(){};mboxStandardFetcher.prototype.getType=function(){return"standard";};mboxStandardFetcher.prototype.fetch=function(A){A.setServerType(this.getType());if(!window.TWP||!TWP.Constants||!TWP.Constants.AllowDocwrite||typeof TWP.Constants.AllowDocwrite.IN_OTTO=="undefined"||TWP.Constants.AllowDocwrite.IN_OTTO){document.write("<"+"scr"+'ipt language="Javascript1.2" src="'+A.buildUrl()+'"><'+"/scr"+"ipt>");}else{mboxAddScript(A.buildUrl());}};mboxStandardFetcher.prototype.cancel=function(){};mboxAjaxFetcher=function(){};mboxAjaxFetcher.prototype.getType=function(){return"ajax";};mboxAjaxFetcher.prototype.fetch=function(A){A.setServerType(this.getType());var B=A.buildUrl();this.x=document.createElement("script");this.x.src=B;document.body.appendChild(this.x);};mboxAjaxFetcher.prototype.cancel=function(){};mboxMap=function(){this.y=new Object();this.z=new Array();};mboxMap.prototype.put=function(B,C){if(!this.y[B]){this.z[this.z.length]=B;}this.y[B]=C;};mboxMap.prototype.get=function(B){return this.y[B];};mboxMap.prototype.remove=function(B){this.y[B]=undefined;};mboxMap.prototype.each=function(E){for(var C=0;C<this.z.length;C++){var B=this.z[C];var D=this.y[B];if(D){E(B,D);}}};mboxFactory=function(G,A,F){this.D=false;this.B=G;this.C=F;this.E=new mboxList();mboxFactories.put(F,this);this.F=typeof document.createElement("div").replaceChild!="undefined"&&(function(){return true;})()&&typeof document.getElementById!="undefined"&&typeof (window.attachEvent||document.addEventListener||window.addEventListener)!="undefined"&&typeof encodeURIComponent!="undefined";this.G=this.F&&mboxGetPageParameter("mboxDisable")==null;var D=F=="default";this.I=new mboxCookieManager("mbox"+(D?"":("-"+F)),(function(){return mboxCookiePageDomain();})());this.G=this.G&&this.I.isEnabled()&&(this.I.getCookie("disable")==null);if(this.isAdmin()){this.enable();}this.J=mboxGenerateId();this.K=new mboxSession(this.J,"mboxSession","session",31*60,this.I);this.L=new mboxPC("PC",1209600,this.I);this.w=new mboxUrlBuilder(G,A);this.M(this.w,D);this.N=new Date().getTime();this.O=this.N;var E=this;this.addOnLoad(function(){E.O=new Date().getTime();});if(this.F){this.addOnLoad(function(){E.D=true;E.getMboxes().each(function(B){B.setFetcher(new mboxAjaxFetcher());B.finalize();});});this.limitTraffic(100,10368000);if(this.G){this.R();this.S=new mboxSignaler(function(B,C){return E.create(B,C);},this.I);}}};mboxFactory.prototype.isEnabled=function(){return this.G;};mboxFactory.prototype.getDisableReason=function(){return this.I.getCookie("disable");};mboxFactory.prototype.isSupported=function(){return this.F;};mboxFactory.prototype.disable=function(B,A){if(typeof B=="undefined"){B=60*60;}if(typeof A=="undefined"){A="unspecified";}if(!this.isAdmin()){this.G=false;this.I.setCookie("disable",A,B);}};mboxFactory.prototype.enable=function(){this.G=true;this.I.deleteCookie("disable");};mboxFactory.prototype.isAdmin=function(){return document.location.href.indexOf("mboxEnv")!=-1;};mboxFactory.prototype.limitTraffic=function(A,B){};mboxFactory.prototype.addOnLoad=function(A){if(window.addEventListener){window.addEventListener("load",A,false);}else{if(document.addEventListener){document.addEventListener("load",A,false);}else{if(document.attachEvent){window.attachEvent("onload",A);}}}};mboxFactory.prototype.getEllapsedTime=function(){return this.O-this.N;};mboxFactory.prototype.getEllapsedTimeUntil=function(A){return A-this.N;};mboxFactory.prototype.getMboxes=function(){return this.E;};mboxFactory.prototype.get=function(A,B){return this.E.get(A).getById(B||0);};mboxFactory.prototype.update=function(A,B){if(!this.isEnabled()){return ;}if(this.E.get(A).length()==0){throw"Mbox "+A+" is not defined";}this.E.get(A).each(function(C){C.getUrlBuilder().addParameter("mboxPage",mboxGenerateId());C.load(B);});};mboxFactory.prototype.create=function(C,I,A){if(!this.isSupported()){return null;}var G=this.w.clone();G.addParameter("mboxCount",this.E.length()+1);G.addParameters(I);var B=this.E.get(C).length();var J=this.C+"-"+C+"-"+B;var L;if(A){L=new mboxLocatorNode(A);}else{if(this.D){throw"The page has already been loaded, can't write marker";}L=new mboxLocatorDefault(J);}try{var E=this;var H="mboxImported-"+J;var D=new mbox(C,B,G,L,H);if(this.G){D.setFetcher(this.D?new mboxAjaxFetcher():new mboxStandardFetcher());}D.setOnError(function(M,N){D.setMessage(M);D.activate();if(!D.isActivated()){E.disable(60*60,M);window.location.reload(false);}});this.E.add(D);}catch(K){this.disable();throw'Failed creating mbox "'+C+'", the error was: '+K;}var F=new Date();G.addParameter("mboxTime",F.getTime()-(F.getTimezoneOffset()*60000));return D;};mboxFactory.prototype.getCookieManager=function(){return this.I;};mboxFactory.prototype.getPageId=function(){return this.J;};mboxFactory.prototype.getPCId=function(){return this.L;};mboxFactory.prototype.getSessionId=function(){return this.K;};mboxFactory.prototype.getSignaler=function(){return this.S;};mboxFactory.prototype.getUrlBuilder=function(){return this.w;};mboxFactory.prototype.M=function(B,A){B.addParameter("mboxHost",document.location.hostname).addParameter("mboxSession",this.K.getId());if(!A){B.addParameter("mboxFactoryId",this.C);}if(this.L.getId()!=null){B.addParameter("mboxPC",this.L.getId());}B.addParameter("mboxPage",this.J);B.setUrlProcessAction(function(D){D+="&mboxURL="+encodeURIComponent(document.location);
var C=encodeURIComponent(document.referrer);if(D.length+C.length<2000){D+="&mboxReferrer="+C;}D+="&mboxVersion="+mboxVersion;return D;});};mboxFactory.prototype.gb=function(){return"";};mboxFactory.prototype.R=function(){if(!window.TWP||!TWP.Constants||!TWP.Constants.AllowDocwrite||typeof TWP.Constants.AllowDocwrite.IN_OTTO=="undefined"||TWP.Constants.AllowDocwrite.IN_OTTO){document.write("<"+"sty"+"le>.mboxDefault { visibility:hidden; }<"+"/sty"+"le>");}else{mboxAddCss(".mboxDefault { visibility:hidden; }");}};mboxFactory.prototype.isDomLoaded=function(){return this.D;};mboxSignaler=function(G,D){this.I=D;var A=D.getCookieNames("signal-");for(var C=0;C<A.length;C++){var B=A[C];var E=D.getCookie(B).split("&");var F=G(E[0],E);F.load();D.deleteCookie(B);}};mboxSignaler.prototype.signal=function(B,A){this.I.setCookie("signal-"+B,mboxShiftArray(arguments).join("&"),45*60);};mboxList=function(){this.E=new Array();};mboxList.prototype.add=function(A){if(A!=null){this.E[this.E.length]=A;}};mboxList.prototype.get=function(B){var D=new mboxList();for(var A=0;A<this.E.length;A++){var C=this.E[A];if(C.getName()==B){D.add(C);}}return D;};mboxList.prototype.getById=function(A){return this.E[A];};mboxList.prototype.length=function(){return this.E.length;};mboxList.prototype.each=function(B){if(typeof B!="function"){throw"Action must be a function, was: "+typeof (B);}for(var A=0;A<this.E.length;A++){B(this.E[A]);}};mboxLocatorDefault=function(A){this.g="mboxMarker-"+A;if(!window.TWP||!TWP.Constants||!TWP.Constants.AllowDocwrite||typeof TWP.Constants.AllowDocwrite.IN_OTTO=="undefined"||TWP.Constants.AllowDocwrite.IN_OTTO){document.write('<div id="'+this.g+'" style="visibility:hidden;display:none">&nbsp;</div>');}else{mboxPrependBodyHTML('<div id="'+this.g+'" style="visibility:hidden;display:none">&nbsp;</div>');}};mboxLocatorDefault.prototype.locate=function(){var A=document.getElementById(this.g);while(A!=null){if(A.nodeType==1){if(A.className=="mboxDefault"){return A;}}A=A.previousSibling;}return null;};mboxLocatorDefault.prototype.force=function(){var A=document.createElement("div");A.className="mboxDefault";var B=document.getElementById(this.g);B.parentNode.insertBefore(A,B);return A;};mboxLocatorNode=function(A){this.ob=A;};mboxLocatorNode.prototype.locate=function(){return typeof this.ob=="string"?document.getElementById(this.ob):this.ob;};mboxLocatorNode.prototype.force=function(){return null;};mboxCreate=function(A){var B=mboxFactoryDefault.create(A,mboxShiftArray(arguments));if(B){B.load();}return B;};mboxDefine=function(C,A){var B=mboxFactoryDefault.create(A,mboxShiftArray(mboxShiftArray(arguments)),C);return B;};mboxUpdate=function(A){mboxFactoryDefault.update(A,mboxShiftArray(arguments));};mbox=function(C,E,B,A,D){this.ub=null;this.vb=0;this.ab=A;this.bb=D;this.wb=null;this.xb=new mboxOfferContent();this.pb=null;this.w=B;this.message="";this.yb=new Object();this.zb=0;this.sb=E;this.g=C;this.Ab();B.addParameter("mbox",C).addParameter("mboxId",E);this.Bb=function(){};this.Cb=function(){};this.Db=null;};mbox.prototype.getId=function(){return this.sb;};mbox.prototype.Ab=function(){if(this.g.length>250){throw"Mbox Name "+this.g+" exceeds max length of "+"250 characters.";}else{if(this.g.match(/^\s+|\s+$/g)){throw"Mbox Name "+this.g+" has leading/trailing whitespace(s).";}}};mbox.prototype.getName=function(){return this.g;};mbox.prototype.getParameters=function(){var C=this.w.getParameters();var B=new Array();for(var A=0;A<C.length;A++){if(C[A].name.indexOf("mbox")!=0){B[B.length]=C[A].name+"="+C[A].value;}}return B;};mbox.prototype.setOnLoad=function(A){this.Cb=A;return this;};mbox.prototype.setMessage=function(A){this.message=A;return this;};mbox.prototype.setOnError=function(A){this.Bb=A;return this;};mbox.prototype.setFetcher=function(A){if(this.wb){this.wb.cancel();}this.wb=A;return this;};mbox.prototype.getFetcher=function(){return this.wb;};mbox.prototype.load=function(C){if(this.wb==null){return this;}this.setEventTime("load.start");this.cancelTimeout();this.vb=0;var A=(C&&C.length>0)?this.w.clone().addParameters(C):this.w;this.wb.fetch(A);var B=this;this.Fb=setTimeout(function(){B.Bb("browser timeout",B.wb.getType());},15000);this.setEventTime("load.end");return this;};mbox.prototype.loaded=function(){this.cancelTimeout();if(!this.activate()){var A=this;setTimeout(function(){A.loaded();},100);}};mbox.prototype.activate=function(){if(this.vb){return this.vb;}this.setEventTime("activate"+ ++this.zb+".start");if(this.show()){this.cancelTimeout();this.vb=1;}this.setEventTime("activate"+this.zb+".end");return this.vb;};mbox.prototype.isActivated=function(){return this.vb;};mbox.prototype.setOffer=function(A){if(A&&A.show&&A.setOnLoad){this.xb=A;}else{throw"Invalid offer";}return this;};mbox.prototype.getOffer=function(){return this.xb;};mbox.prototype.show=function(){this.setEventTime("show.start");var A=this.xb.show(this);this.setEventTime(A==1?"show.end.ok":"show.end");return A;};mbox.prototype.showContent=function(A){if(A==null){return 0;}if(this.pb==null||!this.pb.parentNode){this.pb=this.getDefaultDiv();if(this.pb==null){return 0;}}if(this.pb!=A){this.Hb(this.pb);this.pb.parentNode.replaceChild(A,this.pb);this.pb=A;}this.Ib(A);this.Cb();return 1;};mbox.prototype.hide=function(){this.setEventTime("hide.start");var A=this.showContent(this.getDefaultDiv());this.setEventTime(A==1?"hide.end.ok":"hide.end.fail");return A;};mbox.prototype.finalize=function(){this.setEventTime("finalize.start");this.cancelTimeout();if(this.getDefaultDiv()==null){if(this.ab.force()!=null){this.setMessage("No default content, an empty one has been added");}else{this.setMessage("Unable to locate mbox");}}if(!this.activate()){this.hide();this.setEventTime("finalize.end.hide");}this.setEventTime("finalize.end.ok");};mbox.prototype.cancelTimeout=function(){if(this.Fb){clearTimeout(this.Fb);}if(this.wb!=null){this.wb.cancel();}};mbox.prototype.getDiv=function(){return this.pb;};mbox.prototype.getDefaultDiv=function(){if(this.Db==null){this.Db=this.ab.locate();}return this.Db;};mbox.prototype.setEventTime=function(A){this.yb[A]=(new Date()).getTime();};mbox.prototype.getEventTimes=function(){return this.yb;};mbox.prototype.getImportName=function(){return this.bb;};mbox.prototype.getURL=function(){return this.w.buildUrl();};mbox.prototype.getUrlBuilder=function(){return this.w;};mbox.prototype.Kb=function(A){return A.style.display!="none";};mbox.prototype.Ib=function(A){this.Lb(A,true);};mbox.prototype.Hb=function(A){this.Lb(A,false);};mbox.prototype.Lb=function(B,A){B.style.visibility=A?"visible":"hidden";B.style.display=A?"block":"none";};mboxOfferContent=function(){this.Cb=function(){};};mboxOfferContent.prototype.show=function(A){var B=A.showContent(document.getElementById(A.getImportName()));if(B==1){this.Cb();}return B;};mboxOfferContent.prototype.setOnLoad=function(A){this.Cb=A;};mboxOfferAjax=function(A){this.Gb=A;this.Cb=function(){};};mboxOfferAjax.prototype.setOnLoad=function(A){this.Cb=A;};mboxOfferAjax.prototype.show=function(B){var A=document.createElement("div");A.id=B.getImportName();A.innerHTML=this.Gb;var C=B.showContent(A);if(C==1){this.Cb();}return C;};mboxOfferDefault=function(){this.Cb=function(){};};mboxOfferDefault.prototype.setOnLoad=function(A){this.Cb=A;};mboxOfferDefault.prototype.show=function(A){var B=A.hide();if(B==1){this.Cb();}return B;};mboxCookieManager=function mboxCookieManager(B,A){this.g=B;this.Ob=A==""||A.indexOf(".")==-1?"":"; domain="+A;this.Pb=new mboxMap();this.loadCookies();};mboxCookieManager.prototype.isEnabled=function(){this.setCookie("check","true",60);this.loadCookies();return this.getCookie("check")=="true";};mboxCookieManager.prototype.setCookie=function(C,B,A){if(typeof C!="undefined"&&typeof B!="undefined"&&typeof A!="undefined"){var D=new Object();D.name=C;D.value=escape(B);D.expireOn=Math.ceil(A+new Date().getTime()/1000);this.Pb.put(C,D);this.saveCookies();}};mboxCookieManager.prototype.getCookie=function(A){var B=this.Pb.get(A);
return B?unescape(B.value):null;};mboxCookieManager.prototype.deleteCookie=function(A){this.Pb.remove(A);this.saveCookies();};mboxCookieManager.prototype.getCookieNames=function(B){var A=new Array();this.Pb.each(function(C,D){if(C.indexOf(B)==0){A[A.length]=C;}});return A;};mboxCookieManager.prototype.saveCookies=function(){var A=new Array();var B=0;this.Pb.each(function(D,E){A[A.length]=D+"#"+E.value+"#"+E.expireOn;if(B<E.expireOn){B=E.expireOn;}});var C=new Date(B*1000);document.cookie=this.g+"="+A.join("|")+"; expires="+C.toGMTString()+"; path=/"+this.Ob;};mboxCookieManager.prototype.loadCookies=function(){this.Pb=new mboxMap();var G=document.cookie.indexOf(this.g+"=");if(G!=-1){var A=document.cookie.indexOf(";",G);if(A==-1){A=document.cookie.indexOf(",",G);if(A==-1){A=document.cookie.length;}}var B=document.cookie.substring(G+this.g.length+1,A).split("|");var E=Math.ceil(new Date().getTime()/1000);for(var D=0;D<B.length;D++){var F=B[D].split("#");if(E<=F[2]){var C=new Object();C.name=F[0];C.value=F[1];C.expireOn=F[2];this.Pb.put(C.name,C);}}}};mboxSession=function(C,D,B,E,A){this.bc=D;this.jb=B;this.cc=E;this.I=A;this.dc=false;this.sb=typeof mboxForceSessionId!="undefined"?mboxForceSessionId:mboxGetPageParameter(this.bc);if(this.sb==null||this.sb.length==0){this.sb=A.getCookie(B);if(this.sb==null||this.sb.length==0){this.sb=C;this.dc=true;}}A.setCookie(B,this.sb,E);};mboxSession.prototype.getId=function(){return this.sb;};mboxSession.prototype.forceId=function(A){this.sb=A;this.I.setCookie(this.jb,this.sb,this.cc);};mboxPC=function(B,C,A){this.jb=B;this.cc=C;this.I=A;this.sb=typeof mboxForcePCId!="undefined"?mboxForcePCId:A.getCookie(B);if(this.sb!=null){A.setCookie(B,this.sb,C);}};mboxPC.prototype.getId=function(){return this.sb;};mboxPC.prototype.forceId=function(A){if(this.sb!=A){this.sb=A;this.I.setCookie(this.jb,this.sb,this.cc);return true;}return false;};mboxGetPageParameter=function(B){var D=null;var A=new RegExp(B+"=([^&]*)");var C=A.exec(document.location);if(C!=null&&C.length>=2){D=C[1];}return D;};mboxSetCookie=function(C,B,A){return mboxFactoryDefault.getCookieManager().setCookie(C,B,A);};mboxGetCookie=function(A){return mboxFactoryDefault.getCookieManager().getCookie(A);};mboxCookiePageDomain=function(){var B=(/([^:]*)(:[0-9]{0,5})?/).exec(document.location.host)[1];var C=/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/;if(!C.exec(B)){var A=(/([^\.]+\.[^\.]{3}|[^\.]+\.[^\.]+\.[^\.]{2})$/).exec(B);if(A){B=A[0];}}return B?B:"";};mboxShiftArray=function(A){var C=new Array();for(var B=1;B<A.length;B++){C[C.length]=A[B];}return C;};mboxGenerateId=function(){return(new Date()).getTime()+"-"+Math.floor(Math.random()*999999);};if(typeof mboxVersion=="undefined"){var mboxVersion=38;var mboxFactories=new mboxMap();var mboxFactoryDefault=new mboxFactory("wpni.tt.omtrdc.net","wpni","default");}if(mboxGetPageParameter("mboxDebug")!=null||mboxFactoryDefault.getCookieManager().getCookie("debug")!=null){setTimeout(function(){if(typeof mboxDebugLoaded=="undefined"){alert("Could not load the remote debug.\nPlease check your connection"+" to Test&amp;Target servers");}},60*60);if(!window.TWP||!TWP.Constants||!TWP.Constants.AllowDocwrite||typeof TWP.Constants.AllowDocwrite.IN_OTTO=="undefined"||TWP.Constants.AllowDocwrite.IN_OTTO){document.write("<"+"scr"+'ipt language="Javascript1.2" src='+'"http://admin12.testandtarget.omniture.com/admin/mbox/mbox_debug.jsp?mboxServerHost=wpni.tt.omtrdc.net'+'&clientCode=wpni"><'+"/scr"+"ipt>");}else{mboxAddScript("http://admin12.testandtarget.omniture.com/admin/mbox/mbox_debug.jsp?mboxServerHost=wpni.tt.omtrdc.net' + '&clientCode=wpni");}}if(typeof wpMboxMgr=="undefined"){var wpMboxMgr={MgrItem:function(C,B,A,E){this.name=B.toLowerCase();this.parent=C;this.percentage=(!A?5:Math.max(1,Math.min(100,A)));this.ottoProperty=this.name.toUpperCase()+"_ACTIVE";this.cookie={name:"od"+this.name,duration:(E?E:1209600),value:mboxFactoryDefault.getCookieManager().getCookie("od"+this.name)};this.synchValues=new Array();this.synchValues.get=function(G){for(var H=0;H<this.length;H++){if(this[H]==G){return H;}}return -1;};function F(G){return(G=="0"||G=="1");}function D(G){return(Math.ceil(Math.random()*100)<=G.percentage?"1":"0");}this.synchWith=function(){for(var H=0;H<arguments.length;H++){var G=arguments[H].toLowerCase();if(this.synchValues.get(G)<0){this.synchValues.push(G);}}this.setValue(this.cookie.value);};this.isActive=function(){return(this.cookie.value=="1");};this.setValue=function(K,J){K=K+"";this.cookie.value=(F(K)?K:D(this));mboxFactoryDefault.getCookieManager().setCookie(this.cookie.name,this.cookie.value,this.cookie.duration);if(typeof Otto!="undefined"&&this.ottoProperty&&this.ottoProperty!=""){Otto[this.ottoProperty]=this.isActive();}if(!J&&this.isActive()){for(var H=0,G;G=this.synchValues[H],H<this.synchValues.length;H++){var I=this.parent.get(G);if(I){I.setValue(K,true);}}}};this.setValue(this.cookie.value);},list:new Array(),get:function(A){if(A&&A!=""){A=A.toLowerCase();for(var B=0;B<this.list.length;B++){if(this.list[B].name==A){return this.list[B];}}}},add:function(B,A,D){if(!this.get(B)){var C=new this.MgrItem(this,B,A,D);this.list.push(C);return C;}else{return this.get(B);}},enable:function(A){var B=this.get(A);if(B){B.setValue("1");}},disable:function(A){var B=this.get(A);if(B){B.setValue("0");}}};}Otto.ACTIVE=true;if(!!window.wpMboxMgr){wpMboxMgr.add("blog_top",10);wpMboxMgr.add("global",0);wpMboxMgr.add("gog_restaurants_and_bars_profile_2011",100);}Otto.GLOBAL_ACTIVE=(typeof (Otto.GLOBAL_ACTIVE)=="undefined")?false:Otto.GLOBAL_ACTIVE;Otto.GLOBAL_MBOX_ACTIVE=Otto.GLOBAL_ACTIVE;Otto.NHP_ACTIVE=(typeof (Otto.NHP_ACTIVE)=="undefined")?false:Otto.NHP_ACTIVE;Otto.DEBUG=false;Otto.GLOBAL_TEST_ID="wp_global";Otto.DEFAULT_MBOX_CLASSNAME="mboxDefault";Otto.RENDER_DEFAULT_MBOX=true;Otto.SUPPRESS_DEFAULT_MBOX=false;Otto.ARTICLE_TOP_ID="wp_art_top";function Otto(){if(typeof Otto.instance=="undefined"){this.init=function(){this.setIsLoggedIn();this.setSection();this.setGlobalMboxActive();if(!Otto.GLOBAL_ACTIVE){this.addToTestsDeactivated(Otto.GLOBAL_TEST_ID);}this.setArticleTopActive();if(!Otto.ARTICLE_TOP_ACTIVE){this.addToTestsDeactivated(Otto.ARTICLE_TOP_ID);}Otto.instance=this;};this.setSection=function(){if(typeof thisNode!="undefined"){this.section=thisNode;}else{}return this.section;};this.getSection=function(){return this.section;};this.setGlobalMboxActive=function(){};this.setArticleTopActive=function(){var pathname=new String(location.pathname);if(!pathname.match(/\/wp-dyn\/content\/(article|blog|discussion)\//)){Otto.ARTICLE_TOP_ACTIVE=false;}};this.section="";this.isLoggedIn=false;this.setIsLoggedIn=function(){if(!this.loggedIn){if(typeof Registration=="function"){this.loggedIn=Registration.prototype.isSignedIn();}}if(!this.loggedIn){if(typeof getCookie=="function"){this.isLoggedIn=(getCookie("wpniuser"))?true:false;}else{this.isLoggedIn=document.cookie.indexOf("wpniuser")!=-1;}}if(!this.loggedIn){}};this.tests_already_run="";this.wasTestAlreadyRun=function(id){return((this.tests_already_run).indexOf(":"+id+":")!=-1);};this.addToTestsAlreadyRun=function(id){this.tests_already_run+=":"+id+":";this.tests_already_defined+=":"+id+":";};this.tests_already_defined="";this.wasTestAlreadyDefined=function(id){return((this.tests_already_defined).indexOf(":"+id+":")!=-1);};this.addToTestsAlreadyDefined=function(id){this.tests_already_defined+=":"+id+":";};this.tests_deactivated="";this.isTestDeactivated=function(id){return((this.tests_deactivated).indexOf(":"+id+":")!=-1);};this.addToTestsDeactivated=function(id){this.tests_deactivated+=":"+id+":";};this.tests_duplicated="";this.isTestDuplicated=function(id){return((this.tests_duplicated).indexOf(":"+id+":")!=-1);};this.addToTestsDuplicated=function(id){this.tests_duplicated+=":"+id+":";};this.placeOttoTest=function(test_id,render_default_mox){var debug="";if(Otto.ACTIVE){if(typeof render_default_mox=="undefined"){render_default_mox=Otto.RENDER_DEFAULT_MBOX;}if(!this.isTestDeactivated(test_id)&&!this.wasTestAlreadyRun(test_id)){if(typeof mboxCreate=="function"){var output="";
if(render_default_mox){output+='<div class="'+Otto.DEFAULT_MBOX_CLASSNAME+'"></div>';debug+=Otto.DEFAULT_MBOX_CLASSNAME+" got placed right here\n";}debug+="created mbox: "+test_id+".\n\n";mboxPrependBodyHTML(output);mboxCreate(test_id,"section="+this.section,"loggedin="+this.isLoggedIn);this.addToTestsAlreadyRun(test_id);}else{debug+="mboxCreate is not defined.\n\n";}}else{if(this.wasTestAlreadyRun(test_id)){this.addToTestsDuplicated(test_id);}}}this.debug+=debug;if(Otto.DEBUG){mboxPrependBodyHTML(debug);}};this.mboxCreate=this.placeOttoTest;this.placeGlobalOttoTest=function(){if(Otto.GLOBAL_ACTIVE){this.mboxCreate(Otto.GLOBAL_TEST_ID,Otto.RENDER_DEFAULT_MBOX);}};this.placeArticleTop=function(){if(Otto.ARTICLE_TOP_ACTIVE){this.mboxCreate(Otto.ARTICLE_TOP_ID,false);}};this.mboxDefine=function(css_id,test_id){var debug="";var args="";for(var i=0;i<arguments.length;i++){var arg=arguments[i];if(i>0){args+=",";}if(typeof arg=="string"){args+="'"+arg+"'";}else{args+=arg;}}if(!this.isTestDeactivated(test_id)&&!this.wasTestAlreadyDefined(test_id)){if(!document.getElementById(css_id)){var output="";output+='<div id="'+css_id+'"></div>';debug+="div with id "+css_id+" got placed right here.\n";mboxPrependBodyHTML(output);}else{debug+="div with id "+css_id+" already exists.\n";}var call_mboxDefine="mboxDefine(ARG_LIST).setFetcher( new mboxAjaxFetcher() )";call_mboxDefine=call_mboxDefine.replace(/ARG_LIST/,args);if(typeof mboxDefine=="function"){debug+="Calling mboxDefine("+args+").setFetcher( new mboxAjaxFetcher() ).\n\n";eval(call_mboxDefine);this.addToTestsAlreadyDefined(test_id);}}else{debug+="The test '"+test_id+"' is already defined so...\nmboxDefine("+args+").setFetcher( new mboxAjaxFetcher() ) will not be called.\n\n";}this.debug+=debug;if(Otto.DEBUG){alert(debug);}};this.mboxUpdate=function(test_id){var debug="";var args="";for(var i=0;i<arguments.length;i++){var arg=arguments[i];if(i>0){args+=",";}if(typeof arg=="string"){args+="'"+arg+"'";}else{args+=arg;}}if(this.wasTestAlreadyDefined(test_id)){var call_mboxUpdate="mboxUpdate(ARG_LIST)";call_mboxUpdate=call_mboxUpdate.replace(/ARG_LIST/,args);if(typeof mboxUpdate=="function"){debug+="Calling mboxUpdate("+args+").\n\n";eval(call_mboxUpdate);}}else{debug+="The test '"+test_id+"' does not exist so...\nmboxUpdate("+args+") cannot be called.\n\n";}this.debug+=debug;if(Otto.DEBUG){alert(debug);}};this.debug="";this.getInformation=function(){var output="";for(var active in Otto){if(active.match(/ACTIVE$/)){if(active=="GLOBAL_MBOX_ACTIVE"){output+="Otto.GLOBAL_MBOX_ACTIVE = Otto.GLOBAL_ACTIVE\n";}else{output+="Otto."+active+" = "+Otto[active]+"\n";}}}output+="\n";if(this.tests_already_run){output+="TESTS RUN:\n";output+=this.tests_already_run.replace(/::/g,", ").replace(/^:/,"").replace(/:$/,"");}else{output+="NO TESTS RUNNING";}output+="\n\n";if(this.tests_already_defined){output+="TESTS DEFINED:\n";output+=this.tests_already_defined.replace(/::/g,", ").replace(/^:/,"").replace(/:$/,"");}else{output+="NO TESTS DEFINED";}output+="\n\n";if(this.tests_deactivated){output+="TESTS DEACTIVATED:\n";output+=this.tests_deactivated.replace(/::/g,", ").replace(/^:/,"").replace(/:$/,"");}else{output+="NO TESTS DEACTIVATED";}output+="\n\n";if(this.tests_duplicated){output+="TESTS DUPLICATED (ok, but clean up your code):\n";output+=this.tests_duplicated.replace(/::/g,", ").replace(/^:/,"").replace(/:$/,"");}else{output+="NO TESTS DUPLICATED";}output+="\n\n";if(this.debug){output+="DEBUG:\n";output+=this.debug;output+="\n\n";}return output;};this.alertInformation=function(){alert(this.getInformation());};this.alertInfo=this.alertInformation;this.init();}else{return Otto.instance;}}Otto.getInstance=function(){if(Otto.instance==null){Otto.instance=new Otto();}return Otto.instance;};if(typeof otto=="undefined"){var otto=Otto.getInstance();}var PIGGY_BACK_ALREADY_CALLED=true;if(typeof otto=="undefined"){if(!window.TWP||!TWP.Constants||!TWP.Constants.AllowDocwrite||typeof TWP.Constants.AllowDocwrite.IN_PIGGYBACK=="undefined"||TWP.Constants.AllowDocwrite.IN_PIGGYBACK){document.write('<script src="http://media.washingtonpost.com/wp-srv/otto/js/mbox.js"><\/script>');document.write('<script src="http://media.washingtonpost.com/wp-srv/otto/js/Otto.js"><\/script>');}else{(function(){var A=function(B){var C=document.createElement("script");C.type="text/javascript";C.src=B;document.getElementsByTagName("head")[0].appendChild(C);};A("http://media.washingtonpost.com/wp-srv/otto/js/mbox.js");A("http://media.washingtonpost.com/wp-srv/otto/js/Otto.js");})();}}wpAds=(typeof wpAds!="undefined")?wpAds:{};wpAds.textlinks={"templates":{"CompoundStory":{"bt":{"lifestyle":[1511259,1900773,608,225],"entertainment":[1511259,1900773,608,225],"business":[1511256,1900771,608,225],"education":[1511253,1909768,608,225],"health":[1511250,1909769,608,225],"politics":[1511244,1900769,608,225],"sports":[1511238,1900772,608,225],"technology":[1511235,1909767,608,225],"news":[1511247,1900767,608,225],"ros":[1511241,1900770,608,225]},"rr":{"lifestyle":[1511208,1900773,320,250],"entertainment":[1511208,1900773,320,250],"business":[1511308,1900771,320,250],"education":[1511311,1909768,320,250],"health":[1511314,1909769,320,250],"politics":[1511323,1900769,320,250],"sports":[1511329,1900772,320,250],"technology":[1511332,1909767,320,250],"news":[1511320,1900767,320,250],"ros":[1511326,1900770,320,250],"local":[1540424,1900770,320,250]}},"front":{"rr":{"lifestyle":[1511262,1900773,320,250],"entertainment":[1511262,1900773,320,250],"business":[1511265,1900771,320,250],"education":[1511268,1909768,320,250],"health":[1511271,1909769,320,250],"politics":[1511277,1900769,320,250],"sports":[1511283,1900772,320,250],"technology":[1511286,1909767,320,250],"news":[1511274,1900767,320,250],"ros":[1511280,1900770,320,250],"washingtonpost.com":[1511317,1900768,320,250],"local":[1540430,1900770,320,250]}},"index2":{"rightrail":{"artsandliving":[1483528,1900773,336,230],"business":[1483543,1900771,336,230],"education":[1484199,1909768,336,230],"health":[1484196,1909769,336,230],"politics":[1483558,1900769,336,230],"sports":[1483588,1900772,336,230],"technology":[1484193,1909767,336,230],"news":[1483500,1900767,336,230],"ros":[1483573,1900770,336,230]}},"BlogStory":{"rr":{"lifestyle":[1512311,1900773,320,250],"entertainment":[1512311,1900773,320,250],"business":[1512314,1900771,320,250],"education":[1512332,1909768,320,250],"health":[1512329,1909769,320,250],"politics":[1512317,1900769,320,250],"sports":[1512323,1900772,320,250],"technology":[1512326,1909767,320,250],"news":[1512308,1900767,320,250],"ros":[1512320,1900770,320,250],"local":[1540427,1900770,320,250]},"in":{"lifestyle":[1512411,1900773,454,215],"entertainment":[1512411,1900773,454,215],"business":[1512414,1900771,454,215],"education":[1512432,1909768,454,215],"health":[1512429,1909769,454,215],"politics":[1512417,1900769,454,215],"sports":[1512423,1900772,454,215],"technology":[1512426,1909767,454,215],"news":[1512408,1900767,454,215],"ros":[1512420,1900770,454,215]}}},"cat_check":function(C){if(wpAds.textlinks.category[0][C]){return C;}var B=wpAds.textlinks.category,A=C.match(/\//)?B.length:1,E,D;while(A--){for(E in B[A]){D=B[A][E].length;while(D--){if(C.match(new RegExp("^"+B[A][E][D]+"(/|$)"))){return E;}}}}return"ros";},"article_check":function(){return((!urlCheck("_Comments.html"))&&(urlCheck("/wp-dyn/content/article/")||urlCheck("/wp-dyn/content/discussion/")))?true:false;},"index_check":function(){var A=["politics","opinion","business","technology"];var B=A.length;for(var C=0;C<B;C++){if(typeof commercialNode!="undefined"&&commercialNode.match(A[C])){return(commercialNode.match(A[C]+"/"))?false:"index";}}return"index2";},"blog_check":function(){return(urlCheck(/\/\d{4}\/\d{2}\/.*\.htm/gi))?"blog_permalink":"blog_main";},"category":[{"washingtonpost.com":["washingtonpost.com"],"artsandliving":["artsandliving","artsandlivingarticle","artsandleisure","artsandleisurearticle","dating","entertain","entertainarticle","entertainbestbets","entertainment","entertainmentarticle","food","foodarticle","market","pets","photo","photoarticle","shoplocal","shopping","shoppingNEW","shoppingUSED","style","stylearticle","tastepost","travel","traveldirectory","travel.sidestep","travelarticle","lifestyle","entertainment"],"news":["nation","nationarticle","news","world","worldarticle","religion","realestate","digest","digestarticle","fairfaxextra","liveonline","liveonlinearticle","localportal","metro","metroarticle","mostemailed","mostviewedarticles","opinion","opinionarticle","national"],"business":["business","allbusiness","businessarticle"],"education":["education"],"health":["health"],"politics":["politics","supertuesday","wiki"],"technology":["technology"],"sports":["sports","sportsarticle"],"local":["local"]},{"education":["local/education","national/higher-education"],"health":["politics/health_care","national/health"],"technology":["business/technology"]}],"init":function(B,A,D){var B=wpAds.textlinks.templates[B]?B:"CompoundStory";
var D=wpAds.textlinks.cat_check(D);var D=(typeof wpAds.textlinks.templates[B][A][D]=="undefined")?"ros":D;var C=B+"-"+A+"-"+D;wpAds.textlinks.exec(wpAds.textlinks.templates[B][A][D],C);},"exec":function(B,A){if(urlCheck("debugAdCode")){var A=A.split("-");document.write("template="+A[0]+";pos="+A[1]+";channel="+A[2]+";");}document.write("<s"+'cript type="text/javascript">adsonar_placementId='+B[0]+";adsonar_pid="+B[1]+";adsonar_ps="+(commercialNode.match(/^local/)?"0":"-1")+";adsonar_zw="+B[2]+";adsonar_zh="+B[3]+';adsonar_jv="ads.adsonar.com";</s'+"cript><s"+'cript type="text/javascript" src="http://js.adsonar.com/js/adsonar.js"></s'+"cript>");}};