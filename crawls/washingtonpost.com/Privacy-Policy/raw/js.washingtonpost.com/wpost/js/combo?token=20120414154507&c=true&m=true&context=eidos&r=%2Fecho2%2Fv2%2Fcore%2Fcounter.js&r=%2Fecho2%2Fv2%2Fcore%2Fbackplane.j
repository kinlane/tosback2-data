(function(A){if(typeof (A._$)!="undefined"){A.noConflict();}if(!window.Echo){window.Echo={};}if(!Echo.Global){Echo.Global={};}if(!Echo.Vars){Echo.Vars={"regexps":{"matchLabel":/{Label:([^:}]+[^}]*)}/g,"matchData":/{Data:(([a-z]+\.)*[a-z]+)}/ig,"mobileUA":/mobile|midp-|opera mini|iphone|ipad|blackberry|nokia|samsung|docomo|symbian|windows ce|windows phone|android|up\.browser|ipod|netfront|skyfire|palm|webos|audiovox/i,"parseUrl":/^((([^:\/\?#]+):)?\/\/)?([^\/\?#]*)?([^\?#]*)(\?([^#]*))?(#(.*))?/,"w3cdtf":/^(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d):(\d\d)Z$/}};}A.extend({"addCss":function(D,F){Echo.Vars.css=Echo.Vars.css||{"index":1,"processed":{}};if(F){if(Echo.Vars.css.processed[F]){return ;}Echo.Vars.css.processed[F]=true;}var C="";var B=Echo.Vars.css.anchor;if(B&&B.length){C=B.html();}if(C.length+D.length>100000){Echo.Vars.css.index++;B=null;C="";}var E=A('<style id="echo-css-'+Echo.Vars.css.index+'" type="text/css">'+C+D+"</style>");if(B&&B.length){B.replaceWith(E);}else{if(Echo.Vars.css.anchor){Echo.Vars.css.anchor.after(E);}else{A(document.getElementsByTagName("head")[0]||document.documentElement).prepend(E);}}Echo.Vars.css.anchor=E;},"foldl":function(C,B,D){A.each(B,function(E,F){result=D(F,C,E);if(result!==undefined){C=result;}});return C;},"intersperse":function(B,C){return A.foldl([],B,function(E,F,D){if(F.length){F.push(C);}F.push(E);});},"getNestedValue":function(B,F,G,H){if(typeof B=="string"){B=B.split(/\./);}if(!B.length){return F;}var E=true;var C=function(J,I){if(H){H(I,J);}if(typeof I[J]=="undefined"){E=false;}else{return I[J];}};var D=B.length==1?C(B.pop(),F):A.foldl(F,B,C);return E?D:G;},"setNestedValue":function(G,B,E){var C=B.split(/\./);var F=C.pop();var D=A.getNestedValue(C,G,undefined,function(I,H){if(typeof I[H]=="undefined"){I[H]={};}});D[F]=E;},"htmlize":function(B){if(!B){return"";}return A("<div>").text(B).html();},"object2JSON":function(F){var D=function(G){var H={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return G.replace(/[\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff\\]/g,function(I){return(H.hasOwnProperty(I))?H[I]:"\\u"+("0000"+I.charCodeAt(0).toString(16)).slice(-4);});};var C;switch(typeof F){case"number":C=isFinite(F)?F:"null";break;case"string":C='"'+D(F)+'"';break;case"boolean":C='"'+F.toString()+'"';break;default:if(F instanceof Array){var B=A.map(F,function(G){return A.object2JSON(G);});C="["+B.join(",")+"]";}else{if(F instanceof Object){var E=F.exportProperties||F;var B=A.foldl([],E,function(I,H,G){if(E instanceof Array){G=I;I=F[G];}H.push('"'+G+'":'+A.object2JSON(I));});C="{"+B.join(",")+"}";}else{C="null";}}}return C;},"htmlTextTruncate":function(N,E,M,G){if(!E||N.length<E){return N;}var P=[],I=0,H=0;var L="br hr input img area param base link meta option".split(" ");var C=A.foldl({},L,function(S,R,Q){R[S]=true;});for(var F=0;F<N.length;F++){var D=N.charAt(F);if(D=="<"){var K=N.indexOf(">",F);if(K<0){return N;}var B=N.substring(F+1,K);var O={"name":"","closing":false};if(B.charAt(0)=="/"){O.closing=true;B=B.substring(1);}O.name=B.match(/(\w)+/)[0];if(O.closing){var J=P.pop();if(!J||J.name!=O.name){return N;}}else{if(!C[O.name]){P.push(O);}}F=K;}else{if(D=="&"&&N.substring(F).match(/^(\S)+;/)){F=N.indexOf(";",F);}else{if(I==E){H=F;break;}I++;}}}if(H||G){if(H){N=N.substring(0,H)+(M||"");}for(var F=P.length-1;F>=0;F--){N+="</"+P[F].name+">";}}return N;},"mapClass2Object":function(C,B){B=B||{};C.find("*").andSelf().each(function(E,F){if(F.className){var D=F.className.split(/[ ]+/);A.each(D,function(G,H){B[H]=F;});}});return B;},"stripTags":function(B){return A("<div>").html(B).text();},"parseUrl":function(B){var C=B.match(Echo.Vars.regexps.parseUrl);return C?{"scheme":C[3],"domain":C[4],"path":C[5],"query":C[7],"fragment":C[9]}:undefined;},"toDOM":function(C,G,F){var D=A(C);var E=A.mapClass2Object(D);var H={"set":function(I,J){E[G+I]=J;},"get":function(I,K){var J=E[(K?"":G)+I];return J&&A(J);},"remove":function(J){var I;if(typeof J=="string"){I=G+J;}else{I=J.echo.name;}A(E[I]).remove();delete E[I];},"content":D};var B;if(typeof F=="object"){B=function(I,J,K){if(!F[I]){return ;}return F[I](J,K);};}else{B=F;}A.each(E,function(M,J){var L=M.match(G+"(.*)");var I=L?L[1]:undefined;if(I&&B){J=A(J);J.echo=J.echo||{};J.echo.name=M;var K=B(I,J,H);if(typeof K!="undefined"){J.empty().append(K);}}});return H;},"loadScriptContent":function(D,F){Echo.Vars.scriptState=Echo.Vars.scriptState||{};if(Echo.Vars.scriptState[D]=="loaded"){F();return ;}var E=Echo.Broadcast.subscribe("internal.scriptLoaded",function(G,H){if(D!=H){return ;}Echo.Broadcast.unsubscribe("internal.scriptLoaded",E);F();});if(Echo.Vars.scriptState[D]=="loading"){return ;}Echo.Vars.scriptState[D]="loading";var C=document.createElement("script");C.type="text/javascript";C.charset="utf-8";C.src=D;var B=document.getElementsByTagName("head")[0]||document.documentElement;B.insertBefore(C,B.firstChild);C.onload=C.onreadystatechange=function(){var G=C.readyState;if(!G||G=="loaded"||G=="complete"){Echo.Vars.scriptState[D]="loaded";Echo.Broadcast.publish("internal.scriptLoaded",D);C.onload=C.onreadystatechange=null;}};},"sendPostRequest":function(C,E,G){var F="echo-post-"+Math.random();var B=A("#echo-post-request").length?A("#echo-post-request").empty():A('<div id="echo-post-request"/>').css({"height":0}).prependTo("body");A('<iframe id="'+F+'" name="'+F+'" width="0" height="0" frameborder="0" border="0"></iframe>').appendTo(B);var D=A("<form/>",{"target":F,"method":"POST","enctype":"application/x-www-form-urlencoded","acceptCharset":"UTF-8","action":C}).appendTo(B);A.each(E,function(H,I){A("<input/>",{"type":"hidden","name":H,"value":I}).appendTo(D);});D.submit();G();},"getVisibleColor":function(C){var B;do{B=C.css("backgroundColor");if(B!=""&&B!="transparent"&&!/rgba\(0, 0, 0, 0\)/.test(B)||A.nodeName(C.get(0),"body")){break;}}while(C=C.parent());return B||"transparent";},"timestampFromW3CDTF":function(B){var E=["year","month","day","hours","minutes","seconds"];var C={};var D=B.match(Echo.Vars.regexps.w3cdtf);A.each(E,function(F,G){C[G]=D[F+1];});return Date.UTC(C["year"],C["month"]-1,C["day"],C["hours"],C["minutes"],C["seconds"])/1000;},"isMobileDevice":function(){return Echo.Vars.regexps.mobileUA.test(navigator.userAgent);}});if(!Echo.Plugins){Echo.Plugins={};}Echo.isExtended=function(B,D,C){if(!B){return false;}C=C||true;var E=[B].concat(D).join(".");Echo.Vars.extensions=Echo.Vars.extensions||{};if(Echo.Vars.extensions[E]==C){return true;}Echo.Vars.extensions[E]=C;return false;};Echo.extendRenderer=function(B,F,D,C){if(!B||!Echo[B]||!F||!D||!A.isFunction(D)||Echo.isExtended(C,[B,"renderer",F])){return ;}var E=Echo[B].prototype.renderers[F]||function(){};Echo[B].prototype.renderers[F]=function(){var H=C&&this.config.get("plugins."+C);if(!H||!H.enabled){return E.apply(this,arguments);}var G=this;if(!this.parentRenderer){this.parentRenderer=function(J,I){return G.parentRenderers[J].apply(G,I);};}this.parentRenderers=this.parentRenderers||{};this.parentRenderers[F]=E;return D.apply(this,arguments);};};Echo.extendTemplate=function(C,E,I,B,H){if(!C||!Echo[C]||!I||!B||!E||Echo.isExtended(H,[C,"template",B,I],E)){return ;}var G=Echo[C].prototype.template;var F=A.isFunction(G)?G:function(){return G;};var D={"insertBefore":"before","insertAfter":"after","insertAsFirstChild":"prepend","insertAsLastChild":"append","replace":"replaceWith"};Echo[C].prototype.template=function(){var J=H&&this.config.get("plugins."+H);if(!J||!J.enabled){return F.call(this);}var K=A("<div/>").html(F.call(this));A("."+B,K)[D[I]](E);return K.html();};};Echo.include=function(B,D){if(!B.length){return D();}var C=B.pop();Echo.include(B,function(){if(typeof C.loaded=="undefined"){if(C.application){C.loaded=function(){return !!Echo[C.application];};}else{D();}}if(A.isFunction(C.loaded)&&!C.loaded()){A.loadScriptContent(C.url,D);}else{D();}});};Echo.createPlugin=function(C){if(!C||!C.name||!C.init||!C.applications){return{};
}var B=C.name;var E=function(){var F=function(G){return"plugins."+B+(G?"."+G:"");};F.get=function(G,H,I,J){return G.config.get(F(H),J?G.config.get(H,I):I);};F.set=function(G,H,I){G.config.set(F(H),I);};F.remove=function(G,H){G.config.remove(F(H));};return F;};var D=C.init||function(){};Echo.Plugins[B]=Echo.Plugins[B]||A.extend(C,{"init":function(H,G){var F=H.config.get(G,"enabled");if(typeof F=="undefined"){H.config.set(G,"enabled",true);}D(H,G);},"set":function(F,G,H){F.vars=F.vars||{};F.vars[B]=F.vars[B]||{};A.setNestedValue(F.vars[B],G,H);},"get":function(F,G){var H=(F.vars||{})[B]||{};if(!G){return H;}return A.getNestedValue(G,H);},"addCss":function(F){A.addCss(F,"plugins-"+B);},"label":function(F,G){return Echo.Localization.label(F,"Plugins."+B,G);},"addLabels":function(F){Echo.Localization.extend(F,"Plugins."+B);},"topic":function(H,G){var F=typeof H=="string"?H:H.namespace;return F+".Plugins."+B+"."+G;},"config":E(),"subscribe":function(H,G,I){var F=this;return H.subscribe(G,function(){if(!H.isPluginEnabled(F.name)){return ;}I.apply(this,arguments);});},"publish":function(G,F,H){G.publish(F,H);},"unsubscribe":function(G,F,H){G.unsubscribe(F,H);},"extendRenderer":function(F,H,G){Echo.extendRenderer(F,H,G,B);},"extendTemplate":function(G,H,I,F){Echo.extendTemplate(G,H,I,F,B);},"addItemControl":function(G,H){var F=G.config.get("itemControls."+B,[]);G.config.set("itemControls."+B,F.concat(H));},"assembleConfig":function(F,G){G.user=F.user;G.appkey=F.config.get("appkey","");G.plugins=this.config.get(F,"nestedPlugins",[]);G.contextId=F.config.get("contextId");G.apiBaseURL=F.config.get("apiBaseURL");return(new Echo.Config(G,this.config.get(F))).getAsHash();}});return Echo.Plugins[B];};if(!Echo.Broadcast){Echo.Broadcast={};}Echo.Broadcast.initContext=function(C,B){B=B||"empty";Echo.Vars.subscriptions=Echo.Vars.subscriptions||{};Echo.Vars.subscriptions[B]=Echo.Vars.subscriptions[B]||{};Echo.Vars.subscriptions[B][C]=Echo.Vars.subscriptions[B][C]||{};return B;};Echo.Broadcast.subscribe=function(C,D,B){var E=(new Date()).valueOf()+Math.random();B=Echo.Broadcast.initContext(C,B);Echo.Vars.subscriptions[B][C][E]=D;return E;};Echo.Broadcast.unsubscribe=function(C,D,B){B=Echo.Broadcast.initContext(C,B);if(C&&D){delete Echo.Vars.subscriptions[B][C][D];}else{if(C){delete Echo.Vars.subscriptions[B][C];}}};Echo.Broadcast.publish=function(C,D,B){B=Echo.Broadcast.initContext(C,B);if(B=="*"){A.each(Echo.Vars.subscriptions,function(E){A.each(Echo.Vars.subscriptions[E][C]||{},function(G,F){F.apply(this,[C,D]);});});}else{if(Echo.Vars.subscriptions[B][C]){A.each(Echo.Vars.subscriptions[B][C],function(F,E){E.apply(this,[C,D]);});}if(B!="empty"){Echo.Broadcast.publish(C,D,"empty");}}};if(!Echo.Object){Echo.Object=function(){};}Echo.Object.prototype.init=function(B){A.extend(this,B||{});};Echo.Object.prototype.template="";Echo.Object.prototype.namespace="";Echo.Object.prototype.cssPrefix="echo-";Echo.Object.prototype.substitute=function(C,D){var B=this;C=C.replace(Echo.Vars.regexps.matchLabel,function(F,E){return B.label(E);});C=C.replace(Echo.Vars.regexps.matchData,function(F,E){return A.getNestedValue(E,D,"");});return C;};Echo.Object.prototype.renderers={};Echo.Object.prototype.label=function(C,D){var B=Echo.Localization.label(C,this.namespace,D);return B!=C?B:Echo.Localization.label(C,"",D);};Echo.Object.prototype.render=function(D,E,G,B){var C=this;if(D){if(A.isFunction(this.renderers[D])){return this.renderers[D].call(this,E,G,B);}}else{var F=A.isFunction(this.template)?this.template():this.template;this.dom=A.toDOM(this.substitute(F,this.data||{}),this.cssPrefix,function(){return C.render.apply(C,arguments);});return this.dom.content;}};Echo.Object.prototype.rerender=function(B,D){var J=this;if(!B){if(this.dom){this.dom.content.replaceWith(this.render());}return ;}if(!this.dom){return ;}if(typeof B!="string"){A.map(B,function(K){J.rerender(K,D);});return ;}else{if(!this.dom.get(B)){return ;}}if(D){var I=A.isFunction(this.template)?this.template():this.template;var G=this.substitute(I,this.data||{});var E=this.dom.get(B);var H=A("."+this.cssPrefix+B,A(G));H=A.toDOM(H,this.cssPrefix,function(K,L,M){J.dom.set(K,L);return J.render.apply(J,arguments);}).content;E.replaceWith(H);}else{var F=this.dom.get(B);var C=this.renderers[B].call(this,F,this.dom);if(typeof C!="undefined"){F.empty().append(C);}}};Echo.Object.prototype.hyperlink=function(E,D){D=D||{};if(D.openInNewWindow&&!E.target){E.target="_blank";}var C=E.caption||"";delete E.caption;if(!D.skipEscaping){E.href=A.htmlize(E.href);}E.href=E.href||"javascript:void(0)";var B=A.foldl([],E,function(H,G,F){G.push(F+'="'+H+'"');});return"<a "+B.join(" ")+">"+C+"</a>";};Echo.Object.prototype.newContextId=function(){return(new Date()).valueOf()+Math.random();};Echo.Object.prototype.getContextId=function(){return this.config&&this.config.get("contextId");};Echo.Object.prototype.subscribe=function(B,C){return Echo.Broadcast.subscribe(B,C,this.getContextId());};Echo.Object.prototype.unsubscribe=function(B,C){Echo.Broadcast.unsubscribe(B,C,this.getContextId());};Echo.Object.prototype.publish=function(B,C){Echo.Broadcast.publish(B,C,this.getContextId());};Echo.Object.prototype.clearCache=function(){if(this.vars&&this.vars.cache){this.vars.cache={};}};Echo.User=function(B){this.data={};this.config=new Echo.Config(B,{"appkey":"","apiBaseURL":"http://api.echoenabled.com","contextId":undefined});};Echo.User.prototype.init=function(E){var B=this;this.callback=E||function(){};if(!this.config.get("appkey")||!window.Backplane||!Backplane.getChannelID()){this.set({});this.callback();return ;}this.listenEvents();var D=this._global("get","state");if(D=="ready"){this.set(A.extend({},this._global("get","data")));this.callback();}else{var C=Echo.Broadcast.subscribe("User.onInit",function(F,G){if(G.appkey!=B.config.get("appkey")){return ;}Echo.Broadcast.unsubscribe("User.onInit",C);B.set(A.extend({},B._global("get","data")));B.callback();});if(D=="init"){this.request();}}};Echo.User.prototype.listenEvents=function(){var B=this;if(this.backplaneSubscriptionID){return ;}var C=function(F){var E=(F?"":"internal.")+"User.onInvalidate";var G={"data":B.data,"appkey":B.config.get("appkey")};var D=F?undefined:B.config.get("contextId");Echo.Broadcast.publish(E,G,D);};this.backplaneSubscriptionID=Backplane.subscribe(function(E){if(E.type=="identity/ack"){var D=false;if(B._global("get","state")=="ready"){D=true;B._global("set","state","init");}B.init(function(){C();if(D){C(true);}});}});};Echo.User.prototype._global=function(E,C,D){var B=this.config.get("appkey");Echo.Vars.users=Echo.Vars.users||{};Echo.Vars.users[B]=Echo.Vars.users[B]||{"state":"init","data":{}};if(E=="get"){return Echo.Vars.users[B][C];}Echo.Vars.users[B][C]=D;};Echo.User.prototype.set=function(){if(!arguments.length){return ;}if(arguments.length==1&&typeof arguments[0]=="object"){this._global("set","data",arguments[0]);this.data=this.normalize(arguments[0]);this.account=this.assemble();}else{if(arguments.length==2&&typeof arguments[0]=="string"){this.account[arguments[0]]=arguments[1];}}};Echo.User.prototype.get=function(B,C){return(this.account.hasOwnProperty(B)&&typeof this.account[B]!="undefined")?this.account[B]:C;};Echo.User.prototype.logout=function(C){var B=this;A.get(window.location.protocol+"//apps.echoenabled.com/v2/logout",{"sessionID":Backplane.getChannelID()},function(D){Backplane.expectMessages("identity/ack");},"jsonp");};Echo.User.prototype.request=function(D){var B=this,C=this.config.get("appkey");this._global("set","state","waiting");A.get(this.config.get("apiBaseURL")+"/v1/users/whoami",{"appkey":C,"sessionID":Backplane.getChannelID()},function(E){if(E.result&&E.result=="session_not_found"){E={};}B._global("set","state","ready");B.set(A.extend({},E));Echo.Broadcast.publish("User.onInit",{"data":E,"appkey":C});if(D){D();}},"jsonp");};Echo.User.prototype.normalize=function(C){var B=function(D){return A.foldl({},D||[],function(E,F){F[E]=true;});};C=C||{};C.echo=C.echo||{};
A.extend(C,C.echo);C.poco=C.poco||{"entry":{}};C.roles=B(C.echo.roles);C.markers=B(C.echo.markers);C.sessionID=window.Backplane&&Backplane.getChannelID()||undefined;C.accounts=C.poco.entry.accounts||[];return C;};Echo.User.prototype.getActiveAccounts=function(){return A.map(this.data.accounts,function(B){if(B.loggedIn=="true"){return B;}});};Echo.User.prototype.assemble=function(){var B=this.getActiveAccounts();var C=B[0]||{};return A.extend(this.data,{"id":C.identityUrl||this.data.poco.entry.id||C.userid,"name":this.data.poco.entry.displayName||C.username,"avatar":A.foldl(undefined,C.photos||[],function(D){if(D.type=="avatar"){return D.value;}}),"state":this.data.echo.state||"Untouched","domain":C.domain,"logged":!!B.length,"defaultAvatar":"//www.washingtonpost.com/rw/sites/twpweb/img/echo2/core/avatar-default.png","fakeIdentityURL":"http://js-kit.com/ECHO/user/fake_user"});};Echo.User.prototype.hasIdentity=function(C){var B=false;A.each(this.data.accounts,function(D,E){if(E.identityUrl&&E.identityUrl==C){B=true;return false;}});return B;};Echo.User.prototype.hasAny=function(E,C){if(!this.account){return false;}var B=this,D=false;A.each(C,function(F,H){var G=B.get(E,{});if((typeof G=="string"&&G==H)||G[H]){D=true;return false;}});return D;};Echo.User.prototype.hasAnyRole=function(B){return this.hasAny("roles",B);};Echo.User.prototype.isAdmin=function(){return this.hasAny("roles",["administrator","moderator"]);};Echo.User.prototype.logged=function(){return !!(this.account&&this.account.logged);};Echo.Application=function(){this.addCss();};Echo.Application.prototype=new Echo.Object();Echo.Application.prototype.errorMessages={"error_busy":"Loading. Please wait...","error_timeout":"Loading. Please wait...","error_waiting":"Loading. Please wait...","error_result_too_large":"(result_too_large) The search result is too large.","error_wrong_query":"(wrong_query) Incorrect or missing query parameter.","error_incorrect_appkey":"(incorrect_appkey) Incorrect or missing appkey.","error_internal_error":"(internal_error) Unknown server error.","error_quota_exceeded":"(quota_exceeded) Required more quota than is available.","error_incorrect_user_id":"(incorrect_user_id) Incorrect user specified in User ID predicate.","error_unknown":"(unknown) Unknown error."};Echo.Application.prototype.initApplication=function(D){var B=this;var C=this.config.get("appkey");if(!C){this.showMessage({"type":"error","message":"Incorrect or missing mandatory parameter appkey"});return ;}this.config.get("target").addClass("echo-ui");this.user=this.config.get("user")||new Echo.User({"appkey":C,"apiBaseURL":this.config.get("apiBaseURL"),"contextId":this.config.get("contextId")});this.user.init(function(){B.initPlugins(D);});Echo.Localization.extend(this.errorMessages);};Echo.Application.prototype.messageTemplates={"compact":'<span class="echo-application-message-icon echo-application-message-{Data:type}" title="{Data:message}">'+"</span>","default":'<div class="echo-application-message">'+'<span class="echo-application-message-icon echo-application-message-{Data:type} echo-primaryFont">'+"{Data:message}"+"</span>"+"</div>"};Echo.Application.prototype.showMessage=function(C,D){if(!this.config.get("debug")&&C.type=="error"){return ;}var B=this.messageTemplates[C.layout||this.messageLayout||"default"];(D||this.config.get("target")).empty().append(this.substitute(B,C));};Echo.Application.prototype.isWaitingForData=function(B){return B&&(B.errorCode=="waiting"||B.errorCode=="timeout"||B.errorCode=="busy");};Echo.Application.prototype.handleErrorResponse=function(G,D){var B=this;D=D||{};var H=this.config.get("target");var E=function(){if(B.waitingTimeoutStep>0){if(B.waitingTimeoutStep<4){B.waitingTimeoutStep++;}}else{B.waitingTimeoutStep=1;}return Math.round(Math.exp(B.waitingTimeoutStep))*1000;};if(this.error!=G){if(!this.config.get("debug")){H.hide();}else{var C=this.label("error_"+G.errorCode);var F=C=="error_"+G.errorCode?"("+G.errorCode+") "+(G.errorMessage||""):C;H.show();this.showMessage({"type":this.isWaitingForData(G)?"loading":"error","message":F},D.messageTarget);}}this.error=G;if(this.isWaitingForData(G)){this.waitingTimer=setTimeout(function(){B.cleanupErrorHandlers();if(D.waitingHandler){D.waitingHandler();}else{B.refresh();}},E());}else{this.waitingTimeoutStep=0;}if(D.callback){D.callback(G);}};Echo.Application.prototype.cleanupErrorHandlers=function(B){if(B){this.waitingTimeoutStep=0;delete this.error;}if(this.waitingTimer){clearTimeout(this.waitingTimer);}};Echo.Application.prototype.initPlugins=function(E){var D=this;var C=this.config.get("pluginsOrder");var B=A.foldl([],C,function(F,H){var G=Echo.Plugins[F];if(G&&G.dependencies&&G.dependencies.length){return H.concat(G.dependencies);}});Echo.include(B,function(){A.map(C,function(F){var G=Echo.Plugins[F];if(G&&G.init&&D.isPluginApplicable(G)){G.init(G,D);}});if(E){E();}});};Echo.Application.prototype.enablePlugin=function(B){this.config.set("plugins."+B+".enabled",true);};Echo.Application.prototype.disablePlugin=function(B){this.config.set("plugins."+B+".enabled",false);};Echo.Application.prototype.isPluginEnabled=function(B){return this.config.get("plugins."+B+".enabled",true);};Echo.Application.prototype.isPluginApplicable=function(D){var C=this,B=false;A.each(D.applications,function(F,E){if(Echo[E]&&C instanceof Echo[E]){B=true;return false;}});return B;};Echo.Application.prototype.initConfig=function(D,E,C){var B={};B.target=function(F){return A(F);};B.plugins=function(G){var F=A.foldl({"hash":{},"order":[]},G||[],function(H,I){var J=A.inArray(H.name,I.order);if(J>=0){I.order.splice(J,1);}I.order.push(H.name);I.hash[H.name]=H;});this.set("pluginsOrder",F.order);return F.hash;};D=A.extend({"plugins":[]},D||{});E=A.extend({"appkey":"","apiBaseURL":"http://api.echoenabled.com","liveUpdates":true,"liveUpdatesTimeout":10,"liveUpdatesTimeoutMin":3,"debug":true,"contextId":this.newContextId()},E||{});this.config=new Echo.Config(D,E,function(F,H){var G=C&&C[F]||B&&B[F];return G?G.call(this,H):H;});};Echo.Application.prototype.sendAPIRequest=function(B,C){B.query.appkey=this.config.get("appkey");A.get(this.config.get("apiBaseURL")+"/v1/"+B.endpoint,B.query,C,"jsonp");};Echo.Application.prototype.initLiveUpdates=function(D,B){var C=this;this.liveUpdates={"originalTimeout":this.config.get("liveUpdatesTimeout"),"timers":{},"timeouts":[],"responseHandler":function(E){if(C.liveUpdates.timers.watchdog){clearTimeout(C.liveUpdates.timers.watchdog);}C.changeLiveUpdatesTimeout(E);B(E);},"requestParamsGetter":D};};Echo.Application.prototype.changeLiveUpdatesTimeout=function(H){var D=this;if(typeof H=="string"){H={"liveUpdatesTimeout":H};}H.liveUpdatesTimeout=parseInt(H.liveUpdatesTimeout);var C=function(J){if(!J&&D.liveUpdates.originalTimeout!=D.config.get("liveUpdatesTimeout")){D.config.set("liveUpdatesTimeout",D.liveUpdates.originalTimeout);}else{if(J&&J>D.config.get("liveUpdatesTimeout")){D.config.set("liveUpdatesTimeout",J);}}};var B=function(J){return !!(J.entries&&J.entries.length);};if(!this.nextSince){C(H.liveUpdatesTimeout);return ;}var F=this.config.get("liveUpdatesTimeout");var I=parseInt(this.nextSince);var E=Math.floor((new Date()).getTime()/1000);var G=B(H)?E-I>F?this.config.get("liveUpdatesTimeoutMin",3):F+1:F+2;if(G>this.liveUpdates.originalTimeout){G=this.liveUpdates.originalTimeout;}this.config.set("liveUpdatesTimeout",G);if(G==this.liveUpdates.originalTimeout){C(H.liveUpdatesTimeout);}};Echo.Application.prototype.stopLiveUpdates=function(){if(this.liveUpdates.timers.regular){clearTimeout(this.liveUpdates.timers.regular);}if(this.liveUpdates.timers.watchdog){clearTimeout(this.liveUpdates.timers.watchdog);}};Echo.Application.prototype.startLiveUpdates=function(D){var B=this;if(!this.liveUpdates||!D&&!this.config.get("liveUpdates")&&!this.liveUpdates.timeouts.length){return ;}this.stopLiveUpdates();if(D){this.liveUpdates.timeouts=[0,1,3];}var C=this.liveUpdates.timeouts.length?this.liveUpdates.timeouts.shift():this.config.get("liveUpdatesTimeout");
this.liveUpdates.timers.regular=setTimeout(function(){B.liveUpdates.timers.watchdog=setTimeout(function(){B.startLiveUpdates();},5000);B.sendAPIRequest(B.liveUpdates.requestParamsGetter(),B.liveUpdates.responseHandler);},C*1000);};Echo.Application.prototype.addCss=function(){var C="echo-css-fancybox";if(A("#"+C).length){return ;}var B=document.getElementsByTagName("head")[0]||document.documentElement;B.insertBefore(A("<link>",{"rel":"stylesheet","id":C,"type":"text/css","href":"//www.washingtonpost.com/rw/sites/twpweb/css/echo2/core/fancybox.css"}).get(0),A(B).children().get(0));A.addCss(".echo-application-message { padding: 15px 0px; text-align: center; -moz-border-radius: 0.5em; -webkit-border-radius: 0.5em; border: 1px solid #E4E4E4; }"+".echo-application-message-icon { display: inline-block; height: 16px; padding-left: 16px; background: no-repeat left center; }"+".echo-application-message .echo-application-message-icon { padding-left: 21px; height: auto; }"+".echo-application-message-empty { background-image: url(//www.washingtonpost.com/rw/sites/twpweb/img/echo2/core/information.png); }"+".echo-application-message-loading { background-image: url(//www.washingtonpost.com/rw/sites/twpweb/img/echo2/core/loading.gif); }"+".echo-application-message-error { background-image: url(//www.washingtonpost.com/rw/sites/twpweb/img/echo2/core/warning.gif); }","application");};Echo.Config=function(E,C,D){var B=this;this.normalize=D||function(F,G){return G;};this.data={};this.cache={};if(!C&&!D){this.data=E;}else{A.each(this.combine(E,A.extend({},C)),function(F,G){B.set(F,G);});}};Echo.Config.prototype.get=function(C,D){var B=C;if(typeof B!="string"){B=B.join(".");}if(!this.cache.hasOwnProperty(B)){this.cache[B]=A.getNestedValue(C,this.data);}return typeof this.cache[B]=="undefined"?D:this.cache[B];};Echo.Config.prototype.set=function(B,D){var C=B.split(/\./);delete this.cache[B];if(typeof D=="object"){this.clearCacheByPrefix(B);}return A.setNestedValue(this.data,B,this.normalize(C.pop(),D));};Echo.Config.prototype.remove=function(B){var C=B.split(/\./);var E=C.pop();var D=A.getNestedValue(C,this.data);delete D[E];};Echo.Config.prototype.combine=function(D,C){var B=this;return A.foldl(C,D,function(G,F,E){F[E]=A.isPlainObject(G)&&C.hasOwnProperty(E)?B.combine(G,C[E]):G;});};Echo.Config.prototype.extend=function(B){var C=this;A.each(B,function(D,E){C.set(D,E);});};Echo.Config.prototype.getAsHash=function(){return this.data;};Echo.Config.prototype.clearCacheByPrefix=function(C){var B=this;C+=".";A.each(this.cache,function(D,E){if(!D.indexOf(C)){delete B.cache[D];}});};if(!Echo.Localization){Echo.Localization={labels:{}};}Echo.Localization.key=function(B,C){return(C?C+".":"")+B;};Echo.Localization.extend=function(C,B){A.each(C,function(D,E){Echo.Localization.labels[Echo.Localization.key(D,B)]=E;});};Echo.Localization.label=function(C,D,E){var B=Echo.Localization.labels[Echo.Localization.key(C,D)]||C;A.each(E||{},function(F,G){B=B.replace(new RegExp("{"+F+"}","g"),G);});return B;};})(jQuery);(function(A){Echo.Counter=function(C){if(!C||!C.target){return ;}var B=this;this.vars={};this.data={};this.initConfig(C,{"debug":false});this.messageLayout="compact";this.initApplication(function(){B.contextId=B.newContextId();B.showMessage({"type":"loading"});B.initLiveUpdates(function(){return{"endpoint":"count","query":{"q":B.config.get("query","")}};},function(D){B.handleResponse(D);});if(B.config.get("data")){B.handleResponse(B.config.get("data"));}else{B.request();}B.listenEvents();});};Echo.Counter.prototype=new Echo.Application();Echo.Counter.prototype.namespace="Counter";Echo.Counter.prototype.request=function(){var B=this;this.sendAPIRequest({"endpoint":"count","query":{"q":B.config.get("query","")}},function(C){B.handleResponse(C);});};Echo.Counter.prototype.refresh=function(){this.stopLiveUpdates();this.data={};this.showMessage({"type":"loading"});this.request();};Echo.Counter.prototype.listenEvents=function(){var B=this;A.map(["Submit.onPostComplete","Submit.onEditComplete"],function(C){Echo.Broadcast.subscribe(C,function(){B.startLiveUpdates(true);});});};Echo.Counter.prototype.handleResponse=function(C){var B=this;var D=this.config.get("target");C=C||{};if(C.result=="error"&&C.errorCode!="more_than"){this.handleErrorResponse(C);return ;}this.cleanupErrorHandlers(true);D.show();D.html(C.errorCode=="more_than"?(C.errorMessage+"+"):C.count);if(A.isEmptyObject(this.data)||this.data.count!=C.count){this.publish("Counter.onUpdate",{"data":C,"query":this.config.get("query",""),"target":this.config.get("target").get(0)});}this.data=C;this.startLiveUpdates();};})(jQuery);window.Backplane=window.Backplane||{"channelByBus":{},"config":{},"initialized":false,"subscribers":{},"awaiting":{"since":0,"until":0,"queue":[]},"intervals":{"min":1,"frequent":5,"regular":60,"slowdown":120}};Backplane.init=function(A){A=A||{};if(this.initialized||!A.serverBaseURL||!A.busName){return false;}this.initialized=true;this.timers={};this.config=A;this.channelByBus=this.getCookieChannels();this.config.customChannelName=A.channelName;this.config.channelName=this.getChannelName();this.config.serverBaseURL=this.normalizeURL(A.serverBaseURL);this.config.channelID=this.generateChannelID();this.request();return true;};Backplane.subscribe=function(B){if(!this.initialized){return false;}var A=(new Date()).valueOf()+Math.random();this.subscribers[A]=B;return A;};Backplane.unsubscribe=function(A){if(!this.initialized||!A){return false;}delete this.subscribers[A];};Backplane.getChannelID=function(){if(!this.initialized){return false;}return this.config.channelID;};Backplane.expectMessages=function(A){this.expectMessagesWithin(60,A);};Backplane.expectMessagesWithin=function(A,B){if(!this.initialized||!A){return false;}this.awaiting.since=this.getTS();this.awaiting.interval=A;this.awaiting.nonstop=!B;if(B){B=typeof B=="string"?[B]:B;this.awaiting.queue.push(B);}var C=this.awaiting.since+A;if(C>this.awaiting.until){this.awaiting.until=C;}this.request();};Backplane.generateChannelID=function(){return this.config.serverBaseURL+"/bus/"+this.config.busName+"/channel/"+this.config.channelName;};Backplane.getChannelName=function(){if(!this.initialized){return false;}if(this.config.customChannelName){return this.config.customChannelName;}if(!this.channelByBus[this.config.busName]){this.channelByBus[this.config.busName]=(new Date()).valueOf().toString()+Math.random().toString().substr(2,5);this.setCookieChannels();}return this.channelByBus[this.config.busName];};Backplane.getTS=function(){return Math.round((new Date()).valueOf()/1000);};Backplane.getCookieChannels=function(){var C=(document.cookie||"").match(/backplane-channel=(.*?)(?:$|;)/);if(!C||!C[1]){return{};}var B={};var E=C[1].split("|");for(var D=0;D<E.length;D++){var A=E[D].split(":");B[decodeURIComponent(A[0])]=decodeURIComponent(A[1]);}return B;};Backplane.setCookieChannels=function(){var B=[];for(var A in this.channelByBus){if(this.channelByBus.hasOwnProperty(A)){B.push(encodeURIComponent(A)+":"+encodeURIComponent(this.channelByBus[A]));}}var C=new Date();C.setFullYear(C.getFullYear()+5);document.cookie="backplane-channel="+B.join("|")+";expires="+C.toGMTString()+";path=/";};Backplane.resetCookieChannel=function(){delete this.channelByBus[this.config.busName];this.setCookieChannels();this.config.channelName=this.getChannelName();this.config.channelID=this.generateChannelID();};Backplane.normalizeURL=function(A){return A.replace(/^\s*(https?:\/\/)?(.*?)[\s\/]*$/,function(B,D,C){return(D||window.location.protocol+"//")+C;});};Backplane.calcTimeout=function(){var D,B=this.getTS();if(B<this.awaiting.until){if(!this.awaiting.nonstop&&!this.awaiting.queue.length){this.awaiting.until=B;return this.calcTimeout();}var C=B-this.awaiting.since;var A=this.intervals.frequent-this.intervals.min;D=this.intervals.min+Math.round(A*C/this.awaiting.interval);}else{if(B<this.awaiting.until+this.intervals.slowdown){var C=B-this.awaiting.until;var A=this.intervals.regular-this.intervals.frequent;
D=this.intervals.frequent+Math.round(A*C/this.intervals.slowdown);}else{D=typeof this.since=="undefined"?0:this.intervals.regular;this.awaiting.nonstop=false;}}return D*1000;};Backplane.request=function(){var A=this;if(!this.initialized){return false;}this.stopTimer("regular");this.stopTimer("watchdog");this.timers.regular=setTimeout(function(){A.timers.watchdog=setTimeout(function(){A.request();},5000);var C=document.createElement("script");C.type="text/javascript";C.charset="utf-8";C.src=A.config.channelID+"?callback=Backplane.response"+(A.since?"&since="+encodeURIComponent(A.since):"")+"&rnd="+Math.random();var B=document.getElementsByTagName("head")[0]||document.documentElement;B.insertBefore(C,B.firstChild);C.onload=C.onreadystatechange=function(){var D=C.readyState;if(!D||D==="loaded"||D==="complete"){C.onload=C.onreadystatechange=null;if(C.parentNode){C.parentNode.removeChild(C);}}};},this.calcTimeout());};Backplane.response=function(D){var I=this;this.stopTimer("watchdog");D=D||[];var H=D.length?D[D.length-1].id:this.since;if(typeof this.since=="undefined"){D=[];}this.since=H||"";for(var F=0;F<D.length;F++){for(var E in this.subscribers){if(this.subscribers.hasOwnProperty(E)){this.subscribers[E](D[F].message);}}var G=[];for(var C=0;C<this.awaiting.queue.length;C++){var A=false;for(var B=0;B<this.awaiting.queue[C].length;B++){if(this.awaiting.queue[C][B]==D[F].message.type){A=true;}}if(!A){G.push(this.awaiting.queue[C]);}}this.awaiting.queue=G;}this.request();};Backplane.stopTimer=function(A){var B=this.timers[A];if(B){clearTimeout(B);}};
/*
 * jQuery UI 1.8
 *
 * Copyright (c) 2010 AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT (MIT-LICENSE.txt)
 * and GPL (GPL-LICENSE.txt) licenses.
 *
 * http://docs.jquery.com/UI
 */
jQuery.ui||(function(A){A.ui={version:"1.8",plugin:{add:function(F,E,C){var D=A.ui[F].prototype;for(var B in C){D.plugins[B]=D.plugins[B]||[];D.plugins[B].push([E,C[B]]);}},call:function(B,E,F){var C=B.plugins[E];if(!C||!B.element[0].parentNode){return ;}for(var D=0;D<C.length;D++){if(B.options[C[D][0]]){C[D][1].apply(B.element,F);}}}},contains:function(B,C){return document.compareDocumentPosition?B.compareDocumentPosition(C)&16:B!==C&&B.contains(C);},hasScroll:function(C,E){if(A(C).css("overflow")=="hidden"){return false;}var B=(E&&E=="left")?"scrollLeft":"scrollTop",D=false;if(C[B]>0){return true;}C[B]=1;D=(C[B]>0);C[B]=0;return D;},isOverAxis:function(D,B,C){return(D>B)&&(D<(B+C));},isOver:function(C,G,D,E,B,F){return A.ui.isOverAxis(C,D,B)&&A.ui.isOverAxis(G,E,F);},keyCode:{BACKSPACE:8,CAPS_LOCK:20,COMMA:188,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38}};A.fn.extend({_focus:A.fn.focus,focus:function(B,C){return typeof B==="number"?this.each(function(){var D=this;setTimeout(function(){A(D).focus();(C&&C.call(D));},B);}):this._focus.apply(this,arguments);},enableSelection:function(){return this.attr("unselectable","off").css("MozUserSelect","").unbind("selectstart.ui");},disableSelection:function(){return this.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return false;});},scrollParent:function(){var B;if((A.browser.msie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){B=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test(A.curCSS(this,"position",1))&&(/(auto|scroll)/).test(A.curCSS(this,"overflow",1)+A.curCSS(this,"overflow-y",1)+A.curCSS(this,"overflow-x",1));}).eq(0);}else{B=this.parents().filter(function(){return(/(auto|scroll)/).test(A.curCSS(this,"overflow",1)+A.curCSS(this,"overflow-y",1)+A.curCSS(this,"overflow-x",1));}).eq(0);}return(/fixed/).test(this.css("position"))||!B.length?A(document):B;},zIndex:function(C){if(C!==undefined){return this.css("zIndex",C);}if(this.length){var E=A(this[0]),B,D;while(E.length&&E[0]!==document){B=E.css("position");if(B=="absolute"||B=="relative"||B=="fixed"){D=parseInt(E.css("zIndex"));if(!isNaN(D)&&D!=0){return D;}}E=E.parent();}}return 0;}});A.extend(A.expr[":"],{data:function(C,D,B){return !!A.data(C,B[3]);},focusable:function(D){var C=D.nodeName.toLowerCase(),B=A.attr(D,"tabindex");return(/input|select|textarea|button|object/.test(C)?!D.disabled:"a"==C||"area"==C?D.href||!isNaN(B):!isNaN(B))&&!A(D)["area"==C?"parents":"closest"](":hidden").length;},tabbable:function(C){var B=A.attr(C,"tabindex");return(isNaN(B)||B>=0)&&A(C).is(":focusable");}});})(jQuery);jQuery.effects||(function(D){D.effects={};D.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color","outlineColor"],function(K,L){D.fx.step[L]=function(M){if(!M.colorInit){M.start=A(M.elem,L);M.end=B(M.end);M.colorInit=true;}M.elem.style[L]="rgb("+Math.max(Math.min(parseInt((M.pos*(M.end[0]-M.start[0]))+M.start[0],10),255),0)+","+Math.max(Math.min(parseInt((M.pos*(M.end[1]-M.start[1]))+M.start[1],10),255),0)+","+Math.max(Math.min(parseInt((M.pos*(M.end[2]-M.start[2]))+M.start[2],10),255),0)+")";};});function B(K){var L;if(K&&K.constructor==Array&&K.length==3){return K;}if(L=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(K)){return[parseInt(L[1],10),parseInt(L[2],10),parseInt(L[3],10)];}if(L=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(K)){return[parseFloat(L[1])*2.55,parseFloat(L[2])*2.55,parseFloat(L[3])*2.55];}if(L=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(K)){return[parseInt(L[1],16),parseInt(L[2],16),parseInt(L[3],16)];}if(L=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(K)){return[parseInt(L[1]+L[1],16),parseInt(L[2]+L[2],16),parseInt(L[3]+L[3],16)];}if(L=/rgba\(0, 0, 0, 0\)/.exec(K)){return J.transparent;}return J[D.trim(K).toLowerCase()];}function A(K,M){var L;do{L=D.curCSS(K,M);if(L!=""&&L!="transparent"||D.nodeName(K,"body")){break;}M="backgroundColor";}while(K=K.parentNode);return B(L);}var J={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]};var F=["add","remove","toggle"],H={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};function E(){var O=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,N={},L,K;if(O&&O.length&&O[0]&&O[O[0]]){var M=O.length;while(M--){L=O[M];if(typeof O[L]=="string"){K=L.replace(/\-(\w)/g,function(Q,P){return P.toUpperCase();});N[K]=O[L];}}}else{for(L in O){if(typeof O[L]==="string"){N[L]=O[L];}}}return N;}function I(L){var M,K;for(M in L){K=L[M];if(K==null||D.isFunction(K)||M in H||(/scrollbar/).test(M)||(!(/color/i).test(M)&&isNaN(parseFloat(K)))){delete L[M];}}return L;}function C(M,K){var N={_:0},L;for(L in K){if(M[L]!=K[L]){N[L]=K[L];}}return N;}D.effects.animateClass=function(M,L,N,K){if(D.isFunction(N)){K=N;N=null;}return this.each(function(){var P=D(this),S=P.attr("style")||" ",O=I(E.call(this)),Q,R=P.attr("className");D.each(F,function(U,T){if(M[T]){P[T+"Class"](M[T]);}});
Q=I(E.call(this));P.attr("className",R);P.animate(C(O,Q),L,N,function(){D.each(F,function(U,T){if(M[T]){P[T+"Class"](M[T]);}});if(typeof P.attr("style")=="object"){P.attr("style").cssText="";P.attr("style").cssText=S;}else{P.attr("style",S);}if(K){K.apply(this,arguments);}});});};D.fn.extend({_addClass:D.fn.addClass,addClass:function(L,M,N,K){return M?D.effects.animateClass.apply(this,[{add:L},M,N,K]):this._addClass(L);},_removeClass:D.fn.removeClass,removeClass:function(L,M,N,K){return M?D.effects.animateClass.apply(this,[{remove:L},M,N,K]):this._removeClass(L);},_toggleClass:D.fn.toggleClass,toggleClass:function(K,L,M,N,O){if(typeof L=="boolean"||L===undefined){if(!M){return this._toggleClass(K,L);}else{return D.effects.animateClass.apply(this,[(L?{add:K}:{remove:K}),M,N,O]);}}else{return D.effects.animateClass.apply(this,[{toggle:K},L,M,N]);}},switchClass:function(M,K,L,N,O){return D.effects.animateClass.apply(this,[{add:K,remove:M},L,N,O]);}});D.extend(D.effects,{version:"1.8",save:function(L,K){for(var M=0;M<K.length;M++){if(K[M]!==null){L.data("ec.storage."+K[M],L[0].style[K[M]]);}}},restore:function(L,K){for(var M=0;M<K.length;M++){if(K[M]!==null){L.css(K[M],L.data("ec.storage."+K[M]));}}},setMode:function(L,K){if(K=="toggle"){K=L.is(":hidden")?"show":"hide";}return K;},getBaseline:function(L,K){var N,M;switch(L[0]){case"top":N=0;break;case"middle":N=0.5;break;case"bottom":N=1;break;default:N=L[0]/K.height;}switch(L[1]){case"left":M=0;break;case"center":M=0.5;break;case"right":M=1;break;default:M=L[1]/K.width;}return{x:M,y:N};},createWrapper:function(M){if(M.parent().is(".ui-effects-wrapper")){return M.parent();}var L={width:M.outerWidth(true),height:M.outerHeight(true),"float":M.css("float")},K=D("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0});M.wrap(K);K=M.parent();if(M.css("position")=="static"){K.css({position:"relative"});M.css({position:"relative"});}else{D.extend(L,{position:M.css("position"),zIndex:M.css("z-index")});D.each(["top","left","bottom","right"],function(O,N){L[N]=M.css(N);if(isNaN(parseInt(L[N],10))){L[N]="auto";}});M.css({position:"relative",top:0,left:0});}return K.css(L).show();},removeWrapper:function(K){if(K.parent().is(".ui-effects-wrapper")){return K.parent().replaceWith(K);}return K;},setTransition:function(L,N,M,K){K=K||{};D.each(N,function(O,P){unit=L.cssUnit(P);if(unit[0]>0){K[P]=unit[0]*M+unit[1];}});return K;}});function G(L,M,K,N){if(typeof L=="object"){N=M;K=null;M=L;L=M.effect;}if(D.isFunction(M)){N=M;K=null;M={};}if(D.isFunction(K)){N=K;K=null;}if(typeof M=="number"||D.fx.speeds[M]){N=K;K=M;M={};}M=M||{};K=K||M.duration;K=D.fx.off?0:typeof K=="number"?K:D.fx.speeds[K]||D.fx.speeds._default;N=N||M.complete;return[L,M,K,N];}D.fn.extend({effect:function(Q,K,O,N){var L=G.apply(this,arguments),P={options:L[1],duration:L[2],callback:L[3]},M=D.effects[Q];return M&&!D.fx.off?M.call(this,P):this;},_show:D.fn.show,show:function(K){if(!K||typeof K=="number"||D.fx.speeds[K]){return this._show.apply(this,arguments);}else{var L=G.apply(this,arguments);L[1].mode="show";return this.effect.apply(this,L);}},_hide:D.fn.hide,hide:function(K){if(!K||typeof K=="number"||D.fx.speeds[K]){return this._hide.apply(this,arguments);}else{var L=G.apply(this,arguments);L[1].mode="hide";return this.effect.apply(this,L);}},__toggle:D.fn.toggle,toggle:function(K){if(!K||typeof K=="number"||D.fx.speeds[K]||typeof K=="boolean"||D.isFunction(K)){return this.__toggle.apply(this,arguments);}else{var L=G.apply(this,arguments);L[1].mode="toggle";return this.effect.apply(this,L);}},cssUnit:function(M){var L=this.css(M),K=[];D.each(["em","px","%","pt"],function(O,N){if(L.indexOf(N)>0){K=[parseFloat(L),N];}});return K;}});D.easing.jswing=D.easing.swing;D.extend(D.easing,{def:"easeOutQuad",swing:function(L,K,M,N,O){return D.easing[D.easing.def](L,K,M,N,O);},easeInQuad:function(L,K,M,N,O){return N*(K/=O)*K+M;},easeOutQuad:function(L,K,M,N,O){return -N*(K/=O)*(K-2)+M;},easeInOutQuad:function(L,K,M,N,O){if((K/=O/2)<1){return N/2*K*K+M;}return -N/2*((--K)*(K-2)-1)+M;},easeInCubic:function(L,K,M,N,O){return N*(K/=O)*K*K+M;},easeOutCubic:function(L,K,M,N,O){return N*((K=K/O-1)*K*K+1)+M;},easeInOutCubic:function(L,K,M,N,O){if((K/=O/2)<1){return N/2*K*K*K+M;}return N/2*((K-=2)*K*K+2)+M;},easeInQuart:function(L,K,M,N,O){return N*(K/=O)*K*K*K+M;},easeOutQuart:function(L,K,M,N,O){return -N*((K=K/O-1)*K*K*K-1)+M;},easeInOutQuart:function(L,K,M,N,O){if((K/=O/2)<1){return N/2*K*K*K*K+M;}return -N/2*((K-=2)*K*K*K-2)+M;},easeInQuint:function(L,K,M,N,O){return N*(K/=O)*K*K*K*K+M;},easeOutQuint:function(L,K,M,N,O){return N*((K=K/O-1)*K*K*K*K+1)+M;},easeInOutQuint:function(L,K,M,N,O){if((K/=O/2)<1){return N/2*K*K*K*K*K+M;}return N/2*((K-=2)*K*K*K*K+2)+M;},easeInSine:function(L,K,M,N,O){return -N*Math.cos(K/O*(Math.PI/2))+N+M;},easeOutSine:function(L,K,M,N,O){return N*Math.sin(K/O*(Math.PI/2))+M;},easeInOutSine:function(L,K,M,N,O){return -N/2*(Math.cos(Math.PI*K/O)-1)+M;},easeInExpo:function(L,K,M,N,O){return(K==0)?M:N*Math.pow(2,10*(K/O-1))+M;},easeOutExpo:function(L,K,M,N,O){return(K==O)?M+N:N*(-Math.pow(2,-10*K/O)+1)+M;},easeInOutExpo:function(L,K,M,N,O){if(K==0){return M;}if(K==O){return M+N;}if((K/=O/2)<1){return N/2*Math.pow(2,10*(K-1))+M;}return N/2*(-Math.pow(2,-10*--K)+2)+M;},easeInCirc:function(L,K,M,N,O){return -N*(Math.sqrt(1-(K/=O)*K)-1)+M;},easeOutCirc:function(L,K,M,N,O){return N*Math.sqrt(1-(K=K/O-1)*K)+M;},easeInOutCirc:function(L,K,M,N,O){if((K/=O/2)<1){return -N/2*(Math.sqrt(1-K*K)-1)+M;}return N/2*(Math.sqrt(1-(K-=2)*K)+1)+M;},easeInElastic:function(L,R,M,N,O){var Q=1.70158;var P=0;var K=N;if(R==0){return M;}if((R/=O)==1){return M+N;}if(!P){P=O*0.3;}if(K<Math.abs(N)){K=N;var Q=P/4;}else{var Q=P/(2*Math.PI)*Math.asin(N/K);}return -(K*Math.pow(2,10*(R-=1))*Math.sin((R*O-Q)*(2*Math.PI)/P))+M;},easeOutElastic:function(L,R,M,N,O){var Q=1.70158;var P=0;var K=N;if(R==0){return M;}if((R/=O)==1){return M+N;}if(!P){P=O*0.3;}if(K<Math.abs(N)){K=N;var Q=P/4;}else{var Q=P/(2*Math.PI)*Math.asin(N/K);}return K*Math.pow(2,-10*R)*Math.sin((R*O-Q)*(2*Math.PI)/P)+N+M;},easeInOutElastic:function(L,R,M,N,O){var Q=1.70158;var P=0;var K=N;if(R==0){return M;}if((R/=O/2)==2){return M+N;}if(!P){P=O*(0.3*1.5);}if(K<Math.abs(N)){K=N;var Q=P/4;}else{var Q=P/(2*Math.PI)*Math.asin(N/K);}if(R<1){return -0.5*(K*Math.pow(2,10*(R-=1))*Math.sin((R*O-Q)*(2*Math.PI)/P))+M;}return K*Math.pow(2,-10*(R-=1))*Math.sin((R*O-Q)*(2*Math.PI)/P)*0.5+N+M;},easeInBack:function(L,K,M,N,O,P){if(P==undefined){P=1.70158;}return N*(K/=O)*K*((P+1)*K-P)+M;},easeOutBack:function(L,K,M,N,O,P){if(P==undefined){P=1.70158;}return N*((K=K/O-1)*K*((P+1)*K+P)+1)+M;},easeInOutBack:function(L,K,M,N,O,P){if(P==undefined){P=1.70158;}if((K/=O/2)<1){return N/2*(K*K*(((P*=(1.525))+1)*K-P))+M;}return N/2*((K-=2)*K*(((P*=(1.525))+1)*K+P)+2)+M;},easeInBounce:function(L,K,M,N,O){return N-D.easing.easeOutBounce(L,O-K,0,N,O)+M;},easeOutBounce:function(L,K,M,N,O){if((K/=O)<(1/2.75)){return N*(7.5625*K*K)+M;}else{if(K<(2/2.75)){return N*(7.5625*(K-=(1.5/2.75))*K+0.75)+M;}else{if(K<(2.5/2.75)){return N*(7.5625*(K-=(2.25/2.75))*K+0.9375)+M;}else{return N*(7.5625*(K-=(2.625/2.75))*K+0.984375)+M;}}}},easeInOutBounce:function(L,K,M,N,O){if(K<O/2){return D.easing.easeInBounce(L,K*2,0,N,O)*0.5+M;}return D.easing.easeOutBounce(L,K*2-O,0,N,O)*0.5+N*0.5+M;}});})(jQuery);
/*
 * jQuery UI Widget 1.8.1
 *
 * Copyright (c) 2010 AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT (MIT-LICENSE.txt)
 * and GPL (GPL-LICENSE.txt) licenses.
 *
 * http://docs.jquery.com/UI/Widget
 */
(function(A){var B=A.fn.remove;A.fn.remove=function(C,D){return this.each(function(){if(!D){if(!C||A.filter(C,[this]).length){A("*",this).add(this).each(function(){A(this).triggerHandler("remove");});}}return B.call(A(this),C,D);});};A.widget=function(C,G,F){var E=C.split(".")[0],D;C=C.split(".")[1];D=E+"-"+C;if(!F){F=G;G=A.Widget;}A.expr[":"][D]=function(H){return !!A.data(H,C);
};A[E]=A[E]||{};A[E][C]=function(H,I){arguments.length&&this._createWidget(H,I);};G=new G;G.options=A.extend({},G.options);A[E][C].prototype=A.extend(true,G,{namespace:E,widgetName:C,widgetEventPrefix:A[E][C].prototype.widgetEventPrefix||C,widgetBaseClass:D},F);A.widget.bridge(C,A[E][C]);};A.widget.bridge=function(C,D){A.fn[C]=function(H){var G=typeof H==="string",F=Array.prototype.slice.call(arguments,1),E=this;H=!G&&F.length?A.extend.apply(null,[true,H].concat(F)):H;if(G&&H.substring(0,1)==="_"){return E;}G?this.each(function(){var J=A.data(this,C),I=J&&A.isFunction(J[H])?J[H].apply(J,F):J;if(I!==J&&I!==undefined){E=I;return false;}}):this.each(function(){var I=A.data(this,C);if(I){H&&I.option(H);I._init();}else{A.data(this,C,new D(H,this));}});return E;};};A.Widget=function(C,D){arguments.length&&this._createWidget(C,D);};A.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(C,E){this.element=A(E).data(this.widgetName,this);this.options=A.extend(true,{},this.options,A.metadata&&A.metadata.get(E)[this.widgetName],C);var D=this;this.element.bind("remove."+this.widgetName,function(){D.destroy();});this._create();this._init();},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled");},widget:function(){return this.element;},option:function(C,F){var E=C,D=this;if(arguments.length===0){return A.extend({},D.options);}if(typeof C==="string"){if(F===undefined){return this.options[C];}E={};E[C]=F;}A.each(E,function(H,G){D._setOption(H,G);});return D;},_setOption:function(C,D){this.options[C]=D;if(C==="disabled"){this.widget()[D?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",D);}return this;},enable:function(){return this._setOption("disabled",false);},disable:function(){return this._setOption("disabled",true);},_trigger:function(C,G,F){var E=this.options[C];G=A.Event(G);G.type=(C===this.widgetEventPrefix?C:this.widgetEventPrefix+C).toLowerCase();F=F||{};if(G.originalEvent){C=A.event.props.length;for(var D;C;){D=A.event.props[--C];G[D]=G.originalEvent[D];}}this.element.trigger(G,F);return !(A.isFunction(E)&&E.call(this.element[0],G,F)===false||G.isDefaultPrevented());}};})(jQuery);
/*
 * jQuery UI Mouse 1.8.1
 *
 * Copyright (c) 2010 AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT (MIT-LICENSE.txt)
 * and GPL (GPL-LICENSE.txt) licenses.
 *
 * http://docs.jquery.com/UI/Mouse
 *
 * Depends:
 *      jquery.ui.widget.js
 */
(function(A){A.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var B=this;this.element.bind("mousedown."+this.widgetName,function(C){return B._mouseDown(C);}).bind("click."+this.widgetName,function(C){if(B._preventClickEvent){B._preventClickEvent=false;C.stopImmediatePropagation();return false;}});this.started=false;},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);},_mouseDown:function(C){C.originalEvent=C.originalEvent||{};if(!C.originalEvent.mouseHandled){this._mouseStarted&&this._mouseUp(C);this._mouseDownEvent=C;var B=this,E=C.which==1,D=typeof this.options.cancel=="string"?A(C.target).parents().add(C.target).filter(this.options.cancel).length:false;if(!E||D||!this._mouseCapture(C)){return true;}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){B.mouseDelayMet=true;},this.options.delay);}if(this._mouseDistanceMet(C)&&this._mouseDelayMet(C)){this._mouseStarted=this._mouseStart(C)!==false;if(!this._mouseStarted){C.preventDefault();return true;}}this._mouseMoveDelegate=function(F){return B._mouseMove(F);};this._mouseUpDelegate=function(F){return B._mouseUp(F);};A(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);A.browser.safari||C.preventDefault();return C.originalEvent.mouseHandled=true;}},_mouseMove:function(B){if(A.browser.msie&&!B.button){return this._mouseUp(B);}if(this._mouseStarted){this._mouseDrag(B);return B.preventDefault();}if(this._mouseDistanceMet(B)&&this._mouseDelayMet(B)){(this._mouseStarted=this._mouseStart(this._mouseDownEvent,B)!==false)?this._mouseDrag(B):this._mouseUp(B);}return !this._mouseStarted;},_mouseUp:function(B){A(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;this._preventClickEvent=B.target==this._mouseDownEvent.target;this._mouseStop(B);}return false;},_mouseDistanceMet:function(B){return Math.max(Math.abs(this._mouseDownEvent.pageX-B.pageX),Math.abs(this._mouseDownEvent.pageY-B.pageY))>=this.options.distance;},_mouseDelayMet:function(){return this.mouseDelayMet;},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true;}});})(jQuery);(function(E){E.ui=E.ui||{};var A=/left|center|right/,D=/top|center|bottom/,C=E.fn.position,B=E.fn.offset;E.fn.position=function(G){if(!G||!G.of){return C.apply(this,arguments);}G=E.extend({},G);var F=E(G.of),L=(G.collision||"flip").split(" "),K=G.offset?G.offset.split(" "):[0,0],J,I,H;if(G.of.nodeType===9){J=F.width();I=F.height();H={top:0,left:0};}else{if(G.of.scrollTo&&G.of.document){J=F.width();I=F.height();H={top:F.scrollTop(),left:F.scrollLeft()};}else{if(G.of.preventDefault){G.at="left top";J=I=0;H={top:G.of.pageY,left:G.of.pageX};}else{J=F.outerWidth();I=F.outerHeight();H=F.offset();}}}E.each(["my","at"],function(){var M=(G[this]||"").split(" ");if(M.length===1){M=A.test(M[0])?M.concat(["center"]):D.test(M[0])?["center"].concat(M):["center","center"];}M[0]=A.test(M[0])?M[0]:"center";M[1]=D.test(M[1])?M[1]:"center";G[this]=M;});if(L.length===1){L[1]=L[0];}K[0]=parseInt(K[0],10)||0;if(K.length===1){K[1]=K[0];}K[1]=parseInt(K[1],10)||0;if(G.at[0]==="right"){H.left+=J;}else{if(G.at[0]==="center"){H.left+=J/2;}}if(G.at[1]==="bottom"){H.top+=I;}else{if(G.at[1]==="center"){H.top+=I/2;}}H.left+=K[0];H.top+=K[1];return this.each(function(){var P=E(this),N=P.outerWidth(),M=P.outerHeight(),O=E.extend({},H);if(G.my[0]==="right"){O.left-=N;}else{if(G.my[0]==="center"){O.left-=N/2;}}if(G.my[1]==="bottom"){O.top-=M;}else{if(G.my[1]==="center"){O.top-=M/2;}}O.left=parseInt(O.left);O.top=parseInt(O.top);E.each(["left","top"],function(R,Q){E.ui.position[L[R]]&&E.ui.position[L[R]][Q](O,{targetWidth:J,targetHeight:I,elemWidth:N,elemHeight:M,offset:K,my:G.my,at:G.at});});E.fn.bgiframe&&P.bgiframe();P.offset(E.extend(O,{using:G.using}));});};E.ui.position={fit:{left:function(G,F){var H=E(window);F=G.left+F.elemWidth-H.width()-H.scrollLeft();G.left=F>0?G.left-F:Math.max(0,G.left);},top:function(G,F){var H=E(window);F=G.top+F.elemHeight-H.height()-H.scrollTop();G.top=F>0?G.top-F:Math.max(0,G.top);}},flip:{left:function(G,F){if(F.at[0]!=="center"){var J=E(window);J=G.left+F.elemWidth-J.width()-J.scrollLeft();var I=F.my[0]==="left"?-F.elemWidth:F.my[0]==="right"?F.elemWidth:0,H=-2*F.offset[0];G.left+=G.left<0?I+F.targetWidth+H:J>0?I-F.targetWidth+H:0;}},top:function(G,F){if(F.at[1]!=="center"){var K=E(window);K=G.top+F.elemHeight-K.height()-K.scrollTop();var J=F.my[1]==="top"?-F.elemHeight:F.my[1]==="bottom"?F.elemHeight:0,I=F.at[1]==="top"?F.targetHeight:-F.targetHeight,H=-2*F.offset[1];G.top+=G.top<0?J+F.targetHeight+H:K>0?J+I+H:0;}}}};if(!E.offset.setOffset){E.offset.setOffset=function(G,F){if(/static/.test(E.curCSS(G,"position"))){G.style.position="relative";}var K=E(G),J=K.offset(),I=parseInt(E.curCSS(G,"top",true),10)||0,H=parseInt(E.curCSS(G,"left",true),10)||0;J={top:F.top-J.top+I,left:F.left-J.left+H};"using" in F?F.using.call(G,J):K.css(J);};E.fn.offset=function(G){var F=this[0];if(!F||!F.ownerDocument){return null;}if(G){return this.each(function(){E.offset.setOffset(this,G);});}return B.call(this);
};}})(jQuery);(function(A){A.widget("ui.draggable",A.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){if(this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))){this.element[0].style.position="relative";}this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit();},destroy:function(){if(this.element.data("draggable")){this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this;}},_mouseCapture:function(C){var B=this.options;if(this.helper||B.disabled||A(C.target).is(".ui-resizable-handle")){return false;}this.handle=this._getHandle(C);if(!this.handle){return false;}return true;},_mouseStart:function(C){var B=this.options;this.helper=this._createHelper(C);this._cacheHelperProportions();if(A.ui.ddmanager){A.ui.ddmanager.current=this;}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};A.extend(this.offset,{click:{left:C.pageX-this.offset.left,top:C.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(C);this.originalPageX=C.pageX;this.originalPageY=C.pageY;B.cursorAt&&this._adjustOffsetFromHelper(B.cursorAt);B.containment&&this._setContainment();if(this._trigger("start",C)===false){this._clear();return false;}this._cacheHelperProportions();A.ui.ddmanager&&!B.dropBehaviour&&A.ui.ddmanager.prepareOffsets(this,C);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(C,true);return true;},_mouseDrag:function(C,B){this.position=this._generatePosition(C);this.positionAbs=this._convertPositionTo("absolute");if(!B){B=this._uiHash();if(this._trigger("drag",C,B)===false){this._mouseUp({});return false;}this.position=B.position;}if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px";}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px";}A.ui.ddmanager&&A.ui.ddmanager.drag(this,C);return false;},_mouseStop:function(C){var B=false;if(A.ui.ddmanager&&!this.options.dropBehaviour){B=A.ui.ddmanager.drop(this,C);}if(this.dropped){B=this.dropped;this.dropped=false;}if(!this.element[0]||!this.element[0].parentNode){return false;}if(this.options.revert=="invalid"&&!B||this.options.revert=="valid"&&B||this.options.revert===true||A.isFunction(this.options.revert)&&this.options.revert.call(this.element,B)){var D=this;A(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){D._trigger("stop",C)!==false&&D._clear();});}else{this._trigger("stop",C)!==false&&this._clear();}return false;},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this;},_getHandle:function(C){var B=!this.options.handle||!A(this.options.handle,this.element).length?true:false;A(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==C.target){B=true;}});return B;},_createHelper:function(C){var B=this.options;C=A.isFunction(B.helper)?A(B.helper.apply(this.element[0],[C])):B.helper=="clone"?this.element.clone():this.element;C.parents("body").length||C.appendTo(B.appendTo=="parent"?this.element[0].parentNode:B.appendTo);C[0]!=this.element[0]&&!/(fixed|absolute)/.test(C.css("position"))&&C.css("position","absolute");return C;},_adjustOffsetFromHelper:function(B){if(typeof B=="string"){B=B.split(" ");}if(A.isArray(B)){B={left:+B[0],top:+B[1]||0};}if("left" in B){this.offset.click.left=B.left+this.margins.left;}if("right" in B){this.offset.click.left=this.helperProportions.width-B.right+this.margins.left;}if("top" in B){this.offset.click.top=B.top+this.margins.top;}if("bottom" in B){this.offset.click.top=this.helperProportions.height-B.bottom+this.margins.top;}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var B=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&A.ui.contains(this.scrollParent[0],this.offsetParent[0])){B.left+=this.scrollParent.scrollLeft();B.top+=this.scrollParent.scrollTop();}if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&A.browser.msie){B={top:0,left:0};}return{top:B.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:B.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)};},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var B=this.element.position();return{top:B.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:B.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()};}else{return{top:0,left:0};}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0};},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()};},_setContainment:function(){var C=this.options;if(C.containment=="parent"){C.containment=this.helper[0].parentNode;}if(C.containment=="document"||C.containment=="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,A(C.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(A(C.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];}if(!/^(document|window|parent)$/.test(C.containment)&&C.containment.constructor!=Array){var B=A(C.containment)[0];if(B){C=A(C.containment).offset();var D=A(B).css("overflow")!="hidden";this.containment=[C.left+(parseInt(A(B).css("borderLeftWidth"),10)||0)+(parseInt(A(B).css("paddingLeft"),10)||0)-this.margins.left,C.top+(parseInt(A(B).css("borderTopWidth"),10)||0)+(parseInt(A(B).css("paddingTop"),10)||0)-this.margins.top,C.left+(D?Math.max(B.scrollWidth,B.offsetWidth):B.offsetWidth)-(parseInt(A(B).css("borderLeftWidth"),10)||0)-(parseInt(A(B).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,C.top+(D?Math.max(B.scrollHeight,B.offsetHeight):B.offsetHeight)-(parseInt(A(B).css("borderTopWidth"),10)||0)-(parseInt(A(B).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top];}}else{if(C.containment.constructor==Array){this.containment=C.containment;}}},_convertPositionTo:function(C,B){if(!B){B=this.position;}C=C=="absolute"?1:-1;var E=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&A.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,D=/(html|body)/i.test(E[0].tagName);return{top:B.top+this.offset.relative.top*C+this.offset.parent.top*C-(A.browser.safari&&A.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():D?0:E.scrollTop())*C),left:B.left+this.offset.relative.left*C+this.offset.parent.left*C-(A.browser.safari&&A.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():D?0:E.scrollLeft())*C)};},_generatePosition:function(C){var B=this.options,G=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&A.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,E=/(html|body)/i.test(G[0].tagName),F=C.pageX,D=C.pageY;
if(this.originalPosition){if(this.containment){if(C.pageX-this.offset.click.left<this.containment[0]){F=this.containment[0]+this.offset.click.left;}if(C.pageY-this.offset.click.top<this.containment[1]){D=this.containment[1]+this.offset.click.top;}if(C.pageX-this.offset.click.left>this.containment[2]){F=this.containment[2]+this.offset.click.left;}if(C.pageY-this.offset.click.top>this.containment[3]){D=this.containment[3]+this.offset.click.top;}}if(B.grid){D=this.originalPageY+Math.round((D-this.originalPageY)/B.grid[1])*B.grid[1];D=this.containment?!(D-this.offset.click.top<this.containment[1]||D-this.offset.click.top>this.containment[3])?D:!(D-this.offset.click.top<this.containment[1])?D-B.grid[1]:D+B.grid[1]:D;F=this.originalPageX+Math.round((F-this.originalPageX)/B.grid[0])*B.grid[0];F=this.containment?!(F-this.offset.click.left<this.containment[0]||F-this.offset.click.left>this.containment[2])?F:!(F-this.offset.click.left<this.containment[0])?F-B.grid[0]:F+B.grid[0]:F;}}return{top:D-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(A.browser.safari&&A.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():E?0:G.scrollTop()),left:F-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(A.browser.safari&&A.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():E?0:G.scrollLeft())};},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=false;},_trigger:function(C,B,D){D=D||this._uiHash();A.ui.plugin.call(this,C,[B,D]);if(C=="drag"){this.positionAbs=this._convertPositionTo("absolute");}return A.Widget.prototype._trigger.call(this,C,B,D);},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs};}});A.extend(A.ui.draggable,{version:"1.8.1"});A.ui.plugin.add("draggable","connectToSortable",{start:function(C,B){var F=A(this).data("draggable"),D=F.options,E=A.extend({},B,{item:F.element});F.sortables=[];A(D.connectToSortable).each(function(){var G=A.data(this,"sortable");if(G&&!G.options.disabled){F.sortables.push({instance:G,shouldRevert:G.options.revert});G._refreshItems();G._trigger("activate",C,E);}});},stop:function(C,B){var E=A(this).data("draggable"),D=A.extend({},B,{item:E.element});A.each(E.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;E.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert){this.instance.options.revert=true;}this.instance._mouseStop(C);this.instance.options.helper=this.instance.options._helper;E.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"});}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",C,D);}});},drag:function(C,B){var E=A(this).data("draggable"),D=this;A.each(E.sortables,function(){this.instance.positionAbs=E.positionAbs;this.instance.helperProportions=E.helperProportions;this.instance.offset.click=E.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=A(D).clone().appendTo(this.instance.element).data("sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return B.helper[0];};C.target=this.instance.currentItem[0];this.instance._mouseCapture(C,true);this.instance._mouseStart(C,true,true);this.instance.offset.click.top=E.offset.click.top;this.instance.offset.click.left=E.offset.click.left;this.instance.offset.parent.left-=E.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=E.offset.parent.top-this.instance.offset.parent.top;E._trigger("toSortable",C);E.dropped=this.instance.element;E.currentItem=E.element;this.instance.fromOutside=E;}this.instance.currentItem&&this.instance._mouseDrag(C);}else{if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",C,this.instance._uiHash(this.instance));this.instance._mouseStop(C,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();this.instance.placeholder&&this.instance.placeholder.remove();E._trigger("fromSortable",C);E.dropped=false;}}});}});A.ui.plugin.add("draggable","cursor",{start:function(){var C=A("body"),B=A(this).data("draggable").options;if(C.css("cursor")){B._cursor=C.css("cursor");}C.css("cursor",B.cursor);},stop:function(){var B=A(this).data("draggable").options;B._cursor&&A("body").css("cursor",B._cursor);}});A.ui.plugin.add("draggable","iframeFix",{start:function(){var B=A(this).data("draggable").options;A(B.iframeFix===true?"iframe":B.iframeFix).each(function(){A('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css(A(this).offset()).appendTo("body");});},stop:function(){A("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this);});}});A.ui.plugin.add("draggable","opacity",{start:function(C,B){C=A(B.helper);B=A(this).data("draggable").options;if(C.css("opacity")){B._opacity=C.css("opacity");}C.css("opacity",B.opacity);},stop:function(C,B){C=A(this).data("draggable").options;C._opacity&&A(B.helper).css("opacity",C._opacity);}});A.ui.plugin.add("draggable","scroll",{start:function(){var B=A(this).data("draggable");if(B.scrollParent[0]!=document&&B.scrollParent[0].tagName!="HTML"){B.overflowOffset=B.scrollParent.offset();}},drag:function(C){var B=A(this).data("draggable"),E=B.options,D=false;if(B.scrollParent[0]!=document&&B.scrollParent[0].tagName!="HTML"){if(!E.axis||E.axis!="x"){if(B.overflowOffset.top+B.scrollParent[0].offsetHeight-C.pageY<E.scrollSensitivity){B.scrollParent[0].scrollTop=D=B.scrollParent[0].scrollTop+E.scrollSpeed;}else{if(C.pageY-B.overflowOffset.top<E.scrollSensitivity){B.scrollParent[0].scrollTop=D=B.scrollParent[0].scrollTop-E.scrollSpeed;}}}if(!E.axis||E.axis!="y"){if(B.overflowOffset.left+B.scrollParent[0].offsetWidth-C.pageX<E.scrollSensitivity){B.scrollParent[0].scrollLeft=D=B.scrollParent[0].scrollLeft+E.scrollSpeed;}else{if(C.pageX-B.overflowOffset.left<E.scrollSensitivity){B.scrollParent[0].scrollLeft=D=B.scrollParent[0].scrollLeft-E.scrollSpeed;}}}}else{if(!E.axis||E.axis!="x"){if(C.pageY-A(document).scrollTop()<E.scrollSensitivity){D=A(document).scrollTop(A(document).scrollTop()-E.scrollSpeed);}else{if(A(window).height()-(C.pageY-A(document).scrollTop())<E.scrollSensitivity){D=A(document).scrollTop(A(document).scrollTop()+E.scrollSpeed);}}}if(!E.axis||E.axis!="y"){if(C.pageX-A(document).scrollLeft()<E.scrollSensitivity){D=A(document).scrollLeft(A(document).scrollLeft()-E.scrollSpeed);}else{if(A(window).width()-(C.pageX-A(document).scrollLeft())<E.scrollSensitivity){D=A(document).scrollLeft(A(document).scrollLeft()+E.scrollSpeed);}}}}D!==false&&A.ui.ddmanager&&!E.dropBehaviour&&A.ui.ddmanager.prepareOffsets(B,C);}});A.ui.plugin.add("draggable","snap",{start:function(){var C=A(this).data("draggable"),B=C.options;C.snapElements=[];A(B.snap.constructor!=String?B.snap.items||":data(draggable)":B.snap).each(function(){var E=A(this),D=E.offset();this!=C.element[0]&&C.snapElements.push({item:this,width:E.outerWidth(),height:E.outerHeight(),top:D.top,left:D.left});});},drag:function(T,S){for(var R=A(this).data("draggable"),P=R.options,Q=P.snapTolerance,O=S.offset.left,H=O+R.helperProportions.width,I=S.offset.top,G=I+R.helperProportions.height,N=R.snapElements.length-1;N>=0;N--){var M=R.snapElements[N].left,K=M+R.snapElements[N].width,L=R.snapElements[N].top,J=L+R.snapElements[N].height;if(M-Q<O&&O<K+Q&&L-Q<I&&I<J+Q||M-Q<O&&O<K+Q&&L-Q<G&&G<J+Q||M-Q<H&&H<K+Q&&L-Q<I&&I<J+Q||M-Q<H&&H<K+Q&&L-Q<G&&G<J+Q){if(P.snapMode!="inner"){var F=Math.abs(L-G)<=Q,E=Math.abs(J-I)<=Q,D=Math.abs(M-H)<=Q,C=Math.abs(K-O)<=Q;
if(F){S.position.top=R._convertPositionTo("relative",{top:L-R.helperProportions.height,left:0}).top-R.margins.top;}if(E){S.position.top=R._convertPositionTo("relative",{top:J,left:0}).top-R.margins.top;}if(D){S.position.left=R._convertPositionTo("relative",{top:0,left:M-R.helperProportions.width}).left-R.margins.left;}if(C){S.position.left=R._convertPositionTo("relative",{top:0,left:K}).left-R.margins.left;}}var B=F||E||D||C;if(P.snapMode!="outer"){F=Math.abs(L-I)<=Q;E=Math.abs(J-G)<=Q;D=Math.abs(M-O)<=Q;C=Math.abs(K-H)<=Q;if(F){S.position.top=R._convertPositionTo("relative",{top:L,left:0}).top-R.margins.top;}if(E){S.position.top=R._convertPositionTo("relative",{top:J-R.helperProportions.height,left:0}).top-R.margins.top;}if(D){S.position.left=R._convertPositionTo("relative",{top:0,left:M}).left-R.margins.left;}if(C){S.position.left=R._convertPositionTo("relative",{top:0,left:K-R.helperProportions.width}).left-R.margins.left;}}if(!R.snapElements[N].snapping&&(F||E||D||C||B)){R.options.snap.snap&&R.options.snap.snap.call(R.element,T,A.extend(R._uiHash(),{snapItem:R.snapElements[N].item}));}R.snapElements[N].snapping=F||E||D||C||B;}else{R.snapElements[N].snapping&&R.options.snap.release&&R.options.snap.release.call(R.element,T,A.extend(R._uiHash(),{snapItem:R.snapElements[N].item}));R.snapElements[N].snapping=false;}}}});A.ui.plugin.add("draggable","stack",{start:function(){var C=A(this).data("draggable").options;C=A.makeArray(A(C.stack)).sort(function(E,D){return(parseInt(A(E).css("zIndex"),10)||0)-(parseInt(A(D).css("zIndex"),10)||0);});if(C.length){var B=parseInt(C[0].style.zIndex)||0;A(C).each(function(D){this.style.zIndex=B+D;});this[0].style.zIndex=B+C.length;}}});A.ui.plugin.add("draggable","zIndex",{start:function(C,B){C=A(B.helper);B=A(this).data("draggable").options;if(C.css("zIndex")){B._zIndex=C.css("zIndex");}C.css("zIndex",B.zIndex);},stop:function(C,B){C=A(this).data("draggable").options;C._zIndex&&A(B.helper).css("zIndex",C._zIndex);}});})(jQuery);(function(C){C.widget("ui.resizable",C.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1000},_create:function(){var D=this,E=this.options;this.element.addClass("ui-resizable");C.extend(this,{_aspectRatio:!!E.aspectRatio,aspectRatio:E.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:E.helper||E.ghost||E.animate?E.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){/relative/.test(this.element.css("position"))&&C.browser.opera&&this.element.css({position:"relative",top:"auto",left:"auto"});this.element.wrap(C('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("resizable",this.element.data("resizable"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize();}this.handles=E.handles||(!C(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});if(this.handles.constructor==String){if(this.handles=="all"){this.handles="n,e,s,w,se,sw,ne,nw";}var I=this.handles.split(",");this.handles={};for(var H=0;H<I.length;H++){var F=C.trim(I[H]),G=C('<div class="ui-resizable-handle '+("ui-resizable-"+F)+'"></div>');/sw|se|ne|nw/.test(F)&&G.css({zIndex:++E.zIndex});"se"==F&&G.addClass("ui-icon ui-icon-gripsmall-diagonal-se");this.handles[F]=".ui-resizable-"+F;this.element.append(G);}}this._renderAxis=function(M){M=M||this.element;for(var L in this.handles){if(this.handles[L].constructor==String){this.handles[L]=C(this.handles[L],this.element).show();}if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var K=C(this.handles[L],this.element),J=0;J=/sw|ne|nw|se|n|s/.test(L)?K.outerHeight():K.outerWidth();K=["padding",/ne|nw|n/.test(L)?"Top":/se|sw|s/.test(L)?"Bottom":/^e$/.test(L)?"Right":"Left"].join("");M.css(K,J);this._proportionallyResize();}C(this.handles[L]);}};this._renderAxis(this.element);this._handles=C(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!D.resizing){if(this.className){var J=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);}D.axis=J&&J[1]?J[1]:"se";}});if(E.autoHide){this._handles.hide();C(this.element).addClass("ui-resizable-autohide").hover(function(){C(this).removeClass("ui-resizable-autohide");D._handles.show();},function(){if(!D.resizing){C(this).addClass("ui-resizable-autohide");D._handles.hide();}});}this._mouseInit();},destroy:function(){this._mouseDestroy();var D=function(F){C(F).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove();};if(this.elementIsWrapper){D(this.element);var E=this.element;E.after(this.originalElement.css({position:E.css("position"),width:E.outerWidth(),height:E.outerHeight(),top:E.css("top"),left:E.css("left")})).remove();}this.originalElement.css("resize",this.originalResizeStyle);D(this.originalElement);return this;},_mouseCapture:function(D){var E=false;for(var F in this.handles){if(C(this.handles[F])[0]==D.target){E=true;}}return !this.options.disabled&&E;},_mouseStart:function(D){var E=this.options,H=this.element.position(),G=this.element;this.resizing=true;this.documentScroll={top:C(document).scrollTop(),left:C(document).scrollLeft()};if(G.is(".ui-draggable")||/absolute/.test(G.css("position"))){G.css({position:"absolute",top:H.top,left:H.left});}C.browser.opera&&/relative/.test(G.css("position"))&&G.css({position:"relative",top:"auto",left:"auto"});this._renderProxy();H=A(this.helper.css("left"));var F=A(this.helper.css("top"));if(E.containment){H+=C(E.containment).scrollLeft()||0;F+=C(E.containment).scrollTop()||0;}this.offset=this.helper.offset();this.position={left:H,top:F};this.size=this._helper?{width:G.outerWidth(),height:G.outerHeight()}:{width:G.width(),height:G.height()};this.originalSize=this._helper?{width:G.outerWidth(),height:G.outerHeight()}:{width:G.width(),height:G.height()};this.originalPosition={left:H,top:F};this.sizeDiff={width:G.outerWidth()-G.width(),height:G.outerHeight()-G.height()};this.originalMousePosition={left:D.pageX,top:D.pageY};this.aspectRatio=typeof E.aspectRatio=="number"?E.aspectRatio:this.originalSize.width/this.originalSize.height||1;E=C(".ui-resizable-"+this.axis).css("cursor");C("body").css("cursor",E=="auto"?this.axis+"-resize":E);G.addClass("ui-resizable-resizing");this._propagate("start",D);return true;},_mouseDrag:function(D){var E=this.helper,G=this.originalMousePosition,F=this._change[this.axis];if(!F){return false;}G=F.apply(this,[D,D.pageX-G.left||0,D.pageY-G.top||0]);if(this._aspectRatio||D.shiftKey){G=this._updateRatio(G,D);}G=this._respectSize(G,D);this._propagate("resize",D);E.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize();
this._updateCache(G);this._trigger("resize",D,this.ui());return false;},_mouseStop:function(D){this.resizing=false;var E=this.options,I=this;if(this._helper){var H=this._proportionallyResizeElements,F=H.length&&/textarea/i.test(H[0].nodeName);H=F&&C.ui.hasScroll(H[0],"left")?0:I.sizeDiff.height;F={width:I.size.width-(F?0:I.sizeDiff.width),height:I.size.height-H};H=parseInt(I.element.css("left"),10)+(I.position.left-I.originalPosition.left)||null;var G=parseInt(I.element.css("top"),10)+(I.position.top-I.originalPosition.top)||null;E.animate||this.element.css(C.extend(F,{top:G,left:H}));I.helper.height(I.size.height);I.helper.width(I.size.width);this._helper&&!E.animate&&this._proportionallyResize();}C("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",D);this._helper&&this.helper.remove();return false;},_updateCache:function(D){this.offset=this.helper.offset();if(B(D.left)){this.position.left=D.left;}if(B(D.top)){this.position.top=D.top;}if(B(D.height)){this.size.height=D.height;}if(B(D.width)){this.size.width=D.width;}},_updateRatio:function(D){var E=this.position,G=this.size,F=this.axis;if(D.height){D.width=G.height*this.aspectRatio;}else{if(D.width){D.height=G.width/this.aspectRatio;}}if(F=="sw"){D.left=E.left+(G.width-D.width);D.top=null;}if(F=="nw"){D.top=E.top+(G.height-D.height);D.left=E.left+(G.width-D.width);}return D;},_respectSize:function(L){var M=this.options,K=this.axis,J=B(L.width)&&M.maxWidth&&M.maxWidth<L.width,H=B(L.height)&&M.maxHeight&&M.maxHeight<L.height,I=B(L.width)&&M.minWidth&&M.minWidth>L.width,G=B(L.height)&&M.minHeight&&M.minHeight>L.height;if(I){L.width=M.minWidth;}if(G){L.height=M.minHeight;}if(J){L.width=M.maxWidth;}if(H){L.height=M.maxHeight;}var F=this.originalPosition.left+this.originalSize.width,E=this.position.top+this.size.height,D=/sw|nw|w/.test(K);K=/nw|ne|n/.test(K);if(I&&D){L.left=F-M.minWidth;}if(J&&D){L.left=F-M.maxWidth;}if(G&&K){L.top=E-M.minHeight;}if(H&&K){L.top=E-M.maxHeight;}if((M=!L.width&&!L.height)&&!L.left&&L.top){L.top=null;}else{if(M&&!L.top&&L.left){L.left=null;}}return L;},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){for(var D=this.helper||this.element,E=0;E<this._proportionallyResizeElements.length;E++){var H=this._proportionallyResizeElements[E];if(!this.borderDif){var G=[H.css("borderTopWidth"),H.css("borderRightWidth"),H.css("borderBottomWidth"),H.css("borderLeftWidth")],F=[H.css("paddingTop"),H.css("paddingRight"),H.css("paddingBottom"),H.css("paddingLeft")];this.borderDif=C.map(G,function(J,I){J=parseInt(J,10)||0;I=parseInt(F[I],10)||0;return J+I;});}C.browser.msie&&(C(D).is(":hidden")||C(D).parents(":hidden").length)||H.css({height:D.height()-this.borderDif[0]-this.borderDif[2]||0,width:D.width()-this.borderDif[1]-this.borderDif[3]||0});}}},_renderProxy:function(){var D=this.options;this.elementOffset=this.element.offset();if(this._helper){this.helper=this.helper||C('<div style="overflow:hidden;"></div>');var E=C.browser.msie&&C.browser.version<7,F=E?1:0;E=E?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+E,height:this.element.outerHeight()+E,position:"absolute",left:this.elementOffset.left-F+"px",top:this.elementOffset.top-F+"px",zIndex:++D.zIndex});this.helper.appendTo("body").disableSelection();}else{this.helper=this.element;}},_change:{e:function(D,E){return{width:this.originalSize.width+E};},w:function(D,E){return{left:this.originalPosition.left+E,width:this.originalSize.width-E};},n:function(D,E,F){return{top:this.originalPosition.top+F,height:this.originalSize.height-F};},s:function(D,E,F){return{height:this.originalSize.height+F};},se:function(D,E,F){return C.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[D,E,F]));},sw:function(D,E,F){return C.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[D,E,F]));},ne:function(D,E,F){return C.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[D,E,F]));},nw:function(D,E,F){return C.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[D,E,F]));}},_propagate:function(D,E){C.ui.plugin.call(this,D,[E,this.ui()]);D!="resize"&&this._trigger(D,E,this.ui());},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition};}});C.extend(C.ui.resizable,{version:"1.8.1"});C.ui.plugin.add("resizable","alsoResize",{start:function(){var D=C(this).data("resizable").options,E=function(F){C(F).each(function(){C(this).data("resizable-alsoresize",{width:parseInt(C(this).width(),10),height:parseInt(C(this).height(),10),left:parseInt(C(this).css("left"),10),top:parseInt(C(this).css("top"),10)});});};if(typeof D.alsoResize=="object"&&!D.alsoResize.parentNode){if(D.alsoResize.length){D.alsoResize=D.alsoResize[0];E(D.alsoResize);}else{C.each(D.alsoResize,function(F){E(F);});}}else{E(D.alsoResize);}},resize:function(){var D=C(this).data("resizable"),E=D.options,I=D.originalSize,H=D.originalPosition,F={height:D.size.height-I.height||0,width:D.size.width-I.width||0,top:D.position.top-H.top||0,left:D.position.left-H.left||0},G=function(K,J){C(K).each(function(){var M=C(this),L=C(this).data("resizable-alsoresize"),N={};C.each((J&&J.length?J:["width","height","top","left"])||["width","height","top","left"],function(P,O){if((P=(L[O]||0)+(F[O]||0))&&P>=0){N[O]=P||null;}});if(/relative/.test(M.css("position"))&&C.browser.opera){D._revertToRelativePosition=true;M.css({position:"absolute",top:"auto",left:"auto"});}M.css(N);});};typeof E.alsoResize=="object"&&!E.alsoResize.nodeType?C.each(E.alsoResize,function(K,J){G(K,J);}):G(E.alsoResize);},stop:function(){var D=C(this).data("resizable");if(D._revertToRelativePosition&&C.browser.opera){D._revertToRelativePosition=false;el.css({position:"relative"});}C(this).removeData("resizable-alsoresize-start");}});C.ui.plugin.add("resizable","animate",{stop:function(D){var E=C(this).data("resizable"),J=E.options,I=E._proportionallyResizeElements,G=I.length&&/textarea/i.test(I[0].nodeName),H=G&&C.ui.hasScroll(I[0],"left")?0:E.sizeDiff.height;G={width:E.size.width-(G?0:E.sizeDiff.width),height:E.size.height-H};H=parseInt(E.element.css("left"),10)+(E.position.left-E.originalPosition.left)||null;var F=parseInt(E.element.css("top"),10)+(E.position.top-E.originalPosition.top)||null;E.element.animate(C.extend(G,F&&H?{top:F,left:H}:{}),{duration:J.animateDuration,easing:J.animateEasing,step:function(){var K={width:parseInt(E.element.css("width"),10),height:parseInt(E.element.css("height"),10),top:parseInt(E.element.css("top"),10),left:parseInt(E.element.css("left"),10)};I&&I.length&&C(I[0]).css({width:K.width,height:K.height});E._updateCache(K);E._propagate("resize",D);}});}});C.ui.plugin.add("resizable","containment",{start:function(){var D=C(this).data("resizable"),E=D.element,J=D.options.containment;if(E=J instanceof C?J.get(0):/parent/.test(J)?E.parent().get(0):J){D.containerElement=C(E);if(/document/.test(J)||J==document){D.containerOffset={left:0,top:0};D.containerPosition={left:0,top:0};D.parentData={element:C(document),left:0,top:0,width:C(document).width(),height:C(document).height()||document.body.parentNode.scrollHeight};}else{var I=C(E),G=[];C(["Top","Right","Left","Bottom"]).each(function(L,K){G[L]=A(I.css("padding"+K));});D.containerOffset=I.offset();D.containerPosition=I.position();D.containerSize={height:I.innerHeight()-G[3],width:I.innerWidth()-G[1]};J=D.containerOffset;var H=D.containerSize.height,F=D.containerSize.width;F=C.ui.hasScroll(E,"left")?E.scrollWidth:F;H=C.ui.hasScroll(E)?E.scrollHeight:H;D.parentData={element:E,left:J.left,top:J.top,width:F,height:H};}}},resize:function(D){var E=C(this).data("resizable"),J=E.options,I=E.containerOffset,G=E.position;D=E._aspectRatio||D.shiftKey;var H={top:0,left:0},F=E.containerElement;if(F[0]!=document&&/static/.test(F.css("position"))){H=I;
}if(G.left<(E._helper?I.left:0)){E.size.width+=E._helper?E.position.left-I.left:E.position.left-H.left;if(D){E.size.height=E.size.width/J.aspectRatio;}E.position.left=J.helper?I.left:0;}if(G.top<(E._helper?I.top:0)){E.size.height+=E._helper?E.position.top-I.top:E.position.top;if(D){E.size.width=E.size.height*J.aspectRatio;}E.position.top=E._helper?I.top:0;}E.offset.left=E.parentData.left+E.position.left;E.offset.top=E.parentData.top+E.position.top;J=Math.abs((E._helper?E.offset.left-H.left:E.offset.left-H.left)+E.sizeDiff.width);I=Math.abs((E._helper?E.offset.top-H.top:E.offset.top-I.top)+E.sizeDiff.height);G=E.containerElement.get(0)==E.element.parent().get(0);H=/relative|absolute/.test(E.containerElement.css("position"));if(G&&H){J-=E.parentData.left;}if(J+E.size.width>=E.parentData.width){E.size.width=E.parentData.width-J;if(D){E.size.height=E.size.width/E.aspectRatio;}}if(I+E.size.height>=E.parentData.height){E.size.height=E.parentData.height-I;if(D){E.size.width=E.size.height*E.aspectRatio;}}},stop:function(){var D=C(this).data("resizable"),E=D.options,K=D.containerOffset,J=D.containerPosition,H=D.containerElement,I=C(D.helper),G=I.offset(),F=I.outerWidth()-D.sizeDiff.width;I=I.outerHeight()-D.sizeDiff.height;D._helper&&!E.animate&&/relative/.test(H.css("position"))&&C(this).css({left:G.left-J.left-K.left,width:F,height:I});D._helper&&!E.animate&&/static/.test(H.css("position"))&&C(this).css({left:G.left-J.left-K.left,width:F,height:I});}});C.ui.plugin.add("resizable","ghost",{start:function(){var D=C(this).data("resizable"),E=D.options,F=D.size;D.ghost=D.originalElement.clone();D.ghost.css({opacity:0.25,display:"block",position:"relative",height:F.height,width:F.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof E.ghost=="string"?E.ghost:"");D.ghost.appendTo(D.helper);},resize:function(){var D=C(this).data("resizable");D.ghost&&D.ghost.css({position:"relative",height:D.size.height,width:D.size.width});},stop:function(){var D=C(this).data("resizable");D.ghost&&D.helper&&D.helper.get(0).removeChild(D.ghost.get(0));}});C.ui.plugin.add("resizable","grid",{resize:function(){var D=C(this).data("resizable"),E=D.options,J=D.size,I=D.originalSize,G=D.originalPosition,H=D.axis;E.grid=typeof E.grid=="number"?[E.grid,E.grid]:E.grid;var F=Math.round((J.width-I.width)/(E.grid[0]||1))*(E.grid[0]||1);E=Math.round((J.height-I.height)/(E.grid[1]||1))*(E.grid[1]||1);if(/^(se|s|e)$/.test(H)){D.size.width=I.width+F;D.size.height=I.height+E;}else{if(/^(ne)$/.test(H)){D.size.width=I.width+F;D.size.height=I.height+E;D.position.top=G.top-E;}else{if(/^(sw)$/.test(H)){D.size.width=I.width+F;D.size.height=I.height+E;}else{D.size.width=I.width+F;D.size.height=I.height+E;D.position.top=G.top-E;}D.position.left=G.left-F;}}}});var A=function(D){return parseInt(D,10)||0;},B=function(D){return !isNaN(parseInt(D,10));};})(jQuery);(function(A){var D,B=function(E){A(":ui-button",E.target.form).each(function(){var F=A(this).data("button");setTimeout(function(){F.refresh();},1);});},C=function(E){var H=E.name,G=E.form,F=A([]);if(H){F=G?A(G).find("[name='"+H+"']"):A("[name='"+H+"']",E.ownerDocument).filter(function(){return !this.form;});}return F;};A.widget("ui.button",{options:{text:true,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",B);this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var E=this,H=this.options,G=this.type==="checkbox"||this.type==="radio",F="ui-state-hover"+(!G?" ui-state-active":"");if(H.label===null){H.label=this.buttonElement.html();}if(this.element.is(":disabled")){H.disabled=true;}this.buttonElement.addClass("ui-button ui-widget ui-state-default ui-corner-all").attr("role","button").bind("mouseenter.button",function(){if(!H.disabled){A(this).addClass("ui-state-hover");this===D&&A(this).addClass("ui-state-active");}}).bind("mouseleave.button",function(){H.disabled||A(this).removeClass(F);}).bind("focus.button",function(){A(this).addClass("ui-state-focus");}).bind("blur.button",function(){A(this).removeClass("ui-state-focus");});G&&this.element.bind("change.button",function(){E.refresh();});if(this.type==="checkbox"){this.buttonElement.bind("click.button",function(){if(H.disabled){return false;}A(this).toggleClass("ui-state-active");E.buttonElement.attr("aria-pressed",E.element[0].checked);});}else{if(this.type==="radio"){this.buttonElement.bind("click.button",function(){if(H.disabled){return false;}A(this).addClass("ui-state-active");E.buttonElement.attr("aria-pressed",true);var I=E.element[0];C(I).not(I).map(function(){return A(this).button("widget")[0];}).removeClass("ui-state-active").attr("aria-pressed",false);});}else{this.buttonElement.bind("mousedown.button",function(){if(H.disabled){return false;}A(this).addClass("ui-state-active");D=this;A(document).one("mouseup",function(){D=null;});}).bind("mouseup.button",function(){if(H.disabled){return false;}A(this).removeClass("ui-state-active");}).bind("keydown.button",function(I){if(H.disabled){return false;}if(I.keyCode==A.ui.keyCode.SPACE||I.keyCode==A.ui.keyCode.ENTER){A(this).addClass("ui-state-active");}}).bind("keyup.button",function(){A(this).removeClass("ui-state-active");});this.buttonElement.is("a")&&this.buttonElement.keyup(function(I){I.keyCode===A.ui.keyCode.SPACE&&A(this).click();});}}this._setOption("disabled",H.disabled);},_determineButtonType:function(){this.type=this.element.is(":checkbox")?"checkbox":this.element.is(":radio")?"radio":this.element.is("input")?"input":"button";if(this.type==="checkbox"||this.type==="radio"){this.buttonElement=this.element.parents().last().find("[for="+this.element.attr("id")+"]");this.element.addClass("ui-helper-hidden-accessible");var E=this.element.is(":checked");E&&this.buttonElement.addClass("ui-state-active");this.buttonElement.attr("aria-pressed",E);}else{this.buttonElement=this.element;}},widget:function(){return this.buttonElement;},destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-state-hover ui-state-active ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon ui-button-text-only").removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());this.hasTitle||this.buttonElement.removeAttr("title");A.Widget.prototype.destroy.call(this);},_setOption:function(E,F){A.Widget.prototype._setOption.apply(this,arguments);if(E==="disabled"){F?this.element.attr("disabled",true):this.element.removeAttr("disabled");}this._resetButton();},refresh:function(){var E=this.element.is(":disabled");E!==this.options.disabled&&this._setOption("disabled",E);if(this.type==="radio"){C(this.element[0]).each(function(){A(this).is(":checked")?A(this).button("widget").addClass("ui-state-active").attr("aria-pressed",true):A(this).button("widget").removeClass("ui-state-active").attr("aria-pressed",false);});}else{if(this.type==="checkbox"){this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed",true):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed",false);}}},_resetButton:function(){if(this.type==="input"){this.options.label&&this.element.val(this.options.label);}else{var E=this.buttonElement,H=A("<span></span>").addClass("ui-button-text").html(this.options.label).appendTo(E.empty()).text(),G=this.options.icons,F=G.primary&&G.secondary;if(G.primary||G.secondary){E.addClass("ui-button-text-icon"+(F?"s":""));G.primary&&E.prepend("<span class='ui-button-icon-primary ui-icon "+G.primary+"'></span>");G.secondary&&E.append("<span class='ui-button-icon-secondary ui-icon "+G.secondary+"'></span>");if(!this.options.text){E.addClass(F?"ui-button-icons-only":"ui-button-icon-only").removeClass("ui-button-text-icons ui-button-text-icon");this.hasTitle||E.attr("title",H);}}else{E.addClass("ui-button-text-only");}}}});A.widget("ui.buttonset",{_create:function(){this.element.addClass("ui-buttonset");
this._init();},_init:function(){this.refresh();},_setOption:function(E,F){E==="disabled"&&this.buttons.button("option",E,F);A.Widget.prototype._setOption.apply(this,arguments);},refresh:function(){this.buttons=this.element.find(":button, :submit, :reset, :checkbox, :radio, a, :data(button)").filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return A(this).button("widget")[0];}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass("ui-corner-left").end().filter(":last").addClass("ui-corner-right").end().end();},destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return A(this).button("widget")[0];}).removeClass("ui-corner-left ui-corner-right").end().button("destroy");A.Widget.prototype.destroy.call(this);}});})(jQuery);(function(C){var B=0,A=0;C.widget("ui.tabs",{options:{add:null,ajaxOptions:null,cache:false,cookie:null,collapsible:false,disable:null,disabled:[],enable:null,event:"click",fx:null,idPrefix:"ui-tabs-",load:null,panelTemplate:"<div></div>",remove:null,select:null,show:null,spinner:"<em>Loading&#8230;</em>",tabTemplate:'<li><a href="#{href}"><span>#{label}</span></a></li>'},_create:function(){this._tabify(true);},_setOption:function(E,D){if(E=="selected"){this.options.collapsible&&D==this.options.selected||this.select(D);}else{this.options[E]=D;this._tabify();}},_tabId:function(D){return D.title&&D.title.replace(/\s/g,"_").replace(/[^A-Za-z0-9\-_:\.]/g,"")||this.options.idPrefix+ ++B;},_sanitizeSelector:function(D){return D.replace(/:/g,"\\:");},_cookie:function(){var D=this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+ ++A);return C.cookie.apply(null,[D].concat(C.makeArray(arguments)));},_ui:function(E,D){return{tab:E,panel:D,index:this.anchors.index(E)};},_cleanup:function(){this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function(){var D=C(this);D.html(D.data("label.tabs")).removeData("label.tabs");});},_tabify:function(M){function L(P,Q){P.css({display:""});!C.support.opacity&&Q.opacity&&P[0].style.removeAttribute("filter");}this.list=this.element.find("ol,ul").eq(0);this.lis=C("li:has(a[href])",this.list);this.anchors=this.lis.map(function(){return C("a",this)[0];});this.panels=C([]);var O=this,N=this.options,K=/^#.+/;this.anchors.each(function(R,S){var Q=C(S).attr("href"),P=Q.split("#")[0],T;if(P&&(P===location.toString().split("#")[0]||(T=C("base")[0])&&P===T.href)){Q=S.hash;S.href=Q;}if(K.test(Q)){O.panels=O.panels.add(O._sanitizeSelector(Q));}else{if(Q!="#"){C.data(S,"href.tabs",Q);C.data(S,"load.tabs",Q.replace(/#.*$/,""));Q=O._tabId(S);S.href="#"+Q;S=C("#"+Q);if(!S.length){S=C(N.panelTemplate).attr("id",Q).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(O.panels[R-1]||O.list);S.data("destroy.tabs",true);}O.panels=O.panels.add(S);}else{N.disabled.push(R);}}});if(M){this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.lis.addClass("ui-state-default ui-corner-top");this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom");if(N.selected===undefined){location.hash&&this.anchors.each(function(P,Q){if(Q.hash==location.hash){N.selected=P;return false;}});if(typeof N.selected!="number"&&N.cookie){N.selected=parseInt(O._cookie(),10);}if(typeof N.selected!="number"&&this.lis.filter(".ui-tabs-selected").length){N.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"));}N.selected=N.selected||(this.lis.length?0:-1);}else{if(N.selected===null){N.selected=-1;}}N.selected=N.selected>=0&&this.anchors[N.selected]||N.selected<0?N.selected:0;N.disabled=C.unique(N.disabled.concat(C.map(this.lis.filter(".ui-state-disabled"),function(P){return O.lis.index(P);}))).sort();C.inArray(N.selected,N.disabled)!=-1&&N.disabled.splice(C.inArray(N.selected,N.disabled),1);this.panels.addClass("ui-tabs-hide");this.lis.removeClass("ui-tabs-selected ui-state-active");if(N.selected>=0&&this.anchors.length){this.panels.eq(N.selected).removeClass("ui-tabs-hide");this.lis.eq(N.selected).addClass("ui-tabs-selected ui-state-active");O.element.queue("tabs",function(){O._trigger("show",null,O._ui(O.anchors[N.selected],O.panels[N.selected]));});this.load(N.selected);}C(window).bind("unload",function(){O.lis.add(O.anchors).unbind(".tabs");O.lis=O.anchors=O.panels=null;});}else{N.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"));}this.element[N.collapsible?"addClass":"removeClass"]("ui-tabs-collapsible");N.cookie&&this._cookie(N.selected,N.cookie);M=0;for(var J;J=this.lis[M];M++){C(J)[C.inArray(M,N.disabled)!=-1&&!C(J).hasClass("ui-tabs-selected")?"addClass":"removeClass"]("ui-state-disabled");}N.cache===false&&this.anchors.removeData("cache.tabs");this.lis.add(this.anchors).unbind(".tabs");if(N.event!="mouseover"){var I=function(P,Q){Q.is(":not(.ui-state-disabled)")&&Q.addClass("ui-state-"+P);},G=function(P,Q){Q.removeClass("ui-state-"+P);};this.lis.bind("mouseover.tabs",function(){I("hover",C(this));});this.lis.bind("mouseout.tabs",function(){G("hover",C(this));});this.anchors.bind("focus.tabs",function(){I("focus",C(this).closest("li"));});this.anchors.bind("blur.tabs",function(){G("focus",C(this).closest("li"));});}var H,F;if(N.fx){if(C.isArray(N.fx)){H=N.fx[0];F=N.fx[1];}else{H=F=N.fx;}}var E=F?function(P,Q){C(P).closest("li").addClass("ui-tabs-selected ui-state-active");Q.hide().removeClass("ui-tabs-hide").animate(F,F.duration||"normal",function(){L(Q,F);O._trigger("show",null,O._ui(P,Q[0]));});}:function(P,Q){C(P).closest("li").addClass("ui-tabs-selected ui-state-active");Q.removeClass("ui-tabs-hide");O._trigger("show",null,O._ui(P,Q[0]));},D=H?function(P,Q){Q.animate(H,H.duration||"normal",function(){O.lis.removeClass("ui-tabs-selected ui-state-active");Q.addClass("ui-tabs-hide");L(Q,H);O.element.dequeue("tabs");});}:function(P,Q){O.lis.removeClass("ui-tabs-selected ui-state-active");Q.addClass("ui-tabs-hide");O.element.dequeue("tabs");};this.anchors.bind(N.event+".tabs",function(){var R=this,S=C(this).closest("li"),Q=O.panels.filter(":not(.ui-tabs-hide)"),P=C(O._sanitizeSelector(this.hash));if(S.hasClass("ui-tabs-selected")&&!N.collapsible||S.hasClass("ui-state-disabled")||S.hasClass("ui-state-processing")||O._trigger("select",null,O._ui(this,P[0]))===false){this.blur();return false;}N.selected=O.anchors.index(this);O.abort();if(N.collapsible){if(S.hasClass("ui-tabs-selected")){N.selected=-1;N.cookie&&O._cookie(N.selected,N.cookie);O.element.queue("tabs",function(){D(R,Q);}).dequeue("tabs");this.blur();return false;}else{if(!Q.length){N.cookie&&O._cookie(N.selected,N.cookie);O.element.queue("tabs",function(){E(R,P);});O.load(O.anchors.index(this));this.blur();return false;}}}N.cookie&&O._cookie(N.selected,N.cookie);if(P.length){Q.length&&O.element.queue("tabs",function(){D(R,Q);});O.element.queue("tabs",function(){E(R,P);});O.load(O.anchors.index(this));}else{throw"jQuery UI Tabs: Mismatching fragment identifier.";}C.browser.msie&&this.blur();});this.anchors.bind("click.tabs",function(){return false;});},destroy:function(){var D=this.options;this.abort();this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs");this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.anchors.each(function(){var F=C.data(this,"href.tabs");if(F){this.href=F;}var E=C(this).unbind(".tabs");C.each(["href","load","cache"],function(G,H){E.removeData(H+".tabs");});});this.lis.unbind(".tabs").add(this.panels).each(function(){C.data(this,"destroy.tabs")?C(this).remove():C(this).removeClass("ui-state-default ui-corner-top ui-tabs-selected ui-state-active ui-state-hover ui-state-focus ui-state-disabled ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide");});D.cookie&&this._cookie(null,D.cookie);
return this;},add:function(I,H,E){if(E===undefined){E=this.anchors.length;}var D=this,G=this.options;H=C(G.tabTemplate.replace(/#\{href\}/g,I).replace(/#\{label\}/g,H));I=!I.indexOf("#")?I.replace("#",""):this._tabId(C("a",H)[0]);H.addClass("ui-state-default ui-corner-top").data("destroy.tabs",true);var F=C("#"+I);F.length||(F=C(G.panelTemplate).attr("id",I).data("destroy.tabs",true));F.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide");if(E>=this.lis.length){H.appendTo(this.list);F.appendTo(this.list[0].parentNode);}else{H.insertBefore(this.lis[E]);F.insertBefore(this.panels[E]);}G.disabled=C.map(G.disabled,function(J){return J>=E?++J:J;});this._tabify();if(this.anchors.length==1){G.selected=0;H.addClass("ui-tabs-selected ui-state-active");F.removeClass("ui-tabs-hide");this.element.queue("tabs",function(){D._trigger("show",null,D._ui(D.anchors[0],D.panels[0]));});this.load(0);}this._trigger("add",null,this._ui(this.anchors[E],this.panels[E]));return this;},remove:function(G){var F=this.options,E=this.lis.eq(G).remove(),D=this.panels.eq(G).remove();if(E.hasClass("ui-tabs-selected")&&this.anchors.length>1){this.select(G+(G+1<this.anchors.length?1:-1));}F.disabled=C.map(C.grep(F.disabled,function(H){return H!=G;}),function(H){return H>=G?--H:H;});this._tabify();this._trigger("remove",null,this._ui(E.find("a")[0],D[0]));return this;},enable:function(E){var D=this.options;if(C.inArray(E,D.disabled)!=-1){this.lis.eq(E).removeClass("ui-state-disabled");D.disabled=C.grep(D.disabled,function(F){return F!=E;});this._trigger("enable",null,this._ui(this.anchors[E],this.panels[E]));return this;}},disable:function(E){var D=this.options;if(E!=D.selected){this.lis.eq(E).addClass("ui-state-disabled");D.disabled.push(E);D.disabled.sort();this._trigger("disable",null,this._ui(this.anchors[E],this.panels[E]));}return this;},select:function(D){if(typeof D=="string"){D=this.anchors.index(this.anchors.filter("[href$="+D+"]"));}else{if(D===null){D=-1;}}if(D==-1&&this.options.collapsible){D=this.options.selected;}this.anchors.eq(D).trigger(this.options.event+".tabs");return this;},load:function(I){var H=this,E=this.options,D=this.anchors.eq(I)[0],G=C.data(D,"load.tabs");this.abort();if(!G||this.element.queue("tabs").length!==0&&C.data(D,"cache.tabs")){this.element.dequeue("tabs");}else{this.lis.eq(I).addClass("ui-state-processing");if(E.spinner){var F=C("span",D);F.data("label.tabs",F.html()).html(E.spinner);}this.xhr=C.ajax(C.extend({},E.ajaxOptions,{url:G,success:function(K,L){C(H._sanitizeSelector(D.hash)).html(K);H._cleanup();E.cache&&C.data(D,"cache.tabs",true);H._trigger("load",null,H._ui(H.anchors[I],H.panels[I]));try{E.ajaxOptions.success(K,L);}catch(J){}},error:function(K,L){H._cleanup();H._trigger("load",null,H._ui(H.anchors[I],H.panels[I]));try{E.ajaxOptions.error(K,L,I,D);}catch(J){}}}));H.element.dequeue("tabs");return this;}},abort:function(){this.element.queue([]);this.panels.stop(false,true);this.element.queue("tabs",this.element.queue("tabs").splice(-2,2));if(this.xhr){this.xhr.abort();delete this.xhr;}this._cleanup();return this;},url:function(E,D){this.anchors.eq(E).removeData("cache.tabs").data("load.tabs",D);return this;},length:function(){return this.anchors.length;}});C.extend(C.ui.tabs,{version:"1.8.1"});C.extend(C.ui.tabs.prototype,{rotation:null,rotate:function(H,G){var E=this,D=this.options,F=E._rotate||(E._rotate=function(I){clearTimeout(E.rotation);E.rotation=setTimeout(function(){var J=D.selected;E.select(++J<E.anchors.length?J:0);},H);I&&I.stopPropagation();});G=E._unrotate||(E._unrotate=!G?function(I){I.clientX&&E.rotate(null);}:function(){t=D.selected;F();});if(H){this.element.bind("tabsshow",F);this.anchors.bind(D.event+".tabs",G);F();}else{clearTimeout(E.rotation);this.element.unbind("tabsshow",F);this.anchors.unbind(D.event+".tabs",G);delete this._rotate;delete this._unrotate;}return this;}});})(jQuery);(function(A){A.widget("ui.dialog",{options:{autoOpen:true,buttons:{},closeOnEscape:true,closeText:"close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:false,maxWidth:false,minHeight:150,minWidth:150,modal:false,position:"center",resizable:true,show:null,stack:true,title:"",width:300,zIndex:1000},_create:function(){this.originalTitle=this.element.attr("title");var C=this,B=C.options,H=B.title||C.originalTitle||"&#160;",G=A.ui.dialog.getTitleId(C.element),E=(C.uiDialog=A("<div></div>")).appendTo(document.body).hide().addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+B.dialogClass).css({zIndex:B.zIndex}).attr("tabIndex",-1).css("outline",0).keydown(function(I){if(B.closeOnEscape&&I.keyCode&&I.keyCode===A.ui.keyCode.ESCAPE){C.close(I);I.preventDefault();}}).attr({role:"dialog","aria-labelledby":G}).mousedown(function(I){C.moveToTop(false,I);});C.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(E);var F=(C.uiDialogTitlebar=A("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(E),D=A('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role","button").hover(function(){D.addClass("ui-state-hover");},function(){D.removeClass("ui-state-hover");}).focus(function(){D.addClass("ui-state-focus");}).blur(function(){D.removeClass("ui-state-focus");}).click(function(I){C.close(I);return false;}).appendTo(F);(C.uiDialogTitlebarCloseText=A("<span></span>")).addClass("ui-icon ui-icon-closethick").text(B.closeText).appendTo(D);A("<span></span>").addClass("ui-dialog-title").attr("id",G).html(H).prependTo(F);if(A.isFunction(B.beforeclose)&&!A.isFunction(B.beforeClose)){B.beforeClose=B.beforeclose;}F.find("*").add(F).disableSelection();B.draggable&&A.fn.draggable&&C._makeDraggable();B.resizable&&A.fn.resizable&&C._makeResizable();C._createButtons(B.buttons);C._isOpen=false;A.fn.bgiframe&&E.bgiframe();},_init:function(){this.options.autoOpen&&this.open();},destroy:function(){var B=this;B.overlay&&B.overlay.destroy();B.uiDialog.hide();B.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");B.uiDialog.remove();B.originalTitle&&B.element.attr("title",B.originalTitle);return B;},widget:function(){return this.uiDialog;},close:function(C){var B=this,D;if(false!==B._trigger("beforeClose",C)){B.overlay&&B.overlay.destroy();B.uiDialog.unbind("keypress.ui-dialog");B._isOpen=false;if(B.options.hide){B.uiDialog.hide(B.options.hide,function(){B._trigger("close",C);});}else{B.uiDialog.hide();B._trigger("close",C);}A.ui.dialog.overlay.resize();if(B.options.modal){D=0;A(".ui-dialog").each(function(){if(this!==B.uiDialog[0]){D=Math.max(D,A(this).css("z-index"));}});A.ui.dialog.maxZ=D;}return B;}},isOpen:function(){return this._isOpen;},moveToTop:function(C,B){var E=this,D=E.options;if(D.modal&&!C||!D.stack&&!D.modal){return E._trigger("focus",B);}if(D.zIndex>A.ui.dialog.maxZ){A.ui.dialog.maxZ=D.zIndex;}if(E.overlay){A.ui.dialog.maxZ+=1;E.overlay.$el.css("z-index",A.ui.dialog.overlay.maxZ=A.ui.dialog.maxZ);}C={scrollTop:E.element.attr("scrollTop"),scrollLeft:E.element.attr("scrollLeft")};A.ui.dialog.maxZ+=1;E.uiDialog.css("z-index",A.ui.dialog.maxZ);E.element.attr(C);E._trigger("focus",B);return E;},open:function(){if(!this._isOpen){var C=this,B=C.options,D=C.uiDialog;C.overlay=B.modal?new A.ui.dialog.overlay(C):null;D.next().length&&D.appendTo("body");C._size();C._position(B.position);D.show(B.show);C.moveToTop(true);B.modal&&D.bind("keypress.ui-dialog",function(G){if(G.keyCode===A.ui.keyCode.TAB){var E=A(":tabbable",this),F=E.filter(":first");E=E.filter(":last");if(G.target===E[0]&&!G.shiftKey){F.focus(1);return false;}else{if(G.target===F[0]&&G.shiftKey){E.focus(1);return false;}}}});A([]).add(D.find(".ui-dialog-content :tabbable:first")).add(D.find(".ui-dialog-buttonpane :tabbable:first")).add(D).filter(":first").focus();C._trigger("open");C._isOpen=true;return C;}},_createButtons:function(C){var B=this,E=false,D=A("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");
B.uiDialog.find(".ui-dialog-buttonpane").remove();typeof C==="object"&&C!==null&&A.each(C,function(){return !(E=true);});if(E){A.each(C,function(F,G){F=A('<button type="button"></button>').text(F).click(function(){G.apply(B.element[0],arguments);}).appendTo(D);A.fn.button&&F.button();});D.appendTo(B.uiDialog);}},_makeDraggable:function(){function C(G){return{position:G.position,offset:G.offset};}var B=this,F=B.options,E=A(document),D;B.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(H,G){D=F.height==="auto"?"auto":A(this).height();A(this).height(A(this).height()).addClass("ui-dialog-dragging");B._trigger("dragStart",H,C(G));},drag:function(H,G){B._trigger("drag",H,C(G));},stop:function(H,G){F.position=[G.position.left-E.scrollLeft(),G.position.top-E.scrollTop()];A(this).removeClass("ui-dialog-dragging").height(D);B._trigger("dragStop",H,C(G));A.ui.dialog.overlay.resize();}});},_makeResizable:function(C){function B(G){return{originalPosition:G.originalPosition,originalSize:G.originalSize,position:G.position,size:G.size};}C=C===undefined?this.options.resizable:C;var F=this,E=F.options,D=F.uiDialog.css("position");C=typeof C==="string"?C:"n,e,s,w,se,sw,ne,nw";F.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:F.element,maxWidth:E.maxWidth,maxHeight:E.maxHeight,minWidth:E.minWidth,minHeight:F._minHeight(),handles:C,start:function(H,G){A(this).addClass("ui-dialog-resizing");F._trigger("resizeStart",H,B(G));},resize:function(H,G){F._trigger("resize",H,B(G));},stop:function(H,G){A(this).removeClass("ui-dialog-resizing");E.height=A(this).height();E.width=A(this).width();F._trigger("resizeStop",H,B(G));A.ui.dialog.overlay.resize();}}).css("position",D).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se");},_minHeight:function(){var B=this.options;return B.height==="auto"?B.minHeight:Math.min(B.minHeight,B.height);},_position:function(C){var B=[],D=[0,0];C=C||A.ui.dialog.prototype.options.position;if(typeof C==="string"||typeof C==="object"&&"0" in C){B=C.split?C.split(" "):[C[0],C[1]];if(B.length===1){B[1]=B[0];}A.each(["left","top"],function(F,E){if(+B[F]===B[F]){D[F]=B[F];B[F]=E;}});}else{if(typeof C==="object"){if("left" in C){B[0]="left";D[0]=C.left;}else{if("right" in C){B[0]="right";D[0]=-C.right;}}if("top" in C){B[1]="top";D[1]=C.top;}else{if("bottom" in C){B[1]="bottom";D[1]=-C.bottom;}}}}(C=this.uiDialog.is(":visible"))||this.uiDialog.show();this.uiDialog.css({top:0,left:0}).position({my:B.join(" "),at:B.join(" "),offset:D.join(" "),of:window,collision:"fit",using:function(F){var E=A(this).css(F).offset().top;E<0&&A(this).css("top",F.top-E);}});C||this.uiDialog.hide();},_setOption:function(C,B){var G=this,F=G.uiDialog,D=F.is(":data(resizable)"),E=false;switch(C){case"beforeclose":C="beforeClose";break;case"buttons":G._createButtons(B);break;case"closeText":G.uiDialogTitlebarCloseText.text(""+B);break;case"dialogClass":F.removeClass(G.options.dialogClass).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+B);break;case"disabled":B?F.addClass("ui-dialog-disabled"):F.removeClass("ui-dialog-disabled");break;case"draggable":B?G._makeDraggable():F.draggable("destroy");break;case"height":E=true;break;case"maxHeight":D&&F.resizable("option","maxHeight",B);E=true;break;case"maxWidth":D&&F.resizable("option","maxWidth",B);E=true;break;case"minHeight":D&&F.resizable("option","minHeight",B);E=true;break;case"minWidth":D&&F.resizable("option","minWidth",B);E=true;break;case"position":G._position(B);break;case"resizable":D&&!B&&F.resizable("destroy");D&&typeof B==="string"&&F.resizable("option","handles",B);!D&&B!==false&&G._makeResizable(B);break;case"title":A(".ui-dialog-title",G.uiDialogTitlebar).html(""+(B||"&#160;"));break;case"width":E=true;break;}A.Widget.prototype._setOption.apply(G,arguments);E&&G._size();},_size:function(){var C=this.options,B;this.element.css({width:"auto",minHeight:0,height:0});B=this.uiDialog.css({height:"auto",width:C.width}).height();this.element.css(C.height==="auto"?{minHeight:Math.max(C.minHeight-B,0),height:"auto"}:{minHeight:0,height:Math.max(C.height-B,0)}).show();this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight());}});A.extend(A.ui.dialog,{version:"1.8.1",uuid:0,maxZ:0,getTitleId:function(B){B=B.attr("id");if(!B){this.uuid+=1;B=this.uuid;}return"ui-dialog-title-"+B;},overlay:function(B){this.$el=A.ui.dialog.overlay.create(B);}});A.extend(A.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:A.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(B){return B+".dialog-overlay";}).join(" "),create:function(C){if(this.instances.length===0){setTimeout(function(){A.ui.dialog.overlay.instances.length&&A(document).bind(A.ui.dialog.overlay.events,function(D){return A(D.target).zIndex()>=A.ui.dialog.overlay.maxZ;});},1);A(document).bind("keydown.dialog-overlay",function(D){if(C.options.closeOnEscape&&D.keyCode&&D.keyCode===A.ui.keyCode.ESCAPE){C.close(D);D.preventDefault();}});A(window).bind("resize.dialog-overlay",A.ui.dialog.overlay.resize);}var B=(this.oldInstances.pop()||A("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),height:this.height()});A.fn.bgiframe&&B.bgiframe();this.instances.push(B);return B;},destroy:function(C){this.oldInstances.push(this.instances.splice(A.inArray(C,this.instances),1)[0]);this.instances.length===0&&A([document,window]).unbind(".dialog-overlay");C.remove();var B=0;A.each(this.instances,function(){B=Math.max(B,this.css("z-index"));});this.maxZ=B;},height:function(){var C,B;if(A.browser.msie&&A.browser.version<7){C=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);B=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);return C<B?A(window).height()+"px":C+"px";}else{return A(document).height()+"px";}},width:function(){var C,B;if(A.browser.msie&&A.browser.version<7){C=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth);B=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth);return C<B?A(window).width()+"px":C+"px";}else{return A(document).width()+"px";}},resize:function(){var B=A([]);A.each(A.ui.dialog.overlay.instances,function(){B=B.add(this);});B.css({width:0,height:0}).css({width:A.ui.dialog.overlay.width(),height:A.ui.dialog.overlay.height()});}});A.extend(A.ui.dialog.overlay.prototype,{destroy:function(){A.ui.dialog.overlay.destroy(this.$el);}});})(jQuery);(function(A){var B=A.fn.val;A.iHint=function(E,C){var D=A(E);E.iHint={"text":"iHint Text","className":"iHint-default"};A.extend(E.iHint,C);D.blur(function(){if(!B.call(D)){D.addClass(E.iHint.className);B.call(D,E.iHint.text);}}).focus(function(){if(B.call(D)==E.iHint.text){D.removeClass(E.iHint.className);B.call(D,"");}}).trigger("blur");};A.fn.iHint=function(C){return this.each(function(){new A.iHint(this,C);});};A.fn.val=function(C){if(this[0]&&this[0].iHint){if(typeof (C)=="undefined"){if(B.apply(this,arguments)==this[0].iHint.text){return"";}}else{this.removeClass(this[0].iHint.className);return B.apply(this,arguments);}}return B.apply(this,arguments);};})(jQuery);(function(Am){var Ad,AY,AW,Aj,AO,Ah,AU,AR,AQ,Ab=0,Ak={},Aa=[],Ac=0,Al={},Ag=[],AN=null,AZ=new Image,AL=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,AA=/[^\.]\.(swf)\s*$/i,AK,AJ=1,Af,Ae,Ai=false,AV=Am.extend(Am("<div/>")[0],{prop:0}),AX=0,AD=!Am.support.opacity&&!window.XMLHttpRequest,AI=function(){AY.hide();AZ.onerror=AZ.onload=null;AN&&AN.abort();Ad.empty();},AC=function(){Am.fancybox('<p id="fancybox_error">The requested content cannot be loaded.<br />Please try again later.</p>',{scrolling:"no",padding:20,transitionIn:"none",transitionOut:"none"});},AH=function(){return[Am(window).width(),Am(window).height(),Am(document).scrollLeft(),Am(document).scrollTop()];},w=function(){var B=AH(),G={},E=Al.margin,F=Al.autoScale,C=(20+E)*2,A=(20+E)*2,D=Al.padding*2;
if(Al.width.toString().indexOf("%")>-1){G.width=B[0]*parseFloat(Al.width)/100-40;F=false;}else{G.width=Al.width+D;}if(Al.height.toString().indexOf("%")>-1){G.height=B[1]*parseFloat(Al.height)/100-40;F=false;}else{G.height=Al.height+D;}if(F&&(G.width>B[0]-C||G.height>B[1]-A)){if(Ak.type=="image"||Ak.type=="swf"){C+=D;A+=D;F=Math.min(Math.min(B[0]-C,Al.width)/Al.width,Math.min(B[1]-A,Al.height)/Al.height);G.width=Math.round(F*(G.width-D))+D;G.height=Math.round(F*(G.height-D))+D;}else{G.width=Math.min(G.width,B[0]-C);G.height=Math.min(G.height,B[1]-A);}}G.top=B[3]+(B[1]-(G.height+40))*0.5;G.left=B[2]+(B[0]-(G.width+40))*0.5;if(Al.autoScale===false){G.top=Math.max(B[3]+E,G.top);G.left=Math.max(B[2]+E,G.left);}return G;},r=function(A){if(A&&A.length){switch(Al.titlePosition){case"inside":return A;case"over":return'<span id="fancybox-title-over">'+A+"</span>";default:return'<span id="fancybox-title-wrap"><span id="fancybox-title-left"></span><span id="fancybox-title-main">'+A+'</span><span id="fancybox-title-right"></span></span>';}}return false;},o=function(){var A=Al.title,C=Ae.width-Al.padding*2,B="fancybox-title-"+Al.titlePosition;Am("#fancybox-title").remove();AX=0;if(Al.titleShow!==false){A=Am.isFunction(Al.titleFormat)?Al.titleFormat(A,Ag,Ac,Al):r(A);if(!(!A||A==="")){Am('<div id="fancybox-title" class="'+B+'" />').css({width:C,paddingLeft:Al.padding,paddingRight:Al.padding}).html(A).appendTo("body");switch(Al.titlePosition){case"inside":AX=Am("#fancybox-title").outerHeight(true)-Al.padding;Ae.height+=AX;break;case"over":Am("#fancybox-title").css("bottom",Al.padding);break;default:Am("#fancybox-title").css("bottom",Am("#fancybox-title").outerHeight(true)*-1);break;}Am("#fancybox-title").appendTo(AO).hide();}}},f=function(){Am(document).unbind("keydown.fb").bind("keydown.fb",function(A){if(A.keyCode==27&&Al.enableEscapeButton){A.preventDefault();Am.fancybox.close();}else{if(A.keyCode==37){A.preventDefault();Am.fancybox.prev();}else{if(A.keyCode==39){A.preventDefault();Am.fancybox.next();}}}});if(Am.fn.mousewheel){Aj.unbind("mousewheel.fb");Ag.length>1&&Aj.bind("mousewheel.fb",function(A,B){A.preventDefault();Ai||B===0||(B>0?Am.fancybox.prev():Am.fancybox.next());});}if(Al.showNavArrows){if(Al.cyclic&&Ag.length>1||Ac!==0){AR.show();}if(Al.cyclic&&Ag.length>1||Ac!=Ag.length-1){AQ.show();}}},d=function(){var A,B;if(Ag.length-1>Ac){A=Ag[Ac+1].href;if(typeof A!=="undefined"&&A.match(AL)){B=new Image;B.src=A;}}if(Ac>0){A=Ag[Ac-1].href;if(typeof A!=="undefined"&&A.match(AL)){B=new Image;B.src=A;}}},AG=function(){Ah.css("overflow",Al.scrolling=="auto"?Al.type=="image"||Al.type=="iframe"||Al.type=="swf"?"hidden":"auto":Al.scrolling=="yes"?"auto":"visible");if(!Am.support.opacity){Ah.get(0).style.removeAttribute("filter");Aj.get(0).style.removeAttribute("filter");}Am("#fancybox-title").show();Al.hideOnContentClick&&Ah.one("click",Am.fancybox.close);Al.hideOnOverlayClick&&AW.one("click",Am.fancybox.close);Al.showCloseButton&&AU.show();f();Am(window).bind("resize.fb",Am.fancybox.center);Al.centerOnScroll?Am(window).bind("scroll.fb",Am.fancybox.center):Am(window).unbind("scroll.fb");Am.isFunction(Al.onComplete)&&Al.onComplete(Ag,Ac,Al);Ai=false;d();},AF=function(A){var E=Math.round(Af.width+(Ae.width-Af.width)*A),C=Math.round(Af.height+(Ae.height-Af.height)*A),D=Math.round(Af.top+(Ae.top-Af.top)*A),B=Math.round(Af.left+(Ae.left-Af.left)*A);Aj.css({width:E+"px",height:C+"px",top:D+"px",left:B+"px"});E=Math.max(E-Al.padding*2,0);C=Math.max(C-(Al.padding*2+AX*A),0);Ah.css({width:E+"px",height:C+"px"});if(typeof Ae.opacity!=="undefined"){Aj.css("opacity",A<0.5?0.5:A);}},a=function(A){var B=A.offset();B.top+=parseFloat(A.css("paddingTop"))||0;B.left+=parseFloat(A.css("paddingLeft"))||0;B.top+=parseFloat(A.css("border-top-width"))||0;B.left+=parseFloat(A.css("border-left-width"))||0;B.width=A.width();B.height=A.height();return B;},AB=function(){var A=Ak.orig?Am(Ak.orig):false,B={};if(A&&A.length){A=a(A);B={width:A.width+Al.padding*2,height:A.height+Al.padding*2,top:A.top-Al.padding-20,left:A.left-Al.padding-20};}else{A=AH();B={width:1,height:1,top:A[3]+A[1]*0.5,left:A[2]+A[0]*0.5};}return B;},AE=function(){AY.hide();if(Aj.is(":visible")&&Am.isFunction(Al.onCleanup)){if(Al.onCleanup(Ag,Ac,Al)===false){Am.event.trigger("fancybox-cancel");Ai=false;return ;}}Ag=Aa;Ac=Ab;Al=Ak;Ah.get(0).scrollTop=0;Ah.get(0).scrollLeft=0;if(Al.overlayShow){AD&&Am("select:not(#fancybox-tmp select)").filter(function(){return this.style.visibility!=="hidden";}).css({visibility:"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit";});AW.css({"background-color":Al.overlayColor,opacity:Al.overlayOpacity}).unbind().show();}Ae=w();o();if(Aj.is(":visible")){Am(AU.add(AR).add(AQ)).hide();var A=Aj.position(),B;Af={top:A.top,left:A.left,width:Aj.width(),height:Aj.height()};B=Af.width==Ae.width&&Af.height==Ae.height;Ah.fadeOut(Al.changeFade,function(){var C=function(){Ah.html(Ad.contents()).fadeIn(Al.changeFade,AG);};Am.event.trigger("fancybox-change");Ah.empty().css("overflow","hidden");if(B){Ah.css({top:Al.padding,left:Al.padding,width:Math.max(Ae.width-Al.padding*2,1),height:Math.max(Ae.height-Al.padding*2-AX,1)});C();}else{Ah.css({top:Al.padding,left:Al.padding,width:Math.max(Af.width-Al.padding*2,1),height:Math.max(Af.height-Al.padding*2,1)});AV.prop=0;Am(AV).animate({prop:1},{duration:Al.changeSpeed,easing:Al.easingChange,step:AF,complete:C});}});}else{Aj.css("opacity",1);if(Al.transitionIn=="elastic"){Af=AB();Ah.css({top:Al.padding,left:Al.padding,width:Math.max(Af.width-Al.padding*2,1),height:Math.max(Af.height-Al.padding*2,1)}).html(Ad.contents());Aj.css(Af).show();if(Al.opacity){Ae.opacity=0;}AV.prop=0;Am(AV).animate({prop:1},{duration:Al.speedIn,easing:Al.easingIn,step:AF,complete:AG});}else{Ah.css({top:Al.padding,left:Al.padding,width:Math.max(Ae.width-Al.padding*2,1),height:Math.max(Ae.height-Al.padding*2-AX,1)}).html(Ad.contents());Aj.css(Ae).fadeIn(Al.transitionIn=="none"?0:Al.speedIn,AG);}}},AM=function(){Ad.width(Ak.width);Ad.height(Ak.height);if(Ak.width=="auto"){Ak.width=Ad.width();}if(Ak.height=="auto"){Ak.height=Ad.height();}AE();},R=function(){Ai=true;Ak.width=AZ.width;Ak.height=AZ.height;Am("<img />").attr({id:"fancybox-img",src:AZ.src,alt:Ak.title}).appendTo(Ad);AE();},AP=function(){AI();var B=Aa[Ab],F,D,E,C,A;Ak=Am.extend({},Am.fn.fancybox.defaults,typeof Am(B).data("fancybox")=="undefined"?Ak:Am(B).data("fancybox"));E=B.title||Am(B).title||Ak.title||"";if(B.nodeName&&!Ak.orig){Ak.orig=Am(B).children("img:first").length?Am(B).children("img:first"):Am(B);}if(E===""&&Ak.orig){E=Ak.orig.attr("alt");}F=B.nodeName&&/^(?:javascript|#)/i.test(B.href)?Ak.href||null:Ak.href||B.href||null;if(Ak.type){D=Ak.type;if(!F){F=Ak.content;}}else{if(Ak.content){D="html";}else{if(F){if(F.match(AL)){D="image";}else{if(F.match(AA)){D="swf";}else{if(Am(B).hasClass("iframe")){D="iframe";}else{if(F.match(/#/)){B=F.substr(F.indexOf("#"));D=Am(B).length>0?"inline":"ajax";}else{D="ajax";}}}}}else{D="inline";}}}Ak.type=D;Ak.href=F;Ak.title=E;if(Ak.autoDimensions&&Ak.type!=="iframe"&&Ak.type!=="swf"){Ak.width="auto";Ak.height="auto";}if(Ak.modal){Ak.overlayShow=true;Ak.hideOnOverlayClick=false;Ak.hideOnContentClick=false;Ak.enableEscapeButton=false;Ak.showCloseButton=false;}if(Am.isFunction(Ak.onStart)){if(Ak.onStart(Aa,Ab,Ak)===false){Ai=false;return ;}}Ad.css("padding",20+Ak.padding+Ak.margin);Am(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){Am(this).replaceWith(Ah.children());});switch(D){case"html":Ad.html(Ak.content);AM();break;case"inline":Am('<div class="fancybox-inline-tmp" />').hide().insertBefore(Am(B)).bind("fancybox-cleanup",function(){Am(this).replaceWith(Ah.children());}).bind("fancybox-cancel",function(){Am(this).replaceWith(Ad.children());});Am(B).appendTo(Ad);AM();break;case"image":Ai=false;Am.fancybox.showActivity();AZ=new Image;AZ.onerror=function(){AC();};AZ.onload=function(){AZ.onerror=null;AZ.onload=null;R();};AZ.src=F;break;case"swf":C='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+Ak.width+'" height="'+Ak.height+'"><param name="movie" value="'+F+'"></param>';
A="";Am.each(Ak.swf,function(H,G){C+='<param name="'+H+'" value="'+G+'"></param>';A+=" "+H+'="'+G+'"';});C+='<embed src="'+F+'" type="application/x-shockwave-flash" width="'+Ak.width+'" height="'+Ak.height+'"'+A+"></embed></object>";Ad.html(C);AM();break;case"ajax":B=F.split("#",2);D=Ak.ajax.data||{};if(B.length>1){F=B[0];if(typeof D=="string"){D+="&selector="+B[1];}else{D.selector=B[1];}}Ai=false;Am.fancybox.showActivity();AN=Am.ajax(Am.extend(Ak.ajax,{url:F,data:D,error:AC,success:function(G){if(AN.status==200){Ad.html(G);AM();}}}));break;case"iframe":Am('<iframe id="fancybox-frame" name="fancybox-frame'+(new Date).getTime()+'" frameborder="0" hspace="0" scrolling="'+Ak.scrolling+'" src="'+Ak.href+'"></iframe>').appendTo(Ad);AE();break;}},AT=function(){if(AY.is(":visible")){Am("div",AY).css("top",AJ*-40+"px");AJ=(AJ+1)%12;}else{clearInterval(AK);}},AS=function(){if(!Am("#fancybox-wrap").length){Am("body").append(Ad=Am('<div id="fancybox-tmp"></div>'),AY=Am('<div id="fancybox-loading"><div></div></div>'),AW=Am('<div id="fancybox-overlay"></div>'),Aj=Am('<div id="fancybox-wrap"></div>'));if(!Am.support.opacity){Aj.addClass("fancybox-ie");AY.addClass("fancybox-ie");}AO=Am('<div id="fancybox-outer"></div>').append('<div class="fancy-bg" id="fancy-bg-n"></div><div class="fancy-bg" id="fancy-bg-ne"></div><div class="fancy-bg" id="fancy-bg-e"></div><div class="fancy-bg" id="fancy-bg-se"></div><div class="fancy-bg" id="fancy-bg-s"></div><div class="fancy-bg" id="fancy-bg-sw"></div><div class="fancy-bg" id="fancy-bg-w"></div><div class="fancy-bg" id="fancy-bg-nw"></div>').appendTo(Aj);AO.append(Ah=Am('<div id="fancybox-inner"></div>'),AU=Am('<a id="fancybox-close"></a>'),AR=Am('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),AQ=Am('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>'));AU.click(Am.fancybox.close);AY.click(Am.fancybox.cancel);AR.click(function(A){A.preventDefault();Am.fancybox.prev();});AQ.click(function(A){A.preventDefault();Am.fancybox.next();});if(AD){AW.get(0).style.setExpression("height","document.body.scrollHeight > document.body.offsetHeight ? document.body.scrollHeight : document.body.offsetHeight + 'px'");AY.get(0).style.setExpression("top","(-20 + (document.documentElement.clientHeight ? document.documentElement.clientHeight/2 : document.body.clientHeight/2 ) + ( ignoreMe = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop )) + 'px'");AO.prepend('<iframe id="fancybox-hide-sel-frame" src="javascript:\'\';" scrolling="no" frameborder="0" ></iframe>');}}};Am.fn.fancybox=function(A){Am(this).data("fancybox",Am.extend({},A,Am.metadata?Am(this).metadata():{})).unbind("click.fb").bind("click.fb",function(B){B.preventDefault();if(!Ai){Ai=true;Am(this).blur();Aa=[];Ab=0;B=Am(this).attr("rel")||"";if(!B||B==""||B==="nofollow"){Aa.push(this);}else{Aa=Am("a[rel="+B+"], area[rel="+B+"]");Ab=Aa.index(this);}AP();return false;}});return this;};Am.fancybox=function(A,D){if(!Ai){Ai=true;D=typeof D!=="undefined"?D:{};Aa=[];Ab=D.index||0;if(Am.isArray(A)){for(var B=0,C=A.length;B<C;B++){if(typeof A[B]=="object"){Am(A[B]).data("fancybox",Am.extend({},D,A[B]));}else{A[B]=Am({}).data("fancybox",Am.extend({content:A[B]},D));}}Aa=jQuery.merge(Aa,A);}else{if(typeof A=="object"){Am(A).data("fancybox",Am.extend({},D,A));}else{A=Am({}).data("fancybox",Am.extend({content:A},D));}Aa.push(A);}if(Ab>Aa.length||Ab<0){Ab=0;}AP();}};Am.fancybox.showActivity=function(){clearInterval(AK);AY.show();AK=setInterval(AT,66);};Am.fancybox.hideActivity=function(){AY.hide();};Am.fancybox.next=function(){return Am.fancybox.pos(Ac+1);};Am.fancybox.prev=function(){return Am.fancybox.pos(Ac-1);};Am.fancybox.pos=function(A){if(!Ai){A=parseInt(A,10);if(A>-1&&Ag.length>A){Ab=A;AP();}if(Al.cyclic&&Ag.length>1&&A<0){Ab=Ag.length-1;AP();}if(Al.cyclic&&Ag.length>1&&A>=Ag.length){Ab=0;AP();}}};Am.fancybox.cancel=function(){if(!Ai){Ai=true;Am.event.trigger("fancybox-cancel");AI();Ak&&Am.isFunction(Ak.onCancel)&&Ak.onCancel(Aa,Ab,Ak);Ai=false;}};Am.fancybox.close=function(){function A(){AW.fadeOut("fast");Aj.hide();Am.event.trigger("fancybox-cleanup");Ah.empty();Am.isFunction(Al.onClosed)&&Al.onClosed(Ag,Ac,Al);Ag=Ak=[];Ac=Ab=0;Al=Ak={};Ai=false;}if(!(Ai||Aj.is(":hidden"))){Ai=true;if(Al&&Am.isFunction(Al.onCleanup)){if(Al.onCleanup(Ag,Ac,Al)===false){Ai=false;return ;}}AI();Am(AU.add(AR).add(AQ)).hide();Am("#fancybox-title").remove();Aj.add(Ah).add(AW).unbind();Am(window).unbind("resize.fb scroll.fb");Am(document).unbind("keydown.fb");Ah.css("overflow","hidden");if(Al.transitionOut=="elastic"){Af=AB();var B=Aj.position();Ae={top:B.top,left:B.left,width:Aj.width(),height:Aj.height()};if(Al.opacity){Ae.opacity=1;}AV.prop=1;Am(AV).animate({prop:0},{duration:Al.speedOut,easing:Al.easingOut,step:AF,complete:A});}else{Aj.fadeOut(Al.transitionOut=="none"?0:Al.speedOut,A);}}};Am.fancybox.resize=function(){var A,B;if(!(Ai||Aj.is(":hidden"))){Ai=true;A=Ah.wrapInner("<div style='overflow:auto'></div>").children();B=A.height();Aj.css({height:B+Al.padding*2+AX});Ah.css({height:B});A.replaceWith(A.children());Am.fancybox.center();}};Am.fancybox.center=function(){Ai=true;var A=AH(),C=Al.margin,B={};B.top=A[3]+(A[1]-(Aj.height()-AX+40))*0.5;B.left=A[2]+(A[0]-(Aj.width()+40))*0.5;B.top=Math.max(A[3]+C,B.top);B.left=Math.max(A[2]+C,B.left);Aj.css(B);Ai=false;};Am.fn.fancybox.defaults={padding:10,margin:20,opacity:false,modal:false,cyclic:false,scrolling:"auto",width:560,height:340,autoScale:true,autoDimensions:true,centerOnScroll:false,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:true,hideOnContentClick:false,overlayShow:true,overlayOpacity:0.3,overlayColor:"#666",titleShow:true,titlePosition:"outside",titleFormat:null,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:true,showNavArrows:true,enableEscapeButton:true,onStart:null,onCancel:null,onComplete:null,onCleanup:null,onClosed:null};Am(document).ready(function(){AS();});})(jQuery);(function(jQuery){eval(function(p,a,c,k,e,r){e=function(c){return(c<a?"":e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36));};if(!"".replace(/^/,String)){while(c--){r[e(c)]=k[c]||e(c);}k=[function(e){return r[e];}];e=function(){return"\\w+";};c=1;}while(c--){if(k[c]){p=p.replace(new RegExp("\\b"+e(c)+"\\b","g"),k[c]);}}return p;}("h.i['1a']=h.i['z'];h.O(h.i,{y:'D',z:9(x,t,b,c,d){6 h.i[h.i.y](x,t,b,c,d)},17:9(x,t,b,c,d){6 c*(t/=d)*t+b},D:9(x,t,b,c,d){6-c*(t/=d)*(t-2)+b},13:9(x,t,b,c,d){e((t/=d/2)<1)6 c/2*t*t+b;6-c/2*((--t)*(t-2)-1)+b},X:9(x,t,b,c,d){6 c*(t/=d)*t*t+b},U:9(x,t,b,c,d){6 c*((t=t/d-1)*t*t+1)+b},R:9(x,t,b,c,d){e((t/=d/2)<1)6 c/2*t*t*t+b;6 c/2*((t-=2)*t*t+2)+b},N:9(x,t,b,c,d){6 c*(t/=d)*t*t*t+b},M:9(x,t,b,c,d){6-c*((t=t/d-1)*t*t*t-1)+b},L:9(x,t,b,c,d){e((t/=d/2)<1)6 c/2*t*t*t*t+b;6-c/2*((t-=2)*t*t*t-2)+b},K:9(x,t,b,c,d){6 c*(t/=d)*t*t*t*t+b},J:9(x,t,b,c,d){6 c*((t=t/d-1)*t*t*t*t+1)+b},I:9(x,t,b,c,d){e((t/=d/2)<1)6 c/2*t*t*t*t*t+b;6 c/2*((t-=2)*t*t*t*t+2)+b},G:9(x,t,b,c,d){6-c*8.C(t/d*(8.g/2))+c+b},15:9(x,t,b,c,d){6 c*8.n(t/d*(8.g/2))+b},12:9(x,t,b,c,d){6-c/2*(8.C(8.g*t/d)-1)+b},Z:9(x,t,b,c,d){6(t==0)?b:c*8.j(2,10*(t/d-1))+b},Y:9(x,t,b,c,d){6(t==d)?b+c:c*(-8.j(2,-10*t/d)+1)+b},W:9(x,t,b,c,d){e(t==0)6 b;e(t==d)6 b+c;e((t/=d/2)<1)6 c/2*8.j(2,10*(t-1))+b;6 c/2*(-8.j(2,-10*--t)+2)+b},V:9(x,t,b,c,d){6-c*(8.o(1-(t/=d)*t)-1)+b},S:9(x,t,b,c,d){6 c*8.o(1-(t=t/d-1)*t)+b},Q:9(x,t,b,c,d){e((t/=d/2)<1)6-c/2*(8.o(1-t*t)-1)+b;6 c/2*(8.o(1-(t-=2)*t)+1)+b},P:9(x,t,b,c,d){f s=1.l;f p=0;f a=c;e(t==0)6 b;e((t/=d)==1)6 b+c;e(!p)p=d*.3;e(a<8.w(c)){a=c;f s=p/4}m f s=p/(2*8.g)*8.r(c/a);6-(a*8.j(2,10*(t-=1))*8.n((t*d-s)*(2*8.g)/p))+b},H:9(x,t,b,c,d){f s=1.l;f p=0;f a=c;e(t==0)6 b;e((t/=d)==1)6 b+c;e(!p)p=d*.3;e(a<8.w(c)){a=c;f s=p/4}m f s=p/(2*8.g)*8.r(c/a);6 a*8.j(2,-10*t)*8.n((t*d-s)*(2*8.g)/p)+c+b},T:9(x,t,b,c,d){f s=1.l;f p=0;f a=c;e(t==0)6 b;e((t/=d/2)==2)6 b+c;e(!p)p=d*(.3*1.5);e(a<8.w(c)){a=c;f s=p/4}m f s=p/(2*8.g)*8.r(c/a);e(t<1)6-.5*(a*8.j(2,10*(t-=1))*8.n((t*d-s)*(2*8.g)/p))+b;6 a*8.j(2,-10*(t-=1))*8.n((t*d-s)*(2*8.g)/p)*.5+c+b},F:9(x,t,b,c,d,s){e(s==u)s=1.l;6 c*(t/=d)*t*((s+1)*t-s)+b},E:9(x,t,b,c,d,s){e(s==u)s=1.l;6 c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},16:9(x,t,b,c,d,s){e(s==u)s=1.l;e((t/=d/2)<1)6 c/2*(t*t*(((s*=(1.B))+1)*t-s))+b;6 c/2*((t-=2)*t*(((s*=(1.B))+1)*t+s)+2)+b},A:9(x,t,b,c,d){6 c-h.i.v(x,d-t,0,c,d)+b},v:9(x,t,b,c,d){e((t/=d)<(1/2.k)){6 c*(7.q*t*t)+b}m e(t<(2/2.k)){6 c*(7.q*(t-=(1.5/2.k))*t+.k)+b}m e(t<(2.5/2.k)){6 c*(7.q*(t-=(2.14/2.k))*t+.11)+b}m{6 c*(7.q*(t-=(2.18/2.k))*t+.19)+b}},1b:9(x,t,b,c,d){e(t<d/2)6 h.i.A(x,t*2,0,c,d)*.5+b;6 h.i.v(x,t*2-d,0,c,d)*.5+c*.5+b}});",62,74,"||||||return||Math|function|||||if|var|PI|jQuery|easing|pow|75|70158|else|sin|sqrt||5625|asin|||undefined|easeOutBounce|abs||def|swing|easeInBounce|525|cos|easeOutQuad|easeOutBack|easeInBack|easeInSine|easeOutElastic|easeInOutQuint|easeOutQuint|easeInQuint|easeInOutQuart|easeOutQuart|easeInQuart|extend|easeInElastic|easeInOutCirc|easeInOutCubic|easeOutCirc|easeInOutElastic|easeOutCubic|easeInCirc|easeInOutExpo|easeInCubic|easeOutExpo|easeInExpo||9375|easeInOutSine|easeInOutQuad|25|easeOutSine|easeInOutBack|easeInQuad|625|984375|jswing|easeInOutBounce".split("|"),0,{}));
})(jQuery);(function(B){var A=Echo.createPlugin({"name":"Whirlpools","applications":["Stream"],"init":function(F,D){var C=F.config.get(D);var G=(typeof C.after=="undefined"?2:C.after);var E=G/2;D.config.combine({"after":G,"legacy":Math.floor(E),"recent":Math.ceil(E)},C);F.listenEvents(D);F.addCss(F.css);F.extendRenderer("Item","children",F.renderers.Item.children);}});A.addLabels({"moreExpand":"more (expand)","moreItems":"more items"});A.listenEvents=function(C){A.subscribe(C,"Stream.onDataReceive",function(D,E){if(C.isChildrenPaginationEnabled&&C.isChildrenPaginationEnabled()){C.disablePlugin(A.name);}});};A.initMarker=function(C,D){return new A.Marker({"after":A.config.get(C,"after"),"count":D,"depth":C.depth+1,"clickable":A.config.get(C,"clickable")},{"onexpand":function(){A.set(C,"expanded",true);C.rerender("children");}});};A.renderers={"Item":{}};A.renderers.Item.children=function(F,E){var L=this;var I=arguments;var D=A.config.get(L);var K=function(M){delete M.deleted;delete M.added;};var G=function(M){var N=L.children;L.children=M;L.parentRenderer("children",I);L.children=N;};if(!L.children.length||L.children.length<=D.after||A.get(L,"expanded")){L.parentRenderer("children",I);return ;}if(D.after==0&&L.children.length){var H=L.traverse(L.children,function(M,N){K(M);return ++N;},0);G([A.initMarker(L,H)]);return ;}var J=L.children.slice(D.recent,L.children.length-D.legacy);var H=L.traverse(J,function(M,N){K(M);return ++N;},0);var C=[].concat(A.getRecentChildren(L,D.recent),A.initMarker(L,H),A.getLegacyChildren(L,D.legacy));G(C);};A.getRecentChildren=function(G,F){var C=F;for(var E=0;E<F;E++){if(G.children[E].added||G.children[E].deleted){var D=G.children[E].added?"deleted":"added";G.children[C++][D]=true;}}return G.children.slice(0,C);};A.getLegacyChildren=function(H,G){var F=H.children.length;var C=F-G;for(var E=F-G;E<F;E++){if(H.children[E].added||H.children[E].deleted){var D=H.children[E].added?"deleted":"added";H.children[--C][D]=true;}}return H.children.slice(C);};A.Marker=function(D,C){D.label=this.label("more"+(D.clickable?"Expand":"Items"));this.init({"data":D,"callbacks":C});};A.Marker.prototype=new Echo.Object();A.Marker.prototype.namespace="Plugins.Whirlpools";A.Marker.prototype.cssPrefix="echo-whirlpool-";A.Marker.prototype.renderers={};A.Marker.prototype.template='<div class="echo-whirlpool-container echo-trinaryBackgroundColor echo-item-depth-{Data:depth} echo-item-container-child">'+'<span class="echo-whirlpool-message">{Data:count} {Data:label}</span>'+"</div>";A.Marker.prototype.renderers.container=function(D){var C=this;if(this.data.clickable){D.addClass("echo-clickable").click(function(){C.callbacks.onexpand();});}if(this.data.after==0){D.addClass(this.cssPrefix+"container-collapse-all");}};A.Marker.prototype.renderers.message=function(C){if(this.data.clickable){C.addClass("echo-linkColor");}};A.css=".echo-whirlpool-container { text-align: center; }"+".echo-whirlpool-container-collapse-all { text-align: left; }"+'.echo-whirlpool-message { display: inline-block; padding-left: 18px; background: url("//www.washingtonpost.com/rw/sites/twpweb/img/echo2/core/whirlpool.png") no-repeat center left; }';})(jQuery);(function(B){var A=Echo.createPlugin({"name":"FormAuth","applications":["Submit"],"dependencies":[{"application":"Auth","url":"//www.washingtonpost.com/rw/sites/twpweb/js/echo2/v2/core/auth.js"}],"init":function(D,C){D.extendTemplate("Submit",'<div class="echo-submit-auth"></div>',"insertBefore","echo-submit-header");D.extendRenderer("Submit","auth",D.renderers.Submit.auth);D.extendRenderer("Submit","header",D.renderers.Submit.header);D.extendRenderer("Submit","container",D.renderers.Submit.container);D.extendRenderer("Submit","postButton",D.renderers.Submit.postButton);D.extendRenderer("Submit","forcedLoginUserInfo",D.renderers.Submit.forcedLoginUserInfo);D.addCss(D.css);}});A.css=".echo-submit-forcedLoginUserInfoMessage { font-size: 14px; font-weight: bold; }";A.addLabels({"youMustBeLoggedIn":"You must be logged in to comment"});A.renderers={"Submit":{}};A.renderers.Submit.auth=function(E,F){var D=this;if(!D.user.get("sessionID")||D.config.get("mode")=="edit"){return ;}var C=B.foldl({},["Edit","Login","Signup"],function(G,H){H[G.toLowerCase()]=A.config.get(D,"identityManager"+G);});new Echo.Auth(A.assembleConfig(D,{"target":E,"identityManager":C}));};A.renderers.Submit.container=function(D,E){var C=this;C.parentRenderer("container",arguments);D.removeClass("echo-submit-logged echo-submit-anonymous echo-submit-forcedLogin");D.addClass("echo-submit-"+A.getStatus(C));};A.renderers.Submit.header=function(E,F){var D=this;var C=A.getStatus(D);if(C=="forcedLogin"){return D.render("forcedLoginUserInfo",E,F);}if(C=="logged"){E.empty();return ;}return D.parentRenderer("header",arguments);};A.renderers.Submit.postButton=function(D,F){var C=this;var E=A.get(C,"postButtonHandler");if(!E){E=function(G){if(C.user.logged()){G.stopImmediatePropagation();if(!C.highlightMandatory(C.dom.get("text"))){C.post();}}else{if(C.config.get("mode")!="edit"&&A.getPermissions(C)=="forceLogin"){G.stopImmediatePropagation();C.dom.get("forcedLoginUserInfoMessage").css({"color":"red"});}}};A.set(C,"postButtonHandler",E);}D.unbind("click",E).bind("click",E);C.parentRenderer("postButton",arguments);};A.renderers.Submit.forcedLoginUserInfo=function(C,G){var F="echo-submit-forcedLoginUserInfo";var E='<div class="echo-submit-userInfoWrapper echo-primaryFont">'+'<span class="{Data:prefix}Message echo-secondaryColor">'+"{Data:label}"+"</span>"+"</div>";var D={"Message":function(H){G.set("forcedLoginUserInfoMessage",H);}};var E=this.substitute(E,{"prefix":F,"label":A.label("youMustBeLoggedIn")});return B.toDOM(E,F,D).content;};A.getPermissions=function(C){return A.config.get(C,"submitPermissions","allowGuest");};A.getStatus=function(C){if(C.user.logged()){return"logged";}if(A.getPermissions(C)=="forceLogin"){return"forcedLogin";}return"anonymous";};})(jQuery);(function(B){var A=Echo.createPlugin({"name":"Reply","applications":["Stream"],"dependencies":[{"application":"Submit","url":"//www.washingtonpost.com/rw/sites/twpweb/js/echo2/v2/core/submit.js"}],"init":function(D,C){if(!Echo.Global){Echo.Global={};}D.extendRenderer("Item","children",D.renderers.Item.children);D.extendRenderer("Item","replyForm",D.renderers.Item.replyForm);D.extendRenderer("Item","container",D.renderers.Item.container);D.extendTemplate("Item",D.template,"insertAsLastChild","echo-item-content");D.listenEvents(C);D.addItemControl(C,D.assembleControl("Reply",C));}});A.template='<div class="echo-item-replyForm"></div>';A.addLabels({"replyControl":"Reply"});A.assembleControl=function(D,C){var E=function(){var G=this;var H=G.dom.get("replyForm");if(!A.get(G,"form")){A.createForm(G,H);}if(A.get(G,"form.initialized")){if(G.depth||!G.children.length){A.view(G,"toggle");G.rerender("container");}}else{G.rerender("replyForm");}var F=A.get(G,"form");F.instance.switchMode();if(F.visible){if(F.instance.dom){text=F.instance.dom.get("text");if(text&&text.is(":visible")){text.focus();return ;}}H.get(0).scrollIntoView(false);}};return function(){var F=this;return{"name":"Reply","label":A.label("replyControl"),"visible":C.isChildrenPaginationEnabled&&C.isChildrenPaginationEnabled()?F.depth<F.config.get("children.maxDepth"):!F.depth,"callback":E};};};A.renderers={"Item":{}};A.renderers.Item.children=function(C,E){var D=this;D.rerender("replyForm");D.parentRenderer("children",arguments);};A.renderers.Item.replyForm=function(D,F){var E=this;if(E.depth==E.config.get("children.maxDepth")){return ;}if((!E.depth&&E.children.length&&!A.get(E,"form"))||A.get(Echo.Global,A.getFormKey(E))){A.createForm(E,D);}else{if(!A.get(E,"form")){return ;}}var C=!!E.children.length;if(!A.get(E,"form.initialized")){A.set(E,"form.initialized",true);D.addClass("echo-item-container echo-item-container-child "+"echo-trinaryBackgroundColor echo-item-depth-"+(E.depth+1));if(!C){E.rerender("container");}else{if(A.get(E,"form.visible")){A.view(E,"show");
}}}else{if(A.get(E,"form.visible")&&(!C||E.children.length==1&&E.children[0].deleted)){A.view(E,"hide");}else{if(C){A.view(E,"show");}}}};A.renderers.Item.container=function(C,F){var E=this;var D=E.threading;if(A.get(E,"form.visible")){E.threading=true;}E.parentRenderer("container",arguments);E.threading=D;};A.prepareParams=function(C,D){return C.prepareBroadcastParams({"plugin":A.name,"form":A.get(D,"form"),"item":{"data":D.data,"target":D.dom.content}});};A.listenEvents=function(C){B.map(["Expand","Collapse"],function(D){A.subscribe(C,"Submit.on"+D,function(H,F){var G=C.items[F.data.unique];if(!G||!A.get(G,"form")){return ;}if(D=="Collapse"&&(G.depth||!G.children.length)){A.view(G,"hide");G.rerender("container");}var E=A.topic(C,"onForm"+D);A.publish(C,E,A.prepareParams(C,G));});});A.subscribe(C,"Submit.onPostComplete",function(E,D){var F=C.items[D.data.unique];if(!F){return ;}A.get(F,"form.instance").switchMode("compact");});};A.createForm=function(F,H){var C=A.assembleConfig(F,{"target":H.get(0),"inReplyTo":F.data,"data":{"unique":F.data.unique},"mode":"compact","targetURL":F.id});var D=A.getFormKey(F);var E=(A.get(Echo.Global,D)||{}).instance;if(E){var I=E.dom.get("text").val();E.config.set("target",H);H.empty().append(E.render());if(I){E.dom.get("text").val(I);}}else{E=new Echo.Submit(C);}var G={"instance":E,"initialized":false,"visible":true};A.set(Echo.Global,D,G);A.set(F,"form",G);};A.view=function(D,E){var C=E=="toggle"?!A.get(D,"form.visible"):E=="show";A.set(D,"form.visible",C);A.get(D,"form.instance").config.get("target")[E]();};A.getFormKey=function(C){return"forms."+C.data.unique+"-"+C.getContextId();};})(jQuery);TWP.Util.Url={getParameters:function(D){var C=[],F={},B,E;D=(D!==""&&typeof D==="string")?D:document.URL;if(D){if(D.indexOf("?")!==-1){C=D.split("?")[1];if(C){if(C.indexOf("&")){B=C.split("&");}else{B=[C];}for(var A=0;A<B.length;A++){if(B[A].indexOf("=")!==-1){E=B[A].split("=");F[E[0]]=unescape(E[1]);}}}}}return(F)?F:null;},getUrl:function(){return window.location.href||document.url;},getRootPath:function(){return this.getProtocol()+"//"+this.getHost()+this.getPathName();},getSubDomain:function(){},getTopLevelDomain:function(){return window.document.domain;},getHost:function(){return window.location.host;},getHostName:function(){return window.location.hostname;},getProtocol:function(){return window.location.protocol||window.document.protocol;},getPort:function(){return window.location.port;},getHash:function(){return window.location.hash;},getPathName:function(){return window.location.pathname;},getFileName:function(){},getFileNameExtension:function(){},isSSL:function(){var A=false;if(this.getProtocol().indexOf("https://")!==-1){A=true;}return A;}};(function(B){var A=Echo.createPlugin({"name":"TWP_CommunityFlag","applications":["Stream"],"init":function(E,D){var C=[{"marker":"CommunityFlagged","labelMark":"Report","labelUnmark":"Report"}];B.each(C,function(F,G){E.addItemControl(D,E.assembleControl("Mark",G,D));E.addItemControl(D,E.assembleControl("Unmark",G,D));});D.config.set(E.config("proxyURL"),D.config.get(E.config("proxyURL")));D.config.set(E.config("echoSubmissionProxyURL"),D.config.get(E.config("echoSubmissionProxyURL")));}});A.addLabels({"markProcessing":"Reporting...","unmarkProcessing":"Reporting..."});A.getSubmissionProxyURL=function(C){if(!wp_e2.echo_user.logged()){C.config.set("submissionProxyURL",C.config.get(A.config("proxyURL")));}else{C.config.set("submissionProxyURL",C.config.get(A.config("echoSubmissionProxyURL")));}return C.config.get("submissionProxyURL",A.config("submissionProxyURL"));};A.assembleControl=function(G,H,E){var F=H.marker?"marker":"tag";var C=(H.marker||H.tag);var D=G+"As"+C.replace(/[^a-z0-9_-]/ig,"");var I=function(){var K=this;var J=G.toLowerCase();K.controls[A.name+"."+D].element.empty().append(A.label(J+"Processing",{"type":F,"marker":C}));var L={"verb":F=="tag"?J.replace(/mark/g,"tag"):((J==="unmark")?"mark":J),"target":K.id};L[F+"s"]=C;B.get(A.getSubmissionProxyURL(E),{"appkey":E.config.get("appkey"),"content":B.object2JSON(L),"sessionID":K.user.get("sessionID","")},function(){E.startLiveUpdates(true);},"jsonp");};return function(){var J=this;var K=(B.inArray(C,J.data.object[F+"s"]||[])==-1)^(G=="Unmark");return{"name":D,"label":H["label"+G],"visible":K,"onetime":true,"callback":I};};};})(jQuery);(function(B){TWP_Debug.pagedebug&&window.console&&console.log&&console.log("["+(new Date()-TWP_Debug.initialTime)/1000+"]"+"echo2/v2/plugins/twp_stream.js - starting stream");var A=Echo.createPlugin({"name":"TWP_Like","applications":["Stream"],"dependencies":[{"application":"UserList","url":((typeof eidosBase!=="undefined"&&eidosBase!=="")?eidosBase:"")+"/rw/sites/twpweb/js/echo2/v2/core/user-list.js"}],"init":function(D,C){D.extendRenderer("Item","recommended",D.recommendedRenderer);D.extendTemplate("Item",D.template,"insertAfter","echo-item-controls");D.extendRenderer("Item","control",D.controlRenderer);D.addItemControl(C,D.assembleControl("Like",C));D.addItemControl(C,D.assembleControl("Unlike",C));D.addCss(D.css);C.config.set(D.config("proxyURL"),C.config.get(D.config("proxyURL")));C.config.set(D.config("echoSubmissionProxyURL"),C.config.get(D.config("echoSubmissionProxyURL")));}});A.template='<div class="echo-item-recommended"></div>';A.addLabels({"likeThis":" like this.","likesThis":" likes this.","likeControl":"Recommend","unlikeControl":"Unrecommend","likeProcessing":"Recommending...","unlikeProcessing":"Unrecommending..."});A.getSubmissionProxyURL=function(C){if(!wp_e2.echo_user.logged()){C.config.set("submissionProxyURL",C.config.get(A.config("proxyURL")));}else{C.config.set("submissionProxyURL",C.config.get(A.config("echoSubmissionProxyURL")));}return C.config.get("submissionProxyURL",A.config("submissionProxyURL"));};A.assembleControl=function(D,C){var E=function(){var F=this;F.controls[A.name+"."+D].element.empty().append(A.label(D.toLowerCase()+"Processing"));B.get(A.getSubmissionProxyURL(C),{"appkey":C.config.get("appkey"),"content":B.object2JSON({"verb":D.toLowerCase(),"target":F.id}),"sessionID":F.user.get("sessionID","")},function(){var G=A.topic(C,"on"+D+"Complete");C.publish(G,C.prepareBroadcastParams({"item":{"data":F.data,"target":F.dom.content}}));C.startLiveUpdates(true);},"jsonp");};return function(){var F=this;var G=(B.map(F.data.object.likes,function(H){if(F.user.hasIdentity(H.actor.id)){return H;}})).length>0?"Unlike":"Like";return{"name":D,"label":A.label(D.toLowerCase()+"Control"),"visible":G==D,"onetime":true,"count":F.data.object.likes.length,"callback":E};};};A.recommendedRenderer=function(F,I){if(!(this.data.object.status=="ModeratorDeleted")&&this.data.object.likes.length&&this.data.object.likes.length>0){var G=this;var E=false;var H=G.data.object.accumulators.likesCount;var J=B.map(G.data.object.likes,function(K){if(K.actor.id==G.user.get("id")){E=true;H=H-1;}return K.actor;});var C=(G.data.object.likes.length==1&&E)?true:false;var D="";D="Recommended by "+((C)?"you":(H+" reader"+((H>1)?"s":"")+((E)?" and you":"")));B(F).html(D);if(B(".echo-item-control-Like",F.prev()).length>0){F.insertAfter(B(".echo-item-control-recommend-Like",F.prev()));}else{if(B(".echo-item-control-Unlike",F.prev()).length>0){F.insertAfter(B(".echo-item-control-recommend-Unlike",F.prev()));}else{F.prependTo(F.prev());}}}};A.controlRenderer=function(E,H,D){if(this.data.object.status=="ModeratorDeleted"){return ;}else{if(!D||!D.name){return ;}var C="";if(D.name=="Like"||D.name=="Unlike"){C='<div class="echo-item-control-recommend-{Data:name}">'+((wp_e2.echo_user.logged())?"":'<div class="tooltip" rel="#echo-anon-recommend">')+'<a class="echo-item-control echo-item-control-{Data:name}">{Data:label}</a>'+((wp_e2.echo_user.logged())?"":"</div>")+"</div>";}else{if(D.name=="MarkAsCommunityFlagged"||D.name=="UnmarkAsCommunityFlagged"){C=((wp_e2.echo_user.logged())?"":'<div class="tooltip" rel="#echo-anon-report">')+'<a class="echo-item-control echo-item-control-{Data:name} ">{Data:label}</a>'+((wp_e2.echo_user.logged())?"":"</div>");
}else{C='<a class="echo-item-control echo-item-control-{Data:name} ">{Data:label}</a>';}}var F=D.template||C;var G={"label":D.label||"","name":D.name,"count":D.count};return B(this.substitute(F,G))[D.onetime?"one":"bind"]({"click":function(I){I.stopPropagation();if((D.name=="Like"||D.name=="Unlike"||D.name=="MarkAsCommunityFlagged"||D.name=="UnmarkAsCommunityFlagged")&&!wp_e2.echo_user.logged()){}else{if(D.callback){D.callback();}}}});}};A.css=".echo-item-likes { line-height: 16px; background: url(/rw/sites/twpweb/img/echo2/core/likes.png) no-repeat 0px 4px; padding: 0px 0px 4px 21px; }";})(jQuery);(function(B){var A=Echo.createPlugin({"name":"TWP_Stream","applications":["Stream"],"init":function(G,J){G.extendRenderer("Stream","more",G.moreRenderer);G.extendRenderer("Stream","body",G.streamBodyRenderer);G.extendRenderer("Stream","state",G.stateRenderer);G.extendRenderer("Item","avatar",G.avatarRenderer);G.extendRenderer("Item","authorName",G.authorNameRenderer);G.extendRenderer("Item","container",G.containerRenderer);G.extendRenderer("Item","subwrapper",G.subwrapperRenderer);G.extendRenderer("Item","date",G.dateRenderer);G.extendRenderer("Item","body",G.itemBodyRenderer);G.extendRenderer("Item","textToggleTruncated",G.textToggleTruncatedRenderer);G.extendRenderer("Item","control",G.controlRenderer);G.extendTemplate("Item","<span></span>","replace","echo-item-avatar-wrapper");G.extendTemplate("Item","<span></span>","replace","echo-item-authorName");G.extendTemplate("Item",G.headerWrapperTemplate,"insertBefore","echo-item-subcontainer");G.extendTemplate("Item",G.footerNewTemplate,"replace","echo-item-footer");G.extendRenderer("Item","sourceIcon",G.sourceIconRenderer);G.extendRenderer("Item","from",G.fromRenderer);var M=J.config.get(G.config("isAllComments"))||false;J.config.set(G.config("isAllComments"),M);var C=J.config.get(G.config("webType"))||"article_story";J.config.set(G.config("webType"),C);var D=J.config.get(G.config("display_more"))||true;J.config.set(G.config("display_more"),D);J.config.set(G.config("allCommentsURL"),J.config.get(G.config("allCommentsURL")));var E=J.config.get(G.config("allowPhotos"))||false;J.config.set(G.config("allowPhotos"),E);var L=J.config.get(G.config("allowVideos"))||false;J.config.set(G.config("allowVideos"),L);var I=J.config.get(G.config("allowLinks"))||true;J.config.set(G.config("allowLinks"),I);var K=J.config.get(G.config("markerDisplay"))||{};J.config.set(G.config("markerDisplay"),K);var F=J.config.get(G.config("markerListTop"))||[];J.config.set(G.config("markerListTop"),F);var H=J.config.get(G.config("bookmarkletUrl"))||"";J.config.set(G.config("bookmarkletUrl"),H);G.addItemControl(J,function(){var N=this;return{"name":"Grab","label":"Grab This","visible":N.user.logged()&&(typeof N.user.account.markers!="undefined"&&N.user.account.markers.staff==true),"callback":function(){var O=new Date(N.data.object.published);url=J.config.get(G.config("bookmarkletUrl"))+"?contenturl="+N.data.target.id+"&commentitemurl="+N.data.object.id+"&blurb="+N.data.object.content+"&commentusername="+N.data.actor.title+"&commentuserid="+N.data.actor.id+"&img="+N.data.actor.avatar+"&source=www.washingtonpost.com"+"&commentposteddate="+O.format("yyyymmddHHMMss");+((typeof N.data.actor.markers!="undefined")?"&commentusermarkers="+N.data.actor.markers.join(","):"")+((typeof N.data.object.markers!="undefined")?"&commentitemmarkers="+N.data.object.markers.join(","):"");window.open(url);event.preventDefault();}};});}});Echo.Localization.extend({"childrenMoreItems":"View more responses"},"Item");Echo.Localization.extend({"more":"Load more comments"},"Stream");A.headerWrapperTemplate='<div class="echo-item-header-wrapper">'+'<div class="echo-item-avatar-wrapper">'+'<div class="echo-item-avatar"></div>'+"</div>"+'<div class="echo-item-authorName echo-linkColor"></div>'+'<div class="echo-item-date"></div>'+'<img class="echo-item-sourceIcon echo-clickable">'+'<div class="echo-item-from"></div>'+"</div>";A.footerNewTemplate='<div class="echo-item-footer echo-secondaryColor echo-secondaryFont">'+'<div class="echo-item-via"></div>'+'<div class="echo-item-controls"></div>'+'<div class="echo-clear"></div>'+"</div>";A.itemMarkerArray=["post_recommended"];A.textToggleTruncatedRenderer=function(D){var C=this;C.parentRenderer("textToggleTruncated",arguments);return this.label((this.textExpanded?"See Less":"See More"));};A.stateRenderer=function(F){var C=this;var D=this.config.get("streamStateLabel");if(!D.icon&&!D.text){return ;}var I=0;if(this.activities.state=="paused"){I=B.foldl(0,C.activities.queue,function(J,K){if(J.affectCounter){return ++K;}});}var G=this.activities.state+I;if(G==this.activities.lastState){return ;}F=(F||this.dom.get("state")).empty();if(!this.activities.lastState&&this.config.get("streamStateToggleBy")=="button"){F.addClass("echo-linkColor echo-clickable").click(function(J){C.setStreamState(C.activities.state=="paused"?"live":"paused");});}var H=this.activities.state;if(this.activities.state=="paused"){H="Load new comments";}else{H="Pause loading new comments";}var E={"picture":'<span class="echo-stream-state-picture echo-stream-state-picture-'+this.activities.state+'"></span>',"message":this.config.get("streamStateToggleBy")=="button"?'<a href="javascript:void(0)" class="echo-stream-state-message">'+H+"</a>":'<span class="echo-stream-state-message">'+H+"</span>","count":' <span class="echo-stream-state-count">({Data:count} {Label:new})</span>'};if(D.icon){F.append(E.picture);}if(D.text){F.append(this.substitute(E.message));if(I&&this.activities.state=="paused"){F.append(this.substitute(E.count,{"count":I}));}}this.activities.lastState=G;};A.moreRenderer=function(D,E){var C=this;if(C.config.get(A.config("display_more"))===false){D.remove();}else{var C=this;C.parentRenderer("more",arguments);if(C.config.get(A.config("webType"))=="promo_story"){B(D).html("View more responses");}}};A.controlRenderer=function(E,J,C){var D=this;if(this.data.object.status=="ModeratorDeleted"){return ;}else{if(!C||!C.name){return ;}var F=C.template||'<a class="echo-item-control echo-item-control-{Data:name}">{Data:label}</a>';var H={"label":C.label||"","name":C.name};var I=B(this.substitute(F,H));var G=B(".echo-clickable",I);if(!G.length){G=I;I.addClass("echo-clickable");}G[C.onetime?"one":"bind"]({"click":function(K){K.stopPropagation();if(C.callback){C.callback();}}});return I;}};A.streamBodyRenderer=function(E,D){var I=this;I.parentRenderer("body",arguments);var F;var N=(I.config.get(A.config("webType")).toLowerCase()==="discussion_story")?"Posts":"Comments";var G=(I.config.get(A.config("webType"))==="discussion_story")?"View all Posts":"View all Comments";var H;if(I.config.get(A.config("isAllComments"))||(I.config.get(A.config("webType")).toLowerCase()=="blogstory")){H='<span class="echo-view-all-comments"><a href="" onClick="javascript:$(\'#comment-stream-tabs li a[rel=\\\'all\\\']\').click();return false;">'+G+"</a>. </span>";}else{H='<span class="echo-view-all-comments"><a href="'+I.config.get(A.config("allCommentsURL"))+'?ctab=all_&#weighIn">'+G+"</a>. </span>";}var C="";var K=I.config.get(A.config("markerDisplay"));var J=B(".comment-stream-tabs .tab.active a",B(I.config.get("target")).closest(".echo_stream_container")).attr("rel");if(J=="top"){C=B("#echo-more-comments-top");var M=B(".badge-list",C);var L="";if(M.length>0){B.each(I.config.get(A.config("markerListTop")),function(O,P){if(P!="staff"){L+=(typeof K[P]!=="undefined")?K[P]+", ":"";}});M.html(L.substring(0,L.lastIndexOf(", ")));}F="No Top "+N+" are available at the moment. "+H+C.html();}else{F="No "+N+" are available at the moment.";}Echo.Localization.extend({"emptyStream":'<span class="note">'+F+"</span>","waiting":"Building list of "+N.toLowerCase()+", please wait..."},"Stream");};A.avatarRenderer=function(D,E){var C=this;C.parentRenderer("avatar",arguments);if(!this.data.actor.avatar){B(D).html('<img src="http://www.washingtonpost.com/rw/sites/twpweb/img/echo2/core/avatar-default.png" />');
}else{if(this.data.object.status=="ModeratorDeleted"){B(D).html('<img src="/rw/sites/twpweb/img/echo2/postmoderator-avatar-48x48.jpg" />');}else{B(D).html('<img src="'+this.data.actor.avatar+'" />');}}};A.authorNameRenderer=function(D,E){var C=this;C.parentRenderer("authorName",arguments);if(this.data.object.status=="ModeratorDeleted"){B(D).html("postmoderator");}else{if(this.data.provider.name=="Arktan"&&this.data.source.name=="Twitter"){B(D).html('<a href="'+this.data.actor.id+'">'+this.data.actor.title+"</a>");}else{B(D).html(this.data.actor.title);}}};A.subwrapperRenderer=function(E,G){var C=this;C.parentRenderer("subwrapper",arguments);var D=[];var F=[];B.map(this.data.actor.roles||[],function(H){if(H!=""){D.push("echo-item-user-role-"+H);}});B.map(this.data.actor.markers||[],function(H){if(H!=""){D.push("echo-item-user-marker-"+H);markerTranslated=C.config.get(A.config("markerDisplay"))[H]||"";F.push('<div class="marker" title="'+markerTranslated+'..."><span class="marker echo-item-user-'+H+' tooltip" rel="#echo-'+H+'" ></span></div>');}});B.map(this.data.object.markers||[],function(H){if(H!=""){if(B.inArray(H,A.itemMarkerArray)>=0){markerTranslated=C.config.get(A.config("markerDisplay"))[H];F.push('<div class="marker" title=""><span class="marker echo-item-marker-'+H+' tooltip" rel="#echo-'+H+'" ></span></div>');D.push("echo-item-marker-"+H);}}});if(D.length){B(E).addClass(D.join(" "));}B("div.marker",E).remove();B(E).prepend(F.join(" "));};A.containerRenderer=function(E,G){var C=this;C.parentRenderer("container",arguments);var D=[];var F=[];if(this.data.object.status=="ModeratorDeleted"&&this.data.source.name=="Twitter"){E.remove();}else{if(this.data.object.status=="ModeratorDeleted"&&this.data.object.accumulators.repliesCount==""){E.remove();}else{if(this.data.object.status=="ModeratorDeleted"){B(E).addClass("echo-item-deleted");}else{B.map(this.data.actor.markers||[],function(H){if(H!=""){D.push("echo-item-user-marker-"+H);markerTranslated=C.config.get(A.config("markerDisplay"))[H]||"";}});if(D.length){B(E).addClass(D.join(" "));}}}}};A.dateRenderer=function(D,F){var C=this;if(this.data.object.status=="ModeratorDeleted"){D.remove();}else{C.parentRenderer("date",arguments);var E=new Date();E.setISO8601(this.data.object.published);currDateFmt=E.format("h:MM TT Z");prevDateFmt=E.format("m/d/yyyy h:MM TT Z");(E.format("m/d/yyyy")==new Date().format("m/d/yyyy"))?B(D).html(currDateFmt):B(D).html(prevDateFmt);}};A.itemBodyRenderer=function(G,J){var C=this;C.parentRenderer("body",arguments);var F=["img"];var E=["object","embed","iframe"];var D=["a"];if(this.data.object.status=="ModeratorDeleted"){B(G).html('<span>This comment has been deleted by a moderator for violating the site\'s <a class="iframe-overlay" config="overlayOpacity=.5&amp;width=600&amp;height=600" href="http://www.washingtonpost.com/wp-srv/interactivity/policy/discussion_policy.html">discussion policy</a>.</span>');}else{}if(!C.config.get(A.config("allowPhotos"))){B.each(F,function(K,L){B(L,G).remove();});}if(!C.config.get(A.config("allowVideos"))){B.each(E,function(K,L){B(L,G).remove();});}if(!C.config.get(A.config("allowLinks"))){B.each(D,function(K,L){B(L,G).remove();});}if(this.data.source.name=="instagr.am"&&this.data.provider.name=="Arktan"){B(G).append('<p class="instagram-caption">'+this.data.object.title+"</p>");}var I=G.find(".metadata_image");if(I.length>0&&I.attr("src")!=""&&I.attr("data-src-web")!=""){var H=I.attr("data-src-web");I.attr("src",H);}};A.sourceIconRenderer=function(D,E){var C=this;C.parentRenderer("sourceIcon",arguments);if((this.config.get("viaLabel.icon")&&(this.data.source.name=="washpost.com"))||(this.data.object.status=="ModeratorDeleted")){D.remove();}};A.fromRenderer=function(D,E){var C=this;C.parentRenderer("from",arguments);if((this.config.get("viaLabel.text")&&(this.data.source.name=="washpost.com"))||(this.data.object.status=="ModeratorDeleted")){D.remove();}else{if(this.data.provider.name=="Arktan"&&this.data.source.name=="Twitter"){B("a",D).attr("href",this.data.object.id);}}};A.footerRenderer=function(D,E){var C=this;C.parentRenderer("footer",arguments);B(D).append('<div class="echo-bookmarklet"><a href="">grab this</a></div>');};})(jQuery);(function(A){Echo.Localization.extend({"post":"Submit","posting":"Submitting..."},"Submit");})(jQuery);(function(B){var A=Echo.createPlugin({"name":"SubmitForm","applications":["Submit"],"dependencies":[{"application":"Auth","url":((typeof eidosBase!=="undefined"&&eidosBase!=="")?eidosBase:"")+"/rw/sites/twpweb/js/echo2/v2/core/auth.js"}],"init":function(F,D){F.extendRenderer("Submit","header",F.headerRenderer);F.extendRenderer("Submit","container",F.containerRenderer);F.extendRenderer("Submit","postButton",F.postButtonRenderer);var C=D.config.get(F.config("commentMaxLength"))||3000;D.config.set(F.config("commentMaxLength"),C);var G=D.config.get(F.config("displayUGCPhotos"))||false;D.config.set(F.config("displayUGCPhotos"),G);var E=D.config.get(F.config("photoCommentMaxLength"))||500;D.config.set(F.config("photoCommentMaxLength"),E);D.config.set(F.config("proxyURL"),D.config.get(F.config("proxyURL")));D.config.set(F.config("echoSubmissionProxyURL"),D.config.get(F.config("echoSubmissionProxyURL")));D.config.set(F.config("pageURL"),D.config.get(F.config("pageURL")));D.config.set(F.config("loginURL"),D.config.get(F.config("loginURL")));D.config.set(F.config("logoutURL"),D.config.get(F.config("logoutURL")));D.config.set(F.config("profileURL"),D.config.get(F.config("profileURL")));var H=D.config.get(F.config("isWashingtonpostDomain"))||true;D.config.set(F.config("isWashingtonpostDomain"),H);}});A.headerRenderer=function(G,F){var I=this;var D="";var J="";var C="";var E='<a href="'+I.config.get(A.config("loginURL"))+I.config.get(A.config("pageURL"))+'" alt="Log In">Sign in</a>';var K='<a rel="#registered" href="#" alt="Log In">Sign in</a>';var L=(I.config.get(A.config("isWashingtonpostDomain")))?E:K;G=I.parentRenderer("header",arguments);if(I.config.get(A.config("displayUGCPhotos"))===true){J='<div id="comment-user-account-links">'+'<div class="left user-btn" style="width:100%;"><p><strong>You are not signed in.</strong> You must sign in or register with the Washington Post to submit a photo.</p>'+'<p class="submit-box-links">'+L+' | <a href="'+I.config.get(A.config("profileURL"))+I.config.get(A.config("pageURL"))+'#weighIn" alt="Register">Register</a></p>'+"</div>"+"</div>";C='<div class="left" style="width:100%;"><p><strong>You do not have a valid MyPost ID.</strong> You must create a valid MyPost ID with the Washington Post to submit a photo.</p></div>'+'<div class="left"><p class="submit-box-links"><a href="'+I.config.get(A.config("profileURL"))+I.config.get(A.config("pageURL"))+'#weighIn" alt="Log In">Create ID</a></p></div>';}else{J='<div id="comment-user-account-links">'+'<div class="left user-btn" style="width:100%;"><p><strong>You are not signed in.</strong> You must sign or register with the Washington Post to comment or post. If you post before signing in, your comment will be saved while you are guided through the sign-in process.</p>'+'<p class="submit-box-links">'+L+' | <a href="'+I.config.get(A.config("profileURL"))+I.config.get(A.config("pageURL"))+'#weighIn" alt="Register">Register</a></p>'+"</div>"+"</div>";C='<div class="left user-btn" style="width:100%;"><p><strong>You do not have a valid MyPost ID.</strong> You must create a valid MyPost ID to comment or post. If you post before creating a MyPost ID, your comment will be saved while you are guided through the process to create a unique MyPost ID.</p></div>'+'<div class="left"><p class="submit-box-links"><a href="'+I.config.get(A.config("profileURL"))+I.config.get(A.config("pageURL"))+'#weighIn" alt="Log In">Create ID</a></p></div>';}if(!wp_e2.echo_user.logged()){D=(wapoIdentity.isPostIdMissing())?C:J;B(".echo-submit-anonymousUserInfoFields",G).append(D);}B("input.echo-submit-anonymousUserInfoUrl",G).addClass("hidden");var H=B("input.echo-submit-anonymousUserInfoName",G);
H.addClass("hidden");if(H!==null){H.val("Guest");}B("#share-comments",G).children().remove();B("div.module.share.comments.inline.hidden").clone(true).removeClass("hidden").appendTo(B("#share-comments",G));return G;};A.containerRenderer=function(F,G){var E=this;E.parentRenderer("container",arguments);F.removeClass("echo-submit-logged echo-submit-anonymous echo-submit-forcedLogin");if(!wp_e2.echo_user.logged()){B("div.echo-submit-auth",F).addClass("hidden");}else{B("div.echo-submit-auth",F).removeClass("hidden");}B(".echo-submit-controls p.character-limit",F).remove();var C;var D;if(B("#ugc-photo-gallery").length==0){C=E.config.get(A.config("commentMaxLength"));D=B(F).find("textarea");}else{C=E.config.get(A.config("photoCommentMaxLength"));D=B(F).find("textarea");}B(".echo-submit-controls",F).prepend('<p class="character-limit">Limit '+C+' characters (<span class="characters-remaining">'+C+"</span> characters remaining)</p>");D.bind("keyup",function(){var H=B(this).val().length;if(H>C){B(this).val(B(this).val().substr(0,C));H=B(this).val().length;}B(".characters-remaining",F).html(C-H);});};A.postButtonRenderer=function(D,E){var C=this;C.parentRenderer("postButton",arguments);if(!wp_e2.echo_user.logged()){this.config.set("submissionProxyURL",C.config.get(A.config("proxyURL")));}else{this.config.set("submissionProxyURL",C.config.get(A.config("echoSubmissionProxyURL")));}};A.getStatus=function(C){if(C.user.logged()){return"logged";}if(A.getPermissions(C)=="forceLogin"){return"forcedLogin";}return"anonymous";};})(jQuery);(function(B){var A=Echo.createPlugin({"name":"SubmitAuth","applications":["Auth"],"init":function(E,D){E.extendRenderer("Auth","name",E.nameRenderer);E.extendRenderer("Auth","edit",E.editRenderer);E.extendRenderer("Auth","logout",E.logoutRenderer);E.extendRenderer("Auth","avatar",E.avatarRenderer);var C=D.config.get(E.config("webType"))||"article_story";D.config.set(E.config("webType"),C);var F=D.config.get(E.config("displayUGCPhotos"))||false;D.config.set(E.config("displayUGCPhotos"),F);D.config.set(E.config("logoutURL"),D.config.get(E.config("logoutURL")));}});A.nameRenderer=function(D){var C=this;C.parentRenderer("name",arguments);var F="Your washingtonpost.com MyPost ID, ";var E=(C.config.get(A.config("displayUGCPhotos"))===true)?", will be displayed with your photo.":((C.config.get(A.config("webType")).toLowerCase()==="discussion_story")?", will be displayed with your post.":", will be displayed with your comment.");B(D).html("");B(D).append('<div class="left" style="width:100%;"><p>'+F+"<strong>"+C.user.get("name")+"</strong>"+E+'</p><p class="submit-box-links"><a href="'+C.config.get(A.config("logoutURL"))+'">Sign out</a></p>');};A.editRenderer=function(C){B(C).remove();};A.logoutRenderer=function(C){B(C).remove();};A.avatarRenderer=function(E){var D=this;var C=wp_e2.echo_user.get("avatar",wp_e2.echo_user.get("defaultAvatar"));var G="";var F="";ovrlay="";if(C==="http://www.washingtonpost.com/rw/sites/twpweb/img/echo2/core/avatar-default.png"){F="Add photo";}else{F="Change<br/>photo";}if(!wapoIdentity.isFacebookConnected()){G='href="https:'+wapoEnv.wapo_site_url+"siteRegistration/changeProfilePic?previous_url="+encodeURIComponent(window.location)+"&KeepThis=true&jskit_channel="+Backplane.getChannelID()+"&TB_iframe=true&height=200&width=400&modal=true"+'"';ovrlay='<a class="comment-overlay"'+G+">";B(E).html(ovrlay+'<img src="'+C+'"></a> <br />'+ovrlay+'<span class="photo-change-url">'+F+"</span>");}else{B(E).html(ovrlay+'<img src="'+C+'">');}};})(jQuery);(function(B){var A=Echo.createPlugin({"name":"ReplyForm","applications":["Submit"],"dependencies":[{"application":"Auth","url":((typeof eidosBase!=="undefined"&&eidosBase!=="")?eidosBase:"")+"/rw/sites/twpweb/js/echo2/v2/core/auth.js"}],"init":function(E,D){E.extendRenderer("Submit","header",E.headerRenderer);E.extendRenderer("Submit","postButton",E.postButtonRenderer);E.extendRenderer("Submit","container",E.containerRenderer);D.config.set(E.config("proxyURL"),D.config.get(E.config("proxyURL")));D.config.set(E.config("echoSubmissionProxyURL"),D.config.get(E.config("echoSubmissionProxyURL")));var C=D.config.get(E.config("commentMaxLength"))||3000;D.config.set(E.config("commentMaxLength"),C);}});A.postButtonRenderer=function(D,E){var C=this;C.parentRenderer("postButton",arguments);if(!wp_e2.echo_user.logged()){this.config.set("submissionProxyURL",C.config.get(A.config("proxyURL")));}else{this.config.set("submissionProxyURL",C.config.get(A.config("echoSubmissionProxyURL")));}};A.headerRenderer=function(E,F){var C=this;E=C.parentRenderer("header",arguments);not_logged_msg='<div class="left" style="width:100%;"><p><strong>You are not signed in.</strong> You may post a reply, and your comment will be saved while you are guided through the sign-in process.</p>';no_id_msg='<div class="left" style="width:100%;"><p><strong>You must create a MyPost ID to comment or post.</strong> You may post a reply, and your comment will be saved while you are guided through the process to create a unique MyPost ID.</p></div>';this_msg=(wapoIdentity.isPostIdMissing())?no_id_msg:not_logged_msg;if(!wp_e2.echo_user.logged()){B(".echo-submit-anonymousUserInfoAvatar",E).addClass("hidden");B(".echo-submit-anonymousUserInfoFields",E).append(this_msg);B("input.echo-submit-anonymousUserInfoUrl",E).addClass("hidden");var D=B("input.echo-submit-anonymousUserInfoName",E);D.addClass("hidden");if(D!==null){D.val("Guest");}}return E;};A.containerRenderer=function(F,G){var E=this;E.parentRenderer("container",arguments);F.removeClass("echo-submit-logged echo-submit-anonymous echo-submit-forcedLogin");if(!wp_e2.echo_user.logged()){B("div.echo-submit-auth",F).addClass("hidden");}else{B("div.echo-submit-auth",F).removeClass("hidden");}B(".echo-submit-controls p.character-limit",F).remove();var C;var D;C=E.config.get(A.config("commentMaxLength"));D=B(F).find("textarea");B(".echo-submit-controls",F).prepend('<p class="character-limit"><span class="characters-remaining">'+C+"</span> characters remaining</p>");D.bind("keyup",function(){var H=B(this).val().length;if(H>C){B(this).val(B(this).val().substr(0,C));H=B(this).val().length;}B(".characters-remaining",F).html(C-H);});};})(jQuery);(function(B){var A=Echo.createPlugin({"name":"ReplyAuth","applications":["Auth"],"init":function(D,C){D.extendRenderer("Auth","name",D.nameRenderer);D.extendRenderer("Auth","edit",D.editRenderer);D.extendRenderer("Auth","logout",D.logoutRenderer);D.extendRenderer("Auth","avatar",D.avatarRenderer);}});A.editRenderer=function(C){B(C).remove();};A.logoutRenderer=function(C){B(C).remove();};A.avatarRenderer=function(C){B(C).remove();};A.nameRenderer=function(D){var C=this;C.parentRenderer("name",arguments);var E="Your washingtonpost.com MyPost ID, ";if(wapoIdentity.isFacebookConnected()){E="Your Facebook ID, ";}B(D).replaceWith("<p>"+E+C.user.get("name")+", will be displayed with your reply.</p>");};})(jQuery);