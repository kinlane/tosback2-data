(function(a,f){function e(c){if(a.lightbox.settings.inited)return!0;a.lightbox.settings.inited=!0;a.lightbox.settings.self&&a.lightbox.settings.self.trigger("init.lightbox");c&&a.extend(a.lightbox.settings,c);a("body").append(a.lightbox.settings.html);var b=[new Image];b[0].src=a.lightbox.settings.closeImage;a("#lightbox").find(".lb-b:first, .lb-bl, .lb-br, .lb-tl, .lb-tr").each(function(){b.push(new Image);b.slice(-1).src=a(this).css("background-image").replace(/url\((.+)\)/,"$1")});a("#lightbox #lb-close").click(a.lightbox.close); a("#lightbox #lb-close-image").attr("src",a.lightbox.settings.closeImage)}a.lightbox=function(c,b){b||(b=a(document));a.lightbox.loading(b);a.lightbox.show(c)};a.extend(a.lightbox,{settings:{opacity:0,overlay:!0,bodyClickClose:!0,fixed:!0,closeImage:"",closeLink:"",fadeSpeed:200,windowLeft:0,initLeft:180,initHeight:100,initWidth:200,html:'<div id="lightbox" style="display:none;"><div class="lb-popup"><table id="lb-table"><tbody><tr><td class="lb-tl"/><td class="lb-b"/><td class="lb-tr"/></tr><tr><td class="lb-b">&nbsp;</td><td class="lb-body"><div class="lb-header"><a href="#" id="lb-close"><img title="close" id="lb-close-image" /></a></div><div id="lb-content" class="lb-content"></div></td><td class="lb-b">&nbsp;</td></tr><tr><td class="lb-bl"/><td class="lb-b"/><td class="lb-br"/></tr></tbody></table></div></div>', IsModal:!1},loading:function(c){this.settings.self=a(c);e();a.lightbox.settings.overlay&&(0===a("#lb-overlay").length&&a("body").append('<div id="lb-overlay" class="lb-hide"></div>'),"block"!==a("#lb-overlay")[0].style.display&&(a.lightbox.settings.IsModal?a("#lb-overlay").hide().addClass("lb-overlay-bg").css("opacity",a.lightbox.settings.opacity).fadeIn(a.lightbox.settings.fadeSpeed):a("#lb-overlay").hide().addClass("lb-overlay-bg").css("opacity",a.lightbox.settings.opacity).click(function(){a.lightbox.close()}).fadeIn(a.lightbox.settings.fadeSpeed))); !this.settings.overlay&&this.settings.bodyClickClose&&a(document).bind("click",function(){a.lightbox.close();return!0});a(document).bind("keydown.lightbox",function(b){27==b.keyCode&&a.lightbox.close();return!0});this.settings.self.trigger("loading.lightbox")},show:function(c){this.settings.self.trigger("beforeShow.lightbox");var b=a("#lb-content").children().hide();a("#lb-content").append(c);a("#lightbox").show();a("#lightbox .lb-body").length?a("#lightbox .lb-body").children().fadeIn("normal"): a("#lightbox").children().fadeIn("normal");this.settings.closeLink&&a(this.settings.closeLink,a("#lb-content")).css("cursor","pointer").click(a.lightbox.close);this.settings.IsModal&&a("#lightbox #lb-close").remove();c=this.settings.windowWidth||a(window).width();var f=a("#lightbox").height(),e=a("#lightbox").width(),g=a(window).scrollTop(),d;self.innerHeight?d=self.innerHeight:document.documentElement&&document.documentElement.clientHeight?d=document.documentElement.clientHeight:document.body&&(d= document.body.clientHeight);d=g+(d/2-f/2);0>d&&(d=10);a("#lightbox").css({top:d,left:c/2-e/2+this.settings.windowLeft});!this.settings.overlay&&this.settings.bodyClickClose&&a("#lightbox").bind("click",function(a){a.stopPropagation()});this.settings.self.trigger("show.lightbox").trigger("afterShow.lightbox");b.length&&b.remove()},close:function(){a(document).unbind("keydown.lightbox");a("#lightbox").fadeOut(function(){a("#lb-content").removeClass().addClass("lb-content");a.lightbox.settings.overlay&& a("#lb-overlay").fadeOut(a.lightbox.settings.fadeSpeed,function(){a("#lb-overlay").removeClass("lb-overlay-bg").addClass("lb-hide").remove()});a("#lb-content").empty()});a.lightbox.settings.self.trigger("close.lightbox");return!1}});a.fn.lightbox=function(c){e(c);return this.click(function(){a.lightbox.loading(this);a.get(c.href,function(b){a.lightbox.show(b)});return!1})};f.lightbox=function(c,b){var e=a.extend({},f.lightbox.defaults,b);return a(c).css("cursor","pointer").lightbox(e)};f.lightbox.defaults= {fadeSpeed:300,windowLeft:130,opacity:0.6}})(jQuery,eBags);