(function (a, b) { b.microCart = function (i) { function k() { a(document).unbind("click"); d = a("#" + c.pcartId); d.animate({ top: -d.height() + "px" }, c.speed); f = true } function p(g, q) { var e, f; e = a(c.containerSelector); f = e.offset(); f.width = e.width(); d = a("#" + c.pcartId); d.length === 0 && (d = a('<div id="' + c.pcartId + '"></div>')); g && d.html(g); if (!b.microCart.cartItemCount || b.microCart.cartItemCount < a(g).find("#cartItemCount").text()) b.microCart.cartItemCount = a(g).find("#cartItemCount").text(), b.microCart.originalCartItemCount = a(g).find("#originalCartItemCount").text(); b.microCart.cartItemCount ? (window.scrollTo(0, 0), e.append(d), typeof sr_updateMessages == "function" && sr_updateMessages(), d.css({ position: "absolute", top: -d.height() + "px", left: f.left + f.width - c.width + "px", "z-index": 1E3 }), a.fn.easyTooltip && a("a#freeReturns").easyTooltip({ xOffset: -310, tooltipId: "easyTooltip", content: "<h4>Hassle Free Returns:</h4><p>We unconditionally guarantee all merchandise for 60 days from the receipt of shipment. If you are not completely satisfied with your purchase for any reason, you may return any unused or defective merchandise FREE, for a prompt refund or exchange.</p>" }), a.fn.bgiframe && d.bgiframe(), d.animate({ top: "0px" }, c.speed, function () { d.bind("click", function (a) { a.stopPropagation() }); a(document).bind("click", function () { k(); return true }) }), a(c.closeLinkSelector, d).css("cursor", "pointer").click(k), j && (e = "Cart: " + b.microCart.cartItemCount + " item", b.microCart.cartItemCount > 1 && (e += "s"), a(c.cartItemCountSelector).html(e)), e = { events: [b.events.cart.hoverView], pageName: "Shopping Cart : View Hover Cart", channel: "Shopping Cart", prop5: "Shopping Cart", eVar8: "Shopping Cart" }, j && (e.events.push(b.events.cart.add), b.microCart.originalCartItemCount === 0 && e.events.push(b.events.cart.open)), b.trackPage(e), d.find("[data-linkName]").each(function () { var c = a(this); c.bind("click", { events: b.events.cart.hoverClick, linkName: c.attr("data-linkName") }, b.trackEvent) })) : q && l() } function m(a, b) { switch (a) { case 26: return '<div>Want to order more items? Please visit eBags Corporate Solutions site at, <a href="http://www.ebagscorporate.com" target="_blank">www.eBagsCorporate.com</a>.</div>'; case 27: case 28: return '<div><h1 style="color: #c00">Product is Unavailable</h1><p>We apologize, but the requested product is currently unavailable or out-of-stock and has been removed from your shopping cart.</p><p>Please call us at <strong>1-800-820-6126</strong> if you have questions.</p><div>'; case 29: return "<div>" + b + "<div>"; default: return c.errorHtml } } function l() { var g = ""; if (a.isArray(b.microCart.error)) for (; 0 < b.microCart.error.length; ) { g += m(b.microCart.error[0].messageId, b.microCart.error[0].message); break } else g = m(); g = '<div style="width: 315px; padding: 5px;">' + g + "</div>"; a.lightbox ? n(g) : a.getScript(c.cdnFilePrepend + "/Utils/JAVASCRIPT/eBags.lightbox.min.js", function () { n(g) }); a.ajax({ url: "/logme.cfm?message=CartError!+" + escape(document.cookie) + "&machine=" + top.location.host, type: "GET", cache: false }) } function n(b) { a.lightbox.settings.windowLeft = 0; a.lightbox.settings.overlay = true; a.lightbox.settings.closeImage = c.lightboxCloseImg; a.lightbox(b) } function o(b, d) { var e = c.url; d && (e += "?itemAdded=true"); if (f) f = false, document.body.style.cursor = "progress", a.ajax({ url: e, data: a(d).serialize(), dataType: "html", type: "POST", cache: false, success: function (a) { if (d != null && typeof resx !== "undefined") resx.event = "precart", resx.pageid = "", resx.links = "", resx.itemid = d[3].value, certonaResx.run(); p(a, b) }, error: function () { b && l() }, complete: function () { document.body.style.cursor = "auto"; c.enabledAddToCartButton && a(c.addToCartButtonSelector).removeAttr("disabled").attr("src", c.enabledAddToCartButton) } }) } var d, c = a.extend({}, b.microCart.defaults, i), h, f = true, j = false; h = a(c.containerSelector).find(c.cartInfoSelector); i = a(c.formSelector); h.length && (h.css("cursor", "help"), j = false, h.hover(function () { f = true; setTimeout(function () { o(false) }, c.timeout) }, function () { f = false }), h.click(function () { f = false })); i.length && i.submit(function () { var b; j = f = true; if (c.disabledAddToCartButton) b = a(c.addToCartButtonSelector), c.enabledAddToCartButton = b.attr("src"), b.attr("disabled", "disabled").attr("src", c.disabledAddToCartButton); o(true, this); return false }) }; b.microCart.defaults = { pcartId: "pcart", speed: 300, width: 276, url: "/blocks/ajax/persistentCart.cfm", timeout: 500, containerSelector: "#headerInnerContainer", closeLinkSelector: ".closeCartLink", formSelector: "#frmAddToCart", cartInfoSelector: "div.headerCartItems", cartItemCountSelector: "#lnkHeaderCartItems", addToCartButtonSelector: "#submitbutton", errorHtml: '<div><h1 style="color: #c00">Error</h1><p>There was problem adding this item to your cart.</p><p>Please call us at <strong>1-800-820-6126</strong>.</p></div>', cdnFilePrepend: ""} })(jQuery, eBags);