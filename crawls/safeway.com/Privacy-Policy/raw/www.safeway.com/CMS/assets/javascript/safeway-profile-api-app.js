/*
Copyright(c) 2013 Safeway, All Rights Reserved.  Usage is restricted to approved parties only.
*/
if(typeof JSON!=="object"){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());
/*
 * jQuery Cookie Plugin v1.3.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */
(function(a){if(typeof define==="function"&&define.amd&&define.amd.jQuery){define(["jquery"],a)}else{a(jQuery)}}(function(e){var a=/\+/g;function d(g){return g}function b(g){return decodeURIComponent(g.replace(a," "))}function f(g){if(g.indexOf('"')===0){g=g.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}try{return c.json?JSON.parse(g):g}catch(h){}}var c=e.cookie=function(p,o,u){if(o!==undefined){u=e.extend({},c.defaults,u);if(typeof u.expires==="number"){var q=u.expires,s=u.expires=new Date();s.setDate(s.getDate()+q)}o=c.json?JSON.stringify(o):String(o);return(document.cookie=[encodeURIComponent(p),"=",c.raw?o:encodeURIComponent(o),u.expires?"; expires="+u.expires.toUTCString():"",u.path?"; path="+u.path:"",u.domain?"; domain="+u.domain:"",u.secure?"; secure":""].join(""))}var g=c.raw?d:b;var r=document.cookie.split("; ");var v=p?undefined:{};for(var n=0,k=r.length;n<k;n++){var m=r[n].split("=");var h=g(m.shift());var j=g(m.join("="));if(p&&p===h){v=f(j);break}if(!p){v[h]=f(j)}}return v};c.defaults={};e.removeCookie=function(h,g){if(e.cookie(h)!==undefined){e.cookie(h,"",e.extend(g,{expires:-1}));return true}return false}}));
/*
 * jQuery postMessage - v0.5 - 9/11/2009
 * http://benalman.com/projects/jquery-postmessage-plugin/
 * 
 * Copyright (c) 2009 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($){var b,d,j=1,a,f=this,g=!1,h="postMessage",c="addEventListener",e,i=f[h]&&!$.browser.opera;$[h]=function(k,m,l){if(!m){return}k=typeof k==="string"?k:$.param(k);l=l||parent;if(i){l[h](k,m.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))}else{if(m){l.location=m.replace(/#.*$/,"")+"#"+(+new Date)+(j++)+"&"+k}}};$.receiveMessage=e=function(m,l,k){if(i){if(m){a&&e();a=function(n){if((typeof l==="string"&&n.origin!==l)||($.isFunction(l)&&l(n.origin)===g)){return g}m(n)}}if(f[c]){f[m?c:"removeEventListener"]("message",a,g)}else{f[m?"attachEvent":"detachEvent"]("onmessage",a)}}else{b&&clearInterval(b);b=null;if(m){k=typeof l==="number"?l:typeof k==="number"?k:100;b=setInterval(function(){var o=document.location.hash,n=/^#?\d+&/;if(o!==d&&n.test(o)){d=o;m({data:o.replace(n,"")})}},k)}}}})(jQuery);(function(e){var g=e.document,b=false,a="\x1F",d,h={},j,k;function c(l){this.name="InvalidKeyFormat";this.message=l+" is not a valid storage key name. Key names can only contain letters, numbers, period (.), hyphen (-), or  underscore (_) characters and must start with a letter."}c.prototype=new Error();c.prototype.constructor=c;function i(l){return(/^[a-z][a-z0-9_.\-]*$/gi).test(l)}try{b=(!e.localStorage&&g.documentElement.addBehavior)}catch(f){}if(b){j=new ActiveXObject("htmlfile");j.open();j.write('<iframe src="/a.b"></frame>');j.close();k=j.frames[0].document;d=k.createElement("div");k.appendChild(d);d.addBehavior("#default#userData");d.load("localStorage");h.loadKeyArray=function(){d.load("localStorage");return(d.getAttribute("_keys")||a).split(a).slice(1,-1)};h.isKey=function(l){d.load("localStorage");l=a+l+a;return d.getAttribute("_keys").indexOf(l)>=0};h.getLength=function(){this.length=this.loadKeyArray().length;return this.length};h.key=function(l){return(l>=this.getLength())?null:this.loadKeyArray()[l]};h.getItem=function(l){if(!i(l)){throw new c(l)}this.getLength();return(this.isKey(l))?(d.getAttribute(l)||null):null};h.setItem=function(l,m){d.load("localStorage");if(!i(l)){throw new c(l)}d.setAttribute(l,m);d.save("localStorage");if(!this.isKey(l)){d.setAttribute("_keys",d.getAttribute("_keys")+l+a)}d.save("localStorage");this.getLength()};h.removeItem=function(l){d.load("localStorage");if(!i(l)){throw new c(l)}if(this.isKey(l)){d.removeAttribute(l);var n=d.getAttribute("_keys"),m=a+l+a;d.setAttribute("_keys",n.replace(m,a))}d.save("localStorage");this.getLength()};h.clear=function(){var m=this.loadKeyArray(),l=m.length;while(l){l-=1;d.removeAttribute(m[l])}d.setAttribute("_keys",a);d.save("localStorage");this.getLength()};h.bootstrap=function(){var l;d.load("localStorage");l=d.getAttribute("_keys")||"";if(l.indexOf(a)===-1){d.setAttribute("_keys",a);d.save("localStorage")}this.getLength()};h.bootstrap();e.localStorage=h}}(window));(function(l){var w="swyConsumerDirectoryPro",i=",",E=l.localStorage,u=l.document,f=u.cookie,k=false,H={},h=function(){},d=h,m=h,G=h,r="stor.BoundItemNames",F="stor.BoundValue",y="stor.ItemNames",o="SWY_TEMP_",D="",g=l.Safeway||(l.Safeway={}),q={};g.Storage=H;if(E){try{E.setItem("t","v");E.removeItem("t");k=true}catch(C){if(E.length>0){E.clear();k=true}}}function t(K,L){var J=new Date(),e="; expires=";J.setTime(J.getTime()+432000000);e+=J.toGMTString();u.cookie=K+"="+L+e+"; path=/"}function c(e){var M=e+"=",L=u.cookie.split(/\s*;\s*/),K=L.length,J;while(K){K-=1;J=L[K];if(J.indexOf(M)===0){return J.substring(M.length,J.length)}}return null}function I(e){t(e,"",-1)}function p(){var K=u.cookie.split(/\s*;\s*/),J=K.length,e;while(J){J-=1;e=K[J];if(e.indexOf(o)===0){I(e.substring(0,e.indexOf("=")))}}return null}H.on=function(J,e){if(typeof e!=="function"){return}if(!q.hasOwnProperty(J)){q[J]=[]}q[J].push(e)};H.un=function(L,K){if(typeof K!=="function"||!q.hasOwnProperty(L)){return}var J=q[key]||[],e=J.count;while(e){e-=1;if(J[e]===K){J.splice(e,1);return}}};function n(J,L){var K=q[J]||[],e=K.length;while(e){e-=1;K[e].call(H,{key:J,value:L})}}function v(e){n(e.key,e.newValue)}if(k){d=function(K,L){var J=m(K);if(J===L){return}try{E.setItem(K,L);n(K,L)}catch(M){}};m=function(e){var J=E.getItem(e);if(typeof J==="string"&&J.replace(/\s+/,"").length===0){J=null}return J==null?null:J};G=function(e){var J=E.removeItem(e);n(e,"");return J};if(l.addEventListener){l.addEventListener("storage",v,false)}else{if(l.attachEvent){l.attachEvent("onstorage",v)}}}else{r=o+r;F=o+F;y=o+y;D=o+"stor_";d=function(J,K){var e=m(J);if(e===K){return}t(J,K);n(J,K)};m=function(e){var J=c(e);if(typeof J==="string"&&J.replace(/\s+/,"").length===0){J=null}return J==null?null:J};G=function(e){I(e);n(e,"")}}function B(){var M=c(w)||"",L=m(F)||"",e,K,J;if(M===L){return}e=(m(r)||"").split(i);K=e.length;while(K){K-=1;J=e[K];if(J){d(J,"")}}d(F,M||"");p()}B();function A(J){var e=(m(r)||i);if(e.indexOf(i+J+i)===-1){d(r,e+J+i)}}function b(J){var e=(m(r)||i);if(e.indexOf(i+J+i)!==-1){d(r,e.replace(i+J+i,i))}}function x(){var e=(m(r)||i);return(e.length===1)?[]:e.slice(1,-1).split(i)}function a(J){var e=(m(y)||i);if(e.indexOf(i+J+i)===-1){d(y,e+J+i)}}function s(J){var e=(m(y)||i);return e.indexOf(i+J+i)!==-1}function z(J){var e=(m(y)||i);if(e.indexOf(i+J+i)!==-1){d(y,e.replace(i+J+i,i))}}function j(){var e=(m(y)||i);return(e.length===1)?[]:e.slice(1,-1).split(i)}H.set=function(J,K,e){J=D+J;B();d(J,K);if(!e){A(J)}else{b(J)}a(J)};H.get=function(e){e=D+e;B();return m(e)};H.clear=function(e){e=D+e;G(e);z(e);b(e)};H.keys=j}(window));(function(b,a,d){var c=a.Safeway||(a.Safeway={});c.Profile=(function(i){var t=c.config||{},s=t.apiKey||"emjou",v=t.bannerName||"safeway",g=true,m={general:"SWYPF10000",invalidArguments:"SWYPF10001"},l={code:m.general,message:"An error has occurred while executing this function."},e={SWY_API_KEY:s,SWY_BANNER:v,SWY_VERSION:"1.0","X-SWY_API_KEY":s,"X-SWY_BANNER":v,"X-SWY_VERSION":"1.0"},j={category:[]},r=i.cookie("swyConsumerDirectoryPro")||false,h={},k=false,q={getCardCount:"/J4UProgram1/services/mycard/count",getListCount:"/emlss/services/integratedshoppinglist/list/getCount",getRewardPoints:"/emmd/service/rewards/getRewards",getPreferences:"/rssapi/rest/account/preference",setPreferences:"/rssapi/rest/account/updatepref"};j.slpreference="CO";if(r){e.SWY_SSO_TOKEN=r;e["X-SWY_SSO_TOKEN"]=r}function u(x){var A=this.events[x],y=[],w,z,B;if(!A||0===A.length){return}for(z=1,B=arguments.length;z<B;z++){y.push(arguments[z])}for(z=0,B=A.length;z<B;z++){w=A[z];w.fn.apply(w.scope||this,y.concat([w.opts||{}]))}}function o(w){var x=this.dm.get(w);if(x!=d){try{x=x!==""?JSON.parse(x):x}catch(y){x=d}}else{x=d}return x}function f(y,z){var z=z!=null?z:g;var w=q[y];if(w!=null&&z){var x=new Date().getTime();if((w.indexOf("&")!==-1)||(w.indexOf("?")!==-1)){w+="&_dc="+x}else{w+="?_dc="+x}}return w}function n(A,B,C,w){A=A||{};if(A.callback){A.callback.call(A.scope||this,A,C,w)}if(C){if(A.success){var x=[];var z=B?B.length:0;for(var y=0;y<z;y++){x.push(B[y])}x.push(A);A.success.apply(A.scope||this,x)}}else{if(A.failure){A.failure.call(A.scope||this,B,A)}}}function p(x,y){var w=y==d?d:JSON.stringify(y);this.dm.set(x,w)}return{dm:k?Safeway.Storage:{set:function(y,x){var w=this.store||(this.store={});w[y]=x},get:function(x){var w=this.store||(this.store={});return w[x]}},events:{rewardpointschange:[],cardcountchange:[],listcountchange:[],preferenceschange:[]},on:function(x,w,z,A){var y=this.events[x];if(!y||!w){return}y.push({fn:w,scope:z,opts:A})},un:function(y,x,B,C){var A=this.events[y],w,z;if(!A||!x){return}for(z=A.length-1;z>=0;z--){w=A[z];if(x===w.fn&&(!w.scope||w.scope===B)&&(!w.opts||w.opts===C)){A.splice(z,1)}}},getCardCount:function(w){var x=h.getCardCount||(h.getCardCount=[]),y=x.length;x.push(w);if(y===0){this.getCardCountCallback(w)}},getCardCountCallback:function(z){var y=this,w="cardCount",x=o.call(this,w);if(x==null){i.ajax({accepts:{json:"application/json"},dataType:"json",url:f("getCardCount"),type:"GET",headers:e}).always(function(E,I,D){x=E.myCardCount;var H=x!=null,B=E.errors||l,C=h.getCardCount,A=C.length,F=0;if(H){B=[x];p.call(y,w,x)}else{B=i.isArray(B)?B[0]:B}for(;F<A;F++){var G=C[F];n.call(y,G,B,H,D)}h.getCardCount=[]})}else{n.call(y,z,[x],true,d);h.getCardCount=[]}},getListCount:function(x){var w=h.getListCount||(h.getListCount=[]),y=w.length;w.push(x);if(y===0){this.getListCountCallback(x)}},getListCountCallback:function(A){var z=this,x="listCount",y=o.call(this,x),w=h.getListCount;if(y==null){i.ajax({accepts:{json:"application/json"},dataType:"json",url:f("getListCount"),type:"GET",headers:e}).always(function(F,B,C){y=F.noShoppingListItems;var I=y!=null,H=F.errors||l,G=w.length,E=0;if(I){H=[y];p.call(z,x,y)}else{H=i.isArray(H)?H[0]:H}for(;E<G;E++){var D=w[E];n.call(z,D,H,I,C)}h.getListCount=[]})}else{n.call(z,A,[y],true,d);h.getListCount=[]}},getPreference:function(x){var w=h.getPreference||(h.getPreference=[]),y=w.length;w.push(x);if(y===0){this.getPreferenceCallback(x)}},getPreferenceCallback:function(B){var A=this,C="customerPreference",z="preferences",x=o.call(this,z),w=B.preference;if(!w){n.call(A,B,{code:m.invalidArguments,message:"Invalid argument, missing required property: preference"},false,d)}else{if(!x||!x[C]||!x[C][w]){x=x||{};i.ajax({accepts:{json:"application/json"},dataType:"json",url:f("getPreferences"),type:"GET",headers:e,timeout:B.timeout&&parseInt(B.timeout,10)>0?parseInt(B.timeout,10):0}).always(function(I,P,G){var O=isNaN(I.ack)?1:parseInt(I.ack,10),N=O===0,F=I.errors||l,J=h.getPreference,D=J.length,H=0;if(N){var E=I.userAccount,K,L;i.extend(E,x);K=E[C]||(E[C]={});if(K[w]){L=K[w];N=L!=null}else{if(j[w]){L=K[w]=j[w]}}p.call(A,z,E);F=[L]}else{F=i.isArray(F)?F[0]:F}for(;H<D;H++){var M=J[H];n.call(A,M,F,N,G)}h.getPreference=[]})}else{var y=x[C][w];n.call(A,B,[y],true,d);h.getPreference=[]}}},getRewardPoints:function(w){var y=h.getRewardPoints||(h.getRewardPoints=[]),x=y.length;y.push(w);if(x===0){this.getRewardPointsCallback(w)}},getRewardPointsCallback:function(z){var y=this,x="rewardPoints",w=o.call(this,x);if(w==null){i.ajax({accepts:{json:"application/json"},dataType:"json",headers:e,type:"GET",url:f("getRewardPoints")}).always(function(E,I,D){w=E.rewards;var H=w!=null,C=E.errors||l,A=h.getRewardPoints,B=A.length,F=0;if(H){C=[w];p.call(y,x,w)}else{C=i.isArray(C)?C[0]:C}for(;F<B;F++){var G=A[F];n.call(y,G,C,H,D)}h.getRewardPoints=[]})}else{n.call(y,z,[w],true,d);h.getRewardPoints=[]}},incrementCardCount:function(x){var w="cardCount",y=o.call(this,w);var z=y!=null?y+x:x;this.setCardCount(z);return z},incrementListCount:function(x){var w="listCount",y=o.call(this,w);var z=y!=null?y+x:x;this.setListCount(z);return z},setCardCount:function(w){if(!isNaN(w)){p.call(this,"cardCount",w);u.call(this,"cardcountchange",w)}else{n.call(this,w,{code:m.invalidArguments,message:"Missing or invalid argument: count.  Expected an integer >= 0"},false,d)}},setListCount:function(w){if(!isNaN(w)){p.call(this,"listCount",w);u.call(this,"listcountchange",w)}else{n.call(this,w,{code:m.invalidArguments,message:"Missing or invalid argument: count.  Expected an integer >= 0"},false,d)}},setPreference:function(w){var C=this,D="customerPreference",y=w.preference,z,A,B,x=false;if(y){z=y;if(typeof y==="array"){z={};for(A=0,B=y.length;A<B;A++){var E=y[A];if(E.name&&E.value){z[E.name]=E.value}else{x=false;break}}}else{if(y.name&&y.value){z={};z[y.name]=y.value;x=true}}if(x){z={customerPreference:z};i.ajax({accepts:{json:"application/json"},contentType:"application/json",data:JSON.stringify(z),dataType:"json",headers:e,type:"POST",url:f("setPreferences",false)}).always(function(I,N,H){var M=isNaN(I.ack)?1:parseInt(I.ack),L=M===0,G=I.errors||l;if(L){var K="preferences",J=(o.call(C,K)||{}),F=J[D]||(J[D]={});F[y.name]=y.value;p.call(C,K,J);G=[y.value];u.call(C,"preferenceschange",y)}n.call(C,w,G,L,H)})}}if(!x||!y){n.call(this,w,x?l:{code:m.invalidArguments,message:"Invalid argument, missing or invalid value for property: preference"},false,d)}},setRewardPoints:function(w){p.call(this,"rewardPoints",w);u.call(this,"rewardpointschange",w)}}})(b)})(jQuery,window);(function(g,f){f.console=f.console||(f.console={log:function(){}});f.Safeway=f.Safeway||{};var d=f.Safeway.Profile;function b(){var k=Array.prototype.slice.call(arguments||[]),l=k.length;var i=k.slice(0,l-1),m=k[l-1],j=m.response;if(l===1){i.push(m)}j["arguments"]=i;console.log("<!---",j);g.postMessage(JSON.stringify(j),a)}function e(){var k=Array.prototype.slice.call(arguments||[]),l=k.length;var i=k.slice(0,l-1),m=k[l-1],j=m.response;if(l===1){i.push(m)}j.success=false;j["arguments"]=i;console.log("<!---",j);g.postMessage(JSON.stringify(j),a)}function h(){var i={getCardCount:{async:true},getListCount:{async:true},getRewardPoints:{async:true},getPreference:{async:true},incrementCardCount:{async:false},incrementListCount:{async:false},setCardCount:{async:false},setListCount:{async:false},setPreference:{async:true},setRewardPoints:{async:false}};g.receiveMessage(function(r){console.log("--->",JSON.parse(r.data));var n=JSON.parse(r.data),j=n.method,k=n.id,q=n["arguments"]||[],l={success:true,id:k,arguments:[]};var s=i[j];if(typeof s!=="undefined"){var m=q;if(s.async){m=[g.extend(m.length?m[0]:{},{success:b,failure:e,response:l,opts:n,scope:this})];try{d[j].apply(d,m)}catch(p){l.success=false;l["arguments"].concat([{code:"SWYPRF10000",message:"Error while executing method: "+j}])}}else{var o=d[j].apply(d,m);if(o!=undefined){if(g.isArray(o)){l["arguments"].push([].concat(o))}else{l["arguments"].push(o)}}console.log("<!---",l);g.postMessage(JSON.stringify(l),a)}}else{l.success=false;l["arguments"].concat([{code:"SWYPRF10000",message:"Invalid method: "+j},q]);console.log("<!---",l);g.postMessage(JSON.stringify(l),a)}},a.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))}var a=decodeURIComponent(document.location.hash.replace(/^#/,"")),c=false;if(typeof d==="object"){if(!g.fn.postMessage){h();c=true}else{console.log("Safeway.Profile.IframeAdapter: $.postMessage not found; this plugin is required.")}}else{console.log("Safeway.Profile.IframeAdapter: Safeway.Profile was not found; this object is required.")}return{enabled:c}})(jQuery,window);
