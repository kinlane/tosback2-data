$(document).bind("ad:load",function(a,d,b,f,c){a=$("#"+c).parent();a.length&&"in-article"==d&&(d=a.find("a.lightbox"),a={iframe:!0,transition:"fade",fastIframe:!1,fixed:!0,onOpen:function(){$("#colorbox").addClass("sponsored")},onClosed:function(){$("#colorbox").removeClass("sponsored")}},b=d.data("lightboxWidth"),f=d.data("lightboxHeight"),b&&(a.width=b),f&&(a.height=f),d.colorbox(a))});
$(document).ready(function(){function a(a){$(a).val().toLowerCase()==$(a).attr("longdesc").toLowerCase()&&($(a).val(""),$(a).removeClass("label"))}function d(a){""==$(a).val().toLowerCase()&&($(a).val($(a).attr("longdesc")),$(a).addClass("label"))}$.browser.msie&&9>$.browser.msie.version&&$lis.hover(function(){$(this).addClass("hovered")},function(){$(this).removeClass("hovered")});$("#nav-social .search-icon").each(function(){var a=null;$(this).hover(function(){null!==a&&(window.clearTimeout(a),
a=null);$(this).addClass("hovered")},function(){if(null===a){var c=this;a=window.setTimeout(function(){$(c).removeClass("hovered");c=null},500)}})});adFunctions();setTimeout("adFunctions()",250);setTimeout("adFunctions()",1E3);setTimeout("adFunctions()",3E3);$("#search #query").val("SEARCH OUR SITE").focus(function(){"SEARCH OUR SITE"==$(this).val()&&$(this).val("")}).blur(function(){""==$(this).val()&&$(this).val("SEARCH OUR SITE")});$("a.tab").click(function(){$("#searched").toggle();$("#emailed").toggle();
return!1});$("form.labeled input:text").focus(function(){a(this)});$(".labeled").submit(function(){$(this).find("input:text").each(function(){a(this)})});$("form.labeled input:text").blur(function(){d(this)});$("form.labeled input:text").each(function(){d(this)});$(".expandingMenu .expandingArrow").click(function(){var a=!0;!0==$(this).hasClass("open")&&(a=!1);$(".expandingMenu .expandingContent").slideUp(80);$(".expandingMenu .expandingArrow").removeClass("open");!0==a&&($(this).parent().find(".expandingContent").slideDown(80),
$(this).addClass("open"));return!1});$(".expandingMenu .expandingContent a").click(function(){$(this).parent().parent().parent().find(".expandingTitle").html("Loading...")});$("html").click(function(){$(".expandingMenu .expandingContent").slideUp(80);$(".expandingMenu .expandingArrow").removeClass("open")});$(".print").click(function(){window.open($(".print").attr("href"),"","width=800,height=480,scrollbars,resizable,location=no,menubar=no,toolbar=no");return!1});$(".authorEmail").length&&$(".authorEmail").each(function(){$(this).attr("href",
$(this).attr("href").replace(" at ","@"))});if(0<$("#ourLatestPost").length){window.latestOffset=0;latestPostWidth=335;(new Image).src="http://cdn.theatlantic.com/static/front/images/loadingSmall.gif";$("#ourLatestPost .nextEntryLink").live("click",function(){window.latestOffset++;$(".promoColumn #olpEntry"+window.latestOffset+"  .nextEntryLink").addClass("olpLoading");var a="/widget/recent/"+$("#olpEntry"+window.latestOffset+" .justInUnixDate").html()+"/"+window.latestOffset;$.getJSON(a,{},function(a){$("#ourLatestPost #olpScroll").append(Utf8.decode(a.output));
$("#ourLatestPost #olpScroll").animate({marginLeft:"-="+latestPostWidth+"px"},800);$(".promoColumn #olpEntry"+window.latestOffset+" .nextEntryLink").removeClass("olpLoading")});1==window.latestOffset&&$("#olp1 .previousEntryLink").fadeIn();b();return!1});$("#ourLatestPost .previousEntryLink").live("click",function(){1<=window.latestOffset&&(window.latestOffset--,$("#ourLatestPost #olpScroll").animate({marginLeft:"+="+latestPostWidth+"px"},800));b();return!1});$("#olpEntry1 .previousEntryLink").unbind("click");
var b=function(){window.clearTimeout(window.latestPostRefresh);window.latestPostRefresh=setTimeout(function(){$.getJSON("/widget/recent/",{},function(a){$(a.output).find(".justInUnixDate").html()>$("#olpEntry1 .justInUnixDate").html()&&(window.latestOffset=0,$("#ourLatestPost #olpScroll").animate({marginLeft:"0px"},1E3,function(){$("#ourLatestPost #olpScroll").html(a.output)}));b()})},3E5)};$("#ourLatestPost").length&&b()}$("a[href$='#disqus_thread']").each(function(a,c){var d=$(c).attr("disqus");
"undefined"!=typeof d&&"infocus"!=d.substring(0,7)&&$.getJSON("http://disqus.com/api/v1/get_num_posts/?thread_identifier="+d+"&forum_url=theatlantic&callback=?",function(a){a=a.num_posts;0!=a?($(c).text(a),$(c).show()):$(c).remove()})});$("#inFocusPage .articleContent").first().css("min-height","260px");var f=(new Date).getTime();if(window.ChineseWrap){var c=function(a,c){c.innerHTML=ChineseWrap.wrapTags(c.innerHTML)};$(".articleContent").each(c);$("h1.headline").each(c);$(".hasChinese.postContent").each(c);
$(".hasChinese h3.headline").each(c)}c=(new Date).getTime();window.loadTimes&&window.loadTimes.js&&(loadTimes.js.chinese_wrap=(c-f)/1E3)});function cm8_collapse(){$(".adPush").animate({height:"66px"},500)}function cm8_click(){location.href=$("#FLASH_AD param[name='href']").val()}function cm8_expand(){$(".adPush").animate({height:"418px"},500)}function FLASH_AD_DoFSCommand(a){"cm8_click"==a?cm8_click():"cm8_collapse"==a?cm8_collapse():"cm8_expand"==a&&cm8_expand()}
$(".relatedContentVideo .relatedArrowRight").click(function(){$("#relatedSlideshow").position().left>-(143*($("#relatedSlideshow li").length-4))&&$("#relatedSlideshow").animate({left:"-=143"},{duration:1E3,queue:!1});return!1});$(".relatedContentVideo .relatedArrowLeft").click(function(){0>$("#relatedSlideshow").position().left&&$("#relatedSlideshow").animate({left:"+=143"},{duration:1E3,queue:!1});return!1});
function adFunctions(){$(".ad").each(function(a,d){var b=$(d).hasClass("adInterstitial");$(d).find("img").each(function(a,c){$(c).attr("src")&&-1!=$(c).attr("src").search("grey.gif")&&(b?$(c).hide():($(d).hasClass("adBottomboxleft")&&$(d).parent().hide(),$(d).height(0),$(d).addClass("adNotLoaded")))})})}"object"!=typeof window.Atlantic&&(window.Atlantic={});
(function(){Atlantic.getMaxAdChildSize=function(a,b){b||(b={});for(var f={width:0,height:0},c="img embed div a object table iframe".split(" "),m=[],g=[],l=0;l<c.length;l++)for(var h=c[l],h=$(a).find(h),v=0;v<h.length;v++){var q=h[v],w=$(q).width(),q=$(q).height();if(1==b[w+"x"+q])return{width:w,height:q};m.push(w);g.push(q)}m.length&&g.length&&(f.width=Math.max.apply(Math,m),f.height=Math.max.apply(Math,g));return f};Atlantic.parseDartScriptSz=function(a){a=a.attr("src");if(!a)return[];var b=a.indexOf("sz=");
if(-1==b)return[];var f=a.slice(b).indexOf(";");return a.slice(b+3,-1==f?a.length:b+f).split(/,/)};var a=function(a,b,f,c,m){if("string"==typeof a){a=a.split(/\./);for(var g=0,l=a[g],h=window[l];"object"==typeof h&&g<a.length-1;)g++,l=a[g],h=h[l];a=h}"function"==typeof a&&(m="object"==typeof m&&m.length?m[0]:null,a.apply(m,[b,f,c,m]))};Atlantic.getAdSize=function(d,b,f){f||(f=0);var c="ad"+d.charAt(0).toUpperCase()+d.slice(1);if($("."+c).length){var m=$("."+c);if(-1<m.html().search("grey.gif"))a(b,
"failure",void 0,void 0);else{var g=Atlantic.parseDartScriptSz($("#"+c+"Script")),l={};$.each(g,function(a,c){l[c]=1});var h=Atlantic.getMaxAdChildSize(m),c=h.width,h=h.height;if(1==l[c+"x"+h])g="success";else if(1==l["0x0"]&&1<c&&1<h)g="success";else if(!g.length&&1<c&&1<h)g="success";else if(20<f&&0<c&&0<h)g="success";else if(20<f)g="failure";else{setTimeout(function(){Atlantic.getAdSize(d,b,f+1)},250);return}"failure"==g&&(h=c=void 0);a(b,g,c,h,m)}}else a(b,"failure",void 0,void 0)}})();
var Utf8={decode:function(a){for(var d="",b=0,f=c1=c2=0;b<a.length;)f=a.charCodeAt(b),128>f?(d+=String.fromCharCode(f),b++):191<f&&224>f?(c2=a.charCodeAt(b+1),d+=String.fromCharCode((f&31)<<6|c2&63),b+=2):(c2=a.charCodeAt(b+1),c3=a.charCodeAt(b+2),d+=String.fromCharCode((f&15)<<12|(c2&63)<<6|c3&63),b+=3);return d}};window.Atlantic=window.Atlantic||{};window.Atlantic.Omniture=window.Atlantic.Omniture||{};
$(function(){function a(a,b,g){switch(b){case "@":return $(a).attr(g);case "t":return g?$(g).text():$(a).text();case "l":return window.location[g];case "$":return a=$(a),g&&(a=a.parents(g).slice(0,1)),a.index();case "r":return g;default:return void 0!==window.console&&window.console.log&&console.log("Invalid command `"+b+"`."),""}}function d(a){for(var b;"HTML"!==a.tagName;){b=$(a).attr("data-omni-click");if(void 0!==b)break;a=a.parentNode}if(/^inherit/.test(b)){var g=a.parentNode;b=/inherit:(.*)/.exec(b);
null!==b&&(g=$(b),g=0===g.length?document.body:g[0]);b=d(g).expr}return{elem:a,expr:b}}Atlantic.Omniture.trackLink=/_debug_omniture/.test(window.location.search)?function(a){alert("Omniture test:"+a);return!1}:function(a,b){var g=function(){try{var b=s_gi(s_account);b.events="event1";b.tl(!0,"o",a)}catch(g){window.console&&window.console.log&&console.log("Omniture Error "+g)}};b?window.setTimeout(g,10):g();return!0};var b,f=/(@)([^,]+)|(e|r)'([^']+)'|(l|w).([\w]+)|(\$|t)([^,]*)/;b=function(a){for(var b=
[];;){var g=f.exec(a);if(null===g)return b;for(var d=1;d<g.length;d+=2)if(g[d]){b.push([g[d],g[d+1]]);break}a=a.substr(g[0].length+1)}};$(document.body).on("click omniclick.omniture","[data-omni-click]",function(c){var f=d(c.target),g=f.elem,f=f.expr;if(!(void 0===f||"A"!==g.tagName)){for(var f=b(f),l=[],h=0;h<f.length;h++)l.push(a.call(c.target,g,f[h][0],f[h][1]));g=l.join("`");Atlantic.Omniture.trackLink(g,!1)||(c.preventDefault(),c.stopPropagation())}})});(function(a){channel=location.pathname.split("/")[1];var d={years:"datepickerViewYears",moths:"datepickerViewMonths",days:"datepickerViewDays"},b=['<td><div class="datepickerInfo"><h5>All ENTRIES</h5><div class="datepickerWeekOptions"><a href="/'+channel+'/last-week/" class="datepickerPreviousWeek">&laquo; Previous Week</a><a href="/'+channel+'/this-week/" class="datepickerNextWeek">Current Week &raquo;</a></div><div class="datepickerDescription">Select a beginning and end date to search</div></div>',
'<table cellspacing="0" cellpadding="0" align="center">',"<thead>","<tr>",'<th class="datepickerGoPrev"><a href="#"><span><%=prev%></span></a></th>','<th colspan="5" class="datepickerMonth"><a href="#"><span></span></a></th>','<th class="datepickerGoNext"><a href="#"><span><%=next%></span></a></th>',"</tr>",'<tr class="datepickerDoW">',"<th><span><%=day1%></span></th>","<th><span><%=day2%></span></th>","<th><span><%=day3%></span></th>","<th><span><%=day4%></span></th>","<th><span><%=day5%></span></th>",
"<th><span><%=day6%></span></th>","<th><span><%=day7%></span></th>","</tr>","</thead>","</table></td>"],f='<tbody class="datepickerDays">;<tr>;<td class="<%=weeks[0].days[0].classname%>"><a href="#"><span><%=weeks[0].days[0].text%></span></a></td>;<td class="<%=weeks[0].days[1].classname%>"><a href="#"><span><%=weeks[0].days[1].text%></span></a></td>;<td class="<%=weeks[0].days[2].classname%>"><a href="#"><span><%=weeks[0].days[2].text%></span></a></td>;<td class="<%=weeks[0].days[3].classname%>"><a href="#"><span><%=weeks[0].days[3].text%></span></a></td>;<td class="<%=weeks[0].days[4].classname%>"><a href="#"><span><%=weeks[0].days[4].text%></span></a></td>;<td class="<%=weeks[0].days[5].classname%>"><a href="#"><span><%=weeks[0].days[5].text%></span></a></td>;<td class="<%=weeks[0].days[6].classname%>"><a href="#"><span><%=weeks[0].days[6].text%></span></a></td>;</tr>;<tr>;<td class="<%=weeks[1].days[0].classname%>"><a href="#"><span><%=weeks[1].days[0].text%></span></a></td>;<td class="<%=weeks[1].days[1].classname%>"><a href="#"><span><%=weeks[1].days[1].text%></span></a></td>;<td class="<%=weeks[1].days[2].classname%>"><a href="#"><span><%=weeks[1].days[2].text%></span></a></td>;<td class="<%=weeks[1].days[3].classname%>"><a href="#"><span><%=weeks[1].days[3].text%></span></a></td>;<td class="<%=weeks[1].days[4].classname%>"><a href="#"><span><%=weeks[1].days[4].text%></span></a></td>;<td class="<%=weeks[1].days[5].classname%>"><a href="#"><span><%=weeks[1].days[5].text%></span></a></td>;<td class="<%=weeks[1].days[6].classname%>"><a href="#"><span><%=weeks[1].days[6].text%></span></a></td>;</tr>;<tr>;<td class="<%=weeks[2].days[0].classname%>"><a href="#"><span><%=weeks[2].days[0].text%></span></a></td>;<td class="<%=weeks[2].days[1].classname%>"><a href="#"><span><%=weeks[2].days[1].text%></span></a></td>;<td class="<%=weeks[2].days[2].classname%>"><a href="#"><span><%=weeks[2].days[2].text%></span></a></td>;<td class="<%=weeks[2].days[3].classname%>"><a href="#"><span><%=weeks[2].days[3].text%></span></a></td>;<td class="<%=weeks[2].days[4].classname%>"><a href="#"><span><%=weeks[2].days[4].text%></span></a></td>;<td class="<%=weeks[2].days[5].classname%>"><a href="#"><span><%=weeks[2].days[5].text%></span></a></td>;<td class="<%=weeks[2].days[6].classname%>"><a href="#"><span><%=weeks[2].days[6].text%></span></a></td>;</tr>;<tr>;<td class="<%=weeks[3].days[0].classname%>"><a href="#"><span><%=weeks[3].days[0].text%></span></a></td>;<td class="<%=weeks[3].days[1].classname%>"><a href="#"><span><%=weeks[3].days[1].text%></span></a></td>;<td class="<%=weeks[3].days[2].classname%>"><a href="#"><span><%=weeks[3].days[2].text%></span></a></td>;<td class="<%=weeks[3].days[3].classname%>"><a href="#"><span><%=weeks[3].days[3].text%></span></a></td>;<td class="<%=weeks[3].days[4].classname%>"><a href="#"><span><%=weeks[3].days[4].text%></span></a></td>;<td class="<%=weeks[3].days[5].classname%>"><a href="#"><span><%=weeks[3].days[5].text%></span></a></td>;<td class="<%=weeks[3].days[6].classname%>"><a href="#"><span><%=weeks[3].days[6].text%></span></a></td>;</tr>;<tr>;<td class="<%=weeks[4].days[0].classname%>"><a href="#"><span><%=weeks[4].days[0].text%></span></a></td>;<td class="<%=weeks[4].days[1].classname%>"><a href="#"><span><%=weeks[4].days[1].text%></span></a></td>;<td class="<%=weeks[4].days[2].classname%>"><a href="#"><span><%=weeks[4].days[2].text%></span></a></td>;<td class="<%=weeks[4].days[3].classname%>"><a href="#"><span><%=weeks[4].days[3].text%></span></a></td>;<td class="<%=weeks[4].days[4].classname%>"><a href="#"><span><%=weeks[4].days[4].text%></span></a></td>;<td class="<%=weeks[4].days[5].classname%>"><a href="#"><span><%=weeks[4].days[5].text%></span></a></td>;<td class="<%=weeks[4].days[6].classname%>"><a href="#"><span><%=weeks[4].days[6].text%></span></a></td>;</tr>;<tr>;<td class="<%=weeks[5].days[0].classname%>"><a href="#"><span><%=weeks[5].days[0].text%></span></a></td>;<td class="<%=weeks[5].days[1].classname%>"><a href="#"><span><%=weeks[5].days[1].text%></span></a></td>;<td class="<%=weeks[5].days[2].classname%>"><a href="#"><span><%=weeks[5].days[2].text%></span></a></td>;<td class="<%=weeks[5].days[3].classname%>"><a href="#"><span><%=weeks[5].days[3].text%></span></a></td>;<td class="<%=weeks[5].days[4].classname%>"><a href="#"><span><%=weeks[5].days[4].text%></span></a></td>;<td class="<%=weeks[5].days[5].classname%>"><a href="#"><span><%=weeks[5].days[5].text%></span></a></td>;<td class="<%=weeks[5].days[6].classname%>"><a href="#"><span><%=weeks[5].days[6].text%></span></a></td>;</tr>;</tbody>'.split(";"),
c='<tbody class="<%=className%>">;<tr>;<td colspan="2"><a href="#"><span><%=data[0]%></span></a></td>;<td colspan="2"><a href="#"><span><%=data[1]%></span></a></td>;<td colspan="2"><a href="#"><span><%=data[2]%></span></a></td>;<td colspan="2"><a href="#"><span><%=data[3]%></span></a></td>;</tr>;<tr>;<td colspan="2"><a href="#"><span><%=data[4]%></span></a></td>;<td colspan="2"><a href="#"><span><%=data[5]%></span></a></td>;<td colspan="2"><a href="#"><span><%=data[6]%></span></a></td>;<td colspan="2"><a href="#"><span><%=data[7]%></span></a></td>;</tr>;<tr>;<td colspan="2"><a href="#"><span><%=data[8]%></span></a></td>;<td colspan="2"><a href="#"><span><%=data[9]%></span></a></td>;<td colspan="2"><a href="#"><span><%=data[10]%></span></a></td>;<td colspan="2"><a href="#"><span><%=data[11]%></span></a></td>;</tr>;</tbody>'.split(";"),
m={flat:!1,starts:1,prev:"&laquo;",next:"&raquo;",lastSel:!1,mode:"single",view:"days",calendars:1,format:"Y-m-d",position:"bottom",eventName:"click",onRender:function(){return{}},onChange:function(){return!0},onShow:function(){return!0},onBeforeShow:function(){return!0},onHide:function(){return!0},locale:{days:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),daysShort:"Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),daysMin:"Su Mo Tu We Th Fr Sa Su".split(" "),months:"January February March April May June July August September October November December".split(" "),
monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),weekMin:"wk"}},g=function(e){var b=a(e).data("datepicker");e=a(e);var j=Math.floor(b.calendars/2),k,g,u,d,x=0,n,r,l,m,s;e.find("td>table tbody").remove();for(var p=0;p<b.calendars;p++){k=new Date(b.current);k.addMonths(-j+p);s=e.find("table").eq(p+1);switch(s[0].className){case "datepickerViewDays":u=h(k,"B, Y");break;case "datepickerViewMonths":u=k.getFullYear();break;case "datepickerViewYears":u=k.getFullYear()-6+" - "+(k.getFullYear()+
5)}s.find("thead tr:first th:eq(1) span").text(u);u=k.getFullYear()-6;g={data:[],className:"datepickerYears"};for(d=0;12>d;d++)g.data.push(u+d);m=tmpl(c.join(""),g);k.setDate(1);g={weeks:[],test:10};d=k.getMonth();u=(k.getDay()-b.starts)%7;k.addDays(-(u+(0>u?7:0)));for(x=0;42>x;){r=parseInt(x/7,10);l=x%7;g.weeks[r]||(n=k.getWeekNumber(),g.weeks[r]={week:n,days:[]});g.weeks[r].days[l]={text:k.getDate(),classname:[]};d!=k.getMonth()&&g.weeks[r].days[l].classname.push("datepickerNotInMonth");0==k.getDay()&&
g.weeks[r].days[l].classname.push("datepickerSunday");6==k.getDay()&&g.weeks[r].days[l].classname.push("datepickerSaturday");n=b.onRender(k);var t=k.valueOf();(n.selected||b.date==t||-1<a.inArray(t,b.date)||"range"==b.mode&&t>=b.date[0]&&t<=b.date[1])&&g.weeks[r].days[l].classname.push("datepickerSelected");n.disabled&&g.weeks[r].days[l].classname.push("datepickerDisabled");n.className&&g.weeks[r].days[l].classname.push(n.className);g.weeks[r].days[l].classname=g.weeks[r].days[l].classname.join(" ");
x++;k.addDays(1)}m=tmpl(f.join(""),g)+m;g={data:b.locale.monthsShort,className:"datepickerMonths"};m=tmpl(c.join(""),g)+m;s.append(m)}},l=function(a,b){if(a.constructor==Date)return new Date(a);for(var j=a.split(/\W+/),k=b.split(/\W+/),g,c,d,f,n,l=new Date,h=0;h<j.length;h++)switch(k[h]){case "d":case "e":g=parseInt(j[h],10);break;case "m":c=parseInt(j[h],10)-1;break;case "Y":case "y":d=parseInt(j[h],10);d+=100<d?0:29>d?2E3:1900;break;case "H":case "I":case "k":case "l":f=parseInt(j[h],10);break;
case "P":case "p":/pm/i.test(j[h])&&12>f?f+=12:/am/i.test(j[h])&&12<=f&&(f-=12);break;case "M":n=parseInt(j[h],10)}return new Date(void 0===d?l.getFullYear():d,void 0===c?l.getMonth():c,void 0===g?l.getDate():g,void 0===f?l.getHours():f,void 0===n?l.getMinutes():n,0)},h=function(a,b){var j=a.getMonth(),k=a.getDate(),g=a.getFullYear();a.getWeekNumber();var c=a.getDay(),f=a.getHours(),d=12<=f,l=d?f-12:f,h=a.getDayOfYear();0==l&&(l=12);for(var m=a.getMinutes(),q=a.getSeconds(),s=b.split(""),p,t=0;t<
s.length;t++){p=s[t];switch(s[t]){case "a":p=a.getDayName();break;case "A":p=a.getDayName(!0);break;case "b":p=a.getMonthName();break;case "B":p=a.getMonthName(!0);break;case "C":p=1+Math.floor(g/100);break;case "d":p=10>k?"0"+k:k;break;case "e":p=k;break;case "H":p=10>f?"0"+f:f;break;case "I":p=10>l?"0"+l:l;break;case "j":p=100>h?10>h?"00"+h:"0"+h:h;break;case "k":p=f;break;case "l":p=l;break;case "m":p=9>j?"0"+(1+j):1+j;break;case "M":p=10>m?"0"+m:m;break;case "p":case "P":p=d?"PM":"AM";break;case "s":p=
Math.floor(a.getTime()/1E3);break;case "S":p=10>q?"0"+q:q;break;case "u":p=c+1;break;case "w":p=c;break;case "y":p=(""+g).substr(2,2);break;case "Y":p=g}s[t]=p}return s.join("")},v=function(e){var b=a(e).data("datepicker"),j=a("#"+b.id);b.extraHeight||(e=a(e).find("div"),b.extraHeight=e.get(0).offsetHeight+e.get(1).offsetHeight,b.extraWidth=e.get(2).offsetWidth+e.get(3).offsetWidth);var k=j.find("table:first").get(0);e=k.offsetWidth;k=k.offsetHeight;j.css({width:e+b.extraWidth+"px",height:k+b.extraHeight+
"px"}).find("div.datepickerContainer").css({width:e+"px",height:k+"px"})},q=function(e){a(e.target).is("span")&&(e.target=e.target.parentNode);var b=a(e.target);if(b.is("a")){e.target.blur();if(b.hasClass("datepickerDisabled"))return!1;var j=a(this).data("datepicker");e=b.parent();var k=e.parent().parent().parent(),f=a("table",this).index(k.get(0))-1,c=new Date(j.current),d=!1,l=!1;if(e.is("div"))return!0;if(e.is("th"))if(e.hasClass("datepickerWeek")&&"range"==j.mode&&!e.next().hasClass("datepickerDisabled")){var n=
parseInt(e.next().text(),10);c.addMonths(f-Math.floor(j.calendars/2));e.next().hasClass("datepickerNotInMonth")&&c.addMonths(15<n?-1:1);c.setDate(n);j.date[0]=c.setHours(0,0,0,0).valueOf();c.setHours(23,59,59,0);c.addDays(6);j.date[1]=c.valueOf();d=l=!0;j.lastSel=!1}else if(e.hasClass("datepickerMonth"))switch(c.addMonths(f-Math.floor(j.calendars/2)),k.get(0).className){case "datepickerViewDays":k.get(0).className="datepickerViewMonths";b.find("span").text(c.getFullYear());break;case "datepickerViewMonths":k.get(0).className=
"datepickerViewYears";b.find("span").text(c.getFullYear()-6+" - "+(c.getFullYear()+5));break;case "datepickerViewYears":k.get(0).className="datepickerViewDays",b.find("span").text(h(c,"B, Y"))}else{if(e.parent().parent().is("thead")){switch(k.get(0).className){case "datepickerViewDays":j.current.addMonths(e.hasClass("datepickerGoPrev")?-1:1);break;case "datepickerViewMonths":j.current.addYears(e.hasClass("datepickerGoPrev")?-1:1);break;case "datepickerViewYears":j.current.addYears(e.hasClass("datepickerGoPrev")?
-12:12)}l=!0}}else if(e.is("td")&&!e.hasClass("datepickerDisabled")){switch(k.get(0).className){case "datepickerViewMonths":j.current.setMonth(k.find("tbody.datepickerMonths td").index(e));j.current.setFullYear(parseInt(k.find("thead th.datepickerMonth span").text(),10));j.current.addMonths(Math.floor(j.calendars/2)-f);k.get(0).className="datepickerViewDays";break;case "datepickerViewYears":j.current.setFullYear(parseInt(b.text(),10));k.get(0).className="datepickerViewMonths";break;default:switch(n=
parseInt(b.text(),10),c.addMonths(f-Math.floor(j.calendars/2)),e.hasClass("datepickerNotInMonth")&&c.addMonths(15<n?-1:1),c.setDate(n),j.mode){case "multiple":n=c.setHours(0,0,0,0).valueOf();-1<a.inArray(n,j.date)?a.each(j.date,function(a,e){if(e==n)return j.date.splice(a,1),!1}):j.date.push(n);break;case "range":j.lastSel||(j.date[0]=c.setHours(0,0,0,0).valueOf());n=c.setHours(23,59,59,0).valueOf();n<j.date[0]?(j.date[1]=j.date[0]+86399E3,j.date[0]=n-86399E3):j.date[1]=n;j.lastSel=!j.lastSel;break;
default:j.date=c.valueOf()}}d=l=!0}l&&g(this);d&&j.onChange.apply(this,w(j))}return!1},w=function(e){var b;if("single"==e.mode)return b=new Date(e.date),[h(b,e.format),b,e.el];b=[[],[],e.el];a.each(e.date,function(a,k){var c=new Date(k);b[0].push(h(c,e.format));b[1].push(c)});return b},A=function(a,b,j){if(a==b)return!0;if(a.contains)return a.contains(b);if(a.compareDocumentPosition)return!!(a.compareDocumentPosition(b)&16);for(b=b.parentNode;b&&b!=j;){if(b==a)return!0;b=b.parentNode}return!1},z=
function(){var b,c,j,k,f=a("#"+a(this).data("datepickerId"));if(!f.is(":visible")){var d=f.get(0);g(d);var l=f.data("datepicker");l.onBeforeShow.apply(this,[f.get(0)]);var h=a(this).offset();k="CSS1Compat"==document.compatMode;b=window.pageXOffset||(k?document.documentElement.scrollLeft:document.body.scrollLeft);c=window.pageYOffset||(k?document.documentElement.scrollTop:document.body.scrollTop);j=window.innerWidth||(k?document.documentElement.clientWidth:document.body.clientWidth);k=window.innerHeight||
(k?document.documentElement.clientHeight:document.body.clientHeight);var n=h.top,m=h.left;a.curCSS(d,"display");f.css({visibility:"hidden",display:"block"});v(d);switch(l.position){case "top":n-=d.offsetHeight;break;case "left":m-=d.offsetWidth;break;case "right":m+=this.offsetWidth;break;case "bottom":n+=this.offsetHeight}n+d.offsetHeight>c+k&&(n=h.top-d.offsetHeight);n<c&&(n=h.top+this.offsetHeight+d.offsetHeight);m+d.offsetWidth>b+j&&(m=h.left-d.offsetWidth);m<b&&(m=h.left+this.offsetWidth);f.css({visibility:"visible",
display:"block",top:n+"px",left:m+"px"});!1!=l.onShow.apply(this,[f.get(0)])&&f.show();a(document).bind("mousedown",{cal:f,trigger:this},y)}return!1},y=function(b){b.target!=b.data.trigger&&!A(b.data.cal.get(0),b.target,b.data.cal.get(0))&&(!1!=b.data.cal.data("datepicker").onHide.apply(this,[b.data.cal.get(0)])&&b.data.cal.hide(),a(document).unbind("mousedown",y))};a.fn.extend({DatePicker:function(e){e=a.extend({},m,e||{});var c=e.locale;Date.prototype.tempDate||(Date.prototype.tempDate=null,Date.prototype.months=
c.months,Date.prototype.monthsShort=c.monthsShort,Date.prototype.days=c.days,Date.prototype.daysShort=c.daysShort,Date.prototype.getMonthName=function(a){return this[a?"months":"monthsShort"][this.getMonth()]},Date.prototype.getDayName=function(a){return this[a?"days":"daysShort"][this.getDay()]},Date.prototype.addDays=function(a){this.setDate(this.getDate()+a);this.tempDate=this.getDate()},Date.prototype.addMonths=function(a){null==this.tempDate&&(this.tempDate=this.getDate());this.setDate(1);this.setMonth(this.getMonth()+
a);this.setDate(Math.min(this.tempDate,this.getMaxDays()))},Date.prototype.addYears=function(a){null==this.tempDate&&(this.tempDate=this.getDate());this.setDate(1);this.setFullYear(this.getFullYear()+a);this.setDate(Math.min(this.tempDate,this.getMaxDays()))},Date.prototype.getMaxDays=function(){var a=new Date(Date.parse(this)),b=28,e;e=a.getMonth();for(b=28;a.getMonth()==e;)b++,a.setDate(b);return b-1},Date.prototype.getFirstDay=function(){var a=new Date(Date.parse(this));a.setDate(1);return a.getDay()},
Date.prototype.getWeekNumber=function(){var a=new Date(this);a.setDate(a.getDate()-(a.getDay()+6)%7+3);var b=a.valueOf();a.setMonth(0);a.setDate(4);return Math.round((b-a.valueOf())/6048E5)+1},Date.prototype.getDayOfYear=function(){var a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0),b=new Date(this.getFullYear(),0,0,0,0,0);return Math.floor(36E5*((a-b)/24))});e.calendars=Math.max(1,parseInt(e.calendars,10)||1);e.mode=/single|multiple|range/.test(e.mode)?e.mode:"single";return this.each(function(){if(!a(this).data("datepicker")){e.el=
this;e.date.constructor==String&&(e.date=l(e.date,e.format),e.date.setHours(0,0,0,0));if("single"!=e.mode)if(e.date.constructor!=Array)e.date=[e.date.valueOf()],"range"==e.mode&&e.date.push((new Date(e.date[0])).setHours(23,59,59,0).valueOf());else{for(var c=0;c<e.date.length;c++)e.date[c]=l(e.date[c],e.format).setHours(0,0,0,0).valueOf();"range"==e.mode&&(e.date[1]=(new Date(e.date[1])).setHours(23,59,59,0).valueOf())}else e.date=e.date.valueOf();e.current=e.current?l(e.current,e.format):new Date;
e.current.setDate(1);e.current.setHours(0,0,0,0);var c="datepicker_"+parseInt(1E3*Math.random()),f;e.id=c;a(this).data("datepickerId",e.id);var h=a('<div class="datepicker"><div class="datepickerBorderT" /><div class="datepickerBorderB" /><div class="datepickerBorderL" /><div class="datepickerBorderR" /><div class="datepickerBorderTL" /><div class="datepickerBorderTR" /><div class="datepickerBorderBL" /><div class="datepickerBorderBR" /><div class="datepickerContainer"><table cellspacing="0" cellpadding="0" ><tbody><tr></tr></tbody></table></div></div>').attr("id",
c).bind("click",q).data("datepicker",e);e.className&&h.addClass(e.className);for(var m="",c=0;c<e.calendars;c++)f=e.starts,0<c&&(m+='<td class="datepickerSpace"><div></div></td>'),m+=tmpl(b.join(""),{week:e.locale.weekMin,prev:e.prev,next:e.next,day1:e.locale.daysMin[f++%7],day2:e.locale.daysMin[f++%7],day3:e.locale.daysMin[f++%7],day4:e.locale.daysMin[f++%7],day5:e.locale.daysMin[f++%7],day6:e.locale.daysMin[f++%7],day7:e.locale.daysMin[f++%7]});h.find("tr:first").append(m).find("table").addClass(d[e.view]);
g(h.get(0));e.flat?(h.appendTo(this).show().css("position","relative"),v(h.get(0))):(h.appendTo(document.body),a(this).bind(e.eventName,z))}})},DatePickerHide:function(){return this.each(function(){a(this).data("datepickerId")&&a("#"+a(this).data("datepickerId")).hide()})},DatePickerShow:function(){return this.each(function(){a(this).data("datepickerId")&&z.apply(this)})},DatePickerSetDate:function(b,c){return this.each(function(){if(a(this).data("datepickerId")){var f=a("#"+a(this).data("datepickerId")),
d=f.data("datepicker");d.date=b;d.date.constructor==String&&(d.date=l(d.date,d.format),d.date.setHours(0,0,0,0));if("single"!=d.mode)if(d.date.constructor!=Array)d.date=[d.date.valueOf()],"range"==d.mode&&d.date.push((new Date(d.date[0])).setHours(23,59,59,0).valueOf());else{for(var h=0;h<d.date.length;h++)d.date[h]=l(d.date[h],d.format).setHours(0,0,0,0).valueOf();"range"==d.mode&&(d.date[1]=(new Date(d.date[1])).setHours(23,59,59,0).valueOf())}else d.date=d.date.valueOf();c&&(d.current=new Date("single"!=
d.mode?d.date[0]:d.date));g(f.get(0))}})},DatePickerGetDate:function(b){if(0<this.size())return w(a("#"+a(this).data("datepickerId")).data("datepicker"))[b?0:1]},DatePickerClear:function(){return this.each(function(){if(a(this).data("datepickerId")){var b=a("#"+a(this).data("datepickerId")),c=b.data("datepicker");"single"!=c.mode&&(c.date=[],g(b.get(0)))}})},DatePickerLayout:function(){return this.each(function(){if(a(this).data("datepickerId")){var b=a("#"+a(this).data("datepickerId"));b.data("datepicker").flat&&
v(b.get(0))}})}})})(jQuery);(function(){var a={};this.tmpl=function b(f,c){var m=!/\W/.test(f)?a[f]=a[f]||b(document.getElementById(f).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+f.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return c?m(c):m}})();
(function(a){var d={init:[]},b=window.EYE={init:function(){a.each(d.init,function(a,b){b.call()})},extend:function(a){for(var b in a)void 0!=a[b]&&(this[b]=a[b])},register:function(a,b){d[b]||(d[b]=[]);d[b].push(a)}};a(b.init)})(jQuery);
(function(a){var d=function(){var b=a("ul.navigationTabs a").removeClass("active").index(this);a(this).addClass("active");a("div.tab").hide().eq(b).show()};EYE.register(function(){var b=window.location.hash.replace("#",""),b=a("ul.navigationTabs a").bind("click",d).filter("a[rel="+b+"]");0==b.size()&&(b=a("ul.navigationTabs a:first"));d.apply(b.get(0));a("#date").DatePicker({flat:!0,date:"2008-07-31",current:"2008-07-31",calendars:1,starts:1,view:"years"});var f=new Date;f.addDays(-10);var c=new Date;
c.addDays(-5);c.setHours(0,0,0,0);a("#date2").DatePicker({flat:!0,date:["2008-07-31","2008-07-28"],current:"2008-07-31",format:"Y-m-d",calendars:1,mode:"multiple",onRender:function(a){return{disabled:a.valueOf()<f.valueOf(),className:a.valueOf()==c.valueOf()?"datepickerSpecial":!1}},onChange:function(){},starts:0});a("#clearSelection").bind("click",function(){a("#date3").DatePickerClear();return!1});a("#date3").DatePicker({flat:!0,date:["2009-12-28","2010-01-23"],current:"2010-01-01",calendars:3,
mode:"range",starts:1});a(".inputDate").DatePicker({format:"m/d/Y",date:a("#inputDate").val(),current:a("#inputDate").val(),starts:1,position:"right",onBeforeShow:function(){a("#inputDate").DatePickerSetDate(a("#inputDate").val(),!0)},onChange:function(b){a("#inputDate").val(b);a("#closeOnSelect input").attr("checked")&&a("#inputDate").DatePickerHide()}});b=new Date;b.addDays(-4);var m=new Date;a("#widgetCalendar").DatePicker({flat:!0,format:"d B, Y",date:[new Date(b),new Date(m)],calendars:3,mode:"range",
starts:1,onChange:function(b){a("#widgetField span").get(0).innerHTML=b.join(" &divide; ")}});var g=!1;a("#widgetField>a").bind("click",function(){a("#widgetCalendar").stop().animate({height:g?0:a("#widgetCalendar div.datepicker").get(0).offsetHeight},500);g=!g;return!1});a("#widgetCalendar div.datepicker").css("position","absolute")},"init")})(jQuery);
var selectDate=function(){var a=$("#calendar").DatePickerGetDate("formatted"),a=(new String(a)).split(",");a[0]!=a[1]&&(window.location=baseLocation+"date-filter/?startDate="+a[0]+"&endDate="+a[1],$("#byDateDropdown .expandingTitle").html("Loading..."))};0<$("#calendar").length&&$("#calendar").DatePicker({flat:!0,date:["YYYY-MM-DD","YYYY-MM-DD"],calendars:1,mode:"range",starts:7,onChange:selectDate});
