(function(global,$){var widthAtivo=28;var widthInativo=2;var opaco={opacity:1};var semiOpaco={opacity:0.8};var invisivel={opacity:0};var ativo={width:widthAtivo};var inativo={width:widthInativo};var ativoOpaco={width:widthAtivo,opacity:1};var ativoTranslucido={width:widthAtivo,opacity:0.5};var inativoOpaco={width:widthInativo,opacity:1};$.widget('glb.carrossel',{options:{identificador:'libbycarrossel',duracaoAnimacao:200,intervalo:6000,indiceInicial:0,zIndex:99},_create:function(){this.timer=null;this.indice=this.options.indiceInicial;this.passos=this.element.find('div.glb-carrossel-passo');this.numeroDePassos=this.passos.length;this.navegacao=this.element.find('div.glb-carrossel-navegacao');this.tituloFundo=this.element.find('span.glb-carrossel-titulo-fundo');this.itensNavegacaoLi=this.navegacao.find('li');this.itensNavegacao=this.navegacao.find('a');this.itensNavegacaoBg=this.itensNavegacao.filter('.glb-carrossel-navegacao-item-bg');this.itensNavegacaoBgAtivo=this.itensNavegacao.filter('.glb-carrossel-navegacao-item-bg-ativo');this.thumbs=this.element.find('div.glb-carrossel-thumb');this.primeiraAnimacao=true;this._ativar();this.iniciarCiclo();this._adicionarEventosNavegacao();this._adicionarEventosHover();this._setarAltura();},_setarAltura:function(){if(this.element.hasClass('glb-carrossel-passos-compacto')){return;}
var alturas=this.passos.map(function(){return $(this).height();}).get();var maiorAltura=Math.max.apply(Math.max,alturas);this.element.height(maiorAltura);},iniciarCiclo:function(){if(this.timer){return;}
this.timer=setInterval($.proxy(this.incrementaPasso,this),this.options.intervalo);},cancelarCiclo:function(){clearInterval(this.timer);this.timer=null;},_ativar:function(){var primeiroBgAtivo=this.itensNavegacaoBgAtivo.first();primeiroBgAtivo.css('width',primeiroBgAtivo.css('width'));this.itensNavegacaoLi.first().removeClass('glb-carrossel-navegacao-item-ativo');},_adicionarEventosNavegacao:function(){var self=this;this.itensNavegacaoLi.each(function(i,el){var item=$(this);var bgAtivo=self.itensNavegacaoBgAtivo;var thumbs=self.thumbs;var duracaoAnimacao=self.options.duracaoAnimacao;self._bind(item,'mouseenter',function(){bgAtivo.eq(self.indice).stop().animate(ativoTranslucido);bgAtivo.eq(i).stop().animate(ativoOpaco,{duration:duracaoAnimacao});thumbs.eq(i).show().stop().animate(opaco);});self._bind(item,'mouseleave',function(){bgAtivo.eq(self.indice).stop().animate(ativoOpaco);bgAtivo.eq(i).not(bgAtivo.eq(self.indice)).stop().animate(inativo,{duration:duracaoAnimacao});thumbs.eq(i).stop().animate(invisivel,{complete:function(){$(this).hide();}});});self._bind(item,'click',function(){self.primeiraAnimacao=false;if(self.indice==i){return;}
self.trocaPasso(self.indice,i);});});this._bind(this.itensNavegacao,'click',function(e){e.preventDefault();});},_adicionarEventosHover:function(){var self=this;this._bind(this.element,'mouseenter',function(){self.cancelarCiclo();self.exibeNavegacao();self.destacarTitulo();});this._bind(this.element,'mouseleave',function(){self.iniciarCiclo();self.escondeNavegacao();self.normalizarTitulo();});},incrementaPasso:function(){var indiceAnterior=this.indice;this.indice=(this.indice+1)%this.numeroDePassos;this.trocaPasso(indiceAnterior,this.indice);this.itensNavegacaoBg.eq(indiceAnterior).css(inativo);},trocaPasso:function(indiceAnterior,indiceAtual){this.indice=indiceAtual;this.animacao(indiceAnterior,indiceAtual);},animacao:function(indiceAnterior,indiceAtual){var self=this;var passoAnterior=this.passos.eq(indiceAnterior);var passoAtual=this.passos.eq(indiceAtual);var navegacaoAnterior=this.itensNavegacaoBgAtivo.eq(indiceAnterior);var navegacaoAtual=this.itensNavegacaoBgAtivo.eq(indiceAtual);if(this.primeiraAnimacao){this.itensNavegacao.not(navegacaoAnterior).stop().animate(inativo,{duration:this.options.duracaoAnimacao});this.primeiraAnimacao=false;}
var onNavegacao=function(){self.passos.css('z-index',self.options.zIndex-1);passoAnterior.css('z-index',self.options.zIndex+1);passoAtual.css('z-index',self.options.zIndex).css('opacity','').show();navegacaoAtual.stop().animate(ativo,{duration:self.options.duracaoAnimacao});passoAnterior.stop().animate(invisivel,{duration:self.options.duracaoAnimacao,complete:function(){$(this).hide();}});};navegacaoAnterior.animate(inativoOpaco,{complete:onNavegacao,duration:this.options.duracaoAnimacao});},exibeNavegacao:function(){this.itensNavegacaoBg.stop().animate(ativo,{duration:this.options.duracaoAnimacao});},escondeNavegacao:function(){this.itensNavegacaoBgAtivo.eq(this.indice).stop().animate(ativoOpaco,{duration:this.options.duracaoAnimacao});this.itensNavegacaoBg.not(this.itensNavegacaoBg.eq(this.indice)).stop().animate(inativo,{duration:this.options.duracaoAnimacao});},destacarTitulo:function(){this.tituloFundo.stop().animate(opaco);},normalizarTitulo:function(){this.tituloFundo.stop().animate(semiOpaco);},_bind:function(el,event,fn){el.bind(event+'.'+this.options.identificador,fn);}});$('#glb_carrossel').carrossel();})(this,jQuery);(function($){$.widget('libby.agrupadorDestaqueVideo',{options:{animationTime:600,interval:6000,overlayTime:100},_create:function(){this._bindEvents();this._createAnimationFunc();this._reorderItems();this.start();},_bindEvents:function(){var self=this;this.element.hover(function(){self.stop();},function(){self.start();});},_scrollList:function(ulElement,startStyle,endStyle){var first=ulElement.find('li').first(),height=first.outerHeight();first.animate($.extend({marginTop:-height},startStyle||{}),{duration:this.options.animationTime,easing:'swing',complete:function(){first.detach();ulElement.append(first);first.css($.extend({marginTop:0},endStyle||{}));}});},_createAnimationFunc:function(){var self=this,element=this.element,highlightListUl=element.find('.highlight-list ul'),imageListContainerUl=element.find('.image-list-container ul'),imageContainer=element.find('.image-container'),images=imageContainer.find('ul li'),outerLink=$('a.border-highlight');this.currentImageIdx=0;this.animationFunc=function(finishCallBack){var startStyle,endStyle;if($.support.opacity){startStyle={opacity:0};endStyle={opacity:1};}
self._scrollList(highlightListUl,startStyle,endStyle);self._scrollList(imageListContainerUl);var nextImgIdx=(self.currentImageIdx+1)%images.length;var first=images.eq(self.currentImageIdx);var second=images.eq(nextImgIdx);var height=first.height();self.currentImageIdx=nextImgIdx;first.css({zIndex:1});second.css({top:height,zIndex:2});outerLink.attr('href',second.find('a').attr('href'));imageContainer.removeClass(function(idx,classes){var m=classes.match(/(glb-hl.*?)( |$)/);return m?m[1]:"";});imageContainer.addClass(second.attr('class'));first.delay(self.options.overlayTime).animate({top:-height},self.options.animationTime,'swing');second.animate({top:0},self.options.animationTime,'swing',function(){first.stop(true,true);if(finishCallBack instanceof Function){finishCallBack();}});};},_reorderItems:function(){var imageThumbnails=this.element.find('.image-list-container li');imageThumbnails.first().parent().append(imageThumbnails.first().detach());},roll:function(){if(this.rolling){return;}
var self=this;this.rolling=true;this.animationFunc(function(){self.rolling=false;});},start:function(){if(this.timer){return;}
var self=this;this.timer=setInterval(function(){self.roll();},this.options.interval);},stop:function(forever){clearInterval(this.timer);this.timer=null;if(forever){this.element.unbind('mouseenter').unbind('mouseleave');}},reset:function(){var highlights=this.element.find('.highlight-list li');var imageThumbnails=this.element.find('.image-list-container li');var images=this.element.find('.image-container li');images.first().css({top:0,zIndex:1});images.each(function(i){if(i>0){$(this).css({zIndex:0});}});for(var i=0;i<(highlights.length-this.currentImageIdx);++i){var highlight=highlights.eq(i),imageThumb=imageThumbnails.eq(i);highlight.parent().append(highlight.detach());imageThumb.parent().append(imageThumb.detach());}
this.currentImageIdx=0;},destroy:function(){this.stop(true);this.reset();$.libby.widgetBase.prototype.destroy.apply(this,arguments);}});}(jQuery));(function($){$('div.libby-agrupador-destaque-video').agrupadorDestaqueVideo();})(jQuery);$.widget('glb.topglobocom',{options:{buscaUrl:'/tagcloud/globo-tagCloud.txt'},_create:function(){this.seta=this.element.find('.navegador');this.setaTop=this.seta.position().top;this.tabContents=this.element.find('div.tab-content');this.itensList=this.element.find('.itens');this.links=this.itensList.find('a');this.lis=this.itensList.find('li');this.currentIndex=0;this.hasSearchedBefore=false;this._attachEvents();},_attachEvents:function(){var self=this;this.links.each(function(i,link){$(link).click(function(e){if(self.currentIndex==i){return false;}
if(i==1){self.getSearchTermsAndPopulateTagCloud();}
var newContent=self.tabContents.eq(i);var oldContent=self.tabContents.eq(self.currentIndex);var others=self.tabContents.not(newContent);self.currentIndex=i;self.tabContents.css('z-index',1);oldContent.css('z-index',3);newContent.stop().css({'z-index':2,'opacity':''}).show();var newLi=self.lis.eq(i);var newTop=newLi.position().top;self.seta.stop().animate({top:newTop+self.setaTop},{duration:300,easing:"swing"});oldContent.stop().animate({opacity:0},{duration:300,complete:function(){oldContent.hide();}});self.getAnalytics($(this));return false;});});},sortByProperty:function(obj,property,desc){obj.sort(function(obj1,obj2){var offset=1;if(desc){offset=-1;}
return obj1[property]<obj2[property]?-1*offset:(obj1[property]>obj2[property]?1*offset:0);});},getSearchTermsAndPopulateTagCloud:function(){var self=this;if(self.hasSearchedBefore){return;}
var distribution={maior:3,grande:5,medio:10,pequeno:11};var numberOfItems=distribution.maior+
distribution.grande+
distribution.medio+
distribution.pequeno;var getClassFor=function(item){for(var key in distribution){if(distribution[key]){distribution[key]--;return key;}}};var searchUrlFor=function(term){return"http://busca.globo.com/Busca/?query="+term;};var populateTagCloud=function(data){self.sortByProperty(data,'frequency',true);var items=data.slice(0,numberOfItems);$.each(items,function(){this.category=getClassFor(this);});self.sortByProperty(items,"term");var tagCloud=self.tabContents.eq(1).find('.tag-cloud');var busca=self.tabContents.eq(1).find('.busca');var tagCouldUl=$('<ul/>');tagCloud.empty();$.each(items,function(){var item=this;var li=$('<li><a title="Busca por '+item.term+'" href="'+searchUrlFor(item.term)+'&annotationClass=no" rel="tag">'+item.term+'</a></li>');li.addClass(item.category);tagCouldUl.append(li);});tagCloud.append(tagCouldUl).show();busca.show();};$.getJSON(self.options.buscaUrl,function(data){self.hasSearchedBefore=true;populateTagCloud(data);});},getAnalytics:function(link){if(libby.analytics.links.generateAnalytics){var url=link.attr("href");var value;if(url.indexOf("mais-vistas")!==-1){value="R";}else if(url.indexOf("mais-buscadas")!==-1){value="X";}else if(url.indexOf("mais-sociais")!==-1){value="Q";}
libby.analytics.links.generateAnalytics(link,value);}}});$('#topglobocom').topglobocom();$.widget('glb.boxVideo',{options:{banda:'I',autoStart:true},_create:function(options){var self=this;this.link=this.element.find('a');this.arrow=this.link.find('span.arrow');this.arrowOpacity=this.arrow.css('opacity');this.setDefaultOptions();this.link.bind('click',function(e){e.preventDefault();self.clickEvent();});if($.support.opacity){this.link.hover($.proxy(this.enterEvent,this),$.proxy(this.leaveEvent,this));}},setDefaultOptions:function(){var videoUrl=this.link.attr('href');this._setOption('midiaId',this.extractMidiaIdFromVideoUrl(videoUrl));this._setOption('sitePage',this.link.attr('rel'));if(!this.options.hostNovoPlayer){delete this.options.hostNovoPlayer;}
if(!this.options.environment){delete this.options.environment;}},enterEvent:function(e){this.arrow.stop().animate({opacity:1},300);},leaveEvent:function(e){this.arrow.stop().animate({opacity:this.arrowOpacity},300);},clickEvent:function(){var preventRefresh=window.preventRefresh;if(preventRefresh&&preventRefresh.prevent){preventRefresh.prevent();}
var oldOnPlay=this.options.onPlay;this.options.onPlay=function(object){document.isPlaying=true;if(oldOnPlay){oldOnPlay.apply(this,arguments);}};var oldOnTermino=this.options.onTerminoDoVideo;this.options.onTerminoDoVideo=function(object){document.isPlaying=false;if(oldOnTermino){oldOnTermino.apply(this,arguments);}};var videoUrl=this.link.attr("href");var videoId=this.extractMidiaIdFromVideoUrl(videoUrl);var sitePage=this.link.attr("rel");this.link.hide();var self=this;$.glb.boxVideo.globalMethods={};$.glb.boxVideo.globalMethods['video'+videoId]=function(){self.options.onTerminoDoVideo();};this.element.find(".video-flash").player({videosIDs:videoId,sitePage:sitePage,autoPlay:true,width:288,height:216,complete:"$.glb.boxVideo.globalMethods.video"+videoId});},extractMidiaIdFromVideoUrl:function(videoUrl){if(!videoUrl){return null;}
var m=videoUrl.match(/[A-Z]{3}(\d+)-/);if(!m){m=videoUrl.match(/\/(\d{6,})(\/|$)/);}
if(!m){m=videoUrl.match(/[^\d](\d{6,})[^\d]/);}
return m?m[1]:'';}});$.widget('glb.boxVideoTriplo',{options:{sitePage:null},lastHover:null,lastOut:null,_create:function(){var elem=this.element.find(".lst-nav a");elem.attr("title","");elem.find("img").attr("alt","");this.thumbHover();this.thumbClick();},animation:function(elem){var pattern=/[0-9]$/,boxChamada=this.element.find(".container-video ul"),posActive=(parseInt(this.element.find(".lst-nav li.on").attr("id").match(pattern),10)),posCurrent=(parseInt(elem.attr("id").match(pattern)[0],10)),elemActive=boxChamada.find("#box-video-"+posActive),target=boxChamada.find("#box-video-"+posCurrent),from=this.lastHover,out=!elem.hasClass("mouseOn");if(!from){from=elemActive;}
if(this.lastOut){this.lastOut.stop(true,true);from.css({zIndex:3,opacity:1});}
if(out){target=elemActive;}
target.css({zIndex:2,opacity:1});if(from.attr("id")!=target.attr("id")){from.animate({opacity:0,easing:"easeOutBounce"},{duration:300,queue:false,complete:function(){from.css({zIndex:1});target.css({zIndex:3,opacity:1});}});}
this.lastHover=target;this.lastOut=from;},thumbHover:function(){var self=this,elem,timeOut;this.element.find(".lst-nav li").hover(function(){elem=$(this);if(!elem.hasClass("on")){clearTimeout(timeOut);elem.addClass("mouseOn");timeOut=setTimeout(function(){self.animation(elem);},200);}},function(){elem=$(this);if(!elem.hasClass("on")){clearTimeout(timeOut);self.element.find(".lst-nav li").removeClass("mouseOn");timeOut=setTimeout(function(){self.animation(elem);},200);}});},thumbClick:function(){var self=this,elemVideo;this.element.find(".lst-nav li").click(function(e){var elem=$(this);if(!elem.hasClass("on")){var preventRefresh=window.preventRefresh;if(preventRefresh&&preventRefresh.prevent){preventRefresh.prevent();}
var elemId=parseInt(elem.attr("id").match(/[0-9]$/),10),boxVideo=self.element.find("#box-video-"+elemId),videoId=self.extractMidiaIdFromVideoUrl(elem.find("a").attr("href")),elemActive=self.element.find(".lst-nav li.on"),sitePage=elem.find("a").attr("rel"),lstVideos=self.element.find(".container-video li");self.element.find("#box-video-1 .play").remove();elemActive.removeClass("on assistindo");elem.addClass("on assistindo");lstVideos.removeAttr("style").removeClass("on");boxVideo.addClass("on");if(elemVideo){elemVideo.html("");}
elemVideo=self.element.find("#box-video-"+elemId+" .player-video").player({videosIDs:videoId,sitePage:sitePage,autoPlay:true,width:288,height:216,complete:"$.glb.boxVideoTriplo.prototype.videoComplete",onPlay:"$.glb.boxVideoTriplo.prototype.videoPlay"});}
e.preventDefault();});this.element.find(".video a").click(function(e){var preventRefresh=window.preventRefresh;if(preventRefresh&&preventRefresh.prevent){preventRefresh.prevent();}
var elem=$(this),pattern=/[0-9]$/,elemId=parseInt(pattern.exec(elem.parents("li").attr("id")),10),sitePage=elem.attr("rel"),videoId=self.extractMidiaIdFromVideoUrl(elem.attr("href"));if(elemVideo){elemVideo.html("");}
self.element.find("#thumb-video-"+elemId).addClass("assistindo");elemVideo=elem.parent().find(".player-video").player({videosIDs:videoId,sitePage:sitePage,autoPlay:true,width:288,height:216,complete:"$.glb.boxVideoTriplo.prototype.videoComplete",onPlay:"$.glb.boxVideoTriplo.prototype.videoPlay"});e.preventDefault();});},videoComplete:function(){var preventRefresh=window.preventRefresh;if(preventRefresh&&preventRefresh.allow){preventRefresh.allow();}
$(".widget-video-triplo .lst-nav").find(".assistindo").removeClass("assistindo");},videoPlay:function(){$(".widget-video-triplo .lst-nav").find(".on").addClass("assistindo");},extractMidiaIdFromVideoUrl:function(videoUrl){if(!videoUrl){return null;}
var m=videoUrl.match(/[A-Z]{3}(\d+)-/);if(!m){m=videoUrl.match(/\/(\d{6,})(\/|$)/);}
if(!m){m=videoUrl.match(/[^\d](\d{6,})[^\d]/);}
return parseInt(m?m[1]:null,10);}});$(".widget-video-triplo").boxVideoTriplo();$.widget('glb.topglobocom2',{options:{buscaUrl:'/tagcloud/globo-tagCloud.txt'},_create:function(){this.tabContents=this.element.find('div.tab-content');this.itensList=this.element.find('.itens');this.links=this.itensList.find('a');this.lis=this.itensList.find('li');this.currentIndex=0;this.hasSearchedBefore=false;this._attachEvents();},_attachEvents:function(){var self=this;this.links.each(function(i,link){$(link).click(function(){if(self.currentIndex==i){return false;}
if(i==1){self.getSearchTermsAndPopulateTagCloud();}
var newContent=self.tabContents.eq(i);var oldContent=self.tabContents.eq(self.currentIndex);var others=self.tabContents.not(newContent);self.currentIndex=i;self.tabContents.css('z-index',1);oldContent.css('z-index',3);newContent.stop().css({'z-index':2,'opacity':''}).show();var newLi=self.lis.eq(i);self.lis.removeClass('selected');newLi.addClass('selected');oldContent.stop().animate({opacity:0},{duration:300,complete:function(){oldContent.hide();}});self.getAnalytics($(this));return false;});});},sortByProperty:function(obj,property,desc){obj.sort(function(obj1,obj2){var offset=(desc)?-1:1;return obj1[property]<obj2[property]?-1*offset:(obj1[property]>obj2[property]?1*offset:0);});},getSearchTermsAndPopulateTagCloud:function(){var self=this;if(self.hasSearchedBefore){return;}
var distribution={maior:4,grande:8,medio:14,pequeno:14};var numberOfItems=distribution.maior+
distribution.grande+
distribution.medio+
distribution.pequeno;var getClassFor=function(item){for(var key in distribution){if(distribution[key]){distribution[key]--;return key;}}};var searchUrlFor=function(term){return"http://busca.globo.com/Busca/?query="+term;};var populateTagCloud=function(data){self.sortByProperty(data,'frequency',true);var items=data.slice(0,numberOfItems);$.each(items,function(){this.category=getClassFor(this);});self.sortByProperty(items,"term");var tagCloud=self.tabContents.eq(1).find('.tag-cloud');var busca=self.tabContents.eq(1).find('.busca');var tagCouldUl=$('<ul/>');tagCloud.empty();$.each(items,function(){var item=this;var li=$('<li><a title="Busca por '+item.term+'" href="'+searchUrlFor(item.term)+'&annotationClass=no" rel="tag">'+item.term+'</a></li>');li.addClass(item.category);tagCouldUl.append(li);});tagCloud.append(tagCouldUl).show();busca.show();};$.getJSON(self.options.buscaUrl,function(data){self.hasSearchedBefore=true;populateTagCloud(data);});},getAnalytics:function(link){if(libby.analytics.links.generateAnalytics){var url=link.attr("href");var value;if(url.indexOf("mais-vistas")!==-1){value="R";}else if(url.indexOf("mais-buscadas")!==-1){value="X";}else if(url.indexOf("mais-sociais")!==-1){value="Q";}
libby.analytics.links.generateAnalytics(link,value);}}});$('#topglobocom2').topglobocom2();(function($){var mostSeen=$('#mais-vistas');var chamada=mostSeen.find('.borda').first();var chamadaHeight=chamada.height();var isCorrectHeight=function(el){return el.innerHeight()<=chamadaHeight;};mostSeen.find('a').each(function(i,el){var newSz;el=$(el);while(!isCorrectHeight(el)){newSz=parseFloat(el.css('font-size'))-1;if(newSz<7){break;}
el.css('font-size',newSz+'px');}});})(jQuery);$.widget('libby.boxPrevisaoTempo',$.libby.widgetBase,{options:{weatherUrl:'http://g1.globo.com/previsao-do-tempo/',weatherApiUrl:'http://api.g1.globo.com/tempo/cidade-resumida/',trimCityNameAtIndex:22,defaultGeolocation:{country:{code:'BR'},city:{code:'sao-paulo',name:'São Paulo'},state:{code:'SP',name:'São Paulo'}}},_create:function(){this._super('_create');globoapi.geo.onSuccess($.proxy(this._withGeolocation,this));globoapi.geo.onNotFound($.proxy(this._onGeolocationNotFound,this));},_withGeolocation:function(geolocation){var cookieVal=libby.cookie.read('libby_boxPrevisaoTempo');if(cookieVal){var city=JSON.parse(cookieVal);this.geolocation=city;}else{if(geolocation.city.code==null){this._onGeolocationNotFound();return;}
var majorLocation=(geolocation.country.code.toLowerCase()=='br')?geolocation.state.code:geolocation.country.ptSlug;geolocation.slug=this._createSlug(majorLocation,geolocation.city.code);this.geolocation=geolocation;}
this._callWeatherApi(this.geolocation.slug,this._withWeather);},_onGeolocationNotFound:function(){this._withGeolocation(this.options.defaultGeolocation);},_callWeatherApi:function(slug,callback){var url=this._createUrl(this.options.weatherApiUrl,slug,'jsonp');$.ajax({url:url,dataType:'jsonp',cache:true,jsonpCallback:'g1_previsao_cidade',success:$.proxy(callback,this)});this._weatherNotFoundFallback();},_weatherNotFoundFallback:function(){if(!this.triedFallback&&!this.element.hasClass('loaded')){var self=this;setTimeout(function(){if(!self.element.hasClass('loaded')){self.triedFallback=true;self._onGeolocationNotFound();}},1200);}},_withWeather:function(data){this._render();this._createWidgets();this._bindEvents();this.update(data,true);},_createSlug:function(state,city){return state.toLowerCase().replace(/\s+/,'-')+'/'+city.toLowerCase().replace(/\s+/,'-');},_createUrl:function(domain,slug,type){return domain+slug+'.'+type;},_render:function(){this.element.addClass(this._classFor()).addClass('loaded');var tooltipClass=this._classFor('tooltip');var html=['<a class="link-complete-weather" href="#">','<span class="weather-icon"></span>','<span class="max-temperature"></span>','<span class="min-temperature"></span>','<span class="weather-location"></span>','</a>','<div class="',tooltipClass,'"></div>'];this.element.html(html.join(''));this.elements.linkCompleteWeather=this.element.find('.link-complete-weather');this.elements.maxTemperature=this.element.find('.max-temperature');this.elements.minTemperature=this.element.find('.min-temperature');this.elements.iconTemperature=this.element.find('.weather-icon');this.elements.weatherLocation=this.element.find('.weather-location');this.elements.tooltip=this.element.find('.'+tooltipClass);},_createWidgets:function(){this.element.boxPrevisaoTempoAnalytics({pubsub:this.element});this.elements.tooltip.boxPrevisaoTempoTooltip({pubsub:this.element,weatherUrl:this.options.weatherUrl});},_bindEvents:function(){this.element.bind('mouseenter',$.proxy(function(){this.elements.tooltip.boxPrevisaoTempoTooltip('activate');},this));this.element.bind('mouseleave',$.proxy(function(){this.elements.tooltip.boxPrevisaoTempoTooltip('deactivate');},this));this._bind('cityForecast',$.proxy(this._onForecast,this));this._bind('locationSelected',$.proxy(this._onLocationSelected,this));},_getButtonLabel:function(city,state){if(city.length>this.options.trimCityNameAtIndex){city=city.substring(0,this.options.trimCityNameAtIndex).replace(/\s+$/g,'')+'...';}
if(state.length==2){return city+', '+state;}
return city;},update:function(data,noCookie){if(!data)return;if(!noCookie){var sixMonths=6*30*24*60;libby.cookie.create('libby_boxPrevisaoTempo',JSON.stringify(this.geolocation),sixMonths);}
var weather=data.previsoes[0];this.elements.maxTemperature.html(weather.temperatura.maxima+'&deg;');this.elements.minTemperature.html(weather.temperatura.minima+'&deg;');this.elements.iconTemperature.attr('class','').attr('class','weather-icon weather-icon'+weather.icone);this.elements.weatherLocation.html(this._getButtonLabel(data.nome,data.prefixo));var url=this._createUrl(this.options.weatherUrl,this.geolocation.slug,'html');this._trigger('cityForecast',[this.geolocation,weather,url]);},_onForecast:function(ev,geolocation,weather,weatherDetailsUrl){this.elements.linkCompleteWeather.attr('href',weatherDetailsUrl);},_onLocationSelected:function(ev,geolocation){this.geolocation=geolocation;this._callWeatherApi(geolocation.slug,this.update);}});(function(global){$.widget('libby.boxPrevisaoTempoAnalytics',$.libby.widgetBase,{_create:function(){this._super('_create');this.actualLocation={};this._bindEvents();},_bindEvents:function(){this._bind('cityForecast',this._onCityForecast);this._bind('locationSelected',this._onLocationSelected);this._bind('changeCity',this._onChangeCity);},_onCityForecast:function(ev,geolocation){this.actualLocation=geolocation;},_onChangeCity:function(ev){global._gaq.push(['_trackEvent','Clima','Intencao de troca',this.actualLocation.state.code+'/'+this.actualLocation.city.name]);},_onLocationSelected:function(ev,geolocation){global._gaq.push(['_trackEvent','Clima','Troca finalizada',geolocation.state.code+'/'+geolocation.city.name]);}});})(window);(function($,global){var ESC_KEYCODE=27;$.widget('libby.boxPrevisaoTempoTooltip',$.libby.widgetBase,{options:{weatherUrl:'http://g1.globo.com/previsao-do-tempo/'},_create:function(){this._super('_create');this.isBlocked=false;this.hasOpacitySupport=$.support.opacity;this._render();this._bindEvents();this._createWidgets();},_render:function(){var detailClass=this._classFor("detail");var citySearchClass=this._classFor("citySearch");var html=['<div class="glb-submenu-n1">','<div class="glb-menu-seta-balao"></div>','<div class="glb-menu-canto-te"></div>','<div class="glb-menu-canto-td"></div>','<div class="glb-conteudo-subitens-bg clearfix">','<div class="glb-conteudo-subitens-bg2 clearfix">','<div class="glb-conteudo-subitens clearfix">','<div class="glb-submenu-n1-content">','<div class="',detailClass,'">','</div>','<div class="',citySearchClass,'">','</div>','</div>','</div>','</div>','</div>','<div class="glb-menu-canto-re"></div>','<div class="glb-menu-canto-rd"></div>','</div>'];this.element.html(html.join(''));this.elements.submenu=this.element.find('.glb-submenu-n1');this.elements.tooltipDetail=this.element.find('.'+detailClass);this.elements.tooltipCitySearch=this.element.find('.'+citySearchClass);},_createWidgets:function(){this.elements.tooltipDetail.boxPrevisaoTempoTooltipDetail({pubsub:this.options.pubsub,weatherUrl:this.options.weatherUrl});this.elements.tooltipCitySearch.boxPrevisaoTempoTooltipSearch({pubsub:this.options.pubsub});},_bindEvents:function(){this._bind("changeCity",$.proxy(this._onChangeCity,this));this._bind("locationSelected",$.proxy(this._onLocationSelected,this));this._bind("cancelCitySearch",$.proxy(this._onCancelCitySearch,this));$(document).bind('keydown',$.proxy(this._exitOnEsc,this)).bind('click',$.proxy(this._exitOnClickout,this));},_exitOnEsc:function(ev){if(ev.keyCode==ESC_KEYCODE&&this.isBlocked){this._onCancelCitySearch();}},_exitOnClickout:function(ev){if(this.isBlocked&&!$(ev.target).closest('.'+this.element.attr('class')).length){this._onCancelCitySearch();}},_onChangeCity:function(ev){this.elements.tooltipCitySearch.boxPrevisaoTempoTooltipSearch("activate");this.elements.tooltipDetail.boxPrevisaoTempoTooltipDetail("deactivate");this.isBlocked=true;},_onCancelCitySearch:function(ev){this.isBlocked=false;this.deactivate();},_onLocationSelected:function(ev){this._onCancelCitySearch();},_onComplete:function(visibility){return $.proxy(function(){this.elements.tooltipDetail.boxPrevisaoTempoTooltipDetail("activate");this.elements.tooltipCitySearch.boxPrevisaoTempoTooltipSearch("deactivate");this.elements.submenu.css("visibility",visibility);},this);},activate:function(){if(this.isBlocked)return;if(this.hasOpacitySupport){this.elements.submenu.stop(true).animate({opacity:1},{duration:200,queue:false});}
this._onComplete("visible")();},deactivate:function(){if(this.isBlocked)return;var onComplete=this._onComplete("hidden");if(this.hasOpacitySupport){this.elements.submenu.stop(true).animate({opacity:0},{duration:200,complete:onComplete,queue:false});}else{onComplete();}}});})(jQuery,this);$.widget('libby.boxPrevisaoTempoTooltipDetail',$.libby.widgetBase,{options:{weatherUrl:""},_create:function(){this._super('_create');this._render();this._bindEvents();},_render:function(){var html=['<span class="complete-weather-text"></span>','<a class="complete-weather-link" href="#">Veja a previsão completa ›</a>','<div class="tooltip-change-city">','<button class="btn-change-city" type="button">Trocar a cidade?</button>','</div>'];this.element.html(html.join(''));this.elements.changeCityButton=this.element.find('.btn-change-city');this.elements.completeWeatherLink=this.element.find('.complete-weather-link');this.elements.completeWeatherText=this.element.find('.complete-weather-text');},_bindEvents:function(){this.elements.changeCityButton.click($.proxy(this._changeCity,this));this._bind("cityForecast",$.proxy(this._onCityForecast,this));},_changeCity:function(){this._trigger("changeCity");},_onCityForecast:function(ev,geolocation,weather,completeWeatherUrl){this.elements.completeWeatherLink.attr('href',completeWeatherUrl);this.elements.completeWeatherText.text(weather.frase_completa);},activate:function(){this.element.show();this.element.parents('.glb-submenu-n1').css('width',this.element.outerWidth()+10);this.element.parents('.submenu-n1').css('width',this.element.outerWidth()+10);},deactivate:function(){this.element.hide();}});$.widget('libby.boxPrevisaoTempoTooltipSearch',$.libby.widgetBase,{_create:function(){this._super('_create');this._render();this._createWidgets();this._bindEvents();},_render:function(){var inputId=this._classFor("input-search");var html=['<input id="',inputId,'" value="" class="input-search" type="text" />','<div class="previsao-label">','<span>Cidade atual:</span>','<strong></strong>','</div>','<div class="search-suggestions libby-scrollbar"></div>','<button class="btn-close-tooltip" type="button">cancelar</button>'];this.element.html(html.join(''));this.elements.cancelButton=this.element.find('.btn-close-tooltip');this.elements.inputSearch=this.element.find('.input-search');this.elements.suggestions=this.element.find('.search-suggestions');this.elements.helpMessage=this.element.find('.previsao-label');this.elements.currentLocation=this.elements.helpMessage.find('strong');},_createWidgets:function(){var self=this;this.elements.inputSearch.boxPrevisaoTempoTooltipSearchInput();this.elements.inputSearch.autocomplete({minLength:3,autoFocus:true,appendTo:this.elements.suggestions,source:function(request,response){globoapi.citySearch.search(request.term,function(data,term){if(data==null||self.elements.inputSearch.val()!==term){data=[];}
response($.map(data,function(item){var cityCode=item.slug.split('/')[1];return{label:item.city+', '+item.state,value:item.city,city:{code:cityCode||item.city,name:item.city},state:{code:item.state},slug:item.slug};}));});}});},_bindEvents:function(){this.elements.cancelButton.click($.proxy(this._cancelSearch,this));this.elements.inputSearch.bind('autocompleteselect',$.proxy(this._locationSelected,this));this.elements.inputSearch.bind('autocompleteopen',$.proxy(this._autocompleteOpen,this));this.elements.inputSearch.bind('autocompleteclose',$.proxy(this._autocompleteClose,this));this.elements.inputSearch.bind('boxPrevisaoTempoTooltipSearchInputClear',$.proxy(this._clearInput,this));this._bind('cityForecast',$.proxy(this._onCityForecast,this));},_locationSelected:function(ev,option){this._trigger('locationSelected',option.item);},_onCityForecast:function(ev,item){var label=item.label||(item.city.name+', '+(item.state.code||item.contry.name));this.elements.currentLocation.html(label);},_clearInput:function(){this.elements.inputSearch.autocomplete('search','');this.elements.inputSearch.autocomplete('close');},_cancelSearch:function(){this._trigger('cancelCitySearch');},_autocompleteOpen:function(){this.elements.suggestions.show();this.elements.helpMessage.hide();},_autocompleteClose:function(){this.elements.suggestions.hide();this.elements.helpMessage.show();},activate:function(){this.element.show();this.element.parents('.glb-submenu-n1').css('width',this.element.outerWidth()+10);this.element.parents('.submenu-n1').css('width',this.element.outerWidth()+10);this.elements.inputSearch.boxPrevisaoTempoTooltipSearchInput('activate');},deactivate:function(){this.elements.inputSearch.boxPrevisaoTempoTooltipSearchInput('deactivate');this.element.hide();}});$.widget('libby.boxPrevisaoTempoTooltipSearchInput',$.libby.widgetBase,{_create:function(){this._super('_create');this._render();this._bindEvents();},_render:function(){var elementId=this.element.attr('id');this.elements.container=$('<div class="tooltip-search"></div>');this.elements.placeholder=$('<label for="'+elementId+'">Previsão do tempo para qual cidade?</label>');this.elements.clearButton=$('<button class="btn-clear-search" type="button">limpar busca</button>');this.element.replaceWith(this.elements.container);this.elements.container.append(this.element,this.elements.placeholder,this.elements.clearButton);},_bindEvents:function(){this._bind('keydown',$.proxy(this._delayedTogglePlaceholder,this));this._bind('focus',$.proxy(this._focusPlaceholder,this));this._bind('blur',$.proxy(this._blurPlaceholder,this));this.elements.clearButton.click($.proxy(this._clearInput,this));},_delayedTogglePlaceholder:function(){setTimeout($.proxy(this._togglePlaceholder,this),0);this.disablePlaceholder();},_togglePlaceholder:function(){if(this.element.val().length>0){this.elements.clearButton.removeClass('disabled');}else{this.elements.clearButton.addClass('disabled');}},_blurPlaceholder:function(){this.elements.placeholder.removeClass('soft');if(this.element.val().length==0){this.enablePlaceholder();}},_focusPlaceholder:function(){this.elements.placeholder.addClass('soft');},enablePlaceholder:function(){this.elements.placeholder.removeClass('disabled');},disablePlaceholder:function(){this.elements.placeholder.addClass('disabled');},_clearInput:function(){this._clearSearch();this._trigger('boxPrevisaoTempoTooltipSearchInputClear');},_clearSearch:function(){this.element.val('');this.element.focus();this._togglePlaceholder();},activate:function(){this._blurPlaceholder();this.element.focus();},deactivate:function(){this._clearInput();}});jQuery('#libby-box-previsao-tempo').boxPrevisaoTempo({weatherUrl:'http://g1.globo.com/previsao-do-tempo/',weatherApiUrl:'http://api.g1.globo.com/tempo/cidade-resumida/'});(function(global,$){var TAB_KEY=9;$.widget('home.servicosAutocomplete',$.libby.widgetBase,{options:{autocompleteOptions:{minLength:3,autoFocus:true},onClear:null},_create:function(){this._super('_create');this._render();this._bindEvents();this._toggleClearButton();this.createAutocomplete();},_render:function(){var html=['<span type="button" class="libby-servicos-autocomplete-clear-button"></span>','<div class="libby-servicos-autocomplete"></div>'];var elements=$(html.join(''));this.elements.autocompleteContainer=elements.filter('.libby-servicos-autocomplete');this.elements.clearButton=elements.filter('.libby-servicos-autocomplete-clear-button');this.element.after(elements);this.elements.container=this.element.parent();},_bindEvents:function(){this._bindClearButtonRelatedEvents();this._bindAutocompleteRelatedEvents();},_bindClearButtonRelatedEvents:function(){this.elements.clearButton.mousedown($.proxy(this._onMousedownClearButton,this));this._bind('keydown',this._delayedToggleClearButton);this._bind('focus',this._toggleClearButton);this._bind('blur',function(e){this._disable('clearButton');if(!this.element.data('autocomplete').menu.element.is(':visible')){this._disable('container');}});this._bindClearEvent();},_bindClearEvent:function(){if(this.options.onClear instanceof Function){this._bind('servicosAutocompleteClear',this.options.onClear);}},_setOption:function(key,value){$.libby.widgetBase.prototype._setOption.apply(this,arguments);if(key==='onClear'){this._bindClearEvent();}},_bindAutocompleteRelatedEvents:function(){this._bind('autocompletecreate',function(){this._disable('container');});this._bind('autocompletesearch',function(){this._enable('container');});this._bind('autocompleteclose',function(){this._disable('container');});},createAutocomplete:function(){this.element.autocomplete($.extend(true,{appendTo:this.elements.autocompleteContainer},this.options.autocompleteOptions));},_delayedToggleClearButton:function(e){if(e.keyCode!==TAB_KEY){setTimeout($.proxy(this._toggleClearButton,this),10);}},_toggleClearButton:function(){if(this.element.val().length>0){this._enable('clearButton');}else{this._disable('clearButton');}},_onMousedownClearButton:function(){this.element.val('').autocomplete('search','').autocomplete('close');this._disable('container');this._disable('clearButton');this._trigger('servicosAutocompleteClear');},_disable:function(element){this.elements[element].addClass('disabled');},_enable:function(element){this.elements[element].removeClass('disabled');}});}(this,jQuery));(function($){$.fn.placeholder=function(options){if($.placeholder.placeholderAvailable){return this;}
return this.each(function(){new $.placeholder(this,$.extend({},$.placeholder.options,options));});};$.placeholder=function(element,options){this.inputElement=$(element);this.placeholderTxt=this.inputElement.attr('placeholder');if(!this.placeholderTxt){return null;}
var previousElement=this.inputElement.data('placeholder');if(previousElement){previousElement.placeholderElement.text(this.placeholderTxt);return previousElement;}
this.inputElement.data('placeholder',this);this.options=options;this.placeholderElement=this._createPlaceholder();this._bindEvents();return this;};$.placeholder.options={color:'#999',leftPadding:12};$.placeholder.placeholderAvailable=('placeholder'in document.createElement('input'));$.placeholder.currentId=0;$.placeholder.prototype={remove:function(){this.inputElement.removeData('placeholder');if(this.placeholderElement){this.placeholderElement.remove();}},_shouldShow:function(){return this.inputElement.val()===''&&!this.inputElement.attr('defaultValue');},_bindEvents:function(){var self=this;this.inputElement.focus(function(){self.placeholderElement.hide();}).blur(function(){if(self._shouldShow()){self.placeholderElement.show();}});},_generateId:function(){return'ph_gen_id_'+$.placeholder.currentId++;},_createPlaceholder:function(){this.container=this.inputElement.offsetParent();var elementId=this.inputElement.attr('id');if(!elementId){elementId=this._generateId();this.inputElement.attr('id',elementId);}
var element=$('<label>').attr('for',elementId).css({color:this.options.color,position:'absolute',cursor:'text',zIndex:parseInt(this.inputElement.attr('zIndex')||0,5)+10}).addClass(this.inputElement.attr('class')).addClass('placeholder-polyfill').text(this.placeholderTxt);this.container.append(element);var inputH=this.inputElement.outerHeight();var myH=element.height();var pos=this.inputElement.offset();element.offset({left:pos.left+this.options.leftPadding,top:pos.top+(inputH/2)-(myH/2)});if(!this._shouldShow()){element.hide();}
return element;}};})(jQuery);(function($){$.widget("home.widgetServicos",$.libby.widgetBase,{_create:function(){this._super("_create");this.element.empty();var title=$('<h3>').addClass('title-widget-servicos').appendTo(this.element);var content=$('<div>').addClass('content-widget-servicos').appendTo(this.element);var bodyElements=this._fillBody();if($.isArray(bodyElements)){$.each(bodyElements,function(){content.append(this);});}else{content.append(bodyElements);}
var titleElements=this._fillTitle();if($.isArray(titleElements)){$.each(titleElements,function(){title.append(this);});}else{title.append(titleElements);}
if(window.PIE){this.element.find('.css3pie').each(function(){PIE.attach(this);});}
this.element.find("input[type='text']").placeholder();},_fillBody:function(){throw'$.home.widgetServicos._fillBody should be overriden';},_fillTitle:function(){throw'$.home.widgetServicos._fillTitle should be overriden';}});})(jQuery);(function($){$("div.box-widget-servicos input[type='text']").placeholder();}(jQuery));(function($){$.widget('home.servicosSelect',$.libby.widgetBase,{options:{name:'servicosSelect',placeholder:'',values:[],select:null},_create:function(){this._super('_create');this._createElements();this._bindEvents();this.changeValues(this.options.values);},_createElements:function(){this.elements={};var html=['<input type="hidden" name="',this.options.name,'" />','<a href="#" class="selected-option"></a>','<span class="select-arrow"></span>','<div class="overlay">','<ul>','</ul>','</div>'];this.element.append(html.join(''));this.elements.input=this.element.find('input');this.elements.overlay=this.element.find('.overlay');this.elements.listArea=this.element.find('ul');this.elements.selectedOption=this.element.find('.selected-option');this.element.addClass('libby-servicos-select libby-scrollbar');},_bindEvents:function(){this.element.click($.proxy(this.toggle,this));this.element.delegate('li a','click',$.proxy(function(e){var el=$(e.currentTarget);this.selectElement(el.text(),el.data('value'),true);},this));this._bindSelectEvent();},_bindSelectEvent:function(){if(this.options.select instanceof Function){this._bind('servicosSelectSelect',this.options.select);}},_setOption:function(key,value){$.libby.widgetBase.prototype._setOption.apply(this,arguments);if(key==='values'){this.changeValues(value);}else if(key==='select'){this._bindSelectEvent();}},toggle:function(e){e.preventDefault();if(this.options.values.length===0){return;}
if(this.element.hasClass('visible')){this.close();}else{this.open();}},open:function(){this.element.addClass('visible');$(document).bind('click.servicos-select',$.proxy(function(e){if($(e.target).closest('.libby-servicos-select').length===0){this.close();}},this));},close:function(){this.element.removeClass('visible');$(document).unbind('click.servicos-select');},selectElement:function(name,value,fireEvent){this.elements.selectedOption.text(name);this.elements.input.val(value);if(fireEvent&&this.options.select instanceof Function){this._trigger('servicosSelectSelect',[name,value]);}},changeValues:function(values){this.options.values=values;if(values.length===0){this.element.addClass('disabled');}else{this.element.removeClass('disabled');}
this.selectElement(this.options.placeholder,'');var html=[];for(var i=0,len=values.length;i<len;++i){var value=values[i];html.push('<li>','<a href="#" data-value="',value.value,'">',value.title,'</a>','</li>');}
this.elements.listArea.empty();this.elements.listArea.append(html.join(''));}});})(jQuery);(function(global,$){$.widget('home.servicosPassagens',$.libby.widgetBase,{options:{autocompleteOptions:{},datepickerOptions:{dayNamesMin:['D','S','T','Q','Q','S','S'],dayNames:['Domingo','Segunda','Ter&ccedil;a','Quarta','Quinta','Sexta','S&acedil;bado'],monthNames:['Janeiro','Fevereiro','Mar&ccedil;o','Abril','Maio','Junho','Julho','Agosto','Setembro','Outubro','Novembro','Dezembro'],dateFormat:'dd/mm/y',hideIfNoPrevNext:true,minDate:0,showAnim:'',beforeShow:function(input,widget){widget.dpDiv.addClass('libby-servicos-passagens-datepicker');},onClose:function(input,widget){widget.dpDiv.removeClass('libby-servicos-passagens-datepicker');}}},_create:function(){this._super('_create');this._render();this._bindEvents();this.createAutocomplete();this.createDatepicker();this._saveCurrentPlaceholders();this._onRadioClick();},_render:function(){this.elements.textInputs=this.element.find('input[type="text"]');this.elements.radioIdaVolta=this.element.find('[name="triptype"][value="1"]');this.elements.radioSomenteIda=this.element.find('[name="triptype"][value="2"]');this.elements.travelFrom=this.element.find('[name="airport1_text"]');this.elements.travelFromHidden=this.element.find('[name="airport1"]');this.elements.travelTo=this.element.find('[name="airport2_text"]');this.elements.travelToHidden=this.element.find('[name="airport2"]');this.elements.dateFrom=this.element.find('[name="date1_text"]');this.elements.dateFromHidden=this.element.find('[name="date1"]');this.elements.dateTo=this.element.find('[name="date2_text"]');this.elements.dateToHidden=this.element.find('[name="date2"]');},_bindEvents:function(){this._bind('submit',this._onBeforeSubmit);this.elements.radioIdaVolta.bind('click',$.proxy(this._onRadioClick,this));this.elements.radioSomenteIda.bind('click',$.proxy(this._onRadioClick,this));this.element.delegate('input[type="text"]','focus',this._onInputFocus);this.element.delegate('input[type="text"]','blur',this._onInputBlur);},_saveCurrentPlaceholders:function(){this.elements.textInputs.each(function(){var el=$(this);el.data('_placeholder',el.attr('placeholder'));});},_onInputFocus:function(){var input=$(this);input.addClass('focus');var placeholder=input.data('_placeholder');if(!placeholder){input.attr('placeholder',placeholder);input.placeholder();}
input.removeClass('error');},_onInputBlur:function(){$(this).removeClass('focus');},createAutocomplete:function(){var self=this;var options={autocompleteOptions:$.extend(true,{select:function(widget,item){$(this).nextAll('[type="hidden"]').val(item.item.code);},source:function(request,response){self._autocompleteSource(request,response,this);}},this.options.autocompleteOptions)};this.elements.travelFrom.servicosAutocomplete(options);this.elements.travelTo.servicosAutocomplete(options);},_autocompleteSource:function(request,response,autocompleteWidget){var self=this;$.ajax({url:'http://www.mundi.com.br/airportSuggestion?q='+request.term,jsonpCallback:'scriptCallBack',dataType:'jsonp',success:(function(term){return function(data){if(term!==$(autocompleteWidget.element).val()){response([]);}else{response(self._autocompleteSourceFilter(data));}};}(request.term))});},_autocompleteSourceFilter:function(data){var options=$.trim(data.replace(/^\|?extrakeys=[^\n]*/,'')).split('\n');return $.map(options.slice(0,options.length-1),function(option){option=option.split('|');return{label:option[0],code:option[1]};});},_dateFromDatepickerOptions:function(){var self=this;var dateFromOptions={onSelect:function(date,widget){self.elements.dateTo.datepicker('option','minDate',date);}};$.extend(true,dateFromOptions,this.options.datepickerOptions);return dateFromOptions;},_onInputClick:function(){$(this).datepicker('show');},createDatepicker:function(){this.elements.dateFrom.datepicker(this._dateFromDatepickerOptions()).click(this._onInputClick);this.elements.dateTo.datepicker(this.options.datepickerOptions).click(this._onInputClick);},_onRadioClick:function(e){var somenteIda=this.elements.radioSomenteIda.parent();var idaVolta=this.elements.radioIdaVolta.parent();if(this.elements.radioSomenteIda.is(':checked')){idaVolta.removeClass('checked');somenteIda.addClass('checked');this._disableDateToInput();}else{idaVolta.addClass('checked');somenteIda.removeClass('checked');this._enableDateToInput();}},_disableDateToInput:function(){this.elements.dateTo.attr('disabled',true).addClass('disabled');this.elements.dateToHidden.attr('disabled',true);this.elements.dateTo.attr('placeholder',this.elements.dateTo.data('_placeholder'));this.elements.dateTo.placeholder();},_enableDateToInput:function(){this.elements.dateTo.attr('disabled',false).removeClass('disabled');this.elements.dateToHidden.attr('disabled',false);if(this.elements.dateTo.hasClass('error')){this.elements.dateTo.attr('placeholder',this.elements.dateTo.data('error'));this.elements.dateTo.placeholder();}},_formatDate:function(date){return date.replace(/^(\d{2}\/\d{2}\/)(\d{2})$/,'$120$2');},_onBeforeSubmit:function(e){this.element.find('input[type="text"]').removeClass('error');if(this.elements.travelFrom.val()===''){this.elements.travelFrom.addClass('error').attr('placeholder',this.elements.travelFrom.data('error'));this.elements.travelFrom.placeholder();e.preventDefault();}
if(this.elements.travelTo.val()===''){this.elements.travelTo.addClass('error').attr('placeholder',this.elements.travelTo.data('error'));this.elements.travelTo.placeholder();e.preventDefault();}
if(this.elements.dateFrom.val()===''){this.elements.dateFrom.addClass('error').attr('placeholder',this.elements.dateFrom.data('error'));this.elements.dateFrom.placeholder();e.preventDefault();}
if(this.elements.dateTo.val()===''){this.elements.dateTo.addClass('error');if(!this.elements.dateTo.is(':disabled')){this.elements.dateTo.attr('placeholder',this.elements.dateTo.data('error'));this.elements.dateTo.placeholder();e.preventDefault();}}
this.elements.dateFromHidden.val(this._formatDate(this.elements.dateFrom.val()));this.elements.dateToHidden.val(this._formatDate(this.elements.dateTo.val()));}});}(this,jQuery));(function(global,$){$.widget('home.servicosPassagensAnalytics',$.libby.widgetBase,{_create:function(){this._super('_create');this._bindEvents();},_bindEvents:function(){this._bind('submit',this._onSubmit);},_onSubmit:function(e){if(!e.isDefaultPrevented()){var form=this.element;global._gaq.push(['_trackPageview','/out/C/'+form.attr('action').replace(/^http:\/\//,'')+'?'+form.serialize()]);}}});}(this,jQuery));jQuery('#libby-servicos-passagens-form').servicosPassagens().servicosPassagensAnalytics();(function($){$.widget("home.servicosComparador",$.home.widgetServicos,{_create:function(){$.home.widgetServicos.prototype._create.call(this,arguments);this.textInput=this.element.find(".area-topo input[type='text']");this.form=this.element.find('form');this._bindEvents();this._handleAutocomplete();},_fillBody:function(){var geral=$('<div>').addClass('area-topo');var form=$('<form>').addClass('libby-servicos-autocomplete-container libby-scrollbar').attr({action:'http://www.zoom.com.br/search',method:'get'}).appendTo(geral);$('<input>').attr({type:'text',placeholder:'escolha o produto',name:'q'}).appendTo(form);var areaBtn=$('<div>').addClass('area-botao').appendTo(form);$('<div>').addClass('titulo-pesquise').text('busque e compare preços no zoom').appendTo(areaBtn);$('<button type="submit">').text('pesquisar').appendTo(areaBtn);var areaMeio=$('<div>').addClass('area-meio');var sepMeio=$('<div>').addClass('separador-meio').appendTo(areaMeio);$('<span>').addClass('titulo-meio').text('mais buscados').appendTo(sepMeio);var areaBotoes=$('<div>').addClass('area-botoes');var ul=$('<ul>').appendTo(areaBotoes);var itens=[['tv','televisores'],['camera','câmeras'],['laptop','notebooks'],['smartphone','smartphones'],['tablet','tablets'],['geladeira','geladeiras'],['computador','computadores'],['fogao','fogões']];for(var i=0,len=itens.length;i<len;++i){var item=itens[i];var li=$('<li>').appendTo(ul);$('<a>').addClass(item[0]).attr({href:'http://www.zoom.com.br/search?q='+item[0],'data-title':item[1]}).appendTo(li);}
return[geral,areaMeio,areaBotoes];},_fillTitle:function(){return[$('<span>').addClass('widget-title-image'),document.createTextNode('comparador')];},_bindEvents:function(){var linkButtonsArea=this.element.find(".area-botoes"),spanTitle=this.element.find(".separador-meio .titulo-meio"),originalTitle=spanTitle.text();linkButtonsArea.delegate('li a','mouseenter',function(){spanTitle.text($(this).data("title"));spanTitle.addClass("selecionado");});linkButtonsArea.delegate('li a','mouseleave',function(){spanTitle.text(originalTitle);spanTitle.removeClass("selecionado");});this.form.bind('submit',$.proxy(this._onBeforeSubmit,this));this.textInput.bind('focus',function(){var inputEl=$(this);inputEl.removeClass('error');inputEl.addClass('focus');});this.textInput.bind('blur',function(){var inputEl=$(this);inputEl.removeClass('focus');});},_onBeforeSubmit:function(e){if(this.textInput.val()===''){this.textInput.addClass('error');e.preventDefault();}},_handleAutocomplete:function(){var self=this;this.zoomHelper=new $.servicosComparador.ZoomAutoComplete();this.textInput.servicosAutocomplete({autocompleteOptions:{source:function(request,response){self.zoomHelper.getCompletions(request.term,function(data){if(request.term==self.textInput.val()){response(data);}});},select:function(e,ui){if(ui.item.label==self.textInput.val()){self.textInput.val(ui.item.label);self.form.trigger('submit');}},minLength:1}});}});})(jQuery);(function($,global,context){context.ZoomAutoComplete=function(options){if(!(this instanceof arguments.callee)){return new arguments.callee(options);}
this.options=$.extend({},context.ZoomAutoComplete.defaultOptions,options);this.lastTerm=null;this.slicedLastTerm=null;this.index=null;this.cache={};return this;};context.ZoomAutoComplete.defaultOptions={url:"http://static.zoom.com.br/static/autocomplete-index-p",timeout:2000};global.zoomAutoCompleteBlackBoard={notify:function(data){var funcName='zoomAutoCompleteBlackBoard_notify_'+data.key;if(global[funcName]){global[funcName].apply(this,arguments);}}};context.ZoomAutoComplete.prototype={getCompletions:function(term,response){var self=this;this._setTerm(term);this._updateIndex(term,function(){self._makeCompletionsRequest(term,response);});},_setTerm:function(term){var slicedTerm=term.slice(0,5);if(slicedTerm!=this.slicedLastTerm){this.cache={};this.index=null;}
this.lastTerm=term;this.slicedLastTerm=slicedTerm;},_handleCache:function(pageNumber,cacheData,response){if(cacheData){this.cache[pageNumber]=cacheData;}else{if(pageNumber==null||!this.cache[pageNumber]){return false;}}
var term=this.lastTerm;var termRegExp=new RegExp("^"+term);var completions=$.grep(this.cache[pageNumber],function(item,i){var key=item.key;return key?key.match(termRegExp):false;});if(completions&&completions.length>0){response(completions[0].completions||[]);return true;}
response([]);return true;},_updateIndex:function(term,callback){var indexTerm,self=this;if(term.length>5){indexTerm=term.slice(0,5);}
if(indexTerm&&(!this.index||indexTerm!==this.slicedLastTerm)){this._makeRequest(indexTerm,null,function(data){if(data){self.index=data.idx;}
callback();});return;}
callback();},_makeCompletionsRequest:function(term,response){var self=this,pageNumber=this._findPageNumber(term);if(term!==self.lastTerm){return;}
if(this._handleCache(pageNumber,null,response)){return;}
this._makeRequest(term,pageNumber,function(data){if(term!==self.lastTerm){return;}
if(!data){response([]);return;}
if(pageNumber!=null){self._handleCache(pageNumber,data.idx,response);}else{response(data.completions||[]);}});},_findPageNumber:function(term){if(term.length<=5){return null;}
if(!this.index){return 0;}
var foundIdx;for(var i=0,len=this.index.length;i<len;++i){var currentKey=this.index[i];if(term==currentKey){foundIdx=i;break;}
if(term<currentKey){foundIdx=i-1;break;}}
if(foundIdx<0){return null;}
return foundIdx;},_createSearchTerm:function(term){var originalChar=["á","à","ã","â","ä","å","Á","À","Ã","Â","Ä","Å","é","è","ê","ë","É","È","Ê","Ë","í","ì","î","ï","Í","Ì","Î","Ï","ó","ò","õ","ô","ö","Ó","Ò","Õ","Ô","Ö","ú","ù","û","ü","Ú","Ù","Û","Ü","ç","Ç","ñ","Ñ"," "];var destinationChar=["a","a","a","a","a","a","A","A","A","A","A","A","e","e","e","e","E","E","E","E","i","i","i","i","I","I","I","I","o","o","o","o","o","O","O","O","O","O","u","u","u","u","U","U","U","U","c","C","n","N","_"];var replacementLen=originalChar.length;var searchTerm="";for(var i=0,len=term.length;i<len;++i){var character=term.charAt(i);for(var replacementIdx=0;replacementIdx<replacementLen;++replacementIdx){if(character==originalChar[replacementIdx]){character=destinationChar[replacementIdx];break;}}
searchTerm+="/"+character;}
searchTerm=searchTerm.replace(/[^\d\w\/]/g,"_");return searchTerm;},_makeRequest:function(term,page,callback){var shortTerm=term,fullUrl=this.options.url,self=this;if(page!=null){shortTerm=term.slice(0,5);}
fullUrl+=this._createSearchTerm(shortTerm);if(page!=null){fullUrl+="/"+page.toString().split("").join("/");}
fullUrl+=".js";var requestTimedOut=false;var timeoutHandle=setTimeout(function(){requestTimedOut=true;callback();},this.options.timeout);$.ajax({url:fullUrl,dataType:"jsonp",jsonpCallback:"zoomAutoCompleteBlackBoard_notify_"+shortTerm,success:function(data){if(requestTimedOut){return;}
clearTimeout(timeoutHandle);self._successHandle(callback,data);}});},_successHandle:function(callback,data){callback(data);}};})(jQuery,window,($.servicosComparador=$.servicosComparador||{}));(function(global,$){$.widget('home.servicosComparadorAnalytics',$.libby.widgetBase,{_create:function(){this._super('_create');this.elements.form=this.element.find('form');this._bindEvents();},_bindEvents:function(){this.elements.form.bind('submit',$.proxy(this._onSubmit,this));},_onSubmit:function(e){if(!e.isDefaultPrevented()){var form=this.elements.form;global._gaq.push(['_trackPageview','/out/C/'+form.attr('action').replace(/^http:\/\//,'')+'?'+form.serialize()]);}}});}(this,jQuery));jQuery('div.libby-widget-servicos-comparador').servicosComparador().servicosComparadorAnalytics();(function($){$.widget('home.servicosFipe',$.home.widgetServicos,{_create:function(){$.home.widgetServicos.prototype._create.call(this,arguments);this._collectElements();this._bindEvents();this._initComponents();},_fillBody:function(){var html=['<form id="libby-servicos-fipe-form" method="get" action="http://g1.globo.com/carros/tabela-fipe/index.html">','<div class="tabs-area">','<a href="#" data-tab="model" class="by-model selected">por modelo</a>','<a href="#" data-tab="code" class="by-code">por código fipe</a>','</div>','<div class="radio-area">','<div class="radio-button-container car checked">','<input id="libby-servicos-carro" checked="checked" name="categoria" type="radio" data-api-value="carros" value="carro" />','<label for="libby-servicos-carro" class="styled-radio">','<span class="radio-icon"></span>','</label>','</div>','<div class="radio-button-container motorcycle">','<input id="libby-servicos-moto" name="categoria" type="radio" data-api-value="motos" value="moto" />','<label for="libby-servicos-moto" class="styled-radio">','<span class="radio-icon"></span>','</label>','</div>','<div class="radio-button-container truck">','<input id="libby-servicos-caminhao" name="categoria" type="radio" data-api-value="caminhoes" value="caminhao" />','<label for="libby-servicos-caminhao" class="styled-radio">','<span class="radio-icon"></span>','</label>','</div>','</div>','<div class="user-input-area">','<input type="hidden" name="cod_fipe" />','<div class="libby-servicos-autocomplete-container libby-scrollbar">','<input type="text" class="vehicle-input" autocomplete="off" />','</div>','<div class="select-area"></div>','</div>','<div class="footer-area"></div>','</form>'];return $(html.join(''));},_fillTitle:function(){return document.createTextNode('tabela fipe');},_initComponents:function(){this.elements.selectArea.servicosSelect({name:'detailsTipo',placeholder:'selecione o ano',select:$.proxy(this._modelSelect,this)});this.elements.vehicleInput.servicosAutocomplete({autocompleteOptions:{select:$.proxy(this._autocompleteSelect,this),source:$.proxy(this._autocompleteSource,this),minLength:3},onClear:$.proxy(this.resetSelection,this)});this._onTabChanged('model');},_autocompleteSource:function(request,response){globoapi.fipeSearch.search(this.currentCategory(),request.term,$.proxy(function(category,term,data){if(category!=this.currentCategory()||term!=this.currentTerm()){return;}
var autocompleteData=$.map(data.items,$.proxy(function(item){return{label:this._createLabel(item),original:item};},this));autocompleteData=autocompleteData||[];response(autocompleteData);},this));},_createLabel:function(item){if(this.currentTab()=='model'){return item.marca+' '+item.modelo;}else{return item.cod_fipe;}},_autocompleteSelect:function(widget,data){if(!data||!data.item){return;}
this.currentVehicle=data.item.original;var selectValues=$.map(this.currentVehicle.valores_fipe,function(value){return{title:value.tipo,value:value.tipo};});this.elements.selectArea.servicosSelect({values:selectValues});this.elements.hiddenCode.val(this.currentVehicle.cod_fipe);},_collectElements:function(){this.elements={};this.elements.form=this.element.find('form');this.elements.tabs=this.element.find('.tabs-area a');this.elements.radioContainers=this.element.find('.radio-area .radio-button-container');this.elements.radios=this.element.find('.radio-area input[type="radio"]');this.elements.vehicleInput=this.element.find('input.vehicle-input');this.elements.selectArea=this.element.find('.select-area');this.elements.hiddenCode=this.element.find('input[name="cod_fipe"]');this.elements.footer=this.element.find('.footer-area');},_bindEvents:function(){this.elements.form.bind('submit',$.proxy(this._onFormSubmit,this));this.elements.tabs.bind('click',$.proxy(this.selectTab,this));this.elements.radios.bind('click',$.proxy(this.selectCategory,this));this.elements.vehicleInput.bind('focus',$.proxy(this._onInputFocus,this));this.elements.vehicleInput.bind('blur',$.proxy(this._onInputBlur,this));this.elements.vehicleInput.bind('keyup',$.proxy(this.resetSelection,this));this.elements.vehicleInput.bind('keypress',$.proxy(this._handleInputKeypress,this));},_handleInputKeypress:function(e){if(this.currentTab()!='code'){return;}
var charCode=e.which;if(charCode<=31||charCode>126){return;}
if(charCode!=45&&charCode<48||charCode>57){e.preventDefault();}},_onFormSubmit:function(e){if(!this.shouldSubmit){e.preventDefault();return;}},_onInputFocus:function(){this.elements.vehicleInput.addClass('focus');},_onInputBlur:function(){this.elements.vehicleInput.removeClass('focus');},_modelSelect:function(){this.shouldSubmit=true;this.elements.form.submit();},_onCategoryChanged:function(newCategory){this.resetSelection(null,true);},_onTabChanged:function(newTab){this.resetSelection(null,true);var placeholder,footer;if(newTab=='model'){placeholder='procure seu veículo';footer='ex.: Volkswagen Polo, Fiat Uno, Opala, Variant';this.elements.footer.addClass('model');}else{placeholder='digite o código';footer='ex.: 006002-4';this.elements.footer.removeClass('model');}
this.elements.footer.text(footer);this.elements.vehicleInput.attr('placeholder',placeholder);this.elements.vehicleInput.placeholder();},resetSelection:function(e,force){if(!force&&this.currentVehicle&&this.currentTerm()==this._createLabel(this.currentVehicle)){return;}
if(force){this.elements.vehicleInput.val('');this.elements.vehicleInput.trigger('blur');}
this.elements.selectArea.servicosSelect({values:[]});},selectTab:function(e){e.preventDefault();var target=$(e.currentTarget),tabName=target.data('tab');if(this.currentTab()!=tabName){this._onTabChanged(tabName);}
this.elements.tabs.removeClass('selected');target.addClass('selected');this.currentTabValue=tabName;},selectCategory:function(e){var target=$(e.currentTarget),elementVal=target.data('api-value');if(this.currentCategory()!=elementVal){this._onCategoryChanged(elementVal);}
this.elements.radioContainers.removeClass('checked');target.parent().addClass('checked');this.currentCategoryValue=elementVal;},currentTab:function(){if(!this.currentTabValue){var tab=this.elements.tabs.filter('.selected');this.currentTabValue=tab.data('tab');}
return this.currentTabValue;},currentCategory:function(){if(!this.currentCategoryValue){var checkedEl=this.elements.radios.filter(':checked');this.currentCategoryValue=checkedEl.data('api-value');}
return this.currentCategoryValue;},currentTerm:function(){return this.elements.vehicleInput.val();}});})(jQuery);(function(global,$){$.widget('home.servicosFipeAnalytics',$.libby.widgetBase,{_create:function(){this._super('_create');this.formElement=this.element.find('form');this._bindEvents();},_bindEvents:function(){this.formElement.bind('submit',$.proxy(this._onSubmit,this));},_onSubmit:function(e){if(!e.isDefaultPrevented()){var form=this.formElement;global._gaq.push(['_trackPageview','/out/C/'+form.attr('action').replace(/^http:\/\//,'')+'?'+form.serialize()]);}}});}(this,jQuery));jQuery('div.libby-widget-servicos-fipe').servicosFipe().servicosFipeAnalytics();(function(global,$){global.libby=global.libby||{};global.libby.personalizaveisManager={targets:{},newsUpdatedId:'widgetsPersonalizaveis.newsUpdated',updatePhotosId:'widgetsPersonalizaveis.updatePhotos',init:function(){libby.event.on(this.newsUpdatedId,$.proxy(this._onNewsUpdated,this));},_onNewsUpdated:function(evtData){var target=this.targets[evtData.name];target=this.targets[evtData.name]=target||[];target[evtData.photoIdx]=evtData.isAvailable;var shownPhotos=[];for(var widgetName in this.targets){var photos=this.targets[widgetName];for(var i=0,len=photos.length;i<len;++i){if(shownPhotos[i]===undefined){shownPhotos[i]=true;}
shownPhotos[i]=shownPhotos[i]&&(!!photos[i]);}}
libby.event.fire(this.updatePhotosId,[shownPhotos]);},listenUpdatePhotos:function(callback){libby.event.on(this.updatePhotosId,callback);},fireNewsUpdated:function(name,photoIdx,isAvailable){libby.event.fire(this.newsUpdatedId,[{name:name,photoIdx:photoIdx,isAvailable:isAvailable}]);}};})(window,jQuery);(function(){libby.personalizaveisManager.init();})();(function($){$.widget("home.widgetPersonalizaveis",$.libby.widgetBase,{options:{animationTime:150,coverAnimationTime:200,loadingDelay:500,lockTimeout:1500},_create:function(){this._super('_create');this._createLoadingMarkup();libby.personalizaveisManager.listenUpdatePhotos($.proxy(this._onUpdatePhotos,this));var newsService=this._getNewsService();newsService.onSuccess($.proxy(this._onNewsReady,this));this._getAvailableChoices($.proxy(function(){this._trigger('initialChoice',this._getCurrentChoice());if(this._isFirstTime()){this._createBasicMarkup();this._bindBasicEvents();this._initChoices();this._initCover();}else{this._getAvailableNews($.proxy(function(){this._createBasicMarkup();this._bindBasicEvents();},this));}},this));this.element.widgetPersonalizavelAnalytics();},_getCoverData:function(){throw'_getCoverData should be overriden';},_getChoicesData:function(){throw'_getChoicesData should be overriden';},_getChoiceOptions:function(){throw'_getChoiceOptions should be overriden';},_getNewsService:function(){throw'_getNewsService should be overriden';},_renderChoices:function(choicesData){throw'_renderChoices should be overriden';},_bindChoiceEvents:function(element,choicesData){throw'_bindChoiceEvents should be overriden';},_getDefaultChoice:function(){throw'_getDefaultChoice should be overriden';},_getCssClass:function(){throw'_getCssClass should be overriden';},_getChangeText:function(){throw'_getChangeText should be overriden';},_storageKeyName:function(){throw'_storageKeyName should be overriden';},_getAnalyticsData:function(){throw'_getAnalyticsData should be overriden';},_initChoices:function(readyCallback){if(this.elements.choices){if(readyCallback){readyCallback();}
return;}
this._createChoicesMarkup();this._bindChoiceBasicEvents();this._getAvailableChoices($.proxy(function(data){this._onChoicesReady(data);if(readyCallback){readyCallback();}},this));},_initCover:function(){if(this.elements.cover){return;}
this._createCoverMarkup();this._bindCoverEvents();},loadingShow:function(){var self=this;this.loadingTimeoutHandle=setTimeout(function(){self.elements.loading.show();self.loadingTimeoutHandle=null;},this.options.loadingDelay);},loadingHide:function(){if(this.loadingTimeoutHandle){clearTimeout(this.loadingTimeoutHandle);}
this.elements.loading.hide();},_isLoadingVisible:function(){return this.elements.loading.is(':visible');},_getAvailableChoices:function(callback){if(this.availableChoices){callback(this.availableChoices);return;}
this.loadingShow();this._getChoiceOptions($.proxy(function(data){this.loadingHide();this.availableChoices=data;callback(data);},this));},_onChoicesReady:function(choicesData){this.elements.choicesContent.empty();this.elements.choicesContent.append(this._renderChoices(choicesData));this._bindChoiceEvents(this.elements.choicesContent,choicesData);setTimeout($.proxy(function(){this._applyPIE(this.elements.choicesContent);},this),100);},_getAvailableNews:function(callback){var currentChoice=this._getCurrentChoice(),newsService=this._getNewsService();this.currentNewsOnSuccessCallback=callback;this.loadingShow();newsService.update(currentChoice.slug);},_onNewsReady:function(newsData){if(this.currentNewsOnSuccessCallback){this.currentNewsOnSuccessCallback();this.currentNewsOnSuccessCallback=null;}
var self=this;$.each(newsData,function(idx,el){el.idx=idx;});newsData.sort(function(a,b){var photoOrder=(a.foto?0:1)-(b.foto?0:1);if(photoOrder!==0){return photoOrder;}
return a.idx-b.idx;});var links=$("#bloco-principal a, #glb-area-colunas a"),len=newsData.length,highlightsLen=this.elements.highlightItems.length;for(var i=0,j=0;i<len&&j<highlightsLen;++i){var highlight=this.elements.highlightItems.eq(j);var news=newsData[i];if(this._canIUse(links,news)){var imgEl=highlight.find('img');highlight.find('a').attr('href',news.url);highlight.find('a.title span').text(news.titulo);this._handleImageLoading(imgEl,highlight,j,news.foto);++j;}}
var currentChoice=this._getCurrentChoice();this.elements.highlightsTitle.text(currentChoice.name);this.elements.highlightsLink.attr('href',currentChoice.url);this.loadingHide();},_canIUse:function(links,news){return!links.is('[href="'+news.url+'"]');},_handleImageLoading:function(imgEl,highlight,idx,src){var self=this;highlight.removeClass('com-foto');imgEl.hide();if(!src){imgEl.attr('src','');this._firePhotoUpdated(idx,false);return;}
imgEl.bind('load',function(){imgEl.unbind('load');imgEl.unbind('error');self._firePhotoUpdated(idx,true);});imgEl.bind('error',function(){imgEl.unbind('load');imgEl.unbind('error');imgEl.attr('src','');self._firePhotoUpdated(idx,false);});imgEl.attr('src',src);},_firePhotoUpdated:function(idx,isVisible){libby.personalizaveisManager.fireNewsUpdated(this.widgetBaseClass,idx,isVisible);},_onUpdatePhotos:function(shownPhotos){var images=this.elements.highlightImages;if(!images){return;}
for(var i=0,len=shownPhotos.length;i<len;++i){var toShow=shownPhotos[i],img=images.eq(i),isVisible=img.is(':visible');if(toShow==isVisible){continue;}
var highlight=img.parents('li').first();if(toShow){highlight.addClass('com-foto');}else{highlight.removeClass('com-foto');}
images.eq(i).toggle(toShow);}},_getStoredSlug:function(){var storedCookie=libby.cookie.read(this._storageKeyName());if(storedCookie){return storedCookie.toUpperCase();}
return null;},_getCurrentChoice:function(){if(this.currentChoice){return this.currentChoice;}
var choice=this._getStoredChoice();if(!choice){choice=this._getDefaultChoice();}
return choice;},_getStoredChoice:function(){var storedSlug=this._getStoredSlug();if(!storedSlug){return null;}
for(var i=0,len=this.availableChoices.length;i<len;++i){var choice=this.availableChoices[i];if(choice.slug.toUpperCase()==storedSlug){return choice;}}
return null;},_isFirstTime:function(){var storedSlug=this._getStoredSlug();var storedChoice=this._getStoredChoice();var defaultChoice=this._getDefaultChoice();if(storedChoice||(defaultChoice&&storedSlug===defaultChoice.slug.toUpperCase())){return false;}
return true;},lockSaveOptions:function(){var self=this;this.isSavingChoice=true;this.lockTimeoutHandler=setTimeout(function(){self.isSavingChoice=false;self.lockTimeoutHandler=null;},this.options.lockTimeout);},unlockSaveOptions:function(){if(this.lockTimeoutHandler){clearTimeout(this.lockTimeoutHandler);}
this.isSavingChoice=false;},_saveChoice:function(choiceObj){var currentChoice=this._getCurrentChoice(),isFirstTime=this._isFirstTime();if(this.isSavingChoice){return;}
if(isFirstTime){this._destroyCover();}
if(!choiceObj){choiceObj=currentChoice;}
this.currentChoice=choiceObj;libby.cookie.create(this._storageKeyName(),choiceObj.slug,365*24*60,'globo.com');if(isFirstTime||choiceObj.slug!=currentChoice.slug){this.lockSaveOptions();this._getAvailableNews($.proxy(function(){this.unlockSaveOptions();this._closeChoices();},this));}else{this._closeChoices();}},_createBasicMarkup:function(){if(this.elements.highlights){return;}
var highlightsHtml=function(id){return['<li class="analytics-area analytics-id-',id,'">','<div class="image-container">','<a href="#" class="image-link css3pie"></a>','<img src="" class="css3pie"></img>','</div>','<a href="#" class="title"><span></span></a>','</li>'].join('');};var html=['<div class="widget-highlights '+this._getCssClass()+'">','<div class="area-topo">','<a href="#" class="titulo">','<span class="area-selecionada"></span>','<span class="img-link"></span>','</a>','<a class="trocar-button css3pie" href="#"><span>'+this._getChangeText()+'</span></a>','</div>','<ul>',highlightsHtml(1),highlightsHtml(2),'</ul>','</div>'];this.element.append(html.join(''));this.elements.highlights=this.element.find('.widget-highlights');this.elements.highlightItems=this.elements.highlights.find('li');this.elements.highlightsTitle=this.elements.highlights.find('.area-topo .area-selecionada');this.elements.highlightsLink=this.elements.highlights.find('.area-topo a.titulo');this.elements.highlightImages=this.elements.highlightItems.find('img');this._applyPIE(this.elements.highlights);},_applyPIE:function(element){if(!window.PIE){return;}
element.find('.css3pie').each(function(){PIE.attach(this);});},_createCoverMarkup:function(){var coverData=this._getCoverData();var html=['<div class="widget-cover config-area">','<span class="cover-title">'+coverData.title+'</span>','<span class="cover-image"></span>','<span class="cover-subtitle">'+coverData.subtitle+'</span>','<a class="close-button" href="#"></a>','</div>'];this.element.append(html.join(''));this.elements.cover=this.element.find('.widget-cover');this._applyPIE(this.elements.cover);},_createChoicesMarkup:function(){var choicesData=this._getChoicesData();var html=['<div class="widget-choices config-area">','<div class="area-topo">','<span class="choice-title">'+choicesData.title+'</span>','<a class="close-button" href="#"></a>','</div>','<div class="choices-content">','</div>','</div>'];this.element.append(html.join(''));this.elements.choices=this.element.find('.widget-choices');this.elements.choicesContent=this.elements.choices.find('.choices-content');this._applyPIE(this.elements.choices);},_createLoadingMarkup:function(){if(this.elements.loading){return;}
this.element.append('<div class="loading config-area"></div>');this.elements.loading=this.element.find('.loading');this._applyPIE(this.elements.loading);},_bindBasicEvents:function(){var button=this.elements.highlights.find('a.trocar-button'),self=this;button.click($.proxy(function(e){e.preventDefault();e.stopPropagation();this._trigger("onChangeOption",this._getAnalyticsData());this._initChoices(function(){self.elements.choices.fadeIn(self.options.animationTime);});},this));},_bindCoverEvents:function(){var cover=this.elements.cover,choices=this.elements.choices,animationTime=this.options.coverAnimationTime,self=this;choices.show();this.element.hover(function(){cover.stop(true).animate({opacity:0},animationTime,undefined,function(){cover.hide();});},function(){if(!cover.is(':visible')){cover.show();}
cover.stop(true).animate({opacity:1},animationTime);self._trigger("coverHide");});},_destroyCover:function(){this.element.unbind('mouseleave').unbind('mouseenter');if(this.elements.cover){this.elements.cover.remove();}},_bindChoiceBasicEvents:function(){var choices=this.elements.choices;var closeBtn=choices.find('.close-button');closeBtn.click($.proxy(function(e){e.preventDefault();e.stopPropagation();this._trigger("onCloseChoicesArea",[this._getAnalyticsData(),this._getStoredSlug()]);this._saveChoice();},this));},_closeChoices:function(){var choices=this.elements.choices;if(this._isLoadingVisible()){this._trigger("coverHide");choices.hide();}else{choices.fadeOut(this.options.animationTime,$.proxy(function(){this._trigger("coverHide");choices.hide();},this));}}});})(jQuery);(function(global){$.widget('libby.widgetPersonalizavelAnalytics',$.libby.widgetBase,{_create:function(){this._super("_create");this._bindEvents();},_bindEvents:function(){this._bind("onOptionSelected",this._onOptionSelected);this._bind("onChangeOption",this._onChangeOption);this._bind("onCloseChoicesArea",this._onCloseChoicesArea);},_optionValue:function(data){var optionValue=data.value;if(data.type=="estado"){if(optionValue=="Brasil"){optionValue='Todos';}else{optionValue='UF/'+optionValue;}}else if(data.type=="time"&&optionValue=="Todos os times"){optionValue='Todos';}
return optionValue;},_onCloseChoicesArea:function(e,data,cookieValue){if(!cookieValue){global._gaq.push(['_trackEvent',data.category,'Fechar '+data.type,'Não selecionado']);}},_onChangeOption:function(e,data){global._gaq.push(['_trackEvent',data.category,'Intenção troca '+data.type,this._optionValue(data)]);},_onOptionSelected:function(e,data){global._gaq.push(['_trackEvent',data.category,'Troca '+data.type,this._optionValue(data)]);}});})(window);(function($){$.widget("home.personalizaveisNoticias",$.home.widgetPersonalizaveis,{_create:function(){this._initStates();$.home.widgetPersonalizaveis.prototype._create.call(this,arguments);},_storageKeyName:function(){return'p.estado';},_getAnalyticsData:function(){return{category:"Meu estado",type:"estado",value:this._getCurrentChoice().name};},_initStates:function(){this.availableStates=[];var widgetStatesData=this.element.data('widgetData');for(var key in widgetStatesData){widgetStatesData[key].slug=key;this.availableStates.push(widgetStatesData[key]);}
this.availableStates=this.availableStates.sort(function(item,item2){if(item.ordering==item2.ordering)return 0;return item.ordering<item2.ordering?-1:1;});},_getCoverData:function(){return{title:'notícias do meu estado',subtitle:'Personalize esta área com as notícias do seu estado'};},_getChoicesData:function(){return{title:'Meu estado'};},_getCssClass:function(){return'glb-hl-style-noticia';},_getChangeText:function(){return'trocar estado';},_getNewsService:function(){return globoapi.regionalNews;},_getChoiceOptions:function(callback){callback(this.availableStates);},_getDefaultChoice:function(){return{slug:'Todos',name:'Brasil',url:'http://g1.globo.com'};},_renderChoices:function(choicesData){var liHtml=[];var len=Math.min(27,choicesData.length);for(var i=0;i<len;++i){var state=choicesData[i];liHtml=liHtml.concat(['<li>','<a class="css3pie" href="#" data-slug="',state.slug.toLowerCase(),'">','<span class="state-flag ',state.slug.toLowerCase(),'"></span>','</a>','</li>']);}
var html=['<ul>',liHtml.join(''),'</ul>','<div class="tooltip css3pie"><span class="state-name"></span><div class="arrow"></div></div>','<div class="bottom-area">','<a href="#todos-os-estados" class="button-all css3pie">Todos os estados</a>','</div>'];return html.join('');},_bindChoiceEvents:function(element,choicesData){var choicesMap={},self=this;for(var i=0,len=choicesData.length;i<len;++i){var state=choicesData[i];choicesMap[state.slug.toUpperCase()]=state;}
element.delegate('li a','click',function(e){e.preventDefault();e.stopPropagation();var slug=$(this).data('slug').toUpperCase();var state=choicesMap[slug];if(state){self._changeState(state);}
self._trigger("onOptionSelected",self._getAnalyticsData());});element.delegate('.bottom-area a','click',function(e){e.preventDefault();e.stopPropagation();self._changeState(self._getDefaultChoice());self._trigger("onOptionSelected",self._getAnalyticsData());});var tooltip=element.find('.tooltip'),tooltipText=tooltip.find('.state-name');element.find('li a').hover(function(){var liElement=$(this),liPos=liElement.offset(),liWidth=liElement.outerWidth(),liHeight=liElement.outerHeight(),slug=liElement.data('slug').toUpperCase(),state=choicesMap[slug];tooltip.show();tooltipText.text(state.name);var tooltipWidth=tooltip.outerWidth(),tooltipHeight=tooltip.outerHeight(true);tooltip.offset({left:liPos.left-(tooltipWidth/2)+(liWidth/2),top:liPos.top-tooltipHeight});},function(){tooltip.hide();});if(!this._isFirstTime()){this._changeState();}},_changeState:function(state){var flagLinks=this.elements.choices.find('li a');if(!state){state=this._getCurrentChoice();}
flagLinks.removeClass('selected');flagLinks.filter('[data-slug="'+state.slug.toLowerCase()+'"]').addClass('selected');this._saveChoice(state);}});})(jQuery);(function($){$('div.libby-widgets-personalizaveis-noticias').personalizaveisNoticias();})(jQuery);(function($){$.widget("home.personalizaveisNovelas",$.home.widgetPersonalizaveis,{_create:function(){this._initNovelas();$.home.widgetPersonalizaveis.prototype._create.call(this,arguments);},_storageKeyName:function(){return'p.novela';},_initNovelas:function(){this.availableNovelas=this.element.data('widgetData');for(var i=0,len=this.availableNovelas.length;i<len;++i){var novela=this.availableNovelas[i];if(novela['default']==1){this.defaultNovela=novela;}}
if(!this.defaultNovela){this.defaultNovela=this.availableNovelas[0];}},_getAnalyticsData:function(){return{category:"Minha novela",type:"novela",value:this._getCurrentChoice().name};},_getCoverData:function(){return{title:'minha novela favorita',subtitle:'Personalize esta área com as notícias de sua novela predileta'};},_getChoicesData:function(){return{title:'Minha novela favorita'};},_getCssClass:function(){return'glb-hl-style-entretenimento';},_getChangeText:function(){return'trocar novela';},_getNewsService:function(){return globoapi.novelaNews;},_getChoiceOptions:function(callback){callback(this.availableNovelas);},_getDefaultChoice:function(){return this.defaultNovela;},_renderChoices:function(choicesData){var liHtml=[];for(var i=0,len=choicesData.length;i<len;++i){var novela=choicesData[i];liHtml=liHtml.concat(['<li>','<a href="#',novela.slug,'" class="css3pie ',novela.slug,'" data-slug="',novela.slug,'">','<span>','<span>',novela.name,'</span>','</span>','</a>','</li>']);}
var html=['<ul>',liHtml.join(''),'</ul>'];return html.join('');},_bindChoiceEvents:function(element,choicesData){var choicesMap={},self=this;for(var i=0,len=choicesData.length;i<len;++i){var novela=choicesData[i];choicesMap[novela.slug]=novela;}
element.delegate('li a','click',function(e){e.preventDefault();e.stopPropagation();var slug=$(this).data('slug');var novela=choicesMap[slug];if(novela){self._changeNovela(novela);}
self._trigger("onOptionSelected",self._getAnalyticsData());});if(!this._isFirstTime()){this._changeNovela();}},_changeNovela:function(novela){var listItems=this.elements.choices.find('li'),links=listItems.find('a');if(!novela){novela=this._getCurrentChoice();}
listItems.removeClass('selected');links.filter('[data-slug="'+novela.slug+'"]').parent().addClass('selected');this._saveChoice(novela);}});})(jQuery);(function($){$('div.libby-widgets-personalizaveis-novelas').personalizaveisNovelas();})(jQuery);(function($){$.widget("home.personalizaveisTimes",$.home.widgetPersonalizaveis,{_create:function(){this._initTeams();$.home.widgetPersonalizaveis.prototype._create.call(this,arguments);},_storageKeyName:function(){return'p.time';},_initTeams:function(){this.availableTeams=[{id:373,name:"Atlético-GO",url:"http://globoesporte.globo.com/futebol/times/atletico-go/",slug:"atletico-go",series:"A"},{id:282,name:"Atlético-MG",url:"http://globoesporte.globo.com/futebol/times/atletico-mg/",slug:"atletico-mg",series:"A"},{id:265,name:"Bahia",url:"http://globoesporte.globo.com/futebol/times/bahia/",slug:"bahia",series:"A"},{id:263,name:"Botafogo",url:"http://globoesporte.globo.com/futebol/times/botafogo/",slug:"botafogo",series:"A"},{id:264,name:"Corinthians",url:"http://globoesporte.globo.com/futebol/times/corinthians/",slug:"corinthians",series:"A"},{id:294,name:"Coritiba",url:"http://globoesporte.globo.com/futebol/times/coritiba/",slug:"coritiba",series:"A"},{id:283,name:"Cruzeiro",url:"http://globoesporte.globo.com/futebol/times/cruzeiro/",slug:"cruzeiro",series:"A"},{id:316,name:"Figueirense",url:"http://globoesporte.globo.com/futebol/times/figueirense/",slug:"figueirense",series:"A"},{id:262,name:"Flamengo",url:"http://globoesporte.globo.com/futebol/times/flamengo/",slug:"flamengo",series:"A"},{id:266,name:"Fluminense",url:"http://globoesporte.globo.com/futebol/times/fluminense/",slug:"fluminense",series:"A"},{id:284,name:"Grêmio",url:"http://globoesporte.globo.com/futebol/times/gremio/",slug:"gremio",series:"A"},{id:285,name:"Internacional",url:"http://globoesporte.globo.com/futebol/times/internacional/",slug:"internacional",series:"A"},{id:343,name:"Náutico",url:"http://globoesporte.globo.com/futebol/times/nautico/",slug:'nautico',series:"A"},{id:275,name:"Palmeiras",url:"http://globoesporte.globo.com/futebol/times/palmeiras/",slug:"palmeiras",series:"A"},{id:303,name:"Ponte Preta",url:"http://globoesporte.globo.com/futebol/times/ponte-preta/",slug:'ponte-preta',series:"A"},{id:278,name:"Portuguesa",url:"http://globoesporte.globo.com/futebol/times/portuguesa/",slug:'portuguesa',series:"A"},{id:277,name:"Santos",url:"http://globoesporte.globo.com/futebol/times/santos/",slug:"santos",series:"A"},{id:276,name:"São Paulo",url:"http://globoesporte.globo.com/futebol/times/sao-paulo/",slug:"sao-paulo",series:"A"},{id:292,name:"Sport",url:"http://globoesporte.globo.com/futebol/times/sport/",slug:'sport',series:"A"},{id:267,name:"Vasco",url:"http://globoesporte.globo.com/futebol/times/vasco/",slug:"vasco",series:"A"},{id:350,name:"ABC",url:"http://globoesporte.globo.com/futebol/times/abc/",slug:"abc",series:"B"},{id:327,name:"América-MG",url:"http://globoesporte.globo.com/futebol/times/america-mg/",slug:"america-mg",series:"B"},{id:351,name:"América-RN",url:"http://globoesporte.globo.com/futebol/times/america-rn/",slug:"america-rn",series:"B"},{id:2197,name:"Americana",url:"http://globoesporte.globo.com/futebol/times/americana/",slug:"americana",series:"B"},{id:342,name:"ASA",url:"http://globoesporte.globo.com/futebol/times/asa/",slug:"asa",series:"B"},{id:293,name:"Atlético-PR",url:"http://globoesporte.globo.com/futebol/times/atletico-pr/",slug:"atletico-pr",series:"B"},{id:314,name:"Avaí",url:"http://globoesporte.globo.com/futebol/times/avai/",slug:"avai",series:"B"},{id:2196,name:"Barueri",url:"http://globoesporte.globo.com/futebol/times/gremio-barueri/",slug:"gremio-barueri",series:"B"},{id:3057,name:"Boa Esporte",url:"http://globoesporte.globo.com/futebol/times/boa-esporte/",slug:"boa-esporte",series:"B"},{id:280,name:"Bragantino",url:"http://globoesporte.globo.com/futebol/times/bragantino/",slug:'bragantino',series:"B"},{id:354,name:"Ceará",url:"http://globoesporte.globo.com/futebol/times/ceara/",slug:"ceara",series:"B"},{id:340,name:"CRB",url:"http://globoesporte.globo.com/futebol/times/crb/",slug:'crb',series:"B"},{id:288,name:"Criciúma",url:"http://globoesporte.globo.com/futebol/times/criciuma/",slug:'criciuma',series:"B"},{id:290,name:"Goiás",url:"http://globoesporte.globo.com/futebol/times/goias/",slug:'goias',series:"B"},{id:279,name:"Guarani",url:"http://globoesporte.globo.com/futebol/times/guarani/",slug:'guarani',series:"B"},{id:1349,name:"Ipatinga",url:"http://globoesporte.globo.com/futebol/times/ipatinga/",slug:'ipatinga',series:"B"},{id:317,name:"Joinville",url:"http://globoesporte.globo.com/futebol/times/joinville/",slug:'joinville',series:"B"},{id:289,name:"Paraná",url:"http://globoesporte.globo.com/futebol/times/parana/",slug:"parana",series:"B"},{id:386,name:"São Caetano",url:"http://globoesporte.globo.com/futebol/times/sao-caetano/",slug:'sao-caetano',series:"B"},{id:287,name:"Vitória",url:"http://globoesporte.globo.com/futebol/times/vitoria/",slug:'vitoria',series:"B"}];},_getAnalyticsData:function(){var currentChoice=this._getCurrentChoice();return{category:"Meu time",type:"time",value:currentChoice.name,slug:currentChoice.slug,id:currentChoice.id};},_getCoverData:function(){return{title:'meu time do coração',subtitle:'Personalize esta área com as notícias do seu time'};},_getChoicesData:function(){return{title:'Meu time'};},_getCssClass:function(){return'glb-hl-style-esporte';},_getChangeText:function(){return'trocar time';},_getNewsService:function(){return globoapi.soccerNews;},_getChoiceOptions:function(callback){callback(this.availableTeams);},_getDefaultChoice:function(){return{slug:'Todos',name:'Todos os times',url:'http://globoesporte.globo.com',series:'A'};},_renderChoices:function(choicesData){var liHtml=[];for(var i=0,len=choicesData.length;i<len;++i){var team=choicesData[i];liHtml=liHtml.concat(['<li class="serie-',team.series.toLowerCase(),'">','<a ','title="',team.name,'"',' class="css3pie ',team.slug.toLowerCase(),'" data-slug="',team.slug.toLowerCase(),'" href="#',team.slug.toLowerCase(),'">','<span class="team-flag"></span>','</a>','</li>']);}
var html=['<ul class="teams">',liHtml.join(''),'</ul>','<div class="bottom-area">','<a href="#todos-os-times" class="button-all css3pie">Todos os times</a>','<div class="select-area">','<ul>','<li><a href="#" data-series="A">Série A</a></li>','<li><a href="#" data-series="B">Série B</a></li>','</ul>','</div>','</div>'];return html.join('');},_bindChoiceEvents:function(element,choicesData){var choicesMap={},self=this;for(var i=0,len=choicesData.length;i<len;++i){var team=choicesData[i];choicesMap[team.slug.toUpperCase()]=team;}
element.delegate('ul.teams li a','click',function(e){e.preventDefault();e.stopPropagation();var slug=$(this).data('slug').toUpperCase();var team=choicesMap[slug];if(team){self._changeTeam(team);}
self._trigger("onOptionSelected",self._getAnalyticsData());});element.delegate('.bottom-area a.button-all','click',function(e){e.preventDefault();e.stopPropagation();self._changeTeam(self._getDefaultChoice());self._trigger("onOptionSelected",self._getAnalyticsData());});if(!this._isFirstTime()){this._changeTeam();}
this._changeSeries();this._handleSelectArea();},_handleSelectArea:function(){var element=this.elements.choices,selectAreaElement=this.elements.choices.find('.select-area'),self=this;this._bind("coverHide",function(){self._hideSeriesMenu(selectAreaElement);});element.delegate('.select-area:not(.visible) a','click',function(e){e.preventDefault();e.stopPropagation();self._onSeriesMenuOpen(selectAreaElement);});element.delegate('.select-area.visible ul a','click',function(e){e.preventDefault();e.stopPropagation();self._onSeriesMenuClick(selectAreaElement,this);});},_onSeriesMenuOpen:function(selectAreaElement){var self=this;selectAreaElement.addClass("visible");$(document).bind('click.widget-times',function(e){if($(e.target).is('.select-area a')){return;}
self._hideSeriesMenu(selectAreaElement);});},_onSeriesMenuClick:function(selectAreaElement,chosenElement){this._changeSeries($(chosenElement).data('series'));this._hideSeriesMenu(selectAreaElement);},_hideSeriesMenu:function(selectAreaElement){selectAreaElement.removeClass("visible");$(document).unbind('click.widget-times');},_changeTeam:function(team){var listItems=this.elements.choices.find('li'),links=listItems.find('a');if(!team){team=this._getCurrentChoice();}
listItems.removeClass('selected');links.filter('[data-slug="'+team.slug.toLowerCase()+'"]').parent().addClass('selected');this._saveChoice(team);},_changeSeries:function(newSeries){var invert=false,ulElement=this.elements.choices.find('.select-area ul');if(!newSeries){newSeries=this._getCurrentChoice().series;if(newSeries=='B'){invert=true;}}
if(this.currentSeries&&this.currentSeries!=newSeries){invert=true;}
if(invert){ulElement.children().first().detach().appendTo(ulElement);}
if(!this.itemsSerieA||!this.itemsSerieB){var choices=this.elements.choices;this.itemsSerieA=choices.find('li.serie-a');this.itemsSerieB=choices.find('li.serie-b');}
this.currentSeries=newSeries;if(newSeries=='A'){this.itemsSerieA.show();this.itemsSerieB.hide();}else{this.itemsSerieA.hide();this.itemsSerieB.show();}}});})(jQuery);(function($){$('div.libby-widgets-personalizaveis-times').personalizaveisTimes();})(jQuery);(function($){if(window.PIE){$('body .css3pie').each(function(){PIE.attach(this);});}})(jQuery);