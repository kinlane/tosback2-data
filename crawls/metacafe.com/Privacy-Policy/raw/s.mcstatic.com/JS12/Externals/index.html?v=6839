/* Metacafe Copyright - http://www.metacafe.com/ */
/* Files included: BaseFunctions.js.tmp 4Omniture.js.tmp Moobox.js.tmp _AgeGateway.js.tmp */

var s={};var s_objectID='';var s_c2f=function(){};var s_c2fa=function(){};var s_c2fe=function(){};var s_cgif=function(){};var s_cdoPlugins=function(){};var s_gi=function(){};var s_vp_getCGI=function(){};s.trackDownloadLinks=true
s.trackExternalLinks=true
s.trackInlineStats=true
s.linkDownloadFileTypes="exe,zip,wav,mp3,mov,mpg,avi,wmv,doc,pdf,xls"
s.linkInternalFilters="javascript:,."
s.linkLeaveQueryString=false
s.linkTrackVars="None"
s.linkTrackEvents="None"
s.visitorNamespace="metacafe"
s.usePlugins=true
s.getQueryParam={};s.gcgi={};s.cgif={};
var AgeGateway=new Class({Implements:[Options],options:{pageName:'redBand',ageLimit:18,redirect:'/',overlayOpacity:0.9,removeFF:true,isFamilyFilterOn:true,pausePlayer:false,perSession:false},initialize:function(options){this.setOptions(options);this.hashCookie=new Hash.Cookie('User',{domain:headerObj.cookieDomain,path:'/',duration:362});this.ageCookieName=this.options.pageName+'_age';this.sessIDCookieName=this.options.pageName+'_sessid';this.boolSessionCookieName=this.options.pageName+'_ok';this.getAgeLimitCookie();},getAgeLimitCookie:function(){this.savedAge=this.hashCookie.get(this.ageCookieName);if(this.options.removeFF&&(this.options.isFamilyFilterOn==false)){return;}
if(this.options.perSession&&!(this.isSameSession())){this.showAgeGateway();}else if(this.savedAge&&this.savedAge>=this.options.ageLimit){return;}else{this.showAgeGateway();}},isSameSession:function(){return(Cookie.get('PHPSESSID')&&(Cookie.get('PHPSESSID')==this.hashCookie.get(this.sessIDCookieName)));},showAgeGateway:function(banned){window.showAgeGateFlg=true;var url='/f/index.php?pageToLoad=static&displayMode=ageGateway&isFramed=0';if(banned){url+='blocked=1';}
if(this.options.pausePlayer){VideoStateManager.states.set('playing',function(){var player=document.getElementById('fpObj');player.style.visibility='hidden';if(player&&typeof player.pause=='function'){try{player.pause();}catch(err){}}});}
if($("Billboard")){$("Billboard").remove();}
this.mbox=new Moobox({showOverlay:true,classes:{closer:'Hidden',window:'MbxContainer AgeGateway'}});this.mbox.addEvent('onUpdate',this.initAgeGatewayForm.bind(this));this.mbox.getContent(url);},initAgeGatewayForm:function(){if(this.options.perSession&&!(this.isSameSession())){this.showAgeGatewayForm();}else if(this.savedAge&&this.savedAge.toInt()<this.options.ageLimit){this.toggleUnderageWarning();}},showAgeGatewayForm:function(){$('AgeGatewayForm').setStyle('visibility','visible');$('VerifyAge').addEvent('click',this.onAgeSubmit.bindWithEvent(this));},onAgeSubmit:function(ev){ev.preventDefault();var d=$('rBDateDay').value,m=$('rBDateMonth').value,y=$('rBDateYear').value;if(d=='DD'||m=='MM'||y=='YYYY'){return;}
var curDate=new Date();var minDate=new Date(curDate.getYear()-this.options.ageLimit,curDate.getMonth(),curDate.getDate(),0,0,0,0);var inputDate=new Date(y,m-1,d,0,0,0,0);var diff=minDate-inputDate;var valid=isNaN(diff)||diff<0?false:true;var age=curDate.getFullYear()-inputDate.getFullYear();if(age==this.options.ageLimit)age-=1;this.hashCookie.set(this.ageCookieName,age);if(this.options.perSession){this.hashCookie.set(this.sessIDCookieName,Cookie.get('PHPSESSID'));}
if(!valid){if(this.options.perSession){this.hashCookie.set(this.boolSessionCookieName,'');}
this.toggleUnderageWarning();}else{if(this.options.perSession){this.hashCookie.set(this.boolSessionCookieName,1);}
if(this.options.removeFF){self.location.href='/f/index.php?inputType=filter&controllerGroup=user&filters=0&prevURL='+self.location.href;}else{if(this.pausePlayer){window.location.reload();}else{this.mbox.close();}}}},toggleUnderageWarning:function(){$('AgeGatewayForm').addClass('Hidden');$('UnderageWarning').removeClass('Hidden');this.redirect.delay(5000,this);},redirect:function(){self.location.href=this.options.redirect;}});
var uuID="";function fpSetUUID(val){if(typeof kpi!='undefined'){kpi.onUUID();}}
function initUUID(){if($('uuGenContainer')){var flashvars=false;var attributes={id:'uuGenFlashObj'};swfobject.embedSWF(headerObj.uuIDFlashFileURL,"uuGenContainer","1","1","8",false,false,swfobject.defaultParams,attributes);}}
function removeElement(id){if($(id)){$(id).dispose();}}
function flashReadCookie(name){return Cookie.read(name);}
function flashWriteCookie(name,value,expiry){var expires=expiry||0;Cookie.write(name,value,{duration:expires,domain:document.domain,path:'/'});}
function setRealCookie(name,value,expires,path,domain,secure){document.cookie=name+"="+escape_utf8(value)+
((expires)?"; expires="+expires:"")+
((path)?"; path="+path:"")+
((domain)?"; domain="+domain:"")+
((secure)?"; secure":"");}
function getFullURL(sUrl){if(sUrl.charAt(0)=='/'){var rand=Math.random();rand=rand.substring(2,11);var serverAddr=location.href;var lastSlashIndex=serverAddr.indexOf('/',8);var fullUrl=serverAddr.substr(0,lastSlashIndex);fullUrl=fullUrl.concat('/ajax_services/'+rand+sUrl);return fullUrl;}
return sUrl;}
function getElement(id){return $(id);}
function getExpDate(days,hours,minutes){var expDate=new Date();if(typeof days=="number"&&typeof hours=="number"&&typeof hours=="number"){expDate.setDate(expDate.getDate()+parseInt(days));expDate.setHours(expDate.getHours()+parseInt(hours));expDate.setMinutes(expDate.getMinutes()+parseInt(minutes));return expDate.toGMTString();}}
function setItemCookie(nextItemID,cookieName,index){if(cookieName=='Related'){cookieName='nextVideosClkItemID';}
else if(cookieName=='Recommended'){cookieName='sideBarDynBanClkItemID';}
else if(cookieName=='Newest'||cookieName=='User'){cookieName='newestVideosClkItemID';}
if(cookieName){setRealCookie(cookieName,nextItemID,getExpDate(0,0,10),"/",".metacafe.com");setRealCookie('prev'+cookieName,itemID,getExpDate(0,0,10),"/",".metacafe.com");setRealCookie('index'+cookieName,index-1,getExpDate(0,0,10),"/",".metacafe.com");}}
function ajaxObject(method,url,postData,onCompleteFn,onErrorFn){this.method=method;this.url=getFullURL(url);this.postData=postData;this.onComplete=onCompleteFn;this.onError=onErrorFn;}
ajaxObject.prototype.load=function(){this.request=this.getXHR();var _this=this;this.request.onreadystatechange=function(){_this.onData();};this.request.open(this.method,this.url,true);this.request.setRequestHeader('X-Requested-With','XMLHttpRequest');this.request.setRequestHeader('Connection','close');this.request.setRequestHeader('Content-type','application/x-www-form-urlencoded');this.request.send(this.postData);};ajaxObject.prototype.getXHR=function(){var xmlHttp;try{xmlHttp=new ActiveXObject("Msxml2.XMLHttp");}
catch(e){try{xmlHttp=new ActiveXObject("Microsoft.XMLHttp");}
catch(e2){}}
if(xmlHttp===undefined&&(typeof XMLHttpRequest!=='undefined')){xmlHttp=new XMLHttpRequest();}
return xmlHttp;};ajaxObject.prototype.onData=function(){if(this.request.readyState==1){}
if(this.request.readyState==4){if(this.request.status=="200"){this.headers=this.request.getAllResponseHeaders();if(this.onComplete!==undefined){this.onComplete(this.request.responseText);}}else{if(this.onError!==undefined){this.onError(this.request.status,this.request.responseText);}}
delete this.request;}};function AjaxRequest(method,sUrl,sPostdata,fnOnComplete,fnOnError)
{var ajaxObj=new ajaxObject(method,sUrl,sPostdata,fnOnComplete,fnOnError);ajaxObj.load();return true;}
var reloadWindow=false;function nibble_to_hex(nibble){var chars='0123456789ABCDEF';return chars.charAt(nibble);}
function escape_utf8(data){if(typeof(data)!='string'){return data;}
if(data===''||data===null){return'';}
var buffer='';for(var i=0;i<data.length;i++){var c=data.charCodeAt(i);var bs=[];if(c>0x10000){bs[0]=0xF0|((c&0x1C0000)>>>18);bs[1]=0x80|((c&0x3F000)>>>12);bs[2]=0x80|((c&0xFC0)>>>6);bs[3]=0x80|(c&0x3F);}else if(c>0x800){bs[0]=0xE0|((c&0xF000)>>>12);bs[1]=0x80|((c&0xFC0)>>>6);bs[2]=0x80|(c&0x3F);}else if(c>0x80){bs[0]=0xC0|((c&0x7C0)>>>6);bs[1]=0x80|(c&0x3F);}else{bs[0]=c;}
for(var j=0;j<bs.length;j++){var b=bs[j];var hex=nibble_to_hex((b&0xF0)>>>4)+nibble_to_hex(b&0x0F);buffer+='%'+hex;}}
return buffer;}
function getCookie(name){var cookies=document.cookie;var prefix=name+"=";var beginP=cookies.indexOf("; "+prefix);if(beginP==-1){beginP=cookies.indexOf(prefix);if(beginP!==0){return null;}}
else{beginP+=2;}
var endP=cookies.indexOf(";",beginP);if(endP==-1){endP=cookies.length;}
return unescape(cookies.substring(beginP+prefix.length,endP));}
function onErrorChangeCookie(error){alert('Error: '+error);}
function onCompleteChangeCookie(data){if(data!==0){document.cookie="mainData="+data+"; expires="+getExpDate(1000,0,0)+"; path='/'"+"; domain='.metacafe.com'";if(reloadWindow){var jsonData=JSON.decode(data);reloadWindow=false;if(headerObj.category=="adult"){var currURL=window.location.href;currURL=currURL.replace('/adult','');window.location.href=currURL;}
else{window.location.href=window.location.href;}}}}
function setCookies(values){var postData='values='+values+'&action=setc';if(typeof sid=="undefined"){sid='';}
AjaxRequest("POST","/cookies.php?sid="+sid,postData,onCompleteChangeCookie,onErrorChangeCookie);}
function setCookie(name,value,needToReloadWindow){var postData='name='+name+'&value='+value+'&action=set';if(needToReloadWindow){reloadWindow=true;}
AjaxRequest("POST","/cookies.php?sid="+sid,postData,onCompleteChangeCookie,onErrorChangeCookie);}
function deleteCookie(name,path,domain){var postData='name='+name+'&action=delete';AjaxRequest("POST","/cookies.php?sid="+sid,postData,onCompleteChangeCookie,onErrorChangeCookie);}
function randomize(min,max){var val=min+(Math.random()*(max-min));return Math.round(val);}
function createSearchString(id){var string='';var searchText=$(id).value;var strLen=searchText.length;var field="[A-Za-z0-9~]";var lastchar=false;for(var ii=0;ii<strLen;ii++){if(searchText.charCodeAt(ii)>192){string+=searchText.charAt(ii);lastchar=true;}
else{var tmpStr=searchText.charAt(ii);if(tmpStr.match(field)){string+=tmpStr.toLowerCase();lastchar=true;}
else{if((ii<strLen-1)&&lastchar){string+="_";lastchar=false;}}}}
return string;}
function onImgError(img){var el=$(img);el.getParent().set('html',el.get('alt'));}
String.implement({getRandomId:function(){var r=$random(0,1000)*$random(0,1000);return!$(this+r)?this+r:this.getRandomId();}});var Moobox=new Class({Implements:[Events,Options,Chain],options:{zIndex:10000,showOverlay:false,classes:{overlay:'MbxOverlay',window:'MbxContainer',content:'MbxContent',closer:'MbxCloser',internalCloser:'modalCloser',loading:'MbxLoading',opening:'MbxOpening'},fxDuration:{window:750,overlay:200},size:{initial:{x:80,y:50},_default:{x:600,y:450},padding:{x:16,y:16}}},initialize:function(options){this.setOptions(options);this.isOpen=false;this.loading=false;this.build();},build:function(){this.content=new Element('div',{'class':this.options.classes.content});this.closer=new Element('a',{href:'#','class':this.options.classes.closer,events:{'click':this.close.bindWithEvent(this)}}).set('html','close');this.window=new Element('div',{'class':this.options.classes.window,styles:{'display':'none','z-index':this.options.zIndex+1}}).adopt(this.closer,this.content);this.overlay=new Element('div',{'class':this.options.classes.overlay,styles:{'display':'none','z-index':this.options.zIndex,'background':'#000','position':'absolute','top':'0','left':'0','width':'100%'}}).set('html','&nbsp;');this.tmp=new Element('div',{styles:{'position':'absolute','top':'-1000em','left':'-1000em'}});$(document.body).adopt(this.overlay,this.window,this.tmp);if(Browser.Engine.trident4){var iframe1=new Element('iframe',{styles:{'position':'absolute','width':'104%','height':'110%','top':'-5%','left':'-2%','z-index':'-1'},height:'100%',width:'100%',frameborder:0}).setOpacity(0).injectTop(this.window);if(this.options.showOverlay){var iframe2=new Element('iframe',{styles:{'position':'absolute','width':'120%','height':'120%','top':'-10%','left':'-10%'},height:'100%',width:'100%',frameborder:0}).setOpacity(0).injectTop(this.overlay);}}
this.effects={overlay:new Fx.Tween(this.overlay,{onStart:Events.prototype.clearChain,onComplete:function(){this.overlay.setStyle('height',document.getScrollSize().y+'px');}.bind(this),property:'opacity',duration:this.options.fxDuration.overlay,link:'cancel'}).set(0),window:new Fx.Morph(this.window,{onStart:Events.prototype.clearChain,duration:this.options.fxDuration.window,transition:Fx.Transitions.Quint.easeOut,link:'cancel',unit:'px'}),content:new Fx.Tween(this.content,{onStart:Events.prototype.clearChain,property:'opacity',duration:this.options.fxDuration.overlay,link:'cancel'}).set(0)};},bindOpeners:function(els){this.openers=$splat(els);if(this.openers.length===0){return;}
var _this=this;this.openers.addEvent('click',function(e){var ev=new Event(e);ev.preventDefault();_this.onOpenerClick(this);});},bindClosers:function(){$ES('.'+this.options.classes.internalCloser,this.content).addEvent('click',this.close.bindWithEvent(this));},onOpenerClick:function(el){var url=el.get('href')||false;var title=el.get('title')||'';this.title.set('html',title).setStyle('display','none');if(url){this.getContent(url,title);}},getContent:function(url){var type=url.match(/\.(?:jpg|jpeg|png|gif)$/i)?'image':(url.match(/\.(?:swf)$/i)?'flash':(url.match(/http:\/\//)&&!url.match(document.domain)?'iframe':'ajax'));var f=function(){this.toggleLoading(true);Moobox.preloaders[type].call(this,url);}.bind(this);if(this.isOpen){f();}else{if(this.options.showOverlay&&!this.overlay.retrieve('opacity')){this.chain.apply(this,[this.toggleOverlay(),this.open(),f.delay(this.options.fxDuration.overlay+this.options.fxDuration.window,this)]);}else{this.chain.apply(this,[this.open(),f.delay(this.options.fxDuration.window,this)]);}}},setContent:function(content,s){if(!this.isOpen){return;}
var size=$type(s)!='object'?this.options.size._default:s;this.content.empty().adopt(content);this.position(size);this.bindClosers();this.showContent.delay(this.options.fxDuration.window,this);this.setWindowAutoHeight.delay(this.options.fxDuration.window+100,this);},showContent:function(){this.toggleLoading(false);this.effects.content.start(1);this.fireEvent('onUpdate',[this.window]);},toggleOverlay:function(state){var opacity=state||this.overlay.retrieve('opacity');this.overlay.setStyle('display',opacity?'none':'block');this.effects.overlay.start(opacity?0:0.4);},toggleLoading:function(state){if(state){if(this.currentContent){this.currentContent.setStyle('display','none');}
this.effects.content.set(0);}
this.window.toggleClass(this.options.classes.loading);this.window.removeClass(this.options.classes.opening);this.loading=state;},open:function(){this.loading=true;this.setInitialPosition();this.window.addClass(this.options.classes.opening);this.effects.window.start({opacity:1});this.isOpen=true;this.fireEvent('onOpen',[this.window]);},close:function(ev){if(ev){ev.preventDefault();}
this.resetWindowAutoHeight();var params=$merge({opacity:0},this.getWindowDimentions(this.options.size.initial));this.effects.window.start(params);if(this.options.showOverlay){this.toggleOverlay.delay(this.options.fxDuration.window,this);}
this.content.empty();if(this.request){this.request.cancel();}
this.isOpen=false;this.fireEvent('onClose',[this.window]);},position:function(size){this.effects.window.start(this.getWindowDimentions(size));},getWindowDimentions:function(size){var docSize=document.getSize(),scroll=document.getScroll();var params={left:(scroll.x+(docSize.x-size.x)/2).toInt(),right:(scroll.x-(docSize.x-size.x)/2).toInt(),top:(scroll.y+(docSize.y-size.y)/2).toInt(),height:(size.y).toInt()+this.options.size.padding.y,width:(size.x).toInt()+this.options.size.padding.x};return params;},setInitialPosition:function(){this.window.setStyles($merge({display:'block',opacity:0},this.getWindowDimentions(this.options.size.initial)));},setWindowAutoHeight:function(){var h=parseFloat(this.window.getStyle('height'))+1;this.window.setStyles({height:'auto','min-height':h});},resetWindowAutoHeight:function(){var h=this.window.getStyle('min-height');this.window.setStyles({height:h,'min-height':'1px'});}});Moobox.preloaders=new Hash({image:function(url){var img=new Asset.image(url,{onload:function(){var content=img;var size={x:img.width,y:img.height};this.fireEvent('onLoad',[this.window]);this.setContent(content,size);}.bind(this)});},ajax:function(url){this.request=new Request.HTML({url:url,method:'get',evalScripts:false,headers:{'X-Requested-With':'XMLHttpRequest'},autoCancel:true,onSuccess:function(tree,els,response,scripts){this.tmp.set('html',response);var c=this.tmp.getChildren().length;var content=c>1?new Element('div').set('html',response):this.tmp.getFirst();var size=c>1?this.tmp.getSize():content.getSize();size.x=size.x<this.options.size.initial.x?this.options.size.initial.x:size.x;size.y=size.y<this.options.size.initial.y?this.options.size.initial.y:size.y;this.fireEvent('onLoad',[this.window]);this.setContent(content,size);if(scripts&&scripts!==''){$exec(scripts);}}.bind(this)}).send();},flash:function(url){var id='Swiff'.getRandomId();var div=new Element('div',{id:id,styles:{width:this.options.size._default.x,height:this.options.size._default.y}});this.tmp.empty().adopt(div);var obj=new Swiff(url,{width:this.options.size._default.x,height:this.options.size._default.y,container:id,params:{wmode:'transparent'}});var content=this.tmp.getFirst();var size=this.options.size._default;this.fireEvent('onLoad',[this.window]);this.setContent(content,size);},iframe:function(url){var iframe=new Element('iframe',{src:url,width:this.options.size._default.x,height:this.options.size._default.y,frameborder:0});this.tmp.empty().adopt(iframe);var content=this.tmp.getFirst();var size=this.options.size._default;this.fireEvent('onLoad',[this.window]);this.setContent(content,size);}});