(function(a){a.fn.shortPass="Too short";a.fn.badPass="Weak";a.fn.goodPass="Fair";a.fn.strongPass="Strong";a.fn.samePassword="Username and Password identical.";a.fn.resultStyle="";a.fn.passStrength=function(c){var b={shortPass:"shortPass",badPass:"badPass",goodPass:"goodPass",strongPass:"strongPass",baseStyle:"testresult",userid:"",messageloc:1,bindtocontrol:""};var d=a.extend(b,c);return this.each(function(){var e=a(this);a(e).unbind().keyup(function(){var f=a.fn.teststrength(a(this).val(),a(d.userid).val(),d);if(d.bindtocontrol!=""){a(d.bindtocontrol).html('<span class="'+a(this).resultStyle+'">'+f+"</span>")}else{if(d.messageloc===1){a(this).next("."+d.baseStyle).remove();a(this).after('<span class="'+d.baseStyle+'"><span></span></span>');a(this).next("."+d.baseStyle).addClass(a(this).resultStyle).find("span").text(f)}else{a(this).prev("."+d.baseStyle).remove();a(this).before('<span class="'+d.baseStyle+'"><span></span></span>');a(this).prev("."+d.baseStyle).addClass(a(this).resultStyle).find("span").text(f)}}a(e).blur(function(){if(d.bindtocontrol!=""){a(d.bindtocontrol).html("")}})});a.fn.teststrength=function(g,i,f){var h=0;if(g.length<6){this.resultStyle=f.shortPass;return a(this).shortPass}if(g.toLowerCase()==i.toLowerCase()){this.resultStyle=f.badPass;return a(this).samePassword}h+=g.length*4;h+=(a.fn.checkRepetition(1,g).length-g.length)*1;h+=(a.fn.checkRepetition(2,g).length-g.length)*1;h+=(a.fn.checkRepetition(3,g).length-g.length)*1;h+=(a.fn.checkRepetition(4,g).length-g.length)*1;if(g.match(/(.*[0-9].*[0-9].*[0-9])/)){h+=5}if(g.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/)){h+=5}if(g.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)){h+=10}if(g.match(/([a-zA-Z])/)&&g.match(/([0-9])/)){h+=15}if(g.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&g.match(/([0-9])/)){h+=15}if(g.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&g.match(/([a-zA-Z])/)){h+=15}if(g.match(/^\w+$/)||g.match(/^\d+$/)){h-=10}if(h<0){h=0}if(h>100){h=100}if(h<34){this.resultStyle=f.badPass;return a(this).badPass}if(h<68){this.resultStyle=f.goodPass;return a(this).goodPass}this.resultStyle=f.strongPass;return a(this).strongPass}})}})(jQuery);$j.fn.checkRepetition=function(c,f){var e="";for(var a=0;a<f.length;a++){var d=true;for(var b=0;b<c&&(b+a+c)<f.length;b++){d=d&&(f.charAt(b+a)==f.charAt(b+a+c))}if(b<c){d=false}if(d){a+=c-1;d=false}else{e+=f.charAt(a)}}return e};