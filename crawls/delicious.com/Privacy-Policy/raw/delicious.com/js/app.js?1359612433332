
(function(global){var b64chars='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';var b64charcodes=function(){var a=[];var codeA='A'.charCodeAt(0);var codea='a'.charCodeAt(0);var code0='0'.charCodeAt(0);for(var i=0;i<26;i++)a.push(codeA+i);for(var i=0;i<26;i++)a.push(codea+i);for(var i=0;i<10;i++)a.push(code0+i);a.push('+'.charCodeAt(0));a.push('/'.charCodeAt(0));return a;}();var b64tab=function(bin){var t={};for(var i=0,l=bin.length;i<l;i++)t[bin.charAt(i)]=i;return t;}(b64chars);var stringToArray=function(s){var a=[];for(var i=0,l=s.length;i<l;i++)a[i]=s.charCodeAt(i);return a;};var convertUTF8ArrayToBase64=function(bin){var padlen=0;while(bin.length%3){bin.push(0);padlen++;};var b64=[];for(var i=0,l=bin.length;i<l;i+=3){var c0=bin[i],c1=bin[i+1],c2=bin[i+2];if(c0>=256||c1>=256||c2>=256)
throw'unsupported character found';var n=(c0<<16)|(c1<<8)|c2;b64.push(b64charcodes[n>>>18],b64charcodes[(n>>>12)&63],b64charcodes[(n>>>6)&63],b64charcodes[n&63]);}
while(padlen--)b64[b64.length-padlen-1]='='.charCodeAt(0);return chunkStringFromCharCodeApply(b64);};var convertBase64ToUTF8Array=function(b64){b64=b64.replace(/[^A-Za-z0-9+\/]+/g,'');var bin=[];var padlen=b64.length%4;for(var i=0,l=b64.length;i<l;i+=4){var n=((b64tab[b64.charAt(i)]||0)<<18)|((b64tab[b64.charAt(i+1)]||0)<<12)|((b64tab[b64.charAt(i+2)]||0)<<6)|((b64tab[b64.charAt(i+3)]||0));bin.push((n>>16),((n>>8)&0xff),(n&0xff));}
bin.length-=[0,0,2,1][padlen];return bin;};var convertUTF16ArrayToUTF8Array=function(uni){var bin=[];for(var i=0,l=uni.length;i<l;i++){var n=uni[i];if(n<0x80)
bin.push(n);else if(n<0x800)
bin.push(0xc0|(n>>>6),0x80|(n&0x3f));else
bin.push(0xe0|((n>>>12)&0x0f),0x80|((n>>>6)&0x3f),0x80|(n&0x3f));}
return bin;};var convertUTF8ArrayToUTF16Array=function(bin){var uni=[];for(var i=0,l=bin.length;i<l;i++){var c0=bin[i];if(c0<0x80){uni.push(c0);}else{var c1=bin[++i];if(c0<0xe0){uni.push(((c0&0x1f)<<6)|(c1&0x3f));}else{var c2=bin[++i];uni.push(((c0&0x0f)<<12)|((c1&0x3f)<<6)|(c2&0x3f));}}}
return uni;};var convertUTF8StringToBase64=function(bin){return convertUTF8ArrayToBase64(stringToArray(bin));};var convertBase64ToUTF8String=function(b64){return chunkStringFromCharCodeApply(convertBase64ToUTF8Array(b64));};var convertUTF8StringToUTF16Array=function(bin){return convertUTF8ArrayToUTF16Array(stringToArray(bin));};var convertUTF8ArrayToUTF16String=function(bin){return chunkStringFromCharCodeApply(convertUTF8ArrayToUTF16Array(bin));};var convertUTF8StringToUTF16String=function(bin){return chunkStringFromCharCodeApply(convertUTF8ArrayToUTF16Array(stringToArray(bin)));};var convertUTF16StringToUTF8Array=function(uni){return convertUTF16ArrayToUTF8Array(stringToArray(uni));};var convertUTF16ArrayToUTF8String=function(uni){return chunkStringFromCharCodeApply(convertUTF16ArrayToUTF8Array(uni));};var convertUTF16StringToUTF8String=function(uni){return chunkStringFromCharCodeApply(convertUTF16ArrayToUTF8Array(stringToArray(uni)));};var chunkStringFromCharCodeApply=function(arr){var strs=[],i;for(i=0;i<arr.length;i+=65536){strs.push(String.fromCharCode.apply(String,arr.slice(i,i+65536)));}
return strs.join('');};if(global.btoa){var btoa=global.btoa;var convertUTF16StringToBase64=function(uni){return btoa(convertUTF16StringToUTF8String(uni));};}
else{var btoa=convertUTF8StringToBase64;var convertUTF16StringToBase64=function(uni){return convertUTF8ArrayToBase64(convertUTF16StringToUTF8Array(uni));};}
if(global.atob){var atob=global.atob;var convertBase64ToUTF16String=function(b64){return convertUTF8StringToUTF16String(atob(b64));};}
else{var atob=convertBase64ToUTF8String;var convertBase64ToUTF16String=function(b64){return convertUTF8ArrayToUTF16String(convertBase64ToUTF8Array(b64));};}
global.Base64={convertUTF8ArrayToBase64:convertUTF8ArrayToBase64,convertByteArrayToBase64:convertUTF8ArrayToBase64,convertBase64ToUTF8Array:convertBase64ToUTF8Array,convertBase64ToByteArray:convertBase64ToUTF8Array,convertUTF16ArrayToUTF8Array:convertUTF16ArrayToUTF8Array,convertUTF16ArrayToByteArray:convertUTF16ArrayToUTF8Array,convertUTF8ArrayToUTF16Array:convertUTF8ArrayToUTF16Array,convertByteArrayToUTF16Array:convertUTF8ArrayToUTF16Array,convertUTF8StringToBase64:convertUTF8StringToBase64,convertBase64ToUTF8String:convertBase64ToUTF8String,convertUTF8StringToUTF16Array:convertUTF8StringToUTF16Array,convertUTF8ArrayToUTF16String:convertUTF8ArrayToUTF16String,convertByteArrayToUTF16String:convertUTF8ArrayToUTF16String,convertUTF8StringToUTF16String:convertUTF8StringToUTF16String,convertUTF16StringToUTF8Array:convertUTF16StringToUTF8Array,convertUTF16StringToByteArray:convertUTF16StringToUTF8Array,convertUTF16ArrayToUTF8String:convertUTF16ArrayToUTF8String,convertUTF16StringToUTF8String:convertUTF16StringToUTF8String,convertUTF16StringToBase64:convertUTF16StringToBase64,convertBase64ToUTF16String:convertBase64ToUTF16String,fromBase64:convertBase64ToUTF8String,toBase64:convertUTF8StringToBase64,atob:atob,btoa:btoa,utob:convertUTF16StringToUTF8String,btou:convertUTF8StringToUTF16String,encode:convertUTF16StringToBase64,encodeURI:function(u){return convertUTF16StringToBase64(u).replace(/[+\/]/g,function(m0){return m0=='+'?'-':'_';}).replace(/=+$/,'');},decode:function(a){return convertBase64ToUTF16String(a.replace(/[-_]/g,function(m0){return m0=='-'?'+':'/';}));}};})(this);
(function($,document,undefined){var pluses=/\+/g;function raw(s){return s;}
function decoded(s){return decodeURIComponent(s.replace(pluses,' '));}
var config=$.cookie=function(key,value,options){if(value!==undefined){options=$.extend({},config.defaults,options);if(value===null){options.expires=-1;}
if(typeof options.expires==='number'){var days=options.expires,t=options.expires=new Date();t.setDate(t.getDate()+days);}
value=config.json?JSON.stringify(value):String(value);return(document.cookie=[encodeURIComponent(key),'=',config.raw?value:encodeURIComponent(value),options.expires?'; expires='+options.expires.toUTCString():'',options.path?'; path='+options.path:'',options.domain?'; domain='+options.domain:'',options.secure?'; secure':''].join(''));}
var decode=config.raw?raw:decoded;var cookies=document.cookie.split('; ');for(var i=0,l=cookies.length;i<l;i++){var parts=cookies[i].split('=');if(decode(parts.shift())===key){var cookie=decode(parts.join('='));return config.json?JSON.parse(cookie):cookie;}}
return null;};config.defaults={};$.removeCookie=function(key,options){if($.cookie(key)!==null){$.cookie(key,null,options);return true;}
return false;};})(jQuery,document);;(function($){"use strict";var feature={};feature.fileapi=$("<input type='file'/>").get(0).files!==undefined;feature.formdata=window.FormData!==undefined;$.fn.ajaxSubmit=function(options){if(!this.length){log('ajaxSubmit: skipping submit process - no element selected');return this;}
var method,action,url,$form=this;if(typeof options=='function'){options={success:options};}
method=this.attr('method');action=this.attr('action');url=(typeof action==='string')?$.trim(action):'';url=url||window.location.href||'';if(url){url=(url.match(/^([^#]+)/)||[])[1];}
options=$.extend(true,{url:url,success:$.ajaxSettings.success,type:method||'GET',iframeSrc:/^https/i.test(window.location.href||'')?'javascript:false':'about:blank'},options);var veto={};this.trigger('form-pre-serialize',[this,options,veto]);if(veto.veto){log('ajaxSubmit: submit vetoed via form-pre-serialize trigger');return this;}
if(options.beforeSerialize&&options.beforeSerialize(this,options)===false){log('ajaxSubmit: submit aborted via beforeSerialize callback');return this;}
var traditional=options.traditional;if(traditional===undefined){traditional=$.ajaxSettings.traditional;}
var elements=[];var qx,a=this.formToArray(options.semantic,elements);if(options.data){options.extraData=options.data;qx=$.param(options.data,traditional);}
if(options.beforeSubmit&&options.beforeSubmit(a,this,options)===false){log('ajaxSubmit: submit aborted via beforeSubmit callback');return this;}
this.trigger('form-submit-validate',[a,this,options,veto]);if(veto.veto){log('ajaxSubmit: submit vetoed via form-submit-validate trigger');return this;}
var q=$.param(a,traditional);if(qx){q=(q?(q+'&'+qx):qx);}
if(options.type.toUpperCase()=='GET'){options.url+=(options.url.indexOf('?')>=0?'&':'?')+q;options.data=null;}
else{options.data=q;}
var callbacks=[];if(options.resetForm){callbacks.push(function(){$form.resetForm();});}
if(options.clearForm){callbacks.push(function(){$form.clearForm(options.includeHidden);});}
if(!options.dataType&&options.target){var oldSuccess=options.success||function(){};callbacks.push(function(data){var fn=options.replaceTarget?'replaceWith':'html';$(options.target)[fn](data).each(oldSuccess,arguments);});}
else if(options.success){callbacks.push(options.success);}
options.success=function(data,status,xhr){var context=options.context||this;for(var i=0,max=callbacks.length;i<max;i++){callbacks[i].apply(context,[data,status,xhr||$form,$form]);}};var fileInputs=$('input[type=file]:enabled[value!=""]',this);var hasFileInputs=fileInputs.length>0;var mp='multipart/form-data';var multipart=($form.attr('enctype')==mp||$form.attr('encoding')==mp);var fileAPI=feature.fileapi&&feature.formdata;log("fileAPI :"+fileAPI);var shouldUseFrame=(hasFileInputs||multipart)&&!fileAPI;var jqxhr;if(options.iframe!==false&&(options.iframe||shouldUseFrame)){if(options.closeKeepAlive){$.get(options.closeKeepAlive,function(){jqxhr=fileUploadIframe(a);});}
else{jqxhr=fileUploadIframe(a);}}
else if((hasFileInputs||multipart)&&fileAPI){jqxhr=fileUploadXhr(a);}
else{jqxhr=$.ajax(options);}
$form.removeData('jqxhr').data('jqxhr',jqxhr);for(var k=0;k<elements.length;k++)
elements[k]=null;this.trigger('form-submit-notify',[this,options]);return this;function deepSerialize(extraData){var serialized=$.param(extraData).split('&');var len=serialized.length;var result={};var i,part;for(i=0;i<len;i++){serialized[i]=serialized[i].replace(/\+/g,' ');part=serialized[i].split('=');result[decodeURIComponent(part[0])]=decodeURIComponent(part[1]);}
return result;}
function fileUploadXhr(a){var formdata=new FormData();for(var i=0;i<a.length;i++){formdata.append(a[i].name,a[i].value);}
if(options.extraData){var serializedData=deepSerialize(options.extraData);for(var p in serializedData)
if(serializedData.hasOwnProperty(p))
formdata.append(p,serializedData[p]);}
options.data=null;var s=$.extend(true,{},$.ajaxSettings,options,{contentType:false,processData:false,cache:false,type:method||'POST'});if(options.uploadProgress){s.xhr=function(){var xhr=jQuery.ajaxSettings.xhr();if(xhr.upload){xhr.upload.onprogress=function(event){var percent=0;var position=event.loaded||event.position;var total=event.total;if(event.lengthComputable){percent=Math.ceil(position/total*100);}
options.uploadProgress(event,position,total,percent);};}
return xhr;};}
s.data=null;var beforeSend=s.beforeSend;s.beforeSend=function(xhr,o){o.data=formdata;if(beforeSend)
beforeSend.call(this,xhr,o);};return $.ajax(s);}
function fileUploadIframe(a){var form=$form[0],el,i,s,g,id,$io,io,xhr,sub,n,timedOut,timeoutHandle;var useProp=!!$.fn.prop;var deferred=$.Deferred();if($('[name=submit],[id=submit]',form).length){alert('Error: Form elements must not have name or id of "submit".');deferred.reject();return deferred;}
if(a){for(i=0;i<elements.length;i++){el=$(elements[i]);if(useProp)
el.prop('disabled',false);else
el.removeAttr('disabled');}}
s=$.extend(true,{},$.ajaxSettings,options);s.context=s.context||s;id='jqFormIO'+(new Date().getTime());if(s.iframeTarget){$io=$(s.iframeTarget);n=$io.attr('name');if(!n)
$io.attr('name',id);else
id=n;}
else{$io=$('<iframe name="'+id+'" src="'+s.iframeSrc+'" />');$io.css({position:'absolute',top:'-1000px',left:'-1000px'});}
io=$io[0];xhr={aborted:0,responseText:null,responseXML:null,status:0,statusText:'n/a',getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(status){var e=(status==='timeout'?'timeout':'aborted');log('aborting upload... '+e);this.aborted=1;try{if(io.contentWindow.document.execCommand){io.contentWindow.document.execCommand('Stop');}}
catch(ignore){}
$io.attr('src',s.iframeSrc);xhr.error=e;if(s.error)
s.error.call(s.context,xhr,e,status);if(g)
$.event.trigger("ajaxError",[xhr,s,e]);if(s.complete)
s.complete.call(s.context,xhr,e);}};g=s.global;if(g&&0===$.active++){$.event.trigger("ajaxStart");}
if(g){$.event.trigger("ajaxSend",[xhr,s]);}
if(s.beforeSend&&s.beforeSend.call(s.context,xhr,s)===false){if(s.global){$.active--;}
deferred.reject();return deferred;}
if(xhr.aborted){deferred.reject();return deferred;}
sub=form.clk;if(sub){n=sub.name;if(n&&!sub.disabled){s.extraData=s.extraData||{};s.extraData[n]=sub.value;if(sub.type=="image"){s.extraData[n+'.x']=form.clk_x;s.extraData[n+'.y']=form.clk_y;}}}
var CLIENT_TIMEOUT_ABORT=1;var SERVER_ABORT=2;function getDoc(frame){var doc=frame.contentWindow?frame.contentWindow.document:frame.contentDocument?frame.contentDocument:frame.document;return doc;}
var csrf_token=$('meta[name=csrf-token]').attr('content');var csrf_param=$('meta[name=csrf-param]').attr('content');if(csrf_param&&csrf_token){s.extraData=s.extraData||{};s.extraData[csrf_param]=csrf_token;}
function doSubmit(){var t=$form.attr('target'),a=$form.attr('action');form.setAttribute('target',id);if(!method){form.setAttribute('method','POST');}
if(a!=s.url){form.setAttribute('action',s.url);}
if(!s.skipEncodingOverride&&(!method||/post/i.test(method))){$form.attr({encoding:'multipart/form-data',enctype:'multipart/form-data'});}
if(s.timeout){timeoutHandle=setTimeout(function(){timedOut=true;cb(CLIENT_TIMEOUT_ABORT);},s.timeout);}
function checkState(){try{var state=getDoc(io).readyState;log('state = '+state);if(state&&state.toLowerCase()=='uninitialized')
setTimeout(checkState,50);}
catch(e){log('Server abort: ',e,' (',e.name,')');cb(SERVER_ABORT);if(timeoutHandle)
clearTimeout(timeoutHandle);timeoutHandle=undefined;}}
var extraInputs=[];try{if(s.extraData){for(var n in s.extraData){if(s.extraData.hasOwnProperty(n)){if($.isPlainObject(s.extraData[n])&&s.extraData[n].hasOwnProperty('name')&&s.extraData[n].hasOwnProperty('value')){extraInputs.push($('<input type="hidden" name="'+s.extraData[n].name+'">').val(s.extraData[n].value).appendTo(form)[0]);}else{extraInputs.push($('<input type="hidden" name="'+n+'">').val(s.extraData[n]).appendTo(form)[0]);}}}}
if(!s.iframeTarget){$io.appendTo('body');if(io.attachEvent)
io.attachEvent('onload',cb);else
io.addEventListener('load',cb,false);}
setTimeout(checkState,15);form.submit();}
finally{form.setAttribute('action',a);if(t){form.setAttribute('target',t);}else{$form.removeAttr('target');}
$(extraInputs).remove();}}
if(s.forceSync){doSubmit();}
else{setTimeout(doSubmit,10);}
var data,doc,domCheckCount=50,callbackProcessed;function cb(e){if(xhr.aborted||callbackProcessed){return;}
try{doc=getDoc(io);}
catch(ex){log('cannot access response document: ',ex);e=SERVER_ABORT;}
if(e===CLIENT_TIMEOUT_ABORT&&xhr){xhr.abort('timeout');deferred.reject(xhr,'timeout');return;}
else if(e==SERVER_ABORT&&xhr){xhr.abort('server abort');deferred.reject(xhr,'error','server abort');return;}
if(!doc||doc.location.href==s.iframeSrc){if(!timedOut)
return;}
if(io.detachEvent)
io.detachEvent('onload',cb);else
io.removeEventListener('load',cb,false);var status='success',errMsg;try{if(timedOut){throw'timeout';}
var isXml=s.dataType=='xml'||doc.XMLDocument||$.isXMLDoc(doc);log('isXml='+isXml);if(!isXml&&window.opera&&(doc.body===null||!doc.body.innerHTML)){if(--domCheckCount){log('requeing onLoad callback, DOM not available');setTimeout(cb,250);return;}}
var docRoot=doc.body?doc.body:doc.documentElement;xhr.responseText=docRoot?docRoot.innerHTML:null;xhr.responseXML=doc.XMLDocument?doc.XMLDocument:doc;if(isXml)
s.dataType='xml';xhr.getResponseHeader=function(header){var headers={'content-type':s.dataType};return headers[header];};if(docRoot){xhr.status=Number(docRoot.getAttribute('status'))||xhr.status;xhr.statusText=docRoot.getAttribute('statusText')||xhr.statusText;}
var dt=(s.dataType||'').toLowerCase();var scr=/(json|script|text)/.test(dt);if(scr||s.textarea){var ta=doc.getElementsByTagName('textarea')[0];if(ta){xhr.responseText=ta.value;xhr.status=Number(ta.getAttribute('status'))||xhr.status;xhr.statusText=ta.getAttribute('statusText')||xhr.statusText;}
else if(scr){var pre=doc.getElementsByTagName('pre')[0];var b=doc.getElementsByTagName('body')[0];if(pre){xhr.responseText=pre.textContent?pre.textContent:pre.innerText;}
else if(b){xhr.responseText=b.textContent?b.textContent:b.innerText;}}}
else if(dt=='xml'&&!xhr.responseXML&&xhr.responseText){xhr.responseXML=toXml(xhr.responseText);}
try{data=httpData(xhr,dt,s);}
catch(e){status='parsererror';xhr.error=errMsg=(e||status);}}
catch(e){log('error caught: ',e);status='error';xhr.error=errMsg=(e||status);}
if(xhr.aborted){log('upload aborted');status=null;}
if(xhr.status){status=(xhr.status>=200&&xhr.status<300||xhr.status===304)?'success':'error';}
if(status==='success'){if(s.success)
s.success.call(s.context,data,'success',xhr);deferred.resolve(xhr.responseText,'success',xhr);if(g)
$.event.trigger("ajaxSuccess",[xhr,s]);}
else if(status){if(errMsg===undefined)
errMsg=xhr.statusText;if(s.error)
s.error.call(s.context,xhr,status,errMsg);deferred.reject(xhr,'error',errMsg);if(g)
$.event.trigger("ajaxError",[xhr,s,errMsg]);}
if(g)
$.event.trigger("ajaxComplete",[xhr,s]);if(g&&!--$.active){$.event.trigger("ajaxStop");}
if(s.complete)
s.complete.call(s.context,xhr,status);callbackProcessed=true;if(s.timeout)
clearTimeout(timeoutHandle);setTimeout(function(){if(!s.iframeTarget)
$io.remove();xhr.responseXML=null;},100);}
var toXml=$.parseXML||function(s,doc){if(window.ActiveXObject){doc=new ActiveXObject('Microsoft.XMLDOM');doc.async='false';doc.loadXML(s);}
else{doc=(new DOMParser()).parseFromString(s,'text/xml');}
return(doc&&doc.documentElement&&doc.documentElement.nodeName!='parsererror')?doc:null;};var parseJSON=$.parseJSON||function(s){return window['eval']('('+s+')');};var httpData=function(xhr,type,s){var ct=xhr.getResponseHeader('content-type')||'',xml=type==='xml'||!type&&ct.indexOf('xml')>=0,data=xml?xhr.responseXML:xhr.responseText;if(xml&&data.documentElement.nodeName==='parsererror'){if($.error)
$.error('parsererror');}
if(s&&s.dataFilter){data=s.dataFilter(data,type);}
if(typeof data==='string'){if(type==='json'||!type&&ct.indexOf('json')>=0){data=parseJSON(data);}else if(type==="script"||!type&&ct.indexOf("javascript")>=0){$.globalEval(data);}}
return data;};return deferred;}};$.fn.formToArray=function(semantic,elements){var a=[];if(this.length===0){return a;}
var form=this[0];var els=semantic?form.getElementsByTagName('*'):form.elements;if(!els){return a;}
var i,j,n,v,el,max,jmax;for(i=0,max=els.length;i<max;i++){el=els[i];n=el.name;if(!n){continue;}
if(semantic&&form.clk&&el.type=="image"){if(!el.disabled&&form.clk==el){a.push({name:n,value:$(el).val(),type:el.type});a.push({name:n+'.x',value:form.clk_x},{name:n+'.y',value:form.clk_y});}
continue;}
v=$.fieldValue(el,true);if(v&&v.constructor==Array){if(elements)
elements.push(el);for(j=0,jmax=v.length;j<jmax;j++){a.push({name:n,value:v[j]});}}
else if(feature.fileapi&&el.type=='file'&&!el.disabled){if(elements)
elements.push(el);var files=el.files;if(files.length){for(j=0;j<files.length;j++){a.push({name:n,value:files[j],type:el.type});}}
else{a.push({name:n,value:'',type:el.type});}}
else if(v!==null&&typeof v!='undefined'){if(elements)
elements.push(el);a.push({name:n,value:v,type:el.type,required:el.required});}}
if(!semantic&&form.clk){var $input=$(form.clk),input=$input[0];n=input.name;if(n&&!input.disabled&&input.type=='image'){a.push({name:n,value:$input.val()});a.push({name:n+'.x',value:form.clk_x},{name:n+'.y',value:form.clk_y});}}
return a;};$.fn.formSerialize=function(semantic){return $.param(this.formToArray(semantic));};$.fn.fieldSerialize=function(successful){var a=[];this.each(function(){var n=this.name;if(!n){return;}
var v=$.fieldValue(this,successful);if(v&&v.constructor==Array){for(var i=0,max=v.length;i<max;i++){a.push({name:n,value:v[i]});}}
else if(v!==null&&typeof v!='undefined'){a.push({name:this.name,value:v});}});return $.param(a);};$.fn.fieldValue=function(successful){for(var val=[],i=0,max=this.length;i<max;i++){var el=this[i];var v=$.fieldValue(el,successful);if(v===null||typeof v=='undefined'||(v.constructor==Array&&!v.length)){continue;}
if(v.constructor==Array)
$.merge(val,v);else
val.push(v);}
return val;};$.fieldValue=function(el,successful){var n=el.name,t=el.type,tag=el.tagName.toLowerCase();if(successful===undefined){successful=true;}
if(successful&&(!n||el.disabled||t=='reset'||t=='button'||(t=='checkbox'||t=='radio')&&!el.checked||(t=='submit'||t=='image')&&el.form&&el.form.clk!=el||tag=='select'&&el.selectedIndex==-1)){return null;}
if(tag=='select'){var index=el.selectedIndex;if(index<0){return null;}
var a=[],ops=el.options;var one=(t=='select-one');var max=(one?index+1:ops.length);for(var i=(one?index:0);i<max;i++){var op=ops[i];if(op.selected){var v=op.value;if(!v){v=(op.attributes&&op.attributes['value']&&!(op.attributes['value'].specified))?op.text:op.value;}
if(one){return v;}
a.push(v);}}
return a;}
return $(el).val();};$.fn.clearForm=function(includeHidden){return this.each(function(){$('input,select,textarea',this).clearFields(includeHidden);});};$.fn.clearFields=$.fn.clearInputs=function(includeHidden){var re=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var t=this.type,tag=this.tagName.toLowerCase();if(re.test(t)||tag=='textarea'){this.value='';}
else if(t=='checkbox'||t=='radio'){this.checked=false;}
else if(tag=='select'){this.selectedIndex=-1;}
else if(t=="file"){if($.browser.msie){$(this).replaceWith($(this).clone());}else{$(this).val('');}}
else if(includeHidden){if((includeHidden===true&&/hidden/.test(t))||(typeof includeHidden=='string'&&$(this).is(includeHidden)))
this.value='';}});};$.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=='function'||(typeof this.reset=='object'&&!this.reset.nodeType)){this.reset();}});};$.fn.enable=function(b){if(b===undefined){b=true;}
return this.each(function(){this.disabled=!b;});};$.fn.selected=function(select){if(select===undefined){select=true;}
return this.each(function(){var t=this.type;if(t=='checkbox'||t=='radio'){this.checked=select;}
else if(this.tagName.toLowerCase()=='option'){var $sel=$(this).parent('select');if(select&&$sel[0]&&$sel[0].type=='select-one'){$sel.find('option').selected(false);}
this.selected=select;}});};$.fn.ajaxSubmit.debug=false;function log(){if(!$.fn.ajaxSubmit.debug)
return;var msg='[jquery.form] '+Array.prototype.join.call(arguments,'');if(window.console&&window.console.log){window.console.log(msg);}
else if(window.opera&&window.opera.postError){window.opera.postError(msg);}}})(jQuery);
(function($){var
keyBreaker=/[^\[\]]+/g,convertValue=function(value){if($.isNumeric(value)){return parseFloat(value);}else if(value==='true'){return true;}else if(value==='false'){return false;}else if(value===''){return undefined;}
return value;},nestData=function(elem,type,data,parts,value,seen,fullName){var name=parts.shift();fullName=fullName?fullName+'.'+name:name;if(parts.length){if(!data[name]){data[name]={};}
nestData(elem,type,data[name],parts,value,seen,fullName);}else{if(fullName in seen&&type!="radio"&&!$.isArray(data[name])){if(name in data){data[name]=[data[name]];}else{data[name]=[];}}else{seen[fullName]=true;}
if((type=="radio"||type=="checkbox")&&!elem.is(":checked")){return}
if(!data[name]){data[name]=value;}else{data[name].push(value);}}};$.fn.extend({formParams:function(params){var convert;if(!!params===params){convert=params;params=null;}
if(params){return this.setParams(params);}else{return this.getParams(convert);}},setParams:function(params){this.find("[name]").each(function(){var value=params[$(this).attr("name")],$this;if(value!==undefined){$this=$(this);if($this.is(":radio")){if($this.val()==value){$this.attr("checked",true);}}else if($this.is(":checkbox")){value=$.isArray(value)?value:[value];if($.inArray($this.val(),value)>-1){$this.attr("checked",true);}}else{$this.val(value);}}});},getParams:function(convert){var data={},seen={},current;this.find("[name]:not(:disabled)").each(function(){var $this=$(this),type=$this.attr("type"),name=$this.attr("name"),value=$this.val(),parts;if(type=="submit"||!name){return;}
parts=name.match(keyBreaker);if(!parts.length){parts=[name];}
if(convert){value=convertValue(value);}
nestData($this,type,data,parts,value,seen);});return data;}});})(jQuery);(function($){var defaults={verticalOffset:10,horizontalOffset:10,title:false,content:false,url:false,classes:'',position:'auto',fadeSpeed:160,trigger:'click',preventDefault:true,stopChildrenPropagation:true,hideOnHTMLClick:true,animateChange:true,autoReposition:true,anchor:false}
var popovers=[];var _={calc_position:function(popover,position){var data=popover.popover("getData");var options=data.options;var $anchor=options.anchor?$(options.anchor):popover;var el=data.popover;var coordinates=$anchor.offset();var y1,x1;if(position=='top'){y1=coordinates.top-el.outerHeight();x1=coordinates.left-el.outerWidth()/2+$anchor.outerWidth()/2;}else if(position=='right'){y1=coordinates.top+$anchor.outerHeight()/2-el.outerHeight()/2;x1=coordinates.left+$anchor.outerWidth();}else if(position=='left'){y1=coordinates.top+$anchor.outerHeight()/2-el.outerHeight()/2;x1=coordinates.left-el.outerWidth();}else{y1=coordinates.top+$anchor.outerHeight();x1=coordinates.left-el.outerWidth()/2+$anchor.outerWidth()/2;}
x2=x1+el.outerWidth();y2=y1+el.outerHeight();ret={x1:x1,x2:x2,y1:y1,y2:y2};return ret;},pop_position_class:function(popover,position){var remove="popover-top popover-right popover-left";var arrow="top-arrow"
var arrow_remove="right-arrow bottom-arrow left-arrow";if(position=='top'){remove="popover-right popover-bottom popover-left";arrow='bottom-arrow';arrow_remove="top-arrow right-arrow left-arrow";}else if(position=='right'){remove="popover-yop popover-bottom popover-left";arrow='left-arrow';arrow_remove="top-arrow right-arrow bottom-arrow";}else if(position=='left'){remove="popover-top popover-right popover-bottom";arrow='right-arrow';arrow_remove="top-arrow bottom-arrow left-arrow";}
popover.removeClass(remove).addClass('popover-'+position).find('.arrow').removeClass(arrow_remove).addClass(arrow);}};var methods={init:function(params){return this.each(function(){var options=$.extend({},defaults,params);var $this=$(this);var data=$this.popover('getData');if(!data){var popover=$('<div class="popover" />').addClass(options.classes).append('<div class="arrow" />').append('<div class="wrap"></div>').appendTo('body').hide();if(options.stopChildrenPropagation)
popover.children().bind('click.popover',function(event){event.stopPropagation();});$this.bind('click.popover',function(event){if(options.preventDefault)
event.preventDefault();event.stopPropagation();});if(options.anchor)
if(!options.anchor instanceof jQuery)
options.anchor=$(options.anchor)
var data={target:$this,popover:popover,options:options};if(options.title)
$('<div class="title" />').html(options.title instanceof jQuery?options.title.html():options.title).appendTo(popover.find('.wrap'));if(options.content)
$('<div class="content" />').html(options.content instanceof jQuery?options.content.html():options.content).appendTo(popover.find('.wrap'));$this.data('popover',data);popovers.push($this);if(options.url)
$this.popover('ajax',options.url);$this.popover('reposition');$this.popover('setTrigger',options.trigger);if(options.hideOnHTMLClick){var hideEvent="click.popover";if("ontouchstart"in document.documentElement)
hideEvent='touchstart.popover';$('html').unbind(hideEvent).bind(hideEvent,function(event){$('html').popover('fadeOutAll');});}
if(options.autoReposition){var repos_function=function(event){$this.popover('reposition');};$(window).unbind('resize.popover').bind('resize.popover',repos_function).unbind('scroll.popover').bind('scroll.popover',repos_function);}}});},reposition:function(){return this.each(function(){var $this=$(this);var data=$this.popover('getData');if(data){var popover=data.popover;var options=data.options;var $anchor=options.anchor?$(options.anchor):$this;var coordinates=$anchor.offset();var position=options.position;if(!(position=='top'||position=='right'||position=='left'||position=='auto'))
position='bottom';var calc;if(position=='auto'){var positions=["bottom","left","top","right"];var scrollTop=$(window).scrollTop();var scrollLeft=$(window).scrollLeft();var windowHeight=$(window).outerHeight();var windowWidth=$(window).outerWidth();$.each(positions,function(i,pos){calc=_.calc_position($this,pos);var x1=calc.x1-scrollLeft;var x2=calc.x2-scrollLeft+options.horizontalOffset;var y1=calc.y1-scrollTop;var y2=calc.y2-scrollTop+options.verticalOffset;if(x1<0||x2<0||y1<0||y2<0)
return true;if(y2>windowHeight)
return true;if(x2>windowWidth)
return true;position=pos;return false;});if(position=='auto')
return;}
calc=_.calc_position($this,position);var top=calc.top;var left=calc.left;_.pop_position_class(popover,position);var marginTop=0;var marginLeft=0;if(position=='bottom')
marginTop=options.verticalOffset;if(position=='top')
marginTop=-options.verticalOffset;if(position=='right')
marginLeft=options.horizontalOffset;if(position=='left')
marginLeft=-options.horizontalOffset;var css={left:calc.x1,top:calc.y1,marginTop:marginTop,marginLeft:marginLeft};if(data.initd&&options.animateChange)
popover.css(css);else{data.initd=true;popover.css(css);}
$this.data('popover',data);}});},destroy:function(){return this.each(function(){var $this=$(this);var data=$this.popover('getData');$this.unbind('.popover');$(window).unbind('.popover');data.popover.remove();$this.removeData('popover');});},show:function(){return this.each(function(){var $this=$(this);var data=$this.popover('getData');if(data){var popover=data.popover;$this.popover('reposition');popover.clearQueue().css({zIndex:950}).show();$this.trigger('show.popover',popover);}});},hide:function(){return this.each(function(){var $this=$(this);var data=$this.popover('getData');if(data)
data.popover.hide().css({zIndex:949});});},fadeOut:function(ms){return this.each(function(){var $this=$(this);var data=$this.popover('getData');if(data){var popover=data.popover;var options=data.options;popover.delay(100).css({zIndex:949}).fadeOut(ms?ms:options.fadeSpeed);}});},hideAll:function(){return $.each(popovers,function(i,pop){var $this=$(this);var data=$this.popover('getData');if(data){var popover=data.popover;popover.hide();}});},fadeOutAll:function(ms){return $.each(popovers,function(i,pop){var $this=$(this);var data=$this.popover('getData');if(data){var popover=data.popover;var options=data.options;popover.css({zIndex:949}).fadeOut(ms?ms:options.fadeSpeed);}});},setTrigger:function(trigger){return this.each(function(){var $this=$(this);var data=$this.popover('getData');if(data){var popover=data.popover;var options=data.options;var $anchor=options.anchor?$(options.anchor):$this;if(trigger==='click'){$anchor.unbind('click').bind('click',function(event){event.preventDefault();event.stopPropagation();$this.popover('show');});popover.unbind('click.popover').bind('click.popover',function(event){event.stopPropagation();});}else{$anchor.unbind('click');popover.unbind('click.popover')}
if(trigger==='hover'){$anchor.add(popover).bind('mousemove.popover',function(event){$this.popover('show');});$anchor.add(popover).bind('mouseleave.popover',function(event){$this.popover('fadeOut');});}else{$anchor.add(popover).unbind('mousemove.popover').unbind('mouseleave.popover');}
if(trigger==='focus'){$anchor.add(popover).bind('focus.popover',function(event){$this.popover('show');});$anchor.add(popover).bind('blur.popover',function(event){$this.popover('fadeOut');});$anchor.bind('click.popover',function(event){event.stopPropagation();})}else{$anchor.add(popover).unbind('focus.popover').unbind('blur.popover').unbind('click.popover');}}});},title:function(text){return this.each(function(){var $this=$(this);var data=$this.popover('getData');if(data){var title=data.popover.find('.title');var wrap=data.popover.find('.wrap');if(title.length===0)
title=$('<div class="title" />').appendTo(wrap);title.html(text);}});},content:function(html){return this.each(function(){var $this=$(this);var data=$this.popover('getData');if(data){var content=data.popover.find('.content');var wrap=data.popover.find('.wrap');if(content.length===0)
content=$('<div class="content" />').appendTo(wrap);content.html(html);}});},ajax:function(url,ajax_params){return this.each(function(){var $this=$(this);var data=$this.popover('getData');if(data){var ajax_defaults={url:url,success:function(ajax_data){var content=data.popover.find('.content');var wrap=data.popover.find('.wrap');if(content.length===0)
content=$('<div class="content" />').appendTo(wrap);content.html(ajax_data);}}
var ajax_options=$.extend({},ajax_defaults,ajax_params);$.ajax(ajax_options);}});},setOption:function(option,value){return this.each(function(){var $this=$(this);var data=$this.popover('getData');if(data){data.options[option]=value;$this.data('popover',data);}});},getData:function(){var ret=[];this.each(function(){var $this=$(this);var data=$this.data('popover');if(data)ret.push(data);});if(ret.length==0)
return;if(ret.length==1)
ret=ret[0];return ret;}};$.fn.popover=function(method){if(methods[method])
return methods[method].apply(this,Array.prototype.slice.call(arguments,1));else if(typeof method==='object'||!method)
return methods.init.apply(this,arguments);else
$.error('Method '+method+' does not exist on jQuery.popover');}})(jQuery);;(function(global){var k,_handlers={},_mods={16:false,18:false,17:false,91:false},_scope='all',_MODIFIERS={'⇧':16,shift:16,'⌥':18,alt:18,option:18,'⌃':17,ctrl:17,control:17,'⌘':91,command:91},_MAP={backspace:8,tab:9,clear:12,enter:13,'return':13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,'delete':46,home:36,end:35,pageup:33,pagedown:34,',':188,'.':190,'/':191,'`':192,'-':189,'=':187,';':186,'\'':222,'[':219,']':221,'\\':220};for(k=1;k<20;k++)_MODIFIERS['f'+k]=111+k;function index(array,item){var i=array.length;while(i--)if(array[i]===item)return i;return-1;}
function dispatch(event,scope){var key,handler,k,i,modifiersMatch;key=event.keyCode;if(key==93||key==224)key=91;if(key in _mods){_mods[key]=true;for(k in _MODIFIERS)if(_MODIFIERS[k]==key)assignKey[k]=true;return;}
if(!assignKey.filter.call(this,event))return;if(!(key in _handlers))return;for(i=0;i<_handlers[key].length;i++){handler=_handlers[key][i];if(handler.scope==scope||handler.scope=='all'){modifiersMatch=handler.mods.length>0;for(k in _mods)
if((!_mods[k]&&index(handler.mods,+k)>-1)||(_mods[k]&&index(handler.mods,+k)==-1))modifiersMatch=false;if((handler.mods.length==0&&!_mods[16]&&!_mods[18]&&!_mods[17]&&!_mods[91])||modifiersMatch){if(handler.method(event,handler)===false){if(event.preventDefault)event.preventDefault();else event.returnValue=false;if(event.stopPropagation)event.stopPropagation();if(event.cancelBubble)event.cancelBubble=true;}}}}};function clearModifier(event){var key=event.keyCode,k;if(key==93||key==224)key=91;if(key in _mods){_mods[key]=false;for(k in _MODIFIERS)if(_MODIFIERS[k]==key)assignKey[k]=false;}};function resetModifiers(){for(k in _mods)_mods[k]=false;for(k in _MODIFIERS)assignKey[k]=false;}
function assignKey(key,scope,method){var keys,mods,i,mi;if(method===undefined){method=scope;scope='all';}
key=key.replace(/\s/g,'');keys=key.split(',');if((keys[keys.length-1])=='')
keys[keys.length-2]+=',';for(i=0;i<keys.length;i++){mods=[];key=keys[i].split('+');if(key.length>1){mods=key.slice(0,key.length-1);for(mi=0;mi<mods.length;mi++)
mods[mi]=_MODIFIERS[mods[mi]];key=[key[key.length-1]];}
key=key[0]
key=_MAP[key]||key.toUpperCase().charCodeAt(0);if(!(key in _handlers))_handlers[key]=[];_handlers[key].push({shortcut:keys[i],scope:scope,method:method,key:keys[i],mods:mods});}};function filter(event){var tagName=(event.target||event.srcElement).tagName;return!(tagName=='INPUT'||tagName=='SELECT'||tagName=='TEXTAREA');}
for(k in _MODIFIERS)assignKey[k]=false;function setScope(scope){_scope=scope||'all'};function getScope(){return _scope||'all'};function deleteScope(scope){var key,handlers,i;for(key in _handlers){handlers=_handlers[key];for(i=0;i<handlers.length;){if(handlers[i].scope===scope)handlers.splice(i,1);else i++;}}};function addEvent(object,event,method){if(object.addEventListener)
object.addEventListener(event,method,false);else if(object.attachEvent)
object.attachEvent('on'+event,function(){method(window.event)});};addEvent(document,'keydown',function(event){dispatch(event,_scope)});addEvent(document,'keyup',clearModifier);addEvent(window,'focus',resetModifiers);global.key=assignKey;global.key.setScope=setScope;global.key.getScope=getScope;global.key.deleteScope=deleteScope;global.key.filter=filter;if(typeof module!=='undefined')module.exports=key;})(this);
(function($){$.fn.scrollable=function(){$(this).bind('mousewheel DOMMouseScroll',function(e){var this_div=$(this);var delta=e.originalEvent.wheelDelta||-e.originalEvent.detail;var scrollTop=this_div.get(0).scrollTop;var scrollHeight=this_div.get(0).scrollHeight;var outerHeight=this_div.outerHeight();if(scrollHeight===outerHeight){return;}
else if(scrollTop<=0){if(delta>0){e.preventDefault();}}
else if((scrollHeight-scrollTop)<=(outerHeight+1)){if(delta<0){e.preventDefault();}}});};})(window.jQuery);
(function($){if(typeof $.fn.each2=="undefined"){$.fn.extend({each2:function(c){var j=$([0]),i=-1,l=this.length;while(++i<l&&(j.context=j[0]=this[i])&&c.call(j[0],i,j)!==false);return this;}});}})(jQuery);(function($,undefined){"use strict";if(window.Select2!==undefined){return;}
var KEY,AbstractSelect2,SingleSelect2,MultiSelect2,nextUid,sizer;KEY={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(k){k=k.which?k.which:k;switch(k){case KEY.LEFT:case KEY.RIGHT:case KEY.UP:case KEY.DOWN:return true;}
return false;},isControl:function(e){var k=e.which;switch(k){case KEY.SHIFT:case KEY.CTRL:case KEY.ALT:return true;}
if(e.metaKey)return true;return false;},isFunctionKey:function(k){k=k.which?k.which:k;return k>=112&&k<=123;}};nextUid=(function(){var counter=1;return function(){return counter++;};}());function indexOf(value,array){var i=0,l=array.length,v;if(typeof value==="undefined"){return-1;}
if(value.constructor===String){for(;i<l;i=i+1)if(value.localeCompare(array[i])===0)return i;}else{for(;i<l;i=i+1){v=array[i];if(v.constructor===String){if(v.localeCompare(value)===0)return i;}else{if(v===value)return i;}}}
return-1;}
function equal(a,b){if(a===b)return true;if(a===undefined||b===undefined)return false;if(a===null||b===null)return false;if(a.constructor===String)return a.localeCompare(b)===0;if(b.constructor===String)return b.localeCompare(a)===0;return false;}
function splitVal(string,separator){var val,i,l;if(string===null||string.length<1)return[];val=string.split(separator);for(i=0,l=val.length;i<l;i=i+1)val[i]=$.trim(val[i]);return val;}
function getSideBorderPadding(element){return element.outerWidth()-element.width();}
function installKeyUpChangeEvent(element){var key="keyup-change-value";element.bind("keydown",function(){if($.data(element,key)===undefined){$.data(element,key,element.val());}});element.bind("keyup",function(){var val=$.data(element,key);if(val!==undefined&&element.val()!==val){$.removeData(element,key);element.trigger("keyup-change");}});}
$(document).delegate("body","mousemove",function(e){$.data(document,"select2-lastpos",{x:e.pageX,y:e.pageY});});function installFilteredMouseMove(element){element.bind("mousemove",function(e){var lastpos=$.data(document,"select2-lastpos");if(lastpos===undefined||lastpos.x!==e.pageX||lastpos.y!==e.pageY){$(e.target).trigger("mousemove-filtered",e);}});}
function debounce(quietMillis,fn,ctx){ctx=ctx||undefined;var timeout;return function(){var args=arguments;window.clearTimeout(timeout);timeout=window.setTimeout(function(){fn.apply(ctx,args);},quietMillis);};}
function thunk(formula){var evaluated=false,value;return function(){if(evaluated===false){value=formula();evaluated=true;}
return value;};};function installDebouncedScroll(threshold,element){var notify=debounce(threshold,function(e){element.trigger("scroll-debounced",e);});element.bind("scroll",function(e){if(indexOf(e.target,element.get())>=0)notify(e);});}
function killEvent(event){event.preventDefault();event.stopPropagation();}
function measureTextWidth(e){if(!sizer){var style=e[0].currentStyle||window.getComputedStyle(e[0],null);sizer=$("<div></div>").css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:style.fontSize,fontFamily:style.fontFamily,fontStyle:style.fontStyle,fontWeight:style.fontWeight,letterSpacing:style.letterSpacing,textTransform:style.textTransform,whiteSpace:"nowrap"});$("body").append(sizer);}
sizer.text(e.val());return sizer.width();}
function markMatch(text,term,markup){var match=text.toUpperCase().indexOf(term.toUpperCase()),tl=term.length;if(match<0){markup.push(text);return;}
markup.push(text.substring(0,match));markup.push("<span class='select2-match'>");markup.push(text.substring(match,match+tl));markup.push("</span>");markup.push(text.substring(match+tl,text.length));}
function ajax(options){var timeout,requestSequence=0,handler=null,quietMillis=options.quietMillis||100;return function(query){window.clearTimeout(timeout);timeout=window.setTimeout(function(){requestSequence+=1;var requestNumber=requestSequence,data=options.data,transport=options.transport||$.ajax,traditional=options.traditional||false,type=options.type||'GET';data=data.call(this,query.term,query.page,query.context);if(null!==handler){handler.abort();}
handler=transport.call(null,{url:options.url,dataType:options.dataType,data:data,type:type,traditional:traditional,success:function(data){if(requestNumber<requestSequence){return;}
var results=options.results(data,query.page);query.callback(results);}});},quietMillis);};}
function local(options){var data=options,dataText,text=function(item){return""+item.text;};if(!$.isArray(data)){text=data.text;if(!$.isFunction(text)){dataText=data.text;text=function(item){return item[dataText];};}
data=data.results;}
return function(query){var t=query.term,filtered={results:[]},process;if(t===""){query.callback({results:data});return;}
process=function(datum,collection){var group,attr;datum=datum[0];if(datum.children){group={};for(attr in datum){if(datum.hasOwnProperty(attr))group[attr]=datum[attr];}
group.children=[];$(datum.children).each2(function(i,childDatum){process(childDatum,group.children);});if(group.children.length){collection.push(group);}}else{if(query.matcher(t,text(datum))){collection.push(datum);}}};$(data).each2(function(i,datum){process(datum,filtered.results);});query.callback(filtered);};}
function tags(data){if($.isFunction(data)){return data;}
return function(query){var t=query.term,filtered={results:[]};$(data).each(function(){var isObject=this.text!==undefined,text=isObject?this.text:this;if(t===""||query.matcher(t,text)){filtered.results.push(isObject?this:{id:this,text:this});}});query.callback(filtered);};}
function checkFormatter(formatter,formatterName){if($.isFunction(formatter))return true;if(!formatter)return false;throw new Error("formatterName must be a function or a falsy value");}
function evaluate(val){return $.isFunction(val)?val():val;}
function countResults(results){var count=0;$.each(results,function(i,item){if(item.children){count+=countResults(item.children);}else{count++;}});return count;}
function defaultTokenizer(input,selection,selectCallback,opts){var original=input,dupe=false,token,index,i,l,separator;if(!opts.createSearchChoice||!opts.tokenSeparators||opts.tokenSeparators.length<1)return undefined;while(true){index=-1;for(i=0,l=opts.tokenSeparators.length;i<l;i++){separator=opts.tokenSeparators[i];index=input.indexOf(separator);if(index>=0)break;}
if(index<0)break;token=input.substring(0,index);input=input.substring(index+separator.length);if(token.length>0){token=opts.createSearchChoice(token,selection);if(token!==undefined&&token!==null&&opts.id(token)!==undefined&&opts.id(token)!==null){dupe=false;for(i=0,l=selection.length;i<l;i++){if(equal(opts.id(token),opts.id(selection[i]))){dupe=true;break;}}
if(!dupe)selectCallback(token);}}}
if(original.localeCompare(input)!=0)return input;}
$(document).ready(function(){$(document).delegate("body","mousedown touchend",function(e){var target=$(e.target).closest("div.select2-container").get(0),attr;if(target){$(document).find("div.select2-container-active").each(function(){if(this!==target)$(this).data("select2").blur();});}else{target=$(e.target).closest("div.select2-drop").get(0);$(document).find("div.select2-drop-active").each(function(){if(this!==target)$(this).data("select2").blur();});}
target=$(e.target);attr=target.attr("for");if("LABEL"===e.target.tagName&&attr&&attr.length>0){target=$("#"+attr);target=target.data("select2");if(target!==undefined){target.focus();e.preventDefault();}}});});function clazz(SuperClass,methods){var constructor=function(){};constructor.prototype=new SuperClass;constructor.prototype.constructor=constructor;constructor.prototype.parent=SuperClass.prototype;constructor.prototype=$.extend(constructor.prototype,methods);return constructor;}
AbstractSelect2=clazz(Object,{bind:function(func){var self=this;return function(){func.apply(self,arguments);};},init:function(opts){var results,search,resultsSelector=".select2-results";this.opts=opts=this.prepareOpts(opts);this.id=opts.id;if(opts.element.data("select2")!==undefined&&opts.element.data("select2")!==null){this.destroy();}
this.enabled=true;this.container=this.createContainer();this.containerId="s2id_"+(opts.element.attr("id")||"autogen"+nextUid());this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,'\\$1');this.container.attr("id",this.containerId);this.body=thunk(function(){return opts.element.closest("body");});if(opts.element.attr("class")!==undefined){this.container.addClass(opts.element.attr("class").replace(/validate\[[\S ]+] ?/,''));}
this.container.css(evaluate(opts.containerCss));this.container.addClass(evaluate(opts.containerCssClass));this.opts.element.data("select2",this).hide().before(this.container);this.container.data("select2",this);this.dropdown=this.container.find(".select2-drop");this.dropdown.addClass(evaluate(opts.dropdownCssClass));this.dropdown.data("select2",this);this.results=results=this.container.find(resultsSelector);this.search=search=this.container.find("input.select2-input");search.attr("tabIndex",this.opts.element.attr("tabIndex"));this.resultsPage=0;this.context=null;this.initContainer();this.initContainerWidth();installFilteredMouseMove(this.results);this.dropdown.delegate(resultsSelector,"mousemove-filtered",this.bind(this.highlightUnderEvent));installDebouncedScroll(80,this.results);this.dropdown.delegate(resultsSelector,"scroll-debounced",this.bind(this.loadMoreIfNeeded));if($.fn.mousewheel){results.mousewheel(function(e,delta,deltaX,deltaY){var top=results.scrollTop(),height;if(deltaY>0&&top-deltaY<=0){results.scrollTop(0);killEvent(e);}else if(deltaY<0&&results.get(0).scrollHeight-results.scrollTop()+deltaY<=results.height()){results.scrollTop(results.get(0).scrollHeight-results.height());killEvent(e);}});}
installKeyUpChangeEvent(search);search.bind("keyup-change",this.bind(this.updateResults));search.bind("focus",function(){search.addClass("select2-focused");if(search.val()===" ")search.val("");});search.bind("blur",function(){search.removeClass("select2-focused");});this.dropdown.delegate(resultsSelector,"mouseup",this.bind(function(e){if($(e.target).closest(".select2-result-selectable:not(.select2-disabled)").length>0){this.highlightUnderEvent(e);this.selectHighlighted(e);}else{this.focusSearch();}
killEvent(e);}));this.dropdown.bind("click mouseup mousedown",function(e){e.stopPropagation();});if($.isFunction(this.opts.initSelection)){this.initSelection();this.monitorSource();}
if(opts.element.is(":disabled")||opts.element.is("[readonly='readonly']"))this.disable();},destroy:function(){var select2=this.opts.element.data("select2");if(select2!==undefined){select2.container.remove();select2.dropdown.remove();select2.opts.element.removeData("select2").unbind(".select2").show();}},prepareOpts:function(opts){var element,select,idKey,ajaxUrl;element=opts.element;if(element.get(0).tagName.toLowerCase()==="select"){this.select=select=opts.element;}
if(select){$.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in opts){throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.");}});}
opts=$.extend({},{populateResults:function(container,results,query){var populate,data,result,children,id=this.opts.id,self=this;populate=function(results,container,depth){var i,l,result,selectable,compound,node,label,innerContainer,formatted;for(i=0,l=results.length;i<l;i=i+1){result=results[i];selectable=id(result)!==undefined;compound=result.children&&result.children.length>0;node=$("<li></li>");node.addClass("select2-results-dept-"+depth);node.addClass("select2-result");node.addClass(selectable?"select2-result-selectable":"select2-result-unselectable");if(compound){node.addClass("select2-result-with-children");}
node.addClass(self.opts.formatResultCssClass(result));label=$("<div></div>");label.addClass("select2-result-label");formatted=opts.formatResult(result,label,query);if(formatted!==undefined){label.html(self.opts.escapeMarkup(formatted));}
node.append(label);if(compound){innerContainer=$("<ul></ul>");innerContainer.addClass("select2-result-sub");populate(result.children,innerContainer,depth+1);node.append(innerContainer);}
node.data("select2-data",result);container.append(node);}};populate(results,container,0);}},$.fn.select2.defaults,opts);if(typeof(opts.id)!=="function"){idKey=opts.id;opts.id=function(e){return e[idKey];};}
if(select){opts.query=this.bind(function(query){var data={results:[],more:false},term=query.term,children,firstChild,process;process=function(element,collection){var group;if(element.is("option")){if(query.matcher(term,element.text(),element)){collection.push({id:element.attr("value"),text:element.text(),element:element.get(),css:element.attr("class")});}}else if(element.is("optgroup")){group={text:element.attr("label"),children:[],element:element.get(),css:element.attr("class")};element.children().each2(function(i,elm){process(elm,group.children);});if(group.children.length>0){collection.push(group);}}};children=element.children();if(this.getPlaceholder()!==undefined&&children.length>0){firstChild=children[0];if($(firstChild).text()===""){children=children.not(firstChild);}}
children.each2(function(i,elm){process(elm,data.results);});query.callback(data);});opts.id=function(e){return e.id;};opts.formatResultCssClass=function(data){return data.css;}}else{if(!("query"in opts)){if("ajax"in opts){ajaxUrl=opts.element.data("ajax-url");if(ajaxUrl&&ajaxUrl.length>0){opts.ajax.url=ajaxUrl;}
opts.query=ajax(opts.ajax);}else if("data"in opts){opts.query=local(opts.data);}else if("tags"in opts){opts.query=tags(opts.tags);opts.createSearchChoice=function(term){return{id:term,text:term};};opts.initSelection=function(element,callback){var data=[];$(splitVal(element.val(),opts.separator)).each(function(){var id=this,text=this,tags=opts.tags;if($.isFunction(tags))tags=tags();$(tags).each(function(){if(equal(this.id,id)){text=this.text;return false;}});data.push({id:id,text:text});});callback(data);};}}}
if(typeof(opts.query)!=="function"){throw"query function not defined for Select2 "+opts.element.attr("id");}
return opts;},monitorSource:function(){this.opts.element.bind("change.select2",this.bind(function(e){if(this.opts.element.data("select2-change-triggered")!==true){this.initSelection();}}));},triggerChange:function(details){details=details||{};details=$.extend({},details,{type:"change",val:this.val()});this.opts.element.data("select2-change-triggered",true);this.opts.element.trigger(details);this.opts.element.data("select2-change-triggered",false);this.opts.element.click();if(this.opts.blurOnChange)
this.opts.element.blur();},enable:function(){if(this.enabled)return;this.enabled=true;this.container.removeClass("select2-container-disabled");},disable:function(){if(!this.enabled)return;this.close();this.enabled=false;this.container.addClass("select2-container-disabled");},opened:function(){return this.container.hasClass("select2-dropdown-open");},positionDropdown:function(){var offset=this.container.offset(),height=this.container.outerHeight(),width=this.container.outerWidth(),dropHeight=this.dropdown.outerHeight(),viewportBottom=$(window).scrollTop()+document.documentElement.clientHeight,dropTop=offset.top+height,dropLeft=offset.left,enoughRoomBelow=dropTop+dropHeight<=viewportBottom,enoughRoomAbove=(offset.top-dropHeight)>=this.body().scrollTop(),aboveNow=this.dropdown.hasClass("select2-drop-above"),bodyOffset,above,css;if(this.body().css('position')!=='static'){bodyOffset=this.body().offset();dropTop-=bodyOffset.top;dropLeft-=bodyOffset.left;}
if(aboveNow){above=true;if(!enoughRoomAbove&&enoughRoomBelow)above=false;}else{above=false;if(!enoughRoomBelow&&enoughRoomAbove)above=true;}
if(above){dropTop=offset.top-dropHeight;this.container.addClass("select2-drop-above");this.dropdown.addClass("select2-drop-above");}
else{this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above");}
css=$.extend({top:dropTop,left:dropLeft,width:width},evaluate(this.opts.dropdownCss));this.dropdown.css(css);},shouldOpen:function(){var event;if(this.opened())return false;event=$.Event("open");this.opts.element.trigger(event);return!event.isDefaultPrevented();},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above");},open:function(){if(!this.shouldOpen())return false;window.setTimeout(this.bind(this.opening),1);return true;},opening:function(){var cid=this.containerId,selector=this.containerSelector,scroll="scroll."+cid,resize="resize."+cid;this.container.parents().each(function(){$(this).bind(scroll,function(){var s2=$(selector);if(s2.length==0){$(this).unbind(scroll);}
s2.select2("close");});});$(window).bind(resize,function(){var s2=$(selector);if(s2.length==0){$(window).unbind(resize);}
s2.select2("close");});this.clearDropdownAlignmentPreference();if(this.search.val()===" "){this.search.val("");}
this.container.addClass("select2-dropdown-open").addClass("select2-container-active");this.updateResults(true);if(this.dropdown[0]!==this.body().children().last()[0]){this.dropdown.detach().appendTo(this.body());}
this.dropdown.show();this.positionDropdown();this.dropdown.addClass("select2-drop-active");this.ensureHighlightVisible();this.focusSearch();},close:function(){if(!this.opened())return;var self=this;this.container.parents().each(function(){$(this).unbind("scroll."+self.containerId);});$(window).unbind("resize."+this.containerId);this.clearDropdownAlignmentPreference();this.dropdown.hide();this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active");this.results.empty();this.clearSearch();this.opts.element.trigger($.Event("close"));},clearSearch:function(){},ensureHighlightVisible:function(){var results=this.results,children,index,child,hb,rb,y,more;index=this.highlight();if(index<0)return;if(index==0){results.scrollTop(0);return;}
children=results.find(".select2-result-selectable");child=$(children[index]);hb=child.offset().top+child.outerHeight();if(index===children.length-1){more=results.find("li.select2-more-results");if(more.length>0){hb=more.offset().top+more.outerHeight();}}
rb=results.offset().top+results.outerHeight();if(hb>rb){results.scrollTop(results.scrollTop()+(hb-rb));}
y=child.offset().top-results.offset().top;if(y<0){results.scrollTop(results.scrollTop()+y);}},moveHighlight:function(delta){var choices=this.results.find(".select2-result-selectable"),index=this.highlight();while(index>-1&&index<choices.length){index+=delta;var choice=$(choices[index]);if(choice.hasClass("select2-result-selectable")&&!choice.hasClass("select2-disabled")){this.highlight(index);break;}}},highlight:function(index){var choices=this.results.find(".select2-result-selectable").not(".select2-disabled");if(arguments.length===0){return indexOf(choices.filter(".select2-highlighted")[0],choices.get());}
if(index>=choices.length)index=choices.length-1;if(index<0)index=0;choices.removeClass("select2-highlighted");$(choices[index]).addClass("select2-highlighted");this.ensureHighlightVisible();},countSelectableResults:function(){return this.results.find(".select2-result-selectable").not(".select2-disabled").length;},highlightUnderEvent:function(event){var el=$(event.target).closest(".select2-result-selectable");if(el.length>0&&!el.is(".select2-highlighted")){var choices=this.results.find('.select2-result-selectable');this.highlight(choices.index(el));}else if(el.length==0){this.results.find(".select2-highlighted").removeClass("select2-highlighted");}},loadMoreIfNeeded:function(){var results=this.results,more=results.find("li.select2-more-results"),below,offset=-1,page=this.resultsPage+1,self=this,term=this.search.val(),context=this.context;if(more.length===0)return;below=more.offset().top-results.offset().top-results.height();if(below<=0){more.addClass("select2-active");this.opts.query({term:term,page:page,context:context,matcher:this.opts.matcher,callback:this.bind(function(data){if(!self.opened())return;self.opts.populateResults.call(this,results,data.results,{term:term,page:page,context:context});if(data.more===true){more.detach().appendTo(results).text(self.opts.formatLoadMore(page+1));window.setTimeout(function(){self.loadMoreIfNeeded();},10);}else{more.remove();}
self.positionDropdown();self.resultsPage=page;})});}},tokenize:function(){},updateResults:function(initial){var search=this.search,results=this.results,opts=this.opts,data,self=this,input;if(initial!==true&&(this.showSearchInput===false||!this.opened())){return;}
search.addClass("select2-active");function postRender(){results.scrollTop(0);search.removeClass("select2-active");self.positionDropdown();}
function render(html){results.html(self.opts.escapeMarkup(html));postRender();}
if(opts.maximumSelectionSize>=1){data=this.data();if($.isArray(data)&&data.length>=opts.maximumSelectionSize&&checkFormatter(opts.formatSelectionTooBig,"formatSelectionTooBig")){render("<li class='select2-selection-limit'>"+opts.formatSelectionTooBig(opts.maximumSelectionSize)+"</li>");return;}}
if(search.val().length<opts.minimumInputLength&&checkFormatter(opts.formatInputTooShort,"formatInputTooShort")){render("<li class='select2-no-results'>"+opts.formatInputTooShort(search.val(),opts.minimumInputLength)+"</li>");return;}
else{render("<li class='select2-searching'>"+opts.formatSearching()+"</li>");}
input=this.tokenize();if(input!=undefined&&input!=null){search.val(input);}
this.resultsPage=1;opts.query({term:search.val(),page:this.resultsPage,context:null,matcher:opts.matcher,callback:this.bind(function(data){var def;if(!this.opened())return;this.context=(data.context===undefined)?null:data.context;if(this.opts.createSearchChoice&&search.val()!==""){def=this.opts.createSearchChoice.call(null,search.val(),data.results);if(def!==undefined&&def!==null&&self.id(def)!==undefined&&self.id(def)!==null){if($(data.results).filter(function(){return equal(self.id(this),self.id(def));}).length===0){data.results.unshift(def);}}}
if(data.results.length===0&&checkFormatter(opts.formatNoMatches,"formatNoMatches")){render("<li class='select2-no-results'>"+opts.formatNoMatches(search.val())+"</li>");return;}
results.empty();self.opts.populateResults.call(this,results,data.results,{term:search.val(),page:this.resultsPage,context:null});if(data.more===true&&checkFormatter(opts.formatLoadMore,"formatLoadMore")){results.append("<li class='select2-more-results'>"+self.opts.escapeMarkup(opts.formatLoadMore(this.resultsPage))+"</li>");window.setTimeout(function(){self.loadMoreIfNeeded();},10);}
this.postprocessResults(data,initial);postRender();})});},cancel:function(){this.close();},blur:function(){this.close();this.container.removeClass("select2-container-active");this.dropdown.removeClass("select2-drop-active");if(this.search[0]===document.activeElement){this.search.blur();}
this.clearSearch();this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");},focusSearch:function(){this.search.show();this.search.focus();window.setTimeout(this.bind(function(){this.search.show();this.search.focus();this.search.val(this.search.val());}),10);},selectHighlighted:function(){var index=this.highlight(),highlighted=this.results.find(".select2-highlighted").not(".select2-disabled"),data=highlighted.closest('.select2-result-selectable').data("select2-data");if(data){highlighted.addClass("select2-disabled");this.highlight(index);this.onSelect(data);}},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder;},initContainerWidth:function(){function resolveContainerWidth(){var style,attrs,matches,i,l;if(this.opts.width==="off"){return null;}else if(this.opts.width==="element"){return this.opts.element.outerWidth()===0?'auto':this.opts.element.outerWidth()+'px';}else if(this.opts.width==="copy"||this.opts.width==="resolve"){style=this.opts.element.attr('style');if(style!==undefined){attrs=style.split(';');for(i=0,l=attrs.length;i<l;i=i+1){matches=attrs[i].replace(/\s/g,'').match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/);if(matches!==null&&matches.length>=1)
return matches[1];}}
if(this.opts.width==="resolve"){style=this.opts.element.css('width');if(style.indexOf("%")>0)return style;return(this.opts.element.outerWidth()===0?'auto':this.opts.element.outerWidth()+'px');}
return null;}else if($.isFunction(this.opts.width)){return this.opts.width();}else{return this.opts.width;}};var width=resolveContainerWidth.call(this);if(width!==null){this.container.attr("style","width: "+width);}}});SingleSelect2=clazz(AbstractSelect2,{createContainer:function(){var container=$("<div></div>",{"class":"select2-container"}).html(["    <a href='#' onclick='return false;' class='select2-choice'>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>","   <div><b></b></div>","</a>","    <div class='select2-drop select2-offscreen'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return container;},opening:function(){this.search.show();this.parent.opening.apply(this,arguments);this.dropdown.removeClass("select2-offscreen");},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments);this.dropdown.removeAttr("style").addClass("select2-offscreen").insertAfter(this.selection).show();},focus:function(){this.close();this.selection.focus();},isFocused:function(){return this.selection[0]===document.activeElement;},cancel:function(){this.parent.cancel.apply(this,arguments);this.selection.focus();},initContainer:function(){var selection,container=this.container,dropdown=this.dropdown,clickingInside=false;this.selection=selection=container.find(".select2-choice");this.search.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===KEY.PAGE_UP||e.which===KEY.PAGE_DOWN){killEvent(e);return;}
if(this.opened()){switch(e.which){case KEY.UP:case KEY.DOWN:this.moveHighlight((e.which===KEY.UP)?-1:1);killEvent(e);return;case KEY.TAB:case KEY.ENTER:this.selectHighlighted();killEvent(e);return;case KEY.ESC:this.cancel(e);killEvent(e);return;}}else{if(e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.ESC){return;}
if(this.opts.openOnEnter===false&&e.which===KEY.ENTER){return;}
this.open();if(e.which===KEY.ENTER){return;}}}));this.search.bind("focus",this.bind(function(){this.selection.attr("tabIndex","-1");}));this.search.bind("blur",this.bind(function(){if(!this.opened())this.container.removeClass("select2-container-active");window.setTimeout(this.bind(function(){this.selection.attr("tabIndex",this.opts.element.attr("tabIndex"));}),10);}));selection.bind("mousedown",this.bind(function(e){clickingInside=true;if(this.opened()){this.close();this.selection.focus();}else if(this.enabled){this.open();}
clickingInside=false;}));dropdown.bind("mousedown",this.bind(function(){this.search.focus();}));selection.bind("focus",this.bind(function(){this.container.addClass("select2-container-active");this.search.attr("tabIndex","-1");}));selection.bind("blur",this.bind(function(){if(!this.opened()){this.container.removeClass("select2-container-active");}
window.setTimeout(this.bind(function(){this.search.attr("tabIndex",this.opts.element.attr("tabIndex"));}),10);}));selection.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===KEY.PAGE_UP||e.which===KEY.PAGE_DOWN){killEvent(e);return;}
if(e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.ESC){return;}
if(this.opts.openOnEnter===false&&e.which===KEY.ENTER){return;}
if(e.which==KEY.DELETE){if(this.opts.allowClear){this.clear();}
return;}
this.open();if(e.which===KEY.ENTER){killEvent(e);return;}
if(e.which<48){killEvent(e);return;}
var keyWritten=String.fromCharCode(e.which).toLowerCase();if(e.shiftKey){keyWritten=keyWritten.toUpperCase();}
this.search.focus();this.search.val(keyWritten);killEvent(e);}));selection.delegate("abbr","mousedown",this.bind(function(e){if(!this.enabled)return;this.clear();killEvent(e);this.close();this.triggerChange();this.selection.focus();}));this.setPlaceholder();this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active");}));},clear:function(){this.opts.element.val("");this.selection.find("span").empty();this.selection.removeData("select2-data");this.setPlaceholder();},initSelection:function(){var selected;if(this.opts.element.val()===""){this.close();this.setPlaceholder();}else{var self=this;this.opts.initSelection.call(null,this.opts.element,function(selected){if(selected!==undefined&&selected!==null){self.updateSelection(selected);self.close();self.setPlaceholder();}});}},prepareOpts:function(){var opts=this.parent.prepareOpts.apply(this,arguments);if(opts.element.get(0).tagName.toLowerCase()==="select"){opts.initSelection=function(element,callback){var selected=element.find(":selected");if($.isFunction(callback))
callback({id:selected.attr("value"),text:selected.text()});};}
return opts;},setPlaceholder:function(){var placeholder=this.getPlaceholder();if(this.opts.element.val()===""&&placeholder!==undefined){if(this.select&&this.select.find("option:first").text()!=="")return;this.selection.find("span").html(this.opts.escapeMarkup(placeholder));this.selection.addClass("select2-default");this.selection.find("abbr").hide();}},postprocessResults:function(data,initial){var selected=0,self=this,showSearchInput=true;this.results.find(".select2-result-selectable").each2(function(i,elm){if(equal(self.id(elm.data("select2-data")),self.opts.element.val())){selected=i;return false;}});this.highlight(selected);if(initial===true){showSearchInput=this.showSearchInput=countResults(data.results)>=this.opts.minimumResultsForSearch;this.dropdown.find(".select2-search")[showSearchInput?"removeClass":"addClass"]("select2-search-hidden");$(this.dropdown,this.container)[showSearchInput?"addClass":"removeClass"]("select2-with-searchbox");}},onSelect:function(data){var old=this.opts.element.val();this.opts.element.val(this.id(data));this.updateSelection(data);this.close();this.selection.focus();if(!equal(old,this.id(data))){this.triggerChange();}},updateSelection:function(data){var container=this.selection.find("span"),formatted;this.selection.data("select2-data",data);container.empty();formatted=this.opts.formatSelection(data,container);if(formatted!==undefined){container.append(this.opts.escapeMarkup(formatted));}
this.selection.removeClass("select2-default");if(this.opts.allowClear&&this.getPlaceholder()!==undefined){this.selection.find("abbr").show();}},val:function(){var val,data=null,self=this;if(arguments.length===0){return this.opts.element.val();}
val=arguments[0];if(this.select){this.select.val(val).find(":selected").each2(function(i,elm){data={id:elm.attr("value"),text:elm.text()};return false;});this.updateSelection(data);this.setPlaceholder();}else{if(this.opts.initSelection===undefined){throw new Error("cannot call val() if initSelection() is not defined");}
if(!val){this.clear();return;}
this.opts.element.val(val);this.opts.initSelection(this.opts.element,function(data){self.opts.element.val(!data?"":self.id(data));self.updateSelection(data);self.setPlaceholder();});}},clearSearch:function(){this.search.val("");},data:function(value){var data;if(arguments.length===0){data=this.selection.data("select2-data");if(data==undefined)data=null;return data;}else{if(!value||value===""){this.clear();}else{this.opts.element.val(!value?"":this.id(value));this.updateSelection(value);}}}});MultiSelect2=clazz(AbstractSelect2,{createContainer:function(){var container=$("<div></div>",{"class":"select2-container select2-container-multi"}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return container;},prepareOpts:function(){var opts=this.parent.prepareOpts.apply(this,arguments);if(opts.element.get(0).tagName.toLowerCase()==="select"){opts.initSelection=function(element,callback){var data=[];element.find(":selected").each2(function(i,elm){data.push({id:elm.attr("value"),text:elm.text()});});if($.isFunction(callback))
callback(data);};}
return opts;},initContainer:function(){var selector=".select2-choices",selection;this.searchContainer=this.container.find(".select2-search-field");this.selection=selection=this.container.find(selector);this.search.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===KEY.BACKSPACE&&this.search.val()===""){this.close();var choices,selected=selection.find(".select2-search-choice-focus");if(selected.length>0){this.unselect(selected.first());this.search.width(10);killEvent(e);return;}
choices=selection.find(".select2-search-choice");if(choices.length>0){choices.last().addClass("select2-search-choice-focus");}}else{selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");}
if(this.opened()){switch(e.which){case KEY.UP:case KEY.DOWN:this.moveHighlight((e.which===KEY.UP)?-1:1);killEvent(e);return;case KEY.ENTER:case KEY.TAB:this.selectHighlighted();killEvent(e);return;case KEY.ESC:this.cancel(e);killEvent(e);return;}}
if(e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.BACKSPACE||e.which===KEY.ESC){return;}
if(this.opts.openOnEnter===false&&e.which===KEY.ENTER){return;}
this.open();if(e.which===KEY.PAGE_UP||e.which===KEY.PAGE_DOWN){killEvent(e);}}));this.search.bind("keyup",this.bind(this.resizeSearch));this.search.bind("blur",this.bind(function(e){this.container.removeClass("select2-container-active");this.search.removeClass("select2-focused");this.clearSearch();e.stopImmediatePropagation();}));this.container.delegate(selector,"mousedown",this.bind(function(e){if(!this.enabled)return;if($(e.target).closest(".select2-search-choice").length>0){return;}
this.clearPlaceholder();this.open();this.focusSearch();e.preventDefault();}));this.container.delegate(selector,"focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active");this.clearPlaceholder();}));this.clearSearch();},enable:function(){if(this.enabled)return;this.parent.enable.apply(this,arguments);this.search.removeAttr("disabled");},disable:function(){if(!this.enabled)return;this.parent.disable.apply(this,arguments);this.search.attr("disabled",true);},initSelection:function(){var data;if(this.opts.element.val()===""){this.updateSelection([]);this.close();this.clearSearch();}
if(this.select||this.opts.element.val()!==""){var self=this;this.opts.initSelection.call(null,this.opts.element,function(data){if(data!==undefined&&data!==null){self.updateSelection(data);self.close();self.clearSearch();}});}},clearSearch:function(){var placeholder=this.getPlaceholder();if(placeholder!==undefined&&this.getVal().length===0&&this.search.hasClass("select2-focused")===false){this.search.val(placeholder).addClass("select2-default");this.resizeSearch();}else{this.search.val(" ").width(10);}},clearPlaceholder:function(){if(this.search.hasClass("select2-default")){this.search.val("").removeClass("select2-default");}else{if(this.search.val()===" ")this.search.val("");}},opening:function(){this.parent.opening.apply(this,arguments);this.clearPlaceholder();this.resizeSearch();this.focusSearch();},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments);},focus:function(){this.close();this.search.focus();},isFocused:function(){return this.search.hasClass("select2-focused");},updateSelection:function(data){var ids=[],filtered=[],self=this;$(data).each(function(){if(indexOf(self.id(this),ids)<0){ids.push(self.id(this));filtered.push(this);}});data=filtered;this.selection.find(".select2-search-choice").remove();$(data).each(function(){self.addSelectedChoice(this);});self.postprocessResults();},tokenize:function(){var input=this.search.val();input=this.opts.tokenizer(input,this.data(),this.bind(this.onSelect),this.opts);if(input!=null&&input!=undefined){this.search.val(input);if(input.length>0){this.open();}}},onSelect:function(data){this.addSelectedChoice(data);if(this.select){this.postprocessResults();}
if(this.opts.closeOnSelect){this.close();this.search.width(10);}else{if(this.countSelectableResults()>0){this.search.width(10);this.resizeSearch();this.positionDropdown();}else{this.close();}}
this.triggerChange({added:data});this.focusSearch();},cancel:function(){this.close();this.focusSearch();},addSelectedChoice:function(data){var choice=$("<li class='select2-search-choice'>"+"    <div></div>"+"    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a>"+"</li>"),id=this.id(data),val=this.getVal(),formatted;formatted=this.opts.formatSelection(data,choice);choice.find("div").replaceWith("<div>"+this.opts.escapeMarkup(formatted)+"</div>");choice.find(".select2-search-choice-close").bind("mousedown",killEvent).bind("click dblclick",this.bind(function(e){if(!this.enabled)return;$(e.target).closest(".select2-search-choice").fadeOut('fast',this.bind(function(){this.unselect($(e.target));this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");this.close();this.focusSearch();})).dequeue();killEvent(e);})).bind("focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active");}));choice.data("select2-data",data);choice.insertBefore(this.searchContainer);val.push(id);this.setVal(val);},unselect:function(selected){var val=this.getVal(),data,index;selected=selected.closest(".select2-search-choice");if(selected.length===0){throw"Invalid argument: "+selected+". Must be .select2-search-choice";}
data=selected.data("select2-data");index=indexOf(this.id(data),val);if(index>=0){val.splice(index,1);this.setVal(val);if(this.select)this.postprocessResults();}
selected.remove();this.triggerChange({removed:data});},postprocessResults:function(){var val=this.getVal(),choices=this.results.find(".select2-result-selectable"),compound=this.results.find(".select2-result-with-children"),self=this;choices.each2(function(i,choice){var id=self.id(choice.data("select2-data"));if(indexOf(id,val)>=0){choice.addClass("select2-disabled").removeClass("select2-result-selectable");}else{choice.removeClass("select2-disabled").addClass("select2-result-selectable");}});compound.each2(function(i,e){if(e.find(".select2-result-selectable").length==0){e.addClass("select2-disabled");}else{e.removeClass("select2-disabled");}});choices.each2(function(i,choice){if(!choice.hasClass("select2-disabled")&&choice.hasClass("select2-result-selectable")){self.highlight(0);return false;}});},resizeSearch:function(){var minimumWidth,left,maxWidth,containerLeft,searchWidth,sideBorderPadding=getSideBorderPadding(this.search);minimumWidth=measureTextWidth(this.search)+10;left=this.search.offset().left;maxWidth=this.selection.width();containerLeft=this.selection.offset().left;searchWidth=maxWidth-(left-containerLeft)-sideBorderPadding;if(searchWidth<minimumWidth){searchWidth=maxWidth-sideBorderPadding;}
if(searchWidth<40){searchWidth=maxWidth-sideBorderPadding;}
this.search.width(searchWidth);},getVal:function(){var val;if(this.select){val=this.select.val();return val===null?[]:val;}else{val=this.opts.element.val();return splitVal(val,this.opts.separator);}},setVal:function(val){var unique;if(this.select){this.select.val(val);}else{unique=[];$(val).each(function(){if(indexOf(this,unique)<0)unique.push(this);});this.opts.element.val(unique.length===0?"":unique.join(this.opts.separator));}},val:function(){var val,data=[],self=this;if(arguments.length===0){return this.getVal();}
val=arguments[0];if(!val){this.opts.element.val("");this.updateSelection([]);this.clearSearch();return;}
this.setVal(val);if(this.select){this.select.find(":selected").each(function(){data.push({id:$(this).attr("value"),text:$(this).text()});});this.updateSelection(data);}else{if(this.opts.initSelection===undefined){throw new Error("val() cannot be called if initSelection() is not defined")}
this.opts.initSelection(this.opts.element,function(data){var ids=$(data).map(self.id);self.setVal(ids);self.updateSelection(data);self.clearSearch();});}
this.clearSearch();},onSortStart:function(){if(this.select){throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");}
this.search.width(0);this.searchContainer.hide();},onSortEnd:function(){var val=[],self=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(".select2-search-choice").each(function(){val.push(self.opts.id($(this).data("select2-data")));});this.setVal(val);this.triggerChange();},data:function(values){var self=this,ids;if(arguments.length===0){return this.selection.find(".select2-search-choice").map(function(){return $(this).data("select2-data");}).get();}else{if(!values){values=[];}
ids=$.map(values,function(e){return self.opts.id(e)});this.setVal(ids);this.updateSelection(values);this.clearSearch();}}});$.fn.select2=function(){var args=Array.prototype.slice.call(arguments,0),opts,select2,value,multiple,allowedMethods=["val","destroy","opened","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data"];this.each(function(){if(args.length===0||typeof(args[0])==="object"){opts=args.length===0?{}:$.extend({},args[0]);opts.element=$(this);if(opts.element.get(0).tagName.toLowerCase()==="select"){multiple=opts.element.attr("multiple");}else{multiple=opts.multiple||false;if("tags"in opts){opts.multiple=multiple=true;}}
select2=multiple?new MultiSelect2():new SingleSelect2();select2.init(opts);}else if(typeof(args[0])==="string"){if(indexOf(args[0],allowedMethods)<0){throw"Unknown method: "+args[0];}
value=undefined;select2=$(this).data("select2");if(select2===undefined)return;if(args[0]==="container"){value=select2.container;}else{value=select2[args[0]].apply(select2,args.slice(1));}
if(value!==undefined){return false;}}else{throw"Invalid arguments to select2 plugin: "+args;}});return(value===undefined)?this:value;};$.fn.select2.defaults={width:"copy",closeOnSelect:true,openOnEnter:true,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(result,container,query){var markup=[];markMatch(result.text,query.term,markup);return markup.join("");},formatSelection:function(data,container){return data?data.text:undefined;},formatResultCssClass:function(data){return undefined;},formatNoMatches:function(){return"No matches found";},formatInputTooShort:function(input,min){return"Please enter "+(min-input.length)+" more characters";},formatSelectionTooBig:function(limit){return"You can only select "+limit+" item"+(limit==1?"":"s");},formatLoadMore:function(pageNumber){return"Loading more results...";},formatSearching:function(){return"Searching...";},minimumResultsForSearch:0,minimumInputLength:0,maximumSelectionSize:0,id:function(e){return e.id;},matcher:function(term,text){return text.toUpperCase().indexOf(term.toUpperCase())>=0;},separator:",",tokenSeparators:[],tokenizer:defaultTokenizer,escapeMarkup:function(markup){if(markup&&typeof(markup)==="string"){return markup.replace(/&/g,"&amp;");}
return markup;},blurOnChange:false};window.Select2={query:{ajax:ajax,local:local,tags:tags},util:{debounce:debounce,markMatch:markMatch},"class":{"abstract":AbstractSelect2,"single":SingleSelect2,"multi":MultiSelect2}};}(jQuery));
if(!(window.console&&console.log)){(function(){var noop=function(){};var methods=['assert','clear','count','debug','dir','dirxml','error','exception','group','groupCollapsed','groupEnd','info','log','markTimeline','profile','profileEnd','markTimeline','table','time','timeEnd','timeStamp','trace','warn'];var length=methods.length;var console=window.console={};while(length--){console[methods[length]]=noop;}}());}
if(typeof String.prototype.trim!=='function'){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,'');};}
$.fn.outerHtml=function(){return $(this).get(0).outerHTML||new XMLSerializer().serializeToString($(this).get(0));};if(typeof window.location.origin=="undefined"){window.location.origin=window.location.protocol+'//'+window.location.host}
if(!Array.prototype.indexOf)
{Array.prototype.indexOf=function(elt)
{var len=this.length>>>0;var from=Number(arguments[1])||0;from=(from<0)?Math.ceil(from):Math.floor(from);if(from<0)
from+=len;for(;from<len;from++)
{if(from in this&&this[from]===elt)
return from;}
return-1;};}
window.Socialite=(function(window,document,undefined)
{'use strict';var uid=0,instances=[],networks={},widgets={},rstate=/^($|loaded|complete)/,euc=window.encodeURIComponent;var socialite={settings:{},trim:function(str)
{return str.trim?str.trim():str.replace(/^\s+|\s+$/g,'');},hasClass:function(el,cn)
{return(' '+el.className+' ').indexOf(' '+cn+' ')!==-1;},addClass:function(el,cn)
{if(!socialite.hasClass(el,cn)){el.className=(el.className==='')?cn:el.className+' '+cn;}},removeClass:function(el,cn)
{el.className=socialite.trim(' '+el.className+' '.replace(' '+cn+' ',' '));},extendObject:function(to,from,overwrite)
{for(var prop in from){var hasProp=to[prop]!==undefined;if(hasProp&&typeof from[prop]==='object'){socialite.extendObject(to[prop],from[prop],overwrite);}else if(overwrite||!hasProp){to[prop]=from[prop];}}},getElements:function(context,cn)
{var i=0,el=[],gcn=!!context.getElementsByClassName,all=gcn?context.getElementsByClassName(cn):context.getElementsByTagName('*');for(;i<all.length;i++){if(gcn||socialite.hasClass(all[i],cn)){el.push(all[i]);}}
return el;},getDataAttributes:function(el,noprefix,nostr)
{var i=0,str='',obj={},attr=el.attributes;for(;i<attr.length;i++){var key=attr[i].name,val=attr[i].value;if(val.length&&key.indexOf('data-')===0){if(noprefix){key=key.substring(5);}
if(nostr){obj[key]=val;}else{str+=euc(key)+'='+euc(val)+'&';}}}
return nostr?obj:str;},copyDataAttributes:function(from,to,noprefix,nohyphen)
{var attr=socialite.getDataAttributes(from,noprefix,true);for(var i in attr){to.setAttribute(nohyphen?i.replace(/-/g,'_'):i,attr[i]);}},createIframe:function(src,instance)
{var iframe=document.createElement('iframe');iframe.style.cssText='overflow: hidden; border: none;';socialite.extendObject(iframe,{src:src,allowtransparency:'true',frameborder:'0',scrolling:'no'},true);if(instance){iframe.onload=iframe.onreadystatechange=function()
{if(rstate.test(iframe.readyState||'')){iframe.onload=iframe.onreadystatechange=null;socialite.activateInstance(instance);}};}
return iframe;},networkReady:function(name)
{return networks[name]?networks[name].loaded:undefined;},appendNetwork:function(network)
{if(!network||network.appended){return;}
if(typeof network.append==='function'&&network.append(network)===false){network.appended=network.loaded=true;socialite.activateAll(network);return;}
if(network.script){network.el=document.createElement('script');socialite.extendObject(network.el,network.script,true);network.el.async=true;network.el.onload=network.el.onreadystatechange=function()
{if(rstate.test(network.el.readyState||'')){network.el.onload=network.el.onreadystatechange=null;network.loaded=true;if(typeof network.onload==='function'&&network.onload(network)===false){return;}
socialite.activateAll(network);}};document.body.appendChild(network.el);}
network.appended=true;},removeNetwork:function(network)
{if(!socialite.networkReady(network.name)){return false;}
network.el.parentNode.removeChild(network.el);return!(network.appended=network.loaded=false);},reloadNetwork:function(name)
{var network=networks[name];if(network&&socialite.removeNetwork(network)){socialite.appendNetwork(network);}},createInstance:function(el,widget)
{var proceed=true,instance={el:el,uid:uid++,widget:widget};instances.push(instance);if(widget.process!==undefined){proceed=(typeof widget.process==='function')?widget.process(instance):false;}
if(proceed){socialite.processInstance(instance);}
instance.el.setAttribute('data-socialite',instance.uid);instance.el.className='socialite '+widget.name+' socialite-instance';return instance;},processInstance:function(instance)
{var el=instance.el;instance.el=document.createElement('div');instance.el.className=el.className;socialite.copyDataAttributes(el,instance.el);if(el.nodeName.toLowerCase()==='a'&&!el.getAttribute('data-default-href')){instance.el.setAttribute('data-default-href',el.getAttribute('href'));}
var parent=el.parentNode;parent.insertBefore(instance.el,el);parent.removeChild(el);},activateInstance:function(instance)
{if(instance&&!instance.loaded){instance.loaded=true;if(typeof instance.widget.activate==='function'){instance.widget.activate(instance);}
socialite.addClass(instance.el,'socialite-loaded');return instance.onload?instance.onload(instance.el):null;}},activateAll:function(network)
{if(typeof network==='string'){network=networks[network];}
for(var i=0;i<instances.length;i++){var instance=instances[i];if(instance.init&&instance.widget.network===network){socialite.activateInstance(instance);}}},load:function(context,el,w,onload,process)
{context=(context&&typeof context==='object'&&context.nodeType===1)?context:document;if(!el||typeof el!=='object'){socialite.load(context,socialite.getElements(context,'socialite'),w,onload,process);return;}
var i;if(/Array/.test(Object.prototype.toString.call(el))){for(i=0;i<el.length;i++){socialite.load(context,el[i],w,onload,process);}
return;}
if(el.nodeType!==1){return;}
if(!w||!widgets[w]){w=null;var classes=el.className.split(' ');for(i=0;i<classes.length;i++){if(widgets[classes[i]]){w=classes[i];break;}}
if(!w){return;}}
var instance,widget=widgets[w],sid=parseInt(el.getAttribute('data-socialite'),10);if(!isNaN(sid)){for(i=0;i<instances.length;i++){if(instances[i].uid===sid){instance=instances[i];break;}}}else{instance=socialite.createInstance(el,widget);}
if(process||!instance){return;}
if(!instance.init){instance.init=true;instance.onload=(typeof onload==='function')?onload:null;widget.init(instance);}
if(!widget.network.appended){socialite.appendNetwork(widget.network);}else{if(socialite.networkReady(widget.network.name)){socialite.activateInstance(instance);}}},activate:function(el,w,onload)
{window.Socialite.load(null,el,w,onload);},process:function(context,el,w)
{window.Socialite.load(context,el,w,null,true);},network:function(n,params)
{networks[n]={name:n,el:null,appended:false,loaded:false,widgets:{}};if(params){socialite.extendObject(networks[n],params);}},widget:function(n,w,params)
{params.name=n+'-'+w;if(!networks[n]||widgets[params.name]){return;}
params.network=networks[n];networks[n].widgets[w]=widgets[params.name]=params;},setup:function(params)
{socialite.extendObject(socialite.settings,params,true);}};return socialite;})(window,window.document);(function(window,document,Socialite,undefined)
{Socialite.setup({facebook:{lang:'en_GB',appId:null},twitter:{lang:'en'},googleplus:{lang:'en-GB'}});Socialite.network('facebook',{script:{src:'//connect.facebook.net/{{language}}/all.js',id:'facebook-jssdk'},append:function(network)
{var fb=document.createElement('div'),settings=Socialite.settings.facebook,events={onlike:'edge.create',onunlike:'edge.remove',onsend:'message.send'};fb.id='fb-root';document.body.appendChild(fb);network.script.src=network.script.src.replace('{{language}}',settings.lang);window.fbAsyncInit=function(){window.FB.init({appId:settings.appId,xfbml:true});for(var e in events){if(typeof settings[e]==='function'){window.FB.Event.subscribe(events[e],settings[e]);}}};}});Socialite.widget('facebook','like',{init:function(instance)
{var el=document.createElement('div');el.className='fb-like';Socialite.copyDataAttributes(instance.el,el);instance.el.appendChild(el);if(window.FB&&window.FB.XFBML){window.FB.XFBML.parse(instance.el);}}});Socialite.network('twitter',{script:{src:'//platform.twitter.com/widgets.js',id:'twitter-wjs',charset:'utf-8'},append:function()
{var notwttr=(typeof window.twttr!=='object'),settings=Socialite.settings.twitter,events=['click','tweet','retweet','favorite','follow'];if(notwttr){window.twttr=(t={_e:[],ready:function(f){t._e.push(f);}});}
window.twttr.ready(function(twttr)
{for(var i=0;i<events.length;i++){var e=events[i];if(typeof settings['on'+e]==='function'){twttr.events.bind(e,settings['on'+e]);}}
Socialite.activateAll('twitter');});return notwttr;}});var twitterInit=function(instance)
{var el=document.createElement('a');el.className=instance.widget.name+'-button';Socialite.copyDataAttributes(instance.el,el);el.setAttribute('href',instance.el.getAttribute('data-default-href'));el.setAttribute('data-lang',instance.el.getAttribute('data-lang')||Socialite.settings.twitter.lang);instance.el.appendChild(el);};var twitterActivate=function(instance)
{if(window.twttr&&typeof window.twttr.widgets==='object'&&typeof window.twttr.widgets.load==='function'){window.twttr.widgets.load();}};Socialite.widget('twitter','share',{init:twitterInit,activate:twitterActivate});Socialite.widget('twitter','follow',{init:twitterInit,activate:twitterActivate});Socialite.widget('twitter','hashtag',{init:twitterInit,activate:twitterActivate});Socialite.widget('twitter','mention',{init:twitterInit,activate:twitterActivate});Socialite.widget('twitter','embed',{process:function(instance)
{instance.innerEl=instance.el;if(!instance.innerEl.getAttribute('data-lang')){instance.innerEl.setAttribute('data-lang',Socialite.settings.twitter.lang);}
instance.el=document.createElement('div');instance.el.className=instance.innerEl.className;instance.innerEl.className='';instance.innerEl.parentNode.insertBefore(instance.el,instance.innerEl);instance.el.appendChild(instance.innerEl);},init:function(instance)
{instance.innerEl.className='twitter-tweet';},activate:twitterActivate});Socialite.network('googleplus',{script:{src:'//apis.google.com/js/plusone.js'},append:function(network)
{if(window.gapi){return false;}
window.___gcfg={lang:Socialite.settings.googleplus.lang,parsetags:'explicit'};}});var googleplusInit=function(instance)
{var el=document.createElement('div');el.className='g-'+instance.widget.gtype;Socialite.copyDataAttributes(instance.el,el);instance.el.appendChild(el);instance.gplusEl=el;};var googleplusEvent=function(instance,callback){return(typeof callback!=='function')?null:function(data){callback(instance.el,data);};};var googleplusActivate=function(instance)
{var type=instance.widget.gtype;if(window.gapi&&window.gapi[type]){var settings=Socialite.settings.googleplus,params=Socialite.getDataAttributes(instance.el,true,true),events=['onstartinteraction','onendinteraction','callback'];for(var i=0;i<events.length;i++){params[events[i]]=googleplusEvent(instance,settings[events[i]]);}
window.gapi[type].render(instance.gplusEl,params);}};Socialite.widget('googleplus','one',{init:googleplusInit,activate:googleplusActivate,gtype:'plusone'});Socialite.widget('googleplus','share',{init:googleplusInit,activate:googleplusActivate,gtype:'plus'});Socialite.widget('googleplus','badge',{init:googleplusInit,activate:googleplusActivate,gtype:'plus'});Socialite.network('linkedin',{script:{src:'//platform.linkedin.com/in.js'}});var linkedinInit=function(instance)
{var el=document.createElement('script');el.type='IN/'+instance.widget.intype;Socialite.copyDataAttributes(instance.el,el);instance.el.appendChild(el);if(typeof window.IN==='object'&&typeof window.IN.parse==='function'){window.IN.parse(instance.el);Socialite.activateInstance(instance);}};Socialite.widget('linkedin','share',{init:linkedinInit,intype:'Share'});Socialite.widget('linkedin','recommend',{init:linkedinInit,intype:'RecommendProduct'});})(window,window.document,window.Socialite);(function(){var s=window._socialite;if(/Array/.test(Object.prototype.toString.call(s))){for(var i=0,len=s.length;i<len;i++){if(typeof s[i]==='function'){s[i]();}}}})();
!function(window,document,undefined){var prefixes=['webkit','Moz','ms','O'],animations={},useCssAnimations
function createEl(tag,prop){var el=document.createElement(tag||'div'),n
for(n in prop)el[n]=prop[n]
return el}
function ins(parent){for(var i=1,n=arguments.length;i<n;i++)
parent.appendChild(arguments[i])
return parent}
var sheet=function(){var el=createEl('style',{type:'text/css'})
ins(document.getElementsByTagName('head')[0],el)
return el.sheet||el.styleSheet}()
function addAnimation(alpha,trail,i,lines){var name=['opacity',trail,~~(alpha*100),i,lines].join('-'),start=0.01+i/lines*100,z=Math.max(1-(1-alpha)/trail*(100-start),alpha),prefix=useCssAnimations.substring(0,useCssAnimations.indexOf('Animation')).toLowerCase(),pre=prefix&&'-'+prefix+'-'||''
if(!animations[name]){sheet.insertRule('@'+pre+'keyframes '+name+'{'+'0%{opacity:'+z+'}'+
start+'%{opacity:'+alpha+'}'+
(start+0.01)+'%{opacity:1}'+
(start+trail)%100+'%{opacity:'+alpha+'}'+'100%{opacity:'+z+'}'+'}',sheet.cssRules.length)
animations[name]=1}
return name}
function vendor(el,prop){var s=el.style,pp,i
if(s[prop]!==undefined)return prop
prop=prop.charAt(0).toUpperCase()+prop.slice(1)
for(i=0;i<prefixes.length;i++){pp=prefixes[i]+prop
if(s[pp]!==undefined)return pp}}
function css(el,prop){for(var n in prop)
el.style[vendor(el,n)||n]=prop[n]
return el}
function merge(obj){for(var i=1;i<arguments.length;i++){var def=arguments[i]
for(var n in def)
if(obj[n]===undefined)obj[n]=def[n]}
return obj}
function pos(el){var o={x:el.offsetLeft,y:el.offsetTop}
while((el=el.offsetParent))
o.x+=el.offsetLeft,o.y+=el.offsetTop
return o}
var defaults={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:'#000',speed:1,trail:100,opacity:1/4,fps:20,zIndex:2e9,className:'spinner',top:'auto',left:'auto',position:'relative'}
var Spinner=function Spinner(o){if(!this.spin)return new Spinner(o)
this.opts=merge(o||{},Spinner.defaults,defaults)}
Spinner.defaults={}
merge(Spinner.prototype,{spin:function(target){this.stop()
var self=this,o=self.opts,el=self.el=css(createEl(0,{className:o.className}),{position:o.position,width:0,zIndex:o.zIndex}),mid=o.radius+o.length+o.width,ep,tp
if(target){target.insertBefore(el,target.firstChild||null)
tp=pos(target)
ep=pos(el)
css(el,{left:(o.left=='auto'?tp.x-ep.x+(target.offsetWidth>>1):parseInt(o.left,10)+mid)+'px',top:(o.top=='auto'?tp.y-ep.y+(target.offsetHeight>>1):parseInt(o.top,10)+mid)+'px'})}
el.setAttribute('aria-role','progressbar')
self.lines(el,self.opts)
if(!useCssAnimations){var i=0,fps=o.fps,f=fps/o.speed,ostep=(1-o.opacity)/(f*o.trail/100),astep=f/o.lines;(function anim(){i++;for(var s=o.lines;s;s--){var alpha=Math.max(1-(i+s*astep)%f*ostep,o.opacity)
self.opacity(el,o.lines-s,alpha,o)}
self.timeout=self.el&&setTimeout(anim,~~(1000/fps))})()}
return self},stop:function(){var el=this.el
if(el){clearTimeout(this.timeout)
if(el.parentNode)el.parentNode.removeChild(el)
this.el=undefined}
return this},lines:function(el,o){var i=0,seg
function fill(color,shadow){return css(createEl(),{position:'absolute',width:(o.length+o.width)+'px',height:o.width+'px',background:color,boxShadow:shadow,transformOrigin:'left',transform:'rotate('+~~(360/o.lines*i+o.rotate)+'deg) translate('+o.radius+'px'+',0)',borderRadius:(o.corners*o.width>>1)+'px'})}
for(;i<o.lines;i++){seg=css(createEl(),{position:'absolute',top:1+~(o.width/2)+'px',transform:o.hwaccel?'translate3d(0,0,0)':'',opacity:o.opacity,animation:useCssAnimations&&addAnimation(o.opacity,o.trail,i,o.lines)+' '+1/o.speed+'s linear infinite'})
if(o.shadow)ins(seg,css(fill('#000','0 0 4px '+'#000'),{top:2+'px'}))
ins(el,ins(seg,fill(o.color,'0 0 1px rgba(0,0,0,.1)')))}
return el},opacity:function(el,i,val){if(i<el.childNodes.length)el.childNodes[i].style.opacity=val}});(function(){function vml(tag,attr){return createEl('<'+tag+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',attr)}
var s=css(createEl('group'),{behavior:'url(#default#VML)'})
if(!vendor(s,'transform')&&s.adj){sheet.addRule('.spin-vml','behavior:url(#default#VML)')
Spinner.prototype.lines=function(el,o){var r=o.length+o.width,s=2*r
function grp(){return css(vml('group',{coordsize:s+' '+s,coordorigin:-r+' '+-r}),{width:s,height:s})}
var margin=-(o.width+o.length)*2+'px',g=css(grp(),{position:'absolute',top:margin,left:margin}),i
function seg(i,dx,filter){ins(g,ins(css(grp(),{rotation:360/o.lines*i+'deg',left:~~dx}),ins(css(vml('roundrect',{arcsize:o.corners}),{width:r,height:o.width,left:o.radius,top:-o.width>>1,filter:filter}),vml('fill',{color:o.color,opacity:o.opacity}),vml('stroke',{opacity:0}))))}
if(o.shadow)
for(i=1;i<=o.lines;i++)
seg(i,-2,'progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)')
for(i=1;i<=o.lines;i++)seg(i)
return ins(el,g)}
Spinner.prototype.opacity=function(el,i,val,o){var c=el.firstChild
o=o.shadow&&o.lines||0
if(c&&i+o<c.childNodes.length){c=c.childNodes[i+o];c=c&&c.firstChild;c=c&&c.firstChild
if(c)c.opacity=val}}}
else
useCssAnimations=vendor(s,'animation')})()
if(typeof define=='function'&&define.amd)
define(function(){return Spinner})
else
window.Spinner=Spinner}(window,document);(function($){$.fn.spin=function(opts,color){var presets={"tiny":{lines:8,length:2,width:2,radius:3},"small":{lines:8,length:4,width:3,radius:5},"large":{lines:10,length:8,width:4,radius:8}};if(Spinner){return this.each(function(){var $this=$(this),data=$this.data();if(data.spinner){data.spinner.stop();delete data.spinner;}
if(opts!==false){if(typeof opts==="string"){if(opts in presets){opts=presets[opts];}else{opts={};}
if(color){opts.color=color;}}
data.spinner=new Spinner($.extend({color:$this.css('color')},opts)).spin(this);}});}else{throw"Spinner class not available.";}};})(jQuery);
function printStackTrace(options){options=options||{guess:true};var ex=options.e||null,guess=!!options.guess;var p=new printStackTrace.implementation(),result=p.run(ex);return(guess)?p.guessAnonymousFunctions(result):result;}
printStackTrace.implementation=function(){};printStackTrace.implementation.prototype={run:function(ex,mode){ex=ex||this.createException();mode=mode||this.mode(ex);if(mode==='other'){return this.other(arguments.callee);}else{return this[mode](ex);}},createException:function(){try{this.undef();}catch(e){return e;}},mode:function(e){if(e['arguments']&&e.stack){return'chrome';}else if(e.stack&&e.sourceURL){return'safari';}else if(typeof e.message==='string'&&typeof window!=='undefined'&&window.opera){if(!e.stacktrace){return'opera9';}
if(e.message.indexOf('\n')>-1&&e.message.split('\n').length>e.stacktrace.split('\n').length){return'opera9';}
if(!e.stack){return'opera10a';}
if(e.stacktrace.indexOf("called from line")<0){return'opera10b';}
return'opera11';}else if(e.stack){return'firefox';}
return'other';},instrumentFunction:function(context,functionName,callback){context=context||window;var original=context[functionName];context[functionName]=function instrumented(){callback.call(this,printStackTrace().slice(4));return context[functionName]._instrumented.apply(this,arguments);};context[functionName]._instrumented=original;},deinstrumentFunction:function(context,functionName){if(context[functionName].constructor===Function&&context[functionName]._instrumented&&context[functionName]._instrumented.constructor===Function){context[functionName]=context[functionName]._instrumented;}},chrome:function(e){var stack=(e.stack+'\n').replace(/^\S[^\(]+?[\n$]/gm,'').replace(/^\s+(at eval )?at\s+/gm,'').replace(/^([^\(]+?)([\n$])/gm,'{anonymous}()@$1$2').replace(/^Object.<anonymous>\s*\(([^\)]+)\)/gm,'{anonymous}()@$1').split('\n');stack.pop();return stack;},safari:function(e){return e.stack.replace(/\[native code\]\n/m,'').replace(/^@/gm,'{anonymous}()@').split('\n');},firefox:function(e){return e.stack.replace(/(?:\n@:0)?\s+$/m,'').replace(/^[\(@]/gm,'{anonymous}()@').split('\n');},opera11:function(e){var ANON='{anonymous}',lineRE=/^.*line (\d+), column (\d+)(?: in (.+))? in (\S+):$/;var lines=e.stacktrace.split('\n'),result=[];for(var i=0,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){var location=match[4]+':'+match[1]+':'+match[2];var fnName=match[3]||"global code";fnName=fnName.replace(/<anonymous function: (\S+)>/,"$1").replace(/<anonymous function>/,ANON);result.push(fnName+'@'+location+' -- '+lines[i+1].replace(/^\s+/,''));}}
return result;},opera10b:function(e){var lineRE=/^(.*)@(.+):(\d+)$/;var lines=e.stacktrace.split('\n'),result=[];for(var i=0,len=lines.length;i<len;i++){var match=lineRE.exec(lines[i]);if(match){var fnName=match[1]?(match[1]+'()'):"global code";result.push(fnName+'@'+match[2]+':'+match[3]);}}
return result;},opera10a:function(e){var ANON='{anonymous}',lineRE=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i;var lines=e.stacktrace.split('\n'),result=[];for(var i=0,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){var fnName=match[3]||ANON;result.push(fnName+'()@'+match[2]+':'+match[1]+' -- '+lines[i+1].replace(/^\s+/,''));}}
return result;},opera9:function(e){var ANON='{anonymous}',lineRE=/Line (\d+).*script (?:in )?(\S+)/i;var lines=e.message.split('\n'),result=[];for(var i=2,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){result.push(ANON+'()@'+match[2]+':'+match[1]+' -- '+lines[i+1].replace(/^\s+/,''));}}
return result;},other:function(curr){var ANON='{anonymous}',fnRE=/function\s*([\w\-$]+)?\s*\(/i,stack=[],fn,args,maxStackSize=10;while(curr&&curr['arguments']&&stack.length<maxStackSize){fn=fnRE.test(curr.toString())?RegExp.$1||ANON:ANON;args=Array.prototype.slice.call(curr['arguments']||[]);stack[stack.length]=fn+'('+this.stringifyArguments(args)+')';curr=curr.caller;}
return stack;},stringifyArguments:function(args){var result=[];var slice=Array.prototype.slice;for(var i=0;i<args.length;++i){var arg=args[i];if(arg===undefined){result[i]='undefined';}else if(arg===null){result[i]='null';}else if(arg.constructor){if(arg.constructor===Array){if(arg.length<3){result[i]='['+this.stringifyArguments(arg)+']';}else{result[i]='['+this.stringifyArguments(slice.call(arg,0,1))+'...'+this.stringifyArguments(slice.call(arg,-1))+']';}}else if(arg.constructor===Object){result[i]='#object';}else if(arg.constructor===Function){result[i]='#function';}else if(arg.constructor===String){result[i]='"'+arg+'"';}else if(arg.constructor===Number){result[i]=arg;}}}
return result.join(',');},sourceCache:{},ajax:function(url){var req=this.createXMLHTTPObject();if(req){try{req.open('GET',url,false);req.send(null);return req.responseText;}catch(e){}}
return'';},createXMLHTTPObject:function(){var xmlhttp,XMLHttpFactories=[function(){return new XMLHttpRequest();},function(){return new ActiveXObject('Msxml2.XMLHTTP');},function(){return new ActiveXObject('Msxml3.XMLHTTP');},function(){return new ActiveXObject('Microsoft.XMLHTTP');}];for(var i=0;i<XMLHttpFactories.length;i++){try{xmlhttp=XMLHttpFactories[i]();this.createXMLHTTPObject=XMLHttpFactories[i];return xmlhttp;}catch(e){}}},isSameDomain:function(url){return typeof location!=="undefined"&&url.indexOf(location.hostname)!==-1;},getSource:function(url){if(!(url in this.sourceCache)){this.sourceCache[url]=this.ajax(url).split('\n');}
return this.sourceCache[url];},guessAnonymousFunctions:function(stack){for(var i=0;i<stack.length;++i){var reStack=/\{anonymous\}\(.*\)@(.*)/,reRef=/^(.*?)(?::(\d+))(?::(\d+))?(?: -- .+)?$/,frame=stack[i],ref=reStack.exec(frame);if(ref){var m=reRef.exec(ref[1]);if(m){var file=m[1],lineno=m[2],charno=m[3]||0;if(file&&this.isSameDomain(file)&&lineno){var functionName=this.guessAnonymousFunction(file,lineno,charno);stack[i]=frame.replace('{anonymous}',functionName);}}}}
return stack;},guessAnonymousFunction:function(url,lineNo,charNo){var ret;try{ret=this.findFunctionName(this.getSource(url),lineNo);}catch(e){ret='getSource failed with url: '+url+', exception: '+e.toString();}
return ret;},findFunctionName:function(source,lineNo){var reFunctionDeclaration=/function\s+([^(]*?)\s*\(([^)]*)\)/;var reFunctionExpression=/['"]?([0-9A-Za-z_]+)['"]?\s*[:=]\s*function\b/;var reFunctionEvaluation=/['"]?([0-9A-Za-z_]+)['"]?\s*[:=]\s*(?:eval|new Function)\b/;var code="",line,maxLines=Math.min(lineNo,20),m,commentPos;for(var i=0;i<maxLines;++i){line=source[lineNo-i-1];commentPos=line.indexOf('//');if(commentPos>=0){line=line.substr(0,commentPos);}
if(line){code=line+code;m=reFunctionExpression.exec(code);if(m&&m[1]){return m[1];}
m=reFunctionDeclaration.exec(code);if(m&&m[1]){return m[1];}
m=reFunctionEvaluation.exec(code);if(m&&m[1]){return m[1];}}}
return'(?)';}};;(function(){var store={},win=window,doc=win.document,localStorageName='localStorage',globalStorageName='globalStorage',namespace='__storejs__',storage
store.disabled=false
store.set=function(key,value){}
store.get=function(key){}
store.remove=function(key){}
store.clear=function(){}
store.transact=function(key,defaultVal,transactionFn){var val=store.get(key)
if(transactionFn==null){transactionFn=defaultVal
defaultVal=null}
if(typeof val=='undefined'){val=defaultVal||{}}
transactionFn(val)
store.set(key,val)}
store.getAll=function(){}
store.serialize=function(value){return JSON.stringify(value)}
store.deserialize=function(value){if(typeof value!='string'){return undefined}
try{return JSON.parse(value)}
catch(e){return value||undefined}}
function isLocalStorageNameSupported(){try{return(localStorageName in win&&win[localStorageName])}
catch(err){return false}}
function isGlobalStorageNameSupported(){try{return(globalStorageName in win&&win[globalStorageName]&&win[globalStorageName][win.location.hostname])}
catch(err){return false}}
if(isLocalStorageNameSupported()){storage=win[localStorageName]
store.set=function(key,val){if(val===undefined){return store.remove(key)}
storage.setItem(key,store.serialize(val))
return val}
store.get=function(key){return store.deserialize(storage.getItem(key))}
store.remove=function(key){storage.removeItem(key)}
store.clear=function(){storage.clear()}
store.getAll=function(){var ret={}
for(var i=0;i<storage.length;++i){var key=storage.key(i)
ret[key]=store.get(key)}
return ret}}else if(isGlobalStorageNameSupported()){storage=win[globalStorageName][win.location.hostname]
store.set=function(key,val){if(val===undefined){return store.remove(key)}
storage[key]=store.serialize(val)
return val}
store.get=function(key){return store.deserialize(storage[key]&&storage[key].value)}
store.remove=function(key){delete storage[key]}
store.clear=function(){for(var key in storage){delete storage[key]}}
store.getAll=function(){var ret={}
for(var i=0;i<storage.length;++i){var key=storage.key(i)
ret[key]=store.get(key)}
return ret}}else if(doc.documentElement.addBehavior){var storageOwner,storageContainer
try{storageContainer=new ActiveXObject('htmlfile')
storageContainer.open()
storageContainer.write('<s'+'cript>document.w=window</s'+'cript><iframe src="/favicon.ico"></frame>')
storageContainer.close()
storageOwner=storageContainer.w.frames[0].document
storage=storageOwner.createElement('div')}catch(e){storage=doc.createElement('div')
storageOwner=doc.body}
function withIEStorage(storeFunction){return function(){var args=Array.prototype.slice.call(arguments,0)
args.unshift(storage)
storageOwner.appendChild(storage)
storage.addBehavior('#default#userData')
storage.load(localStorageName)
var result=storeFunction.apply(store,args)
storageOwner.removeChild(storage)
return result}}
var forbiddenCharsRegex=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g")
function ieKeyFix(key){return key.replace(forbiddenCharsRegex,'___')}
store.set=withIEStorage(function(storage,key,val){key=ieKeyFix(key)
if(val===undefined){return store.remove(key)}
storage.setAttribute(key,store.serialize(val))
storage.save(localStorageName)
return val})
store.get=withIEStorage(function(storage,key){key=ieKeyFix(key)
return store.deserialize(storage.getAttribute(key))})
store.remove=withIEStorage(function(storage,key){key=ieKeyFix(key)
storage.removeAttribute(key)
storage.save(localStorageName)})
store.clear=withIEStorage(function(storage){var attributes=storage.XMLDocument.documentElement.attributes
storage.load(localStorageName)
for(var i=0,attr;attr=attributes[i];i++){storage.removeAttribute(attr.name)}
storage.save(localStorageName)})
store.getAll=withIEStorage(function(storage){var attributes=storage.XMLDocument.documentElement.attributes
storage.load(localStorageName)
var ret={}
for(var i=0,attr;attr=attributes[i];++i){ret[attr]=store.get(attr)}
return ret})}
try{store.set(namespace,namespace)
if(store.get(namespace)!=namespace){store.disabled=true}
store.remove(namespace)}catch(e){store.disabled=true}
store.enabled=!store.disabled
if(typeof module!='undefined'&&typeof module!='function'){module.exports=store}
else if(typeof define==='function'&&define.amd){define(store)}
else{this.store=store}})();
window.Swipe=function(element,options){var _this=this;if(!element)return;this.container=element;this.element=this.container.children[0];this.browser={touch:(function(){return('ontouchstart'in window)||window.DocumentTouch&&document instanceof DocumentTouch;})(),transitions:(function(){var temp=document.createElement('swipe'),props=['perspectiveProperty','WebkitPerspective','MozPerspective','OPerspective','msPerspective'];for(var i in props){if(temp.style[props[i]]!==undefined)return true;}
return false;})()};options=options||{};this.index=options.startSlide||0;this.speed=options.speed||300;this.callback=options.callback||function(){};this.transitionEnd=options.transitionEnd||function(){};this.delay=options.auto||0;this.cont=(options.continuous!=undefined)?!!options.continuous:true;this.disableScroll=!!options.disableScroll;this.index=parseInt(this.index,10);this.setup();this.begin();if(this.element.addEventListener){if(!!this.browser.touch){this.element.addEventListener('touchstart',this,false);this.element.addEventListener('touchmove',this,false);this.element.addEventListener('touchend',this,false);}
if(!!this.browser.transitions){this.element.addEventListener('webkitTransitionEnd',this,false);this.element.addEventListener('msTransitionEnd',this,false);this.element.addEventListener('oTransitionEnd',this,false);this.element.addEventListener('transitionend',this,false);}
window.addEventListener('resize',this,false);}
else{window.onresize=function(){_this.setup();};}};Swipe.prototype={setup:function(){this.slides=this.element.children;this.length=this.slides.length;this.cache=new Array(this.length);if(this.length<2)return;this.width=this.container.getBoundingClientRect().width||this.container.offsetWidth;if(!this.width)return;var refArray=[[],[],[]];this.element.style.width=(this.slides.length*this.width)+'px';for(var index=this.length-1;index>-1;index--){var elem=this.slides[index];elem.style.width=this.width+'px';elem.setAttribute('data-index',index);if(this.browser.transitions){elem.style.left=(index*-this.width)+'px';}
refArray[this.index>index?0:(this.index<index?2:1)].push(index);}
if(this.browser.transitions){this._stack(refArray[0],-1);this._stack(refArray[1],0);this._stack(refArray[2],1);}
this.container.style.visibility='visible';},kill:function(){this.delay=0;clearTimeout(this.interval);var slideArray=[];for(var i=this.slides.length-1;i>=0;i--){this.slides[i].style.width='';slideArray.push(i);}
this._stack(slideArray,0);var elem=this.element;elem.className=elem.className.replace('swipe-active','');if(this.element.removeEventListener){if(!!this.browser.touch){this.element.removeEventListener('touchstart',this,false);this.element.removeEventListener('touchmove',this,false);this.element.removeEventListener('touchend',this,false);}
if(!!this.browser.transitions){this.element.removeEventListener('webkitTransitionEnd',this,false);this.element.removeEventListener('msTransitionEnd',this,false);this.element.removeEventListener('oTransitionEnd',this,false);this.element.removeEventListener('transitionend',this,false);}
window.removeEventListener('resize',this.resize,false);}
else{window.onresize=null;}},getPos:function(){return this.index;},prev:function(delay){this.delay=delay||0;clearTimeout(this.interval);if(this.index)this.slide(this.index-1,this.speed);else if(this.cont)this.slide(this.length-1,this.speed);},next:function(delay){this.delay=delay||0;clearTimeout(this.interval);if(this.index<this.length-1)this.slide(this.index+1,this.speed);else if(this.cont)this.slide(0,this.speed);},begin:function(){var _this=this;this.interval=(this.delay)?setTimeout(function(){_this.next(_this.delay);},this.delay):0;},handleEvent:function(e){switch(e.type){case'touchstart':this.onTouchStart(e);break;case'touchmove':this.onTouchMove(e);break;case'touchend':this.onTouchEnd(e);break;case'webkitTransitionEnd':case'msTransitionEnd':case'oTransitionEnd':case'transitionend':this.onTransitionEnd(e);break;case'resize':this.setup();break;}
e.stopPropagation();},onTouchStart:function(e){var _this=this;_this.start={pageX:e.touches[0].pageX,pageY:e.touches[0].pageY,time:Number(new Date())};_this.isScrolling=undefined;_this.deltaX=0;},onTouchMove:function(e){var _this=this;if(e.touches.length>1||e.scale&&e.scale!==1)return;_this.deltaX=e.touches[0].pageX-_this.start.pageX;if(typeof _this.isScrolling=='undefined'){_this.isScrolling=!!(_this.isScrolling||Math.abs(_this.deltaX)<Math.abs(e.touches[0].pageY-_this.start.pageY));}
if(!_this.isScrolling){e.preventDefault();_this.delay=0;clearTimeout(_this.interval);_this.deltaX=_this.deltaX/((!_this.index&&_this.deltaX>0||_this.index==_this.length-1&&_this.deltaX<0)?(Math.abs(_this.deltaX)/_this.width+1):1);_this._move([_this.index-1,_this.index,_this.index+1],_this.deltaX);}else if(_this.disableScroll){e.preventDefault();}},onTouchEnd:function(e){var _this=this;var isValidSlide=Number(new Date())-_this.start.time<250&&Math.abs(_this.deltaX)>20||Math.abs(_this.deltaX)>_this.width/2,isPastBounds=!_this.index&&_this.deltaX>0||_this.index==_this.length-1&&_this.deltaX<0,direction=_this.deltaX<0;if(!_this.isScrolling){if(isValidSlide&&!isPastBounds){if(direction){_this._stack([_this.index-1],-1);_this._slide([_this.index,_this.index+1],-_this.width,_this.speed);_this.index+=1;}else{_this._stack([_this.index+1],1);_this._slide([_this.index-1,_this.index],_this.width,_this.speed);_this.index+=-1;}
_this.callback(_this.index,_this.slides[_this.index]);}else{_this._slide([_this.index-1,_this.index,_this.index+1],0,_this.speed);}}},onTransitionEnd:function(e){if(this._getElemIndex(e.target)==this.index){if(this.delay)this.begin();this.transitionEnd(this.index,this.slides[this.index]);}},slide:function(to,speed){var from=this.index;if(from==to)return;if(this.browser.transitions){var toStack=Math.abs(from-to)-1,direction=Math.abs(from-to)/(from-to),inBetween=[];while(toStack--)inBetween.push((to>from?to:from)-toStack-1);this._stack(inBetween,direction);this._slide([from,to],this.width*direction,this.speed);}
else{this._animate(from*-this.width,to*-this.width,this.speed)}
this.index=to;this.callback(this.index,this.slides[this.index]);},_slide:function(nums,dist,speed){var _slides=this.slides,l=nums.length;while(l--){this._translate(_slides[nums[l]],dist+this.cache[nums[l]],speed?speed:0);this.cache[nums[l]]+=dist;}},_stack:function(nums,pos){var _slides=this.slides,l=nums.length,dist=this.width*pos;while(l--){this._translate(_slides[nums[l]],dist,0);this.cache[nums[l]]=dist;}},_move:function(nums,dist){var _slides=this.slides,l=nums.length;while(l--)this._translate(_slides[nums[l]],dist+this.cache[nums[l]],0);},_translate:function(elem,xval,speed){if(!elem)return;var style=elem.style;style.webkitTransitionDuration=style.MozTransitionDuration=style.msTransitionDuration=style.OTransitionDuration=style.transitionDuration=speed+'ms';style.webkitTransform='translate('+xval+'px,0)'+'translateZ(0)';style.msTransform=style.MozTransform=style.OTransform='translateX('+xval+'px)';},_animate:function(from,to,speed){var elem=this.element;if(!speed){elem.style.left=to+'px';return;}
var _this=this,start=new Date(),timer=setInterval(function(){var timeElap=new Date()-start;if(timeElap>speed){elem.style.left=to+'px';if(_this._getElemIndex(elem)==_this.index){if(_this.delay)_this.begin();_this.transitionEnd(_this.index,_this.slides[_this.index]);}
clearInterval(timer);return;}
elem.style.left=(((to-from)*(Math.floor((timeElap/speed)*100)/100))+from)+'px';},4);},_getElemIndex:function(elem){return parseInt(elem.getAttribute('data-index'),10);}};if(window.jQuery||window.Zepto){(function($){$.fn.Swipe=function(params){return this.each(function(){var _this=$(this);_this.data('Swipe',new Swipe(_this[0],params));});}})(window.jQuery||window.Zepto)}
if(window.XDomainRequest){jQuery.ajaxTransport(function(s){if(s.crossDomain&&s.async){if(s.timeout){s.xdrTimeout=s.timeout;delete s.timeout;}
var xdr;return{send:function(_,complete){function callback(status,statusText,responses,responseHeaders){xdr.onload=xdr.onerror=xdr.ontimeout=jQuery.noop;xdr=undefined;complete(status,statusText,responses,responseHeaders);}
xdr=new XDomainRequest();xdr.onload=function(){0
0
callback(200,"OK",{text:xdr.responseText},"Content-Type: "+xdr.contentType);};xdr.onerror=function(){callback(404,"Not Found");};xdr.onprogress=jQuery.noop;xdr.ontimeout=function(){callback(0,"timeout");};xdr.timeout=s.xdrTimeout||Number.MAX_VALUE;xdr.open(s.type,s.url);xdr.send((s.hasContent&&s.data)||null);},abort:function(){if(xdr){xdr.onerror=jQuery.noop;xdr.abort();}}};}});}
window.require.define({"application":function(exports,require,module){(function(){var Application,AuthController,Chaplin,Dispatcher,LayoutController,LinksController,avosConfig,logger,mediator,routes,__bind=function(fn,me){return function(){return fn.apply(me,arguments);};},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};AuthController=require('controllers/auth_controller');avosConfig=require('lib/avos');Chaplin=require('chaplin');LayoutController=require('controllers/layout_controller');LinksController=require('controllers/links_controller');logger=require('lib/logger');mediator=require('mediator');Dispatcher=require('chaplin').Dispatcher;routes=require('routes');module.exports=Application=(function(_super){__extends(Application,_super);function Application(){this.initApp=__bind(this.initApp,this);return Application.__super__.constructor.apply(this,arguments);}
Application.prototype.title='Delicious';Application.prototype.initialize=function(){Application.__super__.initialize.apply(this,arguments);this.dispatcher=mediator.dispatcher=new Dispatcher({controllerSuffix:'_controller'});this._csrf=$('meta[name="_csrf"]').attr('content');mediator.app={bulkEditActive:false};mediator.retryCounter={};$.ajaxSetup(avosConfig.ajax.options);logger.set(avosConfig.logging);this.initTemplateHelpers();this.auth=new AuthController();this.initLayout();if(this.auth.isPreviouslyAuthenticated()){this.auth.loginSilent().done(this.initApp);}else{this.initApp();}
return yepnope({test:window.JSON,nope:'js/json2.js'});};Application.prototype.initApp=function(){new LinksController();this.initRouter(routes);new LayoutController();mediator.on('!router:route',function(){mediator.retryCounter={};return this.trackPageView;});return typeof Object.freeze==="function"?Object.freeze(this):void 0;};Application.prototype.initLayout=function(params){var Layout,_ref;if(params==null){params={};}
Layout=require('views/layout');if((_ref=params.title)==null){params.title=this.title;}
params.skipRouting='.noscript, .question';return this.layout=mediator.layout=new Layout(params);};Application.prototype.initTemplateHelpers=function(){require('templates/helpers/common');require('templates/helpers/link_helpers');return require('templates/helpers/user_helpers');};Application.prototype.trackPageView=function(uri){return _gaq.push(['_trackPageview',uri]);};return Application;})(Chaplin.Application);}).call(this);}});
window.require.define({"initialize":function(exports,require,module){(function(){var Application;Application=require('application');$(function(){var app;0;app=new Application;return app.initialize();});}).call(this);}});
window.require.define({"mediator":function(exports,require,module){(function(){module.exports=require('chaplin').mediator;}).call(this);}});
window.require.define({"routes":function(exports,require,module){(function(){module.exports=function(match){var routes;routes={'':'home#index','join':'onboarding#join','join/:section':'onboarding#join','signin':'auth#signin','save':'bookmarklet#save','post':'bookmarklet#save','help/quicktour/chrome':'plain#chrome','settings/:subpage/:section':'users#settings','settings/:subpage':'users#settings','settings':'users#settings','discover':'search#discover','search':'search#consolidated','tag/:tags/search':'search#consolidated','tag/:tags':'search#consolidated','url/:md5':'search#link','network':'search#network','network/:username':'search#network','network/:username/search':'search#network','network/:username/:tags/search':'search#network','network/:username/tag/:tags':'search#network','about':'plain#about','tools':['html#page',{params:{page:'tools'}}],'help':['html#page',{params:{page:'help'}}],'help/:questionid':['html#page',{params:{page:'help'}}],'terms':['html#page',{params:{page:'terms'}}],'terms-update':['html#page',{params:{page:'terms-update'}}],'privacy':['html#page',{params:{page:'privacy'}}],'copyright':['html#page',{params:{page:'copyright'}}],'developers':['html#page',{params:{page:'developers'}}],'developers/:questionid':['html#page',{params:{page:'developers'}}],'upgradebrowser':['html#page',{params:{page:'upgradebrowser'}}],'redirect_warn':'links#redirectWarn','validate/:token':'users#validateEmail','undefined':'oops#notfound','notfound':'oops#notfound','somethingwentwrong':'oops#somethingwentwrong',':username/search':'search#profile',':username/tag_bundle/:tagBundle':'search#profile',':username/:tags/search':'search#profile',':username/:tags':'search#profile',':username':'search#profile'};return _.each(routes,function(params,path){var pathWithoutTrailingSlash,paths;pathWithoutTrailingSlash=path.replace(/\/$/,'');paths=[pathWithoutTrailingSlash];if(pathWithoutTrailingSlash.length>0){paths.unshift(pathWithoutTrailingSlash+'/');}
return _.each(paths,function(route){if(_.isArray(params)){return match(route,_.first(params),_.rest(params)[0]);}else{return match(route,params);}});});};}).call(this);}});
window.require.define({"controllers/auth_controller":function(exports,require,module){(function(){var AuthController,Controller,LoginView,User,logger,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};Controller=require('lib/controller');logger=require('lib/logger');mediator=require('mediator');User=require('models/user');LoginView=require('views/auth/login');module.exports=AuthController=(function(_super){__extends(AuthController,_super);function AuthController(){return AuthController.__super__.constructor.apply(this,arguments);}
AuthController.prototype.noRedirect=false;AuthController.prototype.initialize=function(){var data,_this=this;AuthController.__super__.initialize.apply(this,arguments);data=store.get('user');if(data){this.user=mediator.user=new User(data);}else{this.user=mediator.user=new User;}
this.subscribeEvent('auth:prompt',this.promptLogin);this.subscribeEvent('auth:failure',this.failure);this.subscribeEvent('auth:login',this.login);this.subscribeEvent('auth:loginsilent',this.loginSilent);return this.subscribeEvent('login:noRedirect',function(){return _this.noRedirect=true;});};AuthController.prototype.signin=function(){mediator.layout.toggleBanner(false);return new LoginView({closeOnXClick:false,closeOnBackgroundClick:false});};AuthController.prototype.promptLogin=function(options){return new LoginView(options);};AuthController.prototype.failure=function(res){logger.log("When making an API call, the authentication failed.",{res:res});store.remove('user');return this.logout();};AuthController.prototype.isPreviouslyAuthenticated=function(){return mediator.user.get('isLoggedIn');};AuthController.prototype.login=function(params,callback){var _this=this;logger.log("Attempting to authenticate user with the following:",{params:params});return this.user.login(params,function(user,err){if(typeof callback==="function"){if(err){return callback(user,err);}else{return callback(user);}}else{if(err){mediator.publish('login:error',user,err);}else{mediator.publish('login:success',user);if(!(_this.noRedirect&&user.get('username'))){_this.redirectTo(user.get('username'));}}
return $('.alert').remove();}});};AuthController.prototype.loginSilent=function(callback){logger.log("Attempting to silently authenticate the user:",{user:this.user.toJSON()});return this.user.loginSilent();};AuthController.prototype.logout=function(){var _this=this;return this.user.logout(function(){return _this.redirectTo('discover');});};return AuthController;})(Controller);}).call(this);}});
window.require.define({"controllers/bookmarklet_controller":function(exports,require,module){(function(){var BookmarkletController,Controller,Link,LinkEditModal,logger,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};Controller=require('lib/controller');Link=require('models/link');LinkEditModal=require('views/links/edit');logger=require('lib/logger');mediator=require('mediator');module.exports=BookmarkletController=(function(_super){__extends(BookmarkletController,_super);function BookmarkletController(){return BookmarkletController.__super__.constructor.apply(this,arguments);}
BookmarkletController.prototype.loginSuccess=false;BookmarkletController.prototype.initialize=function(params){var destroy,_this=this;BookmarkletController.__super__.initialize.apply(this,arguments);this.subscribeEvent('login:success',function(){return _this.loginSuccess=true;});destroy=_.once(this.destoryBookmarklet);this.subscribeEvent('editModal:dispose',destroy);return this.subscribeEvent('loginModal:dispose',function(){if(!_this.loginSuccess){return destroy();}});};BookmarkletController.prototype.save=function(params){var version,_this=this;version=params['v']||"The buggy version";logger.log("Opening the bookmarklet.",{version:version});this.newLink=new Link({title:params['title'],url:params['url'],note:params['note']});if(mediator.user.get('isLoggedIn')){return this.showModal();}else{return this.publishEvent('auth:prompt',{title:'Sign in to save this link',noRedirect:true,callback:function(){return _this.showModal();}});}};BookmarkletController.prototype.showModal=function(){var _this=this;this.editModal=new LinkEditModal({spinner:true,model:this.newLink});return this.newLink.getDetails(function(){var args;args={bookmarklet:true,redirect:true,editModal:_this.editModal};return _this.newLink.compose(args);});};BookmarkletController.prototype.destoryBookmarklet=function(){logger.log('Removing the bookmarklet');return window.parent.postMessage('destroy_bookmarklet','*');};return BookmarkletController;})(Controller);}).call(this);}});
window.require.define({"controllers/home_controller":function(exports,require,module){(function(){var Controller,HomeController,HomeView,logger,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};Controller=require('lib/controller');HomeView=require('views/home');logger=require('lib/logger');mediator=require('mediator');module.exports=HomeController=(function(_super){__extends(HomeController,_super);function HomeController(){return HomeController.__super__.constructor.apply(this,arguments);}
HomeController.prototype.historyUrl='/';HomeController.prototype.initialize=function(){return logger.log("Initializing the Home Controller.");};HomeController.prototype.index=function(params){var username;username=mediator.user.get('username');if(username){return this.redirectTo(username);}else{this.title="Capture the web you’ve been missing";return this.view=new HomeView;}};return HomeController;})(Controller);}).call(this);}});
window.require.define({"controllers/html_controller":function(exports,require,module){(function(){var Controller,HtmlController,SectionView,User,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};Controller=require('lib/controller');mediator=require('mediator');SectionView=require('views/base/section');User=require('models/user');module.exports=HtmlController=(function(_super){__extends(HtmlController,_super);function HtmlController(){return HtmlController.__super__.constructor.apply(this,arguments);}
HtmlController.prototype.pages=[{url:'tools',title:'Tools',id:'tools'},{url:'help',title:'Help',id:'help'},{url:'terms',title:'Terms',id:'terms'},{url:'privacy',title:'Privacy',id:'privacy'},{url:'copyright',title:'Copyright',id:'copyright'},{url:'developers',title:'Developers',id:'developers'},{url:'terms-update',title:'Terms update',id:'terms-update'}];HtmlController.prototype.page=function(params){var currentPage,_ref;if(params.page==='terms-update'){store.set('hasReadNewTerms',true);}
currentPage=_(this.pages).where({url:params.page});this.title=((_ref=currentPage[0])!=null?_ref.title:void 0)||'Discover Awesome';return this.view=new SectionView({pages:this.pages,currentId:params.page,params:params});};return HtmlController;})(Controller);}).call(this);}});
window.require.define({"controllers/layout_controller":function(exports,require,module){(function(){var Controller,LayoutController,mediator,__bind=function(fn,me){return function(){return fn.apply(me,arguments);};},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};Controller=require('lib/controller');mediator=require('mediator');module.exports=LayoutController=(function(_super){__extends(LayoutController,_super);function LayoutController(){this.showRemember=__bind(this.showRemember,this);this.showNetwork=__bind(this.showNetwork,this);this.showDiscover=__bind(this.showDiscover,this);this.focusSearch=__bind(this.focusSearch,this);return LayoutController.__super__.constructor.apply(this,arguments);}
LayoutController.prototype.initialize=function(){LayoutController.__super__.initialize.apply(this,arguments);key('/',this.focusSearch);key('1',this.showDiscover);key('2',this.showNetwork);return key('3',this.showRemember);};LayoutController.prototype.focusSearch=function(e){e.preventDefault();return $('#search-field').focus();};LayoutController.prototype.showDiscover=function(){return this.redirectTo("/discover");};LayoutController.prototype.showNetwork=function(){if(mediator.user.get("username")){return this.redirectTo("network");}};LayoutController.prototype.showRemember=function(){var username;username=mediator.user.get("username");if(username){return this.redirectTo(username);}};return LayoutController;})(Controller);}).call(this);}});
window.require.define({"controllers/links_controller":function(exports,require,module){(function(){var Controller,Link,LinkEditModal,LinksController,WarnView,logger,__bind=function(fn,me){return function(){return fn.apply(me,arguments);};},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};Controller=require('lib/controller');Link=require('models/link');LinkEditModal=require('views/links/edit');logger=require('lib/logger');WarnView=require('views/links/warn');module.exports=LinksController=(function(_super){__extends(LinksController,_super);function LinksController(){this.openCurrentLink=__bind(this.openCurrentLink,this);this.showNextDetailPane=__bind(this.showNextDetailPane,this);this.showPreviousDetailPane=__bind(this.showPreviousDetailPane,this);this.triggerAddEdit=__bind(this.triggerAddEdit,this);return LinksController.__super__.constructor.apply(this,arguments);}
LinksController.prototype.historyURL='';LinksController.prototype.events={'link:showEditModal':'showEditModal'};LinksController.prototype.initialize=function(){LinksController.__super__.initialize.apply(this,arguments);key('k',this.showPreviousDetailPane);key('up',this.showPreviousDetailPane);key('j',this.showNextDetailPane);key('down',this.showNextDetailPane);key('enter',this.openCurrentLink);return key('e',this.triggerAddEdit);};LinksController.prototype.redirectWarn=function(params){return this.view=new WarnView({model:new Link({url:params['url']})});};LinksController.prototype.showEditModal=function(options){var _this=this;logger.log("Showing the link edit modal:",{model:options.model});this.view=new LinkEditModal(options);return options.model.on('remove',function(){return _this.prevNext('nextAll');});};LinksController.prototype.triggerAddEdit=function(e){var $current_link;e.preventDefault();$current_link=$('.link.expanded');return $current_link.find('.link-badge a').click();};LinksController.prototype.prevNext=function(option){var $current,$next;$current=$('.link.expanded');$next=$current[option]('.link').first();if($next.length===1){$next.focus();return this.publishEvent('list:activateByMd5',$next.data('md5'));}};LinksController.prototype.showPreviousDetailPane=function(e){e.preventDefault();return this.prevNext('prevAll');};LinksController.prototype.showNextDetailPane=function(e){e.preventDefault();return this.prevNext('nextAll');};LinksController.prototype.openCurrentLink=function(e){var $current,url;if(window.location.pathname!=='/'){e.preventDefault();$current=$('.link.expanded');url=$current.find('.link-title a').attr('href');return window.open(url,'_blank');}};return LinksController;})(Controller);}).call(this);}});
window.require.define({"controllers/onboarding_controller":function(exports,require,module){(function(){var Controller,JoinView,OnboardingController,logger,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};Controller=require('lib/controller');JoinView=require('views/auth/join');mediator=require('mediator');logger=require('lib/logger');module.exports=OnboardingController=(function(_super){__extends(OnboardingController,_super);function OnboardingController(){return OnboardingController.__super__.constructor.apply(this,arguments);}
OnboardingController.prototype.join=function(params){logger.log('Loading the join page');this.title="Join";return this.view=new JoinView({model:mediator.user,section:params.section});};return OnboardingController;})(Controller);}).call(this);}});
window.require.define({"controllers/oops_controller":function(exports,require,module){(function(){var Controller,NotFoundView,OopsController,SomethingWentWrongView,logger,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};Controller=require('lib/controller');logger=require('lib/logger');NotFoundView=require('views/oops/notfound');SomethingWentWrongView=require('views/oops/somethingwentwrong');module.exports=OopsController=(function(_super){__extends(OopsController,_super);function OopsController(){return OopsController.__super__.constructor.apply(this,arguments);}
OopsController.prototype.initialize=function(){OopsController.__super__.initialize.apply(this,arguments);return logger.log("Initializing the Oops Controller.");};OopsController.prototype.index=function(params){this.view=new SearchResultsView;return this.publishEvent('search:fetch',this._extractKeywordsFromParams(params));};OopsController.prototype.notfound=function(){return this.view=new NotFoundView;};OopsController.prototype.somethingwentwrong=function(){return this.view=new SomethingWentWrongView;};return OopsController;})(Controller);}).call(this);}});
window.require.define({"controllers/plain_controller":function(exports,require,module){(function(){var AboutView,ChromeView,Controller,PlainController,logger,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};AboutView=require('views/about');ChromeView=require('views/chrome');Controller=require('lib/controller');logger=require('lib/logger');module.exports=PlainController=(function(_super){__extends(PlainController,_super);function PlainController(){return PlainController.__super__.constructor.apply(this,arguments);}
PlainController.prototype.historyUrl='/';PlainController.prototype.initialize=function(){PlainController.__super__.initialize.apply(this,arguments);return logger.log("Initializing the Plain page Controller.");};PlainController.prototype.about=function(){this.title="About us";return this.view=new AboutView;};PlainController.prototype.chrome=function(){this.title="Chrome Quicktour";return this.view=new ChromeView;};return PlainController;})(Controller);}).call(this);}});
window.require.define({"controllers/search_controller":function(exports,require,module){(function(){var Controller,Links,LinksList,NotFoundView,ProfileView,RelatedTagsList,SearchController,SearchResultsView,TagBundle,TagBundleList,TagBundles,Tags,User,avosConfig,encode,logger,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};avosConfig=require('lib/avos');Controller=require('lib/controller');encode=require('lib/encode');Links=require('models/links');LinksList=require('views/links/list');logger=require('lib/logger');mediator=require('mediator');NotFoundView=require('views/oops/notfound');ProfileView=require('views/user/profile');RelatedTagsList=require('views/tags/related_tag_list');SearchResultsView=require('views/links/search_results');Tags=require('models/tags');TagBundle=require('models/tag_bundle');TagBundleList=require('views/tags/tag_bundle_list');TagBundles=require('models/tag_bundles');User=require('models/user');module.exports=SearchController=(function(_super){__extends(SearchController,_super);function SearchController(){return SearchController.__super__.constructor.apply(this,arguments);}
SearchController.prototype.historyURL='';SearchController.prototype.initialize=function(){var _ref;SearchController.__super__.initialize.apply(this,arguments);this.mixin('lib/search_params');this.subscribeEvent('search:addYourTag',this._addYourTag);this.subscribeEvent('search:addTag',this._addTag);this.subscribeEvent('search:onlyTag',this._onlyTag);this.subscribeEvent('search:onlyTagBundle',this._onlyTagBundle);this.subscribeEvent('search:addUsername',this._addUsername);return this.username=((_ref=mediator.user)!=null?_ref.get('username'):void 0)||null;};SearchController.prototype.link=function(params){this.consolidated(params);this.title='Delicious';this.view.$('.links-container').not('.everyone').addClass('hidden');return this.view.$('.tags-container').addClass('hidden');};SearchController.prototype.consolidated=function(params){var collections,extraCollections,urlParamsCommunity,urlParamsNetwork,urlParamsYou,_this=this;this._setTitle(params);urlParamsCommunity=_.extend(_.clone(params),{type:'everyone'});collections=[new Links([],{urlParams:urlParamsCommunity})];if(mediator.user.get('isLoggedIn')){urlParamsYou=_.extend(_.clone(params),{type:'you'});urlParamsNetwork=_.extend(_.clone(params),{type:'network'});extraCollections=[new Links([],{urlParams:urlParamsYou}),new Links([],{urlParams:urlParamsNetwork})];collections=extraCollections.concat(collections);}
_.each(collections,function(links,i){_this["links"+i]=links;return _this._subscribeLinksToSearchFetchEvent(links);});this.relatedTags=new Tags([],{urlParams:{type:'related'}});this._subscribeTagsToSearchFetchEvent(this.relatedTags);this.view=new SearchResultsView({model:mediator.user});this.view.$el.addClass('all');_.each(collections,function(links){var heading,seeAllPath,seeAllPathParams,type;type=links.urlParams.type;seeAllPathParams=_.extend(_this._searchParams(params),{network:type==='network',username:type!=='everyone'&&_this.username});seeAllPath=_this.searchPathFromSearchParams(seeAllPathParams);heading=(function(){switch(type){case'everyone':return'More links on Delicious';default:return type.charAt(0).toUpperCase()+type.slice(1);}})();return _this.view.subview("links-"+type,new LinksList({collection:links,heading:heading,container:_this.view.$(".links-container."+type),seeAllPath:seeAllPath}));});this.view.subview('related-tags',new RelatedTagsList({collection:this.relatedTags,el:'.tags-container.related'}));return this._triggerSearch(params);};SearchController.prototype.network=function(params){var FeaturedFollowersCollectionView,UsersCollection,username,_this=this;if(!this.username){this.redirectTo(avosConfig.defaultRoute);return;}
params.network=true;params.username||(params.username=this._extractUsernameFromParams(params)||this.username);username=encode(params.username);this.title=username===this.username?'Your':""+username+"'s";this.title+=' Network';this.links=new Links([],{urlParams:{type:'network',username:username}});this.trendingTags=new Tags();this.relatedTags=new Tags();this.links.subscribeEvent('search:fetch',function(searchParams){_this.links.urlParams=_.extend(_.clone(_this.links.urlParams),searchParams);_this.links.reset([],{silent:true});return _this.links.fetch({success:function(){var hasTags,tagNames,tagsJSON;tagNames=_.uniq(_.compact(_.flatten(_this.links.pluck('tags'))));tagNames=_.difference(tagNames,_this.links.urlParams.tags);tagsJSON=_.map(tagNames,function(t){return{name:t};});hasTags=_this.links.urlParams.tags.length>0;if(hasTags){return _this.relatedTags.reset(tagsJSON);}else{return _this.trendingTags.reset(tagsJSON);}}});});this.view=new SearchResultsView({model:mediator.user});this.view.$el.addClass('network');this.view.subview('links',new LinksList({collection:this.links,heading:this.title,container:this.view.$('.links-container.network')}));this.view.subview('trending-tags',new RelatedTagsList({collection:this.trendingTags,el:'.tags-container.recent'}));this.view.subview('related-tags',new RelatedTagsList({collection:this.relatedTags,el:'.tags-container.related'}));if(!store.get('closedFeaturedFollowers')){logger.log('Showing featured followers panel');UsersCollection=require('models/users');FeaturedFollowersCollectionView=require('views/user/featured_followers_collection');this.users=new UsersCollection;this.users.url="/account/featuredusers";this.users.fetch().done(function(){return _this.view.subview('featured-followers',new FeaturedFollowersCollectionView({collection:_this.users,model:mediator.user}));});}
return this._triggerSearch(params);};SearchController.prototype.profile=function(params){var username,_this=this;if(this.searchTokensFromSearchParams==null){this.mixin('lib/search_params');}
this._setTitle(params);username=this._extractUsernameFromParams(params);this.user=new User({username:encode(username)});mediator.user.on('change:isLoggedIn',function(){if(username===mediator.user.get('username')){return _this.user.set(mediator.user.toJSON());}});this.links=new Links([],{urlParams:{username:username,tagBundle:params.tagBundle}});this.tagBundles=new TagBundles([],{urlParams:{username:username}});this.tagsInBundle=new Tags();this.currentTagBundle=new TagBundle();this.currentTagBundle.on('change',function(){var tagNames,tagsJSON;tagNames=_this.currentTagBundle.get('tags');tagsJSON=_.map(tagNames,function(tagName){return{name:tagName};});return _this.tagsInBundle.reset(tagsJSON);});this.relatedTags=new Tags;this.allTags=new Tags([],{urlParams:{username:username}});this.allTags.fetch();this.links.subscribeEvent('search:fetch',function(searchParams){_this.links.urlParams=_.extend(_.clone(_this.links.urlParams),searchParams);_this.links.reset([],{silent:true});return _this.links.fetch({success:function(){var bundleName,hasKeywords,hasTags,tagNames,tagsJSON;if(bundleName=searchParams.tagBundle){_this.currentTagBundle.fetchTags(username,bundleName);}
hasKeywords=_this.links.urlParams.keywords.length>0;hasTags=_this.links.urlParams.tags.length>0;if(hasKeywords||hasTags){tagNames=_.uniq(_.compact(_.flatten(_this.links.pluck('tags'))));tagNames=_.difference(tagNames,_this.links.urlParams.tags);tagsJSON=_.map(tagNames,function(t){return{name:t};});return _this.relatedTags.reset(tagsJSON);}}});});this.subscribeEvent('tagBundle:save',function(bundle){if(_this.tagBundles.where({name:bundle.get('name')}).length===0){return _this.tagBundles.add(bundle);}});this.user.profile({success:function(data){if(data.pkg===null){_this.view=new NotFoundView;}else{_this.view=new ProfileView({model:_this.user,tagBundles:_this.tagBundles});_this.tagBundles.fetch();_.delay(function(){if(mediator.dispatcher.currentAction==='profile'){return _this.view.subview('links',new LinksList({collection:_this.links,container:_this.view.$('.links-container')}));}},100);_this.view.subview('related-tags',new RelatedTagsList({collection:_this.relatedTags,el:_this.view.$('.tags-container.related'),limit:10000}));_.delay(function(){if(mediator.dispatcher.currentAction==='profile'){return _this.view.subview('all-tags',new RelatedTagsList({collection:_this.allTags,el:_this.view.$('.tags-container.all'),selected:store.get('orderBy')}));}},750);_this.view.subview('tag_bundles',new TagBundleList({collection:_this.tagBundles}));_this.view.subview('tags-in-bundle',new RelatedTagsList({collection:_this.tagsInBundle,el:_this.view.$('.tags-container.in-bundle'),showingAllTags:true}));}
if(_this.user.isMe()&&!params.p&&!params.tags){_this.subscribeEvent('link:added',function(){return _this._triggerSearch(params);});return _this.subscribeEvent('tags:managed',function(){_this.allTags.reset([],{silent:true});return _this.allTags.fetch().done(function(){return mediator.user.set('tags',_this.allTags.toJSON());});});}},failure:function(){return _this.view=new NotFoundView();}});return this._triggerSearch(params);};SearchController.prototype.discover=function(params){this.title='Discover';this.links=new Links([],{urlParams:{type:'everyone'}});this._subscribeLinksToSearchFetchEvent(this.links);this.trendingTags=new Tags([],{urlParams:{type:'trending'}});this._subscribeTagsToSearchFetchEvent(this.trendingTags);this.view=new SearchResultsView;this.view.$el.addClass('discover');this.view.subview('links',new LinksList({collection:this.links,heading:'Discover Delicious',container:this.view.$('.links-container.everyone')}));this.view.subview('trending-tags',new RelatedTagsList({collection:this.trendingTags,el:'.tags-container.recent'}));return this._triggerSearch(params);};SearchController.prototype._addYourTag=function(tag){var $field,excludedFragment,path,s,searchParams;$field=$('#search-field');s=$field.val();if(excludedFragment=$field.data('excluded-fragment')){s=s.replace(new RegExp(""+excludedFragment+"$"),'');$field.data('excluded-fragment',null);}
searchParams=this.searchParamsFromSearchString(s);searchParams.tags=_.uniq((searchParams.tags||[]).concat(tag));searchParams.tagBundle=null;searchParams.username||(searchParams.username=mediator.user.get('username'));this.publishEvent('search:updateInputField',searchParams);path=this.searchPathFromSearchParams(searchParams);return this.publishEvent('!router:route',path);};SearchController.prototype._addTag=function(tag){var $field,excludedFragment,path,s,searchParams;$field=$('#search-field');s=$field.val();if(excludedFragment=$field.data('excluded-fragment')){s=s.replace(new RegExp(""+excludedFragment+"$"),'');$field.data('excluded-fragment',null);}
searchParams=this.searchParamsFromSearchString(s);searchParams.tags=_.uniq((searchParams.tags||[]).concat(tag));searchParams.tagBundle=null;this.publishEvent('search:updateInputField',searchParams);path=this.searchPathFromSearchParams(searchParams);return this.publishEvent('!router:route',path);};SearchController.prototype._onlyTag=function(tag){var $field,excludedFragment,path,s,searchParams;$field=$('#search-field');s=$field.val();if(excludedFragment=$field.data('excluded-fragment')){s=s.replace(new RegExp(""+excludedFragment+"$"),'');$field.data('excluded-fragment',null);}
searchParams=this.searchParamsFromSearchString(s);searchParams.tags=[tag];searchParams.tagBundle=null;this.publishEvent('search:updateInputField',searchParams);path=this.searchPathFromSearchParams(searchParams);return this.publishEvent('!router:route',path);};SearchController.prototype._onlyTagBundle=function(tagBundle){var $field,excludedFragment,path,s,searchParams;$field=$('#search-field');s=$field.val();if(excludedFragment=$field.data('excluded-fragment')){excludedFragment=excludedFragment.replace(/(\[|\])/,"\\$1");s=s.replace(new RegExp(""+excludedFragment+"$"),'');$field.data('excluded-fragment',null);}
searchParams=this.searchParamsFromSearchString(s);searchParams.tagBundle=tagBundle;searchParams.username||(searchParams.username=mediator.user.get('username'));this.publishEvent('search:updateInputField',searchParams);path=this.searchPathFromSearchParams(searchParams);return this.publishEvent('!router:route',path);};SearchController.prototype._addUsername=function(username){var $field,excludedFragment,path,s,searchParams;$field=$('#search-field');s=$field.val();if(excludedFragment=$field.data('excluded-fragment')){s=s.replace(new RegExp(""+excludedFragment+"$"),'');$field.data('excluded-fragment',null);}
searchParams=this.searchParamsFromSearchString(s);searchParams.username=username;this.publishEvent('search:updateInputField',searchParams);path=this.searchPathFromSearchParams(searchParams);return this.publishEvent('!router:route',path);};SearchController.prototype._triggerSearch=function(params){var searchParams;searchParams=this._searchParams(params);this.publishEvent('search:fetch',searchParams);return this.publishEvent('search:updateInputField',searchParams);};SearchController.prototype._setTitle=function(params){var searchParams;searchParams=this._searchParams(params);return this.title=this.searchTokensFromSearchParams(searchParams).join(' ');};SearchController.prototype._searchParams=function(params){var _ref,_ref1;return{username:this._extractUsernameFromParams(params),tags:(params!=null?(_ref=params.tags)!=null?_ref.split('+'):void 0:void 0)||[],keywords:((_ref1=params.p)!=null?_ref1.split(','):void 0)||[],network:params.network||false,tagBundle:params.tagBundle||null};};SearchController.prototype._subscribeLinksToSearchFetchEvent=function(links){return links.subscribeEvent('search:fetch',function(searchParams){links.urlParams=_.extend(_.clone(links.urlParams),searchParams);links.reset([],{silent:true});return links.fetch();});};SearchController.prototype._subscribeTagsToSearchFetchEvent=function(tags){return tags.subscribeEvent('search:fetch',function(searchParams){tags.urlParams.keywords=searchParams.keywords;tags.urlParams.tags=searchParams.tags;tags.reset([],{silent:true});return tags.fetch();});};SearchController.prototype._extractUsernameFromParams=function(params){var _ref;return(params!=null?(_ref=params.username)!=null?_ref.trim():void 0:void 0)||null;};return SearchController;})(Controller);}).call(this);}});
window.require.define({"controllers/users_controller":function(exports,require,module){(function(){var Controller,SectionView,User,UsersController,ValidateEmailView,avosConfig,logger,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};avosConfig=require('lib/avos');Controller=require('lib/controller');logger=require('lib/logger');mediator=require('mediator');SectionView=require('views/base/section');ValidateEmailView=require('views/user/validate_email');User=require('models/user');module.exports=UsersController=(function(_super){__extends(UsersController,_super);function UsersController(){return UsersController.__super__.constructor.apply(this,arguments);}
UsersController.prototype.initialize=function(){UsersController.__super__.initialize.apply(this,arguments);return logger.log("Initializing the User Controller.");};UsersController.prototype.validateEmail=function(params){var user;user=new User;user.validateEmail(params.token);return this.view=new ValidateEmailView({model:user});};UsersController.prototype.settings=function(params){var user;this.title="Settings";user=mediator.user;if(!user.get('isLoggedIn')){logger.log("Redirecting to default route");this.redirectTo(avosConfig.defaultRoute);}
logger.log('Loading the settings page',{user:user});return this.view=new SectionView({pages:[{title:'Profile',view:'views/user/settings/settings',model:user,url:'settings',id:'profile'},{title:'Account',view:'views/user/settings/account',url:'settings/account',id:'account'},{title:'Sources',view:'views/user/settings/sources',url:'settings/sources',id:'sources',active:params.subpage==='sources',subpages:[{title:'Facebook',view:'views/user/settings/service',model:user,template:'user/settings/facebook',url:'settings/sources/facebook',id:'facebook',active:params.section==='facebook'},{title:'Twitter',view:'views/user/settings/service',model:user,template:'user/settings/twitter',url:'settings/sources/twitter',id:'twitter',active:params.section==='twitter'}]}],currentId:params.subpage,currentSectionId:params.section});};return UsersController;})(Controller);}).call(this);}});
window.require.define({"lib/api":function(exports,require,module){(function(){var SomethingWentWrong,avosConfig,isError,mediator,publishError,ravenError,retry;avosConfig=require('lib/avos');mediator=require('mediator');SomethingWentWrong=require('views/oops/somethingwentwrong');mediator.loginFailCount=0;publishError=function(){return new SomethingWentWrong;};ravenError=function(url,data){if(window.location.origin!=="http://localhost.delicious.com"){return Raven.captureMessage(url,data);}};retry=function(params){var data,url;url=_.first(params.url.split("?"));if(!mediator.retryCounter){mediator.retryCounter={};}
if(mediator.retryCounter[url]){mediator.retryCounter[url]++;}else{mediator.retryCounter[url]=1;}
$.ajax(params);data={url:url,count:mediator.retryCounter[url]};return 0;};isError=function(){return $('#delicious > .pageview.oops-page').length===1;};module.exports=function(options){var $html,api_host,params,url;params=_.extend({},avosConfig.ajax.options);url='';if(options.contentType){params.contentType=options.contentType;}
if(options.data){params.data=options.data;}
if(options.dataType){params.dataType=options.dataType;}
if(options.error&&typeof options.error==='function'){params.error=options.error;}
if(params.processData){params.processData=options.processData;}
if(options.type){params.type=options.type;}
if(options.url){url+=options.url;}
$html=$('html');if($html.hasClass('lt-ie10')){params.dataType='jsonp';}
api_host=avosConfig.api_host();params.url=("//"+api_host+avosConfig.api_path)+url;params.success=function(res,textStatus,jqxhr){if(res.status==='expired_session'){ravenError(this.url);mediator.loginFailCount++;if(mediator.loginFailCount>1){mediator.publish('auth:failure',res);mediator.loginFailCount=0;}else{mediator.publish('auth:loginsilent');}
if(options.error){options.error.apply(this,arguments);}
return;}
if(res.status==='invalid_credentials'){if(/webloginhash/.test(res.url)){ravenError(this.url);mediator.publish('auth:failure',res);}else{mediator.publish('auth:bad_credentials',res);}
if(options.error){options.error.apply(this,arguments);}
return;}
if(options.success){return options.success.apply(this,arguments);}};params.error=function(xhr,textStatus,errorThrown){0;0;url=_.last(_.first(this.url.split("?")).split("/api"));if(!xhr.getAllResponseHeaders()){return;}
if(/webloginhash/.test(url)){if(mediator.retryCounter[url]<2){return retry(this);}else{mediator.user.logout();}}};return $.ajax(params);};}).call(this);}});
window.require.define({"lib/avos":function(exports,require,module){(function(){var config;module.exports=config={api_hosts:["avosapi.delicious.com"],api_host:function(){return config.api_hosts[Math.floor(Math.random()*config.api_hosts.length)];},api_path:"/api/v1",defaultRoute:"discover",logging:true,ajax:{options:{cache:false,contentType:'application/json',dataType:'json',type:'GET',headers:{'Accept':'application/json'},xhrFields:{withCredentials:true}}},popup:{allowedOrigins:["http://avosapi.delicious.com","https://avosapi.delicious.com"],options:{menubar:"no",toolbar:"no",width:790,height:360}}};}).call(this);}});
window.require.define({"lib/collection":function(exports,require,module){(function(){var Chaplin,Collection,api,avosConfig,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};avosConfig=require('lib/avos');api=require('lib/api');Chaplin=require('chaplin');module.exports=Collection=(function(_super){__extends(Collection,_super);function Collection(){return Collection.__super__.constructor.apply(this,arguments);}
Collection.prototype.parse=function(response){if(_.isEmpty(response)){return[];}
return(response!=null?response.pkg:void 0)||[];};Collection.prototype.mixin=require('lib/mixin');Collection.prototype.initialize=function(models,params){if(models==null){models=[];}
if(params==null){params={};}
this.urlParams=params.urlParams;delete params.urlParams;return Collection.__super__.initialize.apply(this,arguments);};Collection.prototype.fetch=function(params){if(params==null){params={};}
if(this.length>0){params.add=true;}
return Collection.__super__.fetch.apply(this,arguments);};Collection.prototype.sync=function(method,model,options){var params;params={};params.url=typeof this.url==='function'?this.url():model.url!=null?model.url:void 0;params=_.extend(params,options);return api.call(this,params);};Collection.prototype._anchor=function(){var anchor,timestamps;if(this.length<1){return-1;}
timestamps=_.sortBy(this.pluck('time_created'),function(x){return x;});anchor=_.first(timestamps);return(anchor||0)-1;};Collection.prototype._index=function(){var indexes;if(this.length<1){return 0;}
indexes=_.sortBy(this.pluck('index'),function(x){return x;});return _.last(indexes)||0;};return Collection;})(Chaplin.Collection);}).call(this);}});
window.require.define({"lib/collection_view":function(exports,require,module){(function(){var Chaplin,CollectionView,View,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};Chaplin=require('chaplin');View=require('lib/view');module.exports=CollectionView=(function(_super){__extends(CollectionView,_super);function CollectionView(){return CollectionView.__super__.constructor.apply(this,arguments);}
CollectionView.prototype.mixin=require('lib/mixin');CollectionView.prototype.autoRender=true;CollectionView.prototype.useCssAnimation=true;CollectionView.prototype.getTemplateFunction=View.prototype.getTemplateFunction;CollectionView.prototype.showHeadingIfEmpty=true;CollectionView.prototype.defaults={heading:false,headingLevel:2,showHeadingIfEmpty:true};CollectionView.prototype.initialize=function(options){this.options=options!=null?options:{};_.defaults(this.options,this.defaults);CollectionView.__super__.initialize.apply(this,arguments);if(!this.showHeadingIfEmpty){this.modelBind('reset',this.renderHeading);}
if(this.collection&&this.loadingIndicator){return this.modelBind('reset',this.hideLoading);}};CollectionView.prototype.renderHeading=function(){var el;el=this.$list||this.$el;if(this.options.heading&&(this.options.showHeadingIfEmpty||this.collection.length>0)){return el.before("<h"+this.options.headingLevel+">"+this.options.heading+"</h"+this.options.headingLevel+">");}};CollectionView.prototype.afterRender=function(){CollectionView.__super__.afterRender.apply(this,arguments);this.renderHeading();if(this.loadingIndicator&&this.collection.isEmpty()){this.setLoading();}
return this;};CollectionView.prototype.setLoading=View.prototype.setLoading;CollectionView.prototype.hideLoading=View.prototype.hideLoading;return CollectionView;})(Chaplin.CollectionView);}).call(this);}});
window.require.define({"lib/controller":function(exports,require,module){(function(){var Chaplin,Controller,logger,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};Chaplin=require('chaplin');logger=require('lib/logger');mediator=Chaplin.mediator;module.exports=Controller=(function(_super){__extends(Controller,_super);function Controller(){return Controller.__super__.constructor.apply(this,arguments);}
Controller.prototype.mixin=require('lib/mixin');Controller.prototype.initialize=function(){var _this=this;Controller.__super__.initialize.apply(this,arguments);if(this.events){return _(this.events).each(function(fn_name,event_name){if(typeof _this[fn_name]==='function'){return mediator.subscribe(event_name,$.proxy(_this[fn_name],_this));}else{logger.log("The listener for "+event_name+" (@"+fn_name+") doesn't exist.");return logger.log("@["+fn_name+"]",_this[fn_name]);}});}};return Controller;})(Chaplin.Controller);}).call(this);}});
window.require.define({"lib/encode":function(exports,require,module){(function(){module.exports=function(str){str=encodeURIComponent(str);return str.replace(/\./g,'%2E');};}).call(this);}});
window.require.define({"lib/logger":function(exports,require,module){(function(){var getOffset,indent,logger,showLogger,startTime,__slice=[].slice;indent=15;startTime=new Date().getTime();showLogger=false;getOffset=function(label){var length;if(label==null){label='';}
length=indent-label.length+1;if(length<0){length=0;}
return(new Array(length)).join(' ');};module.exports=logger={error:function(){var data,msg;msg=arguments[0],data=2<=arguments.length?__slice.call(arguments,1):[];return logger.log.apply(logger,[msg,'error'].concat(__slice.call(data)));},log:function(){var data,level,msg,time,timeDiff;msg=arguments[0],level=arguments[1],data=3<=arguments.length?__slice.call(arguments,2):[];if(level==null){level='log';}
if(!showLogger){return;}
if(level!=='log'&&level!=='warn'&&level!=='error'){data.unshift(level);level='log';}
if(typeof msg!=='string'){data.unshift(msg);msg='';}
time=new Date().getTime();timeDiff=(time-startTime)+'ms';0;return _(data).each(function(debug){if(typeof debug==='object'){return _(debug).each(function(value,key){return 0;});}});},set:function(state){if(state==null){state=false;}
if(state===true){return showLogger=true;}},warn:function(){var data,msg;msg=arguments[0],data=2<=arguments.length?__slice.call(arguments,1):[];return logger.log.apply(logger,[msg,'warn'].concat(__slice.call(data)));}};}).call(this);}});
window.require.define({"lib/mixin":function(exports,require,module){(function(){var __slice=[].slice,__hasProp={}.hasOwnProperty;module.exports=function(){var attached,key,mixin,mixinclass,mixins,value,_i,_len;mixins=1<=arguments.length?__slice.call(arguments,0):[];for(_i=0,_len=mixins.length;_i<_len;_i++){mixin=mixins[_i];mixinclass=require(mixin);for(key in mixinclass){if(!__hasProp.call(mixinclass,key))continue;value=mixinclass[key];this[key]=value;}
attached=mixinclass.attached;if(attached){attached.apply(this);}}
return this;};}).call(this);}});
window.require.define({"lib/model":function(exports,require,module){(function(){var Chaplin,Model,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};Chaplin=require('chaplin');module.exports=Model=(function(_super){__extends(Model,_super);function Model(){return Model.__super__.constructor.apply(this,arguments);}
return Model;})(Chaplin.Model);}).call(this);}});
window.require.define({"lib/obfuscate":function(exports,require,module){(function(){module.exports=function(str){var reversed;reversed=str.split('').reverse().join('');return Base64.toBase64(reversed);};}).call(this);}});
window.require.define({"lib/popup":function(exports,require,module){(function(){var avosConfig,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i;}return-1;};avosConfig=require('lib/avos');module.exports=function(options){var api_host,crossWindowMessageName,listener,params,popupWindowName,success,url,windowFeatureStr;if(options==null){options={};}
params=_.extend({},avosConfig.popup.options,options);popupWindowName=params.popupWindowName;crossWindowMessageName=params.crossWindowMessageName;success=params.success;api_host=avosConfig.api_host();url=("//"+api_host+avosConfig.api_path)+params.url;delete params.url;delete params.success;delete params.popupWindowName;delete params.crossWindowMessageName;windowFeatureStr=(_.map(params,function(v,k){return""+k+"="+v;})).join(',');listener=function(e){var _ref;if(_ref=e.origin,__indexOf.call(avosConfig.popup.allowedOrigins,_ref)<0){return;}
if(e.data.name!==crossWindowMessageName){return;}
success(e.data.body);return window.removeEventListener('message',listener);};window.addEventListener('message',listener,false);return window.open(url,name,windowFeatureStr);};}).call(this);}});
window.require.define({"lib/search_params":function(exports,require,module){(function(){var encode,logger,mediator;encode=require('lib/encode');logger=require('lib/logger');mediator=require('mediator');module.exports={tokenizeSearchString:function(s){var r,tokens;tokens=_.uniq(s.match(/@\S+|#"[^"]+"|#'[^']+'|#\S+|\[[^\]]+\]|[0-9a-f]{32}|\S+/g)||[]);r=/^#*$/;tokens=_.reject(tokens,function(t){return r.test(t);});r=/^#'[^'\s]+'$|^#"[^"\s]+"$/;tokens=_.map(tokens,function(t){if(r.test(t)){return t.replace(/'|"/,'');}else{return t;}});return tokens;},searchParamsFromSearchString:function(s){var params;params={username:null,tags:[],keywords:[]};s=s.trim();if(_.isEmpty(s)){return params;}
_.each(this.tokenizeSearchString(s),function(token){var keyword,parsed,tag,_ref;if(parsed=token.match(/#(.+)/)){tag=_.last(parsed).trim();tag=tag.replace(/^'|^"/,'').replace(/'$|"$/,'');return params.tags.push(tag);}else if(parsed=token.match(/^@([^\/]+)/)){if(!params.username){params.username=_.last(parsed).trim();params.network=/(?:\S{1,}\/|^@)network$/.test(token);if(params.username==='me'||params.username==='network'){return params.username=(_ref=mediator.user)!=null?_ref.get('username'):void 0;}}}else if(parsed=token.match(/^\[([^\[\]]+)\]/)){return params.tagBundle=_.last(parsed).trim();}else if(parsed=token.match(/([0-9a-f]{32})/)){return params.md5=_.last(parsed).trim();}else{keyword=token.trim();return params.keywords.push(keyword);}});return params;},searchTokensFromSearchParams:function(params){var keywords,tags,tokens,username,_ref,_ref1;tokens=[];if(username=((_ref=params.username)!=null?_ref.trim():void 0)||null){if(params.network){if(username===((_ref1=mediator.user)!=null?_ref1.get('username'):void 0)){username='network';}else{username+='/network';}}
tokens.push("@"+username);}
tags=params.tags||[];tokens=tokens.concat(_.map(tags,function(tag){var tagName;tagName=decodeURIComponent(tag).trim();if(/\s/.test(tagName)){return"#\""+tagName+"\"";}else{return"#"+tagName;}}));keywords=params.keywords||[];tokens=tokens.concat(keywords);if(params.tagBundle){tokens=tokens.concat("["+(decodeURIComponent(params.tagBundle))+"]");}
tokens=_.compact(_.uniq(_.map(tokens,function(t){return t.trim();})));return tokens;},searchPathFromSearchParams:function(params){var keywords,md5,network,path,tagBundle,tags,username;username=params.username,keywords=params.keywords,tags=params.tags,network=params.network,tagBundle=params.tagBundle,md5=params.md5;if((tags!=null?tags.length:void 0)>0){tags=_.map(tags,function(s){return encode(s);});}
path='';if(md5){return"/url/"+md5;}
if(username){if(network){path="/network/"+username;if(tags&&tags.length>0){if(keywords&&keywords.length>0){path+='/'+tags.join('+');}else{path+='/tag/'+tags.join('+');}}}else{path="/"+username;if(tagBundle){path+='/tag_bundle/'+encode(tagBundle);}else if(tags&&tags.length>0){path+='/'+tags.join('+');}}}else{if(tags&&tags.length>0){path='/tag/'+tags.join('+');}}
if(keywords&&keywords.length>0){path=path+'/search?'+$.param({p:keywords.join(',')});}
return path;}};}).call(this);}});
window.require.define({"lib/view":function(exports,require,module){(function(){var Chaplin,View,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};Chaplin=require('chaplin');module.exports=View=(function(_super){__extends(View,_super);function View(){return View.__super__.constructor.apply(this,arguments);}
View.prototype.mixin=require('lib/mixin');View.prototype.autoRender=true;View.prototype.subviews=[];View.prototype.defaults={};View.prototype.isMobile=function(){return Modernizr.mq('(max-width: 760px)');};View.prototype.isDesktop=function(){return Modernizr.mq('(min-width: 760px)');};View.prototype.isTouch=function(){return Modernizr.touch;};View.prototype.getTemplateFunction=function(){if(this.template){return this._cachedTemplateFunction||(this._cachedTemplateFunction=require("templates/"+this.template));}};View.prototype.initialize=function(options){var _ref;this.options=options!=null?options:{};if((_ref=this.template)==null){this.template=this.options.template;}
_.defaults(this.options,this.defaults);if(this.collection&&this.loadingIndicator){this.modelBind('reset',this.hideLoading);}
return View.__super__.initialize.apply(this,arguments);};View.prototype.render=function(){View.__super__.render.apply(this,arguments);if(this.loadingIndicator){this.setLoading();}
return this;};View.prototype.setLoading=function(options){var _ref;if((_ref=this.$fallback)!=null){_ref.hide();}
return this.$('.loading').show().spin({lines:11,length:0,width:4,radius:8,corners:1,rotate:0,color:(options!=null?options.color:void 0)||'#285da7',speed:1,trail:10,shadow:false,hwaccel:true,className:'spinner',zIndex:1,top:'auto',left:'auto'});};View.prototype.hideLoading=function(){var $loading,_ref;$loading=this.$('.loading');if((_ref=$loading.data())!=null?_ref.spinner:void 0){$loading.spin();}
if(this.$el){return $loading.hide();}};return View;})(Chaplin.View);}).call(this);}});
window.require.define({"models/connect":function(exports,require,module){(function(){var Connect,Model,api,mediator,popup,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};api=require('lib/api');popup=require('lib/popup');mediator=require('mediator');Model=require('lib/model');module.exports=Connect=(function(_super){__extends(Connect,_super);function Connect(){return Connect.__super__.constructor.apply(this,arguments);}
Connect.prototype._connectdServices=function(){var connected_str;connected_str=mediator.user.get('connected_services');if(connected_str){return connected_str.split(',');}else{return[];}};Connect.prototype._addService=function(service){var connected;connected=this._connectdServices();if(!_.contains(connected,service)){connected.push(service);}
connected.sort();return connected;};Connect.prototype._removeService=function(service){var connected;connected=this._connectdServices();connected=_.without(connected,service);connected.sort();return connected;};Connect.prototype.connectService=function(user,service,callback){var params,_this=this;params={url:"/connect/to/"+service,crossWindowMessageName:"connect_to_delicious",popupWindowName:"Connect_To_"+service+"_From_Delicious",success:function(messageBody){var connected;if(messageBody.status==='success'){connected=_this._addService(service);user.set({connected_services:connected.join(',')});}
if(typeof callback==='function'){return callback(messageBody);}}};if(service==='facebook'){params=_.extend(params,{width:1000,height:610});}
return popup.call(this,params);};Connect.prototype.disconnectService=function(user,service,callback){var params,_this=this;params={url:"/connect/delete/"+service,success:function(resp){var connected;if(resp.status==='success'){connected=_this._removeService(service);user.set({connected_services:connected.join(',')});}
if(typeof callback==="function"){return callback(resp);}}};return api.call(this,params);};Connect.prototype.update=function(form_data,callback){var params,service,service_user_id,_this=this;service=this.get('providerId');service_user_id=this.get('providerUserId');params={url:"/connect/update/"+service+"/"+service_user_id,data:form_data,success:function(resp){if(typeof callback==="function"){return callback(_this);}}};return api.call(this,params);};return Connect;})(Model);}).call(this);}});
window.require.define({"models/connects":function(exports,require,module){(function(){var Collection,Connect,Connects,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};Collection=require('lib/collection');Connect=require('models/connect');module.exports=Connects=(function(_super){__extends(Connects,_super);function Connects(){return Connects.__super__.constructor.apply(this,arguments);}
Connects.prototype.model=Connect;Connects.prototype.url=function(){return"/connect";};Connects.prototype.parse=function(response){var items;items=Connects.__super__.parse.call(this,response);return _.flatten(_.values(items));};return Connects;})(Collection);}).call(this);}});
window.require.define({"models/follow":function(exports,require,module){(function(){var Follow,Model,api,encode,logger,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};api=require('lib/api');encode=require('lib/encode');logger=require('lib/logger');mediator=require('mediator');Model=require('lib/model');module.exports=Follow=(function(_super){__extends(Follow,_super);function Follow(){return Follow.__super__.constructor.apply(this,arguments);}
Follow.prototype.followUser=function(user,callback){var params,username;username=user.get('username')||user.get('user_name');params={url:"/account/follow/"+username,success:function(res){if(res.status==="success"){user.set({am_following_them:true});if(typeof callback==="function"){return callback();}}else{return logger.log('Failed to follow user',{user:user,status:res.status});}}};return api.call(this,params);};Follow.prototype.unfollowUser=function(user,callback){var params,username;username=user.get('username')||user.get('user_name');params={url:"/account/unfollow/"+username,success:function(res){if(res.status==="success"){user.set({am_following_them:false});if(typeof callback==="function"){return callback();}}else{return logger.log('Failed to follow user',{user:user,status:res.status});}}};return api.call(this,params);};Follow.prototype.getUserFollowersUrl=function(user){var username;username=encode(user.get('username'));return"/account/public/followers/"+username;};Follow.prototype.getUserFollowingUrl=function(user){var username;username=encode(user.get('username'));return"/account/public/follows/"+username;};return Follow;})(Model);}).call(this);}});
window.require.define({"models/link":function(exports,require,module){(function(){var Link,Model,Notes,Tag,Tags,api,logger,mediator,__bind=function(fn,me){return function(){return fn.apply(me,arguments);};},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};api=require('lib/api');logger=require('lib/logger');mediator=require('mediator');Model=require('lib/model');Notes=require('models/notes');Tag=require('models/tag');Tags=require('models/tags');module.exports=Link=(function(_super){__extends(Link,_super);function Link(){this.compose=__bind(this.compose,this);this.getDetails=__bind(this.getDetails,this);return Link.__super__.constructor.apply(this,arguments);}
Link.prototype.addOrEdit=function(form_data){var data,linkPrivacy,params,_this=this;data=_(form_data).pick('description','url','note','tags','private','showTags','replace','chosen_image_md5');if(data["private"]!=null){linkPrivacy=true;}else{linkPrivacy=false;}
params={data:data,url:"/posts/addoredit",success:function(res){var eventName,me,savers;if(res.status==='success'){logger.log("Successfully saved link");savers=_this.get('savers')||[];me=mediator.user.toJSON();_this.set('savers',[me].concat(savers));_this.set(_.extend(data,{"private":linkPrivacy,title:data.description,tags:data.tags.split(',')}));eventName=data.replace?'edited':'added';_this.publishEvent("link:"+eventName,_this);if(data["private"]){store.set('newLinkPrivate',true);}else{store.set('newLinkPrivate',false);}
if(data.showTags){return store.set('insertRecommendedTags',true);}else{return store.set('insertRecommendedTags',false);}}else{return logger.log("Failed to save link",res);}}};return api.call(this,params);};Link.prototype.bulkEdit=function(data){var params;params={data:data,url:"/tag/edit/all"};return api.call(this,params);};Link.prototype.getDetails=function(callback){var params,_this=this;if(mediator.user.get('isLoggedIn')){params={data:{urls:this.get('url')},url:"/posts/find_details",success:function(res){var defaultPrivacy,noteSelection;if(res.status==='success'){if(res.pkg!=null){noteSelection=_this.get('note'||false);_this.set(res.pkg[0]);if(noteSelection){_this.set('note',noteSelection);}}else{defaultPrivacy=store.get('newLinkPrivate');if(defaultPrivacy){_this.set('private',defaultPrivacy);}}}
if(typeof callback==="function"){return callback();}}};return api.call(this,params);}else{return this.publishEvent('auth:prompt',{title:'Sign in to save this link',callback:function(){return _this.getDetails(callback);}});}};Link.prototype.compose=function(args){var params,_this=this;if(mediator.user.get('isLoggedIn')){params={data:{'url':this.get('url')},url:"/posts/compose",success:function(res){if(res.pkg!=null){_this.set({recommended:res.pkg});if(!_this.get('title')){_this.set('title',res.pkg.suggested_title);}
if(args!=null?args.bookmarklet:void 0){args.editModal.options.spinner=false;return args.editModal.render();}else{return mediator.publish('link:showEditModal',{model:_this});}}}};return api.call(this,params);}else{return this.publishEvent('auth:prompt',{title:'Sign in to save this link',callback:function(){return _this.compose(args);}});}};Link.prototype.deleteAll=function(md5s){var params;params={data:{md5s:md5s},type:"GET",url:"/links/delete"};return api.call(this,params);};Link.prototype.markAs=function(type,md5s,callback){var params;params={data:{md5s:md5s},type:"GET",url:"/links/make/"+type,success:function(res){if(typeof callback==="function"){return callback(res);}}};return api.call(this,params);};Link.prototype.notes=function(){return new Notes([],{urlParams:{md5:this.get('md5')}});};Link.prototype.tags=function(){return _.uniq(_.map(this.get('tags'),function(tag){return Tag.normalize(tag);}));};Link.prototype.relatedTags=function(tag){return new Tags([],{urlParams:{type:'related',tags:tag}});};Link.prototype.remove=function(){var params,_this=this;params={data:{url:encodeURIComponent(this.get('url'))},type:"GET",url:"/posts/delete",success:function(res){if(res.status==='success'){logger.log("Link was destroyed");return _this.destroy();}else{return logger.log('Could not delete link',res.error,arguments);}}};return api.call(this,params);};return Link;})(Model);}).call(this);}});
window.require.define({"models/links":function(exports,require,module){(function(){var Collection,Link,Links,encode,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};Collection=require('lib/collection');encode=require('lib/encode');Link=require('models/link');mediator=require('mediator');module.exports=Links=(function(_super){__extends(Links,_super);function Links(){return Links.__super__.constructor.apply(this,arguments);}
Links.prototype.model=Link;Links.prototype.parse=function(response){var existingHashes,hashesToKeep,items,newHashes;items=Links.__super__.parse.call(this,response);newHashes=_.compact(_.uniq(_.pluck(items,'md5')));existingHashes=this.pluck('md5');hashesToKeep=_.difference(newHashes,existingHashes);items=_.filter(items,function(item){return _.contains(hashesToKeep,item.md5);});_.each(items,function(item){var _ref,_ref1;if(((_ref=item.chosen_image)!=null?_ref.width:void 0)<300||((_ref1=item.chosen_image)!=null?_ref1.height:void 0)<200){return item.chosen_image=null;}});return items;};Links.prototype.url=function(){var keywords,limit,md5,q,s,tagBundle,tags,type,username,_ref,_ref1,_ref2,_ref3,_ref4;this.urlParamDefaults||(this.urlParamDefaults={type:'popular',tags:[],keywords:[],limit:20,username:null,tagBundle:null,md5:null});_ref=_.extend(this.urlParamDefaults,this.urlParams),type=_ref.type,tags=_ref.tags,limit=_ref.limit,keywords=_ref.keywords,username=_ref.username,tagBundle=_ref.tagBundle,md5=_ref.md5;if(_.isArray(tags)&&tags.length>0){tags=_.map(tags,function(s){if(/%/.test(s)){return decodeURIComponent(s);}else{return s;}});}
if(username){if(type==='network'){if(username===((_ref1=mediator.user)!=null?_ref1.get('username'):void 0)||username==='me'){type='network';}else{username=encode(username);type="publicnetwork/"+username;}}else{if(username===((_ref2=mediator.user)!=null?_ref2.get('username'):void 0)||username==='me'){type='you';}else{username=encode(username);type="public/"+username;}}}
s="/posts/"+type+"/time";q={tags:_.isArray(tags)?tags.join(','):tags,tagsor:false,keywords:_.isArray(keywords)?keywords.join(','):keywords,limit:limit,anchor:this._anchor(),index:this._index(),inclpriv:1,bundle_name:decodeURIComponent(tagBundle)};if(username&&tagBundle){s="/tags/bundle/links";if(username!==((_ref3=mediator.user)!=null?_ref3.get('username'):void 0)){q.username=username;}}
if(md5){s="/posts/everyone/time";q={md5:md5};}
if(((_ref4=mediator.user)!=null?_ref4.get('isLoggedIn'):void 0)&&type==='everyone'&&!(tags.length||keywords.length||username||tagBundle||md5)){type='recommend';s="/posts/"+type+"/time";}
return s+'?'+$.param(q);};return Links;})(Collection);}).call(this);}});
window.require.define({"models/note":function(exports,require,module){(function(){var Model,Note,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};Model=require('lib/model');module.exports=Note=(function(_super){__extends(Note,_super);function Note(){return Note.__super__.constructor.apply(this,arguments);}
return Note;})(Model);}).call(this);}});
window.require.define({"models/notes":function(exports,require,module){(function(){var Collection,Note,Notes,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};Collection=require('lib/collection');Note=require('models/note');module.exports=Notes=(function(_super){__extends(Notes,_super);function Notes(){return Notes.__super__.constructor.apply(this,arguments);}
Notes.prototype.model=Note;Notes.prototype.url=function(){var limit,md5,params,q,s;this.urlParamDefaults={limit:1};params=_.extend(this.urlParamDefaults,this.urlParams);limit=params.limit,md5=params.md5;s="/posts/comments/time/"+md5;q={limit:limit,anchor:this._anchor(),exclude_yours:true};return s+'?'+$.param(q);};return Notes;})(Collection);}).call(this);}});
window.require.define({"models/tag":function(exports,require,module){(function(){var Model,Tag,api,logger,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};api=require('lib/api');logger=require('lib/logger');mediator=require('mediator');Model=require('lib/model');module.exports=Tag=(function(_super){__extends(Tag,_super);function Tag(){return Tag.__super__.constructor.apply(this,arguments);}
Tag.prototype.idAttribute='name';Tag.normalize=function(s){if(typeof s!=='string'){return;}
return s!=null?s.trim():void 0;};Tag.prototype.remove=function(){var params,_this=this;params={data:{tag:this.get('name')},url:"/tags/delete",success:function(res){if(res.status==='success'){logger.log("Tag was removed: ",res.pkg);return mediator.publish('tags:managed');}else{return logger.log('Could not delete tag',res.error,arguments);}}};return api.call(this,params);};Tag.prototype.rename=function(to_tag){var old_tag,params,_this=this;old_tag=this.get('name');params={data:{old_tag:old_tag,new_tag:to_tag},url:"/tags/rename",success:function(res){if(res.status==='success'){logger.log("Tag was renamed: ",res.pkg);return mediator.publish('tags:managed');}else{return logger.log('Could not rename tag',res.error,arguments);}}};return api.call(this,params);};return Tag;})(Model);}).call(this);}});
window.require.define({"models/tag_bundle":function(exports,require,module){(function(){var Model,TagBundle,api,mediator,__bind=function(fn,me){return function(){return fn.apply(me,arguments);};},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};api=require('lib/api');mediator=require('mediator');Model=require('lib/model');module.exports=TagBundle=(function(_super){__extends(TagBundle,_super);function TagBundle(){this.saveResponse=__bind(this.saveResponse,this);return TagBundle.__super__.constructor.apply(this,arguments);}
TagBundle.prototype["delete"]=function(){var params,_this=this;params={url:"/tags/bundle/delete",data:{bundle_name:this.get('name')},success:function(res){var _ref;if((res!=null?res.status:void 0)==='success'){_this.publishEvent('tagBundle:delete');return(_ref=_this.collection)!=null?_ref.remove(_this):void 0;}else{return _this.publishEvent('tagBundle:delete:error');}}};return api.call(this,params);};TagBundle.prototype.fetchTags=function(username,bname){var params,_this=this;params={data:{bundle_owner:username,bundle_name:decodeURIComponent(bname)},url:"/tags/bundle/tags",success:function(res){return _this.set({tags:_.map(res.pkg.tags,function(tag){return tag.tag_name;})});}};return api.call(this,params);};TagBundle.prototype.save=function(data){var params;this.newdata={name:data.name,tags:data.tags};if(data.previous!=null){params={url:"/tags/bundle/edit",data:{new_bundle_name:data.name,old_bundle_name:data.previous.get('name'),new_bundle_tags:data.tags,old_bundle_tags:data.previous.get('tags').join(','),bundle_owner:mediator.user.get('username')},success:this.saveResponse};return api.call(this,params);}else{params={url:"/tags/bundle/create",data:{bundle_name:data.name,tags:data.tags},success:this.saveResponse};return api.call(this,params);}};TagBundle.prototype.saveResponse=function(res){if(res.status==='success'){this.set(this.newdata);return this.publishEvent('tagBundle:save',this);}else{return this.publishEvent('tagBundle:save:error',this);}};return TagBundle;})(Model);}).call(this);}});
window.require.define({"models/tag_bundles":function(exports,require,module){(function(){var Collection,TagBundle,TagBundles,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};Collection=require('lib/collection');TagBundle=require('models/tag_bundle');module.exports=TagBundles=(function(_super){__extends(TagBundles,_super);function TagBundles(){return TagBundles.__super__.constructor.apply(this,arguments);}
TagBundles.prototype.model=TagBundle;TagBundles.prototype.url=function(){var username;this.urlParamDefaults||(this.urlParamDefaults={username:null});username=_.extend(this.urlParamDefaults,this.urlParams).username;if(username){return"/tags/bundles/"+username;}};TagBundles.prototype.parse=function(response){var bundle_names,_ref,_ref1;TagBundles.__super__.parse.apply(this,arguments);bundle_names=(_ref=response.pkg)!=null?(_ref1=_ref[0])!=null?_ref1.bundle_names:void 0:void 0;if(bundle_names){return _.map(bundle_names,function(name){return{name:name};});}else{return[];}};TagBundles.prototype.comparator=function(tag){var _ref;return(_ref=tag.get('name'))!=null?_ref.toLowerCase():void 0;};return TagBundles;})(Collection);}).call(this);}});
window.require.define({"models/tags":function(exports,require,module){(function(){var Collection,Tag,Tags,encode,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};Collection=require('lib/collection');encode=require('lib/encode');mediator=require('mediator');Tag=require('models/tag');module.exports=Tags=(function(_super){__extends(Tags,_super);function Tags(){return Tags.__super__.constructor.apply(this,arguments);}
Tags.prototype.model=Tag;Tags.prototype.comparator=function(tag){return(tag.get('num_saves')||0)*-1;};Tags.prototype.url=function(){var keywords,limit,params,q,s,tags,type,username,_ref;this.urlParamDefaults||(this.urlParamDefaults={type:'public',tags:[],keywords:[],limit:20});params=_.extend(this.urlParamDefaults,this.urlParams);tags=params.tags,keywords=params.keywords,type=params.type,limit=params.limit,username=params.username;if(_.isArray(tags)&&tags.length>0){tags=_.map(tags,function(s){if(/%/.test(s)){return decodeURIComponent(s);}else{return s;}});}
q={tags:_.isArray(tags)?tags.join(','):tags,keywords:_.isArray(keywords)?keywords.join(','):keywords,limit:limit,anchor:this._anchor(),index:this._index()};if(username){if(username===((_ref=mediator.user)!=null?_ref.get('username'):void 0)){type='you';}else{username=encode(username);type="public/"+username;}}
s=(function(){switch(type){case'trending':return"/tags/trending";default:return"/posts/"+type+"/tags";}})();return s+'?'+$.param(q);};Tags.prototype.parse=function(response){var lengthTag,normalizedTags,normalizer,pkg,tagCounts,tagNames,tags,_ref,_this=this;pkg=Tags.__super__.parse.call(this,response);if(!pkg){return[];}
normalizedTags=pkg.tags?(tagNames=_.keys(pkg.tags),tagCounts=_.map(tagNames,function(tagName){return pkg.tags[tagName];}),normalizer=function(memo,tagName,i){var t;t=Tag.normalize(tagName);if(_.isEmpty(t)){return memo;}
memo[t]||(memo[t]=0);memo[t]+=tagCounts[i];return memo;},tags=_.reduce(tagNames,normalizer,{}),lengthTag=tags.length,delete tags.length,tags=_.map(tags,function(count,tag){return{name:tag,num_saves:count};}),lengthTag?tags.push({name:'length',num_saves:lengthTag}):void 0,tags):pkg.best_tags?_.map(pkg.best_tags,function(tag){return{name:Tag.normalize(tag)};}):_.isArray(pkg)?_.map(pkg,function(tag){return{name:tag};}):[];if((_ref=this.urlParams)!=null?_ref.tags:void 0){return _.reject(normalizedTags,function(t){return _.include(_this.urlParams.tags,t.name);});}else{return normalizedTags;}};return Tags;})(Collection);}).call(this);}});
window.require.define({"models/user":function(exports,require,module){(function(){var Model,Tags,User,api,avosConfig,encode,error,log,mediator,obfuscate,popup,_ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments);};},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};api=require('lib/api');popup=require('lib/popup');avosConfig=require('lib/avos');encode=require('lib/encode');obfuscate=require('lib/obfuscate');mediator=require('mediator');Model=require('lib/model');Tags=require('models/tags');_ref=require('lib/logger'),log=_ref.log,error=_ref.error;module.exports=User=(function(_super){__extends(User,_super);function User(){this.loginResponse=__bind(this.loginResponse,this);return User.__super__.constructor.apply(this,arguments);}
User.prototype.defaults={isLoggedIn:false};User.prototype.profile=function(options){var params,username,_this=this;if(options==null){options={};}
username=this.get('username');if(!username){return this;}
username=encode(username);params={url:"/account/public/profile/"+username,success:function(data){if((data!=null?data.status:void 0)==='success'&&data.pkg!==null){_this.set(_this._userDataFromPackage(data.pkg));return typeof options.success==="function"?options.success(data):void 0;}else{error('Could not get profile',{args:arguments});return typeof options.failure==="function"?options.failure(data):void 0;}}};api.call(this,params);return this;};User.prototype.login=function(params,callback){var $html,password,username,_this=this;$html=$('html');username=params.username;password=params.password;if($html.hasClass('lt-ie10')){username=encode(params.username);password=encodeURIComponent(encodeURIComponent(params.password)).replace('.','%252E');}
params={error:function(){var args;args=Array.prototype.slice.call(arguments);if(callback){args.push(callback);}
return _this.loginError.apply(_this,args);},success:function(res){var args;args=Array.prototype.slice.call(arguments);if(callback){args.push(callback);}
return _this.loginResponse.apply(_this,args);}};if($html.hasClass('lt-ie10')){params.url="/account/webloginpwd/"+username+"/"+password;params.type='GET';}else{params.url='/account/login';params.type='POST';params.contentType='application/x-www-form-urlencoded; charset=UTF-8';params.data={username:username,password:obfuscate(password)};}
0;0;return api.call(this,params);};User.prototype.loginSilent=function(callback){var params,passwordHash,username,_this=this;username=encode(this.get('username'));passwordHash=this.get('password_hash');params={url:"/account/webloginhash/"+username+"/"+passwordHash,error:function(){var args;args=Array.prototype.slice.call(arguments);if(callback){args.push(callback);}
return _this.loginError.apply(_this,args);},success:function(){var args;args=Array.prototype.slice.call(arguments);if(callback){args.push(callback);}
return _this.loginResponse.apply(_this,args);}};return api.call(this,params);};User.prototype.loginError=function(data){var callback;log("Login error");callback=arguments[arguments.length-1];if(typeof callback==="function"){return callback.call(this,this,data.error);}};User.prototype.loginResponse=function(data,resText,xhr,callback){var pkg,userData;if(data.status==='success'){pkg=data.pkg;userData=this._userDataFromPackage(pkg);userData.isLoggedIn=true;this.set(userData);mediator.user.set(this);store.set('user',this);}
if(typeof callback==="function"){return callback.call(this,this,data.error);}};User.prototype.loginWithThirdParties=function(service,callback){var params,_this=this;log("connect to "+service);params={url:"/auth/signin/"+service,crossWindowMessageName:"connect_to_delicious",popupWindowName:"SigninWith"+service,success:function(messageBody){if(messageBody){log("msg",{messageBody:messageBody});if(!messageBody.newUser&&messageBody.username&&messageBody.password){return _this.publishEvent('join:signinWithService',messageBody);}else if(messageBody.newUser&&messageBody.displayName){return _this.publishEvent('join:signupWithService',messageBody);}}else{return log("Error found");}}};if(service==='facebook'){params=_.extend(params,{width:1000,height:610});}
return popup.call(this,params);};User.prototype.logout=function(callback){var api_host;api_host=avosConfig.api_host();$.ajax({url:"//"+api_host+"/signout/"});this.set('isLoggedIn',false,{silent:true});mediator.user.clear();store.set('user',mediator.user);if(typeof callback==="function"){return callback(this);}};User.prototype.isMe=function(){var _ref1;return((_ref1=mediator.user)!=null?_ref1.get('username'):void 0)===this.get('username');};User.prototype.followersUrl=function(){var username;username=encode(this.get('username'));return this.api_root.replace(/\/$/,'')+("/account/public/followers/"+username);};User.prototype.followingUrl=function(){var username;username=encode(this.get('username'));return this.api_root.replace(/\/$/,'')+("/account/public/follows/"+username);};User.prototype.existsUser=function(username){var params,_this=this;params={url:"/account/public/profile/"+username,success:function(res){if(res.status==='success'&&res.pkg===null){return _this.publishEvent('join:checkedUserExists',{'available':true});}else{return _this.publishEvent('join:checkedUserExists',{'available':false,'username':username});}}};return api.call(this,params);};User.prototype.register=function(callback){var params,_this=this;params={url:"/account/registerw",data:this.toJSON(),success:function(res){if(res.status==='success'){log("Created new user with pkg",res.pkg);_this.set(res.pkg);_this.publishEvent('join:userJoined',{'success':true});}else{_this.publishEvent('join:userJoined',{'success':false,'status':res.status,'error':res.error});}
if(typeof callback==="function"){return callback(res);}}};return api.call(this,params);};User.prototype.update=function(form_data,callback){var params,_this=this;params={url:"/account/profile/edit",data:form_data,success:function(res){if(res.status==='success'){log("Successfully updated user's profile",res.pkg);_this.set({full_name:res.pkg.full_name,profile_bio:res.pkg.profile_bio,profile_url:res.pkg.profile_url,profile_email:res.pkg.profile_email});mediator.user.set(_this);store.set('user',_this);}
if(typeof callback==="function"){return callback(_this);}}};return api.call(this,params);};User.prototype.changePassword=function(form_data,callback){var params,_this=this;form_data['user_id']=this.get('id');params={url:"/account/webchangepassword",data:form_data,success:function(res){if(res.status==='success'){log("Account password updated",res.pkg);_this.set(res.pkg);mediator.user.set(_this);store.set('user',_this);}
if(typeof callback==="function"){return callback(res.status,res.error);}}};return api.call(this,params);};User.prototype.updateAvatar=function(form,callback){var api_host,params,url,_this=this;api_host=avosConfig.api_host();url="//"+api_host+avosConfig.api_path+"/account/profile/edit_image";params={dataType:'json',success:function(res){if(res.status==='success'){return _.delay(function(){log("Successfully uploaded profile avatar",{user:res.pkg});res.pkg.avatar_url=res.pkg.avatar_url+'?'+new Date().getTime();_this.set(res.pkg);mediator.user.set(_this);store.set('user',_this);if(typeof callback==="function"){return callback(res.status,res.error);}},2500);}}};form.attr('action',url);return form.ajaxSubmit(params);};User.prototype.validateEmail=function(token){var params,_this=this;params={url:"/account/validate_email/"+token,success:function(data){if((data!=null?data.status:void 0)==='success'){log("Email validated");return _this.set("info","Thank you, your email has been validated.");}else{return _this.set("info",data.error);}}};return api.call(this,params);};User.prototype._userDataFromPackage=function(pkg){var account,follows,tags,tagsJSON,userData;account=pkg.account;userData=_.extend({},account||pkg);if(pkg.follows!=null){follows=_.sortBy(pkg.follows,function(u){return u.username.toLowerCase();});userData.follows=follows=_.map(follows,function(user){return{username:user.username,full_name:user.full_name};});}
if(pkg.user_tags!=null){tags=new Tags;tagsJSON=tags.parse({pkg:pkg.user_tags});userData.tags=tags=tags.reset(tagsJSON).toJSON();}
if(pkg.bundle_names!=null){userData.tag_bundles=_.map(pkg.bundle_names,function(n){return{name:n};});}
return userData;};return User;})(Model);}).call(this);}});
window.require.define({"models/users":function(exports,require,module){(function(){var Collection,User,Users,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};Collection=require('lib/collection');User=require('models/user');module.exports=Users=(function(_super){__extends(Users,_super);function Users(){return Users.__super__.constructor.apply(this,arguments);}
Users.prototype.model=User;Users.prototype.comparator=function(user){return user.get('username').toLowerCase();};return Users;})(Collection);}).call(this);}});
window.require.define({"templates/helpers/common":function(exports,require,module){(function(){var mediator;mediator=require('mediator');moment.calendar={lastDay:'[Yesterday]',sameDay:'[Today]',nextDay:'[Tomorrow] LT',lastWeek:'dddd',nextWeek:'dddd [at] LT',sameElse:'MMMM Do YYYY'};Handlebars.registerHelper('formatDate',function(t){return moment(t*1000).calendar();});Handlebars.registerHelper('formatMachineDate',function(t){return moment(t*1000).format('YYYY-MM-DD');});Handlebars.registerHelper('commafy',function(t){return(t!=null?t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,','):void 0)||0;});Handlebars.registerHelper('decode',function(t){return t!=null?t.toString().replace(/%2E/g,'.'):void 0;});Handlebars.registerPartial('footer',require('templates/layout/footer'));Handlebars.registerPartial('share',require('templates/links/share'));}).call(this);}});
window.require.define({"templates/helpers/link_helpers":function(exports,require,module){(function(){var avosConfig,mediator,noteAsHTML;mediator=require('mediator');avosConfig=require('lib/avos');Handlebars.registerHelper('currentUrl',function(){return window.location.href;});Handlebars.registerHelper('date',function(date){return moment.unix(date).fromNow();});Handlebars.registerHelper('linkDomain',function(url){var _ref;return(url!=null?(_ref=url.match(/https?:\/\/(?:www\.)?([^\/]*)/i))!=null?_ref[1]:void 0:void 0)||url;});Handlebars.registerHelper('encodedUrl',function(){return encodeURIComponent(this.url);});Handlebars.registerHelper('linkPreview',function(){var api_host,buffer,chosenImgMd5,videoid,_ref,_ref1,_ref2;videoid=(_ref=this.url)!=null?(_ref1=_ref.match(/https?:\/\/www\.youtube\.com\/watch\?v\=([^\&]*)/i))!=null?_ref1[1]:void 0:void 0;chosenImgMd5=(_ref2=this.chosen_image)!=null?_ref2.image_url.split("/").pop():void 0;api_host=avosConfig.api_host();buffer=chosenImgMd5?"<div class=\"loading\"></div>\n<a href=\"//"+api_host+this.avosConfig.api_path+"/posts/redirect?url="+(encodeURIComponent(this.url))+"\" target=\"_blank\" rel=\"nofollow\">\n  <div class=\"link-preview\" style=\"background-image: url(//delicious.imgix.net/"+chosenImgMd5+"?w=700&h=400&fit=crop&fm=jpg&q=50&crop=faces)\"></div>\n</a>":videoid?"<iframe width=\"350\" height=\"240\" src='http://www.youtube.com/embed/"+videoid+"?html5=1' frameborder='0' allowfullscreen></iframe>":"<div class=\"no-image\">"+(this.title||this.url)+"</div>";return new Handlebars.SafeString(buffer);});Handlebars.registerHelper('linkTags',function(tags,options){var buffer,maxLinks,otherTags;maxLinks=options.hash.limit||100;buffer='';tags=_.uniq(_.map(_.compact(tags),function(t){return t.trim();}));_.each(tags.slice(0,maxLinks),function(t,i){buffer+="<a href=\"#\" class=\"tag-small\" data-tag=\""+(t.replace(/"|'/g,''))+"\">"+t+"</a>";if(i<tags.length-1){return buffer+='<span>, </span>';}});if(tags.length>maxLinks){otherTags=tags.slice(maxLinks).join(', ');buffer+=" <strong>+ "+(tags.length-maxLinks)+" more</strong>";}
return new Handlebars.SafeString(buffer);});Handlebars.registerHelper('linkSavers',function(savers){var buffer,firstSaver;buffer='';if((savers!=null?savers.length:void 0)>0){firstSaver=_.first(savers);buffer+="<a href=\"/"+firstSaver.username+"\">"+(firstSaver.full_name||firstSaver.display_name||firstSaver.username)+"</a>";if(savers.length>1){buffer+=" and "+(savers.length-1)+" other";}
if(savers.length>2){buffer+='s';}
buffer+=' added this.';}
return new Handlebars.SafeString(buffer);});Handlebars.registerHelper('linkNotes',function(notes,snippet){return notes||snippet;});Handlebars.registerHelper('isMyLink',function(options){var _ref,_ref1;if(((_ref=this.savers)!=null?(_ref1=_ref[0])!=null?_ref1.username:void 0:void 0)===mediator.user.get('username')){return options.fn(this);}else{return options.inverse(this);}});Handlebars.registerHelper('insertRecommendedTags',function(options){if(store.get('insertRecommendedTags')){return options.fn(this);}else{return options.inverse(this);}});Handlebars.registerHelper('hasRecommendedTags',function(options){var _ref,_ref1;if((_ref=this.recommended)!=null?(_ref1=_ref.suggested_tags)!=null?_ref1.length:void 0:void 0){return options.fn(this);}else{return options.inverse(this);}});Handlebars.registerHelper('recommendedTags',function(){var _ref;return(_ref=this.recommended)!=null?_ref.suggested_tags:void 0;});Handlebars.registerHelper('hasImage',function(options){var _ref,_ref1;if((((_ref=this.recommended)!=null?(_ref1=_ref.suggestedImages)!=null?_ref1.length:void 0:void 0)||this.chosen_image)!=null){return options.fn(this);}else{return options.inverse(this);}});Handlebars.registerHelper('titleOrURL',function(){return this.title||this.url;});noteAsHTML=function(note){return note.replace(/[&lt;]+[3]/gi,"<tt class='heart'>&#x2665;</tt>").replace(/((ftp|http|https):\/\/(\w+:{0,1}\w*@)?([\w#!:\.?+=&%@!\-\/}]+)(:[0-9]+)?(\/|\/([\w#!:\.?+=&%@!\-\/}]))?)/gi,"<a href=\"$1\" target=\"_blank\">$4</a>");};Handlebars.registerHelper('noteAsHTML',function(){return noteAsHTML(this.note);});Handlebars.registerHelper('noteAsHTMLWithLineBreaks',function(){var note;if(this.note){note=noteAsHTML(this.note);return note.replace(/\n/g,'<br>');}});Handlebars.registerHelper('outputImages',function(){var buffer,chosen,imageUrl,_ref,_ref1;if(!(((_ref=this.recommended)!=null?(_ref1=_ref.suggested_images)!=null?_ref1.length:void 0:void 0)>0||this.chosen_image)){return;}
chosen=this.chosen_image;buffer='';if(chosen){imageUrl=chosen.image_url||chosen.imageUrl;buffer+="<div style=\"background-image: url("+imageUrl+");\" class=\"edit-preview-image-tile\"></div>";}
_.each(this.recommended.suggested_images,function(img){imageUrl=img.image_url||img.imageUrl;if(img.md5!==(chosen!=null?chosen.md5:void 0)){return buffer+="<div style=\"background-image: url("+img.image_url+");\" class=\"edit-preview-image-tile\"></div>";}});return new Handlebars.SafeString(buffer);});Handlebars.registerHelper('faviconUrl',function(){var extensions,suffix;extensions=['.com','.co.uk','.com.au'];suffix=_.first(_.shuffle(extensions));return new Handlebars.SafeString("//www.google"+suffix+"/s2/favicons?domain="+this.domain);});Handlebars.registerHelper('randomApiHost',function(){return avosConfig.api_host();});Handlebars.registerHelper('isDiscover',function(options){var _ref;if(window.location.pathname.split('/')[1]==='discover'||((_ref=window.location.hash.split('#')[1])!=null?_ref.split('/')[0]:void 0)==='discover'){return options.fn(this);}else{return options.inverse(this);}});}).call(this);}});
window.require.define({"templates/helpers/user_helpers":function(exports,require,module){(function(){var mediator;mediator=require('mediator');Handlebars.registerHelper('ifMe',function(block){if(mediator.user.get('username')===this.username){return block.fn(this);}else{return block.inverse(this);}});Handlebars.registerHelper('displayName',function(){return this.full_name||this.display_name||this.user_name||this.username;});Handlebars.registerHelper('followButton',function(options){var cls,followers,isFollowing,nope,user_id,username,yep,_ref,_this=this;cls=((_ref=options.hash)!=null?_ref.className:void 0)||'';username=this.user_name||this.username;user_id=this.user_id||this.id;if(username===mediator.user.get('username')){return;}
if(!mediator.user.get('isLoggedIn')){return;}
nope="<a href=\"#follow\" data-user-id=\""+user_id+"\" class=\"btn "+cls+" btn-primary\">Follow</a>";yep="<a href=\"#unfollow\" data-user-id=\""+user_id+"\" class=\"btn "+cls+"\">Following</a>";if(this.am_following_them){return yep;}else{if(typeof this.am_following_them!=="boolean"){followers=mediator.user.get('follows');isFollowing=_.find(followers,function(follower){return follower.username===username;});}
if(isFollowing){return yep;}}
return nope;});Handlebars.registerPartial('bookmarklet-box',require('templates/tools/bookmarklet'));Handlebars.registerPartial('coachmarks',require('templates/user/coachmarks'));}).call(this);}});
window.require.define({"templates/home":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;partials=partials||Handlebars.partials;data=data||{};var buffer="",stack1,self=this;buffer+="<div class=\"container\">\n  <div class=\"span6\" id=\"home-left\">\n    <h1>Discover, remember, and showcase your passions from around the web.</h1>\n\n    <br>\n\n    <div style=\"display:block;\">\n      <a class=\"btn btn-primary\" id=\"join-button\" href=\"/join\" tabindex=\"4\">Join Delicious<span id=\"inset-arrow\" class=\"d-icon-arrow\"></span></a>\n    </div>\n\n    <a href=\"/discover\" id=\"browse-no-account\">Or browse without an account.</a>\n\n    <br>\n\n    <div class=\"span5 home-icons\">\n      <ul>\n        <li id=\"home-first\">\n          <h2><span class=\"d-icon-plus home-icon\" id=\"plus\"></span>Add links to Delicious and never lose what you find and share on the web.</h2>\n        </li>\n        <li id=\"home-second\">\n          <h2><span class=\"d-icon-tag home-icon\" id=\"tag\"></span>Organize your collection of links and share it with like&mdash;minded people.</h2>\n        </li>\n        <li id=\"home-third\">\n          <h2><span class=\"d-icon-search home-icon\" id=\"search\"></span>Browse links curated by the Delicious community to discover content you care about.</h2>\n        </li>\n      </ul>\n    </div>\n\n    <div class=\"span4 home-footer\">\n      ";stack1=depth0;stack1=self.invokePartial(partials.footer,'footer',stack1,helpers,partials,data);if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n    </div>\n\n  </div>\n\n  <div id=\"home-right\" class=\"span4\">\n    <div id=\"home-screenshot-wrapper\" class=\"pull-right\">\n      <div class=\"relative\">\n        <div class=\"circle-wrapper circle-wrapper-search fade\">\n          <div class=\"circle\"></div>\n          <div class=\"hint hint-search fade\">Easily search your links and the Delicious community.</div>\n        </div>\n        <div class=\"circle-wrapper circle-wrapper-follow fade\">\n          <div class=\"circle\"></div>\n          <div class=\"hint hint-follow fade\">Follow your friends, family, &amp; people who share your interests.</div>\n        </div>\n        <div class=\"circle-wrapper circle-wrapper-link fade\">\n          <div class=\"circle\"></div>\n          <div class=\"hint hint-link fade\">Add cool links you discover on the web and find them later.</div>\n        </div>\n      </div>\n      <div id=\"home-screenshot\" class=\"fade\"></div>\n    </div>\n  </div>\n</div>\n";return buffer;});}});
window.require.define({"templates/layout/autocomplete":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};var buffer="",stack1,stack2,functionType="function",escapeExpression=this.escapeExpression,self=this,blockHelperMissing=helpers.blockHelperMissing;function program1(depth0,data){var buffer="",stack1,stack2;buffer+="\n  <section class=\"tag-bundles\">\n    <h5>Your Tag Bundles</h5>\n    ";stack1=depth0.tagBundles;stack2={};stack1=helpers.each.call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(2,program2,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n  </section>\n";return buffer;}
function program2(depth0,data){var buffer="",stack1,foundHelper;buffer+="\n      <a href=\"#\" class=\"item tag-bundle\" data-tag-bundle=\"";foundHelper=helpers.name;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.name;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\">";foundHelper=helpers.name_markup;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.name_markup;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="</a>\n    ";return buffer;}
function program4(depth0,data){var buffer="",stack1,stack2;buffer+="\n  <section class=\"tags\">\n    <h5>Your Tags</h5>\n    ";stack1=depth0.tags;stack2={};stack1=helpers.each.call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(5,program5,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n  </section>\n";return buffer;}
function program5(depth0,data){var buffer="",stack1,foundHelper;buffer+="\n      <a href=\"#\" class=\"item tag\" data-tag=\"";foundHelper=helpers.name;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.name;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\">";foundHelper=helpers.name_markup;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.name_markup;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="</a>\n    ";return buffer;}
function program7(depth0,data){var buffer="",stack1,stack2;buffer+="\n  <section class=\"users\">\n    <h5>People You Follow</h5>\n    ";stack1=depth0.users;stack2={};stack1=helpers.each.call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(8,program8,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n  </section>\n";return buffer;}
function program8(depth0,data){var buffer="",stack1,stack2,foundHelper;buffer+="\n      <a href=\"#\" class=\"item user\" data-user=\"";foundHelper=helpers.username;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.username;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\">\n        @";foundHelper=helpers.username_markup;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.username_markup;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n        ";foundHelper=helpers.ifMe;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.noop,fn:self.program(9,program9,data),data:data});}
else{stack1=depth0.ifMe;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.ifMe){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(9,program9,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n        <span class=\"full-name\">";foundHelper=helpers.full_name_markup;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.full_name_markup;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="</span>\n      </a>\n    ";return buffer;}
function program9(depth0,data){return"<span class=\"you\">(you)</span>";}
buffer+="<section>\n  <a href=\"#\" class=\"item selected search-submit\">See all results</a>\n</section>\n\n";stack1=depth0.tagBundles;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(1,program1,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n\n";stack1=depth0.tags;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(4,program4,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n\n";stack1=depth0.users;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(7,program7,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n";return buffer;});}});
window.require.define({"templates/layout/banner":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};var buffer="",stack1,stack2,functionType="function",escapeExpression=this.escapeExpression,self=this;function program1(depth0,data){return"/discover";}
function program3(depth0,data){return"/";}
function program5(depth0,data){var buffer="",stack1,foundHelper;buffer+="\n      <a href=\"/network\" class=\"nav-link nav-network\" data-track-group=\"header links\">Network</a>\n      <a href=\"/";foundHelper=helpers.username;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.username;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" class=\"nav-link nav-remember\" data-track-group=\"header links\">Remember</a>\n    ";return buffer;}
function program7(depth0,data){return"\n      <a href=\"/join\" class=\"nav-link\" data-track-group=\"header links\" id=\"nav-join-link\">Join</a>\n      <a href=\"#login\" data-track-group=\"header links\" class=\"nav-link\" id=\"nav-sign-in\">Sign in</a>\n    ";}
function program9(depth0,data){var buffer="",stack1,foundHelper;buffer+="\n        <a href=\"#add-link\" class=\"nav-link add-link hidden-tablet\" data-track-group=\"header links\">Add link</a>\n\n        <div class=\"dropdown\">\n          <a href=\"/";foundHelper=helpers.username;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.username;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" data-toggle=\"dropdown\" data-track-group=\"header links\" data-track-name=\"Name and avatar area\" class=\"nav-link dropdown\">\n            <span class=\"banner-name hidden-tablet\">Hi, ";foundHelper=helpers.full_name;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.full_name;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"!</span>\n            <span class=\"avatar-container\">\n              <span class=\"dropdown-carrot left\"></span>\n              <img class=\"avatar\" src=\"";foundHelper=helpers.avatar_url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.avatar_url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\">\n            </span>\n          </a>\n\n          <ul class=\"dropdown-menu\" role=\"menu\">\n            <li><a href=\"#add-link\" data-track-group=\"header dropdown\" class=\"hidden-desktop visible-tablet\">Add link</a></li>\n            <li><a href=\"/settings\" data-track-group=\"header dropdown\">Settings</a></li>\n            <li><a href=\"/tools\" data-track-group=\"header dropdown\">Tools</a></li>\n            <li><a href=\"/help\" data-track-group=\"header dropdown\">Help</a></li>\n            <li><a href=\"#sign-out\" data-track-group=\"header dropdown\">Sign out</a></li>\n          </ul>\n        </div>\n\n    ";return buffer;}
function program11(depth0,data){return"\n      <a href=\"#add-link\" class=\"nav-link add-link\" data-track-group=\"header links\">Add link</a>\n      <a href=\"/join\" class=\"nav-link\" data-track-group=\"header links\" id=\"join-link\">Join Delicious</a>\n      <a href=\"#login\" class=\"nav-link\" data-track-group=\"header links\" id=\"sign-in-link\">Sign in</a>\n    ";}
buffer+="<div class=\"page-header-inner container\">\n  <div class=\"page-header-inner-left clearfix\" class=\"pull-left\">\n\n    <a class=\"logo\" href=\"";stack1=depth0.isLoggedIn;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\" title=\"Delicious\" data-track-group=\"logo\"></a>\n    <div class=\"global-search-container\">\n      <form class=\"global-search\" action=\"/search\" method=\"get\">\n        <a href=\"#\" class=\"d-icon-search btn btn-link search-submit\" data-track-group=\"search\" data-track-name=\"Search submit icon\"></a>\n        <input autocomplete=\"off\" type=\"text\" placeholder=\"Search Delicious\" id=\"search-field\" name=\"p\" tabindex=\"1\">\n        <div id=\"global-search-autocomplete-container\"></div>\n      </form>\n      <a class=\"help-prompt\" data-track-group=\"header links\" data-track-name=\"Wee question mark\">?</a>\n\n    </div>\n  </div>\n\n  <div class=\"banner-nav\">\n    <a href=\"/discover\" class=\"nav-link nav-discover\" data-track-group=\"header links\">Discover</a>\n\n    ";stack1=depth0.username;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.program(7,program7,data),fn:self.program(5,program5,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n  </div>\n\n  <div class=\"user-controls\">\n    ";stack1=depth0.username;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.program(11,program11,data),fn:self.program(9,program9,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n  </div>\n</div>\n";return buffer;});}});
window.require.define({"templates/layout/footer":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};return"<footer class=\"delicious-footer\">\n  <nav>\n    <ul>\n      <li><a href=\"/help\">Help</a></li>\n      <li><a href=\"/tools\">Tools</a></li>\n      <li><a href=\"http://blog.delicious.com/\">Blog</a></li>\n      <li><a href=\"/about\">About</a></li>\n      <li><a href=\"/terms\">Legal</a></li>\n      <li><a href=\"/terms-update\" id=\"terms-update-alert\">Update</a></li>\n      <li class=\"copyright\"><a href=\"http://avos.com\">&copy; AVOS 2013</a></li>\n    </ul>\n  </nav>\n</footer>";});}});
window.require.define({"templates/layout/help":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};return"<div class=\"help-wrapper\">\n  <ul class=\"help-container\">\n    <h4>Keyboard shortcuts</h4>\n\n    <li>\n      <div class=\"key\">/</div>\n      <span class=\"key-label\">Focus search field</span>\n    </li>\n\n    <li>\n      <div class=\"key\">&darr;</div>\n      <span class=\"key-label\">Show next link</span>\n    </li>\n\n    <li>\n      <div class=\"key\">&uarr;</div>\n      <span class=\"key-label\">Show previous link</span>\n    </li>\n\n    <li>\n      <div class=\"key\">Enter</div>\n      <span class=\"key-label\">Open current link</span>\n    </li>\n\n    <li>\n      <div class=\"key\">a</div>\n      <span class=\"key-label\">Add a new link</span>\n    </li>\n\n    <li>\n      <div class=\"key\">e</div>\n      <span class=\"key-label\">Add or edit selected link</span>\n    </li>\n\n    <li>\n      <div class=\"key\">1</div>\n      <span class=\"key-label\">Discover</span>\n    </li>\n\n    <li>\n      <div class=\"key\">2</div>\n      <span class=\"key-label\">Network</span>\n    </li>\n\n    <li>\n      <div class=\"key\">3</div>\n      <span class=\"key-label\">Remember</span>\n    </li>\n\n    <li>\n      <div class=\"key\">?</div>\n      <span class=\"key-label\">Show this help dialog</span>\n    </li>\n\n  </ul>\n\n  <ul class=\"help-container\">\n    <h4>Advanced search</h4>\n    <p>Search your own links with @me</p>\n    <p>Search your network with @network</p>\n    <p>Search for tags using a #</p>\n    <p>Search someone’s links with @username</p>\n    <br>\n    <p>You can chain search queries together:</p>\n    <p><b>@humphreybc design #css</b></p>\n    <p><b>@network lasagne</b></p>\n    <p><b>@me #\"web design\"</b></p>\n    <p><b>@me #android #mobile #design</b></p> \n    <br>\n    <p>Or just search everything:</p>\n    <p><b>Lasagne</b></p>\n    <p><b>#design</b></p>\n  </ul>\n</div>\n\n<div class=\"help-wrapper\">\n  <p>For general help using Delicious, visit <a href=\"/help\">delicious.com/help</a>\n</div>\n";});}});
window.require.define({"templates/layout/login_modal":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};return"<form data-action=\"login\" method=\"POST\" class=\"login-form\" action=\"/login\">\n  <div class=\"modal-body\">\n    <label for=\"input-username\">Username</label>\n    <input id=\"input-username\" name=\"username\" type=\"text\" tabindex=\"1\">\n\n    <label for=\"input-password\">Password</label>\n    <input id=\"input-password\" name=\"password\" type=\"password\" tabindex=\"2\">\n  </div>\n  <div class=\"modal-footer\">\n    <button type=\"submit\" class=\"btn btn-primary\" tabindex=\"3\" data-loading-text=\"Signing in&hellip;\">Sign in</button>\n    <a class=\"btn-link btn-mini pull-left\" href=\"https://settings.delicious.com/forgot_pw\" target=\"_blank\">Forgot password</a><a class=\"btn-link btn-mini pull-left\" href=\"/join\">Create an account</a>\n  </div>\n</form>";});}});
window.require.define({"templates/layout/logo_dialog":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};return"<div class=\"modal-body\">\n  <p>Don’t use a pixelated asset! Download our logo and branding pack with vectors and high resolution PNGs.</p> \n  <p>It includes a vector PSD file with the logo, and PNGs in 8 sizes from 16px all the way to 1024px.</p>\n  <br>\n</div>\n<div class=\"modal-footer\">\n  <a href=\"https://s3.amazonaws.com/avos-site-images/delicious-logo-rev1.zip\" class=\"btn btn-primary\">Download vector logo pack</a>\n</div>\n";});}});
window.require.define({"templates/layout/page":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;partials=partials||Handlebars.partials;data=data||{};var buffer="",stack1,stack2,functionType="function",escapeExpression=this.escapeExpression,self=this;function program1(depth0,data){var buffer="",stack1,stack2;buffer+="\n    <ul class=\"section_nav\">\n      ";stack1=depth0.nav;stack2={};stack1=helpers.each.call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(2,program2,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n    </ul>\n    ";return buffer;}
function program2(depth0,data){var buffer="",stack1,stack2,foundHelper;buffer+="\n          <li>\n            <a data-page-id=\"";foundHelper=helpers.id;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.id;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" href=\"";stack1=depth0.external;stack2={};stack1=helpers.unless.call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(3,program3,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
foundHelper=helpers.url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\">";foundHelper=helpers.title;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.title;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"</a>\n\n            ";stack1=depth0.active;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(5,program5,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n          </li>\n      ";return buffer;}
function program3(depth0,data){return"/";}
function program5(depth0,data){var buffer="",stack1,stack2;buffer+="\n              <ul class=\"section_subnav\">\n              ";stack1=depth0.subpages;stack2={};stack1=helpers.each.call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(6,program6,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n              </ul>\n            ";return buffer;}
function program6(depth0,data){var buffer="",stack1,stack2,foundHelper;buffer+="\n                <li><a data-page-id=\"";foundHelper=helpers.id;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.id;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" href=\"";stack1=depth0.external;stack2={};stack1=helpers.unless.call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(7,program7,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
foundHelper=helpers.url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" class=\"subnav\n            ";stack1=depth0.active;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(9,program9,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\">";foundHelper=helpers.title;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.title;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"</a></li>\n              ";return buffer;}
function program7(depth0,data){return"/";}
function program9(depth0,data){return" active";}
buffer+="<div class=\"row\">\n  <div class=\"span2 sidebar flexible\">\n    ";stack1=depth0.nav;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(1,program1,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n    ";stack1=depth0;stack1=self.invokePartial(partials.footer,'footer',stack1,helpers,partials,data);if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n  </div>\n  <div class=\"span10\">\n    <div class=\"content\"></div>\n  </div>\n  <div class=\"span2 flexible sidebar_bg\"></div>\n</div>";return buffer;});}});
window.require.define({"templates/links/add_from_url":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};return"<form data-action=\"addFromUrl\">\n  <div class=\"modal-body\">\n    <label>URL</label>\n    <input type=\"text\" name=\"new-url\" value=\"\" placeholder=\"http://\">\n  </div>\n\n  <div class=\"modal-footer\">\n    <div class=\"pull-left\">\n      <p style=\"margin-top:10px;\">Have you tried <a href=\"/tools\">our bookmarklet or iOS app?</a>\n    </div>\n\n    <button type=\"submit\" class=\"btn btn-primary\">Add link</button>\n  </div>\n</form>";});}});
window.require.define({"templates/links/bulk":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};var buffer="",stack1,stack2,foundHelper,functionType="function",escapeExpression=this.escapeExpression,self=this,blockHelperMissing=helpers.blockHelperMissing;function program1(depth0,data){var stack1,foundHelper;foundHelper=helpers.tags;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.tags;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
return escapeExpression(stack1);}
buffer+="<form>\n  <div class=\"modal-body\">\n    <h3>Replace tags in all selected links with the following:</h3>\n    <label>Enter tags separated by commas</label>\n\n    <input name=\"tags\" type=\"text\" value=\"";foundHelper=helpers.isMyLink;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data});}
else{stack1=depth0.isMyLink;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.isMyLink){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(1,program1,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="\" placeholder=\"\" id=\"input-tags-bulk\" style=\"width: 100%\">\n    \n  </div>\n\n  <div class=\"modal-options\">\n    <button type=\"submit\" class=\"btn btn-primary\" data-loading-text=\"Saving...\">Replace Tags</button>\n  </div>\n</form>";return buffer;});}});
window.require.define({"templates/links/detail":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;partials=partials||Handlebars.partials;data=data||{};var buffer="",stack1,stack2,foundHelper,helperMissing=helpers.helperMissing,escapeExpression=this.escapeExpression,functionType="function",self=this,blockHelperMissing=helpers.blockHelperMissing;function program1(depth0,data){var buffer="",stack1,stack2,foundHelper;buffer+="\n      <small class=\"date-added\"><time datetime=\"";stack1=depth0.time_created;stack2={};foundHelper=helpers.formatMachineDate;stack1=foundHelper?foundHelper.call(depth0,stack1,{hash:stack2,data:data}):helperMissing.call(depth0,"formatMachineDate",stack1,{hash:stack2,data:data});buffer+=escapeExpression(stack1)+"\">Added ";stack1=depth0.time_created;stack2={};foundHelper=helpers.formatDate;stack1=foundHelper?foundHelper.call(depth0,stack1,{hash:stack2,data:data}):helperMissing.call(depth0,"formatDate",stack1,{hash:stack2,data:data});buffer+=escapeExpression(stack1)+"</time></small>\n    ";return buffer;}
function program3(depth0,data){var buffer="",stack1,foundHelper;buffer+="\n      <p>";foundHelper=helpers.description;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.description;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"</p>\n    ";return buffer;}
function program5(depth0,data){var buffer="",stack1,stack2,foundHelper;buffer+="\n  <div class=\"comments\">\n    <div class=\"comment\">\n      ";foundHelper=helpers.isMyLink;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.noop,fn:self.program(6,program6,data),data:data});}
else{stack1=depth0.isMyLink;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.isMyLink){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(6,program6,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n    </div>\n  </div>\n  ";return buffer;}
function program6(depth0,data){var buffer="",stack1,foundHelper;buffer+="\n      <h4>\n        <span class=\"your-note\">Your Comment</span>\n      </h4>\n      <p>";foundHelper=helpers.noteAsHTMLWithLineBreaks;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.noteAsHTMLWithLineBreaks;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="</p>\n      ";return buffer;}
buffer+="<div class=\"link-details-content scrollable\">\n  ";foundHelper=helpers.linkPreview;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.linkPreview;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\n\n  <nav>\n    <div class=\"btn link-details-count disabled\">\n      ";stack1=depth0.num_saves;stack2={};foundHelper=helpers.commafy;stack1=foundHelper?foundHelper.call(depth0,stack1,{hash:stack2,data:data}):helperMissing.call(depth0,"commafy",stack1,{hash:stack2,data:data});buffer+=escapeExpression(stack1)+"\n    </div>\n\n    <div id=\"details-share-button-wrapper\">\n      <a href=\"#\" class=\"d-icon-share btn\" id=\"details-share-button\" data-track-group=\"details pane\" title=\"Share this link\"></a>\n      ";stack1=depth0;stack1=self.invokePartial(partials.share,'share',stack1,helpers,partials,data);if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n    </div>\n  </nav>\n\n  <h2><a href=\"//avosapi.delicious.com/api/v1/posts/redirect?url=";foundHelper=helpers.encodedUrl;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.encodedUrl;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" title=\"";foundHelper=helpers.title;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.title;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" rel=\"nofollow\" target=\"_blank\" data-track-group=\"link brick\" data-track-name=\"link title\">";foundHelper=helpers.titleOrURL;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.titleOrURL;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="</a></h2>\n\n  <div class=\"description\">\n    ";foundHelper=helpers.isMyLink;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data});}
else{stack1=depth0.isMyLink;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.isMyLink){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(1,program1,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n    ";stack1=depth0.description;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(3,program3,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n  </div>\n\n  ";stack1=depth0.note;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(5,program5,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n\n  <div class=\"others comments\">\n    Loading…\n  </div>\n</div>\n";return buffer;});}});
window.require.define({"templates/links/edit":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};var buffer="",stack1,stack2,foundHelper,functionType="function",escapeExpression=this.escapeExpression,self=this,blockHelperMissing=helpers.blockHelperMissing,helperMissing=helpers.helperMissing;function program1(depth0,data){var buffer="",stack1,foundHelper;buffer+="\n      <div class=\"swipe-wrap\">\n        ";foundHelper=helpers.outputImages;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.outputImages;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\n      </div>\n    ";return buffer;}
function program3(depth0,data){return"\n    ";}
function program5(depth0,data){return"\n      <div class=\"no-image\">\n        No image<br>:(\n      </div>\n    ";}
function program7(depth0,data){return" value=\"true\"";}
function program9(depth0,data){var stack1,foundHelper;foundHelper=helpers.tags;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.tags;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
return escapeExpression(stack1);}
function program11(depth0,data){var stack1,stack2,foundHelper;foundHelper=helpers.insertRecommendedTags;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.noop,fn:self.program(12,program12,data),data:data});}
else{stack1=depth0.insertRecommendedTags;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.insertRecommendedTags){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(12,program12,data),data:data});}
if(stack1||stack1===0){return stack1;}
else{return'';}}
function program12(depth0,data){var stack1,foundHelper;foundHelper=helpers.recommendedTags;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.recommendedTags;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
return escapeExpression(stack1);}
function program14(depth0,data){return" checked";}
function program16(depth0,data){var buffer="",stack1,stack2,foundHelper;buffer+="\n        <input name=\"showTags\" id=\"input-set-tags\" type=\"checkbox\"";foundHelper=helpers.isMyLink;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.program(19,program19,data),fn:self.program(17,program17,data),data:data});}
else{stack1=depth0.isMyLink;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.isMyLink){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.program(19,program19,data),fn:self.program(17,program17,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+=">\n        <label for=\"input-set-tags\">Insert recommended tags</label>\n      ";return buffer;}
function program17(depth0,data){var buffer="";return buffer;}
function program19(depth0,data){var stack1,stack2,foundHelper;foundHelper=helpers.insertRecommendedTags;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.noop,fn:self.program(20,program20,data),data:data});}
else{stack1=depth0.insertRecommendedTags;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.insertRecommendedTags){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(20,program20,data),data:data});}
if(stack1||stack1===0){return stack1;}
else{return'';}}
function program20(depth0,data){return" checked";}
function program22(depth0,data){return"\n        <label class=\"no-tags\">No recommended tags</label>\n      ";}
function program24(depth0,data){return"\n        <a href=\"#remove\" class=\"btn btn-danger btn-link\">Remove link</a>\n    ";}
function program26(depth0,data){return"Save changes";}
function program28(depth0,data){return"Add link";}
buffer+="<div class=\"edit-preview-image\">\n  <div class=\"swipe\">\n    ";foundHelper=helpers.hasImage;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data});}
else{stack1=depth0.hasImage;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.hasImage){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(1,program1,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n\n    <input type=\"hidden\" name=\"chosenImage\">\n\n    ";foundHelper=helpers.hasImage;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.program(5,program5,data),fn:self.program(3,program3,data),data:data});}
else{stack1=depth0.hasImage;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.hasImage){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.program(5,program5,data),fn:self.program(3,program3,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n  </div>\n</div>\n\n<form>\n  <div class=\"modal-body\">\n    <input type=\"hidden\" name=\"chosen_image_md5\">\n\n    <label for=\"input-title\">Link title</label>\n    <input id=\"input-title\" name=\"description\" type=\"text\" value=\"";foundHelper=helpers.title;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.title;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" placeholder=\"";foundHelper=helpers.url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" class=\"input-block\">\n\n    <div class=\"link-meta\">\n      <!-- <span class=\"link-url\">\n        <div class=\"link-favicon\" style=\"background-image: url(//www.google.com/s2/favicons?domain=";stack1=depth0.url;stack2={};foundHelper=helpers.linkDomain;stack1=foundHelper?foundHelper.call(depth0,stack1,{hash:stack2,data:data}):helperMissing.call(depth0,"linkDomain",stack1,{hash:stack2,data:data});buffer+=escapeExpression(stack1)+")\"></div>\n          ";foundHelper=helpers.url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\n      </span>\n      -->\n      <input type=\"hidden\" name=\"url\" value=\"";foundHelper=helpers.url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\">\n    </div>\n    <input type=\"hidden\" name=\"replace\"";foundHelper=helpers.isMyLink;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.noop,fn:self.program(7,program7,data),data:data});}
else{stack1=depth0.isMyLink;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.isMyLink){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(7,program7,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+=">\n\n    <label for=\"input-note\">Your comment</label>\n    <textarea name=\"note\" rows=\"3\" placeholder=\"What do you think of this link?\" id=\"input-note\">";foundHelper=helpers.note;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.note;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"</textarea>\n\n    <p class=\"char-count\">1000 characters left.</p>\n\n    <label for=\"input-tags\">Tags</label>\n    <input name=\"tags\" type=\"text\" value=\"";foundHelper=helpers.isMyLink;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.program(11,program11,data),fn:self.program(9,program9,data),data:data});}
else{stack1=depth0.isMyLink;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.isMyLink){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.program(11,program11,data),fn:self.program(9,program9,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="\" placeholder=\"Enter tags separated by commas\" id=\"input-tags\" style=\"width: 100%\">\n\n    <div class=\"half\">\n      <input name=\"private\" id=\"input-private\" type=\"checkbox\"";stack1=depth0['private'];stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(14,program14,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="> \n      <label for=\"input-private\">Private</label>\n    </div>\n\n    <div class=\"half pull-right\">\n      ";foundHelper=helpers.hasRecommendedTags;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.program(22,program22,data),fn:self.program(16,program16,data),data:data});}
else{stack1=depth0.hasRecommendedTags;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.hasRecommendedTags){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.program(22,program22,data),fn:self.program(16,program16,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n    </div>\n\n  </div>\n\n  <div class=\"modal-options\">\n    ";foundHelper=helpers.isMyLink;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.noop,fn:self.program(24,program24,data),data:data});}
else{stack1=depth0.isMyLink;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.isMyLink){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(24,program24,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n    <button type=\"submit\" class=\"btn btn-primary\" data-loading-text=\"Saving...\">";foundHelper=helpers.isMyLink;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.program(28,program28,data),fn:self.program(26,program26,data),data:data});}
else{stack1=depth0.isMyLink;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.isMyLink){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.program(28,program28,data),fn:self.program(26,program26,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="</button>\n  </div>\n</form>\n";return buffer;});}});
window.require.define({"templates/links/link":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};var buffer="",stack1,stack2,foundHelper,functionType="function",escapeExpression=this.escapeExpression,self=this,helperMissing=helpers.helperMissing,blockHelperMissing=helpers.blockHelperMissing;function program1(depth0,data){var buffer="",stack1,stack2,foundHelper;buffer+="\n  <nav class=\"link-tags\">\n    ";foundHelper=helpers.isDiscover;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.program(5,program5,data),fn:self.program(2,program2,data),data:data});}
else{stack1=depth0.isDiscover;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.isDiscover){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.program(5,program5,data),fn:self.program(2,program2,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n  </nav>\n  ";return buffer;}
function program2(depth0,data){var buffer="",stack1,stack2;buffer+="\n      ";stack1=depth0.rcmd_by;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(3,program3,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n    ";return buffer;}
function program3(depth0,data){var buffer="",stack1,foundHelper;buffer+="\n        <span class=\"recommended\">Recommended for you because ";foundHelper=helpers.rcmd_by;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.rcmd_by;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+".</span>\n      ";return buffer;}
function program5(depth0,data){var buffer="",stack1,stack2,foundHelper;buffer+="\n      <span class=\"d-icon-tag\"></span>\n      ";stack1=depth0.tags;stack2={};stack2['limit']=100;foundHelper=helpers.linkTags;stack1=foundHelper?foundHelper.call(depth0,stack1,{hash:stack2,data:data}):helperMissing.call(depth0,"linkTags",stack1,{hash:stack2,data:data});buffer+=escapeExpression(stack1)+"\n    ";return buffer;}
function program7(depth0,data){return"\n    <a class=\"btn\" title=\"Edit this link\" href=\"#edit\" data-track-group=\"link brick\"><span class=\"d-icon-pencil\" id=\"edit-icon\"></span></a>\n\n    <a class=\"btn\" href=\"#bulk-edit\"><span class=\"d-icon-checkmark\"></span></a>\n\n  ";}
function program9(depth0,data){return"\n    <a class=\"btn\" title=\"Add this link\" href=\"#edit\" data-track-group=\"link brick\"><span class=\"d-icon-plus\" id=\"add-icon\"></span></a>\n  ";}
function program11(depth0,data){return"<div class=\"d-icon-lock\">private</div>";}
function program13(depth0,data){var buffer="",stack1,stack2;buffer+="\n  ";stack1=depth0.note;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(14,program14,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n";return buffer;}
function program14(depth0,data){var buffer="",stack1,foundHelper;buffer+="\n    <div class=\"link-note\"><p>";foundHelper=helpers.noteAsHTML;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.noteAsHTML;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="</p></div>\n  ";return buffer;}
function program16(depth0,data){var buffer="",stack1,stack2;buffer+="\n  ";stack1=depth0.note;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.program(19,program19,data),fn:self.program(17,program17,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n";return buffer;}
function program17(depth0,data){var buffer="",stack1,stack2,foundHelper;buffer+="\n    <div class=\"link-note link-savers\"><p>";stack1=depth0.savers;stack2={};foundHelper=helpers.linkSavers;stack1=foundHelper?foundHelper.call(depth0,stack1,{hash:stack2,data:data}):helperMissing.call(depth0,"linkSavers",stack1,{hash:stack2,data:data});buffer+=escapeExpression(stack1)+" ";foundHelper=helpers.noteAsHTML;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.noteAsHTML;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="</p></div>\n  ";return buffer;}
function program19(depth0,data){var buffer="",stack1,stack2,foundHelper;buffer+="\n    <div class=\"link-note link-savers\"><p>";stack1=depth0.savers;stack2={};foundHelper=helpers.linkSavers;stack1=foundHelper?foundHelper.call(depth0,stack1,{hash:stack2,data:data}):helperMissing.call(depth0,"linkSavers",stack1,{hash:stack2,data:data});buffer+=escapeExpression(stack1)+"</p></div>\n  ";return buffer;}
buffer+="<h3 class=\"link-title\">\n  <a href=\"http://";foundHelper=helpers.randomApiHost;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.randomApiHost;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1);stack1=depth0.avosConfig;stack1=stack1==null||stack1===false?stack1:stack1.api_path;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;buffer+=escapeExpression(stack1)+"/posts/redirect?request_id=";foundHelper=helpers.request_id;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.request_id;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"&amp;url=";foundHelper=helpers.encodedUrl;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.encodedUrl;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" title=\"";foundHelper=helpers.title;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.title;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" rel=\"nofollow\" target=\"_blank\" data-track-group=\"link brick\" data-track-name=\"link title\">";foundHelper=helpers.titleOrURL;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.titleOrURL;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="</a>\n</h3>\n\n<div class=\"link-meta\">\n  <span class=\"link-url\" title=\"";foundHelper=helpers.url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\">\n    <div class=\"link-favicon\" style=\"background-image: url(//www.google.com/s2/favicons?domain=";stack1=depth0.url;stack2={};foundHelper=helpers.linkDomain;stack1=foundHelper?foundHelper.call(depth0,stack1,{hash:stack2,data:data}):helperMissing.call(depth0,"linkDomain",stack1,{hash:stack2,data:data});buffer+=escapeExpression(stack1)+")\"></div>\n    ";stack1=depth0.url;stack2={};foundHelper=helpers.linkDomain;stack1=foundHelper?foundHelper.call(depth0,stack1,{hash:stack2,data:data}):helperMissing.call(depth0,"linkDomain",stack1,{hash:stack2,data:data});buffer+=escapeExpression(stack1)+"\n  </span>\n  ";stack1=depth0.tags;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(1,program1,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n</div>\n\n<div class=\"link-badge\">\n  ";foundHelper=helpers.isMyLink;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.program(9,program9,data),fn:self.program(7,program7,data),data:data});}
else{stack1=depth0.isMyLink;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.isMyLink){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.program(9,program9,data),fn:self.program(7,program7,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n  ";stack1=depth0['private'];stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(11,program11,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n</div>\n\n";foundHelper=helpers.isMyLink;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.program(16,program16,data),fn:self.program(13,program13,data),data:data});}
else{stack1=depth0.isMyLink;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.isMyLink){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.program(16,program16,data),fn:self.program(13,program13,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n";return buffer;});}});
window.require.define({"templates/links/list":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};return"<div class=\"link-list\"> \n  <div class=\"loading\"></div>\n</div>\n\n<div class=\"alert alert-info no-results\">No results found.</div>\n";});}});
window.require.define({"templates/links/share":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};var buffer="",stack1,foundHelper,functionType="function",escapeExpression=this.escapeExpression;buffer+="<div class=\"link-share\">\n  <a href=\"https://twitter.com/share?text=";foundHelper=helpers.title;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.title;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"&url=";foundHelper=helpers.url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"&via=delicious\" class=\"btn btn-primary d-icon-twitter share-popup\" id=\"share-twitter\"></a>\n\n  <a href=\"http://www.facebook.com/share.php?u=";foundHelper=helpers.url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" class=\"btn btn-primary d-icon-facebook share-popup\" id=\"share-facebook\"></a>\n\n  <a href=\"https://plus.google.com/share?url=";foundHelper=helpers.url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" class=\"btn btn-primary d-icon-googleplus share-popup\" id=\"share-googleplus\"></a>\n\n  <a href=\"mailto:?subject=";foundHelper=helpers.title;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.title;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"&amp;body=";foundHelper=helpers.url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" class=\"btn d-icon-mail share-popup\" id=\"share-mail\"></a>\n</div>";return buffer;});}});
window.require.define({"templates/links/warn":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};var buffer="",stack1,foundHelper,functionType="function",escapeExpression=this.escapeExpression;buffer+="<h1>The page you are being redirected to is untrusted.</h1>\n<h3 class=\"link-title\">\n  Click to continue on to <a href=\"";foundHelper=helpers.url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" title=\"";foundHelper=helpers.url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" rel=\"nofollow\" data-track-group=\"link brick\" data-track-name=\"link title\">";foundHelper=helpers.url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="</a>\n</h3>";return buffer;});}});
window.require.define({"templates/notes/note":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};var buffer="",stack1,foundHelper,functionType="function",escapeExpression=this.escapeExpression;buffer+="<div class=\"avatar\" style=\"background-image: url(https://zeen-proxy.imgix.net/https:";foundHelper=helpers.avatar_url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.avatar_url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"?w=20&h=20&fit=crop);\"></div>\n\n<h5><a href=\"/";foundHelper=helpers.user_name;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.user_name;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" data-user=\"";foundHelper=helpers.user_name;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.user_name;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" data-track-group=\"notes\" data-track-name=\"a username\">";foundHelper=helpers.displayName;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.displayName;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"</a></h5>\n\n<article><p>";foundHelper=helpers.noteAsHTMLWithLineBreaks;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.noteAsHTMLWithLineBreaks;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="</p></article>\n";return buffer;});}});
window.require.define({"templates/old-home":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};return"<header class=\"home-header\">\n    <div class=\"page-header-inner container\">\n        <h1>Over 1 billion links served daily.</h1>\n        <div class=\"page-header-input\">\n            <a class=\"logo\"></a>\n            <form action=\"/search\" method=\"get\" class=\"home-search\">\n                <a href=\"#\" class=\"d-icon-search btn btn-link\" onclick=\"_gaq.push(['_trackEvent', 'homepage', 'click', 'Search submit icon']);\"></a>\n                <input id=\"search-field\" autocomplete=\"off\" type=\"text\" placeholder=\"Search Delicious…\" name=\"p\">\n            </form>\n        </div>\n        <div class=\"signin-signup-container\">\n            <div id=\"home-options\">\n                <a class=\"btn btn-primary\" id=\"signin-link\" href=\"#login\" onclick=\"_gaq.push(['_trackEvent', 'homepage', 'click', 'Sign in']);\">Sign in</a>\n                <a class=\"btn btn-primary\" id=\"join-link\" href=\"join\" onclick=\"_gaq.push(['_trackEvent', 'homepage', 'click', 'Join Delicious']);\">Join Delicious</a>\n            </div>\n        </div>\n    </div>\n</header>\n<div class=\"container\">\n    <section class=\"features row\">\n        <div class=\"span4\">\n            <h3 class=\"d-icon-plus\">Save</h3>\n            <p>Don’t lose the interesting stuff you discover or share on the web.</p>\n        </div>\n        <div class=\"span4\">\n            <h3 class=\"d-icon-tag\">Sort</h3>\n            <p>Tag and group your links to easily find them later.</p>\n        </div>\n        <div class=\"span4\">\n            <h3 class=\"d-icon-search\">Search</h3>\n            <p>Search links added by the community and discover awesome.</p>\n        </div>\n    </section>\n</div>\n";});}});
window.require.define({"templates/onboarding/join":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};return"<div class=\"slide-wrapper clearfix\">\n\n	<div class=\"slide slide1 active\">\n		<div class=\"join-surround start\">\n			<h1>Join Delicious</h1>\n			<div class=\"box\">\n				<button id=\"connect-facebook\" class=\"btn btn-block btn-primary\">Sign in with Facebook</button>\n				<button id=\"connect-twitter\" class=\"btn btn-block btn-primary\">Sign in with Twitter</button>\n				<hr>\n				<p id=\"no-social\">Don’t have a Facebook or Twitter account?</p>\n				<br>\n				<button id=\"create-account\" class=\"btn btn-block\">Create an account</button>\n			</div>\n		</div>\n	</div>\n\n	<div class=\"slide slide2\">\n		<div class=\"join-surround\">\n			<h1>Create an account</h1>\n			<div class=\"box\">\n				<form>\n					<label for=\"user-full-name\">Display name</label>\n					<input type=\"text\" id=\"user-full-name\" class=\"input-block\" placeholder=\"eg. Your name or company.\">\n					<label for=\"user-email\">Your email address</label>\n					<input type=\"text\" id=\"user-email\" class=\"input-block\">\n					<label for=\"user-username\">Choose a username</label>\n					<input type=\"text\" id=\"user-username\" class=\"input-block\">\n					<label for=\"user-password\">Type a password (minimum 8 characters, no spaces)</label>\n					<input type=\"password\" id=\"user-password\" class=\"input-block\" placeholder=\"Try using a sentence for a strong password.\">\n\n					<label for=\"check-password\" class=\"checkbox \"><input type=\"checkbox\" id=\"check-password\" class=\"checkbox inline\">Show password</label>\n						\n					<div id=\"join-captcha\">\n						<div id=\"recaptcha_widget\">\n\n						  <div id=\"recaptcha_image\" style=\"width:320px\"></div>\n\n						  <input type=\"text\" id=\"recaptcha_response_field\" name=\"recaptcha_response_field\" placeholder=\"Please enter the two words you see above\">\n\n						  <div id=\"recaptcha_help\">\n							  <div><a href=\"javascript:Recaptcha.reload()\">Having difficulty? Click to refresh the Captcha.</a></div>\n							  <div class=\"recaptcha_only_if_image\"><a href=\"javascript:Recaptcha.switch_type('audio')\">Switch to audio.</a></div>\n							  <div class=\"recaptcha_only_if_audio\"><a href=\"javascript:Recaptcha.switch_type('image')\">Switch to image.</a></div>\n							</div>\n\n						</div>\n\n					</div>\n					<div class=\"error_info\"></div>\n\n					<div class=\"box-inset\">\n						<input type=\"submit\" id=\"user-register\" class=\"btn btn-primary pull-right\" value=\"Join Delicious\">\n					</div>\n				</form>\n			</div>\n			<p id=\"terms-agree\">By clicking Join Delicious you agree to the <a href=\"/terms\" target=\"_blank\">Terms &amp; Conditions.</a></p>\n		</div>\n	</div>\n\n</div>";});}});
window.require.define({"templates/oops/notfound":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};return"<h1>404 — page doesn’t exist!</h1>\n\n<p>You may have followed a broken link or mistyped the web \naddress. If you think this is a mistake on our part, please \n<a href=\"mailto:support@delicious.com\">send us some feedback.</a></p>";});}});
window.require.define({"templates/oops/somethingwentwrong":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;partials=partials||Handlebars.partials;data=data||{};var buffer="",stack1,self=this;buffer+="<div class=\"logo\"></div>\n\n<h1>We’re sorry! Something has gone wrong.</h1>\n\n<p>Try refreshing the page you were on. If that doesn’t work, it’s our fault and we’re most likely fixing the problem right now! If you continue experiencing issues feel free to <a href=\"mailto:support@delicious.com\">email us.</a></p>\n\n";stack1=depth0;stack1=self.invokePartial(partials.footer,'footer',stack1,helpers,partials,data);if(stack1||stack1===0){buffer+=stack1;}
return buffer;});}});
window.require.define({"templates/search/results":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;partials=partials||Handlebars.partials;data=data||{};var buffer="",stack1,stack2,self=this;function program1(depth0,data){return"\n      <div class=\"links-container you\">\n      </div>\n      <div class=\"links-container network\">\n      </div>\n    ";}
buffer+="<div class=\"row\">\n  <section class=\"sidebar span2\">\n\n    <!-- recent tags -->\n    <div class=\"tags-container recent\">\n      <h4>Recent Tags</h4>\n      <div class=\"tag-list\"></div>\n      <h5 class=\"no-results meta\">No recent tags</h5>\n    </div>\n\n    <!-- related tags -->\n    <div class=\"tags-container related\">\n      <h4>Related Tags</h4>\n      <div class=\"tag-list\"></div>\n      <h5 class=\"no-results meta\">No related tags</h5>\n    </div>\n    ";stack1=depth0;stack1=self.invokePartial(partials.footer,'footer',stack1,helpers,partials,data);if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n  </section>\n\n  <section id=\"links-results\" class=\"span6\">\n    ";stack1=depth0.isLoggedIn;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(1,program1,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n    <div class=\"links-container everyone\">\n    </div>\n  </section>\n</div>\n";return buffer;});}});
window.require.define({"templates/tags/edit_bundle_modal":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};var buffer="",stack1,stack2,foundHelper,functionType="function",escapeExpression=this.escapeExpression,self=this;function program1(depth0,data){return"<a href=\"#remove\" class=\"btn btn-danger btn-link\">Remove bundle</a>";}
buffer+="<form>\n  <div class=\"modal-body\">\n    <label for=\"input-name\">Bundle Name</label>\n    <input id=\"input-name\" name=\"name\" type=\"text\" value=\"";foundHelper=helpers.name;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.name;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" placeholder=\"";foundHelper=helpers.url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" class=\"input-block\">\n\n    <label for=\"input-tags\">Tags</label>\n    <input name=\"tags\" type=\"text\" value=\"";foundHelper=helpers.tags;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.tags;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" placeholder=\"Enter tags separated by commas\" id=\"input-tags\" style=\"width: 100%\">\n  </div>\n\n  <div class=\"modal-options\">\n    \n    ";stack1=depth0.name;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(1,program1,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n    \n    <button type=\"submit\" class=\"btn btn-primary\" data-loading-text=\"Saving...\">Save bundle</button>\n  </div>\n</form>";return buffer;});}});
window.require.define({"templates/tags/manage":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};return"<form>\n  <div class=\"modal-body\">\n\n    <div id=\"rename-tag\">\n      <label for=\"to-tagname\">Rename Tag</label>\n      <input type=\"text\" id=\"from-tagname\" name=\"from_tag\" placeholder=\"Select a tag to rename\" class=\"input-tag\">\n      <input type=\"text\" id=\"to-tagname\" name=\"to_tag\" placeholder=\"Enter new tag name\" class=\"input-tag\">\n    </div>\n\n    <div id=\"delete-tag\">\n      <label for=\"delete-tagname\">Delete Tag</label>\n      <input type=\"text\" id=\"delete-tagname\" name=\"delete_tag\" placeholder=\"Select a tag to delete\" class=\"input-tag\">\n    </div>\n\n  </div>\n\n  <div class=\"modal-options\">\n    <button type=\"submit\" class=\"btn btn-primary\" data-loading-text=\"Saving...\">Save changes</button>\n  </div>\n</form>\n";});}});
window.require.define({"templates/tags/tag_bundle_row":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};var buffer="",stack1,foundHelper,functionType="function",escapeExpression=this.escapeExpression;buffer+="<div class=\"pull-right\">\n  <a href=\"#edit-bundle\" class=\"btn\">Edit</a>\n</div>\n<h3>";foundHelper=helpers.name;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.name;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"</h3>";return buffer;});}});
window.require.define({"templates/tools/bookmarklet":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};return"<div class=\"box box-square span3\" id=\"bookmarklet-box\">\n\n  <span class=\"huge-icon d-icon-bookmark\"></span>\n\n  <span id=\"bookmarklet-wrapper-thing\">\n\n    <div id=\"bookmarklet-hint\">\n      <span class=\"dropdown-carrot\"></span>\n      <p>Make sure your bookmarks toolbar (or \"favorites\" bar for Internet Explorer) is visible, then drag this button there. Click ‘Add to Delicious’ any time you want to add a page.</p>\n    </div>\n\n    <a class=\"bookmarklet btn btn-primary\" id=\"bookmarklet-install-button\" title=\"Add to Delicious\" href='javascript:(function(){function f(i){if(i.origin!==e+\"\"+n&&i.origin!==t+\"\"+n){return}if(i.data===\"destroy_bookmarklet\"){var s=document.getElementById(r);if(s){document.body.removeChild(s);s=null}}}var e=\"http://\",t=\"https://\",n=\"delicious.com\",r=\"DELI_bookmarklet_iframe\",i=document.getElementById(r);if(i){return}var s=e+\"\"+n+\"/save?\",o=document.createElement(\"iframe\");o.id=r;o.src=s+\"url=\"+encodeURIComponent(window.location.href)+\"&title=\"+encodeURIComponent(document.title)+\"&note=\"+encodeURIComponent(\"\"+(window.getSelection?window.getSelection():document.getSelection?document.getSelection():document.selection.createRange().text))+\"&v=1.1\";o.style.position=\"fixed\";o.style.top=\"0\";o.style.left=\"0\";o.style.height=\"100%25\";o.style.width=\"100%25\";o.style.zIndex=\"16777270\";o.style.border=\"none\";o.style.visibility=\"hidden\";o.onload=function(){this.style.visibility=\"visible\"};document.body.appendChild(o);var u=window.addEventListener?\"addEventListener\":\"attachEvent\";var a=u==\"attachEvent\"?\"onmessage\":\"message\";window[u](a,f,false)})()'>Add to Delicious</a>\n    \n  </span>\n  \n  <div class=\"box-inset\"><h1>Bookmarklet</h1></div>\n\n</div>\n";});}});
window.require.define({"templates/user/coachmarks":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};return"<div class=\"container\">\n\n  <div class=\"top-left\">\n    <div class=\"wee-arrow\"></div>\n    <p id=\"cm-search\">Search your links or anything else on Delicious up here. Use @ or # to search people or tags, respectively.</p>\n  </div>\n\n  <div class=\"top-right\">\n    <div class=\"wee-arrow\"></div>\n    <p id=\"cm-user\">Click your name to see your links. Hover to change your settings or add a new link.</p>\n  </div>\n\n  <!-- <div class=\"bottom-right\">\n    <div class=\"wee-arrow\"></div>\n    <p id=\"cm-feedback\">Tell us what you think &mdash; or report a bug &mdash; using this handy feedback tab.</p>\n  </div> -->\n\n  <div id=\"cm-welcome-wrapper\">\n    <p id=\"cm-welcome\">Click to close</p>\n  </div>\n\n</div>\n";});}});
window.require.define({"templates/user/featured_followers_collectionview":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};return"<div id=\"featured-followers-refresh\" class=\"d-icon-refresh\"></div>\n<h2>Recommended People<a id=\"feat-foll-hide\" href=\"#\">Hide</a></h2>\n<ul id=\"featured-followers-container\"></ul>\n";});}});
window.require.define({"templates/user/profile":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;partials=partials||Handlebars.partials;data=data||{};var buffer="",stack1,stack2,foundHelper,functionType="function",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing,self=this,blockHelperMissing=helpers.blockHelperMissing;function program1(depth0,data){return"my ";}
function program3(depth0,data){var buffer="",stack1,foundHelper;foundHelper=helpers.displayName;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.displayName;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"’s ";return buffer;}
function program5(depth0,data){return"\n    ";}
function program7(depth0,data){var buffer="",stack1,foundHelper;buffer+="\n      ";stack1={};stack1['className']="btn-block";foundHelper=helpers.followButton;stack1=foundHelper?foundHelper.call(depth0,{hash:stack1,data:data}):helperMissing.call(depth0,"followButton",{hash:stack1,data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n    ";return buffer;}
function program9(depth0,data){var stack1,stack2,foundHelper;stack1=depth0.bookmark_count;stack2={};foundHelper=helpers.commafy;stack1=foundHelper?foundHelper.call(depth0,stack1,{hash:stack2,data:data}):helperMissing.call(depth0,"commafy",stack1,{hash:stack2,data:data});return escapeExpression(stack1);}
function program11(depth0,data){var stack1,stack2,foundHelper;stack1=depth0.public_bookmark_count;stack2={};foundHelper=helpers.commafy;stack1=foundHelper?foundHelper.call(depth0,stack1,{hash:stack2,data:data}):helperMissing.call(depth0,"commafy",stack1,{hash:stack2,data:data});return escapeExpression(stack1);}
function program13(depth0,data){var stack1,stack2,foundHelper;stack1=depth0.follower_count;stack2={};foundHelper=helpers.commafy;stack1=foundHelper?foundHelper.call(depth0,stack1,{hash:stack2,data:data}):helperMissing.call(depth0,"commafy",stack1,{hash:stack2,data:data});return escapeExpression(stack1);}
function program15(depth0,data){return"0";}
function program17(depth0,data){var buffer="",stack1,stack2,foundHelper;buffer+="\n        <div class=\"tags-container all exclusive-tag-search\">\n          <h4>\n            ";foundHelper=helpers.ifMe;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.program(20,program20,data),fn:self.program(18,program18,data),data:data});}
else{stack1=depth0.ifMe;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.ifMe){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.program(20,program20,data),fn:self.program(18,program18,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n            <div class=\"dropdown sort-tags-dropdown pull-right\">\n              <span class=\"sort-by dropdown-toggle\" data-toggle=\"dropdown\">Sort<span class=\"dropdown-carrot\"></span></span>\n              <ul class=\"dropdown-menu sort-by-menu\" role=\"menu\" aria-labelledby=\"dropdownMenu\">\n                <li><a id=\"sort-by-count\" href=\"#\">Count</a></li>\n                <li><a id=\"sort-by-abc\" href=\"#\">ABC</a></li>\n              </ul>\n            </div>\n          </h4>\n          <div class=\"tag-list\"></div>\n          <div clas=\"show-all\">\n            <a class=\"tags-see-all\" href=\"#more\">Show more</a>\n          </div>\n        </div>\n      ";return buffer;}
function program18(depth0,data){return"\n              <a id=\"your-tags-modal\" href=\"#\">Tags</a>\n            ";}
function program20(depth0,data){return"\n              Tags\n            ";}
function program22(depth0,data){return"\n            <a href=\"#bundles-manage\">Tag Bundles</a>\n          ";}
function program24(depth0,data){return"\n            <h4>Tag Bundles</h4>\n          ";}
function program26(depth0,data){var buffer="",stack1,foundHelper;buffer+="\n      <div class=\"alert alert-warning\"><a href=\"#login\">Sign in</a> to follow @";foundHelper=helpers.display_name;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.display_name;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"</div>\n    ";return buffer;}
function program28(depth0,data){var buffer="",stack1,foundHelper;buffer+="\n          ";foundHelper=helpers.profile_bio;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.profile_bio;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\n        ";return buffer;}
function program30(depth0,data){var buffer="",stack1,stack2,foundHelper;buffer+="\n          ";foundHelper=helpers.ifMe;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.program(33,program33,data),fn:self.program(31,program31,data),data:data});}
else{stack1=depth0.ifMe;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.ifMe){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.program(33,program33,data),fn:self.program(31,program31,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n        ";return buffer;}
function program31(depth0,data){return"\n            Tell the Delicious community about yourself on your <a href=\"/settings\">profile settings page.</a>\n          ";}
function program33(depth0,data){return"\n            <!-- This person hasn't filled out their bio yet. -->\n          ";}
function program35(depth0,data){var buffer="",stack1,foundHelper;buffer+="\n          <br><a href=\"";foundHelper=helpers.profile_url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.profile_url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" target=\"_blank\">";foundHelper=helpers.profile_url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.profile_url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"</a>\n        ";return buffer;}
function program37(depth0,data){var buffer="",stack1,stack2;buffer+="\n      ";stack1=depth0.bookmark_count;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.program(40,program40,data),fn:self.program(38,program38,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n    ";return buffer;}
function program38(depth0,data){return"\n        <div id=\"bulk-edit-actions\" class=\"hidden-tablet\">\n          <div id=\"bulk-edit-on\">\n            <div id=\"bulk-edit-dd\" class=\"btn-group btn-container\">\n              <a id=\"bulk-edit-dd-button\" class=\"btn btn-dropdown disabled\" data-toggle=\"dropdown\" href=\"#\">\n                <span id=\"bulk-edit-count\">0</span> selected<span class=\"dropdown-carrot\"></span></a>\n              <ul class=\"select-menu dropdown-menu\">\n                <li><a id=\"bulk-edit-make-public\" href=\"#public\">Make public</a></li>\n                <li><a id=\"bulk-edit-make-private\" href=\"#private\">Make private</a></li>\n                <li><a id=\"delete-links\" href=\"#delete-links\">Remove links</a></li>\n                <li><a id=\"bulk-edit-select-all\" href=\"#\">Select all</a></li>\n                <li><a id=\"bulk-edit-clear-selection\" href=\"#\">Clear Selection</a></li>\n              </ul>\n            </div>\n          </div>\n          <a id=\"bulk-edit-btn\" class=\"btn\">Edit links</a>\n          </div>\n          <div class=\"links-container\"></div>\n      ";}
function program40(depth0,data){var buffer="",stack1,stack2;buffer+="\n        ";stack1=depth0.following_count;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(41,program41,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n        <div id=\"profile-bookmarklet-install\">\n          ";stack1=depth0;stack1=self.invokePartial(partials['bookmarklet-box'],'bookmarklet-box',stack1,helpers,partials,data);if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n\n          <h2>Welcome to Delicious!</h2>\n          <p>Add links from anywhere on the web by installing our bookmarklet. Just drag the blue “Add to Delicious” button on the left to your bookmarks bar (or \"favorites\" bar for Internet Explorer).</p>\n          <br>\n          <p>Connect your <a href=\"/settings/sources\">Facebook or Twitter account</a> to import everything you’ve shared there.</p>\n          <br>\n          <p>If you find something you love on the <a href=\"/discover\">Discover page,</a> add it to your profile by using the + button next to each link.</p>\n        </div>\n      ";return buffer;}
function program41(depth0,data){var buffer="",stack1,foundHelper;buffer+="\n          <div id=\"following-friends\">\n          <p>You are now following ";foundHelper=helpers.following_count;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.following_count;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+" of your friends on Delicious. <a href=\"#following\">Click here to change.</a></p></div>\n        ";return buffer;}
function program43(depth0,data){var buffer="",stack1,stack2;buffer+="\n      ";stack1=depth0.public_bookmark_count;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.program(46,program46,data),fn:self.program(44,program44,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n    ";return buffer;}
function program44(depth0,data){return"\n        <div class=\"links-container\"></div>\n      ";}
function program46(depth0,data){return"\n        <p>This person doesn’t have any links yet.</p>\n      ";}
buffer+="<div class=\"row\">\n  <section class=\"span2 profile-sidebar\">\n\n    <div class=\"profile-avatar\" style=\"background-image:url(";foundHelper=helpers.avatar_url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.avatar_url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+")\">\n      <div class=\"avatar-overlay\">\n        <div class=\"tweet-profile\">\n          <a href=\"//twitter.com/share\" class=\"socialite twitter-share\" data-count=\"none\" data-text=\"Check out ";foundHelper=helpers.ifMe;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data});}
else{stack1=depth0.ifMe;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.ifMe){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="links on @Delicious!\" data-url=\"http://delicious.com/";foundHelper=helpers.username;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.username;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" data-count=\"horizontal\" rel=\"nofollow\" target=\"_blank\"></a>\n        </div>\n      </div>\n    </div>\n\n    ";foundHelper=helpers.ifMe;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.program(7,program7,data),fn:self.program(5,program5,data),data:data});}
else{stack1=depth0.ifMe;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.ifMe){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.program(7,program7,data),fn:self.program(5,program5,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n\n    <nav class=\"user-stats\">\n\n      <span class=\"link-count\">Links <small>";foundHelper=helpers.ifMe;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.program(11,program11,data),fn:self.program(9,program9,data),data:data});}
else{stack1=depth0.ifMe;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.ifMe){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.program(11,program11,data),fn:self.program(9,program9,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="</small></span>\n      <br>\n      <a href=\"#followers\" data-track-group=\"profile page\" data-track-name=\"Followers\">Followers <small>";stack1=depth0.follower_count;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.program(15,program15,data),fn:self.program(13,program13,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="</small></a>\n      <br>\n      <a href=\"#following\" data-track-group=\"profile page\" data-track-name=\"Following\">Following <small>";stack1=depth0.following_count;stack2={};foundHelper=helpers.commafy;stack1=foundHelper?foundHelper.call(depth0,stack1,{hash:stack2,data:data}):helperMissing.call(depth0,"commafy",stack1,{hash:stack2,data:data});buffer+=escapeExpression(stack1)+"</small></a>\n    </nav>\n\n    <span class=\"sidebar-meta\">\n\n      <!-- related tags -->\n      <div class=\"tags-container related\">\n        <h4>Related Tags</h4>\n        <div class=\"tag-list\"></div>\n      </div>\n\n      <!-- all tags -->\n      ";stack1=depth0.tag_count;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(17,program17,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n\n      <!-- tags in bundle -->\n      <div class=\"tags-container in-bundle exclusive-tag-search\">\n        <h4>Tags in Bundle</h4>\n        <div class=\"tag-list\"></div>\n      </div>\n\n      <!-- tag bundles -->\n      <div class=\"tag-bundles-container\">\n        <h4>\n          ";foundHelper=helpers.ifMe;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.program(24,program24,data),fn:self.program(22,program22,data),data:data});}
else{stack1=depth0.ifMe;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.ifMe){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.program(24,program24,data),fn:self.program(22,program22,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n        </h4>\n        <div class=\"sidebar-list\"></div>\n      </div>\n\n    </span>\n    ";stack1=depth0;stack1=self.invokePartial(partials.footer,'footer',stack1,helpers,partials,data);if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n\n  </section>\n  <section class=\"span6\">\n    ";stack1=depth0.username;stack2={};stack1=helpers.unless.call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(26,program26,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n\n    <div class=\"profile-header\">\n      <h1>";foundHelper=helpers.full_name;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.full_name;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+" <small><a href=\"/";foundHelper=helpers.username;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.username;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\">@";stack1=depth0.display_name;stack2={};foundHelper=helpers.decode;stack1=foundHelper?foundHelper.call(depth0,stack1,{hash:stack2,data:data}):helperMissing.call(depth0,"decode",stack1,{hash:stack2,data:data});buffer+=escapeExpression(stack1)+"</a></small></h1>\n      <p class=\"profile-bio\">\n\n        ";stack1=depth0.profile_bio;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.program(30,program30,data),fn:self.program(28,program28,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n\n        ";stack1=depth0.profile_url;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(35,program35,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n      </p>\n\n    </div>\n\n    ";foundHelper=helpers.ifMe;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},inverse:self.program(43,program43,data),fn:self.program(37,program37,data),data:data});}
else{stack1=depth0.ifMe;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
stack2={};if(!helpers.ifMe){stack1=blockHelperMissing.call(depth0,stack1,{hash:stack2,inverse:self.program(43,program43,data),fn:self.program(37,program37,data),data:data});}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n\n  </section>\n</div>\n";return buffer;});}});
window.require.define({"templates/user/settings/account":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};var buffer="",stack1,stack2,functionType="function",escapeExpression=this.escapeExpression,self=this;function program1(depth0,data){var stack1,foundHelper;foundHelper=helpers.profile_email;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.profile_email;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
return escapeExpression(stack1);}
function program3(depth0,data){var stack1,foundHelper;foundHelper=helpers.email;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.email;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
return escapeExpression(stack1);}
buffer+="<form enctype=\"multipart/form-data\" id=\"settings-form\">\n  <div class=\"row settings\">\n\n    <div class=\"span7\">\n      <h1>Account settings<span class=\"subtitle\">Change your email address and password.</span></h1>\n      <br>\n\n      <fieldset>\n        <label for=\"user-email\">Email Address</label>\n        <input name=\"profile_email\" type=\"text\" id=\"user-email\" class=\"input-xlarge\" placeholder=\"example@gmail.com\" value=\"";stack1=depth0.profile_email;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\"></input>\n      </fieldset>\n\n      <h3>Change your password</h3>\n      <br>\n\n      <fieldset>\n        <label for=\"user-old-password\">Current Password</label>\n        <input name=\"old_password\" type=\"password\" id=\"user-old-password\" class=\"input-xlarge\"></input>\n      </fieldset>\n\n      <fieldset>\n        <label for=\"user-new-password\">New Password</label>\n        <input name=\"new_password\" type=\"password\" id=\"user-new-password\" class=\"input-xlarge\"></input>\n      </fieldset>\n\n      <div>\n        <p id=\"error\" class=\"error\"></p>\n      </div>\n\n      <div class=\"form-buttons\">\n        <input type=\"submit\" class=\"btn btn-primary\" value=\"Save changes\">\n      </div>\n\n      <br>\n      <p>Note: If you are using private RSS feeds, you will need to update these after you change your password.</p>\n      <br>\n\n      <a href=\"https://settings.delicious.com/settings/deactivate\" target=\"_blank\" class=\"preview-note\">Deactivate my account</a>\n    </div>\n\n  </div>\n</form>\n";return buffer;});}});
window.require.define({"templates/user/settings/facebook":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};var buffer="",stack1,stack2,foundHelper,functionType="function",escapeExpression=this.escapeExpression,self=this;function program1(depth0,data){var buffer="",stack1,stack2,foundHelper;buffer+="\n            <option value=\"";foundHelper=helpers.value;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.value;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" ";stack1=depth0.selected;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(2,program2,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+=">";foundHelper=helpers.text;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.text;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"</option>\n          ";return buffer;}
function program2(depth0,data){return"selected=\"selected\"";}
buffer+="<form enctype=\"multipart/form-data\" id=\"settings-form\">\n  <div class=\"row settings\">\n    <div class=\"span10\">\n      <h1>Importing links from Facebook</h1>\n      <br>\n    </div>\n    <div class=\"span10\">\n\n      <fieldset>\n        <label for=\"privacy\">When importing links...</label>\n        <select name=\"privacy\" class=\"input-xlarge\" disabled=\"disabled\">\n          ";stack1=depth0.options;stack2={};stack1=helpers.each.call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(1,program1,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n        </select>\n      </fieldset>\n\n      <fieldset>\n        <label for=\"tags\">Add these tags to imported links</label>\n        <input name=\"tags\" type=\"text\" id=\"user-full-name\" class=\"input-xlarge\" placeholder=\"from facebook\" value=\"";foundHelper=helpers.tags;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.tags;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" disabled=\"disabled\"></input>\n      </fieldset>\n      \n      <div class=\"form-buttons\">\n        <input type=\"submit\" class=\"btn btn-primary\" value=\"Save changes\" disabled=\"disabled\">\n      </div>\n\n    </div>\n\n    <div class=\"span5 description\">\n      <br>\n      <p>Links you share on Facebook or post on your own wall will be imported to Delicious.</p>\n      <p>Links are not imported in real time. Depending on circumstances, it can be as little as five minutes or as long as 24 hours before they appear on Delicious.</p>\n      <a class=\"disconnect\" href=\"#\">Disconnect from Facebook as ";foundHelper=helpers.providerDisplayname;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.providerDisplayname;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"</a>\n    </div>\n\n  </div>\n</form>\n";return buffer;});}});
window.require.define({"templates/user/settings/settings":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};var buffer="",stack1,foundHelper,functionType="function",escapeExpression=this.escapeExpression;buffer+="<div class=\"row settings\">\n  <div class=\"span7\">\n    <h1>Your Profile<span class=\"subtitle\">Visible to the public.</span></h1>\n    <br>\n  </div>\n  <div class=\"span4\">\n    <form id=\"settings-form\">\n      <fieldset>\n        <label for=\"user-full-name\">Your name</label>\n        <input name=\"full_name\" type=\"text\" id=\"user-full-name\" class=\"span4\" placeholder=\"Example: Lauren Ipsum\" value=\"";foundHelper=helpers.full_name;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.full_name;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\"></input>\n      </fieldset>\n\n      <fieldset>\n        <label for=\"user-bio\">Tell the world about yourself</label>\n        <textarea name=\"profile_bio\" type=\"text\" cols=\"10\" rows=\"6\" id=\"user-bio\" class=\"span4\" maxlength=\"140\">";foundHelper=helpers.profile_bio;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.profile_bio;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"</textarea>\n        <div id=\"bio-count\">140 characters left.</div>\n      </fieldset>\n      <fieldset>\n        <label for=\"user-website\">Your website</label>\n          <input name=\"profile_url\" type=\"text\" id=\"user-website\" class=\"span4\" value=\"";foundHelper=helpers.profile_url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.profile_url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" placeholder=\"http://\"></input>\n      </fieldset>\n      <div class=\"form-buttons\">\n        <input type=\"submit\" class=\"btn btn-primary\" value=\"Save profile\">\n      </div>\n    </form>\n      \n  </div>\n\n  <div class=\"span3 photo-upload\">\n    <label for=\"user-avatar-input\">Your picture <span class=\"muted\">(max size 2MB)</span></label>\n    <div class=\"user-avatar\">\n      <img class=\"fade\" src=\"";foundHelper=helpers.avatar_url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.avatar_url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\">\n    </div>\n      <span class=\"muted upload-info\">For best results, choose a square image.</span>\n\n      <iframe id=\"upload-frame\" name=\"upload-frame\" height=\"0\" width=\"0\" frameborder=\"0\" scrolling=\"no\"></iframe>\n\n      <form id=\"photo-form\" target=\"upload-frame\" enctype=\"multipart/form-data\" method=\"post\">\n\n        <fieldset>\n          <div>\n            <p id=\"photo-upload-error\" class=\"error\"></p>\n          </div>\n          <div class=\"relative\">\n            <input name=\"photo\" type=\"file\" id=\"user-photo-input\">\n            <div id=\"user-photo-button\" class=\"clearfix\">\n              <button type=\"button\" class=\"btn\">Choose image</button>\n              <span id=\"user-photo-text\" class=\"flash red\">No image selected</span>\n            </div>\n          </div>\n        </fieldset>\n\n        <fieldset class=\"relative\">\n          <input type=\"submit\" value=\"Upload\" class=\"btn\">\n          <div class=\"loading-container\">\n            <span class=\"loading\"></span>\n          </div>\n        </fieldset>\n      </form>\n  </div>\n</div>";return buffer;});}});
window.require.define({"templates/user/settings/sources":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};return"<div class=\"row settings\">\n  <div class=\"span10\">\n    <h1>Connect sites to your Delicious account</h1>\n    <p>Delicious can automatically import links you share (and have shared) on the social services listed below.</p>\n    <br>\n  </div>\n  <div class=\"span10\">\n\n      <fieldset>\n        <div data-service=\"facebook\" class=\"social-connector facebook\">\n          <div class=\"icon-block d-icon-facebook\">\n          </div>\n          <button class=\"btn connect\">Connect to Facebook</button>\n          <a class=\"disconnect\" href=\"#\">Disconnect from Facebook</a>\n        </div>\n      </fieldset>\n\n      <fieldset>\n        <div data-service=\"twitter\" class=\"social-connector twitter\">\n          <div class=\"icon-block d-icon-twitter\">\n          </div>\n          <button class=\"btn connect\">Connect to Twitter</button>\n          <a class=\"disconnect\" href=\"#\">Disconnect from Twitter</a>\n        </div>\n      </fieldset>\n\n      <br>\n\n      <h3>Import or export your bookmarks from a file</h3>\n\n      <br>\n\n      <a href=\"http://export.delicious.com/settings/bookmarks/import\" target=\"_blank\" class=\"preview-note\">Import bookmarks</a>\n      <p></p>\n      <a href=\"http://export.delicious.com/settings/bookmarks/export\" target=\"_blank\" class=\"preview-note\">Export bookmarks</a>\n      \n  </div>\n</div>";});}});
window.require.define({"templates/user/settings/twitter":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};var buffer="",stack1,stack2,foundHelper,functionType="function",escapeExpression=this.escapeExpression,self=this;function program1(depth0,data){var buffer="",stack1,stack2,foundHelper;buffer+="\n            <option value=\"";foundHelper=helpers.value;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.value;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" ";stack1=depth0.selected;stack2={};stack1=helpers['if'].call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(2,program2,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+=">";foundHelper=helpers.text;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.text;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"</option>\n          ";return buffer;}
function program2(depth0,data){return"selected=\"selected\"";}
buffer+="<form enctype=\"multipart/form-data\" id=\"settings-form\">\n  <div class=\"row settings\">\n    <div class=\"span10\">\n      <h1>Importing links from Twitter</h1>\n      <br>\n    </div>\n    <div class=\"span10\">\n\n      <fieldset>\n        <label for=\"privacy\">When importing links...</label>\n        <select name=\"privacy\" class=\"input-xlarge\" disabled=\"disabled\">\n          ";stack1=depth0.options;stack2={};stack1=helpers.each.call(depth0,stack1,{hash:stack2,inverse:self.noop,fn:self.program(1,program1,data),data:data});if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n        </select>\n      </fieldset>\n\n      <fieldset>\n        <label for=\"tags\">Add these tags to imported links</label>\n        <input name=\"tags\" type=\"text\" id=\"user-full-name\" class=\"input-xlarge\" placeholder=\"from twitter\" value=\"";foundHelper=helpers.tags;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.tags;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\" disabled=\"disabled\">\n      </fieldset>\n      \n      <div class=\"form-buttons\">\n        <input type=\"submit\" class=\"btn btn-primary\" value=\"Save changes\" disabled=\"disabled\">\n      </div>\n\n    </div>\n\n    <div class=\"span5 description\">\n      <br>\n      <p>Links you share on Twitter will be imported to Delicious.</p>\n      <p>Links are not imported in real time. Depending on circumstances, it can be as little as five minutes or as long as 24 hours before they appear on Delicious.</p>\n      <a class=\"disconnect\" href=\"#\">Disconnect from Twitter as ";foundHelper=helpers.providerDisplayname;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.providerDisplayname;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"</a>\n    </div>\n\n  </div>\n</form>\n";return buffer;});}});
window.require.define({"templates/user/user_card":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};var buffer="",stack1,foundHelper,functionType="function",escapeExpression=this.escapeExpression;buffer+="<a href=\"/";foundHelper=helpers.user_name;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.user_name;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\">\n  <img class=\"avatar\" src=\"";foundHelper=helpers.avatar_url;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.avatar_url;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"\">\n  <h5>";foundHelper=helpers.displayName;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.displayName;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"</h5>\n</a>\n\n";foundHelper=helpers.followButton;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.followButton;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
if(stack1||stack1===0){buffer+=stack1;}
buffer+="\n";return buffer;});}});
window.require.define({"templates/user/validate_email":function(exports,require,module){module.exports=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){helpers=helpers||Handlebars.helpers;data=data||{};var buffer="",stack1,foundHelper,functionType="function",escapeExpression=this.escapeExpression;buffer+="<h1>";foundHelper=helpers.info;if(foundHelper){stack1=foundHelper.call(depth0,{hash:{},data:data});}
else{stack1=depth0.info;stack1=typeof stack1===functionType?stack1.apply(depth0):stack1;}
buffer+=escapeExpression(stack1)+"</h1>\n";return buffer;});}});
window.require.define({"views/about":function(exports,require,module){(function(){var AboutView,HtmlView,PageView,logger,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};logger=require('lib/logger');mediator=require('mediator');HtmlView=require('views/base/html');PageView=require('views/base/page');module.exports=AboutView=(function(_super){__extends(AboutView,_super);function AboutView(){return AboutView.__super__.constructor.apply(this,arguments);}
AboutView.prototype.containedLayout=false;AboutView.prototype.events={'mousemove':'updateMapPosition'};AboutView.prototype.initialize=function(){AboutView.__super__.initialize.apply(this,arguments);this.$body=$('body').addClass('about');this.subview('about-html',new HtmlView({url:'about',id:'about',container:'#delicious'}));return logger.log("Initializing the About View");};AboutView.prototype.updateMapPosition=function(e){var $map,eq;eq=-e.pageX/50;$map=$('#world-map');$map.css('left',eq);return setTimeout(function(){return $map.removeClass('transition');},500);};AboutView.prototype.dispose=function(){AboutView.__super__.dispose.apply(this,arguments);return this.$body.removeClass('about');};return AboutView;})(PageView);}).call(this);}});
window.require.define({"views/auth/join":function(exports,require,module){(function(){var JoinView,View,avosConfig,logger,mediator,__bind=function(fn,me){return function(){return fn.apply(me,arguments);};},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};avosConfig=require('lib/avos');View=require('lib/view');mediator=require('mediator');logger=require('lib/logger');module.exports=JoinView=(function(_super){__extends(JoinView,_super);function JoinView(){this.doTwitterLogin=__bind(this.doTwitterLogin,this);this.doRegister=__bind(this.doRegister,this);this.authenticateProviderUser=__bind(this.authenticateProviderUser,this);this.signupWithService=__bind(this.signupWithService,this);this.authenticateNewUser=__bind(this.authenticateNewUser,this);this.showUsernameExistsError=__bind(this.showUsernameExistsError,this);this.checkUsernameExists=__bind(this.checkUsernameExists,this);this.checkValidEmail=__bind(this.checkValidEmail,this);this.toProfile=__bind(this.toProfile,this);return JoinView.__super__.constructor.apply(this,arguments);}
JoinView.prototype.template='onboarding/join';JoinView.prototype.container='#fre';JoinView.prototype.className='join';JoinView.prototype.showBanner=false;JoinView.prototype.autoRender=true;JoinView.prototype.section=false;JoinView.prototype.transitionSpeed=300;JoinView.prototype.events={'keyup #user-username':'checkUsernameExists','blur #user-email':'checkValidEmail','click #connect-facebook':'doFacebookLogin','click #connect-twitter':'doTwitterLogin','click #create-account':'toCreateAccount','click #user-register':'doRegister','click #check-password':'toggleInputType'};JoinView.prototype.initialize=function(options){var _this=this;JoinView.__super__.initialize.apply(this,arguments);$(this.container).empty().fadeIn(this.transitionSpeed);$('#delicious').hide();this.subscribeEvent('join:checkedUserExists',this.showUsernameExistsError);this.subscribeEvent('join:userJoined',this.authenticateNewUser);this.subscribeEvent('join:signinWithService',this.authenticateProviderUser);this.subscribeEvent('join:signupWithService',this.signupWithService);this.section=options.section;if(history.pushState){return window.onpopstate=function(e){if(e.state){return _this.toJoinHome();}};}};JoinView.prototype.afterRender=function(){JoinView.__super__.afterRender.apply(this,arguments);$.getScript('https://www.google.com/recaptcha/api/js/recaptcha_ajax.js',function(data,status,jqxhr){if(!status){logger.log('Failed to load the Goolge ReCaptcha script');}
return Recaptcha.create('6Lf2VNkSAAAAAHpjH1J1nqEZxV4UEBWNAHrc8QLF','join-captcha',{theme:"custom"});});if(this.section==='create'){return this.toCreateAccount();}};JoinView.prototype.toggleInputType=function(e){var checkboxState,passwordField;passwordField=$('#user-password').get(0);checkboxState=$('#check-password').attr('checked');if(checkboxState==='checked'){return passwordField.type='text';}else{return passwordField.type='password';}};JoinView.prototype.showErrorInfo=function(info){if(info!=null){return $('.error_info').html('<p>'+info+'</p>');}else{return $('.error_info').html('');}};JoinView.prototype.toJoinHome=function(){this.$('.slide2').removeClass('active');return this.$('.slide1').addClass('active').removeClass('done');};JoinView.prototype.toCreateAccount=function(e){if((e!=null)&&history.pushState){history.pushState({section:'create'},'Hello','join/create');}
this.$('.slide1').removeClass('active').addClass('done');return this.$('.slide2').addClass('active');};JoinView.prototype.toProfile=function(e){var username;if(e!=null){e.preventDefault();}
username=this.model.get('username');window.location.href='/'+username;return;$(this.container).fadeOut(this.transitionSpeed);return setTimeout((function(){return logger.log("onboarding complete");}),this.transitionSpeed);};JoinView.prototype.checkValidEmail=function(e){var email,regex;email=$('#user-email').val();regex=/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/;if(regex.test(email)){return this.showErrorInfo(null);}else if(email.length>0){return this.showErrorInfo("Please enter a valid email address");}};JoinView.prototype.checkUsernameExists=function(e){var username;username=$('#user-username').val();if(username.length>0){return mediator.user.existsUser(username);}else if(username.length>1){return this.showErrorInfo(null);}};JoinView.prototype.showUsernameExistsError=function(data){if(data.available){return this.showErrorInfo(null);}else{return this.showErrorInfo('Sorry, the username \''+data.username+'\', has already been taken. Please choose another username.');}};JoinView.prototype.authenticateNewUser=function(data){var _this=this;if(data.success){mediator.publish('auth:reauth');return this.model.loginSilent(function(){return _this.toProfile();});}else{Recaptcha.reload();if(data.status==='invalid_captcha'){return this.showErrorInfo('Sorry, you typed the words incorrectly. Please try again - we need to make sure you\'re human!');}else{return this.showErrorInfo(data.error.charAt(0).toUpperCase()+data.error.slice(1));}}};JoinView.prototype.signupWithService=function(data){var fullname,username;if(data.displayName[0]==='@'){username=fullname=data.displayName.slice(1);}else{username=fullname=data.displayName;}
$('#user-username').val(username);$('#user-full-name').val(fullname);return this.toCreateAccount();};JoinView.prototype.authenticateProviderUser=function(data,callback){var _this=this;this.model.set("username",data.username);this.model.set("password_hash",data.password);return this.model.loginSilent(function(){return _this.toProfile();});};JoinView.prototype.doRegister=function(e){var checkPassword,email,name,password,user_data,username;username=$('#user-username').val();email=$('#user-email').val();name=$('#user-full-name').val();password=$('#user-password').val();checkPassword=$('#check-password').checked;e.preventDefault();if(!username||!email||!name||!password){this.showErrorInfo('Please complete all the fields to continue.');return;}
user_data={'full_name':name,'display_name':username,'email':email,'username':username,'password':password,'recaptcha_challenge_field':Recaptcha.get_challenge(),'recaptcha_response_field':Recaptcha.get_response()};this.model.set(user_data);return this.model.register();};JoinView.prototype.doTwitterLogin=function(e){e.preventDefault();return this.model.loginWithThirdParties("twitter");};JoinView.prototype.doFacebookLogin=function(e){e.preventDefault();return this.model.loginWithThirdParties("facebook");};JoinView.prototype.dispose=function(){JoinView.__super__.dispose.apply(this,arguments);$('#delicious').show();return $('#fre').hide();};return JoinView;})(View);}).call(this);}});
window.require.define({"views/auth/login":function(exports,require,module){(function(){var LoginModal,ModalView,logger,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};logger=require('lib/logger');mediator=require('mediator');ModalView=require('views/base/modal');module.exports=LoginModal=(function(_super){__extends(LoginModal,_super);function LoginModal(){return LoginModal.__super__.constructor.apply(this,arguments);}
LoginModal.prototype.template='layout/login_modal';LoginModal.prototype.events={'submit form':'toggleSubmitButton'};LoginModal.prototype.initialize=function(options){var _this=this;this.options=options!=null?options:{};this.options=_.extend(this.defaults,{title:'Sign in to Delicious',size:'slim',callback:false});LoginModal.__super__.initialize.apply(this,arguments);logger.log("Initializing the LoginModal");this.subscribeEvent('login:success',function(){var _ref;if(_this.options.noRedirect){_this.publishEvent('login:noRedirect');}
if(_this.options.callback){_this.options.callback();}
return(_ref=_this.$el)!=null?_ref.modal('hide'):void 0;});return this.subscribeEvent('auth:bad_credentials',this.error);};LoginModal.prototype.afterRender=function(){LoginModal.__super__.afterRender.apply(this,arguments);if(this.options.noRedirect){return this.$(".modal-footer a").attr('target','_blank');}};LoginModal.prototype.error=function(){this.$('.modal-body').prepend("<div class=\"alert alert-error\">Incorrect username or password.</div>");return this.$('button[type="submit"]').button('reset');};LoginModal.prototype.toggleSubmitButton=function(){this.$el.find('.alert').remove();return this.$('button[type="submit"]').button('loading');};LoginModal.prototype.dispose=function(){logger.log("Disposing login modal view");mediator.publish('loginModal:dispose');return LoginModal.__super__.dispose.apply(this,arguments);};return LoginModal;})(ModalView);}).call(this);}});
window.require.define({"views/base/autocomplete":function(exports,require,module){(function(){var AutocompleteView,View,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};View=require('lib/view');module.exports=AutocompleteView=(function(_super){__extends(AutocompleteView,_super);function AutocompleteView(){return AutocompleteView.__super__.constructor.apply(this,arguments);}
AutocompleteView.prototype.autoRender=true;AutocompleteView.prototype.containerMethod='html';AutocompleteView.prototype.container='#global-search-autocomplete-container';AutocompleteView.prototype.template='layout/autocomplete';AutocompleteView.prototype.className='autocomplete';AutocompleteView.prototype.events={'click a.item':'hide'};AutocompleteView.prototype.initialize=function(){var _this=this;AutocompleteView.__super__.initialize.apply(this,arguments);this.subscribeEvent('search:showAutocomplete',function(params){_this.autocompleteParams=params;return _this.show();});this.subscribeEvent('search:hideAutocomplete',this.hide);return this.subscribeEvent('search:moveAutocompleteItem',this.handleUpDownArrow);};AutocompleteView.prototype.show=function(){var fragment,items,_ref;this.render();if(fragment=(_ref=this.autocompleteParams)!=null?_ref.fragment:void 0){if(/@/.test(fragment)){this.$el.parent().addClass('autocomplete-users');}else if(/\[/.test(fragment)){this.$el.parent().addClass('autocomplete-tag-bundles');}else{this.$el.parent().removeClass('autocomplete-users').removeClass('autocomplete-tag-bundles');}}
this.$el.parent().addClass('active');items=this.$('a.item');items.removeClass('selected');items.filter(':visible:first').addClass('selected');return false;};AutocompleteView.prototype.hide=function(){this.$el.parent().removeClass('active');return false;};AutocompleteView.prototype.handleUpDownArrow=function(e){var index,items,maxIndex;items=this.$('a.item:visible');index=items.index(this.$('a.item:visible.selected'));maxIndex=_.max([items.length-1,0]);switch(e.which){case 38:index-=1;if(index<0){index=maxIndex;}
break;case 40:index+=1;if(index>maxIndex){index=0;}}
this.$('a.item').removeClass('selected');return $(items.get(index)).addClass('selected');};AutocompleteView.prototype.getTemplateData=function(){var fragment,regexp,tagBundles,tags,users,_ref;_ref=this.autocompleteParams||{},regexp=_ref.regexp,fragment=_ref.fragment,tags=_ref.tags,users=_ref.users,tagBundles=_ref.tagBundles;if(fragment&&/^@/.test(fragment)){fragment=fragment.replace('@','');_.each(users||[],function(user){if(regexp&&fragment){user.username_markup=user.username.replace(regexp,'<em>$1</em>');return user.full_name_markup=user.full_name.replace(regexp,'<em>$1</em>');}else{user.username_markup=user.username;return user.full_name_markup=user.full_name;}});return{users:users};}else if(fragment&&/^\[/.test(fragment)){fragment=fragment.replace(/\[|\]/g,'');_.each(tagBundles||[],function(tagBundle){if(regexp&&fragment){return tagBundle.name_markup=tagBundle.name.replace(regexp,'<em>$1</em>');}else{return tagBundle.name_markup=tagBundle.name;}});return{tagBundles:tagBundles};}else{_.each(tags||[],function(tag){return tag.name_markup=regexp&&fragment?tag.name.replace(regexp,'<em>$1</em>'):tag.name;});return{tags:tags};}};return AutocompleteView;})(View);}).call(this);}});
window.require.define({"views/base/banner":function(exports,require,module){(function(){var BannerView,ModalView,Tags,View,avosConfig,logger,mediator,__bind=function(fn,me){return function(){return fn.apply(me,arguments);};},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};avosConfig=require('lib/avos');logger=require('lib/logger');mediator=require('mediator');Tags=require('models/tags');View=require('lib/view');ModalView=require('views/base/modal');module.exports=BannerView=(function(_super){__extends(BannerView,_super);function BannerView(){this.updateActiveLink=__bind(this.updateActiveLink,this);return BannerView.__super__.constructor.apply(this,arguments);}
BannerView.prototype.container='#delicious';BannerView.prototype.containerMethod='prepend';BannerView.prototype.template='layout/banner';BannerView.prototype.tagName='header';BannerView.prototype.className='page-header';BannerView.prototype.events={'submit form.global-search':'performSearch','mousedown form.global-search .search-submit':'performSearch','focus #search-field':'focusGlobalSearchDiv','blur #search-field':'blurGlobalSearchDiv','keyup #search-field':'autocompleteSearchField','click .dropdown':'clickDropdown','click a[href="#sign-out"]':'clickSignOut','click a[href="#add-link"]':'clickAddLink'};BannerView.prototype.initialize=function(){var _ref,_this=this;BannerView.__super__.initialize.apply(this,arguments);this.mixin('lib/search_params');if((_ref=this.model)!=null){_ref.on('change',function(){logger.log("Model changed, re-rendering the banner view.");return _this.render();});}
this.subscribeEvent('!router:changeURL',this.updateActiveLink);this.subscribeEvent('search:changeURL',function(params){return _this.publishEvent('!router:changeURL',_this.searchPathFromSearchParams(params));});this.subscribeEvent('search:updateInputField',function(params){var $el,_ref1,_ref2;$el=_this.$el.closest('#delicious');if(((_ref1=params.tags)!=null?_ref1.length:void 0)>0||((_ref2=params.keywords)!=null?_ref2.length:void 0)>0){return $el.addClass('filtering-tags').removeClass('filtering-tag-bundle');}else if(params.tagBundle){return $el.addClass('filtering-tag-bundle').removeClass('filtering-tags');}else{return $el.removeClass('filtering-tags').removeClass('filtering-tag-bundle');}});return this.subscribeEvent('search:updateInputField',function(params){var $field,deletedTokens,existingTokens,newTokens,rewrites,tokens,username,val,_ref1;tokens=_this.searchTokensFromSearchParams(params);$field=_this.$el.find('#search-field');existingTokens=_this.tokenizeSearchString($field.val());newTokens=_.difference(tokens,existingTokens);deletedTokens=_.difference(existingTokens,tokens);if(username=(_ref1=mediator.user)!=null?_ref1.get('username'):void 0){rewrites={"@me":"@"+username,"@me/network":"@"+username+"/network","@network":"@"+username+"/network"};_.each(rewrites,function(atuser,atme){if(_.include(existingTokens,atme)&&_.include(newTokens,atuser)){newTokens=_.without(newTokens,atuser);return deletedTokens=_.without(deletedTokens,atme);}});}
tokens=_.difference(existingTokens.concat(newTokens),deletedTokens);val=tokens.length>0?tokens.join(' ')+' ':'';$field.val(val);_this.blurGlobalSearchDiv();return key('a',_this.clickAddLink);});};BannerView.prototype.afterRender=function(){BannerView.__super__.afterRender.apply(this,arguments);if(mediator.user.get('isLoggedIn')){return this.setGreeting();}};BannerView.prototype.clickDropdown=function(e){var link,_this=this;if(!this.isTouch()){_.delay(function(){return _this.$('.dropdown').removeClass('open');},0);link=$(e.target).closest('a.nav-link');if(!link[0]){return;}
return mediator.publish('!router:route',link.attr('href'));}};BannerView.prototype.clickSignOut=function(e){e.preventDefault();logger.log("User logout clicked - logging out user:",mediator.user);mediator.user.logout();return window.location.href=avosConfig.defaultRoute;};BannerView.prototype.clickAddLink=function(e){var _this=this;e.preventDefault();if($('#add-link.modal')[0]){return;}
logger.log("Initialize the add link modal");if(mediator.user.get('isLoggedIn')){return new ModalView({title:'Add a new link to Delicious',template:'links/add_from_url',id:'add-link',size:'normal'});}else{return this.publishEvent('auth:prompt',{title:'Sign in to save this link',noRedirect:true,callback:function(){return _this.clickAddLink(e);}});}};BannerView.prototype.setGreeting=function(){var firstName,message,now,_ref,_ref1;now=new Date().getHours();firstName=(_ref=mediator.user)!=null?_ref.get('full_name'):void 0;firstName=(firstName!=null?firstName.split(/\s/).shift():void 0)||((_ref1=mediator.user)!=null?_ref1.get('username'):void 0);message=now<=4?'Stay awake':now<=11?'Morning':now<=17?'Good afternoon':'Evening';return this.$('.banner-name').html(message+', '+firstName);};BannerView.prototype.updateActiveLink=function(route){var baseSection;route=route.split('/')[0];baseSection=route==="discover"?'discover':route==="network"?'network':route===this.model.get('username')?'remember':void 0;if(baseSection){return this.$('.nav-'+baseSection).addClass('active-nav').siblings().removeClass('active-nav');}else{return this.$('.active-nav').removeClass('active-nav');}};BannerView.prototype.performSearch=function(e){var $el,$field,params,path,s;e.preventDefault();$el=$(e.target);this.blurGlobalSearchDiv();$field=this.$('#search-field');if(this.$('#global-search-autocomplete-container').is('.active')){if($el.is('.search-submit')){this.finishAutocomplete();return false;}else{return false;}}
s=$field.val().trim()||'';if(/^$/.test(s)){return false;}
params=this.searchParamsFromSearchString(s);path=this.searchPathFromSearchParams(params);this.publishEvent('!router:route',path);return false;};BannerView.prototype.focusGlobalSearchDiv=function(){return this.$('.global-search').addClass('focused');};BannerView.prototype.blurGlobalSearchDiv=function(){var $el,val,_this=this;$el=this.$('.global-search #search-field');val=$el.val().trim();if(val.length<40){this.$('.global-search').removeClass('focused');}
$el.toggleClass('has-text',val==='Search Delicious'||val==='');return setTimeout((function(){return _this.publishEvent('search:hideAutocomplete');}),150);};BannerView.prototype.autocompleteSearchField=function(e){var $el,$field,fragment,regexp,tagBundles,tags,users,_ref;if(!((_ref=mediator.user)!=null?_ref.get('isLoggedIn'):void 0)){return;}
$field=this.$('#search-field');switch(e.which){case 38:case 40:this.publishEvent('search:moveAutocompleteItem',e);return false;case 27:this.publishEvent('search:hideAutocomplete');return false;case 13:case 39:$el=this.$('.autocomplete a.selected');if($el.length<1||$el.is('.search-submit')){this.finishAutocomplete();$field.closest('form').submit();return false;}else{if($el.is('[data-tag]')){this.publishEvent('search:addYourTag',$el.attr('data-tag'));}else if($el.is('[data-tag-bundle]')){this.publishEvent('search:onlyTagBundle',$el.attr('data-tag-bundle'));}else if($el.is('[data-user]')){this.publishEvent('search:addUsername',$el.attr('data-user'));}
this.publishEvent('search:hideAutocomplete');return false;}}
fragment=_.last($field.val().match(/(\S+)$/)||[]);if(!fragment){this.publishEvent('search:hideAutocomplete');return false;}
regexp=fragment.toLowerCase().replace('#','').replace('@','').replace(/\[|\]/,'').replace(/^'|^"/,'').replace(/'$|"$/,'');if(regexp.length>0){regexp='('+regexp+')';if(fragment.length<2){regexp='^'+regexp;}
regexp=new RegExp(regexp,'i');}else{regexp=null;}
tags=mediator.user.get('tags');if(regexp){tags=_.filter(tags,function(tag){return regexp.test(tag.name);});}
if(/^@/.test(fragment)){users=[mediator.user.toJSON()].concat(mediator.user.get('follows'));if(regexp){users=_.filter(users,function(user){return regexp.test(user.username)||regexp.test(user.full_name);});}}
if(/^\[/.test(fragment)){tagBundles=mediator.user.get('tag_bundles');if(regexp){tagBundles=_.filter(tagBundles,function(bundle){return regexp.test(bundle.name);});}}
$field.data('excluded-fragment',fragment);return this.publishEvent('search:showAutocomplete',{users:users,tags:tags,tagBundles:tagBundles,regexp:regexp,fragment:fragment.replace('#','')});};BannerView.prototype.finishAutocomplete=function(){var $field,fragment,quote,val;$field=this.$('#search-field');fragment=$field.data('excluded-fragment');if(/^#/.test(fragment)&&/\s/.test(fragment)){quote=fragment.match(/^#('|")/g);val=$field.val();if(quote){val+=quote;}else{val='"'+val+'"';}
$field.val(val);}
if(/^\[/.test(fragment)){$field.val($field.val()+']');}
return this.publishEvent('search:hideAutocomplete');};return BannerView;})(View);}).call(this);}});
window.require.define({"views/base/flash":function(exports,require,module){(function(){var FlashView,View,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};View=require('lib/view');module.exports=FlashView=(function(_super){__extends(FlashView,_super);function FlashView(){return FlashView.__super__.constructor.apply(this,arguments);}
FlashView.prototype.containerMethod='prepend';FlashView.prototype.className='alert fade in';FlashView.prototype.container='#delicious';FlashView.prototype.defaults={type:'info',autoDestroy:2500,closeOnXClick:true};FlashView.prototype.initialize=function(){FlashView.__super__.initialize.apply(this,arguments);return _.defaults(this.options,this.defaults);};FlashView.prototype.render=function(){var msg,_this=this;FlashView.__super__.render.apply(this,arguments);if(!this.options.flash){return;}
this.$el.addClass("alert-"+this.options.type);msg=this.options.flash;if(this.options.closeOnXClick){msg+="<a href=\"#\" class=\"close\" data-dismiss=\"alert\">×</a>";}
this.$el.html(msg).bind('closed',_.bind(this.dispose,this));if(this.options.autoDestroy){return _.delay(function(){return _this.$el.alert('close');},this.options.autoDestroy);}};return FlashView;})(View);}).call(this);}});
window.require.define({"views/base/html":function(exports,require,module){(function(){var HtmlView,PageView,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};mediator=require('mediator');PageView=require('lib/view');module.exports=HtmlView=(function(_super){__extends(HtmlView,_super);function HtmlView(){return HtmlView.__super__.constructor.apply(this,arguments);}
HtmlView.prototype.autoRender=true;HtmlView.prototype.containedLayout=true;HtmlView.prototype.showBanner=true;HtmlView.prototype.defaults={includeFooter:true};HtmlView.prototype.render=function(){var ftr;HtmlView.__super__.render.apply(this,arguments);this.$el.append("<div class=\"html-content\"></div>");if(this.options.url){this.$('.html-content').load("/html/"+this.options.url+".html",_.bind(this.trigger,this,'htmlLoaded'));}
if(this.options.includeFooter){ftr=Handlebars.partials.footer();return this.$el.append("<div class=\"container\">"+ftr+"</div>");}};return HtmlView;})(PageView);}).call(this);}});
window.require.define({"views/base/modal":function(exports,require,module){(function(){var ModalView,View,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};View=require('lib/view');module.exports=ModalView=(function(_super){__extends(ModalView,_super);function ModalView(){return ModalView.__super__.constructor.apply(this,arguments);}
ModalView.prototype.container='body';ModalView.prototype.className='modal hide fade';ModalView.prototype.attributes={role:'dialog','aria-hidden':true,'tabindex':'-1'};ModalView.prototype.defaults={title:false,closeOnXClick:true,closeOnBackgroundClick:true,size:'normal',spinner:false};ModalView.prototype.initialize=function(){var _this=this;this.subscribeEvent('!router:route',function(){var _ref;return(_ref=_this.$el)!=null?_ref.modal('hide'):void 0;});return ModalView.__super__.initialize.apply(this,arguments);};ModalView.prototype.render=function(){if(!this.options.spinner){this.$el.removeClass('loading');return ModalView.__super__.render.apply(this,arguments);}};ModalView.prototype.getTitle=function(){if(this.options.title){if(typeof this.options.title==='function'){return this.options.title.apply(this);}else{return this.options.title;}}};ModalView.prototype.addTitle=function(){if(!this.titleAdded){if(this.getTitle()){this.$el.prepend("<div class=\"modal-header\"><h3>"+(this.getTitle())+"</h3></div>");}
if(this.options.closeOnXClick){this.$('.modal-header, .modal-body').first().prepend("<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>");}
return this.titleAdded=true;}};ModalView.prototype.afterRender=function(){var _this=this;ModalView.__super__.afterRender.apply(this,arguments);this.$el.on('hidden',$.proxy(this.dispose,this));this.$el.addClass('size-'+this.options.size);if(!this.options.closeOnBackgroundClick){this.$el.attr('data-backdrop','static');}
if(this.options.spinner){this.showSpinner();}else{this.$el.removeClass('in');_.delay(function(){var _ref;return(_ref=_this.$el)!=null?_ref.addClass('in'):void 0;},1);if(!(this.collection&&this.collection.length===0)){this.addTitle();}
if(this.options.html){this.modalBody="<div class=\"modal-body\">"+this.options.html+"</div>";this.$el.append(this.modalBody);}
setTimeout((function(){var _ref;return(_ref=_this.$el)!=null?_ref.find('input:not([type="hidden"]), select, textarea, btn.primary').first().focus():void 0;}),300);}
return this.$el.modal('show');};ModalView.prototype.showSpinner=function(){this.$el.addClass('loading');this.loader=$('<div class="loading"></div>');this.$el.append(this.loader);return this.setLoading({color:'white'});};ModalView.prototype.dispose=function(){ModalView.__super__.dispose.apply(this,arguments);return $('.modal-backdrop').remove();};return ModalView;})(View);}).call(this);}});
window.require.define({"views/base/modal_collection":function(exports,require,module){(function(){var ModalCollectionView,ModalView,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};ModalView=require('views/base/modal');module.exports=ModalCollectionView=(function(_super){__extends(ModalCollectionView,_super);function ModalCollectionView(){return ModalCollectionView.__super__.constructor.apply(this,arguments);}
ModalCollectionView.prototype.listSelector='.modal-body';ModalCollectionView.prototype.id='modal-collection';ModalCollectionView.prototype.loadingIndicator=true;ModalCollectionView.prototype.defaults={title:false,size:'slim',closeOnXClick:true};ModalCollectionView.prototype.initialize=function(){ModalCollectionView.__super__.initialize.apply(this,arguments);this.modelBind('reset',this.renderCollection);return this.$el.html("<div class=\"modal-body\">\n  <div class=\"loading\"></div>\n</div>");};ModalCollectionView.prototype.render=function(){if(this.collection.length!==0){this.renderCollection();}
return ModalCollectionView.__super__.render.apply(this,arguments);};ModalCollectionView.prototype.renderCollection=function(){var o,_this=this;this.addTitle();this.$(this.fallbackSelector).hide();o=[];this.collection.each(function(x,i,collection){var childView;if(_this.itemView){childView=new _this.itemView({model:_this.collection.at(i)});return o.push(childView.$el.outerHtml());}});return this.$(this.listSelector).html(o.join(''));};return ModalCollectionView;})(ModalView);}).call(this);}});
window.require.define({"views/base/page":function(exports,require,module){(function(){var PageView,View,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};mediator=require('mediator');View=require('lib/view');module.exports=PageView=(function(_super){__extends(PageView,_super);function PageView(){return PageView.__super__.constructor.apply(this,arguments);}
PageView.prototype.container='#delicious';PageView.prototype.autoRender=false;PageView.prototype.containedLayout=true;PageView.prototype.className='pageview';PageView.prototype.showBanner=true;PageView.prototype.initialize=function(){var rendered,_ref,_this=this;PageView.__super__.initialize.apply(this,arguments);if(this.model||this.collection){rendered=false;this.modelBind('change',function(){if(!rendered){_this.render();}
return rendered=true;});}
$('#delicious').toggleClass('container',this.containedLayout===true);return(_ref=mediator.layout)!=null?_ref.toggleBanner(this.showBanner):void 0;};PageView.prototype.afterRender=function(){PageView.__super__.afterRender.apply(this,arguments);if(!store.get('hasReadNewTerms')){this.$('#terms-update-alert').show();}
if(this.isMobile()){return this.$('.delicious-footer').appendTo(this.$el);}};return PageView;})(View);}).call(this);}});
window.require.define({"views/base/popover":function(exports,require,module){(function(){var PopoverView,View,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};mediator=require('mediator');View=require('lib/view');module.exports=PopoverView=(function(_super){__extends(PopoverView,_super);function PopoverView(){return PopoverView.__super__.constructor.apply(this,arguments);}
PopoverView.prototype.autoRender=false;PopoverView.prototype.container='body';PopoverView.prototype.initialize=function(options){var data;this.options=options!=null?options:{};PopoverView.__super__.initialize.apply(this,arguments);if(!this.$el){return;}
this.mixin('views/user/mixins/follow_button');options=_.defaults(this.options,{content:this.getRenderedContent(),stopChildrenPropagation:false});this.$el.popover(options);data=this.$el.popover('getData');if(data!=null){data.popover.on('click','[href="#follow"]',$.proxy(this.clickFollow,this));data.popover.on('click','[href="#unfollow"]',$.proxy(this.clickUnfollow,this));this.$el.hover(function(){return Socialite.load(data.popover);});}
if(this.model){return this.modelBind('change',this.renderContent,this);}};PopoverView.prototype.render=function(){return this;};PopoverView.prototype.getRenderedContent=function(){return this.getTemplateFunction()(this.getTemplateData());};PopoverView.prototype.renderContent=function(){var data,_ref;data=(_ref=this.$el)!=null?_ref.popover('getData'):void 0;return data!=null?data.popover.find('.content').html(this.getRenderedContent()):void 0;};PopoverView.prototype.dispose=function(){var _ref;if((_ref=this.$el)!=null?_ref.popover('getData'):void 0){this.$el.popover('destroy');}
return PopoverView.__super__.dispose.apply(this,arguments);};return PopoverView;})(View);}).call(this);}});
window.require.define({"views/base/section":function(exports,require,module){(function(){var HtmlView,Model,PageView,SectionView,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};Model=require('lib/model');PageView=require('views/base/page');HtmlView=require('views/base/html');module.exports=SectionView=(function(_super){__extends(SectionView,_super);function SectionView(){return SectionView.__super__.constructor.apply(this,arguments);}
SectionView.prototype.autoRender=true;SectionView.prototype.id='section';SectionView.prototype.template='layout/page';SectionView.prototype.events={'click .question':'clickQuestion','click #help-expand-all':'clickHelpExpandAll'};SectionView.prototype.initialize=function(options){var currentPage,pageSearch,section,sectionPage;this.options=options;pageSearch=_.where(this.options.pages,{id:options.currentId});if(pageSearch.length){currentPage=pageSearch[0];}else{currentPage=this.options.pages[0];}
sectionPage=_.where(currentPage.subpages,{id:this.options.currentSectionId});if(sectionPage.length){section=sectionPage[0];}else{section=false;}
this.model=new Model({url:this.options.page,nav:this.options.pages,page:currentPage,section:section});return SectionView.__super__.initialize.apply(this,arguments);};SectionView.prototype.render=function(){var ViewClass,page,section,_this=this;SectionView.__super__.render.apply(this,arguments);page=this.model.get('page');this.$("\".section_nav a[data-page-id=\""+page.id+"\"]").addClass('active');section=this.model.get('section');if(section){ViewClass=require(section.view);return this.subview('page',new ViewClass({autoRender:true,model:section.model,container:this.$('.content'),template:section.template,service:section.id}));}else if(page.view){ViewClass=require(page.view);return this.subview('page',new ViewClass({autoRender:true,model:page.model,container:this.$('.content')}));}else if(page.url){this.subview('page',new HtmlView({url:page.url,container:this.$('.content'),includeFooter:false}));return this.subview('page').on('htmlLoaded',function(){_this.$('.answer').addClass('collapse');if(_this.options.params.questionid){return _this.$("[href$=\"/"+_this.options.params.questionid+"\"]").trigger('click');}});}};SectionView.prototype.clickQuestion=function(e){var $el;e.preventDefault();$el=$(e.target);this.publishEvent('!router:changeURL',$el.attr('href'));return $(window).scrollTop($el.next('.answer').toggleClass('collapse').offset().top-100);};SectionView.prototype.clickHelpExpandAll=function(e){var $el;e.preventDefault();$el=$(e.target);if($el.text()==='Collapse all answers'){$('.answer').addClass('collapse');return $el.text('Expand all answers');}else{$('.answer').removeClass('collapse');return $el.text('Collapse all answers');}};SectionView.prototype.afterRender=function(){var section,subnav;SectionView.__super__.afterRender.apply(this,arguments);section=this.model.get('section');subnav=this.$('.section_subnav');if(section){return subnav.show();}else{return subnav.slideDown(150);}};return SectionView;})(PageView);}).call(this);}});
window.require.define({"views/chrome":function(exports,require,module){(function(){var ChromeView,PageView,logger,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};logger=require('lib/logger');PageView=require('views/base/page');module.exports=ChromeView=(function(_super){__extends(ChromeView,_super);function ChromeView(){return ChromeView.__super__.constructor.apply(this,arguments);}
ChromeView.prototype.autoRender=true;ChromeView.prototype.className='pageview big-text';ChromeView.prototype.initialize=function(){ChromeView.__super__.initialize.apply(this,arguments);return logger.log("Initializing the Chrome Quicktour View");};ChromeView.prototype.render=function(){this.$el.append("<h1>Thanks for installing the Delicious Chrome extension!</h1>");return this;};return ChromeView;})(PageView);}).call(this);}});
window.require.define({"views/home":function(exports,require,module){(function(){var HomeView,PageView,logger,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};logger=require('lib/logger');PageView=require('views/base/page');module.exports=HomeView=(function(_super){__extends(HomeView,_super);function HomeView(){return HomeView.__super__.constructor.apply(this,arguments);}
HomeView.prototype.template='home';HomeView.prototype.id='home';HomeView.prototype.autoRender=true;HomeView.prototype.showBanner=true;HomeView.prototype.containedLayout=false;HomeView.prototype.initialize=function(){HomeView.__super__.initialize.apply(this,arguments);logger.log("Initializing the Home View");return this.$body=$('body').addClass('home');};HomeView.prototype.afterRender=function(){var _this=this;HomeView.__super__.afterRender.apply(this,arguments);setTimeout(function(){return $('#home-first').css('left','0');},100);setTimeout(function(){return $('#home-second').css('left','0');},250);setTimeout(function(){return $('#home-third').css('left','0');},500);setTimeout(function(){$('.circle-wrapper').addClass('in');return $('#home-screenshot').addClass('in');},1000);$('.circle').on('mouseover',this.showHint);return $('.circle').on('mouseout',this.hideHint);};HomeView.prototype.showHint=function(e){var $hint;$hint=$(e.target).siblings('.hint');return $hint.addClass('in');};HomeView.prototype.hideHint=function(e){var $hint;$hint=$(e.target).siblings('.hint');return $hint.removeClass('in');};HomeView.prototype.dispose=function(){HomeView.__super__.dispose.apply(this,arguments);this.$body.removeClass('home');$('.circle').off('mouseover',this.showHint);return $('.circle').off('mouseout',this.hideHint);};return HomeView;})(PageView);}).call(this);}});
window.require.define({"views/layout":function(exports,require,module){(function(){var AutocompleteView,BannerView,Chaplin,FlashView,Layout,Link,ModalView,api,logger,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};api=require('lib/api');Chaplin=require('chaplin');Link=require('models/link');logger=require('lib/logger');mediator=Chaplin.mediator;ModalView=require('views/base/modal');BannerView=require('views/base/banner');AutocompleteView=require('views/base/autocomplete');FlashView=require('views/base/flash');module.exports=Layout=(function(_super){__extends(Layout,_super);function Layout(){return Layout.__super__.constructor.apply(this,arguments);}
Layout.prototype.events={'contextmenu .page-header .logo':'showLogoDialog','submit form[data-action="login"]':'submitLoginForm','submit form[data-action="addFromUrl"]':'submitAddLink','click a[href="#login"]':'showLogin','scroll':'triggerLoadMoreEvent','click a[href="#more"]':'clickLoadMoreButton','hover [data-tag]':'hoverTag','mouseout [data-tag]':'unhoverTag','click [data-tag]':'clickTag','hover .autocomplete a.item':'toggleSelectedAutocompleteItem','click [data-tag-bundle]':'clickTagBundle','click [data-user]':'clickUser','hover [href="#unfollow"]':'hoverUnfollow','click .help-prompt':'showHelp','click [data-track-group]':'trackClick'};Layout.prototype.initialize=function(){var _this=this;Layout.__super__.initialize.apply(this,arguments);this.subscribeEvent('search:searching',function(){return _this.loadMoreIsRunning=true;});this.subscribeEvent('search:finish',function(){return _this.loadMoreIsRunning=false;});this.$page=$('#delicious');key('shift+/',this.showHelp);if(window.location.pathname!=='/save'&&window.location.pathname!=='/post'){this.banner=new BannerView({model:mediator.user});this.banner.subview('autocomplete',new AutocompleteView);if(window.location.pathname!=='/'){return this.checkForMeiWeiPromo();}}};Layout.prototype.toggleSelectedAutocompleteItem=function(e){var items;e.preventDefault();items=$('.autocomplete a.item');items.removeClass('selected');return $(e.target).addClass('selected');};Layout.prototype.showLogoDialog=function(e){e.preventDefault();return this.logoDialog=new ModalView({template:'layout/logo_dialog',id:'logo-modal',title:'Download our logo',size:'slim'});};Layout.prototype.showHelp=function(e){if(e!=null){e.preventDefault();}
if($('.modal').length){return;}
logger.log("Initializing the help dialog");return this.help=new ModalView({template:'layout/help',id:'help-modal',title:'Delicious tips and tricks'});};Layout.prototype.submitLoginForm=function(e){var $form,$password,$username;e.preventDefault();$form=$(e.currentTarget);$username=$form.find('input[name="username"]').val();$password=$form.find('input[name="password"]').val();if(!($username&&$password)){$form.find('button[type="submit"]').button('reset');return;}
logger.log("Login form submitted with the following params:",{username:$username,password:$password});return mediator.publish('auth:login',{username:$username,password:$password});};Layout.prototype.showLogin=function(e){e.preventDefault();return this.publishEvent('auth:prompt');};Layout.prototype.submitAddLink=function(e){var data,newLink;e.preventDefault();data=$(e.target).formParams();logger.log("Submitting the add link modal",{url:data['new-url']});if(data['new-url']===''){return;}
newLink=new Link({url:data['new-url']});newLink.getDetails(newLink.compose);return $('#add-link.modal').modal('hide');};Layout.prototype.triggerLoadMoreEvent=function(e){var _this=this;this._throttledTriggerLoadMoreEvent||(this._throttledTriggerLoadMoreEvent=_.throttle(function(e){var $el,doTrigger,scrollBottom,scrollTop,totalHeight;if(_this.loadMoreIsRunning){return;}
scrollTop=$(window).scrollTop();scrollBottom=scrollTop+$(window).height();$el=$('.links-container:last').parent();totalHeight=$el.height();doTrigger=scrollBottom/totalHeight>=0.55;if(doTrigger){return _this.clickLoadMoreButton(e);}},250));return this._throttledTriggerLoadMoreEvent(e);};Layout.prototype.clickLoadMoreButton=function(e){if(e!=null){e.preventDefault();}
mediator.publish('search:loadMore');return false;};Layout.prototype.hoverTag=function(e){var $el,$tags,tagName,_ref;$el=$(e.target);tagName=(_ref=$el.attr('data-tag'))!=null?_ref.replace("'","\'"):void 0;$tags=$('[data-tag]').removeClass('hovering');if(!tagName){return;}
return $tags.filter('[data-tag="'+tagName+'"]').not($el).addClass('associated');};Layout.prototype.unhoverTag=function(){return $('[data-tag]').removeClass('associated');};Layout.prototype.clickTag=function(e){var $el,tag;e.preventDefault();$el=$(e.target);tag=$el.attr('data-tag');if($el.closest('.tags-container').is('.exclusive-tag-search')){this.publishEvent('search:onlyTag',tag);}else{this.publishEvent('search:addTag',tag);}
this.publishEvent('search:hideAutocomplete');return false;};Layout.prototype.clickTagBundle=function(e){var $el,tagBundle;e.preventDefault();$el=$(e.target);tagBundle=$el.attr('data-tag-bundle');this.publishEvent('search:onlyTagBundle',tagBundle);this.publishEvent('search:hideAutocomplete');return false;};Layout.prototype.clickUser=function(e){var $el,username;e.preventDefault();$el=$(e.target);username=$el.attr('data-user');this.publishEvent('search:addUsername',username);this.publishEvent('search:hideAutocomplete');return false;};Layout.prototype.hoverUnfollow=function(e){return $(e.target).text(e.type==='mouseenter'?'Unfollow':'Following');};Layout.prototype.checkForMeiWeiPromo=function(){var params,_this=this;params={url:"/public/headers",success:function(resp){var lang;lang=resp.pkg['Accept-Language'];if(lang.search(/zh/)===-1||store.get("closedNotification-info-xPromoForMeiweisq")){return;}
return _.delay(function(){var promo;promo=new FlashView({type:'notification',autoDestroy:300000,notiId:'xPromoForMeiweisq',flash:'您是中文用户吗？快来体验我们的中文产品吧！<a target="_blank" href="http://meiweisq.com/delicious"><img data-track-group="promo" data-track-name="meiweisq" src="//meiweisq.com/static/meiweisq-logo.png"></a>'});promo.$el.bind('closed',function(){return store.set('closedNotification-info-xPromoForMeiweisq',true);});return _this.banner.subview('meiwei-promo',promo);},800);}};return api.call(this,params);};Layout.prototype.toggleBanner=function(value){var _ref,_ref1;return(_ref=this.banner)!=null?(_ref1=_ref.$el)!=null?_ref1.toggle(value):void 0:void 0;};Layout.prototype.trackClick=function(e){var $el,eventName,groupName;$el=$(e.target);groupName=$el.attr('data-track-group');eventName=$el.attr('data-track-name')||$el.attr('title')||$el.text();if(eventName){return _gaq.push(['_trackEvent',groupName,'click',eventName]);}};return Layout;})(Chaplin.Layout);}).call(this);}});
window.require.define({"views/links/bulk":function(exports,require,module){(function(){var BulkEditModal,ModalView,encode,logger,mediator,__bind=function(fn,me){return function(){return fn.apply(me,arguments);};},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};encode=require('lib/encode');logger=require('lib/logger');mediator=require('mediator');ModalView=require('views/base/modal');module.exports=BulkEditModal=(function(_super){__extends(BulkEditModal,_super);function BulkEditModal(){this.setupTagAutoComplete=__bind(this.setupTagAutoComplete,this);return BulkEditModal.__super__.constructor.apply(this,arguments);}
BulkEditModal.prototype.template='links/bulk';BulkEditModal.prototype.id='edit-bulk';BulkEditModal.prototype.events={'submit form':'submitEditBulk','click [href="#remove"]':'clickDelete'};BulkEditModal.prototype.initialize=function(){return BulkEditModal.__super__.initialize.apply(this,arguments);};BulkEditModal.prototype.afterRender=function(){BulkEditModal.__super__.afterRender.apply(this,arguments);return _.delay(this.setupTagAutoComplete,400);};BulkEditModal.prototype.setupTagAutoComplete=function(){var _this=this;return this.$('#input-tags-bulk').select2({tags:function(){return _this.model.relatedTags(_this.$('#input-tags-bulk').val())||[];},tokenSeparators:[','],formatNoMatches:function(){return'';}});};BulkEditModal.prototype.submitEditBulk=function(e){var data,tags,urls,_this=this;e.preventDefault();tags=$('#input-tags-bulk').val().split(',');if(tags.length>0){urls=[];_.each($('.link.selected').find('.link-url'),function(link){return urls.push($(link).attr('title'));});data={tags:encode(tags),urls:encode(urls)};return this.model.bulkEdit(data).complete(function(){var tagsHTML,_ref;tagsHTML='<span class="d-icon-tag"></span>';_.each(tags,function(tag,iterator){if(iterator>0){tagsHTML+=', ';}
return tagsHTML+="<a class=\"tag-small\" data-tag=\""+tag+"\" href=\"#\">"+tag+"</a>";});_.each($('.link.selected'),function(link){var $linkTags;$linkTags=$(link).find('.link-tags');$linkTags.html('');return $linkTags.append(tagsHTML);});return(_ref=_this.$el)!=null?_ref.modal('hide'):void 0;});}};BulkEditModal.prototype.clickDelete=function(e){return e.preventDefault();};BulkEditModal.prototype.dispose=function(){this.$('#input-tags').select2('destroy');return BulkEditModal.__super__.dispose.apply(this,arguments);};return BulkEditModal;})(ModalView);}).call(this);}});
window.require.define({"views/links/detail":function(exports,require,module){(function(){var LinkDetailView,NotesCollectionView,View,__bind=function(fn,me){return function(){return fn.apply(me,arguments);};},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};NotesCollectionView=require('views/notes/notes_collection');View=require('lib/view');module.exports=LinkDetailView=(function(_super){__extends(LinkDetailView,_super);function LinkDetailView(){this.closeShare=__bind(this.closeShare,this);return LinkDetailView.__super__.constructor.apply(this,arguments);}
LinkDetailView.prototype.autoRender=true;LinkDetailView.prototype.className='link-details closed span4';LinkDetailView.prototype.container='#delicious .pageview .row';LinkDetailView.prototype.template='links/detail';LinkDetailView.prototype.events={'click [data-tag]':'clickTag','click #details-share-button':'clickShare','click .share-popup':'sharePopup'};LinkDetailView.prototype.initialize=function(){LinkDetailView.__super__.initialize.apply(this,arguments);this.mixin('lib/search_params');return this.modelBind('change',this.render);};LinkDetailView.prototype.afterRender=function(){LinkDetailView.__super__.afterRender.apply(this,arguments);this.notes=this.model.notes();this.subview('notes',new NotesCollectionView({collection:this.notes,container:'.others.comments',heading:'Comments from other users',headingLevel:4,showHeadingIfEmpty:false}));this.notes.fetch();this.$('.scrollable').scrollable();return this.toggle();};LinkDetailView.prototype.clickTag=function(e){var $el,searchPath,tag,username;e.preventDefault();$el=$(e.target);tag=$el.attr('data-tag');username=$el.closest('.note').find('[data-user]').attr('data-user')||null;searchPath=this.searchPathFromSearchParams({tags:[tag],username:username});return this.publishEvent('!router:route',searchPath);};LinkDetailView.prototype.toggle=function(){return this.$el.toggleClass('closed');};LinkDetailView.prototype.clickShare=function(e){e.preventDefault();e.stopPropagation();this.$('.link-share').toggleClass('share-open');return $(document).on('click',this.closeShare);};LinkDetailView.prototype.closeShare=function(e){if(!$(e.target).closest('#details-share-button-wrapper').length){this.$('.link-share').removeClass('share-open');return $(document).off('click',this.closeShare);}};LinkDetailView.prototype.sharePopup=function(e){var $win,height,left,new_title,original_title,specs,top,url,width;e.preventDefault();width=575;height=400;$win=$(window);left=($win.width()-width)/2;top=($win.height()-height)/2;url=$(e.target).attr('href');if(url.indexOf('text=')>-1){original_title=url.substring(url.indexOf('text=')+5,url.indexOf('&url='));new_title=encodeURIComponent(url.substring(url.indexOf('text=')+5,url.indexOf('&url=')));url=url.replace(original_title,new_title);}
specs='status=1'+',width='+width+',height='+height+',top='+top+',left='+left;return window.open(url,'Share from Delicious',specs);};LinkDetailView.prototype.dispose=function(){$(document).off('click',this.closeShare);return LinkDetailView.__super__.dispose.apply(this,arguments);};return LinkDetailView;})(View);}).call(this);}});
window.require.define({"views/links/edit":function(exports,require,module){(function(){var LinkEditModal,ModalView,logger,mediator,__bind=function(fn,me){return function(){return fn.apply(me,arguments);};},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};logger=require('lib/logger');mediator=require('mediator');ModalView=require('views/base/modal');module.exports=LinkEditModal=(function(_super){__extends(LinkEditModal,_super);function LinkEditModal(){this.toggleShowTags=__bind(this.toggleShowTags,this);this.setupTagAutoComplete=__bind(this.setupTagAutoComplete,this);this.setupCarousel=__bind(this.setupCarousel,this);return LinkEditModal.__super__.constructor.apply(this,arguments);}
LinkEditModal.prototype.template='links/edit';LinkEditModal.prototype.id='edit-link';LinkEditModal.prototype.events={'submit form':'submitEditLink','click [href="#remove"]':'clickDelete','change #input-set-tags':'toggleShowTags','keydown #input-note':'checkNoteLimit','keyup #input-note':'checkNoteLimit'};LinkEditModal.prototype.initialize=function(options){this.options=options!=null?options:{};this.options=_.extend(this.defaults,{title:false,size:'normal',closeOnXClick:true,closeOnBackgroundClick:false});LinkEditModal.__super__.initialize.apply(this,arguments);return logger.log("Initializing the LinkEditModal");};LinkEditModal.prototype.afterRender=function(){var _this=this;LinkEditModal.__super__.afterRender.apply(this,arguments);if(!this.options.spinner){_.delay(this.setupCarousel,400);_.delay(this.setupTagAutoComplete,400);_.delay(function(){return _this.$("#input-note")[0].focus();},400);this.noteInput=this.$('#input-note');this.previousTags=false;return this.checkNoteLimit();}};LinkEditModal.prototype.setupCarousel=function(){var slides,_this=this;if(this.html){this.$el.find('.modal-content').html(this.html);}
slides=this.$('.swipe-wrap > div');this.$carousel=this.$('.swipe');if(!(slides.length>1)){return this.$carousel.css('visibility','visible');}else{this.$carousel.Swipe({continuous:true,callback:function(index,el){_this.$('.swipe-indicator').eq(index).addClass('active').siblings().removeClass('active');return _this.$('[name="chosen_image_md5"]').val($(el).data('md5'));}});this.carousel=this.$carousel.data('Swipe');key('right',function(){return _this.$('.swipe-indicator.active').next().trigger('click');});key('left',function(){return _this.$('.swipe-indicator.active').prev().trigger('click');});this.$el.on('click','.swipe-indicator',function(e){var $el;e.preventDefault();$el=$(e.currentTarget);return _this.carousel.slide($el.data('index'),400);});return this.$('.swipe-indicator').first().addClass('active');}};LinkEditModal.prototype.setupTagAutoComplete=function(){var suggested,usertags,_ref;usertags=_.map(mediator.user.get('tags'),function(tag){return tag.name;});suggested=((_ref=this.model.get('recommended'))!=null?_ref.suggested_tags:void 0)||[];this.$('#input-tags').select2({tags:_.uniq(usertags.concat(suggested)),tokenSeparators:[','],formatNoMatches:function(){return'Enter tags separated by commas';}});return this.$('.select2-results').scrollable();};LinkEditModal.prototype.submitEditLink=function(e){var form_data,_this=this;e.preventDefault();this.$('button[type="submit"]').button('loading');form_data=$(e.target).formParams();return this.model.addOrEdit(form_data).complete(function(){var _ref;_this.previousTags=false;return(_ref=_this.$el)!=null?_ref.modal('hide'):void 0;});};LinkEditModal.prototype.toggleShowTags=function(e){var checkbox,currentTags,suggestedTags,tags,tagsAdded,tagsInput,tagsRemoved,_ref;checkbox=$(e.target);tagsInput=this.$('#input-tags');suggestedTags=((_ref=this.model.get('recommended'))!=null?_ref.suggested_tags:void 0)||[];currentTags=tagsInput.select2('val');if(checkbox.attr('checked')==='checked'){this.previousTags=currentTags;return tagsInput.select2('val',_.uniq(currentTags.concat(suggestedTags)));}else{if(!this.previousTags){tags=_.without.apply(_,[currentTags].concat(suggestedTags));}else{tagsAdded=_.difference(currentTags,suggestedTags);tags=_.uniq(this.previousTags.concat(tagsAdded));tagsRemoved=_.difference(tags,currentTags);tags=_.without.apply(_,[tags].concat(tagsRemoved));}
return tagsInput.select2('val',_.uniq(tags));}};LinkEditModal.prototype.checkNoteLimit=function(e){var characters,charsLeft,countDiv,length,max,newValue,overshot,value;max=1000;value=this.noteInput.val();length=value.length;countDiv=this.$(".char-count");if(length>=max){countDiv.text(" Sorry, you have reached the limit!");if(length>max){overshot=length-max;if(overshot>2){newValue=value.substring(0,max-3)+'...';}else{newValue=value.substring(0,max);}
return this.noteInput.val(newValue);}}else{charsLeft=max-length;characters='characters';if(charsLeft===1){characters='character';}
return countDiv.text(""+charsLeft+" "+characters+" left.");}};LinkEditModal.prototype.clickDelete=function(e){var _this=this;e.preventDefault();if(confirm('Are you sure?')){return this.model.remove().done(function(){var _ref;return(_ref=_this.$el)!=null?_ref.modal('hide'):void 0;});}};LinkEditModal.prototype.dispose=function(){$('#input-tags').select2('destroy');mediator.publish('editModal:dispose');return LinkEditModal.__super__.dispose.apply(this,arguments);};return LinkEditModal;})(ModalView);}).call(this);}});
window.require.define({"views/links/link":function(exports,require,module){(function(){var LinkView,View,avosConfig,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};mediator=require('mediator');View=require('lib/view');avosConfig=require('lib/avos');module.exports=LinkView=(function(_super){__extends(LinkView,_super);function LinkView(){return LinkView.__super__.constructor.apply(this,arguments);}
LinkView.prototype.template='links/link';LinkView.prototype.className='link';LinkView.prototype.attributes={'tabindex':'-1'};LinkView.prototype.events={'click .link-title a':'clickLink','click [href="#edit"]':'clickEditLink','click':'clickLinkBrick'};LinkView.prototype.initialize=function(){LinkView.__super__.initialize.apply(this,arguments);this.model.set("avosConfig",avosConfig);this.modelBind('change',_.bind(this.render,this));this.modalOpen=false;return this.clickEditLinkThrottled=_.debounce(this.showEditModal,600,true);};LinkView.prototype.render=function(){LinkView.__super__.render.apply(this,arguments);this.$el.attr('data-md5',this.model.get('md5'));return this.$el.toggleClass('private',this.model.get('private')===true);};LinkView.prototype.clickLink=function(e){if(this.isMobile()){return e.preventDefault();}};LinkView.prototype.clickLinkBrick=function(e){var $link,isUserProfile,me,shiftKey,url,_ref;shiftKey=e.shiftKey||e.shiftLeft;if(shiftKey){if($.browser.msie){this.onselectstart=function(){return false;};me=this;window.setTimeout((function(){return me.onselectstart=null;}),0);}}
if(this.isMobile()&&!$(e.target).parents('.link-badge')[0]){url=this.$el.find('.link-title > a').attr('href');window.open(url,'_blank');}
if(e.target.tagName!=='A'){e.preventDefault();isUserProfile=(location.pathname.split("/")[1]===mediator.user.get('username'))||(((_ref=location.hash.split("#")[1])!=null?_ref.split("/")[0]:void 0)===mediator.user.get('username'));if(isUserProfile){$link=$(e.target);if(!$link.is('.link')){$link=$link.closest('.link');}
mediator.publish('bulkedit:selectone',$link,shiftKey);}
return this.publishEvent('list:activateByMd5',this.model.get('md5'));}};LinkView.prototype.clickEditLink=function(e){e.preventDefault();return this.clickEditLinkThrottled();};LinkView.prototype.showEditModal=function(){return this.model.compose();};return LinkView;})(View);}).call(this);}});
window.require.define({"views/links/list":function(exports,require,module){(function(){var CollectionView,Link,LinkDetail,LinkView,LinksList,Tags,TagsManageModal,logger,mediator,__bind=function(fn,me){return function(){return fn.apply(me,arguments);};},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};CollectionView=require('lib/collection_view');Link=require('models/link');LinkDetail=require('views/links/detail');LinkView=require('views/links/link');logger=require('lib/logger');mediator=require('mediator');TagsManageModal=require('views/tags/manage');Tags=require('models/tags');module.exports=LinksList=(function(_super){__extends(LinksList,_super);function LinksList(){this.deactivateDetailPane=__bind(this.deactivateDetailPane,this);this.loadMore=__bind(this.loadMore,this);this.bulkEditToggle=__bind(this.bulkEditToggle,this);this.bulkEditSelectAll=__bind(this.bulkEditSelectAll,this);this.bulkEditMake=__bind(this.bulkEditMake,this);this.bulkEditDelete=__bind(this.bulkEditDelete,this);this.bulkEditClearSelection=__bind(this.bulkEditClearSelection,this);return LinksList.__super__.constructor.apply(this,arguments);}
LinksList.prototype.template='links/list';LinksList.prototype.itemView=LinkView;LinksList.prototype.container='.links-container';LinksList.prototype.containerMethod='html';LinksList.prototype.className='links';LinksList.prototype.listSelector='.link-list';LinksList.prototype.fallbackSelector='.no-results';LinksList.prototype.loadingIndicator=true;LinksList.prototype.initialize=function(params){LinksList.__super__.initialize.call(this,params);this.modelBind('reset',this.renderSeeAllLink);this.modelBind('change',this.renderSeeAllLink);$('#bulk-edit-btn').on('click',this.bulkEditToggle);$('#bulk-edit-clear-selection').on('click',this.bulkEditClearSelection);$('#bulk-edit-select-all').on('click',this.bulkEditSelectAll);$('#your-tags-modal').on('click',this.tagEditModal);$('#bulk-edit-make-public').on('click',this.bulkEditMake);$('#bulk-edit-make-private').on('click',this.bulkEditMake);$('#delete-links').on('click',this.bulkEditDelete);this.subscribeEvent('list:activateByMd5',this.activateByMd5);this.subscribeEvent('search:loadMore',this.loadMore);this.subscribeEvent('click .load-more',this.loadMore);this.subscribeEvent('follower:hide',this.showNewFollower);this.subscribeEvent('bulkedit:activate',this.bulkEditActivate);this.subscribeEvent('bulkedit:deactivate',this.bulkEditDeactivate);this.subscribeEvent('bulkedit:selectall',this.bulkEditSelectAll);this.subscribeEvent('bulkedit:selectone',this.bulkEditSelectOne);this.subscribeEvent('bulkedit:toggle',this.bulkEditToggle);this.subscribeEvent('link:hideAllDetailPanes',this.deactivateDetailPane);this.seeAllPath=(params!=null?params.seeAllPath:void 0)||null;this._renderAllItemsCounter=0;return this.bulkEditActive=false;};LinksList.prototype.afterRender=function(){var _ref;LinksList.__super__.afterRender.apply(this,arguments);$('#refresh-page').on('click',this.refreshPage);if(((_ref=this.collection)!=null?_ref.length:void 0)>0){return this.hideLoading();}};LinksList.prototype.refreshPage=function(){return window.location.reload();};LinksList.prototype.activateByMd5=function(md5){var matches;if(!this.bulkEditActive){this.$('.link').removeClass('expanded').filter("[data-md5=\""+md5+"\"]").addClass('expanded');}
matches=this.collection.where({md5:md5});if(matches.length>0){return this.showDetailPane(matches[0]);}};LinksList.prototype.bulkEditActivate=function(e){if(e!=null){e.preventDefault();}
logger.log("Bulk edit activated");$('#bulk-edit-on').show();$('#bulk-edit-btn').text('Finish editing');$('[href="#edit"]').hide();$('.details-arrow').hide();$('[href="#bulk-edit"]').css('display','block');$('.link-details').hide();this.$('.link').removeClass('expanded');return this.bulkEditActive=true;};LinksList.prototype.bulkEditClearAll=function(e){if(e!=null){e.preventDefault();}
this.bulkEditClearSelection();$('#bulk-edit-count').text(0);$('[href="#edit"]').show();return $('[href="#bulk-edit"]').css('display','none');};LinksList.prototype.bulkEditClearSelection=function(e){if(e!=null){e.preventDefault();}
this.bulkEditClearCount();return this.$('.link.selected').removeClass('selected');};LinksList.prototype.bulkEditClearCount=function(){$('#bulk-edit-count').text(0);return $('#bulk-edit-dd-button').addClass('disabled');};LinksList.prototype.bulkEditCount=function(val){var $count,$val;logger.log("value is: "+val);$count=$('#bulk-edit-count');$val=parseInt($count.text());$val+=val;$count.text($val);if($val>0){return $('#bulk-edit-dd-button').removeClass('disabled');}else{return $('#bulk-edit-dd-button').addClass('disabled');}};LinksList.prototype.bulkEditDeactivate=function(e){if(e!=null){e.preventDefault();}
this.bulkEditClearAll();logger.log("Bulk edit deactivated");$('#bulk-edit-on').hide();$('#bulk-edit-btn').text('Edit links');$('.details-arrow').show();$('.link-details').show();this.$('.link').first().addClass('expanded');return this.bulkEditActive=false;};LinksList.prototype.bulkEditDelete=function(e){var count,links,msg,_this=this;e.preventDefault();count=$('#bulk-edit-count').text();msg=count>1?"Are you sure you want to delete these "+count+" links?":"Are you sure you want to delete this link?";if(confirm(msg)){links=new Link;return this.getDataFromSelectedLinks($('.link.selected'),function(md5s){links.deleteAll(md5s);_this.$('.link.selected').remove();return _this.bulkEditClearSelection();});}};LinksList.prototype.bulkEditMake=function(e){var links,type;e.preventDefault();type=$(e.target).attr('href');type=type.split('#')[1];links=new Link;return this.getDataFromSelectedLinks($('.link.selected'),function(md5s,models){var _this=this;return links.markAs(type,md5s,function(){_.each(models,function(model){return model.set({"private":type==='private'});});return _this.bulkEditClearSelection();});});};LinksList.prototype.bulkEditSelectOne=function($link,shiftKey){logger.log("Bulk Edit Select One",{link:$link,shiftKey:shiftKey});if($link.hasClass('selected')){logger.log("Removing a link from bulk edit",{link:$link});$link.removeClass('selected');return this.bulkEditCount(-1);}else{if(!this.bulkEditActive&&shiftKey){this.bulkEditActivate();}
if(this.bulkEditActive||shiftKey){logger.log("Selected a link for bulk edit",{link:$link});$link.removeClass('expanded');$link.addClass('selected');return this.bulkEditCount(1);}}};LinksList.prototype.bulkEditSelectAll=function(e){var $links;e.preventDefault();logger.log("Bulk edit select all links");$links=this.$('.link');$links.addClass('selected');return $('#bulk-edit-count').text($links.length);};LinksList.prototype.bulkEditToggle=function(e){if(e!=null){e.preventDefault();}
if(this.bulkEditActive){return this.bulkEditDeactivate();}else{return this.bulkEditActivate();}};LinksList.prototype.getDataFromSelectedLinks=function($selectedLinks,callback){var collection,md5s,models;collection=this.collection;md5s=[];models=[];$selectedLinks.each(function(){var md5,model;md5=$(this).attr('data-md5');md5s.push(md5);model=collection.where({md5:md5});return models.push(model[0]);});md5s=md5s.join(',');if(typeof callback==="function"){return callback.call(this,md5s,models);}};LinksList.prototype.loadMore=function(e){var $loadMoreBtn,_this=this;if(e!=null){e.preventDefault();}
this.publishEvent('search:searching');$loadMoreBtn=this.$('.load-more').button('loading');this.setLoading();return this.collection.fetch({success:function(){if(_this.bulkEditActive){_this.bulkEditActivate();}
_this.publishEvent('search:finish',_this.collection);_this.hideLoading();return $loadMoreBtn.button('reset');}});};LinksList.prototype.renderAllItems=function(){var $refreshLink,activeLink,firstLink,_ref,_ref1;LinksList.__super__.renderAllItems.apply(this,arguments);if(this.bulkEditActive){this.bulkEditActivate();$refreshLink=$('#featured-followers-refresh');$refreshLink.off('click',this.refreshFollowers);$refreshLink.on('click',this.refreshFollowers);}
firstLink=this.$('.link').first();activeLink=$('.link.expanded').first();if(activeLink.length===0||((_ref=activeLink.offset())!=null?_ref.top:void 0)>((_ref1=firstLink.offset())!=null?_ref1.top:void 0)){$('.link').removeClass('expanded');this.publishEvent('link:hideAllDetailPanes');return this.activateByMd5(firstLink.data('md5'));}};LinksList.prototype.deactivateDetailPane=function(){var _ref;return(_ref=this.currentDetailPane)!=null?_ref.dispose():void 0;};LinksList.prototype.refreshFollowers=function(e){return $('#featured-followers-refresh').toggleClass('rotating');};LinksList.prototype.renderSeeAllLink=function(){if(this.bulkEditActive){this.bulkEditActivate();}
if(this.seeAllPath){this.$('.see-all').remove();if(this.collection.length>0){return this.$el.prepend("<a class=\"btn btn-link see-all\" href=\""+this.seeAllPath+"\">See all results</a>");}}};LinksList.prototype.showDetailPane=function(model){var _ref,_ref1;if(!(this.bulkEditActive||model===((_ref=this.currentDetailPane)!=null?_ref.model:void 0))){if((_ref1=this.currentDetailPane)!=null){_ref1.dispose();}
return this.currentDetailPane=new LinkDetail({model:model});}};LinksList.prototype.showNewFollower=function(){return $('#featured-followers-container .user-card:eq(4)').fadeIn();};LinksList.prototype.tagEditModal=function(e){e.preventDefault();return new TagsManageModal({title:"Manage Tags",collection:new Tags(mediator.user.get('tags'))});};LinksList.prototype.dispose=function(){LinksList.__super__.dispose.apply(this,arguments);$('#bulk-edit-btn').off('click',this.bulkEditToggle);$('#bulk-edit-clear-selection').off('click',this.bulkEditClearSelection);$('#bulk-edit-select-all').off('click',this.bulkEditSelectAll);$('#your-tags-modal').off('click',this.tagEditModal);$('#bulk-edit-make-public').off('click',this.bulkEditMake);$('#bulk-edit-make-private').off('click',this.bulkEditMake);$('#delete-links').off('click',this.bulkEditDelete);return $('#refresh-page').off('click',this.refreshPage);};return LinksList;})(CollectionView);}).call(this);}});
window.require.define({"views/links/search_results":function(exports,require,module){(function(){var PageView,SearchResultsView,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};PageView=require('views/base/page');module.exports=SearchResultsView=(function(_super){__extends(SearchResultsView,_super);function SearchResultsView(){return SearchResultsView.__super__.constructor.apply(this,arguments);}
SearchResultsView.prototype.className='search pageview';SearchResultsView.prototype.template='search/results';SearchResultsView.prototype.autoRender=true;return SearchResultsView;})(PageView);}).call(this);}});
window.require.define({"views/links/warn":function(exports,require,module){(function(){var PageView,WarnView,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};PageView=require('views/base/page');module.exports=WarnView=(function(_super){__extends(WarnView,_super);function WarnView(){return WarnView.__super__.constructor.apply(this,arguments);}
WarnView.prototype.template='links/warn';WarnView.prototype.autoRender=true;return WarnView;})(PageView);}).call(this);}});
window.require.define({"views/notes/note":function(exports,require,module){(function(){var NoteView,PopoverView,View,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};PopoverView=require('views/base/popover');View=require('lib/view');module.exports=NoteView=(function(_super){__extends(NoteView,_super);function NoteView(){return NoteView.__super__.constructor.apply(this,arguments);}
NoteView.prototype.className='note';NoteView.prototype.template='notes/note';NoteView.prototype.autoRender=false;NoteView.prototype.afterRender=function(){NoteView.__super__.afterRender.apply(this,arguments);return this.subview('hovercard',new PopoverView({el:this.$el.find('h5 a'),template:'user/user_card',model:this.model,trigger:'hover',classes:'user-card wider'}));};return NoteView;})(View);}).call(this);}});
window.require.define({"views/notes/notes_collection":function(exports,require,module){(function(){var CollectionView,NotesCollectionView,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};CollectionView=require('lib/collection_view');module.exports=NotesCollectionView=(function(_super){__extends(NotesCollectionView,_super);function NotesCollectionView(){return NotesCollectionView.__super__.constructor.apply(this,arguments);}
NotesCollectionView.prototype.className='notes';NotesCollectionView.prototype.containerMethod='html';NotesCollectionView.prototype.itemView=require('views/notes/note');return NotesCollectionView;})(CollectionView);}).call(this);}});
window.require.define({"views/oops/notfound":function(exports,require,module){(function(){var NotFoundView,PageView,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};PageView=require('views/base/page');module.exports=NotFoundView=(function(_super){__extends(NotFoundView,_super);function NotFoundView(){return NotFoundView.__super__.constructor.apply(this,arguments);}
NotFoundView.prototype.template='oops/notfound';NotFoundView.prototype.autoRender=true;NotFoundView.prototype.className='pageview oops-page big-text';NotFoundView.prototype.initialize=function(){NotFoundView.__super__.initialize.apply(this,arguments);return log("Initializing the Not Found View.");};return NotFoundView;})(PageView);}).call(this);}});
window.require.define({"views/oops/somethingwentwrong":function(exports,require,module){(function(){var PageView,SomethingWentWrongView,logger,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};logger=require('lib/logger');mediator=require('mediator');PageView=require('views/base/page');module.exports=SomethingWentWrongView=(function(_super){__extends(SomethingWentWrongView,_super);function SomethingWentWrongView(){return SomethingWentWrongView.__super__.constructor.apply(this,arguments);}
SomethingWentWrongView.prototype.template='oops/somethingwentwrong';SomethingWentWrongView.prototype.autoRender=true;SomethingWentWrongView.prototype.className='pageview oops-page big-text';SomethingWentWrongView.prototype.containerMethod='html';SomethingWentWrongView.prototype.initialize=function(){SomethingWentWrongView.__super__.initialize.apply(this,arguments);$('body').css('background-color','white');$('.modal').modal('hide');$('head').append("<style type=\"text/css\" media=\"screen\">#uvTab { display: none !important; }</style>");return logger.log("Initializing the Something Went Wrong View.");};SomethingWentWrongView.prototype.dispose=function(){$('body').css('background-color','transparent').removeClass('');return SomethingWentWrongView.__super__.dispose.apply(this,arguments);};return SomethingWentWrongView;})(PageView);}).call(this);}});
window.require.define({"views/tags/edit_bundle_modal":function(exports,require,module){(function(){var EditBundleModal,FlashView,ModalView,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};mediator=require('mediator');ModalView=require('views/base/modal');FlashView=require('views/base/flash');module.exports=EditBundleModal=(function(_super){__extends(EditBundleModal,_super);function EditBundleModal(){return EditBundleModal.__super__.constructor.apply(this,arguments);}
EditBundleModal.prototype.template='tags/edit_bundle_modal';EditBundleModal.prototype.id='edit-bundle';EditBundleModal.prototype.events={'submit form':'submitForm','click [href="#remove"]':'clickRemove'};EditBundleModal.prototype.render=function(){var suggested,_this=this;EditBundleModal.__super__.render.apply(this,arguments);this.subscribeEvent('tagBundle:save',this.closeModal);this.subscribeEvent('tagBundle:delete',this.closeModal);suggested=_.map(mediator.user.get('tags'),function(tag){return tag.name;});return _.delay(function(){return _this.$('#input-tags').select2({openOnEnter:false,tags:_.uniq(suggested),tokenSeparators:[','],formatNoMatches:function(){return'Enter tags separated by commas';}},400);});};EditBundleModal.prototype.submitForm=function(e){var currentBundles,data,matches,name,previous,tags,_ref,_this=this;e.preventDefault();_ref=$(e.target).formParams(),name=_ref.name,tags=_ref.tags;if(!name){this.$('#input-name').focus();return;}
if(!tags){this.$('#input-tags').select2('open');return;}
if(this.model.get('name')){previous=this.model.clone();}
data={name:name,tags:tags,username:this.options.username,previous:previous||null};currentBundles=this.options.collection.reject(function(bundle){return bundle.get('name')===(previous!=null?previous.get('name'):void 0);});matches=_.filter(currentBundles,function(bundle){return bundle.get('name')===name;});if(matches.length){this.subview('error',new FlashView({flash:'A bundle with that name already exists.',type:'error',closeOnXClick:false,container:this.$('.modal-body')}));return;}
return this.model.save(data).success(function(){var _ref1;if(!previous){return(_ref1=_this.options.collection)!=null?_ref1.add(_this.model):void 0;}});};EditBundleModal.prototype.clickRemove=function(e){var _this=this;e.preventDefault();if(confirm('Are you sure?')){return this.model["delete"]().success(function(){var _ref;return(_ref=_this.options.collection)!=null?_ref.remove(_this.model):void 0;});}};EditBundleModal.prototype.closeModal=function(){return this.$el.modal('hide');};EditBundleModal.prototype.dispose=function(){this.$('#input-tags').select2('destroy');return EditBundleModal.__super__.dispose.apply(this,arguments);};return EditBundleModal;})(ModalView);}).call(this);}});
window.require.define({"views/tags/manage":function(exports,require,module){(function(){var ModalView,TagsManageModal,log,logger,mediator,__bind=function(fn,me){return function(){return fn.apply(me,arguments);};},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};logger=require('lib/logger');log=logger.log;mediator=require('mediator');ModalView=require('views/base/modal');module.exports=TagsManageModal=(function(_super){__extends(TagsManageModal,_super);function TagsManageModal(){this.setupTagAutoComplete=__bind(this.setupTagAutoComplete,this);return TagsManageModal.__super__.constructor.apply(this,arguments);}
TagsManageModal.prototype.template='tags/manage';TagsManageModal.prototype.id='tags-manage';TagsManageModal.prototype.title="Tags Management";TagsManageModal.prototype.size='normal';TagsManageModal.prototype.events={'submit form':'submit'};TagsManageModal.prototype.afterRender=function(){TagsManageModal.__super__.afterRender.apply(this,arguments);_.delay(this.setupTagAutoComplete,400);return this.$('.modal-body').addClass('show-overflow');};TagsManageModal.prototype.setupTagAutoComplete=function(){var data;data=this.collection.map(function(x){return{id:x.get('name'),text:x.get('name')};});return this.$('#from-tagname, #delete-tagname').select2({data:data,formatNoMatches:function(){return'Enter a tag';},width:'element',containerCssClass:'select2-box'});};TagsManageModal.prototype.submit=function(e){var data,form_data,_ref,_ref1,_ref2,_this=this;e.preventDefault();this.$('button[type="submit"]').button('loading');form_data=$(e.target).formParams();data=_(form_data).pick('from_tag','to_tag','delete_tag');if(((_ref=data.from_tag)!=null?_ref.trim().length:void 0)&&((_ref1=data.to_tag)!=null?_ref1.trim().length:void 0)){this.collection.get(data.from_tag).rename(data.to_tag).complete(function(){var _ref2;return(_ref2=_this.$el)!=null?_ref2.modal('hide'):void 0;});}
if((_ref2=data.delete_tag)!=null?_ref2.trim().length:void 0){return this.collection.get(data.delete_tag).remove().complete(function(){var _ref3;return(_ref3=_this.$el)!=null?_ref3.modal('hide'):void 0;});}};TagsManageModal.prototype.dispose=function(){this.$('.input-tag').select2('destroy');return TagsManageModal.__super__.dispose.apply(this,arguments);};return TagsManageModal;})(ModalView);}).call(this);}});
window.require.define({"views/tags/related_tag_list":function(exports,require,module){(function(){var Tags,TagsCollectionView,TagsManageModal,View,logger,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};View=require('lib/view');logger=require('lib/logger');mediator=require('mediator');Tags=require('models/tags');TagsManageModal=require('views/tags/manage');module.exports=TagsCollectionView=(function(_super){__extends(TagsCollectionView,_super);function TagsCollectionView(){return TagsCollectionView.__super__.constructor.apply(this,arguments);}
TagsCollectionView.prototype.el='.tags-container.related';TagsCollectionView.prototype.listSelector='.tag-list';TagsCollectionView.prototype.fallbackSelector='.no-results';TagsCollectionView.prototype.loadingIndicator=true;TagsCollectionView.prototype.showingAllTags=false;TagsCollectionView.prototype.render=function(){var o,_this=this;o=[];if(this.collection.length===0){return;}
this.$(this.fallbackSelector).hide();_.each(this.collection.toJSON(),function(tag,i){var cls,count;count=tag.num_saves?" <small>"+tag.num_saves+"</small>":'';cls=i>15&&_this.showingAllTags===false?' hidden':'';return o.push("<a class=\"tag tag-small"+cls+"\" data-tag=\""+tag.name+"\" href=\"#\">"+tag.name+count+"</a>");});return this.$el.find(this.listSelector).html(o.join(''));};TagsCollectionView.prototype.events={'click [href="#more"]':'showAllTags','click .sort-by-menu a':'performSort'};TagsCollectionView.prototype.initialize=function(options){TagsCollectionView.__super__.initialize.apply(this,arguments);this.count=0;this.showingAllTags=options.showingAllTags||false;this.options.selected=(options!=null?options.selected:void 0)||'count';this.performSort();return this.collection.on('reset',this.render);};TagsCollectionView.prototype.afterRender=function(){TagsCollectionView.__super__.afterRender.apply(this,arguments);this.$("#sort-by-"+this.options.selected).addClass('selected');return this.$('.tag-list').scrollable();};TagsCollectionView.prototype.performSort=function(e){var $el;if(e!=null){e.preventDefault();e.stopPropagation();this.$('.sort-tags-dropdown').removeClass('open');$el=$(e.target);$el.parent().siblings().children('a').removeClass('selected');$el.addClass('selected');this.options.selected=$el.text().toLowerCase();store.set('orderBy',this.options.selected);}
this.collection.comparator=(function(){switch(this.options.selected){case'abc':return function(tag){return tag.get('name').toLowerCase();};default:return(new Tags).comparator;}}).call(this);return this.collection.sort();};TagsCollectionView.prototype.showAllTags=function(e){e.preventDefault();this.$('.tag').removeClass('hidden');this.$('[href="#more"]').remove();return this.showingAllTags=true;};return TagsCollectionView;})(View);}).call(this);}});
window.require.define({"views/tags/tag":function(exports,require,module){(function(){var TagView,View,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};View=require('lib/view');module.exports=TagView=(function(_super){__extends(TagView,_super);function TagView(){return TagView.__super__.constructor.apply(this,arguments);}
TagView.prototype.autoRender=false;TagView.prototype.render=function(){var count,name;name=this.model.get('name');count=this.model.get('num_saves')?" <small>"+(this.model.get('num_saves'))+"</small>":'';return this.setElement("<a class=\"tag tag-small\" data-tag=\""+name+"\" href=\"#\">"+name+count+"</a>");};return TagView;})(View);}).call(this);}});
window.require.define({"views/tags/tag_bundle":function(exports,require,module){(function(){var TagBundleView,View,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};View=require('lib/view');module.exports=TagBundleView=(function(_super){__extends(TagBundleView,_super);function TagBundleView(){return TagBundleView.__super__.constructor.apply(this,arguments);}
TagBundleView.prototype.containerMethod='append';TagBundleView.prototype.initialize=function(){TagBundleView.__super__.initialize.apply(this,arguments);return this.modelBind('change',this.render);};TagBundleView.prototype.render=function(){var count,name;name=this.model.get('name');count=this.model.get('num_saves')?" <small>"+(this.model.get('num_saves'))+"</small>":'';return this.$el.html("<a class=\"tag-bundle\" data-tag-bundle=\""+name+"\" href=\"#\">"+name+count+"</a>");};return TagBundleView;})(View);}).call(this);}});
window.require.define({"views/tags/tag_bundle_list":function(exports,require,module){(function(){var CollectionView,TagBundle,TagBundleList,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};CollectionView=require('lib/collection_view');TagBundle=require('views/tags/tag_bundle');module.exports=TagBundleList=(function(_super){__extends(TagBundleList,_super);function TagBundleList(){return TagBundleList.__super__.constructor.apply(this,arguments);}
TagBundleList.prototype.itemView=TagBundle;TagBundleList.prototype.container='.tag-bundles-container';TagBundleList.prototype.className="sidebar-list";return TagBundleList;})(CollectionView);}).call(this);}});
window.require.define({"views/tags/tag_bundle_row":function(exports,require,module){(function(){var TagBundleRow,View,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};mediator=require('mediator');View=require('lib/view');module.exports=TagBundleRow=(function(_super){__extends(TagBundleRow,_super);function TagBundleRow(){return TagBundleRow.__super__.constructor.apply(this,arguments);}
TagBundleRow.prototype.template='tags/tag_bundle_row';TagBundleRow.prototype.className='tag-bundle-row';return TagBundleRow;})(View);}).call(this);}});
window.require.define({"views/tags/tag_bundles_modal":function(exports,require,module){(function(){var EditBundleModal,ModalCollectionView,TagBundle,TagBundleRow,TagBundlesModal,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};EditBundleModal=require('views/tags/edit_bundle_modal');ModalCollectionView=require('views/base/modal_collection');TagBundle=require('models/tag_bundle');TagBundleRow=require('views/tags/tag_bundle_row');module.exports=TagBundlesModal=(function(_super){__extends(TagBundlesModal,_super);function TagBundlesModal(){return TagBundlesModal.__super__.constructor.apply(this,arguments);}
TagBundlesModal.prototype.itemView=TagBundleRow;TagBundlesModal.prototype.events={'click [href="#create-bundle"]':'clickCreateBundle','click [href="#edit-bundle"]':'clickEditBundle'};TagBundlesModal.prototype.renderCollection=function(){TagBundlesModal.__super__.renderCollection.apply(this,arguments);return this.$('.modal-body').prepend("<a href=\"#create-bundle\" id=\"create-bundle\" class=\"btn\">Create bundle</a>");};TagBundlesModal.prototype.clickCreateBundle=function(e){var collection,options;e.preventDefault();options=this.options;collection=this.collection;_.defer(function(){return new EditBundleModal({title:'Create Bundle',model:new TagBundle,username:options.username,size:'slim',collection:collection});});return this.dispose();};TagBundlesModal.prototype.clickEditBundle=function(e){var $el,collection,index,model,options;e.preventDefault();$el=$(e.currentTarget);index=$el.closest('.tag-bundle-row').index();model=this.collection.at(index-1);options=this.options;collection=this.collection;model.fetchTags(options.username,model.get('name')).done(function(){return new EditBundleModal({title:model.get('name'),model:model,username:options.username,size:'slim',collection:collection});});return this.dispose();};return TagBundlesModal;})(ModalCollectionView);}).call(this);}});
window.require.define({"views/user/coachmarks":function(exports,require,module){(function(){var CoachmarksView,View,logger,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};logger=require('lib/logger');View=require('lib/view');module.exports=CoachmarksView=(function(_super){__extends(CoachmarksView,_super);function CoachmarksView(){return CoachmarksView.__super__.constructor.apply(this,arguments);}
CoachmarksView.prototype.container='body';CoachmarksView.prototype.template='user/coachmarks';CoachmarksView.prototype.className='coachmarks fade';CoachmarksView.prototype.events={'click':'dismiss'};CoachmarksView.prototype.initialize=function(){CoachmarksView.__super__.initialize.apply(this,arguments);return logger.log("initialising the CoachmarksView");};CoachmarksView.prototype.afterRender=function(){var _this=this;CoachmarksView.__super__.afterRender.apply(this,arguments);return _.defer(function(){return _this.$el.addClass('in');});};CoachmarksView.prototype.dismiss=function(){this.$el.removeClass('in');setTimeout(_.bind(this.dispose,this),150);return store.set('closedCoachmarks',true);};return CoachmarksView;})(View);}).call(this);}});
window.require.define({"views/user/featured_followers":function(exports,require,module){(function(){var FeaturedFollowersView,View,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};mediator=require('mediator');View=require('lib/view');module.exports=FeaturedFollowersView=(function(_super){__extends(FeaturedFollowersView,_super);function FeaturedFollowersView(){return FeaturedFollowersView.__super__.constructor.apply(this,arguments);}
FeaturedFollowersView.prototype.className='featured-follower user-card fade';FeaturedFollowersView.prototype.tagName='li';FeaturedFollowersView.prototype.template='user/user_card';FeaturedFollowersView.prototype.autoRender=false;FeaturedFollowersView.prototype.events={'click a[href="#follow"]':'hideFollower'};FeaturedFollowersView.prototype.initialize=function(){FeaturedFollowersView.__super__.initialize.apply(this,arguments);return this.mixin('views/user/mixins/follow_button');};FeaturedFollowersView.prototype.afterRender=function(){var _this=this;return window.setTimeout(function(){return _this.$el.addClass('in');},1);};FeaturedFollowersView.prototype.hideFollower=function(e){e.preventDefault();this.$el.fadeOut().remove();return mediator.publish('follower:hide',this);};return FeaturedFollowersView;})(View);}).call(this);}});
window.require.define({"views/user/featured_followers_collection":function(exports,require,module){(function(){var CollectionView,FeaturedFollowersCollectionView,FeaturedFollowersView,logger,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};CollectionView=require('lib/collection_view');FeaturedFollowersView=require('views/user/featured_followers');logger=require('lib/logger');module.exports=FeaturedFollowersCollectionView=(function(_super){__extends(FeaturedFollowersCollectionView,_super);function FeaturedFollowersCollectionView(){return FeaturedFollowersCollectionView.__super__.constructor.apply(this,arguments);}
FeaturedFollowersCollectionView.prototype.id="featured-followers-wrapper";FeaturedFollowersCollectionView.prototype.template='user/featured_followers_collectionview';FeaturedFollowersCollectionView.prototype.listSelector='#featured-followers-container';FeaturedFollowersCollectionView.prototype.itemView=FeaturedFollowersView;FeaturedFollowersCollectionView.prototype.container='#links-results';FeaturedFollowersCollectionView.prototype.containerMethod='prepend';FeaturedFollowersCollectionView.prototype.count=4;FeaturedFollowersCollectionView.prototype.events={'click #feat-foll-hide':'hideFeaturedUsers'};FeaturedFollowersCollectionView.prototype.afterRender=function(){FeaturedFollowersCollectionView.__super__.afterRender.apply(this,arguments);if(this.model.get('following_count')<1){this.count=8;}
return $('#featured-followers-container .user-card').slice(this.count).hide();};FeaturedFollowersCollectionView.prototype.hideFeaturedUsers=function(e){e.preventDefault();logger.log("Hiding the featured followers panel");store.set('closedFeaturedFollowers',true);return this.dispose();};return FeaturedFollowersCollectionView;})(CollectionView);}).call(this);}});
window.require.define({"views/user/follow":function(exports,require,module){(function(){var FollowView,View,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};View=require('lib/view');module.exports=FollowView=(function(_super){__extends(FollowView,_super);function FollowView(){return FollowView.__super__.constructor.apply(this,arguments);}
FollowView.prototype.template='user/user_card';FollowView.prototype.className='modal-following user-card';FollowView.prototype.initialize=function(){this.mixin('views/user/mixins/follow_button');FollowView.__super__.initialize.apply(this,arguments);return this.modelBind('change',this.render);};return FollowView;})(View);}).call(this);}});
window.require.define({"views/user/follow_collection":function(exports,require,module){(function(){var Follow,FollowCollectionView,FollowView,ModalCollectionView,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};FollowView=require('views/user/follow');ModalCollectionView=require('views/base/modal_collection');Follow=require('models/follow');module.exports=FollowCollectionView=(function(_super){__extends(FollowCollectionView,_super);function FollowCollectionView(){return FollowCollectionView.__super__.constructor.apply(this,arguments);}
FollowCollectionView.prototype.itemView=FollowView;FollowCollectionView.prototype.events={'click [href="#follow"]':'clickFollow','click [href="#unfollow"]':'clickUnfollow'};FollowCollectionView.prototype.initialize=function(){FollowCollectionView.__super__.initialize.apply(this,arguments);return this.collection.on('change:am_following_them',this.updateFollowingButton,this);};FollowCollectionView.prototype.updateFollowingButton=function(model){var $btn,index;index=this.collection.indexOf(model);if(index>=0){$btn=this.$('.user-card').eq(index).find('[href="#unfollow"], [href="#follow"]');if(model.get('am_following_them')){return $btn.prop('href','#unfollow').text('Following').removeClass('btn-primary');}else{return $btn.prop('href','#follow').text('Follow').addClass('btn-primary');}}};FollowCollectionView.prototype.clickFollow=function(e){var $btn,$row,follow,model;e.preventDefault();$btn=$(e.target);$row=$btn.closest('.user-card');model=this.collection.at($row.index());follow=new Follow;return follow.followUser(model);};FollowCollectionView.prototype.clickUnfollow=function(e){var $btn,$row,follow,model;e.preventDefault();$btn=$(e.target);$row=$btn.closest('.user-card');model=this.collection.at($row.index());follow=new Follow;return follow.unfollowUser(model);};return FollowCollectionView;})(ModalCollectionView);}).call(this);}});
window.require.define({"views/user/mixins/follow_button":function(exports,require,module){(function(){var Follow,View,logger,mediator;Follow=require('models/follow');logger=require('lib/logger');mediator=require('mediator');View=require('lib/view');module.exports={attached:function(){var _ref;if((_ref=this.events)==null){this.events={};}
_(this.events).extend({'click [href="#follow"]':'clickFollow','click [href="#unfollow"]':'clickUnfollow'});return this.model.on('change:am_following_them',this.updateFollowingButton,this);},updateFollowingButton:function(model){var $btn;$btn=this.$('[href="#unfollow"], [href="#follow"]');if(model.get('am_following_them')){return $btn.prop('href','#unfollow').text('Following').removeClass('btn-primary');}else{return $btn.prop('href','#follow').text('Follow').addClass('btn-primary');}},clickFollow:function(e){var follow;e.preventDefault();e.stopImmediatePropagation();follow=new Follow;return follow.followUser(this.model);},clickUnfollow:function(e){var follow;e.preventDefault();e.stopImmediatePropagation();follow=new Follow;return follow.unfollowUser(this.model);}};}).call(this);}});
window.require.define({"views/user/profile":function(exports,require,module){(function(){var CoachmarksView,EditBundleModal,Follow,FollowCollectionView,PageView,ProfileView,TagBundle,TagBundlesModal,UsersCollection,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};CoachmarksView=require('views/user/coachmarks');EditBundleModal=require('views/tags/edit_bundle_modal');Follow=require('models/follow');FollowCollectionView=require('views/user/follow_collection');mediator=require('mediator');PageView=require('views/base/page');TagBundle=require('models/tag_bundle');TagBundlesModal=require('views/tags/tag_bundles_modal');UsersCollection=require('models/users');module.exports=ProfileView=(function(_super){__extends(ProfileView,_super);function ProfileView(){return ProfileView.__super__.constructor.apply(this,arguments);}
ProfileView.prototype.className='profile pageview';ProfileView.prototype.template='user/profile';ProfileView.prototype.autoRender=true;ProfileView.prototype.events={'click a[href="#followers"]':'showFollowers','click a[href="#following"]':'showFollowing','click a[href="#bundles-manage"]':'clickShowBundles'};ProfileView.prototype.initialize=function(params){this.mixin('views/user/mixins/follow_button');this.follow=new Follow;ProfileView.__super__.initialize.apply(this,arguments);this.model.off('change',null);if(mediator.user.get('username')===this.model.get('username')){if(!store.get('closedCoachmarks'||mediator.dispatcher.url==='save')){return this.subview('coachmarks',new CoachmarksView);}}};ProfileView.prototype.afterRender=function(){ProfileView.__super__.afterRender.apply(this,arguments);return Socialite.load(this.$('.tweet-profile'));};ProfileView.prototype.showFollowers=function(e){var followers,name,titlePrefix;e.preventDefault();if(this.model.get('follower_count')===0){return;}
followers=new UsersCollection;followers.comparator=function(user){return-(user.get('time_created')||0);};followers.url=this.follow.getUserFollowersUrl(this.model);followers.fetch();name=this.model.get('full_name')||this.model.get('display_name');titlePrefix=this.model.isMe()?'You have ':""+name+" has ";return new FollowCollectionView({collection:followers,title:function(){return titlePrefix+(""+this.collection.length+" followers");}});};ProfileView.prototype.showFollowing=function(e){var following,name,titlePrefix;e.preventDefault();if(this.model.get('following_count')===0){return;}
following=new UsersCollection;following.comparator=function(user){return-(user.get('time_created')||0);};following.url=this.follow.getUserFollowingUrl(this.model);following.fetch();name=this.model.get('full_name')||this.model.get('display_name');titlePrefix=this.model.isMe()?'You’re ':""+name+"’s ";return new FollowCollectionView({collection:following,title:function(){return titlePrefix+("following "+this.collection.length+" users");}});};ProfileView.prototype.clickShowBundles=function(e){var modal;e.preventDefault();if(this.options.tagBundles.length>0){return modal=new TagBundlesModal({collection:this.options.tagBundles,title:"Tag Bundles <small>"+this.options.tagBundles.length+"</small>",username:this.model.get('username')});}else{return modal=new EditBundleModal({title:'Create Bundle',model:new TagBundle,username:this.model.get('username'),size:'slim'});}};return ProfileView;})(PageView);}).call(this);}});
window.require.define({"views/user/settings/account":function(exports,require,module){(function(){var AccountView,FlashView,PageView,logger,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};FlashView=require('views/base/flash');logger=require('lib/logger');mediator=require('mediator');PageView=require('views/base/page');module.exports=AccountView=(function(_super){__extends(AccountView,_super);function AccountView(){return AccountView.__super__.constructor.apply(this,arguments);}
AccountView.prototype.template='user/settings/account';AccountView.prototype.autoRender=true;AccountView.prototype.events={'submit form':'submitAccount','click #deactivate-account':'deactivateAccount'};AccountView.prototype.initialize=function(){AccountView.__super__.initialize.apply(this,arguments);return this.model=mediator.user;};AccountView.prototype.submitAccount=function(e){var data,regex,_this=this;e.preventDefault();if(!this.validatePassword()){return;}
data=_.pick(this.$('form').formParams(),'profile_email');regex=/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/;if(!regex.test(data.profile_email)){this.showError("Please enter a valid email address");return;}
return mediator.user.update(data,function(user){data=_.pick(_this.$('form').formParams(),'old_password','new_password');if(data.old_password===''){return _this.subview('success',new FlashView({container:'.content',flash:'Email address updated successfully.',type:'success'}));}else{return mediator.user.changePassword(data,function(status,error){if(status==='success'){logger.log("Password changed",data);_this.showError('');return _this.subview('success',new FlashView({container:'.content',flash:'Account updated successfully.',type:'success'}));}else{logger.log("Password change status is: "+status);return _this.showError(error.charAt(0).toUpperCase()+error.slice(1));}});}});};AccountView.prototype.validatePassword=function(e){var minPasswordLength,newPassword;newPassword=this.$('#user-new-password').val();minPasswordLength=8;if(!(newPassword.length>=minPasswordLength)){this.showError("New password must be at least "+minPasswordLength+" characters long");return false;}
this.showError('');return true;};AccountView.prototype.deactivateAccount=function(e){e.preventDefault();return alert("not implemented");};AccountView.prototype.showError=function(msg){return this.$('#error').text(msg);};return AccountView;})(PageView);}).call(this);}});
window.require.define({"views/user/settings/service":function(exports,require,module){(function(){var ConnectsCollection,FlashView,Model,PageView,ServiceView,logger,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};FlashView=require('views/base/flash');mediator=require('mediator');Model=require('lib/model');PageView=require('views/base/page');ConnectsCollection=require('models/connects');logger=require('lib/logger');module.exports=ServiceView=(function(_super){__extends(ServiceView,_super);function ServiceView(){return ServiceView.__super__.constructor.apply(this,arguments);}
ServiceView.prototype.autoRender=true;ServiceView.prototype.defaults={template:'user/sources/facebook',service:'facebook'};ServiceView.prototype.events={'submit form':'saveChanges','click .disconnect':'disconnectService'};ServiceView.prototype.initialize=function(options){var connects,privacy_opts,_this=this;this.options=options!=null?options:{};_(this.options).defaults(this.defaults);ServiceView.__super__.initialize.apply(this,arguments);privacy_opts={'ALL_PUBLIC':{value:'ALL_PUBLIC',text:'Make links public',selected:true},'ALL_PRIVATE':{value:'ALL_PRIVATE',text:'Make links private',selected:false},'AUTOMATIC':{value:'AUTOMATIC',text:'Keep the same privacy',selected:false}};this.model=new Model({tags:'',options:_.values(privacy_opts)});connects=new ConnectsCollection;return connects.fetch().done(function(){var connect;connect=connects.find(function(x){return x.get('providerId')===_this.options.service;});if(connect){_.each(privacy_opts,function(x){return x.selected=false;});privacy_opts[connect.get('privateAttri')]['selected']=true;_this.model=connect;_this.model.set('options',_.values(privacy_opts));_this.render();return _this._enablePage();}});};ServiceView.prototype.afterRender=function(){ServiceView.__super__.afterRender.apply(this,arguments);return this.$('select').selectpicker();};ServiceView.prototype._enablePage=function(){this.$('input, select').removeProp('disabled');this.$('.bootstrap-select button').removeClass('disabled');return this.$('#settings-form .disconnect').show();};ServiceView.prototype._disablePage=function(){this.$('input, select').attr('disabled','disabled');this.$('.bootstrap-select button').addClass('disabled','disabled');return this.$('#settings-form .disconnect').hide();};ServiceView.prototype.saveChanges=function(e){var data,_this=this;e.preventDefault();data=_.pick(this.$('form').formParams(),'privacy','tags');logger.log('submitting import settings form',{data:data});return this.model.update(data,function(user){return _this.subview('success',new FlashView({container:'#settings-form',flash:'Your changes have been saved.',type:'success'}));});};ServiceView.prototype.disconnectService=function(e){var service,user;user=mediator.user;service=this.model.get('providerId');return this.model.disconnectService(user,service,this._disablePage);};return ServiceView;})(PageView);}).call(this);}});
window.require.define({"views/user/settings/settings":function(exports,require,module){(function(){var FlashView,Model,PageView,SettingsView,avosConfig,logger,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};FlashView=require('views/base/flash');logger=require('lib/logger');mediator=require('mediator');Model=require('lib/model');PageView=require('views/base/page');avosConfig=require('lib/avos');module.exports=SettingsView=(function(_super){__extends(SettingsView,_super);function SettingsView(){return SettingsView.__super__.constructor.apply(this,arguments);}
SettingsView.prototype.template='user/settings/settings';SettingsView.prototype.autoRender=true;SettingsView.prototype.maxFileSize=2000;SettingsView.prototype.events={'submit #settings-form':'submitProfile','submit #photo-form':'submitAvatar','change #user-photo-input':'showFilePath','keyup #user-bio':'bioLimit'};SettingsView.prototype.initialize=function(){SettingsView.__super__.initialize.apply(this,arguments);if(!$('html').hasClass('lt-ie10')){return this.events['click #user-photo-button']='clickPhotoUpload';}};SettingsView.prototype.afterRender=function(e){var avatarUrl,newAvatarUrl,_this=this;SettingsView.__super__.afterRender.apply(this,arguments);this.bioLimit();window.setTimeout(function(){return _this.$('.user-avatar img').addClass('in');},200);this.photoInputSpan=this.$('#user-photo-text');this.photoInput=this.$('#user-photo-input');avatarUrl=this.model.get('avatar_url');return newAvatarUrl=avatarUrl+'?'+new Date().getTime();};SettingsView.prototype.submitProfile=function(e){var data,_this=this;e.preventDefault();data=_.pick(this.$('form').formParams(),'full_name','profile_bio','profile_url');logger.log('submitting profile update form',{data:data});return mediator.user.update(data,function(user){return _this.subview('success',new FlashView({container:'.content',flash:'Profile updated successfully.',type:'success'}));});};SettingsView.prototype.bioLimit=function(e){var char,length,max;max=140;length=this.$('#user-bio').val().length;if(length>=max){return this.$("#bio-count").text(" Sorry, you have reached the limit!");}else{char=max-length;return this.$("#bio-count").text(char+" characters left.");}};SettingsView.prototype.uploadError=function(err){return $('#photo-upload-error').text(err);};SettingsView.prototype.clickPhotoUpload=function(e){e.preventDefault();return this.photoInput.click();};SettingsView.prototype.showFilePath=function(e){var filePath;this.uploadError('');filePath=this.photoInput.val();if(this.photoInput[0].files&&(this.photoInput[0].files[0].size/1000)>this.maxFileSize){this.resetInput();this.uploadError('Image size too big.');return;}
if(!filePath){this.resetInput();return;}
return this.photoInputSpan.text(filePath.split(/(\\|\/)/g).pop());};SettingsView.prototype.resetInput=function(){this.photoInputSpan.text('No image selected');return this.photoInput.val('');};SettingsView.prototype.submitAvatar=function(e){var _this=this;if(e!=null){e.preventDefault();}
if(!this.photoInput.val()){this.photoInputSpan.addClass('on');_.delay(function(){return _this.photoInputSpan.removeClass('on');},500);return;}
logger.log('Submitting avatar upload');this.setLoading();return mediator.user.updateAvatar(this.$("#photo-form"),function(status,err){if(status==='success'){_this.hideLoading();_this.resetInput();logger.log("User updated, re-rendering the settings view.");_this.render();return _this.subview('success',new FlashView({container:'#settings-form',flash:'Image uploaded successfully.',type:'success'}));}else{return _this.subview('success',new FlashView({container:'#settings-form',flash:err+'.',type:'success'}));}});};SettingsView.prototype.dispose=function(){SettingsView.__super__.dispose.apply(this,arguments);return this.$('.user-avatar img').removeClass('in');};return SettingsView;})(PageView);}).call(this);}});
window.require.define({"views/user/settings/sources":function(exports,require,module){(function(){var Connect,ConnectsCollection,FlashView,PageView,SourcesView,mediator,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};FlashView=require('views/base/flash');Connect=require('models/connect');ConnectsCollection=require('models/connects');mediator=require('mediator');PageView=require('views/base/page');module.exports=SourcesView=(function(_super){__extends(SourcesView,_super);function SourcesView(){return SourcesView.__super__.constructor.apply(this,arguments);}
SourcesView.prototype.template='user/settings/sources';SourcesView.prototype.autoRender=true;SourcesView.prototype.initialize=function(){var connects,_this=this;SourcesView.__super__.initialize.apply(this,arguments);this.model=mediator.user;this.model.on('change:connected_services',this.updateConnectButtons,this);this.modelBind('change',this.render);connects=new ConnectsCollection;return connects.fetch().done(function(){var services;services=connects.pluck('providerId').sort();return _this.model.set({connected_services:services.join(',')});});};SourcesView.prototype.events={'click .connect':'clickConnect','click .disconnect':'clickDisconnect'};SourcesView.prototype.updateConnectButtons=function(model){var _this=this;if(!model.get('connected_services')){return;}
return _.each((model.get('connected_services')).split(','),function(service){var $connect_btn,$disconnect_btn,capService;$connect_btn=_this.$("."+service+" .connect");capService=service.charAt(0).toUpperCase()+service.slice(1);$connect_btn.text("Connected to "+capService).addClass('btn-primary');$disconnect_btn=_this.$("."+service+" .disconnect");return $disconnect_btn.show();});};SourcesView.prototype.afterRender=function(){SourcesView.__super__.afterRender.apply(this,arguments);return this.updateConnectButtons(this.model);};SourcesView.prototype.clickConnect=function(e){var connect,service,_this=this;e.preventDefault();e.stopImmediatePropagation();if($(e.target).is(':disabled')){return;}
if($(e.target).hasClass('btn-primary')){return;}
service=$(e.target).parents('.social-connector').attr('data-service');connect=new Connect;return connect.connectService(this.model,service,function(data){if(data.status!=='error'){return;}
return _this.subview('error',new FlashView({container:'.content',flash:data.message,type:'error'}));});};SourcesView.prototype.clickDisconnect=function(e){var connect,service;e.preventDefault();e.stopImmediatePropagation();service=$(e.target).parents('.social-connector').attr('data-service');connect=new Connect;return connect.disconnectService(this.model,service);};return SourcesView;})(PageView);}).call(this);}});
window.require.define({"views/user/validate_email":function(exports,require,module){(function(){var PageView,ValidateEmailView,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key];}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};PageView=require('views/base/page');module.exports=ValidateEmailView=(function(_super){__extends(ValidateEmailView,_super);function ValidateEmailView(){return ValidateEmailView.__super__.constructor.apply(this,arguments);}
ValidateEmailView.prototype.template='user/validate_email';ValidateEmailView.prototype.className='validateEmail';ValidateEmailView.prototype.autoRender=true;ValidateEmailView.prototype.initialize=function(){ValidateEmailView.__super__.initialize.apply(this,arguments);return this.modelBind('change',_.bind(this.render,this));};return ValidateEmailView;})(PageView);}).call(this);}});
//@ sourceMappingURL=app.js.map