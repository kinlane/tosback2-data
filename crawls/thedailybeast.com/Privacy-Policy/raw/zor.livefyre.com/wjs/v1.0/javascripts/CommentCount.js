if(typeof(LF)==="undefined"){LF={}}if(typeof(LF.modules)==="undefined"){LF.modules={}}LF.modules.CommentCount=function(a){var c="LFCommentCount",d=100000,f="livefyre.com",e=/[^.\/]+\.fyre\.co|(\w+\.)?livefyre\.com/,h="/api/v1.1/public/comments/ncomments/{hash}.json",g="article_id",b="data-lf-domain";DEFAULT_ARTICLE_ID_ATTRIBUTE="data-lf-article-id",DEFAULT_SITE_ID_ATTRIBUTE="data-lf-site-id",LEGACY_CLASS_NAME="livefyre-ncomments",DEFAULT_CLASS_NAME="livefyre-commentcount",DEFAULT_RETRY_TIMEOUT=500,MAX_FETCH_ATTEMPTS=5,DEFAULT_REPLACER_REGEX=/(\d+,?\d*|none|no|zero|nada|leave a)/ig,NCOMMENTS_SCRIPT_SRC_REGEX=/(CommentCount|ncomments)\.js/,module=function(i){var k=i.articles||module.defaults.get_articles(),j=i.replacer;if(typeof(j)==="undefined"){j=module.defaults.replace_all}else{j=module.helpers.make_replacer(j)}module.fetch(k,j)};module.helpers={};module.helpers.Base64=(function(){var i={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(l){var j="";var s,q,o,r,p,n,m;var k=0;l=i._utf8_encode(l);while(k<l.length){s=l.charCodeAt(k++);q=l.charCodeAt(k++);o=l.charCodeAt(k++);r=s>>2;p=((s&3)<<4)|(q>>4);n=((q&15)<<2)|(o>>6);m=o&63;if(isNaN(q)){n=m=64}else{if(isNaN(o)){m=64}}j=j+this._keyStr.charAt(r)+this._keyStr.charAt(p)+this._keyStr.charAt(n)+this._keyStr.charAt(m)}return j},decode:function(l){var j="";var s,q,o;var r,p,n,m;var k=0;l=l.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(k<l.length){r=this._keyStr.indexOf(l.charAt(k++));p=this._keyStr.indexOf(l.charAt(k++));n=this._keyStr.indexOf(l.charAt(k++));m=this._keyStr.indexOf(l.charAt(k++));s=(r<<2)|(p>>4);q=((p&15)<<4)|(n>>2);o=((n&3)<<6)|m;j=j+String.fromCharCode(s);if(n!=64){j=j+String.fromCharCode(q)}if(m!=64){j=j+String.fromCharCode(o)}}j=i._utf8_decode(j);return j},_utf8_encode:function(k){k=k.replace(/\r\n/g,"\n");var j="";for(var m=0;m<k.length;m++){var l=k.charCodeAt(m);if(l<128){j+=String.fromCharCode(l)}else{if((l>127)&&(l<2048)){j+=String.fromCharCode((l>>6)|192);j+=String.fromCharCode((l&63)|128)}else{j+=String.fromCharCode((l>>12)|224);j+=String.fromCharCode(((l>>6)&63)|128);j+=String.fromCharCode((l&63)|128)}}}return j},_utf8_decode:function(j){var l="";var n=0;var p=0,o=0,m=0,k=0;while(n<j.length){p=j.charCodeAt(n);if(p<128){l+=String.fromCharCode(p);n++}else{if((p>191)&&(p<224)){m=j.charCodeAt(n+1);l+=String.fromCharCode(((p&31)<<6)|(m&63));n+=2}else{m=j.charCodeAt(n+1);k=j.charCodeAt(n+2);l+=String.fromCharCode(((p&15)<<12)|((m&63)<<6)|(k&63));n+=3}}}return l}};return i})();module.helpers.isArray=function(i){if(!i){return false}if(i.isArray){return i.isArray()}else{return Object.prototype.toString.call(i)==="[object Array]"}};module.helpers.isRegExp=function(i){if(!i){return false}else{return Object.prototype.toString.call(i)==="[object RegExp]"}};module.helpers.contains=function(l,k){var j=l.length;while(j--){if(l[j]===k){return true}}return false};module.helpers.hash_articles=function(l){var k=[],r,j={},p="";if(!module.helpers.isArray(l)){l=module.helpers.articles_object_to_list(l)}if(l.length==0){return null}for(var m=0,o=l.length,n,q;m<o;m++){q=l[m];n=j[q.site_id]||[];if(!module.helpers.contains(n,q.article_id)){n.push(q.article_id)}j[q.site_id]=n}for(r in j){if(j.hasOwnProperty(r)){k.push(r+":"+j[r].join(","))}}return module.helpers.Base64.encode(k.join("|"))};module.helpers.unhash_articles=function(o){var k=module.helpers.Base64.decode(o).split("|"),m=[];for(var l=0,j=k.length,n;l<j;l++){n=k[l].split(",");m.push({site_id:n[0],article_id:n[1]})}return m};module.helpers.merge_articles_objects=function(){var p=Array.prototype.slice.call(arguments),l,j,k,o,t,q={};for(var m=0,n=p.length;m<n;m++){l=p[m];for(var s in l){if(!l.hasOwnProperty(s)){continue}if(!(s in q)){q[s]={}}j=l[s];k=q[s];for(var r in j){if(!j.hasOwnProperty(r)){continue}if(!(r in k)){k[r]={}}o=j[r];k[r]=module.helpers.merge_simple_objects(k[r],o)}}}return q};module.helpers.articles_list_to_object=function(k){var m={},p,q,j,r,l=null;for(var n=0,o=k.length;n<o;n++){p=k[n];q=p.site_id;r=p.article_id;l=null;if(!(q in m)){m[q]={}}j=m[q];m[q][r]=module.helpers.merge_simple_objects(j[r]||{},module.helpers.remove_ids_from_article_object(p))}return m};module.helpers.articles_object_to_list=function(n){var m=[],l,p,i,o;for(var k in n){if(n.hasOwnProperty(k)){l=n[k];for(var j in l){if(l.hasOwnProperty(j)){o=l[j];i=module.helpers.merge_simple_objects({article_id:j,site_id:k},o);m.push(i)}}}}return m};module.helpers.jsonp=function(m,l,o){if(typeof(l)==="undefined"){l={}}var n;n=c+Math.floor(Math.random()*d);window[n]=o;l.callback=n;if(m.indexOf("?")<1){m=m+"?"}for(var j in l){if(l.hasOwnProperty(j)){m=m+"&"+escape(j)+"="+escape(l[j])}}var i=document.getElementsByTagName("head")[0];var k=document.createElement("script");k.type="text/javascript";k.src=m;i.appendChild(k)};module.helpers.on_window_load=function(j){var i=j;if(module.loaded===true){j.call(window)}else{j=function(){i.call(window);module.loaded=true}}if(window.addEventListener){window.addEventListener("load",j,false)}else{if(window.attachEvent){window.attachEvent("onload",j)}}};module.helpers.get_script_element=function(){var k=document.getElementsByTagName("script"),l,n;for(var m=0,j=k.length;m<j;m++){l=k[m];n=l.src;if(n&&n.match(NCOMMENTS_SCRIPT_SRC_REGEX)){return l}}};module.helpers.get_domain=function(){var i=module.helpers.get_script_element();if(!i){return}var l=i.getAttribute(b);if(l){return l}var k=i.src,j=k.match(e);if(!j){return}j=j[0];if(j.match(/zor\.livefyre\.com|zor\.fyre\.co/)){return}return j};module.helpers.memoize=function(i){var k="first-time",j;j=function(){if(k!=="first-time"){return k}k=i.apply(this,arguments);return k};return j};module.helpers.getElementsByClassName=function(k,j,l){var i;if(document.getElementsByClassName){i=function(r,u,q){q=q||document;var m=q.getElementsByClassName(r),t=(u)?new RegExp("\\b"+u+"\\b","i"):null,n=[],p;for(var o=0,s=m.length;o<s;o+=1){p=m[o];if(!t||t.test(p.nodeName)){n.push(p)}}return n}}else{if(document.evaluate){i=function(v,y,u){y=y||"*";u=u||document;var o=v.split(" "),w="",s="http://www.w3.org/1999/xhtml",x=(document.documentElement.namespaceURI===s)?s:null,p=[],m,n;for(var q=0,r=o.length;q<r;q+=1){w+="[contains(concat(' ', @class, ' '), ' "+o[q]+" ')]"}try{m=document.evaluate(".//"+y+w,u,x,0,null)}catch(t){m=document.evaluate(".//"+y+w,u,null,0,null)}while((n=m.iterateNext())){p.push(n)}return p}}else{i=function(y,B,x){B=B||"*";x=x||document;var r=y.split(" "),A=[],n=(B==="*"&&x.all)?x.all:x.getElementsByTagName(B),w,t=[],v;for(var s=0,o=r.length;s<o;s+=1){A.push(new RegExp("(^|\\s)"+r[s]+"(\\s|$)"))}for(var q=0,z=n.length;q<z;q+=1){w=n[q];v=false;for(var p=0,u=A.length;p<u;p+=1){v=A[p].test(w.className);if(!v){break}}if(v){t.push(w)}}return t}}}return i(k,j,l)};module.helpers.replace_innerHTML=function(j,k,i){j.innerHTML=j.innerHTML.replace(k,i)};module.helpers.make_replacer=function(k){var i=k;if(module.helpers.isRegExp(k)){i=function(m,l){module.helpers.replace_innerHTML(m,k,l)}}var j;j=function(m){var l,r,p,q;for(var s in m){if(!m.hasOwnProperty(s)){continue}l=m[s];for(var t in l){if(!l.hasOwnProperty(t)){continue}r=l[t];p=r.elements;q=r.total||0;for(var n=0,o=p.length;n<o;n++){i(p[n],q)}}}};return j};module.helpers.remove_ids_from_article_object=function(j){var k={};for(var i in j){if(!j.hasOwnProperty(i)){continue}if(i!=="site_id"&&i!=="article_id"){k[i]=j[i]}}return k};module.helpers.merge_simple_objects=function(m,l){var k={},j;for(var i in m){if(m.hasOwnProperty(i)){k[i]=m[i]}}for(var i in l){if(!l.hasOwnProperty(i)){continue}if(module.helpers.isArray(l[i])&&module.helpers.isArray(k[i])){k[i]=k[i].concat(l[i])}else{k[i]=l[i]}}return k};module.helpers.ensure_correct_articles_object=function(l){for(var j in l){if(!l.hasOwnProperty(j)){continue}var k=l[j];for(var i in k){if(!k.hasOwnProperty(i)){continue}if(!(typeof(k[i])==="object")){k[i]={count:k[i]}}}}return l};module.defaults={};module.defaults.find_elements=function(j){var i=module.helpers.getElementsByClassName(j||DEFAULT_CLASS_NAME);return i};module.defaults.get_article_id=function(i){return i.getAttribute(DEFAULT_ARTICLE_ID_ATTRIBUTE)};module.defaults.get_article_id_legacy=function(i){return i.getAttribute(g)};module.defaults.get_site_id_from_script_src=module.helpers.memoize(function(j){var i=module.helpers.get_script_element();if(typeof(i)==="undefined"){return null}var k=i.src.match("#bn=([^\\&]*)");if(k&&k.length>=2){return k[1]}return null});module.defaults.get_site_id_from_attribute=function(i){return i.getAttribute(DEFAULT_SITE_ID_ATTRIBUTE)};module.defaults.get_articles=function(){var q=module.defaults.find_elements(),o,p={},l,m,k;for(var n=0,j=q.length;n<j;n++){o=q[n];l=module.defaults.get_site_id_from_attribute(o)||module.defaults.get_site_id_from_script_src(o);if(!(l in p)){p[l]={}}m=p[l];k=module.defaults.get_article_id(o);if(!(k in m)){m[k]={elements:[]}}m[k].elements.push(o)}return p};module.defaults.get_articles_legacy=function(){var q=module.defaults.find_elements(LEGACY_CLASS_NAME),o,p={},l,m,k;for(var n=0,j=q.length;n<j;n++){o=q[n];l=module.defaults.get_site_id_from_script_src(o);if(!(l in p)){p[l]={}}m=p[l];k=module.defaults.get_article_id_legacy(o);if(!(k in m)){m[k]={elements:[]}}m[k].elements.push(o)}return p};module.defaults.replace_all=module.helpers.make_replacer(DEFAULT_REPLACER_REGEX);module.fetch=function(m,k,o){var l=Array.prototype.slice.call(arguments),j=0;module.loaded=true;if(l.length===1){k=l[0];m=module.defaults.get_articles()}if(typeof(m)==="function"){m=m()}if(!module.helpers.isArray(m)){m=module.helpers.articles_object_to_list(m)}var p="http://bootstrap.{domain}{path}",n=module.helpers.hash_articles(m);if(n==null){if(typeof(o)==="function"){o()}return}p=p.replace("{domain}",module.helpers.get_domain()||f).replace("{path}",h).replace("{hash}",n);var i=function(r){j=j+1;if(r.status==="ok"){var q=module.helpers.articles_list_to_object(m),r=module.helpers.ensure_correct_articles_object(r.data),s=module.helpers.merge_articles_objects(r,q);k.call(null,s)}else{if(r.code==503&&j<MAX_FETCH_ATTEMPTS){setTimeout(function(){module.helpers.jsonp(p,{},i)},(r.data.wait||DEFAULT_RETRY_TIMEOUT))}}};module.helpers.jsonp(p,{},i)};module.auto_legacy=function(){module.fetch(module.defaults.get_articles_legacy(),module.defaults.replace_all)};module.auto=function(){module.fetch(module.defaults.get_articles(),module.defaults.replace_all)};module.helpers.on_window_load(function(){if(module.loaded){return}var i=module.defaults.get_site_id_from_script_src();if(i){module.auto_legacy()}else{module.auto()}});module.loaded=false;module.run=function(){if(!module.loaded){module.auto()}};a.CommentCount=module};LF.modules.CommentCount(LF);
