/*!
#Tue Feb 19 11:03:17 MST 2013
build.num.last=77954
*/
(function(){var e={name:"App",maxInstances:1,consts:{EVENTS:{RESIZE:"resize"},COOKIES:{START_TIME:"sessionStartTime"}},prototype:{dimmerDuration:0,_init:function(){Dtv.app=this;try{document.execCommand("BackgroundImageCache",false,true)}catch(a){$log("BackgroundImageCache failed: "+a)}this._invokeInitMethod("_initHeader",false);this._invokeInitMethod("_initFooter",false);this._invokeInitMethod("_initPromo",false);this._invokeInitMethod("processHtmlSlugs",false);
this._invokeInitMethod("_initDefaultBehaviors",true);this._invokeInitMethod("_initReferralForm",false);this._invokeInitMethod("_initSessionTimeout",true);this._invokeInitMethod("_initEportal",true)},_initFooter:function(){var d=$("dtv_footer_tup");var c=0;var a=0;var b=30;if($("utility_bar")==undefined){b=0}if(d.getStyle("display")!="none"){a=6;d.style.paddingBottom=b+"px";c=d.getHeight();d.style.minHeight=c+"px"}},_initReferralForm:function(){if(document.location.href.toLowerCase().indexOf("/referral/")!=-1){var b=$("dtv_tup").down("form.js-referrer-form");
if(b){var a=new Dtv.FormController(b,{onSubmitSuccess:function(c,d){if(d.lightboxUrl){Dtv.app.ajaxLightbox.show(d.lightboxUrl)}else{if(d.redirectUrl){document.location.href=d.redirectUrl}}},onSubmitFailure:function(c,d){Dtv.Behaviors.AjaxLightbox.instances.invoke("hide")}});a._messagesEl=$("referral_error")}}},processHtmlSlugs:function(c){if(!this._htmlSlugRequests){this._htmlSlugRequests={}}var a=this._htmlSlugRequests;function b(d,l,m){var n=m.responseEl.select("#"+l);if(n.length>0){d.update(n[0].innerHTML);
d.removeClassName("js-html-slug").addClassName("js-html-slug-processed")}}(c||$(document.body)).select(".js-html-slug").each(function(k){var l=k.getVar("slug");if(!l){return}var d=a[l.url];if(d){if(d.responseEl){b(k,l.id,d)}else{d.queue.push({legalEl:k,config:l})}}else{d={queue:[{legalEl:k,config:l}]};a[l.url]=d;new Ajax.Request(l.url,{method:"get",onSuccess:function(j){var i=j.responseText;d.responseEl=new Element("div").update(i);d.queue.each(function(n){b(n.legalEl,n.config.id,d)});d.queue=[]}})
}})},_initDefaultBehaviors:function(){this.debug("initializing default app behaviors...");this.lazyLoader=this.el.behavior("App.LazyLoader");this.rollovers=this.el.behavior("GenericRollover");this.ajaxLightbox=($("ajaxLightboxDiv")||new Element("div",{id:"ajaxLightboxDiv"})).behavior("AjaxLightbox",{});this.infoPop=($("content_business_infopop")||new Element("div",{id:"content_business_infopop"})).behavior("BusinessInfoPop");var b=$("message_container");if(b){this.messages=b.behavior("MessageContainer")
}var c=$("global_type_ahead");if(c){this.typeAhead=c.behavior("GlobalTypeAheadBox")}var a=$("utility_bar");if(a){this.utilityBar=a.behavior("UtilityBar");if(!Prototype.BrowserFeatures.FixedPositioning){a.setStyle({position:"absolute"})}}this.el.behavior("ChangeEpZipCodePopup");this.debug("finished initializating default app behaviors")},_initHeader:function(){var a=$("ctl_header");var b=$("ctl_header_content");if(a&&b){b.setStyle({bottom:"auto"});if(b.getHeight()>a.getHeight()){a.addClassName("size-by-content")
}b.setStyle({bottom:""})}},_initPromo:function(){var a="customer";var j=""+document.cookie;var d=j.indexOf(a);if(d==-1||a==""){var c=$("prospect-promo");if(c!=null){c.toggle()}}else{var b=$("customer-promo");if(b!=null){b.toggle()}}},_initSessionTimeout:function(p){var m=this.el.getVar("sessionTimeoutSettings");if(m){var a,b=this;function n(){return m.timeoutInterval-(m.timeoutWarningInterval||0)}function c(){return b._timeoutLightbox&&b._timeoutLightbox.visible()}function o(){var i=Dtv.Cookie.get(Dtv.Behaviors.App.COOKIES.START_TIME),j=new Date().getTime();
var k=(j-i)/1000;if(k>=m.timeoutInterval){b.timeoutSession();return}if(k>=n()){if(!c()){b.showTimeoutWarning()}}else{if(c()){b._timeoutLightbox.hide()}}clearTimeout(a);a=o.delay(m.timeoutInterval-k)}function d(){Dtv.Cookie.set(Dtv.Behaviors.App.COOKIES.START_TIME,new Date().getTime(),1);window.clearTimeout(a);a=o.delay(n())}Ajax.Responders.register({onCreate:function(i){if(i&&i.url&&!i.url.endsWith("lightboxTimeout.jsp")){d()}}});d()}else{Dtv.Cookie.set(Dtv.Behaviors.App.COOKIES.START_TIME,new Date().getTime(),1)
}if(m&&p){d()}},_initEportal:function(){if(!this.ajaxLightbox.visible()){var b=$("welcome_lightbox");if(b){var a=b.behavior("Lightbox");a.show.bind(a).defer();scroll(0,0)}}},_initEvents:function(){this.onDom(this.el,"click",{".messageHeroContainer a:not(.js-heroNext , .js-heroPrevious)":this._handleAddingLvarUrls.curry("heroMessage"),".ep-cq-nav a.section-tab":this._handleAddingLvarUrls.curry("pagetab"),".js-App-showLightbox":this._handleShowLightboxClick,".js-App-refreshSession":this.refreshSession,"#glt_link:not(.disabled)":this._handleGlobalLanguageToggle,"#dtv_topnav_tup a":this._handleAddingLvarUrls.curry("header"),"a.omniHeaderSubNavLink":this._handleAddingLvarUrls.curry("Header:3"),"div.dtv-subnav-promo a":this._handleAddingLvarUrls.curry("Header:2"),"a.omniHeaderNavLink":this._handleAddingLvarUrls.curry("Header:1"),"a.omniFooterNavLink":this._handleAddingLvarUrls.curry("Footer:1"),"a.omniFooterSubNavLink":this._handleAddingLvarUrls.curry("Footer:2"),"#dtv_topnav_prenav a":this._handleAddingLvarUrls.curry("header"),"div.ep-search-results ul li.ep-search-item a:not(.js-ProgramPlaylistLink-toggleFav)":this._handleAddingLvarUrls.curry("ep_search_item"),".filters-avail a":this._handleAddingLvarUrls.curry("leftnav"),".ep-infobox a.rep-cta-info-button":this._handleAddingLvarUrls.curry("")},this);
var a;var b=this._handleResize.bind(this);this.onDom(window,{resize:function(c){if(a){window.clearTimeout(a)}a=window.setTimeout(b,100)}});Event.on(document,Dtv.Event.BEHAVIORS_LOADED,this._handleBehaviorsLoaded.bind(this))},_invokeAutoClick:function(a){a.split("|").each(function(b){var c=$(b)||$$(".js-autoclick-"+b).first();if(c&&(!c.hasClassName("js-autoclick-ignore-active")||!c.hasClassName("active"))){c.simulate("click");throw $break}})},_handleGlobalLanguageToggle:function(a,b){if(window.mboxUpdate){mboxUpdate("languageSwap")
}setTimeout(function(){location=b.href},100)},_handleBehaviorsLoaded:function(b){var a=window.location.href.toQueryParams();if(a.autoClick){if(Object.isArray(a.autoClick)){a.autoClick.each(this._invokeAutoClick.bind(this))}else{this._invokeAutoClick(a.autoClick)}}},_handleResize:function(a){this.updateDisabledScreenLayout();this.fireEvent(this.EVENTS.RESIZE,{windowEvent:a})},_handleShowLightboxClick:function(a,b){var c=b.getVar("lightboxUrl");if(!c){throw new RangeError("clicked element does not have a lightboxUrl var")
}this.ajaxLightbox.show(c);a.preventDefault()},reloadWithoutAutoClick:function(){window.location.reloadWithParams({},function(a){delete a.autoClick})},_handleAddingLvarUrls:function(s,r,u){var w=u.readAttribute("href");if(w!=null&&((w.indexOf("support.directv.com")<0)&&(w.indexOf("forums.directv.com")<0))){if(w.indexOf("?")>=0){w=w.trim()+"&lpos="+s}else{w=w.trim()+"?lpos="+s}if(w.indexOf("/entertainment/browse")>=0){var c=w.match(/.*\/entertainment\/(browse\/)?([^/?\s]+)\/.*/);if(!!c&&c.length>=3){var v=c[2].toUpperCase();
var b=w.toQueryParams();var q=b.maincategory;var t=b.subcategory;var a="";if(!!q){a=q+":"}if(!!!t){t="View All"}a+=t;var d=v.toLowerCase();if((s=="leftnav")&&(d=="on_demand")){w+="&lid=On Demand:"+a}else{if((s=="leftnav")&&(d=="watch_online")){w+="&lid=Watch Instantly:"+a}else{w+="&lid="+v.toLowerCase().capitalize()+":"+a}}if(s=="leftnav"&&!(d=="movies"||d=="on_demand"||d=="watch_online"||d=="guide"||d=="tv"||d=="events"||d=="adult")){w+="&ltovrd=true"}}}else{if(u.hasClassName("rep-browse-left-nav")){var c=w.match(/.*\/entertainment\/([^\/?]+)\/?.*/);
if(!!c){var v=c[1].toUpperCase();var d=v.toLowerCase();if((s=="leftnav")&&(d=="on_demand")){w+="&lid=On Demand"}else{if((s=="leftnav")&&(d=="watch_online")){w+="&lid=Watch Instantly"}else{w+="&lid="+v.toLowerCase().capitalize()}}}}else{if(s=="ep_search_item"){Reporting.UserActionManager.reportSearchFiltersSummary(true)}}}if(s=="heroMessage"){w+="&lid=browseLink&ltovrd=true"}}u.href=w},getLoginInfo:function(){if(!this._loginInfo){this._loginInfo=this.el.getVar("loginInfo");this._loginInfo.isLoggedIn=function(){return this.autoLoggedIn||this.securedCustomer
}}return this._loginInfo},updateDisabledScreenLayout:function(){if(this.screenDisabled){this.disableScreen()}},disableScreen:function(a){if(Prototype.X.Browser.IE==6&&!this.iframeShim){this.iframeShim=new Element("iframe",{src:'javascript:"";',frameBorder:0}).setStyle({left:0,top:0,position:"absolute",zIndex:1000,width:"100%",opacity:0}).setOpacity(0);this.iframeShim.style.height=Dtv.Util.calcPageHeight()+"px";this.iframeShim.appendTo(document.body)}if(this.iframeShim){this.iframeShim.show()}if(!this._dimmerEl){this._dimmerEl=new Element("div",{id:"lb-dimmer"}).appendTo(document.body)
}if(!this.screenDisabled){if(this._dimmerFx){this._dimmerFx.cancel()}this._dimmerFx=new Effect.Appear(this._dimmerEl,{from:0,to:0.8,duration:a||this.dimmerDuration});this.screenDisabled=true;Dtv.Event.fire(Dtv.Event.SCREEN_DISABLED)}},enableScreen:function(a){if(this.iframeShim){this.iframeShim.hide()}if(this._dimmerEl){if(this._dimmerFx){this._dimmerFx.cancel()}this._dimmerFx=new Effect.Fade(this._dimmerEl,{duration:a||this.dimmerDuration})}this.screenDisabled=false;Dtv.Event.fire(Dtv.Event.SCREEN_ENABLED)
},showThinking:function(a,k){if(!this._thinkingEl){this._thinkingEl=$el('<div class="ajax-thinking"><img alt="Thinking" src="/images/global/ajax/loading_large.gif"/><h4></h4></div>').appendTo(document.body).hide()}var l=this._thinkingEl.down("h4");if(a&&a!=""){l.update(a).show()}else{l.hide()}var c=document.viewport.getDimensions();var d=document.viewport.getScrollOffsets();var b=Element.getLayout(this._thinkingEl);this._thinkingEl.setStyle({left:((c.width-b.get("padding-box-width"))/2)+"px",top:(((c.height-b.get("padding-box-height"))/2)+d.top)+"px",opacity:0});
this._thinkingEl._fx=new Effect.Appear(this._thinkingEl,{duration:0.2,delay:k||0,to:0.8})},hideThinking:function(){if(this._thinkingEl._fx){this._thinkingEl._fx.cancel()}this._thinkingEl.hide()},waitButton:function(a){a=$(a);a.disable();a.addClassName("btn-spinner");a.classNames().each(function(b){switch(b){case"btn-sm-act":case"btn-sm-actaltdk":case"btn-sm-actalt":case"btn-sm-em":case"btn-sm-std":case"btn-sm-stdact":a.addClassName("btn-sm-ajax");break;case"btn-mid-act":case"btn-mid-actalt":case"btn-mid-actaltdk":case"btn-mid-em":case"btn-mid-std":case"btn-mid-stdact":a.addClassName("btn-mid-ajax");
break}});if(!this._waitingButtons){this._waitingButtons=[]}this._waitingButtons.punch(a)},unwaitButton:function(a){a=$(a);a.enable();a.removeClassName("btn-spinner");a.removeClassName("btn-sm-ajax").removeClassName("btn-mid-ajax");if(this._waitingButtons){this._waitingButtons.erase(a)}},unwaitButtons:function(a){(a||this._waitingButtons||[]).each(this.unwaitButton)},showLoginLightbox:function(a,d){var c="/DTVAPP/global/lightbox/lightboxLogin.jsp";var b=this;if(d){c+="?pgws=true"}Dtv.app.ajaxLightbox.show(c,{onInitContent:function(){new Infopop(".dtv-infopop")
},form:{options:{onSubmitSuccess:function(k,l){Dtv.app.getLoginInfo().securedCustomer=true;if(d&&!!l.pgwsAuthFailed){window.location.href=l.redirectUrl}else{if(!!l.showModifyEmailLightbox){b.showModifyEmailLightbox.bind(b,a).defer()}else{if(a){a.defer()}}}}}}})},showModifyEmailLightbox:function(a){Dtv.app.ajaxLightbox.show("/DTVAPP/global/lightbox/lightboxModifyEmailSynch.jsp",{form:{hideOnSuccess:true,options:{onSubmitSuccess:function(b,c){if(a){a.defer()}else{window.location.reload()}}}}})},showTermsAndConditionsLightbox:function(b,a){Dtv.app.ajaxLightbox.show("/DTVAPP/global/lightbox/lightboxTermsAndConditions.jsp",{hideOnSuccess:false,onInitContent:function(){if(b){$("toc_inner").update($(b).innerHTML)
}if(!a){a="Terms &amp; Conditions"}Dtv.app.ajaxLightbox.el.down(".lb-header").update("<span>"+a+"</span>")}})},showZipCodeLightbox:function(b,j,d){var a=this.ajaxLightbox;var c=false;if(!j){j=function(i){a.hide();location.replace(location.href)}}a.show("/DTVAPP/global/lightbox/lightboxZipCode.jsp?pepodMode="+b,{actions:{hide:function(){a.hide();if(b&&c){document.location.reload()}}},form:{hideOnSuccess:false,options:{onSubmitSuccess:function(i,l){if(j){j(l)}},onSubmitFailure:function(i,o){var q=$("zipCode");
c=false;if(o.countyCodes!=null){c=true;q.readOnly=true;$("countyDiv").show();var r=$("countySelect");r.options.length=0;r.options[0]=new Option("County","");for(var p=0;p<o.countyCodes.length;p++){r.options[p+1]=new Option(o.countyNames[p],o.countyCodes[p])}}}}},onHide:d})},timeoutSession:function(a){if(this._sessionKeepAliveCount&&!a){this._sessionKeepAliveCount--;this.refreshSession();return}else{if(this.timeoutDisabled){return}}var b=this.el.getVar("sessionTimeoutSettings");if(b){try{window.location=window.location.protocol+"//"+window.location.host+b.redirectUrl+"?reason=timeout&lastVisited="+window.location.pathname+window.location.search
}catch(c){Dtv.app.debug(c,"Failed to execute session timeout")}}},refreshSession:function(){new Ajax.Request("/DTVAPP/global/touch.jsp",{method:"get"});if(this._timeoutLightbox){this._timeoutLightbox.hide()}},keepSessionAlive:function(a){this._sessionKeepAliveCount=a||20},showTimeoutWarning:function(a){if(this._sessionKeepAliveCount&&!a){return}if(this.timeoutDisabled){return}if(!this._timeoutLightbox){this._timeoutLightbox=new Element("div",{id:"timeoutLightbox"}).appendTo(document.body).behavior("AjaxLightbox",{zIndex:1010})
}this._timeoutLightbox.show("/DTVAPP/global/lightbox/lightboxTimeout.jsp",{useCaching:true})}}};var f={name:"App.LazyLoader",maxInstances:1,consts:{EVENTS:{BEHAVIOR_LOADED:"behaviorloaded"}},prototype:{_init:function(){this._viewportWatchers=[]},_initEvents:function(){var a=this._checkAll.bind(this);this.onDom(window,"scroll",a);Dtv.app.on("resize",a)},addViewportWatcher:function(a){if(!a){throw new RangeError("watcher cannot be null")}if(!a.el){throw new RangeError("watcher must have an el value")
}a=$extend({threshold:50},a||{});a.stop=function(){this._viewportWatchers.erase(a)}.bind(this);this._viewportWatchers.push(a);this._checkViewportWatcher(a);return a},addLazyBehavior:function(b,a,c,d){var j=Element.getBehavior(b,a);if(j){return j}d=$extend({threshold:75},d||{});watcher={el:b,behavior:a,behaviorOptions:c,onViewEnter:this._loadBehavior.bind(this),lazyLoadOptions:d,threshold:d.threshold};this.addViewportWatcher(watcher);return watcher.lastResult||null},_checkAll:function(){var a=function(c,b){c.defer(b)
}.bind(this);this._viewportWatchers.each(a.curry(this._checkViewportWatcher.bind(this)))},_checkViewportWatcher:function(b){var a=this._isElementWithinRange(b.el,b.threshold);if(!b._inRange&&a){if(b.onViewEnter){b.lastResult=b.onViewEnter(b)}}else{if(b._inRange&&!a){if(b.onViewExit){b.lastResult=b.onViewExit(b)}}}b._inRange=a},_loadBehavior:function(a){var b=Element.getBehavior(a.el,a.behavior);if(!b){b=Element.behavior(a.el,a.behavior,a.behaviorOptions);this.debug(b.behaviorName,"Behavior lazy loaded","info");
if(a.lazyLoadOptions.callback){a.lazyLoadOptions.callback(b)}}a.stop();this.fireEvent(this.EVENTS.BEHAVIOR_LOADED,{behavior:b,watcher:a});Dtv.app.updateDisabledScreenLayout();return b},_isElementWithinRange:function(c,n){var b=document.viewport.getHeight();var d=document.viewport.getScrollOffsets().top;var l=b+d+(n||0);var a=$(c).cumulativeOffset().top;if(a<=l){var m=c.getHeight();if(m>0){if(a+m<d-(n||0)){return false}}return true}return false}}};var g={name:"LazyAjaxContent",options:{appearDuration:0.5,disposeOnSuccess:true},prototype:{_init:function(){var a=this.el.getVar("ajaxUrl");
this.ajaxPanel=this._getAjaxPanelEl().behavior("AjaxPanel",{overlay:false});this.ajaxPanel.load(a,{onSuccess:this._handleSuccess.bind(this)})},_getAjaxPanelEl:function(){return this.el},_initLazyContent:function(){},_handleSuccess:function(){if(!this.isDisposed){this._initLazyContent();Dtv.app.updateDisabledScreenLayout();this.ajaxPanel.el.hide();this.ajaxPanel.el.appear({duration:this.options.appearDuration});if(this.options.disposeOnSuccess){this.dispose()}}}}};var h={name:"ChangeEpZipCodePopup",prototype:{_init:function($super){},_initEvents:function($super){this.onDom(this.el,"click",{"a.js-EP-changeEpZipCode":this._handleChangeZipCodeClick,"#zip_warning_close":this.hideZipCodeWarning},this);
var a=$("guide_settings_menu");if(!!a){this.onDom(a,"click",{"a.js-EP-changeEpZipCode":this._handleChangeZipCodeClick},this)}},_handleChangeZipCodeClick:function(a){Dtv.app.ajaxLightbox.show("/entertainment/lightbox/lightboxZipCode.jsp",{form:{options:{onSubmitSuccess:this._handleZipCodeSubmitSuccess.bind(this),onSubmitFailure:this._handleZipCodeSubmitFailure.bind(this)}}})},_handleZipCodeSubmitSuccess:function(a,c){var d=window.location.href;if(/[&?]taId=[^&]+/.test(d)){var j=d.split("?")[0];var b=d.toQueryParams();
b.taId="";b.taTopMatch="";b.taType="";window.location.href=j+"?"+$H(b).toQueryString()}else{window.location.reload()}},_handleZipCodeSubmitFailure:function(b,c){if(c&&c.countyNames){$("zipCode").readOnly=true;$("countyDiv").show();var a=$("countySelect");a.options.length=0;a.options[0]=new Option("County","");for(var d=0;d<c.countyNames.length;d++){a.options[d+1]=new Option(c.countyNames[d],c.zipCodes[d])}}},hideZipCodeWarning:function(){var a=$("guide_zip_warning");if(a){a.fade()}}}};Dtv.Behaviors.create(e,f,g,h);
Element.addMethods({lazyBehavior:function(b,a,c,d){return Dtv.app.lazyLoader.addLazyBehavior(b,a,c,d)}})})();(function(){var l={name:"AbstractField",options:{hasErrorClassName:"has-error",hasFocusClassName:"has-focus",hasValueClassName:"has-value",isDefaultClassName:"default-text",disabledClassName:"disabled",changeEventName:"change"},prototype:{_init:function(){this.el.fieldBehavior=this;this.el._getValue=this.el.getValue;this.el.getValue=this.getValue.bind(this);this.initialValue=this.getValue()
},_initEvents:function(){this.onDom(this.el,"blur",this._handleBlur,this);this.onDom(this.el,"focus",this._handleFocus,this);this.options.changeEventName.split(",").each(function(a){this.onDom(this.el,a,this._handleChange,this)}.bind(this))},_initDefaultState:function(){this._updateHasValueClass()},dispose:function($super){if(this.el){this.el.fieldBehavior=null;this.el.getValue=this.el.getValue}$super()},_handleBlur:function(a){this.el.removeClassName(this.options.hasFocusClassName)},_handleFocus:function(a){this.el.addClassName(this.options.hasFocusClassName)
},_handleChange:function(a){this._updateHasValueClass();var b=this.getValue();if(!$defined(this._currentValue)||this._currentValue!=b){var c=this._currentValue;this._currentValue=b;this.fireEvent("change",{field:this,oldValue:c,newValue:b})}},_updateHasValueClass:function(){if(!this.hasValue()){this.el.removeClassName(this.options.hasValueClassName)}else{this.el.addClassName(this.options.hasValueClassName)}},isDirty:function(){return this.initialValue!=this.getValue()&&!this.el.disabled},isAtgField:function(a){return this.el.name.endsWith(a)
},getValue:function(){return this.el._getValue()},setValue:function(a){this.el.value=a;this._handleChange()},hasValue:function(){var a=this.getValue();return a!=null&&a!=""},getController:function(){return(this.el.form||this.el.up("form")).getController()},enable:function(){this.el.disabled=false;this.el.removeClassName(this.options.disabledClassName)},disable:function(){this.el.disabled=true;this.el.addClassName(this.options.disabledClassName)},clear:function(){this.setValue("")},reset:function(){this.setValue(this.initialValue)
},showError:function(a){this.el.addClassName(this.options.hasErrorClassName);this.el.title=a;var b=this.getLabelEl();if(b){b.addClassName(this.options.hasErrorClassName);b.title=a}},getLabelEl:function(){var a=this.el.up("form");var b;if(this.el.id){b=a.down("label[for='"+this.el.id+"']")}if(!b&&this.el.name){b=a.down("label[for='"+this.el.name+"']")}return b}}};var m={name:"SelectField",inherits:"AbstractField"};var h={name:"TextField",inherits:"AbstractField",options:{displayText:null},prototype:{_initDefaultState:function($super){this._handleBlur();
$super()},_handleBlur:function($super,a){$super(a);this.showDisplayText()},_handleFocus:function($super,a){$super(a);this.hideDisplayText()},getDisplayText:function(){return this.options.displayText||this.el.alt},setDisplayText:function(a){this.options.displayText=a;this.showDisplayText()},hasFocus:function(){return this.el.hasClassName(this.options.hasFocusClassName)},getValue:function(){if(this.el.value==this.getDisplayText()){return""}return this.el.value},showDisplayText:function(){var a=this.getDisplayText();
if(a&&((this.el.value==""&&!this.hasFocus())||this.el.value==a)){this.el.value=a;this.el.addClassName(this.options.isDefaultClassName);return true}return false},hideDisplayText:function(){if(this.el.value==this.getDisplayText()){this.el.value="";this.el.removeClassName(this.options.isDefaultClassName);return true}return false}}};var n={name:"PasswordField",inherits:"TextField",prototype:{_init:function($super){$super();this.fakeEl=$el("<input type='text' class='"+this.el.className+"' value='"+this.getDisplayText()+"'></input>").hide().after(this.el);
this.onDom(this.fakeEl,"focus",this._handleFakeFocus.bind(this))},showDisplayText:function($super){if($super()){this.fakeEl.show();this.el.hide();this.fakeEl.addClassName(this.options.isDefaultClassName);return true}return false},hideDisplayText:function($super){this.fakeEl.hide();this.el.show();return $super()},showError:function($super,a){$super(a);this.fakeEl.addClassName(this.options.hasErrorClassName);this.fakeEl.title=this.el.title},_handleFakeFocus:function(){this.hideDisplayText();this.el.activate()
}}};var i={name:"CheckboxField",inherits:"AbstractField",options:{changeEventName:"click",hasFocusClassName:""},prototype:{_init:function($super){$super();this.initialChecked=this.getChecked()},getChecked:function(){return this.el.checked},setChecked:function(a){if(this.el.checked!=a){this.el.checked=a;this._handleChange()}},isDirty:function(){return this.initialChecked!=this.getChecked()&&!this.el.disabled},clear:function(){this.setChecked(false)},reset:function(){this.setChecked(this.initialChecked)
}}};var j={name:"RadioField",inherits:"CheckboxField",options:{changeEventName:"change,click"},prototype:{_handleChange:function($super,a){delete this._currentValue;$super()},getGroup:function(){var a=this.el.name;var c=this.getController();if(!c){return null}var b=c.fields.select(function(d){return d.el.name==a});return{name:a,fields:b,initialCheckedField:b.find(function(d){return d.initialChecked}),checkedField:b.find(function(d){return d.getChecked()})}}}};var k={name:"FormPanel",options:{},prototype:{_init:function(){this.formControllers=[];
if(this.options.form||this.options.forms){var a=this._initFormController.bind(this);this.el.select("form").each(a)}},_initFormController:function(c){var a=this._getFormControllerConfig(c);if(a){var b=new Dtv.FormController(c,a.options);this.addFormController(b,a);if(a.onInit){a.onInit.call(this,b)}return b}return null},_handleSubmitResponse:function(a,b){b.memo.formConfig=a;this.fireEvent("submitresponse",b.memo)},_handleSubmitSuccess:function(a,b){b.memo.formConfig=a;this.fireEvent("submitsuccess",b.memo)
},_handleSubmitFailure:function(a,b){b.memo.formConfig=a;this.fireEvent("submitfailure",b.memo)},addFormController:function(b,a){b.on(b.EVENTS.SUBMIT_RESPONSE,this._handleSubmitResponse.bind(this,a));b.on(b.EVENTS.SUBMIT_SUCCESS,this._handleSubmitSuccess.bind(this,a));b.on(b.EVENTS.SUBMIT_FAILURE,this._handleSubmitFailure.bind(this,a));b.findMessageContainer(this.options.messageEl?$(this.options.messageEl):this.el);this.formControllers.push(b);this.addDisposableObj(b)},_getFormControllerConfig:function(c){var a=this.options.form;
if(this.options.forms){for(var b in this.options.forms){if(c.matchAny(b)){a=$extend({},a||{},this.options.forms[b]);break}}}return a}}};Dtv.Behaviors.create(l,m,h,n,i,j,k)})();(function(){var d={name:"Popup",consts:{EVENTS:{HIDE:"hide",SHOW:"show"}},options:{groupName:"default",showFxType:Effect.Appear,showFxOptions:{},hideFxType:Effect.Fade,hideFxOptions:{},hideOnOutsideClick:true,hideOnAnchorClick:false,hideOnMouseLeave:false,stickyDuration:0},statics:{_groups:$H(),hide:function(a,b){var f=this.getVisible(a);
if(f){f.hide(b)}},hideAll:function(a){this._groups.each(function(b){var f=b[1];if(f&&f.visiblePopup){f.visiblePopup.hide(a)}})},getGroup:function(a){var b=this._groups.get(a);if(!b){b=this._groups.set(a,{})}return b},getVisible:function(a){return this.getGroup(a).visiblePopup},_setVisible:function(a,f){var b=this.getGroup(a);if(b.visiblePopup!==f){if(f!=null&&b.visiblePopup){b.visiblePopup.hide()}b.visiblePopup=f}}},prototype:{_initEvents:function(){this.onDom(document.body,{mouseover:this._handleBodyMouseOver,click:this._handleBodyClick},this);
if(this.options.hideOnMouseLeave){Dtv.app.on("resize",this.hide.bind(this).ignoreEvent())}if(Prototype.Browser.MobileWebKit){this.onDom(this.el,"touchstart","a",this._handleMobileAnchorTouch.bind(this))}this.onDom(this.el,"click","a:not('.keepopen')",this._handleAnchorClick.bind(this))},_handleAnchorClick:function(){if(this.options.hideOnAnchorClick){this.hide()}},_handleMobileAnchorTouch:function(a,b){if(b.href){window.location.href=b.href}},_handleBodyClick:function(a){if($isTrue(this.options.hideOnOutsideClick,this,a)&&this.isVisible()&&!$(a.target).descendantOf(this.el)&&(!this._targetEl||!$(a.target).descendantOf(this._targetEl))){this.hide()
}},_handleBodyMouseOver:function(a){if(this.options.hideOnMouseLeave){this._mouseOverEl=a.element();if(this.isVisible()&&!this._hasMouseFocus()){if(!this._hideTimeout){if(!this._fnHide){this._fnHide=this.hide.bind(this)}this._hideTimeout=this._fnHide.delay(this.options.stickyDuration)}}else{if(this._hideTimeout&&this._hasMouseFocus()){this._clearHideTimeout()}}}},_hasMouseFocus:function(){if(!this._mouseOverEl){return false}return this._mouseOverEl.findBehavior("Popup",true)===this||this._mouseOverEl===this.el||this._mouseOverEl.descendantOf(this.el)||this._mouseOverEl===this._targetEl||this._mouseOverEl.descendantOf(this._targetEl)
},setTarget:function(a){this._targetEl=a;this._clearHideTimeout()},isVisible:function(){return Dtv.Behaviors.Popup.getVisible(this.options.groupName)===this},toggle:function(){if(this.isVisible()){this.hide(true)}else{this.show(!Dtv.Behaviors.Popup.getVisible(this.options.groupName))}},show:function(a){this._clearHideTimeout();if(this.isVisible()){return false}Dtv.Behaviors.Popup._setVisible(this.options.groupName,this);if(this._fx){this._fx.cancel()}if(a&&this.options.showFxType){this._fx=new this.options.showFxType(this.el,this.options.showFxOptions)
}else{this.el.show()}this.fireEvent(this.EVENTS.SHOW);return true},hide:function(a){this.setTarget(null);this._clearHideTimeout();if(!this.isVisible()){return false}if(this._fx){this._fx.cancel()}if(a&&this.options.hideFxType){this._fx=new this.options.hideFxType(this.el,this.options.hideFxOptions)}else{this.el.hide()}Dtv.Behaviors.Popup._setVisible(this.options.groupName,null);this.fireEvent(this.EVENTS.HIDE);return true},_clearHideTimeout:function(){clearTimeout(this._hideTimeout);this._hideTimeout=null
}}};var c={name:"AjaxPopup",inherits:"Popup",options:{showBeforeLoad:false,loadDelay:0.2,loadDelayCachedMultiplier:3,ajaxPanelOptions:{overlay:false,requestManagerOptions:{useCaching:true}}},statics:{_setLoading:function(a,f){var b=Dtv.Behaviors.Popup.getGroup(a);if(f){if(b.loadingPopup&&b.loadingPopup!==f){b.loadingPopup.hide()}if(b.visiblePopup&&b.visiblePopup!==f){b.visiblePopup.hide()}}b.loadingPopup=f}},prototype:{_init:function(){this._ajaxPanel=this.el.behavior("AjaxPanel",this.options.ajaxPanelOptions);
this.addDisposableObj(this._ajaxPanel)},_initEvents:function($super){$super();this._ajaxPanel.on("update",this._handleAjaxUpdate.bind(this))},_handleAjaxUpdate:function(){if(!this.options.hideOnMouseLeave||this.options.showBeforeLoad||this._hasMouseFocus()){this._prepareAjaxContent();this.show()}},_prepareAjaxContent:Prototype.emptyFunction,_handleTargetMouseOut:function(){clearTimeout(this._setTargetTimeout)},load:function(b,g,a){Dtv.Behaviors.AjaxPopup._setLoading(this.options.groupName,this);var h=this.options.loadDelay;
if(this._ajaxPanel.requestManager.getCachedResponse(b,g?g.parameters:null)){h*=this.options.loadDelayCachedMultiplier}if((typeof(g.parameters.useCache)!=="undefined")){this._ajaxPanel.requestManager.options.useCaching=g.parameters.useCache}if(this.options.showBeforeLoad){this.el.update(a||"");this.show();h=0}this._timeout=this._ajaxPanel.load.bind(this._ajaxPanel,b,g).delay(h)},cancel:function(){this._ajaxPanel.cancel();clearTimeout(this._timeout)},setTarget:function(a,b){if(a){if(this._targetEl!==a||!this.isVisible()){this.hide();
this._targetEl=a;if(this.options.showBeforeLoad){if(!a._mouseoutHandler){a._mouseoutHandler=this.onDom(a,"mouseout",this._handleTargetMouseOut.bind(this))}this._setTargetTimeout=this._setTarget.bind(this,a,b).delay(this.options.loadDelay)}else{this._setTarget(a,b)}}}else{this._targetEl=null}},_setTarget:function(){throw"Abstract method not implemented"},show:function($super,a){Dtv.Behaviors.AjaxPopup._setLoading(this.options.groupName,null);return $super(a)},hide:function($super,a){this.cancel();
return $super(a)}}};Dtv.Behaviors.create(d,c)})();(function(){var b={name:"CartNotification",autoMapping:"global_header_notification",prototype:{_init:function(){this.onDom(this.el,{mouseenter:this.clearCloseTimeout,mouseleave:this.setCloseTimeout},this);this.el.appear();this.setCloseTimeout()},clearCloseTimeout:function(){if(this._timeout){window.clearTimeout(this._timeout)}},setCloseTimeout:function(){this._timeout=window.setTimeout(this.close.bind(this),15000)},close:function(){this.el.fade()}}};
Dtv.Behaviors.create(b)})();(function(){var b={name:"MessageContainer",consts:{MESSAGE_TYPES:{INFO:"info",WARN:"warning",ERROR:"error"}},options:{fxDuration:0.3},prototype:{_init:function(){},setMessages:function(j,i,a){a=a||{};var h=this._getMessageTypeContainer(j);if(h){this.el.show();var g=h.down("ul");if(!a.append){g.update()}if(i&&i.length>0){i.each(function(c){if(a!=null&&a.formatParams!=null&&a.formatParams.codeName!=null&&c.indexOf("{codeName}")>0){c=c.replace("{codeName}",a.formatParams.codeName)
}(Object.isElement(c)?c:new Element("li").update(c)).appendTo(g)});g.select("li.last-row").invoke("removeClassName","last-row");g.down("li:not(.hidden):last").addClassName("last-row");g.removeClassName("multi-row");if(g.select("li:not(.hidden)").length>1){g.select("li:not(.last-row)").invoke("addClassName","multi-row")}h.up().show();h[a.useFx?"appear":"show"]({duration:this.options.fxDuration})}else{h[a.useFx?"fade":"hide"]({duration:this.options.fxDuration})}}else{if(i&&i.length>0){this.debug("cant find container el for "+j)
}}return false},setMessageKeys:function(g,f,h){h=h||{};var a=this;new Ajax.Request("/entertainment/data/jsonMessageData.json.jsp",{parameters:$extend(h.parameters||{},{keys:f.join(",")}),onSuccess:function(c){var d=c.responseJSON;if(d.messages){msgs=$H(d.messages).values();if(h.formatParams){for(var e=0;e<msgs.length;e++){msgs[0]=msgs[0].formatWith(h.formatParams)}if(h.formatParams.codeName){f=[h.formatParams.codeName]}}a.setMessages(g,msgs,h);if(h.callback){h.callback(d.messages,a)}Dtv.Util.Tealeaf.invoke("tlProcessNode",a.el);
if(Reporting.UserActionManager){Reporting.UserActionManager.reportMessageKeys(f,Reporting.pageName,true)}}}})},clearMessages:function(a,d){if(!a){a=$H(this.MESSAGE_TYPES).keys()}$A(a).each(function(c){var f=this._getMessageTypeContainer(c);if(f){if(d){f.fade({duration:this.options.fxDuration})}else{f.hide()}}}.bind(this))},_getMessageTypeContainer:function(a){return this.el.down("."+(this.MESSAGE_TYPES[a]||a)+"-message")}}};Dtv.Behaviors.create(b)})();(function(){var k={initialize:function(a){this.options=a||{};
this._html="";this._headerTemplate=new Template(this.options.headerTemplate);this._choiceTemplate=new Template(this.options.choiceTemplate)},addData:function(b){if(Object.isArray(b)){for(var c=0;c<b.length;c++){var a=b[c];if(a.group){this.addGroup(a.group)}else{if(a.header){this.addHeaderItem(a.header)}else{if(a.choice){this.addChoiceItem(a.choice)}}}}}else{if(b.groups){for(var c=0;c<b.groups.length;c++){this.addGroup(b.groups[c])}}}},addGroup:function(a){this.addHeaderItem(a);this.addChoiceItems(a.choices)
},addHeaderItem:function(a){if(this._html!=""){this._html+="</ul>"}this._html+='<ul class="'+a.className+'">';if(a.text){this._html+=this._headerTemplate.evaluate(a)}},addChoiceItems:function(a){for(var b=0;b<a.length;b++){this.addChoiceItem(a[b])}},addChoiceItem:function(a){if(a.text){a.text=this.emphasizeText(a.text)}if(a.varData){a.varData=Object.toJSON(a.varData)}if(this._html==""){this._html="<ul>"}this._html+=this._choiceTemplate.evaluate(a)},emphasizeText:function(a){if(this.options.text){var b=a.toLowerCase().indexOf(this.options.text.toLowerCase());
if(b>=0){var c=a.substr(0,b);c+="<b>";c+=a.substr(b,this.options.text.length);c+="</b>";c+=a.substr(b+this.options.text.length);return c}}return a},getHtml:function(){return this._html}};var o=Class.create(k);var p={name:"TypeAheadBox",consts:{EVENTS:{}},options:{onRequestData:null,onSelect:null,delay:0.4,minChars:1,maxTypeAheadChars:30,choiceVarTitle:null,choiceItemSelector:"li.choice",emptyText:"Search",emptyTextLookup:{},typeAheadTextEnabled:false,htmlBuilderType:o,htmlBuilderOptions:{headerTemplate:'<li class="header">#{text}</li>',choiceTemplate:'<li class="choice #{className}"><span class="item">#{text}</span><span class="category">#{altText}</span><var>#{varData}</var></li>'}},statics:{HtmlBuilder:o},prototype:{_init:function(){this._topTextBox=this.el.down("input.top");
this._topTextBox.value="";this._topTextBox.setAttribute("autocomplete","off");this._btmTextBox=this.el.down("input.bottom");this._btmTextBox.value=this.options.emptyText;this._btmTextBox.addClassName("empty");this._btmTextBox.setAttribute("autocomplete","off");this._choicesEl=this.el.down("div.choices")},_initEvents:function(){this.onDom(this._topTextBox,{click:this._handleTopTextBoxFocus,focus:this._handleTopTextBoxFocus,blur:this._handleTopTextBoxBlur,keydown:this._handleTopTextBoxKeyDown},this);
this.onDom(this._btmTextBox,"focus",this._handleBtmTextBoxFocus.bind(this));this.onDom(this.el,"click",this.options.choiceItemSelector,this._handleItemClick.bind(this));this.onDom(document,"click",this._handleDocClick.bind(this));this.onDom(this.el,"click",{"div.submit":function(){this.select()}},this)},_handleDocClick:function(a){if(!$(a.target).descendantOf(this.el)){this.hideChoices()}},_handleTopTextBoxFocus:function(a){this.el.addClassName("active")},_handleTopTextBoxBlur:function(a){if(!this.getText()){this._btmTextBox.value=this.options.emptyText;
this._btmTextBox.addClassName("empty");this.el.removeClassName("active")}this.hideChoices.bind(this).delay(0.2)},_handleBtmTextBoxFocus:function(a){this._topTextBox.focus()},_handleTopTextBoxKeyDown:function(a){switch(a.keyCode){case 27:this.setText.bind(this,"").defer();this.hideChoices();break;case 37:break;case 39:this._processRightKeyEvent(a);break;case 38:this._processUpKeyEvent(a);break;case 40:this._processDownKeyEvent(a);break;case 13:this.select();break;default:this._updateTypeAheadTextDisplay.bind(this).defer();
this._processNewValue.bind(this).defer();break}setTimeout(function(){if(this.getText()!=""){this._btmTextBox.value="";this._btmTextBox.removeClassName("empty")}else{this._btmTextBox.value=this.options.emptyText;this._btmTextBox.addClassName("empty")}}.bind(this),0)},_handleItemClick:function(d,a){var c=this._choiceItemEls.length;for(var b=0;b<c;b++){if(this._choiceItemEls[b]===a){this.select(b);return}}this.debug("Failed to find choice index to select")},_updateTypeAheadTextDisplay:function(){if(!this.options.typeAheadTextEnabled){return
}var a=this.getText();if(this._doesTextMatchAutoCompleteText()&&a.length<=this.options.maxTypeAheadChars){var b=a;b+=this._autoCompleteText.substr(a.length);this._btmTextBox.value=b}else{this._btmTextBox.value=""}if(!a){this.hideChoices()}},_doesTextMatchAutoCompleteText:function(){var a=this.getText();return a&&this._autoCompleteText&&this._autoCompleteText.toLowerCase().startsWith(a.toLowerCase())},getText:function(){return this._topTextBox.getValue()},setText:function(a){this._topTextBox.value=a;
this._updateTypeAheadTextDisplay()},setAutoCompleteText:function(a){this._autoCompleteText=a;this._updateTypeAheadTextDisplay()},createHtmlBuilder:function(a){return new this.options.htmlBuilderType($extend({},this.options.htmlBuilderOptions,a||{},{text:this._topTextBox.value}))},hideChoices:function(){this.setChoicesHtml()},setChoicesHtml:function(a){this.el.removeClassName("requesting");this._hlChoiceNdx=-1;clearTimeout(this._requestTimeout);if(a){this._choicesEl.update(a);this._choiceItemEls=this._choicesEl.select(this.options.choiceItemSelector);
if(!this._choicesEl.visible()){this._choicesEl.appear({duration:0.2})}}else{this._choicesEl.hide()}},highlightChoice:function(a){if(this._choiceItemEls){if(this._hlChoiceNdx>=0){this._choiceItemEls[this._hlChoiceNdx].removeClassName("selected")}if(a<-1){a=this._choiceItemEls.length-1}else{if(a>=this._choiceItemEls.length){a=-1}}if(a>=0){this._choiceItemEls[a].addClassName("selected");var b=this._choiceItemEls[a].getVar();if(b&&b.term){this.setText(b.term)}}else{this.setText(this._currentVal)}this._hlChoiceNdx=a
}},_processRightKeyEvent:function(a){if(this._autoCompleteText&&this._hlChoiceNdx<0&&this._doesTextMatchAutoCompleteText()){this.setText(this._autoCompleteText);this._processNewValue()}},_processUpKeyEvent:function(a){if(this._choiceItemEls){this.highlightChoice(this._hlChoiceNdx-1)}a.preventDefault()},_processDownKeyEvent:function(a){if(this._choiceItemEls){this.highlightChoice(this._hlChoiceNdx+1)}},select:function(a){if(a>=0){this._hlChoiceNdx=a}if(this._hlChoiceNdx>=0){this.setText(this._choiceItemEls[this._hlChoiceNdx].down("span").innerHTML.stripTags().unescapeHTML())
}var b={text:this.getText(),data:this._hlChoiceNdx>=0?this._choiceItemEls[this._hlChoiceNdx].getVar():null};if(b.text||b.data){if(this.options.onSelect){this.options.onSelect(b,this)}else{this.onSelect(b)}this.fireEvent("select",b)}this._currentVal=null;this.hideChoices()},onSelect:function(a){},_processNewValue:function(){var a=this._topTextBox.getValue();this._currentVal=a;if(a.length>=this.options.minChars){window.clearTimeout(this._requestTimeout);this._requestTimeout=this._requestData.bind(this).delay(this.options.delay,a)
}else{this.hideChoices()}},_requestData:function(a){this.el.addClassName("requesting");window.clearTimeout(this._requestTimeout);this._requestTimeout=this.setChoicesHtml.bind(this).delay(0.5);if(this.options.onRequestData){this.options.onRequestData(a,this)}else{this.onRequestData(a)}},onRequestData:function(a){},setData:function(a){window.clearTimeout(this._requestTimeout);if(a){if(a.htmlBuilderData){var b=this.createHtmlBuilder();b.addData(a.htmlBuilderData);this.setChoicesHtml(b.getHtml())}this.setAutoCompleteText(a.autoCompleteText)
}}}};var n=Class.create({module:"",initialize:function(a){this.onSuccess=a.onSuccess;this.onFailure=a.onFailure||Prototype.emptyFunction;this.dataUrl=a.dataUrl;this.maxDisplayItems=a.maxDisplayResults||3;this.jsonpMode=a.jsonpMode||false;this.callbackName=a.callbackName;this.baseSearchUrl=a.baseSearchUrl||"/entertainment/search/";this.headerText=a.headerText},createDataUrl:function(a){return""},getData:function(a){if(!this.requestManager){this.requestManager=new Dtv.RequestManager({useCaching:true})
}var b=this;this.requestManager.request(this.createDataUrl(a),{jsonp:this.jsonpMode,callbackName:this.callbackName,timeout:400,onSuccess:function(d){if(!!d&&!!d.responseJSON){var c=b.transformData(a,d.responseJSON);b.onSuccess(c)}else{b.onFailure()}},onFailure:function(){b.onFailure()}})},transformData:function(a){return a},createSearchUrl:function(a){return""},_cleanSearchTerm:function(a){return a.strip().toLowerCase()}});var r=Class.create(n,{initialize:function($super,a){$super(a);this.dataCategory=a.category||0
},createDataUrl:function(a){return this.dataUrl+"/"+this.dataCategory+"/"+this._cleanSearchTerm(a).substring(0,1)+".jsonp.js"},createSearchUrl:function(a){var c=a.text;var b=!!a.originator?a.originator:"";if(!!a.data){c=a.data.term}return this.baseSearchUrl+"?"+$H({showEntNav:($("dtv_nav")&&$("dtv_nav").hasClassName("ep")),searchTerm:c,taTopMatch:true,originator:b}).toQueryString()},transformData:function(b,d){var f={htmlBuilderData:[],autoCompleteText:null};if(!!d&&!!d.results){var g=d.results;var c=0;
b=this._cleanSearchTerm(b);for(var h=0,a=g.length;h<a;h++){var e=g[h];if(this._cleanSearchTerm(e).startsWith(b)){if(!f.autoCompleteText){f.autoCompleteText=e}if(f.htmlBuilderData.length==0&&this.headerText){f.htmlBuilderData.push({header:{text:this.headerText,className:""}})}f.htmlBuilderData.push({choice:{text:e,varData:{term:e}}});if(++c==this.maxDisplayItems){break}}}}return f}});var q=Class.create(n,{initialize:function($super,a){$super(a);this.zipCode=a.zipCode;this.topMatchLabel=a.topMatchLabel||"Top Match";
this.kindMapping=a.config.kindMapping},createDataUrl:function(b){var a=$H({searchText:b.strip(),zipCode:this.zipCode,maxResults:this.maxDisplayItems,pgmWithTMSid:true,output:"json"});return this.dataUrl+"?"+a.toQueryString()},createSearchUrl:function(a){var b=a.data||{};var c=$H({showEntNav:($("dtv_nav")&&$("dtv_nav").hasClassName("ep")),searchTerm:(b.term?b.term:a.text).strip(),taTopMatch:true,taType:b.type,taId:b.id,dym:!!a.didYouMean&&a.didYouMean,originator:!!a.originator?a.originator:document.location.getParam("originator")});
switch(b.type){case 1:case 2:if(b.sports){c.set("maincategory","sports")}else{c.set("maincategory",b.type==1?"tv":"movies");c.set("exactsearch","true")}break;case 5:c.set("subcategory",(b.term?b.term:a.text).strip());break}return"/DTVAPP/search/siteSearchResults.jsp?"+c.toQueryString()},transformData:function(g,e){var d=e.searchResult,b=0,v=[],h=[],i={htmlBuilderData:[],autoCompleteText:null};for(var c=0,f=d.length;c<f;c++){var w=d[c];h.push(w)}if(h.length>0){i.autoCompleteText=h[0].content}var a=this._addChoiceData.bind(this,i.htmlBuilderData);
for(var c=0,f=v.length;(c<f)&&(b<this.maxDisplayItems);c++,b++){}for(var c=0,f=h.length;(c<f)&&(b<this.maxDisplayItems);c++,b++){a(h[c])}return i},_addChoiceData:function(a,c){var b=c.kind;if(c.attributes.sports||c.attributes.adult){b=(c.attributes.sports)?"sports":"adult"}if(a.length==0&&this.headerText){a.push({header:{text:this.headerText,className:""}})}a.push({topMatch:c.topMatch,choice:{text:c.content,altText:this.kindMapping[b],varData:{id:c.id,type:c.kind,term:c.content,topMatch:c.topMatch,sports:c.attributes.sports}}})
}});function j(a){var b=document.body.getVar("typeAheadConfig");var a=$extend(a||{},{dataUrl:"//"+b.pgwsHost+"/SmartSearchWS/rest/search",zipCode:b.zipCode,jsonpMode:true,topMatchLabel:b.topMatchLabel,config:b});return new q(a)}function m(a){var b=document.body.getVar("typeAheadConfig");var a=$extend(a||{},{dataUrl:(window.location.protocol.toLowerCase()=="http:")?"//"+b.dotcomHost+"/csf/typeahead":"//"+b.dotcomSecureHost+"/csf/typeahead",category:0,callbackName:"renderTypeAheadResults",jsonpMode:true,config:b});
return new r(a)}var l={name:"GlobalTypeAheadBox",inherits:"TypeAheadBox",statics:{createPgwsDataProvider:j},options:{maxTypeAheadChars:22},prototype:{_init:function($super){var a=document.body.getVar("typeAheadConfig");if(a.emptyText){this.options.emptyText=a.emptyText}this.addProvider("1",j,{headerText:a.entertainmentLabel});this.addProvider("2",m,{headerText:a.supportLabel,baseSearchUrl:"/DTVAPP/search/siteSearchResults.jsp"});$super()},addProvider:function(a,c,b){b=b||{};b.onSuccess=b.onFailure=this.onDataResponse.bind(this,a);
provider=c(b);this.dataProviders=this.dataProviders||{};this.dataProviders[a]=provider},onRequestData:function(a){this._responses=$H();for(var b in this.dataProviders){this.dataProviders[b].getData(a,this)}},onDataResponse:function(c,a){this._responses.set(c,a||{htmlBuilderData:[]});if(this._responses.keys().length==2){order=Dtv.app.getLoginInfo().isLoggedIn()?["1","2"]:["2","1"];var b=this._responses.get(order[0]);b.htmlBuilderData=b.htmlBuilderData.concat(this._responses.get(order[1]).htmlBuilderData);
this.setData(b)}},onSelect:function(e){var c=(e&&e.data&&e.data.type?"1":"2");var d=this.dataProviders[c];if(!!d){var a=(!!Reporting&&!!Reporting.PageData&&!!Reporting.PageData.siteSection)?Reporting.PageData.siteSection:"Search Results";var b={category:c,data:e.data,text:e.text,originator:a};document.location=d.createSearchUrl(b)}}}};Dtv.Behaviors.create(p,l)})();(function(){var b={name:"Overlayable",options:{overlayClassName:"ajax-panel-loading"},prototype:{showOverlay:function(){if(this._overlayEl){this.hideOverlay()
}this._overlayEl=new Element("div").appendTo(this.el).addClassName(this.options.overlayClassName).setOpacity(0.8);this.updatePosition()},hideOverlay:function(){if(this._overlayEl){if(this._overlayEl.parentNode){this._overlayEl.remove()}this._overlayEl=null}},updatePosition:function(){this._overlayEl.clonePosition(this.el)}}};Dtv.Behaviors.create(b)})();(function(){var c={name:"AjaxPanel",inherits:"Overlayable",options:{url:null,overlay:true,overlayClassName:"ajax-panel-loading",autoUpdate:true,requestManager:null,requestManagerOptions:{},contentBehavior:{name:"AjaxPanel.AjaxContent",options:{}},createContentOnInit:true},prototype:{_init:function(){this.requestManager=this.options.requestManager||new Dtv.RequestManager($extend({name:this.el.identify()},this.options.requestManagerOptions));
this.addDisposableObj(this.requestManager);if(this.options.createContentOnInit){this._createAjaxContent()}},_initEvents:function(){this.requestManager.on({requestsent:this._handleRequestSent,requestsuccess:this._handleRequestSuccess,requestcomplete:this._handleRequestComplete},this)},_initDefaultState:function(){if(this.options.url&&!this.url){this.load(this.options.url)}},_createAjaxContent:function(b,a){this.ajaxContent=this.el.behavior(b||this.options.contentBehavior.name,b?a:this.options.contentBehavior.options);
return this.ajaxContent},_handleRequestSent:function(a){this.url=a.memo.url;if(this.options.overlay){this.showOverlay()}},_handleRequestSuccess:function(a){if(!a.memo.response.responseJSON&&this.options.autoUpdate){this.update(a.memo.response.responseText)}},_handleRequestComplete:function(a,b){if(this.options.overlay){this.hideOverlay()}},refresh:function(a){this.load(this.url,a||this.requestManager._lastOptions)},load:function(a,b){a=a||this.url||this.options.url;return this.requestManager.request(a,b)
},cancel:function(){return this.requestManager.cancel()},fireEvent:function($super,a,b){return $super(a,$extend({ajaxPanel:this},b))},getHtmlAsElement:function(b){if(Prototype.Browser.IE&&!this._ieDiv&&window.location.href.toLowerCase().startsWith("https")){this._ieDiv=new Element("div").appendTo(document.body).hide()}var a=this._ieDiv||new Element("div");a.update(b);return a},update:function(b,k,j){try{if(this.ajaxContent&&!this.ajaxContent.isDisposed){this.ajaxContent.dispose();this.ajaxContent=null
}var a=Object.isElement(b)?b:this.getHtmlAsElement(b);if(this._processAjaxLoadConfig(a.getVar("ajaxLoadConfig"))){return}var l=this.el.id?a.down("#"+this.el.id)||a:a;this.el.update(l.innerHTML);Dtv.app.processHtmlSlugs(this.el);this._createAjaxContent(k,j);if(window.FB){FB.XFBML.parse.delay(this.el)}Dtv.Util.Tealeaf.invoke("tlProcessNode",this.el);this.fireEvent("update")}catch(i){throw this.debug(i).error}},dispose:function($super){if(this.ajaxContent){this.ajaxContent.dispose()}$super()},isLoading:function(){return this.requestManager.isRequesting()
},_processAjaxLoadConfig:function(a){if(a){if(a.reloadPage){window.location.reload(true);return true}}return false}},actionAdapters:{load:function(a,b){this.load(b.href)}}};var d={name:"AjaxPanel.AjaxContent"};Dtv.Behaviors.create(c,d)})();(function(){var g={ORIENTATION:{VERTICAL:"vertical",HORIZONTAL:"horizontal",AUTO:"auto"},EVENTS:{NAV_INDEX_CHANGED:"navindexchanged",UPDATED:"updated"}};var h={name:"NavigableList",consts:g,options:{endless:true,mouseWheelEnabled:true,orientation:g.ORIENTATION.AUTO,prevBtn:null,nextBtn:null,startNavIndex:0,autoHideButtons:false,syncElements:null},prototype:{_init:function(){this._container=this.el.up(0)
},_initLayout:function(){this.update();switch(this.el.getStyle("position")){case"relative":case"absolute":case"fixed":break;default:this.el.style.position="relative";break}},_initEvents:function(){var a=this._handleMouseWheel.bind(this);this.onDom(this.el,"DOMMouseScroll",a);this.onDom(this.el,"mousewheel",a);if(this.options.prevBtn){this.onDom(this.options.prevBtn,"macro:click",this.navigateToPrevious.bind(this))}if(this.options.nextBtn){this.onDom(this.options.nextBtn,"macro:click",this.navigateToNext.bind(this))
}},_initDefaultState:function(){if(this._items.length>0){if($chk(this.options.startNavIndex)){this.navigateToIndex(this._getSafeNdx(this.options.startNavIndex))}}},update:function(){this._items=(this.el.tagName=="TABLE")?this.el.select("tr"):this.el.childElements();if(this._items.length==0){return}this._updateOrientation();this._updateCalculations();this._updateOverflow();this._updateButtons();this.rootPositionedOffset=this._items.first().positionedOffset();if(!$chk(this.getNavIndex())&&$chk(this.options.startNavIndex)){this.navigateToIndex(this._getSafeNdx(this.options.startNavIndex))
}this.fireEvent(g.EVENTS.UPDATED)},_updateOrientation:function(){if(this.options.orientation==g.ORIENTATION.AUTO){this.orientation=this._items[0].getStyle("float")=="none"||this._items[0].getStyle("clear")=="both"?g.ORIENTATION.VERTICAL:g.ORIENTATION.HORIZONTAL}else{this.orientation=this.options.orientation}},_updateButtons:function(){var a,b;if(this.options.endless){a=b=this.getIndexCount()>1?"enable":"disable"}else{a=this.getNavIndex()>0?"enable":"disable";b=this.getNavIndex()<this.getIndexCount()-1?"enable":"disable"
}if(this.options.prevBtn){Element[a](this.options.prevBtn)}if(this.options.nextBtn){Element[b](this.options.nextBtn)}},_updateCalculations:function(){var b=0,l,n,c=0,a=1,d;if(!this.options.visibleCols||(!$chk(this.options.visibleBleed)&&this.orientation==g.ORIENTATION.VERTICAL)||!this.options.visibleCount){switch(this.orientation){case g.ORIENTATION.HORIZONTAL:n=this._container.measure("width");c=this._items.length;this._items.each(function(i,j){l=b;b+=i.measure("margin-box-height");if(b>n){c=j;d=n-l-i.measure("margin-left");
throw $break}});break;case g.ORIENTATION.VERTICAL:maxH=this._container.measure("height");maxW=this._container.measure("width");var m=this._items;m.each(function(i,j){l=b;b+=i.measure("margin-box-height");if(b>maxH){c=(j==0)?1:j;d=maxH-l+i.measure("margin-bottom");var k=0;m.each(function(q,r){k+=q.measure("margin-box-width");if(k>maxW){a=(r==0)?1:r;c*=r;throw $break}});throw $break}});break}}this._visibleCount=this.options.visibleCount?Math.min(this.options.visibleCount,this._items.length):c;this._visibleCols=this.options.visibleCols||a;
this._visibleBleed=$chk(this.options.visibleBleed)?this.options.visibleBleed:d||0},_updateOverflow:function(){var a=0;switch(this.orientation){case g.ORIENTATION.HORIZONTAL:this._items.each(function(d){a+=d.measure("margin-box-width")});a+=(this._items[0].measure("margin-box-width")*2);var c=Math.max(a,this._container.measure("width"));if(c>0){var b={width:c+"px"};this.el.setStyle(b);if(this.options.syncElements){this.options.syncElements.invoke("setStyle",b)}}break;case g.ORIENTATION.VERTICAL:this.orientation=g.ORIENTATION.VERTICAL;
break}},_getSafeNdx:function(a){return Math.min(Math.max(0,a),Math.max(0,this.getIndexCount()-1))},getNavItem:function(a){var a=$chk(a)?a:this.getNavIndex();if(a>=0){return this._items[a]}return null},getItemOffset:function(b){if(isNaN(b)){throw this.debug(new RangeError("itemNdx is NaN")).error}var c=(this.orientation==this.ORIENTATION.HORIZONTAL)?0:1;if(b>=this._items.length){b=(this._items.length-1)}if(this.options.cacheOffsets){if(!this._offsetCache){this._offsetCache=[this._items.length]}else{if(this._offsetCache[b]){return this._offsetCache[b]
}}}var a=this._items[b].positionedOffset()[c]-this.rootPositionedOffset[c];if(this.options.cacheOffsets){this._offsetCache[b]=a}return a},isAtEnd:function(){return this.getNavIndex()>=this.getIndexCount()-1},getIndexCount:function(){throw"abstract method 'getIndexCount' is not implemented"},getNavIndex:function(){return this._navIndex},_setNavIndex:function(a){this._navIndex=a},_onNavIndexChanged:function(b,a){this._updateButtons();this.fireEvent(g.EVENTS.NAV_INDEX_CHANGED,{itemIndex:b,prevIndex:a})
},navigateToIndex:function(b){if(isNaN(b)){throw this.debug(new RangeError("ndx is NaN")).error}if(b<0||b>=this.getIndexCount()){throw this.debug(new RangeError("ndx is out of bounds")).error}if(this._items.length==0){this.debug("Could not navigateToIndex, there are no items in the list.");return false}var a=this.getNavIndex();if(a==b){return false}this._setNavIndex(b);this._onNavIndexChanged(b,a);return true},navigateToFirst:function(){return this.navigateToIndex(0)},navigateToLast:function(){return this.navigateToIndex(this.getIndexCount()-1)
},navigateToNext:function(){if(!this.isAtEnd()){return this.navigateToIndex(this.getNavIndex()+1)}else{if(this.options.endless){return this.navigateToIndex(0)}else{return false}}},navigateToPrevious:function(){var a=this.getNavIndex();if(a>0){return this.navigateToIndex(a-1)}else{if(this.options.endless){return this.navigateToIndex(this.getIndexCount()-1)}else{return false}}},_handleMouseWheel:function(a){if(this.options.mouseWheelEnabled){switch(Event.mouseWheelDelta(a)){case 1:this.navigateToNext();
a.stop();return false;case -1:this.navigateToPrevious();a.stop();return false}}}}};var e={name:"ScrollableList",inherits:"NavigableList",options:{endless:false,maxEffectDuration:0.8,transition:Effect.Transitions.sinoidal,alignToEnd:true},prototype:{getIndexCount:function(){this._indexCount=Math.ceil((this._items.length/this._visibleCols)-(this._visibleCount/this._visibleCols)+1);return this._indexCount},getNavOffset:function(b){if(isNaN(b)){throw this.debug(new RangeError("navNdx is NaN")).error}var a=this.getItemOffset(b*this._visibleCols);
if(b>0&&this.options.alignToEnd){a-=this._visibleBleed}return a},navigateToIndex:function($super,k,c,a,b){var d=this.getNavIndex();var l=$super(k);if(!$chk(c)){c=this.getNavOffset(k)}this._slideToOffset(c,k,d,a,b);return l},_slideToOffset:function(c,l,d,a,b){var k=(this.orientation==this.ORIENTATION.HORIZONTAL?"left":"top")+":"+(c*-1)+"px;";if(!b&&(this.options.effectDuration>0||this.options.maxEffectDuration>0)){if(this._currentFx){this._currentFx.cancel()}this._currentFx=new Effect.Morph(this.el,{style:k,transition:this.options.transition,duration:this._calculateEffectDuration(l,d,this._items.length),afterFinish:a})
}else{this.el.setStyle(k);if(a){a()}}},_calculateEffectDuration:function(a,b,c){if(this.options.effectDuration){return this.options.effectDuration}return this.options.maxEffectDuration*(Math.abs((b||0)-a)/c)}}};var f={name:"ScrollablePane",inherits:"ScrollableList",options:{mouseWheelEnabled:false,transition:Effect.Transitions.easeFromTo,effectDuration:1,visibleCount:1},prototype:{_initDefaultState:function(){this.getNavItem(1).hide()},togglePane:function(d,k,l){if(!d){return}if(d.hasClassName(k+"-active")){var a=this.getNavItem(1);
a.setStyle({overflow:"hidden"});this.navigateToIndex(0,null,function(){a.hide()});d.className=k;d.down("a").update(d.defaultText)}else{this.getNavItem(1).show();this.update();var c=this;var b=function(){c.getNavItem(1).setStyle({overflow:"auto"})};this.navigateToIndex(1,null,b);d.className=k+"-active";d.defaultText=d.down("a").innerHTML;d.down("a").update(l)}}}};Dtv.Behaviors.create(h,e,f)})();(function(){var d={EFFECT:{FADE:"fade",SLIDE:"slide",NONE:"none"}};var e={name:"GroupedList",inherits:"NavigableList",consts:d,options:{endless:true,effect:d.EFFECT.SLIDE,effectDuration:0.8,transition:Effect.Transitions.easeFromTo,mouseWheelEnabled:false,autoHideButtons:false},prototype:{_init:function($super){$super();
this._groupItemOffset=0},navigateToItem:function(b){if(this._currentItemNdx!=b){this._groupItemOffset=0;var a=this.getGroupIndex(b);this._groupItemOffset=this._visibleCount-this.getGroupItems(a).indexOf(this._items[b]);this._navIndex=null;this.navigateToIndex(this.getGroupIndex(b));return true}return false},navigateToIndex:function($super,a){if($super(a)){switch(this.options.effect){case d.EFFECT.SLIDE:this.slideToGroup(a);break;case d.EFFECT.FADE:this.fadeToGroup(a);break;default:this.showGroup(a);
break}return true}return false},getIndexCount:function(){return Math.ceil(this._items.length/this._visibleCount)},getItemIndex:function(a){if(!$chk(a)){a=this.getNavIndex()}return(a*this._visibleCount)-this._groupItemOffset},getGroupIndex:function(a){var b=Math.floor(a/(this._visibleCount*this._visibleCols));return this._groupItemOffset>0?b+1:b},getGroupItems:function(b){var a=this.getItemIndex(b);return this._items.slice(a,a+this._visibleCount)},slideToGroup:function(a){if(a==0){this._groupItemOffset=0
}else{if(a==this.getIndexCount()-1){this.slideToItem(this._items.length-this._visibleCount);return}}this.slideToItem((a*this._visibleCount)-this._groupItemOffset)},slideToItem:function(b){var a=this.getItemOffset(b);if(this._currentFx){this._currentFx.cancel()}var i={style:(this.orientation==this.ORIENTATION.HORIZONTAL?"left":"top")+":"+(a*-1)+"px;",transition:this.options.transition,duration:this.options.effectDuration};if(this.options.syncElements){i.sync=true;var c=[new Effect.Morph(this.el,i)];
for(var j=0;j<this.options.syncElements.length;j++){c.push(new Effect.Morph(this.options.syncElements[j],i))}this._currentFx=new Effect.Parallel(c)}this._currentFx=new Effect.Morph(this.el,i);this._currentItemNdx=b},fadeToGroup:function(a){throw"_fadeToGroup() not implemented yet."},showGroup:function(a){this._items.each(function(b,c){this.getGroupIndex(c)==a?b.show():b.hide()}.bind(this))},update:function($super){$super();if(this.options.autoHideButtons){[$(this.options.prevBtn),$(this.options.nextBtn)].compact().invoke(this.getIndexCount()<2?"hide":"show")
}}}};var f={name:"GroupedListPager",options:{list:null},prototype:{_init:function(){if(!this.options.list){throw"GroupedListPager must be initialized with a valid list option value."}},_initLayout:function(){this._containerDiv=new Element("div").appendTo(this.el);this._prevSpan=new Element("span",{"class":"prev-page"}).appendTo(this._containerDiv);this._pagesList=new Element("ul").appendTo(this._containerDiv);this._nextSpan=new Element("span",{"class":"next-page"}).appendTo(this._containerDiv);this.update()
},_initEvents:function(){this.options.list.on(Dtv.Behaviors.GroupedList.EVENTS.NAV_INDEX_CHANGED,this.update.bind(this));this.onDom(this._prevSpan,"click",this.options.list.navigateToPrevious.bind(this.options.list));this.onDom(this._nextSpan,"click",this.options.list.navigateToNext.bind(this.options.list))},getPageCount:function(){return this.options.list.getIndexCount()},getActiveIndex:function(){return this.options.list.getNavIndex()},update:function(){var c=this.getPageCount();if(c<2){this.el.hide();
return}this.el.show();if(!this._items||this._items.length!=this.getPageCount()){if(this._items){this._pagesList.update()}this._items=[];var a=this.options.list;for(var b=0;b<c;b++){this._items.push(new Element("li"));this._items[b].observe("click",function(){a.navigateToIndex(this.getSiblingIndex())}).appendTo(this._pagesList)}}else{this._items.invoke("removeClassName","active")}this._items[this.getActiveIndex()].addClassName("active");this._updateContainerWidth()},_updateContainerWidth:function(){var a=0;
this._containerDiv.childElements().each(function(b){a+=b.measure("margin-box-width")});this._containerDiv.setStyle({width:a+"px"})}}};Dtv.Behaviors.create(e,f)})();(function(){var d={name:"RenderedList",options:{visibleCount:null,itemOffset:null,cacheSize:4,listTagName:"ol",orientation:"vertical",infinite:false,totalCount:0,updateDelay:0,fxOptions:{duration:Prototype.Browser.MobileWebKit?0.4:0.8,transition:Prototype.Browser.MobileWebKit?Effect.Transitions.linear:Effect.Transitions.Pow.easeOut}},consts:{EVENTS:{UPDATING:"updating",UPDATED:"updated",RENDER_INDEX:"renderindex",INDEX_CHANGED:"indexchanged"}},prototype:{fireEvent:function($super,a,b){$super(a,$extend({list:this},b))
},isAtEnd:function(a){if(!$chk(a)){a=this._posNdx}if(this.options.infinite){return false}else{return a>=this._getMaxIndex()}},areGroupsAlignedToFloor:function(){return this._posNdx%this.getGroupSize()==0},getGroupIndex:function(a,b){if(!$chk(a)){a=this._posNdx}if(Object.isUndefined(b)){b=this.areGroupsAlignedToFloor()}if(b){return Math.floor(a/this.getGroupSize())}else{return Math.ceil(a/this.getGroupSize())}},getGroupSize:function(){return this.options.groupSize||this.options.visibleCount},getGroupCount:function(){return Math.ceil(this.getTotalCount()/this.getGroupSize())
},getTotalCount:function(){return this.options.totalCount},getPosIndex:function(){return this._posNdx},getCurrentListEl:function(){return this._currentListEl},reset:function(a){if($chk(a)){this.options.totalCount=a}this._posNdx=null;this.currentIndex=null;this.el.update();if(this.getTotalCount()>0){this.moveToPosition(0,true)}},refresh:function(){this._renderList();this._trimCache()},moveToPreviousGroup:function(a){var b=this._posNdx-this.getGroupSize();if(b<0&&!this.options.infinite){b=0}return this._moveToValidPosition(b,a)
},moveToNextGroup:function(a){var b=this._posNdx+this.getGroupSize();if(b>this._getMaxIndex()&&!this.options.infinite){b=this._getMaxIndex()}return this._moveToValidPosition(b,a)},moveToPreviousItem:function(a){return this._moveToValidPosition(this._posNdx-1,a)},moveToNextItem:function(a){return this._moveToValidPosition(this._posNdx+1,a)},moveToGroup:function(f,b){var a=this.getGroupCount();if(f>=a){f=a-1}if(f<0){f=0}return this._moveToValidPosition(Math.min(f*this.getGroupSize(),this._getMaxIndex()),b)
},_moveToValidPosition:function(a,b){if(this._validatePosRange(a)){this.moveToPosition(a,b);return true}return false},moveToPosition:function(g,h){if(isNaN(g)){throw new RangeError("ndx cannot be NaN")}if(!this._validatePosRange(g)){if(g>this._getMaxIndex()&&g<this.getTotalCount()){g=this._getMaxIndex()}else{throw this.debug(new RangeError("ndx is out of range")).error}}if(g==this._posNdx){return false}var b=this.currentIndex;var a=this._convertPosToItemIndex(g);if(!this.isUpdating){this._onUpdating(a,g)
}else{clearTimeout(this._updateTimeout)}this._prevPosNdx=this._posNdx;if(g>this._posNdx+this.getGroupSize()){this._moveToPosition(g-this.getGroupSize(),true)}if(g<this._posNdx-this.getGroupSize()){this._moveToPosition(g+this.getGroupSize(),true)}this._moveToPosition(g,$defined(h)?h:!$chk(this._posNdx));if(!this.options.infinite){a=this._posNdx}if(a!=b){this._onIndexChanged(a)}return true},_moveToPosition:function(a,b){if(isNaN(a)){throw new RangeError("ndx cannot be NaN")}this._posNdx=this.options.infinite?a:Math.range(a,0,this._getMaxIndex());
this._renderList();this._scrollList(b);return this._posNdx},_scrollList:function(b){var a=-(this._posNdx*this.options.itemOffset);if(b){this.el.setStyle(this._getOffsetStyle(a));if(this._currentFx){this._currentFx.cancel()}this._setUpdateTimeout()}else{if(this._currentFx&&this._prevPosNdx>=this._posNdx-this.options.visibleCount&&this._prevPosNdx<=this._posNdx+this.options.visibleCount){this._currentFx.cancel()}this._currentFx=new Effect.Morph(this.el,$extend({},this.options.fxOptions,{style:this._getOffsetStyle(a),afterFinish:this._setUpdateTimeout.bind(this)}))
}},_renderList:function(){this._currentListEl=new Element(this.options.listTagName).setStyle(this._getOffsetStyle(this._posNdx*this.options.itemOffset)).appendTo(this.el);for(var a=0;a<this.options.visibleCount&&a<this.getTotalCount();a++){this._onRenderIndex(this._convertPosToItemIndex(this._posNdx+a),a,this._currentListEl)}(function(b){b._trimCache()}).delay(0.001,this)},_onRenderIndex:function(b,h,g){var a={index:b,renderIndex:h,listEl:g};this.fireEvent(this.EVENTS.RENDER_INDEX,a)},_onIndexChanged:function(a){this.currentIndex=a;
this.fireEvent(this.EVENTS.INDEX_CHANGED,{index:a,oldIndex:this._convertPosToItemIndex(this._prevPosNdx)})},_onUpdating:function(a,b){this.isUpdating=true;this.fireEvent(this.EVENTS.UPDATING,{newItemIndex:a,itemIndex:this.currentIndex,newPosIndex:b,posIndex:this._posNdx})},_onUpdated:function(){this.isUpdating=false;this.fireEvent(this.EVENTS.UPDATED)},_setUpdateTimeout:function(){if(this.options.updateDelay>0){if(!this.__onUpdated){this.__onUpdated=this._onUpdated.bind(this)}this._updateTimeout=this.__onUpdated.delay(this.options.updateDelay)
}else{this._onUpdated()}},_trimCache:function(){var a=this.el.childElements();while(a.length>this.options.cacheSize){a.shift().remove()}},_getOffsetStyle:function(a){var b={};b[this.options.orientation=="vertical"?"top":"left"]=a+"px";return b},_convertPosToItemIndex:function(a){if(this.options.infinite){while(a<0){a+=this.getTotalCount()}while(a>=this.getTotalCount()&&a!=0){a-=this.getTotalCount()}return a}return a},_validatePosRange:function(a,b){return this.options.infinite||(a>=0&&a<=this._getMaxIndex())
},_getMaxIndex:function(){return Math.max(this.getTotalCount()-this.options.visibleCount,0)}}};var c={name:"PreRenderedList",inherits:"RenderedList",prototype:{_init:function(){this._data=this.el.select("li");if(this._data.length>0){this._posNdx=0;this.currentIndex=0;if(!this.options.itemOffset){this.options.itemOffset=this._data[0].measure(this.options.orientation=="vertical"?"height":"width")}}},getData:function(){return this._data},getTotalCount:function(){return this._data.length},_onRenderIndex:function($super,a,i,b){try{var h=this.getData()[a];
this._renderDeferredImages(h);h.clone(true).appendTo(b).addClassName("item-"+i);$super(a,i,b)}catch(j){Dtv.debug(j)}},_renderDeferredImages:function(a){var b=a.select(".js-PreRenderedList-deferredImage");b.each(function(f){f.replace('<img src="'+f.getVar("imageUrl")+'"></img>')})}}};Dtv.Behaviors.create(d,c)})();
/*!
// accordion.js v2.0
//
// Copyright (c) 2007 stickmanlabs
// Author: Kevin P Miller | http://www.stickmanlabs.com
//
// Accordion is freely distributable under the terms of an MIT-style license.
//
// I don't care what you think about the file size...
//   Be a pro:
//      http://www.thinkvitamin.com/features/webapps/serving-javascript-fast
//      http://rakaz.nl/item/make_your_pages_load_faster_by_combining_and_compressing_javascript_and_css_files
//
*/
if(typeof Effect=="undefined"){throw ("accordion.js requires including script.aculo.us' effects.js library!")
}var accordion=Class.create();accordion.prototype={showAccordion:null,currentAccordion:null,duration:null,effects:[],animating:false,initialize:function(d,f){d=$(d);if(!d){throw (d.identify()+" doesn't exist!");return false}this.options=Object.extend({resizeSpeed:8,classNames:{toggle:"accordion_toggle",toggleActive:"accordion_toggle_active",content:"accordion_content"},defaultSize:{height:null,width:null},direction:"vertical",onEvent:"click"},f||{});this.duration=((11-this.options.resizeSpeed)*0.15);
var e=$(d).select("."+this.options.classNames.toggle);e.each(function(b){Event.observe(b,this.options.onEvent,this.activate.bind(this,b),false);if(this.options.onEvent=="click"){b.onclick=function(){return false}}if(this.options.direction=="horizontal"){var a={width:"0px"}}else{var a={height:"0px"}}Object.extend(a,{display:"none"});this.currentAccordion=$(b.next(0)).setStyle(a)}.bind(this))},activate:function(b){if(this.animating){return false}this.effects=[];this.currentAccordion=$(b.next(0));this.currentAccordion.setStyle({display:"block",overflow:"hidden"});
this.currentAccordion.previous(0).addClassName(this.options.classNames.toggleActive);if(this.options.direction=="horizontal"){this.scaling={scaleX:true,scaleY:false}}else{this.scaling={scaleX:false,scaleY:true}}if(this.currentAccordion==this.showAccordion){this.deactivate()}else{this._handleAccordion()}},deactivate:function(){var b={duration:this.duration,scaleContent:false,transition:Effect.Transitions.sinoidal,queue:{position:"end",scope:"accordionAnimation"},scaleMode:{originalHeight:this.options.defaultSize.height?this.options.defaultSize.height:this.currentAccordion.scrollHeight,originalWidth:this.options.defaultSize.width?this.options.defaultSize.width:this.currentAccordion.scrollWidth},afterFinish:function(){if(this.showAccordion){this.showAccordion.setStyle({height:"0px",display:"none"})
}this.showAccordion=null;this.animating=false}.bind(this)};Object.extend(b,this.scaling||{});this.showAccordion.previous(0).removeClassName(this.options.classNames.toggleActive);new Effect.Scale(this.showAccordion,0,b);closeTooltipsByDiv(this.showAccordion)},_handleAccordion:function(){var b={sync:true,scaleFrom:0,scaleContent:false,transition:Effect.Transitions.sinoidal,scaleMode:{originalHeight:this.options.defaultSize.height?this.options.defaultSize.height:this.currentAccordion.scrollHeight,originalWidth:this.options.defaultSize.width?this.options.defaultSize.width:this.currentAccordion.scrollWidth}};
Object.extend(b,this.scaling||{});this.effects.push(new Effect.Scale(this.currentAccordion,100,b));if(this.showAccordion){this.showAccordion.previous(0).removeClassName(this.options.classNames.toggleActive);b={sync:true,scaleContent:false,transition:Effect.Transitions.sinoidal};Object.extend(b,this.scaling||{});this.effects.push(new Effect.Scale(this.showAccordion,0,b))}new Effect.Parallel(this.effects,{duration:this.duration,queue:{position:"end",scope:"accordionAnimation"},beforeStart:function(){this.animating=true;
if(this.showAccordion){closeTooltipsByDiv(this.showAccordion);$(this.showAccordion).setStyle({overflow:"hidden"})}}.bind(this),afterFinish:function(){if(this.showAccordion){this.showAccordion.setStyle({display:"none"})}$(this.currentAccordion).setStyle({height:"100%",overflow:"visible"});this.showAccordion=this.currentAccordion;this.animating=false;$(this.currentAccordion).fire(Dtv.Behaviors.Accordion.EVENTS.ACCORDION_OPENED)}.bind(this)})}};(function(){var d={EVENTS:{ACCORDION_OPENED:"dtv:accordionOpened"}};
var c={name:"Accordion",consts:d,options:{classNames:{toggle:"js-accordion-toggle",toggleActive:"active",content:"js-accordion-content"},direction:"vertical"},prototype:{_init:function(){this.accordion=new accordion(this.el,this.options)},_initDefaultState:function(){var a=this.el.select("."+this.options.classNames.toggle).each(function(b){if(b.match("."+this.options.classNames.toggleActive)){this.accordion.activate(b)}},this)},close:function(){if(Element.viewportOffset(this.el)[1]<0){Element.scrollTo(this.el)
}this.accordion.deactivate()}}};Dtv.Behaviors.create(c)})();(function(){var b={name:"CollapsibleTab",consts:{EVENTS:{COLLAPSIBLE_TAB_ACTIVATE:"dtv:collapsibleTabActivate"}},options:{classNames:{opener:"js-collapsible-tab-title",content:"js-collapsible-tab-content",active:"active",alwaysOpen:"js-tab-always-open"},allowCollapseToggle:true,effectOptions:{duration:0.5},useEffects:true,ajaxUrlVarName:"ajaxUrl",ajaxPanelOptions:{}},prototype:{_init:function(){this._activeTab=null;this._tabOpeners=this.el.select("."+this.options.classNames.opener);
this._tabContents=this.el.select("."+this.options.classNames.content);this._tabOpeners.invoke("disableSelection");Dtv.Util.lazyStyles("ctm-html-tabs-module")},_initEvents:function(){this.onDom(this.el,"macro:click","."+this.options.classNames.opener,this._handleTabOpenerClick.bind(this));this.onDom(this.el,"dtv:collapsibleTabActivate","."+this.options.classNames.opener,this._handleTabOpenerClick.bind(this))},_initDefaultState:function(){this._tabOpeners.each(function(a){if(a.hasClassName(this.options.classNames.active)){this.activate(a)
}},this)},_handleTabOpenerClick:function(e,a){this.activate(a);var f=e.target;if(f&&f.type&&("CHECKBOX"===f.type.toUpperCase())){return}e.stop()},_handleTabAjaxUpdate:function(d,a){this.fireEvent("tabajaxupdate",$extend(a,{ajaxPanel:d.memo.ajaxPanel}))},activate:function(l){if(this.disabled){return}var m=(this._activeTab==null);if(Object.isNumber(l)){l=this._tabOpeners[l]}if(this._activeTab==l){if(!this.el.hasClassName(this.options.classNames.alwaysOpen)&&this.options.allowCollapseToggle){this.deactivate()
}return}var j=this._activeTab;this.deactivate(false);l.addClassName(this.options.classNames.active);var k=this._tabContents[this.getTabIndex(l)];if(this._fx){this._fx.cancel()}if(!j&&this.options.useEffects){this._fx=new Effect.Appear(k,this.options.effectOptions)}else{k.show()}this._activeTab=l;var a={index:this.getActiveTabIndex(),opener:this._activeTab,content:k};if(!m){var n={};Object.extend(n,a);n.tab_id=this._activeTab.id;n.path=window.location.pathname;document.fire(DTV_REPORTING_TAB_CLICK,n)
}this.fireEvent("activate",a);if(this.options.ajaxUrlVarName){var o=k.getVar(this.options.ajaxUrlVarName);if(o){var p=k.behavior("AjaxPanel",this.options.ajaxPanelOptions);p.on("update",this._handleTabAjaxUpdate.bindAsEventListener(this,a));p.load(o)}}},deactivate:function(a){if(!$defined(a)){a=this.options.useEffects}if(!this._activeTab){return}var d=this._tabContents[this.getTabIndex(this._activeTab)];if(d.visible()){closeTooltipsByDiv(d);if(a){d.fade(this.options.effectOptions)}else{d.hide()}}this._activeTab.removeClassName(this.options.classNames.active);
this.fireEvent("deactivate");this._activeTab=null},getTabIndex:function(a){return this._tabOpeners.indexOf(a)},getActiveTabIndex:function(){return this._activeTab?this.getTabIndex(this._activeTab):-1}}};Dtv.Behaviors.create(b)})();(function(){var c={name:"MediaPlayer",options:{initialTrackIndex:0,endless:false,delayInterval:5,autoCreateSwf:true},consts:{URLS:{SWF:"/resources/flash/dtvMediaPlayer.swf"},EVENTS:{FLASH:{PREV_MEDIA:"prevMedia",NEXT_MEDIA:"nextMedia",PLAY_CLICKED:"playClicked",PAUSE_CLICKED:"pauseClicked",LEARN_MORE:"learnMore",MEDIA_STATUS_CHANGE:"mediaStatusChange",ERROR:"error",DEBUG:"debug"},JS:{SWF_DOM_READY:"swfdomready",TRACK_CHANGED:"trackchanged",PLAYLIST_DATA_CHANGED:"playlistdatachanged"}},STATUS:{PLAYING:"playingStatus"}},prototype:{_init:function(){this._initServerOptions();
if(this.options.autoCreateSwf){this.createSwfObj()}if(Prototype.Browser.MobileSafari){this.playTrack(this.options.initialTrackIndex)}},_initServerOptions:function(){var a=this.el.getVar("autoplay");this.options.autoplay=a;a=this.el.getVar("backgroundImageUrl");if(a){this.options.backgroundImageUrl=a}a=parseInt(this.el.getVar("initialTrackIndex"),10);if(!isNaN(a)){this.options.initialTrackIndex=a}this.options.loadingImageUrl=this.el.getVar("loadingImageUrl")},createSwfObj:function(){if(Prototype.Browser.MobileSafari){return false
}if(!this.getSwfObj()){var a=this.el.down(".js-flash");if(a){var b=new Element("div").appendTo(a);this.swfObj=swfobject.createSWF({data:this.URLS.SWF+(Prototype.Browser.IE?("?rdm="+new Date().getTime()):""),width:a.style.width,height:a.style.height},{flashvars:"devmode=0&width="+a.style.width+"&height="+a.style.height+"&theme="+this.options.theme,wmode:"transparent",allowscriptaccess:"always"},b.identify());this.debug("Flash object created")}else{this.debug("Flash Object could not be created");return false
}}this.swfObj.observeEvent=function(f,e){if(!Dtv.flashMethods){Dtv.flashMethods=[]}Dtv.flashMethods.push(e);this.addEventListener(f,"Dtv.flashMethods["+(Dtv.flashMethods.length-1)+"]");return this};this.isSwfDomReady=false;var h=this;(function g(){if(h.swfObj.loadMedia){h._onSwfDomReady()}else{g.delay(0.5)}})();return true},destroySwfObj:function(){this.swfObj=null;this.el.down(".js-flash").update()},getSwfObj:function(){return this.swfObj},_onSwfDomReady:function(){this.isSwfDomReady=true;this.fireEvent(this.EVENTS.JS.SWF_DOM_READY);
this.swfObj.observeEvent(this.EVENTS.FLASH.PREV_MEDIA,this.previousTrack.bind(this)).observeEvent(this.EVENTS.FLASH.NEXT_MEDIA,this.nextTrack.bind(this)).observeEvent(this.EVENTS.FLASH.LEARN_MORE,this.gotoMoreInfo.bind(this)).observeEvent(this.EVENTS.FLASH.PLAY_CLICKED,this._reportEvent.bind(this,this.EVENTS.FLASH.PLAY_CLICKED)).observeEvent(this.EVENTS.FLASH.PAUSE_CLICKED,this._reportEvent.bind(this,this.EVENTS.FLASH.PAUSE_CLICKED));if(Dtv.debugEnabled){this.swfObj.observeEvent(this.EVENTS.FLASH.DEBUG,this._onFlashDebug.bind(this)).observeEvent(this.EVENTS.FLASH.ERROR,this._onFlashError.bind(this))
}var a=this.options.initialTrackIndex;if($chk(a)){this.setPlaylistTrack.bind(this,a,this.options.autoplay).defer()}},_reportEvent:function(a){this.fireEvent(a)},getCurrentTrackData:function(){if($chk(this.currentTrack)&&this.playlistData&&this.playlistData.length>0){return this.playlistData[this.currentTrack]}return null},setPlaylistTrack:function(n,b){try{if(!$defined(n)){throw"ndx must be defined"}if(!Prototype.Browser.MobileSafari){if(!this.swfObj){this.createSwfObj()}if(!this.isSwfDomReady){this.debug("Waiting for Swf DOM to be ready before setting playlist track");
this.options.initialTrackIndex=n;this.options.autoplay=b;return null}}if(this.currentTrack!=n&&this.getPlaylistData().length>0){if(this.playlistData.length<=n||n<0){throw"ndx out of range"}this.currentTrack=n;var k=this.playlistData[n];k.prevEnabled=this.options.endless||n>0;k.nextEnabled=this.options.endless||n<this.playlistData.length-1;var l=this.options.delayInterval;if(!Prototype.Browser.MobileSafari){this.swfObj[b?"playMedia":"loadMedia"](k)}else{var m=k.imageUrl||this.options.backgroundImageUrl;
var a=this.el.down(".js-flash");a.style.backgroundImage="url(http://www.directv.com"+m+")";if(k.videoUrl){k.videoUrl=k.videoUrl.replace("rtmp://","http://").replace("L0.mp4",(Prototype.Browser.IPad?"N":"K")+"0.mp4");a.update().append(new Element("a",{href:k.videoUrl,className:"mobile-video"}))}}this.options.autoPlay=true;this.fireEvent(this.EVENTS.JS.TRACK_CHANGED);return true}else{if(b&&!Prototype.Browser.MobileSafari&&!this.swfObj.isPlaying()){this.swfObj.playMedia();return true}}return false}catch(e){this.debug(e);
return false}},playTrack:function(a){this.debug("playing track: "+a);return this.setPlaylistTrack($chk(a)?a:this.currentTrack||0,true)},pauseTrack:function(){this.swfObj.pauseMedia()},nextTrack:function(){this.debug("next track called");if(this.getPlaylistData().length>0){ndx=this.currentTrack||0;if(ndx<this.playlistData.length-1){this.fireEvent(this.EVENTS.FLASH.NEXT_MEDIA);return this.playTrack(ndx+1)}else{if(this.options.endless){this.fireEvent(this.EVENTS.FLASH.NEXT_MEDIA);return this.playTrack(0)
}}}return false},previousTrack:function(){this.debug("previous track called");if(this.getPlaylistData().length>0){ndx=this.currentTrack||0;if(ndx>0){this.fireEvent(this.EVENTS.FLASH.PREV_MEDIA);return this.playTrack(ndx-1)}else{if(this.options.endless){this.fireEvent(this.EVENTS.FLASH.PREV_MEDIA);return this.playTrack(this.playlistData.length-1)}}}return false},loadPlaylistData:function(b){b=b||this.el;var a={videoUrl:b.getVar("videoUrl"),imageUrl:b.getVar("imageUrl")||this.options.loadingImageUrl,title:b.getVar("title"),blurb:b.getVar("description"),linkText:b.getVar("linkText"),linkUrl:b.getVar("linkUrl"),bgImageUrl:this.options.backgroundImageUrl||""};
return a.videoUrl||a.imageUrl?[a]:[]},getPlaylistData:function(){if(!this.playlistData){this.playlistData=this.loadPlaylistData()}return this.playlistData},setPlaylistData:function(b,g){b=Object.isArray(b)?b:b!=null?[b]:[];var a=-1;if(!g){this.currentTrack=null;this.playlistData=b;if(b.length>0){a=0}}else{this.playlistData=this.playlistData||[];var h=this.playlistData.length;this.playlistData=this.playlistData.concat(b);if(b.length>0){a=h}}this.fireEvent(this.EVENTS.JS.PLAYLIST_DATA_CHANGED);return a
},isPlaying:function(){return this.isSwfDomReady&&this.swfObj.getStatus()==this.STATUS.PLAYING},gotoMoreInfo:function(){window.location.href=this.playlistData[this.currentTrack].linkUrl},_onFlashError:function(f,a,b){this.debug(b,"!!FLASH ERROR")},_onFlashDebug:function(f,a,b){this.debug(b,"FLASH DEBUG")}}};var d={name:"MediaCarousel",inherits:"MediaPlayer",prototype:{_initLayout:function(){this._groupedList=this.el.down(".playlist ul").behavior("GroupedList",{effect:Dtv.Behaviors.GroupedList.EFFECT.SLIDE,visibleCount:6});
this._groupedList.navigateToIndex(this._groupedList.getGroupIndex(this.options.initialTrackIndex||0));this._selectionList=this._groupedList.el.behavior("SelectionList",{initialSelections:this.options.initialTrackIndex||this.options.initialTrackIndex==0?[this.options.initialTrackIndex]:[],selectionRequired:true});this._pager=this.el.down(".pagination").behavior("GroupedListPager",{list:this._groupedList})},_initEvents:function(){this._selectionList.on(Dtv.Behaviors.SelectionList.EVENTS.ITEM_SELECTED,this._onItemSelected.bind(this));
this.on(this.EVENTS.JS.TRACK_CHANGED,this._onTrackChanged.bind(this))},_onTrackChanged:function(a){this._selectionList.selectItem(this.currentTrack)},_onItemSelected:function(a){var b=this._groupedList.getGroupIndex(a.memo.itemIndex);if(b!=this._groupedList.getNavIndex()){this._groupedList.navigateToIndex(b)}if(this.currentTrack!=a.memo.itemIndex){this.playTrack(a.memo.itemIndex);if(Prototype.Browser.MobileSafari){this.el.down(".js-flash a").simulate("click")}}},loadPlaylistData:function(i){i=i||this.el;
var b=[];var a=this.options.backgroundImageUrl;var j=this.options.loadingImageUrl;var h=parseInt(this.el.getVar("delayInterval"),10);if(isNaN(h)){h=this.options.delayInterval}i.select(".playlist ul li").each(function(f,e){b.push({videoUrl:f.getVar("videoUrl"),imageUrl:f.getVar("imageUrl")||j,title:$member(f.down("h4"),"innerHTML"),blurb:f.getVar("description"),linkText:f.getVar("linkText")||null,linkUrl:f.getVar("linkUrl")||null,bgImageUrl:f.getVar("backgroundImageUrl")||a,delayInterval:h})}.bind(this));
return b}}};Dtv.Behaviors.create(c,d)})();(function(){var e={name:"VideoPlayer",consts:{EVENTS:{ERROR:"error",INSTALL_REQUIRED:"installrequired"}},options:{autoLoad:!Prototype.Browser.MobileSafari,scaleMode:"exactFit"},prototype:{_init:function(){this.plugins=CMPPluginDetection.getInstance();this.serverOptions=this.el.getVar("serverOptions")||{};this.display=this.addDisposableObj(this.el.down(".js-VideoPlayer-Display").behavior("VideoPlayer.Display",{player:this}));this._cmp=CMP.getInstance();var b=this.el.down(".js-VideoPlayer-Playlist");
if(b){var c=3;if(this.el.up(".colspan-3")){c=5}else{if(this.el.up(".colspan-4")){c=7}}this.playlist=b.behavior("VideoPlayer.Playlist",{player:this,visibleItems:c})}var a=this.el.down(".js-VideoPlayer-textScroller");if(a){this.descriptionScroller=a.behavior("TextScroller")}this.messages=this.el.down(".js-message-container").behavior("VideoPlayer.MessageContainer");if(!Dtv.app.videoPlayer){Dtv.app.videoPlayer=this}},_initEvents:function(){this.display.onFlash({mediaPlayerEvent:this._handleMediaPlayerEvent,mediaPlayerErrorEvent:this._handleMediaPlayerErrorEvent,mediaPlayCompleteEvent:this._handleMediaPlayComplete},this);
if(this.playlist){this.playlist.on("mediaselected",this._handlePlaylistMediaSelected.bind(this))}},_initDefaultState:function(){if(this.options.autoLoad){this.loadMedia(this.getOption("defaultIndex"),this.getOption("autoPlay"))}},_handleMediaPlayComplete:function(){if(this.getOption("autoAdvance")&&this.playlist&&!this.playlist.isAtEnd()){this.loadMedia(this.playlist.selectedIndex+1,true)}else{this.display.media.isComplete=true;this.display.shrinkFlash()}},_handleMediaPlayerEvent:function(a){switch(a.code){case CMPEventsCode.MEDIA_DISCONNECTED:this.fireEvent(this.EVENTS.MEDIA_DISCONNECTED);
this.showMessageKey("ep.player.concurrency_browser.message","warning");break;case CMPEventsCode.PLAYER_FLASH_STANDALONE_REQUIRED:case CMPEventsCode.PLAYER_FLASH_STANDALONE_AND_PLUGIN_VERSION_MISMATCH:this.showMessageKey("ep.player.flash.standalone_upgrade_error.message");break;default:break}},_handleMediaPlayerErrorEvent:function(a){this.debug(a.message,"video player error","error");var b=function(j){for(var d in CMPEventsCode){if(CMPEventsCode[d]==j){return d}}return j};var c=a.code+"";a.formattedCode=c.substr(0,4)+"-"+c.substr(4);
a.codeName=b(a.code);switch(a.code){case CMPEventsCode.PLAYER_ACTIVATION_NEEDED:case CMPEventsCode.PLAYER_ALREADY_ACTIVATED_FOR_OTHER_USER:case CMPEventsCode.PLAYER_DRM_CRED_SW_VERSION_UPGRADE_OPTIONAL:return;case CMPEventsCode.PLAYER_DRM_CRED_SW_VERSION_UPGRADE_MANDATORY:document.location.href=this.messages.getInstallUrl()+"?requiredUpgrade=true";break;case CMPEventsCode.PLAYER_DRM_CRED_DEVICE_PROBLEM:this.showMessageKey("ep.player.install.message",null,a);break;case CMPEventsCode.PLAYER_DRM_CRED_NUM_OF_DEVICES_EXCEEDED:case CMPEventsCode.PLAYER_AL_ANOTHER_OS_USER_USING_PCSHOW:case CMPEventsCode.PLAYER_XFERM_DRM_CONCURRENCY_ERROR:case CMPEventsCode.PLAYER_DRM_CRED_SESSION_OPEN_REJECTED:this.showMessageKey("ep.player.concurrency_limit.message",null,a);
break;case CMPEventsCode.PLAYER_DRM_CRED_WRONG_USERNAME_OR_PASSWORD:this.showMessageKey("ep.player.authentication_error.message",null,a);break;case CMPEventsCode.PLAYER_DRM_CRED_CONNECTED_TO_SERVER_STATUS_FAILED:this.showMessageKey("ep.player.network_error.drm.message",null,a);break;case CMPEventsCode.DUAL_PLAYER_INVOKE_ERROR:case CMPEventsCode.PLAYER_DRM_CRED_SESSION_ALREADY_OPEN:this.showMessageKey("ep.player.concurrency_browser.message",null,a);break;case CMPEventsCode.PLAYER_TSP_USER_NOT_ENTITLED:case CMPEventsCode.PLAYER_XFERM_USER_NOT_ENTITLED:this.showMessageKey("ep.player.authorization_error.message",null,a);
break;case CMPEventsCode.PLAYER_TSP_FORMAT_NOT_SUPPORTED:case CMPEventsCode.PLAYER_AL_ASSET_NOT_FOUND:case CMPEventsCode.PLAYER_AL_INVALID_STRING_FORMAT:case CMPEventsCode.MEDIA_NOT_FOUND_ERROR:this.showMessageKey("ep.player.install_14day_window.message",null,a);break;case CMPEventsCode.PLAYER_TSP_ENTITLEMENT_EXPIRED:case CMPEventsCode.PLAYER_XFERM_ENTITLEMENT_EXPIRED:this.showMessageKey("ep.player.rental_period.expired.message",null,a);break;case CMPEventsCode.MEDIA_SECURITY_ERROR:this.showMessageKey("ep.player.authorization.country.message",null,a);
break;case CMPEventsCode.PLAYER_DRM_CRED_DRM_SERVER_ERROR:case CMPEventsCode.PLAYER_XFERM_DOWNLOAD_ERR:this.showMessageKey("ep.player.download_error.message",null,a);break;case CMPEventsCode.PLAYER_SECURITY_ALERT:this.showMessageKey("ep.player.security_error.message",null,a);break;case CMPEventsCode.AL_UPNP_CONFLICT:this.showMessageKey("ep.player.software.conflict_error.message",null,a);break;case CMPEventsCode.PLAYER_DRM_CRED_NW_CONNECTION_STATUS_REQUIRED:case CMPEventsCode.PLAYER_XFERM_DRMSERVER_CONNECTION_PROBLEM:this.showMessageKey("ep.player.connection.lost_error.message",null,a);
break;case CMPEventsCode.PLAYER_AL_NEEDS_RESTART:case CMPEventsCode.PLAYER_TSP_LM_LICENSE_TIMED_OUT:this.showMessageKey("ep.player.license_timeout.message",null,a);break;default:this.showMessageKey("ep.player.technical_error.message",null,a);break}this.display.destroyFlash();this.fireEvent(this.EVENTS.ERROR,a)},_handlePlaylistMediaSelected:function(a){this.loadMedia(a.memo.index,true)},showMessageKey:function(a,b,c){this.showMessage(a,b,"setMessageKeys",c)},showMessage:function(c,a,b,d){var j=this.messages||Dtv.app.messages;
j[b||"setMessages"](a||"error",[c],{useFx:true,formatParams:d,parameters:{codeName:(d||{}).codeName,payload:(d||{}).payload}});this.fireEvent("messageupdated")},loadMedia:function(b,o){var c=Object.isNumber(b)?(this.playlist?this.playlist.getMediaData(b):this._getStandaloneMediaData()):b;this.messages.options.tmsId=c.tmsId;if(Prototype.Browser.MobileSafari){if(c.mediaUrl){var d=c.mediaUrl.replace("L0.mp4",this._getMobileMediaUrlMatchStr());document.location.href=d}else{if(c.isProtected){}else{new Ajax.Request("/entertainment/data/movieTrailers.json.jsp?programid="+c.tmsId,{onSuccess:this._handleMovieTrailerSuccess.bind(this)})
}}}else{if(c.isProtected){if(!this.plugins.isOSSupported()||this.plugins.isBrowserSupported()==2){var p;if(this.plugins.isBrowserSupported()==2){if(!this.plugins.isOSSupported()){p="ep.player.browser_os_unsupported.message"}else{p="ep.player.browser_unsupported.message"}}else{if(!this.plugins.isOSSupported()){p="ep.player.os_unsupported.message"}}this.showMessageKey(p);return}else{if(!this.plugins.isFlashPlayerInstalled()||!this.plugins.isProtectedPlayerInstalled()){document.location.href=this.messages.getInstallUrl()
}else{if(Prototype.OS.Lion){var t=this.plugins.getFlashPlayerVersion();if(t.major<10||(t.major==10&&(t.minor<2||t.revision<184))){this.showMessageKey("ep.player.flash.plugin_upgrade_error.message")}}}}}else{if(!this.plugins.isFlashPlayerInstalled()){this.fireEvent("cancel");return false}}}var a=Dtv.app.getLoginInfo();if(c.isProtected&&!a.pgwsAuthorized){var r={autoClick:"ctaWatchNow"};Dtv.app.showLoginLightbox(function(){window.location.reloadWithParams(r)},true);this.fireEvent("loginlightboxshown");
return}var s={isProtected:c.isProtected,tmsId:c.tmsId,tmsMask:c.tmsMask,materialId:c.materialId,elementId:c.elementId,sharingEl:c.sharingEl,title:c.title,description:c.description,flashConfig:{playerLocation:c.reportingPlayerLocation||this.getOption("reportingPlayerLocation")||"PD",playerName:c.reportingPlayerName||this.getOption("reportingPlayerName")||"default",playList:{preroll:{url:this._getFullMediaUrl(c.startFrameUrl),scale:CMPVideoScaleModes.SCALEMODE_EXACTFIT},postroll:{url:this._getFullMediaUrl(c.endFrameUrl),scale:CMPVideoScaleModes.SCALEMODE_EXACTFIT},autoPlay:!!o,profile:{accountNumber:(!!Reporting.PageData.accountNumber?Reporting.PageData.accountNumber:Reporting.PageData.prospectAccountNumber),customerType:Reporting.PageData.userType,hardwareSegment:Reporting.PageData.hardwareSegment,premiums:Reporting.PageData.userPremiums,siteType:Reporting.PageData.siteType},mediaConfiguration:{startPoint:c.resumePoint?(parseInt(c.resumePoint)/1000)||0:0},metadata:{title:c.title||null,tmsId:c.tmsId||null,contentGroup:c.reportingContentGroup||this.getOption("reportingContentGroup")||"E",contentType:c.reportingContentType||this.getOption("reportingContentType"),streamingType:c.reportingStreamingType||this.getOption("reportingStreamingType"),premiumNetwork:c.reportingPremiumNetwork||this.getOption("reportingPremiumNetwork")}}}};
var q=c.channelLogoUrl||this.getOption("channelLogoUrl");if(q){s.flashConfig.playList.metadata.providerLogo={url:q,scale:CMPVideoScaleModes.SCALEMODE_EXACTFIT};s.channelLogoUrl=q}if(c.mediaUrl){if(c.mediaUrl.contains(".")){s.flashConfig.playList.mediaConfiguration.urls=[{url:c.mediaUrl.strip(),scale:this.options.scaleMode,metadata:{title:c.title||null,contentGroup:c.reportingContentGroup||this.getOption("reportingContentGroup")||"E",contentType:c.reportingContentType||this.getOption("reportingContentType"),premiumNetwork:this.getOption("reportingPremiumNetwork")}}]
}else{s.flashConfig.playList.mediaConfiguration.tmsId=c.mediaUrl;s.flashConfig.playList.mediaConfiguration.assetId=c.mediaUrl}}else{s.flashConfig.playList.mediaConfiguration.tmsId=c.tmsId;s.flashConfig.playList.mediaConfiguration.assetId=c.materialId||c.tmsId}this.display.loadMedia(s);if(this.playlist){this.playlist.setSelectedIndex(b)}},_getFullMediaUrl:function(a){if(a){if(a[0]=="/"){a=Dtv.app.el.getVar("dtvConfig").cdnBaseUrl+a}}return a||null},_handleMovieTrailerSuccess:function(b){var c=b.responseJSON;
var i;if(c.movieTrailers){for(var d=0;d<c.movieTrailers.length;d++){var a=c.movieTrailers[d];var l=this._getMobileMediaUrlMatchStr();if(a.publishUrl.contains(l)){i=a.publishUrl;break}}if(!i){i=c.movieTrailers[0].publishUrl}window.location.href=i}},_getMobileMediaUrlMatchStr:function(){return Prototype.Browser.IPad?"N0.mp4":"K0.mp4"},getOption:function(b){var a=this.serverOptions[b];return $chk(a)?a:this.options[b]||null},_getStandaloneMediaData:function(){var a=this.options.mediaData||this.el.getVar("mediaData");
if(!a.sharingEl){a.sharingEl=this.el.down(".js-VideoPlayer-mediaSharing")}return a}}};var g={name:"VideoPlayer.Display",options:{swf:"{cmpHostUrl}cinema/apps/CinemaMediaPlayer.swf",expressInstallSwf:"{cmpHostUrl}cinema/apps/playerProductInstall.swf",flashVersion:"10.3",cookieTimer:30,cookieName:"titleTracker"},ctaSource:null,prototype:{_init:function(){this.options.swf=this.options.player.getOption("swf")||this.options.swf;var a=Dtv.app.el.getVar("eportalConfig");if(a){this.options.swf=this.options.swf.replace("{cmpHostUrl}",a.cmpHostUrl);
this.options.expressInstallSwf=this.options.expressInstallSwf.replace("{cmpHostUrl}",a.cmpHostUrl)}this._sharingEl=this.el.down(".js-VideoPlayer-share");this._infoEl=this.el.down(".js-VideoPlayer-Display-Info");this._flashEl=this.el.down(".js-VideoPlayer-Display-Flash");this._textScroller=this.el.down(".js-VideoPlayer-textScroller").behavior("TextScroller");this._cmp=CMP.getInstance();if(this.options.player.options.autoLoad){this.createFlash()}},_initEvents:function(){this.onFlash({mediaPlayerEvent:this._handleMediaPlayerEvent,mediaPlayerErrorEvent:this._handleMediaPlayerErrorEvent,controlBarInfoClick:this._handleControlBarInfoClick,controlBarExpandClick:this._handleExpandClick,controlReplayClick:this.replay},this);
this.onDom(window,"unload",this.destroyFlash.bind(this).ignoreEvent())},createFlash:function(){if(Prototype.Browser.MobileSafari){return false}if(!this._flashId){this._flashLoading=true;var c=new Element("div",{id:"flvvideo_protected_player"}).appendTo(this._flashEl);var a=new Element("div",{id:"flvvideo_player","class":"flash"}).appendTo(this._flashEl);var d=new Element("div",{id:"flvvideo"}).appendTo(a);var b=this.options.swf;if(this.options.swfHttps&&document.location.href.indexOf("https")!=-1){b=this.options.swfHttps
}this._flashId=d.identify();swfobject.embedSWF(b,this._flashId,"100%","100%",this.options.flashVersion,this.options.expressInstallSwf,null,{wmode:"transparent",allowscriptaccess:"always",allowfullscreen:"true"},null);this.debug("Flash object created");return true}return false},saveViewingHistory:function(){if(this.media.isProtected){var a=$H({action:"save",tmsId:this.media.tmsId,materialId:this.media.materialId,position:Math.floor(this._cmp.getMediaPosition()*1000),duration:Math.floor(this._cmp.getMediaDuration()*1000)});
if(this.media.isComplete){a.set("position",a.get("duration"))}new Ajax.Request("/entertainment/data/viewingHistory.jsp?"+a.toQueryString(),{onSuccess:function(b,c){if(c.responseJSON.success){eraseCookie(b.options.cookieName);b._refreshCTA()}}.curry(this)})}},_addDirtyItem:function(a){if(typeof(window.dirtyItems)==="undefined"){window.dirtyItems=new Array()}window.dirtyItems[a]=true},_isDirtyItem:function(a){if(typeof(window.dirtyItems)!=="undefined"&&window.dirtyItems[a]&&window.dirtyItems[a]===true){return true
}else{return false}},_refreshCTA:function(){var m=($$("div.ep-install-details").length>0)?true:false,n=((this.media.flashConfig)&&(this.media.flashConfig.playerLocation==="Utility Bar"))?true:false;if(this.media.flashConfig.playerLocation==="Utility Bar"||this.media.flashConfig.playerLocation==="Infohover"){this._addDirtyItem(this.media.tmsMask)}if(this.media&&this.media.isProtected&&!Prototype.Browser.IsMobile&&!m&&!n){var d=false,l=false,a=null;if(jQuery){jQuery.event.trigger("dtv:ctaupdated")}if(Dtv.app.el.hasClassName("program-details")){var b=$$("div.details-container")[0].getVar("videoData");
l=(b&&b.tmsId)?true:false;d=true;if(l){if(!this.ctaSource.down("a").hasClassName("large-button")){a=this.ctaSource}this.ctaSource=$$("div.details-container")[0]}else{a=this.ctaSource;this.ctaSource=new Element("div")}}if(this.ctaSource){var c=this.ctaSource.innerHTML;new Ajax.Request("/entertainment/data/ctaAjaxState.jsp",{parameters:{programId:this.media.tmsId,isProgDetails:d,isPrimaryStream:l},onSuccess:function(v,w,x,j){var i=(j.responseText.trim()==="Error")?w:j.responseText;v.update(i);if(a!=null){var t=v.down("a.cta-icon-streaming"),k=(Object.isElement(t))?t.down("span").innerHTML:null,u=(t.getVar("videoData")&&t.getVar("videoData").resumePoint)?t.getVar("videoData"):false;
if(!!u){a.down("a.js-ProgramCtaLinks-showVideo").down("span").innerHTML=k;a.down('var[title="videoData"]').update(Object.toJSON(u))}}}.curry(this.ctaSource,c,a),onCreate:function(i){}.curry(this.ctaSource),onException:function(i,j){i.update(j)}.curry(this.ctaSource,c),onFailure:function(i,j){i.update(j)}.curry(this.ctaSource,c)})}}},_storeCurrentPos:function(){if(this._cmpInitialized&&this.media.isProtected){var a=$H({tmsId:this.media.tmsId,materialId:this.media.materialId,position:Math.floor(this._cmp.getMediaPosition()*1000),duration:Math.floor(this._cmp.getMediaDuration()*1000)});
createCookie(this.options.cookieName,a.toQueryString(),false);this._storeCurrentPos.bind(this).delay(this.options.cookieTimer)}},destroyFlash:function(){if(this._flashId){this.saveViewingHistory();this._cmp.shutdownPlayer();this.expandFlash();this._flashId=null;this._flashLoaded=false;this._flashEl.update("&nbsp;");this._cmpInitialized=false;this._infoEl.hide()}},dispose:function($super){this.destroyFlash();$super()},_handleMediaPlayerEvent:function(a){switch(a.code){case CMPEventsCode.PLAYER_LOADED_SUCCESS:this._flashLoaded=true;
this._flashLoading=false;this.fireEvent("swfloaded");if(this.media){this._setMedia()}break;case CMPEventsCode.PLAYER_INITIALIZATION_SUCCESS:this.debug("player initialized");this._cmpInitialized=true;if(this.media){this._setMedia()}break;case CMPEventsCode.MEDIA_DISCONNECTED:case CMPEventsCode.PLAYER_FLASH_STANDALONE_REQUIRED:case CMPEventsCode.PLAYER_FLASH_STANDALONE_AND_PLUGIN_VERSION_MISMATCH:this.destroyFlash();break;case CMPEventsCode.MEDIA_REPLAY_REQUIRED:break;default:this.debug("Failed to load video player",null,"error");
this.fireEvent("mediaerror",a);break}},_handleMediaPlayerErrorEvent:function(a){switch(a.code){case CMPEventsCode.PLAYER_ACTIVATION_NEEDED:this._activationNeeded=true;this._authorize();break;case CMPEventsCode.PLAYER_ALREADY_ACTIVATED_FOR_OTHER_USER:this._cmp.deactivate();break}},_handleControlBarInfoClick:function(){this.shrinkFlash()},_handleExpandClick:function(){this.expandFlash()},onFlash:function(c,a){for(var b in c){this._cmp.addEventListener(b,a?c[b].bind(a):c[b])}},replay:function(){if(this.media.isProtected){this.media.flashConfig.playList.mediaConfiguration.startPoint=0;
this._authorize()}else{}this.expandFlash()},loadMedia:function(a){if(!this._flashLoading&&!this._flashLoaded){this.createFlash()}this.media=a;this._setTitle(a.title);this._setDescription(a.description);this._setLogo(a.channelLogoUrl);this._updateSharing(a.sharingEl);this._authorizationNeeded=false;this._activationNeeded=false;if(a.isProtected){this._authorizationNeeded=true}if(this._flashLoaded){this._setMedia()}},_authorize:function(){this._isAuthorizing=true;var a=this;new Ajax.Request("/entertainment/data/authorizationInfo.json.jsp",{onSuccess:function(b){if(b.responseJSON&&b.responseJSON.authorization){a.media.flashConfig.playList.mediaConfiguration.authorization=b.responseJSON.authorization
}a._isAuthorizing=false;a._authorizationNeeded=false;a.debug("authorization info loaded");if(a._activationNeeded){a._cmp.activate(b.responseJSON.authorization);a._activationNeeded=false}else{if(a._flashLoaded){a._setMedia()}}}})},_setMedia:function(){try{if(this._isAuthorizing){return}if(!this._cmpInitialized){this._cmp.init(this._flashId,this.media.isProtected?CMPMediaPlayerTypes.MEDIA_PLAYER_DRM:CMPMediaPlayerTypes.MEDIA_PLAYER_CLEAR);this.debug("called init() on player")}else{if(this._authorizationNeeded){this._authorize()
}else{this.expandFlash();this.media.isComplete=false;this._cmp.playMedia(this.media.flashConfig);this._storeCurrentPos.bind(this).delay(this.options.cookieTimer)}}Dtv.app.timeoutDisabled=true}catch(a){this.debug(a);throw a}},shrinkFlash:function(){this._infoEl.show();this._cmp.setControlBar(CMPControlBarNames.CONTROLBAR_INSET,CMPVideoScreenModes.SCREENMODE_STANDARD);this.el.removeClassName("flash-hidden").addClassName("flash-inset");this._textScroller.refresh();this._cmp.exitFullScreen()},expandFlash:function(){this._infoEl.hide();
this._cmp.setControlBar(CMPControlBarNames.CONTROLBAR_STANDARD,CMPVideoScreenModes.SCREENMODE_STANDARD);this.el.removeClassName("flash-hidden").removeClassName("flash-inset")},_setTitle:function(a){this.el.down(".js-VideoPlayer-title").update(a)},_setDescription:function(a){this.el.down(".js-VideoPlayer-description").update(a);this._textScroller.refresh()},_setLogo:function(a){var b=a?'<img src="'+a+'" />':"";this.el.down(".js-VideoPlayer-logo").update(b)},_updateSharing:function(a){if(a&&!a.empty()){this._sharingEl.show();
this._sharingEl.update(a.innerHTML);if(window.FB){var c=this._sharingEl.getVar("facebookLike");var b='<fb:like href="'+c+'" layout="button_count" show_faces="true" font="" colorscheme="dark"></fb:like>';this._sharingEl.down("li.facebook").update(b);FB.XFBML.parse(this._sharingEl)}}else{this._sharingEl.hide()}}}};var f={name:"VideoPlayer.Playlist",options:{visibleItems:5},prototype:{_init:function(){if(this.el.hasClassName("colspan-4")){this.options.visibleItems=7}else{if(this.el.hasClassName("colspan-2")){this.options.visibleItems=3
}}this._renderedList=this.el.down(".playlist-items-list").behavior("PreRenderedList",{visibleCount:this.options.visibleItems,orientation:"horizontal",itemOffset:120,infinite:true,fxOptions:{duration:0.4,transition:Effect.Transitions.linear}});this._updateButtons()},_initEvents:function(){this._renderedList.on("indexchanged",this._updateButtons.bind(this));this.onDom(this.el,"click",{".ep-carousel-prev":this._renderedList.moveToPreviousGroup.ignoreEvent(),".ep-carousel-next":this._renderedList.moveToNextGroup.ignoreEvent()},this._renderedList);
this.onDom(this.el,"click",".playlist-items-list li",this._handleItemClick.bind(this))},_updateButtons:function(){var a=this.el.down(".ep-carousel-prev");var b=this.el.down(".ep-carousel-next");if(this._renderedList.getTotalCount()<this.options.visibleItems){a.disable();b.disable()}else{a.enable();b.enable()}},_handleItemClick:function(a,b){this.el.select(".playlist-items-list li.selected").invoke("removeClassName","selected");b.addClassName("selected");var c=b.getVar("mediaData").videoIndex;this.fireEvent("mediaselected",{index:c})
},setSelectedIndex:function(b){if($chk(this.selectedIndex)){var a=this._renderedList.getCurrentListEl().down("li.selected");if(a==null||a.getVar("mediaData").videoIndex!=b){if(a!=null&&a.getSiblingIndex()==this.options.visibleItems-1&&b==this.selectedIndex+1){this._renderedList.moveToNextItem()}else{var c=this._renderedList.getGroupIndex(b);if(c!=this._renderedList.getGroupIndex()){this._renderedList.moveToGroup(c)}}}}this._renderedList.getData().invoke("removeClassName","selected");this._renderedList.getData()[b].addClassName("selected");
this._renderedList.refresh();this.selectedIndex=b},getMediaData:function(b){var c=this._renderedList.getData()[b];var a=c.getVar("mediaData");if(a){a.sharingEl=c.down(".js-VideoPlayer-mediaSharing")}return a},isAtEnd:function(){return this.selectedIndex==this._renderedList.getTotalCount()-1}}};var h={name:"VideoPlayer.MessageContainer",inherits:"MessageContainer",options:{tmsId:null},prototype:{_initEvents:function($super){this.onDom(this.el,"click",{"#flash_update_plugin":function(){CMPPluginDetection.getInstance().downloadFlashPluginInstaller()
},"#flash_update_standalone":function(){CMPPluginDetection.getInstance().downloadFlashStandaloneInstaller()}})},setMessageKeys:function($super,c,b,d,a){d=d||{};switch(b[0]){case"ep.player.install.message":case"ep.player.flash_plugin.message":d.callback=this._updateInstallMessageLink.bind(this);break}$super(c,b,d)},_updateInstallMessageLink:function(a){var b=this.el.down("a");if(b){b.href=this.getInstallUrl()}},getInstallUrl:function(a){return"/entertainment/player/"+(a||this.options.tmsId||"")}}};
Dtv.Behaviors.create(e,g,f,h)})();(function(){var b={name:"SelectionList",consts:{EVENTS:{ITEM_SELECTED:"itemselected",ITEM_UNSELECTED:"itemunselected"}},options:{maxSelections:1,selectionRequired:false,autoUnselect:true,cacheItems:true,initialSelections:null,className:"selected",endless:true,selectOnClick:true,itemTagName:"li"},prototype:{enabled:true,_initEvents:function(){this.onDom(this.el,"macro:click",this.el.tagName=="TABLE"?"tr":this.options.itemTagName,this._handleItemClick.bind(this))},_initDefaultState:function(){if(this.options.initialSelections||this.options.selectionRequired){var a=this.getItems();
this.selectItems(a.length>0?this.options.initialSelections||(this.options.selectionRequired?[0]:[]):[])}},_handleItemClick:function(d,a){this.selectItem(a)},getItems:function(){if(this.options.cacheItems&&!!this._items){return this._items}return this._items=(this.el.tagName=="TABLE")?this.el.select("tr"):this.el.childElements()},getSelectedItems:function(){var f=this.getItems();var a=[],e=this.options.className;f.each(function(c){if(c.hasClassName(e)){a.push(c)}});return a},updateCache:function(){if(this.options.cacheItems){this._items=this.el.childElements()
}},isItemSelected:function(a){return this._getItem(a).hasClassName(this.options.className)},toggleItem:function(a){if(!this._selectItem(a)){this.unselectItem(a)}},selectItem:function(i,j){if(!this.enabled){return false}var m=this.getItems();if(m.length==0){throw"Cannot select item when items list is empty"}var n=this._getIndex(i);if(!n&&this.options.selectionRequired){n=0}var k=n==null?null:this._getItem(n,m);if(j){return this._selectItem(k)}else{var a=true,l=false;this.getSelectedItems().each(function(c){if(c==k){a=false
}else{if(this.unselectItem(c)){l=true}}}.bind(this));return a&&k!=null?this._selectItem(k)||l:l}},_selectItem:function(f){var a=this._getIndex(f);var g=this._getItem(f);if(!g){return false}if(!this.isItemSelected(g)){var h=this.getSelectedItems();if(h.length==this.options.maxSelections){if(this.options.autoUnselect){this.unselectItem(h[0])}else{return false}}g.addClassName(this.options.className);this.fireEvent(this.EVENTS.ITEM_SELECTED,{item:g,itemIndex:a});this.lastSelectedIndex=a;return true}return false
},selectItems:function(a,d){if(!this.enabled){return false}if(!d){this.clearSelection()}a.each(function(c){this.selectItem(c,true)}.bind(this))},selectRange:function(e,a,f){if(!this.enabled){return false}this.debug("Not Yet Implemented")},selectPrevious:function(){if(!this.enabled){return false}var a=this.getSelectedItems();if(a.length==1){var d=a[0].getSiblingIndex();if(d>0){return this.selectItem(d-1)}else{if(this.options.endless){return this.selectItem(this.getItems().length-1)}}}return false},selectNext:function(){if(!this.enabled){return false
}var a=this.getSelectedItems();if(a.length==1){var d=a[0].getSiblingIndex();if(d<this.getItems().length-1){return this.selectItem(d+1)}else{if(this.options.endless){return this.selectItem(0)}}}return false},unselectItem:function(e){if(!this.enabled){return false}var a=this._getIndex(e);var f=this._getItem(e);if(this.isItemSelected(f)){f.removeClassName(this.options.className);this.fireEvent(this.EVENTS.ITEM_UNSELECTED,{item:f,itemIndex:a});return true}return false},clearSelection:function(a){if(!this.enabled){return false
}a=a||this.getSelectedItems();if(a.length==0){return false}a.invoke("removeClassName",this.options.className);return true},getSelectionSiblingIndex:function(a){var d=this.getSelectedItems();if(d.length>a){return d[a].getSiblingIndex()}return null},_getItem:function(d,a){return Object.isElement(d)?d:(a||this.getItems())[d]},_getIndex:function(a){return Object.isNumber(a)?a:Object.isElement(a)?a.getSiblingIndex():null}}};Dtv.Behaviors.create(b)})();(function(){var h={ORIENTATION:{VERTICAL:"vertical",HORIZONTAL:"horizontal"}};
var f={name:"ListScroller",consts:h,options:{orientation:"horizontal",endless:false,scrollbar:".js-scrollbar",nextBtn:".js-next-btn",prevBtn:".js-previous-btn",listOptions:{effectDuration:0.3},scrollbarOptions:{}},prototype:{_init:function(){var a=this._getScrollContainer();this._scrollableList=a.behavior("ScrollableList",$extend(this.options.listOptions,{endless:this.options.endless,orientation:this.options.orientation,nextBtn:this._getBySelector(this.options.nextBtn),prevBtn:this._getBySelector(this.options.prevBtn)}));
this._selectionList=a.behavior("SelectionList",{endless:this.options.endless});var b=this._getBySelector(this.options.scrollbar);if(b){this._scrollbar=b.behavior("ScrollableListScrollBar",$extend(this.options.scrollbarOptions,{list:this._scrollableList,orientation:this.options.orientation,animate:false}))}},_initEvents:function(){this.onDom(this._scrollableList.el,{"macro:swipeleft":this._handleSwipeLeft,"macro:swiperight":this._handleSwipeRight},this)},_handleSwipeRight:function(){this._scrollableList.navigateToPrevious()
},_handleSwipeLeft:function(){this._scrollableList.navigateToNext()},_getBySelector:function(a){return a?this.el.down(a):null},_getScrollContainer:function(){return this.el.down("ul")}}};var g={name:"ChannelScroller",inherits:"ListScroller",prototype:{_initEvents:function($super){$super();this._selectionList.on(Dtv.Behaviors.SelectionList.EVENTS.ITEM_SELECTED,this._onItemSelected.bind(this))},_initInfoPop:function(){this._infoPop=Element.behavior(this.el.down(".js-infopop").down(),Dtv.Behaviors.Lightbox,{relElement:this.el,modal:false,hideOnBlur:true,hideOnClick:true,width:428});
this._infoPop.on(Dtv.Behaviors.Lightbox.EVENTS.HIDE,this._onInfoPopHide.bind(this))},_onItemSelected:function(a){var b=a.memo.item.down(".js-details-content");if(!b){return}this._showInfoPop(b.toHTML())},_showInfoPop:function(a){if(!this._infoPop){this._initInfoPop()}if(this._infoPop.visible()){this._infoPop.ignoreNextBlur=true}this._infoPop.setContent("body",a);this._infoPop.show()},_onInfoPopHide:function(){this._selectionList.clearSelection()}}};var e={name:"TextScroller",options:{dynamicHandleSize:false},prototype:{_init:function(){this._contentEl=this.el.down(".js-TextScroller-content");
this._scrollbarEl=this.el.down(".js-TextScroller-scrollbar");this.refresh()},_handleScrollChange:function(a){var b=Math.ceil(this.scrollHeight*this._scrollbar.value*-1);this._contentEl.setStyle({top:b+"px"})},refresh:function(){this.scrollHeight=this._contentEl.getHeight()-this._scrollbarEl.getHeight();if(this._scrollbar){this._scrollbar.dispose();this._scrollbarEl.update();this._scrollbar=null}if(this.scrollHeight>0){this.el.addClassName("has-scrollbar");this.scrollHeight=this._contentEl.getHeight()-this._scrollbarEl.getHeight();
this._scrollbar=this._scrollbarEl.behavior("ScrollBar",{orientation:"vertical",steps:Math.ceil(this.scrollHeight/10),smoothScroll:true,dynamicHandleSize:this.options.dynamicHandleSize});this._scrollbar.addDisposableObj(this._scrollbar.on("change",this._handleScrollChange.bind(this)))}else{this.el.removeClassName("has-scrollbar");this._contentEl.setStyle({top:0})}},isScrollbarVisible:function(){return this.scrollHeight>0}}};Dtv.Behaviors.create(f,g,e)})();
/*!
 * Tooltip code based on http://www.wildbit.com/labs/cooltips/ by Andrew Okonetchnikov.  Licensed under the MIT license.
 *
 * Copyright (c) 2006-2007 Andrey Okonetchnikov
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR
 * ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
 * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
(function(){var c={name:"GenericRollover",maxInstances:1,prototype:{_init:function(){this._overlayEl=new Element("div",{id:"rollover_overlay"}).setStyle({position:"absolute",zIndex:10001}).appendTo(document.body)
},_initEvents:function(){this.onDom(document.body,{mouseover:this._handleBodyMouseOver,mousemove:this._handleBodyMouseMove},this);var a=this.hide.bind(this);this.onDom(document,{"dtv:screendisabled":a,"dtv:screenenabled":a,DOMMouseScroll:a,mousewheel:a,mouseleave:a});this.onDom(this._overlayEl,"touchstart",a)},_handleBodyMouseOver:function(a){var b=a.findElement(".js_rollover");if(b){if(!!b.supressRollover||(!!b.disabled&&b.hasClassName("js_rollover_ignore_disabled"))||(Prototype.Browser.MobileWebKit&&b.hasClassName("js_rollover_ignore_touch"))){this.hide()
}else{this.show(b);this._updatePosition(a)}}else{if(this.currentOpener&&this.currentOpener.hasClassName("js_manual_rollover")&&a.findElement(".js_manual_rollover")){}else{if(this._fx&&!a.findElement("#rollover_overlay")){this.hide()}}}},_handleBodyMouseMove:function(a){if(this._fx){this._updatePosition(a)}},show:function(f,b){if(!f._rolloverEl){this._setRollover(f,b,"js_manual_rollover");if(!f._rolloverEl){return}}else{if(b&&f._rolloverEl!=b){f._rolloverEl=b}else{if(this.currentOpener==f){return}}}this.currentOpener=f;
var a=new Element("div").appendTo(document.body).update(f._rolloverEl.toHTML());a.down().show();if(this._fx){this._fx.cancel()}this._overlayEl.update(a.innerHTML).setStyle({width:a.down().getWidth()+10+"px"}).hide();this._fx=new Effect.Appear(this._overlayEl,{duration:0,delay:0.4});a.remove()},hide:function(){this.currentOpener=null;if(this._fx){this._fx.cancel();this._fx=null}this._overlayEl.hide()},_updatePosition:function(b){var o=this._overlayEl.down();if(o){var p=this._overlayEl.visible();this._overlayEl.show();
var m=new Element.Layout(o);var e=10;var n=m.get("width");var l=Event.pointerX(b)+e;var a=Math.max(0,(l+n)-document.viewport.getWidth())+e;this._overlayEl.setStyle({left:l-a+"px",top:Event.pointerY(b)-e-m.get("height")+"px"});if(!p){this._overlayEl.hide()}}else{this.debug("Could not update position - no content to update",null,"warn")}},addRolloverToEl:function(a,b){if(a.hasClassName("js_rollover")){return false}a.addClassName("js_rollover");a.innerHTML+='<div class="dtv-rollover-tup" style="display:none"><div class="dtv-rollover"><span class="dtv-rollover-content">'+b+"</span></div></div>";
return true},setRollover:function(b,a){if(this.currentOpener==b){this.hide()}if(a){a=$(a);if(!a){this.debug("rolloverEl was not found",null,"warn")}}if(a){this._setRollover(b,a)}else{b._rolloverEl=null;b.removeClassName("js_rollover")}},_setRollover:function(b,a,f){if(!a){a=b.title?$(b.title):b.down(".dtv-rollover-tup");if(!a){this.debug(b.toHTML(),"js_rollover element moused over but content could not be found","warn");return}}else{a=$(a)}$A(b.select("img")).each(function(e){e.alt=""});b.title="";
b._rolloverEl=a;if(!b.hasClassName("js_rollover")){b.addClassName(f||"js_rollover")}}}};var d={name:"BusinessInfoPop",maxInstances:1,prototype:{_init:function(){this.lightbox=this.el.behavior("Lightbox",{modal:false,positioning:Dtv.Behaviors.Lightbox.POSITIONING.AROUND,effectDuration:0.2,zIndex:10003,contentSelectors:{body:"div.js-infopop-content"},hideOnClick:true})},_initEvents:function(){this.onDom(document,Dtv.Event.SCREEN_DISABLED,this.lightbox.hide.bind(this.lightbox));this.onDom(document,"macro:click",this._onBodyClick.bind(this));
this.lightbox.on("hide",this._onLightboxHide.bind(this))},_onLightboxHide:function(a){this.currentOpener=null},_onBodyClick:function(a){var e=a.findElement(".js-infopop-opener");if(!e||e==this.currentOpener){if(a.element().ancestors().indexOf(this.lightbox.el)==-1){this.hide()}return}var b=a.findElement("a");if(b&&b!=e){return}var j=e.getVar("infopop");if(j){var i=j.id?$member($(j.id),"innerHTML"):j.text||j.html.unescapeHTML();if(!i){this.debug(e,"Skipped info pop: missing content");return}this.open(e,i)
}},open:function(a,b){this.currentOpener=a;this.lightbox.setContent("body",b);this.lightbox.relElement=a;this.lightbox.show()},hide:function(){this.lightbox.hide()}}};Dtv.Behaviors.create(c,d)})();(function(){var e={LAYOUT_HTML:'<div class="track"><div class="start"></div><div class="end"></div></div><div class="handle"><div class="start"></div><div class="end"></div></div>',EVENTS:{CHANGE:"change",UPDATE:"update"},ORIENTATION:{VERTICAL:"vertical",HORIZONTAL:"horizontal"}};var f={name:"ScrollBar",consts:e,options:{orientation:e.ORIENTATION.HORIZONTAL,steps:0,animate:false,smoothScroll:false,range:null,values:null,dynamicHandleSize:true},prototype:{_init:function(){this.el.update(this.LAYOUT_HTML);
this.el.addClassName(this.options.orientation==e.ORIENTATION.HORIZONTAL?"scrollbar-h":"scrollbar-v");this._track=this.el.down();this._handle=this._track.next();this.setSteps(this.options.steps)},_initSlider:function(){try{this._slider=new Control.Slider(this._handle,this._track,{axis:this.options.orientation,range:!this.options.smoothScroll?$R(0,this.getSteps()-1):this.options.range,values:!this.options.smoothScroll?$R(0,this.getSteps()-1):this.options.values,onSlide:this._onSliderChange.bind(this),onChange:this._onSliderChange.bind(this),animate:this.options.animate})
}catch(a){this.debug(a,"_initSlider() failed")}},_onSliderChange:function(){if(this._slider.value!=this.value){this.value=this._slider.value;if(this._onChange){this._onChange()}this.fireEvent(this.EVENTS.CHANGE,{value:this.value,scrollbar:this})}},_updateHandleSize:function(b){var c=(this.options.orientation==e.ORIENTATION.HORIZONTAL?this.el.getWidth():this.el.getHeight())/b;var a={};a[this.options.orientation==e.ORIENTATION.HORIZONTAL?"width":"height"]=Math.max(c,20)+"px";this._handle.setStyle(a)
},getSteps:function(){return this._steps},setSteps:function(b,c){try{if($chk(b)&&this.getSteps()==b){return false}if(this._slider){this._slider.dispose();this._slider=null}this._steps=$chk(b)?b:this._steps;if(this.getSteps()>1){this.el.show();if(this.options.dynamicHandleSize){this._updateHandleSize(c||b)}this._initSlider()}else{this.el.hide()}return true}catch(a){this.debug(a,"setSteps() failed")}},getValue:function(){return this._slider?this._slider.value:null},scrollToValue:function(a){if(!this._slider){return
}this._slider.setValue(a)},scrollToStart:function(){if(!this._slider){return}this.scrollToValue(0)},scrollToEnd:function(){if(!this._slider){return}this.scrollToValue(this.getSteps()-1)},scrollToOffset:function(a){if(!this._slider){return}var b=this.getValue()+a;var c=this.getSteps()-1;this.scrollToValue(b<0?0:b>c?c:b)}}};var d={name:"ScrollableListScrollBar",inherits:"ScrollBar",options:{indexMultiplier:4,list:null},prototype:{_init:function($super){if(!this.options.list){throw"ScrollableListScrollBar must be initialized with a valid list option value."
}$super();this.update()},_initEvents:function(){this.options.list.on(Dtv.Behaviors.NavigableList.EVENTS.NAV_INDEX_CHANGED,this.update.bind(this));this.options.list.on(Dtv.Behaviors.NavigableList.EVENTS.UPDATED,this.update.bind(this))},_onChange:function(){if(this._ignoreUpdate){return}this._ignoreUpdate=true;this.options.list.navigateToIndex(this._valueToNavIndex(),this._getOffset(),null,true);this._ignoreUpdate=false},update:function(){try{if(this._ignoreUpdate){return}this._ignoreUpdate=true;var b=this.options.list.getIndexCount();
this.setSteps(((b-1)*this.options.indexMultiplier)+1,b);this.scrollToValue(this._navIndexToValue());this._ignoreUpdate=false;this.fireEvent(e.EVENTS.UPDATE)}catch(a){this.debug(a,"update() failed")}},_valueToNavIndex:function(a){return Math.floor((a||this.value)/this.options.indexMultiplier)},_navIndexToValue:function(a){return(a||this.options.list.getNavIndex())*this.options.indexMultiplier},_getOffset:function(){var b=this._valueToNavIndex();var a=this.options.list.getNavOffset(b);var c=(this.value/this.options.indexMultiplier)-b;
if(c>0){var h=this.options.list.getNavOffset(b+1);a+=(h-a)*c}return a}}};Dtv.Behaviors.create(f,d)})();(function(){var b={name:"HeaderSlider",maxInstances:1,prototype:{_init:function(){this._list=$("slider_thumbs").behavior("PreRenderedList",{visibleCount:3,infinite:true,updateDelay:0,fxOptions:{duration:0.3,transition:Effect.Transitions.Pow.easeOut.custom(2)}});this.serverOptions=this.el.getVar("serverOptions");this._indicatorEl=this.el.down(".slider-indicator");this._bgContainerEl=$("ctl_slideshow_bg");
this._slideIndex=0;this._pollMbox()},_initEvents:function(){if(this._list.getTotalCount()>2){this.onDom(this.el,"click",{".slider-hotspot-1":this.moveSlider.bind(this,-1),".slider-hotspot-2":this.moveSlider.bind(this,1)})}else{if(this._list.getTotalCount()==2){this.onDom(this.el,"click",{".slider-hotspot-1":this.activate.bind(this,0),".slider-hotspot-2":this.activate.bind(this,1)})}}this._list.on({updated:this._handleListUpdated},this);this.onDom(this.el,"click",this.cancelAutoPlay.bind(this))},_initDefaultState:function(){this._loadSlide(this._list.getTotalCount()>2?1:0)
},moveSlider:function(a){if(a>0){this._list.moveToNextItem()}else{this._list.moveToPreviousItem()}},cancelAutoPlay:function(){this.serverOptions.autoPlay=false;clearTimeout(this._delayTimeout)},activate:function(a){if(this._currentFx){this._currentFx.cancel()}$("header_slider").down(".slider-hotspot-1").removeClassName("active");$("header_slider").down(".slider-hotspot-2").removeClassName("active");this._currentFx=new Effect.Morph(this._indicatorEl,{style:"top:"+((a*88)-90)+"px",duration:0.3,transition:Effect.Transitions.Pow.easeOut.custom(3),afterFinish:function(d){this._loadSlide(d);
$("header_slider").down(".slider-hotspot-"+(d+1)).addClassName("active")}.bind(this,a)})},_loadSlide:function(a){var m=this._list.getData()[a];var r=m.getVar("slideData");if(!this._bgContainerEl.down(".slide-"+a)){var l=new Element("b").addClassName("slide slide-"+a).setStyle({backgroundImage:"url("+r.url+")"}).appendTo(this._bgContainerEl)}else{if(this._bgContainerEl.down(".slide-"+a).src!=r.url){this._bgContainerEl.down(".slide-"+a).src=r.url}}this._bgContainerEl.down(".slide-"+a).addClassName("active").setStyle({opacity:0,zIndex:this._slideIndex++}).appear({duration:0.25});
if(this._programTitleEl){this._programTitleEl.remove();this._programTitleEl=null}var q=m.down("div.js-HeaderSlider-programTitle");if(q){var p="program_title_module";var n=$(p);if(n){n.remove()}this._programTitleEl=q.clone(true).appendTo("ctl_header_content").show();this._programTitleEl.id=p}$("header_slide_overlay_container").update('<div id="header_slide_overlay"></div>');try{var t=m.getVar("overlay");if(t){t()}}catch(o){this.debug(o)}$("header_slide_legal").update(m.getVar("legal"));if(this.serverOptions.autoPlay&&!Dtv.cancelHeaderSliderAutoPlay){var s=r.delayInterval||this.serverOptions.delayInterval;
this._delayTimeout=this._autoPlay.bind(this,a).delay(s)}this.fireEvent("slideloaded",{slideEl:m,slideData:r})},_autoPlay:function(a){this._list.getTotalCount()>2?this.moveSlider(1):this.activate(a==0?1:0);this.fireEvent("autoplay")},_handleListUpdated:function(d){var a=this._list.currentIndex+1;if(a>=this._list.getTotalCount()){a=0}this._indicatorEl.appear({duration:0.4});this._loadSlide(a)},_pollMbox:function(){this._pollCount=0;var d=null;var a=setInterval((function(){if(this._pollCount<50){var j=$("mboxSlideData");
d=j?j.down("li"):null;if(d){clearInterval(a);var l="slide-0";if(d.className.indexOf("slide-")!=-1){l=d.className.substr(d.className.indexOf("slide-"),7)}for(var k=0;k<this._list.getData().length;k++){var i=this._list.getData()[k];if(i.hasClassName(l)){this._list.getData()[k]=d;this._list.refresh();var c=this._list.currentIndex;if(this._list.getTotalCount()>2){c++}if(c==k){this._loadSlide(k)}break}}}this._pollCount++}else{clearInterval(a)}}).bind(this),100)}}};Dtv.Behaviors.create(b)})();(function(){var f={SELECTORS:{AJAX_LINK:".js-order-module-ajax",DIRTY_AWARE:".js-dirty-aware",CONTENT_AREA:".js-order-module-content",ERRORS_AREA:".js-order-module-errors",CALLOUT_IMAGE:".js-om-callout-image",CALLOUT_TRIGGER:".js-om-callout-update"}};
function h(b,a){b.select("a, input").each(function(c){c.disabled=a})}var g={name:"OrderModule",prototype:{_init:function(){this.contentArea=this.el.down(f.SELECTORS.CONTENT_AREA);this.errorArea=this.el.down(f.SELECTORS.ERRORS_AREA);this.calloutImage=this.el.down(f.SELECTORS.CALLOUT_IMAGE);this.pricingCalloutList=this.el.getVar("pricingCalloutList");this.defaultCalloutImage=this.el.getVar("defaultCalloutImage");this.lightbox=new Element("div",{"class":"js-lightbox"}).behavior("CartFlyout");this.el.select(f.SELECTORS.AJAX_LINK).each(function(c){var d=c.up("form");
var b=new Dtv.FormController(d,{disableFormOnSuccess:false,onSubmitSuccess:this._handleSubmitCartSuccess.bind(this),onSubmitFailure:this._handleSubmitCartFailure.bind(this)});var a=b.getDefaultTrigger();if(a.hasClassName("disabled")){a.disable()}if(d.match(f.SELECTORS.DIRTY_AWARE)){b.on("change",function(j){b.getDefaultTrigger()[(b.isDirty()?"en":"dis")+"able"]()})}},this);this.queryParams=document.location.href.toQueryParams();this.selectedIndex=((this.queryParams.selectedIndex)?this.queryParams.selectedIndex:0);
this.loginSuccessUrl=this.el.down('input[name="loginSuccessUrl"]');this.orderModuleId=this.el.getVar("orderModuleId");this._updateLoginSuccessUrl()},_initLayout:function(){var a=this.el.down(".ctm-omod-promo img");if(a){pngFix(a)}var b=0;if(this.el.down(".ctm-omod-action-set .js-cta-btn")){this.el.select(".js-cta-btn span").each(function(c){if(c.offsetWidth>b){b=c.offsetWidth}});this.el.select(".js-cta-btn span").each(function(c){c.style.width=b+"px"})}},_initEvents:function(){var a=this;this.el.select(f.SELECTORS.CALLOUT_TRIGGER).each(function(b,c){if(b.match('input[type="radio"]')){b.observe("click",a._selectOption.bind(a,c));
if(a.queryParams.selectedIndex==c){b.checked=true}if(b.checked){a._selectOption(c)}}else{if(b.match("select")){b.observe("change",a._selectOptionFromSelect.bind(a,b));if(a.queryParams.selectedIndex){b.selectedIndex=a.queryParams.selectedIndex}if(b.selectedIndex!=0){a._selectOptionFromSelect(b)}}}});this.el.select("a.js-submit").invoke("observe","click",this._handlePixelReporting);this.onDom(this.el,"click",{"a.js-OrderModule-link":this._handleLinkClick},this)},_initDefaultState:function(){if(this.queryParams.orderModuleId&&this.queryParams.orderModuleId==this.orderModuleId&&this.queryParams.selectedIndex){Dtv.FormController.apply(this.el.down("form")).submit()
}},_handleSubmitCartSuccess:function(b,c){try{if(c.cep){Dtv.Cep.handleCepodFormClickSuccess(b,c)}else{if(c.lightboxUrl){if(c.lightboxUrl.indexOf("/DTVAPP/new_customer/lightbox/lightboxReceivers.jsp")>-1){var a=c.lightboxUrl.replace("/new_customer/lightbox/lightboxReceivers.jsp","/new_customer/receivers.jsp");window.location.href=a}else{Dtv.Behaviors.CartFlyout.showAsLightbox(c)}}else{if(c.redirectUrl){h(this.el,true);window.location.href=c.redirectUrl}else{if(c.reload){window.location.reload(true)
}}}}}catch(d){this.debug(d)}},_handlePixelReporting:function(a){if(this.rel.indexOf("order_module_submit_101670_2")!=-1){DIRECTV.PixelManager.clickSpotlight({src:"2558160",type:"nflsuntx",cat:"stixnew"})}if(this.rel.indexOf("order_module_cust_submit_101670_2")!=-1){DIRECTV.PixelManager.clickSpotlight({src:"2558160",type:"nflsuntx",cat:"stixcur"})}return},_handleSubmitCartFailure:function(a,b){if(this.contentArea&&this.errorArea){this.contentArea.hide();this.errorArea.show()}},_handleLinkClick:function(a,c){var d=c.href;
if(d.length>0){if(d.charAt(d.length-1)=="/"){d=document.location.href}if(d.charAt(d.length-1)!="="){d+=((d.indexOf("?")==-1)?"?":"&")}}var b=this.el.down('input[name="selectedSku"]');if(b){d+=b.value}else{b=this.el.down('select[name="selectedSku"]');if(b){d+=b.options[b.selectedIndex].value}else{this.el.select('input[type="radio"]').each(function(i){if(i.checked&&i.match('input[name="selectedSkuRadio"]')){d+=i.value;throw $break}})}}window.location.href=d},_selectOptionFromSelect:function(a){this._selectOption(a.selectedIndex)
},_selectOption:function(a){this.selectedIndex=a;this._updateLoginSuccessUrl();this.calloutImage.src=((this.pricingCalloutList[a])?(this.pricingCalloutList[a]):this.defaultCalloutImage)},_updateLoginSuccessUrl:function(){if(!this.loginSuccessUrl){return}var a=document.location.href.toQueryParams();a.orderModuleId=(this.orderModuleId?this.orderModuleId:"");a.selectedIndex=(this.orderModuleId?this.selectedIndex:"");this.loginSuccessUrl.value=document.location.pathname+"?"+$H(a).toQueryString()}},actionAdapters:{handleLink:function(a,b){this.handleLink(b.href)
}}};var e={name:"instantActivation",autoMapping:"js-order-instant-activation",prototype:{authorized:false,maxTries:20,currentTry:0,interval:15,tmsId:"",iaResponseObj:{},handleResponse:function(a){if(a.responseJSON&&a.responseJSON.authorized&&a.responseJSON.authorized===true){this.iaResponseObj.authorized=true}},queryAuth:function(a){var b="/entertainment/data/authCheck.json.jsp?programid="+this.tmsId,c=new Dtv.RequestManager({useCaching:false});c.request(b,{timeout:3000,onSuccess:this.handleResponse.bind(a)})
},getValidation:function(){var a=null;if(typeof(this.currentTry)=="undefined"){a=this.Dtv.Behaviors.instantActivation.definition.prototype}else{a=this}if(a.iaResponseObj&&a.iaResponseObj.authorized){window.location.reload()}if(!a.authorized&&a.currentTry<a.maxTries){a.queryAuth(a);a.currentTry++;setTimeout(a.getValidation,a.interval*1000)}},_init:function(){this.tmsId=$("ctl_area_b").getVar("tmsId");this.queryAuth(this);this.getValidation()}}};Dtv.Behaviors.create(g);Dtv.Behaviors.create(e)})();var holder=null;
var holderInvoker=null;var dtvImage=Class.create();dtvImage.prototype={initialize:function(){},fileName:"",format:"",loaded:false,photo:new Image(),width:0,height:0,spinner:"",scaleH:0,description:"",elem:"",forceClear:function(){var b=new Image();this.photo=b},_updateSize:function(){this.width=this.width;this.height=this.height;this.loaded=true;this._updateLayout()},_updateLayout:function(){if(Object.isElement(this.elem)){this.elem.hide();this.elem.setStyle({width:this.getWidth()+"px",height:this.scaleH+"px"});
this.elem.show()}},_updateImg:function(){if(this.photo==null||this.photo.src!=this.fileName){this.forceClear();var b=new Image();b.onload=this._updateSize.bind(this);b.src=this.fileName;this.photo=b}},ratio:function(){if(this.width>this.height){return("landscape")}else{return("portrait")}},getRealHeight:function(){this._updateImg();return(this.photo.height)},getRealWidth:function(){this._updateImg();return(this.photo.width)},getWidth:function(){var b=0;if(this.ratio()=="landscape"){b=Math.round((this.scaleH/3)*4)
}else{b=Math.round((this.scaleH/4)*3)}return(b)},wait:function(){this.photo.src=this.spinner}};(function(){var c={name:"photoInPage",autoMapping:"in-page-gallery",options:{imageList:[],autoAdvance:"false",delay:5,disableLightBox:"false",galleryTitle:"",transitionSpeed:0.4,orientation:"Horizontal"},prototype:{_totalCount:0,_currentIndex:0,_elRef:null,_groupWidth:0,_containerWidth:0,_containerHeight:0,_firstOffset:1,_initialPos:0,_adjustedPos:0,_posSet:false,_scrolling:false,_posImg:[],flags:{pos:[]},_adjustCurtains:function(){var l=this._currentIndex;
l--;if(l==-1){l=this.options.imageList.length-1}var a=this.el.down("div.transparent-layer");var i=this.el.down("div.layer-right");var j=Math.round((this._containerWidth-this.options.imageList[this._currentIndex].getWidth())/2);var k=this._containerWidth-j;var b=this._containerWidth-(j+this.options.imageList[this._currentIndex].getWidth());a.setStyle({width:j+"px"});i.setStyle({width:b+"px",left:k+"px"});this._elRef.down("div",4).down("div").setStyle({left:(j-46)+"px"})},_refer:function(a){holderInvoker=this.behaviorName;
holder=this},show:function(){this._elRef=this.el.down("div");var C=this._elRef.down("ul").childElements("li");this._containerWidth=this._elRef.down("div.photo-container").getDimensions().width;this._containerHeight=this._elRef.down("div.photo-container").getDimensions().height;var A=this._elRef.getVar("serverOptions");var F=[A][0];this.options.autoAdvance=F.autoAdvance;this.options.delay=F.delay;this.options.disableLightBox=F.disableLightBox;this.options.galleryTitle=F.moduleTitle;if(this.options.delay.length==0){this.options.delay=5
}var a=new Array();var x=(this._containerHeight/2)-30;for(var v=0;v<C.length;v++){var E=new dtvImage();E.fileName=C[v].down("img").readAttribute("src");E.description=C[v].getVar("description");E.height=C[v].down("img").getDimensions().height;E.width=C[v].down("img").getDimensions().width;E.scaleH=this._containerHeight;this.options.imageList[v]=E;if(C[v].down("img").hasClassName("Horizontal")){E.width=(this._containerHeight/3)*4}else{E.width=(this._containerHeight/4)*3}this._posImg[v]=this._groupWidth;
this._groupWidth+=E.getWidth();this._totalCount++;C[v].down("img").setStyle({width:E.getWidth()+"px"});if(this.options.disableLightBox===false){var i=new Element("span");var j=(E.width/2)-30;i.setStyle({left:j+"px",top:x+"px"});C[v].insert({top:i})}}if(this._totalCount>0){this._elRef.down("div",3).down("ul").setStyle({width:(this._groupWidth*3)+"px"});for(var y=0;y<2;y++){for(var v=0;v<C.length;v++){var b=new Element("li");var w=new Element("img",{src:this.options.imageList[v].fileName});var z=null;
w.setStyle({width:this.options.imageList[v].getWidth()+"px"});if(this.options.disableLightBox===false){z=new Element("a");z.observe("click",this._refer.bind(this));z.addClassName("js-CMSModule-showPhotoLightbox");var i=new Element("span");var j=Math.round((this.options.imageList[v].getWidth()/2)-30);var x=(this._containerHeight/2)-30;i.setStyle({left:j+"px",top:x+"px"});z.insert(i);z.insert(w);b.insert(z)}else{b.insert(w)}this._elRef.down("div",3).down("ul").insert(b)}}this._changeDescription(0);
var B=Math.round((this._containerWidth-this.options.imageList[0].width)/2);var u=Math.round((this._containerWidth-this.options.imageList[0].getWidth())/2);var D=B+this.options.imageList[0].width;this._elRef.down("div",1).setStyle({height:this._containerHeight+"px",width:B+"px"});this._elRef.down("div",4).setStyle({height:this._containerHeight+"px",width:B+"px",left:Math.round(D)+"px"});this._elRef.down("div",4).down("div").setStyle({left:(u-46)+"px",top:((this._containerHeight/2)-28)+"px"});this._elRef.down("div",1).down().setStyle({top:((this._containerHeight/2)-28)+"px"});
this._elRef.down("div",1).observe("click",this._goBackward.bind(this));this._elRef.down("div",4).observe("click",this._goForeward.bind(this));this._initialPos=((this._groupWidth-B)*-1);this._elRef.down("div",3).down("ul").setStyle({left:this._initialPos+"px"});if(this.options.autoAdvance=="true"){new PeriodicalExecuter(this._goForeward,this.options.delay)}this.el.setStyle("display:block")}else{this.remove()}},_init:function(){this.show()},_changeDescription:function(a){var b=(a+1)+" of "+this._totalCount;
this._elRef.down("div",6).down().update(this.options.imageList[a].description);this._elRef.down("div",6).down("div",1).update(b)},_navigate:function(b){if(!this._scrolling){if(!this._posSet){var i=0;for(var k=0;k<this.options.imageList.length;k++){this._posImg[k]=i;i+=this.options.imageList[k].getWidth()}}this._scrolling=true;var l=0;var n=this._currentIndex+1;var m=this._currentIndex-1;var a=true;if(n==this.options.imageList.length){n=0;if(b=="foreward"){a=false}}if(m==-1){m=this.options.imageList.length-1;
if(b!="foreward"){a=false}}if(b=="foreward"){this._changeDescription(n);l=((this._groupWidth+this._posImg[n])-((this._containerWidth-this.options.imageList[n].getWidth())/2))*-1;if(a){this._adjustedPos=l}else{this._adjustedPos=l;l-=this._groupWidth}this._currentIndex++;if(this._currentIndex==this.options.imageList.length){this._currentIndex=0}}else{this._changeDescription(m);l=((this._groupWidth+this._posImg[m])-((this._containerWidth-this.options.imageList[m].getWidth())/2))*-1;if(a){this._adjustedPos=l
}else{this._adjustedPos=l;l+=this._groupWidth}this._currentIndex--;if(this._currentIndex==-1){this._currentIndex=this.options.imageList.length-1}}new Effect.Move(this._elRef.down("div",3).down("ul"),{x:l,y:0,duration:this.options.transitionSpeed,mode:"absolute",afterFinish:this._repos.bind(this)})}},_repos:function(){this.el.down("ul").setStyle({left:(this._adjustedPos)+"px"});this._adjustCurtains();this._scrolling=false},_goForeward:function(){this._navigate("foreward")},_goBackward:function(){this._navigate("backward")
}}};var d={name:"photoCarousel",autoMapping:"photo-carousel",options:{delimiterSpace:2,tmsId:"",maxWidth:582,itemSpace:5,imageList:[],imageHeight:72,categories:["Cast in Character","Cast Ensemble","Photo"],padding:0,lightBoxEnabled:true,galleryTitle:"",imgHost:"",transitionSpeed:0.4},prototype:{flags:{absPos:0,currentLeft:0,groups:1,head:0,imgPos:[],imgPointer:[],isValidCarousel:true,scrolling:false,spinner:"/images/global/ajax/loading_40px.dark.gif",tail:0,ulWidth:0},_mainElements:{nextArrow:null,prevArrow:null,ul:null},_groupWidth:0,_imageList:[],_imageListMedium:[],_imageListLarge:[],_serverRoot:"",_currentFirst:0,_currentInitial:0,_rightOffset:0,_leftOffset:0,_errorCount:0,_requiredGroups:4,_thumbSuffix:"_t.jpg",_currentIndex:0,_lightBoxRef:null,_addGroup:function(){var j=this._imageList.length,l=(this.options.imageHeight/2)-13,a=0,b=null,k=null;
for(var i=0;i<j;i++){b=new Element("li",{width:this._imageList[i].getWidth()+"px"}),span=new Element("span"),aEl=new Element("a",{href:"#"}),imgIndex=this.flags.imgPointer.length;if(this._imageList[i].photo.src.indexOf(this.flags.spinner)>0){this.flags.imgPointer[imgIndex]=new Element("img",{src:this._imageList[i].photo.src});this.flags.imgPointer[imgIndex].setStyle({width:"40px",height:"40px",paddingTop:"20px","text-align":"center",display:"block"});b.setStyle({width:(this._imageList[i].getWidth()+4)+"px"})
}else{this.flags.imgPointer[imgIndex]=new Element("img",{src:this._imageList[i].photo.src,height:this.options.imageHeight+"px"})}if(this._imageList[i].ratio()=="portrait"){this.flags.imgPointer[imgIndex].addClassName("portrait")}a=(this._imageList[i].getWidth()/2)-13;span.setStyle({left:a+"px",top:l+"px"});aEl.observe("click",this._refer.bindAsEventListener(this,aEl));aEl.addClassName("js-CMSModule-showPhotoLightbox");aEl.insert(span);aEl.insert(this.flags.imgPointer[imgIndex]);b.insert(aEl);this._mainElements.ul.insert(b)
}if(this.flags.groups>1){k=new Element("li");k.setStyle({height:(this.options.imageHeight+4)+"px",width:"1px"});k.addClassName("breaker");this._mainElements.ul.insert(k.update(""))}},_destroy:function(){$("photo-carousel").remove()},_getAbsPos:function(a){var b=parseFloat(this._mainElements.ul.getStyle("left"));if(a=="next"){this._repos((this.flags.imgPos[this.flags.head]+this._groupWidth)*-1)}if(a=="prev"){this._repos((this.flags.imgPos[this.flags.head]+this._groupWidth)*-1)}this.flags.scrolling=false;
this._getFrame()},_getFrame:function(){var w=parseInt(this._mainElements.ul.getStyle("left")),v=0,y=this._imageList.length;found=false;this.flags.head=-1;for(var u=0;u<this._requiredGroups;u++){for(var t=0;t<y;t++){if((v*-1)<=w){found=true;this.flags.head=t;break}v+=this._imageList[t].getWidth()+this.options.itemSpace}if(found){break}v+=2}if(this.flags.head!=-1){v=0;found=false;var j=this.flags.head;while(!found){v+=this._imageList[j].getWidth()+this.options.itemSpace;if(v>=this.flags.ulWidth){found=true;
this.flags.tail=j}j++;if(j==y){j=0;v+=2}}}var b=true,x=0,t=this.flags.head;while(b){var i=[];for(var u=0;u<this._requiredGroups;u++){var r=t+(this._imageList.length*u);i[u]=r}var s=this;this._imageList[t].photo=new Image();var a=this._imageList[t].scaleH;var z=this._imageList[t].getWidth();this._imageList[t].photo.onload=function(p,h,e,l,k,g,f){for(var o=0;o<e;o++){var m=l[o];var n=k.flags.imgPointer[m];n.hide();n.src=p;n.setStyle({width:f+"px",height:g+"px",padding:""});n.show()}}.bind(this.flags.imgPointer[r],this._imageList[t].fileName,r,this._requiredGroups,i,s,a,z);
this._imageList[t].photo.src=this._imageList[t].fileName;x+=this._imageList[t].getWidth()+this.options.itemSpace;if(x>this.options.maxWidth){b=false}t++;if(t==this._imageList.length){t=0}}},getImages:function(){var a="/entertainment/data/programImages.json.jsp?programid="+this.options.tmsId,b=new Dtv.RequestManager({useCaching:false});b.request(a,{timeout:3000,onSuccess:this._handleJSONResponse.bind(this),onFailure:function(){this.el.remove()}})},_getIndexOf:function(a){var b=0,h=this._imageList.length;
for(var g=0;g<h;g++){if(this._imageList[g].fileName.toLowerCase()==a.toLowerCase()){b=g;break}}return(b)},_getJSONResponse:function(a){if(a){var i=true,n=a.programImages;this._serverRoot=a.serviceParams.logoHost;if(n){this._groupWidth=0;var p=0;for(var j=0;j<n.length;j++){if((this.options.categories.indexOf(n[j].category)>=0)&&((this._isValidThumb(n[j].uri))||(n[j].format=="Small"))){var b=new dtvImage();b.fileName=this._serverRoot+n[j].uri;b.format=n[j].orientation;b.height=n[j].height;b.width=n[j].width;
b.spinner=this.flags.spinner;b.scaleH=this.options.imageHeight;b.description=n[j].caption;b.elem=null;this._imageList[p]=b;this.options.imageList[p]=Object.toJSON(b).evalJSON();this.flags.imgPos[p]=this._groupWidth;this._groupWidth+=this._imageList[p].getWidth()+this.options.itemSpace+this.options.padding;if(i){this._imageList[p]._updateImg();if(this._groupWidth>this.flags.ulWidth){i=false}}else{this._imageList[p].wait()}for(var m=0;m<n.length;m++){if((n[j].category==n[m].category)&&(n[j].caption==n[m].caption)){var o=new dtvImage();
o.fileName=this._serverRoot+n[m].uri;o.height=n[m].height;o.width=n[m].width;if(n[m].format=="Medium"){this._imageListMedium[p]=o}if(n[m].format=="Large"){this._imageListLarge[p]=o}if((n[m].format=="")&&(!this._isValidThumb(n[m].uri))){this._imageListMedium[p]=o}}}p++}}this._groupWidth+=2}else{this.flags.isValidCarousel=false}}},_getLeftOffset:function(){var h=0,a=true,b=1,g=this.flags.head;this._leftOffset=0;if(g==0){g=(this._imageList.length)-1;b=0}else{g--}while(a){if((h+this._imageList[g].getWidth()+this.options.itemSpace)<this.options.maxWidth){this._leftOffset+=this._imageList[g].getWidth()+this.options.itemSpace;
h+=this._imageList[g].getWidth()+this.options.itemSpace;this._currentInitial=g;if(g==this._imageList.length-1){b=0}}else{this._currentFirst=g;a=false}if(g==0){g=this._imageList.length-1}else{g--}}this.flags.head=this._currentInitial;this.flags.absPos=(this.flags.imgPos[this._currentInitial]+((this._groupWidth+this.options.delimiterSpace)*b))*-1},_getRightOffset:function(){var i=0,a=true,j=0,b=1,h=this.flags.head;this._rightOffset=0;if(h==0){b=0}while(a){if((i+this._imageList[h].getWidth()+this.options.itemSpace)<this.options.maxWidth){this._rightOffset+=this._imageList[h].getWidth()+this.options.itemSpace;
i+=this._imageList[h].getWidth()+this.options.itemSpace;if(h==0){b+=1}}else{this._currentInitial=h;a=false}h++;if(h==this._imageList.length){h=0}j=h}if(j==1){b++}this.flags.head=this._currentInitial;this.flags.absPos=(this.flags.imgPos[this._currentInitial]+((this._groupWidth+this.options.delimiterSpace)*b))*-1},_handleJSONResponse:function(a){this._jsonRes=a.responseJSON;this._getJSONResponse(a.responseJSON);this._prepareLayout();if(!this.flags.isValidCarousel){this._destroy()}},_init:function(){var a=this.el.childElements()[0];
this.options.tmsId=$("ctl_area_b").getVar("tmsId");this.options.galleryTitle=$("photo-carousel").getVar("galleryTitle");holder=this;if(a.hasClassName("column")){this._mainElements.ul=a.down("ul");this._mainElements.nextArrow=this.el.down("a.ep-carousel-next");this._mainElements.prevArrow=this.el.down("a.ep-carousel-prev");this.flags.ulWidth=parseInt(this._mainElements.ul.up().getStyle("width"));this.getImages()}},_isValidThumb:function(a){if(this._thumbSuffix==a.substring(a.length-this._thumbSuffix.length,a.length)){return(true)
}else{return(false)}},nextItem:function(){if(!this.flags.scrolling){this.flags.scrolling=true;var a=this._currentFirst;this._getRightOffset();new Effect.Move(this._mainElements.ul,{x:this.flags.absPos,y:0,duration:this.options.transitionSpeed,mode:"absolute",afterFinish:this._getAbsPos.bind(this,"next")})}},_prepareLayout:function(){if(this._imageList.length>0&&this.flags.isValidCarousel){if(this._groupWidth>this.options.maxWidth){var a=0;while(a<this._requiredGroups){this.flags.groups++;this._addGroup();
a++}}else{this._addGroup()}this._mainElements.ul.setStyle({width:(this._groupWidth*this._requiredGroups)+"px"});if(this._groupWidth>this.options.maxWidth){this._repos(this._groupWidth*-1)}if(this._imageList.length>0){if(this._groupWidth>this.options.maxWidth){this.onDom(this._mainElements.nextArrow,{click:this.nextItem},this);this.onDom(this._mainElements.prevArrow,{click:this.previousItem},this)}else{this._mainElements.nextArrow.addClassName("disabled");this._mainElements.prevArrow.addClassName("disabled")
}new Effect.Appear(this.el)}}},previousItem:function(){if(!this.flags.scrolling){this.flags.scrolling=true;this._getLeftOffset();new Effect.Move(this._mainElements.ul,{x:this.flags.absPos,y:0,mode:"absolute",duration:this.options.transitionSpeed,afterFinish:this._getAbsPos.bind(this,"prev")})}},_refer:function(b,a){holderInvoker=this.behaviorName;holder=this;var f=a.down("img").readAttribute("src");this._currentIndex=this._getIndexOf(f)},_repos:function(a){this._mainElements.ul.setStyle({left:(a)+"px"})
}}};Dtv.Behaviors.create(d);Dtv.Behaviors.create(c)})();(function(){var l=Class.create(Dtv.RequestManager,{toggleFav:function(a,b){return this.request("/entertainment/user/favorites/"+this.options.favType+"/",{parameters:a,onSuccess:function(c){if(c.responseJSON){if(c.responseJSON.success){this.fireEvent("favchanged",{added:b,params:a})}if(c.responseJSON.maxReached!=this.maxReached){this.maxReached=c.responseJSON.maxReached;this.fireEvent("maxreachedchanged",{maxReached:this.maxReached})}}}.bind(this)})
},removeAllFavs:function(){return this.request("/entertainment/user/favorites/"+this.options.favType+"/?removeAll=true",{onSuccess:function(a){if(a.responseJSON&&a.responseJSON.success){if(this.maxReached){this.maxReached=false}this.fireEvent("allfavsremoved")}else{this.debug(new Error("Failed to update favorites"))}}.bind(this)})}});var g={name:"UtilityBar",prototype:{_init:function(){var b=this.el.down("#purchases_util_bar");var a=this.el.down("#resume_watching_util_bar");if(b){this.purchasesPopup=$("util_bar_purchases_popup").behavior("UtilityBar.CarouselPopup",{url:"/entertainment/utility_bar/component/purchasesAjax.jsp",trigger:b})
}else{if(a){this.resumeWatchingPopup=$("util_bar_resume_watching_popup").behavior("UtilityBar.ResumeWatchingPopup",{url:"/entertainment/data/viewingHistory.jsp?stub="+window.location.getParam("resumeWatchingStub"),trigger:a})}}this.entertainmentPopup=$("util_bar_entertainment_popup").behavior("UtilityBar.CarouselPopup",{trigger:this.el.down("#entertainment_util_bar"),favType:"movies,tvseries",loadType:"entertainment"});this.channelsPopup=$("util_bar_channels_popup").behavior("UtilityBar.CarouselPopup",{trigger:this.el.down("#channels_util_bar"),extraParams:"&channelsonly=true&sortby=ChlNumber&utilityBar=true&logoTheme=none&logoType=web_detail_large",favType:"channels"});
this.disableTextSelection()},_initEvents:function(){this.onDom(this.el,"click","#util_bar_title .icon, #util_bar_title a small",this._handleToggleClick.bind(this))},_handleToggleClick:function(a){a.stop();this.el.toggleClassName("collapsed").toggleClassName("expanded");this._updateSession(this.el.hasClassName("collapsed"));document.fire(DTV_REPORTING_UTILBAR_TOGGLE,{show:!this.el.hasClassName("collapsed")});Dtv.Behaviors.Popup.hide("utilityBar")},_updateSession:function(a){new Ajax.Request("/entertainment/data/updateSession.jsp",{parameters:{hideUtilityBar:a}})
}}};var i={name:"UtilityBar.AbstractPopup",inherits:"Popup",options:{groupName:"utilitybar",hideOnOutsideClick:function(b,a){return !$(a.target).up("#ep_program_info_popup")},trigger:null,url:"/entertainment/utility_bar/favoritesAjax.jsp?favtype=",favType:null,extraParams:null,showFxOptions:{transition:Effect.Transitions.Cubic.easeInOut,duration:0.2},hideFxOptions:{transition:Effect.Transitions.Cubic.easeInOut,duration:0.2}},prototype:{_init:function(){this._ajaxPanel=this.el.behavior("AjaxPanel");
if(this.options.favType){var a=this.options.favType.split(",");var d=this.el.getVar("serverParams");this.requestManagers=[];for(var c=0;c<a.length;c++){var e=a[c];var b=new l({name:e+"favs",favType:e,allowMultipleRequests:true});b.maxReached=d.maxReached[e];this.requestManagers.push(b);this.requestManagers[e]=b}}},_initEvents:function($super){$super();this._triggerEl=$(this.options.trigger);if(this._triggerEl){this.onDom(this._triggerEl,"click",this._handleTriggerClick.bind(this))}this._ajaxPanel.on("update",this._handleAjaxUpdate.bind(this));
if(this.requestManagers){for(var a=0;a<this.requestManagers.length;a++){this.requestManagers[a].on("favchanged",this.markStale.bind(this));this.requestManagers[a].on("allfavsremoved",this.markStale.bind(this))}}this.onDom(this.el,"click",{"a.js-UtilityBar-AbstractPopup-remove-all":this._handleRemoveAllLink,"a.js-UtilityBar-AbstractPopup-remove":this._handleRemoveLink.curry(this.id),"a.js-UtilityBar-AbstractPopup-view-all-channels.view-all":this._handleViewAllChannelsLink.curry("Utility Bar:Fav Channels:View Guide"),"a.js-UtilityBar-AbstractPopup-view-more-movies.view-all":this._handleViewMoreMoviesLink.curry("Utility Bar:Purchases:Browse Movies"),"a.edit-settings":this._handleResumeWatchingLink.curry("Utility Bar:Purchases:Edit Settings"),"a.js-UtilityBar-ResumeWatchingPopup-clear-history.clear-history":this._handleResumeWatchingLink.curry("Utility Bar:Purchases:Clear History"),"dd.remove.js-UtilityBar-ResumeWatchingPopup-history-action":this._handleResumeWatchingLink.curry("Utility Bar:Purchases:Remove Title"),"a.js-UtilityBar-AbstractPopup-view-all-channels.arrow":this._handleViewAllChannelsLink.curry("Utility Bar:Fav Channels:Guide"),"a.js-UtilityBar-AbstractPopup-view-more-movies.arrow":this._handleViewMoreMoviesLink.curry("Utility Bar:Purchases:Browse"),"a.js-UtilityBar-AbstractPopup-browse-all.view-all":this._handleViewMoreEntertainmentLink,"a.arrow.js-UtilityBar-AbstractPopup-browse-all":this._handleViewMoreEntertainmentLink,"div.ep-carousel-content ul li dl dd a:not(.js-UtilityBar-AbstractPopup-remove)":this._handleAddingLvarUrls.curry(null,this.id),"div.infobox-content #utility_content_list div.content ul.js-has-behavior li dl dd.title a":this._handleAddingLvarUrls.curry(null,this.id),"a.js-UtilityBar-AbstractPopup-close":this._handleCloseLink},this)
},_handleAddingLvarUrls:function(c,a,b,d){if((c==null)&&(a!=null)){if(a=="util_bar_channels_popup"){c="Utility Bar:Fav Channels:Channel Details&ltovrd=true"}else{if(a=="util_bar_entertainment_popup"){c="Utility Bar:Fav Ent:Title Details&ltovrd=true"}else{if(a=="util_bar_purchases_popup"){c="Utility Bar:Purchases:Title Details&ltovrd=true"}else{if(a=="util_bar_resume_watching_popup"){c="Utility Bar:Purchases:Title Details&ltovrd=true"}}}}}var e=d.readAttribute("href");if(e!=null&&((e!="#")&&(e.indexOf("support.directv.com")<0)&&(e.indexOf("forums.directv.com")<0))){if(e.indexOf("?")>=0){e=e.trim()+"&lpos=utilitybar&lid="+c
}else{e=e.trim()+"?lpos=utilitybar&lid="+c}}d.href=e},_handleTriggerClick:function(){Dtv.app.rollovers.hide();this.toggle()},_handleRemoveLink:function(a,c,d){if(a!=null){if(a=="util_bar_channels_popup"){lid="Utility Bar:Fav Channels:Remove Channel"}else{if(a=="util_bar_entertainment_popup"){lid="Utility Bar:Fav Ent:Remove Title"}else{if(a=="util_bar_purchases_popup"){lid="Utility Bar:Purchases:Remove Title"}}}document.fire(DTV_REPORTING_REMOVE_ITEM,{lid:lid})}var b=d.up("li").getVar("removeParams");
this.requestManagers[b.favType].toggleFav(b)},_handleRemoveAllLink:function(a,b){this.requestManagers.invoke("removeAllFavs")},_handleViewAllChannelsLink:function(b,a){new Ajax.Request("/entertainment/data/updateSession.jsp",{parameters:{view:"FAVORITES"},onSuccess:function(c){window.location.href="/entertainment/channelguide?ltovrd=true&lpos=utilitybar&lid="+b+"&lname="+Reporting.pageName}})},_handleResumeWatchingLink:function(b,a){document.fire(DTV_REPORTING_REMOVE_ITEM,{lid:b})},_handleViewMoreMoviesLink:function(b,a){window.location.href="/entertainment/watch_online?ltovrd=true&lpos=utilitybar&lid="+b+"&lname="+Reporting.pageName
},_handleViewMoreEntertainmentLink:function(a){window.location.href="/entertainment?ltovrd=true&lpos=utilitybar&lid=Utility Bar:Fav Ent:Browse All"},_handleCloseLink:function(a,b){this.hide()},_handleAjaxUpdate:function(){if(this.el.down("div.ep-contingency-message")){this._isStale=true}},show:function($super,a){if(this.isVisible()){return}this.setTarget(this._triggerEl);if(!this._ajaxPanel.url||this._isStale){$super();this.load()}else{$super(a&&!this._ajaxPanel.isLoading())}$("utility_bar").addClassName("active");
this._triggerEl.addClassName("active");this._triggerEl.supressRollover=true},hide:function($super,a){if($super(a)){$("utility_bar").removeClassName("active");this._triggerEl.removeClassName("active");this._triggerEl.supressRollover=false;this._ajaxPanel.hideOverlay()}},load:function(){this._ajaxPanel.load(this.options.url+(this.options.loadType||this.options.favType||"")+(this.options.extraParams||""));this._isStale=false},markStale:function(){this._isStale=true;if(this.isVisible()){this.load()}}}};
var k={name:"UtilityBar.ScrollerPopup",inherits:"UtilityBar.AbstractPopup",options:{scrollerOptions:{orientation:"vertical",listOptions:{visibleCount:5,visibleBleed:0},scrollbarOptions:{indexMultiplier:16}}},prototype:{_handleAjaxUpdate:function($super){$super();if(this.el.down("ul")){this._initScroller()}else{this._clearScroller()}},_initScroller:function(){this.options.scrollerOptions.listOptions.startNavIndex=this._stateNdx||0;this.scroller=this.el.behavior("ListScroller",this.options.scrollerOptions);
this._ajaxPanel.ajaxContent.addDisposableObj(this.scroller)},_clearScroller:function(){this.scroller=null},load:function($super){if(this.scroller){this._stateNdx=this.scroller._scrollableList.getNavIndex()}$super()}}};var j={name:"UtilityBar.ResumeWatchingPopup",inherits:"UtilityBar.ScrollerPopup",prototype:{_init:function($super){$super();if(Dtv.Behaviors.ProgramListInfoPopController){this.el.behavior("ProgramListInfoPopController",{targetSelector:"dd.title a",useFixedPopup:true,hidePoster:false})
}},_initEvents:function($super){$super();this.onDom(this.el,"click",{".js-UtilityBar-ResumeWatchingPopup-history-action":this._handleHistoryActionClick,".js-UtilityBar-ResumeWatchingPopup-clear-history":this._handleClearHistoryClick},this)},_handleHistoryActionClick:function(a,b){new Ajax.Request(this.options.url+"&"+$H(b.getVar("params")).toQueryString(),{onSuccess:this.load.bind(this)})},_handleClearHistoryClick:function(a,b){var c=this;Dtv.app.ajaxLightbox.show("/DTVAPP/global/lightbox/lightboxClearHistory.jsp",{contentBehavior:{options:{onInit:function(d){d.onDom(d.el,"click",{"#viewingClearHistorySubmitButton":function(){d.lightbox.hide();
c._handleHistoryActionClick(a,b)}})}}}})},_updateTimes:function(){this.el.select("dd.expires").each(function(a){utc=a.getVar("expiresAt");if(utc){diff=Date.timeUntil(Date.fromUTCStr(utc));text=(diff.days>0||diff.hours>0||diff.minutes>0)?diff.days+"d "+diff.hours+"h "+diff.minutes+"m":"--";a.down("span").update(text)}})},_handleAjaxUpdate:function($super){clearInterval(this._updateInterval);$super()},_initScroller:function($super){$super();this._updateTimes();this._updateInterval=setInterval(this._updateTimes.bind(this),60000)
}}};var h={name:"UtilityBar.CarouselPopup",inherits:"UtilityBar.AbstractPopup",prototype:{_handleAjaxUpdate:function($super){$super();var a=this.el.down("div.util-posters-carousel");if(a){this.carousel=a.behavior("EpCarousel",{useFixedPopup:true});this.carousel.options.effectDuration=0.5;this._ajaxPanel.ajaxContent.addDisposableObj(this.carousel)}else{this.list=null}},load:function($super){if(this.carousel){var a=this.carousel.list.getPosIndex();$super();this.carousel.list.moveToPosition(a)}else{$super()
}}}};Dtv.Behaviors.create(g,i,k,j,h)})();(function(){var e={AUTO:"auto",POSITIONING:{AROUND:"around",CENTERED:"centered",RELATIVE:"relative",ABSOLUTE:"absolute"},EVENTS:{CONTENT_UPDATED:"contentupdated",SHOW:"show",HIDE:"hide",AFTER_HIDE:"afterhide",AFTER_SHOW:"aftershow",BLUR:"blur"}};var g={name:"Lightbox",consts:e,options:{width:e.AUTO,height:e.AUTO,top:0,left:0,zIndex:1002,positioning:e.POSITIONING.CENTERED,effectDuration:0.1,effectQueue:"end",relElement:null,buttons:null,contentSelectors:{header:".ipop-header",body:".ipop-content"},modal:true,hideOnBlur:false,hideOnClick:false,hideOnEscape:false,ajaxHistoryParam:null,refreshLayoutOnResize:true},statics:{allInstances:[],visibleInstances:[],modalInstances:[],showQueue:[],_notifyEvent:function(c,a,b){switch(a){case e.EVENTS.SHOW:this.visibleInstances.push(c);
if(c.options.modal){this.modalInstances.push(c);if(this.modalInstances.length==1){Dtv.app.disableScreen()}}break;case e.EVENTS.HIDE:this.visibleInstances.erase(c);if(this.modalInstances.length>0){this.modalInstances.erase(c);if(this.modalInstances.length==0){Dtv.app.enableScreen()}}break;case e.EVENTS.AFTER_SHOW:Dtv.app.el.fire(EVENT_LIGHTBOX_RENDERED);break}},queue:function(a){if(this.showQueue.length==0&&this.visibleInstances.length==0){a()}else{this.showQueue.push(a)}}},prototype:{_init:function(){Dtv.Behaviors.Lightbox.allInstances.push(this);
this.ajaxHistoryEnabled=this._enableHistoryManager()},_initLayout:function(){if(Prototype.X.Browser.IE==6){this.iframeShim=new Element("iframe",{src:'javascript:"";',frameBorder:0}).setStyle({position:"absolute",display:"none",zIndex:this.options.zIndex,top:0,left:0}).setOpacity(0);this.iframeShim.appendTo(document.body)}this.el.setStyle({position:"absolute",display:"none",zIndex:this.options.zIndex,top:0,left:0});this.el.appendTo(document.body)},_initEvents:function(){this.onDom(document,"macro:click",this._handleDocClick.bind(this));
this.onDom(this.el,"macro:click",this._handleClick.bind(this));this.onDom(this.el,"macro:click",".js-Lightbox-hide:not(.disabled)",this.hide.bind(this).ignoreEvent());if(this.options.refreshLayoutOnResize){Dtv.app.on("resize",this._handleWindowResize.bind(this))}if(this.options.hideOnEscape){this.onDom(document,"keyup",this._handleDocKeyup.bind(this))}},_handleWindowResize:function(a){if(this.visible()){this.refreshLayout()}},_handleClick:function(a){if(this.options.hideOnClick&&a.element().tagName!="A"){this.hide()
}},_handleDocClick:function(a){try{var b=a.element();if(this.el.visible()&&b.ancestors().indexOf(this.el)==-1){if(this.options.hideOnBlur){if(this.ignoreNextBlur){this.ignoreNextBlur=false}else{this.hide()}}this.fireEvent(e.EVENTS.BLUR,{lightbox:this})}}catch(c){this.debug(c,"Failed to handle document click event")}},_handleDocKeyup:function(a){if(a.keyCode==Event.KEY_ESC){this.hide()}},_enableHistoryManager:function(){if(this.ajaxHistoryEnabled){return true}try{if(this.options.ajaxHistoryParam&&window.History&&History.Observer){if(!History.Observer.started){History.Observer.delay=0.4;
History.Observer.start()}History.Registry.set({id:this.options.ajaxHistoryParam,onStateChange:this._onHistoryStateChange.bind(this)});this._ajaxHistoryInfo=[];this.debug("Configured Ajax History Manager");return true}}catch(a){this.debug(a,"Failed to enable history manager")}return false},_onHistoryStateChange:function(a){if(!$chk(a)||a>=this._ajaxHistoryInfo.length){this.hide()}else{this.show.apply(this,this._ajaxHistoryInfo[a])}},clearAjaxHistory:function(){this._ajaxHistoryInfo=[]},updateAjaxHistory:function(b){if(this.ajaxHistoryEnabled){var a=History.get(this.options.ajaxHistoryParam);
if(!$chk(a)){this.setHistoryIndex()}while(a>this._ajaxHistoryInfo.length-1&&this._ajaxHistoryInfo.length>0){this._ajaxHistoryInfo.pop()}this._ajaxHistoryInfo.push(b);this.setHistoryIndex(this._ajaxHistoryInfo.length-1);return true}else{this.debug("updateAjaxHistory called on lightbox that does not have ajax history enabled")}return false},setHistoryIndex:function(a){if(this.ajaxHistoryEnabled){if(a>=this._ajaxHistoryInfo.length){throw"Ndx is out of range"}History.set(this.options.ajaxHistoryParam,a);
return true}return false},queue:function(){var b=this,a=arguments;function c(){b.show.apply(b,a)}Dtv.Behaviors.Lightbox.queue(c)},showWithHistory:function(){if(!this.updateAjaxHistory(arguments)){this.debug("showWithHistory() was called but ajax history could not be updated. lightbox will continue to show without history support.",null,"warn")}return this.show.apply(this,arguments)},_show:function(){this.refreshLayout();if(this.visible()){Dtv.app.el.fire(EVENT_LIGHTBOX_RERENDERED);return false}this.el.appear({duration:this.options.effectDuration,queue:this.options.effectQueue,afterFinish:this._afterShow.bind(this)});
this.fireEvent(e.EVENTS.SHOW,{lightbox:this});return true},show:function(){this._show()},hide:function(){if(!this.visible()){return false}this.el.fade({duration:this.options.effectDuration,queue:"start",afterFinish:this._afterHideFinish.bind(this)});this.fireEvent(e.EVENTS.HIDE,{lightbox:this});this._showSelectBoxes.bind(this).defer();this.setHistoryIndex();return true},_afterShow:function(){this._hideSelectBoxes.bind(this).defer();Dtv.app.updateDisabledScreenLayout();this.fireEvent(e.EVENTS.AFTER_SHOW,{lightbox:this})
},_afterHide:function(){this.fireEvent(e.EVENTS.AFTER_HIDE,{lightbox:this})},_afterHideFinish:function(){this._afterHide();var a=Dtv.Behaviors.Lightbox.showQueue.pop();if(a){a()}},visible:function(){return this.el.visible()},fireEvent:function($super,a,b){$super(a,b);Dtv.Behaviors.Lightbox._notifyEvent(this,a,b)},getBounds:function(){var a=this.el.getLayout();return{width:a.get("width"),height:a.get("height"),left:a.get("left"),top:a.get("top")}},setContent:function(a,b){if(Object.isString(a)){if(h(this.getContentEl(a),b)){if(this.isInitialized){this.fireEvent(e.EVENTS.CONTENT_UPDATED,{contentType:a,content:b})
}return true}return false}else{var c=false;$H(a).each(function(d){if(this.setContent(d.key,d.value)){c=true}}.bind(this));return c}},getContentEl:function(a){return this.el.down(this.options.contentSelectors[a])},_hideSelectBoxes:function(){if(this.iframeShim){var b=this.el;var a=Element.getLayout(b);while(a.get("width")==0||a.get("height")==0){b=b.down("div");if(!b){break}a=Element.getLayout(b)}this.iframeShim.setStyle({width:a.get("width")+"px",height:a.get("height")+"px",top:this.el.style.top,left:this.el.style.left});
this.iframeShim.show()}},_showSelectBoxes:function(){if(this.iframeShim){this.iframeShim.hide()}},_getBaseStyle:function(){return{width:Dtv.Util.getStyleValue(this.options.width),height:Dtv.Util.getStyleValue(this.options.height)}},_adjustLayoutStyle:null,_getLayoutStyle:function(){var s=this.visible();this.el.setStyle({display:"block",visibility:"hidden"});this.el.setStyle(this._getBaseStyle());var t={display:s?"block":"none",visibility:"visible"};switch(this.options.positioning){case e.POSITIONING.AROUND:var p=f(),a=f(this._getRelatedEl()),o=Element.getOuterDimensions(this.el);
o.width=o.width||this.el.offsetWidth||this.el.down().getWidth();o.height=o.height||this.el.offsetHeight||this.el.down().getHeight();o.left=a.left+this.options.left+((a.width-o.width)/2);o.top=a.top+this.options.top-o.height;o.right=o.left+o.width;p.right=p.left+p.width;if(o.right>p.right){o.left-=(o.right-p.right)}if(p.left>o.left){o.left=p.left}if(p.top>o.top){o.top+=(a.height+o.height)-(this.options.top*2)}t.left=o.left;t.top=o.top;break;case e.POSITIONING.CENTERED:var p=f(this._getRelatedEl()),b=Element.getOuterDimensions(this.el);
var d=(p.width-b.width)/2;var q=(p.height-b.height)/2;t.left=Math.max(0,p.left+d+this.options.left);t.top=Math.max(0,p.top+q+this.options.top);var r=b.height-p.height;if(r>this.options.top){var c=document.viewport.getScrollOffsets();t.top=c.top}break;case e.POSITIONING.RELATIVE:var p=f(this._getRelatedEl());t.left=p.left+this.options.left;t.top=p.top+this.options.top;break;case e.POSITIONING.ABSOLUTE:t.left=this.options.left;t.top=this.options.top;break;default:if(!this._adjustLayoutStyle){this.debug(new Error("Invalid positioning value specified"))
}break}if(this._adjustLayoutStyle){this._adjustLayoutStyle(t)}t.left+="px";t.top+="px";return t},_getRelatedEl:function(){return this.relElement||this.options.relElement},refreshLayout:function(){this.el.setStyle(this._getLayoutStyle())}}};function f(d){var c={};if(d){$extend(c,Element.getOuterDimensions(d));var a=Element.viewportOffset(d);var b=Element.viewportOffset(document.body);c.left=a[0]-b[0];c.top=a[1]-b[1]}else{$extend(c,document.viewport.getDimensions());$extend(c,document.viewport.getScrollOffsets())
}return c}function h(b,a){if(!b){return false}if(Object.isElement(a)){b.update().append(a)}else{b.update(a)}return true}Dtv.Behaviors.create(g)})();(function(){var c={name:"AjaxLightbox",inherits:"Lightbox",consts:{EVENTS:{CONTENT_READY:"contentready"}},options:{useCaching:false,effectQueue:"",contentBehavior:{name:"AjaxLightbox.AjaxContent",options:{formPanel:{form:{hideOnSuccess:true}}}}},prototype:{_init:function($super){$super();this.ajaxPanel=this.el.behavior("AjaxPanel",{autoUpdate:false,overlay:false,contentBehavior:this.options.contentBehavior,createContentOnInit:false,requestManagerOptions:{useCaching:this.options.useCaching}});
this.addDisposableObj(this.ajaxPanel)},_initEvents:function($super){$super();this.ajaxPanel.requestManager.on({requestsuccess:this._handleRequestSuccess,requestfailure:this._handleRequestFailure,requestexception:this._handleRequestException,requestcancel:this._handleRequestCancel},this);if(Prototype.Browser.MobileSafari){this.onDom(this.el,"macro:click","a",Dtv.handleGlobalJsEventBindings)}},_handleRequestSuccess:function(a){this.hideWaiting();if(a.memo.response&&a.memo.response.responseText){try{this.ajaxPanel.update(a.memo.response.responseText,this.config.contentBehavior.name,this.config.contentBehavior.options);
this._initContent();this.refreshLayout.bind(this).defer()}catch(a){this.debug(a,"Failed to init ajax lightbox content")}this._show();if(this._callback){this._callback();this._callback=null}}else{this.hide()}},_handleRequestFailure:function(a){this._handleRequestCancel(a)},_handleRequestException:function(a){this._handleRequestCancel(a)},_handleRequestCancel:function(a){this._callback=null;this.hideWaiting();if(Dtv.Behaviors.Lightbox.modalInstances.length==0){Dtv.app.enableScreen()}},showWaiting:function(){if(this.options.modal){Dtv.app.disableScreen();
Dtv.app.showThinking()}},hideWaiting:function(){if(this.options.modal){Dtv.app.hideThinking()}},show:function(b,g,a){suppressExternalLightboxes();if(!b){this._show();return}this._callback=a;this.showWaiting();this.config=g||{};if(!this.config.contentBehavior){this.config.contentBehavior=Object.deepClone(this.options.contentBehavior);if(this.config.form||this.config.forms){var h=this.config.contentBehavior.options.formPanel=this.config.contentBehavior.options.formPanel||{};if($defined(this.config.form)){h.form=$extend(h.form||{},this.config.form)
}if($defined(this.config.forms)){h.forms=this.config.forms}}}else{if(!this.config.contentBehavior.name){this.config.contentBehavior.name=this.options.contentBehavior.name}else{if(!this.config.contentBehavior.options){this.config.contentBehavior.options={}}}}this.config.contentBehavior.options.lightbox=this;this.url=b;this.ajaxPanel.load(b);return this},hide:function($super){allowExternalLightboxes();if($super()){this.ajaxPanel.requestManager.cancel();if(this.config.onHide){this.config.onHide.call(this)
}return true}return false},_afterShow:function($super){$super();if(this.config.onAfterShow){this.config.onAfterShow.call(this)}},_afterHide:function($super){$super();if(this.config.onAfterHide){this.config.onAfterHide.call(this)}},_onOpen:function(b,a){this.show(this.opener.href,this.opener.rel)},_initContent:function(){if(this.config.onInitContent){this.config.onInitContent.call(this,this.ajaxPanel.ajaxContent)}this.fireEvent(this.EVENTS.CONTENT_READY,{lightbox:this});new Infopop(".dtv-infopop")
},invokeAction:function($super,b,a,e,h){if(this.visible()&&this.config.actions&&this.config.actions[b]){this.config.actions[b].call(this,a,e);return true}return $super(b,a,e,h)},_getBaseStyle:function($super){var a=this.el.down();if(!a){return $super()}return{width:a.getStyle("width"),height:a.getStyle("height")}}},actionAdapters:{show:function(a,b){this.show(b.href)},submit:function(a,b){a.element().up("form").getController().submit()}}};var d={name:"AjaxLightbox.AjaxContent",options:{autoFocusField:true,formPanel:{},onInit:null},prototype:{_init:function(){this.lightbox=this.options.lightbox;
delete this.options.lightbox;this.formPanel=this.el.behavior("FormPanel",this.options.formPanel);this.addDisposableObj(this.formPanel);if(this.options.onInit){this.options.onInit(this)}},_initEvents:function(){this.addDisposableObjs(this.lightbox.on({aftershow:this._handleLightboxAfterShow,hide:this._handleLightboxHide},this));this.formPanel.on({submitresponse:this._handleSubmitResponse,submitsuccess:this._handleSubmitSuccess,submitfailure:this._handleSubmitFailure},this)},_handleLightboxAfterShow:function(a){if(this.options.autoFocusField){var b=this.el.down(Object.isString(this.options.autoFocusField)?"#"+this.options.autoFocusField:"input[type='text'], input[type='password']");
if(b){try{b.focus()}catch(a){}}}},_handleLightboxHide:function(a){},_handleSubmitResponse:function(a){this.lightbox.refreshLayout()},_handleSubmitSuccess:function(a){if($("activateBasePackage")){if(TMANbasePackage){var b=$("packageName").value;TMAN.addParams("directv",{tm_u6:b});TMAN.doTags(TMAN.position.UPGRADE_1)}}else{if($("activateButton")){if(TMANnfl){if(name.indexOf("NFL ST MAX Upgrade")!=-1){TMAN.addParams("directv",{tm_u4:"MAX UP"});TMAN.doTags(TMAN.position.UPGRADE_1)}else{if(name.indexOf("NFL SUNDAY TICKET MAX")!=-1){TMAN.addParams("directv",{tm_u4:"MAX"});
TMAN.doTags(TMAN.position.UPGRADE_1)}else{if(name.indexOf("NFL SUNDAY TICKET")!=-1){TMAN.addParams("directv",{tm_u4:"NFL ST"});TMAN.doTags(TMAN.position.UPGRADE_1)}}}}else{if(TMANpremium){var e=$("progName").value;TMAN.addParams("directv",{tm_u5:e});TMAN.doTags(TMAN.position.UPGRADE_1)}}}else{if($("orderPpvSubmitButton")){if(TMANorder){TMAN.addParams("directv",{tm_u7:"PPV"});TMAN.doTags(TMAN.position.UPGRADE_1)}}}}if(a.memo.formConfig.hideOnSuccess){this.lightbox.hide()}},_handleSubmitFailure:function(a){this.lightbox.refreshLayout.bind(this.lightbox).defer()
}}};Dtv.Behaviors.create(c,d)})();(function(){function c(a){return a.toLowerCase().contains("rtmp://")}var d={name:"MediaLightbox",inherits:"Lightbox",options:{contentSelectors:{header:".lb-header",caption:".js-lb-caption"},width:725,height:330,top:-50},prototype:{show:function($super,l,a,j){var b={};var k=c(l)?"videoUrl":"imageUrl";b[k]=l;var i=this.getContentEl("caption");if(k=="videoUrl"){b.title=a;b.blurb=j;i.hide()}else{i[j?"show":"hide"]()}this.setContent({header:a,caption:k=="imageUrl"?j:""});
if(!this._mediaPlayer){this._mediaPlayer=this.el.down(".js-mediaplayer").behavior("MediaPlayer",{theme:"default"})}$super();this._mediaPlayer.setPlaylistData(b);this._mediaPlayer.playTrack()},hide:function($super){if($super()){this._mediaPlayer.destroySwfObj();return true}return false}}};Dtv.Behaviors.create(d)})();(function(){var d="vidplay_survay";var c={name:"VideoLightbox",inherits:"Lightbox",options:{width:725,height:330,top:-50,hideOnEscape:true},prototype:{_init:function($super){$super();this.videoPlayer=this.el.down(".js-VideoPlayer").behavior("VideoPlayer",{autoLoad:false,messages:this.messages});
Dtv.app.el.behavior("SocialSharing");Dtv.Util.lazyStyles("ctm-video-module")},_initEvents:function($super){$super();this.videoPlayer.on({loginlightboxshown:this.hide,messageupdated:this.refreshLayout,cancel:this.hide},this)},show:function($super,a,b){Dtv.Behaviors.Popup.hideAll(true);this.media=a;this.videoPlayer.display.ctaSource=b.up();this.videoPlayer.loadMedia(this.media,true);if(!Prototype.Browser.MobileSafari){$super()}if(this.media.surveyToken){new Ajax.JsonpRequest("https://secure.sotech.com/directv/Check726023102PopupAccess.asp",{parameters:{did:this.media.surveyToken},callbackName:"sotechCallback",onSuccess:function(f){if(f.responseJSON==1){createCookie(d,0)
}}})}},hide:function($super){this.videoPlayer.display.destroyFlash();this.videoPlayer.messages.clearMessages();this.videoPlayer.messages.el.hide();$super();if(this.media.surveyToken){var b=readCookie(d);var f="http://www.sotech.com/popups/726023-102/surveypop.asp?"+$H({did:this.media.surveyToken}).toQueryString();if(!b){this._showSurvey(f)}else{var a=parseInt(b);if(a>2){this._showSurvey(f)}else{createCookie(d,a+1)}}}},_showSurvey:function(a){window.open(a,"sotech_survey","width=360,height=250,top=80,left=100,location=no,toolbar=no,scrollbars=no");
createCookie(d,0)}}};Dtv.Behaviors.create(c)})();(function(){var b={name:"PhotoLightbox",inherits:"Lightbox",options:{width:860,height:555,hideOnEscape:true},prototype:{images:new Array(),imagesT:new Array(),_posThumb:new Array(),_mainElements:{arrow_right:null,arrow_left:null,photoContainer:null,photoHead:null,pictureTitle:null,pictureCaption:null,pictureCounter:null,picture:null,carousel:null,carouseldiv:null,carouselUl:null},_flags:{activeArrows:{center:false,left:false,right:false},carouselInit:false,hasCarousel:true,currentIndex:0,maxImageHeight:0,maxImageWidth:0,minWindowHeight:555,firstLoad:true,photoContainerHeight:0,photoContainerWidth:0,totalGroups:1,loading:false,windowHeight:0,loadTrace:0,windowWidth:0},_carFlags:{adjustedPos:0,curFirst:0,lastRight:0,scrolling:false,spacer:10},_setImageSize:function(){var o={height:this.images[this._flags.currentIndex].getRealHeight(),width:this.images[this._flags.currentIndex].getRealWidth()},m=o.height/o.width,r=this._mainElements.photoContainer.getDimensions(),n={height:r.height,width:Math.round(r.height/m)},l=this._mainElements.arrow_left.down(),k=this._mainElements.arrow_right.down();
if(r.height==0||r.width==0){r.height=parseInt(this._mainElements.photoContainer.getStyle("height"));r.width=this.options.width-((56)*2);n={height:r.height,width:Math.round(r.height/m)}}if(n.width>r.width){n.width=r.width;n.height=Math.round(r.width*m)}if((o.height<r.height)&&(o.width<r.width)){n={height:Math.round(o.height),width:Math.round(o.width)}}var a=Math.round((r.height-n.height)/2);this._mainElements.picture.setStyle({height:n.height+"px",width:n.width+"px"});this._mainElements.picture.setStyle({marginTop:a+"px"});
var q=this.el.getDimensions();var p=((q.width/2)-parseInt(l.getStyle("width")))-30;a=Math.round((r.height-parseInt(k.getStyle("height")))/2);l.up().setStyle({width:((r.width/2)+56)+"px"});k.setStyle({marginTop:a+"px",marginLeft:p+"px"});l.setStyle({marginTop:a+"px"})},_updateImg:function(a){this._mainElements.picture.setStyle("display:none;");this._mainElements.picture.src=this.images[a].fileName;this._setImageSize();this._changeCaption(this.images[a].description);this._changeCounter(a);new Effect.Appear(this._mainElements.picture,{afterFinish:function(){this._flags.loading=false
}.bind(this)})},_handleImageLoad:function(e,f){var a=this._flags.currentIndex;this.images[a].loaded=true;this._mainElements.picture.setStyle("display:none;");this._mainElements.picture.src=e.photo.src;this._setImageSize();this._changeCaption(this.images[a].description);this._changeCounter(a);new Effect.Appear(this._mainElements.picture,{afterFinish:function(){this._flags.loading=false}.bind(this)});if(this._flags.hasCarousel){this.startObserve()}},_changeImage:function(a){this._flags.loading=true;
this.stopObserve();this._mainElements.picture.setStyle("display:none;");var f="/images/global/ajax/loading_40px.dark.gif";this._mainElements.arrow_right.setStyle({display:"none"});this._mainElements.arrow_left.setStyle({display:"none"});this._mainElements.picture.writeAttribute({src:f});var g=(this._flags.photoContainerHeight/2)-20;this._mainElements.picture.setStyle({width:"40px",height:"40px",marginTop:g+"px"});this._mainElements.picture.setStyle("display:inline;");if(this.images[a].loaded==true){this._updateImg(a);
if(this._flags.hasCarousel){this.startObserve()}}else{this.images[a].photo=new Image();this.images[a].forceClear();this.images[a].photo.onload=this._handleImageLoad.bind(this,this.images[a]);this.images[a].photo.src=this.images[a].fileName}for(var h=0;h<this._mainElements.carouselUl.childElements().length;h++){if(this._mainElements.carouselUl.childElements()[h].down()&&this._mainElements.carouselUl.childElements()[h].down().down("img").hasClassName("active")){this._mainElements.carouselUl.childElements()[h].down().down("img").removeClassName("active")
}if(this._mainElements.carouselUl.childElements()[h].down()&&(this._mainElements.carouselUl.childElements()[h].down().down("img").readAttribute("src")==this.imagesT[a].fileName)){this._mainElements.carouselUl.childElements()[h].down().down("img").addClassName("active")}}},_changeCounter:function(a){this._mainElements.pictureCounter.update((a+1)+" of "+this.images.length)},_changeCaption:function(a){this._mainElements.pictureCaption.update(a)},_changeTitle:function(a){this._mainElements.pictureTitle.update(a)
},_getImages:function(){if(holderInvoker=="photoCarousel"){this.imagesT=holder._imageList;this.images=Object.toJSON(holder.options.imageList).evalJSON();for(var i=0;i<this.imagesT.length;i++){var j=new dtvImage();if(this.images[i].fileName.indexOf("_t.jpg")==(this.images[i].fileName.length-6)){j.description=this.images[i].description;j.fileName=this.images[i].fileName.replace("_t.jpg",".jpg");j.format=this.images[i].format;j.height=this.images[i].height;j.scaleH=this.images[i].scaleH;j.width=this.images[i].width;
j.loaded=false;this.images[i]=j}else{var a=null;var g="";if(holder._imageListMedium[0].fileName.length>0){a=holder._imageListMedium;g="medium"}if(holder._imageListLarge.length>0&&holder._imageListLarge.length==holder._imageListMedium.length&&holder._imageListLarge[0].fileName.length>0){a=holder._imageListLarge;g="large"}var h=false;if(a!=null){if(a[i]==null||(a[i].fileName.length==0&&g=="large")){a=holder._imageListMedium;if(typeof a[i]=="undefined"||a[i].fileName.length==0){a[i]=this.images[i]}else{j.fileName=a[i].fileName
}}else{j.fileName=a[i].fileName}if(j.fileName.length==0){j=this.images[i]}else{j.description=holder._imageList[i].description;j.format=a[i].format;j.height=a[i].height;j.scaleH=a[i].scaleH;j.width=a[i].width;j.loaded=false;this.images[i]=j}}}if(this.images[i].width>this._flags.maxImageWidth){this._flags.maxImageWidth=this.images[i].width}if(this.images[i].height>this._flags.maxImageHeight){this._flags.maxImageHeight=this.images[i].height}}}else{for(var i=0;i<holder.options.imageList.length;i++){var j=new dtvImage();
j.description=holder.options.imageList[i].description;j.fileName=holder.options.imageList[i].fileName;j.format=holder.options.imageList[i].format;j.height=holder.options.imageList[i].getRealHeight();j.width=holder.options.imageList[i].getRealWidth();j.loaded=true;this.images[i]=j;if(this.images[i].width>this._flags.maxImageWidth){this._flags.maxImageWidth=this.images[i].width}if(this.images[i].height>this._flags.maxImageHeight){this._flags.maxImageHeight=this.images[i].height}}this.imagesT=this.images
}},_getPhotoContainerHeight:function(){this._flags.photoContainerHeight=parseInt(this._mainElements.picture.up().up().getStyle("height"));return this._flags.photoContainerHeight},hideArrows:function(){this.el.down("div.left-arrow").down().setStyle({display:"none"});this.el.down("div.right-arrow").down().setStyle({display:"none"})},_hideArrows:function(){if(this._flags.activeArrows.right===false&&this._flags.activeArrows.left===false&&this._flags.activeArrows.center===false){}},hoverArrow:function(){this._flags.activeArrows.center=true;
this.el.down("div.left-arrow").down().setStyle({display:"block"});this.el.down("div.right-arrow").down().setStyle({display:"block"})},hoverArrowLeft:function(){this.el.down("div.left-arrow").down().setStyle({display:"block"});this.el.down("div.right-arrow").down().setStyle({display:"block"});this.el.down("div.left-arrow").down().addClassName("mouseover");this.el.down("div.right-arrow").down().removeClassName("mouseover");this._flags.activeArrows.left=true},hoverArrowRight:function(){this.el.down("div.left-arrow").down().setStyle({display:"block"});
this.el.down("div.right-arrow").down().setStyle({display:"block"});this.el.down("div.right-arrow").down().addClassName("mouseover");this.el.down("div.left-arrow").down().removeClassName("mouseover");this._flags.activeArrows.right=true},hoverArrowRemoveCenter:function(){this._flags.activeArrows.center=false},hoverArrowRemoveLeft:function(){this._flags.activeArrows.left=false;this._hideArrows()},hoverArrowRemoveRight:function(){this._flags.activeArrows.right=false;this._hideArrows()},_adjustLightBoxSize:function(){var l=this.el.down("div.lightbox-tup");
if(l){var n=document.viewport.getDimensions(),j=0,k=n.height*0.8,m=this._getPhotoContainerHeight(),a=k-(141+parseInt(this._mainElements.carousel.getStyle("height"))),i=m;if(k>this._flags.minWindowHeight){if(this._flags.maxImageHeight>this._getPhotoContainerHeight()){if(a>this._flags.maxImageHeight){i=this._flags.maxImageHeight}else{i=a-30}}}j=(this.options.width-119);this._mainElements.carouseldiv.setStyle({width:j+"px"});this._flags.windowHeight=i;this._mainElements.photoContainer.setStyle({height:+this._flags.windowHeight+"px"});
this.options.height=141+this._getPhotoContainerHeight()+112}},_init:function($super){$super();this._mainElements.arrow_right=this.el.down("div.right-arrow");this._mainElements.arrow_left=this.el.down("div.left-arrow");this._mainElements.arrow_right.setStyle({display:"none"});this._mainElements.arrow_left.setStyle({display:"none"});this._mainElements.photoContainer=this.el.down("div.photo-container");this._mainElements.photoHead=this.el.down("div.photo-head");this._mainElements.pictureTitle=this.el.down("div.photo-title").down("span");
this._mainElements.pictureCaption=this.el.down("div.photo-caption").down("span");this._mainElements.pictureCounter=this.el.down("div.photo-counter").down("span");this._mainElements.picture=this.el.down("div.photo-image").down("img");this._mainElements.carousel=this.el.down("div.photo-carousel-lb");this._mainElements.carouseldiv=this.el.down("div.carousel-list");this._mainElements.carouselUl=this.el.down("div.carousel-list").down("ul");$(document).observe("keyup",this._validateKey.bind(this))},_getIndexOf:function(e){var f=0;
for(var a=0;a<this.imagesT.length;a++){if(this.imagesT[a].fileName.toLowerCase()==e.toLowerCase()){f=a;break}}return(f)},_carouselElementChange:function(f,e){var a=e.down("img").readAttribute("src");a=this._getIndexOf(a);this._flags.currentIndex=a;this._changeImage(a)},_addCarouselGroup:function(){for(var g=0;g<this.imagesT.length;g++){var a=new Element("li");var j=new Element("a");j.observe("click",this._carouselElementChange.bindAsEventListener(this,j));var h=new Element("img",{src:this.imagesT[g].fileName});
a.insert(j.insert(h));h.setStyle({width:this.imagesT[g].getWidth()+"px"});this._mainElements.carouselUl.insert(a)}if(this._flags.totalGroups>1){var i=new Element("li");i.setStyle({height:"72px",width:"7px",marginRight:0+"px",marginLeft:"-5px"});i.addClassName("breaker");this._mainElements.carouselUl.insert(i.update(""))}},_getCarouselGroupWidth:function(){var a=10;var e=0;for(var f=0;f<this.imagesT.length;f++){this.imagesT[f].scaleH=72;this._posThumb[f]=e;e+=this.imagesT[f].getWidth()+a}return(e-2)
},_carouselGetAbsPos:function(a){this._mainElements.carouselUl.setStyle({left:(a)+"px"})},_carouselPrev:function(){if(!this._carFlags.scrolling){this._carFlags.scrolling=true;var k=this._carFlags.curFirst;var a=true;var h=0;var l=parseInt(this._mainElements.carouselUl.up().getStyle("width"));var i=true;while(a){h+=this.imagesT[k].getWidth()+this._carFlags.spacer;if(h>=l){a=false}else{if(k==0){k=this.imagesT.length-1;i=false}else{k--}}}if(i){var j=(this._posThumb[k]+this._getCarouselGroupWidth())*-1;
new Effect.Move(this._mainElements.carouselUl,{x:j,y:0,duration:0.3,mode:"absolute",afterFinish:this._carFlags.scrolling=false})}else{var j=this._posThumb[k]*-1;this._carFlags.adjustedPos=(this._posThumb[k]+this._getCarouselGroupWidth())*-1;new Effect.Move(this._mainElements.carouselUl,{x:j,y:0,duration:0.3,mode:"absolute",afterFinish:this._carouselAdjust.bind(this)})}this._carFlags.curFirst=k}},_carouselAdjust:function(){this._carouselGetAbsPos(this._carFlags.adjustedPos);this._carFlags.scrolling=false
},_carouselNext:function(){if(!this._carFlags.scrolling){this._carFlags.scrolling=true;var k=this._carFlags.curFirst;var a=true;var h=0;var l=parseInt(this._mainElements.carouselUl.up().getStyle("width"));var i=true;while(a){h+=this.imagesT[k].getWidth()+this._carFlags.spacer;if(h>=l){a=false}else{k++;if(k==this.imagesT.length){k=0;i=false}}}if(i){var j=(this._posThumb[k]+this._getCarouselGroupWidth())*-1;new Effect.Move(this._mainElements.carouselUl,{x:j,y:0,duration:0.3,mode:"absolute",afterFinish:this._carFlags.scrolling=false})
}else{var j=(this._posThumb[k]+(this._getCarouselGroupWidth()*2))*-1;this._carFlags.adjustedPos=(this._posThumb[k]+this._getCarouselGroupWidth())*-1;new Effect.Move(this._mainElements.carouselUl,{x:j,y:0,duration:0.3,mode:"absolute",afterFinish:this._carouselAdjust.bind(this)})}this._carFlags.curFirst=k}},_carouselStartObserve:function(){this._mainElements.carousel.down("a").observe("click",this._carouselPrev.bind(this));this._mainElements.carousel.down("a.ep-carousel-next").observe("click",this._carouselNext.bind(this))
},_carouselStopObserve:function(){this._mainElements.carousel.down("a").stopObserving("click");this._mainElements.carousel.down("a.ep-carousel-next").stopObserving("click")},_reset:function(){this._carFlags.curFirst=0;this.images=new Array();this.imagesT=new Array();this._mainElements.carouselUl.update("")},_initCarousel:function(){var d=this._getCarouselGroupWidth();if(d>parseInt(this._mainElements.carouselUl.up().getStyle("width"))){this._mainElements.carouselUl.setStyle({width:(d*3.1)+"px"});for(var a=0;
a<3;a++){this._flags.totalGroups++;this._addCarouselGroup()}this._carouselStartObserve();this._carouselGetAbsPos((d*-1)-3)}else{this._mainElements.carousel.down("a").addClassName("disabled");this._mainElements.carousel.down("a.ep-carousel-next").addClassName("disabled");this._addCarouselGroup(d)}if(this._mainElements.arrow_right.hasClassName("disabled")){this._mainElements.arrow_right.up().removeClassName("disabled");this._mainElements.arrow_left.up().removeClassName("disabled")}this._mainElements.pictureCounter.setStyle({display:"block"});
new Effect.Appear(this._mainElements.carousel)},_getImagesFromSource:function(g){var h=Object.toJSON(g).evalJSON();if(h){for(var i=0;i<h.photos.length;i++){var j=new dtvImage();var a=new dtvImage();j.description=h.photos[i].description;j.fileName=h.photos[i].url;j.scaleH=72;if(h.photos[i].orientation=="Horizontal"){j.width=400;j.height=300}else{j.width=400;j.height=300}if(h.photos[i].thumbnail.length==0){a=j}else{a.description=h.photos[i].description;a.fileName=h.photos[i].thumbnail}this.images[i]=j;
this.imagesT[i]=a}}else{this.el.remove()}},show:function($super,e){this.images=null;this.images=new Array();this._reset();var f="";if(e==null){f=holder.options.galleryTitle;this._flags.currentIndex=holder._currentIndex;this._getImages()}else{f=e.title;this._flags.currentIndex=0;this._getImagesFromSource(e)}this._adjustLightBoxSize();$super();if(this.images.length>1){this.el.down().down("div").down("div").down("div").childElements()[4].down("div",1).setStyle("display:block;");this.el.down().down("div").down("div").down("div").childElements()[4].down("div",2).setStyle("display:block;");
this._mainElements.photoContainer.observe("mouseout",this._hideArrows.bind(this));this.el.down("div.lightbox-content").addClassName("activeWindow");this.startObserve()}else{this._mainElements.carousel.down().setStyle({display:"none"});this._flags.hasCarousel=false;this._mainElements.arrow_right.up().addClassName("disabled");this._mainElements.arrow_left.up().addClassName("disabled");this._mainElements.arrow_right.setStyle({display:"none"});this._mainElements.arrow_left.setStyle({display:"none"});
this._mainElements.carousel.setStyle({height:"0"});var a=this.el.getDimensions().height-1;this.el.down("div.lightbox-content").setStyle({height:a+"px"});this.el.down("div.lightbox-tup").addClassName("activeWindow")}this._changeTitle(f);if(this._flags.hasCarousel===true){this._initCarousel()}this._changeImage(this._flags.currentIndex)},_afterShow:function($super){$super()},hide:function($super){this._carouselStopObserve();if(this.images.length>1){this.stopObserve()}$super()},startObserve:function(){this.el.down("div.photo-head").observe("mouseover",this.hideArrows.bind(this));
this.el.down("div.carousel-container").down().observe("mouseover",this.hideArrows.bind(this));this.el.down("div.left-arrow").observe("click",this.prev.bind(this));this.el.down("div.left-arrow").observe("mouseover",this.hoverArrowLeft.bind(this));this.el.down("div.photo-container").observe("mouseover",this.hoverArrow.bind(this));this.el.down("div.left-arrow").observe("mouseout",this.hoverArrowRemoveLeft.bind(this));this.el.down("div.right-arrow").observe("click",this.next.bind(this));this.el.down("div.right-arrow").observe("mouseover",this.hoverArrowRight.bind(this));
this.el.down("div.right-arrow").observe("mouseout",this.hoverArrowRemoveRight.bind(this));if(this._flags.hasCarousel==true){this._mainElements.arrow_left.setStyle({display:"block"});this._mainElements.arrow_right.setStyle({display:"block"})}},stopObserve:function(){this.el.down("div.left-arrow").stopObserving("click");this.el.down("div.left-arrow").stopObserving("mouseover");this.el.down("div.left-arrow").stopObserving("mouseout");this.el.down("div.right-arrow").stopObserving("click");this.el.down("div.right-arrow").stopObserving("mouseover");
this.el.down("div.right-arrow").stopObserving("mouseout")},next:function(){if(!this._flags.loading){this._flags.currentIndex++;if(this._flags.currentIndex>=this.images.length){this._flags.currentIndex=0}this._changeImage(this._flags.currentIndex)}},prev:function(){if(!this._flags.loading){if(this._flags.currentIndex==0){this._flags.currentIndex=this.images.length-1}else{this._flags.currentIndex--}this._changeImage(this._flags.currentIndex)}},_validateKey:function(a){if(a.keyCode==Event.KEY_RIGHT){this.next()
}if(a.keyCode==Event.KEY_LEFT){this.prev()}}}};Dtv.Behaviors.create(b)})();(function(){var b={name:"closingOfferLightbox",autoMapping:"closing-offer-div",inherits:"Lightbox",options:{hideOnEscape:true,width:794,zIndex:1001},prototype:{_init:function($super){$super();var e=$("closingOfferTerms");var f=$("btn_closing_offer_remove");var a=$("btn_closing_offer_cart");if(f){this.onDom(f,"click",function(c){if(Reporting&&Reporting.UserActionManager&&Reporting.UserActionManager.reportClosingOfferEvent){var d=$("closing-offer-id");
d=d?d.value:"";var h=$("closing-offer-promo-id");h=h?h.value:"";Reporting.UserActionManager.reportClosingOfferEvent(d,h,"Not Accepted")}}.curry(this))}if(a){this.onDom(a,"click",function(c){if(Reporting&&Reporting.UserActionManager&&Reporting.UserActionManager.reportClosingOfferEvent){var d=$("closing-offer-id");d=d?d.value:"";var h=$("closing-offer-promo-id");h=h?h.value:"";Reporting.UserActionManager.reportClosingOfferEvent(d,h,"Accepted")}if((document.URL).indexOf("shopping_cart")>-1){c.hide()
}}.curry(this))}this.update();new Dtv.FormController($("remove_closing_offer_form"),{onSubmitSuccess:function(c,d,h){c.hide();if((document.URL).indexOf("shopping_cart")>-1){window.location=window.location}}.curry(this),onSubmitFailure:function(c,d,h){c.hide()}.curry(this)})},_initEvents:function(){this.onDom(this.el,"click",{".js-closingOfferLightbox-toggleTermsConditions":this._handleToggleTermsConditions},this);this.onDom(this.el,"click",{".lb-close":this.hide},this)},_handleToggleTermsConditions:function(d,a){this._togglePane("lb_scroll-tab","Close")
},hide:function($super){$super()},show:function($super){$super()},_togglePane:function(e,a){if(!this._vPaneTriggerEl){return}var f=this._vPaneTriggerEl.hasClassName(e+"-active");this.vertPanes.togglePane(this._vPaneTriggerEl,e,a);this.el.select("#btn_closing_offer_remove").invoke(((f)?"enable":"disable"));this.el.select("#btn_closing_offer_cart").invoke(((f)?"enable":"disable"))},_initLayout:function($super){$super();this.show()},refreshLayout:function($super){if(this.vertPanes){var a=this.vertPanes.getNavItem(0).getHeight();
if(a>0){var d={height:a+"px"};this.vertPanes.el.up().setStyle(d);this.vertPanes.getNavItem(1).setStyle(d)}$super();this.vertPanes.update()}},update:function(d){if(d){this.el.update(d)}this.el.show();this._contentEl=this.el.down(".js-ajax-content");this._flyoutItemEls=this.el.select(".js-flyout-item");this._flyoutContentEls=this.el.select(".js-flyout-content");this._vPaneTriggerEl=this.el.down(".lb_scroll-tab, .js-lb-privpolicy");var a=this.el.down("ul.flyout-v-panes");if(a){this.vertPanes=a.behavior("ScrollablePane")
}if(d){if(!this._noShowItemAfterUpdate){this.showItem(this.currentItemIndex)}this._initDefaultState()}}}};Dtv.Behaviors.create(b)})();