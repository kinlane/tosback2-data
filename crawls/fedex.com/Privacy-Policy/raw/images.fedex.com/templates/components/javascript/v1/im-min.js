var IM=IM||function(){var version="1400.042013.2",_xp1_o="37257",_xp1_uuid=getcookie("xp1_uid"),_xp1_random=Math.floor(Math.random()*99),_xp1_qsNameValuePairs={ssv_callback:"IM.setPlacements"},_cvp_qsNameValuePairs={cvp_callback:"IM.setCVPPlacements"},maxIMTime=1500,maxIMTimeFO=2000,turnOffIM=false,g_timeout=null,g_Displayed=false,g_fcl_uuid=getcookie("fcl_uuid"),g_currentPageManifest=null,flashMovie=null,isFlashReady=false,containerReady=false,testSite=getIsTestEnv(),jsRootPath=getHostRoot()+"/templates/components/javascript",g_failoverList=[],sonarPage=false,sonarLoc="FHP",loginStatus=false,sonarTP="FDXPR",sonarDest="FEDEX.COM",sonarLang="en-US",defs={sig_svc_type:{none:0,release:1,indirect:2,direct:3,adult:4}};checkForDisable();processCurrentPage(true);function processCurrentPage(internal){var bmFilePath="",wss_pagename=null,scode_pagename=null;if(isUsHomePage()){loadScript("loginbm",jsRootPath+"/us/en/bagmappings/usHome_bm.js")}else{wss_pagename=getWssPageName();scode_pagename=getSCodePageName();if(typeof window.IM!=="undefined"&&typeof IM.im_page_manifest!=="undefined"){processManifest(wss_pagename,scode_pagename,internal)}else{loadScript("im-manifest",jsRootPath+"/v1/im-manifest-min.js",function(){processManifest(wss_pagename,scode_pagename,internal)})}}}function processManifest(wss_pagename,scode_pagename,internal){try{var manifest=null;var nixRequest=false;if(IM.im_page_manifest&&(wss_pagename||scode_pagename)){for(var keyname in IM.im_page_manifest){if(wss_pagename.toLowerCase().indexOf(keyname.toLowerCase())>-1||scode_pagename.toLowerCase().indexOf(keyname.toLowerCase())>-1){manifest=IM.im_page_manifest[keyname];break}}if(manifest){g_currentPageManifest=manifest;if(typeof manifest.includeFiles!=="undefined"){for(var ii=0;ii<manifest.includeFiles.length;ii++){var cb=(typeof manifest.includeFiles[ii].callback==="function")?manifest.includeFiles[ii].callback:null;loadScript(manifest.includeFiles[ii].name,manifest.includeFiles[ii].path,cb)}}if(typeof manifest.integration!=="undefined"){if(manifest.integration.type==="tnt"){makeSureJQuery(function(){var $placement_divs=$("div[id^='placement_']");if(typeof fdx_mbox_is_disabled!=="undefined"&&fdx_mbox_is_disabled){setDefaultPlacements($placement_divs)}else{if(typeof window.mboxFactoryDefault==="undefined"){attachEventHandler("MboxLoaded",function(){injectMboxPlacements($placement_divs)})}else{injectMboxPlacements($placement_divs)}}})}}if(typeof manifest.sonarPage!=="undefined"){sonarPage=(manifest.sonarPage==true)?true:false;loginStatus=(typeof manifest.sonarPageLogin!=="undefined"&&manifest.sonarPageLogin==true)?true:false;sonarLoc=(typeof manifest.sonarLocation!=="undefined")?manifest.sonarLocation:"FHP";sonarTP=(typeof manifest.sonarTouchpoint!=="undefined")?manifest.sonarTouchpoint:"FDXPR";sonarDest=(typeof manifest.sonarDestination!=="undefined")?manifest.sonarDestination:"FEDEX.COM";sonarLang=(typeof manifest.sonarLanguage!=="undefined")?manifest.sonarLanguage:"en-US"}if(typeof manifest.preRequestProcess!=="undefined"){var ret=manifest.preRequestProcess();if(typeof(ret)=="boolean"){nixRequest=ret}}if(!nixRequest){if(typeof manifest.bagMapFile!=="undefined"){loadScript("bagmap",getHostRoot()+manifest.bagMapFile)}if(typeof manifest.deferDisplay!=="undefined"){if(!manifest.deferDisplay){loadIMScript("D")}else{if(typeof internal=="undefined"){loadIMScript("D")}}}else{loadIMScript("D")}}if(typeof manifest.postRequestProcess!=="undefined"){manifest.postRequestProcess()}if(typeof manifest.registerEvents!=="undefined"){makeSureJQuery(function(){wireUpJQueryEvents(manifest)})}if(typeof manifest.pixels!=="undefined"){for(var ii=0;ii<manifest.pixels.length;ii++){manifest.pixels[ii].firePixel()}}}}}catch(e){}}function setDefaultPlacements($placement_divs){$placement_divs.each(function(idx,item){setSinglePlacement(g_currentPageManifest.failoverPlacements[item.id],item.id)})}function injectMboxPlacements($placement_divs){try{$placement_divs.each(function(idx,item){$(this).wrap('<div class="mboxDefault" />');mboxDefine(item.id,"fedex_"+item.id);mboxUpdate("fedex_"+item.id)});toggleDivDisplay($placement_divs,false);$placement_divs.each(function(idx,item){setSinglePlacement(g_currentPageManifest.failoverPlacements[item.id],item.id)});if($placement_divs.length>0){window.scTimeout=setTimeout(function(){toggleDivDisplay($placement_divs,true);fdx_fireSDotT();s.pageLoadComplete=true;var scCompleteEvent=fdx_createCustomEvent("SCPageLoaded");fdx_dispatchCustomEvent(scCompleteEvent);window.scTimeout=false},4000);runWhenMboxesReady(function(){if(window.scTimeout){clearTimeout(scTimeout);fdx_fireSDotT();s.pageLoadComplete=true;var scCompleteEvent=fdx_createCustomEvent("SCPageLoaded");fdx_dispatchCustomEvent(scCompleteEvent)}})}}catch(e){}}function attachEventHandler(eventName,func){if(document.addEventListener){document.addEventListener(eventName,function(){func()},false)}else{if(document.attachEvent){document.documentElement.attachEvent("onpropertychange",function(event){if(event.propertyName==eventName){func()}})}}}function toggleDivDisplay($divs,bShow){var dispVal=(bShow==true)?"display":"none";var visVal=(bShow==true)?"visible":"hidden";$divs.css("visibility",visVal);$divs.css("display",dispVal)}function runWhenMboxesReady(func){var successful=true;mboxFactoryDefault.getMboxes().each(function(mbox){if(mbox.getName()!="SiteCatalyst: event"&&mbox.isActivated()!=1){successful=false}});if(successful){func()}else{var callee=arguments.callee;var args=Array.prototype.slice.call(arguments);setTimeout(function(){callee.apply({},args)},500)}}function wireUpJQueryEvents(manifest){for(var i=0;i<manifest.registerEvents.length;i++){var re=manifest.registerEvents[i];var es=re.elementSelector;var em=re.eventMap;var sf=re.selectorFilter;var ed=re.eventData;jQuery(es).on(em,sf,ed)}}function makeSureJQuery(callback){if(typeof window.jQuery=="undefined"&&!isUsHomePage()){loadScript("jquery",getHostRoot()+"/templates/components/libraries/1.0/jQuery/1.7.2/jquery.min.js",function(){callback()})}else{callback()}}function getHostRoot(){var hostRoot="//images.fedex.com";if(testSite==true){hostRoot=""}else{if(window.location.hostname.indexOf("mnfxuat")>-1){hostRoot="//wwwtest.fedex.com"}}return hostRoot}function getIsTestEnv(){var wwwHost=window.location.hostname;var matched=wwwHost.match(/www(base|dev|drt|stress|bit|test)/gi);return(matched!==null)?true:false}function getSCodePageName(){var temppagename="";try{if(typeof s!=="undefined"){temppagename=s.pageName.toString();temppagename=temppagename.replace(/[^a-zA-Z0-9\_\s\/\\]+/g,"");temppagename=temppagename.replace(/[\s/:-]/g,"_")}return temppagename}catch(ex){temppagename=null}}function getWssPageName(){var pagename=null,despaced=null,whitelist=null;try{pagename=getMetaTagValue("wssmlc")+getMetaTagValue("wsstitle");whitelist=pagename.replace(/[^a-zA-Z0-9\_\s\/\\]+/g,"");despaced=whitelist.replace(/[\s/:-]/g,"_")}catch(ex){despaced=null}return despaced}function handlePlacementClick(ev){}function setPlacements(placements){clearTimeout(g_timeout);if(g_Displayed){return}for(var p in placements){setSinglePlacement(placements[p],p)}sendFailoverDetails()}function getFileType(filename){var ft="img";var ext=filename.split(".").pop();if(ext.indexOf("htm")>-1){ft="html"}else{if(ext==="swf"){ft="swf"}}return ft}function injectHtml(placementDiv,placementObj,cid){var $placement_div=$(placementDiv);$placement_div.load(placementObj.creativeSource,function(){setupHtmlClickThrus($placement_div,placementObj,cid)})}function setupHtmlClickThrus($placement_div,placementObj,cid){var clickURL=(typeof placementObj.clickURL!=="undefined"&&placementObj.clickURL!==null)?placementObj.clickURL:"";var creativeLink=(typeof placementObj.creativeLink!=="undefined"&&placementObj.creativeLink!==null)?placementObj.creativeLink:"";$("a[href]",$placement_div).each(function(idx,item){var href=item.hash;if(!(href.indexOf("#")===0)){var a_href=$(this).attr("href");creativeLink=(a_href!=="")?a_href:creativeLink;$(this).attr("href",clickURL+creativeLink+getParamSeparator(creativeLink)+"INTCMP="+cid)}})}function setSinglePlacement(placementObj,divID){try{var clickThruURL="";var cid=(typeof placementObj.iMarketID!="undefined"&&placementObj.iMarketID!=null)?placementObj.iMarketID:placementObj.creativeID;if(divID=="bag_placement"){clickThruURL=(typeof placementObj.clickURL!=="undefined"&&placementObj.clickURL)?placementObj.clickURL:"";function setBagPlacement(){try{if(isFlashReady){flashMovie=getFlashMovieObject("bagShell");flashMovie.goCVP(cid,clickThruURL);clearInterval(bagSetInterval)}}catch(e){}}var bagSetInterval=setInterval(setBagPlacement,100);var bagTimeout=setTimeout(function(){clearInterval(bagSetInterval)},3000);return}if(!cid){return}var placementDiv=document.getElementById(divID);if(!placementDiv){addToFailoverList({placementID:divID,errCode:"4",errDesc:"Placement div not found on page",xp1Received:cid},false,false);return}if(typeof g_currentPageManifest!=="undefined"&&g_currentPageManifest!==null&&typeof placementObj.creativeSource!=="undefined"){var fileType=getFileType(placementObj.creativeSource);if(fileType==="html"){makeSureJQuery(function(){injectHtml(placementDiv,placementObj,cid)})}else{clickThruURL=(typeof placementObj.clickURL!=="undefined"&&placementObj.clickURL)?placementObj.clickURL+placementObj.creativeLink:placementObj.creativeLink;placementDiv.innerHTML="<a href='"+clickThruURL+getParamSeparator(placementObj.creativeLink)+"INTCMP="+cid+"'><img border='0' src='"+placementObj.creativeSource+"'/></a>"}}else{var creative=xp1_bagMapping[cid];if(!creative){addToFailoverList({placementID:divID,errCode:"2",errDesc:"Mismatch - Creative not found in bm file",xp1Received:cid},true,false)}clickThruURL=(placementObj.clickURL)?placementObj.clickURL+creative.url:creative.url;placementDiv.innerHTML="<a href='"+clickThruURL+getParamSeparator(creative.url)+"INTCMP="+cid+"'><img border='0' src='"+creative.image+"'/></a>"}g_Displayed=true;try{if(g_currentPageManifest&&typeof g_currentPageManifest.integration!=="undefined"&&g_currentPageManifest.integration.type==="tnt"){return}scDsp(cid);if(!_xp1_uuid){if(divID==="placement_1"){_xp1_uuid=(placementObj.xp1_id)?placementObj.xp1_id:"";checkCookie(_xp1_uuid)}}}catch(e){}}catch(ex){}}function addToFailoverList(objFO,bDisplayFO,bSonar){if(objFO!=null&&g_failoverList.length<11){var dp=(typeof objFO.placementID!="undefined"&&objFO.placementID)?xp1_failoverPlacements[objFO.placementID].creativeID:"null";objFO.displayedPlacement=dp;g_failoverList.push(objFO);if(bDisplayFO){setSinglePlacement(xp1_failoverPlacements[objFO.placementID],objFO.placementID)}}}function setCVPPlacements(Sonar_response_obj){var bagCode=null,sagCode=null,bagClickThrURL=null,sagClickThrURL=null;var nonCVP=false;clearTimeout(g_timeout);var divID="placement_1";try{if(!Sonar_response_obj){addToFailoverList({placementID:divID,errCode:"196",errDesc:"Got empty sonar response"},true,true)}var statusCode=Sonar_response_obj.Sonar_response.status;if(!statusCode){addToFailoverList({placementID:divID,errCode:"105",errDesc:"No status code in sonar response"},true,true)}var divID="BAG";if(statusCode==="00"||statusCode==="01"||statusCode==="02"||statusCode==="99"){if(statusCode==="00"&&isUsHomePage()||statusCode=="00"&&loginStatus==true){bagCode=Sonar_response_obj.Sonar_response.trackingCodes.bagCode;bagClickThrURL=Sonar_response_obj.Sonar_response.trackingCodes.bagClickThrURL;if(!bagCode){addToFailoverList({placementID:divID,errCode:"106",errDesc:"Bag Code Not Found in Sonar Response"},false,true)}if(!bagClickThrURL){}}else{if(statusCode==="02"){bagCode="failover_us";bagClickThrURL=""}}divID="placement_1";if(statusCode==="00"||statusCode==="02"){var myZones=Sonar_response_obj.Sonar_response.zones;if(!myZones){addToFailoverList({placementID:divID,errCode:"108",errDesc:"No Zone list defined"},true,true)}for(var zone in myZones){if(!myZones.hasOwnProperty(zone)){continue}if(!zone){addToFailoverList({placementID:divID,errCode:"109",errDesc:"Zone obj not found"},true,true)}var code=myZones[zone].code;if(!code){addToFailoverList({placementID:divID,errCode:"110",errDesc:"Zone code not found"},true,true)}if(code==="RC"){var myMessages=myZones[zone].messages;divID="placement_cvp";if(!myMessages){continue}for(var msg in myMessages){if(!myMessages.hasOwnProperty(msg)){continue}if(!msg){addToFailoverList({placementID:divID,errCode:"112",errDesc:"No Message Obj for Zone - RC"},false,true)}else{var placement=document.getElementById(divID);if(placement){placement.innerHTML=myMessages[msg].message;g_Displayed=true}else{addToFailoverList({placementID:divID,errCode:"104",errDesc:"No placement div"},false,true)}}}}if(code==="FC"){var myMessages=myZones[zone].messages;divID="placement_1";if(!myMessages){continue}for(var msg in myMessages){if(!myMessages.hasOwnProperty(msg)){continue}if(!msg){addToFailoverList({placementID:divID,errCode:"115",errDesc:"No Message Obj for Zone - FC"},true,true)}else{nonCVP=(myMessages[msg].message.indexOf("HALGENERIC00000")>-1)?true:false;var placement=document.getElementById(divID);if(placement){placement.innerHTML=myMessages[msg].message;g_Displayed=true}else{addToFailoverList({placementID:divID,errCode:"104",errDesc:"No placement_1 div"},false,true)}}}}}var showIt=true;if(typeof g_currentPageManifest!=="undefined"&&g_currentPageManifest&&typeof g_currentPageManifest.sonarPageParam!=="undefined"&&g_currentPageManifest.sonarPageParam==="FPP"&&nonCVP){showIt=false}setCookie("show-mfxr",showIt,"365","/",".fedex.com");toggleRewardsLinks(showIt)}else{if(statusCode==="01"){divID="placement_1";bagCode=Sonar_response_obj.Sonar_response.trackingCodes.bagCode;sagCode=Sonar_response_obj.Sonar_response.trackingCodes.sagCode;bagClickThrURL=Sonar_response_obj.Sonar_response.trackingCodes.bagClickThrURL;sagClickThrURL=Sonar_response_obj.Sonar_response.trackingCodes.sagClickThrURL;if(!bagCode){addToFailoverList({placementID:divID,errCode:"106",errDesc:"Bag Code Not Found in Sonar Response"},false,true)}if(!bagClickThrURL){addToFailoverList({placementID:divID,errCode:"107",errDesc:"Bag ClickThru Url Not Found in Sonar Response"},false,true)}if(!sagCode){return}if(!sagClickThrURL){return}if(sagCode){var creative=xp1_bagMapping[sagCode];if(!creative){addToFailoverList({placementID:divID,errCode:"102",errDesc:"Mismatch - Creative not found in bm file",xp1Received:sagCode},true,true)}else{var placement1=document.getElementById(divID);if(placement1){placement1.innerHTML="<a href='"+sagClickThrURL+creative.url+getParamSeparator(creative.url)+"INTCMP="+sagCode+"'><img border='0' src='"+creative.image+"'/></a>";g_Displayed=true;try{scDsp(sagCode)}catch(e){}}else{addToFailoverList({placementID:divID,errCode:"104",errDesc:"No placement div"},false,true)}}}setCookie("show-mfxr",false,"365","/",".fedex.com");toggleRewardsLinks(false)}else{if(statusCode==="99"){addToFailoverList({placementID:divID,errCode:"199",errDesc:"Error 99 from Sonar"},true,true)}else{addToFailoverList({placementID:divID,errCode:"197",errDesc:"Unknown Error code in Sonar response"},true,true)}}}}else{addToFailoverList({placementID:divID,errCode:"198",errDesc:"Unknown Error in Sonar Flow"},true,true)}}catch(ex){}function setBagPlacement(){try{if(isFlashReady){flashMovie=getFlashMovieObject("bagShell");flashMovie.goCVP(bagCode,bagClickThrURL);clearInterval(bagSetInterval)}}catch(e){}}var bagSetInterval=setInterval(setBagPlacement,100);var bagTimeout=setTimeout(function(){clearInterval(bagSetInterval)},3000);sendFailoverDetails()}function getParamSeparator(baseURL){return(baseURL!=null&&baseURL.indexOf("?")>-1)?"&":"?"}function isUsHomePage(){return(getMetaTagValue("wssmlc").indexOf("US/Home")>-1)}function useSonar(){return(isUsHomePage()&&amILoggedIn()||sonarPage==true&&loginStatus==false||sonarPage==true&&loginStatus==true&&amILoggedIn())}function loadIMScript(type,tag,addtlTargetingInfo){try{if(!turnOffIM){var script_url="",script_id="",imid="",runme=false,isHome=isUsHomePage(),sErr="";if(g_currentPageManifest&&typeof g_currentPageManifest.testPlacements!=="undefined"){setPlacements(g_currentPageManifest.testPlacements);runme=false}if(g_currentPageManifest){if(typeof g_currentPageManifest.xp1Name!=="undefined"){xp1_t=g_currentPageManifest.xp1Name}if(typeof g_currentPageManifest.failoverPlacements!=="undefined"){xp1_failoverPlacements=g_currentPageManifest.failoverPlacements}}if(useSonar()){runme=true;script_url="https://"+requestCVPDomain()+"/sonarService?data="+createCVPString();imid="cvpScript"}else{runme=true;script_url=getProtocol()+"://"+requestDomain()+"/meta"+createQueryString(type,tag,addtlTargetingInfo);imid="xp1Script"}if(runme){script_id=imid+type;loadScript(script_id,script_url);if(type==="D"){g_timeout=setTimeout(function(event){var scripts=document.getElementsByTagName("script");for(var i=0;i<scripts.length;i++){if(scripts[i].id===script_id){if(g_Displayed){return}var head=document.getElementsByTagName("HEAD").item(0);head.removeChild(scripts[i]);sErr=(imid=="cvpScript")?"103":"3";addToFailoverList({errCode:sErr,errDesc:"Got response but timed out before we could display - used all failover defaults"});setPlacements(xp1_failoverPlacements);var imgFail=new Image();imgFail.src="/images/ascend/shared/headers/corp_logo.gif?xp1_response_failure";return}}sErr=(imid=="cvpScript")?"101":"1";addToFailoverList({errCode:sErr,errDesc:"Timed out before we got a response - use all failover defaults"});setPlacements(xp1_failoverPlacements)},maxIMTime)}}}else{setPlacements(xp1_failoverPlacements)}}catch(ex){}}function loadChatScript(){loadScript("atgsvcsScript","//static.atgsvcs.com/js/atgsvcs.js",function(){if(ATGSvcs!==null){ATGSvcs.setUOID(200106298424)}})}function getSSVParameters(){var ssvParameters="";var ssvIndex=0;var matches=window.location.href.match(/ssv_[^\=]*\=[^\&]*/gi);if(matches){for(ssvIndex=0;ssvIndex<matches.length;ssvIndex++){ssvParameters+=matches[ssvIndex]+"&"}}return ssvParameters}function getReferrer(){var domain=document.referrer.match(/\/\/([^\/]+)\/?/);var referringDomain="";if(domain!==null&&domain.length>1){domain=domain[1].split(".");referringDomain=domain.pop();if(domain.length>0){referringDomain=domain.pop()+"."+referringDomain}}return referringDomain}function getXP1_ConversionPageName(){var sname=getMetaTagValue("wsstitle");sname=sname.toLowerCase();sname=sname.replace(/^\+/g,"");sname=sname.replace(/\+/g," ");var spath=getMetaTagValue("wssmlc");spath=spath.toLowerCase();spath=spath.substring(6);spath=spath.replace(/\/+/g," ");if(spath.indexOf("inet")>-1){sname="inet label "+sname}else{if(spath.indexOf("supplies")>-1){sname="supplies "+sname}else{if(spath.indexOf("wgrt")>-1){sname="rating "+sname}else{if(spath.indexOf("pickup")>-1){sname="pickup confirmation"}else{if(spath.indexOf("oadr")>-1){sname="oadr confirmation"}else{if(spath.indexOf("gfbo")>-1){sname="global fedex billing online"}else{if(spath.indexOf("detail tracking")>-1){sname="tracking results"}else{if(spath.indexOf("lite")>-1){sname="lite-conf-"+LSHP.bean.get("country")+"-"+LSHP.bean.get("language")}}}}}}}}sname=sname.replace(/\ /g,"-");return sname}function createQueryString(type,tag,addtlTargetingInfo){var qs="?_o="+_xp1_o;var _t="";if(type==="B"){_t="behavior"}else{if(type==="T"){_t=getXP1_ConversionPageName();try{if(_t.indexOf("inet-label")>-1){if(typeof labelDispObj!="undefined"&&labelDispObj!=null){var svc_type="";if(labelDispObj.mobileConfirmationTrackingNumbers.length<1&&labelDispObj.labelDataList.length>0){if(labelDispObj.labelDataList[0].isReturnsLabel!=="Y"&&labelDispObj.labelDataList[0].netChargeAmount!=="0"){svc_type=labelDispObj.labelDataList[0].serviceType}}else{if(labelDispObj.mobileConfirmationTrackingNumbers.length>0){svc_type=labelDispObj.mobileLabelDataList[0].serviceType}}qs+="&ssv_044="+svc_type}}}catch(ex){}}else{_t=(typeof xp1_t!==undefined&&xp1_t!==null)?xp1_t:""}}qs+="&_t="+_t;if(type==="B"){qs+="&ssv_013="+getXP1_ConversionPageName()}qs+="&ssv_015="+g_fcl_uuid;if(type==="D"){for(var n in _xp1_qsNameValuePairs){qs+="&"+n+"="+_xp1_qsNameValuePairs[n]}qs+="&ssv_011="+_xp1_random+"&ssv_012="+getReferrer()+"&"+getSSVParameters()}if((typeof addtlTargetingInfo!=="undefined")&&(addtlTargetingInfo!==null)){if(typeof addtlTargetingInfo.ssv_values!=="undefined"){for(var ssv in addtlTargetingInfo.ssv_values){qs+="&"+ssv+"="+addtlTargetingInfo.ssv_values[ssv]}}}return qs}function sendFailoverDetails(){if((g_failoverList.length>0)&&(!turnOffIM)&&(!testSite)){var script_url=getProtocol()+"://s.xp1.ru4.com/meta"+createFailoverQueryString();var imid="xp1Fail";try{loadScript(imid,script_url)}catch(err){}g_failoverList.length=0}}function createFailoverQueryString(){var receivedPlacements="";var displayedPlacements="";var errCodes="";for(var index=0,max=g_failoverList.length;index<max;index++){var lineItem=g_failoverList[index];receivedPlacements+=(lineItem.xp1Received)?lineItem.xp1Received:"null";receivedPlacements+=(index!=max-1)?"~":"";displayedPlacements+=(lineItem.displayedPlacement)?lineItem.displayedPlacement:"null";displayedPlacements+=(index!=max-1)?"~":"";errCodes+=(lineItem.errCode)?lineItem.errCode:"3";errCodes+=(index!=max-1)?"~":""}var qs="?_o="+_xp1_o;qs+="&_t=failover";qs+="&ssv_075=";qs+=(typeof displayedPlacements!==undefined&&displayedPlacements!==null)?displayedPlacements:"null";qs+="&ssv_015=";qs+=(typeof g_fcl_uuid!==undefined&&g_fcl_uuid!==null)?g_fcl_uuid:"";qs+="&ssv_072=";qs+=(typeof receivedPlacements!==undefined&&receivedPlacements!==null)?receivedPlacements:"null";qs+="&ssv_073=";qs+=(typeof errCodes!==undefined&&errCodes!==null)?errCodes:"3";qs+="&ssv_074=";qs+=(typeof xp1_t!==undefined&&xp1_t!==null)?xp1_t:"";qs+="&ssv_076=";qs+=(testSite==true)?"stg":"s";return qs}function createCVPString(){var cvpQs='{"Sonar_request":{"guestID":"'+g_fcl_uuid+'","guestType":"IM","destination":"'+sonarDest+'","touchpoint":"'+sonarTP+'","location":"'+sonarLoc+'","langCode":"'+sonarLang+'","brand":"","style":"fdx.com-sonar","priorityOnlyFlag":"","productionFlag":"","externalData":"","_o":"37257","_t":"opCo","ssv_012":"fedex.com","ssv_011":"'+_xp1_random+'","ssv_015":"';cvpQs+=g_fcl_uuid;cvpQs+='","ssv_016":"'+getUrlParam("ssv_016")+'",';cvpQs+='"xp_uuid":"';cvpQs+=_xp1_uuid;cvpQs+='"}}';for(var n in _cvp_qsNameValuePairs){cvpQs+="&"+n+"="+_cvp_qsNameValuePairs[n]}return cvpQs}function requestCVPDomain(){if(testSite){return"mnfxuat.epsilon.com/tsonar"}else{return"sonar.fedex.com"}}function requestDomain(){if(testSite){return"stg.xp1.ru4.com"}else{return"s.xp1.ru4.com"}}function getProtocol(){var proto=window.location.protocol;if(proto.toLowerCase().indexOf("https")>-1){return"https"}return"http"}function log(tag,view){var stype="B";try{if(view!=="P"){stype="T"}}catch(e){}loadIMScript(stype,tag)}function amILoggedIn(){return !Boolean(g_fcl_uuid===""||g_fcl_uuid===";")}function setIM_Props(obj,objName){try{if(typeof obj!=="undefined"){if(typeof objName!=="undefined"){if(objName==="label_data"){logPurchase(obj)}else{if(objName==="wtrk_decisioning"&&(typeof TRAK!=="undefined")&&(typeof TRAK.bean!=="undefined")){var dex=obj.dex_code;var sigsvc=obj.sig_svc_type;var halEligible=obj.hal_eligible;if(TRAK.bean.get("cntry_code")==="US"||TRAK.bean.get("cntry_code")==="CA"){processCurrentPage(true);loadIMScript("D","",{page:"ut-trk-dtl",ssv_values:{ssv_041:sigsvc,ssv_042:halEligible,ssv_043:dex}})}}}}else{if(typeof obj.decisionDetail!=="undefined"&&typeof obj.decisionDetail.context!=="undefined"){if(obj.decisionDetail.context==="Locator Retarget"){var o=obj.decisionDetail.targetingAttributes;var filters=o.searchFilters;var locFilters=["ssv_078","ssv_079","ssv_080","ssv_081","ssv_082","ssv_083","ssv_084","ssv_085"];var ssvObj={};ssvObj.ssv_values={};ssvObj.ssv_values.ssv_076=o.country;ssvObj.ssv_values.ssv_077=o.postal;for(var i=0;i<filters.length;i++){ssvObj.ssv_values[locFilters[filters[i]]]=1}processCurrentPage(true);loadIMScript("D","",ssvObj)}}else{if(typeof obj.LogPurchaseRequest!=="undefined"){if(typeof obj.LogPurchaseRequest.clientId!=="undefined"){if(typeof obj.LogPurchaseRequest.appData!=="undefined"&&typeof obj.LogPurchaseRequest.appData.pageName!=="undefined"){if(obj.LogPurchaseRequest.clientId==="POL"){if(obj.LogPurchaseRequest.appData.pageName==="Landing"){IM.im_build_dfa("https://1186546.fls.doubleclick.net/activityi;src=1186546;type=fedex138;cat=fedex597;ord")}else{IM.im_build_dfa(formatDfaTagFromObj(obj,"1186546","fedex138","fedex597"),true)}}else{if(obj.LogPurchaseRequest.clientId==="DPC"){IM.im_build_dfa(formatDfaTagFromObj(obj,"1186546","fedex139","fedex984"),true)}}}}}}}}}catch(e){}}function formatDfaTagFromObj(obj,src,type,cat){var tag=null;try{var u1=(typeof obj.LogPurchaseRequest.appData!=="undefined"&&typeof obj.LogPurchaseRequest.appData.customerType!=="undefined")?obj.LogPurchaseRequest.appData.customerType:"";var u2=(typeof obj.LogPurchaseRequest.appData!=="undefined"&&typeof obj.LogPurchaseRequest.appData.orderType!=="undefined")?obj.LogPurchaseRequest.appData.orderType:"";var u3=(typeof obj.LogPurchaseRequest.appData!=="undefined"&&typeof obj.LogPurchaseRequest.appData.specialInstructions!=="undefined")?obj.LogPurchaseRequest.appData.specialInstructions:false;var u4=(typeof obj.LogPurchaseRequest.appData!=="undefined"&&typeof obj.LogPurchaseRequest.appData.sku!=="undefined")?obj.LogPurchaseRequest.appData.sku:"";var u5=(typeof obj.LogPurchaseRequest.currency!=="undefined")?obj.LogPurchaseRequest.currency:"USD";var qty=(typeof obj.LogPurchaseRequest.quantity!=="undefined")?obj.LogPurchaseRequest.quantity:0;var cost=(typeof obj.LogPurchaseRequest.revenue!=="undefined")?obj.LogPurchaseRequest.revenue:0;var ord=(typeof obj.LogPurchaseRequest.masterTrackingNumber!=="undefined")?obj.LogPurchaseRequest.masterTrackingNumber:"";tag="https://"+src+".fls.doubleclick.net/activityi;src="+src+";type="+type+";cat="+cat+";u1="+u1+";u2="+u2+";u3="+u3+";u4="+u4+";u5="+u5+";qty="+qty+";cost="+cost+";ord="+ord+"?"}catch(e){tag=null}return tag}function checkForDisable(){if(!turnOffIM){try{if(typeof fdx_is_eu!=="undefined"&&typeof fdx_is_disabled!=="undefined"){if(fdx_is_eu&&fdx_is_disabled){turnOffIM=Boolean(fdx_is_eu&&fdx_is_disabled)}}}catch(err){}}}function getMetaTagValue(metaName){var sreturn="";var m=document.getElementsByTagName("meta");for(var i in m){if(m[i].name===metaName){sreturn=m[i].content;break}}return sreturn}function getUrlParam(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regexS="[\\?&]"+name+"=([^&#]*)";var regex=new RegExp(regexS);var results=regex.exec(window.location.href);if(results===null){return""}else{return results[1]}}function setCookie(cookie_name,value,exdays,path,domain){if(value!==null){var exdate=new Date();exdate.setDate(exdate.getDate()+exdays);var c_value=escape(value)+((exdays===null)?"":"; expires="+exdate.toUTCString());c_value+=(typeof path!=="undefined"&&path!==null)?"; path="+path:"";c_value+=(typeof domain!=="undefined"&&domain!==null)?"; domain="+domain:"";document.cookie=cookie_name+"="+c_value}}function getcookie(cookiename){if(document.cookie.length>0){c_start=document.cookie.indexOf(cookiename+"=");if(c_start!==-1){c_start=c_start+cookiename.length+1;c_end=document.cookie.indexOf(";",c_start);if(c_end===-1){c_end=document.cookie.length}return unescape(document.cookie.substring(c_start,c_end))}}return""}function getFlashMovieObject(bagShell){if(navigator.appName.indexOf("Microsoft")!==-1){return window[bagShell]}else{return document[bagShell]}}function setIsContainerReady(){containerReady=true}function getIsContainerReady(){return true}function setflashIsReady(value){isFlashReady=value}function addWindowOnLoadEvent(func){var oldonload=window.onload;if(typeof window.onload!=="function"){window.onload=func}else{window.onload=function(){if(oldonload){oldonload()}func()}}}function isObjNullOrEmtpy(obj){if(obj===null||obj===""){return true}}function hasClass(ele,cls){return ele.className.match(new RegExp("(\\s|^)"+cls+"(\\s|$)"))}function addClass(ele,cls){if(!hasClass(ele,cls)){ele.className+=" "+cls}}function removeClass(ele,cls){if(hasClass(ele,cls)){var reg=new RegExp("(\\s|^)"+cls+"(\\s|$)");ele.className=ele.className.replace(reg," ")}}function replaceClass(ele,oldClass,newClass){if(hasClass(ele,oldClass)){removeClass(ele,oldClass);addClass(ele,newClass)}return}function toggleClass(ele,cls1,cls2){if(hasClass(ele,cls1)){replaceClass(ele,cls1,cls2)}else{if(hasClass(ele,cls2)){replaceClass(ele,cls2,cls1)}else{addClass(ele,cls1)}}}function toggleRewardsLinks(bShow){var b=document.getElementsByTagName("body")[0];if(bShow){addClass(b,"show-mfxr")}else{removeClass(b,"show-mfxr")}}(function(){toggleRewardsLinks(getcookie("show-mfxr")=="true")})();return{defs:defs,jsRootPath:jsRootPath,setPlacements:setPlacements,setCVPPlacements:setCVPPlacements,setIM_Props:setIM_Props,getMetaTagValue:getMetaTagValue,loadIMScript:loadIMScript,processCurrentPage:processCurrentPage,log:log,handlePlacementClick:handlePlacementClick,setflashIsReady:setflashIsReady,getcookie:getcookie,setCookie:setCookie,getIsContainerReady:getIsContainerReady,setIsContainerReady:setIsContainerReady,getUrlParam:getUrlParam}}();function loadScript(id,url,callback){var oScript=document.createElement("script");oScript.language="javascript";oScript.type="text/javascript";oScript.charset="utf-8";oScript.async="true";oScript.id=id;oScript.src=url;if(typeof callback!=="undefined"&&typeof callback==="function"){oScript.onloadDone=false;oScript.onload=function(){if(!oScript.onloadDone){oScript.onloadDone=true;callback()}};oScript.onreadystatechange=function(){if(("loaded"===oScript.readyState||"complete"===oScript.readyState)&&!oScript.onloadDone){oScript.onloadDone=true;callback()}}}var oHead=document.getElementsByTagName("HEAD").item(0);oHead.appendChild(oScript)}function isContainerReady(){return true}function flashReady(value){IM.setflashIsReady(value)}function checkCookie(value){var xp1_uuid=IM.getcookie("xp1_uid");if(!xp1_uuid){IM.setCookie("xp1_uid",value,90)}}(function(){try{var localeStr=s.pageName.toString().split("/");var americasCC="|ag|ai|ar|aw|bb|bm|bo|bq|br|bs|bz|ca|cl|co|cr|cw|dm|do|ec|gd|gf|gp|gt|gy|hn|ht|jm|kn|ky|lc|mf|mq|ms|mx|ni|pa|pe|pr|py|sr|sv|sx|tc|tt|us|uy|vc|ve|vg|vi|";if((localeStr[2]+localeStr[3]=="fedexindex"||s.pageName=="us/home/fedex.com/us home"||s.pageName=="ht/home/        /fedex.com/ht home/       "||s.pageName=="ca/en/fedex/content/homepage/homepage"||s.pageName=="ca/fr/fedex/content/homepage/index"||s.pageName=="vg/en/fedex/home/fedex.com/vg home")&&(americasCC.indexOf("|"+localeStr[0]+"|")>-1)){var locale=localeStr[1]+"_"+localeStr[0];if((localeStr[1]==="home")&&(localeStr[0]==="ht")){locale="en_ht"}if((localeStr[1]==="home")&&(localeStr[0]==="us")){locale="en_us"}var imgTest=new Image();imgTest.onerror=function(){var imgAka=new Image();imgAka.src="//"+window.location.hostname+"/akamai/files/akaspacer1.gif?locale="+locale};var ds="//";imgTest.src=ds+"images.fedex.com/akamai/files/akaspacer.gif"}}catch(err){}})();(function(){try{if(s.pageName=="jp/en/fedex/home"){loadScript("rum",IM.jsRootPath+"/v1/boomerang-jp.js")}if(s.pageName=="br/en/fedex/index"){loadScript("rum",IM.jsRootPath+"/v1/boomerang-br.js")}}catch(err){}})();
/*!
//@ sourceURL=__im.js
*/
