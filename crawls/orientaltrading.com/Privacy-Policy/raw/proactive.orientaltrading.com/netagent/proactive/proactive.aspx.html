var prefix = "http://proactive.orientaltrading.com/netagent/proactive/";var invLeft = 300;var invTop = 250;var invJumpDist = 1;if (typeof(talInvTop) == "number") invTop = talInvTop;if (typeof(talInvLeft) != "undefined") invLeft = talInvLeft;var pollInterval = 15000;var slidingOption = 1;var stopLoc = 500; 
var Response = {nothing : 1, showInviteNewWin : 2, showInviteSameWin : 3, pushPageSamewin : 4, pushPageNewWin : 5, inviteTimeOut: 6, resendInfo : 7, neverInvite : 8, stop : 9, notCurrentPage : 10, resize : 11, noresize : 12};if (typeof(talSlidingOpt) == "number") slidingOption = talSlidingOpt;if (typeof(talStopLoc) == "number") stopLoc = talStopLoc;if (typeof(talSlideDist) == "number") invJumpDist = talSlideDist;
var startLoc = (slidingOption == 2)? invTop : invLeft;var slideUnits = invJumpDist * ((stopLoc > -1 && startLoc > stopLoc)?-1:1);var custProp = "";if(typeof(talCustProp) != "undefined") custProp = talCustProp;
var sessWin = "n";var resizeWin;var oPopup = document.createElement("div");oPopup.id = "popupwin";document.body.appendChild(oPopup);oPopup.style.display = "none";oPopup.style.position = "absolute";oPopup.style.top = invTop + "px";oPopup.style.left = invLeft + "px";oPopup.style.zIndex = 8001;
oPopup.innerHTML = '<img id="inv" usemap="#imageMap" style="border:0px none;" /><map name="imageMap"><area shape="poly" coords="0,0,149,0,149,19,199,19,199,79,0,79" href="javascript:Accept()" onmouseover="mouseOverInvitation()" onmouseout="mouseOutOfInvitation()" /><area shape="rect" coords="150,0,199,18" href="javascript:void(0)" onclick="Decline()" onmouseover="mouseOverInvitation()" onmouseout="mouseOutOfInvitation()" /> </map>';
var lastVisitCookie = getCookie("LastVisit");var lastInviteCookie = getCookie("LastInvite");var neverCookie = getCookie("NeverInvite");if(lastVisitCookie == null){lastVisitCookie = "";}else { lastVisitCookie = getDateStringFromUTCString(lastVisitCookie); }
var dt = new Date(2999,1,1); var dtT = new Date(); var dtToday = dtT.toUTCString();setCookie("LastVisit", dtToday, dt); if(lastInviteCookie == null){lastInviteCookie = "";}else{ lastInviteCookie = getDateStringFromUTCString(lastInviteCookie); }
var resendCount = 0;var curPageID = null;var na_pro_img2 = null; function sendVisitInfo() { setCurrentPageId(); na_pro_img2 = null; na_pro_img2 = new Image(); na_pro_img2.onload = imageLoaded;var d = new Date(); na_pro_img2.src = prefix+'Visitor.aspx?Cmd=1&TITLE='+ escape((document.title != "")? document.title : document.location ) + '&REFERRER=' + escape(document.referrer) + '&LASTVISIT=' + escape(lastVisitCookie) + '&LASTINVITE=' + escape(lastInviteCookie)+ '&RSND=' + resendCount + '&CUSTOMVARIABLES=' + escape(custProp) + '&LT=' + d.getTime()+ ( (neverCookie != null)?('&NEVERINVITE=' + escape(neverCookie)) :"" ) +'&cpId=' + curPageID;  d = null; } 
function setCurrentPageId() {  var temp = new Date(); temp = temp.getTime(); curPageID = Math.floor(Math.random() * temp); temp = null;}if (navigator.cookieEnabled) sendVisitInfo();var na_pro_img = null; var pollTimerId = null; function imageLoaded() { if (na_pro_img2.width == Response.stop) {stopMonitoring = true; } else { pollTimerId = setTimeout("pollServer(2)", pollInterval); na_pro_img2.onload = null;} } function pollServer(cmd) { if (stopMonitoring) return; if (cmd == undefined) cmd = 2; var now = new Date(); na_pro_img = null; na_pro_img = new Image(); na_pro_img.onload = checkResponse; if(typeof(talCustProp) != "undefined") custProp = talCustProp;na_pro_img.src = prefix+ 'Visitor.aspx?cmd='+cmd+ '&CUSTOMVARIABLES=' + escape(custProp) + '&LASTINVITE=' + escape(lastInviteCookie)+ '&rand='+now.getTime() + '&cpId=' + curPageID; now = null; }
var stopMonitoring = false;
function checkResponse() { switch(na_pro_img.width) {case Response.nothing:break;case Response.showInviteNewWin:sessWin = 'n';popInvite();break; case Response.showInviteSameWin: sessWin = 's'; popInvite(); break; case Response.pushPageSamewin:PushPage(false);break;case Response.pushPageNewWin:PushPage(true);break; case Response.inviteTimeOut: timeOutInvite(); break;case Response.resize: resizeWin='yes'; break;case Response.noresize: resizeWin='no'; break;case Response.neverInvite: setNeverInviteCookie(); var now = new Date(); na_pro_img2.src = prefix+'Visitor.aspx?cmd=12&rand='+now.getTime(); break; case Response.resendInfo: if (navigator.cookieEnabled && resendCount < 1) { sendVisitInfo(); resendCount++; }break;case Response.stop: case Response.notCurrentPage : stopMonitoring = true; if (document.getElementById("popupwin").style.display=="block")hideInvite(false); break;default:break; } 
if (na_pro_img.width != Response.resendInfo) { resendCount = 0; pollTimerId = setTimeout("pollServer(2)", pollInterval); } }
function PushPage(bNew) { var now = new Date(); var pushUrl = prefix + 'Visitor.aspx?cmd=' + (bNew?9:6) + '&rand='+ now.getTime();if (bNew) window.open(pushUrl, "_blank"); else document.location = pushUrl; }
var ScrollPos = { timerId : null };
function getWindowDimensions() { var dim = {width : 0, height : 0} ; if( typeof( window.innerWidth ) == 'number' ){dim.width = window.innerWidth; dim.height = window.innerHeight; } else if( document.documentElement && ( document.documentElement.clientWidth || document.documentElement.clientHeight ) ) {dim.width = document.documentElement.clientWidth; dim.height = document.documentElement.clientHeight; } else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ){dim.width = document.body.clientWidth; dim.height = document.body.clientHeight; } return dim; }
function getScrollOffset() { var scrOf = { scrOfX : 0, scrOfY : 0 }; if( typeof( window.pageYOffset ) == 'number' ){scrOf.scrOfY = window.pageYOffset; scrOf.scrOfX = window.pageXOffset;}else if( document.body && ( document.body.scrollLeft || document.body.scrollTop ) ){scrOf.scrOfY = document.body.scrollTop; scrOf.scrOfX = document.body.scrollLeft;}else if( document.documentElement && ( document.documentElement.scrollLeft || document.documentElement.scrollTop ) ) { scrOf.scrOfY = document.documentElement.scrollTop; scrOf.scrOfX = document.documentElement.scrollLeft; } return scrOf; }
var wcEnabledInv = false;function popInvite() { var dt = new Date(2999,1,1); var dtT = new Date(); var dtToday = dtT.toUTCString();setCookie("LastInvite", dtToday, dt); lastInviteCookie = getDateStringFromUTCString(dtToday);wcEnabledInv = (na_pro_img.height==2) && (sessWin=='n')&&(typeof(g_theWCObj)=='object');var inInv = document.getElementById("inv"); if(inInv!=null) { var url = prefix + "Visitor.aspx?cmd=4";if(inInv.src != url) { inInv.src=url; } offsetInvite(); RW(); document.getElementById("popupwin").style.display="block";ScrollPos.timerId = window.setInterval(offsetInvite, 90); }var now = new Date(); na_pro_img2.src = prefix+'Visitor.aspx?cmd=3&rand='+now.getTime(); window.focus(); }var slideOffSetX = 0;var slideOffSetY = 0;var stopSliding = false; var slideEnded = false;
function offsetInvite(oPopupWin) { var scrOffSet = getScrollOffset(); var dim = getWindowDimensions();var left = getInvLeftOffset(scrOffSet.scrOfX, dim.width, 204);var top = getInvTopOffset(scrOffSet.scrOfY, dim.height, 84);var oPopupWin = document.getElementById("popupwin"); oPopupWin.style.top = top + "px";oPopupWin.style.left = left + "px"; }
function getInvTopOffset(scrollOffsetY, winHeight, imgHt) {var maxLocY = scrollOffsetY + winHeight - imgHt;if (maxLocY < 0 ) maxLocY = 0;var minLocY = scrollOffsetY;var stopLocY = scrollOffsetY + stopLoc;if (slidingOption == 2 && stopSliding == false) {slideOffSetY = slideOffSetY + slideUnits; }var top = invTop;var bReverse = (stopLoc > -1 && invTop > stopLoc);var bStopLocInRange = bReverse? (stopLocY > minLocY) : (stopLocY < maxLocY);if (slidingOption == 2 & slideEnded == true) { if (stopLoc > -1 && bStopLocInRange) { top = stopLocY;}else { top = bReverse? minLocY : maxLocY; } }else { top = scrollOffsetY + invTop + slideOffSetY; } var destLocY = bReverse? minLocY : maxLocY;if (slidingOption == 2 && stopLoc > -1 && bStopLocInRange){ destLocY = stopLocY; }if (bReverse?(top <= destLocY):(top >= destLocY)){if (slidingOption == 2 && slideEnded == false) { /*slideOffSetY = 0 - invTop; top = 0;*/slideEnded = true; stopSliding = true; } else { top = destLocY;  } }if (top < minLocY) { if (!bReverse) { slideOffSetY = minLocY + invTop; } top = minLocY; }if (top > maxLocY) {if (bReverse){slideOffSetY = maxLocY - invTop;}top = maxLocY;}return top;}
function getInvLeftOffset(scrollOffsetX, winWidth, imgWidth) {var maxLocX = scrollOffsetX + winWidth - imgWidth;if (maxLocX < 0 ) maxLocX = 0; var minLocX = scrollOffsetX; var stopLocX = scrollOffsetX + stopLoc;if (slidingOption == 1 && stopSliding == false) {slideOffSetX = slideOffSetX + slideUnits;}var left = invLeft; var bReverse = (stopLoc > -1 && invLeft > stopLoc);var bStopLocInRange = bReverse? (stopLocX > minLocX) : (stopLocX < maxLocX);if (slidingOption == 1 & slideEnded == true) { if (stopLoc > -1 && bStopLocInRange) {left = stopLocX; } else {left = bReverse? minLocX : maxLocX;}} else {left = scrollOffsetX + invLeft + slideOffSetX;} var destLocX = bReverse? minLocX : maxLocX;if (slidingOption == 1 && stopLoc > -1 && bStopLocInRange) {destLocX = stopLocX;}if (bReverse?(left <= destLocX):(left >= destLocX)) { if (slidingOption == 1 && slideEnded == false) {/*slideOffSetX = 0 - invLeft; left = 0;*/ slideEnded = true; stopSliding = true; }else { left = destLocX; } }if (left < minLocX) { if (!bReverse) { slideOffSetX = minLocX + invLeft;}left = minLocX; }if (left > maxLocX) { if (bReverse) { slideOffSetX = maxLocX - invLeft;}left = maxLocX;} return left; }

function hideInvite(accepted) {window.clearInterval(ScrollPos.timerId);ScrollPos.timerId = null;document.getElementById("popupwin").style.display="none";}
function setCookie(name, value, expires, path, domain, secure) {var curCookie = name + "=" + escape(value) +((expires) ? "; expires=" + expires.toUTCString() : "") + ((path) ? "; path=" + path : "") +((domain) ? "; domain=" + domain : "") + ((secure) ? "; secure" : ""); document.cookie = curCookie; }
function getCookie(name) { var dc = document.cookie; var prefix = name + "="; var begin = dc.indexOf("; " + prefix);if (begin == -1) {begin = dc.indexOf(prefix);if (begin != 0) return null;} else begin += 2;var end = document.cookie.indexOf(";", begin); if (end == -1) end = dc.length;return unescape(dc.substring(begin + prefix.length, end)); }
function getDateStringFromUTCString(utcString){utcString = utcString.substr(5);utcString = utcString.substr(0,20);return utcString;}
function Accept() { var now = new Date(); var url = prefix + 'Visitor.aspx?cmd=5&rand='+ now.getTime();if (sessWin == "n") { if (wcEnabledInv){wcEnabledInv = false; hideInvite(true); WCEChat(); return;} if(resizeWin == 'yes') {var oWin = window.open(url, "_blank", "location=no,menubar=no,toolbar=no,resizable=yes,scrollbars=yes");} else var oWin = window.open(url, "_blank", "location=no,menubar=no,toolbar=no,resizable=no,scrollbars=yes");if (oWin != null && typeof(oWin) == "object") {hideInvite(true);} else {PortalBlocked();}  } else{document.location.href = url; hideInvite(true); } }function WCEChat(){if((typeof(TALCOB)== "undefined") || !TALCOB)TALCOB = window.open("about:blank","_blank","resizable=on,location=no,menubar=no,toolbar=no"); if (TALCOB != null && typeof(TALCOB) == "object") {g_theWCObj.OnWCSessionStartedCallback = PWCSessionStartedCB; g_theWCObj.startNewSession();hideInvite(true);} else {PortalBlocked(); } }function PWCSessionStartedCB(wcString){g_theWCObj.OnWCSessionStartedCallback = null;var now = new Date(); portalLink = prefix + 'Visitor.aspx?cmd=5&rand='+ now.getTime()+wcString; if(TALCOB)TALCOB.document.location.href = portalLink;return true;}
function Decline(never) { clearTimeout(pollTimerId); if (typeof(never) == "number" && never == 1){setNeverInviteCookie(); pollServer(10);}else {pollServer(7);} hideInvite(false); }
function timeOutInvite() {hideInvite(false); var now = new Date(); na_pro_img2.src = prefix+'Visitor.aspx?cmd=11&rand='+now.getTime(); }function setNeverInviteCookie(){var dt; switch(na_pro_img.height) { case 2: dt = new Date(2000,1,1); break; default: dt = new Date(9999,1,1); break; } setCookie("NeverInvite",1,dt);}function PortalBlocked() { clearTimeout(pollTimerId); pollServer(8);  }function RW() { pollServer(13); }
function mouseOverInvitation(){stopSliding = true;} function mouseOutOfInvitation(){if (slideEnded == false) stopSliding = false; }