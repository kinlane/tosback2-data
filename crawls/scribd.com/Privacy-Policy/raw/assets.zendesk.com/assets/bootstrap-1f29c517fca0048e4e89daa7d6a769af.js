var Prototype={Version:"1.6.1",Browser:(function(){var ua=navigator.userAgent;var isOpera=Object.prototype.toString.call(window.opera)=="[object Opera]";return{IE:!!window.attachEvent&&!isOpera,Opera:isOpera,WebKit:ua.indexOf("AppleWebKit/")>-1,Gecko:ua.indexOf("Gecko")>-1&&ua.indexOf("KHTML")===-1,MobileSafari:/Apple.*Mobile.*Safari/.test(ua)}})(),BrowserFeatures:{XPath:!!document.evaluate,SelectorsAPI:!!document.querySelector,ElementExtensions:(function(){var constructor=window.Element||window.HTMLElement;return !!(constructor&&constructor.prototype)})(),SpecificElementExtensions:(function(){if(typeof window.HTMLDivElement!=="undefined"){return true}var div=document.createElement("div");var form=document.createElement("form");var isSupported=false;if(div.__proto__&&(div.__proto__!==form.__proto__)){isSupported=true}div=form=null;return isSupported})()},ScriptFragment:"<script[^>]*>([\\S\\s]*?)<\/script>",JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,emptyFunction:function(){},K:function(x){return x}};if(Prototype.Browser.MobileSafari){Prototype.BrowserFeatures.SpecificElementExtensions=false}var Abstract={};var Try={these:function(){var returnValue;for(var i=0,length=arguments.length;i<length;i++){var lambda=arguments[i];try{returnValue=lambda();break}catch(e){}}return returnValue}};var Class=(function(){function subclass(){}function create(){var parent=null,properties=$A(arguments);if(Object.isFunction(properties[0])){parent=properties.shift()}function klass(){this.initialize.apply(this,arguments)}Object.extend(klass,Class.Methods);klass.superclass=parent;klass.subclasses=[];if(parent){subclass.prototype=parent.prototype;klass.prototype=new subclass;parent.subclasses.push(klass)}for(var i=0;i<properties.length;i++){klass.addMethods(properties[i])}if(!klass.prototype.initialize){klass.prototype.initialize=Prototype.emptyFunction}klass.prototype.constructor=klass;return klass}function addMethods(source){var ancestor=this.superclass&&this.superclass.prototype;var properties=Object.keys(source);if(!Object.keys({toString:true}).length){if(source.toString!=Object.prototype.toString){properties.push("toString")}if(source.valueOf!=Object.prototype.valueOf){properties.push("valueOf")}}for(var i=0,length=properties.length;i<length;i++){var property=properties[i],value=source[property];if(ancestor&&Object.isFunction(value)&&value.argumentNames().first()=="$super"){var method=value;value=(function(m){return function(){return ancestor[m].apply(this,arguments)}})(property).wrap(method);value.valueOf=method.valueOf.bind(method);value.toString=method.toString.bind(method)}this.prototype[property]=value}return this}return{create:create,Methods:{addMethods:addMethods}}})();(function(){var _toString=Object.prototype.toString;function extend(destination,source){for(var property in source){destination[property]=source[property]}return destination}function inspect(object){try{if(isUndefined(object)){return"undefined"}if(object===null){return"null"}return object.inspect?object.inspect():String(object)}catch(e){if(e instanceof RangeError){return"..."}throw e}}function toJSON(object){var type=typeof object;switch(type){case"undefined":case"function":case"unknown":return;case"boolean":return object.toString()}if(object===null){return"null"}if(object.toJSON){return object.toJSON()}if(isElement(object)){return}var results=[];for(var property in object){var value=toJSON(object[property]);if(!isUndefined(value)){results.push(property.toJSON()+": "+value)}}return"{"+results.join(", ")+"}"}function toQueryString(object){return $H(object).toQueryString()}function toHTML(object){return object&&object.toHTML?object.toHTML():String.interpret(object)}function keys(object){var results=[];for(var property in object){results.push(property)}return results}function values(object){var results=[];for(var property in object){results.push(object[property])}return results}function clone(object){return extend({},object)}function isElement(object){return !!(object&&object.nodeType==1)}function isArray(object){return _toString.call(object)=="[object Array]"}function isHash(object){return object instanceof Hash}function isFunction(object){return typeof object==="function"}function isString(object){return _toString.call(object)=="[object String]"}function isNumber(object){return _toString.call(object)=="[object Number]"}function isUndefined(object){return typeof object==="undefined"}extend(Object,{extend:extend,inspect:inspect,toJSON:toJSON,toQueryString:toQueryString,toHTML:toHTML,keys:keys,values:values,clone:clone,isElement:isElement,isArray:isArray,isHash:isHash,isFunction:isFunction,isString:isString,isNumber:isNumber,isUndefined:isUndefined})})();Object.extend(Function.prototype,(function(){var slice=Array.prototype.slice;function update(array,args){var arrayLength=array.length,length=args.length;while(length--){array[arrayLength+length]=args[length]}return array}function merge(array,args){array=slice.call(array,0);return update(array,args)}function argumentNames(){var names=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return names.length==1&&!names[0]?[]:names}function bind(context){if(arguments.length<2&&Object.isUndefined(arguments[0])){return this}var __method=this,args=slice.call(arguments,1);return function(){var a=merge(args,arguments);return __method.apply(context,a)}}function bindAsEventListener(context){var __method=this,args=slice.call(arguments,1);return function(event){var a=update([event||window.event],args);return __method.apply(context,a)}}function curry(){if(!arguments.length){return this}var __method=this,args=slice.call(arguments,0);return function(){var a=merge(args,arguments);return __method.apply(this,a)}}function delay(timeout){var __method=this,args=slice.call(arguments,1);timeout=timeout*1000;return window.setTimeout(function(){return __method.apply(__method,args)},timeout)}function defer(){var args=update([0.01],arguments);return this.delay.apply(this,args)}function wrap(wrapper){var __method=this;return function(){var a=update([__method.bind(this)],arguments);return wrapper.apply(this,a)}}function methodize(){if(this._methodized){return this._methodized}var __method=this;return this._methodized=function(){var a=update([this],arguments);return __method.apply(null,a)}}return{argumentNames:argumentNames,bind:bind,bindAsEventListener:bindAsEventListener,curry:curry,delay:delay,defer:defer,wrap:wrap,methodize:methodize}})());Date.prototype.toJSON=function(){return'"'+this.getUTCFullYear()+"-"+(this.getUTCMonth()+1).toPaddedString(2)+"-"+this.getUTCDate().toPaddedString(2)+"T"+this.getUTCHours().toPaddedString(2)+":"+this.getUTCMinutes().toPaddedString(2)+":"+this.getUTCSeconds().toPaddedString(2)+'Z"'};RegExp.prototype.match=RegExp.prototype.test;RegExp.escape=function(str){return String(str).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")};var PeriodicalExecuter=Class.create({initialize:function(callback,frequency){this.callback=callback;this.frequency=frequency;this.currentlyExecuting=false;this.registerCallback()},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1000)},execute:function(){this.callback(this)},stop:function(){if(!this.timer){return}clearInterval(this.timer);this.timer=null},onTimerEvent:function(){if(!this.currentlyExecuting){try{this.currentlyExecuting=true;this.execute();this.currentlyExecuting=false}catch(e){this.currentlyExecuting=false;throw e}}}});Object.extend(String,{interpret:function(value){return value==null?"":String(value)},specialChar:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\\":"\\\\"}});Object.extend(String.prototype,(function(){function prepareReplacement(replacement){if(Object.isFunction(replacement)){return replacement}var template=new Template(replacement);return function(match){return template.evaluate(match)}}function gsub(pattern,replacement){var result="",source=this,match;replacement=prepareReplacement(replacement);if(Object.isString(pattern)){pattern=RegExp.escape(pattern)}if(!(pattern.length||pattern.source)){replacement=replacement("");return replacement+source.split("").join(replacement)+replacement}while(source.length>0){if(match=source.match(pattern)){result+=source.slice(0,match.index);result+=String.interpret(replacement(match));source=source.slice(match.index+match[0].length)}else{result+=source,source=""}}return result}function sub(pattern,replacement,count){replacement=prepareReplacement(replacement);count=Object.isUndefined(count)?1:count;return this.gsub(pattern,function(match){if(--count<0){return match[0]}return replacement(match)})}function scan(pattern,iterator){this.gsub(pattern,iterator);return String(this)}function truncate(length,truncation){length=length||30;truncation=Object.isUndefined(truncation)?"...":truncation;return this.length>length?this.slice(0,length-truncation.length)+truncation:String(this)}function strip(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}function stripTags(){return this.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,"")}function stripScripts(){return this.replace(new RegExp(Prototype.ScriptFragment,"img"),"")}function extractScripts(){var matchAll=new RegExp(Prototype.ScriptFragment,"img");var matchOne=new RegExp(Prototype.ScriptFragment,"im");return(this.match(matchAll)||[]).map(function(scriptTag){return(scriptTag.match(matchOne)||["",""])[1]})}function evalScripts(){return this.extractScripts().map(function(script){return eval(script)})}function escapeHTML(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function unescapeHTML(){return this.stripTags().replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function toQueryParams(separator){var match=this.strip().match(/([^?#]*)(#.*)?$/);if(!match){return{}}return match[1].split(separator||"&").inject({},function(hash,pair){if((pair=pair.split("="))[0]){var key=decodeURIComponent(pair.shift());var value=pair.length>1?pair.join("="):pair[0];if(value!=undefined){value=decodeURIComponent(value)}if(key in hash){if(!Object.isArray(hash[key])){hash[key]=[hash[key]]}hash[key].push(value)}else{hash[key]=value}}return hash})}function toArray(){return this.split("")}function succ(){return this.slice(0,this.length-1)+String.fromCharCode(this.charCodeAt(this.length-1)+1)}function times(count){return count<1?"":new Array(count+1).join(this)}function camelize(){var parts=this.split("-"),len=parts.length;if(len==1){return parts[0]}var camelized=this.charAt(0)=="-"?parts[0].charAt(0).toUpperCase()+parts[0].substring(1):parts[0];for(var i=1;i<len;i++){camelized+=parts[i].charAt(0).toUpperCase()+parts[i].substring(1)}return camelized}function capitalize(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()}function underscore(){return this.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/-/g,"_").toLowerCase()}function dasherize(){return this.replace(/_/g,"-")}function inspect(useDoubleQuotes){var escapedString=this.replace(/[\x00-\x1f\\]/g,function(character){if(character in String.specialChar){return String.specialChar[character]}return"\\u00"+character.charCodeAt().toPaddedString(2,16)});if(useDoubleQuotes){return'"'+escapedString.replace(/"/g,'\\"')+'"'}return"'"+escapedString.replace(/'/g,"\\'")+"'"}function toJSON(){return this.inspect(true)}function unfilterJSON(filter){return this.replace(filter||Prototype.JSONFilter,"$1")}function isJSON(){var str=this;if(str.blank()){return false}str=this.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"/g,"");return(/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/).test(str)}function evalJSON(sanitize){var json=this.unfilterJSON();try{if(!sanitize||json.isJSON()){return eval("("+json+")")}}catch(e){}throw new SyntaxError("Badly formed JSON string: "+this.inspect())}function include(pattern){return this.indexOf(pattern)>-1}function startsWith(pattern){return this.indexOf(pattern)===0}function endsWith(pattern){var d=this.length-pattern.length;return d>=0&&this.lastIndexOf(pattern)===d}function empty(){return this==""}function blank(){return/^\s*$/.test(this)}function interpolate(object,pattern){return new Template(this,pattern).evaluate(object)}return{gsub:gsub,sub:sub,scan:scan,truncate:truncate,strip:String.prototype.trim?String.prototype.trim:strip,stripTags:stripTags,stripScripts:stripScripts,extractScripts:extractScripts,evalScripts:evalScripts,escapeHTML:escapeHTML,unescapeHTML:unescapeHTML,toQueryParams:toQueryParams,parseQuery:toQueryParams,toArray:toArray,succ:succ,times:times,camelize:camelize,capitalize:capitalize,underscore:underscore,dasherize:dasherize,inspect:inspect,toJSON:toJSON,unfilterJSON:unfilterJSON,isJSON:isJSON,evalJSON:evalJSON,include:include,startsWith:startsWith,endsWith:endsWith,empty:empty,blank:blank,interpolate:interpolate}})());var Template=Class.create({initialize:function(template,pattern){this.template=template.toString();this.pattern=pattern||Template.Pattern},evaluate:function(object){if(object&&Object.isFunction(object.toTemplateReplacements)){object=object.toTemplateReplacements()}return this.template.gsub(this.pattern,function(match){if(object==null){return(match[1]+"")}var before=match[1]||"";if(before=="\\"){return match[2]}var ctx=object,expr=match[3];var pattern=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;match=pattern.exec(expr);if(match==null){return before}while(match!=null){var comp=match[1].startsWith("[")?match[2].replace(/\\\\]/g,"]"):match[1];ctx=ctx[comp];if(null==ctx||""==match[3]){break}expr=expr.substring("["==match[3]?match[1].length:match[0].length);match=pattern.exec(expr)}return before+String.interpret(ctx)})}});Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;var $break={};var Enumerable=(function(){function each(iterator,context){var index=0;try{this._each(function(value){iterator.call(context,value,index++)})}catch(e){if(e!=$break){throw e}}return this}function eachSlice(number,iterator,context){var index=-number,slices=[],array=this.toArray();if(number<1){return array}while((index+=number)<array.length){slices.push(array.slice(index,index+number))}return slices.collect(iterator,context)}function all(iterator,context){iterator=iterator||Prototype.K;var result=true;this.each(function(value,index){result=result&&!!iterator.call(context,value,index);if(!result){throw $break}});return result}function any(iterator,context){iterator=iterator||Prototype.K;var result=false;this.each(function(value,index){if(result=!!iterator.call(context,value,index)){throw $break}});return result}function collect(iterator,context){iterator=iterator||Prototype.K;var results=[];this.each(function(value,index){results.push(iterator.call(context,value,index))});return results}function detect(iterator,context){var result;this.each(function(value,index){if(iterator.call(context,value,index)){result=value;throw $break}});return result}function findAll(iterator,context){var results=[];this.each(function(value,index){if(iterator.call(context,value,index)){results.push(value)}});return results}function grep(filter,iterator,context){iterator=iterator||Prototype.K;var results=[];if(Object.isString(filter)){filter=new RegExp(RegExp.escape(filter))}this.each(function(value,index){if(filter.match(value)){results.push(iterator.call(context,value,index))}});return results}function include(object){if(Object.isFunction(this.indexOf)){if(this.indexOf(object)!=-1){return true}}var found=false;this.each(function(value){if(value==object){found=true;throw $break}});return found}function inGroupsOf(number,fillWith){fillWith=Object.isUndefined(fillWith)?null:fillWith;return this.eachSlice(number,function(slice){while(slice.length<number){slice.push(fillWith)}return slice})}function inject(memo,iterator,context){this.each(function(value,index){memo=iterator.call(context,memo,value,index)});return memo}function invoke(method){var args=$A(arguments).slice(1);return this.map(function(value){return value[method].apply(value,args)})}function max(iterator,context){iterator=iterator||Prototype.K;var result;this.each(function(value,index){value=iterator.call(context,value,index);if(result==null||value>=result){result=value}});return result}function min(iterator,context){iterator=iterator||Prototype.K;var result;this.each(function(value,index){value=iterator.call(context,value,index);if(result==null||value<result){result=value}});return result}function partition(iterator,context){iterator=iterator||Prototype.K;var trues=[],falses=[];this.each(function(value,index){(iterator.call(context,value,index)?trues:falses).push(value)});return[trues,falses]}function pluck(property){var results=[];this.each(function(value){results.push(value[property])});return results}function reject(iterator,context){var results=[];this.each(function(value,index){if(!iterator.call(context,value,index)){results.push(value)}});return results}function sortBy(iterator,context){return this.map(function(value,index){return{value:value,criteria:iterator.call(context,value,index)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;return a<b?-1:a>b?1:0}).pluck("value")}function toArray(){return this.map()}function zip(){var iterator=Prototype.K,args=$A(arguments);if(Object.isFunction(args.last())){iterator=args.pop()}var collections=[this].concat(args).map($A);return this.map(function(value,index){return iterator(collections.pluck(index))})}function size(){return this.toArray().length}function inspect(){return"#<Enumerable:"+this.toArray().inspect()+">"}return{each:each,eachSlice:eachSlice,all:all,every:all,any:any,some:any,collect:collect,map:collect,detect:detect,findAll:findAll,select:findAll,filter:findAll,grep:grep,include:include,member:include,inGroupsOf:inGroupsOf,inject:inject,invoke:invoke,max:max,min:min,partition:partition,pluck:pluck,reject:reject,sortBy:sortBy,toArray:toArray,entries:toArray,zip:zip,size:size,inspect:inspect,find:detect}})();function $A(iterable){if(!iterable){return[]}if("toArray" in Object(iterable)){return iterable.toArray()}var length=iterable.length||0,results=new Array(length);while(length--){results[length]=iterable[length]}return results}function $w(string){if(!Object.isString(string)){return[]}string=string.strip();return string?string.split(/\s+/):[]}Array.from=$A;(function(){var arrayProto=Array.prototype,slice=arrayProto.slice,_each=arrayProto.forEach;function each(iterator){for(var i=0,length=this.length;i<length;i++){iterator(this[i])}}if(!_each){_each=each}function clear(){this.length=0;return this}function first(){return this[0]}function last(){return this[this.length-1]}function compact(){return this.select(function(value){return value!=null})}function flatten(){return this.inject([],function(array,value){if(Object.isArray(value)){return array.concat(value.flatten())}array.push(value);return array})}function without(){var values=slice.call(arguments,0);return this.select(function(value){return !values.include(value)})}function reverse(inline){return(inline!==false?this:this.toArray())._reverse()}function uniq(sorted){return this.inject([],function(array,value,index){if(0==index||(sorted?array.last()!=value:!array.include(value))){array.push(value)}return array})}function intersect(array){return this.uniq().findAll(function(item){return array.detect(function(value){return item===value})})}function clone(){return slice.call(this,0)}function size(){return this.length}function inspect(){return"["+this.map(Object.inspect).join(", ")+"]"}function toJSON(){var results=[];this.each(function(object){var value=Object.toJSON(object);if(!Object.isUndefined(value)){results.push(value)}});return"["+results.join(", ")+"]"}function indexOf(item,i){i||(i=0);var length=this.length;if(i<0){i=length+i}for(;i<length;i++){if(this[i]===item){return i}}return -1}function lastIndexOf(item,i){i=isNaN(i)?this.length:(i<0?this.length+i:i)+1;var n=this.slice(0,i).reverse().indexOf(item);return(n<0)?n:i-n-1}function concat(){var array=slice.call(this,0),item;for(var i=0,length=arguments.length;i<length;i++){item=arguments[i];if(Object.isArray(item)&&!("callee" in item)){for(var j=0,arrayLength=item.length;j<arrayLength;j++){array.push(item[j])}}else{array.push(item)}}return array}Object.extend(arrayProto,Enumerable);if(!arrayProto._reverse){arrayProto._reverse=arrayProto.reverse}Object.extend(arrayProto,{_each:_each,clear:clear,first:first,last:last,compact:compact,flatten:flatten,without:without,reverse:reverse,uniq:uniq,intersect:intersect,clone:clone,toArray:clone,size:size,inspect:inspect,toJSON:toJSON});var CONCAT_ARGUMENTS_BUGGY=(function(){return[].concat(arguments)[0][0]!==1})(1,2);if(CONCAT_ARGUMENTS_BUGGY){arrayProto.concat=concat}if(!arrayProto.indexOf){arrayProto.indexOf=indexOf}if(!arrayProto.lastIndexOf){arrayProto.lastIndexOf=lastIndexOf}})();function $H(object){return new Hash(object)}var Hash=Class.create(Enumerable,(function(){function initialize(object){this._object=Object.isHash(object)?object.toObject():Object.clone(object)}function _each(iterator){for(var key in this._object){var value=this._object[key],pair=[key,value];pair.key=key;pair.value=value;iterator(pair)}}function set(key,value){return this._object[key]=value}function get(key){if(this._object[key]!==Object.prototype[key]){return this._object[key]}}function unset(key){var value=this._object[key];delete this._object[key];return value}function toObject(){return Object.clone(this._object)}function keys(){return this.pluck("key")}function values(){return this.pluck("value")}function index(value){var match=this.detect(function(pair){return pair.value===value});return match&&match.key}function merge(object){return this.clone().update(object)}function update(object){return new Hash(object).inject(this,function(result,pair){result.set(pair.key,pair.value);return result})}function toQueryPair(key,value){if(Object.isUndefined(value)){return key}return key+"="+encodeURIComponent(String.interpret(value))}function toQueryString(){return this.inject([],function(results,pair){var key=encodeURIComponent(pair.key),values=pair.value;if(values&&typeof values=="object"){if(Object.isArray(values)){return results.concat(values.map(toQueryPair.curry(key)))}}else{results.push(toQueryPair(key,values))}return results}).join("&")}function inspect(){return"#<Hash:{"+this.map(function(pair){return pair.map(Object.inspect).join(": ")}).join(", ")+"}>"}function toJSON(){return Object.toJSON(this.toObject())}function clone(){return new Hash(this)}return{initialize:initialize,_each:_each,set:set,get:get,unset:unset,toObject:toObject,toTemplateReplacements:toObject,keys:keys,values:values,index:index,merge:merge,update:update,toQueryString:toQueryString,inspect:inspect,toJSON:toJSON,clone:clone}})());Hash.from=$H;Object.extend(Number.prototype,(function(){function toColorPart(){return this.toPaddedString(2,16)}function succ(){return this+1}function times(iterator,context){$R(0,this,true).each(iterator,context);return this}function toPaddedString(length,radix){var string=this.toString(radix||10);return"0".times(length-string.length)+string}function toJSON(){return isFinite(this)?this.toString():"null"}function abs(){return Math.abs(this)}function round(){return Math.round(this)}function ceil(){return Math.ceil(this)}function floor(){return Math.floor(this)}return{toColorPart:toColorPart,succ:succ,times:times,toPaddedString:toPaddedString,toJSON:toJSON,abs:abs,round:round,ceil:ceil,floor:floor}})());function $R(start,end,exclusive){return new ObjectRange(start,end,exclusive)}var ObjectRange=Class.create(Enumerable,(function(){function initialize(start,end,exclusive){this.start=start;this.end=end;this.exclusive=exclusive}function _each(iterator){var value=this.start;while(this.include(value)){iterator(value);value=value.succ()}}function include(value){if(value<this.start){return false}if(this.exclusive){return value<this.end}return value<=this.end}return{initialize:initialize,_each:_each,include:include}})());var Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||false},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(iterator){this.responders._each(iterator)},register:function(responder){if(!this.include(responder)){this.responders.push(responder)}},unregister:function(responder){this.responders=this.responders.without(responder)},dispatch:function(callback,request,transport,json){this.each(function(responder){if(Object.isFunction(responder[callback])){try{responder[callback].apply(responder,[request,transport,json])}catch(e){}}})}};Object.extend(Ajax.Responders,Enumerable);Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++},onComplete:function(){Ajax.activeRequestCount--}});Ajax.Base=Class.create({initialize:function(options){this.options={method:"post",asynchronous:true,contentType:"application/x-www-form-urlencoded",encoding:"UTF-8",parameters:"",evalJSON:true,evalJS:true};Object.extend(this.options,options||{});this.options.method=this.options.method.toLowerCase();if(Object.isString(this.options.parameters)){this.options.parameters=this.options.parameters.toQueryParams()}else{if(Object.isHash(this.options.parameters)){this.options.parameters=this.options.parameters.toObject()}}}});Ajax.Request=Class.create(Ajax.Base,{_complete:false,initialize:function($super,url,options){$super(options);this.transport=Ajax.getTransport();this.request(url)},request:function(url){this.url=url;this.method=this.options.method;var params=Object.clone(this.options.parameters);if(!["get","post"].include(this.method)){params._method=this.method;this.method="post"}this.parameters=params;if(params=Object.toQueryString(params)){if(this.method=="get"){this.url+=(this.url.include("?")?"&":"?")+params}else{if(/Konqueror|Safari|KHTML/.test(navigator.userAgent)){params+="&_="}}}try{var response=new Ajax.Response(this);if(this.options.onCreate){this.options.onCreate(response)}Ajax.Responders.dispatch("onCreate",this,response);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);if(this.options.asynchronous){this.respondToReadyState.bind(this).defer(1)}this.transport.onreadystatechange=this.onStateChange.bind(this);this.setRequestHeaders();this.body=this.method=="post"?(this.options.postBody||params):null;this.transport.send(this.body);if(!this.options.asynchronous&&this.transport.overrideMimeType){this.onStateChange()}}catch(e){this.dispatchException(e)}},onStateChange:function(){var readyState=this.transport.readyState;if(readyState>1&&!((readyState==4)&&this._complete)){this.respondToReadyState(this.transport.readyState)}},setRequestHeaders:function(){var headers={"X-Requested-With":"XMLHttpRequest","X-Prototype-Version":Prototype.Version,Accept:"text/javascript, text/html, application/xml, text/xml, */*"};if(this.method=="post"){headers["Content-type"]=this.options.contentType+(this.options.encoding?"; charset="+this.options.encoding:"");if(this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005){headers.Connection="close"}}if(typeof this.options.requestHeaders=="object"){var extras=this.options.requestHeaders;if(Object.isFunction(extras.push)){for(var i=0,length=extras.length;i<length;i+=2){headers[extras[i]]=extras[i+1]}}else{$H(extras).each(function(pair){headers[pair.key]=pair.value})}}for(var name in headers){this.transport.setRequestHeader(name,headers[name])}},success:function(){var status=this.getStatus();return !status||(status>=200&&status<300)},getStatus:function(){try{return this.transport.status||0}catch(e){return 0}},respondToReadyState:function(readyState){var state=Ajax.Request.Events[readyState],response=new Ajax.Response(this);if(state=="Complete"){try{this._complete=true;(this.options["on"+response.status]||this.options["on"+(this.success()?"Success":"Failure")]||Prototype.emptyFunction)(response,response.headerJSON)}catch(e){this.dispatchException(e)}var contentType=response.getHeader("Content-type");if(this.options.evalJS=="force"||(this.options.evalJS&&this.isSameOrigin()&&contentType&&contentType.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i))){this.evalResponse()}}try{(this.options["on"+state]||Prototype.emptyFunction)(response,response.headerJSON);Ajax.Responders.dispatch("on"+state,this,response,response.headerJSON)}catch(e){this.dispatchException(e)}if(state=="Complete"){this.transport.onreadystatechange=Prototype.emptyFunction}},isSameOrigin:function(){var m=this.url.match(/^\s*https?:\/\/[^\/]*/);return !m||(m[0]=="#{protocol}//#{domain}#{port}".interpolate({protocol:location.protocol,domain:document.domain,port:location.port?":"+location.port:""}))},getHeader:function(name){try{return this.transport.getResponseHeader(name)||null}catch(e){return null}},evalResponse:function(){try{return eval((this.transport.responseText||"").unfilterJSON())}catch(e){this.dispatchException(e)}},dispatchException:function(exception){(this.options.onException||Prototype.emptyFunction)(this,exception);Ajax.Responders.dispatch("onException",this,exception)}});Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"];Ajax.Response=Class.create({initialize:function(request){this.request=request;var transport=this.transport=request.transport,readyState=this.readyState=transport.readyState;if((readyState>2&&!Prototype.Browser.IE)||readyState==4){this.status=this.getStatus();this.statusText=this.getStatusText();this.responseText=String.interpret(transport.responseText);this.headerJSON=this._getHeaderJSON()}if(readyState==4){var xml=transport.responseXML;this.responseXML=Object.isUndefined(xml)?null:xml;this.responseJSON=this._getResponseJSON()}},status:0,statusText:"",getStatus:Ajax.Request.prototype.getStatus,getStatusText:function(){try{return this.transport.statusText||""}catch(e){return""}},getHeader:Ajax.Request.prototype.getHeader,getAllHeaders:function(){try{return this.getAllResponseHeaders()}catch(e){return null}},getResponseHeader:function(name){return this.transport.getResponseHeader(name)},getAllResponseHeaders:function(){return this.transport.getAllResponseHeaders()},_getHeaderJSON:function(){var json=this.getHeader("X-JSON");if(!json){return null}json=decodeURIComponent(escape(json));try{return json.evalJSON(this.request.options.sanitizeJSON||!this.request.isSameOrigin())}catch(e){this.request.dispatchException(e)}},_getResponseJSON:function(){var options=this.request.options;if(!options.evalJSON||(options.evalJSON!="force"&&!(this.getHeader("Content-type")||"").include("application/json"))||this.responseText.blank()){return null}try{return this.responseText.evalJSON(options.sanitizeJSON||!this.request.isSameOrigin())}catch(e){this.request.dispatchException(e)}}});Ajax.Updater=Class.create(Ajax.Request,{initialize:function($super,container,url,options){this.container={success:(container.success||container),failure:(container.failure||(container.success?null:container))};options=Object.clone(options);var onComplete=options.onComplete;options.onComplete=(function(response,json){this.updateContent(response.responseText);if(Object.isFunction(onComplete)){onComplete(response,json)}}).bind(this);$super(url,options)},updateContent:function(responseText){var receiver=this.container[this.success()?"success":"failure"],options=this.options;if(!options.evalScripts){responseText=responseText.stripScripts()}if(receiver=$(receiver)){if(options.insertion){if(Object.isString(options.insertion)){var insertion={};insertion[options.insertion]=responseText;receiver.insert(insertion)}else{options.insertion(receiver,responseText)}}else{receiver.update(responseText)}}}});Ajax.PeriodicalUpdater=Class.create(Ajax.Base,{initialize:function($super,container,url,options){$super(options);this.onComplete=this.options.onComplete;this.frequency=(this.options.frequency||2);this.decay=(this.options.decay||1);this.updater={};this.container=container;this.url=url;this.start()},start:function(){this.options.onComplete=this.updateComplete.bind(this);this.onTimerEvent()},stop:function(){this.updater.options.onComplete=undefined;clearTimeout(this.timer);(this.onComplete||Prototype.emptyFunction).apply(this,arguments)},updateComplete:function(response){if(this.options.decay){this.decay=(response.responseText==this.lastText?this.decay*this.options.decay:1);this.lastText=response.responseText}this.timer=this.onTimerEvent.bind(this).delay(this.decay*this.frequency)},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options)}});function $(element){if(arguments.length>1){for(var i=0,elements=[],length=arguments.length;i<length;i++){elements.push($(arguments[i]))}return elements}if(Object.isString(element)){element=document.getElementById(element)}return Element.extend(element)}if(Prototype.BrowserFeatures.XPath){document._getElementsByXPath=function(expression,parentElement){var results=[];var query=document.evaluate(expression,$(parentElement)||document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(var i=0,length=query.snapshotLength;i<length;i++){results.push(Element.extend(query.snapshotItem(i)))}return results}}if(!window.Node){var Node={}}if(!Node.ELEMENT_NODE){Object.extend(Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12})}(function(global){var SETATTRIBUTE_IGNORES_NAME=(function(){var elForm=document.createElement("form");var elInput=document.createElement("input");var root=document.documentElement;elInput.setAttribute("name","test");elForm.appendChild(elInput);root.appendChild(elForm);var isBuggy=elForm.elements?(typeof elForm.elements.test=="undefined"):null;root.removeChild(elForm);elForm=elInput=null;return isBuggy})();var element=global.Element;global.Element=function(tagName,attributes){attributes=attributes||{};tagName=tagName.toLowerCase();var cache=Element.cache;if(SETATTRIBUTE_IGNORES_NAME&&attributes.name){tagName="<"+tagName+' name="'+attributes.name+'">';delete attributes.name;return Element.writeAttribute(document.createElement(tagName),attributes)}if(!cache[tagName]){cache[tagName]=Element.extend(document.createElement(tagName))}return Element.writeAttribute(cache[tagName].cloneNode(false),attributes)};Object.extend(global.Element,element||{});if(element){global.Element.prototype=element.prototype}})(this);Element.cache={};Element.idCounter=1;Element.Methods={visible:function(element){return $(element).style.display!="none"},toggle:function(element){element=$(element);Element[Element.visible(element)?"hide":"show"](element);return element},hide:function(element){element=$(element);element.style.display="none";return element},show:function(element){element=$(element);element.style.display="";return element},remove:function(element){element=$(element);element.parentNode.removeChild(element);return element},update:(function(){var SELECT_ELEMENT_INNERHTML_BUGGY=(function(){var el=document.createElement("select"),isBuggy=true;el.innerHTML='<option value="test">test</option>';if(el.options&&el.options[0]){isBuggy=el.options[0].nodeName.toUpperCase()!=="OPTION"}el=null;return isBuggy})();var TABLE_ELEMENT_INNERHTML_BUGGY=(function(){try{var el=document.createElement("table");if(el&&el.tBodies){el.innerHTML="<tbody><tr><td>test</td></tr></tbody>";var isBuggy=typeof el.tBodies[0]=="undefined";el=null;return isBuggy}}catch(e){return true}})();var SCRIPT_ELEMENT_REJECTS_TEXTNODE_APPENDING=(function(){var s=document.createElement("script"),isBuggy=false;try{s.appendChild(document.createTextNode(""));isBuggy=!s.firstChild||s.firstChild&&s.firstChild.nodeType!==3}catch(e){isBuggy=true}s=null;return isBuggy})();function update(element,content){element=$(element);if(content&&content.toElement){content=content.toElement()}if(Object.isElement(content)){return element.update().insert(content)}content=Object.toHTML(content);var tagName=element.tagName.toUpperCase();if(tagName==="SCRIPT"&&SCRIPT_ELEMENT_REJECTS_TEXTNODE_APPENDING){element.text=content;return element}if(SELECT_ELEMENT_INNERHTML_BUGGY||TABLE_ELEMENT_INNERHTML_BUGGY){if(tagName in Element._insertionTranslations.tags){while(element.firstChild){element.removeChild(element.firstChild)}Element._getContentFromAnonymousElement(tagName,content.stripScripts()).each(function(node){element.appendChild(node)})}else{element.innerHTML=content.stripScripts()}}else{element.innerHTML=content.stripScripts()}content.evalScripts.bind(content).defer();return element}return update})(),replace:function(element,content){element=$(element);if(content&&content.toElement){content=content.toElement()}else{if(!Object.isElement(content)){content=Object.toHTML(content);var range=element.ownerDocument.createRange();range.selectNode(element);content.evalScripts.bind(content).defer();content=range.createContextualFragment(content.stripScripts())}}element.parentNode.replaceChild(content,element);return element},insert:function(element,insertions){element=$(element);if(Object.isString(insertions)||Object.isNumber(insertions)||Object.isElement(insertions)||(insertions&&(insertions.toElement||insertions.toHTML))){insertions={bottom:insertions}}var content,insert,tagName,childNodes;for(var position in insertions){content=insertions[position];position=position.toLowerCase();insert=Element._insertionTranslations[position];if(content&&content.toElement){content=content.toElement()}if(Object.isElement(content)){insert(element,content);continue}content=Object.toHTML(content);tagName=((position=="before"||position=="after")?element.parentNode:element).tagName.toUpperCase();childNodes=Element._getContentFromAnonymousElement(tagName,content.stripScripts());if(position=="top"||position=="after"){childNodes.reverse()}childNodes.each(insert.curry(element));content.evalScripts.bind(content).defer()}return element},wrap:function(element,wrapper,attributes){element=$(element);if(Object.isElement(wrapper)){$(wrapper).writeAttribute(attributes||{})}else{if(Object.isString(wrapper)){wrapper=new Element(wrapper,attributes)}else{wrapper=new Element("div",wrapper)}}if(element.parentNode){element.parentNode.replaceChild(wrapper,element)}wrapper.appendChild(element);return wrapper},inspect:function(element){element=$(element);var result="<"+element.tagName.toLowerCase();$H({id:"id",className:"class"}).each(function(pair){var property=pair.first(),attribute=pair.last();var value=(element[property]||"").toString();if(value){result+=" "+attribute+"="+value.inspect(true)}});return result+">"},recursivelyCollect:function(element,property){element=$(element);var elements=[];while(element=element[property]){if(element.nodeType==1){elements.push(Element.extend(element))}}return elements},ancestors:function(element){return Element.recursivelyCollect(element,"parentNode")},descendants:function(element){return Element.select(element,"*")},firstDescendant:function(element){element=$(element).firstChild;while(element&&element.nodeType!=1){element=element.nextSibling}return $(element)},immediateDescendants:function(element){if(!(element=$(element).firstChild)){return[]}while(element&&element.nodeType!=1){element=element.nextSibling}if(element){return[element].concat($(element).nextSiblings())}return[]},previousSiblings:function(element){return Element.recursivelyCollect(element,"previousSibling")},nextSiblings:function(element){return Element.recursivelyCollect(element,"nextSibling")},siblings:function(element){element=$(element);return Element.previousSiblings(element).reverse().concat(Element.nextSiblings(element))},match:function(element,selector){if(Object.isString(selector)){selector=new Selector(selector)}return selector.match($(element))},up:function(element,expression,index){element=$(element);if(arguments.length==1){return $(element.parentNode)}var ancestors=Element.ancestors(element);return Object.isNumber(expression)?ancestors[expression]:Selector.findElement(ancestors,expression,index)},down:function(element,expression,index){element=$(element);if(arguments.length==1){return Element.firstDescendant(element)}return Object.isNumber(expression)?Element.descendants(element)[expression]:Element.select(element,expression)[index||0]},previous:function(element,expression,index){element=$(element);if(arguments.length==1){return $(Selector.handlers.previousElementSibling(element))}var previousSiblings=Element.previousSiblings(element);return Object.isNumber(expression)?previousSiblings[expression]:Selector.findElement(previousSiblings,expression,index)},next:function(element,expression,index){element=$(element);if(arguments.length==1){return $(Selector.handlers.nextElementSibling(element))}var nextSiblings=Element.nextSiblings(element);return Object.isNumber(expression)?nextSiblings[expression]:Selector.findElement(nextSiblings,expression,index)},select:function(element){var args=Array.prototype.slice.call(arguments,1);return Selector.findChildElements(element,args)},adjacent:function(element){var args=Array.prototype.slice.call(arguments,1);return Selector.findChildElements(element.parentNode,args).without(element)},identify:function(element){element=$(element);var id=Element.readAttribute(element,"id");if(id){return id}do{id="anonymous_element_"+Element.idCounter++}while($(id));Element.writeAttribute(element,"id",id);return id},readAttribute:function(element,name){element=$(element);if(Prototype.Browser.IE){var t=Element._attributeTranslations.read;if(t.values[name]){return t.values[name](element,name)}if(t.names[name]){name=t.names[name]}if(name.include(":")){return(!element.attributes||!element.attributes[name])?null:element.attributes[name].value}}return element.getAttribute(name)},writeAttribute:function(element,name,value){element=$(element);var attributes={},t=Element._attributeTranslations.write;if(typeof name=="object"){attributes=name}else{attributes[name]=Object.isUndefined(value)?true:value}for(var attr in attributes){name=t.names[attr]||attr;value=attributes[attr];if(t.values[attr]){name=t.values[attr](element,value)}if(value===false||value===null){element.removeAttribute(name)}else{if(value===true){element.setAttribute(name,name)}else{element.setAttribute(name,value)}}}return element},getHeight:function(element){return Element.getDimensions(element).height},getWidth:function(element){return Element.getDimensions(element).width},classNames:function(element){return new Element.ClassNames(element)},hasClassName:function(element,className){if(!(element=$(element))){return}var elementClassName=element.className;return(elementClassName.length>0&&(elementClassName==className||new RegExp("(^|\\s)"+className+"(\\s|$)").test(elementClassName)))},addClassName:function(element,className){if(!(element=$(element))){return}if(!Element.hasClassName(element,className)){element.className+=(element.className?" ":"")+className}return element},removeClassName:function(element,className){if(!(element=$(element))){return}element.className=element.className.replace(new RegExp("(^|\\s+)"+className+"(\\s+|$)")," ").strip();return element},toggleClassName:function(element,className){if(!(element=$(element))){return}return Element[Element.hasClassName(element,className)?"removeClassName":"addClassName"](element,className)},cleanWhitespace:function(element){element=$(element);var node=element.firstChild;while(node){var nextNode=node.nextSibling;if(node.nodeType==3&&!/\S/.test(node.nodeValue)){element.removeChild(node)}node=nextNode}return element},empty:function(element){return $(element).innerHTML.blank()},descendantOf:function(element,ancestor){element=$(element),ancestor=$(ancestor);if(element.compareDocumentPosition){return(element.compareDocumentPosition(ancestor)&8)===8}if(ancestor.contains){return ancestor.contains(element)&&ancestor!==element}while(element=element.parentNode){if(element==ancestor){return true}}return false},scrollTo:function(element){element=$(element);var pos=Element.cumulativeOffset(element);window.scrollTo(pos[0],pos[1]);return element},getStyle:function(element,style){element=$(element);style=style=="float"?"cssFloat":style.camelize();var value=element.style[style];if(!value||value=="auto"){var css=document.defaultView.getComputedStyle(element,null);value=css?css[style]:null}if(style=="opacity"){return value?parseFloat(value):1}return value=="auto"?null:value},getOpacity:function(element){return $(element).getStyle("opacity")},setStyle:function(element,styles){element=$(element);var elementStyle=element.style,match;if(Object.isString(styles)){element.style.cssText+=";"+styles;return styles.include("opacity")?element.setOpacity(styles.match(/opacity:\s*(\d?\.?\d*)/)[1]):element}for(var property in styles){if(property=="opacity"){element.setOpacity(styles[property])}else{elementStyle[(property=="float"||property=="cssFloat")?(Object.isUndefined(elementStyle.styleFloat)?"cssFloat":"styleFloat"):property]=styles[property]}}return element},setOpacity:function(element,value){element=$(element);element.style.opacity=(value==1||value==="")?"":(value<0.00001)?0:value;return element},getDimensions:function(element){element=$(element);var display=Element.getStyle(element,"display");if(display!="none"&&display!=null){return{width:element.offsetWidth,height:element.offsetHeight}}var els=element.style;var originalVisibility=els.visibility;var originalPosition=els.position;var originalDisplay=els.display;els.visibility="hidden";if(originalPosition!="fixed"){els.position="absolute"}els.display="block";var originalWidth=element.clientWidth;var originalHeight=element.clientHeight;els.display=originalDisplay;els.position=originalPosition;els.visibility=originalVisibility;return{width:originalWidth,height:originalHeight}},makePositioned:function(element){element=$(element);var pos=Element.getStyle(element,"position");if(pos=="static"||!pos){element._madePositioned=true;element.style.position="relative";if(Prototype.Browser.Opera){element.style.top=0;element.style.left=0}}return element},undoPositioned:function(element){element=$(element);if(element._madePositioned){element._madePositioned=undefined;element.style.position=element.style.top=element.style.left=element.style.bottom=element.style.right=""}return element},makeClipping:function(element){element=$(element);if(element._overflow){return element}element._overflow=Element.getStyle(element,"overflow")||"auto";if(element._overflow!=="hidden"){element.style.overflow="hidden"}return element},undoClipping:function(element){element=$(element);if(!element._overflow){return element}element.style.overflow=element._overflow=="auto"?"":element._overflow;element._overflow=null;return element},cumulativeOffset:function(element){var valueT=0,valueL=0;do{valueT+=element.offsetTop||0;valueL+=element.offsetLeft||0;element=element.offsetParent}while(element);return Element._returnOffset(valueL,valueT)},positionedOffset:function(element){var valueT=0,valueL=0;do{valueT+=element.offsetTop||0;valueL+=element.offsetLeft||0;element=element.offsetParent;if(element){if(element.tagName.toUpperCase()=="BODY"){break}var p=Element.getStyle(element,"position");if(p!=="static"){break}}}while(element);return Element._returnOffset(valueL,valueT)},absolutize:function(element){element=$(element);if(Element.getStyle(element,"position")=="absolute"){return element}var offsets=Element.positionedOffset(element);var top=offsets[1];var left=offsets[0];var width=element.clientWidth;var height=element.clientHeight;element._originalLeft=left-parseFloat(element.style.left||0);element._originalTop=top-parseFloat(element.style.top||0);element._originalWidth=element.style.width;element._originalHeight=element.style.height;element.style.position="absolute";element.style.top=top+"px";element.style.left=left+"px";element.style.width=width+"px";element.style.height=height+"px";return element},relativize:function(element){element=$(element);if(Element.getStyle(element,"position")=="relative"){return element}element.style.position="relative";var top=parseFloat(element.style.top||0)-(element._originalTop||0);var left=parseFloat(element.style.left||0)-(element._originalLeft||0);element.style.top=top+"px";element.style.left=left+"px";element.style.height=element._originalHeight;element.style.width=element._originalWidth;return element},cumulativeScrollOffset:function(element){var valueT=0,valueL=0;do{valueT+=element.scrollTop||0;valueL+=element.scrollLeft||0;element=element.parentNode}while(element);return Element._returnOffset(valueL,valueT)},getOffsetParent:function(element){if(element.offsetParent){return $(element.offsetParent)}if(element==document.body){return $(element)}while((element=element.parentNode)&&element!=document.body){if(Element.getStyle(element,"position")!="static"){return $(element)}}return $(document.body)},viewportOffset:function(forElement){var valueT=0,valueL=0;var element=forElement;do{valueT+=element.offsetTop||0;valueL+=element.offsetLeft||0;if(element.offsetParent==document.body&&Element.getStyle(element,"position")=="absolute"){break}}while(element=element.offsetParent);element=forElement;do{if(!Prototype.Browser.Opera||(element.tagName&&(element.tagName.toUpperCase()=="BODY"))){valueT-=element.scrollTop||0;valueL-=element.scrollLeft||0}}while(element=element.parentNode);return Element._returnOffset(valueL,valueT)},clonePosition:function(element,source){var options=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},arguments[2]||{});source=$(source);var p=Element.viewportOffset(source);element=$(element);var delta=[0,0];var parent=null;if(Element.getStyle(element,"position")=="absolute"){parent=Element.getOffsetParent(element);delta=Element.viewportOffset(parent)}if(parent==document.body){delta[0]-=document.body.offsetLeft;delta[1]-=document.body.offsetTop}if(options.setLeft){element.style.left=(p[0]-delta[0]+options.offsetLeft)+"px"}if(options.setTop){element.style.top=(p[1]-delta[1]+options.offsetTop)+"px"}if(options.setWidth){element.style.width=source.offsetWidth+"px"}if(options.setHeight){element.style.height=source.offsetHeight+"px"}return element}};Object.extend(Element.Methods,{getElementsBySelector:Element.Methods.select,childElements:Element.Methods.immediateDescendants});Element._attributeTranslations={write:{names:{className:"class",htmlFor:"for"},values:{}}};if(Prototype.Browser.Opera){Element.Methods.getStyle=Element.Methods.getStyle.wrap(function(proceed,element,style){switch(style){case"left":case"top":case"right":case"bottom":if(proceed(element,"position")==="static"){return null}case"height":case"width":if(!Element.visible(element)){return null}var dim=parseInt(proceed(element,style),10);if(dim!==element["offset"+style.capitalize()]){return dim+"px"}var properties;if(style==="height"){properties=["border-top-width","padding-top","padding-bottom","border-bottom-width"]}else{properties=["border-left-width","padding-left","padding-right","border-right-width"]}return properties.inject(dim,function(memo,property){var val=proceed(element,property);return val===null?memo:memo-parseInt(val,10)})+"px";default:return proceed(element,style)}});Element.Methods.readAttribute=Element.Methods.readAttribute.wrap(function(proceed,element,attribute){if(attribute==="title"){return element.title}return proceed(element,attribute)})}else{if(Prototype.Browser.IE){Element.Methods.getOffsetParent=Element.Methods.getOffsetParent.wrap(function(proceed,element){element=$(element);try{element.offsetParent}catch(e){return $(document.body)}var position=element.getStyle("position");if(position!=="static"){return proceed(element)}element.setStyle({position:"relative"});var value=proceed(element);element.setStyle({position:position});return value});$w("positionedOffset viewportOffset").each(function(method){Element.Methods[method]=Element.Methods[method].wrap(function(proceed,element){element=$(element);try{element.offsetParent}catch(e){return Element._returnOffset(0,0)}var position=element.getStyle("position");if(position!=="static"){return proceed(element)}var offsetParent=element.getOffsetParent();if(offsetParent&&offsetParent.getStyle("position")==="fixed"){offsetParent.setStyle({zoom:1})}element.setStyle({position:"relative"});var value=proceed(element);element.setStyle({position:position});return value})});Element.Methods.cumulativeOffset=Element.Methods.cumulativeOffset.wrap(function(proceed,element){try{element.offsetParent}catch(e){return Element._returnOffset(0,0)}return proceed(element)});Element.Methods.getStyle=function(element,style){element=$(element);style=(style=="float"||style=="cssFloat")?"styleFloat":style.camelize();var value=element.style[style];if(!value&&element.currentStyle){value=element.currentStyle[style]}if(style=="opacity"){if(value=(element.getStyle("filter")||"").match(/alpha\(opacity=(.*)\)/)){if(value[1]){return parseFloat(value[1])/100}}return 1}if(value=="auto"){if((style=="width"||style=="height")&&(element.getStyle("display")!="none")){return element["offset"+style.capitalize()]+"px"}return null}return value};Element.Methods.setOpacity=function(element,value){function stripAlpha(filter){return filter.replace(/alpha\([^\)]*\)/gi,"")}element=$(element);var currentStyle=element.currentStyle;if((currentStyle&&!currentStyle.hasLayout)||(!currentStyle&&element.style.zoom=="normal")){element.style.zoom=1}var filter=element.getStyle("filter"),style=element.style;if(value==1||value===""){(filter=stripAlpha(filter))?style.filter=filter:style.removeAttribute("filter");return element}else{if(value<0.00001){value=0}}style.filter=stripAlpha(filter)+"alpha(opacity="+(value*100)+")";return element};Element._attributeTranslations=(function(){var classProp="className";var forProp="for";var el=document.createElement("div");el.setAttribute(classProp,"x");if(el.className!=="x"){el.setAttribute("class","x");if(el.className==="x"){classProp="class"}}el=null;el=document.createElement("label");el.setAttribute(forProp,"x");if(el.htmlFor!=="x"){el.setAttribute("htmlFor","x");if(el.htmlFor==="x"){forProp="htmlFor"}}el=null;return{read:{names:{"class":classProp,className:classProp,"for":forProp,htmlFor:forProp},values:{_getAttr:function(element,attribute){return element.getAttribute(attribute)},_getAttr2:function(element,attribute){return element.getAttribute(attribute,2)},_getAttrNode:function(element,attribute){var node=element.getAttributeNode(attribute);return node?node.value:""},_getEv:(function(){var el=document.createElement("div");el.onclick=Prototype.emptyFunction;var value=el.getAttribute("onclick");var f;if(String(value).indexOf("{")>-1){f=function(element,attribute){attribute=element.getAttribute(attribute);if(!attribute){return null}attribute=attribute.toString();attribute=attribute.split("{")[1];attribute=attribute.split("}")[0];return attribute.strip()}}else{if(value===""){f=function(element,attribute){attribute=element.getAttribute(attribute);if(!attribute){return null}return attribute.strip()}}}el=null;return f})(),_flag:function(element,attribute){return $(element).hasAttribute(attribute)?attribute:null},style:function(element){return element.style.cssText.toLowerCase()},title:function(element){return element.title}}}}})();Element._attributeTranslations.write={names:Object.extend({cellpadding:"cellPadding",cellspacing:"cellSpacing"},Element._attributeTranslations.read.names),values:{checked:function(element,value){element.checked=!!value},style:function(element,value){element.style.cssText=value?value:""}}};Element._attributeTranslations.has={};$w("colSpan rowSpan vAlign dateTime accessKey tabIndex encType maxLength readOnly longDesc frameBorder").each(function(attr){Element._attributeTranslations.write.names[attr.toLowerCase()]=attr;Element._attributeTranslations.has[attr.toLowerCase()]=attr});(function(v){Object.extend(v,{href:v._getAttr2,src:v._getAttr2,type:v._getAttr,action:v._getAttrNode,disabled:v._flag,checked:v._flag,readonly:v._flag,multiple:v._flag,onload:v._getEv,onunload:v._getEv,onclick:v._getEv,ondblclick:v._getEv,onmousedown:v._getEv,onmouseup:v._getEv,onmouseover:v._getEv,onmousemove:v._getEv,onmouseout:v._getEv,onfocus:v._getEv,onblur:v._getEv,onkeypress:v._getEv,onkeydown:v._getEv,onkeyup:v._getEv,onsubmit:v._getEv,onreset:v._getEv,onselect:v._getEv,onchange:v._getEv})})(Element._attributeTranslations.read.values);if(Prototype.BrowserFeatures.ElementExtensions){(function(){function _descendants(element){var nodes=element.getElementsByTagName("*"),results=[];for(var i=0,node;node=nodes[i];i++){if(node.tagName!=="!"){results.push(node)}}return results}Element.Methods.down=function(element,expression,index){element=$(element);if(arguments.length==1){return element.firstDescendant()}return Object.isNumber(expression)?_descendants(element)[expression]:Element.select(element,expression)[index||0]}})()}}else{if(Prototype.Browser.Gecko&&/rv:1\.8\.0/.test(navigator.userAgent)){Element.Methods.setOpacity=function(element,value){element=$(element);element.style.opacity=(value==1)?0.999999:(value==="")?"":(value<0.00001)?0:value;return element}}else{if(Prototype.Browser.WebKit){Element.Methods.setOpacity=function(element,value){element=$(element);element.style.opacity=(value==1||value==="")?"":(value<0.00001)?0:value;if(value==1){if(element.tagName.toUpperCase()=="IMG"&&element.width){element.width++;element.width--}else{try{var n=document.createTextNode(" ");element.appendChild(n);element.removeChild(n)}catch(e){}}}return element};Element.Methods.cumulativeOffset=function(element){var valueT=0,valueL=0;do{valueT+=element.offsetTop||0;valueL+=element.offsetLeft||0;if(element.offsetParent==document.body){if(Element.getStyle(element,"position")=="absolute"){break}}element=element.offsetParent}while(element);return Element._returnOffset(valueL,valueT)}}}}}if("outerHTML" in document.documentElement){Element.Methods.replace=function(element,content){element=$(element);if(content&&content.toElement){content=content.toElement()}if(Object.isElement(content)){element.parentNode.replaceChild(content,element);return element}content=Object.toHTML(content);var parent=element.parentNode,tagName=parent.tagName.toUpperCase();if(Element._insertionTranslations.tags[tagName]){var nextSibling=element.next();var fragments=Element._getContentFromAnonymousElement(tagName,content.stripScripts());parent.removeChild(element);if(nextSibling){fragments.each(function(node){parent.insertBefore(node,nextSibling)})}else{fragments.each(function(node){parent.appendChild(node)})}}else{element.outerHTML=content.stripScripts()}content.evalScripts.bind(content).defer();return element}}Element._returnOffset=function(l,t){var result=[l,t];result.left=l;result.top=t;return result};Element._getContentFromAnonymousElement=function(tagName,html){var div=new Element("div"),t=Element._insertionTranslations.tags[tagName];if(t){div.innerHTML=t[0]+html+t[1];t[2].times(function(){div=div.firstChild})}else{div.innerHTML=html}return $A(div.childNodes)};Element._insertionTranslations={before:function(element,node){element.parentNode.insertBefore(node,element)},top:function(element,node){element.insertBefore(node,element.firstChild)},bottom:function(element,node){element.appendChild(node)},after:function(element,node){element.parentNode.insertBefore(node,element.nextSibling)},tags:{TABLE:["<table>","</table>",1],TBODY:["<table><tbody>","</tbody></table>",2],TR:["<table><tbody><tr>","</tr></tbody></table>",3],TD:["<table><tbody><tr><td>","</td></tr></tbody></table>",4],SELECT:["<select>","</select>",1]}};(function(){var tags=Element._insertionTranslations.tags;Object.extend(tags,{THEAD:tags.TBODY,TFOOT:tags.TBODY,TH:tags.TD})})();Element.Methods.Simulated={hasAttribute:function(element,attribute){attribute=Element._attributeTranslations.has[attribute]||attribute;var node=$(element).getAttributeNode(attribute);return !!(node&&node.specified)}};Element.Methods.ByTag={};Object.extend(Element,Element.Methods);(function(div){if(!Prototype.BrowserFeatures.ElementExtensions&&div.__proto__){window.HTMLElement={};window.HTMLElement.prototype=div.__proto__;Prototype.BrowserFeatures.ElementExtensions=true}div=null})(document.createElement("div"));Element.extend=(function(){function checkDeficiency(tagName){if(typeof window.Element!="undefined"){var proto=window.Element.prototype;if(proto){var id="_"+(Math.random()+"").slice(2);var el=document.createElement(tagName);proto[id]="x";var isBuggy=(el[id]!=="x");delete proto[id];el=null;return isBuggy}}return false}function extendElementWith(element,methods){for(var property in methods){var value=methods[property];if(Object.isFunction(value)&&!(property in element)){element[property]=value.methodize()}}}var HTMLOBJECTELEMENT_PROTOTYPE_BUGGY=checkDeficiency("object");if(Prototype.BrowserFeatures.SpecificElementExtensions){if(HTMLOBJECTELEMENT_PROTOTYPE_BUGGY){return function(element){if(element&&typeof element._extendedByPrototype=="undefined"){var t=element.tagName;if(t&&(/^(?:object|applet|embed)$/i.test(t))){extendElementWith(element,Element.Methods);extendElementWith(element,Element.Methods.Simulated);extendElementWith(element,Element.Methods.ByTag[t.toUpperCase()])}}return element}}return Prototype.K}var Methods={},ByTag=Element.Methods.ByTag;var extend=Object.extend(function(element){if(!element||typeof element._extendedByPrototype!="undefined"||element.nodeType!=1||element==window){return element}var methods=Object.clone(Methods),tagName=element.tagName.toUpperCase();if(ByTag[tagName]){Object.extend(methods,ByTag[tagName])}extendElementWith(element,methods);element._extendedByPrototype=Prototype.emptyFunction;return element},{refresh:function(){if(!Prototype.BrowserFeatures.ElementExtensions){Object.extend(Methods,Element.Methods);Object.extend(Methods,Element.Methods.Simulated)}}});extend.refresh();return extend})();Element.hasAttribute=function(element,attribute){if(element.hasAttribute){return element.hasAttribute(attribute)}return Element.Methods.Simulated.hasAttribute(element,attribute)};Element.addMethods=function(methods){var F=Prototype.BrowserFeatures,T=Element.Methods.ByTag;if(!methods){Object.extend(Form,Form.Methods);Object.extend(Form.Element,Form.Element.Methods);Object.extend(Element.Methods.ByTag,{FORM:Object.clone(Form.Methods),INPUT:Object.clone(Form.Element.Methods),SELECT:Object.clone(Form.Element.Methods),TEXTAREA:Object.clone(Form.Element.Methods)})}if(arguments.length==2){var tagName=methods;methods=arguments[1]}if(!tagName){Object.extend(Element.Methods,methods||{})}else{if(Object.isArray(tagName)){tagName.each(extend)}else{extend(tagName)}}function extend(tagName){tagName=tagName.toUpperCase();if(!Element.Methods.ByTag[tagName]){Element.Methods.ByTag[tagName]={}}Object.extend(Element.Methods.ByTag[tagName],methods)}function copy(methods,destination,onlyIfAbsent){onlyIfAbsent=onlyIfAbsent||false;for(var property in methods){var value=methods[property];if(!Object.isFunction(value)){continue}if(!onlyIfAbsent||!(property in destination)){destination[property]=value.methodize()}}}function findDOMClass(tagName){var klass;var trans={OPTGROUP:"OptGroup",TEXTAREA:"TextArea",P:"Paragraph",FIELDSET:"FieldSet",UL:"UList",OL:"OList",DL:"DList",DIR:"Directory",H1:"Heading",H2:"Heading",H3:"Heading",H4:"Heading",H5:"Heading",H6:"Heading",Q:"Quote",INS:"Mod",DEL:"Mod",A:"Anchor",IMG:"Image",CAPTION:"TableCaption",COL:"TableCol",COLGROUP:"TableCol",THEAD:"TableSection",TFOOT:"TableSection",TBODY:"TableSection",TR:"TableRow",TH:"TableCell",TD:"TableCell",FRAMESET:"FrameSet",IFRAME:"IFrame"};if(trans[tagName]){klass="HTML"+trans[tagName]+"Element"}if(window[klass]){return window[klass]}klass="HTML"+tagName+"Element";if(window[klass]){return window[klass]}klass="HTML"+tagName.capitalize()+"Element";if(window[klass]){return window[klass]}var element=document.createElement(tagName);var proto=element.__proto__||element.constructor.prototype;element=null;return proto}var elementPrototype=window.HTMLElement?HTMLElement.prototype:Element.prototype;if(F.ElementExtensions){copy(Element.Methods,elementPrototype);copy(Element.Methods.Simulated,elementPrototype,true)}if(F.SpecificElementExtensions){for(var tag in Element.Methods.ByTag){var klass=findDOMClass(tag);if(Object.isUndefined(klass)){continue}copy(T[tag],klass.prototype)}}Object.extend(Element,Element.Methods);delete Element.ByTag;if(Element.extend.refresh){Element.extend.refresh()}Element.cache={}};document.viewport={getDimensions:function(){return{width:this.getWidth(),height:this.getHeight()}},getScrollOffsets:function(){return Element._returnOffset(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)}};(function(viewport){var B=Prototype.Browser,doc=document,element,property={};function getRootElement(){if(B.WebKit&&!doc.evaluate){return document}if(B.Opera&&window.parseFloat(window.opera.version())<9.5){return document.body}return document.documentElement}function define(D){if(!element){element=getRootElement()}property[D]="client"+D;viewport["get"+D]=function(){return element[property[D]]};return viewport["get"+D]()}viewport.getWidth=define.curry("Width");viewport.getHeight=define.curry("Height")})(document.viewport);Element.Storage={UID:1};Element.addMethods({getStorage:function(element){if(!(element=$(element))){return}var uid;if(element===window){uid=0}else{if(typeof element._prototypeUID==="undefined"){element._prototypeUID=[Element.Storage.UID++]}uid=element._prototypeUID[0]}if(!Element.Storage[uid]){Element.Storage[uid]=$H()}return Element.Storage[uid]},store:function(element,key,value){if(!(element=$(element))){return}if(arguments.length===2){Element.getStorage(element).update(key)}else{Element.getStorage(element).set(key,value)}return element},retrieve:function(element,key,defaultValue){if(!(element=$(element))){return}var hash=Element.getStorage(element),value=hash.get(key);if(Object.isUndefined(value)){hash.set(key,defaultValue);value=defaultValue}return value},clone:function(element,deep){if(!(element=$(element))){return}var clone=element.cloneNode(deep);clone._prototypeUID=void 0;if(deep){var descendants=Element.select(clone,"*"),i=descendants.length;while(i--){descendants[i]._prototypeUID=void 0}}return Element.extend(clone)}});var Selector=Class.create({initialize:function(expression){this.expression=expression.strip();if(this.shouldUseSelectorsAPI()){this.mode="selectorsAPI"}else{if(this.shouldUseXPath()){this.mode="xpath";this.compileXPathMatcher()}else{this.mode="normal";this.compileMatcher()}}},shouldUseXPath:(function(){var IS_DESCENDANT_SELECTOR_BUGGY=(function(){var isBuggy=false;if(document.evaluate&&window.XPathResult){var el=document.createElement("div");el.innerHTML="<ul><li></li></ul><div><ul><li></li></ul></div>";var xpath=".//*[local-name()='ul' or local-name()='UL']//*[local-name()='li' or local-name()='LI']";var result=document.evaluate(xpath,el,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);isBuggy=(result.snapshotLength!==2);el=null}return isBuggy})();return function(){if(!Prototype.BrowserFeatures.XPath){return false}var e=this.expression;if(Prototype.Browser.WebKit&&(e.include("-of-type")||e.include(":empty"))){return false}if((/(\[[\w-]*?:|:checked)/).test(e)){return false}if(IS_DESCENDANT_SELECTOR_BUGGY){return false}return true}})(),shouldUseSelectorsAPI:function(){if(!Prototype.BrowserFeatures.SelectorsAPI){return false}if(Selector.CASE_INSENSITIVE_CLASS_NAMES){return false}if(!Selector._div){Selector._div=new Element("div")}try{Selector._div.querySelector(this.expression)}catch(e){return false}return true},compileMatcher:function(){var e=this.expression,ps=Selector.patterns,h=Selector.handlers,c=Selector.criteria,le,p,m,len=ps.length,name;if(Selector._cache[e]){this.matcher=Selector._cache[e];return}this.matcher=["this.matcher = function(root) {","var r = root, h = Selector.handlers, c = false, n;"];while(e&&le!=e&&(/\S/).test(e)){le=e;for(var i=0;i<len;i++){p=ps[i].re;name=ps[i].name;if(m=e.match(p)){this.matcher.push(Object.isFunction(c[name])?c[name](m):new Template(c[name]).evaluate(m));e=e.replace(m[0],"");break}}}this.matcher.push("return h.unique(n);\n}");eval(this.matcher.join("\n"));Selector._cache[this.expression]=this.matcher},compileXPathMatcher:function(){var e=this.expression,ps=Selector.patterns,x=Selector.xpath,le,m,len=ps.length,name;if(Selector._cache[e]){this.xpath=Selector._cache[e];return}this.matcher=[".//*"];while(e&&le!=e&&(/\S/).test(e)){le=e;for(var i=0;i<len;i++){name=ps[i].name;if(m=e.match(ps[i].re)){this.matcher.push(Object.isFunction(x[name])?x[name](m):new Template(x[name]).evaluate(m));e=e.replace(m[0],"");break}}}this.xpath=this.matcher.join("");Selector._cache[this.expression]=this.xpath},findElements:function(root){root=root||document;var e=this.expression,results;switch(this.mode){case"selectorsAPI":if(root!==document){var oldId=root.id,id=$(root).identify();id=id.replace(/([\.:])/g,"\\$1");e="#"+id+" "+e}results=$A(root.querySelectorAll(e)).map(Element.extend);root.id=oldId;return results;case"xpath":return document._getElementsByXPath(this.xpath,root);default:return this.matcher(root)}},match:function(element){this.tokens=[];var e=this.expression,ps=Selector.patterns,as=Selector.assertions;var le,p,m,len=ps.length,name;while(e&&le!==e&&(/\S/).test(e)){le=e;for(var i=0;i<len;i++){p=ps[i].re;name=ps[i].name;if(m=e.match(p)){if(as[name]){this.tokens.push([name,Object.clone(m)]);e=e.replace(m[0],"")}else{return this.findElements(document).include(element)}}}}var match=true,name,matches;for(var i=0,token;token=this.tokens[i];i++){name=token[0],matches=token[1];if(!Selector.assertions[name](element,matches)){match=false;break}}return match},toString:function(){return this.expression},inspect:function(){return"#<Selector:"+this.expression.inspect()+">"}});if(Prototype.BrowserFeatures.SelectorsAPI&&document.compatMode==="BackCompat"){Selector.CASE_INSENSITIVE_CLASS_NAMES=(function(){var div=document.createElement("div"),span=document.createElement("span");div.id="prototype_test_id";span.className="Test";div.appendChild(span);var isIgnored=(div.querySelector("#prototype_test_id .test")!==null);div=span=null;return isIgnored})()}Object.extend(Selector,{_cache:{},xpath:{descendant:"//*",child:"/*",adjacent:"/following-sibling::*[1]",laterSibling:"/following-sibling::*",tagName:function(m){if(m[1]=="*"){return""}return"[local-name()='"+m[1].toLowerCase()+"' or local-name()='"+m[1].toUpperCase()+"']"},className:"[contains(concat(' ', @class, ' '), ' #{1} ')]",id:"[@id='#{1}']",attrPresence:function(m){m[1]=m[1].toLowerCase();return new Template("[@#{1}]").evaluate(m)},attr:function(m){m[1]=m[1].toLowerCase();m[3]=m[5]||m[6];return new Template(Selector.xpath.operators[m[2]]).evaluate(m)},pseudo:function(m){var h=Selector.xpath.pseudos[m[1]];if(!h){return""}if(Object.isFunction(h)){return h(m)}return new Template(Selector.xpath.pseudos[m[1]]).evaluate(m)},operators:{"=":"[@#{1}='#{3}']","!=":"[@#{1}!='#{3}']","^=":"[starts-with(@#{1}, '#{3}')]","$=":"[substring(@#{1}, (string-length(@#{1}) - string-length('#{3}') + 1))='#{3}']","*=":"[contains(@#{1}, '#{3}')]","~=":"[contains(concat(' ', @#{1}, ' '), ' #{3} ')]","|=":"[contains(concat('-', @#{1}, '-'), '-#{3}-')]"},pseudos:{"first-child":"[not(preceding-sibling::*)]","last-child":"[not(following-sibling::*)]","only-child":"[not(preceding-sibling::* or following-sibling::*)]",empty:"[count(*) = 0 and (count(text()) = 0)]",checked:"[@checked]",disabled:"[(@disabled) and (@type!='hidden')]",enabled:"[not(@disabled) and (@type!='hidden')]",not:function(m){var e=m[6],p=Selector.patterns,x=Selector.xpath,le,v,len=p.length,name;var exclusion=[];while(e&&le!=e&&(/\S/).test(e)){le=e;for(var i=0;i<len;i++){name=p[i].name;if(m=e.match(p[i].re)){v=Object.isFunction(x[name])?x[name](m):new Template(x[name]).evaluate(m);exclusion.push("("+v.substring(1,v.length-1)+")");e=e.replace(m[0],"");break}}}return"[not("+exclusion.join(" and ")+")]"},"nth-child":function(m){return Selector.xpath.pseudos.nth("(count(./preceding-sibling::*) + 1) ",m)},"nth-last-child":function(m){return Selector.xpath.pseudos.nth("(count(./following-sibling::*) + 1) ",m)},"nth-of-type":function(m){return Selector.xpath.pseudos.nth("position() ",m)},"nth-last-of-type":function(m){return Selector.xpath.pseudos.nth("(last() + 1 - position()) ",m)},"first-of-type":function(m){m[6]="1";return Selector.xpath.pseudos["nth-of-type"](m)},"last-of-type":function(m){m[6]="1";return Selector.xpath.pseudos["nth-last-of-type"](m)},"only-of-type":function(m){var p=Selector.xpath.pseudos;return p["first-of-type"](m)+p["last-of-type"](m)},nth:function(fragment,m){var mm,formula=m[6],predicate;if(formula=="even"){formula="2n+0"}if(formula=="odd"){formula="2n+1"}if(mm=formula.match(/^(\d+)$/)){return"["+fragment+"= "+mm[1]+"]"}if(mm=formula.match(/^(-?\d*)?n(([+-])(\d+))?/)){if(mm[1]=="-"){mm[1]=-1}var a=mm[1]?Number(mm[1]):1;var b=mm[2]?Number(mm[2]):0;predicate="[((#{fragment} - #{b}) mod #{a} = 0) and ((#{fragment} - #{b}) div #{a} >= 0)]";return new Template(predicate).evaluate({fragment:fragment,a:a,b:b})}}}},criteria:{tagName:'n = h.tagName(n, r, "#{1}", c);      c = false;',className:'n = h.className(n, r, "#{1}", c);    c = false;',id:'n = h.id(n, r, "#{1}", c);           c = false;',attrPresence:'n = h.attrPresence(n, r, "#{1}", c); c = false;',attr:function(m){m[3]=(m[5]||m[6]);return new Template('n = h.attr(n, r, "#{1}", "#{3}", "#{2}", c); c = false;').evaluate(m)},pseudo:function(m){if(m[6]){m[6]=m[6].replace(/"/g,'\\"')}return new Template('n = h.pseudo(n, "#{1}", "#{6}", r, c); c = false;').evaluate(m)},descendant:'c = "descendant";',child:'c = "child";',adjacent:'c = "adjacent";',laterSibling:'c = "laterSibling";'},patterns:[{name:"laterSibling",re:/^\s*~\s*/},{name:"child",re:/^\s*>\s*/},{name:"adjacent",re:/^\s*\+\s*/},{name:"descendant",re:/^\s/},{name:"tagName",re:/^\s*(\*|[\w\-]+)(\b|$)?/},{name:"id",re:/^#([\w\-\*]+)(\b|$)/},{name:"className",re:/^\.([\w\-\*]+)(\b|$)/},{name:"pseudo",re:/^:((first|last|nth|nth-last|only)(-child|-of-type)|empty|checked|(en|dis)abled|not)(\((.*?)\))?(\b|$|(?=\s|[:+~>]))/},{name:"attrPresence",re:/^\[((?:[\w-]+:)?[\w-]+)\]/},{name:"attr",re:/\[((?:[\w-]*:)?[\w-]+)\s*(?:([!^$*~|]?=)\s*((['"])([^\4]*?)\4|([^'"][^\]]*?)))?\]/}],assertions:{tagName:function(element,matches){return matches[1].toUpperCase()==element.tagName.toUpperCase()},className:function(element,matches){return Element.hasClassName(element,matches[1])},id:function(element,matches){return element.id===matches[1]},attrPresence:function(element,matches){return Element.hasAttribute(element,matches[1])},attr:function(element,matches){var nodeValue=Element.readAttribute(element,matches[1]);return nodeValue&&Selector.operators[matches[2]](nodeValue,matches[5]||matches[6])}},handlers:{concat:function(a,b){for(var i=0,node;node=b[i];i++){a.push(node)}return a},mark:function(nodes){var _true=Prototype.emptyFunction;for(var i=0,node;node=nodes[i];i++){node._countedByPrototype=_true}return nodes},unmark:(function(){var PROPERTIES_ATTRIBUTES_MAP=(function(){var el=document.createElement("div"),isBuggy=false,propName="_countedByPrototype",value="x";el[propName]=value;isBuggy=(el.getAttribute(propName)===value);el=null;return isBuggy})();return PROPERTIES_ATTRIBUTES_MAP?function(nodes){for(var i=0,node;node=nodes[i];i++){node.removeAttribute("_countedByPrototype")}return nodes}:function(nodes){for(var i=0,node;node=nodes[i];i++){node._countedByPrototype=void 0}return nodes}})(),index:function(parentNode,reverse,ofType){parentNode._countedByPrototype=Prototype.emptyFunction;if(reverse){for(var nodes=parentNode.childNodes,i=nodes.length-1,j=1;i>=0;i--){var node=nodes[i];if(node.nodeType==1&&(!ofType||node._countedByPrototype)){node.nodeIndex=j++}}}else{for(var i=0,j=1,nodes=parentNode.childNodes;node=nodes[i];i++){if(node.nodeType==1&&(!ofType||node._countedByPrototype)){node.nodeIndex=j++}}}},unique:function(nodes){if(nodes.length==0){return nodes}var results=[],n;for(var i=0,l=nodes.length;i<l;i++){if(typeof(n=nodes[i])._countedByPrototype=="undefined"){n._countedByPrototype=Prototype.emptyFunction;results.push(Element.extend(n))}}return Selector.handlers.unmark(results)},descendant:function(nodes){var h=Selector.handlers;for(var i=0,results=[],node;node=nodes[i];i++){h.concat(results,node.getElementsByTagName("*"))}return results},child:function(nodes){var h=Selector.handlers;for(var i=0,results=[],node;node=nodes[i];i++){for(var j=0,child;child=node.childNodes[j];j++){if(child.nodeType==1&&child.tagName!="!"){results.push(child)}}}return results},adjacent:function(nodes){for(var i=0,results=[],node;node=nodes[i];i++){var next=this.nextElementSibling(node);if(next){results.push(next)}}return results},laterSibling:function(nodes){var h=Selector.handlers;for(var i=0,results=[],node;node=nodes[i];i++){h.concat(results,Element.nextSiblings(node))}return results},nextElementSibling:function(node){while(node=node.nextSibling){if(node.nodeType==1){return node}}return null},previousElementSibling:function(node){while(node=node.previousSibling){if(node.nodeType==1){return node}}return null},tagName:function(nodes,root,tagName,combinator){var uTagName=tagName.toUpperCase();var results=[],h=Selector.handlers;if(nodes){if(combinator){if(combinator=="descendant"){for(var i=0,node;node=nodes[i];i++){h.concat(results,node.getElementsByTagName(tagName))}return results}else{nodes=this[combinator](nodes)}if(tagName=="*"){return nodes}}for(var i=0,node;node=nodes[i];i++){if(node.tagName.toUpperCase()===uTagName){results.push(node)}}return results}else{return root.getElementsByTagName(tagName)}},id:function(nodes,root,id,combinator){var targetNode=$(id),h=Selector.handlers;if(root==document){if(!targetNode){return[]}if(!nodes){return[targetNode]}}else{if(!root.sourceIndex||root.sourceIndex<1){var nodes=root.getElementsByTagName("*");for(var j=0,node;node=nodes[j];j++){if(node.id===id){return[node]}}}}if(nodes){if(combinator){if(combinator=="child"){for(var i=0,node;node=nodes[i];i++){if(targetNode.parentNode==node){return[targetNode]}}}else{if(combinator=="descendant"){for(var i=0,node;node=nodes[i];i++){if(Element.descendantOf(targetNode,node)){return[targetNode]}}}else{if(combinator=="adjacent"){for(var i=0,node;node=nodes[i];i++){if(Selector.handlers.previousElementSibling(targetNode)==node){return[targetNode]}}}else{nodes=h[combinator](nodes)}}}}for(var i=0,node;node=nodes[i];i++){if(node==targetNode){return[targetNode]}}return[]}return(targetNode&&Element.descendantOf(targetNode,root))?[targetNode]:[]},className:function(nodes,root,className,combinator){if(nodes&&combinator){nodes=this[combinator](nodes)}return Selector.handlers.byClassName(nodes,root,className)},byClassName:function(nodes,root,className){if(!nodes){nodes=Selector.handlers.descendant([root])}var needle=" "+className+" ";for(var i=0,results=[],node,nodeClassName;node=nodes[i];i++){nodeClassName=node.className;if(nodeClassName.length==0){continue}if(nodeClassName==className||(" "+nodeClassName+" ").include(needle)){results.push(node)}}return results},attrPresence:function(nodes,root,attr,combinator){if(!nodes){nodes=root.getElementsByTagName("*")}if(nodes&&combinator){nodes=this[combinator](nodes)}var results=[];for(var i=0,node;node=nodes[i];i++){if(Element.hasAttribute(node,attr)){results.push(node)}}return results},attr:function(nodes,root,attr,value,operator,combinator){if(!nodes){nodes=root.getElementsByTagName("*")}if(nodes&&combinator){nodes=this[combinator](nodes)}var handler=Selector.operators[operator],results=[];for(var i=0,node;node=nodes[i];i++){var nodeValue=Element.readAttribute(node,attr);if(nodeValue===null){continue}if(handler(nodeValue,value)){results.push(node)}}return results},pseudo:function(nodes,name,value,root,combinator){if(nodes&&combinator){nodes=this[combinator](nodes)}if(!nodes){nodes=root.getElementsByTagName("*")}return Selector.pseudos[name](nodes,value,root)}},pseudos:{"first-child":function(nodes,value,root){for(var i=0,results=[],node;node=nodes[i];i++){if(Selector.handlers.previousElementSibling(node)){continue}results.push(node)}return results},"last-child":function(nodes,value,root){for(var i=0,results=[],node;node=nodes[i];i++){if(Selector.handlers.nextElementSibling(node)){continue}results.push(node)}return results},"only-child":function(nodes,value,root){var h=Selector.handlers;for(var i=0,results=[],node;node=nodes[i];i++){if(!h.previousElementSibling(node)&&!h.nextElementSibling(node)){results.push(node)}}return results},"nth-child":function(nodes,formula,root){return Selector.pseudos.nth(nodes,formula,root)},"nth-last-child":function(nodes,formula,root){return Selector.pseudos.nth(nodes,formula,root,true)},"nth-of-type":function(nodes,formula,root){return Selector.pseudos.nth(nodes,formula,root,false,true)},"nth-last-of-type":function(nodes,formula,root){return Selector.pseudos.nth(nodes,formula,root,true,true)},"first-of-type":function(nodes,formula,root){return Selector.pseudos.nth(nodes,"1",root,false,true)},"last-of-type":function(nodes,formula,root){return Selector.pseudos.nth(nodes,"1",root,true,true)},"only-of-type":function(nodes,formula,root){var p=Selector.pseudos;return p["last-of-type"](p["first-of-type"](nodes,formula,root),formula,root)},getIndices:function(a,b,total){if(a==0){return b>0?[b]:[]}return $R(1,total).inject([],function(memo,i){if(0==(i-b)%a&&(i-b)/a>=0){memo.push(i)}return memo})},nth:function(nodes,formula,root,reverse,ofType){if(nodes.length==0){return[]}if(formula=="even"){formula="2n+0"}if(formula=="odd"){formula="2n+1"}var h=Selector.handlers,results=[],indexed=[],m;h.mark(nodes);for(var i=0,node;node=nodes[i];i++){if(!node.parentNode._countedByPrototype){h.index(node.parentNode,reverse,ofType);indexed.push(node.parentNode)}}if(formula.match(/^\d+$/)){formula=Number(formula);for(var i=0,node;node=nodes[i];i++){if(node.nodeIndex==formula){results.push(node)}}}else{if(m=formula.match(/^(-?\d*)?n(([+-])(\d+))?/)){if(m[1]=="-"){m[1]=-1}var a=m[1]?Number(m[1]):1;var b=m[2]?Number(m[2]):0;var indices=Selector.pseudos.getIndices(a,b,nodes.length);for(var i=0,node,l=indices.length;node=nodes[i];i++){for(var j=0;j<l;j++){if(node.nodeIndex==indices[j]){results.push(node)}}}}}h.unmark(nodes);h.unmark(indexed);return results},empty:function(nodes,value,root){for(var i=0,results=[],node;node=nodes[i];i++){if(node.tagName=="!"||node.firstChild){continue}results.push(node)}return results},not:function(nodes,selector,root){var h=Selector.handlers,selectorType,m;var exclusions=new Selector(selector).findElements(root);h.mark(exclusions);for(var i=0,results=[],node;node=nodes[i];i++){if(!node._countedByPrototype){results.push(node)}}h.unmark(exclusions);return results},enabled:function(nodes,value,root){for(var i=0,results=[],node;node=nodes[i];i++){if(!node.disabled&&(!node.type||node.type!=="hidden")){results.push(node)}}return results},disabled:function(nodes,value,root){for(var i=0,results=[],node;node=nodes[i];i++){if(node.disabled){results.push(node)}}return results},checked:function(nodes,value,root){for(var i=0,results=[],node;node=nodes[i];i++){if(node.checked){results.push(node)}}return results}},operators:{"=":function(nv,v){return nv==v},"!=":function(nv,v){return nv!=v},"^=":function(nv,v){return nv==v||nv&&nv.startsWith(v)},"$=":function(nv,v){return nv==v||nv&&nv.endsWith(v)},"*=":function(nv,v){return nv==v||nv&&nv.include(v)},"~=":function(nv,v){return(" "+nv+" ").include(" "+v+" ")},"|=":function(nv,v){return("-"+(nv||"").toUpperCase()+"-").include("-"+(v||"").toUpperCase()+"-")}},split:function(expression){var expressions=[];expression.scan(/(([\w#:.~>+()\s-]+|\*|\[.*?\])+)\s*(,|$)/,function(m){expressions.push(m[1].strip())});return expressions},matchElements:function(elements,expression){var matches=$$(expression),h=Selector.handlers;h.mark(matches);for(var i=0,results=[],element;element=elements[i];i++){if(element._countedByPrototype){results.push(element)}}h.unmark(matches);return results},findElement:function(elements,expression,index){if(Object.isNumber(expression)){index=expression;expression=false}return Selector.matchElements(elements,expression||"*")[index||0]},findChildElements:function(element,expressions){expressions=Selector.split(expressions.join(","));var results=[],h=Selector.handlers;for(var i=0,l=expressions.length,selector;i<l;i++){selector=new Selector(expressions[i].strip());h.concat(results,selector.findElements(element))}return(l>1)?h.unique(results):results}});if(Prototype.Browser.IE){Object.extend(Selector.handlers,{concat:function(a,b){for(var i=0,node;node=b[i];i++){if(node.tagName!=="!"){a.push(node)}}return a}})}function $$(){return Selector.findChildElements(document,$A(arguments))}var Form={reset:function(form){form=$(form);form.reset();return form},serializeElements:function(elements,options){if(typeof options!="object"){options={hash:!!options}}else{if(Object.isUndefined(options.hash)){options.hash=true}}var key,value,submitted=false,submit=options.submit;var data=elements.inject({},function(result,element){if(!element.disabled&&element.name){key=element.name;value=$(element).getValue();if(value!=null&&element.type!="file"&&(element.type!="submit"||(!submitted&&submit!==false&&(!submit||key==submit)&&(submitted=true)))){if(key in result){if(!Object.isArray(result[key])){result[key]=[result[key]]}result[key].push(value)}else{result[key]=value}}}return result});return options.hash?data:Object.toQueryString(data)}};Form.Methods={serialize:function(form,options){return Form.serializeElements(Form.getElements(form),options)},getElements:function(form){var elements=$(form).getElementsByTagName("*"),element,arr=[],serializers=Form.Element.Serializers;for(var i=0;element=elements[i];i++){arr.push(element)}return arr.inject([],function(elements,child){if(serializers[child.tagName.toLowerCase()]){elements.push(Element.extend(child))}return elements})},getInputs:function(form,typeName,name){form=$(form);var inputs=form.getElementsByTagName("input");if(!typeName&&!name){return $A(inputs).map(Element.extend)}for(var i=0,matchingInputs=[],length=inputs.length;i<length;i++){var input=inputs[i];if((typeName&&input.type!=typeName)||(name&&input.name!=name)){continue}matchingInputs.push(Element.extend(input))}return matchingInputs},disable:function(form){form=$(form);Form.getElements(form).invoke("disable");return form},enable:function(form){form=$(form);Form.getElements(form).invoke("enable");return form},findFirstElement:function(form){var elements=$(form).getElements().findAll(function(element){return"hidden"!=element.type&&!element.disabled});var firstByIndex=elements.findAll(function(element){return element.hasAttribute("tabIndex")&&element.tabIndex>=0}).sortBy(function(element){return element.tabIndex}).first();return firstByIndex?firstByIndex:elements.find(function(element){return/^(?:input|select|textarea)$/i.test(element.tagName)})},focusFirstElement:function(form){form=$(form);form.findFirstElement().activate();return form},request:function(form,options){form=$(form),options=Object.clone(options||{});var params=options.parameters,action=form.readAttribute("action")||"";if(action.blank()){action=window.location.href}options.parameters=form.serialize(true);if(params){if(Object.isString(params)){params=params.toQueryParams()}Object.extend(options.parameters,params)}if(form.hasAttribute("method")&&!options.method){options.method=form.method}return new Ajax.Request(action,options)}};Form.Element={focus:function(element){$(element).focus();return element},select:function(element){$(element).select();return element}};Form.Element.Methods={serialize:function(element){element=$(element);if(!element.disabled&&element.name){var value=element.getValue();if(value!=undefined){var pair={};pair[element.name]=value;return Object.toQueryString(pair)}}return""},getValue:function(element){element=$(element);var method=element.tagName.toLowerCase();return Form.Element.Serializers[method](element)},setValue:function(element,value){element=$(element);var method=element.tagName.toLowerCase();Form.Element.Serializers[method](element,value);return element},clear:function(element){$(element).value="";return element},present:function(element){return $(element).value!=""},activate:function(element){element=$(element);try{element.focus();if(element.select&&(element.tagName.toLowerCase()!="input"||!(/^(?:button|reset|submit)$/i.test(element.type)))){element.select()}}catch(e){}return element},disable:function(element){element=$(element);element.disabled=true;return element},enable:function(element){element=$(element);element.disabled=false;return element}};var Field=Form.Element;var $F=Form.Element.Methods.getValue;Form.Element.Serializers={input:function(element,value){switch(element.type.toLowerCase()){case"checkbox":case"radio":return Form.Element.Serializers.inputSelector(element,value);default:return Form.Element.Serializers.textarea(element,value)}},inputSelector:function(element,value){if(Object.isUndefined(value)){return element.checked?element.value:null}else{element.checked=!!value}},textarea:function(element,value){if(Object.isUndefined(value)){return element.value}else{element.value=value}},select:function(element,value){if(Object.isUndefined(value)){return this[element.type=="select-one"?"selectOne":"selectMany"](element)}else{var opt,currentValue,single=!Object.isArray(value);for(var i=0,length=element.length;i<length;i++){opt=element.options[i];currentValue=this.optionValue(opt);if(single){if(currentValue==value){opt.selected=true;return}}else{opt.selected=value.include(currentValue)}}}},selectOne:function(element){var index=element.selectedIndex;return index>=0?this.optionValue(element.options[index]):null},selectMany:function(element){var values,length=element.length;if(!length){return null}for(var i=0,values=[];i<length;i++){var opt=element.options[i];if(opt.selected){values.push(this.optionValue(opt))}}return values},optionValue:function(opt){return Element.extend(opt).hasAttribute("value")?opt.value:opt.text}};Abstract.TimedObserver=Class.create(PeriodicalExecuter,{initialize:function($super,element,frequency,callback){$super(callback,frequency);this.element=$(element);this.lastValue=this.getValue()},execute:function(){var value=this.getValue();if(Object.isString(this.lastValue)&&Object.isString(value)?this.lastValue!=value:String(this.lastValue)!=String(value)){this.callback(this.element,value);this.lastValue=value}}});Form.Element.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.Element.getValue(this.element)}});Form.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.serialize(this.element)}});Abstract.EventObserver=Class.create({initialize:function(element,callback){this.element=$(element);this.callback=callback;this.lastValue=this.getValue();if(this.element.tagName.toLowerCase()=="form"){this.registerFormCallbacks()}else{this.registerCallback(this.element)}},onElementEvent:function(){var value=this.getValue();if(this.lastValue!=value){this.callback(this.element,value);this.lastValue=value}},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback,this)},registerCallback:function(element){if(element.type){switch(element.type.toLowerCase()){case"checkbox":case"radio":Event.observe(element,"click",this.onElementEvent.bind(this));break;default:Event.observe(element,"change",this.onElementEvent.bind(this));break}}}});Form.Element.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.Element.getValue(this.element)}});Form.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.serialize(this.element)}});(function(){var Event={KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45,cache:{}};var docEl=document.documentElement;var MOUSEENTER_MOUSELEAVE_EVENTS_SUPPORTED="onmouseenter" in docEl&&"onmouseleave" in docEl;var _isButton;if(Prototype.Browser.IE){var buttonMap={0:1,1:4,2:2};_isButton=function(event,code){return event.button===buttonMap[code]}}else{if(Prototype.Browser.WebKit){_isButton=function(event,code){switch(code){case 0:return event.which==1&&!event.metaKey;case 1:return event.which==1&&event.metaKey;default:return false}}}else{_isButton=function(event,code){return event.which?(event.which===code+1):(event.button===code)}}}function isLeftClick(event){return _isButton(event,0)}function isMiddleClick(event){return _isButton(event,1)}function isRightClick(event){return _isButton(event,2)}function element(event){event=Event.extend(event);var node=event.target,type=event.type,currentTarget=event.currentTarget;if(currentTarget&&currentTarget.tagName){if(type==="load"||type==="error"||(type==="click"&&currentTarget.tagName.toLowerCase()==="input"&&currentTarget.type==="radio")){node=currentTarget}}if(node.nodeType==Node.TEXT_NODE){node=node.parentNode}return Element.extend(node)}function findElement(event,expression){var element=Event.element(event);if(!expression){return element}var elements=[element].concat(element.ancestors());return Selector.findElement(elements,expression,0)}function pointer(event){return{x:pointerX(event),y:pointerY(event)}}function pointerX(event){var docElement=document.documentElement,body=document.body||{scrollLeft:0};return event.pageX||(event.clientX+(docElement.scrollLeft||body.scrollLeft)-(docElement.clientLeft||0))}function pointerY(event){var docElement=document.documentElement,body=document.body||{scrollTop:0};return event.pageY||(event.clientY+(docElement.scrollTop||body.scrollTop)-(docElement.clientTop||0))}function stop(event){Event.extend(event);event.preventDefault();event.stopPropagation();event.stopped=true}Event.Methods={isLeftClick:isLeftClick,isMiddleClick:isMiddleClick,isRightClick:isRightClick,element:element,findElement:findElement,pointer:pointer,pointerX:pointerX,pointerY:pointerY,stop:stop};var methods=Object.keys(Event.Methods).inject({},function(m,name){m[name]=Event.Methods[name].methodize();return m});if(Prototype.Browser.IE){function _relatedTarget(event){var element;switch(event.type){case"mouseover":element=event.fromElement;break;case"mouseout":element=event.toElement;break;default:return null}return Element.extend(element)}Object.extend(methods,{stopPropagation:function(){this.cancelBubble=true},preventDefault:function(){this.returnValue=false},inspect:function(){return"[object Event]"}});Event.extend=function(event,element){if(!event){return false}if(event._extendedByPrototype){return event}event._extendedByPrototype=Prototype.emptyFunction;var pointer=Event.pointer(event);Object.extend(event,{target:event.srcElement||element,relatedTarget:_relatedTarget(event),pageX:pointer.x,pageY:pointer.y});return Object.extend(event,methods)}}else{Event.prototype=window.Event.prototype||document.createEvent("HTMLEvents").__proto__;Object.extend(Event.prototype,methods);Event.extend=Prototype.K}function _createResponder(element,eventName,handler){var registry=Element.retrieve(element,"prototype_event_registry");if(Object.isUndefined(registry)){CACHE.push(element);registry=Element.retrieve(element,"prototype_event_registry",$H())}var respondersForEvent=registry.get(eventName);if(Object.isUndefined(respondersForEvent)){respondersForEvent=[];registry.set(eventName,respondersForEvent)}if(respondersForEvent.pluck("handler").include(handler)){return false}var responder;if(eventName.include(":")){responder=function(event){if(Object.isUndefined(event.eventName)){return false}if(event.eventName!==eventName){return false}Event.extend(event,element);handler.call(element,event)}}else{if(!MOUSEENTER_MOUSELEAVE_EVENTS_SUPPORTED&&(eventName==="mouseenter"||eventName==="mouseleave")){if(eventName==="mouseenter"||eventName==="mouseleave"){responder=function(event){Event.extend(event,element);var parent=event.relatedTarget;while(parent&&parent!==element){try{parent=parent.parentNode}catch(e){parent=element}}if(parent===element){return}handler.call(element,event)}}}else{responder=function(event){Event.extend(event,element);handler.call(element,event)}}}responder.handler=handler;respondersForEvent.push(responder);return responder}function _destroyCache(){for(var i=0,length=CACHE.length;i<length;i++){Event.stopObserving(CACHE[i]);CACHE[i]=null}}var CACHE=[];if(Prototype.Browser.IE){window.attachEvent("onunload",_destroyCache)}if(Prototype.Browser.WebKit){window.addEventListener("unload",Prototype.emptyFunction,false)}var _getDOMEventName=Prototype.K;if(!MOUSEENTER_MOUSELEAVE_EVENTS_SUPPORTED){_getDOMEventName=function(eventName){var translations={mouseenter:"mouseover",mouseleave:"mouseout"};return eventName in translations?translations[eventName]:eventName}}function observe(element,eventName,handler){element=$(element);var responder=_createResponder(element,eventName,handler);if(!responder){return element}if(eventName.include(":")){if(element.addEventListener){element.addEventListener("dataavailable",responder,false)}else{element.attachEvent("ondataavailable",responder);element.attachEvent("onfilterchange",responder)}}else{var actualEventName=_getDOMEventName(eventName);if(element.addEventListener){element.addEventListener(actualEventName,responder,false)}else{element.attachEvent("on"+actualEventName,responder)}}return element}function stopObserving(element,eventName,handler){element=$(element);var registry=Element.retrieve(element,"prototype_event_registry");if(Object.isUndefined(registry)){return element}if(eventName&&!handler){var responders=registry.get(eventName);if(Object.isUndefined(responders)){return element}responders.each(function(r){Element.stopObserving(element,eventName,r.handler)});return element}else{if(!eventName){registry.each(function(pair){var eventName=pair.key,responders=pair.value;responders.each(function(r){Element.stopObserving(element,eventName,r.handler)})});return element}}var responders=registry.get(eventName);if(!responders){return}var responder=responders.find(function(r){return r.handler===handler});if(!responder){return element}var actualEventName=_getDOMEventName(eventName);if(eventName.include(":")){if(element.removeEventListener){element.removeEventListener("dataavailable",responder,false)}else{element.detachEvent("ondataavailable",responder);element.detachEvent("onfilterchange",responder)}}else{if(element.removeEventListener){element.removeEventListener(actualEventName,responder,false)}else{element.detachEvent("on"+actualEventName,responder)}}registry.set(eventName,responders.without(responder));return element}function fire(element,eventName,memo,bubble){element=$(element);if(Object.isUndefined(bubble)){bubble=true}if(element==document&&document.createEvent&&!element.dispatchEvent){element=document.documentElement}var event;if(document.createEvent){event=document.createEvent("HTMLEvents");event.initEvent("dataavailable",true,true)}else{event=document.createEventObject();event.eventType=bubble?"ondataavailable":"onfilterchange"}event.eventName=eventName;event.memo=memo||{};if(document.createEvent){element.dispatchEvent(event)}else{element.fireEvent(event.eventType,event)}return Event.extend(event)}Object.extend(Event,Event.Methods);Object.extend(Event,{fire:fire,observe:observe,stopObserving:stopObserving});Element.addMethods({fire:fire,observe:observe,stopObserving:stopObserving});Object.extend(document,{fire:fire.methodize(),observe:observe.methodize(),stopObserving:stopObserving.methodize(),loaded:false});if(window.Event){Object.extend(window.Event,Event)}else{window.Event=Event}})();(function(){var timer;function fireContentLoadedEvent(){if(document.loaded){return}if(timer){window.clearTimeout(timer)}document.loaded=true;document.fire("dom:loaded")}function checkReadyState(){if(document.readyState==="complete"){document.stopObserving("readystatechange",checkReadyState);fireContentLoadedEvent()}}function pollDoScroll(){try{document.documentElement.doScroll("left")}catch(e){timer=pollDoScroll.defer();return}fireContentLoadedEvent()}if(document.addEventListener){document.addEventListener("DOMContentLoaded",fireContentLoadedEvent,false)}else{document.observe("readystatechange",checkReadyState);if(window==top){timer=pollDoScroll.defer()}}Event.observe(window,"load",fireContentLoadedEvent)})();Element.addMethods();Hash.toQueryString=Object.toQueryString;var Toggle={display:Element.toggle};Element.Methods.childOf=Element.Methods.descendantOf;var Insertion={Before:function(element,content){return Element.insert(element,{before:content})},Top:function(element,content){return Element.insert(element,{top:content})},Bottom:function(element,content){return Element.insert(element,{bottom:content})},After:function(element,content){return Element.insert(element,{after:content})}};var $continue=new Error('"throw $continue" is deprecated, use "return" instead');var Position={includeScrollOffsets:false,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;this.deltaY=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},within:function(element,x,y){if(this.includeScrollOffsets){return this.withinIncludingScrolloffsets(element,x,y)}this.xcomp=x;this.ycomp=y;this.offset=Element.cumulativeOffset(element);return(y>=this.offset[1]&&y<this.offset[1]+element.offsetHeight&&x>=this.offset[0]&&x<this.offset[0]+element.offsetWidth)},withinIncludingScrolloffsets:function(element,x,y){var offsetcache=Element.cumulativeScrollOffset(element);this.xcomp=x+offsetcache[0]-this.deltaX;this.ycomp=y+offsetcache[1]-this.deltaY;this.offset=Element.cumulativeOffset(element);return(this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+element.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+element.offsetWidth)},overlap:function(mode,element){if(!mode){return 0}if(mode=="vertical"){return((this.offset[1]+element.offsetHeight)-this.ycomp)/element.offsetHeight}if(mode=="horizontal"){return((this.offset[0]+element.offsetWidth)-this.xcomp)/element.offsetWidth}},cumulativeOffset:Element.Methods.cumulativeOffset,positionedOffset:Element.Methods.positionedOffset,absolutize:function(element){Position.prepare();return Element.absolutize(element)},relativize:function(element){Position.prepare();return Element.relativize(element)},realOffset:Element.Methods.cumulativeScrollOffset,offsetParent:Element.Methods.getOffsetParent,page:Element.Methods.viewportOffset,clone:function(source,target,options){options=options||{};return Element.clonePosition(target,source,options)}};if(!document.getElementsByClassName){document.getElementsByClassName=function(instanceMethods){function iter(name){return name.blank()?null:"[contains(concat(' ', @class, ' '), ' "+name+" ')]"}instanceMethods.getElementsByClassName=Prototype.BrowserFeatures.XPath?function(element,className){className=className.toString().strip();var cond=/\s/.test(className)?$w(className).map(iter).join(""):iter(className);return cond?document._getElementsByXPath(".//*"+cond,element):[]}:function(element,className){className=className.toString().strip();var elements=[],classNames=(/\s/.test(className)?$w(className):null);if(!classNames&&!className){return elements}var nodes=$(element).getElementsByTagName("*");className=" "+className+" ";for(var i=0,child,cn;child=nodes[i];i++){if(child.className&&(cn=" "+child.className+" ")&&(cn.include(className)||(classNames&&classNames.all(function(name){return !name.toString().blank()&&cn.include(" "+name+" ")})))){elements.push(Element.extend(child))}}return elements};return function(className,parentElement){return $(parentElement||document.body).getElementsByClassName(className)}}(Element.Methods)}Element.ClassNames=Class.create();Element.ClassNames.prototype={initialize:function(element){this.element=$(element)},_each:function(iterator){this.element.className.split(/\s+/).select(function(name){return name.length>0})._each(iterator)},set:function(className){this.element.className=className},add:function(classNameToAdd){if(this.include(classNameToAdd)){return}this.set($A(this).concat(classNameToAdd).join(" "))},remove:function(classNameToRemove){if(!this.include(classNameToRemove)){return}this.set($A(this).without(classNameToRemove).join(" "))},toString:function(){return $A(this).join(" ")}};Object.extend(Element.ClassNames.prototype,Enumerable);var Scriptaculous={Version:"1.8.2",require:function(libraryName){document.write('<script type="text/javascript" src="'+libraryName+'"><\/script>')},REQUIRED_PROTOTYPE:"1.6.0.3",load:function(){function convertVersionString(versionString){var v=versionString.replace(/_.*|\./g,"");v=parseInt(v+"0".times(4-v.length));return versionString.indexOf("_")>-1?v-1:v}if((typeof Prototype=="undefined")||(typeof Element=="undefined")||(typeof Element.Methods=="undefined")||(convertVersionString(Prototype.Version)<convertVersionString(Scriptaculous.REQUIRED_PROTOTYPE))){throw ("script.aculo.us requires the Prototype JavaScript framework >= "+Scriptaculous.REQUIRED_PROTOTYPE)}var js=/scriptaculous\.js(\?.*)?$/;$$("head script[src]").findAll(function(s){return s.src.match(js)}).each(function(s){var path=s.src.replace(js,""),includes=s.src.match(/\?.*load=([a-z,]*)/);(includes?includes[1]:"builder,effects,dragdrop,controls,slider,sound").split(",").each(function(include){Scriptaculous.require(path+include+".js")})})}};Scriptaculous.load();String.prototype.parseColor=function(){var color="#";if(this.slice(0,4)=="rgb("){var cols=this.slice(4,this.length-1).split(",");var i=0;do{color+=parseInt(cols[i]).toColorPart()}while(++i<3)}else{if(this.slice(0,1)=="#"){if(this.length==4){for(var i=1;i<4;i++){color+=(this.charAt(i)+this.charAt(i)).toLowerCase()}}if(this.length==7){color=this.toLowerCase()}}}return(color.length==7?color:(arguments[0]||this))};Element.collectTextNodes=function(element){return $A($(element).childNodes).collect(function(node){return(node.nodeType==3?node.nodeValue:(node.hasChildNodes()?Element.collectTextNodes(node):""))}).flatten().join("")};Element.collectTextNodesIgnoreClass=function(element,className){return $A($(element).childNodes).collect(function(node){return(node.nodeType==3?node.nodeValue:((node.hasChildNodes()&&!Element.hasClassName(node,className))?Element.collectTextNodesIgnoreClass(node,className):""))}).flatten().join("")};Element.setContentZoom=function(element,percent){element=$(element);element.setStyle({fontSize:(percent/100)+"em"});if(Prototype.Browser.WebKit){window.scrollBy(0,0)}return element};Element.getInlineOpacity=function(element){return $(element).style.opacity||""};Element.forceRerendering=function(element){try{element=$(element);var n=document.createTextNode(" ");element.appendChild(n);element.removeChild(n)}catch(e){}};var Effect={_elementDoesNotExistError:{name:"ElementDoesNotExistError",message:"The specified DOM element does not exist, but is required for this effect to operate"},Transitions:{linear:Prototype.K,sinoidal:function(pos){return(-Math.cos(pos*Math.PI)/2)+0.5},reverse:function(pos){return 1-pos},flicker:function(pos){var pos=((-Math.cos(pos*Math.PI)/4)+0.75)+Math.random()/4;return pos>1?1:pos},wobble:function(pos){return(-Math.cos(pos*Math.PI*(9*pos))/2)+0.5},pulse:function(pos,pulses){return(-Math.cos((pos*((pulses||5)-0.5)*2)*Math.PI)/2)+0.5},spring:function(pos){return 1-(Math.cos(pos*4.5*Math.PI)*Math.exp(-pos*6))},none:function(pos){return 0},full:function(pos){return 1}},DefaultOptions:{duration:1,fps:100,sync:false,from:0,to:1,delay:0,queue:"parallel"},tagifyText:function(element){var tagifyStyle="position:relative";if(Prototype.Browser.IE){tagifyStyle+=";zoom:1"}element=$(element);$A(element.childNodes).each(function(child){if(child.nodeType==3){child.nodeValue.toArray().each(function(character){element.insertBefore(new Element("span",{style:tagifyStyle}).update(character==" "?String.fromCharCode(160):character),child)});Element.remove(child)}})},multiple:function(element,effect){var elements;if(((typeof element=="object")||Object.isFunction(element))&&(element.length)){elements=element}else{elements=$(element).childNodes}var options=Object.extend({speed:0.1,delay:0},arguments[2]||{});var masterDelay=options.delay;$A(elements).each(function(element,index){new effect(element,Object.extend(options,{delay:index*options.speed+masterDelay}))})},PAIRS:{slide:["SlideDown","SlideUp"],blind:["BlindDown","BlindUp"],appear:["Appear","Fade"]},toggle:function(element,effect){element=$(element);effect=(effect||"appear").toLowerCase();var options=Object.extend({queue:{position:"end",scope:(element.id||"global"),limit:1}},arguments[2]||{});Effect[element.visible()?Effect.PAIRS[effect][1]:Effect.PAIRS[effect][0]](element,options)}};Effect.DefaultOptions.transition=Effect.Transitions.sinoidal;Effect.ScopedQueue=Class.create(Enumerable,{initialize:function(){this.effects=[];this.interval=null},_each:function(iterator){this.effects._each(iterator)},add:function(effect){var timestamp=new Date().getTime();var position=Object.isString(effect.options.queue)?effect.options.queue:effect.options.queue.position;switch(position){case"front":this.effects.findAll(function(e){return e.state=="idle"}).each(function(e){e.startOn+=effect.finishOn;e.finishOn+=effect.finishOn});break;case"with-last":timestamp=this.effects.pluck("startOn").max()||timestamp;break;case"end":timestamp=this.effects.pluck("finishOn").max()||timestamp;break}effect.startOn+=timestamp;effect.finishOn+=timestamp;if(!effect.options.queue.limit||(this.effects.length<effect.options.queue.limit)){this.effects.push(effect)}if(!this.interval){this.interval=setInterval(this.loop.bind(this),15)}},remove:function(effect){this.effects=this.effects.reject(function(e){return e==effect});if(this.effects.length==0){clearInterval(this.interval);this.interval=null}},loop:function(){var timePos=new Date().getTime();for(var i=0,len=this.effects.length;i<len;i++){this.effects[i]&&this.effects[i].loop(timePos)}}});Effect.Queues={instances:$H(),get:function(queueName){if(!Object.isString(queueName)){return queueName}return this.instances.get(queueName)||this.instances.set(queueName,new Effect.ScopedQueue())}};Effect.Queue=Effect.Queues.get("global");Effect.Base=Class.create({position:null,start:function(options){function codeForEvent(options,eventName){return((options[eventName+"Internal"]?"this.options."+eventName+"Internal(this);":"")+(options[eventName]?"this.options."+eventName+"(this);":""))}if(options&&options.transition===false){options.transition=Effect.Transitions.linear}this.options=Object.extend(Object.extend({},Effect.DefaultOptions),options||{});this.currentFrame=0;this.state="idle";this.startOn=this.options.delay*1000;this.finishOn=this.startOn+(this.options.duration*1000);this.fromToDelta=this.options.to-this.options.from;this.totalTime=this.finishOn-this.startOn;this.totalFrames=this.options.fps*this.options.duration;this.render=(function(){function dispatch(effect,eventName){if(effect.options[eventName+"Internal"]){effect.options[eventName+"Internal"](effect)}if(effect.options[eventName]){effect.options[eventName](effect)}}return function(pos){if(this.state==="idle"){this.state="running";dispatch(this,"beforeSetup");if(this.setup){this.setup()}dispatch(this,"afterSetup")}if(this.state==="running"){pos=(this.options.transition(pos)*this.fromToDelta)+this.options.from;this.position=pos;dispatch(this,"beforeUpdate");if(this.update){this.update(pos)}dispatch(this,"afterUpdate")}}})();this.event("beforeStart");if(!this.options.sync){Effect.Queues.get(Object.isString(this.options.queue)?"global":this.options.queue.scope).add(this)}},loop:function(timePos){if(timePos>=this.startOn){if(timePos>=this.finishOn){this.render(1);this.cancel();this.event("beforeFinish");if(this.finish){this.finish()}this.event("afterFinish");return}var pos=(timePos-this.startOn)/this.totalTime,frame=(pos*this.totalFrames).round();if(frame>this.currentFrame){this.render(pos);this.currentFrame=frame}}},cancel:function(){if(!this.options.sync){Effect.Queues.get(Object.isString(this.options.queue)?"global":this.options.queue.scope).remove(this)}this.state="finished"},event:function(eventName){if(this.options[eventName+"Internal"]){this.options[eventName+"Internal"](this)}if(this.options[eventName]){this.options[eventName](this)}},inspect:function(){var data=$H();for(property in this){if(!Object.isFunction(this[property])){data.set(property,this[property])}}return"#<Effect:"+data.inspect()+",options:"+$H(this.options).inspect()+">"}});Effect.Parallel=Class.create(Effect.Base,{initialize:function(effects){this.effects=effects||[];this.start(arguments[1])},update:function(position){this.effects.invoke("render",position)},finish:function(position){this.effects.each(function(effect){effect.render(1);effect.cancel();effect.event("beforeFinish");if(effect.finish){effect.finish(position)}effect.event("afterFinish")})}});Effect.Tween=Class.create(Effect.Base,{initialize:function(object,from,to){object=Object.isString(object)?$(object):object;var args=$A(arguments),method=args.last(),options=args.length==5?args[3]:null;this.method=Object.isFunction(method)?method.bind(object):Object.isFunction(object[method])?object[method].bind(object):function(value){object[method]=value};this.start(Object.extend({from:from,to:to},options||{}))},update:function(position){this.method(position)}});Effect.Event=Class.create(Effect.Base,{initialize:function(){this.start(Object.extend({duration:0},arguments[0]||{}))},update:Prototype.emptyFunction});Effect.Opacity=Class.create(Effect.Base,{initialize:function(element){this.element=$(element);if(!this.element){throw (Effect._elementDoesNotExistError)}if(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout)){this.element.setStyle({zoom:1})}var options=Object.extend({from:this.element.getOpacity()||0,to:1},arguments[1]||{});this.start(options)},update:function(position){this.element.setOpacity(position)}});Effect.Move=Class.create(Effect.Base,{initialize:function(element){this.element=$(element);if(!this.element){throw (Effect._elementDoesNotExistError)}var options=Object.extend({x:0,y:0,mode:"relative"},arguments[1]||{});this.start(options)},setup:function(){this.element.makePositioned();this.originalLeft=parseFloat(this.element.getStyle("left")||"0");this.originalTop=parseFloat(this.element.getStyle("top")||"0");if(this.options.mode=="absolute"){this.options.x=this.options.x-this.originalLeft;this.options.y=this.options.y-this.originalTop}},update:function(position){this.element.setStyle({left:(this.options.x*position+this.originalLeft).round()+"px",top:(this.options.y*position+this.originalTop).round()+"px"})}});Effect.MoveBy=function(element,toTop,toLeft){return new Effect.Move(element,Object.extend({x:toLeft,y:toTop},arguments[3]||{}))};Effect.Scale=Class.create(Effect.Base,{initialize:function(element,percent){this.element=$(element);if(!this.element){throw (Effect._elementDoesNotExistError)}var options=Object.extend({scaleX:true,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:"box",scaleFrom:100,scaleTo:percent},arguments[2]||{});this.start(options)},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||false;this.elementPositioning=this.element.getStyle("position");this.originalStyle={};["top","left","width","height","fontSize"].each(function(k){this.originalStyle[k]=this.element.style[k]}.bind(this));this.originalTop=this.element.offsetTop;this.originalLeft=this.element.offsetLeft;var fontSize=this.element.getStyle("font-size")||"100%";["em","px","%","pt"].each(function(fontSizeType){if(fontSize.indexOf(fontSizeType)>0){this.fontSize=parseFloat(fontSize);this.fontSizeType=fontSizeType}}.bind(this));this.factor=(this.options.scaleTo-this.options.scaleFrom)/100;this.dims=null;if(this.options.scaleMode=="box"){this.dims=[this.element.offsetHeight,this.element.offsetWidth]}if(/^content/.test(this.options.scaleMode)){this.dims=[this.element.scrollHeight,this.element.scrollWidth]}if(!this.dims){this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth]}},update:function(position){var currentScale=(this.options.scaleFrom/100)+(this.factor*position);if(this.options.scaleContent&&this.fontSize){this.element.setStyle({fontSize:this.fontSize*currentScale+this.fontSizeType})}this.setDimensions(this.dims[0]*currentScale,this.dims[1]*currentScale)},finish:function(position){if(this.restoreAfterFinish){this.element.setStyle(this.originalStyle)}},setDimensions:function(height,width){var d={};if(this.options.scaleX){d.width=width.round()+"px"}if(this.options.scaleY){d.height=height.round()+"px"}if(this.options.scaleFromCenter){var topd=(height-this.dims[0])/2;var leftd=(width-this.dims[1])/2;if(this.elementPositioning=="absolute"){if(this.options.scaleY){d.top=this.originalTop-topd+"px"}if(this.options.scaleX){d.left=this.originalLeft-leftd+"px"}}else{if(this.options.scaleY){d.top=-topd+"px"}if(this.options.scaleX){d.left=-leftd+"px"}}}this.element.setStyle(d)}});Effect.Highlight=Class.create(Effect.Base,{initialize:function(element){this.element=$(element);if(!this.element){throw (Effect._elementDoesNotExistError)}var options=Object.extend({startcolor:"#ffff99"},arguments[1]||{});this.start(options)},setup:function(){if(this.element.getStyle("display")=="none"){this.cancel();return}this.oldStyle={};if(!this.options.keepBackgroundImage){this.oldStyle.backgroundImage=this.element.getStyle("background-image");this.element.setStyle({backgroundImage:"none"})}if(!this.options.endcolor){this.options.endcolor=this.element.getStyle("background-color").parseColor("#ffffff")}if(!this.options.restorecolor){this.options.restorecolor=this.element.getStyle("background-color")}this._base=$R(0,2).map(function(i){return parseInt(this.options.startcolor.slice(i*2+1,i*2+3),16)}.bind(this));this._delta=$R(0,2).map(function(i){return parseInt(this.options.endcolor.slice(i*2+1,i*2+3),16)-this._base[i]}.bind(this))},update:function(position){this.element.setStyle({backgroundColor:$R(0,2).inject("#",function(m,v,i){return m+((this._base[i]+(this._delta[i]*position)).round().toColorPart())}.bind(this))})},finish:function(){this.element.setStyle(Object.extend(this.oldStyle,{backgroundColor:this.options.restorecolor}))}});Effect.ScrollTo=function(element){var options=arguments[1]||{},scrollOffsets=document.viewport.getScrollOffsets(),elementOffsets=$(element).cumulativeOffset();if(options.offset){elementOffsets[1]+=options.offset}return new Effect.Tween(null,scrollOffsets.top,elementOffsets[1],options,function(p){scrollTo(scrollOffsets.left,p.round())})};Effect.Fade=function(element){element=$(element);var oldOpacity=element.getInlineOpacity();var options=Object.extend({from:element.getOpacity()||1,to:0,afterFinishInternal:function(effect){if(effect.options.to!=0){return}effect.element.hide().setStyle({opacity:oldOpacity})}},arguments[1]||{});return new Effect.Opacity(element,options)};Effect.Appear=function(element){element=$(element);var options=Object.extend({from:(element.getStyle("display")=="none"?0:element.getOpacity()||0),to:1,afterFinishInternal:function(effect){effect.element.forceRerendering()},beforeSetup:function(effect){effect.element.setOpacity(effect.options.from).show()}},arguments[1]||{});return new Effect.Opacity(element,options)};Effect.Puff=function(element){element=$(element);var oldStyle={opacity:element.getInlineOpacity(),position:element.getStyle("position"),top:element.style.top,left:element.style.left,width:element.style.width,height:element.style.height};return new Effect.Parallel([new Effect.Scale(element,200,{sync:true,scaleFromCenter:true,scaleContent:true,restoreAfterFinish:true}),new Effect.Opacity(element,{sync:true,to:0})],Object.extend({duration:1,beforeSetupInternal:function(effect){Position.absolutize(effect.effects[0].element)},afterFinishInternal:function(effect){effect.effects[0].element.hide().setStyle(oldStyle)}},arguments[1]||{}))};Effect.BlindUp=function(element){element=$(element);element.makeClipping();return new Effect.Scale(element,0,Object.extend({scaleContent:false,scaleX:false,restoreAfterFinish:true,afterFinishInternal:function(effect){effect.element.hide().undoClipping()}},arguments[1]||{}))};Effect.BlindDown=function(element){element=$(element);var elementDimensions=element.getDimensions();return new Effect.Scale(element,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:elementDimensions.height,originalWidth:elementDimensions.width},restoreAfterFinish:true,afterSetup:function(effect){effect.element.makeClipping().setStyle({height:"0px"}).show()},afterFinishInternal:function(effect){effect.element.undoClipping()}},arguments[1]||{}))};Effect.SwitchOff=function(element){element=$(element);var oldOpacity=element.getInlineOpacity();return new Effect.Appear(element,Object.extend({duration:0.4,from:0,transition:Effect.Transitions.flicker,afterFinishInternal:function(effect){new Effect.Scale(effect.element,1,{duration:0.3,scaleFromCenter:true,scaleX:false,scaleContent:false,restoreAfterFinish:true,beforeSetup:function(effect){effect.element.makePositioned().makeClipping()},afterFinishInternal:function(effect){effect.element.hide().undoClipping().undoPositioned().setStyle({opacity:oldOpacity})}})}},arguments[1]||{}))};Effect.DropOut=function(element){element=$(element);var oldStyle={top:element.getStyle("top"),left:element.getStyle("left"),opacity:element.getInlineOpacity()};return new Effect.Parallel([new Effect.Move(element,{x:0,y:100,sync:true}),new Effect.Opacity(element,{sync:true,to:0})],Object.extend({duration:0.5,beforeSetup:function(effect){effect.effects[0].element.makePositioned()},afterFinishInternal:function(effect){effect.effects[0].element.hide().undoPositioned().setStyle(oldStyle)}},arguments[1]||{}))};Effect.Shake=function(element){element=$(element);var options=Object.extend({distance:20,duration:0.5},arguments[1]||{});var distance=parseFloat(options.distance);var split=parseFloat(options.duration)/10;var oldStyle={top:element.getStyle("top"),left:element.getStyle("left")};return new Effect.Move(element,{x:distance,y:0,duration:split,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:-distance*2,y:0,duration:split*2,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:distance*2,y:0,duration:split*2,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:-distance*2,y:0,duration:split*2,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:distance*2,y:0,duration:split*2,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:-distance,y:0,duration:split,afterFinishInternal:function(effect){effect.element.undoPositioned().setStyle(oldStyle)}})}})}})}})}})}})};Effect.SlideDown=function(element){element=$(element).cleanWhitespace();var oldInnerBottom=element.down().getStyle("bottom");var elementDimensions=element.getDimensions();return new Effect.Scale(element,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:window.opera?0:1,scaleMode:{originalHeight:elementDimensions.height,originalWidth:elementDimensions.width},restoreAfterFinish:true,afterSetup:function(effect){effect.element.makePositioned();effect.element.down().makePositioned();if(window.opera){effect.element.setStyle({top:""})}effect.element.makeClipping().setStyle({height:"0px"}).show()},afterUpdateInternal:function(effect){effect.element.down().setStyle({bottom:(effect.dims[0]-effect.element.clientHeight)+"px"})},afterFinishInternal:function(effect){effect.element.undoClipping().undoPositioned();effect.element.down().undoPositioned().setStyle({bottom:oldInnerBottom})}},arguments[1]||{}))};Effect.SlideUp=function(element){element=$(element).cleanWhitespace();var oldInnerBottom=element.down().getStyle("bottom");var elementDimensions=element.getDimensions();return new Effect.Scale(element,window.opera?0:1,Object.extend({scaleContent:false,scaleX:false,scaleMode:"box",scaleFrom:100,scaleMode:{originalHeight:elementDimensions.height,originalWidth:elementDimensions.width},restoreAfterFinish:true,afterSetup:function(effect){effect.element.makePositioned();effect.element.down().makePositioned();if(window.opera){effect.element.setStyle({top:""})}effect.element.makeClipping().show()},afterUpdateInternal:function(effect){effect.element.down().setStyle({bottom:(effect.dims[0]-effect.element.clientHeight)+"px"})},afterFinishInternal:function(effect){effect.element.hide().undoClipping().undoPositioned();effect.element.down().undoPositioned().setStyle({bottom:oldInnerBottom})}},arguments[1]||{}))};Effect.Squish=function(element){return new Effect.Scale(element,window.opera?1:0,{restoreAfterFinish:true,beforeSetup:function(effect){effect.element.makeClipping()},afterFinishInternal:function(effect){effect.element.hide().undoClipping()}})};Effect.Grow=function(element){element=$(element);var options=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.full},arguments[1]||{});var oldStyle={top:element.style.top,left:element.style.left,height:element.style.height,width:element.style.width,opacity:element.getInlineOpacity()};var dims=element.getDimensions();var initialMoveX,initialMoveY;var moveX,moveY;switch(options.direction){case"top-left":initialMoveX=initialMoveY=moveX=moveY=0;break;case"top-right":initialMoveX=dims.width;initialMoveY=moveY=0;moveX=-dims.width;break;case"bottom-left":initialMoveX=moveX=0;initialMoveY=dims.height;moveY=-dims.height;break;case"bottom-right":initialMoveX=dims.width;initialMoveY=dims.height;moveX=-dims.width;moveY=-dims.height;break;case"center":initialMoveX=dims.width/2;initialMoveY=dims.height/2;moveX=-dims.width/2;moveY=-dims.height/2;break}return new Effect.Move(element,{x:initialMoveX,y:initialMoveY,duration:0.01,beforeSetup:function(effect){effect.element.hide().makeClipping().makePositioned()},afterFinishInternal:function(effect){new Effect.Parallel([new Effect.Opacity(effect.element,{sync:true,to:1,from:0,transition:options.opacityTransition}),new Effect.Move(effect.element,{x:moveX,y:moveY,sync:true,transition:options.moveTransition}),new Effect.Scale(effect.element,100,{scaleMode:{originalHeight:dims.height,originalWidth:dims.width},sync:true,scaleFrom:window.opera?1:0,transition:options.scaleTransition,restoreAfterFinish:true})],Object.extend({beforeSetup:function(effect){effect.effects[0].element.setStyle({height:"0px"}).show()},afterFinishInternal:function(effect){effect.effects[0].element.undoClipping().undoPositioned().setStyle(oldStyle)}},options))}})};Effect.Shrink=function(element){element=$(element);var options=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.none},arguments[1]||{});var oldStyle={top:element.style.top,left:element.style.left,height:element.style.height,width:element.style.width,opacity:element.getInlineOpacity()};var dims=element.getDimensions();var moveX,moveY;switch(options.direction){case"top-left":moveX=moveY=0;break;case"top-right":moveX=dims.width;moveY=0;break;case"bottom-left":moveX=0;moveY=dims.height;break;case"bottom-right":moveX=dims.width;moveY=dims.height;break;case"center":moveX=dims.width/2;moveY=dims.height/2;break}return new Effect.Parallel([new Effect.Opacity(element,{sync:true,to:0,from:1,transition:options.opacityTransition}),new Effect.Scale(element,window.opera?1:0,{sync:true,transition:options.scaleTransition,restoreAfterFinish:true}),new Effect.Move(element,{x:moveX,y:moveY,sync:true,transition:options.moveTransition})],Object.extend({beforeStartInternal:function(effect){effect.effects[0].element.makePositioned().makeClipping()},afterFinishInternal:function(effect){effect.effects[0].element.hide().undoClipping().undoPositioned().setStyle(oldStyle)}},options))};Effect.Pulsate=function(element){element=$(element);var options=arguments[1]||{},oldOpacity=element.getInlineOpacity(),transition=options.transition||Effect.Transitions.linear,reverser=function(pos){return 1-transition((-Math.cos((pos*(options.pulses||5)*2)*Math.PI)/2)+0.5)};return new Effect.Opacity(element,Object.extend(Object.extend({duration:2,from:0,afterFinishInternal:function(effect){effect.element.setStyle({opacity:oldOpacity})}},options),{transition:reverser}))};Effect.Fold=function(element){element=$(element);var oldStyle={top:element.style.top,left:element.style.left,width:element.style.width,height:element.style.height};element.makeClipping();return new Effect.Scale(element,5,Object.extend({scaleContent:false,scaleX:false,afterFinishInternal:function(effect){new Effect.Scale(element,1,{scaleContent:false,scaleY:false,afterFinishInternal:function(effect){effect.element.hide().undoClipping().setStyle(oldStyle)}})}},arguments[1]||{}))};Effect.Morph=Class.create(Effect.Base,{initialize:function(element){this.element=$(element);if(!this.element){throw (Effect._elementDoesNotExistError)}var options=Object.extend({style:{}},arguments[1]||{});if(!Object.isString(options.style)){this.style=$H(options.style)}else{if(options.style.include(":")){this.style=options.style.parseStyle()}else{this.element.addClassName(options.style);this.style=$H(this.element.getStyles());this.element.removeClassName(options.style);var css=this.element.getStyles();this.style=this.style.reject(function(style){return style.value==css[style.key]});options.afterFinishInternal=function(effect){effect.element.addClassName(effect.options.style);effect.transforms.each(function(transform){effect.element.style[transform.style]=""})}}}this.start(options)},setup:function(){function parseColor(color){if(!color||["rgba(0, 0, 0, 0)","transparent"].include(color)){color="#ffffff"}color=color.parseColor();return $R(0,2).map(function(i){return parseInt(color.slice(i*2+1,i*2+3),16)})}this.transforms=this.style.map(function(pair){var property=pair[0],value=pair[1],unit=null;if(value.parseColor("#zzzzzz")!="#zzzzzz"){value=value.parseColor();unit="color"}else{if(property=="opacity"){value=parseFloat(value);if(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout)){this.element.setStyle({zoom:1})}}else{if(Element.CSS_LENGTH.test(value)){var components=value.match(/^([\+\-]?[0-9\.]+)(.*)$/);value=parseFloat(components[1]);unit=(components.length==3)?components[2]:null}}}var originalValue=this.element.getStyle(property);return{style:property.camelize(),originalValue:unit=="color"?parseColor(originalValue):parseFloat(originalValue||0),targetValue:unit=="color"?parseColor(value):value,unit:unit}}.bind(this)).reject(function(transform){return((transform.originalValue==transform.targetValue)||(transform.unit!="color"&&(isNaN(transform.originalValue)||isNaN(transform.targetValue))))})},update:function(position){var style={},transform,i=this.transforms.length;while(i--){style[(transform=this.transforms[i]).style]=transform.unit=="color"?"#"+(Math.round(transform.originalValue[0]+(transform.targetValue[0]-transform.originalValue[0])*position)).toColorPart()+(Math.round(transform.originalValue[1]+(transform.targetValue[1]-transform.originalValue[1])*position)).toColorPart()+(Math.round(transform.originalValue[2]+(transform.targetValue[2]-transform.originalValue[2])*position)).toColorPart():(transform.originalValue+(transform.targetValue-transform.originalValue)*position).toFixed(3)+(transform.unit===null?"":transform.unit)}this.element.setStyle(style,true)}});Effect.Transform=Class.create({initialize:function(tracks){this.tracks=[];this.options=arguments[1]||{};this.addTracks(tracks)},addTracks:function(tracks){tracks.each(function(track){track=$H(track);var data=track.values().first();this.tracks.push($H({ids:track.keys().first(),effect:Effect.Morph,options:{style:data}}))}.bind(this));return this},play:function(){return new Effect.Parallel(this.tracks.map(function(track){var ids=track.get("ids"),effect=track.get("effect"),options=track.get("options");var elements=[$(ids)||$$(ids)].flatten();return elements.map(function(e){return new effect(e,Object.extend({sync:true},options))})}).flatten(),this.options)}});Element.CSS_PROPERTIES=$w("backgroundColor backgroundPosition borderBottomColor borderBottomStyle borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth borderRightColor borderRightStyle borderRightWidth borderSpacing borderTopColor borderTopStyle borderTopWidth bottom clip color fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop markerOffset maxHeight maxWidth minHeight minWidth opacity outlineColor outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex");Element.CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/;String.__parseStyleElement=document.createElement("div");String.prototype.parseStyle=function(){var style,styleRules=$H();if(Prototype.Browser.WebKit){style=new Element("div",{style:this}).style}else{String.__parseStyleElement.innerHTML='<div style="'+this+'"></div>';style=String.__parseStyleElement.childNodes[0].style}Element.CSS_PROPERTIES.each(function(property){if(style[property]){styleRules.set(property,style[property])}});if(Prototype.Browser.IE&&this.include("opacity")){styleRules.set("opacity",this.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1])}return styleRules};if(document.defaultView&&document.defaultView.getComputedStyle){Element.getStyles=function(element){var css=document.defaultView.getComputedStyle($(element),null);return Element.CSS_PROPERTIES.inject({},function(styles,property){styles[property]=css[property];return styles})}}else{Element.getStyles=function(element){element=$(element);var css=element.currentStyle,styles;styles=Element.CSS_PROPERTIES.inject({},function(results,property){results[property]=css[property];return results});if(!styles.opacity){styles.opacity=element.getOpacity()}return styles}}Effect.Methods={morph:function(element,style){element=$(element);new Effect.Morph(element,Object.extend({style:style},arguments[2]||{}));return element},visualEffect:function(element,effect,options){element=$(element);var s=effect.dasherize().camelize(),klass=s.charAt(0).toUpperCase()+s.substring(1);new Effect[klass](element,options);return element},highlight:function(element,options){element=$(element);new Effect.Highlight(element,options);return element}};$w("fade appear grow shrink fold blindUp blindDown slideUp slideDown pulsate shake puff squish switchOff dropOut").each(function(effect){Effect.Methods[effect]=function(element,options){element=$(element);Effect[effect.charAt(0).toUpperCase()+effect.substring(1)](element,options);return element}});$w("getInlineOpacity forceRerendering setContentZoom collectTextNodes collectTextNodesIgnoreClass getStyles").each(function(f){Effect.Methods[f]=Element[f]});Element.addMethods(Effect.Methods);if(Object.isUndefined(Effect)){throw ("dragdrop.js requires including script.aculo.us' effects.js library")}var Droppables={drops:[],remove:function(element){this.drops=this.drops.reject(function(d){return d.element==$(element)})},add:function(element){element=$(element);var options=Object.extend({greedy:true,hoverclass:null,tree:false},arguments[1]||{});if(options.containment){options._containers=[];var containment=options.containment;if(Object.isArray(containment)){containment.each(function(c){options._containers.push($(c))})}else{options._containers.push($(containment))}}if(options.accept){options.accept=[options.accept].flatten()}Element.makePositioned(element);options.element=element;this.drops.push(options)},findDeepestChild:function(drops){deepest=drops[0];for(i=1;i<drops.length;++i){if(Element.isParent(drops[i].element,deepest.element)){deepest=drops[i]}}return deepest},isContained:function(element,drop){var containmentNode;if(drop.tree){containmentNode=element.treeNode}else{containmentNode=element.parentNode}return drop._containers.detect(function(c){return containmentNode==c})},isAffected:function(point,element,drop){return((drop.element!=element)&&((!drop._containers)||this.isContained(element,drop))&&((!drop.accept)||(Element.classNames(element).detect(function(v){return drop.accept.include(v)})))&&Position.within(drop.element,point[0],point[1]))},deactivate:function(drop){if(drop.hoverclass){Element.removeClassName(drop.element,drop.hoverclass)}this.last_active=null},activate:function(drop){if(drop.hoverclass){Element.addClassName(drop.element,drop.hoverclass)}this.last_active=drop},show:function(point,element){if(!this.drops.length){return}var drop,affected=[];this.drops.each(function(drop){if(Droppables.isAffected(point,element,drop)){affected.push(drop)}});if(affected.length>0){drop=Droppables.findDeepestChild(affected)}if(this.last_active&&this.last_active!=drop){this.deactivate(this.last_active)}if(drop){Position.within(drop.element,point[0],point[1]);if(drop.onHover){drop.onHover(element,drop.element,Position.overlap(drop.overlap,drop.element))}if(drop!=this.last_active){Droppables.activate(drop)}}},fire:function(event,element){if(!this.last_active){return}Position.prepare();if(this.isAffected([Event.pointerX(event),Event.pointerY(event)],element,this.last_active)){if(this.last_active.onDrop){this.last_active.onDrop(element,this.last_active.element,event);return true}}},reset:function(){if(this.last_active){this.deactivate(this.last_active)}}};var Draggables={drags:[],observers:[],register:function(draggable){if(this.drags.length==0){this.eventMouseUp=this.endDrag.bindAsEventListener(this);this.eventMouseMove=this.updateDrag.bindAsEventListener(this);this.eventKeypress=this.keyPress.bindAsEventListener(this);Event.observe(document,"mouseup",this.eventMouseUp);Event.observe(document,"mousemove",this.eventMouseMove);Event.observe(document,"keypress",this.eventKeypress)}this.drags.push(draggable)},unregister:function(draggable){this.drags=this.drags.reject(function(d){return d==draggable});if(this.drags.length==0){Event.stopObserving(document,"mouseup",this.eventMouseUp);Event.stopObserving(document,"mousemove",this.eventMouseMove);Event.stopObserving(document,"keypress",this.eventKeypress)}},activate:function(draggable){if(draggable.options.delay){this._timeout=setTimeout(function(){Draggables._timeout=null;window.focus();Draggables.activeDraggable=draggable}.bind(this),draggable.options.delay)}else{window.focus();this.activeDraggable=draggable}},deactivate:function(){this.activeDraggable=null},updateDrag:function(event){if(!this.activeDraggable){return}var pointer=[Event.pointerX(event),Event.pointerY(event)];if(this._lastPointer&&(this._lastPointer.inspect()==pointer.inspect())){return}this._lastPointer=pointer;this.activeDraggable.updateDrag(event,pointer)},endDrag:function(event){if(this._timeout){clearTimeout(this._timeout);this._timeout=null}if(!this.activeDraggable){return}this._lastPointer=null;this.activeDraggable.endDrag(event);this.activeDraggable=null},keyPress:function(event){if(this.activeDraggable){this.activeDraggable.keyPress(event)}},addObserver:function(observer){this.observers.push(observer);this._cacheObserverCallbacks()},removeObserver:function(element){this.observers=this.observers.reject(function(o){return o.element==element});this._cacheObserverCallbacks()},notify:function(eventName,draggable,event){if(this[eventName+"Count"]>0){this.observers.each(function(o){if(o[eventName]){o[eventName](eventName,draggable,event)}})}if(draggable.options[eventName]){draggable.options[eventName](draggable,event)}},_cacheObserverCallbacks:function(){["onStart","onEnd","onDrag"].each(function(eventName){Draggables[eventName+"Count"]=Draggables.observers.select(function(o){return o[eventName]}).length})}};var Draggable=Class.create({initialize:function(element){var defaults={handle:false,reverteffect:function(element,top_offset,left_offset){var dur=Math.sqrt(Math.abs(top_offset^2)+Math.abs(left_offset^2))*0.02;new Effect.Move(element,{x:-left_offset,y:-top_offset,duration:dur,queue:{scope:"_draggable",position:"end"}})},endeffect:function(element){var toOpacity=Object.isNumber(element._opacity)?element._opacity:1;new Effect.Opacity(element,{duration:0.2,from:0.7,to:toOpacity,queue:{scope:"_draggable",position:"end"},afterFinish:function(){Draggable._dragging[element]=false}})},zindex:1000,revert:false,quiet:false,scroll:false,scrollSensitivity:20,scrollSpeed:15,snap:false,delay:0};if(!arguments[1]||Object.isUndefined(arguments[1].endeffect)){Object.extend(defaults,{starteffect:function(element){element._opacity=Element.getOpacity(element);Draggable._dragging[element]=true;new Effect.Opacity(element,{duration:0.2,from:element._opacity,to:0.7})}})}var options=Object.extend(defaults,arguments[1]||{});this.element=$(element);if(options.handle&&Object.isString(options.handle)){this.handle=this.element.down("."+options.handle,0)}if(!this.handle){this.handle=$(options.handle)}if(!this.handle){this.handle=this.element}if(options.scroll&&!options.scroll.scrollTo&&!options.scroll.outerHTML){options.scroll=$(options.scroll);this._isScrollChild=Element.childOf(this.element,options.scroll)}Element.makePositioned(this.element);this.options=options;this.dragging=false;this.eventMouseDown=this.initDrag.bindAsEventListener(this);Event.observe(this.handle,"mousedown",this.eventMouseDown);Draggables.register(this)},destroy:function(){Event.stopObserving(this.handle,"mousedown",this.eventMouseDown);Draggables.unregister(this)},currentDelta:function(){return([parseInt(Element.getStyle(this.element,"left")||"0"),parseInt(Element.getStyle(this.element,"top")||"0")])},initDrag:function(event){if(!Object.isUndefined(Draggable._dragging[this.element])&&Draggable._dragging[this.element]){return}if(Event.isLeftClick(event)){var src=Event.element(event);if((tag_name=src.tagName.toUpperCase())&&(tag_name=="INPUT"||tag_name=="SELECT"||tag_name=="OPTION"||tag_name=="BUTTON"||tag_name=="TEXTAREA")){return}var pointer=[Event.pointerX(event),Event.pointerY(event)];var pos=Position.cumulativeOffset(this.element);this.offset=[0,1].map(function(i){return(pointer[i]-pos[i])});Draggables.activate(this);Event.stop(event)}},startDrag:function(event){this.dragging=true;if(!this.delta){this.delta=this.currentDelta()}if(this.options.zindex){this.originalZ=parseInt(Element.getStyle(this.element,"z-index")||0);this.element.style.zIndex=this.options.zindex}if(this.options.ghosting){this._clone=this.element.cloneNode(true);this._originallyAbsolute=(this.element.getStyle("position")=="absolute");if(!this._originallyAbsolute){Position.absolutize(this.element)}this.element.parentNode.insertBefore(this._clone,this.element)}if(this.options.scroll){if(this.options.scroll==window){var where=this._getWindowScroll(this.options.scroll);this.originalScrollLeft=where.left;this.originalScrollTop=where.top}else{this.originalScrollLeft=this.options.scroll.scrollLeft;this.originalScrollTop=this.options.scroll.scrollTop}}Draggables.notify("onStart",this,event);if(this.options.starteffect){this.options.starteffect(this.element)}},updateDrag:function(event,pointer){if(!this.dragging){this.startDrag(event)}if(!this.options.quiet){Position.prepare();Droppables.show(pointer,this.element)}Draggables.notify("onDrag",this,event);this.draw(pointer);if(this.options.change){this.options.change(this)}if(this.options.scroll){this.stopScrolling();var p;if(this.options.scroll==window){with(this._getWindowScroll(this.options.scroll)){p=[left,top,left+width,top+height]}}else{p=Position.page(this.options.scroll);p[0]+=this.options.scroll.scrollLeft+Position.deltaX;p[1]+=this.options.scroll.scrollTop+Position.deltaY;p.push(p[0]+this.options.scroll.offsetWidth);p.push(p[1]+this.options.scroll.offsetHeight)}var speed=[0,0];if(pointer[0]<(p[0]+this.options.scrollSensitivity)){speed[0]=pointer[0]-(p[0]+this.options.scrollSensitivity)}if(pointer[1]<(p[1]+this.options.scrollSensitivity)){speed[1]=pointer[1]-(p[1]+this.options.scrollSensitivity)}if(pointer[0]>(p[2]-this.options.scrollSensitivity)){speed[0]=pointer[0]-(p[2]-this.options.scrollSensitivity)}if(pointer[1]>(p[3]-this.options.scrollSensitivity)){speed[1]=pointer[1]-(p[3]-this.options.scrollSensitivity)}this.startScrolling(speed)}if(Prototype.Browser.WebKit){window.scrollBy(0,0)}Event.stop(event)},finishDrag:function(event,success){this.dragging=false;if(this.options.quiet){Position.prepare();var pointer=[Event.pointerX(event),Event.pointerY(event)];Droppables.show(pointer,this.element)}if(this.options.ghosting){if(!this._originallyAbsolute){Position.relativize(this.element)}delete this._originallyAbsolute;Element.remove(this._clone);this._clone=null}var dropped=false;if(success){dropped=Droppables.fire(event,this.element);if(!dropped){dropped=false}}if(dropped&&this.options.onDropped){this.options.onDropped(this.element)}Draggables.notify("onEnd",this,event);var revert=this.options.revert;if(revert&&Object.isFunction(revert)){revert=revert(this.element)}var d=this.currentDelta();if(revert&&this.options.reverteffect){if(dropped==0||revert!="failure"){this.options.reverteffect(this.element,d[1]-this.delta[1],d[0]-this.delta[0])}}else{this.delta=d}if(this.options.zindex){this.element.style.zIndex=this.originalZ}if(this.options.endeffect){this.options.endeffect(this.element)}Draggables.deactivate(this);Droppables.reset()},keyPress:function(event){if(event.keyCode!=Event.KEY_ESC){return}this.finishDrag(event,false);Event.stop(event)},endDrag:function(event){if(!this.dragging){return}this.stopScrolling();this.finishDrag(event,true);Event.stop(event)},draw:function(point){var pos=Position.cumulativeOffset(this.element);if(this.options.ghosting){var r=Position.realOffset(this.element);pos[0]+=r[0]-Position.deltaX;pos[1]+=r[1]-Position.deltaY}var d=this.currentDelta();pos[0]-=d[0];pos[1]-=d[1];if(this.options.scroll&&(this.options.scroll!=window&&this._isScrollChild)){pos[0]-=this.options.scroll.scrollLeft-this.originalScrollLeft;pos[1]-=this.options.scroll.scrollTop-this.originalScrollTop}var p=[0,1].map(function(i){return(point[i]-pos[i]-this.offset[i])}.bind(this));if(this.options.snap){if(Object.isFunction(this.options.snap)){p=this.options.snap(p[0],p[1],this)}else{if(Object.isArray(this.options.snap)){p=p.map(function(v,i){return(v/this.options.snap[i]).round()*this.options.snap[i]}.bind(this))}else{p=p.map(function(v){return(v/this.options.snap).round()*this.options.snap}.bind(this))}}}var style=this.element.style;if((!this.options.constraint)||(this.options.constraint=="horizontal")){style.left=p[0]+"px"}if((!this.options.constraint)||(this.options.constraint=="vertical")){style.top=p[1]+"px"}if(style.visibility=="hidden"){style.visibility=""}},stopScrolling:function(){if(this.scrollInterval){clearInterval(this.scrollInterval);this.scrollInterval=null;Draggables._lastScrollPointer=null}},startScrolling:function(speed){if(!(speed[0]||speed[1])){return}this.scrollSpeed=[speed[0]*this.options.scrollSpeed,speed[1]*this.options.scrollSpeed];this.lastScrolled=new Date();this.scrollInterval=setInterval(this.scroll.bind(this),10)},scroll:function(){var current=new Date();var delta=current-this.lastScrolled;this.lastScrolled=current;if(this.options.scroll==window){with(this._getWindowScroll(this.options.scroll)){if(this.scrollSpeed[0]||this.scrollSpeed[1]){var d=delta/1000;this.options.scroll.scrollTo(left+d*this.scrollSpeed[0],top+d*this.scrollSpeed[1])}}}else{this.options.scroll.scrollLeft+=this.scrollSpeed[0]*delta/1000;this.options.scroll.scrollTop+=this.scrollSpeed[1]*delta/1000}Position.prepare();Droppables.show(Draggables._lastPointer,this.element);Draggables.notify("onDrag",this);if(this._isScrollChild){Draggables._lastScrollPointer=Draggables._lastScrollPointer||$A(Draggables._lastPointer);Draggables._lastScrollPointer[0]+=this.scrollSpeed[0]*delta/1000;Draggables._lastScrollPointer[1]+=this.scrollSpeed[1]*delta/1000;if(Draggables._lastScrollPointer[0]<0){Draggables._lastScrollPointer[0]=0}if(Draggables._lastScrollPointer[1]<0){Draggables._lastScrollPointer[1]=0}this.draw(Draggables._lastScrollPointer)}if(this.options.change){this.options.change(this)}},_getWindowScroll:function(w){var T,L,W,H;with(w.document){if(w.document.documentElement&&documentElement.scrollTop){T=documentElement.scrollTop;L=documentElement.scrollLeft}else{if(w.document.body){T=body.scrollTop;L=body.scrollLeft}}if(w.innerWidth){W=w.innerWidth;H=w.innerHeight}else{if(w.document.documentElement&&documentElement.clientWidth){W=documentElement.clientWidth;H=documentElement.clientHeight}else{W=body.offsetWidth;H=body.offsetHeight}}}return{top:T,left:L,width:W,height:H}}});Draggable._dragging={};var SortableObserver=Class.create({initialize:function(element,observer){this.element=$(element);this.observer=observer;this.lastValue=Sortable.serialize(this.element)},onStart:function(){this.lastValue=Sortable.serialize(this.element)},onEnd:function(){Sortable.unmark();if(this.lastValue!=Sortable.serialize(this.element)){this.observer(this.element)}}});var Sortable={SERIALIZE_RULE:/^[^_\-](?:[A-Za-z0-9\-\_]*)[_](.*)$/,sortables:{},_findRootElement:function(element){while(element.tagName.toUpperCase()!="BODY"){if(element.id&&Sortable.sortables[element.id]){return element}element=element.parentNode}},options:function(element){element=Sortable._findRootElement($(element));if(!element){return}return Sortable.sortables[element.id]},destroy:function(element){element=$(element);var s=Sortable.sortables[element.id];if(s){Draggables.removeObserver(s.element);s.droppables.each(function(d){Droppables.remove(d)});s.draggables.invoke("destroy");delete Sortable.sortables[s.element.id]}},create:function(element){element=$(element);var options=Object.extend({element:element,tag:"li",dropOnEmpty:false,tree:false,treeTag:"ul",overlap:"vertical",constraint:"vertical",containment:element,handle:false,only:false,delay:0,hoverclass:null,ghosting:false,quiet:false,scroll:false,scrollSensitivity:20,scrollSpeed:15,format:this.SERIALIZE_RULE,elements:false,handles:false,onChange:Prototype.emptyFunction,onUpdate:Prototype.emptyFunction},arguments[1]||{});this.destroy(element);var options_for_draggable={revert:true,quiet:options.quiet,scroll:options.scroll,scrollSpeed:options.scrollSpeed,scrollSensitivity:options.scrollSensitivity,delay:options.delay,ghosting:options.ghosting,constraint:options.constraint,handle:options.handle};if(options.starteffect){options_for_draggable.starteffect=options.starteffect}if(options.reverteffect){options_for_draggable.reverteffect=options.reverteffect}else{if(options.ghosting){options_for_draggable.reverteffect=function(element){element.style.top=0;element.style.left=0}}}if(options.endeffect){options_for_draggable.endeffect=options.endeffect}if(options.zindex){options_for_draggable.zindex=options.zindex}var options_for_droppable={overlap:options.overlap,containment:options.containment,tree:options.tree,hoverclass:options.hoverclass,onHover:Sortable.onHover};var options_for_tree={onHover:Sortable.onEmptyHover,overlap:options.overlap,containment:options.containment,hoverclass:options.hoverclass};Element.cleanWhitespace(element);options.draggables=[];options.droppables=[];if(options.dropOnEmpty||options.tree){Droppables.add(element,options_for_tree);options.droppables.push(element)}(options.elements||this.findElements(element,options)||[]).each(function(e,i){var handle=options.handles?$(options.handles[i]):(options.handle?$(e).select("."+options.handle)[0]:e);options.draggables.push(new Draggable(e,Object.extend(options_for_draggable,{handle:handle})));Droppables.add(e,options_for_droppable);if(options.tree){e.treeNode=element}options.droppables.push(e)});if(options.tree){(Sortable.findTreeElements(element,options)||[]).each(function(e){Droppables.add(e,options_for_tree);e.treeNode=element;options.droppables.push(e)})}this.sortables[element.id]=options;Draggables.addObserver(new SortableObserver(element,options.onUpdate))},findElements:function(element,options){return Element.findChildren(element,options.only,options.tree?true:false,options.tag)},findTreeElements:function(element,options){return Element.findChildren(element,options.only,options.tree?true:false,options.treeTag)},onHover:function(element,dropon,overlap){if(Element.isParent(dropon,element)){return}if(overlap>0.33&&overlap<0.66&&Sortable.options(dropon).tree){return}else{if(overlap>0.5){Sortable.mark(dropon,"before");if(dropon.previousSibling!=element){var oldParentNode=element.parentNode;element.style.visibility="hidden";dropon.parentNode.insertBefore(element,dropon);if(dropon.parentNode!=oldParentNode){Sortable.options(oldParentNode).onChange(element)}Sortable.options(dropon.parentNode).onChange(element)}}else{Sortable.mark(dropon,"after");var nextElement=dropon.nextSibling||null;if(nextElement!=element){var oldParentNode=element.parentNode;element.style.visibility="hidden";dropon.parentNode.insertBefore(element,nextElement);if(dropon.parentNode!=oldParentNode){Sortable.options(oldParentNode).onChange(element)}Sortable.options(dropon.parentNode).onChange(element)}}}},onEmptyHover:function(element,dropon,overlap){var oldParentNode=element.parentNode;var droponOptions=Sortable.options(dropon);if(!Element.isParent(dropon,element)){var index;var children=Sortable.findElements(dropon,{tag:droponOptions.tag,only:droponOptions.only});var child=null;if(children){var offset=Element.offsetSize(dropon,droponOptions.overlap)*(1-overlap);for(index=0;index<children.length;index+=1){if(offset-Element.offsetSize(children[index],droponOptions.overlap)>=0){offset-=Element.offsetSize(children[index],droponOptions.overlap)}else{if(offset-(Element.offsetSize(children[index],droponOptions.overlap)/2)>=0){child=index+1<children.length?children[index+1]:null;break}else{child=children[index];break}}}}dropon.insertBefore(element,child);Sortable.options(oldParentNode).onChange(element);droponOptions.onChange(element)}},unmark:function(){if(Sortable._marker){Sortable._marker.hide()}},mark:function(dropon,position){var sortable=Sortable.options(dropon.parentNode);if(sortable&&!sortable.ghosting){return}if(!Sortable._marker){Sortable._marker=($("dropmarker")||Element.extend(document.createElement("DIV"))).hide().addClassName("dropmarker").setStyle({position:"absolute"});document.getElementsByTagName("body").item(0).appendChild(Sortable._marker)}var offsets=Position.cumulativeOffset(dropon);Sortable._marker.setStyle({left:offsets[0]+"px",top:offsets[1]+"px"});if(position=="after"){if(sortable.overlap=="horizontal"){Sortable._marker.setStyle({left:(offsets[0]+dropon.clientWidth)+"px"})}else{Sortable._marker.setStyle({top:(offsets[1]+dropon.clientHeight)+"px"})}}Sortable._marker.show()},_tree:function(element,options,parent){var children=Sortable.findElements(element,options)||[];for(var i=0;i<children.length;++i){var match=children[i].id.match(options.format);if(!match){continue}var child={id:encodeURIComponent(match?match[1]:null),element:element,parent:parent,children:[],position:parent.children.length,container:$(children[i]).down(options.treeTag)};if(child.container){this._tree(child.container,options,child)}parent.children.push(child)}return parent},tree:function(element){element=$(element);var sortableOptions=this.options(element);var options=Object.extend({tag:sortableOptions.tag,treeTag:sortableOptions.treeTag,only:sortableOptions.only,name:element.id,format:sortableOptions.format},arguments[1]||{});var root={id:null,parent:null,children:[],container:element,position:0};return Sortable._tree(element,options,root)},_constructIndex:function(node){var index="";do{if(node.id){index="["+node.position+"]"+index}}while((node=node.parent)!=null);return index},sequence:function(element){element=$(element);var options=Object.extend(this.options(element),arguments[1]||{});return $(this.findElements(element,options)||[]).map(function(item){return item.id.match(options.format)?item.id.match(options.format)[1]:""})},setSequence:function(element,new_sequence){element=$(element);var options=Object.extend(this.options(element),arguments[2]||{});var nodeMap={};this.findElements(element,options).each(function(n){if(n.id.match(options.format)){nodeMap[n.id.match(options.format)[1]]=[n,n.parentNode]}n.parentNode.removeChild(n)});new_sequence.each(function(ident){var n=nodeMap[ident];if(n){n[1].appendChild(n[0]);delete nodeMap[ident]}})},serialize:function(element){element=$(element);var options=Object.extend(Sortable.options(element),arguments[1]||{});var name=encodeURIComponent((arguments[1]&&arguments[1].name)?arguments[1].name:element.id);if(options.tree){return Sortable.tree(element,arguments[1]).children.map(function(item){return[name+Sortable._constructIndex(item)+"[id]="+encodeURIComponent(item.id)].concat(item.children.map(arguments.callee))}).flatten().join("&")}else{return Sortable.sequence(element,arguments[1]).map(function(item){return name+"[]="+encodeURIComponent(item)}).join("&")}}};Element.isParent=function(child,element){if(!child.parentNode||child==element){return false}if(child.parentNode==element){return true}return Element.isParent(child.parentNode,element)};Element.findChildren=function(element,only,recursive,tagName){if(!element.hasChildNodes()){return null}tagName=tagName.toUpperCase();if(only){only=[only].flatten()}var elements=[];$A(element.childNodes).each(function(e){if(e.tagName&&e.tagName.toUpperCase()==tagName&&(!only||(Element.classNames(e).detect(function(v){return only.include(v)})))){elements.push(e)}if(recursive){var grandchildren=Element.findChildren(e,only,recursive,tagName);if(grandchildren){elements.push(grandchildren)}}});return(elements.length>0?elements.flatten():[])};Element.offsetSize=function(element,type){return element["offset"+((type=="vertical"||type=="height")?"Height":"Width")]};if(typeof Effect=="undefined"){throw ("controls.js requires including script.aculo.us' effects.js library")}var Autocompleter={};Autocompleter.Base=Class.create({baseInitialize:function(element,update,options){element=$(element);this.element=element;this.update=$(update);this.hasFocus=false;this.changed=false;this.active=false;this.index=0;this.entryCount=0;this.oldElementValue=this.element.value;if(this.setOptions){this.setOptions(options)}else{this.options=options||{}}this.options.paramName=this.options.paramName||this.element.name;this.options.tokens=this.options.tokens||[];this.options.frequency=this.options.frequency||0.4;this.options.minChars=this.options.minChars||1;this.options.onShow=this.options.onShow||function(element,update){if(!update.style.position||update.style.position=="absolute"){update.style.position="absolute";Position.clone(element,update,{setHeight:false,offsetTop:element.offsetHeight})}Effect.Appear(update,{duration:0.15})};this.options.onHide=this.options.onHide||function(element,update){new Effect.Fade(update,{duration:0.15})};if(typeof(this.options.tokens)=="string"){this.options.tokens=new Array(this.options.tokens)}if(!this.options.tokens.include("\n")){this.options.tokens.push("\n")}this.observer=null;this.element.setAttribute("autocomplete","off");Element.hide(this.update);Event.observe(this.element,"blur",this.onBlur.bindAsEventListener(this));Event.observe(this.element,"keydown",this.onKeyPress.bindAsEventListener(this))},show:function(){if(Element.getStyle(this.update,"display")=="none"){this.options.onShow(this.element,this.update)}if(!this.iefix&&(Prototype.Browser.IE)&&(Element.getStyle(this.update,"position")=="absolute")){new Insertion.After(this.update,'<iframe id="'+this.update.id+'_iefix" style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);" src="javascript:false;" frameborder="0" scrolling="no"></iframe>');this.iefix=$(this.update.id+"_iefix")}if(this.iefix){setTimeout(this.fixIEOverlapping.bind(this),50)}},fixIEOverlapping:function(){Position.clone(this.update,this.iefix,{setTop:(!this.update.style.height)});this.iefix.style.zIndex=1;this.update.style.zIndex=2;Element.show(this.iefix)},hide:function(){this.stopIndicator();if(Element.getStyle(this.update,"display")!="none"){this.options.onHide(this.element,this.update)}if(this.iefix){Element.hide(this.iefix)}},startIndicator:function(){if(this.options.indicator){Element.show(this.options.indicator)}},stopIndicator:function(){if(this.options.indicator){Element.hide(this.options.indicator)}},onKeyPress:function(event){if(this.active){switch(event.keyCode){case Event.KEY_TAB:case Event.KEY_RETURN:this.selectEntry();Event.stop(event);case Event.KEY_ESC:this.hide();this.active=false;Event.stop(event);return;case Event.KEY_LEFT:case Event.KEY_RIGHT:return;case Event.KEY_UP:this.markPrevious();this.render();Event.stop(event);return;case Event.KEY_DOWN:this.markNext();this.render();Event.stop(event);return}}else{if(event.keyCode==Event.KEY_TAB||event.keyCode==Event.KEY_RETURN||(Prototype.Browser.WebKit>0&&event.keyCode==0)){return}}this.changed=true;this.hasFocus=true;if(this.observer){clearTimeout(this.observer)}this.observer=setTimeout(this.onObserverEvent.bind(this),this.options.frequency*1000)},activate:function(){this.changed=false;this.hasFocus=true;this.getUpdatedChoices()},onHover:function(event){var element=Event.findElement(event,"LI");if(this.index!=element.autocompleteIndex){this.index=element.autocompleteIndex;this.render()}Event.stop(event)},onClick:function(event){var element=Event.findElement(event,"LI");this.index=element.autocompleteIndex;this.selectEntry();this.hide()},onBlur:function(event){setTimeout(this.hide.bind(this),250);this.hasFocus=false;this.active=false},render:function(){if(this.entryCount>0){for(var i=0;i<this.entryCount;i++){this.index==i?Element.addClassName(this.getEntry(i),"selected"):Element.removeClassName(this.getEntry(i),"selected")}if(this.hasFocus){this.show();this.active=true}}else{this.active=false;this.hide()}},markPrevious:function(){if(this.index>0){this.index--}else{this.index=this.entryCount-1;this.update.scrollTop=this.update.scrollHeight}var selection=this.getEntry(this.index),selection_top=selection.offsetTop;if(selection_top<this.update.scrollTop){this.update.scrollTop=this.update.scrollTop-selection.offsetHeight}},markNext:function(){if(this.index<this.entryCount-1){this.index++}else{this.index=0;this.update.scrollTop=0}var selection=this.getEntry(this.index),selection_bottom=selection.offsetTop+selection.offsetHeight;if(selection_bottom>this.update.scrollTop+this.update.offsetHeight){this.update.scrollTop=this.update.scrollTop+selection.offsetHeight}},getEntry:function(index){return this.update.firstChild.childNodes[index]},getCurrentEntry:function(){return this.getEntry(this.index)},selectEntry:function(){this.active=false;this.updateElement(this.getCurrentEntry())},updateElement:function(selectedElement){if(this.options.updateElement){this.options.updateElement(selectedElement);return}var value="";if(this.options.select){var nodes=$(selectedElement).select("."+this.options.select)||[];if(nodes.length>0){value=Element.collectTextNodes(nodes[0],this.options.select)}}else{value=Element.collectTextNodesIgnoreClass(selectedElement,"informal")}var bounds=this.getTokenBounds();if(bounds[0]!=-1){var newValue=this.element.value.substr(0,bounds[0]);var whitespace=this.element.value.substr(bounds[0]).match(/^\s+/);if(whitespace){newValue+=whitespace[0]}this.element.value=newValue+value+this.element.value.substr(bounds[1])}else{this.element.value=value}this.oldElementValue=this.element.value;this.element.focus();if(this.options.afterUpdateElement){this.options.afterUpdateElement(this.element,selectedElement)}},updateChoices:function(choices){if(!this.changed&&this.hasFocus){this.update.innerHTML=choices;Element.cleanWhitespace(this.update);Element.cleanWhitespace(this.update.down());if(this.update.firstChild&&this.update.down().childNodes){this.entryCount=this.update.down().childNodes.length;for(var i=0;i<this.entryCount;i++){var entry=this.getEntry(i);entry.autocompleteIndex=i;this.addObservers(entry)}}else{this.entryCount=0}this.stopIndicator();this.update.scrollTop=0;this.index=0;if(this.entryCount==1&&this.options.autoSelect){this.selectEntry();this.hide()}else{this.render()}}},addObservers:function(element){Event.observe(element,"mouseover",this.onHover.bindAsEventListener(this));Event.observe(element,"click",this.onClick.bindAsEventListener(this))},onObserverEvent:function(){this.changed=false;this.tokenBounds=null;if(this.getToken().length>=this.options.minChars){this.getUpdatedChoices()}else{this.active=false;this.hide()}this.oldElementValue=this.element.value},getToken:function(){var bounds=this.getTokenBounds();return this.element.value.substring(bounds[0],bounds[1]).strip()},getTokenBounds:function(){if(null!=this.tokenBounds){return this.tokenBounds}var value=this.element.value;if(value.strip().empty()){return[-1,0]}var diff=arguments.callee.getFirstDifferencePos(value,this.oldElementValue);var offset=(diff==this.oldElementValue.length?1:0);var prevTokenPos=-1,nextTokenPos=value.length;var tp;for(var index=0,l=this.options.tokens.length;index<l;++index){tp=value.lastIndexOf(this.options.tokens[index],diff+offset-1);if(tp>prevTokenPos){prevTokenPos=tp}tp=value.indexOf(this.options.tokens[index],diff+offset);if(-1!=tp&&tp<nextTokenPos){nextTokenPos=tp}}return(this.tokenBounds=[prevTokenPos+1,nextTokenPos])}});Autocompleter.Base.prototype.getTokenBounds.getFirstDifferencePos=function(newS,oldS){var boundary=Math.min(newS.length,oldS.length);for(var index=0;index<boundary;++index){if(newS[index]!=oldS[index]){return index}}return boundary};Ajax.Autocompleter=Class.create(Autocompleter.Base,{initialize:function(element,update,url,options){this.baseInitialize(element,update,options);this.options.asynchronous=true;this.options.onComplete=this.onComplete.bind(this);this.options.defaultParams=this.options.parameters||null;this.url=url},getUpdatedChoices:function(){this.startIndicator();var entry=encodeURIComponent(this.options.paramName)+"="+encodeURIComponent(this.getToken());this.options.parameters=this.options.callback?this.options.callback(this.element,entry):entry;if(this.options.defaultParams){this.options.parameters+="&"+this.options.defaultParams}new Ajax.Request(this.url,this.options)},onComplete:function(request){this.updateChoices(request.responseText)}});Autocompleter.Local=Class.create(Autocompleter.Base,{initialize:function(element,update,array,options){this.baseInitialize(element,update,options);this.options.array=array},getUpdatedChoices:function(){this.updateChoices(this.options.selector(this))},setOptions:function(options){this.options=Object.extend({choices:10,partialSearch:true,partialChars:2,ignoreCase:true,fullSearch:false,selector:function(instance){var ret=[];var partial=[];var entry=instance.getToken();var count=0;for(var i=0;i<instance.options.array.length&&ret.length<instance.options.choices;i++){var elem=instance.options.array[i];var foundPos=instance.options.ignoreCase?elem.toLowerCase().indexOf(entry.toLowerCase()):elem.indexOf(entry);while(foundPos!=-1){if(foundPos==0&&elem.length!=entry.length){ret.push("<li><strong>"+elem.substr(0,entry.length)+"</strong>"+elem.substr(entry.length)+"</li>");break}else{if(entry.length>=instance.options.partialChars&&instance.options.partialSearch&&foundPos!=-1){if(instance.options.fullSearch||/\s/.test(elem.substr(foundPos-1,1))){partial.push("<li>"+elem.substr(0,foundPos)+"<strong>"+elem.substr(foundPos,entry.length)+"</strong>"+elem.substr(foundPos+entry.length)+"</li>");break}}}foundPos=instance.options.ignoreCase?elem.toLowerCase().indexOf(entry.toLowerCase(),foundPos+1):elem.indexOf(entry,foundPos+1)}}if(partial.length){ret=ret.concat(partial.slice(0,instance.options.choices-ret.length))}return"<ul>"+ret.join("")+"</ul>"}},options||{})}});Field.scrollFreeActivate=function(field){setTimeout(function(){Field.activate(field)},1)};Ajax.InPlaceEditor=Class.create({initialize:function(element,url,options){this.url=url;this.element=element=$(element);this.prepareOptions();this._controls={};arguments.callee.dealWithDeprecatedOptions(options);Object.extend(this.options,options||{});if(!this.options.formId&&this.element.id){this.options.formId=this.element.id+"-inplaceeditor";if($(this.options.formId)){this.options.formId=""}}if(this.options.externalControl){this.options.externalControl=$(this.options.externalControl)}if(!this.options.externalControl){this.options.externalControlOnly=false}this._originalBackground=this.element.getStyle("background-color")||"transparent";this.element.title=this.options.clickToEditText;this._boundCancelHandler=this.handleFormCancellation.bind(this);this._boundComplete=(this.options.onComplete||Prototype.emptyFunction).bind(this);this._boundFailureHandler=this.handleAJAXFailure.bind(this);this._boundSubmitHandler=this.handleFormSubmission.bind(this);this._boundWrapperHandler=this.wrapUp.bind(this);this.registerListeners()},checkForEscapeOrReturn:function(e){if(!this._editing||e.ctrlKey||e.altKey||e.shiftKey){return}if(Event.KEY_ESC==e.keyCode){this.handleFormCancellation(e)}else{if(Event.KEY_RETURN==e.keyCode){this.handleFormSubmission(e)}}},createControl:function(mode,handler,extraClasses){var control=this.options[mode+"Control"];var text=this.options[mode+"Text"];if("button"==control){var btn=document.createElement("input");btn.type="submit";btn.value=text;btn.className="editor_"+mode+"_button";if("cancel"==mode){btn.onclick=this._boundCancelHandler}this._form.appendChild(btn);this._controls[mode]=btn}else{if("link"==control){var link=document.createElement("a");link.href="#";link.appendChild(document.createTextNode(text));link.onclick="cancel"==mode?this._boundCancelHandler:this._boundSubmitHandler;link.className="editor_"+mode+"_link";if(extraClasses){link.className+=" "+extraClasses}this._form.appendChild(link);this._controls[mode]=link}}},createEditField:function(){var text=(this.options.loadTextURL?this.options.loadingText:this.getText());var fld;if(1>=this.options.rows&&!/\r|\n/.test(this.getText())){fld=document.createElement("input");fld.type="text";var size=this.options.size||this.options.cols||0;if(0<size){fld.size=size}}else{fld=document.createElement("textarea");fld.rows=(1>=this.options.rows?this.options.autoRows:this.options.rows);fld.cols=this.options.cols||40}fld.name=this.options.paramName;fld.value=text;fld.className="editor_field";if(this.options.submitOnBlur){fld.onblur=this._boundSubmitHandler}this._controls.editor=fld;if(this.options.loadTextURL){this.loadExternalText()}this._form.appendChild(this._controls.editor)},createForm:function(){var ipe=this;function addText(mode,condition){var text=ipe.options["text"+mode+"Controls"];if(!text||condition===false){return}ipe._form.appendChild(document.createTextNode(text))}this._form=$(document.createElement("form"));this._form.id=this.options.formId;this._form.addClassName(this.options.formClassName);this._form.onsubmit=this._boundSubmitHandler;this.createEditField();if("textarea"==this._controls.editor.tagName.toLowerCase()){this._form.appendChild(document.createElement("br"))}if(this.options.onFormCustomization){this.options.onFormCustomization(this,this._form)}addText("Before",this.options.okControl||this.options.cancelControl);this.createControl("ok",this._boundSubmitHandler);addText("Between",this.options.okControl&&this.options.cancelControl);this.createControl("cancel",this._boundCancelHandler,"editor_cancel");addText("After",this.options.okControl||this.options.cancelControl)},destroy:function(){if(this._oldInnerHTML){this.element.innerHTML=this._oldInnerHTML}this.leaveEditMode();this.unregisterListeners()},enterEditMode:function(e){if(this._saving||this._editing){return}this._editing=true;this.triggerCallback("onEnterEditMode");if(this.options.externalControl){this.options.externalControl.hide()}this.element.hide();this.createForm();this.element.parentNode.insertBefore(this._form,this.element);if(!this.options.loadTextURL){this.postProcessEditField()}if(e){Event.stop(e)}},enterHover:function(e){if(this.options.hoverClassName){this.element.addClassName(this.options.hoverClassName)}if(this._saving){return}this.triggerCallback("onEnterHover")},getText:function(){return this.element.innerHTML.unescapeHTML()},handleAJAXFailure:function(transport){this.triggerCallback("onFailure",transport);if(this._oldInnerHTML){this.element.innerHTML=this._oldInnerHTML;this._oldInnerHTML=null}},handleFormCancellation:function(e){this.wrapUp();if(e){Event.stop(e)}},handleFormSubmission:function(e){var form=this._form;var value=$F(this._controls.editor);this.prepareSubmission();var params=this.options.callback(form,value)||"";if(Object.isString(params)){params=params.toQueryParams()}params.editorId=this.element.id;if(this.options.htmlResponse){var options=Object.extend({evalScripts:true},this.options.ajaxOptions);Object.extend(options,{parameters:params,onComplete:this._boundWrapperHandler,onFailure:this._boundFailureHandler});new Ajax.Updater({success:this.element},this.url,options)}else{var options=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(options,{parameters:params,onComplete:this._boundWrapperHandler,onFailure:this._boundFailureHandler});new Ajax.Request(this.url,options)}if(e){Event.stop(e)}},leaveEditMode:function(){this.element.removeClassName(this.options.savingClassName);this.removeForm();this.leaveHover();this.element.style.backgroundColor=this._originalBackground;this.element.show();if(this.options.externalControl){this.options.externalControl.show()}this._saving=false;this._editing=false;this._oldInnerHTML=null;this.triggerCallback("onLeaveEditMode")},leaveHover:function(e){if(this.options.hoverClassName){this.element.removeClassName(this.options.hoverClassName)}if(this._saving){return}this.triggerCallback("onLeaveHover")},loadExternalText:function(){this._form.addClassName(this.options.loadingClassName);this._controls.editor.disabled=true;var options=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(options,{parameters:"editorId="+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(transport){this._form.removeClassName(this.options.loadingClassName);var text=transport.responseText;if(this.options.stripLoadedTextTags){text=text.stripTags()}this._controls.editor.value=text;this._controls.editor.disabled=false;this.postProcessEditField()}.bind(this),onFailure:this._boundFailureHandler});new Ajax.Request(this.options.loadTextURL,options)},postProcessEditField:function(){var fpc=this.options.fieldPostCreation;if(fpc){$(this._controls.editor)["focus"==fpc?"focus":"activate"]()}},prepareOptions:function(){this.options=Object.clone(Ajax.InPlaceEditor.DefaultOptions);Object.extend(this.options,Ajax.InPlaceEditor.DefaultCallbacks);[this._extraDefaultOptions].flatten().compact().each(function(defs){Object.extend(this.options,defs)}.bind(this))},prepareSubmission:function(){this._saving=true;this.removeForm();this.leaveHover();this.showSaving()},registerListeners:function(){this._listeners={};var listener;$H(Ajax.InPlaceEditor.Listeners).each(function(pair){listener=this[pair.value].bind(this);this._listeners[pair.key]=listener;if(!this.options.externalControlOnly){this.element.observe(pair.key,listener)}if(this.options.externalControl){this.options.externalControl.observe(pair.key,listener)}}.bind(this))},removeForm:function(){if(!this._form){return}this._form.remove();this._form=null;this._controls={}},showSaving:function(){this._oldInnerHTML=this.element.innerHTML;this.element.innerHTML=this.options.savingText;this.element.addClassName(this.options.savingClassName);this.element.style.backgroundColor=this._originalBackground;this.element.show()},triggerCallback:function(cbName,arg){if("function"==typeof this.options[cbName]){this.options[cbName](this,arg)}},unregisterListeners:function(){$H(this._listeners).each(function(pair){if(!this.options.externalControlOnly){this.element.stopObserving(pair.key,pair.value)}if(this.options.externalControl){this.options.externalControl.stopObserving(pair.key,pair.value)}}.bind(this))},wrapUp:function(transport){this.leaveEditMode();this._boundComplete(transport,this.element)}});Object.extend(Ajax.InPlaceEditor.prototype,{dispose:Ajax.InPlaceEditor.prototype.destroy});Ajax.InPlaceCollectionEditor=Class.create(Ajax.InPlaceEditor,{initialize:function($super,element,url,options){this._extraDefaultOptions=Ajax.InPlaceCollectionEditor.DefaultOptions;$super(element,url,options)},createEditField:function(){var list=document.createElement("select");list.name=this.options.paramName;list.size=1;this._controls.editor=list;this._collection=this.options.collection||[];if(this.options.loadCollectionURL){this.loadCollection()}else{this.checkForExternalText()}this._form.appendChild(this._controls.editor)},loadCollection:function(){this._form.addClassName(this.options.loadingClassName);this.showLoadingText(this.options.loadingCollectionText);var options=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(options,{parameters:"editorId="+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(transport){var js=transport.responseText.strip();if(!/^\[.*\]$/.test(js)){throw ("Server returned an invalid collection representation.")}this._collection=eval(js);this.checkForExternalText()}.bind(this),onFailure:this.onFailure});new Ajax.Request(this.options.loadCollectionURL,options)},showLoadingText:function(text){this._controls.editor.disabled=true;var tempOption=this._controls.editor.firstChild;if(!tempOption){tempOption=document.createElement("option");tempOption.value="";this._controls.editor.appendChild(tempOption);tempOption.selected=true}tempOption.update((text||"").stripScripts().stripTags())},checkForExternalText:function(){this._text=this.getText();if(this.options.loadTextURL){this.loadExternalText()}else{this.buildOptionList()}},loadExternalText:function(){this.showLoadingText(this.options.loadingText);var options=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(options,{parameters:"editorId="+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(transport){this._text=transport.responseText.strip();this.buildOptionList()}.bind(this),onFailure:this.onFailure});new Ajax.Request(this.options.loadTextURL,options)},buildOptionList:function(){this._form.removeClassName(this.options.loadingClassName);this._collection=this._collection.map(function(entry){return 2===entry.length?entry:[entry,entry].flatten()});var marker=("value" in this.options)?this.options.value:this._text;var textFound=this._collection.any(function(entry){return entry[0]==marker}.bind(this));this._controls.editor.update("");var option;this._collection.each(function(entry,index){option=document.createElement("option");option.value=entry[0];option.selected=textFound?entry[0]==marker:0==index;option.appendChild(document.createTextNode(entry[1]));this._controls.editor.appendChild(option)}.bind(this));this._controls.editor.disabled=false;Field.scrollFreeActivate(this._controls.editor)}});Ajax.InPlaceEditor.prototype.initialize.dealWithDeprecatedOptions=function(options){if(!options){return}function fallback(name,expr){if(name in options||expr===undefined){return}options[name]=expr}fallback("cancelControl",(options.cancelLink?"link":(options.cancelButton?"button":options.cancelLink==options.cancelButton==false?false:undefined)));fallback("okControl",(options.okLink?"link":(options.okButton?"button":options.okLink==options.okButton==false?false:undefined)));fallback("highlightColor",options.highlightcolor);fallback("highlightEndColor",options.highlightendcolor)};Object.extend(Ajax.InPlaceEditor,{DefaultOptions:{ajaxOptions:{},autoRows:3,cancelControl:"link",cancelText:"cancel",clickToEditText:"Click to edit",externalControl:null,externalControlOnly:false,fieldPostCreation:"activate",formClassName:"inplaceeditor-form",formId:null,highlightColor:"#ffff99",highlightEndColor:"#ffffff",hoverClassName:"",htmlResponse:true,loadingClassName:"inplaceeditor-loading",loadingText:"Loading...",okControl:"button",okText:"ok",paramName:"value",rows:1,savingClassName:"inplaceeditor-saving",savingText:"Saving...",size:0,stripLoadedTextTags:false,submitOnBlur:false,textAfterControls:"",textBeforeControls:"",textBetweenControls:""},DefaultCallbacks:{callback:function(form){return Form.serialize(form)},onComplete:function(transport,element){new Effect.Highlight(element,{startcolor:this.options.highlightColor,keepBackgroundImage:true})},onEnterEditMode:null,onEnterHover:function(ipe){ipe.element.style.backgroundColor=ipe.options.highlightColor;if(ipe._effect){ipe._effect.cancel()}},onFailure:function(transport,ipe){alert("Error communication with the server: "+transport.responseText.stripTags())},onFormCustomization:null,onLeaveEditMode:null,onLeaveHover:function(ipe){ipe._effect=new Effect.Highlight(ipe.element,{startcolor:ipe.options.highlightColor,endcolor:ipe.options.highlightEndColor,restorecolor:ipe._originalBackground,keepBackgroundImage:true})}},Listeners:{click:"enterEditMode",keydown:"checkForEscapeOrReturn",mouseover:"enterHover",mouseout:"leaveHover"}});Ajax.InPlaceCollectionEditor.DefaultOptions={loadingCollectionText:"Loading options..."};Form.Element.DelayedObserver=Class.create({initialize:function(element,delay,callback){this.delay=delay||0.5;this.element=$(element);this.callback=callback;this.timer=null;this.lastValue=$F(this.element);Event.observe(this.element,"keyup",this.delayedListener.bindAsEventListener(this))},delayedListener:function(event){if(this.lastValue==$F(this.element)){return}if(this.timer){clearTimeout(this.timer)}this.timer=setTimeout(this.onTimerEvent.bind(this),this.delay*1000);this.lastValue=$F(this.element)},onTimerEvent:function(){this.timer=null;this.callback(this.element,$F(this.element))}});
/*!
 * jQuery JavaScript Library v1.6.1
 * http://jquery.com/
 *
 * Copyright 2011, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 * Copyright 2011, The Dojo Foundation
 * Released under the MIT, BSD, and GPL Licenses.
 *
 * Date: Thu May 12 15:04:36 2011 -0400
 */
(function(window,undefined){var document=window.document,navigator=window.navigator,location=window.location;var jQuery=(function(){var jQuery=function(selector,context){return new jQuery.fn.init(selector,context,rootjQuery)},_jQuery=window.jQuery,_$=window.$,rootjQuery,quickExpr=/^(?:[^<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,rnotwhite=/\S/,trimLeft=/^\s+/,trimRight=/\s+$/,rdigit=/\d/,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,rvalidchars=/^[\],:{}\s]*$/,rvalidescape=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rvalidtokens=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,rwebkit=/(webkit)[ \/]([\w.]+)/,ropera=/(opera)(?:.*version)?[ \/]([\w.]+)/,rmsie=/(msie) ([\w.]+)/,rmozilla=/(mozilla)(?:.*? rv:([\w.]+))?/,userAgent=navigator.userAgent,browserMatch,readyList,DOMContentLoaded,toString=Object.prototype.toString,hasOwn=Object.prototype.hasOwnProperty,push=Array.prototype.push,slice=Array.prototype.slice,trim=String.prototype.trim,indexOf=Array.prototype.indexOf,class2type={};jQuery.fn=jQuery.prototype={constructor:jQuery,init:function(selector,context,rootjQuery){var match,elem,ret,doc;if(!selector){return this}if(selector.nodeType){this.context=this[0]=selector;this.length=1;return this}if(selector==="body"&&!context&&document.body){this.context=document;this[0]=document.body;this.selector=selector;this.length=1;return this}if(typeof selector==="string"){if(selector.charAt(0)==="<"&&selector.charAt(selector.length-1)===">"&&selector.length>=3){match=[null,selector,null]}else{match=quickExpr.exec(selector)}if(match&&(match[1]||!context)){if(match[1]){context=context instanceof jQuery?context[0]:context;doc=(context?context.ownerDocument||context:document);ret=rsingleTag.exec(selector);if(ret){if(jQuery.isPlainObject(context)){selector=[document.createElement(ret[1])];jQuery.fn.attr.call(selector,context,true)}else{selector=[doc.createElement(ret[1])]}}else{ret=jQuery.buildFragment([match[1]],[doc]);selector=(ret.cacheable?jQuery.clone(ret.fragment):ret.fragment).childNodes}return jQuery.merge(this,selector)}else{elem=document.getElementById(match[2]);if(elem&&elem.parentNode){if(elem.id!==match[2]){return rootjQuery.find(selector)}this.length=1;this[0]=elem}this.context=document;this.selector=selector;return this}}else{if(!context||context.jquery){return(context||rootjQuery).find(selector)}else{return this.constructor(context).find(selector)}}}else{if(jQuery.isFunction(selector)){return rootjQuery.ready(selector)}}if(selector.selector!==undefined){this.selector=selector.selector;this.context=selector.context}return jQuery.makeArray(selector,this)},selector:"",jquery:"1.6.1",length:0,size:function(){return this.length},toArray:function(){return slice.call(this,0)},get:function(num){return num==null?this.toArray():(num<0?this[this.length+num]:this[num])},pushStack:function(elems,name,selector){var ret=this.constructor();if(jQuery.isArray(elems)){push.apply(ret,elems)}else{jQuery.merge(ret,elems)}ret.prevObject=this;ret.context=this.context;if(name==="find"){ret.selector=this.selector+(this.selector?" ":"")+selector}else{if(name){ret.selector=this.selector+"."+name+"("+selector+")"}}return ret},each:function(callback,args){return jQuery.each(this,callback,args)},ready:function(fn){jQuery.bindReady();readyList.done(fn);return this},eq:function(i){return i===-1?this.slice(i):this.slice(i,+i+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(slice.apply(this,arguments),"slice",slice.call(arguments).join(","))},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:[].sort,splice:[].splice};jQuery.fn.init.prototype=jQuery.fn;jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2}if(typeof target!=="object"&&!jQuery.isFunction(target)){target={}}if(length===i){target=this;--i}for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue}if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&jQuery.isArray(src)?src:[]}else{clone=src&&jQuery.isPlainObject(src)?src:{}}target[name]=jQuery.extend(deep,clone,copy)}else{if(copy!==undefined){target[name]=copy}}}}}return target};jQuery.extend({noConflict:function(deep){if(window.$===jQuery){window.$=_$}if(deep&&window.jQuery===jQuery){window.jQuery=_jQuery}return jQuery},isReady:false,readyWait:1,holdReady:function(hold){if(hold){jQuery.readyWait++}else{jQuery.ready(true)}},ready:function(wait){if((wait===true&&!--jQuery.readyWait)||(wait!==true&&!jQuery.isReady)){if(!document.body){return setTimeout(jQuery.ready,1)}jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0){return}readyList.resolveWith(document,[jQuery]);if(jQuery.fn.trigger){jQuery(document).trigger("ready").unbind("ready")}}},bindReady:function(){if(readyList){return}readyList=jQuery._Deferred();if(document.readyState==="complete"){return setTimeout(jQuery.ready,1)}if(document.addEventListener){document.addEventListener("DOMContentLoaded",DOMContentLoaded,false);window.addEventListener("load",jQuery.ready,false)}else{if(document.attachEvent){document.attachEvent("onreadystatechange",DOMContentLoaded);window.attachEvent("onload",jQuery.ready);var toplevel=false;try{toplevel=window.frameElement==null}catch(e){}if(document.documentElement.doScroll&&toplevel){doScrollCheck()}}}},isFunction:function(obj){return jQuery.type(obj)==="function"},isArray:Array.isArray||function(obj){return jQuery.type(obj)==="array"},isWindow:function(obj){return obj&&typeof obj==="object"&&"setInterval" in obj},isNaN:function(obj){return obj==null||!rdigit.test(obj)||isNaN(obj)},type:function(obj){return obj==null?String(obj):class2type[toString.call(obj)]||"object"},isPlainObject:function(obj){if(!obj||jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj)){return false}if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){return false}var key;for(key in obj){}return key===undefined||hasOwn.call(obj,key)},isEmptyObject:function(obj){for(var name in obj){return false}return true},error:function(msg){throw msg},parseJSON:function(data){if(typeof data!=="string"||!data){return null}data=jQuery.trim(data);if(window.JSON&&window.JSON.parse){return window.JSON.parse(data)}if(rvalidchars.test(data.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,""))){return(new Function("return "+data))()}jQuery.error("Invalid JSON: "+data)},parseXML:function(data,xml,tmp){if(window.DOMParser){tmp=new DOMParser();xml=tmp.parseFromString(data,"text/xml")}else{xml=new ActiveXObject("Microsoft.XMLDOM");xml.async="false";xml.loadXML(data)}tmp=xml.documentElement;if(!tmp||!tmp.nodeName||tmp.nodeName==="parsererror"){jQuery.error("Invalid XML: "+data)}return xml},noop:function(){},globalEval:function(data){if(data&&rnotwhite.test(data)){(window.execScript||function(data){window["eval"].call(window,data)})(data)}},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toUpperCase()===name.toUpperCase()},each:function(object,callback,args){var name,i=0,length=object.length,isObj=length===undefined||jQuery.isFunction(object);if(args){if(isObj){for(name in object){if(callback.apply(object[name],args)===false){break}}}else{for(;i<length;){if(callback.apply(object[i++],args)===false){break}}}}else{if(isObj){for(name in object){if(callback.call(object[name],name,object[name])===false){break}}}else{for(;i<length;){if(callback.call(object[i],i,object[i++])===false){break}}}}return object},trim:trim?function(text){return text==null?"":trim.call(text)}:function(text){return text==null?"":text.toString().replace(trimLeft,"").replace(trimRight,"")},makeArray:function(array,results){var ret=results||[];if(array!=null){var type=jQuery.type(array);if(array.length==null||type==="string"||type==="function"||type==="regexp"||jQuery.isWindow(array)){push.call(ret,array)}else{jQuery.merge(ret,array)}}return ret},inArray:function(elem,array){if(indexOf){return indexOf.call(array,elem)}for(var i=0,length=array.length;i<length;i++){if(array[i]===elem){return i}}return -1},merge:function(first,second){var i=first.length,j=0;if(typeof second.length==="number"){for(var l=second.length;j<l;j++){first[i++]=second[j]}}else{while(second[j]!==undefined){first[i++]=second[j++]}}first.length=i;return first},grep:function(elems,callback,inv){var ret=[],retVal;inv=!!inv;for(var i=0,length=elems.length;i<length;i++){retVal=!!callback(elems[i],i);if(inv!==retVal){ret.push(elems[i])}}return ret},map:function(elems,callback,arg){var value,key,ret=[],i=0,length=elems.length,isArray=elems instanceof jQuery||length!==undefined&&typeof length==="number"&&((length>0&&elems[0]&&elems[length-1])||length===0||jQuery.isArray(elems));if(isArray){for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null){ret[ret.length]=value}}}else{for(key in elems){value=callback(elems[key],key,arg);if(value!=null){ret[ret.length]=value}}}return ret.concat.apply([],ret)},guid:1,proxy:function(fn,context){if(typeof context==="string"){var tmp=fn[context];context=fn;fn=tmp}if(!jQuery.isFunction(fn)){return undefined}var args=slice.call(arguments,2),proxy=function(){return fn.apply(context,args.concat(slice.call(arguments)))};proxy.guid=fn.guid=fn.guid||proxy.guid||jQuery.guid++;return proxy},access:function(elems,key,value,exec,fn,pass){var length=elems.length;if(typeof key==="object"){for(var k in key){jQuery.access(elems,k,key[k],exec,fn,value)}return elems}if(value!==undefined){exec=!pass&&exec&&jQuery.isFunction(value);for(var i=0;i<length;i++){fn(elems[i],key,exec?value.call(elems[i],i,fn(elems[i],key)):value,pass)}return elems}return length?fn(elems[0],key):undefined},now:function(){return(new Date()).getTime()},uaMatch:function(ua){ua=ua.toLowerCase();var match=rwebkit.exec(ua)||ropera.exec(ua)||rmsie.exec(ua)||ua.indexOf("compatible")<0&&rmozilla.exec(ua)||[];return{browser:match[1]||"",version:match[2]||"0"}},sub:function(){function jQuerySub(selector,context){return new jQuerySub.fn.init(selector,context)}jQuery.extend(true,jQuerySub,this);jQuerySub.superclass=this;jQuerySub.fn=jQuerySub.prototype=this();jQuerySub.fn.constructor=jQuerySub;jQuerySub.sub=this.sub;jQuerySub.fn.init=function init(selector,context){if(context&&context instanceof jQuery&&!(context instanceof jQuerySub)){context=jQuerySub(context)}return jQuery.fn.init.call(this,selector,context,rootjQuerySub)};jQuerySub.fn.init.prototype=jQuerySub.fn;var rootjQuerySub=jQuerySub(document);return jQuerySub},browser:{}});jQuery.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});browserMatch=jQuery.uaMatch(userAgent);if(browserMatch.browser){jQuery.browser[browserMatch.browser]=true;jQuery.browser.version=browserMatch.version}if(jQuery.browser.webkit){jQuery.browser.safari=true}if(rnotwhite.test("\xA0")){trimLeft=/^[\s\xA0]+/;trimRight=/[\s\xA0]+$/}rootjQuery=jQuery(document);if(document.addEventListener){DOMContentLoaded=function(){document.removeEventListener("DOMContentLoaded",DOMContentLoaded,false);jQuery.ready()}}else{if(document.attachEvent){DOMContentLoaded=function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",DOMContentLoaded);jQuery.ready()}}}}function doScrollCheck(){if(jQuery.isReady){return}try{document.documentElement.doScroll("left")}catch(e){setTimeout(doScrollCheck,1);return}jQuery.ready()}return jQuery})();var promiseMethods="done fail isResolved isRejected promise then always pipe".split(" "),sliceDeferred=[].slice;jQuery.extend({_Deferred:function(){var callbacks=[],fired,firing,cancelled,deferred={done:function(){if(!cancelled){var args=arguments,i,length,elem,type,_fired;if(fired){_fired=fired;fired=0}for(i=0,length=args.length;i<length;i++){elem=args[i];type=jQuery.type(elem);if(type==="array"){deferred.done.apply(deferred,elem)}else{if(type==="function"){callbacks.push(elem)}}}if(_fired){deferred.resolveWith(_fired[0],_fired[1])}}return this},resolveWith:function(context,args){if(!cancelled&&!fired&&!firing){args=args||[];firing=1;try{while(callbacks[0]){callbacks.shift().apply(context,args)}}finally{fired=[context,args];firing=0}}return this},resolve:function(){deferred.resolveWith(this,arguments);return this},isResolved:function(){return !!(firing||fired)},cancel:function(){cancelled=1;callbacks=[];return this}};return deferred},Deferred:function(func){var deferred=jQuery._Deferred(),failDeferred=jQuery._Deferred(),promise;jQuery.extend(deferred,{then:function(doneCallbacks,failCallbacks){deferred.done(doneCallbacks).fail(failCallbacks);return this},always:function(){return deferred.done.apply(deferred,arguments).fail.apply(this,arguments)},fail:failDeferred.done,rejectWith:failDeferred.resolveWith,reject:failDeferred.resolve,isRejected:failDeferred.isResolved,pipe:function(fnDone,fnFail){return jQuery.Deferred(function(newDefer){jQuery.each({done:[fnDone,"resolve"],fail:[fnFail,"reject"]},function(handler,data){var fn=data[0],action=data[1],returned;if(jQuery.isFunction(fn)){deferred[handler](function(){returned=fn.apply(this,arguments);if(returned&&jQuery.isFunction(returned.promise)){returned.promise().then(newDefer.resolve,newDefer.reject)}else{newDefer[action](returned)}})}else{deferred[handler](newDefer[action])}})}).promise()},promise:function(obj){if(obj==null){if(promise){return promise}promise=obj={}}var i=promiseMethods.length;while(i--){obj[promiseMethods[i]]=deferred[promiseMethods[i]]}return obj}});deferred.done(failDeferred.cancel).fail(deferred.cancel);delete deferred.cancel;if(func){func.call(deferred,deferred)}return deferred},when:function(firstParam){var args=arguments,i=0,length=args.length,count=length,deferred=length<=1&&firstParam&&jQuery.isFunction(firstParam.promise)?firstParam:jQuery.Deferred();function resolveFunc(i){return function(value){args[i]=arguments.length>1?sliceDeferred.call(arguments,0):value;if(!(--count)){deferred.resolveWith(deferred,sliceDeferred.call(args,0))}}}if(length>1){for(;i<length;i++){if(args[i]&&jQuery.isFunction(args[i].promise)){args[i].promise().then(resolveFunc(i),deferred.reject)}else{--count}}if(!count){deferred.resolveWith(deferred,args)}}else{if(deferred!==firstParam){deferred.resolveWith(deferred,length?[firstParam]:[])}}return deferred.promise()}});jQuery.support=(function(){var div=document.createElement("div"),documentElement=document.documentElement,all,a,select,opt,input,marginDiv,support,fragment,body,bodyStyle,tds,events,eventName,i,isSupported;div.setAttribute("className","t");div.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>";all=div.getElementsByTagName("*");a=div.getElementsByTagName("a")[0];if(!all||!all.length||!a){return{}}select=document.createElement("select");opt=select.appendChild(document.createElement("option"));input=div.getElementsByTagName("input")[0];support={leadingWhitespace:(div.firstChild.nodeType===3),tbody:!div.getElementsByTagName("tbody").length,htmlSerialize:!!div.getElementsByTagName("link").length,style:/top/.test(a.getAttribute("style")),hrefNormalized:(a.getAttribute("href")==="/a"),opacity:/^0.55$/.test(a.style.opacity),cssFloat:!!a.style.cssFloat,checkOn:(input.value==="on"),optSelected:opt.selected,getSetAttribute:div.className!=="t",submitBubbles:true,changeBubbles:true,focusinBubbles:false,deleteExpando:true,noCloneEvent:true,inlineBlockNeedsLayout:false,shrinkWrapBlocks:false,reliableMarginRight:true};input.checked=true;support.noCloneChecked=input.cloneNode(true).checked;select.disabled=true;support.optDisabled=!opt.disabled;try{delete div.test}catch(e){support.deleteExpando=false}if(!div.addEventListener&&div.attachEvent&&div.fireEvent){div.attachEvent("onclick",function click(){support.noCloneEvent=false;div.detachEvent("onclick",click)});div.cloneNode(true).fireEvent("onclick")}input=document.createElement("input");input.value="t";input.setAttribute("type","radio");support.radioValue=input.value==="t";input.setAttribute("checked","checked");div.appendChild(input);fragment=document.createDocumentFragment();fragment.appendChild(div.firstChild);support.checkClone=fragment.cloneNode(true).cloneNode(true).lastChild.checked;div.innerHTML="";div.style.width=div.style.paddingLeft="1px";body=document.createElement("body");bodyStyle={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};for(i in bodyStyle){body.style[i]=bodyStyle[i]}body.appendChild(div);documentElement.insertBefore(body,documentElement.firstChild);support.appendChecked=input.checked;support.boxModel=div.offsetWidth===2;if("zoom" in div.style){div.style.display="inline";div.style.zoom=1;support.inlineBlockNeedsLayout=(div.offsetWidth===2);div.style.display="";div.innerHTML="<div style='width:4px;'></div>";support.shrinkWrapBlocks=(div.offsetWidth!==2)}div.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>";tds=div.getElementsByTagName("td");isSupported=(tds[0].offsetHeight===0);tds[0].style.display="";tds[1].style.display="none";support.reliableHiddenOffsets=isSupported&&(tds[0].offsetHeight===0);div.innerHTML="";if(document.defaultView&&document.defaultView.getComputedStyle){marginDiv=document.createElement("div");marginDiv.style.width="0";marginDiv.style.marginRight="0";div.appendChild(marginDiv);support.reliableMarginRight=(parseInt((document.defaultView.getComputedStyle(marginDiv,null)||{marginRight:0}).marginRight,10)||0)===0}body.innerHTML="";documentElement.removeChild(body);if(div.attachEvent){for(i in {submit:1,change:1,focusin:1}){eventName="on"+i;isSupported=(eventName in div);if(!isSupported){div.setAttribute(eventName,"return;");isSupported=(typeof div[eventName]==="function")}support[i+"Bubbles"]=isSupported}}return support})();jQuery.boxModel=jQuery.support.boxModel;var rbrace=/^(?:\{.*\}|\[.*\])$/,rmultiDash=/([a-z])([A-Z])/g;jQuery.extend({cache:{},uuid:0,expando:"jQuery"+(jQuery.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:true,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:true},hasData:function(elem){elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando];return !!elem&&!isEmptyDataObject(elem)},data:function(elem,name,data,pvt){if(!jQuery.acceptData(elem)){return}var internalKey=jQuery.expando,getByName=typeof name==="string",thisCache,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:elem[jQuery.expando]&&jQuery.expando;if((!id||(pvt&&id&&!cache[id][internalKey]))&&getByName&&data===undefined){return}if(!id){if(isNode){elem[jQuery.expando]=id=++jQuery.uuid}else{id=jQuery.expando}}if(!cache[id]){cache[id]={};if(!isNode){cache[id].toJSON=jQuery.noop}}if(typeof name==="object"||typeof name==="function"){if(pvt){cache[id][internalKey]=jQuery.extend(cache[id][internalKey],name)}else{cache[id]=jQuery.extend(cache[id],name)}}thisCache=cache[id];if(pvt){if(!thisCache[internalKey]){thisCache[internalKey]={}}thisCache=thisCache[internalKey]}if(data!==undefined){thisCache[jQuery.camelCase(name)]=data}if(name==="events"&&!thisCache[name]){return thisCache[internalKey]&&thisCache[internalKey].events}return getByName?thisCache[jQuery.camelCase(name)]:thisCache},removeData:function(elem,name,pvt){if(!jQuery.acceptData(elem)){return}var internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:jQuery.expando;if(!cache[id]){return}if(name){var thisCache=pvt?cache[id][internalKey]:cache[id];if(thisCache){delete thisCache[name];if(!isEmptyDataObject(thisCache)){return}}}if(pvt){delete cache[id][internalKey];if(!isEmptyDataObject(cache[id])){return}}var internalCache=cache[id][internalKey];if(jQuery.support.deleteExpando||cache!=window){delete cache[id]}else{cache[id]=null}if(internalCache){cache[id]={};if(!isNode){cache[id].toJSON=jQuery.noop}cache[id][internalKey]=internalCache}else{if(isNode){if(jQuery.support.deleteExpando){delete elem[jQuery.expando]}else{if(elem.removeAttribute){elem.removeAttribute(jQuery.expando)}else{elem[jQuery.expando]=null}}}}},_data:function(elem,name,data){return jQuery.data(elem,name,data,true)},acceptData:function(elem){if(elem.nodeName){var match=jQuery.noData[elem.nodeName.toLowerCase()];if(match){return !(match===true||elem.getAttribute("classid")!==match)}}return true}});jQuery.fn.extend({data:function(key,value){var data=null;if(typeof key==="undefined"){if(this.length){data=jQuery.data(this[0]);if(this[0].nodeType===1){var attr=this[0].attributes,name;for(var i=0,l=attr.length;i<l;i++){name=attr[i].name;if(name.indexOf("data-")===0){name=jQuery.camelCase(name.substring(5));dataAttr(this[0],name,data[name])}}}}return data}else{if(typeof key==="object"){return this.each(function(){jQuery.data(this,key)})}}var parts=key.split(".");parts[1]=parts[1]?"."+parts[1]:"";if(value===undefined){data=this.triggerHandler("getData"+parts[1]+"!",[parts[0]]);if(data===undefined&&this.length){data=jQuery.data(this[0],key);data=dataAttr(this[0],key,data)}return data===undefined&&parts[1]?this.data(parts[0]):data}else{return this.each(function(){var $this=jQuery(this),args=[parts[0],value];$this.triggerHandler("setData"+parts[1]+"!",args);jQuery.data(this,key,value);$this.triggerHandler("changeData"+parts[1]+"!",args)})}},removeData:function(key){return this.each(function(){jQuery.removeData(this,key)})}});function dataAttr(elem,key,data){if(data===undefined&&elem.nodeType===1){var name="data-"+key.replace(rmultiDash,"$1-$2").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=data==="true"?true:data==="false"?false:data==="null"?null:!jQuery.isNaN(data)?parseFloat(data):rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}jQuery.data(elem,key,data)}else{data=undefined}}return data}function isEmptyDataObject(obj){for(var name in obj){if(name!=="toJSON"){return false}}return true}function handleQueueMarkDefer(elem,type,src){var deferDataKey=type+"defer",queueDataKey=type+"queue",markDataKey=type+"mark",defer=jQuery.data(elem,deferDataKey,undefined,true);if(defer&&(src==="queue"||!jQuery.data(elem,queueDataKey,undefined,true))&&(src==="mark"||!jQuery.data(elem,markDataKey,undefined,true))){setTimeout(function(){if(!jQuery.data(elem,queueDataKey,undefined,true)&&!jQuery.data(elem,markDataKey,undefined,true)){jQuery.removeData(elem,deferDataKey,true);defer.resolve()}},0)}}jQuery.extend({_mark:function(elem,type){if(elem){type=(type||"fx")+"mark";jQuery.data(elem,type,(jQuery.data(elem,type,undefined,true)||0)+1,true)}},_unmark:function(force,elem,type){if(force!==true){type=elem;elem=force;force=false}if(elem){type=type||"fx";var key=type+"mark",count=force?0:((jQuery.data(elem,key,undefined,true)||1)-1);if(count){jQuery.data(elem,key,count,true)}else{jQuery.removeData(elem,key,true);handleQueueMarkDefer(elem,type,"mark")}}},queue:function(elem,type,data){if(elem){type=(type||"fx")+"queue";var q=jQuery.data(elem,type,undefined,true);if(data){if(!q||jQuery.isArray(data)){q=jQuery.data(elem,type,jQuery.makeArray(data),true)}else{q.push(data)}}return q||[]}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),fn=queue.shift(),defer;if(fn==="inprogress"){fn=queue.shift()}if(fn){if(type==="fx"){queue.unshift("inprogress")}fn.call(elem,function(){jQuery.dequeue(elem,type)})}if(!queue.length){jQuery.removeData(elem,type+"queue",true);handleQueueMarkDefer(elem,type,"queue")}}});jQuery.fn.extend({queue:function(type,data){if(typeof type!=="string"){data=type;type="fx"}if(data===undefined){return jQuery.queue(this[0],type)}return this.each(function(){var queue=jQuery.queue(this,type,data);if(type==="fx"&&queue[0]!=="inprogress"){jQuery.dequeue(this,type)}})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},delay:function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(){var elem=this;setTimeout(function(){jQuery.dequeue(elem,type)},time)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,object){if(typeof type!=="string"){object=type;type=undefined}type=type||"fx";var defer=jQuery.Deferred(),elements=this,i=elements.length,count=1,deferDataKey=type+"defer",queueDataKey=type+"queue",markDataKey=type+"mark",tmp;function resolve(){if(!(--count)){defer.resolveWith(elements,[elements])}}while(i--){if((tmp=jQuery.data(elements[i],deferDataKey,undefined,true)||(jQuery.data(elements[i],queueDataKey,undefined,true)||jQuery.data(elements[i],markDataKey,undefined,true))&&jQuery.data(elements[i],deferDataKey,jQuery._Deferred(),true))){count++;tmp.done(resolve)}}resolve();return defer.promise()}});var rclass=/[\n\t\r]/g,rspace=/\s+/,rreturn=/\r/g,rtype=/^(?:button|input)$/i,rfocusable=/^(?:button|input|object|select|textarea)$/i,rclickable=/^a(?:rea)?$/i,rboolean=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,rinvalidChar=/\:/,formHook,boolHook;jQuery.fn.extend({attr:function(name,value){return jQuery.access(this,name,value,true,jQuery.attr)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})},prop:function(name,value){return jQuery.access(this,name,value,true,jQuery.prop)},removeProp:function(name){name=jQuery.propFix[name]||name;return this.each(function(){try{this[name]=undefined;delete this[name]}catch(e){}})},addClass:function(value){if(jQuery.isFunction(value)){return this.each(function(i){var self=jQuery(this);self.addClass(value.call(this,i,self.attr("class")||""))})}if(value&&typeof value==="string"){var classNames=(value||"").split(rspace);for(var i=0,l=this.length;i<l;i++){var elem=this[i];if(elem.nodeType===1){if(!elem.className){elem.className=value}else{var className=" "+elem.className+" ",setClass=elem.className;for(var c=0,cl=classNames.length;c<cl;c++){if(className.indexOf(" "+classNames[c]+" ")<0){setClass+=" "+classNames[c]}}elem.className=jQuery.trim(setClass)}}}}return this},removeClass:function(value){if(jQuery.isFunction(value)){return this.each(function(i){var self=jQuery(this);self.removeClass(value.call(this,i,self.attr("class")))})}if((value&&typeof value==="string")||value===undefined){var classNames=(value||"").split(rspace);for(var i=0,l=this.length;i<l;i++){var elem=this[i];if(elem.nodeType===1&&elem.className){if(value){var className=(" "+elem.className+" ").replace(rclass," ");for(var c=0,cl=classNames.length;c<cl;c++){className=className.replace(" "+classNames[c]+" "," ")}elem.className=jQuery.trim(className)}else{elem.className=""}}}}return this},toggleClass:function(value,stateVal){var type=typeof value,isBool=typeof stateVal==="boolean";if(jQuery.isFunction(value)){return this.each(function(i){var self=jQuery(this);self.toggleClass(value.call(this,i,self.attr("class"),stateVal),stateVal)})}return this.each(function(){if(type==="string"){var className,i=0,self=jQuery(this),state=stateVal,classNames=value.split(rspace);while((className=classNames[i++])){state=isBool?state:!self.hasClass(className);self[state?"addClass":"removeClass"](className)}}else{if(type==="undefined"||type==="boolean"){if(this.className){jQuery._data(this,"__className__",this.className)}this.className=this.className||value===false?"":jQuery._data(this,"__className__")||""}}})},hasClass:function(selector){var className=" "+selector+" ";for(var i=0,l=this.length;i<l;i++){if((" "+this[i].className+" ").replace(rclass," ").indexOf(className)>-1){return true}}return false},val:function(value){var hooks,ret,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.nodeName.toLowerCase()]||jQuery.valHooks[elem.type];if(hooks&&"get" in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret}return(elem.value||"").replace(rreturn,"")}return undefined}var isFunction=jQuery.isFunction(value);return this.each(function(i){var self=jQuery(this),val;if(this.nodeType!==1){return}if(isFunction){val=value.call(this,i,self.val())}else{val=value}if(val==null){val=""}else{if(typeof val==="number"){val+=""}else{if(jQuery.isArray(val)){val=jQuery.map(val,function(value){return value==null?"":value+""})}}}hooks=jQuery.valHooks[this.nodeName.toLowerCase()]||jQuery.valHooks[this.type];if(!hooks||!("set" in hooks)||hooks.set(this,val,"value")===undefined){this.value=val}})}});jQuery.extend({valHooks:{option:{get:function(elem){var val=elem.attributes.value;return !val||val.specified?elem.value:elem.text}},select:{get:function(elem){var value,index=elem.selectedIndex,values=[],options=elem.options,one=elem.type==="select-one";if(index<0){return null}for(var i=one?index:0,max=one?index+1:options.length;i<max;i++){var option=options[i];if(option.selected&&(jQuery.support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one){return value}values.push(value)}}if(one&&!values.length&&options.length){return jQuery(options[index]).val()}return values},set:function(elem,value){var values=jQuery.makeArray(value);jQuery(elem).find("option").each(function(){this.selected=jQuery.inArray(jQuery(this).val(),values)>=0});if(!values.length){elem.selectedIndex=-1}return values}}},attrFn:{val:true,css:true,html:true,text:true,data:true,width:true,height:true,offset:true},attrFix:{tabindex:"tabIndex"},attr:function(elem,name,value,pass){var nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return undefined}if(pass&&name in jQuery.attrFn){return jQuery(elem)[name](value)}if(!("getAttribute" in elem)){return jQuery.prop(elem,name,value)}var ret,hooks,notxml=nType!==1||!jQuery.isXMLDoc(elem);name=notxml&&jQuery.attrFix[name]||name;hooks=jQuery.attrHooks[name];if(!hooks){if(rboolean.test(name)&&(typeof value==="boolean"||value===undefined||value.toLowerCase()===name.toLowerCase())){hooks=boolHook}else{if(formHook&&(jQuery.nodeName(elem,"form")||rinvalidChar.test(name))){hooks=formHook}}}if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name);return undefined}else{if(hooks&&"set" in hooks&&notxml&&(ret=hooks.set(elem,value,name))!==undefined){return ret}else{elem.setAttribute(name,""+value);return value}}}else{if(hooks&&"get" in hooks&&notxml){return hooks.get(elem,name)}else{ret=elem.getAttribute(name);return ret===null?undefined:ret}}},removeAttr:function(elem,name){var propName;if(elem.nodeType===1){name=jQuery.attrFix[name]||name;if(jQuery.support.getSetAttribute){elem.removeAttribute(name)}else{jQuery.attr(elem,name,"");elem.removeAttributeNode(elem.getAttributeNode(name))}if(rboolean.test(name)&&(propName=jQuery.propFix[name]||name) in elem){elem[propName]=false}}},attrHooks:{type:{set:function(elem,value){if(rtype.test(elem.nodeName)&&elem.parentNode){jQuery.error("type property can't be changed")}else{if(!jQuery.support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val){elem.value=val}return value}}}},tabIndex:{get:function(elem){var attributeNode=elem.getAttributeNode("tabIndex");return attributeNode&&attributeNode.specified?parseInt(attributeNode.value,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:undefined}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(elem,name,value){var nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return undefined}var ret,hooks,notxml=nType!==1||!jQuery.isXMLDoc(elem);name=notxml&&jQuery.propFix[name]||name;hooks=jQuery.propHooks[name];if(value!==undefined){if(hooks&&"set" in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret}else{return(elem[name]=value)}}else{if(hooks&&"get" in hooks&&(ret=hooks.get(elem,name))!==undefined){return ret}else{return elem[name]}}},propHooks:{}});boolHook={get:function(elem,name){return elem[jQuery.propFix[name]||name]?name.toLowerCase():undefined},set:function(elem,value,name){var propName;if(value===false){jQuery.removeAttr(elem,name)}else{propName=jQuery.propFix[name]||name;if(propName in elem){elem[propName]=value}elem.setAttribute(name,name.toLowerCase())}return name}};jQuery.attrHooks.value={get:function(elem,name){if(formHook&&jQuery.nodeName(elem,"button")){return formHook.get(elem,name)}return elem.value},set:function(elem,value,name){if(formHook&&jQuery.nodeName(elem,"button")){return formHook.set(elem,value,name)}elem.value=value}};if(!jQuery.support.getSetAttribute){jQuery.attrFix=jQuery.propFix;formHook=jQuery.attrHooks.name=jQuery.valHooks.button={get:function(elem,name){var ret;ret=elem.getAttributeNode(name);return ret&&ret.nodeValue!==""?ret.nodeValue:undefined},set:function(elem,value,name){var ret=elem.getAttributeNode(name);if(ret){ret.nodeValue=value;return value}}};jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]=jQuery.extend(jQuery.attrHooks[name],{set:function(elem,value){if(value===""){elem.setAttribute(name,"auto");return value}}})})}if(!jQuery.support.hrefNormalized){jQuery.each(["href","src","width","height"],function(i,name){jQuery.attrHooks[name]=jQuery.extend(jQuery.attrHooks[name],{get:function(elem){var ret=elem.getAttribute(name,2);return ret===null?undefined:ret}})})}if(!jQuery.support.style){jQuery.attrHooks.style={get:function(elem){return elem.style.cssText.toLowerCase()||undefined},set:function(elem,value){return(elem.style.cssText=""+value)}}}if(!jQuery.support.optSelected){jQuery.propHooks.selected=jQuery.extend(jQuery.propHooks.selected,{get:function(elem){var parent=elem.parentNode;if(parent){parent.selectedIndex;if(parent.parentNode){parent.parentNode.selectedIndex}}}})}if(!jQuery.support.checkOn){jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={get:function(elem){return elem.getAttribute("value")===null?"on":elem.value}}})}jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]=jQuery.extend(jQuery.valHooks[this],{set:function(elem,value){if(jQuery.isArray(value)){return(elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0)}}})});var hasOwn=Object.prototype.hasOwnProperty,rnamespaces=/\.(.*)$/,rformElems=/^(?:textarea|input|select)$/i,rperiod=/\./g,rspaces=/ /g,rescape=/[^\w\s.|`]/g,fcleanup=function(nm){return nm.replace(rescape,"\\$&")};jQuery.event={add:function(elem,types,handler,data){if(elem.nodeType===3||elem.nodeType===8){return}if(handler===false){handler=returnFalse}else{if(!handler){return}}var handleObjIn,handleObj;if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler}if(!handler.guid){handler.guid=jQuery.guid++}var elemData=jQuery._data(elem);if(!elemData){return}var events=elemData.events,eventHandle=elemData.handle;if(!events){elemData.events=events={}}if(!eventHandle){elemData.handle=eventHandle=function(e){return typeof jQuery!=="undefined"&&(!e||jQuery.event.triggered!==e.type)?jQuery.event.handle.apply(eventHandle.elem,arguments):undefined}}eventHandle.elem=elem;types=types.split(" ");var type,i=0,namespaces;while((type=types[i++])){handleObj=handleObjIn?jQuery.extend({},handleObjIn):{handler:handler,data:data};if(type.indexOf(".")>-1){namespaces=type.split(".");type=namespaces.shift();handleObj.namespace=namespaces.slice(0).sort().join(".")}else{namespaces=[];handleObj.namespace=""}handleObj.type=type;if(!handleObj.guid){handleObj.guid=handler.guid}var handlers=events[type],special=jQuery.event.special[type]||{};if(!handlers){handlers=events[type]=[];if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){if(elem.addEventListener){elem.addEventListener(type,eventHandle,false)}else{if(elem.attachEvent){elem.attachEvent("on"+type,eventHandle)}}}}if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid){handleObj.handler.guid=handler.guid}}handlers.push(handleObj);jQuery.event.global[type]=true}elem=null},global:{},remove:function(elem,types,handler,pos){if(elem.nodeType===3||elem.nodeType===8){return}if(handler===false){handler=returnFalse}var ret,type,fn,j,i=0,all,namespaces,namespace,special,eventType,handleObj,origType,elemData=jQuery.hasData(elem)&&jQuery._data(elem),events=elemData&&elemData.events;if(!elemData||!events){return}if(types&&types.type){handler=types.handler;types=types.type}if(!types||typeof types==="string"&&types.charAt(0)==="."){types=types||"";for(type in events){jQuery.event.remove(elem,type+types)}return}types=types.split(" ");while((type=types[i++])){origType=type;handleObj=null;all=type.indexOf(".")<0;namespaces=[];if(!all){namespaces=type.split(".");type=namespaces.shift();namespace=new RegExp("(^|\\.)"+jQuery.map(namespaces.slice(0).sort(),fcleanup).join("\\.(?:.*\\.)?")+"(\\.|$)")}eventType=events[type];if(!eventType){continue}if(!handler){for(j=0;j<eventType.length;j++){handleObj=eventType[j];if(all||namespace.test(handleObj.namespace)){jQuery.event.remove(elem,origType,handleObj.handler,j);eventType.splice(j--,1)}}continue}special=jQuery.event.special[type]||{};for(j=pos||0;j<eventType.length;j++){handleObj=eventType[j];if(handler.guid===handleObj.guid){if(all||namespace.test(handleObj.namespace)){if(pos==null){eventType.splice(j--,1)}if(special.remove){special.remove.call(elem,handleObj)}}if(pos!=null){break}}}if(eventType.length===0||pos!=null&&eventType.length===1){if(!special.teardown||special.teardown.call(elem,namespaces)===false){jQuery.removeEvent(elem,type,elemData.handle)}ret=null;delete events[type]}}if(jQuery.isEmptyObject(events)){var handle=elemData.handle;if(handle){handle.elem=null}delete elemData.events;delete elemData.handle;if(jQuery.isEmptyObject(elemData)){jQuery.removeData(elem,undefined,true)}}},customEvent:{getData:true,setData:true,changeData:true},trigger:function(event,data,elem,onlyHandlers){var type=event.type||event,namespaces=[],exclusive;if(type.indexOf("!")>=0){type=type.slice(0,-1);exclusive=true}if(type.indexOf(".")>=0){namespaces=type.split(".");type=namespaces.shift();namespaces.sort()}if((!elem||jQuery.event.customEvent[type])&&!jQuery.event.global[type]){return}event=typeof event==="object"?event[jQuery.expando]?event:new jQuery.Event(type,event):new jQuery.Event(type);event.type=type;event.exclusive=exclusive;event.namespace=namespaces.join(".");event.namespace_re=new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.)?")+"(\\.|$)");if(onlyHandlers||!elem){event.preventDefault();event.stopPropagation()}if(!elem){jQuery.each(jQuery.cache,function(){var internalKey=jQuery.expando,internalCache=this[internalKey];if(internalCache&&internalCache.events&&internalCache.events[type]){jQuery.event.trigger(event,data,internalCache.handle.elem)}});return}if(elem.nodeType===3||elem.nodeType===8){return}event.result=undefined;event.target=elem;data=data?jQuery.makeArray(data):[];data.unshift(event);var cur=elem,ontype=type.indexOf(":")<0?"on"+type:"";do{var handle=jQuery._data(cur,"handle");event.currentTarget=cur;if(handle){handle.apply(cur,data)}if(ontype&&jQuery.acceptData(cur)&&cur[ontype]&&cur[ontype].apply(cur,data)===false){event.result=false;event.preventDefault()}cur=cur.parentNode||cur.ownerDocument||cur===event.target.ownerDocument&&window}while(cur&&!event.isPropagationStopped());if(!event.isDefaultPrevented()){var old,special=jQuery.event.special[type]||{};if((!special._default||special._default.call(elem.ownerDocument,event)===false)&&!(type==="click"&&jQuery.nodeName(elem,"a"))&&jQuery.acceptData(elem)){try{if(ontype&&elem[type]){old=elem[ontype];if(old){elem[ontype]=null}jQuery.event.triggered=type;elem[type]()}}catch(ieError){}if(old){elem[ontype]=old}jQuery.event.triggered=undefined}}return event.result},handle:function(event){event=jQuery.event.fix(event||window.event);var handlers=((jQuery._data(this,"events")||{})[event.type]||[]).slice(0),run_all=!event.exclusive&&!event.namespace,args=Array.prototype.slice.call(arguments,0);args[0]=event;event.currentTarget=this;for(var j=0,l=handlers.length;j<l;j++){var handleObj=handlers[j];if(run_all||event.namespace_re.test(handleObj.namespace)){event.handler=handleObj.handler;event.data=handleObj.data;event.handleObj=handleObj;var ret=handleObj.handler.apply(this,args);if(ret!==undefined){event.result=ret;if(ret===false){event.preventDefault();event.stopPropagation()}}if(event.isImmediatePropagationStopped()){break}}}return event.result},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),fix:function(event){if(event[jQuery.expando]){return event}var originalEvent=event;event=jQuery.Event(originalEvent);for(var i=this.props.length,prop;i;){prop=this.props[--i];event[prop]=originalEvent[prop]}if(!event.target){event.target=event.srcElement||document}if(event.target.nodeType===3){event.target=event.target.parentNode}if(!event.relatedTarget&&event.fromElement){event.relatedTarget=event.fromElement===event.target?event.toElement:event.fromElement}if(event.pageX==null&&event.clientX!=null){var eventDocument=event.target.ownerDocument||document,doc=eventDocument.documentElement,body=eventDocument.body;event.pageX=event.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=event.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}if(event.which==null&&(event.charCode!=null||event.keyCode!=null)){event.which=event.charCode!=null?event.charCode:event.keyCode}if(!event.metaKey&&event.ctrlKey){event.metaKey=event.ctrlKey}if(!event.which&&event.button!==undefined){event.which=(event.button&1?1:(event.button&2?3:(event.button&4?2:0)))}return event},guid:100000000,proxy:jQuery.proxy,special:{ready:{setup:jQuery.bindReady,teardown:jQuery.noop},live:{add:function(handleObj){jQuery.event.add(this,liveConvert(handleObj.origType,handleObj.selector),jQuery.extend({},handleObj,{handler:liveHandler,guid:handleObj.handler.guid}))},remove:function(handleObj){jQuery.event.remove(this,liveConvert(handleObj.origType,handleObj.selector),handleObj)}},beforeunload:{setup:function(data,namespaces,eventHandle){if(jQuery.isWindow(this)){this.onbeforeunload=eventHandle}},teardown:function(namespaces,eventHandle){if(this.onbeforeunload===eventHandle){this.onbeforeunload=null}}}}};jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){if(elem.removeEventListener){elem.removeEventListener(type,handle,false)}}:function(elem,type,handle){if(elem.detachEvent){elem.detachEvent("on"+type,handle)}};jQuery.Event=function(src,props){if(!this.preventDefault){return new jQuery.Event(src,props)}if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=(src.defaultPrevented||src.returnValue===false||src.getPreventDefault&&src.getPreventDefault())?returnTrue:returnFalse}else{this.type=src}if(props){jQuery.extend(this,props)}this.timeStamp=jQuery.now();this[jQuery.expando]=true};function returnFalse(){return false}function returnTrue(){return true}jQuery.Event.prototype={preventDefault:function(){this.isDefaultPrevented=returnTrue;var e=this.originalEvent;if(!e){return}if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}},stopPropagation:function(){this.isPropagationStopped=returnTrue;var e=this.originalEvent;if(!e){return}if(e.stopPropagation){e.stopPropagation()}e.cancelBubble=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue;this.stopPropagation()},isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse};var withinElement=function(event){var parent=event.relatedTarget;event.type=event.data;try{if(parent&&parent!==document&&!parent.parentNode){return}while(parent&&parent!==this){parent=parent.parentNode}if(parent!==this){jQuery.event.handle.apply(this,arguments)}}catch(e){}},delegate=function(event){event.type=event.data;jQuery.event.handle.apply(this,arguments)};jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(orig,fix){jQuery.event.special[orig]={setup:function(data){jQuery.event.add(this,fix,data&&data.selector?delegate:withinElement,orig)},teardown:function(data){jQuery.event.remove(this,fix,data&&data.selector?delegate:withinElement)}}});if(!jQuery.support.submitBubbles){jQuery.event.special.submit={setup:function(data,namespaces){if(!jQuery.nodeName(this,"form")){jQuery.event.add(this,"click.specialSubmit",function(e){var elem=e.target,type=elem.type;if((type==="submit"||type==="image")&&jQuery(elem).closest("form").length){trigger("submit",this,arguments)}});jQuery.event.add(this,"keypress.specialSubmit",function(e){var elem=e.target,type=elem.type;if((type==="text"||type==="password")&&jQuery(elem).closest("form").length&&e.keyCode===13){trigger("submit",this,arguments)}})}else{return false}},teardown:function(namespaces){jQuery.event.remove(this,".specialSubmit")}}}if(!jQuery.support.changeBubbles){var changeFilters,getVal=function(elem){var type=elem.type,val=elem.value;if(type==="radio"||type==="checkbox"){val=elem.checked}else{if(type==="select-multiple"){val=elem.selectedIndex>-1?jQuery.map(elem.options,function(elem){return elem.selected}).join("-"):""}else{if(jQuery.nodeName(elem,"select")){val=elem.selectedIndex}}}return val},testChange=function testChange(e){var elem=e.target,data,val;if(!rformElems.test(elem.nodeName)||elem.readOnly){return}data=jQuery._data(elem,"_change_data");val=getVal(elem);if(e.type!=="focusout"||elem.type!=="radio"){jQuery._data(elem,"_change_data",val)}if(data===undefined||val===data){return}if(data!=null||val){e.type="change";e.liveFired=undefined;jQuery.event.trigger(e,arguments[1],elem)}};jQuery.event.special.change={filters:{focusout:testChange,beforedeactivate:testChange,click:function(e){var elem=e.target,type=jQuery.nodeName(elem,"input")?elem.type:"";if(type==="radio"||type==="checkbox"||jQuery.nodeName(elem,"select")){testChange.call(this,e)}},keydown:function(e){var elem=e.target,type=jQuery.nodeName(elem,"input")?elem.type:"";if((e.keyCode===13&&!jQuery.nodeName(elem,"textarea"))||(e.keyCode===32&&(type==="checkbox"||type==="radio"))||type==="select-multiple"){testChange.call(this,e)}},beforeactivate:function(e){var elem=e.target;jQuery._data(elem,"_change_data",getVal(elem))}},setup:function(data,namespaces){if(this.type==="file"){return false}for(var type in changeFilters){jQuery.event.add(this,type+".specialChange",changeFilters[type])}return rformElems.test(this.nodeName)},teardown:function(namespaces){jQuery.event.remove(this,".specialChange");return rformElems.test(this.nodeName)}};changeFilters=jQuery.event.special.change.filters;changeFilters.focus=changeFilters.beforeactivate}function trigger(type,elem,args){var event=jQuery.extend({},args[0]);event.type=type;event.originalEvent={};event.liveFired=undefined;jQuery.event.handle.call(elem,event);if(event.isDefaultPrevented()){args[0].preventDefault()}}if(!jQuery.support.focusinBubbles){jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var attaches=0;jQuery.event.special[fix]={setup:function(){if(attaches++===0){document.addEventListener(orig,handler,true)}},teardown:function(){if(--attaches===0){document.removeEventListener(orig,handler,true)}}};function handler(donor){var e=jQuery.event.fix(donor);e.type=fix;e.originalEvent={};jQuery.event.trigger(e,null,e.target);if(e.isDefaultPrevented()){donor.preventDefault()}}})}jQuery.each(["bind","one"],function(i,name){jQuery.fn[name]=function(type,data,fn){var handler;if(typeof type==="object"){for(var key in type){this[name](key,data,type[key],fn)}return this}if(arguments.length===2||data===false){fn=data;data=undefined}if(name==="one"){handler=function(event){jQuery(this).unbind(event,handler);return fn.apply(this,arguments)};handler.guid=fn.guid||jQuery.guid++}else{handler=fn}if(type==="unload"&&name!=="one"){this.one(type,data,fn)}else{for(var i=0,l=this.length;i<l;i++){jQuery.event.add(this[i],type,handler,data)}}return this}});jQuery.fn.extend({unbind:function(type,fn){if(typeof type==="object"&&!type.preventDefault){for(var key in type){this.unbind(key,type[key])}}else{for(var i=0,l=this.length;i<l;i++){jQuery.event.remove(this[i],type,fn)}}return this},delegate:function(selector,types,data,fn){return this.live(types,data,fn,selector)},undelegate:function(selector,types,fn){if(arguments.length===0){return this.unbind("live")}else{return this.die(types,null,fn,selector)}},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){if(this[0]){return jQuery.event.trigger(type,data,this[0],true)}},toggle:function(fn){var args=arguments,guid=fn.guid||jQuery.guid++,i=0,toggler=function(event){var lastToggle=(jQuery.data(this,"lastToggle"+fn.guid)||0)%i;jQuery.data(this,"lastToggle"+fn.guid,lastToggle+1);event.preventDefault();return args[lastToggle].apply(this,arguments)||false};toggler.guid=guid;while(i<args.length){args[i++].guid=guid}return this.click(toggler)},hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)}});var liveMap={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};jQuery.each(["live","die"],function(i,name){jQuery.fn[name]=function(types,data,fn,origSelector){var type,i=0,match,namespaces,preType,selector=origSelector||this.selector,context=origSelector?this:jQuery(this.context);if(typeof types==="object"&&!types.preventDefault){for(var key in types){context[name](key,data,types[key],selector)}return this}if(name==="die"&&!types&&origSelector&&origSelector.charAt(0)==="."){context.unbind(origSelector);return this}if(data===false||jQuery.isFunction(data)){fn=data||returnFalse;data=undefined}types=(types||"").split(" ");while((type=types[i++])!=null){match=rnamespaces.exec(type);namespaces="";if(match){namespaces=match[0];type=type.replace(rnamespaces,"")}if(type==="hover"){types.push("mouseenter"+namespaces,"mouseleave"+namespaces);continue}preType=type;if(liveMap[type]){types.push(liveMap[type]+namespaces);type=type+namespaces}else{type=(liveMap[type]||type)+namespaces}if(name==="live"){for(var j=0,l=context.length;j<l;j++){jQuery.event.add(context[j],"live."+liveConvert(type,selector),{data:data,selector:selector,handler:fn,origType:type,origHandler:fn,preType:preType})}}else{context.unbind("live."+liveConvert(type,selector),fn)}}return this}});function liveHandler(event){var stop,maxLevel,related,match,handleObj,elem,j,i,l,data,close,namespace,ret,elems=[],selectors=[],events=jQuery._data(this,"events");if(event.liveFired===this||!events||!events.live||event.target.disabled||event.button&&event.type==="click"){return}if(event.namespace){namespace=new RegExp("(^|\\.)"+event.namespace.split(".").join("\\.(?:.*\\.)?")+"(\\.|$)")}event.liveFired=this;var live=events.live.slice(0);for(j=0;j<live.length;j++){handleObj=live[j];if(handleObj.origType.replace(rnamespaces,"")===event.type){selectors.push(handleObj.selector)}else{live.splice(j--,1)}}match=jQuery(event.target).closest(selectors,event.currentTarget);for(i=0,l=match.length;i<l;i++){close=match[i];for(j=0;j<live.length;j++){handleObj=live[j];if(close.selector===handleObj.selector&&(!namespace||namespace.test(handleObj.namespace))&&!close.elem.disabled){elem=close.elem;related=null;if(handleObj.preType==="mouseenter"||handleObj.preType==="mouseleave"){event.type=handleObj.preType;related=jQuery(event.relatedTarget).closest(handleObj.selector)[0];if(related&&jQuery.contains(elem,related)){related=elem}}if(!related||related!==elem){elems.push({elem:elem,handleObj:handleObj,level:close.level})}}}}for(i=0,l=elems.length;i<l;i++){match=elems[i];if(maxLevel&&match.level>maxLevel){break}event.currentTarget=match.elem;event.data=match.handleObj.data;event.handleObj=match.handleObj;ret=match.handleObj.origHandler.apply(match.elem,arguments);if(ret===false||event.isPropagationStopped()){maxLevel=match.level;if(ret===false){stop=false}if(event.isImmediatePropagationStopped()){break}}}return stop}function liveConvert(type,selector){return(type&&type!=="*"?type+".":"")+selector.replace(rperiod,"`").replace(rspaces,"&")}jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error").split(" "),function(i,name){jQuery.fn[name]=function(data,fn){if(fn==null){fn=data;data=null}return arguments.length>0?this.bind(name,data,fn):this.trigger(name)};if(jQuery.attrFn){jQuery.attrFn[name]=true}});
/*!
 * Sizzle CSS Selector Engine
 *  Copyright 2011, The Dojo Foundation
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://sizzlejs.com/
 */
(function(){var chunker=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,done=0,toString=Object.prototype.toString,hasDuplicate=false,baseHasDuplicate=true,rBackslash=/\\/g,rNonWord=/\W/;[0,0].sort(function(){baseHasDuplicate=false;return 0});var Sizzle=function(selector,context,results,seed){results=results||[];context=context||document;var origContext=context;if(context.nodeType!==1&&context.nodeType!==9){return[]}if(!selector||typeof selector!=="string"){return results}var m,set,checkSet,extra,ret,cur,pop,i,prune=true,contextXML=Sizzle.isXML(context),parts=[],soFar=selector;do{chunker.exec("");m=chunker.exec(soFar);if(m){soFar=m[3];parts.push(m[1]);if(m[2]){extra=m[3];break}}}while(m);if(parts.length>1&&origPOS.exec(selector)){if(parts.length===2&&Expr.relative[parts[0]]){set=posProcess(parts[0]+parts[1],context)}else{set=Expr.relative[parts[0]]?[context]:Sizzle(parts.shift(),context);while(parts.length){selector=parts.shift();if(Expr.relative[selector]){selector+=parts.shift()}set=posProcess(selector,set)}}}else{if(!seed&&parts.length>1&&context.nodeType===9&&!contextXML&&Expr.match.ID.test(parts[0])&&!Expr.match.ID.test(parts[parts.length-1])){ret=Sizzle.find(parts.shift(),context,contextXML);context=ret.expr?Sizzle.filter(ret.expr,ret.set)[0]:ret.set[0]}if(context){ret=seed?{expr:parts.pop(),set:makeArray(seed)}:Sizzle.find(parts.pop(),parts.length===1&&(parts[0]==="~"||parts[0]==="+")&&context.parentNode?context.parentNode:context,contextXML);set=ret.expr?Sizzle.filter(ret.expr,ret.set):ret.set;if(parts.length>0){checkSet=makeArray(set)}else{prune=false}while(parts.length){cur=parts.pop();pop=cur;if(!Expr.relative[cur]){cur=""}else{pop=parts.pop()}if(pop==null){pop=context}Expr.relative[cur](checkSet,pop,contextXML)}}else{checkSet=parts=[]}}if(!checkSet){checkSet=set}if(!checkSet){Sizzle.error(cur||selector)}if(toString.call(checkSet)==="[object Array]"){if(!prune){results.push.apply(results,checkSet)}else{if(context&&context.nodeType===1){for(i=0;checkSet[i]!=null;i++){if(checkSet[i]&&(checkSet[i]===true||checkSet[i].nodeType===1&&Sizzle.contains(context,checkSet[i]))){results.push(set[i])}}}else{for(i=0;checkSet[i]!=null;i++){if(checkSet[i]&&checkSet[i].nodeType===1){results.push(set[i])}}}}}else{makeArray(checkSet,results)}if(extra){Sizzle(extra,origContext,results,seed);Sizzle.uniqueSort(results)}return results};Sizzle.uniqueSort=function(results){if(sortOrder){hasDuplicate=baseHasDuplicate;results.sort(sortOrder);if(hasDuplicate){for(var i=1;i<results.length;i++){if(results[i]===results[i-1]){results.splice(i--,1)}}}}return results};Sizzle.matches=function(expr,set){return Sizzle(expr,null,null,set)};Sizzle.matchesSelector=function(node,expr){return Sizzle(expr,null,null,[node]).length>0};Sizzle.find=function(expr,context,isXML){var set;if(!expr){return[]}for(var i=0,l=Expr.order.length;i<l;i++){var match,type=Expr.order[i];if((match=Expr.leftMatch[type].exec(expr))){var left=match[1];match.splice(1,1);if(left.substr(left.length-1)!=="\\"){match[1]=(match[1]||"").replace(rBackslash,"");set=Expr.find[type](match,context,isXML);if(set!=null){expr=expr.replace(Expr.match[type],"");break}}}}if(!set){set=typeof context.getElementsByTagName!=="undefined"?context.getElementsByTagName("*"):[]}return{set:set,expr:expr}};Sizzle.filter=function(expr,set,inplace,not){var match,anyFound,old=expr,result=[],curLoop=set,isXMLFilter=set&&set[0]&&Sizzle.isXML(set[0]);while(expr&&set.length){for(var type in Expr.filter){if((match=Expr.leftMatch[type].exec(expr))!=null&&match[2]){var found,item,filter=Expr.filter[type],left=match[1];anyFound=false;match.splice(1,1);if(left.substr(left.length-1)==="\\"){continue}if(curLoop===result){result=[]}if(Expr.preFilter[type]){match=Expr.preFilter[type](match,curLoop,inplace,result,not,isXMLFilter);if(!match){anyFound=found=true}else{if(match===true){continue}}}if(match){for(var i=0;(item=curLoop[i])!=null;i++){if(item){found=filter(item,match,i,curLoop);var pass=not^!!found;if(inplace&&found!=null){if(pass){anyFound=true}else{curLoop[i]=false}}else{if(pass){result.push(item);anyFound=true}}}}}if(found!==undefined){if(!inplace){curLoop=result}expr=expr.replace(Expr.match[type],"");if(!anyFound){return[]}break}}}if(expr===old){if(anyFound==null){Sizzle.error(expr)}else{break}}old=expr}return curLoop};Sizzle.error=function(msg){throw"Syntax error, unrecognized expression: "+msg};var Expr=Sizzle.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(elem){return elem.getAttribute("href")},type:function(elem){return elem.getAttribute("type")}},relative:{"+":function(checkSet,part){var isPartStr=typeof part==="string",isTag=isPartStr&&!rNonWord.test(part),isPartStrNotTag=isPartStr&&!isTag;if(isTag){part=part.toLowerCase()}for(var i=0,l=checkSet.length,elem;i<l;i++){if((elem=checkSet[i])){while((elem=elem.previousSibling)&&elem.nodeType!==1){}checkSet[i]=isPartStrNotTag||elem&&elem.nodeName.toLowerCase()===part?elem||false:elem===part}}if(isPartStrNotTag){Sizzle.filter(part,checkSet,true)}},">":function(checkSet,part){var elem,isPartStr=typeof part==="string",i=0,l=checkSet.length;if(isPartStr&&!rNonWord.test(part)){part=part.toLowerCase();for(;i<l;i++){elem=checkSet[i];if(elem){var parent=elem.parentNode;checkSet[i]=parent.nodeName.toLowerCase()===part?parent:false}}}else{for(;i<l;i++){elem=checkSet[i];if(elem){checkSet[i]=isPartStr?elem.parentNode:elem.parentNode===part}}if(isPartStr){Sizzle.filter(part,checkSet,true)}}},"":function(checkSet,part,isXML){var nodeCheck,doneName=done++,checkFn=dirCheck;if(typeof part==="string"&&!rNonWord.test(part)){part=part.toLowerCase();nodeCheck=part;checkFn=dirNodeCheck}checkFn("parentNode",part,doneName,checkSet,nodeCheck,isXML)},"~":function(checkSet,part,isXML){var nodeCheck,doneName=done++,checkFn=dirCheck;if(typeof part==="string"&&!rNonWord.test(part)){part=part.toLowerCase();nodeCheck=part;checkFn=dirNodeCheck}checkFn("previousSibling",part,doneName,checkSet,nodeCheck,isXML)}},find:{ID:function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m&&m.parentNode?[m]:[]}},NAME:function(match,context){if(typeof context.getElementsByName!=="undefined"){var ret=[],results=context.getElementsByName(match[1]);for(var i=0,l=results.length;i<l;i++){if(results[i].getAttribute("name")===match[1]){ret.push(results[i])}}return ret.length===0?null:ret}},TAG:function(match,context){if(typeof context.getElementsByTagName!=="undefined"){return context.getElementsByTagName(match[1])}}},preFilter:{CLASS:function(match,curLoop,inplace,result,not,isXML){match=" "+match[1].replace(rBackslash,"")+" ";if(isXML){return match}for(var i=0,elem;(elem=curLoop[i])!=null;i++){if(elem){if(not^(elem.className&&(" "+elem.className+" ").replace(/[\t\n\r]/g," ").indexOf(match)>=0)){if(!inplace){result.push(elem)}}else{if(inplace){curLoop[i]=false}}}}return false},ID:function(match){return match[1].replace(rBackslash,"")},TAG:function(match,curLoop){return match[1].replace(rBackslash,"").toLowerCase()},CHILD:function(match){if(match[1]==="nth"){if(!match[2]){Sizzle.error(match[0])}match[2]=match[2].replace(/^\+|\s*/g,"");var test=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(match[2]==="even"&&"2n"||match[2]==="odd"&&"2n+1"||!/\D/.test(match[2])&&"0n+"+match[2]||match[2]);match[2]=(test[1]+(test[2]||1))-0;match[3]=test[3]-0}else{if(match[2]){Sizzle.error(match[0])}}match[0]=done++;return match},ATTR:function(match,curLoop,inplace,result,not,isXML){var name=match[1]=match[1].replace(rBackslash,"");if(!isXML&&Expr.attrMap[name]){match[1]=Expr.attrMap[name]}match[4]=(match[4]||match[5]||"").replace(rBackslash,"");if(match[2]==="~="){match[4]=" "+match[4]+" "}return match},PSEUDO:function(match,curLoop,inplace,result,not){if(match[1]==="not"){if((chunker.exec(match[3])||"").length>1||/^\w/.test(match[3])){match[3]=Sizzle(match[3],null,null,curLoop)}else{var ret=Sizzle.filter(match[3],curLoop,inplace,true^not);if(!inplace){result.push.apply(result,ret)}return false}}else{if(Expr.match.POS.test(match[0])||Expr.match.CHILD.test(match[0])){return true}}return match},POS:function(match){match.unshift(true);return match}},filters:{enabled:function(elem){return elem.disabled===false&&elem.type!=="hidden"},disabled:function(elem){return elem.disabled===true},checked:function(elem){return elem.checked===true},selected:function(elem){if(elem.parentNode){elem.parentNode.selectedIndex}return elem.selected===true},parent:function(elem){return !!elem.firstChild},empty:function(elem){return !elem.firstChild},has:function(elem,i,match){return !!Sizzle(match[3],elem).length},header:function(elem){return(/h\d/i).test(elem.nodeName)},text:function(elem){var attr=elem.getAttribute("type"),type=elem.type;return elem.nodeName.toLowerCase()==="input"&&"text"===type&&(attr===type||attr===null)},radio:function(elem){return elem.nodeName.toLowerCase()==="input"&&"radio"===elem.type},checkbox:function(elem){return elem.nodeName.toLowerCase()==="input"&&"checkbox"===elem.type},file:function(elem){return elem.nodeName.toLowerCase()==="input"&&"file"===elem.type},password:function(elem){return elem.nodeName.toLowerCase()==="input"&&"password"===elem.type},submit:function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&"submit"===elem.type},image:function(elem){return elem.nodeName.toLowerCase()==="input"&&"image"===elem.type},reset:function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&"reset"===elem.type},button:function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&"button"===elem.type||name==="button"},input:function(elem){return(/input|select|textarea|button/i).test(elem.nodeName)},focus:function(elem){return elem===elem.ownerDocument.activeElement}},setFilters:{first:function(elem,i){return i===0},last:function(elem,i,match,array){return i===array.length-1},even:function(elem,i){return i%2===0},odd:function(elem,i){return i%2===1},lt:function(elem,i,match){return i<match[3]-0},gt:function(elem,i,match){return i>match[3]-0},nth:function(elem,i,match){return match[3]-0===i},eq:function(elem,i,match){return match[3]-0===i}},filter:{PSEUDO:function(elem,match,i,array){var name=match[1],filter=Expr.filters[name];if(filter){return filter(elem,i,match,array)}else{if(name==="contains"){return(elem.textContent||elem.innerText||Sizzle.getText([elem])||"").indexOf(match[3])>=0}else{if(name==="not"){var not=match[3];for(var j=0,l=not.length;j<l;j++){if(not[j]===elem){return false}}return true}else{Sizzle.error(name)}}}},CHILD:function(elem,match){var type=match[1],node=elem;switch(type){case"only":case"first":while((node=node.previousSibling)){if(node.nodeType===1){return false}}if(type==="first"){return true}node=elem;case"last":while((node=node.nextSibling)){if(node.nodeType===1){return false}}return true;case"nth":var first=match[2],last=match[3];if(first===1&&last===0){return true}var doneName=match[0],parent=elem.parentNode;if(parent&&(parent.sizcache!==doneName||!elem.nodeIndex)){var count=0;for(node=parent.firstChild;node;node=node.nextSibling){if(node.nodeType===1){node.nodeIndex=++count}}parent.sizcache=doneName}var diff=elem.nodeIndex-last;if(first===0){return diff===0}else{return(diff%first===0&&diff/first>=0)}}},ID:function(elem,match){return elem.nodeType===1&&elem.getAttribute("id")===match},TAG:function(elem,match){return(match==="*"&&elem.nodeType===1)||elem.nodeName.toLowerCase()===match},CLASS:function(elem,match){return(" "+(elem.className||elem.getAttribute("class"))+" ").indexOf(match)>-1},ATTR:function(elem,match){var name=match[1],result=Expr.attrHandle[name]?Expr.attrHandle[name](elem):elem[name]!=null?elem[name]:elem.getAttribute(name),value=result+"",type=match[2],check=match[4];return result==null?type==="!=":type==="="?value===check:type==="*="?value.indexOf(check)>=0:type==="~="?(" "+value+" ").indexOf(check)>=0:!check?value&&result!==false:type==="!="?value!==check:type==="^="?value.indexOf(check)===0:type==="$="?value.substr(value.length-check.length)===check:type==="|="?value===check||value.substr(0,check.length+1)===check+"-":false},POS:function(elem,match,i,array){var name=match[2],filter=Expr.setFilters[name];if(filter){return filter(elem,i,match,array)}}}};var origPOS=Expr.match.POS,fescape=function(all,num){return"\\"+(num-0+1)};for(var type in Expr.match){Expr.match[type]=new RegExp(Expr.match[type].source+(/(?![^\[]*\])(?![^\(]*\))/.source));Expr.leftMatch[type]=new RegExp(/(^(?:.|\r|\n)*?)/.source+Expr.match[type].source.replace(/\\(\d+)/g,fescape))}var makeArray=function(array,results){array=Array.prototype.slice.call(array,0);if(results){results.push.apply(results,array);return results}return array};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(e){makeArray=function(array,results){var i=0,ret=results||[];if(toString.call(array)==="[object Array]"){Array.prototype.push.apply(ret,array)}else{if(typeof array.length==="number"){for(var l=array.length;i<l;i++){ret.push(array[i])}}else{for(;array[i];i++){ret.push(array[i])}}}return ret}}var sortOrder,siblingCheck;if(document.documentElement.compareDocumentPosition){sortOrder=function(a,b){if(a===b){hasDuplicate=true;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition){return a.compareDocumentPosition?-1:1}return a.compareDocumentPosition(b)&4?-1:1}}else{sortOrder=function(a,b){if(a===b){hasDuplicate=true;return 0}else{if(a.sourceIndex&&b.sourceIndex){return a.sourceIndex-b.sourceIndex}}var al,bl,ap=[],bp=[],aup=a.parentNode,bup=b.parentNode,cur=aup;if(aup===bup){return siblingCheck(a,b)}else{if(!aup){return -1}else{if(!bup){return 1}}}while(cur){ap.unshift(cur);cur=cur.parentNode}cur=bup;while(cur){bp.unshift(cur);cur=cur.parentNode}al=ap.length;bl=bp.length;for(var i=0;i<al&&i<bl;i++){if(ap[i]!==bp[i]){return siblingCheck(ap[i],bp[i])}}return i===al?siblingCheck(a,bp[i],-1):siblingCheck(ap[i],b,1)};siblingCheck=function(a,b,ret){if(a===b){return ret}var cur=a.nextSibling;while(cur){if(cur===b){return -1}cur=cur.nextSibling}return 1}}Sizzle.getText=function(elems){var ret="",elem;for(var i=0;elems[i];i++){elem=elems[i];if(elem.nodeType===3||elem.nodeType===4){ret+=elem.nodeValue}else{if(elem.nodeType!==8){ret+=Sizzle.getText(elem.childNodes)}}}return ret};(function(){var form=document.createElement("div"),id="script"+(new Date()).getTime(),root=document.documentElement;form.innerHTML="<a name='"+id+"'/>";root.insertBefore(form,root.firstChild);if(document.getElementById(id)){Expr.find.ID=function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m?m.id===match[1]||typeof m.getAttributeNode!=="undefined"&&m.getAttributeNode("id").nodeValue===match[1]?[m]:undefined:[]}};Expr.filter.ID=function(elem,match){var node=typeof elem.getAttributeNode!=="undefined"&&elem.getAttributeNode("id");return elem.nodeType===1&&node&&node.nodeValue===match}}root.removeChild(form);root=form=null})();(function(){var div=document.createElement("div");div.appendChild(document.createComment(""));if(div.getElementsByTagName("*").length>0){Expr.find.TAG=function(match,context){var results=context.getElementsByTagName(match[1]);if(match[1]==="*"){var tmp=[];for(var i=0;results[i];i++){if(results[i].nodeType===1){tmp.push(results[i])}}results=tmp}return results}}div.innerHTML="<a href='#'></a>";if(div.firstChild&&typeof div.firstChild.getAttribute!=="undefined"&&div.firstChild.getAttribute("href")!=="#"){Expr.attrHandle.href=function(elem){return elem.getAttribute("href",2)}}div=null})();if(document.querySelectorAll){(function(){var oldSizzle=Sizzle,div=document.createElement("div"),id="__sizzle__";div.innerHTML="<p class='TEST'></p>";if(div.querySelectorAll&&div.querySelectorAll(".TEST").length===0){return}Sizzle=function(query,context,extra,seed){context=context||document;if(!seed&&!Sizzle.isXML(context)){var match=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(query);if(match&&(context.nodeType===1||context.nodeType===9)){if(match[1]){return makeArray(context.getElementsByTagName(query),extra)}else{if(match[2]&&Expr.find.CLASS&&context.getElementsByClassName){return makeArray(context.getElementsByClassName(match[2]),extra)}}}if(context.nodeType===9){if(query==="body"&&context.body){return makeArray([context.body],extra)}else{if(match&&match[3]){var elem=context.getElementById(match[3]);if(elem&&elem.parentNode){if(elem.id===match[3]){return makeArray([elem],extra)}}else{return makeArray([],extra)}}}try{return makeArray(context.querySelectorAll(query),extra)}catch(qsaError){}}else{if(context.nodeType===1&&context.nodeName.toLowerCase()!=="object"){var oldContext=context,old=context.getAttribute("id"),nid=old||id,hasParent=context.parentNode,relativeHierarchySelector=/^\s*[+~]/.test(query);if(!old){context.setAttribute("id",nid)}else{nid=nid.replace(/'/g,"\\$&")}if(relativeHierarchySelector&&hasParent){context=context.parentNode}try{if(!relativeHierarchySelector||hasParent){return makeArray(context.querySelectorAll("[id='"+nid+"'] "+query),extra)}}catch(pseudoError){}finally{if(!old){oldContext.removeAttribute("id")}}}}}return oldSizzle(query,context,extra,seed)};for(var prop in oldSizzle){Sizzle[prop]=oldSizzle[prop]}div=null})()}(function(){var html=document.documentElement,matches=html.matchesSelector||html.mozMatchesSelector||html.webkitMatchesSelector||html.msMatchesSelector;if(matches){var disconnectedMatch=!matches.call(document.createElement("div"),"div"),pseudoWorks=false;try{matches.call(document.documentElement,"[test!='']:sizzle")}catch(pseudoError){pseudoWorks=true}Sizzle.matchesSelector=function(node,expr){expr=expr.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!Sizzle.isXML(node)){try{if(pseudoWorks||!Expr.match.PSEUDO.test(expr)&&!/!=/.test(expr)){var ret=matches.call(node,expr);if(ret||!disconnectedMatch||node.document&&node.document.nodeType!==11){return ret}}}catch(e){}}return Sizzle(expr,null,null,[node]).length>0}}})();(function(){var div=document.createElement("div");div.innerHTML="<div class='test e'></div><div class='test'></div>";if(!div.getElementsByClassName||div.getElementsByClassName("e").length===0){return}div.lastChild.className="e";if(div.getElementsByClassName("e").length===1){return}Expr.order.splice(1,0,"CLASS");Expr.find.CLASS=function(match,context,isXML){if(typeof context.getElementsByClassName!=="undefined"&&!isXML){return context.getElementsByClassName(match[1])}};div=null})();function dirNodeCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){var match=false;elem=elem[dir];while(elem){if(elem.sizcache===doneName){match=checkSet[elem.sizset];break}if(elem.nodeType===1&&!isXML){elem.sizcache=doneName;elem.sizset=i}if(elem.nodeName.toLowerCase()===cur){match=elem;break}elem=elem[dir]}checkSet[i]=match}}}function dirCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){var match=false;elem=elem[dir];while(elem){if(elem.sizcache===doneName){match=checkSet[elem.sizset];break}if(elem.nodeType===1){if(!isXML){elem.sizcache=doneName;elem.sizset=i}if(typeof cur!=="string"){if(elem===cur){match=true;break}}else{if(Sizzle.filter(cur,[elem]).length>0){match=elem;break}}}elem=elem[dir]}checkSet[i]=match}}}if(document.documentElement.contains){Sizzle.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):true)}}else{if(document.documentElement.compareDocumentPosition){Sizzle.contains=function(a,b){return !!(a.compareDocumentPosition(b)&16)}}else{Sizzle.contains=function(){return false}}}Sizzle.isXML=function(elem){var documentElement=(elem?elem.ownerDocument||elem:0).documentElement;return documentElement?documentElement.nodeName!=="HTML":false};var posProcess=function(selector,context){var match,tmpSet=[],later="",root=context.nodeType?[context]:context;while((match=Expr.match.PSEUDO.exec(selector))){later+=match[0];selector=selector.replace(Expr.match.PSEUDO,"")}selector=Expr.relative[selector]?selector+"*":selector;for(var i=0,l=root.length;i<l;i++){Sizzle(selector,root[i],tmpSet)}return Sizzle.filter(later,tmpSet)};jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.filters;jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains})();var runtil=/Until$/,rparentsprev=/^(?:parents|prevUntil|prevAll)/,rmultiselector=/,/,isSimple=/^.[^:#\[\.,]*$/,slice=Array.prototype.slice,POS=jQuery.expr.match.POS,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.fn.extend({find:function(selector){var self=this,i,l;if(typeof selector!=="string"){return jQuery(selector).filter(function(){for(i=0,l=self.length;i<l;i++){if(jQuery.contains(self[i],this)){return true}}})}var ret=this.pushStack("","find",selector),length,n,r;for(i=0,l=this.length;i<l;i++){length=ret.length;jQuery.find(selector,this[i],ret);if(i>0){for(n=length;n<ret.length;n++){for(r=0;r<length;r++){if(ret[r]===ret[n]){ret.splice(n--,1);break}}}}}return ret},has:function(target){var targets=jQuery(target);return this.filter(function(){for(var i=0,l=targets.length;i<l;i++){if(jQuery.contains(this,targets[i])){return true}}})},not:function(selector){return this.pushStack(winnow(this,selector,false),"not",selector)},filter:function(selector){return this.pushStack(winnow(this,selector,true),"filter",selector)},is:function(selector){return !!selector&&(typeof selector==="string"?jQuery.filter(selector,this).length>0:this.filter(selector).length>0)},closest:function(selectors,context){var ret=[],i,l,cur=this[0];if(jQuery.isArray(selectors)){var match,selector,matches={},level=1;if(cur&&selectors.length){for(i=0,l=selectors.length;i<l;i++){selector=selectors[i];if(!matches[selector]){matches[selector]=POS.test(selector)?jQuery(selector,context||this.context):selector}}while(cur&&cur.ownerDocument&&cur!==context){for(selector in matches){match=matches[selector];if(match.jquery?match.index(cur)>-1:jQuery(cur).is(match)){ret.push({selector:selector,elem:cur,level:level})}}cur=cur.parentNode;level++}}return ret}var pos=POS.test(selectors)||typeof selectors!=="string"?jQuery(selectors,context||this.context):0;for(i=0,l=this.length;i<l;i++){cur=this[i];while(cur){if(pos?pos.index(cur)>-1:jQuery.find.matchesSelector(cur,selectors)){ret.push(cur);break}else{cur=cur.parentNode;if(!cur||!cur.ownerDocument||cur===context||cur.nodeType===11){break}}}}ret=ret.length>1?jQuery.unique(ret):ret;return this.pushStack(ret,"closest",selectors)},index:function(elem){if(!elem||typeof elem==="string"){return jQuery.inArray(this[0],elem?jQuery(elem):this.parent().children())}return jQuery.inArray(elem.jquery?elem[0]:elem,this)},add:function(selector,context){var set=typeof selector==="string"?jQuery(selector,context):jQuery.makeArray(selector&&selector.nodeType?[selector]:selector),all=jQuery.merge(this.get(),set);return this.pushStack(isDisconnected(set[0])||isDisconnected(all[0])?all:jQuery.unique(all))},andSelf:function(){return this.add(this.prevObject)}});function isDisconnected(node){return !node||!node.parentNode||node.parentNode.nodeType===11}jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return jQuery.nth(elem,2,"nextSibling")},prev:function(elem){return jQuery.nth(elem,2,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling(elem.parentNode.firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.makeArray(elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until),args=slice.call(arguments);if(!runtil.test(name)){selector=until}if(selector&&typeof selector==="string"){ret=jQuery.filter(selector,ret)}ret=this.length>1&&!guaranteedUnique[name]?jQuery.unique(ret):ret;if((this.length>1||rmultiselector.test(selector))&&rparentsprev.test(name)){ret=ret.reverse()}return this.pushStack(ret,name,args.join(","))}});jQuery.extend({filter:function(expr,elems,not){if(not){expr=":not("+expr+")"}return elems.length===1?jQuery.find.matchesSelector(elems[0],expr)?[elems[0]]:[]:jQuery.find.matches(expr,elems)},dir:function(elem,dir,until){var matched=[],cur=elem[dir];while(cur&&cur.nodeType!==9&&(until===undefined||cur.nodeType!==1||!jQuery(cur).is(until))){if(cur.nodeType===1){matched.push(cur)}cur=cur[dir]}return matched},nth:function(cur,result,dir,elem){result=result||1;var num=0;for(;cur;cur=cur[dir]){if(cur.nodeType===1&&++num===result){break}}return cur},sibling:function(n,elem){var r=[];for(;n;n=n.nextSibling){if(n.nodeType===1&&n!==elem){r.push(n)}}return r}});function winnow(elements,qualifier,keep){qualifier=qualifier||0;if(jQuery.isFunction(qualifier)){return jQuery.grep(elements,function(elem,i){var retVal=!!qualifier.call(elem,i,elem);return retVal===keep})}else{if(qualifier.nodeType){return jQuery.grep(elements,function(elem,i){return(elem===qualifier)===keep})}else{if(typeof qualifier==="string"){var filtered=jQuery.grep(elements,function(elem){return elem.nodeType===1});if(isSimple.test(qualifier)){return jQuery.filter(qualifier,filtered,!keep)}else{qualifier=jQuery.filter(qualifier,filtered)}}}}return jQuery.grep(elements,function(elem,i){return(jQuery.inArray(elem,qualifier)>=0)===keep})}var rinlinejQuery=/ jQuery\d+="(?:\d+|null)"/g,rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnocache=/<(?:script|object|embed|option|style)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/\/(java|ecma)script/i,rcleanScript=/^\s*<!(?:\[CDATA\[|\-\-)/,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;if(!jQuery.support.htmlSerialize){wrapMap._default=[1,"div<div>","</div>"]}jQuery.fn.extend({text:function(text){if(jQuery.isFunction(text)){return this.each(function(i){var self=jQuery(this);self.text(text.call(this,i,self.text()))})}if(typeof text!=="object"&&text!==undefined){return this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(text))}return jQuery.text(this)},wrapAll:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))})}if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){wrap.insertBefore(this[0])}wrap.map(function(){var elem=this;while(elem.firstChild&&elem.firstChild.nodeType===1){elem=elem.firstChild}return elem}).append(this)}return this},wrapInner:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this,i))})}return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length){contents.wrapAll(html)}else{self.append(html)}})},wrap:function(html){return this.each(function(){jQuery(this).wrapAll(html)})},unwrap:function(){return this.parent().each(function(){if(!jQuery.nodeName(this,"body")){jQuery(this).replaceWith(this.childNodes)}}).end()},append:function(){return this.domManip(arguments,true,function(elem){if(this.nodeType===1){this.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,true,function(elem){if(this.nodeType===1){this.insertBefore(elem,this.firstChild)}})},before:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(elem){this.parentNode.insertBefore(elem,this)})}else{if(arguments.length){var set=jQuery(arguments[0]);set.push.apply(set,this.toArray());return this.pushStack(set,"before",arguments)}}},after:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(elem){this.parentNode.insertBefore(elem,this.nextSibling)})}else{if(arguments.length){var set=this.pushStack(this,"after",arguments);set.push.apply(set,jQuery(arguments[0]).toArray());return set}}},remove:function(selector,keepData){for(var i=0,elem;(elem=this[i])!=null;i++){if(!selector||jQuery.filter(selector,[elem]).length){if(!keepData&&elem.nodeType===1){jQuery.cleanData(elem.getElementsByTagName("*"));jQuery.cleanData([elem])}if(elem.parentNode){elem.parentNode.removeChild(elem)}}}return this},empty:function(){for(var i=0,elem;(elem=this[i])!=null;i++){if(elem.nodeType===1){jQuery.cleanData(elem.getElementsByTagName("*"))}while(elem.firstChild){elem.removeChild(elem.firstChild)}}return this},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){if(value===undefined){return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(rinlinejQuery,""):null}else{if(typeof value==="string"&&!rnocache.test(value)&&(jQuery.support.leadingWhitespace||!rleadingWhitespace.test(value))&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(var i=0,l=this.length;i<l;i++){if(this[i].nodeType===1){jQuery.cleanData(this[i].getElementsByTagName("*"));this[i].innerHTML=value}}}catch(e){this.empty().append(value)}}else{if(jQuery.isFunction(value)){this.each(function(i){var self=jQuery(this);self.html(value.call(this,i,self.html()))})}else{this.empty().append(value)}}}return this},replaceWith:function(value){if(this[0]&&this[0].parentNode){if(jQuery.isFunction(value)){return this.each(function(i){var self=jQuery(this),old=self.html();self.replaceWith(value.call(this,i,old))})}if(typeof value!=="string"){value=jQuery(value).detach()}return this.each(function(){var next=this.nextSibling,parent=this.parentNode;jQuery(this).remove();if(next){jQuery(next).before(value)}else{jQuery(parent).append(value)}})}else{return this.length?this.pushStack(jQuery(jQuery.isFunction(value)?value():value),"replaceWith",value):this}},detach:function(selector){return this.remove(selector,true)},domManip:function(args,table,callback){var results,first,fragment,parent,value=args[0],scripts=[];if(!jQuery.support.checkClone&&arguments.length===3&&typeof value==="string"&&rchecked.test(value)){return this.each(function(){jQuery(this).domManip(args,table,callback,true)})}if(jQuery.isFunction(value)){return this.each(function(i){var self=jQuery(this);args[0]=value.call(this,i,table?self.html():undefined);self.domManip(args,table,callback)})}if(this[0]){parent=value&&value.parentNode;if(jQuery.support.parentNode&&parent&&parent.nodeType===11&&parent.childNodes.length===this.length){results={fragment:parent}}else{results=jQuery.buildFragment(args,this,scripts)}fragment=results.fragment;if(fragment.childNodes.length===1){first=fragment=fragment.firstChild}else{first=fragment.firstChild}if(first){table=table&&jQuery.nodeName(first,"tr");for(var i=0,l=this.length,lastIndex=l-1;i<l;i++){callback.call(table?root(this[i],first):this[i],results.cacheable||(l>1&&i<lastIndex)?jQuery.clone(fragment,true,true):fragment)}}if(scripts.length){jQuery.each(scripts,evalScript)}}return this}});function root(elem,cur){return jQuery.nodeName(elem,"table")?(elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody"))):elem}function cloneCopyEvent(src,dest){if(dest.nodeType!==1||!jQuery.hasData(src)){return}var internalKey=jQuery.expando,oldData=jQuery.data(src),curData=jQuery.data(dest,oldData);if((oldData=oldData[internalKey])){var events=oldData.events;curData=curData[internalKey]=jQuery.extend({},oldData);if(events){delete curData.handle;curData.events={};for(var type in events){for(var i=0,l=events[type].length;i<l;i++){jQuery.event.add(dest,type+(events[type][i].namespace?".":"")+events[type][i].namespace,events[type][i],events[type][i].data)}}}}}function cloneFixAttributes(src,dest){var nodeName;if(dest.nodeType!==1){return}if(dest.clearAttributes){dest.clearAttributes()}if(dest.mergeAttributes){dest.mergeAttributes(src)}nodeName=dest.nodeName.toLowerCase();if(nodeName==="object"){dest.outerHTML=src.outerHTML}else{if(nodeName==="input"&&(src.type==="checkbox"||src.type==="radio")){if(src.checked){dest.defaultChecked=dest.checked=src.checked}if(dest.value!==src.value){dest.value=src.value}}else{if(nodeName==="option"){dest.selected=src.defaultSelected}else{if(nodeName==="input"||nodeName==="textarea"){dest.defaultValue=src.defaultValue}}}}dest.removeAttribute(jQuery.expando)}jQuery.buildFragment=function(args,nodes,scripts){var fragment,cacheable,cacheresults,doc=(nodes&&nodes[0]?nodes[0].ownerDocument||nodes[0]:document);if(args.length===1&&typeof args[0]==="string"&&args[0].length<512&&doc===document&&args[0].charAt(0)==="<"&&!rnocache.test(args[0])&&(jQuery.support.checkClone||!rchecked.test(args[0]))){cacheable=true;cacheresults=jQuery.fragments[args[0]];if(cacheresults&&cacheresults!==1){fragment=cacheresults}}if(!fragment){fragment=doc.createDocumentFragment();jQuery.clean(args,doc,fragment,scripts)}if(cacheable){jQuery.fragments[args[0]]=cacheresults?fragment:1}return{fragment:fragment,cacheable:cacheable}};jQuery.fragments={};jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var ret=[],insert=jQuery(selector),parent=this.length===1&&this[0].parentNode;if(parent&&parent.nodeType===11&&parent.childNodes.length===1&&insert.length===1){insert[original](this[0]);return this}else{for(var i=0,l=insert.length;i<l;i++){var elems=(i>0?this.clone(true):this).get();jQuery(insert[i])[original](elems);ret=ret.concat(elems)}return this.pushStack(ret,name,insert.selector)}}});function getAll(elem){if("getElementsByTagName" in elem){return elem.getElementsByTagName("*")}else{if("querySelectorAll" in elem){return elem.querySelectorAll("*")}else{return[]}}}function fixDefaultChecked(elem){if(elem.type==="checkbox"||elem.type==="radio"){elem.defaultChecked=elem.checked}}function findInputs(elem){if(jQuery.nodeName(elem,"input")){fixDefaultChecked(elem)}else{if(elem.getElementsByTagName){jQuery.grep(elem.getElementsByTagName("input"),fixDefaultChecked)}}}jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var clone=elem.cloneNode(true),srcElements,destElements,i;if((!jQuery.support.noCloneEvent||!jQuery.support.noCloneChecked)&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){cloneFixAttributes(elem,clone);srcElements=getAll(elem);destElements=getAll(clone);for(i=0;srcElements[i];++i){cloneFixAttributes(srcElements[i],destElements[i])}}if(dataAndEvents){cloneCopyEvent(elem,clone);if(deepDataAndEvents){srcElements=getAll(elem);destElements=getAll(clone);for(i=0;srcElements[i];++i){cloneCopyEvent(srcElements[i],destElements[i])}}}return clone},clean:function(elems,context,fragment,scripts){var checkScriptType;context=context||document;if(typeof context.createElement==="undefined"){context=context.ownerDocument||context[0]&&context[0].ownerDocument||document}var ret=[],j;for(var i=0,elem;(elem=elems[i])!=null;i++){if(typeof elem==="number"){elem+=""}if(!elem){continue}if(typeof elem==="string"){if(!rhtml.test(elem)){elem=context.createTextNode(elem)}else{elem=elem.replace(rxhtmlTag,"<$1></$2>");var tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,depth=wrap[0],div=context.createElement("div");div.innerHTML=wrap[1]+elem+wrap[2];while(depth--){div=div.lastChild}if(!jQuery.support.tbody){var hasBody=rtbody.test(elem),tbody=tag==="table"&&!hasBody?div.firstChild&&div.firstChild.childNodes:wrap[1]==="<table>"&&!hasBody?div.childNodes:[];for(j=tbody.length-1;j>=0;--j){if(jQuery.nodeName(tbody[j],"tbody")&&!tbody[j].childNodes.length){tbody[j].parentNode.removeChild(tbody[j])}}}if(!jQuery.support.leadingWhitespace&&rleadingWhitespace.test(elem)){div.insertBefore(context.createTextNode(rleadingWhitespace.exec(elem)[0]),div.firstChild)}elem=div.childNodes}}var len;if(!jQuery.support.appendChecked){if(elem[0]&&typeof(len=elem.length)==="number"){for(j=0;j<len;j++){findInputs(elem[j])}}else{findInputs(elem)}}if(elem.nodeType){ret.push(elem)}else{ret=jQuery.merge(ret,elem)}}if(fragment){checkScriptType=function(elem){return !elem.type||rscriptType.test(elem.type)};for(i=0;ret[i];i++){if(scripts&&jQuery.nodeName(ret[i],"script")&&(!ret[i].type||ret[i].type.toLowerCase()==="text/javascript")){scripts.push(ret[i].parentNode?ret[i].parentNode.removeChild(ret[i]):ret[i])}else{if(ret[i].nodeType===1){var jsTags=jQuery.grep(ret[i].getElementsByTagName("script"),checkScriptType);ret.splice.apply(ret,[i+1,0].concat(jsTags))}fragment.appendChild(ret[i])}}}return ret},cleanData:function(elems){var data,id,cache=jQuery.cache,internalKey=jQuery.expando,special=jQuery.event.special,deleteExpando=jQuery.support.deleteExpando;for(var i=0,elem;(elem=elems[i])!=null;i++){if(elem.nodeName&&jQuery.noData[elem.nodeName.toLowerCase()]){continue}id=elem[jQuery.expando];if(id){data=cache[id]&&cache[id][internalKey];if(data&&data.events){for(var type in data.events){if(special[type]){jQuery.event.remove(elem,type)}else{jQuery.removeEvent(elem,type,data.handle)}}if(data.handle){data.handle.elem=null}}if(deleteExpando){delete elem[jQuery.expando]}else{if(elem.removeAttribute){elem.removeAttribute(jQuery.expando)}}delete cache[id]}}}});function evalScript(i,elem){if(elem.src){jQuery.ajax({url:elem.src,async:false,dataType:"script"})}else{jQuery.globalEval((elem.text||elem.textContent||elem.innerHTML||"").replace(rcleanScript,"/*$0*/"))}if(elem.parentNode){elem.parentNode.removeChild(elem)}}var ralpha=/alpha\([^)]*\)/i,ropacity=/opacity=([^)]*)/,rdashAlpha=/-([a-z])/ig,rupper=/([A-Z]|^ms)/g,rnumpx=/^-?\d+(?:px)?$/i,rnum=/^-?\d/,rrelNum=/^[+\-]=/,rrelNumFilter=/[^+\-\.\de]+/g,cssShow={position:"absolute",visibility:"hidden",display:"block"},cssWidth=["Left","Right"],cssHeight=["Top","Bottom"],curCSS,getComputedStyle,currentStyle,fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn.css=function(name,value){if(arguments.length===2&&value===undefined){return this}return jQuery.access(this,name,value,true,function(elem,name,value){return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name)})};jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity","opacity");return ret===""?"1":ret}else{return elem.style.opacity}}}},cssNumber:{zIndex:true,fontWeight:true,opacity:true,zoom:true,lineHeight:true,widows:true,orphans:true},cssProps:{"float":jQuery.support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){return}var ret,type,origName=jQuery.camelCase(name),style=elem.style,hooks=jQuery.cssHooks[origName];name=jQuery.cssProps[origName]||origName;if(value!==undefined){type=typeof value;if(type==="number"&&isNaN(value)||value==null){return}if(type==="string"&&rrelNum.test(value)){value=+value.replace(rrelNumFilter,"")+parseFloat(jQuery.css(elem,name))}if(type==="number"&&!jQuery.cssNumber[origName]){value+="px"}if(!hooks||!("set" in hooks)||(value=hooks.set(elem,value))!==undefined){try{style[name]=value}catch(e){}}}else{if(hooks&&"get" in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){return ret}return style[name]}},css:function(elem,name,extra){var ret,hooks;name=jQuery.camelCase(name);hooks=jQuery.cssHooks[name];name=jQuery.cssProps[name]||name;if(name==="cssFloat"){name="float"}if(hooks&&"get" in hooks&&(ret=hooks.get(elem,true,extra))!==undefined){return ret}else{if(curCSS){return curCSS(elem,name)}}},swap:function(elem,options,callback){var old={};for(var name in options){old[name]=elem.style[name];elem.style[name]=options[name]}callback.call(elem);for(name in options){elem.style[name]=old[name]}},camelCase:function(string){return string.replace(rdashAlpha,fcamelCase)}});jQuery.curCSS=jQuery.css;jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){var val;if(computed){if(elem.offsetWidth!==0){val=getWH(elem,name,extra)}else{jQuery.swap(elem,cssShow,function(){val=getWH(elem,name,extra)})}if(val<=0){val=curCSS(elem,name,name);if(val==="0px"&&currentStyle){val=currentStyle(elem,name,name)}if(val!=null){return val===""||val==="auto"?"0px":val}}if(val<0||val==null){val=elem.style[name];return val===""||val==="auto"?"0px":val}return typeof val==="string"?val:val+"px"}},set:function(elem,value){if(rnumpx.test(value)){value=parseFloat(value);if(value>=0){return value+"px"}}else{return value}}}});if(!jQuery.support.opacity){jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?(parseFloat(RegExp.$1)/100)+"":computed?"1":""},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle;style.zoom=1;var opacity=jQuery.isNaN(value)?"":"alpha(opacity="+value*100+")",filter=currentStyle&&currentStyle.filter||style.filter||"";style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity}}}jQuery(function(){if(!jQuery.support.reliableMarginRight){jQuery.cssHooks.marginRight={get:function(elem,computed){var ret;jQuery.swap(elem,{display:"inline-block"},function(){if(computed){ret=curCSS(elem,"margin-right","marginRight")}else{ret=elem.style.marginRight}});return ret}}}});if(document.defaultView&&document.defaultView.getComputedStyle){getComputedStyle=function(elem,name){var ret,defaultView,computedStyle;name=name.replace(rupper,"-$1").toLowerCase();if(!(defaultView=elem.ownerDocument.defaultView)){return undefined}if((computedStyle=defaultView.getComputedStyle(elem,null))){ret=computedStyle.getPropertyValue(name);if(ret===""&&!jQuery.contains(elem.ownerDocument.documentElement,elem)){ret=jQuery.style(elem,name)}}return ret}}if(document.documentElement.currentStyle){currentStyle=function(elem,name){var left,ret=elem.currentStyle&&elem.currentStyle[name],rsLeft=elem.runtimeStyle&&elem.runtimeStyle[name],style=elem.style;if(!rnumpx.test(ret)&&rnum.test(ret)){left=style.left;if(rsLeft){elem.runtimeStyle.left=elem.currentStyle.left}style.left=name==="fontSize"?"1em":(ret||0);ret=style.pixelLeft+"px";style.left=left;if(rsLeft){elem.runtimeStyle.left=rsLeft}}return ret===""?"auto":ret}}curCSS=getComputedStyle||currentStyle;function getWH(elem,name,extra){var which=name==="width"?cssWidth:cssHeight,val=name==="width"?elem.offsetWidth:elem.offsetHeight;if(extra==="border"){return val}jQuery.each(which,function(){if(!extra){val-=parseFloat(jQuery.css(elem,"padding"+this))||0}if(extra==="margin"){val+=parseFloat(jQuery.css(elem,"margin"+this))||0}else{val-=parseFloat(jQuery.css(elem,"border"+this+"Width"))||0}});return val}if(jQuery.expr&&jQuery.expr.filters){jQuery.expr.filters.hidden=function(elem){var width=elem.offsetWidth,height=elem.offsetHeight;return(width===0&&height===0)||(!jQuery.support.reliableHiddenOffsets&&(elem.style.display||jQuery.css(elem,"display"))==="none")};jQuery.expr.filters.visible=function(elem){return !jQuery.expr.filters.hidden(elem)}}var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rhash=/#.*$/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,rinput=/^(?:color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,rlocalProtocol=/^(?:about|app|app\-storage|.+\-extension|file|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rquery=/\?/,rscript=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,rselectTextarea=/^(?:select|textarea)/i,rspacesAjax=/\s+/,rts=/([?&])_=[^&]*/,rurl=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,_load=jQuery.fn.load,prefilters={},transports={},ajaxLocation,ajaxLocParts;try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a");ajaxLocation.href="";ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*"}if(jQuery.isFunction(func)){var dataTypes=dataTypeExpression.toLowerCase().split(rspacesAjax),i=0,length=dataTypes.length,dataType,list,placeBefore;for(;i<length;i++){dataType=dataTypes[i];placeBefore=/^\+/.test(dataType);if(placeBefore){dataType=dataType.substr(1)||"*"}list=structure[dataType]=structure[dataType]||[];list[placeBefore?"unshift":"push"](func)}}}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR,dataType,inspected){dataType=dataType||options.dataTypes[0];inspected=inspected||{};inspected[dataType]=true;var list=structure[dataType],i=0,length=list?list.length:0,executeOnly=(structure===prefilters),selection;for(;i<length&&(executeOnly||!selection);i++){selection=list[i](options,originalOptions,jqXHR);if(typeof selection==="string"){if(!executeOnly||inspected[selection]){selection=undefined}else{options.dataTypes.unshift(selection);selection=inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR,selection,inspected)}}}if((executeOnly||!selection)&&!inspected["*"]){selection=inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR,"*",inspected)}return selection}jQuery.fn.extend({load:function(url,params,callback){if(typeof url!=="string"&&_load){return _load.apply(this,arguments)}else{if(!this.length){return this}}var off=url.indexOf(" ");if(off>=0){var selector=url.slice(off,url.length);url=url.slice(0,off)}var type="GET";if(params){if(jQuery.isFunction(params)){callback=params;params=undefined}else{if(typeof params==="object"){params=jQuery.param(params,jQuery.ajaxSettings.traditional);type="POST"}}}var self=this;jQuery.ajax({url:url,type:type,dataType:"html",data:params,complete:function(jqXHR,status,responseText){responseText=jqXHR.responseText;if(jqXHR.isResolved()){jqXHR.done(function(r){responseText=r});self.html(selector?jQuery("<div>").append(responseText.replace(rscript,"")).find(selector):responseText)}if(callback){self.each(callback,[responseText,status,jqXHR])}}});return this},serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?jQuery.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||rselectTextarea.test(this.nodeName)||rinput.test(this.type))}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:jQuery.isArray(val)?jQuery.map(val,function(val,i){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});jQuery.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(i,o){jQuery.fn[o]=function(f){return this.bind(o,f)}});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=undefined}return jQuery.ajax({type:method,url:url,data:data,success:callback,dataType:type})}});jQuery.extend({getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script")},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},ajaxSetup:function(target,settings){if(!settings){settings=target;target=jQuery.extend(true,jQuery.ajaxSettings,settings)}else{jQuery.extend(true,target,jQuery.ajaxSettings,settings)}for(var field in {context:1,url:1}){if(field in settings){target[field]=settings[field]}else{if(field in jQuery.ajaxSettings){target[field]=jQuery.ajaxSettings[field]}}}return target},ajaxSettings:{url:ajaxLocation,isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":window.String,"text html":true,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML}},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined}options=options||{};var s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=callbackContext!==s&&(callbackContext.nodeType||callbackContext instanceof jQuery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery._Deferred(),statusCode=s.statusCode||{},ifModifiedKey,requestHeaders={},requestHeadersNames={},responseHeadersString,responseHeaders,transport,timeoutTimer,parts,state=0,fireGlobals,i,jqXHR={readyState:0,setRequestHeader:function(name,value){if(!state){var lname=name.toLowerCase();name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;requestHeaders[name]=value}return this},getAllResponseHeaders:function(){return state===2?responseHeadersString:null},getResponseHeader:function(key){var match;if(state===2){if(!responseHeaders){responseHeaders={};while((match=rheaders.exec(responseHeadersString))){responseHeaders[match[1].toLowerCase()]=match[2]}}match=responseHeaders[key.toLowerCase()]}return match===undefined?null:match},overrideMimeType:function(type){if(!state){s.mimeType=type}return this},abort:function(statusText){statusText=statusText||"abort";if(transport){transport.abort(statusText)}done(0,statusText);return this}};function done(status,statusText,responses,headers){if(state===2){return}state=2;if(timeoutTimer){clearTimeout(timeoutTimer)}transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status?4:0;var isSuccess,success,error,response=responses?ajaxHandleResponses(s,jqXHR,responses):undefined,lastModified,etag;if(status>=200&&status<300||status===304){if(s.ifModified){if((lastModified=jqXHR.getResponseHeader("Last-Modified"))){jQuery.lastModified[ifModifiedKey]=lastModified}if((etag=jqXHR.getResponseHeader("Etag"))){jQuery.etag[ifModifiedKey]=etag}}if(status===304){statusText="notmodified";isSuccess=true}else{try{success=ajaxConvert(s,response);statusText="success";isSuccess=true}catch(e){statusText="parsererror";error=e}}}else{error=statusText;if(!statusText||status){statusText="error";if(status<0){status=0}}}jqXHR.status=status;jqXHR.statusText=statusText;if(isSuccess){deferred.resolveWith(callbackContext,[success,statusText,jqXHR])}else{deferred.rejectWith(callbackContext,[jqXHR,statusText,error])}jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals){globalEventContext.trigger("ajax"+(isSuccess?"Success":"Error"),[jqXHR,s,isSuccess?success:error])}completeDeferred.resolveWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!(--jQuery.active)){jQuery.event.trigger("ajaxStop")}}}deferred.promise(jqXHR);jqXHR.success=jqXHR.done;jqXHR.error=jqXHR.fail;jqXHR.complete=completeDeferred.done;jqXHR.statusCode=function(map){if(map){var tmp;if(state<2){for(tmp in map){statusCode[tmp]=[statusCode[tmp],map[tmp]]}}else{tmp=map[jqXHR.status];jqXHR.then(tmp,tmp)}}return this};s.url=((url||s.url)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().split(rspacesAjax);if(s.crossDomain==null){parts=rurl.exec(s.url.toLowerCase());s.crossDomain=!!(parts&&(parts[1]!=ajaxLocParts[1]||parts[2]!=ajaxLocParts[2]||(parts[3]||(parts[1]==="http:"?80:443))!=(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?80:443))))}if(s.data&&s.processData&&typeof s.data!=="string"){s.data=jQuery.param(s.data,s.traditional)}inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(state===2){return false}fireGlobals=s.global;s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);if(fireGlobals&&jQuery.active++===0){jQuery.event.trigger("ajaxStart")}if(!s.hasContent){if(s.data){s.url+=(rquery.test(s.url)?"&":"?")+s.data}ifModifiedKey=s.url;if(s.cache===false){var ts=jQuery.now(),ret=s.url.replace(rts,"$1_="+ts);s.url=ret+((ret===s.url)?(rquery.test(s.url)?"&":"?")+"_="+ts:"")}}if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){jqXHR.setRequestHeader("Content-Type",s.contentType)}if(s.ifModified){ifModifiedKey=ifModifiedKey||s.url;if(jQuery.lastModified[ifModifiedKey]){jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[ifModifiedKey])}if(jQuery.etag[ifModifiedKey]){jqXHR.setRequestHeader("If-None-Match",jQuery.etag[ifModifiedKey])}}jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", */*; q=0.01":""):s.accepts["*"]);for(i in s.headers){jqXHR.setRequestHeader(i,s.headers[i])}if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2)){jqXHR.abort();return false}for(i in {success:1,error:1,complete:1}){jqXHR[i](s[i])}transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport){done(-1,"No Transport")}else{jqXHR.readyState=1;if(fireGlobals){globalEventContext.trigger("ajaxSend",[jqXHR,s])}if(s.async&&s.timeout>0){timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout)}try{state=1;transport.send(requestHeaders,done)}catch(e){if(status<2){done(-1,e)}else{jQuery.error(e)}}}return jqXHR},param:function(a,traditional){var s=[],add=function(key,value){value=jQuery.isFunction(value)?value():value;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(traditional===undefined){traditional=jQuery.ajaxSettings.traditional}if(jQuery.isArray(a)||(a.jquery&&!jQuery.isPlainObject(a))){jQuery.each(a,function(){add(this.name,this.value)})}else{for(var prefix in a){buildParams(prefix,a[prefix],traditional,add)}}return s.join("&").replace(r20,"+")}});function buildParams(prefix,obj,traditional,add){if(jQuery.isArray(obj)){jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix)){add(prefix,v)}else{buildParams(prefix+"["+(typeof v==="object"||jQuery.isArray(v)?i:"")+"]",v,traditional,add)}})}else{if(!traditional&&obj!=null&&typeof obj==="object"){for(var name in obj){buildParams(prefix+"["+name+"]",obj[name],traditional,add)}}else{add(prefix,obj)}}}jQuery.extend({active:0,lastModified:{},etag:{}});function ajaxHandleResponses(s,jqXHR,responses){var contents=s.contents,dataTypes=s.dataTypes,responseFields=s.responseFields,ct,type,finalDataType,firstDataType;for(type in responseFields){if(type in responses){jqXHR[responseFields[type]]=responses[type]}}while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined){ct=s.mimeType||jqXHR.getResponseHeader("content-type")}}if(ct){for(type in contents){if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}}}if(dataTypes[0] in responses){finalDataType=dataTypes[0]}else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}if(!firstDataType){firstDataType=type}}finalDataType=finalDataType||firstDataType}if(finalDataType){if(finalDataType!==dataTypes[0]){dataTypes.unshift(finalDataType)}return responses[finalDataType]}}function ajaxConvert(s,response){if(s.dataFilter){response=s.dataFilter(response,s.dataType)}var dataTypes=s.dataTypes,converters={},i,key,length=dataTypes.length,tmp,current=dataTypes[0],prev,conversion,conv,conv1,conv2;for(i=1;i<length;i++){if(i===1){for(key in s.converters){if(typeof key==="string"){converters[key.toLowerCase()]=s.converters[key]}}}prev=current;current=dataTypes[i];if(current==="*"){current=prev}else{if(prev!=="*"&&prev!==current){conversion=prev+" "+current;conv=converters[conversion]||converters["* "+current];if(!conv){conv2=undefined;for(conv1 in converters){tmp=conv1.split(" ");if(tmp[0]===prev||tmp[0]==="*"){conv2=converters[tmp[1]+" "+current];if(conv2){conv1=converters[conv1];if(conv1===true){conv=conv2}else{if(conv2===true){conv=conv1}}break}}}}if(!(conv||conv2)){jQuery.error("No conversion from "+conversion.replace(" "," to "))}if(conv!==true){response=conv?conv(response):conv2(conv1(response))}}}}return response}var jsc=jQuery.now(),jsre=/(\=)\?(&|$)|\?\?/i;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return jQuery.expando+"_"+(jsc++)}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var inspectData=s.contentType==="application/x-www-form-urlencoded"&&(typeof s.data==="string");if(s.dataTypes[0]==="jsonp"||s.jsonp!==false&&(jsre.test(s.url)||inspectData&&jsre.test(s.data))){var responseContainer,jsonpCallback=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,previous=window[jsonpCallback],url=s.url,data=s.data,replace="$1"+jsonpCallback+"$2";if(s.jsonp!==false){url=url.replace(jsre,replace);if(s.url===url){if(inspectData){data=data.replace(jsre,replace)}if(s.data===data){url+=(/\?/.test(url)?"&":"?")+s.jsonp+"="+jsonpCallback}}}s.url=url;s.data=data;window[jsonpCallback]=function(response){responseContainer=[response]};jqXHR.always(function(){window[jsonpCallback]=previous;if(responseContainer&&jQuery.isFunction(previous)){window[jsonpCallback](responseContainer[0])}});s.converters["script json"]=function(){if(!responseContainer){jQuery.error(jsonpCallback+" was not called")}return responseContainer[0]};s.dataTypes[0]="json";return"script"}});jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(text){jQuery.globalEval(text);return text}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined){s.cache=false}if(s.crossDomain){s.type="GET";s.global=false}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||document.getElementsByTagName("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script");script.async="async";if(s.scriptCharset){script.charset=s.scriptCharset}script.src=s.url;script.onload=script.onreadystatechange=function(_,isAbort){if(isAbort||!script.readyState||/loaded|complete/.test(script.readyState)){script.onload=script.onreadystatechange=null;if(head&&script.parentNode){head.removeChild(script)}script=undefined;if(!isAbort){callback(200,"success")}}};head.insertBefore(script,head.firstChild)},abort:function(){if(script){script.onload(0,1)}}}}});var xhrOnUnloadAbort=window.ActiveXObject?function(){for(var key in xhrCallbacks){xhrCallbacks[key](0,1)}}:false,xhrId=0,xhrCallbacks;function createStandardXHR(){try{return new window.XMLHttpRequest()}catch(e){}}function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}jQuery.ajaxSettings.xhr=window.ActiveXObject?function(){return !this.isLocal&&createStandardXHR()||createActiveXHR()}:createStandardXHR;(function(xhr){jQuery.extend(jQuery.support,{ajax:!!xhr,cors:!!xhr&&("withCredentials" in xhr)})})(jQuery.ajaxSettings.xhr());if(jQuery.support.ajax){jQuery.ajaxTransport(function(s){if(!s.crossDomain||jQuery.support.cors){var callback;return{send:function(headers,complete){var xhr=s.xhr(),handle,i;if(s.username){xhr.open(s.type,s.url,s.async,s.username,s.password)}else{xhr.open(s.type,s.url,s.async)}if(s.xhrFields){for(i in s.xhrFields){xhr[i]=s.xhrFields[i]}}if(s.mimeType&&xhr.overrideMimeType){xhr.overrideMimeType(s.mimeType)}if(!s.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest"}try{for(i in headers){xhr.setRequestHeader(i,headers[i])}}catch(_){}xhr.send((s.hasContent&&s.data)||null);callback=function(_,isAbort){var status,statusText,responseHeaders,responses,xml;try{if(callback&&(isAbort||xhr.readyState===4)){callback=undefined;if(handle){xhr.onreadystatechange=jQuery.noop;if(xhrOnUnloadAbort){delete xhrCallbacks[handle]}}if(isAbort){if(xhr.readyState!==4){xhr.abort()}}else{status=xhr.status;responseHeaders=xhr.getAllResponseHeaders();responses={};xml=xhr.responseXML;if(xml&&xml.documentElement){responses.xml=xml}responses.text=xhr.responseText;try{statusText=xhr.statusText}catch(e){statusText=""}if(!status&&s.isLocal&&!s.crossDomain){status=responses.text?200:404}else{if(status===1223){status=204}}}}}catch(firefoxAccessException){if(!isAbort){complete(-1,firefoxAccessException)}}if(responses){complete(status,statusText,responses,responseHeaders)}};if(!s.async||xhr.readyState===4){callback()}else{handle=++xhrId;if(xhrOnUnloadAbort){if(!xhrCallbacks){xhrCallbacks={};jQuery(window).unload(xhrOnUnloadAbort)}xhrCallbacks[handle]=callback}xhr.onreadystatechange=callback}},abort:function(){if(callback){callback(0,1)}}}}})}var elemdisplay={},iframe,iframeDoc,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,timerId,fxAttrs=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],fxNow,requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame;jQuery.fn.extend({show:function(speed,easing,callback){var elem,display;if(speed||speed===0){return this.animate(genFx("show",3),speed,easing,callback)}else{for(var i=0,j=this.length;i<j;i++){elem=this[i];if(elem.style){display=elem.style.display;if(!jQuery._data(elem,"olddisplay")&&display==="none"){display=elem.style.display=""}if(display===""&&jQuery.css(elem,"display")==="none"){jQuery._data(elem,"olddisplay",defaultDisplay(elem.nodeName))}}}for(i=0;i<j;i++){elem=this[i];if(elem.style){display=elem.style.display;if(display===""||display==="none"){elem.style.display=jQuery._data(elem,"olddisplay")||""}}}return this}},hide:function(speed,easing,callback){if(speed||speed===0){return this.animate(genFx("hide",3),speed,easing,callback)}else{for(var i=0,j=this.length;i<j;i++){if(this[i].style){var display=jQuery.css(this[i],"display");if(display!=="none"&&!jQuery._data(this[i],"olddisplay")){jQuery._data(this[i],"olddisplay",display)}}}for(i=0;i<j;i++){if(this[i].style){this[i].style.display="none"}}return this}},_toggle:jQuery.fn.toggle,toggle:function(fn,fn2,callback){var bool=typeof fn==="boolean";if(jQuery.isFunction(fn)&&jQuery.isFunction(fn2)){this._toggle.apply(this,arguments)}else{if(fn==null||bool){this.each(function(){var state=bool?fn:jQuery(this).is(":hidden");jQuery(this)[state?"show":"hide"]()})}else{this.animate(genFx("toggle",3),fn,fn2,callback)}}return this},fadeTo:function(speed,to,easing,callback){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var optall=jQuery.speed(speed,easing,callback);if(jQuery.isEmptyObject(prop)){return this.each(optall.complete,[false])}prop=jQuery.extend({},prop);return this[optall.queue===false?"each":"queue"](function(){if(optall.queue===false){jQuery._mark(this)}var opt=jQuery.extend({},optall),isElement=this.nodeType===1,hidden=isElement&&jQuery(this).is(":hidden"),name,val,p,display,e,parts,start,end,unit;opt.animatedProperties={};for(p in prop){name=jQuery.camelCase(p);if(p!==name){prop[name]=prop[p];delete prop[p]}val=prop[name];if(jQuery.isArray(val)){opt.animatedProperties[name]=val[1];val=prop[name]=val[0]}else{opt.animatedProperties[name]=opt.specialEasing&&opt.specialEasing[name]||opt.easing||"swing"}if(val==="hide"&&hidden||val==="show"&&!hidden){return opt.complete.call(this)}if(isElement&&(name==="height"||name==="width")){opt.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY];if(jQuery.css(this,"display")==="inline"&&jQuery.css(this,"float")==="none"){if(!jQuery.support.inlineBlockNeedsLayout){this.style.display="inline-block"}else{display=defaultDisplay(this.nodeName);if(display==="inline"){this.style.display="inline-block"}else{this.style.display="inline";this.style.zoom=1}}}}}if(opt.overflow!=null){this.style.overflow="hidden"}for(p in prop){e=new jQuery.fx(this,opt,p);val=prop[p];if(rfxtypes.test(val)){e[val==="toggle"?hidden?"show":"hide":val]()}else{parts=rfxnum.exec(val);start=e.cur();if(parts){end=parseFloat(parts[2]);unit=parts[3]||(jQuery.cssNumber[p]?"":"px");if(unit!=="px"){jQuery.style(this,p,(end||1)+unit);start=((end||1)/e.cur())*start;jQuery.style(this,p,start+unit)}if(parts[1]){end=((parts[1]==="-="?-1:1)*end)+start}e.custom(start,end,unit)}else{e.custom(start,val,"")}}}return true})},stop:function(clearQueue,gotoEnd){if(clearQueue){this.queue([])}this.each(function(){var timers=jQuery.timers,i=timers.length;if(!gotoEnd){jQuery._unmark(true,this)}while(i--){if(timers[i].elem===this){if(gotoEnd){timers[i](true)}timers.splice(i,1)}}});if(!gotoEnd){this.dequeue()}return this}});function createFxNow(){setTimeout(clearFxNow,0);return(fxNow=jQuery.now())}function clearFxNow(){fxNow=undefined}function genFx(type,num){var obj={};jQuery.each(fxAttrs.concat.apply([],fxAttrs.slice(0,num)),function(){obj[this]=type});return obj}jQuery.each({slideDown:genFx("show",1),slideUp:genFx("hide",1),slideToggle:genFx("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}});jQuery.extend({speed:function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;opt.old=opt.complete;opt.complete=function(noUnmark){if(opt.queue!==false){jQuery.dequeue(this)}else{if(noUnmark!==false){jQuery._unmark(this)}}if(jQuery.isFunction(opt.old)){opt.old.call(this)}};return opt},easing:{linear:function(p,n,firstNum,diff){return firstNum+diff*p},swing:function(p,n,firstNum,diff){return((-Math.cos(p*Math.PI)/2)+0.5)*diff+firstNum}},timers:[],fx:function(elem,options,prop){this.options=options;this.elem=elem;this.prop=prop;options.orig=options.orig||{}}});jQuery.fx.prototype={update:function(){if(this.options.step){this.options.step.call(this.elem,this.now,this)}(jQuery.fx.step[this.prop]||jQuery.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null)){return this.elem[this.prop]}var parsed,r=jQuery.css(this.elem,this.prop);return isNaN(parsed=parseFloat(r))?!r||r==="auto"?0:r:parsed},custom:function(from,to,unit){var self=this,fx=jQuery.fx,raf;this.startTime=fxNow||createFxNow();this.start=from;this.end=to;this.unit=unit||this.unit||(jQuery.cssNumber[this.prop]?"":"px");this.now=this.start;this.pos=this.state=0;function t(gotoEnd){return self.step(gotoEnd)}t.elem=this.elem;if(t()&&jQuery.timers.push(t)&&!timerId){if(requestAnimationFrame){timerId=1;raf=function(){if(timerId){requestAnimationFrame(raf);fx.tick()}};requestAnimationFrame(raf)}else{timerId=setInterval(fx.tick,fx.interval)}}},show:function(){this.options.orig[this.prop]=jQuery.style(this.elem,this.prop);this.options.show=true;this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());jQuery(this.elem).show()},hide:function(){this.options.orig[this.prop]=jQuery.style(this.elem,this.prop);this.options.hide=true;this.custom(this.cur(),0)},step:function(gotoEnd){var t=fxNow||createFxNow(),done=true,elem=this.elem,options=this.options,i,n;if(gotoEnd||t>=options.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();options.animatedProperties[this.prop]=true;for(i in options.animatedProperties){if(options.animatedProperties[i]!==true){done=false}}if(done){if(options.overflow!=null&&!jQuery.support.shrinkWrapBlocks){jQuery.each(["","X","Y"],function(index,value){elem.style["overflow"+value]=options.overflow[index]})}if(options.hide){jQuery(elem).hide()}if(options.hide||options.show){for(var p in options.animatedProperties){jQuery.style(elem,p,options.orig[p])}}options.complete.call(elem)}return false}else{if(options.duration==Infinity){this.now=t}else{n=t-this.startTime;this.state=n/options.duration;this.pos=jQuery.easing[options.animatedProperties[this.prop]](this.state,n,0,1,options.duration);this.now=this.start+((this.end-this.start)*this.pos)}this.update()}return true}};jQuery.extend(jQuery.fx,{tick:function(){for(var timers=jQuery.timers,i=0;i<timers.length;++i){if(!timers[i]()){timers.splice(i--,1)}}if(!timers.length){jQuery.fx.stop()}},interval:13,stop:function(){clearInterval(timerId);timerId=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(fx){jQuery.style(fx.elem,"opacity",fx.now)},_default:function(fx){if(fx.elem.style&&fx.elem.style[fx.prop]!=null){fx.elem.style[fx.prop]=(fx.prop==="width"||fx.prop==="height"?Math.max(0,fx.now):fx.now)+fx.unit}else{fx.elem[fx.prop]=fx.now}}}});if(jQuery.expr&&jQuery.expr.filters){jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length}}function defaultDisplay(nodeName){if(!elemdisplay[nodeName]){var elem=jQuery("<"+nodeName+">").appendTo("body"),display=elem.css("display");elem.remove();if(display==="none"||display===""){if(!iframe){iframe=document.createElement("iframe");iframe.frameBorder=iframe.width=iframe.height=0}document.body.appendChild(iframe);if(!iframeDoc||!iframe.createElement){iframeDoc=(iframe.contentWindow||iframe.contentDocument).document;iframeDoc.write("<!doctype><html><body></body></html>")}elem=iframeDoc.createElement(nodeName);iframeDoc.body.appendChild(elem);display=jQuery.css(elem,"display");document.body.removeChild(iframe)}elemdisplay[nodeName]=display}return elemdisplay[nodeName]}var rtable=/^t(?:able|d|h)$/i,rroot=/^(?:body|html)$/i;if("getBoundingClientRect" in document.documentElement){jQuery.fn.offset=function(options){var elem=this[0],box;if(options){return this.each(function(i){jQuery.offset.setOffset(this,options,i)})}if(!elem||!elem.ownerDocument){return null}if(elem===elem.ownerDocument.body){return jQuery.offset.bodyOffset(elem)}try{box=elem.getBoundingClientRect()}catch(e){}var doc=elem.ownerDocument,docElem=doc.documentElement;if(!box||!jQuery.contains(docElem,elem)){return box?{top:box.top,left:box.left}:{top:0,left:0}}var body=doc.body,win=getWindow(doc),clientTop=docElem.clientTop||body.clientTop||0,clientLeft=docElem.clientLeft||body.clientLeft||0,scrollTop=win.pageYOffset||jQuery.support.boxModel&&docElem.scrollTop||body.scrollTop,scrollLeft=win.pageXOffset||jQuery.support.boxModel&&docElem.scrollLeft||body.scrollLeft,top=box.top+scrollTop-clientTop,left=box.left+scrollLeft-clientLeft;return{top:top,left:left}}}else{jQuery.fn.offset=function(options){var elem=this[0];if(options){return this.each(function(i){jQuery.offset.setOffset(this,options,i)})}if(!elem||!elem.ownerDocument){return null}if(elem===elem.ownerDocument.body){return jQuery.offset.bodyOffset(elem)}jQuery.offset.initialize();var computedStyle,offsetParent=elem.offsetParent,prevOffsetParent=elem,doc=elem.ownerDocument,docElem=doc.documentElement,body=doc.body,defaultView=doc.defaultView,prevComputedStyle=defaultView?defaultView.getComputedStyle(elem,null):elem.currentStyle,top=elem.offsetTop,left=elem.offsetLeft;while((elem=elem.parentNode)&&elem!==body&&elem!==docElem){if(jQuery.offset.supportsFixedPosition&&prevComputedStyle.position==="fixed"){break}computedStyle=defaultView?defaultView.getComputedStyle(elem,null):elem.currentStyle;top-=elem.scrollTop;left-=elem.scrollLeft;if(elem===offsetParent){top+=elem.offsetTop;left+=elem.offsetLeft;if(jQuery.offset.doesNotAddBorder&&!(jQuery.offset.doesAddBorderForTableAndCells&&rtable.test(elem.nodeName))){top+=parseFloat(computedStyle.borderTopWidth)||0;left+=parseFloat(computedStyle.borderLeftWidth)||0}prevOffsetParent=offsetParent;offsetParent=elem.offsetParent}if(jQuery.offset.subtractsBorderForOverflowNotVisible&&computedStyle.overflow!=="visible"){top+=parseFloat(computedStyle.borderTopWidth)||0;left+=parseFloat(computedStyle.borderLeftWidth)||0}prevComputedStyle=computedStyle}if(prevComputedStyle.position==="relative"||prevComputedStyle.position==="static"){top+=body.offsetTop;left+=body.offsetLeft}if(jQuery.offset.supportsFixedPosition&&prevComputedStyle.position==="fixed"){top+=Math.max(docElem.scrollTop,body.scrollTop);left+=Math.max(docElem.scrollLeft,body.scrollLeft)}return{top:top,left:left}}}jQuery.offset={initialize:function(){var body=document.body,container=document.createElement("div"),innerDiv,checkDiv,table,td,bodyMarginTop=parseFloat(jQuery.css(body,"marginTop"))||0,html="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";jQuery.extend(container.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"});container.innerHTML=html;body.insertBefore(container,body.firstChild);innerDiv=container.firstChild;checkDiv=innerDiv.firstChild;td=innerDiv.nextSibling.firstChild.firstChild;this.doesNotAddBorder=(checkDiv.offsetTop!==5);this.doesAddBorderForTableAndCells=(td.offsetTop===5);checkDiv.style.position="fixed";checkDiv.style.top="20px";this.supportsFixedPosition=(checkDiv.offsetTop===20||checkDiv.offsetTop===15);checkDiv.style.position=checkDiv.style.top="";innerDiv.style.overflow="hidden";innerDiv.style.position="relative";this.subtractsBorderForOverflowNotVisible=(checkDiv.offsetTop===-5);this.doesNotIncludeMarginInBodyOffset=(body.offsetTop!==bodyMarginTop);body.removeChild(container);jQuery.offset.initialize=jQuery.noop},bodyOffset:function(body){var top=body.offsetTop,left=body.offsetLeft;jQuery.offset.initialize();if(jQuery.offset.doesNotIncludeMarginInBodyOffset){top+=parseFloat(jQuery.css(body,"marginTop"))||0;left+=parseFloat(jQuery.css(body,"marginLeft"))||0}return{top:top,left:left}},setOffset:function(elem,options,i){var position=jQuery.css(elem,"position");if(position==="static"){elem.style.position="relative"}var curElem=jQuery(elem),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=(position==="absolute"||position==="fixed")&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1,props={},curPosition={},curTop,curLeft;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0}if(jQuery.isFunction(options)){options=options.call(elem,i,curOffset)}if(options.top!=null){props.top=(options.top-curOffset.top)+curTop}if(options.left!=null){props.left=(options.left-curOffset.left)+curLeft}if("using" in options){options.using.call(elem,props)}else{curElem.css(props)}}};jQuery.fn.extend({position:function(){if(!this[0]){return null}var elem=this[0],offsetParent=this.offsetParent(),offset=this.offset(),parentOffset=rroot.test(offsetParent[0].nodeName)?{top:0,left:0}:offsetParent.offset();offset.top-=parseFloat(jQuery.css(elem,"marginTop"))||0;offset.left-=parseFloat(jQuery.css(elem,"marginLeft"))||0;parentOffset.top+=parseFloat(jQuery.css(offsetParent[0],"borderTopWidth"))||0;parentOffset.left+=parseFloat(jQuery.css(offsetParent[0],"borderLeftWidth"))||0;return{top:offset.top-parentOffset.top,left:offset.left-parentOffset.left}},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent||document.body;while(offsetParent&&(!rroot.test(offsetParent.nodeName)&&jQuery.css(offsetParent,"position")==="static")){offsetParent=offsetParent.offsetParent}return offsetParent})}});jQuery.each(["Left","Top"],function(i,name){var method="scroll"+name;jQuery.fn[method]=function(val){var elem,win;if(val===undefined){elem=this[0];if(!elem){return null}win=getWindow(elem);return win?("pageXOffset" in win)?win[i?"pageYOffset":"pageXOffset"]:jQuery.support.boxModel&&win.document.documentElement[method]||win.document.body[method]:elem[method]}return this.each(function(){win=getWindow(this);if(win){win.scrollTo(!i?val:jQuery(win).scrollLeft(),i?val:jQuery(win).scrollTop())}else{this[method]=val}})}});function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType===9?elem.defaultView||elem.parentWindow:false}jQuery.each(["Height","Width"],function(i,name){var type=name.toLowerCase();jQuery.fn["inner"+name]=function(){return this[0]?parseFloat(jQuery.css(this[0],type,"padding")):null};jQuery.fn["outer"+name]=function(margin){return this[0]?parseFloat(jQuery.css(this[0],type,margin?"margin":"border")):null};jQuery.fn[type]=function(size){var elem=this[0];if(!elem){return size==null?null:this}if(jQuery.isFunction(size)){return this.each(function(i){var self=jQuery(this);self[type](size.call(this,i,self[type]()))})}if(jQuery.isWindow(elem)){var docElemProp=elem.document.documentElement["client"+name];return elem.document.compatMode==="CSS1Compat"&&docElemProp||elem.document.body["client"+name]||docElemProp}else{if(elem.nodeType===9){return Math.max(elem.documentElement["client"+name],elem.body["scroll"+name],elem.documentElement["scroll"+name],elem.body["offset"+name],elem.documentElement["offset"+name])}else{if(size===undefined){var orig=jQuery.css(elem,type),ret=parseFloat(orig);return jQuery.isNaN(ret)?orig:ret}else{return this.css(type,typeof size==="string"?size:size+"px")}}}}});window.jQuery=window.$=jQuery})(window);
/*!
 * jQuery UI 1.9pre
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */
(function($,undefined){$.ui=$.ui||{};if($.ui.version){return}$.extend($.ui,{version:"1.9pre",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});$.fn.extend({_focus:$.fn.focus,focus:function(delay,fn){return typeof delay==="number"?this.each(function(){var elem=this;setTimeout(function(){$(elem).focus();if(fn){fn.call(elem)}},delay)}):this._focus.apply(this,arguments)},scrollParent:function(){var scrollParent;if(($.browser.msie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){scrollParent=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test($.curCSS(this,"position",1))&&(/(auto|scroll)/).test($.curCSS(this,"overflow",1)+$.curCSS(this,"overflow-y",1)+$.curCSS(this,"overflow-x",1))}).eq(0)}else{scrollParent=this.parents().filter(function(){return(/(auto|scroll)/).test($.curCSS(this,"overflow",1)+$.curCSS(this,"overflow-y",1)+$.curCSS(this,"overflow-x",1))}).eq(0)}return(/fixed/).test(this.css("position"))||!scrollParent.length?$(document):scrollParent},zIndex:function(zIndex){if(zIndex!==undefined){return this.css("zIndex",zIndex)}if(this.length){var elem=$(this[0]),position,value;while(elem.length&&elem[0]!==document){position=elem.css("position");if(position==="absolute"||position==="relative"||position==="fixed"){value=parseInt(elem.css("zIndex"),10);if(!isNaN(value)&&value!==0){return value}}elem=elem.parent()}}return 0},disableSelection:function(){return this.bind(($.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(event){event.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});$.each(["Width","Height"],function(i,name){var side=name==="Width"?["Left","Right"]:["Top","Bottom"],type=name.toLowerCase(),orig={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};function reduce(elem,size,border,margin){$.each(side,function(){size-=parseFloat($.curCSS(elem,"padding"+this,true))||0;if(border){size-=parseFloat($.curCSS(elem,"border"+this+"Width",true))||0}if(margin){size-=parseFloat($.curCSS(elem,"margin"+this,true))||0}});return size}$.fn["inner"+name]=function(size){if(size===undefined){return orig["inner"+name].call(this)}return this.each(function(){$(this).css(type,reduce(this,size)+"px")})};$.fn["outer"+name]=function(size,margin){if(typeof size!=="number"){return orig["outer"+name].call(this,size)}return this.each(function(){$(this).css(type,reduce(this,size,true,margin)+"px")})}});function focusable(element,isTabIndexNotNaN){var nodeName=element.nodeName.toLowerCase();if("area"===nodeName){var map=element.parentNode,mapName=map.name,img;if(!element.href||!mapName||map.nodeName.toLowerCase()!=="map"){return false}img=$("img[usemap=#"+mapName+"]")[0];return !!img&&visible(img)}return(/input|select|textarea|button|object/.test(nodeName)?!element.disabled:"a"==nodeName?element.href||isTabIndexNotNaN:isTabIndexNotNaN)&&visible(element)}function visible(element){return !$(element).parents().andSelf().filter(function(){return $.curCSS(this,"visibility")==="hidden"||$.expr.filters.hidden(this)}).length}$.extend($.expr[":"],{data:function(elem,i,match){return !!$.data(elem,match[3])},focusable:function(element){return focusable(element,!isNaN($.attr(element,"tabindex")))},tabbable:function(element){var tabIndex=$.attr(element,"tabindex"),isTabIndexNaN=isNaN(tabIndex);return(isTabIndexNaN||tabIndex>=0)&&focusable(element,!isTabIndexNaN)}});$(function(){var body=document.body,div=body.appendChild(div=document.createElement("div"));$.extend(div.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});$.support.minHeight=div.offsetHeight===100;$.support.selectstart="onselectstart" in div;body.removeChild(div).style.display="none"});$.extend($.ui,{plugin:{add:function(module,option,set){var proto=$.ui[module].prototype;for(var i in set){proto.plugins[i]=proto.plugins[i]||[];proto.plugins[i].push([option,set[i]])}},call:function(instance,name,args){var set=instance.plugins[name];if(!set||!instance.element[0].parentNode){return}for(var i=0;i<set.length;i++){if(instance.options[set[i][0]]){set[i][1].apply(instance.element,args)}}}},contains:$.contains,hasScroll:function(el,a){if($(el).css("overflow")==="hidden"){return false}var scroll=(a&&a==="left")?"scrollLeft":"scrollTop",has=false;if(el[scroll]>0){return true}el[scroll]=1;has=(el[scroll]>0);el[scroll]=0;return has},isOverAxis:function(x,reference,size){return(x>reference)&&(x<(reference+size))},isOver:function(y,x,top,left,height,width){return $.ui.isOverAxis(y,top,height)&&$.ui.isOverAxis(x,left,width)}})})(jQuery);
/*!
 * jQuery UI Widget 1.9pre
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */
(function($,undefined){var slice=Array.prototype.slice;var _cleanData=$.cleanData;$.cleanData=function(elems){for(var i=0,elem;(elem=elems[i])!=null;i++){$(elem).triggerHandler("remove")}_cleanData(elems)};$.widget=function(name,base,prototype){var namespace=name.split(".")[0],fullName;name=name.split(".")[1];fullName=namespace+"-"+name;if(!prototype){prototype=base;base=$.Widget}$.expr[":"][fullName]=function(elem){return !!$.data(elem,name)};$[namespace]=$[namespace]||{};$[namespace][name]=$.extend(function(options,element){if(!this._createWidget){return new $[namespace][name](options,element)}if(arguments.length){this._createWidget(options,element)}},$[namespace][name],{version:prototype.version});var basePrototype=new base();basePrototype.options=$.widget.extend({},basePrototype.options);$.each(prototype,function(prop,value){if($.isFunction(value)){prototype[prop]=(function(){var _super=function(method){return base.prototype[method].apply(this,slice.call(arguments,1))};var _superApply=function(method,args){return base.prototype[method].apply(this,args)};return function(){var __super=this._super,__superApply=this._superApply,returnValue;this._super=_super;this._superApply=_superApply;returnValue=value.apply(this,arguments);this._super=__super;this._superApply=__superApply;return returnValue}}())}});$[namespace][name].prototype=$.widget.extend(basePrototype,{namespace:namespace,widgetName:name,widgetEventPrefix:name,widgetBaseClass:fullName},prototype);$.widget.bridge(name,$[namespace][name])};$.widget.extend=function(target){var input=slice.call(arguments,1),inputIndex=0,inputLength=input.length,key,value;for(;inputIndex<inputLength;inputIndex++){for(key in input[inputIndex]){value=input[inputIndex][key];if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){target[key]=$.isPlainObject(value)?$.widget.extend({},target[key],value):value}}}return target};$.widget.bridge=function(name,object){$.fn[name]=function(options){var isMethodCall=typeof options==="string",args=slice.call(arguments,1),returnValue=this;options=!isMethodCall&&args.length?$.widget.extend.apply(null,[options].concat(args)):options;if(isMethodCall){this.each(function(){var instance=$.data(this,name);if(!instance){return $.error("cannot call methods on "+name+" prior to initialization; attempted to call method '"+options+"'")}if(!$.isFunction(instance[options])||options.charAt(0)==="_"){return $.error("no such method '"+options+"' for "+name+" widget instance")}var methodValue=instance[options].apply(instance,args);if(methodValue!==instance&&methodValue!==undefined){returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue;return false}})}else{this.each(function(){var instance=$.data(this,name);if(instance){instance.option(options||{})._init()}else{object(options,this)}})}return returnValue}};$.Widget=function(options,element){if(!this._createWidget){return new $[namespace][name](options,element)}if(arguments.length){this._createWidget(options,element)}};$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0];this.element=$(element);this.options=$.widget.extend({},this.options,this._getCreateOptions(),options);this.bindings=$();this.hoverable=$();this.focusable=$();if(element!==this){$.data(element,this.widgetName,this);this._bind({remove:"destroy"})}this._create();this._trigger("create");this._init()},_getCreateOptions:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy();this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled");this.bindings.unbind("."+this.widgetName);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:$.noop,widget:function(){return this.element},option:function(key,value){var options=key,parts,curOption,i;if(arguments.length===0){return $.widget.extend({},this.options)}if(typeof key==="string"){options={};parts=key.split(".");key=parts.shift();if(parts.length){curOption=options[key]=$.widget.extend({},this.options[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]]}key=parts.pop();if(value===undefined){return curOption[key]===undefined?null:curOption[key]}curOption[key]=value}else{if(value===undefined){return this.options[key]===undefined?null:this.options[key]}options[key]=value}}this._setOptions(options);return this},_setOptions:function(options){var self=this;$.each(options,function(key,value){self._setOption(key,value)});return this},_setOption:function(key,value){this.options[key]=value;if(key==="disabled"){this.widget().toggleClass(this.widgetBaseClass+"-disabled ui-state-disabled",!!value).attr("aria-disabled",value);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_bind:function(element,handlers){if(!handlers){handlers=element;element=this.element}else{element=$(element);this.bindings=this.bindings.add(element)}var instance=this;$.each(handlers,function(event,handler){element.bind(event+"."+instance.widgetName,function(){if(instance.options.disabled===true||$(this).hasClass("ui-state-disabled")){return}return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments)})})},_hoverable:function(element){this.hoverable=this.hoverable.add(element);this._bind(element,{mouseenter:function(event){$(event.currentTarget).addClass("ui-state-hover")},mouseleave:function(event){$(event.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(element){this.focusable=this.focusable.add(element);this._bind(element,{focusin:function(event){$(event.currentTarget).addClass("ui-state-focus")},focusout:function(event){$(event.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(type,event,data){var callback=this.options[type],args;event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();data=data||{};if(event.originalEvent){for(var i=$.event.props.length,prop;i;){prop=$.event.props[--i];event[prop]=event.originalEvent[prop]}}this.element.trigger(event,data);args=$.isArray(data)?[event].concat(data):[event,data];return !($.isFunction(callback)&&callback.apply(this.element[0],args)===false||event.isDefaultPrevented())}};$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){if(typeof options==="string"){options={effect:options}}var hasOptions,effectName=!options?method:options===true||typeof options==="number"?defaultEffect:options.effect||defaultEffect;options=options||{};if(typeof options==="number"){options={duration:options}}hasOptions=!$.isEmptyObject(options);options.complete=callback;if(options.delay){element.delay(options.delay)}if(hasOptions&&$.effects&&($.effects.effect[effectName]||$.uiBackCompat!==false&&$.effects[effectName])){element[method](options)}else{if(effectName!==method&&element[effectName]){element[effectName](options.duration,options.easing,callback)}else{element.queue(function(next){$(this)[method]();if(callback){callback.call(element[0])}next()})}}}});if($.uiBackCompat!==false){$.Widget.prototype._getCreateOptions=function(){return $.metadata&&$.metadata.get(this.element[0])[this.widgetName]}}})(jQuery);
/*!
 * jQuery UI Mouse 1.9pre
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Mouse
 *
 * Depends:
 *	jquery.ui.widget.js
 */
(function($,undefined){var mouseHandled=false;$(document).mousedown(function(e){mouseHandled=false});$.widget("ui.mouse",{version:"1.9pre",options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var self=this;this.element.bind("mousedown."+this.widgetName,function(event){return self._mouseDown(event)}).bind("click."+this.widgetName,function(event){if(true===$.data(event.target,self.widgetName+".preventClickEvent")){$.removeData(event.target,self.widgetName+".preventClickEvent");event.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(event){if(mouseHandled){return}(this._mouseStarted&&this._mouseUp(event));this._mouseDownEvent=event;var self=this,btnIsLeft=(event.which==1),elIsCancel=(typeof this.options.cancel=="string"?$(event.target).closest(this.options.cancel).length:false);if(!btnIsLeft||elIsCancel||!this._mouseCapture(event)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){self.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=(this._mouseStart(event)!==false);if(!this._mouseStarted){event.preventDefault();return true}}if(true===$.data(event.target,this.widgetName+".preventClickEvent")){$.removeData(event.target,this.widgetName+".preventClickEvent")}this._mouseMoveDelegate=function(event){return self._mouseMove(event)};this._mouseUpDelegate=function(event){return self._mouseUp(event)};$(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);event.preventDefault();mouseHandled=true;return true},_mouseMove:function(event){if($.browser.msie&&!(document.documentMode>=9)&&!event.button){return this._mouseUp(event)}if(this._mouseStarted){this._mouseDrag(event);return event.preventDefault()}if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,event)!==false);(this._mouseStarted?this._mouseDrag(event):this._mouseUp(event))}return !this._mouseStarted},_mouseUp:function(event){$(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(event.target==this._mouseDownEvent.target){$.data(event.target,this.widgetName+".preventClickEvent",true)}this._mouseStop(event)}return false},_mouseDistanceMet:function(event){return(Math.max(Math.abs(this._mouseDownEvent.pageX-event.pageX),Math.abs(this._mouseDownEvent.pageY-event.pageY))>=this.options.distance)},_mouseDelayMet:function(event){return this.mouseDelayMet},_mouseStart:function(event){},_mouseDrag:function(event){},_mouseStop:function(event){},_mouseCapture:function(event){return true}})})(jQuery);(function($,undefined){$.widget("ui.draggable",$.ui.mouse,{version:"1.9pre",widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){if(this.options.helper=="original"&&!(/^(?:r|a|f)/).test(this.element.css("position"))){this.element[0].style.position="relative"}(this.options.addClasses&&this.element.addClass("ui-draggable"));(this.options.disabled&&this.element.addClass("ui-draggable-disabled"));this._mouseInit()},destroy:function(){if(!this.element.data("draggable")){return}this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this},_mouseCapture:function(event){var o=this.options;if(this.helper||o.disabled||$(event.target).is(".ui-resizable-handle")){return false}this.handle=this._getHandle(event);if(!this.handle){return false}$(o.iframeFix===true?"iframe":o.iframeFix).each(function(){$('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css($(this).offset()).appendTo("body")});return true},_mouseStart:function(event){var o=this.options;this.helper=this._createHelper(event);this._cacheHelperProportions();if($.ui.ddmanager){$.ui.ddmanager.current=this}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};$.extend(this.offset,{click:{left:event.pageX-this.offset.left,top:event.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(event);this.originalPageX=event.pageX;this.originalPageY=event.pageY;(o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt));if(o.containment){this._setContainment()}if(this._trigger("start",event)===false){this._clear();return false}this._cacheHelperProportions();if($.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event)}this.helper.addClass("ui-draggable-dragging");this._mouseDrag(event,true);if($.ui.ddmanager){$.ui.ddmanager.dragStart(this,event)}return true},_mouseDrag:function(event,noPropagation){this.position=this._generatePosition(event);this.positionAbs=this._convertPositionTo("absolute");if(!noPropagation){var ui=this._uiHash();if(this._trigger("drag",event,ui)===false){this._mouseUp({});return false}this.position=ui.position}if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}if($.ui.ddmanager){$.ui.ddmanager.drag(this,event)}return false},_mouseStop:function(event){var dropped=false;if($.ui.ddmanager&&!this.options.dropBehaviour){dropped=$.ui.ddmanager.drop(this,event)}if(this.dropped){dropped=this.dropped;this.dropped=false}if(!this.element[0]||!this.element[0].parentNode){return false}if((this.options.revert=="invalid"&&!dropped)||(this.options.revert=="valid"&&dropped)||this.options.revert===true||($.isFunction(this.options.revert)&&this.options.revert.call(this.element,dropped))){var self=this;$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(self._trigger("stop",event)!==false){self._clear()}})}else{if(this._trigger("stop",event)!==false){this._clear()}}return false},_mouseUp:function(event){if(this.options.iframeFix===true){$("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}if($.ui.ddmanager){$.ui.ddmanager.dragStop(this,event)}return $.ui.mouse.prototype._mouseUp.call(this,event)},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp({})}else{this._clear()}return this},_getHandle:function(event){var handle=!this.options.handle||!$(this.options.handle,this.element).length?true:false;$(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==event.target){handle=true}});return handle},_createHelper:function(event){var o=this.options;var helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event])):(o.helper=="clone"?this.element.clone().removeAttr("id"):this.element);if(!helper.parents("body").length){helper.appendTo((o.appendTo=="parent"?this.element[0].parentNode:o.appendTo))}if(helper[0]!=this.element[0]&&!(/(fixed|absolute)/).test(helper.css("position"))){helper.css("position","absolute")}return helper},_adjustOffsetFromHelper:function(obj){if(typeof obj=="string"){obj=obj.split(" ")}if($.isArray(obj)){obj={left:+obj[0],top:+obj[1]||0}}if("left" in obj){this.offset.click.left=obj.left+this.margins.left}if("right" in obj){this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left}if("top" in obj){this.offset.click.top=obj.top+this.margins.top}if("bottom" in obj){this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var po=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&$.contains(this.scrollParent[0],this.offsetParent[0])){po.left+=this.scrollParent.scrollLeft();po.top+=this.scrollParent.scrollTop()}if((this.offsetParent[0]==document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&$.browser.msie)){po={top:0,left:0}}return{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var p=this.element.position();return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0),right:(parseInt(this.element.css("marginRight"),10)||0),bottom:(parseInt(this.element.css("marginBottom"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var o=this.options;if(o.containment=="parent"){o.containment=this.helper[0].parentNode}if(o.containment=="document"||o.containment=="window"){this.containment=[o.containment=="document"?0:$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,o.containment=="document"?0:$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(o.containment=="document"?0:$(window).scrollLeft())+$(o.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(o.containment=="document"?0:$(window).scrollTop())+($(o.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!(/^(document|window|parent)$/).test(o.containment)&&o.containment.constructor!=Array){var c=$(o.containment);var ce=c[0];if(!ce){return}var co=c.offset();var over=($(ce).css("overflow")!="hidden");this.containment=[(parseInt($(ce).css("borderLeftWidth"),10)||0)+(parseInt($(ce).css("paddingLeft"),10)||0),(parseInt($(ce).css("borderTopWidth"),10)||0)+(parseInt($(ce).css("paddingTop"),10)||0),(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt($(ce).css("borderLeftWidth"),10)||0)-(parseInt($(ce).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt($(ce).css("borderTopWidth"),10)||0)-(parseInt($(ce).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=c}else{if(o.containment.constructor==Array){this.containment=o.containment}}},_convertPositionTo:function(d,pos){if(!pos){pos=this.position}var mod=d=="absolute"?1:-1;var o=this.options,scroll=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName);return{top:(pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-($.browser.safari&&$.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop()))*mod)),left:(pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-($.browser.safari&&$.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())*mod))}},_generatePosition:function(event){var o=this.options,scroll=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName);var pageX=event.pageX;var pageY=event.pageY;if(this.originalPosition){var containment;if(this.containment){if(this.relative_container){var co=this.relative_container.offset();containment=[this.containment[0]+co.left,this.containment[1]+co.top,this.containment[2]+co.left,this.containment[3]+co.top]}else{containment=this.containment}if(event.pageX-this.offset.click.left<containment[0]){pageX=containment[0]+this.offset.click.left}if(event.pageY-this.offset.click.top<containment[1]){pageY=containment[1]+this.offset.click.top}if(event.pageX-this.offset.click.left>containment[2]){pageX=containment[2]+this.offset.click.left}if(event.pageY-this.offset.click.top>containment[3]){pageY=containment[3]+this.offset.click.top}}if(o.grid){var top=o.grid[1]?this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY;pageY=containment?(!(top-this.offset.click.top<containment[1]||top-this.offset.click.top>containment[3])?top:(!(top-this.offset.click.top<containment[1])?top-o.grid[1]:top+o.grid[1])):top;var left=o.grid[0]?this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX;pageX=containment?(!(left-this.offset.click.left<containment[0]||left-this.offset.click.left>containment[2])?left:(!(left-this.offset.click.left<containment[0])?left-o.grid[0]:left+o.grid[0])):left}}return{top:(pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+($.browser.safari&&$.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop())))),left:(pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+($.browser.safari&&$.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())))}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval){this.helper.remove()}this.helper=null;this.cancelHelperRemoval=false},_trigger:function(type,event,ui){ui=ui||this._uiHash();$.ui.plugin.call(this,type,[event,ui]);if(type=="drag"){this.positionAbs=this._convertPositionTo("absolute")}return $.Widget.prototype._trigger.call(this,type,event,ui)},plugins:{},_uiHash:function(event){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});$.ui.plugin.add("draggable","connectToSortable",{start:function(event,ui){var inst=$(this).data("draggable"),o=inst.options,uiSortable=$.extend({},ui,{item:inst.element});inst.sortables=[];$(o.connectToSortable).each(function(){var sortable=$.data(this,"sortable");if(sortable&&!sortable.options.disabled){inst.sortables.push({instance:sortable,shouldRevert:sortable.options.revert});sortable.refreshPositions();sortable._trigger("activate",event,uiSortable)}})},stop:function(event,ui){var inst=$(this).data("draggable"),uiSortable=$.extend({},ui,{item:inst.element});$.each(inst.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;inst.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert){this.instance.options.revert=true}this.instance._mouseStop(event);this.instance.options.helper=this.instance.options._helper;if(inst.options.helper=="original"){this.instance.currentItem.css({top:"auto",left:"auto"})}}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",event,uiSortable)}})},drag:function(event,ui){var inst=$(this).data("draggable"),self=this;var checkPos=function(o){var dyClick=this.offset.click.top,dxClick=this.offset.click.left;var helperTop=this.positionAbs.top,helperLeft=this.positionAbs.left;var itemHeight=o.height,itemWidth=o.width;var itemTop=o.top,itemLeft=o.left;return $.ui.isOver(helperTop+dyClick,helperLeft+dxClick,itemTop,itemLeft,itemHeight,itemWidth)};$.each(inst.sortables,function(i){this.instance.positionAbs=inst.positionAbs;this.instance.helperProportions=inst.helperProportions;this.instance.offset.click=inst.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=$(self).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return ui.helper[0]};event.target=this.instance.currentItem[0];this.instance._mouseCapture(event,true);this.instance._mouseStart(event,true,true);this.instance.offset.click.top=inst.offset.click.top;this.instance.offset.click.left=inst.offset.click.left;this.instance.offset.parent.left-=inst.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=inst.offset.parent.top-this.instance.offset.parent.top;inst._trigger("toSortable",event);inst.dropped=this.instance.element;inst.currentItem=inst.element;this.instance.fromOutside=inst}if(this.instance.currentItem){this.instance._mouseDrag(event)}}else{if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",event,this.instance._uiHash(this.instance));this.instance._mouseStop(event,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();if(this.instance.placeholder){this.instance.placeholder.remove()}inst._trigger("fromSortable",event);inst.dropped=false}}})}});$.ui.plugin.add("draggable","cursor",{start:function(event,ui){var t=$("body"),o=$(this).data("draggable").options;if(t.css("cursor")){o._cursor=t.css("cursor")}t.css("cursor",o.cursor)},stop:function(event,ui){var o=$(this).data("draggable").options;if(o._cursor){$("body").css("cursor",o._cursor)}}});$.ui.plugin.add("draggable","opacity",{start:function(event,ui){var t=$(ui.helper),o=$(this).data("draggable").options;if(t.css("opacity")){o._opacity=t.css("opacity")}t.css("opacity",o.opacity)},stop:function(event,ui){var o=$(this).data("draggable").options;if(o._opacity){$(ui.helper).css("opacity",o._opacity)}}});$.ui.plugin.add("draggable","scroll",{start:function(event,ui){var i=$(this).data("draggable");if(i.scrollParent[0]!=document&&i.scrollParent[0].tagName!="HTML"){i.overflowOffset=i.scrollParent.offset()}},drag:function(event,ui){var i=$(this).data("draggable"),o=i.options,scrolled=false;if(i.scrollParent[0]!=document&&i.scrollParent[0].tagName!="HTML"){if(!o.axis||o.axis!="x"){if((i.overflowOffset.top+i.scrollParent[0].offsetHeight)-event.pageY<o.scrollSensitivity){i.scrollParent[0].scrollTop=scrolled=i.scrollParent[0].scrollTop+o.scrollSpeed}else{if(event.pageY-i.overflowOffset.top<o.scrollSensitivity){i.scrollParent[0].scrollTop=scrolled=i.scrollParent[0].scrollTop-o.scrollSpeed}}}if(!o.axis||o.axis!="y"){if((i.overflowOffset.left+i.scrollParent[0].offsetWidth)-event.pageX<o.scrollSensitivity){i.scrollParent[0].scrollLeft=scrolled=i.scrollParent[0].scrollLeft+o.scrollSpeed}else{if(event.pageX-i.overflowOffset.left<o.scrollSensitivity){i.scrollParent[0].scrollLeft=scrolled=i.scrollParent[0].scrollLeft-o.scrollSpeed}}}}else{if(!o.axis||o.axis!="x"){if(event.pageY-$(document).scrollTop()<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed)}else{if($(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed)}}}if(!o.axis||o.axis!="y"){if(event.pageX-$(document).scrollLeft()<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed)}else{if($(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed)}}}}if(scrolled!==false&&$.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(i,event)}}});$.ui.plugin.add("draggable","snap",{start:function(event,ui){var i=$(this).data("draggable"),o=i.options;i.snapElements=[];$(o.snap.constructor!=String?(o.snap.items||":data(draggable)"):o.snap).each(function(){var $t=$(this);var $o=$t.offset();if(this!=i.element[0]){i.snapElements.push({item:this,width:$t.outerWidth(),height:$t.outerHeight(),top:$o.top,left:$o.left})}})},drag:function(event,ui){var inst=$(this).data("draggable"),o=inst.options;var d=o.snapTolerance;var x1=ui.offset.left,x2=x1+inst.helperProportions.width,y1=ui.offset.top,y2=y1+inst.helperProportions.height;for(var i=inst.snapElements.length-1;i>=0;i--){var l=inst.snapElements[i].left,r=l+inst.snapElements[i].width,t=inst.snapElements[i].top,b=t+inst.snapElements[i].height;if(!((l-d<x1&&x1<r+d&&t-d<y1&&y1<b+d)||(l-d<x1&&x1<r+d&&t-d<y2&&y2<b+d)||(l-d<x2&&x2<r+d&&t-d<y1&&y1<b+d)||(l-d<x2&&x2<r+d&&t-d<y2&&y2<b+d))){if(inst.snapElements[i].snapping){(inst.options.snap.release&&inst.options.snap.release.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})))}inst.snapElements[i].snapping=false;continue}if(o.snapMode!="inner"){var ts=Math.abs(t-y2)<=d;var bs=Math.abs(b-y1)<=d;var ls=Math.abs(l-x2)<=d;var rs=Math.abs(r-x1)<=d;if(ts){ui.position.top=inst._convertPositionTo("relative",{top:t-inst.helperProportions.height,left:0}).top-inst.margins.top}if(bs){ui.position.top=inst._convertPositionTo("relative",{top:b,left:0}).top-inst.margins.top}if(ls){ui.position.left=inst._convertPositionTo("relative",{top:0,left:l-inst.helperProportions.width}).left-inst.margins.left}if(rs){ui.position.left=inst._convertPositionTo("relative",{top:0,left:r}).left-inst.margins.left}}var first=(ts||bs||ls||rs);if(o.snapMode!="outer"){var ts=Math.abs(t-y1)<=d;var bs=Math.abs(b-y2)<=d;var ls=Math.abs(l-x1)<=d;var rs=Math.abs(r-x2)<=d;if(ts){ui.position.top=inst._convertPositionTo("relative",{top:t,left:0}).top-inst.margins.top}if(bs){ui.position.top=inst._convertPositionTo("relative",{top:b-inst.helperProportions.height,left:0}).top-inst.margins.top}if(ls){ui.position.left=inst._convertPositionTo("relative",{top:0,left:l}).left-inst.margins.left}if(rs){ui.position.left=inst._convertPositionTo("relative",{top:0,left:r-inst.helperProportions.width}).left-inst.margins.left}}if(!inst.snapElements[i].snapping&&(ts||bs||ls||rs||first)){(inst.options.snap.snap&&inst.options.snap.snap.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})))}inst.snapElements[i].snapping=(ts||bs||ls||rs||first)}}});$.ui.plugin.add("draggable","stack",{start:function(event,ui){var o=$(this).data("draggable").options;var group=$.makeArray($(o.stack)).sort(function(a,b){return(parseInt($(a).css("zIndex"),10)||0)-(parseInt($(b).css("zIndex"),10)||0)});if(!group.length){return}var min=parseInt(group[0].style.zIndex)||0;$(group).each(function(i){this.style.zIndex=min+i});this[0].style.zIndex=min+group.length}});$.ui.plugin.add("draggable","zIndex",{start:function(event,ui){var t=$(ui.helper),o=$(this).data("draggable").options;if(t.css("zIndex")){o._zIndex=t.css("zIndex")}t.css("zIndex",o.zIndex)},stop:function(event,ui){var o=$(this).data("draggable").options;if(o._zIndex){$(ui.helper).css("zIndex",o._zIndex)}}})})(jQuery);(function($,undefined){$.widget("ui.droppable",{version:"1.9pre",widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect"},_create:function(){var o=this.options,accept=o.accept;this.isover=0;this.isout=1;this.accept=$.isFunction(accept)?accept:function(d){return d.is(accept)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};$.ui.ddmanager.droppables[o.scope]=$.ui.ddmanager.droppables[o.scope]||[];$.ui.ddmanager.droppables[o.scope].push(this);(o.addClasses&&this.element.addClass("ui-droppable"))},destroy:function(){var drop=$.ui.ddmanager.droppables[this.options.scope];for(var i=0;i<drop.length;i++){if(drop[i]==this){drop.splice(i,1)}}this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable");return this},_setOption:function(key,value){if(key=="accept"){this.accept=$.isFunction(value)?value:function(d){return d.is(value)}}$.Widget.prototype._setOption.apply(this,arguments)},_activate:function(event){var draggable=$.ui.ddmanager.current;if(this.options.activeClass){this.element.addClass(this.options.activeClass)}(draggable&&this._trigger("activate",event,this.ui(draggable)))},_deactivate:function(event){var draggable=$.ui.ddmanager.current;if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}(draggable&&this._trigger("deactivate",event,this.ui(draggable)))},_over:function(event){var draggable=$.ui.ddmanager.current;if(!draggable||(draggable.currentItem||draggable.element)[0]==this.element[0]){return}if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){if(this.options.hoverClass){this.element.addClass(this.options.hoverClass)}this._trigger("over",event,this.ui(draggable))}},_out:function(event){var draggable=$.ui.ddmanager.current;if(!draggable||(draggable.currentItem||draggable.element)[0]==this.element[0]){return}if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("out",event,this.ui(draggable))}},_drop:function(event,custom){var draggable=custom||$.ui.ddmanager.current;if(!draggable||(draggable.currentItem||draggable.element)[0]==this.element[0]){return false}var childrenIntersection=false;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var inst=$.data(this,"droppable");if(inst.options.greedy&&!inst.options.disabled&&inst.options.scope==draggable.options.scope&&inst.accept.call(inst.element[0],(draggable.currentItem||draggable.element))&&$.ui.intersect(draggable,$.extend(inst,{offset:inst.element.offset()}),inst.options.tolerance)){childrenIntersection=true;return false}});if(childrenIntersection){return false}if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("drop",event,this.ui(draggable));return this.element}return false},ui:function(c){return{draggable:(c.currentItem||c.element),helper:c.helper,position:c.position,offset:c.positionAbs}}});$.ui.intersect=function(draggable,droppable,toleranceMode){if(!droppable.offset){return false}var x1=(draggable.positionAbs||draggable.position.absolute).left,x2=x1+draggable.helperProportions.width,y1=(draggable.positionAbs||draggable.position.absolute).top,y2=y1+draggable.helperProportions.height;var l=droppable.offset.left,r=l+droppable.proportions.width,t=droppable.offset.top,b=t+droppable.proportions.height;switch(toleranceMode){case"fit":return(l<=x1&&x2<=r&&t<=y1&&y2<=b);break;case"intersect":return(l<x1+(draggable.helperProportions.width/2)&&x2-(draggable.helperProportions.width/2)<r&&t<y1+(draggable.helperProportions.height/2)&&y2-(draggable.helperProportions.height/2)<b);break;case"pointer":var draggableLeft=((draggable.positionAbs||draggable.position.absolute).left+(draggable.clickOffset||draggable.offset.click).left),draggableTop=((draggable.positionAbs||draggable.position.absolute).top+(draggable.clickOffset||draggable.offset.click).top),isOver=$.ui.isOver(draggableTop,draggableLeft,t,l,droppable.proportions.height,droppable.proportions.width);return isOver;break;case"touch":return((y1>=t&&y1<=b)||(y2>=t&&y2<=b)||(y1<t&&y2>b))&&((x1>=l&&x1<=r)||(x2>=l&&x2<=r)||(x1<l&&x2>r));break;default:return false;break}};$.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,event){var m=$.ui.ddmanager.droppables[t.options.scope]||[];var type=event?event.type:null;var list=(t.currentItem||t.element).find(":data(droppable)").andSelf();droppablesLoop:for(var i=0;i<m.length;i++){if(m[i].options.disabled||(t&&!m[i].accept.call(m[i].element[0],(t.currentItem||t.element)))){continue}for(var j=0;j<list.length;j++){if(list[j]==m[i].element[0]){m[i].proportions.height=0;continue droppablesLoop}}m[i].visible=m[i].element.css("display")!="none";if(!m[i].visible){continue}if(type=="mousedown"){m[i]._activate.call(m[i],event)}m[i].offset=m[i].element.offset();m[i].proportions={width:m[i].element[0].offsetWidth,height:m[i].element[0].offsetHeight}}},drop:function(draggable,event){var dropped=false;$.each($.ui.ddmanager.droppables[draggable.options.scope]||[],function(){if(!this.options){return}if(!this.options.disabled&&this.visible&&$.ui.intersect(draggable,this,this.options.tolerance)){dropped=dropped||this._drop.call(this,event)}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){this.isout=1;this.isover=0;this._deactivate.call(this,event)}});return dropped},dragStart:function(draggable,event){draggable.element.parentsUntil("body").bind("scroll.droppable",function(){if(!draggable.options.refreshPositions){$.ui.ddmanager.prepareOffsets(draggable,event)}})},drag:function(draggable,event){if(draggable.options.refreshPositions){$.ui.ddmanager.prepareOffsets(draggable,event)}$.each($.ui.ddmanager.droppables[draggable.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return}var intersects=$.ui.intersect(draggable,this,this.options.tolerance);var c=!intersects&&this.isover==1?"isout":(intersects&&this.isover==0?"isover":null);if(!c){return}var parentInstance;if(this.options.greedy){var parent=this.element.parents(":data(droppable):eq(0)");if(parent.length){parentInstance=$.data(parent[0],"droppable");parentInstance.greedyChild=(c=="isover"?1:0)}}if(parentInstance&&c=="isover"){parentInstance.isover=0;parentInstance.isout=1;parentInstance._out.call(parentInstance,event)}this[c]=1;this[c=="isout"?"isover":"isout"]=0;this[c=="isover"?"_over":"_out"].call(this,event);if(parentInstance&&c=="isout"){parentInstance.isout=0;parentInstance.isover=1;parentInstance._over.call(parentInstance,event)}})},dragStop:function(draggable,event){draggable.element.parentsUntil("body").unbind("scroll.droppable");if(!draggable.options.refreshPositions){$.ui.ddmanager.prepareOffsets(draggable,event)}}}})(jQuery);(function($,undefined){$.widget("ui.resizable",$.ui.mouse,{version:"1.9pre",widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1000},_create:function(){var self=this,o=this.options;this.element.addClass("ui-resizable");$.extend(this,{_aspectRatio:!!(o.aspectRatio),aspectRatio:o.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:o.helper||o.ghost||o.animate?o.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){if(/relative/.test(this.element.css("position"))&&$.browser.opera){this.element.css({position:"relative",top:"auto",left:"auto"})}this.element.wrap($('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("resizable",this.element.data("resizable"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=o.handles||(!$(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});if(this.handles.constructor==String){if(this.handles=="all"){this.handles="n,e,s,w,se,sw,ne,nw"}var n=this.handles.split(",");this.handles={};for(var i=0;i<n.length;i++){var handle=$.trim(n[i]),hname="ui-resizable-"+handle;var axis=$('<div class="ui-resizable-handle '+hname+'"></div>');if(/sw|se|ne|nw/.test(handle)){axis.css({zIndex:++o.zIndex})}if("se"==handle){axis.addClass("ui-icon ui-icon-gripsmall-diagonal-se")}this.handles[handle]=".ui-resizable-"+handle;this.element.append(axis)}}this._renderAxis=function(target){target=target||this.element;for(var i in this.handles){if(this.handles[i].constructor==String){this.handles[i]=$(this.handles[i],this.element).show()}if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var axis=$(this.handles[i],this.element),padWrapper=0;padWrapper=/sw|ne|nw|se|n|s/.test(i)?axis.outerHeight():axis.outerWidth();var padPos=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join("");target.css(padPos,padWrapper);this._proportionallyResize()}if(!$(this.handles[i]).length){continue}}};this._renderAxis(this.element);this._handles=$(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!self.resizing){if(this.className){var axis=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)}self.axis=axis&&axis[1]?axis[1]:"se"}});if(o.autoHide){this._handles.hide();$(this.element).addClass("ui-resizable-autohide").hover(function(){if(o.disabled){return}$(this).removeClass("ui-resizable-autohide");self._handles.show()},function(){if(o.disabled){return}if(!self.resizing){$(this).addClass("ui-resizable-autohide");self._handles.hide()}})}this._mouseInit()},destroy:function(){this._mouseDestroy();var _destroy=function(exp){$(exp).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){_destroy(this.element);var wrapper=this.element;wrapper.after(this.originalElement.css({position:wrapper.css("position"),width:wrapper.outerWidth(),height:wrapper.outerHeight(),top:wrapper.css("top"),left:wrapper.css("left")})).remove()}this.originalElement.css("resize",this.originalResizeStyle);_destroy(this.originalElement);return this},_mouseCapture:function(event){var handle=false;for(var i in this.handles){if($(this.handles[i])[0]==event.target){handle=true}}return !this.options.disabled&&handle},_mouseStart:function(event){var o=this.options,iniPos=this.element.position(),el=this.element;this.resizing=true;this.documentScroll={top:$(document).scrollTop(),left:$(document).scrollLeft()};if(el.is(".ui-draggable")||(/absolute/).test(el.css("position"))){el.css({position:"absolute",top:iniPos.top,left:iniPos.left})}if($.browser.opera&&(/relative/).test(el.css("position"))){el.css({position:"relative",top:"auto",left:"auto"})}this._renderProxy();var curleft=num(this.helper.css("left")),curtop=num(this.helper.css("top"));if(o.containment){curleft+=$(o.containment).scrollLeft()||0;curtop+=$(o.containment).scrollTop()||0}this.offset=this.helper.offset();this.position={left:curleft,top:curtop};this.size=this._helper?{width:el.outerWidth(),height:el.outerHeight()}:{width:el.width(),height:el.height()};this.originalSize=this._helper?{width:el.outerWidth(),height:el.outerHeight()}:{width:el.width(),height:el.height()};this.originalPosition={left:curleft,top:curtop};this.sizeDiff={width:el.outerWidth()-el.width(),height:el.outerHeight()-el.height()};this.originalMousePosition={left:event.pageX,top:event.pageY};this.aspectRatio=(typeof o.aspectRatio=="number")?o.aspectRatio:((this.originalSize.width/this.originalSize.height)||1);var cursor=$(".ui-resizable-"+this.axis).css("cursor");$("body").css("cursor",cursor=="auto"?this.axis+"-resize":cursor);el.addClass("ui-resizable-resizing");this._propagate("start",event);return true},_mouseDrag:function(event){var el=this.helper,o=this.options,props={},self=this,smp=this.originalMousePosition,a=this.axis;var dx=(event.pageX-smp.left)||0,dy=(event.pageY-smp.top)||0;var trigger=this._change[a];if(!trigger){return false}var data=trigger.apply(this,[event,dx,dy]),ie6=$.browser.msie&&$.browser.version<7,csdif=this.sizeDiff;this._updateVirtualBoundaries(event.shiftKey);if(this._aspectRatio||event.shiftKey){data=this._updateRatio(data,event)}data=this._respectSize(data,event);this._propagate("resize",event);el.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});if(!this._helper&&this._proportionallyResizeElements.length){this._proportionallyResize()}this._updateCache(data);this._trigger("resize",event,this.ui());return false},_mouseStop:function(event){this.resizing=false;var o=this.options,self=this;if(this._helper){var pr=this._proportionallyResizeElements,ista=pr.length&&(/textarea/i).test(pr[0].nodeName),soffseth=ista&&$.ui.hasScroll(pr[0],"left")?0:self.sizeDiff.height,soffsetw=ista?0:self.sizeDiff.width;var s={width:(self.helper.width()-soffsetw),height:(self.helper.height()-soffseth)},left=(parseInt(self.element.css("left"),10)+(self.position.left-self.originalPosition.left))||null,top=(parseInt(self.element.css("top"),10)+(self.position.top-self.originalPosition.top))||null;if(!o.animate){this.element.css($.extend(s,{top:top,left:left}))}self.helper.height(self.size.height);self.helper.width(self.size.width);if(this._helper&&!o.animate){this._proportionallyResize()}}$("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",event);if(this._helper){this.helper.remove()}return false},_updateVirtualBoundaries:function(forceAspectRatio){var o=this.options,pMinWidth,pMaxWidth,pMinHeight,pMaxHeight,b;b={minWidth:isNumber(o.minWidth)?o.minWidth:0,maxWidth:isNumber(o.maxWidth)?o.maxWidth:Infinity,minHeight:isNumber(o.minHeight)?o.minHeight:0,maxHeight:isNumber(o.maxHeight)?o.maxHeight:Infinity};if(this._aspectRatio||forceAspectRatio){pMinWidth=b.minHeight*this.aspectRatio;pMinHeight=b.minWidth/this.aspectRatio;pMaxWidth=b.maxHeight*this.aspectRatio;pMaxHeight=b.maxWidth/this.aspectRatio;if(pMinWidth>b.minWidth){b.minWidth=pMinWidth}if(pMinHeight>b.minHeight){b.minHeight=pMinHeight}if(pMaxWidth<b.maxWidth){b.maxWidth=pMaxWidth}if(pMaxHeight<b.maxHeight){b.maxHeight=pMaxHeight}}this._vBoundaries=b},_updateCache:function(data){var o=this.options;this.offset=this.helper.offset();if(isNumber(data.left)){this.position.left=data.left}if(isNumber(data.top)){this.position.top=data.top}if(isNumber(data.height)){this.size.height=data.height}if(isNumber(data.width)){this.size.width=data.width}},_updateRatio:function(data,event){var o=this.options,cpos=this.position,csize=this.size,a=this.axis;if(isNumber(data.height)){data.width=(data.height*this.aspectRatio)}else{if(isNumber(data.width)){data.height=(data.width/this.aspectRatio)}}if(a=="sw"){data.left=cpos.left+(csize.width-data.width);data.top=null}if(a=="nw"){data.top=cpos.top+(csize.height-data.height);data.left=cpos.left+(csize.width-data.width)}return data},_respectSize:function(data,event){var el=this.helper,o=this._vBoundaries,pRatio=this._aspectRatio||event.shiftKey,a=this.axis,ismaxw=isNumber(data.width)&&o.maxWidth&&(o.maxWidth<data.width),ismaxh=isNumber(data.height)&&o.maxHeight&&(o.maxHeight<data.height),isminw=isNumber(data.width)&&o.minWidth&&(o.minWidth>data.width),isminh=isNumber(data.height)&&o.minHeight&&(o.minHeight>data.height);if(isminw){data.width=o.minWidth}if(isminh){data.height=o.minHeight}if(ismaxw){data.width=o.maxWidth}if(ismaxh){data.height=o.maxHeight}var dw=this.originalPosition.left+this.originalSize.width,dh=this.position.top+this.size.height;var cw=/sw|nw|w/.test(a),ch=/nw|ne|n/.test(a);if(isminw&&cw){data.left=dw-o.minWidth}if(ismaxw&&cw){data.left=dw-o.maxWidth}if(isminh&&ch){data.top=dh-o.minHeight}if(ismaxh&&ch){data.top=dh-o.maxHeight}var isNotwh=!data.width&&!data.height;if(isNotwh&&!data.left&&data.top){data.top=null}else{if(isNotwh&&!data.top&&data.left){data.left=null}}return data},_proportionallyResize:function(){var o=this.options;if(!this._proportionallyResizeElements.length){return}var element=this.helper||this.element;for(var i=0;i<this._proportionallyResizeElements.length;i++){var prel=this._proportionallyResizeElements[i];if(!this.borderDif){var b=[prel.css("borderTopWidth"),prel.css("borderRightWidth"),prel.css("borderBottomWidth"),prel.css("borderLeftWidth")],p=[prel.css("paddingTop"),prel.css("paddingRight"),prel.css("paddingBottom"),prel.css("paddingLeft")];this.borderDif=$.map(b,function(v,i){var border=parseInt(v,10)||0,padding=parseInt(p[i],10)||0;return border+padding})}if($.browser.msie&&!(!($(element).is(":hidden")||$(element).parents(":hidden").length))){continue}prel.css({height:(element.height()-this.borderDif[0]-this.borderDif[2])||0,width:(element.width()-this.borderDif[1]-this.borderDif[3])||0})}},_renderProxy:function(){var el=this.element,o=this.options;this.elementOffset=el.offset();if(this._helper){this.helper=this.helper||$('<div style="overflow:hidden;"></div>');var ie6=$.browser.msie&&$.browser.version<7,ie6offset=(ie6?1:0),pxyoffset=(ie6?2:-1);this.helper.addClass(this._helper).css({width:this.element.outerWidth()+pxyoffset,height:this.element.outerHeight()+pxyoffset,position:"absolute",left:this.elementOffset.left-ie6offset+"px",top:this.elementOffset.top-ie6offset+"px",zIndex:++o.zIndex});this.helper.appendTo("body").disableSelection()}else{this.helper=this.element}},_change:{e:function(event,dx,dy){return{width:this.originalSize.width+dx}},w:function(event,dx,dy){var o=this.options,cs=this.originalSize,sp=this.originalPosition;return{left:sp.left+dx,width:cs.width-dx}},n:function(event,dx,dy){var o=this.options,cs=this.originalSize,sp=this.originalPosition;return{top:sp.top+dy,height:cs.height-dy}},s:function(event,dx,dy){return{height:this.originalSize.height+dy}},se:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]))},sw:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]))},ne:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]))},nw:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]))}},_propagate:function(n,event){$.ui.plugin.call(this,n,[event,this.ui()]);(n!="resize"&&this._trigger(n,event,this.ui()))},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});$.ui.plugin.add("resizable","alsoResize",{start:function(event,ui){var self=$(this).data("resizable"),o=self.options;var _store=function(exp){$(exp).each(function(){var el=$(this);el.data("resizable-alsoresize",{width:parseInt(el.width(),10),height:parseInt(el.height(),10),left:parseInt(el.css("left"),10),top:parseInt(el.css("top"),10),position:el.css("position")})})};if(typeof(o.alsoResize)=="object"&&!o.alsoResize.parentNode){if(o.alsoResize.length){o.alsoResize=o.alsoResize[0];_store(o.alsoResize)}else{$.each(o.alsoResize,function(exp){_store(exp)})}}else{_store(o.alsoResize)}},resize:function(event,ui){var self=$(this).data("resizable"),o=self.options,os=self.originalSize,op=self.originalPosition;var delta={height:(self.size.height-os.height)||0,width:(self.size.width-os.width)||0,top:(self.position.top-op.top)||0,left:(self.position.left-op.left)||0},_alsoResize=function(exp,c){$(exp).each(function(){var el=$(this),start=$(this).data("resizable-alsoresize"),style={},css=c&&c.length?c:el.parents(ui.originalElement[0]).length?["width","height"]:["width","height","top","left"];$.each(css,function(i,prop){var sum=(start[prop]||0)+(delta[prop]||0);if(sum&&sum>=0){style[prop]=sum||null}});if($.browser.opera&&/relative/.test(el.css("position"))){self._revertToRelativePosition=true;el.css({position:"absolute",top:"auto",left:"auto"})}el.css(style)})};if(typeof(o.alsoResize)=="object"&&!o.alsoResize.nodeType){$.each(o.alsoResize,function(exp,c){_alsoResize(exp,c)})}else{_alsoResize(o.alsoResize)}},stop:function(event,ui){var self=$(this).data("resizable"),o=self.options;var _reset=function(exp){$(exp).each(function(){var el=$(this);el.css({position:el.data("resizable-alsoresize").position})})};if(self._revertToRelativePosition){self._revertToRelativePosition=false;if(typeof(o.alsoResize)=="object"&&!o.alsoResize.nodeType){$.each(o.alsoResize,function(exp){_reset(exp)})}else{_reset(o.alsoResize)}}$(this).removeData("resizable-alsoresize")}});$.ui.plugin.add("resizable","animate",{stop:function(event,ui){var self=$(this).data("resizable"),o=self.options;var pr=self._proportionallyResizeElements,ista=pr.length&&(/textarea/i).test(pr[0].nodeName),soffseth=ista&&$.ui.hasScroll(pr[0],"left")?0:self.sizeDiff.height,soffsetw=ista?0:self.sizeDiff.width;var style={width:(self.size.width-soffsetw),height:(self.size.height-soffseth)},left=(parseInt(self.element.css("left"),10)+(self.position.left-self.originalPosition.left))||null,top=(parseInt(self.element.css("top"),10)+(self.position.top-self.originalPosition.top))||null;self.element.animate($.extend(style,top&&left?{top:top,left:left}:{}),{duration:o.animateDuration,easing:o.animateEasing,step:function(){var data={width:parseInt(self.element.css("width"),10),height:parseInt(self.element.css("height"),10),top:parseInt(self.element.css("top"),10),left:parseInt(self.element.css("left"),10)};if(pr&&pr.length){$(pr[0]).css({width:data.width,height:data.height})}self._updateCache(data);self._propagate("resize",event)}})}});$.ui.plugin.add("resizable","containment",{start:function(event,ui){var self=$(this).data("resizable"),o=self.options,el=self.element;var oc=o.containment,ce=(oc instanceof $)?oc.get(0):(/parent/.test(oc))?el.parent().get(0):oc;if(!ce){return}self.containerElement=$(ce);if(/document/.test(oc)||oc==document){self.containerOffset={left:0,top:0};self.containerPosition={left:0,top:0};self.parentData={element:$(document),left:0,top:0,width:$(document).width(),height:$(document).height()||document.body.parentNode.scrollHeight}}else{var element=$(ce),p=[];$(["Top","Right","Left","Bottom"]).each(function(i,name){p[i]=num(element.css("padding"+name))});self.containerOffset=element.offset();self.containerPosition=element.position();self.containerSize={height:(element.innerHeight()-p[3]),width:(element.innerWidth()-p[1])};var co=self.containerOffset,ch=self.containerSize.height,cw=self.containerSize.width,width=($.ui.hasScroll(ce,"left")?ce.scrollWidth:cw),height=($.ui.hasScroll(ce)?ce.scrollHeight:ch);self.parentData={element:ce,left:co.left,top:co.top,width:width,height:height}}},resize:function(event,ui){var self=$(this).data("resizable"),o=self.options,ps=self.containerSize,co=self.containerOffset,cs=self.size,cp=self.position,pRatio=self._aspectRatio||event.shiftKey,cop={top:0,left:0},ce=self.containerElement;if(ce[0]!=document&&(/static/).test(ce.css("position"))){cop=co}if(cp.left<(self._helper?co.left:0)){self.size.width=self.size.width+(self._helper?(self.position.left-co.left):(self.position.left-cop.left));if(pRatio){self.size.height=self.size.width/o.aspectRatio}self.position.left=o.helper?co.left:0}if(cp.top<(self._helper?co.top:0)){self.size.height=self.size.height+(self._helper?(self.position.top-co.top):self.position.top);if(pRatio){self.size.width=self.size.height*o.aspectRatio}self.position.top=self._helper?co.top:0}self.offset.left=self.parentData.left+self.position.left;self.offset.top=self.parentData.top+self.position.top;var woset=Math.abs((self._helper?self.offset.left-cop.left:(self.offset.left-cop.left))+self.sizeDiff.width),hoset=Math.abs((self._helper?self.offset.top-cop.top:(self.offset.top-co.top))+self.sizeDiff.height);var isParent=self.containerElement.get(0)==self.element.parent().get(0),isOffsetRelative=/relative|absolute/.test(self.containerElement.css("position"));if(isParent&&isOffsetRelative){woset-=self.parentData.left}if(woset+self.size.width>=self.parentData.width){self.size.width=self.parentData.width-woset;if(pRatio){self.size.height=self.size.width/self.aspectRatio}}if(hoset+self.size.height>=self.parentData.height){self.size.height=self.parentData.height-hoset;if(pRatio){self.size.width=self.size.height*self.aspectRatio}}},stop:function(event,ui){var self=$(this).data("resizable"),o=self.options,cp=self.position,co=self.containerOffset,cop=self.containerPosition,ce=self.containerElement;var helper=$(self.helper),ho=helper.offset(),w=helper.outerWidth()-self.sizeDiff.width,h=helper.outerHeight()-self.sizeDiff.height;if(self._helper&&!o.animate&&(/relative/).test(ce.css("position"))){$(this).css({left:ho.left-cop.left-co.left,width:w,height:h})}if(self._helper&&!o.animate&&(/static/).test(ce.css("position"))){$(this).css({left:ho.left-cop.left-co.left,width:w,height:h})}}});$.ui.plugin.add("resizable","ghost",{start:function(event,ui){var self=$(this).data("resizable"),o=self.options,cs=self.size;self.ghost=self.originalElement.clone();self.ghost.css({opacity:0.25,display:"block",position:"relative",height:cs.height,width:cs.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof o.ghost=="string"?o.ghost:"");self.ghost.appendTo(self.helper)},resize:function(event,ui){var self=$(this).data("resizable"),o=self.options;if(self.ghost){self.ghost.css({position:"relative",height:self.size.height,width:self.size.width})}},stop:function(event,ui){var self=$(this).data("resizable"),o=self.options;if(self.ghost&&self.helper){self.helper.get(0).removeChild(self.ghost.get(0))}}});$.ui.plugin.add("resizable","grid",{resize:function(event,ui){var self=$(this).data("resizable"),o=self.options,cs=self.size,os=self.originalSize,op=self.originalPosition,a=self.axis,ratio=o._aspectRatio||event.shiftKey;o.grid=typeof o.grid=="number"?[o.grid,o.grid]:o.grid;var ox=Math.round((cs.width-os.width)/(o.grid[0]||1))*(o.grid[0]||1),oy=Math.round((cs.height-os.height)/(o.grid[1]||1))*(o.grid[1]||1);if(/^(se|s|e)$/.test(a)){self.size.width=os.width+ox;self.size.height=os.height+oy}else{if(/^(ne)$/.test(a)){self.size.width=os.width+ox;self.size.height=os.height+oy;self.position.top=op.top-oy}else{if(/^(sw)$/.test(a)){self.size.width=os.width+ox;self.size.height=os.height+oy;self.position.left=op.left-ox}else{self.size.width=os.width+ox;self.size.height=os.height+oy;self.position.top=op.top-oy;self.position.left=op.left-ox}}}}});var num=function(v){return parseInt(v,10)||0};var isNumber=function(value){return !isNaN(parseInt(value,10))}})(jQuery);(function($,undefined){$.widget("ui.selectable",$.ui.mouse,{version:"1.9pre",options:{appendTo:"body",autoRefresh:true,distance:0,filter:"*",tolerance:"touch"},_create:function(){var self=this;this.element.addClass("ui-selectable");this.dragged=false;var selectees;this.refresh=function(){selectees=$(self.options.filter,self.element[0]);selectees.each(function(){var $this=$(this);var pos=$this.offset();$.data(this,"selectable-item",{element:this,$element:$this,left:pos.left,top:pos.top,right:pos.left+$this.outerWidth(),bottom:pos.top+$this.outerHeight(),startselected:false,selected:$this.hasClass("ui-selected"),selecting:$this.hasClass("ui-selecting"),unselecting:$this.hasClass("ui-unselecting")})})};this.refresh();this.selectees=selectees.addClass("ui-selectee");this._mouseInit();this.helper=$("<div class='ui-selectable-helper'></div>")},destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable");this._mouseDestroy();return this},_mouseStart:function(event){var self=this;this.opos=[event.pageX,event.pageY];if(this.options.disabled){return}var options=this.options;this.selectees=$(options.filter,this.element[0]);this._trigger("start",event);$(options.appendTo).append(this.helper);this.helper.css({left:event.clientX,top:event.clientY,width:0,height:0});if(options.autoRefresh){this.refresh()}this.selectees.filter(".ui-selected").each(function(){var selectee=$.data(this,"selectable-item");selectee.startselected=true;if(!event.metaKey){selectee.$element.removeClass("ui-selected");selectee.selected=false;selectee.$element.addClass("ui-unselecting");selectee.unselecting=true;self._trigger("unselecting",event,{unselecting:selectee.element})}});$(event.target).parents().andSelf().each(function(){var selectee=$.data(this,"selectable-item");if(selectee){var doSelect=!event.metaKey||!selectee.$element.hasClass("ui-selected");selectee.$element.removeClass(doSelect?"ui-unselecting":"ui-selected").addClass(doSelect?"ui-selecting":"ui-unselecting");selectee.unselecting=!doSelect;selectee.selecting=doSelect;selectee.selected=doSelect;if(doSelect){self._trigger("selecting",event,{selecting:selectee.element})}else{self._trigger("unselecting",event,{unselecting:selectee.element})}return false}})},_mouseDrag:function(event){var self=this;this.dragged=true;if(this.options.disabled){return}var options=this.options;var x1=this.opos[0],y1=this.opos[1],x2=event.pageX,y2=event.pageY;if(x1>x2){var tmp=x2;x2=x1;x1=tmp}if(y1>y2){var tmp=y2;y2=y1;y1=tmp}this.helper.css({left:x1,top:y1,width:x2-x1,height:y2-y1});this.selectees.each(function(){var selectee=$.data(this,"selectable-item");if(!selectee||selectee.element==self.element[0]){return}var hit=false;if(options.tolerance=="touch"){hit=(!(selectee.left>x2||selectee.right<x1||selectee.top>y2||selectee.bottom<y1))}else{if(options.tolerance=="fit"){hit=(selectee.left>x1&&selectee.right<x2&&selectee.top>y1&&selectee.bottom<y2)}}if(hit){if(selectee.selected){selectee.$element.removeClass("ui-selected");selectee.selected=false}if(selectee.unselecting){selectee.$element.removeClass("ui-unselecting");selectee.unselecting=false}if(!selectee.selecting){selectee.$element.addClass("ui-selecting");selectee.selecting=true;self._trigger("selecting",event,{selecting:selectee.element})}}else{if(selectee.selecting){if(event.metaKey&&selectee.startselected){selectee.$element.removeClass("ui-selecting");selectee.selecting=false;selectee.$element.addClass("ui-selected");selectee.selected=true}else{selectee.$element.removeClass("ui-selecting");selectee.selecting=false;if(selectee.startselected){selectee.$element.addClass("ui-unselecting");selectee.unselecting=true}self._trigger("unselecting",event,{unselecting:selectee.element})}}if(selectee.selected){if(!event.metaKey&&!selectee.startselected){selectee.$element.removeClass("ui-selected");selectee.selected=false;selectee.$element.addClass("ui-unselecting");selectee.unselecting=true;self._trigger("unselecting",event,{unselecting:selectee.element})}}}});return false},_mouseStop:function(event){var self=this;this.dragged=false;var options=this.options;$(".ui-unselecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");selectee.$element.removeClass("ui-unselecting");selectee.unselecting=false;selectee.startselected=false;self._trigger("unselected",event,{unselected:selectee.element})});$(".ui-selecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");selectee.$element.removeClass("ui-selecting").addClass("ui-selected");selectee.selecting=false;selectee.selected=true;selectee.startselected=true;self._trigger("selected",event,{selected:selectee.element})});this._trigger("stop",event);this.helper.remove();return false}})})(jQuery);(function($,undefined){$.widget("ui.sortable",$.ui.mouse,{version:"1.9pre",widgetEventPrefix:"sort",options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000},_create:function(){var o=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?o.axis==="x"||(/left|right/).test(this.items[0].item.css("float"))||(/inline|table-cell/).test(this.items[0].item.css("display")):false;this.offset=this.element.offset();this._mouseInit()},destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable");this._mouseDestroy();for(var i=this.items.length-1;i>=0;i--){this.items[i].item.removeData("sortable-item")}return this},_setOption:function(key,value){if(key==="disabled"){this.options[key]=value;this.widget().toggleClass("ui-sortable-disabled",!!value)}else{$.Widget.prototype._setOption.apply(this,arguments)}},_mouseCapture:function(event,overrideHandle){if(this.reverting){return false}if(this.options.disabled||this.options.type=="static"){return false}this._refreshItems(event);var currentItem=null,self=this,nodes=$(event.target).parents().each(function(){if($.data(this,"sortable-item")==self){currentItem=$(this);return false}});if($.data(event.target,"sortable-item")==self){currentItem=$(event.target)}if(!currentItem){return false}if(this.options.handle&&!overrideHandle){var validHandle=false;$(this.options.handle,currentItem).find("*").andSelf().each(function(){if(this==event.target){validHandle=true}});if(!validHandle){return false}}this.currentItem=currentItem;this._removeCurrentsFromItems();return true},_mouseStart:function(event,overrideHandle,noActivation){var o=this.options,self=this;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(event);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");$.extend(this.offset,{click:{left:event.pageX-this.offset.left,top:event.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this._generatePosition(event);this.originalPageX=event.pageX;this.originalPageY=event.pageY;(o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt));this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!=this.currentItem[0]){this.currentItem.hide()}this._createPlaceholder();if(o.containment){this._setContainment()}if(o.cursor){if($("body").css("cursor")){this._storedCursor=$("body").css("cursor")}$("body").css("cursor",o.cursor)}if(o.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity")}this.helper.css("opacity",o.opacity)}if(o.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex")}this.helper.css("zIndex",o.zIndex)}if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"){this.overflowOffset=this.scrollParent.offset()}this._trigger("start",event,this._uiHash());if(!this._preserveHelperProportions){this._cacheHelperProportions()}if(!noActivation){for(var i=this.containers.length-1;i>=0;i--){this.containers[i]._trigger("activate",event,self._uiHash(this))}}if($.ui.ddmanager){$.ui.ddmanager.current=this}if($.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event)}this.dragging=true;this.helper.addClass("ui-sortable-helper");this._mouseDrag(event);return true},_mouseDrag:function(event){this.position=this._generatePosition(event);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs}if(this.options.scroll){var o=this.options,scrolled=false;if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"){if((this.overflowOffset.top+this.scrollParent[0].offsetHeight)-event.pageY<o.scrollSensitivity){this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop+o.scrollSpeed}else{if(event.pageY-this.overflowOffset.top<o.scrollSensitivity){this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop-o.scrollSpeed}}if((this.overflowOffset.left+this.scrollParent[0].offsetWidth)-event.pageX<o.scrollSensitivity){this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft+o.scrollSpeed}else{if(event.pageX-this.overflowOffset.left<o.scrollSensitivity){this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft-o.scrollSpeed}}}else{if(event.pageY-$(document).scrollTop()<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed)}else{if($(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed)}}if(event.pageX-$(document).scrollLeft()<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed)}else{if($(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed)}}}if(scrolled!==false&&$.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event)}}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}for(var i=this.items.length-1;i>=0;i--){var item=this.items[i],itemElement=item.item[0],intersection=this._intersectsWithPointer(item);if(!intersection){continue}if(itemElement!=this.currentItem[0]&&this.placeholder[intersection==1?"next":"prev"]()[0]!=itemElement&&!$.contains(this.placeholder[0],itemElement)&&(this.options.type=="semi-dynamic"?!$.contains(this.element[0],itemElement):true)){this.direction=intersection==1?"down":"up";if(this.options.tolerance=="pointer"||this._intersectsWithSides(item)){this._rearrange(event,item)}else{break}this._trigger("change",event,this._uiHash());break}}this._contactContainers(event);if($.ui.ddmanager){$.ui.ddmanager.drag(this,event)}this._trigger("sort",event,this._uiHash());this.lastPositionAbs=this.positionAbs;return false},_mouseStop:function(event,noPropagation){if(!event){return}if($.ui.ddmanager&&!this.options.dropBehaviour){$.ui.ddmanager.drop(this,event)}if(this.options.revert){var self=this;var cur=self.placeholder.offset();self.reverting=true;$(this.helper).animate({left:cur.left-this.offset.parent.left-self.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:cur.top-this.offset.parent.top-self.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){self._clear(event)})}else{this._clear(event,noPropagation)}return false},cancel:function(){var self=this;if(this.dragging){this._mouseUp({target:null});if(this.options.helper=="original"){this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}for(var i=this.containers.length-1;i>=0;i--){this.containers[i]._trigger("deactivate",null,self._uiHash(this));if(this.containers[i].containerCache.over){this.containers[i]._trigger("out",null,self._uiHash(this));this.containers[i].containerCache.over=0}}}if(this.placeholder){if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0])}if(this.options.helper!="original"&&this.helper&&this.helper[0].parentNode){this.helper.remove()}$.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){$(this.domPosition.prev).after(this.currentItem)}else{$(this.domPosition.parent).prepend(this.currentItem)}}return this},serialize:function(o){var items=this._getItemsAsjQuery(o&&o.connected);var str=[];o=o||{};$(items).each(function(){var res=($(o.item||this).attr(o.attribute||"id")||"").match(o.expression||(/(.+)[-=_](.+)/));if(res){str.push((o.key||res[1]+"[]")+"="+(o.key&&o.expression?res[1]:res[2]))}});if(!str.length&&o.key){str.push(o.key+"=")}return str.join("&")},toArray:function(o){var items=this._getItemsAsjQuery(o&&o.connected);var ret=[];o=o||{};items.each(function(){ret.push($(o.item||this).attr(o.attribute||"id")||"")});return ret},_intersectsWith:function(item){var x1=this.positionAbs.left,x2=x1+this.helperProportions.width,y1=this.positionAbs.top,y2=y1+this.helperProportions.height;var l=item.left,r=l+item.width,t=item.top,b=t+item.height;var dyClick=this.offset.click.top,dxClick=this.offset.click.left;var isOverElement=(y1+dyClick)>t&&(y1+dyClick)<b&&(x1+dxClick)>l&&(x1+dxClick)<r;if(this.options.tolerance=="pointer"||this.options.forcePointerForContainers||(this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>item[this.floating?"width":"height"])){return isOverElement}else{return(l<x1+(this.helperProportions.width/2)&&x2-(this.helperProportions.width/2)<r&&t<y1+(this.helperProportions.height/2)&&y2-(this.helperProportions.height/2)<b)}},_intersectsWithPointer:function(item){var isOverElementHeight=$.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,item.top,item.height),isOverElementWidth=$.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,item.left,item.width),isOverElement=isOverElementHeight&&isOverElementWidth,verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();if(!isOverElement){return false}return this.floating?(((horizontalDirection&&horizontalDirection=="right")||verticalDirection=="down")?2:1):(verticalDirection&&(verticalDirection=="down"?2:1))},_intersectsWithSides:function(item){var isOverBottomHalf=$.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,item.top+(item.height/2),item.height),isOverRightHalf=$.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,item.left+(item.width/2),item.width),verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();if(this.floating&&horizontalDirection){return((horizontalDirection=="right"&&isOverRightHalf)||(horizontalDirection=="left"&&!isOverRightHalf))}else{return verticalDirection&&((verticalDirection=="down"&&isOverBottomHalf)||(verticalDirection=="up"&&!isOverBottomHalf))}},_getDragVerticalDirection:function(){var delta=this.positionAbs.top-this.lastPositionAbs.top;return delta!=0&&(delta>0?"down":"up")},_getDragHorizontalDirection:function(){var delta=this.positionAbs.left-this.lastPositionAbs.left;return delta!=0&&(delta>0?"right":"left")},refresh:function(event){this._refreshItems(event);this.refreshPositions();return this},_connectWith:function(){var options=this.options;return options.connectWith.constructor==String?[options.connectWith]:options.connectWith},_getItemsAsjQuery:function(connected){var self=this;var items=[];var queries=[];var connectWith=this._connectWith();if(connectWith&&connected){for(var i=connectWith.length-1;i>=0;i--){var cur=$(connectWith[i]);for(var j=cur.length-1;j>=0;j--){var inst=$.data(cur[j],"sortable");if(inst&&inst!=this&&!inst.options.disabled){queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element):$(inst.options.items,inst.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),inst])}}}}queries.push([$.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):$(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var i=queries.length-1;i>=0;i--){queries[i][0].each(function(){items.push(this)})}return $(items)},_removeCurrentsFromItems:function(){var list=this.currentItem.find(":data(sortable-item)");for(var i=0;i<this.items.length;i++){for(var j=0;j<list.length;j++){if(list[j]==this.items[i].item[0]){this.items.splice(i,1)}}}},_refreshItems:function(event){this.items=[];this.containers=[this];var items=this.items;var self=this;var queries=[[$.isFunction(this.options.items)?this.options.items.call(this.element[0],event,{item:this.currentItem}):$(this.options.items,this.element),this]];var connectWith=this._connectWith();if(connectWith){for(var i=connectWith.length-1;i>=0;i--){var cur=$(connectWith[i]);for(var j=cur.length-1;j>=0;j--){var inst=$.data(cur[j],"sortable");if(inst&&inst!=this&&!inst.options.disabled){queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element[0],event,{item:this.currentItem}):$(inst.options.items,inst.element),inst]);this.containers.push(inst)}}}}for(var i=queries.length-1;i>=0;i--){var targetData=queries[i][1];var _queries=queries[i][0];for(var j=0,queriesLength=_queries.length;j<queriesLength;j++){var item=$(_queries[j]);item.data("sortable-item",targetData);items.push({item:item,instance:targetData,width:0,height:0,left:0,top:0})}}},refreshPositions:function(fast){if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset()}for(var i=this.items.length-1;i>=0;i--){var item=this.items[i];if(item.instance!=this.currentContainer&&this.currentContainer&&item.item[0]!=this.currentItem[0]){continue}var t=this.options.toleranceElement?$(this.options.toleranceElement,item.item):item.item;if(!fast){item.width=t.outerWidth();item.height=t.outerHeight()}var p=t.offset();item.left=p.left;item.top=p.top}if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(var i=this.containers.length-1;i>=0;i--){var p=this.containers[i].element.offset();this.containers[i].containerCache.left=p.left;this.containers[i].containerCache.top=p.top;this.containers[i].containerCache.width=this.containers[i].element.outerWidth();this.containers[i].containerCache.height=this.containers[i].element.outerHeight()}}return this},_createPlaceholder:function(that){var self=that||this,o=self.options;if(!o.placeholder||o.placeholder.constructor==String){var className=o.placeholder;o.placeholder={element:function(){var el=$(document.createElement(self.currentItem[0].nodeName)).addClass(className||self.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];if(!className){el.style.visibility="hidden"}return el},update:function(container,p){if(className&&!o.forcePlaceholderSize){return}if(!p.height()){p.height(self.currentItem.innerHeight()-parseInt(self.currentItem.css("paddingTop")||0,10)-parseInt(self.currentItem.css("paddingBottom")||0,10))}if(!p.width()){p.width(self.currentItem.innerWidth()-parseInt(self.currentItem.css("paddingLeft")||0,10)-parseInt(self.currentItem.css("paddingRight")||0,10))}}}}self.placeholder=$(o.placeholder.element.call(self.element,self.currentItem));self.currentItem.after(self.placeholder);o.placeholder.update(self,self.placeholder)},_contactContainers:function(event){var innermostContainer=null,innermostIndex=null;for(var i=this.containers.length-1;i>=0;i--){if($.contains(this.currentItem[0],this.containers[i].element[0])){continue}if(this._intersectsWith(this.containers[i].containerCache)){if(innermostContainer&&$.contains(this.containers[i].element[0],innermostContainer.element[0])){continue}innermostContainer=this.containers[i];innermostIndex=i}else{if(this.containers[i].containerCache.over){this.containers[i]._trigger("out",event,this._uiHash(this));this.containers[i].containerCache.over=0}}}if(!innermostContainer){return}if(this.containers.length===1){this.containers[innermostIndex]._trigger("over",event,this._uiHash(this));this.containers[innermostIndex].containerCache.over=1}else{if(this.currentContainer!=this.containers[innermostIndex]){var dist=10000;var itemWithLeastDistance=null;var base=this.positionAbs[this.containers[innermostIndex].floating?"left":"top"];for(var j=this.items.length-1;j>=0;j--){if(!$.contains(this.containers[innermostIndex].element[0],this.items[j].item[0])){continue}var cur=this.items[j][this.containers[innermostIndex].floating?"left":"top"];if(Math.abs(cur-base)<dist){dist=Math.abs(cur-base);itemWithLeastDistance=this.items[j]}}if(!itemWithLeastDistance&&!this.options.dropOnEmpty){return}this.currentContainer=this.containers[innermostIndex];itemWithLeastDistance?this._rearrange(event,itemWithLeastDistance,null,true):this._rearrange(event,null,this.containers[innermostIndex].element,true);this._trigger("change",event,this._uiHash());this.containers[innermostIndex]._trigger("change",event,this._uiHash(this));this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[innermostIndex]._trigger("over",event,this._uiHash(this));this.containers[innermostIndex].containerCache.over=1}}},_createHelper:function(event){var o=this.options;var helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event,this.currentItem])):(o.helper=="clone"?this.currentItem.clone():this.currentItem);if(!helper.parents("body").length){$(o.appendTo!="parent"?o.appendTo:this.currentItem[0].parentNode)[0].appendChild(helper[0])}if(helper[0]==this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}}if(helper[0].style.width==""||o.forceHelperSize){helper.width(this.currentItem.width())}if(helper[0].style.height==""||o.forceHelperSize){helper.height(this.currentItem.height())}return helper},_adjustOffsetFromHelper:function(obj){if(typeof obj=="string"){obj=obj.split(" ")}if($.isArray(obj)){obj={left:+obj[0],top:+obj[1]||0}}if("left" in obj){this.offset.click.left=obj.left+this.margins.left}if("right" in obj){this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left}if("top" in obj){this.offset.click.top=obj.top+this.margins.top}if("bottom" in obj){this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var po=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&$.contains(this.scrollParent[0],this.offsetParent[0])){po.left+=this.scrollParent.scrollLeft();po.top+=this.scrollParent.scrollTop()}if((this.offsetParent[0]==document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&$.browser.msie)){po={top:0,left:0}}return{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var p=this.currentItem.position();return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.currentItem.css("marginLeft"),10)||0),top:(parseInt(this.currentItem.css("marginTop"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var o=this.options;if(o.containment=="parent"){o.containment=this.helper[0].parentNode}if(o.containment=="document"||o.containment=="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,$(o.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,($(o.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!(/^(document|window|parent)$/).test(o.containment)){var ce=$(o.containment)[0];var co=$(o.containment).offset();var over=($(ce).css("overflow")!="hidden");this.containment=[co.left+(parseInt($(ce).css("borderLeftWidth"),10)||0)+(parseInt($(ce).css("paddingLeft"),10)||0)-this.margins.left,co.top+(parseInt($(ce).css("borderTopWidth"),10)||0)+(parseInt($(ce).css("paddingTop"),10)||0)-this.margins.top,co.left+(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt($(ce).css("borderLeftWidth"),10)||0)-(parseInt($(ce).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,co.top+(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt($(ce).css("borderTopWidth"),10)||0)-(parseInt($(ce).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(d,pos){if(!pos){pos=this.position}var mod=d=="absolute"?1:-1;var o=this.options,scroll=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName);return{top:(pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-($.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop()))*mod)),left:(pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-($.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())*mod))}},_generatePosition:function(event){var o=this.options,scroll=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName);if(this.cssPosition=="relative"&&!(this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0])){this.offset.relative=this._getRelativeOffset()}var pageX=event.pageX;var pageY=event.pageY;if(this.originalPosition){if(this.containment){if(event.pageX-this.offset.click.left<this.containment[0]){pageX=this.containment[0]+this.offset.click.left}if(event.pageY-this.offset.click.top<this.containment[1]){pageY=this.containment[1]+this.offset.click.top}if(event.pageX-this.offset.click.left>this.containment[2]){pageX=this.containment[2]+this.offset.click.left}if(event.pageY-this.offset.click.top>this.containment[3]){pageY=this.containment[3]+this.offset.click.top}}if(o.grid){var top=this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1];pageY=this.containment?(!(top-this.offset.click.top<this.containment[1]||top-this.offset.click.top>this.containment[3])?top:(!(top-this.offset.click.top<this.containment[1])?top-o.grid[1]:top+o.grid[1])):top;var left=this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0];pageX=this.containment?(!(left-this.offset.click.left<this.containment[0]||left-this.offset.click.left>this.containment[2])?left:(!(left-this.offset.click.left<this.containment[0])?left-o.grid[0]:left+o.grid[0])):left}}return{top:(pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+($.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop())))),left:(pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+($.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())))}},_rearrange:function(event,i,a,hardRefresh){a?a[0].appendChild(this.placeholder[0]):i.item[0].parentNode.insertBefore(this.placeholder[0],(this.direction=="down"?i.item[0]:i.item[0].nextSibling));this.counter=this.counter?++this.counter:1;var self=this,counter=this.counter;window.setTimeout(function(){if(counter==self.counter){self.refreshPositions(!hardRefresh)}},0)},_clear:function(event,noPropagation){this.reverting=false;var delayedTriggers=[],self=this;if(!this._noFinalSort&&this.currentItem.parent().length){this.placeholder.before(this.currentItem)}this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var i in this._storedCSS){if(this._storedCSS[i]=="auto"||this._storedCSS[i]=="static"){this._storedCSS[i]=""}}this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}if(this.fromOutside&&!noPropagation){delayedTriggers.push(function(event){this._trigger("receive",event,this._uiHash(this.fromOutside))})}if((this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!noPropagation){delayedTriggers.push(function(event){this._trigger("update",event,this._uiHash())})}if(!$.contains(this.element[0],this.currentItem[0])){if(!noPropagation){delayedTriggers.push(function(event){this._trigger("remove",event,this._uiHash())})}for(var i=this.containers.length-1;i>=0;i--){if($.contains(this.containers[i].element[0],this.currentItem[0])&&!noPropagation){delayedTriggers.push((function(c){return function(event){c._trigger("receive",event,this._uiHash(this))}}).call(this,this.containers[i]));delayedTriggers.push((function(c){return function(event){c._trigger("update",event,this._uiHash(this))}}).call(this,this.containers[i]))}}}for(var i=this.containers.length-1;i>=0;i--){if(!noPropagation){delayedTriggers.push((function(c){return function(event){c._trigger("deactivate",event,this._uiHash(this))}}).call(this,this.containers[i]))}if(this.containers[i].containerCache.over){delayedTriggers.push((function(c){return function(event){c._trigger("out",event,this._uiHash(this))}}).call(this,this.containers[i]));this.containers[i].containerCache.over=0}}if(this._storedCursor){$("body").css("cursor",this._storedCursor)}if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity)}if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex)}this.dragging=false;if(this.cancelHelperRemoval){if(!noPropagation){this._trigger("beforeStop",event,this._uiHash());for(var i=0;i<delayedTriggers.length;i++){delayedTriggers[i].call(this,event)}this._trigger("stop",event,this._uiHash())}return false}if(!noPropagation){this._trigger("beforeStop",event,this._uiHash())}this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(this.helper[0]!=this.currentItem[0]){this.helper.remove()}this.helper=null;if(!noPropagation){for(var i=0;i<delayedTriggers.length;i++){delayedTriggers[i].call(this,event)}this._trigger("stop",event,this._uiHash())}this.fromOutside=false;return true},_trigger:function(){if($.Widget.prototype._trigger.apply(this,arguments)===false){this.cancel()}},_uiHash:function(inst){var self=inst||this;return{helper:self.helper,placeholder:self.placeholder||$([]),position:self.position,originalPosition:self.originalPosition,offset:self.positionAbs,item:self.currentItem,sender:inst?inst.element:null}}})})(jQuery);jQuery.effects||(function($,undefined){var backCompat=$.uiBackCompat!==false;$.effects={effect:{}};$.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","borderColor","color","outlineColor"],function(i,attr){$.fx.step[attr]=function(fx){if(!fx.colorInit){fx.start=getColor(fx.elem,attr);fx.end=getRGB(fx.end);fx.colorInit=true}fx.elem.style[attr]="rgb("+Math.max(Math.min(parseInt((fx.pos*(fx.end[0]-fx.start[0]))+fx.start[0],10),255),0)+","+Math.max(Math.min(parseInt((fx.pos*(fx.end[1]-fx.start[1]))+fx.start[1],10),255),0)+","+Math.max(Math.min(parseInt((fx.pos*(fx.end[2]-fx.start[2]))+fx.start[2],10),255),0)+")"}});function getRGB(color){var result;if(color&&color.constructor===Array&&color.length===3){return color}if(result=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(color)){return[parseInt(result[1],10),parseInt(result[2],10),parseInt(result[3],10)]}if(result=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(color)){return[parseFloat(result[1])*2.55,parseFloat(result[2])*2.55,parseFloat(result[3])*2.55]}if(result=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(color)){return[parseInt(result[1],16),parseInt(result[2],16),parseInt(result[3],16)]}if(result=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(color)){return[parseInt(result[1]+result[1],16),parseInt(result[2]+result[2],16),parseInt(result[3]+result[3],16)]}if(result=/rgba\(0, 0, 0, 0\)/.exec(color)){return colors.transparent}return colors[$.trim(color).toLowerCase()]}function getColor(elem,attr){var color;do{color=$.curCSS(elem,attr);if(color!=""&&color!=="transparent"||$.nodeName(elem,"body")){break}attr="backgroundColor"}while(elem=elem.parentNode);return getRGB(color)}var colors={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]};var classAnimationActions=["add","remove","toggle"],shorthandStyles={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1},dataSpace="ec.storage.";$.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(_,prop){$.fx.step[prop]=function(fx){if(fx.end!=="none"&&!fx.setAttr||fx.pos===1&&!fx.setAttr){jQuery.style(fx.elem,prop,fx.end);fx.setAttr=true}}});function getElementStyles(){var style=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,newStyle={},key,camelCase,len;if(style&&style.length&&style[0]&&style[style[0]]){len=style.length;while(len--){key=style[len];if(typeof style[key]==="string"){newStyle[$.camelCase(key)]=style[key]}}}else{for(key in style){if(typeof style[key]==="string"){newStyle[key]=style[key]}}}return newStyle}function styleDifference(oldStyle,newStyle){var diff={},name,value;for(name in newStyle){value=newStyle[name];if(oldStyle[name]!=value){if(!shorthandStyles[name]){if($.fx.step[name]||!isNaN(parseFloat(value))){diff[name]=value}}}}return diff}$.effects.animateClass=function(value,duration,easing,callback){var o=$.speed(duration,easing,callback);return this.queue(function(){var animated=$(this),baseClass=animated.attr("class"),finalClass,allAnimations=o.children?animated.find("*").andSelf():animated;allAnimations=allAnimations.map(function(){var el=$(this);return{el:el,originalStyleAttr:el.attr("style")||" ",start:getElementStyles.call(this)}});$.each(classAnimationActions,function(i,action){if(value[action]){animated[action+"Class"](value[action])}});finalClass=animated.attr("class");allAnimations=allAnimations.map(function(){this.end=getElementStyles.call(this.el[0]);this.diff=styleDifference(this.start,this.end);return this});animated.attr("class",baseClass);allAnimations=allAnimations.map(function(){var styleInfo=this,dfd=$.Deferred();this.el.animate(this.diff,{duration:o.duration,easing:o.easing,queue:false,complete:function(){dfd.resolve(styleInfo)}});return dfd.promise()});$.when.apply($,allAnimations.get()).done(function(){animated.attr("class",finalClass);$.each(arguments,function(){if(typeof this.el.attr("style")==="object"){this.el.attr("style").cssText="";this.el.attr("style").cssText=this.originalStyleAttr}else{this.el.attr("style",this.originalStyleAttr)}});o.complete.call(animated[0])})})};$.fn.extend({_addClass:$.fn.addClass,addClass:function(classNames,speed,easing,callback){return speed?$.effects.animateClass.apply(this,[{add:classNames},speed,easing,callback]):this._addClass(classNames)},_removeClass:$.fn.removeClass,removeClass:function(classNames,speed,easing,callback){return speed?$.effects.animateClass.apply(this,[{remove:classNames},speed,easing,callback]):this._removeClass(classNames)},_toggleClass:$.fn.toggleClass,toggleClass:function(classNames,force,speed,easing,callback){if(typeof force==="boolean"||force===undefined){if(!speed){return this._toggleClass(classNames,force)}else{return $.effects.animateClass.apply(this,[(force?{add:classNames}:{remove:classNames}),speed,easing,callback])}}else{return $.effects.animateClass.apply(this,[{toggle:classNames},force,speed,easing])}},switchClass:function(remove,add,speed,easing,callback){return $.effects.animateClass.apply(this,[{add:add,remove:remove},speed,easing,callback])}});$.extend($.effects,{version:"1.9pre",save:function(element,set){for(var i=0;i<set.length;i++){if(set[i]!==null){element.data(dataSpace+set[i],element[0].style[set[i]])}}},restore:function(element,set){for(var i=0;i<set.length;i++){if(set[i]!==null){element.css(set[i],element.data(dataSpace+set[i]))}}},setMode:function(el,mode){if(mode==="toggle"){mode=el.is(":hidden")?"show":"hide"}return mode},getBaseline:function(origin,original){var y,x;switch(origin[0]){case"top":y=0;break;case"middle":y=0.5;break;case"bottom":y=1;break;default:y=origin[0]/original.height}switch(origin[1]){case"left":x=0;break;case"center":x=0.5;break;case"right":x=1;break;default:x=origin[1]/original.width}return{x:x,y:y}},createWrapper:function(element){if(element.parent().is(".ui-effects-wrapper")){return element.parent()}var props={width:element.outerWidth(true),height:element.outerHeight(true),"float":element.css("float")},wrapper=$("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),size={width:element.width(),height:element.height()};element.wrap(wrapper);wrapper=element.parent();if(element.css("position")==="static"){wrapper.css({position:"relative"});element.css({position:"relative"})}else{$.extend(props,{position:element.css("position"),zIndex:element.css("z-index")});$.each(["top","left","bottom","right"],function(i,pos){props[pos]=element.css(pos);if(isNaN(parseInt(props[pos],10))){props[pos]="auto"}});element.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})}element.css(size);return wrapper.css(props).show()},removeWrapper:function(element){if(element.parent().is(".ui-effects-wrapper")){return element.parent().replaceWith(element)}return element},setTransition:function(element,list,factor,value){value=value||{};$.each(list,function(i,x){var unit=element.cssUnit(x);if(unit[0]>0){value[x]=unit[0]*factor+unit[1]}});return value}});function _normalizeArguments(effect,options,speed,callback){if($.isPlainObject(effect)){return effect}effect={effect:effect};if(options===undefined){options={}}if($.isFunction(options)){callback=options;speed=null;options={}}if($.type(options)==="number"||$.fx.speeds[options]){callback=speed;speed=options;options={}}if($.isFunction(speed)){callback=speed;speed=null}if(options){$.extend(effect,options)}speed=speed||options.duration;effect.duration=$.fx.off?0:typeof speed==="number"?speed:speed in $.fx.speeds?$.fx.speeds[speed]:$.fx.speeds._default;effect.complete=callback||options.complete;return effect}function standardSpeed(speed){if(!speed||typeof speed==="number"||$.fx.speeds[speed]){return true}if(typeof speed==="string"&&!$.effects.effect[speed]){if(backCompat&&$.effects[speed]){return false}return true}return false}$.fn.extend({effect:function(effect,options,speed,callback){var args=_normalizeArguments.apply(this,arguments),mode=args.mode,effectMethod=$.effects.effect[args.effect],oldEffectMethod=!effectMethod&&backCompat&&$.effects[args.effect];if($.fx.off||!(effectMethod||oldEffectMethod)){if(mode){return this[mode](args.duration,args.complete)}else{return this.each(function(){if(args.complete){args.complete.call(this)}})}}if(effectMethod){return effectMethod.call(this,args)}else{return oldEffectMethod.call(this,{options:args,duration:args.duration,callback:args.complete,mode:args.mode})}},_show:$.fn.show,show:function(speed){if(standardSpeed(speed)){return this._show.apply(this,arguments)}else{var args=_normalizeArguments.apply(this,arguments);args.mode="show";return this.effect.call(this,args)}},_hide:$.fn.hide,hide:function(speed){if(standardSpeed(speed)){return this._hide.apply(this,arguments)}else{var args=_normalizeArguments.apply(this,arguments);args.mode="hide";return this.effect.call(this,args)}},__toggle:$.fn.toggle,toggle:function(speed){if(standardSpeed(speed)||typeof speed==="boolean"||$.isFunction(speed)){return this.__toggle.apply(this,arguments)}else{var args=_normalizeArguments.apply(this,arguments);args.mode="toggle";return this.effect.call(this,args)}},cssUnit:function(key){var style=this.css(key),val=[];$.each(["em","px","%","pt"],function(i,unit){if(style.indexOf(unit)>0){val=[parseFloat(style),unit]}});return val}});$.easing.jswing=$.easing.swing;$.extend($.easing,{def:"easeOutQuad",swing:function(x,t,b,c,d){return $.easing[$.easing.def](x,t,b,c,d)},easeInQuad:function(x,t,b,c,d){return c*(t/=d)*t+b},easeOutQuad:function(x,t,b,c,d){return -c*(t/=d)*(t-2)+b},easeInOutQuad:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t+b}return -c/2*((--t)*(t-2)-1)+b},easeInCubic:function(x,t,b,c,d){return c*(t/=d)*t*t+b},easeOutCubic:function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInOutCubic:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t+b}return c/2*((t-=2)*t*t+2)+b},easeInQuart:function(x,t,b,c,d){return c*(t/=d)*t*t*t+b},easeOutQuart:function(x,t,b,c,d){return -c*((t=t/d-1)*t*t*t-1)+b},easeInOutQuart:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t*t+b}return -c/2*((t-=2)*t*t*t-2)+b},easeInQuint:function(x,t,b,c,d){return c*(t/=d)*t*t*t*t+b},easeOutQuint:function(x,t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},easeInOutQuint:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t*t*t+b}return c/2*((t-=2)*t*t*t*t+2)+b},easeInSine:function(x,t,b,c,d){return -c*Math.cos(t/d*(Math.PI/2))+c+b},easeOutSine:function(x,t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},easeInOutSine:function(x,t,b,c,d){return -c/2*(Math.cos(Math.PI*t/d)-1)+b},easeInExpo:function(x,t,b,c,d){return(t==0)?b:c*Math.pow(2,10*(t/d-1))+b},easeOutExpo:function(x,t,b,c,d){return(t==d)?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},easeInOutExpo:function(x,t,b,c,d){if(t==0){return b}if(t==d){return b+c}if((t/=d/2)<1){return c/2*Math.pow(2,10*(t-1))+b}return c/2*(-Math.pow(2,-10*--t)+2)+b},easeInCirc:function(x,t,b,c,d){return -c*(Math.sqrt(1-(t/=d)*t)-1)+b},easeOutCirc:function(x,t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b},easeInOutCirc:function(x,t,b,c,d){if((t/=d/2)<1){return -c/2*(Math.sqrt(1-t*t)-1)+b}return c/2*(Math.sqrt(1-(t-=2)*t)+1)+b},easeInElastic:function(x,t,b,c,d){var s=1.70158,p=d*0.3,a=c;if(t==0){return b}if((t/=d)==1){return b+c}if(a<Math.abs(c)){a=c;s=p/4}else{s=p/(2*Math.PI)*Math.asin(c/a)}return -(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b},easeOutElastic:function(x,t,b,c,d){var s=1.70158,p=d*0.3,a=c;if(t==0){return b}if((t/=d)==1){return b+c}if(a<Math.abs(c)){a=c;s=p/4}else{s=p/(2*Math.PI)*Math.asin(c/a)}return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b},easeInOutElastic:function(x,t,b,c,d){var s=1.70158,p=d*(0.3*1.5),a=c;if(t==0){return b}if((t/=d/2)==2){return b+c}if(a<Math.abs(c)){a=c;s=p/4}else{s=p/(2*Math.PI)*Math.asin(c/a)}if(t<1){return -0.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b}return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*0.5+c+b},easeInBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158}return c*(t/=d)*t*((s+1)*t-s)+b},easeOutBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158}return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},easeInOutBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158}if((t/=d/2)<1){return c/2*(t*t*(((s*=1.525)+1)*t-s))+b}return c/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+b},easeInBounce:function(x,t,b,c,d){return c-$.easing.easeOutBounce(x,d-t,0,c,d)+b},easeOutBounce:function(x,t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b}else{if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+0.75)+b}else{if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+0.9375)+b}else{return c*(7.5625*(t-=(2.625/2.75))*t+0.984375)+b}}}},easeInOutBounce:function(x,t,b,c,d){if(t<d/2){return $.easing.easeInBounce(x,t*2,0,c,d)*0.5+b}return $.easing.easeOutBounce(x,t*2-d,0,c,d)*0.5+c*0.5+b}})})(jQuery);(function($,undefined){var rvertical=/up|down|vertical/;var rpositivemotion=/up|left|vertical|horizontal/;$.effects.effect.blind=function(o){return this.queue(function(){var el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),direction=o.direction||"up",vertical=rvertical.test(direction),ref=vertical?"height":"width",ref2=vertical?"top":"left",motion=rpositivemotion.test(direction),animation={},wrapper,distance;if(el.parent().is(".ui-effects-wrapper")){$.effects.save(el.parent(),props)}else{$.effects.save(el,props)}el.show();wrapper=$.effects.createWrapper(el).css({overflow:"hidden"});distance=wrapper[ref]();animation[ref]=(mode==="show"?distance:0);if(!motion){el.css(vertical?"bottom":"right",0).css(vertical?"top":"left","").css({position:"absolute"});animation[ref2]=(mode==="show")?0:distance}if(mode=="show"){wrapper.css(ref,0);if(!motion){wrapper.css(ref2,distance)}}wrapper.animate(animation,{duration:o.duration,easing:o.easing,queue:false,complete:function(){if(mode=="hide"){el.hide()}$.effects.restore(el,props);$.effects.removeWrapper(el);if($.isFunction(o.complete)){o.complete.apply(el[0],arguments)}el.dequeue()}})})}})(jQuery);(function($,undefined){$.effects.effect.bounce=function(o){return this.queue(function(next){var el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"effect"),hide=mode==="hide",show=mode==="show",direction=o.direction||"up",distance=o.distance,times=o.times||5,anims=times*2+(show||hide?1:0),speed=o.duration/anims,easing=o.easing,ref=(direction==="up"||direction==="down")?"top":"left",motion=(direction==="up"||direction==="left"),i,upAnim,downAnim,queue=el.queue(),queuelen=queue.length;if(show||hide){props.push("opacity")}$.effects.save(el,props);el.show();$.effects.createWrapper(el);if(!distance){distance=el[ref==="top"?"outerHeight":"outerWidth"]()/3}if(show){downAnim={opacity:1};downAnim[ref]=0;el.css("opacity",0).css(ref,motion?-distance*2:distance*2).animate(downAnim,speed,easing)}if(hide){distance=distance/Math.pow(2,times-1)}downAnim={};downAnim[ref]=0;for(i=0;i<times;i++){upAnim={};upAnim[ref]=(motion?"-=":"+=")+distance;el.animate(upAnim,speed,easing).animate(downAnim,speed,easing);distance=hide?distance*2:distance/2}if(hide){upAnim={opacity:0};upAnim[ref]=(motion?"-=":"+=")+distance;el.animate(upAnim,speed,easing)}el.queue(function(next){if(hide){el.hide()}$.effects.restore(el,props);$.effects.removeWrapper(el);if(o.complete){o.complete.apply(el[0])}next()});if(queuelen>1){queue.splice.apply(queue,[1,0].concat(queue.splice(queuelen,anims+1)))}next()})}})(jQuery);(function($,undefined){$.effects.effect.clip=function(o){return this.queue(function(){var el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),show=mode==="show",direction=o.direction||"vertical",vert=direction==="vertical",size=vert?"height":"width",position=vert?"top":"left",animation={},wrapper,animate,distance;$.effects.save(el,props);el.show();wrapper=$.effects.createWrapper(el).css({overflow:"hidden"});animate=(el[0].tagName==="IMG")?wrapper:el;distance=animate[size]();if(show){animate.css(size,0);animate.css(position,distance/2)}animation[size]=show?distance:0;animation[position]=show?0:distance/2;animate.animate(animation,{queue:false,duration:o.duration,easing:o.easing,complete:function(){if(!show){el.hide()}$.effects.restore(el,props);$.effects.removeWrapper(el);if($.isFunction(o.complete)){o.complete.apply(el[0],arguments)}el.dequeue()}})})}})(jQuery);(function($,undefined){$.effects.effect.drop=function(o){return this.queue(function(){var el=$(this),props=["position","top","bottom","left","right","opacity","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),direction=o.direction||"left",ref=(direction=="up"||direction=="down")?"top":"left",motion=(direction=="up"||direction=="left")?"pos":"neg",animation={opacity:mode=="show"?1:0},distance;$.effects.save(el,props);el.show();$.effects.createWrapper(el);distance=o.distance||el[ref=="top"?"outerHeight":"outerWidth"]({margin:true})/2;if(mode=="show"){el.css("opacity",0).css(ref,motion=="pos"?-distance:distance)}animation[ref]=((mode=="show")?(motion=="pos"?"+=":"-="):(motion=="pos"?"-=":"+="))+distance;el.animate(animation,{queue:false,duration:o.duration,easing:o.easing,complete:function(){mode=="hide"&&el.hide();$.effects.restore(el,props);$.effects.removeWrapper(el);$.isFunction(o.complete)&&o.complete.apply(this,arguments);el.dequeue()}})})}})(jQuery);(function($,undefined){$.effects.effect.explode=function(o){return this.queue(function(next){var rows=o.pieces?Math.round(Math.sqrt(o.pieces)):3,cells=rows,el=$(this),mode=$.effects.setMode(el,o.mode||"hide"),show=(mode=="show"),offset=el.show().css("visibility","hidden").offset(),width=Math.ceil(el.outerWidth()/cells),height=Math.ceil(el.outerHeight()/rows),pieces=[],i,j,left,top,mx,my;for(i=0;i<rows;i++){top=offset.top+i*height;my=i-(rows-1)/2;for(j=0;j<cells;j++){left=offset.left+j*width;mx=j-(cells-1)/2;el.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-j*width,top:-i*height}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:width,height:height,left:left+(show?mx*width:0),top:top+(show?my*height:0),opacity:show?0:1}).animate({left:left+(show?0:mx*width),top:top+(show?0:my*height),opacity:show?1:0},o.duration||500,o.easing,childComplete)}}function childComplete(){pieces.push(this);if(pieces.length==rows*cells){animComplete()}}function animComplete(){el.css({visibility:"visible"});$(pieces).remove();if(!show){el.hide()}if($.isFunction(o.complete)){o.complete.apply(el[0])}next()}})}})(jQuery);(function($,undefined){$.effects.effect.fade=function(o){return this.queue(function(next){var el=$(this),mode=$.effects.setMode(el,o.mode||"toggle"),hide=mode==="hide";el.show();el.animate({opacity:hide?0:1},{queue:false,duration:o.duration,easing:o.easing,complete:function(){if(hide){el.hide()}if(o.complete){o.complete.call(this)}next()}})})}})(jQuery);(function($,undefined){$.effects.effect.fold=function(o){return this.queue(function(){var el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),size=o.size||15,percent=/([0-9]+)%/.exec(size),horizFirst=!!o.horizFirst,widthFirst=((mode=="show")!=horizFirst),ref=widthFirst?["width","height"]:["height","width"],duration=o.duration/2,wrapper,distance;$.effects.save(el,props);el.show();wrapper=$.effects.createWrapper(el).css({overflow:"hidden"});distance=widthFirst?[wrapper.width(),wrapper.height()]:[wrapper.height(),wrapper.width()];if(percent){size=parseInt(percent[1],10)/100*distance[(mode=="hide")?0:1]}mode=="show"&&wrapper.css(horizFirst?{height:0,width:size}:{height:size,width:0});var animation1={},animation2={};animation1[ref[0]]=mode=="show"?distance[0]:size;animation2[ref[1]]=mode=="show"?distance[1]:0;wrapper.animate(animation1,duration,o.easing).animate(animation2,duration,o.easing,function(){(mode=="hide")&&el.hide();$.effects.restore(el,props);$.effects.removeWrapper(el);jQuery.isFunction(o.complete)&&o.complete.apply(el[0],arguments);el.dequeue()})})}})(jQuery);(function($,undefined){$.effects.effect.highlight=function(o){return this.queue(function(){var elem=$(this),props=["backgroundImage","backgroundColor","opacity"],mode=$.effects.setMode(elem,o.mode||"show"),animation={backgroundColor:elem.css("backgroundColor")};if(mode=="hide"){animation.opacity=0}$.effects.save(elem,props);elem.show().css({backgroundImage:"none",backgroundColor:o.color||"#ffff99"}).animate(animation,{queue:false,duration:o.duration,easing:o.easing,complete:function(){(mode=="hide"&&elem.hide());$.effects.restore(elem,props);(mode=="show"&&!$.support.opacity&&this.style.removeAttribute("filter"));jQuery.isFunction(o.complete)&&o.complete.apply(this,arguments);elem.dequeue()}})})}})(jQuery);(function($,undefined){$.effects.effect.pulsate=function(o){return this.queue(function(next){var elem=$(this),mode=$.effects.setMode(elem,o.mode||"show"),show=mode==="show",hide=mode==="hide",showhide=(show||mode==="hide"),anims=((o.times||5)*2)+(showhide?1:0),duration=o.duration/anims,animateTo=0,queue=elem.queue(),queuelen=queue.length,i;if(show||!elem.is(":visible")){elem.css("opacity",0).show();animateTo=1}for(i=1;i<anims;i++){elem.animate({opacity:animateTo},duration,o.easing);animateTo=1-animateTo}elem.animate({opacity:animateTo},duration,o.easing);elem.queue(function(next){if(hide){elem.hide()}if(o.complete){o.complete.apply(this)}next()});if(queuelen>1){queue.splice.apply(queue,[1,0].concat(queue.splice(queuelen,anims+1)))}next()})}})(jQuery);(function($,undefined){$.effects.effect.puff=function(o){return this.queue(function(){var elem=$(this),mode=$.effects.setMode(elem,o.mode||"hide"),percent=parseInt(o.percent,10)||150,factor=percent/100,original={height:elem.height(),width:elem.width()};$.extend(o,{effect:"scale",queue:false,fade:true,mode:mode,percent:mode=="hide"?percent:100,from:mode=="hide"?original:{height:original.height*factor,width:original.width*factor}});elem.effect(o)})};$.effects.effect.scale=function(o){return this[o.queue===false?"each":"queue"](function(){var el=$(this),options=$.extend(true,{},o),mode=$.effects.setMode(el,o.mode||"effect"),percent=parseInt(o.percent,10)||(parseInt(o.percent,10)==0?0:(mode=="hide"?0:100)),direction=o.direction||"both",origin=o.origin,original={height:el.height(),width:el.width(),outerHeight:el.outerHeight(),outerWidth:el.outerWidth()},factor={y:direction!="horizontal"?(percent/100):1,x:direction!="vertical"?(percent/100):1};options.effect="size";options.queue=false;if(mode!="effect"){options.origin=origin||["middle","center"];options.restore=true}options.from=o.from||(mode=="show"?{height:0,width:0}:original);options.to={height:original.height*factor.y,width:original.width*factor.x,outerHeight:original.outerHeight*factor.y,outerWidth:original.outerWidth*factor.x};if(options.fade){if(mode=="show"){options.from.opacity=0;options.to.opacity=1}if(mode=="hide"){options.from.opacity=1;options.to.opacity=0}}el.effect(options)})};$.effects.effect.size=function(o){return this[o.queue===false?"each":"queue"](function(){var el=$(this),props=["position","top","bottom","left","right","width","height","overflow","opacity"],props1=["position","top","bottom","left","right","overflow","opacity"],props2=["width","height","overflow"],cProps=["fontSize"],vProps=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],hProps=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],mode=$.effects.setMode(el,o.mode||"effect"),restore=o.restore||mode!=="effect",scale=o.scale||"both",origin=o.origin||["middle","center"],original,baseline,factor,position=el.css("position"),originalVerticalPositioning=el.css("bottom")!=="auto"?"bottom":"top";originalHorizontalPositioning=el.css("right")!=="auto"?"right":"left";if(mode==="show"){el.show()}original={height:el.height(),width:el.width(),outerHeight:el.outerHeight(),outerWidth:el.outerWidth()};el.from=o.from||original;el.to=o.to||original;factor={from:{y:el.from.height/original.height,x:el.from.width/original.width},to:{y:el.to.height/original.height,x:el.to.width/original.width}};if(scale=="box"||scale=="both"){if(factor.from.y!==factor.to.y){props=props.concat(vProps);el.from=$.effects.setTransition(el,vProps,factor.from.y,el.from);el.to=$.effects.setTransition(el,vProps,factor.to.y,el.to)}if(factor.from.x!==factor.to.x){props=props.concat(hProps);el.from=$.effects.setTransition(el,hProps,factor.from.x,el.from);el.to=$.effects.setTransition(el,hProps,factor.to.x,el.to)}}if(scale=="content"||scale=="both"){if(factor.from.y!==factor.to.y){props=props.concat(cProps);el.from=$.effects.setTransition(el,cProps,factor.from.y,el.from);el.to=$.effects.setTransition(el,cProps,factor.to.y,el.to)}}$.effects.save(el,restore?props:props1);el.show();$.effects.createWrapper(el);el.css("overflow","hidden").css(el.from);if(origin){baseline=$.effects.getBaseline(origin,original);el.from.top=(original.outerHeight-el.outerHeight())*baseline.y;el.from.left=(original.outerWidth-el.outerWidth())*baseline.x;el.to.top=(original.outerHeight-el.to.outerHeight)*baseline.y;el.to.left=(original.outerWidth-el.to.outerWidth)*baseline.x}el.css(el.from);if(scale=="content"||scale=="both"){vProps=vProps.concat(["marginTop","marginBottom"]).concat(cProps);hProps=hProps.concat(["marginLeft","marginRight"]);props2=props.concat(vProps).concat(hProps);el.find("*[width]").each(function(){var child=$(this),c_original={height:child.height(),width:child.width()};if(restore){$.effects.save(child,props2)}child.from={height:c_original.height*factor.from.y,width:c_original.width*factor.from.x};child.to={height:c_original.height*factor.to.y,width:c_original.width*factor.to.x};if(factor.from.y!=factor.to.y){child.from=$.effects.setTransition(child,vProps,factor.from.y,child.from);child.to=$.effects.setTransition(child,vProps,factor.to.y,child.to)}if(factor.from.x!=factor.to.x){child.from=$.effects.setTransition(child,hProps,factor.from.x,child.from);child.to=$.effects.setTransition(child,hProps,factor.to.x,child.to)}child.css(child.from);child.animate(child.to,o.duration,o.easing,function(){if(restore){$.effects.restore(child,props2)}})})}el.animate(el.to,{queue:false,duration:o.duration,easing:o.easing,complete:function(){if(el.to.opacity===0){el.css("opacity",el.from.opacity)}if(mode=="hide"){el.hide()}$.effects.restore(el,restore?props:props1);if(position==="static"){el.css({position:"relative",top:el.to.top,left:el.to.left})}else{$.each([originalVerticalPositioning,originalHorizontalPositioning],function(idx,pos){el.css(pos,function(_,str){var val=parseInt(str,10),toRef=idx?el.to.left:el.to.top,delta=idx?el.to.outerWidth-el.from.outerWidth:el.to.outerHeight-el.from.outerHeight,same=origin[idx]===pos,mid=origin[idx]==="middle"||origin[idx]==="center",direction=pos=="left"||pos=="top";if(str==="auto"){return toRef+"px"}if(!direction){if(position==="relative"){toRef*=-1}else{if(!mid){toRef-=delta*(same?-1:1)}}}return val+toRef+"px"})})}$.effects.removeWrapper(el);$.isFunction(o.complete)&&o.complete.apply(this,arguments);el.dequeue()}})})}})(jQuery);(function($,undefined){$.effects.effect.shake=function(o){return this.queue(function(){var el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"effect"),direction=o.direction||"left",distance=o.distance||20,times=o.times||3,anims=times*2+1,speed=o.duration,ref=(direction=="up"||direction=="down")?"top":"left",motion=(direction=="up"||direction=="left")?"pos":"neg",animation={},animation1={},animation2={},i,queue=el.queue(),queuelen=queue.length;$.effects.save(el,props);el.show();$.effects.createWrapper(el);animation[ref]=(motion=="pos"?"-=":"+=")+distance;animation1[ref]=(motion=="pos"?"+=":"-=")+distance*2;animation2[ref]=(motion=="pos"?"-=":"+=")+distance*2;el.animate(animation,speed,o.easing);for(i=1;i<times;i++){el.animate(animation1,speed,o.easing).animate(animation2,speed,o.easing)}el.animate(animation1,speed,o.easing).animate(animation,speed/2,o.easing).queue(function(next){if(mode==="hide"){el.hide()}$.effects.restore(el,props);$.effects.removeWrapper(el);$.isFunction(o.complete)&&o.complete.apply(this,arguments);next()});if(queuelen>1){queue.splice.apply(queue,[1,0].concat(queue.splice(queuelen,anims+1)))}el.dequeue()})}})(jQuery);(function($,undefined){$.effects.effect.slide=function(o){return this.queue(function(){var el=$(this),props=["position","top","bottom","left","right","width","height"],mode=$.effects.setMode(el,o.mode||"show"),direction=o.direction||"left",ref=(direction=="up"||direction=="down")?"top":"left",motion=(direction=="up"||direction=="left")?"pos":"neg",distance,animation={},size;$.effects.save(el,props);el.show();distance=o.distance||el[ref=="top"?"outerHeight":"outerWidth"]({margin:true});$.effects.createWrapper(el).css({overflow:"hidden"});if(mode=="show"){el.css(ref,motion=="pos"?(isNaN(distance)?"-"+distance:-distance):distance)}animation[ref]=(mode=="show"?(motion=="pos"?"+=":"-="):(motion=="pos"?"-=":"+="))+distance;el.animate(animation,{queue:false,duration:o.duration,easing:o.easing,complete:function(){if(mode=="hide"){el.hide()}$.effects.restore(el,props);$.effects.removeWrapper(el);$.isFunction(o.complete)&&o.complete.apply(this,arguments);el.dequeue()}})})}})(jQuery);(function($,undefined){$.effects.effect.transfer=function(o){return this.queue(function(){var elem=$(this),target=$(o.to),targetFixed=target.css("position")==="fixed",body=$("body"),fixTop=targetFixed?body.scrollTop():0,fixLeft=targetFixed?body.scrollLeft():0,endPosition=target.offset(),animation={top:endPosition.top-fixTop,left:endPosition.left-fixLeft,height:target.innerHeight(),width:target.innerWidth()},startPosition=elem.offset(),transfer=$('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(o.className).css({top:startPosition.top-fixTop,left:startPosition.left-fixLeft,height:elem.innerHeight(),width:elem.innerWidth(),position:targetFixed?"fixed":"absolute"}).animate(animation,o.duration,o.easing,function(){transfer.remove();$.isFunction(o.complete)&&o.complete.apply(elem[0],arguments);elem.dequeue()})})}})(jQuery);(function($,undefined){$.widget("ui.accordion",{version:"1.9pre",options:{active:0,animated:"slide",collapsible:false,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var self=this,options=self.options;self.running=false;self.element.addClass("ui-accordion ui-widget ui-helper-reset");self.headers=self.element.find(options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all");self._hoverable(self.headers);self._focusable(self.headers);self.headers.find(":first-child").addClass("ui-accordion-heading");self.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");if(!options.collapsible&&options.active===false){options.active=0}if(options.active<0){options.active+=this.headers.length}self.active=self._findActive(options.active).addClass("ui-state-default ui-state-active").toggleClass("ui-corner-all").toggleClass("ui-corner-top");self.active.next().addClass("ui-accordion-content-active");self._createIcons();self.refresh();self.element.attr("role","tablist");self.headers.attr("role","tab").bind("keydown.accordion",$.proxy(self,"_keydown")).next().attr("role","tabpanel");self.headers.not(self.active).attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).next().hide();if(!self.active.length){self.headers.eq(0).attr("tabIndex",0)}else{self.active.attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0})}if(!$.browser.safari){self.headers.find("a").attr("tabIndex",-1)}this._setupEvents(options.event)},_createIcons:function(){var icons=this.options.icons;if(icons){$("<span>").addClass("ui-accordion-header-icon ui-icon "+icons.header).prependTo(this.headers);this.active.children(".ui-accordion-header-icon").removeClass(icons.header).addClass(icons.activeHeader);this.element.addClass("ui-accordion-icons")}},_destroyIcons:function(){this.headers.children(".ui-accordion-header-icon").remove();this.element.removeClass("ui-accordion-icons")},_destroy:function(){this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-accordion-disabled ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("tabIndex").find("a").removeAttr("tabIndex").end().find(".ui-accordion-heading").removeClass("ui-accordion-heading");this._destroyIcons();var contents=this.headers.next().css("display","").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-accordion-disabled ui-state-disabled");if(this.options.heightStyle!=="content"){contents.css("height","")}},_setOption:function(key,value){if(key==="active"){this._activate(value);return}this._super("_setOption",key,value);if(key==="collapsible"&&!value&&this.options.active===false){this._activate(0)}if(key==="event"){this._setupEvents(value)}if(key==="icons"){this._destroyIcons();if(value){this._createIcons()}}if(key==="disabled"){this.headers.add(this.headers.next()).toggleClass("ui-accordion-disabled ui-state-disabled",!!value)}},_keydown:function(event){if(this.options.disabled||event.altKey||event.ctrlKey){return}var keyCode=$.ui.keyCode,length=this.headers.length,currentIndex=this.headers.index(event.target),toFocus=false;switch(event.keyCode){case keyCode.RIGHT:case keyCode.DOWN:toFocus=this.headers[(currentIndex+1)%length];break;case keyCode.LEFT:case keyCode.UP:toFocus=this.headers[(currentIndex-1+length)%length];break;case keyCode.SPACE:case keyCode.ENTER:this._eventHandler(event)}if(toFocus){$(event.target).attr("tabIndex",-1);$(toFocus).attr("tabIndex",0);toFocus.focus();event.preventDefault()}},refresh:function(){var options=this.options,parent=this.element.parent(),maxHeight,overflow;if(options.heightStyle==="fill"){if(!$.support.minHeight){overflow=parent.css("overflow");parent.css("overflow","hidden")}maxHeight=parent.height();this.element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");if(position==="absolute"||position==="fixed"){return}maxHeight-=elem.outerHeight(true)});if(overflow){parent.css("overflow",overflow)}this.headers.each(function(){maxHeight-=$(this).outerHeight(true)});this.headers.next().each(function(){$(this).height(Math.max(0,maxHeight-$(this).innerHeight()+$(this).height()))}).css("overflow","auto")}else{if(options.heightStyle==="auto"){maxHeight=0;this.headers.next().each(function(){maxHeight=Math.max(maxHeight,$(this).height("").height())}).height(maxHeight)}}return this},_activate:function(index){var active=this._findActive(index)[0];if(active===this.active[0]){return}active=active||this.active[0];this._eventHandler({target:active,currentTarget:active,preventDefault:$.noop})},_findActive:function(selector){return typeof selector==="number"?this.headers.eq(selector):$()},_setupEvents:function(event){this.headers.unbind(".accordion");if(event){this.headers.bind(event.split(" ").join(".accordion ")+".accordion",$.proxy(this,"_eventHandler"))}},_eventHandler:function(event){var options=this.options,active=this.active,clicked=$(event.currentTarget),clickedIsActive=clicked[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():clicked.next(),toHide=active.next(),eventData={oldHeader:active,oldContent:toHide,newHeader:collapsing?$():clicked,newContent:toShow};event.preventDefault();if(options.disabled||this.running||(clickedIsActive&&!options.collapsible)||(this._trigger("beforeActivate",event,eventData)===false)){return}options.active=collapsing?false:this.headers.index(clicked);this.active=clickedIsActive?$():clicked;this._toggle(eventData);active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-accordion-header-icon").removeClass(options.icons.activeHeader).addClass(options.icons.header);if(!clickedIsActive){clicked.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").children(".ui-accordion-header-icon").removeClass(options.icons.header).addClass(options.icons.activeHeader);clicked.next().addClass("ui-accordion-content-active")}},_toggle:function(data){var self=this,options=self.options,toShow=data.newContent,toHide=data.oldContent;self.running=true;function complete(){self._completed(data)}if(options.animated){var animations=$.ui.accordion.animations,animation=options.animated,additional;if(!animations[animation]){additional={easing:$.easing[animation]?animation:"slide",duration:700};animation="slide"}animations[animation]({toShow:toShow,toHide:toHide,complete:complete,down:toShow.length&&(!toHide.length||(toShow.index()<toHide.index()))},additional)}else{toHide.hide();toShow.show();complete()}toHide.prev().attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).blur();toShow.prev().attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}).focus()},_completed:function(data){var toShow=data.newContent,toHide=data.oldContent;this.running=false;if(this.options.heightStyle==="content"){toShow.add(toHide).css({height:"",overflow:""})}toHide.removeClass("ui-accordion-content-active");if(toHide.length){toHide.parent()[0].className=toHide.parent()[0].className}this._trigger("activate",null,data)}});$.extend($.ui.accordion,{animations:{slide:function(options,additions){var showOverflow=options.toShow.css("overflow"),hideOverflow=options.toHide.css("overflow"),percentDone=0,showProps={},hideProps={},fxAttrs=["height","paddingTop","paddingBottom"],originalWidth;options=$.extend({easing:"swing",duration:300},options,additions);if(!options.toHide.size()){originalWidth=options.toShow[0].style.width;options.toShow.show().width(options.toShow.width()).hide().animate({height:"show",paddingTop:"show",paddingBottom:"show"},{duration:options.duration,easing:options.easing,complete:function(){options.toShow.width(originalWidth);options.complete()}});return}if(!options.toShow.size()){options.toHide.animate({height:"hide",paddingTop:"hide",paddingBottom:"hide"},options);return}var s=options.toShow;originalWidth=s[0].style.width;s.width(parseInt(s.parent().width(),10)-parseInt(s.css("paddingLeft"),10)-parseInt(s.css("paddingRight"),10)-(parseInt(s.css("borderLeftWidth"),10)||0)-(parseInt(s.css("borderRightWidth"),10)||0));$.each(fxAttrs,function(i,prop){hideProps[prop]="hide";var parts=(""+$.css(options.toShow[0],prop)).match(/^([\d+-.]+)(.*)$/),propVal=prop==="height"&&parts[1]==="0"?1:parts[1];showProps[prop]={value:propVal,unit:parts[2]||"px"}});options.toShow.css({height:0,overflow:"hidden"}).show();options.toHide.filter(":hidden").each(options.complete).end().filter(":visible").animate(hideProps,{step:function(now,settings){if(settings.prop=="height"){percentDone=(settings.end-settings.start===0)?0:(settings.now-settings.start)/(settings.end-settings.start)}options.toShow[0].style[settings.prop]=(percentDone*showProps[settings.prop].value)+showProps[settings.prop].unit},duration:options.duration,easing:options.easing,complete:function(){options.toShow.css({width:originalWidth,overflow:showOverflow});options.toHide.css("overflow",hideOverflow);options.complete()}})},bounceslide:function(options){this.slide(options,{easing:options.down?"easeOutBounce":"swing",duration:options.down?1000:200})}}});if($.uiBackCompat!==false){(function($,prototype){$.extend(prototype.options,{navigation:false,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}});var _create=prototype._create;prototype._create=function(){if(this.options.navigation){var self=this,headers=this.element.find(this.options.header),content=headers.next(),current=headers.add(content).find("a").filter(this.options.navigationFilter)[0];if(current){headers.add(content).each(function(index){if($.contains(this,current)){self.options.active=Math.floor(index/2);return false}})}}_create.call(this)}}(jQuery,jQuery.ui.accordion.prototype));(function($,prototype){$.extend(prototype.options,{heightStyle:null,autoHeight:true,clearStyle:false,fillSpace:false});var _create=prototype._create,_setOption=prototype._setOption;$.extend(prototype,{_create:function(){this.options.heightStyle=this.options.heightStyle||this._mergeHeightStyle();_create.call(this)},_setOption:function(key,value){if(key==="autoHeight"||key==="clearStyle"||key==="fillSpace"){this.options.heightStyle=this._mergeHeightStyle()}_setOption.apply(this,arguments)},_mergeHeightStyle:function(){var options=this.options;if(options.fillSpace){return"fill"}if(options.clearStyle){return"content"}if(options.autoHeight){return"auto"}}})}(jQuery,jQuery.ui.accordion.prototype));(function($,prototype){$.extend(prototype.options.icons,{activeHeader:null,headerSelected:"ui-icon-triangle-1-s"});var _createIcons=prototype._createIcons;prototype._createIcons=function(){this.options.icons.activeHeader=this.options.icons.activeHeader||this.options.icons.headerSelected;_createIcons.call(this)}}(jQuery,jQuery.ui.accordion.prototype));(function($,prototype){prototype.activate=prototype._activate;var _findActive=prototype._findActive;prototype._findActive=function(index){if(index===-1){index=false}if(index&&typeof index!=="number"){index=this.headers.index(this.headers.filter(index));if(index===-1){index=false}}return _findActive.call(this,index)}}(jQuery,jQuery.ui.accordion.prototype));jQuery.ui.accordion.prototype.resize=jQuery.ui.accordion.prototype.refresh;(function($,prototype){$.extend(prototype.options,{change:null,changestart:null});var _trigger=prototype._trigger;prototype._trigger=function(type,event,data){var ret=_trigger.apply(this,arguments);if(!ret){return false}if(type==="beforeActivate"){ret=_trigger.call(this,"changestart",event,data)}else{if(type==="activate"){ret=_trigger.call(this,"change",event,data)}}return ret}}(jQuery,jQuery.ui.accordion.prototype))}})(jQuery);(function($,undefined){var requestIndex=0;$.widget("ui.autocomplete",{version:"1.9pre",defaultElement:"<input>",options:{appendTo:"body",autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var self=this,doc=this.element[0].ownerDocument,suppressKeyPress,suppressInput;this.valueMethod=this.element[this.element.is("input")?"val":"text"];this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(event){if(self.options.disabled||self.element.attr("readonly")){suppressKeyPress=true;suppressInput=true;return}suppressKeyPress=false;suppressInput=false;var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:suppressKeyPress=true;self._move("previousPage",event);break;case keyCode.PAGE_DOWN:suppressKeyPress=true;self._move("nextPage",event);break;case keyCode.UP:suppressKeyPress=true;self._move("previous",event);event.preventDefault();break;case keyCode.DOWN:suppressKeyPress=true;self._move("next",event);event.preventDefault();break;case keyCode.ENTER:case keyCode.NUMPAD_ENTER:if(self.menu.active){suppressKeyPress=true;event.preventDefault()}case keyCode.TAB:if(!self.menu.active){return}self.menu.select(event);break;case keyCode.ESCAPE:self._value(self.term);self.close(event);break;default:self._searchTimeout(event);break}}).bind("keypress.autocomplete",function(event){if(suppressKeyPress){suppressKeyPress=false;event.preventDefault();return}var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:self._move("previousPage",event);break;case keyCode.PAGE_DOWN:self._move("nextPage",event);break;case keyCode.UP:self._move("previous",event);event.preventDefault();break;case keyCode.DOWN:self._move("next",event);event.preventDefault();break}}).bind("input.autocomplete",function(event){if(suppressInput){suppressInput=false;event.preventDefault();return}self._searchTimeout(event)}).bind("focus.autocomplete",function(){if(self.options.disabled){return}self.selectedItem=null;self.previous=self._value()}).bind("blur.autocomplete",function(event){if(self.options.disabled){return}clearTimeout(self.searching);self.closing=setTimeout(function(){self.close(event);self._change(event)},150)});this._initSource();this.response=function(){return self._response.apply(self,arguments)};this.menu=$("<ul></ul>").addClass("ui-autocomplete").appendTo($(this.options.appendTo||"body",doc)[0]).mousedown(function(event){var menuElement=self.menu.element[0];if(!$(event.target).closest(".ui-menu-item").length){setTimeout(function(){$(document).one("mousedown",function(event){if(event.target!==self.element[0]&&event.target!==menuElement&&!$.contains(menuElement,event.target)){self.close()}})},1)}setTimeout(function(){clearTimeout(self.closing)},13)}).menu({input:$(),focus:function(event,ui){var item=ui.item.data("item.autocomplete");if(false!==self._trigger("focus",event,{item:item})){if(/^key/.test(event.originalEvent.type)){self._value(item.value)}}},select:function(event,ui){var item=ui.item.data("item.autocomplete"),previous=self.previous;if(self.element[0]!==doc.activeElement){self.element.focus();self.previous=previous;setTimeout(function(){self.previous=previous;self.selectedItem=item},1)}if(false!==self._trigger("select",event,{item:item})){self._value(item.value)}self.term=self._value();self.close(event);self.selectedItem=item},blur:function(event,ui){if(self.menu.element.is(":visible")&&(self._value()!==self.term)){self._value(self.term)}}}).zIndex(this.element.zIndex()+1).hide().data("menu");if($.fn.bgiframe){this.menu.element.bgiframe()}},_destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove()},_setOption:function(key,value){this._super("_setOption",key,value);if(key==="source"){this._initSource()}if(key==="appendTo"){this.menu.element.appendTo($(value||"body",this.element[0].ownerDocument)[0])}if(key==="disabled"&&value&&this.xhr){this.xhr.abort()}},_initSource:function(){var self=this,array,url;if($.isArray(this.options.source)){array=this.options.source;this.source=function(request,response){response($.ui.autocomplete.filter(array,request.term))}}else{if(typeof this.options.source==="string"){url=this.options.source;this.source=function(request,response){if(self.xhr){self.xhr.abort()}self.xhr=$.ajax({url:url,data:request,dataType:"json",autocompleteRequest:++requestIndex,success:function(data,status){if(this.autocompleteRequest===requestIndex){response(data)}},error:function(){if(this.autocompleteRequest===requestIndex){response([])}}})}}else{this.source=this.options.source}}},_searchTimeout:function(event){var self=this;self.searching=setTimeout(function(){if(self.term!=self.element.val()){self.selectedItem=null;self.search(null,event)}},self.options.delay)},search:function(value,event){value=value!=null?value:this._value();this.term=this._value();if(value.length<this.options.minLength){return this.close(event)}clearTimeout(this.closing);if(this._trigger("search",event)===false){return}return this._search(value)},_search:function(value){this.pending++;this.element.addClass("ui-autocomplete-loading");this.source({term:value},this.response)},_response:function(content){if(content){content=this._normalize(content)}this._trigger("response",null,{content:content});if(!this.options.disabled&&content&&content.length){this._suggest(content);this._trigger("open")}else{this.close()}this.pending--;if(!this.pending){this.element.removeClass("ui-autocomplete-loading")}},close:function(event){clearTimeout(this.closing);if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.blur();this._trigger("close",event)}},_change:function(event){if(this.previous!==this._value()){this._trigger("change",event,{item:this.selectedItem})}},_normalize:function(items){if(items.length&&items[0].label&&items[0].value){return items}return $.map(items,function(item){if(typeof item==="string"){return{label:item,value:item}}return $.extend({label:item.label||item.value,value:item.value||item.label},item)})},_suggest:function(items){var ul=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(ul,items);this.menu.blur();this.menu.refresh();ul.show();this._resizeMenu();ul.position($.extend({of:this.element},this.options.position));if(this.options.autoFocus){this.menu.next(new $.Event("mouseover"))}},_resizeMenu:function(){var ul=this.menu.element;ul.outerWidth(Math.max(ul.width("").outerWidth(),this.element.outerWidth()))},_renderMenu:function(ul,items){var self=this;$.each(items,function(index,item){self._renderItem(ul,item)})},_renderItem:function(ul,item){return $("<li></li>").data("item.autocomplete",item).append($("<a></a>").text(item.label)).appendTo(ul)},_move:function(direction,event){if(!this.menu.element.is(":visible")){this.search(null,event);return}if(this.menu.first()&&/^previous/.test(direction)||this.menu.last()&&/^next/.test(direction)){this._value(this.term);this.menu.blur();return}this.menu[direction](event)},widget:function(){return this.menu.element},_value:function(value){return this.valueMethod.apply(this.element,arguments)}});$.extend($.ui.autocomplete,{escapeRegex:function(value){return value.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(array,term){var matcher=new RegExp($.ui.autocomplete.escapeRegex(term),"i");return $.grep(array,function(value){return matcher.test(value.label||value.value||value)})}})}(jQuery));(function($,undefined){var lastActive,startXPos,startYPos,clickDragged,baseClasses="ui-button ui-widget ui-state-default ui-corner-all",stateClasses="ui-state-hover ui-state-active ",typeClasses="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",formResetHandler=function(){var buttons=$(this).find(":ui-button");setTimeout(function(){buttons.button("refresh")},1)},radioGroup=function(radio){var name=radio.name,form=radio.form,radios=$([]);if(name){if(form){radios=$(form).find("[name='"+name+"']")}else{radios=$("[name='"+name+"']",radio.ownerDocument).filter(function(){return !this.form})}}return radios};$.widget("ui.button",{version:"1.9pre",defaultElement:"<button>",options:{disabled:null,text:true,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",formResetHandler);if(typeof this.options.disabled!=="boolean"){this.options.disabled=this.element.attr("disabled")}this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var self=this,options=this.options,toggleButton=this.type==="checkbox"||this.type==="radio",hoverClass="ui-state-hover"+(!toggleButton?" ui-state-active":""),focusClass="ui-state-focus";if(options.label===null){options.label=this.buttonElement.html()}if(this.element.is(":disabled")){options.disabled=true}this.buttonElement.addClass(baseClasses).attr("role","button").bind("mouseenter.button",function(){if(options.disabled){return}$(this).addClass("ui-state-hover");if(this===lastActive){$(this).addClass("ui-state-active")}}).bind("mouseleave.button",function(){if(options.disabled){return}$(this).removeClass(hoverClass)}).bind("click.button",function(event){if(options.disabled){event.preventDefault();event.stopImmediatePropagation()}});this.element.bind("focus.button",function(){self.buttonElement.addClass(focusClass)}).bind("blur.button",function(){self.buttonElement.removeClass(focusClass)});if(toggleButton){this.element.bind("change.button",function(){if(clickDragged){return}self.refresh()});this.buttonElement.bind("mousedown.button",function(event){if(options.disabled){return}clickDragged=false;startXPos=event.pageX;startYPos=event.pageY}).bind("mouseup.button",function(event){if(options.disabled){return}if(startXPos!==event.pageX||startYPos!==event.pageY){clickDragged=true}})}if(this.type==="checkbox"){this.buttonElement.bind("click.button",function(){if(options.disabled||clickDragged){return false}$(this).toggleClass("ui-state-active");self.buttonElement.attr("aria-pressed",self.element[0].checked)})}else{if(this.type==="radio"){this.buttonElement.bind("click.button",function(){if(options.disabled||clickDragged){return false}$(this).addClass("ui-state-active");self.buttonElement.attr("aria-pressed",true);var radio=self.element[0];radioGroup(radio).not(radio).map(function(){return $(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed",false)})}else{this.buttonElement.bind("mousedown.button",function(){if(options.disabled){return false}$(this).addClass("ui-state-active");lastActive=this;$(document).one("mouseup",function(){lastActive=null})}).bind("mouseup.button",function(){if(options.disabled){return false}$(this).removeClass("ui-state-active")}).bind("keydown.button",function(event){if(options.disabled){return false}if(event.keyCode==$.ui.keyCode.SPACE||event.keyCode==$.ui.keyCode.ENTER){$(this).addClass("ui-state-active")}}).bind("keyup.button",function(){$(this).removeClass("ui-state-active")});if(this.buttonElement.is("a")){this.buttonElement.keyup(function(event){if(event.keyCode===$.ui.keyCode.SPACE){$(this).click()}})}}}this._setOption("disabled",options.disabled);this._resetButton()},_determineButtonType:function(){if(this.element.is(":checkbox")){this.type="checkbox"}else{if(this.element.is(":radio")){this.type="radio"}else{if(this.element.is("input")){this.type="input"}else{this.type="button"}}}if(this.type==="checkbox"||this.type==="radio"){var ancestor=this.element.parents().last(),labelSelector="label[for="+this.element.attr("id")+"]";this.buttonElement=ancestor.find(labelSelector);if(!this.buttonElement.length){ancestor=ancestor.length?ancestor.siblings():this.element.siblings();this.buttonElement=ancestor.filter(labelSelector);if(!this.buttonElement.length){this.buttonElement=ancestor.find(labelSelector)}}this.element.addClass("ui-helper-hidden-accessible");var checked=this.element.is(":checked");if(checked){this.buttonElement.addClass("ui-state-active")}this.buttonElement.attr("aria-pressed",checked)}else{this.buttonElement=this.element}},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass(baseClasses+" "+stateClasses+" "+typeClasses).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());if(!this.hasTitle){this.buttonElement.removeAttr("title")}},_setOption:function(key,value){this._super("_setOption",key,value);if(key==="disabled"){if(value){this.element.attr("disabled",true)}else{this.element.removeAttr("disabled")}return}this._resetButton()},refresh:function(){var isDisabled=this.element.is(":disabled");if(isDisabled!==this.options.disabled){this._setOption("disabled",isDisabled)}if(this.type==="radio"){radioGroup(this.element[0]).each(function(){if($(this).is(":checked")){$(this).button("widget").addClass("ui-state-active").attr("aria-pressed",true)}else{$(this).button("widget").removeClass("ui-state-active").attr("aria-pressed",false)}})}else{if(this.type==="checkbox"){if(this.element.is(":checked")){this.buttonElement.addClass("ui-state-active").attr("aria-pressed",true)}else{this.buttonElement.removeClass("ui-state-active").attr("aria-pressed",false)}}}},_resetButton:function(){if(this.type==="input"){if(this.options.label){this.element.val(this.options.label)}return}var buttonElement=this.buttonElement.removeClass(typeClasses),buttonText=$("<span></span>").addClass("ui-button-text").html(this.options.label).appendTo(buttonElement.empty()).text(),icons=this.options.icons,multipleIcons=icons.primary&&icons.secondary,buttonClasses=[];if(icons.primary||icons.secondary){if(this.options.text){buttonClasses.push("ui-button-text-icon"+(multipleIcons?"s":(icons.primary?"-primary":"-secondary")))}if(icons.primary){buttonElement.prepend("<span class='ui-button-icon-primary ui-icon "+icons.primary+"'></span>")}if(icons.secondary){buttonElement.append("<span class='ui-button-icon-secondary ui-icon "+icons.secondary+"'></span>")}if(!this.options.text){buttonClasses.push(multipleIcons?"ui-button-icons-only":"ui-button-icon-only");if(!this.hasTitle){buttonElement.attr("title",buttonText)}}}else{buttonClasses.push("ui-button-text-only")}buttonElement.addClass(buttonClasses.join(" "))}});$.ui.button.version="1.9pre";$.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(key,value){if(key==="disabled"){this.buttons.button("option",key,value)}this._super("_setOption",key,value)},refresh:function(){var ltr=this.element.css("direction")==="ltr";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return $(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(ltr?"ui-corner-left":"ui-corner-right").end().filter(":last").addClass(ltr?"ui-corner-right":"ui-corner-left").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return $(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery));(function($,undefined){$.extend($.ui,{datepicker:{version:"1.9pre"}});var PROP_NAME="datepicker";var dpuuid=new Date().getTime();var instActive;function Datepicker(){this.debug=false;this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false,disabled:false};$.extend(this._defaults,this.regional[""]);this.dpDiv=bindHover($('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){if(this.debug){console.log.apply("",arguments)}},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(settings){extendRemove(this._defaults,settings||{});return this},_attachDatepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute("date:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase();var inline=(nodeName=="div"||nodeName=="span");if(!target.id){this.uuid+=1;target.id="dp"+this.uuid}var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{});if(nodeName=="input"){this._connectDatepicker(target,inst)}else{if(inline){this._inlineDatepicker(target,inst)}}},_newInst:function(target,inline){var id=target[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:id,input:target,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:inline,dpDiv:(!inline?this.dpDiv:bindHover($('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')))}},_connectDatepicker:function(target,inst){var input=$(target);inst.append=$([]);inst.trigger=$([]);if(input.hasClass(this.markerClassName)){return}this._attachments(input,inst);input.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(event,key,value){inst.settings[key]=value}).bind("getData.datepicker",function(event,key){return this._get(inst,key)});this._autoSize(inst);$.data(target,PROP_NAME,inst);if(inst.settings.disabled){this._disableDatepicker(target)}},_attachments:function(input,inst){var appendText=this._get(inst,"appendText");var isRTL=this._get(inst,"isRTL");if(inst.append){inst.append.remove()}if(appendText){inst.append=$('<span class="'+this._appendClass+'">'+appendText+"</span>");input[isRTL?"before":"after"](inst.append)}input.unbind("focus",this._showDatepicker);if(inst.trigger){inst.trigger.remove()}var showOn=this._get(inst,"showOn");if(showOn=="focus"||showOn=="both"){input.focus(this._showDatepicker)}if(showOn=="button"||showOn=="both"){var buttonText=this._get(inst,"buttonText");var buttonImage=this._get(inst,"buttonImage");inst.trigger=$(this._get(inst,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:buttonImage,alt:buttonText,title:buttonText}):$('<button type="button"></button>').addClass(this._triggerClass).html(buttonImage==""?buttonText:$("<img/>").attr({src:buttonImage,alt:buttonText,title:buttonText})));input[isRTL?"before":"after"](inst.trigger);inst.trigger.click(function(){if($.datepicker._datepickerShowing&&$.datepicker._lastInput==input[0]){$.datepicker._hideDatepicker()}else{$.datepicker._showDatepicker(input[0])}return false})}},_autoSize:function(inst){if(this._get(inst,"autoSize")&&!inst.inline){var date=new Date(2009,12-1,20);var dateFormat=this._get(inst,"dateFormat");if(dateFormat.match(/[DM]/)){var findMax=function(names){var max=0;var maxI=0;for(var i=0;i<names.length;i++){if(names[i].length>max){max=names[i].length;maxI=i}}return maxI};date.setMonth(findMax(this._get(inst,(dateFormat.match(/MM/)?"monthNames":"monthNamesShort"))));date.setDate(findMax(this._get(inst,(dateFormat.match(/DD/)?"dayNames":"dayNamesShort")))+20-date.getDay())}inst.input.attr("size",this._formatDate(inst,date).length)}},_inlineDatepicker:function(target,inst){var divSpan=$(target);if(divSpan.hasClass(this.markerClassName)){return}divSpan.addClass(this.markerClassName).append(inst.dpDiv).bind("setData.datepicker",function(event,key,value){inst.settings[key]=value}).bind("getData.datepicker",function(event,key){return this._get(inst,key)});$.data(target,PROP_NAME,inst);this._setDate(inst,this._getDefaultDate(inst),true);this._updateDatepicker(inst);this._updateAlternate(inst);if(inst.settings.disabled){this._disableDatepicker(target)}inst.dpDiv.show()},_dialogDatepicker:function(input,date,onSelect,settings,pos){var inst=this._dialogInst;if(!inst){this.uuid+=1;var id="dp"+this.uuid;this._dialogInput=$('<input type="text" id="'+id+'" style="position: absolute; top: -100px; width: 0px; z-index: -10;"/>');this._dialogInput.keydown(this._doKeyDown);$("body").append(this._dialogInput);inst=this._dialogInst=this._newInst(this._dialogInput,false);inst.settings={};$.data(this._dialogInput[0],PROP_NAME,inst)}extendRemove(inst.settings,settings||{});date=(date&&date.constructor==Date?this._formatDate(inst,date):date);this._dialogInput.val(date);this._pos=(pos?(pos.length?pos:[pos.pageX,pos.pageY]):null);if(!this._pos){var browserWidth=document.documentElement.clientWidth;var browserHeight=document.documentElement.clientHeight;var scrollX=document.documentElement.scrollLeft||document.body.scrollLeft;var scrollY=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[(browserWidth/2)-100+scrollX,(browserHeight/2)-150+scrollY]}this._dialogInput.css("left",(this._pos[0]+20)+"px").css("top",this._pos[1]+"px");inst.settings.onSelect=onSelect;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);if($.blockUI){$.blockUI(this.dpDiv)}$.data(this._dialogInput[0],PROP_NAME,inst);return this},_destroyDatepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return}var nodeName=target.nodeName.toLowerCase();$.removeData(target,PROP_NAME);if(nodeName=="input"){inst.append.remove();inst.trigger.remove();$target.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)}else{if(nodeName=="div"||nodeName=="span"){$target.removeClass(this.markerClassName).empty()}}},_enableDatepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return}var nodeName=target.nodeName.toLowerCase();if(nodeName=="input"){target.disabled=false;inst.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""})}else{if(nodeName=="div"||nodeName=="span"){var inline=$target.children("."+this._inlineClass);inline.children().removeClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").removeAttr("disabled")}}this._disabledInputs=$.map(this._disabledInputs,function(value){return(value==target?null:value)})},_disableDatepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return}var nodeName=target.nodeName.toLowerCase();if(nodeName=="input"){target.disabled=true;inst.trigger.filter("button").each(function(){this.disabled=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else{if(nodeName=="div"||nodeName=="span"){var inline=$target.children("."+this._inlineClass);inline.children().addClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").attr("disabled","disabled")}}this._disabledInputs=$.map(this._disabledInputs,function(value){return(value==target?null:value)});this._disabledInputs[this._disabledInputs.length]=target},_isDisabledDatepicker:function(target){if(!target){return false}for(var i=0;i<this._disabledInputs.length;i++){if(this._disabledInputs[i]==target){return true}}return false},_getInst:function(target){try{return $.data(target,PROP_NAME)}catch(err){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(target,name,value){var inst=this._getInst(target);if(arguments.length==2&&typeof name=="string"){return(name=="defaults"?$.extend({},$.datepicker._defaults):(inst?(name=="all"?$.extend({},inst.settings):this._get(inst,name)):null))}var settings=name||{};if(typeof name=="string"){settings={};settings[name]=value}if(inst){if(this._curInst==inst){this._hideDatepicker()}var date=this._getDateDatepicker(target,true);var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");extendRemove(inst.settings,settings);if(minDate!==null&&settings.dateFormat!==undefined&&settings.minDate===undefined){inst.settings.minDate=this._formatDate(inst,minDate)}if(maxDate!==null&&settings.dateFormat!==undefined&&settings.maxDate===undefined){inst.settings.maxDate=this._formatDate(inst,maxDate)}this._attachments($(target),inst);this._autoSize(inst);this._setDate(inst,date);this._updateAlternate(inst);this._updateDatepicker(inst)}},_changeDatepicker:function(target,name,value){this._optionDatepicker(target,name,value)},_refreshDatepicker:function(target){var inst=this._getInst(target);if(inst){this._updateDatepicker(inst)}},_setDateDatepicker:function(target,date){var inst=this._getInst(target);if(inst){this._setDate(inst,date);this._updateDatepicker(inst);this._updateAlternate(inst)}},_getDateDatepicker:function(target,noDefault){var inst=this._getInst(target);if(inst&&!inst.inline){this._setDateFromField(inst,noDefault)}return(inst?this._getDate(inst):null)},_doKeyDown:function(event){var inst=$.datepicker._getInst(event.target);var handled=true;var isRTL=inst.dpDiv.is(".ui-datepicker-rtl");inst._keyEvent=true;if($.datepicker._datepickerShowing){switch(event.keyCode){case 9:$.datepicker._hideDatepicker();handled=false;break;case 13:var sel=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",inst.dpDiv);if(sel[0]){$.datepicker._selectDay(event.target,inst.selectedMonth,inst.selectedYear,sel[0])}else{$.datepicker._hideDatepicker()}return false;break;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(event.target,(event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M");break;case 34:$.datepicker._adjustDate(event.target,(event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M");break;case 35:if(event.ctrlKey||event.metaKey){$.datepicker._clearDate(event.target)}handled=event.ctrlKey||event.metaKey;break;case 36:if(event.ctrlKey||event.metaKey){$.datepicker._gotoToday(event.target)}handled=event.ctrlKey||event.metaKey;break;case 37:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,(isRTL?+1:-1),"D")}handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,(event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M")}break;case 38:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,-7,"D")}handled=event.ctrlKey||event.metaKey;break;case 39:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,(isRTL?-1:+1),"D")}handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,(event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M")}break;case 40:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,+7,"D")}handled=event.ctrlKey||event.metaKey;break;default:handled=false}}else{if(event.keyCode==36&&event.ctrlKey){$.datepicker._showDatepicker(this)}else{handled=false}}if(handled){event.preventDefault();event.stopPropagation()}},_doKeyPress:function(event){var inst=$.datepicker._getInst(event.target);if($.datepicker._get(inst,"constrainInput")){var chars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat"));var chr=String.fromCharCode(event.charCode==undefined?event.keyCode:event.charCode);return event.ctrlKey||event.metaKey||(chr<" "||!chars||chars.indexOf(chr)>-1)}},_doKeyUp:function(event){var inst=$.datepicker._getInst(event.target);if(inst.input.val()!=inst.lastVal){try{var date=$.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),(inst.input?inst.input.val():null),$.datepicker._getFormatConfig(inst));if(date){$.datepicker._setDateFromField(inst);$.datepicker._updateAlternate(inst);$.datepicker._updateDatepicker(inst)}}catch(event){$.datepicker.log(event)}}return true},_showDatepicker:function(input){input=input.target||input;if(input.nodeName.toLowerCase()!="input"){input=$("input",input.parentNode)[0]}if($.datepicker._isDisabledDatepicker(input)||$.datepicker._lastInput==input){return}var inst=$.datepicker._getInst(input);if($.datepicker._curInst&&$.datepicker._curInst!=inst){if($.datepicker._datepickerShowing){$.datepicker._triggerOnClose($.datepicker._curInst)}$.datepicker._curInst.dpDiv.stop(true,true)}var beforeShow=$.datepicker._get(inst,"beforeShow");extendRemove(inst.settings,(beforeShow?beforeShow.apply(input,[input,inst]):{}));inst.lastVal=null;$.datepicker._lastInput=input;$.datepicker._setDateFromField(inst);if($.datepicker._inDialog){input.value=""}if(!$.datepicker._pos){$.datepicker._pos=$.datepicker._findPos(input);$.datepicker._pos[1]+=input.offsetHeight}var isFixed=false;$(input).parents().each(function(){isFixed|=$(this).css("position")=="fixed";return !isFixed});if(isFixed&&$.browser.opera){$.datepicker._pos[0]-=document.documentElement.scrollLeft;$.datepicker._pos[1]-=document.documentElement.scrollTop}var offset={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null;inst.dpDiv.empty();inst.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});$.datepicker._updateDatepicker(inst);offset=$.datepicker._checkOffset(inst,offset,isFixed);inst.dpDiv.css({position:($.datepicker._inDialog&&$.blockUI?"static":(isFixed?"fixed":"absolute")),display:"none",left:offset.left+"px",top:offset.top+"px"});if(!inst.inline){var showAnim=$.datepicker._get(inst,"showAnim");var duration=$.datepicker._get(inst,"duration");var postProcess=function(){var cover=inst.dpDiv.find("iframe.ui-datepicker-cover");if(!!cover.length){var borders=$.datepicker._getBorders(inst.dpDiv);cover.css({left:-borders[0],top:-borders[1],width:inst.dpDiv.outerWidth(),height:inst.dpDiv.outerHeight()})}};inst.dpDiv.zIndex($(input).zIndex()+1);$.datepicker._datepickerShowing=true;if($.effects&&($.effects.effect[showAnim]||$.effects[showAnim])){inst.dpDiv.show(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess)}else{inst.dpDiv[showAnim||"show"]((showAnim?duration:null),postProcess)}if(!showAnim||!duration){postProcess()}if(inst.input.is(":visible")&&!inst.input.is(":disabled")){inst.input.focus()}$.datepicker._curInst=inst}},_updateDatepicker:function(inst){var self=this;self.maxRows=4;var borders=$.datepicker._getBorders(inst.dpDiv);instActive=inst;inst.dpDiv.empty().append(this._generateHTML(inst));var cover=inst.dpDiv.find("iframe.ui-datepicker-cover");if(!!cover.length){cover.css({left:-borders[0],top:-borders[1],width:inst.dpDiv.outerWidth(),height:inst.dpDiv.outerHeight()})}inst.dpDiv.find("."+this._dayOverClass+" a").mouseover();var numMonths=this._getNumberOfMonths(inst);var cols=numMonths[1];var width=17;inst.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");if(cols>1){inst.dpDiv.addClass("ui-datepicker-multi-"+cols).css("width",(width*cols)+"em")}inst.dpDiv[(numMonths[0]!=1||numMonths[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi");inst.dpDiv[(this._get(inst,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");if(inst==$.datepicker._curInst&&$.datepicker._datepickerShowing&&inst.input&&inst.input.is(":visible")&&!inst.input.is(":disabled")&&inst.input[0]!=document.activeElement){inst.input.focus()}if(inst.yearshtml){var origyearshtml=inst.yearshtml;setTimeout(function(){if(origyearshtml===inst.yearshtml&&inst.yearshtml){inst.dpDiv.find("select.ui-datepicker-year:first").replaceWith(inst.yearshtml)}origyearshtml=inst.yearshtml=null},0)}},_getBorders:function(elem){var convert=function(value){return{thin:1,medium:2,thick:3}[value]||value};return[parseFloat(convert(elem.css("border-left-width"))),parseFloat(convert(elem.css("border-top-width")))]},_checkOffset:function(inst,offset,isFixed){var dpWidth=inst.dpDiv.outerWidth();var dpHeight=inst.dpDiv.outerHeight();var inputWidth=inst.input?inst.input.outerWidth():0;var inputHeight=inst.input?inst.input.outerHeight():0;var viewWidth=document.documentElement.clientWidth+$(document).scrollLeft();var viewHeight=document.documentElement.clientHeight+$(document).scrollTop();offset.left-=(this._get(inst,"isRTL")?(dpWidth-inputWidth):0);offset.left-=(isFixed&&offset.left==inst.input.offset().left)?$(document).scrollLeft():0;offset.top-=(isFixed&&offset.top==(inst.input.offset().top+inputHeight))?$(document).scrollTop():0;offset.left-=Math.min(offset.left,(offset.left+dpWidth>viewWidth&&viewWidth>dpWidth)?Math.abs(offset.left+dpWidth-viewWidth):0);offset.top-=Math.min(offset.top,(offset.top+dpHeight>viewHeight&&viewHeight>dpHeight)?Math.abs(dpHeight+inputHeight):0);return offset},_findPos:function(obj){var inst=this._getInst(obj);var isRTL=this._get(inst,"isRTL");while(obj&&(obj.type=="hidden"||obj.nodeType!=1||$.expr.filters.hidden(obj))){obj=obj[isRTL?"previousSibling":"nextSibling"]}var position=$(obj).offset();return[position.left,position.top]},_triggerOnClose:function(inst){var onClose=this._get(inst,"onClose");if(onClose){onClose.apply((inst.input?inst.input[0]:null),[(inst.input?inst.input.val():""),inst])}},_hideDatepicker:function(input){var inst=this._curInst;if(!inst||(input&&inst!=$.data(input,PROP_NAME))){return}if(this._datepickerShowing){var showAnim=this._get(inst,"showAnim");var duration=this._get(inst,"duration");var postProcess=function(){$.datepicker._tidyDialog(inst);this._curInst=null};if($.effects&&($.effects.effect[showAnim]||$.effects[showAnim])){inst.dpDiv.hide(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess)}else{inst.dpDiv[(showAnim=="slideDown"?"slideUp":(showAnim=="fadeIn"?"fadeOut":"hide"))]((showAnim?duration:null),postProcess)}if(!showAnim){postProcess()}$.datepicker._triggerOnClose(inst);this._datepickerShowing=false;this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if($.blockUI){$.unblockUI();$("body").append(this.dpDiv)}}this._inDialog=false}},_tidyDialog:function(inst){inst.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(event){if(!$.datepicker._curInst){return}var $target=$(event.target);if($target[0].id!=$.datepicker._mainDivId&&$target.parents("#"+$.datepicker._mainDivId).length==0&&!$target.hasClass($.datepicker.markerClassName)&&!$target.hasClass($.datepicker._triggerClass)&&$.datepicker._datepickerShowing&&!($.datepicker._inDialog&&$.blockUI)){$.datepicker._hideDatepicker()}},_adjustDate:function(id,offset,period){var target=$(id);var inst=this._getInst(target[0]);if(this._isDisabledDatepicker(target[0])){return}this._adjustInstDate(inst,offset+(period=="M"?this._get(inst,"showCurrentAtPos"):0),period);this._updateDatepicker(inst)},_gotoToday:function(id){var target=$(id);var inst=this._getInst(target[0]);if(this._get(inst,"gotoCurrent")&&inst.currentDay){inst.selectedDay=inst.currentDay;inst.drawMonth=inst.selectedMonth=inst.currentMonth;inst.drawYear=inst.selectedYear=inst.currentYear}else{var date=new Date();inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear()}this._notifyChange(inst);this._adjustDate(target)},_selectMonthYear:function(id,select,period){var target=$(id);var inst=this._getInst(target[0]);inst._selectingMonthYear=false;inst["selected"+(period=="M"?"Month":"Year")]=inst["draw"+(period=="M"?"Month":"Year")]=parseInt(select.options[select.selectedIndex].value,10);this._notifyChange(inst);this._adjustDate(target)},_clickMonthYear:function(id){var target=$(id);var inst=this._getInst(target[0]);if(inst.input&&inst._selectingMonthYear){setTimeout(function(){inst.input.focus()},0)}inst._selectingMonthYear=!inst._selectingMonthYear},_selectDay:function(id,month,year,td){var target=$(id);if($(td).hasClass(this._unselectableClass)||this._isDisabledDatepicker(target[0])){return}var inst=this._getInst(target[0]);inst.selectedDay=inst.currentDay=$("a",td).html();inst.selectedMonth=inst.currentMonth=month;inst.selectedYear=inst.currentYear=year;this._selectDate(id,this._formatDate(inst,inst.currentDay,inst.currentMonth,inst.currentYear))},_clearDate:function(id){var target=$(id);var inst=this._getInst(target[0]);this._selectDate(target,"")},_selectDate:function(id,dateStr){var target=$(id);var inst=this._getInst(target[0]);dateStr=(dateStr!=null?dateStr:this._formatDate(inst));if(inst.input){inst.input.val(dateStr)}this._updateAlternate(inst);var onSelect=this._get(inst,"onSelect");if(onSelect){onSelect.apply((inst.input?inst.input[0]:null),[dateStr,inst])}else{if(inst.input){inst.input.trigger("change")}}if(inst.inline){this._updateDatepicker(inst)}else{this._hideDatepicker();this._lastInput=inst.input[0];if(typeof(inst.input[0])!="object"){inst.input.focus()}this._lastInput=null}},_updateAlternate:function(inst){var altField=this._get(inst,"altField");if(altField){var altFormat=this._get(inst,"altFormat")||this._get(inst,"dateFormat");var date=this._getDate(inst);var dateStr=this.formatDate(altFormat,date,this._getFormatConfig(inst));$(altField).each(function(){$(this).val(dateStr)})}},noWeekends:function(date){var day=date.getDay();return[(day>0&&day<6),""]},iso8601Week:function(date){var checkDate=new Date(date.getTime());checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7));var time=checkDate.getTime();checkDate.setMonth(0);checkDate.setDate(1);return Math.floor(Math.round((time-checkDate)/86400000)/7)+1},parseDate:function(format,value,settings){if(format==null||value==null){throw"Invalid arguments"}value=(typeof value=="object"?value.toString():value+"");if(value==""){return null}var shortYearCutoff=(settings?settings.shortYearCutoff:null)||this._defaults.shortYearCutoff;shortYearCutoff=(typeof shortYearCutoff!="string"?shortYearCutoff:new Date().getFullYear()%100+parseInt(shortYearCutoff,10));var dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort;var dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames;var monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort;var monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames;var year=-1;var month=-1;var day=-1;var doy=-1;var literal=false;var lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)==match);if(matches){iFormat++}return matches};var getNumber=function(match){var isDoubled=lookAhead(match);var size=(match=="@"?14:(match=="!"?20:(match=="y"&&isDoubled?4:(match=="o"?3:2))));var digits=new RegExp("^\\d{1,"+size+"}");var num=value.substring(iValue).match(digits);if(!num){throw"Missing number at position "+iValue}iValue+=num[0].length;return parseInt(num[0],10)};var getName=function(match,shortNames,longNames){var names=$.map(lookAhead(match)?longNames:shortNames,function(v,k){return[[k,v]]}).sort(function(a,b){return -(a[1].length-b[1].length)});var index=-1;$.each(names,function(i,pair){var name=pair[1];if(value.substr(iValue,name.length).toLowerCase()==name.toLowerCase()){index=pair[0];iValue+=name.length;return false}});if(index!=-1){return index+1}else{throw"Unknown name at position "+iValue}};var checkLiteral=function(){if(value.charAt(iValue)!=format.charAt(iFormat)){throw"Unexpected literal at position "+iValue}iValue++};var iValue=0;for(var iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{checkLiteral()}}else{switch(format.charAt(iFormat)){case"d":day=getNumber("d");break;case"D":getName("D",dayNamesShort,dayNames);break;case"o":doy=getNumber("o");break;case"m":month=getNumber("m");break;case"M":month=getName("M",monthNamesShort,monthNames);break;case"y":year=getNumber("y");break;case"@":var date=new Date(getNumber("@"));year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"!":var date=new Date((getNumber("!")-this._ticksTo1970)/10000);year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"'":if(lookAhead("'")){checkLiteral()}else{literal=true}break;default:checkLiteral()}}}if(iValue<value.length){throw"Extra/unparsed characters found in date: "+value.substring(iValue)}if(year==-1){year=new Date().getFullYear()}else{if(year<100){year+=new Date().getFullYear()-new Date().getFullYear()%100+(year<=shortYearCutoff?0:-100)}}if(doy>-1){month=1;day=doy;do{var dim=this._getDaysInMonth(year,month-1);if(day<=dim){break}month++;day-=dim}while(true)}var date=this._daylightSavingAdjust(new Date(year,month-1,day));if(date.getFullYear()!=year||date.getMonth()+1!=month||date.getDate()!=day){throw"Invalid date"}return date},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*10000000),formatDate:function(format,date,settings){if(!date){return""}var dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort;var dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames;var monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort;var monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames;var lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)==match);if(matches){iFormat++}return matches};var formatNumber=function(match,value,len){var num=""+value;if(lookAhead(match)){while(num.length<len){num="0"+num}}return num};var formatName=function(match,value,shortNames,longNames){return(lookAhead(match)?longNames[value]:shortNames[value])};var output="";var literal=false;if(date){for(var iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{output+=format.charAt(iFormat)}}else{switch(format.charAt(iFormat)){case"d":output+=formatNumber("d",date.getDate(),2);break;case"D":output+=formatName("D",date.getDay(),dayNamesShort,dayNames);break;case"o":output+=formatNumber("o",Math.round((new Date(date.getFullYear(),date.getMonth(),date.getDate()).getTime()-new Date(date.getFullYear(),0,0).getTime())/86400000),3);break;case"m":output+=formatNumber("m",date.getMonth()+1,2);break;case"M":output+=formatName("M",date.getMonth(),monthNamesShort,monthNames);break;case"y":output+=(lookAhead("y")?date.getFullYear():(date.getYear()%100<10?"0":"")+date.getYear()%100);break;case"@":output+=date.getTime();break;case"!":output+=date.getTime()*10000+this._ticksTo1970;break;case"'":if(lookAhead("'")){output+="'"}else{literal=true}break;default:output+=format.charAt(iFormat)}}}}return output},_possibleChars:function(format){var chars="";var literal=false;var lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)==match);if(matches){iFormat++}return matches};for(var iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{chars+=format.charAt(iFormat)}}else{switch(format.charAt(iFormat)){case"d":case"m":case"y":case"@":chars+="0123456789";break;case"D":case"M":return null;case"'":if(lookAhead("'")){chars+="'"}else{literal=true}break;default:chars+=format.charAt(iFormat)}}}return chars},_get:function(inst,name){return inst.settings[name]!==undefined?inst.settings[name]:this._defaults[name]},_setDateFromField:function(inst,noDefault){if(inst.input.val()==inst.lastVal){return}var dateFormat=this._get(inst,"dateFormat");var dates=inst.lastVal=inst.input?inst.input.val():null;var date,defaultDate;date=defaultDate=this._getDefaultDate(inst);var settings=this._getFormatConfig(inst);try{date=this.parseDate(dateFormat,dates,settings)||defaultDate}catch(event){this.log(event);dates=(noDefault?"":dates)}inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();inst.currentDay=(dates?date.getDate():0);inst.currentMonth=(dates?date.getMonth():0);inst.currentYear=(dates?date.getFullYear():0);this._adjustInstDate(inst)},_getDefaultDate:function(inst){return this._restrictMinMax(inst,this._determineDate(inst,this._get(inst,"defaultDate"),new Date()))},_determineDate:function(inst,date,defaultDate){var offsetNumeric=function(offset){var date=new Date();date.setDate(date.getDate()+offset);return date};var offsetString=function(offset){try{return $.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),offset,$.datepicker._getFormatConfig(inst))}catch(e){}var date=(offset.toLowerCase().match(/^c/)?$.datepicker._getDate(inst):null)||new Date();var year=date.getFullYear();var month=date.getMonth();var day=date.getDate();var pattern=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g;var matches=pattern.exec(offset);while(matches){switch(matches[2]||"d"){case"d":case"D":day+=parseInt(matches[1],10);break;case"w":case"W":day+=parseInt(matches[1],10)*7;break;case"m":case"M":month+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break;case"y":case"Y":year+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break}matches=pattern.exec(offset)}return new Date(year,month,day)};var newDate=(date==null||date===""?defaultDate:(typeof date=="string"?offsetString(date):(typeof date=="number"?(isNaN(date)?defaultDate:offsetNumeric(date)):new Date(date.getTime()))));newDate=(newDate&&newDate.toString()=="Invalid Date"?defaultDate:newDate);if(newDate){newDate.setHours(0);newDate.setMinutes(0);newDate.setSeconds(0);newDate.setMilliseconds(0)}return this._daylightSavingAdjust(newDate)},_daylightSavingAdjust:function(date){if(!date){return null}date.setHours(date.getHours()>12?date.getHours()+2:0);return date},_setDate:function(inst,date,noChange){var clear=!date;var origMonth=inst.selectedMonth;var origYear=inst.selectedYear;var newDate=this._restrictMinMax(inst,this._determineDate(inst,date,new Date()));inst.selectedDay=inst.currentDay=newDate.getDate();inst.drawMonth=inst.selectedMonth=inst.currentMonth=newDate.getMonth();inst.drawYear=inst.selectedYear=inst.currentYear=newDate.getFullYear();if((origMonth!=inst.selectedMonth||origYear!=inst.selectedYear)&&!noChange){this._notifyChange(inst)}this._adjustInstDate(inst);if(inst.input){inst.input.val(clear?"":this._formatDate(inst))}},_getDate:function(inst){var startDate=(!inst.currentYear||(inst.input&&inst.input.val()=="")?null:this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));return startDate},_generateHTML:function(inst){var today=new Date();today=this._daylightSavingAdjust(new Date(today.getFullYear(),today.getMonth(),today.getDate()));var isRTL=this._get(inst,"isRTL");var showButtonPanel=this._get(inst,"showButtonPanel");var hideIfNoPrevNext=this._get(inst,"hideIfNoPrevNext");var navigationAsDateFormat=this._get(inst,"navigationAsDateFormat");var numMonths=this._getNumberOfMonths(inst);var showCurrentAtPos=this._get(inst,"showCurrentAtPos");var stepMonths=this._get(inst,"stepMonths");var isMultiMonth=(numMonths[0]!=1||numMonths[1]!=1);var currentDate=this._daylightSavingAdjust((!inst.currentDay?new Date(9999,9,9):new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");var drawMonth=inst.drawMonth-showCurrentAtPos;var drawYear=inst.drawYear;if(drawMonth<0){drawMonth+=12;drawYear--}if(maxDate){var maxDraw=this._daylightSavingAdjust(new Date(maxDate.getFullYear(),maxDate.getMonth()-(numMonths[0]*numMonths[1])+1,maxDate.getDate()));maxDraw=(minDate&&maxDraw<minDate?minDate:maxDraw);while(this._daylightSavingAdjust(new Date(drawYear,drawMonth,1))>maxDraw){drawMonth--;if(drawMonth<0){drawMonth=11;drawYear--}}}inst.drawMonth=drawMonth;inst.drawYear=drawYear;var prevText=this._get(inst,"prevText");prevText=(!navigationAsDateFormat?prevText:this.formatDate(prevText,this._daylightSavingAdjust(new Date(drawYear,drawMonth-stepMonths,1)),this._getFormatConfig(inst)));var prev=(this._canAdjustMonth(inst,-1,drawYear,drawMonth)?'<a class="ui-datepicker-prev ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._adjustDate('#"+inst.id+"', -"+stepMonths+", 'M');\" title=\""+prevText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"e":"w")+'">'+prevText+"</span></a>":(hideIfNoPrevNext?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+prevText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"e":"w")+'">'+prevText+"</span></a>"));var nextText=this._get(inst,"nextText");nextText=(!navigationAsDateFormat?nextText:this.formatDate(nextText,this._daylightSavingAdjust(new Date(drawYear,drawMonth+stepMonths,1)),this._getFormatConfig(inst)));var next=(this._canAdjustMonth(inst,+1,drawYear,drawMonth)?'<a class="ui-datepicker-next ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._adjustDate('#"+inst.id+"', +"+stepMonths+", 'M');\" title=\""+nextText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"w":"e")+'">'+nextText+"</span></a>":(hideIfNoPrevNext?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+nextText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"w":"e")+'">'+nextText+"</span></a>"));var currentText=this._get(inst,"currentText");var gotoDate=(this._get(inst,"gotoCurrent")&&inst.currentDay?currentDate:today);currentText=(!navigationAsDateFormat?currentText:this.formatDate(currentText,gotoDate,this._getFormatConfig(inst)));var controls=(!inst.inline?'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" onclick="DP_jQuery_'+dpuuid+'.datepicker._hideDatepicker();">'+this._get(inst,"closeText")+"</button>":"");var buttonPanel=(showButtonPanel)?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(isRTL?controls:"")+(this._isInRange(inst,gotoDate)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._gotoToday('#"+inst.id+"');\">"+currentText+"</button>":"")+(isRTL?"":controls)+"</div>":"";var firstDay=parseInt(this._get(inst,"firstDay"),10);firstDay=(isNaN(firstDay)?0:firstDay);var showWeek=this._get(inst,"showWeek");var dayNames=this._get(inst,"dayNames");var dayNamesShort=this._get(inst,"dayNamesShort");var dayNamesMin=this._get(inst,"dayNamesMin");var monthNames=this._get(inst,"monthNames");var monthNamesShort=this._get(inst,"monthNamesShort");var beforeShowDay=this._get(inst,"beforeShowDay");var showOtherMonths=this._get(inst,"showOtherMonths");var selectOtherMonths=this._get(inst,"selectOtherMonths");var calculateWeek=this._get(inst,"calculateWeek")||this.iso8601Week;var defaultDate=this._getDefaultDate(inst);var html="";for(var row=0;row<numMonths[0];row++){var group="";this.maxRows=4;for(var col=0;col<numMonths[1];col++){var selectedDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,inst.selectedDay));var cornerClass=" ui-corner-all";var calender="";if(isMultiMonth){calender+='<div class="ui-datepicker-group';if(numMonths[1]>1){switch(col){case 0:calender+=" ui-datepicker-group-first";cornerClass=" ui-corner-"+(isRTL?"right":"left");break;case numMonths[1]-1:calender+=" ui-datepicker-group-last";cornerClass=" ui-corner-"+(isRTL?"left":"right");break;default:calender+=" ui-datepicker-group-middle";cornerClass="";break}}calender+='">'}calender+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+cornerClass+'">'+(/all|left/.test(cornerClass)&&row==0?(isRTL?next:prev):"")+(/all|right/.test(cornerClass)&&row==0?(isRTL?prev:next):"")+this._generateMonthYearHeader(inst,drawMonth,drawYear,minDate,maxDate,row>0||col>0,monthNames,monthNamesShort)+'</div><table class="ui-datepicker-calendar"><thead><tr>';var thead=(showWeek?'<th class="ui-datepicker-week-col">'+this._get(inst,"weekHeader")+"</th>":"");for(var dow=0;dow<7;dow++){var day=(dow+firstDay)%7;thead+="<th"+((dow+firstDay+6)%7>=5?' class="ui-datepicker-week-end"':"")+'><span title="'+dayNames[day]+'">'+dayNamesMin[day]+"</span></th>"}calender+=thead+"</tr></thead><tbody>";var daysInMonth=this._getDaysInMonth(drawYear,drawMonth);if(drawYear==inst.selectedYear&&drawMonth==inst.selectedMonth){inst.selectedDay=Math.min(inst.selectedDay,daysInMonth)}var leadDays=(this._getFirstDayOfMonth(drawYear,drawMonth)-firstDay+7)%7;var curRows=Math.ceil((leadDays+daysInMonth)/7);var numRows=(isMultiMonth?this.maxRows>curRows?this.maxRows:curRows:curRows);this.maxRows=numRows;var printDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,1-leadDays));for(var dRow=0;dRow<numRows;dRow++){calender+="<tr>";var tbody=(!showWeek?"":'<td class="ui-datepicker-week-col">'+this._get(inst,"calculateWeek")(printDate)+"</td>");for(var dow=0;dow<7;dow++){var daySettings=(beforeShowDay?beforeShowDay.apply((inst.input?inst.input[0]:null),[printDate]):[true,""]);var otherMonth=(printDate.getMonth()!=drawMonth);var unselectable=(otherMonth&&!selectOtherMonths)||!daySettings[0]||(minDate&&printDate<minDate)||(maxDate&&printDate>maxDate);tbody+='<td class="'+((dow+firstDay+6)%7>=5?" ui-datepicker-week-end":"")+(otherMonth?" ui-datepicker-other-month":"")+((printDate.getTime()==selectedDate.getTime()&&drawMonth==inst.selectedMonth&&inst._keyEvent)||(defaultDate.getTime()==printDate.getTime()&&defaultDate.getTime()==selectedDate.getTime())?" "+this._dayOverClass:"")+(unselectable?" "+this._unselectableClass+" ui-state-disabled":"")+(otherMonth&&!showOtherMonths?"":" "+daySettings[1]+(printDate.getTime()==currentDate.getTime()?" "+this._currentClass:"")+(printDate.getTime()==today.getTime()?" ui-datepicker-today":""))+'"'+((!otherMonth||showOtherMonths)&&daySettings[2]?' title="'+daySettings[2]+'"':"")+(unselectable?"":' onclick="DP_jQuery_'+dpuuid+".datepicker._selectDay('#"+inst.id+"',"+printDate.getMonth()+","+printDate.getFullYear()+', this);return false;"')+">"+(otherMonth&&!showOtherMonths?"&#xa0;":(unselectable?'<span class="ui-state-default">'+printDate.getDate()+"</span>":'<a class="ui-state-default'+(printDate.getTime()==today.getTime()?" ui-state-highlight":"")+(printDate.getTime()==currentDate.getTime()?" ui-state-active":"")+(otherMonth?" ui-priority-secondary":"")+'" href="#">'+printDate.getDate()+"</a>"))+"</td>";printDate.setDate(printDate.getDate()+1);printDate=this._daylightSavingAdjust(printDate)}calender+=tbody+"</tr>"}drawMonth++;if(drawMonth>11){drawMonth=0;drawYear++}calender+="</tbody></table>"+(isMultiMonth?"</div>"+((numMonths[0]>0&&col==numMonths[1]-1)?'<div class="ui-datepicker-row-break"></div>':""):"");group+=calender}html+=group}html+=buttonPanel+($.browser.msie&&parseInt($.browser.version,10)<7&&!inst.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':"");inst._keyEvent=false;return html},_generateMonthYearHeader:function(inst,drawMonth,drawYear,minDate,maxDate,secondary,monthNames,monthNamesShort){var changeMonth=this._get(inst,"changeMonth");var changeYear=this._get(inst,"changeYear");var showMonthAfterYear=this._get(inst,"showMonthAfterYear");var html='<div class="ui-datepicker-title">';var monthHtml="";if(secondary||!changeMonth){monthHtml+='<span class="ui-datepicker-month">'+monthNames[drawMonth]+"</span>"}else{var inMinYear=(minDate&&minDate.getFullYear()==drawYear);var inMaxYear=(maxDate&&maxDate.getFullYear()==drawYear);monthHtml+='<select class="ui-datepicker-month" onchange="DP_jQuery_'+dpuuid+".datepicker._selectMonthYear('#"+inst.id+"', this, 'M');\" onclick=\"DP_jQuery_"+dpuuid+".datepicker._clickMonthYear('#"+inst.id+"');\">";for(var month=0;month<12;month++){if((!inMinYear||month>=minDate.getMonth())&&(!inMaxYear||month<=maxDate.getMonth())){monthHtml+='<option value="'+month+'"'+(month==drawMonth?' selected="selected"':"")+">"+monthNamesShort[month]+"</option>"}}monthHtml+="</select>"}if(!showMonthAfterYear){html+=monthHtml+(secondary||!(changeMonth&&changeYear)?"&#xa0;":"")}if(!inst.yearshtml){inst.yearshtml="";if(secondary||!changeYear){html+='<span class="ui-datepicker-year">'+drawYear+"</span>"}else{var years=this._get(inst,"yearRange").split(":");var thisYear=new Date().getFullYear();var determineYear=function(value){var year=(value.match(/c[+-].*/)?drawYear+parseInt(value.substring(1),10):(value.match(/[+-].*/)?thisYear+parseInt(value,10):parseInt(value,10)));return(isNaN(year)?thisYear:year)};var year=determineYear(years[0]);var endYear=Math.max(year,determineYear(years[1]||""));year=(minDate?Math.max(year,minDate.getFullYear()):year);endYear=(maxDate?Math.min(endYear,maxDate.getFullYear()):endYear);inst.yearshtml+='<select class="ui-datepicker-year" onchange="DP_jQuery_'+dpuuid+".datepicker._selectMonthYear('#"+inst.id+"', this, 'Y');\" onclick=\"DP_jQuery_"+dpuuid+".datepicker._clickMonthYear('#"+inst.id+"');\">";for(;year<=endYear;year++){inst.yearshtml+='<option value="'+year+'"'+(year==drawYear?' selected="selected"':"")+">"+year+"</option>"}inst.yearshtml+="</select>";html+=inst.yearshtml;inst.yearshtml=null}}html+=this._get(inst,"yearSuffix");if(showMonthAfterYear){html+=(secondary||!(changeMonth&&changeYear)?"&#xa0;":"")+monthHtml}html+="</div>";return html},_adjustInstDate:function(inst,offset,period){var year=inst.drawYear+(period=="Y"?offset:0);var month=inst.drawMonth+(period=="M"?offset:0);var day=Math.min(inst.selectedDay,this._getDaysInMonth(year,month))+(period=="D"?offset:0);var date=this._restrictMinMax(inst,this._daylightSavingAdjust(new Date(year,month,day)));inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();if(period=="M"||period=="Y"){this._notifyChange(inst)}},_restrictMinMax:function(inst,date){var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");var newDate=(minDate&&date<minDate?minDate:date);newDate=(maxDate&&newDate>maxDate?maxDate:newDate);return newDate},_notifyChange:function(inst){var onChange=this._get(inst,"onChangeMonthYear");if(onChange){onChange.apply((inst.input?inst.input[0]:null),[inst.selectedYear,inst.selectedMonth+1,inst])}},_getNumberOfMonths:function(inst){var numMonths=this._get(inst,"numberOfMonths");return(numMonths==null?[1,1]:(typeof numMonths=="number"?[1,numMonths]:numMonths))},_getMinMaxDate:function(inst,minMax){return this._determineDate(inst,this._get(inst,minMax+"Date"),null)},_getDaysInMonth:function(year,month){return 32-this._daylightSavingAdjust(new Date(year,month,32)).getDate()},_getFirstDayOfMonth:function(year,month){return new Date(year,month,1).getDay()},_canAdjustMonth:function(inst,offset,curYear,curMonth){var numMonths=this._getNumberOfMonths(inst);var date=this._daylightSavingAdjust(new Date(curYear,curMonth+(offset<0?offset:numMonths[0]*numMonths[1]),1));if(offset<0){date.setDate(this._getDaysInMonth(date.getFullYear(),date.getMonth()))}return this._isInRange(inst,date)},_isInRange:function(inst,date){var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");return((!minDate||date.getTime()>=minDate.getTime())&&(!maxDate||date.getTime()<=maxDate.getTime()))},_getFormatConfig:function(inst){var shortYearCutoff=this._get(inst,"shortYearCutoff");shortYearCutoff=(typeof shortYearCutoff!="string"?shortYearCutoff:new Date().getFullYear()%100+parseInt(shortYearCutoff,10));return{shortYearCutoff:shortYearCutoff,dayNamesShort:this._get(inst,"dayNamesShort"),dayNames:this._get(inst,"dayNames"),monthNamesShort:this._get(inst,"monthNamesShort"),monthNames:this._get(inst,"monthNames")}},_formatDate:function(inst,day,month,year){if(!day){inst.currentDay=inst.selectedDay;inst.currentMonth=inst.selectedMonth;inst.currentYear=inst.selectedYear}var date=(day?(typeof day=="object"?day:this._daylightSavingAdjust(new Date(year,month,day))):this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));return this.formatDate(this._get(inst,"dateFormat"),date,this._getFormatConfig(inst))}});function bindHover(dpDiv){var selector="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return dpDiv.delegate(selector,"mouseout",function(){$(this).removeClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!=-1){$(this).removeClass("ui-datepicker-prev-hover")}if(this.className.indexOf("ui-datepicker-next")!=-1){$(this).removeClass("ui-datepicker-next-hover")}}).delegate(selector,"mouseover",function(){if(!$.datepicker._isDisabledDatepicker(instActive.inline?dpDiv.parent()[0]:instActive.input[0])){$(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");$(this).addClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!=-1){$(this).addClass("ui-datepicker-prev-hover")}if(this.className.indexOf("ui-datepicker-next")!=-1){$(this).addClass("ui-datepicker-next-hover")}}})}function extendRemove(target,props){$.extend(target,props);for(var name in props){if(props[name]==null||props[name]==undefined){target[name]=props[name]}}return target}function isArray(a){return(a&&(($.browser.safari&&typeof a=="object"&&a.length)||(a.constructor&&a.constructor.toString().match(/\Array\(\)/))))}$.fn.datepicker=function(options){if(!this.length){return this}if(!$.datepicker.initialized){$(document).mousedown($.datepicker._checkExternalClick).find("body").append($.datepicker.dpDiv);$.datepicker.initialized=true}var otherArgs=Array.prototype.slice.call(arguments,1);if(typeof options=="string"&&(options=="isDisabled"||options=="getDate"||options=="widget")){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))}if(options=="option"&&arguments.length==2&&typeof arguments[1]=="string"){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))}return this.each(function(){typeof options=="string"?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this].concat(otherArgs)):$.datepicker._attachDatepicker(this,options)})};$.datepicker=new Datepicker();$.datepicker.initialized=false;$.datepicker.uuid=new Date().getTime();$.datepicker.version="1.9pre";window["DP_jQuery_"+dpuuid]=$})(jQuery);(function($,undefined){var uiDialogClasses="ui-dialog ui-widget ui-widget-content ui-corner-all ",sizeRelatedOptions={buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},resizableRelatedOptions={maxHeight:true,maxWidth:true,minHeight:true,minWidth:true};$.widget("ui.dialog",{version:"1.9pre",options:{autoOpen:true,buttons:{},closeOnEscape:true,closeText:"close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:false,maxWidth:false,minHeight:150,minWidth:150,modal:false,position:{my:"center",at:"center",of:window,collision:"fit",using:function(pos){var topOffset=$(this).css(pos).offset().top;if(topOffset<0){$(this).css("top",pos.top-topOffset)}}},resizable:true,show:null,stack:true,title:"",width:300,zIndex:1000},_create:function(){this.originalTitle=this.element.attr("title");if(typeof this.originalTitle!=="string"){this.originalTitle=""}this.options.title=this.options.title||this.originalTitle;var self=this,options=self.options,title=options.title||"&#160;",titleId=$.ui.dialog.getTitleId(self.element),uiDialog=(self.uiDialog=$("<div>")).addClass(uiDialogClasses+options.dialogClass).css({display:"none",outline:0,zIndex:options.zIndex}).attr("tabIndex",-1).keydown(function(event){if(options.closeOnEscape&&!event.isDefaultPrevented()&&event.keyCode&&event.keyCode===$.ui.keyCode.ESCAPE){self.close(event);event.preventDefault()}}).attr({role:"dialog","aria-labelledby":titleId}).mousedown(function(event){self.moveToTop(false,event)}),uiDialogContent=self.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(uiDialog),uiDialogTitlebar=(self.uiDialogTitlebar=$("<div>")).addClass("ui-dialog-titlebar  ui-widget-header  ui-corner-all  ui-helper-clearfix").prependTo(uiDialog),uiDialogTitlebarClose=$("<a href='#'></a>").addClass("ui-dialog-titlebar-close  ui-corner-all").attr("role","button").click(function(event){event.preventDefault();self.close(event)}).appendTo(uiDialogTitlebar),uiDialogTitlebarCloseText=(self.uiDialogTitlebarCloseText=$("<span>")).addClass("ui-icon ui-icon-closethick").text(options.closeText).appendTo(uiDialogTitlebarClose),uiDialogTitle=$("<span>").addClass("ui-dialog-title").attr("id",titleId).html(title).prependTo(uiDialogTitlebar);uiDialogTitlebar.find("*").add(uiDialogTitlebar).disableSelection();this._hoverable(uiDialogTitlebarClose);this._focusable(uiDialogTitlebarClose);if(options.draggable&&$.fn.draggable){self._makeDraggable()}if(options.resizable&&$.fn.resizable){self._makeResizable()}self._createButtons(options.buttons);self._isOpen=false;uiDialog.appendTo(document.body);if($.fn.bgiframe){uiDialog.bgiframe()}},_init:function(){if(this.options.autoOpen){this.open()}},_destroy:function(){var self=this;if(self.overlay){self.overlay.destroy()}self.uiDialog.hide();self.element.removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");self.uiDialog.remove();if(self.originalTitle){self.element.attr("title",self.originalTitle)}},widget:function(){return this.uiDialog},close:function(event){if(!this._isOpen){return self}var self=this,maxZ,thisZ;if(false===self._trigger("beforeClose",event)){return}self._isOpen=false;if(self.overlay){self.overlay.destroy()}self.uiDialog.unbind("keypress.ui-dialog");if(self.options.hide){self.uiDialog.hide(self.options.hide,function(){self._trigger("close",event)})}else{self.uiDialog.hide();self._trigger("close",event)}$.ui.dialog.overlay.resize();if(self.options.modal){maxZ=0;$(".ui-dialog").each(function(){if(this!==self.uiDialog[0]){thisZ=$(this).css("z-index");if(!isNaN(thisZ)){maxZ=Math.max(maxZ,thisZ)}}});$.ui.dialog.maxZ=maxZ}return self},isOpen:function(){return this._isOpen},moveToTop:function(force,event){var self=this,options=self.options,saveScroll;if((options.modal&&!force)||(!options.stack&&!options.modal)){return self._trigger("focus",event)}if(options.zIndex>$.ui.dialog.maxZ){$.ui.dialog.maxZ=options.zIndex}if(self.overlay){$.ui.dialog.maxZ+=1;$.ui.dialog.overlay.maxZ=$.ui.dialog.maxZ;self.overlay.$el.css("z-index",$.ui.dialog.overlay.maxZ)}saveScroll={scrollTop:self.element.attr("scrollTop"),scrollLeft:self.element.attr("scrollLeft")};$.ui.dialog.maxZ+=1;self.uiDialog.css("z-index",$.ui.dialog.maxZ);self.element.attr(saveScroll);self._trigger("focus",event);return self},open:function(){if(this._isOpen){return}var self=this,options=self.options,uiDialog=self.uiDialog;self._size();self._position(options.position);uiDialog.show(options.show);self.overlay=options.modal?new $.ui.dialog.overlay(self):null;self.moveToTop(true);if(options.modal){uiDialog.bind("keypress.ui-dialog",function(event){if(event.keyCode!==$.ui.keyCode.TAB){return}var tabbables=$(":tabbable",this),first=tabbables.filter(":first"),last=tabbables.filter(":last");if(event.target===last[0]&&!event.shiftKey){first.focus(1);return false}else{if(event.target===first[0]&&event.shiftKey){last.focus(1);return false}}})}var hasFocus=self.element.find(":tabbable");if(!hasFocus.length){hasFocus=uiDialog.find(".ui-dialog-buttonpane :tabbable");if(!hasFocus.length){hasFocus=uiDialog}}hasFocus.eq(0).focus();self._isOpen=true;self._trigger("open");return self},_createButtons:function(buttons){var self=this,hasButtons=false;self.uiDialog.find(".ui-dialog-buttonpane").remove();if(typeof buttons==="object"&&buttons!==null){$.each(buttons,function(){return !(hasButtons=true)})}if(hasButtons){var uiDialogButtonPane=$("<div>").addClass("ui-dialog-buttonpane  ui-widget-content ui-helper-clearfix"),uiButtonSet=$("<div>").addClass("ui-dialog-buttonset").appendTo(uiDialogButtonPane);$.each(buttons,function(name,props){props=$.isFunction(props)?{click:props,text:name}:props;var button=$("<button type='button'>").attr(props,true).unbind("click").click(function(){props.click.apply(self.element[0],arguments)}).appendTo(uiButtonSet);if($.fn.button){button.button()}});self.uiDialog.addClass("ui-dialog-buttons");uiDialogButtonPane.appendTo(self.uiDialog)}else{self.uiDialog.removeClass("ui-dialog-buttons")}},_makeDraggable:function(){var self=this,options=self.options,doc=$(document);function filteredUi(ui){return{position:ui.position,offset:ui.offset}}self.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(event,ui){$(this).addClass("ui-dialog-dragging");self._trigger("dragStart",event,filteredUi(ui))},drag:function(event,ui){self._trigger("drag",event,filteredUi(ui))},stop:function(event,ui){options.position=[ui.position.left-doc.scrollLeft(),ui.position.top-doc.scrollTop()];$(this).removeClass("ui-dialog-dragging");self._trigger("dragStop",event,filteredUi(ui));$.ui.dialog.overlay.resize()}})},_makeResizable:function(handles){handles=(handles===undefined?this.options.resizable:handles);var self=this,options=self.options,position=self.uiDialog.css("position"),resizeHandles=typeof handles==="string"?handles:"n,e,s,w,se,sw,ne,nw";function filteredUi(ui){return{originalPosition:ui.originalPosition,originalSize:ui.originalSize,position:ui.position,size:ui.size}}self.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:self.element,maxWidth:options.maxWidth,maxHeight:options.maxHeight,minWidth:options.minWidth,minHeight:self._minHeight(),handles:resizeHandles,start:function(event,ui){$(this).addClass("ui-dialog-resizing");self._trigger("resizeStart",event,filteredUi(ui))},resize:function(event,ui){self._trigger("resize",event,filteredUi(ui))},stop:function(event,ui){$(this).removeClass("ui-dialog-resizing");options.height=$(this).height();options.width=$(this).width();self._trigger("resizeStop",event,filteredUi(ui));$.ui.dialog.overlay.resize()}}).css("position",position).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var options=this.options;if(options.height==="auto"){return options.minHeight}else{return Math.min(options.minHeight,options.height)}},_position:function(position){var myAt=[],offset=[0,0],isVisible;if(position){if(typeof position==="string"||(typeof position==="object"&&"0" in position)){myAt=position.split?position.split(" "):[position[0],position[1]];if(myAt.length===1){myAt[1]=myAt[0]}$.each(["left","top"],function(i,offsetPosition){if(+myAt[i]===myAt[i]){offset[i]=myAt[i];myAt[i]=offsetPosition}});position={my:myAt.join(" "),at:myAt.join(" "),offset:offset.join(" ")}}position=$.extend({},$.ui.dialog.prototype.options.position,position)}else{position=$.ui.dialog.prototype.options.position}isVisible=this.uiDialog.is(":visible");if(!isVisible){this.uiDialog.show()}this.uiDialog.position(position);if(!isVisible){this.uiDialog.hide()}},_setOptions:function(options){var self=this,resizableOptions={},resize=false;$.each(options,function(key,value){self._setOption(key,value);if(key in sizeRelatedOptions){resize=true}if(key in resizableRelatedOptions){resizableOptions[key]=value}});if(resize){this._size()}if(this.uiDialog.is(":data(resizable)")){this.uiDialog.resizable("option",resizableOptions)}},_setOption:function(key,value){var self=this,uiDialog=self.uiDialog;switch(key){case"buttons":self._createButtons(value);break;case"closeText":self.uiDialogTitlebarCloseText.text(""+value);break;case"dialogClass":uiDialog.removeClass(self.options.dialogClass).addClass(uiDialogClasses+value);break;case"disabled":if(value){uiDialog.addClass("ui-dialog-disabled")}else{uiDialog.removeClass("ui-dialog-disabled")}break;case"draggable":var isDraggable=uiDialog.is(":data(draggable)");if(isDraggable&&!value){uiDialog.draggable("destroy")}if(!isDraggable&&value){self._makeDraggable()}break;case"position":self._position(value);break;case"resizable":var isResizable=uiDialog.is(":data(resizable)");if(isResizable&&!value){uiDialog.resizable("destroy")}if(isResizable&&typeof value==="string"){uiDialog.resizable("option","handles",value)}if(!isResizable&&value!==false){self._makeResizable(value)}break;case"title":$(".ui-dialog-title",self.uiDialogTitlebar).html(""+(value||"&#160;"));break}this._super("_setOption",key,value)},_size:function(){var options=this.options,nonContentHeight,minContentHeight,isVisible=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0});if(options.minWidth>options.width){options.width=options.minWidth}nonContentHeight=this.uiDialog.css({height:"auto",width:options.width}).height();minContentHeight=Math.max(0,options.minHeight-nonContentHeight);if(options.height==="auto"){if($.support.minHeight){this.element.css({minHeight:minContentHeight,height:"auto"})}else{this.uiDialog.show();var autoHeight=this.element.css("height","auto").height();if(!isVisible){this.uiDialog.hide()}this.element.height(Math.max(autoHeight,minContentHeight))}}else{this.element.height(Math.max(options.height-nonContentHeight,0))}if(this.uiDialog.is(":data(resizable)")){this.uiDialog.resizable("option","minHeight",this._minHeight())}}});$.extend($.ui.dialog,{uuid:0,maxZ:0,getTitleId:function($el){var id=$el.attr("id");if(!id){this.uuid+=1;id=this.uuid}return"ui-dialog-title-"+id},overlay:function(dialog){this.$el=$.ui.dialog.overlay.create(dialog)}});$.extend($.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:$.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(event){return event+".dialog-overlay"}).join(" "),create:function(dialog){if(this.instances.length===0){setTimeout(function(){if($.ui.dialog.overlay.instances.length){$(document).bind($.ui.dialog.overlay.events,function(event){if($(event.target).zIndex()<$.ui.dialog.overlay.maxZ){return false}})}},1);$(document).bind("keydown.dialog-overlay",function(event){if(dialog.options.closeOnEscape&&!event.isDefaultPrevented()&&event.keyCode&&event.keyCode===$.ui.keyCode.ESCAPE){dialog.close(event);event.preventDefault()}});$(window).bind("resize.dialog-overlay",$.ui.dialog.overlay.resize)}var $el=(this.oldInstances.pop()||$("<div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),height:this.height()});if($.fn.bgiframe){$el.bgiframe()}this.instances.push($el);return $el},destroy:function($el){var indexOf=$.inArray($el,this.instances);if(indexOf!==-1){this.oldInstances.push(this.instances.splice(indexOf,1)[0])}if(this.instances.length===0){$([document,window]).unbind(".dialog-overlay")}$el.height(0).width(0).remove();var maxZ=0;$.each(this.instances,function(){maxZ=Math.max(maxZ,this.css("z-index"))});this.maxZ=maxZ},height:function(){var scrollHeight,offsetHeight;if($.browser.msie){scrollHeight=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);offsetHeight=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);if(scrollHeight<offsetHeight){return $(window).height()+"px"}else{return scrollHeight+"px"}}else{return $(document).height()+"px"}},width:function(){var scrollWidth,offsetWidth;if($.browser.msie){scrollWidth=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth);offsetWidth=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth);if(scrollWidth<offsetWidth){return $(window).width()+"px"}else{return scrollWidth+"px"}}else{return $(document).width()+"px"}},resize:function(){var $overlays=$([]);$.each($.ui.dialog.overlay.instances,function(){$overlays=$overlays.add(this)});$overlays.css({width:0,height:0}).css({width:$.ui.dialog.overlay.width(),height:$.ui.dialog.overlay.height()})}});$.extend($.ui.dialog.overlay.prototype,{destroy:function(){$.ui.dialog.overlay.destroy(this.$el)}})}(jQuery));(function($){var idIncrement=0;$.widget("ui.menu",{version:"1.9pre",defaultElement:"<ul>",delay:150,options:{position:{my:"left top",at:"right top"}},_create:function(){var self=this;this.activeMenu=this.element;this.menuId=this.element.attr("id")||"ui-menu-"+idIncrement++;if(this.element.find(".ui-icon").length){this.element.addClass("ui-menu-icons")}this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({id:this.menuId,role:"menu"}).bind("click.menu",function(event){var item=$(event.target).closest(".ui-menu-item:has(a)");if(self.options.disabled){return false}if(!item.length){return}if(!self.active||(self.active[0]!==item[0])){self.focus(event,item)}self.select(event)}).bind("mouseover.menu",function(event){if(self.options.disabled){return}var target=$(event.target).closest(".ui-menu-item");if(target.length){self.focus(event,target)}}).bind("mouseout.menu",function(event){if(self.options.disabled){return}var target=$(event.target).closest(".ui-menu-item");if(target.length){self.blur(event)}});this.refresh();this.element.attr("tabIndex",0).bind("keydown.menu",function(event){if(self.options.disabled){return}switch(event.keyCode){case $.ui.keyCode.PAGE_UP:self.previousPage(event);event.preventDefault();event.stopImmediatePropagation();break;case $.ui.keyCode.PAGE_DOWN:self.nextPage(event);event.preventDefault();event.stopImmediatePropagation();break;case $.ui.keyCode.UP:self.previous(event);event.preventDefault();event.stopImmediatePropagation();break;case $.ui.keyCode.DOWN:self.next(event);event.preventDefault();event.stopImmediatePropagation();break;case $.ui.keyCode.LEFT:if(self.left(event)){event.stopImmediatePropagation()}event.preventDefault();break;case $.ui.keyCode.RIGHT:if(self.right(event)){event.stopImmediatePropagation()}event.preventDefault();break;case $.ui.keyCode.ENTER:if(self.active.children("a[aria-haspopup='true']").length){if(self.right(event)){event.stopImmediatePropagation()}}else{self.select(event);event.stopImmediatePropagation()}event.preventDefault();break;case $.ui.keyCode.ESCAPE:if(self.left(event)){event.stopImmediatePropagation()}event.preventDefault();break;default:event.stopPropagation();clearTimeout(self.filterTimer);var match,prev=self.previousFilter||"",character=String.fromCharCode(event.keyCode),skip=false;if(character==prev){skip=true}else{character=prev+character}function escape(value){return value.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}match=self.activeMenu.children(".ui-menu-item").filter(function(){return new RegExp("^"+escape(character),"i").test($(this).children("a").text())});match=skip&&match.index(self.active.next())!=-1?self.active.nextAll(".ui-menu-item"):match;if(!match.length){character=String.fromCharCode(event.keyCode);match=self.activeMenu.children(".ui-menu-item").filter(function(){return new RegExp("^"+escape(character),"i").test($(this).children("a").text())})}if(match.length){self.focus(event,match);if(match.length>1){self.previousFilter=character;self.filterTimer=setTimeout(function(){delete self.previousFilter},1000)}else{delete self.previousFilter}}else{delete self.previousFilter}}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find("ul").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").show();this.element.find(".ui-menu-item").unbind(".menu").removeClass("ui-menu-item").removeAttr("role").children("a").removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").removeAttr("id").children(".ui-icon").remove()},refresh:function(){var self=this,submenus=this.element.find("ul:not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr("role","menu").hide().attr("aria-hidden","true").attr("aria-expanded","false"),items=submenus.add(this.element).children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation");items.children("a").addClass("ui-corner-all").attr("tabIndex",-1).attr("role","menuitem").attr("id",function(i){return self.element.attr("id")+"-"+i});submenus.each(function(){var menu=$(this),item=menu.prev("a");item.attr("aria-haspopup","true").prepend('<span class="ui-menu-icon ui-icon ui-icon-carat-1-e"></span>');menu.attr("aria-labelledby",item.attr("id"))})},focus:function(event,item){var nested,self=this;this.blur();if(this._hasScroll()){var borderTop=parseFloat($.curCSS(this.element[0],"borderTopWidth",true))||0,paddingTop=parseFloat($.curCSS(this.element[0],"paddingTop",true))||0,offset=item.offset().top-this.element.offset().top-borderTop-paddingTop,scroll=this.element.scrollTop(),elementHeight=this.element.height(),itemHeight=item.height();if(offset<0){this.element.scrollTop(scroll+offset)}else{if(offset+itemHeight>elementHeight){this.element.scrollTop(scroll+offset-elementHeight+itemHeight)}}}this.active=item.first().children("a").addClass("ui-state-focus").end();self.element.attr("aria-activedescendant",self.active.children("a").attr("id"));this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active");self.timer=setTimeout(function(){self._close()},self.delay);nested=$(">ul",item);if(nested.length&&(/^mouse/.test(event.type))){self._startOpening(nested)}this.activeMenu=item.parent();this._trigger("focus",event,{item:item})},blur:function(event){if(!this.active){return}clearTimeout(this.timer);this.active.children("a").removeClass("ui-state-focus");this.active=null},_startOpening:function(submenu){clearTimeout(this.timer);var self=this;self.timer=setTimeout(function(){self._close();self._open(submenu)},self.delay)},_open:function(submenu){clearTimeout(this.timer);this.element.find(".ui-menu").not(submenu.parents()).hide().attr("aria-hidden","true");var position=$.extend({},{of:this.active},$.type(this.options.position)=="function"?this.options.position(this.active):this.options.position);submenu.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(position)},closeAll:function(){this.element.find("ul").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active");this.blur();this.activeMenu=this.element},_close:function(){this.active.parent().find("ul").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},left:function(event){var newItem=this.active&&this.active.parents("li:not(.ui-menubar-item)").first();if(newItem&&newItem.length){this.active.parent().attr("aria-hidden","true").attr("aria-expanded","false").hide();this.focus(event,newItem);return true}},right:function(event){var self=this,newItem=this.active&&this.active.children("ul").children("li").first();if(newItem&&newItem.length){this._open(newItem.parent());setTimeout(function(){self.focus(event,newItem)},20);return true}},next:function(event){this._move("next",".ui-menu-item","first",event)},previous:function(event){this._move("prev",".ui-menu-item","last",event)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(direction,edge,filter,event){if(!this.active){this.focus(event,this.activeMenu.children(edge)[filter]());return}var next=this.active[direction+"All"](".ui-menu-item").eq(0);if(next.length){this.focus(event,next)}else{this.focus(event,this.activeMenu.children(edge)[filter]())}},nextPage:function(event){if(this._hasScroll()){if(!this.active||this.last()){this.focus(event,this.activeMenu.children(".ui-menu-item").first());return}var base=this.active.offset().top,height=this.element.height(),result;this.active.nextAll(".ui-menu-item").each(function(){result=$(this);return $(this).offset().top-base-height<0});this.focus(event,result)}else{this.focus(event,this.activeMenu.children(".ui-menu-item")[!this.active||this.last()?"first":"last"]())}},previousPage:function(event){if(this._hasScroll()){if(!this.active||this.first()){this.focus(event,this.activeMenu.children(".ui-menu-item").last());return}var base=this.active.offset().top,height=this.element.height(),result;this.active.prevAll(".ui-menu-item").each(function(){result=$(this);return $(this).offset().top-base+height>0});this.focus(event,result)}else{this.focus(event,this.activeMenu.children(".ui-menu-item")[!this.active||this.first()?":last":":first"]())}},_hasScroll:function(){return this.element.height()<this.element[$.fn.prop?"prop":"attr"]("scrollHeight")},select:function(event){var ui={item:this.active};this.closeAll();this._trigger("select",event,ui)}})}(jQuery));(function($){$.widget("ui.menubar",{version:"1.9pre",options:{buttons:false,menuIcon:false,position:{my:"left top",at:"left bottom"}},_create:function(){var that=this;var items=this.items=this.element.children("li").addClass("ui-menubar-item").attr("role","presentation").children("button, a");items.slice(1).attr("tabIndex",-1);this.element.addClass("ui-menubar ui-widget-header ui-helper-clearfix").attr("role","menubar");this._focusable(items);this._hoverable(items);items.next("ul").menu({position:{within:this.options.position.within},select:function(event,ui){ui.item.parents("ul.ui-menu:last").hide();that._trigger("select",event,ui);that._close();$(event.target).prev().focus()}}).hide().attr("aria-hidden","true").attr("aria-expanded","false").bind("keydown.menubar",function(event){var menu=$(this);if(menu.is(":hidden")){return}switch(event.keyCode){case $.ui.keyCode.LEFT:that._left(event);event.preventDefault();break;case $.ui.keyCode.RIGHT:that._right(event);event.preventDefault();break}});items.each(function(){var input=$(this),menu=input.next("ul");input.bind("click.menubar focus.menubar mouseenter.menubar",function(event){if(event.type=="focus"&&!event.originalEvent){return}event.preventDefault();if(event.type=="click"&&menu.is(":visible")&&that.active&&that.active[0]==menu[0]){that._close();return}if((that.open&&event.type=="mouseenter")||event.type=="click"){that._open(event,menu)}}).bind("keydown",function(event){switch(event.keyCode){case $.ui.keyCode.SPACE:case $.ui.keyCode.UP:case $.ui.keyCode.DOWN:that._open(event,$(this).next());event.preventDefault();break;case $.ui.keyCode.LEFT:that._prev(event,$(this));event.preventDefault();break;case $.ui.keyCode.RIGHT:that._next(event,$(this));event.preventDefault();break}}).addClass("ui-button ui-widget ui-button-text-only ui-menubar-link").attr("role","menuitem").attr("aria-haspopup","true").wrapInner("<span class='ui-button-text'></span>");if(that.options.menuIcon){input.addClass("ui-state-default").append("<span class='ui-button-icon-secondary ui-icon ui-icon-triangle-1-s'></span>");input.removeClass("ui-button-text-only").addClass("ui-button-text-icon-secondary")}if(!that.options.buttons){input.addClass("ui-menubar-link").removeClass("ui-state-default")}});that._bind({keydown:function(event){if(event.keyCode==$.ui.keyCode.ESCAPE&&that.active&&that.active.menu("left",event)!==true){var active=that.active;that.active.blur();that._close(event);active.prev().focus()}},focusin:function(event){clearTimeout(that.closeTimer)},focusout:function(event){that.closeTimer=setTimeout(function(){that._close(event)},100)}})},_destroy:function(){var items=this.element.children("li").removeClass("ui-menubar-item").removeAttr("role","presentation").children("button, a");this.element.removeClass("ui-menubar ui-widget-header ui-helper-clearfix").removeAttr("role","menubar").unbind(".menubar");items.unbind(".menubar").removeClass("ui-button ui-widget ui-button-text-only ui-menubar-link ui-state-default").removeAttr("role","menuitem").removeAttr("aria-haspopup","true").children("span.ui-button-text").each(function(i,e){var item=$(this);item.parent().html(item.html())}).end().children(".ui-icon").remove();this.element.find(":ui-menu").menu("destroy").show().removeAttr("aria-hidden","true").removeAttr("aria-expanded","false").removeAttr("tabindex").unbind(".menubar")},_close:function(){if(!this.active||!this.active.length){return}this.active.menu("closeAll").hide().attr("aria-hidden","true").attr("aria-expanded","false");this.active.prev().removeClass("ui-state-active").removeAttr("tabIndex");this.active=null;this.open=false},_open:function(event,menu){if(this.active&&this.active[0]==menu[0]){return}if(this.active){this.active.menu("closeAll").hide().attr("aria-hidden","true").attr("aria-expanded","false");this.active.prev().removeClass("ui-state-active")}var button=menu.prev().addClass("ui-state-active").attr("tabIndex",-1);this.active=menu.show().position($.extend({of:button},this.options.position)).removeAttr("aria-hidden").attr("aria-expanded","true").menu("focus",event,menu.children("li").first()).focus().focusin();this.open=true},_prev:function(event,button){button.attr("tabIndex",-1);var prev=button.parent().prevAll("li").children(".ui-button").eq(0);if(prev.length){prev.removeAttr("tabIndex")[0].focus()}else{var lastItem=this.element.children("li:last").children(".ui-button:last");lastItem.removeAttr("tabIndex")[0].focus()}},_next:function(event,button){button.attr("tabIndex",-1);var next=button.parent().nextAll("li").children(".ui-button").eq(0);if(next.length){next.removeAttr("tabIndex")[0].focus()}else{var firstItem=this.element.children("li:first").children(".ui-button:first");firstItem.removeAttr("tabIndex")[0].focus()}},_left:function(event){var prev=this.active.parent().prevAll("li:eq(0)").children(".ui-menu").eq(0);if(prev.length){this._open(event,prev)}else{var lastItem=this.element.children("li:last").children(".ui-menu:first");this._open(event,lastItem)}},_right:function(event){var next=this.active.parent().nextAll("li:eq(0)").children(".ui-menu").eq(0);if(next.length){this._open(event,next)}else{var firstItem=this.element.children("li:first").children(".ui-menu:first");this._open(event,firstItem)}}})}(jQuery));(function($){var idIncrement=0;$.widget("ui.popup",{version:"1.9pre",options:{position:{my:"left top",at:"left bottom"}},_create:function(){if(!this.options.trigger){this.options.trigger=this.element.prev()}if(!this.element.attr("id")){this.element.attr("id","ui-popup-"+idIncrement++);this.generatedId=true}if(!this.element.attr("role")){this.element.attr("role","dialog");this.generatedRole=true}this.options.trigger.attr("aria-haspopup",true).attr("aria-owns",this.element.attr("id"));this.element.addClass("ui-popup");this.close();this._bind(this.options.trigger,{keydown:function(event){if(this.options.trigger.is("a:ui-button")&&event.keyCode==$.ui.keyCode.SPACE){event.preventDefault()}if(event.keyCode==$.ui.keyCode.SPACE&&this.options.trigger.is("a:not(:ui-button)")){this.options.trigger.trigger("click",event)}if(event.keyCode==$.ui.keyCode.DOWN){event.preventDefault();this.options.trigger.trigger("click",event)}},click:function(event){event.preventDefault();if(this.isOpen){return}var that=this;clearTimeout(this.closeTimer);setTimeout(function(){that.open(event)},1)}});if(!this.element.is(":ui-menu")){this._bind({keydown:function(event){if(event.keyCode!==$.ui.keyCode.TAB){return}var tabbables=$(":tabbable",this.element),first=tabbables.first(),last=tabbables.last();if(event.target===last[0]&&!event.shiftKey){first.focus(1);event.preventDefault()}else{if(event.target===first[0]&&event.shiftKey){last.focus(1);event.preventDefault()}}}})}this._bind({focusout:function(event){var that=this;that.closeTimer=setTimeout(function(){that.close(event)},100)},focusin:function(event){clearTimeout(this.closeTimer)}});this._bind({keyup:function(event){if(event.keyCode==$.ui.keyCode.ESCAPE&&this.element.is(":visible")){this.close(event);this.options.trigger.focus()}}});this._bind(document,{click:function(event){if(this.isOpen&&!$(event.target).closest(".ui-popup").length){this.close(event)}}})},_destroy:function(){this.element.show().removeClass("ui-popup").removeAttr("aria-hidden").removeAttr("aria-expanded").unbind("keypress.ui-popup");this.options.trigger.removeAttr("aria-haspopup").removeAttr("aria-owns");if(this.generatedId){this.element.removeAttr("id")}if(this.generatedRole){this.element.removeAttr("role")}},open:function(event){var position=$.extend({},{of:this.options.trigger},this.options.position);this.element.show().attr("aria-hidden",false).attr("aria-expanded",true).position(position);if(this.element.is(":ui-menu")){this.element.menu("focus",event,this.element.children("li").first());this.element.focus()}else{var tabbables=this.element.find(":tabbable");this.removeTabIndex=false;if(!tabbables.length){if(!this.element.is(":tabbable")){this.element.attr("tabindex","0");this.removeTabIndex=true}tabbables=tabbables.add(this.element[0])}tabbables.first().focus(1)}this.options.trigger.attr("tabindex",-1);this.isOpen=true;this._trigger("open",event)},close:function(event){this.element.hide().attr("aria-hidden",true).attr("aria-expanded",false);this.options.trigger.attr("tabindex",0);if(this.removeTabIndex){this.element.removeAttr("tabindex")}this.isOpen=false;this._trigger("close",event)}})}(jQuery));(function($,undefined){$.ui=$.ui||{};var rhorizontal=/left|center|right/,rvertical=/top|center|bottom/,roffset=/[+-]\d+%?/,rposition=/^\w+/,rpercent=/%$/,center="center",_position=$.fn.position;$.position={scrollbarWidth:function(){var w1,w2,div=$("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),innerDiv=div.children()[0];$("body").append(div);w1=innerDiv.offsetWidth;div.css("overflow","scroll");w2=innerDiv.offsetWidth;if(w1===w2){w2=div[0].clientWidth}div.remove();return w1-w2},getScrollInfo:function(within){var that=within[0],scrollHeight=within.height()<that.scrollHeight,scrollWidth=within.width()<that.scrollWidth,scrollbarWidth=$.position.scrollbarWidth();return{height:scrollHeight?scrollbarWidth:0,width:scrollWidth?scrollbarWidth:0}}};$.fn.position=function(options){if(!options||!options.of){return _position.apply(this,arguments)}options=$.extend({},options);var target=$(options.of),within=$(options.within||window),targetElem=target[0],collision=(options.collision||"flip").split(" "),offsets={},atOffset,targetWidth,targetHeight,basePosition;if(targetElem.nodeType===9){targetWidth=target.width();targetHeight=target.height();basePosition={top:0,left:0}}else{if($.isWindow(targetElem)){targetWidth=target.width();targetHeight=target.height();basePosition={top:target.scrollTop(),left:target.scrollLeft()}}else{if(targetElem.preventDefault){options.at="left top";targetWidth=targetHeight=0;basePosition={top:options.of.pageY,left:options.of.pageX}}else{targetWidth=target.outerWidth();targetHeight=target.outerHeight();basePosition=target.offset()}}}$.each(["my","at"],function(){var pos=(options[this]||"").split(" "),horizontalOffset,verticalOffset;if(pos.length===1){pos=rhorizontal.test(pos[0])?pos.concat([center]):rvertical.test(pos[0])?[center].concat(pos):[center,center]}pos[0]=rhorizontal.test(pos[0])?pos[0]:center;pos[1]=rvertical.test(pos[1])?pos[1]:center;horizontalOffset=roffset.exec(pos[0]);verticalOffset=roffset.exec(pos[1]);offsets[this]=[horizontalOffset?horizontalOffset[0]:0,verticalOffset?verticalOffset[0]:0];options[this]=[rposition.exec(pos[0])[0],rposition.exec(pos[1])[0]]});if(collision.length===1){collision[1]=collision[0]}if(options.at[0]==="right"){basePosition.left+=targetWidth}else{if(options.at[0]===center){basePosition.left+=targetWidth/2}}if(options.at[1]==="bottom"){basePosition.top+=targetHeight}else{if(options.at[1]===center){basePosition.top+=targetHeight/2}}atOffset=[parseInt(offsets.at[0],10)*(rpercent.test(offsets.at[0])?targetWidth/100:1),parseInt(offsets.at[1],10)*(rpercent.test(offsets.at[1])?targetHeight/100:1)];basePosition.left+=atOffset[0];basePosition.top+=atOffset[1];return this.each(function(){var elem=$(this),elemWidth=elem.outerWidth(),elemHeight=elem.outerHeight(),marginLeft=parseInt($.curCSS(this,"marginLeft",true))||0,marginTop=parseInt($.curCSS(this,"marginTop",true))||0,scrollInfo=$.position.getScrollInfo(within),collisionWidth=elemWidth+marginLeft+(parseInt($.curCSS(this,"marginRight",true))||0)+scrollInfo.width,collisionHeight=elemHeight+marginTop+(parseInt($.curCSS(this,"marginBottom",true))||0)+scrollInfo.height,position=$.extend({},basePosition),myOffset=[parseInt(offsets.my[0],10)*(rpercent.test(offsets.my[0])?elem.outerWidth()/100:1),parseInt(offsets.my[1],10)*(rpercent.test(offsets.my[1])?elem.outerHeight()/100:1)],collisionPosition;if(options.my[0]==="right"){position.left-=elemWidth}else{if(options.my[0]===center){position.left-=elemWidth/2}}if(options.my[1]==="bottom"){position.top-=elemHeight}else{if(options.my[1]===center){position.top-=elemHeight/2}}position.left+=myOffset[0];position.top+=myOffset[1];position.left=Math.round(position.left);position.top=Math.round(position.top);collisionPosition={left:position.left-marginLeft,top:position.top-marginTop};$.each(["left","top"],function(i,dir){if($.ui.position[collision[i]]){$.ui.position[collision[i]][dir](position,{targetWidth:targetWidth,targetHeight:targetHeight,elemWidth:elemWidth,elemHeight:elemHeight,collisionPosition:collisionPosition,collisionWidth:collisionWidth,collisionHeight:collisionHeight,offset:[atOffset[0]+myOffset[0],atOffset[1]+myOffset[1]],my:options.my,at:options.at,within:within})}});if($.fn.bgiframe){elem.bgiframe()}elem.offset($.extend(position,{using:options.using}))})};$.ui.position={fit:{left:function(position,data){var within=data.within,win=$(window),isWindow=$.isWindow(data.within[0]),withinOffset=isWindow?win.scrollLeft():within.offset().left,outerWidth=isWindow?win.width():within.outerWidth(),overLeft=withinOffset-data.collisionPosition.left,overRight=data.collisionPosition.left+data.collisionWidth-outerWidth-withinOffset;if(data.collisionWidth>outerWidth||overLeft>0){position.left+=overLeft}else{if(overRight>0){position.left-=overRight}else{position.left=Math.max(position.left-data.collisionPosition.left,position.left)}}},top:function(position,data){var within=data.within,win=$(window),isWindow=$.isWindow(data.within[0]),withinOffset=isWindow?win.scrollTop():within.offset().top,outerHeight=isWindow?win.height():within.outerHeight(),overTop=withinOffset-data.collisionPosition.top,overBottom=data.collisionPosition.top+data.collisionHeight-outerHeight-withinOffset;if(data.collisionHeight>outerHeight||overTop>0){position.top+=overTop}else{if(overBottom>0){position.top-=overBottom}else{position.top=Math.max(position.top-data.collisionPosition.top,position.top)}}}},flip:{left:function(position,data){if(data.at[0]===center){return}var within=data.within,win=$(window),isWindow=$.isWindow(data.within[0]),withinOffset=isWindow?0:within.offset().left,outerWidth=isWindow?within.width():within.outerWidth(),overLeft=data.collisionPosition.left-withinOffset,overRight=data.collisionPosition.left+data.collisionWidth-outerWidth-withinOffset,left=data.my[0]==="left",myOffset=data.my[0]==="left"?-data.elemWidth:data.my[0]==="right"?data.elemWidth:0,atOffset=data.at[0]==="left"?data.targetWidth:-data.targetWidth,offset=-2*data.offset[0];if(overLeft<0||overRight>0){position.left+=myOffset+atOffset+offset}},top:function(position,data){if(data.at[1]===center){return}var within=data.within,win=$(window),isWindow=$.isWindow(data.within[0]),withinOffset=isWindow?0:within.offset().top,outerHeight=isWindow?within.height():within.outerHeight(),overTop=data.collisionPosition.top-withinOffset,overBottom=data.collisionPosition.top+data.collisionHeight-outerHeight-withinOffset,top=data.my[1]==="top",myOffset=top?-data.elemHeight:data.my[1]==="bottom"?data.elemHeight:0,atOffset=data.at[1]==="top"?data.targetHeight:-data.targetHeight,offset=-2*data.offset[1];if(overTop<0||overBottom>0){position.top+=myOffset+atOffset+offset}}}};if($.uiBackCompat!==false){(function($){var _position=$.fn.position;$.fn.position=function(options){if(!options||!options.offset){return _position.call(this,options)}var offset=options.offset.split(" "),at=options.at.split(" ");if(offset.length===1){offset[1]=offset[0]}if(/^\d/.test(offset[0])){offset[0]="+"+offset[0]}if(/^\d/.test(offset[1])){offset[1]="+"+offset[1]}if(at.length===1){if(/left|center|right/.test(at[0])){at[1]="center"}else{at[1]=at[0];at[0]="center"}}return _position.call(this,$.extend(options,{at:at[0]+offset[0]+" "+at[1]+offset[1],offset:undefined}))}}(jQuery))}}(jQuery));(function($,undefined){$.widget("ui.progressbar",{version:"1.9pre",options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()});this.valueDiv=$("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this.oldValue=this._value();this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.valueDiv.remove()},value:function(newValue){if(newValue===undefined){return this._value()}this._setOption("value",newValue);return this},_setOption:function(key,value){if(key==="value"){this.options.value=value;this._refreshValue();if(this._value()===this.options.max){this._trigger("complete")}}this._super("_setOption",key,value)},_value:function(){var val=this.options.value;if(typeof val!=="number"){val=0}return Math.min(this.options.max,Math.max(this.min,val))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var value=this.value();var percentage=this._percentage();if(this.oldValue!==value){this.oldValue=value;this._trigger("change")}this.valueDiv.toggle(value>this.min).toggleClass("ui-corner-right",value===this.options.max).width(percentage.toFixed(0)+"%");this.element.attr("aria-valuenow",value)}})})(jQuery);(function($,undefined){var numPages=5;$.widget("ui.slider",$.ui.mouse,{version:"1.9pre",widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null},_create:function(){var self=this,o=this.options,existingHandles=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),handle="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",handleCount=(o.values&&o.values.length)||1,handles=[];this._keySliding=false;this._mouseSliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(o.disabled?" ui-slider-disabled ui-disabled":""));this.range=$([]);if(o.range){if(o.range===true){if(!o.values){o.values=[this._valueMin(),this._valueMin()]}if(o.values.length&&o.values.length!==2){o.values=[o.values[0],o.values[0]]}}this.range=$("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+((o.range==="min"||o.range==="max")?" ui-slider-range-"+o.range:""))}for(var i=existingHandles.length;i<handleCount;i+=1){handles.push(handle)}this.handles=existingHandles.add($(handles.join("")).appendTo(self.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(event){event.preventDefault()}).hover(function(){if(!o.disabled){$(this).addClass("ui-state-hover")}},function(){$(this).removeClass("ui-state-hover")}).focus(function(){if(!o.disabled){$(".ui-slider .ui-state-focus").removeClass("ui-state-focus");$(this).addClass("ui-state-focus")}else{$(this).blur()}}).blur(function(){$(this).removeClass("ui-state-focus")});this.handles.each(function(i){$(this).data("index.ui-slider-handle",i)});this.handles.keydown(function(event){var ret=true,index=$(this).data("index.ui-slider-handle"),allowed,curVal,newVal,step;if(self.options.disabled){return}switch(event.keyCode){case $.ui.keyCode.HOME:case $.ui.keyCode.END:case $.ui.keyCode.PAGE_UP:case $.ui.keyCode.PAGE_DOWN:case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:ret=false;if(!self._keySliding){self._keySliding=true;$(this).addClass("ui-state-active");allowed=self._start(event,index);if(allowed===false){return}}break}step=self.options.step;if(self.options.values&&self.options.values.length){curVal=newVal=self.values(index)}else{curVal=newVal=self.value()}switch(event.keyCode){case $.ui.keyCode.HOME:newVal=self._valueMin();break;case $.ui.keyCode.END:newVal=self._valueMax();break;case $.ui.keyCode.PAGE_UP:newVal=self._trimAlignValue(curVal+((self._valueMax()-self._valueMin())/numPages));break;case $.ui.keyCode.PAGE_DOWN:newVal=self._trimAlignValue(curVal-((self._valueMax()-self._valueMin())/numPages));break;case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:if(curVal===self._valueMax()){return}newVal=self._trimAlignValue(curVal+step);break;case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(curVal===self._valueMin()){return}newVal=self._trimAlignValue(curVal-step);break}self._slide(event,index,newVal);return ret}).keyup(function(event){var index=$(this).data("index.ui-slider-handle");if(self._keySliding){self._keySliding=false;self._stop(event,index);self._change(event,index);$(this).removeClass("ui-state-active")}});this._refreshValue();this._animateOff=false},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");this._mouseDestroy();return this},_mouseCapture:function(event){var o=this.options,position,normValue,distance,closestHandle,self,index,allowed,offset,mouseOverHandle;if(o.disabled){return false}this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();position={x:event.pageX,y:event.pageY};normValue=this._normValueFromMouse(position);distance=this._valueMax()-this._valueMin()+1;self=this;this.handles.each(function(i){var thisDistance=Math.abs(normValue-self.values(i));if(distance>thisDistance){distance=thisDistance;closestHandle=$(this);index=i}});if(o.range===true&&this.values(1)===o.min){index+=1;closestHandle=$(this.handles[index])}allowed=this._start(event,index);if(allowed===false){return false}this._mouseSliding=true;self._handleIndex=index;closestHandle.addClass("ui-state-active").focus();offset=closestHandle.offset();mouseOverHandle=!$(event.target).parents().andSelf().is(".ui-slider-handle");this._clickOffset=mouseOverHandle?{left:0,top:0}:{left:event.pageX-offset.left-(closestHandle.width()/2),top:event.pageY-offset.top-(closestHandle.height()/2)-(parseInt(closestHandle.css("borderTopWidth"),10)||0)-(parseInt(closestHandle.css("borderBottomWidth"),10)||0)+(parseInt(closestHandle.css("marginTop"),10)||0)};if(!this.handles.hasClass("ui-state-hover")){this._slide(event,index,normValue)}this._animateOff=true;return true},_mouseStart:function(event){return true},_mouseDrag:function(event){var position={x:event.pageX,y:event.pageY},normValue=this._normValueFromMouse(position);this._slide(event,this._handleIndex,normValue);return false},_mouseStop:function(event){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(event,this._handleIndex);this._change(event,this._handleIndex);this._handleIndex=null;this._clickOffset=null;this._animateOff=false;return false},_detectOrientation:function(){this.orientation=(this.options.orientation==="vertical")?"vertical":"horizontal"},_normValueFromMouse:function(position){var pixelTotal,pixelMouse,percentMouse,valueTotal,valueMouse;if(this.orientation==="horizontal"){pixelTotal=this.elementSize.width;pixelMouse=position.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{pixelTotal=this.elementSize.height;pixelMouse=position.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}percentMouse=(pixelMouse/pixelTotal);if(percentMouse>1){percentMouse=1}if(percentMouse<0){percentMouse=0}if(this.orientation==="vertical"){percentMouse=1-percentMouse}valueTotal=this._valueMax()-this._valueMin();valueMouse=this._valueMin()+percentMouse*valueTotal;return this._trimAlignValue(valueMouse)},_start:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};if(this.options.values&&this.options.values.length){uiHash.value=this.values(index);uiHash.values=this.values()}return this._trigger("start",event,uiHash)},_slide:function(event,index,newVal){var otherVal,newValues,allowed;if(this.options.values&&this.options.values.length){otherVal=this.values(index?0:1);if((this.options.values.length===2&&this.options.range===true)&&((index===0&&newVal>otherVal)||(index===1&&newVal<otherVal))){newVal=otherVal}if(newVal!==this.values(index)){newValues=this.values();newValues[index]=newVal;allowed=this._trigger("slide",event,{handle:this.handles[index],value:newVal,values:newValues});otherVal=this.values(index?0:1);if(allowed!==false){this.values(index,newVal,true)}}}else{if(newVal!==this.value()){allowed=this._trigger("slide",event,{handle:this.handles[index],value:newVal});if(allowed!==false){this.value(newVal)}}}},_stop:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};if(this.options.values&&this.options.values.length){uiHash.value=this.values(index);uiHash.values=this.values()}this._trigger("stop",event,uiHash)},_change:function(event,index){if(!this._keySliding&&!this._mouseSliding){var uiHash={handle:this.handles[index],value:this.value()};if(this.options.values&&this.options.values.length){uiHash.value=this.values(index);uiHash.values=this.values()}this._trigger("change",event,uiHash)}},value:function(newValue){if(arguments.length){this.options.value=this._trimAlignValue(newValue);this._refreshValue();this._change(null,0);return}return this._value()},values:function(index,newValue){var vals,newValues,i;if(arguments.length>1){this.options.values[index]=this._trimAlignValue(newValue);this._refreshValue();this._change(null,index);return}if(arguments.length){if($.isArray(arguments[0])){vals=this.options.values;newValues=arguments[0];for(i=0;i<vals.length;i+=1){vals[i]=this._trimAlignValue(newValues[i]);this._change(null,i)}this._refreshValue()}else{if(this.options.values&&this.options.values.length){return this._values(index)}else{return this.value()}}}else{return this._values()}},_setOption:function(key,value){var i,valsLength=0;if($.isArray(this.options.values)){valsLength=this.options.values.length}$.Widget.prototype._setOption.apply(this,arguments);switch(key){case"disabled":if(value){this.handles.filter(".ui-state-focus").blur();this.handles.removeClass("ui-state-hover");this.handles.attr("disabled","disabled");this.element.addClass("ui-disabled")}else{this.handles.removeAttr("disabled");this.element.removeClass("ui-disabled")}break;case"orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case"value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case"values":this._animateOff=true;this._refreshValue();for(i=0;i<valsLength;i+=1){this._change(null,i)}this._animateOff=false;break}},_value:function(){var val=this.options.value;val=this._trimAlignValue(val);return val},_values:function(index){var val,vals,i;if(arguments.length){val=this.options.values[index];val=this._trimAlignValue(val);return val}else{vals=this.options.values.slice();for(i=0;i<vals.length;i+=1){vals[i]=this._trimAlignValue(vals[i])}return vals}},_trimAlignValue:function(val){if(val<=this._valueMin()){return this._valueMin()}if(val>=this._valueMax()){return this._valueMax()}var step=(this.options.step>0)?this.options.step:1,valModStep=(val-this._valueMin())%step,alignValue=val-valModStep;if(Math.abs(valModStep)*2>=step){alignValue+=(valModStep>0)?step:(-step)}return parseFloat(alignValue.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var oRange=this.options.range,o=this.options,self=this,animate=(!this._animateOff)?o.animate:false,valPercent,_set={},lastValPercent,value,valueMin,valueMax;if(this.options.values&&this.options.values.length){this.handles.each(function(i,j){valPercent=(self.values(i)-self._valueMin())/(self._valueMax()-self._valueMin())*100;_set[self.orientation==="horizontal"?"left":"bottom"]=valPercent+"%";$(this).stop(1,1)[animate?"animate":"css"](_set,o.animate);if(self.options.range===true){if(self.orientation==="horizontal"){if(i===0){self.range.stop(1,1)[animate?"animate":"css"]({left:valPercent+"%"},o.animate)}if(i===1){self.range[animate?"animate":"css"]({width:(valPercent-lastValPercent)+"%"},{queue:false,duration:o.animate})}}else{if(i===0){self.range.stop(1,1)[animate?"animate":"css"]({bottom:(valPercent)+"%"},o.animate)}if(i===1){self.range[animate?"animate":"css"]({height:(valPercent-lastValPercent)+"%"},{queue:false,duration:o.animate})}}}lastValPercent=valPercent})}else{value=this.value();valueMin=this._valueMin();valueMax=this._valueMax();valPercent=(valueMax!==valueMin)?(value-valueMin)/(valueMax-valueMin)*100:0;_set[self.orientation==="horizontal"?"left":"bottom"]=valPercent+"%";this.handle.stop(1,1)[animate?"animate":"css"](_set,o.animate);if(oRange==="min"&&this.orientation==="horizontal"){this.range.stop(1,1)[animate?"animate":"css"]({width:valPercent+"%"},o.animate)}if(oRange==="max"&&this.orientation==="horizontal"){this.range[animate?"animate":"css"]({width:(100-valPercent)+"%"},{queue:false,duration:o.animate})}if(oRange==="min"&&this.orientation==="vertical"){this.range.stop(1,1)[animate?"animate":"css"]({height:valPercent+"%"},o.animate)}if(oRange==="max"&&this.orientation==="vertical"){this.range[animate?"animate":"css"]({height:(100-valPercent)+"%"},{queue:false,duration:o.animate})}}}})}(jQuery));(function($){$.widget("ui.spinner",{version:"1.9pre",defaultElement:"<input>",widgetEventPrefix:"spin",options:{incremental:true,max:null,min:null,numberFormat:null,page:10,step:null,value:null},_create:function(){this._draw();this._markupOptions();this._mousewheel();this._aria()},_markupOptions:function(){var that=this;$.each({min:-Number.MAX_VALUE,max:Number.MAX_VALUE,step:1},function(attr,defaultValue){if(that.options[attr]===null){var value=that.element.attr(attr);that.options[attr]=typeof value==="string"&&value.length>0?that._parse(value):defaultValue}});this.value(this.options.value!==null?this.options.value:this.element.val()||0)},_draw:function(){var self=this,options=self.options;var uiSpinner=this.uiSpinner=self.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(self._uiSpinnerHtml()).parent().append(self._buttonHtml()).disableSelection().hover(function(){if(!options.disabled){$(this).addClass("ui-state-hover")}self.hovered=true},function(){$(this).removeClass("ui-state-hover");self.hovered=false});this.element.attr("role","spinbutton").bind("keydown.spinner",function(event){if(options.disabled){return}if(self._start(event)){return self._keydown(event)}return true}).bind("keyup.spinner",function(event){if(options.disabled){return}if(self.spinning){self._stop(event);self._change(event)}}).bind("focus.spinner",function(){uiSpinner.addClass("ui-state-active");self.focused=true}).bind("blur.spinner",function(event){self.value(self.element.val());if(!self.hovered){uiSpinner.removeClass("ui-state-active")}self.focused=false});this.buttons=uiSpinner.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all").bind("mousedown",function(event){if(options.disabled){return}if(self._start(event)===false){return false}self._repeat(null,$(this).hasClass("ui-spinner-up")?1:-1,event)}).bind("mouseup",function(event){if(options.disabled){return}if(self.spinning){self._stop(event);self._change(event)}}).bind("mouseenter",function(){if(self.options.disabled){return}if($(this).hasClass("ui-state-active")){if(self._start(event)===false){return false}self._repeat(null,$(this).hasClass("ui-spinner-up")?1:-1,event)}}).bind("mouseleave",function(){if(self.spinning){self._stop(event);self._change(event)}});if(options.disabled){this.disable()}},_keydown:function(event){var options=this.options,keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.UP:this._repeat(null,1,event);return false;case keyCode.DOWN:this._repeat(null,-1,event);return false;case keyCode.PAGE_UP:this._repeat(null,options.page,event);return false;case keyCode.PAGE_DOWN:this._repeat(null,-options.page,event);return false;case keyCode.ENTER:this.value(this.element.val())}return true},_mousewheel:function(){if(!$.fn.mousewheel){return}var self=this;this.element.bind("mousewheel.spinner",function(event,delta){if(self.options.disabled||!delta){return}if(!self.spinning&&!self._start(event)){return false}self._spin((delta>0?1:-1)*self.options.step,event);clearTimeout(self.timeout);self.timeout=setTimeout(function(){if(self.spinning){self._stop(event);self._change(event)}},100);event.preventDefault()})},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-state-default ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon ui-icon-triangle-1-n'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon ui-icon-triangle-1-s'>&#9660;</span></a>"},_start:function(event){if(!this.spinning&&this._trigger("start",event)===false){return false}if(!this.counter){this.counter=1}this.spinning=true;return true},_repeat:function(i,steps,event){var self=this;i=i||500;clearTimeout(this.timer);this.timer=setTimeout(function(){self._repeat(40,steps,event)},i);self._spin(steps*self.options.step,event)},_spin:function(step,event){if(!this.counter){this.counter=1}var newVal=this.value()+step*(this.options.incremental&&this.counter>20?this.counter>100?this.counter>200?100:10:2:1);newVal=this._trimValue(newVal);if(this._trigger("spin",event,{value:newVal})!==false){this.value(newVal);this.counter++}},_trimValue:function(value){var options=this.options;if(value>options.max){return options.max}if(value<options.min){return options.min}return value},_stop:function(event){this.counter=0;if(this.timer){clearTimeout(this.timer)}this.element.focus();this.spinning=false;this._trigger("stop",event)},_change:function(event){this._trigger("change",event)},_setOption:function(key,value){if(key==="value"){value=this._trimValue(this._parse(value))}if(key==="disabled"){if(value){this.element.attr("disabled",true);this.buttons.button("disable")}else{this.element.removeAttr("disabled");this.buttons.button("enable")}}this._super("_setOption",key,value)},_setOptions:function(options){this._super("_setOptions",options);if("value" in options){this._format(this.options.value)}this._aria()},_aria:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this.options.value})},_parse:function(val){if(typeof val==="string"){val=$.global&&this.options.numberFormat?$.global.parseFloat(val):+val}return isNaN(val)?null:val},_format:function(num){this.element.val($.global&&this.options.numberFormat?$.global.format(num,this.options.numberFormat):num)},destroy:function(){this.element.removeClass("ui-spinner-input").removeAttr("disabled").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this._super("destroy");this.uiSpinner.replaceWith(this.element)},stepUp:function(steps){this._spin((steps||1)*this.options.step)},stepDown:function(steps){this._spin((steps||1)*-this.options.step)},pageUp:function(pages){this.stepUp((pages||1)*this.options.page)},pageDown:function(pages){this.stepDown((pages||1)*this.options.page)},value:function(newVal){if(!arguments.length){return this._parse(this.element.val())}this.option("value",newVal)},widget:function(){return this.uiSpinner}})}(jQuery));(function($,undefined){var tabId=0;function getNextTabId(){return ++tabId}$.widget("ui.tabs",{version:"1.9pre",options:{active:null,collapsible:false,event:"click",fx:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var that=this,options=that.options,active=options.active;that.running=false;that.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");that._processTabs();if(active===null){if(location.hash){that.anchors.each(function(i,tab){if(tab.hash===location.hash){active=i;return false}})}if(active===null){active=that.lis.filter(".ui-tabs-active").index()}if(active===null||active===-1){active=that.lis.length?0:false}}if(active!==false){active=this.lis.eq(active).index();if(active===-1){active=options.collapsible?false:0}}options.active=active;if(!options.collapsible&&options.active===false&&this.anchors.length){options.active=0}if($.isArray(options.disabled)){options.disabled=$.unique(options.disabled.concat($.map(this.lis.filter(".ui-state-disabled"),function(n,i){return that.lis.index(n)}))).sort()}this._setupFx(options.fx);this._refresh();this.panels.hide();this.lis.removeClass("ui-tabs-active ui-state-active");if(options.active!==false&&this.anchors.length){this.active=this._findActive(options.active);var panel=that._getPanelForTab(this.active);panel.show();this.lis.eq(options.active).addClass("ui-tabs-active ui-state-active");this.load(options.active)}else{this.active=$()}},_setOption:function(key,value){if(key=="active"){this._activate(value);return}if(key==="disabled"){this._setupDisabled(value);return}this._super("_setOption",key,value);if(key==="collapsible"&&!value&&this.options.active===false){this._activate(0)}if(key==="event"){this._setupEvents(value)}if(key==="fx"){this._setupFx(value)}},_tabId:function(a){return $(a).attr("aria-controls")||"ui-tabs-"+getNextTabId()},_sanitizeSelector:function(hash){return hash?hash.replace(/[!"$%&'()*+,.\/:;<=>?@[\]^`{|}~]/g,"\\$&"):""},refresh:function(){var self=this,options=this.options,lis=this.list.children(":has(a[href])");options.disabled=$.map(lis.filter(".ui-state-disabled"),function(tab){return lis.index(tab)});this._processTabs();this._refresh();this.panels.not(this._getPanelForTab(this.active)).hide();if(options.active===false||!this.anchors.length){options.active=false;this.active=$()}else{if(this.active.length&&!$.contains(this.list[0],this.active[0])){var next=options.active-1;this._activate(next>=0?next:0)}else{options.active=this.anchors.index(this.active)}}},_refresh:function(){var options=this.options;this.element.toggleClass("ui-tabs-collapsible",options.collapsible);this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.lis.addClass("ui-state-default ui-corner-top");this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom");this._setupDisabled(options.disabled);this._setupEvents(options.event);this.lis.unbind(".tabs");this._focusable(this.lis);this._hoverable(this.lis)},_processTabs:function(){var self=this,fragmentId=/^#.+/;this.list=this.element.find("ol,ul").eq(0);this.lis=$(" > li:has(a[href])",this.list);this.anchors=this.lis.map(function(){return $("a",this)[0]});this.panels=$([]);this.anchors.each(function(i,a){var href=$(a).attr("href"),hrefBase=href.split("#")[0],selector,panel,baseEl;if(hrefBase&&(hrefBase===location.toString().split("#")[0]||(baseEl=$("base")[0])&&hrefBase===baseEl.href)){href=a.hash;a.href=href}if(fragmentId.test(href)){selector=href;panel=self.element.find(self._sanitizeSelector(selector))}else{if(href&&href!=="#"){var id=self._tabId(a);selector="#"+id;panel=self.element.find(selector);if(!panel.length){panel=self._createPanel(id);panel.insertAfter(self.panels[i-1]||self.list)}}else{self.options.disabled.push(i)}}if(panel.length){self.panels=self.panels.add(panel)}$(a).attr("aria-controls",selector.substring(1))})},_createPanel:function(id){return $("<div></div>").attr("id",id).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("destroy.tabs",true)},_setupDisabled:function(disabled){if($.isArray(disabled)){if(!disabled.length){disabled=false}else{if(disabled.length===this.anchors.length){disabled=true}}}for(var i=0,li;(li=this.lis[i]);i++){$(li).toggleClass("ui-state-disabled",(disabled===true||$.inArray(i,disabled)!==-1))}this.options.disabled=disabled},_setupFx:function(fx){if(fx){if($.isArray(fx)){this.hideFx=fx[0];this.showFx=fx[1]}else{this.hideFx=this.showFx=fx}}},_resetStyle:function($el,fx){if(!$.support.opacity&&fx.opacity){$el[0].style.removeAttribute("filter")}},_setupEvents:function(event){this.anchors.unbind(".tabs");if(event){this.anchors.bind(event.split(" ").join(".tabs ")+".tabs",$.proxy(this,"_eventHandler"))}this.anchors.bind("click.tabs",function(event){event.preventDefault()})},_eventHandler:function(event){var that=this,options=that.options,active=that.active,clicked=$(event.currentTarget),clickedIsActive=clicked[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():that._getPanelForTab(clicked),toHide=!active.length?$():that._getPanelForTab(active),tab=clicked.closest("li"),eventData={oldTab:active,oldPanel:toHide,newTab:collapsing?$():clicked,newPanel:toShow};event.preventDefault();if(tab.hasClass("ui-state-disabled")||tab.hasClass("ui-tabs-loading")||that.running||(clickedIsActive&&!options.collapsible)||(that._trigger("beforeActivate",event,eventData)===false)){clicked[0].blur();return}options.active=collapsing?false:that.anchors.index(clicked);that.active=clickedIsActive?$():clicked;if(that.xhr){that.xhr.abort()}if(!toHide.length&&!toShow.length){throw"jQuery UI Tabs: Mismatching fragment identifier."}if(toShow.length){that.load(that.anchors.index(clicked),event);clicked[0].blur()}that._toggle(event,eventData)},_toggle:function(event,eventData){var that=this,options=that.options,toShow=eventData.newPanel,toHide=eventData.oldPanel;that.running=true;function complete(){that.running=false;that._trigger("activate",event,eventData)}function show(){eventData.newTab.closest("li").addClass("ui-tabs-active ui-state-active");if(toShow.length&&that.showFx){toShow.animate(that.showFx,that.showFx.duration||"normal",function(){that._resetStyle($(this),that.showFx);complete()})}else{toShow.show();complete()}}if(toHide.length&&that.hideFx){toHide.animate(that.hideFx,that.hideFx.duration||"normal",function(){eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");that._resetStyle($(this),that.hideFx);show()})}else{eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");toHide.hide();show()}},_activate:function(index){var active=this._findActive(index)[0];if(active===this.active[0]){return}active=active||this.active[0];this._eventHandler({target:active,currentTarget:active,preventDefault:$.noop})},_findActive:function(selector){return typeof selector==="number"?this.anchors.eq(selector):typeof selector==="string"?this.anchors.filter("[href$='"+selector+"']"):$()},_getIndex:function(index){if(typeof index=="string"){index=this.anchors.index(this.anchors.filter("[href$="+index+"]"))}return index},_destroy:function(){var o=this.options;if(this.xhr){this.xhr.abort()}this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible");this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.anchors.each(function(){var $this=$(this).unbind(".tabs");$.each(["href","load"],function(i,prefix){$this.removeData(prefix+".tabs")})});this.lis.unbind(".tabs").add(this.panels).each(function(){if($.data(this,"destroy.tabs")){$(this).remove()}else{$(this).removeClass(["ui-state-default","ui-corner-top","ui-tabs-active","ui-state-active","ui-state-disabled","ui-tabs-panel","ui-widget-content","ui-corner-bottom"].join(" "))}});return this},enable:function(index){var disabled=this.options.disabled;if(disabled===false){return}if(index===undefined){disabled=false}else{index=this._getIndex(index);if($.isArray(disabled)){disabled=$.map(disabled,function(num){return num!==index?num:null})}else{disabled=$.map(this.lis,function(li,num){return num!==index?num:null})}}this._setupDisabled(disabled)},disable:function(index){var disabled=this.options.disabled;if(disabled===true){return}if(index===undefined){disabled=true}else{index=this._getIndex(index);if($.inArray(index,disabled)!==-1){return}if($.isArray(disabled)){disabled=$.merge([index],disabled).sort()}else{disabled=[index]}}this._setupDisabled(disabled)},load:function(index,event){index=this._getIndex(index);var self=this,options=this.options,anchor=this.anchors.eq(index),panel=self._getPanelForTab(anchor),url=anchor.attr("href").replace(/#.*$/,""),eventData={tab:anchor,panel:panel};if(!url){return}this.xhr=$.ajax({url:url,beforeSend:function(jqXHR,settings){return self._trigger("beforeLoad",event,$.extend({jqXHR:jqXHR,ajaxSettings:settings},eventData))}});if(this.xhr){this.lis.eq(index).addClass("ui-tabs-loading");this.xhr.success(function(response){panel.html(response);self._trigger("load",event,eventData)}).complete(function(jqXHR,status){if(status==="abort"){self.panels.stop(false,true)}self.lis.eq(index).removeClass("ui-tabs-loading");if(jqXHR===self.xhr){delete self.xhr}})}return this},_getPanelForTab:function(tab){var id=$(tab).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+id))}});if($.uiBackCompat!==false){$.ui.tabs.prototype._ui=function(tab,panel){return{tab:tab,panel:panel,index:this.anchors.index(tab)}};(function($,prototype){prototype.url=function(index,url){this.anchors.eq(index).attr("href",url)}}(jQuery,jQuery.ui.tabs.prototype));(function($,prototype){$.extend(prototype.options,{ajaxOptions:null,cache:false});var _create=prototype._create,_setOption=prototype._setOption,_destroy=prototype._destroy,oldurl=prototype.url||$.noop;$.extend(prototype,{_create:function(){_create.call(this);var self=this;this.element.bind("tabsbeforeload.tabs",function(event,ui){if($.data(ui.tab[0],"cache.tabs")){event.preventDefault();return}$.extend(ui.ajaxSettings,self.options.ajaxOptions,{error:function(xhr,s,e){try{self.options.ajaxOptions.error(xhr,s,ui.tab.closest("li").index(),ui.tab[0])}catch(e){}}});ui.jqXHR.success(function(){if(self.options.cache){$.data(ui.tab[0],"cache.tabs",true)}})})},_setOption:function(key,value){if(key==="cache"&&value===false){this.anchors.removeData("cache.tabs")}_setOption.apply(this,arguments)},_destroy:function(){this.anchors.removeData("cache.tabs");_destroy.call(this)},url:function(index,url){this.anchors.eq(index).removeData("cache.tabs");oldurl.apply(this,arguments)}})}(jQuery,jQuery.ui.tabs.prototype));(function($,prototype){prototype.abort=function(){if(this.xhr){this.xhr.abort()}}}(jQuery,jQuery.ui.tabs.prototype));$.widget("ui.tabs",$.ui.tabs,{options:{spinner:"<em>Loading&#8230;</em>"},_create:function(){this._super("_create");this._bind({tabsbeforeload:function(event,ui){if(!this.options.spinner){return}var span=ui.tab.find("span"),html=span.html();span.html(this.options.spinner);ui.jqXHR.complete(function(){span.html(html)})}})}});(function($,prototype){$.extend(prototype.options,{enable:null,disable:null});var enable=prototype.enable,disable=prototype.disable;prototype.enable=function(index){var options=this.options,trigger;if(index&&options.disabled===true||($.isArray(options.disabled)&&$.inArray(index,options.disabled)!==-1)){trigger=true}enable.apply(this,arguments);if(trigger){this._trigger("enable",null,this._ui(this.anchors[index],this.panels[index]))}};prototype.disable=function(index){var options=this.options,trigger;if(index&&options.disabled===false||($.isArray(options.disabled)&&$.inArray(index,options.disabled)===-1)){trigger=true}disable.apply(this,arguments);if(trigger){this._trigger("disable",null,this._ui(this.anchors[index],this.panels[index]))}}}(jQuery,jQuery.ui.tabs.prototype));(function($,prototype){$.extend(prototype.options,{add:null,remove:null,tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"});prototype.add=function(url,label,index){if(index===undefined){index=this.anchors.length}var options=this.options,li=$(options.tabTemplate.replace(/#\{href\}/g,url).replace(/#\{label\}/g,label)),id=!url.indexOf("#")?url.replace("#",""):this._tabId(li.find("a")[0]);li.addClass("ui-state-default ui-corner-top").data("destroy.tabs",true);li.find("a").attr("aria-controls",id);var doInsertAfter=index>=this.lis.length;var panel=this.element.find("#"+id);if(!panel.length){panel=this._createPanel(id);if(doInsertAfter){if(index>0){panel.insertAfter(this.panels.eq(-1))}else{panel.appendTo(this.element)}}else{panel.insertBefore(this.panels[index])}}panel.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").hide();if(doInsertAfter){li.appendTo(this.list)}else{li.insertBefore(this.lis[index])}options.disabled=$.map(options.disabled,function(n){return n>=index?++n:n});this.refresh();if(this.lis.length===1&&options.active===false){this.option("active",0)}this._trigger("add",null,this._ui(this.anchors[index],this.panels[index]));return this};prototype.remove=function(index){index=this._getIndex(index);var options=this.options,tab=this.lis.eq(index).remove(),panel=this.panels.eq(index).remove();if(tab.hasClass("ui-tabs-active")&&this.anchors.length>1){this._activate(index+(index+1<this.anchors.length?1:-1))}options.disabled=$.map($.grep(options.disabled,function(n){return n!==index}),function(n){return n>=index?--n:n});this.refresh();this._trigger("remove",null,this._ui(tab.find("a")[0],panel[0]));return this}}(jQuery,jQuery.ui.tabs.prototype));(function($,prototype){prototype.length=function(){return this.anchors.length}}(jQuery,jQuery.ui.tabs.prototype));(function($,prototype){$.extend(prototype.options,{idPrefix:"ui-tabs-"});var _tabId=prototype._tabId;prototype._tabId=function(a){return $(a).attr("aria-controls")||a.title&&a.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF-]/g,"")||this.options.idPrefix+getNextTabId()}}(jQuery,jQuery.ui.tabs.prototype));(function($,prototype){$.extend(prototype.options,{panelTemplate:"<div></div>"});var _createPanel=prototype._createPanel;prototype._createPanel=function(id){return $(this.options.panelTemplate).attr("id",id).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("destroy.tabs",true)}}(jQuery,jQuery.ui.tabs.prototype));(function($,prototype){var _create=prototype._create,_setOption=prototype._setOption,_eventHandler=prototype._eventHandler;prototype._create=function(){var options=this.options;if(options.active===null&&options.selected!==undefined){options.active=options.selected===-1?false:options.selected}_create.call(this);options.selected=options.active;if(options.selected===false){options.selected=-1}};prototype._setOption=function(key,value){if(key!=="selected"){return _setOption.apply(this,arguments)}var options=this.options;_setOption.call(this,"active",value===-1?false:value);options.selected=options.active;if(options.selected===false){options.selected=-1}};prototype._eventHandler=function(event){_eventHandler.apply(this,arguments);this.options.selected=this.options.active;if(this.options.selected===false){this.options.selected=-1}}}(jQuery,jQuery.ui.tabs.prototype));(function($,prototype){$.extend(prototype.options,{show:null,select:null});var _create=prototype._create,_trigger=prototype._trigger;prototype._create=function(){_create.call(this);if(this.options.active!==false){this._trigger("show",null,this._ui(this.active[0],this._getPanelForTab(this.active)[0]))}};prototype._trigger=function(type,event,data){var ret=_trigger.apply(this,arguments);if(!ret){return false}if(type==="beforeActivate"&&data.newTab.length){ret=_trigger.call(this,"select",event,{tab:data.newTab[0],panel:data.newPanel[0],index:data.newTab.closest("li").index()})}else{if(type==="activate"&&data.newTab.length){ret=_trigger.call(this,"show",event,{tab:data.newTab[0],panel:data.newPanel[0],index:data.newTab.closest("li").index()})}}}}(jQuery,jQuery.ui.tabs.prototype));(function($,prototype){prototype.select=function(index){index=this._getIndex(index);if(index===-1){if(this.options.collapsible&&this.options.selected!==-1){index=this.options.selected}else{return}}this.anchors.eq(index).trigger(this.options.event+".tabs")}}(jQuery,jQuery.ui.tabs.prototype));var listId=0;function getNextListId(){return ++listId}$.widget("ui.tabs",$.ui.tabs,{options:{cookie:null},_create:function(){var options=this.options,active;if(options.active==null&&options.cookie){active=parseInt(this._cookie(),10);if(active===-1){active=false}options.active=active}this._super("_create")},_cookie:function(active){var cookie=[this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+getNextListId())];if(arguments.length){cookie.push(active===false?-1:active);cookie.push(this.options.cookie)}return $.cookie.apply(null,cookie)},_refresh:function(){this._super("_refresh");if(this.options.cookie){this._cookie(this.options.active,this.options.cookie)}},_eventHandler:function(event){this._superApply("_eventHandler",arguments);if(this.options.cookie){this._cookie(this.options.active,this.options.cookie)}},_destroy:function(){this._super("_destroy");if(this.options.cookie){this._cookie(null,this.options.cookie)}}});$.widget("ui.tabs",$.ui.tabs,{_trigger:function(type,event,data){var _data=$.extend({},data);if(type==="load"){_data.panel=_data.panel[0];_data.tab=_data.tab[0]}return this._super("_trigger",type,event,_data)}})}})(jQuery);(function($){var increments=0;$.widget("ui.tooltip",{version:"1.9pre",options:{content:function(){return $(this).attr("title")},hide:true,items:"[title]",position:{my:"left+15 center",at:"right center",collision:"flip fit"},show:true,tooltipClass:null,close:null,open:null},_create:function(){this._bind({mouseover:"open",focusin:"open"});this.tooltips={}},_setOption:function(key,value){if(key==="disabled"){this[value?"_disable":"_enable"]();this.options[key]=value;return}this._super("_setOption",key,value)},_disable:function(){var that=this;$.each(this.tooltips,function(id,element){var event=$.Event("blur");event.target=event.currentTarget=element[0];that.close(event,true)});this.element.find(this.options.items).andSelf().each(function(){var element=$(this);if(element.is("[title]")){element.data("tooltip-title",element.attr("title")).attr("title","")}})},_enable:function(){this.element.find(this.options.items).andSelf().each(function(){var element=$(this);if(element.data("tooltip-title")){element.attr("title",element.data("tooltip-title"))}})},open:function(event){var content,that=this,target=$(event?event.target:this.element).closest(this.options.items);if(!target.length||target.attr("aria-describedby")){return}if(!target.data("tooltip-title")){target.data("tooltip-title",target.attr("title"))}content=this.options.content.call(target[0],function(response){setTimeout(function(){that._open(event,target,response)},1)});if(content){that._open(event,target,content)}},_open:function(event,target,content){if(!content){return}if(target.is("[title]")){target.attr("title","")}var tooltip=this._find(target);if(!tooltip.length){tooltip=this._tooltip(target);target.attr("aria-describedby",tooltip.attr("id"))}tooltip.find(".ui-tooltip-content").html(content);tooltip.stop(true).position($.extend({of:target},this.options.position)).hide();this._show(tooltip,this.options.show);this._trigger("open",event,{tooltip:tooltip});this._bind(target,{mouseleave:"close",blur:"close"})},close:function(event,force){var that=this,target=$(event?event.currentTarget:this.element),tooltip=this._find(target);if(!force&&document.activeElement===target[0]){return}if(target.data("tooltip-title")){target.attr("title",target.data("tooltip-title"))}target.removeAttr("aria-describedby");tooltip.stop(true);this._hide(tooltip,this.options.hide,function(){$(this).remove();delete that.tooltips[this.id]});target.unbind("mouseleave.tooltip blur.tooltip");this._trigger("close",event,{tooltip:tooltip})},_tooltip:function(element){var id="ui-tooltip-"+increments++,tooltip=$("<div>").attr({id:id,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));$("<div>").addClass("ui-tooltip-content").appendTo(tooltip);tooltip.appendTo(document.body);if($.fn.bgiframe){tooltip.bgiframe()}this.tooltips[id]=element;return tooltip},_find:function(target){var id=target.attr("aria-describedby");return id?$("#"+id):$()},_destroy:function(){$.each(this.tooltips,function(id){$("#"+id).remove()})}})}(jQuery));(function($,window){var Sammy,PATH_REPLACER="([^/]+)",PATH_NAME_MATCHER=/:([\w\d]+)/g,QUERY_STRING_MATCHER=/\?([^#]*)?$/,_makeArray=function(nonarray){return Array.prototype.slice.call(nonarray)},_isFunction=function(obj){return Object.prototype.toString.call(obj)==="[object Function]"},_isArray=function(obj){return Object.prototype.toString.call(obj)==="[object Array]"},_decode=function(str){return decodeURIComponent((str||"").replace(/\+/g," "))},_encode=encodeURIComponent,_escapeHTML=function(s){return String(s).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},_routeWrapper=function(verb){return function(path,callback){return this.route.apply(this,[verb,path,callback])}},_template_cache={},_has_history=!!(window.history&&history.pushState),loggers=[];Sammy=function(){var args=_makeArray(arguments),app,selector;Sammy.apps=Sammy.apps||{};if(args.length===0||args[0]&&_isFunction(args[0])){return Sammy.apply(Sammy,["body"].concat(args))}else{if(typeof(selector=args.shift())=="string"){app=Sammy.apps[selector]||new Sammy.Application();app.element_selector=selector;if(args.length>0){$.each(args,function(i,plugin){app.use(plugin)})}if(app.element_selector!=selector){delete Sammy.apps[selector]}Sammy.apps[app.element_selector]=app;return app}}};Sammy.VERSION="0.7.0";Sammy.addLogger=function(logger){loggers.push(logger)};Sammy.log=function(){var args=_makeArray(arguments);args.unshift("["+Date()+"]");$.each(loggers,function(i,logger){logger.apply(Sammy,args)})};if(typeof window.console!="undefined"){if(_isFunction(window.console.log.apply)){Sammy.addLogger(function(){window.console.log.apply(window.console,arguments)})}else{Sammy.addLogger(function(){window.console.log(arguments)})}}else{if(typeof console!="undefined"){Sammy.addLogger(function(){console.log.apply(console,arguments)})}}$.extend(Sammy,{makeArray:_makeArray,isFunction:_isFunction,isArray:_isArray});Sammy.Object=function(obj){return $.extend(this,obj||{})};$.extend(Sammy.Object.prototype,{escapeHTML:_escapeHTML,h:_escapeHTML,toHash:function(){var json={};$.each(this,function(k,v){if(!_isFunction(v)){json[k]=v}});return json},toHTML:function(){var display="";$.each(this,function(k,v){if(!_isFunction(v)){display+="<strong>"+k+"</strong> "+v+"<br />"}});return display},keys:function(attributes_only){var keys=[];for(var property in this){if(!_isFunction(this[property])||!attributes_only){keys.push(property)}}return keys},has:function(key){return this[key]&&$.trim(this[key].toString())!==""},join:function(){var args=_makeArray(arguments);var delimiter=args.shift();return args.join(delimiter)},log:function(){Sammy.log.apply(Sammy,arguments)},toString:function(include_functions){var s=[];$.each(this,function(k,v){if(!_isFunction(v)||include_functions){s.push('"'+k+'": '+v.toString())}});return"Sammy.Object: {"+s.join(",")+"}"}});Sammy.DefaultLocationProxy=function(app,run_interval_every){this.app=app;this.is_native=false;this.has_history=_has_history;this._startPolling(run_interval_every)};Sammy.DefaultLocationProxy.fullPath=function(location_obj){var matches=location_obj.toString().match(/^[^#]*(#.+)$/);var hash=matches?matches[1]:"";return[location_obj.pathname,location_obj.search,hash].join("")};Sammy.DefaultLocationProxy.prototype={bind:function(){var proxy=this,app=this.app,lp=Sammy.DefaultLocationProxy;$(window).bind("hashchange."+this.app.eventNamespace(),function(e,non_native){if(proxy.is_native===false&&!non_native){proxy.is_native=true;window.clearInterval(lp._interval)}app.trigger("location-changed")});if(_has_history&&!app.disable_push_state){$(window).bind("popstate."+this.app.eventNamespace(),function(e){app.trigger("location-changed")});$("a").live("click.history-"+this.app.eventNamespace(),function(e){var full_path=lp.fullPath(this);if(this.hostname==window.location.hostname&&app.lookupRoute("get",full_path)){e.preventDefault();proxy.setLocation(full_path);return false}})}if(!lp._bindings){lp._bindings=0}lp._bindings++},unbind:function(){$(window).unbind("hashchange."+this.app.eventNamespace());$(window).unbind("popstate."+this.app.eventNamespace());$("a").die("click.history-"+this.app.eventNamespace());Sammy.DefaultLocationProxy._bindings--;if(Sammy.DefaultLocationProxy._bindings<=0){window.clearInterval(Sammy.DefaultLocationProxy._interval)}},getLocation:function(){return Sammy.DefaultLocationProxy.fullPath(window.location)},setLocation:function(new_location){if(/^([^#\/]|$)/.test(new_location)){if(_has_history){new_location="/"+new_location}else{new_location="#!/"+new_location}}if(new_location!=this.getLocation()){if(_has_history&&/^\//.test(new_location)){history.pushState({path:new_location},window.title,new_location);this.app.trigger("location-changed")}else{return(window.location=new_location)}}},_startPolling:function(every){var proxy=this;if(!Sammy.DefaultLocationProxy._interval){if(!every){every=10}var hashCheck=function(){var current_location=proxy.getLocation();if(typeof Sammy.DefaultLocationProxy._last_location=="undefined"||current_location!=Sammy.DefaultLocationProxy._last_location){window.setTimeout(function(){$(window).trigger("hashchange",[true])},0)}Sammy.DefaultLocationProxy._last_location=current_location};hashCheck();Sammy.DefaultLocationProxy._interval=window.setInterval(hashCheck,every)}}};Sammy.Application=function(app_function){var app=this;this.routes={};this.listeners=new Sammy.Object({});this.arounds=[];this.befores=[];this.namespace=(new Date()).getTime()+"-"+parseInt(Math.random()*1000,10);this.context_prototype=function(){Sammy.EventContext.apply(this,arguments)};this.context_prototype.prototype=new Sammy.EventContext();if(_isFunction(app_function)){app_function.apply(this,[this])}if(!this._location_proxy){this.setLocationProxy(new Sammy.DefaultLocationProxy(this,this.run_interval_every))}if(this.debug){this.bindToAllEvents(function(e,data){app.log(app.toString(),e.cleaned_type,data||{})})}};Sammy.Application.prototype=$.extend({},Sammy.Object.prototype,{ROUTE_VERBS:["get","post","put","delete"],APP_EVENTS:["run","unload","lookup-route","run-route","route-found","event-context-before","event-context-after","changed","error","check-form-submission","redirect","location-changed"],_last_route:null,_location_proxy:null,_running:false,element_selector:"body",debug:false,raise_errors:false,run_interval_every:50,disable_push_state:false,template_engine:null,toString:function(){return"Sammy.Application:"+this.element_selector},$element:function(selector){return selector?$(this.element_selector).find(selector):$(this.element_selector)},use:function(){var args=_makeArray(arguments),plugin=args.shift(),plugin_name=plugin||"";try{args.unshift(this);if(typeof plugin=="string"){plugin_name="Sammy."+plugin;plugin=Sammy[plugin]}plugin.apply(this,args)}catch(e){if(typeof plugin==="undefined"){this.error("Plugin Error: called use() but plugin ("+plugin_name.toString()+") is not defined",e)}else{if(!_isFunction(plugin)){this.error("Plugin Error: called use() but '"+plugin_name.toString()+"' is not a function",e)}else{this.error("Plugin Error",e)}}}return this},setLocationProxy:function(new_proxy){var original_proxy=this._location_proxy;this._location_proxy=new_proxy;if(this.isRunning()){if(original_proxy){original_proxy.unbind()}this._location_proxy.bind()}},log:function(){Sammy.log.apply(Sammy,Array.prototype.concat.apply([this.element_selector],arguments))},route:function(verb,path,callback){var app=this,param_names=[],add_route,path_match;if(!callback&&_isFunction(path)){path=verb;callback=path;verb="any"}verb=verb.toLowerCase();if(path.constructor==String){PATH_NAME_MATCHER.lastIndex=0;while((path_match=PATH_NAME_MATCHER.exec(path))!==null){param_names.push(path_match[1])}path=new RegExp(path.replace(PATH_NAME_MATCHER,PATH_REPLACER)+"$")}if(typeof callback=="string"){callback=app[callback]}add_route=function(with_verb){var r={verb:with_verb,path:path,callback:callback,param_names:param_names};app.routes[with_verb]=app.routes[with_verb]||[];app.routes[with_verb].push(r)};if(verb==="any"){$.each(this.ROUTE_VERBS,function(i,v){add_route(v)})}else{add_route(verb)}return this},get:_routeWrapper("get"),post:_routeWrapper("post"),put:_routeWrapper("put"),del:_routeWrapper("delete"),any:_routeWrapper("any"),mapRoutes:function(route_array){var app=this;$.each(route_array,function(i,route_args){app.route.apply(app,route_args)});return this},eventNamespace:function(){return["sammy-app",this.namespace].join("-")},bind:function(name,data,callback){var app=this;if(typeof callback=="undefined"){callback=data}var listener_callback=function(){var e,context,data;e=arguments[0];data=arguments[1];if(data&&data.context){context=data.context;delete data.context}else{context=new app.context_prototype(app,"bind",e.type,data,e.target)}e.cleaned_type=e.type.replace(app.eventNamespace(),"");callback.apply(context,[e,data])};if(!this.listeners[name]){this.listeners[name]=[]}this.listeners[name].push(listener_callback);if(this.isRunning()){this._listen(name,listener_callback)}return this},trigger:function(name,data){this.$element().trigger([name,this.eventNamespace()].join("."),[data]);return this},refresh:function(){this.last_location=null;this.trigger("location-changed");return this},before:function(options,callback){if(_isFunction(options)){callback=options;options={}}this.befores.push([options,callback]);return this},after:function(callback){return this.bind("event-context-after",callback)},around:function(callback){this.arounds.push(callback);return this},isRunning:function(){return this._running},helpers:function(extensions){$.extend(this.context_prototype.prototype,extensions);return this},helper:function(name,method){this.context_prototype.prototype[name]=method;return this},run:function(start_url){if(this.isRunning()){return false}var app=this;$.each(this.listeners.toHash(),function(name,callbacks){$.each(callbacks,function(i,listener_callback){app._listen(name,listener_callback)})});this.trigger("run",{start_url:start_url});this._running=true;this.last_location=null;if(!(/\#(.+)/.test(this.getLocation()))&&typeof start_url!="undefined"){this.setLocation(start_url)}this._checkLocation();this._location_proxy.bind();this.bind("location-changed",function(){app._checkLocation()});this.bind("submit",function(e){var returned=app._checkFormSubmission($(e.target).closest("form"));return(returned===false)?e.preventDefault():false});$(window).bind("beforeunload",function(){app.unload()});return this.trigger("changed")},unload:function(){if(!this.isRunning()){return false}var app=this;this.trigger("unload");this._location_proxy.unbind();this.$element().unbind("submit").removeClass(app.eventNamespace());$.each(this.listeners.toHash(),function(name,listeners){$.each(listeners,function(i,listener_callback){app._unlisten(name,listener_callback)})});this._running=false;return this},bindToAllEvents:function(callback){var app=this;$.each(this.APP_EVENTS,function(i,e){app.bind(e,callback)});$.each(this.listeners.keys(true),function(i,name){if($.inArray(name,app.APP_EVENTS)==-1){app.bind(name,callback)}});return this},routablePath:function(path){return path.replace(QUERY_STRING_MATCHER,"")},lookupRoute:function(verb,path){var app=this,routed=false,i=0,l,route;if(typeof this.routes[verb]!="undefined"){l=this.routes[verb].length;for(;i<l;i++){route=this.routes[verb][i];if(app.routablePath(path).match(route.path)){routed=route;break}}}return routed},runRoute:function(verb,path,params,target){var app=this,route=this.lookupRoute(verb,path),context,wrapped_route,arounds,around,befores,before,callback_args,path_params,final_returned;this.log("runRoute",[verb,path].join(" "));this.trigger("run-route",{verb:verb,path:path,params:params});if(typeof params=="undefined"){params={}}$.extend(params,this._parseQueryString(path));if(route){this.trigger("route-found",{route:route});if((path_params=route.path.exec(this.routablePath(path)))!==null){path_params.shift();$.each(path_params,function(i,param){if(route.param_names[i]){params[route.param_names[i]]=_decode(param)}else{if(!params.splat){params.splat=[]}params.splat.push(_decode(param))}})}context=new this.context_prototype(this,verb,path,params,target);arounds=this.arounds.slice(0);befores=this.befores.slice(0);callback_args=[context].concat(params.splat);wrapped_route=function(){var returned;while(befores.length>0){before=befores.shift();if(app.contextMatchesOptions(context,before[0])){returned=before[1].apply(context,[context]);if(returned===false){return false}}}app.last_route=route;context.trigger("event-context-before",{context:context});returned=route.callback.apply(context,callback_args);context.trigger("event-context-after",{context:context});return returned};$.each(arounds.reverse(),function(i,around){var last_wrapped_route=wrapped_route;wrapped_route=function(){return around.apply(context,[last_wrapped_route])}});try{final_returned=wrapped_route()}catch(e){this.error(["500 Error",verb,path].join(" "),e)}return final_returned}else{return this.notFound(verb,path)}},contextMatchesOptions:function(context,match_options,positive){var options=match_options;if(typeof options==="undefined"||options=={}){return true}if(typeof positive==="undefined"){positive=true}if(typeof options==="string"||_isFunction(options.test)){options={path:options}}if(options.only){return this.contextMatchesOptions(context,options.only,true)}else{if(options.except){return this.contextMatchesOptions(context,options.except,false)}}var path_matched=true,verb_matched=true;if(options.path){if(!_isFunction(options.path.test)){options.path=new RegExp(options.path.toString()+"$")}path_matched=options.path.test(context.path)}if(options.verb){if(typeof options.verb==="string"){verb_matched=options.verb===context.verb}else{verb_matched=options.verb.indexOf(context.verb)>-1}}return positive?(verb_matched&&path_matched):!(verb_matched&&path_matched)},getLocation:function(){return this._location_proxy.getLocation()},setLocation:function(new_location){return this._location_proxy.setLocation(new_location)},swap:function(content){return this.$element().html(content)},templateCache:function(key,value){if(typeof value!="undefined"){return _template_cache[key]=value}else{return _template_cache[key]}},clearTemplateCache:function(){return _template_cache={}},notFound:function(verb,path){var ret=this.error(["404 Not Found",verb,path].join(" "));return(verb==="get")?ret:true},error:function(message,original_error){if(!original_error){original_error=new Error()}original_error.message=[message,original_error.message].join(" ");this.trigger("error",{message:original_error.message,error:original_error});if(this.raise_errors){throw (original_error)}else{this.log(original_error.message,original_error)}},_checkLocation:function(){var location,returned;location=this.getLocation();if(!this.last_location||this.last_location[0]!="get"||this.last_location[1]!=location){this.last_location=["get",location];returned=this.runRoute("get",location)}return returned},_getFormVerb:function(form){var $form=$(form),verb,$_method;$_method=$form.find('input[name="_method"]');if($_method.length>0){verb=$_method.val()}if(!verb){verb=$form[0].getAttribute("method")}if(!verb||verb==""){verb="get"}return $.trim(verb.toString().toLowerCase())},_checkFormSubmission:function(form){var $form,path,verb,params,returned;this.trigger("check-form-submission",{form:form});$form=$(form);path=$form.attr("action")||"";verb=this._getFormVerb($form);this.log("_checkFormSubmission",$form,path,verb);if(verb==="get"){params=this._serializeFormParams($form);if(params!==""){path+="?"+params}this.setLocation(path);returned=false}else{params=$.extend({},this._parseFormParams($form));returned=this.runRoute(verb,path,params,form.get(0))}return(typeof returned=="undefined")?false:returned},_serializeFormParams:function($form){var queryString="",fields=$form.serializeArray(),i;if(fields.length>0){queryString=this._encodeFormPair(fields[0].name,fields[0].value);for(i=1;i<fields.length;i++){queryString=queryString+"&"+this._encodeFormPair(fields[i].name,fields[i].value)}}return queryString},_encodeFormPair:function(name,value){return _encode(name)+"="+_encode(value)},_parseFormParams:function($form){var params={},form_fields=$form.serializeArray(),i;for(i=0;i<form_fields.length;i++){params=this._parseParamPair(params,form_fields[i].name,form_fields[i].value)}return params},_parseQueryString:function(path){var params={},parts,pairs,pair,i;parts=path.match(QUERY_STRING_MATCHER);if(parts){pairs=parts[1].split("&");for(i=0;i<pairs.length;i++){pair=pairs[i].split("=");params=this._parseParamPair(params,_decode(pair[0]),_decode(pair[1]||""))}}return params},_parseParamPair:function(params,key,value){if(params[key]){if(_isArray(params[key])){params[key].push(value)}else{params[key]=[params[key],value]}}else{params[key]=value}return params},_listen:function(name,callback){return this.$element().bind([name,this.eventNamespace()].join("."),callback)},_unlisten:function(name,callback){return this.$element().unbind([name,this.eventNamespace()].join("."),callback)}});Sammy.RenderContext=function(event_context){this.event_context=event_context;this.callbacks=[];this.previous_content=null;this.content=null;this.next_engine=false;this.waiting=false};Sammy.RenderContext.prototype=$.extend({},Sammy.Object.prototype,{then:function(callback){if(!_isFunction(callback)){if(typeof callback==="string"&&callback in this.event_context){var helper=this.event_context[callback];callback=function(content){return helper.apply(this.event_context,[content])}}else{return this}}var context=this;if(this.waiting){this.callbacks.push(callback)}else{this.wait();window.setTimeout(function(){var returned=callback.apply(context,[context.content,context.previous_content]);if(returned!==false){context.next(returned)}},0)}return this},wait:function(){this.waiting=true},next:function(content){this.waiting=false;if(typeof content!=="undefined"){this.previous_content=this.content;this.content=content}if(this.callbacks.length>0){this.then(this.callbacks.shift())}},load:function(location,options,callback){var context=this;return this.then(function(){var should_cache,cached,is_json,location_array;if(_isFunction(options)){callback=options;options={}}else{options=$.extend({},options)}if(callback){this.then(callback)}if(typeof location==="string"){is_json=(location.match(/\.json$/)||options.json);should_cache=((is_json&&options.cache===true)||options.cache!==false);context.next_engine=context.event_context.engineFor(location);delete options.cache;delete options.json;if(options.engine){context.next_engine=options.engine;delete options.engine}if(should_cache&&(cached=this.event_context.app.templateCache(location))){return cached}this.wait();$.ajax($.extend({url:location,data:{},dataType:is_json?"json":null,type:"get",success:function(data){if(should_cache){context.event_context.app.templateCache(location,data)}context.next(data)}},options));return false}else{if(location.nodeType){return location.innerHTML}if(location.selector){context.next_engine=location.attr("data-engine");if(options.clone===false){return location.remove()[0].innerHTML.toString()}else{return location[0].innerHTML.toString()}}}})},loadPartials:function(partials){if(partials){this.partials=this.partials||{};for(name in partials){(function(context,name){context.load(partials[name]).then(function(template){this.partials[name]=template})})(this,name)}}return this},render:function(location,data,callback,partials){if(_isFunction(location)&&!data){return this.then(location)}else{return this.loadPartials(partials).load(location).interpolate(data,location).then(callback)}},partial:function(location,data){return this.render(location,data).swap()},send:function(){var context=this,args=_makeArray(arguments),fun=args.shift();if(_isArray(args[0])){args=args[0]}return this.then(function(content){args.push(function(response){context.next(response)});context.wait();fun.apply(fun,args);return false})},collect:function(array,callback,now){var context=this;var coll=function(){if(_isFunction(array)){callback=array;array=this.content}var contents=[],doms=false;$.each(array,function(i,item){var returned=callback.apply(context,[i,item]);if(returned.jquery&&returned.length==1){returned=returned[0];doms=true}contents.push(returned);return returned});return doms?contents:contents.join("")};return now?coll():this.then(coll)},renderEach:function(location,name,data,callback){if(_isArray(name)){callback=data;data=name;name=null}return this.load(location).then(function(content){var rctx=this;if(!data){data=_isArray(this.previous_content)?this.previous_content:[]}if(callback){$.each(data,function(i,value){var idata={},engine=this.next_engine||location;name?(idata[name]=value):(idata=value);callback(value,rctx.event_context.interpolate(content,idata,engine))})}else{return this.collect(data,function(i,value){var idata={},engine=this.next_engine||location;name?(idata[name]=value):(idata=value);return this.event_context.interpolate(content,idata,engine)},true)}})},interpolate:function(data,engine,retain){var context=this;return this.then(function(content,prev){if(!data&&prev){data=prev}if(this.next_engine){engine=this.next_engine;this.next_engine=false}var rendered=context.event_context.interpolate(content,data,engine,this.partials);return retain?prev+rendered:rendered})},swap:function(){return this.then(function(content){this.event_context.swap(content)}).trigger("changed",{})},appendTo:function(selector){return this.then(function(content){$(selector).append(content)}).trigger("changed",{})},prependTo:function(selector){return this.then(function(content){$(selector).prepend(content)}).trigger("changed",{})},replace:function(selector){return this.then(function(content){$(selector).html(content)}).trigger("changed",{})},trigger:function(name,data){return this.then(function(content){if(typeof data=="undefined"){data={content:content}}this.event_context.trigger(name,data)})}});Sammy.EventContext=function(app,verb,path,params,target){this.app=app;this.verb=verb;this.path=path;this.params=new Sammy.Object(params);this.target=target};Sammy.EventContext.prototype=$.extend({},Sammy.Object.prototype,{$element:function(){return this.app.$element(_makeArray(arguments).shift())},engineFor:function(engine){var context=this,engine_match;if(_isFunction(engine)){return engine}engine=(engine||context.app.template_engine).toString();if((engine_match=engine.match(/\.([^\.\?\#]+)$/))){engine=engine_match[1]}if(engine&&_isFunction(context[engine])){return context[engine]}if(context.app.template_engine){return this.engineFor(context.app.template_engine)}return function(content,data){return content}},interpolate:function(content,data,engine,partials){return this.engineFor(engine).apply(this,[content,data,partials])},render:function(location,data,callback,partials){return new Sammy.RenderContext(this).render(location,data,callback,partials)},renderEach:function(location,name,data,callback){return new Sammy.RenderContext(this).renderEach(location,name,data,callback)},load:function(location,options,callback){return new Sammy.RenderContext(this).load(location,options,callback)},partial:function(location,data){return new Sammy.RenderContext(this).partial(location,data)},send:function(){var rctx=new Sammy.RenderContext(this);return rctx.send.apply(rctx,arguments)},redirect:function(){var to,args=_makeArray(arguments),current_location=this.app.getLocation(),l=args.length;if(l>1){var i=0,paths=[],pairs=[],params={},has_params=false;for(;i<l;i++){if(typeof args[i]=="string"){paths.push(args[i])}else{$.extend(params,args[i]);has_params=true}}to=paths.join("/");if(has_params){for(var k in params){pairs.push(this.app._encodeFormPair(k,params[k]))}to+="?"+pairs.join("&")}}else{to=args[0]}this.trigger("redirect",{to:to});this.app.last_location=[this.verb,this.path];this.app.setLocation(to);if(new RegExp(to).test(current_location)){this.app.trigger("location-changed")}},trigger:function(name,data){if(typeof data=="undefined"){data={}}if(!data.context){data.context=this}return this.app.trigger(name,data)},eventNamespace:function(){return this.app.eventNamespace()},swap:function(contents){return this.app.swap(contents)},notFound:function(){return this.app.notFound(this.verb,this.path)},json:function(string){return $.parseJSON(string)},toString:function(){return"Sammy.EventContext: "+[this.verb,this.path,this.params].join(" ")}});$.sammy=window.Sammy=Sammy})(jQuery,window);(function($){$.fn.someAllCheckboxes=function(options){var settings=$.extend({allSelector:".all"},options||{});$(this).each(function(index,group){var checkBoxGroup=$(group);var allCheckBoxes=checkBoxGroup.find(settings.allSelector+":checkbox");var singleCheckBoxes=checkBoxGroup.find(":not("+settings.allSelector+"):checkbox");checkBoxGroup.bind("someAllCheckboxes:allChecked",function(){singleCheckBoxes.attr("checked",false)});checkBoxGroup.bind("someAllCheckboxes:singleChecked",function(){allCheckBoxes.attr("checked",false)});allCheckBoxes.change(function(){if($(this).is(":checked")){checkBoxGroup.trigger("someAllCheckboxes:allChecked")}});singleCheckBoxes.change(function(){if($(this).is("checked")){checkBoxGroup.trigger("someAllCheckboxes:singleChecked")}})});return this}})(jQuery);if(typeof(jQuery)==="function"){jQuery.arturo={agentSupportsHTML5Output:("for" in jQuery("<output />")),linkAndShowOutputs:function(){if(jQuery.arturo.agentSupportsHTML5Output){jQuery(".features output,.feature_new output,.feature_edit output").each(function(i,output){var output=jQuery(output);var input=jQuery("#"+output.attr("for"));input.change(function(){output.val(input.val())});output.removeClass("no_js")})}}};jQuery(function(){jQuery.arturo.linkAndShowOutputs()})}if(!document.createElement("canvas").getContext){(function(){var m=Math;var mr=m.round;var ms=m.sin;var mc=m.cos;var abs=m.abs;var sqrt=m.sqrt;var Z=10;var Z2=Z/2;function getContext(){return this.context_||(this.context_=new CanvasRenderingContext2D_(this))}var slice=Array.prototype.slice;function bind(f,obj,var_args){var a=slice.call(arguments,2);return function(){return f.apply(obj,a.concat(slice.call(arguments)))}}var G_vmlCanvasManager_={init:function(opt_doc){if(/MSIE/.test(navigator.userAgent)&&!window.opera){var doc=opt_doc||document;doc.createElement("canvas");doc.attachEvent("onreadystatechange",bind(this.init_,this,doc))}},init_:function(doc){if(!doc.namespaces.g_vml_){doc.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML")}if(!doc.namespaces.g_o_){doc.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML")}if(!doc.styleSheets.ex_canvas_){var ss=doc.createStyleSheet();ss.owningElement.id="ex_canvas_";ss.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}g_vml_\\:*{behavior:url(#default#VML)}g_o_\\:*{behavior:url(#default#VML)}"}var els=doc.getElementsByTagName("canvas");for(var i=0;i<els.length;i++){this.initElement(els[i])}},initElement:function(el){if(!el.getContext){el.getContext=getContext;el.innerHTML="";el.attachEvent("onpropertychange",onPropertyChange);el.attachEvent("onresize",onResize);var attrs=el.attributes;if(attrs.width&&attrs.width.specified){el.style.width=attrs.width.nodeValue+"px"}else{el.width=el.clientWidth}if(attrs.height&&attrs.height.specified){el.style.height=attrs.height.nodeValue+"px"}else{el.height=el.clientHeight}}return el}};function onPropertyChange(e){var el=e.srcElement;switch(e.propertyName){case"width":el.style.width=el.attributes.width.nodeValue+"px";el.getContext().clearRect();break;case"height":el.style.height=el.attributes.height.nodeValue+"px";el.getContext().clearRect();break}}function onResize(e){var el=e.srcElement;if(el.firstChild){el.firstChild.style.width=el.clientWidth+"px";el.firstChild.style.height=el.clientHeight+"px"}}G_vmlCanvasManager_.init();var dec2hex=[];for(var i=0;i<16;i++){for(var j=0;j<16;j++){dec2hex[i*16+j]=i.toString(16)+j.toString(16)}}function createMatrixIdentity(){return[[1,0,0],[0,1,0],[0,0,1]]}function matrixMultiply(m1,m2){var result=createMatrixIdentity();for(var x=0;x<3;x++){for(var y=0;y<3;y++){var sum=0;for(var z=0;z<3;z++){sum+=m1[x][z]*m2[z][y]}result[x][y]=sum}}return result}function copyState(o1,o2){o2.fillStyle=o1.fillStyle;o2.lineCap=o1.lineCap;o2.lineJoin=o1.lineJoin;o2.lineWidth=o1.lineWidth;o2.miterLimit=o1.miterLimit;o2.shadowBlur=o1.shadowBlur;o2.shadowColor=o1.shadowColor;o2.shadowOffsetX=o1.shadowOffsetX;o2.shadowOffsetY=o1.shadowOffsetY;o2.strokeStyle=o1.strokeStyle;o2.globalAlpha=o1.globalAlpha;o2.arcScaleX_=o1.arcScaleX_;o2.arcScaleY_=o1.arcScaleY_;o2.lineScale_=o1.lineScale_}function processStyle(styleString){var str,alpha=1;styleString=String(styleString);if(styleString.substring(0,3)=="rgb"){var start=styleString.indexOf("(",3);var end=styleString.indexOf(")",start+1);var guts=styleString.substring(start+1,end).split(",");str="#";for(var i=0;i<3;i++){str+=dec2hex[Number(guts[i])]}if(guts.length==4&&styleString.substr(3,1)=="a"){alpha=guts[3]}}else{str=styleString}return{color:str,alpha:alpha}}function processLineCap(lineCap){switch(lineCap){case"butt":return"flat";case"round":return"round";case"square":default:return"square"}}function CanvasRenderingContext2D_(surfaceElement){this.m_=createMatrixIdentity();this.mStack_=[];this.aStack_=[];this.currentPath_=[];this.strokeStyle="#000";this.fillStyle="#000";this.lineWidth=1;this.lineJoin="miter";this.lineCap="butt";this.miterLimit=Z*1;this.globalAlpha=1;this.canvas=surfaceElement;var el=surfaceElement.ownerDocument.createElement("div");el.style.width=surfaceElement.clientWidth+"px";el.style.height=surfaceElement.clientHeight+"px";el.style.overflow="hidden";el.style.position="absolute";surfaceElement.appendChild(el);this.element_=el;this.arcScaleX_=1;this.arcScaleY_=1;this.lineScale_=1}var contextPrototype=CanvasRenderingContext2D_.prototype;contextPrototype.clearRect=function(){this.element_.innerHTML=""};contextPrototype.beginPath=function(){this.currentPath_=[]};contextPrototype.moveTo=function(aX,aY){var p=this.getCoords_(aX,aY);this.currentPath_.push({type:"moveTo",x:p.x,y:p.y});this.currentX_=p.x;this.currentY_=p.y};contextPrototype.lineTo=function(aX,aY){var p=this.getCoords_(aX,aY);this.currentPath_.push({type:"lineTo",x:p.x,y:p.y});this.currentX_=p.x;this.currentY_=p.y};contextPrototype.bezierCurveTo=function(aCP1x,aCP1y,aCP2x,aCP2y,aX,aY){var p=this.getCoords_(aX,aY);var cp1=this.getCoords_(aCP1x,aCP1y);var cp2=this.getCoords_(aCP2x,aCP2y);bezierCurveTo(this,cp1,cp2,p)};function bezierCurveTo(self,cp1,cp2,p){self.currentPath_.push({type:"bezierCurveTo",cp1x:cp1.x,cp1y:cp1.y,cp2x:cp2.x,cp2y:cp2.y,x:p.x,y:p.y});self.currentX_=p.x;self.currentY_=p.y}contextPrototype.quadraticCurveTo=function(aCPx,aCPy,aX,aY){var cp=this.getCoords_(aCPx,aCPy);var p=this.getCoords_(aX,aY);var cp1={x:this.currentX_+2/3*(cp.x-this.currentX_),y:this.currentY_+2/3*(cp.y-this.currentY_)};var cp2={x:cp1.x+(p.x-this.currentX_)/3,y:cp1.y+(p.y-this.currentY_)/3};bezierCurveTo(this,cp1,cp2,p)};contextPrototype.arc=function(aX,aY,aRadius,aStartAngle,aEndAngle,aClockwise){aRadius*=Z;var arcType=aClockwise?"at":"wa";var xStart=aX+mc(aStartAngle)*aRadius-Z2;var yStart=aY+ms(aStartAngle)*aRadius-Z2;var xEnd=aX+mc(aEndAngle)*aRadius-Z2;var yEnd=aY+ms(aEndAngle)*aRadius-Z2;if(xStart==xEnd&&!aClockwise){xStart+=0.125}var p=this.getCoords_(aX,aY);var pStart=this.getCoords_(xStart,yStart);var pEnd=this.getCoords_(xEnd,yEnd);this.currentPath_.push({type:arcType,x:p.x,y:p.y,radius:aRadius,xStart:pStart.x,yStart:pStart.y,xEnd:pEnd.x,yEnd:pEnd.y})};contextPrototype.rect=function(aX,aY,aWidth,aHeight){this.moveTo(aX,aY);this.lineTo(aX+aWidth,aY);this.lineTo(aX+aWidth,aY+aHeight);this.lineTo(aX,aY+aHeight);this.closePath()};contextPrototype.strokeRect=function(aX,aY,aWidth,aHeight){var oldPath=this.currentPath_;this.beginPath();this.moveTo(aX,aY);this.lineTo(aX+aWidth,aY);this.lineTo(aX+aWidth,aY+aHeight);this.lineTo(aX,aY+aHeight);this.closePath();this.stroke();this.currentPath_=oldPath};contextPrototype.fillRect=function(aX,aY,aWidth,aHeight){var oldPath=this.currentPath_;this.beginPath();this.moveTo(aX,aY);this.lineTo(aX+aWidth,aY);this.lineTo(aX+aWidth,aY+aHeight);this.lineTo(aX,aY+aHeight);this.closePath();this.fill();this.currentPath_=oldPath};contextPrototype.createLinearGradient=function(aX0,aY0,aX1,aY1){var gradient=new CanvasGradient_("gradient");gradient.x0_=aX0;gradient.y0_=aY0;gradient.x1_=aX1;gradient.y1_=aY1;return gradient};contextPrototype.createRadialGradient=function(aX0,aY0,aR0,aX1,aY1,aR1){var gradient=new CanvasGradient_("gradientradial");gradient.x0_=aX0;gradient.y0_=aY0;gradient.r0_=aR0;gradient.x1_=aX1;gradient.y1_=aY1;gradient.r1_=aR1;return gradient};contextPrototype.drawImage=function(image,var_args){var dx,dy,dw,dh,sx,sy,sw,sh;var oldRuntimeWidth=image.runtimeStyle.width;var oldRuntimeHeight=image.runtimeStyle.height;image.runtimeStyle.width="auto";image.runtimeStyle.height="auto";var w=image.width;var h=image.height;image.runtimeStyle.width=oldRuntimeWidth;image.runtimeStyle.height=oldRuntimeHeight;if(arguments.length==3){dx=arguments[1];dy=arguments[2];sx=sy=0;sw=dw=w;sh=dh=h}else{if(arguments.length==5){dx=arguments[1];dy=arguments[2];dw=arguments[3];dh=arguments[4];sx=sy=0;sw=w;sh=h}else{if(arguments.length==9){sx=arguments[1];sy=arguments[2];sw=arguments[3];sh=arguments[4];dx=arguments[5];dy=arguments[6];dw=arguments[7];dh=arguments[8]}else{throw Error("Invalid number of arguments")}}}var d=this.getCoords_(dx,dy);var w2=sw/2;var h2=sh/2;var vmlStr=[];var W=10;var H=10;vmlStr.push(" <g_vml_:group",' coordsize="',Z*W,",",Z*H,'"',' coordorigin="0,0"',' style="width:',W,"px;height:",H,"px;position:absolute;");if(this.m_[0][0]!=1||this.m_[0][1]){var filter=[];filter.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",mr(d.x/Z),",","Dy=",mr(d.y/Z),"");var max=d;var c2=this.getCoords_(dx+dw,dy);var c3=this.getCoords_(dx,dy+dh);var c4=this.getCoords_(dx+dw,dy+dh);max.x=m.max(max.x,c2.x,c3.x,c4.x);max.y=m.max(max.y,c2.y,c3.y,c4.y);vmlStr.push("padding:0 ",mr(max.x/Z),"px ",mr(max.y/Z),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",filter.join(""),", sizingmethod='clip');")}else{vmlStr.push("top:",mr(d.y/Z),"px;left:",mr(d.x/Z),"px;")}vmlStr.push(' ">','<g_vml_:image src="',image.src,'"',' style="width:',Z*dw,"px;"," height:",Z*dh,'px;"',' cropleft="',sx/w,'"',' croptop="',sy/h,'"',' cropright="',(w-sx-sw)/w,'"',' cropbottom="',(h-sy-sh)/h,'"'," />","</g_vml_:group>");this.element_.insertAdjacentHTML("BeforeEnd",vmlStr.join(""))};contextPrototype.stroke=function(aFill){var lineStr=[];var lineOpen=false;var a=processStyle(aFill?this.fillStyle:this.strokeStyle);var color=a.color;var opacity=a.alpha*this.globalAlpha;var W=10;var H=10;lineStr.push("<g_vml_:shape",' filled="',!!aFill,'"',' style="position:absolute;width:',W,"px;height:",H,'px;"',' coordorigin="0 0" coordsize="',Z*W," ",Z*H,'"',' stroked="',!aFill,'"',' path="');var newSeq=false;var min={x:null,y:null};var max={x:null,y:null};for(var i=0;i<this.currentPath_.length;i++){var p=this.currentPath_[i];var c;switch(p.type){case"moveTo":c=p;lineStr.push(" m ",mr(p.x),",",mr(p.y));break;case"lineTo":lineStr.push(" l ",mr(p.x),",",mr(p.y));break;case"close":lineStr.push(" x ");p=null;break;case"bezierCurveTo":lineStr.push(" c ",mr(p.cp1x),",",mr(p.cp1y),",",mr(p.cp2x),",",mr(p.cp2y),",",mr(p.x),",",mr(p.y));break;case"at":case"wa":lineStr.push(" ",p.type," ",mr(p.x-this.arcScaleX_*p.radius),",",mr(p.y-this.arcScaleY_*p.radius)," ",mr(p.x+this.arcScaleX_*p.radius),",",mr(p.y+this.arcScaleY_*p.radius)," ",mr(p.xStart),",",mr(p.yStart)," ",mr(p.xEnd),",",mr(p.yEnd));break}if(p){if(min.x==null||p.x<min.x){min.x=p.x}if(max.x==null||p.x>max.x){max.x=p.x}if(min.y==null||p.y<min.y){min.y=p.y}if(max.y==null||p.y>max.y){max.y=p.y}}}lineStr.push(' ">');if(!aFill){var lineWidth=this.lineScale_*this.lineWidth;if(lineWidth<1){opacity*=lineWidth}lineStr.push("<g_vml_:stroke",' opacity="',opacity,'"',' joinstyle="',this.lineJoin,'"',' miterlimit="',this.miterLimit,'"',' endcap="',processLineCap(this.lineCap),'"',' weight="',lineWidth,'px"',' color="',color,'" />')}else{if(typeof this.fillStyle=="object"){var fillStyle=this.fillStyle;var angle=0;var focus={x:0,y:0};var shift=0;var expansion=1;if(fillStyle.type_=="gradient"){var x0=fillStyle.x0_/this.arcScaleX_;var y0=fillStyle.y0_/this.arcScaleY_;var x1=fillStyle.x1_/this.arcScaleX_;var y1=fillStyle.y1_/this.arcScaleY_;var p0=this.getCoords_(x0,y0);var p1=this.getCoords_(x1,y1);var dx=p1.x-p0.x;var dy=p1.y-p0.y;angle=Math.atan2(dx,dy)*180/Math.PI;if(angle<0){angle+=360}if(angle<0.000001){angle=0}}else{var p0=this.getCoords_(fillStyle.x0_,fillStyle.y0_);var width=max.x-min.x;var height=max.y-min.y;focus={x:(p0.x-min.x)/width,y:(p0.y-min.y)/height};width/=this.arcScaleX_*Z;height/=this.arcScaleY_*Z;var dimension=m.max(width,height);shift=2*fillStyle.r0_/dimension;expansion=2*fillStyle.r1_/dimension-shift}var stops=fillStyle.colors_;stops.sort(function(cs1,cs2){return cs1.offset-cs2.offset});var length=stops.length;var color1=stops[0].color;var color2=stops[length-1].color;var opacity1=stops[0].alpha*this.globalAlpha;var opacity2=stops[length-1].alpha*this.globalAlpha;var colors=[];for(var i=0;i<length;i++){var stop=stops[i];colors.push(stop.offset*expansion+shift+" "+stop.color)}lineStr.push('<g_vml_:fill type="',fillStyle.type_,'"',' method="none" focus="100%"',' color="',color1,'"',' color2="',color2,'"',' colors="',colors.join(","),'"',' opacity="',opacity2,'"',' g_o_:opacity2="',opacity1,'"',' angle="',angle,'"',' focusposition="',focus.x,",",focus.y,'" />')}else{lineStr.push('<g_vml_:fill color="',color,'" opacity="',opacity,'" />')}}lineStr.push("</g_vml_:shape>");this.element_.insertAdjacentHTML("beforeEnd",lineStr.join(""))};contextPrototype.fill=function(){this.stroke(true)};contextPrototype.closePath=function(){this.currentPath_.push({type:"close"})};contextPrototype.getCoords_=function(aX,aY){var m=this.m_;return{x:Z*(aX*m[0][0]+aY*m[1][0]+m[2][0])-Z2,y:Z*(aX*m[0][1]+aY*m[1][1]+m[2][1])-Z2}};contextPrototype.save=function(){var o={};copyState(this,o);this.aStack_.push(o);this.mStack_.push(this.m_);this.m_=matrixMultiply(createMatrixIdentity(),this.m_)};contextPrototype.restore=function(){copyState(this.aStack_.pop(),this);this.m_=this.mStack_.pop()};contextPrototype.translate=function(aX,aY){var m1=[[1,0,0],[0,1,0],[aX,aY,1]];this.m_=matrixMultiply(m1,this.m_)};contextPrototype.rotate=function(aRot){var c=mc(aRot);var s=ms(aRot);var m1=[[c,s,0],[-s,c,0],[0,0,1]];this.m_=matrixMultiply(m1,this.m_)};contextPrototype.scale=function(aX,aY){this.arcScaleX_*=aX;this.arcScaleY_*=aY;var m1=[[aX,0,0],[0,aY,0],[0,0,1]];var m=this.m_=matrixMultiply(m1,this.m_);var det=m[0][0]*m[1][1]-m[0][1]*m[1][0];this.lineScale_=sqrt(abs(det))};contextPrototype.clip=function(){};contextPrototype.arcTo=function(){};contextPrototype.createPattern=function(){return new CanvasPattern_};function CanvasGradient_(aType){this.type_=aType;this.x0_=0;this.y0_=0;this.r0_=0;this.x1_=0;this.y1_=0;this.r1_=0;this.colors_=[]}CanvasGradient_.prototype.addColorStop=function(aOffset,aColor){aColor=processStyle(aColor);this.colors_.push({offset:aOffset,color:aColor.color,alpha:aColor.alpha})};function CanvasPattern_(){}G_vmlCanvasManager=G_vmlCanvasManager_;CanvasRenderingContext2D=CanvasRenderingContext2D_;CanvasGradient=CanvasGradient_;CanvasPattern=CanvasPattern_})()}if(typeof(Autocompleter)=="undefined"){Autocompleter={}}Autocompleter.Json=Class.create(Autocompleter.Base,{initialize:function(element,update,lookupFunction,options){options=options||{};this.baseInitialize(element,update,options);this.lookupFunction=lookupFunction;this.options.choices=options.choices||10},getUpdatedChoices:function(){this.lookupFunction(this.getToken().toLowerCase(),this.updateJsonChoices.bind(this))},updateJsonChoices:function(choices){this.updateChoices("<ul>"+choices.slice(0,this.options.choices).map(this.jsonChoiceToListChoice.bind(this)).join("")+"</ul>")},jsonChoiceToListChoice:function(choice,mark){return"<li>"+choice.escapeHTML()+"</li>"}});Autocompleter.RateLimiting=function(){this.currentRequest=null;this.scheduledRequest=null};Autocompleter.RateLimiting.prototype={schedule:function(f,searchTerm,callback){this.scheduledRequest={f:f,searchTerm:searchTerm,callback:callback};this._sendRequest()},_sendRequest:function(){if(!this.currentRequest){this.currentRequest=this.scheduledRequest;this.scheduledRequest=null;this.currentRequest.f(this.currentRequest.searchTerm,this._callback.bind(this))}},_callback:function(data){try{this.currentRequest.callback(data)}catch(e){}this.currentRequest=null;if(this.scheduledRequest){this._sendRequest()}}};Autocompleter.Cache=Class.create({initialize:function(backendLookup,options){this.cache=new Hash();this.backendLookup=backendLookup;this.rateLimiter=new Autocompleter.RateLimiting();this.options=Object.extend({choices:10,fuzzySearch:false},options||{})},lookup:function(term,callback){return this._lookupInCache(term,null,callback)||this.rateLimiter.schedule(this.backendLookup,term,this._storeInCache.curry(term,callback).bind(this))},_lookupInCache:function(fullTerm,partialTerm,callback){partialTerm=partialTerm||fullTerm;var result=this.cache.get(partialTerm);if(!result){if(partialTerm.length>1){return this._lookupInCache(fullTerm,partialTerm.substr(0,partialTerm.length-1),callback)}else{return false}}else{if(fullTerm!=partialTerm){var hasMore=result.length>0&&result[result.length-1].more===true;result=this._localSearch(result,fullTerm);if(!hasMore){this._storeInCache(fullTerm,null,result)}else{if(result.length<this.options.choices){return false}}}if(result.length>0&&result[result.length-1].more!==undefined){result=result.slice(0,result.length-1)}callback(result.slice(0,this.options.choices));return true}},_localSearch:function(data,term){var exp=new RegExp(this.options.fuzzySearch?term.gsub(/./,".*#{0}"):RegExp.escape(term),"i"),foundItems=[];var item=null,name=null;for(var i=0,len=data.length;i<len;++i){item=data[i];if(exp.test(item)){foundItems.push(item)}}return foundItems},_storeInCache:function(term,callback,data){this.cache.set(term,data);if(callback){var items=data.slice(0,this.options.choices);if(items.length>1&&items[items.length-1].more!==undefined){items=items.slice(0,items.length-1)}callback(items)}}});Autocompleter.MultiValue=Class.create({options:$H({}),element:null,dataFetcher:null,createSelectedElement:function(id,title){var closeLink=new Element("a",{className:"close"}).update("×");closeLink.observe("click",function(e){this.removeEntry(e.element().up("li"));e.stop()}.bind(this));var hiddenValueField=new Element("input",{type:"hidden",name:this.name+"[]",value:id,style:"display: none;"});return new Element("li",{className:"choice",choice_id:id}).insert((""+title).escapeHTML()).insert(closeLink).insert(hiddenValueField)},initialize:function(element,dataFetcher,values,options){this.options=options||{};var outputElement=$(element);this.name=outputElement.name;this.form=outputElement.up("form");this.dataFetcher=dataFetcher;this.active=false;this.acceptNewValues=this.options.acceptNewValues||false;this.newValueChecker=this.options.newValueChecker||(function(){return true});this.options.frequency=this.options.frequency||0.4;this.options.minChars=this.options.minChars||2;this.options.tabindex=this.options.tabindex||outputElement.readAttribute("tabindex")||"";this.options.onShow=this.options.onShow||function(element,update){if(!update.style.position||update.style.position=="absolute"){update.style.position="absolute";try{update.clonePosition(element,{setHeight:false,offsetTop:element.offsetHeight})}catch(e){}}Effect.Appear(update,{duration:0.15})};this.options.onHide=this.options.onHide||function(element,update){new Effect.Fade(update,{duration:0.15})};this.searchField=new Element("input",{type:"text",autocomplete:"off",tabindex:this.options.tabindex});this.searchFieldItem=new Element("li",{className:"search_field_item"}).update(this.searchField);this.holder=new Element("ul",{className:"multi_value_field",style:outputElement.readAttribute("style")}).update(this.searchFieldItem);outputElement.insert({before:this.holder});outputElement.remove();this.choicesHolderList=new Element("ul");this.choicesHolder=new Element("div",{className:"autocomplete",style:"position: absolute;"}).update(this.choicesHolderList);this.holder.insert({after:this.choicesHolder});this.choicesHolder.hide();Event.observe(this.holder,"click",Form.Element.focus.curry(this.searchField));Event.observe(this.searchField,"keydown",this.onSearchFieldKeyDown.bindAsEventListener(this));if(this.acceptNewValues){Event.observe(this.searchField,"keyup",this.onSearchFieldKeyUp.bindAsEventListener(this));Event.observe(this.searchField,"blur",this.onSearchFieldBlur.bindAsEventListener(this))}Event.observe(this.searchField,"focus",this.getUpdatedChoices.bindAsEventListener(this));Event.observe(this.searchField,"focus",this.show.bindAsEventListener(this));Event.observe(this.searchField,"blur",this.hide.bindAsEventListener(this));this.setEmptyValue();(values||[]).each(function(value){this.addEntry(this.getValue(value),this.getTitle(value))},this)},show:function(){if(!this.choicesHolderList.empty()){if(Element.getStyle(this.choicesHolder,"display")=="none"){this.options.onShow(this.holder,this.choicesHolder)}}},hide:function(){this.stopIndicator();if(Element.getStyle(this.choicesHolder,"display")!="none"){this.options.onHide(this.element,this.choicesHolder)}if(this.iefix){Element.hide(this.iefix)}},onSearchFieldKeyDown:function(event){if(this.active){switch(event.keyCode){case Event.KEY_TAB:case Event.KEY_RETURN:this.selectEntry();event.stop();case Event.KEY_ESC:this.hide();this.active=false;event.stop();return;case Event.KEY_LEFT:case Event.KEY_RIGHT:return;case Event.KEY_UP:this.markPrevious();this.render();event.stop();return;case Event.KEY_DOWN:this.markNext();this.render();event.stop();return}}else{if(event.keyCode==Event.KEY_TAB||event.keyCode==Event.KEY_RETURN||(Prototype.Browser.WebKit>0&&!event.keyCode)){return}else{if(event.keyCode==Event.KEY_BACKSPACE){if(event.element().getValue().blank()){var tag=event.element().up("li.search_field_item").previous("li.choice");if(tag){this.removeEntry(tag)}}}}}this.changed=true;this.hasFocus=true;if(this.observer){clearTimeout(this.observer)}this.observer=setTimeout(this.onObserverEvent.bind(this),this.options.frequency*1000)},onSearchFieldKeyUp:function(event){var newValue="",fieldValue,separatorIndex;if(event.keyCode==188||event.keyCode==32||event.keyCode==13){fieldValue=$F(event.element());separatorIndex=fieldValue.length;if(event.keyCode==188){separatorIndex=fieldValue.indexOf(",")}else{if(event.keyCode==32){separatorIndex=fieldValue.indexOf(" ")}}newValue=fieldValue.substr(0,separatorIndex).toLowerCase().strip()}if(!newValue.blank()&&this.newValueChecker(newValue,event)){this.addEntry(newValue,newValue);event.element().value=fieldValue.substring(separatorIndex+1,fieldValue.length)}},onSearchFieldBlur:function(event){this.addNewValueFromSearchField.bind(this).delay(0.1,event.element())},addNewValueFromSearchField:function(searchFieldElement){var newValue=$F(searchFieldElement).strip();if(!newValue.blank()){this.addEntry(newValue,newValue);searchFieldElement.value=""}},onObserverEvent:function(){this.changed=false;this.tokenBounds=null;if(this.getToken().length>=this.options.minChars){this.getUpdatedChoices()}else{this.active=false;this.hide()}},getToken:function(){return this.searchField.value.toLowerCase()},markPrevious:function(){if(this.index>0){this.index--}else{this.index=this.entryCount-1}},markNext:function(){if(this.index<this.entryCount-1){this.index++}else{this.index=0}},getEntry:function(index){return this.choicesHolderList.childNodes[index]},getCurrentEntry:function(){return this.getEntry(this.index)},selectEntry:function(){this.active=false;var element=this.getCurrentEntry();this.addEntry(element.choiceId,element.textContent||element.innerText);this.searchField.clear();this.searchField.focus()},addEntry:function(id,title){title=title||id;if(!this.selectedEntries().include(""+id)){this.searchFieldItem.insert({before:this.createSelectedElement(id,title)})}var emptyValueField=this.emptyValueElement();if(emptyValueField){emptyValueField.remove()}},removeEntry:function(entryElement){entryElement=Object.isElement(entryElement)?entryElement:this.holder.down("li[choice_id="+entryElement+"]");if(entryElement){entryElement.remove();if(this.selectedEntries().length===0){this.setEmptyValue()}}},clear:function(){this.holder.select("li.choice").each(function(e){this.removeEntry(e)},this)},setEmptyValue:function(){if(!this.emptyValueElement()){this.form.insert(new Element("input",{type:"hidden",name:this.name,className:"emptyValueField"}))}},emptyValueElement:function(){return this.form.down("input.emptyValueField[name='"+this.name+"']")},selectedEntries:function(){return this.form.select("input[type=hidden][name='"+this.name+"[]']").map(function(entry){return entry.value})},startIndicator:function(){},stopIndicator:function(){},getUpdatedChoices:function(){this.startIndicator();var term=this.getToken();if(term.length>0){this.dataFetcher(term,this.updateChoices.curry(term).bind(this))}else{this.choicesHolderList.update()}},updateChoices:function(term,choices){if(!this.changed&&this.hasFocus){this.entryCount=choices.length;this.choicesHolderList.innerHTML="";choices.each(function(choice,choiceIndex){this.choicesHolderList.insert(this.createChoiceElement(this.getValue(choice),this.getTitle(choice),choiceIndex,term))}.bind(this));for(var i=0;i<this.entryCount;i++){var entry=this.getEntry(i);entry.choiceIndex=i;this.addObservers(entry)}this.stopIndicator();this.index=0;if(this.entryCount==1&&this.options.autoSelect){this.selectEntry();this.hide()}else{this.render()}}},addObservers:function(element){Event.observe(element,"mouseover",this.onHover.bindAsEventListener(this));Event.observe(element,"click",this.onClick.bindAsEventListener(this))},onHover:function(event){var element=Event.findElement(event,"LI");if(this.index!=element.autocompleteIndex){this.index=element.autocompleteIndex;this.render()}Event.stop(event)},onClick:function(event){var element=Event.findElement(event,"LI");this.index=element.autocompleteIndex;this.selectEntry();this.hide()},createChoiceElement:function(id,title,choiceIndex,searchTerm){var node=new Element("li",{choice_id:id});node.innerHTML=(""+title).escapeHTML();node.choiceId=id;node.autocompleteIndex=choiceIndex;return node},render:function(){if(this.entryCount>0){for(var i=0;i<this.entryCount;i++){var addOrRemove=this.index==i?"addClassName":"removeClassName";Element[addOrRemove](this.getEntry(i),"selected")}if(this.hasFocus){this.show();this.active=true}}else{this.active=false;this.hide()}},getTitle:function(obj){return Object.isArray(obj)?obj[0]:obj},getValue:function(obj){return Object.isArray(obj)?obj[1]:obj}});(function(){function qa(a,b){a||(a={});try{for(var c in b){a[c]=b[c]}return a}catch(e){}}function oa(a,b){return parseInt(a,b||10)}function Kb(a){return typeof a=="string"}function Eb(a){return typeof a=="object"}function ac(a){return typeof a=="number"}function mc(a,b){for(var c=a.length;c--;){if(a[c]==b){a.splice(c,1);break}}}function J(a){return a!==Ra&&a!==null}function za(a,b,c){var d,e;if(Kb(b)){if(J(c)){a.setAttribute(b,c)}else{if(a&&a.getAttribute){e=a.getAttribute(b)}}}else{if(J(b)&&Eb(b)){for(d in b){a.setAttribute(d,b[d])}}}return e}function nc(a){if(!a||a.constructor!=Array){a=[a]}return a}function y(){var a=arguments,b,c,d=a.length;for(b=0;b<d;b++){c=a[b];if(typeof c!=="undefined"&&c!==null){return c}}}function Wd(a){var b="",c;for(c in a){b+=Ad(c)+":"+a[c]+";"}return b}function Ia(a,b){if(Ac){if(b&&b.opacity!==Ra){b.filter="alpha(opacity="+b.opacity*100+")"}}qa(a.style,b)}function fb(a,b,c,d,e){a=Aa.createElement(a);b&&qa(a,b);e&&Ia(a,{padding:0,border:nb,margin:0});c&&Ia(a,c);d&&d.appendChild(a);return a}function bc(a,b){Bc=y(a,b.animation)}function Bd(){var a=Sa.global.useUTC;Cc=a?Date.UTC:function(b,c,d,e,f,g){return(new Date(b,c,y(d,1),y(e,0),y(f,0),y(g,0))).getTime()};bd=a?"getUTCMinutes":"getMinutes";cd=a?"getUTCHours":"getHours";dd=a?"getUTCDay":"getDay";oc=a?"getUTCDate":"getDate";Dc=a?"getUTCMonth":"getMonth";Ec=a?"getUTCFullYear":"getFullYear";Cd=a?"setUTCMinutes":"setMinutes";Dd=a?"setUTCHours":"setHours";ed=a?"setUTCDate":"setDate";Ed=a?"setUTCMonth":"setMonth";Fd=a?"setUTCFullYear":"setFullYear"}function Fc(a){Gc||(Gc=fb(Lb));a&&Gc.appendChild(a);Gc.innerHTML=""}function xb(a,b){var c=function(){};c.prototype=new a;qa(c.prototype,b);return c}function Gd(a,b,c,d){var e=Sa.lang;a=a;var f=isNaN(b=cb(b))?2:b;b=c===undefined?e.decimalPoint:c;d=d===undefined?e.thousandsSep:d;e=a<0?"-":"";c=oa(a=cb(+a||0).toFixed(f))+"";var g=(g=c.length)>3?g%3:0;return e+(g?c.substr(0,g)+d:"")+c.substr(g).replace(/(\d{3})(?=\d)/g,"$1"+d)+(f?b+cb(a-c).toFixed(f).slice(2):"")}function Hc(){}function Hd(a,b){function c(m,h){function x(l,p){this.pos=l;this.minor=p;this.isNew=true;p||this.addLabel()}function w(l){if(l){this.options=l;this.id=l.id}return this}function O(){var l=[],p=[],r;Ta=u=null;Z=[];t(Ba,function(o){r=false;t(["xAxis","yAxis"],function(la){if(o.isCartesian&&(la=="xAxis"&&ma||la=="yAxis"&&!ma)&&(o.options[la]==h.index||o.options[la]===Ra&&h.index===0)){o[la]=s;Z.push(o);r=true}});if(!o.visible&&v.ignoreHiddenSeries){r=false}if(r){var T,Y,G,B,ia;if(!ma){T=o.options.stacking;Ic=T=="percent";if(T){B=o.type+y(o.options.stack,"");ia="-"+B;o.stackKey=B;Y=l[B]||[];l[B]=Y;G=p[ia]||[];p[ia]=G}if(Ic){Ta=0;u=99}}if(o.isCartesian){t(o.data,function(la){var C=la.x,na=la.y,S=na<0,$=S?G:Y;S=S?ia:B;if(Ta===null){Ta=u=la[H]}if(ma){if(C>u){u=C}else{if(C<Ta){Ta=C}}}else{if(J(na)){if(T){$[C]=J($[C])?$[C]+na:na}na=$?$[C]:na;la=y(la.low,na);if(!Ic){if(na>u){u=na}else{if(la<Ta){Ta=la}}}if(T){ea[S]||(ea[S]={});ea[S][C]={total:na,cum:na}}}}});if(/(area|column|bar)/.test(o.type)&&!ma){if(Ta>=0){Ta=0;Id=true}else{if(u<0){u=0;Jd=true}}}}}})}function ja(l,p){var r;Fb=p?1:Ua.pow(10,ob(Ua.log(l)/Ua.LN10));r=l/Fb;if(!p){p=[1,2,2.5,5,10];if(h.allowDecimals===false){if(Fb==1){p=[1,2,5,10]}else{if(Fb<=0.1){p=[1/Fb]}}}}for(var o=0;o<p.length;o++){l=p[o];if(r<=(p[o]+(p[o+1]||p[o]))/2){break}}l*=Fb;return l}function L(l){var p;p=l;if(J(Fb)){p=(Fb<1?fa(1/Fb):1)*10;p=fa(l*p)/p}return p}function ga(){var l,p,r,o,T=h.tickInterval,Y=h.tickPixelInterval;l=h.maxZoom||(ma?pb(m.smallestInterval*5,u-Ta):null);A=M?wa:sa;if(Mb){r=m[ma?"xAxis":"yAxis"][h.linkedTo];o=r.getExtremes();K=y(o.min,o.dataMin);P=y(o.max,o.dataMax)}else{K=y(pa,h.min,Ta);P=y(Na,h.max,u)}if(P-K<l){o=(l-P+K)/2;K=Ca(K-o,y(h.min,K-o),Ta);P=pb(K+l,y(h.max,K+l),u)}if(!Va&&!Ic&&!Mb&&J(K)&&J(P)){l=P-K||1;if(!J(h.min)&&!J(pa)&&Vb&&(Ta<0||!Id)){K-=l*Vb}if(!J(h.max)&&!J(Na)&&Kd&&(u>0||!Jd)){P+=l*Kd}}Wa=K==P?1:Mb&&!T&&Y==r.options.tickPixelInterval?r.tickInterval:y(T,Va?1:(P-K)*Y/A);if(!N&&!J(h.tickInterval)){Wa=ja(Wa)}s.tickInterval=Wa;Jc=h.minorTickInterval==="auto"&&Wa?Wa/5:h.minorTickInterval;if(N){ra=[];T=Sa.global.useUTC;var G=1000/qb,B=60000/qb,ia=3600000/qb;Y=86400000/qb;l=604800000/qb;o=2592000000/qb;var la=31556952000/qb,C=[["second",G,[1,2,5,10,15,30]],["minute",B,[1,2,5,10,15,30]],["hour",ia,[1,2,3,4,6,8,12]],["day",Y,[1,2]],["week",l,[1,2]],["month",o,[1,2,3,4,6]],["year",la,null]],na=C[6],S=na[1],$=na[2];for(r=0;r<C.length;r++){na=C[r];S=na[1];$=na[2];if(C[r+1]){if(Wa<=(S*$[$.length-1]+C[r+1][1])/2){break}}}if(S==la&&Wa<5*S){$=[1,2,5]}C=ja(Wa/S,$);$=new Date(K*qb);$.setMilliseconds(0);if(S>=G){$.setSeconds(S>=B?0:C*ob($.getSeconds()/C))}if(S>=B){$[Cd](S>=ia?0:C*ob($[bd]()/C))}if(S>=ia){$[Dd](S>=Y?0:C*ob($[cd]()/C))}if(S>=Y){$[ed](S>=o?1:C*ob($[oc]()/C))}if(S>=o){$[Ed](S>=la?0:C*ob($[Dc]()/C));p=$[Ec]()}if(S>=la){p-=p%C;$[Fd](p)}S==l&&$[ed]($[oc]()-$[dd]()+h.startOfWeek);r=1;p=$[Ec]();G=$.getTime()/qb;B=$[Dc]();for(ia=$[oc]();G<P&&r<wa;){ra.push(G);if(S==la){G=Cc(p+r*C,0)/qb}else{if(S==o){G=Cc(p,B+r*C)/qb}else{if(!T&&(S==Y||S==l)){G=Cc(p,B,ia+r*C*(S==Y?1:7))}else{G+=S*C}}}r++}ra.push(G);Kc=h.dateTimeLabelFormats[na[0]]}else{r=ob(K/Wa)*Wa;p=fd(P/Wa)*Wa;ra=[];for(r=L(r);r<=p;){ra.push(r);r=L(r+Wa)}}if(!Mb){if(Va||ma&&m.hasColumn){p=(Va?1:Wa)*0.5;if(Va||!J(y(h.min,pa))){K-=p}if(Va||!J(y(h.max,Na))){P+=p}}p=ra[0];r=ra[ra.length-1];if(h.startOnTick){K=p}else{K>p&&ra.shift()}if(h.endOnTick){P=r}else{P<r&&ra.pop()}Gb||(Gb={x:0,y:0});if(!N&&ra.length>Gb[H]){Gb[H]=ra.length}}}function Ea(){var l,p;gb=K;cc=P;O();ga();ha=D;D=A/(P-K||1);if(!ma){for(l in ea){for(p in ea[l]){ea[l][p].cum=ea[l][p].total}}}if(!s.isDirty){s.isDirty=K!=gb||P!=cc}}function ua(l){l=(new w(l)).render();Nb.push(l);return l}function bb(){var l=h.title,p=h.alternateGridColor,r=h.lineWidth,o,T,Y=m.hasRendered,G=Y&&J(gb)&&!isNaN(gb);o=Z.length&&J(K)&&J(P);A=M?wa:sa;D=A/(P-K||1);xa=M?V:rb;if(o||Mb){if(Jc&&!Va){for(o=K+(ra[0]-K)%Jc;o<=P;o+=Jc){Wb[o]||(Wb[o]=new x(o,true));G&&Wb[o].isNew&&Wb[o].render(null,true);Wb[o].isActive=true;Wb[o].render()}}t(ra,function(B,ia){if(!Mb||B>=K&&B<=P){G&&sb[B].isNew&&sb[B].render(ia,true);sb[B].isActive=true;sb[B].render(ia)}});p&&t(ra,function(B,ia){if(ia%2===0&&B<P){dc[B]||(dc[B]=new w);dc[B].options={from:B,to:ra[ia+1]!==Ra?ra[ia+1]:P,color:p};dc[B].render();dc[B].isActive=true}});Y||t((h.plotLines||[]).concat(h.plotBands||[]),function(B){Nb.push((new w(B)).render())})}t([sb,Wb,dc],function(B){for(var ia in B){if(B[ia].isActive){B[ia].isActive=false}else{B[ia].destroy();delete B[ia]}}});if(r){o=V+(Oa?wa:0)+Q;T=Pa-rb-(Oa?sa:0)+Q;o=aa.crispLine([Za,M?V:o,M?T:ba,Da,M?Xa-Ab:o,M?T:Pa-rb],r);if(Fa){Fa.animate({d:o})}else{Fa=aa.path(o).attr({stroke:h.lineColor,"stroke-width":r,zIndex:7}).add()}}if(s.axisTitle){o=M?V:ba;r=oa(l.style.fontSize||12);o={low:o+(M?0:A),middle:o+A/2,high:o+(M?A:0)}[l.align];r=(M?ba+sa:V)+(M?1:-1)*(Oa?-1:1)*gd+(E==2?r:0);s.axisTitle[Y?"animate":"attr"]({x:M?o:r+(Oa?wa:0)+Q+(l.x||0),y:M?r-(Oa?sa:0)+Q:o+(l.y||0)})}s.isDirty=false}function Ja(l){for(var p=Nb.length;p--;){Nb[p].id==l&&Nb[p].destroy()}}var ma=h.isX,Oa=h.opposite,M=Ga?!ma:ma,E=M?Oa?0:2:Oa?1:3,ea={};h=ya(ma?Lc:hd,[Xd,Yd,Ld,Zd][E],h);var s=this,N=h.type=="datetime",Q=h.offset||0,H=ma?"x":"y",A,D,ha,xa=M?V:rb,va,Ka,tb,Hb,Fa,Ta,u,Z,pa,Na,P=null,K=null,gb,cc,Vb=h.minPadding,Kd=h.maxPadding,Mb=J(h.linkedTo),Id,Jd,Ic,Md=h.events,id,Nb=[],Wa,Jc,Fb,ra,sb={},Wb={},dc={},ec,fc,gd,Kc,Va=h.categories,$d=h.labels.formatter||function(){var l=this.value;return Kc?Mc(Kc,l):Wa%1000000===0?l/1000000+"M":Wa%1000===0?l/1000+"k":!Va&&l>=1000?Gd(l,0):l},Nc=M&&h.labels.staggerLines,Xb=h.reversed,Yb=Va&&h.tickmarkPlacement=="between"?0.5:0;x.prototype={addLabel:function(){var l=this.pos,p=h.labels,r=!(l==K&&!y(h.showFirstLabel,1)||l==P&&!y(h.showLastLabel,0)),o=Va&&M&&Va.length&&!p.step&&!p.staggerLines&&!p.rotation&&wa/Va.length||!M&&wa/2,T=this.label;l=$d.call({isFirst:l==ra[0],isLast:l==ra[ra.length-1],dateTimeLabelFormat:Kc,value:Va&&Va[l]?Va[l]:l});o=o&&{width:o-2*(p.padding||10)+$a};o=qa(o,p.style);if(T===Ra){this.label=J(l)&&r&&p.enabled?aa.text(l,0,0).attr({align:p.align,rotation:p.rotation}).css(o).add(tb):null}else{T&&T.attr({text:l}).css(o)}},getLabelSize:function(){var l=this.label;return l?(this.labelBBox=l.getBBox())[M?"height":"width"]:0},render:function(l,p){var r=!this.minor,o=this.label,T=this.pos,Y=h.labels,G=this.gridLine,B=r?h.gridLineWidth:h.minorGridLineWidth,ia=r?h.gridLineColor:h.minorGridLineColor,la=r?h.gridLineDashStyle:h.minorGridLineDashStyle,C=this.mark,na=r?h.tickLength:h.minorTickLength,S=r?h.tickWidth:h.minorTickWidth||0,$=r?h.tickColor:h.minorTickColor,pc=r?h.tickPosition:h.minorTickPosition;r=Y.step;var hb=p&&Oc||Pa,Ob;Ob=M?va(T+Yb,null,null,p)+xa:V+Q+(Oa?(p&&jd||Xa)-Ab-V:0);hb=M?hb-rb+Q-(Oa?sa:0):hb-va(T+Yb,null,null,p)-xa;if(B){T=Ka(T+Yb,B,p);if(G===Ra){G={stroke:ia,"stroke-width":B};if(la){G.dashstyle=la}this.gridLine=G=B?aa.path(T).attr(G).add(Hb):null}G&&T&&G.animate({d:T})}if(S){if(pc=="inside"){na=-na}if(Oa){na=-na}B=aa.crispLine([Za,Ob,hb,Da,Ob+(M?0:-na),hb+(M?na:0)],S);if(C){C.animate({d:B})}else{this.mark=aa.path(B).attr({stroke:$,"stroke-width":S}).add(tb)}}if(o){Ob=Ob+Y.x-(Yb&&M?Yb*D*(Xb?-1:1):0);hb=hb+Y.y-(Yb&&!M?Yb*D*(Xb?1:-1):0);J(Y.y)||(hb+=parseInt(o.styles.lineHeight)*0.9-o.getBBox().height/2);if(Nc){hb+=l%Nc*16}if(r){o[l%r?"hide":"show"]()}o[this.isNew?"attr":"animate"]({x:Ob,y:hb})}this.isNew=false},destroy:function(){for(var l in this){this[l]&&this[l].destroy&&this[l].destroy()}}};w.prototype={render:function(){var l=this,p=l.options,r=p.label,o=l.label,T=p.width,Y=p.to,G,B=p.from,ia=p.dashStyle,la=l.svgElem,C=[],na,S,$=p.color;S=p.zIndex;var pc=p.events;if(T){C=Ka(p.value,T);p={stroke:$,"stroke-width":T};if(ia){p.dashstyle=ia}}else{if(J(B)&&J(Y)){B=Ca(B,K);Y=pb(Y,P);G=Ka(Y);if((C=Ka(B))&&G){C.push(G[4],G[5],G[1],G[2])}else{C=null}p={fill:$}}else{return}}if(J(S)){p.zIndex=S}if(la){if(C){la.animate({d:C},null,la.onGetPath)}else{la.hide();la.onGetPath=function(){la.show()}}}else{if(C&&C.length){l.svgElem=la=aa.path(C).attr(p).add();if(pc){ia=function(hb){la.on(hb,function(Ob){pc[hb].apply(l,[Ob])})};for(na in pc){ia(na)}}}}if(r&&J(r.text)&&C&&C.length&&wa>0&&sa>0){r=ya({align:M&&G&&"center",x:M?!G&&4:10,verticalAlign:!M&&G&&"middle",y:M?G?16:10:G?6:-4,rotation:M&&!G&&90},r);if(!o){l.label=o=aa.text(r.text,0,0).attr({align:r.textAlign||r.align,rotation:r.rotation,zIndex:S}).css(r.style).add()}G=[C[1],C[4],C[6]||C[1]];C=[C[2],C[5],C[7]||C[2]];na=pb.apply(Ua,G);S=pb.apply(Ua,C);o.align(r,false,{x:na,y:S,width:Ca.apply(Ua,G)-na,height:Ca.apply(Ua,C)-S});o.show()}else{o&&o.hide()}return l},destroy:function(){for(var l in this){this[l]&&this[l].destroy&&this[l].destroy();delete this[l]}mc(Nb,this)}};va=function(l,p,r,o){var T=1,Y=0,G=o?ha:D;o=o?gb:K;G||(G=D);if(r){T*=-1;Y=A}if(Xb){T*=-1;Y-=T*A}if(p){if(Xb){l=A-l}l=l/G+o}else{l=T*(l-o)*G+Y}return l};Ka=function(l,p,r){var o,T,Y;l=va(l,null,null,r);var G=r&&Oc||Pa,B=r&&jd||Xa,ia;r=T=fa(l+xa);o=Y=fa(G-l-xa);if(isNaN(l)){ia=true}else{if(M){o=ba;Y=G-rb;if(r<V||r>V+wa){ia=true}}else{r=V;T=B-Ab;if(o<ba||o>ba+sa){ia=true}}}return ia?null:aa.crispLine([Za,r,o,Da,T,Y],p||0)};if(Ga&&ma&&Xb===Ra){Xb=true}qa(s,{addPlotBand:ua,addPlotLine:ua,adjustTickAmount:function(){if(Gb&&!N&&!Va&&!Mb){var l=ec,p=ra.length;ec=Gb[H];if(p<ec){for(;ra.length<ec;){ra.push(L(ra[ra.length-1]+Wa))}D*=(p-1)/(ec-1);P=ra[ra.length-1]}if(J(l)&&ec!=l){s.isDirty=true}}},categories:Va,getExtremes:function(){return{min:K,max:P,dataMin:Ta,dataMax:u}},getPlotLinePath:Ka,getThreshold:function(l){if(K>l){l=K}else{if(P<l){l=P}}return va(l,0,1)},isXAxis:ma,options:h,plotLinesAndBands:Nb,getOffset:function(){var l=Z.length&&J(K)&&J(P),p=0,r=0,o=h.title,T=h.labels,Y=[-1,1,1,-1][E];if(!tb){tb=aa.g("axis").attr({zIndex:7}).add();Hb=aa.g("grid").attr({zIndex:1}).add()}fc=0;if(l||Mb){t(ra,function(B){if(sb[B]){sb[B].addLabel()}else{sb[B]=new x(B)}if(E===0||E==2||{1:"left",3:"right"}[E]==T.align){fc=Ca(sb[B].getLabelSize(),fc)}});if(Nc){fc+=(Nc-1)*16}}else{for(var G in sb){sb[G].destroy();delete sb[G]}}if(o&&o.text){if(!s.axisTitle){s.axisTitle=aa.text(o.text,0,0).attr({zIndex:7,rotation:o.rotation||0,align:o.textAlign||{low:"left",middle:"center",high:"right"}[o.align]}).css(o.style).add()}p=s.axisTitle.getBBox()[M?"height":"width"];r=y(o.margin,M?5:10)}Q=Y*(h.offset||Pb[E]);gd=fc+(E!=2&&fc&&Y*h.labels[M?"y":"x"])+r;Pb[E]=Ca(Pb[E],gd+p+Y*Q)},render:bb,setCategories:function(l,p){s.categories=Va=l;t(Z,function(r){r.translate();r.setTooltipPoints(true)});s.isDirty=true;y(p,true)&&m.redraw()},setExtremes:function(l,p,r,o){r=y(r,true);La(s,"setExtremes",{min:l,max:p},function(){pa=l;Na=p;r&&m.redraw(o)})},setScale:Ea,setTickPositions:ga,translate:va,redraw:function(){gc.resetTracker&&gc.resetTracker();bb();t(Nb,function(l){l.render()});t(Z,function(l){l.isDirty=true})},removePlotBand:Ja,removePlotLine:Ja,reversed:Xb,stacks:ea});for(id in Md){Qa(s,id,Md[id])}Ea()}function d(){var m={};return{add:function(h,x,w,O){if(!m[h]){x=aa.text(x,0,0).css(a.toolbar.itemStyle).align({align:"right",x:-Ab-20,y:ba+30}).on("click",O).attr({align:"right",zIndex:20}).add();m[h]=x}},remove:function(h){Fc(m[h].element);m[h]=null}}}function e(m){function h(){var H=this.points||nc(this),A=H[0].series.xAxis,D=this.x;A=A&&A.options.type=="datetime";var ha=Kb(D)||A,xa;xa=ha?['<span style="font-size: 10px">',A?Mc("%A, %b %e, %Y",D):D,"</span><br/>"]:[];t(H,function(va){xa.push(va.point.tooltipFormatter(ha))});return xa.join("")}function x(H,A){E=ma?H:(2*E+H)/3;ea=ma?A:(ea+A)/2;s.translate(E,ea);kd=cb(H-E)>1||cb(A-ea)>1?function(){x(H,A)}:null}function w(){if(!ma){var H=q.hoverPoints;s.hide();t(ga,function(A){A&&A.hide()});H&&t(H,function(A){A.setState()});q.hoverPoints=null;ma=true}}var O,ja=m.borderWidth,L=m.crosshairs,ga=[],Ea=m.style,ua=m.shared,bb=oa(Ea.padding),Ja=ja+bb,ma=true,Oa,M,E=0,ea=0;Ea.padding=0;var s=aa.g("tooltip").attr({zIndex:8}).add(),N=aa.rect(Ja,Ja,0,0,m.borderRadius,ja).attr({fill:m.backgroundColor,"stroke-width":ja}).add(s).shadow(m.shadow),Q=aa.text("",bb+Ja,oa(Ea.fontSize)+bb+Ja).attr({zIndex:1}).css(Ea).add(s);s.hide();return{shared:ua,refresh:function(H){var A,D,ha,xa=0,va={},Ka=[];ha=H.tooltipPos;A=m.formatter||h;va=q.hoverPoints;var tb=function(Fa){return{series:Fa.series,point:Fa,x:Fa.category,y:Fa.y,percentage:Fa.percentage,total:Fa.total||Fa.stackTotal}};if(ua){va&&t(va,function(Fa){Fa.setState()});q.hoverPoints=H;t(H,function(Fa){Fa.setState(yb);xa+=Fa.plotY;Ka.push(tb(Fa))});D=H[0].plotX;xa=fa(xa)/H.length;va={x:H[0].category};va.points=Ka;H=H[0]}else{va=tb(H)}va=A.call(va);O=H.series;D=ua?D:H.plotX;xa=ua?xa:H.plotY;A=fa(ha?ha[0]:Ga?wa-xa:D);D=fa(ha?ha[1]:Ga?sa-D:xa);ha=ua||!H.series.isCartesian||hc(A,D);if(va===false||!ha){w()}else{if(ma){s.show();ma=false}Q.attr({text:va});ha=Q.getBBox();Oa=ha.width+2*bb;M=ha.height+2*bb;N.attr({width:Oa,height:M,stroke:m.borderColor||H.color||O.color||"#606060"});A=A-Oa+V-25;D=D-M+ba+10;if(A<7){A=7;D-=30}if(D<5){D=5}else{if(D+M>Pa){D=Pa-M-5}}x(fa(A-Ja),fa(D-Ja))}if(L){L=nc(L);D=L.length;for(var Hb;D--;){if(L[D]&&(Hb=H.series[D?"yAxis":"xAxis"])){A=Hb.getPlotLinePath(H[D?"y":"x"],1);if(ga[D]){ga[D].attr({d:A,visibility:Bb})}else{ha={"stroke-width":L[D].width||1,stroke:L[D].color||"#C0C0C0",zIndex:2};if(L[D].dashStyle){ha.dashstyle=L[D].dashStyle}ga[D]=aa.path(A).attr(ha).add()}}}}},hide:w}}function f(m,h){function x(E){var ea;E=E||ib.event;if(!E.target){E.target=E.srcElement}ea=E.touches?E.touches.item(0):E;if(E.type!="mousemove"||ib.opera){for(var s=ta,N={left:s.offsetLeft,top:s.offsetTop};s=s.offsetParent;){N.left+=s.offsetLeft;N.top+=s.offsetTop;if(s!=Aa.body&&s!=Aa.documentElement){N.left-=s.scrollLeft;N.top-=s.scrollTop}}qc=N}if(Ac){E.chartX=E.x;E.chartY=E.y}else{if(ea.layerX===Ra){E.chartX=ea.pageX-qc.left;E.chartY=ea.pageY-qc.top}else{E.chartX=E.layerX;E.chartY=E.layerY}}return E}function w(E){var ea={xAxis:[],yAxis:[]};t(ab,function(s){var N=s.translate,Q=s.isXAxis;ea[Q?"xAxis":"yAxis"].push({axis:s,value:N((Ga?!Q:Q)?E.chartX-V:sa-E.chartY+ba,true)})});return ea}function O(){var E=m.hoverSeries,ea=m.hoverPoint;ea&&ea.onMouseOut();E&&E.onMouseOut();rc&&rc.hide();ld=null}function ja(){if(ua){var E={xAxis:[],yAxis:[]},ea=ua.getBBox(),s=ea.x-V,N=ea.y-ba;if(Ea){t(ab,function(Q){var H=Q.translate,A=Q.isXAxis,D=Ga?!A:A,ha=H(D?s:sa-N-ea.height,true);H=H(D?s+ea.width:sa-N,true);E[A?"xAxis":"yAxis"].push({axis:Q,min:pb(ha,H),max:Ca(ha,H)})});La(m,"selection",E,md)}ua=ua.destroy()}m.mouseIsDown=nd=Ea=false;Cb(Aa,Ib?"touchend":"mouseup",ja)}var L,ga,Ea,ua,bb=v.zoomType,Ja=/x/.test(bb),ma=/y/.test(bb),Oa=Ja&&!Ga||ma&&Ga,M=ma&&!Ga||Ja&&Ga;Pc=function(){if(Qc){Qc.translate(V,ba);Ga&&Qc.attr({width:m.plotWidth,height:m.plotHeight}).invert()}else{m.trackerGroup=Qc=aa.g("tracker").attr({zIndex:9}).add()}};Pc();if(h.enabled){m.tooltip=rc=e(h)}(function(){var E=true;ta.onmousedown=function(s){s=x(s);m.mouseIsDown=nd=true;L=s.chartX;ga=s.chartY;Qa(Aa,Ib?"touchend":"mouseup",ja)};var ea=function(s){if(!(s&&s.touches&&s.touches.length>1)){s=x(s);if(!Ib){s.returnValue=false}var N=s.chartX,Q=s.chartY,H=!hc(N-V,Q-ba);if(Ib&&s.type=="touchstart"){if(za(s.target,"isTracker")){m.runTrackerClick||s.preventDefault()}else{!ae&&!H&&s.preventDefault()}}if(H){E||O();if(N<V){N=V}else{if(N>V+wa){N=V+wa}}if(Q<ba){Q=ba}else{if(Q>ba+sa){Q=ba+sa}}}if(nd&&s.type!="touchstart"){if(Ea=Math.sqrt(Math.pow(L-N,2)+Math.pow(ga-Q,2))>10){if(ic&&(Ja||ma)&&hc(L-V,ga-ba)){ua||(ua=aa.rect(V,ba,Oa?1:wa,M?1:sa,0).attr({fill:"rgba(69,114,167,0.25)",zIndex:7}).add())}if(ua&&Oa){N=N-L;ua.attr({width:cb(N),x:(N>0?0:N)+L})}if(ua&&M){Q=Q-ga;ua.attr({height:cb(Q),y:(Q>0?0:Q)+ga})}}}else{if(!H){var A;Q=m.hoverPoint;N=m.hoverSeries;var D,ha,xa=Xa,va=Ga?s.chartY:s.chartX-V;if(rc&&h.shared){A=[];D=Ba.length;for(ha=0;ha<D;ha++){if(Ba[ha].visible&&Ba[ha].tooltipPoints.length){s=Ba[ha].tooltipPoints[va];s._dist=cb(va-s.plotX);xa=pb(xa,s._dist);A.push(s)}}for(D=A.length;D--;){A[D]._dist>xa&&A.splice(D,1)}if(A.length&&A[0].plotX!=ld){rc.refresh(A);ld=A[0].plotX}}if(N&&N.tracker){(s=N.tooltipPoints[va])&&s!=Q&&s.onMouseOver()}}}return(E=H)||!ic}};ta.onmousemove=ea;Qa(ta,"mouseleave",O);ta.ontouchstart=function(s){if(Ja||ma){ta.onmousedown(s)}ea(s)};ta.ontouchmove=ea;ta.ontouchend=function(){Ea&&O()};ta.onclick=function(s){var N=m.hoverPoint;s=x(s);s.cancelBubble=true;if(!Ea){if(N&&za(s.target,"isTracker")){var Q=N.plotX,H=N.plotY;qa(N,{pageX:qc.left+V+(Ga?wa-H:Q),pageY:qc.top+ba+(Ga?sa-Q:H)});La(N.series,"click",qa(s,{point:N}));N.firePointEvent("click",s)}else{qa(s,w(s));hc(s.chartX-V,s.chartY-ba)&&La(m,"click",s)}}Ea=false}})();Nd=setInterval(function(){kd&&kd()},32);qa(this,{zoomX:Ja,zoomY:ma,resetTracker:O})}function g(m){var h=m.type||v.type||v.defaultSeriesType,x=ub[h],w=q.hasRendered;if(w){if(Ga&&h=="column"){x=ub.bar}else{if(!Ga&&h=="bar"){x=ub.column}}}h=new x;h.init(q,m);if(!w&&h.inverted){Ga=true}if(h.isCartesian){ic=h.isCartesian}Ba.push(h);return h}function i(){v.alignTicks!==false&&t(ab,function(m){m.adjustTickAmount()});Gb=null}function k(m){var h=q.isDirtyLegend,x,w=q.isDirtyBox,O=Ba.length,ja=O,L=q.clipRect;for(bc(m,q);ja--;){m=Ba[ja];if(m.isDirty&&m.options.stacking){x=true;break}}if(x){for(ja=O;ja--;){m=Ba[ja];if(m.options.stacking){m.isDirty=true}}}t(Ba,function(ga){if(ga.isDirty){ga.cleanData();ga.getSegments();if(ga.options.legendType=="point"){h=true}}});if(h&&od.renderLegend){od.renderLegend();q.isDirtyLegend=false}if(ic){if(!Rc){Gb=null;t(ab,function(ga){ga.setScale()})}i();sc();t(ab,function(ga){if(ga.isDirty||w){ga.redraw();w=true}})}if(w){pd();Pc();if(L){Sc(L);L.animate({width:q.plotSizeX,height:q.plotSizeY})}}t(Ba,function(ga){if(ga.isDirty&&ga.visible&&(!ga.isCartesian||ga.xAxis)){ga.redraw()}});gc&&gc.resetTracker&&gc.resetTracker();La(q,"redraw")}function j(){var m=a.xAxis||{},h=a.yAxis||{},x;m=nc(m);t(m,function(w,O){w.index=O;w.isX=true});h=nc(h);t(h,function(w,O){w.index=O});ab=m.concat(h);q.xAxis=[];q.yAxis=[];ab=jc(ab,function(w){x=new c(q,w);q[x.isXAxis?"xAxis":"yAxis"].push(x);return x});i()}function n(m,h){kc=ya(a.title,m);tc=ya(a.subtitle,h);t([["title",m,kc],["subtitle",h,tc]],function(x){var w=x[0],O=q[w],ja=x[1];x=x[2];if(O&&ja){O.destroy();O=null}if(x&&x.text&&!O){q[w]=aa.text(x.text,0,0).attr({align:x.align,"class":"highcharts-"+w,zIndex:1}).css(x.style).add().align(x,false,uc)}})}function z(){jb=v.renderTo;Od=Zb+qd++;if(Kb(jb)){jb=Aa.getElementById(jb)}jb.innerHTML="";if(!jb.offsetWidth){Qb=jb.cloneNode(0);Ia(Qb,{position:lc,top:"-9999px",display:""});Aa.body.appendChild(Qb)}Tc=(Qb||jb).offsetWidth;vc=(Qb||jb).offsetHeight;q.chartWidth=Xa=v.width||Tc||600;q.chartHeight=Pa=v.height||(vc>19?vc:400);q.container=ta=fb(Lb,{className:"highcharts-container"+(v.className?" "+v.className:""),id:Od},qa({position:Pd,overflow:vb,width:Xa+$a,height:Pa+$a,textAlign:"left"},v.style),Qb||jb);q.renderer=aa=v.forExport?new Uc(ta,Xa,Pa,true):new Qd(ta,Xa,Pa);var m,h;if(Rd&&ta.getBoundingClientRect){m=function(){Ia(ta,{left:0,top:0});h=ta.getBoundingClientRect();Ia(ta,{left:-h.left%1+$a,top:-h.top%1+$a})};m();Qa(ib,"resize",m);Qa(q,"destroy",function(){Cb(ib,"resize",m)})}}function F(){function m(){var x=v.width||jb.offsetWidth,w=v.height||jb.offsetHeight;if(x&&w){if(x!=Tc||w!=vc){clearTimeout(h);h=setTimeout(function(){rd(x,w,false)},100)}Tc=x;vc=w}}var h;Qa(window,"resize",m);Qa(q,"destroy",function(){Cb(window,"resize",m)})}function W(){var m=a.labels,h=a.credits,x;n();od=q.legend=new be(q);sc();t(ab,function(w){w.setTickPositions(true)});i();sc();pd();ic&&t(ab,function(w){w.render()});if(!q.seriesGroup){q.seriesGroup=aa.g("series-group").attr({zIndex:3}).add()}t(Ba,function(w){w.translate();w.setTooltipPoints();w.render()});m.items&&t(m.items,function(){var w=qa(m.style,this.style),O=oa(w.left)+V,ja=oa(w.top)+ba+12;delete w.left;delete w.top;aa.text(this.html,O,ja).attr({zIndex:2}).css(w).add()});if(!q.toolbar){q.toolbar=d(q)}if(h.enabled&&!q.credits){x=h.href;aa.text(h.text,0,0).on("click",function(){if(x){location.href=x}}).attr({align:h.position.align,zIndex:8}).css(h.style).add().align(h.position)}Pc();q.hasRendered=true;if(Qb){jb.appendChild(ta);Fc(Qb)}}function ca(){var m=Ba.length,h=ta&&ta.parentNode;La(q,"destroy");Cb(ib,"unload",ca);Cb(q);for(t(ab,function(x){Cb(x)});m--;){Ba[m].destroy()}if(ta){ta.innerHTML="";Cb(ta);h&&h.removeChild(ta);ta=null}if(aa){aa.alignedObjects=null}clearInterval(Nd);for(m in q){delete q[m]}}function ka(){if(!wc&&ib==ib.top&&Aa.readyState!="complete"){Aa.attachEvent("onreadystatechange",function(){Aa.detachEvent("onreadystatechange",ka);ka()})}else{z();sd();td();t(a.series||[],function(m){g(m)});q.inverted=Ga=y(Ga,a.chart.inverted);j();q.render=W;q.tracker=gc=new f(q,a.tooltip);W();La(q,"load");b&&b.apply(q,[q]);t(q.callbacks,function(m){m.apply(q,[q])})}}Lc=ya(Lc,Sa.xAxis);hd=ya(hd,Sa.yAxis);Sa.xAxis=Sa.yAxis=null;a=ya(Sa,a);var v=a.chart,I=v.margin;I=Eb(I)?I:[I,I,I,I];var da=y(v.marginTop,I[0]),X=y(v.marginRight,I[1]),U=y(v.marginBottom,I[2]),R=y(v.marginLeft,I[3]),Ha=v.spacingTop,Ya=v.spacingRight,ud=v.spacingBottom,Vc=v.spacingLeft,uc,kc,tc,ba,Ab,rb,V,Pb,jb,Qb,ta,Od,Tc,vc,Xa,Pa,jd,Oc,Wc,vd,wd,Xc,q=this,ae=(I=v.events)&&!!I.click,xd,hc,rc,nd,$b,Sd,yd,sa,wa,gc,Qc,Pc,od,Rb,Sb,qc,ic=v.showAxes,Rc=0,ab=[],Gb,Ba=[],Ga,aa,kd,Nd,ld,pd,sc,sd,td,rd,md,Td,be=function(m){function h(u,Z){var pa=u.legendItem,Na=u.legendLine,P=u.legendSymbol,K=M.color,gb=Z?L.itemStyle.color:K;K=Z?u.color:K;pa&&pa.css({fill:gb});Na&&Na.attr({stroke:K});P&&P.attr({stroke:K,fill:K})}function x(u,Z,pa){var Na=u.legendItem,P=u.legendLine,K=u.legendSymbol;u=u.checkbox;Na&&Na.attr({x:Z,y:pa});P&&P.translate(Z,pa-4);K&&K.attr({x:Z+K.xOff,y:pa+K.yOff});if(u){u.x=Z;u.y=pa}}function w(){t(bb,function(u){var Z=u.checkbox;Z&&Ia(Z,{left:Ka.attr("translateX")+u.legendItemWidth+Z.x-40+$a,top:Ka.attr("translateY")+Z.y-11+$a})})}function O(u){var Z,pa,Na,P,K,gb=u.legendItem;P=u.series||u;if(!gb){K=/^(bar|pie|area|column)$/.test(P.type);u.legendItem=gb=aa.text(L.labelFormatter.call(u),0,0).css(u.visible?ma:M).on("mouseover",function(){u.setState(yb);gb.css(Oa)}).on("mouseout",function(){gb.css(u.visible?ma:M);u.setState()}).on("click",function(){var Vb=function(){u.setVisible()};u.firePointEvent?u.firePointEvent("legendItemClick",null,Vb):La(u,"legendItemClick",null,Vb)}).attr({zIndex:2}).add(Ka);if(!K&&u.options&&u.options.lineWidth){var cc=u.options;P={"stroke-width":cc.lineWidth,zIndex:2};if(cc.dashStyle){P.dashstyle=cc.dashStyle}u.legendLine=aa.path([Za,-Ea-ua,0,Da,-ua,0]).attr(P).add(Ka)}if(K){Z=aa.rect(pa=-Ea-ua,Na=-11,Ea,12,2).attr({"stroke-width":0,zIndex:3}).add(Ka)}else{if(u.options&&u.options.marker&&u.options.marker.enabled){Z=aa.symbol(u.symbol,pa=-Ea/2-ua,Na=-4,u.options.marker.radius).attr(u.pointAttr[db]).attr({zIndex:3}).add(Ka)}}if(Z){Z.xOff=pa;Z.yOff=Na}u.legendSymbol=Z;h(u,u.visible);if(u.options&&u.options.showCheckbox){u.checkbox=fb("input",{type:"checkbox",checked:u.selected,defaultChecked:u.selected},L.itemCheckboxStyle,ta);Qa(u.checkbox,"click",function(Vb){La(u,"checkboxClick",{checked:Vb.target.checked},function(){u.select()})})}}Z=gb.getBBox();pa=u.legendItemWidth=L.itemWidth||Ea+ua+Z.width+ea;D=Z.height;if(ga&&Q-N+pa>(Hb||Xa-2*E-N)){Q=N;H+=D}A=H;x(u,Q,H);if(ga){Q+=pa}else{H+=D}tb=Hb||Ca(ga?Q-N:pa,tb);bb.push(u)}function ja(){Q=N;H=s;A=tb=0;bb=[];Ka||(Ka=aa.g("legend").attr({zIndex:7}).add());Ta&&Fa.reverse();t(Fa,function(Na){if(Na.options.showInLegend){t(Na.options.legendType=="point"?Na.data:[Na],O)}});Ta&&Fa.reverse();Rb=Hb||tb;Sb=A-s+D;if(xa||va){Rb+=2*E;Sb+=2*E;if(ha){Rb>0&&Sb>0&&ha.animate(ha.crisp(null,null,null,Rb,Sb))}else{ha=aa.rect(0,0,Rb,Sb,L.borderRadius,xa||0).attr({stroke:L.borderColor,"stroke-width":xa||0,fill:va||nb}).add(Ka).shadow(L.shadow)}ha[bb.length?"show":"hide"]()}for(var u=["left","right","top","bottom"],Z,pa=4;pa--;){Z=u[pa];if(Ja[Z]&&Ja[Z]!="auto"){L[pa<2?"align":"verticalAlign"]=Z;L[pa<2?"x":"y"]=oa(Ja[Z])*(pa%2?-1:1)}}Ka.align(qa(L,{width:Rb,height:Sb}),true,uc);Rc||w()}var L=m.options.legend;if(L.enabled){var ga=L.layout=="horizontal",Ea=L.symbolWidth,ua=L.symbolPadding,bb,Ja=L.style,ma=L.itemStyle,Oa=L.itemHoverStyle,M=L.itemHiddenStyle,E=oa(Ja.padding),ea=20,s=18,N=4+E+Ea+ua,Q,H,A,D=0,ha,xa=L.borderWidth,va=L.backgroundColor,Ka,tb,Hb=L.width,Fa=m.series,Ta=L.reversed;ja();Qa(m,"endResize",w);return{colorizeItem:h,destroyItem:function(u){var Z=u.checkbox;t(["legendItem","legendLine","legendSymbol"],function(pa){u[pa]&&u[pa].destroy()});Z&&Fc(u.checkbox)},renderLegend:ja}}};hc=function(m,h){return m>=0&&m<=wa&&h>=0&&h<=sa};Td=function(){La(q,"selection",{resetSelection:true},md);q.toolbar.remove("zoom")};md=function(m){var h=Sa.lang,x=q.pointCount<100;q.toolbar.add("zoom",h.resetZoom,h.resetZoomTitle,Td);!m||m.resetSelection?t(ab,function(w){w.setExtremes(null,null,false,x)}):t(m.xAxis.concat(m.yAxis),function(w){var O=w.axis;if(q.tracker[O.isXAxis?"zoomX":"zoomY"]){O.setExtremes(w.min,w.max,false,x)}});k()};sc=function(){var m=a.legend,h=y(m.margin,10),x=m.x,w=m.y,O=m.align,ja=m.verticalAlign,L;sd();if((q.title||q.subtitle)&&!J(da)){if(L=Ca(q.title&&!kc.floating&&!kc.verticalAlign&&kc.y||0,q.subtitle&&!tc.floating&&!tc.verticalAlign&&tc.y||0)){ba=Ca(ba,L+y(kc.margin,15)+Ha)}}if(m.enabled&&!m.floating){if(O=="right"){J(X)||(Ab=Ca(Ab,Rb-x+h+Ya))}else{if(O=="left"){J(R)||(V=Ca(V,Rb+x+h+Vc))}else{if(ja=="top"){J(da)||(ba=Ca(ba,Sb+w+h+Ha))}else{if(ja=="bottom"){J(U)||(rb=Ca(rb,Sb-w+h+ud))}}}}}ic&&t(ab,function(ga){ga.getOffset()});J(R)||(V+=Pb[3]);J(da)||(ba+=Pb[0]);J(U)||(rb+=Pb[2]);J(X)||(Ab+=Pb[1]);td()};rd=function(m,h,x){var w=q.title,O=q.subtitle;Rc+=1;bc(x,q);Oc=Pa;jd=Xa;Xa=fa(m);Pa=fa(h);Ia(ta,{width:Xa+$a,height:Pa+$a});aa.setSize(Xa,Pa,x);wa=Xa-V-Ab;sa=Pa-ba-rb;Gb=null;t(ab,function(ja){ja.isDirty=true;ja.setScale()});t(Ba,function(ja){ja.isDirty=true});q.isDirtyLegend=true;q.isDirtyBox=true;sc();w&&w.align(null,null,uc);O&&O.align(null,null,uc);k(x);Oc=null;La(q,"resize");setTimeout(function(){La(q,"endResize",null,function(){Rc-=1})},Bc&&Bc.duration||500)};td=function(){q.plotLeft=V=fa(V);q.plotTop=ba=fa(ba);q.plotWidth=wa=fa(Xa-V-Ab);q.plotHeight=sa=fa(Pa-ba-rb);q.plotSizeX=Ga?sa:wa;q.plotSizeY=Ga?wa:sa;uc={x:Vc,y:Ha,width:Xa-Vc-Ya,height:Pa-Ha-ud}};sd=function(){ba=y(da,Ha);Ab=y(X,Ya);rb=y(U,ud);V=y(R,Vc);Pb=[0,0,0,0]};pd=function(){var m=v.borderWidth||0,h=v.backgroundColor,x=v.plotBackgroundColor,w=v.plotBackgroundImage,O,ja={x:V,y:ba,width:wa,height:sa};O=m+(v.shadow?8:0);if(m||h){if(Wc){Wc.animate(Wc.crisp(null,null,null,Xa-O,Pa-O))}else{Wc=aa.rect(O/2,O/2,Xa-O,Pa-O,v.borderRadius,m).attr({stroke:v.borderColor,"stroke-width":m,fill:h||nb}).add().shadow(v.shadow)}}if(x){if(vd){vd.animate(ja)}else{vd=aa.rect(V,ba,wa,sa,0).attr({fill:x}).add().shadow(v.plotShadow)}}if(w){if(wd){wd.animate(ja)}else{wd=aa.image(w,V,ba,wa,sa).add()}}if(v.plotBorderWidth){if(Xc){Xc.animate(Xc.crisp(null,V,ba,wa,sa))}else{Xc=aa.rect(V,ba,wa,sa,0,v.plotBorderWidth).attr({stroke:v.plotBorderColor,"stroke-width":v.plotBorderWidth,zIndex:4}).add()}}q.isDirtyBox=false};Yc=Jb=0;Qa(ib,"unload",ca);v.reflow!==false&&Qa(q,"load",F);if(I){for(xd in I){Qa(q,xd,I[xd])}}q.options=a;q.series=Ba;q.addSeries=function(m,h,x){var w;if(m){bc(x,q);h=y(h,true);La(q,"addSeries",{options:m},function(){w=g(m);w.isDirty=true;q.isDirtyLegend=true;h&&q.redraw()})}return w};q.animation=y(v.animation,true);q.destroy=ca;q.get=function(m){var h,x,w;for(h=0;h<ab.length;h++){if(ab[h].options.id==m){return ab[h]}}for(h=0;h<Ba.length;h++){if(Ba[h].options.id==m){return Ba[h]}}for(h=0;h<Ba.length;h++){w=Ba[h].data;for(x=0;x<w.length;x++){if(w[x].id==m){return w[x]}}}return null};q.getSelectedPoints=function(){var m=[];t(Ba,function(h){m=m.concat(zd(h.data,function(x){return x.selected}))});return m};q.getSelectedSeries=function(){return zd(Ba,function(m){return m.selected})};q.hideLoading=function(){Zc($b,{opacity:0},{duration:a.loading.hideDuration,complete:function(){Ia($b,{display:nb})}});yd=false};q.isInsidePlot=hc;q.redraw=k;q.setSize=rd;q.setTitle=n;q.showLoading=function(m){var h=a.loading;if(!$b){$b=fb(Lb,{className:"highcharts-loading"},qa(h.style,{left:V+$a,top:ba+$a,width:wa+$a,height:sa+$a,zIndex:10,display:nb}),ta);Sd=fb("span",null,h.labelStyle,$b)}Sd.innerHTML=m||a.lang.loading;if(!yd){Ia($b,{opacity:0,display:""});Zc($b,{opacity:h.style.opacity},{duration:h.showDuration});yd=true}};q.pointCount=0;ka()}var Aa=document,ib=window,Ua=Math,fa=Ua.round,ob=Ua.floor,fd=Ua.ceil,Ca=Ua.max,pb=Ua.min,cb=Ua.abs,kb=Ua.cos,zb=Ua.sin,Tb=Ua.PI,Ud=Tb*2/360,xc=navigator.userAgent,Ac=/msie/i.test(xc)&&!ib.opera,yc=Aa.documentMode==8,ce=/AppleWebKit/.test(xc),Rd=/Firefox/.test(xc),wc=!!Aa.createElementNS&&!!Aa.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,Ib="ontouchstart" in Aa.documentElement,Jb,Yc,de={},qd=0,qb=1,Gc,Sa,Mc,Bc,$c,Ra,Lb="div",lc="absolute",Pd="relative",vb="hidden",Zb="highcharts-",Bb="visible",$a="px",nb="none",Za="M",Da="L",Vd="rgba(192,192,192,"+(wc?0.000001:0.002)+")",db="",yb="hover",Cc,bd,cd,dd,oc,Dc,Ec,Cd,Dd,ed,Ed,Fd,eb=ib.HighchartsAdapter,Db=eb||{},t=Db.each,zd=Db.grep,jc=Db.map,ya=Db.merge,Ad=Db.hyphenate,Qa=Db.addEvent,Cb=Db.removeEvent,La=Db.fireEvent,Zc=Db.animate,Sc=Db.stop,ub={};eb&&eb.init&&eb.init();if(!eb&&ib.jQuery){var lb=jQuery;t=function(a,b){for(var c=0,d=a.length;c<d;c++){if(b.call(a[c],a[c],c,a)===false){return c}}};zd=lb.grep;jc=function(a,b){for(var c=[],d=0,e=a.length;d<e;d++){c[d]=b.call(a[d],a[d],d,a)}return c};ya=function(){var a=arguments;return lb.extend(true,null,a[0],a[1],a[2],a[3])};Ad=function(a){return a.replace(/([A-Z])/g,function(b,c){return"-"+c.toLowerCase()})};Qa=function(a,b,c){lb(a).bind(b,c)};Cb=function(a,b,c){var d=Aa.removeEventListener?"removeEventListener":"detachEvent";if(Aa[d]&&!a[d]){a[d]=function(){}}lb(a).unbind(b,c)};La=function(a,b,c,d){var e=lb.Event(b),f="detached"+b;qa(e,c);if(a[b]){a[f]=a[b];a[b]=null}lb(a).trigger(e);if(a[f]){a[b]=a[f];a[f]=null}d&&!e.isDefaultPrevented()&&d(e)};Zc=function(a,b,c){var d=lb(a);if(b.d){a.toD=b.d;b.d=1}d.stop();d.animate(b,c)};Sc=function(a){lb(a).stop()};lb.extend(lb.easing,{easeOutQuad:function(a,b,c,d,e){return -d*(b/=e)*(b-2)+c}});var ee=jQuery.fx.step._default,fe=jQuery.fx.prototype.cur;lb.fx.step._default=function(a){var b=a.elem;b.attr?b.attr(a.prop,a.now):ee.apply(this,arguments)};lb.fx.step.d=function(a){var b=a.elem;if(!a.started){var c=$c.init(b,b.d,b.toD);a.start=c[0];a.end=c[1];a.started=true}b.attr("d",$c.step(a.start,a.end,a.pos,b.toD))};lb.fx.prototype.cur=function(){var a=this.elem;return a.attr?a.attr(this.prop):fe.apply(this,arguments)}}$c={init:function(a,b,c){b=b||"";var d=a.shift,e=b.indexOf("C")>-1,f=e?7:3,g;b=b.split(" ");c=[].concat(c);var i,k,j=function(n){for(g=n.length;g--;){n[g]==Za&&n.splice(g+1,0,n[g+1],n[g+2],n[g+1],n[g+2])}};if(e){j(b);j(c)}if(a.isArea){i=b.splice(b.length-6,6);k=c.splice(c.length-6,6)}if(d){c=[].concat(c).splice(0,f).concat(c);a.shift=false}if(b.length){for(a=c.length;b.length<a;){d=[].concat(b).splice(b.length-f,f);if(e){d[f-6]=d[f-2];d[f-5]=d[f-1]}b=b.concat(d)}}if(i){b=b.concat(i);c=c.concat(k)}return[b,c]},step:function(a,b,c,d){var e=[],f=a.length;if(c==1){e=d}else{if(f==b.length&&c<1){for(;f--;){d=parseFloat(a[f]);e[f]=isNaN(d)?a[f]:c*parseFloat(b[f]-d)+d}}else{e=b}}return e}};eb={enabled:true,align:"center",x:0,y:15,style:{color:"#666",fontSize:"11px",lineHeight:"14px"}};Sa={colors:["#4572A7","#AA4643","#89A54E","#80699B","#3D96AE","#DB843D","#92A8CD","#A47D7C","#B5CA92"],symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:","},global:{useUTC:true},chart:{borderColor:"#4572A7",borderRadius:5,defaultSeriesType:"line",ignoreHiddenSeries:true,spacingTop:10,spacingRight:10,spacingBottom:15,spacingLeft:10,style:{fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Verdana, Arial, Helvetica, sans-serif',fontSize:"12px"},backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0"},title:{text:"Chart title",align:"center",y:15,style:{color:"#3E576F",fontSize:"16px"}},subtitle:{text:"",align:"center",y:30,style:{color:"#6D869F"}},plotOptions:{line:{allowPointSelect:false,showCheckbox:false,animation:{duration:1000},events:{},lineWidth:2,shadow:true,marker:{enabled:true,lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:ya(eb,{enabled:false,y:-6,formatter:function(){return this.y}}),showInLegend:true,states:{hover:{marker:{}},select:{marker:{}}},stickyTracking:true}},labels:{style:{position:lc,color:"#3E576F"}},legend:{enabled:true,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderWidth:1,borderColor:"#909090",borderRadius:5,shadow:false,style:{padding:"5px"},itemStyle:{cursor:"pointer",color:"#3E576F"},itemHoverStyle:{cursor:"pointer",color:"#000000"},itemHiddenStyle:{color:"#C0C0C0"},itemCheckboxStyle:{position:lc,width:"13px",height:"13px"},symbolWidth:16,symbolPadding:5,verticalAlign:"bottom",x:0,y:0},loading:{hideDuration:100,labelStyle:{fontWeight:"bold",position:Pd,top:"1em"},showDuration:100,style:{position:lc,backgroundColor:"white",opacity:0.5,textAlign:"center"}},tooltip:{enabled:true,backgroundColor:"rgba(255, 255, 255, .85)",borderWidth:2,borderRadius:5,shadow:true,snap:Ib?25:10,style:{color:"#333333",fontSize:"12px",padding:"5px",whiteSpace:"nowrap"}},toolbar:{itemStyle:{color:"#4572A7",cursor:"pointer"}},credits:{enabled:true,text:"Highcharts.com",href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#909090",fontSize:"10px"}}};var Lc={dateTimeLabelFormats:{second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:false,gridLineColor:"#C0C0C0",labels:eb,lineColor:"#C0D0E0",lineWidth:1,max:null,min:null,minPadding:0.01,maxPadding:0.01,minorGridLineColor:"#E0E0E0",minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",startOfWeek:1,startOnTick:false,tickColor:"#C0D0E0",tickLength:5,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",tickWidth:1,title:{align:"middle",style:{color:"#6D869F",fontWeight:"bold"}},type:"linear"},hd=ya(Lc,{endOnTick:true,gridLineWidth:1,tickPixelInterval:72,showLastLabel:true,labels:{align:"right",x:-8,y:3},lineWidth:0,maxPadding:0.05,minPadding:0.05,startOnTick:true,tickWidth:0,title:{rotation:270,text:"Y-values"}}),Zd={labels:{align:"right",x:-8,y:null},title:{rotation:270}},Yd={labels:{align:"left",x:8,y:null},title:{rotation:90}},Ld={labels:{align:"center",x:0,y:14},title:{rotation:0}},Xd=ya(Ld,{labels:{y:-5}}),wb=Sa.plotOptions;eb=wb.line;wb.spline=ya(eb);wb.scatter=ya(eb,{lineWidth:0,states:{hover:{lineWidth:0}}});wb.area=ya(eb,{});wb.areaspline=ya(wb.area);wb.column=ya(eb,{borderColor:"#FFFFFF",borderWidth:1,borderRadius:0,groupPadding:0.2,marker:null,pointPadding:0.1,minPointLength:0,states:{hover:{brightness:0.1,shadow:false},select:{color:"#C0C0C0",borderColor:"#000000",shadow:false}}});wb.bar=ya(wb.column,{dataLabels:{align:"left",x:5,y:0}});wb.pie=ya(eb,{borderColor:"#FFFFFF",borderWidth:1,center:["50%","50%"],colorByPoint:true,dataLabels:{distance:30,enabled:true,formatter:function(){return this.point.name},y:5},legendType:"point",marker:null,size:"75%",showInLegend:false,slicedOffset:10,states:{hover:{brightness:0.1,shadow:false}}});Bd();var Ub=function(a){var b=[],c;(function(d){if(c=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/.exec(d)){b=[oa(c[1]),oa(c[2]),oa(c[3]),parseFloat(c[4],10)]}else{if(c=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(d)){b=[oa(c[1],16),oa(c[2],16),oa(c[3],16),1]}}})(a);return{get:function(d){return b&&!isNaN(b[0])?d=="rgb"?"rgb("+b[0]+","+b[1]+","+b[2]+")":d=="a"?b[3]:"rgba("+b.join(",")+")":a},brighten:function(d){if(ac(d)&&d!==0){var e;for(e=0;e<3;e++){b[e]+=oa(d*255);if(b[e]<0){b[e]=0}if(b[e]>255){b[e]=255}}}return this},setOpacity:function(d){b[3]=d;return this}}};Mc=function(a,b,c){function d(F){return F.toString().replace(/^([0-9])$/,"0$1")}if(!J(b)||isNaN(b)){return"Invalid date"}a=y(a,"%Y-%m-%d %H:%M:%S");b=new Date(b*qb);var e=b[cd](),f=b[dd](),g=b[oc](),i=b[Dc](),k=b[Ec](),j=Sa.lang,n=j.weekdays;j=j.months;b={a:n[f].substr(0,3),A:n[f],d:d(g),e:g,b:j[i].substr(0,3),B:j[i],m:d(i+1),y:k.toString().substr(2,2),Y:k,H:d(e),I:d(e%12||12),l:e%12||12,M:d(b[bd]()),p:e<12?"AM":"PM",P:e<12?"am":"pm",S:d(b.getSeconds())};for(var z in b){a=a.replace("%"+z,b[z])}return c?a.substr(0,1).toUpperCase()+a.substr(1):a};Hc.prototype={init:function(a,b){this.element=Aa.createElementNS("http://www.w3.org/2000/svg",b);this.renderer=a},animate:function(a,b,c){if(b=y(b,Bc,true)){b=ya(b);if(c){b.complete=c}Zc(this,a,b)}else{this.attr(a);c&&c()}},attr:function(a,b){var c,d,e,f,g=this.element,i=g.nodeName,k=this.renderer,j,n=this.shadows,z,F=this;if(Kb(a)&&J(b)){c=a;a={};a[c]=b}if(Kb(a)){c=a;if(i=="circle"){c={x:"cx",y:"cy"}[c]||c}else{if(c=="strokeWidth"){c="stroke-width"}}F=za(g,c)||this[c]||0;if(c!="d"&&c!="visibility"){F=parseFloat(F)}}else{for(c in a){j=false;d=a[c];if(c=="d"){if(d&&d.join){d=d.join(" ")}if(/(NaN| {2}|^$)/.test(d)){d="M 0 0"}this.d=d}else{if(c=="x"&&i=="text"){for(e=0;e<g.childNodes.length;e++){f=g.childNodes[e];za(f,"x")==za(g,"x")&&za(f,"x",d)}if(this.rotation){za(g,"transform","rotate("+this.rotation+" "+d+" "+oa(a.y||za(g,"y"))+")")}}else{if(c=="fill"){d=k.color(d,g,c)}else{if(i=="circle"&&(c=="x"||c=="y")){c={x:"cx",y:"cy"}[c]||c}else{if(c=="translateX"||c=="translateY"||c=="rotation"||c=="verticalAlign"){this[c]=d;this.updateTransform();j=true}else{if(c=="stroke"){d=k.color(d,g,c)}else{if(c=="dashstyle"){c="stroke-dasharray";if(d){d=d.toLowerCase().replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(e=d.length;e--;){d[e]=oa(d[e])*a["stroke-width"]}d=d.join(",")}}else{if(c=="isTracker"){this[c]=d}else{if(c=="width"){d=oa(d)}else{if(c=="align"){c="text-anchor";d={left:"start",center:"middle",right:"end"}[d]}}}}}}}}}}if(c=="strokeWidth"){c="stroke-width"}if(ce&&c=="stroke-width"&&d===0){d=0.000001}if(this.symbolName&&/^(x|y|r|start|end|innerR)/.test(c)){if(!z){this.symbolAttr(a);z=true}j=true}if(n&&/^(width|height|visibility|x|y|d)$/.test(c)){for(e=n.length;e--;){za(n[e],c,d)}}if(c=="text"){this.textStr=d;this.added&&k.buildText(this)}else{j||za(g,c,d)}}}return F},symbolAttr:function(a){var b=this;t(["x","y","r","start","end","width","height","innerR"],function(c){b[c]=y(a[c],b[c])});b.attr({d:b.renderer.symbols[b.symbolName](b.x,b.y,b.r,{start:b.start,end:b.end,width:b.width,height:b.height,innerR:b.innerR})})},clip:function(a){return this.attr("clip-path","url("+this.renderer.url+"#"+a.id+")")},crisp:function(a,b,c,d,e){var f,g={},i={},k;a=a||this.strokeWidth||0;k=a%2/2;i.x=ob(b||this.x||0)+k;i.y=ob(c||this.y||0)+k;i.width=ob((d||this.width||0)-2*k);i.height=ob((e||this.height||0)-2*k);i.strokeWidth=a;for(f in i){if(this[f]!=i[f]){this[f]=g[f]=i[f]}}return g},css:function(a){var b=this.element;b=a&&a.width&&b.nodeName=="text";if(a&&a.color){a.fill=a.color}this.styles=a=qa(this.styles,a);if(Ac&&!wc){b&&delete a.width;Ia(this.element,a)}else{this.attr({style:Wd(a)})}b&&this.added&&this.renderer.buildText(this);return this},on:function(a,b){var c=b;if(Ib&&a=="click"){a="touchstart";c=function(d){d.preventDefault();b()}}this.element["on"+a]=c;return this},translate:function(a,b){return this.attr({translateX:a,translateY:b})},invert:function(){this.inverted=true;this.updateTransform();return this},updateTransform:function(){var a=this.translateX||0,b=this.translateY||0,c=this.inverted,d=this.rotation,e=[];if(c){a+=this.attr("width");b+=this.attr("height")}if(a||b){e.push("translate("+a+","+b+")")}if(c){e.push("rotate(90) scale(-1,1)")}else{d&&e.push("rotate("+d+" "+this.x+" "+this.y+")")}e.length&&za(this.element,"transform",e.join(" "))},toFront:function(){var a=this.element;a.parentNode.appendChild(a);return this},align:function(a,b,c){if(a){this.alignOptions=a;this.alignByTranslate=b;c||this.renderer.alignedObjects.push(this)}else{a=this.alignOptions;b=this.alignByTranslate}c=y(c,this.renderer);var d=a.align,e=a.verticalAlign,f=(c.x||0)+(a.x||0),g=(c.y||0)+(a.y||0),i={};if(/^(right|center)$/.test(d)){f+=(c.width-(a.width||0))/{right:1,center:2}[d]}i[b?"translateX":"x"]=fa(f);if(/^(bottom|middle)$/.test(e)){g+=(c.height-(a.height||0))/({bottom:1,middle:2}[e]||1)}i[b?"translateY":"y"]=fa(g);this[this.placed?"animate":"attr"](i);this.placed=true;return this},getBBox:function(){var a,b,c,d=this.rotation,e=d*Ud;try{a=qa({},this.element.getBBox())}catch(f){a={width:0,height:0}}b=a.width;c=a.height;if(d){a.width=cb(c*zb(e))+cb(b*kb(e));a.height=cb(c*kb(e))+cb(b*zb(e))}return a},show:function(){return this.attr({visibility:Bb})},hide:function(){return this.attr({visibility:vb})},add:function(a){var b=this.renderer,c=a||b,d=c.element||b.box,e=d.childNodes,f=this.element,g=za(f,"zIndex");this.parentInverted=a&&a.inverted;this.textStr!==undefined&&b.buildText(this);if(g){c.handleZ=true;g=oa(g)}if(c.handleZ){for(c=0;c<e.length;c++){a=e[c];b=za(a,"zIndex");if(a!=f&&(oa(b)>g||!J(g)&&J(b))){d.insertBefore(f,a);return this}}}d.appendChild(f);this.added=true;return this},destroy:function(){var a=this.element||{},b=this.shadows,c=a.parentNode,d;a.onclick=a.onmouseout=a.onmouseover=a.onmousemove=null;Sc(this);c&&c.removeChild(a);b&&t(b,function(e){(c=e.parentNode)&&c.removeChild(e)});mc(this.renderer.alignedObjects,this);for(d in this){delete this[d]}return null},empty:function(){for(var a=this.element,b=a.childNodes,c=b.length;c--;){a.removeChild(b[c])}},shadow:function(a){var b=[],c,d=this.element,e=this.parentInverted?"(-1,-1)":"(1,1)";if(a){for(a=1;a<=3;a++){c=d.cloneNode(0);za(c,{isShadow:"true",stroke:"rgb(0, 0, 0)","stroke-opacity":0.05*a,"stroke-width":7-2*a,transform:"translate"+e,fill:nb});d.parentNode.insertBefore(c,d);b.push(c)}this.shadows=b}return this}};var Uc=function(){this.init.apply(this,arguments)};Uc.prototype={init:function(a,b,c,d){var e=location,f;this.Element=Hc;f=this.createElement("svg").attr({xmlns:"http://www.w3.org/2000/svg",version:"1.1"});a.appendChild(f.element);this.box=f.element;this.boxWrapper=f;this.alignedObjects=[];this.url=Ac?"":e.href.replace(/#.*?$/,"");this.defs=this.createElement("defs").add();this.forExport=d;this.setSize(b,c,false)},createElement:function(a){var b=new this.Element;b.init(this,a);return b},buildText:function(a){for(var b=a.element,c=y(a.textStr,"").toString().replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br[^>]?>/g),d=b.childNodes,e=/style="([^"]+)"/,f=/href="([^"]+)"/,g=za(b,"x"),i=a.styles,k=Rd&&i&&i.HcDirection=="rtl"&&!this.forExport,j,n=i&&oa(i.width),z=i&&i.lineHeight,F,W=d.length;W--;){b.removeChild(d[W])}n&&!a.added&&this.box.appendChild(b);t(c,function(ca,ka){var v,I=0,da;ca=ca.replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||");v=ca.split("|||");t(v,function(X){if(X!==""||v.length==1){var U={},R=Aa.createElementNS("http://www.w3.org/2000/svg","tspan");e.test(X)&&za(R,"style",X.match(e)[1].replace(/(;| |^)color([ :])/,"$1fill$2"));if(f.test(X)){za(R,"onclick",'location.href="'+X.match(f)[1]+'"');Ia(R,{cursor:"pointer"})}X=X.replace(/<(.|\n)*?>/g,"")||" ";if(k){j=[];for(W=X.length;W--;){j.push(X.charAt(W))}X=j.join("")}R.appendChild(Aa.createTextNode(X));if(I){U.dx=3}else{U.x=g}if(!I){if(ka){da=oa(window.getComputedStyle(F,null).getPropertyValue("line-height"));if(isNaN(da)){da=z||F.offsetHeight||18}za(R,"dy",da)}F=R}za(R,U);b.appendChild(R);I++;if(n){X=X.replace(/-/g,"- ").split(" ");for(var Ha,Ya=[];X.length||Ya.length;){Ha=b.getBBox().width;U=Ha>n;if(!U||X.length==1){X=Ya;Ya=[];if(X.length){R=Aa.createElementNS("http://www.w3.org/2000/svg","tspan");za(R,{x:g,dy:z||16});b.appendChild(R);if(Ha>n){n=Ha}}}else{R.removeChild(R.firstChild);Ya.unshift(X.pop())}R.appendChild(Aa.createTextNode(X.join(" ").replace(/- /g,"-")))}}}})})},crispLine:function(a,b){if(a[1]==a[4]){a[1]=a[4]=fa(a[1])+b%2/2}if(a[2]==a[5]){a[2]=a[5]=fa(a[2])+b%2/2}return a},path:function(a){return this.createElement("path").attr({d:a,fill:nb})},circle:function(a,b,c){a=Eb(a)?a:{x:a,y:b,r:c};return this.createElement("circle").attr(a)},arc:function(a,b,c,d,e,f){if(Eb(a)){b=a.y;c=a.r;d=a.innerR;e=a.start;f=a.end;a=a.x}return this.symbol("arc",a||0,b||0,c||0,{innerR:d||0,start:e||0,end:f||0})},rect:function(a,b,c,d,e,f){if(Eb(a)){b=a.y;c=a.width;d=a.height;e=a.r;a=a.x}e=this.createElement("rect").attr({rx:e,ry:e,fill:nb});return e.attr(e.crisp(f,a,b,Ca(c,0),Ca(d,0)))},setSize:function(a,b,c){var d=this.alignedObjects,e=d.length;this.width=a;this.height=b;for(this.boxWrapper[y(c,true)?"animate":"attr"]({width:a,height:b});e--;){d[e].align()}},g:function(a){return this.createElement("g").attr(J(a)&&{"class":Zb+a})},image:function(a,b,c,d,e){var f={preserveAspectRatio:nb};arguments.length>1&&qa(f,{x:b,y:c,width:d,height:e});f=this.createElement("image").attr(f);f.element.setAttributeNS("http://www.w3.org/1999/xlink","href",a);return f},symbol:function(a,b,c,d,e){var f,g=this.symbols[a];g=g&&g(b,c,d,e);var i=/^url\((.*?)\)$/;if(g){f=this.path(g);qa(f,{symbolName:a,x:b,y:c,r:d});e&&qa(f,e)}else{if(i.test(a)){a=a.match(i)[1];f=this.image(a).attr({x:b,y:c});fb("img",{onload:function(){var k=de[this.src]||[this.width,this.height];f.attr({width:k[0],height:k[1]}).translate(-fa(k[0]/2),-fa(k[1]/2))},src:a})}else{f=this.circle(b,c,d)}}return f},symbols:{square:function(a,b,c){c=0.707*c;return[Za,a-c,b-c,Da,a+c,b-c,a+c,b+c,a-c,b+c,"Z"]},triangle:function(a,b,c){return[Za,a,b-1.33*c,Da,a+c,b+0.67*c,a-c,b+0.67*c,"Z"]},"triangle-down":function(a,b,c){return[Za,a,b+1.33*c,Da,a-c,b-0.67*c,a+c,b-0.67*c,"Z"]},diamond:function(a,b,c){return[Za,a,b-c,Da,a+c,b,a,b+c,a-c,b,"Z"]},arc:function(a,b,c,d){var e=d.start,f=d.end-0.000001,g=d.innerR,i=kb(e),k=zb(e),j=kb(f);f=zb(f);d=d.end-e<Tb?0:1;return[Za,a+c*i,b+c*k,"A",c,c,0,d,1,a+c*j,b+c*f,Da,a+g*j,b+g*f,"A",g,g,0,d,0,a+g*i,b+g*k,"Z"]}},clipRect:function(a,b,c,d){var e=Zb+qd++,f=this.createElement("clipPath").attr({id:e}).add(this.defs);a=this.rect(a,b,c,d,0).add(f);a.id=e;return a},color:function(a,b,c){var d,e=/^rgba/;if(a&&a.linearGradient){var f=this;b=a.linearGradient;c=Zb+qd++;var g,i,k;g=f.createElement("linearGradient").attr({id:c,gradientUnits:"userSpaceOnUse",x1:b[0],y1:b[1],x2:b[2],y2:b[3]}).add(f.defs);t(a.stops,function(j){if(e.test(j[1])){d=Ub(j[1]);i=d.get("rgb");k=d.get("a")}else{i=j[1];k=1}f.createElement("stop").attr({offset:j[0],"stop-color":i,"stop-opacity":k}).add(g)});return"url("+this.url+"#"+c+")"}else{if(e.test(a)){d=Ub(a);za(b,c+"-opacity",d.get("a"));return d.get("rgb")}else{return a}}},text:function(a,b,c){var d=Sa.chart.style;b=fa(y(b,0));c=fa(y(c,0));a=this.createElement("text").attr({x:b,y:c,text:a}).css({"font-family":d.fontFamily,"font-size":d.fontSize});a.x=b;a.y=c;return a}};var Ma;if(!wc){var ge=xb(Hc,{init:function(a,b){var c=["<",b,' filled="f" stroked="f"'],d=["position: ",lc,";"];if(b=="shape"||b==Lb){d.push("left:0;top:0;width:10px;height:10px;")}if(yc){d.push("visibility: ",b==Lb?vb:Bb)}c.push(' style="',d.join(""),'"/>');if(b){c=b==Lb||b=="span"||b=="img"?c.join(""):a.prepVML(c);this.element=fb(c)}this.renderer=a},add:function(a){var b=this.renderer,c=this.element,d=b.box;d=a?a.element||a:d;a&&a.inverted&&b.invertChild(c,d);yc&&d.gVis==vb&&Ia(c,{visibility:vb});d.appendChild(c);this.added=true;this.alignOnAdd&&this.updateTransform();return this},attr:function(a,b){var c,d,e,f=this.element||{},g=f.style,i=f.nodeName,k=this.renderer,j=this.symbolName,n,z,F=this.shadows,W=this;if(Kb(a)&&J(b)){c=a;a={};a[c]=b}if(Kb(a)){c=a;W=c=="strokeWidth"||c=="stroke-width"?this.strokeweight:this[c]}else{for(c in a){d=a[c];n=false;if(j&&/^(x|y|r|start|end|width|height|innerR)/.test(c)){if(!z){this.symbolAttr(a);z=true}n=true}else{if(c=="d"){d=d||[];this.d=d.join(" ");e=d.length;for(n=[];e--;){n[e]=ac(d[e])?fa(d[e]*10)-5:d[e]=="Z"?"x":d[e]}d=n.join(" ")||"x";f.path=d;if(F){for(e=F.length;e--;){F[e].path=d}}n=true}else{if(c=="zIndex"||c=="visibility"){if(yc&&c=="visibility"&&i=="DIV"){f.gVis=d;n=f.childNodes;for(e=n.length;e--;){Ia(n[e],{visibility:d})}if(d==Bb){d=null}}if(d){g[c]=d}n=true}else{if(/^(width|height)$/.test(c)){if(this.updateClipping){this[c]=d;this.updateClipping()}else{g[c]=d}n=true}else{if(/^(x|y)$/.test(c)){this[c]=d;if(f.tagName=="SPAN"){this.updateTransform()}else{g[{x:"left",y:"top"}[c]]=d}}else{if(c=="class"){f.className=d}else{if(c=="stroke"){d=k.color(d,f,c);c="strokecolor"}else{if(c=="stroke-width"||c=="strokeWidth"){f.stroked=d?true:false;c="strokeweight";this[c]=d;if(ac(d)){d+=$a}}else{if(c=="dashstyle"){(f.getElementsByTagName("stroke")[0]||fb(k.prepVML(["<stroke/>"]),null,null,f))[c]=d||"solid";this.dashstyle=d;n=true}else{if(c=="fill"){if(i=="SPAN"){g.color=d}else{f.filled=d!=nb?true:false;d=k.color(d,f,c);c="fillcolor"}}else{if(c=="translateX"||c=="translateY"||c=="rotation"||c=="align"){if(c=="align"){c="textAlign"}this[c]=d;this.updateTransform();n=true}else{if(c=="text"){f.innerHTML=d;n=true}}}}}}}}}}}}if(F&&c=="visibility"){for(e=F.length;e--;){F[e].style[c]=d}}if(!n){if(yc){f[c]=d}else{za(f,c,d)}}}}return W},clip:function(a){var b=this,c=a.members;c.push(b);b.destroyClip=function(){mc(c,b)};return b.css(a.getCSS(b.inverted))},css:function(a){var b=this.element;if(b=a&&b.tagName=="SPAN"&&a.width){delete a.width;this.textWidth=b;this.updateTransform()}this.styles=qa(this.styles,a);Ia(this.element,a);return this},destroy:function(){this.destroyClip&&this.destroyClip();Hc.prototype.destroy.apply(this)},empty:function(){for(var a=this.element.childNodes,b=a.length,c;b--;){c=a[b];c.parentNode.removeChild(c)}},getBBox:function(){var a=this.element;if(a.nodeName=="text"){a.style.position=lc}return{x:a.offsetLeft,y:a.offsetTop,width:a.offsetWidth,height:a.offsetHeight}},on:function(a,b){this.element["on"+a]=function(){var c=ib.event;c.target=c.srcElement;b(c)};return this},updateTransform:function(){if(this.added){var a=this,b=a.element,c=a.translateX||0,d=a.translateY||0,e=a.x||0,f=a.y||0,g=a.textAlign||"left",i={left:0,center:0.5,right:1}[g],k=g&&g!="left";if(c||d){a.css({marginLeft:c,marginTop:d})}a.inverted&&t(b.childNodes,function(I){a.renderer.invertChild(I,b)});if(b.tagName=="SPAN"){var j,n;c=a.rotation;var z;j=0;d=1;var F=0,W;z=oa(a.textWidth);var ca=a.xCorr||0,ka=a.yCorr||0,v=[c,g,b.innerHTML,a.textWidth].join(",");if(v!=a.cTT){if(J(c)){j=c*Ud;d=kb(j);F=zb(j);Ia(b,{filter:c?["progid:DXImageTransform.Microsoft.Matrix(M11=",d,", M12=",-F,", M21=",F,", M22=",d,", sizingMethod='auto expand')"].join(""):nb})}j=b.offsetWidth;n=b.offsetHeight;if(j>z){Ia(b,{width:z+$a,display:"block",whiteSpace:"normal"});j=z}z=fa(oa(b.style.fontSize||12)*1.2);ca=d<0&&-j;ka=F<0&&-n;W=d*F<0;ca+=F*z*(W?1-i:i);ka-=d*z*(c?W?i:1-i:1);if(k){ca-=j*i*(d<0?-1:1);if(c){ka-=n*i*(F<0?-1:1)}Ia(b,{textAlign:g})}a.xCorr=ca;a.yCorr=ka}Ia(b,{left:e+ca,top:f+ka});a.cTT=v}}else{this.alignOnAdd=true}},shadow:function(a){var b=[],c=this.element,d=this.renderer,e,f=c.style,g,i=c.path;if(""+c.path===""){i="x"}if(a){for(a=1;a<=3;a++){g=['<shape isShadow="true" strokeweight="',7-2*a,'" filled="false" path="',i,'" coordsize="100,100" style="',c.style.cssText,'" />'];e=fb(d.prepVML(g),null,{left:oa(f.left)+1,top:oa(f.top)+1});g=['<stroke color="black" opacity="',0.05*a,'"/>'];fb(d.prepVML(g),null,null,e);c.parentNode.insertBefore(e,c);b.push(e)}this.shadows=b}return this}});Ma=function(){this.init.apply(this,arguments)};Ma.prototype=ya(Uc.prototype,{isIE8:xc.indexOf("MSIE 8.0")>-1,init:function(a,b,c){var d;this.Element=ge;this.alignedObjects=[];d=this.createElement(Lb);a.appendChild(d.element);this.box=d.element;this.boxWrapper=d;this.setSize(b,c,false);if(!Aa.namespaces.hcv){Aa.namespaces.add("hcv","urn:schemas-microsoft-com:vml");Aa.createStyleSheet().cssText="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } "}},clipRect:function(a,b,c,d){var e=this.createElement();return qa(e,{members:[],left:a,top:b,width:c,height:d,getCSS:function(f){var g=this.top,i=this.left,k=i+this.width,j=g+this.height;g={clip:"rect("+fa(f?i:g)+"px,"+fa(f?j:k)+"px,"+fa(f?k:j)+"px,"+fa(f?g:i)+"px)"};!f&&yc&&qa(g,{width:k+$a,height:j+$a});return g},updateClipping:function(){t(e.members,function(f){f.css(e.getCSS(f.inverted))})}})},color:function(a,b,c){var d,e=/^rgba/;if(a&&a.linearGradient){var f,g,i=a.linearGradient,k,j,n,z;t(a.stops,function(F,W){if(e.test(F[1])){d=Ub(F[1]);f=d.get("rgb");g=d.get("a")}else{f=F[1];g=1}if(W){n=f;z=g}else{k=f;j=g}});a=90-Ua.atan((i[3]-i[1])/(i[2]-i[0]))*180/Tb;c=["<",c,' colors="0% ',k,",100% ",n,'" angle="',a,'" opacity="',z,'" o:opacity2="',j,'" type="gradient" focus="100%" />'];fb(this.prepVML(c),null,null,b)}else{if(e.test(a)&&b.tagName!="IMG"){d=Ub(a);c=["<",c,' opacity="',d.get("a"),'"/>'];fb(this.prepVML(c),null,null,b);return d.get("rgb")}else{return a}}},prepVML:function(a){var b=this.isIE8;a=a.join("");if(b){a=a.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />');a=a.indexOf('style="')==-1?a.replace("/>",' style="display:inline-block;behavior:url(#default#VML);" />'):a.replace('style="','style="display:inline-block;behavior:url(#default#VML);')}else{a=a.replace("<","<hcv:")}return a},text:function(a,b,c){var d=Sa.chart.style;return this.createElement("span").attr({text:a,x:fa(b),y:fa(c)}).css({whiteSpace:"nowrap",fontFamily:d.fontFamily,fontSize:d.fontSize})},path:function(a){return this.createElement("shape").attr({coordsize:"100 100",d:a})},circle:function(a,b,c){return this.path(this.symbols.circle(a,b,c))},g:function(a){var b;if(a){b={className:Zb+a,"class":Zb+a}}return this.createElement(Lb).attr(b)},image:function(a,b,c,d,e){var f=this.createElement("img").attr({src:a});arguments.length>1&&f.css({left:b,top:c,width:d,height:e});return f},rect:function(a,b,c,d,e,f){if(Eb(a)){b=a.y;c=a.width;d=a.height;e=a.r;a=a.x}var g=this.symbol("rect");g.r=e;return g.attr(g.crisp(f,a,b,Ca(c,0),Ca(d,0)))},invertChild:function(a,b){var c=b.style;Ia(a,{flip:"x",left:oa(c.width)-10,top:oa(c.height)-10,rotation:-90})},symbols:{arc:function(a,b,c,d){var e=d.start,f=d.end,g=kb(e),i=zb(e),k=kb(f),j=zb(f);d=d.innerR;var n=0.07/c,z=d&&0.1/d||0;if(f-e===0){return["x"]}else{if(2*Tb-f+e<n){k=-n}else{if(f-e<z){k=kb(e+z)}}}return["wa",a-c,b-c,a+c,b+c,a+c*g,b+c*i,a+c*k,b+c*j,"at",a-d,b-d,a+d,b+d,a+d*k,b+d*j,a+d*g,b+d*i,"x","e"]},circle:function(a,b,c){return["wa",a-c,b-c,a+c,b+c,a+c,b,a+c,b,"e"]},rect:function(a,b,c,d){if(!J(d)){return[]}var e=d.width;d=d.height;var f=a+e,g=b+d;c=pb(c,e,d);return[Za,a+c,b,Da,f-c,b,"wa",f-2*c,b,f,b+2*c,f-c,b,f,b+c,Da,f,g-c,"wa",f-2*c,g-2*c,f,g,f,g-c,f-c,g,Da,a+c,g,"wa",a,g-2*c,a+2*c,g,a+c,g,a,g-c,Da,a,b+c,"wa",a,b,a+2*c,b+2*c,a,b+c,a+c,b,"x","e"]}}})}var Qd=wc?Uc:Ma;Hd.prototype.callbacks=[];var zc=function(){};zc.prototype={init:function(a,b){var c;this.series=a;this.applyOptions(b);this.pointAttr={};if(a.options.colorByPoint){c=a.chart.options.colors;if(!this.options){this.options={}}this.color=this.options.color=this.color||c[Jb++];if(Jb>=c.length){Jb=0}}a.chart.pointCount++;return this},applyOptions:function(a){var b=this.series;this.config=a;if(ac(a)||a===null){this.y=a}else{if(Eb(a)&&!ac(a.length)){qa(this,a);this.options=a}else{if(Kb(a[0])){this.name=a[0];this.y=a[1]}else{if(ac(a[0])){this.x=a[0];this.y=a[1]}}}}if(this.x===Ra){this.x=b.autoIncrement()}},destroy:function(){var a=this,b=a.series,c;b.chart.pointCount--;a==b.chart.hoverPoint&&a.onMouseOut();b.chart.hoverPoints=null;Cb(a);t(["graphic","tracker","group","dataLabel","connector"],function(d){a[d]&&a[d].destroy()});a.legendItem&&a.series.chart.legend.destroyItem(a);for(c in a){a[c]=null}},select:function(a,b){var c=this,d=c.series.chart;c.selected=a=y(a,!c.selected);c.firePointEvent(a?"select":"unselect");c.setState(a&&"select");b||t(d.getSelectedPoints(),function(e){if(e.selected&&e!=c){e.selected=false;e.setState(db);e.firePointEvent("unselect")}})},onMouseOver:function(){var a=this.series.chart,b=a.tooltip,c=a.hoverPoint;c&&c!=this&&c.onMouseOut();this.firePointEvent("mouseOver");b&&!b.shared&&b.refresh(this);this.setState(yb);a.hoverPoint=this},onMouseOut:function(){this.firePointEvent("mouseOut");this.setState();this.series.chart.hoverPoint=null},tooltipFormatter:function(a){var b=this.series;return['<span style="color:'+b.color+'">',this.name||b.name,"</span>: ",!a?"<b>x = "+(this.name||this.x)+",</b> ":"","<b>",!a?"y = ":"",this.y,"</b><br/>"].join("")},getDataLabelText:function(){return this.series.options.dataLabels.formatter.call({x:this.x,y:this.y,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal})},update:function(a,b,c){var d=this,e=d.series,f=d.dataLabel,g=d.graphic,i=e.chart;b=y(b,true);d.firePointEvent("update",{options:a},function(){d.applyOptions(a);f&&f.attr({text:d.getDataLabelText()});if(Eb(a)){e.getAttribs();g&&g.attr(d.pointAttr[e.state])}e.isDirty=true;b&&i.redraw(c)})},remove:function(a,b){var c=this,d=c.series,e=d.chart,f=d.data;bc(b,e);a=y(a,true);c.firePointEvent("remove",null,function(){mc(f,c);c.destroy();d.isDirty=true;a&&e.redraw()})},firePointEvent:function(a,b,c){var d=this,e=this.series.options;if(e.point.events[a]||d.options&&d.options.events&&d.options.events[a]){this.importEvents()}if(a=="click"&&e.allowPointSelect){c=function(f){d.select(null,f.ctrlKey||f.metaKey||f.shiftKey)}}La(this,a,b,c)},importEvents:function(){if(!this.hasImportedEvents){var a=ya(this.series.options.point,this.options).events,b;this.events=a;for(b in a){Qa(this,b,a[b])}this.hasImportedEvents=true}},setState:function(a){var b=this.series,c=b.options.states,d=wb[b.type].marker&&b.options.marker,e=d&&!d.enabled,f=(d=d&&d.states[a])&&d.enabled===false,g=b.stateMarkerGraphic,i=b.chart,k=this.pointAttr;a||(a=db);if(!(a==this.state||this.selected&&a!="select"||c[a]&&c[a].enabled===false||a&&(f||e&&!d.enabled))){if(this.graphic){this.graphic.attr(k[a])}else{if(a){if(!g){b.stateMarkerGraphic=g=i.renderer.circle(0,0,k[a].r).attr(k[a]).add(b.group)}g.translate(this.plotX,this.plotY)}if(g){g[a?"show":"hide"]()}}this.state=a}}};var mb=function(){};mb.prototype={isCartesian:true,type:"line",pointClass:zc,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},init:function(a,b){var c,d;d=a.series.length;this.chart=a;b=this.setOptions(b);qa(this,{index:d,options:b,name:b.name||"Series "+(d+1),state:db,pointAttr:{},visible:b.visible!==false,selected:b.selected===true});d=b.events;for(c in d){Qa(this,c,d[c])}if(d&&d.click||b.point&&b.point.events&&b.point.events.click||b.allowPointSelect){a.runTrackerClick=true}this.getColor();this.getSymbol();this.setData(b.data,false)},autoIncrement:function(){var a=this.options,b=this.xIncrement;b=y(b,a.pointStart,0);this.pointInterval=y(this.pointInterval,a.pointInterval,1);this.xIncrement=b+this.pointInterval;return b},cleanData:function(){var a=this.chart,b=this.data,c,d,e=a.smallestInterval,f,g;b.sort(function(i,k){return i.x-k.x});for(g=b.length-1;g>=0;g--){b[g-1]&&b[g-1].x==b[g].x&&b.splice(g-1,1)}for(g=b.length-1;g>=0;g--){if(b[g-1]){f=b[g].x-b[g-1].x;if(d===Ra||f<d){d=f;c=g}}}if(e===Ra||d<e){a.smallestInterval=d}this.closestPoints=c},getSegments:function(){var a=-1,b=[],c=this.data;t(c,function(d,e){if(d.y===null){e>a+1&&b.push(c.slice(a+1,e));a=e}else{e==c.length-1&&b.push(c.slice(a+1,e+1))}});this.segments=b},setOptions:function(a){var b=this.chart.options.plotOptions;return ya(b[this.type],b.series,a)},getColor:function(){var a=this.chart.options.colors;this.color=this.options.color||a[Jb++]||"#0000ff";if(Jb>=a.length){Jb=0}},getSymbol:function(){var a=this.chart.options.symbols;this.symbol=this.options.marker.symbol||a[Yc++];if(Yc>=a.length){Yc=0}},addPoint:function(a,b,c,d){var e=this.data,f=this.graph,g=this.area,i=this.chart;a=(new this.pointClass).init(this,a);bc(d,i);if(f&&c){f.shift=c}if(g){g.shift=c;g.isArea=true}b=y(b,true);e.push(a);c&&e[0].remove(false);this.isDirty=true;b&&i.redraw()},setData:function(a,b){var c=this,d=c.data,e=c.initialColor,f=c.chart,g=d&&d.length||0;c.xIncrement=null;if(J(e)){Jb=e}for(a=jc(nc(a||[]),function(i){return(new c.pointClass).init(c,i)});g--;){d[g].destroy()}c.data=a;c.cleanData();c.getSegments();c.isDirty=true;f.isDirtyBox=true;y(b,true)&&f.redraw(false)},remove:function(a,b){var c=this,d=c.chart;a=y(a,true);if(!c.isRemoving){c.isRemoving=true;La(c,"remove",null,function(){c.destroy();d.isDirtyLegend=d.isDirtyBox=true;a&&d.redraw(b)})}c.isRemoving=false},translate:function(){for(var a=this.chart,b=this.options.stacking,c=this.xAxis.categories,d=this.yAxis,e=this.data,f=e.length;f--;){var g=e[f],i=g.x,k=g.y,j=g.low,n=d.stacks[(k<0?"-":"")+this.stackKey];g.plotX=this.xAxis.translate(i);if(b&&this.visible&&n&&n[i]){j=n[i];i=j.total;j.cum=j=j.cum-k;k=j+k;if(b=="percent"){j=i?j*100/i:0;k=i?k*100/i:0}g.percentage=i?g.y*100/i:0;g.stackTotal=i}if(J(j)){g.yBottom=d.translate(j,0,1)}if(k!==null){g.plotY=d.translate(k,0,1)}g.clientX=a.inverted?a.plotHeight-g.plotX:g.plotX;g.category=c&&c[g.x]!==Ra?c[g.x]:g.x}},setTooltipPoints:function(a){var b=this.chart,c=b.inverted,d=[],e=fa((c?b.plotTop:b.plotLeft)+b.plotSizeX),f,g,i=[];if(a){this.tooltipPoints=null}t(this.segments,function(k){d=d.concat(k)});if(this.xAxis&&this.xAxis.reversed){d=d.reverse()}t(d,function(k,j){f=d[j-1]?d[j-1].high+1:0;for(g=k.high=d[j+1]?ob((k.plotX+(d[j+1]?d[j+1].plotX:e))/2):e;f<=g;){i[c?e-f++:f++]=k}});this.tooltipPoints=i},onMouseOver:function(){var a=this.chart,b=a.hoverSeries;if(!(!Ib&&a.mouseIsDown)){b&&b!=this&&b.onMouseOut();this.options.events.mouseOver&&La(this,"mouseOver");this.tracker&&this.tracker.toFront();this.setState(yb);a.hoverSeries=this}},onMouseOut:function(){var a=this.options,b=this.chart,c=b.tooltip,d=b.hoverPoint;d&&d.onMouseOut();this&&a.events.mouseOut&&La(this,"mouseOut");c&&!a.stickyTracking&&c.hide();this.setState();b.hoverSeries=null},animate:function(a){var b=this.chart,c=this.clipRect,d=this.options.animation;if(d&&!Eb(d)){d={}}if(a){if(!c.isAnimating){c.attr("width",0);c.isAnimating=true}}else{c.animate({width:b.plotSizeX},d);this.animate=null}},drawPoints:function(){var a,b=this.data,c=this.chart,d,e,f,g,i,k;if(this.options.marker.enabled){for(f=b.length;f--;){g=b[f];d=g.plotX;e=g.plotY;k=g.graphic;if(e!==Ra&&!isNaN(e)){a=g.pointAttr[g.selected?"select":db];i=a.r;if(k){k.animate({x:d,y:e,r:i})}else{g.graphic=c.renderer.symbol(y(g.marker&&g.marker.symbol,this.symbol),d,e,i).attr(a).add(this.group)}}}}},convertAttribs:function(a,b,c,d){var e=this.pointAttrToOptions,f,g,i={};a=a||{};b=b||{};c=c||{};d=d||{};for(f in e){g=e[f];i[f]=y(a[g],b[f],c[f],d[f])}return i},getAttribs:function(){var a=this,b=wb[a.type].marker?a.options.marker:a.options,c=b.states,d=c[yb],e,f=a.color,g={stroke:f,fill:f},i=a.data,k=[],j,n=a.pointAttrToOptions;if(a.options.marker){d.radius=d.radius||b.radius+2;d.lineWidth=d.lineWidth||b.lineWidth+1}else{d.color=d.color||Ub(d.color||f).brighten(d.brightness).get()}k[db]=a.convertAttribs(b,g);t([yb,"select"],function(F){k[F]=a.convertAttribs(c[F],k[db])});a.pointAttr=k;for(f=i.length;f--;){g=i[f];if((b=g.options&&g.options.marker||g.options)&&b.enabled===false){b.radius=0}e=false;if(g.options){for(var z in n){if(J(b[n[z]])){e=true}}}if(e){j=[];c=b.states||{};e=c[yb]=c[yb]||{};if(!a.options.marker){e.color=Ub(e.color||g.options.color).brighten(e.brightness||d.brightness).get()}j[db]=a.convertAttribs(b,k[db]);j[yb]=a.convertAttribs(c[yb],k[yb],j[db]);j.select=a.convertAttribs(c.select,k.select,j[db])}else{j=k}g.pointAttr=j}},destroy:function(){var a=this,b=a.chart,c=/\/5[0-9\.]+ (Safari|Mobile)\//.test(xc),d,e;Cb(a);a.legendItem&&a.chart.legend.destroyItem(a);t(a.data,function(f){f.destroy()});t(["area","graph","dataLabelsGroup","group","tracker"],function(f){if(a[f]){d=c&&f=="group"?"hide":"destroy";a[f][d]()}});if(b.hoverSeries==a){b.hoverSeries=null}mc(b.series,a);for(e in a){delete a[e]}},drawDataLabels:function(){if(this.options.dataLabels.enabled){var a,b,c=this.data,d=this.options.dataLabels,e,f=this.dataLabelsGroup,g=this.chart,i=g.inverted,k=this.type,j;if(!f){f=this.dataLabelsGroup=g.renderer.g(Zb+"data-labels").attr({visibility:this.visible?Bb:vb,zIndex:5}).translate(g.plotLeft,g.plotTop).add()}j=d.color;if(j=="auto"){j=null}d.style.color=y(j,this.color);t(c,function(n){var z=n.barX;z=z&&z+n.barW/2||n.plotX||-999;var F=y(n.plotY,-999),W=n.dataLabel,ca=d.align;e=n.getDataLabelText();a=(i?g.plotWidth-F:z)+d.x;b=(i?g.plotHeight-z:F)+d.y;if(k=="column"){a+={left:-1,right:1}[ca]*n.barW/2||0}if(W){W.animate({x:a,y:b})}else{if(J(e)){W=n.dataLabel=g.renderer.text(e,a,b).attr({align:ca,rotation:d.rotation,zIndex:1}).css(d.style).add(f)}}i&&!d.y&&W.attr({y:b+parseInt(W.styles.lineHeight)*0.9-W.getBBox().height/2})})}},drawGraph:function(){var a=this,b=a.options,c=a.graph,d=[],e,f=a.area,g=a.group,i=b.lineColor||a.color,k=b.lineWidth,j=b.dashStyle,n,z=a.chart.renderer,F=a.yAxis.getThreshold(b.threshold||0),W=/^area/.test(a.type),ca=[],ka=[];t(a.segments,function(v){n=[];t(v,function(U,R){if(a.getPointSpline){n.push.apply(n,a.getPointSpline(v,U,R))}else{n.push(R?Da:Za);R&&b.step&&n.push(U.plotX,v[R-1].plotY);n.push(U.plotX,U.plotY)}});if(v.length>1){d=d.concat(n)}else{ca.push(v[0])}if(W){var I=[],da,X=n.length;for(da=0;da<X;da++){I.push(n[da])}X==3&&I.push(Da,n[1],n[2]);if(b.stacking&&a.type!="areaspline"){for(da=v.length-1;da>=0;da--){I.push(v[da].plotX,v[da].yBottom)}}else{I.push(Da,v[v.length-1].plotX,F,Da,v[0].plotX,F)}ka=ka.concat(I)}});a.graphPath=d;a.singlePoints=ca;if(W){e=y(b.fillColor,Ub(a.color).setOpacity(b.fillOpacity||0.75).get());if(f){f.animate({d:ka})}else{a.area=a.chart.renderer.path(ka).attr({fill:e}).add(g)}}if(c){c.animate({d:d})}else{if(k){c={stroke:i,"stroke-width":k};if(j){c.dashstyle=j}a.graph=z.path(d).attr(c).add(g).shadow(b.shadow)}}},render:function(){var a=this,b=a.chart,c,d,e=a.options,f=e.animation,g=f&&a.animate;f=g?f&&f.duration||500:0;var i=a.clipRect;d=b.renderer;if(!i){i=a.clipRect=!b.hasRendered&&b.clipRect?b.clipRect:d.clipRect(0,0,b.plotSizeX,b.plotSizeY);if(!b.clipRect){b.clipRect=i}}if(!a.group){c=a.group=d.g("series");if(b.inverted){d=function(){c.attr({width:b.plotWidth,height:b.plotHeight}).invert()};d();Qa(b,"resize",d)}c.clip(a.clipRect).attr({visibility:a.visible?Bb:vb,zIndex:e.zIndex}).translate(b.plotLeft,b.plotTop).add(b.seriesGroup)}a.drawDataLabels();g&&a.animate(true);a.getAttribs();a.drawGraph&&a.drawGraph();a.drawPoints();a.options.enableMouseTracking!==false&&a.drawTracker();g&&a.animate();setTimeout(function(){i.isAnimating=false;if((c=a.group)&&i!=b.clipRect&&i.renderer){c.clip(a.clipRect=b.clipRect);i.destroy()}},f);a.isDirty=false},redraw:function(){var a=this.chart,b=this.group;if(b){a.inverted&&b.attr({width:a.plotWidth,height:a.plotHeight});b.animate({translateX:a.plotLeft,translateY:a.plotTop})}this.translate();this.setTooltipPoints(true);this.render()},setState:function(a){var b=this.options,c=this.graph,d=b.states;b=b.lineWidth;a=a||db;if(this.state!=a){this.state=a;if(!(d[a]&&d[a].enabled===false)){if(a){b=d[a].lineWidth||b+1}if(c&&!c.dashstyle){c.attr({"stroke-width":b},a?0:500)}}}},setVisible:function(a,b){var c=this.chart,d=this.legendItem,e=this.group,f=this.tracker,g=this.dataLabelsGroup,i,k=this.data,j=c.options.chart.ignoreHiddenSeries;i=this.visible;i=(this.visible=a=a===Ra?!i:a)?"show":"hide";e&&e[i]();if(f){f[i]()}else{for(e=k.length;e--;){f=k[e];f.tracker&&f.tracker[i]()}}g&&g[i]();d&&c.legend.colorizeItem(this,a);this.isDirty=true;this.options.stacking&&t(c.series,function(n){if(n.options.stacking&&n.visible){n.isDirty=true}});if(j){c.isDirtyBox=true}b!==false&&c.redraw();La(this,i)},show:function(){this.setVisible(true)},hide:function(){this.setVisible(false)},select:function(a){this.selected=a=a===Ra?!this.selected:a;if(this.checkbox){this.checkbox.checked=a}La(this,a?"select":"unselect")},drawTracker:function(){var a=this,b=a.options,c=[].concat(a.graphPath),d=c.length,e=a.chart,f=e.options.tooltip.snap,g=a.tracker,i=b.cursor;i=i&&{cursor:i};var k=a.singlePoints,j;if(d){for(j=d+1;j--;){c[j]==Za&&c.splice(j+1,0,c[j+1]-f,c[j+2],Da);if(j&&c[j]==Za||j==d){c.splice(j,0,Da,c[j-2]+f,c[j-1])}}}for(j=0;j<k.length;j++){d=k[j];c.push(Za,d.plotX-f,d.plotY,Da,d.plotX+f,d.plotY)}if(g){g.attr({d:c})}else{a.tracker=e.renderer.path(c).attr({isTracker:true,stroke:Vd,fill:nb,"stroke-width":b.lineWidth+2*f,visibility:a.visible?Bb:vb,zIndex:1}).on(Ib?"touchstart":"mouseover",function(){e.hoverSeries!=a&&a.onMouseOver()}).on("mouseout",function(){b.stickyTracking||a.onMouseOut()}).css(i).add(e.trackerGroup)}}};Ma=xb(mb);ub.line=Ma;Ma=xb(mb,{type:"area"});ub.area=Ma;Ma=xb(mb,{type:"spline",getPointSpline:function(a,b,c){var d=b.plotX,e=b.plotY,f=a[c-1],g=a[c+1],i,k,j,n;if(c&&c<a.length-1){a=f.plotY;j=g.plotX;g=g.plotY;var z;i=(1.5*d+f.plotX)/2.5;k=(1.5*e+a)/2.5;j=(1.5*d+j)/2.5;n=(1.5*e+g)/2.5;z=(n-k)*(j-d)/(j-i)+e-n;k+=z;n+=z;if(k>a&&k>e){k=Ca(a,e);n=2*e-k}else{if(k<a&&k<e){k=pb(a,e);n=2*e-k}}if(n>g&&n>e){n=Ca(g,e);k=2*e-n}else{if(n<g&&n<e){n=pb(g,e);k=2*e-n}}b.rightContX=j;b.rightContY=n}if(c){b=["C",f.rightContX||f.plotX,f.rightContY||f.plotY,i||d,k||e,d,e];f.rightContX=f.rightContY=null}else{b=[Za,d,e]}return b}});ub.spline=Ma;Ma=xb(Ma,{type:"areaspline"});ub.areaspline=Ma;var ad=xb(mb,{type:"column",pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color",r:"borderRadius"},init:function(){mb.prototype.init.apply(this,arguments);var a=this,b=a.chart;b.hasColumn=true;b.hasRendered&&t(b.series,function(c){if(c.type==a.type){c.isDirty=true}})},translate:function(){var a=this,b=a.chart,c=0,d=a.xAxis.reversed,e=a.xAxis.categories,f={},g,i;mb.prototype.translate.apply(a);t(b.series,function(I){if(I.type==a.type){if(I.options.stacking){g=I.stackKey;if(f[g]===Ra){f[g]=c++}i=f[g]}else{if(I.visible){i=c++}}I.columnIndex=i}});var k=a.options,j=a.data,n=a.closestPoints;b=cb(j[1]?j[n].plotX-j[n-1].plotX:b.plotSizeX/(e?e.length:1));e=b*k.groupPadding;n=(b-2*e)/c;var z=k.pointWidth,F=J(z)?(n-z)/2:n*k.pointPadding,W=Ca(y(z,n-2*F),1),ca=F+(e+((d?c-a.columnIndex:a.columnIndex)||0)*n-b/2)*(d?-1:1),ka=a.yAxis.getThreshold(k.threshold||0),v=y(k.minPointLength,5);t(j,function(I){var da=I.plotY,X=I.yBottom||ka,U=I.plotX+ca,R=fd(pb(da,X)),Ha=fd(Ca(da,X)-R),Ya;if(cb(Ha)<v){if(v){Ha=v;R=cb(R-ka)>v?X-v:ka-(da<=ka?v:0)}Ya=R-3}qa(I,{barX:U,barY:R,barW:W,barH:Ha});I.shapeType="rect";I.shapeArgs={x:U,y:R,width:W,height:Ha,r:k.borderRadius};I.trackerArgs=J(Ya)&&ya(I.shapeArgs,{height:Ca(6,Ha+3),y:Ya})})},getSymbol:function(){},drawGraph:function(){},drawPoints:function(){var a=this,b=a.options,c=a.chart.renderer,d,e;t(a.data,function(f){var g=f.plotY;if(g!==Ra&&!isNaN(g)){d=f.graphic;e=f.shapeArgs;if(d){Sc(d);d.animate(e)}else{f.graphic=c[f.shapeType](e).attr(f.pointAttr[f.selected?"select":db]).add(a.group).shadow(b.shadow)}}})},drawTracker:function(){var a=this,b=a.chart,c=b.renderer,d,e,f=+new Date,g=a.options.cursor,i=g&&{cursor:g},k;t(a.data,function(j){e=j.tracker;d=j.trackerArgs||j.shapeArgs;if(j.y!==null){if(e){e.attr(d)}else{j.tracker=c[j.shapeType](d).attr({isTracker:f,fill:Vd,visibility:a.visible?Bb:vb,zIndex:1}).on(Ib?"touchstart":"mouseover",function(n){k=n.relatedTarget||n.fromElement;b.hoverSeries!=a&&za(k,"isTracker")!=f&&a.onMouseOver();j.onMouseOver()}).on("mouseout",function(n){if(!a.options.stickyTracking){k=n.relatedTarget||n.toElement;za(k,"isTracker")!=f&&a.onMouseOut()}}).css(i).add(b.trackerGroup)}}})},animate:function(a){var b=this,c=b.data;if(!a){t(c,function(d){var e=d.graphic;if(e){e.attr({height:0,y:b.yAxis.translate(0,0,1)});e.animate({height:d.barH,y:d.barY},b.options.animation)}});b.animate=null}},remove:function(){var a=this,b=a.chart;b.hasRendered&&t(b.series,function(c){if(c.type==a.type){c.isDirty=true}});mb.prototype.remove.apply(a,arguments)}});ub.column=ad;Ma=xb(ad,{type:"bar",init:function(a){a.inverted=this.inverted=true;ad.prototype.init.apply(this,arguments)}});ub.bar=Ma;Ma=xb(mb,{type:"scatter",translate:function(){var a=this;mb.prototype.translate.apply(a);t(a.data,function(b){b.shapeType="circle";b.shapeArgs={x:b.plotX,y:b.plotY,r:a.chart.options.tooltip.snap}})},drawTracker:function(){var a=this,b=a.options.cursor,c=b&&{cursor:b},d;t(a.data,function(e){(d=e.graphic)&&d.attr({isTracker:true}).on("mouseover",function(){a.onMouseOver();e.onMouseOver()}).on("mouseout",function(){a.options.stickyTracking||a.onMouseOut()}).css(c)})},cleanData:function(){}});ub.scatter=Ma;Ma=xb(zc,{init:function(){zc.prototype.init.apply(this,arguments);var a=this,b;qa(a,{visible:a.visible!==false,name:y(a.name,"Slice")});b=function(){a.slice()};Qa(a,"select",b);Qa(a,"unselect",b);return a},setVisible:function(a){var b=this.series.chart,c=this.tracker,d=this.dataLabel,e=this.connector,f;f=(this.visible=a=a===Ra?!this.visible:a)?"show":"hide";this.group[f]();c&&c[f]();d&&d[f]();e&&e[f]();this.legendItem&&b.legend.colorizeItem(this,a)},slice:function(a,b,c){var d=this.series.chart,e=this.slicedTranslation;bc(c,d);y(b,true);a=this.sliced=J(a)?a:!this.sliced;this.group.animate({translateX:a?e[0]:d.plotLeft,translateY:a?e[1]:d.plotTop})}});Ma=xb(mb,{type:"pie",isCartesian:false,pointClass:Ma,pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},getColor:function(){this.initialColor=Jb},animate:function(){var a=this;t(a.data,function(b){var c=b.graphic;b=b.shapeArgs;var d=-Tb/2;if(c){c.attr({r:0,start:d,end:d});c.animate({r:b.r,start:b.start,end:b.end},a.options.animation)}});a.animate=null},translate:function(){var a=0,b=-0.25,c=this.options,d=c.slicedOffset,e=d+c.borderWidth,f=c.center,g=this.chart,i=g.plotWidth,k=g.plotHeight,j,n,z,F=this.data,W=2*Tb,ca,ka=pb(i,k),v,I,da,X=c.dataLabels.distance;f.push(c.size,c.innerSize||0);f=jc(f,function(U,R){return(v=/%$/.test(U))?[i,k,ka,ka][R]*oa(U)/100:U});this.getX=function(U,R){z=Ua.asin((U-f[1])/(f[2]/2+X));return f[0]+(R?-1:1)*kb(z)*(f[2]/2+X)};this.center=f;t(F,function(U){a+=U.y});t(F,function(U){ca=a?U.y/a:0;j=fa(b*W*1000)/1000;b+=ca;n=fa(b*W*1000)/1000;U.shapeType="arc";U.shapeArgs={x:f[0],y:f[1],r:f[2]/2,innerR:f[3]/2,start:j,end:n};z=(n+j)/2;U.slicedTranslation=jc([kb(z)*d+g.plotLeft,zb(z)*d+g.plotTop],fa);I=kb(z)*f[2]/2;da=zb(z)*f[2]/2;U.tooltipPos=[f[0]+I*0.7,f[1]+da*0.7];U.labelPos=[f[0]+I+kb(z)*X,f[1]+da+zb(z)*X,f[0]+I+kb(z)*e,f[1]+da+zb(z)*e,f[0]+I,f[1]+da,X<0?"center":z<W/4?"left":"right",z];U.percentage=ca*100;U.total=a});this.setTooltipPoints()},render:function(){this.getAttribs();this.drawPoints();this.options.enableMouseTracking!==false&&this.drawTracker();this.drawDataLabels();this.options.animation&&this.animate&&this.animate();this.isDirty=false},drawPoints:function(){var a=this.chart,b=a.renderer,c,d,e,f;t(this.data,function(g){d=g.graphic;f=g.shapeArgs;e=g.group;if(!e){e=g.group=b.g("point").attr({zIndex:5}).add()}c=g.sliced?g.slicedTranslation:[a.plotLeft,a.plotTop];e.translate(c[0],c[1]);if(d){d.animate(f)}else{g.graphic=b.arc(f).attr(qa(g.pointAttr[db],{"stroke-linejoin":"round"})).add(g.group)}g.visible===false&&g.setVisible(false)})},drawDataLabels:function(){var a=this.data,b,c=this.chart,d=this.options.dataLabels,e=y(d.connectorPadding,10),f=y(d.connectorWidth,1),g,i,k=d.distance>0,j,n,z=this.center[1],F=[[],[],[],[]],W,ca,ka,v,I,da,X,U=4,R;mb.prototype.drawDataLabels.apply(this);t(a,function(Ha){var Ya=Ha.labelPos[7];F[Ya<0?0:Ya<Tb/2?1:Ya<Tb?2:3].push(Ha)});F[1].reverse();F[3].reverse();for(X=function(Ha,Ya){return Ha.y>Ya.y};U--;){a=0;b=[].concat(F[U]);b.sort(X);for(R=b.length;R--;){b[R].rank=R}for(v=0;v<2;v++){n=(da=U%3)?9999:-9999;I=da?-1:1;for(R=0;R<F[U].length;R++){b=F[U][R];if(g=b.dataLabel){i=b.labelPos;ka=Bb;W=i[0];ca=i[1];j||(j=g&&g.getBBox().height);if(k){if(v&&b.rank<a){ka=vb}else{if(!da&&ca<n+j||da&&ca>n-j){ca=n+I*j;W=this.getX(ca,U>1);if(!da&&ca+j>z||da&&ca-j<z){if(v){ka=vb}else{a++}}}}}if(b.visible===false){ka=vb}if(ka==Bb){n=ca}if(v){g.attr({visibility:ka,align:i[6]})[g.moved?"animate":"attr"]({x:W+d.x+({left:e,right:-e}[i[6]]||0),y:ca+d.y});g.moved=true;if(k&&f){g=b.connector;i=[Za,W+(i[6]=="left"?5:-5),ca,Da,W,ca,Da,i[2],i[3],Da,i[4],i[5]];if(g){g.animate({d:i});g.attr("visibility",ka)}else{b.connector=g=this.chart.renderer.path(i).attr({"stroke-width":f,stroke:d.connectorColor||"#606060",visibility:ka,zIndex:3}).translate(c.plotLeft,c.plotTop).add()}}}}}}}},drawTracker:ad.prototype.drawTracker,getSymbol:function(){}});ub.pie=Ma;ib.Highcharts={Chart:Hd,dateFormat:Mc,pathAnim:$c,getOptions:function(){return Sa},numberFormat:Gd,Point:zc,Color:Ub,Renderer:Qd,seriesTypes:ub,setOptions:function(a){Sa=ya(Sa,a);Bd();return Sa},Series:mb,addEvent:Qa,createElement:fb,discardElement:Fc,css:Ia,each:t,extend:qa,map:jc,merge:ya,pick:y,extendClass:xb,version:"2.1.4"}})();
/*@cc_on(function(m,c){var z="abbr|article|aside|audio|canvas|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video";function n(d){for(var a=-1;++a<o;)d.createElement(i[a])}function p(d,a){for(var e=-1,b=d.length,j,q=[];++e<b;){j=d[e];if((a=j.media||a)!="screen")q.push(p(j.imports,a),j.cssText)}return q.join("")}var g=c.createElement("div");g.innerHTML="<z>i</z>";if(g.childNodes.length!==1){var i=z.split("|"),o=i.length,s=RegExp("(^|\\s)("+z+")",
"gi"),t=RegExp("<(/*)("+z+")","gi"),u=RegExp("(^|[^\\n]*?\\s)("+z+")([^\\n]*)({[\\n\\w\\W]*?})","gi"),r=c.createDocumentFragment(),k=c.documentElement;g=k.firstChild;var h=c.createElement("body"),l=c.createElement("style"),f;n(c);n(r);g.insertBefore(l,
g.firstChild);l.media="print";m.attachEvent("onbeforeprint",function(){var d=-1,a=p(c.styleSheets,"all"),e=[],b;for(f=f||c.body;(b=u.exec(a))!=null;)e.push((b[1]+b[2]+b[3]).replace(s,"$1.iepp_$2")+b[4]);for(l.styleSheet.cssText=e.join("\n");++d<o;){a=c.getElementsByTagName(i[d]);e=a.length;for(b=-1;++b<e;)if(a[b].className.indexOf("iepp_")<0)a[b].className+=" iepp_"+i[d]}r.appendChild(f);k.appendChild(h);h.className=f.className;h.innerHTML=f.innerHTML.replace(t,"<$1font")});m.attachEvent("onafterprint",
function(){h.innerHTML="";k.removeChild(h);k.appendChild(f);l.styleSheet.cssText=""})}})(this,document);@*/
(function(c,lb){var v="none",N="LoadedContent",b=false,x="resize.",o="y",r="auto",f=true,u="click",O="nofollow",q="on",m="x";function e(a,b){a=a?' id="'+j+a+'"':"";b=b?' style="'+b+'"':"";return c("<div"+a+b+"/>")}function p(a,b){b=b===m?n.width():n.height();return typeof a==="string"?Math.round(a.match(/%/)?b/100*parseInt(a,10):parseInt(a,10)):a}function U(b,d){b=c.isFunction(b)?b.call(d):b;return a.photo||b.match(/\.(gif|png|jpg|jpeg|bmp)(?:\?([^#]*))?(?:#(\.*))?$/i)}function eb(a){for(var b in a){if(c.isFunction(a[b])&&b.substring(0,2)!==q){a[b]=a[b].call(l)}}a.rel=a.rel||l.rel||O;a.href=a.href||c(l).attr("href");a.title=a.title||l.title;return a}function y(b,a){a&&a.call(l);c.event.trigger(b)}function mb(){var c,b=j+"Slideshow_",e,f;if(a.slideshow&&i[1]){e=function(){z.text(a.slideshowStop).bind(V,function(){c=setTimeout(d.next,a.slideshowSpeed)}).bind(W,function(){clearTimeout(c)}).one(u,function(){f()});h.removeClass(b+"off").addClass(b+q)};f=function(){clearTimeout(c);z.text(a.slideshowStart).unbind(V+" "+W).one(u,function(){e();c=setTimeout(d.next,a.slideshowSpeed)});h.removeClass(b+q).addClass(b+"off")};z.bind(fb,function(){z.unbind();clearTimeout(c);h.removeClass(b+"off "+b+q)});a.slideshowAuto?e():f()}}function gb(b){if(!P){l=b;a=eb(c.extend({},c.data(l,s)));i=c(l);g=0;if(a.rel!==O){i=c("."+I).filter(function(){return(c.data(this,s).rel||this.rel)===a.rel});g=i.index(l);if(g===-1){i=i.add(l);g=i.length-1}}if(!w){w=H=f;h.show();X=l;try{X.blur()}catch(e){}A.css({opacity:+a.opacity,cursor:a.overlayClose?"pointer":r}).show();a.w=p(a.initialWidth,m);a.h=p(a.initialHeight,o);d.position(0);Y&&n.bind(x+Q+" scroll."+Q,function(){A.css({width:n.width(),height:n.height(),top:n.scrollTop(),left:n.scrollLeft()})}).trigger("scroll."+Q);y(hb,a.onOpen);Z.add(J).add(K).add(z).add(ab).hide();bb.html(a.close).show()}d.load(f)}}var ib={transition:"elastic",speed:300,width:b,initialWidth:"600",innerWidth:b,maxWidth:b,height:b,initialHeight:"450",innerHeight:b,maxHeight:b,scalePhotos:f,scrolling:f,inline:b,html:b,iframe:b,photo:b,href:b,title:b,rel:b,opacity:0.9,preloading:f,current:"image {current} of {total}",previous:"previous",next:"next",close:"close",open:b,loop:f,slideshow:b,slideshowAuto:f,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",onOpen:b,onLoad:b,onComplete:b,onCleanup:b,onClosed:b,overlayClose:f,escKey:f,arrowKey:f},s="colorbox",j="cbox",hb=j+"_open",W=j+"_load",V=j+"_complete",jb=j+"_cleanup",fb=j+"_closed",R=j+"_purge",kb=j+"_loaded",D=c.browser.msie&&!c.support.opacity,Y=D&&c.browser.version<7,Q=j+"_IE6",A,h,E,t,cb,db,T,S,i,n,k,L,M,ab,Z,z,K,J,bb,F,G,B,C,l,X,g,a,w,H,P=b,d,I=j+"Element";d=c.fn[s]=c[s]=function(b,e){var a=this,d;if(!a[0]&&a.selector){return a}b=b||{};if(e){b.onComplete=e}if(!a[0]||a.selector===undefined){a=c("<a/>");b.open=f}a.each(function(){c.data(this,s,c.extend({},c.data(this,s)||ib,b));c(this).addClass(I)});d=b.open;if(c.isFunction(d)){d=d.call(a)}d&&gb(a[0]);return a};d.init=function(){var l="hover",m="clear:left";n=c(lb);h=e().attr({id:s,"class":D?j+"IE":""});A=e("Overlay",Y?"position:absolute":"").hide();E=e("Wrapper");t=e("Content").append(k=e(N,"width:0; height:0; overflow:hidden"),M=e("LoadingOverlay").add(e("LoadingGraphic")),ab=e("Title"),Z=e("Current"),K=e("Next"),J=e("Previous"),z=e("Slideshow").bind(hb,mb),bb=e("Close"));E.append(e().append(e("TopLeft"),cb=e("TopCenter"),e("TopRight")),e(b,m).append(db=e("MiddleLeft"),t,T=e("MiddleRight")),e(b,m).append(e("BottomLeft"),S=e("BottomCenter"),e("BottomRight"))).children().children().css({"float":"left"});L=e(b,"position:absolute; width:9999px; visibility:hidden; display:none");c("body").prepend(A,h.append(E,L));t.children().hover(function(){c(this).addClass(l)},function(){c(this).removeClass(l)}).addClass(l);F=cb.height()+S.height()+t.outerHeight(f)-t.height();G=db.width()+T.width()+t.outerWidth(f)-t.width();B=k.outerHeight(f);C=k.outerWidth(f);h.css({"padding-bottom":F,"padding-right":G}).hide();K.click(d.next);J.click(d.prev);bb.click(d.close);t.children().removeClass(l);c("."+I).live(u,function(a){if(!(a.button!==0&&typeof a.button!=="undefined"||a.ctrlKey||a.shiftKey||a.altKey)){a.preventDefault();gb(this)}});A.click(function(){a.overlayClose&&d.close()});c(document).bind("keydown",function(b){if(w&&a.escKey&&b.keyCode===27){b.preventDefault();d.close()}if(w&&a.arrowKey&&!H&&i[1]){if(b.keyCode===37&&(g||a.loop)){b.preventDefault();J.click()}else{if(b.keyCode===39&&(g<i.length-1||a.loop)){b.preventDefault();K.click()}}}})};d.remove=function(){h.add(A).remove();c("."+I).die(u).removeData(s).removeClass(I)};d.position=function(f,c){function d(a){cb[0].style.width=S[0].style.width=t[0].style.width=a.style.width;M[0].style.height=M[1].style.height=t[0].style.height=db[0].style.height=T[0].style.height=a.style.height}var e,i=Math.max(document.documentElement.clientHeight-a.h-B-F,0)/2+n.scrollTop(),g=Math.max(n.width()-a.w-C-G,0)/2+n.scrollLeft();e=h.width()===a.w+C&&h.height()===a.h+B?0:f;E[0].style.width=E[0].style.height="9999px";h.dequeue().animate({width:a.w+C,height:a.h+B,top:i,left:g},{duration:e,complete:function(){d(this);H=b;E[0].style.width=a.w+C+G+"px";E[0].style.height=a.h+B+F+"px";c&&c()},step:function(){d(this)}})};d.resize=function(b){if(w){b=b||{};if(b.width){a.w=p(b.width,m)-C-G}if(b.innerWidth){a.w=p(b.innerWidth,m)}k.css({width:a.w});if(b.height){a.h=p(b.height,o)-B-F}if(b.innerHeight){a.h=p(b.innerHeight,o)}if(!b.innerHeight&&!b.height){b=k.wrapInner("<div style='overflow:auto'></div>").children();a.h=b.height();b.replaceWith(b.children())}k.css({height:a.h});d.position(a.transition===v?0:a.speed)}};d.prep=function(o){var f="hidden";function m(t){var m,r,f,o,e=i.length,q=a.loop;d.position(t,function(){if(w){D&&p&&k.fadeIn(100);k.show();y(kb);ab.show().html(a.title);if(e>1){Z.html(a.current.replace(/\{current\}/,g+1).replace(/\{total\}/,e)).show();K[q||g<e-1?"show":"hide"]().html(a.next);J[q||g?"show":"hide"]().html(a.previous);m=g?i[g-1]:i[e-1];f=g<e-1?i[g+1]:i[0];if(a.slideshow){z.show();g===e-1&&!q&&h.is("."+j+"Slideshow_on")&&z.click()}if(a.preloading){o=c.data(f,s).href||f.href;r=c.data(m,s).href||m.href;if(U(o,f)){c("<img/>")[0].src=o}if(U(r,m)){c("<img/>")[0].src=r}}}M.hide();if(a.transition==="fade"){h.fadeTo(l,1,function(){if(D){h[0].style.filter=b}})}else{if(D){h[0].style.filter=b}}n.bind(x+j,function(){d.position(0)});y(V,a.onComplete)}})}if(w){var p,l=a.transition===v?0:a.speed;n.unbind(x+j);k.remove();k=e(N).html(o);k.hide().appendTo(L.show()).css({width:function(){a.w=a.w||k.width();a.w=a.mw&&a.mw<a.w?a.mw:a.w;return a.w}(),overflow:a.scrolling?r:f}).css({height:function(){a.h=a.h||k.height();a.h=a.mh&&a.mh<a.h?a.mh:a.h;return a.h}()}).prependTo(t);L.hide();c("#"+j+"Photo").css({cssFloat:v,marginLeft:r,marginRight:r});Y&&c("select").not(h.find("select")).filter(function(){return this.style.visibility!==f}).css({visibility:f}).one(jb,function(){this.style.visibility="inherit"});a.transition==="fade"?h.fadeTo(l,0,function(){m(0)}):m(l)}};d.load=function(t){var n,b,r,q=d.prep;H=f;l=i[g];t||(a=eb(c.extend({},c.data(l,s))));y(R);y(W,a.onLoad);a.h=a.height?p(a.height,o)-B-F:a.innerHeight&&p(a.innerHeight,o);a.w=a.width?p(a.width,m)-C-G:a.innerWidth&&p(a.innerWidth,m);a.mw=a.w;a.mh=a.h;if(a.maxWidth){a.mw=p(a.maxWidth,m)-C-G;a.mw=a.w&&a.w<a.mw?a.w:a.mw}if(a.maxHeight){a.mh=p(a.maxHeight,o)-B-F;a.mh=a.h&&a.h<a.mh?a.h:a.mh}n=a.href;M.show();if(a.inline){e().hide().insertBefore(c(n)[0]).one(R,function(){c(this).replaceWith(k.children())});q(c(n))}else{if(a.iframe){h.one(kb,function(){var b=c("<iframe name='"+(new Date).getTime()+"' frameborder=0"+(a.scrolling?"":" scrolling='no'")+(D?" allowtransparency='true'":"")+" style='width:100%; height:100%; border:0; display:block;'/>");b[0].src=a.href;b.appendTo(k).one(R,function(){b[0].src="about:blank"})});q(" ")}else{if(a.html){q(a.html)}else{if(U(n,l)){b=new Image;b.onload=function(){var e;b.onload=null;b.id=j+"Photo";c(b).css({border:v,display:"block",cssFloat:"left"});if(a.scalePhotos){r=function(){b.height-=b.height*e;b.width-=b.width*e};if(a.mw&&b.width>a.mw){e=(b.width-a.mw)/b.width;r()}if(a.mh&&b.height>a.mh){e=(b.height-a.mh)/b.height;r()}}if(a.h){b.style.marginTop=Math.max(a.h-b.height,0)/2+"px"}i[1]&&(g<i.length-1||a.loop)&&c(b).css({cursor:"pointer"}).click(d.next);if(D){b.style.msInterpolationMode="bicubic"}setTimeout(function(){q(b)},1)};setTimeout(function(){b.src=n},1)}else{e().appendTo(L).load(n,function(c,a,b){q(a==="error"?"Request unsuccessful: "+b.statusText:this)})}}}}};d.next=function(){if(!H){g=g<i.length-1?g+1:0;d.load()}};d.prev=function(){if(!H){g=g?g-1:i.length-1;d.load()}};d.close=function(){if(w&&!P){P=f;w=b;y(jb,a.onCleanup);n.unbind("."+j+" ."+Q);A.fadeTo("fast",0);h.stop().fadeTo("fast",0,function(){y(R);k.remove();h.add(A).css({opacity:1,cursor:r}).hide();try{X.focus()}catch(c){}setTimeout(function(){P=b;y(fb,a.onClosed)},1)})}};d.element=function(){return c(l)};d.settings=ib;c(d.init)})(jQuery,this);
/*!
 * jQuery Cookie Plugin v1.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
(function($,document){var pluses=/\+/g;function raw(s){return s}function decoded(s){return decodeURIComponent(s.replace(pluses," "))}$.cookie=function(key,value,options){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(value))||value==null)){options=$.extend({},$.cookie.defaults,options);if(value==null){options.expires=-1}if(typeof options.expires==="number"){var days=options.expires,t=options.expires=new Date();t.setDate(t.getDate()+days)}value=String(value);return(document.cookie=[encodeURIComponent(key),"=",options.raw?value:encodeURIComponent(value),options.expires?"; expires="+options.expires.toUTCString():"",options.path?"; path="+options.path:"",options.domain?"; domain="+options.domain:"",options.secure?"; secure":""].join(""))}options=value||$.cookie.defaults||{};var decode=options.raw?raw:decoded;var cookies=document.cookie.split("; ");for(var i=0,parts;(parts=cookies[i]&&cookies[i].split("="));i++){if(decode(parts.shift())===key){return decode(parts.join("="))}}return null};$.cookie.defaults={}})(jQuery,document);
/*! Javascript plotting library for jQuery, v. 0.7.
 *
 * Released under the MIT license by IOLA, December 2007.
 *
 */
(function(B){B.color={};B.color.make=function(F,E,C,D){var G={};G.r=F||0;G.g=E||0;G.b=C||0;G.a=D!=null?D:1;G.add=function(J,I){for(var H=0;H<J.length;++H){G[J.charAt(H)]+=I}return G.normalize()};G.scale=function(J,I){for(var H=0;H<J.length;++H){G[J.charAt(H)]*=I}return G.normalize()};G.toString=function(){if(G.a>=1){return"rgb("+[G.r,G.g,G.b].join(",")+")"}else{return"rgba("+[G.r,G.g,G.b,G.a].join(",")+")"}};G.normalize=function(){function H(J,K,I){return K<J?J:(K>I?I:K)}G.r=H(0,parseInt(G.r),255);G.g=H(0,parseInt(G.g),255);G.b=H(0,parseInt(G.b),255);G.a=H(0,G.a,1);return G};G.clone=function(){return B.color.make(G.r,G.b,G.g,G.a)};return G.normalize()};B.color.extract=function(D,C){var E;do{E=D.css(C).toLowerCase();if(E!=""&&E!="transparent"){break}D=D.parent()}while(!B.nodeName(D.get(0),"body"));if(E=="rgba(0, 0, 0, 0)"){E="transparent"}return B.color.parse(E)};B.color.parse=function(F){var E,C=B.color.make;if(E=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(F)){return C(parseInt(E[1],10),parseInt(E[2],10),parseInt(E[3],10))}if(E=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(F)){return C(parseInt(E[1],10),parseInt(E[2],10),parseInt(E[3],10),parseFloat(E[4]))}if(E=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(F)){return C(parseFloat(E[1])*2.55,parseFloat(E[2])*2.55,parseFloat(E[3])*2.55)}if(E=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(F)){return C(parseFloat(E[1])*2.55,parseFloat(E[2])*2.55,parseFloat(E[3])*2.55,parseFloat(E[4]))}if(E=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(F)){return C(parseInt(E[1],16),parseInt(E[2],16),parseInt(E[3],16))}if(E=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(F)){return C(parseInt(E[1]+E[1],16),parseInt(E[2]+E[2],16),parseInt(E[3]+E[3],16))}var D=B.trim(F).toLowerCase();if(D=="transparent"){return C(255,255,255,0)}else{E=A[D]||[0,0,0];return C(E[0],E[1],E[2])}};var A={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);(function($){function Plot(placeholder,data_,options_,plugins){var series=[],options={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:true,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:0.85},xaxis:{show:null,position:"bottom",mode:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null,monthNames:null,timeformat:null,twelveHourClock:false},yaxis:{autoscaleMargin:0.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:false,radius:3,lineWidth:2,fill:true,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:false,fillColor:null,steps:false},bars:{show:false,lineWidth:2,barWidth:1,fill:true,fillColor:null,align:"left",horizontal:false},shadowSize:3},grid:{show:true,aboveData:false,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:false,hoverable:false,autoHighlight:true,mouseActiveRadius:10},hooks:{}},canvas=null,overlay=null,eventHolder=null,ctx=null,octx=null,xaxes=[],yaxes=[],plotOffset={left:0,right:0,top:0,bottom:0},canvasWidth=0,canvasHeight=0,plotWidth=0,plotHeight=0,hooks={processOptions:[],processRawData:[],processDatapoints:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},plot=this;plot.setData=setData;plot.setupGrid=setupGrid;plot.draw=draw;plot.getPlaceholder=function(){return placeholder};plot.getCanvas=function(){return canvas};plot.getPlotOffset=function(){return plotOffset};plot.width=function(){return plotWidth};plot.height=function(){return plotHeight};plot.offset=function(){var o=eventHolder.offset();o.left+=plotOffset.left;o.top+=plotOffset.top;return o};plot.getData=function(){return series};plot.getAxes=function(){var res={},i;$.each(xaxes.concat(yaxes),function(_,axis){if(axis){res[axis.direction+(axis.n!=1?axis.n:"")+"axis"]=axis}});return res};plot.getXAxes=function(){return xaxes};plot.getYAxes=function(){return yaxes};plot.c2p=canvasToAxisCoords;plot.p2c=axisToCanvasCoords;plot.getOptions=function(){return options};plot.highlight=highlight;plot.unhighlight=unhighlight;plot.triggerRedrawOverlay=triggerRedrawOverlay;plot.pointOffset=function(point){return{left:parseInt(xaxes[axisNumber(point,"x")-1].p2c(+point.x)+plotOffset.left),top:parseInt(yaxes[axisNumber(point,"y")-1].p2c(+point.y)+plotOffset.top)}};plot.shutdown=shutdown;plot.resize=function(){getCanvasDimensions();resizeCanvas(canvas);resizeCanvas(overlay)};plot.hooks=hooks;initPlugins(plot);parseOptions(options_);setupCanvases();setData(data_);setupGrid();draw();bindEvents();function executeHooks(hook,args){args=[plot].concat(args);for(var i=0;i<hook.length;++i){hook[i].apply(this,args)}}function initPlugins(){for(var i=0;i<plugins.length;++i){var p=plugins[i];p.init(plot);if(p.options){$.extend(true,options,p.options)}}}function parseOptions(opts){var i;$.extend(true,options,opts);if(options.xaxis.color==null){options.xaxis.color=options.grid.color}if(options.yaxis.color==null){options.yaxis.color=options.grid.color}if(options.xaxis.tickColor==null){options.xaxis.tickColor=options.grid.tickColor}if(options.yaxis.tickColor==null){options.yaxis.tickColor=options.grid.tickColor}if(options.grid.borderColor==null){options.grid.borderColor=options.grid.color}if(options.grid.tickColor==null){options.grid.tickColor=$.color.parse(options.grid.color).scale("a",0.22).toString()}for(i=0;i<Math.max(1,options.xaxes.length);++i){options.xaxes[i]=$.extend(true,{},options.xaxis,options.xaxes[i])}for(i=0;i<Math.max(1,options.yaxes.length);++i){options.yaxes[i]=$.extend(true,{},options.yaxis,options.yaxes[i])}if(options.xaxis.noTicks&&options.xaxis.ticks==null){options.xaxis.ticks=options.xaxis.noTicks}if(options.yaxis.noTicks&&options.yaxis.ticks==null){options.yaxis.ticks=options.yaxis.noTicks}if(options.x2axis){options.xaxes[1]=$.extend(true,{},options.xaxis,options.x2axis);options.xaxes[1].position="top"}if(options.y2axis){options.yaxes[1]=$.extend(true,{},options.yaxis,options.y2axis);options.yaxes[1].position="right"}if(options.grid.coloredAreas){options.grid.markings=options.grid.coloredAreas}if(options.grid.coloredAreasColor){options.grid.markingsColor=options.grid.coloredAreasColor}if(options.lines){$.extend(true,options.series.lines,options.lines)}if(options.points){$.extend(true,options.series.points,options.points)}if(options.bars){$.extend(true,options.series.bars,options.bars)}if(options.shadowSize!=null){options.series.shadowSize=options.shadowSize}for(i=0;i<options.xaxes.length;++i){getOrCreateAxis(xaxes,i+1).options=options.xaxes[i]}for(i=0;i<options.yaxes.length;++i){getOrCreateAxis(yaxes,i+1).options=options.yaxes[i]}for(var n in hooks){if(options.hooks[n]&&options.hooks[n].length){hooks[n]=hooks[n].concat(options.hooks[n])}}executeHooks(hooks.processOptions,[options])}function setData(d){series=parseData(d);fillInSeriesOptions();processData()}function parseData(d){var res=[];for(var i=0;i<d.length;++i){var s=$.extend(true,{},options.series);if(d[i].data!=null){s.data=d[i].data;delete d[i].data;$.extend(true,s,d[i]);d[i].data=s.data}else{s.data=d[i]}res.push(s)}return res}function axisNumber(obj,coord){var a=obj[coord+"axis"];if(typeof a=="object"){a=a.n}if(typeof a!="number"){a=1}return a}function allAxes(){return $.grep(xaxes.concat(yaxes),function(a){return a})}function canvasToAxisCoords(pos){var res={},i,axis;for(i=0;i<xaxes.length;++i){axis=xaxes[i];if(axis&&axis.used){res["x"+axis.n]=axis.c2p(pos.left)}}for(i=0;i<yaxes.length;++i){axis=yaxes[i];if(axis&&axis.used){res["y"+axis.n]=axis.c2p(pos.top)}}if(res.x1!==undefined){res.x=res.x1}if(res.y1!==undefined){res.y=res.y1}return res}function axisToCanvasCoords(pos){var res={},i,axis,key;for(i=0;i<xaxes.length;++i){axis=xaxes[i];if(axis&&axis.used){key="x"+axis.n;if(pos[key]==null&&axis.n==1){key="x"}if(pos[key]!=null){res.left=axis.p2c(pos[key]);break}}}for(i=0;i<yaxes.length;++i){axis=yaxes[i];if(axis&&axis.used){key="y"+axis.n;if(pos[key]==null&&axis.n==1){key="y"}if(pos[key]!=null){res.top=axis.p2c(pos[key]);break}}}return res}function getOrCreateAxis(axes,number){if(!axes[number-1]){axes[number-1]={n:number,direction:axes==xaxes?"x":"y",options:$.extend(true,{},axes==xaxes?options.xaxis:options.yaxis)}}return axes[number-1]}function fillInSeriesOptions(){var i;var neededColors=series.length,usedColors=[],assignedColors=[];for(i=0;i<series.length;++i){var sc=series[i].color;if(sc!=null){--neededColors;if(typeof sc=="number"){assignedColors.push(sc)}else{usedColors.push($.color.parse(series[i].color))}}}for(i=0;i<assignedColors.length;++i){neededColors=Math.max(neededColors,assignedColors[i]+1)}var colors=[],variation=0;i=0;while(colors.length<neededColors){var c;if(options.colors.length==i){c=$.color.make(100,100,100)}else{c=$.color.parse(options.colors[i])}var sign=variation%2==1?-1:1;c.scale("rgb",1+sign*Math.ceil(variation/2)*0.2);colors.push(c);++i;if(i>=options.colors.length){i=0;++variation}}var colori=0,s;for(i=0;i<series.length;++i){s=series[i];if(s.color==null){s.color=colors[colori].toString();++colori}else{if(typeof s.color=="number"){s.color=colors[s.color].toString()}}if(s.lines.show==null){var v,show=true;for(v in s){if(s[v]&&s[v].show){show=false;break}}if(show){s.lines.show=true}}s.xaxis=getOrCreateAxis(xaxes,axisNumber(s,"x"));s.yaxis=getOrCreateAxis(yaxes,axisNumber(s,"y"))}}function processData(){var topSentry=Number.POSITIVE_INFINITY,bottomSentry=Number.NEGATIVE_INFINITY,fakeInfinity=Number.MAX_VALUE,i,j,k,m,length,s,points,ps,x,y,axis,val,f,p;function updateAxis(axis,min,max){if(min<axis.datamin&&min!=-fakeInfinity){axis.datamin=min}if(max>axis.datamax&&max!=fakeInfinity){axis.datamax=max}}$.each(allAxes(),function(_,axis){axis.datamin=topSentry;axis.datamax=bottomSentry;axis.used=false});for(i=0;i<series.length;++i){s=series[i];s.datapoints={points:[]};executeHooks(hooks.processRawData,[s,s.data,s.datapoints])}for(i=0;i<series.length;++i){s=series[i];var data=s.data,format=s.datapoints.format;if(!format){format=[];format.push({x:true,number:true,required:true});format.push({y:true,number:true,required:true});if(s.bars.show||(s.lines.show&&s.lines.fill)){format.push({y:true,number:true,required:false,defaultValue:0});if(s.bars.horizontal){delete format[format.length-1].y;format[format.length-1].x=true}}s.datapoints.format=format}if(s.datapoints.pointsize!=null){continue}s.datapoints.pointsize=format.length;ps=s.datapoints.pointsize;points=s.datapoints.points;insertSteps=s.lines.show&&s.lines.steps;s.xaxis.used=s.yaxis.used=true;for(j=k=0;j<data.length;++j,k+=ps){p=data[j];var nullify=p==null;if(!nullify){for(m=0;m<ps;++m){val=p[m];f=format[m];if(f){if(f.number&&val!=null){val=+val;if(isNaN(val)){val=null}else{if(val==Infinity){val=fakeInfinity}else{if(val==-Infinity){val=-fakeInfinity}}}}if(val==null){if(f.required){nullify=true}if(f.defaultValue!=null){val=f.defaultValue}}}points[k+m]=val}}if(nullify){for(m=0;m<ps;++m){val=points[k+m];if(val!=null){f=format[m];if(f.x){updateAxis(s.xaxis,val,val)}if(f.y){updateAxis(s.yaxis,val,val)}}points[k+m]=null}}else{if(insertSteps&&k>0&&points[k-ps]!=null&&points[k-ps]!=points[k]&&points[k-ps+1]!=points[k+1]){for(m=0;m<ps;++m){points[k+ps+m]=points[k+m]}points[k+1]=points[k-ps+1];k+=ps}}}}for(i=0;i<series.length;++i){s=series[i];executeHooks(hooks.processDatapoints,[s,s.datapoints])}for(i=0;i<series.length;++i){s=series[i];points=s.datapoints.points,ps=s.datapoints.pointsize;var xmin=topSentry,ymin=topSentry,xmax=bottomSentry,ymax=bottomSentry;for(j=0;j<points.length;j+=ps){if(points[j]==null){continue}for(m=0;m<ps;++m){val=points[j+m];f=format[m];if(!f||val==fakeInfinity||val==-fakeInfinity){continue}if(f.x){if(val<xmin){xmin=val}if(val>xmax){xmax=val}}if(f.y){if(val<ymin){ymin=val}if(val>ymax){ymax=val}}}}if(s.bars.show){var delta=s.bars.align=="left"?0:-s.bars.barWidth/2;if(s.bars.horizontal){ymin+=delta;ymax+=delta+s.bars.barWidth}else{xmin+=delta;xmax+=delta+s.bars.barWidth}}updateAxis(s.xaxis,xmin,xmax);updateAxis(s.yaxis,ymin,ymax)}$.each(allAxes(),function(_,axis){if(axis.datamin==topSentry){axis.datamin=null}if(axis.datamax==bottomSentry){axis.datamax=null}})}function makeCanvas(skipPositioning,cls){var c=document.createElement("canvas");c.className=cls;c.width=canvasWidth;c.height=canvasHeight;if(!skipPositioning){$(c).css({position:"absolute",left:0,top:0})}$(c).appendTo(placeholder);if(!c.getContext){c=window.G_vmlCanvasManager.initElement(c)}c.getContext("2d").save();return c}function getCanvasDimensions(){canvasWidth=placeholder.width();canvasHeight=placeholder.height();if(canvasWidth<=0||canvasHeight<=0){throw"Invalid dimensions for plot, width = "+canvasWidth+", height = "+canvasHeight}}function resizeCanvas(c){if(c.width!=canvasWidth){c.width=canvasWidth}if(c.height!=canvasHeight){c.height=canvasHeight}var cctx=c.getContext("2d");cctx.restore();cctx.save()}function setupCanvases(){var reused,existingCanvas=placeholder.children("canvas.base"),existingOverlay=placeholder.children("canvas.overlay");if(existingCanvas.length==0||existingOverlay==0){placeholder.html("");placeholder.css({padding:0});if(placeholder.css("position")=="static"){placeholder.css("position","relative")}getCanvasDimensions();canvas=makeCanvas(true,"base");overlay=makeCanvas(false,"overlay");reused=false}else{canvas=existingCanvas.get(0);overlay=existingOverlay.get(0);reused=true}ctx=canvas.getContext("2d");octx=overlay.getContext("2d");eventHolder=$([overlay,canvas]);if(reused){placeholder.data("plot").shutdown();plot.resize();octx.clearRect(0,0,canvasWidth,canvasHeight);eventHolder.unbind();placeholder.children().not([canvas,overlay]).remove()}placeholder.data("plot",plot)}function bindEvents(){if(options.grid.hoverable){eventHolder.mousemove(onMouseMove);eventHolder.mouseleave(onMouseLeave)}if(options.grid.clickable){eventHolder.click(onClick)}executeHooks(hooks.bindEvents,[eventHolder])}function shutdown(){if(redrawTimeout){clearTimeout(redrawTimeout)}eventHolder.unbind("mousemove",onMouseMove);eventHolder.unbind("mouseleave",onMouseLeave);eventHolder.unbind("click",onClick);executeHooks(hooks.shutdown,[eventHolder])}function setTransformationHelpers(axis){function identity(x){return x}var s,m,t=axis.options.transform||identity,it=axis.options.inverseTransform;if(axis.direction=="x"){s=axis.scale=plotWidth/Math.abs(t(axis.max)-t(axis.min));m=Math.min(t(axis.max),t(axis.min))}else{s=axis.scale=plotHeight/Math.abs(t(axis.max)-t(axis.min));s=-s;m=Math.max(t(axis.max),t(axis.min))}if(t==identity){axis.p2c=function(p){return(p-m)*s}}else{axis.p2c=function(p){return(t(p)-m)*s}}if(!it){axis.c2p=function(c){return m+c/s}}else{axis.c2p=function(c){return it(m+c/s)}}}function measureTickLabels(axis){var opts=axis.options,i,ticks=axis.ticks||[],labels=[],l,w=opts.labelWidth,h=opts.labelHeight,dummyDiv;function makeDummyDiv(labels,width){return $('<div style="position:absolute;top:-10000px;'+width+'font-size:smaller"><div class="'+axis.direction+"Axis "+axis.direction+axis.n+'Axis">'+labels.join("")+"</div></div>").appendTo(placeholder)}if(axis.direction=="x"){if(w==null){w=Math.floor(canvasWidth/(ticks.length>0?ticks.length:1))}if(h==null){labels=[];for(i=0;i<ticks.length;++i){l=ticks[i].label;if(l){labels.push('<div class="tickLabel" style="float:left;width:'+w+'px">'+l+"</div>")}}if(labels.length>0){labels.push('<div style="clear:left"></div>');dummyDiv=makeDummyDiv(labels,"width:10000px;");h=dummyDiv.height();dummyDiv.remove()}}}else{if(w==null||h==null){for(i=0;i<ticks.length;++i){l=ticks[i].label;if(l){labels.push('<div class="tickLabel">'+l+"</div>")}}if(labels.length>0){dummyDiv=makeDummyDiv(labels,"");if(w==null){w=dummyDiv.children().width()}if(h==null){h=dummyDiv.find("div.tickLabel").height()}dummyDiv.remove()}}}if(w==null){w=0}if(h==null){h=0}axis.labelWidth=w;axis.labelHeight=h}function allocateAxisBoxFirstPhase(axis){var lw=axis.labelWidth,lh=axis.labelHeight,pos=axis.options.position,tickLength=axis.options.tickLength,axismargin=options.grid.axisMargin,padding=options.grid.labelMargin,all=axis.direction=="x"?xaxes:yaxes,index;var samePosition=$.grep(all,function(a){return a&&a.options.position==pos&&a.reserveSpace});if($.inArray(axis,samePosition)==samePosition.length-1){axismargin=0}if(tickLength==null){tickLength="full"}var sameDirection=$.grep(all,function(a){return a&&a.reserveSpace});var innermost=$.inArray(axis,sameDirection)==0;if(!innermost&&tickLength=="full"){tickLength=5}if(!isNaN(+tickLength)){padding+=+tickLength}if(axis.direction=="x"){lh+=padding;if(pos=="bottom"){plotOffset.bottom+=lh+axismargin;axis.box={top:canvasHeight-plotOffset.bottom,height:lh}}else{axis.box={top:plotOffset.top+axismargin,height:lh};plotOffset.top+=lh+axismargin}}else{lw+=padding;if(pos=="left"){axis.box={left:plotOffset.left+axismargin,width:lw};plotOffset.left+=lw+axismargin}else{plotOffset.right+=lw+axismargin;axis.box={left:canvasWidth-plotOffset.right,width:lw}}}axis.position=pos;axis.tickLength=tickLength;axis.box.padding=padding;axis.innermost=innermost}function allocateAxisBoxSecondPhase(axis){if(axis.direction=="x"){axis.box.left=plotOffset.left;axis.box.width=plotWidth}else{axis.box.top=plotOffset.top;axis.box.height=plotHeight}}function setupGrid(){var i,axes=allAxes();$.each(axes,function(_,axis){axis.show=axis.options.show;if(axis.show==null){axis.show=axis.used}axis.reserveSpace=axis.show||axis.options.reserveSpace;setRange(axis)});allocatedAxes=$.grep(axes,function(axis){return axis.reserveSpace});plotOffset.left=plotOffset.right=plotOffset.top=plotOffset.bottom=0;if(options.grid.show){$.each(allocatedAxes,function(_,axis){setupTickGeneration(axis);setTicks(axis);snapRangeToTicks(axis,axis.ticks);measureTickLabels(axis)});for(i=allocatedAxes.length-1;i>=0;--i){allocateAxisBoxFirstPhase(allocatedAxes[i])}var minMargin=options.grid.minBorderMargin;if(minMargin==null){minMargin=0;for(i=0;i<series.length;++i){minMargin=Math.max(minMargin,series[i].points.radius+series[i].points.lineWidth/2)}}for(var a in plotOffset){plotOffset[a]+=options.grid.borderWidth;plotOffset[a]=Math.max(minMargin,plotOffset[a])}}plotWidth=canvasWidth-plotOffset.left-plotOffset.right;plotHeight=canvasHeight-plotOffset.bottom-plotOffset.top;$.each(axes,function(_,axis){setTransformationHelpers(axis)});if(options.grid.show){$.each(allocatedAxes,function(_,axis){allocateAxisBoxSecondPhase(axis)});insertAxisLabels()}insertLegend()}function setRange(axis){var opts=axis.options,min=+(opts.min!=null?opts.min:axis.datamin),max=+(opts.max!=null?opts.max:axis.datamax),delta=max-min;if(delta==0){var widen=max==0?1:0.01;if(opts.min==null){min-=widen}if(opts.max==null||opts.min!=null){max+=widen}}else{var margin=opts.autoscaleMargin;if(margin!=null){if(opts.min==null){min-=delta*margin;if(min<0&&axis.datamin!=null&&axis.datamin>=0){min=0}}if(opts.max==null){max+=delta*margin;if(max>0&&axis.datamax!=null&&axis.datamax<=0){max=0}}}}if(opts.maxFloor&&max<opts.maxFloor){max=opts.maxFloor}axis.min=min;axis.max=max}function setupTickGeneration(axis){var opts=axis.options;var noTicks;if(typeof opts.ticks=="number"&&opts.ticks>0){noTicks=opts.ticks}else{noTicks=0.3*Math.sqrt(axis.direction=="x"?canvasWidth:canvasHeight)}var delta=(axis.max-axis.min)/noTicks,size,generator,unit,formatter,i,magn,norm;if(opts.mode=="time"){var timeUnitSize={second:1000,minute:60*1000,hour:60*60*1000,day:24*60*60*1000,month:30*24*60*60*1000,year:365.2425*24*60*60*1000};var spec=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[0.25,"month"],[0.5,"month"],[1,"month"],[2,"month"],[3,"month"],[6,"month"],[1,"year"]];var minSize=0;if(opts.minTickSize!=null){if(typeof opts.tickSize=="number"){minSize=opts.tickSize}else{minSize=opts.minTickSize[0]*timeUnitSize[opts.minTickSize[1]]}}for(var i=0;i<spec.length-1;++i){if(delta<(spec[i][0]*timeUnitSize[spec[i][1]]+spec[i+1][0]*timeUnitSize[spec[i+1][1]])/2&&spec[i][0]*timeUnitSize[spec[i][1]]>=minSize){break}}size=spec[i][0];unit=spec[i][1];if(unit=="year"){magn=Math.pow(10,Math.floor(Math.log(delta/timeUnitSize.year)/Math.LN10));norm=(delta/timeUnitSize.year)/magn;if(norm<1.5){size=1}else{if(norm<3){size=2}else{if(norm<7.5){size=5}else{size=10}}}size*=magn}axis.tickSize=opts.tickSize||[size,unit];generator=function(axis){var ticks=[],tickSize=axis.tickSize[0],unit=axis.tickSize[1],d=new Date(axis.min);var step=tickSize*timeUnitSize[unit];if(unit=="second"){d.setUTCSeconds(floorInBase(d.getUTCSeconds(),tickSize))}if(unit=="minute"){d.setUTCMinutes(floorInBase(d.getUTCMinutes(),tickSize))}if(unit=="hour"){d.setUTCHours(floorInBase(d.getUTCHours(),tickSize))}if(unit=="month"){d.setUTCMonth(floorInBase(d.getUTCMonth(),tickSize))}if(unit=="year"){d.setUTCFullYear(floorInBase(d.getUTCFullYear(),tickSize))}d.setUTCMilliseconds(0);if(step>=timeUnitSize.minute){d.setUTCSeconds(0)}if(step>=timeUnitSize.hour){d.setUTCMinutes(0)}if(step>=timeUnitSize.day){d.setUTCHours(0)}if(step>=timeUnitSize.day*4){d.setUTCDate(1)}if(step>=timeUnitSize.year){d.setUTCMonth(0)}var carry=0,v=Number.NaN,prev;do{prev=v;v=d.getTime();ticks.push(v);if(unit=="month"){if(tickSize<1){d.setUTCDate(1);var start=d.getTime();d.setUTCMonth(d.getUTCMonth()+1);var end=d.getTime();d.setTime(v+carry*timeUnitSize.hour+(end-start)*tickSize);carry=d.getUTCHours();d.setUTCHours(0)}else{d.setUTCMonth(d.getUTCMonth()+tickSize)}}else{if(unit=="year"){d.setUTCFullYear(d.getUTCFullYear()+tickSize)}else{d.setTime(v+step)}}}while(v<axis.max&&v!=prev);return ticks};formatter=function(v,axis){var d=new Date(v);if(opts.timeformat!=null){return $.plot.formatDate(d,opts.timeformat,opts.monthNames)}var t=axis.tickSize[0]*timeUnitSize[axis.tickSize[1]];var span=axis.max-axis.min;var suffix=(opts.twelveHourClock)?" %p":"";if(t<timeUnitSize.minute){fmt="%h:%M:%S"+suffix}else{if(t<timeUnitSize.day){if(span<2*timeUnitSize.day){fmt="%h:%M"+suffix}else{fmt="%b %d %h:%M"+suffix}}else{if(t<timeUnitSize.month){fmt="%b %d"}else{if(t<timeUnitSize.year){if(span<timeUnitSize.year){fmt="%b"}else{fmt="%b %y"}}else{fmt="%y"}}}}return $.plot.formatDate(d,fmt,opts.monthNames)}}else{var maxDec=opts.tickDecimals;var dec=-Math.floor(Math.log(delta)/Math.LN10);if(maxDec!=null&&dec>maxDec){dec=maxDec}magn=Math.pow(10,-dec);norm=delta/magn;if(norm<1.5){size=1}else{if(norm<3){size=2;if(norm>2.25&&(maxDec==null||dec+1<=maxDec)){size=2.5;++dec}}else{if(norm<7.5){size=5}else{size=10}}}size*=magn;if(opts.minTickSize!=null&&size<opts.minTickSize){size=opts.minTickSize}axis.tickDecimals=Math.max(0,maxDec!=null?maxDec:dec);axis.tickSize=opts.tickSize||size;generator=function(axis){var ticks=[];var start=floorInBase(axis.min,axis.tickSize),i=0,v=Number.NaN,prev;do{prev=v;v=start+i*axis.tickSize;ticks.push(v);++i}while(v<axis.max&&v!=prev);return ticks};formatter=function(v,axis){return v.toFixed(axis.tickDecimals)}}if(opts.alignTicksWithAxis!=null){var otherAxis=(axis.direction=="x"?xaxes:yaxes)[opts.alignTicksWithAxis-1];if(otherAxis&&otherAxis.used&&otherAxis!=axis){var niceTicks=generator(axis);if(niceTicks.length>0){if(opts.min==null){axis.min=Math.min(axis.min,niceTicks[0])}if(opts.max==null&&niceTicks.length>1){axis.max=Math.max(axis.max,niceTicks[niceTicks.length-1])}}generator=function(axis){var ticks=[],v,i;for(i=0;i<otherAxis.ticks.length;++i){v=(otherAxis.ticks[i].v-otherAxis.min)/(otherAxis.max-otherAxis.min);v=axis.min+v*(axis.max-axis.min);ticks.push(v)}return ticks};if(axis.mode!="time"&&opts.tickDecimals==null){var extraDec=Math.max(0,-Math.floor(Math.log(delta)/Math.LN10)+1),ts=generator(axis);if(!(ts.length>1&&/\..*0$/.test((ts[1]-ts[0]).toFixed(extraDec)))){axis.tickDecimals=extraDec}}}}axis.tickGenerator=generator;if($.isFunction(opts.tickFormatter)){axis.tickFormatter=function(v,axis){return""+opts.tickFormatter(v,axis)}}else{axis.tickFormatter=formatter}}function setTicks(axis){var oticks=axis.options.ticks,ticks=[];if(oticks==null||(typeof oticks=="number"&&oticks>0)){ticks=axis.tickGenerator(axis)}else{if(oticks){if($.isFunction(oticks)){ticks=oticks({min:axis.min,max:axis.max})}else{ticks=oticks}}}var i,v;axis.ticks=[];for(i=0;i<ticks.length;++i){var label=null;var t=ticks[i];if(typeof t=="object"){v=+t[0];if(t.length>1){label=t[1]}}else{v=+t}if(label==null){label=axis.tickFormatter(v,axis)}if(!isNaN(v)){axis.ticks.push({v:v,label:label})}}}function snapRangeToTicks(axis,ticks){if(axis.options.autoscaleMargin&&ticks.length>0){if(axis.options.min==null){axis.min=Math.min(axis.min,ticks[0].v)}if(axis.options.max==null&&ticks.length>1){axis.max=Math.max(axis.max,ticks[ticks.length-1].v)}}}function draw(){ctx.clearRect(0,0,canvasWidth,canvasHeight);var grid=options.grid;if(grid.show&&grid.backgroundColor){drawBackground()}if(grid.show&&!grid.aboveData){drawGrid()}for(var i=0;i<series.length;++i){executeHooks(hooks.drawSeries,[ctx,series[i]]);drawSeries(series[i])}executeHooks(hooks.draw,[ctx]);if(grid.show&&grid.aboveData){drawGrid()}}function extractRange(ranges,coord){var axis,from,to,key,axes=allAxes();for(i=0;i<axes.length;++i){axis=axes[i];if(axis.direction==coord){key=coord+axis.n+"axis";if(!ranges[key]&&axis.n==1){key=coord+"axis"}if(ranges[key]){from=ranges[key].from;to=ranges[key].to;break}}}if(!ranges[key]){axis=coord=="x"?xaxes[0]:yaxes[0];from=ranges[coord+"1"];to=ranges[coord+"2"]}if(from!=null&&to!=null&&from>to){var tmp=from;from=to;to=tmp}return{from:from,to:to,axis:axis}}function drawBackground(){ctx.save();ctx.translate(plotOffset.left,plotOffset.top);ctx.fillStyle=getColorOrGradient(options.grid.backgroundColor,plotHeight,0,"rgba(255, 255, 255, 0)");ctx.fillRect(0,0,plotWidth,plotHeight);ctx.restore()}function drawGrid(){var i;ctx.save();ctx.translate(plotOffset.left,plotOffset.top);var markings=options.grid.markings;if(markings){if($.isFunction(markings)){var axes=plot.getAxes();axes.xmin=axes.xaxis.min;axes.xmax=axes.xaxis.max;axes.ymin=axes.yaxis.min;axes.ymax=axes.yaxis.max;markings=markings(axes)}for(i=0;i<markings.length;++i){var m=markings[i],xrange=extractRange(m,"x"),yrange=extractRange(m,"y");if(xrange.from==null){xrange.from=xrange.axis.min}if(xrange.to==null){xrange.to=xrange.axis.max}if(yrange.from==null){yrange.from=yrange.axis.min}if(yrange.to==null){yrange.to=yrange.axis.max}if(xrange.to<xrange.axis.min||xrange.from>xrange.axis.max||yrange.to<yrange.axis.min||yrange.from>yrange.axis.max){continue}xrange.from=Math.max(xrange.from,xrange.axis.min);xrange.to=Math.min(xrange.to,xrange.axis.max);yrange.from=Math.max(yrange.from,yrange.axis.min);yrange.to=Math.min(yrange.to,yrange.axis.max);if(xrange.from==xrange.to&&yrange.from==yrange.to){continue}xrange.from=xrange.axis.p2c(xrange.from);xrange.to=xrange.axis.p2c(xrange.to);yrange.from=yrange.axis.p2c(yrange.from);yrange.to=yrange.axis.p2c(yrange.to);if(xrange.from==xrange.to||yrange.from==yrange.to){ctx.beginPath();ctx.strokeStyle=m.color||options.grid.markingsColor;ctx.lineWidth=m.lineWidth||options.grid.markingsLineWidth;ctx.moveTo(xrange.from,yrange.from);ctx.lineTo(xrange.to,yrange.to);ctx.stroke()}else{ctx.fillStyle=m.color||options.grid.markingsColor;ctx.fillRect(xrange.from,yrange.to,xrange.to-xrange.from,yrange.from-yrange.to)}}}var axes=allAxes(),bw=options.grid.borderWidth;for(var j=0;j<axes.length;++j){var axis=axes[j],box=axis.box,t=axis.tickLength,x,y,xoff,yoff;if(!axis.show||axis.ticks.length==0){continue}ctx.strokeStyle=axis.options.tickColor||$.color.parse(axis.options.color).scale("a",0.22).toString();ctx.lineWidth=1;if(axis.direction=="x"){x=0;if(t=="full"){y=(axis.position=="top"?0:plotHeight)}else{y=box.top-plotOffset.top+(axis.position=="top"?box.height:0)}}else{y=0;if(t=="full"){x=(axis.position=="left"?0:plotWidth)}else{x=box.left-plotOffset.left+(axis.position=="left"?box.width:0)}}if(!axis.innermost){ctx.beginPath();xoff=yoff=0;if(axis.direction=="x"){xoff=plotWidth}else{yoff=plotHeight}if(ctx.lineWidth==1){x=Math.floor(x)+0.5;y=Math.floor(y)+0.5}ctx.moveTo(x,y);ctx.lineTo(x+xoff,y+yoff);ctx.stroke()}ctx.beginPath();for(i=0;i<axis.ticks.length;++i){var v=axis.ticks[i].v;xoff=yoff=0;if(v<axis.min||v>axis.max||(t=="full"&&bw>0&&(v==axis.min||v==axis.max))){continue}if(axis.direction=="x"){x=axis.p2c(v);yoff=t=="full"?-plotHeight:t;if(axis.position=="top"){yoff=-yoff}}else{y=axis.p2c(v);xoff=t=="full"?-plotWidth:t;if(axis.position=="left"){xoff=-xoff}}if(ctx.lineWidth==1){if(axis.direction=="x"){x=Math.floor(x)+0.5}else{y=Math.floor(y)+0.5}}ctx.moveTo(x,y);ctx.lineTo(x+xoff,y+yoff)}ctx.stroke()}if(bw){ctx.lineWidth=bw;ctx.strokeStyle=options.grid.borderColor;ctx.strokeRect(-bw/2,-bw/2,plotWidth+bw,plotHeight+bw)}ctx.restore()}function insertAxisLabels(){placeholder.find(".tickLabels").remove();var html=['<div class="tickLabels" style="font-size:smaller">'];var axes=allAxes();for(var j=0;j<axes.length;++j){var axis=axes[j],box=axis.box;if(!axis.show){continue}html.push('<div class="'+axis.direction+"Axis "+axis.direction+axis.n+'Axis" style="color:'+axis.options.color+'">');for(var i=0;i<axis.ticks.length;++i){var tick=axis.ticks[i];if(!tick.label||tick.v<axis.min||tick.v>axis.max){continue}var pos={},align;if(axis.direction=="x"){align="center";pos.left=Math.round(plotOffset.left+axis.p2c(tick.v)-axis.labelWidth/2);if(axis.position=="bottom"){pos.top=box.top+box.padding}else{pos.bottom=canvasHeight-(box.top+box.height-box.padding)}}else{pos.top=Math.round(plotOffset.top+axis.p2c(tick.v)-axis.labelHeight/2);if(axis.position=="left"){pos.right=canvasWidth-(box.left+box.width-box.padding);align="right"}else{pos.left=box.left+box.padding;align="left"}}pos.width=axis.labelWidth;var style=["position:absolute","text-align:"+align];for(var a in pos){style.push(a+":"+pos[a]+"px")}html.push('<div class="tickLabel" style="'+style.join(";")+'">'+tick.label+"</div>")}html.push("</div>")}html.push("</div>");placeholder.append(html.join(""))}function drawSeries(series){if(series.lines.show){drawSeriesLines(series)}if(series.bars.show){drawSeriesBars(series)}if(series.points.show){drawSeriesPoints(series)}}function drawSeriesLines(series){function plotLine(datapoints,xoffset,yoffset,axisx,axisy){var points=datapoints.points,ps=datapoints.pointsize,prevx=null,prevy=null;ctx.beginPath();for(var i=ps;i<points.length;i+=ps){var x1=points[i-ps],y1=points[i-ps+1],x2=points[i],y2=points[i+1];if(x1==null||x2==null){continue}if(y1<=y2&&y1<axisy.min){if(y2<axisy.min){continue}x1=(axisy.min-y1)/(y2-y1)*(x2-x1)+x1;y1=axisy.min}else{if(y2<=y1&&y2<axisy.min){if(y1<axisy.min){continue}x2=(axisy.min-y1)/(y2-y1)*(x2-x1)+x1;y2=axisy.min}}if(y1>=y2&&y1>axisy.max){if(y2>axisy.max){continue}x1=(axisy.max-y1)/(y2-y1)*(x2-x1)+x1;y1=axisy.max}else{if(y2>=y1&&y2>axisy.max){if(y1>axisy.max){continue}x2=(axisy.max-y1)/(y2-y1)*(x2-x1)+x1;y2=axisy.max}}if(x1<=x2&&x1<axisx.min){if(x2<axisx.min){continue}y1=(axisx.min-x1)/(x2-x1)*(y2-y1)+y1;x1=axisx.min}else{if(x2<=x1&&x2<axisx.min){if(x1<axisx.min){continue}y2=(axisx.min-x1)/(x2-x1)*(y2-y1)+y1;x2=axisx.min}}if(x1>=x2&&x1>axisx.max){if(x2>axisx.max){continue}y1=(axisx.max-x1)/(x2-x1)*(y2-y1)+y1;x1=axisx.max}else{if(x2>=x1&&x2>axisx.max){if(x1>axisx.max){continue}y2=(axisx.max-x1)/(x2-x1)*(y2-y1)+y1;x2=axisx.max}}if(x1!=prevx||y1!=prevy){ctx.moveTo(axisx.p2c(x1)+xoffset,axisy.p2c(y1)+yoffset)}prevx=x2;prevy=y2;ctx.lineTo(axisx.p2c(x2)+xoffset,axisy.p2c(y2)+yoffset)}ctx.stroke()}function plotLineArea(datapoints,axisx,axisy){var points=datapoints.points,ps=datapoints.pointsize,bottom=Math.min(Math.max(0,axisy.min),axisy.max),i=0,top,areaOpen=false,ypos=1,segmentStart=0,segmentEnd=0;while(true){if(ps>0&&i>points.length+ps){break}i+=ps;var x1=points[i-ps],y1=points[i-ps+ypos],x2=points[i],y2=points[i+ypos];if(areaOpen){if(ps>0&&x1!=null&&x2==null){segmentEnd=i;ps=-ps;ypos=2;continue}if(ps<0&&i==segmentStart+ps){ctx.fill();areaOpen=false;ps=-ps;ypos=1;i=segmentStart=segmentEnd+ps;continue}}if(x1==null||x2==null){continue}if(x1<=x2&&x1<axisx.min){if(x2<axisx.min){continue}y1=(axisx.min-x1)/(x2-x1)*(y2-y1)+y1;x1=axisx.min}else{if(x2<=x1&&x2<axisx.min){if(x1<axisx.min){continue}y2=(axisx.min-x1)/(x2-x1)*(y2-y1)+y1;x2=axisx.min}}if(x1>=x2&&x1>axisx.max){if(x2>axisx.max){continue}y1=(axisx.max-x1)/(x2-x1)*(y2-y1)+y1;x1=axisx.max}else{if(x2>=x1&&x2>axisx.max){if(x1>axisx.max){continue}y2=(axisx.max-x1)/(x2-x1)*(y2-y1)+y1;x2=axisx.max}}if(!areaOpen){ctx.beginPath();ctx.moveTo(axisx.p2c(x1),axisy.p2c(bottom));areaOpen=true}if(y1>=axisy.max&&y2>=axisy.max){ctx.lineTo(axisx.p2c(x1),axisy.p2c(axisy.max));ctx.lineTo(axisx.p2c(x2),axisy.p2c(axisy.max));continue}else{if(y1<=axisy.min&&y2<=axisy.min){ctx.lineTo(axisx.p2c(x1),axisy.p2c(axisy.min));ctx.lineTo(axisx.p2c(x2),axisy.p2c(axisy.min));continue}}var x1old=x1,x2old=x2;if(y1<=y2&&y1<axisy.min&&y2>=axisy.min){x1=(axisy.min-y1)/(y2-y1)*(x2-x1)+x1;y1=axisy.min}else{if(y2<=y1&&y2<axisy.min&&y1>=axisy.min){x2=(axisy.min-y1)/(y2-y1)*(x2-x1)+x1;y2=axisy.min}}if(y1>=y2&&y1>axisy.max&&y2<=axisy.max){x1=(axisy.max-y1)/(y2-y1)*(x2-x1)+x1;y1=axisy.max}else{if(y2>=y1&&y2>axisy.max&&y1<=axisy.max){x2=(axisy.max-y1)/(y2-y1)*(x2-x1)+x1;y2=axisy.max}}if(x1!=x1old){ctx.lineTo(axisx.p2c(x1old),axisy.p2c(y1))}ctx.lineTo(axisx.p2c(x1),axisy.p2c(y1));ctx.lineTo(axisx.p2c(x2),axisy.p2c(y2));if(x2!=x2old){ctx.lineTo(axisx.p2c(x2),axisy.p2c(y2));ctx.lineTo(axisx.p2c(x2old),axisy.p2c(y2))}}}ctx.save();ctx.translate(plotOffset.left,plotOffset.top);ctx.lineJoin="round";var lw=series.lines.lineWidth,sw=series.shadowSize;if(lw>0&&sw>0){ctx.lineWidth=sw;ctx.strokeStyle="rgba(0,0,0,0.1)";var angle=Math.PI/18;plotLine(series.datapoints,Math.sin(angle)*(lw/2+sw/2),Math.cos(angle)*(lw/2+sw/2),series.xaxis,series.yaxis);ctx.lineWidth=sw/2;plotLine(series.datapoints,Math.sin(angle)*(lw/2+sw/4),Math.cos(angle)*(lw/2+sw/4),series.xaxis,series.yaxis)}ctx.lineWidth=lw;ctx.strokeStyle=series.color;var fillStyle=getFillStyle(series.lines,series.color,0,plotHeight);if(fillStyle){ctx.fillStyle=fillStyle;plotLineArea(series.datapoints,series.xaxis,series.yaxis)}if(lw>0){plotLine(series.datapoints,0,0,series.xaxis,series.yaxis)}ctx.restore()}function drawSeriesPoints(series){function plotPoints(datapoints,radius,fillStyle,offset,shadow,axisx,axisy,symbol){var points=datapoints.points,ps=datapoints.pointsize;for(var i=0;i<points.length;i+=ps){var x=points[i],y=points[i+1];if(x==null||x<axisx.min||x>axisx.max||y<axisy.min||y>axisy.max){continue}ctx.beginPath();x=axisx.p2c(x);y=axisy.p2c(y)+offset;if(symbol=="circle"){ctx.arc(x,y,radius,0,shadow?Math.PI:Math.PI*2,false)}else{symbol(ctx,x,y,radius,shadow)}ctx.closePath();if(fillStyle){ctx.fillStyle=fillStyle;ctx.fill()}ctx.stroke()}}ctx.save();ctx.translate(plotOffset.left,plotOffset.top);var lw=series.points.lineWidth,sw=series.shadowSize,radius=series.points.radius,symbol=series.points.symbol;if(lw>0&&sw>0){var w=sw/2;ctx.lineWidth=w;ctx.strokeStyle="rgba(0,0,0,0.1)";plotPoints(series.datapoints,radius,null,w+w/2,true,series.xaxis,series.yaxis,symbol);ctx.strokeStyle="rgba(0,0,0,0.2)";plotPoints(series.datapoints,radius,null,w/2,true,series.xaxis,series.yaxis,symbol)}ctx.lineWidth=lw;ctx.strokeStyle=series.color;plotPoints(series.datapoints,radius,getFillStyle(series.points,series.color),0,false,series.xaxis,series.yaxis,symbol);ctx.restore()}function drawBar(x,y,b,barLeft,barRight,offset,fillStyleCallback,axisx,axisy,c,horizontal,lineWidth){var left,right,bottom,top,drawLeft,drawRight,drawTop,drawBottom,tmp;if(horizontal){drawBottom=drawRight=drawTop=true;drawLeft=false;left=b;right=x;top=y+barLeft;bottom=y+barRight;if(right<left){tmp=right;right=left;left=tmp;drawLeft=true;drawRight=false}}else{drawLeft=drawRight=drawTop=true;drawBottom=false;left=x+barLeft;right=x+barRight;bottom=b;top=y;if(top<bottom){tmp=top;top=bottom;bottom=tmp;drawBottom=true;drawTop=false}}if(right<axisx.min||left>axisx.max||top<axisy.min||bottom>axisy.max){return}if(left<axisx.min){left=axisx.min;drawLeft=false}if(right>axisx.max){right=axisx.max;drawRight=false}if(bottom<axisy.min){bottom=axisy.min;drawBottom=false}if(top>axisy.max){top=axisy.max;drawTop=false}left=axisx.p2c(left);bottom=axisy.p2c(bottom);right=axisx.p2c(right);top=axisy.p2c(top);if(fillStyleCallback){c.beginPath();c.moveTo(left,bottom);c.lineTo(left,top);c.lineTo(right,top);c.lineTo(right,bottom);c.fillStyle=fillStyleCallback(bottom,top);c.fill()}if(lineWidth>0&&(drawLeft||drawRight||drawTop||drawBottom)){c.beginPath();c.moveTo(left,bottom+offset);if(drawLeft){c.lineTo(left,top+offset)}else{c.moveTo(left,top+offset)}if(drawTop){c.lineTo(right,top+offset)}else{c.moveTo(right,top+offset)}if(drawRight){c.lineTo(right,bottom+offset)}else{c.moveTo(right,bottom+offset)}if(drawBottom){c.lineTo(left,bottom+offset)}else{c.moveTo(left,bottom+offset)}c.stroke()}}function drawSeriesBars(series){function plotBars(datapoints,barLeft,barRight,offset,fillStyleCallback,axisx,axisy){var points=datapoints.points,ps=datapoints.pointsize;for(var i=0;i<points.length;i+=ps){if(points[i]==null){continue}drawBar(points[i],points[i+1],points[i+2],barLeft,barRight,offset,fillStyleCallback,axisx,axisy,ctx,series.bars.horizontal,series.bars.lineWidth)}}ctx.save();ctx.translate(plotOffset.left,plotOffset.top);ctx.lineWidth=series.bars.lineWidth;ctx.strokeStyle=series.color;var barLeft=series.bars.align=="left"?0:-series.bars.barWidth/2;var fillStyleCallback=series.bars.fill?function(bottom,top){return getFillStyle(series.bars,series.color,bottom,top)}:null;plotBars(series.datapoints,barLeft,barLeft+series.bars.barWidth,0,fillStyleCallback,series.xaxis,series.yaxis);ctx.restore()}function getFillStyle(filloptions,seriesColor,bottom,top){var fill=filloptions.fill;if(!fill){return null}if(filloptions.fillColor){return getColorOrGradient(filloptions.fillColor,bottom,top,seriesColor)}var c=$.color.parse(seriesColor);c.a=typeof fill=="number"?fill:0.4;c.normalize();return c.toString()}function insertLegend(){placeholder.find(".legend").remove();if(!options.legend.show){return}var fragments=[],rowStarted=false,lf=options.legend.labelFormatter,s,label;for(var i=0;i<series.length;++i){s=series[i];label=s.label;if(!label){continue}if(i%options.legend.noColumns==0){if(rowStarted){fragments.push("</tr>")}fragments.push("<tr>");rowStarted=true}if(lf){label=lf(label,s)}fragments.push('<td class="legendColorBox"><div style="border:1px solid '+options.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+s.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+label+"</td>")}if(rowStarted){fragments.push("</tr>")}if(fragments.length==0){return}var table='<table style="font-size:smaller;color:'+options.grid.color+'">'+fragments.join("")+"</table>";if(options.legend.container!=null){$(options.legend.container).html(table)}else{var pos="",p=options.legend.position,m=options.legend.margin;if(m[0]==null){m=[m,m]}if(p.charAt(0)=="n"){pos+="top:"+(m[1]+plotOffset.top)+"px;"}else{if(p.charAt(0)=="s"){pos+="bottom:"+(m[1]+plotOffset.bottom)+"px;"}}if(p.charAt(1)=="e"){pos+="right:"+(m[0]+plotOffset.right)+"px;"}else{if(p.charAt(1)=="w"){pos+="left:"+(m[0]+plotOffset.left)+"px;"}}var legend=$('<div class="legend">'+table.replace('style="','style="position:absolute;'+pos+";")+"</div>").appendTo(placeholder);if(options.legend.backgroundOpacity!=0){var c=options.legend.backgroundColor;if(c==null){c=options.grid.backgroundColor;if(c&&typeof c=="string"){c=$.color.parse(c)}else{c=$.color.extract(legend,"background-color")}c.a=1;c=c.toString()}var div=legend.children();$('<div style="position:absolute;width:'+div.width()+"px;height:"+div.height()+"px;"+pos+"background-color:"+c+';"> </div>').prependTo(legend).css("opacity",options.legend.backgroundOpacity)}}}var highlights=[],redrawTimeout=null;function findNearbyItem(mouseX,mouseY,seriesFilter){var maxDistance=options.grid.mouseActiveRadius,smallestDistance=maxDistance*maxDistance+1,item=null,foundPoint=false,i,j;for(i=series.length-1;i>=0;--i){if(!seriesFilter(series[i])){continue}var s=series[i],axisx=s.xaxis,axisy=s.yaxis,points=s.datapoints.points,ps=s.datapoints.pointsize,mx=axisx.c2p(mouseX),my=axisy.c2p(mouseY),maxx=maxDistance/axisx.scale,maxy=maxDistance/axisy.scale;if(axisx.options.inverseTransform){maxx=Number.MAX_VALUE}if(axisy.options.inverseTransform){maxy=Number.MAX_VALUE}if(s.lines.show||s.points.show){for(j=0;j<points.length;j+=ps){var x=points[j],y=points[j+1];if(x==null){continue}if(x-mx>maxx||x-mx<-maxx||y-my>maxy||y-my<-maxy){continue}var dx=Math.abs(axisx.p2c(x)-mouseX),dy=Math.abs(axisy.p2c(y)-mouseY),dist=dx*dx+dy*dy;if(dist<smallestDistance){smallestDistance=dist;item=[i,j/ps]}}}if(s.bars.show&&!item){var barLeft=s.bars.align=="left"?0:-s.bars.barWidth/2,barRight=barLeft+s.bars.barWidth;for(j=0;j<points.length;j+=ps){var x=points[j],y=points[j+1],b=points[j+2];if(x==null){continue}if(series[i].bars.horizontal?(mx<=Math.max(b,x)&&mx>=Math.min(b,x)&&my>=y+barLeft&&my<=y+barRight):(mx>=x+barLeft&&mx<=x+barRight&&my>=Math.min(b,y)&&my<=Math.max(b,y))){item=[i,j/ps]}}}}if(item){i=item[0];j=item[1];ps=series[i].datapoints.pointsize;return{datapoint:series[i].datapoints.points.slice(j*ps,(j+1)*ps),dataIndex:j,series:series[i],seriesIndex:i}}return null}function onMouseMove(e){if(options.grid.hoverable){triggerClickHoverEvent("plothover",e,function(s){return s.hoverable!=false})}}function onMouseLeave(e){if(options.grid.hoverable){triggerClickHoverEvent("plothover",e,function(s){return false})}}function onClick(e){triggerClickHoverEvent("plotclick",e,function(s){return s.clickable!=false})}function triggerClickHoverEvent(eventname,event,seriesFilter){var offset=eventHolder.offset(),canvasX=event.pageX-offset.left-plotOffset.left,canvasY=event.pageY-offset.top-plotOffset.top,pos=canvasToAxisCoords({left:canvasX,top:canvasY});pos.pageX=event.pageX;pos.pageY=event.pageY;var item=findNearbyItem(canvasX,canvasY,seriesFilter);if(item){item.pageX=parseInt(item.series.xaxis.p2c(item.datapoint[0])+offset.left+plotOffset.left);item.pageY=parseInt(item.series.yaxis.p2c(item.datapoint[1])+offset.top+plotOffset.top)}if(options.grid.autoHighlight){for(var i=0;i<highlights.length;++i){var h=highlights[i];if(h.auto==eventname&&!(item&&h.series==item.series&&h.point[0]==item.datapoint[0]&&h.point[1]==item.datapoint[1])){unhighlight(h.series,h.point)}}if(item){highlight(item.series,item.datapoint,eventname)}}placeholder.trigger(eventname,[pos,item])}function triggerRedrawOverlay(){if(!redrawTimeout){redrawTimeout=setTimeout(drawOverlay,30)}}function drawOverlay(){redrawTimeout=null;octx.save();octx.clearRect(0,0,canvasWidth,canvasHeight);octx.translate(plotOffset.left,plotOffset.top);var i,hi;for(i=0;i<highlights.length;++i){hi=highlights[i];if(hi.series.bars.show){drawBarHighlight(hi.series,hi.point)}else{drawPointHighlight(hi.series,hi.point)}}octx.restore();executeHooks(hooks.drawOverlay,[octx])}function highlight(s,point,auto){if(typeof s=="number"){s=series[s]}if(typeof point=="number"){var ps=s.datapoints.pointsize;point=s.datapoints.points.slice(ps*point,ps*(point+1))}var i=indexOfHighlight(s,point);if(i==-1){highlights.push({series:s,point:point,auto:auto});triggerRedrawOverlay()}else{if(!auto){highlights[i].auto=false}}}function unhighlight(s,point){if(s==null&&point==null){highlights=[];triggerRedrawOverlay()}if(typeof s=="number"){s=series[s]}if(typeof point=="number"){point=s.data[point]}var i=indexOfHighlight(s,point);if(i!=-1){highlights.splice(i,1);triggerRedrawOverlay()}}function indexOfHighlight(s,p){for(var i=0;i<highlights.length;++i){var h=highlights[i];if(h.series==s&&h.point[0]==p[0]&&h.point[1]==p[1]){return i}}return -1}function drawPointHighlight(series,point){var x=point[0],y=point[1],axisx=series.xaxis,axisy=series.yaxis;if(x<axisx.min||x>axisx.max||y<axisy.min||y>axisy.max){return}var pointRadius=series.points.radius+series.points.lineWidth/2;octx.lineWidth=pointRadius;octx.strokeStyle=$.color.parse(series.color).scale("a",0.5).toString();var radius=1.5*pointRadius,x=axisx.p2c(x),y=axisy.p2c(y);octx.beginPath();if(series.points.symbol=="circle"){octx.arc(x,y,radius,0,2*Math.PI,false)}else{series.points.symbol(octx,x,y,radius,false)}octx.closePath();octx.stroke()}function drawBarHighlight(series,point){octx.lineWidth=series.bars.lineWidth;octx.strokeStyle=$.color.parse(series.color).scale("a",0.5).toString();var fillStyle=$.color.parse(series.color).scale("a",0.5).toString();var barLeft=series.bars.align=="left"?0:-series.bars.barWidth/2;drawBar(point[0],point[1],point[2]||0,barLeft,barLeft+series.bars.barWidth,0,function(){return fillStyle},series.xaxis,series.yaxis,octx,series.bars.horizontal,series.bars.lineWidth)}function getColorOrGradient(spec,bottom,top,defaultColor){if(typeof spec=="string"){return spec}else{var gradient=ctx.createLinearGradient(0,top,0,bottom);for(var i=0,l=spec.colors.length;i<l;++i){var c=spec.colors[i];if(typeof c!="string"){var co=$.color.parse(defaultColor);if(c.brightness!=null){co=co.scale("rgb",c.brightness)}if(c.opacity!=null){co.a*=c.opacity}c=co.toString()}gradient.addColorStop(i/(l-1),c)}return gradient}}}$.plot=function(placeholder,data,options){var plot=new Plot($(placeholder),data,options,$.plot.plugins);return plot};$.plot.version="0.7";$.plot.plugins=[];$.plot.formatDate=function(d,fmt,monthNames){var leftPad=function(n){n=""+n;return n.length==1?"0"+n:n};var r=[];var escape=false,padNext=false;var hours=d.getUTCHours();var isAM=hours<12;if(monthNames==null){monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}if(fmt.search(/%p|%P/)!=-1){if(hours>12){hours=hours-12}else{if(hours==0){hours=12}}}for(var i=0;i<fmt.length;++i){var c=fmt.charAt(i);if(escape){switch(c){case"h":c=""+hours;break;case"H":c=leftPad(hours);break;case"M":c=leftPad(d.getUTCMinutes());break;case"S":c=leftPad(d.getUTCSeconds());break;case"d":c=""+d.getUTCDate();break;case"m":c=""+(d.getUTCMonth()+1);break;case"y":c=""+d.getUTCFullYear();break;case"b":c=""+monthNames[d.getUTCMonth()];break;case"p":c=(isAM)?("am"):("pm");break;case"P":c=(isAM)?("AM"):("PM");break;case"0":c="";padNext=true;break}if(c&&padNext){c=leftPad(c);padNext=false}r.push(c);if(!padNext){escape=false}}else{if(c=="%"){escape=true}else{r.push(c)}}}return r.join("")};function floorInBase(n,base){return base*Math.floor(n/base)}})(jQuery);(function($){$.fn.forceRedraw=function(brutal){$(this).addClass("forceRedraw").removeClass("forceRedraw");if(brutal){var paddingLeft=$(this).css("padding-left");var parsedPaddingLeft=parseInt(paddingLeft,10);$(this).css("padding-left",++parsedPaddingLeft);window.setTimeout($.proxy(function(){$(this).css("padding-left",paddingLeft)},this),1)}}})(jQuery);(function($){var locationWrapper={put:function(hash,win){(win||window).location.hash=this.encoder(hash)},get:function(win){var hash=((win||window).location.hash).replace(/^#/,"");try{return $.browser.mozilla?hash:decodeURIComponent(hash)}catch(error){return hash}},encoder:encodeURIComponent};var iframeWrapper={id:"__jQuery_history",init:function(){var html='<iframe id="'+this.id+'" style="display:none" src="javascript:false;" />';$("body").prepend(html);return this},_document:function(){return $("#"+this.id)[0].contentWindow.document},put:function(hash){var doc=this._document();doc.open();doc.close();locationWrapper.put(hash,doc)},get:function(){return locationWrapper.get(this._document())}};function initObjects(options){options=$.extend({unescape:false},options||{});locationWrapper.encoder=encoder(options.unescape);function encoder(unescape_){if(unescape_===true){return function(hash){return hash}}if(typeof unescape_=="string"&&(unescape_=partialDecoder(unescape_.split("")))||typeof unescape_=="function"){return function(hash){return unescape_(encodeURIComponent(hash))}}return encodeURIComponent}function partialDecoder(chars){var re=new RegExp($.map(chars,encodeURIComponent).join("|"),"ig");return function(enc){return enc.replace(re,decodeURIComponent)}}}var implementations={};implementations.base={callback:undefined,type:undefined,check:function(){},load:function(hash){},init:function(callback,options){initObjects(options);self.callback=callback;self._options=options;self._init()},_init:function(){},_options:{}};implementations.timer={_appState:undefined,_init:function(){var current_hash=locationWrapper.get();self._appState=current_hash;self.callback(current_hash);setInterval(self.check,100)},check:function(){var current_hash=locationWrapper.get();if(current_hash!=self._appState){self._appState=current_hash;self.callback(current_hash)}},load:function(hash){if(hash!=self._appState){locationWrapper.put(hash);self._appState=hash;self.callback(hash)}}};implementations.iframeTimer={_appState:undefined,_init:function(){var current_hash=locationWrapper.get();self._appState=current_hash;iframeWrapper.init().put(current_hash);self.callback(current_hash);setInterval(self.check,100)},check:function(){var iframe_hash=iframeWrapper.get(),location_hash=locationWrapper.get();if(location_hash!=iframe_hash){if(location_hash==self._appState){self._appState=iframe_hash;locationWrapper.put(iframe_hash);self.callback(iframe_hash)}else{self._appState=location_hash;iframeWrapper.put(location_hash);self.callback(location_hash)}}},load:function(hash){if(hash!=self._appState){locationWrapper.put(hash);iframeWrapper.put(hash);self._appState=hash;self.callback(hash)}}};implementations.hashchangeEvent={_init:function(){self.callback(locationWrapper.get());$(window).bind("hashchange",self.check)},check:function(){self.callback(locationWrapper.get())},load:function(hash){locationWrapper.put(hash)}};var self=$.extend({},implementations.base);if($.browser.msie&&($.browser.version<8||document.documentMode<8)){self.type="iframeTimer"}else{if("onhashchange" in window){self.type="hashchangeEvent"}else{self.type="timer"}}$.extend(self,implementations[self.type]);$.history=self})(jQuery);(function(jQuery){jQuery.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};function keyHandler(handleObj){if(typeof handleObj.data!=="string"){return}var origHandler=handleObj.handler,keys=handleObj.data.toLowerCase().split(" ");handleObj.handler=function(event){if(this!==event.target&&(/textarea|select/i.test(event.target.nodeName)||event.target.type==="text")){return}var special=event.type!=="keypress"&&jQuery.hotkeys.specialKeys[event.which],character=String.fromCharCode(event.which).toLowerCase(),key,modif="",possible={};if(event.altKey&&special!=="alt"){modif+="alt+"}if(event.ctrlKey&&special!=="ctrl"){modif+="ctrl+"}if(event.metaKey&&!event.ctrlKey&&special!=="meta"){modif+="meta+"}if(event.shiftKey&&special!=="shift"){modif+="shift+"}if(special){possible[modif+special]=true}else{possible[modif+character]=true;possible[modif+jQuery.hotkeys.shiftNums[character]]=true;if(modif==="shift+"){possible[jQuery.hotkeys.shiftNums[character]]=true}}for(var i=0,l=keys.length;i<l;i++){if(possible[keys[i]]){return origHandler.apply(this,arguments)}}}}jQuery.each(["keydown","keyup","keypress"],function(){jQuery.event.special[this]={add:keyHandler}})})(jQuery);
/*!
 * jQuery idleTimer plugin
 * version 0.9.100511
 * by Paul Irish. 
 *   http://github.com/paulirish/yui-misc/tree/
 * MIT license

 * adapted from YUI idle timer by nzakas:
 *   http://github.com/nzakas/yui-misc/
*/
(function($){$.idleTimer=function(newTimeout,elem){var idle=false,enabled=true,timeout=30000,events="mousemove keydown DOMMouseScroll mousewheel mousedown";elem=elem||document;var toggleIdleState=function(myelem){if(typeof myelem=="number"){myelem=undefined}var obj=$.data(myelem||elem,"idleTimerObj");obj.idle=!obj.idle;obj.olddate=+new Date;var event=jQuery.Event($.data(elem,"idleTimer",obj.idle?"idle":"active")+".idleTimer");event.stopPropagation();$(elem).trigger(event)},stop=function(elem){var obj=$.data(elem,"idleTimerObj");obj.enabled=false;clearTimeout(obj.tId);$(elem).unbind(".idleTimer")},handleUserEvent=function(){var obj=$.data(this,"idleTimerObj");clearTimeout(obj.tId);if(obj.enabled){if(obj.idle){toggleIdleState(this)}obj.tId=setTimeout(toggleIdleState,obj.timeout)}};var obj=$.data(elem,"idleTimerObj")||new function(){};obj.olddate=obj.olddate||+new Date;if(typeof newTimeout=="number"){timeout=newTimeout}else{if(newTimeout==="destroy"){stop(elem);return this}else{if(newTimeout==="getElapsedTime"){return(+new Date)-obj.olddate}}}$(elem).bind($.trim((events+" ").split(" ").join(".idleTimer ")),handleUserEvent);obj.idle=idle;obj.enabled=enabled;obj.timeout=timeout;obj.tId=setTimeout(toggleIdleState,obj.timeout);$.data(elem,"idleTimer","active");$.data(elem,"idleTimerObj",obj)};$.fn.idleTimer=function(newTimeout){this[0]&&$.idleTimer(newTimeout,this[0]);return this}})(jQuery);jQuery.fn.extend({insertAtCaret:function(myValue){return this.each(function(i){if(document.selection){this.focus();sel=document.selection.createRange();sel.text=myValue;this.focus()}else{if(this.selectionStart||this.selectionStart=="0"){var startPos=this.selectionStart;var endPos=this.selectionEnd;var scrollTop=this.scrollTop;this.value=this.value.substring(0,startPos)+myValue+this.value.substring(endPos,this.value.length);this.focus();this.selectionStart=startPos+myValue.length;this.selectionEnd=startPos+myValue.length;this.scrollTop=scrollTop}else{this.value+=myValue;this.focus()}}})}});(function($){var Mustache=function(){var Renderer=function(){};Renderer.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":true},context:{},render:function(template,context,partials,in_recursion){if(!in_recursion){this.context=context;this.buffer=[]}if(!this.includes("",template)){if(in_recursion){return template}else{this.send(template);return}}template=this.render_pragmas(template);var html=this.render_section(template,context,partials);if(in_recursion){return this.render_tags(html,context,partials,in_recursion)}this.render_tags(html,context,partials,in_recursion)},send:function(line){if(line!==""){this.buffer.push(line)}},render_pragmas:function(template){if(!this.includes("%",template)){return template}var that=this;var regex=new RegExp(this.otag+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+this.ctag,"g");return template.replace(regex,function(match,pragma,options){if(!that.pragmas_implemented[pragma]){throw ({message:"This implementation of mustache doesn't understand the '"+pragma+"' pragma"})}that.pragmas[pragma]={};if(options){var opts=options.split("=");that.pragmas[pragma][opts[0]]=opts[1]}return""})},render_partial:function(name,context,partials){name=this.trim(name);if(!partials||partials[name]===undefined){throw ({message:"unknown_partial '"+name+"'"})}if(typeof(context[name])!="object"){return this.render(partials[name],context,partials,true)}return this.render(partials[name],context[name],partials,true)},render_section:function(template,context,partials){if(!this.includes("#",template)&&!this.includes("^",template)){return template}var that=this;var regex=new RegExp(this.otag+"(\\^|\\#)\\s*(.+)\\s*"+this.ctag+"\n*([\\s\\S]+?)"+this.otag+"\\/\\s*\\2\\s*"+this.ctag+"\\s*","mg");return template.replace(regex,function(match,type,name,content){var value=that.find(name,context);if(type=="^"){if(!value||that.is_array(value)&&value.length===0){return that.render(content,context,partials,true)}else{return""}}else{if(type=="#"){if(that.is_array(value)){return that.map(value,function(row){return that.render(content,that.create_context(row),partials,true)}).join("")}else{if(that.is_object(value)){return that.render(content,that.create_context(value),partials,true)}else{if(typeof value==="function"){return value.call(context,content,function(text){return that.render(text,context,partials,true)})}else{if(value){return that.render(content,context,partials,true)}else{return""}}}}}}})},render_tags:function(template,context,partials,in_recursion){var that=this;var new_regex=function(){return new RegExp(that.otag+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+that.ctag+"+","g")};var regex=new_regex();var tag_replace_callback=function(match,operator,name){switch(operator){case"!":return"";case"=":that.set_delimiters(name);regex=new_regex();return"";case">":return that.render_partial(name,context,partials);case"{":return that.find(name,context);default:return that.escape(that.find(name,context))}};var lines=template.split("\n");for(var i=0;i<lines.length;i++){lines[i]=lines[i].replace(regex,tag_replace_callback,this);if(!in_recursion){this.send(lines[i])}}if(in_recursion){return lines.join("\n")}},set_delimiters:function(delimiters){var dels=delimiters.split(" ");this.otag=this.escape_regex(dels[0]);this.ctag=this.escape_regex(dels[1])},escape_regex:function(text){if(!arguments.callee.sRE){var specials=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];arguments.callee.sRE=new RegExp("(\\"+specials.join("|\\")+")","g")}return text.replace(arguments.callee.sRE,"\\$1")},find:function(name,context){name=this.trim(name);function is_kinda_truthy(bool){return bool===false||bool===0||bool}var value;if(is_kinda_truthy(context[name])){value=context[name]}else{if(is_kinda_truthy(this.context[name])){value=this.context[name]}}if(typeof value==="function"){return value.apply(context)}if(value!==undefined){return value}return""},includes:function(needle,haystack){return haystack.indexOf(this.otag+needle)!=-1},escape:function(s){s=String(s===null?"":s);return s.replace(/&(?!\w+;)|["'<>\\]/g,function(s){switch(s){case"&":return"&amp;";case"\\":return"\\\\";case'"':return"&quot;";case"'":return"&#39;";case"<":return"&lt;";case">":return"&gt;";default:return s}})},create_context:function(_context){if(this.is_object(_context)){return _context}else{var iterator=".";if(this.pragmas["IMPLICIT-ITERATOR"]){iterator=this.pragmas["IMPLICIT-ITERATOR"].iterator}var ctx={};ctx[iterator]=_context;return ctx}},is_object:function(a){return a&&typeof a=="object"},is_array:function(a){return Object.prototype.toString.call(a)==="[object Array]"},trim:function(s){return s.replace(/^\s*|\s*$/g,"")},map:function(array,fn){if(typeof array.map=="function"){return array.map(fn)}else{var r=[];var l=array.length;for(var i=0;i<l;i++){r.push(fn(array[i]))}return r}}};return({name:"mustache.js",version:"0.3.1-dev",to_html:function(template,view,partials,send_fun){var renderer=new Renderer();if(send_fun){renderer.send=send_fun}renderer.render(template,view,partials);if(!send_fun){return renderer.buffer.join("\n")}}})}();$.mustache=function(template,view,partials){return Mustache.to_html(template,view,partials)}})(jQuery);(function($){jQuery.fn.observe_field=function(frequency,callback){frequency=frequency*1000;return this.each(function(){var $this=$(this);var prev=$this.val();var check=function(){var val=$this.val();if(prev!=val){prev=val;$this.map(callback)}};var reset=function(){if(ti){clearInterval(ti);ti=setInterval(check,frequency)}};check();var ti=setInterval(check,frequency);$this.bind("keyup click mousemove",reset)})}})(jQuery);(function($){function Placeholder(input){this.input=input;input.data(Placeholder.DATA_ATTRIBUTE,this);if(input.attr("type")=="password"){this.handlePassword()}$(input[0].form).submit(function(){if(input.hasClass("placeholder")){input.val("")}})}Placeholder.DATA_ATTRIBUTE="jquery.placeholder";Placeholder.NATIVE_SUPPORT=!!("placeholder" in document.createElement("input"));Placeholder.prototype={show:function(loading){if(this.input.val()===""||(loading&&this.valueIsPlaceholder())){if(this.isPassword){try{this.input[0].setAttribute("type","text")}catch(e){this.input.before(this.fakePassword.show()).hide()}}this.input.val(this.input.attr("placeholder"));this.input.addClass("placeholder")}},hide:function(){if(this.valueIsPlaceholder()&&this.input.hasClass("placeholder")){this.input.removeClass("placeholder");this.input.val("");if(this.isPassword){try{this.input[0].setAttribute("type","password")}catch(e){}this.input.show();this.input[0].focus()}}},valueIsPlaceholder:function(){return this.input[0].value==this.input.attr("placeholder")},handlePassword:function(){var input=this.input;input.attr("realType","password");this.isPassword=true;if($.browser.msie&&input[0].outerHTML){var fakeHTML=input[0].outerHTML.replace(/type=(['"])?password\1/gi,"type=$1text$1");this.fakePassword=$(fakeHTML).val(input.attr("placeholder")).addClass("placeholder").focus(function(){input.trigger("focus");$(this).hide()})}}};$.fn.placeholder=function(){return Placeholder.NATIVE_SUPPORT?this:this.each(function(){var input=$(this);var placeholder=new Placeholder(input);placeholder.show(true);input.focus(function(){placeholder.hide()});input.blur(function(){placeholder.show(false)});if($.browser.msie){$(window).load(function(){if(input.val()){input.removeClass("placeholder")}placeholder.show(true)});input.focus(function(){if($(this).val()===""){var range=this.createTextRange();range.collapse(true);range.moveStart("character",0);range.select()}})}})};$.fn.resetPlaceholder=function(){return Placeholder.NATIVE_SUPPORT?this:this.each(function(){var placeholder=$(this).data(Placeholder.DATA_ATTRIBUTE);if(placeholder){placeholder.hide();placeholder.show()}})}})(jQuery);jQuery.extend({queryParameters:function(){var result={},queryString=(document.location.search||"").slice(1),keyValuePairs=queryString.split("&"),keyAndValue,key,value;for(var i=0;i<keyValuePairs.length;i++){keyAndValue=keyValuePairs[i].split("=");key=keyAndValue[0];value=decodeURIComponent((keyAndValue[1]||"").replace(/\+/g," "));result[key]=value}return result}});(function($){$.timeago=function(timestamp){if(timestamp instanceof Date){return inWords(timestamp)}else{if(typeof timestamp==="string"){return inWords($.timeago.parse(timestamp))}else{return inWords($.timeago.datetime(timestamp))}}};var $t=$.timeago;$.extend($.timeago,{settings:{refreshMillis:60000,allowFuture:false,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:I18n.t("txt.vendor.jquery.timeago.less_than_a_minute"),minute:I18n.t("txt.vendor.jquery.timeago.about_a_minute"),minutes:I18n.t("txt.vendor.jquery.timeago.minutes"),hour:I18n.t("txt.vendor.jquery.timeago.about_an_hour"),hours:I18n.t("txt.vendor.jquery.timeago.about_hours"),day:I18n.t("txt.vendor.jquery.timeago.a_day"),days:I18n.t("txt.vendor.jquery.timeago.days"),month:I18n.t("txt.vendor.jquery.timeago.about_a_month"),months:I18n.t("txt.vendor.jquery.timeago.months"),year:I18n.t("txt.vendor.jquery.timeago.a_year"),years:I18n.t("txt.vendor.jquery.timeago.years"),numbers:[]}},inWords:function(distanceMillis){var $l=this.settings.strings;var prefix=$l.prefixAgo;var suffix=$l.suffixAgo;if(this.settings.allowFuture){if(distanceMillis<0){prefix=$l.prefixFromNow;suffix=$l.suffixFromNow}}var seconds=Math.abs(distanceMillis)/1000;var minutes=seconds/60;var hours=minutes/60;var days=hours/24;var years=days/365;function substitute(stringOrFunction,number){var string=$.isFunction(stringOrFunction)?stringOrFunction(number,distanceMillis):stringOrFunction;var value=($l.numbers&&$l.numbers[number])||number;return string.replace(/%d/i,value)}var words=seconds<45&&substitute($l.seconds,Math.round(seconds))||seconds<90&&substitute($l.minute,1)||minutes<45&&substitute($l.minutes,Math.round(minutes))||minutes<90&&substitute($l.hour,1)||hours<24&&substitute($l.hours,Math.round(hours))||hours<48&&substitute($l.day,1)||days<30&&substitute($l.days,Math.floor(days))||days<60&&substitute($l.month,1)||days<365&&substitute($l.months,Math.floor(days/30))||years<2&&substitute($l.year,1)||substitute($l.years,Math.floor(years));return $.trim([prefix,words].join(" "))},parse:function(iso8601){var s=$.trim(iso8601);s=s.replace(/\.\d\d\d+/,"");s=s.replace(/-/,"/").replace(/-/,"/");s=s.replace(/T/," ").replace(/Z/," UTC");s=s.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2");return new Date(s)},datetime:function(elem){var isTime=$(elem).get(0).tagName.toLowerCase()==="time";var iso8601=isTime?$(elem).attr("datetime"):$(elem).attr("title");return $t.parse(iso8601)}});$.fn.timeago=function(){var self=this;self.each(refresh);var $s=$t.settings;if($s.refreshMillis>0){setInterval(function(){self.each(refresh)},$s.refreshMillis)}return self};function refresh(){var data=prepareData(this);if(!isNaN(data.datetime)){$(this).text(inWords(data.datetime))}return this}function prepareData(element){element=$(element);if(!element.data("timeago")){element.data("timeago",{datetime:$t.datetime(element)});var text=$.trim(element.text());if(text.length>0){element.attr("title",text)}}return element.data("timeago")}function inWords(date){return $t.inWords(distance(date))}function distance(date){return(new Date().getTime()-date.getTime())}document.createElement("abbr");document.createElement("time")}(jQuery));(function($){$.widget("ui.iosMenu",{options:{backText:"Back",backTextFunction:function(submenu){return null},slideDuration:50,slideEasing:"linear",click:function(iosMenu){iosMenu.toggle();return false},search:false},toggle:function(){if(this.container.is(":visible")){this.hide()}else{this.show()}},hide:function(){this.container.hide();this.element.hide()},hideAll:function(){$(".ios-menu-container").each(function(idx,element){var widget=$(element).data("iosMenu");if(widget){widget.hide()}})},show:function(){this.element.show();this.container.show();this._reposition()},_reposition:function(){var title=this.container.parent().find(".ios-menu-title");this.container.css("top",title.position().top+5).css("left",title.position().left+5);if($("#ios-menu-spacer").length==0){var footer=$("div#footer");var bodyHeight=footer.position().top+footer.height();var heightAtContainerBottom=this.container.position().top+this.container.height();if(heightAtContainerBottom>bodyHeight){footer.after($("<div>&nbsp;</div>").attr("id","ios-menu-spacer").css("padding-top",2*(heightAtContainerBottom-bodyHeight)))}}},_insertSearchField:function(){this.searchField=$('<input class="ios-menu-search-field" type="text"/>');$('<span class="ios-menu-search"></span>').append(this.searchField).insertBefore(this.element);return this},_insertSearchResults:function(){this.searchResults=$('<ul class="ios-menu-search-results menu" style="display:none;"></ul>').insertAfter(this.element);this.searchResults.menu();return this},_insertBackButtons:function(){var iosMenu=this;$(this.element.find("li ul, li ol")).each(function(idx,submenu){var backButton=$('<li><span class="ui-icon ui-icon-carat-1-w ios-menu-back-image"></span><a href="#menu-back" class="ios-menu-back-link">'+(iosMenu.options.backTextFunction(submenu)||iosMenu.options.backText)+"</a></li>");$(submenu).prepend(backButton)});return this},_createContainer:function(){var iosMenu=this;var container=this.container=$('<div class="ios-menu-container" />').append($("<div>").addClass("ios-menu-title activated").html(this.options.title).append($("<a>").addClass("button").click(function(){iosMenu.toggle()}).css("float","right").css("padding","0 5px").css("margin","0 5px").html("cancel")));container.insertBefore(this.element).append(this.element.detach()).data("ios-menu",this).hide();if(this.options.title){$('<div class="ios-menu-title"/>').append($("<a>").html(this.options.title).click(function(event){iosMenu.hideAll();iosMenu.toggle()})).insertBefore(container);container.css("top","-15px")}return this},_createLinks:function(){var iosMenu=this;iosMenu.element.find("li").each(function(idx,listItem){listItem=$(listItem);var nestedList=$(listItem).find("> ul").detach();var linkText=listItem.text();listItem.empty().append($("<a/>").append(linkText).click(function(){if(nestedList.length>0){return true}else{return iosMenu.options.click(iosMenu,listItem)}})).append(nestedList)});return this},_create:function(){var iosMenu=this;iosMenu._createContainer()._createLinks();if(this.options.search){iosMenu._insertSearchField()._insertSearchResults()}if(this.options.renderSearchResult){this.renderSearchResult=this.options.renderSearchResult}else{this.renderSearchResult=function(hit){return"<li><a>"+hit+"</a></li>"}}iosMenu._insertBackButtons().element.addClass("ios-style").menu({position:{my:"left top",at:"right top",of:iosMenu.element}});$j(window).resize(function(){iosMenu._reposition()});var menu=iosMenu.element.data("menu");menu.select=function(event){event.preventDefault();var validTarget=$(event.target).is("a");if(validTarget&&menu.active&&menu.active.find("> .ios-menu-back-link").length){menu.focus(event,menu.active);if(menu.left(event)){event.stopImmediatePropagation()}}else{if(validTarget&&menu.active&&menu.active.find("> ul").length){menu.focus(event,menu.active);if(menu.right(event)){event.stopImmediatePropagation()}menu.active.closest("ul").css("overflow-y","hidden")}else{menu._trigger("select",event,{item:menu.active})}}};var right=menu.right;menu.right=function(event){if(right.call(menu,event)){event.stopImmediatePropagation()}menu.active.closest("ul").css("overflow-y","hidden");menu.active.find("ul").height(menu.active.parent().height())};menu.left=function(event){var newItem=this.active&&this.active.parents("li:not(.ui-menubar-item) ").first(),self=this,parent;if(newItem&&newItem.length){newItem.find("> a").addClass("ui-state-focus").removeClass("ui-state-active");parent=this.active.parent();parent.attr("aria-hidden","true").attr("aria-expanded","false").animate({left:self.element.css("width")},iosMenu.options.slideDuration,iosMenu.options.slideEasing,function(){parent.hide();self.focus(event,newItem)});newItem.closest("ul").css("overflow-y","auto");return true}else{if(event&&event.which===$.ui.keyCode.ESCAPE){self._trigger("close",event)}}};var menuOpenWithoutSliding=menu._open;menu._open=function(submenu){menuOpenWithoutSliding.call(this,submenu);submenu.animate({left:0},iosMenu.options.slideDuration,iosMenu.options.slideEasing)};menu._startOpening=function(){clearTimeout(this.timer)};menu._move=function(direction,edge,filter,event){if(!this.active){this.focus(event,this.activeMenu.children(edge)[filter]());return}var next=this.active[direction+"All"](".ui-menu-item").eq(0);if(next.length){this.focus(event,next)}else{var currentActive=this.active;this.focus(event,this.activeMenu.children(edge)[filter]());this._trigger("wrap",event,{direction:direction,from:currentActive,menu:this})}};menu.focusFirst=function(){this.focus({},this.activeMenu.find(">li:first"))};if(this.options.search){var resultsMenu=this.searchResults.data("menu");resultsMenu._move=menu._move;resultsMenu.focusFirst=menu.focusFirst;this.searchField.keyup(function(event){switch(event.keyCode){case $.ui.keyCode.DOWN:iosMenu.visibleMenu.focus();iosMenu.visibleMenu.data("menu").focusFirst();return false;case $.ui.keyCode.ESCAPE:iosMenu.searchField.val("");iosMenu.showMenu();return false}}).fastAutocomplete({lookup:this.doSearch,render:this.showSearchResults,context:this,frequency:0.1});this.visibleMenu=this.element;this.element.add(this.searchResults).bind("menuwrap",function(event,data){if(data.direction==="prev"){data.menu.focus({},data.from);data.menu.blur();iosMenu.searchField.focus()}})}},doSearch:function(query,callback){if(this.options.search){callback(this.options.search(query))}},showSearchResults:function(hits){var iosMenu=this;if(hits.length===0){return this.showMenu()}var len=hits.length;var content=[];for(var idx=0;idx<len;idx++){content.push(this.renderSearchResult(hits[idx]))}this.searchResults.empty().html(content.join("")).data("menu").refresh();this.searchResults.find("li a").each(function(element){element.click(this.options.click(iosMenu,element.parent))});this.element.hide();this.searchResults.show();this.visibleMenu=this.searchResults;return this},showMenu:function(){this.searchResults.hide();this.element.show();this.visibleMenu=this.element},destroy:function(){var menu=this.element&&this.element.data("menu");if(menu){menu.destroy()}menu=this.searchResults&&this.searchResults.data("menu");if(menu){menu.destroy()}}})}(jQuery));
/*!
 * jQuery hashchange event - v1.3 - 7/21/2010
 * http://benalman.com/projects/jquery-hashchange-plugin/
 *
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($,window,undefined){var str_hashchange="hashchange",doc=document,fake_onhashchange,special=$.event.special,doc_mode=doc.documentMode,supports_onhashchange="on"+str_hashchange in window&&(doc_mode===undefined||doc_mode>7);function get_fragment(url){url=url||location.href;return"#"+url.replace(/^[^#]*#?(.*)$/,"$1")}$.fn[str_hashchange]=function(fn){return fn?this.bind(str_hashchange,fn):this.trigger(str_hashchange)};$.fn[str_hashchange].delay=50;special[str_hashchange]=$.extend(special[str_hashchange],{setup:function(){if(supports_onhashchange){return false}$(fake_onhashchange.start)},teardown:function(){if(supports_onhashchange){return false}$(fake_onhashchange.stop)}});fake_onhashchange=(function(){var self={},timeout_id,last_hash=get_fragment(),fn_retval=function(val){return val},history_set=fn_retval,history_get=fn_retval;self.start=function(){timeout_id||poll()};self.stop=function(){timeout_id&&clearTimeout(timeout_id);timeout_id=undefined};function poll(){var hash=get_fragment(),history_hash=history_get(last_hash);if(hash!==last_hash){history_set(last_hash=hash,history_hash);$(window).trigger(str_hashchange)}else{if(history_hash!==last_hash){location.href=location.href.replace(/#.*/,"")+history_hash}}timeout_id=setTimeout(poll,$.fn[str_hashchange].delay)}$.browser.msie&&!supports_onhashchange&&(function(){var iframe,iframe_src;self.start=function(){if(!iframe){iframe_src=$.fn[str_hashchange].src;iframe_src=iframe_src&&iframe_src+get_fragment();iframe=$('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){iframe_src||history_set(get_fragment());poll()}).attr("src",iframe_src||"javascript:0").insertAfter("body")[0].contentWindow;doc.onpropertychange=function(){try{if(event.propertyName==="title"){iframe.document.title=doc.title}}catch(e){}}}};self.stop=fn_retval;history_get=function(){return get_fragment(iframe.location.href)};history_set=function(hash,history_hash){var iframe_doc=iframe.document,domain=$.fn[str_hashchange].domain;if(hash!==history_hash){iframe_doc.title=doc.title;iframe_doc.open();domain&&iframe_doc.write('<script>document.domain="'+domain+'"<\/script>');iframe_doc.close();iframe.location.hash=hash}}})();return self})()})(jQuery,this);jQuery.fn.highlight=function(pat){function innerHighlight(node,pat){var skip=0;if(node.nodeType==3){var pos=node.data.toUpperCase().indexOf(pat);if(pos>=0){var spannode=document.createElement("span"),middlebit=node.splitText(pos),endbit=middlebit.splitText(pat.length),middleclone=middlebit.cloneNode(true);spannode.className="highlight";spannode.appendChild(middleclone);middlebit.parentNode.replaceChild(spannode,middlebit);skip=1}}else{if(node.nodeType==1&&node.childNodes&&!/(script|style)/i.test(node.tagName)){for(var i=0;i<node.childNodes.length;++i){i+=innerHighlight(node.childNodes[i],pat)}}}return skip}return(!pat||pat==="")?this:this.each(function(){innerHighlight(this,pat.toUpperCase())})};jQuery.fn.removeHighlight=function(){return this.find("span.highlight").each(function(){var parent=this.parentNode;parent.replaceChild(this.firstChild,this);parent.normalize()}).end()};(function($){var increments=0;$.widget("ui.tooltip",{options:{tooltipClass:null,items:"[title]",content:function(){return $(this).attr("title")},position:{my:"right top",at:"right center"}},_create:function(){var open=$.proxy(this.open,this);this.element.bind("mouseover",open).bind("focusin",open)},enable:function(){this.options.disabled=false},disable:function(){this.options.disabled=true},open:function(event){var target=$(event&&event.target||this.element).closest(this.options.items);if(!target.length){return}var self=this;if(!target.data("tooltip-title")){target.data("tooltip-title",target.attr("title"))}var content=this.options.content.call(target[0],function(response){setTimeout(function(){if(target.attr("aria-describedby")!==undefined){self._open(event,target,response)}},13)});if(content){self._open(event,target,content)}},_open:function(event,target,content){if(!content){return}target.attr("title","");if(this.options.disabled){return}if(this._isOpen){return}var tooltip=this._find(target);if(!tooltip.length){tooltip=this._tooltip();target.attr("aria-describedby",tooltip.attr("id"))}tooltip.find(".ui-tooltip-content").html(content);tooltip.position($.extend({of:target},this.options.position)).hide();tooltip.stop(true);tooltip.show();this._trigger("open",event);this._isOpen=true;var close=$.proxy(this.close,this);target.bind("mouseleave",close).bind("blur",close).bind("click",close)},close:function(event){var target=$(event&&event.currentTarget||this.element);target.attr("title",target.data("tooltip-title"));if(this.options.disabled){return}var tooltip=this._find(target);target.removeAttr("aria-describedby");tooltip.stop(true);tooltip.hide().remove();target.unbind("mouseleave.tooltip blur.tooltip");this._trigger("close",event);this._isOpen=false},_tooltip:function(){var tooltip=$("<div></div>").attr("id","ui-tooltip-"+increments++).attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content");if(this.options.tooltipClass){tooltip.addClass(this.options.tooltipClass)}$("<div></div>").addClass("ui-tooltip-content").appendTo(tooltip);tooltip.appendTo(document.body);return tooltip},_find:function(target){var id=target.attr("aria-describedby");return id?$(document.getElementById(id)):$()}});$.ui.tooltip.version="@VERSION"})(jQuery);if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());(function($){Sammy.ActiveTemplate=function(app){var renderTemplate=function(templateElement,data,targetSel){var targetSelector=targetSel||templateElement.attr("data-target");var renderContext=this.render(templateElement,data).replace(targetSelector);renderContext.then(function(){bindDOMEvents(this.$element().find(targetSelector),this)}.bind(this));return renderContext};var bindDOMEvents=function(container,context){var boundChildren=container.find("*[data-bind]");boundChildren.each(function(i,elem){var eventDescriptor=$(elem).attr("data-bind");var domEvent=eventDescriptor.split(" ")[0];var appEvent=eventDescriptor.split(" ")[1];$(elem).bind(domEvent,function(e){context.trigger(appEvent,{element:$(elem),domEvent:e})})})};var renderCollectionTemplate=function(templateElement,data,targetSel){var targetSelector=targetSel||templateElement.attr("data-target");var renderContext=this.renderEach(templateElement,data).replace(targetSelector);renderContext.then(function(){bindDOMEvents(this.$element().find(targetSelector),this)}.bind(this));return renderContext};app.helper("renderTemplate",renderTemplate);app.helper("renderCollectionTemplate",renderCollectionTemplate);app.helper("bindDOMEvents",bindDOMEvents)}})(jQuery);(function($){Sammy=Sammy||{};Sammy.FlashHash=function(){this.now={}};Sammy.FlashHash.prototype={toHTML:function(){result=this._renderUL();this.clear();return result},clear:function(){this._clearHash(this);this._clearHash(this.now)},_onRedirect:function(){this._clearHash(this.now)},_clearHash:function(hash){var key;for(key in hash){if(key!=="now"&&hash.hasOwnProperty(key)){hash[key]=undefined}}},_renderUL:function(){return'<ul class="flash">'+this._renderLIs(this)+this._renderLIs(this.now)+"</ul>"},_renderLIs:function(hash){var result="",key;for(key in hash){if(hash[key]&&key!=="now"&&hash.hasOwnProperty(key)){result=result+'<li class="'+key+'">'+hash[key]+"</li>"}}return result}};Sammy.Flash=function(app){app.flash=new Sammy.FlashHash();app.helper("flash",function(key,value){if(arguments.length===0){return this.app.flash}else{if(arguments.length===2){this.app.flash[key]=value}}return this.app.flash[key]});app.helper("flashNow",function(key,value){if(arguments.length===0){return this.app.flash.now}else{if(arguments.length===2){this.app.flash.now[key]=value}}return this.app.flash.now[key]});app.bind("redirect",function(){this.app.flash._onRedirect()})}})(jQuery);(function($){Sammy.Mustache=function(app,method_alias){var mustache=function(template,data,partials){data=$.extend({},this,data);partials=$.extend({},data.partials,partials);return $.mustache(template,data,partials)};if(!method_alias){method_alias="mustache"}app.helper(method_alias,mustache)}})(jQuery);(function($){Sammy=Sammy||{};Sammy.PathLocationProxy=function(app){this.app=app};Sammy.PathLocationProxy.prototype={bind:function(){},unbind:function(){},getLocation:function(){return[window.location.pathname,window.location.search].join("")},setLocation:function(new_location){return window.location=new_location}}})(jQuery);(function(){var root=this;var previousUnderscore=root._;var breaker={};var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var slice=ArrayProto.slice,unshift=ArrayProto.unshift,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind;var _=function(obj){return new wrapper(obj)};if(typeof module!=="undefined"&&module.exports){module.exports=_;_._=_}else{root._=_}_.VERSION="1.1.5";var each=_.each=_.forEach=function(obj,iterator,context){if(obj==null){return}if(nativeForEach&&obj.forEach===nativeForEach){obj.forEach(iterator,context)}else{if(_.isNumber(obj.length)){for(var i=0,l=obj.length;i<l;i++){if(iterator.call(context,obj[i],i,obj)===breaker){return}}}else{for(var key in obj){if(hasOwnProperty.call(obj,key)){if(iterator.call(context,obj[key],key,obj)===breaker){return}}}}}};_.map=function(obj,iterator,context){var results=[];if(obj==null){return results}if(nativeMap&&obj.map===nativeMap){return obj.map(iterator,context)}each(obj,function(value,index,list){results[results.length]=iterator.call(context,value,index,list)});return results};_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=memo!==void 0;if(obj==null){obj=[]}if(nativeReduce&&obj.reduce===nativeReduce){if(context){iterator=_.bind(iterator,context)}return initial?obj.reduce(iterator,memo):obj.reduce(iterator)}each(obj,function(value,index,list){if(!initial&&index===0){memo=value;initial=true}else{memo=iterator.call(context,memo,value,index,list)}});if(!initial){throw new TypeError("Reduce of empty array with no initial value")}return memo};_.reduceRight=_.foldr=function(obj,iterator,memo,context){if(obj==null){obj=[]}if(nativeReduceRight&&obj.reduceRight===nativeReduceRight){if(context){iterator=_.bind(iterator,context)}return memo!==void 0?obj.reduceRight(iterator,memo):obj.reduceRight(iterator)}var reversed=(_.isArray(obj)?obj.slice():_.toArray(obj)).reverse();return _.reduce(reversed,iterator,memo,context)};_.find=_.detect=function(obj,iterator,context){var result;any(obj,function(value,index,list){if(iterator.call(context,value,index,list)){result=value;return true}});return result};_.filter=_.select=function(obj,iterator,context){var results=[];if(obj==null){return results}if(nativeFilter&&obj.filter===nativeFilter){return obj.filter(iterator,context)}each(obj,function(value,index,list){if(iterator.call(context,value,index,list)){results[results.length]=value}});return results};_.reject=function(obj,iterator,context){var results=[];if(obj==null){return results}each(obj,function(value,index,list){if(!iterator.call(context,value,index,list)){results[results.length]=value}});return results};_.every=_.all=function(obj,iterator,context){iterator=iterator||_.identity;var result=true;if(obj==null){return result}if(nativeEvery&&obj.every===nativeEvery){return obj.every(iterator,context)}each(obj,function(value,index,list){if(!(result=result&&iterator.call(context,value,index,list))){return breaker}});return result};var any=_.some=_.any=function(obj,iterator,context){iterator=iterator||_.identity;var result=false;if(obj==null){return result}if(nativeSome&&obj.some===nativeSome){return obj.some(iterator,context)}each(obj,function(value,index,list){if(result=iterator.call(context,value,index,list)){return breaker}});return result};_.include=_.contains=function(obj,target){var found=false;if(obj==null){return found}if(nativeIndexOf&&obj.indexOf===nativeIndexOf){return obj.indexOf(target)!=-1}any(obj,function(value){if(found=value===target){return true}});return found};_.invoke=function(obj,method){var args=slice.call(arguments,2);return _.map(obj,function(value){return(method?value[method]:value).apply(value,args)})};_.pluck=function(obj,key){return _.map(obj,function(value){return value[key]})};_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)){return Math.max.apply(Math,obj)}var result={computed:-Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>=result.computed&&(result={value:value,computed:computed})});return result.value};_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)){return Math.min.apply(Math,obj)}var result={computed:Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed})});return result.value};_.sortBy=function(obj,iterator,context){return _.pluck(_.map(obj,function(value,index,list){return{value:value,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;return a<b?-1:a>b?1:0}),"value")};_.sortedIndex=function(array,obj,iterator){iterator=iterator||_.identity;var low=0,high=array.length;while(low<high){var mid=(low+high)>>1;iterator(array[mid])<iterator(obj)?low=mid+1:high=mid}return low};_.toArray=function(iterable){if(!iterable){return[]}if(iterable.toArray){return iterable.toArray()}if(_.isArray(iterable)){return iterable}if(_.isArguments(iterable)){return slice.call(iterable)}return _.values(iterable)};_.size=function(obj){return _.toArray(obj).length};_.first=_.head=function(array,n,guard){return(n!=null)&&!guard?slice.call(array,0,n):array[0]};_.rest=_.tail=function(array,index,guard){return slice.call(array,(index==null)||guard?1:index)};_.last=function(array){return array[array.length-1]};_.compact=function(array){return _.filter(array,function(value){return !!value})};_.flatten=function(array){return _.reduce(array,function(memo,value){if(_.isArray(value)){return memo.concat(_.flatten(value))}memo[memo.length]=value;return memo},[])};_.without=function(array){var values=slice.call(arguments,1);return _.filter(array,function(value){return !_.include(values,value)})};_.uniq=_.unique=function(array,isSorted){return _.reduce(array,function(memo,el,i){if(0==i||(isSorted===true?_.last(memo)!=el:!_.include(memo,el))){memo[memo.length]=el}return memo},[])};_.intersect=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0})})};_.zip=function(){var args=slice.call(arguments);var length=_.max(_.pluck(args,"length"));var results=new Array(length);for(var i=0;i<length;i++){results[i]=_.pluck(args,""+i)}return results};_.indexOf=function(array,item,isSorted){if(array==null){return -1}var i,l;if(isSorted){i=_.sortedIndex(array,item);return array[i]===item?i:-1}if(nativeIndexOf&&array.indexOf===nativeIndexOf){return array.indexOf(item)}for(i=0,l=array.length;i<l;i++){if(array[i]===item){return i}}return -1};_.lastIndexOf=function(array,item){if(array==null){return -1}if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf){return array.lastIndexOf(item)}var i=array.length;while(i--){if(array[i]===item){return i}}return -1};_.range=function(start,stop,step){if(arguments.length<=1){stop=start||0;start=0}step=arguments[2]||1;var len=Math.max(Math.ceil((stop-start)/step),0);var idx=0;var range=new Array(len);while(idx<len){range[idx++]=start;start+=step}return range};_.bind=function(func,obj){if(nativeBind&&func.bind===nativeBind){return func.bind.apply(func,slice.call(arguments,1))}var args=slice.call(arguments,2);return function(){return func.apply(obj,args.concat(slice.call(arguments)))}};_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(funcs.length==0){funcs=_.functions(obj)}each(funcs,function(f){obj[f]=_.bind(obj[f],obj)});return obj};_.memoize=function(func,hasher){var memo={};hasher=hasher||_.identity;return function(){var key=hasher.apply(this,arguments);return hasOwnProperty.call(memo,key)?memo[key]:(memo[key]=func.apply(this,arguments))}};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(func,args)},wait)};_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))};var limit=function(func,wait,debounce){var timeout;return function(){var context=this,args=arguments;var throttler=function(){timeout=null;func.apply(context,args)};if(debounce){clearTimeout(timeout)}if(debounce||!timeout){timeout=setTimeout(throttler,wait)}}};_.throttle=function(func,wait){return limit(func,wait,false)};_.debounce=function(func,wait){return limit(func,wait,true)};_.once=function(func){var ran=false,memo;return function(){if(ran){return memo}ran=true;return memo=func.apply(this,arguments)}};_.wrap=function(func,wrapper){return function(){var args=[func].concat(slice.call(arguments));return wrapper.apply(this,args)}};_.compose=function(){var funcs=slice.call(arguments);return function(){var args=slice.call(arguments);for(var i=funcs.length-1;i>=0;i--){args=[funcs[i].apply(this,args)]}return args[0]}};_.keys=nativeKeys||function(obj){if(obj!==Object(obj)){throw new TypeError("Invalid object")}var keys=[];for(var key in obj){if(hasOwnProperty.call(obj,key)){keys[keys.length]=key}}return keys};_.values=function(obj){return _.map(obj,_.identity)};_.functions=_.methods=function(obj){return _.filter(_.keys(obj),function(key){return _.isFunction(obj[key])}).sort()};_.extend=function(obj){each(slice.call(arguments,1),function(source){for(var prop in source){obj[prop]=source[prop]}});return obj};_.defaults=function(obj){each(slice.call(arguments,1),function(source){for(var prop in source){if(obj[prop]==null){obj[prop]=source[prop]}}});return obj};_.clone=function(obj){return _.isArray(obj)?obj.slice():_.extend({},obj)};_.tap=function(obj,interceptor){interceptor(obj);return obj};_.isEqual=function(a,b){if(a===b){return true}var atype=typeof(a),btype=typeof(b);if(atype!=btype){return false}if(a==b){return true}if((!a&&b)||(a&&!b)){return false}if(a._chain){a=a._wrapped}if(b._chain){b=b._wrapped}if(a.isEqual){return a.isEqual(b)}if(_.isDate(a)&&_.isDate(b)){return a.getTime()===b.getTime()}if(_.isNaN(a)&&_.isNaN(b)){return false}if(_.isRegExp(a)&&_.isRegExp(b)){return a.source===b.source&&a.global===b.global&&a.ignoreCase===b.ignoreCase&&a.multiline===b.multiline}if(atype!=="object"){return false}if(a.length&&(a.length!==b.length)){return false}var aKeys=_.keys(a),bKeys=_.keys(b);if(aKeys.length!=bKeys.length){return false}for(var key in a){if(!(key in b)||!_.isEqual(a[key],b[key])){return false}}return true};_.isEmpty=function(obj){if(_.isArray(obj)||_.isString(obj)){return obj.length===0}for(var key in obj){if(hasOwnProperty.call(obj,key)){return false}}return true};_.isElement=function(obj){return !!(obj&&obj.nodeType==1)};_.isArray=nativeIsArray||function(obj){return toString.call(obj)==="[object Array]"};_.isArguments=function(obj){return !!(obj&&hasOwnProperty.call(obj,"callee"))};_.isFunction=function(obj){return !!(obj&&obj.constructor&&obj.call&&obj.apply)};_.isString=function(obj){return !!(obj===""||(obj&&obj.charCodeAt&&obj.substr))};_.isNumber=function(obj){return !!(obj===0||(obj&&obj.toExponential&&obj.toFixed))};_.isNaN=function(obj){return obj!==obj};_.isBoolean=function(obj){return obj===true||obj===false};_.isDate=function(obj){return !!(obj&&obj.getTimezoneOffset&&obj.setUTCFullYear)};_.isRegExp=function(obj){return !!(obj&&obj.test&&obj.exec&&(obj.ignoreCase||obj.ignoreCase===false))};_.isNull=function(obj){return obj===null};_.isUndefined=function(obj){return obj===void 0};_.noConflict=function(){root._=previousUnderscore;return this};_.identity=function(value){return value};_.times=function(n,iterator,context){for(var i=0;i<n;i++){iterator.call(context,i)}};_.mixin=function(obj){each(_.functions(obj),function(name){addToWrapper(name,_[name]=obj[name])})};var idCounter=0;_.uniqueId=function(prefix){var id=idCounter++;return prefix?prefix+id:id};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};_.template=function(str,data){var c=_.templateSettings;var tmpl="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+str.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.interpolate,function(match,code){return"',"+code.replace(/\\'/g,"'")+",'"}).replace(c.evaluate||null,function(match,code){return"');"+code.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";var func=new Function("obj",tmpl);return data?func(data):func};var wrapper=function(obj){this._wrapped=obj};_.prototype=wrapper.prototype;var result=function(obj,chain){return chain?_(obj).chain():obj};var addToWrapper=function(name,func){wrapper.prototype[name]=function(){var args=slice.call(arguments);unshift.call(args,this._wrapped);return result(func.apply(_,args),this._chain)}};_.mixin(_);each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];wrapper.prototype[name]=function(){method.apply(this._wrapped,arguments);return result(this._wrapped,this._chain)}});each(["concat","join","slice"],function(name){var method=ArrayProto[name];wrapper.prototype[name]=function(){return result(method.apply(this._wrapped,arguments),this._chain)}});wrapper.prototype.chain=function(){this._chain=true;return this};wrapper.prototype.value=function(){return this._wrapped}})();var Base64=(function(){var keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var obj={encode:function(input){var output="";var chr1,chr2,chr3;var enc1,enc2,enc3,enc4;var i=0;do{chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=((chr1&3)<<4)|(chr2>>4);enc3=((chr2&15)<<2)|(chr3>>6);enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64}else{if(isNaN(chr3)){enc4=64}}output=output+keyStr.charAt(enc1)+keyStr.charAt(enc2)+keyStr.charAt(enc3)+keyStr.charAt(enc4)}while(i<input.length);return output},decode:function(input){var output="";var chr1,chr2,chr3;var enc1,enc2,enc3,enc4;var i=0;input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{enc1=keyStr.indexOf(input.charAt(i++));enc2=keyStr.indexOf(input.charAt(i++));enc3=keyStr.indexOf(input.charAt(i++));enc4=keyStr.indexOf(input.charAt(i++));chr1=(enc1<<2)|(enc2>>4);chr2=((enc2&15)<<4)|(enc3>>2);chr3=((enc3&3)<<6)|enc4;output=output+String.fromCharCode(chr1);if(enc3!=64){output=output+String.fromCharCode(chr2)}if(enc4!=64){output=output+String.fromCharCode(chr3)}}while(i<input.length);return output}};return obj})();(function(){var BufferClass=typeof(Buffer)=="function"?Buffer:Array;var _buf=new BufferClass(16);var toString=[];var toNumber={};for(var i=0;i<256;i++){toString[i]=(i+256).toString(16).substr(1);toNumber[toString[i]]=i}function parse(s){var buf=new BufferClass(16);var i=0;s.toLowerCase().replace(/[0-9a-f][0-9a-f]/g,function(octet){buf[i++]=toNumber[octet]});return buf}function unparse(buf){var tos=toString,b=buf;return tos[b[0]]+tos[b[1]]+tos[b[2]]+tos[b[3]]+"-"+tos[b[4]]+tos[b[5]]+"-"+tos[b[6]]+tos[b[7]]+"-"+tos[b[8]]+tos[b[9]]+"-"+tos[b[10]]+tos[b[11]]+tos[b[12]]+tos[b[13]]+tos[b[14]]+tos[b[15]]}var ff=255;var useCrypto=this.crypto&&crypto.getRandomValues;var rnds=useCrypto?new Uint32Array(4):new Array(4);function uuid(fmt,buf,offset){var b=fmt!="binary"?_buf:(buf?buf:new BufferClass(16));var i=buf&&offset||0;if(useCrypto){crypto.getRandomValues(rnds)}else{rnds[0]=Math.random()*4294967296;rnds[1]=Math.random()*4294967296;rnds[2]=Math.random()*4294967296;rnds[3]=Math.random()*4294967296}var r=rnds[0];b[i++]=r&ff;b[i++]=r>>>8&ff;b[i++]=r>>>16&ff;b[i++]=r>>>24&ff;r=rnds[1];b[i++]=r&ff;b[i++]=r>>>8&ff;b[i++]=r>>>16&15|64;b[i++]=r>>>24&ff;r=rnds[2];b[i++]=r&63|128;b[i++]=r>>>8&ff;b[i++]=r>>>16&ff;b[i++]=r>>>24&ff;r=rnds[3];b[i++]=r&ff;b[i++]=r>>>8&ff;b[i++]=r>>>16&ff;b[i++]=r>>>24&ff;return fmt===undefined?unparse(b):b}uuid.parse=parse;uuid.unparse=unparse;uuid.BufferClass=BufferClass;if(typeof(module)!="undefined"){module.exports=uuid}else{this.uuid=uuid}}());(function($,undefined){var rails;$.rails=rails={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",linkDisableSelector:"a[data-disable-with]",fire:function(obj,name,data){var event=$.Event(name);obj.trigger(event,data);return event.result!==false},confirm:function(message){return confirm(message)},ajax:function(options){return $.ajax(options)},handleRemote:function(element){var method,url,data,crossDomain=element.data("cross-domain")||null,dataType=element.data("type")||($.ajaxSettings&&$.ajaxSettings.dataType),options;if(rails.fire(element,"ajax:before")){if(element.is("form")){method=element.attr("method");url=element.attr("action");data=element.serializeArray();var button=element.data("ujs:submit-button");if(button){data.push(button);element.data("ujs:submit-button",null)}}else{if(element.is(rails.inputChangeSelector)){method=element.data("method");url=element.data("url");data=element.serialize();if(element.data("params")){data=data+"&"+element.data("params")}}else{method=element.data("method");url=element.attr("href");data=element.data("params")||null}}options={type:method||"GET",data:data,dataType:dataType,crossDomain:crossDomain,beforeSend:function(xhr,settings){if(settings.dataType===undefined){xhr.setRequestHeader("accept","*/*;q=0.5, "+settings.accepts.script)}return rails.fire(element,"ajax:beforeSend",[xhr,settings])},success:function(data,status,xhr){element.trigger("ajax:success",[data,status,xhr])},complete:function(xhr,status){element.trigger("ajax:complete",[xhr,status])},error:function(xhr,status,error){element.trigger("ajax:error",[xhr,status,error])}};if(url){options.url=url}return rails.ajax(options)}else{return false}},handleMethod:function(link){var href=link.attr("href"),method=link.data("method"),target=link.attr("target"),csrf_token=$("meta[name=csrf-token]").attr("content"),csrf_param=$("meta[name=csrf-param]").attr("content"),form=$('<form method="post" action="'+href+'"></form>'),metadata_input='<input name="_method" value="'+method+'" type="hidden" />';if(csrf_param!==undefined&&csrf_token!==undefined){metadata_input+='<input name="'+csrf_param+'" value="'+csrf_token+'" type="hidden" />'}if(target){form.attr("target",target)}form.hide().append(metadata_input).appendTo("body");form.submit()},allowAction:function(element){var message=element.data("confirm"),answer=false,callback;if(!message){return true}if(rails.fire(element,"confirm")){answer=rails.confirm(message);callback=rails.fire(element,"confirm:complete",[answer])}return answer&&callback},stopEverything:function(e){$(e.target).trigger("ujs:everythingStopped");e.stopImmediatePropagation();return false},disableElement:function(element){element.data("ujs:enable-with",element.html());element.html(element.data("disable-with"));element.bind("click.railsDisable",function(e){return rails.stopEverything(e)})},enableElement:function(element){if(element.data("ujs:enable-with")!==undefined){element.html(element.data("ujs:enable-with"));element.data("ujs:enable-with",false)}element.unbind("click.railsDisable")}};$(document).delegate(rails.linkDisableSelector,"ajax:complete",function(){rails.enableElement($(this))});$(document).delegate(rails.linkClickSelector,"click.rails",function(e){var link=$(this),method=link.data("method"),data=link.data("params");if(!rails.allowAction(link)){return rails.stopEverything(e)}if(link.is(rails.linkDisableSelector)){rails.disableElement(link)}if(link.data("remote")!==undefined){if((e.metaKey||e.ctrlKey)&&(!method||method==="GET")&&!data){return true}if(rails.handleRemote(link)===false){rails.enableElement(link)}return false}else{if(link.data("method")){rails.handleMethod(link);return false}}})})(jQuery);(function(){function require(p,context,parent){context||(context=0);var path=require.resolve(p,context),mod=require.modules[context][path];if(!mod){throw new Error('failed to require "'+p+'" from '+parent)}if(mod.context){context=mod.context;path=mod.main;mod=require.modules[context][mod.main]}if(!mod.exports){mod.exports={};mod.call(mod.exports,mod,mod.exports,require.relative(path,context))}return mod.exports}require.modules=[{}];require.resolve=function(path,context){var orig=path,reg=path+".js",index=path+"/index.js";return require.modules[context][reg]&&reg||require.modules[context][index]&&index||orig};require.relative=function(relativeTo,context){return function(p){if("."!=p.charAt(0)){return require(p)}var path=relativeTo.split("/"),segs=p.split("/");path.pop();for(var i=0;i<segs.length;i++){var seg=segs[i];if(".."==seg){path.pop()}else{if("."!=seg){path.push(seg)}}}return require(path.join("/"),context,relativeTo)}};require.modules[0]["jquery"]={exports:window.jQuery};require.modules[0]["window"]={exports:window};require.modules[0]["backend.js"]=function(module,exports,require){var SoundManager=require("./vendor/soundmanager2");var window=require("window");var jQuery=require("jquery");module.exports=(function(){var initialized=false;var initializing=false;var deferred=jQuery.Deferred();var resolve=function(){deferred.resolve();deferred=jQuery.Deferred()};function Backend(options){this.options=options||{};this.swfUrl=this.options.swfUrl;this.callbacks=[]}Backend.prototype.ready=function(callback){deferred.done(callback);return this};Backend.prototype.init=function(){if(initialized){resolve();return}if(initializing){return}initializing=true;var soundManager=new SoundManager(this.swfUrl);window.soundManager=soundManager;soundManager.flashVersion=9;soundManager.beginDelayedInit();soundManager.ontimeout(function(){soundManager.reboot()});soundManager.onready(function(){initialized=true;initializing=false;resolve()});return this};return Backend}())};require.modules[0]["player.js"]=function(module,exports,require){var jQuery=require("jquery");var Backend=require("./backend");function formatTimeRemaining(ms){var seconds=Math.ceil(ms/1000);var minutes=Math.floor(seconds/60);seconds=seconds%60;if(seconds<10){seconds="0"+seconds}if(minutes<10){minutes="0"+minutes}return minutes+":"+seconds}var volumeControls=[[3,0],[7,20],[12,40],[17,60],[22,80],[27,100]];function calculateNewVolume(event){var xOffset=event.pageX;for(var cur=event.target;cur;cur=cur.offsetParent){xOffset-=cur.offsetLeft}for(var i=0;i<volumeControls.length;i++){var control=volumeControls[i];if(xOffset<=control[0]){return control[1]}}}if(jQuery("#zd-player-css").length==0){var style=document.createElement("style");style.type="text/css";style.id="zd-player-css";if(style.styleSheet){style.styleSheet.cssText=require("templates/css")}else{style.appendChild(document.createTextNode(require("templates/css")))}document.getElementsByTagName("head")[0].appendChild(style)}module.exports=(function(){function Player(options){this.options=options||{};this.domId=this.options.domId;this.url=this.options.url;this.element=jQuery("#"+this.domId);var backend=new Backend(this.options);this.element.html(require("templates/html"));this.element.addClass("zd-player");this.seekbarElement=this.element.find(".seekbar");this.playElement=this.element.find(".play");this.volumeElement=this.element.find(".volume");var self=this;backend.ready(function(){var sound=soundManager.createSound({id:self.domId,url:self.url});self.sound=sound;sound.load({onload:function(){self._loaded()}})}).init()}Player.prototype._loaded=function(){var self=this;var sound=this.sound;this.playElement.click(function(){self._playSound()});this.seekbarElement.slider({value:0,step:50,max:sound.duration,slide:function(e,ui){self.seeking=true},change:function(e,ui){if(e.originalEvent){sound.setPosition(ui.value);self._updateTimeRemaining()}self.seeking=false}});this.volumeElement.click(function(e){self._updateVolume(calculateNewVolume(e))});this._updateTimeRemaining()};Player.prototype._playSound=function(){var sound=this.sound;var self=this;if(sound.playState===0){sound.play({whileplaying:function(){if(self.seeking){return}self.seekbarElement.slider("value",this.position);self._updateTimeRemaining()},onplay:function(){self._markPlaying()},onresume:function(){self._markPlaying()},onpause:function(){self._markNotPlaying()},onstop:function(){self._markNotPlaying();self._updateTimeRemaining()},onfinish:function(){self._markNotPlaying();sound.setPosition(0);self.seekbarElement.slider("value",0);self._updateTimeRemaining()}})}else{sound.togglePause()}};Player.prototype._markPlaying=function(){this.playing=true;this.playElement.addClass("playing")};Player.prototype._markNotPlaying=function(){this.playing=false;this.playElement.removeClass("playing")};Player.prototype._updateTimeRemaining=function(){this.element.find(".time_remaining").html(formatTimeRemaining(this.sound.duration-this.sound.position))};Player.prototype._updateVolume=function(volume){if(volume!==null){this.sound.setVolume(volume);this.volumeElement.removeClass("v0 v20 v40 v60 v80 v100").addClass("v"+volume)}};return Player}());module.exports.Audio=require("./player/audio")};require.modules[0]["player/audio.js"]=function(module,exports,require){var jQuery=require("jquery");var Backend=require("../backend");module.exports=(function(){function Audio(options){this.options=options||{};this.domId=this.options.domId;this.url=this.options.url;this.deferred=jQuery.Deferred();this.initialized=false;this.initializing=true;var backend=new Backend(this.options);var self=this;backend.ready(function(){var sound=soundManager.createSound({id:self.domId,url:self.url});self.sound=sound;sound.load({onload:function(){self.initializing=false;self.initialized=true;self.deferred.resolve(self.sound)}})}).init()}Audio.prototype.ready=function(callback){if(this.initialized){callback(this.sound);return}this.deferred.done(callback);return this};return Audio}())};require.modules[0]["templates/css.js"]=function(module,exports,require){module.exports=".zd-player{background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAAeCAIAAAAZ2rQwAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAU9JREFUeNrs3b2KhDAUhuFRUmgERQWxtPT+70e0FBFEkIjiz57ZaeYGNC77PoU4jWGSHM6XRp3zPLdta9vWGCM3r2vEcTwMwwt4BusbUimltc7zXG7Uuq51XSdJkmWZ/LxoSNd15T+XZcny4wmsb0hpeOM4VlVVFIXqui5N0zAMpSVKQV40pOd5cr3u+cDf2pCO40RRJFcpQDVNk7Tmfd9vGFjqnOXHc1jckJ+hfd/v+949jkNaM+sBWEnF7wJkIgDLpcgUAHapO5MxZ0JwJqQTAsRRAMRRgDgKgCIEiKMAcZROCNAJATohnRCgCAHiKHEUxFE6IUAcBUAcBYijAChCgDhKHAVxlE4I/Ls4+nnfExMBWGnF7woMgmCeZ6YDuJ8xRgpQZVnWNI00Q631dS8gXZZFns+ZEA9hfUNKxZlfRVE493wQBsC37w/C/AgwADfzyYql0iMqAAAAAElFTkSuQmCC');background-origin:padding-box;background-size:auto;background-repeat:no-repeat;color:#666;display:block;font-family:Arial, Helvetica, sans-serif;font-size:12px;font-style:normal;font-variant:normal;height:32px;list-style-image:none;list-style-position:outside;list-style-type:none;margin-bottom:5px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px;position:relative;text-align:left;width:300px;overflow:hidden}.zd-player .play{-webkit-box-shadow:none;-webkit-transition-delay:0s;-webkit-transition-duration:0s;-webkit-transition-property:all;-webkit-transition-timing-function:cubic-bezier(0.25, 0.1, 0.25, 1);background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAA2CAYAAAARSGNVAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAANRJREFUeNrs1T1KQ0EQwPHfMyEgeAYrCy8hqbSxtfAMgqXVghDYB8HCe4hdStOkSJ9CFDyAlxBkbF6RmK9NoyhvYJvhvzvfs1VEKJU9O0gL/wzchbquJ7jCa8nLfcxwh4MSN3q4wQsuSn0+xCOecFQa4GljZYD9kmz0cNtcOi9NXQedbfAHhjjGqLsBHOMab5sCfMclzubB7/An7huTD2vLjWlT7uetvYGT32vRlBIRsXByznLOS7qIaKd75XTPL+lqne7fZiOl1G7+Janav/uPw18DAFptQhjz98BHAAAAAElFTkSuQmCC');background-origin:padding-box;background-repeat:no-repeat;background-size:auto;background-position:13px -1px;border-bottom-color:#333;border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-bottom-style:none;border-bottom-width:0px;border-left-color:#333;border-left-style:none;border-left-width:0px;border-right-color:#333;border-right-style:none;border-right-width:0px;border-top-color:#333;border-top-left-radius:4px;border-top-right-radius:4px;border-top-style:none;border-top-width:0px;box-shadow:none;clear:none;color:#333;display:block;font-family:Arial, Helvetica, sans-serif;font-size:13px;font-style:normal;font-variant:normal;height:30px;line-height:16px;list-style-image:none;list-style-position:outside;list-style-type:none;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;position:absolute;text-align:left;text-shadow:rgba(255,255,255,0.74609) 0px 1px 1px;width:35px;top:0px;cursor:pointer;padding:0}.zd-player .play.playing{background-position:13px -23px}.zd-player .seekbar{background-attachment:scroll;background-clip:border-box;background-color:white;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAABkCAYAAAD0ZHJ6AAAAeUlEQVRoge3OMQHAIBAAsVL/nh8JDDfAkCjImpn5HvbfDpwIVoKVYCVYCVaClWAlWAlWgpVgJVgJVoKVYCVYCVaClWAlWAlWgpVgJVgJVoKVYCVYCVaClWAlWAlWgpVgJVgJVoKVYCVYCVaClWAlWAlWgpVgJVgJVhtqiwTEKTLXTgAAAABJRU5ErkJggg==');background-origin:padding-box;background-size:auto;border-bottom-color:#AAA;border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-bottom-style:solid;border-bottom-width:1px;border-left-color:#AAA;border-left-style:solid;border-left-width:1px;border-right-color:#AAA;border-right-style:solid;border-right-width:1px;border-top-color:#AAA;border-top-left-radius:4px;border-top-right-radius:4px;border-top-style:solid;border-top-width:1px;color:#222;display:block;font-family:Arial, sans-serif;font-size:12px;font-style:normal;font-variant:normal;height:3px;left:48px;list-style-image:none;list-style-position:outside;list-style-type:none;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px;position:absolute;text-align:left;top:13px;width:160px}.zd-player .ui-slider-handle{background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAA2CAYAAADOBhlKAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAo9JREFUeNrsVc1rE0EUf/uRLyNNSTZt7aokoRJDLHoSxCCIIJ56FfofrEQ8Cz0W/AcCucaL4LE9SBFED56EgsUkF21cjMZ8kDTrZrsxbHadt02gSWarUC/GPPjBzHtvfjPz5u1vGcuy4DTGwiltRvAXCPinLx5NaQ3uEWwRfB1ga+CbrMHYPEDwZDG4IiWjtyEUuGA7m0pZLHx+vVZrfcqS6WMCxYlg80rsjnT10l0woQ/D72RRiMI5YQX2Pr6U8qVXfeJ6SCNYXwjG0pejN0DrNcAiFMeNIbfFWO1gP904kN8S1/NxAikZuwVqrwJ9s0ctDMd6AHPe7MoSjWDV5WJA1b+BafXpFWc4OOtexuE1ag26pgrqzyohMBwIeHCxc/ZhaAQfurqW6hk/oGu0qQRefh4OdRWHuzSC7P6XvdTyeQHahzIYZnf0vVkvzHkuAsmxc2mN9KzZrmQ0hYX5M1FgGAZ6/Y4NHKNPUxhoKd8zwwLS+mCjVH7PBQNL0tLCTbD82tETGn6oVspkcQl33jipE7HDHrSU6jYBPtX1gf/d4Ng7v2vloe3QkqdU0ph//8/E53K5mSpTVDkcDkuRSAR8Pp/t1HVdlGV5rdFoTKjy+Ak24/G4lEwm7YmqqjbQ0IcxzHG6wjrZOS2KImiaBqZpAsuyNnCMPowJgpAmufdpBFIikQDDMIDneXC73SNAH8YwB3NpNVj1+/14X3sBte+JMg3qQldljuPsxU7fBxLgSRxVmeyewlPgnalvTurR6XRGVPl4DbL5fB68Xi94PJ6JGqAPY5jjqMq1Wi1TLBYnSIaLMVav109WZbIDRxrG7oVQKHT0e282oVAoANngz1SZJG4TzFT5/1HlKSD4JcAA3NULNIccYqwAAAAASUVORK5CYII=');background-position:-1px -31px;background-origin:padding-box;background-size:auto;border-bottom-color:#555;border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-bottom-style:none;border-bottom-width:0px;border-left-color:#555;border-left-style:none;border-left-width:0px;border-right-color:#555;border-right-style:none;border-right-width:0px;border-top-color:#555;border-top-left-radius:4px;border-top-right-radius:4px;border-top-style:none;border-top-width:0px;color:#555;cursor:pointer;font-family:Arial, sans-serif;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;height:14.399999618530273px;list-style-image:none;list-style-position:outside;list-style-type:none;margin-bottom:0px;margin-left:-7.2px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px;position:absolute;text-align:left;text-decoration:none;top:-5px;width:14.399999618530273px;z-index:3;outline:none}.zd-player .ui-slider-handle:hover{background-position:-1px -9px}.zd-player .time_remaining{color:#666;display:block;font-family:Arial, Helvetica, sans-serif;font-size:12px;font-style:normal;font-variant:normal;height:14px;line-height:14.399999618530273px;list-style-image:none;list-style-position:outside;list-style-type:none;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px;position:absolute;right:53px;text-align:left;top:9px}.zd-player .volume{background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAACWCAYAAAA1xhPdAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAKJJREFUeNrs1jEKgCAYgFGNTuidPKPHsYYGh4KgDMMnRODwlh/1i7XW0GstoeOCwwfB15xzP3z/2iMaj/8rewYKh897cTV3Qji5Jx7tRWkBh8/QLSkl3QKHw3WLgcLhw3XLWaNc3S26BQ6H6xYDhcO/6pa7jaJb4HC4bjFQOPzLbnnSKLoFDofrFgOF/+UQlVK6nlCvPxwO9/obKHym138TYABVikT8nEQifAAAAABJRU5ErkJggg==');background-origin:padding-box;background-size:auto;border-bottom-color:#555;border-bottom-style:none;border-bottom-width:0px;border-left-color:#555;border-left-style:none;border-left-width:0px;border-right-color:#555;border-right-style:none;border-right-width:0px;border-top-color:#555;border-top-style:none;border-top-width:0px;color:#555;cursor:pointer;display:block;font-family:'Lucida Sans Unicode', 'Lucida Grande', tahoma, Verdana, sans-serif;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;height:12px;line-height:18px;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;outline-color:#555;outline-style:none;outline-width:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px;position:absolute;right:9px;top:9px;vertical-align:baseline;width:29px;background-position:3px -10px;background-repeat:no-repeat}.zd-player .volume.v0{background-position:3px -128px}.zd-player .volume.v20{background-position:3px -106px}.zd-player .volume.v40{background-position:3px -82px}.zd-player .volume.v60{background-position:3px -58px}.zd-player .volume.v80{background-position:3px -34px}.zd-player .volume.v100{background-position:3px -10px}.zd-player.slim{background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPUAAAAYCAYAAAAia7s5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QjFBMkIzNzFDQzU1MTFFMDkzNTBBMkE5MEM3RUFGOUYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QjFBMkIzNzJDQzU1MTFFMDkzNTBBMkE5MEM3RUFGOUYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCMUEyQjM2RkNDNTUxMUUwOTM1MEEyQTkwQzdFQUY5RiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCMUEyQjM3MENDNTUxMUUwOTM1MEEyQTkwQzdFQUY5RiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsLNX7oAAADuSURBVHja7NcxaoRAFAbgicRCsBBshBTiJbbNZfYMOUQukXZvIuQANrYupBvQzmKNdkmZbVbD94EOWj1m+Hlvntq2fQ0hvK/PKQBH9rk+b8/r61LXdVUUxUOrybIsdF0XmqZxNPAHSZKENE1DjPHU9/0lWf89PNDA/W63W5jnOZRluX1WW6cOy7LspsA91QJH8TM3ie2AfzaO2wIQamDH3KlBpwaEGjB+Azo1oFODTg0INWD8BnRqQKjB+G38Bp0aEGpAqIFfd+rrNE0veZ67U8OBxRi35bqF+jwMw8e6VnsobBxHpwP3+dry/C3AAF1NT2NuT4aYAAAAAElFTkSuQmCC');width:245px;height:24px;-moz-box-shadow:#cfcfcf 0px 0px 3px 0px;-webkit-box-shadow:#CFCFCF 0px 0px 3px 0px;box-shadow:#CFCFCF 0px 0px 3px 0px}.zd-player.slim .play{top:-3px}.zd-player.slim .seekbar{height:3px;left:48px;top:10px;width:145px}.zd-player.slim .time_remaining{right:12px;font-size:11px;top:5px}.zd-player.slim .volume{display:none}"};require.modules[0]["templates/html.js"]=function(module,exports,require){module.exports="<span class='play button'>&nbsp;</span><span class='seekbar'><span class='loading'><span class='handle'></span></span></span><span class='time_remaining'></span><span class='volume'></span><span class='clearfix shim'></span>"};require.modules[0]["vendor/soundmanager2.js"]=function(module,exports,require){var window=require("window");var H=require("window");module.exports=function P(P,ca){function l(a){return function(c){var e=this._t;return !e||!e._a?null:a.call(this,c)}}this.flashVersion=8;this.debugFlash=this.debugMode=!1;this.consoleOnly=this.useConsole=!0;this.waitForWindowLoad=!1;this.bgColor="#ffffff";this.useHighPerformance=!1;this.html5PollingInterval=this.flashPollingInterval=null;this.flashLoadTimeout=1000;this.wmode=null;this.allowScriptAccess="always";this.useFlashBlock=!1;this.useHTML5Audio=!0;this.html5Test=/^(probably|maybe)$/i;this.preferFlash=!0;this.noSWFCache=!1;this.audioFormats={mp3:{type:['audio/mpeg; codecs="mp3"',"audio/mpeg","audio/mp3","audio/MPA","audio/mpa-robust"],required:!0},mp4:{related:["aac","m4a"],type:['audio/mp4; codecs="mp4a.40.2"',"audio/aac","audio/x-m4a","audio/MP4A-LATM","audio/mpeg4-generic"],required:!1},ogg:{type:["audio/ogg; codecs=vorbis"],required:!1},wav:{type:['audio/wav; codecs="1"',"audio/wav","audio/wave","audio/x-wav"],required:!1}};this.defaultOptions={autoLoad:!1,autoPlay:!1,from:null,loops:1,onid3:null,onload:null,whileloading:null,onplay:null,onpause:null,onresume:null,whileplaying:null,onposition:null,onstop:null,onfailure:null,onfinish:null,multiShot:!0,multiShotEvents:!1,position:null,pan:0,stream:!0,to:null,type:null,usePolicyFile:!1,volume:100};this.flash9Options={isMovieStar:null,usePeakData:!1,useWaveformData:!1,useEQData:!1,onbufferchange:null,ondataerror:null};this.movieStarOptions={bufferTime:3,serverURL:null,onconnect:null,duration:null};this.movieID="sm2-container";this.id=ca||"sm2movie";this.debugID="soundmanager-debug";this.debugURLParam=/([#?&])debug=1/i;this.versionNumber="V2.97a.20120318";this.movieURL=this.version=null;this.url=P||null;this.altURL=null;this.enabled=this.swfLoaded=!1;this.oMC=null;this.sounds={};this.soundIDs=[];this.didFlashBlock=this.muted=!1;this.filePattern=null;this.filePatterns={flash8:/\.mp3(\?.*)?$/i,flash9:/\.mp3(\?.*)?$/i};this.features={buffering:!1,peakData:!1,waveformData:!1,eqData:!1,movieStar:!1};this.sandbox={};var da;try{da="undefined"!==typeof Audio&&"undefined"!==typeof(new Audio).canPlayType}catch(Wa){da=!1}this.hasHTML5=da;this.html5={usingFlash:null};this.flash={};this.ignoreFlash=this.html5Only=!1;var ya,c=this,h=null,Q,n=navigator.userAgent,g=H,ea=g.location.href.toString(),k=document,fa,R,j,q=[],I=!1,J=!1,o=!1,v=!1,ga=!1,K,s,ha,A,B,S,za,ia,y,T,C,ja,ka,la,U,D,Aa,ma,Ba,V,Ca,L=null,na=null,E,oa,F,W,X,pa,p,Y=!1,qa=!1,Da,Ea,Fa,Z=0,M=null,$,t=null,Ga,aa,N,w,ra,sa,Ha,m,Qa=Array.prototype.slice,z=!1,r,ba,Ia,u,Ja,ta=n.match(/(ipad|iphone|ipod)/i),Ra=n.match(/firefox/i),Sa=n.match(/droid/i),x=n.match(/msie/i),Ta=n.match(/webkit/i),O=n.match(/safari/i)&&!n.match(/chrome/i),Ua=n.match(/opera/i),ua=n.match(/(mobile|pre\/|xoom)/i)||ta,va=!ea.match(/usehtml5audio/i)&&!ea.match(/sm2\-ignorebadua/i)&&O&&!n.match(/silk/i)&&n.match(/OS X 10_6_([3-7])/i),wa="undefined"!==typeof k.hasFocus?k.hasFocus():null,G=O&&"undefined"===typeof k.hasFocus,Ka=!G,La=/(mp3|mp4|mpa)/i,xa=k.location?k.location.protocol.match(/http/i):null,Ma=!xa?"http://":"",Na=/^\s*audio\/(?:x-)?(?:mpeg4|aac|flv|mov|mp4||m4v|m4a|mp4v|3gp|3g2)\s*(?:$|;)/i,Oa="mpeg4,aac,flv,mov,mp4,m4v,f4v,m4a,mp4v,3gp,3g2".split(","),Va=RegExp("\\.("+Oa.join("|")+")(\\?.*)?$","i");this.mimePattern=/^\s*audio\/(?:x-)?(?:mp(?:eg|3))\s*(?:$|;)/i;this.useAltURL=!xa;this._global_a=null;if(ua&&(c.useHTML5Audio=!0,c.preferFlash=!1,ta)){z=c.ignoreFlash=!0}this.supported=this.ok=function(){return t?o&&!v:c.useHTML5Audio&&c.hasHTML5};this.getMovie=function(a){return Q(a)||k[a]||g[a]};this.createSound=function(a){function d(){e=W(e);c.sounds[f.id]=new ya(f);c.soundIDs.push(f.id);return c.sounds[f.id]}var e=null,b=null,f=null;if(!o||!c.ok()){return pa(void 0),!1}2===arguments.length&&(a={id:arguments[0],url:arguments[1]});e=s(a);e.url=$(e.url);f=e;if(p(f.id,!0)){return c.sounds[f.id]}if(aa(f)){b=d(),b._setup_html5(f)}else{if(8<j){if(null===f.isMovieStar){f.isMovieStar=f.serverURL||(f.type?f.type.match(Na):!1)||f.url.match(Va)}if(f.isMovieStar&&f.usePeakData){f.usePeakData=!1}}f=X(f,void 0);b=d();if(8===j){h._createSound(f.id,f.loops||1,f.usePolicyFile)}else{if(h._createSound(f.id,f.url,f.usePeakData,f.useWaveformData,f.useEQData,f.isMovieStar,f.isMovieStar?f.bufferTime:!1,f.loops||1,f.serverURL,f.duration||null,f.autoPlay,!0,f.autoLoad,f.usePolicyFile),!f.serverURL){b.connected=!0,f.onconnect&&f.onconnect.apply(b)}}!f.serverURL&&(f.autoLoad||f.autoPlay)&&b.load(f)}!f.serverURL&&f.autoPlay&&b.play();return b};this.destroySound=function(a,d){if(!p(a)){return !1}var e=c.sounds[a],b;e._iO={};e.stop();e.unload();for(b=0;b<c.soundIDs.length;b++){if(c.soundIDs[b]===a){c.soundIDs.splice(b,1);break}}d||e.destruct(!0);delete c.sounds[a];return !0};this.load=function(a,d){return !p(a)?!1:c.sounds[a].load(d)};this.unload=function(a){return !p(a)?!1:c.sounds[a].unload()};this.onposition=this.onPosition=function(a,d,e,b){return !p(a)?!1:c.sounds[a].onposition(d,e,b)};this.clearOnPosition=function(a,d,e){return !p(a)?!1:c.sounds[a].clearOnPosition(d,e)};this.start=this.play=function(a,d){if(!o||!c.ok()){return pa("soundManager.play(): "+E(!o?"notReady":"notOK")),!1}if(!p(a)){d instanceof Object||(d={url:d});return d&&d.url?(d.id=a,c.createSound(d).play()):!1}return c.sounds[a].play(d)};this.setPosition=function(a,d){return !p(a)?!1:c.sounds[a].setPosition(d)};this.stop=function(a){return !p(a)?!1:c.sounds[a].stop()};this.stopAll=function(){for(var a in c.sounds){c.sounds.hasOwnProperty(a)&&c.sounds[a].stop()}};this.pause=function(a){return !p(a)?!1:c.sounds[a].pause()};this.pauseAll=function(){var a;for(a=c.soundIDs.length-1;0<=a;a--){c.sounds[c.soundIDs[a]].pause()}};this.resume=function(a){return !p(a)?!1:c.sounds[a].resume()};this.resumeAll=function(){var a;for(a=c.soundIDs.length-1;0<=a;a--){c.sounds[c.soundIDs[a]].resume()}};this.togglePause=function(a){return !p(a)?!1:c.sounds[a].togglePause()};this.setPan=function(a,d){return !p(a)?!1:c.sounds[a].setPan(d)};this.setVolume=function(a,d){return !p(a)?!1:c.sounds[a].setVolume(d)};this.mute=function(a){var d=0;"string"!==typeof a&&(a=null);if(a){return !p(a)?!1:c.sounds[a].mute()}for(d=c.soundIDs.length-1;0<=d;d--){c.sounds[c.soundIDs[d]].mute()}return c.muted=!0};this.muteAll=function(){c.mute()};this.unmute=function(a){"string"!==typeof a&&(a=null);if(a){return !p(a)?!1:c.sounds[a].unmute()}for(a=c.soundIDs.length-1;0<=a;a--){c.sounds[c.soundIDs[a]].unmute()}c.muted=!1;return !0};this.unmuteAll=function(){c.unmute()};this.toggleMute=function(a){return !p(a)?!1:c.sounds[a].toggleMute()};this.getMemoryUse=function(){var a=0;h&&8!==j&&(a=parseInt(h._getMemoryUse(),10));return a};this.disable=function(a){var d;"undefined"===typeof a&&(a=!1);if(v){return !1}v=!0;for(d=c.soundIDs.length-1;0<=d;d--){Ba(c.sounds[c.soundIDs[d]])}K(a);m.remove(g,"load",B);return !0};this.canPlayMIME=function(a){var d;c.hasHTML5&&(d=N({type:a}));return !t||d?d:a&&c.ok()?!!(8<j&&a.match(Na)||a.match(c.mimePattern)):null};this.canPlayURL=function(a){var d;c.hasHTML5&&(d=N({url:a}));return !t||d?d:a&&c.ok()?!!a.match(c.filePattern):null};this.canPlayLink=function(a){return"undefined"!==typeof a.type&&a.type&&c.canPlayMIME(a.type)?!0:c.canPlayURL(a.href)};this.getSoundById=function(a){if(!a){throw Error("soundManager.getSoundById(): sID is null/undefined")}return c.sounds[a]};this.onready=function(a,c){if(a&&a instanceof Function){return c||(c=g),ha("onready",a,c),A(),!0}throw E("needFunction","onready")};this.ontimeout=function(a,c){if(a&&a instanceof Function){return c||(c=g),ha("ontimeout",a,c),A({type:"ontimeout"}),!0}throw E("needFunction","ontimeout")};this._wD=this._writeDebug=function(){return !0};this._debug=function(){};this.reboot=function(){var a,d;for(a=c.soundIDs.length-1;0<=a;a--){c.sounds[c.soundIDs[a]].destruct()}try{if(x){na=h.innerHTML}L=h.parentNode.removeChild(h)}catch(e){}na=L=t=null;c.enabled=ka=o=Y=qa=I=J=v=c.swfLoaded=!1;c.soundIDs=[];c.sounds={};h=null;for(a in q){if(q.hasOwnProperty(a)){for(d=q[a].length-1;0<=d;d--){q[a][d].fired=!1}}}g.setTimeout(c.beginDelayedInit,20)};this.getMoviePercent=function(){return h&&"undefined"!==typeof h.PercentLoaded?h.PercentLoaded():null};this.beginDelayedInit=function(){ga=!0;C();setTimeout(function(){if(qa){return !1}U();T();return qa=!0},20);S()};this.destruct=function(){c.disable(!0)};ya=function(a){var d,e,b=this,f,i,Pa,g,k,m,l=!1,n=[],o=0,r,t,q=null;d=null;e=null;this.sID=a.id;this.url=a.url;this._iO=this.instanceOptions=this.options=s(a);this.pan=this.options.pan;this.volume=this.options.volume;this.isHTML5=!1;this._a=null;this.id3={};this._debug=function(){};this.load=function(a){var c=null;if("undefined"!==typeof a){b._iO=s(a,b.options),b.instanceOptions=b._iO}else{if(a=b.options,b._iO=a,b.instanceOptions=b._iO,q&&q!==b.url){b._iO.url=b.url,b.url=null}}if(!b._iO.url){b._iO.url=b.url}b._iO.url=$(b._iO.url);if(b._iO.url===b.url&&0!==b.readyState&&2!==b.readyState){return 3===b.readyState&&b._iO.onload&&b._iO.onload.apply(b,[!!b.duration]),b}a=b._iO;q=b.url;b.loaded=!1;b.readyState=1;b.playState=0;if(aa(a)){if(c=b._setup_html5(a),!c._called_load){b._html5_canplay=!1,b._a.autobuffer="auto",b._a.preload="auto",c.load(),c._called_load=!0,a.autoPlay&&b.play()}}else{try{b.isHTML5=!1,b._iO=X(W(a)),a=b._iO,8===j?h._load(b.sID,a.url,a.stream,a.autoPlay,a.whileloading?1:0,a.loops||1,a.usePolicyFile):h._load(b.sID,a.url,!!a.stream,!!a.autoPlay,a.loops||1,!!a.autoLoad,a.usePolicyFile)}catch(d){D({type:"SMSOUND_LOAD_JS_EXCEPTION",fatal:!0})}}return b};this.unload=function(){0!==b.readyState&&(b.isHTML5?(g(),b._a&&(b._a.pause(),ra(b._a))):8===j?h._unload(b.sID,"about:blank"):h._unload(b.sID),f());return b};this.destruct=function(a){if(b.isHTML5){if(g(),b._a){b._a.pause(),ra(b._a),z||Pa(),b._a._t=null,b._a=null}}else{b._iO.onfailure=null,h._destroySound(b.sID)}a||c.destroySound(b.sID,!0)};this.start=this.play=function(a,c){var d,c=void 0===c?!0:c;a||(a={});b._iO=s(a,b._iO);b._iO=s(b._iO,b.options);b._iO.url=$(b._iO.url);b.instanceOptions=b._iO;if(b._iO.serverURL&&!b.connected){return b.getAutoPlay()||b.setAutoPlay(!0),b}aa(b._iO)&&(b._setup_html5(b._iO),k());if(1===b.playState&&!b.paused&&(d=b._iO.multiShot,!d)){return b}if(!b.loaded){if(0===b.readyState){if(!b.isHTML5){b._iO.autoPlay=!0}b.load(b._iO)}else{if(2===b.readyState){return b}}}if(!b.isHTML5&&9===j&&0<b.position&&b.position===b.duration){a.position=0}if(b.paused&&b.position&&0<b.position){b.resume()}else{b._iO=s(a,b._iO);if(null!==b._iO.from&&null!==b._iO.to&&0===b.instanceCount&&0===b.playState&&!b._iO.serverURL){d=function(){b._iO=s(a,b._iO);b.play(b._iO)};if(b.isHTML5&&!b._html5_canplay){return b.load({_oncanplay:d}),!1}if(!b.isHTML5&&!b.loaded&&(!b.readyState||2!==b.readyState)){return b.load({onload:d}),!1}b._iO=t()}(!b.instanceCount||b._iO.multiShotEvents||!b.isHTML5&&8<j&&!b.getAutoPlay())&&b.instanceCount++;0===b.playState&&b._iO.onposition&&m(b);b.playState=1;b.paused=!1;b.position="undefined"!==typeof b._iO.position&&!isNaN(b._iO.position)?b._iO.position:0;if(!b.isHTML5){b._iO=X(W(b._iO))}b._iO.onplay&&c&&(b._iO.onplay.apply(b),l=!0);b.setVolume(b._iO.volume,!0);b.setPan(b._iO.pan,!0);b.isHTML5?(k(),d=b._setup_html5(),b.setPosition(b._iO.position),d.play()):h._start(b.sID,b._iO.loops||1,9===j?b._iO.position:b._iO.position/1000)}return b};this.stop=function(a){var c=b._iO;if(1===b.playState){b._onbufferchange(0);b._resetOnPosition(0);b.paused=!1;if(!b.isHTML5){b.playState=0}r();c.to&&b.clearOnPosition(c.to);if(b.isHTML5){if(b._a){a=b.position,b.setPosition(0),b.position=a,b._a.pause(),b.playState=0,b._onTimer(),g()}}else{h._stop(b.sID,a),c.serverURL&&b.unload()}b.instanceCount=0;b._iO={};c.onstop&&c.onstop.apply(b)}return b};this.setAutoPlay=function(a){b._iO.autoPlay=a;b.isHTML5||(h._setAutoPlay(b.sID,a),a&&!b.instanceCount&&1===b.readyState&&b.instanceCount++)};this.getAutoPlay=function(){return b._iO.autoPlay};this.setPosition=function(a){void 0===a&&(a=0);var c=b.isHTML5?Math.max(a,0):Math.min(b.duration||b._iO.duration,Math.max(a,0));b.position=c;a=b.position/1000;b._resetOnPosition(b.position);b._iO.position=c;if(b.isHTML5){if(b._a&&b._html5_canplay&&b._a.currentTime!==a){try{b._a.currentTime=a,(0===b.playState||b.paused)&&b._a.pause()}catch(d){}}}else{a=9===j?b.position:a,b.readyState&&2!==b.readyState&&h._setPosition(b.sID,a,b.paused||!b.playState)}b.isHTML5&&b.paused&&b._onTimer(!0);return b};this.pause=function(a){if(b.paused||0===b.playState&&1!==b.readyState){return b}b.paused=!0;b.isHTML5?(b._setup_html5().pause(),g()):(a||void 0===a)&&h._pause(b.sID);b._iO.onpause&&b._iO.onpause.apply(b);return b};this.resume=function(){var a=b._iO;if(!b.paused){return b}b.paused=!1;b.playState=1;b.isHTML5?(b._setup_html5().play(),k()):(a.isMovieStar&&!a.serverURL&&b.setPosition(b.position),h._pause(b.sID));!l&&a.onplay?(a.onplay.apply(b),l=!0):a.onresume&&a.onresume.apply(b);return b};this.togglePause=function(){if(0===b.playState){return b.play({position:9===j&&!b.isHTML5?b.position:b.position/1000}),b}b.paused?b.resume():b.pause();return b};this.setPan=function(a,c){"undefined"===typeof a&&(a=0);"undefined"===typeof c&&(c=!1);b.isHTML5||h._setPan(b.sID,a);b._iO.pan=a;if(!c){b.pan=a,b.options.pan=a}return b};this.setVolume=function(a,d){"undefined"===typeof a&&(a=100);"undefined"===typeof d&&(d=!1);if(b.isHTML5){if(b._a){b._a.volume=Math.max(0,Math.min(1,a/100))}}else{h._setVolume(b.sID,c.muted&&!b.muted||b.muted?0:a)}b._iO.volume=a;if(!d){b.volume=a,b.options.volume=a}return b};this.mute=function(){b.muted=!0;if(b.isHTML5){if(b._a){b._a.muted=!0}}else{h._setVolume(b.sID,0)}return b};this.unmute=function(){b.muted=!1;var a="undefined"!==typeof b._iO.volume;if(b.isHTML5){if(b._a){b._a.muted=!1}}else{h._setVolume(b.sID,a?b._iO.volume:b.options.volume)}return b};this.toggleMute=function(){return b.muted?b.unmute():b.mute()};this.onposition=this.onPosition=function(a,c,d){n.push({position:parseInt(a,10),method:c,scope:"undefined"!==typeof d?d:b,fired:!1});return b};this.clearOnPosition=function(b,a){var c,b=parseInt(b,10);if(isNaN(b)){return !1}for(c=0;c<n.length;c++){if(b===n[c].position&&(!a||a===n[c].method)){n[c].fired&&o--,n.splice(c,1)}}};this._processOnPosition=function(){var a,c;a=n.length;if(!a||!b.playState||o>=a){return !1}for(a-=1;0<=a;a--){if(c=n[a],!c.fired&&b.position>=c.position){c.fired=!0,o++,c.method.apply(c.scope,[c.position])}}return !0};this._resetOnPosition=function(b){var a,c;a=n.length;if(!a){return !1}for(a-=1;0<=a;a--){if(c=n[a],c.fired&&b<=c.position){c.fired=!1,o--}}return !0};t=function(){var a=b._iO,c=a.from,d=a.to,f,e;e=function(){b.clearOnPosition(d,e);b.stop()};f=function(){if(null!==d&&!isNaN(d)){b.onPosition(d,e)}};if(null!==c&&!isNaN(c)){a.position=c,a.multiShot=!1,f()}return a};m=function(){var a,c=b._iO.onposition;if(c){for(a in c){if(c.hasOwnProperty(a)){b.onPosition(parseInt(a,10),c[a])}}}};r=function(){var a,c=b._iO.onposition;if(c){for(a in c){c.hasOwnProperty(a)&&b.clearOnPosition(parseInt(a,10))}}};k=function(){b.isHTML5&&Da(b)};g=function(){b.isHTML5&&Ea(b)};f=function(){n=[];o=0;l=!1;b._hasTimer=null;b._a=null;b._html5_canplay=!1;b.bytesLoaded=null;b.bytesTotal=null;b.duration=b._iO&&b._iO.duration?b._iO.duration:null;b.durationEstimate=null;b.eqData=[];b.eqData.left=[];b.eqData.right=[];b.failures=0;b.isBuffering=!1;b.instanceOptions={};b.instanceCount=0;b.loaded=!1;b.metadata={};b.readyState=0;b.muted=!1;b.paused=!1;b.peakData={left:0,right:0};b.waveformData={left:[],right:[]};b.playState=0;b.position=null};f();this._onTimer=function(a){var c,f=!1,i={};if(b._hasTimer||a){if(b._a&&(a||(0<b.playState||1===b.readyState)&&!b.paused)){c=b._get_html5_duration();if(c!==d){d=c,b.duration=c,f=!0}b.durationEstimate=b.duration;c=1000*b._a.currentTime||0;c!==e&&(e=c,f=!0);(f||a)&&b._whileplaying(c,i,i,i,i);return f}return !1}};this._get_html5_duration=function(){var a=b._iO,c=b._a?1000*b._a.duration:a?a.duration:void 0;return c&&!isNaN(c)&&Infinity!==c?c:a?a.duration:null};this._setup_html5=function(a){var a=s(b._iO,a),d=decodeURI,e=z?c._global_a:b._a,h=d(a.url),g=e&&e._t?e._t.instanceOptions:null;if(e){if(e._t&&(!z&&h===d(q)||z&&g.url===a.url&&(!q||q===g.url))){return e}z&&e._t&&e._t.playState&&a.url!==g.url&&e._t.stop();f();e.src=a.url;q=b.url=a.url;e._called_load=!1}else{e=new Audio(a.url);e._called_load=!1;if(Sa){e._called_load=!0}if(z){c._global_a=e}}b.isHTML5=!0;b._a=e;e._t=b;i();e.loop=1<a.loops?"loop":"";a.autoLoad||a.autoPlay?b.load():(e.autobuffer=!1,e.preload="none");e.loop=1<a.loops?"loop":"";return e};i=function(){if(b._a._added_events){return !1}var a;b._a._added_events=!0;for(a in u){u.hasOwnProperty(a)&&b._a&&b._a.addEventListener(a,u[a],!1)}return !0};Pa=function(){var a;b._a._added_events=!1;for(a in u){u.hasOwnProperty(a)&&b._a&&b._a.removeEventListener(a,u[a],!1)}};this._onload=function(a){a=!!a;b.loaded=a;b.readyState=a?3:2;b._onbufferchange(0);b._iO.onload&&b._iO.onload.apply(b,[a]);return !0};this._onbufferchange=function(a){if(0===b.playState||a&&b.isBuffering||!a&&!b.isBuffering){return !1}b.isBuffering=1===a;b._iO.onbufferchange&&b._iO.onbufferchange.apply(b);return !0};this._onsuspend=function(){b._iO.onsuspend&&b._iO.onsuspend.apply(b);return !0};this._onfailure=function(a,c,d){b.failures++;if(b._iO.onfailure&&1===b.failures){b._iO.onfailure(b,a,c,d)}};this._onfinish=function(){var a=b._iO.onfinish;b._onbufferchange(0);b._resetOnPosition(0);if(b.instanceCount){b.instanceCount--;if(!b.instanceCount){r(),b.playState=0,b.paused=!1,b.instanceCount=0,b.instanceOptions={},b._iO={},g()}(!b.instanceCount||b._iO.multiShotEvents)&&a&&a.apply(b)}};this._whileloading=function(a,c,d,e){var f=b._iO;b.bytesLoaded=a;b.bytesTotal=c;b.duration=Math.floor(d);b.bufferLength=e;if(f.isMovieStar){b.durationEstimate=b.duration}else{if(b.durationEstimate=f.duration?b.duration>f.duration?b.duration:f.duration:parseInt(b.bytesTotal/b.bytesLoaded*b.duration,10),void 0===b.durationEstimate){b.durationEstimate=b.duration}}3!==b.readyState&&f.whileloading&&f.whileloading.apply(b)};this._whileplaying=function(a,c,d,e,f){var i=b._iO;if(isNaN(a)||null===a){return !1}b.position=a;b._processOnPosition();if(!b.isHTML5&&8<j){if(i.usePeakData&&"undefined"!==typeof c&&c){b.peakData={left:c.leftPeak,right:c.rightPeak}}if(i.useWaveformData&&"undefined"!==typeof d&&d){b.waveformData={left:d.split(","),right:e.split(",")}}if(i.useEQData&&"undefined"!==typeof f&&f&&f.leftEQ&&(a=f.leftEQ.split(","),b.eqData=a,b.eqData.left=a,"undefined"!==typeof f.rightEQ&&f.rightEQ)){b.eqData.right=f.rightEQ.split(",")}}1===b.playState&&(!b.isHTML5&&8===j&&!b.position&&b.isBuffering&&b._onbufferchange(0),i.whileplaying&&i.whileplaying.apply(b));return !0};this._onmetadata=function(a,c){var d={},f,e;for(f=0,e=a.length;f<e;f++){d[a[f]]=c[f]}b.metadata=d;b._iO.onmetadata&&b._iO.onmetadata.apply(b)};this._onid3=function(a,c){var d=[],f,e;for(f=0,e=a.length;f<e;f++){d[a[f]]=c[f]}b.id3=s(b.id3,d);b._iO.onid3&&b._iO.onid3.apply(b)};this._onconnect=function(a){a=1===a;if(b.connected=a){b.failures=0,p(b.sID)&&(b.getAutoPlay()?b.play(void 0,b.getAutoPlay()):b._iO.autoLoad&&b.load()),b._iO.onconnect&&b._iO.onconnect.apply(b,[a])}};this._ondataerror=function(){0<b.playState&&b._iO.ondataerror&&b._iO.ondataerror.apply(b)}};la=function(){return k.body||k._docElement||k.getElementsByTagName("div")[0]};Q=function(a){return k.getElementById(a)};s=function(a,d){var e={},b,f;for(b in a){a.hasOwnProperty(b)&&(e[b]=a[b])}b="undefined"===typeof d?c.defaultOptions:d;for(f in b){b.hasOwnProperty(f)&&"undefined"===typeof e[f]&&(e[f]=b[f])}return e};m=function(){function a(a){var a=Qa.call(a),b=a.length;e?(a[1]="on"+a[1],3<b&&a.pop()):3===b&&a.push(!1);return a}function c(a,d){var g=a.shift(),h=[b[d]];if(e){g[h](a[0],a[1])}else{g[h].apply(g,a)}}var e=g.attachEvent,b={add:e?"attachEvent":"addEventListener",remove:e?"detachEvent":"removeEventListener"};return{add:function(){c(a(arguments),"add")},remove:function(){c(a(arguments),"remove")}}}();u={abort:l(function(){}),canplay:l(function(){var a=this._t,c;if(a._html5_canplay){return !0}a._html5_canplay=!0;a._onbufferchange(0);c=!isNaN(a.position)?a.position/1000:null;if(a.position&&this.currentTime!==c){try{this.currentTime=c}catch(e){}}a._iO._oncanplay&&a._iO._oncanplay()}),load:l(function(){var a=this._t;a.loaded||(a._onbufferchange(0),a._whileloading(a.bytesTotal,a.bytesTotal,a._get_html5_duration()),a._onload(!0))}),ended:l(function(){this._t._onfinish()}),error:l(function(){this._t._onload(!1)}),loadeddata:l(function(){var a=this._t,c=a.bytesTotal||1;if(!a._loaded&&!O){a.duration=a._get_html5_duration(),a._whileloading(c,c,a._get_html5_duration()),a._onload(!0)}}),loadedmetadata:l(function(){}),loadstart:l(function(){this._t._onbufferchange(1)}),play:l(function(){this._t._onbufferchange(0)}),playing:l(function(){this._t._onbufferchange(0)}),progress:l(function(a){var c=this._t,e,b=0,f=a.target.buffered;e=a.loaded||0;var i=a.total||1;if(c.loaded){return !1}if(f&&f.length){for(e=f.length-1;0<=e;e--){b=f.end(e)-f.start(e)}e=b/a.target.duration}isNaN(e)||(c._onbufferchange(0),c._whileloading(e,i,c._get_html5_duration()),e&&i&&e===i&&u.load.call(this,a))}),ratechange:l(function(){}),suspend:l(function(a){var c=this._t;u.progress.call(this,a);c._onsuspend()}),stalled:l(function(){}),timeupdate:l(function(){this._t._onTimer()}),waiting:l(function(){this._t._onbufferchange(1)})};aa=function(a){return !a.serverURL&&(a.type?N({type:a.type}):N({url:a.url})||c.html5Only)};ra=function(a){if(a){a.src=Ra?"":"about:blank"}};N=function(a){function d(a){return c.preferFlash&&r&&!c.ignoreFlash&&"undefined"!==typeof c.flash[a]&&c.flash[a]}if(!c.useHTML5Audio||!c.hasHTML5){return !1}var e=a.url||null,a=a.type||null,b=c.audioFormats,f;if(a&&"undefined"!==typeof c.html5[a]){return c.html5[a]&&!d(a)}if(!w){w=[];for(f in b){b.hasOwnProperty(f)&&(w.push(f),b[f].related&&(w=w.concat(b[f].related)))}w=RegExp("\\.("+w.join("|")+")(\\?.*)?$","i")}f=e?e.toLowerCase().match(w):null;if(!f||!f.length){if(a){e=a.indexOf(";"),f=(-1!==e?a.substr(0,e):a).substr(6)}else{return !1}}else{f=f[1]}if(f&&"undefined"!==typeof c.html5[f]){return c.html5[f]&&!d(f)}a="audio/"+f;e=c.html5.canPlayType({type:a});return(c.html5[f]=e)&&c.html5[a]&&!d(a)};Ha=function(){function a(a){var b,e,f=!1;if(!d||"function"!==typeof d.canPlayType){return !1}if(a instanceof Array){for(b=0,e=a.length;b<e&&!f;b++){if(c.html5[a[b]]||d.canPlayType(a[b]).match(c.html5Test)){f=!0,c.html5[a[b]]=!0,c.flash[a[b]]=!(!c.preferFlash||!r||!a[b].match(La))}}return f}a=d&&"function"===typeof d.canPlayType?d.canPlayType(a):!1;return !(!a||!a.match(c.html5Test))}if(!c.useHTML5Audio||"undefined"===typeof Audio){return !1}var d="undefined"!==typeof Audio?Ua?new Audio(null):new Audio:null,e,b={},f,i;f=c.audioFormats;for(e in f){if(f.hasOwnProperty(e)&&(b[e]=a(f[e].type),b["audio/"+e]=b[e],c.flash[e]=c.preferFlash&&!c.ignoreFlash&&e.match(La)?!0:!1,f[e]&&f[e].related)){for(i=f[e].related.length-1;0<=i;i--){b["audio/"+f[e].related[i]]=b[e],c.html5[f[e].related[i]]=b[e],c.flash[f[e].related[i]]=b[e]}}}b.canPlayType=d?a:null;c.html5=s(c.html5,b);return !0};E=function(){};W=function(a){if(8===j&&1<a.loops&&a.stream){a.stream=!1}return a};X=function(a){if(a&&!a.usePolicyFile&&(a.onid3||a.usePeakData||a.useWaveformData||a.useEQData)){a.usePolicyFile=!0}return a};pa=function(){};fa=function(){return !1};Ba=function(a){for(var c in a){a.hasOwnProperty(c)&&"function"===typeof a[c]&&(a[c]=fa)}};V=function(a){"undefined"===typeof a&&(a=!1);(v||a)&&c.disable(a)};Ca=function(a){var d=null;if(a){if(a.match(/\.swf(\?.*)?$/i)){if(d=a.substr(a.toLowerCase().lastIndexOf(".swf?")+4)){return a}}else{a.lastIndexOf("/")!==a.length-1&&(a+="/")}}a=(a&&-1!==a.lastIndexOf("/")?a.substr(0,a.lastIndexOf("/")+1):"./")+c.movieURL;c.noSWFCache&&(a+="?ts="+(new Date).getTime());return a};ia=function(){j=parseInt(c.flashVersion,10);if(8!==j&&9!==j){c.flashVersion=j=8}var a=c.debugMode||c.debugFlash?"_debug.swf":".swf";if(c.useHTML5Audio&&!c.html5Only&&c.audioFormats.mp4.required&&9>j){c.flashVersion=j=9}c.version=c.versionNumber+(c.html5Only?" (HTML5-only mode)":9===j?" (AS3/Flash 9)":" (AS2/Flash 8)");8<j?(c.defaultOptions=s(c.defaultOptions,c.flash9Options),c.features.buffering=!0,c.defaultOptions=s(c.defaultOptions,c.movieStarOptions),c.filePatterns.flash9=RegExp("\\.(mp3|"+Oa.join("|")+")(\\?.*)?$","i"),c.features.movieStar=!0):c.features.movieStar=!1;c.filePattern=c.filePatterns[8!==j?"flash9":"flash8"];c.movieURL=(8===j?"soundmanager2.swf":"soundmanager2_flash9.swf").replace(".swf",a);c.features.peakData=c.features.waveformData=c.features.eqData=8<j};Aa=function(a,c){if(!h){return !1}h._setPolling(a,c)};ma=function(){if(c.debugURLParam.test(ea)){c.debugMode=!0}};p=this.getSoundById;F=function(){var a=[];c.debugMode&&a.push("sm2_debug");c.debugFlash&&a.push("flash_debug");c.useHighPerformance&&a.push("high_performance");return a.join(" ")};oa=function(){E("fbHandler");var a=c.getMoviePercent(),d={type:"FLASHBLOCK"};if(c.html5Only){return !1}if(c.ok()){if(c.oMC){c.oMC.className=[F(),"movieContainer","swf_loaded"+(c.didFlashBlock?" swf_unblocked":"")].join(" ")}}else{if(t){c.oMC.className=F()+" movieContainer "+(null===a?"swf_timedout":"swf_error")}c.didFlashBlock=!0;A({type:"ontimeout",ignoreInit:!0,error:d});D(d)}};ha=function(a,c,e){"undefined"===typeof q[a]&&(q[a]=[]);q[a].push({method:c,scope:e||null,fired:!1})};A=function(a){a||(a={type:"onready"});if(!o&&a&&!a.ignoreInit||"ontimeout"===a.type&&c.ok()){return !1}var d={success:a&&a.ignoreInit?c.ok():!v},e=a&&a.type?q[a.type]||[]:[],b=[],f,d=[d],i=t&&c.useFlashBlock&&!c.ok();if(a.error){d[0].error=a.error}for(a=0,f=e.length;a<f;a++){!0!==e[a].fired&&b.push(e[a])}if(b.length){for(a=0,f=b.length;a<f;a++){if(b[a].scope?b[a].method.apply(b[a].scope,d):b[a].method.apply(this,d),!i){b[a].fired=!0}}}return !0};B=function(){g.setTimeout(function(){c.useFlashBlock&&oa();A();c.onload instanceof Function&&c.onload.apply(g);c.waitForWindowLoad&&m.add(g,"load",B)},1)};ba=function(){if(void 0!==r){return r}var a=!1,c=navigator,e=c.plugins,b,f=g.ActiveXObject;if(e&&e.length){(c=c.mimeTypes)&&c["application/x-shockwave-flash"]&&c["application/x-shockwave-flash"].enabledPlugin&&c["application/x-shockwave-flash"].enabledPlugin.description&&(a=!0)}else{if("undefined"!==typeof f){try{b=new f("ShockwaveFlash.ShockwaveFlash")}catch(i){}a=!!b}}return r=a};Ga=function(){var a,d;if(ta&&n.match(/os (1|2|3_0|3_1)/i)){c.hasHTML5=!1;c.html5Only=!0;if(c.oMC){c.oMC.style.display="none"}return !1}if(c.useHTML5Audio){if(!c.html5||!c.html5.canPlayType){return c.hasHTML5=!1,!0}c.hasHTML5=!0;if(va&&ba()){return !0}}else{return !0}for(d in c.audioFormats){if(c.audioFormats.hasOwnProperty(d)&&(c.audioFormats[d].required&&!c.html5.canPlayType(c.audioFormats[d].type)||c.flash[d]||c.flash[c.audioFormats[d].type])){a=!0}}c.ignoreFlash&&(a=!1);c.html5Only=c.hasHTML5&&c.useHTML5Audio&&!a;return !c.html5Only};$=function(a){var d,e,b=0;if(a instanceof Array){for(d=0,e=a.length;d<e;d++){if(a[d] instanceof Object){if(c.canPlayMIME(a[d].type)){b=d;break}}else{if(c.canPlayURL(a[d])){b=d;break}}}if(a[b].url){a[b]=a[b].url}return a[b]}return a};Da=function(a){if(!a._hasTimer){a._hasTimer=!0,!ua&&c.html5PollingInterval&&(null===M&&0===Z&&(M=H.setInterval(Fa,c.html5PollingInterval)),Z++)}};Ea=function(a){if(a._hasTimer){a._hasTimer=!1,!ua&&c.html5PollingInterval&&Z--}};Fa=function(){var a;if(null!==M&&!Z){return H.clearInterval(M),M=null,!1}for(a=c.soundIDs.length-1;0<=a;a--){c.sounds[c.soundIDs[a]].isHTML5&&c.sounds[c.soundIDs[a]]._hasTimer&&c.sounds[c.soundIDs[a]]._onTimer()}};D=function(a){a="undefined"!==typeof a?a:{};c.onerror instanceof Function&&c.onerror.apply(g,[{type:"undefined"!==typeof a.type?a.type:null}]);"undefined"!==typeof a.fatal&&a.fatal&&c.disable()};Ia=function(){if(!va||!ba()){return !1}var a=c.audioFormats,d,e;for(e in a){if(a.hasOwnProperty(e)&&("mp3"===e||"mp4"===e)){if(c.html5[e]=!1,a[e]&&a[e].related){for(d=a[e].related.length-1;0<=d;d--){c.html5[a[e].related[d]]=!1}}}}};this._setSandboxType=function(){};this._externalInterfaceOK=function(){if(c.swfLoaded){return !1}(new Date).getTime();c.swfLoaded=!0;G=!1;va&&Ia();x?setTimeout(R,100):R()};U=function(a,d){function e(a,b){return'<param name="'+a+'" value="'+b+'" />'}if(I&&J){return !1}if(c.html5Only){return ia(),c.oMC=Q(c.movieID),R(),J=I=!0,!1}var b=d||c.url,f=c.altURL||b,i;i=la();var g,h,j=F(),l,m=null,m=(m=k.getElementsByTagName("html")[0])&&m.dir&&m.dir.match(/rtl/i),a="undefined"===typeof a?c.id:a;ia();c.url=Ca(xa?b:f);d=c.url;c.wmode=!c.wmode&&c.useHighPerformance?"transparent":c.wmode;if(null!==c.wmode&&(n.match(/msie 8/i)||!x&&!c.useHighPerformance)&&navigator.platform.match(/win32|win64/i)){c.wmode=null}i={name:a,id:a,src:d,quality:"high",allowScriptAccess:c.allowScriptAccess,bgcolor:c.bgColor,pluginspage:Ma+"www.macromedia.com/go/getflashplayer",title:"JS/Flash audio component (SoundManager 2)",type:"application/x-shockwave-flash",wmode:c.wmode,hasPriority:"true"};if(c.debugFlash){i.FlashVars="debug=1"}c.wmode||delete i.wmode;if(x){b=k.createElement("div"),h=['<object id="'+a+'" data="'+d+'" type="'+i.type+'" title="'+i.title+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+Ma+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0" width="'+i.width+'" height="'+i.height+'">',e("movie",d),e("AllowScriptAccess",c.allowScriptAccess),e("quality",i.quality),c.wmode?e("wmode",c.wmode):"",e("bgcolor",c.bgColor),e("hasPriority","true"),c.debugFlash?e("FlashVars",i.FlashVars):"","</object>"].join("")}else{for(g in b=k.createElement("embed"),i){i.hasOwnProperty(g)&&b.setAttribute(g,i[g])}}ma();j=F();if(i=la()){if(c.oMC=Q(c.movieID)||k.createElement("div"),c.oMC.id){l=c.oMC.className;c.oMC.className=(l?l+" ":"movieContainer")+(j?" "+j:"");c.oMC.appendChild(b);if(x){g=c.oMC.appendChild(k.createElement("div")),g.className="sm2-object-box",g.innerHTML=h}J=!0}else{c.oMC.id=c.movieID;c.oMC.className="movieContainer "+j;g=j=null;if(!c.useFlashBlock){if(c.useHighPerformance){j={position:"fixed",width:"8px",height:"8px",bottom:"0px",left:"0px",overflow:"hidden"}}else{if(j={position:"absolute",width:"6px",height:"6px",top:"-9999px",left:"-9999px"},m){j.left=Math.abs(parseInt(j.left,10))+"px"}}}if(Ta){c.oMC.style.zIndex=10000}if(!c.debugFlash){for(l in j){j.hasOwnProperty(l)&&(c.oMC.style[l]=j[l])}}try{x||c.oMC.appendChild(b);i.appendChild(c.oMC);if(x){g=c.oMC.appendChild(k.createElement("div")),g.className="sm2-object-box",g.innerHTML=h}J=!0}catch(o){throw Error(E("domError")+" \n"+o.toString())}}}return I=!0};T=function(){if(c.html5Only){return U(),!1}if(h){return !1}h=c.getMovie(c.id);if(!h){L?(x?c.oMC.innerHTML=na:c.oMC.appendChild(L),L=null,I=!0):U(c.id,c.url),h=c.getMovie(c.id)}c.oninitmovie instanceof Function&&setTimeout(c.oninitmovie,1);return !0};S=function(){setTimeout(za,1000)};za=function(){if(Y){return !1}Y=!0;m.remove(g,"load",S);if(G&&!wa){return !1}var a;o||(a=c.getMoviePercent());setTimeout(function(){a=c.getMoviePercent();!o&&Ka&&(null===a?c.useFlashBlock||0===c.flashLoadTimeout?c.useFlashBlock&&oa():V(!0):0!==c.flashLoadTimeout&&V(!0))},c.flashLoadTimeout)};y=function(){function a(){m.remove(g,"focus",y);m.remove(g,"load",y)}if(wa||!G){return a(),!0}wa=Ka=!0;O&&G&&m.remove(g,"mousemove",y);Y=!1;a();return !0};Ja=function(){var a,d=[];if(c.useHTML5Audio&&c.hasHTML5){for(a in c.audioFormats){c.audioFormats.hasOwnProperty(a)&&d.push(a+": "+c.html5[a]+(!c.html5[a]&&r&&c.flash[a]?" (using flash)":c.preferFlash&&c.flash[a]&&r?" (preferring flash)":!c.html5[a]?" ("+(c.audioFormats[a].required?"required, ":"")+"and no flash support)":""))}}};K=function(a){if(o){return !1}if(c.html5Only){return o=!0,B(),!0}var d;if(!c.useFlashBlock||!c.flashLoadTimeout||c.getMoviePercent()){o=!0,v&&(d={type:!r&&t?"NO_FLASH":"INIT_TIMEOUT"})}if(v||a){if(c.useFlashBlock&&c.oMC){c.oMC.className=F()+" "+(null===c.getMoviePercent()?"swf_timedout":"swf_error")}A({type:"ontimeout",error:d});D(d);return !1}if(c.waitForWindowLoad&&!ga){return m.add(g,"load",B),!1}B();return !0};R=function(){if(o){return !1}if(c.html5Only){if(!o){m.remove(g,"load",c.beginDelayedInit),c.enabled=!0,K()}return !0}T();try{h._externalInterfaceTest(!1),Aa(!0,c.flashPollingInterval||(c.useHighPerformance?10:50)),c.debugMode||h._disableDebug(),c.enabled=!0,c.html5Only||m.add(g,"unload",fa)}catch(a){return D({type:"JS_TO_FLASH_EXCEPTION",fatal:!0}),V(!0),K(),!1}K();m.remove(g,"load",c.beginDelayedInit);return !0};C=function(){if(ka){return !1}ka=!0;ma();if(!r&&c.hasHTML5){c.useHTML5Audio=!0,c.preferFlash=!1}Ha();c.html5.usingFlash=Ga();t=c.html5.usingFlash;Ja();if(!r&&t){c.flashLoadTimeout=1}k.removeEventListener&&k.removeEventListener("DOMContentLoaded",C,!1);T();return !0};sa=function(){"complete"===k.readyState&&(C(),k.detachEvent("onreadystatechange",sa));return !0};ja=function(){ga=!0;m.remove(g,"load",ja)};ba();m.add(g,"focus",y);m.add(g,"load",y);m.add(g,"load",S);m.add(g,"load",ja);O&&G&&m.add(g,"mousemove",y);k.addEventListener?k.addEventListener("DOMContentLoaded",C,!1):k.attachEvent?k.attachEvent("onreadystatechange",sa):D({type:"NO_DOM2_EVENTS",fatal:!0});"complete"===k.readyState&&setTimeout(C,100)}};Player=require("player.js")}());var Account=Class.create({initialize:function(attributes){if(attributes.lastTrialDay){attributes.lastTrialDay=new Date(attributes.lastTrialDay)}else{delete attributes.daysLeftInTrial}_.extend(this,attributes)},hasFeature:function(name){return _(this.features).contains(name)}});var User=Class.create({initialize:function(attributes){attributes.passwordExpiresAt=new Date(attributes.passwordExpiresAt);switch(attributes.role){case User.roles.endUser:this.isAnonymous=attributes.id==null;this.isEndUser=true;this.isAgent=false;this.isAdmin=false;break;case User.roles.admin:this.isAnonymous=false;this.isEndUser=false;this.isAgent=true;this.isAdmin=true;break;case User.roles.agent:this.isAnonymous=false;this.isEndUser=false;this.isAgent=true;this.isAdmin=false;break}_.extend(this,attributes)},isPasswordExpiring:function(){var now=(new Date()).valueOf();var staleDuration=5*24*60*60*1000;return(this.passwordExpiresAt>now)&&(this.passwordExpiresAt<now+staleDuration)},isTagged:function(tag){return _(this.tags).contains(tag)}});User.roles={endUser:0,admin:2,agent:4};User.restrictions={none:0,groups:1,organization:2,assigned:3,requested:4};var Organization=Class.create({initialize:function(attributes){_.extend(this,attributes)}});var currentUser=null;var currentAccount=null;var $j=jQuery.noConflict();var $z=(function(){var modules={};var $z=function(key_path){if(typeof(modules[key_path])==="object"){var method_accessor_constructor=function(){};method_accessor_constructor.prototype=modules[key_path];return(new method_accessor_constructor())}};$z.defModule=function(key_path,module){if(typeof(modules[key_path])!=="object"){modules[key_path]=module}};$z.initializeModules=function(instances){$j(document).ready(function(event){$j(instances).each(function(index,instance){if(typeof(modules[instance[0]])==="object"&&typeof(modules[instance[0]].initialize)==="function"){var instantiator=function(){this.initialize.apply(this,instance[1]);delete this["initialize"]};instantiator.prototype=modules[instance[0]];var new_instance=new instantiator()}})})};return($z)})();var Zendesk=$z;(function($){var currentValue=$.cookie("_zendesk_settings");$.cookie("_zendesk_settings",null,{path:"current"});if(!$.cookie("_zendesk_settings")){$.cookie("_zendesk_settings",currentValue,{path:"/",expires:365})}Zendesk.SettingsCookie={get:function(key){return Zendesk.SettingsCookie._data()[key]},set:function(key,value){var data=Zendesk.SettingsCookie._data();data[key]=value;Zendesk.SettingsCookie._save();return value},erase:function(key){var data=Zendesk.SettingsCookie._data();delete data[key];Zendesk.SettingsCookie._save()},_data:function(){Zendesk.SettingsCookie._data_object=Zendesk.SettingsCookie._data_object||JSON.parse($.cookie("_zendesk_settings")||"{}");return Zendesk.SettingsCookie._data_object},_save:function(){var data=Zendesk.SettingsCookie._data();$.cookie("_zendesk_settings",JSON.stringify(data),{path:"/",expires:365})}};window.Cookie=Zendesk.SettingsCookie}(this.jQuery));jQuery.fn.truncateViaFade=function(){this.each(function(){var t=$j(this);t.css("display","block");if(t.css("position")!="absolute"){t.css("position","relative")}t.append($j('<span class="faded_truncation"></span>').css("height",t.height()))})};var arrayEquals=function(a,b){if(a.length!=b.length){return false}for(var i=a.length;--i>=0;){if((a[i] instanceof Date)&&(b[i] instanceof Date)){if(!dateEquals(a[i],b[i])){return false}}else{if(a[i]!==b[i]){return false}}}return true};var dateEquals=function(a,b){return(a instanceof Date)&&(b instanceof Date)&&(a>=b)&&(a<=b)};(function($,exports){if(!exports.Zendesk){exports.Zendesk={}}var Zendesk=exports.Zendesk;if(!!Zendesk.NS){return}var slice=Array.prototype.slice;function applyFunctionIfApplicable(namespace,additionalArgs){if(additionalArgs.length>0){var fn=additionalArgs.pop();if($.isFunction(fn)){fn.apply(namespace,additionalArgs)}else{if(!!fn){throw new Error(fn+" is not a function")}}}}Zendesk.NS=function(namespaceString){var nesting=namespaceString.split("."),currentNS=Zendesk,i;for(i=0;i<nesting.length;i++){var namespace=nesting[i];if(typeof(currentNS[namespace])==="undefined"){currentNS[namespace]={}}currentNS=currentNS[namespace]}applyFunctionIfApplicable(currentNS,slice.call(arguments,1,arguments.length));return currentNS};Zendesk.NS.extend=function(namespaceString,addIn){$.extend(Zendesk.NS(namespaceString),addIn)}}(this.jQuery,this));Zendesk.NS("UI",this.jQuery,function($){this.NestedMenu=function(selector){this._menu=$(selector);var self=this;this.initialize=function(){$(document).bind("click",function(evt){if($(evt.target).parents().index(self._menu)<0){self.collapse()}});var top=self._menu.find("li:eq(0)");top.click(function(){top.find("> ul").show();self._menu.css("z-index","15")});self._menu.find("ul > li").each(function(i,li){var nested_list=$(li);nested_list.mouseover(function(){Zendesk.UI.NestedMenu.close_submenu(nested_list);nested_list.parent().data("selection",$(li));nested_list.find("> ul").show()})});return self};this.collapse=function(){self._menu.find("li").each(function(i,li){$(li).find("ul").hide();self._menu.css("z-index","")});return self}};this.NestedMenu.close_submenu=function(nested_list){var open_li=nested_list.parent().data("selection");if(open_li){$(open_li).find("> ul").hide()}}});jQuery(function($){var assignableAgents=$("#ticket_assignee_id");var bulk_update=assignableAgents.data("bulk-update");var ticketGroup=$("#ticket_group_id");if(!assignableAgents.exists()||!assignableAgents.data("do-dynamic-filtering")){ticketGroup.change(function(){window.assigneeSelect($(this).val())});return}var cachedLookups={};function fetchAgentsForGroup(groupID){if(cachedLookups[groupID]){return new $.Deferred().resolve(cachedLookups[groupID])}else{return $.getJSON(assignableAgents.data("refresh-url"),{group_id:groupID}).done(function(agents){cachedLookups[groupID]=agents})}}function updateAssignableAgentList(agents){var originalValue=assignableAgents.val();if(bulk_update){assignableAgents.html('<option value="-1">'+I18n.t("control.dropdown.value.no_change")+'</option><option value="">-</option>')}else{assignableAgents.html("<option></option>")}_(agents).each(function(agent){assignableAgents.append("<option value='"+agent.id+"'>"+agent.name+"</option>")});assignableAgents.val(originalValue).change()}ticketGroup.change(function(){fetchAgentsForGroup(ticketGroup.val()).done(updateAssignableAgentList)}).change();window.assigneeSelect=function(groupID,userID){groupID=groupID||ticketGroup.val();return fetchAgentsForGroup(groupID).done(updateAssignableAgentList).done(function(){((userID!=null)&&(userID!=undefined))&&userID!==assignableAgents.val()&&assignableAgents.val(userID).change();ticketGroup.add(assignableAgents).blur()})};window.assigneeSelect(null,assignableAgents.data("value"))});(function($){function formatTimeRemaining(ms){var seconds=Math.ceil(ms/1000);var minutes=Math.floor(seconds/60);seconds=seconds%60;if(seconds<10){seconds="0"+seconds}if(minutes<10){minutes="0"+minutes}return minutes+":"+seconds}var volumeControls=_([[3,0],[7,20],[12,40],[17,60],[22,80],[27,100]]);function calculateNewVolume(event){var xOffset=event.pageX;for(var cur=event.target;cur;cur=cur.offsetParent){xOffset-=cur.offsetLeft}return(volumeControls.find(function(control){return xOffset<=control[0]})||[])[1]}Zendesk.AudioPlayer=function(sound,playerElement){this.sound=sound;this.playerElement=playerElement;this.seekbar=this.playerElement.find(".seekbar");this.timeRemaining=this.playerElement.find(".time_remaining");this.playButton=this.playerElement.find(".play");this.volumeButton=this.playerElement.find(".volume");this.seeking=false};Zendesk.AudioPlayer.prototype={init:function(){this.soundObj=this.sound.sound;this.soundObj._player=this;var self=this;if(this.sound.playState()!==0){this.playButton.addClass("playing")}this.playButton.click(function(){self.playButton.toggleClass("playing");if(self.playButton.attr("data-state")==="paused"){self.playButton.attr("data-state","playing");self.play()}else{self.playButton.attr("data-state","paused");self.pause()}});this.volumeButton.click(function(e){self.updateVolume(calculateNewVolume(e))});this.seekbar.slider({value:0,step:50,max:this.sound.duration(),slide:function(e,ui){self.seeking=true},change:function(e,ui){if(e.originalEvent){self.sound.seekTo(ui.value);self.updateTimeRemaining()}self.seeking=false}});this.updateTimeRemaining();return this},play:function(){this.sound.play({whileplaying:this.timeUpdate,onfinish:this.finishedPlaying})},pause:function(){this.sound.pause()},timeUpdate:function(){var self=this._player;if(self.seeking){return}self.seekbar.slider("value",self.sound.position());self.updateTimeRemaining()},finishedPlaying:function(){var self=this._player;self.seekbar.slider("value",0);self.playButton.attr("data-state","paused");self.playButton.removeClass("playing");self.sound.seekTo(0);self.pause();self.updateTimeRemaining()},updateTimeRemaining:function(){this.timeRemaining.html(formatTimeRemaining(this.sound.duration()-this.sound.position()))},updateVolume:function(volume){if(volume!==null){this.sound.volume(volume);this.volumeButton.removeClass("v0 v20 v40 v60 v80 v100").addClass("v"+volume)}}}}(this.jQuery));(function($){$.widget("ui.floating_menu",{options:{menuText:I18n.t("txt.users.show.actions")},_create:function(){var action;$.extend(this.options,{menuText:$(this.element).attr("data-menu-text")});$(this.element).wrap($("<div>").addClass("floating_menu_ui inactive"));action=$("<span>",{html:this.options.menuText}).addClass("floating_menu_action");action.insertBefore(this.element);this.menu=this.element.parent(".floating_menu_ui");action.bind("mouseover",$.proxy(this.show,this));this.menu.bind("mouseleave",$.proxy(this.hide,this))},show:function(e){this.menu.removeClass("inactive")},hide:function(e){this.menu.addClass("inactive")}})}(this.jQuery));$j(function(){$j(".floating_menu").floating_menu()});function identityTypeListElementId(identityType){if(identityType==="google"){identityType="email"}return"#"+identityType+"_identity_list"}Zendesk.Identity=function(userId,identity){this.singleIdentityLimit=["facebook"];this.unverifieds=["email","unverified_email","google"];this.primaries=["email","google"];this.externalIdentities=["facebook","twitter"];this.identityType=identity.identity_type;this.id=identity.id;this.isVerified=identity.is_verified;this.isPrimary=false;this.isExternalIdentity=_(this.externalIdentities).include(this.identityType);this.listElmId=identityTypeListElementId(this.identityType);this.elmId=(identity.identity_type+"_identity_"+identity.id);this.removeUrl="/users/"+userId+(identity.identity_type==="unverified_email"?"/unverified_email_addresses/":"/user_identities/")+identity.id+".json";if(_(this.primaries).include(identity.identity_type)){this.primaryUrl="/users/"+userId+"/user_identities/"+identity.id+"/make_primary.json"}switch(identity.identity_type){case"twitter":this.name="@"+identity.screen_name;break;case"facebook":this.name=identity.name;break;default:this.isPrimary=(identity.priority==1);this.name=identity.value}};Zendesk.Identity.prototype.isUnverified=function(){return(_(this.unverifieds).include(this.identityType)&&!this.isVerified)};Zendesk.Identity.prototype.isPrimaryCandidate=function(){return(_(this.primaries).include(this.identityType)&&this.isVerified)};Zendesk.IdentitiesManager=function(userId,onUpdateCallback){var parseIdentityData=function(userId){var identityData=$j.parseJSON($j("#all_user_identities").html())||[];var unverifiedEmailAddressesData=$j.parseJSON($j("#unverified_email_addresses").html())||[];return $j.merge(identityData,unverifiedEmailAddressesData).map(function(data){return new Zendesk.Identity(userId,data)})};this.registerOnUpdate(onUpdateCallback);this.identities=parseIdentityData(userId)};Zendesk.IdentitiesManager.prototype.find=function(elmId){return _(this.identities).find(function(identity){return identity.elmId==elmId})};Zendesk.IdentitiesManager.prototype.remove=function(identity,callbacks){if(typeof identity=="undefined"){return $j.deferred().reject("No identity provided to be removed")}return $j.ajax({url:identity.removeUrl,type:"DELETE"}).done($j.proxy(function(){this.identities=_(this.identities).without(identity).compact();this.onUpdate()},this))};Zendesk.IdentitiesManager.prototype.registerOnUpdate=function(callback){if(typeof callback==="function"){this.onUpdate=callback}};Zendesk.IdentitiesManager.prototype.makePrimary=function(identity){if(typeof identity.primaryUrl=="undefined"){return $j.deferred().reject("The identity type "+identity.identityType+" cannot be primary")}return $j.ajax({url:identity.primaryUrl,type:"POST"}).done($j.proxy(function(){this.primary().isPrimary=false;identity.isPrimary=true},this))};Zendesk.IdentitiesManager.prototype.empty=function(){return this.identities.length===0};Zendesk.IdentitiesManager.prototype.limitToSingleIdentity=function(identity){return _(this.singleIdentityLimit).include(identity.identityType)};Zendesk.IdentitiesManager.prototype.allPrimaryCandidates=function(){return _(this.identities).select(function(identity){return identity.isPrimaryCandidate()})};Zendesk.IdentitiesManager.prototype.primary=function(){return _(this.allPrimaryCandidates()).detect(function(identity){return identity.isPrimary})};(function($,context){function isForm($node){return $node&&$node.length&&$node.prop&&/^form$/i.test($node.prop("tagName"))}function isTracked($node){return !!$node.data("zd-tracking-enabled")}function markAsTracked($node){$node.data("zd-tracking-enabled",true)}$.fn.extend({instrumentTracking:function(){return $(this).each(function(i,node){node=$(node);if(isTracked(node)){return}if(isForm(node)){node.submit(function(e){var form=$(this);form.trackEvent();e.preventDefault();window.setTimeout(function(){form[0].submit()},500)})}else{node.click(function(){$(this).trackEvent()})}markAsTracked(node)})},trackEvent:function(activity,module){$(this).trackZendeskEvent(activity,module).trackToTangoEvent(activity,module)},trackZendeskEvent:function(activity,module){activity=activity||$(this).closest("[data-metric-activity]").attr("data-metric-activity");module=module||$(this).closest("[data-metric-module]").attr("data-metric-module");if(activity&&module){Zendesk.Instrumentation.track(activity,module)}return $(this)},trackToTangoEvent:function(activity,module){activity=activity||$(this).closest("[data-tracking-activity]").attr("data-tracking-activity");module=module||$(this).closest("[data-tracking-module]").attr("data-tracking-module");if(activity&&module){Zendesk.Instrumentation.ToTango.track(activity,module)}return $(this)}});Zendesk.NS.extend("Instrumentation",{BROWSER_MAP:{Chrome:navigator.userAgent.match(/Chrome/),Safari:(navigator.vendor||"").match(/Apple/),Firefox:navigator.userAgent.match(/Firefox/),IE:navigator.userAgent.match(/MSIE/)},currentBrowser:function(){return _(Zendesk.Instrumentation.BROWSER_MAP).find(function(browser,is){return is?browser:undefined}).first()},track:function(activity,module){return},on:function(obj,selector,activitySpec,module){if(obj[selector].isTracking){return}var tracker=function(){var allArgs=_.toArray(arguments),funcArgs=allArgs.slice(1),func=allArgs[0],funcResult=func.apply(this,funcArgs);if(activitySpec&&module){var activity=_.isFunction(activitySpec)?activitySpec.apply(this,funcArgs):activitySpec;if(activity){Zendesk.Instrumentation.track(activity,module);Zendesk.Instrumentation.ToTango.track(activity,module)}}return funcResult};obj[selector]=_.wrap(obj[selector],tracker);obj[selector].isTracking=true},ToTango:{track:function(activity,module){if(context.currentAccount){var params={sdr_s:Zendesk.ToTangoID,sdr_o:context.currentAccount.subdomain,sdr_ofid:context.currentAccount.id,sdr_u:this.username(),sdr_m:context.currentAccount.isInTrial?"Trial":"Customer",sdr_a:[module,activity].join(": ")};$j.get("/tracker/pixel.gif?"+$j.param(params))}},username:function(){if(context.currentUser===undefined||context.currentUser.isEndUser){return"end-user"}else{if(context.currentUser.id&&!context.currentAccount.isInTrial){return"agent-"+Base64.encode(context.currentUser.id.toString())}else{return context.currentUser.id}}},tracker:{track:function(){},identify:function(){}},PLATFORM_MAP:_([[/mac/i,"Mac"],[/win/i,"Windows"],[/palm/i,"PalmOS"],[/(unix|linux)/i,"Unix"],[/blackberry/i,"Blackberry"]]),trackOperatingSystem:function(){}}});$(function(){$(".tracked").instrumentTracking()})}(this.jQuery,this));(function($){$.fn.extend({exists:function(){return this.length>0}});$.fn.responsiveLoad=function(url,callback){var loading='<center><img src="/images/ajax-loader.gif" alt="Loading"/></center>';var $container=$(this);$container.html(loading).load(url,function(response,status,xhr){if(status=="error"){$container.html("Error:"+xhr.status+" "+xhr.statusText)}else{if(callback){callback(response,status,xhr)}}})};$.fn.pjaxContainer=function(selector){selector=selector||"a";var $container=$(this);$(selector,$container).live("click",function(){$container.responsiveLoad($(this).attr("href"));return false})}}(this.jQuery));Zendesk.JobStatus=function(statusUrl,options){this.statusUrl=statusUrl;var idFromURL=/\/job_statuses\/([^\.\?]+)/;this.id=(statusUrl.match(idFromURL)||[])[1];if(this.id==null&&console&&console.warn){console.warn("Could not parse Job ID from "+statusUrl)}this.options=_.extend({title:"",interval:1000},options);_.bindAll(this);this.createFlashNotice();this.updateProgress()};Zendesk.JobStatus.prototype={createFlashNotice:function(){if(!this.flash){this.flash=$j('<div id="notice" class="processing"><span class="progress"/> <span>'+this.options.title+" </span></div>");$j("#flash_messages div").hide();$j("#flash_messages").append($j('<div id="flash" class="background"></div>').append(this.flash));$j(document).scrollTop($j("#flash_messages").position().top)}return this.flash},updateProgress:function(){var self=this;$j.getJSON(this.statusUrl,function(jobStatus){jobStatus.job=self;if(jobStatus.status!=="completed"){if(jobStatus.total){self.flash.find(".progress").html(""+jobStatus.progress+" / "+jobStatus.total)}setTimeout(self.updateProgress,self.options.interval)}else{var result=self.options.renderResult(jobStatus);self.flash.find(".progress").html(result.title);self.flash.append(result.body);self.flash.removeClass("processing");self.flash.addClass("done_processing")}})}};(function($){Zendesk.Pager=function(container,prevLink,nextLink){this.container=container;this.nextLink=nextLink;this.prevLink=prevLink;this.pages=$(container).find(".page");this.currentPage=0;this.prevLink.css("visibility","hidden");if(this.pages.length<2){this.nextLink.css("visibility","hidden")}};Zendesk.Pager.prototype={paginate:function(callback){this.showPage(this.currentPage);var self=this;$(this.prevLink).click(function(e){if(self.currentPage>0){self.nextLink.css("visibility","visible");self.currentPage=self.currentPage-1;self.showPage(self.currentPage);if(self.currentPage===0){self.prevLink.css("visibility","hidden")}}if(e){e.preventDefault()}});$(this.nextLink).click(function(e){if(self.currentPage<self.pages.length-1){self.prevLink.css("visibility","visible");self.currentPage=self.currentPage+1;self.showPage(self.currentPage);if(self.currentPage===self.pages.length-1){self.nextLink.css("visibility","hidden")}}if(e){e.preventDefault()}});if(_.isFunction(callback)){callback()}},showPage:function(page){_(this.pages).each(function(elem,pageNum){if(pageNum===page){$(elem).show()}else{$(elem).hide()}})}}}(this.jQuery));(function($,setInterval,clearTimeout,exports){function PeriodicWorker(duration){this.duration=duration;this.jobs=[]}PeriodicWorker.prototype={id:null,duration:null,jobs:null,start:function(){if(!this.id){this._work();this.id=setInterval(this._work.bind(this),this.duration)}},stop:function(){if(this.id){clearTimeout(this.id);this.id=null}},_work:function(){$.each(this.jobs,function(i,job){job()})}};exports.PeriodicWorker=PeriodicWorker}(window.jQuery,window.setInterval,window.clearTimeout,window));Zendesk.NS("Utils");Zendesk.Utils.Poller=function(ajaxOptions,wait,maxWait,successCallback,errorCallback,timeoutCallback){this.wait=wait;this.maxWait=maxWait;this.ajaxOptions={url:ajaxOptions.url,method:ajaxOptions.method||"get",data:ajaxOptions.data};this.successCallback=successCallback;this.errorCallback=errorCallback;this.timeoutCallback=timeoutCallback;this.periodicWorker=new PeriodicWorker(wait);this.waited=-wait};Zendesk.Utils.Poller.prototype={start:function(){this.periodicWorker.jobs=[this._poll.bind(this)];this.periodicWorker.start()},stop:function(){this.periodicWorker.stop()},_poll:function(){this.waited=this.waited+this.wait;if(this.waited>this.maxWait){this.stop();if(this.timeoutCallback){this.timeoutCallback()}return}$j.ajax({type:this.ajaxOptions.method,url:this.ajaxOptions.url,data:this.ajaxOptions.data,success:function(response){if(!this.successCallback||!this.successCallback(response)){this.stop()}}.bind(this),error:function(response){if(!this.errorCallback||!this.errorCallback(response)){this.stop()}}.bind(this)})}};var LARGE_SELECT_LENGTH=70;jQuery.fn.extend({autocompleteFromSelectIfLarge:function(options){var tooLarge=LARGE_SELECT_LENGTH;jQuery(this).each(function(i,select){if(jQuery("option",select).length>tooLarge){jQuery(select).autocompleteFromSelect(options)}})}});jQuery.widget("ui.autocompleteFromSelect",{options:{tabIndex:null,placeholder:null,maxResults:15,combobox:true},_create:function(){var self=this,select=this.element,selected=select.children(":selected"),selectWasHidden=select.is(":hidden"),value=selected.val()?selected.text():null,tabIndex=this.options.tabIndex||select.attr("tabindex"),placeholder=this.options.placeholder||select.attr("placeholder"),noResultsTest=select.attr("data-no-matches-message")||"Sorry, no results found.";select.hide();select.wrap("<span />");if(selectWasHidden){select.parent().hide()}var input=jQuery("<input type='text' />").addClass("ui-widget ui-widget-content").focus(function(){jQuery(this).select()}).mouseup(function(event){event.preventDefault()}).autocomplete({delay:0,minLength:0,source:function(request,response){var matcher=new RegExp(jQuery.ui.autocomplete.escapeRegex(request.term),"i");var results=select.children("option:enabled").map(function(){var text=jQuery(this).text(),email=jQuery(this).attr("data-email");if(email){text=text+" "+email}if(this.value&&(!request.term||matcher.test(text))){return{label:text.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+jQuery.ui.autocomplete.escapeRegex(request.term)+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>"),value:text,option:this}}});if(results.length===0){results=[{label:noResultsTest,value:null,option:null,disabled:true}]}if(self.options.maxResults&&results.length>self.options.maxResults){var extra=results.length-self.options.maxResults;var label=""+(extra)+" other result";if(extra>1){label+="s"}label+=". Try refining your search.";var refine={label:label,value:null,option:null,disabled:true};results=results.slice(0,self.options.maxResults);results.push(refine)}response(results)},select:function(event,ui){if(ui.item&&!ui.item.disabled){ui.item.option.selected=true;self._trigger("selected",event,{item:ui.item.option});input.data("searching",false)}},change:function(event,ui){if(!ui.item){var matcher=new RegExp("^"+jQuery.ui.autocomplete.escapeRegex(jQuery(this).val())+"$","i"),valid=false;select.children("option:enabled").each(function(){if(this.value.match(matcher)||jQuery(this).text().match(matcher)){this.selected=valid=true;return false}});if(!valid){jQuery(this).val("");select.val("");return false}}},close:function(event,ui){input.data("searching",false)},search:function(event,ui){input.data("searching",true)}});input.data("autocomplete")._renderItem=function(ul,item){return jQuery("<li></li>").data("item.autocomplete",item).append("<a>"+item.label+"</a>").appendTo(ul)};if(tabIndex){input.attr("tabindex",tabIndex)}if(placeholder){input.attr("placeholder",placeholder)}if(value){input.val(value)}input.insertBefore(select);if(self.options.combobox){var comboButton=jQuery("<input type='button' class='ui-widget combobox-button' value='▼' />").click(function(){if(input.autocomplete("widget").is(":visible")){input.autocomplete("close")}else{input.autocomplete("search","");input.focus()}});input.addClass("combobox").after(comboButton)}select.removeAttr("tabindex").change(function(){var selected=jQuery(":selected",this);if(selected.length&&!input.data("searching")){input.val(selected.text()).change()}else{if(input.data("searching")){input.autocomplete("search",input.val())}}})}});(function(Zendesk,$,_,console){var SEARCH_RESULTS_DATA_SELECTOR="script.search_results_data",warn=function(msg){};if(console&&console.warn){warn=_.bind(console.warn,console)}function parseSearchResultsDataFrom($content){var $script=$content.find(SEARCH_RESULTS_DATA_SELECTOR).last();if(!$script.exists()){warn("Paginator received search results with no script.search_results_data element");return{}}var data={};try{data=JSON.parse($script.html())}catch(e){}return data}var ResultsPaginator=function(containerSelector){if(!containerSelector){throw"Cannot paginate results for empty containerSelector"}this.$container=$(containerSelector);_.bindAll(this,"onMoreClicked","onMoreRetrieved");this.resetPage().bindMoreButton()};ResultsPaginator.parseNextPageFrom=function($content){return parseSearchResultsDataFrom($content).nextPage};ResultsPaginator.prototype={resetPage:function(){this.nextPage=2;return this},onMoreClicked:function(){this.loadMore();return false},loadMore:function(){var moreURL=this.moreButton().attr("href");this.spinner().show();$.ajax(moreURL,{page:this.nextPage}).done(this.onMoreRetrieved)},onMoreRetrieved:function(results){this.spinner().hide();this.removeCurrentMoreButton().appendNewResults(results).applySearchResultData(results)},spinner:function(){return this.$container.find(".progress")},removeCurrentMoreButton:function(){this.$container.find(".show_more_bar").remove();return this},moreButton:function(){return this.$container.find(".show_more_bar a")},bindMoreButton:function(){if(!this.$container.data("moreIsBound")){this.$container.data("moreIsBound",true);this.$container.delegate(".show_more_bar a","click",this.onMoreClicked)}return this},appendNewResults:function(content){$(".item.nobottom").removeClass("nobottom");if(this.onContentRetrievedCallback){this.onContentRetrievedCallback(this,content)}else{this.$container.append(content)}$(".forum_tabs").trigger("events-loaded.entries.zendesk");return this},applySearchResultData:function(){this.nextPage=ResultsPaginator.parseNextPageFrom(this.$container);this.$container.find(SEARCH_RESULTS_DATA_SELECTOR).remove();if(!this.nextPage){this.removeCurrentMoreButton()}return this}};$.fn.paginateResults=function(retrievedEventName){var $this=$(this);if($this.data("resultsPaginator")!=null){return}$this.data("resultsPaginator",new ResultsPaginator(this,retrievedEventName));return $this};$(function(){$(".paginates_with_more").paginateResults()});Zendesk.ResultsPaginator=ResultsPaginator}(this.Zendesk,this.jQuery,this._,this.console));(function($){function selectInteractions(){var selected=$(this).find("[value="+$(this).val()+"]");var interaction=selected.data("select-interaction")||$(this).data("default-interaction");if(interaction instanceof Function){interaction=[interaction]}if(interaction instanceof Array){$(interaction).each($j.proxy(function(i,item){if(item instanceof Function){item.call(this)}},this))}}$.fn.extend({selectInteraction:function(values){if($(this).prop("nodeName").toLowerCase()!=="select"||typeof values==="undefined"){return $(this)}if(values["default-interaction"]){$(this).data("default-interaction",values["default-interaction"])}$(this).change(selectInteractions);return $(this).find("option").each(function(i,node){node=$(node);var optionVal=node.val();if(values[optionVal]){node.data("select-interaction",values[optionVal])}}).change()}})}(window.jQuery));(function($){var defaultOptions={emptyTargetText:"Drop items here",emptyTargetClass:null,items:"> :not(.emptyTarget)"};function onDragInto(evt,ui){$("li.emptyTarget",this).hide()}function onDragIntoOther(evt,ui){var otherLIs=$("li:not(.emptyTarget)",this);if(ui&&ui.item){otherLIs=otherLIs.not(ui.item)}if(otherLIs.length===0){$("li.emptyTarget",this).show()}}$.fn.sortableWithEmptyTarget=function(options){options=$.extend({},defaultOptions,options||{});var emptyTargetText=options.emptyTargetText,emptyTargetClass=["emptyTarget",options.emptyTargetClass].join(" ");delete options.emptyTargetText;delete options.emptyTargetClass;$(this).each(function(){var $this=$(this);$('<li class="'+emptyTargetClass+'">'+emptyTargetText+"</li>").toggle($this.find("li").length===0).appendTo($this);$this.sortable(options).bind("sortover",$.proxy(onDragInto,$this)).sortable("option","connectWith").bind("sortover",$.proxy(onDragIntoOther,$this))})}}(this.jQuery));(function($,context){Zendesk.StatEvent=function(type,data){var url="/stat_event/";url+=type+"/";$.ajax({url:url,type:"GET",data:data,success:function(){}})}}(this.jQuery,this));(function(Zendesk){Zendesk.Storage={isSupported:function(){try{return"localStorage" in window&&window.localStorage!==null}catch(e){return false}},handle:function(){return window.localStorage}}}(Zendesk));(function(){function require(p,parent){var path=require.resolve(p),mod=require.modules[path];if(!mod){throw new Error('failed to require "'+p+'" from '+parent)}if(!mod.exports){mod.exports={};mod.call(mod.exports,mod,mod.exports,require.relative(path))}return mod.exports}require.modules={};require.resolve=function(path){var orig=path,reg=path+".js",index=path+"/index.js";return require.modules[reg]&&reg||require.modules[index]&&index||orig};require.relative=function(parent){return function(p){if("."!=p.charAt(0)){return require(p)}var path=parent.split("/"),segs=p.split("/");path.pop();for(var i=0;i<segs.length;i++){var seg=segs[i];if(".."==seg){path.pop()}else{if("."!=seg){path.push(seg)}}}return require(path.join("/"),parent)}};require.modules.jquery={exports:window.$};require.modules["index.js"]=function(module,exports,require){var Minilog=require("./minilog.js");Minilog.format(function(name,level,args){var prefix=[];if(name){prefix.push(name)}if(level){prefix.push(level)}return prefix.concat(args).join(" ")});var enabled=false,whitelist=[],levelMap={debug:1,info:2,warn:3,error:4};function filter(name,level){var i,expr;for(i=0;i<whitelist.length;i++){expr=whitelist[i];if(expr.topic&&expr.topic.test(name)&&(expr.level==levelMap.debug||levelMap[level]>=expr.level)){return true}}return false}Minilog.enable=function(str){if(!enabled){Minilog.pipe(require("./lib/browser/console.js")).filter(filter)}enabled=true;whitelist=[];if(!str){str="*.debug"}var parts=str.split(/[\s,]+/),i,expr;for(i=0;i<parts.length;i++){expr=parts[i].split(".");if(expr.length>2){expr=[expr.slice(0,-1).join("."),expr.slice(-1).join()]}whitelist.push({topic:new RegExp("^"+expr[0].replace("*",".*")),level:levelMap[expr[1]]||1})}if(typeof window!="undefined"&&window.localStorage){window.localStorage.minilogSettings=JSON.stringify(str)}};if(typeof window!="undefined"){if(window.localStorage&&window.localStorage.minilogSettings){try{Minilog.enable(JSON.parse(window.localStorage.minilogSettings))}catch(e){}}if(window.location&&window.location.search){var match=RegExp("[?&]minilog=([^&]*)").exec(window.location.search);match&&Minilog.enable(decodeURIComponent(match[1]))}}exports=module.exports=Minilog;exports.backends={browser:require("./lib/browser/console.js"),array:require("./lib/browser/array.js"),localstorage:require("./lib/browser/localstorage.js")}};require.modules["lib/browser/array.js"]=function(module,exports,require){var cache=[];module.exports={write:function(str){cache.push(str)},end:function(){},get:function(){return cache},empty:function(){cache=[]}}};require.modules["lib/browser/console.js"]=function(module,exports,require){module.exports={write:function(str){if(typeof console==="undefined"||!console.log){return}if(console.log.apply){return console.log.apply(console,arguments)}if(!JSON||!JSON.stringify){return}var args=Array.prototype.slice.call(arguments),len=args.length;for(var i=0;i<len;i++){args[i]=JSON.stringify(args[i])}console.log(args.join(" "))},end:function(){}}};require.modules["lib/browser/localstorage.js"]=function(module,exports,require){var cache=false;module.exports={write:function(str){if(typeof window=="undefined"||!window.localStorage||typeof JSON=="undefined"||!JSON.stringify||!JSON.parse){return}if(!cache){cache=(window.localStorage.minilog?JSON.parse(window.localStorage.minilog):[])}cache.push(new Date().toString()+" "+str);window.localStorage.minilog=JSON.stringify(cache)},end:function(){}}};require.modules["minilog.js"]=function(module,exports,require){var callbacks=[],log={readable:true},def={format:function(){return""}};log.on=log.addListener=function(ev,callback){callbacks[ev]||(callbacks[ev]=[]);callbacks[ev].unshift(callback);return log};log.emit=function(ev){if(!callbacks[ev]){return}var args=Array.prototype.slice.call(arguments,1);for(var i=callbacks[ev].length-1;i>=0;i--){callbacks[ev][i]&&callbacks[ev][i].apply(log,args)}};log.removeListener=log.removeAllListeners=function(ev,callback){if(!callbacks[ev]){return}if(!callback){delete callbacks[ev];return}for(var i=callbacks[ev].length-1;i>=0;i--){if(callbacks[ev][i]==callback){callbacks[ev].splice(i,1)}}};log.serialize=function(items){if(!JSON||!JSON.stringify){return items}var result=[];for(var i=0;i<items.length;i++){if(items[i]&&typeof items[i]=="object"){if(items[i].constructor&&items[i].constructor.isBuffer){result[i]=items[i].toString()}else{result[i]=JSON.stringify(items[i])}}else{result[i]=items[i]}}return result};exports=module.exports=function create(name){var o=function(){log.emit("item",name,undefined,Array.prototype.slice.call(arguments));return o};o.debug=function(){log.emit("item",name,"debug",Array.prototype.slice.call(arguments));return o};o.info=function(){log.emit("item",name,"info",Array.prototype.slice.call(arguments));return o};o.warn=function(){log.emit("item",name,"warn",Array.prototype.slice.call(arguments));return o};o.error=function(){log.emit("item",name,"error",Array.prototype.slice.call(arguments));return o};return o};exports.format=function(formatter){def.format=formatter};exports.pipe=function(dest){var config={};if(dest._isFormatted){log.on("item",function(name,level,args){if(config.filter&&!config.filter(name,level)){return}dest.format(name,level,args)})}else{log.on("item",function(name,level,args){if(config.filter&&!config.filter(name,level)){return}dest.write((config.format?config:def).format(name,level,log.serialize(args)))})}log.on("end",function(){!dest._isStdio&&dest.end()});var chain={filter:function(cb){config.filter=cb;return chain},format:function(cb){config.format=cb;return chain},pipe:exports.pipe};return chain};exports.end=function(){log.emit("end");callbacks=[]}};Minilog=require("index.js")})();Minilog.pipe(Minilog.backends.array);(function($){var log=Minilog("switchboard");Zendesk.SwitchBoard=function(strategy){if(strategy){this.strategy=new strategy()}else{this.strategy=new Zendesk.SwitchBoard.Strategy.Pubsub()}};Zendesk.SwitchBoard.fakeStorage={setItem:function(){},getItem:function(){return null}};Zendesk.SwitchBoard.Strategy={LocalStorage:(function(){function LocalStorage(){this.name="LocalStorage";this.subscribers={};this.pollingStorage={};this.pollingStorageTime={};this.chooseBackend()}LocalStorage.prototype={init:function(){this.recentMessages=[];if($.browser.msie&&$.browser.version<9&&$.browser.version>=8){this._pollStorage()}else{$(window).bind("storage",$.proxy(this._handler,this))}},chooseBackend:function(){if(Zendesk.Storage.isSupported()){this.backend=Zendesk.Storage.handle()}else{this.backend=Zendesk.SwitchBoard.fakeStorage}},subscribe:function(channel,handler){var channelName=this._channelName(channel);log.info("#subscribe","#local",{channel:channelName});this.subscribers[channelName]||(this.subscribers[channelName]=[]);this.subscribers[channelName].push(handler);this.pollingStorage[channelName]=null},publish:function(channel,message){try{this.backend.setItem(this._channelName(channel),this._message(message))}catch(e){try{window.localStorage.clear()}catch(e){}}this.recentMessages.push(message.uuid);log.info("#publish","#local",{channel:this._channelName(channel),message:message,uuid:message.uuid})},_channelName:function(channel){return"msg:"+Zendesk.currentAccount.subdomain+":"+Zendesk.currentUser.id+":"+channel},_message:function(message){var encodedMessage={__switchboard_ts:(new Date()).getTime(),msg:message};var oldtoJSON=Array.prototype.toJSON;Array.prototype.toJSON=null;encodedMessage=JSON.stringify(encodedMessage);Array.prototype.toJSON=oldtoJSON;return encodedMessage},_pollStorage:function(){for(var key in this.pollingStorage){if(this.pollingStorage.hasOwnProperty(key)){var last=this.pollingStorage[key];var lastTime=this.pollingStorageTime[key];var current=this.backend[key];if(last!=current){var time=(new Date()).getTime();var currentMsg=JSON.parse(current);if(time-currentMsg.__switchboard_ts<10000){message=currentMsg.msg;this._handleMessage(key,message)}else{log.info("#polling-ignore","#local",{message:currentMsg,uuid:currentMsg.msg.uuid})}this.pollingStorage[key]=current;this.pollingStorageTime[key]=time}}}setTimeout($.proxy(this._pollStorage,this),200)},_handler:function(e){var storageEvent=e.originalEvent;var message,callbacks;if(storageEvent.key=="Zendesk.Voice.Logger"){return}if(storageEvent.newValue){var newValue;try{newValue=JSON.parse(storageEvent.newValue)}catch(e){return}if(!$.isPlainObject(newValue)){return}message=newValue.msg}this._handleMessage(storageEvent.key,message)},_truncateRecentMessages:function(){if(this.recentMessages.length>10){this.recentMessages=this.recentMessages.slice(0,10)}},_hasReceivedMessage:function(stamp){if($.inArray(stamp,this.recentMessages)!==-1){this._truncateRecentMessages();return true}else{this.recentMessages.push(stamp);return false}},_handleMessage:function(channel,message){if(message===undefined){return}if(this._hasReceivedMessage(message.uuid)){log.info("#ignore","#local",{channel:channel,message:message,uuid:message.uuid});return}log.info("#receive","#local",{channel:channel,message:message});if(message&&(callbacks=this.subscribers[channel])){for(var i=0;i<callbacks.length;i++){callbacks[i](message)}}},getItem:function(channel){var result,parsedResult;try{result=this.backend.getItem(this._channelName(channel))}catch(e){try{window.localStorage.clear()}catch(e){}}if(result){try{parsedResult=JSON.parse(result)}catch(e){return}if(parsedResult){return parsedResult.msg}}}};return LocalStorage})(),Pubsub:(function(){var recentUuids=[];function Pubsub(){this.name="Pubsub"}Pubsub.prototype={init:function(){if(Zendesk.currentUser.voice.in_maintenance){return}Zendesk.Pubsub.connect(function(){})},subscribe:function(channel,callback){if(Zendesk.currentUser.voice.in_maintenance){return}var channelName=this._channelName(channel);log.info("#subscribe","#pubsub",{channel:channelName});var self=this;Zendesk.Pubsub.subscribe(channelName,function(msg){log.info("#receive","#pubsub",{channel:channelName,message:msg});if(msg.msg.uuid&&$.inArray(msg.msg.uuid,recentUuids)!==-1){log.info("#ignore","#pubsub",{channel:channelName,uuid:msg.msg.uuid,message:msg});return}callback(msg.msg)})},publish:function(channel,message){if(Zendesk.currentUser.voice.in_maintenance){return}var channelName=this._channelName(channel);log.info("#publish","#pubsub",{channel:channelName,message:message,uuid:message.uuid});if(message.uuid){recentUuids.push(message.uuid)}Zendesk.Pubsub.Node.publish(channelName,this._message(message))},_channelName:function(channel){return"msg:"+Zendesk.currentAccount.subdomain+":"+Zendesk.currentUser.id+":"+channel},_message:function(message){return{__switchboard_ts:(new Date()).getTime(),msg:message}}};return Pubsub})()};Zendesk.SwitchBoard.channelName=function(channel){return channel+"."+Zendesk.currentUser.id};Zendesk.SwitchBoard.prototype={subscribes:[],publishes:[],init:function(){this.strategy.init();for(var i=this.subscribes.length-1;i>=0;i--){this.strategy.subscribe.apply(this.strategy,this.subscribes[i])}this.subscribes=[];this._ready=true},subscribe:function(channel,handler){if(!this._ready){this.subscribes.push([channel,handler]);return}for(var i=this.subscribes.length-1;i>=0;i--){this.strategy.subscribe.apply(this.strategy,this.subscribes[i])}this.subscribes=[];this.strategy.subscribe(channel,handler)},publish:function(channel,message){if(!this._ready){this.publishes.push([channel,message]);return}for(var i=this.publishes.length-1;i>=0;i--){this.strategy.publish.apply(this.strategy,this.publishes[i])}this.publishes=[];this.strategy.publish(channel,message)},setItem:function(channel,message){this.publish(channel,message)},getItem:function(channel){if(this.strategy.getItem&&$.isFunction(this.strategy.getItem)){return this.strategy.getItem(channel)}}};Zendesk.SwitchBoard.Dual=(function(){function Dual(options){this.name="Dual";this.recentMessages=[];this._pubsub=new Zendesk.SwitchBoard();this._localStorage=new Zendesk.SwitchBoard(Zendesk.SwitchBoard.Strategy.LocalStorage);this._usePubsub=options.pubsub;this._useLocal=options.local}Dual.prototype={init:function(){if(this._usePubsub){this._pubsub.init()}if(this._useLocal){this._localStorage.init()}},_truncateRecentMessages:function(){if(this.recentMessages.length>10){this.recentMessages=this.recentMessages.slice(0,10)}},_hasReceivedMessage:function(stamp){if($.inArray(stamp,this.recentMessages)!==-1){this._truncateRecentMessages();return true}else{this.recentMessages.push(stamp);return false}},_dualCallback:function(callback){return function(msg){if(this._hasReceivedMessage(msg.uuid)){log.info("#ignore","#dual",{uuid:msg.uuid,message:msg});return}return callback(msg)}},subscribe:function(channel,callback){if(this._usePubsub){this._pubsub.subscribe(channel,this._dualCallback(callback).bind(this))}if(this._useLocal){this._localStorage.subscribe(channel,this._dualCallback(callback).bind(this))}},publish:function(channel,message){if(this._usePubsub){this._pubsub.publish(channel,message)}if(this._useLocal){this._localStorage.publish(channel,message)}},bind:function(channel,callback){if(!this.bindings){this.bindings={}}if(!this.bindings[channel]){this.bindings[channel]=[];var self=this;this.subscribe(channel,function(msg){if(self.bindings&&self.bindings[channel]&&self.bindings[channel].length>0){for(var i=0;i<self.bindings[channel].length;i++){var callback=self.bindings[channel][i];callback(msg.data)}}})}this.bindings[channel].push(callback)},trigger:function(channel,data,givenUuid){this.triggerInternal(channel,data);this.triggerExternal(channel,data,givenUuid)},triggerInternal:function(channel,data){if(this.bindings&&this.bindings[channel]&&this.bindings[channel].length>0){for(var i=0;i<this.bindings[channel].length;i++){var callback=this.bindings[channel][i];callback(data)}}},triggerExternal:function(channel,data,givenUuid){this.publish(channel,{data:data,uuid:givenUuid||uuid()})},record:function(stamp){this.recentMessages.push(stamp)}};return Dual})();if(!window.console){window.console={log:function(){},error:function(){}}}}(jQuery));Zendesk.NS.extend("Text",{autoLink:function(string){return string.replace(/\b(https?:\/\/[^\s"]+)\b/g,'<a href="$1" target="_blank">$1</a>')}});(function($){function checkableTogglerCallback(){var target;if($(this).attr("data-toggles")){target=$($(this).attr("data-toggles"));if($(this).is(":checked")){target.slideDown()}else{target.slideUp()}}if($(this).is(":checked")&&$(this).attr("data-toggles-show")){target=$($(this).attr("data-toggles-show"));target.slideDown()}if($(this).is(":checked")&&$(this).attr("data-toggles-hide")){target=$($(this).attr("data-toggles-hide"));target.slideUp()}}function nonCheckableTogglerCallback(){$($(this).attr("data-toggles")).toggle()}$.fn.extend({isToggler:function(){return $(this).filter("[data-toggles],[data-toggles-show],[data-toggles-hide]").each(function(i,node){node=$(node);var type=node.attr("type");if(type==="checkbox"||type==="radio"){node.change(checkableTogglerCallback)}else{node.click(nonCheckableTogglerCallback)}})}});$(function(){$("#contentwrapper [data-toggles], #contentwrapper [data-toggles-show], #contentwrapper [data-toggles-hide]").isToggler().change()})}(window.jQuery));(function($,Zendesk){function replaceBodyWithIFrame(href){$("#contentcolumn").html('<iframe src="'+href+'" width="100%" height="500px"></iframe>')}function createLink(args){var link=$("<a />").html(args.text).attr("href",args.href);if(args.target){link.attr("target",args.target)}if(args.iframe){link.click(function(){replaceBodyWithIFrame(args.href);return false})}return link}function createListItem(args){args=args||{};if(!args.text){throw ("Property 'text' is required for creating a navigation element")}var result=$("<li />");if(args.href){result.html(createLink(args))}else{result.html($("<span />").html(args.text))}return result}function Section(args){this.element=createListItem(args);this.element.addClass("main clazz");this.element.find("a,span").addClass("tab");this.element.append('<ul class="menu-drop" />')}Section.prototype={addElement:function(args){this.element.find("ul").append(createListItem(args));return this}};Zendesk.NS.extend("TopNav",{Section:Section,addSection:function(args){var section=new Section(args);section.element.appendTo("#top-menu ul.agent-tabs");return section}})}(window.jQuery,window.Zendesk));(function(_){var split=function(array,size){return _.reduce(array,function(acc,curr){var last=_(acc).last();if(last.length>=size){acc.push([curr])}else{last.push(curr)}return acc},[[]])};_.mixin({split:split})}(window._));Zendesk.NS("API",function(){function highlightFields($fields){return $fields.css("color","green")}this.Macro=function(macroID){this.macro_id=macroID;var self=this;this._ticketTransforms={comment:function(macro_result,ticketForm){var value=macro_result.comment.value;var txt=$j("#comment_value",ticketForm);if(value&&txt&&(txt.val()!=value)){txt.val(txt.val()+value);highlightFields(txt)}value=macro_result.comment.is_public;var chk=$j("#comment_is_public",ticketForm);if(value){if(value=="true"){$j("#comment_type",ticketForm).attr("class","say public");chk.attr("checked",true);$j("#twitter_controls",ticketForm).show()}else{$j("#comment_type",ticketForm).attr("class","say private");chk.attr("checked",false);$j("#twitter_controls",ticketForm).hide()}}},current_tags:function(macro_result,ticketForm){if(typeof(ticketTagField)=="undefined"){return}ticketTagField.clear();self._addTags(macro_result.current_tags)},remove_tags:function(macro_result,ticketForm){self._addRemoveTagsInput(macro_result.remove_tags,ticketForm)},_default:function(attribute,macro_result,ticketForm){var elem_id=attribute.split("#")[0];var elem=null;if(elem_id.match(/ticket_fields_/)){elem=$j("#"+elem_id,ticketForm);self._applyToCustomField(elem,macro_result[attribute])}else{elem=$j("#ticket_"+elem_id,ticketForm);if(elem){setSelectedForSelect($("ticket_"+elem_id),macro_result[attribute]);highlightFields(elem)}}}};this._applyToCustomField=function(elem,value){if(elem.is("input:checkbox")){elem.prop("checked",value);return}if(elem.is("select")){if(value===true){value="1"}if(value===false){value="0"}}elem.val(value).change()};this._addTags=function(tag_string){_(tag_string.split(" ")).each(function(tag){if(tag.length>0){ticketTagField.addEntry(tag)}})};this._addRemoveTagsInput=function(tagString,ticketForm){$j("#ticket_remove_tags",ticketForm).val(tagString);var tagSwatches=_(tagString.split(" ")).map(function(tag){return"<span class='tag'>"+tag+"</span>"});$j("#ticket_remove_tags_message",ticketForm).html("Removing tags: "+tagSwatches.join("")).show()};this._fillTicketForm=function(macro_result,ticketForm){var groupID=macro_result.group_id,assigneeID=macro_result.assignee_id;delete macro_result.group_id;delete macro_result.assignee_id;var attributes=_(macro_result).keys();if(groupID||assigneeID){groupID&&$j("#ticket_group_id").val(groupID);assigneeSelect(groupID,assigneeID).done(function(){highlightFields($j("#ticket_group_id, #ticket_assignee_id"))})}for(var i=0,len=attributes.length;i<len;i++){if(this._ticketTransforms[attributes[i]]){this._ticketTransforms[attributes[i]](macro_result,ticketForm)}else{this._ticketTransforms._default(attributes[i],macro_result,ticketForm)}}$j("#macro_applied").val(this.macro_id)}};this.Macro.prototype={evaluate:function(opts){var self=this;var params={};if(opts.ticketForm){params=_($j(opts.ticketForm).serializeArray()).select(function(elem){return elem.name!="_method"})}var url;if(opts.ticketID!==null){url="/api/v1/macros/"+this.macro_id+"/apply.json?ticket_id="+opts.ticketID}else{url="/api/v1/macros/"+this.macro_id+"/apply.json"}$j.ajax({url:url,type:"post",data:$j.param(params),dataType:"json",success:function(macro_result,text_status,request){if(opts.successCallback){opts.successCallback(macro_result)}},error:function(req,textStatus){if(opts.errorCallback){opts.errorCallback(textStatus,req.responseText)}}})},applyToTicket:function(ticketID,ticketForm,callback){var self=this;this.evaluate({ticketID:ticketID,ticketForm:ticketForm,successCallback:function(macro_result){self._fillTicketForm(macro_result,ticketForm);var comment=$j("textarea#comment_value").val();$j("textarea#comment_value").val("").focus().val(comment);Zendesk.Twitter&&Zendesk.Twitter.TicketCreationForm&&(new Zendesk.Twitter.TicketCreationForm()._updateCounter());$(document).fire("macro:applied");$j(document).trigger("applied.macro.zendesk",macro_result);if(callback){callback(macro_result)}}})}};$j(document).bind("applied.macro.zendesk",function(event,macroResult){Zendesk.Instrumentation.ToTango.track("Applied","Macro")})});Zendesk.NS("API",this.jQuery,function($){this.TicketForm=function(formElement){this.ticketForm=$(formElement)};this.TicketForm.prototype={createTicket:function(ticketOptions){return $.ajax({url:"/tickets.json",dataType:"text",type:"POST",data:this.mergeIntoDefaults(ticketOptions)})},mergeIntoDefaults:function(ticketOptions){var defaults=this.formDefaults();defaults.each(function(defaultValueElement){var attributeName=defaultValueElement.name;ticketOptions.each(function(newValueElement){if(typeof(newValueElement[attributeName])!="undefined"){defaultValueElement.value=newValueElement[attributeName]}})});return $.param(defaults)},formDefaults:function(){return this.ticketForm.serializeArray()},hasComment:function(){var value=$.trim(this.ticketForm.find('[name="comment[value]"]').val());return value!==""}}});(function($){if(typeof(Element)!=="undefined"){Element.Methods.originalGetStyle=Element.Methods.getStyle;Element.addMethods({getStyle:function(element,style){try{return Element.Methods.originalGetStyle(element,style)}catch(e){return"static"}}})}if(Prototype&&Prototype.Browser&&Prototype.Browser.IE&&Effect){Effect.Fade=Effect.BlindUp=Effect.SlideUp=function(element){return $(element).hide()};Effect.Appear=Effect.BlindDown=Effect.SlideDown=function(element){return $(element).show()}}}(jQuery));if(typeof deconcept=="undefined"){var deconcept=new Object()}if(typeof deconcept.util=="undefined"){deconcept.util=new Object()}if(typeof deconcept.SWFObjectUtil=="undefined"){deconcept.SWFObjectUtil=new Object()}deconcept.SWFObject=function(_1,id,w,h,_5,c,_7,_8,_9,_a){if(!document.getElementById){return}this.DETECT_KEY=_a?_a:"detectflash";this.skipDetect=deconcept.util.getRequestParameter(this.DETECT_KEY);this.params=new Object();this.variables=new Object();this.attributes=new Array();if(_1){this.setAttribute("swf",_1)}if(id){this.setAttribute("id",id)}if(w){this.setAttribute("width",w)}if(h){this.setAttribute("height",h)}if(_5){this.setAttribute("version",new deconcept.PlayerVersion(_5.toString().split(".")))}this.installedVer=deconcept.SWFObjectUtil.getPlayerVersion();if(!window.opera&&document.all&&this.installedVer.major>7){deconcept.SWFObject.doPrepUnload=true}if(c){this.addParam("bgcolor",c)}var q=_7?_7:"high";this.addParam("quality",q);this.setAttribute("useExpressInstall",false);this.setAttribute("doExpressInstall",false);var _c=(_8)?_8:window.location;this.setAttribute("xiRedirectUrl",_c);this.setAttribute("redirectUrl","");if(_9){this.setAttribute("redirectUrl",_9)}};deconcept.SWFObject.prototype={useExpressInstall:function(_d){this.xiSWFPath=!_d?"expressinstall.swf":_d;this.setAttribute("useExpressInstall",true)},setAttribute:function(_e,_f){this.attributes[_e]=_f},getAttribute:function(_10){return this.attributes[_10]},addParam:function(_11,_12){this.params[_11]=_12},getParams:function(){return this.params},addVariable:function(_13,_14){this.variables[_13]=_14},getVariable:function(_15){return this.variables[_15]},getVariables:function(){return this.variables},getVariablePairs:function(){var _16=new Array();var key;var _18=this.getVariables();for(key in _18){_16[_16.length]=key+"="+_18[key]}return _16},getSWFHTML:function(){var _19="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","PlugIn");this.setAttribute("swf",this.xiSWFPath)}_19='<embed type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'"';_19+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';var _1a=this.getParams();for(var key in _1a){_19+=[key]+'="'+_1a[key]+'" '}var _1c=this.getVariablePairs().join("&");if(_1c.length>0){_19+='flashvars="'+_1c+'"'}_19+="/>"}else{if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","ActiveX");this.setAttribute("swf",this.xiSWFPath)}_19='<object id="'+this.getAttribute("id")+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'">';_19+='<param name="movie" value="'+this.getAttribute("swf")+'" />';var _1d=this.getParams();for(var key in _1d){_19+='<param name="'+key+'" value="'+_1d[key]+'" />'}var _1f=this.getVariablePairs().join("&");if(_1f.length>0){_19+='<param name="flashvars" value="'+_1f+'" />'}_19+="</object>"}return _19},write:function(_20){if(this.getAttribute("useExpressInstall")){var _21=new deconcept.PlayerVersion([6,0,65]);if(this.installedVer.versionIsValid(_21)&&!this.installedVer.versionIsValid(this.getAttribute("version"))){this.setAttribute("doExpressInstall",true);this.addVariable("MMredirectURL",encodeURIComponent(this.getAttribute("xiRedirectUrl")));document.title=document.title.slice(0,47)+" - Flash Player Installation";this.addVariable("MMdoctitle",document.title)}}if(this.skipDetect||this.getAttribute("doExpressInstall")||this.installedVer.versionIsValid(this.getAttribute("version"))){var n=(typeof _20=="string")?document.getElementById(_20):_20;n.innerHTML=this.getSWFHTML();if(!(navigator.plugins&&navigator.mimeTypes.length)){window[this.getAttribute("id")]=document.getElementById(this.getAttribute("id"))}return true}else{if(this.getAttribute("redirectUrl")!=""){document.location.replace(this.getAttribute("redirectUrl"))}}return false}};deconcept.SWFObjectUtil.getPlayerVersion=function(){var _23=new deconcept.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var x=navigator.plugins["Shockwave Flash"];if(x&&x.description){_23=new deconcept.PlayerVersion(x.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."))}}else{if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){var axo=1;var _26=3;while(axo){try{_26++;axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+_26);_23=new deconcept.PlayerVersion([_26,0,0])}catch(e){axo=null}}}else{try{var axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(e){try{var axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");_23=new deconcept.PlayerVersion([6,0,21]);axo.AllowScriptAccess="always"}catch(e){if(_23.major==6){return _23}}try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){}}if(axo!=null){_23=new deconcept.PlayerVersion(axo.GetVariable("$version").split(" ")[1].split(","))}}}return _23};deconcept.PlayerVersion=function(_29){this.major=_29[0]!=null?parseInt(_29[0]):0;this.minor=_29[1]!=null?parseInt(_29[1]):0;this.rev=_29[2]!=null?parseInt(_29[2]):0};deconcept.PlayerVersion.prototype.versionIsValid=function(fv){if(this.major<fv.major){return false}if(this.major>fv.major){return true}if(this.minor<fv.minor){return false}if(this.minor>fv.minor){return true}if(this.rev<fv.rev){return false}return true};deconcept.util={getRequestParameter:function(_2b){var q=document.location.search||document.location.hash;if(_2b==null){return q}if(q){var _2d=q.substring(1).split("&");for(var i=0;i<_2d.length;i++){if(_2d[i].substring(0,_2d[i].indexOf("="))==_2b){return _2d[i].substring((_2d[i].indexOf("=")+1))}}}return""}};deconcept.SWFObjectUtil.cleanupSWFs=function(){var _2f=document.getElementsByTagName("OBJECT");for(var i=_2f.length-1;i>=0;i--){_2f[i].style.display="none";for(var x in _2f[i]){if(typeof _2f[i][x]=="function"){_2f[i][x]=function(){}}}}};if(deconcept.SWFObject.doPrepUnload){if(!deconcept.unloadSet){deconcept.SWFObjectUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};window.attachEvent("onunload",deconcept.SWFObjectUtil.cleanupSWFs)};window.attachEvent("onbeforeunload",deconcept.SWFObjectUtil.prepUnload);deconcept.unloadSet=true}}if(!document.getElementById&&document.all){document.getElementById=function(id){return document.all[id]}}var getQueryParamValue=deconcept.util.getRequestParameter;var FlashObject=deconcept.SWFObject;var SWFObject=deconcept.SWFObject;(function(){Autocompleter.MultiValue.addMethods({beforeFormSubmit:function(){this.addNewValueFromSearchField(this.searchField)}});function correctBlurEvent(autocompleter){Event.stopObserving(autocompleter.searchField,"blur");$j(document.body).bind("click",function(event){var $input=$j(autocompleter.searchField),$output=$j(autocompleter.choicesHolder),isAutocompleteOpen=$output.is(":visible"),isEventFromOutside=$output.find(event.target).length===0&&$input.add($output).filter(event.target).length===0;if(isAutocompleteOpen&&isEventFromOutside){autocompleter.hide()}})}var originalInit=Autocompleter.MultiValue.prototype.initialize;Autocompleter.MultiValue.prototype.initialize=function(){originalInit.apply(this,arguments);correctBlurEvent(this)};Autocompleter.MultiValue.prototype.hide=function(){var self=this;self.stopIndicator();setTimeout(function(){$j(self.choicesHolder).hide()},5)}}());if(typeof Prototype=="undefined"){alert("CalendarDateSelect Error: Prototype could not be found. Please make sure that your application's layout includes prototype.js (.g. <%= javascript_include_tag :defaults %>) *before* it includes calendar_date_select.js (.g. <%= calendar_date_select_includes %>).")}if(Prototype.Version<"1.6"){alert("Prototype 1.6.0 is required.  If using earlier version of prototype, please use calendar_date_select version 1.8.3")}Element.addMethods({purgeChildren:function(element){$A(element.childNodes).each(function(e){$(e).remove()})},build:function(element,type,options,style){var newElement=Element.buildAndAppend(type,options,style);element.appendChild(newElement);return newElement}});Element.buildAndAppend=function(type,options,style){var e=$(document.createElement(type));$H(options).each(function(pair){e[pair.key]=pair.value});if(style){e.setStyle(style)}return e};nil=null;Date.one_day=24*60*60*1000;Date.weekdays=$w("S M T W T F S");Date.first_day_of_week=0;Date.months=$w("January February March April May June July August September October November December");Date.padded2=function(hour){var padded2=parseInt(hour,10);if(hour<10){padded2="0"+padded2}return padded2};Date.prototype.getPaddedMinutes=function(){return Date.padded2(this.getMinutes())};Date.prototype.getAMPMHour=function(){var hour=this.getHours();return(hour==0)?12:(hour>12?hour-12:hour)};Date.prototype.getAMPM=function(){return(this.getHours()<12)?"AM":"PM"};Date.prototype.stripTime=function(){return new Date(this.getFullYear(),this.getMonth(),this.getDate())};Date.prototype.daysDistance=function(compare_date){return Math.round((compare_date-this)/Date.one_day)};Date.prototype.toFormattedString=function(include_time){var hour,str;str=Date.months[this.getMonth()]+" "+this.getDate()+", "+this.getFullYear();if(include_time){hour=this.getHours();str+=" "+this.getAMPMHour()+":"+this.getPaddedMinutes()+" "+this.getAMPM()}return str};Date.parseFormattedString=function(string){return new Date(string)};Math.floor_to_interval=function(n,i){return Math.floor(n/i)*i};window.f_height=function(){return([window.innerHeight?window.innerHeight:null,document.documentElement?document.documentElement.clientHeight:null,document.body?document.body.clientHeight:null].select(function(x){return x>0}).first()||0)};window.f_scrollTop=function(){return([window.pageYOffset?window.pageYOffset:null,document.documentElement?document.documentElement.scrollTop:null,document.body?document.body.scrollTop:null].select(function(x){return x>0}).first()||0)};_translations={OK:"OK",Now:"Now",Today:"Today",Clear:"Clear"};SelectBox=Class.create();SelectBox.prototype={initialize:function(parent_element,values,html_options,style_options){this.element=$(parent_element).build("select",html_options,style_options);this.populate(values)},populate:function(values){this.element.purgeChildren();var that=this;$A(values).each(function(pair){if(typeof(pair)!="object"){pair=[pair,pair]}that.element.build("option",{value:pair[1],innerHTML:pair[0]})})},setValue:function(value){var e=this.element;var matched=false;$R(0,e.options.length-1).each(function(i){if(e.options[i].value==value.toString()){e.selectedIndex=i;matched=true}});return matched},getValue:function(){return $F(this.element)}};CalendarDateSelect=Class.create();CalendarDateSelect.prototype={initialize:function(target_element,options){this.target_element=$(target_element);if(!this.target_element){alert("Target element "+target_element+" not found!");return false}if(this.target_element.tagName!="INPUT"){this.target_element=this.target_element.down("INPUT")}this.target_element.calendar_date_select=this;this.last_click_at=0;this.options=$H({embedded:false,popup:nil,time:false,buttons:true,clear_button:true,year_range:10,close_on_click:nil,minute_interval:5,popup_by:this.target_element,month_year:"dropdowns",onchange:this.target_element.onchange,valid_date_check:nil}).merge(options||{});this.use_time=this.options.get("time");this.parseDate();this.callback("before_show");this.initCalendarDiv();if(!this.options.get("embedded")){this.positionCalendarDiv();Event.observe(document,"mousedown",this.closeIfClickedOut_handler=this.closeIfClickedOut.bindAsEventListener(this));Event.observe(document,"keypress",this.keyPress_handler=this.keyPress.bindAsEventListener(this))}this.callback("after_show")},positionCalendarDiv:function(){var above=false;var c_pos=this.calendar_div.cumulativeOffset(),c_left=c_pos[0],c_top=c_pos[1],c_dim=this.calendar_div.getDimensions(),c_height=c_dim.height,c_width=c_dim.width;var w_top=window.f_scrollTop(),w_height=window.f_height();var e_dim=$(this.options.get("popup_by")).cumulativeOffset(),e_top=e_dim[1],e_left=e_dim[0],e_height=$(this.options.get("popup_by")).getDimensions().height,e_bottom=e_top+e_height;if(((e_bottom+c_height)>(w_top+w_height))&&(e_bottom-c_height>w_top)){above=true}var left_px=e_left.toString()+"px",top_px=(above?(e_top-c_height):(e_top+e_height)).toString()+"px";this.calendar_div.style.left=left_px;this.calendar_div.style.top=top_px;this.calendar_div.setStyle({visibility:""});if(navigator.appName=="Microsoft Internet Explorer"){this.iframe=$(document.body).build("iframe",{src:"javascript:false",className:"ie6_blocker"},{left:left_px,top:top_px,height:c_height.toString()+"px",width:c_width.toString()+"px",border:"0px"})}},initCalendarDiv:function(){if(this.options.get("embedded")){var parent=this.target_element.parentNode;var style={}}else{var parent=document.body;var style={position:"absolute",visibility:"hidden",left:0,top:0}}this.calendar_div=$(parent).build("div",{className:"calendar_date_select"},style);var that=this;$w("top header body buttons footer bottom").each(function(name){eval("var "+name+"_div = that."+name+"_div = that.calendar_div.build('div', { className: 'cds_"+name+"' }, { clear: 'left'} ); ")});this.initHeaderDiv();this.initButtonsDiv();this.initCalendarGrid();this.updateFooter("&#160;");this.refresh();this.setUseTime(this.use_time)},initHeaderDiv:function(){var header_div=this.header_div;this.close_button=header_div.build("a",{innerHTML:"x",href:"#",onclick:function(){this.close();return false}.bindAsEventListener(this),className:"close"});this.next_month_button=header_div.build("a",{innerHTML:"&gt;",href:"#",onclick:function(){this.navMonth(this.date.getMonth()+1);return false}.bindAsEventListener(this),className:"next"});this.prev_month_button=header_div.build("a",{innerHTML:"&lt;",href:"#",onclick:function(){this.navMonth(this.date.getMonth()-1);return false}.bindAsEventListener(this),className:"prev"});if(this.options.get("month_year")=="dropdowns"){this.month_select=new SelectBox(header_div,$R(0,11).map(function(m){return[Date.months[m],m]}),{className:"month",onchange:function(){this.navMonth(this.month_select.getValue())}.bindAsEventListener(this)});this.year_select=new SelectBox(header_div,[],{className:"year",onchange:function(){this.navYear(this.year_select.getValue())}.bindAsEventListener(this)});this.populateYearRange()}else{this.month_year_label=header_div.build("span")}},initCalendarGrid:function(){var body_div=this.body_div;this.calendar_day_grid=[];var days_table=body_div.build("table",{cellPadding:"0px",cellSpacing:"0px",width:"100%"});var weekdays_row=days_table.build("thead").build("tr");Date.weekdays.each(function(weekday){weekdays_row.build("th",{innerHTML:weekday})});var days_tbody=days_table.build("tbody");var row_number=0,weekday;for(var cell_index=0;cell_index<42;cell_index++){weekday=(cell_index+Date.first_day_of_week)%7;if(cell_index%7==0){days_row=days_tbody.build("tr",{className:"row_"+row_number++})}(this.calendar_day_grid[cell_index]=days_row.build("td",{calendar_date_select:this,onmouseover:function(){this.calendar_date_select.dayHover(this)},onmouseout:function(){this.calendar_date_select.dayHoverOut(this)},onclick:function(){this.calendar_date_select.updateSelectedDate(this,true)},className:(weekday==0)||(weekday==6)?" weekend":""},{cursor:"pointer"})).build("div");this.calendar_day_grid[cell_index]}},initButtonsDiv:function(){var buttons_div=this.buttons_div;if(this.options.get("time")){var blank_time=$A(this.options.get("time")=="mixed"?[[" - ",""]]:[]);buttons_div.build("span",{innerHTML:"@",className:"at_sign"});var t=new Date();this.hour_select=new SelectBox(buttons_div,blank_time.concat($R(0,23).map(function(x){t.setHours(x);return $A([t.getAMPMHour()+" "+t.getAMPM(),x])})),{calendar_date_select:this,onchange:function(){this.calendar_date_select.updateSelectedDate({hour:this.value})},className:"hour"});buttons_div.build("span",{innerHTML:":",className:"seperator"});var that=this;this.minute_select=new SelectBox(buttons_div,blank_time.concat($R(0,59).select(function(x){return(x%that.options.get("minute_interval")==0)}).map(function(x){return $A([Date.padded2(x),x])})),{calendar_date_select:this,onchange:function(){this.calendar_date_select.updateSelectedDate({minute:this.value})},className:"minute"})}else{if(!this.options.get("buttons")){buttons_div.remove()}}if(this.options.get("buttons")){buttons_div.build("span",{innerHTML:"&#160;"});if(this.options.get("time")=="mixed"||!this.options.get("time")){b=buttons_div.build("a",{innerHTML:_translations.Today,href:"#",onclick:function(){this.today(false);return false}.bindAsEventListener(this)})}if(this.options.get("time")=="mixed"){buttons_div.build("span",{innerHTML:"&#160;|&#160;",className:"button_seperator"})}if(this.options.get("time")){b=buttons_div.build("a",{innerHTML:_translations.Now,href:"#",onclick:function(){this.today(true);return false}.bindAsEventListener(this)})}if(!this.options.get("embedded")&&!this.closeOnClick()){buttons_div.build("span",{innerHTML:"&#160;|&#160;",className:"button_seperator"});buttons_div.build("a",{innerHTML:_translations.OK,href:"#",onclick:function(){this.close();return false}.bindAsEventListener(this)})}if(this.options.get("clear_button")){buttons_div.build("span",{innerHTML:"&#160;|&#160;",className:"button_seperator"});buttons_div.build("a",{innerHTML:_translations.Clear,href:"#",onclick:function(){this.clearDate();if(!this.options.get("embedded")){this.close()}return false}.bindAsEventListener(this)})}}},refresh:function(){this.refreshMonthYear();this.refreshCalendarGrid();this.setSelectedClass();this.updateFooter()},refreshCalendarGrid:function(){this.beginning_date=new Date(this.date).stripTime();this.beginning_date.setDate(1);this.beginning_date.setHours(12);var pre_days=this.beginning_date.getDay();if(pre_days<3){pre_days+=7}this.beginning_date.setDate(1-pre_days+Date.first_day_of_week);var iterator=new Date(this.beginning_date);var today=new Date().stripTime();var this_month=this.date.getMonth();vdc=this.options.get("valid_date_check");for(var cell_index=0;cell_index<42;cell_index++){day=iterator.getDate();month=iterator.getMonth();cell=this.calendar_day_grid[cell_index];Element.remove(cell.childNodes[0]);div=cell.build("div",{innerHTML:day});if(month!=this_month){div.className="other"}cell.day=day;cell.month=month;cell.year=iterator.getFullYear();if(vdc){if(vdc(iterator.stripTime())){cell.removeClassName("disabled")}else{cell.addClassName("disabled")}}iterator.setDate(day+1)}if(this.today_cell){this.today_cell.removeClassName("today")}if($R(0,41).include(days_until=this.beginning_date.stripTime().daysDistance(today))){this.today_cell=this.calendar_day_grid[days_until];this.today_cell.addClassName("today")}},refreshMonthYear:function(){var m=this.date.getMonth();var y=this.date.getFullYear();if(this.options.get("month_year")=="dropdowns"){this.month_select.setValue(m,false);var e=this.year_select.element;if(this.flexibleYearRange()&&(!(this.year_select.setValue(y,false))||e.selectedIndex<=1||e.selectedIndex>=e.options.length-2)){this.populateYearRange()}this.year_select.setValue(y)}else{this.month_year_label.update(Date.months[m]+" "+y.toString())}},populateYearRange:function(){this.year_select.populate(this.yearRange().toArray())},yearRange:function(){if(!this.flexibleYearRange()){return $R(this.options.get("year_range")[0],this.options.get("year_range")[1])}var y=this.date.getFullYear();return $R(y-this.options.get("year_range"),y+this.options.get("year_range"))},flexibleYearRange:function(){return(typeof(this.options.get("year_range"))=="number")},validYear:function(year){if(this.flexibleYearRange()){return true}else{return this.yearRange().include(year)}},dayHover:function(element){var hover_date=new Date(this.selected_date);hover_date.setFullYear(element.year,element.month,element.day);this.updateFooter(hover_date.toFormattedString(this.use_time))},dayHoverOut:function(element){this.updateFooter()},clearSelectedClass:function(){if(this.selected_cell){this.selected_cell.removeClassName("selected")}},setSelectedClass:function(){if(!this.selection_made){return}this.clearSelectedClass();if($R(0,42).include(days_until=this.beginning_date.stripTime().daysDistance(this.selected_date.stripTime()))){this.selected_cell=this.calendar_day_grid[days_until];this.selected_cell.addClassName("selected")}},reparse:function(){this.parseDate();this.refresh()},dateString:function(){return(this.selection_made)?this.selected_date.toFormattedString(this.use_time):"&#160;"},parseDate:function(){var value=$F(this.target_element).strip();var default_time=this.options.get("default_time");this.selection_made=(value!=""||default_time);this.date=value==""?NaN:Date.parseFormattedString(this.options.get("date")||value);if(isNaN(this.date)&&!default_time){this.date=new Date()}else{if(isNaN(this.date)&&default_time){this.date=(Object.prototype.toString.apply(default_time)==="[object Function]")?default_time():default_time}}if(!this.validYear(this.date.getFullYear())){this.date.setYear((this.date.getFullYear()<this.yearRange().start)?this.yearRange().start:this.yearRange().end)}this.selected_date=new Date(this.date);this.use_time=/[0-9]:[0-9]{2}/.exec(value)?true:false;this.date.setDate(1)},updateFooter:function(text){if(!text){text=this.dateString()}this.footer_div.purgeChildren();this.footer_div.build("span",{innerHTML:text})},clearDate:function(){if((this.target_element.disabled||this.target_element.readOnly)&&this.options.get("popup")!="force"){return false}var last_value=this.target_element.value;this.target_element.value="";this.clearSelectedClass();this.updateFooter("&#160;");if(last_value!=this.target_element.value){this.callback("onchange")}},updateSelectedDate:function(partsOrElement,via_click){var parts=$H(partsOrElement);if((this.target_element.disabled||this.target_element.readOnly)&&this.options.get("popup")!="force"){return false}if(parts.get("day")){var t_selected_date=this.selected_date,vdc=this.options.get("valid_date_check");t_selected_date.setFullYear(parts.get("year"),parts.get("month"),parts.get("day"));if(vdc&&!vdc(t_selected_date.stripTime())){return false}this.selected_date=t_selected_date;this.selection_made=true}if(!isNaN(parts.get("hour"))){this.selected_date.setHours(parts.get("hour"))}if(!isNaN(parts.get("minute"))){this.selected_date.setMinutes(Math.floor_to_interval(parts.get("minute"),this.options.get("minute_interval")))}if(parts.get("hour")===""||parts.get("minute")===""){this.setUseTime(false)}else{if(!isNaN(parts.get("hour"))||!isNaN(parts.get("minute"))){this.setUseTime(true)}}this.updateFooter();this.setSelectedClass();if(this.selection_made){this.updateValue()}if(this.closeOnClick()){this.close()}if(via_click&&!this.options.get("embedded")){if((new Date()-this.last_click_at)<333){this.close()}this.last_click_at=new Date()}},closeOnClick:function(){if(this.options.get("embedded")){return false}if(this.options.get("close_on_click")===nil){return(this.options.get("time"))?false:true}else{return(this.options.get("close_on_click"))}},navMonth:function(month){(target_date=new Date(this.date)).setMonth(month);return(this.navTo(target_date))},navYear:function(year){(target_date=new Date(this.date)).setYear(year);return(this.navTo(target_date))},navTo:function(date){if(!this.validYear(date.getFullYear())){return false}this.date=date;this.date.setDate(1);this.refresh();this.callback("after_navigate",this.date);return true},setUseTime:function(turn_on){this.use_time=this.options.get("time")&&(this.options.get("time")=="mixed"?turn_on:true);if(this.use_time&&this.selected_date){var minute=Math.floor_to_interval(this.selected_date.getMinutes(),this.options.get("minute_interval"));var hour=this.selected_date.getHours();this.hour_select.setValue(hour);this.minute_select.setValue(minute)}else{if(this.options.get("time")=="mixed"){this.hour_select.setValue("");this.minute_select.setValue("")}}},updateValue:function(){var last_value=this.target_element.value;this.target_element.value=this.dateString();if(last_value!=this.target_element.value){this.callback("onchange")}},today:function(now){var d=new Date();this.date=new Date();var o=$H({day:d.getDate(),month:d.getMonth(),year:d.getFullYear(),hour:d.getHours(),minute:d.getMinutes()});if(!now){o=o.merge({hour:"",minute:""})}this.updateSelectedDate(o,true);this.refresh()},close:function(){if(this.closed){return false}this.callback("before_close");this.target_element.calendar_date_select=nil;Event.stopObserving(document,"mousedown",this.closeIfClickedOut_handler);Event.stopObserving(document,"keypress",this.keyPress_handler);this.calendar_div.remove();this.closed=true;if(this.iframe){this.iframe.remove()}if(this.target_element.type!="hidden"&&!this.target_element.disabled){this.target_element.focus()}this.callback("after_close")},closeIfClickedOut:function(e){if(!$(Event.element(e)).descendantOf(this.calendar_div)){this.close()}},keyPress:function(e){if(e.keyCode==Event.KEY_ESC){this.close()}},callback:function(name,param){if(this.options.get(name)){this.options.get(name).bind(this.target_element)(param)}}};var zd={jsInitializers:[],jsData:{}};$j(document).ready(function(){$j("a.colorbox").live("click",function(){var force_photo=$j(this).attr("data-colorbox-force-photo")?true:false;$j.colorbox({href:$j(this).attr("href"),photo:force_photo});return false});$j("[data-learn-more-block]").click(function(){$j(this).hide();$j($j(this).attr("data-learn-more-block")).slideDown();return false});$j(window).hashchange(function(){var favicon=$j("head link[rel='shortcut icon']").remove();$j('<link href="'+favicon.attr("href")+'" rel="shortcut icon" type="'+favicon.attr("type")+'" />').appendTo("head")});$j("p.zendesk-embedded-screencast").replaceWith(function(){return $j('<iframe width="570" height="340"/>').attr("src",$j(this).find("a").attr("href"))})});var items={};function renderPerType(){if($j("#ticket_ticket_type_id").length){if($j("#ticket_linked_id").length){var showProblemSelect=($j("#ticket_ticket_type_id").val()==="2");setVisibility("#ticket_link, #ticket_link > span",showProblemSelect)}if($j("#ticket_date").length){setVisibility("#ticket_date",($j("#ticket_ticket_type_id").val()==="4"));if($j("#ticket_due_date").val()===""){var today=new Date();today.setDate(today.getDate()+7);var endUserFormatted=jQuery.datepicker.formatDate(I18n.t("date.datepicker.date_format"),today);$j("#ticket_due_date").val(endUserFormatted);var rubyFormatted=jQuery.datepicker.formatDate("yy-mm-dd",today);$j("#hidden_date").val(rubyFormatted)}}}}var render_per_type=renderPerType;function hideNavigationLinks(){$j("#top-menu li").hide();$j("#top-right").hide();$j("#add_widget_button").hide();document.observe("widgets:load",function(){$j("#add_widget_button").hide()})}function assigneeSelect(groupId,userId){var assigneeSelectElm=$j("#ticket_assignee_id");assigneeSelectElm.html($j("<option>"));if(!assigneeSelectElm.exists()||groupId===""||typeof groupId=="undefined"){return $j.when()}var group,groupAgentIDs;groupId=Number(groupId);if(groupId>=0){group=_(window.groups).find(function(group){return $j.when(group.id===groupId)});groupAgentIDs=_(group.users);_(window.agents).select(function(agent){return $j.when(groupAgentIDs.contains(agent.id))}).each(function(agentInGroup){assigneeSelectElm.append($j("<option />").val(""+agentInGroup.id).html(""+agentInGroup.name).prop("selected",agentInGroup.id===Number(userId)))})}else{assigneeSelectElm.get(0).selectedIndex=0;assigneeSelectElm.prop("enabled",false)}assigneeSelectElm.change().blur();return $j.when([])}var assignee_select=assigneeSelect;function updateProperties(assignee_id){var groupSelector=$j("#ticket_group_id");if(groupSelector.exists()&&$j.trim(groupSelector.val())!==""&&$j.trim($j("#ticket_assignee_id").val())===""){assigneeSelect(groupSelector.val(),assignee_id)}renderPerType();return true}function highlightAgents(){$j("#facebook-list li.choice").each(function(i,ccUser){ccUser=$j(ccUser);var choiceID=ccUser.attr("choice_id");if(_(agents).any(function(agent){return agent.id===Number(choiceID)})){ccUser.addClass("agent")}if(_(window.lightAgents).any(function(agent){return agent.id===Number(choiceID)})){ccUser.addClass("agent")}})}function setupHighlightAgents(){highlightAgents();$j("#facebook-list ul.multi_value_field").first().bind("DOMNodeInserted",highlightAgents)}function setVisibility(selector,want_visible){if(want_visible){$j(selector).show()}else{$j(selector).hide()}}function submitUpload(){var filename=$j.trim($j("#attachment_content").val());if(filename!==""){$j("#uploadform").submit();$j("#uploadinput").hide();$j("#uploadbar").show()}}function notifyOnError(name){alert("Failed to upload file '"+name+"', verify the path");resetView()}var attachmentLists=[];function registerAttachmentList(listId,size){if(size===null){attachmentLists[listId]=$j(".attach_item").length}else{attachmentLists[listId]=size}}function deleteFromAttachmentList(listId,itemId){$j("#"+itemId).remove();attachmentLists[listId]=attachmentLists[listId]-1;if(attachmentLists[listId]<=0){$j("#"+listId).hide();delete attachmentLists[listId]}}function showFlash(flash,messageType){messageType=(typeof messageType=="undefined")?"notice":messageType;var jsFlash=$j("<div>",{id:messageType,html:flash});$j("#flash").html(jsFlash);new Effect.Highlight("flash",{duration:2})}function clearFlash(){$j("#flash").html("")}function pictureDeleted(key){$j("#cancel-block-"+key).hide();if(key==="header_logo"){$j("#sub_setting_website_url").hide()}selectPicture(key)}function selectPicture(key){$j("#image-block-"+key).hide();$j("#upload-block-"+key).show();$j("#ignore-upload-"+key).val(0)}function resetPicture(key){$j("#upload-block-"+key).hide();$j("#image-block-"+key).show();$j("#ignore-upload-"+key).val(1)}function checkTicketDelete(){if($j("#submit_type").val()==="delete"){alert(I18n.t("txt.public.javascripts.application.warning_deleted_tickets_cannot_be_recovered"))}}function check_ticket(ticket_id){if(IncidentsWarning.getInstance().isShowingWarning()){return false}$("submit-button").value=I18n.t("txt.admin.views.suspended_tickets.index.submitting_label");$("submit-button").disabled=true;if(typeof(collaboratorList)!="undefined"){collaboratorList.update()}if($F("submit_type")!="merge"&&$("edit_requester").style.display=="none"){$("edit_requester").remove()}return true}function copySubmitType(){$("ticket-chat").submit_type.value=$("submit_form").submit_type.value}function submitTicketForm(){if(check_ticket()){$j("#ticket-chat :input").each(function(){this.value=this.value.replace(/\0/g,"")});copySubmitType();if($F("submit_type")=="merge"){new TicketMergeWizard()}else{if(typeof(ticketTagField)!="undefined"){ticketTagField.beforeFormSubmit()}if($j("#ticket_status_id").val()=="3"){Zendesk.Instrumentation.ToTango.track("Solved","Ticket")}Zendesk.Instrumentation.ToTango.track("Save","Ticket");$j(document).trigger("ticket.submit.zendesk");$("ticket-chat").submit()}}}function submitBulkUpdateForm(){if(fetchTicketsToBulkupdate()){if($j("#submit_type").val()==="merge"){new TicketMergeWizard()}else{if($j("#ticket_ticket_type_id").val()!=="4"){$j("#ticket_date").remove()}$j("#ticket-chat").submit()}}}function copySolvedState(){if($("submit_form").solved_true){$("ticketform").ticket_force_status_change.value=$("submit_form").solved_true.checked}}function submitRequestForm(){$j("#submit-button").prop("disabled",true);$("ticketform").submit()}function submitAttachForm(uploading_msg){if($j("#uploads_attribute").length){$j("#token").val($j("#uploads_attribute").val())}$j("#submit-button").val(uploading_msg);$j("#submit-button").prop("disabled",true);$j("#attach_form").submit();$j("#attach_link").hide();$j("#uploading_message").show()}function setSelectedForSelect(select,selectedValue){$j(select).val(selectedValue).change()}function autotagTicket(element){var value=$j(element).val();if($j.trim(value)!==""&&ticketTagField&&ticketTagField.selectedEntries().length===0){new Ajax.Request("/tags/autotag",{parameters:{text:value,target:"ticketTagField"}})}}var autotag_ticket=autotagTicket;function createTooltip(elementId,title,body,options){var content="<div class='title clearfix "+options.title+"'>"+title+"</div><div class='content clearfix "+options.title+"'>"+body+"</div>";$j("#"+elementId).addClass("has-tooltip").tooltip({tooltipClass:"zd_comment "+options["class"],items:".has-tooltip",position:options.position,content:function(){return content}}).unbind("focusin")}function commentTip(elementId,title,body){var options=[];options.position={my:"left top",at:"center bottom",offset:"50px 10px"};createTooltip(elementId,title,body,options)}var comment_tip=commentTip;function cmsCommentTip(elementId,title,body){var options=[];options.title="cms_tooltip_title";options["class"]="cms_tooltip";options.position={offset:"50px 10px"};createTooltip(elementId,title,body,options)}function stv(value,title,tagger_id,evt,this_elm){$j('.field-tagger[data-field-id="'+tagger_id+'"]').ticketTagger("val",value);return false}function reverseTruncate(string,length){return string.split("").reverse().join("").truncate(length).split("").reverse().join("")}function apply_macro(case_id,evt){if(case_id!==""){if(typeof(ticket_id)==="undefined"){this_id="0"}else{this_id=ticket_id}var ticketForm=jQuery("#ticket-chat");if(jQuery("#tickets_to_bulk_update",ticketForm).length>0){new Zendesk.API.Macro(case_id).applyToTicket(null,ticketForm)}else{new Zendesk.API.Macro(case_id).applyToTicket(this_id,ticketForm)}var e=(evt)?evt:window.event;Event.stop(e);var li=e.findElement();selection_feedback(li);return false}}var hideMacroLi=function(li){Zendesk.UI&&Zendesk.UI.NestedMenu&&Zendesk.UI.NestedMenu.close_submenu($j(li))};function showOrHideBulkForm(){fetchTicketsToBulkupdate();if($j.trim($j("#tickets_to_bulk_update").val())===""){$j("#bulk-update").hide()}else{$j("#bulk-update").show()}}function fetchTicketsToBulkupdate(){var value=_($j("input.tickets_to_bulk_update")).select(function(input){return input.checked}).map(function(input){return $j(input).val()}).join(",");$j("#tickets_to_bulk_update").val(value);return true}function selectAllTicketsForBulkUpdate(elm){var state=elm.checked;if($j("#bulk-update").length){if(state){$j("#bulk-update").show()}else{$j("#bulk-update").hide()}$j("input.tickets_to_bulk_update").each(function(s){$j(this).prop("checked",state)})}}var rgbToHex=function(str){var hexColor="#";str.match(/\d+/g).each(function(val){hexColor+=Number(val).toColorPart()});return hexColor};Ordering={SetOrder:function(table){$j(table).hide();$j(table+"_sort").sortable({axis:"y"}).show()},cancelOrdering:function(listOfItems){var sortableList=$j(listOfItems+"_sort");$j(listOfItems).show();sortableList.hide().sortable("destroy");var sortByOriginalPosition=function(a,b){var attrName="data-zendesk-original-position";return($j(a).attr(attrName)<$j(b).attr(attrName))?-1:($j(a).attr(attrName)>$j(b).attr(attrName))?1:0};var sortedRules=$j("ul li.item.sortable",sortableList).sort(function(a,b){return sortByOriginalPosition(a,b)});$j("ul li.item.sortable",sortableList).remove();$j("ul",sortableList).prepend(sortedRules)}};function textareaResize(){var t=this;var a=t.value.split("\n");var b=1;for(x=0;x<a.length;x++){if(a[x].length>=t.cols){b+=Math.floor(a[x].length/t.cols)}}b+=a.length;if(b>t.rows){t.rows=b}}var textarea_resize=textareaResize;function time_ago_in_words(from){return distance_of_time_in_words(new Date(),new Date(from))}function i18n_time_ago_in_words(from){return i18n_distance_of_time_in_words(new Date(),new Date(from))}function distance_of_time_in_words(to,from){var seconds_ago=((to-from)/1000);var minutes_ago=Math.floor(seconds_ago/60);if(minutes_ago<=0){return"less than a minute"}if(minutes_ago===1){return"a minute"}if(minutes_ago<45){return minutes_ago+" minutes"}if(minutes_ago<90){return"1 hour"}var hours_ago=Math.round(minutes_ago/60);if(minutes_ago<1439){return hours_ago+" hours"}if(minutes_ago<2879){return"1 day"}var days_ago=Math.round(minutes_ago/1440);if(minutes_ago<43199){return days_ago+" days"}if(minutes_ago<86399){return"1 month"}var months_ago=Math.round(minutes_ago/43200);if(minutes_ago<525960){return months_ago+" months"}if(minutes_ago<1051920){return"1 year"}var years_ago=Math.round(minutes_ago/525960);return"over "+years_ago+" years"}var ObjectFactory=Class.create({});ObjectFactory.instances=new Hash();ObjectFactory.create=function(type,args){instance=new type(args);ObjectFactory.instances.set(args.id,instance);return instance};ObjectFactory.get=function(id){return ObjectFactory.instances.get(id)};ObjectFactory.remove=function(id){return ObjectFactory.instances.unset(id)};document.getUrlParameter=function(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+name+"=([^&#]*)");var results=regex.exec(window.location.href);return results?unescape(results[1]):null};function addCommas(nStr){nStr+="";var rgx=/(\d+)(\d{3})/;while(rgx.test(nStr)){nStr=nStr.replace(rgx,"$1,$2")}return nStr}function showSortingForForumType(type_id){setVisibility("#div_ordering",(type_id==1))}$(document).observe("dom:loaded",function(){jQuery("ul.drop-list").each(function(i,elem){new Zendesk.UI.NestedMenu(jQuery(elem)).initialize()});if(!window.XMLHttpRequest){startList()}});function createRef(instance,method){return function(){method.apply(instance,arguments)}}function category_set(element,visibility,z_index,position){var elm=element.down("ul");if(elm){elm.style.display=visibility}}var selection_feedback=function(li){new Effect.Highlight(li,{queue:"end",beforeStart:function(){li.store("selection_feedback.style",li.readAttribute("style"));li.setStyle({color:li.getStyle("background-color")})},startcolor:rgbToHex(li.getStyle("color")),duration:0.2,afterFinish:function(){li.writeAttribute("style",li.retrieve("selection_feedback.style")||"")}});new Effect.Fade(li.up("ul.first-drop"),{queue:"end",duration:0.3,afterFinish:hideMacroLi(li)})};var categoryDescription=function(){if($j("#category-description-link").exists()){$j("#category-description-link").live("click",function(){$j("#category-description").toggle()})}};var categoryTopRightEdit=function(id){var category_top_right=$(id).down(".category-top-right");var edit_options_list=$(id).down("ul.edit_options");var show=function(){category_top_right.removeClassName("inactive");edit_options_list.removeClassName("inactive")};var hide=function(){edit_options_list.addClassName("inactive");category_top_right.addClassName("inactive")};$(id).down("span.edit_this").observe("mouseover",show);$(id).down(".category-top-right").observe("mouseleave",hide);var categorySelectionFeedback=function(li){new Effect.Highlight(li,{queue:"end",beforeStart:function(){li.store("selection_feedback.style",li.readAttribute("style"));li.setStyle({color:li.getStyle("background-color")})},startcolor:rgbToHex(li.getStyle("color")),duration:0.2,afterFinish:function(){li.writeAttribute("style",li.retrieve("selection_feedback.style")||"");hide()}})};edit_options_list.childElements("li").each(function(li){li.childElements("a").each(function(anchor){anchor.observe("click",function(e){categorySelectionFeedback(li)})})})};var makeCategorizedForumsDraggable=function(category_id){var alternateLeftRight=function(elements){elements.each(function(index,element){var isEven=index%2===0;$j(element).toggleClass("left",isEven).toggleClass("right",!isEven)})};var categoryContainer=$j("#"+category_id);categoryContainer.find(".column").each(function(index,forum_element){$j(forum_element).data("position",index)});$j("#"+category_id).parent().find(".category-header .category-top-right ul.edit_options li.reorder_forums a").click(function(){categoryContainer.addClass("reordering").find(".reorder a").show().end().sortable({items:".column"}).bind("sortchange",function(event,ui){alternateLeftRight(categoryContainer.find("div.column").not(ui.item))}).bind("sortupdate",function(event,ui){categoryContainer.data("changed",true);alternateLeftRight(categoryContainer.find(".column"))});return false});categoryContainer.find(".column a").click(function(){if(categoryContainer.hasClass("reordering")){return false}});categoryContainer.find(".reorder a").click(function(){categoryContainer.removeClass("reordering").sortable("destroy");if(categoryContainer.data("changed")){categoryContainer.find(".column").each(function(index,forum){forum=$j(forum);if(forum.data("original_position")!==index){$j.ajax(forum.data("forum_path"),{type:"POST",data:{_method:"put","forum[position]":index,authenticity_token:currentUser.authenticityToken}});forum.data("original_position",index)}});categoryContainer.data("changed",false)}return false})};var addCategoryReordering=function(){var reorderLink=$j(".buttons-right .reorder a");var sortedList=$j("#sortedlist");var container=sortedList.closest(".frame.columns");sortedList.children().each(function(index,list){$j(list).data("original_position",index)});var showReorder=function(){reorderLink.data("reorder_text",reorderLink.html()).html(reorderLink.data("done_text"));container.addClass("reordering");sortedList.sortable({items:".sortable"}).bind("sortupdate",function(){sortedList.data("changed",true)})};var finishReorder=function(){var originalText=reorderLink.data("reorder_text");reorderLink.html(originalText);container.removeClass("reordering");sortedList.sortable("destroy");if(sortedList.data("changed")){sortedList.children().each(function(index,list){list=$j(list);var id=list.data("item_id"),category_header_element=$j("#category_header_"+id),category_element=$j("#category_"+id);container.append(category_header_element).append(category_element);if(index!==list.data("original_position")){$j.ajax(category_element.data("category_path"),{type:"POST",data:{_method:"put","category[position]":index}});list.data("original_position",index)}});sortedList.data("changed",false)}};reorderLink.toggle(showReorder,finishReorder)};var submit_sortable_list=function(display_container,sort_container,sort_list,url){var originalLink=$j("#"+display_container+"_reorder_done_link");var originalDestination=originalLink.prop("href");sort_list=$j("#"+sort_list);sort_list.find("> li.sortable.item").each(function(index,list){$j(list).data("real_element",$j("#"+display_container+" div.item")[index])});$j("#"+display_container+"_reorder_done_link").click(function(event){event.preventDefault();var list=sort_list.find("> li.sortable").get().reverse();_(list).each(function(list_item,index){list_item=$j(list_item);var realElement=$j(list_item.data("real_element"));realElement.prependTo(realElement.parent()).toggleClass("nobottom",index===0);list_item.data("zendesk-original-position",(list.length-index-1))});$j("#"+sort_container).hide();$j("#"+display_container).show();var sortable=sort_list.sortable("serialize",{key:sort_list.prop("id")+"[]"});var authToken="authenticity_token="+encodeURIComponent(Zendesk.currentUser.authenticityToken);$j.ajax(url,{type:"POST",data:sortable+"&"+authToken}).success(function(){window.location.replace(originalDestination)})})};function startList(){if(!navigator.userAgent.match(/msie 6/i)){return}iterate_startList($("green"));if(document.getElementById("gray")){iterate_startList($("gray"))}}function iterate_startList(navRoot){var node;if(!navRoot){return}for(var i=0;i<navRoot.childNodes.length;i++){node=navRoot.childNodes[i];if(node.nodeName=="LI"){node.onmouseover=function(){this.className+=" over";if(this.childNodes[2]&&this.childNodes[2].nodeName=="UL"){ie6_show_iframe_mask(this.childNodes[2])}};node.onmouseout=function(){this.className=this.className.replace(" over","");ie6_hide_iframe_mask(this.childNodes[2])}}}}function ie6_show_iframe_mask(el){if(el){el.style.display="block"}var ieMat=document.createElement("iframe");if(document.location.protocol=="https:"){ieMat.src="//0"}else{if(window.opera!="undefined"){ieMat.src=""}else{ieMat.src="javascript:false"}}ieMat.id="mIframe";ieMat.scrolling="no";ieMat.frameBorder="0";ieMat.style.top=-1;ieMat.style.left=-1;ieMat.style.width=el.offsetWidth+"px";ieMat.style.height=el.offsetHeight+"px";ieMat.style.zIndex=-1;ieMat.style.filter="alpha(opacity=0)";el.insertBefore(ieMat,el.childNodes[0]);ieMat.style.position="absolute"}function ie6_hide_iframe_mask(el){if(el){el.style.display="none"}var iframe=document.getElementById("mIframe");if(iframe){iframe.style.display="none"}}var ticket_id;if(!Zendesk){var Zendesk={}}Zendesk.resources=[];Zendesk.Resource=Class.create();Zendesk.Resource.prototype={initialize:function(options){this.options=options||{};this.options.user=options.user||Zendesk.SettingsCookie.get(this.options.anchor+"_user");this.options.pass=options.pass||Zendesk.SettingsCookie.get(this.options.anchor+"_pass");this.content_anchor=$$("#"+this.options.anchor+" #content")[0];this.title_anchor=$$("#"+this.options.anchor+" #title")[0];Ajax.Responders.register({onException:function(r,e){console.error(e)}});if(this.options.title){this.title_anchor.innerHTML=this.options.title}this.render()},submit_credentials:function(form){this.options.user=form.username.value;this.options.pass=form.password.value;if(this.options.user.blank()&&this.options.pass.blank()){alert("Please provide both a username and a password")}else{Zendesk.SettingsCookie.set(this.options.anchor+"_user",this.options.user);Zendesk.SettingsCookie.set(this.options.anchor+"_pass",this.options.pass);this.render()}},logout:function(){var options=this.options;Zendesk.SettingsCookie.erase(options.anchor+"_user");Zendesk.SettingsCookie.erase(options.anchor+"_pass");this.options.user=this.options.pass=null;this.render()},submit_data:function(form){var control=this;var parameters=Form.serialize(form);parameters+="&domain="+control.options.domain+"&use_ssl="+control.options.use_ssl;if(ticket_id){parameters+="&ticket_id="+ticket_id}if(parameters.indexOf("media_type=")===0){var media_type=control.options.media_type||"application/xml";parameters+="&media_type="+media_type}new Ajax.Request("/proxy.js",{asynchronous:true,evalScripts:true,parameters:parameters,requestHeaders:{Authorization:"Basic "+Base64.encode(control.options.user+":"+control.options.pass)},onSuccess:function(transport){control.resource_write_success(transport,control);enable_submit(form)},onFailure:function(transport){control.resource_failure(transport,control);enable_submit(form)}});disable_submit(form)},render:function(){var control=this;var options=control.options;if(options.login_content!=null&&!(options.user&&options.pass)){control.content_anchor.innerHTML=options.login_content()}else{control.content_anchor.innerHTML=options.application_content();options.application_resources.each(function(resource){control.request(resource)})}},request:function(options){var control=this;if(options.resource==null){if(options.on_success!=null){options.on_success()}}else{var media_type=options.media_type||"application/json";new Ajax.Request("/proxy.js",{method:"get",parameters:{domain:control.options.domain,use_ssl:control.options.use_ssl,resource:options.resource,media_type:media_type,cache_gets:control.options.cache_gets},requestHeaders:{Authorization:"Basic "+Base64.encode(control.options.user+":"+control.options.pass)},onSuccess:function(transport){control.resource_read_success(transport,control,options)},onFailure:function(transport){control.resource_failure(transport,control)}})}},resource_failure:function(transport,control){if(transport.status==401){control.options.user=null;control.options.pass=null;Zendesk.SettingsCookie.erase(control.options.anchor+"_user");Zendesk.SettingsCookie.erase(control.options.anchor+"_pass");if(control.content_anchor.innerHTML!=control.options.login_content()){alert("Username and password are not correct. Please re-enter.")}control.render()}else{alert(transport.responseJSON.error)}},resource_read_success:function(transport,control,options){if(options!=null&&options.on_success!=null){options.on_success(transport.responseJSON)}},resource_write_success:function(transport,control){var requestParams=transport.request&&transport.request.parameters;var audit;if(requestParams&&requestParams.event_reference&&requestParams.event_log&&!requestParams.ticket_id.blank()){var resourceAttributes=control.getLoggableAttributes(control,transport.responseJSON.response,requestParams.event_log);resourceAttributes.location=transport.getHeader("location")||"";audit=control.buildAudit(requestParams,resourceAttributes)}if(audit!=null){new Ajax.Request("/events.json",{contentType:"application/json",postBody:$H(audit).toJSON(),method:"post",asynchronous:true,onSuccess:function(transport){},onFailure:function(transport){alert("Failed to register event: "+transport.responseJSON.error)}})}},buildAudit:function(requestParams,resourceAttributes){return{ticket_id:requestParams.ticket_id,reference:requestParams.event_reference,via_id:14,resource_attributes:resourceAttributes}},getLoggableAttributes:function(control,params,eventLog){var keys=eventLog.split(",");var attributes={};var attribute;_(keys).each(function(key){key=key.strip();if(attribute=control._deepSearch(params,key)){attributes[key]=attribute}});return attributes},_deepSearch:function(object,searchKey){var found;if(found=object[searchKey]||object[searchKey.toLowerCase()]){return found}else{var value;for(key in object){if(object.hasOwnProperty(key)){value=object[key];if(typeof(value)==="object"){if(found=this._deepSearch(value,searchKey)){return found}}}}}}};function enable_submit(form){form.submit.value=form.submit.getAttribute("originalValue");form.enable();form.reset()}function disable_submit(form){form.submit.setAttribute("originalValue",form.submit.value);form.disable();form.submit.value="Submitting..."}var InputTracking={trackedElements:[],enabled:true,trackElement:function(e){if(!InputTracking.trackedElements.include(this)){if(typeof(this.value)==="undefined"){this.originalValue=this.innerHTML}else{this.originalValue=this.value}InputTracking.trackedElements.push(this);Event.stopObserving(this,"keydown",InputTracking.trackElement)}},disable:function(e){InputTracking.enabled=false;return true},fixSubmit:function(element,eventName){var eventHandler=element[eventName];if(Object.isString(eventHandler)){element[eventName]="InputTracking.disable() && "+eventHandler}else{if(Object.isFunction(eventHandler)){element.onsubmitWithoutInputTracking=eventHandler;element[eventName]=function(e){return InputTracking.disable()&&element.onsubmitWithoutInputTracking()}}else{element[eventName]=InputTracking.disable}}}};var CountrySelectField=Class.create({initialize:function(selectElement){this.element=selectElement;this.container=new Element("div",{className:"country_select_field"});this.closedView=new Element("div",{className:"closed"});this.container.insert(this.closedView);this.openedView=new Element("div",{className:"opened",style:"display: none;"}).update("<ul/>");this.container.insert(this.openedView);this.renderOpenedView();this.updateOpenedView();this.updateClosedView();this.element.hide();this.element.insert({after:this.container});this.closedView.observe("click",this.toggle.bind(this))},renderOpenedView:function(){var list=this.openedView.down("ul");list.update();var item;this.element.select("option").each(function(option){item=new Element("li",{country:option.value});this.renderOption(item,option);list.insert(item);item.observe("click",this.clickOption.bindAsEventListener(this))},this)},updateOpenedView:function(){this.openedView.select("li.selected").each(function(item){item.removeClassName("selected")});var selectedOption=this.element.down("option[value="+this.element.getValue()+"]");this.openedView.down("li[country="+selectedOption.value+"]").addClassName("selected")},updateClosedView:function(){var selectedOption=this.element.down("option[value="+this.element.getValue()+"]");this.renderOption(this.closedView,selectedOption)},renderOption:function(element,option){element.update();element.insert(new Element("img",{src:"/images/flags/"+option.value+".gif"}));element.insert(" "+option.innerHTML)},open:function(){this.openedView.show();this.element.focus()},close:function(){this.openedView.hide()},toggle:function(){this.openedView.toggle();this.element.focus()},clickOption:function(e){this.element.down("option[value="+e.findElement("li").getAttribute("country").toLowerCase()+"]").selected=true;this.updateOpenedView();this.updateClosedView();this.close()}});var CheckboxMultiSelect=Class.create({initialize:function(selectElement){this.element=selectElement;this.container=new Element("div",{className:"checkbox_multi_select"});this.render();Element.replace(this.element,this.container)},render:function(){var item;var input;this.element.select("option").each(function(option){input=new Element("input",{type:"checkbox",value:option.value,name:this.element.name,id:this.element.identify()+"_"+option.value});input.checked=option.selected;item=new Element("div");item.insert(input);item.insert(new Element("label",{"for":input.id}).update(option.innerHTML));if(input.id!="account_allowed_translation_locale_ids_1"){var results=input.id.split("_");var url="/i18n/translations/"+results[5];item.insert(new Element("a",{className:"colorbox",href:url}).update("(more info)"))}this.container.insert(item)},this)}});var DelayedRuleCounts=Class.create(Hash,{initialize:function($super,options){$super();this.ticket_show_empty_views=options.ticket_show_empty_views||false;this.delay=5;this.pubsub=options.pubsub||false},requestUpdate:function(ruleIds){var parameters={};_.each($$("span.r_count[data-fresh=false]"),function(elm){parameters["rule_ids["+elm.readAttribute("data-rule-id")+"]"]=elm.readAttribute("data-cache-key")});new Ajax.Request("/rules/count",{parameters:{"rule_ids[]":ruleIds},onSuccess:this.updateUiFromResponse.bind(this)})},updateUiFromJson:function(data){var value=this.get(data.ruleId)||{};value.value=data.value;value.fresh=value.fresh||data.fresh;this.set(data.ruleId,value);this.updateUiForRule(data.ruleId)},updateUiFromResponse:function(response){response.responseJSON.each(this.updateUiFromJson,this);var allFresh=this.values().all(function(data){return data.fresh});if(!allFresh){if(!this.pubsub){this.update(this.delay);this.delay=this.delay*1.5}else{this.subscribe.bind(this).delay(5)}}},updateNow:function(){this.update()},subscribe:function(){var ruleCacheKeys=$$("span.r_count").map(function(elm){return elm.readAttribute("data-cache-key")});if(ruleCacheKeys.length>0){Zendesk.Xmpp.identity=new Zendesk.Xmpp.Identity(this.pubsub);var self=this;Zendesk.Pubsub.Xmpp.JSONWrapper.connect(function(){_.each(ruleCacheKeys,function(channel){Zendesk.Pubsub.Xmpp.JSONWrapper.subscribe(channel,self.updateUiFromJson.bind(self),{includeDelayed:true})})})}},update:function(delay){var ruleIdsThatNeedRefreshing=$$("span.r_count[data-fresh=false]").map(function(elm){return elm.readAttribute("data-rule-id")});ruleIdsThatNeedRefreshing=ruleIdsThatNeedRefreshing.uniq();if(ruleIdsThatNeedRefreshing.length>0){if(delay){this.requestUpdate.bind(this).delay(delay,ruleIdsThatNeedRefreshing)}else{this.requestUpdate(ruleIdsThatNeedRefreshing)}}},updateUiForRule:function(ruleId){var data=this.get(ruleId);var elements=$j("span.r_count[data-rule-id="+ruleId+"]");var self=this;elements.each(function(){var elm=$j(this);elm.html("("+data.value+")");elm.data("fresh",data.fresh);if(data.fresh){if(data.value==="0"){elm.closest("a").addClass("empty");if(!self.ticket_show_empty_views){$(elm.closest("li")[0]).slideUp()}}else{elm.closest("a").removeClass("empty")}}})},updateUi:function(){this.keys().each(this.updateUiForRule,this)}});Event.observe(document,"dom:loaded",function(){$$("textarea").each(function(textarea){Event.observe(textarea,"keydown",InputTracking.trackElement)});$$("form").each(function(form){InputTracking.fixSubmit(form,"onsubmit")});$$("form input[type=button]").each(function(button){InputTracking.fixSubmit(button,"onclick")});$$("select.country_select_field").each(function(selectElement){new CountrySelectField(selectElement)});$$("select.checkbox_multi_select").each(function(selectElement){new CheckboxMultiSelect(selectElement)})});$j(function(){$j("input[placeholder], textarea[placeholder]").placeholder()});window.onbeforeunload=function(){if(InputTracking.enabled){for(var i=0;i<InputTracking.trackedElements.length;i++){var new_value;if(typeof(InputTracking.trackedElements[i].value)==="undefined"){new_value=InputTracking.trackedElements[i].innerHTML}else{new_value=InputTracking.trackedElements[i].value}if(new_value!==InputTracking.trackedElements[i].originalValue&&InputTracking.trackedElements[i].id!=="comment_value"){return"You have entered some text on this page. If you choose to proceed you will lose your changes."}}}};document.observe("dom:loaded",function(){if(window.fluid){document.body.insert("<div id='notifications' style='display:none'></div>");new Ajax.PeriodicalUpdater("notifications","/notifications/status",{asynchronous:false,method:"get",frequency:120,decay:10,requestHeaders:{Accept:"application/json"},onSuccess:function(transport){var json=transport.responseText.evalJSON();if(json.count!=null&&json.count>0){window.fluid.dockBadge=json.count}if(json.message!=null){window.fluid.showGrowlNotification({title:"Zendesk update",description:json.message.toString(),priority:1,sticky:false,identifier:"Zendesk "+Math.random()*10000})}}})}});Autocompleter.lookupUser=function(multi_user,searchTerm,callback){var url=multi_user?"/people/users/multivalue_autocomplete":"/people/users/autocomplete";var parameters={name:searchTerm,rand:(new Date()).getTime()};new Ajax.Request(url,{parameters:parameters,onSuccess:function(response){callback(response.responseJSON)}})};Autocompleter.UserCache=new Autocompleter.Cache(Autocompleter.lookupUser.curry(false));Autocompleter.cachedLookupUser=Autocompleter.UserCache.lookup.bind(Autocompleter.UserCache);Autocompleter.MultiUserCache=new Autocompleter.Cache(Autocompleter.lookupUser.curry(true));Autocompleter.cachedLookupMultiUser=Autocompleter.MultiUserCache.lookup.bind(Autocompleter.MultiUserCache);Autocompleter.lookupTag=function(searchTerm,callback){new Ajax.Request("/tags/autocomplete.json",{parameters:{name:searchTerm,rand:(new Date()).getTime()},onSuccess:function(response){callback(response.responseJSON)}})};Autocompleter.TagCache=new Autocompleter.Cache(Autocompleter.lookupTag);Autocompleter.cachedLookupTag=Autocompleter.TagCache.lookup.bind(Autocompleter.TagCache);Autocompleter.lookupAccount=function(searchTerm,callback){new Ajax.Request("/monitor/children/lookup",{parameters:{query:searchTerm,rand:(new Date()).getTime()},onSuccess:function(response){callback(response.responseJSON)}})};Autocompleter.AccountCache=new Autocompleter.Cache(Autocompleter.lookupAccount,{choices:50});Autocompleter.cachedLookupAccount=Autocompleter.AccountCache.lookup.bind(Autocompleter.AccountCache);Autocompleter.lookupOrganization=function(searchTerm,callback){new Ajax.Request("/organizations/autocomplete",{parameters:{name:searchTerm,rand:(new Date()).getTime()},onSuccess:function(response){callback(response.responseJSON)}})};Autocompleter.OrganizationCache=new Autocompleter.Cache(Autocompleter.lookupOrganization);Autocompleter.cachedLookupOrganization=Autocompleter.OrganizationCache.lookup.bind(Autocompleter.OrganizationCache);var ZdCreditCard={submitCreditCardForm:function(){$("credit-card-error").hide();if(ZdCreditCard.validate()){ZdCreditCard.serializeExpiry();$j("#transparent-redirect").submit();$("submit-credit-card").disabled=true;$("submit-credit-card").value=I18n.t("txt.admin.javascript.zd_creditcard")}else{$("credit-card-error").show()}return false},validate:function(){var country=$F("country");var state=$F("state");var zip=$F("zip");if(zip.blank()||country.blank()||zip.blank()){return false}if(country=="prompt"){return false}if(country=="US"){if(state=="prompt"){return false}}return true},resetCreditCardForm:function(){var submitCreditCard=$("submit-credit-card");var submitCreditCardInTrial=$$("input#submit-credit-card.trial")[0];var termsAgree=$("terms_agree");submitCreditCard.disabled=false;if(submitCreditCardInTrial){submitCreditCardInTrial.value=I18n.t("txt.public.javascript.zd_creditcard.purchase_my_subscription");submitCreditCard.disabled=true;termsAgree.observe("click",function(event){if(termsAgree.checked===true){submitCreditCard.disabled=false}else{if(termsAgree.checked===false){submitCreditCard.disabled=true}}})}else{submitCreditCard.value=I18n.t("txt.admin.views.account.credit_card._form.submit_credit_card_button_label")}},showCvvHelper:function(){$j.colorbox({href:"/account/subscription/cvv"})},serializeExpiry:function(){var month=$F("expiry_month");var year=$F("expiry_year");$("ccexp").value=month+""+year},preloadImages:function(){image=new Image();image.src="/images/find-the-cvv.png"},toggleStateSelect:function(){if($("country").value=="US"){$("state-select-row").show();$("state").disabled=false}else{$("state-select-row").hide();$("state").disabled=true}}};var ZendeskSearchCursor=Class.create({initialize:function(options){this.pages=new Object();this.pages.length=options.pageCount+1;this.currentPageIndex=options.pageIndex}});var ZendeskSearcher=Class.create({initialize:function(options){self.latestQuery=null;this.options=options;if(typeof(this.options.per_page)=="undefined"){this.options.per_page=3}},executeSearch:function(query,page){this.latestQuery=query;new Ajax.Request("/suggestions/search.json",{requestHeaders:{Accept:"application/json"},method:"get",parameters:{query:query,per_page:this.options.per_page,page:page},onSuccess:function(transport){var searchResult=transport.responseText.evalJSON();this.results=searchResult.results;this.results.each(function(result){result.titleNoFormatting=result.title;result.content=result.body;result.url="/entries/"+result.id});this.cursor=new ZendeskSearchCursor({pageCount:searchResult.pages,pageIndex:searchResult.page});this.callbackMethod()}.bind(this),onFailure:function(){$("topic_suggestions").update(new Element("h2").update(this.options.noResults));$("topic_suggestions").removeClassName("loading")}.bind(this)})},execute:function(query){return this.executeSearch(query,1)},gotoPage:function(page){if(this.latestQuery){return this.executeSearch(this.latestQuery,page)}else{return false}},setSearchCompleteCallback:function(callbackScope,callbackMethod,args){this.callbackScope=callbackScope;this.callbackMethod=callbackMethod.bind(callbackScope)}});var HomePageSearch=Class.create({initialize:function(options){this.options=options;var moreLink=new Element("a").update(this.options.more);this.more=new Element("li",{id:"more_suggestions"}).update(moreLink);this.showMore=options.showMore},searchComplete:function(){$("suggestion_submit").enable();$("topic_suggestions").removeClassName("loading");Try.these(this.more.remove);if(!this.searcher.cursor||this.searcher.cursor.currentPageIndex==0){$("topic_suggestions").update("")}if(this.searcher.results&&this.searcher.results.length>0){var list=$("suggestions");if(!list){list=new Element("ul",{id:"suggestions"});$("topic_suggestions").insert(list)}this.searcher.results.each(function(result){var title=result.titleNoFormatting.gsub(/.* :: /,"");var link=new Element("a",{href:result.url}).update(title);var item=new Element("li",{className:"suggestion"});item.insert(new Element("h3").update(link));item.insert(new Element("div").update(result.content.stripTags().truncate(160)));this.insert(item)},list);if(this.searcher.cursor&&this.searcher.cursor.currentPageIndex<this.searcher.cursor.pages.length-1){list.insert(this.more)}}else{if(this.options.emptyResultRedirect){window.location=this.options.emptyResultRedirect+escape($F("suggestions_query"));return false}else{$("topic_suggestions").insert(new Element("h2").update(this.options.noResults))}}},onSubmit:function(){$("suggestion_submit").disable();$("topic_suggestions").update();$("topic_suggestions").addClassName("loading");this.searcher.execute($F("suggestions_query"));return false},onShowMore:function(){this.more.remove();$("topic_suggestions").addClassName("loading");this.searcher.gotoPage(this.searcher.cursor.currentPageIndex+1);return false},setup:function(){this.searcher=new ZendeskSearcher(this.options);this.searcher.setSearchCompleteCallback(this,this.searchComplete,null);$("suggest_form").onsubmit=this.onSubmit.bind(this);if(this.options.moreLink){this.more.observe("click",function(){window.location=this.options.moreLink+escape($F("suggestions_query"))}.bind(this))}else{this.more.observe("click",this.onShowMore.bind(this))}}});Zendesk.NS("Tickets.Table",this.jQuery,function($){var self=this;var viewingStatuses={};function keyFor($tr){return $tr.attr("data-zd-account-id")+","+$tr.attr("data-zd-ticket-nice-id")}function hideTRTooltipOnShowMainTooltip(table){table.find("td.description").hover(function(){$(this).closest("tr[title]").each(function(i,tr){$(tr).attr("data-title",$(tr).attr("title")).removeAttr("title")})},function(){$(this).closest("tr[data-title]").each(function(i,tr){$(tr).attr("title",$(tr).attr("data-title")).removeAttr("data-title")})})}function applyViewStatusToTRs(table){table.find("tbody tr[data-zd-ticket-nice-id][data-zd-account-id]").each(function(){var $tr=$(this);var key=keyFor($tr);var message=viewingStatuses[key];if(message){$tr.find("td:first-child").addClass("beingViewed");$tr.attr("title",message)}})}this.getAndApplyViewingStatuses=function(ticket_ids){$.ajax({url:"/api/v1/tickets/viewing_statuses.json",type:"GET",data:{ticket_ids:ticket_ids},success:function(data,textStatus,httpRequest){viewingStatuses={};data.each(function(status){var key=""+currentAccount.id+","+status.ticket_nice_id;if(status.others_viewing.length==1){viewingStatuses[key]=status.others_viewing[0]+" is viewing this ticket."}else{if(status.others_viewing.length>1){viewingStatuses[key]=""+status.others_viewing.length+" agents are viewing this ticket."}}});var table=$("table.tickets");applyViewStatusToTRs(table);hideTRTooltipOnShowMainTooltip(table)}})};this.linkifyRows=function(table){table.find("tbody tr").each(function(){var ticketHref=$(this).attr("data-href");if(!ticketHref||!ticketHref.length){return}$(this).click(function(event){if(!event){return}if($(event.target).attr("href")===ticketHref){return}if(event.ctrlKey||event.metaKey){window.open(ticketHref,"_blank").blur();window.focus()}else{window.location.href=ticketHref}})})};this.applyViewStatusToTooltip=function($trOrChild){$trOrChild=$($trOrChild);var tooltipID=$trOrChild.attr("aria-describedby");if(!tooltipID){return}var $tooltip=$("#"+tooltipID);if($tooltip.length===0){return}if($tooltip.find(".otherViewers").length>0){return}var $tr=$trOrChild.closest("tr[data-zd-account-id][data-zd-ticket-nice-id]");if($tr.length===0){return}var key=keyFor($tr);var message=viewingStatuses[key];if(!message){return}$tooltip.find(".title").prepend('<span class="otherViewers">'+message+"</span>")}});Prototype.Browser.Mac=navigator.userAgent.toLowerCase().indexOf("mac")!=-1;var Widget=Class.create({initialize:function(args){this.id=args.id;this.locationId=args.locationId;this.isEmpty=args.isEmpty;this.sendInvitationMail=args.sendInvitationMail;if(Prototype.Browser.Mac){if(this._closeButton()){this._closeButton().addClassName("mac_widget_close_button")}}if(this.isEmpty){this.containingElement().hide()}},containingElement:function(){return $("widget_"+this.id)},show:function(){this.containingElement().blindDown({duration:0.2})},hide:function(afterFinishFunction){this.containingElement().blindUp({duration:0.2,afterFinish:afterFinishFunction})},destroy:function(){this.containingElement().remove()},_closeButton:function(){return this.containingElement().down(".widget_close_button")},_editButton:function(){return this.containingElement().down(".widget_edit_button")},showControls:function(){if(this.isEmpty){this.containingElement().show()}this._closeButton().appear({duration:0.3});if(this._editButton()){this._editButton().appear({duration:0.3})}this.containingElement().addClassName("widget_edit_mode")},hideControls:function(){this._closeButton().fade({duration:0.2});if(this._editButton()){this._editButton().fade({duration:0.3})}this.containingElement().removeClassName("widget_edit_mode");if(this.isEmpty){this.containingElement().hide()}}});Object.extend(Widget,{asyncInsertion:function(responseJSON){var fixedWidget=$("widget_fixed");responseJSON&&responseJSON.each&&responseJSON.each(function(json_widget){if(json_widget.location<0&&fixedWidget){fixedWidget.insert({before:json_widget.inner_html})}else{$("sidebar").insert({bottom:json_widget.inner_html})}});Widget.redraw();Widget.fireLoadEvents.delay(0.1)},redraw:function(){var addWidgetSelectWidget=$("add_widget_select_widget");if(Widget.hasVisibleWidgets()||(addWidgetSelectWidget&&addWidgetSelectWidget.visible())){$("container").removeClassName("full_width")}else{$("container").addClassName("full_width")}},hasVisibleWidgets:function(){return $$("#sidebar .draggable").any(function(w){return w.visible()})},pendingWidgets:new Array(),registeredWidgets:new Array(),register:function(widgetClass,options){Widget.pendingWidgets.push([widgetClass,options||{}])},activateWidgets:function(){var classAndOptions;while(classAndOptions=Widget.pendingWidgets.shift()){Widget.registeredWidgets.push(ObjectFactory.create(classAndOptions[0],classAndOptions[1]))}}});Widget.ScriptLoadingQueue=Class.create({initialize:function($super){this.QUEUED=10;this.LOADING=20;this.LOADED=30;this.queue=new Array();this.running=false},setExternalScriptState:function(src,state){var entry=this.queue.find(function(e){return e.src==src});if(entry.state<state){switch(state){case this.LOADING:entry.loadingStartTime=new Date().getTime();break;case this.LOADED:entry.loadingEndTime=new Date().getTime();break}entry.state=state}},loading:function(){return this.queue.find(function(e){return e.state==this.LOADING},this)},isDone:function(){return this.queue.all(function(e){return e.state==this.LOADED},this)},next:function(){return this.queue.find(function(e){return e.state==this.QUEUED},this)},push:function(theSrc,theOptions){if(!this.include(theSrc)){this.queue.push({src:theSrc,state:this.QUEUED,options:theOptions||{},loadingStartTime:null,loadingEndTime:null})}},include:function(src){return this.queue.any(function(e){return e.src==src})},loadScripts:function(callback){if(this.isDone()){this.running=false;if(callback){callback()}}else{this.running=true;if(this.loading()){}else{var nextScript=this.next();this.setExternalScriptState(nextScript.src,this.LOADING);var attribs=$H({type:"text/javascript",charset:"utf-8"}).merge(nextScript.options);var script=new Element("script");script.src=nextScript.src;attribs.each(function(pair){script.setAttribute(pair.key,pair.value)});var head=document.getElementsByTagName("head")[0];if(!head){head=document.body.parentNode.appendChild(new Element("head"))}script.onload=this.setExternalScriptState.curry(nextScript.src,this.LOADED).bind(this);script.onreadystatechange=function(){if(this.readyState=="loaded"||this.readyState=="complete"){this.onload()}}.bind(script);head.appendChild(script)}this.loadScripts.bind(this).delay(0.1,callback)}}});Widget.scriptLoadingQueue=new Widget.ScriptLoadingQueue();Object.extend(Widget,{require:Widget.scriptLoadingQueue.push.bind(Widget.scriptLoadingQueue),require_old:function(src,options){var attribs=$H({type:"text/javascript",charset:"utf-8"}).merge(options);var script=new Element("script");script.src=src;attribs.each(function(pair){script.setAttribute(pair.key,pair.value)});var head=document.getElementsByTagName("head")[0];if(!head){head=document.body.parentNode.appendChild(new Element("head"))}head.appendChild(script)},fireLoadEvents:function(){Widget.activateWidgets();Widget.scriptLoadingQueue.loadScripts(document.fire.curry("widgets:load").bind(document))}});var ReportWidget=Class.create(Widget,{initialize:function($super,args){$super(args);this.output=args.output;this.graphs=args.graphs;this.pointer=0},displayGraph:function(){if($(this.output)==null){return}this.pointer=this.pointer%this.graphs.length;$(this.output).src=this.graphs[this.pointer]},next:function(){this.pointer=this.pointer+1;this.displayGraph()},start:function(){this.displayGraph()}});var TextWidget=Class.create(Widget,{initialize:function($super,args){$super(args);this.output=args.output;this.texts=args.texts;this.delay=args.delay;this.pointer=0;this.callout=null},displayText:function(position,target){if($(target)==null){return}if(position<0){position=this.texts.length-1}else{position=position%this.texts.length}this.pointer=position;$(target).hide();$(target).update(this.texts[position]);$(target).appear({duration:1.5});if(this.texts.length>1){this.callout=this.displayText.bind(this).delay(this.delay,position+1,target)}},next:function(){window.clearTimeout(this.callout);this.displayText(this.pointer+1,this.output)},prev:function(){window.clearTimeout(this.callout);this.displayText(this.pointer-1,this.output)},start:function(){if(this.texts.length>0){this.displayText(this.pointer,this.output)}}});var TopPerformersWidget=Class.create(Widget,{initialize:function($super,args){$super(args);var topPerformerLists=$$(".top_performers_list");var showToggles=topPerformerLists.length>1;$$(".top_performers_list .toggle").each(function(e){if(showToggles){e.show()}else{e.hide()}e.observe("click",function(){topPerformerLists.each(function(element){element.toggle();if(element.visible()){Zendesk.SettingsCookie.set("top-performers-widget-current",element.id)}})})});var storedView=Zendesk.SettingsCookie.get("top-performers-widget-current");var currentViewElement=null;if(storedView){currentViewElement=$$("#"+storedView+".top_performers_list")[0]}else{currentViewElement=topPerformerLists[0]}currentViewElement.show();Zendesk.SettingsCookie.set("top-performers-widget-current",currentViewElement.id)}});var CustomWidget=Class.create(Widget,{});var BuddhaMachineWidget=Class.create(Widget,{});var CampfireWidget=Class.create(Widget,{});var OrganizationWidget=Class.create(Widget,{});var EmbedWidget=Class.create(Widget,{});var RelatedEntriesWidget=Class.create(Widget,{});var MoreLikeThisWidget=Class.create(Widget,{});var TopForumEntriesWidget=Class.create(Widget,{});var UserSentimentWidget=Class.create(Widget,{});var TicketSentimentWidget=Class.create(Widget,{});var ViewsWidget=Class.create(Widget,{initialize:function($super,args){$super(args);if(typeof(ruleCounts)!="undefined"){ruleCounts.updateUi()}}});var GetSatisfactionWidget=Class.create(Widget,{});var IfbyphoneWidget=Class.create(Widget,{});var SamanageWidget=Class.create(Widget,{});var ConstantContactWidget=Class.create(Widget,{});var ForumsWidget=Class.create(Widget,{initialize:function($super,args){$super(args);var selectedForum=document.getUrlParameter("forum_id");if(selectedForum){setSelectedForSelect($("forum_id"),selectedForum)}var query=document.getUrlParameter("query");if(query&&($("query").value=="")){$("query").value=query}}});var HarvestWidget=Class.create(Widget,{});var SalesforceHelper=Class.create();SalesforceHelper.SOAP_LOGIN=new Template('<?xml version="1.0" encoding="UTF-8"?><SOAP-ENV:Envelope     xmlns:xsd="http://www.w3.org/2001/XMLSchema"     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"     xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/"     SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"     xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">      <SOAP-ENV:Body>        <login xmlns="urn:enterprise.soap.sforce.com">          <username xsi:type="xsd:string">#{username}</username>          <password xsi:type="xsd:string">#{password}</password>        </login>      </SOAP-ENV:Body></SOAP-ENV:Envelope>');SalesforceHelper.SOAP_QUERY=new Template('<?xml version="1.0" encoding="utf-8"?>   <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"    xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Header>    <SessionHeader xmlns="urn:enterprise.soap.sforce.com">      <sessionId>#{session}</sessionId>    </SessionHeader>  </soap:Header>  <soap:Body>    <query xmlns="urn:enterprise.soap.sforce.com">      <queryString>#{query}</queryString>    </query>  </soap:Body></soap:Envelope>');SalesforceHelper.SELECT=new Template("SELECT department, email, fax, firstname, homephone, lastname, mailingcity,        mailingcountry, mailingpostalcode, mailingstreet, mobilephone, name,        othercity, othercountry, otherphone, otherpostalcode, otherstate,        otherstreet, phone, salutation, title FROM contact WHERE email LIKE '%#{search}%' OR name LIKE '%#{search}%'");SalesforceHelper.LOGIN_URL="/proxy/direct.xml?url=https://www.salesforce.com/services/Soap/c/13.0&timeout=12&body=";SalesforceHelper.QUERY_URL=new Template("/proxy/direct.xml?url=#{serverUrl}&body=#{xml}");SalesforceHelper.SESSION_MATCH=new RegExp("/.*<sessionId>(.*)</sessionId>.*/");SalesforceHelper.SERVER_MATCH=new RegExp("/.*<serverUrl>(.*)</serverUrl>.*/");SalesforceHelper.authorizationUrl=function(username,password){return this.LOGIN_URL+escape(this.SOAP_LOGIN.evaluate({username:username,password:password}))};SalesforceHelper.getNodeValue=function(document,nodeName){if(Prototype.Browser.WebKit){nodeName=nodeName.replace("sf:","")}var node=document.getElementsByTagName(nodeName);if(node==null||node.length==0){return null}return node[0].childNodes[0].nodeValue};SalesforceHelper.getNodeString=function(document,nodeName){var value=this.getNodeValue(document,nodeName);if(value==null){return""}else{return value}};SalesforceHelper.getErrorCode=function(document){return this.getNodeValue(document,"faultcode")};SalesforceHelper.getRecords=function(document){var results=document.getElementsByTagName("records");if(results==null){return new Array()}return results};SalesforceHelper.renderLine=function(record,elements,template){var output="";for(var i=0;i<elements.length;i++){output+=this.getNodeString(record,elements[i]);if(output!=""){output+=" "}}if(output!=""){return template.evaluate({output:output})}else{return""}};SalesforceHelper.renderRecord=function(record){var result="";result+=this.renderLine(record,["sf:Salutation","sf:FirstName","sf:LastName"],new Template("<h5 style='font-size: 16px;'>#{output}</h5>"));result+=this.renderLine(record,["sf:Title"],new Template("<p class='minimum'>#{output}</p>"));result+=this.renderLine(record,["sf:Department"],new Template("<p class='minimum'>#{output}</p>"));var phones="";phones+=this.renderLine(record,["sf:Phone"],new Template("<p class='minimum'>#{output}</p>"));phones+=this.renderLine(record,["sf:MobilePhone"],new Template("<p class='minimum'>#{output}<span class='sub'>mobile</span></p>"));if(phones!=""){result+="<h5>Phone</h5>";result+=phones}result+=this.renderLine(record,["sf:Email"],new Template("<p class='minimum'><a href='mailto:#{output}'>#{output}</a></p>"));var address=this.renderLine(record,["sf:MailingStreet"],new Template("#{output}")).replace(",","<br />");if(address!=""){subaddress=this.renderLine(record,["sf:MailingPostalCode","sf:MailingCity"],new Template("#{output} "));if(subaddress!=""){address+="<br /> "+subaddress}address+=this.renderLine(record,["sf:MailingCountry"],new Template("<br />#{output}"))}result+=address;return result};SalesforceHelper.buildQueryUrl=function(sessionId,serverUrl,input){var query=this.SELECT.evaluate({search:input});var xml=this.SOAP_QUERY.evaluate({query:query,session:sessionId});var url=this.QUERY_URL.evaluate({serverUrl:serverUrl,xml:escape(xml)});return url};var SalesforceWidget=Class.create(Widget,{initialize:function($super,args){$super(args);this.username=args.username;this.password=args.password;this.destination=args.destination;this.formInstance=null},disableForm:function(){this.formInstance.button.value="Looking...";this.formInstance.button.disabled=true},enableForm:function(){this.formInstance.button.value="Lookup user";this.formInstance.button.disabled=false},lookup:function(submittedForm){this.formInstance=submittedForm;this.disableForm();var url=SalesforceHelper.authorizationUrl(this.username,this.password);new Ajax.Request(url,{method:"post",requestHeaders:{Accept:"application/xml",SOAPAction:"login"},onSuccess:function(transport){this.executeAuthorizedQuery(transport.responseXML)}.bind(this),onFailure:function(){alert("Salesforce login failed. Try again in a short moment.");this.enableForm()}.bind(this)})},executeAuthorizedQuery:function(responseXML){var sessionId=SalesforceHelper.getNodeValue(responseXML,"sessionId");var serverUrl=SalesforceHelper.getNodeValue(responseXML,"serverUrl");if(sessionId!=null&&serverUrl!=null){var url=SalesforceHelper.buildQueryUrl(sessionId,serverUrl,this.formInstance.email.value);new Ajax.Request(url,{method:"post",requestHeaders:{Accept:"application/xml",SOAPAction:"query"},onSuccess:function(transport){this.displayResult(transport.responseXML)}.bind(this),onFailure:function(){alert("Salesforce query failed.");this.enableForm()}.bind(this)})}else{var errorCode=SalesforceHelper.getNodeValue(responseXML,"faultcode");if(errorCode=="sf:LOGIN_MUST_USE_SECURITY_TOKEN"){alert("Salesforce login failed - Salesforce network access needs configuration.")}else{if(errorCode=="sf:API_DISABLED_FOR_ORG"){alert("Salesforce login failed - Your Salesforce edition does not support API access.")}else{alert("Salesforce login failed. Failed to find server or session. Code: "+errorCode)}}this.enableForm()}},displayResult:function(responseXML){var records=SalesforceHelper.getRecords(responseXML);if(records.length==0){alert("No match found in Salesforce.");this.enableForm();return}var output="";for(var i=0;i<records.length;i++){output+=SalesforceHelper.renderRecord(records[i])}output+="<br />";$(this.destination).update(output);this.enableForm()}});var JiraHelper={GET_SESSION:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="#{url}rpc/soap/jirasoapservice-v2" xmlns:types="#{url}rpc/soap/jirasoapservice-v2/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">    <q1:login xmlns:q1="http://soap.rpc.jira.atlassian.com">      <in0 xsi:type="xsd:string">#{username}</in0>      <in1 xsi:type="xsd:string"><![CDATA[#{password}]]></in1>    </q1:login>  </soap:Body></soap:Envelope>'),GET_PROJECTS:new Template('<?xml version="1.0" encoding="UTF-8"?><SOAP-ENV:Envelope xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">  <SOAP-ENV:Body>    <m:getProjectsNoSchemes xmlns:m="#{url}rpc/soap/jirasoapservice-v2">      <in0 xsi:type="xsd:string">#{sessionId}</in0>    </m:getProjectsNoSchemes>  </SOAP-ENV:Body></SOAP-ENV:Envelope>'),GET_ASSIGNEES:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="#{url}rpc/soap/agilossoapservice-v1" xmlns:types="#{url}rpc/soap/agilossoapservice-v1/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">    <q1:getAssignableUsers xmlns:q1="#{url}">      <in0 xsi:type="xsd:string">#{sessionId}</in0>      <in1 xsi:type="xsd:string">#{projectKey}</in1>    </q1:getAssignableUsers>  </soap:Body></soap:Envelope>'),GET_ISSUE_TYPES2:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="#{url}rpc/soap/jirasoapservice-v2" xmlns:types="#{url}rpc/soap/jirasoapservice-v2/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">  <q1:getIssueTypesForProject xmlns:q1="http://soap.rpc.jira.atlassian.com">   <in0 xsi:type="xsd:string">#{sessionId}</in0>   <in1 xsi:type="xsd:string">#{projectId}</in1>  </q1:getIssueTypesForProject></soap:Body></soap:Envelope>'),GET_ISSUE_TYPES:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="#{url}rpc/soap/jirasoapservice-v2" xmlns:types="#{url}rpc/soap/jirasoapservice-v2/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"><q1:getIssueTypesForProject xmlns:q1="http://soap.rpc.jira.atlassian.com"><in0 xsi:type="xsd:string">#{sessionId}</in0><in1 xsi:type="xsd:string">#{projectId}</in1></q1:getIssueTypesForProject></soap:Body></soap:Envelope>'),SUBMIT_ISSUE:new Template('<?xml version="1.0" encoding="ISO-8859-1"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="#{url}rpc/soap/jirasoapservice-v2" xmlns:types="#{url}rpc/soap/jirasoapservice-v2/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">    <q1:createIssue xmlns:q1="http://soap.rpc.jira.atlassian.com">      <in0 xsi:type="xsd:string">#{sessionId}</in0>      <in1 href="#id1" />    </q1:createIssue>    <q2:RemoteIssue id="id1" xsi:type="q2:RemoteIssue" xmlns:q2="http://beans.soap.rpc.jira.atlassian.com">      <id xsi:nil="true" />      <affectsVersions xsi:nil="true" />      <assignee xsi:type="xsd:string">#{assignee}</assignee>      <attachmentNames xsi:nil="true" />      <components xsi:nil="true" />      <created xsi:nil="true" />      <customFieldValues xsi:nil="true" />      <description>#{description}</description>      <duedate xsi:nil="true" />      <environment xsi:nil="true" />      <fixVersions xsi:nil="true" />      <key xsi:nil="true" />      <priority xsi:nil="true" />      <project xsi:type="xsd:string">#{projectKey}</project>      <reporter xsi:nil="true" />      <resolution xsi:nil="true" />      <status xsi:nil="true" />      <summary xsi:type="xsd:string">#{summary}</summary>      <type xsi:type="xsd:string">#{type}</type>      <updated xsi:nil="true" />      <votes xsi:nil="true" />      <customFieldValues href="#id2" />    </q2:RemoteIssue>    <soapenc:Array id="id2" xmlns:q3="http://beans.soap.rpc.jira.atlassian.com" soapenc:arrayType="q3:RemoteCustomFieldValue[1]">      <Item href="#id3" />    </soapenc:Array>    <q4:RemoteCustomFieldValue id="id3" xsi:type="q4:RemoteCustomFieldValue" xmlns:q4="http://beans.soap.rpc.jira.atlassian.com">      <customfieldId xsi:type="xsd:string">customfield_#{customFieldId}</customfieldId>      <key xsi:nil="true" />      <values href="#id4" />    </q4:RemoteCustomFieldValue>    <soapenc:Array id="id4" soapenc:arrayType="xsd:string[1]">      <Item>#{ticketId}</Item>    </soapenc:Array>  </soap:Body></soap:Envelope>'),SUBMIT_FORM:new Template('<form class="form" id="jira-form-#{widgetId}"> Submit this ticket as a new issue <label>Project</label><select name="projectId" id="jiraProjectSelector" class="jiraProjectSelector" onchange="ObjectFactory.get(#{widgetId}).projectsSelector(this.options[this.selectedIndex].value)"></select> <label>Type</label><select name="typeId" id="jiraTypeSelector" class="jiraTypeSelector"></select> <label>Assignee ID</label><select name="jiraAssigneeSelector" class="jiraAssigneeSelector" id="jiraAssigneeSelector"></select> <label></label><input type="button" value="Submit" id="submit" class="jiraSubmit" onclick="ObjectFactory.get(#{widgetId}).submitIssue($(\'jiraForm-#{widgetId}\'));return false;"></form>'),JIRA_TAG:new Template("<ticket><additional-tags>jira</additional-tags></ticket>"),JIRA_ISSUE_EXTERNAL_LINK:new Template("<external-link><type>JiraIssue</type><issue-id>#{issueId}</issue-id></external-link>"),NOTICE:new Template('This ticket is related to the following issue in JIRA:<br /><br /><b><a href="#{url}/browse/#{issueId}" target=_blank>#{issueId}</a></b><br />&nbsp;'),MISSING_TICKET:new Template("Only available when viewing tickets.<br />&nbsp;"),getSessionRequest:function(username,password,url){return escape(this.GET_SESSION.evaluate({username:username,password:password,url:url}))},getProjectsRequest:function(sessionId,url){return escape(this.GET_PROJECTS.evaluate({sessionId:sessionId,url:url}))},getProjectsAssigneeRequest:function(sessionId,url,projectKey){return escape(this.GET_ASSIGNEES.evaluate({sessionId:sessionId,url:url,projectKey:projectKey}))},getProjectsIssueTypesRequest:function(sessionId,url,projectId){return escape(this.GET_ISSUE_TYPES.evaluate({sessionId:sessionId,url:url,projectId:projectId}))},getSubmitRequest:function(sessionId,url,assignee,type,projectKey,summary,description,ticketId,customFieldId){return escape(this.SUBMIT_ISSUE.evaluate({sessionId:sessionId,url:url,assignee:assignee,projectKey:projectKey,type:type,summary:XmlHelper.encodeString(summary),description:XmlHelper.encodeString(description),ticketId:ticketId,customFieldId:customFieldId}))},getSubmitForm:function(widgetId){return(this.SUBMIT_FORM.evaluate({widgetId:widgetId}))},getInJiraNotice:function(url,issueId){return(this.NOTICE.evaluate({url:url,issueId:issueId}))},getMissingTicketMessage:function(){return(this.MISSING_TICKET.evaluate({}))},setIssueIdRequest:function(issueId){return this.JIRA_ISSUE_EXTERNAL_LINK.evaluate({issueId:issueId})},setJiraTagRequest:function(){return this.JIRA_TAG.evaluate()},PROXY_URL1:new Template("/proxy/direct?log=1&url=#{url}rpc/soap/jirasoapservice-v2&json=1"),PROXY_URL2:new Template("/proxy/direct?log=1&url=#{url}rpc/soap/agilossoapservice-v1?"),getProxyUrl:function(url,body){return escape(this.PROXY_URL1.evaluate({url:url,body:body}))},getProxyUrl2:function(url,body){return escape(this.PROXY_URL2.evaluate({url:url,body:body}))},getSessionUrl:function(username,password,url){doc=JiraHelper.getSessionRequest(username,password,url);url=JiraHelper.getProxyUrl(url,doc);return url},getNodeValue:function(document,nodeName){if(Prototype.Browser.WebKit){nodeName=nodeName.replace("sf:","")}node=document.getElementsByTagName(nodeName);if(node==null||node.length==0){return null}return node[0].childNodes[0].nodeValue},getNodeString:function(document,nodeName){value=this.getNodeValue(document,nodeName);if(value==null){return""}else{return value}},getRecords:function(document,ns,tagName){results=document.getElementsByTagName(tagName);if(results.length==0){results=document.getElementsByTagName(ns+":"+tagName)}if(results==null){return new Array()}return results},populateProjects:function(contentRoot,responseXML){var keys=[];var projects=[];if($("jiraProjectSelector").options.length==0){var multiRefs=$A(XmlHelper.getRecords(responseXML,"","multiRef"));multiRefs.each(function(multiRef){projects.push(new JiraProject(multiRef))});projects.sort(function(a,b){return a.name.toLowerCase()<b.name.toLowerCase()?-1:1});projectSelector=contentRoot.down("select.jiraProjectSelector");projectSelector.appendChild(new Element("option"));projects.each(function(project){var option=new Element("option");option.value=project.key;option.innerHTML=project.name;projectSelector.appendChild(option);keys[project.key]=project.id})}return keys},populateProjectIssueTypes:function(contentRoot,responseXML){var types=[];var multiRefs=$A(XmlHelper.getRecords(responseXML,"","multiRef"));multiRefs.each(function(multiRef){types.push(new JiraType(multiRef))});types.sort(function(a,b){return a.name.toLowerCase()<b.name.toLowerCase()?-1:1});typeSelector=contentRoot.down("select.jiraTypeSelector");typeSelector.update("");typeSelector.appendChild(new Element("option"));types.each(function(type){var option=new Element("option");option.value=type.id;option.innerHTML=type.name;typeSelector.appendChild(option)})},populateAssignees:function(contentRoot,responseXML){var asignees=[];var multiRefs=$A(XmlHelper.getRecords(responseXML,"","multiRef"));multiRefs.each(function(multiRef){asignees.push(new JiraAsignee(multiRef))});asignees.sort(function(a,b){return a.name.toLowerCase()<b.name.toLowerCase()?-1:1});asigneeSelector=contentRoot.down("select.jiraAssigneeSelector");asigneeSelector.update("");asigneeSelector.appendChild(new Element("option"));asignees.each(function(asignee){var option=new Element("option");option.value=asignee.name;option.innerHTML=asignee.fullName;asigneeSelector.appendChild(option)})}};var XmlHelper={getTextContentByKey:function(document,key){if(Prototype.Browser.IE){return document.getElementsByTagName(key)[0].childNodes[0].nodeValue}return document.getElementsByTagName(key)[0].textContent},encodeString:function(st){var result=st;result=result.replace(/&/g,"&amp;");result=result.replace(/</g,"&lt;");result=result.replace(/>/g,"&gt;");result=result.replace(/'/g,"&apos;");result=result.replace(/"/g,"&quot;");return result},getRecords:function(document,ns,tagName){results=document.getElementsByTagName(tagName);if(results.length==0){results=document.getElementsByTagName(ns+":"+tagName)}if(results==null){return new Array()}return results}};var JiraProject=Class.create({initialize:function(xml){this.key=XmlHelper.getTextContentByKey(xml,"key");this.id=XmlHelper.getTextContentByKey(xml,"id");this.name=XmlHelper.encodeString(XmlHelper.getTextContentByKey(xml,"name"))}});var JiraType=Class.create({initialize:function(xml){this.id=XmlHelper.getTextContentByKey(xml,"id");this.name=XmlHelper.encodeString(XmlHelper.getTextContentByKey(xml,"name"))}});var JiraAsignee=Class.create({initialize:function(xml){this.name=XmlHelper.encodeString(XmlHelper.getTextContentByKey(xml,"name"));this.fullName=XmlHelper.encodeString(XmlHelper.getTextContentByKey(xml,"fullname"))}});var JiraWidget=Class.create(Widget,{initialize:function($super,args){$super(args);this.url=args.url;this.username=args.username;this.password=args.password;this.formInstance=null;this.ticketId=args.ticketId;this.issueId=null;this.externalId=args.externalId;this.customFieldId=args.customFieldId;this.widgetId=args.id;this.subject=args.subject;this.description=args.description;this.projectIds=null;this.contentRoot=this.containingElement().down("div.jiraContent"+this.widgetId);if(!this.url.endsWith("/")){this.url+="/"}this.start()},start:function(){if(this.ticketId){var self=this;$j.ajax({type:"get",url:"/tickets/"+this.ticketId+"/external_links.json",success:function(data){var issue;if(issue=_(data).find(function(x){return x.external_link_type==="JiraIssue"})){self.issueId=issue.external_link["issue_id"]||this.externalId;self.contentRoot.update(JiraHelper.getInJiraNotice(self.url,self.issueId))}else{self.contentRoot.update(JiraHelper.getSubmitForm(self.id));self.proxyUrl=JiraHelper.PROXY_URL1.evaluate({url:self.url});self.proxyUrl2=JiraHelper.PROXY_URL2.evaluate({url:self.url});self.getSession()}}})}else{this.contentRoot.update(JiraHelper.getMissingTicketMessage())}},getSession:function(){var doc="body="+JiraHelper.getSessionRequest(this.username,this.password,this.url);new Ajax.Request(this.proxyUrl,{method:"post",postBody:doc,requestHeaders:{Accept:"application/xml",SOAPAction:"login"},onSuccess:function(transport){this.extractSessionID(transport.responseXML)}.bind(this),onFailure:function(){alert("Failed")}.bind(this)})},extractSessionID:function(responseXML){var arr=JiraHelper.getRecords(responseXML,"ns1","loginResponse");if(arr.length==1){this.sessionId=JiraHelper.getNodeString(arr[0],"loginReturn");this.getProjects()}else{alert("Login failed")}},getProjects:function(){var doc="body="+JiraHelper.getProjectsRequest(this.sessionId,this.url);new Ajax.Request(this.proxyUrl,{method:"post",postBody:doc,requestHeaders:{Accept:"application/xml",SOAPAction:"login"},onSuccess:function(transport){this.projectIds=JiraHelper.populateProjects(this.contentRoot,transport.responseXML)}.bind(this),onFailure:function(){alert("Failed to get projects")}.bind(this)})},projectsSelector:function(projectkey){var doc="body="+JiraHelper.getProjectsAssigneeRequest(this.sessionId,this.url,projectkey);new Ajax.Request(this.proxyUrl2,{method:"post",postBody:doc,requestHeaders:{Accept:"application/xml",SOAPAction:"0"},onSuccess:function(transport){JiraHelper.populateAssignees(this.contentRoot,transport.responseXML)}.bind(this),onFailure:function(){alert("Failed to get projects")}.bind(this)});doc="body="+JiraHelper.getProjectsIssueTypesRequest(this.sessionId,this.url,this.projectIds[projectkey]);new Ajax.Request(this.proxyUrl,{method:"post",postBody:doc,requestHeaders:{Accept:"application/xml",SOAPAction:"login"},onSuccess:function(transport){JiraHelper.populateProjectIssueTypes(this.contentRoot,transport.responseXML)}.bind(this),onFailure:function(){alert("Failed to get projects")}.bind(this)})},submitIssue:function(form){var url="/tickets/"+this.ticketId+".xml";new Ajax.Request(url,{method:"get",requestHeaders:{Accept:"application/xml"},onSuccess:function(transport){var subject=XmlHelper.getTextContentByKey(transport.responseXML,"subject");this.submitIssue2(subject,this.description)}.bind(this),onFailure:function(){alert("Failed to submit issue.")}.bind(this)});return false},submitIssue2:function(subject,description){var summary=subject;if(summary==""){summary="Ticket #"+this.ticketId}var doc="body="+JiraHelper.getSubmitRequest(this.sessionId,this.url,this.contentRoot.down("select.jiraAssigneeSelector").getValue(),this.contentRoot.down("select.jiraTypeSelector").getValue(),this.contentRoot.down("select.jiraProjectSelector").getValue(),summary,description,this.ticketId,this.customFieldId);new Ajax.Request(this.proxyUrl,{method:"post",postBody:doc,requestHeaders:{Accept:"application/xml",SOAPAction:"login"},onSuccess:function(transport){this.setIssueId(transport.responseXML);this.setJiraTag();this.addTag("jira")}.bind(this),onFailure:function(){alert("Failed to submit issue.")}.bind(this)});return false},addTag:function(tag){if(typeof(ticketTagField)!="undefined"){ticketTagField.addEntry("jira","jira")}},setIssueId:function(responseXML){var issues=JiraHelper.getRecords(responseXML,"","multiRef");if(issues.length>0){var key=XmlHelper.getTextContentByKey(issues[0],"key");var doc=JiraHelper.setIssueIdRequest(key);var url="/tickets/"+this.ticketId+"/external_links.xml?";new Ajax.Request(url,{contentType:"application/xml",method:"post",encoding:"",postBody:doc,onSuccess:function(transport){this.contentRoot.update(JiraHelper.getInJiraNotice(this.url,key))}.bind(this),onFailure:function(){alert("Failed to set JIRA issue ID.")}})}else{var faultString=XmlHelper.getTextContentByKey(responseXML,"faultstring");alert("Failed to retrieve JIRA issue key.\n\n("+faultString+")")}},setJiraTag:function(responseXML){$j.ajax({url:"/tickets/"+this.ticketId+".xml",type:"post",data:{_method:"put",ticket:{additional_tags:"jira"}},error:function(){alert("Failed to set JIRA tag.")}})}});var TactileHelper={PROXY_URL:new Template("/proxy/direct?log=1&url=#{url}"),QUERYSTRING_PEOPLE:new Template("people/?api_token=#{apiToken}&email=#{email}"),QUERYSTRING_CONTACTMETHODS:new Template("people/contact_methods/?api_token=#{apiToken}&id=#{id}"),QUERYSTRING_PERSON:new Template("people/view/?api_token=#{apiToken}&id=#{id}"),getQueryURL:function(url){return TactileHelper.PROXY_URL.evaluate({url:url})},getPeopleQueryString:function(apiToken,email){return TactileHelper.QUERYSTRING_PEOPLE.evaluate({apiToken:apiToken,email:email})},getContactMethodsQueryString:function(apiToken,id){return TactileHelper.QUERYSTRING_CONTACTMETHODS.evaluate({apiToken:apiToken,id:id})},getPersonQueryString:function(apiToken,id){return TactileHelper.QUERYSTRING_PERSON.evaluate({apiToken:apiToken,id:id})},renderLine:function(values,template){var output="";for(var i=0;i<values.length;i++){if(values[i]>""){if(output!=""){output+=" "}output+=values[i]}}return output>""?template.evaluate({output:output}):""},renderRecord:function(record,contact){var output="";var companyInfo="";var address="";var template=new Template("#{output}<br />");output+=this.renderLine([record.title,record.name],new Template("<h5 style='font-size: 16px;'>#{output}</h5>"));companyInfo+=this.renderLine([record.jobtitle],template);companyInfo+=this.renderLine([record.organisation],template);output+=this.renderLine([companyInfo],new Template('<p class="minimum">#{output}</p>'));address+=this.renderLine([record.street1],template);address+=this.renderLine([record.street2],template);address+=this.renderLine([record.street3],template);address+=this.renderLine([record.town],template);address+=this.renderLine([record.county],template);address+=this.renderLine([record.postcode],template);address+=this.renderLine([record.country],template);output+=this.renderLine([address],new Template('<p class="minimum">#{output}</p>'));output+=this.renderContactMethods(contact,"T","Telephone");output+=this.renderContactMethods(contact,"M","Mobile");output+=this.renderContactMethods(contact,"E","Email");output+=this.renderLine([record.description],new Template("<h5>Description</h5>#{output}<br />"));return output+"<br />"},renderContactMethods:function(contact,type,label){var output="";var template=new Template('#{value} <span class="sub">#{name}</span><br />');for(var i=0;i<contact.contact_methods.length;i++){var method=contact.contact_methods[i];if(method.type==type){output+=template.evaluate({value:method.contact,name:method.name})}}return output>""?"<h5>"+label+"</h5>"+output:""},renderList:function(people,id){var result="";result="<h5>"+people.length+" matching people found in TactileCRM. Click on a person for more information</h5>";result+=people.collect(function(p){return('<span class="link" onclick="ObjectFactory.get('+id+").lookupPerson("+p.id+')">'+p.name+"</span>")}.bind(this)).join("<br/>")+"<br />&nbsp;";return result}};var TactileWidget=Class.create(Widget,{initialize:function($super,args){$super(args);this.widgetId=args.id;this.url=args.url;this.apiToken=args.apiToken;this.formInstance=null;this.contentRoot=this.containingElement().down("div.tactileContent"+this.widgetId);if(!this.url.endsWith("/")){this.url+="/"}},lookup:function(submittedForm){var email=submittedForm.down("input.email").value;var url=TactileHelper.getQueryURL(this.url)+escape(TactileHelper.getPeopleQueryString(this.apiToken,email));new Ajax.Request(url,{method:"get",encoding:"",onSuccess:function(transport){this.showList(transport.responseText.evalJSON())}.bind(this),onFailure:function(){alert("Failed to lookup.")}.bind(this)});return false},showList:function(result){if(result.status=="error"){alert("Error: Unable to login to TactileCRM");return false}if(result.people.length==0){alert("No match found in TactileCRM")}else{if(result.people.length>1){this.contentRoot.update(TactileHelper.renderList(result.people,this.id))}else{this.lookupPerson(result.people[0].id)}}},lookupPerson:function(id){var url=TactileHelper.getQueryURL(this.url)+escape(TactileHelper.getPersonQueryString(this.apiToken,id));new Ajax.Request(url,{method:"get",encoding:"",onSuccess:function(transport){this.result1=transport.responseText.evalJSON();this.lookupContactMethods(id)}.bind(this),onFailure:function(){alert("Failed to lookup.")}.bind(this)})},lookupContactMethods:function(id){var url=TactileHelper.getQueryURL(this.url)+escape(TactileHelper.getContactMethodsQueryString(this.apiToken,id));new Ajax.Request(url,{method:"get",encoding:"",onSuccess:function(transport){this.result2=transport.responseText.evalJSON();this.show()}.bind(this),onFailure:function(){alert("Failed to lookup.")}.bind(this)})},show:function(){var output=TactileHelper.renderRecord(this.result1.person,this.result2);this.contentRoot.update(output)}});var PagloHelper={SEARCH_FORM:new Template('<div class="asset"></div><div class="software"></div><form class="form" id="paglo-form-#{widgetId}"> <label>Search</label><input type="text" name="token" id="token" value="#{name}"/  > <br/><input type="submit" id="submit" value="Search" onclick="ObjectFactory.get(#{widgetId}).doSearch($(\'paglo-form-#{widgetId}\').token.value);return false;"></form>'),getSearchForm:function(widgetId,name){return PagloHelper.SEARCH_FORM.evaluate({widgetId:widgetId,name:name})},QUERY:new Template("select nvl(system/dns_name, first(interface/inet/ip_address)) as name, first(interface/inet/ip_address) as ip_address from /network/device where system/dns_name like '%#{token}%' or interface/inet/ip_address = '#{token}%' or wmi/win32_computersystem/username = '#{token}' or wmi/win32_computersystem/username like '%#{token2}' order by 1 limit 10"),getQuery:function(token){return PagloHelper.QUERY.evaluate({token:token,token2:"\\"+token})},SOFTWARE_QUERY:new Template("select Name, Version from /network/device[system/dns_name = '#{name}']/wmi/win32_product order by 1,2"),getSoftwareQuery:function(name){return PagloHelper.SOFTWARE_QUERY.evaluate({name:name})},URL:new Template("/proxy/direct?url=https://api.gotomanage.com/api&contenttype=application/x-www-form-urlencoded&body=#{body}"),getURL:function(body){return PagloHelper.URL.evaluate({body:escape(body)})},doc:new Template("method=paglo.query&v=1.0&api_key=#{apiKey}&query=#{query}"),getDoc:function(apiKey,query){return PagloHelper.doc.evaluate({apiKey:apiKey,query:query})},ITEM:new Template('<span class="link" onClick="ObjectFactory.get(#{widgetId}).#{functionName}(\'#{name}\')">#{name}</span><br />'),renderItem:function(name,functionName,widgetId){return PagloHelper.ITEM.evaluate({name:name,functionName:functionName,widgetId:widgetId})},LIST_TEMPLATE:new Template("<b>#{title}</b><br /><br />#{content}"),getList:function(title,content){return PagloHelper.LIST_TEMPLATE.evaluate({title:title,content:content})},SOFTWARE_SELECTION:new Template('<b>Select software package:</b><br /><select id="paglo_software" class="software" onChange="ObjectFactory.get(#{widgetId}).selectSoftware(this.options[this.selectedIndex].value)"></select>'),getSoftwareSelection:function(widgetId){return PagloHelper.SOFTWARE_SELECTION.evaluate({widgetId:widgetId})},ASSET:new Template("select system/dns_name, interface/inet/ip_address, nvl(system_profile/spsoftwaredatatype/os_version, os/version, wmi/win32_operatingsystem/caption || ' ' || wmi/win32_operatingsystem/csdversion) as os, nvl(system/class, system/computed_class) as class, nvl(system/vendor, wmi/win32_computersystemproduct/vendor, system/computed_vendor) as vendor, nvl(system/model, wmi/win32_computersystemproduct/name, system/computed_model) as model, nvl(wmi/win32_computersystem/username, system_profile/spsoftwaredatatype/user_name) as username from /network/device where system/(dns_name = '#{name}')"),getAssetQuery:function(name){return PagloHelper.ASSET.evaluate({name:name})},ASSET_INFO_SECTION:new Template("<b>#{title}:</b><br /> #{value}<br /><br />"),getAssetInfoSection:function(title,value){return(value!=""?PagloHelper.ASSET_INFO_SECTION.evaluate({title:title,value:value}):"")},ASSET_HEADER:new Template('<a href="https://app.paglo.com/app/inventory/lookup?key=system/dns_name&value=#{name}" target="_blank"><img src="/images/widgets/paglo/asset.png" />&nbsp;&nbsp;<b>#{name}</b></a> <br /><br />'),getAssetHeader:function(name){return PagloHelper.ASSET_HEADER.evaluate({name:name})},getAssetInfo:function(records,name){var output="";var reg=new RegExp("\\S");for(var i=0;i<records.length;i++){if(records[i].attributes.length>0&&records[i].childNodes.length>0){if(records[i].getAttribute("name")==name&&records[i].firstChild.nodeValue.match(reg)){output+=(output!=""?"<br />":"")+records[i].firstChild.nodeValue}}}return output},renderAssetInfo:function(xml){var output="";var records=XmlHelper.getRecords(xml,"","value");output+=PagloHelper.getAssetHeader(PagloHelper.getAssetInfo(records,"system/dns_name"));output+=PagloHelper.getAssetInfoSection("Class",PagloHelper.getAssetInfo(records,"class"));output+=PagloHelper.getAssetInfoSection("Vendor",PagloHelper.getAssetInfo(records,"vendor"));output+=PagloHelper.getAssetInfoSection("Model",PagloHelper.getAssetInfo(records,"model"));output+=PagloHelper.getAssetInfoSection("Operating system",PagloHelper.getAssetInfo(records,"os"));output+=PagloHelper.getAssetInfoSection("Username",PagloHelper.getAssetInfo(records,"username"));output+=PagloHelper.getAssetInfoSection("Network",PagloHelper.getAssetInfo(records,"interface/inet/ip_address"));return output}};var PagloWidget=Class.create(Widget,{initialize:function($super,args){$super(args);this.apiKey=args.apikey;this.formInstance=null;this.widgetId=args.id;this.isEmpty=args.isEmpty;this.hardwareFieldId=args.hardwareFieldId;this.softwareFieldId=args.softwareFieldId;this.externalId=args.externalId;this.email=args.email;this.contentRoot=this.containingElement().down("div.paglo-content");this.startup()},startup:function(){if(!($("ticket_fields_"+this.hardwareFieldId)&&$("ticket_fields_"+this.softwareFieldId))){this.contentRoot.update("Not a ticket, or missing custom fields.");return}this.contentRoot.update(PagloHelper.getSearchForm(this.widgetId,""));var name=$("ticket_fields_"+this.hardwareFieldId).value;if(name){this.getAsset(name)}else{name=(name?name:this.externalId);if(!name&&this.email){var reg=/(\S*)@\S*/;var arr=reg.exec(this.email);if(arr.length>1){name=arr[1]}}if(name){this.doSearch(name)}}this.contentRoot.down("form").token.value=name},doSearch:function(token){var query=PagloHelper.getQuery(token);var doc=PagloHelper.getDoc(this.apiKey,query);var url=PagloHelper.getURL(doc);this.contentRoot.down("div.asset").update("Searching...");this.contentRoot.down("div.software").update("");new Ajax.Request(url,{method:"post",requestHeaders:{Accept:"application/xml"},onSuccess:function(transport){this.showResults(transport.responseXML)}.bind(this),onFailure:function(){alert("Failed")}})},showResults:function(xml){var output="";var records=XmlHelper.getRecords(xml,"","tree");if(records.length>0){for(var i=0;i<records.length;i++){var arr=new Array();var values=XmlHelper.getRecords(records[i],"","value");for(var u=0;u<values.length;u++){arr[values[u].getAttribute("name")]=values[u].firstChild.nodeValue}if(arr.name){output+=PagloHelper.renderItem(arr.name,"selectAsset",this.widgetId)}}this.contentRoot.down("div.asset").update(PagloHelper.getList("Select hardware asset:",output));this.contentRoot.down("div.software").update("")}else{this.contentRoot.down("div.asset").update("Nothing found")}},selectAsset:function(name){if(name!=""){$("ticket_fields_"+this.hardwareFieldId).value=name;$("ticket_fields_"+this.softwareFieldId).value="";this.getAsset(name);this.getSoftware(name)}},getSoftware:function(name){var query=PagloHelper.getSoftwareQuery(name);var doc=PagloHelper.getDoc(this.apiKey,query);var url=PagloHelper.getURL(doc);new Ajax.Request(url,{method:"post",requestHeaders:{Accept:"application/xml"},onSuccess:function(transport){this.showSoftware(transport.responseXML)}.bind(this),onFailure:function(){alert("Failed")}})},showSoftware:function(xml){var output="";var ddlSoftware;var records=XmlHelper.getRecords(xml,"","tree");if(records.length>0){this.contentRoot.down("div.software").update(PagloHelper.getSoftwareSelection(this.widgetId));ddlSoftware=this.contentRoot.down("select.software");ddlSoftware.appendChild(new Element("option"));for(var i=0;i<records.length;i++){var values=XmlHelper.getRecords(records[i],"","value");for(var u=0;u<values.length;u++){if(values[u].getAttribute("name")=="Name"){var option=new Element("option");option.value=values[u].firstChild.nodeValue;option.innerHTML=option.value;ddlSoftware.appendChild(option)}}}}else{this.contentRoot.down("div.software").update("")}},selectSoftware:function(name){$("ticket_fields_"+this.softwareFieldId).value=name},getAsset:function(name){var query=PagloHelper.getAssetQuery(name);var doc=PagloHelper.getDoc(this.apiKey,query);var url=PagloHelper.getURL(doc);this.contentRoot.down("div.asset").update("Retrieving info...");new Ajax.Request(url,{method:"post",requestHeaders:{Accept:"application/xml"},onSuccess:function(transport){this.contentRoot.down("div.asset").update(PagloHelper.renderAssetInfo(transport.responseXML))}.bind(this),onFailure:function(){alert("Failed")}})}});var ContactologyHelper={GET_ACTIVE_LISTS:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="http://soapserver.emailcampaigns.net/1.1/" xmlns:types="http://soapserver.emailcampaigns.net/1.1/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">    <tns:GetActiveLists>      <sortDir xsi:type="xsd:string">U</sortDir>      <sortID xsi:type="xsd:string">Name</sortID>      <startRecord xsi:type="xsd:int">0</startRecord>      <pageSize xsi:type="xsd:int">0</pageSize>    </tns:GetActiveLists>  </soap:Body></soap:Envelope>'),GET_CONTACT_SUBSCRIPTIONS:new Template('<?xml version="1.0" encoding="utf-8"?>  <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="http://soapserver.emailcampaigns.net/1.1/" xmlns:types="http://soapserver.emailcampaigns.net/1.1/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">    <soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">      <tns:GetContactSubscriptions>        <email xsi:type="xsd:string">#{email}</email>      </tns:GetContactSubscriptions>    </soap:Body></soap:Envelope>'),SUBSCRIBE_TO_LIST:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="http://soapserver.emailcampaigns.net/1.1/" xmlns:types="http://soapserver.emailcampaigns.net/1.1/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">    <tns:SubscribeToList>      <email xsi:type="xsd:string">#{email}</email>      <listId xsi:type="xsd:int">#{id}</listId>    </tns:SubscribeToList>  </soap:Body></soap:Envelope>'),UNSUBSCRIBE_FROM_LIST:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="http://soapserver.emailcampaigns.net/1.1/" xmlns:types="http://soapserver.emailcampaigns.net/1.1/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">    <tns:UnsubscribeFromList>      <email xsi:type="xsd:string">#{email}</email>      <listId xsi:type="xsd:int">#{id}</listId>    </tns:UnsubscribeFromList>  </soap:Body></soap:Envelope>'),GET_CONTACT:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="http://soapserver.emailcampaigns.net/1.1/" xmlns:types="http://soapserver.emailcampaigns.net/1.1/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">    <tns:GetContactByEmail>      <emailAddress xsi:type="xsd:string">#{email}</emailAddress>    </tns:GetContactByEmail>  </soap:Body></soap:Envelope>'),REACTIVATE:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="http://soapserver.emailcampaigns.net/1.1/" xmlns:types="http://soapserver.emailcampaigns.net/1.1/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">    <tns:UpdateContact>      <addressId xsi:type="xsd:int">#{id}</addressId>      <emailAddress xsi:type="xsd:string" />      <status xsi:type="xsd:int">0</status>    </tns:UpdateContact>  </soap:Body></soap:Envelope>'),PROXY_URL:new Template("/proxy/direct?log=1&url=http://soapserver.emailcampaigns.net/1.1/index.php"),SOAP_ACTION:new Template("http://soapserver.emailcampaigns.net/1.1/index.php/#{action}"),getActiveListsRequest:function(){return ContactologyHelper.GET_ACTIVE_LISTS.evaluate({})},getContactSubscriptionsRequest:function(email){return ContactologyHelper.GET_CONTACT_SUBSCRIPTIONS.evaluate({email:email})},getSubscribeToListRequest:function(email,id){return ContactologyHelper.SUBSCRIBE_TO_LIST.evaluate({email:email,id:id})},getGetContactRequest:function(email){return ContactologyHelper.GET_CONTACT.evaluate({email:email})},getReactivateRequest:function(id){return ContactologyHelper.REACTIVATE.evaluate({id:id})},getUnsubscribeFromListRequest:function(email,id){return ContactologyHelper.UNSUBSCRIBE_FROM_LIST.evaluate({email:email,id:id})},getProxyURL:function(){return this.PROXY_URL.evaluate()},getSOAPAction:function(action){return this.SOAP_ACTION.evaluate({action:action})},STATUS_SECTION:new Template('<b>Status:</b><div class="contact_status">#{status}</div><br />'),LIST_SECTION:new Template("<b>#{header}</b><br />#{items}<br />"),LIST_ELEMENT:new Template('<input type="checkbox" style="vertical-align: top;" value="#{id}" #{checked} #{disabled} onClick="ObjectFactory.get(#{widgetId}).changeSubscription(this);"> #{name} <span class="sub">#{status}</span><br />'),REACTIVATE_LINK:new Template('<a href="javascript:ObjectFactory.get(#{widgetId}).reactivate();">Click to reactivate</a><br/><br/>'),renderView:function(responseXML,newSubscriber,widgetId){var output="";var active=true;var addressSubscriptions=XmlHelper.getRecords(responseXML,"","item");if(newSubscriber){status_code="NEW"}else{var status_code=ContactologyHelper.getStatus(responseXML);active=(status_code=="GLOBALY_UNSUBSCRIBED"||status_code=="GLOBALLY_UNSUBSCRIBED"||status_code=="BOUNCED"||status_code=="DELETED")?false:true}output+=ContactologyHelper.renderStatus(status_code,newSubscriber);if(status_code=="BOUNCED"){output+=ContactologyHelper.REACTIVATE_LINK.evaluate({widgetId:widgetId})}output+=ContactologyHelper.renderListsByType(addressSubscriptions,"INTERNAL","Internal",newSubscriber,widgetId,active);output+=ContactologyHelper.renderListsByType(addressSubscriptions,"PUBLIC","Public",newSubscriber,widgetId,active);output+=ContactologyHelper.renderListsByType(addressSubscriptions,"PRIVATE","Private",newSubscriber,widgetId,active);return output},renderListsByType:function(addressSubscriptions,typeName,typeLabel,newSubscriber,widgetId,enabled){var output="";for(var i=0;i<addressSubscriptions.length;i++){if(XmlHelper.getTextContentByKey(addressSubscriptions[i],newSubscriber?"type_label":"type").toUpperCase()==typeName){var name=XmlHelper.getTextContentByKey(addressSubscriptions[i],newSubscriber?"list_name":"name");var id=XmlHelper.getTextContentByKey(addressSubscriptions[i],newSubscriber?"list_id":"id");var status=newSubscriber?"NONE":XmlHelper.getTextContentByKey(addressSubscriptions[i],"subscription_status");var checked="";var substatus="";if(status=="SUBSCRIBED"||status=="AWAITING_CONFIRMATION"){checked="checked"}if(status=="AWAITING_CONFIRMATION"){substatus="pending"}output+=ContactologyHelper.LIST_ELEMENT.evaluate({name:name,id:id,checked:checked,widgetId:widgetId,status:substatus,disabled:(enabled?"":"DISABLED")})}}if(output>""){return ContactologyHelper.LIST_SECTION.evaluate({header:typeLabel,items:output})}else{return""}},renderStatus:function(status,newSubscriber){if(newSubscriber){return ContactologyHelper.STATUS_SECTION.evaluate({status:"NEW"})}return ContactologyHelper.STATUS_SECTION.evaluate({status:status})},getStatus:function(responseXML){var element=responseXML.getElementsByTagName("return")[0];var status=XmlHelper.getTextContentByKey(element,"contact_status");return status},errorFree:function(xml){var element=xml.getElementsByTagName("faultstring");return(element.length>0?false:true)}};var ContactologyWidget=Class.create(Widget,{initialize:function($super,args){$super(args);this.widgetId=args.id;this.username=args.username;this.password=args.password;this.email=args.email;this.formInstance=null;this.contentRoot=this.containingElement().down("div.contactology-content"+this.widgetId);this.lastChange=null;this.contactId=null;this.startup()},startup:function(){if(this.email==null){this.contentRoot.update("No requester found")}else{this.getSubscriptions()}},getSubscriptions:function(change){var doc="body="+ContactologyHelper.getContactSubscriptionsRequest(this.email);var url=ContactologyHelper.getProxyURL();new Ajax.Request(url,{method:"post",encoding:"",postBody:doc,requestHeaders:{SOAPAction:ContactologyHelper.getSOAPAction("GetContactSubscriptions"),Authorization:"Basic "+Base64.encode(this.username+":"+this.password)},onSuccess:function(transport){if(XmlHelper.getRecords(transport.responseXML,"SOAP-ENV","Fault").length>0){this.getActiveLists()}else{if(change==this.lastChange){this.contentRoot.update(ContactologyHelper.renderView(transport.responseXML,false,this.widgetId))}}}.bind(this),onFailure:function(){alert("Failed to lookup.")}.bind(this)})},getActiveLists:function(){var doc="body="+ContactologyHelper.getActiveListsRequest();var url=ContactologyHelper.getProxyURL();new Ajax.Request(url,{method:"post",encoding:"",postBody:doc,requestHeaders:{SOAPAction:ContactologyHelper.getSOAPAction("GetActiveLists"),Authorization:"Basic "+Base64.encode(this.username+":"+this.password)},onSuccess:function(transport){this.contentRoot.update(ContactologyHelper.renderView(transport.responseXML,true,this.widgetId))}.bind(this),onFailure:function(){alert("Failed to lookup.")}.bind(this)})},changeSubscription:function(item){var doc="";var action="";var checked=item.checked;item.disabled=true;this.lastChange=item.value;if(checked){doc="body="+ContactologyHelper.SUBSCRIBE_TO_LIST.evaluate({email:this.email,id:item.value});action="SubscribeToList"}else{doc="body="+ContactologyHelper.UNSUBSCRIBE_FROM_LIST.evaluate({email:this.email,id:item.value});action="UnsubscribeFromList"}var url=ContactologyHelper.getProxyURL();this.showStatus("UPDATING...");new Ajax.Request(url,{method:"post",encoding:"",postBody:doc,requestHeaders:{SOAPAction:ContactologyHelper.getSOAPAction(action),Authorization:"Basic "+Base64.encode(this.username+":"+this.password)},onSuccess:function(transport){if(ContactologyHelper.errorFree(transport.responseXML)){if(XmlHelper.getTextContentByKey(transport.responseXML,"return")!=1){}if(this.lastChange==item.value){this.getSubscriptions(item.value)}}else{this.changeFailed(item,checked);return}}.bind(this),onFailure:function(){alert("Failure!");this.changeFailed(item,checked)}.bind(this)})},reactivate:function(){var doc="body="+ContactologyHelper.getGetContactRequest(this.email);this.showStatus("UPDATING...");new Ajax.Request(ContactologyHelper.getProxyURL(),{method:"post",encoding:"",postBody:doc,requestHeaders:{SOAPAction:ContactologyHelper.getSOAPAction("GetContactByEmail"),Authorization:"Basic "+Base64.encode(this.username+":"+this.password)},onSuccess:function(transport){var element=transport.responseXML.getElementsByTagName("return")[0];var id=XmlHelper.getTextContentByKey(element,"ID");var doc2="body="+ContactologyHelper.getReactivateRequest(id);new Ajax.Request(ContactologyHelper.getProxyURL(),{method:"post",encoding:"",postBody:doc2,requestHeaders:{SOAPAction:ContactologyHelper.getSOAPAction("UpdateContact"),Authorization:"Basic "+Base64.encode(this.username+":"+this.password)},onSuccess:function(transport){this.lastChange=null;this.getSubscriptions(null)}.bind(this),onFailure:function(){this.refreshStatus();alert("Failed to reactivate")}.bind(this)})}.bind(this),onFailure:function(){this.showStatus("UNKNOWN");alert("Failed to reactivate")}.bind(this)})},showStatus:function(status){this.containingElement().down("div.contact_status").update(status)},refreshStatus:function(){var doc="body="+ContactologyHelper.getGetContactRequest(this.email);new Ajax.Request(ContactologyHelper.getProxyURL(),{method:"post",encoding:"",postBody:doc,requestHeaders:{SOAPAction:ContactologyHelper.getSOAPAction("GetContactByEmail"),Authorization:"Basic "+Base64.encode(this.username+":"+this.password)},onSuccess:function(transport){var element=transport.responseXML.getElementsByTagName("return")[0];var status=XmlHelper.getTextContentByKey(element,"StatusLabel");this.showStatus(status.toUpperCase())}.bind(this),onFailure:function(){this.showStatus("ERROR")}.bind(this)})},changeFailed:function(item,checked){alert("Failed to change subscription.");item.checked=!checked;item.disabled=false;this.refreshStatus()}});var ScreenStepsLiveWidget=Class.create(Widget,{initialize:function($super,args){$super(args);this.widgetId=args.id;this.anchor=args.anchor;this.domainname=args.domainname;this.username=args.username;this.password=args.password;this.use_ssl=args.use_ssl;this.space_id=args.space_id;this.ticket_id=args.ticket_id;this.include_login_in_url=args.include_login_in_url;this.screenstepslive_resource=new Zendesk.Resource({anchor:this.anchor,domain:this.domainname||"",user:this.username||"",pass:this.password||"",use_ssl:this.use_ssl||"false",space_id:this.space_id||null,include_login_in_url:this.include_login_in_url||false,enable_resource_cache:"false",show_logout:false,login_content:this.application.bind(this),application_content:this.application.bind(this),application_resources:[{resource:"spaces",media_type:"application/xml",on_success:this.spaces_selector.bind(this)}]})},application:function(){text='<form id="lookup-form" onsubmit="disable_submit($(\'lookup-form\')); ObjectFactory.get('+this.id+').lookup(); return false;">';if(this.space_id==""||this.space_id==null){text+='<label style="width:50px;display:block;">Space: </label><select style="margin-bottom:5px;width:175px;" name="request[space_id]" id="screenstepslive-form-spaces"></select><br />'}else{text+='<input type="hidden" name="request[space_id]" id="screenstepslive-form-spaces" value="'+this.space_id+'">'}text+='<label style="width:50px;display:block;">Search: </label><input type="text" style="margin:5px 5px 5px 0;width:175px;" name="request[text]" id="sslive_search_text"/><br /><input type="submit" value="Submit" id="submit">';text+='</form><div id="screensteps_live_results"></div>';return text},lookup:function(){text=$F("sslive_search_text");space_id=$F("screenstepslive-form-spaces");space_selected_index=$("screenstepslive-form-spaces").selectedIndex;resource="spaces/"+$F("screenstepslive-form-spaces")+"/searches.xml?text="+escape(text);this.screenstepslive_resource.request({resource:resource,on_success:this.search_results.bind(this)});enable_submit($("lookup-form"));if(this.space_id==null){$("screenstepslive-form-spaces").selectedIndex=space_selected_index}$("sslive_search_text").value=text},format_lesson_url:function(url){if(this.include_login_in_url==true){url+="?login="+this.screenstepslive_resource.options.user+"&password="+this.screenstepslive_resource.options.pass;return url}else{return url}},register_events:function(){var ul=$$(".sslive_lesson ul.drop-list").each(function(ul){document.observe("click",function(event){if(!event.findElement().descendantOf(ul)){ul.select(".title").each(function(title){title.style.zIndex="0"});ul.select(".action-menu").each(function(menu){menu.style.display="none";menu.style.zIndex="0"})}});ul.observe("click",function(event){title_container=ul.select(".title-container")[0];title=ul.select(".title")[0];menu=ul.select(".action-menu")[0];title.style.zIndex="26";menu.style.display="block";menu.style.zIndex="25"})})},render_lesson_results:function(lessons){result="<h5>"+lessons.length+" matching lessons found. Click on a lesson to view it</h5>";result+="<ul>";result+=lessons.collect(function(l){return"<li><b>"+l.asset.title+':</b><br /><div class="sslive_lesson"><ul class="drop-list" style="position: relative"><li><div class="title-container"><span class="drop link title" id="" style="cursor:default; z-index:20">'+l.title+'</span></div><ul class="rounded-4 action-menu" style="width: 100%; margin-left:-160px;"><li class="ticket_link link" onclick="$$(\'#comment_value\')[0].value += \''+this.format_lesson_url(l.url)+'\'; this.up().style.display=\'none\'; Event.stop(event);">Copy link to ticket</li><li id="" class="window_link link" onclick="window.open(\''+this.format_lesson_url(l.url)+"', 'new');  this.up().style.display='none'; Event.stop(event);\">Open in new window</li></ul></li></ul></div>"}.bind(this)).join("</li>");result+="</ul>";return result},search_results:function(response){result_field=$("screensteps_live_results");result_field.innerHTML="";lessons=$A(response.lessons);if(lessons.length>0){result=this.render_lesson_results(lessons)}else{result="No results"}result_field.innerHTML=result;this.register_events()},spaces_selector:function(response){if(this.space_id==""||this.space_id==null){var spaceInput=$("screenstepslive-form-spaces");spaceInput.innerHTML="";spaces=$A(response.spaces);spaces.each(function(s){var option=document.createElement("option");option.value=s.id;option.innerHTML=s.title;spaceInput.appendChild(option)})}}});var ScreenStepsLiveTasksWidget=Class.create(Widget,{initialize:function($super,args){$super(args);this.widgetId=args.id;this.anchor=args.anchor;this.domainname=args.domainname;this.username=args.username;this.password=args.password;this.use_ssl=args.use_ssl;this.space_id=args.space_id;this.ticket_id=args.ticket_id;this.screenstepslive_tasks_resource=new Zendesk.Resource({anchor:this.anchor,domain:this.domainname||"",user:this.username||"",pass:this.password||"",use_ssl:this.use_ssl||"false",space_id:this.space_id||null,enable_resource_cache:"false",show_logout:false,login_content:this.application.bind(this),application_content:this.application.bind(this),application_resources:[{resource:"spaces/api",media_type:"application/xml",on_success:this.spaces_selector.bind(this)}]})},application:function(){text='<form id="screensteps-live-task-form" onsubmit="if (ObjectFactory.get('+this.id+").validate_sslive_form() == true) {alert('Please enter a valid value for title'); return false;}; ObjectFactory.get("+this.id+").setup_task_form(); ObjectFactory.get("+this.id+').screenstepslive_tasks_resource.submit_data(this); return false;" class="form">';if(this.space_id==""||this.space_id==null){text+='<label style="width:50px;display:block;">Space: </label><select style="margin-bottom:5px;width:175px;" name="task[space_id]" id="screenstepslive-task-form-spaces"></select><br />'}else{text+='<input type="hidden" name="task[space_id]" id="screenstepslive-task-form-spaces" value="'+this.space_id+'">'}text+='<label>Title</label><input type="text" id="task_title" style="width:175px;" name="task[title]"/><label>Description</label><textarea rows="3" id="task_description" style="width:175px;" name="task[description]"></textarea><input type="hidden" name="pluck_param" value="task"><input type="hidden" id="task_resource" name="resource" value=""><input type="hidden" name="media_type" value="application/xml"><input type="hidden" name="event_reference" value="ScreenSteps Live Task Created"><input type="hidden" name="event_log" value="Title,Description,ID"><input type="submit" value="Submit" id="submit"></form>';return text},validate_sslive_form:function(){var task_title=document.getElementById("task_title").value;if(task_title==""||task_title==null){return true}else{return false}},setup_task_form:function(){if(this.ticket_id!=null){$("task_description").value+=("\n\n"+location.href)}$("task_resource").value="spaces/"+$F("screenstepslive-task-form-spaces")+"/tasks";return false},spaces_selector:function(response){if(this.space_id==""||this.space_id==null){var spaceInput=$("screenstepslive-task-form-spaces");spaceInput.innerHTML="";spaces=$A(response.spaces);spaces.each(function(s){var option=document.createElement("option");option.value=s.id;option.innerHTML=s.title;spaceInput.appendChild(option)})}}});var WidgetManagerWidget=Class.create({initialize:function(){widgetManager=this;Widget.redraw()},widgets:function(){return $j("#sidebar div.widget").not("#preview-output .widget").map(function(index,element){var id=(""+$j(element).prop("id")).replace(/^widget_/,"");return ObjectFactory.get(id)}).toArray()},show:function(){$j("#add_widget_select_widget").show();$j("#add_widget_button").hide();this.widgets().each(function(widget){widget.showControls();widget.containingElement().title=I18n.t("txt.admin.public.javascripts.widgets.you_can_drag_and_drop_widgets")});$j("#widget_fixed").addClass("widget_edit_mode");$j("#sidebar").sortable({items:"div.draggable"}).bind("sortupdate",this.updateOrder);Widget.redraw()},hide:function(){$j("#add_widget_button").show();$j("#add_widget_select_widget").hide();this.widgets().each(function(widget){widget.hideControls();widget.containingElement().title=""});$j("#widget_fixed").removeClass("widget_edit_mode");$j("#sidebar").sortable("destroy");Widget.redraw()},updateOrder:function(event,ui){var ids=_($j(event.target).sortable("toArray")).map(function(id){id=(""+id).replace(/^widget_/,"");return id==="fixed"?"fixed":ObjectFactory.get(id).locationId});if(ids.length>0){var url="/widgets/reorder_locations?_method=put";_(ids).each(function(id){url+="&locations[]="+id});$j.ajax(url,{type:"POST"})}},addWidgetToPage:function(controllerName,actionName,widgetId){new Ajax.Request("/widgets/"+widgetId+"/add_to_page",{method:"post",parameters:{controller_name:controllerName,action_name:actionName}})},removeWidgetFromPage:function(controllerName,actionName,widgetId){new Ajax.Request("/widgets/"+widgetId+"/remove_from_page",{method:"delete",parameters:{controller_name:controllerName,action_name:actionName,authenticity_token:Zendesk.currentUser.authenticityToken}})},removeWidget:function(widget_id){var widget=ObjectFactory.get(widget_id);widget.hide(widget.destroy.bind(widget));ObjectFactory.remove(widget_id);$("add_widget_"+widget_id).show()},displayNewWidget:function(){$("widget_manager_widget").insert({before:"hello"})}});var widgetManager=null;var BatchBookHelper=Class.create();BatchBookHelper.getNodeValue=function(document,nodeName){var node=document.getElementsByTagName(nodeName);if(node==null||node.length==0||node[0].childNodes.length==0){return null}return node[0].childNodes[0].nodeValue};BatchBookHelper.getNodeString=function(document,nodeName){var value=this.getNodeValue(document,nodeName);if(value==null){return""}else{return value}};BatchBookHelper.getArrayByTagName=function(tag_name,document){var results=document.getElementsByTagName(tag_name);if(results==null){return new Array()}return results};BatchBookHelper.getRecords=BatchBookHelper.getArrayByTagName.curry("person");BatchBookHelper.getLocations=BatchBookHelper.getArrayByTagName.curry("location");var BatchBookQuery=Class.create();BatchBookQuery.SERVER_URL=new Template("https://#{account_name}.batchbook.com/service/people.xml?email=#{email}");BatchBookQuery.PROXY_URL=new Template("/proxy/direct.xml?&url=#{server_url}");BatchBookQuery.CONTACT_URL=new Template("https://#{account_name}.batchbook.com/contacts/show/#{record_id}");BatchBookQuery.buildUrl=function(account_name,email){var serverUrl=this.SERVER_URL.evaluate({account_name:account_name,email:email});var proxyUrl=this.PROXY_URL.evaluate({server_url:escape(serverUrl)});return proxyUrl};var BatchBookWidgetView=Class.create();BatchBookWidgetView.HEADLINE_TEMPLATE=new Template('<h4 style="font-size: 16px"><a href="#{contact_url}" target="_blank">#{first_name} #{last_name}</a></h4>');BatchBookWidgetView.LOCATION_TEMPLATE=new Template("<h5>#{label}</h5>#{items}");BatchBookWidgetView.LOCATION_ADDRESS_TEMPLATE=new Template('<span class="sub">#{item_label}</span><br />#{item_value}<br />');BatchBookWidgetView.LOCATION_ITEM_TEMPLATE=new Template('#{item_value} <span class="sub">#{item_label}</span><br />');BatchBookWidgetView.ADDRESS_TEMPLATE=new Template('#{street_1}</h5><p class="minimal">#{items}</p>');BatchBookWidgetView.renderLine=function(record,elements,template){var output="";for(var i=0;i<elements.length;i++){output+=BatchBookHelper.getNodeString(record,elements[i]);if(output!=""){output+=" "}}if(output!=""){return template.evaluate({output:output})}else{return""}};BatchBookWidgetView.renderAddress=function(l){var s1=BatchBookHelper.getNodeString(l,"street_1");var s2=BatchBookHelper.getNodeString(l,"street_2");var ct=BatchBookHelper.getNodeString(l,"city");var st=BatchBookHelper.getNodeString(l,"state");var pc=BatchBookHelper.getNodeString(l,"postal_code");var cn=BatchBookHelper.getNodeString(l,"country");var a="";if(s1!=""){a+=s1+"<br />"}if(s2!=""){a+=s2+"<br />"}if(ct!=""){a+=ct;if(st!=""||pc!=""){a+=", "}}if(st!=""||pc!=""){a+=st;if(pc!=""){a+=" "}}if(ct!=""||st!=""||pc!=""){a+=pc+"<br />"}if(cn!=""){a+=cn}return a};BatchBookWidgetView.renderRecord=function(record,accountName){var result="";var record_id=BatchBookHelper.getNodeString(record,"id");var first_name=BatchBookHelper.getNodeString(record,"first_name");var last_name=BatchBookHelper.getNodeString(record,"last_name");var contact_url=BatchBookWidgetView.contact_url(record_id,accountName);result+=BatchBookWidgetView.HEADLINE_TEMPLATE.evaluate({contact_url:contact_url,first_name:first_name,last_name:last_name});result+=this.renderLine(record,["title"],new Template("<p class='minimum'>#{output}</p>"));result+=this.renderLine(record,["company"],new Template("<p class='minimum'>#{output}</p>"));var locations=BatchBookHelper.getLocations(record);var location_string={address:"",email:"",website:"",phone:"",cell:"",fax:""};var location_keys=["address","email","website","phone","cell","fax"];for(var i=0;i<locations.length;i++){var l=locations[i];var loc_label=$j(l).find("label").text();for(var j=0;j<location_keys.length;j++){var lk=location_keys[j];var val="";if(lk=="address"){val=this.renderAddress(l)}else{val=BatchBookHelper.getNodeString(l,lk)}if(val!=""){if(lk=="address"){if(location_string[lk]){location_string[lk]+="<br />"}location_string[lk]+=BatchBookWidgetView.LOCATION_ADDRESS_TEMPLATE.evaluate({item_label:loc_label,item_value:val})}else{location_string[lk]+=BatchBookWidgetView.LOCATION_ITEM_TEMPLATE.evaluate({item_label:loc_label,item_value:val})}}}}for(var j=0;j<location_keys.length;j++){var lk=location_keys[j];if(location_string[lk]!=""){result+=BatchBookWidgetView.LOCATION_TEMPLATE.evaluate({label:lk,items:location_string[lk]})}}return result+"<br />"};BatchBookWidgetView.contact_url=function(record_id,accountName){return BatchBookQuery.CONTACT_URL.evaluate({record_id:record_id,account_name:accountName})};var BatchBookWidget=Class.create(Widget,{lookup:function(form){$j("#batchbooks-widget-spinner").show();if(this.accountName!=null&&this.token!=null){var url=BatchBookQuery.buildUrl(this.accountName,form.email.value);new Ajax.Request(url,{method:"get",requestHeaders:{Authorization:"Basic "+Base64.encode(this.token+":x")},onSuccess:function(transport){this.displayResult(transport.responseXML);$j("#batchbooks-widget-spinner").hide()}.bind(this),onFailure:function(){$(this.contentRoot).update("<h5>Unable to search your BatchBook account at this time.  Please try again later.</h5>")}.bind(this)})}else{$(this.contentRoot).update("<h5>BatchBook login failed - BatchBook account needs configuration.</h5>")}},displayResult:function(responseXML){var records=BatchBookHelper.getRecords(responseXML);if(records.length==0){$(this.contentRoot).update("<h5>No match found in your BatchBook account.</h5>");return}else{var m=BatchBookWidgetView.renderRecord(records[0],this.accountName);$(this.contentRoot).update(m)}},initialize:function($super,args){$super(args);this.token=args.token;this.formInstance=null;this.widgetId=args.id;this.isEmpty=args.isEmpty;this.accountName=args.accountName;this.requesterEmail=args.requester_email;this.contentRoot=this.containingElement().down("div.batchbook-content-"+this.widgetId)}});var CustomCalendarDateSelect=Class.create(CalendarDateSelect,{updateValue:function($super){$super();var d=this.selected_date;var day=d.getDate()<10?("0"+d.getDate()):d.getDate();var month=(d.getMonth()+1)<10?("0"+parseInt(d.getMonth()+1)):parseInt(d.getMonth()+1);var str=month+"/"+day+"/"+d.getFullYear();this.target_element.value=str},parseDate:function($super){var value=$F(this.target_element).strip();$super();if(this.selection_made){this.selected_date.setFullYear(value.split("/")[2],parseInt(value.split("/")[0])-1,parseInt(value.split("/")[1]));this.date=this.selected_date}}});var clarizenWidgetUnicodeConverter={convertChar2CP:function(textString){var haut=0;var n=0;var CPstring="";for(var i=0;i<textString.length;i++){var b=textString.charCodeAt(i);if(b<0||b>65535){CPstring+="Error "+this.dec2hex(b)+"!"}if(haut!==0){if(56320<=b&&b<=57343){CPstring+=this.dec2hex(65536+((haut-55296)<<10)+(b-56320))+" ";haut=0;continue}else{CPstring+="!erreur "+this.dec2hex(haut)+"!";haut=0}}if(55296<=b&&b<=56319){haut=b}else{CPstring+=this.dec2hex(b)+" "}}CPstring=CPstring.substring(0,CPstring.length-1);return this.convertCP2HexNCR(CPstring)},convertCP2HexNCR:function(textString){var outputString="";textString=textString.replace(/^\s+/,"");if(textString.length===0){return""}textString=textString.replace(/\s+/g," ");var listArray=textString.split(" ");for(var i=0;i<listArray.length;i++){var n=parseInt(listArray[i],16);outputString+="&#x"+this.dec2hex(n)+";"}return(outputString)},dec2hex:function(textString){return(textString+0).toString(16).toUpperCase()}};var clarizenWidgetHelper={PARTNER_ID:"baa861be-8460-4de8-b678-56f915b6be43",SERVICE_URL:"https://api.clarizen.com/v1.0/Clarizen.svc",LOGIN_URL:"http://clarizen.com/api/IClarizen/Login",QUERY_URL:"http://clarizen.com/api/IClarizen/Query",EXECUTE_URL:"http://clarizen.com/api/IClarizen/Execute",WIDGET_ID:"clarizenWidget",IMAGE_PATH:"/images/widgets/clarizen/",PRIORITY_MAPPING:{1:"Low",2:"Medium",3:"High",4:"Critical"},GET_CLARIZEN_USER_PROFILE:new Template('<?xml version="1.0" encoding="utf-8"?>   <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">   <soap:Header>       <Session xmlns="http://clarizen.com/api">         <ID>#{sessionId}</ID>       </Session>   </soap:Header>  <soap:Body>  <Query xmlns="http://clarizen.com/api">  <queryExpression xmlns:q1="http://clarizen.com/api/queries" xsi:type="q1:EntityQuery">     <q1:Paging xsi:nil="true" />     <q1:Fields />     <q1:Orders xsi:nil="true" />     <q1:TypeName>User</q1:TypeName>     <q1:Where xsi:type="q1:And">       <q1:Conditions>          <Condition xsi:type="q1:Compare">            <q1:LeftExpression xsi:type="q1:FieldExpression">               <q1:FieldName>Email</q1:FieldName>            </q1:LeftExpression>            <q1:Operator>Equal</q1:Operator>            <q1:RightExpression xsi:type="q1:ConstantExpression">               <q1:Value xsi:type="xsd:string">#{email}</q1:Value>            </q1:RightExpression>          </Condition>          <Condition xsi:type="q1:Compare">            <q1:LeftExpression xsi:type="q1:FieldExpression">               <q1:FieldName>FirstName</q1:FieldName>            </q1:LeftExpression>            <q1:Operator>Equal</q1:Operator>            <q1:RightExpression xsi:type="q1:ConstantExpression">               <q1:Value xsi:type="xsd:string">#{firstName}</q1:Value>            </q1:RightExpression>          </Condition>          <Condition xsi:type="q1:Compare">            <q1:LeftExpression xsi:type="q1:FieldExpression">               <q1:FieldName>LastName</q1:FieldName>            </q1:LeftExpression>            <q1:Operator>Equal</q1:Operator>            <q1:RightExpression xsi:type="q1:ConstantExpression">               <q1:Value xsi:type="xsd:string">#{lastName}</q1:Value>            </q1:RightExpression>          </Condition>       </q1:Conditions>     </q1:Where>  </queryExpression>  </Query>  </soap:Body></soap:Envelope>'),GET_SYSTEM_SETTINGS:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">   <soap:Header>       <Session xmlns="http://clarizen.com/api">         <ID>#{sessionId}</ID>       </Session>   </soap:Header>  <soap:Body>      <Execute xmlns="http://clarizen.com/api">         <request>            <BaseMessage xmlns:q1="http://clarizen.com/api/metadata" xsi:type="q1:GetSystemSettingsValuesMessage">              <q1:Settings>                  <string>Enable issue management</string>                  <string>Enable bug tracking</string>                  <string>Enable requests for enhancements</string>                  <string>Enable risk management</string>              </q1:Settings>            </BaseMessage>         </request>      </Execute>  </soap:Body></soap:Envelope>'),UNLINK_ISSUE:new Template('<?xml version="1.0" encoding="utf-8"?>   <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">   <soap:Header>       <Session xmlns="http://clarizen.com/api">         <ID>#{sessionId}</ID>       </Session>   </soap:Header>   <soap:Body>      <Execute xmlns="http://clarizen.com/api">         <request>             <BaseMessage xsi:type="UpdateMessage">               <Entity xsi:type="GenericEntity">                  <Id>                     <TypeName>Issue</TypeName>                     <Value>#{IssueId}</Value>                  </Id>                  <Values>                     <FieldValue>                        <FieldName>ZdExternalId</FieldName>                        <Value xsi:type="xsd:string"></Value>                     </FieldValue>                  </Values>               </Entity>            </BaseMessage>         </request>     </Execute>  </soap:Body> </soap:Envelope>'),GET_EXTERNAL_ID_BY_TICKET_ID:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Header>    <Session xmlns="http://clarizen.com/api">      <ID>#{sessionId}</ID>    </Session>  </soap:Header>  <soap:Body><Execute xmlns="http://clarizen.com/api"> <request>   <BaseMessage xmlns:q1="http://clarizen.com/api/queries" xsi:type="q1:EntityQuery">     <q1:Paging xsi:nil="true" />     <q1:Fields />     <q1:Orders xsi:nil="true" />     <q1:TypeName>Issue</q1:TypeName>     <q1:Where xsi:type="q1:Compare">       <q1:LeftExpression xsi:type="q1:FieldExpression">          <q1:FieldName>ZdExternalId</q1:FieldName>       </q1:LeftExpression>       <q1:Operator>Equal</q1:Operator>       <q1:RightExpression xsi:type="q1:ConstantExpression">          <q1:Value xsi:type="xsd:string">#{ticketId}</q1:Value>       </q1:RightExpression>     </q1:Where>   </BaseMessage>   <BaseMessage xmlns:q1="http://clarizen.com/api/queries" xsi:type="q1:EntityQuery">     <q1:Paging xsi:nil="true" />     <q1:Fields />     <q1:Orders xsi:nil="true" />     <q1:TypeName>Bug</q1:TypeName>     <q1:Where xsi:type="q1:Compare">       <q1:LeftExpression xsi:type="q1:FieldExpression">          <q1:FieldName>ZdExternalId</q1:FieldName>       </q1:LeftExpression>       <q1:Operator>Equal</q1:Operator>       <q1:RightExpression xsi:type="q1:ConstantExpression">          <q1:Value xsi:type="xsd:string">#{ticketId}</q1:Value>       </q1:RightExpression>     </q1:Where>   </BaseMessage> </request></Execute>  </soap:Body></soap:Envelope>'),UPDATE_ISSUE:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">   <soap:Header>       <Session xmlns="http://clarizen.com/api">         <ID>#{sessionId}</ID>       </Session>   </soap:Header>   <soap:Body>     <Execute xmlns="http://clarizen.com/api">          <request>              <BaseMessage xsi:type="LifecycleMessage">                  <Ids>                      <EntityId>                          <TypeName>#{entity}</TypeName>                          <Value>#{issueId}</Value>                      </EntityId>                  </Ids>                  <Operation>#{operation}</Operation>              </BaseMessage>              <BaseMessage xsi:type="CreateMessage">                  <Entity xsi:type="GenericEntity">                      <Id>                          <TypeName>IssueTeamMembers</TypeName>                          <Value xsi:nil="true" />                      </Id>                      <Values>                          <FieldValue>                              <FieldName>Case</FieldName>                              <Value xsi:type="EntityId">                                  <TypeName>#{entity}</TypeName>                                  <Value>#{issueId}</Value>                              </Value>                          </FieldValue>                          <FieldValue>                              <FieldName>TeamMember</FieldName>                              <Value xsi:type="EntityId">                                  <TypeName>User</TypeName>                                  <Value>#{creatorId}</Value>                              </Value>                          </FieldValue>                      </Values>                  </Entity>                </BaseMessage>          </request>      </Execute>   </soap:Body></soap:Envelope>'),DUE_DATE:new Template('<FieldValue>  <FieldName>DueDate</FieldName>  <Value xsi:type="xsd:dateTime">#{dueDate}</Value></FieldValue>'),PROJECT_ID:new Template('<FieldValue>  <FieldName>PlannedFor</FieldName>  <Value xsi:type="EntityId">    <TypeName>Project</TypeName>    <Value>#{projectId}</Value>  </Value></FieldValue>'),SUBMIT_ISSUE:new Template('<?xml version="1.0" encoding="utf-8"?>   <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">   <soap:Header>       <Session xmlns="http://clarizen.com/api">         <ID>#{sessionId}</ID>       </Session>   </soap:Header>   <soap:Body>      <Execute xmlns="http://clarizen.com/api">         <request>             <BaseMessage xsi:type="CreateMessage">               <Entity xsi:type="GenericEntity">                  <Id>                     <TypeName>#{entity}</TypeName>                  </Id>                  <Values>                     <FieldValue>                        <FieldName>Title</FieldName>                        <Value xsi:type="xsd:string">#{title}</Value>                     </FieldValue>                     <FieldValue>                        <FieldName>Description</FieldName>                        <Value xsi:type="xsd:string">#{description}</Value>                     </FieldValue>                     #{dueDateTemplate}                     <FieldValue>                        <FieldName>Severity</FieldName>                        <Value xsi:type="EntityId">                           <TypeName>Severity</TypeName>                           <Value>#{severity}</Value>                        </Value>                     </FieldValue>                     <FieldValue>                        <FieldName>AssignedTo</FieldName>                        <Value xsi:type="EntityId">                           <TypeName>User</TypeName>                           <Value>#{userId}</Value>                        </Value>                     </FieldValue>                     <FieldValue>                        <FieldName>Owner</FieldName>                        <Value xsi:type="EntityId">                           <TypeName>User</TypeName>                           <Value>#{ownerId}</Value>                        </Value>                     </FieldValue>                     #{projectTemplate}                     <FieldValue>                        <FieldName>ZdExternalId</FieldName>                        <Value xsi:type="xsd:string">#{ticketId}</Value>                     </FieldValue>                  </Values>               </Entity>            </BaseMessage>         </request>     </Execute>  </soap:Body> </soap:Envelope>'),GET_PROJECTS:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Header>    <Session xmlns="http://clarizen.com/api">      <ID>#{sessionId}</ID>    </Session>  </soap:Header>  <soap:Body>  <Query xmlns="http://clarizen.com/api">  <queryExpression xmlns:q1="http://clarizen.com/api/queries" xsi:type="q1:EntityQuery">     <q1:Paging xsi:nil="true" />     <q1:Fields>       <string>Name</string>     </q1:Fields>     <q1:Orders xsi:nil="true" />     <q1:TypeName>Project</q1:TypeName>     <q1:Where xsi:nil="true" />  </queryExpression>  </Query>  </soap:Body></soap:Envelope>'),GET_ASSIGNEES:new Template('<?xml version="1.0" encoding="utf-8"?>  <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Header>      <Session xmlns="http://clarizen.com/api">        <ID>#{sessionId}</ID>      </Session>  </soap:Header>  <soap:Body>  <Query xmlns="http://clarizen.com/api">      <queryExpression xmlns:q1="http://clarizen.com/api/queries" xsi:type="q1:EntityQuery">         <q1:Paging xsi:nil="true" />            <q1:Fields>                 <string>FirstName</string>                 <string>LastName</string>                 <string>Email</string>             </q1:Fields>             <q1:Orders>               <q1:OrderBy>                 <q1:FieldName>DisplayName</q1:FieldName>               </q1:OrderBy>             </q1:Orders>             <q1:TypeName>User</q1:TypeName>             <q1:Where xsi:type="q1:Compare">                      <q1:LeftExpression xsi:type="q1:FieldExpression">                          <q1:FieldName>State</q1:FieldName>                      </q1:LeftExpression>                      <q1:Operator>NotEqual</q1:Operator>                      <q1:RightExpression xsi:type="q1:ConstantExpression">                          <q1:Value xsi:type="EntityId">                              <TypeName>State</TypeName>                              <Value>Deleted</Value>                          </q1:Value>                      </q1:RightExpression>               </q1:Where>     </queryExpression>  </Query>  </soap:Body></soap:Envelope>'),GET_SESSION:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Body>    <Login xmlns="http://clarizen.com/api">      <userName>#{username}</userName>      <password>#{password}</password>      <options xsi:type="ExtendedLoginOptions">         <ApplicationId>ClarizenClient</ApplicationId>         <PartnerId>#{partnerId}</PartnerId>         <ClientVersion>1.0</ClientVersion>      </options>    </Login>  </soap:Body></soap:Envelope>'),ISSUE_INLINE_UPDATES:new Template('<div style="padding-bottom:5px; width:85px; float:left;"><strong>Issue number:</strong></div><div style="float: left;">#{sysId}</div><div style="clear:both;"></div><div><strong>Title:</strong></div><div style="padding-bottom:5px;"><span title="#{fullticketTitle}">#{ticketTitle}</span></div><div style="padding-bottom:5px; width:85px; float:left;"><strong>State:</strong></div><div style="float: left;">#{state}</div><div style="clear:both;"></div><div style="padding-bottom:5px; width:85px; float:left;"><strong>Severity:</strong></div><div style="float: left;">#{severity}</div><div style="clear:both;"></div><div style="padding-bottom:5px; width:85px; float:left;"><strong>Due Date:</strong></div><div style="float: left;">#{date}</div><div style="clear:both;"></div><div style="padding-bottom:5px; width:85px; float:left;"><strong>Assigned To:</strong></div><div style="float: left;">#{assignedTo}</div><div style="clear:both;"></div><div style="padding-bottom:5px; width:85px; float:left;"><strong>Owner:</strong></div><div style="float: left;">#{owner}</div><div style="clear:both;"></div>#{projectTemplate}'),PROJECT_ISSUE_TEMPLATE:new Template('<div><strong>To be Resolved In:</strong></div><span title="#{fullProjectName}">#{projectName}</span>'),SEND_MAIL_TEMPLATE:new Template("<a href=\"mailto:#{mailAsigneeEmail}?subject=%20[zendesk]%20Message%20regarding%20ticket%20'#{mailTitle}'%20(#{mailTicketId})&cc=#{mailOwnerEmail}\">Send email</a>"),DISPLAY_ISSUE_FORM:new Template('<div id="issue-details" style="padding:3px;width:100%;overflow:hidden;"><div style="padding-bottom:5px; width:85px; float:left;"><strong>Issue number:</strong></div><div><div style="float: left;">#{sysId}</div><div style="clear:both;"></div><div><strong>Title:</strong></div><div style="padding-bottom:5px;"><span title="#{fullticketTitle}">#{ticketTitle}</span></div><div style="padding-bottom:5px; width:85px; float:left;"><strong>State:</strong></div><div style="float: left;">#{state}</div><div style="clear:both;"></div><div style="padding-bottom:5px; width:85px; float:left;"><strong>Severity:</strong></div><div style="float: left;">#{severity}</div><div style="clear:both;"></div><div style="padding-bottom:5px; width:85px; float:left;"><strong>Due Date:</strong></div><div><div style="float: left;">#{date}</div><div style="clear:both;"></div><div style="padding-bottom:5px; width:85px; float:left;"><strong>Assigned To:</strong></div><div style="float: left;">#{assignedTo}</div><div style="clear:both;"></div><div style="padding-bottom:5px; width:85px; float:left;"><strong>Owner:</strong></div><div style="float: left;">#{owner}</div><div style="clear:both;"></div>#{projectTemplate}</div><div style="text-align:center;padding-top:5px;"><!--<a onclick="clarizenWidget.unLinkIssue(false);" href="javascript:void(0);">unlink</a> |--> <a onclick="ObjectFactory.get(#{widgetId}).getIssueFromClarizen(false);" href="#">Refresh</a> | #{mailTemplate}</div></div>'),SUBMIT_FORM:new Template('<div style="display:none;"><div id="clarizen-modal-popup" class="frame" style="width:400px;margin:-15px;padding:20px;border-width:10px;"><form class="form" id="clarizen-form" style="margin-bottom:30px;"><div style="float:left;padding-right:10px;">#{logoImage}</div><div style="font-size:16px;padding-top:10px;">Create issue in Clarizen</div><div style="clear:both;"></div><div class="select" style="padding-top:5px"><label style="display:inline;padding-right:70px;">Subject:</label><input type="text" value="" size="30" id="clarizenTitle" style="width:75%;" class="clarizenTitle"/></div><div class="select" style="padding-bottom:5px;padding-top:5px;"><label style="float:left;padding-right:50px;">Description:</label><textarea rows="4" id="clarizenDescription" class="clarizenDescription" style="width:75%;" ></textarea><div style="clear:both;"></div></div><div style="padding-bottom: 5px"><div style="width:120px; float: left;"><label style="margin-top: 0px;">Clarizen priority:</label></div><div style="float:left;"><select id="clarizenSeveritySelector" class="clarizenSeveritySelector" style="width:215px;padding-left:10px;max-width:215px;">   <option value="Critical">Urgent</option>   <option value="High">High</option>   <option value="Low">Low</option>   <option selected="selected" value="Medium">Normal</option></select></div><div style="clear:both"></div></div><div style="padding-bottom: 5px"><div style="width:120px; float: left;"><label style="margin-top: 0px;">To be resolved In:</label></div><div style="float:left;"><select id="clarizenProjectSelector" disabled class="clarizenProjectSelector" style="width:215px;padding-left:10px;max-width:215px;"></select></div><div style="clear:both"></div></div><div style="padding-bottom: 5px"><div style="width:120px; float: left;"><label style="margin-top: 0px;">Assigned To:</label></div><div style="float:left;"><select id="clarizenAssigneeSelecter" disabled class="clarizenAssigneeSelecter" style="width:215px;padding-left:10px;max-width:215px;"></select></div><div style="clear:both"></div></div><div style="width:120px; float: left;"><label style="margin-top: 0px;">Due Date:</label></div><div style="float:left;"><input type="text" value="" size="10" id="dueDate" class="dueDate" /><img alt="Calendar" class="calendar_date_select_popup_icon" onclick="new CustomCalendarDateSelect( $(this).previous(), {buttons:false, popup:\'force\', time:false, year_range:10} ); $$(\'.calendar_date_select\')[0].setStyle({\'zIndex\':\'10010\'}); " src="http://assets.zendesk.com/images/calendar_date_select/calendar.gif?1264325148" style="border:0px; cursor:pointer;" /></div><div style="float:right;"><input type="button" value="Submit" onclick="ObjectFactory.get(#{widgetId}).submitIssueForm($(\'clarizen-form\'));" class="buttonsubmit" /><input type="button" value="Cancel" onclick="ObjectFactory.get(#{widgetId}).closeForm();" class="buttonsubmit" /></div></form></div></div>'),SHOW_AVAILABILITY_LINK:new Template('<div id="availabilityLnk" style="text-align:center;padding-top:10px;padding-bottom:10px;">  <a target="_blank" href="#">Show Availability</a></div>'),TICKET_RESOLUTION:new Template('<div class="clarizen_message">You can create a request for resolution of the ticket in Clarizen<div style="text-align:center;padding-top:10px;padding-bottom:10px;">  <a onclick="ObjectFactory.get(#{widgetId}).showForm();" href="#">Request ticket resolution</a></div></div>'),PROXY_URL:new Template("/proxy/direct?url=#{url}&log=1"),CREATE_USER:new Template('<?xml version="1.0" encoding="utf-8"?>   <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">   <soap:Header>       <Session xmlns="http://clarizen.com/api">         <ID>#{sessionId}</ID>       </Session>   </soap:Header>   <soap:Body>      <Execute xmlns="http://clarizen.com/api">         <request>             <BaseMessage xsi:type="CreateMessage">               <Entity xsi:type="GenericEntity">                  <Id>                     <TypeName>User</TypeName>                  </Id>                  <Values>                     <FieldValue>                        <FieldName>FirstName</FieldName>                        <Value xsi:type="xsd:string">#{firstName}</Value>                     </FieldValue>                     <FieldValue>                        <FieldName>LastName</FieldName>                        <Value xsi:type="xsd:string">#{lastName}</Value>                     </FieldValue>                     <FieldValue>                        <FieldName>Email</FieldName>                        <Value xsi:type="xsd:string">#{email}</Value>                     </FieldValue>                     <FieldValue>                        <FieldName>AllowEmails</FieldName>                        <Value i:type="b:boolean" xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns:b="http://www.w3.org/2001/XMLSchema">true</Value>                     </FieldValue>                     <FieldValue>                        <FieldName>SendInvitationMail</FieldName>                        <Value xsi:type="xsd:boolean">#{sendInvitationMail}</Value>                     </FieldValue>                  </Values>               </Entity>            </BaseMessage>         </request>     </Execute>  </soap:Body> </soap:Envelope>'),GET_ISSUE_QUERY:new Template('<?xml version="1.0" encoding="utf-8"?>  <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Header>      <Session xmlns="http://clarizen.com/api">        <ID>#{sessionId}</ID>      </Session>  </soap:Header>  <soap:Body>   <Execute xmlns="http://clarizen.com/api">      <request>        <BaseMessage xsi:type="RetrieveMessage">          <Fields>            <string xmlns="http://clarizen.com/api">SYSID</string>            <string xmlns="http://clarizen.com/api">DueDate</string>            <string xmlns="http://clarizen.com/api">State</string>            <string xmlns="http://clarizen.com/api">Severity</string>            <string xmlns="http://clarizen.com/api">AssignedTo.DisplayName</string>            <string xmlns="http://clarizen.com/api">Owner.DisplayName</string>            <string xmlns="http://clarizen.com/api">PlannedFor.Name</string>            <string xmlns="http://clarizen.com/api">Title</string>            <string xmlns="http://clarizen.com/api">ZdExternalId</string>          </Fields>          <Id>               <TypeName>#{entity}</TypeName>               <Value>#{externalId}</Value>          </Id>        </BaseMessage>      </request>   </Execute>  </soap:Body></soap:Envelope>'),MISSING_TICKET:new Template("Only available when viewing tickets or users.<br />&nbsp;"),PROFILE_PAGE_TEXT:new Template("<!--#{logoImage}--><div>Click Show Assignment to see user usage in Clarizen.</div>"),PROFILE_NOT_EXISTS:new Template("<div>User #{name} is not yet registered in Clarizen.</div>"),getMissingTicketMessage:function(){return(this.MISSING_TICKET.evaluate({}))},getProfileNotExistsMessage:function(name){return(this.PROFILE_NOT_EXISTS.evaluate({name:name}))},getAvailabilityLnkForProfilePage:function(Id){return(this.PROFILE_PAGE_TEXT.evaluate({logoImage:this.getLogoImage()}))+this.getAvailabilityLnk(Id)},getAvailabilityLnk:function(widgetId){return this.SHOW_AVAILABILITY_LINK.evaluate({widgetId:widgetId})},getClarizenUserProfile:function(sessionId,email,firstName,lastName){return escape(this.GET_CLARIZEN_USER_PROFILE.evaluate({sessionId:sessionId,email:email,firstName:firstName,lastName:lastName}))},getExternalIdByTicketRequest:function(sessionId,ticketId){return escape(this.GET_EXTERNAL_ID_BY_TICKET_ID.evaluate({sessionId:sessionId,ticketId:ticketId}))},setIssueInlineUpdates:function(severity,sysId,state,date,assignedTo,owner,projectName,title){return this.ISSUE_INLINE_UPDATES.evaluate({severity:severity,sysId:sysId,ticketTitle:title,fullticketTitle:title,state:(state==="Submitted2"?"Submitted":state),stateImage:this.getStateImage(state),date:this.getFormattedDate(date),assignedTo:assignedTo,owner:owner,projectTemplate:projectName===" - "?null:this.PROJECT_ISSUE_TEMPLATE.evaluate({fullProjectName:projectName,projectName:projectName}),path:this.IMAGE_PATH})},getDisplayIssueForm:function(widgetId,severity,sysId,state,date,assignedTo,owner,projectName,title,mailTitle,mailTicketId,mailAsigneeEmail,mailOwnerEmail){return this.DISPLAY_ISSUE_FORM.evaluate({widgetId:widgetId,severity:severity,sysId:sysId,ticketTitle:title,fullticketTitle:title,state:(state==="Submitted2"?"Submitted":state),stateImage:this.getStateImage(state),date:this.getFormattedDate(date),assignedTo:assignedTo,owner:owner,projectTemplate:projectName===" - "?null:this.PROJECT_ISSUE_TEMPLATE.evaluate({fullProjectName:projectName,projectName:projectName}),path:this.IMAGE_PATH,mailTemplate:this.SEND_MAIL_TEMPLATE.evaluate({mailTitle:mailTitle,mailTicketId:mailTicketId,mailAsigneeEmail:mailAsigneeEmail,mailOwnerEmail:mailOwnerEmail})})},getSystemSettings:function(sessionId){return escape(this.GET_SYSTEM_SETTINGS.evaluate({sessionId:sessionId}))},getProjects:function(sessionId){return escape(this.GET_PROJECTS.evaluate({sessionId:sessionId}))},getCreateUserRequest:function(sessionId,email,firstName,lastName,sendInvitationMail){return escape(this.CREATE_USER.evaluate({sessionId:sessionId,email:email,firstName:firstName,lastName:lastName,sendInvitationMail:sendInvitationMail}))},getSubmitForm:function(widgetId){return(this.SUBMIT_FORM.evaluate({widgetId:widgetId,logoImage:this.getLogoImage()}))},getProxyUrl:function(url,soapAction){return escape(this.PROXY_URL.evaluate({url:url,soapAction:soapAction}))},getSubmitFormRequest:function(sessionId,title,description,dueDate,severity,userId,projectId,ownerId,ticketId,mode){var entity=mode?"Bug":"Issue";return escape(this.SUBMIT_ISSUE.evaluate({sessionId:sessionId,title:title,description:description,dueDateTemplate:dueDate===null?null:this.DUE_DATE.evaluate({dueDate:dueDate}),severity:severity,userId:userId,ownerId:ownerId,projectTemplate:projectId===""||projectId===null?null:this.PROJECT_ID.evaluate({projectId:projectId}),ticketId:ticketId,entity:entity}))},getUpdateFormRequest:function(sessionId,issueId,statusId,mode,creatorId){return escape(this.UPDATE_ISSUE.evaluate({sessionId:sessionId,issueId:issueId,operation:this.getStateValue(statusId),creatorId:creatorId,entity:mode?"Bug":"Issue"}))},getLinkTicketResolution:function(widgetId){return this.TICKET_RESOLUTION.evaluate({widgetId:widgetId})},setUnLinkIssue:function(sessionId,IssueId){return escape(this.UNLINK_ISSUE.evaluate({sessionId:sessionId,IssueId:IssueId}))},getIssueFromClarizenQuery:function(sessionId,externalId,mode){return escape(this.GET_ISSUE_QUERY.evaluate({sessionId:sessionId,externalId:externalId,entity:mode?"Bug":"Issue"}))},getAssigneeRequest:function(sessionId){return escape(this.GET_ASSIGNEES.evaluate({sessionId:sessionId}))},getSessionRequest:function(username,password,partnerId){return escape(this.GET_SESSION.evaluate({username:username,password:password,partnerId:partnerId}))},getLogoImage:function(){return'<img title="Clarizen Logo" alt="Clarizen Logo" src="'+this.IMAGE_PATH+'logo.jpg"/>'},getLoadingImage:function(){return'<img title="Indicator" alt="Indicator" src="'+this.IMAGE_PATH+'indicator.gif"/>'},getStateValue:function(stateId){switch(stateId){case 1:return"Open";case 2:return"Reject";case 3:return"MarkResolved";default:return null}},getSeverityImage:function(severity){switch(severity){case"High":return'<img height="16" style="display:inline;" title="High" alt="High" src="'+this.IMAGE_PATH+'High.jpg"/>';case"Low":return'<img height="16" style="display:inline;" title="Low" alt="Low" src="'+this.IMAGE_PATH+'Low.jpg"/>';case"Critical":return'<img height="16" style="display:inline;" title="Critical" alt="Critical" src="'+this.IMAGE_PATH+'Critical.jpg"/>';default:return""}},getStateImage:function(state){switch(state){case"Submitted":case"Submitted2":return'<img height="16" style="display:inline;" title="Submitted" alt="Submitted" src="'+this.IMAGE_PATH+'Submitted.jpg"/>';case"Opened":return'<img height="16" style="display:inline;" title="Opened" alt="Opened" src="'+this.IMAGE_PATH+'Opened.jpg"/>';case"In Work":return'<img height="16" style="display:inline;" title="In Work" alt="In Work" src="'+this.IMAGE_PATH+'Inwork.jpg"/>';case"Resolved":return'<img height="16" style="display:inline;" title="Resolved" alt="Resolved" src="'+this.IMAGE_PATH+'Resolved.jpg"/>';case"Duplicated":return'<img height="16" style="display:inline;" title="Duplicated" alt="Duplicated" src="'+this.IMAGE_PATH+'Duplicated.jpg"/>';case"Not Reproducible":return'<img height="16" style="display:inline;" title="Not Reproducible" alt="Not Reproducible" src="'+this.IMAGE_PATH+'Notreproducible.jpg"/>';case"Rejected":return'<img height="16" style="display:inline;" title="Rejected" alt="Rejected" src="'+this.IMAGE_PATH+'Rejected.jpg"/>';case"Deferred":return'<img height="16" style="display:inline;" title="Deferred" alt="Deferred" src="'+this.IMAGE_PATH+'Deferred.jpg"/>';case"Closed":return'<img height="16" style="display:inline;" title="Closed" alt="Closed" src="'+this.IMAGE_PATH+'Closed.jpg"/>';default:return""}},convertDateToXSD:function(date){var currentTime=new Date();var d=date.split("/");var hours=currentTime.getHours()<10?("0"+currentTime.getHours()):currentTime.getHours();var seconds=currentTime.getSeconds()<10?("0"+currentTime.getSeconds()):currentTime.getSeconds();var minutes=currentTime.getMinutes()<10?("0"+currentTime.getMinutes()):currentTime.getMinutes();var gmtHours=-currentTime.getTimezoneOffset()/60;gmtHours=(gmtHours<0?"&#45;":"&#43;")+(Math.abs(gmtHours)<10?"0":"")+Math.abs(gmtHours);return d[2]+"-"+d[0]+"-"+d[1]+"T12:00:00"+gmtHours+":00"},getFormattedDate:function(date){if(date.split("T").length===1){return date}var d=date.split("T")[0].split("-");var t=date.split("T")[1].split(":");var currentTime=new Date();var gmtHours=-currentTime.getTimezoneOffset()/60;var parseDate=new Date(d[0],d[1]-1,d[2],parseInt(t[0]),0,0);parseDate.setHours(parseDate.getHours()+gmtHours+7);var day=parseDate.getDate()<10?("0"+parseDate.getDate()):parseDate.getDate();var month=(parseDate.getMonth()+1)<10?("0"+parseInt(parseDate.getMonth()+1)):parseInt(parseDate.getMonth()+1);return month+"/"+day+"/"+parseDate.getFullYear()},fixTitle:function(title){return title.length>20?title.substr(0,20)+"...":title},fixProjectName:function(name){return name.length>14?name.substr(0,14)+"...":name},getValue:function(document,fieldName,subfieldName){subfieldName=subfieldName||null;var nameNode=$j(document).find("FieldName:contains("+fieldName+")");var valueNode=nameNode.siblings("Value");if(subfieldName&&valueNode.filter(function(){return jQuery(this).attr("i:type")=="GenericEntity"}).length>0){return this.getValue(valueNode,subfieldName)}else{if(valueNode.filter(":not(:empty)")){return valueNode.text()}}return" - "},getTextContentByKey:function(document,key){var node=document.getElementsByTagName(key);if(typeof node==="undefined"||node===null||node.length===0){return null}if(Prototype.Browser.IE){if(document.getElementsByTagName(key)[0].childNodes.length===0){return null}return document.getElementsByTagName(key)[0].childNodes[0].nodeValue}return document.getElementsByTagName(key)[0].textContent},getNodeValue:function(node){if(typeof node==="undefined"||node===null){return null}if(Prototype.Browser.IE){return node.childNodes[0].nodeValue}return node.textContent}};var ClarizenWidget=Class.create(Widget,{initialize:function($super,args){$super(args);this.widgetId=args.id;this.username=args.username;this.password=args.password;this.partnerID=clarizenWidgetHelper.PARTNER_ID;this.ticketId=typeof ticket_id==="undefined"?null:ticket_id;this.externalId=this.clarizenUserIdForPopup=this.sessionId=null;this.settings={enableIssues:false,enableBugs:false};this.sendInvitationMail=args.sendInvitationMail;this.formInstance=null;this.contentRoot=this.containingElement().down("div.clarizen-content"+this.widgetId);this.oldContentRoot=this.contentRoot;this.doSelectAssignee=false;this.assigneeXml=null;this.formLoaded=false;var self=this;$j("div#availabilityLnk a").live("click",function(){if(self.clarizenUserIdForPopup){$j(this).attr("href","https://app.clarizen.com/Clarizen/Pages/Calendar/ResourceCalendarView.aspx?u="+self.clarizenUserIdForPopup)}else{alert("Clarizen user information has not been received yet, please try again later.");return false}});this.start()},start:function(){this.proxyClarizenLoginUrl=clarizenWidgetHelper.PROXY_URL.evaluate({url:clarizenWidgetHelper.SERVICE_URL});this.proxyClarizenQueryUrl=clarizenWidgetHelper.PROXY_URL.evaluate({url:clarizenWidgetHelper.SERVICE_URL});this.proxyClarizenExecuteUrl=clarizenWidgetHelper.PROXY_URL.evaluate({url:clarizenWidgetHelper.SERVICE_URL});if(this.ticketId){this.showLoading();this.getSession(this.getExternalIdByTicketId)}else{if(this.isUserProfilePage()){this.contentRoot.insert(clarizenWidgetHelper.getLoadingImage());this.getSession(function(){this.getZendeskUserForProfilePage(document.location.toString().split("/")[4])})}else{this.contentRoot.update(clarizenWidgetHelper.getMissingTicketMessage())}}},isBugMode:function(){return this.settings.enableBugs&&!this.settings.enableIssues},isUserProfilePage:function(){return(/users/).test(document.location)},showLoading:function(){this.contentRoot.insert(clarizenWidgetHelper.getLoadingImage())},showInitial:function(){this.contentRoot.update(clarizenWidgetHelper.getSubmitForm(this.widgetId)+clarizenWidgetHelper.getLinkTicketResolution(this.widgetId))},failLoading:function(){$("resolutionLnk").update(clarizenWidgetHelper.getLinkTicketResolution(this.widgetId))},showForm:function(){$j.colorbox({inline:true,href:"#clarizen-modal-popup"});this.oldContentRoot=this.contentRoot;this.contentRoot=document.getElementById("clarizen-modal-popup");var self=this;$j(document).bind("cbox_cleanup",function(){self.contentRoot=self.oldContentRoot});if(!this.formLoaded){this.getCurrentTicket();this.retrieveProjects();this.retrieveAssignees()}},closeForm:function(){$j.colorbox.close()},getSession:function(callFunction){var callFunction=callFunction||null;var self=this;var doc="body="+clarizenWidgetHelper.getSessionRequest(this.username,this.password,this.partnerID);new Ajax.Request(this.proxyClarizenLoginUrl,{method:"post",postBody:doc,requestHeaders:{Accept:"application/xml",SOAPAction:clarizenWidgetHelper.LOGIN_URL},onSuccess:function(transport){this.extractSessionID(transport.responseXML,callFunction)}.bind(this),onFailure:function(){this.failLoading();alert("Login has Failed")}})},extractSessionID:function(responseXML,callFunction){success=$j(responseXML).find("Success").text()=="true";if(success){this.sessionId=$j(responseXML).find("SessionId").text();this.organizationId=$j(responseXML).find("OrganizationId").text();this.userId=$j(responseXML).find("UserId").text();if(callFunction){callFunction.apply(this)}}else{var faultString=clarizenWidgetHelper.getTextContentByKey(responseXML,"faultstring");this.failLoading();if(faultString!==null&&faultString!==""){alert(faultString)}else{alert("Login has Failed")}}},checkSessionTimeOut:function(responseXML){return clarizenWidgetHelper.getTextContentByKey(responseXML,"faultcode")==="s:SessionTimeout"},getExternalIdByTicketId:function(){var doc="body="+clarizenWidgetHelper.getExternalIdByTicketRequest(this.sessionId,this.ticketId);new Ajax.Request(this.proxyClarizenExecuteUrl,{method:"post",postBody:doc,requestHeaders:{Accept:"application/xml",SOAPAction:clarizenWidgetHelper.EXECUTE_URL},onSuccess:function(transport){if(this.checkSessionTimeOut(transport.responseXML)){this.contentRoot.update("Error communicating with Clarizen.");return false}var typeName=clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"TypeName");if(typeName==="Bug"){this.settings.enableBugs=true}this.externalId=clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"Value");if(!this.externalId){this.showInitial()}else{this.getIssueFromClarizen(true)}}.bind(this),onFailure:function(){this.failLoading();alert("Failed to get Projects List")}.bind(this)})},retrieveProjects:function(){var doc="body="+clarizenWidgetHelper.getProjects(this.sessionId);new Ajax.Request(this.proxyClarizenQueryUrl,{method:"post",postBody:doc,requestHeaders:{Accept:"application/xml",SOAPAction:clarizenWidgetHelper.QUERY_URL},onSuccess:function(transport){if(this.checkSessionTimeOut(transport.responseXML)){this.getSession(this.retrieveProjects);return false}this.populateProjects(this.contentRoot,transport.responseXML)}.bind(this),onFailure:function(){this.failLoading();alert("Failed to get Projects List")}.bind(this)})},populateProjects:function(contentRoot,responseXML){var hasProjects=false;var ddlProjects=$j(contentRoot).find("select.clarizenProjectSelector");ddlProjects.prop("disabled",false);ddlProjects.html("");try{this.ProjectsList=$j(responseXML).find("BaseEntity");hasProjects=(this.ProjectsList.length>0)}catch(e){}if(!hasProjects){$j("<option>").val("").html("").prop("selected",true).appendTo(ddlProjects);return}$j("<option>").val("").html("—select the project—").prop("selected",true).appendTo(ddlProjects);this.ProjectsList.each(function(i,project){$j("<option>").val($j(project).find("Id Value").text()).html(clarizenWidgetHelper.getValue(project,"Name")).appendTo(ddlProjects)})},retrieveAssignees:function(){var doc="body="+clarizenWidgetHelper.getAssigneeRequest(this.sessionId);new Ajax.Request(this.proxyClarizenQueryUrl,{method:"post",postBody:doc,requestHeaders:{Accept:"application/xml",SOAPAction:clarizenWidgetHelper.QUERY_URL},onSuccess:function(transport){if(this.checkSessionTimeOut(transport.responseXML)){this.getSession(this.retrieveAssignees);return false}this.populateAssignees(this.contentRoot,transport.responseXML)}.bind(this),onFailure:function(){this.failLoading();alert("Failed to get Assignee List")}.bind(this)})},populateAssignees:function(contentRoot,responseXML){var ddlAssignees=$j(contentRoot).find("select.clarizenAssigneeSelecter");ddlAssignees.html("");$j("<option>").val("-1").html("—select an assignee—").prop("selected",true).appendTo(ddlAssignees);this.assigneeXml=responseXML;this.AssigneesList=this.AssigneesList||$j(responseXML).find("BaseEntity");this.AssigneesList.each(function(i,assignee){$j("<option>").val($j(assignee).find("Id Value").text()).html(clarizenWidgetHelper.getValue(assignee,"FirstName")+" "+clarizenWidgetHelper.getValue(assignee,"LastName")).appendTo(ddlAssignees)});ddlAssignees.prop("disabled",false);ddlAssignees.disabled=false;if(this.doSelectAssignee){this.selectAssignee()}else{this.doSelectAssignee=true}},selectSeverity:function(priorityId){$j("select.clarizenSeveritySelector").val(clarizenWidgetHelper.PRIORITY_MAPPING[parseInt(priorityId)]||"Medium")},selectAssignee:function(){var nFirstMatchByName=null;var nFirstMatchByEmail=null;if(this.ZendeskTicketAssigneeEmail){this.AssigneesList=this.AssigneesList||$j(this.assigneeXml).find("BaseEntity");this.AssigneesList.each(function(i,assignee){var userId=$j(assignee).find("Id Value").text();var firstName=clarizenWidgetHelper.getValue(assignee,"FirstName");var lastName=clarizenWidgetHelper.getValue(assignee,"LastName");var email=clarizenWidgetHelper.getValue(assignee,"Email");if(!nFirstMatchByName&&firstName&&lastName&&this.ZendeskTicketAssigneeFullname===firstName+" "+lastName){nFirstMatchByName=i+1}if(!nFirstMatchByEmail&&email&&this.ZendeskTicketAssigneeEmail===email){nFirstMatchByEmail=i+1}});var assignees=$j(this.contentRoot).find("select.clarizenAssigneeSelecter");if(nFirstMatchByEmail){assignees.selectedIndex=nFirstMatchByEmail}else{if(nFirstMatchByName){assignees.selectedIndex=nFirstMatchByName}}}},getCurrentTicket:function(){var url="/tickets/"+this.ticketId+".xml";new Ajax.Request(url,{method:"get",requestHeaders:{Accept:"application/xml"},onSuccess:function(transport){if(this.checkSessionTimeOut(transport.responseXML)){this.getSession(this.getCurrentTicket);return false}$j("input.clarizenTitle").val(clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"subject"));$j("textarea.clarizenDescription").val(clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"description"));this.selectSeverity(clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"priority-id"));this.ticketRequesterId=clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"requester-id");this.ticketAssigneeId=clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"assignee-id");this.ticketStatusId=parseInt(clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"status-id"));this.getTicketAssignee(this.ticketAssigneeId);this.getTicketOwner(this.ticketRequesterId)}.bind(this),onFailure:function(){this.failLoading();alert("Failed to retrieve a ticket from Zendesk.")}.bind(this)})},getTicketAssignee:function(userId){if(!userId){return}var url="/users/"+userId+".xml";new Ajax.Request(url,{method:"get",requestHeaders:{Accept:"application/xml"},onSuccess:function(transport){if(this.checkSessionTimeOut(transport.responseXML)){this.getSession(function(){this.getTicketAssignee(userId)});return false}this.ZendeskTicketAssigneeEmail=clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"email");this.ZendeskTicketAssigneeFullname=clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"name");if(this.doSelectAssignee){this.selectAssignee()}else{this.doSelectAssignee=true}}.bind(this),onFailure:function(){this.failLoading();alert("Failed to retrieve a Zendesk User. (3)")}.bind(this)})},getTicketOwner:function(userId){var url="/users/"+userId+".xml";new Ajax.Request(url,{method:"get",requestHeaders:{Accept:"application/xml"},onSuccess:function(transport){if(this.checkSessionTimeOut(transport.responseXML)){this.getSession(function(){this.getTicketOwner(userId)});return false}this.zendeskTicketRequesterEmail=clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"email");this.zendeskTicketRequesterFullName=clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"name")}.bind(this),onFailure:function(){this.failLoading();alert("Failed to retrieve a Zendesk User. (4)")}.bind(this)})},validateForm:function(){if($j("input.clarizenTitle").val()===""){alert("Subject is required");return false}if($j("textarea.clarizenDescription").val()===""){alert("Description is required");return false}if($j("select.clarizenAssigneeSelecter").val()==="-1"){alert("Please select an assignee");return false}var date=$j("input.dueDate").val();if(date!==""&&!/^[0-9]{2}\/[0-9]{2}\/[0-9]{4}$/.test(date)){alert("Invalid date, must be in MM/DD/YYYY format");return false}var selected_date=new Date();selected_date.setFullYear(date.split("/")[2],parseInt(date.split("/")[0])-1,parseInt(date.split("/")[1]));if(selected_date<new Date()){alert("Please select a due date in the future.");return false}if($j("select.clarizenAssigneeSelecter").val()==="-1"&&!this.ticketAssigneeId){alert("This ticket is currently unassigned. Please select an assignee from the list");return false}this.closeForm();return true},submitIssueForm:function(form){if(this.validateForm()){$j("div.clarizen_message").hide();this.showLoading();this.prepareForSubmit()}},prepareForSubmit:function(){var doc="body="+clarizenWidgetHelper.getSystemSettings(this.sessionId);new Ajax.Request(this.proxyClarizenExecuteUrl,{method:"post",postBody:doc,requestHeaders:{Accept:"application/xml",SOAPAction:clarizenWidgetHelper.EXECUTE_URL},onSuccess:function(transport){if(this.checkSessionTimeOut(transport.responseXML)){this.getSession(this.prepareForSubmit);return false}if(clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"Success")==="false"){alert("Failed to get Clarizen Settings ( "+clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"faultstring")+" )")}else{var settings=XmlHelper.getRecords(transport.responseXML,"","anyType");this.settings.enableIssues=clarizenWidgetHelper.getNodeValue(settings[0])==="true"?true:false;this.settings.enableBugs=clarizenWidgetHelper.getNodeValue(settings[1])==="true"?true:false;if(!this.settings.enableBugs&&!this.settings.enableIssues){this.failLoading();alert("Issues and Bugs are disabled in this organization.")}else{this.checkRequesterInClarizen()}}}.bind(this),onFailure:function(){this.failLoading();alert("Failed to get Clarizen Settings.")}.bind(this)})},checkRequesterInClarizen:function(){this.requestorId=null;if(this.zendeskTicketRequesterFullName){var firstNameRequester=this.zendeskTicketRequesterFullName.split(" ")[0];$j(this.AssigneesList).each(function(i,assignee){var clarizenUserFirstName=clarizenWidgetHelper.getValue(assignee,"FirstName");var id=$j(assignee).find("Id Value").text();if(clarizenUserFirstName==firstNameRequester&&id&&this.requestorId===null){this.requestorId=this.clarizenUserIdForPopup=id}})}this.submitIssue()},submitIssue:function(){var assigneeId=this.contentRoot.down("select.clarizenAssigneeSelecter").getValue();var dueDate=this.contentRoot.down("input.dueDate").getValue();var doc="body="+clarizenWidgetHelper.getSubmitFormRequest(this.sessionId,clarizenWidgetUnicodeConverter.convertChar2CP(this.contentRoot.down("input.clarizenTitle").getValue()),clarizenWidgetUnicodeConverter.convertChar2CP(this.contentRoot.down("textarea.clarizenDescription").getValue()),dueDate===""?null:clarizenWidgetHelper.convertDateToXSD(dueDate),this.contentRoot.down("select.clarizenSeveritySelector").getValue(),assigneeId,this.contentRoot.down("select.clarizenProjectSelector").getValue(),assigneeId,this.ticketId,this.isBugMode());new Ajax.Request(this.proxyClarizenExecuteUrl,{method:"post",postBody:doc,requestHeaders:{Accept:"application/xml",SOAPAction:clarizenWidgetHelper.EXECUTE_URL},onSuccess:function(transport){if(this.checkSessionTimeOut(transport.responseXML)){this.getSession(function(){this.submitIssue()});return false}if(clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"Success")==="false"){this.failLoading();alert("An error occured. ("+clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"Message")+")")}else{this.externalId=clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"Value");if(this.ticketStatusId===0){this.getIssueFromClarizen(true)}else{this.changeIssueStatus()}}}.bind(this),onFailure:function(){this.failLoading();alert("Failed to submit issue.")}.bind(this)})},changeIssueStatus:function(){var doc="body="+clarizenWidgetHelper.getUpdateFormRequest(this.sessionId,this.externalId,this.ticketStatusId,this.isBugMode(),this.requestorId);new Ajax.Request(this.proxyClarizenExecuteUrl,{method:"post",postBody:doc,requestHeaders:{Accept:"application/xml",SOAPAction:clarizenWidgetHelper.EXECUTE_URL},onSuccess:function(transport){if(this.checkSessionTimeOut(transport.responseXML)){this.getSession(this.changeIssueStatus);return false}if(clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"Success")==="false"){this.failLoading();alert("An error occured. ("+clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"Message")+")")}else{this.getIssueFromClarizen(true)}}.bind(this),onFailure:function(){this.failLoading();alert("Failed to submit issue.")}.bind(this)})},getIssueFromClarizen:function(){var doc="body="+clarizenWidgetHelper.getIssueFromClarizenQuery(this.sessionId,this.externalId,this.isBugMode());this.contentRoot.update(clarizenWidgetHelper.getLoadingImage());new Ajax.Request(this.proxyClarizenExecuteUrl,{method:"post",postBody:doc,requestHeaders:{Accept:"application/xml",SOAPAction:clarizenWidgetHelper.EXECUTE_URL},onSuccess:function(transport){if(this.checkSessionTimeOut(transport.responseXML)){this.getSession(function(){this.getIssueFromClarizen(insertRequired)});return false}this.parseIssueResponse(transport.responseXML)}.bind(this),onFailure:function(){if(!insertRequired){this.contentRoot.update("")}alert("Failed to get Issue From Clarizen")}.bind(this)})},parseIssueResponse:function(responseXML){var success=clarizenWidgetHelper.getTextContentByKey(responseXML,"Success");if(success!==null&&success!=="false"){this.IssueSysId=clarizenWidgetHelper.getValue(responseXML,"SYSID");this.IssueDueDate=clarizenWidgetHelper.getValue(responseXML,"DueDate");this.IssueState=$j(responseXML).find("TypeName:contains('CaseState')").siblings("Value").text();this.IssueSeverity=$j(responseXML).find("TypeName:contains('Severity')").siblings("Value").text();this.IssuezendeskTicketId=clarizenWidgetHelper.getValue(responseXML,"ZdExternalId");this.IssueAssignedTo=clarizenWidgetHelper.getValue(responseXML,"AssignedTo","DisplayName");this.IssueOwner=clarizenWidgetHelper.getValue(responseXML,"Owner","DisplayName");this.IssueProjectName=clarizenWidgetHelper.getValue(responseXML,"PlannedFor","Name");this.IssueTitle=clarizenWidgetHelper.getValue(responseXML,"Title");this.getZendeskTicket(this.IssuezendeskTicketId)}else{var err=clarizenWidgetHelper.getTextContentByKey(responseXML,"ErrorCode");if(err!==null&&err==="EntityNotFound"){$("issuePlaceHolder").update("");this.externalId=null;this.showInitial()}else{$("issue-details").update("");var faultstring=clarizenWidgetHelper.getTextContentByKey(responseXML,"faultstring");alert(faultstring!==null?faultstring:"Failed to parse Issue response")}}},getZendeskTicket:function(ticketId){var url="/tickets/"+ticketId+".xml";new Ajax.Request(url,{method:"get",requestHeaders:{Accept:"application/xml"},onSuccess:function(transport){if(this.checkSessionTimeOut(transport.responseXML)){this.getSession(function(){this.getZendeskTicket(ticketId)});return false}this.ZendeskUserIdAssigneeId=clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"assignee-id");var ownerId=clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"requester-id");this.getZendeskOwner(ownerId)}.bind(this),onFailure:function(){alert("Failed to retrieve a ticket from Zendesk.")}})},getZendeskOwner:function(userId){var url="/users/"+userId+".xml";new Ajax.Request(url,{method:"get",requestHeaders:{Accept:"application/xml"},onSuccess:function(transport){if(this.checkSessionTimeOut(transport.responseXML)){this.getSession(function(){this.getZendeskOwner(userId)});return false}this.ZendeskUserOwnerEmail=clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"email");if(this.ZendeskUserIdAssigneeId){this.getZendeskUserForProfilePage(this.ZendeskUserIdAssigneeId)}else{this.updateIssueDetails()}}.bind(this),onFailure:function(){alert("Failed to retrieve a Zendesk User. (1)")}})},updateIssueDetails:function(){this.contentRoot.update(clarizenWidgetHelper.getDisplayIssueForm(this.widgetId,this.IssueSeverity,this.IssueSysId,this.IssueState,this.IssueDueDate,this.IssueAssignedTo,this.IssueOwner,this.IssueProjectName,this.IssueTitle,clarizenWidgetUnicodeConverter.convertChar2CP(encodeURIComponent(this.IssueTitle)),window.ticket_id,this.ZendeskUserAssigneeEmail,this.ZendeskUserOwnerEmail)+clarizenWidgetHelper.getAvailabilityLnk(this.widgetId))},updateIssueForm:function(){this.contentRoot.update(clarizenWidgetHelper.getDisplayIssueForm(this.IssueSeverity,this.IssueSysId,this.IssueState,this.IssueDueDate,this.IssueAssignedTo,this.IssueOwner,this.IssueProjectName,this.IssueTitle)+clarizenWidgetHelper.getAvailabilityLnk(this.widgetId))},getZendeskUserForProfilePage:function(userId){var url="/users/"+userId+".xml";new Ajax.Request(url,{method:"get",requestHeaders:{Accept:"application/xml"},onSuccess:function(transport){if(this.checkSessionTimeOut(transport.responseXML)){this.getSession(function(){this.getZendeskUserForProfilePage(userId)});return false}this.ZendeskUserAssigneeEmail=clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"email");var fullName=clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"name").split(" ");if(fullName.length===1){alert("User '"+fullName+"' doesn't have a Last Name, cannot search user in Clarizen")}else{this.getClarizenUserProfile(this.ZendeskUserAssigneeEmail,fullName[0],fullName[1])}if(!this.isUserProfilePage()){this.updateIssueDetails()}}.bind(this),onFailure:function(){if(this.isUserProfilePage()){this.contentRoot.update("")}alert("Failed to retrieve a Zendesk User. (2)")}.bind(this)})},getClarizenUserProfile:function(email,firstName,lastName){var doc="body="+clarizenWidgetHelper.getClarizenUserProfile(this.sessionId,email,firstName,lastName);new Ajax.Request(this.proxyClarizenQueryUrl,{method:"post",postBody:doc,requestHeaders:{Accept:"application/xml",SOAPAction:clarizenWidgetHelper.QUERY_URL},onSuccess:function(transport){if(this.checkSessionTimeOut(transport.responseXML)){this.getSession(function(){this.getClarizenUserProfile(email,firstName,lastName)});return false}this.clarizenUserIdForPopup=clarizenWidgetHelper.getTextContentByKey(transport.responseXML,"Value");if(this.isUserProfilePage()){this.contentRoot.update(this.clarizenUserIdForPopup===null?clarizenWidgetHelper.getProfileNotExistsMessage(firstName):clarizenWidgetHelper.getAvailabilityLnkForProfilePage(this.widgetId))}}.bind(this),onFailure:function(){if(this.isUserProfilePage()){this.contentRoot.update("")}alert("Failed to get Clarizen User Profile")}.bind(this)})}});var FreshbooksHelper={STAFF_FORM:new Template('<form class="form" id="freshbooks-form-#{widget_id}"> <label>Select user</label><select name="staff_id" id="freshbooks-form-staff-id" onchange="ObjectFactory.get(#{widget_id}).staffSelector(this.options[this.selectedIndex].value)"></select> <br/><input type="submit" disabled="disabled" id="freshbooks-submit" value="Sign in" onclick="ObjectFactory.get(#{widget_id}).saveStaffId($(\'freshbooks-form-#{widget_id}\'));return false;"></form>'),SUBMIT_FORM:new Template('<form class="form" id="freshbooks-form-#{widget_id}"> <label>Select project</label><select name="project_id" id="freshbooks-form-projects" onchange="ObjectFactory.get(#{widget_id}).projectsSelector(this.options[this.selectedIndex].value)"></select> <img src="/images/indicator2.gif" id="freshbooks-project-spinner" style="display:none;" /> <label>Select task</label><select disabled name="task_id" id="freshbooks-form-tasks" onchange="ObjectFactory.get(#{widget_id}).tasksSelector(this.options[this.selectedIndex].value)"></select> <img src="/images/indicator2.gif" id="freshbooks-task-spinner" style="display:none;" /> <label>Notes</label><textarea disabled name="freshbooks-form-notes" id="freshbooks-form-notes" wrap="virtual" style="width:190px; height: 50px;">#{default_note}</textarea> <label>Hours</label><input type="text" disabled name="freshbooks-form-hours" id="freshbooks-form-hours" style="width:50px"> <br/><input type="submit" disabled id="freshbooks-form-submit" style="margin-top: 10px;" value="Submit" onclick="ObjectFactory.get(#{widget_id}).submitTimeSpent($(\'freshbooks-form-#{widget_id}\'));return false;"> <span class="link" style="font-weight:normal;margin-left:20px;" onclick="ObjectFactory.get(#{widget_id}).logout()">(logout)</span></form>'),GET_TASKS:new Template('<?xml version="1.0" encoding="utf-8"?> <request method="task.list" >   <project_id>#{project_id}</project_id>   <page>1</page>   <per_page>100</per_page> </request>'),GET_STAFF:new Template('<?xml version="1.0" encoding="utf-8"?><request method="staff.list"></request>'),POST_HOURS:new Template('<?xml version="1.0" encoding="ISO-8859-1"?><request method="time_entry.create">  <time_entry>    <project_id>#{project_id}</project_id>    <task_id>#{task_id}</task_id>    <hours>#{hours}</hours>    <notes><![CDATA[#{notes}]]></notes>    <staff_id>#{staff_id}</staff_id>  </time_entry></request>'),ERROR_MESSAGE:new Template("An error occured:\n\n#{error}\n\nSee https://support.zendesk.com/forums/4372 for troubleshooting\n\nor contact Freshbooks support at support@freshbooks.com"),getTasksRequest:function(project_id){return escape(this.GET_TASKS.evaluate({project_id:project_id}))},getProjectsRequest:function(page){var template=new Template('body=<?xml version="1.0" encoding="utf-8"?><request method="project.list">  <page>#{page}</page>  <per_page>100</per_page></request>');return template.evaluate({page:page})},getClientsRequest:function(page){var template=new Template('body=<?xml version="1.0" encoding="utf-8"?><request method="client.list">  <page>#{page}</page>  <per_page>100</per_page></request>');return template.evaluate({page:page})},postHoursRequest:function(staff_id,project_id,task_id,notes,hours){return escape(this.POST_HOURS.evaluate({staff_id:staff_id,project_id:project_id,task_id:task_id,notes:notes,hours:hours}))},getStaffRequest:function(){return escape(this.GET_STAFF.evaluate({}))},buildClientList:function(clients){var clientList={};clients.each(function(client){var id=$j(client).find("client_id").text();var organization=$j(client).find("organization").text();clientList[id]=organization});return clientList},populateProjects:function(projects,clients){var select=$j("#freshbooks-form-projects");select.text("");select.append($j("<option>"));projects.each(function(project){var option=$j("<option>");var name=$j(project).find("name").text();var client_id=$j(project).find("client_id").text();var client=clients[client_id];if(client){name=name+" - "+client}option.attr("value",$j(project).find("project_id").text());option.text(name);select.append(option)});$j("#freshbooks-project-spinner").hide()},populateStaff:function(records){$("freshbooks-form-staff-id").update("");$("freshbooks-form-staff-id").appendChild(new Element("option"));for(i=0;i<records.length;i++){var option=new Element("option");option.value=FreshbooksHelper.getNodeString(records[i],"staff_id");option.innerHTML=FreshbooksHelper.getNodeString(records[i],"first_name")+" "+FreshbooksHelper.getNodeString(records[i],"last_name");$("freshbooks-form-staff-id").appendChild(option)}},populateTasks:function(records){$("freshbooks-form-tasks").update("");$("freshbooks-form-tasks").appendChild(new Element("option"));for(i=0;i<records.length;i++){var option=new Element("option");option.value=FreshbooksHelper.getNodeString(records[i],"task_id");option.innerHTML=FreshbooksHelper.getNodeString(records[i],"name");$("freshbooks-form-tasks").appendChild(option)}$j("#freshbooks-task-spinner").hide();$("freshbooks-form-tasks").enable()},getNodeValue:function(document,nodeName){var node=document.getElementsByTagName(nodeName);if(node==null||node.length==0){return null}if(node[0].childNodes[0]==null){return""}return node[0].childNodes[0].nodeValue},getNodeString:function(document,nodeName){return this.getNodeValue(document,nodeName)||""},getNodeAttribute:function(document,nodeName,attr){var node=document.getElementsByTagName(nodeName);if(node==null||node.length==0){return null}return node[0].getAttribute(attr)||null},getRecords:function(document,tagname){return document.getElementsByTagName(tagname)||new Array()},checkStatus:function(xml){var records=FreshbooksHelper.getRecords(xml,"response");if(records.length>0){var text=FreshbooksHelper.getNodeString(records[0],"error");if(text!=""){alert(FreshbooksHelper.ERROR_MESSAGE.evaluate({error:text}));return false}}return true}};var FreshbooksWidget=Class.create(Widget,{initialize:function($super,args){$super(args);this.url=args.url;if(!this.url.match(/^http/)){this.url="http://"+this.url}this.formInstance=null;this.ticket_id=args.ticket_id;this.default_note=args.default_note;this.apikey=args.apikey;this.staff_id="";this.subject=args.subject;this.contentRoot=this.containingElement().down("div.freshbooks-content");this.clients=null;this.apiUrl=this.buildApiUrl();this.setup()},setup:function(){this.staff_id=Zendesk.SettingsCookie.get("freshbooks_staff_id")||"";if(this.staff_id==""){this.contentRoot.update(FreshbooksHelper.STAFF_FORM.evaluate({widget_id:this.id}));this.loadStaff()}else{this.buildForm()}},saveApiKey:function(submittedForm){this.formInstance=submittedForm;Zendesk.SettingsCookie.set("freshbooks_api_key",$("freshbooks-form-apikey").value);this.setup()},logout:function(){Zendesk.SettingsCookie.set("freshbooks_staff_id","");this.staff_id="";this.setup()},buildForm:function(){var default_note=this.defaultNote();this.contentRoot.update(FreshbooksHelper.SUBMIT_FORM.evaluate({widget_id:this.id,default_note:default_note,ticket_id:this.ticket_id}));this.loadClients(1,[])},buildApiUrl:function(){var path="/proxy/direct?&url=#{url}&timeout=10";var template=new Template(path);return template.evaluate({url:this.url})},defaultNote:function(){var ticket={id:this.ticket_id,title:this.subject};var object={ticket:ticket,ticket_id:this.ticket_id};return Zd.Util.parseTemplate(this.default_note,object)},loadStaff:function(){var body="body="+FreshbooksHelper.getStaffRequest();new Ajax.Request(this.apiUrl,{method:"post",postBody:body,requestHeaders:{Accept:"application/xml",Authorization:"Basic "+Base64.encode(this.apikey+":x")},onSuccess:function(transport){if(FreshbooksHelper.checkStatus(transport.responseXML)){this.showStaff(transport.responseXML)}}.bind(this),onFailure:function(){alert("Failed to retrieve Freshbooks staff list.")}})},loadClients:function(page,clients){var body=FreshbooksHelper.getClientsRequest(page);var self=this;var credentials=Base64.encode(this.apikey+":x");$j.ajax({type:"POST",beforeSend:function(xhr){xhr.setRequestHeader("Authorization","Basic "+credentials)},url:this.apiUrl,data:body,success:function(data){self.handleLoadClients(clients,data)}})},handleLoadClients:function(clients,data){var page=parseInt($j(data).find("clients").attr("page"));var pages=parseInt($j(data).find("clients").attr("pages"));$j.merge(clients,$j(data).find("client"));if(page<pages){this.loadClients(page+1,clients)}else{this.clients=FreshbooksHelper.buildClientList(clients);this.loadProjects(1,[])}},loadProjects:function(page,projects){var body=FreshbooksHelper.getProjectsRequest(page);var self=this;$j("#freshbooks-project-spinner").show();var credentials=Base64.encode(this.apikey+":x");$j.ajax({type:"POST",beforeSend:function(xhr){xhr.setRequestHeader("Authorization","Basic "+credentials)},url:this.apiUrl,data:body,success:function(data){self.handleLoadProjects(projects,data)}})},handleLoadProjects:function(projects,data){var page=parseInt($j(data).find("projects").attr("page"));var pages=parseInt($j(data).find("projects").attr("pages"));$j.merge(projects,$j(data).find("project"));if(page<pages){this.loadProjects(page+1,projects)}else{FreshbooksHelper.populateProjects(projects,this.clients)}},projectsSelector:function(id){this.loadTasks(id)},staffSelector:function(id){if($("freshbooks-form-staff-id").value>""){$("freshbooks-submit").enable()}else{$("freshbooks-submit").disable()}},saveStaffId:function(submitted_form){Zendesk.SettingsCookie.set("freshbooks_staff_id",$("freshbooks-form-staff-id").value);this.setup()},loadTasks:function(project_id){var body="body="+FreshbooksHelper.getTasksRequest(project_id);$j("#freshbooks-form-tasks").text("");$j("#freshbooks-task-spinner").show();new Ajax.Request(this.apiUrl,{method:"post",postBody:body,requestHeaders:{Accept:"application/xml",Authorization:"Basic "+Base64.encode(this.apikey+":x")},onSuccess:function(transport){if(FreshbooksHelper.checkStatus(transport.responseXML)){this.showTasks(transport.responseXML)}}.bind(this),onFailure:function(){alert("Failed")}})},tasksSelector:function(id){$("freshbooks-form-notes").enable();$("freshbooks-form-hours").enable();$("freshbooks-form-submit").enable()},showStaff:function(xml){if($("freshbooks-form-staff-id").options.length==0){var records=FreshbooksHelper.getRecords(xml,"member");FreshbooksHelper.populateStaff(records)}},showTasks:function(xml){var records=FreshbooksHelper.getRecords(xml,"task");FreshbooksHelper.populateTasks(records)},submitTimeSpent:function(submittedForm){var hours=parseFloat(submittedForm["freshbooks-form-hours"].value);if(isNaN(hours)){alert("Please enter a valid value for hours");return false}var body="body="+FreshbooksHelper.postHoursRequest(this.staff_id,$("freshbooks-form-projects").value,$("freshbooks-form-tasks").value,$("freshbooks-form-notes").value,$("freshbooks-form-hours").value);new Ajax.Request(this.apiUrl,{method:"post",postBody:body,requestHeaders:{Accept:"application/xml",Authorization:"Basic "+Base64.encode(this.apikey+":x")},onSuccess:function(transport){if(FreshbooksHelper.checkStatus(transport.responseXML)){this.resetForm()}}.bind(this),onFailure:function(){alert("Failed")}});return false},resetForm:function(){var default_note=this.defaultNote();$("freshbooks-form-hours").value="";$("freshbooks-form-notes").value=default_note;$("freshbooks-form-notes").focus()}});var HighriseWidget=Class.create(Widget,{initialize:function($super,args){$super(args);var default_contact_email=args.email;var domain=args.domain;var user=args.username;var pass="X";var use_ssl=args.use_ssl;var highrise_host="http"+((use_ssl=="true")?"s":"")+"://"+domain;var MAX_RESULTS=10;var name=args.name.split(" ");var requester={first_name:name[0],last_name:name.slice(1).join(" "),email:args.email,organization:args.organization_name||"",phone:args.phone||""};var contactDetails;var login=function(){return'<form id="highrise-login-form" class="form"><label>Enter your highrise token</label><input type="text" class="text" id="username"/><input type="hidden" name="password" value="X"/><input type="submit" name="submit" class="button primary" value="Login" ></form>'};var application=function(){return'<div id="highrise-display"></div><div id="highrise-status"></div><div id="highrise-search">'+renderSearch()+"</div>"};var setDisplay=function(content){$("highrise-display").update(content)};var setStatus=function(content){$("highrise-status").update(content)};var renderApplication=function(response){initOverLabels();var login_form=$("highrise-login-form");var search_form=$("highrise-search-form");if(search_form){search_form.observe("submit",function(event){event.stop();doHighriseSearch()})}if(!default_contact_email){setDisplay(formatNoRequesterFound());return}if(login_form){login_form.observe("submit",function(event){event.stop();highrise_resource.submit_credentials(this)})}var people=response.people;if(!people){renderCreateHighriseContact()}else{if(people.length===1){setDisplayPerson(people.first())}else{list_contact_data=function(people){var formattedPeople=people.collect(function(p){return renderUserLinkListItem(p)});return'<div id="multi-match">We found <strong>'+formattedPeople.length+'</strong> profiles with this email:<ul id="highrise-people-list" class="options"><li class="user">'+formattedPeople.join("</li><li>")+"</li></ul><em>Tip: consider merging in Highrise</em></div>"};setDisplay(list_contact_data(people))}}};var setDisplayPerson=function(person){contactDetails=new HighriseContactDetails(person,displayPerson);contactDetails.redraw()};var renderCreateHighriseContact=function(){setDisplay(formatNoHighriseContact(default_contact_email));$("highrise-create-contact-link").observe("click",function(event){event.preventDefault();new HighriseCreateUser(requester.first_name,requester.last_name,requester.organization,requester.email,requester.phone)})};var renderUserLinkListItem=function(p){return'<li class="user">'+anchorLink(p.first_name+(p.last_name?" "+p.last_name:""),highrise_host+"/people/"+p.id)+"</li>"};var encodeParam=function(key,value,first){return(!first?"&":"")+encodeURIComponent(key)+"="+encodeURIComponent(value)};var displayPerson=function(person){setDisplay(formatPersonData(person));$("highrise-addnote-link").observe("click",function(event){event.preventDefault();$("highrise-addnote-form").show();$("highrise-addnote-text").focus()});$("highrise-addnote-form").observe("reset",function(event){$("highrise-addnote-form").hide()});$("highrise-addnote-form").observe("submit",function(event){event.stop();var url=encodeURI("/proxy.js");var formText=$F("highrise-addnote-text");if(formText==""){setStatus("Note body is empty!");return}var parameters=encodeParam("domain",highrise_resource.options.domain,true)+encodeParam("use_ssl",highrise_resource.options.use_ssl)+encodeParam("resource","people/"+person.id+"/notes.xml")+encodeParam("media_type","application/xml")+encodeParam("pluck_param","note")+encodeParam("note[body]",formText);new Ajax.Request(url,{method:"post",requestHeaders:{Accept:"application/xml",Authorization:"Basic "+Base64.encode(highrise_resource.options.user+":"+highrise_resource.options.pass)},parameters:parameters,onSuccess:function(transport){$("highrise-addnote-link").update("<strong>Note Added</strong> - Create another");this.reset();this.hide()}.bind(this),onFailure:function(response){setStatus("Note creation failed!")}})})};var formatNoRequesterFound=function(){var result='<p class="center">No requester on this page</p>';return result};var formatNoHighriseContact=function(email){var result='<p class="center">No contact found for this email</p>';result+='<p class="center"><a id="highrise-create-contact-link">Add this Zendesk user to Highrise</a></p>';return result};var renderSearch=function(){return'<form id="highrise-search-form" class="form"><div id="highrise-search-box"><label for="highrise-search-box-field" class="overlabel">Find a Contact or Company</label><input id="highrise-search-box-field" type="text" name="search" title="Find a Contact or Company" value="" tabindex="1" /></div><input type="submit" id="submit" class="button small primary wide" value="Search in Highrise" /></form>'};var doHighriseSearch=function(){var form=$("highrise-search-form");var searchBox=form.search;var searchTerm=$F(searchBox);if(searchTerm===""){setStatus("Search is empty")}else{var search=new HighriseSearch(searchTerm);search.searchNext()}};var actionOpenPage=function(URL){return"window.open('"+URL+"', '_new')"};var spanLink=function(label,onclick){return'<span class="link" onclick="'+onclick+'">'+label+"</span>"};var anchorLink=function(label,href){return'<a class="link" href="'+href+'" target="_blank">'+label+"</a>"};var formatPersonData=function(person){var host=highrise_host;var result="";var name=anchorLink(person.first_name+(person.last_name?" "+person.last_name:""),host+"/people/"+person.id);if(person.title){name+="<br />("+person.title+")"}if(person.company_name){var company=anchorLink(person.company_name,host+"/companies/"+person.company_id)}var emails;if(person.contact_data.email_addresses){emails=person.contact_data.email_addresses.collect(function(s){return anchorLink(s.address,"mailto:"+s.address)+" ("+s.location+")"})}var phoneNumbers;if(person.contact_data.phone_numbers){phoneNumbers=person.contact_data.phone_numbers.collect(function(s){return s.number+"("+s.location+")"})}var twitterAccounts;if(person.contact_data.twitter_accounts){twitterAccounts=person.contact_data.twitter_accounts.collect(function(s){return anchorLink("@"+s.username,s.url)+" ("+s.location+")"})}var noteForm='<form id="highrise-addnote-form" style="display: none;"><textarea id="highrise-addnote-text"></textarea><div style="clear:both;"><input type="reset" class="button small left" value="Cancel" id="highrise-addnote-cancel"><input type="submit" value="Save note" id="highrise-addnote-submit" class="button small primary right"></div><div class="clear"></div></form>';result+='<ul class="options">';if(name){result+='<li class="user">'+name+"</li>"}if(company){result+="<li>"+company+"</li>"}if(emails){result+='<li class="email">'+emails.join('</li><li class="email">')+"</li>"}if(phoneNumbers){result+='<li class="phone">'+phoneNumbers.join('</li><li class="phone">')+"</li>"}if(twitterAccounts){result+='<li class="twitter">'+twitterAccounts.join('</li><li class="twitter">')+"</li>"}result+='<li class="add-link"><a id="highrise-addnote-link"><strong>Add a note to '+person.first_name+"</strong></a></li>";result+="</ul>";result+=noteForm;return result};var HighriseSearch=Class.create({initialize:function(searchTerm){this.searching=true;this.encodedSearchTerm=encodeURI(searchTerm);this.searchTerm=searchTerm;this.searchFields=["name","title","email","city","state","country","zip","street","phone","background"];this.searchResults={};this.searchResultsOrder=[];this.maxResults=MAX_RESULTS;this.page=0},searchNext:function(){var hasNumbers=function(t){var regex=/\d/g;return regex.test(t)};this.page=0;if(this.searchFields.length>0){this.currentSearchField=this.searchFields.shift();if(this.currentSearchField=="phone"&&!hasNumbers(this.searchTerm)){this.searchNext()}var resource="parties/search.xml?"+this.currentSearchField+"="+this.encodedSearchTerm;highrise_resource.request({resource:resource,on_success:this.onSearchResponse.bind(this)})}else{this.cleanUp()}},searchPaginated:function(){this.page++;var resource="parties/search.xml?n="+this.page+"&"+this.currentSearchField+"="+this.encodedSearchTerm;highrise_resource.request({resource:resource,on_success:this.onSearchResponse.bind(this)})},onSearchResponse:function(response){var parties=$A(response.parties);if(!this.searching){return}if(parties){if(parties.length>0){parties.each(function(p){if(!Object.isUndefined(p.id)&&Object.isUndefined(this.searchResults[p.id])){this.searchResults[p.id]=p;this.searchResultsOrder.push(p.id)}},this);this.updateSearchOutput()}if(parties.length==25){this.searchPaginated()}else{this.searchNext()}}else{this.searchNext()}},updateSearchOutput:function(){if(this.searchResults){var renderedResults=[];var searchField=$("highrise-search-box-field");this.searchResultsOrder.each(function(id){var p=this.searchResults[id];if(renderedResults.length<this.maxResults){if(p.first_name){renderedResults.push(renderUserLinkListItem(p))}else{if(p.name){renderedResults.push('<li class="organisation">'+anchorLink(p.name,highrise_host+"/companies/"+p.id)+"</li>")}}}},this);setDisplay('<div id="results"><p>Search results <strong>('+this.searchResultsOrder.length+')</strong></p><ul class="options">'+renderedResults.join("")+"</ul>"+((renderedResults.length<this.maxResults)?"":"<div>Only showing "+this.maxResults+" of "+this.searchResultsOrder.length+" results.</div>")+'<p><a id="highrise-search-back">&larr; Back</a></p>');searchField.focus();$("highrise-search-back").observe("click",function(event){event.preventDefault();this.cleanUp("");showHighriseContact();searchField.focus();searchField.value=""}.bind(this))}},cleanUp:function(status){this.searching=false;setStatus(status)}});var showHighriseContact=function(){highrise_resource.request({resource:"people/search.xml?criteria[email]="+encodeURI(default_contact_email),on_success:renderApplication})};var HighriseContactDetails=Class.create({initialize:function(person,render){this.person=person;this.render=render},getCompany:function(){if(Object.isUndefined(this.person.company_id)||this.person.company_id==null){this.person.company_name=""}else{highrise_resource.request({resource:"companies/"+this.person.company_id+".xml",on_success:(function(response){this.person.company_name=response.name;this.redraw()}).bind(this)})}},redraw:function(){this.render(this.person)}});var HighriseCreateUser=Class.create({initialize:function(firstName,lastName,company,email,phoneNumber){this.firstName=firstName;this.lastName=lastName;this.company=company;this.email=email;this.phoneNumber=phoneNumber;this.makeApiRequest()},makeApiRequest:function(){var url=encodeURI("/proxy.js");var parameters=encodeParam("domain",highrise_resource.options.domain,true)+encodeParam("use_ssl",highrise_resource.options.use_ssl)+encodeParam("resource","people.xml")+encodeParam("media_type","application/xml")+encodeParam("pluck_param","person")+encodeParam("person[first-name]",this.firstName)+encodeParam("person[last-name]",this.lastName)+encodeParam("person[company-name]",this.company)+encodeParam("person[contact-data][email-addresses][email-address][address]",this.email)+encodeParam("person[contact-data][email-addresses][email-address][location]","Work")+encodeParam("person[contact-data][phone-numbers][phone-number][number]",this.phoneNumber)+encodeParam("person[contact-data][phone-numbers][phone-number][location]","Work");new Ajax.Request(url,{method:"post",requestHeaders:{Accept:"application/xml",Authorization:"Basic "+Base64.encode(highrise_resource.options.user+":"+highrise_resource.options.pass)},parameters:parameters,onSuccess:function(transport){setDisplayPerson(transport.responseText.evalJSON().response.person)},onFailure:function(transport){setStatus("Error: Could not create user!")}})}});var initOverLabels=function(){var labels,id,field;labels=document.getElementsByTagName("label");for(var i=0;i<labels.length;i++){if(labels[i].className=="overlabel"){id=labels[i].htmlFor||labels[i].getAttribute("for");if(!id||!(field=document.getElementById(id))){continue}labels[i].className="overlabel-apply";if(field.value!==""){hideLabel(field.getAttribute("id"),true)}field.onfocus=function(){hideLabel(this.getAttribute("id"),true)};field.onblur=function(){if(this.value===""){hideLabel(this.getAttribute("id"),false)}};labels[i].onclick=function(){var id,field;id=this.getAttribute("for");if(id&&(field=$(id))){field.focus()}}}}};var hideLabel=function(field_id,hide){var field_for;var labels=document.getElementsByTagName("label");for(var i=0;i<labels.length;i++){field_for=labels[i].htmlFor||labels[i].getAttribute("for");if(field_for==field_id){labels[i].style.display=(hide)?"none":"";return true}}};var dumpProps=function(obj,parent){for(var i in obj){if(parent){var msg=parent+"."+i+"\n"+obj[i]}else{var msg=i+"\n"+obj[i]}if(!confirm(msg)){return}if(typeof obj[i]=="object"){if(parent){dumpProps(obj[i],parent+"."+i)}else{dumpProps(obj[i],i)}}}};if(!default_contact_email){var highrise_resource=new Zendesk.Resource({anchor:"highrise-lookup",domain:domain,user:user,pass:pass,use_ssl:use_ssl,application_content:application,login_content:login,application_resources:[]});renderApplication()}else{var highrise_resource=new Zendesk.Resource({anchor:"highrise-lookup",domain:domain,user:user,pass:pass,use_ssl:use_ssl,application_content:application,login_content:login,application_resources:[{resource:"people/search.xml?criteria[email]="+encodeURI(default_contact_email),on_success:renderApplication}]})}var login_form=$("highrise-login-form");if(login_form){login_form.observe("submit",function(event){event.stop();highrise_resource.submit_credentials(this)})}}});var LogMeInWidget=Class.create(Widget,{initialize:function($super,args){$super(args);this.SSOID=args.SSOID;this.SSOpwd=args.SSOpwd;this.SSOcompid=args.SSOcompid;this.ticket_id=args.ticket_id?args.ticket_id:"";this.ticket_token=args.token?args.token:"";this.widget_id=args.widget_id;this.cookie_name="logmein_auth_"+this.widget_id;this.secret=args.secret;this.subdomain=args.subdomain;this.cfield_values=args.cfield_values;this.newTicket=args.newTicket;logmein=this;this.getLoginTicket()},isError:function(error,errorArray){return jQuery.inArray(error,errorArray)>=0},setExternalLink:function(){if(this.newTicket){$j.ajax({type:"get",dataType:"html",url:"/integrations/logmein_rescue/get_token.js",success:function(data){$j("#ticket-chat").append("<input name='ticket[external_links][][type]' id='external_link_type' type='hidden' value='LogMeInRescueSession' />");$j("#ticket-chat").append("<input name='ticket[external_links][][session_id]' id='external_link_session' type='hidden' value='"+data+"' />");this.ticket_token=data}})}},getLoginTicket:function(){$j("#loading_area").show();var url="/proxy/direct?url="+encodeURIComponent("https://secure.logmeinrescue.com/sso/getloginticket.aspx?ssoid="+this.SSOID+"&password="+this.SSOpwd+"&companyid="+this.SSOcompid);$j.ajax({type:"get",dataType:"html",url:url,success:function(data){$j("#loading_area").hide();if(data.split(":")[0]=="OK"){var link=data.substring(3);$j("span#tech_console_link").html('<br/><a href="'+link+'" target="_blank"><strong>Launch Technician Console</strong></a>');$j("#tech_console_area").show();if(!Zendesk.SettingsCookie.get(this.cookie_name)){$j("#login_area").show()}else{$j("#pin_area").show()}}else{errors=data.split(":");$j("#tech_console_area").hide();if(this.isError("INVALIDSSOID",errors)){logmein.err("Your Rescue Single Sign-On ID must match your Zendesk primary email address.")}else{if(this.isError("INVALID",errors)){logmein.err("You are not authorized to login.")}else{if(this.isError("INVALIDPASSWORD",errors)){logmein.err("Invalid single sign-on password.")}else{logmein.err("Error accessing the Technician Console single sign-on link.")}}}$j("error_area").show()}}.bind(this)})},checkAuth:function(){var un,pw;logmein.err(false);$j("#ticket_place").html("");$j("#pin").text("");if(Zendesk.SettingsCookie.get(this.cookie_name)){this.getPIN(Zendesk.SettingsCookie.get(this.cookie_name));return}else{un=document.getElementById("logmein_username").value;pw=document.getElementById("logmein_password").value;if(un==""&&pw==""){logmein.err("Please enter the username and password");$j("#login_area").show();return}}var url="/proxy/direct?url="+encodeURIComponent("https://secure.logmeinrescue.com/api/requestauthcode.aspx?email="+un+"&pwd="+pw);$j.ajax({type:"get",dataType:"html",url:url,success:function(data){data=data.split(":");if(data[0]=="ERROR"||data[0]=="INVALID"){logmein.err("The username and/or password you've entered is incorrect.");return}else{var auth=data[1];Zendesk.SettingsCookie.set(this.cookie_name,auth);$j("#login_area").hide();$j("#pin_area").show();return}}.bind(this)})},getPIN:function(auth){$j("#pin").hide();$j("#pin_placeholder").hide();$j("#pin_loader").show();fields=this.widget_id+"|"+this.ticket_id+"|"+this.ticket_token+"|"+this.subdomain+"|"+this.secret;this.setExternalLink();var url="/proxy/direct?url="+encodeURIComponent("https://secure.logmeinrescue.com/api/requestpincode.aspx?notechconsole=1&authcode="+auth+"&tracking0="+fields+"&"+this.cfield_values);$j.ajax({url:url,type:"get",dataType:"html",success:function(data){$j("#pin_loader").hide();data=data.split(":");if(data[0].replace(/^\s*|\s*$|\n*/g,"")=="OKPINCODE"){$j("#pin").text(data[1]);$j("#pin").show();$j("#login_area").hide();var new_msg="https://secure.logmeinrescue.com/Customer/Code.aspx?Code="+data[1];$j("#ticket_place").html("<a href='javascript:void(0)' onclick='logmein.comment_update(\"Click this link to launch a remote session: "+new_msg+"\")' ><strong>&laquo;</strong> Copy to ticket</a>");logmein.err(false);$j("#submit_type").val("")}else{switch(data[0]){case"ERROR":logmein.err("There was an error trying to get the PIN, please try again or contact the admin if the problem persists.");break;case"NOTLOGGEDIN":logmein.err("Unable to login, please verify your username and password.");break;case"NOTECHCONSOLERUNNING":logmein.err("Please run the Technician Console before requesting a PIN.");break;case"OUTOFPINCODES":logmein.err("LogMeIn Rescue is out of PIN codes.");break;case"INVALID_SECRETAUTHCODE":logmein.err("The authentication code you've obtained is invalid or has expired, try logging in again.");Zendesk.SettingsCookie.erase(this.cookie_name);$j("#pin_area").hide();$j("#login_area").show();break;case"USER_IS_DELETED":logmein.err("This user has been deleted.");break;case"TECHNICIAN_NOT_EXISTS":logmein.err("This technician does not exist.");break;case"USER_DELETED_OR_DISABLED":logmein.err("This user has been deleted or disabled.");break;default:logmein.err("Error when requesting a PIN.");break}}}.bind(this)})},err:function(msg){$j("#error_area").show();msg?$j("#error_area").text("Error: "+msg):$j("#error_area").text("")},comment_update:function(new_msg){old_msg=$j("#comment_value").val();$j("#comment_value").val(old_msg+" "+new_msg)}});if(!Zd){var Zd={}}Zd.Util={parseTemplate:function(string,object){var rubyResult=this.rubyStyle(string,object);var finalResult=this.mustacheStyle(rubyResult,object);return finalResult},rubyStyle:function(string,object){var template=new Template(string);return template.evaluate(object)},mustacheStyle:function(string,object){var syntax=/(^|.|\r|\n)(\{\{\s*([\w\\.]+)\s*\}\})/;var template=new Template(string,syntax);return template.evaluate(object)},pluralize:function(word,number){if(number==1){return word}return word+"s"}};Zendesk.NS("Forums.Search.Autocomplete",this.jQuery,function($j){var options={autocomplete:false},autocomplete=this;var KEYCODE_MAP={ENTER:13,ESC:27,DOWN:40,UP:38};function isKey(evt,name){return KEYCODE_MAP[name]===evt.keyCode}function evtHandled(evt){evt.stopPropagation();evt.preventDefault();return true}var formId,inputId;function getForm(){return $j("#"+formId)}function getSearchInput(){return $j("#"+formId+" input#"+inputId)}function getAcList(){return $j("#"+acListId)}function isActive(){return options.autocomplete&&getSearchInput().length>0}var acListId="forum_search_autocomplete";function createAcList(){$j("<div/>").attr("id",acListId).addClass("autocomplete").hide().appendTo(getSearchInput().parent())}function install(){createAcList();autocomplete.currentAutocompleter=new Autocompleter.Json(inputId,acListId,rateLimitedTypeaheadSearch.curry(new Autocompleter.RateLimiting()),{frequency:0.2,minChars:1,choices:5,updateElement:function(selectedElement){var $input=getSearchInput();if(selectedElement){$input.val(selectedElement.textContent||selectedElement.innerText)}getForm().submit()}});overrideDefaultBehaviour.call(autocomplete.currentAutocompleter)}function rateLimitedTypeaheadSearch(rateLimiter,query,callback){rateLimiter.schedule(typeaheadSearch,query,callback);autocomplete.currentAutocompleter.query=query}var lastQuery;function typeaheadSearch(query,callback){lastQuery=query;$j.ajax({url:"/search/typeahead?query="+query}).done(function(list){if(lastQuery!==query){return}callback(list.pluck("value"));replaceQueryWithBold(query)})}function replaceQueryWithBold(query){$j("#"+acListId).find("ul li").each(function(){var $li=$j(this),liText=$li.text(),newLiHtml;newLiHtml=liText.replace(query,"<b>"+query.escapeHTML()+"</b>");$li.html(newLiHtml)})}function overrideDefaultBehaviour(){this.updateChoices=function(choices){if(!this.changed&&this.hasFocus){this.update.innerHTML=choices;Element.cleanWhitespace(this.update);Element.cleanWhitespace(this.update.down());if(this.update.firstChild&&this.update.down().childNodes){this.entryCount=this.update.down().childNodes.length;for(var i=0;i<this.entryCount;i++){var entry=this.getEntry(i);entry.autocompleteIndex=i;this.addObservers(entry)}}else{this.entryCount=0}this.stopIndicator();this.update.scrollTop=0;this.index=null;if(this.entryCount==1&&this.options.autoSelect){this.selectEntry();this.hide()}else{this.render()}}};this.render=function(){if(this.entryCount>0){for(var i=0;i<this.entryCount;i++){Element.removeClassName(this.getEntry(i),"selected");if(this.index!==null&&this.index===i){Element.addClassName(this.getEntry(i),"selected")}}if(this.hasFocus){this.show();this.active=true}}else{this.active=false;this.hide()}};this.markPrevious=function(){if(this.index===null){this.index=this.entryCount-1}else{if(this.index>0){this.index--}else{this.index=null}}this.previewSuggestion()};this.markNext=function(){if(this.index===null){this.index=0}else{if(this.index<this.entryCount-1){this.index++}else{this.index=null}}this.previewSuggestion()};this.previewSuggestion=function(){var suggestion=this.getCurrentEntry(),input=this.element;if(suggestion){input.value=suggestion.textContent||suggestion.innerText}else{input.value=this.query}}}function setup(params){options=params;if(options.forumsSearch){formId="searchform";inputId="query"}else{if(options.homePageSearch){formId="suggest_form";inputId="suggestions_query"}}if(!isActive()){return}install()}this.isActive=isActive;this.setup=setup});Zendesk.NS("Forums.Search.Instant",this.jQuery,this.I18n,function($j,I18n){var options={perPage:5,focusOnLoad:false,searchScopes:[],tracking:true};var KEYCODE_MAP={ENTER:13,ESC:27,DOWN:40,UP:38};function isKey(evt,name){return KEYCODE_MAP[name]===evt.keyCode}function evtHandled(evt){evt.stopPropagation();evt.preventDefault();return true}var inputController={element:function(){return this.form().find("#query")},val:function(){return this.element().val()},form:function(){return $j("#searchform")},searchUrl:function(){return this.form().attr("action")},icon:function(){return this.form().find("#icon")},scopeSelector:function(){return this.form().find("div.search_scope_selector")},setup:function(){$j(window).bind("keydown",this.onWindowKeyDown.bind(this));var input=this.element();input.keydown(this.onInputKeyDown.bind(this));input.keyup(this.onInputKeyUp.bind(this));input.attr("autocomplete","off");this.addIcon();if(this.searchScopes().length>0){this.addScopeSelector()}if(options.focusOnLoad){input.focus()}(function(){inputController.fixInputLayout()}).delay(0.2);(function(){inputController.fixInputLayout()}).delay(1);$j(window).resize(function(evt){inputController.fixInputLayout()})},offset:function(){return 5},addIcon:function(){var input=this.element(),icon=$j('<div id="icon" title="Press <ESC> to clear input."/>');input.after(icon);icon.css({marginLeft:-icon.width()+"px",left:-1*this.offset()+"px"}).addClass("clear_icon").hide();icon.bind("click",this.resetInput.bind(this))},addScopeSelector:function(){var scopeSelector=$j('<div class="search_scope_selector">  <span class="scope_text"></span>  <span class="arrow">▾</span>  <ul class="dropdown"/></div>');this.icon().after(scopeSelector);scopeSelector.attr("tabindex",0).keydown(this.onScopeSelectorKeyDown.bind(this)).keyup(this.onScopeSelectorKeyUp.bind(this)).click(function(evt){inputController.openSearchScopeMenu("true");evtHandled(evt)}).hover(function(){inputController.openSearchScopeMenu()},function(){inputController.closeSearchScopeMenu()}).focus(function(){inputController.openSearchScopeMenu();inputController.selectSearchScopeMenuItem(0)}).blur(function(){inputController.closeSearchScopeMenu()});scopeSelector.find(".arrow").css({position:"absolute",right:"0px"});scopeSelector.find("span").hover(function(){inputController.selectSearchScopeMenuItem(0)});this.populateScopeItems()},populateScopeItems:function(){var searchUrl=this.searchUrl(),scopes=this.searchScopes(),defaultScope=scopes.detect(function(ea){return ea.url===searchUrl});var arrowWidth=this.scopeSelector().find(".arrow").width()+3*this.offset(),width=scopes.inject(0,function(width,scope){this.setScope(scope);return Math.max(width,this.scopeSelector().find(".scope_text").width())},this);this.scopeSelector().css({width:width+arrowWidth+"px"});if(!defaultScope){return}this.setScope(defaultScope);this.setScopeList(scopes.without(defaultScope))},setScope:function(scope){this.scopeSelector().find(".scope_text").text(I18n.t("txt.instant_search.in_forum_name",{forum_name:scope.name})).data("searchScope",scope)},setScopeList:function(scopes){var list=this.scopeSelectorMenu();this.closeSearchScopeMenu();list.find("li").remove();scopes.forEach(function(ea,i){$j("<li>"+I18n.t("txt.instant_search.in_forum_name",{forum_name:ea.name})+"</li>").appendTo(list).data("searchScope",scopes[i]).click(function(evt){inputController.changeScope($j(this).data("searchScope"),true);list.hide();evtHandled(evt)}).hover(function(){inputController.selectSearchScopeMenuItem(i+1)})})},scopeSelectorMenu:function(){return this.scopeSelector().find(".dropdown")},scopeSelectorMenuItems:function(){return this.scopeSelector().find(".scope_text, li")},hasSelectedSearchScopeMenuItem:function(){return this.getSelectedSearchScopeMenuItem().length>0},getSelectedSearchScopeMenuItem:function(){return this.scopeSelectorMenuItems().filter(".selected")},openSearchScopeMenu:function(){this.scopeSelectorMenu().show()},closeSearchScopeMenu:function(){this.scopeSelectorMenu().hide();this.deselectAllSearchScopeMenuItems()},selectSearchScopeMenuItem:function(idx){this.deselectAllSearchScopeMenuItems();var all=this.scopeSelectorMenuItems();idx=Math.abs(idx)%all.length;this.selectSearchScopeElement($j(all.get(idx)))},selectSearchScopeElement:function(selected){if(selected.hasClass("scope_text")){selected=selected.add(selected.parent())}selected.addClass("selected")},selectNextSearchScopeMenuItem:function(next){var idx=this.scopeSelectorMenuItems().index(this.getSelectedSearchScopeMenuItem());this.selectSearchScopeMenuItem(idx+(next?1:-1))},deselectAllSearchScopeMenuItems:function(){this.form().find(".selected").removeClass("selected")},getSelectedSearchScope:function(){return this.getSelectedSearchScopeMenuItem().data("searchScope")},searchScopes:function(){return options.searchScopes},changeScope:function(scope,byMouse){this.form().attr("action",scope.url);this.populateScopeItems();this.fixInputLayout();this.element().focus();searchController.searchNow()},fixInputLayout:function(){var icon=this.icon(),input=this.element(),form=this.form(),button=form.find("#buttonsubmit"),scopeSelector=this.scopeSelector();if(scopeSelector.length>0){this.layoutScopeSelector(scopeSelector,input,icon)}this.layoutInput(input,form,button)},layoutScopeSelector:function(scopeSelector,input,icon){var scopeSelWidth=scopeSelector.width();scopeSelector.css({marginLeft:-1*scopeSelWidth+"px",marginRight:-3*this.offset()+"px",left:-3*this.offset()+"px",paddingLeft:2*this.offset()+"px"});scopeSelector.find(".arrow").css({marginRight:this.offset()+"px"});var scopeSelWidthWithPadding=scopeSelector.bounds(true).width(),dropdown=scopeSelector.find(".dropdown");dropdown.css({left:"0px",width:scopeSelWidthWithPadding+"px"});icon.css({left:-1*(scopeSelWidth+icon.width()+this.offset())+"px"});var iconAndScopeSelWidth=scopeSelWidthWithPadding+icon.width()+2*this.offset();input.css({paddingRight:iconAndScopeSelWidth+"px"})},layoutInput:function(input,form,button){input.css({width:"20px"});var inputAndButtonBounds=input.add(button).bounds(true),formBounds=form.bounds(true),formParentBounds=form.parent().bounds(true),formMarginLeft=formBounds.left-formParentBounds.left,deltaX=formBounds.width()-inputAndButtonBounds.width()-formMarginLeft;input.css({width:input.width()+deltaX+"px"})},updateIcon:function(){if(!searchController.searchInitiated){this.toggleClearIconDisplay();return}if(this.val().length>0){this.signalLoading()}else{this.stopSignalLoading()}},toggleClearIconDisplay:function(){var icon=this.icon();icon.removeClass("loading_icon");if(this.val()===""){icon.removeClass("clear_icon");icon.hide()}else{icon.addClass("clear_icon");icon.show()}},resetInput:function(byMouse){this.element().val("");this.updateIcon();resultController.removeIncrementalSearchResults()},signalLoading:function(){inputController.icon().show().removeClass("clear_icon").addClass("loading_icon")},stopSignalLoading:function(){inputController.icon().addClass("clear_icon").removeClass("loading_icon");this.toggleClearIconDisplay()},onInputKeyDown:function(evt){this.prevVal=this.val();if(!isKey(evt,"ESC")){return undefined}var input=this.element();if(this.val()===""){input.blur()}else{this.resetInput();if($j.browser.msie){window.setTimeout((function(){input.focus()}).bind(this),400)}}return evtHandled(evt)},onInputKeyUp:function(evt){if(isKey(evt,"ENTER")){var selectedResultItem=resultController.selectedResultItem();if(selectedResultItem&&this.hasSelectedSearchScopeMenuItem()){resultController.visitResultItem(selectedResultItem);return evtHandled(evt)}}if(isKey(evt,"ESC")){return evtHandled(evt)}if(!isKey(evt,"UP")&&!isKey(evt,"DOWN")){var self=this;_.delay(function(){if(self.prevVal===self.val()&&self.prevVal!==""){return}searchController.initSearchRequest()})}return undefined},onScopeSelectorKeyUp:function(evt){if(isKey(evt,"ESC")){this.element().focus(0);return evtHandled(evt)}return undefined},onScopeSelectorKeyDown:function(evt){if(isKey(evt,"ENTER")){this.changeScope(this.getSelectedSearchScope());this.closeSearchScopeMenu();return evtHandled(evt)}if(isKey(evt,"DOWN")||isKey(evt,"UP")){this.selectNextSearchScopeMenuItem(isKey(evt,"DOWN"));return evtHandled(evt)}return undefined},onWindowKeyDown:function(evt){if(this.hasSelectedSearchScopeMenuItem()){return undefined}if(isKey(evt,"UP")||isKey(evt,"DOWN")){resultController.changeSelection(isKey(evt,"DOWN")?1:-1);return evtHandled(evt)}if(isKey(evt,"ENTER")){var selected=resultController.selectedResultItem();if(selected){resultController.visitResultItem(selected);return evtHandled(evt)}}return undefined}};var resultController={container:function(){return $j("#incremental_search")},notFoundElement:function(){return $j("#not_found_hint")},output:function(){return $j("#incremental_search_result")},hasResults:function(html){return html.find(".item-info").length>0},resultItems:function(){return this.output().find(".item")},result_snippets:function(){return this.output().find(".item_search_snippet")},selectedResultItem:function(){return this.resultItems()[this.selectedResultItem_idx]},result_titles:function(html){return html.find("a[title]")},resultDataSelector:".item, #show_more",loadMoreScriptSelector:".search_results_data",resultSelector:function(){return this.resultDataSelector+". "+this.loadMoreScriptSelector},notFoundText:I18n.t("txt.search.we_could_find_results"),setup:function(){this.showExistingResultsIfPresent()},visitURL:function(url){document.location=url},visitResultItem:function(item,isMouseAction){if(item){this.visitURL($j(item).find(".item-info a").attr("href"))}},prepareHtml:function(html,query){paginatorController.paginate(html);this.highlight(html,query);this.prepareResultItemsForSelection()},highlight:function(html,query){if(!query){return}var titles=resultController.result_titles(html),snippets=resultController.result_snippets(html);titles.removeHighlight();snippets.removeHighlight();query.split(" ").forEach(function(term){titles.highlight(term);snippets.highlight(term)})},processResult:function(query,data){this.container().show();var parsedData=$j(data);if(!this.hasResults(parsedData)){this.removeIncrementalSearchResults();this.showNotFoundHint();return}this.notFoundElement().hide();this.output().show();var animationSpec=this.findElementsToAnimate(this.output(),parsedData);animationSpec.slideDown.hide();if(animationSpec.slideUp.length>0){animationSpec.slideUp.slideUp("fast",this.embedNew.bind(this).curry(animationSpec,query))}else{this.embedNew(animationSpec,query)}},embedNew:function(spec,query){var output=this.output();this.container().show();if(spec.replaceOld.length===0){output.append(spec.replaceNew)}else{spec.replaceOld.replaceWith(spec.replaceNew)}spec.slideUp.remove();var insertAfterItem=output.find(".item").last(),insertBeforeItem=output.find(":first-child").first();if(insertAfterItem.length>0){spec.slideDown.insertAfter(insertAfterItem)}else{if(insertBeforeItem.length>0){spec.slideDown.insertBefore(insertBeforeItem)}else{spec.slideDown.appendTo(output)}}spec.slideDown.slideDown("fast",this.prepareHtml.bind(this).curry(output,query));this.prepareHtml(output,query)},removeIncrementalSearchResults:function(){var output=this.output();output.hide("fast","swing",function(){output.html("")})},showExistingResultsIfPresent:function(){var existingResultContainer=$j(".hidden_incremental_search_results");if(existingResultContainer.length===0){return}if(!this.hasResults(existingResultContainer)){this.showNotFoundHint()}var animSpec=this.findElementsToAnimate(null,existingResultContainer,true);this.embedNew(animSpec,this.getQuery());inputController.updateIcon()},showNotFoundHint:function(){var elem=this.notFoundElement();if(elem.length===0){elem=$j('<div id="not_found_hint"><h2>'+this.notFoundText+"</h2></div>");this.container().find("#incremental_search_result").after(elem)}return elem.show()},getQuery:function(){return inputController.element().val()},parseResults:function(html){var $html=$j(html);return{items:$html.filterOrFind(".item"),moreButton:$html.filterOrFind("#show_more"),paginatorScript:$html.filterOrFind(".search_results_data")}},findElementsToAnimate:function(oldResults,newResults,noAnimation){var old=this.parseResults(oldResults),_new=this.parseResults(newResults);if(noAnimation){return{remove:old.paginatorScript,slideUp:$j(),slideDown:$j(),replaceOld:old.items.add(old.moreButton),replaceNew:_new.paginatorScript.add(_new.items).add(_new.moreButton)}}return{remove:old.paginatorScript,slideUp:old.items.slice(_new.items.length),slideDown:_new.items.slice(old.items.length),replaceOld:old.items.slice(0,_new.items.length).add(old.moreButton),replaceNew:_new.paginatorScript.add(_new.items.slice(0,old.items.length)).add(_new.moreButton)}},prepareResultItemsForSelection:function(){this.selectedResultItem_idx=-1;var self=this,resultItems=this.resultItems();resultItems.bind("mousemove",function(){var idx=resultItems.index(this);if(idx!==-1){self.selectResultItem(idx)}});resultItems.bind("click",function(){self.visitResultItem(this,true)})},changeSelection:function(delta){this.selectResultItem(this.selectedResultItem_idx+delta)},selectResultItem:function(idx){if(paginatorController.is_loading_more){return}var resultItems=this.resultItems(),result_count=resultItems.length;resultItems.removeClass("selected");if(result_count===0){return}var at_end=idx===result_count;if(at_end&&paginatorController.next_page()){paginatorController.load_next_page_select_idx=idx;paginatorController.loadNextPage();return}if(idx<0){idx=result_count-1}else{if(idx>=result_count){idx=0}}var next=resultItems.get(idx);if(next.scrollIntoViewIfNeeded){next.scrollIntoViewIfNeeded()}$j(next).addClass("selected");this.selectedResultItem_idx=idx}};var paginatorController={itemsPerPage:function(){return options.perPage},paginator:function(){return resultController.output().data("resultsPaginator")},setup:function(){var proto=Zendesk.ResultsPaginator.prototype;proto.onContentRetrievedCallback=function(paginator,content){this.slide_in_paginator_content(paginator,content);this.on_paginator_page_load(paginator);resultController.prepareResultItemsForSelection();this.is_loading_more=false;if(this.load_next_page_select_idx){resultController.selectResultItem(this.load_next_page_select_idx);delete this.load_next_page_select_idx}}.bind(this)},reset_paginator:function(){resultController.output().data("resultsPaginator",null)},paginate:function(element){this.reset_paginator();element.paginateResults();var paginator=this.paginator();if(paginator&&paginator.nextPage===2){paginator.nextPage=Zendesk.ResultsPaginator.parseNextPageFrom(element)}},slide_in_paginator_content:function(paginator,content){content=$j(content).hide();paginator.$container.append(content);content.each(function(ea){$j(this).slideDown("fast")})},on_paginator_page_load:function(paginator){var query=searchController.last_query;if(query){resultController.highlight(paginator.$container,query)}},next_page:function(){var paginator=this.paginator();return paginator&&paginator.nextPage},loadNextPage:function(){var paginator=this.paginator();if(paginator&&paginator.nextPage){this.is_loading_more=true;paginator.loadMore(true)}}};var searchController={searchDelay:370,initSearchRequest:function(){this.searchInitiated=true;inputController.updateIcon();if(!this.searchLater){this.searchLater=_.debounce(this.searchNow.bind(this),this.searchDelay)}this.searchLater()},searchNow:function(){var query=this.createSearchQuery(inputController.val());if(query&&query.length>0){this.searchInitiated=true;this.doIncrementalSearch(inputController.searchUrl(),query)}else{this.searchInitiated=false;resultController.removeIncrementalSearchResults()}inputController.updateIcon()},createSearchQuery:function(inputString){var punctuation="[\\.,\\+]";return inputString.replace(new RegExp("^"+punctuation+"|"+punctuation+"$"),"").replace(new RegExp(punctuation)," ").replace(/\s+/," ")},processResult:function(query,result){query=query||this.last_query;this.last_query=query;this.searchInitiated=false;inputController.updateIcon();return resultController.processResult(query,result)},doIncrementalSearch:function(request_url,query){$j.ajax({url:request_url,data:{query:query,incremental:true,format:"html",page:1,per_page:paginatorController.itemsPerPage(),xhr:true}}).done(this.processResult.bind(this).curry(query))}};var trackingController={trackingModule:"Incremental Forum Search",track:function(activity){Zendesk.Instrumentation.ToTango.track(activity,this.trackingModule)},setupTracking:function(){var i=Zendesk.Instrumentation;i.on(searchController,"searchNow","search activated",this.trackingModule);i.on(resultController,"visitResultItem",function(item,byMouse){return"topic selected by "+(byMouse?"mouse":"key:enter")},this.trackingModule);i.on(inputController,"resetInput",function(byMouse){return"clear search by "+(byMouse?"mouse":"key:esc")},this.trackingModule);var form=inputController.form(),byMouseText="search submitted by mouse",byEnterKeyText="search submitted by key:enter";form.addClass("tracked").data("tracking-activity",byMouseText).data("tracking-module",this.trackingModule).instrumentTracking().keydown(function(evt){if(isKey(evt,"ENTER")){inputController.form().data("tracking-activity",byEnterKeyText)}}).keyup(function(evt){if(isKey(evt,"ENTER")){inputController.form().data("tracking-activity",byMouseText)}});$j(".deflect.tickets").add(".deflect.ideas").add(".deflect.questions").addClass("tracked").data("tracking-module",this.trackingModule).instrumentTracking();$j(".deflect.tickets").data("tracking-activity","'Get in touch' selected");$j(".deflect.ideas").data("tracking-activity","'Submit an idea' selected");$j(".deflect.questions").data("tracking-activity","'Ask a question' selected");i.on(inputController,"openSearchScopeMenu",function(byMouse){return"scope selector: opened by "+(byMouse?"mouse":"key:tab")},this.trackingModule);i.on(inputController,"changeScope",function(_,byMouse){return"scope selector: new scope selected by "+(byMouse?"mouse":"key:tab")},this.trackingModule);i.on(Zendesk.ResultsPaginator.prototype,"loadMore",function(byKey){return"see more button selected by "+(byKey?"key":"mouse")},this.trackingModule);i.on(resultController,"embedNew",function(spec){var moreBtnFound=spec.replaceNew.filterOrFind(".show_more_bar").add(spec.slideDown.filterOrFind(".show_more_bar")).length>0;return moreBtnFound?"see more button visible":null},this.trackingModule);if(options.searchScopes&&options.searchScopes.length>0){this.track("scope selector visible")}}};function setupOptionsFromParams(params){options.instantSearchEnabled=resultController.container().length>0;if(params&&params.per_page){options.perPage=params.per_page}if(params&&params.focus){options.focusOnLoad=params.focus}if(params&&params.search_scopes){options.searchScopes=params.search_scopes;if(params.model_name){options.searchScopes.push({name:params.model_name,url:inputController.searchUrl()})}}if(params&&params.tracking!==undefined){options.tracking=params.tracking}}this.inputController=inputController;this.resultController=resultController;this.paginatorController=paginatorController;this.searchController=searchController;this.trackingController=trackingController;this.setup=function(params){setupOptionsFromParams(params);if(!options.instantSearchEnabled){return}$j(function(){paginatorController.setup();inputController.setup();resultController.setup();if(options.tracking){trackingController.setupTracking()}})}});Zendesk.NS("Stats");Zendesk.Stats.ForumUI=(function(){this._statsInfo=function(statsObject){return{statsObject:statsObject,objectType:statsObject.attr("object_type"),objectId:statsObject.attr("object_id"),windowStart:statsObject.attr("window_start"),pageType:statsObject.attr("page_type")}};this.setup=function(app,options){options=options||{};var container=options.container;$j("#detailed_stats_graph_container",container).hide();this._drawSparklines(options);this._bindSparklineHandlers(app,options)};this._bindSparklineHandlers=function(app,options){options=options||{};var container=options.container,statsURL=(options.statsURL||"#stats")+"/";$j(".sparkline",container).click(function(){if($j(this).hasClass("active")){return false}app.setLocation(statsURL+$j(this).attr("id"))})},this._drawSparklines=function(options){options=options||{};var container=options.container,statsInfo=Zendesk.Stats.ForumUI._statsInfo($j("#stats_object",container));var sparklineGraphs=[{div:"#forum_entry_create_sparkline",statName:"entry_create"},{div:"#forum_entry_view_sparkline",statName:"entry_view"},{div:"#forum_post_create_sparkline",statName:"post_create"},{div:"#forum_watching_entry_create_sparkline",statName:"watching_entry_create"},{div:"#forum_vote_create_sparkline",statName:"vote_create"}];if($j("#stats_summary_container",container).exists()){for(var i=0;i<sparklineGraphs.length;i++){if(statsInfo.pageType=="entry"&&sparklineGraphs[i]["statName"]=="entry_create"){continue}else{var sparkline=new Zendesk.Stats.Graph($j(sparklineGraphs[i]["div"],container),{graphType:"sparkline",resource:"forum",objectType:statsInfo.objectType,objectId:statsInfo.objectId,statName:sparklineGraphs[i]["statName"],start:statsInfo.windowStart,totalCountDiv:$j(sparklineGraphs[i]["div"],container).parent().parent().find(".stat_total")});sparkline.draw()}}}},this.showDetailGraph=function(sparkline,options){options=options||{};var container=options.container,statName=$j(sparkline,container).attr("id"),statsInfo=Zendesk.Stats.ForumUI._statsInfo($j("#stats_object",container));$j("#comments_section",container).hide();$j("#stats_summary_container",container).show();$j(".sparkline.active",container).removeClass("active");$j(sparkline,container).addClass("active");var graph=new Zendesk.Stats.Graph($j("#detailed_stats_graph",container),{graphType:"area",resource:"forum",objectType:statsInfo.objectType,objectId:statsInfo.objectId,statName:statName,start:statsInfo.windowStart});graph.draw();$j(window).resize(function(){graph.draw()});$j("#detailed_stats_graph_container",container).show();if(statsInfo.objectType!="entry"){var data={start:statsInfo.windowStart,stat_name:statName};data[statsInfo.objectType+"_id"]=statsInfo.objectId;$j("#content_entries .frame:first",container).html('<div id="topic_search_loading" class="loading"></div>');$j.ajax({url:"/entries/top_entries_by_stat",data:data}).done(function(body){$j("#content_entries .frame:first",container).html(body)})}if(statsInfo.objectType!="account"){$j.ajax({url:"/api/v1/stats/aggregate_average/account/0/forum_stats_by_"+statsInfo.objectType+"/"+statName+"?start="+statsInfo.windowStart}).done(function(total){var formattedTotal=Zendesk.Stats.formatNumber("0,0",total);$j("#account_wide_total_section",container).html(I18n.t("txt.admin.public.javascript.stats.forum_stats.vs_for_average_topic",{total_stats:'<span id="account_wide_total">'+formattedTotal+"</span>"}))})}$j("#forum_nav_comments",container).click(function(){$j("#detailed_stats_graph_container",container).hide()})};return this})();Zendesk.NS("Stats");Zendesk.Stats.SearchStatsOptions=function(options){if((options===undefined)||(options.divTable===undefined)||(options.statsType===undefined)){throw"Expected both divTable & statsType options."}if((options.statsType!="all"&&options.statsType!="feedback_tab"&&options.statsType!="portal_tab")){throw"Unknown handle type: "+options.statsType}this.divTable=options.divTable;this.statsType=options.statsType;this.orderField=options.orderField;this.fieldSorts={searches:true,string:true,avg_results:false,ctr:false,tickets:true};this.appendData=options.appendData||false;this.container=options.container;this.divPaginationTotal=options.divPaginationTotal;this.page=options.currentPage||1;this.pageSize=options.pageSize||15;this.searchStatsTemplate=options.searchStatsTemplate};Zendesk.Stats.SearchStatsOptions.prototype={getStatsAPIEndpoint:function(pageOptions){var apiEndPoint="/api/v1/stats/search/account/search_stats";var origin={all:"all",feedback_tab:"dropbox",portal_tab:"portal"}[this.statsType];var page;var pageSize;if(pageOptions===undefined){page=this.page;pageSize=this.pageSize}else{page=pageOptions.page||this.page;pageSize=pageOptions.pageSize||this.pageSize}apiEndPoint+="?origin="+origin+"&page="+page+"&per_page="+pageSize+"&duration=2592000";if(this.orderField!==undefined){apiEndPoint+="&order="+this.orderField;apiEndPoint+="&desc="+this.fieldSorts[this.orderField]}return apiEndPoint}};Zendesk.Stats.SearchStatsTable=function(options){this.statOptions=new Zendesk.Stats.SearchStatsOptions(options)};Zendesk.Stats.SearchStatsTable.prototype={$:function(selector){return $j(selector,this.statOptions.container)},_saveOptions:function(statOptions){$j.extend(this.statOptions,statOptions)},displayFirstPage:function(statOptions){this._saveOptions(statOptions);this._fetchData(this.statOptions.getStatsAPIEndpoint())},nextPage:function(){this.statOptions.appendData=true;return(this.statOptions.page+=1)},setSort:function(stat,sortDirection){var opts=this.statOptions,desc=(sortDirection==="desc");opts.fieldSorts[stat]=desc;opts.orderField=stat},_getSortDirection:function(sort){return(sort===false?"asc":"desc")},getCurrentSortDirection:function(stat){var opts=this.statOptions,sort=opts.fieldSorts[stat];return this._getSortDirection(sort)},getNextSortDirection:function(stat){var opts=this.statOptions,newSort=opts.fieldSorts[stat];if(opts.orderField===stat){newSort=!newSort}return this._getSortDirection(newSort)},modifyDisplayed:function(statOptions,table,filterCallback){this._saveOptions(statOptions||{});var apiEndPoint;if(this.statOptions.appendData===true){apiEndPoint=this.statOptions.getStatsAPIEndpoint()}else{var currentDisplayedRows=this.statOptions.pageSize*this.statOptions.page;apiEndPoint=this.statOptions.getStatsAPIEndpoint({page:1,pageSize:currentDisplayedRows})}this._fetchData(apiEndPoint,this.statOptions.orderField,table,filterCallback)},_fetchData:function(url,stat,table,filterCallback){var self=this;$j.ajax({url:url,dataType:"json",success:function(tableData){if(tableData.data.length>0){self._fetchTopEntries(tableData,stat,table,filterCallback)}else{self.statOptions.appendData=false}}})},_fetchTopEntries:function(entriesInfo,stat,table,filterCallback){var self=this;var tableData=entriesInfo.data;var entryIds=[];$j.each(tableData,function(index,value){if(value.top_entry_id!==null){entryIds.push(value.top_entry_id)}});var joinedEntryIds=entryIds.join(",");var topEntryDetailsUrl="/api/v1/entries/show_many/";$j.ajax({type:"POST",url:topEntryDetailsUrl,data:{ids:joinedEntryIds,only:"title"},dataType:"json",success:function(topEntriesData){self._mergeData(topEntriesData,tableData);var moreButton=self.$(self.statOptions.divTable+" #show_more");if(entriesInfo.page<entriesInfo.total_pages){moreButton.show()}else{moreButton.hide()}if(filterCallback){filterCallback.call(table,stat)}self._displayTotal(entriesInfo.page,entriesInfo.total_entries)}})},_mergeData:function(topEntriesData,tableData){var entryRowMap={};$j.each(tableData,function(index,row){if(entryRowMap[row.top_entry_id]===undefined){entryRowMap[row.top_entry_id]=[]}entryRowMap[row.top_entry_id].push(index);var search_string=row.string;if(search_string!==null&&search_string.length>=26){search_string=search_string.substring(0,23)+"...";row.string=search_string}row.escaped_string=escape(search_string);row.searches=Zendesk.Stats.formatNumber("0",row.searches);row.ctr=row.ctr*100;if(row.ctr>100){row.ctr=100}row.ctr=Zendesk.Stats.formatNumber("0.0",row.ctr);row.avg_results=Zendesk.Stats.formatNumber("0,0.0",row.avg_results);row.tickets=Zendesk.Stats.formatNumber("0",row.tickets)});$j.each(topEntriesData,function(index,topEntryRow){var tableDataIndexes=entryRowMap[topEntryRow.id];var link=topEntryRow.title;if(link!==null&&link.length>=26){link=link.substring(0,23)+"..."}$j.each(tableDataIndexes,function(index,tableIndex){var row=tableData[tableIndex];if(row!==undefined){row.title=topEntryRow.title;row.link=link}})});this._displayTable({statEntries:tableData})},_displayTable:function(data){var table=this.$(this.statOptions.divTable+" tbody");var template=this.$(this.statOptions.searchStatsTemplate).html();var table_html=$j.mustache(template,data);if(this.statOptions.appendData===false){table.empty()}else{this.statOptions.appendData=false}table.append(table_html)},_displayTotal:function(page,totalEntries){var currentDisplayedRows=this.$("table.tickets tbody tr:visible").length;var pageTotalDiv=this.$(this.statOptions.divPaginationTotal);var from=(currentDisplayedRows===0?"0":"1");var total=(this.$(".active").attr("id")==="searches")?totalEntries:currentDisplayedRows;pageTotalDiv.html($j.mustache(I18n.t("txt.admin.views.search.stats_summary.currently_displayed_search_results_out_of_total"),{from:from,currentDisplayedRows:currentDisplayedRows,total:total}))},isFeedbackData:function(context,callback){var statOptions=new Zendesk.Stats.SearchStatsOptions({divTable:"search_string_stats",statsType:"feedback_tab"});$j.ajax({url:statOptions.getStatsAPIEndpoint(),dataType:"json",success:function(tableData){callback.call(context,tableData.data.length>0)}})}};Zendesk.NS("Stats");Zendesk.Stats.Graph=function(container,options){this.graphData={};this.container=$j(container);this.searchStatURL=options.searchStatURL;this.resource=options.resource;this.statName=options.statName;this.objectId=options.objectId||0;this.objectType=options.objectType||"account";this.graphType=options.graphType;this.totalCountDiv=options.totalCountDiv;this.nocache=options.nocache;this.data=options.data;if(options.start){this.startTime=options.start}else{var today=parseInt(new Date()/1000);this.startTime=today-(60*60*24*30)}this.statsURL=this._statsURL();this.flotOptions=Zendesk.Stats.FlotOptions[this.graphType]};Zendesk.Stats.Graph.prototype={_statsURL:function(){if(this.data){return false}if(this.searchStatURL){return"/api/v1/stats/graph_data"+this.searchStatURL+"/"+this.statName}var base="/api/v1/stats/graph_data/"+this.objectType+"/";if(this.objectId){base+=this.objectId+"/"}base+=this.resource+"_stats_by_"+this.objectType;base+="/"+this.statName;return base},draw:function(){if(this.graphData[this.statsURL]||this.data){this._updateDetailGraphTitle();this._render();this._addPlotHover()}else{var data={start:this.startTime,interval:86400};if(this.nocache){data.nocache=this.nocache}$j.getJSON(this.statsURL,data).done($j.proxy(this._onFetchGraphData,this,this.statsURL))}},_render:function(){var data=this.data||this.graphData[this.statsURL].data;$j.plot(this.container,[{data:data}],this.flotOptions)},_onFetchGraphData:function(url,data){this.container.data("graph_data",data);this.graphData[url]=data;this._updateTotalCount(url);this._updateDetailGraphTitle();this._render();this._addPlotHover()},_updateDetailGraphTitle:function(){var title=$j(".sparkline.active").parent().children(".sparkline_title").html();$j("#detailed_stats_graph_title").html(title)},_updateTotalCount:function(url){if($j(this.totalCountDiv).is(":empty")){var data=this.graphData[this.statsURL].data,totalCount;totalCount=_.inject(data,function(memo,d){return memo+d[1]},0);$j(this.totalCountDiv).append(Zendesk.Stats.formatNumber("0,0",totalCount))}},_addPlotHover:function(){var prev=null,self=this;$j(this.container).bind("plothover",function(event,pos,item){if(item){if(prev!==(item.pageX*item.datapoint[1])){prev=item.pageX*item.datapoint[1];$j("#stats_point_value").remove();var total=Zendesk.Stats.formatNumber("0,0",item.datapoint[1]);self._displayPointValue(item.pageX,item.pageY,total)}}else{$j("#stats_point_value").remove();prev=null}})},_displayPointValue:function(x,y,contents){$j('<div id="stats_point_value">'+contents+"</div>").css({position:"absolute",display:"none",top:y-29,left:x-9,border:"2px solid #000","-webkit-border-radius":"2px","-moz-border-radius":"2px","font-size":"12px",padding:"4px",color:"#fff","background-color":"#000",opacity:0.8}).appendTo("body").fadeIn(200)}};Zendesk.Stats.FlotOptions={area:{colors:["#137ac6"],grid:{backgroundColor:"#fff",borderWidth:0,hoverable:true,mouseActiveRadius:"240",autoHighlight:false,minBorderMargin:"20"},yaxis:{min:0,tickFormatter:function(val,_){return Zendesk.Stats.formatNumber("0,0",Math.round(val))},maxFloor:5},xaxis:{mode:"time",monthNames:I18n.t("date.abbr_month_names").slice(1),timeformat:I18n.t("date.formats.short")},legend:{show:false},series:{lines:{show:true,fill:true,fillColor:"#e6f2fa",lineWidth:"1"},points:{show:true,fill:true,fillColor:"#137ac6",radius:"1.5",symbol:"circle"},shadowSize:0}},percentage:{colors:["#137ac6"],grid:{backgroundColor:"#fff",borderWidth:0,hoverable:true,mouseActiveRadius:"240",autoHighlight:false,minBorderMargin:"20"},yaxis:{min:0,maxFloor:100,tickSize:25,tickFormatter:function(val,_){return String(val)+"%"}},xaxis:{mode:"time"},legend:{show:false},series:{lines:{show:true,fill:true,fillColor:"#e6f2fa",lineWidth:"1"},points:{show:true,fill:true,fillColor:"#137ac6",radius:"1.5",symbol:"circle"},shadowSize:0}},sparkline:{colors:["#137ac6"],shadowSize:0,grid:{show:false},yaxis:{min:0},xaxis:{mode:"time"},legend:{show:false},series:{lines:{show:true,fill:true,fillColor:"#e6f2fa",lineWidth:1}}}};Zendesk.Stats.formatNumber=function(format,num){if(typeof format!=="string"){return("")}if(num===null||typeof num==="undefined"){num=0}var hasComma=-1<format.indexOf(","),psplit=format.split(".");if(1<psplit.length){num=num.toFixed(psplit[1].length)}else{if(2<psplit.length){throw ("NumberFormatException: invalid format, formats should have no more than 1 period: "+format)}else{num=num.toFixed(0)}}var fnum=num.toString();if(hasComma){psplit=fnum.split(".");var cnum=psplit[0],parr=[],j=cnum.length,m=Math.floor(j/3),n=cnum.length%3||3;for(var i=0;i<j;i+=n){if(i!==0){n=3}parr[parr.length]=cnum.substr(i,n);m-=1}fnum=parr.join(",");if(psplit[1]){fnum+="."+psplit[1]}}return format.replace(/[\d,?\.?]+/,fnum)};(function($){var initialized=false;function Selectable(){this.reset();this.elId="#suggest"}Selectable.prototype.reset=Selectable.prototype.update=function(items){var previous=this.active;this.selected=0;this.items=items||[];this.active=!!(this.items.length>0);if(previous!=this.active){if(!this.active){this.hide()}else{this.activated()}}};Selectable.prototype.keyMap={tab:9,enter:13,esc:27,up:38,down:40};Selectable.prototype.keyMapReverse=[9,13,27,38,40];Selectable.prototype.attach=function(textArea){var self=this;if(!initialized){$("body").append('<div id="suggest"></div>');initialized=true}$(textArea).unbind(".selectable").bind("keydown.selectable",function(e){self.keyDown(this,e)})};Selectable.prototype.detach=function(textArea){$(textArea).unbind(".selectable");this.reset();this.hide()};Selectable.prototype.keyDown=function(element,event){if(!this.active){return}var prevent=true,key=Selectable.prototype.keyMap;switch(event.keyCode){case key.up:this.selected=Math.max(this.selected-1,0);break;case key.down:this.selected=Math.min(this.selected+1,this.items.length-1);break;case key.tab:case key.enter:this.complete();break;case key.esc:this.reset();break;default:prevent=false}if(prevent){event.preventDefault();this.render()}};Selectable.prototype.isNavigationEvent=function(event){return($.inArray(event.keyCode,Selectable.prototype.keyMapReverse)>-1)};Selectable.prototype.render=function(){if(!this.items){return}var start=this.selected,end=this.selected+5;if(start>0){start--;end--}var views=$.map(this.items,this.renderItem).slice(start,end);$(this.elId).html("<ul>"+views.join("")+"</ul>");return this};Selectable.prototype.hide=function(){this.active=false;$(this.elId).hide();return this};Selectable.prototype.show=function(){$(this.elId).show();return this};Selectable.prototype.move=function(pos){$(this.elId).css(pos);return this};function Suggest(){var self=this;this.re=new RegExp("^{{.*");this.suggestions={};this.lastToken="";this.selectable=new Selectable();this.selectable.complete=function(){self.complete()};this.selectable.renderItem=function(item,index){return'<li class="suggest-li '+(index==self.selectable.selected?"suggest-li-focus":"")+'">'+item+'<div class="suggest-detail">'+self.suggestions[item]+"</div></li>"};this.selectable.activated=function(){var sel=self.getTokenPos(self.getText(),self.getCaretPos()),pos=self.getTextAreaCoordsByIndex(self.textArea,sel.start),cpos=$(self.textArea).position();self.selectable.move({top:pos.top+cpos.top,left:pos.left+cpos.left}).show()}}Suggest.prototype.match=function(search){var filtered=[];if(!this.re.test(search)){return[]}for(var key in this.suggestions){if(search.length<key.length&&this.suggestions.hasOwnProperty(key)&&key.substr(0,search.length)==search){filtered.push(key)}}return filtered};Suggest.prototype.getToken=function(){var content=this.getText(),pos=this.getTokenPos(content,this.getCaretPos());return content.substring(pos.start,pos.end)};Suggest.prototype.getTokenPos=function(content,caretPos){var space=/\s/,len=content.length,start=caretPos,end=caretPos-1;for(;start>0;start--){if(space.test(content[start-1])){break}}for(;end<len;end++){if(space.test(content[end+1])){break}}return{start:start,end:end+1}};Suggest.prototype.keyUp=function(element,event){var token=this.getToken();if(this.lastToken!=token){this.selectable.update(this.match(token));this.selectable.render();this.lastToken=token}};Suggest.prototype.complete=function(){var content=this.getText(),pos=this.getTokenPos(content,this.getCaretPos());this.textArea.value=content.substr(0,pos.start)+this.selectable.items[this.selectable.selected]+" "+content.substr(pos.end);this.selectable.reset()};Suggest.prototype.attach=function(el){var self=this;$(el).unbind(".suggest").bind("keyup.suggest",function(ev){self.keyUp(this,ev)});this.textArea=el;this.selectable.attach(el)};Suggest.prototype.detach=function(el){$(el).unbind(".suggest");this.textArea=null;this.selectable.detach(el)};Suggest.prototype.getText=function(){return this.textArea.value};Suggest.prototype.getCaretPos=function(){return this.textArea.selectionEnd};Suggest.prototype.getTextAreaCoordsByIndex=function(textarea,index){var properties=["height","width","padding-top","padding-right","padding-bottom","padding-left","lineHeight","textDecoration","letterSpacing","font-family","font-size","font-style","font-variant","font-weight"],elProp={position:"absolute",overflow:"auto","white-space":"pre-wrap",top:0,left:-9999},len,el,span,pos;if(!$(textarea).is("textarea")||index==null){return}for(var i=0,len=properties.length;i<len;i++){elProp[properties[i]]=$(textarea).css(properties[i])}span=document.createElement("span");span.innerHTML="&nbsp;";el=document.createElement("div");$(el).css(elProp).text(textarea.value.substring(0,index)).insertAfter(textarea);el.scrollTop=el.scrollHeight;el.appendChild(span);pos=$(span).position();$(el).remove();return pos};window.Suggest=Suggest})(jQuery);Zendesk.NS("Screenr");Zendesk.Screenr.Helper={urlToScreenrLibray:function(domainUrl){return(Zendesk.Screenr.Helper._host_with_protocol(domainUrl)+"/api/recorder")},_host_with_protocol:function(domainUrl){var hostname=domainUrl.replace(/.*?:\/\//g,""),protocol=(("https:"==Zendesk.Screenr.Helper._protocol())?"https://":"http://");return protocol+hostname},_protocol:function(){return document.location.protocol},_tenant_domain:function(domainUrl){return domainUrl.match(/([^.]+)/g)[0]},publicUrlToTenantStatus:function(recorderId,domainUrl,screenrBaseUri){return this._host_with_protocol(screenrBaseUri)+"/tenants/"+this._tenant_domain(domainUrl)+"/recorders/"+recorderId+"?callback=?"}};(function($){Zendesk.NS("Screenr");Zendesk.Screenr.BaseRecorder={recorder:null,screencasts:null,counter:0,domainUrl:null,removeI18n:"",screencastI18nName:"",SCREENCAST_IFRAME_WIDTH:570,SCREENCAST_IFRAME_HEIGHT:340,COLORBOX_WIDTH:620,COLORBOX_HEIGHT:425,COMMENT_HEIGHT:115,init:function(recorderId,domainUrl,screencastName,removeText){this.domainUrl=domainUrl;this.screencasts=[];this.screencastI18nName=screencastName;this.removeI18n=removeText;this._retrieveScreencastsPreviouslyRecorded();$.getScript(Zendesk.Screenr.Helper.urlToScreenrLibray(domainUrl)).done(this._onScreenrLoadedFunction(recorderId));$("a[href='javascript:void']").click(function(event){event.preventDefault();event.returnValue=false});this.afterInit()},_retrieveScreencastsPreviouslyRecorded:function(){var self=this,recordedScreencasts=Zendesk.Screenr.RecordedScreencastsOnFailedValidation;if(recordedScreencasts!=null){$.each(recordedScreencasts,function(index,s){self._onRecordingCompleted({id:s.id,position:s.position,embedUrl:s.url,thumbnailUrl:s.thumbnail})})}},_onScreenrLoadedFunction:function(recorderId){var self=this;return function(script,textStatus){self.setUpScreenr(recorderId)}},setUpScreenr:function(recorderId){var recorder,base_params={id:recorderId,hideAllFields:true,scrollToTop:true};recorder=Screenr.Recorder($.extend(base_params,this._extraParamsForScreenr()));recorder.attachTo("screenr_link");recorder.setUserName("",false);recorder.setUserEmail("",false);recorder.setSubject("",false);recorder.setDescription("",false);recorder.setOnCancel(function(screencast){});recorder.setOnComplete(function(screencast){this._onRecordingCompleted(screencast)}.bind(this));this.recorder=recorder},_onRecordingCompleted:function(screenrScreencast){var id,listItem,screencast;this.counter++;screencast={id:screenrScreencast.id,url:screenrScreencast.embedUrl,thumbnail:screenrScreencast.thumbnailUrl,position:this.counter};this.screencasts.push(screencast);listItem=this._UIstyledListItemButton(screencast,null,true);listItem.appendTo($("#screencasts_list"));try{listItem.effect("highlight",{},800)}catch(err){}},_UIstyledListItemButton:function(screencast,comment,withRemove){var id=screencast.id,listItem=$("<li/>"),link=$('<a href="javascript:void" class="screencast_preview"/>'),removeLink=$('<a href="javascript:void" class="remove"/>');withRemove=withRemove||false;listItem.attr("id","screencast-"+id);listItem.append(link);link.text(this.screencastI18nName+screencast.position).click(function(evt){this.showScreencast(screencast.url,comment)}.bind(this));if(withRemove){removeLink.html(this.removeI18n).click(function(evt){this.removeScreencast(id)}.bind(this));listItem.append(removeLink)}return listItem},removeScreencast:function(id){var filtered_array=[];$.each(this.screencasts,function(index,screencast){if(screencast.id!=id){filtered_array.push(screencast)}});this.screencasts=filtered_array;$("#screencast-"+id).remove()},_injectScreencasts:function(element){var name_prefix="ticket[screencasts][]",attributes_to_send=Array("position","id","url","thumbnail");$.each(this.screencasts,function(index,screencast){$.each(attributes_to_send,function(index,attribute){$('<input type="hidden" />').attr("name",name_prefix+"["+attribute+"]").attr("value",screencast[attribute]).appendTo(element)})})},_screenrBaseDomain:function(){return(this.domainUrl.replace(/^[^.]+./g,""))},_extraParamsForScreenr:function(){return{}},afterInit:function(){},showScreencast:function(url,comment){}}}(jQuery));(function($){Zendesk.NS("Screenr");Zendesk.Screenr.TicketRecorder=$.extend({},Zendesk.Screenr.BaseRecorder,{afterInit:function(){var originalSubmitTicketForm=submitTicketForm;submitTicketForm=function(){Zendesk.Screenr.TicketRecorder._injectScreencasts($("#ticket-chat"));originalSubmitTicketForm()};var originalSubmitRequestForm=submitRequestForm;submitRequestForm=function(){Zendesk.Screenr.TicketRecorder._injectScreencasts($("#ticketform"));originalSubmitRequestForm()};$("#screenr_link").bind("click",function(){Zendesk.Instrumentation.ToTango.track("New Screencast in Ticket","Screenr")})},showScreencast:function(url){var iframe=$('<iframe frameborder="0"/>'),preview=$('<div id="screencast_preview" />'),wrapper=$('<div id="screencast_preview_wrapper" style="display:none"/>'),comment_wrapper=$('<div id="comment_wrapper" />'),video_wrapper=$('<div id="video_wrapper" />'),comment=$("#comment_for_screencasts_list").clone().show(),colorbox_height;iframe.attr("src",url);iframe.attr("width",this.SCREENCAST_IFRAME_WIDTH);iframe.attr("height",this.SCREENCAST_IFRAME_HEIGHT);iframe.attr("style","width:"+this.SCREENCAST_IFRAME_WIDTH+"px;height:"+this.SCREENCAST_IFRAME_HEIGHT+"px;");iframe.appendTo(video_wrapper);video_wrapper.appendTo(preview);if(comment==null){colorbox_height=this.COLORBOX_HEIGHT}else{colorbox_height=this.COLORBOX_HEIGHT+this.COMMENT_HEIGHT;comment.appendTo(comment_wrapper);comment_wrapper.appendTo(preview)}preview.appendTo(wrapper);wrapper.appendTo($("body"));$.colorbox({inline:true,href:"#screencast_preview",width:this.COLORBOX_WIDTH+"px",height:colorbox_height+"px",onClosed:function(){$("#screencast_preview_wrapper").remove()}})}})}(jQuery));