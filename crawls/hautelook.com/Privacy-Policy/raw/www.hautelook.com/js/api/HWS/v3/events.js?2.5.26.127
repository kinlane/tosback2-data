if("undefined"===typeof HWS)var HWS={};"undefined"===typeof HWS.v3&&(HWS.v3={});HWS.v3.events={};
HWS.v3.events.object=function(a){this.event_id=a.event_id;this.title=a.title;this.tagline=a.tagline;this.event_code=a.event_code;this.img_url=a.image_url;this.brand_name=a.title;this.category=a.tagline;for(var c=a.event_types,b=0,f=0;f<c.length;f++){var g=c[f].name;g=="Women"?b=b|1:g=="Beauty"?b=b|2:c[f].name=="Home"?b=b|4:c[f].name=="Kids"?b=b|8:c[f].name=="Men"?b=b|16:c[f].name=="Getaways"&&(b=b|64)}this.event_type=b;this.event_display_format=a.event_display_format;this.meta=a.meta;this.coa=a.coa;
this.meta.msa.length==0&&delete this.meta.msa;this.start_date=$Halo.date(a.start_date);this.raw_start_date=$Halo.date(a.start_date);this.end_date=$Halo.date(a.end_date);this.raw_end_date=$Halo.date(a.end_date);this.start_date=this.start_date.getTime()+this.start_date.getTimezoneOffset()*60;this.end_date=this.end_date.getTime()+this.end_date.getTimezoneOffset()*60};
HWS.v3.events.buildEventData=function(a){for(var c=[],b=[],f=0,g=0;g<a.length;g++){var e=a[g];if(typeof b[e.start_date]=="undefined"){b[e.start_date]=f;f++}var d=b[e.start_date];typeof c[d]=="undefined"&&(c[d]=[]);c[d].push({});c[d][c[d].length-1][e.event_id]=e}return c};
HWS.v3.events.events=function(a){var c="/v3/events";a.upcoming_soon_days&&(c=c+("?upcoming_soon_days="+a.upcoming_soon_days));$.ajax({url:c,type:"get",dataType:"json",useREST:true,haloHandleAjaxResponse:true,haloFail:a.onFailure,haloSuccess:function(b,c,g){if(typeof a.onSuccess=="function"){if(typeof a.dont_convert==="undefined"){for(var e=b,d=0,b=[],d=0;d<e.events.today.length;d++)b.push(new HWS.v3.events.object(e.events.today[d].event));for(var h=[],d=0;d<e.events.upcoming.length;d++)h.push(new HWS.v3.events.object(e.events.upcoming[d].event));
for(var i=[],d=0;d<e.events.ending_soon.length;d++)i.push(new HWS.v3.events.object(e.events.ending_soon[d].event));e={};e.current=HWS.v3.events.buildEventData(b);e.coming_soon=HWS.v3.events.buildEventData(h);e.yesterday=HWS.v3.events.buildEventData(i);b=e}a.onSuccess(b,c,g)}},complete:a.complete})};
HWS.v3.events.event=function(a){$.ajax({url:"/v3/event/"+a.event_id,type:"get",dataType:"json",useREST:true,haloHandleAjaxResponse:true,haloFail:a.onFailure,haloSuccess:function(c,b,f){c=new HWS.v3.events.object(c.event);if(typeof a.onSuccess=="function")a.onSuccess(HWS.v3.events.buildEventData([c]),b,f)},complete:a.complete})};
