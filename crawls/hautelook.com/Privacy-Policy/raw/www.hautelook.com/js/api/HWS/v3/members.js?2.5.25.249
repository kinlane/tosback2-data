if(typeof HWS==="undefined")var HWS={};if(typeof HWS.v3==="undefined")HWS.v3={};HWS.v3.member={};HWS.v3.member.invitations={};HWS.v3.member.share={};HWS.v3.member.promotions={};
HWS.v3.member.invitations.post=function(e){var l=function(){for(var b=function(i){i=i[0].error.messages;for(var p=[],m=0;m<i.length;m++)p.push({invitation:i[m].message.invitation});return p},c=j.successes,h=j.failures,d={invitations:[]},a=0;a<c.length;a++)$.merge(d.invitations,c[a].invitations);for(c=0;c<h.length;c++){a=b(h[c]);$.merge(d.invitations,a)}h.length>0?e.onFailure(d):e.onSuccess(d)},n=function(){g++;g==k.length&&l()},o=function(b){j.failures.push(b);n()},q=function(b){j.successes.push(b);
n()},f=JSON.parse(e.data),g=0,k=function(b,c){for(var h=[],d=[],a=0;a<b.length;a+=100){var i=b.slice(a,a+100);h.push(i)}for(b=0;b<h.length;b++){a={};a.invitations={};a.invitations.emails=h[b];a.invitations.personal_message=c;d.push(a)}return d}(f.invitations.emails,f.invitations.personal_message),j={successes:[],failures:[]};for(f=0;f<k.length;f++)$.ajax({url:"/v3/member/"+e.member_id+"/invitations",type:"post",dataType:"json",data:JSON.stringify(k[f]),useREST:true,haloHandleAjaxResponse:true,haloFail:o,
haloSuccess:q})};
HWS.v3.member.share.post=function(e){for(var l=function(){for(var b=function(i){i=i[0].error.messages;for(var p=[],m=0;m<i.length;m++)p.push({invitation:i[m].message.invitation});return p},c=k.successes,h=k.failures,d={invitations:[]},a=0;a<c.length;a++)$.merge(d.invitations,c[a].invitations);for(c=0;c<h.length;c++){a=b(h[c]);$.merge(d.invitations,a)}h.length>0?e.onFailure(d):e.onSuccess(d)},n=function(){f++;f==g.length&&l()},o=function(b){k.failures.push(b);n()},q=function(b){k.successes.push(b);n()},
f=0,g=function(b){for(var c=[],h=[],d=0;d<b.emails.length;d+=100){var a=b.emails.slice(d,d+100);c.push(a)}for(d=0;d<c.length;d++){a={};a.emails=c[d];a.personal_message=b.personal_message;a.type=b.type;a.event_id=b.event_id;a.brand_name=b.brand_name;a.url=b.url;h.push(a)}return h}(JSON.parse(e.data)),k={successes:[],failures:[]},j=0;j<g.length;j++)$.ajax({url:"/v3/member/"+e.member_id+"/share",type:"post",dataType:"json",data:JSON.stringify(g[j]),useREST:true,haloHandleAjaxResponse:true,haloFail:o,
haloSuccess:q})};HWS.v3.member.promotions.get=function(e){$.ajax({url:"/v3/member/"+e.member_id+"/promotions",type:"get",dataType:"json",useREST:true,haloHandleAjaxResponse:true,haloFail:e.onFail,haloSuccess:function(l){if(typeof e.onSuccess==="function"){l=HWS.v3.member.promotions.translate(l);e.onSuccess(l)}}})};
HWS.v3.member.promotions.translate=function(e){var l=[],n=function(f){var g=new HWS.models.promotion;g.start_date=f.start_date;g.end_date=f.end_date;g.modified_date=f.modified_date;g.section=f.promo_section;g.placement=f.promo_placement;g.resource=f.promo_resource;g.type=f.promo_type;g.sort=f.promo_placement_sort;g.event_tabs=function(k){for(var j=[],b=0;b<k.length;b++){var c=k[b].event_tab.name.toLowerCase();if(c=="all events")c="all";j.push(c)}return j}(f.event_tabs);return g};e=e.promotions;for(var o=
0;o<e.length;o++){var q=n(e[o].promotion);l.push(q)}return l};
