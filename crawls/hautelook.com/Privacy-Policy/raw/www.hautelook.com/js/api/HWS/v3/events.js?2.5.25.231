if(typeof HWS==="undefined")var HWS={};if(typeof HWS.v3==="undefined")HWS.v3={};HWS.v3.events={};
HWS.v3.events.object=function(a){this.event_id=a.event_id;this.title=a.title;this.tagline=a.tagline;this.event_code=a.event_code;this.img_url=a.image_url;this.brand_name=a.title;this.category=a.tagline;this.event_type=function(d){for(var e=0,b=0;b<d.length;b++){var c=d[b].name;if(c=="Women")e|=1;else if(c=="Beauty")e|=2;else if(d[b].name=="Home")e|=4;else if(d[b].name=="Kids")e|=8;else if(d[b].name=="Men")e|=16;else if(d[b].name=="Getaways")e|=64}return e}(a.event_types);this.event_display_format=
a.event_display_format;this.meta=a.meta;this.coa=a.coa;this.meta.msa.length==0&&delete this.meta.msa;this.start_date=$Halo.date(a.start_date);this.raw_start_date=$Halo.date(a.start_date);this.end_date=$Halo.date(a.end_date);this.raw_end_date=$Halo.date(a.end_date);this.start_date=this.start_date.getTime()+this.start_date.getTimezoneOffset()*60;this.end_date=this.end_date.getTime()+this.end_date.getTimezoneOffset()*60};
HWS.v3.events.buildEventData=function(a){for(var d=[],e=[],b=0,c=0;c<a.length;c++){var f=a[c];if(typeof e[f.start_date]=="undefined"){e[f.start_date]=b;b++}var g=e[f.start_date];if(typeof d[g]=="undefined")d[g]=[];d[g].push({});d[g][d[g].length-1][f.event_id]=f}return d};
HWS.v3.events.events=function(a){var d=function(b){var c=0,f=[];for(c=0;c<b.events.today.length;c++)f.push(new HWS.v3.events.object(b.events.today[c].event));var g=[];for(c=0;c<b.events.upcoming.length;c++)g.push(new HWS.v3.events.object(b.events.upcoming[c].event));var h=[];for(c=0;c<b.events.ending_soon.length;c++)h.push(new HWS.v3.events.object(b.events.ending_soon[c].event));b={};b.current=HWS.v3.events.buildEventData(f);b.coming_soon=HWS.v3.events.buildEventData(g);b.yesterday=HWS.v3.events.buildEventData(h);
return b},e="/v3/events";if(a.upcoming_soon_days)e+="?upcoming_soon_days="+a.upcoming_soon_days;$.ajax({url:e,type:"get",dataType:"json",useREST:true,haloHandleAjaxResponse:true,haloFail:a.onFailure,haloSuccess:function(b,c,f){if(typeof a.onSuccess=="function"){b=b;if(typeof a.dont_convert==="undefined")b=d(b);a.onSuccess(b,c,f)}},complete:a.complete})};
HWS.v3.events.event=function(a){$.ajax({url:"/v3/event/"+a.event_id,type:"get",dataType:"json",useREST:true,haloHandleAjaxResponse:true,haloFail:a.onFailure,haloSuccess:function(d,e,b){d=new HWS.v3.events.object(d.event);typeof a.onSuccess=="function"&&a.onSuccess(HWS.v3.events.buildEventData([d]),e,b)},complete:a.complete})};
