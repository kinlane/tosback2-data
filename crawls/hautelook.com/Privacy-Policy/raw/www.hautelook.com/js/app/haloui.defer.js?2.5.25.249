var HaloUI=HaloUI||{};HaloUI.fn=HaloUI.fn||{};HaloUI.fn.toArray=function(a){return HaloUI.fn.isArray(a)?a:[a]};HaloUI.fn.isArray=function(a){return Object.prototype.toString.call(a)==="[object Array]"};HaloUI.Defer=function(){var a=new HaloUI.Deferred;return{promise:a.promise,fulfiller:function(){a.callback&&a.callback.apply(a,arguments)}}};
HaloUI.Deferred=function(){if(!(this instanceof HaloUI.Deferred))return new HaloUI.Deferred(arguments);this.complete=false;this.callbacksOnSuccess=[];this.callbacksOnFail=[];this.chain=false;this.promise=new HaloUI.Deferred.Promise($.proxy(this.then,this),$.proxy(this.fail,this));return this};HaloUI.Deferred.Promise=function(a,b){if(!(this instanceof HaloUI.Deferred.Promise))return new HaloUI.Deferred.Promise(arguments);this.then=a;this.fail=b;return this};
HaloUI.Deferred.prototype.then=function(a){a=HaloUI.fn.toArray(a);for(var b=0,c=a.length;b<c;b++)if(typeof a[b]==="function")if(this.complete&&this.success)a[b].apply(a[b],this.data);else if(this.complete)break;else this.callbacksOnSuccess.push(a[b]);else throw new TypeError("Non-function parameter specified as callback");this.chain=this.chain||HaloUI.Defer();return this.chain.promise};
HaloUI.Deferred.prototype.fail=function(a){a=HaloUI.fn.toArray(a);for(var b=0,c=a.length;b<c;b++)if(typeof a[b]==="function")if(this.complete&&!this.success)a[b].apply(a[b],this.data);else if(this.complete)break;else this.callbacksOnFail.push(a[b]);else throw new TypeError("Non-function parameter specified as callback");this.chain=this.chain||HaloUI.Defer();return this.chain.promise};
HaloUI.Deferred.prototype.triggerCallbacks=function(a){a=HaloUI.fn.toArray(a);for(var b=0,c=a.length;b<c;b++)a[b].apply(a[b],this.data)};HaloUI.Deferred.prototype.callback=function(){this.complete=true;this.success=!!Array.prototype.shift.call(arguments);this.data=Array.prototype.slice.call(arguments);this.triggerCallbacks(this["callbacksOn"+(this.success?"Success":"Fail")]);this.callback=null;this.chain&&this.chain.fulfiller.apply(this,[this.success].concat(this.data))};
HaloUI.Deferred.prototype.addToList=function(a,b){a=HaloUI.fn.toArray(a);for(var c=0,d=a.length;c<d;c++)if(typeof a[c]==="function")b.push(a[c]);else throw new TypeError("Non-function parameter specified as callback");this.chain=this.chain||HaloUI.Defer()};
