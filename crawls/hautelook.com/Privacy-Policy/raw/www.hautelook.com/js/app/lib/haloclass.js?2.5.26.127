var $Halo=$Halo||{};$Halo.Obj=$Halo.Obj||function(){};
$Halo.Obj.prototype.verify=function(a,b){if(!(a instanceof Array))throw new TypeError("Parameter 'propList' must be an Array");for(var c=b||[],e=this.getDefaults(),d=0,g=a.length,f=!1,i=!1,h=!1;d<g;){if(e[a[d]]===this[a[d]])throw Error("Property: '"+a[d]+"' is set to default.");d++}d=0;for(g=c.length;d<g;){f=c[d];if(!(f instanceof Array))throw new TypeError("Each entry in deepProps must also be an array");i=Halo.blaze(0,f,e);h=Halo.blaze(0,f,this);if("undefined"===typeof h)throw Error("Property chain: "+
f.toString()+" was undefined, or the chain was invalid.");if(i===h)throw Error("Property chain: "+f.toString()+" was set to default.");d++}return!0};$Halo.Obj.prototype.getJSON=function(a){return"string"===a?JSON.stringify(this):"object"===a?JSON.parse(JSON.stringify(this)):!1};$Halo.Obj.prototype.clone=function(){return Halo.clone(this)};$Halo.Obj.prototype.getDefaults=function(){return{}};
$Halo.EstimatedDeliveryDateFormatter=$Halo.EstimatedDeliveryDateFormatter||function(a){var b=function(a){return(new Date(a.split("-")[2],a.split("-")[0]-1,a.split("-")[1])).toDateString().substring(0,3)+" "+a.split("-")[0]+"/"+a.split("-")[1]+"/"+a.split("-")[2].substring(2)};return b(a.estimated_delivery.start_date)+" to "+b(a.estimated_delivery.end_date)};
$Halo.DataHandler=$Halo.DataHandler||function(a){a=a||{};this.name=a.name||null;this.url=a.url||null;this.settings={useCache:a.cache||!1,useStorage:a.storage||!1,storageLength:a.storageLength||3E5,storageLocations:a.storageLocations||["local","session"],parameters:new $Halo.DataHandlerParameterCollection};this.requests=[];for(var b=HaloUI.fn.isArray(a.parameters)&&a.parameters.length,c=null,e=0;e<b;e++)c=a.parameters[e],"string"==typeof c&&(c={},c.name=a.parameters[e]),this.settings.parameters.add(c)};
$Halo.DataHandler.prototype.name="";$Halo.DataHandler.prototype.url="";$Halo.DataHandler.prototype.success=function(a,b,c){b.fulfiller(!0,c);this.store(a,c)};$Halo.DataHandler.prototype.failure=function(a,b,c){b.fulfiller(!1,c)};$Halo.DataHandler.prototype.store=function(a,b){var c=!1;this.settings.useStorage&&(c=BrowserStorage.setStorageEngines(this.settings.storageLocations).set(this.name+a,b,this.settings.storageLength||null));return c};
$Halo.DataHandler.prototype.getStorageData=function(){if(this.settings.useStorage)return BrowserStorage.setStorageEngines(this.settings.storageLocations).get(this.name+reqUrl)};$Halo.DataHandler.prototype.clearCache=function(){delete this.requests;this.requests=[]};
$Halo.DataHandler.prototype.getData=function(a){var b=this.settings.parameters.buildUrl(this.url,a),c;b in this.requests?c=this.requests[b]:(c=HaloUI.Defer(),this.settings.useCache&&(this.requests[b]=c),this.getStorageData(b)||Halo.REST({url:b,type:"GET",error:$.proxy(function(a){this.failure(b,c,a)},this),success:$.proxy(function(a){this.success(b,c,a)},this)}));return c.promise};
$Halo.DataHandlerParameter=$Halo.DataHandlerParameter||function(a){a=a||{};this.name=a.name||"";this.token=a.token||"#"+this.name;this.type=a.type||"string";this.required=!!a.required};
$Halo.DataHandlerParameter.prototype.cleanValue=function(a){var b=null;if("undefined"===typeof a||"function"===typeof a||"object"===typeof a)throw Error("Only primitive types can be used for parameter values.");"string"==this.type&&(b=a+"");if("number"==this.type&&(b=+a,isNaN(b)))throw Error("Value could not be cast as a number");return b};
$Halo.DataHandlerParameter.prototype.replaceIn=function(a,b){var c=this.cleanValue(b);if("string"==typeof a)return a.replace(this.token,c);throw Error("Parameter 0 must be of type string");};$Halo.DataHandlerParameterCollection=$Halo.DataHandlerParameterCollection||function(){this._list=[]};$Halo.DataHandlerParameterCollection.prototype.add=function(a){if(a)for(var b=0,c=arguments.length;b<c;b++)arguments[b]&&this._list.push(new $Halo.DataHandlerParameter(arguments[b]))};
$Halo.DataHandlerParameterCollection.prototype.buildUrl=function(a,b){for(var c=0,e=this._list.length,d=a;c<e;c++)this._list[c].name in b&&(d=this._list[c].replaceIn(d,b[this._list[c].name]));return d};
