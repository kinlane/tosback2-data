var PrimaryMessageSnippet=function(){function f(e){for(var t=0;t<c().length;t++){if(e!=undefined){$(c()[t]).fadeOut(600);$(h()[t]).removeClass("primary-tabs-selected")}else{if(e!=t){$(c()[t]).stop(true,true).fadeOut(600);$(h()[t]).removeClass("primary-tabs-selected")}}}}function l(){return document.getElementById(t)}function c(){if(o==null){o=$("#primary-wrapper div."+e)}return o}function h(){if(u==null){u=$("#primary-wrapper div#"+t+" ul > li")}return u}function p(){if(a==null){a=$("#primary-wrapper div#"+t+" ul > li > a")}return a}function d(e){if(c().length>0){f();for(var t=0;t<p().length;t++){if(e.nodeName!="A"){while(e.nodeName!="A"&&e.nodeName!="BODY"){e=e.parentNode}}if(p()[t]==e){v(t);clearTimeout(i)}}}}function v(e){if(c().length>0){s=e;f(e);$(c()[e]).fadeIn(600);$(h()[e]).addClass("primary-tabs-selected")}}function m(e){if(c().length>0){for(var t=0;t<c().length;t++){if(t==e){c()[t].style.display="block"}else{c()[t].style.display="none"}}$(h()[e]).addClass("primary-tabs-selected");s=e}}function g(){if(r){i=setTimeout(function(){++s;if(s>=p().length){s=0}v(s);g()},n)}}var e="primary-panel";var t="primary-tabs";var n=5e3;var r=false;var i=0;var s=0;var o=null;var u=null;var a=null;return{init:function(n){$("div.primary-panel").each(function(){var e=$(this);var t=e.find("div.primary-pop-panel");var n=e.find("ul.primary-pop-nav a");t.hide().eq(0).show();n.eq(0).addClass("primary-pop-active");n.click(function(){var e=n.index(this);n.removeClass("primary-pop-active");$(this).addClass("primary-pop-active");t.hide();t.eq(e).show();return false})});if($("#primary-tabs").length>0){if($("#primary-tabs ul li").size()==1){$("#primary-tabs").css("display","none")}else{$("#primary-tabs").css("display","block").find("ul").addClass("primary-tabs-"+$("#primary-tabs ul li").size());var r="#"+t+" ul > li > a";$(r).click(function(e){if(typeof trackEvent!="undefined")trackEvent.event("event.link",{lid:$(this).attr("name").replace("&lid=","")});if($(this).parent().index()==s){return false}else{d(e.target);return false}});if(n==undefined){n=1}m(n-1);$("#primary-wrapper").hover(function(){clearTimeout(i)},function(){g()});g()}}$("#primary-wrapper "+"."+e).css({position:"absolute",visibility:"visible",left:0})},setAutoRotation:function(e){if(e==="false"){r=false}else if(e==="true"){r=true}else{r=e}},setRotationInterval:function(e){n=e*1e3}}}();(function(e){e.fn.extend({tCarousel:function(t){var n={tabs:true,carousel:true,netkernal:false,modelNumbers:true,header:this.parent().parent().find("h2")},r=e.extend(n,t);return this.each(function(){function u(e){var t,r;if(!o){n.addClass("tab-carousel")}n.find(".tab"+e+" div.tab-content").append('<div class="tab-slider-wrapper"><div class="tab-slider-inside"><div class="tab-slider'+e+' tab-slider"></div></div></div>');t=n.find(".tab"+e+" .tab-holder li.tab-item").size();r=185*t;n.find(".tab"+e+" ul.tab-holder").css({width:r,overflow:"hidden"});if(r<=440){n.find(".tab"+e+" .tab-slider-wrapper").css("display","none")}n.find(".tab-slider"+e).slider({animate:true,change:function(t,i){var s=r-n.find(".tab"+e+" .tab-scroll").width();n.find(".tab"+e+" .tab-scroll").animate({scrollLeft:i.value*(s/100)},1e3)},slide:function(t,i){var s=r-n.find(".tab"+e+" .tab-scroll").width();n.find(".tab"+e+" .tab-scroll").scrollLeft(i.value*(s/100))}})}function a(){var r,o;if(!s){n.addClass("tab-tabbed")}n.find(".tab0 h3.tab").addClass("tab-active");r=t.header.addClass("tab-header").width();o=r+20;n.find("h3.tab").each(function(t){e(this).css({top:"-29px",left:o+"px"});o=o+e(this).width()+20;if(t>0){n.find(".tab"+t+" .tab-content").hide();n.find(".tab"+t+" h3").addClass("tab-default")}});n.find("h3.tab").hover(function(){e(this).addClass("tab-over")},function(){e(this).removeClass("tab-over")});n.find("h3.tab").click(function(){var t=e(this).parent().attr("class").replace("tab","");if(i[t]==undefined){f(t)}n.find(".tab-content").hide();n.find(".tab"+t+" .tab-content").show();n.find("h3.tab").removeClass("tab-active");n.find("h3.tab").addClass("tab-default");n.find(".tab"+t+" h3").addClass("tab-active")})}function f(r){var f;i[r]=true;n.find(".tab"+r+" .tab-scroll").before('<img class="tab-loading" src="http://images.bestbuy.com/BestBuy_US/en_US/images/global/on/loading.gif" />');if(t.products[r].custom!=undefined){if(t.products[r].sort==undefined){t.products[r].sort="salesRankShortTerm.asc"}f="http://api.bbyremix.bestbuy.com/v1/products"+encodeURIComponent(t.products[r].custom)+"?apiKey=3m9usrb57uywm3yuqgzesh73&format=json&sort="+t.products[r].sort+"&show=url,sku,image,name,modelNumber,customerReviewAverage,customerReviewCount,planPrice,onSale,salePrice,regularPrice,advertisedPriceRestriction"}else{f="http://api.bbyremix.bestbuy.com/v1/products"+encodeURIComponent("(active=true&orderable in(Available,PreOrder)&categoryPath.id="+t.products[r].id+")")+"?apiKey=3m9usrb57uywm3yuqgzesh73&format=json&sort=salesRankShortTerm.asc&show=marketplace,url,sku,image,name,modelNumber,customerReviewAverage,customerReviewCount,planPrice,onSale,salePrice,regularPrice,advertisedPriceRestriction"}e.ajax({dataType:"jsonp",jsonp:"callback",jsonpCallback:"snippetCallback"+n.attr("id").replace(/[^a-zA-Z 0-9]+/g,""),url:f,cache:true,success:function(i){var f,l='<ul class="tab-holder">';e.each(i.products,function(e){var n;l+='<li class="tab-item"><div class="tab-image"><div><a href="'+i.products[e].url+'" name="&lid=tab_iamge_'+i.products[e].sku+'"><img src="'+i.products[e].image+'" /></a></div></div><h4><a href="'+i.products[e].url+'" name="&lid=tab_headline_'+i.products[e].sku+'">'+i.products[e].name.replace("<","").replace(">","")+"</a></h4><dl>";if(t.modelNumbers){if(i.products[e].modelNumber!=undefined){l=l+"<dt><strong>Model</strong>: </dt><dd>"+i.products[e].modelNumber+"</dd>"}}l=l+"<dt><strong>SKU</strong>: </dt><dd>"+i.products[e].sku+"</dd></dl>";if(i.products[e].customerReviewAverage!=null){n=""+i.products[e].customerReviewAverage.toFixed(1);n=n.replace(".","_");l+='<div class="tab-reviews"><img src="http://images.bestbuy.com/BestBuy_US/images/global/misc/ratings_star_'+n+'.gif" /> (<a href="'+i.products[e].url+'" name="&lid=tab_reviews_'+i.products[e].sku+'">'+i.products[e].customerReviewCount+" reviews</a>)</div>"}else{l+='<div class="tab-reviews"><img src="http://images.bestbuy.com/BestBuy_US/images/global/misc/ratings_star_0_0.gif" /> <a href="'+i.products[e].url+'" name="&lid=tab_reviews_'+i.products[e].sku+'">Write a review</a></div>'}l+="<p>";if(!i.products[e].advertisedPriceRestriction){if(i.products[e].planPrice!=null){l+="<strong>Price: $"+i.products[e].planPrice.toFixed(2)+"*</strong>"}else{if(i.products[e].onSale){l+="<strong>Sale: $"+i.products[e].salePrice.toFixed(2)+"</strong>"}else{l+="Price: $"+i.products[e].regularPrice.toFixed(2)}}}else{l+=""}l+="</p></li>"});l+='<div class="clearer"></div></ul>';if(t.products[r].disclaimer!=null){n.find(".tab"+r+" .tab-scroll").after("<small>* "+t.products[r].disclaimer+"</small>")}n.find(".tab"+r+" .tab-loading").css("display","none");if(t.products[r].shop==undefined){if(t.products[r].store==undefined){n.find(".tab"+r+" .tab-scroll").before('<p class="tab-see"><a href="http://www.bestbuy.com/site/olstemplatemapper.jsp?id=pcat17071&type=page&ks=960&st=%2F&sc=Global&cp=1&sp=&qp=crootcategoryid%23%23-1%23%23-1~~q2f~~nc'+t.products[r].id+'%23%237%23%231hi&list=y&usc=All+Categories&nrp=15&iht=n">Shop all '+t.products[r].name.replace("<","").replace(">","")+' &#8250;</a></p><div class="clearer"></div>')}else{n.find(".tab"+r+" .tab-scroll").before('<p class="tab-see"><a href="'+t.products[r].store+'">Shop all '+t.products[r].name.replace("<","").replace(">","")+' &#8250;</a></p><div class="clearer"></div>')}}else{n.find(".tab"+r+" .tab-scroll").before('<p class="tab-see"><a href="'+t.products[r].shop+'">Shop all '+t.products[r].name.replace("<","").replace(">","")+' &#8250;</a></p><div class="clearer"></div>')}n.find(".tab"+r+" .tab-scroll").html(l+'<div class="clearer"></div>');if(t.carousel){u(r);o=true}if(t.tabs&&!s){a();s=true}else if(!t.tabs&&!s){f=t.header.html()+" ";e.each(t.products,function(e){if(t.products.length==3){if(e==1){f=f+", "}if(e==2){f=f+", and "}}else if(t.products.length==2){if(e==1){f=f+" and "}}f=f+t.products[e].name.replace("<","").replace(">","")});t.header.html(f);s=true}},error:function(e){try{console.log("Something went wrong: "+e)}catch(t){}}})}function l(){var r;if(t.products.length<=4){r="";e.each(t.products,function(e){r+='<div class="tab'+e+'"><h3 class="tab">'+t.products[e].name.replace("<","").replace(">","")+'</h3><div class="tab-content"><div class="tab-scroll"></div></div></div>'});n.html(r);if(t.netkernal||!t.tabs){e.each(t.products,function(e){f(e)})}else{f(0)}}else{try{console.log("Best Selling Error: Too many tabs defined")}catch(i){}}}var t=r,n=e(this),i=new Array,s=false,o=false;n.addClass("tab-container");l()})}})})(jQuery);