/* Popular phrases - SWISSCOLONY - 18:14:9, Tue Mar 19, 2013 */
__SLI_ClientDefaults =
[
    ['Alignment', 'offsetrelative' ],
	['IE6SelectBox', true ],
    ['ShowBrandingFooter', false ],
];
var asPhrases=new Array ('candy','petit fours','easter baskets','easter','ham','cheesecake','sugar free products','cakes','fudge','cheese','sugar free','truffles','toffee','nuts','fruit','butter toffee','sale','cheese spreads','baklava','cashews','jelly beans','easter gifts','easter candy','torte','fruit cake','baskets','easter cakes','petit','spring cookies','red velvet','coconut','beef log','birthday','cake balls','fruit slices','lemon','careers','frog','bonbons','summer sausage','pecan','wreath','fruitcake','catalog','incredible spreadables','breakfast','coffee','beef jerky','ladybug','cheese cake','jelly belly','incredible petits fours','swiss cheese','birthday petit fours','macadamia nut chocolate','sausage','taffy','peanut brittle','mustard','brownies','lemon cheesecake','personalized hoodie zoo animals','banana foster bonbons','butterfly','pretzels','gluten free products','spring petit fours','tiger basket','coconut drops','chocolate','bark','bunny','dark chocolate','pistachios','popcorn','zoo basket trio','mint','wildflower tower','florentine lace cookies','ladybug truffles','mini butter toffee','oranges','mini petit fours','cookies in a tin','cheese slicer','jelly belly jelly beans','chocolate truffles','plush','red velvet petit fours','chocolate covered potato chips','easter family treats box','frog chocolates','coconut petits four','free shipping','spreads','tablet','chihuahua with candy','pillows','lemon cakes','spiral ham','pies','meat sticks','gummies','carrot cake','rum balls','mixed nuts','chickadee torte','cocktail jelly belly petit fours','ham\'s','hound with candy','pumpkin','personalized','chocolate covered cherries','peanut butter','sweet hot mustard','sugar free jelly bellies','throw','bunny log','happy birthday','petits fours gift','spring flower tower','cheese and sausage','sugar free cookies','spreadable cheese','petit four flavors','monkey backpack','saltwater taffy','bridge mix','ice cream cake balls','walkers scottie dog shortbread','shipping charges','easter cake trio','easter candy box','sugar free petits fours','shipping','strawberry','licorice','beef','red velvet cheesecake','spring candy','tea','easter petits fours','candy sampler','caramel','spring','cheese log','sausage and cheese bars','spreadables','toys','carrot cake petits fours','chocolate petit fours','frog truffle','spicy','sticky buns','personalized easter','meat','gluten free','cheese dips','baklava squares','fruit spread','chocolate pecan','pralines','cherries','fours','raspberry','bread','monkey','treasure chest','easter bunnies','strawberry petit fours','vintage cheddar cheese','lemon petit fours','honey glazed ham','wild game meat sticks','macadamia nuts','tarts','hoodie zoo animal','raspberry swirl cake','crrrisps','caramel pecan clusters','carrot cake balls','colossal breakfast','gummy fish','bee','dog with candy','chocolate cake','jerky','bunny tortes','ladybug chocolates','jelly belly bin','sugar free cheesecake','peanut butter and chocolate','mint torte','macadamia','petit fours gift box','sampler','baby swiss','chocolate fudge','shortbread','strawberry shortcake','summer sausage logs','classic spring chocolates','toffee brickle','lace cookies','log cake','peanut','dobosh','dog','butterfly chocolates','giraffe','mint chocolate chip cheesecake','banana','petit fours and bonbons','spring fruit gel slices','bananas foster','red velvet cake','trail mix','zoo','tea cakes','stollen','shipping included petit fours','pumpkin bark','beef sticks','dobosh torte','personalized mini easter petits fours','chocolate nuts','gummy candy','pecan clusters','elk sticks','cookies and creme','orange dreamsicle cake','strawberry daiquiri cheesecake','mini toffee','easter nibbles basket','gift boxes','beef sausage and cheese','licorice tin','crrrisps and spreads','blueberry pecan cookies','stuffed animals','personized zoo animals','lemon log','garden vegetable wheel','chocolate bunny','elephant','chihuahua','kreme kaese cheese','gift of plenty','towers','baby swiss cheese','tropical petit fours','log','happy birthday petit fours','wrapped candy','zoo animals','spring truffles','hummingbird throw','butterfly throw','coffee sampler','spring fruit','gummy peach rings','hoodie animals','fudge tin','breakfast gifts','candy sampler trio','spiral sliced ham','chocolate caramel and pecans','coconut cake','strawberry shortcake cheesecake','jelly belly jelly bean bin','ham links','watches','pancake mix','flock of sweet chicks','potato chips','jalapeno','ham and swiss','jam','gel slices','beef and cheese','mint chocolate','plush bunnies','dobosh cakes','easter lemon cake','pets','caramel apple cheesecake','candy eggs','fudge assortment','chocolate torte','baby','animal','easter boxes','cross watch','pen','easter boxes tower','bridge','dutch apple cake','27 favorites','pancakes','rocky road swirl cake','easter towers','deep dish apple pie','chocolate chip cookies gluten free','wildflower wreath','jewelry','bonbons fours','spiral','no sugar added trail mix','personalized mini','ham and bacon','favorite five','hot mustard','cheddar','bavarian bonbons','precious moments','valentines','mini easter petits fours','gift certificate','cheese and sausage gift','sausage and cheese box','mixed nuts tins','sugar free brownies','critter treat totes','walnut cookies','bouquet','candy tins','candy boxes','butter brickle toffee','sugarfree','brittle','jalapeno beef log','chocolate covered nuts','spring bridge mix','grapefruit','pumpkin coffee cake','jelly','forest friends log','trio','strawberry fudge','birthday brownie','linzer cookies','brownie cake','cake slices','easter splash basket','chips','chris mouse','fruit gels','salt and pepper','easter petit','extra smokey beef log','fruit cake cookies','chocolate potato chips','shipping chart','coffee cake','walkers','divinity','chocolate easter card','milk chocolate','backpack','chocolate strawberries','blueberry','strawberry teapot','jelly belly petits fours','pepperoni','angel','valencias','angel box','apple cinnamon pancake mix','gourmet brownies','colby cheese','banana split petite fours','brie','fruitcake cookies','easter eggs','blueberry cheese','scottie','spiral sliced ham with fired-in sugar glaze','christmas fruit cake','eggs','favorite five sausages','strawberry cake','roll','cheddar cheese','bunny salt and pepper shakers','mothers day','florentine','apple pie','tiger easter basket','chocolate covered macadamia nuts','summer','assorted petit fours','sugar free peanut brittle','port wine','personalize hoodie zoo','pet beds','monster cake balls','games','assortment','telescope','birthday gifts','pick and choose','pick n choose','cheese board','holiday blend coffee','lace','pork','gift sets','sweet and hot spreadables','wildflower','marble','liqueur cake','sugar free potato chip','fired in ham','no sugar','reed diffuser','salted caramels','personalized mini birthday petit fours','sugar free chips','pet products','french vanilla','personalized birthday cakes','treat box','mint fudge','all jewelry','sweet chicks','lemon danish cheesecake','personalized petit fours','oatmeal pumpkin cookies','meltaway wacky bugs','sugar free cheese cake','vanilla petits fours','jumbos','tool set','tiger','crystal pen','friendship plate','mouse','seafood','crrrrisps','daisy wreath','dog bed','gingerboy','apple cheese cake','bunny tower','lemon candy','bunny floral basket','apply for credit','cake rolls','chocolate toffee','chocolate layered mints','pistachios-tin','cheddar spread','zoo chocolates','gift sampler','maple','tea pot','bible','little lemon pies','orange cake','potato sticks','brickle','spicy cajun beef sticks','almond petit fours','kreme kaese','mini cakes','chick','32 snack','hound','sugar free peanut butter','raccoon cake','sandscape','butter crunch','pastel candy corn','special someone name pendant','32','boneless ham and baby swiss','big logs','lemon petits','pop','accessories','ice cream cake','easter basket lamb plush','flock of chicks','raspberry cake','mini cookie bites','26 holiday favorites','spiced pumpkins','bakery','glazed ham','cheese cake morsels','pastel petit fours','easter basket floral','incredible','smores barks','jumbo cashews','petite mints','sugar free fudge','sugar free macadamia','old fashioned fudge trio','raccoon','breakfast box','box','wildlife bottle opener','spring chocolates','malt','lion','pumpkin cookies','72 mini all occasion petit fours','computer mouse','cheese and nuts','let\'s go fishing set','sugar free cake','lamb cake','white lily','sugar free candy assortment','liqueur truffles','jelly bean tin','lobster dip','royal chocolate petits fours','mini-butter-toffee','ham and cheese','strawberry tea service','seafood incredible spreadables gift of 5','bee and flower','personalized fudge egg','belts','maple sugar','angel treasure chest','raccoon log','order','haystacks','lemon pies','macadamia chocolates','stick','marshmallow','conversation cakelet','fudge egg','black licorice','usb','stone ground mustard','recipes','almond crunch','sausage gift','smokey beef log','grandmother','mellocremes','spring fruit slices','mustard trio','swiss chees','sugar free mints','spring tower','liqueur','mini cookies','fruity cheese','boneless spiral sliced ham','carrot','owl','country favorites','pecan praline','shelled pistachios','all occasion petits fours','calories','port wine cheese','sugar free gluten free','blanket set','gluten free cheese cake','easter bunny treasure','mini fridge','peppermint candy','dream catcher','blue','bbq tool','cheddar and port','jelly bean assortment','cracker assortment','chickadee easter basket','garlic butter','crack','clusters','box towers','cream cheese spreads','box of chocolates','gift baskets','cajun beef sticks','strawberry cheesecake','sausage assortment','peach rings','chocolate potato','cherry cordials','mint cheesecake','11 piece personalized bbq tool set','chocolate candy','lemon cheese cake','caramel clusters','bison sticks','tiger and hoodie','ice cream balls','sugar-free cheesecake','gifts for him','alarm clock','milk chocolate butter toffee','pearl','happy','apple cake','spring brownies','pineapple cake','big red and swiss','apple pancake mix','caramel apple pie','cocktail jelly belly','garlic cheese','dark chocolate truffles','hot cajun beef sticks','vintage cheddar','fruit and nut delights','french onion','wisconsin cheddar spreads','story stix','sugar free cherries','socks','hummingbird','fruit cheese','hunting','wisconsin cheddar','easter splash','smoked bacon','muenster cheese','angel pendant','fudge trio','mint chocolate cheesecake','art','caramel pecan swirl','radio','mellow cheddar cheese spread','colby','sound','tea bags','swiss cake','bottle opener','sharp cheese','lily','florentine lace','honey ham','bison','ham and swiss cheese','crab delight','strawberry lemon','wax','gluten free almond','lemon bites','easter card','nut chocolate mix','ice cream','spring pretzels','bugs','dark truffles','smokey cheddar','cookie cake','ranch','sugar free truffles','venison sticks','tower of treats','herb garden','lucky irish coin pendant','lapsies','fruity and white cheddars','stretch ring','macadamia nut fruitcake','two tone cross pendant','sugar free gummy fish','peanut butter truffles','friends log','edam cheese','sugar free bread','deluxe mixed nuts','maple syrup','lite beef log','smores','butter brickle','ribbon','cheese wax','swirl cake','basket trio','little cakes','peanut butter candy','s\'mores bark','sugar free cherry cordials','stix','the swiss colony chocolate truffles','candy coated pretzels','jumbo cheese trio','honey','easter gift tower','smoked cheddar cheese spread','torte triple','creame de menthe','banana split','smart tablet','pastel coconut petit fours','coffee bark','cheese and crrrisps','onion cheese','gluten','swiss roll','lemon bark','pecan cheese log','dog pillow','caraway cheese','almond bark','gloves','butter pecan fudge','shell','ceramic','double guarantee','valencia oranges','butter stollen','family keepsake ornament','apple cheesecake','puppy dogs','cheese sampler','chocolate petit','lounge','chocolate covered mixed nuts','sunshine','fresh flowers','ship to canada','strawberry shortcake petit fours','apo gifts','chocolate cake balls','cordials','fruit spread sampler','muenster','western long sleeve tee','graham','totes','moon','peppermint candy bites','blueberry cookies','lime petits fours','confetti party bark','9','sixlets','no sugar added bread','tropical','ancho chili cake balls','onion dip','monkey backpack candy','port wine cheese spread','mixed nuts with 50% pistachios','gold','zoo basket','masterpiece baked ham','party','bacon cheese spread','food gifts','jelly cake','spice drops','pc','apo fpo gifts','chocolate gifts','pumpkin coffee','zigzag','luscious lemon cheesecake','happy easter petit fours','cheese and sausage sampler','nickel','dream','peach candy','send catalog','easter bunny torte','heart cake','savory','sugar free petit','buns','chocolate hearts','no peanuts','spring petit','valentine tower','birthday brownie cookie','nut fruitcake','lime','mix and match','no shipping','personalized chocolate','incredible-spreadables','breakfast and coffee','children','gluten free almond crunch','valentine cake','swiss and cheddar log','light up','butter toffe','lap','sentimental','mint chocolate chip','baker cheeses','premium nut','chocolate with pecans','50% off','cocktail','buttery toffee','cheese spread and crackers','gluten free mixes','personalized valentine','sugar free pecan clusters','pepper cheese','soft center','5','custom','mint chocolate torte','morsels','can','beans','bright eyes','sugar-free petite fours','swiss cheese spread','chocolate friend log','stargazer lily','sugar free fours','chocolate bites','stargazer','cheddar cheese spread','chocolate butter toffee','filled cookies','smiling monkeys','roast','cutting','my','creamy cheddar','hot','sugar free candy tin','cheddar cheese spreadable','pans','bacon cheddar','favorite five tortes','bread mix','buffalo nickel dream catcher pendant','valentine fudge','chocolate heart cake','big baby','bacon cheddar spread','filbert','peanut clusters','wireless','chees board','creme torte','lucky irish pendant','pepper seasoned bacon','sweet sausage','mint-chocolate-torte','gluten free cheese','mild jalapeno','maple links','spiral sliced ham with fired in sugar glaze','spinach supreme','sharp','deluxe','chocolate raisins','when will it be shipped','bacon log','smile','personalized animals','sugar free chocolate pecan fudge','smiley','fresh oranges','chocolate fudge petit four','chocolate bars','triple chocolate torte','swiss and ham cheese spread','orange bread','cheese ingredients','brazil','maple flavored ham links','spiral-sliced-ham','sugar free sale','11 piece bbq set','covered macadamia nuts','strawberry daiquiri','breakfast breads','bacon cheese log','chocolatey potato chips','phone to god','sausages n cheese bars gift of 9','chris card','stone','sweet basket','chocolate with nuts','special delivery','filbert creme','sugar free tower','chocolate nut tin','mixed nuts 50 pistachio','chocolate torte cake','boneless-ham','marble board slicer','petit f','salted nuts','five','sugar free holiday tower','santa jellies','send a gift','crab spread','maple ham','petit ours','chocolate buttons','spinach','boneless smoked ham','cheese sausage mustard','bone ham','mint dobosh torte','glaze','six','mixed chocolates','front five','merry christmas petit','cheese sausage torte gift samplers','cheese-cake','chris mouse pleaser','gift of 7','shoe shine kit','petit four gift samplers','cheese trio','two sweet','mini gift boxes','chocolate lovers','cheese sausage torte','forest cake','beef log gift of 6','maple sausage','pers giraffe hoodie','chees spread','mini butter toffe','chocolate cookies','silver','sausage and chees','sau','mouse cards','petit four tree','must','sweet bread','trio candy','genuine buffalo nickel dream catcher pendant','bacon smoked cheese spread','chocolate raspberry jellies','cheese sets','six gift sampler','the big ones','big baby swiss','cheese sausage and petit fours','chocolate mint cake','sausage and petit fours','cheese gift box','port wine cheese logs','bacon cheddar cheese spread','pj s','bu','pers pet carrier','sugar free christmas','sugar free pecan','swiss colony beef log','chocolate christmas mouse','chocolate trio','sausage and cheese tower','small tin','projector alarm clock','colossal','merry christmas chocolate','medley','case','chocolate grahams','masterpiece','crab cheese','chocolate covered cake','butter-toffee','chocolate bonbons','fruit nut breads and cremes gift of 7','swiss and sausage','sugar free fish','take five','sale postpaid','premium','gift of 72 petit fours','bible phone','cheese and fruit gifts','by christmas','#2 cheeses','personalized pet carrier','cheese box','sugar glazed ham','sugar free slices','chocolate tower','lucky irish','chocolate raccoon','baby swiss postpaid','swiss colony 27','temperature','sugar free gummies','shrimp cheese','holiday cakes','special blend coffee','sausage n cheese bars gift of 8','port wine with almonds','two hams','box summer sausage','carees','beef mustard','chocolate and mint logs','horatio','pers angel throw','snack size','front','game meat','hole punch','gift of 4 cheese and sausage','bone','cover','strawberry galettes','sugar free nuts','lil petites','sausage and candy','guardian treasure chest','coated pretzels','hand decorated holiday cookies','filled','spiral glazed ham','sugar free vanilla cheesecake','soaring eagle fleece','old fashion toffee','chocolate p','triple chocolate','old cookies','gel candy','beef log food gift combo','hugger','coin pendant','butter truffles','petit fours sugar','chocolate-filled straws','wrapped boxes');
/* $Revision: 6883 $
 *
 */

if(typeof(_sli_init )!='object'){var _sli_init=new Array();}
if(typeof(sli_init )!='function'){function sli_init(){ for(var x=0;x<_sli_init.length;x++) _sli_init[x]();}}
if(typeof(asPhrases)!='object'){ var asPhrases = new Array(); }
if(typeof(__SLI_customisations)!='object'){var __SLI_customisations = new Object();}
if(typeof(__SLI_ClientDefaults)!='object'){ var __SLI_ClientDefaults=[]; }
if(typeof(__SLI_validSearchBoxes)!='object'){ var __SLI_validSearchBoxes = new Array(); }
if(typeof(__SLI_asug_used_flag)!='object'){ var __SLI_asug_used_flag = false; }
if(typeof(__SLI_width)!='object'){ var __SLI_width = 0; }
if(typeof(sli_targeturl)!='object'){ var sli_targeturl = ""; }


    __AutoComplete = new Object(); //namespace...
    __AutoComplete_mouseMoved=false;

    // Basic UA detection
    isIE = document.all ? true : false;
    isGecko = navigator.userAgent.toLowerCase().indexOf('gecko') != -1;
    isOpera = navigator.userAgent.toLowerCase().indexOf('opera') != -1;

    /* defaults and options */

    var __SLI_ApplicationName = 'AutoSuggest';
        __SLI_customisations[ 'AutoSuggest' ] =
                {
                    'ShowBrandingFooter' : true
                    ,
                    'TextBoxIDPrefix' : 'sli_search_'
                    ,
                    'BrandingFooterImagePath' : 'http://assets.resultspage.com/autosuggest/sli_systems-powered_150_15.gif'
                    ,
                    'BrandingFooterTitleTooltip' : 'AutoSuggest Powered by SLI Systems'
                    ,
                    'DropListMinWidth' : 150
                    ,
                    'MaxListItems' : 10
                    ,
                    'Alignment' : true
                    ,
                    'TextBoxIDCustom' : []
                    ,
                    'ValidSearchBoxes' : false 
                    ,
                    'IE6SelectBox' : false 
                    ,
                    'IE6SelectBoxPadding' : 0
                    ,
                    'TargetURL' : ''
                    ,
                    'IframeAlignment' : false
                    ,
                    'AlignmentBorderBug' : false
                    ,
                    'IE6OnFocus' : false
                };
    /* 0 = keyname, 1 = value */
    for( defaultValuePair in __SLI_ClientDefaults )
    {
        __SLI_customisations[__SLI_ApplicationName][__SLI_ClientDefaults[defaultValuePair][0]]=__SLI_ClientDefaults[defaultValuePair][1];
    }

    /* pre-fetch branding footer image if being used...
     */
    if( __SLI_customisations[ __SLI_ApplicationName ][ 'ShowBrandingFooter' ] )
    {
        
        if(location.protocol == "https:")
        {
            __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ] = __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ].replace(/http:/i, 'https:');
        }
    
        var __AutoCompleteBranding = new Image();
        __AutoCompleteBranding.src=__SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ];
    }


    function AutoComplete_init()
    {
        if(!isOpera)
        {
            var oldonresize=function(){};
            if(typeof(window.onresize)=='function')
                oldonresize = window.onresize;//play nicely with other people's toys
            window.onresize= function(){ oldonresize(); AutoComplete_HideAll(); AutoComplete_Create( asPhrases ); }

            AutoComplete_Create( asPhrases );
            
            var els = document.getElementsByTagName('input');
            if(els)
            {
               for ( i = 0; i < els.length; i++ )
               {
                  if(els[i].name == "asug")
                  {
                     els[i].disabled = true;
                  }
               }
            }
        }
    }




    /**
    * Attachs the autocomplete object to a form element. Sets
    * onkeypress event on the form element.
    *
    * @param string formElement Name of form element to attach to
    * @param array  data        Array of strings of which to use as the autocomplete data
    */
    //function AutoComplete_Create (id, data)
    /*
     * iterate over 'sli_search_*' assumes one or more search boxes numbered from 1...
    */
    function AutoComplete_Create( data )
    {
        var idx=1, e, id, searchBoxPrefix=__SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDPrefix' ];
        while( e = document.getElementById(searchBoxPrefix+idx) )
        {
            AutoComplete_AttachHandlers(e, data);
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
                __SLI_validSearchBoxes.push(searchBoxPrefix+idx);
            }
            idx++;
        }
        
        
        //this array comes from the customised list
        var otherTextBoxIdList = __SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDCustom' ];
        if( otherTextBoxIdList)
        {
            for(idx=0;idx<otherTextBoxIdList.length;idx++)
            {
                e = document.getElementById(otherTextBoxIdList[idx]);
                if(e)
				{
					if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
                	{
	                    __SLI_validSearchBoxes.push( otherTextBoxIdList[idx] );
                	}
					AutoComplete_AttachHandlers(e, data);
				}
            }
        }
        
    } 

    function AutoComplete_AttachHandlers(e, data){
        var iframe,id;
        id=e.id;


        __AutoComplete[id] = {'data':data,
                              'isVisible':false,
                              'element':document.getElementById(id),
                              'dropdown':null,
                              'highlighted':null};

        __AutoComplete[id]['element'].setAttribute('autocomplete', 'off');
        __AutoComplete[id]['element'].onkeydown = function(e) {if (!e) e = window.event; return AutoComplete_KeyDown(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onkeyup = function(e) {if (!e) e = window.event; return AutoComplete_KeyUp(this.getAttribute('id'), e);}
        // The function call on the next line was changed by Andrew Grieve April 2008
        __AutoComplete[id]['element'].onkeypress = function(e) {if (!e) e = window.event; return AutoComplete_KeyPress(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onclick = function(e)
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6OnFocus' ] )
            {
                __AutoComplete[id]['element'].focus();
            }
            if (!e) e = window.event; e.cancelBubble = true; e.returnValue = false;
        }



        // Hides the dropdowns when document clicked
        var docClick = function()
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
            }
            else
            {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
            }
        }

        if (document.addEventListener) {
            document.addEventListener('click', docClick, false);
        } else if (document.attachEvent) {
            document.attachEvent('onclick', docClick, false);
        }


        // Max number of items shown at once
        if (arguments[2] != null) {
            __AutoComplete[id]['maxitems'] = arguments[2];
            __AutoComplete[id]['firstItemShowing'] = 0;
            __AutoComplete[id]['lastItemShowing'] = arguments[2] - 1;
        }

        AutoComplete_CreateDropdown(id);

        // Prevent select dropdowns showing thru
        if (isIE) {
            iframe = document.createElement('iframe');
            __AutoComplete[id]['iframe'] = iframe;
                iframe.id = id +'_iframe';
                iframe.style.position = 'absolute';
                iframe.style.top = '0';
                iframe.style.left = '0';
                iframe.style.width = '0px';
                iframe.style.height = '0px';
                iframe.style.zIndex = '98';
                iframe.style.visibility = 'hidden';
                
                if(location.protocol == "https:")
                {
                   iframe.src = 'https://assets.resultspage.com/autosuggest/blank.html';
                }
                
                if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBox' ] )
                {
                  iframe.style.width = __SLI_width  + __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBoxPadding'];
                }

            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IframeAlignment' ] )
            {
                document.body.insertBefore( iframe );
            }
            else
            {
                __AutoComplete[id]['element'].parentNode.insertBefore( iframe, __AutoComplete[id]['element'] );
            }
        }
    }

    /**
    * Creates the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_CreateDropdown(id)
    {
        var theSearchbox = __AutoComplete[id]['element'];
        var theDropDown;
        var left_top = AutoComplete_getPos( theSearchbox );
        var left  = left_top[0];
        var top   = left_top[1] + theSearchbox.offsetHeight;
        var width = theSearchbox.offsetWidth;

        if ( width < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
        {
            width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
        }

        theDropDown = document.createElement('div');
        theDropDown.className = 'autocomplete'; // Don't use setAttribute()


        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true && document.body)
        {
            theDropDown.style.position = 'absolute';
            document.body.insertBefore(theDropDown, document.body.nextSibling);
            
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        else if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "offsetrelative" && document.body)
        {
          theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
          // Position it
          if(sli_getStyle(theSearchbox.offsetParent, 'position') != "absolute")
          {
            theSearchbox.offsetParent.style.position = 'relative';
          }
          theDropDown.style.position = 'absolute';
          theDropDown.style.left = (theSearchbox.offsetLeft) + 'px';
          theDropDown.style.top = (theSearchbox.offsetTop + theSearchbox.offsetHeight) + 'px';
          if ( theSearchbox.clientWidth < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
          {
            theDropDown.style.width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
          }
          else
          {
            theDropDown.style.width = (theSearchbox.clientWidth) + 'px';
          }
          theDropDown.style.visibility = 'hidden';
          theDropDown.style.zIndex     = '99999999';
        }
        else
        {
            theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        

        __AutoComplete[id]['dropdown'] = theDropDown;
        __SLI_width = width;
    }

    function /* array [ left, top ] */ AutoComplete_getPos( obj )
    {
        var curleft = curtop = 0;
        var sli_flag = 0;

        if (obj.offsetParent)
        {
           do
           {
              if ( __SLI_customisations[ __SLI_ApplicationName ][ 'AlignmentBorderBug' ] )
              {         
                
                if(sli_flag == 1)
                {
                    var clientTop = (obj.offsetHeight - obj.clientHeight) / 2;
                    curtop += clientTop;

                    var clientLeft = (obj.offsetWidth - obj.clientWidth) / 2;
                    curleft += clientLeft;
                }
                sli_flag = 1;
              }
           
              curleft += obj.offsetLeft;
              curtop += obj.offsetTop;
           }
           while (obj = obj.offsetParent);
        }
        return [curleft,curtop];
    }

    /**
    * Shows the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ShowDropdown(id)
    {

        AutoComplete_HideAll();



        var value = __AutoComplete[id]['element'].value;
        var toDisplay = new Array();
        var newDiv    = null;
        var text      = null;
        var numItems  = __AutoComplete[id]['dropdown'].childNodes.length;

        __AutoComplete_mouseMoved=false;
        // SLI Code Modification - Start - Andrew Grieve April 08
        // Trim the textbox so that if is starts with a space then the feature will still work
        //value = value.replace(/^\s+|\s+$/g,"");
        value = value.replace(/^\s+/g,"");

        if(value.length == "")
        {
            // If Textbox length is nothing (after the trim) then don't show dropdown.
            return;
        }
        // SLI Code Modification - End

        // Remove all child nodes from dropdown
        while (__AutoComplete[id]['dropdown'].childNodes.length > 0) {
            __AutoComplete[id]['dropdown'].removeChild(__AutoComplete[id]['dropdown'].childNodes[0]);
        }


        var count=0;
        // Go thru data searching for matches
        for (i=0; i<__AutoComplete[id]['data'].length; ++i)
        {
            // SLI Code Modification - Start - Andrew Grieve April 08 - Added lower casing
            if (__AutoComplete[id]['data'][i].substr(0, value.length).toLowerCase() == value.toLowerCase())
            {
                // SLI Code Modification - End
                toDisplay[toDisplay.length] = __AutoComplete[id]['data'][i];
                count++;
                /* how many to display? */
                if(count == __SLI_customisations['AutoSuggest']['MaxListItems'] ) /* Code inserted to keep list to a maximum of 10 values (was 20 or 30) */
                {
                    break;
                }
            }
        }

        // No matches?
        if (toDisplay.length == 0) {
            AutoComplete_HideDropdown(id);
            return;
        }



        // Add data to the dropdown layer
        for (i=0; i<toDisplay.length; ++i) {
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_item'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';

             // Scrollbars are on display ?
            if (toDisplay.length > __AutoComplete[id]['maxitems'] && navigator.userAgent.indexOf('MSIE') == -1) {
                newDiv.style.width = __AutoComplete[id]['element'].offsetWidth - 22 + 'px';
            }

            newDiv.onmouseover =
        function()
        {
            if( __AutoComplete_mouseMoved )
                AutoComplete_HighlightItem(__AutoComplete[id]['element'].getAttribute('id'), this.getAttribute('index'));
        };

            newDiv.onclick     =    function()
                                    {
                                    	  __SLI_asug_used_flag = true;
                                                                           
                                        AutoComplete_SetValue(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_HideDropdown(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_submitForm(id);
                                    }



            text   = document.createTextNode(toDisplay[i]);
            newDiv.appendChild(text);
            newDiv.title='Search for ' + toDisplay[i];

            /* ellipsis for IE only */
            if( isIE )
            {
                newDiv.style.textOverflow = 'ellipsis';
                newDiv.style.width = '100%';
                newDiv.style.whiteSpace = 'nowrap';
                newDiv.style.overflow = 'hidden';

            }
            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }
        /*
         * append DIV containing footer branding...
         */
        if(__SLI_customisations['AutoSuggest']['ShowBrandingFooter'])
        {
            i = toDisplay.length;
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_footer'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';
            newDiv.innerHTML = '<a href="http://www.sli-systems.com/powered-by.php" title="' +
                                __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterTitleTooltip' ] +
                                '"><img class="autocomplete_footer_branding" src="'+__AutoCompleteBranding.src+'" /></a>';

            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }


        // Too many items?
        if (toDisplay.length > __AutoComplete[id]['maxitems']) {
            __AutoComplete[id]['dropdown'].style.height = (__AutoComplete[id]['maxitems'] * 15) + 2 + 'px';

        } else {
            __AutoComplete[id]['dropdown'].style.height = '';
        }


        /**
        * Set left/top in case of document movement/scroll/window resize etc
        */
        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "true" || __SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "false")
        {
            var left_top = AutoComplete_getPos( __AutoComplete[id]['element'] );
            __AutoComplete[id]['dropdown'].style.left = left_top[0];
            __AutoComplete[id]['dropdown'].style.top  = left_top[1] + __AutoComplete[id]['element'].offsetHeight;
        }


        // Show the iframe for IE
        if (isIE) {
            
            if(!__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true)
            {
               __AutoComplete[id]['iframe'].style.width  = __AutoComplete[id]['dropdown'].offsetWidth;
            }
            
            
            __AutoComplete[id]['iframe'].style.top    = __AutoComplete[id]['dropdown'].style.top;
            __AutoComplete[id]['iframe'].style.left   = __AutoComplete[id]['dropdown'].style.left;
            __AutoComplete[id]['iframe'].style.height = __AutoComplete[id]['dropdown'].offsetHeight;

            __AutoComplete[id]['iframe'].style.visibility = 'visible';
        }

    e =  __AutoComplete[id]['dropdown'];

    e.onmousemove =
        function()
        {
            if(!__AutoComplete_mouseMoved){__AutoComplete_mouseMoved=true;}
            this.onmousemove = null;
        }

        // Show dropdown
        if (!__AutoComplete[id]['isVisible']) {
            __AutoComplete[id]['dropdown'].style.visibility = 'visible';
            __AutoComplete[id]['isVisible'] = true;
        }


        // If now showing less items than before, reset the highlighted value
        if (__AutoComplete[id]['dropdown'].childNodes.length != numItems) {
            __AutoComplete[id]['highlighted'] = null;
        }
    }



    /**
    * Hides the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_HideDropdown(id)
    {
        if (__AutoComplete[id]['iframe'])
        {
            __AutoComplete[id]['iframe'].style.visibility = 'hidden';
        }
        
        if (__AutoComplete[id]['dropdown'])
        {
            __AutoComplete[id]['dropdown'].style.visibility = 'hidden';
        }

        __AutoComplete[id]['highlighted'] = null;
        __AutoComplete[id]['isVisible']   = false;
    }


    /**
    * Hides all dropdowns
    */
    function AutoComplete_HideAll()
    {
         if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
         {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
         }
         else
         {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
         }
    }


    /**
    * Highlights a specific item
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_HighlightItem(id, index) // mouseover, index is the list element index, zero-based
    {
        if (__AutoComplete[id]['dropdown'].childNodes[index]) {
            for (var i=0; i<__AutoComplete[id]['dropdown'].childNodes.length; ++i) {
                if (__AutoComplete[id]['dropdown'].childNodes[i].className == 'autocomplete_item_highlighted') {
                    __AutoComplete[id]['dropdown'].childNodes[i].className = 'autocomplete_item';
                }
            }

            __AutoComplete[id]['dropdown'].childNodes[index].className = 'autocomplete_item_highlighted';
            __AutoComplete[id]['highlighted'] = index;

            //also see below...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[index].innerHTML;
            //AutoComplete_SetValue(id);
        }
    }


    /**
    * Highlights the menu item with the given index
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_Highlight(id, index) // keyboard up/down - index is the direction of travel, 1==down,-1=up
    {
        var childNodes = __AutoComplete[id]['dropdown'].childNodes;
        if(childNodes.length)
        {
	        var lastItem = ( ( childNodes[ childNodes.length - 1 ].className != 'autocomplete_footer' ) ? childNodes.length - 1 : childNodes.length - 2 );

            // Out of bounds checking
            //if (index == 1 && __AutoComplete[id]['highlighted'] == __AutoComplete[id]['dropdown'].childNodes.length - 1) {
            if (index == 1 && __AutoComplete[id]['highlighted'] == lastItem ) {
                childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = null;

            } else if (index == -1 && __AutoComplete[id]['highlighted'] == 0) {
                childNodes[0].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = lastItem;
                index = 0;//hack!
            }

            // Nothing highlighted at the moment
            if (__AutoComplete[id]['highlighted'] == null) {

                childNodes[0].className = 'autocomplete_item_highlighted';
                __AutoComplete[id]['highlighted'] = 0;
                newIndex = 0;
                
            } else {

                if (childNodes[__AutoComplete[id]['highlighted']]) {
                
                    childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                }

                var newIndex = parseInt( __AutoComplete[id]['highlighted'] ) + parseInt(index);

                if (childNodes[newIndex]) {

                    childNodes[newIndex].className = 'autocomplete_item_highlighted';

                    __AutoComplete[id]['highlighted'] = newIndex;
                }
            }

            //populate textbox with currently highlighted term...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[newIndex].innerHTML;
            AutoComplete_SetValue(id);
        }
    }


    /**
    * Sets the input to a given value
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_SetValue(id)
    {
        __AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[__AutoComplete[id]['highlighted']].innerHTML.replace(/&amp;/, "&");
    }


    /**
    * Checks if the dropdown needs scrolling
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ScrollCheck(id)
    {
        // Scroll down, or wrapping around from scroll up
        if (__AutoComplete[id]['highlighted'] > __AutoComplete[id]['lastItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'] - (__AutoComplete[id]['maxitems'] - 1);
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'];
        }

        // Scroll up, or wrapping around from scroll down
        if (__AutoComplete[id]['highlighted'] < __AutoComplete[id]['firstItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'];
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'] + (__AutoComplete[id]['maxitems'] - 1);
        }

        __AutoComplete[id]['dropdown'].scrollTop = __AutoComplete[id]['firstItemShowing'] * 15;
    }


    /**
    * Function which handles the keypress event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyDown(id, e)
    {
        var result = true;

       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {

            // Return/Enter
            case 13:
                if (__AutoComplete[id]['highlighted'] != null) {
                    AutoComplete_SetValue(id);
                    AutoComplete_HideDropdown(id);
					
                    __SLI_asug_used_flag = true;
					
                    if( e = __AutoComplete[id]['element'].form['asug'] )
                    {
                        
                        e.disabled=false;
                        e.value = __AutoComplete[id]['asug'];
                    }

                }

                result = AutoComplete_submitForm(id);

                break;

            // Escape
            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            // Up arrow
            case 38:
                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, -1);
                AutoComplete_ScrollCheck(id, -1);
                
                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                                
                result = false;
                break;

            // Tab
            case 9:
                if (__AutoComplete[id]['isVisible']) {
                    AutoComplete_HideDropdown(id);
                }
                return;

            // Down arrow
            case 40:

                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, 1);
                //AutoComplete_ScrollCheck(id, 1);

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                result = false;
                break;
        }
        return result;
    }


    /**
    * Function which handles the keyup event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyUp(id, e)
    {
       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {
            case 13:
                event.returnValue = false;
                event.cancelBubble = true;
                
                break;

            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            case 38:
            case 40:
                return false;
                break;

            default:
                AutoComplete_ShowDropdown(id);
                
                __AutoComplete[id]['asug']=__AutoComplete[id]['element'].value;

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=true;
                   e.value = "";
                }  
                
                break;
        }
    }

    /**
    * Function which handles the keypress event
    * This function added April 2008 by Andrew Grieve
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */

    // SLI Code Modification - Start - Andrew Grieve April 08
    function AutoComplete_KeyPress(id, e)
    {
        var event = e;
        if(!event) event = window.event;
        var keyCode = event.keyCode;

        if (keyCode == 13 && isGecko || isOpera)
        {
            return false;
        }
        
        if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
        {
            if (keyCode == 13 && isIE)
            {
                return false;
            }
        }
        
    }
    // SLI Code Modification - End

    /**
    * Returns whether the dropdown is visible
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_isVisible(id)
    {
        return __AutoComplete[id]['dropdown'].style.visibility == 'visible';
    }

    function AutoComplete_submitForm(id)
    {
      var e, f, result=true;
      if( f = __AutoComplete[id]['element'].form )
      {
        if( __AutoComplete[id]['element'].value != '' )
        {
          if(__SLI_asug_used_flag == true)
          {
            if( e = f['asug'])
            {
              e.value = __AutoComplete[id]['asug'];
              e.disabled=false;
            }
          }

          if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
          {
            asugvar = "";
            if(__SLI_asug_used_flag == true)
            {
              asugvar = '&asug=' + escape(__AutoComplete[id]['asug']);
            }

            sliRegex = /resultsdemo\.com/;
            if(sliRegExArray = sliRegex.exec(document.domain))
            {
              sliRegex = /^http:\/\/(.*)\//;
              sliTargetDomain = sliRegex.exec(__SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ]);
              __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ].replace(sliTargetDomain[1], document.domain);
            }

            document.location.href = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] + escape(__AutoComplete[id]['element'].value) + asugvar;
          }
          else
          {
            if(f.onsubmit)
            {
              if(f.onsubmit() !== false)
              {
                f.submit();
              }
            }
            else
            {
              f.submit();
            }
          }

          AutoComplete_HideAll();
        }
        else
          result = false;
      }
      return result;
    }
    
    // get the style that will be applied by the browser, including stylesheets
    function sli_getStyle(el,styleProp)
    {
      if (el.currentStyle)
        var y = el.currentStyle[styleProp];
      else if (window.getComputedStyle)
        var y = document.defaultView.getComputedStyle(el,null).getPropertyValue(styleProp);
      return y;
    }

    // register with onLoad(er...
    _sli_init.push( AutoComplete_init );
    
    function sli_addEvent(obj, evType, fn) {
    	if (obj.addEventListener) {
    		obj.addEventListener(evType, fn, false);
    		return true;
    	} else if (obj.attachEvent) {
    		var r = obj.attachEvent("on" + evType, fn);
    		return r;
    	} else {
    		return false;
    	}
    }
    
    function sli_load()
    {
    	sli_addEvent(window, 'load', sli_init);
    }