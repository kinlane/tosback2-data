/* Popular phrases - SWISSCOLONY - 18:1:41, Tue Apr 2, 2013 */
__SLI_ClientDefaults =
[
    ['Alignment', 'offsetrelative' ],
	['IE6SelectBox', true ],
    ['ShowBrandingFooter', false ],
];
var asPhrases=new Array ('candy','petit fours','easter baskets','easter','ham','cheesecake','cakes','sugar free products','cheese','sugar free','fudge','cookies','toffee','easter candy','truffles','nuts','easter gifts','easter cakes','fruit','butter toffee','baklava','ham\'s','chocolate','jelly beans','cheese spreads','torte','fruit cake','spring cookies','sale','cheese cake','baskets','coconut','cashews','popcorn','lemon cakes','mustard','birthday','brownies','careers','taffy','oranges','pretzels','breakfast','incredible spreadables','red velvet','summer sausage','jelly belly jelly beans','sausage','petit','bark','jelly belly','gluten free products','carrot cake','incredible petits fours','petit fours gift box','gluten free','wreath','cake balls','carrot cake petits fours','fruitcake','frog','fruit slices','lemon','candy sampler','bunny','spiral sliced ham','chocolate bunny','pecan','peanut butter','catalog','coconut petits four','beef log','beef jerky','spiral ham','cheese slicer','mini petit fours','red velvet petit fours','pistachios','shortbread','peanut brittle','kreme kaese','food','chocolate covered potato chips','bread','pies','macadamia nut chocolate','sugar free cookies','beef','easter petits fours','mint','lemon cheesecake','honey glazed ham','easter bunnies','banana','spring flower tower','easter candy box','free shipping','sticky buns','dark chocolate','bonbons','glazed ham','birthday petit fours','coffee','ladybug','meat sticks','mixed nuts','sugar free jelly bellies','petits fours gift','spreads','banana foster bonbons','towers','cooking ham','tablet','plush','coconut cake','lemon petit fours','pumpkin','easter towers','gummies','ladybug truffles','butterfly','rum balls','coconut drops','chocolate truffles','chocolate covered cherries','personalized','birthday brownie','sampler','kreme kaese cheese','easter cake trio','easter boxes tower','spreadable cheese','pets','garden vegetable spread','mini butter toffee','carrot cake balls','spring petit fours','ice cream cake balls','red velvet cake','cheese log','pecan clusters','saltwater taffy','personalized hoodie zoo animals','florentine lace cookies','petit fours and bonbons','cocktail jelly belly petit fours','bunny log','monster cake balls','meat','pralines','dobosh cakes','dobosh','swiss cheese','bridge mix','carrot','ham and cheese','peanut butter and chocolate','watches','27 favorites','garlic cheese','chocolate pecan','jelly belly petits fours','spring','dips','hoodie zoo animal','grapefruit','shipping','sugar free petits fours','sausage and cheese bars','easter lemon cake','orange dreamsicle cake','sugar free cheesecake','14 country favorites','cookies in a tin','hound with candy','trail mix','animal','zoo basket trio','caramel','fudge assortment','dog with candy','licorice tin','chocolate fudge','pancake mix','monkey','caramel pecan clusters','birthday cakes','strawberry','cherries','shipping charges','dog','licorice','chocolate covered macadamia nuts','sweet hot mustard','tarts','log cake','walkers scottie dog shortbread','pillows','jumbos','macadamia nuts','baklava squares','raspberry swirl cake','sugar free or no sugar added','pancakes','ham and swiss','chick','zoo animals','favorites','baby swiss','spreadables','butterfly chocolates','baby swiss cheese','plush bunnies','giraffe','fresh flowers','seafood incredible spreadables gift of 5','games','cheese and sausage','bakery','pecan tarts','butterfly throw','tropical petit fours','personalized petit fours','hot mustard','lemon log','coffee sampler','mint chocolate','toys','tea','no sugar','spring candy','pumpkin cookies','petit four flavors','fruitcake cookies','lobster dip','wild game meat sticks','maple fudge','chocolate covered pecans','sugar free peanut brittle','dobosh torte','brittle','personalized mini easter petits fours','critter treat totes','candy sampler trio','beef and cheese','easter family','red velvet cheesecake','vintage cheddar cheese','gummy worms','jelly','slicer','macadamia','beef sticks','fruit spread','cheese and sausage gift','jumbo cashews','mint torte','raspberry','venison sticks','cracker assortment','gift boxes','spiced pumpkins','classic spring chocolates','apple pie','bavarian bonbons','mothers day','lemon tarts','scottie','tropical','summer sausage logs','throw','smoked cheddar','elk sticks','fruit cake cookies','tower of treats','strawberry shortcake','easter splash basket','happy birthday petit fours','spiral sliced ham with fired-in sugar glaze','cajun','masterpiece baked ham','spring fruit gel slices','petite mints','crrrisps and spreads','jelly bean assortment','fours','log','kreme','fudge tin','apply for credit','zoo basket','ladybug chocolates','tiger','mustard trio','crrrisps','bible','breakfast box','fruitful delight','bear','bananas foster','fudge egg','pet beds','27','raccoon','mini cakes','mini easter petits fours','port wine cheese','walkers','precious moments','sugar free brownies','wild game','stollen','hummingbird throw','blueberry pecan cookies','jalapeno beef log','mini toffee','chocolate torte','zoo','tea cakes','elephant','apple','chocolate petit fours','all occasion petits fours','cheddar cheese','spicy','mild jalapeno','brownie cake','easter nibbles basket','key lime','strawberry fudge','sugar free macadamia','venison','chickadee basket','monkey backpack','bunny tortes','strawberry petit fours','apple cinnamon pancake mix','milk chocolate','boneless ham','red velvet cake balls','baby','gifts under $20.00','sugar free chocolate pecan fudge','cream de mint','sunflower seeds','miniature baklava','mild cheese','fish','gummy fish','almond bark','cheddar','raspberry cheesecake','baked ham','meltaway wacky bugs','angel','chocolate layered mints','fleece jacket','chocolate covered nuts','sausage and cheese tower','shipping included petit fours','binoculars','chocolate raccoon','swiss creme graham','bee and flower','angel pendant','backpack','gel slices','lemon pies','friends log','petit four gift samplers','plush animals','personalized easter','chocolate chip cookies','easter basket chickadee','peanut butter bites','cheese dips','easter bunny torte','jelly bean petit fours','royal chocolate petits fours','personized zoo animals','chocolate covered','mint bark','bee cake','garlic sausage','vegetable dip','7-piece decanter set and big red cheddar','gluten free brownies','linzer','birthday petits','easter eggs','usb','peach cheesecake','rocky road swirl cake','raccoon log','gingerboy','bonbons fours','teapot','orange cake','hound','11 piece personalized bbq tool set','salt and pepper','melt','clusters','treasure chest','red velvet petits','lemon cake roll','chocolate cheese','order','marshmallow','almond crunch','bunny floral basket','easter boxes','potato sticks','scottie dog shortbread','2 piece pet bed','trifold art set','happy chickadee basket','flower tower','all cakes','lapsies','banana bread','strawberry teapot','basket trio','smart tablet','pumpkin coffee cake','banana split petite fours','cheese bars','sugar free assorted candy','bee','chocolate cake','mint cheesecake','mixed nuts tins','dutch apple cake','angel treasure chest','wildflower wreath','diet candy','fruit gel slices','forest friends log','elk','jam','strawberry cheesecake','all','paint','orange petits','milk chocolate candy','happy easter','classic','giraffe hoodie','spring chocolates','gingerbread','pen','sausage and cheese box','almond petit fours','lace cookies','spring pretzels','coffee cake','deluxe mixed nuts','florentine','cocktail jelly','trio','tropical petit','summer sausage and cheddar cheese','chocolate sampler tin','fruit candy','sweet cheese','peanut butter egg','personalized bbq','hot peanuts','art 101 78 piece trifold art set','family treat gift box','mint chocolate chip cheesecake','colby cheese','brie','stick','easter gift tower','mint chocolate cheesecake','slippers','blueberry','smores barks','valencias','sugar free taffy','edam cheese','strawberry tea service','maple','chocolate easter card','chocolate nuts','mint chocolate torte','spring fruit slices','easter basket lamb plush','cookies and creme','bracelet','decanter set','love','18 incredible spreadable sampler','fruit cookies','personalized blanket','strawberry tea cup','jesus','peach bellini cheesecake','chili chocolate','jumbo cheese trio','beef sausage and cheese','easter card','cross','oatmeal cookies','strawberry cake','gluten-free','petit fors','swiss','hunting','sugar free trail mix','garden vegetable wheel','daisy wreath','cake rolls','dates','decanter','stuffed dog','strawberry lemon bark','desserts','non food','movies','bedding','sugar free cheese cake','seafood','raspberry cake','26 holiday favorites','dog bed','chocolate toffee','wrapped candy','zoo chocolates','food gifts','tea pot','spring truffles','hot and spicy cajun mix','smoked cheddar cheese spread','pop','ice cream','bugs','chocolate covered chips','cake trio','lollipops','spring fruit','pick','eastercandy','gummy peach rings','hoodie animals','fruit and nut delights','chocolate caramel and pecans','strawberry shortcake cheesecake','ham links','box towers','bavarian','banana split','candy eggs','inspirational clock','cookie cake','butterfly petit fours','new','bacon cheese log','vegetables','walnut oatmeal','pers giraffe hoodie','award winning butter toffee','butter truffles','personalized cake','spring fruit gel','chocolate chicks','easter plush','easter gift tower chick and egg','cross watch','sausage assortment','caramel pecan swirl','bridge','monkey backpack candy','bison','deep dish apple pie','chocolate chip cookies gluten free','spiral','no sugar added trail mix','personalized mini','sugar','muenster cheese','slices','fruity and white cheddars','raspberry jellies','sharp cheese','lily','gift certificate','forest log','trio candy','personalized tiger','chickadee','rabbit','all food','cookie bites','walnut cookies','bouquet','candy tins','wheel of cheese','candy boxes','sugar free gummy fish','nut fruitcake','lite beef log','beef summer sausage','peanut butter candy','spring bridge mix','swiss almond','cream','mom','chocolate caramel nuts','easter goodies','sugar free fruitful','seeds','linzer cookies','cake slices','fruit gels','coffee bark','easter petit','extra smokey beef log','chocolate potato chips','shipping chart','french vanilla bonbons','holiday','triple chocolate torte','teriyaki','carrot petit fours','five','white','honey mustard','brick','blueberry cheese','snowman','favorite five sausages','roll','fresh fruit','hotline','chocolate cookies','port wine cheese logs','lucky irish coin','chocolate easter eggs','easter torte','bunny salt and pepper shakers','assorted petit fours','port wine','personalize hoodie zoo','pick and choose','pick n choose','cheese board','lace','pork','sweet and hot spreadables','wildflower','marble','liqueur cake','sugar free potato chip','fired in ham','reed diffuser','salted caramels','personalized mini birthday petit fours','sugar free chips','pet products','personalized birthday cakes','treat box','mint fudge','all jewelry','sweet chicks','lemon danish cheesecake','oatmeal pumpkin cookies','tool set','crystal pen','friendship plate','bunny tower','lemon candy','pistachios-tin','spicy cajun beef sticks','32 snack','butter crunch','pastel candy corn','special someone name pendant','32','big logs','lemon petits','accessories','ice cream cake','mini cookie bites','pastel petit fours','easter basket floral','incredible','box','wildlife bottle opener','computer mouse','lamb cake','white lily','mini-butter-toffee','personalized fudge egg','belts','maple sugar','haystacks','stone ground mustard','sausage gift','smokey beef log','grandmother','mellocremes','mini cookies','boneless spiral sliced ham','country favorites','blanket set','dream catcher','bbq tool','cheddar and port','garlic butter','cream cheese spreads','box of chocolates','peach rings','lemon cheese cake','caramel clusters','bison sticks','tiger and hoodie','ice cream balls','sugar-free cheesecake','milk chocolate butter toffee','pearl','happy','cocktail jelly belly','hot cajun beef sticks','french onion','wisconsin cheddar spreads','socks','fruit cheese','wisconsin cheddar','easter splash','smoked bacon','mellow cheddar cheese spread','colby','sound','swiss cake','florentine lace','strawberry lemon','wax','gluten free almond','lemon bites','smokey cheddar','ranch','sugar free bread','cheese wax','swirl cake','little cakes','torte triple','creame de menthe','cheese and crrrisps','gluten','lemon bark','dog pillow','shell','ceramic','valencia oranges','puppy dogs','sunshine','strawberry shortcake petit fours','chocolate cake balls','cordials','western long sleeve tee','totes','moon','lime petits fours','easter gift plush candy trio','9','ancho chili cake balls','port wine cheese spread','gold','jelly cake','spice drops','pc','chocolate gifts','valentine\'s','pumpkin coffee','zigzag','luscious lemon cheesecake','cheese and sausage sampler','nickel','dream','peach candy','send catalog','heart cake','savory','sugar free petit','chocolate hearts','no peanuts','spring petit','valentine tower','mix and match','no shipping','personalized chocolate','incredible-spreadables','gluten free almond crunch','valentine cake','swiss and cheddar log','light up','sentimental','mint chocolate chip','baker cheeses','premium nut','chocolate with pecans','50% off','buttery toffee','gluten free mixes','personalized valentine','sugar free pecan clusters','pepper cheese','soft center','custom','morsels','sugar-free petite fours','swiss cheese spread','chocolate friend log','sugar free fours','chocolate bites','stargazer','cheddar cheese spread','chocolate butter toffee','filled cookies','smiling monkeys','cutting','my','creamy cheddar','hot','cheddar cheese spreadable','pans','bacon cheddar','favorite five tortes','bread mix','buffalo nickel dream catcher pendant','chocolate heart cake','bacon cheddar spread','filbert','chees board','creme torte','lucky irish pendant','pepper seasoned bacon','sweet sausage','mint-chocolate-torte','gluten free cheese','maple links','spiral sliced ham with fired in sugar glaze','spinach supreme','sharp','deluxe','chocolate raisins','when will it be shipped','smile','personalized animals','smiley','fresh oranges','chocolate fudge petit four','swiss and ham cheese spread','orange bread','cheese ingredients','brazil','spiral-sliced-ham','sugar free sale','covered macadamia nuts','chocolatey potato chips','phone to god','sausages n cheese bars gift of 9','chris card','stone','sweet basket','chocolate with nuts','filbert creme','chocolate nut tin','mixed nuts 50 pistachio','chocolate torte cake','boneless-ham','marble board slicer','petit f','salted nuts','sugar free holiday tower','santa jellies','send a gift','crab spread','maple ham','petit ours','chocolate buttons','spinach','boneless smoked ham','cheese sausage mustard','mint dobosh torte','glaze','six','mixed chocolates','front five','merry christmas petit','cheese sausage torte gift samplers','chris mouse pleaser','gift of 7','shoe shine kit','cheese trio','two sweet','mini gift boxes','chocolate lovers','cheese sausage torte','forest cake','beef log gift of 6','maple sausage','chees spread','sausage and chees','sau','mouse cards','petit four tree','must','sweet bread','genuine buffalo nickel dream catcher pendant','bacon smoked cheese spread','chocolate raspberry jellies','cheese sets','six gift sampler','the big ones','cheese sausage and petit fours','sausage and petit fours','cheese gift box','bacon cheddar cheese spread','pj s','bu','pers pet carrier','sugar free christmas','sugar free pecan','swiss colony beef log','chocolate christmas mouse','chocolate trio','small tin','projector alarm clock','merry christmas chocolate','medley','case','chocolate grahams','masterpiece','crab cheese','chocolate covered cake','butter-toffee','chocolate bonbons','fruit nut breads and cremes gift of 7','swiss and sausage','sugar free fish','take five','sale postpaid','premium','bible phone','cheese and fruit gifts','by christmas','#2 cheeses','personalized pet carrier','cheese box','sugar glazed ham','sugar free slices','chocolate tower','lucky irish','swiss colony 27','sugar free gummies','shrimp cheese','holiday cakes','special blend coffee','sausage n cheese bars gift of 8','port wine with almonds','two hams','box summer sausage','carees','beef mustard','chocolate and mint logs','horatio','pers angel throw','snack size','front','hole punch','bone','cover','strawberry galettes','sugar free nuts','lil petites','sausage and candy','guardian treasure chest','coated pretzels','hand decorated holiday cookies','filled','sugar free vanilla cheesecake','soaring eagle fleece','old fashion toffee','chocolate p','triple chocolate','old cookies','gel candy','beef log food gift combo','hugger','coin pendant');
/* $Revision: 6883 $
 *
 */

if(typeof(_sli_init )!='object'){var _sli_init=new Array();}
if(typeof(sli_init )!='function'){function sli_init(){ for(var x=0;x<_sli_init.length;x++) _sli_init[x]();}}
if(typeof(asPhrases)!='object'){ var asPhrases = new Array(); }
if(typeof(__SLI_customisations)!='object'){var __SLI_customisations = new Object();}
if(typeof(__SLI_ClientDefaults)!='object'){ var __SLI_ClientDefaults=[]; }
if(typeof(__SLI_validSearchBoxes)!='object'){ var __SLI_validSearchBoxes = new Array(); }
if(typeof(__SLI_asug_used_flag)!='object'){ var __SLI_asug_used_flag = false; }
if(typeof(__SLI_width)!='object'){ var __SLI_width = 0; }
if(typeof(sli_targeturl)!='object'){ var sli_targeturl = ""; }


    __AutoComplete = new Object(); //namespace...
    __AutoComplete_mouseMoved=false;

    // Basic UA detection
    isIE = document.all ? true : false;
    isGecko = navigator.userAgent.toLowerCase().indexOf('gecko') != -1;
    isOpera = navigator.userAgent.toLowerCase().indexOf('opera') != -1;

    /* defaults and options */

    var __SLI_ApplicationName = 'AutoSuggest';
        __SLI_customisations[ 'AutoSuggest' ] =
                {
                    'ShowBrandingFooter' : true
                    ,
                    'TextBoxIDPrefix' : 'sli_search_'
                    ,
                    'BrandingFooterImagePath' : 'http://assets.resultspage.com/autosuggest/sli_systems-powered_150_15.gif'
                    ,
                    'BrandingFooterTitleTooltip' : 'AutoSuggest Powered by SLI Systems'
                    ,
                    'DropListMinWidth' : 150
                    ,
                    'MaxListItems' : 10
                    ,
                    'Alignment' : true
                    ,
                    'TextBoxIDCustom' : []
                    ,
                    'ValidSearchBoxes' : false 
                    ,
                    'IE6SelectBox' : false 
                    ,
                    'IE6SelectBoxPadding' : 0
                    ,
                    'TargetURL' : ''
                    ,
                    'IframeAlignment' : false
                    ,
                    'AlignmentBorderBug' : false
                    ,
                    'IE6OnFocus' : false
                };
    /* 0 = keyname, 1 = value */
    for( defaultValuePair in __SLI_ClientDefaults )
    {
        __SLI_customisations[__SLI_ApplicationName][__SLI_ClientDefaults[defaultValuePair][0]]=__SLI_ClientDefaults[defaultValuePair][1];
    }

    /* pre-fetch branding footer image if being used...
     */
    if( __SLI_customisations[ __SLI_ApplicationName ][ 'ShowBrandingFooter' ] )
    {
        
        if(location.protocol == "https:")
        {
            __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ] = __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ].replace(/http:/i, 'https:');
        }
    
        var __AutoCompleteBranding = new Image();
        __AutoCompleteBranding.src=__SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ];
    }


    function AutoComplete_init()
    {
        if(!isOpera)
        {
            var oldonresize=function(){};
            if(typeof(window.onresize)=='function')
                oldonresize = window.onresize;//play nicely with other people's toys
            window.onresize= function(){ oldonresize(); AutoComplete_HideAll(); AutoComplete_Create( asPhrases ); }

            AutoComplete_Create( asPhrases );
            
            var els = document.getElementsByTagName('input');
            if(els)
            {
               for ( i = 0; i < els.length; i++ )
               {
                  if(els[i].name == "asug")
                  {
                     els[i].disabled = true;
                  }
               }
            }
        }
    }




    /**
    * Attachs the autocomplete object to a form element. Sets
    * onkeypress event on the form element.
    *
    * @param string formElement Name of form element to attach to
    * @param array  data        Array of strings of which to use as the autocomplete data
    */
    //function AutoComplete_Create (id, data)
    /*
     * iterate over 'sli_search_*' assumes one or more search boxes numbered from 1...
    */
    function AutoComplete_Create( data )
    {
        var idx=1, e, id, searchBoxPrefix=__SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDPrefix' ];
        while( e = document.getElementById(searchBoxPrefix+idx) )
        {
            AutoComplete_AttachHandlers(e, data);
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
                __SLI_validSearchBoxes.push(searchBoxPrefix+idx);
            }
            idx++;
        }
        
        
        //this array comes from the customised list
        var otherTextBoxIdList = __SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDCustom' ];
        if( otherTextBoxIdList)
        {
            for(idx=0;idx<otherTextBoxIdList.length;idx++)
            {
                e = document.getElementById(otherTextBoxIdList[idx]);
                if(e)
				{
					if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
                	{
	                    __SLI_validSearchBoxes.push( otherTextBoxIdList[idx] );
                	}
					AutoComplete_AttachHandlers(e, data);
				}
            }
        }
        
    } 

    function AutoComplete_AttachHandlers(e, data){
        var iframe,id;
        id=e.id;


        __AutoComplete[id] = {'data':data,
                              'isVisible':false,
                              'element':document.getElementById(id),
                              'dropdown':null,
                              'highlighted':null};

        __AutoComplete[id]['element'].setAttribute('autocomplete', 'off');
        __AutoComplete[id]['element'].onkeydown = function(e) {if (!e) e = window.event; return AutoComplete_KeyDown(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onkeyup = function(e) {if (!e) e = window.event; return AutoComplete_KeyUp(this.getAttribute('id'), e);}
        // The function call on the next line was changed by Andrew Grieve April 2008
        __AutoComplete[id]['element'].onkeypress = function(e) {if (!e) e = window.event; return AutoComplete_KeyPress(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onclick = function(e)
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6OnFocus' ] )
            {
                __AutoComplete[id]['element'].focus();
            }
            if (!e) e = window.event; e.cancelBubble = true; e.returnValue = false;
        }



        // Hides the dropdowns when document clicked
        var docClick = function()
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
            }
            else
            {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
            }
        }

        if (document.addEventListener) {
            document.addEventListener('click', docClick, false);
        } else if (document.attachEvent) {
            document.attachEvent('onclick', docClick, false);
        }


        // Max number of items shown at once
        if (arguments[2] != null) {
            __AutoComplete[id]['maxitems'] = arguments[2];
            __AutoComplete[id]['firstItemShowing'] = 0;
            __AutoComplete[id]['lastItemShowing'] = arguments[2] - 1;
        }

        AutoComplete_CreateDropdown(id);

        // Prevent select dropdowns showing thru
        if (isIE) {
            iframe = document.createElement('iframe');
            __AutoComplete[id]['iframe'] = iframe;
                iframe.id = id +'_iframe';
                iframe.style.position = 'absolute';
                iframe.style.top = '0';
                iframe.style.left = '0';
                iframe.style.width = '0px';
                iframe.style.height = '0px';
                iframe.style.zIndex = '98';
                iframe.style.visibility = 'hidden';
                
                if(location.protocol == "https:")
                {
                   iframe.src = 'https://assets.resultspage.com/autosuggest/blank.html';
                }
                
                if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBox' ] )
                {
                  iframe.style.width = __SLI_width  + __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBoxPadding'];
                }

            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IframeAlignment' ] )
            {
                document.body.insertBefore( iframe );
            }
            else
            {
                __AutoComplete[id]['element'].parentNode.insertBefore( iframe, __AutoComplete[id]['element'] );
            }
        }
    }

    /**
    * Creates the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_CreateDropdown(id)
    {
        var theSearchbox = __AutoComplete[id]['element'];
        var theDropDown;
        var left_top = AutoComplete_getPos( theSearchbox );
        var left  = left_top[0];
        var top   = left_top[1] + theSearchbox.offsetHeight;
        var width = theSearchbox.offsetWidth;

        if ( width < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
        {
            width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
        }

        theDropDown = document.createElement('div');
        theDropDown.className = 'autocomplete'; // Don't use setAttribute()


        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true && document.body)
        {
            theDropDown.style.position = 'absolute';
            document.body.insertBefore(theDropDown, document.body.nextSibling);
            
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        else if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "offsetrelative" && document.body)
        {
          theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
          // Position it
          if(sli_getStyle(theSearchbox.offsetParent, 'position') != "absolute")
          {
            theSearchbox.offsetParent.style.position = 'relative';
          }
          theDropDown.style.position = 'absolute';
          theDropDown.style.left = (theSearchbox.offsetLeft) + 'px';
          theDropDown.style.top = (theSearchbox.offsetTop + theSearchbox.offsetHeight) + 'px';
          if ( theSearchbox.clientWidth < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
          {
            theDropDown.style.width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
          }
          else
          {
            theDropDown.style.width = (theSearchbox.clientWidth) + 'px';
          }
          theDropDown.style.visibility = 'hidden';
          theDropDown.style.zIndex     = '99999999';
        }
        else
        {
            theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        

        __AutoComplete[id]['dropdown'] = theDropDown;
        __SLI_width = width;
    }

    function /* array [ left, top ] */ AutoComplete_getPos( obj )
    {
        var curleft = curtop = 0;
        var sli_flag = 0;

        if (obj.offsetParent)
        {
           do
           {
              if ( __SLI_customisations[ __SLI_ApplicationName ][ 'AlignmentBorderBug' ] )
              {         
                
                if(sli_flag == 1)
                {
                    var clientTop = (obj.offsetHeight - obj.clientHeight) / 2;
                    curtop += clientTop;

                    var clientLeft = (obj.offsetWidth - obj.clientWidth) / 2;
                    curleft += clientLeft;
                }
                sli_flag = 1;
              }
           
              curleft += obj.offsetLeft;
              curtop += obj.offsetTop;
           }
           while (obj = obj.offsetParent);
        }
        return [curleft,curtop];
    }

    /**
    * Shows the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ShowDropdown(id)
    {

        AutoComplete_HideAll();



        var value = __AutoComplete[id]['element'].value;
        var toDisplay = new Array();
        var newDiv    = null;
        var text      = null;
        var numItems  = __AutoComplete[id]['dropdown'].childNodes.length;

        __AutoComplete_mouseMoved=false;
        // SLI Code Modification - Start - Andrew Grieve April 08
        // Trim the textbox so that if is starts with a space then the feature will still work
        //value = value.replace(/^\s+|\s+$/g,"");
        value = value.replace(/^\s+/g,"");

        if(value.length == "")
        {
            // If Textbox length is nothing (after the trim) then don't show dropdown.
            return;
        }
        // SLI Code Modification - End

        // Remove all child nodes from dropdown
        while (__AutoComplete[id]['dropdown'].childNodes.length > 0) {
            __AutoComplete[id]['dropdown'].removeChild(__AutoComplete[id]['dropdown'].childNodes[0]);
        }


        var count=0;
        // Go thru data searching for matches
        for (i=0; i<__AutoComplete[id]['data'].length; ++i)
        {
            // SLI Code Modification - Start - Andrew Grieve April 08 - Added lower casing
            if (__AutoComplete[id]['data'][i].substr(0, value.length).toLowerCase() == value.toLowerCase())
            {
                // SLI Code Modification - End
                toDisplay[toDisplay.length] = __AutoComplete[id]['data'][i];
                count++;
                /* how many to display? */
                if(count == __SLI_customisations['AutoSuggest']['MaxListItems'] ) /* Code inserted to keep list to a maximum of 10 values (was 20 or 30) */
                {
                    break;
                }
            }
        }

        // No matches?
        if (toDisplay.length == 0) {
            AutoComplete_HideDropdown(id);
            return;
        }



        // Add data to the dropdown layer
        for (i=0; i<toDisplay.length; ++i) {
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_item'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';

             // Scrollbars are on display ?
            if (toDisplay.length > __AutoComplete[id]['maxitems'] && navigator.userAgent.indexOf('MSIE') == -1) {
                newDiv.style.width = __AutoComplete[id]['element'].offsetWidth - 22 + 'px';
            }

            newDiv.onmouseover =
        function()
        {
            if( __AutoComplete_mouseMoved )
                AutoComplete_HighlightItem(__AutoComplete[id]['element'].getAttribute('id'), this.getAttribute('index'));
        };

            newDiv.onclick     =    function()
                                    {
                                    	  __SLI_asug_used_flag = true;
                                                                           
                                        AutoComplete_SetValue(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_HideDropdown(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_submitForm(id);
                                    }



            text   = document.createTextNode(toDisplay[i]);
            newDiv.appendChild(text);
            newDiv.title='Search for ' + toDisplay[i];

            /* ellipsis for IE only */
            if( isIE )
            {
                newDiv.style.textOverflow = 'ellipsis';
                newDiv.style.width = '100%';
                newDiv.style.whiteSpace = 'nowrap';
                newDiv.style.overflow = 'hidden';

            }
            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }
        /*
         * append DIV containing footer branding...
         */
        if(__SLI_customisations['AutoSuggest']['ShowBrandingFooter'])
        {
            i = toDisplay.length;
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_footer'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';
            newDiv.innerHTML = '<a href="http://www.sli-systems.com/powered-by.php" title="' +
                                __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterTitleTooltip' ] +
                                '"><img class="autocomplete_footer_branding" src="'+__AutoCompleteBranding.src+'" /></a>';

            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }


        // Too many items?
        if (toDisplay.length > __AutoComplete[id]['maxitems']) {
            __AutoComplete[id]['dropdown'].style.height = (__AutoComplete[id]['maxitems'] * 15) + 2 + 'px';

        } else {
            __AutoComplete[id]['dropdown'].style.height = '';
        }


        /**
        * Set left/top in case of document movement/scroll/window resize etc
        */
        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "true" || __SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "false")
        {
            var left_top = AutoComplete_getPos( __AutoComplete[id]['element'] );
            __AutoComplete[id]['dropdown'].style.left = left_top[0];
            __AutoComplete[id]['dropdown'].style.top  = left_top[1] + __AutoComplete[id]['element'].offsetHeight;
        }


        // Show the iframe for IE
        if (isIE) {
            
            if(!__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true)
            {
               __AutoComplete[id]['iframe'].style.width  = __AutoComplete[id]['dropdown'].offsetWidth;
            }
            
            
            __AutoComplete[id]['iframe'].style.top    = __AutoComplete[id]['dropdown'].style.top;
            __AutoComplete[id]['iframe'].style.left   = __AutoComplete[id]['dropdown'].style.left;
            __AutoComplete[id]['iframe'].style.height = __AutoComplete[id]['dropdown'].offsetHeight;

            __AutoComplete[id]['iframe'].style.visibility = 'visible';
        }

    e =  __AutoComplete[id]['dropdown'];

    e.onmousemove =
        function()
        {
            if(!__AutoComplete_mouseMoved){__AutoComplete_mouseMoved=true;}
            this.onmousemove = null;
        }

        // Show dropdown
        if (!__AutoComplete[id]['isVisible']) {
            __AutoComplete[id]['dropdown'].style.visibility = 'visible';
            __AutoComplete[id]['isVisible'] = true;
        }


        // If now showing less items than before, reset the highlighted value
        if (__AutoComplete[id]['dropdown'].childNodes.length != numItems) {
            __AutoComplete[id]['highlighted'] = null;
        }
    }



    /**
    * Hides the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_HideDropdown(id)
    {
        if (__AutoComplete[id]['iframe'])
        {
            __AutoComplete[id]['iframe'].style.visibility = 'hidden';
        }
        
        if (__AutoComplete[id]['dropdown'])
        {
            __AutoComplete[id]['dropdown'].style.visibility = 'hidden';
        }

        __AutoComplete[id]['highlighted'] = null;
        __AutoComplete[id]['isVisible']   = false;
    }


    /**
    * Hides all dropdowns
    */
    function AutoComplete_HideAll()
    {
         if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
         {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
         }
         else
         {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
         }
    }


    /**
    * Highlights a specific item
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_HighlightItem(id, index) // mouseover, index is the list element index, zero-based
    {
        if (__AutoComplete[id]['dropdown'].childNodes[index]) {
            for (var i=0; i<__AutoComplete[id]['dropdown'].childNodes.length; ++i) {
                if (__AutoComplete[id]['dropdown'].childNodes[i].className == 'autocomplete_item_highlighted') {
                    __AutoComplete[id]['dropdown'].childNodes[i].className = 'autocomplete_item';
                }
            }

            __AutoComplete[id]['dropdown'].childNodes[index].className = 'autocomplete_item_highlighted';
            __AutoComplete[id]['highlighted'] = index;

            //also see below...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[index].innerHTML;
            //AutoComplete_SetValue(id);
        }
    }


    /**
    * Highlights the menu item with the given index
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_Highlight(id, index) // keyboard up/down - index is the direction of travel, 1==down,-1=up
    {
        var childNodes = __AutoComplete[id]['dropdown'].childNodes;
        if(childNodes.length)
        {
	        var lastItem = ( ( childNodes[ childNodes.length - 1 ].className != 'autocomplete_footer' ) ? childNodes.length - 1 : childNodes.length - 2 );

            // Out of bounds checking
            //if (index == 1 && __AutoComplete[id]['highlighted'] == __AutoComplete[id]['dropdown'].childNodes.length - 1) {
            if (index == 1 && __AutoComplete[id]['highlighted'] == lastItem ) {
                childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = null;

            } else if (index == -1 && __AutoComplete[id]['highlighted'] == 0) {
                childNodes[0].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = lastItem;
                index = 0;//hack!
            }

            // Nothing highlighted at the moment
            if (__AutoComplete[id]['highlighted'] == null) {

                childNodes[0].className = 'autocomplete_item_highlighted';
                __AutoComplete[id]['highlighted'] = 0;
                newIndex = 0;
                
            } else {

                if (childNodes[__AutoComplete[id]['highlighted']]) {
                
                    childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                }

                var newIndex = parseInt( __AutoComplete[id]['highlighted'] ) + parseInt(index);

                if (childNodes[newIndex]) {

                    childNodes[newIndex].className = 'autocomplete_item_highlighted';

                    __AutoComplete[id]['highlighted'] = newIndex;
                }
            }

            //populate textbox with currently highlighted term...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[newIndex].innerHTML;
            AutoComplete_SetValue(id);
        }
    }


    /**
    * Sets the input to a given value
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_SetValue(id)
    {
        __AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[__AutoComplete[id]['highlighted']].innerHTML.replace(/&amp;/, "&");
    }


    /**
    * Checks if the dropdown needs scrolling
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ScrollCheck(id)
    {
        // Scroll down, or wrapping around from scroll up
        if (__AutoComplete[id]['highlighted'] > __AutoComplete[id]['lastItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'] - (__AutoComplete[id]['maxitems'] - 1);
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'];
        }

        // Scroll up, or wrapping around from scroll down
        if (__AutoComplete[id]['highlighted'] < __AutoComplete[id]['firstItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'];
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'] + (__AutoComplete[id]['maxitems'] - 1);
        }

        __AutoComplete[id]['dropdown'].scrollTop = __AutoComplete[id]['firstItemShowing'] * 15;
    }


    /**
    * Function which handles the keypress event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyDown(id, e)
    {
        var result = true;

       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {

            // Return/Enter
            case 13:
                if (__AutoComplete[id]['highlighted'] != null) {
                    AutoComplete_SetValue(id);
                    AutoComplete_HideDropdown(id);
					
                    __SLI_asug_used_flag = true;
					
                    if( e = __AutoComplete[id]['element'].form['asug'] )
                    {
                        
                        e.disabled=false;
                        e.value = __AutoComplete[id]['asug'];
                    }

                }

                result = AutoComplete_submitForm(id);

                break;

            // Escape
            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            // Up arrow
            case 38:
                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, -1);
                AutoComplete_ScrollCheck(id, -1);
                
                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                                
                result = false;
                break;

            // Tab
            case 9:
                if (__AutoComplete[id]['isVisible']) {
                    AutoComplete_HideDropdown(id);
                }
                return;

            // Down arrow
            case 40:

                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, 1);
                //AutoComplete_ScrollCheck(id, 1);

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                result = false;
                break;
        }
        return result;
    }


    /**
    * Function which handles the keyup event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyUp(id, e)
    {
       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {
            case 13:
                event.returnValue = false;
                event.cancelBubble = true;
                
                break;

            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            case 38:
            case 40:
                return false;
                break;

            default:
                AutoComplete_ShowDropdown(id);
                
                __AutoComplete[id]['asug']=__AutoComplete[id]['element'].value;

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=true;
                   e.value = "";
                }  
                
                break;
        }
    }

    /**
    * Function which handles the keypress event
    * This function added April 2008 by Andrew Grieve
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */

    // SLI Code Modification - Start - Andrew Grieve April 08
    function AutoComplete_KeyPress(id, e)
    {
        var event = e;
        if(!event) event = window.event;
        var keyCode = event.keyCode;

        if (keyCode == 13 && isGecko || isOpera)
        {
            return false;
        }
        
        if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
        {
            if (keyCode == 13 && isIE)
            {
                return false;
            }
        }
        
    }
    // SLI Code Modification - End

    /**
    * Returns whether the dropdown is visible
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_isVisible(id)
    {
        return __AutoComplete[id]['dropdown'].style.visibility == 'visible';
    }

    function AutoComplete_submitForm(id)
    {
      var e, f, result=true;
      if( f = __AutoComplete[id]['element'].form )
      {
        if( __AutoComplete[id]['element'].value != '' )
        {
          if(__SLI_asug_used_flag == true)
          {
            if( e = f['asug'])
            {
              e.value = __AutoComplete[id]['asug'];
              e.disabled=false;
            }
          }

          if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
          {
            asugvar = "";
            if(__SLI_asug_used_flag == true)
            {
              asugvar = '&asug=' + escape(__AutoComplete[id]['asug']);
            }

            sliRegex = /resultsdemo\.com/;
            if(sliRegExArray = sliRegex.exec(document.domain))
            {
              sliRegex = /^http:\/\/(.*)\//;
              sliTargetDomain = sliRegex.exec(__SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ]);
              __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ].replace(sliTargetDomain[1], document.domain);
            }

            document.location.href = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] + escape(__AutoComplete[id]['element'].value) + asugvar;
          }
          else
          {
            if(f.onsubmit)
            {
              if(f.onsubmit() !== false)
              {
                f.submit();
              }
            }
            else
            {
              f.submit();
            }
          }

          AutoComplete_HideAll();
        }
        else
          result = false;
      }
      return result;
    }
    
    // get the style that will be applied by the browser, including stylesheets
    function sli_getStyle(el,styleProp)
    {
      if (el.currentStyle)
        var y = el.currentStyle[styleProp];
      else if (window.getComputedStyle)
        var y = document.defaultView.getComputedStyle(el,null).getPropertyValue(styleProp);
      return y;
    }

    // register with onLoad(er...
    _sli_init.push( AutoComplete_init );
    
    function sli_addEvent(obj, evType, fn) {
    	if (obj.addEventListener) {
    		obj.addEventListener(evType, fn, false);
    		return true;
    	} else if (obj.attachEvent) {
    		var r = obj.attachEvent("on" + evType, fn);
    		return r;
    	} else {
    		return false;
    	}
    }
    
    function sli_load()
    {
    	sli_addEvent(window, 'load', sli_init);
    }