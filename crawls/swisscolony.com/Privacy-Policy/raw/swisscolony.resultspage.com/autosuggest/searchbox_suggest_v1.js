/* Popular phrases - SWISSCOLONY - 21:47:0, Sun Oct 7, 2012 */
__SLI_ClientDefaults =
[
    ['Alignment', 'offsetrelative' ],
	['IE6SelectBox', true ],
    ['ShowBrandingFooter', false ],
];
var asPhrases=new Array ('sale','chocolate','petit fours','cheesecake','halloween','sugar free','ham','baklava','cheese','fruit cake','fudge','truffles','pumpkin','toffee','cookies','catalog','torte','nuts','breakfast','toys','cakes','sugar free products','bonbons','butter toffee','careers','coconut','dobosh torte','incredible spreadables','red velvet','spreadables','coffee','brownies','fruitcake','postpaid','gingerbread house','sampler','beef log','macadamia nut chocolate','cheese spreads','red velvet petit fours','towers','cashews','popcorn','smart tablet','christmas','pretzels','spiced pumpkins','chocolate truffles','dobosh','candy','best seller assortment','fruit','watches','cake balls','angel','summer sausage','bread','divinity','mustard','peanut brittle','mixed nuts','sausage','swiss cheese','carrot cake','mp3 player','pistachios','pecan','cheese log','crackers','shipping','coconut petits four','high 5','27 favorites','mint torte','chris mouse','jewelry','cheese cake','petit','jerky','82 all time favorites','chocolate covered cherries','sweatshirt','baby swiss','caramel apple cheesecake','bacon','popcorn tins','tablet','macadamia nuts','liqueur','petit fours and bonbons','dips','candles','precious moments','baby swiss cheese','cherries','beef jerky','chocolate covered potato chips','throw','coconut drops','spreads','peanut butter','jacket','fruit slices','personalized','snowman','holiday breakfast','meat','halloween petit fours','cheese and sausage','fudge trio','bananas foster','zoo chocolates','bark','coconut macaroons','petit four sale','christmas petit fours','cheddar cheese','cheese slicer','jumbos','clocks','meat sticks','gift sampler','pumpkin spice cake','holiday high notes','purse','jelly beans','telescope','christmas breakfast','halloween gifts','slippers','incredible petits fours','ornaments','pecan praline','summer sausage and cheese','postpaid petit fours','breakfast meats','rum balls','bavarian creme torte','14 country favorites','jelly belly','pumpkin bark','peppermint bark','pets','snowman truffles','sugar free petits fours','wild game meat sticks','blankets','swiss','harvest petits fours','men','beef','coconut bars','holiday treasure','mini butter toffee','free gift','lace cookies','dark chocolate','spreadable cheese','german chocolate cheese cake','liqueur truffles','friendship plate','apo shipping','florentine lace cookies','snowflake cake','gingerbread','breakfast petit fours','jumbo cashews','sausage and cheese bars','mini tower','pecan tarts','log','peppermint','apple','mustard trio','petit fours bonbons assortments','clothing','forest friends log','ho ho ho tower','apple pie','fleece jacket','mini petit fours','handbags','elephant','favorite five','deep dish caramel apple pie','pendant','pecan clusters','halloween cookies','reindeer food','trick or treat bag','sugar free cookies','polar pals trio','pumpkin coffee cake','crisps','mint','macaroons','gourmet brownies','sweet hot mustard','caramel pecan clusters','cheese gifts','red velvet cheese cake','pancakes','cheesecake morsels','crisps and spreadables','holi-bars','gift towers','glasses','breakfast special delivery','high five','chips','red velvet cake','pistachio nuts','bear','fudge brownie puffs','santa torte','aquarium','sweater','old fashion christmas candy','cat','taffy','birthday','shipping charges','seafood logs','potato chips','wallet','assorted chocolates','dobosh cakes','santa snack tin','pumpkin cake','fruitful delight','chocolate covered macadamia nuts','chocolate layered mints','ham and cheese','personalized gifts','cheesecake tarts','festive favorites','raspberry','streusel swirl coffee cake','seafood','32 holiday favorites','mint chocolate','angel treasure chest','wolf','knife','shortbread','fruit spread','crrrisps','butter brickle toffee','coffee creme sticks','pet beds','fruit and nut breads','caramel pecan swirl','mouse','macadamia','snowmen','slicer','galettes','wolf throws','holiday favorites','jalapeno beef log','caramel','gingerbread spice cookies','pies','giraffe','french vanilla bonbons','colossal breakfast','brie','family keepsake ornament','brownie puffs','beef and cheese','petit four flavors','sticky buns','santa\'s snacks tin','special gift samplers','chocolate petit fours','pumpkin cookies','chocolate santa cards','underwater fantasy aquarium','chocolate potato chips','43 season pleasers','24 petits fours','hot chocolate','strawberry','helicopter','coconut cake','german chocolate','santa','vintage cheddar','pecan log','raccoon','lite beef log','chocolate torte','tower full of joys','gaming console','fruitcake cookies','blue cheese','kreme kaese','sausage logs','postpaid gifts','82 all-time favorites','coffee sampler','carrot','moon wolves tee','lemon petit fours','galileo thermometer','mp3','personized zoo animals','angel pendant','stollen','jelly belly jelly beans','pet carrier','spiral ham','baby doll with 7 outfits','cheddar','crafting tool kit','cardinal','royal chocolate petits fours','eagle','rocky road','ultimate snack mix','big red cheddar','pancake mix','old fashioned fudge trio','baby','robe','hotline to god','hearty breakfast meats','26 holiday favorites','walkers','licorice','florentine','tumble buggies','games','sugar free brownies','almonds','lemon','sugarfree','holiday cardinal tower','chocolate cherries','torte cake','rings','bavarian bonbons','jumbo cheeses','cheese ball','scottie dogs','petit four gift samplers','holiday fruit tray','beef sticks','raspberry cheese cake','fruit trays','rum','jam','peanut','pink and camo jacket','bavarian','garlic','marble cheese board slicer','pralines','cheesecake bites','unsalted nuts','personalized throw','jalapeno peanut brittle','new arrivals','cardinal pjs','sausage n cheese bar','sausage n cheese','heated ice scraper','santa cake','holiday cookies','original beef log','sharp cheddar','chocolate pecan fudge','men gifts','postpaid cheese','jumbo cheese trio','raspberry cheesecake','scarf','colby cheese','cake rolls','no sugar added','lamp','wheel of cheese','treasure chest','creme de menthe torte','radio','kitty hammock','snow globe','tools','creature cake','cheese bars','skeleton truffles','cars','licorice tin','forest friends','john wayne','order','orangutan','banana','eyeball truffles','boucle sweater coat','peanut butter bites','christmas butter stollen','shelled pistachios','coffee cake','baskets','old fashion butter toffee','angel fleece throw','supple leather carryall','tree','harvest','personalized sketch set 106-pieces','carrot cake petits fours','decanter','remote control helicopter','ribbon candy','peanut butter and chocolate','dried fruit tray','assortment','toffe','fish','french vanilla cheesecake','favorites','christmas candy','wildlife wallet','pecan swirl','sugar free chocolate pecan fudge','incredible spreadables samplers','bible','seafood dips','macadamia nut patties','santa\'s 78 favorites','hummingbird','smoked cheddar','tin','organic','heater fan defroster','meat strip','eggnog fluff','muk luks','sweet surprises basket','red velvet cheesecake','carrot cake petits','pumpkin petit fours','winking santa torte','postpaid christmas petits fours christmas petits','kreme kaese cheese','no sugar','assorted candy','box','holiday cookie sampler','red velvet petits','gift of plenty','salt and pepper shakers','fruit cake cookies','ballpoint pen with personalized case','fall petit fours','trail mix','miniature baklava desserts','pillows','snowman blanket hugger','cashew nuts','country favorites','chocolate covered chips','trio of chocolate samplers','ham and baby swiss','spreadable sampler','cajun sticks','home and roadside','butterfly music box','personalized wildlife knife set','gift of 4','wine','personalized robe','candle collection','chocolate pretzels','postpaid christmas breakfast','chocolate fudge','mint dobosh torte','butterfly','scottie dog walkers','jelly belly gift assortment','incredible spreads','buffalo plaid fleece jacket','halloween witch log','western dvds','mini cakes trio','pastries','lobster','gift of 6','pet lovers sweatshirt','petit fors','dates','cajun beef sticks','dolls','personalized bear','dog bed','bear with halloween cookies','music box','lemon bread','stollen cake','pjs','shortbread cookies','boneless spiral sliced ham','swirl coffee cake','flashlight tool kit','cinnamon rugulach','sugar free cheesecake','15 holiday favorites','classic candy assortment','brick cheese','garden vegetable dip','mood watch','snowman melts','chocolate chip','sugar free peppermint','caramel pecan','brickle','candy bark','jalapeno','cheese popcorn','birthstone','cross pendant','winged lighted angel','kids','reed diffuser set','peppermint candy bites','aquarium light','no sugar added trail mix','butter toffee crunch','scottie','snowflake bear','ingredients','hotline','shirts','prayer animal','cross','baby doll','canadian bacon','spread your wings pendant','christmas cake','angel chest','hot sauce','snack','snack mix','smores barks','mens watches','cross dog tag','honey creme','pants','inspirational','moccasin','32 favorites','apo','wild game meats','life celebration','wild game','chocolate covered toffee','camo','butter stollen','plate and holder','saltwater taffy','winter scene sweatshirt','christmas taffy','surefire pleasers','elk','milk chocolate','lighted angel','hats','dried fruit','caramel apples','life\'s celebrations','bakery','cherry cordials','sugar free truffles','glass elephant','lucy a legacy of laughter','smart','chocolate cake','fleece pant','chocolate mouse','halloween bear','chocolate nuts','interchangeable 10 charms jewelry','baseball','beeflog','s','garden','cupcakes','for kids','fruitcake medley','shoe shine','snack time special','strawberry cheese cake','boneless ham','hot mustard','blueberry','decanter set','puffs','season pleasers','cajun mix','4 gb mp3 player','angel fleece','cheese and crackers','ripcord helicopter','grandma','racing car wall clock','holi bars','spice cookies','wildlife knife set','gingerboy cakes','nut chocolate mix','air compressor','cranberry','postpaid merry christmas petits fours','blanket hugger','irish creme','pepper bacon','wolf watch','double chocolate','free petit fours','red velvet layer cake','food','coffee bark candy','zoo','covered cherries','6 mini towers','harvest fruit tray','sail','ham and swiss','maple fudge','crunchy','licorice mix','garlic beef log','triple berry cheesecake','inspirational musical clock','mango salsa','dress up phone','plates','knife set','mens slippers','spicy cajun beef sticks','daughter throw','vest','defroster','santa and trees','gloves','fruit and nut delights','women','boneless ham and baby swiss','sweet hot','fpo','triple','everyones favorites','incredible spreadables with crunchy crisps','nonpareils','recipes','product guide','port wine cheese','holiday rolls','christmas mouse','bacon cheddar cheese','gifts for him','log out','ladies','all star','butter toffe','friend','amazing grace clock','christmas postpaid','address','chocolate brownie cookies','salt','cheese cake bites','nut assortment','merry christmas','daughter','duck','all star selection','wild game beef sticks','raspberry torte','shrimp scampi','fruit spread sampler','bon bons','pet lovers','children','wardrobe of watches','scuff','tarts','roll','vintage cheddar cheese','heater fan','story stix','christmas collection','colby','set of 7 mini glass elephants','maple syrup','mens suede slippers','crab cheese dip','womens jacket','blueberry cookies','all time favorites','personalized trick or treat bag','home','brittle','big baby swiss cheese','five','heater','wisconsin cheddar spreads','crystal initial angel pendant','mini petite','plenty','name pendant','holiday mix','lucy','fruit gels','chocolate coconut','log cake','fishing rod','chocolate fruitcake','cross watch','game sticks','bracelet stainless steel','led lamp','m','postpaid 26','rollover pets','wildlife bottle opener','merry christmas petit fours','phones','bridge mix','kitty','wings','mixed nut sampler','lace','carrier','howling wolf fleece throw','belts','santa\'s favorite','gift shop','dvd','velour','love','caramel apple pie','butter','mini baklava assortment','pers fleece robe','mango salsa cheese spread','bavarian torte','underwater aquarium','mini cakes','bottle opener','marble','petite cakes','jumbo beef log','banana bread','holiday pretzel trio','marble cheese slicer','christmas divinity','assorted petit fours','wolf tee','big red','ham and bacon','towering snowman gift','mango','smokey cheeses','trimmer','breakfast breads','postpaid 82 all-time favorites','home roadside emergency air compressor','hair','halloween treats','handmade fudge','meat stick bonanza','smoked bacon','carryall supple leather','christmas cookies','monkey','glazed ham','carrot cake balls','angel in chest','chocolate covered butter toffee','cranberry cheese','coffee sticks','camouflage lounge set','aged swiss','sno-shield','angel throw','best sellers','jalapeno brittle','cremes','specials','chocolate covered macadamia','jumbo cheese and sausage','electronic hangman','electronic audio bible','hangman','post-paid meat and cheese','meat snacks','wood','4 piece leather handbag set','hummingbird egg','white petit fours','hot and spicy','pen','premium nut assortment','fleece','petite holiday mints','confetti party bark','11','apple cinnamon','monkey chocolate','cheese bars with slicer','family keepsake','lantern','owl family figurine','salt and pepper','vanilla petits fours','watch radio and pen set','ice scraper','mini toffee','faux sherpa lined flannel shirt','sugarfree cheesecake','3 tortes','pecan long','sugar free gifts','usb heating cooling mini fridge','candy santa','music','sugar free cherries','honey glazed ham','48','two tone','sugar free chocolate potato chips','fruit gifts','canned ham','macadamia nut truffles','sugar free holiday mix','travel alarm clock','an','all sugar free products','red','muenster cheese','alarm clock','beef sausage','creature balls','butterfly meadow pjs','hammock','cheese sampler','sugar free fruit cake','size chart','velour set','beef log and cheese','angel in personalized treasure chest','solid milk chocolate','27','ice','color set','denim jacket','sno','chocolate snowman','cat throw','country ham','i','shower shave mirror with radio','5 sausage','rugulach','ingredients in beef log','cardinal tower','leather carryall','gingerbread cookies','clusters','manicure set','camo set','white cheddar','musical hummingbird egg','forest friends cake','zoo animals','mini','caraway beef log','fours','72','womens gifts','hearty breakfast','aged cheddar','audio bible','peppermint patties','layer','cookie tin','crystal','snowman blanket','streusel coffee cake','carrot petit','fruit nut breads and cremes','sugar free chocolate assortment','bonbon cake','carrot cake cream torte','sugar free peanut brittle','jacquard handbag','mens lounge set','orange slices','sugar free fruit nut delight','cheese assortment','trio','dutch apple','honey mustard','eagle hoodie','pocket scarf','smokey cheddar cheese','suspenders','cheese dips','sauces','sugar free cheese cake','animal','sugar free assortment','chris mouse magical pleasers','lemon mist','tumble','red rind muenster','well-mannered doll','macadamia fruit cake','oatmeal cookies','caramel apple cheese cake','leather purse','wisconsin','globe','toffee crunch','bowling set','sugar free chocolatey potato chips','jumping clock','beef long','bear and cookies','candy and cakes','all','german','ho ho ho','beef log gift combo','wacky duckie','chocolate cheese','carrot spice','balls','two tone cross pendant','jewish','port wine cheddar','fruity gels','lovable lapsies','li\'l baby swiss','key lime','save','suede scuff','chocolate log','basketball crazy shoot','ornament server','velvet cake','scraper','angel figurine charms','beef log combo','8 gb mp3 player','deep dish caramel pie','snowballs','raspberry petit four','personalized angel throw','bison','sugar free chocolate fudge','black cat pillow','walnut cake','drops','sweet and hot spreadables','fantasy aquarium','chocolate pecan','precious','electronic bible','tasty temptations','women\'s fleece jacket','witch log','bonanza','garden vegetable cheese','chocolate cake roll','fleece throw','stix','72 petit','pocket watch','chocolate cheesecake','sugar free gourmet brownies','family banner','garlic beeflog','creme de menthe','harvest fruit','apple bread','orange petits','mens jackets','interchangeable watch set','no sugar cookies','personalized treasure chest','sketch','slippers muk luks','spread your wings','cinnamon cake','hickory smoked bacon','ham links','horatio cable sweater','laffy taffy','postpaid toffee','cash','electronic games','age cheese','lounge pants','credit card','special someone name pendant','milk chocolate macadamia nuts','pumpkin pillow','mousse','charms','chocolate covered nuts','14','chocolate card','cheese board','sugar cookies','ancho','royal chocolate','chocolate peanuts','sherpa','gift of 8','apple cake','zigzag sweater','postpaid dobosh','mirror','swirl','shrimp','lol rollover pets','vegetable dip','art 101','cat pillow','suede','plaid','cheese board slicer','cashews and pistachio','apple pancake','plaque','lobster spread','fruit candy','mini butter','cat hammock','sweets','sugar free holiday cookies','lobster delight','spring cookie gift assortment','snowman tower','butter mints','sno shield windshield protector','collectibles','venison sticks','blueberry cheese','star','chocolate cake balls','15','scented candles','sweet halloween pretzels','swiss chocolate','all occasion','sugar free toffee','exclusive','preserves','barnyard','petit four 36','garlic summer sausage','deer fleece','festive','32','santas snack','santa cards','summer','postpaid truffles','cheese wax','scottie shortbreads','christmas morning breakfast','bats','sweet mustard','crumb cake','movies','meat strips gift box','german chocolate cheesecake','sailboat','soothing sandscape','holiday mints','candy sampler trio','chocolate pecan mix','christmas candies samplers','kiss','vegetable cheese spread','binoculars','chees spread','shaver','camo fleece','mummy cupcakes','santa tins','big red cheddar baby swiss','black forest','computer mouse','windshield','brazil nuts','live plate','wrapped candy','all sizes','harvest petit','led rechargeable lantern','chocolate lollipops','caramel cheesecake','cheese bites','snuggle','holiday bars','f','count and draw','frosty','bible verses','chocolate layer cake','cocoa','sausage bread','ceramic','cream','camping lantern','christmas dinner','cat beds','select mixed nuts','cheese\'s','sno-shield windshield protector','port','chocolate dobosh','chocolate covered peanut butter','sweet cheese','stuffed toys','big logs','strawberry truffles','charge','smokehouse','batteries','sugar free macadamia nut clusters','bites','special delivery','chees cake','brazil','cheese and candy','swiss and ham cheese spread','pancake and ham links','$40','2- piece thermal fleece lounge set','$15');
/* $Revision: 6883 $
 *
 */

if(typeof(_sli_init )!='object'){var _sli_init=new Array();}
if(typeof(sli_init )!='function'){function sli_init(){ for(var x=0;x<_sli_init.length;x++) _sli_init[x]();}}
if(typeof(asPhrases)!='object'){ var asPhrases = new Array(); }
if(typeof(__SLI_customisations)!='object'){var __SLI_customisations = new Object();}
if(typeof(__SLI_ClientDefaults)!='object'){ var __SLI_ClientDefaults=[]; }
if(typeof(__SLI_validSearchBoxes)!='object'){ var __SLI_validSearchBoxes = new Array(); }
if(typeof(__SLI_asug_used_flag)!='object'){ var __SLI_asug_used_flag = false; }
if(typeof(__SLI_width)!='object'){ var __SLI_width = 0; }
if(typeof(sli_targeturl)!='object'){ var sli_targeturl = ""; }


    __AutoComplete = new Object(); //namespace...
    __AutoComplete_mouseMoved=false;

    // Basic UA detection
    isIE = document.all ? true : false;
    isGecko = navigator.userAgent.toLowerCase().indexOf('gecko') != -1;
    isOpera = navigator.userAgent.toLowerCase().indexOf('opera') != -1;

    /* defaults and options */

    var __SLI_ApplicationName = 'AutoSuggest';
        __SLI_customisations[ 'AutoSuggest' ] =
                {
                    'ShowBrandingFooter' : true
                    ,
                    'TextBoxIDPrefix' : 'sli_search_'
                    ,
                    'BrandingFooterImagePath' : 'http://assets.resultspage.com/autosuggest/sli_systems-powered_150_15.gif'
                    ,
                    'BrandingFooterTitleTooltip' : 'AutoSuggest Powered by SLI Systems'
                    ,
                    'DropListMinWidth' : 150
                    ,
                    'MaxListItems' : 10
                    ,
                    'Alignment' : true
                    ,
                    'TextBoxIDCustom' : []
                    ,
                    'ValidSearchBoxes' : false 
                    ,
                    'IE6SelectBox' : false 
                    ,
                    'IE6SelectBoxPadding' : 0
                    ,
                    'TargetURL' : ''
                    ,
                    'IframeAlignment' : false
                    ,
                    'AlignmentBorderBug' : false
                    ,
                    'IE6OnFocus' : false
                };
    /* 0 = keyname, 1 = value */
    for( defaultValuePair in __SLI_ClientDefaults )
    {
        __SLI_customisations[__SLI_ApplicationName][__SLI_ClientDefaults[defaultValuePair][0]]=__SLI_ClientDefaults[defaultValuePair][1];
    }

    /* pre-fetch branding footer image if being used...
     */
    if( __SLI_customisations[ __SLI_ApplicationName ][ 'ShowBrandingFooter' ] )
    {
        
        if(location.protocol == "https:")
        {
            __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ] = __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ].replace(/http:/i, 'https:');
        }
    
        var __AutoCompleteBranding = new Image();
        __AutoCompleteBranding.src=__SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ];
    }


    function AutoComplete_init()
    {
        if(!isOpera)
        {
            var oldonresize=function(){};
            if(typeof(window.onresize)=='function')
                oldonresize = window.onresize;//play nicely with other people's toys
            window.onresize= function(){ oldonresize(); AutoComplete_HideAll(); AutoComplete_Create( asPhrases ); }

            AutoComplete_Create( asPhrases );
            
            var els = document.getElementsByTagName('input');
            if(els)
            {
               for ( i = 0; i < els.length; i++ )
               {
                  if(els[i].name == "asug")
                  {
                     els[i].disabled = true;
                  }
               }
            }
        }
    }




    /**
    * Attachs the autocomplete object to a form element. Sets
    * onkeypress event on the form element.
    *
    * @param string formElement Name of form element to attach to
    * @param array  data        Array of strings of which to use as the autocomplete data
    */
    //function AutoComplete_Create (id, data)
    /*
     * iterate over 'sli_search_*' assumes one or more search boxes numbered from 1...
    */
    function AutoComplete_Create( data )
    {
        var idx=1, e, id, searchBoxPrefix=__SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDPrefix' ];
        while( e = document.getElementById(searchBoxPrefix+idx) )
        {
            AutoComplete_AttachHandlers(e, data);
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
                __SLI_validSearchBoxes.push(searchBoxPrefix+idx);
            }
            idx++;
        }
        
        
        //this array comes from the customised list
        var otherTextBoxIdList = __SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDCustom' ];
        if( otherTextBoxIdList)
        {
            for(idx=0;idx<otherTextBoxIdList.length;idx++)
            {
                e = document.getElementById(otherTextBoxIdList[idx]);
                if(e)
				{
					if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
                	{
	                    __SLI_validSearchBoxes.push( otherTextBoxIdList[idx] );
                	}
					AutoComplete_AttachHandlers(e, data);
				}
            }
        }
        
    } 

    function AutoComplete_AttachHandlers(e, data){
        var iframe,id;
        id=e.id;


        __AutoComplete[id] = {'data':data,
                              'isVisible':false,
                              'element':document.getElementById(id),
                              'dropdown':null,
                              'highlighted':null};

        __AutoComplete[id]['element'].setAttribute('autocomplete', 'off');
        __AutoComplete[id]['element'].onkeydown = function(e) {if (!e) e = window.event; return AutoComplete_KeyDown(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onkeyup = function(e) {if (!e) e = window.event; return AutoComplete_KeyUp(this.getAttribute('id'), e);}
        // The function call on the next line was changed by Andrew Grieve April 2008
        __AutoComplete[id]['element'].onkeypress = function(e) {if (!e) e = window.event; return AutoComplete_KeyPress(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onclick = function(e)
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6OnFocus' ] )
            {
                __AutoComplete[id]['element'].focus();
            }
            if (!e) e = window.event; e.cancelBubble = true; e.returnValue = false;
        }



        // Hides the dropdowns when document clicked
        var docClick = function()
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
            }
            else
            {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
            }
        }

        if (document.addEventListener) {
            document.addEventListener('click', docClick, false);
        } else if (document.attachEvent) {
            document.attachEvent('onclick', docClick, false);
        }


        // Max number of items shown at once
        if (arguments[2] != null) {
            __AutoComplete[id]['maxitems'] = arguments[2];
            __AutoComplete[id]['firstItemShowing'] = 0;
            __AutoComplete[id]['lastItemShowing'] = arguments[2] - 1;
        }

        AutoComplete_CreateDropdown(id);

        // Prevent select dropdowns showing thru
        if (isIE) {
            iframe = document.createElement('iframe');
            __AutoComplete[id]['iframe'] = iframe;
                iframe.id = id +'_iframe';
                iframe.style.position = 'absolute';
                iframe.style.top = '0';
                iframe.style.left = '0';
                iframe.style.width = '0px';
                iframe.style.height = '0px';
                iframe.style.zIndex = '98';
                iframe.style.visibility = 'hidden';
                
                if(location.protocol == "https:")
                {
                   iframe.src = 'https://assets.resultspage.com/autosuggest/blank.html';
                }
                
                if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBox' ] )
                {
                  iframe.style.width = __SLI_width  + __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBoxPadding'];
                }

            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IframeAlignment' ] )
            {
                document.body.insertBefore( iframe );
            }
            else
            {
                __AutoComplete[id]['element'].parentNode.insertBefore( iframe, __AutoComplete[id]['element'] );
            }
        }
    }

    /**
    * Creates the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_CreateDropdown(id)
    {
        var theSearchbox = __AutoComplete[id]['element'];
        var theDropDown;
        var left_top = AutoComplete_getPos( theSearchbox );
        var left  = left_top[0];
        var top   = left_top[1] + theSearchbox.offsetHeight;
        var width = theSearchbox.offsetWidth;

        if ( width < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
        {
            width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
        }

        theDropDown = document.createElement('div');
        theDropDown.className = 'autocomplete'; // Don't use setAttribute()


        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true && document.body)
        {
            theDropDown.style.position = 'absolute';
            document.body.insertBefore(theDropDown, document.body.nextSibling);
            
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        else if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "offsetrelative" && document.body)
        {
          theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
          // Position it
          if(sli_getStyle(theSearchbox.offsetParent, 'position') != "absolute")
          {
            theSearchbox.offsetParent.style.position = 'relative';
          }
          theDropDown.style.position = 'absolute';
          theDropDown.style.left = (theSearchbox.offsetLeft) + 'px';
          theDropDown.style.top = (theSearchbox.offsetTop + theSearchbox.offsetHeight) + 'px';
          if ( theSearchbox.clientWidth < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
          {
            theDropDown.style.width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
          }
          else
          {
            theDropDown.style.width = (theSearchbox.clientWidth) + 'px';
          }
          theDropDown.style.visibility = 'hidden';
          theDropDown.style.zIndex     = '99999999';
        }
        else
        {
            theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        

        __AutoComplete[id]['dropdown'] = theDropDown;
        __SLI_width = width;
    }

    function /* array [ left, top ] */ AutoComplete_getPos( obj )
    {
        var curleft = curtop = 0;
        var sli_flag = 0;

        if (obj.offsetParent)
        {
           do
           {
              if ( __SLI_customisations[ __SLI_ApplicationName ][ 'AlignmentBorderBug' ] )
              {         
                
                if(sli_flag == 1)
                {
                    var clientTop = (obj.offsetHeight - obj.clientHeight) / 2;
                    curtop += clientTop;

                    var clientLeft = (obj.offsetWidth - obj.clientWidth) / 2;
                    curleft += clientLeft;
                }
                sli_flag = 1;
              }
           
              curleft += obj.offsetLeft;
              curtop += obj.offsetTop;
           }
           while (obj = obj.offsetParent);
        }
        return [curleft,curtop];
    }

    /**
    * Shows the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ShowDropdown(id)
    {

        AutoComplete_HideAll();



        var value = __AutoComplete[id]['element'].value;
        var toDisplay = new Array();
        var newDiv    = null;
        var text      = null;
        var numItems  = __AutoComplete[id]['dropdown'].childNodes.length;

        __AutoComplete_mouseMoved=false;
        // SLI Code Modification - Start - Andrew Grieve April 08
        // Trim the textbox so that if is starts with a space then the feature will still work
        //value = value.replace(/^\s+|\s+$/g,"");
        value = value.replace(/^\s+/g,"");

        if(value.length == "")
        {
            // If Textbox length is nothing (after the trim) then don't show dropdown.
            return;
        }
        // SLI Code Modification - End

        // Remove all child nodes from dropdown
        while (__AutoComplete[id]['dropdown'].childNodes.length > 0) {
            __AutoComplete[id]['dropdown'].removeChild(__AutoComplete[id]['dropdown'].childNodes[0]);
        }


        var count=0;
        // Go thru data searching for matches
        for (i=0; i<__AutoComplete[id]['data'].length; ++i)
        {
            // SLI Code Modification - Start - Andrew Grieve April 08 - Added lower casing
            if (__AutoComplete[id]['data'][i].substr(0, value.length).toLowerCase() == value.toLowerCase())
            {
                // SLI Code Modification - End
                toDisplay[toDisplay.length] = __AutoComplete[id]['data'][i];
                count++;
                /* how many to display? */
                if(count == __SLI_customisations['AutoSuggest']['MaxListItems'] ) /* Code inserted to keep list to a maximum of 10 values (was 20 or 30) */
                {
                    break;
                }
            }
        }

        // No matches?
        if (toDisplay.length == 0) {
            AutoComplete_HideDropdown(id);
            return;
        }



        // Add data to the dropdown layer
        for (i=0; i<toDisplay.length; ++i) {
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_item'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';

             // Scrollbars are on display ?
            if (toDisplay.length > __AutoComplete[id]['maxitems'] && navigator.userAgent.indexOf('MSIE') == -1) {
                newDiv.style.width = __AutoComplete[id]['element'].offsetWidth - 22 + 'px';
            }

            newDiv.onmouseover =
        function()
        {
            if( __AutoComplete_mouseMoved )
                AutoComplete_HighlightItem(__AutoComplete[id]['element'].getAttribute('id'), this.getAttribute('index'));
        };

            newDiv.onclick     =    function()
                                    {
                                    	  __SLI_asug_used_flag = true;
                                                                           
                                        AutoComplete_SetValue(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_HideDropdown(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_submitForm(id);
                                    }



            text   = document.createTextNode(toDisplay[i]);
            newDiv.appendChild(text);
            newDiv.title='Search for ' + toDisplay[i];

            /* ellipsis for IE only */
            if( isIE )
            {
                newDiv.style.textOverflow = 'ellipsis';
                newDiv.style.width = '100%';
                newDiv.style.whiteSpace = 'nowrap';
                newDiv.style.overflow = 'hidden';

            }
            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }
        /*
         * append DIV containing footer branding...
         */
        if(__SLI_customisations['AutoSuggest']['ShowBrandingFooter'])
        {
            i = toDisplay.length;
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_footer'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';
            newDiv.innerHTML = '<a href="http://www.sli-systems.com/powered-by.php" title="' +
                                __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterTitleTooltip' ] +
                                '"><img class="autocomplete_footer_branding" src="'+__AutoCompleteBranding.src+'" /></a>';

            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }


        // Too many items?
        if (toDisplay.length > __AutoComplete[id]['maxitems']) {
            __AutoComplete[id]['dropdown'].style.height = (__AutoComplete[id]['maxitems'] * 15) + 2 + 'px';

        } else {
            __AutoComplete[id]['dropdown'].style.height = '';
        }


        /**
        * Set left/top in case of document movement/scroll/window resize etc
        */
        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "true" || __SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "false")
        {
            var left_top = AutoComplete_getPos( __AutoComplete[id]['element'] );
            __AutoComplete[id]['dropdown'].style.left = left_top[0];
            __AutoComplete[id]['dropdown'].style.top  = left_top[1] + __AutoComplete[id]['element'].offsetHeight;
        }


        // Show the iframe for IE
        if (isIE) {
            
            if(!__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true)
            {
               __AutoComplete[id]['iframe'].style.width  = __AutoComplete[id]['dropdown'].offsetWidth;
            }
            
            
            __AutoComplete[id]['iframe'].style.top    = __AutoComplete[id]['dropdown'].style.top;
            __AutoComplete[id]['iframe'].style.left   = __AutoComplete[id]['dropdown'].style.left;
            __AutoComplete[id]['iframe'].style.height = __AutoComplete[id]['dropdown'].offsetHeight;

            __AutoComplete[id]['iframe'].style.visibility = 'visible';
        }

    e =  __AutoComplete[id]['dropdown'];

    e.onmousemove =
        function()
        {
            if(!__AutoComplete_mouseMoved){__AutoComplete_mouseMoved=true;}
            this.onmousemove = null;
        }

        // Show dropdown
        if (!__AutoComplete[id]['isVisible']) {
            __AutoComplete[id]['dropdown'].style.visibility = 'visible';
            __AutoComplete[id]['isVisible'] = true;
        }


        // If now showing less items than before, reset the highlighted value
        if (__AutoComplete[id]['dropdown'].childNodes.length != numItems) {
            __AutoComplete[id]['highlighted'] = null;
        }
    }



    /**
    * Hides the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_HideDropdown(id)
    {
        if (__AutoComplete[id]['iframe'])
        {
            __AutoComplete[id]['iframe'].style.visibility = 'hidden';
        }
        
        if (__AutoComplete[id]['dropdown'])
        {
            __AutoComplete[id]['dropdown'].style.visibility = 'hidden';
        }

        __AutoComplete[id]['highlighted'] = null;
        __AutoComplete[id]['isVisible']   = false;
    }


    /**
    * Hides all dropdowns
    */
    function AutoComplete_HideAll()
    {
         if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
         {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
         }
         else
         {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
         }
    }


    /**
    * Highlights a specific item
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_HighlightItem(id, index) // mouseover, index is the list element index, zero-based
    {
        if (__AutoComplete[id]['dropdown'].childNodes[index]) {
            for (var i=0; i<__AutoComplete[id]['dropdown'].childNodes.length; ++i) {
                if (__AutoComplete[id]['dropdown'].childNodes[i].className == 'autocomplete_item_highlighted') {
                    __AutoComplete[id]['dropdown'].childNodes[i].className = 'autocomplete_item';
                }
            }

            __AutoComplete[id]['dropdown'].childNodes[index].className = 'autocomplete_item_highlighted';
            __AutoComplete[id]['highlighted'] = index;

            //also see below...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[index].innerHTML;
            //AutoComplete_SetValue(id);
        }
    }


    /**
    * Highlights the menu item with the given index
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_Highlight(id, index) // keyboard up/down - index is the direction of travel, 1==down,-1=up
    {
        var childNodes = __AutoComplete[id]['dropdown'].childNodes;
        if(childNodes.length)
        {
	        var lastItem = ( ( childNodes[ childNodes.length - 1 ].className != 'autocomplete_footer' ) ? childNodes.length - 1 : childNodes.length - 2 );

            // Out of bounds checking
            //if (index == 1 && __AutoComplete[id]['highlighted'] == __AutoComplete[id]['dropdown'].childNodes.length - 1) {
            if (index == 1 && __AutoComplete[id]['highlighted'] == lastItem ) {
                childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = null;

            } else if (index == -1 && __AutoComplete[id]['highlighted'] == 0) {
                childNodes[0].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = lastItem;
                index = 0;//hack!
            }

            // Nothing highlighted at the moment
            if (__AutoComplete[id]['highlighted'] == null) {

                childNodes[0].className = 'autocomplete_item_highlighted';
                __AutoComplete[id]['highlighted'] = 0;
                newIndex = 0;
                
            } else {

                if (childNodes[__AutoComplete[id]['highlighted']]) {
                
                    childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                }

                var newIndex = parseInt( __AutoComplete[id]['highlighted'] ) + parseInt(index);

                if (childNodes[newIndex]) {

                    childNodes[newIndex].className = 'autocomplete_item_highlighted';

                    __AutoComplete[id]['highlighted'] = newIndex;
                }
            }

            //populate textbox with currently highlighted term...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[newIndex].innerHTML;
            AutoComplete_SetValue(id);
        }
    }


    /**
    * Sets the input to a given value
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_SetValue(id)
    {
        __AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[__AutoComplete[id]['highlighted']].innerHTML.replace(/&amp;/, "&");
    }


    /**
    * Checks if the dropdown needs scrolling
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ScrollCheck(id)
    {
        // Scroll down, or wrapping around from scroll up
        if (__AutoComplete[id]['highlighted'] > __AutoComplete[id]['lastItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'] - (__AutoComplete[id]['maxitems'] - 1);
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'];
        }

        // Scroll up, or wrapping around from scroll down
        if (__AutoComplete[id]['highlighted'] < __AutoComplete[id]['firstItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'];
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'] + (__AutoComplete[id]['maxitems'] - 1);
        }

        __AutoComplete[id]['dropdown'].scrollTop = __AutoComplete[id]['firstItemShowing'] * 15;
    }


    /**
    * Function which handles the keypress event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyDown(id, e)
    {
        var result = true;

       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {

            // Return/Enter
            case 13:
                if (__AutoComplete[id]['highlighted'] != null) {
                    AutoComplete_SetValue(id);
                    AutoComplete_HideDropdown(id);
					
                    __SLI_asug_used_flag = true;
					
                    if( e = __AutoComplete[id]['element'].form['asug'] )
                    {
                        
                        e.disabled=false;
                        e.value = __AutoComplete[id]['asug'];
                    }

                }

                result = AutoComplete_submitForm(id);

                break;

            // Escape
            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            // Up arrow
            case 38:
                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, -1);
                AutoComplete_ScrollCheck(id, -1);
                
                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                                
                result = false;
                break;

            // Tab
            case 9:
                if (__AutoComplete[id]['isVisible']) {
                    AutoComplete_HideDropdown(id);
                }
                return;

            // Down arrow
            case 40:

                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, 1);
                //AutoComplete_ScrollCheck(id, 1);

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                result = false;
                break;
        }
        return result;
    }


    /**
    * Function which handles the keyup event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyUp(id, e)
    {
       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {
            case 13:
                event.returnValue = false;
                event.cancelBubble = true;
                
                break;

            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            case 38:
            case 40:
                return false;
                break;

            default:
                AutoComplete_ShowDropdown(id);
                
                __AutoComplete[id]['asug']=__AutoComplete[id]['element'].value;

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=true;
                   e.value = "";
                }  
                
                break;
        }
    }

    /**
    * Function which handles the keypress event
    * This function added April 2008 by Andrew Grieve
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */

    // SLI Code Modification - Start - Andrew Grieve April 08
    function AutoComplete_KeyPress(id, e)
    {
        var event = e;
        if(!event) event = window.event;
        var keyCode = event.keyCode;

        if (keyCode == 13 && isGecko || isOpera)
        {
            return false;
        }
        
        if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
        {
            if (keyCode == 13 && isIE)
            {
                return false;
            }
        }
        
    }
    // SLI Code Modification - End

    /**
    * Returns whether the dropdown is visible
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_isVisible(id)
    {
        return __AutoComplete[id]['dropdown'].style.visibility == 'visible';
    }

    function AutoComplete_submitForm(id)
    {
      var e, f, result=true;
      if( f = __AutoComplete[id]['element'].form )
      {
        if( __AutoComplete[id]['element'].value != '' )
        {
          if(__SLI_asug_used_flag == true)
          {
            if( e = f['asug'])
            {
              e.value = __AutoComplete[id]['asug'];
              e.disabled=false;
            }
          }

          if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
          {
            asugvar = "";
            if(__SLI_asug_used_flag == true)
            {
              asugvar = '&asug=' + escape(__AutoComplete[id]['asug']);
            }

            sliRegex = /resultsdemo\.com/;
            if(sliRegExArray = sliRegex.exec(document.domain))
            {
              sliRegex = /^http:\/\/(.*)\//;
              sliTargetDomain = sliRegex.exec(__SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ]);
              __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ].replace(sliTargetDomain[1], document.domain);
            }

            document.location.href = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] + escape(__AutoComplete[id]['element'].value) + asugvar;
          }
          else
          {
            if(f.onsubmit)
            {
              if(f.onsubmit() !== false)
              {
                f.submit();
              }
            }
            else
            {
              f.submit();
            }
          }

          AutoComplete_HideAll();
        }
        else
          result = false;
      }
      return result;
    }
    
    // get the style that will be applied by the browser, including stylesheets
    function sli_getStyle(el,styleProp)
    {
      if (el.currentStyle)
        var y = el.currentStyle[styleProp];
      else if (window.getComputedStyle)
        var y = document.defaultView.getComputedStyle(el,null).getPropertyValue(styleProp);
      return y;
    }

    // register with onLoad(er...
    _sli_init.push( AutoComplete_init );
    
    function sli_addEvent(obj, evType, fn) {
    	if (obj.addEventListener) {
    		obj.addEventListener(evType, fn, false);
    		return true;
    	} else if (obj.attachEvent) {
    		var r = obj.attachEvent("on" + evType, fn);
    		return r;
    	} else {
    		return false;
    	}
    }
    
    function sli_load()
    {
    	sli_addEvent(window, 'load', sli_init);
    }