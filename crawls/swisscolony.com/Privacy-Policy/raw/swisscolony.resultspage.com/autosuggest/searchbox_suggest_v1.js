/* Popular phrases - SWISSCOLONY - 17:59:10, Sat Mar 9, 2013 */
__SLI_ClientDefaults =
[
    ['Alignment', 'offsetrelative' ],
	['IE6SelectBox', true ],
    ['ShowBrandingFooter', false ],
];
var asPhrases=new Array ('candy','petit fours','easter','easter baskets','ham','cheese','cheesecake','sugar free products','truffles','cakes','toffee','sale','fudge','sugar free','baklava','butter toffee','cheese spreads','fruit cake','fruit','cashews','red velvet','jelly beans','nuts','breakfast','summer sausage','beef log','petit','fruitcake','birthday','mixed nuts','easter candy','cake balls','torte','coconut','jelly belly','frog','catalog','macadamia nut chocolate','chocolate','beef jerky','petit four flavors','bonbons','spreadables','mustard','lemon','red velvet petit fours','pumpkin','meat sticks','chocolate truffles','beef','peanut brittle','jelly belly jelly beans','butterfly','easter gifts','incredible spreadables','sausage','ladybug','coffee','pretzels','spring cookies','incredible petits fours','birthday petit fours','carrot cake','pecan','careers','ladybug truffles','brownies','cheese and sausage','lemon cheesecake','petits fours gift','cheese cake','bread','frog truffle','pistachios','cheese slicer','easter cakes','mini butter toffee','rum balls','gluten free products','sweet hot mustard','baskets','personalized','gummi butterflies','taffy','sampler','oranges','valentines','macadamia','red velvet cheesecake','throw','macadamia nuts','frog chocolates','fruit slices','mint','spring flower tower','spiral ham','baby swiss cheese','log','monkey','tea','meat','saltwater taffy','sugar free cookies','wreath','candy sampler','chocolate covered cherries','spring','swiss cheese','spring petit fours','spreads','shipping charges','breakfast gifts','jelly belly bin','red velvet cake','peanut butter and chocolate','chocolate cake','mint torte','dobosh','pecan clusters','dark chocolate','shipping','pancake mix','coconut drops','chocolate covered potato chips','lace cookies','mini petit fours','cookies in a tin','peanut butter','personalized hoodie zoo animals','petit fours gift box','gluten free','cheddar cheese','baklava squares','gummy candy','coconut petits four','vintage cheddar cheese','happy birthday petit fours','easter petits fours','gummies','kreme kaese cheese','lemon petit fours','toffee brickle','crrrisps','chihuahua with candy','jerky','sugar free petits fours','beef sticks','sausage and cheese bars','hummingbird throw','carrot cake petits fours','personalized petit fours','blueberry pecan cookies','caramel pecan clusters','toys','dobosh torte','seafood','cheese log','coffee sampler','happy birthday','strawberry daiquiri cheesecake','trail mix','ice cream cake balls','raspberry','zoo chocolates','fruit spread','fruit gels','bark','birthday cakes','spreadable cheese','cherries','zoo','peanut','potato chips','chocolate petit fours','strawberry shortcake','animal','strawberry petit fours','petit fours and bonbons','butter brickle toffee','ham and swiss','tiger basket','towers','bavarian bonbons','chris mouse','stollen','cookies and creme','sugar free candy','orange dreamsicle cake','forest friends log','liqueur truffles','lemon cakes','caramel apple cheesecake','cheese and sausage gift','chocolate fudge','chocolate torte','wild game meat sticks','ham and cheese','apple pie','seafood incredible spreadables gift of 5','mint chocolate','maple sugar','angel treasure chest','shortbread','raccoon log','caramel','colossal breakfast','elephant','tablet','baby swiss','conversation cakelet','black licorice','sticky buns','chocolate covered macadamia nuts','cocktail jelly belly petit fours','hearty breakfast meats','zoo animals','dutch apple cake','spring fruit slices','mustard trio','summer sausage logs','27 favorites','liqueur','raspberry swirl cake','fudge tin','pecan praline','all occasion petits fours','spring candy','florentine lace cookies','mixed nuts tins','vanilla petits fours','licorice','strawberry','clusters','spicy','plush','hot mustard','butterfly throw','butter toffee crunch','strawberry cheesecake','coffee cake','christmas fruit cake','11 piece personalized bbq tool set','chocolate candy','tea cakes','bridge mix','apple cake','chocolate easter card','gift certificate','pralines','big red and swiss','dips','apple pancake mix','chickadee torte','sugar free jelly bellies','carrot cake balls','cocktail jelly belly','mini toffee','jalapeno beef log','chocolate toffee','sausage and cheese box','dark chocolate truffles','strawberry teapot','swiss','apple','banana foster bonbons','ham\'s','butterfly chocolates','spring fruit gel slices','chocolate bunny','fruit and nut delights','pillows','critter treat totes','easter family treats box','meat stick bonanza','almonds','teapot','sugar free cheesecake','smoked bacon','cat','coconut cake','beef and cheese','spiral sliced ham','monster cake balls','bee','jam','candy tins','dog','blue cheese','peanut butter bites','fudge trio','bunny','art','tea pot','gift of plenty','birthday gifts','bottle opener','wildflower tower','cheese dips','blueberry','sharp cheese','lily','friendship plate','pepperoni','brittle','glazed ham','raccoon cake','crab delight','strawberry lemon','jalapeno','gift sampler','chocolate covered nuts','apple cinnamon pancake mix','clocks','easter candy box','pumpkin coffee cake','jumbos','nut chocolate mix','jelly','crrrrisps','cheddar','chips','ice cream','premium nut assortment','spring pretzels','blueberry cheese','bugs','candy sampler trio','apply for credit','ladybug chocolates','eagle','mouse','sandscape','dark truffles','cheese cake morsels','smokey cheddar','cookie cake','ranch','statement','sugar free truffles','venison sticks','zoo basket trio','elk sticks','walkers scottie dog shortbread','garden vegetable','petit fors','tower of treats','gourmet brownies','sugar free macadamia','boneless ham and baby swiss','licorice tin','orange cake','brickle','dog with candy','monkey backpack','26 holiday favorites','herb garden','rum','gift boxes','lucky irish coin pendant','lapsies','fruity and white cheddars','stretch ring','macadamia nut fruitcake','two tone cross pendant','easter splash basket','chick','sugar free gummy fish','bananas foster','chocolate cherries','peanut butter truffles','friends log','edam cheese','pies','lemon log','fudge pecan','fruit cake cookies','tiger','garden vegetable wheel','panda','sugar free bread','deluxe mixed nuts','maple syrup','smores barks','electronics','lite beef log','ham and bacon','colby cheese','chocolate layered mints','brie','smores','gel slices','stick','strawberry fudge','butter brickle','vanilla','breakfast box','ribbon','creme de menthe','cheese wax','swirl cake','basket trio','little cakes','peanut butter candy','popcorn tins','cajun mix','maple','shipping chart','s\'mores bark','potato stick candies','banana','chihuahua','bakery','spring chocolates','sugar free cherry cordials','pumpkin cake','oatmeal','stix','lion','kreme kaese','the swiss colony chocolate truffles','swiss chees','sugar free mints','dog bed','red velvet cake balls','lemon pies','mothers day','classic spring chocolates','easter nibbles basket','backpack','cake rolls','jacket','old fashioned fudge trio','fudge assortment','candy coated pretzels','jumbo cheese trio','mini-butter-toffee','honey','chocolate cake roll','birthday brownie','smoked cheddar cheese spread','beef sausage and cheese','torte triple','creame de menthe','pistachios-tin','pecan log','gingerbread','wolf','banana split','smart tablet','decorations','mint chocolate chip cheesecake','mini cookie bites','lamb','pastel coconut petit fours','coffee bark','cheese and crrrisps','onion cheese','spiced pumpkins','trio','angel box','gluten','gummy fish','swiss roll','lemon bark','pecan cheese log','dog pillow','flask','chocolate pecan','little lemon pies','easter lemon cake','caraway cheese','grapefruit','ham links','bunny log','almond bark','marshmallow','gloves','interchangeable 10 charms jewelry','pjs','butter pecan fudge','fruitcake cookies','32 snack','white cheddar cheese','desk','shell','easter basket floral','ceramic','double guarantee','valencia oranges','jumbo cashews','slices','banana split petite fours','red velvet petits','petite mints','sugar free brownies','favorite five','butter stollen','family keepsake ornament','apple cheesecake','puppy dogs','tropical petit fours','cheese sampler','candy fruit slices','bee and flower','chocolate petit','lounge','hound with candy','chocolate covered mixed nuts','sunshine','fresh flowers','ship to canada','no sugar added','strawberry shortcake petit fours','dreamsicle','select mixed nuts','lemon tarts','marble cheese slicer','crrrisps and spreads','apo gifts','kreme cheese','sugar free coconut','chocolate cake balls','gluten free cookies','wildlife bottle opener','cordials','velour pant set','fruit spread sampler','pepper bacon','malt','72 petit fours','tangerines','muenster','western long sleeve tee','set','graham','totes','hazelnut','moon','oatmeal cookies','peppermint candy bites','alarm clock','box towers','holiday blend coffee','breakfast petit fours','spring brownies','chocolate dobosh','plush candy trio','blueberry cookies','lime petits fours','boneless spiral sliced ham','wildflower wreath','confetti party bark','9','easter cake trio','telescope','sixlets','no sugar added bread','cajun beef sticks','tropical','petit four samplers','strawberry shortcake cheesecake','chocolate chip cookies','ancho chili cake balls','rocky','vanilla cake','gummy worms','cheesecake bits','baby gifts','onion dip','royal chocolate petits fours','monkey backpack candy','meltaways','pumpkin bark','mini cakes','cheese bars with slicer','deep dish apple pie','hound','new products','sugar free peanut butter','strawberry tea service','port wine cheese spread','mixed nuts with 50% pistachios','gold','nut tins','zoo basket','masterpiece baked ham','gummy peach rings','petite cakes','daisy wreath','hotline to god','western dvd','chocolate easter bunny','party','chickadee basket','pecan swirl','sea salt chocolates','order','chocolate covered pecans','bacon cheese spread','food gifts','amazing grace clock','scottie','spiral sliced ham with fired-in sugar glaze','cross watch','cream cheese spreads','pineapple cake','florentine','jelly cake','spice drops','giraffe','grill set','peach cheesecake','garden vegetable dip','maple ham links','assorted petit fours','garden vegetable spread','spicy cajun sticks','sausage assortment','pc','apo fpo gifts','shelled pistachio nuts','sugar free taffy','vegetable spread','shelled pistachios','sugar free trail mix','chocolate gifts','garlic cheese','pumpkin coffee','zigzag','luscious lemon cheesecake','happy easter petit fours','cheese and sausage sampler','fudge egg','pecan tarts','lovable lapsies','pants','walkers','brick','favorite five cheese bars','nickel','candy basket','summer','sugar free gluten free','mens sweaters','dream','peach candy','easter eggs','send catalog','pet\'s','easter bunny torte','heart cake','savory','fruit cake with rum','green','zigzag sweater','ham and pancakes','lobster dip','jelly bean tin','family treats box','john wayne tribute collection','crab','sugar free petit','buns','my greatest blessings','chocolate hearts','no peanuts','bunny tortes','spring bridge mix','spring petit','valentine tower','strawberry bark','birthday brownie cookie','eagle hoodie','monster balls','potato sticks','nut fruitcake','lime','mix and match','pastel petit fours','no shipping','incredible','personalized chocolate','cakelet','red velvet layer cake','carrot spice petit fours','incredible-spreadables','breakfast and coffee','personalized fudge egg','mini cookies','children','swiss cheese and ham combo','spicy cajun beef sticks','mailbox','gluten free almond crunch','muffins','bunny salt and pepper shakers','valentine cake','pancake and ham links','baby swiss wheel','rocky road swirl cake','swiss and cheddar log','natural pecans','pecan delights','batteries','haystacks','easter boxes tower','light up','lamb plush basket','butter toffe','winter scene sweatshirt','jelly belly assortment','lap','key lime petits fours','sentimental','valentines day petit fours','mint chocolate chip','baker cheeses','cheese bar and slicer','petit four cake','premium nut','chocolate with pecans','chick and egg tower','blueberry petit fours','50% off','peppermint bites','cocktail','buttery toffee','nut varieties','scottie dog walkers','cheese spread and crackers','gluten free mixes','mom or grandma birthstone pendant','personalized valentine','vintage','winter sweatshirt','sugar free pecan clusters','pepper cheese','lady','soft center','5','roasted pecan','custom','mint chocolate torte','morsels','can','beans','bright eyes','mint cheesecake','scottish shortbread','sugar-free petite fours','swiss cheese spread','pick and choose','butter crunch','chocolate friend log','layered mints','hot cajun beef sticks','stargazer lily','pick n choose','sugar free fours','chocolate bites','stargazer','cheddar cheese spread','chocolate chip cookies gluten free','chocolate butter toffee','mint chocolate cheesecake','filled cookies','smiling monkeys','roast','cutting','sugar free fruitful delight','my','valentine mailbox','creamy cheddar','hot','sugar free candy tin','cheddar cheese spreadable','wild meat sticks','chocolate covered cashews','apple cinnamon pancake','pans','bacon cheddar','favorite five tortes','bread mix','buffalo nickel dream catcher pendant','valentine fudge','chocolate heart cake','big baby','binoculars','cashews almonds pecans brazils and filberts','bacon cheddar spread','bonbons fours','filbert','peanut clusters','bison sticks','wireless','chees board','creme torte','lucky irish pendant','pepper seasoned bacon','sweet sausage','shipping to apo','tiger and hoodie','l','mint-chocolate-torte','gluten free cheese','mild jalapeno','maple links','spiral sliced ham with fired in sugar glaze','spinach supreme','sharp','sausage n cheese bars gift of 10','deluxe','chocolate raisins','when will it be shipped','bacon log','smile','personalized animals','sugar free chocolate pecan fudge','chocolate caramel and pecans','smiley','fresh oranges','chocolate fudge petit four','sausage n cheese bars gift of 4','chocolate bars','triple chocolate torte','swiss and ham cheese spread','orange bread','cheese ingredients','brazil','maple flavored ham links','spiral-sliced-ham','sugar free sale','swiss bacon','sugar-free cheesecake','french onion','11 piece bbq set','covered macadamia nuts','sugar free chocolate cover','strawberry daiquiri','breakfast breads','trio of classic candy samplers','bacon cheese log','chocolatey potato chips','phone to god','sausages n cheese bars gift of 9','chris card','stone','shoe shine','red rind muenster','sweet basket','chocolate with nuts','special delivery','filbert creme','shrimp scampi','fruity','sugar free tower','big logs','chocolate nut tin','mixed nuts 50 pistachio','chocolate torte cake','boneless-ham','marble board slicer','petit f','salted nuts','sweet and hot spreadables','five','serving','sugar free holiday tower','santa jellies','send a gift','crab spread','maple ham','sugar free merry christmas petits fours','petit ours','merry','chocolate buttons','sausage gift','spinach','boneless smoked ham','cheese sausage mustard','bone ham','mint dobosh torte','glaze','six','mixed chocolates','candy slices','chocolate sample','front five','merry christmas petit','cheese sausage torte gift samplers','cheese-cake','spiral','chris mouse pleaser','gift of 7','shoe shine kit','petit four gift samplers','cheese trio','two sweet','mini gift boxes','chocolate lovers','cheese sausage torte','forest cake','beef log gift of 6','maple sausage','pers giraffe hoodie','chees spread','mini butter toffe','chocolate cookies','cheddar logs','silver','sausage and chees','sau','mouse cards','petit four tree','must','sweet bread','bars in logs','forest log','trio candy','genuine buffalo nickel dream catcher pendant','bacon smoked cheese spread','chocolate raspberry jellies','cheese sets','six gift sampler','custard','the big ones','big baby swiss','cheese sausage and petit fours','chocolate mint cake','sausage and petit fours','cheese gift box','port wine cheese logs','bacon cheddar cheese spread','pj s','bu','pers pet carrier','cut rock','sugar free christmas','sugar free pecan','swiss colony beef log','chocolate christmas mouse','chocolate trio','sausage and cheese tower','small tin','fired in ham','projector alarm clock','colossal','merry christmas chocolate','medley','case','chocolate grahams','masterpiece','crab cheese','chocolate covered cake','butter-toffee','chocolate bonbons','fruit nut breads and cremes gift of 7','swiss and sausage','sugar free fish','take five','sale postpaid','premium','gift of 72 petit fours','bible phone','cheese and fruit gifts','by christmas','#2 cheeses','personalized pet carrier','cheese box','sugar glazed ham','sugar free slices','chocolate tower','lucky irish','chocolate raccoon','baby swiss postpaid','swiss colony 27','temperature','sugar free gummies','shrimp cheese','holiday cakes','special blend coffee','sausage n cheese bars gift of 8','port wine with almonds','two hams','box summer sausage','carees','beef mustard','chocolate and mint logs','horatio','pers angel throw','food assortments','snack size','front','game meat','hole punch','gift of 4 cheese and sausage','bone','cover','strawberry galettes','sugar free nuts','ganache','lil petites','sausage and candy','nut trio','guardian treasure chest','coated pretzels','favorite fives cheese','hand decorated holiday cookies','filled','spiral glazed ham','sugar free vanilla cheesecake','soaring eagle fleece','old fashion toffee','chocolate p','triple chocolate','old cookies','gel candy','beef log food gift combo','hugger','coin pendant','butter truffles','petit fours sugar','chocolate-filled straws','wrapped boxes','24 petits','shipping included petit fours','6 gift samplers','cat sweatshirt','sugar free raspberry','decorated cookies','cheese tubs','cheese tubs and crackers','sugar free chocolate fudge','smoked cheese spread','gifts sale','keepsake','cheddar swiss and cream cheese','sugar free gift tower','shrimp dip');
/* $Revision: 6883 $
 *
 */

if(typeof(_sli_init )!='object'){var _sli_init=new Array();}
if(typeof(sli_init )!='function'){function sli_init(){ for(var x=0;x<_sli_init.length;x++) _sli_init[x]();}}
if(typeof(asPhrases)!='object'){ var asPhrases = new Array(); }
if(typeof(__SLI_customisations)!='object'){var __SLI_customisations = new Object();}
if(typeof(__SLI_ClientDefaults)!='object'){ var __SLI_ClientDefaults=[]; }
if(typeof(__SLI_validSearchBoxes)!='object'){ var __SLI_validSearchBoxes = new Array(); }
if(typeof(__SLI_asug_used_flag)!='object'){ var __SLI_asug_used_flag = false; }
if(typeof(__SLI_width)!='object'){ var __SLI_width = 0; }
if(typeof(sli_targeturl)!='object'){ var sli_targeturl = ""; }


    __AutoComplete = new Object(); //namespace...
    __AutoComplete_mouseMoved=false;

    // Basic UA detection
    isIE = document.all ? true : false;
    isGecko = navigator.userAgent.toLowerCase().indexOf('gecko') != -1;
    isOpera = navigator.userAgent.toLowerCase().indexOf('opera') != -1;

    /* defaults and options */

    var __SLI_ApplicationName = 'AutoSuggest';
        __SLI_customisations[ 'AutoSuggest' ] =
                {
                    'ShowBrandingFooter' : true
                    ,
                    'TextBoxIDPrefix' : 'sli_search_'
                    ,
                    'BrandingFooterImagePath' : 'http://assets.resultspage.com/autosuggest/sli_systems-powered_150_15.gif'
                    ,
                    'BrandingFooterTitleTooltip' : 'AutoSuggest Powered by SLI Systems'
                    ,
                    'DropListMinWidth' : 150
                    ,
                    'MaxListItems' : 10
                    ,
                    'Alignment' : true
                    ,
                    'TextBoxIDCustom' : []
                    ,
                    'ValidSearchBoxes' : false 
                    ,
                    'IE6SelectBox' : false 
                    ,
                    'IE6SelectBoxPadding' : 0
                    ,
                    'TargetURL' : ''
                    ,
                    'IframeAlignment' : false
                    ,
                    'AlignmentBorderBug' : false
                    ,
                    'IE6OnFocus' : false
                };
    /* 0 = keyname, 1 = value */
    for( defaultValuePair in __SLI_ClientDefaults )
    {
        __SLI_customisations[__SLI_ApplicationName][__SLI_ClientDefaults[defaultValuePair][0]]=__SLI_ClientDefaults[defaultValuePair][1];
    }

    /* pre-fetch branding footer image if being used...
     */
    if( __SLI_customisations[ __SLI_ApplicationName ][ 'ShowBrandingFooter' ] )
    {
        
        if(location.protocol == "https:")
        {
            __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ] = __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ].replace(/http:/i, 'https:');
        }
    
        var __AutoCompleteBranding = new Image();
        __AutoCompleteBranding.src=__SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ];
    }


    function AutoComplete_init()
    {
        if(!isOpera)
        {
            var oldonresize=function(){};
            if(typeof(window.onresize)=='function')
                oldonresize = window.onresize;//play nicely with other people's toys
            window.onresize= function(){ oldonresize(); AutoComplete_HideAll(); AutoComplete_Create( asPhrases ); }

            AutoComplete_Create( asPhrases );
            
            var els = document.getElementsByTagName('input');
            if(els)
            {
               for ( i = 0; i < els.length; i++ )
               {
                  if(els[i].name == "asug")
                  {
                     els[i].disabled = true;
                  }
               }
            }
        }
    }




    /**
    * Attachs the autocomplete object to a form element. Sets
    * onkeypress event on the form element.
    *
    * @param string formElement Name of form element to attach to
    * @param array  data        Array of strings of which to use as the autocomplete data
    */
    //function AutoComplete_Create (id, data)
    /*
     * iterate over 'sli_search_*' assumes one or more search boxes numbered from 1...
    */
    function AutoComplete_Create( data )
    {
        var idx=1, e, id, searchBoxPrefix=__SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDPrefix' ];
        while( e = document.getElementById(searchBoxPrefix+idx) )
        {
            AutoComplete_AttachHandlers(e, data);
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
                __SLI_validSearchBoxes.push(searchBoxPrefix+idx);
            }
            idx++;
        }
        
        
        //this array comes from the customised list
        var otherTextBoxIdList = __SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDCustom' ];
        if( otherTextBoxIdList)
        {
            for(idx=0;idx<otherTextBoxIdList.length;idx++)
            {
                e = document.getElementById(otherTextBoxIdList[idx]);
                if(e)
				{
					if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
                	{
	                    __SLI_validSearchBoxes.push( otherTextBoxIdList[idx] );
                	}
					AutoComplete_AttachHandlers(e, data);
				}
            }
        }
        
    } 

    function AutoComplete_AttachHandlers(e, data){
        var iframe,id;
        id=e.id;


        __AutoComplete[id] = {'data':data,
                              'isVisible':false,
                              'element':document.getElementById(id),
                              'dropdown':null,
                              'highlighted':null};

        __AutoComplete[id]['element'].setAttribute('autocomplete', 'off');
        __AutoComplete[id]['element'].onkeydown = function(e) {if (!e) e = window.event; return AutoComplete_KeyDown(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onkeyup = function(e) {if (!e) e = window.event; return AutoComplete_KeyUp(this.getAttribute('id'), e);}
        // The function call on the next line was changed by Andrew Grieve April 2008
        __AutoComplete[id]['element'].onkeypress = function(e) {if (!e) e = window.event; return AutoComplete_KeyPress(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onclick = function(e)
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6OnFocus' ] )
            {
                __AutoComplete[id]['element'].focus();
            }
            if (!e) e = window.event; e.cancelBubble = true; e.returnValue = false;
        }



        // Hides the dropdowns when document clicked
        var docClick = function()
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
            }
            else
            {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
            }
        }

        if (document.addEventListener) {
            document.addEventListener('click', docClick, false);
        } else if (document.attachEvent) {
            document.attachEvent('onclick', docClick, false);
        }


        // Max number of items shown at once
        if (arguments[2] != null) {
            __AutoComplete[id]['maxitems'] = arguments[2];
            __AutoComplete[id]['firstItemShowing'] = 0;
            __AutoComplete[id]['lastItemShowing'] = arguments[2] - 1;
        }

        AutoComplete_CreateDropdown(id);

        // Prevent select dropdowns showing thru
        if (isIE) {
            iframe = document.createElement('iframe');
            __AutoComplete[id]['iframe'] = iframe;
                iframe.id = id +'_iframe';
                iframe.style.position = 'absolute';
                iframe.style.top = '0';
                iframe.style.left = '0';
                iframe.style.width = '0px';
                iframe.style.height = '0px';
                iframe.style.zIndex = '98';
                iframe.style.visibility = 'hidden';
                
                if(location.protocol == "https:")
                {
                   iframe.src = 'https://assets.resultspage.com/autosuggest/blank.html';
                }
                
                if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBox' ] )
                {
                  iframe.style.width = __SLI_width  + __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBoxPadding'];
                }

            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IframeAlignment' ] )
            {
                document.body.insertBefore( iframe );
            }
            else
            {
                __AutoComplete[id]['element'].parentNode.insertBefore( iframe, __AutoComplete[id]['element'] );
            }
        }
    }

    /**
    * Creates the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_CreateDropdown(id)
    {
        var theSearchbox = __AutoComplete[id]['element'];
        var theDropDown;
        var left_top = AutoComplete_getPos( theSearchbox );
        var left  = left_top[0];
        var top   = left_top[1] + theSearchbox.offsetHeight;
        var width = theSearchbox.offsetWidth;

        if ( width < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
        {
            width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
        }

        theDropDown = document.createElement('div');
        theDropDown.className = 'autocomplete'; // Don't use setAttribute()


        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true && document.body)
        {
            theDropDown.style.position = 'absolute';
            document.body.insertBefore(theDropDown, document.body.nextSibling);
            
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        else if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "offsetrelative" && document.body)
        {
          theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
          // Position it
          if(sli_getStyle(theSearchbox.offsetParent, 'position') != "absolute")
          {
            theSearchbox.offsetParent.style.position = 'relative';
          }
          theDropDown.style.position = 'absolute';
          theDropDown.style.left = (theSearchbox.offsetLeft) + 'px';
          theDropDown.style.top = (theSearchbox.offsetTop + theSearchbox.offsetHeight) + 'px';
          if ( theSearchbox.clientWidth < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
          {
            theDropDown.style.width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
          }
          else
          {
            theDropDown.style.width = (theSearchbox.clientWidth) + 'px';
          }
          theDropDown.style.visibility = 'hidden';
          theDropDown.style.zIndex     = '99999999';
        }
        else
        {
            theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        

        __AutoComplete[id]['dropdown'] = theDropDown;
        __SLI_width = width;
    }

    function /* array [ left, top ] */ AutoComplete_getPos( obj )
    {
        var curleft = curtop = 0;
        var sli_flag = 0;

        if (obj.offsetParent)
        {
           do
           {
              if ( __SLI_customisations[ __SLI_ApplicationName ][ 'AlignmentBorderBug' ] )
              {         
                
                if(sli_flag == 1)
                {
                    var clientTop = (obj.offsetHeight - obj.clientHeight) / 2;
                    curtop += clientTop;

                    var clientLeft = (obj.offsetWidth - obj.clientWidth) / 2;
                    curleft += clientLeft;
                }
                sli_flag = 1;
              }
           
              curleft += obj.offsetLeft;
              curtop += obj.offsetTop;
           }
           while (obj = obj.offsetParent);
        }
        return [curleft,curtop];
    }

    /**
    * Shows the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ShowDropdown(id)
    {

        AutoComplete_HideAll();



        var value = __AutoComplete[id]['element'].value;
        var toDisplay = new Array();
        var newDiv    = null;
        var text      = null;
        var numItems  = __AutoComplete[id]['dropdown'].childNodes.length;

        __AutoComplete_mouseMoved=false;
        // SLI Code Modification - Start - Andrew Grieve April 08
        // Trim the textbox so that if is starts with a space then the feature will still work
        //value = value.replace(/^\s+|\s+$/g,"");
        value = value.replace(/^\s+/g,"");

        if(value.length == "")
        {
            // If Textbox length is nothing (after the trim) then don't show dropdown.
            return;
        }
        // SLI Code Modification - End

        // Remove all child nodes from dropdown
        while (__AutoComplete[id]['dropdown'].childNodes.length > 0) {
            __AutoComplete[id]['dropdown'].removeChild(__AutoComplete[id]['dropdown'].childNodes[0]);
        }


        var count=0;
        // Go thru data searching for matches
        for (i=0; i<__AutoComplete[id]['data'].length; ++i)
        {
            // SLI Code Modification - Start - Andrew Grieve April 08 - Added lower casing
            if (__AutoComplete[id]['data'][i].substr(0, value.length).toLowerCase() == value.toLowerCase())
            {
                // SLI Code Modification - End
                toDisplay[toDisplay.length] = __AutoComplete[id]['data'][i];
                count++;
                /* how many to display? */
                if(count == __SLI_customisations['AutoSuggest']['MaxListItems'] ) /* Code inserted to keep list to a maximum of 10 values (was 20 or 30) */
                {
                    break;
                }
            }
        }

        // No matches?
        if (toDisplay.length == 0) {
            AutoComplete_HideDropdown(id);
            return;
        }



        // Add data to the dropdown layer
        for (i=0; i<toDisplay.length; ++i) {
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_item'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';

             // Scrollbars are on display ?
            if (toDisplay.length > __AutoComplete[id]['maxitems'] && navigator.userAgent.indexOf('MSIE') == -1) {
                newDiv.style.width = __AutoComplete[id]['element'].offsetWidth - 22 + 'px';
            }

            newDiv.onmouseover =
        function()
        {
            if( __AutoComplete_mouseMoved )
                AutoComplete_HighlightItem(__AutoComplete[id]['element'].getAttribute('id'), this.getAttribute('index'));
        };

            newDiv.onclick     =    function()
                                    {
                                    	  __SLI_asug_used_flag = true;
                                                                           
                                        AutoComplete_SetValue(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_HideDropdown(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_submitForm(id);
                                    }



            text   = document.createTextNode(toDisplay[i]);
            newDiv.appendChild(text);
            newDiv.title='Search for ' + toDisplay[i];

            /* ellipsis for IE only */
            if( isIE )
            {
                newDiv.style.textOverflow = 'ellipsis';
                newDiv.style.width = '100%';
                newDiv.style.whiteSpace = 'nowrap';
                newDiv.style.overflow = 'hidden';

            }
            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }
        /*
         * append DIV containing footer branding...
         */
        if(__SLI_customisations['AutoSuggest']['ShowBrandingFooter'])
        {
            i = toDisplay.length;
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_footer'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';
            newDiv.innerHTML = '<a href="http://www.sli-systems.com/powered-by.php" title="' +
                                __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterTitleTooltip' ] +
                                '"><img class="autocomplete_footer_branding" src="'+__AutoCompleteBranding.src+'" /></a>';

            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }


        // Too many items?
        if (toDisplay.length > __AutoComplete[id]['maxitems']) {
            __AutoComplete[id]['dropdown'].style.height = (__AutoComplete[id]['maxitems'] * 15) + 2 + 'px';

        } else {
            __AutoComplete[id]['dropdown'].style.height = '';
        }


        /**
        * Set left/top in case of document movement/scroll/window resize etc
        */
        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "true" || __SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "false")
        {
            var left_top = AutoComplete_getPos( __AutoComplete[id]['element'] );
            __AutoComplete[id]['dropdown'].style.left = left_top[0];
            __AutoComplete[id]['dropdown'].style.top  = left_top[1] + __AutoComplete[id]['element'].offsetHeight;
        }


        // Show the iframe for IE
        if (isIE) {
            
            if(!__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true)
            {
               __AutoComplete[id]['iframe'].style.width  = __AutoComplete[id]['dropdown'].offsetWidth;
            }
            
            
            __AutoComplete[id]['iframe'].style.top    = __AutoComplete[id]['dropdown'].style.top;
            __AutoComplete[id]['iframe'].style.left   = __AutoComplete[id]['dropdown'].style.left;
            __AutoComplete[id]['iframe'].style.height = __AutoComplete[id]['dropdown'].offsetHeight;

            __AutoComplete[id]['iframe'].style.visibility = 'visible';
        }

    e =  __AutoComplete[id]['dropdown'];

    e.onmousemove =
        function()
        {
            if(!__AutoComplete_mouseMoved){__AutoComplete_mouseMoved=true;}
            this.onmousemove = null;
        }

        // Show dropdown
        if (!__AutoComplete[id]['isVisible']) {
            __AutoComplete[id]['dropdown'].style.visibility = 'visible';
            __AutoComplete[id]['isVisible'] = true;
        }


        // If now showing less items than before, reset the highlighted value
        if (__AutoComplete[id]['dropdown'].childNodes.length != numItems) {
            __AutoComplete[id]['highlighted'] = null;
        }
    }



    /**
    * Hides the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_HideDropdown(id)
    {
        if (__AutoComplete[id]['iframe'])
        {
            __AutoComplete[id]['iframe'].style.visibility = 'hidden';
        }
        
        if (__AutoComplete[id]['dropdown'])
        {
            __AutoComplete[id]['dropdown'].style.visibility = 'hidden';
        }

        __AutoComplete[id]['highlighted'] = null;
        __AutoComplete[id]['isVisible']   = false;
    }


    /**
    * Hides all dropdowns
    */
    function AutoComplete_HideAll()
    {
         if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
         {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
         }
         else
         {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
         }
    }


    /**
    * Highlights a specific item
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_HighlightItem(id, index) // mouseover, index is the list element index, zero-based
    {
        if (__AutoComplete[id]['dropdown'].childNodes[index]) {
            for (var i=0; i<__AutoComplete[id]['dropdown'].childNodes.length; ++i) {
                if (__AutoComplete[id]['dropdown'].childNodes[i].className == 'autocomplete_item_highlighted') {
                    __AutoComplete[id]['dropdown'].childNodes[i].className = 'autocomplete_item';
                }
            }

            __AutoComplete[id]['dropdown'].childNodes[index].className = 'autocomplete_item_highlighted';
            __AutoComplete[id]['highlighted'] = index;

            //also see below...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[index].innerHTML;
            //AutoComplete_SetValue(id);
        }
    }


    /**
    * Highlights the menu item with the given index
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_Highlight(id, index) // keyboard up/down - index is the direction of travel, 1==down,-1=up
    {
        var childNodes = __AutoComplete[id]['dropdown'].childNodes;
        if(childNodes.length)
        {
	        var lastItem = ( ( childNodes[ childNodes.length - 1 ].className != 'autocomplete_footer' ) ? childNodes.length - 1 : childNodes.length - 2 );

            // Out of bounds checking
            //if (index == 1 && __AutoComplete[id]['highlighted'] == __AutoComplete[id]['dropdown'].childNodes.length - 1) {
            if (index == 1 && __AutoComplete[id]['highlighted'] == lastItem ) {
                childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = null;

            } else if (index == -1 && __AutoComplete[id]['highlighted'] == 0) {
                childNodes[0].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = lastItem;
                index = 0;//hack!
            }

            // Nothing highlighted at the moment
            if (__AutoComplete[id]['highlighted'] == null) {

                childNodes[0].className = 'autocomplete_item_highlighted';
                __AutoComplete[id]['highlighted'] = 0;
                newIndex = 0;
                
            } else {

                if (childNodes[__AutoComplete[id]['highlighted']]) {
                
                    childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                }

                var newIndex = parseInt( __AutoComplete[id]['highlighted'] ) + parseInt(index);

                if (childNodes[newIndex]) {

                    childNodes[newIndex].className = 'autocomplete_item_highlighted';

                    __AutoComplete[id]['highlighted'] = newIndex;
                }
            }

            //populate textbox with currently highlighted term...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[newIndex].innerHTML;
            AutoComplete_SetValue(id);
        }
    }


    /**
    * Sets the input to a given value
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_SetValue(id)
    {
        __AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[__AutoComplete[id]['highlighted']].innerHTML.replace(/&amp;/, "&");
    }


    /**
    * Checks if the dropdown needs scrolling
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ScrollCheck(id)
    {
        // Scroll down, or wrapping around from scroll up
        if (__AutoComplete[id]['highlighted'] > __AutoComplete[id]['lastItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'] - (__AutoComplete[id]['maxitems'] - 1);
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'];
        }

        // Scroll up, or wrapping around from scroll down
        if (__AutoComplete[id]['highlighted'] < __AutoComplete[id]['firstItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'];
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'] + (__AutoComplete[id]['maxitems'] - 1);
        }

        __AutoComplete[id]['dropdown'].scrollTop = __AutoComplete[id]['firstItemShowing'] * 15;
    }


    /**
    * Function which handles the keypress event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyDown(id, e)
    {
        var result = true;

       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {

            // Return/Enter
            case 13:
                if (__AutoComplete[id]['highlighted'] != null) {
                    AutoComplete_SetValue(id);
                    AutoComplete_HideDropdown(id);
					
                    __SLI_asug_used_flag = true;
					
                    if( e = __AutoComplete[id]['element'].form['asug'] )
                    {
                        
                        e.disabled=false;
                        e.value = __AutoComplete[id]['asug'];
                    }

                }

                result = AutoComplete_submitForm(id);

                break;

            // Escape
            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            // Up arrow
            case 38:
                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, -1);
                AutoComplete_ScrollCheck(id, -1);
                
                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                                
                result = false;
                break;

            // Tab
            case 9:
                if (__AutoComplete[id]['isVisible']) {
                    AutoComplete_HideDropdown(id);
                }
                return;

            // Down arrow
            case 40:

                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, 1);
                //AutoComplete_ScrollCheck(id, 1);

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                result = false;
                break;
        }
        return result;
    }


    /**
    * Function which handles the keyup event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyUp(id, e)
    {
       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {
            case 13:
                event.returnValue = false;
                event.cancelBubble = true;
                
                break;

            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            case 38:
            case 40:
                return false;
                break;

            default:
                AutoComplete_ShowDropdown(id);
                
                __AutoComplete[id]['asug']=__AutoComplete[id]['element'].value;

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=true;
                   e.value = "";
                }  
                
                break;
        }
    }

    /**
    * Function which handles the keypress event
    * This function added April 2008 by Andrew Grieve
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */

    // SLI Code Modification - Start - Andrew Grieve April 08
    function AutoComplete_KeyPress(id, e)
    {
        var event = e;
        if(!event) event = window.event;
        var keyCode = event.keyCode;

        if (keyCode == 13 && isGecko || isOpera)
        {
            return false;
        }
        
        if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
        {
            if (keyCode == 13 && isIE)
            {
                return false;
            }
        }
        
    }
    // SLI Code Modification - End

    /**
    * Returns whether the dropdown is visible
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_isVisible(id)
    {
        return __AutoComplete[id]['dropdown'].style.visibility == 'visible';
    }

    function AutoComplete_submitForm(id)
    {
      var e, f, result=true;
      if( f = __AutoComplete[id]['element'].form )
      {
        if( __AutoComplete[id]['element'].value != '' )
        {
          if(__SLI_asug_used_flag == true)
          {
            if( e = f['asug'])
            {
              e.value = __AutoComplete[id]['asug'];
              e.disabled=false;
            }
          }

          if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
          {
            asugvar = "";
            if(__SLI_asug_used_flag == true)
            {
              asugvar = '&asug=' + escape(__AutoComplete[id]['asug']);
            }

            sliRegex = /resultsdemo\.com/;
            if(sliRegExArray = sliRegex.exec(document.domain))
            {
              sliRegex = /^http:\/\/(.*)\//;
              sliTargetDomain = sliRegex.exec(__SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ]);
              __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ].replace(sliTargetDomain[1], document.domain);
            }

            document.location.href = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] + escape(__AutoComplete[id]['element'].value) + asugvar;
          }
          else
          {
            if(f.onsubmit)
            {
              if(f.onsubmit() !== false)
              {
                f.submit();
              }
            }
            else
            {
              f.submit();
            }
          }

          AutoComplete_HideAll();
        }
        else
          result = false;
      }
      return result;
    }
    
    // get the style that will be applied by the browser, including stylesheets
    function sli_getStyle(el,styleProp)
    {
      if (el.currentStyle)
        var y = el.currentStyle[styleProp];
      else if (window.getComputedStyle)
        var y = document.defaultView.getComputedStyle(el,null).getPropertyValue(styleProp);
      return y;
    }

    // register with onLoad(er...
    _sli_init.push( AutoComplete_init );
    
    function sli_addEvent(obj, evType, fn) {
    	if (obj.addEventListener) {
    		obj.addEventListener(evType, fn, false);
    		return true;
    	} else if (obj.attachEvent) {
    		var r = obj.attachEvent("on" + evType, fn);
    		return r;
    	} else {
    		return false;
    	}
    }
    
    function sli_load()
    {
    	sli_addEvent(window, 'load', sli_init);
    }