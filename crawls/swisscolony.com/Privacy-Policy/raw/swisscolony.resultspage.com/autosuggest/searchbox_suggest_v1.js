/* Popular phrases - SWISSCOLONY - 18:8:13, Fri Mar 15, 2013 */
__SLI_ClientDefaults =
[
    ['Alignment', 'offsetrelative' ],
	['IE6SelectBox', true ],
    ['ShowBrandingFooter', false ],
];
var asPhrases=new Array ('candy','petit fours','easter baskets','easter','ham','sugar free products','cheesecake','cakes','cheese','truffles','fudge','toffee','sugar free','fruit','sale','cheese spreads','cashews','nuts','red velvet','baklava','butter toffee','fruit cake','jelly beans','petit','torte','cake balls','catalog','beef log','easter candy','lemon','birthday','coconut','frog','easter cakes','spring cookies','summer sausage','baskets','wreath','coffee','lemon cheesecake','incredible spreadables','breakfast','cheese cake','swiss cheese','taffy','butterfly','birthday petit fours','fruitcake','pretzels','macadamia nut chocolate','mustard','ladybug','bonbons','pecan','sausage','jelly belly jelly beans','gummi butterflies','peanut brittle','fruit slices','coconut drops','easter gifts','incredible petits fours','brownies','frog chocolates','chocolate','beef jerky','mini butter toffee','cheese slicer','meat sticks','lemon cakes','gluten free products','jelly belly','cheese and sausage','sugar free cookies','monkey backpack','mixed nuts','red velvet petit fours','oranges','pumpkin','ladybug truffles','chihuahua with candy','mint','mini petit fours','careers','toys','personalized','spring petit fours','chocolate petit fours','pillows','frog truffle','florentine lace cookies','gummies','pistachios','shipping','chickadee torte','tiger basket','gluten free','rum balls','hound with candy','bark','beef','throw','red velvet cheesecake','chocolate covered cherries','bread','personalized hoodie zoo animals','zoo basket trio','carrot cake','banana foster bonbons','saltwater taffy','bunny','tea','spring flower tower','spreads','bunny log','easter petits fours','caramel pecan clusters','chocolate truffles','dog with candy','spreadable cheese','petit four flavors','jerky','sticky buns','spreadables','petit fours gift box','petits fours gift','plush','baby swiss','ham\'s','meat','shipping charges','easter cake trio','coconut petits four','cookies in a tin','easter family treats box','peanut butter','fruit spread','dog','spiral ham','sweet hot mustard','lemon petit fours','sugar free jelly bellies','wild game meat sticks','strawberry','spring','trail mix','candy sampler','macadamia nuts','cherries','raspberry','ice cream cake balls','tablet','gummy candy','sausage and cheese bars','caramel','pecan clusters','spring candy','chocolate covered potato chips','licorice','carrot cake balls','colossal breakfast','beef sausage and cheese','dark chocolate','wildflower tower','bridge mix','carrot cake petits fours','sampler','peanut butter and chocolate','crrrisps','kreme kaese cheese','gift of plenty','spicy','baby swiss cheese','log','happy birthday petit fours','easter candy box','ladybug chocolates','zoo animals','sugar free petits fours','hummingbird throw','walkers scottie dog shortbread','macadamia','monkey','coffee sampler','gummy peach rings','hoodie animals','fudge tin','breakfast gifts','candy sampler trio','toffee brickle','jelly belly jelly bean bin','dobosh','strawberry shortcake','giraffe','pancake mix','potato chips','ham and swiss','summer sausage logs','beef and cheese','mint chocolate','mint chocolate chip cheesecake','easter lemon cake','caramel apple cheesecake','lace cookies','cocktail jelly belly petit fours','hearty breakfast meats','stollen','shipping included petit fours','happy birthday','red velvet cake','27 favorites','petit fours and bonbons','pancakes','rocky road swirl cake','hoodie zoo animal','cheese dips','jewelry','spiral','cheddar','pralines','baklava squares','valentines','strawberry daiquiri cheesecake','vintage cheddar cheese','mixed nuts tins','spring fruit gel slices','bananas foster','easter nibbles basket','beef sticks','dobosh torte','blueberry pecan cookies','butter brickle toffee','bee','pumpkin bark','brittle','jalapeno beef log','grapefruit','chihuahua','forest friends log','licorice tin','bunny tortes','strawberry fudge','chocolate nuts','towers','stuffed animals','easter splash basket','chips','chris mouse','cookies and creme','fruit gels','orange dreamsicle cake','strawberry petit fours','extra smokey beef log','shipping chart','shortbread','raspberry swirl cake','divinity','garden vegetable wheel','jelly belly bin','tropical petit fours','milk chocolate','personalized easter','chocolate fudge','chocolate cake','mint torte','jelly belly petits fours','valencias','gourmet brownies','banana split petite fours','pies','lemon log','scottie','spiral sliced ham with fired-in sugar glaze','log cake','christmas fruit cake','chocolate bunny','eggs','favorite five sausages','strawberry cake','roll','cheddar cheese','bunny salt and pepper shakers','mothers day','butterfly throw','apple pie','chocolate covered macadamia nuts','summer','sugar free peanut brittle','butterfly chocolates','port wine','personalize hoodie zoo','sugar free cheesecake','monster cake balls','jam','games','birthday gifts','pets','holiday blend coffee','personalized petit fours','oatmeal pumpkin cookies','flock of sweet chicks','meltaway wacky bugs','sugar free cheese cake','vanilla petits fours','jumbos','tool set','tiger','crystal pen','friendship plate','mouse','coconut cake','seafood','cheese log','crrrrisps','dog bed','apply for credit','cake rolls','chocolate toffee','baby','chocolate layered mints','apple','pistachios-tin','gel slices','cheddar spread','zoo chocolates','bacon','gift sampler','maple','plush bunnies','tea pot','chocolate pecan','almonds','little lemon pies','orange cake','brickle','banana','kreme kaese','spiral sliced ham','chick','32 snack','tin','raccoon cake','sandscape','zoo','fudge assortment','peanut','boneless ham and baby swiss','mini cookie bites','26 holiday favorites','spiced pumpkins','bakery','gummy fish','watches','animal','glazed ham','wildflower wreath','jalapeno','cheese cake morsels','easter basket floral','smores barks','jumbo cashews','ham and bacon','petite mints','sugar free brownies','favorite five','sugar free macadamia','old fashioned fudge trio','breakfast box','bavarian bonbons','gift boxes','wildlife bottle opener','spring chocolates','malt','lion','precious moments','72 mini all occasion petit fours','liqueur truffles','lobster dip','jelly bean tin','cheese and sausage gift','royal chocolate petits fours','chocolate torte','mini-butter-toffee','ham and cheese','deep dish apple pie','strawberry tea service','seafood incredible spreadables gift of 5','bee and flower','personalized fudge egg','belts','maple sugar','angel treasure chest','raccoon log','order','haystacks','easter boxes','cross watch','elephant','lemon pies','macadamia chocolates','stick','marshmallow','walnut cookies','conversation cakelet','fudge egg','black licorice','usb','stone ground mustard','recipes','bouquet','almond crunch','sausage gift','smokey beef log','personalized mini easter petits fours','grandmother','mellocremes','dutch apple cake','spring fruit slices','mustard trio','swiss chees','sugar free mints','crrrisps and spreads','treasure chest','trio','spring tower','liqueur','mini cookies','fruity cheese','birthday brownie','boneless spiral sliced ham','carrot','fish','owl','country favorites','easter bunny treasure basket','pecan praline','shelled pistachios','all occasion petits fours','easter towers','chocolate chip cookies gluten free','calories','port wine cheese','sugar free gluten free','bonbons fours','blanket set','gluten free cheese cake','salt and pepper','easter bunny treasure','mini fridge','no sugar added trail mix','peppermint candy','dream catcher','blue','bbq tool','cheddar and port','jelly bean assortment','cracker assortment','chickadee easter basket','personalized mini','easter petit','garlic butter','crack','clusters','spring bridge mix','personized zoo animals','box towers','hot mustard','cream cheese spreads','box of chocolates','butter toffee crunch','gift baskets','chocolate potato chips','cajun beef sticks','strawberry cheesecake','sausage assortment','cross','peach rings','chocolate potato','coffee cake','cherry cordials','mint cheesecake','walkers','11 piece personalized bbq tool set','chocolate candy','lemon cheese cake','caramel clusters','tea cakes','bison sticks','tiger and hoodie','ice cream balls','sugar-free cheesecake','gifts for him','alarm clock','milk chocolate butter toffee','candy boxes','brownie cake','mini easter petits fours','cake slices','pearl','happy','apple cake','chocolate easter card','spring brownies','gift certificate','pineapple cake','big red and swiss','dips','apple pancake mix','caramel apple pie','cocktail jelly belly','mini toffee','chocolate strawberries','garlic cheese','sausage and cheese box','dark chocolate truffles','strawberry teapot','swiss','hot cajun beef sticks','vintage cheddar','fruit and nut delights','critter treat totes','french onion','wisconsin cheddar spreads','story stix','sugar free cherries','meat stick bonanza','socks','hummingbird','fruit cheese','hunting','wisconsin cheddar','easter splash','fruitful delight','smoked bacon','candy tins','easter eggs','muenster cheese','angel pendant','blue cheese','peanut butter bites','fudge trio','linzer cookies','mint chocolate cheesecake','art','fours','canadian bacon','caramel pecan swirl','tarts','radio','mellow cheddar cheese spread','colby','sound','tea bags','swiss cake','bottle opener','blueberry','sharp cheese','lily','florentine lace','pepperoni','honey ham','bison','ham and swiss cheese','crab delight','strawberry lemon','honey glazed ham','chocolate covered nuts','apple cinnamon pancake mix','chocolate caramel and pecans','wax','gluten free almond','lemon bites','easter card','pumpkin coffee cake','nut chocolate mix','ice cream','spring pretzels','blueberry cheese','bugs','dark truffles','smokey cheddar','cookie cake','ranch','statement','sugar free truffles','venison sticks','elk sticks','garden vegetable','tower of treats','herb garden','lucky irish coin pendant','lapsies','fruity and white cheddars','stretch ring','macadamia nut fruitcake','two tone cross pendant','sugar free gummy fish','chocolate cherries','peanut butter truffles','friends log','edam cheese','fudge pecan','fruit cake cookies','panda','sugar free bread','deluxe mixed nuts','maple syrup','lite beef log','colby cheese','brie','smores','butter brickle','vanilla','ribbon','cheese wax','swirl cake','basket trio','little cakes','peanut butter candy','cajun mix','s\'mores bark','potato stick candies','sugar free cherry cordials','pumpkin cake','oatmeal','stix','the swiss colony chocolate truffles','classic spring chocolates','backpack','candy coated pretzels','jumbo cheese trio','honey','smoked cheddar cheese spread','torte triple','creame de menthe','banana split','smart tablet','lamb','pastel coconut petit fours','coffee bark','cheese and crrrisps','onion cheese','gluten','swiss roll','lemon bark','pecan cheese log','dog pillow','caraway cheese','ham links','almond bark','gloves','pjs','butter pecan fudge','fruitcake cookies','white cheddar cheese','desk','shell','ceramic','double guarantee','valencia oranges','butter stollen','family keepsake ornament','apple cheesecake','puppy dogs','cheese sampler','chocolate petit','lounge','chocolate covered mixed nuts','sunshine','fresh flowers','ship to canada','strawberry shortcake petit fours','dreamsicle','apo gifts','sugar free coconut','chocolate cake balls','cordials','fruit spread sampler','pepper bacon','72 petit fours','muenster','western long sleeve tee','graham','totes','hazelnut','moon','peppermint candy bites','plush candy trio','blueberry cookies','lime petits fours','confetti party bark','9','sixlets','no sugar added bread','tropical','strawberry shortcake cheesecake','ancho chili cake balls','onion dip','monkey backpack candy','meltaways','mini cakes','cheese bars with slicer','new products','sugar free peanut butter','port wine cheese spread','mixed nuts with 50% pistachios','gold','zoo basket','masterpiece baked ham','daisy wreath','hotline to god','western dvd','party','sea salt chocolates','bacon cheese spread','food gifts','jelly cake','spice drops','grill set','garden vegetable dip','pc','apo fpo gifts','chocolate gifts','pumpkin coffee','zigzag','luscious lemon cheesecake','happy easter petit fours','cheese and sausage sampler','brick','nickel','dream','peach candy','send catalog','easter bunny torte','heart cake','savory','green','ham and pancakes','sugar free petit','buns','chocolate hearts','no peanuts','spring petit','valentine tower','birthday brownie cookie','potato sticks','nut fruitcake','lime','mix and match','pastel petit fours','no shipping','incredible','personalized chocolate','incredible-spreadables','breakfast and coffee','children','spicy cajun beef sticks','gluten free almond crunch','valentine cake','baby swiss wheel','swiss and cheddar log','light up','lamb plush basket','butter toffe','lap','sentimental','valentines day petit fours','mint chocolate chip','baker cheeses','petit four cake','premium nut','chocolate with pecans','50% off','cocktail','buttery toffee','cheese spread and crackers','gluten free mixes','personalized valentine','sugar free pecan clusters','pepper cheese','soft center','5','custom','mint chocolate torte','morsels','can','beans','bright eyes','sugar-free petite fours','swiss cheese spread','pick and choose','chocolate friend log','stargazer lily','pick n choose','sugar free fours','chocolate bites','stargazer','cheddar cheese spread','chocolate butter toffee','filled cookies','smiling monkeys','roast','cutting','my','creamy cheddar','hot','sugar free candy tin','cheddar cheese spreadable','wild meat sticks','apple cinnamon pancake','pans','bacon cheddar','favorite five tortes','bread mix','buffalo nickel dream catcher pendant','valentine fudge','chocolate heart cake','big baby','cashews almonds pecans brazils and filberts','bacon cheddar spread','filbert','peanut clusters','wireless','chees board','creme torte','lucky irish pendant','pepper seasoned bacon','sweet sausage','shipping to apo','l','mint-chocolate-torte','gluten free cheese','mild jalapeno','maple links','spiral sliced ham with fired in sugar glaze','spinach supreme','sharp','deluxe','chocolate raisins','when will it be shipped','bacon log','smile','personalized animals','sugar free chocolate pecan fudge','smiley','fresh oranges','chocolate fudge petit four','chocolate bars','triple chocolate torte','swiss and ham cheese spread','orange bread','cheese ingredients','brazil','maple flavored ham links','spiral-sliced-ham','sugar free sale','11 piece bbq set','covered macadamia nuts','strawberry daiquiri','breakfast breads','trio of classic candy samplers','bacon cheese log','chocolatey potato chips','phone to god','sausages n cheese bars gift of 9','chris card','stone','sweet basket','chocolate with nuts','special delivery','filbert creme','fruity','sugar free tower','big logs','chocolate nut tin','mixed nuts 50 pistachio','chocolate torte cake','boneless-ham','marble board slicer','petit f','salted nuts','sweet and hot spreadables','five','serving','sugar free holiday tower','santa jellies','send a gift','crab spread','maple ham','sugar free merry christmas petits fours','petit ours','merry','chocolate buttons','spinach','boneless smoked ham','cheese sausage mustard','bone ham','mint dobosh torte','glaze','six','mixed chocolates','candy slices','front five','merry christmas petit','cheese sausage torte gift samplers','cheese-cake','chris mouse pleaser','gift of 7','shoe shine kit','petit four gift samplers','cheese trio','two sweet','mini gift boxes','chocolate lovers','cheese sausage torte','forest cake','beef log gift of 6','maple sausage','pers giraffe hoodie','chees spread','mini butter toffe','chocolate cookies','cheddar logs','silver','sausage and chees','sau','mouse cards','petit four tree','must','sweet bread','bars in logs','forest log','trio candy','genuine buffalo nickel dream catcher pendant','bacon smoked cheese spread','chocolate raspberry jellies','cheese sets','six gift sampler','custard','the big ones','big baby swiss','cheese sausage and petit fours','chocolate mint cake','sausage and petit fours','cheese gift box','port wine cheese logs','bacon cheddar cheese spread','pj s','bu','pers pet carrier','cut rock','sugar free christmas','sugar free pecan','swiss colony beef log','chocolate christmas mouse','chocolate trio','sausage and cheese tower','small tin','fired in ham','projector alarm clock','colossal','merry christmas chocolate','medley','case','chocolate grahams','masterpiece','crab cheese','chocolate covered cake','butter-toffee','chocolate bonbons','fruit nut breads and cremes gift of 7','swiss and sausage','sugar free fish','take five','sale postpaid','premium','gift of 72 petit fours','bible phone','cheese and fruit gifts','by christmas','#2 cheeses','personalized pet carrier','cheese box','sugar glazed ham','sugar free slices','chocolate tower','lucky irish','chocolate raccoon','baby swiss postpaid','swiss colony 27','temperature','sugar free gummies','shrimp cheese','holiday cakes','special blend coffee','sausage n cheese bars gift of 8','port wine with almonds','two hams','box summer sausage','carees','beef mustard','chocolate and mint logs','horatio','pers angel throw','food assortments','snack size','front','game meat','hole punch','gift of 4 cheese and sausage','bone','cover','strawberry galettes','sugar free nuts','lil petites','sausage and candy','nut trio','guardian treasure chest','coated pretzels','favorite fives cheese','hand decorated holiday cookies','filled','spiral glazed ham','sugar free vanilla cheesecake','soaring eagle fleece','old fashion toffee','chocolate p','triple chocolate','old cookies','gel candy','beef log food gift combo','hugger','coin pendant','butter truffles','petit fours sugar','chocolate-filled straws','wrapped boxes','sugar free raspberry','decorated cookies');
/* $Revision: 6883 $
 *
 */

if(typeof(_sli_init )!='object'){var _sli_init=new Array();}
if(typeof(sli_init )!='function'){function sli_init(){ for(var x=0;x<_sli_init.length;x++) _sli_init[x]();}}
if(typeof(asPhrases)!='object'){ var asPhrases = new Array(); }
if(typeof(__SLI_customisations)!='object'){var __SLI_customisations = new Object();}
if(typeof(__SLI_ClientDefaults)!='object'){ var __SLI_ClientDefaults=[]; }
if(typeof(__SLI_validSearchBoxes)!='object'){ var __SLI_validSearchBoxes = new Array(); }
if(typeof(__SLI_asug_used_flag)!='object'){ var __SLI_asug_used_flag = false; }
if(typeof(__SLI_width)!='object'){ var __SLI_width = 0; }
if(typeof(sli_targeturl)!='object'){ var sli_targeturl = ""; }


    __AutoComplete = new Object(); //namespace...
    __AutoComplete_mouseMoved=false;

    // Basic UA detection
    isIE = document.all ? true : false;
    isGecko = navigator.userAgent.toLowerCase().indexOf('gecko') != -1;
    isOpera = navigator.userAgent.toLowerCase().indexOf('opera') != -1;

    /* defaults and options */

    var __SLI_ApplicationName = 'AutoSuggest';
        __SLI_customisations[ 'AutoSuggest' ] =
                {
                    'ShowBrandingFooter' : true
                    ,
                    'TextBoxIDPrefix' : 'sli_search_'
                    ,
                    'BrandingFooterImagePath' : 'http://assets.resultspage.com/autosuggest/sli_systems-powered_150_15.gif'
                    ,
                    'BrandingFooterTitleTooltip' : 'AutoSuggest Powered by SLI Systems'
                    ,
                    'DropListMinWidth' : 150
                    ,
                    'MaxListItems' : 10
                    ,
                    'Alignment' : true
                    ,
                    'TextBoxIDCustom' : []
                    ,
                    'ValidSearchBoxes' : false 
                    ,
                    'IE6SelectBox' : false 
                    ,
                    'IE6SelectBoxPadding' : 0
                    ,
                    'TargetURL' : ''
                    ,
                    'IframeAlignment' : false
                    ,
                    'AlignmentBorderBug' : false
                    ,
                    'IE6OnFocus' : false
                };
    /* 0 = keyname, 1 = value */
    for( defaultValuePair in __SLI_ClientDefaults )
    {
        __SLI_customisations[__SLI_ApplicationName][__SLI_ClientDefaults[defaultValuePair][0]]=__SLI_ClientDefaults[defaultValuePair][1];
    }

    /* pre-fetch branding footer image if being used...
     */
    if( __SLI_customisations[ __SLI_ApplicationName ][ 'ShowBrandingFooter' ] )
    {
        
        if(location.protocol == "https:")
        {
            __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ] = __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ].replace(/http:/i, 'https:');
        }
    
        var __AutoCompleteBranding = new Image();
        __AutoCompleteBranding.src=__SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ];
    }


    function AutoComplete_init()
    {
        if(!isOpera)
        {
            var oldonresize=function(){};
            if(typeof(window.onresize)=='function')
                oldonresize = window.onresize;//play nicely with other people's toys
            window.onresize= function(){ oldonresize(); AutoComplete_HideAll(); AutoComplete_Create( asPhrases ); }

            AutoComplete_Create( asPhrases );
            
            var els = document.getElementsByTagName('input');
            if(els)
            {
               for ( i = 0; i < els.length; i++ )
               {
                  if(els[i].name == "asug")
                  {
                     els[i].disabled = true;
                  }
               }
            }
        }
    }




    /**
    * Attachs the autocomplete object to a form element. Sets
    * onkeypress event on the form element.
    *
    * @param string formElement Name of form element to attach to
    * @param array  data        Array of strings of which to use as the autocomplete data
    */
    //function AutoComplete_Create (id, data)
    /*
     * iterate over 'sli_search_*' assumes one or more search boxes numbered from 1...
    */
    function AutoComplete_Create( data )
    {
        var idx=1, e, id, searchBoxPrefix=__SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDPrefix' ];
        while( e = document.getElementById(searchBoxPrefix+idx) )
        {
            AutoComplete_AttachHandlers(e, data);
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
                __SLI_validSearchBoxes.push(searchBoxPrefix+idx);
            }
            idx++;
        }
        
        
        //this array comes from the customised list
        var otherTextBoxIdList = __SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDCustom' ];
        if( otherTextBoxIdList)
        {
            for(idx=0;idx<otherTextBoxIdList.length;idx++)
            {
                e = document.getElementById(otherTextBoxIdList[idx]);
                if(e)
				{
					if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
                	{
	                    __SLI_validSearchBoxes.push( otherTextBoxIdList[idx] );
                	}
					AutoComplete_AttachHandlers(e, data);
				}
            }
        }
        
    } 

    function AutoComplete_AttachHandlers(e, data){
        var iframe,id;
        id=e.id;


        __AutoComplete[id] = {'data':data,
                              'isVisible':false,
                              'element':document.getElementById(id),
                              'dropdown':null,
                              'highlighted':null};

        __AutoComplete[id]['element'].setAttribute('autocomplete', 'off');
        __AutoComplete[id]['element'].onkeydown = function(e) {if (!e) e = window.event; return AutoComplete_KeyDown(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onkeyup = function(e) {if (!e) e = window.event; return AutoComplete_KeyUp(this.getAttribute('id'), e);}
        // The function call on the next line was changed by Andrew Grieve April 2008
        __AutoComplete[id]['element'].onkeypress = function(e) {if (!e) e = window.event; return AutoComplete_KeyPress(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onclick = function(e)
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6OnFocus' ] )
            {
                __AutoComplete[id]['element'].focus();
            }
            if (!e) e = window.event; e.cancelBubble = true; e.returnValue = false;
        }



        // Hides the dropdowns when document clicked
        var docClick = function()
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
            }
            else
            {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
            }
        }

        if (document.addEventListener) {
            document.addEventListener('click', docClick, false);
        } else if (document.attachEvent) {
            document.attachEvent('onclick', docClick, false);
        }


        // Max number of items shown at once
        if (arguments[2] != null) {
            __AutoComplete[id]['maxitems'] = arguments[2];
            __AutoComplete[id]['firstItemShowing'] = 0;
            __AutoComplete[id]['lastItemShowing'] = arguments[2] - 1;
        }

        AutoComplete_CreateDropdown(id);

        // Prevent select dropdowns showing thru
        if (isIE) {
            iframe = document.createElement('iframe');
            __AutoComplete[id]['iframe'] = iframe;
                iframe.id = id +'_iframe';
                iframe.style.position = 'absolute';
                iframe.style.top = '0';
                iframe.style.left = '0';
                iframe.style.width = '0px';
                iframe.style.height = '0px';
                iframe.style.zIndex = '98';
                iframe.style.visibility = 'hidden';
                
                if(location.protocol == "https:")
                {
                   iframe.src = 'https://assets.resultspage.com/autosuggest/blank.html';
                }
                
                if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBox' ] )
                {
                  iframe.style.width = __SLI_width  + __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBoxPadding'];
                }

            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IframeAlignment' ] )
            {
                document.body.insertBefore( iframe );
            }
            else
            {
                __AutoComplete[id]['element'].parentNode.insertBefore( iframe, __AutoComplete[id]['element'] );
            }
        }
    }

    /**
    * Creates the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_CreateDropdown(id)
    {
        var theSearchbox = __AutoComplete[id]['element'];
        var theDropDown;
        var left_top = AutoComplete_getPos( theSearchbox );
        var left  = left_top[0];
        var top   = left_top[1] + theSearchbox.offsetHeight;
        var width = theSearchbox.offsetWidth;

        if ( width < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
        {
            width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
        }

        theDropDown = document.createElement('div');
        theDropDown.className = 'autocomplete'; // Don't use setAttribute()


        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true && document.body)
        {
            theDropDown.style.position = 'absolute';
            document.body.insertBefore(theDropDown, document.body.nextSibling);
            
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        else if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "offsetrelative" && document.body)
        {
          theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
          // Position it
          if(sli_getStyle(theSearchbox.offsetParent, 'position') != "absolute")
          {
            theSearchbox.offsetParent.style.position = 'relative';
          }
          theDropDown.style.position = 'absolute';
          theDropDown.style.left = (theSearchbox.offsetLeft) + 'px';
          theDropDown.style.top = (theSearchbox.offsetTop + theSearchbox.offsetHeight) + 'px';
          if ( theSearchbox.clientWidth < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
          {
            theDropDown.style.width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
          }
          else
          {
            theDropDown.style.width = (theSearchbox.clientWidth) + 'px';
          }
          theDropDown.style.visibility = 'hidden';
          theDropDown.style.zIndex     = '99999999';
        }
        else
        {
            theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        

        __AutoComplete[id]['dropdown'] = theDropDown;
        __SLI_width = width;
    }

    function /* array [ left, top ] */ AutoComplete_getPos( obj )
    {
        var curleft = curtop = 0;
        var sli_flag = 0;

        if (obj.offsetParent)
        {
           do
           {
              if ( __SLI_customisations[ __SLI_ApplicationName ][ 'AlignmentBorderBug' ] )
              {         
                
                if(sli_flag == 1)
                {
                    var clientTop = (obj.offsetHeight - obj.clientHeight) / 2;
                    curtop += clientTop;

                    var clientLeft = (obj.offsetWidth - obj.clientWidth) / 2;
                    curleft += clientLeft;
                }
                sli_flag = 1;
              }
           
              curleft += obj.offsetLeft;
              curtop += obj.offsetTop;
           }
           while (obj = obj.offsetParent);
        }
        return [curleft,curtop];
    }

    /**
    * Shows the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ShowDropdown(id)
    {

        AutoComplete_HideAll();



        var value = __AutoComplete[id]['element'].value;
        var toDisplay = new Array();
        var newDiv    = null;
        var text      = null;
        var numItems  = __AutoComplete[id]['dropdown'].childNodes.length;

        __AutoComplete_mouseMoved=false;
        // SLI Code Modification - Start - Andrew Grieve April 08
        // Trim the textbox so that if is starts with a space then the feature will still work
        //value = value.replace(/^\s+|\s+$/g,"");
        value = value.replace(/^\s+/g,"");

        if(value.length == "")
        {
            // If Textbox length is nothing (after the trim) then don't show dropdown.
            return;
        }
        // SLI Code Modification - End

        // Remove all child nodes from dropdown
        while (__AutoComplete[id]['dropdown'].childNodes.length > 0) {
            __AutoComplete[id]['dropdown'].removeChild(__AutoComplete[id]['dropdown'].childNodes[0]);
        }


        var count=0;
        // Go thru data searching for matches
        for (i=0; i<__AutoComplete[id]['data'].length; ++i)
        {
            // SLI Code Modification - Start - Andrew Grieve April 08 - Added lower casing
            if (__AutoComplete[id]['data'][i].substr(0, value.length).toLowerCase() == value.toLowerCase())
            {
                // SLI Code Modification - End
                toDisplay[toDisplay.length] = __AutoComplete[id]['data'][i];
                count++;
                /* how many to display? */
                if(count == __SLI_customisations['AutoSuggest']['MaxListItems'] ) /* Code inserted to keep list to a maximum of 10 values (was 20 or 30) */
                {
                    break;
                }
            }
        }

        // No matches?
        if (toDisplay.length == 0) {
            AutoComplete_HideDropdown(id);
            return;
        }



        // Add data to the dropdown layer
        for (i=0; i<toDisplay.length; ++i) {
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_item'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';

             // Scrollbars are on display ?
            if (toDisplay.length > __AutoComplete[id]['maxitems'] && navigator.userAgent.indexOf('MSIE') == -1) {
                newDiv.style.width = __AutoComplete[id]['element'].offsetWidth - 22 + 'px';
            }

            newDiv.onmouseover =
        function()
        {
            if( __AutoComplete_mouseMoved )
                AutoComplete_HighlightItem(__AutoComplete[id]['element'].getAttribute('id'), this.getAttribute('index'));
        };

            newDiv.onclick     =    function()
                                    {
                                    	  __SLI_asug_used_flag = true;
                                                                           
                                        AutoComplete_SetValue(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_HideDropdown(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_submitForm(id);
                                    }



            text   = document.createTextNode(toDisplay[i]);
            newDiv.appendChild(text);
            newDiv.title='Search for ' + toDisplay[i];

            /* ellipsis for IE only */
            if( isIE )
            {
                newDiv.style.textOverflow = 'ellipsis';
                newDiv.style.width = '100%';
                newDiv.style.whiteSpace = 'nowrap';
                newDiv.style.overflow = 'hidden';

            }
            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }
        /*
         * append DIV containing footer branding...
         */
        if(__SLI_customisations['AutoSuggest']['ShowBrandingFooter'])
        {
            i = toDisplay.length;
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_footer'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';
            newDiv.innerHTML = '<a href="http://www.sli-systems.com/powered-by.php" title="' +
                                __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterTitleTooltip' ] +
                                '"><img class="autocomplete_footer_branding" src="'+__AutoCompleteBranding.src+'" /></a>';

            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }


        // Too many items?
        if (toDisplay.length > __AutoComplete[id]['maxitems']) {
            __AutoComplete[id]['dropdown'].style.height = (__AutoComplete[id]['maxitems'] * 15) + 2 + 'px';

        } else {
            __AutoComplete[id]['dropdown'].style.height = '';
        }


        /**
        * Set left/top in case of document movement/scroll/window resize etc
        */
        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "true" || __SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "false")
        {
            var left_top = AutoComplete_getPos( __AutoComplete[id]['element'] );
            __AutoComplete[id]['dropdown'].style.left = left_top[0];
            __AutoComplete[id]['dropdown'].style.top  = left_top[1] + __AutoComplete[id]['element'].offsetHeight;
        }


        // Show the iframe for IE
        if (isIE) {
            
            if(!__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true)
            {
               __AutoComplete[id]['iframe'].style.width  = __AutoComplete[id]['dropdown'].offsetWidth;
            }
            
            
            __AutoComplete[id]['iframe'].style.top    = __AutoComplete[id]['dropdown'].style.top;
            __AutoComplete[id]['iframe'].style.left   = __AutoComplete[id]['dropdown'].style.left;
            __AutoComplete[id]['iframe'].style.height = __AutoComplete[id]['dropdown'].offsetHeight;

            __AutoComplete[id]['iframe'].style.visibility = 'visible';
        }

    e =  __AutoComplete[id]['dropdown'];

    e.onmousemove =
        function()
        {
            if(!__AutoComplete_mouseMoved){__AutoComplete_mouseMoved=true;}
            this.onmousemove = null;
        }

        // Show dropdown
        if (!__AutoComplete[id]['isVisible']) {
            __AutoComplete[id]['dropdown'].style.visibility = 'visible';
            __AutoComplete[id]['isVisible'] = true;
        }


        // If now showing less items than before, reset the highlighted value
        if (__AutoComplete[id]['dropdown'].childNodes.length != numItems) {
            __AutoComplete[id]['highlighted'] = null;
        }
    }



    /**
    * Hides the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_HideDropdown(id)
    {
        if (__AutoComplete[id]['iframe'])
        {
            __AutoComplete[id]['iframe'].style.visibility = 'hidden';
        }
        
        if (__AutoComplete[id]['dropdown'])
        {
            __AutoComplete[id]['dropdown'].style.visibility = 'hidden';
        }

        __AutoComplete[id]['highlighted'] = null;
        __AutoComplete[id]['isVisible']   = false;
    }


    /**
    * Hides all dropdowns
    */
    function AutoComplete_HideAll()
    {
         if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
         {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
         }
         else
         {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
         }
    }


    /**
    * Highlights a specific item
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_HighlightItem(id, index) // mouseover, index is the list element index, zero-based
    {
        if (__AutoComplete[id]['dropdown'].childNodes[index]) {
            for (var i=0; i<__AutoComplete[id]['dropdown'].childNodes.length; ++i) {
                if (__AutoComplete[id]['dropdown'].childNodes[i].className == 'autocomplete_item_highlighted') {
                    __AutoComplete[id]['dropdown'].childNodes[i].className = 'autocomplete_item';
                }
            }

            __AutoComplete[id]['dropdown'].childNodes[index].className = 'autocomplete_item_highlighted';
            __AutoComplete[id]['highlighted'] = index;

            //also see below...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[index].innerHTML;
            //AutoComplete_SetValue(id);
        }
    }


    /**
    * Highlights the menu item with the given index
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_Highlight(id, index) // keyboard up/down - index is the direction of travel, 1==down,-1=up
    {
        var childNodes = __AutoComplete[id]['dropdown'].childNodes;
        if(childNodes.length)
        {
	        var lastItem = ( ( childNodes[ childNodes.length - 1 ].className != 'autocomplete_footer' ) ? childNodes.length - 1 : childNodes.length - 2 );

            // Out of bounds checking
            //if (index == 1 && __AutoComplete[id]['highlighted'] == __AutoComplete[id]['dropdown'].childNodes.length - 1) {
            if (index == 1 && __AutoComplete[id]['highlighted'] == lastItem ) {
                childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = null;

            } else if (index == -1 && __AutoComplete[id]['highlighted'] == 0) {
                childNodes[0].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = lastItem;
                index = 0;//hack!
            }

            // Nothing highlighted at the moment
            if (__AutoComplete[id]['highlighted'] == null) {

                childNodes[0].className = 'autocomplete_item_highlighted';
                __AutoComplete[id]['highlighted'] = 0;
                newIndex = 0;
                
            } else {

                if (childNodes[__AutoComplete[id]['highlighted']]) {
                
                    childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                }

                var newIndex = parseInt( __AutoComplete[id]['highlighted'] ) + parseInt(index);

                if (childNodes[newIndex]) {

                    childNodes[newIndex].className = 'autocomplete_item_highlighted';

                    __AutoComplete[id]['highlighted'] = newIndex;
                }
            }

            //populate textbox with currently highlighted term...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[newIndex].innerHTML;
            AutoComplete_SetValue(id);
        }
    }


    /**
    * Sets the input to a given value
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_SetValue(id)
    {
        __AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[__AutoComplete[id]['highlighted']].innerHTML.replace(/&amp;/, "&");
    }


    /**
    * Checks if the dropdown needs scrolling
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ScrollCheck(id)
    {
        // Scroll down, or wrapping around from scroll up
        if (__AutoComplete[id]['highlighted'] > __AutoComplete[id]['lastItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'] - (__AutoComplete[id]['maxitems'] - 1);
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'];
        }

        // Scroll up, or wrapping around from scroll down
        if (__AutoComplete[id]['highlighted'] < __AutoComplete[id]['firstItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'];
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'] + (__AutoComplete[id]['maxitems'] - 1);
        }

        __AutoComplete[id]['dropdown'].scrollTop = __AutoComplete[id]['firstItemShowing'] * 15;
    }


    /**
    * Function which handles the keypress event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyDown(id, e)
    {
        var result = true;

       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {

            // Return/Enter
            case 13:
                if (__AutoComplete[id]['highlighted'] != null) {
                    AutoComplete_SetValue(id);
                    AutoComplete_HideDropdown(id);
					
                    __SLI_asug_used_flag = true;
					
                    if( e = __AutoComplete[id]['element'].form['asug'] )
                    {
                        
                        e.disabled=false;
                        e.value = __AutoComplete[id]['asug'];
                    }

                }

                result = AutoComplete_submitForm(id);

                break;

            // Escape
            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            // Up arrow
            case 38:
                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, -1);
                AutoComplete_ScrollCheck(id, -1);
                
                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                                
                result = false;
                break;

            // Tab
            case 9:
                if (__AutoComplete[id]['isVisible']) {
                    AutoComplete_HideDropdown(id);
                }
                return;

            // Down arrow
            case 40:

                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, 1);
                //AutoComplete_ScrollCheck(id, 1);

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                result = false;
                break;
        }
        return result;
    }


    /**
    * Function which handles the keyup event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyUp(id, e)
    {
       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {
            case 13:
                event.returnValue = false;
                event.cancelBubble = true;
                
                break;

            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            case 38:
            case 40:
                return false;
                break;

            default:
                AutoComplete_ShowDropdown(id);
                
                __AutoComplete[id]['asug']=__AutoComplete[id]['element'].value;

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=true;
                   e.value = "";
                }  
                
                break;
        }
    }

    /**
    * Function which handles the keypress event
    * This function added April 2008 by Andrew Grieve
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */

    // SLI Code Modification - Start - Andrew Grieve April 08
    function AutoComplete_KeyPress(id, e)
    {
        var event = e;
        if(!event) event = window.event;
        var keyCode = event.keyCode;

        if (keyCode == 13 && isGecko || isOpera)
        {
            return false;
        }
        
        if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
        {
            if (keyCode == 13 && isIE)
            {
                return false;
            }
        }
        
    }
    // SLI Code Modification - End

    /**
    * Returns whether the dropdown is visible
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_isVisible(id)
    {
        return __AutoComplete[id]['dropdown'].style.visibility == 'visible';
    }

    function AutoComplete_submitForm(id)
    {
      var e, f, result=true;
      if( f = __AutoComplete[id]['element'].form )
      {
        if( __AutoComplete[id]['element'].value != '' )
        {
          if(__SLI_asug_used_flag == true)
          {
            if( e = f['asug'])
            {
              e.value = __AutoComplete[id]['asug'];
              e.disabled=false;
            }
          }

          if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
          {
            asugvar = "";
            if(__SLI_asug_used_flag == true)
            {
              asugvar = '&asug=' + escape(__AutoComplete[id]['asug']);
            }

            sliRegex = /resultsdemo\.com/;
            if(sliRegExArray = sliRegex.exec(document.domain))
            {
              sliRegex = /^http:\/\/(.*)\//;
              sliTargetDomain = sliRegex.exec(__SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ]);
              __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ].replace(sliTargetDomain[1], document.domain);
            }

            document.location.href = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] + escape(__AutoComplete[id]['element'].value) + asugvar;
          }
          else
          {
            if(f.onsubmit)
            {
              if(f.onsubmit() !== false)
              {
                f.submit();
              }
            }
            else
            {
              f.submit();
            }
          }

          AutoComplete_HideAll();
        }
        else
          result = false;
      }
      return result;
    }
    
    // get the style that will be applied by the browser, including stylesheets
    function sli_getStyle(el,styleProp)
    {
      if (el.currentStyle)
        var y = el.currentStyle[styleProp];
      else if (window.getComputedStyle)
        var y = document.defaultView.getComputedStyle(el,null).getPropertyValue(styleProp);
      return y;
    }

    // register with onLoad(er...
    _sli_init.push( AutoComplete_init );
    
    function sli_addEvent(obj, evType, fn) {
    	if (obj.addEventListener) {
    		obj.addEventListener(evType, fn, false);
    		return true;
    	} else if (obj.attachEvent) {
    		var r = obj.attachEvent("on" + evType, fn);
    		return r;
    	} else {
    		return false;
    	}
    }
    
    function sli_load()
    {
    	sli_addEvent(window, 'load', sli_init);
    }