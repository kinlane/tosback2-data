/* Popular phrases - SWISSCOLONY - 18:17:7, Fri Mar 22, 2013 */
__SLI_ClientDefaults =
[
    ['Alignment', 'offsetrelative' ],
	['IE6SelectBox', true ],
    ['ShowBrandingFooter', false ],
];
var asPhrases=new Array ('candy','petit fours','easter baskets','easter','ham','cheesecake','sugar free products','fudge','cakes','cheese','sugar free','truffles','toffee','nuts','easter gifts','butter toffee','easter candy','fruit','jelly beans','sale','cashews','fruit cake','cheese spreads','baklava','torte','easter cakes','jelly belly','baskets','spring cookies','petit','red velvet','pretzels','incredible spreadables','coconut','careers','cheese cake','breakfast','lemon','summer sausage','birthday','gluten free products','cake balls','coffee','beef log','chocolate','brownies','frog','ham\'s','wreath','beef jerky','fruit slices','fruitcake','red velvet petit fours','carrot cake','coconut petits four','incredible petits fours','lemon cakes','sausage','catalog','taffy','mustard','free shipping','chocolate covered potato chips','bread','cheese slicer','spring petit fours','chihuahua with candy','pecan','peanut butter','popcorn','jelly belly jelly beans','peanut brittle','mini petit fours','lemon cheesecake','ladybug','birthday petit fours','dog','macadamia nut chocolate','bonbons','florentine lace cookies','coconut drops','bark','personalized hoodie zoo animals','butterfly','easter family treats box','banana foster bonbons','sugar free cookies','caramel','rum balls','swiss cheese','personalized','wildflower tower','pumpkin','frog chocolates','bunny','spring flower tower','chocolate truffles','bunny log','pistachios','sugar free petits fours','mint','raspberry swirl cake','tablet','shipping charges','chickadee torte','spiral ham','spreads','ladybug truffles','licorice','chocolate covered cherries','cookies in a tin','zoo basket trio','easter candy box','meat sticks','gummies','easter cake trio','mini butter toffee','carrot cake petits fours','hound with candy','shipping','tea','mixed nuts','candy sampler','log cake','petit fours gift box','dark chocolate','spreadables','gluten free','sugar free jelly bellies','saltwater taffy','cherries','pillows','easter bunnies','macadamia nuts','chocolate fudge','caramel pecan clusters','oranges','beef','jerky','cocktail jelly belly petit fours','plush','throw','sticky buns','baklava squares','monster cake balls','monkey','spreadable cheese','petit four flavors','ice cream cake balls','kreme kaese cheese','hoodie zoo animal','pies','fudge tin','cheese log','red velvet cheesecake','spring candy','mini cakes','mini easter petits fours','sugar free brownies','easter petits fours','sweet hot mustard','toys','sampler','mini toffee','chocolate torte','apple','chocolate petit fours','happy birthday','trail mix','spicy','petits fours gift','dobosh torte','pralines','orange dreamsicle cake','cheese and sausage','monkey backpack','chocolate pecan','strawberry petit fours','bridge mix','gift boxes','wild game meat sticks','walkers scottie dog shortbread','tarts','carrot cake balls','colossal breakfast','baby','lemon petit fours','easter towers','sugar free cheesecake','mint torte','strawberry','animal','dobosh cakes','fudge assortment','macadamia','gummy fish','cheddar','pancakes','candy sampler trio','peanut butter and chocolate','shortbread','spring','sausage and cheese bars','strawberry shortcake','frog truffle','giraffe','banana','petit fours and bonbons','butterfly chocolates','red velvet cake','pecan clusters','personalized easter','stollen','cheese dips','elk sticks','personized zoo animals','chocolate covered macadamia nuts','easter eggs','fruit spread','licorice tin','crrrisps and spreads','towers','fours','raspberry','log','happy birthday petit fours','treasure chest','vintage cheddar cheese','honey glazed ham','butterfly throw','fudge egg','almonds','potato sticks','mint chocolate','plush bunnies','crrrisps','coconut cake','bee','dog with candy','chocolate cake','mint cheesecake','pancake mix','flock of sweet chicks','dutch apple cake','bunny tortes','wildflower wreath','ladybug chocolates','breakfast gifts','caramel apple cheesecake','jam','baby swiss','critter treat totes','pen','summer sausage logs','classic spring chocolates','key lime','toffee brickle','sausage and cheese box','lace cookies','precious moments','coffee cake','brittle','easter family treats gift box','peanut','dobosh','jelly','cocktail jelly','trio','apple cinnamon pancake mix','mint chocolate chip cheesecake','colby cheese','brie','fruit cake cookies','sugarfree','scottie','jalapeno beef log','spring fruit gel slices','bananas foster','tropical','blueberry','strawberry fudge','zoo','valencias','tea cakes','garden vegetable spread','shipping included petit fours','spiral sliced ham with fired-in sugar glaze','beef sticks','chocolate easter card','personalized mini easter petits fours','chocolate nuts','gummy candy','cheddar cheese','backpack','cookies and creme','jelly belly petits fours','tiger','fruitcake cookies','easter nibbles basket','beef sausage and cheese','blueberry pecan cookies','plush animals','strawberry cake','gluten-free','personalized petit fours','meltaway wacky bugs','mothers day','jumbos','tin','lemon log','pet beds','garden vegetable wheel','daisy wreath','chocolate bunny','elephant','cake rolls','wine','chihuahua','gift of plenty','sugar free cheese cake','ham and cheese','baby swiss cheese','tropical petit fours','seafood','raspberry cake','26 holiday favorites','dog bed','petite mints','chocolate toffee','wrapped candy','zoo chocolates','carrot','fish','tea pot','zoo animals','cracker assortment','spring truffles','hummingbird throw','lobster dip','pop','bakery','dips','coffee sampler','spring fruit','gummy peach rings','hoodie animals','fruit and nut delights','spiral sliced ham','chocolate caramel and pecans','strawberry shortcake cheesecake','ham links','bee and flower','box towers','raccoon log','watches','potato chips','jalapeno','ham and swiss','gel slices','beef and cheese','mustard trio','easter lemon cake','pets','candy eggs','cookie cake','venison sticks','port wine cheese','clusters','easter boxes','cross watch','gift baskets','sausage assortment','caramel pecan swirl','easter boxes tower','bridge','27 favorites','bison','rocky road swirl cake','deep dish apple pie','chocolate chip cookies gluten free','bonbons fours','spiral','no sugar added trail mix','personalized mini','teapot','ham and bacon','favorite five','hot mustard','bavarian bonbons','muenster cheese','angel pendant','slices','fruity and white cheddars','valentines','sharp cheese','lily','gift certificate','cheese and sausage gift','mixed nuts tins','walnut cookies','bouquet','candy tins','wheel of cheese','candy boxes','butter brickle toffee','bear','sugar free gummy fish','nut fruitcake','lite beef log','beef summer sausage','basket trio','peanut butter candy','chocolate covered nuts','spring bridge mix','grapefruit','pumpkin coffee cake','swiss almond','forest friends log','candles','cream','mom','sausage and cheese tower','gifts under $20.00','chocolate caramel nuts','sugar free fruitful','seeds','birthday brownie','linzer cookies','brownie cake','cake slices','easter splash basket','chips','chocolate covered pecans','fruit gels','coffee bark','salt and pepper','easter petit','extra smokey beef log','almond bark','chocolate potato chips','shipping chart','walkers','lemon tarts','baked ham','banana bread','french vanilla bonbons','milk chocolate','27','fruit gel slices','chocolate covered','holiday','triple chocolate torte','chocolate strawberries','teriyaki','carrot petit fours','five','petit four gift samplers','white','bee cake','lemon cake roll','strawberry teapot','pepperoni','masterpiece baked ham','honey mustard','angel box','peach cheesecake','banana split petite fours','brick','blueberry cheese','ingredients','brick cheese','christmas fruit cake','slicer','eggs','snowman','favorite five sausages','roll','fresh fruit','breakfast petits','hotline','chocolate cookies','port wine cheese logs','lucky irish coin','easter family','chocolate easter eggs','easter tortes','bunny salt and pepper shakers','florentine','apple pie','summer','assorted petit fours','port wine','personalize hoodie zoo','assortment','telescope','pick and choose','pick n choose','cheese board','holiday blend coffee','lace','pork','gift sets','sweet and hot spreadables','wildflower','marble','liqueur cake','sugar free potato chip','fired in ham','no sugar','reed diffuser','salted caramels','personalized mini birthday petit fours','sugar free chips','pet products','french vanilla','personalized birthday cakes','treat box','mint fudge','all jewelry','sweet chicks','lemon danish cheesecake','oatmeal pumpkin cookies','tool set','crystal pen','friendship plate','mouse','crrrrisps','gingerboy','apple cheese cake','bunny tower','lemon candy','bunny floral basket','apply for credit','chocolate layered mints','pistachios-tin','cheddar spread','gift sampler','maple','bible','little lemon pies','orange cake','brickle','spicy cajun beef sticks','almond petit fours','kreme kaese','chick','32 snack','hound','sugar free peanut butter','sandscape','butter crunch','pastel candy corn','special someone name pendant','32','boneless ham and baby swiss','big logs','lemon petits','accessories','ice cream cake','easter basket lamb plush','flock of chicks','mini cookie bites','spiced pumpkins','glazed ham','cheese cake morsels','pastel petit fours','easter basket floral','incredible','smores barks','jumbo cashews','sugar free fudge','sugar free macadamia','raccoon','breakfast box','box','wildlife bottle opener','spring chocolates','malt','lion','pumpkin cookies','72 mini all occasion petit fours','computer mouse','cheese and nuts','let\'s go fishing set','sugar free cake','lamb cake','white lily','sugar free assorted candy','liqueur truffles','royal chocolate petits fours','mini-butter-toffee','strawberry tea service','seafood incredible spreadables gift of 5','personalized fudge egg','belts','maple sugar','angel treasure chest','order','haystacks','lemon pies','macadamia chocolates','stick','conversation cakelet','black licorice','usb','stone ground mustard','recipes','almond crunch','sausage gift','smokey beef log','grandmother','mellocremes','spring fruit slices','swiss chees','sugar free mints','spring tower','mini cookies','fruity cheese','boneless spiral sliced ham','owl','country favorites','pecan praline','shelled pistachios','all occasion petits fours','sugar free gluten free','blanket set','gluten free cheese cake','mini fridge','peppermint candy','dream catcher','blue','bbq tool','cheddar and port','jelly bean assortment','chickadee easter basket','garlic butter','crack','cream cheese spreads','box of chocolates','cajun beef sticks','peach rings','chocolate potato','11 piece personalized bbq tool set','chocolate candy','lemon cheese cake','caramel clusters','bison sticks','tiger and hoodie','ice cream balls','sugar-free cheesecake','alarm clock','milk chocolate butter toffee','pearl','happy','apple cake','spring brownies','pineapple cake','big red and swiss','apple pancake mix','caramel apple pie','cocktail jelly belly','garlic cheese','dark chocolate truffles','hot cajun beef sticks','vintage cheddar','french onion','wisconsin cheddar spreads','story stix','sugar free cherries','socks','hummingbird','fruit cheese','hunting','wisconsin cheddar','easter splash','smoked bacon','mint chocolate cheesecake','art','mellow cheddar cheese spread','colby','sound','tea bags','swiss cake','bottle opener','florentine lace','ham and swiss cheese','crab delight','strawberry lemon','wax','gluten free almond','lemon bites','easter card','nut chocolate mix','spring pretzels','bugs','dark truffles','smokey cheddar','ranch','sugar free truffles','tower of treats','lucky irish coin pendant','lapsies','stretch ring','macadamia nut fruitcake','two tone cross pendant','friends log','edam cheese','sugar free bread','deluxe mixed nuts','maple syrup','smores','butter brickle','ribbon','cheese wax','swirl cake','little cakes','s\'mores bark','sugar free cherry cordials','stix','the swiss colony chocolate truffles','candy coated pretzels','jumbo cheese trio','honey','easter gift tower','smoked cheddar cheese spread','torte triple','creame de menthe','banana split','smart tablet','pastel coconut petit fours','cheese and crrrisps','onion cheese','gluten','swiss roll','lemon bark','pecan cheese log','dog pillow','caraway cheese','gloves','butter pecan fudge','shell','ceramic','double guarantee','valencia oranges','family keepsake ornament','apple cheesecake','puppy dogs','cheese sampler','chocolate petit','lounge','chocolate covered mixed nuts','sunshine','fresh flowers','ship to canada','strawberry shortcake petit fours','chocolate cake balls','cordials','muenster','western long sleeve tee','graham','totes','moon','lime petits fours','easter gift plush candy trio','9','no sugar added bread','ancho chili cake balls','monkey backpack candy','port wine cheese spread','mixed nuts with 50% pistachios','gold','zoo basket','party','bacon cheese spread','food gifts','jelly cake','spice drops','pc','chocolate gifts','pumpkin coffee','zigzag','luscious lemon cheesecake','cheese and sausage sampler','nickel','dream','peach candy','send catalog','easter bunny torte','heart cake','savory','sugar free petit','buns','chocolate hearts','no peanuts','spring petit','valentine tower','mix and match','no shipping','personalized chocolate','incredible-spreadables','breakfast and coffee','children','gluten free almond crunch','valentine cake','swiss and cheddar log','light up','butter toffe','sentimental','mint chocolate chip','baker cheeses','premium nut','chocolate with pecans','50% off','buttery toffee','cheese spread and crackers','gluten free mixes','personalized valentine','sugar free pecan clusters','pepper cheese','soft center','5','custom','mint chocolate torte','morsels','beans','bright eyes','sugar-free petite fours','swiss cheese spread','chocolate friend log','stargazer lily','sugar free fours','chocolate bites','stargazer','cheddar cheese spread','chocolate butter toffee','filled cookies','smiling monkeys','roast','cutting','my','creamy cheddar','hot','cheddar cheese spreadable','pans','bacon cheddar','favorite five tortes','bread mix','buffalo nickel dream catcher pendant','chocolate heart cake','big baby','bacon cheddar spread','filbert','peanut clusters','wireless','chees board','creme torte','lucky irish pendant','pepper seasoned bacon','sweet sausage','mint-chocolate-torte','gluten free cheese','mild jalapeno','maple links','spiral sliced ham with fired in sugar glaze','spinach supreme','sharp','deluxe','chocolate raisins','when will it be shipped','smile','personalized animals','sugar free chocolate pecan fudge','smiley','fresh oranges','chocolate fudge petit four','swiss and ham cheese spread','orange bread','cheese ingredients','brazil','maple flavored ham links','spiral-sliced-ham','sugar free sale','11 piece bbq set','covered macadamia nuts','strawberry daiquiri','breakfast breads','bacon cheese log','chocolatey potato chips','phone to god','sausages n cheese bars gift of 9','chris card','stone','sweet basket','chocolate with nuts','special delivery','filbert creme','sugar free tower','chocolate nut tin','mixed nuts 50 pistachio','chocolate torte cake','boneless-ham','marble board slicer','petit f','salted nuts','sugar free holiday tower','santa jellies','send a gift','crab spread','maple ham','petit ours','chocolate buttons','spinach','boneless smoked ham','cheese sausage mustard','bone ham','mint dobosh torte','glaze','six','mixed chocolates','front five','merry christmas petit','cheese sausage torte gift samplers','cheese-cake','chris mouse pleaser','gift of 7','shoe shine kit','cheese trio','two sweet','mini gift boxes','chocolate lovers','cheese sausage torte','forest cake','beef log gift of 6','maple sausage','pers giraffe hoodie','chees spread','sausage and chees','sau','mouse cards','petit four tree','must','sweet bread','trio candy','genuine buffalo nickel dream catcher pendant','bacon smoked cheese spread','chocolate raspberry jellies','cheese sets','six gift sampler','the big ones','big baby swiss','cheese sausage and petit fours','sausage and petit fours','cheese gift box','bacon cheddar cheese spread','pj s','bu','pers pet carrier','sugar free christmas','sugar free pecan','swiss colony beef log','chocolate christmas mouse','chocolate trio','small tin','projector alarm clock','colossal','merry christmas chocolate','medley','case','chocolate grahams','masterpiece','crab cheese','chocolate covered cake','butter-toffee','chocolate bonbons','fruit nut breads and cremes gift of 7','swiss and sausage','sugar free fish','take five','sale postpaid','premium','gift of 72 petit fours','bible phone','cheese and fruit gifts','by christmas','#2 cheeses','personalized pet carrier','cheese box','sugar glazed ham','sugar free slices','chocolate tower','lucky irish','chocolate raccoon','baby swiss postpaid','swiss colony 27','sugar free gummies','shrimp cheese','holiday cakes','special blend coffee','sausage n cheese bars gift of 8','port wine with almonds','two hams','box summer sausage','carees','beef mustard','chocolate and mint logs','horatio','pers angel throw','snack size','front','game meat','hole punch','gift of 4 cheese and sausage','bone','cover','strawberry galettes','sugar free nuts','lil petites','sausage and candy','guardian treasure chest','coated pretzels','hand decorated holiday cookies','filled','spiral glazed ham','sugar free vanilla cheesecake','soaring eagle fleece','old fashion toffee','chocolate p','triple chocolate','old cookies','gel candy','beef log food gift combo','hugger','coin pendant','butter truffles','petit fours sugar','chocolate-filled straws');
/* $Revision: 6883 $
 *
 */

if(typeof(_sli_init )!='object'){var _sli_init=new Array();}
if(typeof(sli_init )!='function'){function sli_init(){ for(var x=0;x<_sli_init.length;x++) _sli_init[x]();}}
if(typeof(asPhrases)!='object'){ var asPhrases = new Array(); }
if(typeof(__SLI_customisations)!='object'){var __SLI_customisations = new Object();}
if(typeof(__SLI_ClientDefaults)!='object'){ var __SLI_ClientDefaults=[]; }
if(typeof(__SLI_validSearchBoxes)!='object'){ var __SLI_validSearchBoxes = new Array(); }
if(typeof(__SLI_asug_used_flag)!='object'){ var __SLI_asug_used_flag = false; }
if(typeof(__SLI_width)!='object'){ var __SLI_width = 0; }
if(typeof(sli_targeturl)!='object'){ var sli_targeturl = ""; }


    __AutoComplete = new Object(); //namespace...
    __AutoComplete_mouseMoved=false;

    // Basic UA detection
    isIE = document.all ? true : false;
    isGecko = navigator.userAgent.toLowerCase().indexOf('gecko') != -1;
    isOpera = navigator.userAgent.toLowerCase().indexOf('opera') != -1;

    /* defaults and options */

    var __SLI_ApplicationName = 'AutoSuggest';
        __SLI_customisations[ 'AutoSuggest' ] =
                {
                    'ShowBrandingFooter' : true
                    ,
                    'TextBoxIDPrefix' : 'sli_search_'
                    ,
                    'BrandingFooterImagePath' : 'http://assets.resultspage.com/autosuggest/sli_systems-powered_150_15.gif'
                    ,
                    'BrandingFooterTitleTooltip' : 'AutoSuggest Powered by SLI Systems'
                    ,
                    'DropListMinWidth' : 150
                    ,
                    'MaxListItems' : 10
                    ,
                    'Alignment' : true
                    ,
                    'TextBoxIDCustom' : []
                    ,
                    'ValidSearchBoxes' : false 
                    ,
                    'IE6SelectBox' : false 
                    ,
                    'IE6SelectBoxPadding' : 0
                    ,
                    'TargetURL' : ''
                    ,
                    'IframeAlignment' : false
                    ,
                    'AlignmentBorderBug' : false
                    ,
                    'IE6OnFocus' : false
                };
    /* 0 = keyname, 1 = value */
    for( defaultValuePair in __SLI_ClientDefaults )
    {
        __SLI_customisations[__SLI_ApplicationName][__SLI_ClientDefaults[defaultValuePair][0]]=__SLI_ClientDefaults[defaultValuePair][1];
    }

    /* pre-fetch branding footer image if being used...
     */
    if( __SLI_customisations[ __SLI_ApplicationName ][ 'ShowBrandingFooter' ] )
    {
        
        if(location.protocol == "https:")
        {
            __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ] = __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ].replace(/http:/i, 'https:');
        }
    
        var __AutoCompleteBranding = new Image();
        __AutoCompleteBranding.src=__SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ];
    }


    function AutoComplete_init()
    {
        if(!isOpera)
        {
            var oldonresize=function(){};
            if(typeof(window.onresize)=='function')
                oldonresize = window.onresize;//play nicely with other people's toys
            window.onresize= function(){ oldonresize(); AutoComplete_HideAll(); AutoComplete_Create( asPhrases ); }

            AutoComplete_Create( asPhrases );
            
            var els = document.getElementsByTagName('input');
            if(els)
            {
               for ( i = 0; i < els.length; i++ )
               {
                  if(els[i].name == "asug")
                  {
                     els[i].disabled = true;
                  }
               }
            }
        }
    }




    /**
    * Attachs the autocomplete object to a form element. Sets
    * onkeypress event on the form element.
    *
    * @param string formElement Name of form element to attach to
    * @param array  data        Array of strings of which to use as the autocomplete data
    */
    //function AutoComplete_Create (id, data)
    /*
     * iterate over 'sli_search_*' assumes one or more search boxes numbered from 1...
    */
    function AutoComplete_Create( data )
    {
        var idx=1, e, id, searchBoxPrefix=__SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDPrefix' ];
        while( e = document.getElementById(searchBoxPrefix+idx) )
        {
            AutoComplete_AttachHandlers(e, data);
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
                __SLI_validSearchBoxes.push(searchBoxPrefix+idx);
            }
            idx++;
        }
        
        
        //this array comes from the customised list
        var otherTextBoxIdList = __SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDCustom' ];
        if( otherTextBoxIdList)
        {
            for(idx=0;idx<otherTextBoxIdList.length;idx++)
            {
                e = document.getElementById(otherTextBoxIdList[idx]);
                if(e)
				{
					if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
                	{
	                    __SLI_validSearchBoxes.push( otherTextBoxIdList[idx] );
                	}
					AutoComplete_AttachHandlers(e, data);
				}
            }
        }
        
    } 

    function AutoComplete_AttachHandlers(e, data){
        var iframe,id;
        id=e.id;


        __AutoComplete[id] = {'data':data,
                              'isVisible':false,
                              'element':document.getElementById(id),
                              'dropdown':null,
                              'highlighted':null};

        __AutoComplete[id]['element'].setAttribute('autocomplete', 'off');
        __AutoComplete[id]['element'].onkeydown = function(e) {if (!e) e = window.event; return AutoComplete_KeyDown(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onkeyup = function(e) {if (!e) e = window.event; return AutoComplete_KeyUp(this.getAttribute('id'), e);}
        // The function call on the next line was changed by Andrew Grieve April 2008
        __AutoComplete[id]['element'].onkeypress = function(e) {if (!e) e = window.event; return AutoComplete_KeyPress(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onclick = function(e)
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6OnFocus' ] )
            {
                __AutoComplete[id]['element'].focus();
            }
            if (!e) e = window.event; e.cancelBubble = true; e.returnValue = false;
        }



        // Hides the dropdowns when document clicked
        var docClick = function()
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
            }
            else
            {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
            }
        }

        if (document.addEventListener) {
            document.addEventListener('click', docClick, false);
        } else if (document.attachEvent) {
            document.attachEvent('onclick', docClick, false);
        }


        // Max number of items shown at once
        if (arguments[2] != null) {
            __AutoComplete[id]['maxitems'] = arguments[2];
            __AutoComplete[id]['firstItemShowing'] = 0;
            __AutoComplete[id]['lastItemShowing'] = arguments[2] - 1;
        }

        AutoComplete_CreateDropdown(id);

        // Prevent select dropdowns showing thru
        if (isIE) {
            iframe = document.createElement('iframe');
            __AutoComplete[id]['iframe'] = iframe;
                iframe.id = id +'_iframe';
                iframe.style.position = 'absolute';
                iframe.style.top = '0';
                iframe.style.left = '0';
                iframe.style.width = '0px';
                iframe.style.height = '0px';
                iframe.style.zIndex = '98';
                iframe.style.visibility = 'hidden';
                
                if(location.protocol == "https:")
                {
                   iframe.src = 'https://assets.resultspage.com/autosuggest/blank.html';
                }
                
                if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBox' ] )
                {
                  iframe.style.width = __SLI_width  + __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBoxPadding'];
                }

            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IframeAlignment' ] )
            {
                document.body.insertBefore( iframe );
            }
            else
            {
                __AutoComplete[id]['element'].parentNode.insertBefore( iframe, __AutoComplete[id]['element'] );
            }
        }
    }

    /**
    * Creates the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_CreateDropdown(id)
    {
        var theSearchbox = __AutoComplete[id]['element'];
        var theDropDown;
        var left_top = AutoComplete_getPos( theSearchbox );
        var left  = left_top[0];
        var top   = left_top[1] + theSearchbox.offsetHeight;
        var width = theSearchbox.offsetWidth;

        if ( width < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
        {
            width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
        }

        theDropDown = document.createElement('div');
        theDropDown.className = 'autocomplete'; // Don't use setAttribute()


        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true && document.body)
        {
            theDropDown.style.position = 'absolute';
            document.body.insertBefore(theDropDown, document.body.nextSibling);
            
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        else if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "offsetrelative" && document.body)
        {
          theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
          // Position it
          if(sli_getStyle(theSearchbox.offsetParent, 'position') != "absolute")
          {
            theSearchbox.offsetParent.style.position = 'relative';
          }
          theDropDown.style.position = 'absolute';
          theDropDown.style.left = (theSearchbox.offsetLeft) + 'px';
          theDropDown.style.top = (theSearchbox.offsetTop + theSearchbox.offsetHeight) + 'px';
          if ( theSearchbox.clientWidth < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
          {
            theDropDown.style.width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
          }
          else
          {
            theDropDown.style.width = (theSearchbox.clientWidth) + 'px';
          }
          theDropDown.style.visibility = 'hidden';
          theDropDown.style.zIndex     = '99999999';
        }
        else
        {
            theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        

        __AutoComplete[id]['dropdown'] = theDropDown;
        __SLI_width = width;
    }

    function /* array [ left, top ] */ AutoComplete_getPos( obj )
    {
        var curleft = curtop = 0;
        var sli_flag = 0;

        if (obj.offsetParent)
        {
           do
           {
              if ( __SLI_customisations[ __SLI_ApplicationName ][ 'AlignmentBorderBug' ] )
              {         
                
                if(sli_flag == 1)
                {
                    var clientTop = (obj.offsetHeight - obj.clientHeight) / 2;
                    curtop += clientTop;

                    var clientLeft = (obj.offsetWidth - obj.clientWidth) / 2;
                    curleft += clientLeft;
                }
                sli_flag = 1;
              }
           
              curleft += obj.offsetLeft;
              curtop += obj.offsetTop;
           }
           while (obj = obj.offsetParent);
        }
        return [curleft,curtop];
    }

    /**
    * Shows the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ShowDropdown(id)
    {

        AutoComplete_HideAll();



        var value = __AutoComplete[id]['element'].value;
        var toDisplay = new Array();
        var newDiv    = null;
        var text      = null;
        var numItems  = __AutoComplete[id]['dropdown'].childNodes.length;

        __AutoComplete_mouseMoved=false;
        // SLI Code Modification - Start - Andrew Grieve April 08
        // Trim the textbox so that if is starts with a space then the feature will still work
        //value = value.replace(/^\s+|\s+$/g,"");
        value = value.replace(/^\s+/g,"");

        if(value.length == "")
        {
            // If Textbox length is nothing (after the trim) then don't show dropdown.
            return;
        }
        // SLI Code Modification - End

        // Remove all child nodes from dropdown
        while (__AutoComplete[id]['dropdown'].childNodes.length > 0) {
            __AutoComplete[id]['dropdown'].removeChild(__AutoComplete[id]['dropdown'].childNodes[0]);
        }


        var count=0;
        // Go thru data searching for matches
        for (i=0; i<__AutoComplete[id]['data'].length; ++i)
        {
            // SLI Code Modification - Start - Andrew Grieve April 08 - Added lower casing
            if (__AutoComplete[id]['data'][i].substr(0, value.length).toLowerCase() == value.toLowerCase())
            {
                // SLI Code Modification - End
                toDisplay[toDisplay.length] = __AutoComplete[id]['data'][i];
                count++;
                /* how many to display? */
                if(count == __SLI_customisations['AutoSuggest']['MaxListItems'] ) /* Code inserted to keep list to a maximum of 10 values (was 20 or 30) */
                {
                    break;
                }
            }
        }

        // No matches?
        if (toDisplay.length == 0) {
            AutoComplete_HideDropdown(id);
            return;
        }



        // Add data to the dropdown layer
        for (i=0; i<toDisplay.length; ++i) {
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_item'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';

             // Scrollbars are on display ?
            if (toDisplay.length > __AutoComplete[id]['maxitems'] && navigator.userAgent.indexOf('MSIE') == -1) {
                newDiv.style.width = __AutoComplete[id]['element'].offsetWidth - 22 + 'px';
            }

            newDiv.onmouseover =
        function()
        {
            if( __AutoComplete_mouseMoved )
                AutoComplete_HighlightItem(__AutoComplete[id]['element'].getAttribute('id'), this.getAttribute('index'));
        };

            newDiv.onclick     =    function()
                                    {
                                    	  __SLI_asug_used_flag = true;
                                                                           
                                        AutoComplete_SetValue(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_HideDropdown(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_submitForm(id);
                                    }



            text   = document.createTextNode(toDisplay[i]);
            newDiv.appendChild(text);
            newDiv.title='Search for ' + toDisplay[i];

            /* ellipsis for IE only */
            if( isIE )
            {
                newDiv.style.textOverflow = 'ellipsis';
                newDiv.style.width = '100%';
                newDiv.style.whiteSpace = 'nowrap';
                newDiv.style.overflow = 'hidden';

            }
            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }
        /*
         * append DIV containing footer branding...
         */
        if(__SLI_customisations['AutoSuggest']['ShowBrandingFooter'])
        {
            i = toDisplay.length;
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_footer'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';
            newDiv.innerHTML = '<a href="http://www.sli-systems.com/powered-by.php" title="' +
                                __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterTitleTooltip' ] +
                                '"><img class="autocomplete_footer_branding" src="'+__AutoCompleteBranding.src+'" /></a>';

            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }


        // Too many items?
        if (toDisplay.length > __AutoComplete[id]['maxitems']) {
            __AutoComplete[id]['dropdown'].style.height = (__AutoComplete[id]['maxitems'] * 15) + 2 + 'px';

        } else {
            __AutoComplete[id]['dropdown'].style.height = '';
        }


        /**
        * Set left/top in case of document movement/scroll/window resize etc
        */
        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "true" || __SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "false")
        {
            var left_top = AutoComplete_getPos( __AutoComplete[id]['element'] );
            __AutoComplete[id]['dropdown'].style.left = left_top[0];
            __AutoComplete[id]['dropdown'].style.top  = left_top[1] + __AutoComplete[id]['element'].offsetHeight;
        }


        // Show the iframe for IE
        if (isIE) {
            
            if(!__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true)
            {
               __AutoComplete[id]['iframe'].style.width  = __AutoComplete[id]['dropdown'].offsetWidth;
            }
            
            
            __AutoComplete[id]['iframe'].style.top    = __AutoComplete[id]['dropdown'].style.top;
            __AutoComplete[id]['iframe'].style.left   = __AutoComplete[id]['dropdown'].style.left;
            __AutoComplete[id]['iframe'].style.height = __AutoComplete[id]['dropdown'].offsetHeight;

            __AutoComplete[id]['iframe'].style.visibility = 'visible';
        }

    e =  __AutoComplete[id]['dropdown'];

    e.onmousemove =
        function()
        {
            if(!__AutoComplete_mouseMoved){__AutoComplete_mouseMoved=true;}
            this.onmousemove = null;
        }

        // Show dropdown
        if (!__AutoComplete[id]['isVisible']) {
            __AutoComplete[id]['dropdown'].style.visibility = 'visible';
            __AutoComplete[id]['isVisible'] = true;
        }


        // If now showing less items than before, reset the highlighted value
        if (__AutoComplete[id]['dropdown'].childNodes.length != numItems) {
            __AutoComplete[id]['highlighted'] = null;
        }
    }



    /**
    * Hides the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_HideDropdown(id)
    {
        if (__AutoComplete[id]['iframe'])
        {
            __AutoComplete[id]['iframe'].style.visibility = 'hidden';
        }
        
        if (__AutoComplete[id]['dropdown'])
        {
            __AutoComplete[id]['dropdown'].style.visibility = 'hidden';
        }

        __AutoComplete[id]['highlighted'] = null;
        __AutoComplete[id]['isVisible']   = false;
    }


    /**
    * Hides all dropdowns
    */
    function AutoComplete_HideAll()
    {
         if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
         {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
         }
         else
         {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
         }
    }


    /**
    * Highlights a specific item
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_HighlightItem(id, index) // mouseover, index is the list element index, zero-based
    {
        if (__AutoComplete[id]['dropdown'].childNodes[index]) {
            for (var i=0; i<__AutoComplete[id]['dropdown'].childNodes.length; ++i) {
                if (__AutoComplete[id]['dropdown'].childNodes[i].className == 'autocomplete_item_highlighted') {
                    __AutoComplete[id]['dropdown'].childNodes[i].className = 'autocomplete_item';
                }
            }

            __AutoComplete[id]['dropdown'].childNodes[index].className = 'autocomplete_item_highlighted';
            __AutoComplete[id]['highlighted'] = index;

            //also see below...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[index].innerHTML;
            //AutoComplete_SetValue(id);
        }
    }


    /**
    * Highlights the menu item with the given index
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_Highlight(id, index) // keyboard up/down - index is the direction of travel, 1==down,-1=up
    {
        var childNodes = __AutoComplete[id]['dropdown'].childNodes;
        if(childNodes.length)
        {
	        var lastItem = ( ( childNodes[ childNodes.length - 1 ].className != 'autocomplete_footer' ) ? childNodes.length - 1 : childNodes.length - 2 );

            // Out of bounds checking
            //if (index == 1 && __AutoComplete[id]['highlighted'] == __AutoComplete[id]['dropdown'].childNodes.length - 1) {
            if (index == 1 && __AutoComplete[id]['highlighted'] == lastItem ) {
                childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = null;

            } else if (index == -1 && __AutoComplete[id]['highlighted'] == 0) {
                childNodes[0].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = lastItem;
                index = 0;//hack!
            }

            // Nothing highlighted at the moment
            if (__AutoComplete[id]['highlighted'] == null) {

                childNodes[0].className = 'autocomplete_item_highlighted';
                __AutoComplete[id]['highlighted'] = 0;
                newIndex = 0;
                
            } else {

                if (childNodes[__AutoComplete[id]['highlighted']]) {
                
                    childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                }

                var newIndex = parseInt( __AutoComplete[id]['highlighted'] ) + parseInt(index);

                if (childNodes[newIndex]) {

                    childNodes[newIndex].className = 'autocomplete_item_highlighted';

                    __AutoComplete[id]['highlighted'] = newIndex;
                }
            }

            //populate textbox with currently highlighted term...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[newIndex].innerHTML;
            AutoComplete_SetValue(id);
        }
    }


    /**
    * Sets the input to a given value
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_SetValue(id)
    {
        __AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[__AutoComplete[id]['highlighted']].innerHTML.replace(/&amp;/, "&");
    }


    /**
    * Checks if the dropdown needs scrolling
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ScrollCheck(id)
    {
        // Scroll down, or wrapping around from scroll up
        if (__AutoComplete[id]['highlighted'] > __AutoComplete[id]['lastItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'] - (__AutoComplete[id]['maxitems'] - 1);
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'];
        }

        // Scroll up, or wrapping around from scroll down
        if (__AutoComplete[id]['highlighted'] < __AutoComplete[id]['firstItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'];
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'] + (__AutoComplete[id]['maxitems'] - 1);
        }

        __AutoComplete[id]['dropdown'].scrollTop = __AutoComplete[id]['firstItemShowing'] * 15;
    }


    /**
    * Function which handles the keypress event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyDown(id, e)
    {
        var result = true;

       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {

            // Return/Enter
            case 13:
                if (__AutoComplete[id]['highlighted'] != null) {
                    AutoComplete_SetValue(id);
                    AutoComplete_HideDropdown(id);
					
                    __SLI_asug_used_flag = true;
					
                    if( e = __AutoComplete[id]['element'].form['asug'] )
                    {
                        
                        e.disabled=false;
                        e.value = __AutoComplete[id]['asug'];
                    }

                }

                result = AutoComplete_submitForm(id);

                break;

            // Escape
            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            // Up arrow
            case 38:
                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, -1);
                AutoComplete_ScrollCheck(id, -1);
                
                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                                
                result = false;
                break;

            // Tab
            case 9:
                if (__AutoComplete[id]['isVisible']) {
                    AutoComplete_HideDropdown(id);
                }
                return;

            // Down arrow
            case 40:

                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, 1);
                //AutoComplete_ScrollCheck(id, 1);

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                result = false;
                break;
        }
        return result;
    }


    /**
    * Function which handles the keyup event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyUp(id, e)
    {
       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {
            case 13:
                event.returnValue = false;
                event.cancelBubble = true;
                
                break;

            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            case 38:
            case 40:
                return false;
                break;

            default:
                AutoComplete_ShowDropdown(id);
                
                __AutoComplete[id]['asug']=__AutoComplete[id]['element'].value;

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=true;
                   e.value = "";
                }  
                
                break;
        }
    }

    /**
    * Function which handles the keypress event
    * This function added April 2008 by Andrew Grieve
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */

    // SLI Code Modification - Start - Andrew Grieve April 08
    function AutoComplete_KeyPress(id, e)
    {
        var event = e;
        if(!event) event = window.event;
        var keyCode = event.keyCode;

        if (keyCode == 13 && isGecko || isOpera)
        {
            return false;
        }
        
        if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
        {
            if (keyCode == 13 && isIE)
            {
                return false;
            }
        }
        
    }
    // SLI Code Modification - End

    /**
    * Returns whether the dropdown is visible
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_isVisible(id)
    {
        return __AutoComplete[id]['dropdown'].style.visibility == 'visible';
    }

    function AutoComplete_submitForm(id)
    {
      var e, f, result=true;
      if( f = __AutoComplete[id]['element'].form )
      {
        if( __AutoComplete[id]['element'].value != '' )
        {
          if(__SLI_asug_used_flag == true)
          {
            if( e = f['asug'])
            {
              e.value = __AutoComplete[id]['asug'];
              e.disabled=false;
            }
          }

          if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
          {
            asugvar = "";
            if(__SLI_asug_used_flag == true)
            {
              asugvar = '&asug=' + escape(__AutoComplete[id]['asug']);
            }

            sliRegex = /resultsdemo\.com/;
            if(sliRegExArray = sliRegex.exec(document.domain))
            {
              sliRegex = /^http:\/\/(.*)\//;
              sliTargetDomain = sliRegex.exec(__SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ]);
              __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ].replace(sliTargetDomain[1], document.domain);
            }

            document.location.href = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] + escape(__AutoComplete[id]['element'].value) + asugvar;
          }
          else
          {
            if(f.onsubmit)
            {
              if(f.onsubmit() !== false)
              {
                f.submit();
              }
            }
            else
            {
              f.submit();
            }
          }

          AutoComplete_HideAll();
        }
        else
          result = false;
      }
      return result;
    }
    
    // get the style that will be applied by the browser, including stylesheets
    function sli_getStyle(el,styleProp)
    {
      if (el.currentStyle)
        var y = el.currentStyle[styleProp];
      else if (window.getComputedStyle)
        var y = document.defaultView.getComputedStyle(el,null).getPropertyValue(styleProp);
      return y;
    }

    // register with onLoad(er...
    _sli_init.push( AutoComplete_init );
    
    function sli_addEvent(obj, evType, fn) {
    	if (obj.addEventListener) {
    		obj.addEventListener(evType, fn, false);
    		return true;
    	} else if (obj.attachEvent) {
    		var r = obj.attachEvent("on" + evType, fn);
    		return r;
    	} else {
    		return false;
    	}
    }
    
    function sli_load()
    {
    	sli_addEvent(window, 'load', sli_init);
    }