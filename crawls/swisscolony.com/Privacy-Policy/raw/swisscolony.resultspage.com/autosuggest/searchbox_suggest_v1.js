/* Popular phrases - SWISSCOLONY - 21:41:6, Wed Oct 3, 2012 */
__SLI_ClientDefaults =
[
    ['Alignment', 'offsetrelative' ],
	['IE6SelectBox', true ],
    ['ShowBrandingFooter', false ],
];
var asPhrases=new Array ('sale','petit fours','chocolate','cheesecake','halloween','cheese','ham','baklava','fruit cake','sugar free','fudge','cookies','pumpkin','catalog','truffles','toffee','toys','nuts','torte','cakes','bonbons','careers','butter toffee','coconut','dobosh torte','incredible spreadables','breakfast','sugar free products','brownies','cheese spreads','fruitcake','spreadables','red velvet','postpaid','macadamia nut chocolate','beef log','popcorn','red velvet petit fours','smart tablet','chocolate truffles','cake balls','best seller assortment','summer sausage','coffee','sausage','cashews','peanut brittle','pretzels','gingerbread house','candy','mp3 player','chris mouse','27 favorites','spiced pumpkins','christmas','cheese cake','sampler','watches','petit','swiss cheese','bacon','pistachios','coconut drops','dobosh','chocolate covered potato chips','baby swiss','mixed nuts','popcorn tins','angel','divinity','mint torte','cheese log','pecan','jerky','mustard','jewelry','petit fours and bonbons','bark','high 5','dips','bread','spreads','fruit','beef jerky','crackers','sweatshirt','chocolate covered cherries','carrot cake','german chocolate cheese cake','slippers','tablet','coconut macaroons','precious moments','holiday breakfast','pumpkin spice cake','cheddar cheese','jelly belly','jacket','shipping','meat sticks','throw','coconut petits four','sugar free petits fours','ornaments','petit four sale','caramel apple cheesecake','fruit slices','reindeer food','jumbos','rum balls','cheese slicer','fudge trio','cherries','spreadable cheese','peanut butter','telescope','log','pumpkin bark','red velvet cheese cake','baby swiss cheese','mini butter toffee','wild game meat sticks','macadamia nuts','christmas petit fours','jelly beans','forest friends log','towers','pumpkin coffee cake','cat','polar pals trio','mint','82 all time favorites','liqueur','halloween petit fours','fleece jacket','cheese and sausage','dark chocolate','candles','peppermint bark','florentine lace cookies','christmas breakfast','bananas foster','mini tower','meat','fruit and nut breads','cheesecake morsels','galettes','harvest petits fours','ho ho ho tower','aquarium','personalized','pecan praline','pecan tarts','breakfast meats','fudge brownie puffs','santa torte','coconut bars','holiday treasure','pets','red velvet cake','taffy','postpaid petit fours','beef','zoo chocolates','gift sampler','deep dish caramel apple pie','coconut cake','pendant','sweater','personalized gifts','elephant','petit fours bonbons assortments','crisps','chocolate layered mints','blue cheese','potato chips','coffee sampler','shipping charges','snowflake cake','clocks','sugar free cookies','mp3','wolf','cheesecake tarts','stollen','jumbo cashews','chocolate covered macadamia nuts','incredible petits fours','baby doll with 7 outfits','royal chocolate petits fours','ham and cheese','big red cheddar','caramel','robe','hearty breakfast meats','knife','angel treasure chest','gourmet brownies','florentine','shortbread','fruit spread','crisps and spreadables','brie','high five','old fashion christmas candy','scottie dogs','bavarian creme torte','caramel pecan swirl','colossal breakfast','family keepsake ornament','holi-bars','holiday fruit tray','chocolate potato chips','jalapeno beef log','holiday high notes','gingerbread spice cookies','bavarian','friendship plate','macadamia','sticky buns','glasses','purse','mustard trio','pumpkin cake','original beef log','brownie puffs','cheese gifts','favorite five','82 all-time favorites','halloween cookies','dobosh cakes','handbags','raccoon','lite beef log','chocolate torte','men','kitty hammock','seafood logs','snow globe','licorice tin','pancake mix','apple pie','festive favorites','seafood','macaroons','gingerbread','mint chocolate','boucle sweater coat','coffee cake','carrot','lace cookies','crafting tool kit','slicer','sugar free brownies','caramel pecan clusters','pecan clusters','lemon','dried fruit tray','trick or treat bag','pet carrier','sausage and cheese bars','spiral ham','pecan swirl','lemon petit fours','crrrisps','tin','holiday favorites','raspberry cheese cake','heater fan defroster','eggnog fluff','sweet surprises basket','jumbo cheeses','hotline to god','sweet hot mustard','carrot cake petits','pumpkin petit fours','french vanilla bonbons','kreme kaese cheese','fruit trays','no sugar','rum','licorice','coffee creme sticks','rings','cheesecake bites','peppermint','personalized throw','giraffe','games','chocolate petit fours','mouse','halloween gifts','fruit cake cookies','marble cheese board slicer','sugarfree','trail mix','pralines','unsalted nuts','bavarian bonbons','cardinal pjs','spreadable sampler','sausage n cheese','home and roadside','butterfly music box','helicopter','pumpkin cookies','gift of 4','beef sticks','chocolate pretzels','sharp cheddar','chocolate fudge','santa\'s snacks tin','mini petit fours','mint dobosh torte','43 season pleasers','pies','personized zoo animals','pancakes','swiss','holiday cookies','western dvds','breakfast special delivery','pastries','wheel of cheese','lobster','treasure chest','creme de menthe torte','snowman truffles','pet lovers sweatshirt','petit fors','cajun beef sticks','petit four flavors','wallet','dog bed','jam','heated ice scraper','stollen cake','pjs','boneless spiral sliced ham','strawberry','cinnamon rugulach','sugar free cheesecake','snowman','angel pendant','brickle','men gifts','candy bark','24 petits fours','no sugar added','shelled pistachios','birthstone','winged lighted angel','apo shipping','raspberry cheesecake','john wayne','fruitful delight','radio','reed diffuser set','butter toffee crunch','chips','scottie','galileo thermometer','eagle','14 country favorites','liqueur truffles','eyeball truffles','peanut butter bites','snowflake bear','blankets','christmas butter stollen','harvest','prayer animal','pecan log','cross','baby doll','christmas cake','angel chest','order','snack','smores barks','breakfast petit fours','cross dog tag','gaming console','cardinal','tools','honey creme','pants','creature cake','inspirational','wild game meats','old fashioned fudge trio','cheese bars','remote control helicopter','ribbon candy','baskets','life celebration','smoked cheddar','raspberry','streusel swirl coffee cake','plate and holder','saltwater taffy','winter scene sweatshirt','christmas taffy','elk','milk chocolate','hats','life\'s celebrations','personalized sketch set 106-pieces','cherry cordials','decanter','hummingbird','lucy a legacy of laughter','fleece pant','chocolate mouse','halloween bear','baseball','beeflog','s','garden','skeleton truffles','santa snack tin','fruitcake medley','french vanilla cheesecake','snack time special','boneless ham','sugar free chocolate pecan fudge','blueberry','puffs','season pleasers','cajun mix','4 gb mp3 player','cheese and crackers','racing car wall clock','winking santa torte','macadamia nut patties','holi bars','ultimate snack mix','carrot cake petits fours','banana','almonds','holiday cardinal tower','food','fall petit fours','zoo','miniature baklava desserts','6 mini towers','harvest fruit tray','ham and swiss','fish','crunchy','moon wolves tee','licorice mix','garlic beef log','jelly belly jelly beans','inspirational musical clock','mango salsa','knife set','red velvet petits','daughter throw','cheddar','incredible spreadables samplers','fruit and nut delights','seafood dips','ballpoint pen with personalized case','liqueur cake','incredible spreadables with crunchy crisps','nonpareils','recipes','fruit spread sampler','country favorites','holiday cookie sampler','vintage cheddar','peanut butter and chocolate','gift towers','children','pet lovers','wardrobe of watches','trio of chocolate samplers','scuff','pet beds','tarts','roll','jalapeno peanut brittle','vintage cheddar cheese','red velvet cheesecake','heater fan','tumble buggies','story stix','christmas collection','pink and camo jacket','christmas decorations','colby','set of 7 mini glass elephants','mens suede slippers','gift of plenty','crab cheese dip','womens jacket','cake rolls','blueberry cookies','underwater fantasy aquarium','incredible spreads','all time favorites','personalized trick or treat bag','home','big baby swiss cheese','heater','crystal initial angel pendant','wolf throws','candle collection','walkers','mini petite','bible','plenty','name pendant','holiday mix','cashew nuts','lucy','bear','rollover pets','wildlife bottle opener','merry christmas petit fours','bridge mix','kitty','wings','mixed nut sampler','lace','carrier','howling wolf fleece throw','belts','santa\'s favorite','butter brickle toffee','special gift samplers','personalized wildlife knife set','velour','love','caramel apple pie','butter','tower full of joys','mini baklava assortment','salt and pepper shakers','pers fleece robe','bavarian torte','mini cakes','bottle opener','petite cakes','jumbo beef log','banana bread','pillows','holiday pretzel trio','personalized bear','handmade fudge','assorted candy','meat stick bonanza','smoked bacon','carryall supple leather','christmas cookies','monkey','glazed ham','carrot cake balls','angel in chest','chocolate covered butter toffee','cranberry cheese','ham and baby swiss','coffee sticks','sausage n cheese bar','camouflage lounge set','aged swiss','sno-shield','cheese ball','scottie dog walkers','lemon bread','angel throw','best sellers','jalapeno','jalapeno brittle','cremes','wine','chocolate covered macadamia','15 holiday favorites','electronic hangman','classic candy assortment','electronic audio bible','meat snacks','wood','4 piece leather handbag set','white petit fours','hot and spicy','brick cheese','pen','premium nut assortment','fall','fleece','petite holiday mints','raccoon cake','confetti party bark','11','apple cinnamon','monkey chocolate','cheese bars with slicer','family keepsake','lantern','sugar free peppermint','owl family figurine','butterfly','bear with halloween cookies','salt and pepper','vanilla petits fours','watch radio and pen set','jelly belly gift assortment','ice scraper','mini toffee','cajun sticks','faux sherpa lined flannel shirt','swirl coffee cake','sugarfree cheesecake','3 tortes','pecan long','sugar free gifts','usb heating cooling mini fridge','candy santa','summer sausage and cheese','music','sugar free cherries','cross pendant','buffalo plaid fleece jacket','honey glazed ham','48','two tone','sugar free chocolate potato chips','fruit gifts','canned ham','macadamia nut truffles','sugar free holiday mix','travel alarm clock','halloween witch log','an','all sugar free products','red','wolves','muenster cheese','alarm clock','gift of 6','beef sausage','peppermint candy bites','creature balls','dates','butterfly meadow pjs','hammock','santa','colby cheese','cheese sampler','sugar free fruit cake','size chart','chocolate chip','velour set','beef log and cheese','cheese and meat','oranges','new arrivals','favorites','angel in personalized treasure chest','solid milk chocolate','27','ice','color set','denim jacket','sno','chocolate snowman','cat throw','country ham','i','shower shave mirror with radio','5 sausage','rugulach','ingredients in beef log','chocolate pecan fudge','music box','cardinal tower','santa cake','leather carryall','gingerbread cookies','clusters','manicure set','camo set','white cheddar','musical hummingbird egg','canadian bacon','spread your wings pendant','lamp','forest friends cake','zoo animals','halloween playcakes','mini','caraway beef log','old fashion butter toffee','wreath','fours','72','womens gifts','nuts postpaid','mini cakes trio','sausage logs','hearty breakfast','butter stollen','26 holiday favorites','aged cheddar','audio bible','peppermint patties','layer','cookie tin','chocolate santa cards','crystal','aquarium light','snowman blanket','garden vegetable dip','petit four gift samplers','no sugar added trail mix','streusel coffee cake','carrot petit','fruit nut breads and cremes','sugar free chocolate assortment','bonbon cake','carrot cake cream torte','sugar free peanut brittle','scarf','mood watch','jacquard handbag','mens lounge set','snowman melts','dolls','assorted chocolates','moccasin','32 favorites','orange slices','sugar free fruit nut delight','cheese assortment','caramel pecan','trio','hotline','dutch apple','honey mustard','eagle hoodie','pocket scarf','smokey cheddar cheese','suspenders','cheese dips','old fashioned candy','sauces','sugar free cheese cake','animal','sugar free assortment','cheese popcorn','chris mouse magical pleasers','lemon mist','tumble','red rind muenster','well-mannered doll','macadamia fruit cake','oatmeal cookies','caramel apple cheese cake','leather purse','wisconsin','globe','toffee crunch','bowling set','sugar free chocolatey potato chips','jumping clock','beef long','bear and cookies','candy and cakes','all','hot chocolate','owl','german','ho ho ho','beef log gift combo','kreme kaese','cinnamon','wacky duckie','dvds','chocolate cheese','carrot spice','balls','two tone cross pendant','german chocolate','jewish','port wine cheddar','fruity gels','venison','lovable lapsies','bags','li\'l baby swiss','key lime','save','suede scuff','chocolate log','basketball crazy shoot','ornament server','velvet cake','scraper','angel figurine charms','surefire pleasers','beef log combo','8 gb mp3 player','deep dish caramel pie','snowballs','raspberry petit four','personalized angel throw','bison','sugar free chocolate fudge','32 holiday favorites','black cat pillow','walnut cake','drops','sweet and hot spreadables','orangutan','fantasy aquarium','chocolate pecan','angel fleece throw','precious','electronic bible','fruitcake cookies','tasty temptations','cake bites','women\'s fleece jacket','witch log','pistachio nuts','supple leather carryall','bonanza','garden vegetable cheese','chocolate cake roll','fleece throw','stix','72 petit','pocket watch','chocolate cheesecake','snack tin','glass elephant','stuffed animals','cars','sugar free gourmet brownies','family banner','spice cookies','garlic beeflog','creme de menthe','harvest fruit','apple bread','orange petits','mens jackets','interchangeable watch set','wildlife knife set','no sugar cookies','personalized treasure chest','sketch','slippers muk luks','spread your wings','cinnamon cake','hickory smoked bacon','ham links','horatio cable sweater','halloween cakes','laffy taffy','postpaid toffee','smart','cash','electronic games','age cheese','lounge pants','credit card','milk chocolate macadamia nuts','chocolate covered toffee','pumpkin pillow','walkers shortbread','mousse','charms','chocolate covered nuts','14','chocolate card','covered cherries','cheese board','sugar cookies','jumbo cheese trio','desserts','ancho','hot sauce','royal chocolate','chocolate peanuts','sherpa','gift of 8','apple cake','snack mix','strawberry cheese cake','zigzag sweater','triple berry cheesecake','postpaid dobosh','mirror','swirl','shrimp','lol rollover pets','vegetable dip','christmas chocolate','art 101','coffee bark','chocolate toffee','cat pillow','velvet','suede','plaid','cheese board slicer','red velvet layer cake','beef and cheese','cashews and pistachio','apple pancake','plaque','interchangeable 10 charms jewelry','lobster spread','fruit candy','mini butter','cat hammock','wild game','sweets','sugar free holiday cookies','coins','lobster delight','spring cookie gift assortment','meat strip','snowman tower','trick or treat','fire glazed ham','butter mints','postpaid cheese','shoe shine','sno shield windshield protector','collectibles','venison sticks','garlic','blueberry cheese','star','hot mustard','candy sampler','chocolate cake balls','defroster','15','scented candles','western','petite mints','sweet halloween pretzels','swiss chocolate','bakery','chocolate candy','all occasion','kreme cheese','82 favorites','sugar free toffee','exclusive','preserves','barnyard','petit four 36','garlic summer sausage','deer fleece','festive','21 season highlights','sherpa jacket','sugar free truffles','sweet hot','32','postpaid fruitcake','military','santas snack','peppermint chocolate bark','drill','santa cards','postpaid truffles','summer','cheese wax','sail','coffe cake','sugar free butter toffee','all products','muk luks','forest friends','marshmallow','christmas morning breakfast','bats','sweet mustard','crumb cake','movies','meat strips gift box','vintage cheese','german chocolate cheesecake','sailboat','82','soothing sandscape','holiday mints','eggs','i love you','candy sampler trio','chocolate pecan mix','wildlife wallet','christmas candies samplers','decanter set','kiss','vegetable cheese spread','binoculars','chees spread','shaver','camo fleece','mummy cupcakes','santa tins','front 5 favorites','boneless ham and baby swiss','big red cheddar baby swiss','rocky road','black forest','kaese','computer mouse','windshield','forest','brazil nuts','live plate','wrapped candy','all sizes','harvest petit','treat','led rechargeable lantern','chocolate santa','chocolate lollipops','onion cheese','43','82 all','triple chocolate torte','cheese bites','caramel cheesecake','snuggle','holiday bars','f','count and draw','snowman blanket hugger','frosty','men\'s fleece pants','bible verses','graham','dutch','chocolate layer cake','cocoa','oval pendant','fruity and white cheddars','toffe','for kids','white','for her','sausage bread','ceramic','mild jalapeno','cream','dress up phone','fleece robe','wolves tee','camping lantern','no sugar added fruit cake','christmas dinner','petit f','82 all time','gift shop','cat beds','candy house','24 petits','select mixed nuts','cheese\'s','sno-shield windshield protector','port','chocolate dobosh','blueberry cheesecake','chocolate covered peanut butter','sweet cheese','walnut oatmeal pumpkin cookies','stuffed toys','big logs','strawberry truffles','set of 3 led flashlights','meat strip gifts','charge','smokehouse','batteries','sugar free macadamia nut clusters','bites','special delivery','chees cake','brazil','savory','cheese and candy','postpaid christmas petits fours christmas petits','swiss and ham cheese spread','pancake and ham links','$40','2- piece thermal fleece lounge set','$15');
/* $Revision: 6883 $
 *
 */

if(typeof(_sli_init )!='object'){var _sli_init=new Array();}
if(typeof(sli_init )!='function'){function sli_init(){ for(var x=0;x<_sli_init.length;x++) _sli_init[x]();}}
if(typeof(asPhrases)!='object'){ var asPhrases = new Array(); }
if(typeof(__SLI_customisations)!='object'){var __SLI_customisations = new Object();}
if(typeof(__SLI_ClientDefaults)!='object'){ var __SLI_ClientDefaults=[]; }
if(typeof(__SLI_validSearchBoxes)!='object'){ var __SLI_validSearchBoxes = new Array(); }
if(typeof(__SLI_asug_used_flag)!='object'){ var __SLI_asug_used_flag = false; }
if(typeof(__SLI_width)!='object'){ var __SLI_width = 0; }
if(typeof(sli_targeturl)!='object'){ var sli_targeturl = ""; }


    __AutoComplete = new Object(); //namespace...
    __AutoComplete_mouseMoved=false;

    // Basic UA detection
    isIE = document.all ? true : false;
    isGecko = navigator.userAgent.toLowerCase().indexOf('gecko') != -1;
    isOpera = navigator.userAgent.toLowerCase().indexOf('opera') != -1;

    /* defaults and options */

    var __SLI_ApplicationName = 'AutoSuggest';
        __SLI_customisations[ 'AutoSuggest' ] =
                {
                    'ShowBrandingFooter' : true
                    ,
                    'TextBoxIDPrefix' : 'sli_search_'
                    ,
                    'BrandingFooterImagePath' : 'http://assets.resultspage.com/autosuggest/sli_systems-powered_150_15.gif'
                    ,
                    'BrandingFooterTitleTooltip' : 'AutoSuggest Powered by SLI Systems'
                    ,
                    'DropListMinWidth' : 150
                    ,
                    'MaxListItems' : 10
                    ,
                    'Alignment' : true
                    ,
                    'TextBoxIDCustom' : []
                    ,
                    'ValidSearchBoxes' : false 
                    ,
                    'IE6SelectBox' : false 
                    ,
                    'IE6SelectBoxPadding' : 0
                    ,
                    'TargetURL' : ''
                    ,
                    'IframeAlignment' : false
                    ,
                    'AlignmentBorderBug' : false
                    ,
                    'IE6OnFocus' : false
                };
    /* 0 = keyname, 1 = value */
    for( defaultValuePair in __SLI_ClientDefaults )
    {
        __SLI_customisations[__SLI_ApplicationName][__SLI_ClientDefaults[defaultValuePair][0]]=__SLI_ClientDefaults[defaultValuePair][1];
    }

    /* pre-fetch branding footer image if being used...
     */
    if( __SLI_customisations[ __SLI_ApplicationName ][ 'ShowBrandingFooter' ] )
    {
        
        if(location.protocol == "https:")
        {
            __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ] = __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ].replace(/http:/i, 'https:');
        }
    
        var __AutoCompleteBranding = new Image();
        __AutoCompleteBranding.src=__SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ];
    }


    function AutoComplete_init()
    {
        if(!isOpera)
        {
            var oldonresize=function(){};
            if(typeof(window.onresize)=='function')
                oldonresize = window.onresize;//play nicely with other people's toys
            window.onresize= function(){ oldonresize(); AutoComplete_HideAll(); AutoComplete_Create( asPhrases ); }

            AutoComplete_Create( asPhrases );
            
            var els = document.getElementsByTagName('input');
            if(els)
            {
               for ( i = 0; i < els.length; i++ )
               {
                  if(els[i].name == "asug")
                  {
                     els[i].disabled = true;
                  }
               }
            }
        }
    }




    /**
    * Attachs the autocomplete object to a form element. Sets
    * onkeypress event on the form element.
    *
    * @param string formElement Name of form element to attach to
    * @param array  data        Array of strings of which to use as the autocomplete data
    */
    //function AutoComplete_Create (id, data)
    /*
     * iterate over 'sli_search_*' assumes one or more search boxes numbered from 1...
    */
    function AutoComplete_Create( data )
    {
        var idx=1, e, id, searchBoxPrefix=__SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDPrefix' ];
        while( e = document.getElementById(searchBoxPrefix+idx) )
        {
            AutoComplete_AttachHandlers(e, data);
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
                __SLI_validSearchBoxes.push(searchBoxPrefix+idx);
            }
            idx++;
        }
        
        
        //this array comes from the customised list
        var otherTextBoxIdList = __SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDCustom' ];
        if( otherTextBoxIdList)
        {
            for(idx=0;idx<otherTextBoxIdList.length;idx++)
            {
                e = document.getElementById(otherTextBoxIdList[idx]);
                if(e)
				{
					if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
                	{
	                    __SLI_validSearchBoxes.push( otherTextBoxIdList[idx] );
                	}
					AutoComplete_AttachHandlers(e, data);
				}
            }
        }
        
    } 

    function AutoComplete_AttachHandlers(e, data){
        var iframe,id;
        id=e.id;


        __AutoComplete[id] = {'data':data,
                              'isVisible':false,
                              'element':document.getElementById(id),
                              'dropdown':null,
                              'highlighted':null};

        __AutoComplete[id]['element'].setAttribute('autocomplete', 'off');
        __AutoComplete[id]['element'].onkeydown = function(e) {if (!e) e = window.event; return AutoComplete_KeyDown(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onkeyup = function(e) {if (!e) e = window.event; return AutoComplete_KeyUp(this.getAttribute('id'), e);}
        // The function call on the next line was changed by Andrew Grieve April 2008
        __AutoComplete[id]['element'].onkeypress = function(e) {if (!e) e = window.event; return AutoComplete_KeyPress(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onclick = function(e)
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6OnFocus' ] )
            {
                __AutoComplete[id]['element'].focus();
            }
            if (!e) e = window.event; e.cancelBubble = true; e.returnValue = false;
        }



        // Hides the dropdowns when document clicked
        var docClick = function()
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
            }
            else
            {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
            }
        }

        if (document.addEventListener) {
            document.addEventListener('click', docClick, false);
        } else if (document.attachEvent) {
            document.attachEvent('onclick', docClick, false);
        }


        // Max number of items shown at once
        if (arguments[2] != null) {
            __AutoComplete[id]['maxitems'] = arguments[2];
            __AutoComplete[id]['firstItemShowing'] = 0;
            __AutoComplete[id]['lastItemShowing'] = arguments[2] - 1;
        }

        AutoComplete_CreateDropdown(id);

        // Prevent select dropdowns showing thru
        if (isIE) {
            iframe = document.createElement('iframe');
            __AutoComplete[id]['iframe'] = iframe;
                iframe.id = id +'_iframe';
                iframe.style.position = 'absolute';
                iframe.style.top = '0';
                iframe.style.left = '0';
                iframe.style.width = '0px';
                iframe.style.height = '0px';
                iframe.style.zIndex = '98';
                iframe.style.visibility = 'hidden';
                
                if(location.protocol == "https:")
                {
                   iframe.src = 'https://assets.resultspage.com/autosuggest/blank.html';
                }
                
                if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBox' ] )
                {
                  iframe.style.width = __SLI_width  + __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBoxPadding'];
                }

            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IframeAlignment' ] )
            {
                document.body.insertBefore( iframe );
            }
            else
            {
                __AutoComplete[id]['element'].parentNode.insertBefore( iframe, __AutoComplete[id]['element'] );
            }
        }
    }

    /**
    * Creates the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_CreateDropdown(id)
    {
        var theSearchbox = __AutoComplete[id]['element'];
        var theDropDown;
        var left_top = AutoComplete_getPos( theSearchbox );
        var left  = left_top[0];
        var top   = left_top[1] + theSearchbox.offsetHeight;
        var width = theSearchbox.offsetWidth;

        if ( width < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
        {
            width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
        }

        theDropDown = document.createElement('div');
        theDropDown.className = 'autocomplete'; // Don't use setAttribute()


        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true && document.body)
        {
            theDropDown.style.position = 'absolute';
            document.body.insertBefore(theDropDown, document.body.nextSibling);
            
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        else if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "offsetrelative" && document.body)
        {
          theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
          // Position it
          if(sli_getStyle(theSearchbox.offsetParent, 'position') != "absolute")
          {
            theSearchbox.offsetParent.style.position = 'relative';
          }
          theDropDown.style.position = 'absolute';
          theDropDown.style.left = (theSearchbox.offsetLeft) + 'px';
          theDropDown.style.top = (theSearchbox.offsetTop + theSearchbox.offsetHeight) + 'px';
          if ( theSearchbox.clientWidth < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
          {
            theDropDown.style.width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
          }
          else
          {
            theDropDown.style.width = (theSearchbox.clientWidth) + 'px';
          }
          theDropDown.style.visibility = 'hidden';
          theDropDown.style.zIndex     = '99999999';
        }
        else
        {
            theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        

        __AutoComplete[id]['dropdown'] = theDropDown;
        __SLI_width = width;
    }

    function /* array [ left, top ] */ AutoComplete_getPos( obj )
    {
        var curleft = curtop = 0;
        var sli_flag = 0;

        if (obj.offsetParent)
        {
           do
           {
              if ( __SLI_customisations[ __SLI_ApplicationName ][ 'AlignmentBorderBug' ] )
              {         
                
                if(sli_flag == 1)
                {
                    var clientTop = (obj.offsetHeight - obj.clientHeight) / 2;
                    curtop += clientTop;

                    var clientLeft = (obj.offsetWidth - obj.clientWidth) / 2;
                    curleft += clientLeft;
                }
                sli_flag = 1;
              }
           
              curleft += obj.offsetLeft;
              curtop += obj.offsetTop;
           }
           while (obj = obj.offsetParent);
        }
        return [curleft,curtop];
    }

    /**
    * Shows the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ShowDropdown(id)
    {

        AutoComplete_HideAll();



        var value = __AutoComplete[id]['element'].value;
        var toDisplay = new Array();
        var newDiv    = null;
        var text      = null;
        var numItems  = __AutoComplete[id]['dropdown'].childNodes.length;

        __AutoComplete_mouseMoved=false;
        // SLI Code Modification - Start - Andrew Grieve April 08
        // Trim the textbox so that if is starts with a space then the feature will still work
        //value = value.replace(/^\s+|\s+$/g,"");
        value = value.replace(/^\s+/g,"");

        if(value.length == "")
        {
            // If Textbox length is nothing (after the trim) then don't show dropdown.
            return;
        }
        // SLI Code Modification - End

        // Remove all child nodes from dropdown
        while (__AutoComplete[id]['dropdown'].childNodes.length > 0) {
            __AutoComplete[id]['dropdown'].removeChild(__AutoComplete[id]['dropdown'].childNodes[0]);
        }


        var count=0;
        // Go thru data searching for matches
        for (i=0; i<__AutoComplete[id]['data'].length; ++i)
        {
            // SLI Code Modification - Start - Andrew Grieve April 08 - Added lower casing
            if (__AutoComplete[id]['data'][i].substr(0, value.length).toLowerCase() == value.toLowerCase())
            {
                // SLI Code Modification - End
                toDisplay[toDisplay.length] = __AutoComplete[id]['data'][i];
                count++;
                /* how many to display? */
                if(count == __SLI_customisations['AutoSuggest']['MaxListItems'] ) /* Code inserted to keep list to a maximum of 10 values (was 20 or 30) */
                {
                    break;
                }
            }
        }

        // No matches?
        if (toDisplay.length == 0) {
            AutoComplete_HideDropdown(id);
            return;
        }



        // Add data to the dropdown layer
        for (i=0; i<toDisplay.length; ++i) {
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_item'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';

             // Scrollbars are on display ?
            if (toDisplay.length > __AutoComplete[id]['maxitems'] && navigator.userAgent.indexOf('MSIE') == -1) {
                newDiv.style.width = __AutoComplete[id]['element'].offsetWidth - 22 + 'px';
            }

            newDiv.onmouseover =
        function()
        {
            if( __AutoComplete_mouseMoved )
                AutoComplete_HighlightItem(__AutoComplete[id]['element'].getAttribute('id'), this.getAttribute('index'));
        };

            newDiv.onclick     =    function()
                                    {
                                    	  __SLI_asug_used_flag = true;
                                                                           
                                        AutoComplete_SetValue(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_HideDropdown(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_submitForm(id);
                                    }



            text   = document.createTextNode(toDisplay[i]);
            newDiv.appendChild(text);
            newDiv.title='Search for ' + toDisplay[i];

            /* ellipsis for IE only */
            if( isIE )
            {
                newDiv.style.textOverflow = 'ellipsis';
                newDiv.style.width = '100%';
                newDiv.style.whiteSpace = 'nowrap';
                newDiv.style.overflow = 'hidden';

            }
            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }
        /*
         * append DIV containing footer branding...
         */
        if(__SLI_customisations['AutoSuggest']['ShowBrandingFooter'])
        {
            i = toDisplay.length;
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_footer'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';
            newDiv.innerHTML = '<a href="http://www.sli-systems.com/powered-by.php" title="' +
                                __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterTitleTooltip' ] +
                                '"><img class="autocomplete_footer_branding" src="'+__AutoCompleteBranding.src+'" /></a>';

            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }


        // Too many items?
        if (toDisplay.length > __AutoComplete[id]['maxitems']) {
            __AutoComplete[id]['dropdown'].style.height = (__AutoComplete[id]['maxitems'] * 15) + 2 + 'px';

        } else {
            __AutoComplete[id]['dropdown'].style.height = '';
        }


        /**
        * Set left/top in case of document movement/scroll/window resize etc
        */
        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "true" || __SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "false")
        {
            var left_top = AutoComplete_getPos( __AutoComplete[id]['element'] );
            __AutoComplete[id]['dropdown'].style.left = left_top[0];
            __AutoComplete[id]['dropdown'].style.top  = left_top[1] + __AutoComplete[id]['element'].offsetHeight;
        }


        // Show the iframe for IE
        if (isIE) {
            
            if(!__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true)
            {
               __AutoComplete[id]['iframe'].style.width  = __AutoComplete[id]['dropdown'].offsetWidth;
            }
            
            
            __AutoComplete[id]['iframe'].style.top    = __AutoComplete[id]['dropdown'].style.top;
            __AutoComplete[id]['iframe'].style.left   = __AutoComplete[id]['dropdown'].style.left;
            __AutoComplete[id]['iframe'].style.height = __AutoComplete[id]['dropdown'].offsetHeight;

            __AutoComplete[id]['iframe'].style.visibility = 'visible';
        }

    e =  __AutoComplete[id]['dropdown'];

    e.onmousemove =
        function()
        {
            if(!__AutoComplete_mouseMoved){__AutoComplete_mouseMoved=true;}
            this.onmousemove = null;
        }

        // Show dropdown
        if (!__AutoComplete[id]['isVisible']) {
            __AutoComplete[id]['dropdown'].style.visibility = 'visible';
            __AutoComplete[id]['isVisible'] = true;
        }


        // If now showing less items than before, reset the highlighted value
        if (__AutoComplete[id]['dropdown'].childNodes.length != numItems) {
            __AutoComplete[id]['highlighted'] = null;
        }
    }



    /**
    * Hides the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_HideDropdown(id)
    {
        if (__AutoComplete[id]['iframe'])
        {
            __AutoComplete[id]['iframe'].style.visibility = 'hidden';
        }
        
        if (__AutoComplete[id]['dropdown'])
        {
            __AutoComplete[id]['dropdown'].style.visibility = 'hidden';
        }

        __AutoComplete[id]['highlighted'] = null;
        __AutoComplete[id]['isVisible']   = false;
    }


    /**
    * Hides all dropdowns
    */
    function AutoComplete_HideAll()
    {
         if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
         {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
         }
         else
         {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
         }
    }


    /**
    * Highlights a specific item
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_HighlightItem(id, index) // mouseover, index is the list element index, zero-based
    {
        if (__AutoComplete[id]['dropdown'].childNodes[index]) {
            for (var i=0; i<__AutoComplete[id]['dropdown'].childNodes.length; ++i) {
                if (__AutoComplete[id]['dropdown'].childNodes[i].className == 'autocomplete_item_highlighted') {
                    __AutoComplete[id]['dropdown'].childNodes[i].className = 'autocomplete_item';
                }
            }

            __AutoComplete[id]['dropdown'].childNodes[index].className = 'autocomplete_item_highlighted';
            __AutoComplete[id]['highlighted'] = index;

            //also see below...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[index].innerHTML;
            //AutoComplete_SetValue(id);
        }
    }


    /**
    * Highlights the menu item with the given index
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_Highlight(id, index) // keyboard up/down - index is the direction of travel, 1==down,-1=up
    {
        var childNodes = __AutoComplete[id]['dropdown'].childNodes;
        if(childNodes.length)
        {
	        var lastItem = ( ( childNodes[ childNodes.length - 1 ].className != 'autocomplete_footer' ) ? childNodes.length - 1 : childNodes.length - 2 );

            // Out of bounds checking
            //if (index == 1 && __AutoComplete[id]['highlighted'] == __AutoComplete[id]['dropdown'].childNodes.length - 1) {
            if (index == 1 && __AutoComplete[id]['highlighted'] == lastItem ) {
                childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = null;

            } else if (index == -1 && __AutoComplete[id]['highlighted'] == 0) {
                childNodes[0].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = lastItem;
                index = 0;//hack!
            }

            // Nothing highlighted at the moment
            if (__AutoComplete[id]['highlighted'] == null) {

                childNodes[0].className = 'autocomplete_item_highlighted';
                __AutoComplete[id]['highlighted'] = 0;
                newIndex = 0;
                
            } else {

                if (childNodes[__AutoComplete[id]['highlighted']]) {
                
                    childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                }

                var newIndex = parseInt( __AutoComplete[id]['highlighted'] ) + parseInt(index);

                if (childNodes[newIndex]) {

                    childNodes[newIndex].className = 'autocomplete_item_highlighted';

                    __AutoComplete[id]['highlighted'] = newIndex;
                }
            }

            //populate textbox with currently highlighted term...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[newIndex].innerHTML;
            AutoComplete_SetValue(id);
        }
    }


    /**
    * Sets the input to a given value
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_SetValue(id)
    {
        __AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[__AutoComplete[id]['highlighted']].innerHTML.replace(/&amp;/, "&");
    }


    /**
    * Checks if the dropdown needs scrolling
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ScrollCheck(id)
    {
        // Scroll down, or wrapping around from scroll up
        if (__AutoComplete[id]['highlighted'] > __AutoComplete[id]['lastItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'] - (__AutoComplete[id]['maxitems'] - 1);
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'];
        }

        // Scroll up, or wrapping around from scroll down
        if (__AutoComplete[id]['highlighted'] < __AutoComplete[id]['firstItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'];
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'] + (__AutoComplete[id]['maxitems'] - 1);
        }

        __AutoComplete[id]['dropdown'].scrollTop = __AutoComplete[id]['firstItemShowing'] * 15;
    }


    /**
    * Function which handles the keypress event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyDown(id, e)
    {
        var result = true;

       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {

            // Return/Enter
            case 13:
                if (__AutoComplete[id]['highlighted'] != null) {
                    AutoComplete_SetValue(id);
                    AutoComplete_HideDropdown(id);
					
                    __SLI_asug_used_flag = true;
					
                    if( e = __AutoComplete[id]['element'].form['asug'] )
                    {
                        
                        e.disabled=false;
                        e.value = __AutoComplete[id]['asug'];
                    }

                }

                result = AutoComplete_submitForm(id);

                break;

            // Escape
            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            // Up arrow
            case 38:
                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, -1);
                AutoComplete_ScrollCheck(id, -1);
                
                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                                
                result = false;
                break;

            // Tab
            case 9:
                if (__AutoComplete[id]['isVisible']) {
                    AutoComplete_HideDropdown(id);
                }
                return;

            // Down arrow
            case 40:

                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, 1);
                //AutoComplete_ScrollCheck(id, 1);

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                result = false;
                break;
        }
        return result;
    }


    /**
    * Function which handles the keyup event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyUp(id, e)
    {
       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {
            case 13:
                event.returnValue = false;
                event.cancelBubble = true;
                
                break;

            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            case 38:
            case 40:
                return false;
                break;

            default:
                AutoComplete_ShowDropdown(id);
                
                __AutoComplete[id]['asug']=__AutoComplete[id]['element'].value;

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=true;
                   e.value = "";
                }  
                
                break;
        }
    }

    /**
    * Function which handles the keypress event
    * This function added April 2008 by Andrew Grieve
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */

    // SLI Code Modification - Start - Andrew Grieve April 08
    function AutoComplete_KeyPress(id, e)
    {
        var event = e;
        if(!event) event = window.event;
        var keyCode = event.keyCode;

        if (keyCode == 13 && isGecko || isOpera)
        {
            return false;
        }
        
        if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
        {
            if (keyCode == 13 && isIE)
            {
                return false;
            }
        }
        
    }
    // SLI Code Modification - End

    /**
    * Returns whether the dropdown is visible
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_isVisible(id)
    {
        return __AutoComplete[id]['dropdown'].style.visibility == 'visible';
    }

    function AutoComplete_submitForm(id)
    {
      var e, f, result=true;
      if( f = __AutoComplete[id]['element'].form )
      {
        if( __AutoComplete[id]['element'].value != '' )
        {
          if(__SLI_asug_used_flag == true)
          {
            if( e = f['asug'])
            {
              e.value = __AutoComplete[id]['asug'];
              e.disabled=false;
            }
          }

          if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
          {
            asugvar = "";
            if(__SLI_asug_used_flag == true)
            {
              asugvar = '&asug=' + escape(__AutoComplete[id]['asug']);
            }

            sliRegex = /resultsdemo\.com/;
            if(sliRegExArray = sliRegex.exec(document.domain))
            {
              sliRegex = /^http:\/\/(.*)\//;
              sliTargetDomain = sliRegex.exec(__SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ]);
              __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ].replace(sliTargetDomain[1], document.domain);
            }

            document.location.href = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] + escape(__AutoComplete[id]['element'].value) + asugvar;
          }
          else
          {
            if(f.onsubmit)
            {
              if(f.onsubmit() !== false)
              {
                f.submit();
              }
            }
            else
            {
              f.submit();
            }
          }

          AutoComplete_HideAll();
        }
        else
          result = false;
      }
      return result;
    }
    
    // get the style that will be applied by the browser, including stylesheets
    function sli_getStyle(el,styleProp)
    {
      if (el.currentStyle)
        var y = el.currentStyle[styleProp];
      else if (window.getComputedStyle)
        var y = document.defaultView.getComputedStyle(el,null).getPropertyValue(styleProp);
      return y;
    }

    // register with onLoad(er...
    _sli_init.push( AutoComplete_init );
    
    function sli_addEvent(obj, evType, fn) {
    	if (obj.addEventListener) {
    		obj.addEventListener(evType, fn, false);
    		return true;
    	} else if (obj.attachEvent) {
    		var r = obj.attachEvent("on" + evType, fn);
    		return r;
    	} else {
    		return false;
    	}
    }
    
    function sli_load()
    {
    	sli_addEvent(window, 'load', sli_init);
    }