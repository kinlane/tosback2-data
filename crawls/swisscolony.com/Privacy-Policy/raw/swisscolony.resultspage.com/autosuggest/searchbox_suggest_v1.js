/* Popular phrases - SWISSCOLONY - 18:2:0, Sat Mar 2, 2013 */
__SLI_ClientDefaults =
[
    ['Alignment', 'offsetrelative' ],
	['IE6SelectBox', true ],
    ['ShowBrandingFooter', false ],
];
var asPhrases=new Array ('candy','petit fours','cheesecake','truffles','cheese','easter baskets','sugar free products','ham','sale','easter','fudge','fruit cake','toffee','sugar free','butter toffee','cakes','baklava','cashews','cheese spreads','summer sausage','nuts','jelly beans','red velvet','jelly belly','torte','fruit','cake balls','breakfast','fruitcake','peanut brittle','petit','chocolate truffles','bonbons','chocolate','catalog','coffee','beef jerky','frog','ladybug truffles','incredible spreadables','birthday','lemon','careers','pumpkin','brownies','sweet hot mustard','ladybug','gluten free products','mustard','sausage','pecan','red velvet petit fours','cheese and sausage','petit four flavors','valentines','incredible petits fours','beef log','cheese cake','coconut','bread','butterfly','pistachios','spreadables','frog chocolates','pretzels','wreath','cheese slicer','taffy','macadamia nut chocolate','saltwater taffy','macadamia nuts','chocolate covered cherries','beef','cheese log','fruit slices','gluten free','meat sticks','carrot cake','monkey','oranges','petits fours gift','meat','swiss cheese','happy birthday petit fours','baklava squares','bark','birthday petit fours','mini butter toffee','spreadable cheese','jerky','dark chocolate','spring petit fours','chocolate covered potato chips','baskets','lemon cheesecake','popcorn','chocolate cake','kreme kaese cheese','sausage and cheese bars','chocolate fudge','coconut drops','jelly belly jelly beans','sugar free petits fours','dobosh torte','mixed nuts','free shipping','sticky buns','chocolate covered macadamia nuts','log','lemon petit fours','sampler','27 favorites','spreads','easter candy','sugar free cookies','peanut butter','licorice','spring cookies','cheddar cheese','easter gifts','butter brickle toffee','shipping charges','chihuahua with candy','towers','gummi butterflies','rum balls','beef sticks','cookies in a tin','coconut petits four','dobosh','spring flower tower','strawberry shortcake','mint chocolate','mint','petit fours gift box','chocolate petit fours','elephant','banana foster bonbons','personalized','birthday cakes','chris mouse','gummies','coffee sampler','pillows','trail mix','ham and cheese','sugar free cheesecake','macadamia','cat','shipping','toys','monster cake balls','bee','candy tins','dog','candy sampler','toffee brickle','apple pie','lemon cakes','baby swiss','liqueur','cheese and sausage gift','animal','hummingbird throw','peanut butter and chocolate','easter cakes','sugar free candy','cherries','easter petits fours','jelly belly bin','strawberry daiquiri cheesecake','ice cream cake balls','chocolate covered nuts','zoo','spiral ham','easter candy box','summer sausage logs','pumpkin coffee cake','jumbos','cheddar','liqueur truffles','cocktail jelly belly petit fours','spicy','baby swiss cheese','ice cream','pancake mix','red velvet cake','bugs','chocolate torte','raspberry swirl cake','ladybug chocolates','raspberry','mouse','frog truffle','sugar free truffles','personalized petit fours','shortbread','pecan clusters','elk sticks','happy birthday','caramel pecan clusters','walkers scottie dog shortbread','butterfly throw','petit fors','vanilla petits fours','fruit spread','spring fruit slices','apple pancake mix','caramel apple cheesecake','mustard trio','licorice tin','mint torte','brickle','dog with candy','monkey backpack','breakfast gifts','tablet','rum','personalized hoodie zoo animals','chocolate cherries','dark chocolate truffles','zoo chocolates','hearty breakfast meats','edam cheese','hard candy','bridge mix','fruit cake cookies','stollen','crackers','gummy candy','tea','pralines','throw','chocolate layered mints','brie','strawberry teapot','plush','smores','gel slices','spring candy','carrot cake balls','cajun mix','spring fruit gel slices','spring','christmas fruit cake','strawberry petit fours','caramel','clusters','banana','chihuahua','bakery','sugar free cherry cordials','dips','11 piece personalized bbq tool set','kreme kaese','fudge trio','pecan praline','butter toffee crunch','red velvet cake balls','seafood','almonds','fudge tin','cheese dips','mothers day','classic spring chocolates','coconut cake','cake rolls','fudge assortment','spiral sliced ham','beef sausage and cheese','torte triple','bottle opener','red velvet cheesecake','bavarian bonbons','stuffed animals','pistachios-tin','gingerbread','wild game meat sticks','banana split','smart tablet','peanut butter bites','mint chocolate chip cheesecake','mini cookie bites','pastel coconut petit fours','coffee bark','onion cheese','spiced pumpkins','angel','orange dreamsicle cake','beef and cheese','tea pot','blueberry pecan cookies','watches','little lemon pies','easter lemon cake','florentine lace cookies','caraway cheese','peanut','sugar free jelly bellies','grapefruit','critter treat totes','easter family treats box','sweatshirt','glazed ham','ham links','bunny log','potato','carrot cake petits fours','mini toffee','almond bark','bear','gloves','dutch apple cake','log cake','pjs','fruitcake cookies','coffee cake','double guarantee','petit fours and bonbons','slippers','valencia oranges','jumbo cashews','slices','banana split petite fours','red velvet petits','tin','petite mints','candy sampler trio','sugar free brownies','birthday gifts','favorite five','butter stollen','jelly','wildflower tower','honey creme','butterfly chocolates','shirts','crab delight','family keepsake ornament','apple cheesecake','ham and swiss','puppy dogs','tropical petit fours','cheese sampler','candy fruit slices','chickadee torte','bee and flower','chocolate petit','lounge','hound with candy','chocolate covered mixed nuts','sunshine','crrrisps','fresh flowers','jalapeno','ship to canada','chocolate nuts','no sugar added','strawberry shortcake petit fours','dreamsicle','select mixed nuts','lemon tarts','marble cheese slicer','crrrisps and spreads','apo gifts','teapot','jalapeno beef log','kreme cheese','sugar free coconut','chocolate cake balls','chocolate toffee','gluten free cookies','wildlife bottle opener','cordials','velour pant set','smoked bacon','fruit spread sampler','pepper bacon','malt','72 petit fours','tangerines','muenster','black licorice','western long sleeve tee','crrrrisps','set','graham','totes','hazelnut','moon','tower of treats','snacking favorites','oatmeal cookies','coconut products','baked ham','glasses','peppermint candy bites','valentine chocolates','lace cookies','alarm clock','box towers','apple','jam','holiday blend coffee','breakfast petit fours','sharp cheese','spring brownies','cooking ham','chocolate dobosh','premium nut assortment','plush candy trio','blueberry cookies','ham\'s','cookies and creme','pen','lime petits fours','boneless spiral sliced ham','carrot','wildflower wreath','confetti party bark','9','easter cake trio','telescope','sixlets','no sugar added bread','meat stick bonanza','cajun beef sticks','tropical','petit four samplers','bunny','boneless ham and baby swiss','vintage cheddar cheese','conversation cakelet','bananas foster','strawberry shortcake cheesecake','chocolate chip cookies','angel treasure chest','ancho chili cake balls','chocolate cheese','rocky','vanilla cake','gummy worms','cheesecake bits','baby gifts','onion dip','royal chocolate petits fours','monkey backpack candy','meltaways','pumpkin bark','mini cakes','port wine cheese','cheese bars with slicer','zoo basket trio','monkey chocolate','deep dish apple pie','hound','gift sampler','apple cinnamon pancake mix','smores barks','new products','sugar free peanut butter','lite beef log','strawberry tea service','clocks','port wine cheese spread','colby cheese','mixed nuts with 50% pistachios','treasure chest','gold','nut tins','bavarian','toffee bites','zoo basket','masterpiece baked ham','gummy peach rings','original beef log','petite cakes','bavarian creme torte','pj','nut chocolate mix','honey mustard','daisy wreath','blue cheese','hotline to god','diet candy','breakfast special delivery','western dvd','chocolate easter bunny','party','chickadee basket','pecan swirl','lemon log','hearts','fudge pecan','sea salt chocolates','zoo animals','order','jelly belly petits fours','tiger','chocolate covered pecans','bacon cheese spread','food gifts','red velvet cheese cake','pepperoni','coconut petit','amazing grace clock','scottie','panda','venison sticks','havarti cheese','spiral sliced ham with fired-in sugar glaze','cross watch','cream cheese spreads','pineapple cake','florentine','jelly cake','spice drops','art','giraffe','grill set','peach cheesecake','garden vegetable dip','maple ham links','assorted petit fours','garden vegetable','garden vegetable spread','blueberry cheese','chocolate potato chips','gift of plenty','potato stick candies','mixed nuts tins','spicy cajun sticks','sausage assortment','mini','pc','spring chocolates','apo fpo gifts','shelled pistachio nuts','peanut butter truffles','sugar free taffy','baby doll','vegetable spread','72 mini all occasion petit fours','lion','blueberry','chocolate covered almonds','art sets','orange cake','lily','chocolate pecan fudge','shelled pistachios','french vanilla cheesecake','sugar free trail mix','chocolate gifts','maple','garlic cheese','pumpkin coffee','zigzag','luscious lemon cheesecake','happy easter petit fours','cheese and sausage sampler','angel in personalized treasure chest','14 country favorites','fudge egg','friendship plate','pecan tarts','lovable lapsies','pants','walkers','brick','favorite five cheese bars','nickel','spreadable sampler','candy basket','summer','sugar free gluten free','mens sweaters','dream','fruit gels','peach candy','easter eggs','send catalog','pet\'s','easter bunny torte','heart cake','savory','assorted baklava','ham and bacon','caraway sausage','forest friends log','lemon pies','fruit cake with rum','green','zigzag sweater','sugar','ham and pancakes','sugar free gummy fish','lobster dip','jelly bean tin','family treats box','emoticon chocolates','raccoon log','syrup','spring truffles','bible','chocolate log','john wayne tribute collection','spring pretzels','crab','sugar free petit','buns','my greatest blessings','chocolate hearts','no peanuts','bunny tortes','spring bridge mix','hot and spicy cajun mix','backpack','spring petit','valentine tower','strawberry bark','birthday brownie cookie','eagle hoodie','monster balls','potato sticks','colossal breakfast','apply for credit','nut fruitcake','shipping chart','lime','mix and match','pastel petit fours','strawberry lemon','no shipping','garden vegetable wheel','incredible','caramel pecan swirl','personalized chocolate','spring tower','cakelet','mini glass elephants','inspirational musical clock','sausage and cheese box','red velvet layer cake','carrot spice petit fours','incredible-spreadables','breakfast and coffee','chocolate sampler','deluxe mixed nuts','personalized fudge egg','mini cookies','children','swiss cheese and ham combo','spicy cajun beef sticks','belts','rocky road bonbons','mailbox','grandma birthstone pendant','gluten free almond crunch','swirl','muffins','bunny salt and pepper shakers','breakfast special','valentine cake','box of chocolates','chips covered with chocolate','pancake and ham links','baby swiss wheel','walnut oatmeal pumpkin','rocky road swirl cake','swiss and cheddar log','valentine\'s petit fours','aged swiss','72 petit','bonanza','salt and pepper shakers','natural pecans','inspirational clock','pecan delights','batteries','tiger basket','haystacks','easter boxes tower','chocolate easter card','light up','lamb plush basket','easter nibbles basket','strawberry fudge','butter toffe','winter scene sweatshirt','mustard gift set','jelly belly assortment','valentines day gifts','buffalo','lap','key lime petits fours','easter boxes','sentimental','valentines day petit fours','mint chocolate chip','lamb','baker cheeses','cheese bar and slicer','florentine cookies','peach rings','chocolate-covered potato chips','petit four cake','premium nut','chocolate potato','chocolate with pecans','chick and egg tower','blueberry petit fours','50% off','friends log','snack food bark','peppermint bites','cocktail','smoked cheddar cheese spread','buttery toffee','nut varieties','scottie dog walkers','cheese spread and crackers','gluten free mixes','mom or grandma birthstone pendant','personalized valentine','sugar free macadamia','vintage','winter sweatshirt','sugar free pecan clusters','pepper cheese','lady','soft center','5','valentines day chocolates','chocolate pecan mix','cashews and pecans','roasted pecan','petit four 36','custom','mint chocolate torte','creame de menthe','morsels','can','beans','bright eyes','mint cheesecake','french vanilla bonbons','scottie dog shortbread','sugar free bread','scottish shortbread','sugar-free petite fours','cherry flavored jelly candies','swiss cheese spread','pick and choose','butter crunch','chocolate friend log','layered mints','hot cajun beef sticks','nut clusters','stargazer lily','gifts under $20','pick n choose','sugar free fours','chocolate bites','stargazer','cheddar cheese spread','chocolate chip cookies gluten free','chocolate butter toffee','supple leather','lemon cheese cake','mint chocolate cheesecake','bbq set','cremes','filled cookies','smiling monkeys','roast','shaker','cutting','sugar free fruitful delight','my','valentine mailbox','creamy cheddar','hot','sugar free candy tin','butter mints','cheddar cheese spreadable','wild meat sticks','chocolate covered cashews','apple cinnamon pancake','christmas fruitcake','pans','bacon cheddar','favorite five tortes','bread mix','buffalo nickel dream catcher pendant','valentine fudge','chocolate heart cake','big baby','bars','binoculars','cashews almonds pecans brazils and filberts','toffe bites','bacon cheddar spread','bonbons fours','garlic summer sausage','filbert','peanut clusters','bison sticks','wireless','swiss cheese log','chees board','chocolate lace cookies','creme torte','lucky irish pendant','pepper seasoned bacon','sweet sausage','shipping to apo','tiger and hoodie','retro radio','l','mint-chocolate-torte','gluten free cheese','mild jalapeno','the swiss colony chocolate truffles','spanish peanuts','maple links','spiral sliced ham with fired in sugar glaze','spinach supreme','sharp','sausage n cheese bars gift of 10','sausages-n-cheese','owl family','deluxe','chocolate raisins','butter pecan fudge','when will it be shipped','bacon log','smile','personalized animals','sugar free chocolate pecan fudge','chocolate caramel and pecans','bison meat stick','smiley','bread gift of 9','fresh oranges','seafood incredible spreadables gift of 5','five sausage gift','swiss chees','chocolate fudge petit four','sausage n cheese bars gift of 4','chocolate bars','triple chocolate torte','swiss and ham cheese spread','orange bread','cheese ingredients','brazil','maple flavored ham links','spiral-sliced-ham','sugar free sale','swiss bacon','sugar-free cheesecake','french onion','11 piece bbq set','food tower','covered macadamia nuts','sugar free chocolate cover','strawberry daiquiri','breakfast breads','trio of classic candy samplers','bacon cheese log','chocolatey potato chips','phone to god','sausages n cheese bars gift of 9','chris card','stone','colby cheese and summer sausage','shoe shine','red rind muenster','sweet basket','chocolate with nuts','special delivery','filbert creme','shrimp scampi','fruity','sugar free tower','beef log with mustard','big logs','chocolate nut tin','mixed nuts 50 pistachio','chocolate torte cake','boneless-ham','marble board slicer','petit f','christmas log with raccoon','salted nuts','mini-butter-toffee','sweet and hot spreadables','five','boxes of six','serving','sugar free holiday tower','santa jellies','crystal initial pendant','send a gift','swiss roll','crab spread','maple ham','sugar free merry christmas petits fours','petit ours','merry','chocolate buttons','sausage gift','spinach','boneless smoked ham','cheese sausage mustard','bone ham','mint dobosh torte','glaze','six','mixed chocolates','candy slices','chees logs','chocolate sample','front five','merry christmas petit','cheese sausage torte gift samplers','cheese-cake','spiral','baby swiss and red cheddar','chris mouse pleaser','gift of 7','shoe shine kit','tin of pecans','smokey cheddar','macadamia nut fruitcake','petit four gift samplers','cheese trio','two sweet','mini gift boxes','chocolate lovers','cheese sausage torte','forest cake','beef log gift of 6','maple sausage','pers giraffe hoodie','chees spread','mini butter toffe','chocolate cookies','cheddar logs','silver','sausage and chees','big red and swiss','sau','mouse cards','petit four tree','must','sweet bread','bars in logs','forest log','trio candy','genuine buffalo nickel dream catcher pendant','bacon smoked cheese spread','chocolate raspberry jellies','fire ham','cheese sets','six gift sampler','custard','the big ones','big baby swiss','cheese sausage and petit fours','chocolate mint cake','sausage and petit fours','cheese gift box','port wine cheese logs','bacon cheddar cheese spread','pj s','bu','pers pet carrier','cut rock','sugar free christmas','sugar free pecan','swiss colony beef log','chocolate christmas mouse','chocolate trio','sausage and cheese tower','small tin','fired in ham','projector alarm clock','colossal','merry christmas chocolate','medley','case','chocolate grahams','masterpiece','crab cheese','chocolate covered cake','butter-toffee','chocolate bonbons','fruit nut breads and cremes gift of 7','swiss and sausage','sugar free fish','take five','sale postpaid','premium','gift of 72 petit fours','bible phone','cheese and fruit gifts','by christmas','#2 cheeses','personalized pet carrier','cheese box','sugar glazed ham','sugar free slices','chocolate tower','lucky irish','chocolate raccoon','baby swiss postpaid','swiss colony 27','temperature','sugar free gummies','shrimp cheese','holiday cakes','special blend coffee','cheddar pecan','sausage n cheese bars gift of 8','port wine with almonds','two hams','box summer sausage','carees','beef mustard','chocolate and mint logs','horatio','pers angel throw','food assortments','snack size','front','handout','game meat','hole punch','gift of 4 cheese and sausage','bone','cover','strawberry galettes','sugar free nuts','ganache','lil petites','beef summer','sausage and candy','nut trio','guardian treasure chest','coated pretzels','favorite fives cheese','hand decorated holiday cookies','filled','spiral glazed ham','sugar free vanilla cheesecake','soaring eagle fleece','old fashion toffee','chocolate p','triple chocolate','old cookies','gel candy','beef log food gift combo','4 free','hugger','coin pendant','butter truffles','fruit medley','petit fours sugar','chocolate-filled straws','pecan cheese log','wrapped boxes','24 petits','shipping included petit fours','6 gift samplers','cat sweatshirt','heavenly','sugar free raspberry','decorated cookies','cheese tubs');
/* $Revision: 6883 $
 *
 */

if(typeof(_sli_init )!='object'){var _sli_init=new Array();}
if(typeof(sli_init )!='function'){function sli_init(){ for(var x=0;x<_sli_init.length;x++) _sli_init[x]();}}
if(typeof(asPhrases)!='object'){ var asPhrases = new Array(); }
if(typeof(__SLI_customisations)!='object'){var __SLI_customisations = new Object();}
if(typeof(__SLI_ClientDefaults)!='object'){ var __SLI_ClientDefaults=[]; }
if(typeof(__SLI_validSearchBoxes)!='object'){ var __SLI_validSearchBoxes = new Array(); }
if(typeof(__SLI_asug_used_flag)!='object'){ var __SLI_asug_used_flag = false; }
if(typeof(__SLI_width)!='object'){ var __SLI_width = 0; }
if(typeof(sli_targeturl)!='object'){ var sli_targeturl = ""; }


    __AutoComplete = new Object(); //namespace...
    __AutoComplete_mouseMoved=false;

    // Basic UA detection
    isIE = document.all ? true : false;
    isGecko = navigator.userAgent.toLowerCase().indexOf('gecko') != -1;
    isOpera = navigator.userAgent.toLowerCase().indexOf('opera') != -1;

    /* defaults and options */

    var __SLI_ApplicationName = 'AutoSuggest';
        __SLI_customisations[ 'AutoSuggest' ] =
                {
                    'ShowBrandingFooter' : true
                    ,
                    'TextBoxIDPrefix' : 'sli_search_'
                    ,
                    'BrandingFooterImagePath' : 'http://assets.resultspage.com/autosuggest/sli_systems-powered_150_15.gif'
                    ,
                    'BrandingFooterTitleTooltip' : 'AutoSuggest Powered by SLI Systems'
                    ,
                    'DropListMinWidth' : 150
                    ,
                    'MaxListItems' : 10
                    ,
                    'Alignment' : true
                    ,
                    'TextBoxIDCustom' : []
                    ,
                    'ValidSearchBoxes' : false 
                    ,
                    'IE6SelectBox' : false 
                    ,
                    'IE6SelectBoxPadding' : 0
                    ,
                    'TargetURL' : ''
                    ,
                    'IframeAlignment' : false
                    ,
                    'AlignmentBorderBug' : false
                    ,
                    'IE6OnFocus' : false
                };
    /* 0 = keyname, 1 = value */
    for( defaultValuePair in __SLI_ClientDefaults )
    {
        __SLI_customisations[__SLI_ApplicationName][__SLI_ClientDefaults[defaultValuePair][0]]=__SLI_ClientDefaults[defaultValuePair][1];
    }

    /* pre-fetch branding footer image if being used...
     */
    if( __SLI_customisations[ __SLI_ApplicationName ][ 'ShowBrandingFooter' ] )
    {
        
        if(location.protocol == "https:")
        {
            __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ] = __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ].replace(/http:/i, 'https:');
        }
    
        var __AutoCompleteBranding = new Image();
        __AutoCompleteBranding.src=__SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ];
    }


    function AutoComplete_init()
    {
        if(!isOpera)
        {
            var oldonresize=function(){};
            if(typeof(window.onresize)=='function')
                oldonresize = window.onresize;//play nicely with other people's toys
            window.onresize= function(){ oldonresize(); AutoComplete_HideAll(); AutoComplete_Create( asPhrases ); }

            AutoComplete_Create( asPhrases );
            
            var els = document.getElementsByTagName('input');
            if(els)
            {
               for ( i = 0; i < els.length; i++ )
               {
                  if(els[i].name == "asug")
                  {
                     els[i].disabled = true;
                  }
               }
            }
        }
    }




    /**
    * Attachs the autocomplete object to a form element. Sets
    * onkeypress event on the form element.
    *
    * @param string formElement Name of form element to attach to
    * @param array  data        Array of strings of which to use as the autocomplete data
    */
    //function AutoComplete_Create (id, data)
    /*
     * iterate over 'sli_search_*' assumes one or more search boxes numbered from 1...
    */
    function AutoComplete_Create( data )
    {
        var idx=1, e, id, searchBoxPrefix=__SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDPrefix' ];
        while( e = document.getElementById(searchBoxPrefix+idx) )
        {
            AutoComplete_AttachHandlers(e, data);
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
                __SLI_validSearchBoxes.push(searchBoxPrefix+idx);
            }
            idx++;
        }
        
        
        //this array comes from the customised list
        var otherTextBoxIdList = __SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDCustom' ];
        if( otherTextBoxIdList)
        {
            for(idx=0;idx<otherTextBoxIdList.length;idx++)
            {
                e = document.getElementById(otherTextBoxIdList[idx]);
                if(e)
				{
					if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
                	{
	                    __SLI_validSearchBoxes.push( otherTextBoxIdList[idx] );
                	}
					AutoComplete_AttachHandlers(e, data);
				}
            }
        }
        
    } 

    function AutoComplete_AttachHandlers(e, data){
        var iframe,id;
        id=e.id;


        __AutoComplete[id] = {'data':data,
                              'isVisible':false,
                              'element':document.getElementById(id),
                              'dropdown':null,
                              'highlighted':null};

        __AutoComplete[id]['element'].setAttribute('autocomplete', 'off');
        __AutoComplete[id]['element'].onkeydown = function(e) {if (!e) e = window.event; return AutoComplete_KeyDown(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onkeyup = function(e) {if (!e) e = window.event; return AutoComplete_KeyUp(this.getAttribute('id'), e);}
        // The function call on the next line was changed by Andrew Grieve April 2008
        __AutoComplete[id]['element'].onkeypress = function(e) {if (!e) e = window.event; return AutoComplete_KeyPress(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onclick = function(e)
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6OnFocus' ] )
            {
                __AutoComplete[id]['element'].focus();
            }
            if (!e) e = window.event; e.cancelBubble = true; e.returnValue = false;
        }



        // Hides the dropdowns when document clicked
        var docClick = function()
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
            }
            else
            {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
            }
        }

        if (document.addEventListener) {
            document.addEventListener('click', docClick, false);
        } else if (document.attachEvent) {
            document.attachEvent('onclick', docClick, false);
        }


        // Max number of items shown at once
        if (arguments[2] != null) {
            __AutoComplete[id]['maxitems'] = arguments[2];
            __AutoComplete[id]['firstItemShowing'] = 0;
            __AutoComplete[id]['lastItemShowing'] = arguments[2] - 1;
        }

        AutoComplete_CreateDropdown(id);

        // Prevent select dropdowns showing thru
        if (isIE) {
            iframe = document.createElement('iframe');
            __AutoComplete[id]['iframe'] = iframe;
                iframe.id = id +'_iframe';
                iframe.style.position = 'absolute';
                iframe.style.top = '0';
                iframe.style.left = '0';
                iframe.style.width = '0px';
                iframe.style.height = '0px';
                iframe.style.zIndex = '98';
                iframe.style.visibility = 'hidden';
                
                if(location.protocol == "https:")
                {
                   iframe.src = 'https://assets.resultspage.com/autosuggest/blank.html';
                }
                
                if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBox' ] )
                {
                  iframe.style.width = __SLI_width  + __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBoxPadding'];
                }

            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IframeAlignment' ] )
            {
                document.body.insertBefore( iframe );
            }
            else
            {
                __AutoComplete[id]['element'].parentNode.insertBefore( iframe, __AutoComplete[id]['element'] );
            }
        }
    }

    /**
    * Creates the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_CreateDropdown(id)
    {
        var theSearchbox = __AutoComplete[id]['element'];
        var theDropDown;
        var left_top = AutoComplete_getPos( theSearchbox );
        var left  = left_top[0];
        var top   = left_top[1] + theSearchbox.offsetHeight;
        var width = theSearchbox.offsetWidth;

        if ( width < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
        {
            width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
        }

        theDropDown = document.createElement('div');
        theDropDown.className = 'autocomplete'; // Don't use setAttribute()


        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true && document.body)
        {
            theDropDown.style.position = 'absolute';
            document.body.insertBefore(theDropDown, document.body.nextSibling);
            
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        else if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "offsetrelative" && document.body)
        {
          theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
          // Position it
          if(sli_getStyle(theSearchbox.offsetParent, 'position') != "absolute")
          {
            theSearchbox.offsetParent.style.position = 'relative';
          }
          theDropDown.style.position = 'absolute';
          theDropDown.style.left = (theSearchbox.offsetLeft) + 'px';
          theDropDown.style.top = (theSearchbox.offsetTop + theSearchbox.offsetHeight) + 'px';
          if ( theSearchbox.clientWidth < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
          {
            theDropDown.style.width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
          }
          else
          {
            theDropDown.style.width = (theSearchbox.clientWidth) + 'px';
          }
          theDropDown.style.visibility = 'hidden';
          theDropDown.style.zIndex     = '99999999';
        }
        else
        {
            theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        

        __AutoComplete[id]['dropdown'] = theDropDown;
        __SLI_width = width;
    }

    function /* array [ left, top ] */ AutoComplete_getPos( obj )
    {
        var curleft = curtop = 0;
        var sli_flag = 0;

        if (obj.offsetParent)
        {
           do
           {
              if ( __SLI_customisations[ __SLI_ApplicationName ][ 'AlignmentBorderBug' ] )
              {         
                
                if(sli_flag == 1)
                {
                    var clientTop = (obj.offsetHeight - obj.clientHeight) / 2;
                    curtop += clientTop;

                    var clientLeft = (obj.offsetWidth - obj.clientWidth) / 2;
                    curleft += clientLeft;
                }
                sli_flag = 1;
              }
           
              curleft += obj.offsetLeft;
              curtop += obj.offsetTop;
           }
           while (obj = obj.offsetParent);
        }
        return [curleft,curtop];
    }

    /**
    * Shows the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ShowDropdown(id)
    {

        AutoComplete_HideAll();



        var value = __AutoComplete[id]['element'].value;
        var toDisplay = new Array();
        var newDiv    = null;
        var text      = null;
        var numItems  = __AutoComplete[id]['dropdown'].childNodes.length;

        __AutoComplete_mouseMoved=false;
        // SLI Code Modification - Start - Andrew Grieve April 08
        // Trim the textbox so that if is starts with a space then the feature will still work
        //value = value.replace(/^\s+|\s+$/g,"");
        value = value.replace(/^\s+/g,"");

        if(value.length == "")
        {
            // If Textbox length is nothing (after the trim) then don't show dropdown.
            return;
        }
        // SLI Code Modification - End

        // Remove all child nodes from dropdown
        while (__AutoComplete[id]['dropdown'].childNodes.length > 0) {
            __AutoComplete[id]['dropdown'].removeChild(__AutoComplete[id]['dropdown'].childNodes[0]);
        }


        var count=0;
        // Go thru data searching for matches
        for (i=0; i<__AutoComplete[id]['data'].length; ++i)
        {
            // SLI Code Modification - Start - Andrew Grieve April 08 - Added lower casing
            if (__AutoComplete[id]['data'][i].substr(0, value.length).toLowerCase() == value.toLowerCase())
            {
                // SLI Code Modification - End
                toDisplay[toDisplay.length] = __AutoComplete[id]['data'][i];
                count++;
                /* how many to display? */
                if(count == __SLI_customisations['AutoSuggest']['MaxListItems'] ) /* Code inserted to keep list to a maximum of 10 values (was 20 or 30) */
                {
                    break;
                }
            }
        }

        // No matches?
        if (toDisplay.length == 0) {
            AutoComplete_HideDropdown(id);
            return;
        }



        // Add data to the dropdown layer
        for (i=0; i<toDisplay.length; ++i) {
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_item'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';

             // Scrollbars are on display ?
            if (toDisplay.length > __AutoComplete[id]['maxitems'] && navigator.userAgent.indexOf('MSIE') == -1) {
                newDiv.style.width = __AutoComplete[id]['element'].offsetWidth - 22 + 'px';
            }

            newDiv.onmouseover =
        function()
        {
            if( __AutoComplete_mouseMoved )
                AutoComplete_HighlightItem(__AutoComplete[id]['element'].getAttribute('id'), this.getAttribute('index'));
        };

            newDiv.onclick     =    function()
                                    {
                                    	  __SLI_asug_used_flag = true;
                                                                           
                                        AutoComplete_SetValue(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_HideDropdown(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_submitForm(id);
                                    }



            text   = document.createTextNode(toDisplay[i]);
            newDiv.appendChild(text);
            newDiv.title='Search for ' + toDisplay[i];

            /* ellipsis for IE only */
            if( isIE )
            {
                newDiv.style.textOverflow = 'ellipsis';
                newDiv.style.width = '100%';
                newDiv.style.whiteSpace = 'nowrap';
                newDiv.style.overflow = 'hidden';

            }
            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }
        /*
         * append DIV containing footer branding...
         */
        if(__SLI_customisations['AutoSuggest']['ShowBrandingFooter'])
        {
            i = toDisplay.length;
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_footer'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';
            newDiv.innerHTML = '<a href="http://www.sli-systems.com/powered-by.php" title="' +
                                __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterTitleTooltip' ] +
                                '"><img class="autocomplete_footer_branding" src="'+__AutoCompleteBranding.src+'" /></a>';

            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }


        // Too many items?
        if (toDisplay.length > __AutoComplete[id]['maxitems']) {
            __AutoComplete[id]['dropdown'].style.height = (__AutoComplete[id]['maxitems'] * 15) + 2 + 'px';

        } else {
            __AutoComplete[id]['dropdown'].style.height = '';
        }


        /**
        * Set left/top in case of document movement/scroll/window resize etc
        */
        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "true" || __SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "false")
        {
            var left_top = AutoComplete_getPos( __AutoComplete[id]['element'] );
            __AutoComplete[id]['dropdown'].style.left = left_top[0];
            __AutoComplete[id]['dropdown'].style.top  = left_top[1] + __AutoComplete[id]['element'].offsetHeight;
        }


        // Show the iframe for IE
        if (isIE) {
            
            if(!__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true)
            {
               __AutoComplete[id]['iframe'].style.width  = __AutoComplete[id]['dropdown'].offsetWidth;
            }
            
            
            __AutoComplete[id]['iframe'].style.top    = __AutoComplete[id]['dropdown'].style.top;
            __AutoComplete[id]['iframe'].style.left   = __AutoComplete[id]['dropdown'].style.left;
            __AutoComplete[id]['iframe'].style.height = __AutoComplete[id]['dropdown'].offsetHeight;

            __AutoComplete[id]['iframe'].style.visibility = 'visible';
        }

    e =  __AutoComplete[id]['dropdown'];

    e.onmousemove =
        function()
        {
            if(!__AutoComplete_mouseMoved){__AutoComplete_mouseMoved=true;}
            this.onmousemove = null;
        }

        // Show dropdown
        if (!__AutoComplete[id]['isVisible']) {
            __AutoComplete[id]['dropdown'].style.visibility = 'visible';
            __AutoComplete[id]['isVisible'] = true;
        }


        // If now showing less items than before, reset the highlighted value
        if (__AutoComplete[id]['dropdown'].childNodes.length != numItems) {
            __AutoComplete[id]['highlighted'] = null;
        }
    }



    /**
    * Hides the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_HideDropdown(id)
    {
        if (__AutoComplete[id]['iframe'])
        {
            __AutoComplete[id]['iframe'].style.visibility = 'hidden';
        }
        
        if (__AutoComplete[id]['dropdown'])
        {
            __AutoComplete[id]['dropdown'].style.visibility = 'hidden';
        }

        __AutoComplete[id]['highlighted'] = null;
        __AutoComplete[id]['isVisible']   = false;
    }


    /**
    * Hides all dropdowns
    */
    function AutoComplete_HideAll()
    {
         if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
         {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
         }
         else
         {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
         }
    }


    /**
    * Highlights a specific item
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_HighlightItem(id, index) // mouseover, index is the list element index, zero-based
    {
        if (__AutoComplete[id]['dropdown'].childNodes[index]) {
            for (var i=0; i<__AutoComplete[id]['dropdown'].childNodes.length; ++i) {
                if (__AutoComplete[id]['dropdown'].childNodes[i].className == 'autocomplete_item_highlighted') {
                    __AutoComplete[id]['dropdown'].childNodes[i].className = 'autocomplete_item';
                }
            }

            __AutoComplete[id]['dropdown'].childNodes[index].className = 'autocomplete_item_highlighted';
            __AutoComplete[id]['highlighted'] = index;

            //also see below...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[index].innerHTML;
            //AutoComplete_SetValue(id);
        }
    }


    /**
    * Highlights the menu item with the given index
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_Highlight(id, index) // keyboard up/down - index is the direction of travel, 1==down,-1=up
    {
        var childNodes = __AutoComplete[id]['dropdown'].childNodes;
        if(childNodes.length)
        {
	        var lastItem = ( ( childNodes[ childNodes.length - 1 ].className != 'autocomplete_footer' ) ? childNodes.length - 1 : childNodes.length - 2 );

            // Out of bounds checking
            //if (index == 1 && __AutoComplete[id]['highlighted'] == __AutoComplete[id]['dropdown'].childNodes.length - 1) {
            if (index == 1 && __AutoComplete[id]['highlighted'] == lastItem ) {
                childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = null;

            } else if (index == -1 && __AutoComplete[id]['highlighted'] == 0) {
                childNodes[0].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = lastItem;
                index = 0;//hack!
            }

            // Nothing highlighted at the moment
            if (__AutoComplete[id]['highlighted'] == null) {

                childNodes[0].className = 'autocomplete_item_highlighted';
                __AutoComplete[id]['highlighted'] = 0;
                newIndex = 0;
                
            } else {

                if (childNodes[__AutoComplete[id]['highlighted']]) {
                
                    childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                }

                var newIndex = parseInt( __AutoComplete[id]['highlighted'] ) + parseInt(index);

                if (childNodes[newIndex]) {

                    childNodes[newIndex].className = 'autocomplete_item_highlighted';

                    __AutoComplete[id]['highlighted'] = newIndex;
                }
            }

            //populate textbox with currently highlighted term...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[newIndex].innerHTML;
            AutoComplete_SetValue(id);
        }
    }


    /**
    * Sets the input to a given value
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_SetValue(id)
    {
        __AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[__AutoComplete[id]['highlighted']].innerHTML.replace(/&amp;/, "&");
    }


    /**
    * Checks if the dropdown needs scrolling
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ScrollCheck(id)
    {
        // Scroll down, or wrapping around from scroll up
        if (__AutoComplete[id]['highlighted'] > __AutoComplete[id]['lastItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'] - (__AutoComplete[id]['maxitems'] - 1);
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'];
        }

        // Scroll up, or wrapping around from scroll down
        if (__AutoComplete[id]['highlighted'] < __AutoComplete[id]['firstItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'];
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'] + (__AutoComplete[id]['maxitems'] - 1);
        }

        __AutoComplete[id]['dropdown'].scrollTop = __AutoComplete[id]['firstItemShowing'] * 15;
    }


    /**
    * Function which handles the keypress event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyDown(id, e)
    {
        var result = true;

       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {

            // Return/Enter
            case 13:
                if (__AutoComplete[id]['highlighted'] != null) {
                    AutoComplete_SetValue(id);
                    AutoComplete_HideDropdown(id);
					
                    __SLI_asug_used_flag = true;
					
                    if( e = __AutoComplete[id]['element'].form['asug'] )
                    {
                        
                        e.disabled=false;
                        e.value = __AutoComplete[id]['asug'];
                    }

                }

                result = AutoComplete_submitForm(id);

                break;

            // Escape
            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            // Up arrow
            case 38:
                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, -1);
                AutoComplete_ScrollCheck(id, -1);
                
                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                                
                result = false;
                break;

            // Tab
            case 9:
                if (__AutoComplete[id]['isVisible']) {
                    AutoComplete_HideDropdown(id);
                }
                return;

            // Down arrow
            case 40:

                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, 1);
                //AutoComplete_ScrollCheck(id, 1);

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                result = false;
                break;
        }
        return result;
    }


    /**
    * Function which handles the keyup event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyUp(id, e)
    {
       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {
            case 13:
                event.returnValue = false;
                event.cancelBubble = true;
                
                break;

            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            case 38:
            case 40:
                return false;
                break;

            default:
                AutoComplete_ShowDropdown(id);
                
                __AutoComplete[id]['asug']=__AutoComplete[id]['element'].value;

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=true;
                   e.value = "";
                }  
                
                break;
        }
    }

    /**
    * Function which handles the keypress event
    * This function added April 2008 by Andrew Grieve
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */

    // SLI Code Modification - Start - Andrew Grieve April 08
    function AutoComplete_KeyPress(id, e)
    {
        var event = e;
        if(!event) event = window.event;
        var keyCode = event.keyCode;

        if (keyCode == 13 && isGecko || isOpera)
        {
            return false;
        }
        
        if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
        {
            if (keyCode == 13 && isIE)
            {
                return false;
            }
        }
        
    }
    // SLI Code Modification - End

    /**
    * Returns whether the dropdown is visible
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_isVisible(id)
    {
        return __AutoComplete[id]['dropdown'].style.visibility == 'visible';
    }

    function AutoComplete_submitForm(id)
    {
      var e, f, result=true;
      if( f = __AutoComplete[id]['element'].form )
      {
        if( __AutoComplete[id]['element'].value != '' )
        {
          if(__SLI_asug_used_flag == true)
          {
            if( e = f['asug'])
            {
              e.value = __AutoComplete[id]['asug'];
              e.disabled=false;
            }
          }

          if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
          {
            asugvar = "";
            if(__SLI_asug_used_flag == true)
            {
              asugvar = '&asug=' + escape(__AutoComplete[id]['asug']);
            }

            sliRegex = /resultsdemo\.com/;
            if(sliRegExArray = sliRegex.exec(document.domain))
            {
              sliRegex = /^http:\/\/(.*)\//;
              sliTargetDomain = sliRegex.exec(__SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ]);
              __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ].replace(sliTargetDomain[1], document.domain);
            }

            document.location.href = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] + escape(__AutoComplete[id]['element'].value) + asugvar;
          }
          else
          {
            if(f.onsubmit)
            {
              if(f.onsubmit() !== false)
              {
                f.submit();
              }
            }
            else
            {
              f.submit();
            }
          }

          AutoComplete_HideAll();
        }
        else
          result = false;
      }
      return result;
    }
    
    // get the style that will be applied by the browser, including stylesheets
    function sli_getStyle(el,styleProp)
    {
      if (el.currentStyle)
        var y = el.currentStyle[styleProp];
      else if (window.getComputedStyle)
        var y = document.defaultView.getComputedStyle(el,null).getPropertyValue(styleProp);
      return y;
    }

    // register with onLoad(er...
    _sli_init.push( AutoComplete_init );
    
    function sli_addEvent(obj, evType, fn) {
    	if (obj.addEventListener) {
    		obj.addEventListener(evType, fn, false);
    		return true;
    	} else if (obj.attachEvent) {
    		var r = obj.attachEvent("on" + evType, fn);
    		return r;
    	} else {
    		return false;
    	}
    }
    
    function sli_load()
    {
    	sli_addEvent(window, 'load', sli_init);
    }