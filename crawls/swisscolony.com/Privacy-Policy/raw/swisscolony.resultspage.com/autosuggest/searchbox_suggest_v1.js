/* Popular phrases - SWISSCOLONY - 22:13:46, Wed Oct 31, 2012 */
__SLI_ClientDefaults =
[
    ['Alignment', 'offsetrelative' ],
	['IE6SelectBox', true ],
    ['ShowBrandingFooter', false ],
];
var asPhrases=new Array ('sale','chocolate','petit fours','cheesecake','ham','cheese','catalog','fudge','fruit cake','baklava','pumpkin','nuts','sugar free','truffles','cookies','sugar free products','breakfast','toffee','cakes','incredible spreadables','torte','halloween','butter toffee','petit four sale','toys','fruitcake','spreadables','coffee','cashews','dobosh torte','macadamia nut chocolate','beef log','cheese spreads','sampler','popcorn','red velvet petit fours','red velvet','brownies','best seller assortment','candy','bonbons','careers','spiced pumpkins','coconut','postpaid','mixed nuts','pecan','summer sausage','gingerbread house','chris mouse','popcorn tins','pistachios','smart tablet','cheese log','postpaid gifts','cake balls','fruit','petit','towers','meat sticks','spreads','cheese and sausage','sausage','meat','divinity','shipping charges','chocolate covered potato chips','peppermint bark','pretzels','bread','fruit slices','pumpkin spice cake','jumbos','chocolate truffles','log cake','swiss cheese','mustard','peanut brittle','watches','postpaid petit fours','kreme kaese','27 favorites','rum balls','beef jerky','sweater','incredible petits fours','coconut drops','dobosh','fruit trays','fudge trio','baby swiss cheese','mouse','carrot cake','sweatshirt','coffee sampler','crackers','bacon','stollen','licorice','petit four flavors','personalized gifts','angel','christmas breakfast','santa torte','cheese cake','sausage and cheese bars','mini butter toffee','coconut petits four','gift sampler','christmas petit fours','holiday high notes','chocolate covered cherries','mint','chocolate petit fours','jewelry','torte cake','beef','ornaments','ham\'s','pistachio nuts','tablet','florentine lace cookies','pralines','macaroons','crisps','precious moments','caramel pecan clusters','liqueur','apple pie','spreadable cheese','shipping','mustard trio','mp3 player','coconut macaroons','sugar free petits fours','log','cheddar cheese','raspberry cheesecake','slippers','sweet hot mustard','pecan tarts','43 season pleasers','liqueur truffles','coffee cake','sugar free cookies','crrrisps','jerky','family keepsake ornament','favorite five','personalized','fleece jacket','dark chocolate','gluten free','gourmet brownies','forest friends log','telescope','cheesecake bites','macadamia','potato chips','spiral ham','jelly belly','jelly beans','jacket','cheese slicer','ho ho ho tower','82 all time favorites','purse','fruit spread','mint torte','apple','beef sticks','breakfast special delivery','baby swiss','gift towers','petit fours and bonbons','pumpkin coffee cake','holiday treasure','32 holiday favorites','high 5','brie','peanut butter','zoo chocolates','lace cookies','cookie tin','ham and cheese','pendant','winking santa torte','wardrobe of watches','personized zoo animals','summer sausage and cheese','macadamia nuts','dried fruit tray','pecan praline','gifts for her','cheesecake morsels','crisps and spreadables','harvest petits fours','santa snack tin','bark','german chocolate cheese cake','dolls','halloween gifts','fruitcake cookies','dips','holiday cookies','pies','cherries','taffy','caramel apple cheesecake','gingerbread','jelly belly jelly beans','fudge brownie puffs','pancakes','26 holiday favorites','pumpkin bark','jumbo cashews','blue cheese','nut assortment','christmas gifts','cheese gifts','pets','men','dried fruit','robe','angel in personalized treasure chest','merry christmas petit fours','pumpkin cake','gluten free products','carrot cake petits fours','jam','chocolate pretzels','bavarian creme torte','chips','halloween cookies','deep dish caramel apple pie','polar pals trio','candy bark','shortbread','candles','venison','bon bons','jalapeno beef log','tin','royal chocolate petits fours','coffe','christmas candy','sweet surprises basket','old fashion christmas candy','spiral honey ham','chocolate covered macadamia nuts','bavarian','coffee creme sticks','incredible spreadables samplers','pecan clusters','muk luks','chocolate cake','angel fleece throw','dobosh cakes','lounge sets','cheese and meat','holiday breakfast','bridge mix','lemon petit fours','beef log sausage','cat','ham and baby swiss','holiday favorites','unsalted nuts','favorites','heater fan defroster','christmas cookies','colossal breakfast','giraffe','wallet','breakfast meats','gift of plenty','galileo thermometer','sticky buns','baklava desserts','petit four samplers','five sausage gift','caramel apple pie','fruit cake medley','gift sets','reindeer food','sharp cheddar','special someone name pendant','pastries','bear','mini toffee','throw','vest','red velvet cheese cake','premium nut assortment','sausage logs','chocolate layered mints','cardinal','underwater fantasy aquarium','chocolate cherries','angel treasure chest','elephant','pet beds','john wayne','brownie puffs','buffalo plaid fleece jacket','red velvet cake','blueberry','caramel pecan','clocks','peanut butter bites','pet carrier','velour set','harvest fruit tray','gingerbread spice cookies','butter brickle toffee','wild game meat sticks','high five','licorice mix','jalapeno peanut brittle','fleece','fire glazed ham','ribbon candy','lite beef log','fruit cake cookies','bananas foster','old fashioned fudge trio','mint chocolate','rum','fish','cajun sticks','mini petit fours','blankets','caramel pecan swirl','german chocolate cheesecake','26 surefire','chocolate mouse','spiral sliced ham','holibars','fruit and nut breads','shortbread cookies','snowman truffles','tower full of joys','christmas tower','seafood spreadables','eggnog','gloves','aquarium','holiday fruit tray','peanut butter and chocolate','hearty breakfast meats','beef and cheese','brickle','snow shield','cranberry cheese','14 country favorites','snowman','82 all-time favorites','oranges','red velvet petits','caramel','lemon','leapfrog','blueberry pecan cookies','petit four gift samplers','howling wolf throw','baked ham','butterfly music box','chocolate potato chips','cheddar','breakfast petit fours','sugarfree','peanut','order','cheesecake tarts','traditional','gingerboy cakes','peppermint','snowman melts','brittle','helicopter','macadamia nut patties','mixed nut sampler','holi bars','slicer','galettes','cardinal pjs','games','raccoon','mint dobosh torte','dvds','santa','bbq set','heated ice scraper','bread gift of 9','eyeball truffles','sugar free brownies','dog bed','boucle sweater coat','wolf','snowflake cake','tools','santas 78 favorites','meat and cheese gift','flashlights','vintage cheddar','wildlife knife set','fall','swiss','coconut cake','smores barks','summer sausage logs','jumbo cheese trio','special gift samplers','mini tower','stone ground mustard','cookie sampler','lovable lapsies','19 smile makers','holi-bars','sugar free candy','dates','incredible spreads','snack time special','traditional candies','creme de menthe torte','remote control','count draw by leapfrog','mp3','port wine cheddar','knife set','sketch set','coconut bars','sausage n cheese','zoo','beeflog','dobosh torte postpaid','72 mini all occasion petit fours','6 mini towers','meat stick bonanza','mint chocolate torte','fruitful delight','saltwater taffy','40 holiday favorites','christmas cake','holiday pretzel trio','tumble buggies','snowglobe','toffe','baby doll with 7 outfits','original beef log','gifts for him','rugulach','free offers','mango salsa cheese spread','chocolate fudge','pretzel trio','fall petit fours','forest friends','coffee bark','honey creme','boneless ham and baby swiss','cheese board slicer','chocolate chip','sandscape','tree','butter cookies','carrot cake cream torte','pillows','chocolate covered nuts','banana foster bonbons','pen','precious moments throw','pecan log','streusel swirl coffee cake','angel figurine','classic candy assortment','hotline','festive favorites','velour lounge set','snowflake bear','mom or grandma birthstone','smart','season pleasers','hot and spicy cajun mix','personalized fleece robe','chocolate santa cards','christmas collection','white cheddar','stollen cake','apple cheese cake','trail mix','hummingbird','raspberry','sugar free peanut brittle','colossal mixed nuts','petit fours bonbons assortments','prayer animal','bavarian bonbons','dark chocolate truffles','walkers shortbread','colby cheese','boneless ham','almonds','decanter set','sugar free cheese cake','plates','can opener','mini baklava assortment','pepper bacon','pumpkin cheesecake','21 season highlights','pet lovers sweatshirt','coffee sticks','postpaid christmas breakfast','sherpa','grill','chris mouse magical pleasers','daughter throw','lobster spread','christmas divinity','ultimate snack mix','crunchy crrrisps','gift of 6','sno-shield','licorice tin','hot mustard','faux sherpa lined flannel shirt','butter stollen','personalized wildlife knife set','colby','camo','port wine','holiday mints','big red cheddar','monster truck','chocolate covered','postpaid breakfast','coins','dog','holiday cardinal tower','fudge tin','bowls','postpaid breakfast special delivery','fruit cookies','boneless spiral sliced ham','bowling set','snow globe','thermometer','front five favorites','24 petits fours','pancake and ham links','blueberry cookies','owl','zoo animals','old fashion butter toffee','seafood logs','cooking ham','old fashioned candy','garden vegetable dip','macadamia fruit cake','carrot','snack tin','florentine','32 holiday','petite cakes','wolf throws','decanter','jelly belly gift assortment','gift of 8','chocolate candy','macadamia chocolates','chair covers','defroster heater','wheel of cheese','all time favorites','canadian bacon','fruit nut breads and cremes','no sugar added fruit cake','glasses','petit fors','15 holiday favorites','chocolate covered chips','cheese cake bites','mango','pumpkin cookies','handbags','mummy cupcakes','bars and logs','eggnog fluff','baskets','triple berry cheese cake','bonanza','dobosh bonbons','clusters','chris','ham and swiss','glass elephant','honey ham','sausage n cheese bar','snowmen','scottie','blueberry cheesecake','chocolate pecan','wine','select mixed nuts','pepperoni','toffee crunch','rocky road','candle collection','incredible spreadables seafood','gift of 4','1 lb sausages','gifts sale','assortment','crystal initial angel pendant','treasure chest','kitty hammock','cat hammock','jumbo cheeses','fruit and nut delights','fleece.jacket','crack','bottle opener','trio of classic candy samplers','friendship plate','christmas log','marble cheese board slicer','vanilla petits fours','lamp','apple cake','rollover pets','plate and holder','mini','cardinal tower','cranberry','wireless mouse','lucy','wild game meats','trio of treats','baklava mini postpaid','radio','fruitcake medley','tapestry throw','dvd','art sets','chocolate pecan mix','seafood','fours','sugar free chocolatey potato chips','birthstone pendant','tower full of joy','coats','jumbo cheese and sausage','grooming kit','fleece throw','wild game sticks','smoked','raccoon cake','pj','lounge','pick and choose','ancho chili balls','personalized angel fleece throw','classic candy samplers','7 piece decanter set and big red cheddar','mouse cards','seafood cheese logs','gifts for kids','postpaid sausage','ham cured','pineapple fruitcake','garden vegetable spread','bubble vest','garden vegetable herb garden wheel','cranberry cheddar','macadamia clusters','11 piece bbq tool set','santa\'s snacks tin','lighted angel','best sellers','daughter','pers fleece robe','vintage cheddar cheese','spreadables with crunchy crisp','coin counting valet','cajun mix','breakfast breads','handmade fudge','life celebration','assorted chocolates','white petit fours','lucy a legacy of laughter','kreme cheese','snowman blanket hugger','box','gift assortments','cross','remote control helicopter','gingerbread cookies','maple walnut','cheese dips','personalized bear','nut chocolate mix','holiday cookie sampler','mirror','swirl','raspberry torte','candy santas and trees','camo sleeve buck sweatshirt','rocky road bonbons','harvest','winter scene sweatshirt','cookies and cream','garlic sausage','bison','cake bites','monkey','lucky irish coin','white chocolate','crab dip','shop christmas','toffee popcorn','banana nut','carrot cake creme torte','raisins','wallet n watch money clip','harvest tray','cakelet','all petit fours','snowflake velour set','apo shipping','sharp cheese','sweet hot','halloween bear','m','cheese and nuts','8 gb mp3 player','spread your wings pendant','keepsake ornament','sugar free cheesecake tarts','family keepsake','ice scraper','personalized flask and wine tool set','smokey cheddar','guardian angel','chili','cinnamon rugulach','witch log','harvest fruit','shrimp','heater','cheese bars','raspberry cookies','hats','mint cake','wolf pocket watch','christmas treats','top','irish','rechargeable lantern','personalized blanket','cream torte','furry frame','incredible petit fours sampler','baby clothes','customer favorites','christmas butter','lapsies','daughter tapestry','house','sugar','gift tins','brownie bars','pink blanket','hoodie','chocolate creams','halloween witch','spicy cajun beef sticks','cheese cake tarts','fruit spread sampler','apple cinnamon','garden vegetable','petite holiday mints','black cat and pumpkin pillow','wings','peppermint patties','chocolate covered macadamia','crab cheese dip','big baby swiss cheese','sausage n cheese bars gift of 10','shoe shine kit','moccasin','halloween playcakes','angel throw','jumping clock','deer','angel figurine charms','no sugar added trail mix','chocolate cheese','desserts','fruity and white cheddars','milk chocolate','cheese popcorn','aged cheddar','no sugar candy','snowflake','usb heating cooling mini fridge','santa and trees','cinnamon swirl','fruit petit fours','plaid shirt','christmas petit fors','merry','postpaid mouse','vegetable spread','swiss log','postpaid holibars','set','chris mouse chocolate','maple sugar','carry all','berry cheesecake','turquoise','precious moments ornament','lighted christmas musical snowglobe','beef strips','friend','christmas fruit cake','ultimate tv western','confetti party bark','orangutan','diet','hummingbird egg','watch radio and pen set','hammock','2 piece pet bed','stix','butter toffe','li\'l baby swiss','chocolate covered butter toffee','pocket watch','wildlife wallet','chocolate torte','soothing sandscape','sugar free coconut','cheese and crackers','garlic beef log','rubber watch','forest','cat pillow','desk lamp','pet lovers','personalized oval pendant','port','dog tag','walnut oatmeal pumpkin cookies','suede slipper','chocolate basket','sugar free tarts','butter brickle','no sugar added vanilla cheesecake','gift of 10','milk chocolate covered macadamia nuts','zoo basket trio','mini snack','cheese bar and slicer','maple bacon','kreme','friends gift','sugar free chocolate candy','reindeer','gaming console','ripcord helicopter','red velvet layer cake','lobster','interchangeable 10 charms jewelry','wolf watch','postpaid cheese','cake trio','72','scottie dogs','sugar free gourmet brownies','grandma','flask','car heater and defroster','meat strip','walkers','chocolate pecan fudge','toffee brickle','sugar free chocolate pecan fudge','polar fleece','french vanilla bonbons','43','dutch apple cake','halloween witch log','walker shortbread cookies','log roll','fishing rod','slippers muk luks','ham and swiss spread','b','gluten free sugar free','gingerboy','old fashion','apple cinnamon pancake','wildlife','marble slicer','banana cake','childrens toys','peace','chocolate eyeball truffles','tire gauge','all sale','sale toys','sharp','butter toffee crunch','wreath','no sugar','sauces','fruit gels','extra smokey','beef log gift combo','no sugar cookies','dress up phone','defroster','cross watch','wild','filbert creme','hotline to god','marshmallow','incredible spreadables with crunchy crisps','incredible','chocolate log','belts','stainless steel jewelry','eyeball','vanilla','peppermint chocolate','fruit and nut mix','french creams','inspirational clock','old fashion christmas','marble cheese','fishing set','compressor','cross pendant','wisconsin cheddar spreads','game sticks','cheese sampler','country ham','pocket scarf','ham and bacon','lemon bread','banana bread','garlic summer sausage','crystal ballpoint pen','favorite five tortes','sketch','spicy cajun mix','crafting tool','filbert','postpaid festive favorites','garden vegetable wheel','valet','windshield protector','20 holiday favorites','leather gloves','cowboys','bison sticks','denim','bakery','scottie shortbreads','mens lounge set','spring fruit slices gift tin','barbecue','carrot cake petits','birthstone','christmas butter stollen','set of 2 ripcord helicopters','guarantee','holiday stollen','holiday petits fours','new','gummies','men\'s fleece pants','cordials','snack time','deep dish caramel','prayer','strawberry cheesecake','cheddar baby swiss','flavored cheese','car defroster','gifts under 10','tower of joy','snack','swirl coffee cake','red velvet cheesecake','wisconsin','everyones favorites','french vanilla cheesecake','light up toolbox','windshield','pecan cheese','sugar free holiday cookies','fans','coconut snowballs','lemon bark','winking santa','ornament server and spread','art','polar','swiss colony christmas','grandchildren','all occasion','pants','ham links','cheese board','gift boxes','cajun beef sticks','skeleton truffles','eagle hoodie','all sugar free products','garlic','mango salsa','musical hummingbird egg','set of 7 mini glass elephants','gift of 9','led','45','loaf','jelly rings','chocolate toffe','hot','lobster log','2','air compressor','glass set','crafting tool kit','moon wolves tee','angel pendant','lady luxury suede scuff','amazing grace clock','82','eggs','spice','edam cheese','men\'s sherpa jacket','syrup','black','almond petit fours','mini all occasion petits fours','carrot petit','cat beds','flannel shirt','ornament server','deep dish caramel pie','cards','cardinal sweater','toffe brickle','sliced ham','creme torte','swiss roll','men\'s shirt','berries','breakfast and coffee','fancy nuts','leather','raspberry filled candy','creature cake','usb light','15','cheese torte','swiss chocolate','smoked ham','honey','hangman','drill','garden vegetable cheese','spice cake','angel in treasure chest','wax','forest log','personalized snowman blanket hugger','15 holiday','peanut butter filled','petit fours and bon bons','11 treat triumph','lined flannel shirt','holiday blend coffee','bavarian torte','cheddar cheese logs','trio','wildlife knit hat','balls','pineapple','strawberry lemon bark','cinnamon pecans','well mannered','amazing grace','mummy','sugar free mix','nut cake','link bracelet','dark chocolate covered cherries','reed diffuser set','chees slicer','lol rollover pets','cheese logs and sausage','butter toffee gift samplers','mini peanut butter cups','custard','winged lighted angel','4 gb mp3 player','big baby swiss','christmas taffy','27 holiday favorites','5 sausage','audio bible','salsa','hard cheese','trick or treat petit fours','what is postpaid','remote monster truck','78 piece art set','all chocolate petit fours','led light','silver belle velour lounge set','animal','well-mannered doll','fpo','chocolate raspberry','lace','trimmer','alarm clock','no sugar added cheesecake','personalized knife set','spiral','shrimp scampi','dutch apple','crystal pen','personalized sketch set 106-pieces','electronic audio bible','almonds chocolate','christmas torte','chees logs','playcakes','set of 2 tumble buggies','creamy swiss','postpaid baklava','delight','deer fleece','horatio cable sweater','royal chocolate','seafood dips','cat sweatshirt','harvest petit','gifts for pets','mix and match','life\'s celebrations plate and holder','6 sampler','coffe beans','cheddar cheese spreadable','trio of chocolate samplers','in-shell pistachios-tin','barnyard','personalized robe','spring fruit gel','on sale','wildlife hat','big cheese','scottie dog walkers','flashlight tool kit','food gifts','pop','lion chocolates','vanilla fudge','french onion','mellow cheddar','leather carry all','frames','hot sauce','chocolate dobosh','dress','sweet and savory','garden','for kids','shoe shine','angel fleece','double chocolate torte','favorite five sausages','postpaid merry christmas petits fours','double chocolate','sail','crunchy','inspirational musical clock','triple','all star','chocolate brownie cookies','wild game beef sticks','story stix','five','plenty','name pendant','led lamp','carrier','santa\'s favorite','smoked bacon','electronic hangman','11','owl family figurine','sugarfree cheesecake','3 tortes','candy santa','sugar free cherries','sugar free chocolate potato chips','canned ham','sugar free holiday mix','an','color set','cat throw','caraway beef log','hearty breakfast','layer','sugar free fruit nut delight','cheese assortment','tumble','red rind muenster','caramel apple cheese cake','leather purse','beef long','bear and cookies','carrot spice','beef log combo','snowballs','personalized angel throw','sugar free chocolate fudge','walnut cake','drops','sweet and hot spreadables','personalized treasure chest','cash','mousse','postpaid dobosh','plaque','mini butter','sweets','spring cookie gift assortment','sno shield windshield protector','collectibles','star','summer','postpaid truffles','cheese wax','bats','sweet mustard','movies','christmas candies samplers','chees spread','chocolate lollipops','holiday bars','bible verses','chocolate layer cake','ceramic','cream','christmas dinner','cheese\'s','sweet cheese','big logs','batteries','brazil','cheese and candy','swiss and ham cheese spread','$40');
/* $Revision: 6883 $
 *
 */

if(typeof(_sli_init )!='object'){var _sli_init=new Array();}
if(typeof(sli_init )!='function'){function sli_init(){ for(var x=0;x<_sli_init.length;x++) _sli_init[x]();}}
if(typeof(asPhrases)!='object'){ var asPhrases = new Array(); }
if(typeof(__SLI_customisations)!='object'){var __SLI_customisations = new Object();}
if(typeof(__SLI_ClientDefaults)!='object'){ var __SLI_ClientDefaults=[]; }
if(typeof(__SLI_validSearchBoxes)!='object'){ var __SLI_validSearchBoxes = new Array(); }
if(typeof(__SLI_asug_used_flag)!='object'){ var __SLI_asug_used_flag = false; }
if(typeof(__SLI_width)!='object'){ var __SLI_width = 0; }
if(typeof(sli_targeturl)!='object'){ var sli_targeturl = ""; }


    __AutoComplete = new Object(); //namespace...
    __AutoComplete_mouseMoved=false;

    // Basic UA detection
    isIE = document.all ? true : false;
    isGecko = navigator.userAgent.toLowerCase().indexOf('gecko') != -1;
    isOpera = navigator.userAgent.toLowerCase().indexOf('opera') != -1;

    /* defaults and options */

    var __SLI_ApplicationName = 'AutoSuggest';
        __SLI_customisations[ 'AutoSuggest' ] =
                {
                    'ShowBrandingFooter' : true
                    ,
                    'TextBoxIDPrefix' : 'sli_search_'
                    ,
                    'BrandingFooterImagePath' : 'http://assets.resultspage.com/autosuggest/sli_systems-powered_150_15.gif'
                    ,
                    'BrandingFooterTitleTooltip' : 'AutoSuggest Powered by SLI Systems'
                    ,
                    'DropListMinWidth' : 150
                    ,
                    'MaxListItems' : 10
                    ,
                    'Alignment' : true
                    ,
                    'TextBoxIDCustom' : []
                    ,
                    'ValidSearchBoxes' : false 
                    ,
                    'IE6SelectBox' : false 
                    ,
                    'IE6SelectBoxPadding' : 0
                    ,
                    'TargetURL' : ''
                    ,
                    'IframeAlignment' : false
                    ,
                    'AlignmentBorderBug' : false
                    ,
                    'IE6OnFocus' : false
                };
    /* 0 = keyname, 1 = value */
    for( defaultValuePair in __SLI_ClientDefaults )
    {
        __SLI_customisations[__SLI_ApplicationName][__SLI_ClientDefaults[defaultValuePair][0]]=__SLI_ClientDefaults[defaultValuePair][1];
    }

    /* pre-fetch branding footer image if being used...
     */
    if( __SLI_customisations[ __SLI_ApplicationName ][ 'ShowBrandingFooter' ] )
    {
        
        if(location.protocol == "https:")
        {
            __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ] = __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ].replace(/http:/i, 'https:');
        }
    
        var __AutoCompleteBranding = new Image();
        __AutoCompleteBranding.src=__SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ];
    }


    function AutoComplete_init()
    {
        if(!isOpera)
        {
            var oldonresize=function(){};
            if(typeof(window.onresize)=='function')
                oldonresize = window.onresize;//play nicely with other people's toys
            window.onresize= function(){ oldonresize(); AutoComplete_HideAll(); AutoComplete_Create( asPhrases ); }

            AutoComplete_Create( asPhrases );
            
            var els = document.getElementsByTagName('input');
            if(els)
            {
               for ( i = 0; i < els.length; i++ )
               {
                  if(els[i].name == "asug")
                  {
                     els[i].disabled = true;
                  }
               }
            }
        }
    }




    /**
    * Attachs the autocomplete object to a form element. Sets
    * onkeypress event on the form element.
    *
    * @param string formElement Name of form element to attach to
    * @param array  data        Array of strings of which to use as the autocomplete data
    */
    //function AutoComplete_Create (id, data)
    /*
     * iterate over 'sli_search_*' assumes one or more search boxes numbered from 1...
    */
    function AutoComplete_Create( data )
    {
        var idx=1, e, id, searchBoxPrefix=__SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDPrefix' ];
        while( e = document.getElementById(searchBoxPrefix+idx) )
        {
            AutoComplete_AttachHandlers(e, data);
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
                __SLI_validSearchBoxes.push(searchBoxPrefix+idx);
            }
            idx++;
        }
        
        
        //this array comes from the customised list
        var otherTextBoxIdList = __SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDCustom' ];
        if( otherTextBoxIdList)
        {
            for(idx=0;idx<otherTextBoxIdList.length;idx++)
            {
                e = document.getElementById(otherTextBoxIdList[idx]);
                if(e)
				{
					if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
                	{
	                    __SLI_validSearchBoxes.push( otherTextBoxIdList[idx] );
                	}
					AutoComplete_AttachHandlers(e, data);
				}
            }
        }
        
    } 

    function AutoComplete_AttachHandlers(e, data){
        var iframe,id;
        id=e.id;


        __AutoComplete[id] = {'data':data,
                              'isVisible':false,
                              'element':document.getElementById(id),
                              'dropdown':null,
                              'highlighted':null};

        __AutoComplete[id]['element'].setAttribute('autocomplete', 'off');
        __AutoComplete[id]['element'].onkeydown = function(e) {if (!e) e = window.event; return AutoComplete_KeyDown(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onkeyup = function(e) {if (!e) e = window.event; return AutoComplete_KeyUp(this.getAttribute('id'), e);}
        // The function call on the next line was changed by Andrew Grieve April 2008
        __AutoComplete[id]['element'].onkeypress = function(e) {if (!e) e = window.event; return AutoComplete_KeyPress(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onclick = function(e)
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6OnFocus' ] )
            {
                __AutoComplete[id]['element'].focus();
            }
            if (!e) e = window.event; e.cancelBubble = true; e.returnValue = false;
        }



        // Hides the dropdowns when document clicked
        var docClick = function()
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
            }
            else
            {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
            }
        }

        if (document.addEventListener) {
            document.addEventListener('click', docClick, false);
        } else if (document.attachEvent) {
            document.attachEvent('onclick', docClick, false);
        }


        // Max number of items shown at once
        if (arguments[2] != null) {
            __AutoComplete[id]['maxitems'] = arguments[2];
            __AutoComplete[id]['firstItemShowing'] = 0;
            __AutoComplete[id]['lastItemShowing'] = arguments[2] - 1;
        }

        AutoComplete_CreateDropdown(id);

        // Prevent select dropdowns showing thru
        if (isIE) {
            iframe = document.createElement('iframe');
            __AutoComplete[id]['iframe'] = iframe;
                iframe.id = id +'_iframe';
                iframe.style.position = 'absolute';
                iframe.style.top = '0';
                iframe.style.left = '0';
                iframe.style.width = '0px';
                iframe.style.height = '0px';
                iframe.style.zIndex = '98';
                iframe.style.visibility = 'hidden';
                
                if(location.protocol == "https:")
                {
                   iframe.src = 'https://assets.resultspage.com/autosuggest/blank.html';
                }
                
                if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBox' ] )
                {
                  iframe.style.width = __SLI_width  + __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBoxPadding'];
                }

            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IframeAlignment' ] )
            {
                document.body.insertBefore( iframe );
            }
            else
            {
                __AutoComplete[id]['element'].parentNode.insertBefore( iframe, __AutoComplete[id]['element'] );
            }
        }
    }

    /**
    * Creates the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_CreateDropdown(id)
    {
        var theSearchbox = __AutoComplete[id]['element'];
        var theDropDown;
        var left_top = AutoComplete_getPos( theSearchbox );
        var left  = left_top[0];
        var top   = left_top[1] + theSearchbox.offsetHeight;
        var width = theSearchbox.offsetWidth;

        if ( width < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
        {
            width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
        }

        theDropDown = document.createElement('div');
        theDropDown.className = 'autocomplete'; // Don't use setAttribute()


        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true && document.body)
        {
            theDropDown.style.position = 'absolute';
            document.body.insertBefore(theDropDown, document.body.nextSibling);
            
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        else if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "offsetrelative" && document.body)
        {
          theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
          // Position it
          if(sli_getStyle(theSearchbox.offsetParent, 'position') != "absolute")
          {
            theSearchbox.offsetParent.style.position = 'relative';
          }
          theDropDown.style.position = 'absolute';
          theDropDown.style.left = (theSearchbox.offsetLeft) + 'px';
          theDropDown.style.top = (theSearchbox.offsetTop + theSearchbox.offsetHeight) + 'px';
          if ( theSearchbox.clientWidth < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
          {
            theDropDown.style.width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
          }
          else
          {
            theDropDown.style.width = (theSearchbox.clientWidth) + 'px';
          }
          theDropDown.style.visibility = 'hidden';
          theDropDown.style.zIndex     = '99999999';
        }
        else
        {
            theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        

        __AutoComplete[id]['dropdown'] = theDropDown;
        __SLI_width = width;
    }

    function /* array [ left, top ] */ AutoComplete_getPos( obj )
    {
        var curleft = curtop = 0;
        var sli_flag = 0;

        if (obj.offsetParent)
        {
           do
           {
              if ( __SLI_customisations[ __SLI_ApplicationName ][ 'AlignmentBorderBug' ] )
              {         
                
                if(sli_flag == 1)
                {
                    var clientTop = (obj.offsetHeight - obj.clientHeight) / 2;
                    curtop += clientTop;

                    var clientLeft = (obj.offsetWidth - obj.clientWidth) / 2;
                    curleft += clientLeft;
                }
                sli_flag = 1;
              }
           
              curleft += obj.offsetLeft;
              curtop += obj.offsetTop;
           }
           while (obj = obj.offsetParent);
        }
        return [curleft,curtop];
    }

    /**
    * Shows the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ShowDropdown(id)
    {

        AutoComplete_HideAll();



        var value = __AutoComplete[id]['element'].value;
        var toDisplay = new Array();
        var newDiv    = null;
        var text      = null;
        var numItems  = __AutoComplete[id]['dropdown'].childNodes.length;

        __AutoComplete_mouseMoved=false;
        // SLI Code Modification - Start - Andrew Grieve April 08
        // Trim the textbox so that if is starts with a space then the feature will still work
        //value = value.replace(/^\s+|\s+$/g,"");
        value = value.replace(/^\s+/g,"");

        if(value.length == "")
        {
            // If Textbox length is nothing (after the trim) then don't show dropdown.
            return;
        }
        // SLI Code Modification - End

        // Remove all child nodes from dropdown
        while (__AutoComplete[id]['dropdown'].childNodes.length > 0) {
            __AutoComplete[id]['dropdown'].removeChild(__AutoComplete[id]['dropdown'].childNodes[0]);
        }


        var count=0;
        // Go thru data searching for matches
        for (i=0; i<__AutoComplete[id]['data'].length; ++i)
        {
            // SLI Code Modification - Start - Andrew Grieve April 08 - Added lower casing
            if (__AutoComplete[id]['data'][i].substr(0, value.length).toLowerCase() == value.toLowerCase())
            {
                // SLI Code Modification - End
                toDisplay[toDisplay.length] = __AutoComplete[id]['data'][i];
                count++;
                /* how many to display? */
                if(count == __SLI_customisations['AutoSuggest']['MaxListItems'] ) /* Code inserted to keep list to a maximum of 10 values (was 20 or 30) */
                {
                    break;
                }
            }
        }

        // No matches?
        if (toDisplay.length == 0) {
            AutoComplete_HideDropdown(id);
            return;
        }



        // Add data to the dropdown layer
        for (i=0; i<toDisplay.length; ++i) {
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_item'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';

             // Scrollbars are on display ?
            if (toDisplay.length > __AutoComplete[id]['maxitems'] && navigator.userAgent.indexOf('MSIE') == -1) {
                newDiv.style.width = __AutoComplete[id]['element'].offsetWidth - 22 + 'px';
            }

            newDiv.onmouseover =
        function()
        {
            if( __AutoComplete_mouseMoved )
                AutoComplete_HighlightItem(__AutoComplete[id]['element'].getAttribute('id'), this.getAttribute('index'));
        };

            newDiv.onclick     =    function()
                                    {
                                    	  __SLI_asug_used_flag = true;
                                                                           
                                        AutoComplete_SetValue(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_HideDropdown(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_submitForm(id);
                                    }



            text   = document.createTextNode(toDisplay[i]);
            newDiv.appendChild(text);
            newDiv.title='Search for ' + toDisplay[i];

            /* ellipsis for IE only */
            if( isIE )
            {
                newDiv.style.textOverflow = 'ellipsis';
                newDiv.style.width = '100%';
                newDiv.style.whiteSpace = 'nowrap';
                newDiv.style.overflow = 'hidden';

            }
            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }
        /*
         * append DIV containing footer branding...
         */
        if(__SLI_customisations['AutoSuggest']['ShowBrandingFooter'])
        {
            i = toDisplay.length;
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_footer'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';
            newDiv.innerHTML = '<a href="http://www.sli-systems.com/powered-by.php" title="' +
                                __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterTitleTooltip' ] +
                                '"><img class="autocomplete_footer_branding" src="'+__AutoCompleteBranding.src+'" /></a>';

            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }


        // Too many items?
        if (toDisplay.length > __AutoComplete[id]['maxitems']) {
            __AutoComplete[id]['dropdown'].style.height = (__AutoComplete[id]['maxitems'] * 15) + 2 + 'px';

        } else {
            __AutoComplete[id]['dropdown'].style.height = '';
        }


        /**
        * Set left/top in case of document movement/scroll/window resize etc
        */
        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "true" || __SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "false")
        {
            var left_top = AutoComplete_getPos( __AutoComplete[id]['element'] );
            __AutoComplete[id]['dropdown'].style.left = left_top[0];
            __AutoComplete[id]['dropdown'].style.top  = left_top[1] + __AutoComplete[id]['element'].offsetHeight;
        }


        // Show the iframe for IE
        if (isIE) {
            
            if(!__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true)
            {
               __AutoComplete[id]['iframe'].style.width  = __AutoComplete[id]['dropdown'].offsetWidth;
            }
            
            
            __AutoComplete[id]['iframe'].style.top    = __AutoComplete[id]['dropdown'].style.top;
            __AutoComplete[id]['iframe'].style.left   = __AutoComplete[id]['dropdown'].style.left;
            __AutoComplete[id]['iframe'].style.height = __AutoComplete[id]['dropdown'].offsetHeight;

            __AutoComplete[id]['iframe'].style.visibility = 'visible';
        }

    e =  __AutoComplete[id]['dropdown'];

    e.onmousemove =
        function()
        {
            if(!__AutoComplete_mouseMoved){__AutoComplete_mouseMoved=true;}
            this.onmousemove = null;
        }

        // Show dropdown
        if (!__AutoComplete[id]['isVisible']) {
            __AutoComplete[id]['dropdown'].style.visibility = 'visible';
            __AutoComplete[id]['isVisible'] = true;
        }


        // If now showing less items than before, reset the highlighted value
        if (__AutoComplete[id]['dropdown'].childNodes.length != numItems) {
            __AutoComplete[id]['highlighted'] = null;
        }
    }



    /**
    * Hides the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_HideDropdown(id)
    {
        if (__AutoComplete[id]['iframe'])
        {
            __AutoComplete[id]['iframe'].style.visibility = 'hidden';
        }
        
        if (__AutoComplete[id]['dropdown'])
        {
            __AutoComplete[id]['dropdown'].style.visibility = 'hidden';
        }

        __AutoComplete[id]['highlighted'] = null;
        __AutoComplete[id]['isVisible']   = false;
    }


    /**
    * Hides all dropdowns
    */
    function AutoComplete_HideAll()
    {
         if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
         {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
         }
         else
         {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
         }
    }


    /**
    * Highlights a specific item
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_HighlightItem(id, index) // mouseover, index is the list element index, zero-based
    {
        if (__AutoComplete[id]['dropdown'].childNodes[index]) {
            for (var i=0; i<__AutoComplete[id]['dropdown'].childNodes.length; ++i) {
                if (__AutoComplete[id]['dropdown'].childNodes[i].className == 'autocomplete_item_highlighted') {
                    __AutoComplete[id]['dropdown'].childNodes[i].className = 'autocomplete_item';
                }
            }

            __AutoComplete[id]['dropdown'].childNodes[index].className = 'autocomplete_item_highlighted';
            __AutoComplete[id]['highlighted'] = index;

            //also see below...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[index].innerHTML;
            //AutoComplete_SetValue(id);
        }
    }


    /**
    * Highlights the menu item with the given index
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_Highlight(id, index) // keyboard up/down - index is the direction of travel, 1==down,-1=up
    {
        var childNodes = __AutoComplete[id]['dropdown'].childNodes;
        if(childNodes.length)
        {
	        var lastItem = ( ( childNodes[ childNodes.length - 1 ].className != 'autocomplete_footer' ) ? childNodes.length - 1 : childNodes.length - 2 );

            // Out of bounds checking
            //if (index == 1 && __AutoComplete[id]['highlighted'] == __AutoComplete[id]['dropdown'].childNodes.length - 1) {
            if (index == 1 && __AutoComplete[id]['highlighted'] == lastItem ) {
                childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = null;

            } else if (index == -1 && __AutoComplete[id]['highlighted'] == 0) {
                childNodes[0].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = lastItem;
                index = 0;//hack!
            }

            // Nothing highlighted at the moment
            if (__AutoComplete[id]['highlighted'] == null) {

                childNodes[0].className = 'autocomplete_item_highlighted';
                __AutoComplete[id]['highlighted'] = 0;
                newIndex = 0;
                
            } else {

                if (childNodes[__AutoComplete[id]['highlighted']]) {
                
                    childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                }

                var newIndex = parseInt( __AutoComplete[id]['highlighted'] ) + parseInt(index);

                if (childNodes[newIndex]) {

                    childNodes[newIndex].className = 'autocomplete_item_highlighted';

                    __AutoComplete[id]['highlighted'] = newIndex;
                }
            }

            //populate textbox with currently highlighted term...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[newIndex].innerHTML;
            AutoComplete_SetValue(id);
        }
    }


    /**
    * Sets the input to a given value
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_SetValue(id)
    {
        __AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[__AutoComplete[id]['highlighted']].innerHTML.replace(/&amp;/, "&");
    }


    /**
    * Checks if the dropdown needs scrolling
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ScrollCheck(id)
    {
        // Scroll down, or wrapping around from scroll up
        if (__AutoComplete[id]['highlighted'] > __AutoComplete[id]['lastItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'] - (__AutoComplete[id]['maxitems'] - 1);
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'];
        }

        // Scroll up, or wrapping around from scroll down
        if (__AutoComplete[id]['highlighted'] < __AutoComplete[id]['firstItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'];
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'] + (__AutoComplete[id]['maxitems'] - 1);
        }

        __AutoComplete[id]['dropdown'].scrollTop = __AutoComplete[id]['firstItemShowing'] * 15;
    }


    /**
    * Function which handles the keypress event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyDown(id, e)
    {
        var result = true;

       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {

            // Return/Enter
            case 13:
                if (__AutoComplete[id]['highlighted'] != null) {
                    AutoComplete_SetValue(id);
                    AutoComplete_HideDropdown(id);
					
                    __SLI_asug_used_flag = true;
					
                    if( e = __AutoComplete[id]['element'].form['asug'] )
                    {
                        
                        e.disabled=false;
                        e.value = __AutoComplete[id]['asug'];
                    }

                }

                result = AutoComplete_submitForm(id);

                break;

            // Escape
            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            // Up arrow
            case 38:
                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, -1);
                AutoComplete_ScrollCheck(id, -1);
                
                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                                
                result = false;
                break;

            // Tab
            case 9:
                if (__AutoComplete[id]['isVisible']) {
                    AutoComplete_HideDropdown(id);
                }
                return;

            // Down arrow
            case 40:

                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, 1);
                //AutoComplete_ScrollCheck(id, 1);

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                result = false;
                break;
        }
        return result;
    }


    /**
    * Function which handles the keyup event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyUp(id, e)
    {
       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {
            case 13:
                event.returnValue = false;
                event.cancelBubble = true;
                
                break;

            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            case 38:
            case 40:
                return false;
                break;

            default:
                AutoComplete_ShowDropdown(id);
                
                __AutoComplete[id]['asug']=__AutoComplete[id]['element'].value;

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=true;
                   e.value = "";
                }  
                
                break;
        }
    }

    /**
    * Function which handles the keypress event
    * This function added April 2008 by Andrew Grieve
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */

    // SLI Code Modification - Start - Andrew Grieve April 08
    function AutoComplete_KeyPress(id, e)
    {
        var event = e;
        if(!event) event = window.event;
        var keyCode = event.keyCode;

        if (keyCode == 13 && isGecko || isOpera)
        {
            return false;
        }
        
        if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
        {
            if (keyCode == 13 && isIE)
            {
                return false;
            }
        }
        
    }
    // SLI Code Modification - End

    /**
    * Returns whether the dropdown is visible
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_isVisible(id)
    {
        return __AutoComplete[id]['dropdown'].style.visibility == 'visible';
    }

    function AutoComplete_submitForm(id)
    {
      var e, f, result=true;
      if( f = __AutoComplete[id]['element'].form )
      {
        if( __AutoComplete[id]['element'].value != '' )
        {
          if(__SLI_asug_used_flag == true)
          {
            if( e = f['asug'])
            {
              e.value = __AutoComplete[id]['asug'];
              e.disabled=false;
            }
          }

          if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
          {
            asugvar = "";
            if(__SLI_asug_used_flag == true)
            {
              asugvar = '&asug=' + escape(__AutoComplete[id]['asug']);
            }

            sliRegex = /resultsdemo\.com/;
            if(sliRegExArray = sliRegex.exec(document.domain))
            {
              sliRegex = /^http:\/\/(.*)\//;
              sliTargetDomain = sliRegex.exec(__SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ]);
              __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ].replace(sliTargetDomain[1], document.domain);
            }

            document.location.href = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] + escape(__AutoComplete[id]['element'].value) + asugvar;
          }
          else
          {
            if(f.onsubmit)
            {
              if(f.onsubmit() !== false)
              {
                f.submit();
              }
            }
            else
            {
              f.submit();
            }
          }

          AutoComplete_HideAll();
        }
        else
          result = false;
      }
      return result;
    }
    
    // get the style that will be applied by the browser, including stylesheets
    function sli_getStyle(el,styleProp)
    {
      if (el.currentStyle)
        var y = el.currentStyle[styleProp];
      else if (window.getComputedStyle)
        var y = document.defaultView.getComputedStyle(el,null).getPropertyValue(styleProp);
      return y;
    }

    // register with onLoad(er...
    _sli_init.push( AutoComplete_init );
    
    function sli_addEvent(obj, evType, fn) {
    	if (obj.addEventListener) {
    		obj.addEventListener(evType, fn, false);
    		return true;
    	} else if (obj.attachEvent) {
    		var r = obj.attachEvent("on" + evType, fn);
    		return r;
    	} else {
    		return false;
    	}
    }
    
    function sli_load()
    {
    	sli_addEvent(window, 'load', sli_init);
    }