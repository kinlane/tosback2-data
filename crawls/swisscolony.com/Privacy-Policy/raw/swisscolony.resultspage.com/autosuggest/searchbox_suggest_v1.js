/* Popular phrases - SWISSCOLONY - 21:44:57, Fri Sep 28, 2012 */
__SLI_ClientDefaults =
[
    ['Alignment', 'offsetrelative' ],
	['IE6SelectBox', true ],
    ['ShowBrandingFooter', false ],
];
var asPhrases=new Array ('sale','petit fours','cheesecake','chocolate','halloween','ham','fudge','sugar free','baklava','pumpkin','cheese','toffee','cookies','toys','truffles','catalog','careers','breakfast','fruit cake','cakes','nuts','dobosh torte','bonbons','butter toffee','torte','incredible spreadables','fruitcake','red velvet','coconut','cheese spreads','brownies','spreadables','red velvet petit fours','postpaid','sugar free products','best seller assortment','chocolate truffles','summer sausage','beef log','gingerbread house','pretzels','smart tablet','cashews','popcorn','petit','candy','cake balls','pecan','bread','macadamia nut chocolate','sampler','spiced pumpkins','sausage','cheese cake','coffee','bacon','christmas','bark','mp3 player','tablet','cheese log','fruit slices','mixed nuts','swiss cheese','dobosh','taffy','cheese slicer','beef','dips','coconut drops','shipping','cheese and sausage','crackers','jerky','pistachios','carrot cake','mint','cheddar cheese','27 favorites','angel','beef jerky','jacket','peanut brittle','popcorn tins','divinity','coconut petits four','rum balls','slippers','jewelry','sugar free cookies','towers','petit fours and bonbons','personalized gifts','sugar free petits fours','wolf','jelly belly','fruit','mustard','fleece jacket','pumpkin spice cake','cat','mint torte','chocolate covered potato chips','crisps','meat','sweater','brie','coconut bars','candles','wild game meat sticks','caramel apple cheesecake','pumpkin bark','shortbread','macadamia','petit four sale','jumbos','coconut macaroons','personalized','mini butter toffee','chris mouse','mustard trio','pecan tarts','sausage and cheese bars','chocolate covered macadamia nuts','incredible petits fours','dark chocolate','chocolate covered cherries','pumpkin cake','fudge trio','cherries','watches','coconut cake','log','angel treasure chest','ham and cheese','spreads','meat sticks','knife','baby swiss','spreadable cheese','baby swiss cheese','licorice tin','coffee sampler','lace cookies','breakfast meats','halloween petit fours','precious moments','peppermint bark','fruit spread','red velvet cake','mint chocolate','carrot','caramel pecan clusters','breakfast special delivery','chocolate torte','pecan clusters','fudge brownie puffs','wheel of cheese','christmas petit fours','liqueur','gingerbread','potato chips','petit fors','jelly beans','harvest petits fours','blue cheese','christmas breakfast','royal chocolate petits fours','holiday breakfast','fruit and nut breads','crafting tool kit','bananas foster','throw','raspberry cheese cake','petit fours bonbons assortments','red velvet cheese cake','pecan praline','macadamia nuts','german chocolate cheese cake','jumbo cashews','john wayne','reed diffuser set','shipping charges','rum','licorice','aquarium','eagle','men','spiral ham','brownie puffs','ho ho ho tower','sweet hot mustard','pets','marble cheese board slicer','forest friends log','stollen','favorite five','mp3','smores barks','82 all time favorites','heater fan defroster','gaming console','cardinal','handbags','reindeer food','mini tower','glasses','beef sticks','jalapeno beef log','macaroons','tin','zoo chocolates','games','santa\'s snacks tin','fruit trays','robe','gift sampler','winter scene sweatshirt','ornaments','chocolate potato chips','seafood logs','trail mix','raccoon','halloween cookies','florentine lace cookies','lemon','peanut butter','family keepsake ornament','chocolate layered mints','cheesecake morsels','gingerbread spice cookies','pastries','peppermint','sweatshirt','high 5','blueberry','sugar free candy','wallet','apple pie','4 gb mp3 player','holiday cookies','coffee cake','sugar free brownies','holi bars','fruit cake cookies','food','43 season pleasers','pumpkin coffee cake','telescope','pancakes','fish','strawberry','licorice mix','elephant','garlic beef log','seafood','red velvet petits','fruit and nut delights','galettes','pancake mix','fruitful delight','dog bed','chips','jam','friendship plate','sticky buns','peanut butter and chocolate','clocks','gift towers','christmas butter stollen','christmas collection','set of 7 mini glass elephants','mens suede slippers','holiday fruit tray','no sugar added','blueberry cookies','high five','personalized trick or treat bag','candle collection','snowman','crisps and spreadables','florentine','pralines','dried fruit tray','creme de menthe torte','deep dish caramel apple pie','chocolate petit fours','holi-bars','cheesecake tarts','coffee creme sticks','bavarian bonbons','santa torte','snowflake cake','petit four flavors','trick or treat bag','birthstone','mixed nut sampler','snack','personalized throw','breakfast petit fours','butter brickle toffee','prayer animal','eggnog fluff','tools','crrrisps','spreadable sampler','eyeball truffles','24 petits fours','ribbon candy','banana bread','pillows','holiday pretzel trio','holiday high notes','old fashion christmas candy','scottie dogs','christmas cookies','monkey','apple','raspberry','sweet surprises basket','carrot cake balls','streusel swirl coffee cake','caramel pecan swirl','polar pals trio','aged swiss','sno-shield','baby doll','pies','butter toffee crunch','hearty breakfast meats','candy bark','peanut butter bites','best sellers','jalapeno brittle','life\'s celebrations','helicopter','harvest','honey creme','hot and spicy','brick cheese','lite beef log','pen','fleece','raccoon cake','snow globe','carrot cake petits','boucle sweater coat','angel chest','confetti party bark','11','cheesecake bites','cheese gifts','lantern','butterfly','mini petit fours','kitty hammock','festive favorites','personized zoo animals','mini toffee','sausage n cheese','macadamia nut patties','wolves','muenster cheese','baskets','peppermint candy bites','holiday cardinal tower','jelly belly jelly beans','dates','sugarfree','butterfly meadow pjs','zoo','lucy a legacy of laughter','cajun beef sticks','velour set','beef log and cheese','caramel','cheese and meat','oranges','ham and swiss','cajun mix','skeleton truffles','winking santa torte','chocolate pecan fudge','knife set','fruitcake medley','santa cake','hats','bavarian creme torte','clusters','manicure set','camo set','old fashioned fudge trio','white cheddar','fruit spread sampler','musical hummingbird egg','pet carrier','snack time special','decorations','canadian bacon','forest friends cake','zoo animals','halloween playcakes','incredible spreadables samplers','mini','boneless ham','caraway beef log','old fashion butter toffee','wreath','sugar free chocolate pecan fudge','fours','mini cakes trio','sausage logs','moon wolves tee','chocolate fudge','sharp cheddar','mango salsa','almonds','jacquard handbag','womens jacket','mens lounge set','snowman melts','fall petit fours','pjs','underwater fantasy aquarium','moccasin','scuff','pet beds','32 favorites','orange slices','big baby swiss cheese','heater','french vanilla bonbons','hotline','honey mustard','eagle hoodie','smokey cheddar cheese','cheese dips','hotline to god','christmas decorations','brickle','all','bavarian','western dvds','hot chocolate','owl','cheese and crackers','german','scottie','gourmet brownies','cross','dog','ho ho ho','beef log gift combo','men gifts','original beef log','inspirational musical clock','kreme kaese','cinnamon','galileo thermometer','ultimate snack mix','vintage cheddar','lobster','winged lighted angel','wacky duckie','dvds','chocolate cheese','carrot spice','all time favorites','cupcakes','balls','kids','two tone cross pendant','german chocolate','tarts','pumpkin cookies','jewish','port wine cheddar','fruity gels','venison','chocolate covered pretzels','lovable lapsies','bags','li\'l baby swiss','lace','key lime','save','suede scuff','ornament server','seafood dips','velvet cake','scraper','angel figurine charms','tumble buggies','beef log combo','deep dish caramel pie','snowballs','ballpoint pen with personalized case','sugar free chocolate fudge','carrier','french vanilla cheesecake','dobosh cakes','drops','sweet and hot spreadables','orangutan','fantasy aquarium','chocolate pecan','cashew nuts','electronic bible','fruitcake cookies','tasty temptations','lemon petit fours','cake bites','women\'s fleece jacket','witch log','pistachio nuts','supple leather carryall','holiday treasure','bonanza','mouse','slicer','garden vegetable cheese','chocolate cake roll','fleece throw','stix','holiday cookie sampler','72 petit','pocket watch','stick','snowflake bear','chocolate cheesecake','snack tin','stainless steel jewelry','home','ingredients','glass elephant','postpaid petit fours','stuffed animals','cars','shirts','jumbo beef log','sugar free gourmet brownies','crystal initial angel pendant','family banner','spice cookies','chocolate pretzels','garlic beeflog','creme de menthe','harvest fruit','children','apple bread','orange petits','mens jackets','interchangeable watch set','stollen cake','wildlife knife set','wings','wardrobe of watches','no sugar cookies','personalized treasure chest','sketch','slippers muk luks','raspberry cheesecake','spread your wings','cinnamon cake','daughter throw','hickory smoked bacon','ham links','horatio cable sweater','wolf throws','halloween cakes','laffy taffy','postpaid toffee','smart','cash','electronic games','age cheese','lounge pants','trio of chocolate samplers','credit card','howling wolf fleece throw','milk chocolate macadamia nuts','chocolate covered toffee','personalized bear','butterfly music box','treasure chest','camo','caramel apple pie','pumpkin pillow','colossal breakfast','butter','bear','mousse','walkers shortbread','charms','pecan log','chocolate covered nuts','14','chocolate card','covered cherries','radio','cheese board','ham and baby swiss','sugar cookies','rollover pets','jumbo cheese trio','harvest fruit tray','wildlife bottle opener','desserts','crab cheese dip','ancho','swiss','hot sauce','royal chocolate','14 country favorites','chocolate peanuts','sherpa','gift of 8','apple cake','bridge mix','snack mix','strawberry cheese cake','angel pendant','zigzag sweater','mens watches','triple berry cheesecake','heated ice scraper','cardinal pjs','bible','smoked cheddar','angel throw','postpaid dobosh','personalized wildlife knife set','caramel apples','lucy','purse','jalapeno peanut brittle','mirror','vintage cheddar cheese','red velvet cheesecake','swirl','shrimp','lol rollover pets','vegetable dip','christmas chocolate','art 101','boneless spiral sliced ham','heater fan','coffee bark','kreme kaese cheese','edam','chocolate toffee','cat pillow','velvet','story stix','camouflage lounge set','apo','cinnamon rugulach','mini cakes','suede','plaid','cheese board slicer','decanter','red velvet layer cake','beef and cheese','cheese ball','82 all-time favorites','nuts and candy','cashews and pistachio','apple pancake','lemon bread','plaque','interchangeable 10 charms jewelry','lobster spread','fruit candy','mini butter','cake rolls','cat hammock','wild game','recipes','assortment','sweets','jalapeno','sugar free holiday cookies','coins','lobster delight','belts','salmon','spring cookie gift assortment','garden vegetable','meat strip','cranberry cheese','kids toys','snowman tower','trick or treat','fire glazed ham','butter mints','postpaid cheese','tower full of joys','kids gifts','sno shield windshield protector','collectibles','shoes','venison sticks','fragrance','bavarian torte','premium nut assortment','christmas gifts','garlic','blueberry cheese','star','hot mustard','candy sampler','jelly belly gift assortment','saltwater taffy','pink and camo jacket','milk chocolate','chocolate cake balls','defroster','15','petite cakes','scented candles','wild','snowmen','holiday pretzel','western','shelled pistachios','petite mints','sweet halloween pretzels','swiss chocolate','bakery','chocolate candy','sugar free fudge','giraffe','gift of plenty','monkey chocolate','all occasion','handmade fudge','kreme cheese','82 favorites','remote control helicopter','sugar free toffee','exclusive','preserves','smoked bacon','barnyard','sugar free peppermint','carryall supple leather','petit four 36','garlic summer sausage','deer fleece','festive','21 season highlights','sherpa jacket','personalized sketch set 106-pieces','sugar free truffles','sweet hot','glazed ham','santa\'s favorite','special gift samplers','32','faux','postpaid fruitcake','military','santas snack','coffee sticks','sausage n cheese bar','walkers','mini petite','peppermint chocolate bark','chocolate fruit cake','drill','santa cards','chocolate nuts','summer','postpaid truffles','key','cheese wax','ice scraper','sail','coffe cake','sugar free butter toffee','all products','muk luks','christmas tower','forest friends','apple cheesecake','wild game meats','christmas morning breakfast','bats','sweet mustard','all sugar free products','gift assortments','postpaid christmas collection','marshmallow','crumb cake','movies','meat strips gift box','vintage cheese','german chocolate cheesecake','toffee brickle','ranch','sailboat','82','soothing sandscape','plates','creature balls','fudge brownie','mini baklava','banana','holiday mints','owl family figurine','eggs','i love you','candy sampler trio','chocolate pecan mix','cross dog tag','baked ham','tv westerns','wildlife wallet','classic candy','mens slippers','fall gifts','meat stick bonanza','hammock','kitty','christmas candies samplers','decanter set','vanilla petits fours','colby cheese','kiss','vegetable cheese spread','binoculars','angel in chest','chees spread','shaver','camo fleece','gift packages','chocolate covered butter toffee','mummy cupcakes','snowman truffles','size chart','santa tins','front 5 favorites','boneless ham and baby swiss','big red cheddar baby swiss','6 mini towers','velour','rocky road','god','tree','love','cooking ham','black forest','wine opener','kaese','computer mouse','new arrivals','incredible spreadables seafood','incredible','windshield','mini baklava assortment','forest','brazil nuts','live plate','d','wrapped candy','all sizes','harvest petit','treat','coconut fours','led rechargeable lantern','chocolate santa','mango salsa cheese spread','christmas fruitcake','maple walnut fudge','money clip','cheese bars with slicer','chocolate lollipops','onion cheese','snowflake','43','82 all','keepsake','life celebration','dutch apple cake','eyeball','triple chocolate torte','caramel cheesecake','usb','premium','cheese bites','snuggle','holiday bars','f','vanilla cremes','count and draw','snowman blanket hugger','frosty','honey','men\'s fleece pants','watch radio and pen set','sunflower seeds','bible verses','butter rum','graham','dutch','chocolate layer cake','light up toolbox','cocoa','assorted candy','72','oval pendant','fruity and white cheddars','toffe','caramel pecan','for kids','white','hearty breakfast','for her','sausage bread','ceramic','mild jalapeno','cream','dress up phone','fleece robe','elk','wolves tee','wild game sticks','camping lantern','watch mood-dial two-tone stretch','no sugar added fruit cake','christmas dinner','petit f','82 all time','gift shop','cat beds','spicy cajun beef sticks','sugar free trail mix','big baby swiss','candy house','24 petits','mood watch','select mixed nuts','cheese\'s','sno-shield windshield protector','apple cinnamon','port','chocolate dobosh','blueberry cheesecake','chocolate covered peanut butter','country favorites','sweet cheese','walnut oatmeal pumpkin cookies','10','stuffed toys','big logs','strawberry truffles','set of 3 led flashlights','bear with halloween cookies','spread your wings pendant','meat strip gifts','charge','smokehouse','batteries','cheese sampler','sugar free macadamia nut clusters','sugar free fruit cake','bites','special delivery','cheese assortment','everyone\'s favorites','cremes','chees cake','brazil','savory','cheese and candy','postpaid christmas petits fours christmas petits','swiss and ham cheese spread','pancake and ham links','$40','2- piece thermal fleece lounge set','$15');
/* $Revision: 6883 $
 *
 */

if(typeof(_sli_init )!='object'){var _sli_init=new Array();}
if(typeof(sli_init )!='function'){function sli_init(){ for(var x=0;x<_sli_init.length;x++) _sli_init[x]();}}
if(typeof(asPhrases)!='object'){ var asPhrases = new Array(); }
if(typeof(__SLI_customisations)!='object'){var __SLI_customisations = new Object();}
if(typeof(__SLI_ClientDefaults)!='object'){ var __SLI_ClientDefaults=[]; }
if(typeof(__SLI_validSearchBoxes)!='object'){ var __SLI_validSearchBoxes = new Array(); }
if(typeof(__SLI_asug_used_flag)!='object'){ var __SLI_asug_used_flag = false; }
if(typeof(__SLI_width)!='object'){ var __SLI_width = 0; }
if(typeof(sli_targeturl)!='object'){ var sli_targeturl = ""; }


    __AutoComplete = new Object(); //namespace...
    __AutoComplete_mouseMoved=false;

    // Basic UA detection
    isIE = document.all ? true : false;
    isGecko = navigator.userAgent.toLowerCase().indexOf('gecko') != -1;
    isOpera = navigator.userAgent.toLowerCase().indexOf('opera') != -1;

    /* defaults and options */

    var __SLI_ApplicationName = 'AutoSuggest';
        __SLI_customisations[ 'AutoSuggest' ] =
                {
                    'ShowBrandingFooter' : true
                    ,
                    'TextBoxIDPrefix' : 'sli_search_'
                    ,
                    'BrandingFooterImagePath' : 'http://assets.resultspage.com/autosuggest/sli_systems-powered_150_15.gif'
                    ,
                    'BrandingFooterTitleTooltip' : 'AutoSuggest Powered by SLI Systems'
                    ,
                    'DropListMinWidth' : 150
                    ,
                    'MaxListItems' : 10
                    ,
                    'Alignment' : true
                    ,
                    'TextBoxIDCustom' : []
                    ,
                    'ValidSearchBoxes' : false 
                    ,
                    'IE6SelectBox' : false 
                    ,
                    'IE6SelectBoxPadding' : 0
                    ,
                    'TargetURL' : ''
                    ,
                    'IframeAlignment' : false
                    ,
                    'AlignmentBorderBug' : false
                    ,
                    'IE6OnFocus' : false
                };
    /* 0 = keyname, 1 = value */
    for( defaultValuePair in __SLI_ClientDefaults )
    {
        __SLI_customisations[__SLI_ApplicationName][__SLI_ClientDefaults[defaultValuePair][0]]=__SLI_ClientDefaults[defaultValuePair][1];
    }

    /* pre-fetch branding footer image if being used...
     */
    if( __SLI_customisations[ __SLI_ApplicationName ][ 'ShowBrandingFooter' ] )
    {
        
        if(location.protocol == "https:")
        {
            __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ] = __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ].replace(/http:/i, 'https:');
        }
    
        var __AutoCompleteBranding = new Image();
        __AutoCompleteBranding.src=__SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ];
    }


    function AutoComplete_init()
    {
        if(!isOpera)
        {
            var oldonresize=function(){};
            if(typeof(window.onresize)=='function')
                oldonresize = window.onresize;//play nicely with other people's toys
            window.onresize= function(){ oldonresize(); AutoComplete_HideAll(); AutoComplete_Create( asPhrases ); }

            AutoComplete_Create( asPhrases );
            
            var els = document.getElementsByTagName('input');
            if(els)
            {
               for ( i = 0; i < els.length; i++ )
               {
                  if(els[i].name == "asug")
                  {
                     els[i].disabled = true;
                  }
               }
            }
        }
    }




    /**
    * Attachs the autocomplete object to a form element. Sets
    * onkeypress event on the form element.
    *
    * @param string formElement Name of form element to attach to
    * @param array  data        Array of strings of which to use as the autocomplete data
    */
    //function AutoComplete_Create (id, data)
    /*
     * iterate over 'sli_search_*' assumes one or more search boxes numbered from 1...
    */
    function AutoComplete_Create( data )
    {
        var idx=1, e, id, searchBoxPrefix=__SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDPrefix' ];
        while( e = document.getElementById(searchBoxPrefix+idx) )
        {
            AutoComplete_AttachHandlers(e, data);
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
                __SLI_validSearchBoxes.push(searchBoxPrefix+idx);
            }
            idx++;
        }
        
        
        //this array comes from the customised list
        var otherTextBoxIdList = __SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDCustom' ];
        if( otherTextBoxIdList)
        {
            for(idx=0;idx<otherTextBoxIdList.length;idx++)
            {
                e = document.getElementById(otherTextBoxIdList[idx]);
                if(e)
				{
					if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
                	{
	                    __SLI_validSearchBoxes.push( otherTextBoxIdList[idx] );
                	}
					AutoComplete_AttachHandlers(e, data);
				}
            }
        }
        
    } 

    function AutoComplete_AttachHandlers(e, data){
        var iframe,id;
        id=e.id;


        __AutoComplete[id] = {'data':data,
                              'isVisible':false,
                              'element':document.getElementById(id),
                              'dropdown':null,
                              'highlighted':null};

        __AutoComplete[id]['element'].setAttribute('autocomplete', 'off');
        __AutoComplete[id]['element'].onkeydown = function(e) {if (!e) e = window.event; return AutoComplete_KeyDown(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onkeyup = function(e) {if (!e) e = window.event; return AutoComplete_KeyUp(this.getAttribute('id'), e);}
        // The function call on the next line was changed by Andrew Grieve April 2008
        __AutoComplete[id]['element'].onkeypress = function(e) {if (!e) e = window.event; return AutoComplete_KeyPress(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onclick = function(e)
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6OnFocus' ] )
            {
                __AutoComplete[id]['element'].focus();
            }
            if (!e) e = window.event; e.cancelBubble = true; e.returnValue = false;
        }



        // Hides the dropdowns when document clicked
        var docClick = function()
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
            }
            else
            {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
            }
        }

        if (document.addEventListener) {
            document.addEventListener('click', docClick, false);
        } else if (document.attachEvent) {
            document.attachEvent('onclick', docClick, false);
        }


        // Max number of items shown at once
        if (arguments[2] != null) {
            __AutoComplete[id]['maxitems'] = arguments[2];
            __AutoComplete[id]['firstItemShowing'] = 0;
            __AutoComplete[id]['lastItemShowing'] = arguments[2] - 1;
        }

        AutoComplete_CreateDropdown(id);

        // Prevent select dropdowns showing thru
        if (isIE) {
            iframe = document.createElement('iframe');
            __AutoComplete[id]['iframe'] = iframe;
                iframe.id = id +'_iframe';
                iframe.style.position = 'absolute';
                iframe.style.top = '0';
                iframe.style.left = '0';
                iframe.style.width = '0px';
                iframe.style.height = '0px';
                iframe.style.zIndex = '98';
                iframe.style.visibility = 'hidden';
                
                if(location.protocol == "https:")
                {
                   iframe.src = 'https://assets.resultspage.com/autosuggest/blank.html';
                }
                
                if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBox' ] )
                {
                  iframe.style.width = __SLI_width  + __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBoxPadding'];
                }

            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IframeAlignment' ] )
            {
                document.body.insertBefore( iframe );
            }
            else
            {
                __AutoComplete[id]['element'].parentNode.insertBefore( iframe, __AutoComplete[id]['element'] );
            }
        }
    }

    /**
    * Creates the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_CreateDropdown(id)
    {
        var theSearchbox = __AutoComplete[id]['element'];
        var theDropDown;
        var left_top = AutoComplete_getPos( theSearchbox );
        var left  = left_top[0];
        var top   = left_top[1] + theSearchbox.offsetHeight;
        var width = theSearchbox.offsetWidth;

        if ( width < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
        {
            width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
        }

        theDropDown = document.createElement('div');
        theDropDown.className = 'autocomplete'; // Don't use setAttribute()


        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true && document.body)
        {
            theDropDown.style.position = 'absolute';
            document.body.insertBefore(theDropDown, document.body.nextSibling);
            
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        else if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "offsetrelative" && document.body)
        {
          theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
          // Position it
          if(sli_getStyle(theSearchbox.offsetParent, 'position') != "absolute")
          {
            theSearchbox.offsetParent.style.position = 'relative';
          }
          theDropDown.style.position = 'absolute';
          theDropDown.style.left = (theSearchbox.offsetLeft) + 'px';
          theDropDown.style.top = (theSearchbox.offsetTop + theSearchbox.offsetHeight) + 'px';
          if ( theSearchbox.clientWidth < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
          {
            theDropDown.style.width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
          }
          else
          {
            theDropDown.style.width = (theSearchbox.clientWidth) + 'px';
          }
          theDropDown.style.visibility = 'hidden';
          theDropDown.style.zIndex     = '99999999';
        }
        else
        {
            theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        

        __AutoComplete[id]['dropdown'] = theDropDown;
        __SLI_width = width;
    }

    function /* array [ left, top ] */ AutoComplete_getPos( obj )
    {
        var curleft = curtop = 0;
        var sli_flag = 0;

        if (obj.offsetParent)
        {
           do
           {
              if ( __SLI_customisations[ __SLI_ApplicationName ][ 'AlignmentBorderBug' ] )
              {         
                
                if(sli_flag == 1)
                {
                    var clientTop = (obj.offsetHeight - obj.clientHeight) / 2;
                    curtop += clientTop;

                    var clientLeft = (obj.offsetWidth - obj.clientWidth) / 2;
                    curleft += clientLeft;
                }
                sli_flag = 1;
              }
           
              curleft += obj.offsetLeft;
              curtop += obj.offsetTop;
           }
           while (obj = obj.offsetParent);
        }
        return [curleft,curtop];
    }

    /**
    * Shows the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ShowDropdown(id)
    {

        AutoComplete_HideAll();



        var value = __AutoComplete[id]['element'].value;
        var toDisplay = new Array();
        var newDiv    = null;
        var text      = null;
        var numItems  = __AutoComplete[id]['dropdown'].childNodes.length;

        __AutoComplete_mouseMoved=false;
        // SLI Code Modification - Start - Andrew Grieve April 08
        // Trim the textbox so that if is starts with a space then the feature will still work
        //value = value.replace(/^\s+|\s+$/g,"");
        value = value.replace(/^\s+/g,"");

        if(value.length == "")
        {
            // If Textbox length is nothing (after the trim) then don't show dropdown.
            return;
        }
        // SLI Code Modification - End

        // Remove all child nodes from dropdown
        while (__AutoComplete[id]['dropdown'].childNodes.length > 0) {
            __AutoComplete[id]['dropdown'].removeChild(__AutoComplete[id]['dropdown'].childNodes[0]);
        }


        var count=0;
        // Go thru data searching for matches
        for (i=0; i<__AutoComplete[id]['data'].length; ++i)
        {
            // SLI Code Modification - Start - Andrew Grieve April 08 - Added lower casing
            if (__AutoComplete[id]['data'][i].substr(0, value.length).toLowerCase() == value.toLowerCase())
            {
                // SLI Code Modification - End
                toDisplay[toDisplay.length] = __AutoComplete[id]['data'][i];
                count++;
                /* how many to display? */
                if(count == __SLI_customisations['AutoSuggest']['MaxListItems'] ) /* Code inserted to keep list to a maximum of 10 values (was 20 or 30) */
                {
                    break;
                }
            }
        }

        // No matches?
        if (toDisplay.length == 0) {
            AutoComplete_HideDropdown(id);
            return;
        }



        // Add data to the dropdown layer
        for (i=0; i<toDisplay.length; ++i) {
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_item'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';

             // Scrollbars are on display ?
            if (toDisplay.length > __AutoComplete[id]['maxitems'] && navigator.userAgent.indexOf('MSIE') == -1) {
                newDiv.style.width = __AutoComplete[id]['element'].offsetWidth - 22 + 'px';
            }

            newDiv.onmouseover =
        function()
        {
            if( __AutoComplete_mouseMoved )
                AutoComplete_HighlightItem(__AutoComplete[id]['element'].getAttribute('id'), this.getAttribute('index'));
        };

            newDiv.onclick     =    function()
                                    {
                                    	  __SLI_asug_used_flag = true;
                                                                           
                                        AutoComplete_SetValue(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_HideDropdown(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_submitForm(id);
                                    }



            text   = document.createTextNode(toDisplay[i]);
            newDiv.appendChild(text);
            newDiv.title='Search for ' + toDisplay[i];

            /* ellipsis for IE only */
            if( isIE )
            {
                newDiv.style.textOverflow = 'ellipsis';
                newDiv.style.width = '100%';
                newDiv.style.whiteSpace = 'nowrap';
                newDiv.style.overflow = 'hidden';

            }
            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }
        /*
         * append DIV containing footer branding...
         */
        if(__SLI_customisations['AutoSuggest']['ShowBrandingFooter'])
        {
            i = toDisplay.length;
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_footer'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';
            newDiv.innerHTML = '<a href="http://www.sli-systems.com/powered-by.php" title="' +
                                __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterTitleTooltip' ] +
                                '"><img class="autocomplete_footer_branding" src="'+__AutoCompleteBranding.src+'" /></a>';

            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }


        // Too many items?
        if (toDisplay.length > __AutoComplete[id]['maxitems']) {
            __AutoComplete[id]['dropdown'].style.height = (__AutoComplete[id]['maxitems'] * 15) + 2 + 'px';

        } else {
            __AutoComplete[id]['dropdown'].style.height = '';
        }


        /**
        * Set left/top in case of document movement/scroll/window resize etc
        */
        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "true" || __SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "false")
        {
            var left_top = AutoComplete_getPos( __AutoComplete[id]['element'] );
            __AutoComplete[id]['dropdown'].style.left = left_top[0];
            __AutoComplete[id]['dropdown'].style.top  = left_top[1] + __AutoComplete[id]['element'].offsetHeight;
        }


        // Show the iframe for IE
        if (isIE) {
            
            if(!__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true)
            {
               __AutoComplete[id]['iframe'].style.width  = __AutoComplete[id]['dropdown'].offsetWidth;
            }
            
            
            __AutoComplete[id]['iframe'].style.top    = __AutoComplete[id]['dropdown'].style.top;
            __AutoComplete[id]['iframe'].style.left   = __AutoComplete[id]['dropdown'].style.left;
            __AutoComplete[id]['iframe'].style.height = __AutoComplete[id]['dropdown'].offsetHeight;

            __AutoComplete[id]['iframe'].style.visibility = 'visible';
        }

    e =  __AutoComplete[id]['dropdown'];

    e.onmousemove =
        function()
        {
            if(!__AutoComplete_mouseMoved){__AutoComplete_mouseMoved=true;}
            this.onmousemove = null;
        }

        // Show dropdown
        if (!__AutoComplete[id]['isVisible']) {
            __AutoComplete[id]['dropdown'].style.visibility = 'visible';
            __AutoComplete[id]['isVisible'] = true;
        }


        // If now showing less items than before, reset the highlighted value
        if (__AutoComplete[id]['dropdown'].childNodes.length != numItems) {
            __AutoComplete[id]['highlighted'] = null;
        }
    }



    /**
    * Hides the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_HideDropdown(id)
    {
        if (__AutoComplete[id]['iframe'])
        {
            __AutoComplete[id]['iframe'].style.visibility = 'hidden';
        }
        
        if (__AutoComplete[id]['dropdown'])
        {
            __AutoComplete[id]['dropdown'].style.visibility = 'hidden';
        }

        __AutoComplete[id]['highlighted'] = null;
        __AutoComplete[id]['isVisible']   = false;
    }


    /**
    * Hides all dropdowns
    */
    function AutoComplete_HideAll()
    {
         if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
         {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
         }
         else
         {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
         }
    }


    /**
    * Highlights a specific item
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_HighlightItem(id, index) // mouseover, index is the list element index, zero-based
    {
        if (__AutoComplete[id]['dropdown'].childNodes[index]) {
            for (var i=0; i<__AutoComplete[id]['dropdown'].childNodes.length; ++i) {
                if (__AutoComplete[id]['dropdown'].childNodes[i].className == 'autocomplete_item_highlighted') {
                    __AutoComplete[id]['dropdown'].childNodes[i].className = 'autocomplete_item';
                }
            }

            __AutoComplete[id]['dropdown'].childNodes[index].className = 'autocomplete_item_highlighted';
            __AutoComplete[id]['highlighted'] = index;

            //also see below...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[index].innerHTML;
            //AutoComplete_SetValue(id);
        }
    }


    /**
    * Highlights the menu item with the given index
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_Highlight(id, index) // keyboard up/down - index is the direction of travel, 1==down,-1=up
    {
        var childNodes = __AutoComplete[id]['dropdown'].childNodes;
        if(childNodes.length)
        {
	        var lastItem = ( ( childNodes[ childNodes.length - 1 ].className != 'autocomplete_footer' ) ? childNodes.length - 1 : childNodes.length - 2 );

            // Out of bounds checking
            //if (index == 1 && __AutoComplete[id]['highlighted'] == __AutoComplete[id]['dropdown'].childNodes.length - 1) {
            if (index == 1 && __AutoComplete[id]['highlighted'] == lastItem ) {
                childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = null;

            } else if (index == -1 && __AutoComplete[id]['highlighted'] == 0) {
                childNodes[0].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = lastItem;
                index = 0;//hack!
            }

            // Nothing highlighted at the moment
            if (__AutoComplete[id]['highlighted'] == null) {

                childNodes[0].className = 'autocomplete_item_highlighted';
                __AutoComplete[id]['highlighted'] = 0;
                newIndex = 0;
                
            } else {

                if (childNodes[__AutoComplete[id]['highlighted']]) {
                
                    childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                }

                var newIndex = parseInt( __AutoComplete[id]['highlighted'] ) + parseInt(index);

                if (childNodes[newIndex]) {

                    childNodes[newIndex].className = 'autocomplete_item_highlighted';

                    __AutoComplete[id]['highlighted'] = newIndex;
                }
            }

            //populate textbox with currently highlighted term...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[newIndex].innerHTML;
            AutoComplete_SetValue(id);
        }
    }


    /**
    * Sets the input to a given value
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_SetValue(id)
    {
        __AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[__AutoComplete[id]['highlighted']].innerHTML.replace(/&amp;/, "&");
    }


    /**
    * Checks if the dropdown needs scrolling
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ScrollCheck(id)
    {
        // Scroll down, or wrapping around from scroll up
        if (__AutoComplete[id]['highlighted'] > __AutoComplete[id]['lastItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'] - (__AutoComplete[id]['maxitems'] - 1);
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'];
        }

        // Scroll up, or wrapping around from scroll down
        if (__AutoComplete[id]['highlighted'] < __AutoComplete[id]['firstItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'];
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'] + (__AutoComplete[id]['maxitems'] - 1);
        }

        __AutoComplete[id]['dropdown'].scrollTop = __AutoComplete[id]['firstItemShowing'] * 15;
    }


    /**
    * Function which handles the keypress event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyDown(id, e)
    {
        var result = true;

       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {

            // Return/Enter
            case 13:
                if (__AutoComplete[id]['highlighted'] != null) {
                    AutoComplete_SetValue(id);
                    AutoComplete_HideDropdown(id);
					
                    __SLI_asug_used_flag = true;
					
                    if( e = __AutoComplete[id]['element'].form['asug'] )
                    {
                        
                        e.disabled=false;
                        e.value = __AutoComplete[id]['asug'];
                    }

                }

                result = AutoComplete_submitForm(id);

                break;

            // Escape
            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            // Up arrow
            case 38:
                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, -1);
                AutoComplete_ScrollCheck(id, -1);
                
                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                                
                result = false;
                break;

            // Tab
            case 9:
                if (__AutoComplete[id]['isVisible']) {
                    AutoComplete_HideDropdown(id);
                }
                return;

            // Down arrow
            case 40:

                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, 1);
                //AutoComplete_ScrollCheck(id, 1);

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                result = false;
                break;
        }
        return result;
    }


    /**
    * Function which handles the keyup event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyUp(id, e)
    {
       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {
            case 13:
                event.returnValue = false;
                event.cancelBubble = true;
                
                break;

            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            case 38:
            case 40:
                return false;
                break;

            default:
                AutoComplete_ShowDropdown(id);
                
                __AutoComplete[id]['asug']=__AutoComplete[id]['element'].value;

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=true;
                   e.value = "";
                }  
                
                break;
        }
    }

    /**
    * Function which handles the keypress event
    * This function added April 2008 by Andrew Grieve
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */

    // SLI Code Modification - Start - Andrew Grieve April 08
    function AutoComplete_KeyPress(id, e)
    {
        var event = e;
        if(!event) event = window.event;
        var keyCode = event.keyCode;

        if (keyCode == 13 && isGecko || isOpera)
        {
            return false;
        }
        
        if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
        {
            if (keyCode == 13 && isIE)
            {
                return false;
            }
        }
        
    }
    // SLI Code Modification - End

    /**
    * Returns whether the dropdown is visible
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_isVisible(id)
    {
        return __AutoComplete[id]['dropdown'].style.visibility == 'visible';
    }

    function AutoComplete_submitForm(id)
    {
      var e, f, result=true;
      if( f = __AutoComplete[id]['element'].form )
      {
        if( __AutoComplete[id]['element'].value != '' )
        {
          if(__SLI_asug_used_flag == true)
          {
            if( e = f['asug'])
            {
              e.value = __AutoComplete[id]['asug'];
              e.disabled=false;
            }
          }

          if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
          {
            asugvar = "";
            if(__SLI_asug_used_flag == true)
            {
              asugvar = '&asug=' + escape(__AutoComplete[id]['asug']);
            }

            sliRegex = /resultsdemo\.com/;
            if(sliRegExArray = sliRegex.exec(document.domain))
            {
              sliRegex = /^http:\/\/(.*)\//;
              sliTargetDomain = sliRegex.exec(__SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ]);
              __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ].replace(sliTargetDomain[1], document.domain);
            }

            document.location.href = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] + escape(__AutoComplete[id]['element'].value) + asugvar;
          }
          else
          {
            if(f.onsubmit)
            {
              if(f.onsubmit() !== false)
              {
                f.submit();
              }
            }
            else
            {
              f.submit();
            }
          }

          AutoComplete_HideAll();
        }
        else
          result = false;
      }
      return result;
    }
    
    // get the style that will be applied by the browser, including stylesheets
    function sli_getStyle(el,styleProp)
    {
      if (el.currentStyle)
        var y = el.currentStyle[styleProp];
      else if (window.getComputedStyle)
        var y = document.defaultView.getComputedStyle(el,null).getPropertyValue(styleProp);
      return y;
    }

    // register with onLoad(er...
    _sli_init.push( AutoComplete_init );
    
    function sli_addEvent(obj, evType, fn) {
    	if (obj.addEventListener) {
    		obj.addEventListener(evType, fn, false);
    		return true;
    	} else if (obj.attachEvent) {
    		var r = obj.attachEvent("on" + evType, fn);
    		return r;
    	} else {
    		return false;
    	}
    }
    
    function sli_load()
    {
    	sli_addEvent(window, 'load', sli_init);
    }