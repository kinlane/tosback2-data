/* Popular phrases - SWISSCOLONY - 21:58:6, Sun Sep 30, 2012 */
__SLI_ClientDefaults =
[
    ['Alignment', 'offsetrelative' ],
	['IE6SelectBox', true ],
    ['ShowBrandingFooter', false ],
];
var asPhrases=new Array ('sale','petit fours','chocolate','cheesecake','halloween','ham','fudge','cheese','baklava','pumpkin','toffee','fruit cake','sugar free','toys','cookies','truffles','catalog','cakes','torte','nuts','dobosh torte','bonbons','careers','coconut','incredible spreadables','breakfast','fruitcake','sugar free products','red velvet','butter toffee','brownies','spreadables','cheese spreads','postpaid','red velvet petit fours','popcorn','beef log','best seller assortment','smart tablet','gingerbread house','sausage','cake balls','pretzels','sampler','summer sausage','coffee','chocolate truffles','cashews','mp3 player','petit','macadamia nut chocolate','bacon','pecan','candy','mixed nuts','christmas','spiced pumpkins','cheese log','chris mouse','watches','coconut drops','cheese cake','peanut brittle','swiss cheese','popcorn tins','bread','pistachios','27 favorites','jacket','beef jerky','dobosh','chocolate covered potato chips','tablet','carrot cake','bark','precious moments','jelly belly','dips','rum balls','crackers','shipping','fudge trio','coconut petits four','divinity','mustard','meat sticks','petit fours and bonbons','mint','pumpkin bark','jewelry','petit four sale','sugar free petits fours','german chocolate cheese cake','fruit slices','pumpkin spice cake','mint torte','macadamia nuts','jerky','meat','towers','angel','baby swiss','cheddar cheese','liqueur','high 5','red velvet cake','taffy','cheese slicer','chocolate covered cherries','beef','dark chocolate','cheese and sausage','crisps','spreads','slippers','wild game meat sticks','baby swiss cheese','coffee sampler','sugar free cookies','christmas petit fours','sweatshirt','jelly beans','caramel apple cheesecake','wolf','holiday breakfast','chocolate covered macadamia nuts','incredible petits fours','jumbos','cheesecake morsels','personalized','fudge brownie puffs','pecan tarts','pumpkin coffee cake','harvest petits fours','cat','log','fleece jacket','coconut cake','pets','brie','sweater','candles','chocolate potato chips','jalapeno beef log','chocolate layered mints','personalized gifts','coconut macaroons','elephant','macadamia','blue cheese','peanut butter','potato chips','mini butter toffee','galettes','christmas breakfast','mustard trio','pumpkin cake','fruit','fruit and nut breads','royal chocolate petits fours','jumbo cashews','cherries','pecan praline','cheesecake tarts','throw','clocks','telescope','reindeer food','aquarium','ham and cheese','men','82 all time favorites','angel treasure chest','spreadable cheese','forest friends log','coconut bars','licorice tin','macaroons','zoo chocolates','knife','mint chocolate','halloween petit fours','peppermint bark','old fashion christmas candy','gingerbread spice cookies','florentine lace cookies','lace cookies','caramel pecan swirl','shortbread','gift sampler','caramel pecan clusters','pecan clusters','lemon','family keepsake ornament','petit fours bonbons assortments','sausage and cheese bars','pendant','bananas foster','raspberry cheese cake','shipping charges','hotline to god','original beef log','sticky buns','french vanilla bonbons','red velvet cheese cake','no sugar','rum','licorice','coffee creme sticks','santa torte','mp3','brownie puffs','chocolate petit fours','ho ho ho tower','snowflake cake','marble cheese board slicer','stollen','favorite five','pralines','handbags','bavarian bonbons','lite beef log','spreadable sampler','ornaments','butterfly music box','halloween cookies','breakfast meats','robe','beef sticks','chocolate pretzels','hearty breakfast meats','fruit spread','santa\'s snacks tin','polar pals trio','pies','festive favorites','seafood logs','snow globe','holiday cookies','raccoon','carrot','breakfast special delivery','chocolate torte','pastries','wheel of cheese','gingerbread','big red cheddar','petit fors','cajun beef sticks','wallet','apple pie','coffee cake','sugar free brownies','pjs','boucle sweater coat','pancake mix','strawberry','crafting tool kit','seafood','pet carrier','brickle','friendship plate','no sugar added','winged lighted angel','john wayne','fruitful delight','reed diffuser set','chips','bavarian','scottie','deep dish caramel apple pie','holi-bars','galileo thermometer','trick or treat bag','eagle','snowflake bear','postpaid petit fours','christmas butter stollen','spiral ham','crisps and spreadables','prayer animal','cross','sweet hot mustard','crrrisps','snack','smores barks','breakfast petit fours','heater fan defroster','gaming console','cardinal','tools','mini tower','glasses','ribbon candy','pumpkin petit fours','personalized throw','smoked cheddar','tin','games','raspberry','streusel swirl coffee cake','mouse','kreme kaese cheese','fruit trays','winter scene sweatshirt','carrot cake petits','trail mix','life\'s celebrations','personalized sketch set 106-pieces','decanter','santa snack tin','cheesecake bites','helicopter','peppermint','kitty hammock','personized zoo animals','blueberry','cajun mix','4 gb mp3 player','sausage n cheese','macadamia nut patties','holi bars','banana','mini petit fours','fruit cake cookies','holiday cardinal tower','food','43 season pleasers','sugarfree','zoo','6 mini towers','caramel','pancakes','ham and swiss','fish','crunchy','licorice mix','garlic beef log','jelly belly jelly beans','sharp cheddar','mango salsa','knife set','red velvet petits','bavarian creme torte','cheddar','snowman truffles','mint dobosh torte','incredible spreadables samplers','fruit and nut delights','dog bed','sugar free cheesecake','incredible spreadables with crunchy crisps','nonpareils','jam','fruit spread sampler','country favorites','vintage cheddar','peanut butter and chocolate','gift towers','scuff','pet beds','tarts','roll','tumble buggies','christmas collection','christmas decorations','colby','set of 7 mini glass elephants','mens suede slippers','holiday fruit tray','gourmet brownies','womens jacket','blueberry cookies','underwater fantasy aquarium','incredible spreads','high five','all time favorites','personalized trick or treat bag','home','big baby swiss cheese','heater','crystal initial angel pendant','wolf throws','candle collection','snowman','florentine','plenty','name pendant','holiday mix','cashew nuts','dried fruit tray','treasure chest','creme de menthe torte','bear','men gifts','holiday treasure','petit four flavors','rollover pets','wildlife bottle opener','slicer','14 country favorites','merry christmas petit fours','birthstone','wings','raspberry cheesecake','mixed nut sampler','lace','carrier','howling wolf fleece throw','butter brickle toffee','eggnog fluff','lemon petit fours','personalized wildlife knife set','caramel apple pie','colossal breakfast','butter','mini cakes','bottle opener','eyeball truffles','jumbo beef log','24 petits fours','banana bread','pillows','holiday pretzel trio','personalized bear','holiday high notes','scottie dogs','christmas cookies','monkey','pecan log','purse','sweet surprises basket','carrot cake balls','cranberry cheese','radio','ham and baby swiss','camouflage lounge set','aged swiss','sno-shield','baby doll','butter toffee crunch','cheese ball','angel pendant','lemon bread','candy bark','angel throw','peanut butter bites','best sellers','jalapeno','jalapeno brittle','blankets','harvest','honey creme','hot and spicy','brick cheese','pen','premium nut assortment','fleece','petite holiday mints','raccoon cake','milk chocolate','angel chest','confetti party bark','11','giraffe','monkey chocolate','cheese gifts','lantern','sugar free peppermint','owl family figurine','butterfly','vanilla petits fours','jelly belly gift assortment','ice scraper','saltwater taffy','mini toffee','cajun sticks','wild game meats','all sugar free products','cheese bars','remote control helicopter','wolves','muenster cheese','gift of 6','beef sausage','life celebration','peppermint candy bites','creature balls','halloween candies','dates','butterfly meadow pjs','hammock','santa','colby cheese','lucy a legacy of laughter','size chart','velour set','beef log and cheese','cheese and meat','oranges','new arrivals','favorites','skeleton truffles','winking santa torte','rings','chocolate pecan fudge','elk','music box','cardinal tower','fruitcake medley','santa cake','leather carryall','clusters','manicure set','camo set','old fashioned fudge trio','white cheddar','musical hummingbird egg','snack time special','decorations','canadian bacon','spread your wings pendant','lamp','unsalted nuts','forest friends cake','zoo animals','halloween playcakes','mini','boneless ham','caraway beef log','old fashion butter toffee','wreath','sugar free chocolate pecan fudge','holiday favorites','hummingbird','fours','jelly','72','womens gifts','nuts postpaid','mini cakes trio','sausage logs','chocolate mouse','hearty breakfast','butter stollen','26 holiday favorites','aged cheddar','audio bible','peppermint patties','race car wall clock','cookie tin','crystal','aquarium light','snowman blanket','garden vegetable dip','plate and holder','no sugar added trail mix','streusel coffee cake','carrot petit','fruit nut breads and cremes','halloween bear','bonbon cake','carrot cake cream torte','sugar free peanut brittle','moon wolves tee','chocolate fudge','scarf','carrot cake petits fours','mood watch','home and roadside','almonds','jacquard handbag','mens lounge set','snowman melts','fall petit fours','dolls','assorted chocolates','moccasin','32 favorites','orange slices','sugar free fruit nut delight','cheese assortment','caramel pecan','trio','hotline','dutch apple','honey mustard','eagle hoodie','pocket scarf','smokey cheddar cheese','suspenders','cheese dips','old fashioned candy','sauces','sugar free cheese cake','free truffles','animal','sugar free assortment','cheese popcorn','chris mouse magical pleasers','lemon mist','gift of 4','liqueur cake','tumble','cherry cordials','red rind muenster','well-mannered doll','macadamia fruit cake','oatmeal cookies','caramel apple cheese cake','leather purse','wisconsin','globe','toffee crunch','bowling set','sugar free chocolatey potato chips','jumping clock','puffs','baby doll with 7 outfits','beef long','season pleasers','bear and cookies','candy and cakes','all','western dvds','hot chocolate','owl','cheese and crackers','german','dog','ho ho ho','beef log gift combo','fleece pant','inspirational musical clock','kreme kaese','cinnamon','angel figurine','ultimate snack mix','lobster','wacky duckie','dvds','chocolate cheese','carrot spice','balls','two tone cross pendant','german chocolate','pumpkin cookies','jewish','port wine cheddar','fruity gels','venison','chocolate covered pretzels','lovable lapsies','bags','li\'l baby swiss','key lime','save','suede scuff','chocolate log','basketball crazy shoot','ornament server','seafood dips','velvet cake','scraper','angel figurine charms','surefire pleasers','beef log combo','8 gb mp3 player','deep dish caramel pie','snowballs','raspberry petit four','ballpoint pen with personalized case','personalized angel throw','bison','miniature baklava desserts','sugar free chocolate fudge','32 holiday favorites','french vanilla cheesecake','black cat pillow','dobosh cakes','walnut cake','drops','sweet and hot spreadables','orangutan','fantasy aquarium','chocolate pecan','angel fleece throw','precious','electronic bible','fruitcake cookies','tasty temptations','cake bites','women\'s fleece jacket','witch log','pistachio nuts','supple leather carryall','bonanza','garden vegetable cheese','chocolate cake roll','fleece throw','stix','holiday cookie sampler','72 petit','pocket watch','stick','chocolate cheesecake','snack tin','stainless steel jewelry','ingredients','glass elephant','stuffed animals','cars','shirts','sugar free gourmet brownies','family banner','spice cookies','garlic beeflog','creme de menthe','harvest fruit','children','apple bread','orange petits','mens jackets','interchangeable watch set','stollen cake','wildlife knife set','wardrobe of watches','no sugar cookies','personalized treasure chest','sketch','slippers muk luks','spread your wings','cinnamon cake','daughter throw','hickory smoked bacon','ham links','horatio cable sweater','halloween cakes','laffy taffy','postpaid toffee','smart','cash','electronic games','age cheese','lounge pants','trio of chocolate samplers','credit card','milk chocolate macadamia nuts','chocolate covered toffee','camo','pumpkin pillow','walkers shortbread','mousse','charms','chocolate covered nuts','14','chocolate card','covered cherries','cheese board','sugar cookies','jumbo cheese trio','harvest fruit tray','desserts','crab cheese dip','ancho','swiss','hot sauce','royal chocolate','chocolate peanuts','sherpa','gift of 8','apple cake','bridge mix','snack mix','strawberry cheese cake','zigzag sweater','mens watches','triple berry cheesecake','heated ice scraper','cardinal pjs','bible','postpaid dobosh','lucy','jalapeno peanut brittle','mirror','vintage cheddar cheese','red velvet cheesecake','swirl','shrimp','lol rollover pets','vegetable dip','christmas chocolate','art 101','boneless spiral sliced ham','heater fan','coffee bark','chocolate toffee','cat pillow','velvet','story stix','cinnamon rugulach','suede','plaid','cheese board slicer','red velvet layer cake','beef and cheese','82 all-time favorites','cashews and pistachio','apple pancake','plaque','interchangeable 10 charms jewelry','lobster spread','fruit candy','mini butter','cake rolls','cat hammock','wild game','sweets','sugar free holiday cookies','coins','lobster delight','belts','salmon','spring cookie gift assortment','garden vegetable','meat strip','snowman tower','trick or treat','fire glazed ham','butter mints','postpaid cheese','shoe shine','tower full of joys','sno shield windshield protector','collectibles','venison sticks','fragrance','bavarian torte','garlic','blueberry cheese','star','hot mustard','candy sampler','pink and camo jacket','chocolate cake balls','defroster','15','petite cakes','scented candles','snowmen','holiday pretzel','western','shelled pistachios','petite mints','sweet halloween pretzels','swiss chocolate','bakery','chocolate candy','sugar free fudge','gift of plenty','all occasion','handmade fudge','kreme cheese','82 favorites','sugar free toffee','exclusive','preserves','smoked bacon','barnyard','carryall supple leather','petit four 36','garlic summer sausage','deer fleece','festive','21 season highlights','sherpa jacket','sugar free truffles','sweet hot','glazed ham','santa\'s favorite','special gift samplers','32','faux','postpaid fruitcake','military','santas snack','coffee sticks','sausage n cheese bar','walkers','mini petite','peppermint chocolate bark','chocolate fruit cake','drill','santa cards','summer','postpaid truffles','key','cheese wax','sail','coffe cake','sugar free butter toffee','all products','muk luks','christmas tower','forest friends','apple cheesecake','christmas morning breakfast','bats','sweet mustard','gift assortments','postpaid christmas collection','marshmallow','crumb cake','movies','meat strips gift box','vintage cheese','german chocolate cheesecake','sailboat','82','soothing sandscape','plates','fudge brownie','holiday mints','eggs','i love you','candy sampler trio','chocolate pecan mix','cross dog tag','baked ham','tv westerns','wildlife wallet','classic candy','mens slippers','meat stick bonanza','kitty','christmas candies samplers','decanter set','kiss','vegetable cheese spread','binoculars','angel in chest','chees spread','shaver','camo fleece','chocolate covered butter toffee','mummy cupcakes','santa tins','front 5 favorites','boneless ham and baby swiss','cooking ham','big red cheddar baby swiss','velour','rocky road','god','love','black forest','kaese','computer mouse','incredible spreadables seafood','windshield','mini baklava assortment','forest','brazil nuts','live plate','d','wrapped candy','all sizes','harvest petit','treat','coconut fours','led rechargeable lantern','chocolate santa','mango salsa cheese spread','christmas fruitcake','maple walnut fudge','money clip','cheese bars with slicer','chocolate lollipops','onion cheese','43','82 all','triple chocolate torte','caramel cheesecake','cheese bites','snuggle','holiday bars','f','vanilla cremes','count and draw','snowman blanket hugger','frosty','honey','men\'s fleece pants','watch radio and pen set','sunflower seeds','bible verses','butter rum','graham','dutch','chocolate layer cake','cocoa','assorted candy','oval pendant','fruity and white cheddars','toffe','for kids','white','for her','sausage bread','ceramic','mild jalapeno','cream','dress up phone','fleece robe','wolves tee','camping lantern','no sugar added fruit cake','christmas dinner','petit f','82 all time','gift shop','cat beds','spicy cajun beef sticks','candy house','24 petits','select mixed nuts','cheese\'s','sno-shield windshield protector','port','chocolate dobosh','blueberry cheesecake','chocolate covered peanut butter','sweet cheese','walnut oatmeal pumpkin cookies','stuffed toys','big logs','strawberry truffles','set of 3 led flashlights','bear with halloween cookies','meat strip gifts','charge','smokehouse','batteries','cheese sampler','sugar free macadamia nut clusters','sugar free fruit cake','bites','special delivery','cremes','chees cake','brazil','savory','cheese and candy','postpaid christmas petits fours christmas petits','swiss and ham cheese spread','pancake and ham links','$40','2- piece thermal fleece lounge set','$15');
/* $Revision: 6883 $
 *
 */

if(typeof(_sli_init )!='object'){var _sli_init=new Array();}
if(typeof(sli_init )!='function'){function sli_init(){ for(var x=0;x<_sli_init.length;x++) _sli_init[x]();}}
if(typeof(asPhrases)!='object'){ var asPhrases = new Array(); }
if(typeof(__SLI_customisations)!='object'){var __SLI_customisations = new Object();}
if(typeof(__SLI_ClientDefaults)!='object'){ var __SLI_ClientDefaults=[]; }
if(typeof(__SLI_validSearchBoxes)!='object'){ var __SLI_validSearchBoxes = new Array(); }
if(typeof(__SLI_asug_used_flag)!='object'){ var __SLI_asug_used_flag = false; }
if(typeof(__SLI_width)!='object'){ var __SLI_width = 0; }
if(typeof(sli_targeturl)!='object'){ var sli_targeturl = ""; }


    __AutoComplete = new Object(); //namespace...
    __AutoComplete_mouseMoved=false;

    // Basic UA detection
    isIE = document.all ? true : false;
    isGecko = navigator.userAgent.toLowerCase().indexOf('gecko') != -1;
    isOpera = navigator.userAgent.toLowerCase().indexOf('opera') != -1;

    /* defaults and options */

    var __SLI_ApplicationName = 'AutoSuggest';
        __SLI_customisations[ 'AutoSuggest' ] =
                {
                    'ShowBrandingFooter' : true
                    ,
                    'TextBoxIDPrefix' : 'sli_search_'
                    ,
                    'BrandingFooterImagePath' : 'http://assets.resultspage.com/autosuggest/sli_systems-powered_150_15.gif'
                    ,
                    'BrandingFooterTitleTooltip' : 'AutoSuggest Powered by SLI Systems'
                    ,
                    'DropListMinWidth' : 150
                    ,
                    'MaxListItems' : 10
                    ,
                    'Alignment' : true
                    ,
                    'TextBoxIDCustom' : []
                    ,
                    'ValidSearchBoxes' : false 
                    ,
                    'IE6SelectBox' : false 
                    ,
                    'IE6SelectBoxPadding' : 0
                    ,
                    'TargetURL' : ''
                    ,
                    'IframeAlignment' : false
                    ,
                    'AlignmentBorderBug' : false
                    ,
                    'IE6OnFocus' : false
                };
    /* 0 = keyname, 1 = value */
    for( defaultValuePair in __SLI_ClientDefaults )
    {
        __SLI_customisations[__SLI_ApplicationName][__SLI_ClientDefaults[defaultValuePair][0]]=__SLI_ClientDefaults[defaultValuePair][1];
    }

    /* pre-fetch branding footer image if being used...
     */
    if( __SLI_customisations[ __SLI_ApplicationName ][ 'ShowBrandingFooter' ] )
    {
        
        if(location.protocol == "https:")
        {
            __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ] = __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ].replace(/http:/i, 'https:');
        }
    
        var __AutoCompleteBranding = new Image();
        __AutoCompleteBranding.src=__SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ];
    }


    function AutoComplete_init()
    {
        if(!isOpera)
        {
            var oldonresize=function(){};
            if(typeof(window.onresize)=='function')
                oldonresize = window.onresize;//play nicely with other people's toys
            window.onresize= function(){ oldonresize(); AutoComplete_HideAll(); AutoComplete_Create( asPhrases ); }

            AutoComplete_Create( asPhrases );
            
            var els = document.getElementsByTagName('input');
            if(els)
            {
               for ( i = 0; i < els.length; i++ )
               {
                  if(els[i].name == "asug")
                  {
                     els[i].disabled = true;
                  }
               }
            }
        }
    }




    /**
    * Attachs the autocomplete object to a form element. Sets
    * onkeypress event on the form element.
    *
    * @param string formElement Name of form element to attach to
    * @param array  data        Array of strings of which to use as the autocomplete data
    */
    //function AutoComplete_Create (id, data)
    /*
     * iterate over 'sli_search_*' assumes one or more search boxes numbered from 1...
    */
    function AutoComplete_Create( data )
    {
        var idx=1, e, id, searchBoxPrefix=__SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDPrefix' ];
        while( e = document.getElementById(searchBoxPrefix+idx) )
        {
            AutoComplete_AttachHandlers(e, data);
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
                __SLI_validSearchBoxes.push(searchBoxPrefix+idx);
            }
            idx++;
        }
        
        
        //this array comes from the customised list
        var otherTextBoxIdList = __SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDCustom' ];
        if( otherTextBoxIdList)
        {
            for(idx=0;idx<otherTextBoxIdList.length;idx++)
            {
                e = document.getElementById(otherTextBoxIdList[idx]);
                if(e)
				{
					if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
                	{
	                    __SLI_validSearchBoxes.push( otherTextBoxIdList[idx] );
                	}
					AutoComplete_AttachHandlers(e, data);
				}
            }
        }
        
    } 

    function AutoComplete_AttachHandlers(e, data){
        var iframe,id;
        id=e.id;


        __AutoComplete[id] = {'data':data,
                              'isVisible':false,
                              'element':document.getElementById(id),
                              'dropdown':null,
                              'highlighted':null};

        __AutoComplete[id]['element'].setAttribute('autocomplete', 'off');
        __AutoComplete[id]['element'].onkeydown = function(e) {if (!e) e = window.event; return AutoComplete_KeyDown(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onkeyup = function(e) {if (!e) e = window.event; return AutoComplete_KeyUp(this.getAttribute('id'), e);}
        // The function call on the next line was changed by Andrew Grieve April 2008
        __AutoComplete[id]['element'].onkeypress = function(e) {if (!e) e = window.event; return AutoComplete_KeyPress(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onclick = function(e)
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6OnFocus' ] )
            {
                __AutoComplete[id]['element'].focus();
            }
            if (!e) e = window.event; e.cancelBubble = true; e.returnValue = false;
        }



        // Hides the dropdowns when document clicked
        var docClick = function()
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
            }
            else
            {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
            }
        }

        if (document.addEventListener) {
            document.addEventListener('click', docClick, false);
        } else if (document.attachEvent) {
            document.attachEvent('onclick', docClick, false);
        }


        // Max number of items shown at once
        if (arguments[2] != null) {
            __AutoComplete[id]['maxitems'] = arguments[2];
            __AutoComplete[id]['firstItemShowing'] = 0;
            __AutoComplete[id]['lastItemShowing'] = arguments[2] - 1;
        }

        AutoComplete_CreateDropdown(id);

        // Prevent select dropdowns showing thru
        if (isIE) {
            iframe = document.createElement('iframe');
            __AutoComplete[id]['iframe'] = iframe;
                iframe.id = id +'_iframe';
                iframe.style.position = 'absolute';
                iframe.style.top = '0';
                iframe.style.left = '0';
                iframe.style.width = '0px';
                iframe.style.height = '0px';
                iframe.style.zIndex = '98';
                iframe.style.visibility = 'hidden';
                
                if(location.protocol == "https:")
                {
                   iframe.src = 'https://assets.resultspage.com/autosuggest/blank.html';
                }
                
                if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBox' ] )
                {
                  iframe.style.width = __SLI_width  + __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBoxPadding'];
                }

            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IframeAlignment' ] )
            {
                document.body.insertBefore( iframe );
            }
            else
            {
                __AutoComplete[id]['element'].parentNode.insertBefore( iframe, __AutoComplete[id]['element'] );
            }
        }
    }

    /**
    * Creates the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_CreateDropdown(id)
    {
        var theSearchbox = __AutoComplete[id]['element'];
        var theDropDown;
        var left_top = AutoComplete_getPos( theSearchbox );
        var left  = left_top[0];
        var top   = left_top[1] + theSearchbox.offsetHeight;
        var width = theSearchbox.offsetWidth;

        if ( width < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
        {
            width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
        }

        theDropDown = document.createElement('div');
        theDropDown.className = 'autocomplete'; // Don't use setAttribute()


        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true && document.body)
        {
            theDropDown.style.position = 'absolute';
            document.body.insertBefore(theDropDown, document.body.nextSibling);
            
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        else if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "offsetrelative" && document.body)
        {
          theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
          // Position it
          if(sli_getStyle(theSearchbox.offsetParent, 'position') != "absolute")
          {
            theSearchbox.offsetParent.style.position = 'relative';
          }
          theDropDown.style.position = 'absolute';
          theDropDown.style.left = (theSearchbox.offsetLeft) + 'px';
          theDropDown.style.top = (theSearchbox.offsetTop + theSearchbox.offsetHeight) + 'px';
          if ( theSearchbox.clientWidth < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
          {
            theDropDown.style.width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
          }
          else
          {
            theDropDown.style.width = (theSearchbox.clientWidth) + 'px';
          }
          theDropDown.style.visibility = 'hidden';
          theDropDown.style.zIndex     = '99999999';
        }
        else
        {
            theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        

        __AutoComplete[id]['dropdown'] = theDropDown;
        __SLI_width = width;
    }

    function /* array [ left, top ] */ AutoComplete_getPos( obj )
    {
        var curleft = curtop = 0;
        var sli_flag = 0;

        if (obj.offsetParent)
        {
           do
           {
              if ( __SLI_customisations[ __SLI_ApplicationName ][ 'AlignmentBorderBug' ] )
              {         
                
                if(sli_flag == 1)
                {
                    var clientTop = (obj.offsetHeight - obj.clientHeight) / 2;
                    curtop += clientTop;

                    var clientLeft = (obj.offsetWidth - obj.clientWidth) / 2;
                    curleft += clientLeft;
                }
                sli_flag = 1;
              }
           
              curleft += obj.offsetLeft;
              curtop += obj.offsetTop;
           }
           while (obj = obj.offsetParent);
        }
        return [curleft,curtop];
    }

    /**
    * Shows the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ShowDropdown(id)
    {

        AutoComplete_HideAll();



        var value = __AutoComplete[id]['element'].value;
        var toDisplay = new Array();
        var newDiv    = null;
        var text      = null;
        var numItems  = __AutoComplete[id]['dropdown'].childNodes.length;

        __AutoComplete_mouseMoved=false;
        // SLI Code Modification - Start - Andrew Grieve April 08
        // Trim the textbox so that if is starts with a space then the feature will still work
        //value = value.replace(/^\s+|\s+$/g,"");
        value = value.replace(/^\s+/g,"");

        if(value.length == "")
        {
            // If Textbox length is nothing (after the trim) then don't show dropdown.
            return;
        }
        // SLI Code Modification - End

        // Remove all child nodes from dropdown
        while (__AutoComplete[id]['dropdown'].childNodes.length > 0) {
            __AutoComplete[id]['dropdown'].removeChild(__AutoComplete[id]['dropdown'].childNodes[0]);
        }


        var count=0;
        // Go thru data searching for matches
        for (i=0; i<__AutoComplete[id]['data'].length; ++i)
        {
            // SLI Code Modification - Start - Andrew Grieve April 08 - Added lower casing
            if (__AutoComplete[id]['data'][i].substr(0, value.length).toLowerCase() == value.toLowerCase())
            {
                // SLI Code Modification - End
                toDisplay[toDisplay.length] = __AutoComplete[id]['data'][i];
                count++;
                /* how many to display? */
                if(count == __SLI_customisations['AutoSuggest']['MaxListItems'] ) /* Code inserted to keep list to a maximum of 10 values (was 20 or 30) */
                {
                    break;
                }
            }
        }

        // No matches?
        if (toDisplay.length == 0) {
            AutoComplete_HideDropdown(id);
            return;
        }



        // Add data to the dropdown layer
        for (i=0; i<toDisplay.length; ++i) {
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_item'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';

             // Scrollbars are on display ?
            if (toDisplay.length > __AutoComplete[id]['maxitems'] && navigator.userAgent.indexOf('MSIE') == -1) {
                newDiv.style.width = __AutoComplete[id]['element'].offsetWidth - 22 + 'px';
            }

            newDiv.onmouseover =
        function()
        {
            if( __AutoComplete_mouseMoved )
                AutoComplete_HighlightItem(__AutoComplete[id]['element'].getAttribute('id'), this.getAttribute('index'));
        };

            newDiv.onclick     =    function()
                                    {
                                    	  __SLI_asug_used_flag = true;
                                                                           
                                        AutoComplete_SetValue(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_HideDropdown(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_submitForm(id);
                                    }



            text   = document.createTextNode(toDisplay[i]);
            newDiv.appendChild(text);
            newDiv.title='Search for ' + toDisplay[i];

            /* ellipsis for IE only */
            if( isIE )
            {
                newDiv.style.textOverflow = 'ellipsis';
                newDiv.style.width = '100%';
                newDiv.style.whiteSpace = 'nowrap';
                newDiv.style.overflow = 'hidden';

            }
            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }
        /*
         * append DIV containing footer branding...
         */
        if(__SLI_customisations['AutoSuggest']['ShowBrandingFooter'])
        {
            i = toDisplay.length;
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_footer'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';
            newDiv.innerHTML = '<a href="http://www.sli-systems.com/powered-by.php" title="' +
                                __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterTitleTooltip' ] +
                                '"><img class="autocomplete_footer_branding" src="'+__AutoCompleteBranding.src+'" /></a>';

            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }


        // Too many items?
        if (toDisplay.length > __AutoComplete[id]['maxitems']) {
            __AutoComplete[id]['dropdown'].style.height = (__AutoComplete[id]['maxitems'] * 15) + 2 + 'px';

        } else {
            __AutoComplete[id]['dropdown'].style.height = '';
        }


        /**
        * Set left/top in case of document movement/scroll/window resize etc
        */
        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "true" || __SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "false")
        {
            var left_top = AutoComplete_getPos( __AutoComplete[id]['element'] );
            __AutoComplete[id]['dropdown'].style.left = left_top[0];
            __AutoComplete[id]['dropdown'].style.top  = left_top[1] + __AutoComplete[id]['element'].offsetHeight;
        }


        // Show the iframe for IE
        if (isIE) {
            
            if(!__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true)
            {
               __AutoComplete[id]['iframe'].style.width  = __AutoComplete[id]['dropdown'].offsetWidth;
            }
            
            
            __AutoComplete[id]['iframe'].style.top    = __AutoComplete[id]['dropdown'].style.top;
            __AutoComplete[id]['iframe'].style.left   = __AutoComplete[id]['dropdown'].style.left;
            __AutoComplete[id]['iframe'].style.height = __AutoComplete[id]['dropdown'].offsetHeight;

            __AutoComplete[id]['iframe'].style.visibility = 'visible';
        }

    e =  __AutoComplete[id]['dropdown'];

    e.onmousemove =
        function()
        {
            if(!__AutoComplete_mouseMoved){__AutoComplete_mouseMoved=true;}
            this.onmousemove = null;
        }

        // Show dropdown
        if (!__AutoComplete[id]['isVisible']) {
            __AutoComplete[id]['dropdown'].style.visibility = 'visible';
            __AutoComplete[id]['isVisible'] = true;
        }


        // If now showing less items than before, reset the highlighted value
        if (__AutoComplete[id]['dropdown'].childNodes.length != numItems) {
            __AutoComplete[id]['highlighted'] = null;
        }
    }



    /**
    * Hides the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_HideDropdown(id)
    {
        if (__AutoComplete[id]['iframe'])
        {
            __AutoComplete[id]['iframe'].style.visibility = 'hidden';
        }
        
        if (__AutoComplete[id]['dropdown'])
        {
            __AutoComplete[id]['dropdown'].style.visibility = 'hidden';
        }

        __AutoComplete[id]['highlighted'] = null;
        __AutoComplete[id]['isVisible']   = false;
    }


    /**
    * Hides all dropdowns
    */
    function AutoComplete_HideAll()
    {
         if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
         {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
         }
         else
         {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
         }
    }


    /**
    * Highlights a specific item
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_HighlightItem(id, index) // mouseover, index is the list element index, zero-based
    {
        if (__AutoComplete[id]['dropdown'].childNodes[index]) {
            for (var i=0; i<__AutoComplete[id]['dropdown'].childNodes.length; ++i) {
                if (__AutoComplete[id]['dropdown'].childNodes[i].className == 'autocomplete_item_highlighted') {
                    __AutoComplete[id]['dropdown'].childNodes[i].className = 'autocomplete_item';
                }
            }

            __AutoComplete[id]['dropdown'].childNodes[index].className = 'autocomplete_item_highlighted';
            __AutoComplete[id]['highlighted'] = index;

            //also see below...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[index].innerHTML;
            //AutoComplete_SetValue(id);
        }
    }


    /**
    * Highlights the menu item with the given index
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_Highlight(id, index) // keyboard up/down - index is the direction of travel, 1==down,-1=up
    {
        var childNodes = __AutoComplete[id]['dropdown'].childNodes;
        if(childNodes.length)
        {
	        var lastItem = ( ( childNodes[ childNodes.length - 1 ].className != 'autocomplete_footer' ) ? childNodes.length - 1 : childNodes.length - 2 );

            // Out of bounds checking
            //if (index == 1 && __AutoComplete[id]['highlighted'] == __AutoComplete[id]['dropdown'].childNodes.length - 1) {
            if (index == 1 && __AutoComplete[id]['highlighted'] == lastItem ) {
                childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = null;

            } else if (index == -1 && __AutoComplete[id]['highlighted'] == 0) {
                childNodes[0].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = lastItem;
                index = 0;//hack!
            }

            // Nothing highlighted at the moment
            if (__AutoComplete[id]['highlighted'] == null) {

                childNodes[0].className = 'autocomplete_item_highlighted';
                __AutoComplete[id]['highlighted'] = 0;
                newIndex = 0;
                
            } else {

                if (childNodes[__AutoComplete[id]['highlighted']]) {
                
                    childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                }

                var newIndex = parseInt( __AutoComplete[id]['highlighted'] ) + parseInt(index);

                if (childNodes[newIndex]) {

                    childNodes[newIndex].className = 'autocomplete_item_highlighted';

                    __AutoComplete[id]['highlighted'] = newIndex;
                }
            }

            //populate textbox with currently highlighted term...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[newIndex].innerHTML;
            AutoComplete_SetValue(id);
        }
    }


    /**
    * Sets the input to a given value
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_SetValue(id)
    {
        __AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[__AutoComplete[id]['highlighted']].innerHTML.replace(/&amp;/, "&");
    }


    /**
    * Checks if the dropdown needs scrolling
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ScrollCheck(id)
    {
        // Scroll down, or wrapping around from scroll up
        if (__AutoComplete[id]['highlighted'] > __AutoComplete[id]['lastItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'] - (__AutoComplete[id]['maxitems'] - 1);
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'];
        }

        // Scroll up, or wrapping around from scroll down
        if (__AutoComplete[id]['highlighted'] < __AutoComplete[id]['firstItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'];
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'] + (__AutoComplete[id]['maxitems'] - 1);
        }

        __AutoComplete[id]['dropdown'].scrollTop = __AutoComplete[id]['firstItemShowing'] * 15;
    }


    /**
    * Function which handles the keypress event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyDown(id, e)
    {
        var result = true;

       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {

            // Return/Enter
            case 13:
                if (__AutoComplete[id]['highlighted'] != null) {
                    AutoComplete_SetValue(id);
                    AutoComplete_HideDropdown(id);
					
                    __SLI_asug_used_flag = true;
					
                    if( e = __AutoComplete[id]['element'].form['asug'] )
                    {
                        
                        e.disabled=false;
                        e.value = __AutoComplete[id]['asug'];
                    }

                }

                result = AutoComplete_submitForm(id);

                break;

            // Escape
            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            // Up arrow
            case 38:
                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, -1);
                AutoComplete_ScrollCheck(id, -1);
                
                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                                
                result = false;
                break;

            // Tab
            case 9:
                if (__AutoComplete[id]['isVisible']) {
                    AutoComplete_HideDropdown(id);
                }
                return;

            // Down arrow
            case 40:

                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, 1);
                //AutoComplete_ScrollCheck(id, 1);

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                result = false;
                break;
        }
        return result;
    }


    /**
    * Function which handles the keyup event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyUp(id, e)
    {
       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {
            case 13:
                event.returnValue = false;
                event.cancelBubble = true;
                
                break;

            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            case 38:
            case 40:
                return false;
                break;

            default:
                AutoComplete_ShowDropdown(id);
                
                __AutoComplete[id]['asug']=__AutoComplete[id]['element'].value;

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=true;
                   e.value = "";
                }  
                
                break;
        }
    }

    /**
    * Function which handles the keypress event
    * This function added April 2008 by Andrew Grieve
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */

    // SLI Code Modification - Start - Andrew Grieve April 08
    function AutoComplete_KeyPress(id, e)
    {
        var event = e;
        if(!event) event = window.event;
        var keyCode = event.keyCode;

        if (keyCode == 13 && isGecko || isOpera)
        {
            return false;
        }
        
        if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
        {
            if (keyCode == 13 && isIE)
            {
                return false;
            }
        }
        
    }
    // SLI Code Modification - End

    /**
    * Returns whether the dropdown is visible
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_isVisible(id)
    {
        return __AutoComplete[id]['dropdown'].style.visibility == 'visible';
    }

    function AutoComplete_submitForm(id)
    {
      var e, f, result=true;
      if( f = __AutoComplete[id]['element'].form )
      {
        if( __AutoComplete[id]['element'].value != '' )
        {
          if(__SLI_asug_used_flag == true)
          {
            if( e = f['asug'])
            {
              e.value = __AutoComplete[id]['asug'];
              e.disabled=false;
            }
          }

          if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
          {
            asugvar = "";
            if(__SLI_asug_used_flag == true)
            {
              asugvar = '&asug=' + escape(__AutoComplete[id]['asug']);
            }

            sliRegex = /resultsdemo\.com/;
            if(sliRegExArray = sliRegex.exec(document.domain))
            {
              sliRegex = /^http:\/\/(.*)\//;
              sliTargetDomain = sliRegex.exec(__SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ]);
              __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ].replace(sliTargetDomain[1], document.domain);
            }

            document.location.href = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] + escape(__AutoComplete[id]['element'].value) + asugvar;
          }
          else
          {
            if(f.onsubmit)
            {
              if(f.onsubmit() !== false)
              {
                f.submit();
              }
            }
            else
            {
              f.submit();
            }
          }

          AutoComplete_HideAll();
        }
        else
          result = false;
      }
      return result;
    }
    
    // get the style that will be applied by the browser, including stylesheets
    function sli_getStyle(el,styleProp)
    {
      if (el.currentStyle)
        var y = el.currentStyle[styleProp];
      else if (window.getComputedStyle)
        var y = document.defaultView.getComputedStyle(el,null).getPropertyValue(styleProp);
      return y;
    }

    // register with onLoad(er...
    _sli_init.push( AutoComplete_init );
    
    function sli_addEvent(obj, evType, fn) {
    	if (obj.addEventListener) {
    		obj.addEventListener(evType, fn, false);
    		return true;
    	} else if (obj.attachEvent) {
    		var r = obj.attachEvent("on" + evType, fn);
    		return r;
    	} else {
    		return false;
    	}
    }
    
    function sli_load()
    {
    	sli_addEvent(window, 'load', sli_init);
    }