/* Popular phrases - SWISSCOLONY - 18:2:28, Sat Feb 23, 2013 */
__SLI_ClientDefaults =
[
    ['Alignment', 'offsetrelative' ],
	['IE6SelectBox', true ],
    ['ShowBrandingFooter', false ],
];
var asPhrases=new Array ('candy','petit fours','cheesecake','sale','truffles','sugar free products','cheese','fudge','fruit cake','easter','ham','sugar free','easter baskets','cakes','butter toffee','baklava','toffee','cashews','cheese spreads','nuts','fruitcake','red velvet','summer sausage','fruit','red velvet petit fours','coconut','valentines','chocolate truffles','jelly belly','brownies','petit','peanut brittle','jelly beans','catalog','cake balls','chocolate','beef jerky','coffee','torte','breakfast','frog','sausage','lemon','bonbons','pretzels','incredible spreadables','birthday','ladybug truffles','wreath','monkey','cheese cake','pecan','chocolate covered cherries','frog chocolates','gluten free','mustard','macadamia nut chocolate','petits fours gift','spring petit fours','sampler','beef log','fruit slices','pistachios','pumpkin','spreadables','sweet hot mustard','jelly belly jelly beans','beef','bark','swiss cheese','taffy','free shipping','mini butter toffee','carrot cake','meat sticks','butterfly','gluten free products','incredible petits fours','ladybug','saltwater taffy','toys','cheese log','lemon cheesecake','bread','dog','macadamia nuts','dark chocolate','careers','baklava squares','spreads','coconut petits four','jerky','spreadable cheese','sugar free candy','cheese and sausage','popcorn','lemon petit fours','shipping charges','log','dobosh torte','mint','cheese slicer','chocolate petit fours','coffee sampler','chocolate covered macadamia nuts','birthday petit fours','licorice','chocolate covered potato chips','meat','sugar free petits fours','mixed nuts','pecan clusters','caramel pecan clusters','petit fors','gummi butterflies','lemon cakes','kreme kaese cheese','peanut butter','breakfast gifts','tablet','cheddar cheese','cat','shipping','tea','ice cream cake balls','dobosh','bee','oranges','peanut butter and chocolate','27 favorites','mint chocolate','chocolate fudge','cherries','cocktail jelly belly petit fours','spring','banana foster bonbons','caramel','zoo','pancake mix','banana','dips','baby swiss cheese','gummies','raspberry swirl cake','petit four flavors','jewelry','chocolate cake','fudge trio','strawberry daiquiri cheesecake','liqueur truffles','personalized petit fours','elephant','butter brickle toffee','red velvet cake balls','sticky buns','sausage and cheese bars','valentine candy','ladybug chocolates','raspberry','pumpkin coffee cake','towers','fudge assortment','spiral sliced ham','strawberry shortcake','dog with candy','easter candy','cookies in a tin','fruit spread','sugar free cookies','red velvet cheesecake','stuffed animals','gingerbread','licorice tin','wild game meat sticks','brickle','banana split','smart tablet','peanut butter bites','mint chocolate chip cheesecake','red velvet cake','bugs','fruit cake cookies','monster cake balls','hummingbird throw','rum balls','spiced pumpkins','angel','mustard trio','blueberry pecan cookies','easter lemon cake','florentine lace cookies','peanut','sugar free jelly bellies','coconut drops','pillows','caramel apple cheesecake','potato','carrot cake petits fours','mini toffee','bear','baskets','dutch apple cake','strawberry teapot','log cake','fruitcake cookies','dark chocolate truffles','macaroons','carrot cake balls','hearty breakfast meats','frog truffle','spring fruit slices','jumbo cashews','apple pie','chocolate layered mints','chihuahua with candy','easter petits fours','petite mints','favorite five','shortbread','pralines','wildflower tower','trail mix','ham and cheese','chris mouse','butterfly throw','zoo chocolates','throw','blankets','potato chips','bridge mix','tropical petit fours','macadamia','spring flower tower','stollen','hound with candy','crrrisps','jalapeno','easter gifts','chocolate nuts','spring candy','no sugar added','christmas fruit cake','lemon tarts','marble cheese slicer','crrrisps and spreads','apo gifts','teapot','sugar free coconut','beef sticks','spiral ham','animal','baby swiss','strawberry petit fours','snacking favorites','personalized hoodie zoo animals','coconut cake','coconut products','almonds','valentine chocolates','jumbos','lace cookies','alarm clock','box towers','spring cookies','cheese and sausage gift','apple','cajun mix','personalized','chocolate cherries','premium nut assortment','plush candy trio','blueberry cookies','seafood','birthday cakes','ham\'s','sugar free cheesecake','pen','boneless spiral sliced ham','carrot','wildflower wreath','easter cake trio','bavarian bonbons','chihuahua','gummy candy','butter toffee crunch','boneless ham and baby swiss','vintage cheddar cheese','conversation cakelet','bananas foster','divinity','angel treasure chest','brittle','white chocolate','brie','happy birthday petit fours','chocolate covered nuts','royal chocolate petits fours','monkey backpack candy','pies','meltaways','pumpkin bark','mini cakes','walkers scottie dog shortbread','port wine cheese','beef sausage and cheese','summer sausage logs','monkey chocolate','liqueur','orange dreamsicle cake','lite beef log','strawberry tea service','mouse','pets','clocks','maple fudge','port wine cheese spread','toffee brickle','colby cheese','cheese dips','mixed nuts with 50% pistachios','treasure chest','pecan praline','gold','nut tins','bavarian','chocolate torte','toffee bites','original beef log','bavarian creme torte','easter family treats box','nut chocolate mix','honey mustard','daisy wreath','blue cheese','hotline to god','sweatshirt','diet candy','breakfast special delivery','pecan swirl','sugar free cherry cordials','lemon log','hearts','fudge pecan','beef and cheese','sea salt chocolates','happy birthday','zoo animals','order','jelly belly petits fours','elk sticks','almond bark','tiger','chocolate covered pecans','watches','wine','bacon cheese spread','food gifts','pancakes','red velvet cheese cake','fudge tin','pepperoni','coconut petit','amazing grace clock','scottie','panda','venison sticks','grapefruit','havarti cheese','gingerbread cookies','cream cheese spreads','chips','florentine','art','giraffe','grill set','glazed ham','apple pancake mix','edam cheese','classic spring chocolates','breakfast meats','peach cheesecake','garden vegetable dip','maple ham links','tea pot','fruitful delight','assorted petit fours','garden vegetable','holiday breakfast','garden vegetable spread','blueberry cheese','precious moments','chocolate potato chips','gift of plenty','potato stick candies','phones','mixed nuts tins','spicy cajun sticks','sausage assortment','cross','mini','pc','spring chocolates','apo fpo gifts','rum','shelled pistachio nuts','peanut butter truffles','dolls','sugar free taffy','baby doll','cajun','vegetable spread','coffee bark','72 mini all occasion petit fours','wheel of cheese','eagle','jelly','lion','blueberry','chocolate covered almonds','bunny log','art sets','orange cake','lily','chocolate pecan fudge','shelled pistachios','french vanilla cheesecake','butterfly chocolates','sugar free trail mix','chocolate gifts','maple','garlic cheese','pumpkin coffee','chocolate bunny','zigzag','luscious lemon cheesecake','banana split petite fours','happy easter petit fours','cheese and sausage sampler','angel in personalized treasure chest','14 country favorites','marble cheese board slicer','mint torte','fudge egg','friendship plate','pecan tarts','easter cakes','little lemon pies','candy sampler trio','lovable lapsies','birthday gifts','pants','walkers','brick','calories','favorite five cheese bars','nickel','spreadable sampler','candy basket','cordials','personalized valentine petits fours','summer','sugar free gluten free','mens sweaters','dream','fruit gels','peach candy','easter eggs','send catalog','easter bunny torte','heart cake','savory','assorted baklava','ham and bacon','mini cookie bites','caraway sausage','ingredients','vanilla petits fours','slippers','forest friends log','pastel coconut petit fours','rum cake','crab delight','sugar free truffles','lemon pies','fruit cake with rum','green','zigzag sweater','torte triple','crack','sugar','ham and pancakes','swiss','sugar free gummy fish','bagels','lobster dip','jelly bean tin','family treats box','red velvet petits','emoticon chocolates','snack mix','raccoon log','syrup','wild game meats','cat beds','spring truffles','bible','smores','chocolate log','john wayne tribute collection','spring pretzels','gourmet brownies','crab','sugar free petit','buns','my greatest blessings','chocolate hearts','no peanuts','bunny tortes','tower of treats','gingerbread spice cookies','spring bridge mix','beef log and cheese','hot and spicy cajun mix','backpack','spring petit','chocolate chip','valentine tower','personized zoo animals','strawberry bark','glasses','birthday brownie cookie','eagle hoodie','monster balls','potato sticks','pet beds','colossal breakfast','tortes of five','apply for credit','nut fruitcake','peppermint candy bites','torte cake','shipping chart','lime','mix and match','chocolate cake balls','pastel petit fours','strawberry lemon','no shipping','ham links','garden vegetable wheel','valentine pretzels','incredible','milk chocolate covered butter toffee','caramel pecan swirl','personalized chocolate','spring tower','cakelet','mini glass elephants','fresh flowers','sour candy','chocolate covered toffee','inspirational musical clock','fleece jacket','sausage and cheese box','fruit spread sampler','onion cheese','red velvet layer cake','carrot spice petit fours','incredible-spreadables','dog bed','breakfast and coffee','chocolate sampler','deluxe mixed nuts','no sugar added bread','personalized fudge egg','mini cookies','pepper bacon','children','swiss cheese and ham combo','spicy cajun beef sticks','belts','rocky road bonbons','meat stick bonanza','cajun beef sticks','mailbox','kreme kaese','pecan mix','candy sampler','dreamsicle','strawberry cheesecake','butter stollen','almond petit fours','chocolate covered butter toffee','grandma birthstone pendant','herb garden','irish','gluten free almond crunch','award winning','wallet','ginger','swirl','muffins','bunny salt and pepper shakers','breakfast special','caramel apple pie','valentine cake','monkey backpack','sugar free fudge','box of chocolates','chips covered with chocolate','confetti party bark','kaese','pancake and ham links','spring fruit gel slices','baby swiss wheel','walnut oatmeal pumpkin','rocky road swirl cake','swiss and cheddar log','blueberry cheddar','double guarantee','valentine\'s petit fours','fire glazed ham','beef summer sausage','aged swiss','chocolate cheesecake','72 petit','raccoon','bonanza','sharp cheddar cheese','salt and pepper shakers','pistachio nuts','covered cherries','bee and flower','chocolate toffee','natural pecans','florentine lace','slices','apple cinnamon','smoked bacon','inspirational clock','tropical','beeflog','pecan delights','mens belts','sharp cheese','batteries','tiger basket','haystacks','spring brownies','easter boxes tower','chocolate easter card','light up','lamb plush basket','easter nibbles basket','strawberry fudge','preserves','decorations','butter toffe','bunny','winter scene sweatshirt','fruity cheese','mustard gift set','jelly belly assortment','valentines day gifts','buffalo','lap','key lime petits fours','easter boxes','sentimental','valentines day petit fours','mint chocolate chip','lamb','baker cheeses','streusel swirl coffee cake','cheese bar and slicer','caramel chocolate','elk','florentine cookies','meat sticks and sauces','peach rings','gloves','select mixed nuts','chocolate-covered potato chips','tea cakes','petit four cake','premium nut','zoo basket trio','chocolate potato','chocolate with pecans','chick and egg tower','all nuts','butter cream','blueberry petit fours','50% off','caraway cheese','friends log','snack food bark','size chart','9','mood watch','fruit and nut','peppermint bites','cocktail','apple cake','smoked cheddar cheese spread','buttery toffee','nut varieties','scottie dog walkers','cheese spread and crackers','jalapeno beef log','bridge','gluten free mixes','mom or grandma birthstone pendant','maple walnut fudge','personalized valentine','sausage n cheese bar','pjs','box','personalized flask and wine tool set','wolf bottle opener','sugar free macadamia','cherry cordials','vintage','winter sweatshirt','sugar free pecan clusters','pepper cheese','lady','flask','rocky road','chocolate covered macadamia','sausage n cheese','soft center','5','valentines day chocolates','sugar free cheese cake','cow','chocolate pecan mix','muenster cheese','s\'mores bark','raspberry jellies','11 piece personalized bbq tool set','cashews and pecans','chris mouse chocolate','birthstone','roasted pecan','petit four 36','flavors','custom','incredible spreadables seafood','mint chocolate torte','melt in your mouth hearts','angel pendant','plush animals','cocktail petit fours','scottie shortbreads','mint bark','walkers shortbread','spicy sticks','creame de menthe','morsels','can','beans','bright eyes','valencia oranges','mint cheesecake','strawberry shortcake cheesecake','french vanilla bonbons','cranberry cheese','bison','scottie dog shortbread','sugar free bread','coffee cremes','bags','scottish shortbread','sugar-free petite fours','john','cookies and creme','cherry flavored jelly candies','swiss cheese spread','bbq tool set','ship to canada','chocolate mousse','pick and choose','butter crunch','gel','chocolate friend log','layered mints','hot cajun beef sticks','sugar free butter toffee crunch','strawberry shortcake petit fours','nut clusters','ancho chili cake balls','twinkle','stargazer lily','gifts under $20','pick n choose','sugar free fours','chocolate bites','port','stargazer','cheddar cheese spread','32 snacking favorites','vanilla cheesecake','chocolate chip cookies gluten free','chocolate butter toffee','front five favorites','hoodie zoo animal','supple leather','sixlets','lemon cheese cake','mint chocolate cheesecake','bbq set','cremes','filled cookies','smiling monkeys','roast','shaker','cutting','layer cake','sugar free fruitful delight','my','chocolate petite fors','candy corn','valentine mailbox','creamy cheddar','caramel clusters','hot','sugar free candy tin','butter mints','petit fours gift box','cheddar cheese spreadable','wild meat sticks','frames','chocolate covered cashews','apple cinnamon pancake','christmas fruitcake','pans','bacon cheddar','hoodie','favorite five tortes','bread mix','buffalo nickel dream catcher pendant','valentine fudge','chocolate heart cake','shipping fpo','big baby','breakfast petits','gluten free cheesecake','bars','binoculars','cashews almonds pecans brazils and filberts','toffe bites','bacon cheddar spread','bonbons fours','garlic summer sausage','filbert','zoo basket','peanut clusters','masterpiece baked ham','bison sticks','wireless','swiss cheese log','chees board','chocolate lace cookies','wildlife bottle opener','creme torte','lucky irish pendant','pepper seasoned bacon','sweet sausage','shipping to apo','tiger and hoodie','milk chocolate truffles','retro radio','l','mint-chocolate-torte','critter treat totes','gluten free cheese','mild jalapeno','spiral sliced ham with fired-in sugar glaze','the swiss colony chocolate truffles','vanilla bonbons','spanish peanuts','lemon almond','maple links','spiral sliced ham with fired in sugar glaze','spinach supreme','sharp','country','sausage n cheese bars gift of 10','sausages-n-cheese','owl family','deluxe','chocolate raisins','butter pecan fudge','when will it be shipped','bacon log','smile','personalized animals','sugar free chocolate pecan fudge','chocolate caramel and pecans','bison meat stick','smiley','bread gift of 9','fresh oranges','seafood incredible spreadables gift of 5','five sausage gift','swiss chees','chocolate fudge petit four','sausage n cheese bars gift of 4','chocolate bars','triple chocolate torte','swiss and ham cheese spread','orange bread','cheese ingredients','brazil','maple flavored ham links','spiral-sliced-ham','reed diffuser set','sugar free sale','swiss bacon','sugar-free cheesecake','sweet and hot incredible spreadable','french onion','11 piece bbq set','watermelon taffy','food tower','canada shipping','tangerines','covered macadamia nuts','sugar free chocolate cover','strawberry daiquiri','breakfast breads','trio of classic candy samplers','creamy swiss cheese','bacon cheese log','chocolatey potato chips','phone to god','sausages n cheese bars gift of 9','chris card','stone','colby cheese and summer sausage','shoe shine','red rind muenster','sweet basket','chocolate with nuts','special delivery','filbert creme','shrimp scampi','pleasers','fruity','sugar free tower','beef log with mustard','big logs','chocolate nut tin','mixed nuts 50 pistachio','chocolate torte cake','boneless-ham','marble board slicer','petit f','christmas log with raccoon','salted nuts','mini-butter-toffee','sweet and hot spreadables','five','sandwich','boxes of six','serving','sugar free holiday tower','santa jellies','crystal initial pendant','send a gift','swiss roll','crab spread','maple ham','sugar free merry christmas petits fours','petit ours','merry','chocolate buttons','snacktime','family games','sausage gift','spinach','boneless smoked ham','cheese sausage mustard','bone ham','mint dobosh torte','glaze','six','mixed chocolates','candy slices','chees logs','chocolate sample','front five','merry christmas petit','the jumbos gift of 6','cheese sausage torte gift samplers','cheese-cake','spiral','baby swiss and red cheddar','chris mouse pleaser','gift of 7','shoe shine kit','tin of pecans','smokey cheddar','pal','macadamia nut fruitcake','petit four gift samplers','for her','summer sausage cheese and tortes','cheese trio','two sweet','mini gift boxes','chocolate lovers','cheese sausage torte','forest cake','beef log gift of 6','maple sausage','pers giraffe hoodie','chees spread','mini butter toffe','chocolate cookies','cheddar logs','silver','sausage and chees','big red and swiss','sau','mouse cards','petit four tree','must','sweet bread','bars in logs','forest log','trio candy','genuine buffalo nickel dream catcher pendant','bacon smoked cheese spread','chocolate raspberry jellies','fire ham','cheese sets','six gift sampler','custard','the big ones','big baby swiss','cheese sausage and petit fours','sweet and savory','chocolate mint cake','sausage and petit fours','country ham','cheese gift box','port wine cheese logs','bacon cheddar cheese spread','pj s','bu','pers pet carrier','seasons favorite','cut rock','fruit box','sugar free christmas','postpaid chris mouse magical pleasers','sugar free pecan','swiss colony beef log','chocolate christmas mouse','chocolate trio','sausage and cheese tower','small tin','fired in ham','projector alarm clock','colossal','merry christmas chocolate','medley','case','crrrrisps','chocolate grahams','masterpiece','personalized-gifts','crab cheese','chocolate covered cake','butter-toffee','chocolate bonbons','fruit nut breads and cremes gift of 7','swiss and sausage','sugar free fish','take five','sale postpaid','chocolate covered mixed nuts','premium','gift of 72 petit fours','bible phone','cheese and fruit gifts','by christmas','#2 cheeses','personalized pet carrier','cheese box','sugar glazed ham','sugar free slices','chocolate tower','lucky irish','chocolate raccoon','baby swiss postpaid','swiss colony 27','temperature','sugar free gummies','holiday gift sets','shrimp cheese','holiday cakes','colossal nuts','three cakes','special blend coffee','cheddar pecan','sausage n cheese bars gift of 8','port wine with almonds','christmas ham','two hams','box summer sausage','carees','beef mustard','chocolate and mint logs','horatio','pers angel throw','food assortments','snack size','front','handout','game meat','hole punch','gift of 4 cheese and sausage','bone','cover','strawberry galettes','sugar free nuts','ganache','lil petites','beef summer','sausage and candy','nut trio','guardian treasure chest','coated pretzels','favorite fives cheese','hand decorated holiday cookies','filled','spiral glazed ham','gift of 72','sugar free vanilla cheesecake','soaring eagle fleece','old fashion toffee','chocolate p','triple chocolate','old cookies','gel candy','beef log food gift combo','4 free','hugger','coin pendant','butter truffles','fruit medley','petit fours sugar','old fashion ribbon candy','chocolate-filled straws');
/* $Revision: 6883 $
 *
 */

if(typeof(_sli_init )!='object'){var _sli_init=new Array();}
if(typeof(sli_init )!='function'){function sli_init(){ for(var x=0;x<_sli_init.length;x++) _sli_init[x]();}}
if(typeof(asPhrases)!='object'){ var asPhrases = new Array(); }
if(typeof(__SLI_customisations)!='object'){var __SLI_customisations = new Object();}
if(typeof(__SLI_ClientDefaults)!='object'){ var __SLI_ClientDefaults=[]; }
if(typeof(__SLI_validSearchBoxes)!='object'){ var __SLI_validSearchBoxes = new Array(); }
if(typeof(__SLI_asug_used_flag)!='object'){ var __SLI_asug_used_flag = false; }
if(typeof(__SLI_width)!='object'){ var __SLI_width = 0; }
if(typeof(sli_targeturl)!='object'){ var sli_targeturl = ""; }


    __AutoComplete = new Object(); //namespace...
    __AutoComplete_mouseMoved=false;

    // Basic UA detection
    isIE = document.all ? true : false;
    isGecko = navigator.userAgent.toLowerCase().indexOf('gecko') != -1;
    isOpera = navigator.userAgent.toLowerCase().indexOf('opera') != -1;

    /* defaults and options */

    var __SLI_ApplicationName = 'AutoSuggest';
        __SLI_customisations[ 'AutoSuggest' ] =
                {
                    'ShowBrandingFooter' : true
                    ,
                    'TextBoxIDPrefix' : 'sli_search_'
                    ,
                    'BrandingFooterImagePath' : 'http://assets.resultspage.com/autosuggest/sli_systems-powered_150_15.gif'
                    ,
                    'BrandingFooterTitleTooltip' : 'AutoSuggest Powered by SLI Systems'
                    ,
                    'DropListMinWidth' : 150
                    ,
                    'MaxListItems' : 10
                    ,
                    'Alignment' : true
                    ,
                    'TextBoxIDCustom' : []
                    ,
                    'ValidSearchBoxes' : false 
                    ,
                    'IE6SelectBox' : false 
                    ,
                    'IE6SelectBoxPadding' : 0
                    ,
                    'TargetURL' : ''
                    ,
                    'IframeAlignment' : false
                    ,
                    'AlignmentBorderBug' : false
                    ,
                    'IE6OnFocus' : false
                };
    /* 0 = keyname, 1 = value */
    for( defaultValuePair in __SLI_ClientDefaults )
    {
        __SLI_customisations[__SLI_ApplicationName][__SLI_ClientDefaults[defaultValuePair][0]]=__SLI_ClientDefaults[defaultValuePair][1];
    }

    /* pre-fetch branding footer image if being used...
     */
    if( __SLI_customisations[ __SLI_ApplicationName ][ 'ShowBrandingFooter' ] )
    {
        
        if(location.protocol == "https:")
        {
            __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ] = __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ].replace(/http:/i, 'https:');
        }
    
        var __AutoCompleteBranding = new Image();
        __AutoCompleteBranding.src=__SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterImagePath' ];
    }


    function AutoComplete_init()
    {
        if(!isOpera)
        {
            var oldonresize=function(){};
            if(typeof(window.onresize)=='function')
                oldonresize = window.onresize;//play nicely with other people's toys
            window.onresize= function(){ oldonresize(); AutoComplete_HideAll(); AutoComplete_Create( asPhrases ); }

            AutoComplete_Create( asPhrases );
            
            var els = document.getElementsByTagName('input');
            if(els)
            {
               for ( i = 0; i < els.length; i++ )
               {
                  if(els[i].name == "asug")
                  {
                     els[i].disabled = true;
                  }
               }
            }
        }
    }




    /**
    * Attachs the autocomplete object to a form element. Sets
    * onkeypress event on the form element.
    *
    * @param string formElement Name of form element to attach to
    * @param array  data        Array of strings of which to use as the autocomplete data
    */
    //function AutoComplete_Create (id, data)
    /*
     * iterate over 'sli_search_*' assumes one or more search boxes numbered from 1...
    */
    function AutoComplete_Create( data )
    {
        var idx=1, e, id, searchBoxPrefix=__SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDPrefix' ];
        while( e = document.getElementById(searchBoxPrefix+idx) )
        {
            AutoComplete_AttachHandlers(e, data);
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
                __SLI_validSearchBoxes.push(searchBoxPrefix+idx);
            }
            idx++;
        }
        
        
        //this array comes from the customised list
        var otherTextBoxIdList = __SLI_customisations[ __SLI_ApplicationName ][ 'TextBoxIDCustom' ];
        if( otherTextBoxIdList)
        {
            for(idx=0;idx<otherTextBoxIdList.length;idx++)
            {
                e = document.getElementById(otherTextBoxIdList[idx]);
                if(e)
				{
					if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
                	{
	                    __SLI_validSearchBoxes.push( otherTextBoxIdList[idx] );
                	}
					AutoComplete_AttachHandlers(e, data);
				}
            }
        }
        
    } 

    function AutoComplete_AttachHandlers(e, data){
        var iframe,id;
        id=e.id;


        __AutoComplete[id] = {'data':data,
                              'isVisible':false,
                              'element':document.getElementById(id),
                              'dropdown':null,
                              'highlighted':null};

        __AutoComplete[id]['element'].setAttribute('autocomplete', 'off');
        __AutoComplete[id]['element'].onkeydown = function(e) {if (!e) e = window.event; return AutoComplete_KeyDown(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onkeyup = function(e) {if (!e) e = window.event; return AutoComplete_KeyUp(this.getAttribute('id'), e);}
        // The function call on the next line was changed by Andrew Grieve April 2008
        __AutoComplete[id]['element'].onkeypress = function(e) {if (!e) e = window.event; return AutoComplete_KeyPress(this.getAttribute('id'), e);}
        __AutoComplete[id]['element'].onclick = function(e)
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6OnFocus' ] )
            {
                __AutoComplete[id]['element'].focus();
            }
            if (!e) e = window.event; e.cancelBubble = true; e.returnValue = false;
        }



        // Hides the dropdowns when document clicked
        var docClick = function()
        {
            if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
            {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
            }
            else
            {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
            }
        }

        if (document.addEventListener) {
            document.addEventListener('click', docClick, false);
        } else if (document.attachEvent) {
            document.attachEvent('onclick', docClick, false);
        }


        // Max number of items shown at once
        if (arguments[2] != null) {
            __AutoComplete[id]['maxitems'] = arguments[2];
            __AutoComplete[id]['firstItemShowing'] = 0;
            __AutoComplete[id]['lastItemShowing'] = arguments[2] - 1;
        }

        AutoComplete_CreateDropdown(id);

        // Prevent select dropdowns showing thru
        if (isIE) {
            iframe = document.createElement('iframe');
            __AutoComplete[id]['iframe'] = iframe;
                iframe.id = id +'_iframe';
                iframe.style.position = 'absolute';
                iframe.style.top = '0';
                iframe.style.left = '0';
                iframe.style.width = '0px';
                iframe.style.height = '0px';
                iframe.style.zIndex = '98';
                iframe.style.visibility = 'hidden';
                
                if(location.protocol == "https:")
                {
                   iframe.src = 'https://assets.resultspage.com/autosuggest/blank.html';
                }
                
                if( __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBox' ] )
                {
                  iframe.style.width = __SLI_width  + __SLI_customisations[ __SLI_ApplicationName ][ 'IE6SelectBoxPadding'];
                }

            if( __SLI_customisations[ __SLI_ApplicationName ][ 'IframeAlignment' ] )
            {
                document.body.insertBefore( iframe );
            }
            else
            {
                __AutoComplete[id]['element'].parentNode.insertBefore( iframe, __AutoComplete[id]['element'] );
            }
        }
    }

    /**
    * Creates the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_CreateDropdown(id)
    {
        var theSearchbox = __AutoComplete[id]['element'];
        var theDropDown;
        var left_top = AutoComplete_getPos( theSearchbox );
        var left  = left_top[0];
        var top   = left_top[1] + theSearchbox.offsetHeight;
        var width = theSearchbox.offsetWidth;

        if ( width < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
        {
            width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
        }

        theDropDown = document.createElement('div');
        theDropDown.className = 'autocomplete'; // Don't use setAttribute()


        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true && document.body)
        {
            theDropDown.style.position = 'absolute';
            document.body.insertBefore(theDropDown, document.body.nextSibling);
            
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        else if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "offsetrelative" && document.body)
        {
          theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
          // Position it
          if(sli_getStyle(theSearchbox.offsetParent, 'position') != "absolute")
          {
            theSearchbox.offsetParent.style.position = 'relative';
          }
          theDropDown.style.position = 'absolute';
          theDropDown.style.left = (theSearchbox.offsetLeft) + 'px';
          theDropDown.style.top = (theSearchbox.offsetTop + theSearchbox.offsetHeight) + 'px';
          if ( theSearchbox.clientWidth < __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ] )
          {
            theDropDown.style.width = __SLI_customisations[ __SLI_ApplicationName ][ 'DropListMinWidth' ];
          }
          else
          {
            theDropDown.style.width = (theSearchbox.clientWidth) + 'px';
          }
          theDropDown.style.visibility = 'hidden';
          theDropDown.style.zIndex     = '99999999';
        }
        else
        {
            theSearchbox.parentNode.insertBefore(theDropDown, theSearchbox);
            // Position it
            theDropDown.style.visibility = 'hidden';
            theDropDown.style.left       = left + 'px';
            theDropDown.style.top        = top + 'px';
            theDropDown.style.width      = width + 'px';
            theDropDown.style.zIndex     = '99999';
        }
        

        __AutoComplete[id]['dropdown'] = theDropDown;
        __SLI_width = width;
    }

    function /* array [ left, top ] */ AutoComplete_getPos( obj )
    {
        var curleft = curtop = 0;
        var sli_flag = 0;

        if (obj.offsetParent)
        {
           do
           {
              if ( __SLI_customisations[ __SLI_ApplicationName ][ 'AlignmentBorderBug' ] )
              {         
                
                if(sli_flag == 1)
                {
                    var clientTop = (obj.offsetHeight - obj.clientHeight) / 2;
                    curtop += clientTop;

                    var clientLeft = (obj.offsetWidth - obj.clientWidth) / 2;
                    curleft += clientLeft;
                }
                sli_flag = 1;
              }
           
              curleft += obj.offsetLeft;
              curtop += obj.offsetTop;
           }
           while (obj = obj.offsetParent);
        }
        return [curleft,curtop];
    }

    /**
    * Shows the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ShowDropdown(id)
    {

        AutoComplete_HideAll();



        var value = __AutoComplete[id]['element'].value;
        var toDisplay = new Array();
        var newDiv    = null;
        var text      = null;
        var numItems  = __AutoComplete[id]['dropdown'].childNodes.length;

        __AutoComplete_mouseMoved=false;
        // SLI Code Modification - Start - Andrew Grieve April 08
        // Trim the textbox so that if is starts with a space then the feature will still work
        //value = value.replace(/^\s+|\s+$/g,"");
        value = value.replace(/^\s+/g,"");

        if(value.length == "")
        {
            // If Textbox length is nothing (after the trim) then don't show dropdown.
            return;
        }
        // SLI Code Modification - End

        // Remove all child nodes from dropdown
        while (__AutoComplete[id]['dropdown'].childNodes.length > 0) {
            __AutoComplete[id]['dropdown'].removeChild(__AutoComplete[id]['dropdown'].childNodes[0]);
        }


        var count=0;
        // Go thru data searching for matches
        for (i=0; i<__AutoComplete[id]['data'].length; ++i)
        {
            // SLI Code Modification - Start - Andrew Grieve April 08 - Added lower casing
            if (__AutoComplete[id]['data'][i].substr(0, value.length).toLowerCase() == value.toLowerCase())
            {
                // SLI Code Modification - End
                toDisplay[toDisplay.length] = __AutoComplete[id]['data'][i];
                count++;
                /* how many to display? */
                if(count == __SLI_customisations['AutoSuggest']['MaxListItems'] ) /* Code inserted to keep list to a maximum of 10 values (was 20 or 30) */
                {
                    break;
                }
            }
        }

        // No matches?
        if (toDisplay.length == 0) {
            AutoComplete_HideDropdown(id);
            return;
        }



        // Add data to the dropdown layer
        for (i=0; i<toDisplay.length; ++i) {
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_item'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';

             // Scrollbars are on display ?
            if (toDisplay.length > __AutoComplete[id]['maxitems'] && navigator.userAgent.indexOf('MSIE') == -1) {
                newDiv.style.width = __AutoComplete[id]['element'].offsetWidth - 22 + 'px';
            }

            newDiv.onmouseover =
        function()
        {
            if( __AutoComplete_mouseMoved )
                AutoComplete_HighlightItem(__AutoComplete[id]['element'].getAttribute('id'), this.getAttribute('index'));
        };

            newDiv.onclick     =    function()
                                    {
                                    	  __SLI_asug_used_flag = true;
                                                                           
                                        AutoComplete_SetValue(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_HideDropdown(__AutoComplete[id]['element'].getAttribute('id'));
                                        AutoComplete_submitForm(id);
                                    }



            text   = document.createTextNode(toDisplay[i]);
            newDiv.appendChild(text);
            newDiv.title='Search for ' + toDisplay[i];

            /* ellipsis for IE only */
            if( isIE )
            {
                newDiv.style.textOverflow = 'ellipsis';
                newDiv.style.width = '100%';
                newDiv.style.whiteSpace = 'nowrap';
                newDiv.style.overflow = 'hidden';

            }
            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }
        /*
         * append DIV containing footer branding...
         */
        if(__SLI_customisations['AutoSuggest']['ShowBrandingFooter'])
        {
            i = toDisplay.length;
            newDiv = document.createElement('div');
            newDiv.className = 'autocomplete_footer'; // Don't use setAttribute()
            newDiv.setAttribute('id', 'autocomplete_item_' + i);
            newDiv.setAttribute('index', i);
            newDiv.style.zIndex = '99999';
            newDiv.innerHTML = '<a href="http://www.sli-systems.com/powered-by.php" title="' +
                                __SLI_customisations[ __SLI_ApplicationName ][ 'BrandingFooterTitleTooltip' ] +
                                '"><img class="autocomplete_footer_branding" src="'+__AutoCompleteBranding.src+'" /></a>';

            __AutoComplete[id]['dropdown'].appendChild(newDiv);
        }


        // Too many items?
        if (toDisplay.length > __AutoComplete[id]['maxitems']) {
            __AutoComplete[id]['dropdown'].style.height = (__AutoComplete[id]['maxitems'] * 15) + 2 + 'px';

        } else {
            __AutoComplete[id]['dropdown'].style.height = '';
        }


        /**
        * Set left/top in case of document movement/scroll/window resize etc
        */
        if(__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "true" || __SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == "false")
        {
            var left_top = AutoComplete_getPos( __AutoComplete[id]['element'] );
            __AutoComplete[id]['dropdown'].style.left = left_top[0];
            __AutoComplete[id]['dropdown'].style.top  = left_top[1] + __AutoComplete[id]['element'].offsetHeight;
        }


        // Show the iframe for IE
        if (isIE) {
            
            if(!__SLI_customisations[ __SLI_ApplicationName ][ 'Alignment' ] == true)
            {
               __AutoComplete[id]['iframe'].style.width  = __AutoComplete[id]['dropdown'].offsetWidth;
            }
            
            
            __AutoComplete[id]['iframe'].style.top    = __AutoComplete[id]['dropdown'].style.top;
            __AutoComplete[id]['iframe'].style.left   = __AutoComplete[id]['dropdown'].style.left;
            __AutoComplete[id]['iframe'].style.height = __AutoComplete[id]['dropdown'].offsetHeight;

            __AutoComplete[id]['iframe'].style.visibility = 'visible';
        }

    e =  __AutoComplete[id]['dropdown'];

    e.onmousemove =
        function()
        {
            if(!__AutoComplete_mouseMoved){__AutoComplete_mouseMoved=true;}
            this.onmousemove = null;
        }

        // Show dropdown
        if (!__AutoComplete[id]['isVisible']) {
            __AutoComplete[id]['dropdown'].style.visibility = 'visible';
            __AutoComplete[id]['isVisible'] = true;
        }


        // If now showing less items than before, reset the highlighted value
        if (__AutoComplete[id]['dropdown'].childNodes.length != numItems) {
            __AutoComplete[id]['highlighted'] = null;
        }
    }



    /**
    * Hides the dropdown layer
    *
    * @param string id The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_HideDropdown(id)
    {
        if (__AutoComplete[id]['iframe'])
        {
            __AutoComplete[id]['iframe'].style.visibility = 'hidden';
        }
        
        if (__AutoComplete[id]['dropdown'])
        {
            __AutoComplete[id]['dropdown'].style.visibility = 'hidden';
        }

        __AutoComplete[id]['highlighted'] = null;
        __AutoComplete[id]['isVisible']   = false;
    }


    /**
    * Hides all dropdowns
    */
    function AutoComplete_HideAll()
    {
         if( __SLI_customisations[ __SLI_ApplicationName ][ 'ValidSearchBoxes' ] )
         {
               for(var i=0; i < __SLI_validSearchBoxes.length; i++)
               {
                   if(document.getElementById(__SLI_validSearchBoxes[i]))
                   {
                       AutoComplete_HideDropdown(__SLI_validSearchBoxes[i]);
                   }
               }
         }
         else
         {
                for (id in __AutoComplete)
                {
                   AutoComplete_HideDropdown(id);
                }
         }
    }


    /**
    * Highlights a specific item
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_HighlightItem(id, index) // mouseover, index is the list element index, zero-based
    {
        if (__AutoComplete[id]['dropdown'].childNodes[index]) {
            for (var i=0; i<__AutoComplete[id]['dropdown'].childNodes.length; ++i) {
                if (__AutoComplete[id]['dropdown'].childNodes[i].className == 'autocomplete_item_highlighted') {
                    __AutoComplete[id]['dropdown'].childNodes[i].className = 'autocomplete_item';
                }
            }

            __AutoComplete[id]['dropdown'].childNodes[index].className = 'autocomplete_item_highlighted';
            __AutoComplete[id]['highlighted'] = index;

            //also see below...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[index].innerHTML;
            //AutoComplete_SetValue(id);
        }
    }


    /**
    * Highlights the menu item with the given index
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    * @param int    index The index of the element in the dropdown to highlight
    */
    function AutoComplete_Highlight(id, index) // keyboard up/down - index is the direction of travel, 1==down,-1=up
    {
        var childNodes = __AutoComplete[id]['dropdown'].childNodes;
        if(childNodes.length)
        {
	        var lastItem = ( ( childNodes[ childNodes.length - 1 ].className != 'autocomplete_footer' ) ? childNodes.length - 1 : childNodes.length - 2 );

            // Out of bounds checking
            //if (index == 1 && __AutoComplete[id]['highlighted'] == __AutoComplete[id]['dropdown'].childNodes.length - 1) {
            if (index == 1 && __AutoComplete[id]['highlighted'] == lastItem ) {
                childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = null;

            } else if (index == -1 && __AutoComplete[id]['highlighted'] == 0) {
                childNodes[0].className = 'autocomplete_item';
                __AutoComplete[id]['highlighted'] = lastItem;
                index = 0;//hack!
            }

            // Nothing highlighted at the moment
            if (__AutoComplete[id]['highlighted'] == null) {

                childNodes[0].className = 'autocomplete_item_highlighted';
                __AutoComplete[id]['highlighted'] = 0;
                newIndex = 0;
                
            } else {

                if (childNodes[__AutoComplete[id]['highlighted']]) {
                
                    childNodes[__AutoComplete[id]['highlighted']].className = 'autocomplete_item';
                }

                var newIndex = parseInt( __AutoComplete[id]['highlighted'] ) + parseInt(index);

                if (childNodes[newIndex]) {

                    childNodes[newIndex].className = 'autocomplete_item_highlighted';

                    __AutoComplete[id]['highlighted'] = newIndex;
                }
            }

            //populate textbox with currently highlighted term...
            //__AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[newIndex].innerHTML;
            AutoComplete_SetValue(id);
        }
    }


    /**
    * Sets the input to a given value
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_SetValue(id)
    {
        __AutoComplete[id]['element'].value = __AutoComplete[id]['dropdown'].childNodes[__AutoComplete[id]['highlighted']].innerHTML.replace(/&amp;/, "&");
    }


    /**
    * Checks if the dropdown needs scrolling
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_ScrollCheck(id)
    {
        // Scroll down, or wrapping around from scroll up
        if (__AutoComplete[id]['highlighted'] > __AutoComplete[id]['lastItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'] - (__AutoComplete[id]['maxitems'] - 1);
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'];
        }

        // Scroll up, or wrapping around from scroll down
        if (__AutoComplete[id]['highlighted'] < __AutoComplete[id]['firstItemShowing']) {
            __AutoComplete[id]['firstItemShowing'] = __AutoComplete[id]['highlighted'];
            __AutoComplete[id]['lastItemShowing']  = __AutoComplete[id]['highlighted'] + (__AutoComplete[id]['maxitems'] - 1);
        }

        __AutoComplete[id]['dropdown'].scrollTop = __AutoComplete[id]['firstItemShowing'] * 15;
    }


    /**
    * Function which handles the keypress event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyDown(id, e)
    {
        var result = true;

       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {

            // Return/Enter
            case 13:
                if (__AutoComplete[id]['highlighted'] != null) {
                    AutoComplete_SetValue(id);
                    AutoComplete_HideDropdown(id);
					
                    __SLI_asug_used_flag = true;
					
                    if( e = __AutoComplete[id]['element'].form['asug'] )
                    {
                        
                        e.disabled=false;
                        e.value = __AutoComplete[id]['asug'];
                    }

                }

                result = AutoComplete_submitForm(id);

                break;

            // Escape
            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            // Up arrow
            case 38:
                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, -1);
                AutoComplete_ScrollCheck(id, -1);
                
                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                                
                result = false;
                break;

            // Tab
            case 9:
                if (__AutoComplete[id]['isVisible']) {
                    AutoComplete_HideDropdown(id);
                }
                return;

            // Down arrow
            case 40:

                if (!__AutoComplete[id]['isVisible']) {
                    AutoComplete_ShowDropdown(id);
                }

                AutoComplete_Highlight(id, 1);
                //AutoComplete_ScrollCheck(id, 1);

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=false;
                   e.value = __AutoComplete[id]['asug'];
                }

                result = false;
                break;
        }
        return result;
    }


    /**
    * Function which handles the keyup event
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_KeyUp(id, e)
    {
       var event;
       event = e;
       if(!event) event = window.event;

        var keyCode = event.keyCode;

        switch (keyCode) {
            case 13:
                event.returnValue = false;
                event.cancelBubble = true;
                
                break;

            case 27:
                AutoComplete_HideDropdown(id);
                event.returnValue = false;
                event.cancelBubble = true;
                break;

            case 38:
            case 40:
                return false;
                break;

            default:
                AutoComplete_ShowDropdown(id);
                
                __AutoComplete[id]['asug']=__AutoComplete[id]['element'].value;

                if( e = __AutoComplete[id]['element'].form['asug'] )
                {
                   e.disabled=true;
                   e.value = "";
                }  
                
                break;
        }
    }

    /**
    * Function which handles the keypress event
    * This function added April 2008 by Andrew Grieve
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */

    // SLI Code Modification - Start - Andrew Grieve April 08
    function AutoComplete_KeyPress(id, e)
    {
        var event = e;
        if(!event) event = window.event;
        var keyCode = event.keyCode;

        if (keyCode == 13 && isGecko || isOpera)
        {
            return false;
        }
        
        if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
        {
            if (keyCode == 13 && isIE)
            {
                return false;
            }
        }
        
    }
    // SLI Code Modification - End

    /**
    * Returns whether the dropdown is visible
    *
    * @param string id    The form elements id. Used to identify the correct dropdown.
    */
    function AutoComplete_isVisible(id)
    {
        return __AutoComplete[id]['dropdown'].style.visibility == 'visible';
    }

    function AutoComplete_submitForm(id)
    {
      var e, f, result=true;
      if( f = __AutoComplete[id]['element'].form )
      {
        if( __AutoComplete[id]['element'].value != '' )
        {
          if(__SLI_asug_used_flag == true)
          {
            if( e = f['asug'])
            {
              e.value = __AutoComplete[id]['asug'];
              e.disabled=false;
            }
          }

          if( __SLI_customisations[ __SLI_ApplicationName ][ 'TargetURL' ] )
          {
            asugvar = "";
            if(__SLI_asug_used_flag == true)
            {
              asugvar = '&asug=' + escape(__AutoComplete[id]['asug']);
            }

            sliRegex = /resultsdemo\.com/;
            if(sliRegExArray = sliRegex.exec(document.domain))
            {
              sliRegex = /^http:\/\/(.*)\//;
              sliTargetDomain = sliRegex.exec(__SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ]);
              __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ].replace(sliTargetDomain[1], document.domain);
            }

            document.location.href = __SLI_customisations[__SLI_ApplicationName ][ 'TargetURL' ] + escape(__AutoComplete[id]['element'].value) + asugvar;
          }
          else
          {
            if(f.onsubmit)
            {
              if(f.onsubmit() !== false)
              {
                f.submit();
              }
            }
            else
            {
              f.submit();
            }
          }

          AutoComplete_HideAll();
        }
        else
          result = false;
      }
      return result;
    }
    
    // get the style that will be applied by the browser, including stylesheets
    function sli_getStyle(el,styleProp)
    {
      if (el.currentStyle)
        var y = el.currentStyle[styleProp];
      else if (window.getComputedStyle)
        var y = document.defaultView.getComputedStyle(el,null).getPropertyValue(styleProp);
      return y;
    }

    // register with onLoad(er...
    _sli_init.push( AutoComplete_init );
    
    function sli_addEvent(obj, evType, fn) {
    	if (obj.addEventListener) {
    		obj.addEventListener(evType, fn, false);
    		return true;
    	} else if (obj.attachEvent) {
    		var r = obj.attachEvent("on" + evType, fn);
    		return r;
    	} else {
    		return false;
    	}
    }
    
    function sli_load()
    {
    	sli_addEvent(window, 'load', sli_init);
    }