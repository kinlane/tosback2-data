var gigyaEventObj,objGigya={uiAction:"",options:{},licenseKey:gigyaLicenseKey,conf:{APIKey:gigyaLicenseKey,connectWithoutLoginBehavior:"alwaysLogin"},hostProtocol:(("https:"==document.location.protocol)?"https://cdns":"http://cdn"),ready:false,multipleOptions:new Array(),isJSLoaded:false,_loadGigyaJS:function(){if(!ObjBrowserDetect.isIE7()){this.ready=true;
}else{$(document).trigger("gigyaReady",false);}if(this.ready&&window.gigyaSocializeLoaded==null){window.onGigyaServiceReady=function(){objGigya.isJSLoaded=true;gigya.services.socialize.addEventHandlers(objGigya.conf,{context:{str:"Logged in."},onLogin:objGigya.onLoginHandler,onLogout:objGigya.onLogoutHandler});
$(document).trigger("gigyaReady",true);};jQuery.getScript(this.hostProtocol+".gigya.com/JS/socialize.js?apikey="+this.licenseKey);window.gigyaSocializeLoaded=true;}},_create:function(a){if(this.ready){this.uiAction=a;$(".gigyaTitle").show();this._init();}else{$(".gigyaTitle").hide();}},_init:function(){switch(this.uiAction){case"showLoginUI":gigya.services.socialize.showLoginUI(this.conf,this.options);
break;case"getUserInfo":gigya.services.socialize.getUserInfo(this.conf,{callback:this.renderUI});break;case"showShareUI":this.showShareUIButton();this.uiShareBarFix();break;case"showShareBarUI":gigya.services.socialize.showShareBarUI(this.conf,this.options);this.uiShareBarFix();break;case"showShareUIWidget":gigya.services.socialize.showShareUI(this.conf,this.options);
break;}},isReady:function(){if(this.ready){$(".gigyaTitle").show();}else{$(".gigyaTitle").hide();}return this.ready;},renderUI:function(b){if(b.user!=null&&b.user.isConnected){$("ul.userLoggedIn #noprofile").css("display","none");$("ul.userLoggedIn #name").html(b.user.firstName);var a=(("https:"==document.location.protocol)?"https://":"http://");
b.user.thumbnailURL=b.user.thumbnailURL.replace("http://",a);if(b.user.thumbnailURL.length>0){$("ul.userLoggedIn #photo").attr("src",b.user.thumbnailURL);}else{$("ul.userLoggedIn #photo").attr("src",a+"cdn.gigya.com/site/images/bsAPI/Placeholder.gif");}$("ul.userLoggedIn #profile").fadeIn("slow");}},onLoginHandler:function(a){gigyaEventObj=a;
querystring="/bzJApp/Proxy.action?actionName=GigyaLogon&method=p&dest=c&sid="+SiteID+"&tid="+TenantID+"&pageload="+RandomNumber+"&params=";jQuery.ajax({url:querystring,type:"POST",data:{"gigyaJson":JSON.stringify(a)},cache:false,timeout:ajaxTimeouts["mediumTimeout"],success:objGigya.gigyaLoginCallback});
},onLogoutHandler:function(a){},gigyaLoginCallback:function(a){var b=JSON.parse(a);if($("#ajax_dialogReturnUrl").length>0){redirectUrl=$("#ajax_dialogReturnUrl").val();}else{redirectUrl=window.location.href;}redirectUrl=redirectUrl.replace("&gigyaEmailLink=Y","");redirectUrl=redirectUrl.replace("showLogin=true","").replace("showLogin=confirm","");
if($("#ajax_dialogReturnUrl").length>0){objGigya.processLoginDialogResponse(b.action,redirectUrl);}else{objGigya.proccessDefaultResponse(b.action,redirectUrl);}},gigyaLoginCallbackError:function(a){},proccessDefaultResponse:function(b,a){switch(b){case"LOGGED_IN":window.location.replace(a);break;case"REGISTERED":window.location.replace(gigyaResponse.nextPage);
break;case"LINKING_REQUIRED":case"EMAIL_UNAVAILABLE":window.location.replace(securePrefix+"/bzJApp/ViewDialog.action?pageName=signupComplete&sid="+SiteID+"&tid="+TenantID+"&versionID="+VersionID+"&gigyaEmailLink=Y"+"&email="+encodeURIComponent(gigyaEventObj.user.email)+"&gigyaUID="+encodeURIComponent(gigyaEventObj.UID));
break;}},processLoginDialogResponse:function(b,a){switch(b){case"LOGGED_IN":$("#login_error_message").text("You are in! Welcome.").show();$(document).trigger("userLoggedIn");window.location.replace(securePrefix+"/bzJApp/ViewDialog.action?pageName=signupComplete&sid="+SiteID+"&tid="+TenantID+"&versionID="+VersionID+"&returnURL="+encodeURIComponent(a));
break;case"REGISTERED":window.location.replace(securePrefix+"/bzJApp/ViewDialog.action?pageName=signupComplete&sid="+SiteID+"&tid="+TenantID+"&versionID="+VersionID+"&returnURL="+encodeURIComponent(a));break;case"EMAIL_UNAVAILABLE":case"LINKING_REQUIRED":window.location.replace(securePrefix+"/bzJApp/ViewDialog.action?pageName=signupComplete&sid="+SiteID+"&tid="+TenantID+"&versionID="+VersionID+"&gigyaEmailLink=Y"+"&email="+encodeURIComponent(gigyaEventObj.user.email)+"&gigyaUID="+encodeURIComponent(gigyaEventObj.UID))+"&returnURL="+encodeURIComponent(a);
break;case"LOGIN_FAILED":$("div#login_error_message").text(gigyaResponse.errorMessage);break;}},showShareUIButton:function(){jQuery.each(this.multipleOptions,function(b,c){var a=b+1;jQuery("#share_"+a).live("click",function(){gigya.services.socialize.showShareUI(c);});});},logout:function(){if(gigya!=null&&gigya.socialize!=null){gigya.socialize.logout({callback:function(a){if(a.errorCode==0){location.href=hostName+"bzJApp/CustomerLogout.action?sid="+SiteID+"&tid="+TenantID;
}}});}else{location.href=hostName+"bzJApp/CustomerLogout.action?sid="+SiteID+"&tid="+TenantID;}},uiShareBarFix:function(){setTimeout(function(){$("div.gig-share-counter").css({"font-size":"11px"});},60);}};$().ready(function(){setTimeout(function(){objGigya._loadGigyaJS();},1000);});