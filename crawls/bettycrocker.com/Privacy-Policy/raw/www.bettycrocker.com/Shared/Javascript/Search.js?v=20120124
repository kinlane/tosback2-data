function FireMarinaScriptForSearch(a){MarinaTagEnabled==true&&fireMarin(a)}var searchText;function OnSearchButtonClick(g,d,j,l,i,k,f,h){var a=jQuery.trim(document.getElementById(d).value),b=jQuery("#"+h).val();if(a!=null)if(a.length>0&&a!=i){ApplyUnicaEventTag("ev=search_BT&sitekeyword="+a.toLowerCase());if(b.length<=0)b=j;var c="";if(urlParams.st>0&&b>4&&urlParams.st>4)c=g+"?st="+urlParams.st+"&term="+a;else c=g+"?st="+b+"&term="+a;if(jQuery("#"+d).attr("ListViewAttribute")!=null){var e=getUrlVars().fv;if(b>4&&urlParams.st>4&&e!=null&&e.length>0)c=c+"&fv="+e}document.getElementById(d).disabled=true;document.getElementById(d).value=k;LogSearch(a,"",true,false);FireMarinaScriptForSearch("search_bc");window.location.href=c}else alert(f);else alert(f)}function LogSearch(f,a,b,e){var d="/Shared/Search/Services/SearchService.asmx/Log",c="{'searchTerm':'"+f+"','navValues':'"+a+"','isLogRequired':'"+b+"'}";jQuery.ajax({type:"POST",url:d,data:c,async:e,cache:false,timeout:3e4,contentType:"application/json; charset=utf-8",dataType:"json",success:function(){return true},error:function(){return false}})}function getUrlVars(){var a={},b=window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(d,c,b){a[c]=b});return a}function GetSearchOption(c,b,a){if(jQuery("#"+a).is(":visible"))jQuery("#"+a).hide();else jQuery("#"+a).show();BindSearchOptionsLinkEvent(b,a)}function BindSearchOptionsLinkEvent(b,a){jQuery("#"+a+" a").click(function(){jQuery("#"+a+" a").removeClass("current");jQuery(this).addClass("current");var c=jQuery("#"+this.id+"SearchTypeHiddenField").val();jQuery("#"+b).val(c);jQuery("#"+a).hide();if(jQuery.trim(searchText)=="")searchText=jQuery("[id$=SearchLinkButton]").eq(1).text();if(c!=7)jQuery("[id$=SearchLinkButton]").eq(1).text(searchText.substring(0,searchText.indexOf(" ")));else jQuery("[id$=SearchLinkButton]").eq(1).text(searchText);return false})}function GetHeaderSearchOptionButton(b,d,a,e,c,f){if(jQuery("#"+a).is(":visible")){jQuery("#"+a).hide();jQuery(b).attr("src",c)}else{jQuery("#"+a).show();jQuery(b).attr("src",f)}BindHeaderSearchOptionsLinkEvent(d,a,b,c);BindHeaderTextBoxFocus(e,a,b,c)}function BindHeaderSearchOptionsLinkEvent(c,a,e,d){var b=jQuery("#"+a+" a");b.click(function(){var f=jQuery(this);b.removeClass("current");f.addClass("current");var g=jQuery("#"+this.id+"SearchTypeHiddenField").val();jQuery("#"+c).val(g);jQuery("#"+a).hide();jQuery(e).attr("src",d);jQuery("#headerSearchOptionsSelected").text(f.text());return false})}function BindHeaderTextBoxFocus(b,a,d,c){jQuery("#"+b).focus(function(){jQuery("#"+a).hide();jQuery(d).attr("src",c)})}function onSortingDropdownListChange(a){window.location.href=getSortingRedirectionUrl(a.value)}function getSortingRedirectionUrl(f){var d=window.location.toString().split("?"),e=d[1],a="";if(e)for(var c=e.split("&"),b=0;b<c.length;b++)if(c[b].indexOf("si")<0)a=a+c[b]+"&";a=a+"si="+f;return d[0]+"?"+a}var urlParams={};(function(){var a,c=/\+/g,e=/([^&=]+)=?([^&]*)/g,b=function(a){return decodeURIComponent(a.replace(c," "))},d=window.location.search.substring(1);while(a=e.exec(d))urlParams[b(a[1])]=b(a[2])})();var resultsListEngine={ajaxRequest:null,filterValue:"",maxResults:null,maxJsonResults:35,pagesPerPageSet:null,navigationValue:"",pageIndex:1,searchTerm:"",searchType:null,sortBy:0,prepTimeFilters:null,totalTimeFilters:null,formsubmit:false,clearSearchFilters:function(){jQuery(".listFilterContainer input:checkbox").attr("checked",false);jQuery("#prepSlider, #totalSlider").slider("option","value",7)},clearSearchResults:function(){jQuery("#srchRslts").html("");jQuery("#searchButtonOptions").hide();jQuery("#otherTypeCounts").hide();jQuery("#PrevPage").hide();jQuery("#PageNumbers").html("");jQuery("#NextPage").hide();jQuery("#NextPages").hide();jQuery("#PrevPages").hide();jQuery(".pagenation").hide()},getSearchResults:function(a){jQuery("#srchRslts").addClass("results_muted");var g=jQuery(window).height()/2,f=jQuery(window).width()/4;jQuery("#searchingMessage").show().css("top",g);jQuery("#searchingMessage").show().css("left",f);jQuery("#retResults").show();jQuery("#searchNoRslts").hide();jQuery("#errResults").hide();if(resultsListEngine.maxResults>resultsListEngine.maxJsonResults)resultsListEngine.maxResults=resultsListEngine.maxJsonResults;var b=false;if(typeof a!="undefined"&&a==true)var b=true;var d=function(j){try{jQuery("#srchRslts").removeClass("results_muted");resultsListEngine.clearSearchResults();jQuery.address.parameter("term",resultsListEngine.searchTerm).parameter("nav",resultsListEngine.navigationValue).parameter("fv",resultsListEngine.filterValue).parameter("pi",resultsListEngine.pageIndex).parameter("ps",resultsListEngine.maxResults).parameter("si",resultsListEngine.sortBy);var c=j.d;if(c.RecipesCount>0){jQuery.get("/shared/templates/SearchRecipeListViewTemplate.htm",function(a){jQuery("#srchRslts").html("");jQuery.tmpl(a,c.Results,{dataArrayIndex:function(a){return jQuery.inArray(a,c.Results)}}).appendTo("#srchRslts")});var f=c.ArticlesCount;if(f>0){jQuery("#videoArticleCount").html("("+f+") ");jQuery("#otherTypeCounts").show()}jQuery(".pagenation").show();jQuery("#retResults").fadeOut(700);jQuery("#searchingMessage").fadeOut(700);b&&resultsListEngine.ScrollTop();var e=Math.ceil(c.RecipesCount/resultsListEngine.maxResults);resultsListEngine.pageIndex>1&&jQuery("#PrevPage").show();resultsListEngine.pageIndex<e&&jQuery("#NextPage").show();var g=[],d=resultsListEngine.pagesPerPageSet-1,a=Math.floor(resultsListEngine.pageIndex/resultsListEngine.pagesPerPageSet)*resultsListEngine.pagesPerPageSet;if(resultsListEngine.pageIndex%resultsListEngine.pagesPerPageSet==0)a=a-d;else a=a+1;for(i=a;i<=e;i++){var h=i==resultsListEngine.pageIndex?true:false;g[i]={PageIndex:i,IsCurrentPage:h};if(i==d+a)break}if(e>d+resultsListEngine.pageIndex)jQuery("#NextPages").show();else jQuery("#NextPages").hide();if(resultsListEngine.pageIndex/resultsListEngine.pagesPerPageSet>1)jQuery("#PrevPages").show();else jQuery("#PrevPages").hide();jQuery.get("/shared/templates/SearchPageNumberTemplate.htm",function(a){jQuery("#PageNumbers").html("");jQuery.tmpl(a,g).appendTo("#PageNumbers")});jQuery(".pageIndex").live("click",function(){if(parseInt(jQuery(this).attr("pageindex"))!=resultsListEngine.pageIndex){resultsListEngine.pageIndex=parseInt(jQuery(this).attr("pageindex"));resultsListEngine.clearSearchResults();jQuery("#srchRslts").html()==""&&resultsListEngine.getSearchResults(true)}})}else{jQuery("#retResults").hide();jQuery("#searchingMessage").hide();b&&resultsListEngine.ScrollTop();if(resultsListEngine.pageIndex==1){jQuery("#noResultsTerm").text(decodeURIComponent(resultsListEngine.searchTerm));jQuery("#searchNoRslts").show()}}resultsListEngine.submitting=false}catch(k){resultsListEngine.submitting=false;ConsoleLog(k);jQuery("#retResults").hide();jQuery("#errResults").show()}};function e(a){resultsListEngine.submitting=false;ConsoleLog(a.status+" \n\r "+a.statusText+"\n\r"+a.responseText);jQuery("#retResults").hide();jQuery("#errResults").show()}var c={searchTerm:resultsListEngine.searchTerm,searchType:7,pageIndex:resultsListEngine.pageIndex,pageSize:resultsListEngine.maxResults,sortIndex:resultsListEngine.sortBy,sortingViewItemPath:jQuery(".SortingViewItemConfigKeyNameHiddenField").val(),filterValue:resultsListEngine.filterValue,navValues:jQuery.trim(resultsListEngine.navigationValue.replace(/\+/g," "))};resultsListEngine.ajaxRequest=jQuery.ajax({contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(c),error:e,async:false,success:d,type:"POST",url:"/Shared/Search/Services/SearchService.asmx/GetSearchResults"})},initializeResultsListEngine:function(){jQuery(".pagenation").hide();if(urlParams.term!=null&&urlParams.term.length>0){jQuery("#searchTermTb").val(urlParams.term);resultsListEngine.searchTerm=urlParams.term.replace(/\'/g,"")}if(a().ps!=null&&a().ps.length>0)resultsListEngine.maxResults=a().ps;if(a().pi!=null&&a().pi.length>0)resultsListEngine.pageIndex=a().pi;if(a().si!=null&&a().si.length>0)resultsListEngine.sortBy=a().si;if(a().st!=null&&a().st.length>0)resultsListEngine.searchResultType=a().st;if(a().fv!=null&&a().fv.length>0)resultsListEngine.filterValue=a().fv;resultsListEngine.formsubmit=true;resultsListEngine.maxResults=jQuery(".PageSizeHiddenField").val();resultsListEngine.pagesPerPageSet=jQuery(".PagesPerPageSetHiddenField").val();searchFactesFilter.initFacets(resultsListEngine);resultsListEngine.updateFilterUI();applySortingEvents(resultsListEngine,false);jQuery("#retrySearchLink").click(function(){if(!resultsListEngine.submitting){resultsListEngine.submitting=true;resultsListEngine.getSearchResults()}});jQuery("#cancelSearchLink").click(function(){if(resultsListEngine.ajaxRequest!=null){resultsListEngine.submitting=false;resultsListEngine.ajaxRequest.abort();jQuery("#srchRslts").removeClass("results_muted");jQuery("#retResults").hide();jQuery("#searchingMessage").hide()}});jQuery("#galleryLink a, #otherTypeCounts a").click(function(){if(!resultsListEngine.submitting){var b=jQuery.trim(jQuery("#searchTermTb").val()),a=jQuery(this).attr("href");a=a.replace("{0}",b);jQuery(this).attr("href",a);jQuery(this).parent().attr("id")=="galleryLink"&&setCookie("searchresulttype",3)}});jQuery(".recipeLink").live("click",function(){var c=decodeURI(window.location.search.substring(1)),b=jQuery(this).attr("href");b+="#?";if(c==false|c==""){jQuery(this).attr("href",b);return}var d=a().fv;if(d!=null)c+="&fv="+d;b+=c;jQuery(this).attr("href",b)});function a(){var a={},b=window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(d,c,b){a[c]=b});return a}jQuery("#PrevPage").click(function(){if(!resultsListEngine.submitting){resultsListEngine.submitting=true;resultsListEngine.pageIndex=resultsListEngine.pageIndex-1;resultsListEngine.getSearchResults(true)}});jQuery("#NextPage").click(function(){if(!resultsListEngine.submitting){resultsListEngine.submitting=true;resultsListEngine.pageIndex=resultsListEngine.pageIndex+1;resultsListEngine.getSearchResults(true)}});jQuery("#NextPages").click(function(){resultsListEngine.pageIndex=Math.ceil(resultsListEngine.pageIndex/resultsListEngine.pagesPerPageSet)*resultsListEngine.pagesPerPageSet+1;resultsListEngine.getSearchResults(true)});jQuery("#PrevPages").click(function(){if(resultsListEngine.pageIndex%resultsListEngine.pagesPerPageSet==0)resultsListEngine.pageIndex=resultsListEngine.pageIndex-resultsListEngine.pagesPerPageSet;else resultsListEngine.pageIndex=Math.floor(resultsListEngine.pageIndex/resultsListEngine.pagesPerPageSet)*resultsListEngine.pagesPerPageSet;ConsoleLog(resultsListEngine.pageIndex);resultsListEngine.getSearchResults(true)});jQuery("#ResultsPerPage").change(function(){resultsListEngine.maxResults=jQuery(this).val();resultsListEngine.pageIndex=1;resultsListEngine.getSearchResults(true)})},updateFilterUI:function(){resultsListEngine.filterValue=decodeURIComponent(resultsListEngine.filterValue);searchFactesFilter.updateFacetFilterUI(resultsListEngine.filterValue);resultsListEngine.getSearchResults(false)},updateFilterValue:function(){resultsListEngine.filterValue=searchFactesFilter.getFacetFilterValues();resultsListEngine.filterValue=decodeURIComponent(resultsListEngine.filterValue);resultsListEngine.pageIndex=1;resultsListEngine.getSearchResults(false)},updateSortUI:function(){updateSortingUI(resultsListEngine)},ScrollTop:function(){window.scrollTo(0,0)}},resultsGridEngine={submitting:false,ajaxRequest:null,filterValue:"AND(HasGridViewImage:True)",maxJsonResults:35,maxResults:null,pagesPerPageSet:null,navigationValue:"",pageIndex:1,searchTerm:"",searchType:null,sortBy:0,prepTimeFilters:null,totalTimeFilters:null,clearSearchFilters:function(){jQuery(".narrowSrchRslt input:checkbox").attr("checked",false);jQuery("#prepSlider, #totalSlider").slider("option","value",7)},clearSearchResults:function(a){jQuery("#searchButtonOptions").hide();jQuery("#srchRslts").html("");if(a==null)resultsGridEngine.pageIndex=1;else resultsGridEngine.pageIndex=a},getSearchResults:function(){var b=resultsGridEngine.pageIndex,a=resultsGridEngine.maxResults;if(jQuery(".serchRsltBox").length<1){a=b*a;if(a>resultsGridEngine.maxJsonResults)if(resultsGridEngine.maxResults>resultsGridEngine.maxJsonResults){resultsGridEngine.maxResults=resultsGridEngine.maxJsonResults;a=resultsGridEngine.maxResults}else{resultsGridEngine.pageIndex=Math.floor(resultsGridEngine.maxJsonResults/resultsGridEngine.maxResults);a=resultsGridEngine.pageIndex*resultsGridEngine.maxResults}b=1;jQuery("#retResultsMessage").show()}else jQuery("#retResultsMessage").show();jQuery("#searchingMessage").show();jQuery("#retResults").show();jQuery("#searchNoRslts").hide();jQuery("#errResults").hide();var d=function(b){try{jQuery.address.parameter("term",resultsGridEngine.searchTerm).parameter("nav",resultsGridEngine.navigationValue).parameter("fv",resultsGridEngine.filterValue).parameter("pi",resultsGridEngine.pageIndex).parameter("ps",resultsGridEngine.maxResults).parameter("si",resultsGridEngine.sortBy);var a=b.d;if(a.RecipesCount>0){jQuery.get("/shared/templates/SearchRecipeGalleryViewTemplate.htm",function(b){jQuery.tmpl(b,a.Results,{dataArrayIndex:function(b){return jQuery.inArray(b,a.Results)}}).appendTo("#srchRslts")});jQuery('<div class="CL"></div>').appendTo("#srchRslts");jQuery("#retResults").hide();jQuery("#searchingMessage").hide();if(a.RecipesCount<resultsGridEngine.maxResults)jQuery(".srchMore").hide();else{resultsGridEngine.pageIndex++;jQuery(".srchMore").show()}}else{jQuery(".srchMore").hide();jQuery("#retResults").hide();jQuery("#searchingMessage").hide();if(resultsGridEngine.pageIndex==1){jQuery("#noResultsTerm").text(decodeURIComponent(resultsGridEngine.searchTerm));jQuery("#searchNoRslts").show()}}resultsGridEngine.submitting=false}catch(c){resultsGridEngine.submitting=false;ConsoleLog(c);jQuery("#retResults").hide();jQuery("#errResults").show()}};function e(a){resultsGridEngine.submitting=false;ConsoleLog(a.status+" \n\r "+a.statusText+"\n\r"+a.responseText);jQuery("#retResults").hide();jQuery("#errResults").show()}var c={searchTerm:resultsGridEngine.searchTerm,searchType:6,pageIndex:resultsGridEngine.pageIndex,pageSize:resultsGridEngine.maxResults,sortIndex:resultsGridEngine.sortBy,sortingViewItemPath:jQuery(".SortingViewItemConfigKeyNameHiddenField").val(),filterValue:resultsGridEngine.filterValue,navValues:resultsGridEngine.navigationValue};resultsGridEngine.ajaxRequest=jQuery.ajax({contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(c),error:e,success:d,type:"POST",url:"/Shared/Search/Services/SearchService.asmx/GetSearchResults"})},initializeResultsGridEngine:function(){if(urlParams.term!=null&&urlParams.term.length>0){jQuery("#searchTermTb").val(urlParams.term);resultsGridEngine.searchTerm=urlParams.term.replace(/\'/g,"")}if(urlParams.ps!=null&&urlParams.ps.length>0)resultsGridEngine.maxResults=urlParams.ps;if(urlParams.pi!=null&&urlParams.pi.length>0)resultsGridEngine.pageIndex=urlParams.pi;if(urlParams.si!=null&&urlParams.si.length>0)resultsGridEngine.sortBy=urlParams.si;if(urlParams.st!=null&&urlParams.st.length>0)resultsGridEngine.searchType=urlParams.st;resultsGridEngine.maxResults=jQuery(".PageSizeHiddenField").val();resultsGridEngine.pagesPerPageSet=jQuery(".PagesPerPageSetHiddenField").val();searchFactesFilter.initFacets(resultsGridEngine);applySortingEvents(resultsGridEngine,true);jQuery(".viewaslist a").click(function(){if(!resultsGridEngine.submitting){var b=jQuery.trim(jQuery("#searchTermTb").val()),a=jQuery(this).attr("href");a=a.replace("{0}",b);jQuery(this).attr("href",a);setCookie("searchresulttype",3)}});jQuery(".resetFacetFilters").click(function(){resultsGridEngine.clearSearchFilters();resultsGridEngine.updateFilterValue()});jQuery(".recpImg").live("mouseenter",function(){jQuery(this).nextAll(".rcpiDetails").show()});jQuery(".recpImg").live("mouseleave",function(){jQuery(this).nextAll(".rcpiDetails").hide()});jQuery(".rcpiDetails").live("mouseenter",function(){jQuery(this).show()});jQuery(".rcpiDetails").live("mouseleave",function(){jQuery(this).hide()});jQuery(".recipeLink").live("click",function(){var b=decodeURI(window.location.search.substring(1)),c=jQuery(this).attr("href");c+="#?";if(b==false|b==""){jQuery(this).attr("href",c);return}var d=a().ps;if(d!=null)b+="&ps="+d;var f=a().pi;if(f!=null)b+="&pi="+d;var e=a().fv;if(e!=null)b+="&fv="+e;c+=b;jQuery(this).attr("href",c)});function a(){var a={},b=window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(d,c,b){a[c]=b});return a}jQuery(".moreResultsButton").click(function(){if(!resultsGridEngine.submitting){resultsGridEngine.submitting=true;resultsGridEngine.getSearchResults()}});jQuery("#retrySearchLink").click(function(){if(!resultsGridEngine.submitting){resultsGridEngine.submitting=true;resultsGridEngine.clearSearchResults(resultsGridEngine.pageIndex);resultsGridEngine.getSearchResults()}});jQuery("#cancelSearchLink").click(function(){if(resultsGridEngine.ajaxRequest!=null){resultsGridEngine.submitting=false;resultsGridEngine.ajaxRequest.abort();jQuery("#retResults").hide();jQuery("#searchingMessage").hide()}});jQuery("#filterRecipesOn").click(function(){jQuery(".narrowSrchRslt").show();jQuery("#filterRecipesOff").show();jQuery("#filterRecipesOn").hide()});jQuery("#filterRecipesOff").click(function(){jQuery(".narrowSrchRslt").hide();jQuery("#filterRecipesOff").hide();jQuery("#filterRecipesOn").show()});if(!resultsGridEngine.submitting){resultsGridEngine.submitting=true;resultsGridEngine.clearSearchResults();resultsGridEngine.getSearchResults()}},updateFilterUI:function(){var a=resultsGridEngine.filterValue;if(a.length>0){a=a.replace("AND(HasGridViewImage:True)","");if(a.length>0){searchFactesFilter.updateFacetFilterUI(a);jQuery(".moreResultsButton").trigger("click")}}},updateFilterValue:function(){resultsGridEngine.filterValue=searchFactesFilter.getFacetFilterValues();if(resultsGridEngine.filterValue.length==0)resultsGridEngine.filterValue+="AND(AND(HasGridViewImage:True))";else resultsGridEngine.filterValue="AND(AND(HasGridViewImage:True) "+resultsGridEngine.filterValue+")";resultsGridEngine.submitting=true;resultsGridEngine.clearSearchResults();resultsGridEngine.getSearchResults()},openSaveRecipeToRecipeBoxLink:function(a){if(jQuery(".SaveRecipeBoxHiddenField").val()=="1"){jQuery("[id$=RecipeIdHiddenField]").val(a);var b=jQuery("a[href$="+a+"]").eq(0).text();jQuery("[id$=RecipeTitleHiddenField]").val(b);jQuery(".recipebox").trigger("click")}else alert("Save recipe is not available.")},updateSortUI:function(){updateSortingUI(resultsGridEngine)}};function applySortingEvents(a,b){jQuery(".menuSrchMenu ul li").each(function(a){if(jQuery("#MORESort").parent().index()<a){jQuery("#menuSrchMenuId u").remove(jQuery(this));jQuery(".menuMore ul").append(jQuery(this))}});jQuery(".menuSrchMenu ul li a").click(function(){if(jQuery(this).attr("id")!="MORESort"){if(!a.submitting){a.submitting=true;if(jQuery(".midCont").size())jQuery(".midCont .menuSrchMenu li a, .menuMore li a").removeClass("on");else jQuery(".menuSrchMenu li a").removeClass("current");if(!jQuery(".viewaslist").size()){jQuery(this).addClass("on");a.sortBy=jQuery(this).parent().index()+1}else{jQuery(this).addClass("current");a.sortBy=jQuery(this).parent().index()}a.pageIndex=1;b==true&&a.clearSearchResults();a.getSearchResults()}}else if(jQuery("#moreSortMenu").is(":visible"))jQuery("#moreSortMenu").hide();else{jQuery("#moreSortMenu").css("top",jQuery(this).position().top+22).css("left",jQuery(this).position().left);jQuery("#moreSortMenu").show()}});jQuery("#moreSortMenu ul li a").live("click",function(){if(!a.submitting){a.submitting=true;jQuery(".menuSrchMenu li a, .menuMore li a").removeClass("on");jQuery("#MORESort").addClass("on");a.sortBy=parseInt(jQuery(this).attr("class").replace("INDEX_",""))+1;jQuery(this).addClass("on");jQuery(this).parent().remove().insertBefore("#moreSortMenu ul li:first");jQuery("#moreSortMenu").hide();a.pageIndex=1;b==true&&a.clearSearchResults();a.getSearchResults()}})}function updateSortingUI(a){jQuery(".menuSrchMenu li a, .menuMore li a").removeClass("on");if(a.sortBy>0){var b=a.sortBy-1;jQuery(".INDEX_"+b).addClass("on");if(jQuery("#MORESort").parent().index()<a.sortBy){jQuery("#MORESort").addClass("on");jQuery(".INDEX_"+b).parent().remove().insertBefore("#moreSortMenu ul li:first")}}}function onClearAdvSearchCriteriaClick(a){jQuery("[id$=KeywordsTextBox]").val(a);jQuery(".advSearchFacetsDiv input:checkbox").attr("checked",false);jQuery(".advSearchFacetsDiv select").each(function(){jQuery(this).find("option:first").attr("selected","selected")});return false}function onAdvSearchClick(d,e,c){if(d==jQuery("[id$=KeywordsTextBox]").val()||jQuery("[id$=KeywordsTextBox]").val().trim()=="")alert(c);else{ApplyUnicaEventTag("ev=search_BT&sitekeyword="+jQuery("[id$=KeywordsTextBox]").val().toLowerCase());var a=searchFactesFilter.getFacetFilterValues(),b=jQuery("[id$=AdvSearchRsltPageHiddenField]").val()+"?term="+jQuery("[id$=KeywordsTextBox]").val();b+="&st=6&ads=1";if(a!=null&&a!="")b+="&fv="+a;a=a.replace(/AND\(/g,"");a=a.replace(/OR\(/g,"");a=a.replace(/NOT\(/g,"");a=a.replace(/\)/g,"");a=a.replace(/,/g," ");LogSearch(jQuery("[id$=KeywordsTextBox]").val(),a,true,false);window.location.href=b}return false}var fullResultsEngine={searchTerm:null,maxResults:null,pageIndex:1,sortBy:0,searchResultType:null,filterValue:null,navValues:null,submitting:null,initializeEngine:function(){if(urlParams.term!=null&&urlParams.term.length>0)fullResultsEngine.searchTerm=urlParams.term.replace(/\'/g,"");if(urlParams.ps!=null&&urlParams.ps.length>0)fullResultsEngine.maxResults=urlParams.ps;if(urlParams.pi!=null&&urlParams.pi.length>0)fullResultsEngine.pageIndex=urlParams.pi;if(urlParams.si!=null&&urlParams.si.length>0)fullResultsEngine.sortBy=urlParams.si;if(urlParams.st!=null&&urlParams.st.length>0)fullResultsEngine.searchResultType=urlParams.st;if(urlParams.fv!=null&&urlParams.fv.length>0)fullResultsEngine.filterValue=urlParams.fv;searchFactesFilter.initFacets(fullResultsEngine);searchFactesFilter.updateFacetFilterUI(fullResultsEngine.filterValue);jQuery(".recipeLink").live("click",function(){var b=decodeURI(window.location.search.substring(1)),a=jQuery(this).attr("href");a+="#?";if(b==false|b==""){jQuery(this).attr("href",a);return}a+=b;jQuery(this).attr("href",a)});},updateFilterValue:function(){fullResultsEngine.filterValue=searchFactesFilter.getFacetFilterValues();var a=window.location.toString().split("?")[0]+"?";a+="st="+fullResultsEngine.searchResultType;a+="&term="+fullResultsEngine.searchTerm;if(fullResultsEngine.pageIndex>0)a+="&pi="+fullResultsEngine.pageIndex;if(fullResultsEngine.maxResults>0)a+="&ps="+fullResultsEngine.maxResults;if(fullResultsEngine.sortBy>0)a+="&si="+fullResultsEngine.sortBy;if(fullResultsEngine.filterValue.length>0)a+="&fv="+jQuery.trim(fullResultsEngine.filterValue);window.location.href=a}},searchFactesFilter={prepTimeFilters:"",totalTimeFilters:"",prepTimeFilterOperter:"",totalTimeFilterOperter:"",updateFacetFilterUI:function(a){if(a!=null&&a.length>0){a=a.replace(/AND\(/g,"");a=a.replace(/OR\(/g,"");a=a.replace(/NOT\(/g,"");a=a.replace(/\)/g,"");if(a.length>0){a=","+a+",";var d=jQuery(".listFilterContainer input:checkbox"),b;jQuery.each(d,function(){b=jQuery(this).parent().attr("alt");if(b!=null&&b.length>0){b=","+b+",";a.indexOf(b)>=0&&jQuery(this).attr("checked",true)}});d=jQuery(".listFilterContainer select");var c="";jQuery.each(d,function(){jQuery.each(jQuery(this).children(),function(){c=jQuery(this).val();if(c!=null&&c.length>0){b=","+c+",";a.indexOf(b)>=0&&jQuery(this).parent().val(c)}})});jQuery.each(searchFactesFilter.prepTimeFilters,function(c,b){b=","+b+",";if(a.indexOf(b)>=0){jQuery("#prepSlider").slider("option","value",c);return}});jQuery.each(searchFactesFilter.totalTimeFilters,function(c,b){b=","+b+",";if(a.indexOf(b)>=0){jQuery("#totalSlider").slider("option","value",c);return}})}}},getFacetFilterValues:function(){var b="",c="",e="",d="",i=jQuery(".listFilterContainer input:checked"),a,h;jQuery.each(i,function(){a=jQuery(this).parent().attr("alt");h=jQuery(this).parent().attr("opter");if(a!=null&&a.length>0)if(a!=null&&a.length>0)if(h=="NOT")d+=a+",";else if(h=="OR")e+=a+",";else c+=a+","});var j=jQuery(".listFilterContainer select");jQuery.each(j,function(){a=jQuery(this).val();h=jQuery(this).attr("opter");if(a!=null&&a.length>0)if(h=="NOT")d+=a+",";else if(h=="OR")e+=a+",";else c+=a+","});var g=jQuery("#prepSlider").slider("option","value");if(g<6&&searchFactesFilter.prepTimeFilters[g]!=null&&searchFactesFilter.prepTimeFilters[g].length>0)if(searchFactesFilter.prepTimeFilterOperter=="NOT")d+=searchFactesFilter.prepTimeFilters[g]+",";else if(searchFactesFilter.prepTimeFilterOperter=="OR")e+=searchFactesFilter.prepTimeFilters[g]+",";else c+=searchFactesFilter.prepTimeFilters[g]+",";var f=jQuery("#totalSlider").slider("option","value");if(f<6&&searchFactesFilter.totalTimeFilters[f]!=null&&searchFactesFilter.totalTimeFilters[f].length>0)if(searchFactesFilter.totalTimeFilterOperter=="NOT")d+=searchFactesFilter.totalTimeFilters[f]+",";else if(searchFactesFilter.totalTimeFilterOperter=="OR")e+=searchFactesFilter.totalTimeFilters[f]+",";else c+=searchFactesFilter.totalTimeFilters[f]+",";if(c.length>0)b="AND("+c.substring(0,c.length-1)+"),";if(e.length>0)b+="OR("+e.substring(0,e.length-1)+"),";if(d.length>0)b+="NOT("+d.substring(0,d.length-1)+"),";if(b.length>0)b="AND("+b.substring(0,b.length-1)+")";return b},initFacets:function(a){if(jQuery(".PrepTimeFiltersHiddenField")!=null&&jQuery(".PrepTimeFiltersHiddenField").val()!=null)searchFactesFilter.prepTimeFilters=jQuery(".PrepTimeFiltersHiddenField").val().split(",");if(jQuery(".TotalTimeFiltersHiddenField")!=null&&jQuery(".TotalTimeFiltersHiddenField").val()!=null)searchFactesFilter.totalTimeFilters=jQuery(".TotalTimeFiltersHiddenField").val().split(",");if(jQuery(".PrepTimeFilterOperatorHiddenField")!=null&&jQuery(".PrepTimeFilterOperatorHiddenField").val()!=null)searchFactesFilter.prepTimeFilterOperter=jQuery(".PrepTimeFilterOperatorHiddenField").val();if(jQuery(".TotalTimeFilterOperatorHiddenField")!=null&&jQuery(".TotalTimeFilterOperatorHiddenField").val()!=null)searchFactesFilter.totalTimeFilterOperter=jQuery(".TotalTimeFilterOperatorHiddenField").val();jQuery(".listFilterContainer h3").click(function(){if(!jQuery(this).hasClass("noExpandCollapse"))if(jQuery(this).hasClass("down")){jQuery(this).removeClass("down");jQuery(this).next(".filterWindow").hide()}else{jQuery(this).addClass("down");jQuery(this).next(".filterWindow").show()}});jQuery(".filterListToggle").click(function(d){d.stopPropagation();a.submitting=true;var b=jQuery(this).parent(),c=jQuery(b).next(".filterWindow");if(this.checked&&b.hasClass("down")==false){b.addClass("down");c.show()}c.find(":checkbox").attr("checked",this.checked);a.updateFilterValue()});jQuery(".listFilterContainer input:checkbox").click(function(){a.updateFilterValue()});jQuery("#prepSlider, #totalSlider").slider({value:6,min:0,max:6,step:1,slide:function(){if(a.submitting)return false},stop:function(){if(!a.submitting){a.submitting=true;a.updateFilterValue()}}});jQuery(".listFilterContainer select").change(function(){a.updateFilterValue()});jQuery.address.externalChange(function(b){if(!a.formsubmit)if(b.parameterNames.length>0){if(b.parameters.term!=undefined){var c=decodeURIComponent(b.parameters.term);c=c.replace(/\+/g," ");jQuery("#searchTermTb").val(c);a.searchTerm=c.replace(/\'/g,"")}if(b.parameters.nav!=undefined)a.navigationValue=b.parameters.nav;if(b.parameters.fv!=undefined){a.filterValue=b.parameters.fv;a.updateFilterUI()}if(b.parameters.pi!=undefined)a.pageIndex=b.parameters.pi;if(b.parameters.mr!=undefined)a.maxResults=b.parameters.mr;if(b.parameters.sb!=undefined){a.sortBy=b.parameters.sb;a.updateSortUI()}}a.formsubmit=false})}};function isEnterKeyPressed(f,a,c,d,b){var e=a.keyCode?a.keyCode:a.which?a.which:a.charCode;if(e==13){onAdvSearchClick(c,d,b);return false}else return true}function removeMessage(c,d,a,b){if(document.getElementById(c).value==d)document.getElementById(c).value="";if(document.getElementById(a).innerText==b|document.getElementById(a).innerHTML==b){document.getElementById(a).innerText="";document.getElementById(a).innerHTML=""}}function removeErrorMessage(c,d,a,b){var e=document.getElementById(c).value;if(e==d||e.length==0)document.getElementById(c).value=d;if(document.getElementById(a).innerText==b|document.getElementById(a).innerHTML==b){document.getElementById(a).innerText="";document.getElementById(a).innerHTML=""}}function FireOnSearchSpotLightTag(){var a=Math.random()+"",b=a*1e13;document.getElementById("SearchSpotLightTagContainer").innerHTML='<IFRAME SRC="http://fls.doubleclick.net/activityi;src=1869704;type=betty077;cat=searc844;ord=1;num='+b+'?" WIDTH=1 HEIGHT=1 FRAMEBORDER=0></IFRAME>'};