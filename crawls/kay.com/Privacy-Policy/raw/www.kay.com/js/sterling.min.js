compareProductJS={compareCounter:0,compareRowCounter:0,compareItemCatEntry:new Object(),langId:"-1",storeId:"",storeId2:"",catalogId:"",properties:new Object(),errorMessages:new Object(),setCommonParameters:function(langId,storeId,catalogId){this.langId=langId;this.storeId=storeId;this.catalogId=catalogId},setErrorMessage:function(key,value){this.errorMessages[key]=value},getErrorMessage:function(key){var value=this.errorMessages[key];if(value==null){value="Could not get the message value for specified key "+key}return value},setProperty:function(name,value){this.properties[name]=value},getProperty:function(name){return this.properties[name]},getStorageKey:function(){if(this.storeId!=0){var storageKey="CompareItems"+this.storeId}else{var storageKey="CompareItems10451"}var sessionId=this.getProperty("sessionId");var sessionCode=0;storageKey=storageKey+sessionCode;return storageKey},getCatKey:function(){if(this.storeId!=0){var CatKey=this.catalogId}var sessionId=this.getProperty("sessionId");var sessionCode=0;catKey=catKey+sessionCode;return catKey},load:function(key){if(key==null||typeof key=="undefined"||key==""){alert("Please provide a key");return}return this._load(key)},save:function(key,value){if(key==null||typeof key=="undefined"||key==""){alert("Please provide a key");return}if(value==null||typeof value=="undefined"||value==""){alert("Please provide a key value");return}this._save(key,value)},uncheckAll:function(field){for(i=0;i<field.length;i++){field[i].checked=false}},clearAll:function(){var answer=confirm("Are you sure you want to clear all the items in the Compare Zone?");if(answer){this.clear()}else{window.location="#"}},clear:function(){var result=this.load(this.getStorageKey());if(result!=null){this.compareItemCatEntry=result}if(document.getElementsByName("checkboxid")[0]!=undefined){for(catEntryIdentifier in this.compareItemCatEntry){if(document.getElementById("check_"+catEntryIdentifier)!=null){document.getElementById("check_"+catEntryIdentifier).checked=false;document.getElementsByName("checkboxid").checked=false}if(this.compareCounter!=0){}if(this.currentProvider=="flash"){dojo.storage.clear()}else{if(this.compareCounter>0){var storageKey=this.getStorageKey();dojo.cookie(storageKey,null,{path:"/"});this.initializeCompare()}}}}else{var storageKey=this.getStorageKey();dojo.cookie(storageKey,null,{path:"/"});for(catEntryIdentifier in this.compareItemCatEntry){if(document.getElementById("check_"+catEntryIdentifier)!=null){document.getElementById("check_"+catEntryIdentifier).checked=false}}}var message=[];message.actionId="AjaxCompareCollectorRemove";dojo.publish("modelChanged",[message])},removecompare:function(key,isCompare,ispath){if(this.currentProvider=="flash"){dojo.storage.remove(key)}else{var storageKey=this.getStorageKey();var result=this.load(storageKey);if(result!=null){this.compareItemCatEntry=result}delete this.compareItemCatEntry[key];this.save(storageKey,this.compareItemCatEntry);this.compareProducts()}},remove:function(key){if(this.currentProvider=="flash"){dojo.storage.remove(key)}else{var storageKey=this.getStorageKey();var result=this.load(storageKey);if(result!=null){this.compareItemCatEntry=result}delete this.compareItemCatEntry[key];this.save(storageKey,this.compareItemCatEntry);if(document.getElementById("check_"+key)!=undefined){this.initializeCompare();if(document.getElementById("check_"+key)!=null){document.getElementById("check_"+key).checked=false}}else{this.compareCounter=0;for(catEntryIdentifier in this.compareItemCatEntry){this.compareCounter++}}var message=[];message.actionId="AjaxCompareCollectorRemove";dojo.publish("modelChanged",[message])}},_save:function(key,value,days,path,domain,secure,clearCurrent){if(this.currentProvider=="flash"){var self=this;var saveHandler=function(status,keyName){if(status==dojo.storage.FAILED){alert("You do not have permission to store data for this web site. Press the Configure button to grant permission.")}else{if(status==dojo.storage.SUCCESS){}}};try{dojo.storage.put(key,value,saveHandler)}catch(exp){alert(exp)}}else{value=dojo.toJson(value);dojo.cookie(key,value,{path:"/"})}},_load:function(key){if(this.currentProvider=="flash"){var results=dojo.storage.get(key);return results}else{var value=dojo.cookie(key);value=dojo.fromJson(value);return value}},initializeCompare:function(){var storageKey=this.getStorageKey();this.compareCounter=0;this.compareItemCatEntry=new Object();var result=this.load(storageKey);if(result!=null){this.compareItemCatEntry=result}for(catEntryIdentifier in this.compareItemCatEntry){this.compareCounter++;if(document.getElementById("check_"+catEntryIdentifier)!=undefined){document.getElementById("check_"+catEntryIdentifier).checked=true}}},Add2CompareAjax:function(catEntryIdentifier,dragImagePath,url,dragImageDescription,continueurl){var storageKey=this.getStorageKey();var ItemCount=null;if(this.checked){this.checked=false;alert("You haven't finished something yet")}if(catEntryIdentifier in this.compareItemCatEntry||catEntryIdentifier==null){}else{this.compareCounter++;if(this.compareCounter<=4){if(this.compareCounter==1){ItemCount=this.compareCounter}if(document.getElementById("check_"+catEntryIdentifier)!=null){document.getElementById("check_"+catEntryIdentifier).checked=true}this.compareItemCatEntry[catEntryIdentifier]=catEntryIdentifier;this.save(storageKey,this.compareItemCatEntry,-1);var message=[];message.actionId="AjaxCompareCollector";message.catentryId=catEntryIdentifier;dojo.publish("modelChanged",[message])}else{if(document.getElementById("check_"+catEntryIdentifier)!=undefined){document.getElementById("check_"+catEntryIdentifier).checked=false}alert("You already have 4 items waiting to be compared. To add another item, you must first remove an item from your selection above.")}}},RemoveFromCompareAjax:function(catEntryIdentifier){var storageKey=this.getStorageKey();alert("Remove from compare"+catEntryIdentifier);if(this.checked){this.checked=false;alert("You haven't finished something yet")}if(catEntryIdentifier in this.compareItemCatEntry||catEntryIdentifier==null){this.initializeCompare()}},compareProducts:function(){var url="CompareProductsDisplay?storeId="+this.storeId+"&catalogId="+this.catalogId+"&langId="+this.langId;document.location.href=getAbsoluteURL()+url},init:function(){dojo.subscribe("/dnd/drop",function(source,nodes,copy,target){target.deleteSelectedNodes();var productDisplayPath="";var imgPath="";var imgDescription="";if(target.parent.id=="compareZone"){var indexOfIdentifier=source.parent.id.indexOf("_",0);if(indexOfIdentifier>=0){source.parent.id=source.parent.id.substring(indexOfIdentifier+1)}if(document.getElementById("compareImgPath_"+source.parent.id)!=null&&document.getElementById("compareImgPath_"+source.parent.id)!=undefined){imgPath=document.getElementById("compareImgPath_"+source.parent.id).value}if(document.getElementById("compareProductDetailsPath_"+source.parent.id)!=null&&document.getElementById("compareProductDetailsPath_"+source.parent.id)!=undefined){productDisplayPath=document.getElementById("compareProductDetailsPath_"+source.parent.id).value}if(document.getElementById("compareImgDescription_"+source.parent.id)!=null&&document.getElementById("compareImgDescription_"+source.parent.id)!=undefined){imgDescription=document.getElementById("compareImgDescription_"+source.parent.id).value}compareProductJS.Add2CompareAjax(source.parent.id,imgPath,productDisplayPath,imgDescription)}})}};dojo.require("dojox.collections.ArrayList");dojo.require("wc.widget.Tooltip");CheckoutHelperJS={langId:"-1",storeId:"",catalogId:"",orderId:"",shipmentTypeId:"",orderItemIds:[],updateWaitTimeOut:1500,keyPressCount:{},ajaxCheckOut:true,singlePageCheckout:true,selectedAddressesArray:{},dataDirty:{},fieldDirtyFlag:false,resetRequestedShipDateValue:"1970-01-01T00:00:00.000Z",shoppingCartPage:false,pendingOrderDetailsPage:false,RequestShippingDateAction:false,shipChargeEnabled:false,setShipChargeEnabled:function(enabled){this.shipChargeEnabled=enabled},updateParamObject:function(params,key,value,toArray,index){if(params==null){params=[]}if(params[key]!=null&&toArray){if(dojo.lang.isArrayLike(params[key])){if(index!=null&&index!=""){params[key][index]=value}else{params[key].push(value)}}else{var tmpValue=params[key];params[key]=[];params[key].push(tmpValue);params[key].push(value)}}else{if(index!=null&&index!=""&&index!=-1){params[key+"_"+index]=value}else{if(index==-1){var i=1;while(params[key+"_"+i]!=null){i++}params[key+"_"+i]=value}else{params[key]=value}}}return params},checkRequestShippingDateBox:function(checkBoxName,divName,suffix){var thisCheckBoxName;var thisDivName;if(suffix!=null&&suffix!=""){checkBoxName=checkBoxName+"_"+suffix;divName=divName+"_"+suffix}var checkBox=dojo.byId(checkBoxName);if(checkBox.checked){dojo.byId(divName).style.visibility="visible";dojo.byId(divName).style.display="block"}else{dojo.byId(divName).style.visibility="hidden";dojo.byId(divName).style.display="none"}var addressId,shipModeId="";if(this.shipmentTypeId=="1"){addressId=document.getElementById("singleShipmentAddress").value;shipModeId=document.getElementById("singleShipmentShippingMode").value}else{if(this.shipmentTypeId=="2"){addressId=document.getElementById("MS_ShipmentAddress_"+suffix).value;shipModeId=document.getElementById("MS_ShippingMode_"+suffix).value}else{console.debug("shipmentTypeId is undefined. Single shipment has Id 1; multiple shipment has Id 2.")}}if(!checkBox.checked&&this.isAjaxCheckOut()){var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";this.updateParamObject(params,"addressId",addressId,false,-1);this.updateParamObject(params,"shipModeId",shipModeId,false,-1);if(dijit.byId("requestedShippingDate")!=null||dijit.byId("MS_requestedShippingDate_"+suffix)!=null){this.updateParamObject(params,"requestedShipDate",this.resetRequestedShipDateValue,false,-1)}var orderItemId=null;var qty=null;var totalItems=document.getElementById("totalNumberOfItems").value;for(var i=0;i<totalItems;i++){qty=document.getElementById("qty_"+(i+1)).value;orderItemId=document.getElementById("orderItem_"+(i+1)).value;if(qty!=-1){if(this.shipmentTypeId=="1"){this.updateParamObject(params,"orderItemId",orderItemId,false,-1);break}else{if(this.shipmentTypeId=="2"){if(suffix!=null&&suffix!=""&&orderItemId==suffix){this.updateParamObject(params,"orderItemId",orderItemId,false,-1);break}}else{console.debug("shipmentTypeId is undefined. Single shipment has Id 1; multiple shipment has Id 2.")}}}}if(!submitRequest()){return}cursor_wait();CheckoutHelperJS.RequestShippingDateAction=true;wc.service.invoke("OrderItemAddressShipMethodUpdate",params)}},checkShippingInstructionsBox:function(checkBoxName,divName,suffix){var thisCheckBoxName;var thisDivName;if(suffix!=null&&suffix!=""){thisCheckBoxName=checkBoxName+"_"+suffix;thisDivName=divName+"_"+suffix}else{thisCheckBoxName=checkBoxName;thisDivName=divName}var thisCheckBox=dojo.byId(thisCheckBoxName);if(thisCheckBox.checked){dojo.byId(thisDivName).style.visibility="visible";dojo.byId(thisDivName).style.display="block"}else{dojo.byId(thisDivName).style.visibility="hidden";dojo.byId(thisDivName).style.display="none"}var addressId,shipModeId="";if(this.shipmentTypeId=="1"){addressId=document.getElementById("singleShipmentAddress").value;shipModeId=document.getElementById("singleShipmentShippingMode").value}else{if(this.shipmentTypeId=="2"){var orderItemId,tempAddressId,tempShipModeId="";addressId=document.getElementById("MS_ShipmentAddress_"+suffix).value;shipModeId=document.getElementById("MS_ShippingMode_"+suffix).value;var totalItems=document.getElementById("totalNumberOfItems").value;for(var i=0;i<totalItems;i++){if(document.getElementById("qty_"+(i+1))!=null&&document.getElementById("qty_"+(i+1)).value!=-1){orderItemId=document.getElementById("orderItem_"+(i+1)).value;tempAddressId=document.getElementById("MS_ShipmentAddress_"+orderItemId).value;tempShipModeId=document.getElementById("MS_ShippingMode_"+orderItemId).value;if(tempShipModeId==shipModeId&&tempAddressId==addressId){var tempDivName=divName+"_"+orderItemId;var tempCheckBoxName=checkBoxName+"_"+orderItemId;if(thisCheckBox.checked){dojo.byId(tempDivName).style.visibility="visible";dojo.byId(tempDivName).style.display="block";dojo.byId(tempCheckBoxName).checked="checked"}else{dojo.byId(tempDivName).style.visibility="hidden";dojo.byId(tempDivName).style.display="none";dojo.byId(tempCheckBoxName).checked=""}}}}}else{console.debug("shipmentTypeId is undefined. Single shipment has Id 1; multiple shipment has Id 2.")}}if(!thisCheckBox.checked&&this.isAjaxCheckOut()){var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";var orderItemId=null;if(this.shipmentTypeId=="1"){if(document.getElementById("shipInstructions")!=null){this.updateParamObject(params,"shipInstructions","",false);document.getElementById("shipInstructions").value=""}orderItemId=document.getElementById("orderItem_1").value;this.updateParamObject(params,"addressId",addressId,false);this.updateParamObject(params,"orderItemId",orderItemId,false)}else{if(this.shipmentTypeId=="2"){if(suffix!=null&&suffix!=""){if(document.getElementById("MS_shipInstructions_"+suffix)!=null){this.updateParamObject(params,"shipInstructions","",false);document.getElementById("MS_shipInstructions_"+suffix).value=""}this.updateParamObject(params,"addressId",addressId,false,-1);this.updateParamObject(params,"orderItemId",suffix,false);this.setShippingInstuctionsForAllOtherItems(addressId,shipModeId,"")}}else{console.debug("shipmentTypeId is undefined. Single shipment has Id 1; multiple shipment has Id 2.")}}if(!submitRequest()){return}cursor_wait();wc.service.invoke("OrderShippingInfoUpdate",params)}},initializeShipmentPage:function(shipmentTypeId){this.shipmentTypeId=shipmentTypeId},setCommonParameters:function(langId,storeId,catalogId){this.langId=langId;this.storeId=storeId;this.catalogId=catalogId},deleteFromCart:function(orderItemId,forWishlist,servItem){if(!this.isAjaxCheckOut()){return}var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=(this.orderId!=null&&this.orderId!="undefined"&&this.orderId!="")?this.orderId:".";params.orderItemId=orderItemId;params.calculateOrder="1";params.calculationUsage="-1,-2,-3,-7";var x=document.getElementById("totalNumberOfItems").value;var y=x;if(!submitRequest()){return}cursor_wait();if(y==1&&servItem==undefined){wc.service.invoke("AjaxOrderItemDelete",params)}else{if(forWishlist){wc.service.invoke("AjaxDeleteOrderItemFromCart",params)}else{if(this.shoppingCartPage||this.pendingOrderDetailsPage){wc.service.invoke("AjaxOrderItemDelete",params)}else{wc.service.invoke("AjaxDeleteOrderItemForShippingBillingPage",params)}}}},addToWishListAndDeleteFromCart:function(catEntryIdentifier,orderItemId){if(!this.isAjaxCheckOut()){return}var params=[];params.catEntryId=catEntryIdentifier;params.URL="SuccessfulAJAXRequest";params.orderItemId=orderItemId;params.updateable=0;if(!submitRequest()){return}cursor_wait();wc.service.invoke("AjaxInterestItemAddAndDeleteFromCart",params)},updateAddressIdOFItemsOnCreateEditAddress:function(addressId){var params=[];params.orderId=".";params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";params.allocate="***";params.backorder="***";params.remerge="***";params.check="*n";var orderItemId=null;for(var i=0;i<this.orderItemIds.length;i++){orderItemId=this.orderItemIds[i];this.updateParamObject(params,"orderItemId",orderItemId,false,-1);this.updateParamObject(params,"addressId",addressId,false,-1)}if(!submitRequest()){return}cursor_wait();wc.service.invoke("AjaxUpdateOrderItemsAddressId",params)},saveOrderItemsList:function(orderItemId,addressId){if(orderItemId=="-1"){var totalItems=document.getElementById("totalNumberOfItems").value;for(var i=0;i<totalItems;i++){if(!document.getElementById("freeGift_qty_"+(i+1))){this.orderItemIds[i]=document.getElementById("orderItem_"+(i+1)).value}}}else{if(orderItemId==0&&this.shipmentTypeId=="1"){if(document.getElementById("singleShipmentAddress")){if(addressId==document.getElementById("singleShipmentAddress").value){var totalItems=document.getElementById("totalNumberOfItems").value;for(var i=0;i<totalItems;i++){if(!document.getElementById("freeGift_qty_"+(i+1))){this.orderItemIds[i]=document.getElementById("orderItem_"+(i+1)).value}}}else{this.orderItemIds=[]}}else{this.orderItemIds=[]}return}else{var totalItems=document.getElementById("totalNumberOfItems").value;var temp=null;var orderItemId=null;var j=0;for(var i=0;i<totalItems;i++){orderItemId=document.getElementById("orderItem_"+(i+1)).value;if(!document.getElementById("freeGift_qty_"+(i+1))){if(document.getElementById("MS_ShipmentAddress_"+orderItemId)){temp=document.getElementById("MS_ShipmentAddress_"+orderItemId).value;if(temp==addressId){this.orderItemIds[j++]=orderItemId}}}}}}},setShippingInstuctionsForAllOtherItems:function(addressId,shipModeId,shipInstructions){var orderItemId,addressId1,shipModeId1="";var totalItems=document.getElementById("totalNumberOfItems").value;for(var i=0;i<totalItems;i++){if(document.getElementById("qty_"+(i+1))!=null&&document.getElementById("qty_"+(i+1)).value!=-1){orderItemId=document.getElementById("orderItem_"+(i+1)).value;addressId1=document.getElementById("MS_ShipmentAddress_"+orderItemId).value;shipModeId1=document.getElementById("MS_ShippingMode_"+orderItemId).value;if(shipModeId1==shipModeId&&addressId1==addressId){document.getElementById("MS_shipInstructions_"+orderItemId).value=shipInstructions}}}},shipAsComplete:function(checkBox){if(!this.isAjaxCheckOut()){return}var params=[];params.orderId=".";params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";if(checkBox.checked){this.updateParamObject(params,"ShipAsComplete","Y",true)}else{this.updateParamObject(params,"ShipAsComplete","N",true)}orderItemId=document.getElementById("orderItem_1").value;this.updateParamObject(params,"orderItemId",orderItemId,false);if(!submitRequest()){return}cursor_wait();wc.service.invoke("OrderShippingInfoUpdate",params)},updateAddressIdForOrderItem:function(addressId){if(addressId==null||addressId.length==0){return true}var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";params.allocate="***";params.backorder="***";params.remerge="***";params.check="*n";this.updateParamObject(params,"addressId",addressId,false);wc.service.invoke("AjaxSetAddressIdOfOrderItems",params)},updateShipModeIdForOrder:function(shipModeId){var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.shipModeId=shipModeId;params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";params.allocate="***";params.backorder="***";params.remerge="***";params.check="*n";wc.service.invoke("AjaxSetShipModeIdForOrder",params)},applyPromotionCode:function(formName,returnView){var form=document.forms[formName];if(this.isAjaxCheckOut()){service=wc.service.getServiceById("AjaxPromotionCodeManage");service.formId=formName;if(form.URL!=null){form.URL.value=""}if(!submitRequest()){return}cursor_wait();wc.service.invoke("AjaxPromotionCodeManage")}else{if(returnView==null||returnView==""||returnView=="undefined"){returnView="OrderShippingBillingView"}var input=document.createElement("INPUT");input.setAttribute("type","hidden");input.setAttribute("name","errorViewName");input.setAttribute("value",returnView);form.appendChild(input);form.URL.value="OrderCalculate?updatePrices=1&calculationUsageId=-1&calculationUsageId=-2&calculationUsageId=-7&URL="+returnView;if(!submitRequest()){return}form.submit()}},removePromotionCode:function(formName,promoCode,returnView){var form=document.forms[formName];form.taskType.value="R";form.promoCode.value=promoCode;if(this.isAjaxCheckOut()){service=wc.service.getServiceById("AjaxPromotionCodeManage");service.formId=formName;if(!submitRequest()){return}cursor_wait();wc.service.invoke("AjaxPromotionCodeManage")}else{if(returnView==null||returnView==""||returnView=="undefined"){returnView="OrderShippingBillingView"}form.URL.value="OrderCalculate?updatePrices=1&calculationUsageId=-1&calculationUsageId=-2&calculationUsageId=-7&URL="+returnView;if(!submitRequest()){return}form.submit()}},applyCoupon:function(formName,returnView,couponId){var form=document.forms[formName];form.couponId.value=couponId;form.taskType.value="A";if(!submitRequest()){return}if(this.isAjaxCheckOut()){service=wc.service.getServiceById("AjaxCouponsAddRemove");service.formId=formName;cursor_wait();wc.service.invoke("AjaxCouponsAddRemove")}else{form.URL.value="OrderCalculate?updatePrices=1&calculationUsageId=-1&calculationUsageId=-2&calculationUsageId=-7&URL="+returnView;form.submit()}},removeCouponFromOrder:function(formName,returnView,couponId){var form=document.forms[formName];form.couponId.value=couponId;form.taskType.value="R";if(!submitRequest()){return}if(this.isAjaxCheckOut()){service=wc.service.getServiceById("AjaxCouponsAddRemove");service.formId=formName;cursor_wait();wc.service.invoke("AjaxCouponsAddRemove")}else{form.URL.value="OrderCalculate?updatePrices=1&calculationUsageId=-1&calculationUsageId=-2&calculationUsageId=-7&URL="+returnView;form.submit()}},setAjaxCheckOut:function(ajaxCheckOut){this.ajaxCheckOut=ajaxCheckOut},isAjaxCheckOut:function(){return this.ajaxCheckOut},setSinglePageCheckout:function(singlePageCheckout){this.singlePageCheckout=singlePageCheckout},isSinglePageCheckout:function(){return this.singlePageCheckout},checkoutOrder:function(orderId,userType,addressListForMailNotification,isQuote){if(isQuote==undefined||isQuote==null){isQuote=false}params=[];params.orderId=orderId;params.notifyMerchant=1;params.notifyShopper=1;params.notifyOrderSubmitted=1;params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;var purchaseOrderForm=document.forms.purchaseOrderNumberInfo;if(purchaseOrderForm){var purchaseOrderNumber=purchaseOrderForm.purchase_order_number.value;if(purchaseOrderForm.purchaseOrderNumberRequired.value=="true"&&purchaseOrderForm.purchase_order_number.value==""){MessageHelper.formErrorHandleClient(purchaseOrderForm.purchase_order_number,MessageHelper.messages.ERROR_PONumberEmpty);return}else{if(!MessageHelper.isValidUTF8length(purchaseOrderForm.purchase_order_number.value,128)){MessageHelper.formErrorHandleClient(purchaseOrderForm.purchase_order_number,MessageHelper.messages.ERROR_PONumberTooLong);return}}}params.purchaseorder_id=purchaseOrderNumber;if(userType=="G"){addressListForMailNotification=trim(addressListForMailNotification);var emailList=[];emailList=addressListForMailNotification.split(" ");var uniqueList=[];for(var j=0;j<emailList.length;j++){uniqueList[emailList[j]]=emailList[j]}var totalLength=0;for(i in uniqueList){totalLength=totalLength+1}var temp="";var k=0;for(i in uniqueList){k=k+1;temp=temp+uniqueList[i];if(k<totalLength){temp=temp+","}}params.notify_EMailSender_recipient=temp;var smsOrderNotificationCheckbox=document.getElementById("sendMeSMSNotification");if(smsOrderNotificationCheckbox!=null&&smsOrderNotificationCheckbox!="undefined"){if(smsOrderNotificationCheckbox.checked){var mobileCountryCode=document.getElementById("mobileCountryCode");var mobilePhone1=document.getElementById("mobilePhone1");if(mobileCountryCode!=null&&mobileCountryCode!="undefined"&&mobilePhone1!=null&&mobilePhone1!="undefined"){params.SMS=mobileCountryCode.value+mobilePhone1.value}}}}if(!submitRequest()){return}cursor_wait();if(!isQuote){wc.service.invoke("AjaxSubmitOrder",params)}else{params.URL="";this.setOrderId(orderId);wc.service.invoke("AjaxSubmitQuote",params)}},prepareOrderSchedule:function(){if(document.getElementById("scheduleOrderInputSection")!=null){var scheduleOrderStartDateObj=dijit.byId("ScheduleOrderStartDate");if(!this.validateDate(scheduleOrderStartDateObj,"ScheduleOrderStartDate")){return}var interval=document.getElementById("ScheduleOrderFrequency").value;var key1="WC_ScheduleOrder_"+document.getElementById("orderIdToSchedule").value+"_strStartDate";var key2="WC_ScheduleOrder_"+document.getElementById("orderIdToSchedule").value+"_interval";if((interval=="undefined")&&(scheduleOrderStartDateObj.value==null)){dojo.cookie(key1,null,{expires:-1});dojo.cookie(key2,null,{expires:-1})}else{var t=dojo.date.stamp.fromISOString(scheduleOrderStartDateObj);var now=new Date();t.setHours(now.getHours(),now.getMinutes(),now.getSeconds(),now.getMilliseconds());t.setHours(12);t=dojo.date.stamp.toISOString(t,{selector:"%Y-%m-%dT%H:%m:%S.%SZ",zulu:true,milliseconds:true});dojo.cookie(key1,t);dojo.cookie(key2,interval)}}},scheduleOrder:function(orderId){var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=orderId;params.strStartDate=dojo.cookie("WC_ScheduleOrder_"+orderId+"_strStartDate");params.interval=dojo.cookie("WC_ScheduleOrder_"+orderId+"_interval");var purchaseOrderForm=document.forms.purchaseOrderNumberInfo;if(purchaseOrderForm){var purchaseOrderNumber=purchaseOrderForm.purchase_order_number.value;if(purchaseOrderForm.purchaseOrderNumberRequired.value=="true"&&purchaseOrderForm.purchase_order_number.value==""){MessageHelper.formErrorHandleClient(purchaseOrderForm.purchase_order_number,MessageHelper.messages.ERROR_PONumberEmpty);return}else{if(!MessageHelper.isValidUTF8length(purchaseOrderForm.purchase_order_number.value,128)){MessageHelper.formErrorHandleClient(purchaseOrderForm.purchase_order_number,MessageHelper.messages.ERROR_PONumberTooLong);return}}params.purchaseorder_id=purchaseOrderNumber}if(!submitRequest()){return}cursor_wait();wc.service.invoke("ScheduleOrder",params)},validateDate:function(dateObj,elementId){var now=new Date();if(dateObj.getValue()!=null&&(dateObj.compare(dateObj.getValue(),now)<0)){var interval=document.getElementById("ScheduleOrderFrequency").value;if(interval==""){if(now.toDateString()==dateObj.getValue().toDateString()){return true}}if((elementId!=null)&&(document.getElementById(elementId)!=null)){MessageHelper.formErrorHandleClient(document.getElementById(elementId).id,MessageHelper.messages.PAST_DATE_ERROR)}else{MessageHelper.displayErrorMessage(MessageHelper.messages.PAST_DATE_ERROR)}return false}else{return true}},createAddress:function(orderItemId,addressType){this.saveOrderItemsList(orderItemId,"-1");if(!submitRequest()){return}var checkForOpera=true;cursor_wait(checkForOpera);wc.render.updateContext("editShippingAddressContext",{shippingAddress:"-1",addressType:addressType});this.showHideDivs("editAddressContents","mainContents")},showHideDivs:function(showArea,hideArea){document.getElementById(hideArea).style.display="none";document.getElementById(showArea).style.display="block"},restorePreviousAddressDetails:function(){var valueRestored=false;if(!this.isAjaxCheckOut()){for(i in this.selectedAddressesArray){if(document.getElementById(i).value==-1){document.getElementById(i).value=this.selectedAddressesArray[i];valueRestored=true;if(this.shipmentTypeId=="1"){this.displayAddressDetails(document.getElementById("singleShipmentAddress").value,"Shipping")}}}}if(this.isAjaxCheckOut()||!valueRestored){if(this.shipmentTypeId=="2"){for(var i=0;i<this.orderItemIds.length;i++){var orderItemId=this.orderItemIds[i];var element=document.getElementById("MS_ShipmentAddress_"+orderItemId);if(element!=null&&element.value==-1){element.value=document.getElementById("addressId_"+orderItemId).value}}}else{if(this.shipmentTypeId=="1"){var element=document.getElementById("singleShipmentAddress");if(element!=null&&document.getElementById("addressId_all")){element.value=document.getElementById("addressId_all").value;if(!this.isAjaxCheckOut()){this.displayAddressDetails(element.value,"Shipping")}}}}}for(var i=1;i<4;i++){if(document.getElementById("PaymentForm"+i)!=null){var paymentForm=document.getElementById("PaymentForm"+i);if(paymentForm.billing_address_id.value==-1){paymentForm.billing_address_id.value=document.getElementById("selectedAddressId_"+i).value;if(!this.isAjaxCheckOut()){CheckoutPayments.displayBillingAddressDetailsWeb10(paymentForm.billing_address_id,i)}}}}},editAddress:function(addressSelectBoxName,orderItemId,profileshipping,profilebilling){var addressBox=document.getElementById(addressSelectBoxName);this.saveOrderItemsList(orderItemId,addressBox.value);if(addressBox.options[addressBox.selectedIndex].text==profileshipping||addressBox.options[addressBox.selectedIndex].text==profilebilling){if(addressSelectBoxName!=null){MessageHelper.formErrorHandleClient(addressSelectBoxName,MessageHelper.messages.ERROR_QUICKCHECKOUT_ADDRESS_CHANGE)}else{MessageHelper.displayErrorMessage(MessageHelper.messages.ERROR_QUICKCHECKOUT_ADDRESS_CHANGE)}return}if(!submitRequest()){return}cursor_wait();wc.render.updateContext("editShippingAddressContext",{shippingAddress:addressBox.value});this.showHideDivs("editAddressContents","mainContents")},editBillingAddress:function(orderItemId,paymentArea,profileshipping,profilebilling){var form=document.forms["PaymentForm"+paymentArea];var addressBox=form.billing_address_id;this.saveOrderItemsList(orderItemId,addressBox.value);if(addressBox.options[addressBox.selectedIndex].text==profileshipping||addressBox.options[addressBox.selectedIndex].text==profilebilling){if(addressBox!=null){MessageHelper.formErrorHandleClient(addressBox,MessageHelper.messages.ERROR_QUICKCHECKOUT_ADDRESS_CHANGE)}else{MessageHelper.displayErrorMessage(MessageHelper.messages.ERROR_QUICKCHECKOUT_ADDRESS_CHANGE)}return}if(!submitRequest()){return}cursor_wait();wc.render.updateContext("editShippingAddressContext",{shippingAddress:addressBox.value});this.showHideDivs("editAddressContents","mainContents")},cancelEditAddress:function(){this.showHideDivs("mainContents","editAddressContents");this.restorePreviousAddressDetails()},getShipmentTypeId:function(){return this.shipmentTypeId},paymentDataDirty:function(paymentAreaNumber,flag){this.dataDirty[paymentAreaNumber]=flag;console.debug("Information in payment area "+paymentAreaNumber+" has been modified.")},isPaymentDataDirty:function(paymentAreaNumber){return this.dataDirty[paymentAreaNumber]},displayStoreAddressDetails:function(addressSelectBox){var selectedAddressId=addressSelectBox.value;for(j=0;j<addressSelectBox.options.length;j++){if(addressSelectBox.options[j].value==selectedAddressId){dojo.byId("addressDetails_"+addressSelectBox.options[j].value).style.display="block"}else{dojo.byId("addressDetails_"+addressSelectBox.options[j].value).style.display="none"}}},updateStoreAddressForAllItems:function(addressSelectBox){if(!this.isAjaxCheckOut()){return}var addressId=addressSelectBox.value;params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";var orderItemId=null;var totalItems=document.getElementById("totalNumberOfItems").value;var addressId=document.getElementById("singleShipmentAddress").value;for(var i=0;i<totalItems;i++){orderItemId=document.getElementById("orderItem_"+(i+1)).value;this.updateParamObject(params,"orderItemId",orderItemId,false,-1);this.updateParamObject(params,"physicalStoreId",addressId,false,-1)}if(!submitRequest()){return}cursor_wait();wc.service.invoke("AjaxUpdateOrderItem",params)},updateShippingModeAndAddressForOrderItem:function(shippingModeSelectBox,orderItemId,pickUpInStoreShipMode){if(!this.isAjaxCheckOut()){return}var selectedShippingMode=shippingModeSelectBox.value;if(pickUpInStoreShipMode==selectedShippingMode){document.getElementById("MS_ShipMode_Section_"+orderItemId).className="nodisplay";document.getElementById("MS_ShipAdvancedOptions_Section_"+orderItemId).className="nodisplay";document.getElementById("MS_ShippingAddress_Section_"+orderItemId).className="nodisplay";document.getElementById("MS_StoreAddress_Section_"+orderItemId).className=""}else{document.getElementById("MS_ShipMode_Section_"+orderItemId).className="";document.getElementById("MS_ShipAdvancedOptions_Section_"+orderItemId).className="";document.getElementById("MS_ShippingAddress_Section_"+orderItemId).className="";document.getElementById("MS_StoreAddress_Section_"+orderItemId).className="nodisplay"}params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";params.orderItemId=orderItemId;params.shipModeId=selectedShippingMode;params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";if(pickUpInStoreShipMode==selectedShippingMode){var physicalStoreId=document.getElementById("MS_StoreSelectBox_"+orderItemId).value;params.physicalStoreId=physicalStoreId}else{if(document.getElementById("MS_ShipmentAddress_"+orderItemId)){var addressId=document.getElementById("MS_ShipmentAddress_"+orderItemId).value;params.addressId=addressId}}if(!submitRequest()){return}cursor_wait();wc.service.invoke("AjaxUpdateOrderItem",params)},updateStoreAddressForOrderItem:function(storeAddressSelectBox,orderItemId){if(!this.isAjaxCheckOut()){return}var selectedPickUpStoreId=storeAddressSelectBox.value;params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";params.orderItemId=orderItemId;params.physicalStoreId=selectedPickUpStoreId;params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";if(!submitRequest()){return}cursor_wait();wc.service.invoke("AjaxUpdateOrderItem",params)},setFieldDirtyFlag:function(value){this.fieldDirtyFlag=value},getFieldDirtyFlag:function(){return this.fieldDirtyFlag},checkForDirtyFlag:function(){if(this.getFieldDirtyFlag()){if(document.getElementById("ShoppingCart_NonAjaxUpdate")!=null){MessageHelper.formErrorHandleClient(document.getElementById("ShoppingCart_NonAjaxUpdate"),MessageHelper.messages.ERROR_UPDATE_FIRST_SHOPPING_CART);return true}else{if(document.getElementById("MultipleShipment_NonAjaxShipInfoUpdate")!=null){MessageHelper.formErrorHandleClient(document.getElementById("MultipleShipment_NonAjaxShipInfoUpdate"),MessageHelper.messages.ERROR_UPDATE_FIRST);return true}else{if(document.getElementById("SingleShipment_NonAjaxShipInfoUpdate")!=null){MessageHelper.formErrorHandleClient(document.getElementById("SingleShipment_NonAjaxShipInfoUpdate"),MessageHelper.messages.ERROR_UPDATE_FIRST);return true}else{MessageHelper.displayErrorMessage(MessageHelper.messages.ERROR_UPDATE_FIRST);return true}}}}return false},showHideCheckoutSMS:function(checkboxElementId,smsElementId){var smsOrderNotificationCheckbox=document.getElementById(checkboxElementId);if(smsOrderNotificationCheckbox!=null&&smsOrderNotificationCheckbox!="undefined"){if(smsOrderNotificationCheckbox.checked){showElementById(smsElementId)}else{hideElementById(smsElementId)}}},getCountryArray:function(){if(document.countries==null){countries=new Array();var theDiv=document.getElementById("countryListSelectionHelper");if(typeof theDiv=="undefined"){return null}var divJSON=eval("("+theDiv.innerHTML+")");var countriesObject=divJSON.countries;for(var i=0;i<countriesObject.length;i++){var countryObject=countriesObject[i];countries[countryObject.code]=new Object();countries[countryObject.code].name=countryObject.displayName;countries[countryObject.code].countryCallingCode=countryObject.callingCode;if(countryObject.states.length>0){countries[countryObject.code].states=new Object();for(var j=0;j<countryObject.states.length;j++){var state=countryObject.states[j];countries[countryObject.code].states[state.code]=state.displayName}}}}return countries},loadCountryCode:function(countryDropDownId,countryCallingCodeId){this.getCountryArray();var countryCode=document.getElementById(countryDropDownId).value;document.getElementById(countryCallingCodeId).value=countries[countryCode].countryCallingCode},expediteShipping:function(checkBox,inputOrderItemId){if(!this.isAjaxCheckOut()){return}var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;if(checkBox.checked){this.updateParamObject(params,"isExpedited","Y",true)}else{this.updateParamObject(params,"isExpedited","N",true)}if(inputOrderItemId!=null){this.updateParamObject(params,"orderItemId",inputOrderItemId,false)}if(!submitRequest()){return}cursor_wait();wc.service.invoke("OrderShippingInfoUpdate",params)},updateCartWait:function(quantityBox,orderItemId,event){if(event.keyCode==dojo.keys.TAB){return}if(!this.isAjaxCheckOut()){return}if(this.keyPressCount[orderItemId]==null&&isNaN(this.keyPressCount[orderItemId])){this.keyPressCount[orderItemId]=0}this.keyPressCount[orderItemId]=parseInt(this.keyPressCount[orderItemId])+1;setTimeout(dojo.hitch(this,"updateCart",quantityBox,orderItemId,this.keyPressCount[orderItemId]),this.updateWaitTimeOut)},updateCart:function(quantityBox,orderItemId,keyPressCountValue){if(keyPressCountValue<this.keyPressCount[orderItemId]){return}var quantity=(quantityBox.value);if(!isNonNegativeInteger(quantity)){MessageHelper.formErrorHandleClient(quantityBox,MessageHelper.messages.QUANTITY_INPUT_ERROR)}else{var params=[];params.orderId=".";params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";this.updateParamObject(params,"orderItemId",orderItemId,false,-1);this.updateParamObject(params,"quantity",quantity,false,-1);if(!submitRequest()){return}cursor_wait();wc.service.invoke("AjaxUpdateOrderItem",params)}},initDojoEventListenerShoppingCartPage:function(){if(document.getElementById("totalNumberOfItems")!=null){var totalItems=document.getElementById("totalNumberOfItems").value;if(totalItems!=null&&totalItems>0){for(var i=0;i<totalItems;i++){var object=dojo.byId("quantity_"+(i+1));if(object!=null){dojo.connect(object,"onchange",setDirtyFlag)}}}else{console.debug("error: element 'totalNumberOfItems' was expected but undefined.");return}}},updateShoppingCart:function(form,validateQuantityOnly){if(validateQuantityOnly!=undefined&&validateQuantityOnly==true&&!this.isAjaxCheckOut()){return true}MessageHelper.hideAndClearMessage();var totalItems=document.getElementById("totalNumberOfItems").value;if(totalItems!=null){for(var i=0;i<totalItems;i++){if(form!=undefined){var quantity=null;quantity=form["quantity_"+(i+1)]}else{var quantity=dojo.byId("qty_"+(i+1))}if(quantity!=null||quantity!=undefined){var v=quantity.value;if(!isNonNegativeInteger(v)){MessageHelper.formErrorHandleClient(quantity.id,MessageHelper.messages.QUANTITY_INPUT_ERROR);return}}}if(validateQuantityOnly!=undefined&&validateQuantityOnly==true){return true}if(!submitRequest()){return}var beginIndex=wc.render.getContextById("ShopCartPaginationDisplay_Context").properties.beginIndex;if(beginIndex==null||beginIndex==""){beginIndex=0}form.URL.value=form.URL.value+"&beginIndex="+beginIndex;form.submit();this.setFieldDirtyFlag(false)}else{console.debug("error: element 'totalNumberOfItems' was expected but undefined.");return}},updateCartWithQuickCheckoutProfile:function(quickOrderId){var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.toOrderId=".";params.shippingAddressFromOrderProfile="1";params.shippingModeFromOrderProfile="1";params.URL="dummy";params.payInfoFrom=quickOrderId;wc.service.declare({id:"QuickCheckOutOrderCopy",actionId:"QuickCheckOutOrderCopy",url:"AjaxOrderCopy",successHandler:function(serviceResponse){cursor_clear();document.location.href="OrderProcessServiceOrderPrepare?storeId="+CheckoutHelperJS.storeId+"&catalogId="+CheckoutHelperJS.catalogId+"&langId="+CheckoutHelperJS.langId+"&orderId=.&URL=OrderShippingBillingView?langId="+CheckoutHelperJS.langId+"&storeId="+CheckoutHelperJS.storeId+"&catalogId="+CheckoutHelperJS.catalogId+"&quickCheckoutProfileForPayment=true"},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}});if(!submitRequest()){return}cursor_wait();wc.service.invoke("QuickCheckOutOrderCopy",params)},addNewShippingAddress:function(addressType){this.displayAddressDetails(-1,addressType)},updateAddressForAllItems:function(addressSelectBox){if(addressSelectBox.value!=-1){this.selectedAddressesArray[addressSelectBox.name]=addressSelectBox.value}if(!this.isAjaxCheckOut()){return}var addressId=addressSelectBox.value;if(addressId==-1){return}params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";params.allocate="***";params.backorder="***";params.remerge="***";params.check="*n";var addressId=document.getElementById("singleShipmentAddress").value;this.updateParamObject(params,"addressId",addressId,false);var enabledShipInstructions=false;var shipInstructions;if(document.getElementById("shipInstructions")!=null){shipInstructions=document.getElementById("shipInstructions").value;reWhiteSpace=new RegExp(/^\s+$/);if(reWhiteSpace.test(shipInstructions)){shipInstructions=""}enabledShipInstructions=true}if(!submitRequest()){return}cursor_wait();if(!enabledShipInstructions||shipInstructions==undefined||shipInstructions==""){wc.service.invoke("OrderItemAddressShipMethodUpdate",params)}else{wc.service.invoke("OrderItemAddressShipInstructionsUpdate",params)}},updateShipModeForAllItems:function(shipmentSelectBox){if(!this.isAjaxCheckOut()){return}var shipModeId=shipmentSelectBox.value;if(shipModeId==-1){return}params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";params.allocate="***";params.backorder="***";params.remerge="***";params.check="*n";this.updateParamObject(params,"shipModeId",shipModeId,false);if(!submitRequest()){return}cursor_wait();wc.service.invoke("OrderItemAddressShipMethodUpdate",params)},updateShippingInstructionsForAllItems:function(){if(!this.isAjaxCheckOut()){return}params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";var orderItemId=null;var shipInstructions=document.getElementById("shipInstructions").value;reWhiteSpace=new RegExp(/^\s+$/);if(reWhiteSpace.test(shipInstructions)){shipInstructions=""}if(!MessageHelper.isValidUTF8length(shipInstructions,4000)){MessageHelper.formErrorHandleClient(document.getElementById("shipInstructions").id,MessageHelper.messages.ERROR_ShippingInstructions_TooLong);return}orderItemId=document.getElementById("orderItem_1").value;this.updateParamObject(params,"orderItemId",orderItemId,false);this.updateParamObject(params,"shipInstructions",shipInstructions,false);if(!submitRequest()){return}cursor_wait();wc.service.invoke("OrderShippingInfoUpdate",params)},updateShippingChargeForShipModeAjax:function(curOrderId,shipModeId,shipChargeType,shipAcctNum){if(!this.isAjaxCheckOut()){return}params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=curOrderId;params.URL="";params.shipModeId=shipModeId;params.shipChargTypeId=shipChargeType;if(shipAcctNum!=null&&shipAcctNum!=undefined){params.shipCarrAccntNum=shipAcctNum}else{params.shipCarrAccntNum=""}if(!submitRequest()){return}cursor_wait();wc.service.invoke("AjaxOrderShipChargeUpdate",params)},updateShippingChargeForShipMode:function(myForm){if(this.isAjaxCheckOut()){return}myForm.URL.value="OrderProcessServiceOrderPrepare?storeId="+CheckoutHelperJS.storeId+"&catalogId="+CheckoutHelperJS.catalogId+"&langId="+CheckoutHelperJS.langId+"&orderId=.&URL=OrderShippingBillingView?forceShipmentType=2";myForm.submit()},hideShipChargeAccountField:function(selectValue,acctFieldId){if(document.getElementById(selectValue).value.indexOf("ByCarrier")>-1){document.getElementById(acctFieldId).style.display="block"}else{document.getElementById(acctFieldId).style.display="none"}},updateRequestedShipDate:function(jsDate){if(jsDate==null||jsDate.getDisplayedValue()==null){return}var now=new Date();if(jsDate.compare(jsDate.getValue(),now)<=0){if(document.getElementById("requestedShippingDate")!=null){MessageHelper.formErrorHandleClient(document.getElementById("requestedShippingDate").id,MessageHelper.messages.REQUESTED_SHIPPING_DATE_OUT_OF_RANGE_ERROR)}else{MessageHelper.displayErrorMessage(MessageHelper.messages.REQUESTED_SHIPPING_DATE_OUT_OF_RANGE_ERROR)}return}if(!this.isAjaxCheckOut()){return}var t="";if(jsDate.getDisplayedValue()!=""){t=dojo.date.stamp.fromISOString(jsDate);t.setHours(12);t=dojo.date.stamp.toISOString(t,{selector:"%Y-%m-%dT%H:%m:%S.%SZ",zulu:true,milliseconds:true})}else{if(jsDate.getDisplayedValue()==""){t=this.resetRequestedShipDateValue}}jsDate._close();this.updateShippingDateForAllItems(t)},updateShippingDateForAllItems:function(date){params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";params.allocate="***";params.backorder="***";params.remerge="***";params.check="*n";this.updateParamObject(params,"requestedShipDate",date,false);if(!submitRequest()){return}cursor_wait();wc.service.invoke("OrderItemAddressShipMethodUpdate",params)},displayAddressDetails:function(addressSelectBoxValue,addressType){if(!this.isAjaxCheckOut()){this.displayAddressDetailsWeb10(addressSelectBoxValue,addressType)}else{if(addressSelectBoxValue!=-1){if(!submitRequest()){return}var checkForOpera=true;cursor_wait(checkForOpera);wc.render.updateContext("shippingAddressContext",{shippingAddress:addressSelectBoxValue})}else{this.createAddress(-1,addressType)}}},displayAddressDetailsWeb10:function(addressSelectBoxValue,addressType){var selectedAddressId=addressSelectBoxValue;var addressSelectBox=dojo.byId("singleShipmentAddress");for(j=0;j<addressSelectBox.options.length;j++){if(addressSelectBox.options[j].value==selectedAddressId){dojo.byId("addressDetails_"+addressSelectBox.options[j].value).style.display="block"}else{dojo.byId("addressDetails_"+addressSelectBox.options[j].value).style.display="none"}}if(selectedAddressId==-1){this.createAddress(-1,addressType)}},initDojoEventListenerSingleShipmentPage:function(){var totalItems=document.getElementById("totalNumberOfItems").value;if(totalItems!=null&&totalItems>0){if(dojo.byId("singleShipmentAddress")!=null){dojo.connect(dojo.byId("singleShipmentAddress"),"onchange",setDirtyFlag)}if(dojo.byId("WC_ShippingAddressSelectSingle_div_2")!=null){dojo.connect(dojo.byId("WC_ShippingAddressSelectSingle_div_2"),"onclick",setDirtyFlag)}if(dojo.byId("singleShipmentShippingMode")!=null){dojo.connect(dojo.byId("singleShipmentShippingMode"),"onchange",setDirtyFlag)}if(dojo.byId("shipAsComplete")!=null){dojo.connect(dojo.byId("shipAsComplete"),"onclick",setDirtyFlag)}if(dojo.byId("shippingInstructionsCheckbox")!=null){dojo.connect(dojo.byId("shippingInstructionsCheckbox"),"onclick",setDirtyFlag)}if(dojo.byId("requestShippingDateCheckbox")!=null){dojo.connect(dojo.byId("requestShippingDateCheckbox"),"onclick",setDirtyFlag)}if(dojo.byId("shipInstructions")!=null){dojo.connect(dojo.byId("shipInstructions"),"onchange",setDirtyFlag)}if(dojo.byId("expediteShipping")!=null){dojo.connect(dojo.byId("expediteShipping"),"onchange",setDirtyFlag)}if(dojo.byId("expediteShipping_1")!=null){for(var i=0;i<totalItems;i++){if(dojo.byId("qty_"+(i+1)).value!="-1"){var object=dojo.byId("expediteShipping_"+(i+1));dojo.connect(object,"onchange",setDirtyFlag)}}}}else{console.debug("error: element 'totalNumberOfItems' was expected but undefined.");return}},updateSingleShipmentShoppingCart:function(form){var formAction="OrderChangeServiceShipInfoUpdate?";var updateShippingURL="OrderChangeServiceShipInfoUpdate?";var instructions=null;var t=null;if(dojo.byId("shippingInstructionsCheckbox")!=null){if(dojo.byId("shippingInstructionsCheckbox").checked){if(document.getElementById("shipInstructions")!=null&&document.getElementById("shipInstructions").value!=null){if(MessageHelper.isValidUTF8length(document.getElementById("shipInstructions").value,4000)){instructions=document.getElementById("shipInstructions").value}else{MessageHelper.formErrorHandleClient(document.getElementById("shipInstructions").id,MessageHelper.messages.ERROR_ShippingInstructions_TooLong);return}}}else{if(document.getElementById("shipInstructions")!=null){instructions=""}}}if(dojo.byId("requestShippingDateCheckbox")!=null){var jsDateObj=dijit.byId("requestedShippingDate");if(dojo.byId("requestShippingDateCheckbox").checked){if(jsDateObj!=null&&jsDateObj.getDisplayedValue()!=null){var now=new Date();if(jsDateObj.compare(jsDateObj.getValue(),now)<=0){if(document.getElementById("requestedShippingDate")!=null){MessageHelper.formErrorHandleClient(document.getElementById("requestedShippingDate").id,MessageHelper.messages.REQUESTED_SHIPPING_DATE_OUT_OF_RANGE_ERROR)}else{MessageHelper.displayErrorMessage(MessageHelper.messages.REQUESTED_SHIPPING_DATE_OUT_OF_RANGE_ERROR)}return}var t="";if(jsDateObj.getDisplayedValue()!=""){t=dojo.date.stamp.fromISOString(jsDateObj);t.setHours(12);t=dojo.date.stamp.toISOString(t,{selector:"%Y-%m-%dT%H:%m:%S.%SZ",zulu:true,milliseconds:true})}else{if(jsDateObj.getDisplayedValue()==""){t=this.resetRequestedShipDateValue}}}}else{if(jsDateObj!=null){t=this.resetRequestedShipDateValue}}}if(document.getElementById("singleShipmentAddress").value!=-1){updateShippingURL=updateShippingURL+"addressId="+document.getElementById("singleShipmentAddress").value}else{MessageHelper.formErrorHandleClient(document.getElementById("singleShipmentAddress").id,MessageHelper.messages.SHIPPING_INVALID_ADDRESS);return}formAction=formAction+"shipModeId="+document.getElementById("singleShipmentShippingMode").value;if(this.shipChargeEnabled){formAction=formAction+"&shippingChargeType="+document.getElementById("shipChargTypeId_1").value;formAction=formAction+"&shipCarrAccntNum="+document.getElementById("shipCarrAccntNum_1").value}var shipInstructions="";if(instructions!=null){shipInstructions="shipInstructions%3D"+instructions+"%26orderItemId_1%3D"+document.getElementById("orderItem_1").value}if(t!=null){formAction=formAction+"&requestedShipDate="+t}var checkBox=document.getElementById("shipAsComplete");if(checkBox.checked){formAction=formAction+"&ShipAsComplete=Y"}else{formAction=formAction+"&ShipAsComplete=N"}if(document.getElementById("expediteShipping_1")!=null){var totalNumberOfItemsOnPage=document.getElementById("totalNumberOfItems").value;for(var i=0;i<totalNumberOfItemsOnPage;i++){if(document.getElementById("qty_"+(i+1)).value!="-1"){var orderItemId=document.getElementById("orderItem_"+(i+1)).value;if(document.getElementById("orderItemId_"+(i+1))!=null){document.getElementById("orderItemId_"+(i+1)).value=orderItemId}var object=document.getElementById("expediteShipping_"+(i+1));if(object.checked){document.getElementById("isExpedited_"+(i+1)).value="Y"}else{document.getElementById("isExpedited_"+(i+1)).value="N"}}}}form.action=formAction;var beginIndex=wc.render.getContextById("traditionalShipmentDetailsContext").properties.beginIndex;if(beginIndex==null||beginIndex==""){beginIndex=0}form.URL.value=updateShippingURL+"&requestedShipDate*=&shipModeId*=&orderItemId*=&URL=OrderChangeServiceShipInfoUpdate%3F"+shipInstructions+"%26allocate%3D***%26backorder%3D***%26remerge%3D***%26check%3D*n%26URL%3DOrderShippingBillingView%3F%26beginIndex%3D"+beginIndex;if(!submitRequest()){return}form.submit()},moveAllItemsToSingleShipment:function(){var orderItemId=document.getElementById("orderItem_1").value;var addressId=document.getElementById("MS_ShipmentAddress_"+orderItemId).value;params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";this.updateParamObject(params,"addressId",addressId,false);if(!submitRequest()){return}cursor_wait();wc.service.invoke("OrderItemAddressShipMethodUpdate1",params)},addNewShippingAddressForMS:function(orderItemId){this.updateAddressIdForThisItem(-1,orderItemId)},updateAddressIdForThisItem:function(addressBoxValue,orderItemId){if(addressBoxValue!=-1){var addressBox=dojo.byId("MS_ShipmentAddress_"+orderItemId);this.selectedAddressesArray[addressBox.name]=addressBoxValue}if(addressBoxValue==-1){return}if(!this.isAjaxCheckOut()){return}params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";params.allocate="***";params.backorder="***";params.remerge="***";params.check="*n";var addressId=addressBoxValue;this.updateParamObject(params,"orderItemId",orderItemId,false,-1);this.updateParamObject(params,"addressId",addressId,false,-1);if(!submitRequest()){return}cursor_wait();wc.service.invoke("OrderItemAddressShipMethodUpdate",params)},updateShipModeForThisItem:function(shipModeBox,orderItemId){var shipModeId=shipModeBox.value;if(shipModeId==-1){return}if(!this.isAjaxCheckOut()){return}params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";this.updateParamObject(params,"orderItemId",orderItemId,false,-1);this.updateParamObject(params,"shipModeId",shipModeId,false,-1);params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";params.allocate="***";params.backorder="***";params.remerge="***";params.check="*n";if(!submitRequest()){return}cursor_wait();wc.service.invoke("OrderItemAddressShipMethodUpdate",params)},updateShippingInstructionsForThisItem:function(textArea,orderItemId){var addressId=document.getElementById("MS_ShipmentAddress_"+orderItemId).value;var shipModeId=document.getElementById("MS_ShippingMode_"+orderItemId).value;var shipInstructions=textArea.value;reWhiteSpace=new RegExp(/^\s+$/);if(reWhiteSpace.test(shipInstructions)){shipInstructions=""}if(this.isAjaxCheckOut()){if(!MessageHelper.isValidUTF8length(shipInstructions,4000)){MessageHelper.formErrorHandleClient(textArea.id,MessageHelper.messages.ERROR_ShippingInstructions_TooLong);return}}this.setShippingInstuctionsForAllOtherItems(addressId,shipModeId,shipInstructions);if(!this.isAjaxCheckOut()){return}params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";this.updateParamObject(params,"addressId",addressId,false,-1);this.updateParamObject(params,"shipModeId",shipModeId,false,-1);this.updateParamObject(params,"shipInstructions",shipInstructions,false,-1);this.updateParamObject(params,"orderItemId",orderItemId,false,-1);if(!submitRequest()){return}cursor_wait();wc.service.invoke("OrderShippingInfoUpdate",params)},updateRequestedShipDateForThisItem:function(jsDate,orderItemId){if(jsDate==null||jsDate.getDisplayedValue()==null){return}var now=new Date();if(jsDate.compare(jsDate.getValue(),now)<=0){if(document.getElementById("MS_requestedShippingDate_"+orderItemId)!=null){MessageHelper.formErrorHandleClient(document.getElementById("MS_requestedShippingDate_"+orderItemId).id,MessageHelper.messages.REQUESTED_SHIPPING_DATE_OUT_OF_RANGE_ERROR)}else{MessageHelper.displayErrorMessage(MessageHelper.messages.REQUESTED_SHIPPING_DATE_OUT_OF_RANGE_ERROR)}return}if(!this.isAjaxCheckOut()){return}var t="";if(jsDate.getDisplayedValue()!=""){t=dojo.date.stamp.fromISOString(jsDate);t.setHours(12);t=dojo.date.stamp.toISOString(t,{selector:"%Y-%m-%dT%H:%m:%S.%SZ",zulu:true,milliseconds:true})}else{if(jsDate.getDisplayedValue()==""){t=this.resetRequestedShipDateValue}}jsDate._close();var addressId=document.getElementById("MS_ShipmentAddress_"+orderItemId).value;var shipModeId=document.getElementById("MS_ShippingMode_"+orderItemId).value;params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";this.updateParamObject(params,"orderItemId",orderItemId,false,-1);this.updateParamObject(params,"requestedShipDate",t,false,-1);params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";params.allocate="***";params.backorder="***";params.remerge="***";params.check="*n";if(!submitRequest()){return}cursor_wait();CheckoutHelperJS.RequestShippingDateAction=true;wc.service.invoke("OrderItemAddressShipMethodUpdate",params)},createAddressForMS:function(orderItemId,addressType){this.saveOrderItemsList(orderItemId,"-1");if(!submitRequest()){return}var checkForOpera=true;cursor_wait(checkForOpera);wc.render.updateContext("editShippingAddressContext",{shippingAddress:"-1",addressType:addressType});this.showHideDivs("editAddressContents","mainContents")},displayAddressDetailsForMSHelper:function(orderItemId,addressType){this.displayAddressDetailsForMS(-1,orderItemId,addressType)},displayAddressDetailsForMS:function(addressSelectBoxValue,orderItemId,addressType){if(this.isAjaxCheckOut()){if(addressSelectBoxValue==-1){this.createAddressForMS(orderItemId,addressType)}}else{if(addressSelectBoxValue==-1){this.createAddressForMS(orderItemId,addressType)}else{dojo.byId("MS_shippingAddressDisplayArea_"+orderItemId).innerHTML=dojo.byId("addressDetails_"+addressSelectBoxValue).innerHTML}}},initDojoEventListenerMultiShipmentPage:function(){var totalItems=document.getElementById("totalNumberOfItems").value;if(totalItems!=null&&totalItems>0){var list_clickable=new dojox.collections.ArrayList([]);var list_editable=new dojox.collections.ArrayList([]);for(var i=0;i<totalItems;i++){var orderItemId=document.getElementById("orderItem_"+(i+1)).value;var object="";if(orderItemId!=null){object=dojo.byId("MS_shippingInstructionsCheckbox_"+orderItemId);if(object!=null){list_clickable.add(object)}object=dojo.byId("MS_requestShippingDateCheckbox_"+orderItemId);if(object!=null){list_clickable.add(object)}object=dojo.byId("shipAsComplete");if(object!=null){list_clickable.add(object)}object=dojo.byId("editAddressButton");if(object!=null){list_clickable.add(object)}object=dojo.byId("MS_expediteShipping_"+orderItemId);if(object!=null){list_clickable.add(object)}object=dojo.byId("MS_ShipmentAddress_"+orderItemId);if(object!=null){list_editable.add(object)}object=dojo.byId("MS_ShippingMode_"+orderItemId);if(object!=null){list_editable.add(object)}object=dojo.byId("MS_shipInstructions_"+orderItemId);if(object!=null){list_editable.add(object)}object=dojo.byId("qty_"+(i+1));if(object!=null){list_editable.add(object)}}else{var j=i+1;console.debug("error: element 'orderItem_'"+j+" was expected but undefined.")}}for(var i=0;i<list_clickable.count;i++){var item=list_clickable.item(i);dojo.connect(item,"onclick",setDirtyFlag)}for(var i=0;i<list_editable.count;i++){var item=list_editable.item(i);dojo.connect(item,"onchange",setDirtyFlag)}}else{console.debug("error: element 'totalNumberOfItems' was expected but undefined.");return}},updateMultiShipmentShoppingCart:function(form){var updateShippingAction="OrderChangeServiceShipInfoUpdate";var updateShippingURL="OrderShippingBillingView?";var totalItems=document.getElementById("totalNumberOfItems").value;for(var i=0;i<totalItems;i++){var orderItemId=document.getElementById("orderItem_"+(i+1)).value;if(document.getElementById("orderItemId_"+(i+1))!=null){document.getElementById("orderItemId_"+(i+1)).value=orderItemId}var addressId=document.getElementById("MS_ShipmentAddress_"+orderItemId).value;if(addressId!=-1){if(document.getElementById("addressId_"+(i+1))!=null){document.getElementById("addressId_"+(i+1)).value=addressId}}else{MessageHelper.formErrorHandleClient(document.getElementById("MS_ShipmentAddress_"+orderItemId).id,MessageHelper.messages.SHIPPING_INVALID_ADDRESS);return}if(form.elements["shipModeId_"+(i+1)]!=null){form.elements["shipModeId_"+(i+1)].value=document.getElementById("MS_ShippingMode_"+orderItemId).value}var instructions=null;var t=null;var shippingInstructionsCheckbox=dojo.byId("MS_shippingInstructionsCheckbox_"+orderItemId);if(shippingInstructionsCheckbox!=null){if(shippingInstructionsCheckbox.checked){if(document.getElementById("MS_shipInstructions_"+orderItemId)!=null&&document.getElementById("MS_shipInstructions_"+orderItemId).value!=null){if(MessageHelper.isValidUTF8length(document.getElementById("MS_shipInstructions_"+orderItemId).value,4000)){instructions=document.getElementById("MS_shipInstructions_"+orderItemId).value}else{MessageHelper.formErrorHandleClient(document.getElementById("MS_shipInstructions_"+orderItemId).id,MessageHelper.messages.ERROR_ShippingInstructions_TooLong);return}}}else{if(document.getElementById("MS_shipInstructions_"+orderItemId)!=null){instructions=""}}}var requestShippingDateCheckbox=dojo.byId("MS_requestShippingDateCheckbox_"+orderItemId);if(requestShippingDateCheckbox!=null){t=this.resetRequestedShipDateValue;var jsDateObj=dijit.byId("MS_requestedShippingDate_"+orderItemId);if(requestShippingDateCheckbox.checked){if(jsDateObj!=null&&jsDateObj.getDisplayedValue()!=null){var now=new Date();if(jsDateObj.compare(jsDateObj.getValue(),now)<=0){if(document.getElementById("MS_requestedShippingDate_"+orderItemId)!=null){MessageHelper.formErrorHandleClient(document.getElementById("MS_requestedShippingDate_"+orderItemId).id,MessageHelper.messages.REQUESTED_SHIPPING_DATE_OUT_OF_RANGE_ERROR)}else{MessageHelper.displayErrorMessage(MessageHelper.messages.REQUESTED_SHIPPING_DATE_OUT_OF_RANGE_ERROR)}return}var t="";if(jsDateObj.getDisplayedValue()!=""){t=dojo.date.stamp.fromISOString(jsDateObj);t.setHours(12);t=dojo.date.stamp.toISOString(t,{selector:"%Y-%m-%dT%H:%m:%S.%SZ",zulu:true,milliseconds:true})}else{if(jsDateObj.getDisplayedValue()==""){t=this.resetRequestedShipDateValue}}}}else{if(jsDateObj!=null){t=this.resetRequestedShipDateValue}}}if(instructions!=null){if(document.getElementById("qty_"+(i+1))!=null&&document.getElementById("qty_"+(i+1)).value!=-1){if(document.getElementById("shipInstructions_"+(i+1))!=null){document.getElementById("shipInstructions_"+(i+1)).value=instructions}}}if(t!=null){if(document.getElementById("qty_"+(i+1))!=null&&document.getElementById("qty_"+(i+1)).value!=-1){if(document.getElementById("requestedShipDate_"+(i+1))!=null){document.getElementById("requestedShipDate_"+(i+1)).value=t}}}if(document.getElementById("MS_expediteShipping_"+orderItemId)!=null&&document.getElementById("isExpedited_"+(i+1))!=null){if(document.getElementById("qty_"+(i+1))!=null&&document.getElementById("qty_"+(i+1)).value!=-1){if(document.getElementById("MS_expediteShipping_"+orderItemId).checked){document.getElementById("isExpedited_"+(i+1)).value="Y"}else{document.getElementById("isExpedited_"+(i+1)).value="N"}}}}var checkBox=document.getElementById("shipAsComplete");if(document.getElementById("ShipAsComplete")!=null){if(checkBox.checked){document.getElementById("ShipAsComplete").value="Y"}else{document.getElementById("ShipAsComplete").value="N"}}updateShippingURL=updateShippingURL+"orderItemId*=";updateShippingURL=updateShippingURL+"&quantity*=";updateShippingURL=updateShippingURL+"&addressId*=";updateShippingURL=updateShippingURL+"&shipModeId*=";updateShippingURL=updateShippingURL+"&shipInstructions*=";updateShippingURL=updateShippingURL+"&requestedShipDate*=";updateShippingURL=updateShippingURL+"&isExpedited*=";updateShippingURL=updateShippingURL+"&ShipAsComplete*=";updateShippingURL=updateShippingURL+"&orderItem*=";updateShippingURL=updateShippingURL+"&MS_ShipmentAddress*=";updateShippingURL=updateShippingURL+"&MS_ShippingMode*=";updateShippingURL=updateShippingURL+"&MS_shippingInstructionsCheckbox*=";updateShippingURL=updateShippingURL+"&MS_shipInstructions*=";updateShippingURL=updateShippingURL+"&MS_requestShippingDateCheckbox*=";updateShippingURL=updateShippingURL+"&MS_requestedShippingDate*=";updateShippingURL=updateShippingURL+"&MS_expediteShipping*=";updateShippingURL=updateShippingURL+"&qty*=";updateShippingURL=updateShippingURL+"&shipAsComplete*=";var beginIndex=wc.render.getContextById("multipleShipmentDetailsContext").properties.beginIndex;if(beginIndex==null||beginIndex==""){beginIndex=0}updateShippingURL=updateShippingURL+"&beginIndex="+beginIndex;form.action=updateShippingAction;form.URL.value=updateShippingURL;if(!submitRequest()){return}form.submit()},showHideEditAddressLink:function(addressSelectBox,orderItemId){var orgAddressList=document.getElementById("shippingOrganizationAddressList");if(orgAddressList){var orgAddressArray=[];orgAddressArray=orgAddressList.value.toString().split(",");for(var i=0;i<orgAddressArray.length;i++){if(dojo.byId("editAddressLink_"+orderItemId)!=null&&dojo.byId("editAddressLink_"+orderItemId)!="undefined"){if(addressSelectBox.value==orgAddressArray[i]){dojo.byId("editAddressLink_"+orderItemId).style.display="none";break}else{dojo.byId("editAddressLink_"+orderItemId).style.display="block"}}}}else{if(dojo.byId("editAddressLink_"+orderItemId)!=null&&dojo.byId("editAddressLink_"+orderItemId)!="undefined"){dojo.byId("editAddressLink_"+orderItemId).style.display="block"}}},showHideEditBillingAddressLink:function(addressSelectBox,orderItemId,paymentAreaNumber){if(addressSelectBox.value=="-2"){dojo.byId("editBillingAddressLink"+paymentAreaNumber+"_"+orderItemId).style.display="none";return}var orgAddressList=document.getElementById("shippingOrganizationAddressList");if(orgAddressList){var orgAddressArray=[];orgAddressArray=orgAddressList.value.toString().split(",");for(var i=0;i<orgAddressArray.length;i++){if(dojo.byId("editBillingAddressLink"+paymentAreaNumber+"_"+orderItemId)!=null&&dojo.byId("editBillingAddressLink"+paymentAreaNumber+"_"+orderItemId)!="undefined"){if(addressSelectBox.value==orgAddressArray[i]){dojo.byId("editBillingAddressLink"+paymentAreaNumber+"_"+orderItemId).style.display="none";break}else{dojo.byId("editBillingAddressLink"+paymentAreaNumber+"_"+orderItemId).style.display="block"}}}}else{if(dojo.byId("editBillingAddressLink"+paymentAreaNumber+"_"+orderItemId)!=null&&dojo.byId("editBillingAddressLink"+paymentAreaNumber+"_"+orderItemId)!="undefined"){dojo.byId("editBillingAddressLink"+paymentAreaNumber+"_"+orderItemId).style.display="none"}}},setOrderId:function(orderId){this.orderId=orderId},getOrderId:function(){return this.orderId},showHideCreateBillingAddressLink:function(addressSelectBox,orderItemId,paymentAreaNumber){if(addressSelectBox.value=="-2"){dojo.byId("createBillingAddressLink"+paymentAreaNumber+"_"+orderItemId).style.display="none";return}var orgAddressList=document.getElementById("shippingOrganizationAddressList");if(orgAddressList){var orgAddressArray=[];orgAddressArray=orgAddressList.value.toString().split(",");for(var i=0;i<orgAddressArray.length;i++){if(dojo.byId("createBillingAddressLink"+paymentAreaNumber+"_"+orderItemId)!=null&&dojo.byId("createBillingAddressLink"+paymentAreaNumber+"_"+orderItemId)!="undefined"){if(addressSelectBox.value==orgAddressArray[i]){dojo.byId("createBillingAddressLink"+paymentAreaNumber+"_"+orderItemId).style.display="none";break}else{dojo.byId("createBillingAddressLink"+paymentAreaNumber+"_"+orderItemId).style.display="block"}}}}else{if(dojo.byId("createBillingAddressLink"+paymentAreaNumber+"_"+orderItemId)!=null&&dojo.byId("createBillingAddressLink"+paymentAreaNumber+"_"+orderItemId)!="undefined"){dojo.byId("createBillingAddressLink"+paymentAreaNumber+"_"+orderItemId).style.display="none"}}}};var order_updated={AjaxAddOrderItem:"AjaxAddOrderItem",AjaxAddOrderItemWithShipingInfo:"AjaxAddOrderItemWithShipingInfo",AjaxDeleteOrderItem:"AjaxDeleteOrderItem",AjaxUpdateOrderItem:"AjaxUpdateOrderItem",AjaxUpdateOrderShippingInfo:"AjaxUpdateOrderShippingInfo",AjaxLogoff:"AjaxLogoff",AjaxSubmitOrder:"AjaxSubmitOrder",AjaxSetPendingOrder:"AjaxSetPendingOrder",AjaxUpdatePendingOrder:"AjaxUpdatePendingOrder",AjaxSingleOrderCancel:"AjaxSingleOrderCancel",AjaxUpdateRewardOption:"AjaxUpdateRewardOption",AjaxOrderItemAdd:"AjaxOrderItemAdd",AjaxInterestItemTransfer:"AjaxInterestItemTransfer",AjaxOrderItemDelete:"AjaxOrderItemDelete",AjaxOrderItemUpdate:"AjaxOrderItemUpdate",AjaxInterestItemAdd:"AjaxInterestItemAdd",AjaxWishlistMultipleItemAddRemove:"AjaxWishlistMultipleItemAddRemove"};var address_updated={AjaxDeleteAddressForPerson:"AjaxDeleteAddressForPerson",AjaxAddAddressForPerson:"AjaxAddAddressForPerson",AjaxUpdateAddressForPerson:"AjaxUpdateAddressForPerson",AjaxAddShippingAndBillingAddressForPersonDuringCheckout:"AjaxAddShippingAndBillingAddressForPersonDuringCheckout"};var user_changed={AjaxLogonService:"AjaxLogonService",AjaxLogoff:"AjaxLogoff"};var wishlist_changed={AjaxInterestItemAdd:"AjaxInterestItemAdd",AjaxInterestItemDelete:"AjaxInterestItemDelete",AjaxLogonService:"AjaxLogonService",AjaxLogoff:"AjaxLogoff",AjaxInterestItemTransfer:"AjaxInterestItemTransfer",AjaxOrderItemAdd:"AjaxOrderItemAdd",AjaxWishlistMultipleItemAddRemove:"AjaxWishlistMultipleItemAddRemove"};var listorders_changed={AjaxOrderCreate:"AjaxOrderCreate",AjaxSingleOrderCancel:"AjaxSingleOrderCancel",AjaxSingleOrderSave:"AjaxSingleOrderSave",AjaxCurrentOrderCalculate:"AjaxCurrentOrderCalculate",AjaxSingleOrderCalculate:"AjaxSingleOrderCalculate",AjaxAddOrderItem:"AjaxAddOrderItem"};var shopcart_updates={AjaxOrderItemAdd:"AjaxOrderItemAdd",AjaxInterestItemTransfer:"AjaxInterestItemTransfer",AjaxOrderItemDelete:"AjaxOrderItemDelete",AjaxOrderItemUpdate:"AjaxOrderItemUpdate",AjaxDeleteOrderItem:"AjaxDeleteOrderItem",AjaxOrderCalculate:"AjaxOrderCalculate"};dojo.require("wc.render.common");CommonContextsJS={langId:"-1",storeId:"",catalogId:"",setCommonParameters:function(langId,storeId,catalogId){this.langId=langId;this.storeId=storeId;this.catalogId=catalogId},setContextProperty:function(contextId,property,value){wc.render.getContextById(contextId).properties[property]=value}};wc.render.declareContext("multipleShipmentDetailsContext",{shipmentDetailsArea:"update"},""),wc.render.declareContext("singleShipmentShipChargeContext",null,""),wc.render.declareContext("multipleShipmentShipChargeContext",null,""),wc.render.declareContext("traditionalShipmentDetailsContext",{shipmentDetailsArea:"update"},""),wc.render.declareContext("currentOrder_Context",null,""),wc.render.declareContext("editShippingAddressContext",{shippingAddress:"0",addressType:"ShippingAndBilling"},"","Main"),wc.render.declareContext("billingAddressDropDownBoxContext",{billingAddress1:"0",billingAddress2:"0",billingAddress3:"0",billingURL1:"",billingURL2:"",billingURL3:"",areaNumber:"0",payment1:"",payment2:"",payment3:"",paymentTCId1:"",paymentTCId2:"",paymentTCId3:""},""),wc.render.declareContext("contextForMainAndAddressDiv",{showArea:"0",hideArea:"0"},""),wc.render.declareContext("shippingAddressDropDownBoxContext",null,""),wc.render.declareContext("MiniShoppingCartContext",null,""),wc.render.declareContext("MiniShopCartDropDownContext",null,""),wc.render.declareContext("RecentlyViewedContext",null,""),wc.render.declareContext("RecentlyViewedDropDownContext",null,""),wc.render.declareContext("MiniWishListContext",null,""),wc.render.declareContext("MiniWishListDropDownContext",null,""),wc.render.declareContext("CategoryDisplay_Context",{pageView:"",beginIndex:""},""),wc.render.declareContext("SubCategoryDisplay_Context",null,""),wc.render.declareContext("WishlistDisplay_Context",null,""),wc.render.declareContext("ShopCartPaginationDisplay_Context",{},""),wc.render.declareContext("PendingOrderPaginationDisplay_Context",{},""),wc.render.declareContext("PendingOrderDisplay_Context",{beginIndex:"0"},""),wc.render.declareContext("OrderItemPaginationDisplay_Context",{beginIndex:"0"},""),wc.render.declareContext("OrderDetailPaginationDisplay_Context",{beginIndex:"0"},""),wc.render.declareContext("MSOrderItemPaginationDisplay_Context",{beginIndex:"0"},""),wc.render.declareContext("CouponDisplay_Context",null,""),wc.render.declareContext("PromotionFreeGifts_Context",null,""),wc.render.declareContext("ListOrdersDisplay_Context",{startNumber:"0"},"");wc.render.declareContext("ScheduledOrdersStatusDisplay_Context",{beginIndex:"0",selectedTab:"Scheduled"},""),wc.render.declareContext("ProcessedOrdersStatusDisplay_Context",{beginIndex:"0",selectedTab:"PreviouslyProcessed"},""),wc.render.declareContext("WaitingForApprovalOrdersStatusDisplay_Context",{beginIndex:"0",selectedTab:"WaitingForApproval"},""),wc.render.declareContext("GiftMessageDisplayContext",{orderItemId:"",hasGiftMsg:"true"},""),wc.render.declareContext("CompareProductDisplayContext",{url:""},""),wc.render.declareContext("AutoSuggest_Context",null,""),wc.render.declareContext("CachedSuggestions_Context",null,"");dojo.require("wc.render.common");CommonControllersDeclarationJS={langId:"-1",storeId:"",catalogId:"",ajaxCheckOut:true,setCommonParameters:function(langId,storeId,catalogId){this.langId=langId;this.storeId=storeId;this.catalogId=catalogId},setControllerURL:function(controllerId,url){wc.render.getRefreshControllerById(controllerId).url=url}};wc.render.declareRefreshController({id:"MiniShoppingCartController",renderContext:wc.render.getContextById("MiniShoppingCartContext"),url:"",formId:"",modelChangedHandler:function(message,widget){var controller=this;var renderContext=this.renderContext;if(message.actionId in order_updated||message.actionId=="AjaxDeleteOrderItemForShippingBillingPage"){var param=[];var serviceTypeAdd=message.serviceType;var actionType=message.action;if(message.actionId=="AjaxAddOrderItem"||message.actionId=="AjaxOrderItemAdd"||(message.actionId=="AjaxWishlistMultipleItemAddRemove"&&actionType=="add")){if(serviceTypeAdd==null){param.addedOrderItemId=message.orderItemId+"";showDropdown=true}if(document.getElementById("wishListChecked")){document.getElementById("wishListChecked").style.display="none";document.getElementById("wishListUnchecked").style.display="block"}}if(serviceTypeAdd!="G"&&actionType!="remove"){widget.refresh(param)}}},postRefreshHandler:function(widget){var controller=this;var renderContext=this.renderContext;destroyDialog();if(showDropdown){showMiniShopCartDropDown("shoppingCartBar","quick_cart_container","orderItemAdded");showDropdown=false}cursor_clear()}}),wc.render.declareRefreshController({id:"MiniWishListController",renderContext:wc.render.getContextById("MiniWishListContext"),url:"",formId:"",modelChangedHandler:function(message,widget){var controller=this;var renderContext=this.renderContext;if(message.actionId in wishlist_changed){var param=[];param.storeId=message.storeId+"";param.catalogId=message.catalogId+"";if(message.actionId=="AjaxInterestItemAdd"||message.actionId=="AjaxInterestItemTransfer"){if(message.catEntryId!=null){param.addedWishListItemId=message.catEntryId+""}if(message.orderItemId!=null){param.orderItemId=message.orderItemId+""}if(message.catEntryIds!=null&&message.catEntryIds!=""){param.addedWishListItemId=message.catEntryIds+""}if(message.configurationId!=null){param.addedConfigId=message.configurationId+""}showDropdown_WL=true;if(document.getElementById("SaveToWishListLink")){document.getElementById("SaveToWishListLink").innerHTML='<p class="prefix_1 left_space_1 check">Saved To WishList</p>'}if(document.getElementById("SaveToWishListLink_"+message.catEntryId)){document.getElementById("SaveToWishListLink"+message.catEntryId).innerHTML='<p class="prefix_1 left_space_1 check">Saved To WishList</p>'}if(document.getElementById("wishListUnchecked")){document.getElementById("wishListUnchecked").style.display="none";document.getElementById("wishListChecked").style.display="block"}}if(message.serviceType==null){widget.refresh(param)}}},postRefreshHandler:function(widget){var controller=this;var renderContext=this.renderContext;destroyWishListDialog();if(showDropdown_WL){showMiniWishListDropDown("placeHolder_miniWishList","quick_wishlist_container","itemAdded");showDropdown_WL=false}cursor_clear()}}),wc.render.declareRefreshController({id:"CategoryDisplay_Controller",renderContext:wc.render.getContextById("CategoryDisplay_Context"),url:"",formId:"",renderContextChangedHandler:function(message,widget){var controller=this;var renderContext=this.renderContext;categoryDisplayJS.contextChanged=true;widget.refresh(renderContext.properties)},postRefreshHandler:function(widget){var controller=this;var renderContext=this.renderContext;if(categoryDisplayJS.contextChanged&&(!categoryDisplayJS.isHistory)){var identifier="&identifier="+(new Date()).getTime();var historyObject=new categoryDisplayJS.HistoryTracker("CategoryDisplay_Widget",controller.url+identifier);dojo.back.addToHistory(historyObject);categoryDisplayJS.contextChanged=false;categoryDisplayJS.isHistory=false}cursor_clear()}}),wc.render.declareRefreshController({id:"SubCategoryDisplay_Controller",renderContext:wc.render.getContextById("SubCategoryDisplay_Context"),url:"",formId:"",renderContextChangedHandler:function(message,widget){var controller=this;var renderContext=this.renderContext;categoryDisplayJS.contextChanged=true;widget.refresh(renderContext.properties)},postRefreshHandler:function(widget){var controller=this;var renderContext=this.renderContext;if(categoryDisplayJS.contextChanged&&(!categoryDisplayJS.isHistory)){var identifier="&identifier="+(new Date()).getTime();var historyObject=new categoryDisplayJS.HistoryTracker("SubCategoryDisplay_Widget",controller.url+identifier);dojo.back.addToHistory(historyObject);categoryDisplayJS.contextChanged=false;categoryDisplayJS.isHistory=false}cursor_clear()}}),wc.render.declareRefreshController({id:"WishlistDisplay_Controller",renderContext:wc.render.getContextById("WishlistDisplay_Context"),url:"",formId:"",modelChangedHandler:function(message,widget){var controller=this;var renderContext=this.renderContext;if(message.actionId=="AjaxAddOrderItem"||message.actionId=="AjaxOrderItemAdd"||message.actionId=="AjaxWishlistMultipleItemAddRemove"){var param=[];param.storeId=message.storeId+"";param.catalogId=message.catalogId+"";widget.refresh(param)}},postRefreshHandler:function(widget){var controller=this;var renderContext=this.renderContext;cursor_clear()}}),wc.render.declareRefreshController({id:"CompareProductDisplayController",renderContext:wc.render.getContextById("CompareProductDisplayContext"),url:"",formId:"",modelChangedHandler:function(message,widget){var controller=this;var renderContext=this.renderContext;if(message.actionId=="AjaxCompareCollectorRemove"||message.actionId=="AjaxInterestItemAdd"||message.actionId=="AjaxOrderItemAdd"||message.actionId=="AjaxAddOrderItem"){widget.refresh(renderContext.properties)}},postRefreshHandler:function(widget){cursor_clear()}}),wc.render.declareRefreshController({id:"ShopCartDisplayController",renderContext:wc.render.getContextById("ShopCartPaginationDisplay_Context"),url:"",formId:"",modelChangedHandler:function(message,widget){var controller=this;var renderContext=this.renderContext;if(message.actionId in shopcart_updates&&message.serviceType!="G"){widget.refresh(renderContext.properties)}},postRefreshHandler:function(widget){console.debug("In Post Refresh handler");cursor_clear()}}),wc.render.declareRefreshController({id:"ShopCartPaginationDisplayController",renderContext:wc.render.getContextById("ShopCartPaginationDisplay_Context"),url:"",formId:"",renderContextChangedHandler:function(message,widget){var controller=this;var renderContext=this.renderContext;if(controller.testForChangedRC(["beginIndex"])){widget.refresh(renderContext.properties)}},postRefreshHandler:function(widget){var controller=this;var renderContext=this.renderContext;cursor_clear();if(!CheckoutHelperJS.isAjaxCheckOut()){CheckoutHelperJS.setFieldDirtyFlag(false);CheckoutHelperJS.initDojoEventListenerShoppingCartPage()}}}),wc.render.declareRefreshController({id:"PendingOrderPaginationDisplayController",renderContext:wc.render.getContextById("PendingOrderPaginationDisplay_Context"),url:"",formId:"",renderContextChangedHandler:function(message,widget){var controller=this;var renderContext=this.renderContext;if(controller.testForChangedRC(["beginIndex"])){widget.refresh(renderContext.properties)}},postRefreshHandler:function(widget){var controller=this;var renderContext=this.renderContext;cursor_clear()}}),wc.render.declareRefreshController({id:"OrderItemPaginationDisplayController",renderContext:wc.render.getContextById("OrderItemPaginationDisplay_Context"),url:"",formId:"",renderContextChangedHandler:function(message,widget){var controller=this;var renderContext=this.renderContext;if(controller.testForChangedRC(["beginIndex"])){widget.refresh(renderContext.properties)}},postRefreshHandler:function(widget){var controller=this;var renderContext=this.renderContext;cursor_clear()}}),wc.render.declareRefreshController({id:"MSOrderItemPaginationDisplayController",renderContext:wc.render.getContextById("MSOrderItemPaginationDisplay_Context"),url:"",formId:"",renderContextChangedHandler:function(message,widget){var controller=this;var renderContext=this.renderContext;if(controller.testForChangedRC(["beginIndex"])){widget.refresh(renderContext.properties)}},postRefreshHandler:function(widget){var controller=this;var renderContext=this.renderContext;cursor_clear()}}),wc.render.declareRefreshController({id:"CouponDisplay_Controller",renderContext:wc.render.getContextById("CouponDisplay_Context"),url:"",formId:"",modelChangedHandler:function(message,widget){var controller=this;var renderContext=this.renderContext;if(message.actionId=="AjaxCouponsAddRemove"){widget.refresh(renderContext.properties)}}}),wc.render.declareRefreshController({id:"PromotionFreeGifts_Controller",renderContext:wc.render.getContextById("PromotionFreeGifts_Context"),url:"",formId:"",modelChangedHandler:function(message,widget){var controller=this;var renderContext=this.renderContext},renderContextChangedHandler:function(message,widget){var controller=this;var renderContext=this.renderContext;widget.refresh(renderContext.properties)},postRefreshHandler:function(widget){var controller=this;var renderContext=this.renderContext;cursor_clear();PromotionChoiceOfFreeGiftsJS.showFreeGiftsDialog()}}),wc.render.declareRefreshController({id:"ListOrdersDisplay_Controller",renderContext:wc.render.getContextById("ListOrdersDisplay_Context"),url:"",formId:"",modelChangedHandler:function(message,widget){var controller=this;var renderContext=this.renderContext;if(message.actionId in listorders_changed){if((message.actionId=="AjaxOrderCreate"||message.actionId=="AjaxSingleOrderCalculate")&&this.renderContext.properties.startNumber!=0){wc.render.updateContext("ListOrdersDisplay_Context",{startNumber:0})}else{widget.refresh(renderContext.properties)}}},renderContextChangedHandler:function(message,widget){var controller=this;var renderContext=this.renderContext;if(controller.testForChangedRC(["startNumber"])){widget.refresh(renderContext.properties)}},postRefreshHandler:function(widget){var controller=this;var renderContext=this.renderContext;if(savedOrdersJS.updateCurrentOrder){savedOrdersJS.initializeCurrentOrder();savedOrdersJS.updateCurrentOrder=false}savedOrdersJS.updateToolbar();savedOrdersJS.checkAllIfNeeded()}}),wc.render.declareRefreshController({id:"PendingOrderDisplayController",renderContext:wc.render.getContextById("PendingOrderPaginationDisplay_Context"),url:"",formId:"",modelChangedHandler:function(message,widget){var controller=this;var renderContext=this.renderContext;if(message.actionId in order_updated){this.currentDesc=document.getElementById("OrderDescription_input").value;widget.refresh(renderContext.properties)}},postRefreshHandler:function(widget){var controller=this;cursor_clear();if(this.currentDesc!=document.getElementById("OldOrderDescription").value){var inputElement=document.getElementById("OrderDescription_input");if(inputElement!=null&&inputElement!="undefined"){inputElement.value=this.currentDesc;dojo.removeClass(inputElement,"savedOrderDetailsInputBorder");dojo.addClass(inputElement,"savedOrderDetailsInputBorderWarning")}}}}),wc.render.declareRefreshController({id:"CompareCollectorController",renderContext:null,url:"",formId:"",modelChangedHandler:function(message,widget){if(message.actionId=="AjaxCompareCollector"){showCompareDropdown=true;var param=[];param.addedCatentryId=message.catentryId+"";widget.refresh(param)}if(message.actionId=="AjaxCompareCollectorRemove"){var param=[];widget.refresh(param)}},postRefreshHandler:function(widget){var controller=this;destroyCompareDialog();if(showCompareDropdown){showMiniCompareDropDown("compareBar","quick_compare_container","compareItemAdded");showCompareDropdown=false}cursor_clear()}}),wc.render.declareRefreshController({id:"AjaxCheckoutWalletController",renderContext:null,url:"CheckoutWalletContainer",formId:"",modelChangedHandler:function(message,widget){if(message.actionId=="AjaxCheckoutWallet"){var params=[];widget.refresh(params)}},postRefreshHandler:function(widget){var controller=this;destroyDialog()}}),wc.render.declareRefreshController({id:"GiftMessageDisplayAreaController",renderContext:wc.render.getContextById("GiftMessageDisplayContext"),url:"",formId:"",gwpLink:false,modelChangedHandler:function(message,widget){var controller=this;var renderContext=this.renderContext;var orderItemId=renderContext.properties.orderItemId;var objectId=widget.objectId;var params=[];params.orderItemId=objectId;if(orderItemId==objectId){if(message.serviceType=="G"&&(message.actionId=="AjaxOrderItemAdd"||message.actionId=="AjaxOrderItemUpdate")){params.hasGiftMsg=true;gwpLink=true;widget.refresh(params)}}},postRefreshHandler:function(widget){var controller=this;var renderContext=this.renderContext;var objectId=widget.objectId;var edit_remove=document.getElementById("giftWrap_edit_remove_link_"+objectId);if(gwpLink){edit_remove.innerHTML="Edit/Remove"}else{edit_remove.innerHTML=""}cursor_clear()}}),wc.render.declareRefreshController({id:"AjaxCheckoutShipToStoreController",renderContext:null,url:"CheckoutShipToStoreContainer",formId:"",modelChangedHandler:function(message,widget){if(message.actionId=="AjaxCheckoutShipToStore"){var params=[];widget.refresh(params)}},postRefreshHandler:function(widget){var controller=this;destroyDialog()}}),wc.render.declareRefreshController({id:"AutoSuggestDisplayController",renderContext:wc.render.getContextById("AutoSuggest_Context"),url:"",formId:"",renderContextChangedHandler:function(message,widget){var controller=this;var renderContext=this.renderContext;widget.refresh(renderContext.properties)},postRefreshHandler:function(widget){var controller=this;var renderContext=this.renderContext;var response=document.getElementById("suggestedKeywordResults");if(response==null){document.getElementById("autoSuggestDynamic_Result_div").innerHTML=""}showAutoSuggestIfResults()}}),wc.render.declareRefreshController({id:"AutoSuggestCachedSuggestionsController",renderContext:wc.render.getContextById("CachedSuggestions_Context"),url:"",formId:"",renderContextChangedHandler:function(message,widget){var controller=this;var renderContext=this.renderContext;widget.refresh(renderContext.properties)},postRefreshHandler:function(widget){var controller=this;var renderContext=this.renderContext;var response=document.getElementById("cachedSuggestions");if(response==null){document.getElementById("autoSuggestCachedSuggestions_div").innerHTML=""}else{var scripts=response.getElementsByTagName("script");var j=scripts.length;for(var i=0;i<j;i++){var newScript=document.createElement("script");newScript.type="text/javascript";newScript.text=scripts[i].text;document.getElementById("autoSuggestCachedSuggestions_div").appendChild(newScript)}retrievedCachedSuggestions=true;var searchTerm=document.getElementById("SimpleSearchForm_SearchTerm").value;if(searchTerm.length>AUTOSUGGEST_THRESHOLD){doStaticAutoSuggest(searchTerm)}}}});dojo.require("wc.service.common");ServicesDeclarationJS={langId:"-1",storeId:"",catalogId:"",setCommonParameters:function(langId,storeId,catalogId){this.langId=langId;this.storeId=storeId;this.catalogId=catalogId}};wc.service.declare({id:"AjaxInterestItemAddAndDeleteFromCart",actionId:"AjaxInterestItemAddAndDeleteFromCart",url:getAbsoluteURL()+"AjaxInterestItemAdd",formId:"",successHandler:function(serviceResponse){MessageHelper.hideAndClearMessage();requestSubmitted=false;CheckoutHelperJS.deleteFromCart(serviceResponse.orderItemId,true);MessageHelper.displayStatusMessage(MessageHelper.messages.WISHLIST_ADDED)},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxAddOrderItem",actionId:"AjaxAddOrderItem",url:getAbsoluteURL()+"AjaxOrderChangeServiceItemAdd",formId:"",successHandler:function(serviceResponse){console.debug("success")},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){if(serviceResponse.errorMessageKey=="_ERR_NO_ELIGIBLE_TRADING"){MessageHelper.displayErrorMessage(MessageHelper.messages.ERROR_CONTRACT_EXPIRED_GOTO_ORDER)}else{if(serviceResponse.errorMessageKey=="_ERR_RETRIEVE_PRICE"){MessageHelper.displayErrorMessage(MessageHelper.messages.ERROR_RETRIEVE_PRICE)}else{MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}}}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxOrderItemAdd",actionId:"AjaxOrderItemAdd",url:getAbsoluteURL()+"AjaxOrderItemAdd",formId:"",successHandler:function(serviceResponse){var storeCookie=dojo.cookie("STORENUMBER"+serviceResponse.storeId);if(storeCookie!=undefined){var params=[];params.storeId=serviceResponse.storeId;params.catalogId=serviceResponse.catalogId;params.langId=serviceResponse.langId;params.URL="";params.orderId=serviceResponse.orderId;params.calculationUsageId="-1";wc.service.invoke("AjaxOrderCalculate1",params)}},failureHandler:function(serviceResponse){console.debug("AjaxOrderItemAdd failure");if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxWishlistMultipleItemAddRemove",actionId:"AjaxWishlistMultipleItemAddRemove",url:getAbsoluteURL()+"AjaxWishlistMultipleItemAddRemove",formId:"",successHandler:function(serviceResponse){console.debug("AjaxWishlistMultipleItemAddRemove success")},failureHandler:function(serviceResponse){console.debug("AjaxWishlistMultipleItemAddRemove failure");if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxOrderItemDelete",actionId:"AjaxOrderItemDelete",url:getAbsoluteURL()+"AjaxOrderItemDelete",formId:"",successHandler:function(serviceResponse){console.debug("AjaxOrderItemDelete success")},failureHandler:function(serviceResponse){console.debug("AjaxOrderItemDelete failure");cursor_clear()}}),wc.service.declare({id:"AjaxOrderItemUpdate",actionId:"AjaxOrderItemUpdate",url:getAbsoluteURL()+"AjaxOrderItemUpdate",formId:"",successHandler:function(serviceResponse){console.debug("AjaxOrderItemUpdate success")},failureHandler:function(serviceResponse){console.debug("AjaxOrderItemUpdate failure");cursor_clear()}}),wc.service.declare({id:"AjaxUpdateShippingTaxEstimate",actionId:"AjaxUpdateShippingTaxEstimate",url:getAbsoluteURL()+"AjaxEstimateSalesTax",formId:"",successHandler:function(serviceResponse){console.debug("AjaxOrderItemUpdate success");var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=serviceResponse.orderId;params.orderCalculate="1";params.calculationUsage="-1";wc.service.invoke("AjaxOrderItemUpdate",params)},failureHandler:function(serviceResponse){console.debug("AjaxOrderItemUpdate failure");if(serviceResponse.errorMessageKey=="_INVALID_ZIP_CODE"){MessageHelper.displayErrorMessage("Error: Please enter valid zip code.");document.getElementById("zipcode").className="checkout-billing-input-error"}else{if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}}cursor_clear()}}),wc.service.declare({id:"AjaxAddOrderItem_shopCart",actionId:"AjaxAddOrderItem",url:getAbsoluteURL()+"AjaxOrderChangeServiceItemAdd",formId:"",successHandler:function(serviceResponse){document.location.href="AjaxOrderItemDisplayView?storeId="+ServicesDeclarationJS.storeId+"&catalogId="+ServicesDeclarationJS.catalogId+"&langId="+ServicesDeclarationJS.langId},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){if(serviceResponse.errorMessageKey=="_ERR_NO_ELIGIBLE_TRADING"){MessageHelper.displayErrorMessage(MessageHelper.messages.ERROR_CONTRACT_EXPIRED_GOTO_ORDER)}else{if(serviceResponse.errorMessageKey=="_ERR_RETRIEVE_PRICE"){MessageHelper.displayErrorMessage(MessageHelper.messages.ERROR_RETRIEVE_PRICE)}else{MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}}}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxDeleteOrderItem",actionId:"AjaxDeleteOrderItem",url:getAbsoluteURL()+"AjaxOrderChangeServiceItemDelete",formId:"",successHandler:function(serviceResponse){MessageHelper.hideAndClearMessage();MessageHelper.displayStatusMessage(MessageHelper.messages.SHOPCART_REMOVEITEM)},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxDeleteOrderItemForShippingBillingPage",actionId:"AjaxDeleteOrderItemForShippingBillingPage",url:getAbsoluteURL()+"AjaxOrderChangeServiceItemDelete",formId:"",successHandler:function(serviceResponse){MessageHelper.hideAndClearMessage();MessageHelper.displayStatusMessage(MessageHelper.messages.SHOPCART_REMOVEITEM)},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxDeleteOrderItemFromCart",actionId:"AjaxDeleteOrderItem",url:getAbsoluteURL()+"AjaxOrderChangeServiceItemDelete",formId:"",failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxDeleteOrderItem1",actionId:"AjaxDeleteOrderItem",url:getAbsoluteURL()+"AjaxOrderChangeServiceItemDelete",formId:"",successHandler:function(serviceResponse){if(!CheckoutHelperJS.pendingOrderDetailsPage){if(CheckoutHelperJS.shoppingCartPage){cursor_clear()}else{document.location.href="OrderShippingBillingView?storeId="+ServicesDeclarationJS.storeId+"&catalogId="+ServicesDeclarationJS.catalogId+"&langId="+ServicesDeclarationJS.langId+"&orderId="+serviceResponse.orderId}}else{cursor_clear()}},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxUpdateOrderItem",actionId:"AjaxUpdateOrderItem",url:getAbsoluteURL()+"AjaxOrderChangeServiceItemUpdate",formId:"",successHandler:function(serviceResponse){MessageHelper.hideAndClearMessage();var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.URL="";params.updatePrices="1";params.orderId=serviceResponse.orderId;params.calculationUsageId="-1";wc.service.invoke("AjaxOrderCalculate",params);cursor_clear()},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){if(serviceResponse.errorMessageKey=="_ERR_RETRIEVE_PRICE"){MessageHelper.displayErrorMessage(MessageHelper.messages.ERROR_RETRIEVE_PRICE_QTY_UPDATE)}else{MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxUpdateOrderShippingInfo",actionId:"AjaxUpdateOrderShippingInfo",url:getAbsoluteURL()+"AjaxOrderChangeServiceShipInfoUpdate",formId:"",successHandler:function(serviceResponse){MessageHelper.hideAndClearMessage();cursor_clear()},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxSubmitOrder",actionId:"AjaxSubmitOrder",url:getAbsoluteURL()+"AjaxOrderProcessServiceOrderSubmit",formId:"",successHandler:function(serviceResponse){var shipmentTypeId=CheckoutHelperJS.getShipmentTypeId();document.location.href="OrderShippingBillingConfirmationView?storeId="+ServicesDeclarationJS.storeId+"&catalogId="+ServicesDeclarationJS.catalogId+"&langId="+ServicesDeclarationJS.langId+"&orderId="+serviceResponse.orderId+"&shipmentTypeId="+shipmentTypeId},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxSubmitQuote",actionId:"AjaxSubmitQuote",url:getAbsoluteURL()+"AjaxSubmitQuote",formId:"",successHandler:function(serviceResponse){var redirectURL="OrderShippingBillingConfirmationView?storeId="+ServicesDeclarationJS.storeId+"&catalogId="+ServicesDeclarationJS.catalogId+"&langId="+ServicesDeclarationJS.langId+"&orderId="+CheckoutHelperJS.getOrderId()+"&shipmentTypeId="+CheckoutHelperJS.getShipmentTypeId()+"&isQuote=true&quoteId="+serviceResponse.outOrderId;if(serviceResponse.outExternalQuoteId!=undefined&&serviceResponse.outExternalQuoteId!=null){redirectURL+=redirectURL+"&externalQuoteId="+serviceResponse.outExternalQuoteId}document.location.href=redirectURL},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxAddAddressForPerson",actionId:"AjaxAddAddressForPerson",url:getAbsoluteURL()+"AjaxPersonChangeServiceAddressAdd",formId:"",successHandler:function(serviceResponse){AddressHelper.updateOrderAfterAddressUpdate();MessageHelper.hideAndClearMessage();cursor_clear()},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxUpdateAddressForPerson",actionId:"AjaxUpdateAddressForPerson",url:getAbsoluteURL()+"AjaxPersonChangeServiceAddressUpdate",formId:"",successHandler:function(serviceResponse){AddressHelper.updateOrderAfterAddressUpdate();MessageHelper.hideAndClearMessage();cursor_clear()},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxUpdateOrderAfterAddressUpdate",actionId:"AjaxUpdateOrderAfterAddressUpdate",url:getAbsoluteURL()+"AjaxOrderChangeServiceItemUpdate",formId:"",successHandler:function(serviceResponse){MessageHelper.hideAndClearMessage();cursor_clear()},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxInterestItemAdd",actionId:"AjaxInterestItemAdd",url:getAbsoluteURL()+"AjaxInterestItemAdd",formId:"",successHandler:function(serviceResponse){console.debug(serviceResponse);if(serviceResponse.invalidMove=="Y"){console.debug("Invalid move of an item in service call response.");cursor_clear()}},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxInterestItemTransfer",actionId:"AjaxInterestItemTransfer",url:getAbsoluteURL()+"AjaxInterestItemTransfer",formId:"",successHandler:function(serviceResponse){},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}}}),wc.service.declare({id:"AjaxInterestItemAdd_shopCart",actionId:"AjaxInterestItemAdd",url:getAbsoluteURL()+"AjaxInterestItemAdd",formId:"",successHandler:function(serviceResponse){document.location.href="AjaxOrderItemDisplayView?storeId="+ServicesDeclarationJS.storeId+"&catalogId="+ServicesDeclarationJS.catalogId+"&langId="+ServicesDeclarationJS.langId},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxInterestItemDelete",actionId:"AjaxInterestItemDelete",url:getAbsoluteURL()+"AjaxInterestItemDelete",formId:"",successHandler:function(serviceResponse){MessageHelper.hideAndClearMessage()},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxInterestItemListMessage",actionId:"AjaxInterestItemListMessage",url:getAbsoluteURL()+"AjaxInterestItemListMessage",formId:"",successHandler:function(serviceResponse){MessageHelper.hideAndClearMessage()},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxPromotionCodeManage",actionId:"AjaxPromotionCodeManage",url:getAbsoluteURL()+"AjaxPromotionCodeManage",formId:"",successHandler:function(serviceResponse){MessageHelper.hideAndClearMessage();var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";wc.service.invoke("AjaxUpdateOrderItem",params)},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxCouponsAddRemove",actionId:"AjaxCouponsAddRemove",url:getAbsoluteURL()+"AjaxCouponsAddRemove",formId:"",successHandler:function(serviceResponse){MessageHelper.hideAndClearMessage();var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=serviceResponse.orderId;params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";wc.service.invoke("AjaxUpdateOrderItem",params)},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AddBillingAddress",actionId:"AddBillingAddress",url:getAbsoluteURL()+"AjaxPersonChangeServiceAddressAdd",formId:"",successHandler:function(serviceResponse){MessageHelper.hideAndClearMessage()},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"ScheduleOrder",actionId:"ScheduleOrder",url:getAbsoluteURL()+"AjaxOrderProcessServiceOrderSchedule",formId:"",successHandler:function(serviceResponse){MessageHelper.hideAndClearMessage();var originalOrderId=document.getElementById("orderIdToSchedule").value;var newOrderId=serviceResponse.orderId;var shipmentTypeId=CheckoutHelperJS.getShipmentTypeId();var purchaseOrderNumber="";if(document.forms.purchaseOrderNumberInfo.purchase_order_number.value!=null){purchaseOrderNumber=document.forms.purchaseOrderNumberInfo.purchase_order_number.value}var url="OrderProcessServiceOrderCancel?orderId="+originalOrderId+"&storeId="+ServicesDeclarationJS.storeId+"&catalogId="+ServicesDeclarationJS.catalogId+"&langId="+ServicesDeclarationJS.langId+"&URL=OrderShippingBillingConfirmationView%3ForderId%3D"+newOrderId+"%26originalOrderId%3D"+originalOrderId+"%26shipmentTypeId%3D"+shipmentTypeId+"%26purchaseOrderNumber%3D"+purchaseOrderNumber;document.location.href=url},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxUpdateRewardOption",actionId:"AjaxUpdateRewardOption",url:getAbsoluteURL()+"AjaxOrderChangeServiceRewardOptionUpdate",formId:"",successHandler:function(serviceResponse){MessageHelper.hideAndClearMessage();cursor_clear()},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxOrderCreate",actionId:"AjaxOrderCreate",url:getAbsoluteURL()+"AjaxOrderCreate",formId:"",successHandler:function(serviceResponse){MessageHelper.hideAndClearMessage();MessageHelper.displayStatusMessage(MessageHelper.messages.ORDER_CREATED);cursor_clear()},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){if(serviceResponse.errorCode=="CMN0409E"){MessageHelper.displayErrorMessage(MessageHelper.messages.ORDER_NOT_CREATED)}else{MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxSingleOrderCancel",actionId:"AjaxSingleOrderCancel",url:getAbsoluteURL()+"AjaxOrderProcessServiceOrderCancel",formId:"",successHandler:function(serviceResponse){MessageHelper.hideAndClearMessage();MessageHelper.displayStatusMessage(MessageHelper.messages.ORDERS_CANCELLED);cursor_clear()},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){if(serviceResponse.errorCode=="CMN0409E"){MessageHelper.displayErrorMessage(MessageHelper.messages.ORDER_NOT_CANCELLED)}else{MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxOrderCancel",actionId:"AjaxOrderCancel",url:getAbsoluteURL()+"AjaxOrderProcessServiceOrderCancel",formId:"",successHandler:function(serviceResponse){savedOrdersJS.cancelSavedOrder(false)},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){if(serviceResponse.errorCode=="CMN0409E"){MessageHelper.displayErrorMessage(MessageHelper.messages.ORDER_NOT_CANCELLED)}else{MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxSingleOrderSave",actionId:"AjaxSingleOrderSave",url:getAbsoluteURL()+"AjaxOrderCopy",formId:"",successHandler:function(serviceResponse){MessageHelper.hideAndClearMessage();if(savedOrdersJS.isOrderDetailsPageValue){MessageHelper.displayStatusMessage(MessageHelper.messages.PENDING_ORDER_SAVED)}else{MessageHelper.displayStatusMessage(MessageHelper.messages.ORDERS_SAVED)}var inputElement=document.getElementById("OrderDescription_input");if(inputElement!=null&&inputElement!="undefined"){dojo.removeClass(inputElement,"savedOrderDetailsInputBorderWarning");dojo.addClass(inputElement,"savedOrderDetailsInputBorder");document.getElementById("OldOrderDescription").value=inputElement.value}cursor_clear();if(savedOrdersJS.updateCartRequired){savedOrdersJS.updateCartRequired=false;CheckoutHelperJS.updateShoppingCart(document.ShopCartForm)}},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){if(serviceResponse.errorCode=="CMN0409E"||serviceResponse.errorCode=="CMN1024E"){if(serviceResponse.errorCode=="CMN1024E"&&serviceResponse.systemMessage!=""){MessageHelper.displayErrorMessage(serviceResponse.systemMessage)}else{if(savedOrdersJS.isOrderDetailsPageValue){MessageHelper.displayStatusMessage(MessageHelper.messages.PENDING_ORDER_NOT_SAVED)}else{MessageHelper.displayErrorMessage(MessageHelper.messages.ORDER_NOT_SAVED)}}}else{MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxOrderSave",actionId:"AjaxOrderSave",url:getAbsoluteURL()+"AjaxOrderCopy",formId:"",successHandler:function(serviceResponse){savedOrdersJS.saveOrder(false)},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){if(serviceResponse.errorCode=="CMN0409E"){MessageHelper.displayErrorMessage(MessageHelper.messages.ORDER_NOT_SAVED)}else{MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxSetPendingOrder",actionId:"AjaxSetPendingOrder",url:getAbsoluteURL()+"AjaxSetPendingOrder",formId:"",successHandler:function(serviceResponse){MessageHelper.hideAndClearMessage();MessageHelper.displayStatusMessage(MessageHelper.messages.ORDER_SET_CURRENT);savedOrdersJS.determinePageForward("AjaxSetPendingOrder");cursor_clear()},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){if(serviceResponse.errorCode=="CMN0409E"||serviceResponse.errorCode=="CMN1024E"){MessageHelper.displayErrorMessage(MessageHelper.messages.ORDER_NOT_SET_CURRENT)}else{MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxUpdatePendingOrder",actionId:"AjaxUpdatePendingOrder",url:getAbsoluteURL()+"AjaxSetPendingOrder",formId:"",successHandler:function(serviceResponse){savedOrdersJS.determinePageForward("AjaxUpdatePendingOrder");cursor_clear()},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){if(serviceResponse.errorCode=="CMN0409E"){MessageHelper.displayErrorMessage(MessageHelper.messages.ORDER_NOT_SET_CURRENT)}else{MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxSingleOrderCopy",actionId:"AjaxSingleOrderCopy",url:getAbsoluteURL()+"AjaxOrderCopy",formId:"",successHandler:function(serviceResponse){var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.URL="";params.updatePrices="1";params.orderId=serviceResponse.orderId;params.calculationUsageId="-1";wc.service.invoke("AjaxSingleOrderCalculate",params);MessageHelper.hideAndClearMessage()},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){if(serviceResponse.errorCode=="CMN0409E"){MessageHelper.displayErrorMessage(MessageHelper.messages.ORDER_NOT_COPIED)}else{MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxOrderCopy",actionId:"AjaxOrderCopy",url:getAbsoluteURL()+"AjaxOrderCopy",formId:"",successHandler:function(serviceResponse){var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.URL="";params.updatePrices="1";params.orderId=serviceResponse.orderId;params.calculationUsageId="-1";wc.service.invoke("AjaxOrderCalculate",params);MessageHelper.hideAndClearMessage()},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){if(serviceResponse.errorCode=="CMN0409E"){MessageHelper.displayErrorMessage(MessageHelper.messages.ORDER_NOT_COPIED)}else{MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxSingleOrderCalculate",actionId:"AjaxSingleOrderCalculate",url:getAbsoluteURL()+"AjaxOrderCalculate",formId:"",successHandler:function(serviceResponse){MessageHelper.hideAndClearMessage();MessageHelper.displayStatusMessage(MessageHelper.messages.ORDER_COPIED);cursor_clear()},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){if(serviceResponse.errorCode=="CMN0409E"){MessageHelper.displayErrorMessage(MessageHelper.messages.ORDER_NOT_COPIED)}else{MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxCurrentOrderCalculate",actionId:"AjaxCurrentOrderCalculate",url:getAbsoluteURL()+"AjaxOrderCalculate",formId:"",successHandler:function(serviceResponse){MessageHelper.hideAndClearMessage();MessageHelper.displayStatusMessage(MessageHelper.messages.ORDER_SET_CURRENT);cursor_clear()},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){if(serviceResponse.errorCode=="CMN0409E"){MessageHelper.displayErrorMessage(MessageHelper.messages.ORDER_NOT_COPIED)}else{MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxOrderCalculate1",actionId:"AjaxOrderCalculate1",url:getAbsoluteURL()+"AjaxOrderCalculate",formId:"",successHandler:function(serviceResponse){},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){if(serviceResponse.errorCode=="CMN0409E"){MessageHelper.displayErrorMessage(MessageHelper.messages.ORDER_NOT_COPIED)}else{MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}}),wc.service.declare({id:"AjaxOrderCalculate",actionId:"AjaxOrderCalculate",url:getAbsoluteURL()+"AjaxOrderCalculate",formId:"",successHandler:function(serviceResponse){},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){if(serviceResponse.errorCode=="CMN0409E"){MessageHelper.displayErrorMessage(MessageHelper.messages.ORDER_NOT_COPIED)}else{MessageHelper.displayErrorMessage(serviceResponse.errorMessage)}}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey)}}cursor_clear()}});dojo.registerModulePath("wc","../wc");dojo.require("wc.service.common");dojo.require("dojo.io.iframe");dojo.require("dojo.io.script");dojo.require("dojo.parser");dojo.require("dijit.form.Button");dojo.require("wc.widget.WCMenu");dojo.require("wc.widget.WCDialog");dojo.require("wc.widget.ScrollablePane");dojo.require("dijit.layout.TabContainer");dojo.require("dijit.layout.ContentPane");dojo.require("dijit.Tooltip");dojo.require("wc.widget.WCDropDownButton");dojo.require("dijit.Dialog");dojo.require("dojo.dnd.Source");dojo.require("dojo.currency");dojo.require("dijit.Tree");dojo.require("dojo.back");dojo.require("dijit.form.DateTextBox");dojo.require("wc.widget.RefreshArea");dojo.require("wc.render.RefreshController");dojo.require("wc.render.Context");dojo.require("dojo.cookie");var showDropdown=false;var showDropdown_RV=false;var showDropdown_WL=false;var dropDownDlg=null;var dropDownDlg_RV=null;var dropDownDlg_WL=null;var isIE=(document.all)?true:false;var correctBrowser=false;var requestSubmitted=true;var currentId="";var autoSuggestTimer=-1;var autoSuggestKeystrokeDelay=250;var autoSuggestHover=false;var autoSuggestPreviousTerm="";var autoSuggestURL="";var autoSelectOption=-1;var historyIndex=-1;var retrievedCachedSuggestions=false;var TOTAL_SUGGESTED=4;var TOTAL_HISTORY=2;var AUTOSUGGEST_THRESHOLD=1;var DYNAMIC_AUTOSUGGEST_THRESHOLD=2;var CACHED_AUTOSUGGEST_OFFSET=1000;function focusSetter(){if(dojo.byId("MiniCartFocusReceiver1")){dojo.byId("MiniCartFocusReceiver1").focus()}else{if(dojo.byId("RecentlyViewedFocusReceiver1")){dojo.byId("RecentlyViewedFocusReceiver1").focus()}else{if(dojo.byId("MiniWishListFocusReceiver1")){dojo.byId("MiniWishListFocusReceiver1").focus()}else{if(dojo.byId("MiniWishListFocusReceiver2")){dojo.byId("MiniWishListFocusReceiver2").focus()}else{if(dojo.byId("MiniCartFocusReceiver2")){dojo.byId("MiniCartFocusReceiver2").focus()}}}}}}function determineFocus(event){if(event.shiftKey&&event.keyCode==dojo.keys.TAB){if(event.srcElement){if(event.srcElement.id=="MiniCartFocusReceiver1"){if(dojo.byId("WC_MiniShopCartDisplay_link_5")){dojo.byId("WC_MiniShopCartDisplay_link_5").focus()}dojo.stopEvent(event)}else{if(event.srcElement.id=="MiniCartFocusReceiver2"){dojo.byId("MiniCartFocusReceiver2").focus();dojo.stopEvent(event)}else{if(event.srcElement.id=="MiniWishListFocusReceiver1"){if(dojo.byId("WC_MiniWishListDisplay_link_5")){dojo.byId("WC_MiniWishListDisplay_link_5").focus()}dojo.stopEvent(event)}else{if(event.srcElement.id=="MiniWishListFocusReceiver2"){dojo.byId("MiniWishListFocusReceiver2").focus();dojo.stopEvent(event)}}}}if(event.srcElement.id=="RecentlyViewedFocusReceiver1"){if(dojo.byId("WC_MiniShopCartDisplay_link_5")){dojo.byId("WC_MiniShopCartDisplay_link_5").focus()}dojo.stopEvent(event)}else{if(event.srcElement.id=="RecentlyViewedFocusReceiver2"){dojo.byId("RecentlyViewedFocusReceiver2").focus();dojo.stopEvent(event)}}}else{if(event.target.id=="MiniCartFocusReceiver1"){if(dojo.byId("WC_MiniShopCartDisplay_link_5")){dojo.byId("WC_MiniShopCartDisplay_link_5").focus()}dojo.stopEvent(event)}else{if(event.target.id=="MiniCartFocusReceiver2"){dojo.byId("MiniCartFocusReceiver2").focus();dojo.stopEvent(event)}else{if(event.target.id=="MiniWishListFocusReceiver1"){if(dojo.byId("WC_MiniWishListDisplay_link_5")){dojo.byId("WC_MiniWishListDisplay_link_5").focus()}dojo.stopEvent(event)}else{if(event.target.id=="MiniWishListFocusReceiver2"){dojo.byId("MiniWishListFocusReceiver2").focus();dojo.stopEvent(event)}}}}}}}function destroyDialog(){dojo.query(".dijitDialog",document).forEach(function(tag){if(dijit.byNode(tag).id=="quick_cart_container"){dijit.byNode(tag).destroyRecursive()}});dropDownDlg=null}function destroyWishListDialog(){dojo.query(".dijitDialog",document).forEach(function(tag){if(dijit.byNode(tag).id=="quick_wishlist_container"){dijit.byNode(tag).destroyRecursive()}});dropDownDlg_WL=null}function showMiniShopCartDropDown1(event,relativeId,contentId,contentType){console.debug(event.keyCode);if(event.keyCode==dojo.keys.DOWN_ARROW){showMiniShopCartDropDown(relativeId,contentId,contentType)}else{if(event.shiftKey&&event.keyCode==dojo.keys.ENTER){showMiniShopCartDropDown(relativeId,contentId,contentType);dojo.stopEvent(event)}}}function showMiniShopCartDropDown(relativeId,contentId,contentType){var t=dojo.byId(relativeId);var c=dojo.coords(t,true);var x1=c.x;var y1=menuHeight;var cartWidth=dojo.coords(dojo.byId("miniShopCartBody"),true).w;dojo.style(dojo.byId("quick_cart"),"width","311px");var dlgX=x1+cartWidth-adjustedMenuWidth;if(dojo.locale=="iw-il"&&dojo.isIE<7){dlgX=dojo.coords(dojo.byId("miniShopCartLeftCorner")).x}else{dlgX=x1-adjustedMenuWidth+cartWidth}if(dojo.isIE){dlgX-=11}if(dropDownDlg){dropDownDlg.y=y1;dropDownDlg.x=dlgX}if(!dropDownDlg){var pane=document.getElementById(contentId);dropDownDlg=new wc.widget.WCDialog({relatedSource:relativeId,x:x1,y:y1},pane);dropDownDlg.x=dlgX}if(dojo.isOpera!=0&&dojo.isOpera!=null){dropDownDlg.x=dropDownDlg.x+window.pageXOffset;dropDownDlg.y=dropDownDlg.y+window.pageYOffset}if(contentType=="orderItemsList"){dojo.byId("MiniShopCartProductsList").style.display="block";dojo.byId("MiniShopCartProductAdded").style.display="none";dropDownDlg.closeOnTimeOut=false;dropDownDlg.show()}else{if(contentType=="orderItemAdded"){dojo.byId("MiniShopCartProductsList").style.display="none";dojo.byId("MiniShopCartProductAdded").style.display="block";setTimeout(dojo.hitch(dropDownDlg,"show",null),5);setTimeout(dojo.hitch(this,"hideUnderlayWrapper",""),5)}}if(dojo.isIE<7){document.getElementById("quick_cart_container").style.display="block"}readyMenuToggle("MiniShoppingCart",dropDownDlg,"cart-modal")}function showMiniWishListDropDown1(event,relativeId,contentId,contentType){console.debug(event.keyCode);if(event.keyCode==dojo.keys.DOWN_ARROW){showMiniWishListDropDown(relativeId,contentId,contentType)}else{if(event.shiftKey&&event.keyCode==dojo.keys.ENTER){showMiniWishListDropDown(relativeId,contentId,contentType);dojo.stopEvent(event)}}}function showMiniWishListDropDown(relativeId,contentId,contentType){var t=dojo.byId(relativeId);var c=dojo.coords(t,true);var x1=c.x;var y1=menuHeight;var cartWidth=dojo.coords(dojo.byId("miniWishListBody"),true).w;dojo.style(dojo.byId("quick_wishlist"),"width","311px");var dlgX=x1-adjustedMenuWidth+cartWidth;if(dojo.locale=="iw-il"&&dojo.isIE<7){dlgX=dojo.coords(dojo.byId("miniShopCartLeftCorner")).x}else{dlgX=x1-adjustedMenuWidth+cartWidth}if(dojo.isIE){dlgX-=11}if(dropDownDlg_WL){dropDownDlg_WL.y=y1;dropDownDlg_WL.x=dlgX}if(!dropDownDlg_WL){var pane=document.getElementById(contentId);dropDownDlg_WL=new wc.widget.WCDialog({relatedSource:relativeId,x:x1,y:y1},pane);dropDownDlg_WL.x=dlgX}if(dojo.isOpera!=0&&dojo.isOpera!=null){dropDownDlg_WL.x=dropDownDlg_WL.x+window.pageXOffset;dropDownDlg_WL.y=dropDownDlg_WL.y+window.pageYOffset}if(contentType=="itemsList"){if(dojo.byId("MiniWishListProductsList")!=undefined){dojo.byId("MiniWishListProductsList").style.display="block";dojo.byId("MiniWishListProductAdded").style.display="none";dropDownDlg_WL.closeOnTimeOut=false;dropDownDlg_WL.show()}}else{if(contentType=="itemAdded"){dojo.byId("MiniWishListProductsList").style.display="none";dojo.byId("MiniWishListProductAdded").style.display="block";setTimeout(dojo.hitch(dropDownDlg_WL,"show",null),5);setTimeout(dojo.hitch(this,"hideUnderlayWrapper",""),5)}}if(dojo.isIE<7){document.getElementById("quick_wishlist_container").style.display="block"}readyMenuToggle("MiniWishList",dropDownDlg_WL,"wishlist-modal")}function showRecentlyViewedDropDown1(event,relativeId,contentId,contentType){console.debug(event.keyCode);if(event.keyCode==dojo.keys.DOWN_ARROW){showRecentlyViewedDropDown(relativeId,contentId,contentType)}else{if(event.shiftKey&&event.keyCode==dojo.keys.ENTER){showRecentlyViewedDropDown(relativeId,contentId,contentType);dojo.stopEvent(event)}}}function showRecentlyViewedDropDown(relativeId,contentId,contentType){console.debug("Recently Viewed called");var t=dojo.byId(relativeId);var c=dojo.coords(t,true);var x1=c.x;var y1=c.y;var cartWidth=dojo.coords(dojo.byId("recentlyViewedBody"),true).w;dojo.style(dojo.byId("recently_viewed"),"width",cartWidth+"px");var dlgX;if(dojo.locale=="iw-il"&&dojo.isIE<7){dlgX=dojo.coords(dojo.byId("recentlyViewedLeftCorner")).x}else{dlgX=x1+dojo.contentBox(dojo.byId(relativeId)).w-cartWidth}if(dropDownDlg_RV){dropDownDlg_RV.y=y1;dropDownDlg_RV.x=dlgX}if(!dropDownDlg_RV){var pane=document.getElementById(contentId);dropDownDlg_RV=new wc.widget.WCDialog({relatedSource:relativeId,x:x1,y:y1},pane);dropDownDlg_RV.x=dlgX}if(dojo.isOpera!=0&&dojo.isOpera!=null){dropDownDlg_RV.x=dropDownDlg_RV.x+window.pageXOffset;dropDownDlg_RV.y=dropDownDlg_RV.y+window.pageYOffset}console.debug("value of content type :"+contentType);if(contentType=="recentlyViewedList"){dojo.byId("RecentlyViewedList").style.display="block"}else{if(contentType=="orderItemAdded"){dojo.byId("RecentlyViewedList").style.display="none";dojo.byId("RecentlyViewedAdded").style.display="block"}}setTimeout(dojo.hitch(dropDownDlg_RV,"show",null),5);setTimeout(dojo.hitch(this,"hideUnderlayWrapper",""),5)}function hideUnderlayWrapper(){dojo.query(".dijitDialogUnderlayWrapper",document).forEach(function(tag){tag.style.display="none"})}function loadLink(url){document.location.href=url}function clearSearchField(){searchText=document.getElementById("SimpleSearchForm_SearchTerm").value;if(searchText==document.getElementById("searchTextHolder").innerHTML){document.getElementById("SimpleSearchForm_SearchTerm").value=""}else{document.getElementById("SimpleSearchForm_SearchTerm").select();showAutoSuggestIfResults();autoSuggestHover=false}}function showAutoSuggestIfResults(){if(typeof(staticContent)!="undefined"&&document.getElementById(staticContentSectionDiv[0]).innerHTML==""&&document.getElementById("autoSuggestHistory").innerHTML==""&&document.getElementById("dynamicAutoSuggestTotalResults")==null){showAutoSuggest(false)}else{if(document.getElementById("SimpleSearchForm_SearchTerm").value.length<=AUTOSUGGEST_THRESHOLD){showAutoSuggest(false)}else{showAutoSuggest(true)}}}function fillSearchField(){if(document.getElementById("SimpleSearchForm_SearchTerm").value==""){document.getElementById("SimpleSearchForm_SearchTerm").value=document.getElementById("searchTextHolder").innerHTML}if(!autoSuggestHover){showAutoSuggest(false)}}function showDropDownMenu(){var showMenu=document.getElementById("header_menu_dropdown");if(document.getElementById("header_menu_dropdown")!=null&&document.getElementById("header_menu_dropdown")!="undefined"){showMenu.style.display="block"}console.debug("showdropdownmenu")}function initShopcartTarget(){dojo.subscribe("/dnd/drop",function(source,nodes,copy,target){target.deleteSelectedNodes();var actionListScroll=new popupActionProperties();actionListScroll.showProductCompare=showProductCompare;if(target.parent.id=="miniShopCart_dndTarget"){var indexOfIdentifier=source.parent.id.indexOf("_",0);if(indexOfIdentifier>=0){source.parent.id=source.parent.id.substring(indexOfIdentifier+1)}if(source.node.getAttribute("dndType")=="item"||source.node.getAttribute("dndType")=="package"){categoryDisplayJS.AddItem2ShopCartAjax(source.parent.id,1)}else{if(source.node.getAttribute("dndType")=="product"||source.node.getAttribute("dndType")=="bundle"){showPopup(source.parent.id,storeId,langId,catalogId,function(e){return e},"miniShopCart_dndTarget",null,actionListScroll)}}}})}function cursor_wait(checkForOpera){var showPopup=true;if(checkForOpera==true){if(dojo.isOpera>0){showPopup=false}}if(showPopup){setTimeout("showProgressBar()",500)}}function showProgressBar(){if(!requestSubmitted){return}displayProgressBar()}function displayProgressBar(){var dialog=dijit.byId("progress_bar_dialog");if(dialog!=null){dialog.closeButtonNode.style.display="none";var progressBar=document.getElementById("progress_bar");progressBar.style.display="block";if(this.currentId!=""){var element=document.getElementById(this.currentId);var pos=dijit.placeOnScreenAroundElement(progressBar,element,{TR:"TL"})}else{dialog.containerNode.innerHTML=="";progressBar.style.left="";progressBar.style.top="";dialog.containerNode.appendChild(progressBar);dialog.show()}setTimeout("cursor_clear()",1800000)}}function setCurrentId(id){if(!requestSubmitted&&this.currentId==""){this.currentId=id}}function trim(inword){word=inword.toString();var i=0;var j=word.length-1;while(word.charAt(i)==" "){i++}while(word.charAt(j)==" "){j=j-1}if(i>j){return word.substring(i,i)}else{return word.substring(i,j+1)}}function cursor_clear(){requestSubmitted=false;var dialog=dijit.byId("progress_bar_dialog");var progressBar=document.getElementById("progress_bar");if(dialog!=null){if(progressBar!=null){progressBar.style.display="none"}dialog.hide();this.currentId=""}}function submitRequest(){if(!requestSubmitted){requestSubmitted=true;return true}return false}function setPageLocation(newPageLink){if(!submitRequest()){return}document.location.href=newPageLink}function submitSpecifiedForm(form){if(!submitRequest()){return}form.submit()}function parseWidget(id){var node;var widget=dijit.byId(id);if(widget==null||widget==undefined){if(id==null||id==undefined){node=dojo.body()}else{node=dojo.byId(id)}if(node!=null&&node!=undefined){if(node.getAttribute("dojoType")!=null&&node.getAttribute("dojoType")!=undefined){dojo.parser.instantiate([node])}else{dojo.parser.parse(node)}}}}function parseHeader(id){var node=dojo.byId("progress_bar_dialog");var showMenu=document.getElementById("header_menu_loaded");var hideMenu=document.getElementById("header_menu_overlay");if(currentId.length==0&&document.getElementById("header_menu_loaded")!=null&&document.getElementById("header_menu_loaded")!="undefined"&&document.getElementById("header_menu_overlay")!=null&&document.getElementById("header_menu_overlay")!="undefined"&&document.getElementById("header_menu_loaded").style.display=="none"){setCurrentId((id!=null&&id!=undefined)?id:hideMenu.id);submitRequest();cursor_wait();hideMenu.style.display="none";parseWidget("header_menu_loaded");showMenu.style.display="block";cursor_clear()}}function hideElementById(elementId){var div=dojo.byId(elementId);div.style.display="none"}function showElementById(elementId){var div=dojo.byId(elementId);div.style.display="block"}function hideBackgroundImage(element){element.style.backgroundImage="none"}function showBackgroundImage(element){element.style.backgroundImage="url("+getImageDirectoryPath()+getStyleDirectoryPath()+"product_hover_background.png)"}function checkIE8Browser(){if(dojo.isIE&&dojo.isIE<=8){correctBrowser=true}}function ApprovalToolLink(idTag,approvalToolLinkURL){checkIE8Browser();if(correctBrowser){RFQwindow=window.open(approvalToolLinkURL)}else{MessageHelper.formErrorHandleClient(idTag,MessageHelper.messages.ERROR_INCORRECT_BROWSER);return}}function updateViewAndBeginIndexForCurrencyChange(){if(document.getElementById("fastFinderResultControls")!=null&&document.getElementById("fastFinderResultControls")!=""){if(document.SetCurrencyPreferenceForm.pageView!=null){document.SetCurrencyPreferenceForm.pageView.value=document.FastFinderForm.pageView.value}if(document.SetCurrencyPreferenceForm.beginIndex!=null){document.SetCurrencyPreferenceForm.beginIndex.value=document.FastFinderForm.beginIndex.value}}else{if(document.getElementById("CategoryDisplay_Widget")!=null&&document.getElementById("CategoryDisplay_Widget")!=""){if(wc.render.getContextById("CategoryDisplay_Context").properties.pageView!=""&&document.SetCurrencyPreferenceForm.pageView!=null){document.SetCurrencyPreferenceForm.pageView.value=wc.render.getContextById("CategoryDisplay_Context").properties.pageView}if(wc.render.getContextById("CategoryDisplay_Context").properties.beginIndex!=""&&document.SetCurrencyPreferenceForm.beginIndex!=null){document.SetCurrencyPreferenceForm.beginIndex.value=wc.render.getContextById("CategoryDisplay_Context").properties.beginIndex}}else{if(document.getElementById("Search_Result_Summary")!=null&&document.getElementById("Search_Result_Summary")!=""){if(wc.render.getContextById("catalogSearchResultDisplay_Context").properties.searchResultsView!=""&&document.SetCurrencyPreferenceForm.pageView!=null){document.SetCurrencyPreferenceForm.pageView.value=wc.render.getContextById("catalogSearchResultDisplay_Context").properties.searchResultsView}if(wc.render.getContextById("catalogSearchResultDisplay_Context").properties.searchResultsPageNum!=""&&document.SetCurrencyPreferenceForm.beginIndex!=null){document.SetCurrencyPreferenceForm.beginIndex.value=wc.render.getContextById("catalogSearchResultDisplay_Context").properties.searchResultsPageNum}}}}}function updateViewAndBeginIndexForLanguageChange(){if(document.getElementById("fastFinderResultControls")!=null&&document.getElementById("fastFinderResultControls")!=""){if(document.LanguageSelectionForm.pageView!=null){document.LanguageSelectionForm.pageView.value=document.FastFinderForm.pageView.value}if(document.LanguageSelectionForm.beginIndex!=null){document.LanguageSelectionForm.beginIndex.value=document.FastFinderForm.beginIndex.value}}else{if(document.getElementById("CategoryDisplay_Widget")!=null&&document.getElementById("CategoryDisplay_Widget")!=""){if(wc.render.getContextById("CategoryDisplay_Context").properties.pageView!=""&&document.LanguageSelectionForm.pageView!=null){document.LanguageSelectionForm.pageView.value=wc.render.getContextById("CategoryDisplay_Context").properties.pageView}if(wc.render.getContextById("CategoryDisplay_Context").properties.beginIndex!=""&&document.LanguageSelectionForm.beginIndex!=null){document.LanguageSelectionForm.beginIndex.value=wc.render.getContextById("CategoryDisplay_Context").properties.beginIndex}}else{if(document.getElementById("Search_Result_Summary")!=null&&document.getElementById("Search_Result_Summary")!=""){if(wc.render.getContextById("catalogSearchResultDisplay_Context").properties.searchResultsView!=""&&document.LanguageSelectionForm.pageView!=null){document.LanguageSelectionForm.pageView.value=wc.render.getContextById("catalogSearchResultDisplay_Context").properties.searchResultsView}if(wc.render.getContextById("catalogSearchResultDisplay_Context").properties.searchResultsPageNum!=""&&document.LanguageSelectionForm.beginIndex!=null){document.LanguageSelectionForm.beginIndex.value=wc.render.getContextById("catalogSearchResultDisplay_Context").properties.searchResultsPageNum}}}}}function showHeaderLinksInTwoLines(){if(document.getElementById("header_links")!=null&&document.getElementById("header_links")!="undefined"){if(dojo.contentBox(document.getElementById("header_links")).w>750){if(document.getElementById("header_links1")!=null&&document.getElementById("header_links1")!="undefined"){document.getElementById("header_links1").style.display="block"}if(document.getElementById("headerHomeLink")!=null&&document.getElementById("headerHomeLink")!="undefined"){document.getElementById("headerHomeLink").style.display="none"}if(document.getElementById("headerShopCartLink")!=null&&document.getElementById("headerShopCartLink")!="undefined"){document.getElementById("headerShopCartLink").style.display="none"}}document.getElementById("header_links").style.visibility="visible"}}function showLinksInOneLine(){if(document.getElementById("header_links")!=null&&document.getElementById("header_links")!="undefined"){document.getElementById("header_links").style.visibility="visible"}}function isNonNegativeInteger(value){var regExpTester=new RegExp(/^\d*$/);return(value!=null&&value!=""&&regExpTester.test(value))}function isPositiveInteger(value){return(isNonNegativeInteger(value)&&value!=0)}function getCookie(c){var cookies=document.cookie.split(";");for(var i=0;i<cookies.length;i++){var index=cookies[i].indexOf("=");var name=cookies[i].substr(0,index);name=name.replace(/^\s+|\s+$/g,"");if(name==c){return unescape(cookies[i].substr(index+1))}}}function clearAutoSuggestResults(){for(var i=0;i<staticContent.length;i++){document.getElementById(staticContentSectionDiv[i]).innerHTML=""}autoSuggestPreviousTerm="";autoSuggestURL="";document.getElementById("autoSuggestDynamic_Result_div").innerHTML="";showAutoSuggest(false)}function validateSearchSubmit(){var searchTermVal=document.getElementById("SimpleSearchForm_SearchTerm").value;searchTermVal=searchTermVal.toLowerCase();searchTermVal=searchTermVal.replace(/^\s\s*/,"").replace(/\s\s*$/,"");searchTermVal=searchTermVal.replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,"");var my_string=new String("SEARCH");if(searchTermVal!=my_string&&searchTermVal!='""'&&searchTermVal!=""&&searchTermVal!="search"&&searchTermVal!="null"&&searchTermVal!="please enter a search term"&&searchTermVal!="''"){var searchTerm=document.getElementById("SimpleSearchForm_SearchTerm").value;searchTerm=searchTerm.replace(/^[0]+/g,"");searchTerm=searchTerm.replace(/[^a-zA-Z0-9-_\s]/g,"");document.forms.CatalogSearchForm.globalSearchText.value=searchTerm;document.forms.CatalogSearchForm.searchText.value=searchTerm;document.location.href="http://"+window.location.host+"/SterlingSearch?storeId="+document.forms.CatalogSearchForm.storeId.value+"&catalogId="+document.forms.CatalogSearchForm.catalogId.value+"&langId="+document.forms.CatalogSearchForm.langId.value+"&globalSearchText="+searchTerm+"&searchText="+searchTerm;return false}else{document.getElementById("SimpleSearchForm_SearchTerm").value="Please enter a Search Term";document.getElementById("SimpleSearchForm_SearchTerm").style.color="red";return false}}function doAutoSuggest(event,url,searchTerm){if(event.keyCode!=13){document.getElementById("SimpleSearchForm_SearchTerm").style.color="#660066"}if(searchTerm.length<=AUTOSUGGEST_THRESHOLD){showAutoSuggest(false)}if(event.keyCode==dojo.keys.ENTER){return}if(event.keyCode==dojo.keys.TAB){autoSuggestHover=true;return}if(event.keyCode==dojo.keys.ESCAPE){showAutoSuggest(false);return}if(event.keyCode==dojo.keys.UP_ARROW){var totalDynamicResults=document.getElementById("dynamicAutoSuggestTotalResults");if(highLightSelection(true,autoSelectOption-1)){highLightSelection(false,autoSelectOption);if(autoSelectOption==historyIndex){resetAutoSuggestKeyword()}autoSelectOption--}else{if(autoSelectOption==CACHED_AUTOSUGGEST_OFFSET&&totalDynamicResults!=null&&totalDynamicResults!="undefined"){highLightSelection(false,CACHED_AUTOSUGGEST_OFFSET);autoSelectOption=totalDynamicResults.value-1;highLightSelection(true,autoSelectOption)}else{highLightSelection(false,autoSelectOption);autoSelectOption=-1;var originalKeyedSearchTerm=document.getElementById("autoSuggestOriginalTerm");resetAutoSuggestKeyword()}}return}if(event.keyCode==dojo.keys.DOWN_ARROW){if(highLightSelection(true,autoSelectOption+1)){highLightSelection(false,autoSelectOption);autoSelectOption++}else{if(autoSelectOption<CACHED_AUTOSUGGEST_OFFSET&&highLightSelection(true,CACHED_AUTOSUGGEST_OFFSET)){highLightSelection(false,autoSelectOption);autoSelectOption=CACHED_AUTOSUGGEST_OFFSET;resetAutoSuggestKeyword()}}return}if(searchTerm.length>AUTOSUGGEST_THRESHOLD&&searchTerm==autoSuggestPreviousTerm){return}else{autoSuggestPreviousTerm=searchTerm}if(searchTerm.length<=AUTOSUGGEST_THRESHOLD){return}if(autoSuggestTimer!=-1){clearTimeout(autoSuggestTimer);autoSuggestTimer=-1}if(searchTerm!=""){autoSelectOption=-1;var hasResults=doStaticAutoSuggest(searchTerm);if(searchTerm.length>DYNAMIC_AUTOSUGGEST_THRESHOLD){var showHeader=true;doDynamicAutoSuggest(url,searchTerm,showHeader)}else{document.getElementById("autoSuggestDynamic_Result_div").innerHTML=""}}else{clearAutoSuggestResults()}}function showAutoSuggest(display){var autoSuggest_Result_div=document.getElementById("autoSuggest_Result_div");if(dojo.isIE<7){var autoSuggest_content_div=document.getElementById("autoSuggest_content_div");var autoSuggestDropDownIFrame=document.getElementById("autoSuggestDropDownIFrame")}if(autoSuggest_Result_div!=null&&autoSuggest_Result_div!="undefined"){if(display){autoSuggest_Result_div.style.display="block";if(dojo.isIE<7){autoSuggestDropDownIFrame.style.height=autoSuggest_content_div.scrollHeight;autoSuggestDropDownIFrame.style.display="block"}}else{if(dojo.isIE<7){autoSuggestDropDownIFrame.style.display="none";autoSuggestDropDownIFrame.style.height=0}autoSuggest_Result_div.style.display="none"}}}function highLightSelection(state,index){var selection=document.getElementById("autoSelectOption_"+index);if(selection!=null&&selection!="undefined"){if(state){selection.className="autocompleteactive";var searchBox=document.getElementById("SimpleSearchForm_SearchTerm");searchBox.setAttribute("aria-activedescendant","suggestionItem_"+index);var totalDynamicResults=document.getElementById("dynamicAutoSuggestTotalResults");if((totalDynamicResults!=null&&totalDynamicResults!="undefined"&&index<totalDynamicResults.value)||(index>=historyIndex)){searchBox.value=selection.title;autoSuggestPreviousTerm=selection.title;autoSuggestURL=""}else{autoSuggestURL=selection.href}}else{selection.className=""}return true}else{return false}}function resetAutoSuggestKeyword(){var originalKeyedSearchTerm=document.getElementById("autoSuggestOriginalTerm");if(originalKeyedSearchTerm!=null&&originalKeyedSearchTerm!="undefined"){var searchBox=document.getElementById("SimpleSearchForm_SearchTerm");searchBox.value=originalKeyedSearchTerm.value;autoSuggestPreviousTerm=originalKeyedSearchTerm.value}}function selectAutoSuggest(term,viewName){var searchBox=document.getElementById("SimpleSearchForm_SearchTerm");searchBox.value=term;searchBox.focus();autoSuggestPreviousTerm=term;document.CatalogSearchForm.action=viewName;document.getElementById("SimpleSearchForm_SearchTerm").value=term;document.getElementById("searchText").value=term;if(viewName=="ArticleResultsView"){document.location.href="http://"+window.location.host+"/ArticleResults?storeId="+document.forms.CatalogSearchForm.storeId.value+"&catalogId="+document.forms.CatalogSearchForm.catalogId.value+"&langId="+document.forms.CatalogSearchForm.langId.value+"&globalSearchText="+term+"&searchText="+term}else{document.location.href="http://"+window.location.host+"/SterlingSearch?storeId="+document.forms.CatalogSearchForm.storeId.value+"&catalogId="+document.forms.CatalogSearchForm.catalogId.value+"&langId="+document.forms.CatalogSearchForm.langId.value+"&globalSearchText="+term+"&searchText="+term}}function enableAutoSelect(index){highLightSelection(false,autoSelectOption);var item=document.getElementById("autoSelectOption_"+index);item.className="autocompleteactive";autoSelectOption=index}function doStaticAutoSuggest(searchTerm){var resultList=["","","","","",""];var emptyCell=0;var searchTermLower=searchTerm.toLowerCase();var listCount=CACHED_AUTOSUGGEST_OFFSET;for(var i=0;i<staticContent.length;i++){var count=0;for(var j=0;j<staticContent[i].length;j++){var searchName=staticContent[i][j][0];var searchURL=staticContent[i][j][1];var displayName=staticContent[i][j][2];var index=searchName.toLowerCase().indexOf(searchTermLower);if(index!=-1){var displayIndex=index+displayName.length-searchName.length;resultList[i]=resultList[i]+"<li id='suggestionItem_"+listCount+"' role='listitem' tabindex='-1'><a id='autoSelectOption_"+listCount+"' title='"+displayName+"' onmouseout='this.className=\"\"; autoSuggestURL=\"\";' onmouseover='enableAutoSelect("+listCount+"); autoSuggestURL=this.href;' href=\""+searchURL+'">'+displayName.substr(0,displayIndex)+"<strong>"+displayName.substr(displayIndex,searchTerm.length)+"</strong>"+displayName.substr(displayIndex+searchTerm.length)+"</a></li>";count++;listCount++;if(count>=TOTAL_SUGGESTED){break}}}}for(var i=0;i<staticContent.length;i++){document.getElementById(staticContentSectionDiv[i]).innerHTML="";if(resultList[i]!=""){document.getElementById(staticContentSectionDiv[emptyCell]).innerHTML="<div class='results'><div class='heading'>"+staticContentHeaders[i]+"</div><ul>"+resultList[i]+"</ul></div>";emptyCell++}}var historyList="";var searchHistorySection=document.getElementById("autoSuggestHistory");searchHistorySection.innerHTML="";var historyArray=new Array();historyIndex=listCount;var searchHistoryCookie=getCookie("searchTermHistory");if(searchHistoryCookie!=null&&typeof(searchHistoryCookie)!="undefined"){var termsArray=searchHistoryCookie.split("|");var count=0;for(var i=termsArray.length-1;i>0;i--){var theTerm=termsArray[i];var theLowerTerm=theTerm.toLowerCase();if(theLowerTerm.match("^"+searchTermLower)==searchTermLower){var repeatedTerm=false;for(var j=0;j<historyArray.length;j++){if(historyArray[j]==theLowerTerm){repeatedTerm=true;break}}if(!repeatedTerm){historyList=historyList+"<li id='suggestionItem_"+listCount+"' role='listitem' tabindex='-1'><a href='#' onmouseout='this.className=\"\"' onmouseover='enableAutoSelect("+listCount+");' onclick='selectAutoSuggest(this.title); return false;' title=\""+theTerm+"\" id='autoSelectOption_"+listCount+"'><strong>"+searchTerm+"</strong>"+theTerm.substring(searchTerm.length,theTerm.length)+"</a></li>";historyArray.push(theLowerTerm);count++;listCount++;if(count>=TOTAL_HISTORY){break}}}}}if(historyList!=""){searchHistorySection.innerHTML="<div class='results'><div class='heading'>"+staticContentHeaderHistory+"</div><ul>"+historyList+"</ul></div>";emptyCell++}if(emptyCell>0){showAutoSuggest(true);return true}return false}function doDynamicAutoSuggest(url,searchTerm,showHeader){if(autoSuggestTimer!=-1){clearTimeout(autoSuggestTimer);autoSuggestTimer=-1}autoSuggestTimer=setTimeout(function(){wc.render.getRefreshControllerById("AutoSuggestDisplayController").url=url+"&term="+escape(searchTerm)+"&showHeader="+showHeader;wc.render.updateContext("AutoSuggest_Context",{});autoSuggestTimer=-1},autoSuggestKeystrokeDelay)}function retrieveCachedSuggestions(url){if(!retrievedCachedSuggestions){wc.render.getRefreshControllerById("AutoSuggestCachedSuggestionsController").url=url;wc.render.updateContext("CachedSuggestions_Context",{})}}function onEnterKeySearch(keyCode){if(keyCode==13){var suggestedValue="";if(document.getElementById("dynamicAutoSuggestTotalResults")!=null){suggestedValue=document.getElementById("dynamicAutoSuggestTotalResults").value}if(suggestedValue!=""){var suggestedTerm=document.getElementById("SimpleSearchForm_SearchTerm").value;var term=suggestedTerm.toLowerCase();var suggestedVal=document.getElementById("resultType_"+term).value;if(suggestedTerm=="diamond"){document.CatalogSearchForm.action="SearchResultsView";document.getElementById("SimpleSearchForm_SearchTerm").value=suggestedTerm;document.getElementById("searchText").value=suggestedTerm;document.location.href="http://"+window.location.host+"/SterlingSearch?storeId="+document.forms.CatalogSearchForm.storeId.value+"&catalogId="+document.forms.CatalogSearchForm.catalogId.value+"&langId="+document.forms.CatalogSearchForm.langId.value+"&globalSearchText="+suggestedTerm+"&searchText="+suggestedTerm}else{if(suggestedVal=="S"){document.CatalogSearchForm.action="SearchResultsView";document.getElementById("SimpleSearchForm_SearchTerm").value=suggestedTerm;document.getElementById("searchText").value=suggestedTerm;document.location.href="http://"+window.location.host+"/SterlingSearch?storeId="+document.forms.CatalogSearchForm.storeId.value+"&catalogId="+document.forms.CatalogSearchForm.catalogId.value+"&langId="+document.forms.CatalogSearchForm.langId.value+"&globalSearchText="+suggestedTerm+"&searchText="+suggestedTerm}else{if(suggestedVal=="A"){document.CatalogSearchForm.action="ArticleResultsView";document.getElementById("SimpleSearchForm_SearchTerm").value=suggestedTerm;document.getElementById("searchText").value=suggestedTerm;document.location.href="http://"+window.location.host+"/ArticleResults?storeId="+document.forms.CatalogSearchForm.storeId.value+"&catalogId="+document.forms.CatalogSearchForm.catalogId.value+"&langId="+document.forms.CatalogSearchForm.langId.value+"&globalSearchText="+suggestedTerm+"&searchText="+suggestedTerm}}}return false}else{var searchTermVal=document.getElementById("SimpleSearchForm_SearchTerm").value;searchTermVal=searchTermVal.toLowerCase();searchTermVal=searchTermVal.replace(/^\s\s*/,"").replace(/\s\s*$/,"");searchTermVal=searchTermVal.replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,"");var my_string=new String("SEARCH");if(searchTermVal!=my_string&&searchTermVal!='""'&&searchTermVal!=""&&searchTermVal!="search"&&searchTermVal!="null"&&searchTermVal!="please enter a search term"&&searchTermVal!="''"){var searchTerm=document.getElementById("SimpleSearchForm_SearchTerm").value;searchTerm=searchTerm.replace(/^[0]+/g,"");searchTerm=searchTerm.replace(/[^a-zA-Z0-9-_\s]/g,"");var URL="http://"+window.location.host+"/SterlingSearch?storeId=10101&catalogId=10001&langId=-1&globalSearchText="+searchTerm+"&searchText="+searchTerm;document.location.href=URL;return false}else{document.getElementById("SimpleSearchForm_SearchTerm").value="Please enter a Search Term";document.getElementById("SimpleSearchForm_SearchTerm").style.color="red";return false}}}else{return true}}function viewMoreArticles(){var articleSearchTerm=document.getElementById("SimpleSearchForm_SearchTerm").value;var URL="http://"+window.location.host+"/ArticleResults?storeId=10101&catalogId=10001&langId=-1&globalSearchText="+articleSearchTerm+"&searchText="+articleSearchTerm;document.location.href=URL}if(typeof(MessageHelper)=="undefined"||!MessageHelper||!MessageHelper.topicNamespace){MessageHelper={messages:{},identifier:"",getCurrentYear:function(){return new Date().getFullYear()},getCurrentMonth:function(){return new Date().getMonth()+1},getCurrentDay:function(){return new Date().getDate()},getRenderContextProperty:function(context,propertyName){console.debug("enter getRenderContextProperty with propertyName = "+propertyName);if(context==null){console.debug("context is null. Return null...");return null}var result=context.properties[propertyName];console.debug("the found property value is: "+result);return result},setMessage:function(key,msg){this.messages[key]=msg},displayErrorMessage:function(msg){if(this.messages.ERROR_MESSAGE_TYPE!=null&&this.messages.ERROR_MESSAGE_TYPE!="undefined"){var MsgType=this.messages.ERROR_MESSAGE_TYPE;msg=MsgType+msg}dojo.byId("ErrorMessageText").className="strongRedText";dojo.byId("MessageArea").style.display="block";dojo.byId("ErrorMessageText").innerHTML=msg;dojo.byId("MessageArea").focus();setTimeout("dojo.byId('ErrorMessageText').focus()",2000)},displayStatusMessage:function(msg){dojo.byId("ErrorMessageText").className="strongRedText";dojo.byId("MessageArea").style.display="block";dojo.byId("ErrorMessageText").innerHTML=msg;dojo.byId("MessageArea").focus();setTimeout("dojo.byId('ErrorMessageText').focus()",2000)},hideAndClearMessage:function(){dojo.byId("ErrorMessageText").innerHTML="";dojo.byId("MessageArea").style.display="none"},displayErrorMessageInModal:function(msg){dojo.byId("ModalErrorMessageText").className="strongRedText";dojo.byId("ModalMessageArea").style.display="block";dojo.byId("ModalErrorMessageText").innerHTML=msg;dojo.byId("ModalMessageArea").focus();setTimeout("dojo.byId('ModalMessageArea').focus()",2000)},hideAndClearModalMessage:function(){dojo.byId("ModalErrorMessageText").innerHTML="";dojo.byId("ModalMessageArea").style.display="none"},formErrorHandle:function(serviceResponse,formName){this.formErrorHandleClient(serviceResponse.errorMessageParam,serviceResponse.errorMessage)},formErrorHandleClient:function(id,errorMessage){var element=dojo.byId(id);if(errorMessage==null){console.debug("formErrorHandleClient: The error message is null.");return}if(element){if(this.identifier!=(id+"_tooltip")){this.identifier=id+"_tooltip";var node=document.createElement("span");var imgDirPath=getImageDirectoryPath();if(dojo.isIE<7){node.innerHTML=errorMessage+"<iframe id='errorMessageIFrame' scrolling='no' frameborder='0' src='"+imgDirPath+"images/empty.gif'></iframe>"}else{node.innerHTML=errorMessage}var tooltip=new dijit.Tooltip({connectId:[id]},node);tooltip.startup();console.log("created",tooltip,tooltip.id);element.focus();tooltip.open(element);dojo.connect(element,"onblur",tooltip,"close");dojo.connect(element,"onblur",tooltip,"destroy");dojo.connect(element,"onblur",this,"clearCurrentIdentifier");tooltip._onMouseOver=this.emptyFunc}}},clearCurrentIdentifier:function(){this.identifier=""},emptyFunc:function(event){},containsDoubleByte:function(target){var str=new String(target);var oneByteMax=127;for(var i=0;i<str.length;i++){chr=str.charCodeAt(i);if(chr>oneByteMax){return true}}return false},isValidEmail:function(strEmail){if(this.containsDoubleByte(strEmail)){return false}if(strEmail.length==0){return true}else{if(strEmail.length<5){return false}else{if(strEmail.indexOf(" ")>0){return false}else{if(strEmail.indexOf("@")<1){return false}else{if(strEmail.lastIndexOf(".")<(strEmail.indexOf("@")+2)){return false}else{if(strEmail.lastIndexOf(".")>=strEmail.length-2){return false}}}}}}return true},isValidUTF8length:function(UTF16String,maxlength){if(this.utf8StringByteLength(UTF16String)>maxlength){return false}else{return true}},utf8StringByteLength:function(UTF16String){if(UTF16String===null){return 0}var str=String(UTF16String);var oneByteMax=127;var twoByteMax=2047;var byteSize=str.length;for(i=0;i<str.length;i++){chr=str.charCodeAt(i);if(chr>oneByteMax){byteSize=byteSize+1}if(chr>twoByteMax){byteSize=byteSize+1}}return byteSize},IsNumeric:function(text,allowDot){if(allowDot){var ValidChars="0123456789."}else{var ValidChars="0123456789"}var IsNumber=true;var Char;for(i=0;i<text.length&&IsNumber==true;i++){Char=text.charAt(i);if(ValidChars.indexOf(Char)==-1){IsNumber=false}}return IsNumber},IsValidPhone:function(text){var ValidChars="0123456789()-+ ";var IsValid=true;var Char;for(i=0;i<text.length&&IsValid==true;i++){Char=text.charAt(i);if(ValidChars.indexOf(Char)==-1){IsValid=false}}return IsValid}}}var showCompareDropdown=false;var compareDropDownDlg=null;function destroyCompareDialog(){dojo.query(".dijitDialog",document).forEach(function(tag){if(dijit.byNode(tag).id=="quick_compare_container"){dijit.byNode(tag).destroyRecursive()}});compareDropDownDlg=null}function showMiniCompareDropDown(relativeId,contentId,contentType){var t=dojo.byId(relativeId);var c=dojo.coords(t,true);var x1=c.x;var y1=menuHeight;var cartWidth=dojo.coords(dojo.byId("CompareCollector"),true).w;dojo.style(dojo.byId("quick_compare"),"width","311px");var dlgX=x1-adjustedMenuWidth+cartWidth-12;if(dojo.locale=="iw-il"&&dojo.isIE<7){dlgX=dojo.coords(dojo.byId("miniShopCartLeftCorner")).x}else{dlgX=x1-adjustedMenuWidth+cartWidth-12}if(dojo.isIE){dlgX-=8}if(compareDropDownDlg){compareDropDownDlg.y=y1;compareDropDownDlg.x=dlgX}if(!compareDropDownDlg){var pane=document.getElementById(contentId);compareDropDownDlg=new wc.widget.WCDialog({relatedSource:relativeId,x:x1,y:y1},pane);compareDropDownDlg.x=dlgX}if(dojo.isOpera!=0&&dojo.isOpera!=null){compareDropDownDlg.x=compareDropDownDlg.x+window.pageXOffset;compareDropDownDlg.y=compareDropDownDlg.y+window.pageYOffset}if(contentType=="compareItemsList"){dojo.byId("MiniCompareProductsList").style.display="block";dojo.byId("MiniCompareProductAdded").style.display="none";compareDropDownDlg.closeOnTimeOut=false;compareDropDownDlg.show()}else{if(contentType=="compareItemAdded"){dojo.byId("MiniCompareProductsList").style.display="none";dojo.byId("MiniCompareProductAdded").style.display="block";setTimeout(dojo.hitch(compareDropDownDlg,"show",null),5);setTimeout(dojo.hitch(this,"hideUnderlayWrapper",""),5)}}readyMenuToggle("CompareCollector",compareDropDownDlg,"compare-modal")}var toopTipDlg;function displayTooltip(contentPane,relativeId,position,modalWidth,url){destroyToolTipDialog(contentPane);var t=dojo.byId(relativeId);var c=dojo.coords(t,true);var x1=c.x;var y1=c.y;var widthAttr=dojo.coords(dojo.byId(relativeId),true).w;if(position=="right"){x1=x1+widthAttr;y1=y1-25}if(position=="left"){x1=x1-modalWidth;y1=y1-25}if(toopTipDlg){toopTipDlg.y=y1;toopTipDlg.x=x1;toopTipDlg.attr("href",url);toopTipDlg.closeOnTimeOut=false;toopTipDlg.show();$(".scrollable").jScrollPane()}else{var pane=document.getElementById(contentPane);dojo.xhrGet({url:url,load:function(data){toopTipDlg=new wc.widget.WCDialog({relatedSource:relativeId,x:x1,y:y1,content:data},pane);toopTipDlg.closeOnTimeOut=false;toopTipDlg.show();$("#"+toopTipDlg.id+" .scrollable").html('<div class="popup-container">'+$("#"+toopTipDlg.id+" .scrollable").html()+"</div>").jScrollPane()}})}}function displayTooltipFromDiv(contentPane,relativeId,position,modalWidth,divId){destroyToolTipDialog(contentPane);var t=dojo.byId(relativeId);var c=dojo.coords(t,true);var x1=c.x;var y1=c.y;var widthAttr=dojo.coords(dojo.byId(relativeId),true).w;if(position=="right"){x1=x1+widthAttr;y1=y1-25}if(position=="left"){x1=x1-modalWidth;y1=y1-25}if(toopTipDlg){toopTipDlg.y=y1;toopTipDlg.x=x1;toopTipDlg.attr("href",url);toopTipDlg.closeOnTimeOut=false;toopTipDlg.show();$(".scrollable").jScrollPane()}else{var pane=document.getElementById(contentPane);contentString=outerHTML(document.getElementById(divId));toopTipDlg=new wc.widget.WCDialog({relatedSource:relativeId,x:x1,y:y1,content:contentString},pane);toopTipDlg.closeOnTimeOut=false;toopTipDlg.show();$(".scrollable").html("<div>"+$(".scrollable").html()+"</div>").jScrollPane()}}function outerHTML(node){return node.outerHTML||(function(n){var div=document.createElement("div"),h;div.appendChild(n.cloneNode(true));h=div.innerHTML;div=null;return h})(node)}function destroyToolTipDialog(contentPane){dojo.query(".dijitDialog",document).forEach(function(tag){if(dijit.byNode(tag).id==contentPane){dijit.byNode(tag).destroyRecursive()}});toopTipDlg=null}function closeTooltip(){toopTipDlg.hide();return false}var dropDownTimeout;var currentDropdown=null;var initPrepareEvent;var prepareEvent;var cancelEvent;var popupOpened;var menuHeight=35;var currentModal;var adjustedMenuWidth=307;function readyMenuToggle(menuDiv,modalDiv,modalID){if(currentDropdown!=null&&currentDropdown!=modalDiv){closeDropDown()}if(dijit._underlay){dijit._underlay.hide()}currentModal=modalID;currentDropdown=modalDiv;dojo.style(currentDropdown.id,"position","fixed");dojo.addClass(dojo.byId(currentModal),"modal-active");initPrepareEvent=dojo.connect(dojo.byId(menuDiv),"onmouseleave",this,"prepareInitialToggle");prepareEvent=dojo.connect(modalDiv.domNode,"onmouseleave",null,"prepareToggle");cancelEvent=dojo.connect(modalDiv.domNode,"onmouseenter",null,"cancelToggle");popupOpened=true}function prepareInitialToggle(){if(dropDownTimeout==null){var toggleFunction=function(){closeDropDown()};dropDownTimeout=setTimeout(toggleFunction,100)}dojo.disconnect(this.initPrepareEvent)}function prepareToggle(){if(dropDownTimeout==null){var toggleFunction=function(){closeDropDown()};dropDownTimeout=setTimeout(toggleFunction,100)}else{cancelToggle();prepareToggle()}}function cancelToggle(){if(dropDownTimeout!=null){clearTimeout(dropDownTimeout);dropDownTimeout=null}}function closeDropDown(){if(popupOpened){currentDropdown.hide();popupOpened=false;dojo.removeClass(dojo.byId(currentModal),"modal-active")}cancelToggle();dojo.disconnect(prepareEvent);dojo.disconnect(cancelEvent);dojo.disconnect(initPrepareEvent)};