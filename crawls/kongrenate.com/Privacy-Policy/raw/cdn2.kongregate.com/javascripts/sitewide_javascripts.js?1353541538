var Prototype={Version:"1.7_rc3",Browser:function(){var a=navigator.userAgent,b=Object.prototype.toString.call(window.opera)=="[object Opera]";return{IE:!!window.attachEvent&&!b,Opera:b,WebKit:a.indexOf("AppleWebKit/")>-1,Gecko:a.indexOf("Gecko")>-1&&a.indexOf("KHTML")===-1,MobileSafari:/Apple.*Mobile/.test(a)}}(),BrowserFeatures:{XPath:!!document.evaluate,SelectorsAPI:!!document.querySelector,ElementExtensions:function(){var a=window.Element||window.HTMLElement;return!!(a&&a.prototype)}(),SpecificElementExtensions:function(){if(typeof window.HTMLDivElement!==
"undefined")return true;var a=document.createElement("div"),b=document.createElement("form"),c=false;if(a.__proto__&&a.__proto__!==b.__proto__)c=true;return c}()},ScriptFragment:"<script[^>]*>([\\S\\s]*?)<\/script>",JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,emptyFunction:function(){},K:function(a){return a}};if(Prototype.Browser.MobileSafari)Prototype.BrowserFeatures.SpecificElementExtensions=false;
var Abstract={},Try={these:function(){for(var a,b=0,c=arguments.length;b<c;b++){var e=arguments[b];try{a=e();break}catch(f){}}return a}},Class=function(){function a(){}function b(){function f(){this.initialize.apply(this,arguments)}var h=null,l=$A(arguments);if(Object.isFunction(l[0]))h=l.shift();Object.extend(f,Class.Methods);f.superclass=h;f.subclasses=[];if(h){a.prototype=h.prototype;f.prototype=new a;h.subclasses.push(f)}h=0;for(var o=l.length;h<o;h++)f.addMethods(l[h]);if(!f.prototype.initialize)f.prototype.initialize=
Prototype.emptyFunction;return f.prototype.constructor=f}function c(f){var h=this.superclass&&this.superclass.prototype,l=Object.keys(f);if(e){f.toString!=Object.prototype.toString&&l.push("toString");f.valueOf!=Object.prototype.valueOf&&l.push("valueOf")}for(var o=0,n=l.length;o<n;o++){var p=l[o],y=f[p];if(h&&Object.isFunction(y)&&y.argumentNames()[0]=="$super"){var m=y;y=function(v){return function(){return h[v].apply(this,arguments)}}(p).wrap(m);y.valueOf=m.valueOf.bind(m);y.toString=m.toString.bind(m)}this.prototype[p]=
y}return this}var e=function(){for(var f in{toString:1})if(f==="toString")return false;return true}();return{create:b,Methods:{addMethods:c}}}();
(function(){function a(S){switch(S){case null:return q;case void 0:return t}switch(typeof S){case "boolean":return w;case "number":return r;case "string":return z}return H}function b(S,J){for(var I in J)S[I]=J[I];return S}function c(S){try{if(g(S))return"undefined";if(S===null)return"null";return S.inspect?S.inspect():String(S)}catch(J){if(J instanceof RangeError)return"...";throw J;}}function e(S){return f("",{"":S},[])}function f(S,J,I){J=J[S];var N=typeof J;if(a(J)===H&&typeof J.toJSON==="function")J=
J.toJSON(S);S=j.call(J);switch(S){case C:case u:case L:J=J.valueOf()}switch(J){case null:return"null";case true:return"true";case false:return"false"}N=typeof J;switch(N){case "string":return J.inspect(true);case "number":return isFinite(J)?String(J):"null";case "object":N=0;for(var Y=I.length;N<Y;N++)if(I[N]===J)throw new TypeError;I.push(J);var R=[];if(S===T){N=0;for(Y=J.length;N<Y;N++){var Q=f(N,J,I);R.push(typeof Q==="undefined"?"null":Q)}R="["+R.join(",")+"]"}else{var da=Object.keys(J);N=0;for(Y=
da.length;N<Y;N++){S=da[N];Q=f(S,J,I);typeof Q!=="undefined"&&R.push(S.inspect(true)+":"+Q)}R="{"+R.join(",")+"}"}I.pop();return R}}function h(S){return JSON.stringify(S)}function l(S){return $H(S).toQueryString()}function o(S){return S&&S.toHTML?S.toHTML():String.interpret(S)}function n(S){if(a(S)!==H)throw new TypeError;var J=[];for(var I in S)S.hasOwnProperty(I)&&J.push(I);return J}function p(S){var J=[];for(var I in S)J.push(S[I]);return J}function y(S){return b({},S)}function m(S){return!!(S&&
S.nodeType==1)}function v(S){return j.call(S)===T}function A(S){return S instanceof Hash}function B(S){return typeof S==="function"}function s(S){return j.call(S)===L}function F(S){return j.call(S)===C}function g(S){return typeof S==="undefined"}var j=Object.prototype.toString,q="Null",t="Undefined",w="Boolean",r="Number",z="String",H="Object",u="[object Boolean]",C="[object Number]",L="[object String]",T="[object Array]",E=window.JSON&&typeof JSON.stringify==="function"&&JSON.stringify(0)==="0"&&
typeof JSON.stringify(Prototype.K)==="undefined";if(typeof Array.isArray=="function"&&Array.isArray([])&&!Array.isArray({}))v=Array.isArray;b(Object,{extend:b,inspect:c,toJSON:E?h:e,toQueryString:l,toHTML:o,keys:Object.keys||n,values:p,clone:y,isElement:m,isArray:v,isHash:A,isFunction:B,isString:s,isNumber:F,isUndefined:g})})();
Object.extend(Function.prototype,function(){function a(m,v){for(var A=m.length,B=v.length;B--;)m[A+B]=v[B];return m}function b(m,v){m=y.call(m,0);return a(m,v)}function c(){var m=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return m.length==1&&!m[0]?[]:m}function e(m){if(arguments.length<2&&Object.isUndefined(arguments[0]))return this;var v=this,A=y.call(arguments,1);return function(){var B=b(A,arguments);
return v.apply(m,B)}}function f(m){var v=this,A=y.call(arguments,1);return function(B){B=a([B||window.event],A);return v.apply(m,B)}}function h(){if(!arguments.length)return this;var m=this,v=y.call(arguments,0);return function(){var A=b(v,arguments);return m.apply(this,A)}}function l(m){var v=this,A=y.call(arguments,1);m*=1E3;return window.setTimeout(function(){return v.apply(v,A)},m)}function o(){return this.delay.apply(this,a([0.01],arguments))}function n(m){var v=this;return function(){var A=
a([v.bind(this)],arguments);return m.apply(this,A)}}function p(){if(this._methodized)return this._methodized;var m=this;return this._methodized=function(){var v=a([this],arguments);return m.apply(null,v)}}var y=Array.prototype.slice;return{argumentNames:c,bind:e,bindAsEventListener:f,curry:h,delay:l,defer:o,wrap:n,methodize:p}}());
(function(a){function b(){return this.getUTCFullYear()+"-"+(this.getUTCMonth()+1).toPaddedString(2)+"-"+this.getUTCDate().toPaddedString(2)+"T"+this.getUTCHours().toPaddedString(2)+":"+this.getUTCMinutes().toPaddedString(2)+":"+this.getUTCSeconds().toPaddedString(2)+"Z"}function c(){return this.toISOString()}if(!a.toISOString)a.toISOString=b;if(!a.toJSON)a.toJSON=c})(Date.prototype);RegExp.prototype.match=RegExp.prototype.test;
RegExp.escape=function(a){return String(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")};
var PeriodicalExecuter=Class.create({initialize:function(a,b){this.callback=a;this.frequency=b;this.currentlyExecuting=false;this.registerCallback()},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1E3)},execute:function(){this.callback(this)},stop:function(){if(this.timer){clearInterval(this.timer);this.timer=null}},onTimerEvent:function(){if(!this.currentlyExecuting)try{this.currentlyExecuting=true;this.execute();this.currentlyExecuting=false}catch(a){this.currentlyExecuting=
false;throw a;}}});Object.extend(String,{interpret:function(a){return a==null?"":String(a)},specialChar:{"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r","\\":"\\\\"}});
Object.extend(String.prototype,function(){function a(I){if(Object.isFunction(I))return I;var N=new Template(I);return function(Y){return N.evaluate(Y)}}function b(I,N){var Y="",R=this,Q;N=a(N);if(Object.isString(I))I=RegExp.escape(I);if(!(I.length||I.source)){N=N("");return N+R.split("").join(N)+N}for(;R.length>0;)if(Q=R.match(I)){Y+=R.slice(0,Q.index);Y+=String.interpret(N(Q));R=R.slice(Q.index+Q[0].length)}else{Y+=R;R=""}return Y}function c(I,N,Y){N=a(N);Y=Object.isUndefined(Y)?1:Y;return this.gsub(I,
function(R){if(--Y<0)return R[0];return N(R)})}function e(I,N){this.gsub(I,N);return String(this)}function f(I,N){I=I||30;N=Object.isUndefined(N)?"...":N;return this.length>I?this.slice(0,I-N.length)+N:String(this)}function h(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}function l(){return this.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,"")}function o(){return this.replace(new RegExp(Prototype.ScriptFragment,"img"),"")}function n(){var I=new RegExp(Prototype.ScriptFragment,"img"),
N=new RegExp(Prototype.ScriptFragment,"im");return(this.match(I)||[]).map(function(Y){return(Y.match(N)||["",""])[1]})}function p(){return this.extractScripts().map(function(I){return eval(I)})}function y(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function m(){return this.stripTags().replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function v(I){var N=this.strip().match(/([^?#]*)(#.*)?$/);if(!N)return{};return N[1].split(I||"&").inject({},function(Y,
R){if((R=R.split("="))[0]){var Q=decodeURIComponent(R.shift());R=R.length>1?R.join("="):R[0];if(R!=undefined)R=decodeURIComponent(R);if(Q in Y){Object.isArray(Y[Q])||(Y[Q]=[Y[Q]]);Y[Q].push(R)}else Y[Q]=R}return Y})}function A(){return this.split("")}function B(){return this.slice(0,this.length-1)+String.fromCharCode(this.charCodeAt(this.length-1)+1)}function s(I){return I<1?"":(new Array(I+1)).join(this)}function F(){return this.replace(/-+(.)?/g,function(I,N){return N?N.toUpperCase():""})}function g(){return this.charAt(0).toUpperCase()+
this.substring(1).toLowerCase()}function j(){return this.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/-/g,"_").toLowerCase()}function q(){return this.replace(/_/g,"-")}function t(I){var N=this.replace(/[\x00-\x1f\\]/g,function(Y){if(Y in String.specialChar)return String.specialChar[Y];return"\\u00"+Y.charCodeAt().toPaddedString(2,16)});if(I)return'"'+N.replace(/"/g,'\\"')+'"';return"'"+N.replace(/'/g,"\\'")+"'"}function w(I){return this.replace(I||
Prototype.JSONFilter,"$1")}function r(){var I=this;if(I.blank())return false;I=I.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@");I=I.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]");I=I.replace(/(?:^|:|,)(?:\s*\[)+/g,"");return/^[\],:{}\s]*$/.test(I)}function z(I){var N=this.unfilterJSON(),Y=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;if(Y.test(N))N=N.replace(Y,function(Q){return"\\u"+("0000"+Q.charCodeAt(0).toString(16)).slice(-4)});
try{if(!I||N.isJSON())return eval("("+N+")")}catch(R){}throw new SyntaxError("Badly formed JSON string: "+this.inspect());}function H(){var I=this.unfilterJSON();return JSON.parse(I)}function u(I){return this.indexOf(I)>-1}function C(I){return this.lastIndexOf(I,0)===0}function L(I){var N=this.length-I.length;return N>=0&&this.indexOf(I,N)===N}function T(){return this==""}function E(){return/^\s*$/.test(this)}function S(I,N){return(new Template(this,N)).evaluate(I)}var J=window.JSON&&typeof JSON.parse===
"function"&&JSON.parse('{"test": true}').test;return{gsub:b,sub:c,scan:e,truncate:f,strip:String.prototype.trim||h,stripTags:l,stripScripts:o,extractScripts:n,evalScripts:p,escapeHTML:y,unescapeHTML:m,toQueryParams:v,parseQuery:v,toArray:A,succ:B,times:s,camelize:F,capitalize:g,underscore:j,dasherize:q,inspect:t,unfilterJSON:w,isJSON:r,evalJSON:J?H:z,include:u,startsWith:C,endsWith:L,empty:T,blank:E,interpolate:S}}());
var Template=Class.create({initialize:function(a,b){this.template=a.toString();this.pattern=b||Template.Pattern},evaluate:function(a){if(a&&Object.isFunction(a.toTemplateReplacements))a=a.toTemplateReplacements();return this.template.gsub(this.pattern,function(b){if(a==null)return b[1]+"";var c=b[1]||"";if(c=="\\")return b[2];var e=a,f=b[3],h=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;b=h.exec(f);if(b==null)return c;for(;b!=null;){var l=b[1].startsWith("[")?b[2].replace(/\\\\]/g,"]"):b[1];e=e[l];if(null==
e||""==b[3])break;f=f.substring("["==b[3]?b[1].length:b[0].length);b=h.exec(f)}return c+String.interpret(e)})}});Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;
var $break={},Enumerable=function(){function a(r,z){var H=0;try{this._each(function(C){r.call(z,C,H++)})}catch(u){if(u!=$break)throw u;}return this}function b(r,z,H){var u=-r,C=[],L=this.toArray();if(r<1)return L;for(;(u+=r)<L.length;)C.push(L.slice(u,u+r));return C.collect(z,H)}function c(r,z){r=r||Prototype.K;var H=true;this.each(function(u,C){H=H&&!!r.call(z,u,C);if(!H)throw $break;});return H}function e(r,z){r=r||Prototype.K;var H=false;this.each(function(u,C){if(H=!!r.call(z,u,C))throw $break;
});return H}function f(r,z){r=r||Prototype.K;var H=[];this.each(function(u,C){H.push(r.call(z,u,C))});return H}function h(r,z){var H;this.each(function(u,C){if(r.call(z,u,C)){H=u;throw $break;}});return H}function l(r,z){var H=[];this.each(function(u,C){r.call(z,u,C)&&H.push(u)});return H}function o(r,z,H){z=z||Prototype.K;var u=[];if(Object.isString(r))r=new RegExp(RegExp.escape(r));this.each(function(C,L){r.match(C)&&u.push(z.call(H,C,L))});return u}function n(r){if(Object.isFunction(this.indexOf))if(this.indexOf(r)!=
-1)return true;var z=false;this.each(function(H){if(H==r){z=true;throw $break;}});return z}function p(r,z){z=Object.isUndefined(z)?null:z;return this.eachSlice(r,function(H){for(;H.length<r;)H.push(z);return H})}function y(r,z,H){this.each(function(u,C){r=z.call(H,r,u,C)});return r}function m(r){var z=$A(arguments).slice(1);return this.map(function(H){return H[r].apply(H,z)})}function v(r,z){r=r||Prototype.K;var H;this.each(function(u,C){u=r.call(z,u,C);if(H==null||u>=H)H=u});return H}function A(r,
z){r=r||Prototype.K;var H;this.each(function(u,C){u=r.call(z,u,C);if(H==null||u<H)H=u});return H}function B(r,z){r=r||Prototype.K;var H=[],u=[];this.each(function(C,L){(r.call(z,C,L)?H:u).push(C)});return[H,u]}function s(r){var z=[];this.each(function(H){z.push(H[r])});return z}function F(r,z){var H=[];this.each(function(u,C){r.call(z,u,C)||H.push(u)});return H}function g(r,z){return this.map(function(H,u){return{value:H,criteria:r.call(z,H,u)}}).sort(function(H,u){H=H.criteria;u=u.criteria;return H<
u?-1:H>u?1:0}).pluck("value")}function j(){return this.map()}function q(){var r=Prototype.K,z=$A(arguments);if(Object.isFunction(z.last()))r=z.pop();var H=[this].concat(z).map($A);return this.map(function(u,C){return r(H.pluck(C))})}function t(){return this.toArray().length}function w(){return"#<Enumerable:"+this.toArray().inspect()+">"}return{each:a,eachSlice:b,all:c,every:c,any:e,some:e,collect:f,map:f,detect:h,findAll:l,select:l,filter:l,grep:o,include:n,member:n,inGroupsOf:p,inject:y,invoke:m,
max:v,min:A,partition:B,pluck:s,reject:F,sortBy:g,toArray:j,entries:j,zip:q,size:t,inspect:w,find:h}}();function $A(a){if(!a)return[];if("toArray"in Object(a))return a.toArray();for(var b=a.length||0,c=new Array(b);b--;)c[b]=a[b];return c}function $w(a){if(!Object.isString(a))return[];return(a=a.strip())?a.split(/\s+/):[]}Array.from=$A;
(function(){function a(q){for(var t=0,w=this.length;t<w;t++)q(this[t])}function b(){this.length=0;return this}function c(){return this[0]}function e(){return this[this.length-1]}function f(){return this.select(function(q){return q!=null})}function h(){return this.inject([],function(q,t){if(Object.isArray(t))return q.concat(t.flatten());q.push(t);return q})}function l(){var q=g.call(arguments,0);return this.select(function(t){return!q.include(t)})}function o(q){return(q===false?this.toArray():this)._reverse()}
function n(q){return this.inject([],function(t,w,r){if(0==r||(q?t.last()!=w:!t.include(w)))t.push(w);return t})}function p(q){return this.uniq().findAll(function(t){return q.detect(function(w){return t===w})})}function y(){return g.call(this,0)}function m(){return this.length}function v(){return"["+this.map(Object.inspect).join(", ")+"]"}function A(q,t){t||(t=0);var w=this.length;if(t<0)t=w+t;for(;t<w;t++)if(this[t]===q)return t;return-1}function B(q,t){t=isNaN(t)?this.length:(t<0?this.length+t:t)+
1;q=this.slice(0,t).reverse().indexOf(q);return q<0?q:t-q-1}function s(){for(var q=g.call(this,0),t,w=0,r=arguments.length;w<r;w++){t=arguments[w];if(Object.isArray(t)&&!("callee"in t))for(var z=0,H=t.length;z<H;z++)q.push(t[z]);else q.push(t)}return q}var F=Array.prototype,g=F.slice,j=F.forEach;j||(j=a);Object.extend(F,Enumerable);if(!F._reverse)F._reverse=F.reverse;Object.extend(F,{_each:j,clear:b,first:c,last:e,compact:f,flatten:h,without:l,reverse:o,uniq:n,intersect:p,clone:y,toArray:y,size:m,
inspect:v});if(function(){return[].concat(arguments)[0][0]!==1}(1,2))F.concat=s;if(!F.indexOf)F.indexOf=A;if(!F.lastIndexOf)F.lastIndexOf=B})();function $H(a){return new Hash(a)}
var Hash=Class.create(Enumerable,function(){function a(s){this._object=Object.isHash(s)?s.toObject():Object.clone(s)}function b(s){for(var F in this._object){var g=this._object[F],j=[F,g];j.key=F;j.value=g;s(j)}}function c(s,F){return this._object[s]=F}function e(s){if(this._object[s]!==Object.prototype[s])return this._object[s]}function f(s){var F=this._object[s];delete this._object[s];return F}function h(){return Object.clone(this._object)}function l(){return this.pluck("key")}function o(){return this.pluck("value")}
function n(s){var F=this.detect(function(g){return g.value===s});return F&&F.key}function p(s){return this.clone().update(s)}function y(s){return(new Hash(s)).inject(this,function(F,g){F.set(g.key,g.value);return F})}function m(s,F){if(Object.isUndefined(F))return s;return s+"="+encodeURIComponent(String.interpret(F))}function v(){return this.inject([],function(s,F){var g=encodeURIComponent(F.key);if((F=F.value)&&typeof F=="object"){if(Object.isArray(F))return s.concat(F.map(m.curry(g)))}else s.push(m(g,
F));return s}).join("&")}function A(){return"#<Hash:{"+this.map(function(s){return s.map(Object.inspect).join(": ")}).join(", ")+"}>"}function B(){return new Hash(this)}return{initialize:a,_each:b,set:c,get:e,unset:f,toObject:h,toTemplateReplacements:h,keys:l,values:o,index:n,merge:p,update:y,toQueryString:v,inspect:A,toJSON:h,clone:B}}());Hash.from=$H;
Object.extend(Number.prototype,function(){function a(){return this.toPaddedString(2,16)}function b(){return this+1}function c(n,p){$R(0,this,true).each(n,p);return this}function e(n,p){p=this.toString(p||10);return"0".times(n-p.length)+p}function f(){return Math.abs(this)}function h(){return Math.round(this)}function l(){return Math.ceil(this)}function o(){return Math.floor(this)}return{toColorPart:a,succ:b,times:c,toPaddedString:e,abs:f,round:h,ceil:l,floor:o}}());
function $R(a,b,c){return new ObjectRange(a,b,c)}
var ObjectRange=Class.create(Enumerable,function(){function a(e,f,h){this.start=e;this.end=f;this.exclusive=h}function b(e){for(var f=this.start;this.include(f);){e(f);f=f.succ()}}function c(e){if(e<this.start)return false;if(this.exclusive)return e<this.end;return e<=this.end}return{initialize:a,_each:b,include:c}}()),Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||
false},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(a){this.responders._each(a)},register:function(a){this.include(a)||this.responders.push(a)},unregister:function(a){this.responders=this.responders.without(a)},dispatch:function(a,b,c,e){this.each(function(f){if(Object.isFunction(f[a]))try{f[a].apply(f,[b,c,e])}catch(h){}})}};Object.extend(Ajax.Responders,Enumerable);Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++},onComplete:function(){Ajax.activeRequestCount--}});
Ajax.Base=Class.create({initialize:function(a){this.options={method:"post",asynchronous:true,contentType:"application/x-www-form-urlencoded",encoding:"UTF-8",parameters:"",evalJSON:true,evalJS:true};Object.extend(this.options,a||{});this.options.method=this.options.method.toLowerCase();if(Object.isHash(this.options.parameters))this.options.parameters=this.options.parameters.toObject()}});
Ajax.Request=Class.create(Ajax.Base,{_complete:false,initialize:function($super,b,c){$super(c);this.transport=Ajax.getTransport();this.request(b)},request:function(a){this.url=a;this.method=this.options.method;a=Object.isString(this.options.parameters)?this.options.parameters:Object.toQueryString(this.options.parameters);if(!["get","post"].include(this.method)){a+=(a?"&":"")+"_method="+this.method;this.method="post"}if(a)if(this.method=="get")this.url+=(this.url.include("?")?"&":"?")+a;else if(/Konqueror|Safari|KHTML/.test(navigator.userAgent))a+=
"&_=";this.parameters=a.toQueryParams();try{var b=new Ajax.Response(this);this.options.onCreate&&this.options.onCreate(b);Ajax.Responders.dispatch("onCreate",this,b);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);this.options.asynchronous&&this.respondToReadyState.bind(this).defer(1);this.transport.onreadystatechange=this.onStateChange.bind(this);this.setRequestHeaders();this.body=this.method=="post"?this.options.postBody||a:null;this.transport.send(this.body);!this.options.asynchronous&&
this.transport.overrideMimeType&&this.onStateChange()}catch(c){this.dispatchException(c)}},onStateChange:function(){var a=this.transport.readyState;a>1&&!(a==4&&this._complete)&&this.respondToReadyState(this.transport.readyState)},setRequestHeaders:function(){var a={"X-Requested-With":"XMLHttpRequest","X-Prototype-Version":Prototype.Version,Accept:"text/javascript, text/html, application/xml, text/xml, */*"};if(this.method=="post"){a["Content-type"]=this.options.contentType+(this.options.encoding?
"; charset="+this.options.encoding:"");if(this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005)a.Connection="close"}if(typeof this.options.requestHeaders=="object"){var b=this.options.requestHeaders;if(Object.isFunction(b.push))for(var c=0,e=b.length;c<e;c+=2)a[b[c]]=b[c+1];else $H(b).each(function(h){a[h.key]=h.value})}for(var f in a)this.transport.setRequestHeader(f,a[f])},success:function(){var a=this.getStatus();return!a||a>=200&&a<300},getStatus:function(){try{return this.transport.status||
0}catch(a){return 0}},respondToReadyState:function(a){a=Ajax.Request.Events[a];var b=new Ajax.Response(this);if(a=="Complete"){try{this._complete=true;(this.options["on"+b.status]||this.options["on"+(this.success()?"Success":"Failure")]||Prototype.emptyFunction)(b,b.headerJSON)}catch(c){this.dispatchException(c)}var e=b.getHeader("Content-type");if(this.options.evalJS=="force"||this.options.evalJS&&this.isSameOrigin()&&e&&e.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i))this.evalResponse()}try{(this.options["on"+
a]||Prototype.emptyFunction)(b,b.headerJSON);Ajax.Responders.dispatch("on"+a,this,b,b.headerJSON)}catch(f){this.dispatchException(f)}if(a=="Complete")this.transport.onreadystatechange=Prototype.emptyFunction},isSameOrigin:function(){var a=this.url.match(/^\s*https?:\/\/[^\/]*/);return!a||a[0]=="#{protocol}//#{domain}#{port}".interpolate({protocol:location.protocol,domain:document.domain,port:location.port?":"+location.port:""})},getHeader:function(a){try{return this.transport.getResponseHeader(a)||
null}catch(b){return null}},evalResponse:function(){try{return eval((this.transport.responseText||"").unfilterJSON())}catch(a){this.dispatchException(a)}},dispatchException:function(a){(this.options.onException||Prototype.emptyFunction)(this,a);Ajax.Responders.dispatch("onException",this,a)}});Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"];
Ajax.Response=Class.create({initialize:function(a){this.request=a;a=this.transport=a.transport;var b=this.readyState=a.readyState;if(b>2&&!Prototype.Browser.IE||b==4){this.status=this.getStatus();this.statusText=this.getStatusText();this.responseText=String.interpret(a.responseText);this.headerJSON=this._getHeaderJSON()}if(b==4){a=a.responseXML;this.responseXML=Object.isUndefined(a)?null:a;this.responseJSON=this._getResponseJSON()}},status:0,statusText:"",getStatus:Ajax.Request.prototype.getStatus,
getStatusText:function(){try{return this.transport.statusText||""}catch(a){return""}},getHeader:Ajax.Request.prototype.getHeader,getAllHeaders:function(){try{return this.getAllResponseHeaders()}catch(a){return null}},getResponseHeader:function(a){return this.transport.getResponseHeader(a)},getAllResponseHeaders:function(){return this.transport.getAllResponseHeaders()},_getHeaderJSON:function(){var a=this.getHeader("X-JSON");if(!a)return null;a=decodeURIComponent(escape(a));try{return a.evalJSON(this.request.options.sanitizeJSON||
!this.request.isSameOrigin())}catch(b){this.request.dispatchException(b)}},_getResponseJSON:function(){var a=this.request.options;if(!a.evalJSON||a.evalJSON!="force"&&!(this.getHeader("Content-type")||"").include("application/json")||this.responseText.blank())return null;try{return this.responseText.evalJSON(a.sanitizeJSON||!this.request.isSameOrigin())}catch(b){this.request.dispatchException(b)}}});
Ajax.Updater=Class.create(Ajax.Request,{initialize:function($super,b,c,e){this.container={success:b.success||b,failure:b.failure||(b.success?null:b)};e=Object.clone(e);var f=e.onComplete;e.onComplete=function(h,l){this.updateContent(h.responseText);Object.isFunction(f)&&f(h,l)}.bind(this);$super(c,e)},updateContent:function(a){var b=this.container[this.success()?"success":"failure"],c=this.options;c.evalScripts||(a=a.stripScripts());if(b=$(b))if(c.insertion)if(Object.isString(c.insertion)){var e=
{};e[c.insertion]=a;b.insert(e)}else c.insertion(b,a);else b.update(a)}});
Ajax.PeriodicalUpdater=Class.create(Ajax.Base,{initialize:function($super,b,c,e){$super(e);this.onComplete=this.options.onComplete;this.frequency=this.options.frequency||2;this.decay=this.options.decay||1;this.updater={};this.container=b;this.url=c;this.start()},start:function(){this.options.onComplete=this.updateComplete.bind(this);this.onTimerEvent()},stop:function(){this.updater.options.onComplete=undefined;clearTimeout(this.timer);(this.onComplete||Prototype.emptyFunction).apply(this,arguments)},
updateComplete:function(a){if(this.options.decay){this.decay=a.responseText==this.lastText?this.decay*this.options.decay:1;this.lastText=a.responseText}this.timer=this.onTimerEvent.bind(this).delay(this.decay*this.frequency)},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options)}});
function $(a){if(arguments.length>1){for(var b=0,c=[],e=arguments.length;b<e;b++)c.push($(arguments[b]));return c}if(Object.isString(a))a=document.getElementById(a);return Element.extend(a)}if(Prototype.BrowserFeatures.XPath)document._getElementsByXPath=function(a,b){var c=[];a=document.evaluate(a,$(b)||document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);b=0;for(var e=a.snapshotLength;b<e;b++)c.push(Element.extend(a.snapshotItem(b)));return c};if(!Node)var Node={};
Node.ELEMENT_NODE||Object.extend(Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12});
(function(a){var b=function(){try{var e=document.createElement('<input name="x">');return e.tagName.toLowerCase()==="input"&&e.name==="x"}catch(f){return false}}(),c=a.Element;a.Element=function(e,f){f=f||{};e=e.toLowerCase();var h=Element.cache;if(b&&f.name){e="<"+e+' name="'+f.name+'">';delete f.name;return Element.writeAttribute(document.createElement(e),f)}h[e]||(h[e]=Element.extend(document.createElement(e)));e="type"in f?document.createElement(e):h[e].cloneNode(false);return Element.writeAttribute(e,
f)};Object.extend(a.Element,c||{});if(c)a.Element.prototype=c.prototype})(this);Element.idCounter=1;Element.cache={};Element._purgeElement=function(a){var b=a._prototypeUID;if(b){Element.stopObserving(a);a._prototypeUID=void 0;delete Element.Storage[b]}};
Element.Methods={visible:function(a){return $(a).style.display!="none"},toggle:function(a){a=$(a);Element[Element.visible(a)?"hide":"show"](a);return a},hide:function(a){a=$(a);a.style.display="none";return a},show:function(a){a=$(a);a.style.display="";return a},remove:function(a){a=$(a);a.parentNode.removeChild(a);return a},update:function(){function a(f,h){f=$(f);for(var l=Element._purgeElement,o=f.getElementsByTagName("*"),n=o.length;n--;)l(o[n]);if(h&&h.toElement)h=h.toElement();if(Object.isElement(h))return f.update().insert(h);
h=Object.toHTML(h);l=f.tagName.toUpperCase();if(l==="SCRIPT"&&e){f.text=h;return f}if(b||c)if(l in Element._insertionTranslations.tags){for(;f.firstChild;)f.removeChild(f.firstChild);Element._getContentFromAnonymousElement(l,h.stripScripts()).each(function(p){f.appendChild(p)})}else f.innerHTML=h.stripScripts();else f.innerHTML=h.stripScripts();h.evalScripts.bind(h).defer();return f}var b=function(){var f=document.createElement("select"),h=true;f.innerHTML='<option value="test">test</option>';if(f.options&&
f.options[0])h=f.options[0].nodeName.toUpperCase()!=="OPTION";return h}(),c=function(){try{var f=document.createElement("table");if(f&&f.tBodies){f.innerHTML="<tbody><tr><td>test</td></tr></tbody>";return typeof f.tBodies[0]=="undefined"}}catch(h){return true}}(),e=function(){var f=document.createElement("script"),h=false;try{f.appendChild(document.createTextNode(""));h=!f.firstChild||f.firstChild&&f.firstChild.nodeType!==3}catch(l){h=true}return h}();return a}(),replace:function(a,b){a=$(a);if(b&&
b.toElement)b=b.toElement();else if(!Object.isElement(b)){b=Object.toHTML(b);var c=a.ownerDocument.createRange();c.selectNode(a);b.evalScripts.bind(b).defer();b=c.createContextualFragment(b.stripScripts())}a.parentNode.replaceChild(b,a);return a},insert:function(a,b){a=$(a);if(Object.isString(b)||Object.isNumber(b)||Object.isElement(b)||b&&(b.toElement||b.toHTML))b={bottom:b};var c,e,f;for(var h in b){c=b[h];h=h.toLowerCase();e=Element._insertionTranslations[h];if(c&&c.toElement)c=c.toElement();if(Object.isElement(c))e(a,
c);else{c=Object.toHTML(c);f=(h=="before"||h=="after"?a.parentNode:a).tagName.toUpperCase();f=Element._getContentFromAnonymousElement(f,c.stripScripts());if(h=="top"||h=="after")f.reverse();f.each(e.curry(a));c.evalScripts.bind(c).defer()}}return a},wrap:function(a,b,c){a=$(a);if(Object.isElement(b))$(b).writeAttribute(c||{});else b=Object.isString(b)?new Element(b,c):new Element("div",b);a.parentNode&&a.parentNode.replaceChild(b,a);b.appendChild(a);return b},inspect:function(a){a=$(a);var b="<"+
a.tagName.toLowerCase();$H({id:"id",className:"class"}).each(function(c){var e=c.first();c=c.last();if(e=(a[e]||"").toString())b+=" "+c+"="+e.inspect(true)});return b+">"},recursivelyCollect:function(a,b,c){a=$(a);c=c||-1;for(var e=[];a=a[b];){a.nodeType==1&&e.push(Element.extend(a));if(e.length==c)break}return e},ancestors:function(a){return Element.recursivelyCollect(a,"parentNode")},descendants:function(a){return Element.select(a,"*")},firstDescendant:function(a){for(a=$(a).firstChild;a&&a.nodeType!=
1;)a=a.nextSibling;return $(a)},immediateDescendants:function(a){var b=[];for(a=$(a).firstChild;a;){a.nodeType===1&&b.push(Element.extend(a));a=a.nextSibling}return b},previousSiblings:function(a){return Element.recursivelyCollect(a,"previousSibling")},nextSiblings:function(a){return Element.recursivelyCollect(a,"nextSibling")},siblings:function(a){a=$(a);return Element.previousSiblings(a).reverse().concat(Element.nextSiblings(a))},match:function(a,b){a=$(a);if(Object.isString(b))return Prototype.Selector.match(a,
b);return b.match(a)},up:function(a,b,c){a=$(a);if(arguments.length==1)return $(a.parentNode);var e=Element.ancestors(a);return Object.isNumber(b)?e[b]:Prototype.Selector.find(e,b,c)},down:function(a,b,c){a=$(a);if(arguments.length==1)return Element.firstDescendant(a);return Object.isNumber(b)?Element.descendants(a)[b]:Element.select(a,b)[c||0]},previous:function(a,b,c){a=$(a);if(Object.isNumber(b)){c=b;b=false}Object.isNumber(c)||(c=0);return b?Prototype.Selector.find(a.previousSiblings(),b,c):a.recursivelyCollect("previousSibling",
c+1)[c]},next:function(a,b,c){a=$(a);if(Object.isNumber(b)){c=b;b=false}Object.isNumber(c)||(c=0);if(b)return Prototype.Selector.find(a.nextSiblings(),b,c);else{Object.isNumber(c);return a.recursivelyCollect("nextSibling",c+1)[c]}},select:function(a){a=$(a);var b=Array.prototype.slice.call(arguments,1).join(", ");return Prototype.Selector.select(b,a)},adjacent:function(a){a=$(a);var b=Array.prototype.slice.call(arguments,1).join(", ");return Prototype.Selector.select(b,a.parentNode).without(a)},identify:function(a){a=
$(a);var b=Element.readAttribute(a,"id");if(b)return b;do b="anonymous_element_"+Element.idCounter++;while($(b));Element.writeAttribute(a,"id",b);return b},readAttribute:function(a,b){a=$(a);if(Prototype.Browser.IE){var c=Element._attributeTranslations.read;if(c.values[b])return c.values[b](a,b);if(c.names[b])b=c.names[b];if(b.include(":"))return!a.attributes||!a.attributes[b]?null:a.attributes[b].value}return a.getAttribute(b)},writeAttribute:function(a,b,c){a=$(a);var e={},f=Element._attributeTranslations.write;
if(typeof b=="object")e=b;else e[b]=Object.isUndefined(c)?true:c;for(var h in e){b=f.names[h]||h;c=e[h];if(f.values[h])b=f.values[h](a,c);if(c===false||c===null)a.removeAttribute(b);else c===true?a.setAttribute(b,b):a.setAttribute(b,c)}return a},getHeight:function(a){return Element.getDimensions(a).height},getWidth:function(a){return Element.getDimensions(a).width},classNames:function(a){return new Element.ClassNames(a)},hasClassName:function(a,b){if(a=$(a)){a=a.className;return a.length>0&&(a==b||
(new RegExp("(^|\\s)"+b+"(\\s|$)")).test(a))}},addClassName:function(a,b){if(a=$(a)){Element.hasClassName(a,b)||(a.className+=(a.className?" ":"")+b);return a}},removeClassName:function(a,b){if(a=$(a)){a.className=a.className.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)")," ").strip();return a}},toggleClassName:function(a,b){if(a=$(a))return Element[Element.hasClassName(a,b)?"removeClassName":"addClassName"](a,b)},cleanWhitespace:function(a){a=$(a);for(var b=a.firstChild;b;){var c=b.nextSibling;b.nodeType==
3&&!/\S/.test(b.nodeValue)&&a.removeChild(b);b=c}return a},empty:function(a){return $(a).innerHTML.blank()},descendantOf:function(a,b){a=$(a);b=$(b);if(a.compareDocumentPosition)return(a.compareDocumentPosition(b)&8)===8;if(b.contains)return b.contains(a)&&b!==a;for(;a=a.parentNode;)if(a==b)return true;return false},scrollTo:function(a){a=$(a);var b=Element.cumulativeOffset(a);window.scrollTo(b[0],b[1]);return a},getStyle:function(a,b){a=$(a);b=b=="float"?"cssFloat":b.camelize();var c=a.style[b];
if(!c||c=="auto")c=(a=document.defaultView.getComputedStyle(a,null))?a[b]:null;if(b=="opacity")return c?parseFloat(c):1;return c=="auto"?null:c},getOpacity:function(a){return $(a).getStyle("opacity")},setStyle:function(a,b){a=$(a);var c=a.style;if(Object.isString(b)){a.style.cssText+=";"+b;return b.include("opacity")?a.setOpacity(b.match(/opacity:\s*(\d?\.?\d*)/)[1]):a}for(var e in b)if(e=="opacity")a.setOpacity(b[e]);else c[e=="float"||e=="cssFloat"?Object.isUndefined(c.styleFloat)?"cssFloat":"styleFloat":
e]=b[e];return a},setOpacity:function(a,b){a=$(a);a.style.opacity=b==1||b===""?"":b<1.0E-5?0:b;return a},makePositioned:function(a){a=$(a);var b=Element.getStyle(a,"position");if(b=="static"||!b){a._madePositioned=true;a.style.position="relative";if(Prototype.Browser.Opera){a.style.top=0;a.style.left=0}}return a},undoPositioned:function(a){a=$(a);if(a._madePositioned){a._madePositioned=undefined;a.style.position=a.style.top=a.style.left=a.style.bottom=a.style.right=""}return a},makeClipping:function(a){a=
$(a);if(a._overflow)return a;a._overflow=Element.getStyle(a,"overflow")||"auto";if(a._overflow!=="hidden")a.style.overflow="hidden";return a},undoClipping:function(a){a=$(a);if(!a._overflow)return a;a.style.overflow=a._overflow=="auto"?"":a._overflow;a._overflow=null;return a},clonePosition:function(a,b,c){c=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},c||{});b=$(b);var e=Element.viewportOffset(b),f=[0,0],h=null;a=$(a);if(Element.getStyle(a,"position")==
"absolute"){h=Element.getOffsetParent(a);f=Element.viewportOffset(h)}if(h==document.body){f[0]-=document.body.offsetLeft;f[1]-=document.body.offsetTop}if(c.setLeft)a.style.left=e[0]-f[0]+c.offsetLeft+"px";if(c.setTop)a.style.top=e[1]-f[1]+c.offsetTop+"px";if(c.setWidth)a.style.width=b.offsetWidth+"px";if(c.setHeight)a.style.height=b.offsetHeight+"px";return a}};Object.extend(Element.Methods,{getElementsBySelector:Element.Methods.select,childElements:Element.Methods.immediateDescendants});
Element._attributeTranslations={write:{names:{className:"class",htmlFor:"for"},values:{}}};
if(Prototype.Browser.Opera){Element.Methods.getStyle=Element.Methods.getStyle.wrap(function(a,b,c){switch(c){case "left":case "top":case "right":case "bottom":if(a(b,"position")==="static")return null;case "height":case "width":if(!Element.visible(b))return null;var e=parseInt(a(b,c),10);if(e!==b["offset"+c.capitalize()])return e+"px";return(c==="height"?["border-top-width","padding-top","padding-bottom","border-bottom-width"]:["border-left-width","padding-left","padding-right","border-right-width"]).inject(e,
function(f,h){h=a(b,h);return h===null?f:f-parseInt(h,10)})+"px";default:return a(b,c)}});Element.Methods.readAttribute=Element.Methods.readAttribute.wrap(function(a,b,c){if(c==="title")return b.title;return a(b,c)})}else if(Prototype.Browser.IE){Element.Methods.getStyle=function(a,b){a=$(a);b=b=="float"||b=="cssFloat"?"styleFloat":b.camelize();var c=a.style[b];if(!c&&a.currentStyle)c=a.currentStyle[b];if(b=="opacity"){if(c=(a.getStyle("filter")||"").match(/alpha\(opacity=(.*)\)/))if(c[1])return parseFloat(c[1])/
100;return 1}if(c=="auto"){if((b=="width"||b=="height")&&a.getStyle("display")!="none")return a["offset"+b.capitalize()]+"px";return null}return c};Element.Methods.setOpacity=function(a,b){function c(h){return h.replace(/alpha\([^\)]*\)/gi,"")}a=$(a);var e=a.currentStyle;if(e&&!e.hasLayout||!e&&a.style.zoom=="normal")a.style.zoom=1;e=a.getStyle("filter");var f=a.style;if(b==1||b===""){(e=c(e))?(f.filter=e):f.removeAttribute("filter");return a}else if(b<1.0E-5)b=0;f.filter=c(e)+"alpha(opacity="+b*
100+")";return a};Element._attributeTranslations=function(){var a="className",b="for",c=document.createElement("div");c.setAttribute(a,"x");if(c.className!=="x"){c.setAttribute("class","x");if(c.className==="x")a="class"}c=null;c=document.createElement("label");c.setAttribute(b,"x");if(c.htmlFor!=="x"){c.setAttribute("htmlFor","x");if(c.htmlFor==="x")b="htmlFor"}c=null;return{read:{names:{"class":a,className:a,"for":b,htmlFor:b},values:{_getAttr:function(e,f){return e.getAttribute(f)},_getAttr2:function(e,
f){return e.getAttribute(f,2)},_getAttrNode:function(e,f){return(e=e.getAttributeNode(f))?e.value:""},_getEv:function(){var e=document.createElement("div"),f;e.onclick=Prototype.emptyFunction;e=e.getAttribute("onclick");if(String(e).indexOf("{")>-1)f=function(h,l){l=h.getAttribute(l);if(!l)return null;l=l.toString();l=l.split("{")[1];l=l.split("}")[0];return l.strip()};else if(e==="")f=function(h,l){l=h.getAttribute(l);if(!l)return null;return l.strip()};e=null;return f}(),_flag:function(e,f){return $(e).hasAttribute(f)?
f:null},style:function(e){return e.style.cssText.toLowerCase()},title:function(e){return e.title}}}}}();Element._attributeTranslations.write={names:Object.extend({cellpadding:"cellPadding",cellspacing:"cellSpacing"},Element._attributeTranslations.read.names),values:{checked:function(a,b){a.checked=!!b},style:function(a,b){a.style.cssText=b?b:""}}};Element._attributeTranslations.has={};$w("colSpan rowSpan vAlign dateTime accessKey tabIndex encType maxLength readOnly longDesc frameBorder").each(function(a){Element._attributeTranslations.write.names[a.toLowerCase()]=
a;Element._attributeTranslations.has[a.toLowerCase()]=a});(function(a){Object.extend(a,{href:a._getAttr2,src:a._getAttr2,type:a._getAttr,action:a._getAttrNode,disabled:a._flag,checked:a._flag,readonly:a._flag,multiple:a._flag,onload:a._getEv,onunload:a._getEv,onclick:a._getEv,ondblclick:a._getEv,onmousedown:a._getEv,onmouseup:a._getEv,onmouseover:a._getEv,onmousemove:a._getEv,onmouseout:a._getEv,onfocus:a._getEv,onblur:a._getEv,onkeypress:a._getEv,onkeydown:a._getEv,onkeyup:a._getEv,onsubmit:a._getEv,
onreset:a._getEv,onselect:a._getEv,onchange:a._getEv})})(Element._attributeTranslations.read.values);Prototype.BrowserFeatures.ElementExtensions&&function(){function a(b){b=b.getElementsByTagName("*");for(var c=[],e=0,f;f=b[e];e++)f.tagName!=="!"&&c.push(f);return c}Element.Methods.down=function(b,c,e){b=$(b);if(arguments.length==1)return b.firstDescendant();return Object.isNumber(c)?a(b)[c]:Element.select(b,c)[e||0]}}()}else if(Prototype.Browser.Gecko&&/rv:1\.8\.0/.test(navigator.userAgent))Element.Methods.setOpacity=
function(a,b){a=$(a);a.style.opacity=b==1?0.999999:b===""?"":b<1.0E-5?0:b;return a};else if(Prototype.Browser.WebKit)Element.Methods.setOpacity=function(a,b){a=$(a);a.style.opacity=b==1||b===""?"":b<1.0E-5?0:b;if(b==1)if(a.tagName.toUpperCase()=="IMG"&&a.width){a.width++;a.width--}else try{var c=document.createTextNode(" ");a.appendChild(c);a.removeChild(c)}catch(e){}return a};
if("outerHTML"in document.documentElement)Element.Methods.replace=function(a,b){a=$(a);if(b&&b.toElement)b=b.toElement();if(Object.isElement(b)){a.parentNode.replaceChild(b,a);return a}b=Object.toHTML(b);var c=a.parentNode,e=c.tagName.toUpperCase();if(Element._insertionTranslations.tags[e]){var f=a.next();e=Element._getContentFromAnonymousElement(e,b.stripScripts());c.removeChild(a);f?e.each(function(h){c.insertBefore(h,f)}):e.each(function(h){c.appendChild(h)})}else a.outerHTML=b.stripScripts();
b.evalScripts.bind(b).defer();return a};Element._returnOffset=function(a,b){var c=[a,b];c.left=a;c.top=b;return c};Element._getContentFromAnonymousElement=function(a,b){var c=new Element("div");if(a=Element._insertionTranslations.tags[a]){c.innerHTML=a[0]+b+a[1];for(b=a[2];b--;)c=c.firstChild}else c.innerHTML=b;return $A(c.childNodes)};
Element._insertionTranslations={before:function(a,b){a.parentNode.insertBefore(b,a)},top:function(a,b){a.insertBefore(b,a.firstChild)},bottom:function(a,b){a.appendChild(b)},after:function(a,b){a.parentNode.insertBefore(b,a.nextSibling)},tags:{TABLE:["<table>","</table>",1],TBODY:["<table><tbody>","</tbody></table>",2],TR:["<table><tbody><tr>","</tr></tbody></table>",3],TD:["<table><tbody><tr><td>","</td></tr></tbody></table>",4],SELECT:["<select>","</select>",1]}};
(function(){var a=Element._insertionTranslations.tags;Object.extend(a,{THEAD:a.TBODY,TFOOT:a.TBODY,TH:a.TD})})();Element.Methods.Simulated={hasAttribute:function(a,b){b=Element._attributeTranslations.has[b]||b;a=$(a).getAttributeNode(b);return!!(a&&a.specified)}};Element.Methods.ByTag={};Object.extend(Element,Element.Methods);
(function(a){if(!Prototype.BrowserFeatures.ElementExtensions&&a.__proto__){window.HTMLElement={};window.HTMLElement.prototype=a.__proto__;Prototype.BrowserFeatures.ElementExtensions=true}})(document.createElement("div"));
Element.extend=function(){function a(h){if(typeof window.Element!="undefined"){var l=window.Element.prototype;if(l){var o="_"+(Math.random()+"").slice(2);h=document.createElement(h);l[o]="x";h=h[o]!=="x";delete l[o];return h}}return false}function b(h,l){for(var o in l){var n=l[o];if(Object.isFunction(n)&&!(o in h))h[o]=n.methodize()}}var c=a("object");if(Prototype.BrowserFeatures.SpecificElementExtensions){if(c)return function(h){if(h&&typeof h._extendedByPrototype=="undefined"){var l=h.tagName;
if(l&&/^(?:object|applet|embed)$/i.test(l)){b(h,Element.Methods);b(h,Element.Methods.Simulated);b(h,Element.Methods.ByTag[l.toUpperCase()])}}return h};return Prototype.K}var e={},f=Element.Methods.ByTag;c=Object.extend(function(h){if(!h||typeof h._extendedByPrototype!="undefined"||h.nodeType!=1||h==window)return h;var l=Object.clone(e),o=h.tagName.toUpperCase();f[o]&&Object.extend(l,f[o]);b(h,l);h._extendedByPrototype=Prototype.emptyFunction;return h},{refresh:function(){if(!Prototype.BrowserFeatures.ElementExtensions){Object.extend(e,
Element.Methods);Object.extend(e,Element.Methods.Simulated)}}});c.refresh();return c}();Element.hasAttribute=document.documentElement.hasAttribute?function(a,b){return a.hasAttribute(b)}:Element.Methods.Simulated.hasAttribute;
Element.addMethods=function(a){function b(n){n=n.toUpperCase();Element.Methods.ByTag[n]||(Element.Methods.ByTag[n]={});Object.extend(Element.Methods.ByTag[n],a)}function c(n,p,y){y=y||false;for(var m in n){var v=n[m];if(Object.isFunction(v))if(!y||!(m in p))p[m]=v.methodize()}}function e(n){var p,y={OPTGROUP:"OptGroup",TEXTAREA:"TextArea",P:"Paragraph",FIELDSET:"FieldSet",UL:"UList",OL:"OList",DL:"DList",DIR:"Directory",H1:"Heading",H2:"Heading",H3:"Heading",H4:"Heading",H5:"Heading",H6:"Heading",
Q:"Quote",INS:"Mod",DEL:"Mod",A:"Anchor",IMG:"Image",CAPTION:"TableCaption",COL:"TableCol",COLGROUP:"TableCol",THEAD:"TableSection",TFOOT:"TableSection",TBODY:"TableSection",TR:"TableRow",TH:"TableCell",TD:"TableCell",FRAMESET:"FrameSet",IFRAME:"IFrame"};if(y[n])p="HTML"+y[n]+"Element";if(window[p])return window[p];p="HTML"+n+"Element";if(window[p])return window[p];p="HTML"+n.capitalize()+"Element";if(window[p])return window[p];n=document.createElement(n);return n.__proto__||n.constructor.prototype}
var f=Prototype.BrowserFeatures,h=Element.Methods.ByTag;if(!a){Object.extend(Form,Form.Methods);Object.extend(Form.Element,Form.Element.Methods);Object.extend(Element.Methods.ByTag,{FORM:Object.clone(Form.Methods),INPUT:Object.clone(Form.Element.Methods),SELECT:Object.clone(Form.Element.Methods),TEXTAREA:Object.clone(Form.Element.Methods)})}if(arguments.length==2){var l=a;a=arguments[1]}if(l)Object.isArray(l)?l.each(b):b(l);else Object.extend(Element.Methods,a||{});l=window.HTMLElement?HTMLElement.prototype:
Element.prototype;if(f.ElementExtensions){c(Element.Methods,l);c(Element.Methods.Simulated,l,true)}if(f.SpecificElementExtensions)for(var o in Element.Methods.ByTag){f=e(o);Object.isUndefined(f)||c(h[o],f.prototype)}Object.extend(Element,Element.Methods);delete Element.ByTag;Element.extend.refresh&&Element.extend.refresh();Element.cache={}};
document.viewport={getDimensions:function(){return{width:this.getWidth(),height:this.getHeight()}},getScrollOffsets:function(){return Element._returnOffset(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)}};
(function(a){function b(){if(e.WebKit&&!f.evaluate)return document;if(e.Opera&&window.parseFloat(window.opera.version())<9.5)return document.body;return document.documentElement}function c(o){h||(h=b());l[o]="client"+o;a["get"+o]=function(){return h[l[o]]};return a["get"+o]()}var e=Prototype.Browser,f=document,h,l={};a.getWidth=c.curry("Width");a.getHeight=c.curry("Height")})(document.viewport);Element.Storage={UID:1};
Element.addMethods({getStorage:function(a){if(a=$(a)){if(a===window)a=0;else{if(typeof a._prototypeUID==="undefined")a._prototypeUID=Element.Storage.UID++;a=a._prototypeUID}Element.Storage[a]||(Element.Storage[a]=$H());return Element.Storage[a]}},store:function(a,b,c){if(a=$(a)){arguments.length===2?Element.getStorage(a).update(b):Element.getStorage(a).set(b,c);return a}},retrieve:function(a,b,c){if(a=$(a)){a=Element.getStorage(a);var e=a.get(b);if(Object.isUndefined(e)){a.set(b,c);e=c}return e}},
clone:function(a,b){if(a=$(a)){a=a.cloneNode(b);a._prototypeUID=void 0;if(b){b=Element.select(a,"*");for(var c=b.length;c--;)b[c]._prototypeUID=void 0}return Element.extend(a)}},purge:function(a){if(a=$(a)){var b=Element._purgeElement;b(a);a=a.getElementsByTagName("*");for(var c=a.length;c--;)b(a[c]);return null}}});
(function(){function a(g){g=g.match(/^(\d+)%?$/i);if(!g)return null;return Number(g[1])/100}function b(g,j,q){var t=null;if(Object.isElement(g)){t=g;g=t.getStyle(j)}if(g===null)return null;if(/^(?:-)?\d+(\.\d+)?(px)?$/i.test(g))return window.parseFloat(g);var w=g.include("%"),r=q===document.viewport;if(/\d/.test(g)&&t&&t.runtimeStyle&&!(w&&r)){q=t.style.left;j=t.runtimeStyle.left;t.runtimeStyle.left=t.currentStyle.left;t.style.left=g||0;g=t.style.pixelLeft;t.style.left=q;t.runtimeStyle.left=j;return g}if(t&&
w){q=q||t.parentNode;g=a(g);w=null;t.getStyle("position");t=j.include("left")||j.include("right")||j.include("width");j=j.include("top")||j.include("bottom")||j.include("height");if(q===document.viewport)if(t)w=document.viewport.getWidth();else{if(j)w=document.viewport.getHeight()}else if(t)w=$(q).measure("width");else if(j)w=$(q).measure("height");return w===null?0:w*g}return 0}function c(g){for(;g&&g.parentNode;){if(g.getStyle("display")==="none")return false;g=$(g.parentNode)}return true}function e(g){if(g.include("border"))g+=
"-width";return g.camelize()}function f(g,j){return new Element.Layout(g,j)}function h(g,j){return $(g).getLayout().get(j)}function l(g){g=$(g);var j=Element.getStyle(g,"display");if(j&&j!=="none")return{width:g.offsetWidth,height:g.offsetHeight};j=g.style;j={visibility:j.visibility,position:j.position,display:j.display};var q={visibility:"hidden",display:"block"};if(j.position!=="fixed")q.position="absolute";Element.setStyle(g,q);q={width:g.offsetWidth,height:g.offsetHeight};Element.setStyle(g,j);
return q}function o(g){if(s(g))return $(document.body);if(Element.getStyle(g,"display")!=="inline"&&g.offsetParent)return $(g.offsetParent);if(g===document.body)return $(g);for(;(g=g.parentNode)&&g!==document.body;)if(Element.getStyle(g,"position")!=="static")return g.nodeName==="HTML"?$(document.body):$(g);return $(document.body)}function n(g){var j=0,q=0;if(g.parentNode){do{j+=g.offsetTop||0;q+=g.offsetLeft||0;g=g.offsetParent}while(g)}return new Element.Offset(q,j)}function p(g){var j=g.getLayout(),
q=0,t=0;do{q+=g.offsetTop||0;t+=g.offsetLeft||0;if(g=g.offsetParent){if(B(g))break;if(Element.getStyle(g,"position")!=="static")break}}while(g);t-=j.get("margin-top");q-=j.get("margin-left");return new Element.Offset(t,q)}function y(g){var j=0,q=0;do{j+=g.scrollTop||0;q+=g.scrollLeft||0;g=g.parentNode}while(g);return new Element.Offset(q,j)}function m(g){var j=0,q=0,t=document.body,w=g;do{j+=w.offsetTop||0;q+=w.offsetLeft||0;if(w.offsetParent==t&&Element.getStyle(w,"position")=="absolute")break}while(w=
w.offsetParent);w=g;do if(w!=t){j-=w.scrollTop||0;q-=w.scrollLeft||0}while(w=w.parentNode);return new Element.Offset(q,j)}function v(g){g=$(g);if(Element.getStyle(g,"position")==="absolute")return g;var j=o(g),q=g.viewportOffset();j=j.viewportOffset();q=q.relativeTo(j);j=g.getLayout();g.store("prototype_absolutize_original_styles",{left:g.getStyle("left"),top:g.getStyle("top"),width:g.getStyle("width"),height:g.getStyle("height")});g.setStyle({position:"absolute",top:q.top+"px",left:q.left+"px",width:j.get("width")+
"px",height:j.get("height")+"px"});return g}function A(g){g=$(g);if(Element.getStyle(g,"position")==="relative")return g;var j=g.retrieve("prototype_absolutize_original_styles");j&&g.setStyle(j);return g}function B(g){return g.nodeName.toUpperCase()==="BODY"}function s(g){return g!==document.body&&!Element.descendantOf(g,document.body)}var F=Prototype.K;if("currentStyle"in document.documentElement)F=function(g){if(!g.currentStyle.hasLayout)g.style.zoom=1;return g};Element.Layout=Class.create(Hash,
{initialize:function($super,j,q){$super();this.element=$(j);Element.Layout.PROPERTIES.each(function(t){this._set(t,null)},this);if(q){this._preComputing=true;this._begin();Element.Layout.PROPERTIES.each(this._compute,this);this._end();this._preComputing=false}},_set:function(g,j){return Hash.prototype.set.call(this,g,j)},set:function(){throw"Properties of Element.Layout are read-only.";},get:function($super,j){var q=$super(j);return q===null?this._compute(j):q},_begin:function(){if(!this._prepared){var g=
this.element;if(!c(g)){g.store("prototype_original_styles",{position:g.style.position||"",width:g.style.width||"",visibility:g.style.visibility||"",display:g.style.display||""});var j=g.getStyle("position"),q=g.getStyle("width"),t=j==="fixed"?document.viewport:g.parentNode;g.setStyle({position:"absolute",visibility:"hidden",display:"block"});var w=g.getStyle("width");j=q&&w===q?b(g,"width",t):j==="absolute"||j==="fixed"?b(g,"width",t):$(g.parentNode).getLayout().get("width")-this.get("margin-left")-
this.get("border-left")-this.get("padding-left")-this.get("padding-right")-this.get("border-right")-this.get("margin-right");g.setStyle({width:j+"px"})}this._prepared=true}},_end:function(){var g=this.element,j=g.retrieve("prototype_original_styles");g.store("prototype_original_styles",null);g.setStyle(j);this._prepared=false},_compute:function(g){var j=Element.Layout.COMPUTATIONS;if(!(g in j))throw"Property not found.";return this._set(g,j[g].call(this,this.element))},toObject:function(){var g=$A(arguments),
j={};(g.length===0?Element.Layout.PROPERTIES:g.join(" ").split(" ")).each(function(q){if(Element.Layout.PROPERTIES.include(q)){var t=this.get(q);if(t!=null)j[q]=t}},this);return j},toHash:function(){var g=this.toObject.apply(this,arguments);return new Hash(g)},toCSS:function(){var g=$A(arguments),j={};(g.length===0?Element.Layout.PROPERTIES:g.join(" ").split(" ")).each(function(q){if(Element.Layout.PROPERTIES.include(q))if(!Element.Layout.COMPOSITE_PROPERTIES.include(q)){var t=this.get(q);if(t!=null)j[e(q)]=
t+"px"}},this);return j},inspect:function(){return"#<Element.Layout>"}});Object.extend(Element.Layout,{PROPERTIES:$w("height width top left right bottom border-left border-right border-top border-bottom padding-left padding-right padding-top padding-bottom margin-top margin-bottom margin-left margin-right padding-box-width padding-box-height border-box-width border-box-height margin-box-width margin-box-height"),COMPOSITE_PROPERTIES:$w("padding-box-width padding-box-height margin-box-width margin-box-height border-box-width border-box-height"),
COMPUTATIONS:{height:function(){this._preComputing||this._begin();var g=this.get("border-box-height");if(g<=0){this._preComputing||this._end();return 0}var j=this.get("border-top"),q=this.get("border-bottom"),t=this.get("padding-top"),w=this.get("padding-bottom");this._preComputing||this._end();return g-j-q-t-w},width:function(){this._preComputing||this._begin();var g=this.get("border-box-width");if(g<=0){this._preComputing||this._end();return 0}var j=this.get("border-left"),q=this.get("border-right"),
t=this.get("padding-left"),w=this.get("padding-right");this._preComputing||this._end();return g-j-q-t-w},"padding-box-height":function(){var g=this.get("height"),j=this.get("padding-top"),q=this.get("padding-bottom");return g+j+q},"padding-box-width":function(){var g=this.get("width"),j=this.get("padding-left"),q=this.get("padding-right");return g+j+q},"border-box-height":function(g){this._preComputing||this._begin();g=g.offsetHeight;this._preComputing||this._end();return g},"border-box-width":function(g){this._preComputing||
this._begin();g=g.offsetWidth;this._preComputing||this._end();return g},"margin-box-height":function(){var g=this.get("border-box-height"),j=this.get("margin-top"),q=this.get("margin-bottom");if(g<=0)return 0;return g+j+q},"margin-box-width":function(){var g=this.get("border-box-width"),j=this.get("margin-left"),q=this.get("margin-right");if(g<=0)return 0;return g+j+q},top:function(g){return g.positionedOffset().top},bottom:function(g){var j=g.positionedOffset();g=g.getOffsetParent().measure("height");
var q=this.get("border-box-height");return g-q-j.top},left:function(g){return g.positionedOffset().left},right:function(g){var j=g.positionedOffset();g=g.getOffsetParent().measure("width");var q=this.get("border-box-width");return g-q-j.left},"padding-top":function(g){return b(g,"paddingTop")},"padding-bottom":function(g){return b(g,"paddingBottom")},"padding-left":function(g){return b(g,"paddingLeft")},"padding-right":function(g){return b(g,"paddingRight")},"border-top":function(g){return b(g,"borderTopWidth")},
"border-bottom":function(g){return b(g,"borderBottomWidth")},"border-left":function(g){return b(g,"borderLeftWidth")},"border-right":function(g){return b(g,"borderRightWidth")},"margin-top":function(g){return b(g,"marginTop")},"margin-bottom":function(g){return b(g,"marginBottom")},"margin-left":function(g){return b(g,"marginLeft")},"margin-right":function(g){return b(g,"marginRight")}}});"getBoundingClientRect"in document.documentElement&&Object.extend(Element.Layout.COMPUTATIONS,{right:function(g){var j=
F(g.getOffsetParent());g=g.getBoundingClientRect();return(j.getBoundingClientRect().right-g.right).round()},bottom:function(g){var j=F(g.getOffsetParent());g=g.getBoundingClientRect();return(j.getBoundingClientRect().bottom-g.bottom).round()}});Element.Offset=Class.create({initialize:function(g,j){this.left=g.round();this.top=j.round();this[0]=this.left;this[1]=this.top},relativeTo:function(g){return new Element.Offset(this.left-g.left,this.top-g.top)},inspect:function(){return"#<Element.Offset left: #{left} top: #{top}>".interpolate(this)},
toString:function(){return"[#{left}, #{top}]".interpolate(this)},toArray:function(){return[this.left,this.top]}});if(Prototype.Browser.IE){o=o.wrap(function(g,j){j=$(j);if(s(j))return $(document.body);var q=j.getStyle("position");if(q!=="static")return g(j);j.setStyle({position:"relative"});g=g(j);j.setStyle({position:q});return g});p=p.wrap(function(g,j){j=$(j);if(!j.parentNode)return new Element.Offset(0,0);var q=j.getStyle("position");if(q!=="static")return g(j);var t=j.getOffsetParent();t&&t.getStyle("position")===
"fixed"&&F(t);j.setStyle({position:"relative"});g=g(j);j.setStyle({position:q});return g})}else if(Prototype.Browser.Webkit)n=function(g){var j=0,q=0;do{j+=g.offsetTop||0;q+=g.offsetLeft||0;if(g.offsetParent==document.body)if(Element.getStyle(g,"position")=="absolute")break;g=g.offsetParent}while(g);return new Element.Offset(q,j)};Element.addMethods({getLayout:f,measure:h,getDimensions:l,getOffsetParent:o,cumulativeOffset:n,positionedOffset:p,cumulativeScrollOffset:y,viewportOffset:m,absolutize:v,
relativize:A});"getBoundingClientRect"in document.documentElement&&Element.addMethods({viewportOffset:function(g){g=$(g);if(s(g))return new Element.Offset(0,0);g=g.getBoundingClientRect();var j=document.documentElement;return new Element.Offset(g.left-j.clientLeft,g.top-j.clientTop)}})})();window.$$=function(){var a=$A(arguments).join(", ");return Prototype.Selector.select(a,document)};
Prototype.Selector=function(){function a(){throw new Error('Method "Prototype.Selector.select" must be defined.');}function b(){throw new Error('Method "Prototype.Selector.match" must be defined.');}function c(h,l,o){o=o||0;var n=Prototype.Selector.match,p=h.length,y=0,m;for(m=0;m<p;m++)if(n(h[m],l)&&o==y++)return Element.extend(h[m])}function e(h){for(var l=0,o=h.length;l<o;l++)Element.extend(h[l]);return h}var f=Prototype.K;return{select:a,match:b,find:c,extendElements:Element.extend===f?f:e,extendElement:Element.extend}}();
Prototype._original_property=window.Sizzle;
(function(){function a(g,j,q,t,w,r){w=g=="previousSibling"&&!r;for(var z=0,H=t.length;z<H;z++){var u=t[z];if(u){if(w&&u.nodeType===1){u.sizcache=q;u.sizset=z}u=u[g];for(var C=false;u;){if(u.sizcache===q){C=t[u.sizset];break}if(u.nodeType===1&&!r){u.sizcache=q;u.sizset=z}if(u.nodeName===j){C=u;break}u=u[g]}t[z]=C}}}function b(g,j,q,t,w,r){w=g=="previousSibling"&&!r;for(var z=0,H=t.length;z<H;z++){var u=t[z];if(u){if(w&&u.nodeType===1){u.sizcache=q;u.sizset=z}u=u[g];for(var C=false;u;){if(u.sizcache===
q){C=t[u.sizset];break}if(u.nodeType===1){if(!r){u.sizcache=q;u.sizset=z}if(typeof j!=="string"){if(u===j){C=true;break}}else if(o.filter(j,[u]).length>0){C=u;break}}u=u[g]}t[z]=C}}}var c=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,e=0,f=Object.prototype.toString,h=false,l=true;[0,0].sort(function(){l=false;return 0});var o=function(g,j,q,t){q=q||[];var w=j=j||document;if(j.nodeType!==1&&j.nodeType!==9)return[];
if(!g||typeof g!=="string")return q;for(var r=[],z,H,u,C,L=true,T=s(j),E=g;(c.exec(""),z=c.exec(E))!==null;){E=z[3];r.push(z[1]);if(z[2]){C=z[3];break}}if(r.length>1&&p.exec(g))if(r.length===2&&n.relative[r[0]])H=F(r[0]+r[1],j);else for(H=n.relative[r[0]]?[j]:o(r.shift(),j);r.length;){g=r.shift();if(n.relative[g])g+=r.shift();H=F(g,H)}else{if(!t&&r.length>1&&j.nodeType===9&&!T&&n.match.ID.test(r[0])&&!n.match.ID.test(r[r.length-1])){z=o.find(r.shift(),j,T);j=z.expr?o.filter(z.expr,z.set)[0]:z.set[0]}if(j){z=
t?{expr:r.pop(),set:m(t)}:o.find(r.pop(),r.length===1&&(r[0]==="~"||r[0]==="+")&&j.parentNode?j.parentNode:j,T);H=z.expr?o.filter(z.expr,z.set):z.set;if(r.length>0)u=m(H);else L=false;for(;r.length;){var S=r.pop();z=S;if(n.relative[S])z=r.pop();else S="";if(z==null)z=j;n.relative[S](u,z,T)}}else u=[]}u||(u=H);if(!u)throw"Syntax error, unrecognized expression: "+(S||g);if(f.call(u)==="[object Array]")if(L)if(j&&j.nodeType===1)for(g=0;u[g]!=null;g++){if(u[g]&&(u[g]===true||u[g].nodeType===1&&B(j,u[g])))q.push(H[g])}else for(g=
0;u[g]!=null;g++)u[g]&&u[g].nodeType===1&&q.push(H[g]);else q.push.apply(q,u);else m(u,q);if(C){o(C,w,q,t);o.uniqueSort(q)}return q};o.uniqueSort=function(g){if(A){h=l;g.sort(A);if(h)for(var j=1;j<g.length;j++)g[j]===g[j-1]&&g.splice(j--,1)}return g};o.matches=function(g,j){return o(g,null,null,j)};o.find=function(g,j,q){var t,w;if(!g)return[];for(var r=0,z=n.order.length;r<z;r++){var H=n.order[r];if(w=n.leftMatch[H].exec(g)){var u=w[1];w.splice(1,1);if(u.substr(u.length-1)!=="\\"){w[1]=(w[1]||"").replace(/\\/g,
"");t=n.find[H](w,j,q);if(t!=null){g=g.replace(n.match[H],"");break}}}}t||(t=j.getElementsByTagName("*"));return{set:t,expr:g}};o.filter=function(g,j,q,t){for(var w=g,r=[],z=j,H,u,C=j&&j[0]&&s(j[0]);g&&j.length;){for(var L in n.filter)if((H=n.match[L].exec(g))!=null){var T=n.filter[L],E,S;u=false;if(z==r)r=[];if(n.preFilter[L])if(H=n.preFilter[L](H,z,q,r,t,C)){if(H===true)continue}else u=E=true;if(H)for(var J=0;(S=z[J])!=null;J++)if(S){E=T(S,H,J,z);var I=t^!!E;if(q&&E!=null)if(I)u=true;else z[J]=
false;else if(I){r.push(S);u=true}}if(E!==undefined){q||(z=r);g=g.replace(n.match[L],"");if(!u)return[];break}}if(g==w)if(u==null)throw"Syntax error, unrecognized expression: "+g;else break;w=g}return z};var n=o.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*-]|\\.)+)/,
CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF-]|\\.)+)(?:\((['"]*)((?:\([^\)]+\)|[^\2\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(g){return g.getAttribute("href")}},relative:{"+":function(g,j,q){var t=typeof j==="string",w=t&&!/\W/.test(j);t=t&&!w;if(w&&!q)j=j.toUpperCase();q=0;w=g.length;for(var r;q<w;q++)if(r=g[q]){for(;(r=r.previousSibling)&&
r.nodeType!==1;);g[q]=t||r&&r.nodeName===j?r||false:r===j}t&&o.filter(j,g,true)},">":function(g,j,q){var t=typeof j==="string";if(t&&!/\W/.test(j)){j=q?j:j.toUpperCase();q=0;for(var w=g.length;q<w;q++){var r=g[q];if(r){t=r.parentNode;g[q]=t.nodeName===j?t:false}}}else{q=0;for(w=g.length;q<w;q++)if(r=g[q])g[q]=t?r.parentNode:r.parentNode===j;t&&o.filter(j,g,true)}},"":function(g,j,q){var t=e++,w=b;if(!/\W/.test(j)){var r=j=q?j:j.toUpperCase();w=a}w("parentNode",j,t,g,r,q)},"~":function(g,j,q){var t=
e++,w=b;if(typeof j==="string"&&!/\W/.test(j)){var r=j=q?j:j.toUpperCase();w=a}w("previousSibling",j,t,g,r,q)}},find:{ID:function(g,j,q){if(typeof j.getElementById!=="undefined"&&!q)return(g=j.getElementById(g[1]))?[g]:[]},NAME:function(g,j){if(typeof j.getElementsByName!=="undefined"){var q=[];j=j.getElementsByName(g[1]);for(var t=0,w=j.length;t<w;t++)j[t].getAttribute("name")===g[1]&&q.push(j[t]);return q.length===0?null:q}},TAG:function(g,j){return j.getElementsByTagName(g[1])}},preFilter:{CLASS:function(g,
j,q,t,w,r){g=" "+g[1].replace(/\\/g,"")+" ";if(r)return g;r=0;for(var z;(z=j[r])!=null;r++)if(z)if(w^(z.className&&(" "+z.className+" ").indexOf(g)>=0))q||t.push(z);else if(q)j[r]=false;return false},ID:function(g){return g[1].replace(/\\/g,"")},TAG:function(g,j){for(var q=0;j[q]===false;q++);return j[q]&&s(j[q])?g[1]:g[1].toUpperCase()},CHILD:function(g){if(g[1]=="nth"){var j=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(g[2]=="even"&&"2n"||g[2]=="odd"&&"2n+1"||!/\D/.test(g[2])&&"0n+"+g[2]||g[2]);g[2]=j[1]+(j[2]||
1)-0;g[3]=j[3]-0}g[0]=e++;return g},ATTR:function(g,j,q,t,w,r){j=g[1].replace(/\\/g,"");if(!r&&n.attrMap[j])g[1]=n.attrMap[j];if(g[2]==="~=")g[4]=" "+g[4]+" ";return g},PSEUDO:function(g,j,q,t,w){if(g[1]==="not")if((c.exec(g[3])||"").length>1||/^\w/.test(g[3]))g[3]=o(g[3],null,null,j);else{g=o.filter(g[3],j,q,true^w);q||t.push.apply(t,g);return false}else if(n.match.POS.test(g[0])||n.match.CHILD.test(g[0]))return true;return g},POS:function(g){g.unshift(true);return g}},filters:{enabled:function(g){return g.disabled===
false&&g.type!=="hidden"},disabled:function(g){return g.disabled===true},checked:function(g){return g.checked===true},selected:function(g){return g.selected===true},parent:function(g){return!!g.firstChild},empty:function(g){return!g.firstChild},has:function(g,j,q){return!!o(q[3],g).length},header:function(g){return/h\d/i.test(g.nodeName)},text:function(g){return"text"===g.type},radio:function(g){return"radio"===g.type},checkbox:function(g){return"checkbox"===g.type},file:function(g){return"file"===
g.type},password:function(g){return"password"===g.type},submit:function(g){return"submit"===g.type},image:function(g){return"image"===g.type},reset:function(g){return"reset"===g.type},button:function(g){return"button"===g.type||g.nodeName.toUpperCase()==="BUTTON"},input:function(g){return/input|select|textarea|button/i.test(g.nodeName)}},setFilters:{first:function(g,j){return j===0},last:function(g,j,q,t){return j===t.length-1},even:function(g,j){return j%2===0},odd:function(g,j){return j%2===1},
lt:function(g,j,q){return j<q[3]-0},gt:function(g,j,q){return j>q[3]-0},nth:function(g,j,q){return q[3]-0==j},eq:function(g,j,q){return q[3]-0==j}},filter:{PSEUDO:function(g,j,q,t){var w=j[1],r=n.filters[w];if(r)return r(g,q,j,t);else if(w==="contains")return(g.textContent||g.innerText||"").indexOf(j[3])>=0;else if(w==="not"){j=j[3];q=0;for(t=j.length;q<t;q++)if(j[q]===g)return false;return true}},CHILD:function(g,j){var q=j[1],t=g;switch(q){case "only":case "first":for(;t=t.previousSibling;)if(t.nodeType===
1)return false;if(q=="first")return true;t=g;case "last":for(;t=t.nextSibling;)if(t.nodeType===1)return false;return true;case "nth":q=j[2];var w=j[3];if(q==1&&w==0)return true;j=j[0];var r=g.parentNode;if(r&&(r.sizcache!==j||!g.nodeIndex)){var z=0;for(t=r.firstChild;t;t=t.nextSibling)if(t.nodeType===1)t.nodeIndex=++z;r.sizcache=j}g=g.nodeIndex-w;return q==0?g==0:g%q==0&&g/q>=0}},ID:function(g,j){return g.nodeType===1&&g.getAttribute("id")===j},TAG:function(g,j){return j==="*"&&g.nodeType===1||g.nodeName===
j},CLASS:function(g,j){return(" "+(g.className||g.getAttribute("class"))+" ").indexOf(j)>-1},ATTR:function(g,j){var q=j[1];g=n.attrHandle[q]?n.attrHandle[q](g):g[q]!=null?g[q]:g.getAttribute(q);q=g+"";var t=j[2];j=j[4];return g==null?t==="!=":t==="="?q===j:t==="*="?q.indexOf(j)>=0:t==="~="?(" "+q+" ").indexOf(j)>=0:!j?q&&g!==false:t==="!="?q!=j:t==="^="?q.indexOf(j)===0:t==="$="?q.substr(q.length-j.length)===j:t==="|="?q===j||q.substr(0,j.length+1)===j+"-":false},POS:function(g,j,q,t){var w=n.setFilters[j[2]];
if(w)return w(g,q,j,t)}}},p=n.match.POS;for(var y in n.match){n.match[y]=new RegExp(n.match[y].source+/(?![^\[]*\])(?![^\(]*\))/.source);n.leftMatch[y]=new RegExp(/(^(?:.|\r|\n)*?)/.source+n.match[y].source)}var m=function(g,j){g=Array.prototype.slice.call(g,0);if(j){j.push.apply(j,g);return j}return g};try{Array.prototype.slice.call(document.documentElement.childNodes,0)}catch(v){m=function(g,j){j=j||[];if(f.call(g)==="[object Array]")Array.prototype.push.apply(j,g);else if(typeof g.length==="number")for(var q=
0,t=g.length;q<t;q++)j.push(g[q]);else for(q=0;g[q];q++)j.push(g[q]);return j}}var A;if(document.documentElement.compareDocumentPosition)A=function(g,j){if(!g.compareDocumentPosition||!j.compareDocumentPosition){if(g==j)h=true;return 0}g=g.compareDocumentPosition(j)&4?-1:g===j?0:1;if(g===0)h=true;return g};else if("sourceIndex"in document.documentElement)A=function(g,j){if(!g.sourceIndex||!j.sourceIndex){if(g==j)h=true;return 0}g=g.sourceIndex-j.sourceIndex;if(g===0)h=true;return g};else if(document.createRange)A=
function(g,j){if(!g.ownerDocument||!j.ownerDocument){if(g==j)h=true;return 0}var q=g.ownerDocument.createRange(),t=j.ownerDocument.createRange();q.setStart(g,0);q.setEnd(g,0);t.setStart(j,0);t.setEnd(j,0);g=q.compareBoundaryPoints(Range.START_TO_END,t);if(g===0)h=true;return g};(function(){var g=document.createElement("div"),j="script"+(new Date).getTime();g.innerHTML="<a name='"+j+"'/>";var q=document.documentElement;q.insertBefore(g,q.firstChild);if(document.getElementById(j)){n.find.ID=function(t,
w,r){if(typeof w.getElementById!=="undefined"&&!r)return(w=w.getElementById(t[1]))?w.id===t[1]||typeof w.getAttributeNode!=="undefined"&&w.getAttributeNode("id").nodeValue===t[1]?[w]:undefined:[]};n.filter.ID=function(t,w){var r=typeof t.getAttributeNode!=="undefined"&&t.getAttributeNode("id");return t.nodeType===1&&r&&r.nodeValue===w}}q.removeChild(g);q=g=null})();(function(){var g=document.createElement("div");g.appendChild(document.createComment(""));if(g.getElementsByTagName("*").length>0)n.find.TAG=
function(j,q){q=q.getElementsByTagName(j[1]);if(j[1]==="*"){j=[];for(var t=0;q[t];t++)q[t].nodeType===1&&j.push(q[t]);q=j}return q};g.innerHTML="<a href='#'></a>";if(g.firstChild&&typeof g.firstChild.getAttribute!=="undefined"&&g.firstChild.getAttribute("href")!=="#")n.attrHandle.href=function(j){return j.getAttribute("href",2)};g=null})();document.querySelectorAll&&function(){var g=o,j=document.createElement("div");j.innerHTML="<p class='TEST'></p>";if(!(j.querySelectorAll&&j.querySelectorAll(".TEST").length===
0)){o=function(t,w,r,z){w=w||document;if(!z&&w.nodeType===9&&!s(w))try{return m(w.querySelectorAll(t),r)}catch(H){}return g(t,w,r,z)};for(var q in g)o[q]=g[q];j=null}}();document.getElementsByClassName&&document.documentElement.getElementsByClassName&&function(){var g=document.createElement("div");g.innerHTML="<div class='test e'></div><div class='test'></div>";if(g.getElementsByClassName("e").length!==0){g.lastChild.className="e";if(g.getElementsByClassName("e").length!==1){n.order.splice(1,0,"CLASS");
n.find.CLASS=function(j,q,t){if(typeof q.getElementsByClassName!=="undefined"&&!t)return q.getElementsByClassName(j[1])};g=null}}}();var B=document.compareDocumentPosition?function(g,j){return g.compareDocumentPosition(j)&16}:function(g,j){return g!==j&&(g.contains?g.contains(j):true)},s=function(g){return g.nodeType===9&&g.documentElement.nodeName!=="HTML"||!!g.ownerDocument&&g.ownerDocument.documentElement.nodeName!=="HTML"},F=function(g,j){var q=[],t="",w;for(j=j.nodeType?[j]:j;w=n.match.PSEUDO.exec(g);){t+=
w[0];g=g.replace(n.match.PSEUDO,"")}g=n.relative[g]?g+"*":g;w=0;for(var r=j.length;w<r;w++)o(g,j[w],q);return o.filter(t,q)};window.Sizzle=o})();(function(a){function b(f,h){return e(a(f,h||document))}function c(f,h){return a.matches(h,[f]).length==1}var e=Prototype.Selector.extendElements;Prototype.Selector.engine=a;Prototype.Selector.select=b;Prototype.Selector.match=c})(Sizzle);window.Sizzle=Prototype._original_property;delete Prototype._original_property;
var Form={reset:function(a){a=$(a);a.reset();return a},serializeElements:function(a,b){if(typeof b!="object")b={hash:!!b};else if(Object.isUndefined(b.hash))b.hash=true;var c,e,f=false,h=b.submit,l;if(b.hash){b={};l=function(o,n,p){if(n in o){Object.isArray(o[n])||(o[n]=[o[n]]);o[n].push(p)}else o[n]=p;return o}}else{b="";l=function(o,n,p){return o+(o?"&":"")+encodeURIComponent(n)+"="+encodeURIComponent(p)}}return a.inject(b,function(o,n){if(!n.disabled&&n.name){c=n.name;e=$(n).getValue();if(e!=null&&
n.type!="file"&&(n.type!="submit"||!f&&h!==false&&(!h||c==h)&&(f=true)))o=l(o,c,e)}return o})}};
Form.Methods={serialize:function(a,b){return Form.serializeElements(Form.getElements(a),b)},getElements:function(a){a=$(a).getElementsByTagName("*");for(var b,c=[],e=Form.Element.Serializers,f=0;b=a[f];f++)c.push(b);return c.inject([],function(h,l){e[l.tagName.toLowerCase()]&&h.push(Element.extend(l));return h})},getInputs:function(a,b,c){a=$(a);a=a.getElementsByTagName("input");if(!b&&!c)return $A(a).map(Element.extend);for(var e=0,f=[],h=a.length;e<h;e++){var l=a[e];b&&l.type!=b||c&&l.name!=c||
f.push(Element.extend(l))}return f},disable:function(a){a=$(a);Form.getElements(a).invoke("disable");return a},enable:function(a){a=$(a);Form.getElements(a).invoke("enable");return a},findFirstElement:function(a){a=$(a).getElements().findAll(function(c){return"hidden"!=c.type&&!c.disabled});var b=a.findAll(function(c){return c.hasAttribute("tabIndex")&&c.tabIndex>=0}).sortBy(function(c){return c.tabIndex}).first();return b?b:a.find(function(c){return/^(?:input|select|textarea)$/i.test(c.tagName)})},
focusFirstElement:function(a){a=$(a);a.findFirstElement().activate();return a},request:function(a,b){a=$(a);b=Object.clone(b||{});var c=b.parameters,e=a.readAttribute("action")||"";if(e.blank())e=window.location.href;b.parameters=a.serialize(true);if(c){if(Object.isString(c))c=c.toQueryParams();Object.extend(b.parameters,c)}if(a.hasAttribute("method")&&!b.method)b.method=a.method;return new Ajax.Request(e,b)}};
Form.Element={focus:function(a){$(a).focus();return a},select:function(a){$(a).select();return a}};
Form.Element.Methods={serialize:function(a){a=$(a);if(!a.disabled&&a.name){var b=a.getValue();if(b!=undefined){var c={};c[a.name]=b;return Object.toQueryString(c)}}return""},getValue:function(a){a=$(a);var b=a.tagName.toLowerCase();return Form.Element.Serializers[b](a)},setValue:function(a,b){a=$(a);var c=a.tagName.toLowerCase();Form.Element.Serializers[c](a,b);return a},clear:function(a){$(a).value="";return a},present:function(a){return $(a).value!=""},activate:function(a){a=$(a);try{a.focus();
if(a.select&&(a.tagName.toLowerCase()!="input"||!/^(?:button|reset|submit)$/i.test(a.type)))a.select()}catch(b){}return a},disable:function(a){a=$(a);a.disabled=true;return a},enable:function(a){a=$(a);a.disabled=false;return a}};var Field=Form.Element,$F=Form.Element.Methods.getValue;
Form.Element.Serializers={input:function(a,b){switch(a.type.toLowerCase()){case "checkbox":case "radio":return Form.Element.Serializers.inputSelector(a,b);default:return Form.Element.Serializers.textarea(a,b)}},inputSelector:function(a,b){if(Object.isUndefined(b))return a.checked?a.value:null;else a.checked=!!b},textarea:function(a,b){if(Object.isUndefined(b))return a.value;else a.value=b},select:function(a,b){if(Object.isUndefined(b))return this[a.type=="select-one"?"selectOne":"selectMany"](a);
else for(var c,e,f=!Object.isArray(b),h=0,l=a.length;h<l;h++){c=a.options[h];e=this.optionValue(c);if(f){if(e==b){c.selected=true;return}}else c.selected=b.include(e)}},selectOne:function(a){var b=a.selectedIndex;return b>=0?this.optionValue(a.options[b]):null},selectMany:function(a){var b,c=a.length;if(!c)return null;var e=0;for(b=[];e<c;e++){var f=a.options[e];f.selected&&b.push(this.optionValue(f))}return b},optionValue:function(a){return Element.extend(a).hasAttribute("value")?a.value:a.text}};
Abstract.TimedObserver=Class.create(PeriodicalExecuter,{initialize:function($super,b,c,e){$super(e,c);this.element=$(b);this.lastValue=this.getValue()},execute:function(){var a=this.getValue();if(Object.isString(this.lastValue)&&Object.isString(a)?this.lastValue!=a:String(this.lastValue)!=String(a)){this.callback(this.element,a);this.lastValue=a}}});Form.Element.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.Element.getValue(this.element)}});
Form.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.serialize(this.element)}});
Abstract.EventObserver=Class.create({initialize:function(a,b){this.element=$(a);this.callback=b;this.lastValue=this.getValue();this.element.tagName.toLowerCase()=="form"?this.registerFormCallbacks():this.registerCallback(this.element)},onElementEvent:function(){var a=this.getValue();if(this.lastValue!=a){this.callback(this.element,a);this.lastValue=a}},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback,this)},registerCallback:function(a){if(a.type)switch(a.type.toLowerCase()){case "checkbox":case "radio":Event.observe(a,
"click",this.onElementEvent.bind(this));break;default:Event.observe(a,"change",this.onElementEvent.bind(this));break}}});Form.Element.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.Element.getValue(this.element)}});Form.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.serialize(this.element)}});
(function(){function a(u){return j(u,0)}function b(u){return j(u,1)}function c(u){return j(u,2)}function e(u){u=s.extend(u);var C=u.target,L=u.type;if((u=u.currentTarget)&&u.tagName)if(L==="load"||L==="error"||L==="click"&&u.tagName.toLowerCase()==="input"&&u.type==="radio")C=u;if(C.nodeType==Node.TEXT_NODE)C=C.parentNode;return Element.extend(C)}function f(u,C){u=s.element(u);if(!C)return u;for(;u;){if(Object.isElement(u)&&Prototype.Selector.match(u,C))return Element.extend(u);u=u.parentNode}}function h(u){return{x:l(u),
y:o(u)}}function l(u){var C=document.documentElement,L=document.body||{scrollLeft:0};return u.pageX||u.clientX+(C.scrollLeft||L.scrollLeft)-(C.clientLeft||0)}function o(u){var C=document.documentElement,L=document.body||{scrollTop:0};return u.pageY||u.clientY+(C.scrollTop||L.scrollTop)-(C.clientTop||0)}function n(u){s.extend(u);u.preventDefault();u.stopPropagation();u.stopped=true}function p(u,C,L){var T=Element.retrieve(u,"prototype_event_registry");if(Object.isUndefined(T)){r.push(u);T=Element.retrieve(u,
"prototype_event_registry",$H())}var E=T.get(C);if(Object.isUndefined(E)){E=[];T.set(C,E)}if(E.pluck("handler").include(L))return false;var S;if(C.include(":"))S=function(J){if(Object.isUndefined(J.eventName))return false;if(J.eventName!==C)return false;s.extend(J,u);L.call(u,J)};else if(!g&&(C==="mouseenter"||C==="mouseleave")){if(C==="mouseenter"||C==="mouseleave")S=function(J){s.extend(J,u);for(var I=J.relatedTarget;I&&I!==u;)try{I=I.parentNode}catch(N){I=u}I!==u&&L.call(u,J)}}else S=function(J){s.extend(J,
u);L.call(u,J)};S.handler=L;E.push(S);return S}function y(){for(var u=0,C=r.length;u<C;u++){s.stopObserving(r[u]);r[u]=null}}function m(u,C,L){u=$(u);L=p(u,C,L);if(!L)return u;if(C.include(":"))if(u.addEventListener)u.addEventListener("dataavailable",L,false);else{u.attachEvent("ondataavailable",L);u.attachEvent("onlosecapture",L)}else{C=z(C);u.addEventListener?u.addEventListener(C,L,false):u.attachEvent("on"+C,L)}return u}function v(u,C,L){u=$(u);var T=Element.retrieve(u,"prototype_event_registry");
if(!T)return u;if(!C){T.each(function(I){v(u,I.key)});return u}var E=T.get(C);if(!E)return u;if(!L){E.each(function(I){v(u,C,I.handler)});return u}var S=E.find(function(I){return I.handler===L});if(!S)return u;if(C.include(":"))if(u.removeEventListener)u.removeEventListener("dataavailable",S,false);else{u.detachEvent("ondataavailable",S);u.detachEvent("onlosecapture",S)}else{var J=z(C);u.removeEventListener?u.removeEventListener(J,S,false):u.detachEvent("on"+J,S)}T.set(C,E.without(S));return u}function A(u,
C,L,T){u=$(u);if(Object.isUndefined(T))T=true;if(u==document&&document.createEvent&&!u.dispatchEvent)u=document.documentElement;var E;if(document.createEvent){E=document.createEvent("HTMLEvents");E.initEvent("dataavailable",T,true)}else{E=document.createEventObject();E.eventType=T?"ondataavailable":"onlosecapture"}E.eventName=C;E.memo=L||{};document.createEvent?u.dispatchEvent(E):u.fireEvent(E.eventType,E);return s.extend(E)}function B(u,C,L,T){u=$(u);if(Object.isFunction(L)&&Object.isUndefined(T)){T=
L;L=null}return(new s.Handler(u,C,L,T)).start()}var s={KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45,cache:{}},F=document.documentElement,g="onmouseenter"in F&&"onmouseleave"in F;F=window.attachEvent&&!window.addEventListener;var j;if(F){var q={0:1,1:4,2:2};j=function(u,C){return u.button===q[C]}}else j=Prototype.Browser.WebKit?function(u,C){switch(C){case 0:return u.which==
1&&!u.metaKey;case 1:return u.which==1&&u.metaKey;default:return false}}:function(u,C){return u.which?u.which===C+1:u.button===C};s.Methods={isLeftClick:a,isMiddleClick:b,isRightClick:c,element:e,findElement:f,pointer:h,pointerX:l,pointerY:o,stop:n};var t=Object.keys(s.Methods).inject({},function(u,C){u[C]=s.Methods[C].methodize();return u});if(F){var w=function(u){switch(u.type){case "mouseover":u=u.fromElement;break;case "mouseout":u=u.toElement;break;default:return null}return Element.extend(u)};
Object.extend(t,{stopPropagation:function(){this.cancelBubble=true},preventDefault:function(){this.returnValue=false},inspect:function(){return"[object Event]"}});s.extend=function(u,C){if(!u)return false;if(u._extendedByPrototype)return u;u._extendedByPrototype=Prototype.emptyFunction;var L=s.pointer(u);Object.extend(u,{target:u.srcElement||C,relatedTarget:w(u),pageX:L.x,pageY:L.y});return Object.extend(u,t)}}else{s.prototype=window.Event.prototype||document.createEvent("HTMLEvents").__proto__;Object.extend(s.prototype,
t);s.extend=Prototype.K}var r=[];Prototype.Browser.IE&&window.attachEvent("onunload",y);Prototype.Browser.WebKit&&window.addEventListener("unload",Prototype.emptyFunction,false);var z=Prototype.K,H={mouseenter:"mouseover",mouseleave:"mouseout"};g||(z=function(u){return H[u]||u});s.Handler=Class.create({initialize:function(u,C,L,T){this.element=$(u);this.eventName=C;this.selector=L;this.callback=T;this.handler=this.handleEvent.bind(this)},start:function(){s.observe(this.element,this.eventName,this.handler);
return this},stop:function(){s.stopObserving(this.element,this.eventName,this.handler);return this},handleEvent:function(u){var C=u.findElement(this.selector);C&&this.callback.call(this.element,u,C)}});Object.extend(s,s.Methods);Object.extend(s,{fire:A,observe:m,stopObserving:v,on:B});Element.addMethods({fire:A,observe:m,stopObserving:v,on:B});Object.extend(document,{fire:A.methodize(),observe:m.methodize(),stopObserving:v.methodize(),on:B.methodize(),loaded:false});if(window.Event)Object.extend(window.Event,
s);else window.Event=s})();
(function(){function a(){if(!document.loaded){e&&window.clearTimeout(e);document.loaded=true;document.fire("dom:loaded")}}function b(){if(document.readyState==="complete"){document.stopObserving("readystatechange",b);a()}}function c(){try{document.documentElement.doScroll("left")}catch(f){e=c.defer();return}a()}var e;if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,false);else{document.observe("readystatechange",b);if(window==top)e=c.defer()}Event.observe(window,"load",
a)})();Element.addMethods();Hash.toQueryString=Object.toQueryString;var Toggle={display:Element.toggle};Element.Methods.childOf=Element.Methods.descendantOf;
var Insertion={Before:function(a,b){return Element.insert(a,{before:b})},Top:function(a,b){return Element.insert(a,{top:b})},Bottom:function(a,b){return Element.insert(a,{bottom:b})},After:function(a,b){return Element.insert(a,{after:b})}},$continue=new Error('"throw $continue" is deprecated, use "return" instead'),Position={includeScrollOffsets:false,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;this.deltaY=window.pageYOffset||
document.documentElement.scrollTop||document.body.scrollTop||0},within:function(a,b,c){if(this.includeScrollOffsets)return this.withinIncludingScrolloffsets(a,b,c);this.xcomp=b;this.ycomp=c;this.offset=Element.cumulativeOffset(a);return c>=this.offset[1]&&c<this.offset[1]+a.offsetHeight&&b>=this.offset[0]&&b<this.offset[0]+a.offsetWidth},withinIncludingScrolloffsets:function(a,b,c){var e=Element.cumulativeScrollOffset(a);this.xcomp=b+e[0]-this.deltaX;this.ycomp=c+e[1]-this.deltaY;this.offset=Element.cumulativeOffset(a);
return this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+a.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+a.offsetWidth},overlap:function(a,b){if(!a)return 0;if(a=="vertical")return(this.offset[1]+b.offsetHeight-this.ycomp)/b.offsetHeight;if(a=="horizontal")return(this.offset[0]+b.offsetWidth-this.xcomp)/b.offsetWidth},cumulativeOffset:Element.Methods.cumulativeOffset,positionedOffset:Element.Methods.positionedOffset,absolutize:function(a){Position.prepare();return Element.absolutize(a)},
relativize:function(a){Position.prepare();return Element.relativize(a)},realOffset:Element.Methods.cumulativeScrollOffset,offsetParent:Element.Methods.getOffsetParent,page:Element.Methods.viewportOffset,clone:function(a,b,c){c=c||{};return Element.clonePosition(b,a,c)}};
if(!document.getElementsByClassName)document.getElementsByClassName=function(a){function b(c){return c.blank()?null:"[contains(concat(' ', @class, ' '), ' "+c+" ')]"}a.getElementsByClassName=Prototype.BrowserFeatures.XPath?function(c,e){e=e.toString().strip();return(e=/\s/.test(e)?$w(e).map(b).join(""):b(e))?document._getElementsByXPath(".//*"+e,c):[]}:function(c,e){e=e.toString().strip();var f=[],h=/\s/.test(e)?$w(e):null;if(!h&&!e)return f;c=$(c).getElementsByTagName("*");e=" "+e+" ";for(var l=
0,o,n;o=c[l];l++)if(o.className&&(n=" "+o.className+" ")&&(n.include(e)||h&&h.all(function(p){return!p.toString().blank()&&n.include(" "+p+" ")})))f.push(Element.extend(o));return f};return function(c,e){return $(e||document.body).getElementsByClassName(c)}}(Element.Methods);Element.ClassNames=Class.create();
Element.ClassNames.prototype={initialize:function(a){this.element=$(a)},_each:function(a){this.element.className.split(/\s+/).select(function(b){return b.length>0})._each(a)},set:function(a){this.element.className=a},add:function(a){this.include(a)||this.set($A(this).concat(a).join(" "))},remove:function(a){this.include(a)&&this.set($A(this).without(a).join(" "))},toString:function(){return $A(this).join(" ")}};Object.extend(Element.ClassNames.prototype,Enumerable);
(function(){window.Selector=Class.create({initialize:function(a){this.expression=a.strip()},findElements:function(a){return Prototype.Selector.select(this.expression,a)},match:function(a){return Prototype.Selector.match(a,this.expression)},toString:function(){return this.expression},inspect:function(){return"#<Selector: "+this.expression+">"}});Object.extend(Selector,{matchElements:function(a,b){for(var c=Prototype.Selector.match,e=[],f=0,h=a.length;f<h;f++){var l=a[f];c(l,b)&&e.push(Element.extend(l))}return e},
findElement:function(a,b,c){c=c||0;for(var e=0,f,h=0,l=a.length;h<l;h++){f=a[h];if(Prototype.Selector.match(f,b)&&c===e++)return Element.extend(f)}},findChildElements:function(a,b){b=b.toArray().join(", ");return Prototype.Selector.select(b,a||document)}})})();String.prototype.parseColor=function(a){var b="#";if(this.slice(0,4)=="rgb("){var c=this.slice(4,this.length-1).split(","),e=0;do b+=parseInt(c[e]).toColorPart();while(++e<3)}else if(this.slice(0,1)=="#"){if(this.length==4)for(e=1;e<4;e++)b+=(this.charAt(e)+this.charAt(e)).toLowerCase();if(this.length==7)b=this.toLowerCase()}return b.length==7?b:a||this};
Element.collectTextNodes=function(a){return $A($(a).childNodes).collect(function(b){return b.nodeType==3?b.nodeValue:b.hasChildNodes()?Element.collectTextNodes(b):""}).flatten().join("")};Element.collectTextNodesIgnoreClass=function(a,b){return $A($(a).childNodes).collect(function(c){return c.nodeType==3?c.nodeValue:c.hasChildNodes()&&!Element.hasClassName(c,b)?Element.collectTextNodesIgnoreClass(c,b):""}).flatten().join("")};
Element.setContentZoom=function(a,b){a=$(a);a.setStyle({fontSize:b/100+"em"});Prototype.Browser.WebKit&&window.scrollBy(0,0);return a};Element.getInlineOpacity=function(a){return $(a).style.opacity||""};Element.forceRerendering=function(a){try{a=$(a);var b=document.createTextNode(" ");a.appendChild(b);a.removeChild(b)}catch(c){}};
var Effect={_elementDoesNotExistError:{name:"ElementDoesNotExistError",message:"The specified DOM element does not exist, but is required for this effect to operate"},Transitions:{linear:Prototype.K,sinoidal:function(a){return-Math.cos(a*Math.PI)/2+0.5},reverse:function(a){return 1-a},flicker:function(a){a=-Math.cos(a*Math.PI)/4+0.75+Math.random()/4;return a>1?1:a},wobble:function(a){return-Math.cos(a*Math.PI*9*a)/2+0.5},pulse:function(a,b){return-Math.cos(a*((b||5)-0.5)*2*Math.PI)/2+0.5},spring:function(a){return 1-
Math.cos(a*4.5*Math.PI)*Math.exp(-a*6)},none:function(){return 0},full:function(){return 1}},DefaultOptions:{duration:1,fps:100,sync:false,from:0,to:1,delay:0,queue:"parallel"},tagifyText:function(a){var b="position:relative";if(Prototype.Browser.IE)b+=";zoom:1";a=$(a);$A(a.childNodes).each(function(c){if(c.nodeType==3){c.nodeValue.toArray().each(function(e){a.insertBefore((new Element("span",{style:b})).update(e==" "?String.fromCharCode(160):e),c)});Element.remove(c)}})},multiple:function(a,b,c){a=
(typeof a=="object"||Object.isFunction(a))&&a.length?a:$(a).childNodes;var e=Object.extend({speed:0.1,delay:0},c||{}),f=e.delay;$A(a).each(function(h,l){new b(h,Object.extend(e,{delay:l*e.speed+f}))})},PAIRS:{slide:["SlideDown","SlideUp"],blind:["BlindDown","BlindUp"],appear:["Appear","Fade"]},toggle:function(a,b,c){a=$(a);b=(b||"appear").toLowerCase();c=Object.extend({queue:{position:"end",scope:a.id||"global",limit:1}},c||{});Effect[a.visible()?Effect.PAIRS[b][1]:Effect.PAIRS[b][0]](a,c)}};
Effect.DefaultOptions.transition=Effect.Transitions.sinoidal;
Effect.ScopedQueue=Class.create(Enumerable,{initialize:function(){this.effects=[];this.interval=null},_each:function(a){this.effects._each(a)},add:function(a){var b=(new Date).getTime();switch(Object.isString(a.options.queue)?a.options.queue:a.options.queue.position){case "front":this.effects.findAll(function(c){return c.state=="idle"}).each(function(c){c.startOn+=a.finishOn;c.finishOn+=a.finishOn});break;case "with-last":b=this.effects.pluck("startOn").max()||b;break;case "end":b=this.effects.pluck("finishOn").max()||
b;break}a.startOn+=b;a.finishOn+=b;if(!a.options.queue.limit||this.effects.length<a.options.queue.limit)this.effects.push(a);if(!this.interval)this.interval=setInterval(this.loop.bind(this),15)},remove:function(a){this.effects=this.effects.reject(function(b){return b==a});if(this.effects.length==0){clearInterval(this.interval);this.interval=null}},loop:function(){for(var a=(new Date).getTime(),b=0,c=this.effects.length;b<c;b++)this.effects[b]&&this.effects[b].loop(a)}});
Effect.Queues={instances:$H(),get:function(a){if(!Object.isString(a))return a;return this.instances.get(a)||this.instances.set(a,new Effect.ScopedQueue)}};Effect.Queue=Effect.Queues.get("global");
Effect.Base=Class.create({position:null,start:function(a){if(a&&a.transition===false)a.transition=Effect.Transitions.linear;this.options=Object.extend(Object.extend({},Effect.DefaultOptions),a||{});this.currentFrame=0;this.state="idle";this.startOn=this.options.delay*1E3;this.finishOn=this.startOn+this.options.duration*1E3;this.fromToDelta=this.options.to-this.options.from;this.totalTime=this.finishOn-this.startOn;this.totalFrames=this.options.fps*this.options.duration;this.render=function(){function b(c,
e){c.options[e+"Internal"]&&c.options[e+"Internal"](c);c.options[e]&&c.options[e](c)}return function(c){if(this.state==="idle"){this.state="running";b(this,"beforeSetup");this.setup&&this.setup();b(this,"afterSetup")}if(this.state==="running"){this.position=c=this.options.transition(c)*this.fromToDelta+this.options.from;b(this,"beforeUpdate");this.update&&this.update(c);b(this,"afterUpdate")}}}();this.event("beforeStart");this.options.sync||Effect.Queues.get(Object.isString(this.options.queue)?"global":
this.options.queue.scope).add(this)},loop:function(a){if(a>=this.startOn)if(a>=this.finishOn){this.render(1);this.cancel();this.event("beforeFinish");this.finish&&this.finish();this.event("afterFinish")}else{a=(a-this.startOn)/this.totalTime;var b=(a*this.totalFrames).round();if(b>this.currentFrame){this.render(a);this.currentFrame=b}}},cancel:function(){this.options.sync||Effect.Queues.get(Object.isString(this.options.queue)?"global":this.options.queue.scope).remove(this);this.state="finished"},
event:function(a){this.options[a+"Internal"]&&this.options[a+"Internal"](this);this.options[a]&&this.options[a](this)},inspect:function(){var a=$H();for(property in this)Object.isFunction(this[property])||a.set(property,this[property]);return"#<Effect:"+a.inspect()+",options:"+$H(this.options).inspect()+">"}});
Effect.Parallel=Class.create(Effect.Base,{initialize:function(a,b){this.effects=a||[];this.start(b)},update:function(a){this.effects.invoke("render",a)},finish:function(a){this.effects.each(function(b){b.render(1);b.cancel();b.event("beforeFinish");b.finish&&b.finish(a);b.event("afterFinish")})}});
Effect.Tween=Class.create(Effect.Base,{initialize:function(a,b,c){a=Object.isString(a)?$(a):a;var e=$A(arguments),f=e.last();e=e.length==5?e[3]:null;this.method=Object.isFunction(f)?f.bind(a):Object.isFunction(a[f])?a[f].bind(a):function(h){a[f]=h};this.start(Object.extend({from:b,to:c},e||{}))},update:function(a){this.method(a)}});Effect.Event=Class.create(Effect.Base,{initialize:function(a){this.start(Object.extend({duration:0},a||{}))},update:Prototype.emptyFunction});
Effect.Opacity=Class.create(Effect.Base,{initialize:function(a,b){this.element=$(a);if(!this.element)throw Effect._elementDoesNotExistError;Prototype.Browser.IE&&!this.element.currentStyle.hasLayout&&this.element.setStyle({zoom:1});this.start(Object.extend({from:this.element.getOpacity()||0,to:1},b||{}))},update:function(a){this.element.setOpacity(a)}});
Effect.Move=Class.create(Effect.Base,{initialize:function(a,b){this.element=$(a);if(!this.element)throw Effect._elementDoesNotExistError;this.start(Object.extend({x:0,y:0,mode:"relative"},b||{}))},setup:function(){this.element.makePositioned();this.originalLeft=parseFloat(this.element.getStyle("left")||"0");this.originalTop=parseFloat(this.element.getStyle("top")||"0");if(this.options.mode=="absolute"){this.options.x-=this.originalLeft;this.options.y-=this.originalTop}},update:function(a){this.element.setStyle({left:(this.options.x*
a+this.originalLeft).round()+"px",top:(this.options.y*a+this.originalTop).round()+"px"})}});Effect.MoveBy=function(a,b,c,e){return new Effect.Move(a,Object.extend({x:c,y:b},e||{}))};
Effect.Scale=Class.create(Effect.Base,{initialize:function(a,b,c){this.element=$(a);if(!this.element)throw Effect._elementDoesNotExistError;this.start(Object.extend({scaleX:true,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:"box",scaleFrom:100,scaleTo:b},c||{}))},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||false;this.elementPositioning=this.element.getStyle("position");this.originalStyle={};["top","left","width","height","fontSize"].each(function(b){this.originalStyle[b]=
this.element.style[b]}.bind(this));this.originalTop=this.element.offsetTop;this.originalLeft=this.element.offsetLeft;var a=this.element.getStyle("font-size")||"100%";["em","px","%","pt"].each(function(b){if(a.indexOf(b)>0){this.fontSize=parseFloat(a);this.fontSizeType=b}}.bind(this));this.factor=(this.options.scaleTo-this.options.scaleFrom)/100;this.dims=null;if(this.options.scaleMode=="box")this.dims=[this.element.offsetHeight,this.element.offsetWidth];if(/^content/.test(this.options.scaleMode))this.dims=
[this.element.scrollHeight,this.element.scrollWidth];if(!this.dims)this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth]},update:function(a){a=this.options.scaleFrom/100+this.factor*a;this.options.scaleContent&&this.fontSize&&this.element.setStyle({fontSize:this.fontSize*a+this.fontSizeType});this.setDimensions(this.dims[0]*a,this.dims[1]*a)},finish:function(){this.restoreAfterFinish&&this.element.setStyle(this.originalStyle)},setDimensions:function(a,b){var c={};
if(this.options.scaleX)c.width=b.round()+"px";if(this.options.scaleY)c.height=a.round()+"px";if(this.options.scaleFromCenter){a=(a-this.dims[0])/2;b=(b-this.dims[1])/2;if(this.elementPositioning=="absolute"){if(this.options.scaleY)c.top=this.originalTop-a+"px";if(this.options.scaleX)c.left=this.originalLeft-b+"px"}else{if(this.options.scaleY)c.top=-a+"px";if(this.options.scaleX)c.left=-b+"px"}}this.element.setStyle(c)}});
Effect.Highlight=Class.create(Effect.Base,{initialize:function(a,b){this.element=$(a);if(!this.element)throw Effect._elementDoesNotExistError;this.start(Object.extend({startcolor:"#fffae2"},b||{}))},setup:function(){if(this.element.getStyle("display")=="none")this.cancel();else{this.oldStyle={};if(!this.options.keepBackgroundImage){this.oldStyle.backgroundImage=this.element.getStyle("background-image");this.element.setStyle({backgroundImage:"none"})}if(!this.options.endcolor)this.options.endcolor=
this.element.getStyle("background-color").parseColor("#ffffff");if(!this.options.restorecolor)this.options.restorecolor=this.element.getStyle("background-color");this._base=$R(0,2).map(function(a){return parseInt(this.options.startcolor.slice(a*2+1,a*2+3),16)}.bind(this));this._delta=$R(0,2).map(function(a){return parseInt(this.options.endcolor.slice(a*2+1,a*2+3),16)-this._base[a]}.bind(this))}},update:function(a){this.element.setStyle({backgroundColor:$R(0,2).inject("#",function(b,c,e){return b+
(this._base[e]+this._delta[e]*a).round().toColorPart()}.bind(this))})},finish:function(){this.element.setStyle(Object.extend(this.oldStyle,{backgroundColor:this.options.restorecolor}))}});Effect.ScrollTo=function(a,b){b=b||{};var c=document.viewport.getScrollOffsets();a=$(a).cumulativeOffset();if(b.offset)a[1]+=b.offset;return new Effect.Tween(null,c.top,a[1],b,function(e){scrollTo(c.left,e.round())})};
Effect.Fade=function(a,b){a=$(a);var c=a.getInlineOpacity();b=Object.extend({from:a.getOpacity()||1,to:0,afterFinishInternal:function(e){e.options.to==0&&e.element.hide().setStyle({opacity:c})}},b||{});return new Effect.Opacity(a,b)};
Effect.Appear=function(a,b){a=$(a);b=Object.extend({from:a.getStyle("display")=="none"?0:a.getOpacity()||0,to:1,afterFinishInternal:function(c){c.element.forceRerendering()},beforeSetup:function(c){c.element.setOpacity(c.options.from).show()}},b||{});return new Effect.Opacity(a,b)};
Effect.Puff=function(a,b){a=$(a);var c={opacity:a.getInlineOpacity(),position:a.getStyle("position"),top:a.style.top,left:a.style.left,width:a.style.width,height:a.style.height};return new Effect.Parallel([new Effect.Scale(a,200,{sync:true,scaleFromCenter:true,scaleContent:true,restoreAfterFinish:true}),new Effect.Opacity(a,{sync:true,to:0})],Object.extend({duration:1,beforeSetupInternal:function(e){Position.absolutize(e.effects[0].element)},afterFinishInternal:function(e){e.effects[0].element.hide().setStyle(c)}},
b||{}))};Effect.BlindUp=function(a,b){a=$(a);a.makeClipping();return new Effect.Scale(a,0,Object.extend({scaleContent:false,scaleX:false,restoreAfterFinish:true,afterFinishInternal:function(c){c.element.hide().undoClipping()}},b||{}))};
Effect.BlindDown=function(a,b){a=$(a);var c=a.getDimensions();return new Effect.Scale(a,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:c.height,originalWidth:c.width},restoreAfterFinish:true,afterSetup:function(e){e.element.makeClipping().setStyle({height:"0px"}).show()},afterFinishInternal:function(e){e.element.undoClipping()}},b||{}))};
Effect.SwitchOff=function(a,b){a=$(a);var c=a.getInlineOpacity();return new Effect.Appear(a,Object.extend({duration:0.4,from:0,transition:Effect.Transitions.flicker,afterFinishInternal:function(e){new Effect.Scale(e.element,1,{duration:0.3,scaleFromCenter:true,scaleX:false,scaleContent:false,restoreAfterFinish:true,beforeSetup:function(f){f.element.makePositioned().makeClipping()},afterFinishInternal:function(f){f.element.hide().undoClipping().undoPositioned().setStyle({opacity:c})}})}},b||{}))};
Effect.DropOut=function(a,b){a=$(a);var c={top:a.getStyle("top"),left:a.getStyle("left"),opacity:a.getInlineOpacity()};return new Effect.Parallel([new Effect.Move(a,{x:0,y:100,sync:true}),new Effect.Opacity(a,{sync:true,to:0})],Object.extend({duration:0.5,beforeSetup:function(e){e.effects[0].element.makePositioned()},afterFinishInternal:function(e){e.effects[0].element.hide().undoPositioned().setStyle(c)}},b||{}))};
Effect.Shake=function(a,b){a=$(a);b=Object.extend({distance:20,duration:0.5},b||{});var c=parseFloat(b.distance),e=parseFloat(b.duration)/10,f={top:a.getStyle("top"),left:a.getStyle("left")};return new Effect.Move(a,{x:c,y:0,duration:e,afterFinishInternal:function(h){new Effect.Move(h.element,{x:-c*2,y:0,duration:e*2,afterFinishInternal:function(l){new Effect.Move(l.element,{x:c*2,y:0,duration:e*2,afterFinishInternal:function(o){new Effect.Move(o.element,{x:-c*2,y:0,duration:e*2,afterFinishInternal:function(n){new Effect.Move(n.element,
{x:c*2,y:0,duration:e*2,afterFinishInternal:function(p){new Effect.Move(p.element,{x:-c,y:0,duration:e,afterFinishInternal:function(y){y.element.undoPositioned().setStyle(f)}})}})}})}})}})}})};
Effect.SlideDown=function(a,b){a=$(a).cleanWhitespace();var c=a.down().getStyle("bottom"),e=a.getDimensions();return new Effect.Scale(a,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:window.opera?0:1,scaleMode:{originalHeight:e.height,originalWidth:e.width},restoreAfterFinish:true,afterSetup:function(f){f.element.makePositioned();f.element.down().makePositioned();window.opera&&f.element.setStyle({top:""});f.element.makeClipping().setStyle({height:"0px"}).show()},afterUpdateInternal:function(f){f.element.down().setStyle({bottom:f.dims[0]-
f.element.clientHeight+"px"})},afterFinishInternal:function(f){f.element.undoClipping().undoPositioned();f.element.down().undoPositioned().setStyle({bottom:c})}},b||{}))};
Effect.SlideUp=function(a,b){a=$(a).cleanWhitespace();var c=a.down().getStyle("bottom"),e=a.getDimensions();return new Effect.Scale(a,window.opera?0:1,Object.extend({scaleContent:false,scaleX:false,scaleMode:"box",scaleFrom:100,scaleMode:{originalHeight:e.height,originalWidth:e.width},restoreAfterFinish:true,afterSetup:function(f){f.element.makePositioned();f.element.down().makePositioned();window.opera&&f.element.setStyle({top:""});f.element.makeClipping().show()},afterUpdateInternal:function(f){f.element.down().setStyle({bottom:f.dims[0]-
f.element.clientHeight+"px"})},afterFinishInternal:function(f){f.element.hide().undoClipping().undoPositioned();f.element.down().undoPositioned().setStyle({bottom:c})}},b||{}))};Effect.Squish=function(a){return new Effect.Scale(a,window.opera?1:0,{restoreAfterFinish:true,beforeSetup:function(b){b.element.makeClipping()},afterFinishInternal:function(b){b.element.hide().undoClipping()}})};
Effect.Grow=function(a,b){a=$(a);var c=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.full},b||{}),e={top:a.style.top,left:a.style.left,height:a.style.height,width:a.style.width,opacity:a.getInlineOpacity()},f=a.getDimensions(),h,l,o,n;switch(c.direction){case "top-left":h=l=o=n=0;break;case "top-right":h=f.width;l=n=0;o=-f.width;break;case "bottom-left":h=o=0;l=f.height;n=-f.height;break;
case "bottom-right":h=f.width;l=f.height;o=-f.width;n=-f.height;break;case "center":h=f.width/2;l=f.height/2;o=-f.width/2;n=-f.height/2;break}return new Effect.Move(a,{x:h,y:l,duration:0.01,beforeSetup:function(p){p.element.hide().makeClipping().makePositioned()},afterFinishInternal:function(p){new Effect.Parallel([new Effect.Opacity(p.element,{sync:true,to:1,from:0,transition:c.opacityTransition}),new Effect.Move(p.element,{x:o,y:n,sync:true,transition:c.moveTransition}),new Effect.Scale(p.element,
100,{scaleMode:{originalHeight:f.height,originalWidth:f.width},sync:true,scaleFrom:window.opera?1:0,transition:c.scaleTransition,restoreAfterFinish:true})],Object.extend({beforeSetup:function(y){y.effects[0].element.setStyle({height:"0px"}).show()},afterFinishInternal:function(y){y.effects[0].element.undoClipping().undoPositioned().setStyle(e)}},c))}})};
Effect.Shrink=function(a,b){a=$(a);b=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.none},b||{});var c={top:a.style.top,left:a.style.left,height:a.style.height,width:a.style.width,opacity:a.getInlineOpacity()},e=a.getDimensions(),f,h;switch(b.direction){case "top-left":f=h=0;break;case "top-right":f=e.width;h=0;break;case "bottom-left":f=0;h=e.height;break;case "bottom-right":f=e.width;h=
e.height;break;case "center":f=e.width/2;h=e.height/2;break}return new Effect.Parallel([new Effect.Opacity(a,{sync:true,to:0,from:1,transition:b.opacityTransition}),new Effect.Scale(a,window.opera?1:0,{sync:true,transition:b.scaleTransition,restoreAfterFinish:true}),new Effect.Move(a,{x:f,y:h,sync:true,transition:b.moveTransition})],Object.extend({beforeStartInternal:function(l){l.effects[0].element.makePositioned().makeClipping()},afterFinishInternal:function(l){l.effects[0].element.hide().undoClipping().undoPositioned().setStyle(c)}},
b))};Effect.Pulsate=function(a,b){a=$(a);var c=b||{},e=a.getInlineOpacity(),f=c.transition||Effect.Transitions.linear;return new Effect.Opacity(a,Object.extend(Object.extend({duration:2,from:0,afterFinishInternal:function(h){h.element.setStyle({opacity:e})}},c),{transition:function(h){return 1-f(-Math.cos(h*(c.pulses||5)*2*Math.PI)/2+0.5)}}))};
Effect.Fold=function(a,b){a=$(a);var c={top:a.style.top,left:a.style.left,width:a.style.width,height:a.style.height};a.makeClipping();return new Effect.Scale(a,5,Object.extend({scaleContent:false,scaleX:false,afterFinishInternal:function(){new Effect.Scale(a,1,{scaleContent:false,scaleY:false,afterFinishInternal:function(e){e.element.hide().undoClipping().setStyle(c)}})}},b||{}))};
Effect.Morph=Class.create(Effect.Base,{initialize:function(a,b){this.element=$(a);if(!this.element)throw Effect._elementDoesNotExistError;a=Object.extend({style:{}},b||{});if(Object.isString(a.style))if(a.style.include(":"))this.style=a.style.parseStyle();else{this.element.addClassName(a.style);this.style=$H(this.element.getStyles());this.element.removeClassName(a.style);var c=this.element.getStyles();this.style=this.style.reject(function(e){return e.value==c[e.key]});a.afterFinishInternal=function(e){e.element.addClassName(e.options.style);
e.transforms.each(function(f){e.element.style[f.style]=""})}}else this.style=$H(a.style);this.start(a)},setup:function(){function a(b){if(!b||["rgba(0, 0, 0, 0)","transparent"].include(b))b="#ffffff";b=b.parseColor();return $R(0,2).map(function(c){return parseInt(b.slice(c*2+1,c*2+3),16)})}this.transforms=this.style.map(function(b){var c=b[0];b=b[1];var e=null;if(b.parseColor("#zzzzzz")!="#zzzzzz"){b=b.parseColor();e="color"}else if(c=="opacity"){b=parseFloat(b);Prototype.Browser.IE&&!this.element.currentStyle.hasLayout&&
this.element.setStyle({zoom:1})}else if(Element.CSS_LENGTH.test(b)){e=b.match(/^([\+\-]?[0-9\.]+)(.*)$/);b=parseFloat(e[1]);e=e.length==3?e[2]:null}var f=this.element.getStyle(c);return{style:c.camelize(),originalValue:e=="color"?a(f):parseFloat(f||0),targetValue:e=="color"?a(b):b,unit:e}}.bind(this)).reject(function(b){return b.originalValue==b.targetValue||b.unit!="color"&&(isNaN(b.originalValue)||isNaN(b.targetValue))})},update:function(a){for(var b={},c,e=this.transforms.length;e--;)b[(c=this.transforms[e]).style]=
c.unit=="color"?"#"+Math.round(c.originalValue[0]+(c.targetValue[0]-c.originalValue[0])*a).toColorPart()+Math.round(c.originalValue[1]+(c.targetValue[1]-c.originalValue[1])*a).toColorPart()+Math.round(c.originalValue[2]+(c.targetValue[2]-c.originalValue[2])*a).toColorPart():(c.originalValue+(c.targetValue-c.originalValue)*a).toFixed(3)+(c.unit===null?"":c.unit);this.element.setStyle(b,true)}});
Effect.Transform=Class.create({initialize:function(a,b){this.tracks=[];this.options=b||{};this.addTracks(a)},addTracks:function(a){a.each(function(b){b=$H(b);var c=b.values().first();this.tracks.push($H({ids:b.keys().first(),effect:Effect.Morph,options:{style:c}}))}.bind(this));return this},play:function(){return new Effect.Parallel(this.tracks.map(function(a){var b=a.get("ids"),c=a.get("effect"),e=a.get("options");return[$(b)||$$(b)].flatten().map(function(f){return new c(f,Object.extend({sync:true},
e))})}).flatten(),this.options)}});Element.CSS_PROPERTIES=$w("backgroundColor backgroundPosition borderBottomColor borderBottomStyle borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth borderRightColor borderRightStyle borderRightWidth borderSpacing borderTopColor borderTopStyle borderTopWidth bottom clip color fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop markerOffset maxHeight maxWidth minHeight minWidth opacity outlineColor outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex");
Element.CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/;String.__parseStyleElement=document.createElement("div");
String.prototype.parseStyle=function(){var a,b=$H();if(Prototype.Browser.WebKit)a=(new Element("div",{style:this})).style;else{String.__parseStyleElement.innerHTML='<div style="'+this+'"></div>';a=String.__parseStyleElement.childNodes[0].style}Element.CSS_PROPERTIES.each(function(c){a[c]&&b.set(c,a[c])});Prototype.Browser.IE&&this.include("opacity")&&b.set("opacity",this.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1]);return b};
Element.getStyles=document.defaultView&&document.defaultView.getComputedStyle?function(a){var b=document.defaultView.getComputedStyle($(a),null);return Element.CSS_PROPERTIES.inject({},function(c,e){c[e]=b[e];return c})}:function(a){a=$(a);var b=a.currentStyle,c;c=Element.CSS_PROPERTIES.inject({},function(e,f){e[f]=b[f];return e});if(!c.opacity)c.opacity=a.getOpacity();return c};
Effect.Methods={morph:function(a,b,c){a=$(a);new Effect.Morph(a,Object.extend({style:b},c||{}));return a},visualEffect:function(a,b,c){a=$(a);b=b.dasherize().camelize();b=b.charAt(0).toUpperCase()+b.substring(1);new Effect[b](a,c);return a},highlight:function(a,b){a=$(a);new Effect.Highlight(a,b);return a}};
$w("fade appear grow shrink fold blindUp blindDown slideUp slideDown pulsate shake puff squish switchOff dropOut").each(function(a){Effect.Methods[a]=function(b,c){b=$(b);Effect[a.charAt(0).toUpperCase()+a.substring(1)](b,c);return b}});$w("getInlineOpacity forceRerendering setContentZoom collectTextNodes collectTextNodesIgnoreClass getStyles").each(function(a){Effect.Methods[a]=Element[a]});Element.addMethods(Effect.Methods);if(typeof Effect=="undefined")throw"controls.js requires including script.aculo.us' effects.js library";var Autocompleter={};
Autocompleter.Base=Class.create({baseInitialize:function(a,b,c){this.element=a=$(a);this.update=$(b);this.active=this.changed=this.hasFocus=false;this.entryCount=this.index=0;this.oldElementValue=this.element.value;if(this.setOptions)this.setOptions(c);else this.options=c||{};this.options.paramName=this.options.paramName||this.element.name;this.options.tokens=this.options.tokens||[];this.options.frequency=this.options.frequency||0.4;this.options.minChars=this.options.minChars||1;this.options.onShow=
this.options.onShow||function(e,f){if(!f.style.position||f.style.position=="absolute"){f.style.position="absolute";Position.clone(e,f,{setHeight:false,offsetTop:e.offsetHeight})}Effect.Appear(f,{duration:0.15})};this.options.onHide=this.options.onHide||function(e,f){new Effect.Fade(f,{duration:0.15})};if(typeof this.options.tokens=="string")this.options.tokens=new Array(this.options.tokens);this.options.tokens.include("\n")||this.options.tokens.push("\n");this.observer=null;this.element.setAttribute("autocomplete",
"off");Element.hide(this.update);Event.observe(this.element,"blur",this.onBlur.bindAsEventListener(this));Event.observe(this.element,"keydown",this.onKeyPress.bindAsEventListener(this))},show:function(){Element.getStyle(this.update,"display")=="none"&&this.options.onShow(this.element,this.update);if(!this.iefix&&Prototype.Browser.IE&&Element.getStyle(this.update,"position")=="absolute"){new Insertion.After(this.update,'<iframe id="'+this.update.id+'_iefix" style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);" src="javascript:false;" frameborder="0" scrolling="no"></iframe>');
this.iefix=$(this.update.id+"_iefix")}this.iefix&&setTimeout(this.fixIEOverlapping.bind(this),50)},fixIEOverlapping:function(){Position.clone(this.update,this.iefix,{setTop:!this.update.style.height});this.iefix.style.zIndex=1;this.update.style.zIndex=2;Element.show(this.iefix)},hide:function(){this.stopIndicator();Element.getStyle(this.update,"display")!="none"&&this.options.onHide(this.element,this.update);this.iefix&&Element.hide(this.iefix)},startIndicator:function(){this.options.indicator&&Element.show(this.options.indicator)},
stopIndicator:function(){this.options.indicator&&Element.hide(this.options.indicator)},onKeyPress:function(a){if(this.active)switch(a.keyCode){case Event.KEY_TAB:case Event.KEY_RETURN:this.selectEntry();Event.stop(a);case Event.KEY_ESC:this.hide();this.active=false;Event.stop(a);return;case Event.KEY_LEFT:case Event.KEY_RIGHT:return;case Event.KEY_UP:this.markPrevious();this.render();Event.stop(a);return;case Event.KEY_DOWN:this.markNext();this.render();Event.stop(a);return}else if(a.keyCode==Event.KEY_TAB||
a.keyCode==Event.KEY_RETURN||Prototype.Browser.WebKit>0&&a.keyCode==0)return;this.hasFocus=this.changed=true;this.observer&&clearTimeout(this.observer);this.observer=setTimeout(this.onObserverEvent.bind(this),this.options.frequency*1E3)},activate:function(){this.changed=false;this.hasFocus=true;this.getUpdatedChoices()},onHover:function(a){var b=Event.findElement(a,"LI");if(this.index!=b.autocompleteIndex){this.index=b.autocompleteIndex;this.render()}Event.stop(a)},onClick:function(a){this.index=
Event.findElement(a,"LI").autocompleteIndex;this.selectEntry();this.hide()},onBlur:function(){setTimeout(this.hide.bind(this),250);this.active=this.hasFocus=false},render:function(){if(this.entryCount>0){for(var a=0;a<this.entryCount;a++)this.index==a?Element.addClassName(this.getEntry(a),"selected"):Element.removeClassName(this.getEntry(a),"selected");if(this.hasFocus){this.show();this.active=true}}else{this.active=false;this.hide()}},markPrevious:function(){if(this.index>0)this.index--;else this.index=
this.entryCount-1;this.getEntry(this.index).scrollIntoView(true)},markNext:function(){if(this.index<this.entryCount-1)this.index++;else this.index=0;this.getEntry(this.index).scrollIntoView(false)},getEntry:function(a){return this.update.firstChild.childNodes[a]},getCurrentEntry:function(){return this.getEntry(this.index)},selectEntry:function(){this.active=false;this.updateElement(this.getCurrentEntry())},updateElement:function(a){if(this.options.updateElement)this.options.updateElement(a);else{var b=
"";if(this.options.select){var c=$(a).select("."+this.options.select)||[];if(c.length>0)b=Element.collectTextNodes(c[0],this.options.select)}else b=Element.collectTextNodesIgnoreClass(a,"informal");c=this.getTokenBounds();if(c[0]!=-1){var e=this.element.value.substr(0,c[0]),f=this.element.value.substr(c[0]).match(/^\s+/);if(f)e+=f[0];this.element.value=e+b+this.element.value.substr(c[1])}else this.element.value=b;this.oldElementValue=this.element.value;this.element.focus();this.options.afterUpdateElement&&
this.options.afterUpdateElement(this.element,a)}},updateChoices:function(a){if(!this.changed&&this.hasFocus){this.update.innerHTML=a;Element.cleanWhitespace(this.update);Element.cleanWhitespace(this.update.down());if(this.update.firstChild&&this.update.down().childNodes){this.entryCount=this.update.down().childNodes.length;for(a=0;a<this.entryCount;a++){var b=this.getEntry(a);b.autocompleteIndex=a;this.addObservers(b)}}else this.entryCount=0;this.stopIndicator();this.index=0;if(this.entryCount==1&&
this.options.autoSelect){this.selectEntry();this.hide()}else this.render()}},addObservers:function(a){Event.observe(a,"mouseover",this.onHover.bindAsEventListener(this));Event.observe(a,"click",this.onClick.bindAsEventListener(this))},onObserverEvent:function(){this.changed=false;this.tokenBounds=null;if(this.getToken().length>=this.options.minChars)this.getUpdatedChoices();else{this.active=false;this.hide()}this.oldElementValue=this.element.value},getToken:function(){var a=this.getTokenBounds();
return this.element.value.substring(a[0],a[1]).strip()},getTokenBounds:function(){if(null!=this.tokenBounds)return this.tokenBounds;var a=this.element.value;if(a.strip().empty())return[-1,0];for(var b=arguments.callee.getFirstDifferencePos(a,this.oldElementValue),c=b==this.oldElementValue.length?1:0,e=-1,f=a.length,h,l=0,o=this.options.tokens.length;l<o;++l){h=a.lastIndexOf(this.options.tokens[l],b+c-1);if(h>e)e=h;h=a.indexOf(this.options.tokens[l],b+c);if(-1!=h&&h<f)f=h}return this.tokenBounds=[e+
1,f]}});Autocompleter.Base.prototype.getTokenBounds.getFirstDifferencePos=function(a,b){for(var c=Math.min(a.length,b.length),e=0;e<c;++e)if(a[e]!=b[e])return e;return c};
Ajax.Autocompleter=Class.create(Autocompleter.Base,{initialize:function(a,b,c,e){this.baseInitialize(a,b,e);this.options.asynchronous=true;this.options.onComplete=this.onComplete.bind(this);this.options.defaultParams=this.options.parameters||null;this.url=c},getUpdatedChoices:function(){this.startIndicator();var a=encodeURIComponent(this.options.paramName)+"="+encodeURIComponent(this.getToken());this.options.parameters=this.options.callback?this.options.callback(this.element,a):a;if(this.options.defaultParams)this.options.parameters+=
"&"+this.options.defaultParams;new Ajax.Request(this.url,this.options)},onComplete:function(a){this.updateChoices(a.responseText)}});
Autocompleter.Local=Class.create(Autocompleter.Base,{initialize:function(a,b,c,e){this.baseInitialize(a,b,e);this.options.array=c},getUpdatedChoices:function(){this.updateChoices(this.options.selector(this))},setOptions:function(a){this.options=Object.extend({choices:10,partialSearch:true,partialChars:2,ignoreCase:true,fullSearch:false,selector:function(b){for(var c=[],e=[],f=b.getToken(),h=0;h<b.options.array.length&&c.length<b.options.choices;h++)for(var l=b.options.array[h],o=b.options.ignoreCase?
l.toLowerCase().indexOf(f.toLowerCase()):l.indexOf(f);o!=-1;){if(o==0&&l.length!=f.length){c.push("<li><strong>"+l.substr(0,f.length)+"</strong>"+l.substr(f.length)+"</li>");break}else if(f.length>=b.options.partialChars&&b.options.partialSearch&&o!=-1)if(b.options.fullSearch||/\s/.test(l.substr(o-1,1))){e.push("<li>"+l.substr(0,o)+"<strong>"+l.substr(o,f.length)+"</strong>"+l.substr(o+f.length)+"</li>");break}o=b.options.ignoreCase?l.toLowerCase().indexOf(f.toLowerCase(),o+1):l.indexOf(f,o+1)}if(e.length)c=
c.concat(e.slice(0,b.options.choices-c.length));return"<ul>"+c.join("")+"</ul>"}},a||{})}});Field.scrollFreeActivate=function(a){setTimeout(function(){Field.activate(a)},1)};
Ajax.InPlaceEditor=Class.create({initialize:function(a,b,c){this.url=b;this.element=a=$(a);this.prepareOptions();this._controls={};arguments.callee.dealWithDeprecatedOptions(c);Object.extend(this.options,c||{});if(!this.options.formId&&this.element.id){this.options.formId=this.element.id+"-inplaceeditor";if($(this.options.formId))this.options.formId=""}if(this.options.externalControl)this.options.externalControl=$(this.options.externalControl);if(!this.options.externalControl)this.options.externalControlOnly=
false;this._originalBackground=this.element.getStyle("background-color")||"transparent";this.element.title=this.options.clickToEditText;this._boundCancelHandler=this.handleFormCancellation.bind(this);this._boundComplete=(this.options.onComplete||Prototype.emptyFunction).bind(this);this._boundFailureHandler=this.handleAJAXFailure.bind(this);this._boundSubmitHandler=this.handleFormSubmission.bind(this);this._boundWrapperHandler=this.wrapUp.bind(this);this.registerListeners()},checkForEscapeOrReturn:function(a){if(!(!this._editing||
a.ctrlKey||a.altKey||a.shiftKey))if(Event.KEY_ESC==a.keyCode)this.handleFormCancellation(a);else Event.KEY_RETURN==a.keyCode&&this.handleFormSubmission(a)},createControl:function(a,b,c){var e=this.options[a+"Control"];b=this.options[a+"Text"];if("button"==e){c=document.createElement("input");c.type="submit";c.value=b;c.className="editor_"+a+"_button";if("cancel"==a)c.onclick=this._boundCancelHandler;this._form.appendChild(c);this._controls[a]=c}else if("link"==e){e=document.createElement("a");e.href=
"#";e.appendChild(document.createTextNode(b));e.onclick="cancel"==a?this._boundCancelHandler:this._boundSubmitHandler;e.className="editor_"+a+"_link";if(c)e.className+=" "+c;this._form.appendChild(e);this._controls[a]=e}},createEditField:function(){var a=this.options.loadTextURL?this.options.loadingText:this.getText(),b;if(1>=this.options.rows&&!/\r|\n/.test(this.getText())){b=document.createElement("input");b.type="text";var c=this.options.size||this.options.cols||0;if(0<c)b.size=c}else{b=document.createElement("textarea");
b.rows=1>=this.options.rows?this.options.autoRows:this.options.rows;b.cols=this.options.cols||40}b.name=this.options.paramName;b.value=a;b.className="editor_field";if(this.options.submitOnBlur)b.onblur=this._boundSubmitHandler;this._controls.editor=b;this.options.loadTextURL&&this.loadExternalText();this._form.appendChild(this._controls.editor)},createForm:function(){function a(c,e){c=b.options["text"+c+"Controls"];!c||e===false||b._form.appendChild(document.createTextNode(c))}var b=this;this._form=
$(document.createElement("form"));this._form.id=this.options.formId;this._form.addClassName(this.options.formClassName);this._form.onsubmit=this._boundSubmitHandler;this.createEditField();"textarea"==this._controls.editor.tagName.toLowerCase()&&this._form.appendChild(document.createElement("br"));this.options.onFormCustomization&&this.options.onFormCustomization(this,this._form);a("Before",this.options.okControl||this.options.cancelControl);this.createControl("ok",this._boundSubmitHandler);a("Between",
this.options.okControl&&this.options.cancelControl);this.createControl("cancel",this._boundCancelHandler,"editor_cancel");a("After",this.options.okControl||this.options.cancelControl)},destroy:function(){if(this._oldInnerHTML)this.element.innerHTML=this._oldInnerHTML;this.leaveEditMode();this.unregisterListeners()},enterEditMode:function(a){if(!(this._saving||this._editing)){this._editing=true;this.triggerCallback("onEnterEditMode");this.options.externalControl&&this.options.externalControl.hide();
this.element.hide();this.createForm();this.element.parentNode.insertBefore(this._form,this.element);this.options.loadTextURL||this.postProcessEditField();a&&Event.stop(a)}},enterHover:function(){this.options.hoverClassName&&this.element.addClassName(this.options.hoverClassName);this._saving||this.triggerCallback("onEnterHover")},getText:function(){return this.element.innerHTML.unescapeHTML()},handleAJAXFailure:function(a){this.triggerCallback("onFailure",a);if(this._oldInnerHTML){this.element.innerHTML=
this._oldInnerHTML;this._oldInnerHTML=null}},handleFormCancellation:function(a){this.wrapUp();a&&Event.stop(a)},handleFormSubmission:function(a){var b=this._form,c=$F(this._controls.editor);this.prepareSubmission();b=this.options.callback(b,c)||"";if(Object.isString(b))b=b.toQueryParams();b.editorId=this.element.id;if(this.options.htmlResponse){c=Object.extend({evalScripts:true},this.options.ajaxOptions);Object.extend(c,{parameters:b,onComplete:this._boundWrapperHandler,onFailure:this._boundFailureHandler});
new Ajax.Updater({success:this.element},this.url,c)}else{c=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(c,{parameters:b,onComplete:this._boundWrapperHandler,onFailure:this._boundFailureHandler});new Ajax.Request(this.url,c)}a&&Event.stop(a)},leaveEditMode:function(){this.element.removeClassName(this.options.savingClassName);this.removeForm();this.leaveHover();this.element.style.backgroundColor=this._originalBackground;this.element.show();this.options.externalControl&&this.options.externalControl.show();
this._editing=this._saving=false;this._oldInnerHTML=null;this.triggerCallback("onLeaveEditMode")},leaveHover:function(){this.options.hoverClassName&&this.element.removeClassName(this.options.hoverClassName);this._saving||this.triggerCallback("onLeaveHover")},loadExternalText:function(){this._form.addClassName(this.options.loadingClassName);this._controls.editor.disabled=true;var a=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(a,{parameters:"editorId="+encodeURIComponent(this.element.id),
onComplete:Prototype.emptyFunction,onSuccess:function(b){this._form.removeClassName(this.options.loadingClassName);b=b.responseText;if(this.options.stripLoadedTextTags)b=b.stripTags();this._controls.editor.value=b;this._controls.editor.disabled=false;this.postProcessEditField()}.bind(this),onFailure:this._boundFailureHandler});new Ajax.Request(this.options.loadTextURL,a)},postProcessEditField:function(){var a=this.options.fieldPostCreation;if(a)$(this._controls.editor)["focus"==a?"focus":"activate"]()},
prepareOptions:function(){this.options=Object.clone(Ajax.InPlaceEditor.DefaultOptions);Object.extend(this.options,Ajax.InPlaceEditor.DefaultCallbacks);[this._extraDefaultOptions].flatten().compact().each(function(a){Object.extend(this.options,a)}.bind(this))},prepareSubmission:function(){this._saving=true;this.removeForm();this.leaveHover();this.showSaving()},registerListeners:function(){this._listeners={};var a;$H(Ajax.InPlaceEditor.Listeners).each(function(b){a=this[b.value].bind(this);this._listeners[b.key]=
a;this.options.externalControlOnly||this.element.observe(b.key,a);this.options.externalControl&&this.options.externalControl.observe(b.key,a)}.bind(this))},removeForm:function(){if(this._form){this._form.remove();this._form=null;this._controls={}}},showSaving:function(){this._oldInnerHTML=this.element.innerHTML;this.element.innerHTML=this.options.savingText;this.element.addClassName(this.options.savingClassName);this.element.style.backgroundColor=this._originalBackground;this.element.show()},triggerCallback:function(a,
b){"function"==typeof this.options[a]&&this.options[a](this,b)},unregisterListeners:function(){$H(this._listeners).each(function(a){this.options.externalControlOnly||this.element.stopObserving(a.key,a.value);this.options.externalControl&&this.options.externalControl.stopObserving(a.key,a.value)}.bind(this))},wrapUp:function(a){this.leaveEditMode();this._boundComplete(a,this.element)}});Object.extend(Ajax.InPlaceEditor.prototype,{dispose:Ajax.InPlaceEditor.prototype.destroy});
Ajax.InPlaceCollectionEditor=Class.create(Ajax.InPlaceEditor,{initialize:function($super,b,c,e){this._extraDefaultOptions=Ajax.InPlaceCollectionEditor.DefaultOptions;$super(b,c,e)},createEditField:function(){var a=document.createElement("select");a.name=this.options.paramName;a.size=1;this._controls.editor=a;this._collection=this.options.collection||[];this.options.loadCollectionURL?this.loadCollection():this.checkForExternalText();this._form.appendChild(this._controls.editor)},loadCollection:function(){this._form.addClassName(this.options.loadingClassName);
this.showLoadingText(this.options.loadingCollectionText);var a=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(a,{parameters:"editorId="+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(b){b=b.responseText.strip();if(!/^\[.*\]$/.test(b))throw"Server returned an invalid collection representation.";this._collection=eval(b);this.checkForExternalText()}.bind(this),onFailure:this.onFailure});new Ajax.Request(this.options.loadCollectionURL,a)},
showLoadingText:function(a){this._controls.editor.disabled=true;var b=this._controls.editor.firstChild;if(!b){b=document.createElement("option");b.value="";this._controls.editor.appendChild(b);b.selected=true}b.update((a||"").stripScripts().stripTags())},checkForExternalText:function(){this._text=this.getText();this.options.loadTextURL?this.loadExternalText():this.buildOptionList()},loadExternalText:function(){this.showLoadingText(this.options.loadingText);var a=Object.extend({method:"get"},this.options.ajaxOptions);
Object.extend(a,{parameters:"editorId="+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(b){this._text=b.responseText.strip();this.buildOptionList()}.bind(this),onFailure:this.onFailure});new Ajax.Request(this.options.loadTextURL,a)},buildOptionList:function(){this._form.removeClassName(this.options.loadingClassName);this._collection=this._collection.map(function(e){return 2===e.length?e:[e,e].flatten()});var a="value"in this.options?this.options.value:this._text,
b=this._collection.any(function(e){return e[0]==a}.bind(this));this._controls.editor.update("");var c;this._collection.each(function(e,f){c=document.createElement("option");c.value=e[0];c.selected=b?e[0]==a:0==f;c.appendChild(document.createTextNode(e[1]));this._controls.editor.appendChild(c)}.bind(this));this._controls.editor.disabled=false;Field.scrollFreeActivate(this._controls.editor)}});
Ajax.InPlaceEditor.prototype.initialize.dealWithDeprecatedOptions=function(a){function b(c,e){c in a||e===undefined||(a[c]=e)}if(a){b("cancelControl",a.cancelLink?"link":a.cancelButton?"button":a.cancelLink==a.cancelButton==false?false:undefined);b("okControl",a.okLink?"link":a.okButton?"button":a.okLink==a.okButton==false?false:undefined);b("highlightColor",a.highlightcolor);b("highlightEndColor",a.highlightendcolor)}};
Object.extend(Ajax.InPlaceEditor,{DefaultOptions:{ajaxOptions:{},autoRows:3,cancelControl:"link",cancelText:"cancel",clickToEditText:"Click to edit",externalControl:null,externalControlOnly:false,fieldPostCreation:"activate",formClassName:"inplaceeditor-form",formId:null,highlightColor:"#ffff99",highlightEndColor:"#ffffff",hoverClassName:"",htmlResponse:true,loadingClassName:"inplaceeditor-loading",loadingText:"Loading...",okControl:"button",okText:"ok",paramName:"value",rows:1,savingClassName:"inplaceeditor-saving",
savingText:"Saving...",size:0,stripLoadedTextTags:false,submitOnBlur:false,textAfterControls:"",textBeforeControls:"",textBetweenControls:""},DefaultCallbacks:{callback:function(a){return Form.serialize(a)},onComplete:function(a,b){new Effect.Highlight(b,{startcolor:this.options.highlightColor,keepBackgroundImage:true})},onEnterEditMode:null,onEnterHover:function(a){a.element.style.backgroundColor=a.options.highlightColor;a._effect&&a._effect.cancel()},onFailure:function(a){alert("Error communication with the server: "+
a.responseText.stripTags())},onFormCustomization:null,onLeaveEditMode:null,onLeaveHover:function(a){a._effect=new Effect.Highlight(a.element,{startcolor:a.options.highlightColor,endcolor:a.options.highlightEndColor,restorecolor:a._originalBackground,keepBackgroundImage:true})}},Listeners:{click:"enterEditMode",keydown:"checkForEscapeOrReturn",mouseover:"enterHover",mouseout:"leaveHover"}});Ajax.InPlaceCollectionEditor.DefaultOptions={loadingCollectionText:"Loading options..."};
Form.Element.DelayedObserver=Class.create({initialize:function(a,b,c){this.delay=b||0.5;this.element=$(a);this.callback=c;this.timer=null;this.lastValue=$F(this.element);Event.observe(this.element,"keyup",this.delayedListener.bindAsEventListener(this))},delayedListener:function(){if(this.lastValue!=$F(this.element)){this.timer&&clearTimeout(this.timer);this.timer=setTimeout(this.onTimerEvent.bind(this),this.delay*1E3);this.lastValue=$F(this.element)}},onTimerEvent:function(){this.timer=null;this.callback(this.element,
$F(this.element))}});var RFC822SingleEmailRegex=/^(?:[^\x00-\x2a\x2c\x2e\x2f\x3a-\x40\x5b-\x5e\x60\x7b-\xff]+|\x22(?:[^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(?:\x2e(?:[^\x00-\x2a\x2c\x2e\x2f\x3a-\x40\x5b-\x5e\x60\x7b-\xff]+|\x22(?:[^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40(?:[^\x00-\x2a\x2c\x2e\x2f\x3a-\x40\x5b-\x5e\x60\x7b-\xff]+|\x5b(?:[^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(?:\x2e(?:[^\x00-\x2a\x2c\x2e\x2f\x3a-\x40\x5b-\x5e\x60\x7b-\xff]+|\x5b(?:[^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))+$/;
if(!document.onunload)document.onunload=function(){};function makeDynamicFrameTarget(a){var b="dynamic_frame_"+ +new Date,c=(new Element("iframe",{name:b})).setStyle({display:"none"});$(document.body).insert(c);a.target=b}function makeDynamicFrameTargetForUrl(a){a=(new Element("form",{action:a,method:"post"})).setStyle({display:"none"});$(document.body).insert(a);makeDynamicFrameTarget(a);return a}var lastFacebookStatus="unknown";
function requestAdditionalPermissions(){disableFacebookButtons();FB.login(function(a){FacebookApiLoader.updateLoginStatus();setTimeout(function(){window.location.reload()},2E3)},{scope:"email, user_birthday, publish_actions"})}function disableFacebookButtons(){$$("a.sprite_facebook").each(function(a){var b;a.hide();if(!a.next(".spinner")){b=a.hasClassName("no_inverse");a.insert({after:'<span class="spinner facebook_spinner'+(b?"":" spinner_inverse")+'">loading&hellip;</span>'})}})}
function reenableFacebookButtons(){$$("a.sprite_facebook").each(function(a){a.show();(a=a.next(".spinner"))&&a.remove()})}
function showFacebookErrorLightbox(){var a,b;if(active_user.isAuthenticated())a='<h1 class="phl">There\'s been an error!</h1><p class="regtext mhl mvm">The connection with Facebook\'s servers has timed out. Please refresh your page and try the linking process again.</p>';else{a='<h1 class="phl">There\'s been an error!</h1><p class="regtext mhl mvm">We were unable to create a Kongregate account with Facebook.</p><p class="regtext mhl mvm">Click on "Create My Account" below to create a Kongregate account using your email address instead.</p><a id="error_signup_link" href="#" class="submission_button mhl mvm">Create My Account</a>';b=
function(){$("error_signup_link").observe("click",function(e){e.preventDefault();try{lightbox.prototype.shutdown()}catch(f){}lightbox.prototype.initializeKongregateLightboxFromAjax("/accounts/new/behind_login?no_facebook_connect=true&game_id="+active_user.gameId(),{afterStaticContentLoad:function(){lightbox.prototype.toggleRegistration();$("lightbox_email_register").show();$("lightbox_facebook_register").hide();$("lightbox").removeClassName("lightbox_login")}})})}}try{lightbox.prototype.shutdown()}catch(c){}lightbox.prototype.initializeKongregateLightboxFromContent(a,
{done_class_name:"lightbox_login",afterStaticContentLoad:b});reenableFacebookButtons()}function showMatchingUserForm(a,b,c){a="/facebook_connection/login_lightbox?username="+a+"&matched_on="+b;if(active_user.gameId())a+="&game_id="+active_user.gameId();try{lightbox.prototype.shutdown()}catch(e){}lightbox.prototype.initializeKongregateLightboxFromAjax(a,{done_class_name:"lightbox_login"})}function write_to_document(a){document.write(a)}
function toggleTabs(a,b){Element.show(a);Element.show(a+"_title");Element.show(b+"_link");Element.hide(b);Element.hide(b+"_title");Element.hide(a+"_link");$(a+"_tab").className="tab current";$(b+"_tab").className="tab"}
var TopicForm={editNewTitle:function(a){$("new_topic").innerHTML=a.value.length>5?a.value:"New Topic"}},EditForm={init:function(a){$("edit-post-"+a+"_spinner").show();this.clearReplyId()},setReplyId:function(a){$("edit").setAttribute("post_id",a.toString());$("posts-"+a+"-row").addClassName("editing");$("reply")&&$("reply").hide()},clearReplyId:function(){var a=this.currentReplyId();if(!(!a||a==="")){(a=$("posts-"+a+"-row"))&&a.removeClassName("editing");$("edit").setAttribute("post_id","")}},currentReplyId:function(){return $("edit").getAttribute("post_id")},
isEditing:function(a){if(this.currentReplyId()==a.toString()){$("edit").show();$("edit_post_body").focus();return true}return false},cancel:function(){this.clearReplyId();$("edit").hide()}},ReplyForm={init:function(){EditForm.cancel();$("reply").toggle();$("post_body").focus()}};function showChatSelector(a,b){new lightbox("/rooms/change?game_rooms="+a+"&game_id="+b)}function limitText(a,b){if(a.value.length>b)a.value=a.value.substring(0,b)}
function limitCheckedBoxes(a,b,c){for(var e=0,f=0;f<a.length;f++)e+=a[f].checked?1:0;if(e>b)a[c].checked=false}function observePopup(a,b,c,e){var f=window.open(a,"",c||""),h=setInterval(function(){try{if(f.closed){clearInterval(h);e()}}catch(l){clearInterval(h)}},100);return f}Prototype.Platform={Windows:!!navigator.platform.match(/Win/),Macintosh:!!navigator.platform.match(/Mac/),Linux:!!navigator.platform.match(/Linux/)};
Hash.prototype.getWithDefault=function(a,b){var c=this.get(a);return undefined==c?this.set(a,b()):c};Hash.prototype.getOrSet=function(a,b){var c=this.get(a);return undefined==c?this.set(a,b):c};Element.addMethods("textarea",{positionCaretAtEnd:function(a){a=$(a);if(a.createTextRange){var b=a.createTextRange();b.move("character",a.value.length);b.select()}else if(a.selectionStart!==null){b=a.value.length;a.focus();a.setSelectionRange(b,b)}else{a.focus();a.value+=""}return a}});
Element.addMethods({ieHappyHide:function(a){a=$(a);a.style.display="none";a.style.visibility="hidden";return a},ieHappyShow:function(a){a=$(a);a.style.display="";a.style.visibility="visible";return a},setText:function(a,b){a=$(a);a[Prototype.Browser.Gecko?"textContent":"innerText"]=b;return a}});String.prototype.evalScripts=function(){return this.extractScripts?this.extractScripts().map(function(a){return eval(a)}):this};
function autoTruncate(a,b){b||(b=1);$$("."+a).each(function(c){var e=c.down("a"),f=e.getStyle("font-size");c=c.getWidth();var h=11;if(f)h=parseInt(f.sub("px",""),10);f=e.innerHTML;c=Math.round(c/(h-4.5)*b);e.update(f.truncate(c))})}function insertTrackingPixelWithTimestamp(a){stamp=+new Date;document.write('<img src="'+a+stamp+'?"/>')}
Prototype.Browser.Gecko&&function(){Event.observe(document,"keypress",function(a){if(a.keyCode==Event.KEY_TAB)if("select,input,button,textarea".indexOf(a.target.nodeName.toLowerCase())>-1){var b=$(a.target),c=b.up("form").getElements().findAll(function(f){return"hidden"!=f.type&&!f.disabled});b=c.indexOf(b);var e=null;if(e=a.shiftKey?b-1>=0?c[b-1]:null:b+1<c.length?c[b+1]:null){a.stop();e.focus()}}})}();function CommentsController(a){this.initialize(a)}
CommentsController.prototype={initialize:function(a){this._comments_path=a.comments_path;this._hidden_threshold=a.hidden_threshold;this._active_user=a.active_user;this._comment_ids=a.comment_ids;this._top_comments=a.top_comments;this._show_blog_comment=a.show_blog_comment;this._call_to_action=a.call_to_action},showNewCommentForm:function(a){if(a==undefined)a="";if(this._call_to_action||this._active_user.isAuthenticated()){try{holodeck.recordAnalyticsEvent("Comments","Add")}catch(b){}$("commentutility")&&
Element.hide("commentutility"+a);Element.show("comment_new"+a)}},showReplyToCommentForm:function(a){$("reply_to_comment").show();$("comment_"+a).insert($("reply_to_comment"));$("response_content").value="";a=a;$("reply_to_comment_submit").stopObserving("click");$("reply_to_comment_submit").on("click",function(){comments_controller.replyToComment(a)})},showEditReplyToCommentForm:function(a){$("reply_to_comment").show();$("comment_response_"+a).insert($("reply_to_comment"));$("response_content").value=
$("comment_response_content_"+a).innerHTML;a=a;$("reply_to_comment_submit").stopObserving("click");$("reply_to_comment_submit").on("click",function(){comments_controller.replyToComment(a)})},resetNewCommentForm:function(a){if(a==undefined)a="";$("comment_content"+a).value="";$("comment_errors"+a).hide();Element.hide("comment_new"+a);this.reenableNewCommentForm(a);$("commentutility")&&$("commentutility"+a).show()},reenableNewCommentForm:function(a){if(a==undefined)a="";Element.hide("comment_indicator"+
a);$("post_comment_submit"+a).disabled=false},submitNewCommentForm:function(a,b){if(b==undefined)b="";var c=this;Element.show("comment_indicator"+b);$("post_comment_submit"+b).disabled=true;c._call_to_action&&$("post_comment_submit"+b).hide();$(a).request({method:"post",onSuccess:function(e){var f;if(c._call_to_action){(f=$("added_comments_list"))&&f.insert({top:e.responseText});window.location.hash="_";window.location.hash="recent_comments";e=f.down();new Effect.Highlight(e,{});active_user.isFacebookConnected()||
e.insert({after:$("facebook_comment_upsell").show()})}else(f=$$(".comment_list").first())&&f.insert(e.responseText);$("no_comments").hide();c.resetNewCommentForm(b);if(c._call_to_action){$("comment_indicator"+b).hide();$("post_comment_submit"+b).show();c.showNewCommentForm(b)}urchinTracker("/new_comment")},on400:function(e){c.showNewCommentErrors(e.responseText,b)},on500:function(){c.showNewCommentErrors("A server error occured.",b)}})},showNewCommentErrors:function(a,b){if(b==undefined)b="";var c=
$("comment_errors"+b);c.show();c.update(a);if(this._call_to_action){$("comment_indicator"+b).hide();$("post_comment_submit"+b).show()}this.reenableNewCommentForm(b)},userSilenced:function(){var a=$("comment_user_silenced");$("comment_add_a_comment").hide();a.update(this._active_user.silencedMessage());a.show()},checkUserSilenced:function(){this._active_user.isSilenced()&&this.userSilenced()},lightUpSingleComment:function(a,b){a=$("comment_"+a);a.removeClassName("rated_negative");a.removeClassName("rated_positive");
a.addClassName(b?"rated_positive":"rated_negative")},currentRating:function(a){var b=$("comment_current_rating_"+a).innerHTML;return isNaN(b)?NaN:parseInt($("comment_current_rating_"+a).innerHTML,10)},opinionForComment:function(a){a=$("comment_"+a);return a.hasClassName("rated_negative")?false:a.hasClassName("rated_positive")?true:null},rateComment:function(a,b){var c=this.opinionForComment(a);if(c!==b){var e=this.currentRating(a);if(c===true)e-=1;else if(c===false)e+=1;if(b===true)e+=1;else if(b===
false)e-=1;c=$("comment_"+a);$("comment_rating_area_"+a);var f=this;this.hideRatingLinks(a);isNaN(e)||$("comment_current_rating_"+a).update(e);c.removeClassName("below_threshold");c.removeClassName("above_threshold");c.addClassName(e>this._hidden_threshold||isNaN(e)?"above_threshold":"below_threshold");this.lightUpSingleComment(a,b);new Ajax.Request(this._comments_path+"/"+a+"/ratings.js",{parameters:{opinion:b},onComplete:function(){f.showRatingLinks(a)}})}},flagComment:function(a){var b=this;this.hideRatingLinks(a);
new Ajax.Request(this._comments_path+"/"+a+"/flaggings.js",{onComplete:function(){b.showRatingLinks(a);$("comment_flagged_"+a).show();$("comment_flagged_"+a).update("<span>This comment has been flagged for review.</span>")}})},hideRatingLinks:function(a){var b=$("comment_rating_links_"+a),c=$("flag_indicator_"+a);a=$("comment_status_"+a);c.show();a.hide();b.hide()},showRatingLinks:function(a){var b=$("comment_rating_links_"+a),c=$("flag_indicator_"+a);a=$("comment_status_"+a);c.hide();b.show();a.show()},
showCommentContent:function(a){Element.hide("show_comment_content_"+a);Element.show("hide_comment_content_"+a);Element.show("comment_content_"+a)},hideCommentContent:function(a){Element.show("show_comment_content_"+a);Element.hide("hide_comment_content_"+a);Element.hide("comment_content_"+a)},removeComment:function(a){var b=this._comments_path+"/"+a+".js",c=$("flag_indicator_"+a),e=$("remove_comment_"+a),f=$("comment_"+a);c.show();e.hide();new Ajax.Request(b,{method:"delete",onSuccess:function(){f.remove()}})},
spamComment:function(a){var b=this._comments_path+"/"+a+"/spam.js",c=$("flag_indicator_"+a),e=$("spam_comment_"+a),f=$("comment_"+a);c.show();e.hide();new Ajax.Request(b,{method:"post",onSuccess:function(){f.remove()}})},replyToComment:function(a){var b=this._comments_path+"/"+a+"/reply",c=$("flag_indicator_"+a),e=$("reply_to_comment_"+a),f=$("comment_"+a);c.show();e&&e.hide();new Ajax.Request(b,{method:"post",parameters:{response_content:$("response_content").value,show_blog_comment:this._show_blog_comment},
onSuccess:function(h){var l=$("reply_to_comment");l.hide();$$(".user_message").last().insert({after:l});f.replace(h.responseText);comments_controller.showAdminControls();c.hide()}})},cancelReply:function(){$("reply_to_comment").hide();$("response_content").value=""},checkUserRatingStatus:function(){var a=this;(function(){new Ajax.Request(this._active_user.accountUrl()+"/comment_ratings.json",{method:"get",parameters:{comment_ids:Object.toJSON(this._comment_ids),game_id:this._active_user.gameId(),
top_comments:this._top_comments?true:""},onSuccess:function(b){a.lightUpComments(b.responseJSON)}})}).bind(this).runWhenDomLoaded(true)},clearReply:function(a){var b=this._comments_path+"/"+a+"/clear_reply",c=$("flag_indicator_"+a),e=$("clear_reply_to_comment_"+a),f=$("reply_to_comment_"+a),h=$("comment_"+a);c.show();e.hide();new Ajax.Request(b,{method:"post",onSuccess:function(){c.hide();f.show();h.down(".comment_reply").remove()}})},lightUpComments:function(a){var b=this;$H(a).each(function(c){b.lightUpSingleComment(c.key,
c.value)})},showAdminControls:function(){if(active_user.isAdmin()){$$(".admin_controls").each(Element.show);$$(".developer_controls").each(Element.show)}else active_user.isDeveloperOfGame()&&$$(".developer_controls").each(Element.show)}};FeedbackFormBuilder=Class.create();FeedbackFormType=Class.create();FeedbackFormType.prototype={initialize:function(a,b,c,e,f){this.type=a;this.property_class=b;this.desc_text_area=c;this.sidebar_id=e;this.login_required=f}};FeedbackFormBuilder.FEEDBACK_DESCRIPTION_TEXT_LIMIT=2E3;
FeedbackFormBuilder.selectAccomplishment=function(a){if(a=="")$("missing_accomplishment_options").innerHTML="Please select a game";else{$("missing_accomplishment_options").hide();$("missing_accomplishment_spinner").show();new Ajax.Request("/feedbacks/missing_accomplishments_for.json?game_id="+a,{method:"get",onComplete:function(b){$("missing_accomplishment_spinner").hide();$("missing_accomplishment_options").update(b.responseJSON.select_html).show()}})}};
FeedbackFormBuilder.prototype={initialize:function(a){var b=$("select_topic").options[$("select_topic").selectedIndex].value;this.currentTextArea=null;this._character_count_message_node=$("character_count_message");this._character_count_node=this._character_count_message_node.down("#character_count");this._character_count_node.update(FeedbackFormBuilder.FEEDBACK_DESCRIPTION_TEXT_LIMIT);this._addCharCounterToTextAreas();this._element=$(a);this._classes=new Array("abuse","general","game_missing_accomplishment",
"game_bug");this.types=[new FeedbackFormType("Feedback","general","feedback_general_content","general_feedback_instructions"),new FeedbackFormType("BugReport","general","feedback_general_content","general_bug_feedback_instructions"),new FeedbackFormType("FeatureRequest","general","feedback_general_content","general_feedback_instructions"),new FeedbackFormType("AdvertisingInquiryFeedback","general","feedback_general_content","advertiser_feedback_instructions"),new FeedbackFormType("MediaOpportunityFeedback",
"general","feedback_general_content","media_opportunity_feedback_instructions"),new FeedbackFormType("ArcadeAppFeedback","general","feedback_general_content","kongregate_arcade_feedback_instructions"),new FeedbackFormType("OtherInquiryFeedback","general","feedback_general_content","general_feedback_instructions"),new FeedbackFormType("DevelopmentSupportFeedback","general","feedback_general_content","developer_support_feedback_instructions"),new FeedbackFormType("AbusiveUser","abuse","feedback_abuse_content",
"abusive_user_feedback_instructions"),new FeedbackFormType("MissingAccomplishmentFeedback","game_missing_accomplishment","feedback_missing_accomplishment_content","missing_accomplishment_feedback_instructions",true),new FeedbackFormType("GameBugReport","game_bug","feedback_game_bug_content","game_bug_feedback_instructions"),new FeedbackFormType("PowerupRewardsFeedback","general","feedback_general_content","power_up_rewards_instructions")];this._text_area_names=this.types.map(function(c){return c.desc_text_area}).uniq();
this._sidebar_ids=this.types.map(function(c){return c.sidebar_id}).uniq();this._clearContentExcept(b);this._hideAll();this.subjectChanged();this._setSubmitState()},_findTypeByTypeStr:function(a){return this.types.find(function(b){return b.type==a})},_clearContentExcept:function(a){var b=this._findTypeByTypeStr(a);this._text_area_names.each(function(c){if(c!=b.desc_text_area)$(c).value=""})},_hideAll:function(){this._classes.each(function(a){this._getElementsForClass(a).each(function(b){b.hide()})}.bind(this));
this._hideSidebars()},_hideSidebars:function(){this._sidebar_ids.each(function(a){$(a).hide()})},_showType:function(a){this.type=a=this._findTypeByTypeStr(a);this.showElementsOfClass(a.property_class);this._showSidebarForType(a);this.copyContent(a.desc_text_area)},_showSidebarForType:function(a){$(a.sidebar_id).show()},copyContent:function(a){a=$(a);if(this.currentTextArea&&this.currentTextArea!=a){a.value=this.currentTextArea.value;this.currentTextArea.value=""}this.currentTextArea=a},_setSubmitState:function(){if($F("select_topic")==
"Feedback"){$("feedback_submit_button").disable();$("feedback_submission_warning").show()}else{$("feedback_submit_button").enable();$("feedback_submission_warning").hide()}},_getElementsForClass:function(a){return this._element.select("."+a)},showElementsOfClass:function(a){this._getElementsForClass(a).each(function(b){b.show()})},select:function(a){this._hideAll();this._showType(a)},_loginRequired:function(){return typeof this.type!="undefined"&&this.type.login_required},_enableForm:function(){$("login_message").hide();
$("feedback_form_form").enable();$("feedback_submit_button").show()},_disableForm:function(){$("login_message").show();$("feedback_form_form").disable();$("select_topic").enable();$("feedback_submit_button").hide()},subjectChanged:function(){var a=$F("select_topic");this.select(a);this._loginRequired()&&!active_user.isAuthenticated()?this._disableForm():this._enableForm();var b=$("chooser"),c=$("feedback_game_id");c.onchange=function(){};a=="GameBugReport"&&$("game_bug_input_cell").appendChild(b);
if(a=="MissingAccomplishmentFeedback"){$("game_missing_accomplishment_input_cell").appendChild(b);c.onchange=function(){FeedbackFormBuilder.selectAccomplishment(c.value)};c.value!=""&&c.onchange()}this._setSubmitState()},_spin:function(){$("feedback_form_content").style.display="none";$("feedback_spinner").style.display="block"},_unspin:function(){$("feedback_spinner").style.display="none";$("feedback_form_content").style.display="block"},_addCharCounterToTextAreas:function(){var a=this;$$(".feedback_text_area").each(function(b){b.observe("keyup",
a._checkCharCount)})},_checkCharCount:function(){var a=this.getValue().length;a=FeedbackFormBuilder.FEEDBACK_DESCRIPTION_TEXT_LIMIT-a;feedbackFormBuilder._character_count_node.update(a);a<0?feedbackFormBuilder._character_count_message_node.addClassName("negative"):feedbackFormBuilder._character_count_message_node.removeClassName("negative")}};Function.prototype.runWhenDomLoaded=function(a){if(a&&window.gameLoadObserver)this.runWhenGameLoaded();else if(document.loaded)this.defer();else{var b=this;document.observe("dom:loaded",function(){b()})}};function GameLoadObserver(a){this.initialize(a)}
GameLoadObserver.prototype=function(){return{initialize:function(a){this._loaded=false;this._startTime=(new Date).getTime();this._timeout=a.timeout||3E3;this._interval=null;this._debug=a.debug;this._queue=[];this.startObserving.bind(this).runWhenDomLoaded()},percentLoaded:function(){if($("gamediv"))try{return $("gamediv").PercentLoaded()}catch(a){return-1}},observeGameLoad:function(){var a=(new Date).getTime()-this._startTime,b=a>=this._timeout,c=this.percentLoaded();if(c>0||b){this._debug&&console.log("Firing onGameLoaded, percentLoaded: "+
c+", timeElapsed: "+a+", timedOut: "+b);this.onGameLoaded()}else if(c<0){this._debug&&console.log("Firing onGameLoaded, no flash gamediv found, percentLoaded: "+c+", timeElapsed: "+a);this.onGameLoaded()}},onGameLoaded:function(){if(!this._loaded){this._loaded=true;clearInterval(this._interval);this._queue.each(function(a){a.defer()});this._queue=[]}},runWhenGameLoaded:function(a){this._loaded?a.defer():this._queue.push(a)},startObserving:function(){this._interval&&clearInterval(this._interval);this._interval=
setInterval(this.observeGameLoad.bind(this),100)}}}();Function.prototype.runWhenGameLoaded=function(){window.gameLoadObserver?window.gameLoadObserver.runWhenGameLoaded(this):this.runWhenDomLoaded()};Cookie={set:function(a,b,c,e){a=encodeURIComponent(a)+"="+encodeURIComponent(b||"");if(c!==undefined){b=new Date;b.setTime(b.getTime()+864E5*parseFloat(c));a+="; expires="+b.toGMTString()}a+=e?"; path="+e:"; path=/";return document.cookie=a},setWithDate:function(a,b,c){a=encodeURIComponent(a)+"="+encodeURIComponent(b||"");if(c!==undefined)a+="; expires="+c.toGMTString();a+="; path=/";return document.cookie=a},get:function(a){return(a=document.cookie.match(new RegExp("(^|;)\\s*"+encodeURIComponent(a)+
"=([^;\\s]*)")))?decodeURIComponent(a[2].gsub(/\+/," ")):null},erase:function(a,b){var c=Cookie.get(a)||true;Cookie.set(a,"",-1,b);return c},accept:function(){if(typeof navigator.cookieEnabled=="boolean")return navigator.cookieEnabled;Cookie.set("_test","1");return Cookie.erase("_test")==="1"}};var swfobject=function(){function a(){if(!Z){try{var G=L.getElementsByTagName("body")[0].appendChild(F("span"));G.parentNode.removeChild(G)}catch(M){return}Z=true;G=S.length;for(var W=0;W<G;W++)S[W]()}}function b(G){if(Z)G();else S[S.length]=G}function c(G){if(typeof C.addEventListener!=r)C.addEventListener("load",G,false);else if(typeof L.addEventListener!=r)L.addEventListener("load",G,false);else if(typeof C.attachEvent!=r)g(C,"onload",G);else if(typeof C.onload=="function"){var M=C.onload;C.onload=
function(){M();G()}}else C.onload=G}function e(){E?f():h()}function f(){var G=L.getElementsByTagName("body")[0],M=F(z);M.setAttribute("type",H);var W=G.appendChild(M);if(W){var ba=0;(function(){if(typeof W.GetVariable!=r){var D=W.GetVariable("$version");if(D){D=D.split(" ")[1].split(",");X.pv=[parseInt(D[0],10),parseInt(D[1],10),parseInt(D[2],10)]}}else if(ba<10){ba++;setTimeout(arguments.callee,10);return}G.removeChild(M);W=null;h()})()}else h()}function h(){var G=J.length;if(G>0)for(var M=0;M<G;M++){var W=
J[M].id,ba=J[M].callbackFn,D={success:false,id:W};if(X.pv[0]>0){var K=s(W);if(K)if(j(J[M].swfVersion)&&!(X.wk&&X.wk<312)){t(W,true);if(ba){D.success=true;D.ref=l(W);ba(D)}}else if(J[M].expressInstall&&o()){D={};D.data=J[M].expressInstall;D.width=K.getAttribute("width")||"0";D.height=K.getAttribute("height")||"0";if(K.getAttribute("class"))D.styleclass=K.getAttribute("class");if(K.getAttribute("align"))D.align=K.getAttribute("align");var ea={};K=K.getElementsByTagName("param");for(var ha=K.length,
ja=0;ja<ha;ja++)if(K[ja].getAttribute("name").toLowerCase()!="movie")ea[K[ja].getAttribute("name")]=K[ja].getAttribute("value");n(D,ea,W,ba)}else{p(K);ba&&ba(D)}}else{t(W,true);if(ba){if((W=l(W))&&typeof W.SetVariable!=r){D.success=true;D.ref=W}ba(D)}}}}function l(G){var M=null;if((G=s(G))&&G.nodeName=="OBJECT")if(typeof G.SetVariable!=r)M=G;else if(G=G.getElementsByTagName(z)[0])M=G;return M}function o(){return!ga&&j("6.0.65")&&(X.win||X.mac)&&!(X.wk&&X.wk<312)}function n(G,M,W,ba){ga=true;Q=ba||
null;da={success:false,id:W};var D=s(W);if(D){if(D.nodeName=="OBJECT"){Y=y(D);R=null}else{Y=D;R=W}G.id=u;if(typeof G.width==r||!/%$/.test(G.width)&&parseInt(G.width,10)<310)G.width="310";if(typeof G.height==r||!/%$/.test(G.height)&&parseInt(G.height,10)<137)G.height="137";L.title=L.title.slice(0,47)+" - Flash Player Installation";ba=X.ie&&X.win?"ActiveX":"PlugIn";ba="MMredirectURL="+encodeURI(C.location).toString().replace(/&/g,"%26")+"&MMplayerType="+ba+"&MMdoctitle="+L.title;if(typeof M.flashvars!=
r)M.flashvars+="&"+ba;else M.flashvars=ba;if(X.ie&&X.win&&D.readyState!=4){ba=F("div");W+="SWFObjectNew";ba.setAttribute("id",W);D.parentNode.insertBefore(ba,D);D.style.display="none";(function(){D.readyState==4?D.parentNode.removeChild(D):setTimeout(arguments.callee,10)})()}m(G,M,W)}}function p(G){if(X.ie&&X.win&&G.readyState!=4){var M=F("div");G.parentNode.insertBefore(M,G);M.parentNode.replaceChild(y(G),M);G.style.display="none";(function(){G.readyState==4?G.parentNode.removeChild(G):setTimeout(arguments.callee,
10)})()}else G.parentNode.replaceChild(y(G),G)}function y(G){var M=F("div");if(X.win&&X.ie)M.innerHTML=G.innerHTML;else if(G=G.getElementsByTagName(z)[0])if(G=G.childNodes)for(var W=G.length,ba=0;ba<W;ba++)!(G[ba].nodeType==1&&G[ba].nodeName=="PARAM")&&G[ba].nodeType!=8&&M.appendChild(G[ba].cloneNode(true));return M}function m(G,M,W){var ba,D=s(W);if(X.wk&&X.wk<312)return ba;if(D){if(typeof G.id==r)G.id=W;if(X.ie&&X.win){var K="";for(var ea in G)if(G[ea]!=Object.prototype[ea])if(ea.toLowerCase()==
"data")M.movie=G[ea];else if(ea.toLowerCase()=="styleclass")K+=' class="'+G[ea]+'"';else if(ea.toLowerCase()!="classid")K+=" "+ea+'="'+G[ea]+'"';ea="";for(var ha in M)if(M[ha]!=Object.prototype[ha])ea+='<param name="'+ha+'" value="'+M[ha]+'" />';D.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+K+">"+ea+"</object>";I[I.length]=G.id;ba=s(G.id)}else{ha=F(z);ha.setAttribute("type",H);for(K in G)if(G[K]!=Object.prototype[K])if(K.toLowerCase()=="styleclass")ha.setAttribute("class",
G[K]);else K.toLowerCase()!="classid"&&ha.setAttribute(K,G[K]);for(var ja in M)M[ja]!=Object.prototype[ja]&&ja.toLowerCase()!="movie"&&v(ha,ja,M[ja]);D.parentNode.replaceChild(ha,D);ba=ha}}return ba}function v(G,M,W){var ba=F("param");ba.setAttribute("name",M);ba.setAttribute("value",W);G.appendChild(ba)}function A(G){var M=s(G);if(M&&M.nodeName=="OBJECT")if(X.ie&&X.win){M.style.display="none";(function(){M.readyState==4?B(G):setTimeout(arguments.callee,10)})()}else M.parentNode.removeChild(M)}function B(G){if(G=
s(G)){for(var M in G)if(typeof G[M]=="function")G[M]=null;G.parentNode.removeChild(G)}}function s(G){var M=null;try{M=L.getElementById(G)}catch(W){}return M}function F(G){return L.createElement(G)}function g(G,M,W){G.attachEvent(M,W);N[N.length]=[G,M,W]}function j(G){var M=X.pv;G=G.split(".");G[0]=parseInt(G[0],10);G[1]=parseInt(G[1],10)||0;G[2]=parseInt(G[2],10)||0;return M[0]>G[0]||M[0]==G[0]&&M[1]>G[1]||M[0]==G[0]&&M[1]==G[1]&&M[2]>=G[2]?true:false}function q(G,M,W,ba){if(!(X.ie&&X.mac)){var D=
L.getElementsByTagName("head")[0];if(D){W=W&&typeof W=="string"?W:"screen";if(ba)O=V=null;if(!V||O!=W){ba=F("style");ba.setAttribute("type","text/css");ba.setAttribute("media",W);V=D.appendChild(ba);if(X.ie&&X.win&&typeof L.styleSheets!=r&&L.styleSheets.length>0)V=L.styleSheets[L.styleSheets.length-1];O=W}if(X.ie&&X.win)V&&typeof V.addRule==z&&V.addRule(G,M);else V&&typeof L.createTextNode!=r&&V.appendChild(L.createTextNode(G+" {"+M+"}"))}}}function t(G,M){if(U){M=M?"visible":"hidden";if(Z&&s(G))s(G).style.visibility=
M;else q("#"+G,"visibility:"+M)}}function w(G){return/[\\\"<>\.;]/.exec(G)!=null&&typeof encodeURIComponent!=r?encodeURIComponent(G):G}var r="undefined",z="object",H="application/x-shockwave-flash",u="SWFObjectExprInst",C=window,L=document,T=navigator,E=false,S=[e],J=[],I=[],N=[],Y,R,Q,da,Z=false,ga=false,V,O,U=true,X=function(){var G=typeof L.getElementById!=r&&typeof L.getElementsByTagName!=r&&typeof L.createElement!=r,M=T.userAgent.toLowerCase(),W=T.platform.toLowerCase(),ba=W?/win/.test(W):/win/.test(M);
W=W?/mac/.test(W):/mac/.test(M);M=/webkit/.test(M)?parseFloat(M.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false;var D=!+"\u000b1",K=[0,0,0],ea=null;if(typeof T.plugins!=r&&typeof T.plugins["Shockwave Flash"]==z){if((ea=T.plugins["Shockwave Flash"].description)&&!(typeof T.mimeTypes!=r&&T.mimeTypes[H]&&!T.mimeTypes[H].enabledPlugin)){E=true;D=false;ea=ea.replace(/^.*\s+(\S+\s+\S+$)/,"$1");K[0]=parseInt(ea.replace(/^(.*)\..*$/,"$1"),10);K[1]=parseInt(ea.replace(/^.*\.(.*)\s.*$/,"$1"),10);K[2]=/[a-zA-Z]/.test(ea)?
parseInt(ea.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else if(typeof C.ActiveXObject!=r)try{var ha=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(ha)if(ea=ha.GetVariable("$version")){D=true;ea=ea.split(" ")[1].split(",");K=[parseInt(ea[0],10),parseInt(ea[1],10),parseInt(ea[2],10)]}}catch(ja){}return{w3:G,pv:K,wk:M,ie:D,win:ba,mac:W}}();(function(){if(X.w3){if(typeof L.readyState!=r&&L.readyState=="complete"||typeof L.readyState==r&&(L.getElementsByTagName("body")[0]||L.body))a();if(!Z){typeof L.addEventListener!=
r&&L.addEventListener("DOMContentLoaded",a,false);if(X.ie&&X.win){L.attachEvent("onreadystatechange",function(){if(L.readyState=="complete"){L.detachEvent("onreadystatechange",arguments.callee);a()}});C==top&&function(){if(!Z){try{L.documentElement.doScroll("left")}catch(G){setTimeout(arguments.callee,0);return}a()}}()}X.wk&&function(){Z||(/loaded|complete/.test(L.readyState)?a():setTimeout(arguments.callee,0))}();c(a)}}})();(function(){X.ie&&X.win&&window.attachEvent("onunload",function(){for(var G=
N.length,M=0;M<G;M++)N[M][0].detachEvent(N[M][1],N[M][2]);G=I.length;for(M=0;M<G;M++)A(I[M]);for(var W in X)X[W]=null;X=null;for(var ba in swfobject)swfobject[ba]=null;swfobject=null})})();return{registerObject:function(G,M,W,ba){if(X.w3&&G&&M){var D={};D.id=G;D.swfVersion=M;D.expressInstall=W;D.callbackFn=ba;J[J.length]=D;t(G,false)}else ba&&ba({success:false,id:G})},getObjectById:function(G){if(X.w3)return l(G)},embedSWF:function(G,M,W,ba,D,K,ea,ha,ja,oa){var ma={success:false,id:M};if(X.w3&&!(X.wk&&
X.wk<312)&&G&&M&&W&&ba&&D){t(M,false);b(function(){W+="";ba+="";var na={};if(ja&&typeof ja===z)for(var la in ja)na[la]=ja[la];na.data=G;na.width=W;na.height=ba;la={};if(ha&&typeof ha===z)for(var pa in ha)la[pa]=ha[pa];if(ea&&typeof ea===z)for(var qa in ea)if(typeof la.flashvars!=r)la.flashvars+="&"+qa+"="+ea[qa];else la.flashvars=qa+"="+ea[qa];if(j(D)){pa=m(na,la,M);na.id==M&&t(M,true);ma.success=true;ma.ref=pa}else if(K&&o()){na.data=K;n(na,la,M,oa);return}else t(M,true);oa&&oa(ma)})}else oa&&oa(ma)},
switchOffAutoHideShow:function(){U=false},ua:X,getFlashPlayerVersion:function(){return{major:X.pv[0],minor:X.pv[1],release:X.pv[2]}},hasFlashPlayerVersion:j,createSWF:function(G,M,W){if(X.w3)return m(G,M,W)},showExpressInstall:function(G,M,W,ba){X.w3&&o()&&n(G,M,W,ba)},removeSWF:function(G){X.w3&&A(G)},createCSS:function(G,M,W,ba){X.w3&&q(G,M,W,ba)},addDomLoadEvent:b,addLoadEvent:c,getQueryParamValue:function(G){var M=L.location.search||L.location.hash;if(M){if(/\?/.test(M))M=M.split("?")[1];if(G==
null)return w(M);M=M.split("&");for(var W=0;W<M.length;W++)if(M[W].substring(0,M[W].indexOf("="))==G)return w(M[W].substring(M[W].indexOf("=")+1))}return""},expressInstallCallback:function(){if(ga){var G=s(u);if(G&&Y){G.parentNode.replaceChild(Y,G);if(R){t(R,true);if(X.ie&&X.win)Y.style.display="block"}Q&&Q(da)}ga=false}}}}();HandlerQueue=function(){function a(e){c.push(e)}function b(){for(var e=c.length-1;e>=0;e--)c[e].apply(this,arguments)}var c=[];return{add:a,handle:b}};ActiveUser=function(a){this.initialize(a)};ActiveUser.UPDATE_FREQUENCY=1200;ActiveUser.SILENCED_TEMPLATE=new Template('You have been silenced for #{until}. Click <a href="/pages/silenced">here</a> to read about silences.');ActiveUser.ADMIN_LOAD_TOOLS_PATH="/admin/load_toolbar";ActiveUser.USER_DATA_LS_KEY="kong_user_data";
ActiveUser.prototype={initialize:function(a){this._dynamic_style_ele=this._holodeck=null;this._attributes=$H();this._game_attributes=$H();this._attribute_observer_handler=new HandlerQueue;this._on_authenticated_handler=new HandlerQueue;this._on_adblock_detected_handler=new HandlerQueue;this._captured_inline_selectors=[];this._domain=a.domain;this._load_toolbar=a.load_toolbar;this._game_page=a.game_page;this._redirect_capture=a.redirect_capture;this._new_session_url=a.new_session_url;this.updateAttributes(a.kong_user_data);
this.split_treatments=this.getAttributes().split_treatments;if(this.isGamePage())window.gameLoadObserver=new GameLoadObserver({timeout:2E3,debug:false});this.isAuthenticated()&&this.createUpdater();this.addRunWhenAuthenticatedObserver(function(b){b.populateUserSpecificLinks();b.loadAdminToolbar();b.lightPowerupRewardsUpsell()});this.lightUpBadgeOfTheDayOverlay();this.lightPowerupRewardsUpsell();setTimeout(this.checkForAdBlockerTask.bind(this),1E4);this._splitTreatmentPermalinks=(this._splitTreatmentPermalinks=
Cookie.get("splitTreatmentPermalinks"))?this._splitTreatmentPermalinks.evalJSON():{}},setHolodeck:function(a){this._holodeck=a},createUpdater:function(){var a=this;new PeriodicalExecuter(function(){a.pullUserData(true)},ActiveUser.UPDATE_FREQUENCY)},pullUserData:function(a){var b=this;a="/accounts/"+this.username()+(a?"/info_update.json":"/info.json");new Ajax.Request(a,{method:"get",onSuccess:function(c){b.updateAttributes(c.responseJSON)}})},addAttributesObserver:function(a){this._attribute_observer_handler.add(a)},
addOnAuthenticatedObserver:function(a){this._on_authenticated_handler.add(a)},addRunWhenAuthenticatedObserver:function(a){this.isAuthenticated()?function(){a(this)}.bind(this).runWhenDomLoaded(true):this.addOnAuthenticatedObserver(a)},updateAttributes:function(a){var b=$.jStorage.get(ActiveUser.USER_DATA_LS_KEY),c=this._attributes.get("username");if(b&&(b.version>a.version||b.generated_at>a.generated_at))a=b;this._attributes.update(a);this._attribute_observer_handler.handle(this);a.username&&a.username!=
c&&this.usernameUpdated();$.jStorage.set(ActiveUser.USER_DATA_LS_KEY,this._attributes.toObject());this.updateNativeAppAttributes()},isNativeAppUser:function(){return!!window.kongNativeApp},sendNativeAppMessage:function(a,b){this.isNativeAppUser()&&kongNativeApp.sendMessage(Object.toJSON({opcode:a,params:b}))},closeNativeAppWindow:function(){this.sendNativeAppMessage("close",{})},updateNativeAppAttributes:function(){this.sendNativeAppMessage("user_info",this._attributes)},updateGameAttributes:function(a){this._game_attributes.update(a)},
gameCookieName:function(){if(this._game_id)return"kong_game_"+this._game_id},getGameAttributesFromCookie:function(){var a=Cookie.get(this.gameCookieName());a&&this.updateGameAttributes(a.evalJSON())},updateGameAttributesCookie:function(){var a=this.getGameAttributes();a&&Cookie.set(this.gameCookieName(),Object.toJSON(a),undefined,this.gameCookiePath())},getAttributes:function(){return this._attributes.toObject()},getGameAttributes:function(){return this._game_attributes.toObject()},username:function(){return this._attributes.get("username")},
siteVisitorUID:function(){return Cookie.get("kong_svid")},advertiserGender:function(a,b){var c=this._attributes.get("gender");if(/^m/i.match(c))return a;else if(/^f/i.match(c))return b},videoEggGender:function(){return this.advertiserGender("m","f")},googleGender:function(){return this.advertiserGender(1,2)},googleAgeBracket:function(){var a=this._attributes.get("age");return a<=17?undefined:a<=24?1001:a<=34?1002:a<=44?1003:a<=54?1004:a<=64?1005:1006},avatarPath:function(){var a=this._attributes.get("avatar_url");
if(!a)return"";if((a=a.match(/http:\/\/[a-z\.:0-9]*(.*)$/))&&a.length==2)return a[1]},id:function(){return this._attributes.get("id")},facebook_uid:function(){return this._attributes.get("facebook_uid")},solvedCaptcha:function(){return this._attributes.get("solved_captcha")},chatUsername:function(){return this._attributes.get("chat_username")||this._attributes.get("username")},chatPassword:function(){return this._attributes.get("chat_password")},gameAuthToken:function(){return this._game_attributes.get("game_auth_token")},
userVars:function(){return this._game_attributes.get("user_vars")},userVarsSig:function(){return this._game_attributes.get("user_vars_sig")},specialChatVars:function(){return this._attributes.get("special_chat_vars")},gameplaysCount:function(){return this._attributes.get("gameplays_count")},ratingsCount:function(){return this._attributes.get("ratings_count")},gameplaysCountFromCookie:function(){try{return parseInt(Cookie.get(Holodeck.KONG_GAMEPLAYS_COOKIE_NAME)||1,10)}catch(a){return 0}},duelingGroup:function(){var a=
this.specialChatVars();if(a)if(a=a.dueling_quest_data)return a.dueling_quest_slug||"";return""},age:function(){return this._attributes.get("age")},points:function(){return this._attributes.get("points")},pointsAway:function(){return this._attributes.get("points_away")},friendsOnlineCount:function(){return this._attributes.get("friends_online_count")},friendsOnlineNames:function(){return this._attributes.get("friends_online_names")},unreadShoutsCount:function(){return this._attributes.get("unread_shouts_count")},
unreadWhispersCount:function(){return this._attributes.get("unread_whispers_count")},pointsForLastLevel:function(){return this._attributes.get("points_for_last_level")},pointsAfterLastLevel:function(){return active_user.points()-active_user.pointsForLastLevel()},level:function(){return this._attributes.get("level")},lastLevelupAt:function(){var a=this._attributes.get("last_levelup_at");return a?new Date(a):undefined},recentLevelup:function(){return this.lastLevelupAt()>new Date((new Date).getTime()-
864E5)},senderNameOrEmail:function(){return this._attributes.get("sender_name_or_email")},boshEnabled:function(){return this._game_attributes.get("bosh_enabled")},compressionEnabled:function(){return this._game_attributes.get("compression_enabled")},usernameUpdated:function(){var a=this;(function(){if(a.isAuthenticated()){a.createUpdater(a);a._on_authenticated_handler.handle(a)}}).runWhenDomLoaded(true)},isAuthenticated:function(){return!!(this.username()&&!/^Guest/.match(this.username()))},isAdmin:function(){return this.isAuthenticated()&&
this._attributes.get("admin")},isPremium:function(){return!Cookie.get("admin_premium_off")&&this.isAuthenticated()&&this._attributes.get("premium")},hasPreroll:function(){return this.split_treatments.split_killing_prerolls2==undefined||this.split_treatments.split_killing_prerolls2=="control"},premiumizeUpsellNode:function(a,b,c){this.isPremium()||a.addClassName("clickable").observe("click",function(e){lightbox.prototype.initializePremiumMembershipPurchase(b,c);Event.stop(e);return false});return a},
isDeveloperOfGame:function(){return document.location.pathname.split("/")[2]==this.username()},isDeveloper:function(){return this.isAuthenticated()&&this._attributes.get("developer")},isChatModerator:function(){return this.isAuthenticated()&&this._attributes.get("moderator")},isSuperChatModerator:function(){return this.isAuthenticated()&&this._attributes.get("super_chat_moderator")},isCurator:function(){return this.isAuthenticated()&&this._attributes.get("curator")},isForumModerator:function(){return this.isAuthenticated()&&
this._attributes.get("forum_moderator")},isGamestopEmployee:function(){return this.isAuthenticated()&&this._attributes.get("gamestop_employee")},getsAdminBar:function(){if(!this._load_toolbar)return false;return this.isChatModerator()||this.isCurator()||this.isForumModerator()||this.isGamestopEmployee()},getsBonus:function(){return this.isGamestopEmployee()||this.split_treatments.no_bonus!="no-bonus"},silencedUntil:function(){var a=this._attributes.get("silenced_until");return a?new Date(a):undefined},
isSilenced:function(){var a=this.silencedUntil();return Boolean(a&&a>new Date)},silencedMessage:function(){return ActiveUser.SILENCED_TEMPLATE.evaluate({until:TimeInWordsHelper.distanceInWords(new Date,this.silencedUntil())})},populateUserSpecificLinks:function(a){var b=this.username();(a?a.select("a"):$$("a.user_specific")).each(function(c){c.href=c.href.replace("Guest",b).replace("KongregateHolodeckTemplateUsername",b)})},addCapturedSelector:function(a,b){this._captured_inline_selectors.push(a);
var c=this,e=function(f){var h=f.onclick;if(h)f.onclick=c.capturedSelectorWrapper.bindAsEventListener(c,h.bind(f),b)};$$(a).each(function(f){f.match("a, input[type=button]")?e(f):f.getElementsBySelector("a, input[type=button]").each(e);f.addClassName("lbOn")})},capturedSelectorWrapper:function(a,b,c){var e="function"==typeof b;if(this.isAuthenticated()){if(e)return b(a)}else{this._redirect_capture?this.redirectToLogin():this.activateInlineLogin({},c);"function"==typeof b&&this.saveCapturedFunction(b.curry(a));
a.preventDefault!=undefined&&Event.stop(a);return false}},activateInlineLogin:function(a,b){a||(a={});a=$H(a);var c="/accounts/new/behind_login";this._holodeck&&this._holodeck.recordAnalyticsEvent("Lightbox","Signin");this._game_id&&a.set("game_id",this._game_id);if(a.size()>0)c=c+"?"+a.toQueryString();b?lightbox.prototype.initializeKongregateLightboxFromAjax(c,{afterStaticContentLoad:function(){lightbox.prototype.toggleRegistration();active_user.focusFormField("username")}}):lightbox.prototype.initializeKongregateLightboxFromAjax(c,
{done_class_name:"lightbox_login",afterStaticContentLoad:function(){active_user.focusFormField("username")}})},focusFormField:function(a){var b=$(a);b&&setTimeout(function(){b.focus()},0)},activateKredPurchase:function(a){this.isAuthenticated()&&lightbox.prototype.initializeKredPurchase(a)},activatePasswordRecovery:function(){if(this.isGamePage())this.activateInlineLogin({recover:true});else document.location="/sessions/new?recover=true"},redirectToLogin:function(){top.location=this._new_session_url},
debugLevel:function(){if(!this._debug_level)this._debug_level=this.documentLocationSearchQuery().debug_level;return this._debug_level},documentLocationSearchQuery:function(){if(!this._document_location_search_query)this._document_location_search_query=document.location.search.parseQuery();return this._document_location_search_query},seenSharedContentWelcome:function(){return!!this._game_attributes.get("seen_shared_content_welcome")},setSeenSharedContentWelcome:function(a){this._game_attributes.set("seen_shared_content_welcome",
a);this.updateGameAttributesCookie()},saveCapturedFunction:function(a){this._capturedFunction=a},runCapturedFunction:function(){"function"==typeof this._capturedFunction&&this._capturedFunction.defer();this._capturedFunction=null},gameId:function(){return this._game_id},setGame:function(a,b){this._game_id=a;this._game_resource_path=b;this.getGameAttributesFromCookie()},gamePath:function(){if(!this._game_path){var a=document.location.pathname.match(/(.*)\/$/);this._game_path=a?a[1]:document.location.pathname}return this._game_path},
gameResourcePath:function(){return this._game_resource_path},gameCookiePath:function(){if(!this._game_cookie_path)this._game_cookie_path=this.gamePath().match(/(.*)\/.*/)[1];return this._game_cookie_path},referrerUrl:function(a){if(!this.isAuthenticated())return a;var b=a.match(/\?/)?"&":"?";return a+b+"referrer="+encodeURIComponent(this.username())},formAuthenticityToken:function(){return this._attributes.get("form_authenticity_token")},gameType:function(){return this._game_attributes.get("game_type")},
hasRequiredPlugins:function(){return this.hasRequiredPluginsFor(this.gameType())},hasRequiredPluginsFor:function(a){if(a=="unity"){var b=false;unityObject.detectUnity(function(c){b=c=="installed"||c=="running"});return b}else return true},accountUrl:function(){return"/accounts/"+this.username()},isGamePage:function(){return!!this._game_page},domain:function(){return this._domain},isMobileUserAgent:function(){return this._attributes.get("mobile_user_agent")},countryCode:function(){return this.valueOfSearchParameter("force_country_code")||
this._attributes.get("country_code")},loadAdminToolbar:function(){this.getsAdminBar()&&new Ajax.Updater("admin_links_placeholder",ActiveUser.ADMIN_LOAD_TOOLS_PATH,{method:"get",evalScripts:true})},recordTreatments:function(a){a&&this._attributes.get("treatments")&&this._attributes.get("treatments").each(function(b){b.analytics_slot&&a._setCustomVar(b.analytics_slot,b.group_permalink,b.treatment_permalink,2)})},valueOfSearchParameter:function(a){return location.search.parseQuery()[a]},powerupRewardsUser:function(){return this._attributes.get("powerup_rewards_user")},
powerupRewardsProUser:function(){return!!this.powerupRewardsBonus()},powerupRewardsBonus:function(){return this._attributes.get("powerup_rewards_bonus")},powerupRewardsBonusFor:function(a){a=parseInt(a,10);var b=this.powerupRewardsBonus();return a>0&&b?(a*b).ceil():a},showPowerupRewardsUpsell:function(){return"US"==this.countryCode()},occasionallyShowRegistrationLightbox:function(){!this.isAuthenticated()&&this.gameplaysCount()-2>=0&&(this.gameplaysCount()-2)%7==0&&this.activateInlineLogin({},true)},
lightPowerupRewardsUpsell:function(){if(this.showPowerupRewardsUpsell()){this.createCSS(".powerup_rewards_upsell","display:block");this.createCSS(".powerup_rewards_botd_upsell","display:inline")}},lightUpBadgeOfTheDayOverlay:function(){var a=this._attributes.get("botd_badge_id");a&&this.createCSS(".badge_of_the_day_overlay span.botd_badge_id_"+a,"display:block")},createCSS:function(a,b){var c;if(!this._dynamic_style_ele){var e=$$("head")[0];c=new Element("style",{type:"text/css",media:"screen"});
e.appendChild(c)}if(!this._dynamic_style_ele)if(Prototype.Browser.IE&&!Prototype.Browser.IE9){if((c=document.styleSheets)&&c.length>0)this._dynamic_style_ele=c[c.length-1]}else this._dynamic_style_ele=c;if(Prototype.Browser.IE&&!Prototype.Browser.IE9)this._dynamic_style_ele&&typeof this._dynamic_style_ele.addRule=="object"&&this._dynamic_style_ele.addRule(a,b);else this._dynamic_style_ele&&typeof document.createTextNode!="undefined"&&this._dynamic_style_ele.appendChild(document.createTextNode(a+" {"+
b+"}"))},needForSpeedNumberCompleted:function(){return this._attributes.get("need_for_speed_number_completed")},invokeConversionIframe:function(){Cookie.erase("_kong_acct_created","/");try{$("conversion_dynamic_iframe_target").update((new Template($("conversion_dynamic_iframe").innerHTML)).evaluate())}catch(a){}},ignoreBounceMessage:function(a,b){$(a).up(".sitemessage").hide();new Ajax.Request(b)},isAdBlockerEnabled:function(){return false},checkForAdBlockerTask:function(){this.isAdBlockerEnabled()&&
this._on_adblock_detected_handler.handle();this._on_adblock_detected_handler=null},runIfAdBlockerDetected:function(a){if(this._on_adblock_detected_handler==null)this.isAdBlockerEnabled()&&a();else this._on_adblock_detected_handler.add(a)},shoutForGame:function(a,b){a="/accounts/"+this.username()+"/permissions_for_game.json?game_id="+a;new Ajax.Request(a,{method:"get",onSuccess:function(c){json=c.responseJSON;allow=json!=null&&json.always_allow_shouts;b(allow)}})},kredBuyerType:function(){return this._attributes.get("kred_buyer_type")},
isFacebookConnected:function(){return!!this._attributes.get("facebook_uid")},facebookAccessTokenNeedsUpdate:function(){return!!this._attributes.get("access_token_needs_update")},facebookStatus:function(){return this._attributes.get("facebook_status")},facebookLoginUrl:function(){return this._attributes.get("facebook_url")},gameTagTreatment:function(){return this.split_treatments.tags_replace_description},hasGoogleADayForToday:function(){if(!this.isAuthenticated())return false;return!!this._attributes.get("gad_earned")},
updateMoreGames:function(){if(!this.isAuthenticated())if(holodeck._permissions.microtransaction_api)holodeck.showSignupTab();else new Ajax.Updater("replace_more_games","/recommended_games",{parameters:{game_id:this.gameId(),show_more_tab:true},method:"get",onSuccess:function(){$("main_tab_set").select("a").each(function(a){$("more_games_tab")==undefined&&a.observe("click",function(){$("more_games_tab_pane").hide();clearTimeout(active_user.changeTabTimeout)})});holodeck.showSignupTab();active_user.changeTabTimeout=
setTimeout(function(){holodeck.showMoreGamesTab()},3E5)},onFailure:function(){holodeck.showSignupTab()}})},getSplitTreatmentPermalink:function(a,b,c){if(this._splitTreatmentPermalinks[a])b(this._splitTreatmentPermalinks[a]);else new Ajax.Request("/site_visitor_split_treatments/"+a,{method:"get",onSuccess:function(e){b(e.responseText);active_user._splitTreatmentPermalinks[a]=e.responseText;Cookie.set("splitTreatmentPermalinks",Object.toJSON(active_user._splitTreatmentPermalinks))},onFailure:c})},showFacebookRegistrationTab:function(){return this._attributes.get("show_facebook_registration")||
false}};Function.prototype.bufferingFunction=function(a,b){var c=Function.preconditionBufferingGroup(a,b),e=this,f=function(){c.push(e,arguments,this,f,b);a(this)&&c.unwind()};return f};
Function.preconditionBufferingGroup=function(a,b){if(!this._buffering_function_groups)this._buffering_function_groups=[];if(undefined===a._buffering_group_id)a._buffering_group_id=this._buffering_function_groups.length;a=a._buffering_group_id;this._buffering_function_groups[a]||(this._buffering_function_groups[a]=function(){var c=[];return{push:function(e,f,h,l,o){c.push({fn:e,outerFunction:l,args:f,bind_to:h,timestamp:new Date,tag:o})},unwind:function(){if(c.length){var e;e=function(f,h){var l=function(o,
n){if(o.localeCompare&&n.localeCompare)return o.localeCompare(n);if(o>n)return-1;if(o<n)return 1;return 0};return l(f.tag,h.tag)||l(f.timestamp,h.timestamp)};if(b instanceof Function)c.sort(b);else b&&c.sort(e);for(;e=c.shift();)e.fn.apply(e.bind_to,e.args)}}}}());return this._buffering_function_groups[a]};Function.unbufferBufferingGroup=function(a){a._buffering_group_id&&Function.preconditionBufferingGroup(a).unwind()};var hookup_hintables=function(){$$(".hintable").each(function(a){var b=a.title,c=a.form,e=c.restoreHints,f=function(){if(b==a.value||""==a.value){a.value="";a.removeClassName("hinted_value")}},h=function(){if(""==a.value){a.value=b;a.addClassName("hinted_value")}},l=a.form.onsubmit;h();a.observe("click",f);a.observe("focus",f);a.observe("blur",h);a.restoreHint=h;c.onsubmit=function(){var o=true;f();if(l)try{o=l.apply(this,arguments)}catch(n){}h();return o};c.restoreHints=function(){h();e&&e.apply(this,
arguments)}})};document.observe("dom:loaded",function(){hookup_hintables()});Ajax.CachedAutocompleter=Class.create();
Object.extend(Object.extend(Ajax.CachedAutocompleter.prototype,Autocompleter.Base.prototype),{initialize:function(a,b,c,e){this.baseInitialize(a,b,e);this.options.asynchronous=true;this.options.onComplete=this.onComplete.bind(this);this.options.defaultParams=this.options.parameters||null;this.url=c;this.cache={};if(this.options.forceActivation){Event.stopObserving(this.element,"keydown");Event.observe(this.element,"keydown",this.onKeyPressWithForcedActivation.bindAsEventListener(this));Event.observe(this.element,
"focus",this.onFocus.bindAsEventListener(this))}},getUpdatedChoices:function(){var a=this.getToken().toLowerCase();if(this.cache[a])this.updateChoices(this.cache[a]);else{this.startIndicator();entry=encodeURIComponent(this.options.paramName)+"="+encodeURIComponent(a);this.options.parameters=this.options.callback?this.options.callback(this.element,entry):entry;if(this.options.defaultParams)this.options.parameters+="&"+this.options.defaultParams;new Ajax.Request(this.url,this.options)}},onComplete:function(a){this.updateChoices(this.cache[a.request.parameters.search]=
a.responseText)},markPrevious:function(){if(this.index>0)this.index--;else{this.index=this.entryCount-1;this.update.scrollTop=this.update.scrollHeight}selection=this.getEntry(this.index);selection_top=selection.offsetTop;if(selection_top<this.update.scrollTop)this.update.scrollTop-=selection.offsetHeight},markNext:function(){if(this.index<this.entryCount-1)this.index++;else{this.index=0;this.update.scrollTop=0}selection=this.getEntry(this.index);selection_bottom=selection.offsetTop+selection.offsetHeight;
if(selection_bottom>this.update.scrollTop+this.update.offsetHeight)this.update.scrollTop+=selection.offsetHeight},selectEntry:function(){if(this.index>=0){this.active=false;this.updateElement(this.getCurrentEntry())}else{try{this.element.form.onsubmit()}catch(a){}this.element.form.submit()}},onFocus:function(){this.hasFocus=true;if(this.oldElementValue==this.element.value&&this.element.value.length>=this.options.minChars)this.entryCount>0?this.render():this.show()},onKeyPressWithForcedActivation:function(a){var b=
a.keyCode==Event.KEY_TAB||a.keyCode==Event.KEY_RETURN||Prototype.Browser.WebKit>0&&a.keyCode==0,c=this.element.value.length>=this.options.minChars;if(!this.active&&b&&c){Event.stop(a);this.observer&&clearTimeout(this.observer);this.changed=false;this.hasFocus=true;this.getUpdatedChoices()}else this.onKeyPress(a)},updateChoices:function(a){if(!this.changed&&this.hasFocus){this.update.innerHTML=a;Element.cleanWhitespace(this.update);Element.cleanWhitespace(this.update.down());if(this.update.firstChild&&
this.update.down().childNodes){this.entryCount=this.update.down().childNodes.length;for(a=0;a<this.entryCount;a++){var b=this.getEntry(a);b.autocompleteIndex=a;this.addObservers(b)}}else this.entryCount=0;this.stopIndicator();this.update.scrollTop=0;this.index=this.options.noAutoDefault?-1:0;if(this.entryCount==1&&this.options.autoSelect){this.selectEntry();this.hide()}else this.render()}}});Number.prototype.withDelimiters=function(a,b){a||(a=",");b||(b=1E3);for(var c=[],e=Math.floor(this);e;){c.unshift(e%b);e=Math.floor(e/b)}return[c.shift()].concat(c.map(function(f){return f.toPaddedString((b-1+"").length)})).join(a)};Ajax.Poller=function(a,b,c,e){this.initialize(a,b,c,e)};
Ajax.Poller.prototype={initialize:function(a,b,c,e){this._stopped=true;c=c||5E3;e=e||3E4;var f=this,h=Object.extend(Object.extend({method:"get"},b),{on202:function(){if(!f._stopped){setTimeout(f._poll,c);b.on202&&b.on202.apply(b,arguments)}},onFailure:function(){if(!f._stopped){setTimeout(f._poll,e);b.onFailure&&b.onFailure.apply(b,arguments)}}});this._poll=function(){new Ajax.Request(a,h)}},start:function(a){this._stopped=false;setTimeout(this._poll.bind(this),a||0)},stop:function(){this._stopped=
true}};Form.serializeElements=function(a,b){if(typeof b!="object")b={hash:!!b};else if(Object.isUndefined(b.hash))b.hash=true;var c,e,f=false,h=b.submit,l;if(b.hash){b={};l=function(o,n,p){if(n in o){Object.isArray(o[n])||(o[n]=[o[n]]);o[n].push(p)}else o[n]=p;return o}}else{b="";l=function(o,n,p){return o+(o?"&":"")+encodeURIComponent(n)+"="+encodeURIComponent(p)}}return a.inject(b,function(o,n){if(!n.disabled&&n.name){c=n.name;e=$(n).getValue();if(e!=null&&n.type!="file"&&(n.type!="submit"||!f&&h!==false&&
(!h||c==h)&&(f=true)))o=l(o,c,e)}return o})};(function(a,b){var c=0;b.prototype.toGlobalReference=function(){var e=this,f;f="_tgrFn"+c++;a[f]=function(){try{delete a[f]}catch(h){a[f]=undefined}e()};return f}})(this,Function);Prototype.Browser.IE6=navigator.userAgent.indexOf("MSIE 6.")>-1;Prototype.Browser.IE7=navigator.userAgent.indexOf("MSIE 7.")>-1;Prototype.Browser.IE8=navigator.userAgent.indexOf("MSIE 8.")>-1;Prototype.Browser.IE9=navigator.userAgent.indexOf("MSIE 9.")>-1;if(Prototype.Browser.IE8)Element._attributeTranslations.write.names["class"]=undefined;
if(Prototype.Browser.WebKit){var indexOfVersion=navigator.userAgent.indexOf("Version");if(indexOfVersion>-1){var versionString=navigator.userAgent.substr(indexOfVersion,13),version=versionString.split("/")[1];if(version){version=parseInt(version.gsub(".",""));if(version>=503)Prototype.Browser.Safari503=true}}};Element.collectTextNodesIgnoreClass=function(a,b){return $A($(a).childNodes).collect(function(c){return c.nodeType==3?c.nodeValue:c.hasChildNodes()&&!Element.hasClassName(c,b)?Element.collectTextNodesIgnoreClass(c,b):""}).flatten().join("").strip()};Element.Methods.collectTextNodesIgnoreClass=Element.collectTextNodesIgnoreClass;Element.addMethods(Element.Methods);Element.Methods.selectedOptionValue=function(a){a=$(a);if("SELECT"===a.tagName)return(a=a.select("option")[a.selectedIndex])&&a.readAttribute("value")};Element.Methods.selectOptionValue=function(a,b){a=$(a);if("SELECT"==a.tagName)a.selectedIndex=a.select("option").pluck("value").indexOf(b)};Element.addMethods(Element.Methods);FocusHandler=Class.create({initialize:function(a,b,c){this._row=a;this._text=b;this._callback=c;this._elementsToInspect=a.getInputElements();this._elementToAffect=a.getHelpElement()},setText:function(a){this._text=a},_inputIsValid:undefined,onFocus:function(){FocusHandler._last_row=this._row},onBlur:function(){if(this._inputIsValid()){this._elementsToInspect.each(function(a){Element.removeClassName(a,"error_field")});Element.removeClassName(this._elementToAffect,"error_msg");this._elementToAffect.innerHTML=
"";return false}else{this._elementsToInspect.each(function(a){Element.addClassName(a,"error_field")});Element.addClassName(this._elementToAffect,"error_msg");this._elementToAffect.innerHTML=this._text;this._callback();return true}},_rowChanged:function(){return this._row!=FocusHandler._last_row}});
HelpFocusHandler=Class.create(FocusHandler,{initialize:function($super,b,c){$super(b,c,function(){})},onBlur:function(){var a=this._elementToAffect.childNodes[0];a&&a.remove();return false},_createHelpDiv:function(){this._removeHelpDiv();var a=new Element("div");a.id="help_wrapper";var b=new Element("div");b.id="help_text";a.appendChild(b);this._elementToAffect.appendChild(a);return b},_removeHelpDiv:function(){var a=this._elementToAffect.childNodes[0];a&&a.remove()},_errorsArePresent:function(){return this._elementToAffect.hasClassName("error_msg")}});
HelpTextFocusHandler=Class.create(HelpFocusHandler,{initialize:function($super,b,c){$super(b,c)},onFocus:function($super){$super();if(this._errorsArePresent())return false;if(this._text)this._createHelpDiv().innerHTML=this._text;return true}});HelpImageFocusHandler=Class.create(HelpFocusHandler,{initialize:function($super,b,c){$super(b,null);this._imageElement=c},onFocus:function($super){$super();if(this._errorsArePresent())return false;this._setImage(this._imageElement);return true},_setImage:function(a){this._createHelpDiv().appendChild(a)}});
HelpCreditCardFocusHandler=Class.create(HelpImageFocusHandler,{initialize:function($super,b,c){$super(b,c);this._setImage(this._imageElement)},onBlur:function(){}});NonEmptyInputFocusHandler=Class.create(FocusHandler,{initialize:function($super,b,c,e){$super(b,c,e)},_inputIsValid:function(){return this._row.getInputValue()!=""}});
CreditCardValidationFocusHandler=Class.create(FocusHandler,{initialize:function($super,b,c,e){$super(b,c,e)},_inputIsValid:function(){for(var a=[/^4\d{12}(\d{3})?$/,/^(5[1-5]\d{4}|677189)\d{10}$/,/^(6011|65\d{2})\d{12}$/,/^3[47]\d{13}$/],b=["visa","master_card","discover","american_express"],c=0,e=a.length;c<e;c++)if(this._row.getInputValue().match(a[c])){this._creditCardType=b[c];return true}return false},getCreditCardType:function(){return this._creditCardType}});
DateValidationFocusHandler=Class.create(FocusHandler,{initialize:function($super,b,c,e){$super(b,c,e)},_deferValidation:function(){return!this._rowChanged()&&this._isIncomplete()},_isIncomplete:function(){return!this._month()||!this._year()},_month:function(){return this._row.getInputElements()[0].value},_year:function(){return this._row.getInputElements()[1].value}});
CompleteDateValidationFocusHandler=Class.create(DateValidationFocusHandler,{initialize:function($super,b,c,e){$super(b,c,e)},_inputIsValid:function(){if(this._deferValidation())return true;return this._row.getInputValue().length>=6}});
FutureDateValidationFocusHandler=Class.create(DateValidationFocusHandler,{initialize:function($super,b,c,e){$super(b,c,e)},_getCurrentDate:function(){return new Date},_inputIsValid:function(){if(this._deferValidation())return true;var a=this._row.getInputValue().split("/"),b=this._getCurrentDate();return!(a[1]==b.getFullYear()&&a[0]<b.getMonth()+1)}});
CvvValidationFocusHandler=Class.create(FocusHandler,{initialize:function($super,b,c){this._requiredCvvLength=0;$super(b,"credit card number must be valid",c)},setCreditCardType:function(a){this._requiredCvvLength=this._getRequiredCvvLengthFor(a);this.setText("code must be "+this._requiredCvvLength+" digits")},_getRequiredCvvLengthFor:function(a){if(a=="american_express")return 4;else if(a=="test")return 1;return 3},_inputIsValid:function(){return this._row.getInputValue().length==this._requiredCvvLength}});
ValidInputCallbackFocusHandler=Class.create(FocusHandler,{initialize:function($super,b,c){$super(b,"",c)},onBlur:function(){this._callback();return false}});CreditCardForm=Class.create({initialize:function(a,b,c,e,f){this._tableElement=a;this._rows=[];this._togglePayNow=f;this._ccImages={};$H({visa:"/images/ccmark_visa.gif",master_card:"/images/ccmark_mastercard.png",american_express:"/images/ccmark_amex.png",discover:"/images/ccmark_discover.gif"}).each(function(h){this._ccImages[h.key]=new Element("img");this._ccImages[h.key].src=h.value}.bind(this));this._ccNumberRow=new FormCreditCardNumberRow("Credit card number","number","credit_card",e.number,
this._checkAllRowsForValidity.bind(this),this._propagateCreditCardType.bind(this));this._rows.push(this._ccNumberRow);this._rows.push(new FormExpirationDateRow("Expiration Date","","credit_card",b,c,e.month,e.year,this._checkAllRowsForValidity.bind(this)));this._cvvRow=new FormCvvRow("Card security code","cvv","credit_card",e.cvv,this._checkAllRowsForValidity.bind(this));this._rows.push(this._cvvRow);this._rows.push(new FormNonEmptyRow("First name","first_name","billing","Please enter your first name exactly as it appears on your credit card",
e.first_name,this._checkAllRowsForValidity.bind(this),false));this._rows.push(new FormNonEmptyRow("Last name","last_name","billing","Please enter your last name exactly as it appears on your credit card",e.last_name,this._checkAllRowsForValidity.bind(this),false));this._rows.push(new FormNonEmptyRow("Billing address","street_address","billing","Enter the street address where your statements are mailed to. (eg, 12 Maple Drive)",e.street_address,this._checkAllRowsForValidity.bind(this),false));this._rows.push(new FormCanBeEmptyRow("Billing address (cont)",
"extended_address","billing","Apartment number, suite number or department",e.extended_address,this._checkAllRowsForValidity.bind(this),false));this._rows.push(new FormNonEmptyRow("City","locality","billing","",e.locality,this._checkAllRowsForValidity.bind(this),false));this._rows.push(new FormNonEmptyRow("State/Province/Region","region","billing","",e.region,this._checkAllRowsForValidity.bind(this),false));this._rows.push(new FormNonEmptyRow("Postal Code","postal_code","billing","",e.postal_code,
this._checkAllRowsForValidity.bind(this),true));this._attachRowsToTableElement()},rowCount:function(){return this._rows.length},reportAllErrors:function(){this._rows.each(function(a){a._callAllOnBlurHandlers()})},_checkAllRowsForValidity:function(){},_enablePayNow:function(){var a=$$(".checkout_button")[0];a.disabled=false;a.removeClassName("disabled")},_disablePayNow:function(){var a=$$(".checkout_button")[0];if(this._togglePayNow){a.disabled=true;a.addClassName("disabled")}},_attachRowsToTableElement:function(){this._rows.each(function(a){Element.insert(this._tableElement,
{before:a.getElement()})}.bind(this))},_propagateCreditCardType:function(){var a=this._ccNumberRow.getCreditCardType();this._ccNumberRow._helpCreditCardFocusHandler._setImage(this._ccImages[a]);this._cvvRow.setCreditCardType(a)}});function NewWelcomeBox(a,b){this.initialize(a,b)}
NewWelcomeBox.prototype={initialize:function(a,b){var c=this;this._user=a;this._navigation=b;this.updateValues();this.addObservers();a.addRunWhenAuthenticatedObserver(this.addObservers.bind(this));a.addAttributesObserver(function(){c.updateValues()});if(Prototype.Browser.IE6)this.orig_welcome_height=$("welcome").getHeight()},addObservers:function(){var a=this._navigation,b=$("profile_hover_area");$("profile_open_control").observe("mouseover",function(c){a.onMouseOverNavTab(c.target)});b.observe("mouseover",
function(){a.onMouseOverNavTab(b)});$("profile-box-tab-pane").observe("mouseover",function(){a.clearResetTimer()})},open:function(){var a=$("profile-box-tab-pane")?$("profile-box-tab-pane"):$("guest_user_welcome_content");$("welcome").addClassName("exposed");Prototype.Browser.IE6&&$("welcome").setStyle({height:this.orig_welcome_height+$("profile-box-tab-pane").getHeight()+"px"});a.show();Shim.shimElement(a)},close:function(){var a=$("profile-box-tab-pane")?$("profile-box-tab-pane"):$("guest_user_welcome_content");
$("welcome").removeClassName("exposed");a.hide();Shim.hide();Prototype.Browser.IE6&&$("welcome").setStyle({height:this.orig_welcome_height+"px"})},updateValues:function(){if(this._user.isAuthenticated()){var a=this._user.getAttributes(),b=$("welcome");b.select(".kreds_balance_or_kreds_link").each(function(h){h.update(this.kredsBalanceOrKredsLinkString(a.kreds_balance));h.href=this.kredAccountUrlOrKredsLinkUrl(a.kreds_balance)}.bind(this));this.updateFriendInfo(b);var c=(new Element("img")).writeAttribute({id:"welcome_box_small_user_avatar",
src:a.avatar_url,title:a.username,name:"user_avatar",alt:"Avatar for "+a.username,height:28,width:28});b.down("span#small_avatar_placeholder").update(c);var e,f;if(active_user.pointsAway()==0){e=active_user.points();f=e+" points"}else{e=active_user.pointsAway();f=e+" "+(e==1?$("points_to_level_template").innerHTML:$("plural_points_to_level_template").innerHTML)}b.select(".points_to_level_up").each(function(h){h.update(e)});b.select(".points_to_level_up_text").each(function(h){h.update(f)});b.select(".total_points_amount").each(function(h){h.update(active_user.points())});
b.select(".facebook_nav_item").each(function(h){active_user.isFacebookConnected()&&h.hide()});$("welcome_box_levelbug_img_placeholder").writeAttribute({id:"welcome_levelbug","class":"spritesite levelbug level_"+a.level,title:"Level "+a.level,name:"welcome_levelbug",alt:"Levelbug"+a.level});if(a.level==65){$("profile-section-points-needed").hide();$("max-level").show()}else{c=(new Element("span")).writeAttribute({id:"welcome_next_levelbug","class":"spritesite levelbug level_"+(a.level+1),title:"Level "+
(a.level+1),name:"next_welcome_levelbug",alt:"Levelbug"+(a.level+1)});b.down("span#welcome_box_next_levelbug_img_placeholder").update(c)}active_user.isDeveloper()&&$("profile_developer_section_placeholder").replace((new Template($("developer_section_template").innerHTML)).evaluate({username:active_user.username()}));new ProgressBar($("progress-bar"),{value:active_user.pointsAfterLastLevel(),maxValue:active_user.pointsAway()+active_user.pointsAfterLastLevel()});active_user.populateUserSpecificLinks(b);
b.select(".username_holder").each(function(h){h.update(active_user.username())});this.updateMessagesLink(active_user.unreadShoutsCount(),active_user.unreadWhispersCount());c=active_user.unreadShoutsCount()+active_user.unreadWhispersCount();b.down(".my_messages").update(this.messagesCountString(c));if(c>0){$("profile_bar_messages").addClassName("alert_messages");$("profile_control_unread_message_count").update(c);$("profile_control_unread_message_count").addClassName("has_messages");$("my-messages-link").setAttribute("title",
active_user.unreadShoutsCount()+" shouts, "+active_user.unreadWhispersCount()+" whispers");active_user.unreadShoutsCount()==0&&$("my-messages-link").setAttribute("href","/accounts/"+active_user.username()+"/private_messages")}$("guest_user_welcome_content").hide();$("nav_welcome_box").show()}},updateFriendInfo:function(a){a.select(".friends_online_count").each(function(b){b.update(active_user.friendsOnlineCount())});a.down("#friends-online-header").update(this.friendsOnlineString(active_user.friendsOnlineCount()));
if(active_user.friendsOnlineCount()>0){a.select(".friends_online_link").each(function(b){b.title=active_user.friendsOnlineNames()});a.down("#friends-online-list").update(this.getFriendLinks(active_user.friendsOnlineNames())).show()}else{a.select(".friends_online_link").each(function(b){b.title="No friends online."});a.down("#friends-online-list").hide()}$("profile_nav_following_link").update("Friends");$("profile_nav_follower_link").update("Fans")},getFriendLinks:function(a){a=a.split(", ");var b=
"",c=0;for(c=0;c<a.length;c++)b+=a[c].match(/and.*!/)?"<a href='/accounts/"+active_user.getAttributes().username+"/friends'>"+a[c]+"</a>":"<a href='/accounts/"+a[c]+"'>"+a[c]+"</a>"+(c==a.length-1?"":", ");return b},friendsOnlineString:function(a){friend_count_string=tr8nProxy.translate("No friends online");if(a>=1)friend_count_string=tr8nProxy.translate("{count|| friend} online",null,{count:a});return"<span>"+friend_count_string+"</span>"},messagesCountString:function(a){strongTemplate=$("message_count_template").innerHTML;
emptyTemplate=$("empty_message_count_template").innerHTML;return a>0?(new Template(strongTemplate)).evaluate(a):(new Template(emptyTemplate)).evaluate(a)},updateMessagesLink:function(a,b){var c=$("unread_messages_welcome_box_links"),e=$("unread_shouts_welcome_box_link"),f=$("unread_whispers_welcome_box_link"),h=$("shouts_whispers_comma"),l=a>0,o=b>0,n=l&&o,p=null;if(c){if(l){e.href="/accounts/"+encodeURIComponent(this._user.username())+"/messages";p=a>1?" shouts":" shout";e.update(a+p);e.show()}if(o){f.href=
"/accounts/"+encodeURIComponent(this._user.username())+"/private_messages";p=b>1?" whispers":" whisper";f.update(b+p);f.show()}n&&h.show();if(l||o)c.show()}},kredsBalanceOrKredsLinkString:function(a){return 0==a?"Get Kreds!":1==a?"1 Kred":a.withDelimiters()+" Kreds"},kredAccountUrlOrKredsLinkUrl:function(a){return 0==a?"/kreds":"/accounts/"+encodeURIComponent(this._user.username())+"/kred_account"}};Prototype.extendFrame=function(a){a=$(a);for(var b in Element.Methods)if(Object.isFunction(Element.Methods[b]))a.contentWindow.Element.prototype[b]=Element.Methods[b].methodize();return a};function Navigation(a,b){this.initialize(a,b)}Navigation.COMMUNITY_MESSAGE_TEMPLATE=new Template("Get activity updates from #{friends} and your other friends on Kongregate.");
Navigation.prototype={initialize:function(a,b){this._user=a;this._rollover_delay=0.2;this._waiting=false;this._employee_link=$("nav_employee");this._moderator_link=$("nav_moderator");this._botd={};this._botd.image=$("nav-botd-image");this._botd.border=$("nav-botd-border");this._botd.overlay=$("nav-botd-overlay");this._botd.link=$("nav-botd-link");this._botd.badge_links=$$("#nav-botd .badge_link");this._botd.description=$("nav-botd-description");this._botd.game_name=$("nav-botd-game-name");this._challenge=
{};this._challenge.name_link=$("challenge-name-link");this._challenge.tiny_image=$("challenge-tiny-image");this._challenge.description=$("challenge-description");this._challenge.links=$$(".challenge_link");this._challenge.wrapper=$("current-challenge");this._challenge.header=$("challenge-header");this._community={};this._community.message=$("community-message-holder");if(b)(b=$("new_"+b+"_nav_tab"))&&b.addClassName("active");var c=this,e=$("new_nav_wrapper"),f=$("search_bar");$(document.body).observe("mouseover",
function(h){h=$(h.target);var l=$("profile_bar");if(h&&h.descendantOf&&(l&&h.descendantOf(l)||!h.descendantOf(e)||h.descendantOf(f)))c.onMouseLeave()});$$(".nav_tab_li").each(function(h){h.subnav=h.down("dl");h.subnav&&h.observe("mouseover",function(l){var o=$(l.target);if("LI"!=l.target.tagName)o=l.target.up("li");c.onMouseOverNavTab(o)})});$$(".nav-tab-pane").each(function(h){h.observe("mouseover",function(){c.clearResetTimer()})});this.updateValues();(function(){this.activateSignIn();a.addRunWhenAuthenticatedObserver(function(){c.welcome_box=
new NewWelcomeBox(a,c);c.updateValues();c.displayRecentlyPlayedGames()})}).bind(this).runWhenDomLoaded(true);a.addOnAuthenticatedObserver(function(){$("welcome").removeClassName("expanded")});a.addAttributesObserver(function(){c.updateValues()})},displayRecentlyPlayedGames:function(){new Ajax.Request("/accounts/"+active_user.username()+"/nav_recently_played",{method:"get",onSuccess:function(a){a=$A(a.responseJSON);var b,c;if(a.size()>0){c=(new Template($("recently_played_title_template").innerHTML)).evaluate({username:active_user.username()});
b=new Template('<dd class="media mini_game"><a href="#{url}" class="img mrs"><img src="#{icon_url}" /></a><span class="mini_game_info bd"><span class="truncate_one_line"><a href="#{url}">#{title}</a></span><span class="truncate_one_line">by <a href="#{url}">#{uploaded_by_username}</a></span></span></dd>');a.each(function(e){c+=b.evaluate(e)});$("nav-game-categories").insert({before:c})}}})},activateSignIn:function(){if(!active_user.isAuthenticated()){$("guest_user_welcome_content").show();var a=$("welcome_username"),
b=$("welcome_password"),c=$("welcome"),e=new PeriodicalExecuter(function(f){var h,l;if(a.getValue().empty())$("welcome_username_label").show();else{$("welcome_username_label").hide();h=true}if(b.getValue().empty())$("welcome_password_label").show();else{$("welcome_password_label").hide();l=true}h&&l&&f.stop()},0.5);a.observe("focus",function(){c.hasClassName("expanded")||c.addClassName("expanded");$("remember_holder").show();$("forgot_holder").show();$("welcome_username_label").hide();e.stop()});
a.observe("blur",function(){a.getValue().empty()&&$("welcome_username_label").show()});b.observe("focus",function(){c.hasClassName("expanded")||c.addClassName("expanded");$("remember_holder").show();$("forgot_holder").show();$("welcome_password_label").hide();e.stop()});b.observe("blur",function(){b.getValue().empty()&&$("welcome_password_label").show()});$("nav_sign_in").down("#game_id").setValue(active_user.gameId());(function(){e.stop()}).delay(45)}},buryElement:function(a,b){a.hasClassName("non-hideable-ad")||
(Prototype.Browser.IE6||Prototype.Browser.IE7?a.hide():b.descendants().each(function(c){if("shim"!=c.id&&c.tagName=="IFRAME")if(c.src.match(/^http:/))a.hide();else{c.relativize();c.setStyle({"z-index":-1});this.buryElement(a,Prototype.extendFrame(c).contentWindow.document.body)}}.bind(this)))},activateNav:function(a){this.iCanHazReset=true;this.resetCurrentNav();$$(".ad-container").each(function(b){this.buryElement(b,b)}.bind(this));if(a.hasClassName("profile_control"))this.welcome_box&&this.welcome_box.open(a);
else{a.addClassName("hover");a.subnav.show();Shim.shimElement(a.subnav)}this.iCanHazReset=true},clearResetTimer:function(){this._reset_timer&&clearTimeout(this._reset_timer);this._reset_timer=null},resetCurrentNav:function(){if(this.iCanHazReset){this.iCanHazReset=false;this.welcome_box&&this.welcome_box.close();game_title_auto_completer&&game_title_auto_completer.hide();$("game_title").blur();Shim.hide();$$(".nav_tab_li").each(function(a){a.removeClassName("hover")});$$(".nav-tab-pane").invoke("hide");
$$(".ad-container").invoke("show")}},onMouseLeave:function(){this.clearResetTimer();this._waiting=false;this._reset_timer=this.resetCurrentNav.bind(this).delay(this._rollover_delay)},onMouseOverNavTab:function(a){this.clearResetTimer();if(this._waiting)this._reset_timer=this.activateNav.bind(this).delay(this._rollover_delay,a);else{this._waiting=true;this._reset_timer=this.activateNav.bind(this).delay(0,a)}},updateValues:function(){var a=this._user.getAttributes(),b="Badge"+a.botd_badge_id;$$(".featured_link").invoke("hide");
[["admin",active_user.isAdmin()],["user",active_user.isAuthenticated()],["gamestop_employee",active_user.isGamestopEmployee()],["mod",active_user.isChatModerator()],["guest",!active_user.isAuthenticated()]].each(function(c){var e=c[1];$$("."+c[0]+"_visible").each(function(f){if(e){f.show();$("featured_section_"+f.getAttribute("name")).show()}})});if(this._user.isAuthenticated()){this._employee_link[this._user.isGamestopEmployee()?"show":"hide"]();this._moderator_link[this._user.isChatModerator()?
"show":"hide"]();$("headerwrap").addClassName("logged_in")}else{this._employee_link.hide();this._moderator_link.hide()}if(a.current_challenge_name){this._challenge.name_link.update(a.current_challenge_name);this._challenge.tiny_image.writeAttribute({src:a.current_challenge_tiny_image});this._challenge.description.update(a.current_challenge_description);this._challenge.links.each(function(c){c.writeAttribute({href:a.current_challenge_uri})})}else{this._challenge.wrapper.hide();this._challenge.header.hide();
$("new_achievements_nav_tab").addClassName("no-challenges")}if(a.botd_icon_uri){this._botd.image.writeAttribute({src:a.botd_icon_uri,alt:b,title:b});this._botd.border.writeAttribute({alt:b,title:b});this._botd.overlay.writeAttribute({alt:b,title:b});this._botd.overlay.addClassName("botd_badge_id_"+a.botd_badge_id);this._botd.link.update(a.botd_name);this._botd.badge_links.each(function(c){c.writeAttribute({href:a.botd_game_uri})});this._botd.description&&this._botd.description.update(a.botd_description);
this._botd.game_name.update(a.botd_game_name)}if(this._user.isAuthenticated()&&a.community_friends&&a.community_friends.length>0){b=a.community_friends.collect(function(c){return"<a href='/accounts/"+c+"'>"+c+"</a>"}).join(", ");this._community.message.update(Navigation.COMMUNITY_MESSAGE_TEMPLATE.evaluate({friends:b}))}}};function Home(a){this.initialize(a)}
Home.prototype={initialize:function(a){if(a.isAuthenticated()){if(a.recentLevelup())this.showLevelupBox();else if(a.level()>=6){$("recommended_badges_holder").show();$("recommended_badges_pod_spinner").show();this.getRecommendedBadges()}else $("tip_pod").show();a.ratingsCount()>=5&&this.getRecommendedGames()}else{$("captcha_holder").show();$("signup_pod_form").down("h3").hide();$("signup_pod_form").down(".intro").hide();var b=Cookie.get("guest_accomplishments");b=b?b.split(","):[];$("guest_accomplishments").update(b.length);
$("guest_points").update(Cookie.get("guest_points")||"0");if(Cookie.get("guest_points")||b.length>0){$("guest_accomplishment_upsell").show();$("guest_signup_intro").hide()}$("registration_showcase_1").hide();$("registration_showcase_2").hide();a.getSplitTreatmentPermalink("swap_staff_picks",function(c){if(c=="swap"){$("registration_showcase_1").update($("staff_picks_pod"));$("registration_showcase_2").update($("signup_pod"))}else{$("registration_showcase_1").update($("signup_pod"));$("registration_showcase_2").update($("staff_picks_pod"))}$("registration_showcase_1").show();
$("registration_showcase_2").show()},function(){$("registration_showcase_1").update($("signup_pod"));$("registration_showcase_2").update($("staff_picks_pod"));$("registration_showcase_1").show();$("registration_showcase_2").show()});$("signup_pod").show();$("staff_picks_pod").show();a.solvedCaptcha()&&$("user_captcha_validation")&&$("user_captcha_validation").hide()}this._recommended_badges_page=0},showLevelupBox:function(){$$(".user_level").each(function(a){a.update(active_user.level());a.addClassName("level_"+
active_user.level())});$("levelup_user_points").update(tr("That's right, you're only [strong: {points_away} points away] from your next level.","",{points_away:active_user.pointsAway()}));$("levelup_user_username").update(tr("Way to go, {username}!","",{username:active_user.username()}));$("levelup_pod").show();this.getLevelupRecommendedBadges()},getLevelupRecommendedBadges:function(){new Ajax.Request("/recommended_badges?limit=2&levelup_module=true",{method:"get",onSuccess:function(a){$("levelup_recommended_badges").update(a.responseText);
$("levelup_recommended_badges").show();$("recommended_badges_pod_spinner")!=undefined&&$("recommended_badges_pod_spinner").hide()}})},setRecommendedBadgesPage:function(a){this._recommended_badges_page=a},getRecommendedBadges:function(){new Ajax.Updater({success:"recommended_badges_holder"},"/recommended_badges",{method:"get",evalScripts:true,onSuccess:function(){$("recommended_badges_holder").up("div").appendChild($("recommended_badges_pod_spinner"));$("recommended_badges_pod_spinner").hide()}})},
getRecommendedGames:function(a){var b="/recommended_games?home_page=true";if(a)b+="&game_to_exclude="+a;new Ajax.Updater({success:"recommended_games_pod_holder"},b,{method:"get",onSuccess:function(){$("recommended_games_pod_spinner").hide()},evalScripts:true})}};if(typeof Control=="undefined")Control={};var $proc=function(a){return typeof a=="function"?a:function(){return a}},$value=function(a){return typeof a=="function"?a():a};
Object.Event={extend:function(a){a._objectEventSetup=function(b){this._observers=this._observers||{};this._observers[b]=this._observers[b]||[]};a.observe=function(b,c){if(typeof b=="string"&&typeof c!="undefined"){this._objectEventSetup(b);this._observers[b].include(c)||this._observers[b].push(c)}else for(var e in b)this.observe(e,b[e])};a.stopObserving=function(b,c){this._objectEventSetup(b);if(b&&c)this._observers[b]=this._observers[b].without(c);else if(b)this._observers[b]=[];else this._observers=
{}};a.observeOnce=function(b,c){var e=function(){c.apply(this,arguments);this.stopObserving(b,e)}.bind(this);this._objectEventSetup(b);this._observers[b].push(e)};a.notify=function(b){this._objectEventSetup(b);var c=[],e=$A(arguments).slice(1);try{for(var f=0;f<this._observers[b].length;++f)c.push(this._observers[b][f].apply(this._observers[b][f],e)||null)}catch(h){if(h==$break)return false;else throw h;}return c};if(a.prototype){a.prototype._objectEventSetup=a._objectEventSetup;a.prototype.observe=
a.observe;a.prototype.stopObserving=a.stopObserving;a.prototype.observeOnce=a.observeOnce;a.prototype.notify=function(b){if(a.notify){var c=$A(arguments).slice(1);c.unshift(this);c.unshift(b);a.notify.apply(a,c)}this._objectEventSetup(b);c=$A(arguments).slice(1);var e=[];try{if(this.options&&this.options[b]&&typeof this.options[b]=="function")e.push(this.options[b].apply(this,c)||null);for(var f=0;f<this._observers[b].length;++f)e.push(this._observers[b][f].apply(this._observers[b][f],c)||null)}catch(h){if(h==
$break)return false;else throw h;}return e}}}};Element.addMethods({observeOnce:function(a,b,c){var e=function(){c.apply(this,arguments);Element.stopObserving(a,b,e)};Element.observe(a,b,e)}});(function(){function a(b){var c;if(b.wheelDelta)c=b.wheelDelta/120;else if(b.detail)c=-b.detail/3;if(c)if(b.element().fire("mouse:wheel",{delta:c}).stopped){b.stop();return false}}document.observe("mousewheel",a)})();
var IframeShim=Class.create({initialize:function(){this.element=new Element("iframe",{style:"position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);display:none",src:"javascript:void(0);",frameborder:0});$(document.body).insert(this.element)},hide:function(){this.element.hide();return this},show:function(){this.element.show();return this},positionUnder:function(a){a=$(a);var b=a.cumulativeOffset(),c=a.getDimensions();this.element.setStyle({left:b[0]+"px",top:b[1]+"px",width:c.width+
"px",height:c.height+"px",zIndex:a.getStyle("zIndex")-1}).show();return this},setBounds:function(a){for(prop in a)a[prop]+="px";this.element.setStyle(a);return this},destroy:function(){this.element&&this.element.remove();return this}});if(typeof Draggable!="undefined")Draggable.prototype.draw=function(a){var b=Position.cumulativeOffset(this.element);if(this.options.ghosting){var c=Position.realOffset(this.element);b[0]+=c[0]-Position.deltaX;b[1]+=c[1]-Position.deltaY}c=this.currentDelta();b[0]-=c[0];b[1]-=c[1];if(this.options.scroll&&this.options.scroll!=window&&this._isScrollChild){b[0]-=this.options.scroll.scrollLeft-this.originalScrollLeft;b[1]-=this.options.scroll.scrollTop-this.originalScrollTop}c=[0,1].map(function(n){return a[n]-
b[n]-this.offset[n]}.bind(this));if(this.options.snap)c=typeof this.options.snap=="function"?this.options.snap(c[0],c[1],this):this.options.snap instanceof Array?c.map(function(n,p){return Math.round(n/this.options.snap[p])*this.options.snap[p]}.bind(this)):c.map(function(n){return Math.round(n/this.options.snap)*this.options.snap}.bind(this));if(this.options.onDraw)this.options.onDraw.bind(this)(c);else{var e=this.element.style;if(this.options.constrainToViewport){var f=document.viewport.getDimensions(),
h=this.element.getDimensions(),l=parseInt(this.element.getStyle("margin-top")),o=parseInt(this.element.getStyle("margin-left"));f=[[0-o,0-l],[f.width-h.width-o,f.height-h.height-l]];if(!this.options.constraint||this.options.constraint=="horizontal")this.element.style.left=c[0]>=f[0][0]&&c[0]<=f[1][0]?c[0]+"px":(c[0]<f[0][0]?f[0][0]:f[1][0])+"px";if(!this.options.constraint||this.options.constraint=="vertical")this.element.style.top=c[1]>=f[0][1]&&c[1]<=f[1][1]?c[1]+"px":(c[1]<=f[0][1]?f[0][1]:f[1][1])+
"px"}else{if(!this.options.constraint||this.options.constraint=="horizontal")e.left=c[0]+"px";if(!this.options.constraint||this.options.constraint=="vertical")e.top=c[1]+"px"}if(e.visibility=="hidden")e.visibility=""}};if(typeof Prototype=="undefined")throw"Control.Window requires Prototype to be loaded.";if(typeof IframeShim=="undefined")throw"Control.Window requires IframeShim to be loaded.";if(typeof Object.Event=="undefined")throw"Control.Window requires Object.Event to be loaded.";
Control.Window=Class.create({initialize:function(a,b){Control.Window.windows.push(this);this.remoteContentLoaded=this.ajaxRequest=this.sourceContainer=this.href=this.isOpen=this.container=false;this.numberInSequence=Control.Window.windows.length+1;this.indicator=false;this.effects={fade:false,appear:false};this.indicatorEffects={fade:false,appear:false};this.options=Object.extend({beforeOpen:Prototype.emptyFunction,afterOpen:Prototype.emptyFunction,beforeClose:Prototype.emptyFunction,afterClose:Prototype.emptyFunction,
height:null,width:null,className:false,position:"center",offsetLeft:0,offsetTop:0,iframe:false,hover:false,indicator:false,closeOnClick:false,iframeshim:true,fade:false,fadeDuration:0.75,draggable:false,onDrag:Prototype.emptyFunction,resizable:false,minHeight:false,minWidth:false,maxHeight:false,maxWidth:false,onResize:Prototype.emptyFunction,constrainToViewport:false,method:"post",parameters:{},onComplete:Prototype.emptyFunction,onSuccess:Prototype.emptyFunction,onFailure:Prototype.emptyFunction,
onException:Prototype.emptyFunction,onRemoteContentLoaded:Prototype.emptyFunction,insertRemoteContentAt:false},b||{});this.indicator=this.options.indicator?$(this.options.indicator):false;if(a)if(typeof a=="string"&&a.match(Control.Window.uriRegex))this.href=a;else{this.container=$(a);this.createDefaultContainer(a);if(this.container&&(this.container.readAttribute("href")&&this.container.readAttribute("href")!=""||this.options.hover&&this.options.hover!==true)){if(this.options.hover&&this.options.hover!==
true)this.sourceContainer=$(this.options.hover);else{this.sourceContainer=this.container;this.href=this.container.readAttribute("href");if((b=this.href.match(/^#(.+)$/))&&b[1]){this.container=$(b[1]);this.href=false}else this.container=false}this.sourceContainerOpenHandler=function(c){this.open(c);c.stop();return false}.bindAsEventListener(this);this.sourceContainerCloseHandler=function(c){this.close(c)}.bindAsEventListener(this);this.sourceContainerMouseMoveHandler=function(c){this.position(c)}.bindAsEventListener(this);
if(this.options.hover){this.sourceContainer.observe("mouseenter",this.sourceContainerOpenHandler);this.sourceContainer.observe("mouseleave",this.sourceContainerCloseHandler);this.options.position=="mouse"&&this.sourceContainer.observe("mousemove",this.sourceContainerMouseMoveHandler)}else this.sourceContainer.observe("click",this.sourceContainerOpenHandler)}}this.createDefaultContainer(a);if(this.options.insertRemoteContentAt===false)this.options.insertRemoteContentAt=this.container;a={margin:0,position:"absolute",
zIndex:Control.Window.initialZIndexForWindow()};if(this.options.width)a.width=$value(this.options.width)+"px";if(this.options.height)a.height=$value(this.options.height)+"px";this.container.setStyle(a);this.options.className&&this.container.addClassName(this.options.className);this.positionHandler=this.position.bindAsEventListener(this);this.outOfBoundsPositionHandler=this.ensureInBounds.bindAsEventListener(this);this.bringToFrontHandler=this.bringToFront.bindAsEventListener(this);this.container.observe("mousedown",
this.bringToFrontHandler);this.container.hide();this.closeHandler=this.close.bindAsEventListener(this);if(this.options.iframeshim){this.iFrameShim=new IframeShim;this.iFrameShim.hide()}this.applyResizable();this.applyDraggable();Event.observe(window,"resize",this.outOfBoundsPositionHandler);this.notify("afterInitialize")},open:function(a){if(this.isOpen){this.bringToFront();return false}if(this.notify("beforeOpen")===false)return false;if(this.options.closeOnClick){if(this.options.closeOnClick===
true)this.closeOnClickContainer=$(document.body);else if(this.options.closeOnClick=="container")this.closeOnClickContainer=this.container;else if(this.options.closeOnClick=="overlay"){Control.Overlay.load();this.closeOnClickContainer=Control.Overlay.container}else this.closeOnClickContainer=$(this.options.closeOnClick);this.closeOnClickContainer.observe("click",this.closeHandler)}if(this.href&&!this.options.iframe&&!this.remoteContentLoaded){this.remoteContentLoaded=true;if(this.href.match(/\.(jpe?g|gif|png|tiff?)$/i)){a=
new Element("img");a.observe("load",function(c){this.getRemoteContentInsertionTarget().insert(c);this.position();if(this.notify("onRemoteContentLoaded")!==false){this.options.indicator&&this.hideIndicator();this.finishOpen()}}.bind(this,a));a.writeAttribute("src",this.href)}else if(!this.ajaxRequest){this.options.indicator&&this.showIndicator();this.ajaxRequest=new Ajax.Request(this.href,{method:this.options.method,parameters:this.options.parameters,onComplete:function(c){this.notify("onComplete",
c);this.ajaxRequest=false}.bind(this),onSuccess:function(c){this.getRemoteContentInsertionTarget().insert(c.responseText);this.notify("onSuccess",c);if(this.notify("onRemoteContentLoaded")!==false){this.options.indicator&&this.hideIndicator();this.finishOpen()}}.bind(this),onFailure:function(c){this.notify("onFailure",c);this.options.indicator&&this.hideIndicator()}.bind(this),onException:function(c,e){this.notify("onException",c,e);this.options.indicator&&this.hideIndicator()}.bind(this)})}return true}else if(this.options.iframe&&
!this.remoteContentLoaded){this.remoteContentLoaded=true;this.options.indicator&&this.showIndicator();this.getRemoteContentInsertionTarget().insert(Control.Window.iframeTemplate.evaluate({href:this.href}));var b=this.container.down("iframe");b.onload=function(){this.notify("onRemoteContentLoaded");this.options.indicator&&this.hideIndicator();b.onload=null}.bind(this)}this.finishOpen(a);return true},close:function(a){if(!this.isOpen||this.notify("beforeClose",a)===false)return false;this.options.closeOnClick&&
this.closeOnClickContainer.stopObserving("click",this.closeHandler);if(this.options.fade)this.effects.fade=new Effect.Fade(this.container,{queue:{position:"front",scope:"Control.Window"+this.numberInSequence},from:1,to:0,duration:this.options.fadeDuration/2,afterFinish:function(){this.iFrameShim&&this.iFrameShim.hide();this.isOpen=false;this.notify("afterClose")}.bind(this)});else{this.container.hide();this.iFrameShim&&this.iFrameShim.hide()}this.ajaxRequest&&this.ajaxRequest.transport.abort();if(!(this.options.draggable||
this.options.resizable)&&this.options.position=="center")Event.stopObserving(window,"resize",this.positionHandler);!this.options.draggable&&this.options.position=="center"&&Event.stopObserving(window,"scroll",this.positionHandler);this.options.indicator&&this.hideIndicator();if(!this.options.fade){this.isOpen=false;this.notify("afterClose")}return true},position:function(a){if(this.options.position=="mouse"){var b=[Event.pointerX(a),Event.pointerY(a)];this.container.setStyle({top:b[1]+$value(this.options.offsetTop)+
"px",left:b[0]+$value(this.options.offsetLeft)+"px"})}else{a=this.container.getDimensions();var c=document.viewport.getDimensions();Position.prepare();var e=Position.deltaX+Math.floor((c.width-a.width)/2);b=Position.deltaY+(c.height>a.height?Math.floor((c.height-a.height)/2):0);if(this.options.position=="center")this.container.setStyle({top:a.height<=c.height?(b!=null&&b>0?b:0)+"px":0,left:a.width<=c.width?(e!=null&&e>0?e:0)+"px":0});else if(this.options.position=="relative"){b=this.sourceContainer.cumulativeOffset();
e=b[1]+$value(this.options.offsetTop);b=b[0]+$value(this.options.offsetLeft);this.container.setStyle({top:a.height<=c.height?(this.options.constrainToViewport?Math.max(0,Math.min(c.height-a.height,e)):e)+"px":0,left:a.width<=c.width?(this.options.constrainToViewport?Math.max(0,Math.min(c.width-a.width,b)):b)+"px":0})}else if(this.options.position.length){e=$value(this.options.position[1])+$value(this.options.offsetTop);b=$value(this.options.position[0])+$value(this.options.offsetLeft);this.container.setStyle({top:a.height<=
c.height?(this.options.constrainToViewport?Math.max(0,Math.min(c.height-a.height,e)):e)+"px":0,left:a.width<=c.width?(this.options.constrainToViewport?Math.max(0,Math.min(c.width-a.width,b)):b)+"px":0})}this.iFrameShim&&this.updateIFrameShimZIndex()}},ensureInBounds:function(){if(this.isOpen){var a=document.viewport.getDimensions(),b=this.container.cumulativeOffset(),c=this.container.getDimensions();b.left+c.width>a.width&&this.container.setStyle({left:Math.max(0,a.width-c.width)+"px"});b.top+c.height>
a.height&&this.container.setStyle({top:Math.max(0,a.height-c.height)+"px"})}},bringToFront:function(){Control.Window.bringToFront(this);this.notify("bringToFront")},destroy:function(){this.container.stopObserving("mousedown",this.bringToFrontHandler);if(this.draggable){Resizables.removeObserver(this.container);this.draggable.handle.stopObserving("mousedown",this.bringToFrontHandler);this.draggable.destroy()}if(this.resizable){Resizables.removeObserver(this.container);this.resizable.handle.stopObserving("mousedown",
this.bringToFrontHandler);this.resizable.destroy()}this.container&&!this.sourceContainer&&this.container.remove();if(this.sourceContainer)if(this.options.hover){this.sourceContainer.stopObserving("mouseenter",this.sourceContainerOpenHandler);this.sourceContainer.stopObserving("mouseleave",this.sourceContainerCloseHandler);this.options.position=="mouse"&&this.sourceContainer.stopObserving("mousemove",this.sourceContainerMouseMoveHandler)}else this.sourceContainer.stopObserving("click",this.sourceContainerOpenHandler);
this.iFrameShim&&this.iFrameShim.destroy();Event.stopObserving(window,"resize",this.outOfBoundsPositionHandler);Control.Window.windows=Control.Window.windows.without(this);this.notify("afterDestroy")},applyResizable:function(){if(this.options.resizable){if(typeof Resizable=="undefined")throw"Control.Window requires resizable.js to be loaded.";var a=null;if(this.options.resizable===true){a=new Element("div",{className:"resizable_handle"});this.container.insert(a)}else a=$(this.options.resziable);this.resizable=
new Resizable(this.container,{handle:a,minHeight:this.options.minHeight,minWidth:this.options.minWidth,maxHeight:this.options.constrainToViewport?function(b){return document.viewport.getDimensions().height-parseInt(b.style.top||0)-(b.getHeight()-parseInt(b.style.height||0))}:this.options.maxHeight,maxWidth:this.options.constrainToViewport?function(b){return document.viewport.getDimensions().width-parseInt(b.style.left||0)-(b.getWidth()-parseInt(b.style.width||0))}:this.options.maxWidth});this.resizable.handle.observe("mousedown",
this.bringToFrontHandler);Resizables.addObserver(new Control.Window.LayoutUpdateObserver(this,function(){this.iFrameShim&&this.updateIFrameShimZIndex();this.notify("onResize")}.bind(this)))}},applyDraggable:function(){if(this.options.draggable){if(typeof Draggables=="undefined")throw"Control.Window requires dragdrop.js to be loaded.";var a=null;if(this.options.draggable===true){a=new Element("div",{className:"draggable_handle"});this.container.insert(a)}else a=$(this.options.draggable);this.draggable=
new Draggable(this.container,{handle:a,constrainToViewport:this.options.constrainToViewport,zindex:this.container.getStyle("z-index"),starteffect:function(){if(Prototype.Browser.IE){this.old_onselectstart=document.onselectstart;document.onselectstart=function(){return false}}}.bind(this),endeffect:function(){document.onselectstart=this.old_onselectstart}.bind(this)});this.draggable.handle.observe("mousedown",this.bringToFrontHandler);Draggables.addObserver(new Control.Window.LayoutUpdateObserver(this,
function(){this.iFrameShim&&this.updateIFrameShimZIndex();this.notify("onDrag")}.bind(this)))}},createDefaultContainer:function(a){if(!this.container){this.container=new Element("div",{id:"control_window_"+this.numberInSequence});$(document.body).insert(this.container);typeof a=="string"&&$(a)==null&&!a.match(/^#(.+)$/)&&!a.match(Control.Window.uriRegex)&&this.container.update(a)}},finishOpen:function(a){this.bringToFront();if(this.options.fade){if(typeof Effect=="undefined")throw"Control.Window requires effects.js to be loaded.";
this.effects.fade&&this.effects.fade.cancel();this.effects.appear=new Effect.Appear(this.container,{queue:{position:"end",scope:"Control.Window."+this.numberInSequence},from:0,to:1,duration:this.options.fadeDuration/2,afterFinish:function(){this.iFrameShim&&this.updateIFrameShimZIndex();this.isOpen=true;this.notify("afterOpen")}.bind(this)})}else this.container.show();this.position(a);if(!(this.options.draggable||this.options.resizable)&&this.options.position=="center")Event.observe(window,"resize",
this.positionHandler,false);!this.options.draggable&&this.options.position=="center"&&Event.observe(window,"scroll",this.positionHandler,false);if(!this.options.fade){this.isOpen=true;this.notify("afterOpen")}return true},showIndicator:function(){this.showIndicatorTimeout=window.setTimeout(function(){if(this.options.fade)this.indicatorEffects.appear=new Effect.Appear(this.indicator,{queue:{position:"front",scope:"Control.Window.indicator."+this.numberInSequence},from:0,to:1,duration:this.options.fadeDuration/
2});else this.indicator.show()}.bind(this),Control.Window.indicatorTimeout)},hideIndicator:function(){this.showIndicatorTimeout&&window.clearTimeout(this.showIndicatorTimeout);this.indicator.hide()},getRemoteContentInsertionTarget:function(){return typeof this.options.insertRemoteContentAt=="string"?this.container.down(this.options.insertRemoteContentAt):$(this.options.insertRemoteContentAt)},updateIFrameShimZIndex:function(){this.iFrameShim&&this.iFrameShim.positionUnder(this.container)}});
Object.extend(Control.Window,{windows:[],baseZIndex:9999,indicatorTimeout:250,iframeTemplate:new Template('<iframe src="#{href}" width="100%" height="100%" frameborder="0"></iframe>'),uriRegex:/^(\/|\#|https?\:\/\/|[\w]+\/)/,bringToFront:function(a){Control.Window.windows=Control.Window.windows.without(a);Control.Window.windows.push(a);Control.Window.windows.each(function(b,c){c=Control.Window.baseZIndex+c;b.container.setStyle({zIndex:c});b.isOpen&&b.iFrameShim&&b.updateIFrameShimZIndex();if(b.options.draggable)b.draggable.options.zindex=
c})},open:function(a,b){a=new Control.Window(a,b);a.open();return a},initialZIndexForWindow:function(){return Control.Window.baseZIndex+(Control.Window.windows.length-1)}});Object.Event.extend(Control.Window);
Control.Window.LayoutUpdateObserver=Class.create({initialize:function(a,b){this.w=a;this.element=$(a.container);this.observer=b},onStart:Prototype.emptyFunction,onEnd:function(a,b){b.element==this.element&&this.iFrameShim&&this.w.updateIFrameShimZIndex()},onResize:function(a,b){b.element==this.element&&this.observer(this.element)},onDrag:function(a,b){b.element==this.element&&this.observer(this.element)}});
Control.Overlay={id:"control_overlay",loaded:false,container:false,lastOpacity:0,styles:{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:9998},ieStyles:{position:"absolute",top:0,left:0,zIndex:9998},effects:{fade:false,appear:false},load:function(){if(Control.Overlay.loaded)return false;Control.Overlay.loaded=true;Control.Overlay.container=new Element("div",{id:Control.Overlay.id});$(document.body).insert(Control.Overlay.container);if(Prototype.Browser.IE){Control.Overlay.container.setStyle(Control.Overlay.ieStyles);
Event.observe(window,"scroll",Control.Overlay.positionOverlay);Event.observe(window,"resize",Control.Overlay.positionOverlay);Control.Overlay.observe("beforeShow",Control.Overlay.positionOverlay)}else Control.Overlay.container.setStyle(Control.Overlay.styles);Control.Overlay.iFrameShim=new IframeShim;Control.Overlay.iFrameShim.hide();Event.observe(window,"resize",Control.Overlay.positionIFrameShim);Control.Overlay.container.hide();return true},unload:function(){if(!Control.Overlay.loaded)return false;
Event.stopObserving(window,"resize",Control.Overlay.positionOverlay);Control.Overlay.stopObserving("beforeShow",Control.Overlay.positionOverlay);Event.stopObserving(window,"resize",Control.Overlay.positionIFrameShim);Control.Overlay.iFrameShim.destroy();Control.Overlay.container.remove();Control.Overlay.loaded=false;return true},show:function(a,b){if(Control.Overlay.notify("beforeShow")===false)return false;Control.Overlay.lastOpacity=a;Control.Overlay.positionIFrameShim();Control.Overlay.iFrameShim.show();
if(b){if(typeof Effect=="undefined")throw"Control.Window requires effects.js to be loaded.";Control.Overlay.effects.fade&&Control.Overlay.effects.fade.cancel();Control.Overlay.effects.appear=new Effect.Appear(Control.Overlay.container,{queue:{position:"end",scope:"Control.Overlay"},afterFinish:function(){Control.Overlay.notify("afterShow")},from:0,to:Control.Overlay.lastOpacity,duration:(b===true?0.75:b)/2})}else{Control.Overlay.container.setStyle({opacity:a||1});Control.Overlay.container.show();
Control.Overlay.notify("afterShow")}return true},hide:function(a){if(Control.Overlay.notify("beforeHide")===false)return false;Control.Overlay.effects.appear&&Control.Overlay.effects.appear.cancel();Control.Overlay.iFrameShim.hide();if(a)Control.Overlay.effects.fade=new Effect.Fade(Control.Overlay.container,{queue:{position:"front",scope:"Control.Overlay"},afterFinish:function(){Control.Overlay.notify("afterHide")},from:Control.Overlay.lastOpacity,to:0,duration:(a===true?0.75:a)/2});else{Control.Overlay.container.hide();
Control.Overlay.notify("afterHide")}return true},positionIFrameShim:function(){Control.Overlay.container.visible()&&Control.Overlay.iFrameShim.positionUnder(Control.Overlay.container)},positionOverlay:function(){Control.Overlay.container.setStyle({width:document.body.clientWidth+"px",height:document.body.clientHeight+"px"})}};Object.Event.extend(Control.Overlay);
Control.ToolTip=Class.create(Control.Window,{initialize:function($super,b,c,e){$super(c,Object.extend(Object.extend(Object.clone(Control.ToolTip.defaultOptions),e||{}),{position:"mouse",hover:b}))}});Object.extend(Control.ToolTip,{defaultOptions:{offsetLeft:10}});Control.Modal=Class.create(Control.Window,{initialize:function($super,b,c){Control.Modal.InstanceMethods.beforeInitialize.bind(this)();$super(b,Object.extend(Object.clone(Control.Modal.defaultOptions),c||{}))}});
Object.extend(Control.Modal,{defaultOptions:{overlayOpacity:0.5,closeOnClick:"overlay"},current:false,open:function(a,b){a=new Control.Modal(a,b);a.open();return a},close:function(){Control.Modal.current&&Control.Modal.current.close()},InstanceMethods:{beforeInitialize:function(){Control.Overlay.load();this.overlayFinishedOpening=false;this.observe("beforeOpen",Control.Modal.Observers.beforeOpen.bind(this));this.observe("afterOpen",Control.Modal.Observers.afterOpen.bind(this));this.observe("afterClose",
Control.Modal.Observers.afterClose.bind(this))}},Observers:{beforeOpen:function(){if(this.overlayFinishedOpening)Control.Window.windows.without(this).invoke("close");else{Control.Overlay.observeOnce("afterShow",function(){this.overlayFinishedOpening=true;this.open()}.bind(this));Control.Overlay.show(this.options.overlayOpacity,this.options.fade?this.options.fadeDuration:false);throw $break;}},afterOpen:function(){Control.Modal.current=this},afterClose:function(){Control.Overlay.hide(this.options.fade?
this.options.fadeDuration:false);this.overlayFinishedOpening=Control.Modal.current=false}}});
Control.LightBox=Class.create(Control.Window,{initialize:function($super,b,c){this.allImagesLoaded=false;if(c.modal){c=Object.extend(Object.clone(Control.LightBox.defaultOptions),c||{});c=Object.extend(Object.clone(Control.Modal.defaultOptions),c);c=Control.Modal.InstanceMethods.beforeInitialize.bind(this)(c);$super(b,c)}else $super(b,Object.extend(Object.clone(Control.LightBox.defaultOptions),c||{}));(this.hasRemoteContent=this.href&&!this.options.iframe)?this.observe("onRemoteContentLoaded",Control.LightBox.Observers.onRemoteContentLoaded.bind(this)):
this.applyImageObservers();this.observe("beforeOpen",Control.LightBox.Observers.beforeOpen.bind(this))},applyImageObservers:function(){var a=this.getImages();this.numberImagesToLoad=a.length;this.numberofImagesLoaded=0;a.each(function(b){b.observe("load",function(){++this.numberofImagesLoaded;if(this.numberImagesToLoad==this.numberofImagesLoaded){this.allImagesLoaded=true;this.onAllImagesLoaded()}}.bind(this,b));b.hide()}.bind(this))},onAllImagesLoaded:function(){this.getImages().each(function(a){this.showImage(a)}.bind(this));
if(this.hasRemoteContent){this.options.indicator&&this.hideIndicator();this.finishOpen()}else this.open()},getImages:function(){return this.container.select(Control.LightBox.imageSelector)},showImage:function(a){a.show()}});Object.extend(Control.LightBox,{imageSelector:"img",defaultOptions:{},Observers:{beforeOpen:function(){if(!this.hasRemoteContent&&!this.allImagesLoaded)throw $break;},onRemoteContentLoaded:function(){this.applyImageObservers();if(!this.allImagesLoaded)throw $break;}}});function UserProfileHoverbox(){this.initialize()}
UserProfileHoverbox.prototype={initialize:function(){this._hoverboxCache={};this._timeout=this._currentHoverElement=this._currentUserAnchor=this._hoverbox=null;this._mouseOverHandler=this.handleMouseOverUser.bindAsEventListener(this);this.refreshMouseOverObservers()},refreshMouseOverObservers:function(){$$(".hover_profile",".hover_profile_simple").each(function(a){if(a.href!=undefined)a.observe("mouseover",this._mouseOverHandler);else{var b=a.down(".js_hover_profile_link");b!=undefined&&b.href!=undefined&&
a.observe("mouseover",this._mouseOverHandler)}}.bind(this))},handleMouseOverUser:function(a){var b=a.findElement("A")||a.findElement().down(".js_hover_profile_link")||null;if(b!=null)if(!(!b.hasClassName("js_hover_profile_link")&&!b.hasClassName("hover_profile")&&!b.hasClassName("hover_profile_simple")))if(!(b!=null&&this._currentUserAnchor!=null&&b.href==this._currentUserAnchor.href)){this.cancelOrCloseOpen();this._currentHoverElement=a.findElement(".hover_profile")||a.findElement(".hover_profile_simple");
this._currentUserAnchor=b;this._timeout=setTimeout(this.openHoverbox.bindAsEventListener(this),500);this._currentHoverElement.observe("mouseleave",this.cancelOrCloseOpen.bindAsEventListener(this))}},openHoverbox:function(){var a=this._currentHoverElement.cumulativeOffset();document.viewport.getDimensions();var b={},c=this._currentHoverElement.hasClassName("hover_profile_simple");if(c)b.simple="true";this._hoverbox=this._hoverboxCache[this._currentUserAnchor.href];if(this._hoverbox!=null&&this._hoverbox._is_simple!=
c){this._hoverbox.destroy();this._hoverbox=null;this._hoverboxCache[this._currentUserAnchor.href]=null}if(this._hoverbox==null){this._hoverbox=new Control.Window(this._currentUserAnchor,{method:"GET",parameters:b,offsetLeft:30,offsetTop:-22,className:"hover_profile_window"});this._hoverbox._is_simple=c;this._hoverbox.sourceContainer.stopObserving("click");this._hoverbox.observe("afterDestroy",this.handleBoxDestroy.bindAsEventListener(this,this._hoverbox))}this._hoverbox.observe("bringToFront",this.handleBoxBeforeOpen.bindAsEventListener(this));
this._hoverbox.observe("afterOpen",this.handleBoxOpened.bindAsEventListener(this));this._hoverbox.options.position=[a[0],a[1]];this._hoverbox.href+="/show_hover";this._hoverbox.open();this._currentHoverElement.stopObserving("mouseleave");this._currentHoverElement.observe("mouseleave",this.handleMouseLeaveUser.bindAsEventListener(this))},handleMouseLeaveUser:function(){if(this._hoverbox!=null)if(this._hoverbox.isOpen){this._currentHoverElement.stopObserving("mouseleave");this.startCloseTimeout()}else this.cancelOrCloseOpen()},
cancelOrCloseOpen:function(){if(this._hoverbox!=null){this._hoverbox.stopObserving("afterOpen");this._hoverbox.container.stopObserving("mouseenter");this._hoverbox.container.stopObserving("mouseleave");if(this._hoverbox.ajaxRequest){this._hoverbox.ajaxRequest.transport.abort();this._hoverbox.close();this._hoverbox.destroy()}else this._hoverbox.close();this._hoverbox=null}this._currentHoverElement=this._currentUserAnchor=null;this.cancelTimeout()},cancelTimeout:function(){if(this._timeout!=null){clearTimeout(this._timeout);
this._timeout=null}},startCloseTimeout:function(){this._timeout=setTimeout(this.mouseLeaveTimeout.bindAsEventListener(this),500)},mouseLeaveTimeout:function(){this.cancelOrCloseOpen()},handleBoxBeforeOpen:function(){var a=document.viewport.getDimensions();if(this._currentHoverElement.cumulativeOffset()[0]+this._currentHoverElement.getWidth()/2>a.width-440){this._hoverbox.options.offsetLeft=-this._hoverbox.container.getDimensions().width;$(this._hoverbox.container).addClassName("profile_left");$(this._hoverbox.container).removeClassName("profile_right")}else{this._hoverbox.options.offsetLeft=
this._currentHoverElement.getWidth()/2;$(this._hoverbox.container).addClassName("profile_right");$(this._hoverbox.container).removeClassName("profile_left")}},handleBoxOpened:function(){this._hoverboxCache[this._currentUserAnchor.href]=this._hoverbox;this._hoverbox.container.observe("mouseenter",this.cancelTimeout.bindAsEventListener(this));this._hoverbox.container.observe("mouseleave",this.startCloseTimeout.bindAsEventListener(this));var a=this._hoverbox.container.down(".mini_profile_bio");if(a!=
undefined){a.setStyle({width:a.getWidth()+"px"});a.show()}},handleBoxDestroy:function(a,b){b.container.remove()}};function registerHoverProfileObservers(){if(typeof userProfileHoverbox=="undefined")userProfileHoverbox=new UserProfileHoverbox;else userProfileHoverbox.refreshMouseOverObservers()}document.observe("dom:loaded",function(){registerHoverProfileObservers()});function FavoriteHoverbox(a,b,c,e,f){this.initialize(a,b,c,e,f)}
FavoriteHoverbox.prototype={initialize:function(a,b,c,e,f){var h="",l="";if(a==undefined)h="You have already earned the "+b+" point maximum for ratings per day. Come back tomorrow to rate more!";else if(c)if(a.rating>=4){h="You have updated your rating."+String(f||"");l="hover_add_favorite hover_long"}else h="You have updated your rating.";else if(a.rating>=4){h="Thanks. You just earned 1 point!"+String(f||"");l="hover_add_favorite hover_long"}else h="Sweet! You earned 1 point and improved your recommendations.";
setTimeout(function(){var o=$(e+"rating-indicator").next(".star-rating"),n;if(o==undefined)o=$$("#star_ratings_block"+e.sub("game","").sub("-","")+" .star-rating-big").first();if(o==undefined)o=$(e+"rating-indicator").next(".star-rating-big");o.addClassName("rating_message_hover_anchor");o.visible()||o.show();n=new Control.Window(null,{closeOnClick:true,position:"relative",offsetLeft:o.getWidth(),offsetTop:function(){return e=="quicklinks_"?o.getHeight()/2-n.container.getHeight()+12:o.getHeight()/
2-12}});n.observe("afterClose",function(){n.destroy()});n.sourceContainer=o;n.container.insert('<div class="'+(e=="quicklinks_"?"hover_high ":"")+"rating_message hover_item "+l+'"><div class="hover_arrow_1"></div><div class="hover_arrow_2"></div><div class="hover_container pas media"><span class="rating_icon spritesite img"></span><p class="bd">'+h+"</p></div></div>");n.open();setTimeout(function(){n.close()},5E3)},0)}};function LikesHoverbox(){this.initialize()}
LikesHoverbox.prototype={initialize:function(){this._hoverboxCache={};this._timeout=this._currentHoverElement=this._currentUserAnchor=this._hoverbox=null;this._mouseOverHandler=this.handleMouseOverUser.bindAsEventListener(this);this.refreshMouseOverObservers()},refreshMouseOverObservers:function(){$$(".like_count").each(function(a){a.observe("mouseover",this._mouseOverHandler)}.bind(this))},handleMouseOverUser:function(a){if(parseInt(a.target.innerHTML.gsub(/[()]/,""))!=0){this.cancelOrCloseOpen();
this._currentUserAnchor=this._currentHoverElement=a.target;this._timeout=setTimeout(this.openHoverbox.bindAsEventListener(this),500);this._currentHoverElement.observe("mouseleave",this.cancelOrCloseOpen.bindAsEventListener(this))}},openHoverbox:function(){var a=this._currentHoverElement.cumulativeOffset();document.viewport.getDimensions();var b={},c=this._currentHoverElement.up("li").id.sub("feed_item_",""),e=this._currentHoverElement.hasClassName("hover_profile_simple");this._likeHref="/user_likes?feed_item_id="+
c;if(e)b.simple="true";this._hoverbox=this._hoverboxCache[this._likeHref];if(this._hoverbox!=null){this._hoverbox.destroy();this._hoverbox=null;this._hoverboxCache[this._likeHref]=null}if(this._hoverbox==null){this._hoverbox=new Control.Window(this._currentUserAnchor,{method:"GET",parameters:b,offsetLeft:30,offsetTop:-22,className:"hover_likes_window"});this._hoverbox._is_simple=e;this._hoverbox.sourceContainer.stopObserving("click");this._hoverbox.observe("afterDestroy",this.handleBoxDestroy.bindAsEventListener(this,
this._hoverbox))}this._hoverbox.observe("bringToFront",this.handleBoxBeforeOpen.bindAsEventListener(this));this._hoverbox.observe("afterOpen",this.handleBoxOpened.bindAsEventListener(this));this._hoverbox.options.position=[a[0],a[1]];this._hoverbox.href="/user_likes?feed_item_id="+c;this._hoverbox.open();this._currentHoverElement.stopObserving("mouseleave");this._currentHoverElement.observe("mouseleave",this.handleMouseLeaveUser.bindAsEventListener(this))},handleMouseLeaveUser:function(){if(this._hoverbox!=
null)if(this._hoverbox.isOpen){this._currentHoverElement.stopObserving("mouseleave");this.startCloseTimeout()}else this.cancelOrCloseOpen()},cancelOrCloseOpen:function(){if(this._hoverbox!=null){this._hoverbox.stopObserving("afterOpen");this._hoverbox.container.stopObserving("mouseenter");this._hoverbox.container.stopObserving("mouseleave");if(this._hoverbox.ajaxRequest){this._hoverbox.ajaxRequest.transport.abort();this._hoverbox.close();this._hoverbox.destroy()}else this._hoverbox.close();this._hoverbox=
null}this._currentHoverElement=this._currentUserAnchor=null;this.cancelTimeout()},cancelTimeout:function(){if(this._timeout!=null){clearTimeout(this._timeout);this._timeout=null}},startCloseTimeout:function(){this._timeout=setTimeout(this.mouseLeaveTimeout.bindAsEventListener(this),500)},mouseLeaveTimeout:function(){this.cancelOrCloseOpen()},handleBoxBeforeOpen:function(){var a=document.viewport.getDimensions();if(this._currentHoverElement.cumulativeOffset()[0]+this._currentHoverElement.getWidth()/
2>a.width-440){this._hoverbox.options.offsetLeft=-this._hoverbox.container.getDimensions().width;$(this._hoverbox.container).addClassName("profile_left");$(this._hoverbox.container).removeClassName("profile_right")}else{this._hoverbox.options.offsetLeft=this._currentHoverElement.getWidth()/2;$(this._hoverbox.container).addClassName("profile_right");$(this._hoverbox.container).removeClassName("profile_left")}},handleBoxOpened:function(){this._hoverboxCache[this._likeHref]=this._hoverbox;this._hoverbox.container.observe("mouseenter",
this.cancelTimeout.bindAsEventListener(this));this._hoverbox.container.observe("mouseleave",this.startCloseTimeout.bindAsEventListener(this));var a=this._hoverbox.container.down(".mini_profile_bio");if(a!=undefined){a.setStyle({width:a.getWidth()+"px"});a.show()}},handleBoxDestroy:function(a,b){b.container.remove()}};function registerLikeObservers(){if(typeof likesHoverbox=="undefined")likesHoverbox=new LikesHoverbox;else likesHoverbox.refreshMouseOverObservers()}document.observe("dom:loaded",function(){registerLikeObservers()});function Roller(a){this.initialize(a)}
Roller.prototype={initialize:function(a){this._scrollDelay=a.scrollDelay;this._currentPane=0;this._paneScrollTimer=null;this._scrollDuration=a.scrollDuration?(a.scrollDuration||8E3)/1E3:1;this._effect=null;this._scrollablePane=$(a.scrollablePane)||$("featured_content_scrollable");this._scrollCallbacks=[];this._showDots=a.showDots==undefined?true:a.showDots;this._container=$(a.container);var b,c;if(a.targetableCountryCodes){b=".ind_pane.non_targeted";if(a.targetableCountryCodes.include(active_user.countryCode()))b+=", .ind_pane."+
active_user.countryCode()+"_only";if(active_user.countryCode()!="US")b+=", .ind_pane.Rest_Of_World_only"}else b=".ind_pane";this._panes=c=this._scrollablePane.select(b);this._scrollablePane.select(" .ind_pane").filter(function(e){return c.indexOf(e)<0}).each(Element.hide);if((this._nitems=c.length)&&!c[0].hasClassName("volatile")&&!c[0].hasClassName("loaded")){this._panes_loaded=[];this.loadPaneNumber(0)}a=c[0].clone(true);c[c.length-1].insert({after:a});c.push(a);this._panes_loaded=c.map(function(e){return e.match(".volatile, .loaded")})},
scrollToPane:function(a){this.loadPaneNumber(a);a=this._panes[a].positionedOffset();var b=this._scrollDuration;this._effect&&this._effect.cancel();this._effect=new Effect.Morph(this._scrollablePane,{style:"left:"+-a[0]+"px; top:0px;",duration:b});if(this._showDots&&this._container){this._container.down(".pane_dots").descendants().each(function(c){c.hasClassName("roller_dot")&&c.removeClassName("active_dot").addClassName("inactive_dot")});this._container.down(".pane_dots").down(".dot_"+(this._currentPane<
this._nitems?this._currentPane:0)).removeClassName("inactive_dot").addClassName("active_dot")}this._scrollCallbacks.each(function(c){c(this._currentPane)})},setPane:function(a){this.loadPaneNumber(a);var b=this._panes[a].positionedOffset();this._currentPane=a;this._effect&&this._effect.cancel();this._scrollablePane.setStyle({left:-b[0]+"px",top:"0px"})},loadPaneNumber:function(a){if(!this._panes_loaded[a]){var b=this._panes[a];this._panes_loaded[a]=true;b.update(Base64.decode(b.down(".pane_contents").innerHTML));
b.addClassName("loaded");$H(active_user.split_treatments.feature_roll).each(function(c){$$(".ind_pane."+c[0]+" div.featured_split_treatment").each(Element.hide);$$("."+c.join(" div.")).each(Element.show)})}},scrollToNextPane:function(){this.scrollToNextPaneAndStop();this.setNextPaneScrollTimeout()},scrollToNextPaneAndStop:function(){clearTimeout(this._paneScrollTimer);if(this._currentPane==this._nitems){this._currentPane=0;this.isEffectRunning()||this.setPane(this._currentPane)}this._currentPane++;
this.scrollToPane(this._currentPane)},scrollToPreviousPaneAndStop:function(){clearTimeout(this._paneScrollTimer);if(0==this._currentPane){this._currentPane=this._nitems;this.isEffectRunning()||this.setPane(this._currentPane)}this._currentPane--;this.scrollToPane(this._currentPane)},scrollToPreviousPane:function(){this.scrollToPreviousPaneAndStop();this.setNextPaneScrollTimeout()},setNextPaneScrollTimeout:function(){this._paneScrollTimer=setTimeout(this.scrollToNextPane.bind(this),this._scrollDelay)},
isEffectRunning:function(){return this._effect&&"finished"!=this._effect.state},addOnScrollObserver:function(a){this._scrollCallbacks.push(a)},paneCount:function(){return this._nitems}};Roller.rolodex={};function AjaxRoller(a){this.initialize(a)}AjaxRoller.prototype=Object.extend(AjaxRoller.prototype,Roller.prototype);
AjaxRoller.prototype=Object.extend(AjaxRoller.prototype,{loadPaneNumber:function(a){if(!this._panes_loaded[a]){var b=this,c=document.location.pathname.split("/")[2];new Ajax.Request("/accounts/"+c+"/games_pod",{method:"get",parameters:{page:this._currentPane},asynchronous:false,onSuccess:function(e){e=e.responseJSON;var f=b._panes[a];b._panes_loaded[a]=true;f.update(e.html);f.addClassName("loaded");active_user.isAdmin()&&$$(".admin_controls").each(Element.show)}})}}});AjaxRoller.rolodex={};var SocialHistory=function(a){function b(m,v,A){if(m.currentStyle)var B=m.currentStyle[A];else if(window.getComputedStyle)B=v.defaultView.getComputedStyle(m,null).getPropertyValue(A);return B}function c(m){m.parentNode.removeChild(m)}function e(){var m=document.createElement("iframe");m.style.position="absolute";m.style.visibility="hidden";document.body.appendChild(m);if(m.contentDocument)m.doc=m.contentDocument;else if(m.contentWindow)m.doc=m.contentWindow.document;m.doc.open();m.doc.write("<style>");
m.doc.write("a{color: #000000; display:none;}");m.doc.write("a:visited {color: #FF0000; display:inline;}");m.doc.write("</style>");m.doc.close();return m}function f(m){var v=n.doc.createElement("a");v.href=m;v.innerHTML=l;n.doc.body.appendChild(v)}var h={Digg:["http://digg.com","http://digg.com/login"],Reddit:["http://reddit.com","http://reddit.com/new/","http://reddit.com/controversial/","http://reddit.com/top/","http://reddit.com/r/reddit.com/","http://reddit.com/r/programming/"],StumbleUpon:["http://stumbleupon.com"],
"Yahoo Buzz":["http://buzz.yahoo.com"],Facebook:["http://facebook.com/home.php","http://facebook.com","https://login.facebook.com/login.php"],"Del.icio.us":["https://secure.del.icio.us/login","http://del.icio.us/"],MySpace:["http://www.myspace.com/"],Technorati:["http://www.technorati.com"],Newsvine:["https://www.newsvine.com","https://www.newsvine.com/_tools/user/login"],Songza:["http://songza.com"],Slashdot:["http://slashdot.org/"],"Ma.gnolia":["http://ma.gnolia.com/"],Blinklist:["http://www.blinklist.com"],
Furl:["http://furl.net","http://furl.net/members/login"],"Mister Wong":["http://www.mister-wong.com"],Current:["http://current.com","http://current.com/login.html"],Menaeme:["http://meneame.net","http://meneame.net/login.php"],Oknotizie:["http://oknotizie.alice.it","http://oknotizie.alice.it/login.html.php"],Diigo:["http://www.diigo.com/","https://secure.diigo.com/sign-in"],Funp:["http://funp.com","http://funp.com/account/loginpage.php"],Blogmarks:["http://blogmarks.net"],"Yahoo Bookmarks":["http://bookmarks.yahoo.com"],
Xanga:["http://xanga.com"],Blogger:["http://blogger.com"],"Last.fm":["http://www.last.fm/","https://www.last.fm/login/"],N4G:["http://www.n4g.com"],Faves:["http://faves.com","http://faves.com/home","https://secure.faves.com/signIn"],Simpy:["http://www.simpy.com","http://www.simpy.com/login"],Yigg:["http://www.yigg.de"],Kirtsy:["http://www.kirtsy.com","http://www.kirtsy.com/login.php"],Fark:["http://www.fark.com","http://cgi.fark.com/cgi/fark/users.pl?self=1"],Mixx:["https://www.mixx.com/login/dual",
"http://www.mixx.com"],"Google Bookmarks":["http://www.google.com/bookmarks","http://www.google.com/ig/add?moduleurl=bookmarks.xml&hl=en"],Subbmitt:["http://subbmitt.com/"],Twitter:["http://twitter.com","http://twitter.com/login"]};for(var l in a){if(typeof h[l]=="undefined")h[l]=[];if(typeof a[l]=="string")h[l].push(a[l]);else h[l]=h[l].concat(a[l])}var o={},n=e();for(l in h){var p=h[l];for(a=0;a<p.length;a++){f(p[a],l);if(p[a].match(/www\./)){var y=p[a].replace(/www\./,"");f(y,l)}else{y=p[a].indexOf("//")+
2;y=p[a].substring(0,y)+"www."+p[a].substring(y);f(y,l)}}}p=n.doc.body.childNodes;for(a=0;a<p.length;a++)if(b(p[a],n.doc,"display")!="none")o[p[a].innerHTML]=true;c(n);return new (function(){var m=[];for(var v in o)m.push(v);this.visitedSites=function(){return m};this.doesVisit=function(B){if(typeof h[B]=="undefined")return-1;return typeof o[B]!="undefined"};var A=[];for(v in h)A.push(v);this.checkedSites=function(){return A}})};function subjectChanged(a){if($("select_type")){var b=$F("select_type");b&&b!=""&&$("abuse_form_submit").enable();if(b=="OtherAbuseReport"||b=="InappropriateChatReport"||b=="UnderageUserReport"||b=="PermabanRequest"){$("description_field").show();updateDescriptionPrompt(true,a)}if(b=="InappropriateUsernameReport"||b=="InappropriateAvatarReport"||b=="InappropriateProfileReport"){$("description_field").show();updateDescriptionPrompt(false,a)}}}
function updateDescriptionPrompt(a,b){b="Please describe your reason for reporting "+b+" using as much detail as possible";var c=$("abuse_report_description_label_block").innerHTML;a=a?c.gsub("Please add any other information that would be helpful",b):c.gsub(b,"Please add any other information that would be helpful");$("abuse_report_description_label_block").update(a)};function upd(a,b,c){if(a.checked||c=="always"){if(c){index=a.id.substring(a.id.indexOf("[")+1,a.id.indexOf("]"));radio_id="handle["+index+"]";$(radio_id).checked="handle"}b&&b.show()}else b&&b.hide()};function AgeGate(a,b){a&&b?this.initialize(a,b):this.initialize(null,a)}AgeGate.MONTHS=["January","February","March","April","May","June","July","August","September","October","November","December"];
AgeGate.prototype={initialize:function(a,b){var c=this;this._cookie_name=b.cookie_name||"age_gate";this._active_user=b.active_user||active_user;this._required_age=b.required_age;this._age_met=false;if(this._use_form=b.use_form===undefined?true:b.use_form){this._element=$(a);this._button_text=b.button_text||"Go"}this._onSuccess=(b.onSuccess||function(){}).wrap(function(e){c._age_met=true;Cookie.set(c._cookie_name,"YES");return e()});this._onFailure=(b.onFailure||function(){}).wrap(function(e){Cookie.set(c._cookie_name,
"NO");return e()});this._onError=b.onError||function(){};this.preflight()||this._age_met||(this._use_form?this.writeForm():this._onFailure())},preflight:function(){var a=this._active_user.age();if(a){a>=this._required_age?this._onSuccess():this._onFailure();return true}a=Cookie.get(this._cookie_name);if(a=="YES"){this._onSuccess();return true}else if(a=="NO"){this._onFailure();return true}return false},writeForm:function(){var a=this,b="",c=0;b='<form action="#">';b+="<dl>";b+="<dt><label>Date of Birth</label></dt>";
b+='<dd id="date">';b+='<select id="user_month" name="user_month">';b+='<option value=""></option>';for(c=0;c<AgeGate.MONTHS.length;c++)b+='<option value="'+c+'">'+AgeGate.MONTHS[c]+"</option>";b+="</select>";b+='<select id="user_day" name="user_day">';b+='<option value=""></option>';for(c=1;c<=31;c++)b+='<option value="'+c+'">'+c+"</option>";b+="</select>";b+='<select id="user_year" name="user_year">';b+='<option value=""></option>';for(c=2005;c>=1908;c--)b+='<option value="'+c+'">'+c+"</option>";
b+="</select>";b+="</dd>";b+="</dl>";b+='<input type="submit" value="'+this._button_text+'" />';b+="</form>";this._element.innerHTML+=b;(function(){a._element.immediateDescendants()[0].onsubmit=function(){a.checkAge(this);return false}}).defer()},checkAge:function(a){var b=Number(a.user_month.getValue()),c=Number(a.user_day.getValue());a=Number(a.user_year.getValue());if(isNaN(b)||c===0||a===0)this._onError();else{b=new Date(a+this._required_age,b,c);(new Date).getTime()-b.getTime()<0?this._onFailure():
this._onSuccess()}}};AvailabilityCheck=function(a,b){this.initialize(a,b)};
AvailabilityCheck.prototype={initialize:function(a,b){b||(b={});this.request=null;this.generatedUsername=b.generatedUsername;this.validateLength=!!b.validateLength;this.clear=b.clear||function(){$("availability_success").hide();$("availability_failure").hide()};this.success=b.success||function(){$("availability_success").show()};this.failure=b.failure||function(c){$("availability_failure").update(c).show()};Event.observe(a,"keyup",this.keyup.bind(this));Event.observe(a,"blur",this.blur.bind(this))},
blur:function(a){this.makeRequest(a)},keyup:function(a){if(this.request){this.request.transport.abort();this.request=null;$("checking_availability").hide()}this.checker&&clearTimeout(this.checker);this.checker=setTimeout(this.makeRequest.bind(this,a),1E3)},makeRequest:function(a){var b=this,c=a.target.value;if(this.generatedUsername&&this.generatedUsername==c){this.clear();this.success()}else if(c.length==0){this.validateLength&&this.clear();b.failure("Username can't be blank")}else if(c.length<4){this.validateLength&&
this.clear();b.failure("Username is too short, needs to be between 4 to 16 characters")}else if(c.length>16){this.validateLength&&this.clear();b.failure("Username is too long, needs to be between 4 to 16 characters")}else if(this.request==null){$("checking_availability").show();this.clear();this.request=new Ajax.Request("/accounts/availability",{parameters:{username:a.target.value},method:"get",onSuccess:function(e){e=String(e.responseText).evalJSON();$("checking_availability").hide();e.success?b.success():
b.failure("Username taken. Please try again.")}})}}};function hideAllButOne(a,b){$$(a).each(function(c){Element.hide(c)});Element.show(b)};Base64=function(){var a=function(c){c=c.replace(/\r\n/g,"\n");var e="",f,h,l;f=0;for(h=c.length;f<h;f++){l=c.charCodeAt(f);if(l<128)e+=String.fromCharCode(l);else{if(l>127&&l<2048)e+=String.fromCharCode(l>>6|192);else{e+=String.fromCharCode(l>>12|224);e+=String.fromCharCode(l>>6&63|128)}e+=String.fromCharCode(l&63|128)}}return e},b=function(c){for(var e="",f=0,h=c1=c2=0;f<c.length;){h=c.charCodeAt(f);if(h<128){e+=String.fromCharCode(h);f++}else if(h>191&&h<224){c2=c.charCodeAt(f+1);e+=String.fromCharCode((h&
31)<<6|c2&63);f+=2}else{c2=c.charCodeAt(f+1);c3=c.charCodeAt(f+2);e+=String.fromCharCode((h&15)<<12|(c2&63)<<6|c3&63);f+=3}}return e};return{encode:function(c){var e="",f,h,l,o,n,p,y=0;for(c=a(c);y<c.length;){f=c.charCodeAt(y++);h=c.charCodeAt(y++);l=c.charCodeAt(y++);o=f>>2;f=(f&3)<<4|h>>4;n=(h&15)<<2|l>>6;p=l&63;if(isNaN(h))n=p=64;else if(isNaN(l))p=64;e=e+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(o)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(n)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(p)}return e},decode:function(c){var e="",f,h,l,o,n,p=0;for(c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");p<c.length;){f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(p++));h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(p++));o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(p++));
n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(p++));f=f<<2|h>>4;h=(h&15)<<4|o>>2;l=(o&3)<<6|n;e+=String.fromCharCode(f);if(o!=64)e+=String.fromCharCode(h);if(n!=64)e+=String.fromCharCode(l)}return e=b(e)}}}();Array.prototype.binarySearch=function(a,b,c){b||(b=function(o,n){return o==n?0:o<n?-1:1});for(var e=0,f=this.length-1,h,l;e<=f;){h=Math.floor((e+f)/2);l=b(this[h],a);if(l<0)e=h+1;else if(l>0)f=h-1;else return h}if(c)return e;return-1};Array.prototype.orderedInsert=function(a,b){b=this.binarySearch(a,b,true);this.splice(b,0,a);return b};Array.prototype.orderedDelete=function(a,b){a=this.binarySearch(a,b);a>=0&&this.splice(a,1);return a};var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(a){for(var b=0;b<a.length;b++){var c=a[b].string,e=a[b].prop;this.versionSearchString=a[b].versionSearch||a[b].identity;if(c){if(c.indexOf(a[b].subString)!=-1)return a[b].identity}else if(e)return a[b].identity}},
searchVersion:function(a){var b=a.indexOf(this.versionSearchString);if(b!=-1)return parseFloat(a.substring(b+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,
subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},
{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};CampaignAvatarPicker=function(a){var b=function(c){var e=(c.element().up("a")||c.element()).readAttribute("data-avatar-id"),f="/accounts/"+active_user.username()+"/pick_campaign_avatar";if(active_user.isAuthenticated())new Ajax.Request(f,{parameters:{campaign_avatar_id:e,authenticity_token:active_user.formAuthenticityToken()},onCreate:function(){var h=$$(a).first();h.insert({after:new Element("img",{src:"/images/presentation/indicator_barbershop.gif",id:"campaign-avatar-picker-indicator"})});h.hide()},
onSuccess:function(){window.location.reload()},onFailure:function(){alert("Sorry! We were unable to change your avatar. Please try again later.");$$(a).first().show();$("campaign-avatar-picker-indicator").remove()}});else active_user.activateInlineLogin({},true);c.preventDefault()};$$(a+" li a").each(function(c){c.observe("click",b)})};function onClickablePodClick(a){if("A"!=a.element().nodeName){a=a.element();if(a=a.hasClassName("js_clickable_pod")?a:a.up(".js_clickable_pod")){a=a.down(".js_clickable_pod_link");document.location=a.href}}}function observeClickablePods(){$$(".js_clickable_pod").each(function(a){a.observe("click",onClickablePodClick)})};if(Object.isUndefined(Effect))throw"dragdrop.js requires including script.aculo.us' effects.js library";
var Droppables={drops:[],remove:function(a){this.drops=this.drops.reject(function(b){return b.element==$(a)})},add:function(a,b){a=$(a);var c=Object.extend({greedy:true,hoverclass:null,tree:false},b||{});if(c.containment){c._containers=[];b=c.containment;Object.isArray(b)?b.each(function(e){c._containers.push($(e))}):c._containers.push($(b))}if(c.accept)c.accept=[c.accept].flatten();Element.makePositioned(a);c.element=a;this.drops.push(c)},findDeepestChild:function(a){deepest=a[0];for(i=1;i<a.length;++i)if(Element.isParent(a[i].element,
deepest.element))deepest=a[i];return deepest},isContained:function(a,b){var c;c=b.tree?a.treeNode:a.parentNode;return b._containers.detect(function(e){return c==e})},isAffected:function(a,b,c){return c.element!=b&&(!c._containers||this.isContained(b,c))&&(!c.accept||Element.classNames(b).detect(function(e){return c.accept.include(e)}))&&Position.within(c.element,a[0],a[1])},deactivate:function(a){a.hoverclass&&Element.removeClassName(a.element,a.hoverclass);this.last_active=null},activate:function(a){a.hoverclass&&
Element.addClassName(a.element,a.hoverclass);this.last_active=a},show:function(a,b){if(this.drops.length){var c,e=[];this.drops.each(function(f){Droppables.isAffected(a,b,f)&&e.push(f)});if(e.length>0)c=Droppables.findDeepestChild(e);this.last_active&&this.last_active!=c&&this.deactivate(this.last_active);if(c){Position.within(c.element,a[0],a[1]);c.onHover&&c.onHover(b,c.element,Position.overlap(c.overlap,c.element));c!=this.last_active&&Droppables.activate(c)}}},fire:function(a,b){if(this.last_active){Position.prepare();
if(this.isAffected([Event.pointerX(a),Event.pointerY(a)],b,this.last_active))if(this.last_active.onDrop){this.last_active.onDrop(b,this.last_active.element,a);return true}}},reset:function(){this.last_active&&this.deactivate(this.last_active)}},Draggables={drags:[],observers:[],register:function(a){if(this.drags.length==0){this.eventMouseUp=this.endDrag.bindAsEventListener(this);this.eventMouseMove=this.updateDrag.bindAsEventListener(this);this.eventKeypress=this.keyPress.bindAsEventListener(this);
Event.observe(document,"mouseup",this.eventMouseUp);Event.observe(document,"mousemove",this.eventMouseMove);Event.observe(document,"keypress",this.eventKeypress)}this.drags.push(a)},unregister:function(a){this.drags=this.drags.reject(function(b){return b==a});if(this.drags.length==0){Event.stopObserving(document,"mouseup",this.eventMouseUp);Event.stopObserving(document,"mousemove",this.eventMouseMove);Event.stopObserving(document,"keypress",this.eventKeypress)}},activate:function(a){if(a.options.delay)this._timeout=
setTimeout(function(){Draggables._timeout=null;window.focus();Draggables.activeDraggable=a}.bind(this),a.options.delay);else{window.focus();this.activeDraggable=a}},deactivate:function(){this.activeDraggable=null},updateDrag:function(a){if(this.activeDraggable){var b=[Event.pointerX(a),Event.pointerY(a)];if(!(this._lastPointer&&this._lastPointer.inspect()==b.inspect())){this._lastPointer=b;this.activeDraggable.updateDrag(a,b)}}},endDrag:function(a){if(this._timeout){clearTimeout(this._timeout);this._timeout=
null}if(this.activeDraggable){this._lastPointer=null;this.activeDraggable.endDrag(a);this.activeDraggable=null}},keyPress:function(a){this.activeDraggable&&this.activeDraggable.keyPress(a)},addObserver:function(a){this.observers.push(a);this._cacheObserverCallbacks()},removeObserver:function(a){this.observers=this.observers.reject(function(b){return b.element==a});this._cacheObserverCallbacks()},notify:function(a,b,c){this[a+"Count"]>0&&this.observers.each(function(e){e[a]&&e[a](a,b,c)});b.options[a]&&
b.options[a](b,c)},_cacheObserverCallbacks:function(){["onStart","onEnd","onDrag"].each(function(a){Draggables[a+"Count"]=Draggables.observers.select(function(b){return b[a]}).length})}},Draggable=Class.create({initialize:function(a,b){var c={handle:false,reverteffect:function(e,f,h){var l=Math.sqrt(Math.abs(f^2)+Math.abs(h^2))*0.02;new Effect.Move(e,{x:-h,y:-f,duration:l,queue:{scope:"_draggable",position:"end"}})},endeffect:function(e){var f=Object.isNumber(e._opacity)?e._opacity:1;new Effect.Opacity(e,
{duration:0.2,from:0.7,to:f,queue:{scope:"_draggable",position:"end"},afterFinish:function(){Draggable._dragging[e]=false}})},zindex:1E3,revert:false,quiet:false,scroll:false,scrollSensitivity:20,scrollSpeed:15,snap:false,delay:0};if(!b||Object.isUndefined(b.endeffect))Object.extend(c,{starteffect:function(e){e._opacity=Element.getOpacity(e);Draggable._dragging[e]=true;new Effect.Opacity(e,{duration:0.2,from:e._opacity,to:0.7})}});b=Object.extend(c,b||{});this.element=$(a);if(b.handle&&Object.isString(b.handle))this.handle=
this.element.down("."+b.handle,0);if(!this.handle)this.handle=$(b.handle);if(!this.handle)this.handle=this.element;if(b.scroll&&!b.scroll.scrollTo&&!b.scroll.outerHTML){b.scroll=$(b.scroll);this._isScrollChild=Element.childOf(this.element,b.scroll)}Element.makePositioned(this.element);this.options=b;this.dragging=false;this.eventMouseDown=this.initDrag.bindAsEventListener(this);Event.observe(this.handle,"mousedown",this.eventMouseDown);Draggables.register(this)},destroy:function(){Event.stopObserving(this.handle,
"mousedown",this.eventMouseDown);Draggables.unregister(this)},currentDelta:function(){return[parseInt(Element.getStyle(this.element,"left")||"0"),parseInt(Element.getStyle(this.element,"top")||"0")]},initDrag:function(a){if(!(!Object.isUndefined(Draggable._dragging[this.element])&&Draggable._dragging[this.element]))if(Event.isLeftClick(a))if(!((tag_name=Event.element(a).tagName.toUpperCase())&&(tag_name=="INPUT"||tag_name=="SELECT"||tag_name=="OPTION"||tag_name=="BUTTON"||tag_name=="TEXTAREA"))){var b=
[Event.pointerX(a),Event.pointerY(a)],c=Position.cumulativeOffset(this.element);this.offset=[0,1].map(function(e){return b[e]-c[e]});Draggables.activate(this);Event.stop(a)}},startDrag:function(a){this.dragging=true;if(!this.delta)this.delta=this.currentDelta();if(this.options.zindex){this.originalZ=parseInt(Element.getStyle(this.element,"z-index")||0);this.element.style.zIndex=this.options.zindex}if(this.options.ghosting){this._clone=this.element.cloneNode(true);(this._originallyAbsolute=this.element.getStyle("position")==
"absolute")||Position.absolutize(this.element);this.element.parentNode.insertBefore(this._clone,this.element)}if(this.options.scroll)if(this.options.scroll==window){var b=this._getWindowScroll(this.options.scroll);this.originalScrollLeft=b.left;this.originalScrollTop=b.top}else{this.originalScrollLeft=this.options.scroll.scrollLeft;this.originalScrollTop=this.options.scroll.scrollTop}Draggables.notify("onStart",this,a);this.options.starteffect&&this.options.starteffect(this.element)},updateDrag:function(a,
b){this.dragging||this.startDrag(a);if(!this.options.quiet){Position.prepare();Droppables.show(b,this.element)}Draggables.notify("onDrag",this,a);this.draw(b);this.options.change&&this.options.change(this);if(this.options.scroll){this.stopScrolling();var c;if(this.options.scroll==window)with(this._getWindowScroll(this.options.scroll))c=[left,top,left+width,top+height];else{c=Position.page(this.options.scroll);c[0]+=this.options.scroll.scrollLeft+Position.deltaX;c[1]+=this.options.scroll.scrollTop+
Position.deltaY;c.push(c[0]+this.options.scroll.offsetWidth);c.push(c[1]+this.options.scroll.offsetHeight)}var e=[0,0];if(b[0]<c[0]+this.options.scrollSensitivity)e[0]=b[0]-(c[0]+this.options.scrollSensitivity);if(b[1]<c[1]+this.options.scrollSensitivity)e[1]=b[1]-(c[1]+this.options.scrollSensitivity);if(b[0]>c[2]-this.options.scrollSensitivity)e[0]=b[0]-(c[2]-this.options.scrollSensitivity);if(b[1]>c[3]-this.options.scrollSensitivity)e[1]=b[1]-(c[3]-this.options.scrollSensitivity);this.startScrolling(e)}Prototype.Browser.WebKit&&
window.scrollBy(0,0);Event.stop(a)},finishDrag:function(a,b){this.dragging=false;if(this.options.quiet){Position.prepare();var c=[Event.pointerX(a),Event.pointerY(a)];Droppables.show(c,this.element)}if(this.options.ghosting){this._originallyAbsolute||Position.relativize(this.element);delete this._originallyAbsolute;Element.remove(this._clone);this._clone=null}c=false;if(b)(c=Droppables.fire(a,this.element))||(c=false);c&&this.options.onDropped&&this.options.onDropped(this.element);Draggables.notify("onEnd",
this,a);if((a=this.options.revert)&&Object.isFunction(a))a=a(this.element);b=this.currentDelta();if(a&&this.options.reverteffect){if(c==0||a!="failure")this.options.reverteffect(this.element,b[1]-this.delta[1],b[0]-this.delta[0])}else this.delta=b;if(this.options.zindex)this.element.style.zIndex=this.originalZ;this.options.endeffect&&this.options.endeffect(this.element);Draggables.deactivate(this);Droppables.reset()},keyPress:function(a){if(a.keyCode==Event.KEY_ESC){this.finishDrag(a,false);Event.stop(a)}},
endDrag:function(a){if(this.dragging){this.stopScrolling();this.finishDrag(a,true);Event.stop(a)}},draw:function(a){var b=Position.cumulativeOffset(this.element);if(this.options.ghosting){var c=Position.realOffset(this.element);b[0]+=c[0]-Position.deltaX;b[1]+=c[1]-Position.deltaY}c=this.currentDelta();b[0]-=c[0];b[1]-=c[1];if(this.options.scroll&&this.options.scroll!=window&&this._isScrollChild){b[0]-=this.options.scroll.scrollLeft-this.originalScrollLeft;b[1]-=this.options.scroll.scrollTop-this.originalScrollTop}c=
[0,1].map(function(f){return a[f]-b[f]-this.offset[f]}.bind(this));if(this.options.snap)c=Object.isFunction(this.options.snap)?this.options.snap(c[0],c[1],this):Object.isArray(this.options.snap)?c.map(function(f,h){return(f/this.options.snap[h]).round()*this.options.snap[h]}.bind(this)):c.map(function(f){return(f/this.options.snap).round()*this.options.snap}.bind(this));var e=this.element.style;if(!this.options.constraint||this.options.constraint=="horizontal")e.left=c[0]+"px";if(!this.options.constraint||
this.options.constraint=="vertical")e.top=c[1]+"px";if(e.visibility=="hidden")e.visibility=""},stopScrolling:function(){if(this.scrollInterval){clearInterval(this.scrollInterval);this.scrollInterval=null;Draggables._lastScrollPointer=null}},startScrolling:function(a){if(a[0]||a[1]){this.scrollSpeed=[a[0]*this.options.scrollSpeed,a[1]*this.options.scrollSpeed];this.lastScrolled=new Date;this.scrollInterval=setInterval(this.scroll.bind(this),10)}},scroll:function(){var a=new Date,b=a-this.lastScrolled;
this.lastScrolled=a;if(this.options.scroll==window)with(this._getWindowScroll(this.options.scroll)){if(this.scrollSpeed[0]||this.scrollSpeed[1]){a=b/1E3;this.options.scroll.scrollTo(left+a*this.scrollSpeed[0],top+a*this.scrollSpeed[1])}}else{this.options.scroll.scrollLeft+=this.scrollSpeed[0]*b/1E3;this.options.scroll.scrollTop+=this.scrollSpeed[1]*b/1E3}Position.prepare();Droppables.show(Draggables._lastPointer,this.element);Draggables.notify("onDrag",this);if(this._isScrollChild){Draggables._lastScrollPointer=
Draggables._lastScrollPointer||$A(Draggables._lastPointer);Draggables._lastScrollPointer[0]+=this.scrollSpeed[0]*b/1E3;Draggables._lastScrollPointer[1]+=this.scrollSpeed[1]*b/1E3;if(Draggables._lastScrollPointer[0]<0)Draggables._lastScrollPointer[0]=0;if(Draggables._lastScrollPointer[1]<0)Draggables._lastScrollPointer[1]=0;this.draw(Draggables._lastScrollPointer)}this.options.change&&this.options.change(this)},_getWindowScroll:function(a){var b,c,e;with(a.document){if(a.document.documentElement&&
documentElement.scrollTop){b=documentElement.scrollTop;c=documentElement.scrollLeft}else if(a.document.body){b=body.scrollTop;c=body.scrollLeft}if(a.innerWidth){e=a.innerWidth;a=a.innerHeight}else if(a.document.documentElement&&documentElement.clientWidth){e=documentElement.clientWidth;a=documentElement.clientHeight}else{e=body.offsetWidth;a=body.offsetHeight}}return{top:b,left:c,width:e,height:a}}});Draggable._dragging={};
var SortableObserver=Class.create({initialize:function(a,b){this.element=$(a);this.observer=b;this.lastValue=Sortable.serialize(this.element)},onStart:function(){this.lastValue=Sortable.serialize(this.element)},onEnd:function(){Sortable.unmark();this.lastValue!=Sortable.serialize(this.element)&&this.observer(this.element)}}),Sortable={SERIALIZE_RULE:/^[^_\-](?:[A-Za-z0-9\-\_]*)[_](.*)$/,sortables:{},_findRootElement:function(a){for(;a.tagName.toUpperCase()!="BODY";){if(a.id&&Sortable.sortables[a.id])return a;
a=a.parentNode}},options:function(a){if(a=Sortable._findRootElement($(a)))return Sortable.sortables[a.id]},destroy:function(a){a=$(a);if(a=Sortable.sortables[a.id]){Draggables.removeObserver(a.element);a.droppables.each(function(b){Droppables.remove(b)});a.draggables.invoke("destroy");delete Sortable.sortables[a.element.id]}},create:function(a,b){a=$(a);var c=Object.extend({element:a,tag:"li",dropOnEmpty:false,tree:false,treeTag:"ul",overlap:"vertical",constraint:"vertical",containment:a,handle:false,
only:false,delay:0,hoverclass:null,ghosting:false,quiet:false,scroll:false,scrollSensitivity:20,scrollSpeed:15,format:this.SERIALIZE_RULE,elements:false,handles:false,onChange:Prototype.emptyFunction,onUpdate:Prototype.emptyFunction},b||{});this.destroy(a);var e={revert:true,quiet:c.quiet,scroll:c.scroll,scrollSpeed:c.scrollSpeed,scrollSensitivity:c.scrollSensitivity,delay:c.delay,ghosting:c.ghosting,constraint:c.constraint,handle:c.handle};if(c.starteffect)e.starteffect=c.starteffect;if(c.reverteffect)e.reverteffect=
c.reverteffect;else if(c.ghosting)e.reverteffect=function(l){l.style.top=0;l.style.left=0};if(c.endeffect)e.endeffect=c.endeffect;if(c.zindex)e.zindex=c.zindex;var f={overlap:c.overlap,containment:c.containment,tree:c.tree,hoverclass:c.hoverclass,onHover:Sortable.onHover},h={onHover:Sortable.onEmptyHover,overlap:c.overlap,containment:c.containment,hoverclass:c.hoverclass};Element.cleanWhitespace(a);c.draggables=[];c.droppables=[];if(c.dropOnEmpty||c.tree){Droppables.add(a,h);c.droppables.push(a)}(c.elements||
this.findElements(a,c)||[]).each(function(l,o){o=c.handles?$(c.handles[o]):c.handle?$(l).select("."+c.handle)[0]:l;c.draggables.push(new Draggable(l,Object.extend(e,{handle:o})));Droppables.add(l,f);if(c.tree)l.treeNode=a;c.droppables.push(l)});if(c.tree)(Sortable.findTreeElements(a,c)||[]).each(function(l){Droppables.add(l,h);l.treeNode=a;c.droppables.push(l)});this.sortables[a.id]=c;Draggables.addObserver(new SortableObserver(a,c.onUpdate))},findElements:function(a,b){return Element.findChildren(a,
b.only,b.tree?true:false,b.tag)},findTreeElements:function(a,b){return Element.findChildren(a,b.only,b.tree?true:false,b.treeTag)},onHover:function(a,b,c){if(!Element.isParent(b,a))if(!(c>0.33&&c<0.66&&Sortable.options(b).tree))if(c>0.5){Sortable.mark(b,"before");if(b.previousSibling!=a){c=a.parentNode;a.style.visibility="hidden";b.parentNode.insertBefore(a,b);b.parentNode!=c&&Sortable.options(c).onChange(a);Sortable.options(b.parentNode).onChange(a)}}else{Sortable.mark(b,"after");var e=b.nextSibling||
null;if(e!=a){c=a.parentNode;a.style.visibility="hidden";b.parentNode.insertBefore(a,e);b.parentNode!=c&&Sortable.options(c).onChange(a);Sortable.options(b.parentNode).onChange(a)}}},onEmptyHover:function(a,b,c){var e=a.parentNode,f=Sortable.options(b);if(!Element.isParent(b,a)){var h=Sortable.findElements(b,{tag:f.tag,only:f.only}),l=null;if(h){var o=Element.offsetSize(b,f.overlap)*(1-c);for(c=0;c<h.length;c+=1)if(o-Element.offsetSize(h[c],f.overlap)>=0)o-=Element.offsetSize(h[c],f.overlap);else{l=
o-Element.offsetSize(h[c],f.overlap)/2>=0?c+1<h.length?h[c+1]:null:h[c];break}}b.insertBefore(a,l);Sortable.options(e).onChange(a);f.onChange(a)}},unmark:function(){Sortable._marker&&Sortable._marker.hide()},mark:function(a,b){var c=Sortable.options(a.parentNode);if(!(c&&!c.ghosting)){if(!Sortable._marker){Sortable._marker=($("dropmarker")||Element.extend(document.createElement("DIV"))).hide().addClassName("dropmarker").setStyle({position:"absolute"});document.getElementsByTagName("body").item(0).appendChild(Sortable._marker)}var e=
Position.cumulativeOffset(a);Sortable._marker.setStyle({left:e[0]+"px",top:e[1]+"px"});if(b=="after")c.overlap=="horizontal"?Sortable._marker.setStyle({left:e[0]+a.clientWidth+"px"}):Sortable._marker.setStyle({top:e[1]+a.clientHeight+"px"});Sortable._marker.show()}},_tree:function(a,b,c){for(var e=Sortable.findElements(a,b)||[],f=0;f<e.length;++f){var h=e[f].id.match(b.format);if(h){h={id:encodeURIComponent(h?h[1]:null),element:a,parent:c,children:[],position:c.children.length,container:$(e[f]).down(b.treeTag)};
h.container&&this._tree(h.container,b,h);c.children.push(h)}}return c},tree:function(a,b){a=$(a);var c=this.options(a);b=Object.extend({tag:c.tag,treeTag:c.treeTag,only:c.only,name:a.id,format:c.format},b||{});return Sortable._tree(a,b,{id:null,parent:null,children:[],container:a,position:0})},_constructIndex:function(a){var b="";do if(a.id)b="["+a.position+"]"+b;while((a=a.parent)!=null);return b},sequence:function(a,b){a=$(a);var c=Object.extend(this.options(a),b||{});return $(this.findElements(a,
c)||[]).map(function(e){return e.id.match(c.format)?e.id.match(c.format)[1]:""})},setSequence:function(a,b,c){a=$(a);var e=Object.extend(this.options(a),c||{}),f={};this.findElements(a,e).each(function(h){if(h.id.match(e.format))f[h.id.match(e.format)[1]]=[h,h.parentNode];h.parentNode.removeChild(h)});b.each(function(h){var l=f[h];if(l){l[1].appendChild(l[0]);delete f[h]}})},serialize:function(a,b){a=$(a);var c=Object.extend(Sortable.options(a),b||{}),e=encodeURIComponent(b&&b.name?b.name:a.id);return c.tree?
Sortable.tree(a,b).children.map(function(f){return[e+Sortable._constructIndex(f)+"[id]="+encodeURIComponent(f.id)].concat(f.children.map(arguments.callee))}).flatten().join("&"):Sortable.sequence(a,b).map(function(f){return e+"[]="+encodeURIComponent(f)}).join("&")}};Element.isParent=function(a,b){if(!a.parentNode||a==b)return false;if(a.parentNode==b)return true;return Element.isParent(a.parentNode,b)};
Element.findChildren=function(a,b,c,e){if(!a.hasChildNodes())return null;e=e.toUpperCase();if(b)b=[b].flatten();var f=[];$A(a.childNodes).each(function(h){if(h.tagName&&h.tagName.toUpperCase()==e&&(!b||Element.classNames(h).detect(function(l){return b.include(l)})))f.push(h);if(c)(h=Element.findChildren(h,b,c,e))&&f.push(h)});return f.length>0?f.flatten():[]};Element.offsetSize=function(a,b){return a["offset"+(b=="vertical"||b=="height"?"Height":"Width")]};DynamicFrameTarget=function(a){this.initialize(a)};
DynamicFrameTarget.prototype={initialize:function(a){this.name="dynamic_frame_"+ +new Date;this.frame=new Element("iframe",{name:this.name,id:this.name});$(document.body).insert(this.frame);this.frame.setStyle({display:"none"});a.form.target=this.name;var b=this,c=function(){var e;if(this.contentDocument)e=this.contentDocument;else if(this.contentWindow)e=this.contentWindow.document;else if(window.frames[this.name])e=window.frames[iframe.name].document;else if(b.frame.contentWindow.document)e=b.frame.contentWindow.document;
if(e&&e.body.innerHTML.length>0){e=e.body;e=String((e.childElementCount>0?e.children[0]:e).innerHTML).evalJSON();b.callback(e)}};if(this.frame.attachEvent)this.frame.attachEvent("onload",c);else this.frame.onload=c;this.callback=a.callback?a.callback:function(e){if(e.success)a.success&&a.success(e);else a.failure&&a.failure(e)}}};DynamicFrameTarget.subclasses=[];var DynamicScriptLoader=function(){return{load:function(a,b){(function(){var c=new Element("script",{src:a,type:"text/javascript"});$$("head")[0].insert(c)}).runWhenDomLoaded(b)}}}();var FacebookApiLoader=function(){function a(n){n.status==="connected"&&n.authResponse.userID==active_user.facebook_uid()&&c(n.authResponse)}function b(){FB.getLoginStatus(a)}function c(n){var p=(new Element("form",{action:"https://"+location.hostname+"/facebook_connection/update_auth_token",method:"post"})).setStyle({display:"none"});$(document.body).insert(p);p.insert(new Element("input",{type:"hidden",name:"access_token",value:n.accessToken}));p.insert(new Element("input",{type:"hidden",name:"expires",
value:n.expiresIn}));new DynamicFrameTarget({form:p});p.submit()}function e(n,p){var y=new Element("div",{id:"fb-root"}),m=new Element("script",{async:true,src:window.location.protocol+"//connect.facebook.net/en_US/all.js"});o.app_id=n;$$(".js_facebook_like_button").each(function(v){var A=active_user.valueOfSearchParameter,B=(Math.floor(A("km_generation"))||-1)+1,s=new Template(v.innerHTML),F=active_user.siteVisitorUID();v.replace(s.evaluate({url:Object.toQueryString({kme:"Followed fb_like",source:"fb_like",
km_orig_source:A("km_orig_source")||"fb_like",km_prev_source:A("km_source")||A("source"),km_orig_person:A("km_orig_person")||F,km_prev_person:F,km_generation:B})}))});window.fbAsyncInit=function(){FB.init({appId:n,status:true,cookie:true,xfbml:true,channelUrl:p,oauth:true});l=true;h.each(function(v){v()});active_user.facebookAccessTokenNeedsUpdate()&&b()};$$("head")[0].insert(y);y.insert(m)}function f(n){l?n():h.push(n)}var h=[],l=false,o;return o={populate:e,addApiLoadedCallback:f,updateLoginStatus:b}}();var facebook_api_timeout=5E3,FacebookApiWrapper=function(){function a(e,f){return function(h){if(c){clearTimeout(f);e(h)}}}function b(e){c=true;return setTimeout(function(){c=false;e&&e()},facebook_api_timeout)}var c;return{api:function(e,f,h){h=b(h);FB.api(e,a(f,h))}}}();var FacebookAuthenticator=function(a){a||(a={});if(active_user.isGamePage())a.game_id=active_user.gameId();if($("welcome_remember_me")&&$("welcome_remember_me").checked)a.remember_me=true;observePopup("https://"+location.hostname+"/auth/facebook?state="+encodeURIComponent($H(a).toQueryString()),"Log in with Facebook","menubar=no,toolbar=no,status=no,width=600,height=400",reenableFacebookButtons);disableFacebookButtons()};
$(document).observe("dom:loaded",function(){FacebookApiLoader.addApiLoadedCallback(function(){window.location.toString();!active_user.isAuthenticated()&&!Cookie.get("FacebookLoginAttempt")&&!active_user.isNativeAppUser()&&FB.getLoginStatus(function(a){a.status=="connected"&&new Ajax.Request("/facebook_connection/status",{method:"get",parameters:{uid:a.authResponse.userID},onSuccess:function(b){if(b.responseJSON.status=="linked"){Cookie.set("FacebookLoginAttempt",true);if(active_user.isGamePage()){b=
(new Element("form",{action:"/accounts/status",method:"get"})).setStyle({display:"none"});$(document.body).insert(b);new DynamicFrameTarget({form:b,success:function(c){setActiveUser(c)}});b.insert(new Element("input",{type:"hidden",name:"from_facebook",value:true}));b.insert(new Element("input",{type:"hidden",name:"game_id",value:active_user.gameId()}));b.insert(new Element("input",{type:"hidden",name:"authenticity_token",value:active_user.formAuthenticityToken()}));b.insert(new Element("input",{type:"hidden",
name:"existing_user",value:true}));b.submit()}else{lightbox.prototype.initializeKongregateLightboxFromContent('<div class="fb_oauth_content"><span class="med_fb_logo spritesite">Facebook</span><h1 class="mbl">Just a moment</h1><p class="regtextLrg">Signing you back into your Kongregate account&hellip; <br/>automatically!</p></div>',{done_class_name:"lightbox_login"});window.location.reload()}}}})})})});var FacebookFriendFinder=function(a){var b=this;FB.getLoginStatus(function(c){c.status==="connected"&&FB.api("me/friends",function(e){var f=$A(e.data).pluck("id");e&&new Ajax.Request("/facebook_connection/friends",{parameters:{"uid[]":f},onSuccess:function(h){b.friends=h.responseJSON;a(b)}})})},true)};
FacebookFriendFinder.prototype.clickFriend=function(a){if(a.hasClassName("selected")){a.removeClassName("selected");a.down("input").checked=false}else{a.addClassName("selected");a.down("input").checked=true}};
FacebookFriendFinder.prototype.displayFriendForm=function(a,b,c){var e=new Template('<h2 class="h2 phn bright">#{friend_count} of your Facebook Friends #{is_or_are} on Kongregate</h2><p class="intro regtext mbm">Kongregate is more fun with friends.</p><form id="facebook_friends_form" class="pan" action="#"><span class="mll spinner" style="display: none;" id="friend_finder_spinner">Loading...</span><div class="select_users"><ul id="facebook_friends_list" class="users medium_user"></ul></div><input class="btn btn_wide btn_action" id="friend_finder_button" type="submit" value="Connect with Friends" /><a id="facebook_friends_skip" class="mrm" href="#">Skip this step</a></form>'),f=
new Template('<li class="user medium_user clickable selected" onclick="FacebookFriendFinder.prototype.clickFriend(this)"><input type="checkbox" name="user_id[]" value="#{id}" class="mtm img" checked="checked" /><span class="check_mark spritesite"></span><img width="40" height="40" class="user_avatar" src="#{avatar_url}" /><span class="names"><strong class="sprite_facebook facebook_name first_name truncate_one_line">#{first_name} #{last_name}</strong><em class="second_name truncate_one_line">(<span class="spritesite levelbug level_#{level}">#{username}</span>)</em></span></li>'),
h,l,o;b.update(e.evaluate({friend_count:this.friends.length,is_or_are:this.friends.length==1?"is":"are"}));h=$("facebook_friends_form");l=$("facebook_friends_skip");o=$("facebook_friends_list");h.observe("submit",function(n){n.preventDefault();$("friend_finder_button").hide();l.hide();$("friend_finder_spinner").show();new Ajax.Request(a,{parameters:h.serialize(),onSuccess:function(){c()},onFailure:function(){alert("There was an error while trying to create your new friends.");$("friend_finder_spinner").hide();
l.show();$("friend_finder_button").show()}})});l.observe("click",c);this.friends.each(function(n){n=$H(n).inject({},function(p,y){p[y[0]]=Object.isString(y[1])?y[1].escapeHTML():y[1];return p});o.insert(f.evaluate(n))})};var FacebookWidgetLoader={load:function(){var a=new Template('<iframe src="http://www.facebook.com/plugins/#{widget_type}.php?site=kongregate.com&amp;width=297&amp;height=350&amp;header=true&amp;colorscheme=light scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:297px; height:350px"></iframe>'),b=Cookie.get("kong_fbwn"),c=location.search.parseQuery();if(c.fb_widget&&("recommendations"==c.fb_widget||"activity"==c.fb_widget))b=c.fb_widget;if(b&&"news_section"!=
b){$("facebook_content_holder").update(a.evaluate({widget_type:b}));$("facebook_content_holder").show()}else $("kongregate_announcements").show()}};FeedHandler=Class.create({_feedType:"self",_feedContainerName:"feed_items_container",_feedContainer:null,_feedItemIds:[],_offset:0,_pageSize:20,_morePath:null,_destroyPath:null,_blinking:false,initialize:function(a,b,c,e,f){this._feedType=a;this._feedContainerName=b;this._pageSize=c;this._morePath=e;this._destroyPath=f;this._self_disabling={};$(document).observe("click",this.clickHandler.bindAsEventListener(this))},setOffset:function(a){this._offset=a},addFeedItemIds:function(a){this._feedItemIds=
this._feedItemIds.concat(a||[])},updateFeedInfo:function(a,b){this.setOffset(a);this.addFeedItemIds(b);this.setFirstFeedItemClass()},container:function(){if(!this._feedContainer)this._feedContainer=$(this._feedContainerName);return this._feedContainer},indicator:function(){return this.container().select("#more_feed_items_indicator").first()},showMoreElement:function(){return this.container().select("#show_more_feed_items_label").first()},automaticallyFetchMore:function(){if(this._morePath.match(/mini_feed_items/)!=
null)$$(".mini_item").length<15&&this.requestNextPage();else $$(".feed_item").length<15&&this.requestNextPage()},setFirstFeedItemClass:function(){this.container().select(".first_feed_item").each(function(b){b.removeClassName("first_feed_item")});var a=this.container().select(".feed_item").first();a&&a.addClassName("first_feed_item")},insertMoreShoutComments:function(a){var b=a.message_id;if(a.new_url){$("show_more_comments_link_"+b).href=a.new_url;$("show_more_comments_link_"+b).show()}else $("show_more_comments_link_"+
b).hide();$("shout_indicator_"+b).hide();$("shout_short_comments_"+b).hide();$("shout_more_comments_"+b).insert({top:a.content})},requestNextPage:function(){var a=this.indicator(),b=this;if(!(!a||a.visible())){a.show();this.showMoreElement().hide();new Ajax.Request(this._morePath,{parameters:{feed_type:this._feedType,offset:this._offset,num:this._pageSize,excluded_ids:this._feedItemIds.join(","),excluded_followed_users:$$(".js_followed_username").map(function(c){return c.innerHTML}).uniq().join(","),
excluded_forum_users:$$(".js_forum_post_user").map(function(c){return c.innerHTML}).uniq().join(",")},method:"get",onSuccess:function(c){b.container().select("#additional_feed_items").first().remove();b.container().insert(c.responseText);b.setFirstFeedItemClass()},onFailure:function(){b.indicator().hide();b.showMoreElement().show()}})}},requestNextPageIfMoreItemsNeeded:function(){this.container().getHeight()<1500&&this.requestNextPage()},removeFeedItems:function(a){if(!(!(a instanceof Array)||a.length<=
0)){new Effect.DropOut("feed_item_"+a[0]);new Ajax.Request(this._destroyPath,{method:"post",parameters:{ids:a.join(","),context:this._feedType},onSuccess:function(){},onFailure:function(){}})}},unfollowUser:function(a,b){new Effect.DropOut("feed_item_"+b[0]);new Ajax.Request("/accounts/"+active_user.username()+"/friends/"+a+".json",{method:"put",parameters:{unfriend_from:"feed"},onSuccess:function(){},onFailure:function(){}})},blockGame:function(a,b,c){new Effect.DropOut("feed_item_"+c);new Ajax.Request("/games/"+
b+"/"+a+"/blocks",{method:"post",parameters:{user_game_permissions:{allow_something:false}},onSuccess:function(){},onFailure:function(){}})},isMiniFeed:function(){return this._morePath.match(/mini_feed_items/)!=null},feedItemElement:function(a){return this.isMiniFeed()?$("mini_item_"+a):$("feed_item_"+a)},observeUnlike:function(a){a=this.feedItemElement(a).down(".like_link");if(a!=null){a.observe("mouseenter",function(){this.down(".like_text").update("Unlike")});a.observe("mouseleave",function(){this.down(".like_text").update("Liked")})}},
likeFeedItem:function(a){var b=this;if(this._self_disabling[a]==null){this._self_disabling[a]=true;new Ajax.Request("/user_likes",{method:"post",parameters:{feed_item_id:a},onSuccess:function(c){if(b.isMiniFeed()){var e=$("mini_item_"+a);e.down(".like_link").removeClassName("feed_like");e.down(".like_link").addClassName("feed_unlike")}else{e=$("feed_item_"+a);e.down(".like_text").update("Liked")}e.down(".like_link").onclick=function(){feedHandler.unlikeFeedItem(a);return false};b._self_disabling[a]=
null;b.observeUnlike(a);e.down(".like_count").update("("+c.responseJSON.count+")")},onFailure:function(){b._self_disabling[a]=null}})}},unlikeFeedItem:function(a){var b=this;if(this._self_disabling[a]==null){this._self_disabling[a]=true;new Ajax.Request("/user_likes",{method:"delete",parameters:{feed_item_id:a},onSuccess:function(c){var e=b.isMiniFeed()?$("mini_item_"+a):$("feed_item_"+a);e.down(".like_link").onclick=function(){feedHandler.likeFeedItem(a);return false};b._self_disabling[a]=null;e.down(".like_text").update("Like");
e.down(".like_link").stopObserving("mouseenter");e.down(".like_link").stopObserving("mouseleave");if(b.isMiniFeed()){e.down(".like_link").removeClassName("feed_unlike");e.down(".like_link").addClassName("feed_like")}else e.down(".like_count").update("("+c.responseJSON.count+")")},onFailure:function(){b._self_disabling[a]=null}})}},clickHandler:function(a){var b=a.element();if(this.isMiniFeed()){if(a=b.hasClassName("mini_item")?b:b.up(".mini_item"))if(a=a.id.sub("mini_item_","")){b=(b=Cookie.get("feed_item_clicks"))?
b.evalJSON():{};b.mini=b.mini||[];b.mini=b.mini.concat([a]);Cookie.set("feed_item_clicks",Object.toJSON(b))}}else if(a=b.hasClassName("feed_item")?b:b.up(".feed_item")){var c=b.up("a");if("A"==b.nodeName||c){b="A"==b.nodeName?b.href:c.href;a=a.id.sub("feed_item_","");if(b&&!b.match(/#$/)){b=(b=Cookie.get("feed_item_clicks"))?b.evalJSON():{};b[this._feedType]=b[this._feedType]||[];b[this._feedType]=b[this._feedType].concat([a]);Cookie.set("feed_item_clicks",Object.toJSON(b))}}}}});FileField=function(a,b){function c(e){var f=e.pointerX();e=e.pointerY();var h=b.getOffsetParent().viewportOffset();b.setOpacity(0);if(!this.containerPositon)this.containerPositon=a.getBoundingClientRect();if(e>=this.containerPositon.top&&e<this.containerPositon.bottom&&f>=this.containerPositon.left&&f<this.containerPositon.right){b.style.left=f-this.containerPositon.left+30-b.getWidth()+"px";b.style.top=e-h[1]-10+"px"}else{b.style.left=0;b.style.top=0}}a.observe("mousemove",c.bind(this))};function FlashMessages(a){this.initialize(a)}FlashMessages.DISPLAY_TEMPLATE=new Template('<div class="sitemessage"><h2>#{message}</h2></div>');FlashMessages.COOKIE_NAME="kong_flash_messages";
FlashMessages.prototype={initialize:function(){this._data={};if(Cookie.accept()){this._messages_node=$("global");this._insertMessages()}},data:function(){this._getDataFromCookie();return this._data},_getDataFromCookie:function(){var a=Cookie.get(FlashMessages.COOKIE_NAME);if(a){a=a.evalJSON();if(this._data)Object.extend(this._data,a);else this._data=a}this._clearCookie()},_insertMessages:function(){var a=this.data().messages;if(this._messages_node&&a)this._messages_node.innerHTML=a.map(function(b){return FlashMessages.DISPLAY_TEMPLATE.evaluate({message:b})}).join()},
_clearCookie:function(){Cookie.erase(FlashMessages.COOKIE_NAME,"/")}};function FollowToggleButton(a){this.initialize(a)}FollowToggleButton.prototype={initialize:function(a){this._indicatorTag=a},mouseOver:function(a){a=Event.findElement(a);a.removeClassName("btn_alt");a.update("Unfriend")},mouseOut:function(a){a=Event.findElement(a);a.addClassName("btn_alt");a.update("Friend")},toggle:function(a){a=Event.findElement(a);a.update(this._indicatorTag);a.onmouseover="";a.onmouseout=""}};FormRow=Class.create({initialize:function(a,b,c,e,f){this._formCallback=f;this._tr=new Element("tr");this._tr.appendChild(this._createFieldNameColumn(a,b));this._tr.appendChild(this._createInputColumn(b,c,e));this._helpColumn=this._createHelpColumn(b);this._tr.appendChild(this._helpColumn);this._focusHandlers=[];this.getInputElements().each(function(h){h.onfocus=this._callAllOnFocusHandlers.bind(this);h.onblur=this._callAllOnBlurHandlers.bind(this)}.bind(this));this._hasValidInput=false;this._setInputValidityTrue=
function(){this.setInputValidity(true)}.bind(this);this._setInputValidityFalse=function(){this.setInputValidity(false)}.bind(this)},hasValidInput:function(){return this._hasValidInput},setInputValidity:function(a){this._hasValidInput=a;this._formCallback()},_callAllOnFocusHandlers:function(){for(var a=0;a<this._focusHandlers.length;a++)if(this._focusHandlers[a].onFocus())break},_callAllOnBlurHandlers:function(){for(var a=0;a<this._focusHandlers.length;a++)if(this._focusHandlers[a].onBlur())break},
getElement:function(){return this._tr},getInputElements:function(){return[this.getColumn(1).childNodes[0]]},getInputValue:function(){return this.getColumn(1).childNodes[0].value},getHelpElement:function(){return this.getColumn(2)},getColumn:function(a){return this._tr.childNodes[a]},addFocusHandler:function(a){this._focusHandlers.push(a)},focusHandlerCount:function(){return this._focusHandlers.length},_createFieldNameColumn:function(a,b){var c=new Element("td");c.innerHTML='<label for="credit_card_transaction_'+
b+'">'+a+"</label>";c.className="purchase_label";return c},_createInputColumn:function(a,b,c){var e=new Element("td");e.className="purchase_input";this._inputElement=new Element("input");this._inputElement.id="credit_card_transaction_"+a;this._inputElement.name="transaction["+b+"]["+a+"]";this._inputElement.size=30;this._inputElement.value=c?c:"";e.appendChild(this._inputElement);return e},_createHelpColumn:function(a){var b=new Element("td");b.id=a+"_help";return b}});
FormNonEmptyRow=Class.create(FormRow,{initialize:function($super,b,c,e,f,h,l,o){$super(b,c,e,h,l);o&&this.getInputElements().each(function(n){n.onkeyup=function(){this.getInputValue()!=""&&this._callAllOnBlurHandlers()}.bind(this)}.bind(this));this.addFocusHandler(new NonEmptyInputFocusHandler(this,"can't be blank",this._setInputValidityFalse));this._validInputCallbackFocusHandler=new ValidInputCallbackFocusHandler(this,this._setInputValidityTrue);this.addFocusHandler(this._validInputCallbackFocusHandler);
this.addFocusHandler(new HelpTextFocusHandler(this,f))}});FormCanBeEmptyRow=Class.create(FormRow,{initialize:function($super,b,c,e,f,h,l){$super(b,c,e,h,l);this._hasValidInput=true;this.addFocusHandler(new HelpTextFocusHandler(this,f))}});
FormCreditCardNumberRow=Class.create(FormRow,{initialize:function($super,b,c,e,f,h,l){$super(b,c,e,f,h);this.addFocusHandler(new NonEmptyInputFocusHandler(this,"can't be blank",this._setInputValidityFalse));this._ccNumberFocusHandler=new CreditCardValidationFocusHandler(this,"invalid account number",this._setInputValidityFalse);this.addFocusHandler(this._ccNumberFocusHandler);this._validInputCallbackFocusHandler=new ValidInputCallbackFocusHandler(this,l,this._setInputValidityFalse);this.addFocusHandler(this._validInputCallbackFocusHandler);
this._validInputCallbackFocusHandler=new ValidInputCallbackFocusHandler(this,this._setInputValidityTrue);this.addFocusHandler(this._validInputCallbackFocusHandler);b=new Element("img");b.src="/images/creditcard_marks.png";this._helpCreditCardFocusHandler=new HelpCreditCardFocusHandler(this,b);this.addFocusHandler(this._helpCreditCardFocusHandler)},getCreditCardType:function(){return this._ccNumberFocusHandler.getCreditCardType()},getInputValue:function(){return this.getColumn(1).childNodes[0].value.replace(/\s+/g,
"")}});
FormCvvRow=Class.create(FormRow,{initialize:function($super,b,c,e,f,h){$super(b,c,e,f,h);this.addFocusHandler(new NonEmptyInputFocusHandler(this,"can't be blank",this._setInputValidityFalse));this._cvvValidationFocusHandler=new CvvValidationFocusHandler(this,this._setInputValidityFalse);this.addFocusHandler(this._cvvValidationFocusHandler);this._validInputCallbackFocusHandler=new ValidInputCallbackFocusHandler(this,this._setInputValidityTrue);this.addFocusHandler(this._validInputCallbackFocusHandler);this._helpTextFocusHandler=
new HelpTextFocusHandler(this,"");this.addFocusHandler(this._helpTextFocusHandler)},setCreditCardType:function(a){this._cvvValidationFocusHandler.setCreditCardType(a);var b="";b=a=="american_express"?"Please enter the four digit code that's printed on the front of your card, just to the right of the account number.":"Please enter the last three digits printed on the signature line on the back side of your card.";this._helpTextFocusHandler.setText(b)}});
FormExpirationDateRow=Class.create(FormRow,{initialize:function($super,b,c,e,f,h,l,o,n){this._formCallback=n;this._monthHTML=f;this._yearHTML=h;this._defaultMonth=l;this._defaultYear=o;$super(b,c+"cc_month",e,"",n);this.addFocusHandler(new CompleteDateValidationFocusHandler(this,"month &amp; year are required",this._setInputValidityFalse));this.addFocusHandler(new FutureDateValidationFocusHandler(this,"date must be in the future",this._setInputValidityFalse));this._validInputCallbackFocusHandler=
new ValidInputCallbackFocusHandler(this,this._setInputValidityTrue);this.addFocusHandler(this._validInputCallbackFocusHandler);this.addFocusHandler(new HelpTextFocusHandler(this,""))},_createInputColumn:function(){var a=new Element("td");a.addClassName("purchase_input");Element.insert(a,this._monthHTML);a.childNodes[0].value=this._defaultMonth;Element.insert(a,this._yearHTML);a.childNodes[1].value=this._defaultYear;return a},getInputElements:function(){return[this.getColumn(1).childNodes[0],this.getColumn(1).childNodes[1]]},
getInputValue:function(){return this.getColumn(1).childNodes[0].value+"/"+this.getColumn(1).childNodes[1].value},setMonthInput:function(a){this.getColumn(1).childNodes[0].selectedIndex=a},setYearInput:function(a){this.getColumn(1).childNodes[1].selectedIndex=a}});function evalJS(a){eval(a)}function updateTaskProgress(a,b){try{$(a+"-progress-amount").update(b)}catch(c){console.warn("error during updateTaskProgress on %s to %s",a,b)}}function markTaskComplete(a){try{Element.addClassName(a,"complete");Element.removeClassName(a,"incomplete");$(a+"-progress")&&Element.hide(a+"-progress");new Effect.Highlight(a,{})}catch(b){console.warn("error during markTaskComplete on %s",a)}}
function markAccomplishmentComplete(a){try{Element.addClassName(a,"complete");Element.removeClassName(a,"incomplete");new Effect.Highlight(a,{})}catch(b){console.warn("error during markAccomplishmentComplete on %s",a)}};var GameBrowser={highlightCurrentSidebarItem:function(a){(a=$("browser-sidebar-"+a))&&a.addClassName("active")},updateTagSidebarItem:function(a,b){if(a&&b){$("browser-sidebar-tag-games-link").href=b;$("browser-sidebar-tag-games-link").update(a);$("browser-sidebar-tag-games").addClassName("active");$("browser-sidebar-tag-games").show()}}};var GameMetricsUpdater=function(){return{update:function(){new Ajax.Request(active_user.gameResourcePath()+"/metrics.json",{method:"get",onSuccess:function(a){a=a.responseJSON;[[".favorites_count",a.favorites_count_with_delimiter],[".gameplays_count",a.gameplays_count_with_delimiter],[".average_rating",a.average_rating_text],[".average_rating_with_count",a.average_rating_with_count],["#rating_message",a.rating_message],["#below_game_rating_message",a.below_game_rating_message],["#star_ratings_block",
a.user_rating],["#below_game_star_ratings_block",a.below_game_user_rating],["#quicklinks_star_ratings_block",a.quicklinks_user_rating],[".flag_game",a.flagged],["#favorite_game",a.favorite_message],["#below_game_favorite_game",a.below_game_favorite_message],["#quicklinks_favorite_block",a.quicklinks_favorite_message],["#user_donation_holder",a.last_tip_message],["#combined_favorites_js",a.combined_favorites_js],["#game_block",a.block_game_js]].each(function(b){var c=b[0],e=b[1];e&&$$(c).each(function(f){f.update(e)})})},
onFailure:function(a){console.error("Error loading game metrics: %o",a.responseText)}})}}}();function ImageSwitcher(a){this.initialize(a)}
ImageSwitcher.prototype={initialize:function(a){var b=this;this._image_ids=a.image_ids;this._current_image=this._image_ids.first();this._current_text=this.makeTextId(this._current_image);document.observe("dom:loaded",function(){b._image_ids.each(function(c){$(b.makeTextId(c)).observe("mouseover",b.switchFunction(c))})})},switchFunction:function(a){var b=this;return function(){$(b._current_image).hide();$(b._current_text).removeClassName("selected");b._current_image=a;b._current_text=b.makeTextId(a);
$(b._current_image).show();$(b._current_text).addClassName("selected")}},makeTextId:function(a){return a+"Text"}};function showTrailerPopup(a){window.open(a,"","width=520,height=400,status=no,resizable=no,scrollbars=no")};InteractiveHover=Class.create(Control.Window,{initialize:function($super,b,c){var e;$super(b,c);b=function(f){this.open(f);if(e!=null){clearTimeout(e);e=null}}.bind(this);c=function(f){e=setTimeout(function(){this.close(f)}.bind(this),1E3)}.bind(this);this.sourceContainer.observe("mouseenter",b);this.container.observe("mouseenter",b);this.sourceContainer.observe("mouseleave",c);this.container.observe("mouseleave",c)}});(function(a){function b(){var s=false;if("localStorage"in window)try{window.localStorage.setItem("_tmptest","tmpval");s=true;window.localStorage.removeItem("_tmptest")}catch(F){}if(s)try{if(window.localStorage){o=window.localStorage;v="localStorage"}}catch(g){}else if("globalStorage"in window)try{if(window.globalStorage){o=window.globalStorage[window.location.hostname];v="globalStorage"}}catch(j){}else{n=document.createElement("link");if(n.addBehavior){n.style.behavior="url(#default#userData)";document.getElementsByTagName("head")[0].appendChild(n);
n.load("jStorage");s="{}";try{s=n.getAttribute("jStorage")}catch(q){}o.jStorage=s;v="userDataBehavior"}else{n=null;return}}c();h()}function c(){if(o.jStorage)try{l=m(String(o.jStorage))}catch(s){o.jStorage="{}"}else o.jStorage="{}";p=o.jStorage?String(o.jStorage).length:0}function e(){try{o.jStorage=y(l);if(n){n.setAttribute("jStorage",o.jStorage);n.save("jStorage")}p=o.jStorage?String(o.jStorage).length:0}catch(s){}}function f(s){if(!s||typeof s!="string"&&typeof s!="number")throw new TypeError("Key name must be string or numeric");
if(s=="__jstorage_meta")throw new TypeError("Reserved key name");return true}function h(){var s,F,g,j=Infinity,q=false;clearTimeout(A);if(!(!l.__jstorage_meta||typeof l.__jstorage_meta.TTL!="object")){s=+new Date;g=l.__jstorage_meta.TTL;for(F in g)if(g.hasOwnProperty(F))if(g[F]<=s){delete g[F];delete l[F];q=true}else if(g[F]<j)j=g[F];if(j!=Infinity)A=setTimeout(h,j-s);q&&e()}}if(!a||!(a.toJSON||Object.toJSON||window.JSON))throw new Error("jQuery, MooTools or Prototype needs to be loaded before jStorage!");
var l={},o={jStorage:"{}"},n=null,p=0,y=a.toJSON||Object.toJSON||window.JSON&&(JSON.encode||JSON.stringify),m=a.evalJSON||window.JSON&&(JSON.decode||JSON.parse)||function(s){return String(s).evalJSON()},v=false,A,B={isXML:function(s){return(s=(s?s.ownerDocument||s:0).documentElement)?s.nodeName!=="HTML":false},encode:function(s){if(!this.isXML(s))return false;try{return(new XMLSerializer).serializeToString(s)}catch(F){try{return s.xml}catch(g){}}return false},decode:function(s){var F="DOMParser"in
window&&(new DOMParser).parseFromString||window.ActiveXObject&&function(g){var j=new ActiveXObject("Microsoft.XMLDOM");j.async="false";j.loadXML(g);return j};if(!F)return false;s=F.call("DOMParser"in window&&new DOMParser||window,s,"text/xml");return this.isXML(s)?s:false}};a.jStorage={version:"0.1.7.0",set:function(s,F,g){f(s);g=g||{};if(B.isXML(F))F={_is_xml:true,xml:B.encode(F)};else if(typeof F=="function")F=null;else if(F&&typeof F=="object")F=m(y(F));l[s]=F;isNaN(g.TTL)?e():this.setTTL(s,g.TTL);
return F},get:function(s,F){f(s);if(s in l)return l[s]&&typeof l[s]=="object"&&l[s]._is_xml&&l[s]._is_xml?B.decode(l[s].xml):l[s];return typeof F=="undefined"?null:F},deleteKey:function(s){f(s);if(s in l){delete l[s];l.__jstorage_meta&&typeof l.__jstorage_meta.TTL=="object"&&s in l.__jstorage_meta.TTL&&delete l.__jstorage_meta.TTL[s];e();return true}return false},setTTL:function(s,F){var g=+new Date;f(s);F=Number(F)||0;if(s in l){if(!l.__jstorage_meta)l.__jstorage_meta={};if(!l.__jstorage_meta.TTL)l.__jstorage_meta.TTL=
{};if(F>0)l.__jstorage_meta.TTL[s]=g+F;else delete l.__jstorage_meta.TTL[s];e();h();return true}return false},flush:function(){l={};e();return true},storageObj:function(){function s(){}s.prototype=l;return new s},index:function(){var s=[],F;for(F in l)l.hasOwnProperty(F)&&F!="__jstorage_meta"&&s.push(F);return s},storageSize:function(){return p},currentBackend:function(){return v},storageAvailable:function(){return!!v},reInit:function(){var s;if(n&&n.addBehavior){s=document.createElement("link");
n.parentNode.replaceChild(s,n);n=s;n.style.behavior="url(#default#userData)";document.getElementsByTagName("head")[0].appendChild(n);n.load("jStorage");s="{}";try{s=n.getAttribute("jStorage")}catch(F){}o.jStorage=s;v="userDataBehavior"}c()}};b()})($||window.jQuery);if(typeof jwplayer=="undefined"){var jwplayer=function(a){if(jwplayer.api)return jwplayer.api.selectPlayer(a)},$jw=jwplayer;jwplayer.version="5.10.2295 (Licensed version)";jwplayer.vid=document.createElement("video");jwplayer.audio=document.createElement("audio");jwplayer.source=document.createElement("source");(function(a){function b(c){if(a.utils.exists(c)){var e=c.indexOf("://");c=c.indexOf("?");return e>0&&(c<0||c>e)}}a.utils=function(){};a.utils.typeOf=function(c){var e=typeof c;if(e==="object")if(c){if(c instanceof
Array)e="array"}else e="null";return e};a.utils.extend=function(){var c=a.utils.extend.arguments;if(c.length>1){for(var e=1;e<c.length;e++)for(var f in c[e])c[0][f]=c[e][f];return c[0]}return null};a.utils.clone=function(){var c,e=a.utils.clone.arguments;if(e.length==1)switch(a.utils.typeOf(e[0])){case "object":c={};for(var f in e[0])c[f]=a.utils.clone(e[0][f]);break;case "array":c=[];for(f in e[0])c[f]=a.utils.clone(e[0][f]);break;default:return e[0]}return c};a.utils.extension=function(c){if(!c)return"";
c=c.substring(c.lastIndexOf("/")+1,c.length);c=c.split("?")[0];if(c.lastIndexOf(".")>-1)return c.substr(c.lastIndexOf(".")+1,c.length).toLowerCase()};a.utils.html=function(c,e){c.innerHTML=e};a.utils.wrap=function(c,e){c.parentNode&&c.parentNode.replaceChild(e,c);e.appendChild(c)};a.utils.ajax=function(c,e,f){var h;h=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");h.onreadystatechange=function(){if(h.readyState===4)if(h.status===200){if(e){if(!a.utils.exists(h.responseXML))try{if(window.DOMParser){var o=
(new DOMParser).parseFromString(h.responseText,"text/xml");if(o)h=a.utils.extend({},h,{responseXML:o})}else{o=new ActiveXObject("Microsoft.XMLDOM");o.async="false";o.loadXML(h.responseText);h=a.utils.extend({},h,{responseXML:o})}}catch(n){f&&f(c)}e(h)}}else f&&f(c)};try{h.open("GET",c,true);h.send(null)}catch(l){f&&f(c)}return h};a.utils.load=function(c,e,f){c.onreadystatechange=function(){if(c.readyState===4)if(c.status===200)e&&e();else f&&f()}};a.utils.find=function(c,e){return c.getElementsByTagName(e)};
a.utils.append=function(c,e){c.appendChild(e)};a.utils.isIE=function(){return!+"\u000b1"||typeof window.ActiveXObject!="undefined"};a.utils.userAgentMatch=function(c){return navigator.userAgent.toLowerCase().match(c)!==null};a.utils.isIOS=function(){return a.utils.userAgentMatch(/iP(hone|ad|od)/i)};a.utils.isIPad=function(){return a.utils.userAgentMatch(/iPad/i)};a.utils.isIPod=function(){return a.utils.userAgentMatch(/iP(hone|od)/i)};a.utils.isAndroid=function(){return a.utils.userAgentMatch(/android/i)};
a.utils.isLegacyAndroid=function(){return a.utils.userAgentMatch(/android 2.[012]/i)};a.utils.isBlackberry=function(){return a.utils.userAgentMatch(/blackberry/i)};a.utils.isMobile=function(){return a.utils.userAgentMatch(/(iP(hone|ad|od))|android/i)};a.utils.getFirstPlaylistItemFromConfig=function(c){var e={};c=c.playlist&&c.playlist.length?c.playlist[0]:c;e.file=c.file;e.levels=c.levels;e.streamer=c.streamer;e.playlistfile=c.playlistfile;e.provider=c.provider;if(!e.provider){if(e.file&&(e.file.toLowerCase().indexOf("youtube.com")>
-1||e.file.toLowerCase().indexOf("youtu.be")>-1))e.provider="youtube";if(e.streamer&&e.streamer.toLowerCase().indexOf("rtmp://")==0)e.provider="rtmp";if(c.type)e.provider=c.type.toLowerCase()}if(e.provider=="audio")e.provider="sound";return e};a.utils.getOuterHTML=function(c){if(c.outerHTML)return c.outerHTML;else try{return(new XMLSerializer).serializeToString(c)}catch(e){return""}};a.utils.setOuterHTML=function(c,e){if(c.outerHTML)c.outerHTML=e;else{var f=document.createElement("div");f.innerHTML=
e;e=document.createRange();e.selectNodeContents(f);f=e.extractContents();c.parentNode.insertBefore(f,c);c.parentNode.removeChild(c)}};a.utils.hasFlash=function(){if(typeof navigator.plugins!="undefined"&&typeof navigator.plugins["Shockwave Flash"]!="undefined")return true;if(typeof window.ActiveXObject!="undefined")try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash");return true}catch(c){}return false};a.utils.getPluginName=function(c){if(c.lastIndexOf("/")>=0)c=c.substring(c.lastIndexOf("/")+1,
c.length);if(c.lastIndexOf("-")>=0)c=c.substring(0,c.lastIndexOf("-"));if(c.lastIndexOf(".swf")>=0)c=c.substring(0,c.lastIndexOf(".swf"));if(c.lastIndexOf(".js")>=0)c=c.substring(0,c.lastIndexOf(".js"));return c};a.utils.getPluginVersion=function(c){if(c.lastIndexOf("-")>=0)return c.lastIndexOf(".js")>=0?c.substring(c.lastIndexOf("-")+1,c.lastIndexOf(".js")):c.lastIndexOf(".swf")>=0?c.substring(c.lastIndexOf("-")+1,c.lastIndexOf(".swf")):c.substring(c.lastIndexOf("-")+1);return""};a.utils.getAbsolutePath=
function(c,e){if(!a.utils.exists(e))e=document.location.href;if(a.utils.exists(c)){if(b(c))return c;var f=e.substring(0,e.indexOf("://")+3),h=e.substring(f.length,e.indexOf("/",f.length+1));if(c.indexOf("/")===0)c=c.split("/");else{e=e.split("?")[0];e=e.substring(f.length+h.length+1,e.lastIndexOf("/"));c=e.split("/").concat(c.split("/"))}e=[];for(var l=0;l<c.length;l++)!c[l]||!a.utils.exists(c[l])||c[l]=="."||(c[l]==".."?e.pop():e.push(c[l]));return f+h+"/"+e.join("/")}};a.utils.pluginPathType={ABSOLUTE:"ABSOLUTE",
RELATIVE:"RELATIVE",CDN:"CDN"};a.utils.getPluginPathType=function(c){if(typeof c=="string"){c=c.split("?")[0];var e=c.indexOf("://");if(e>0)return a.utils.pluginPathType.ABSOLUTE;var f=c.indexOf("/");c=a.utils.extension(c);if(e<0&&f<0&&(!c||!isNaN(c)))return a.utils.pluginPathType.CDN;return a.utils.pluginPathType.RELATIVE}};a.utils.mapEmpty=function(c){for(var e in c)return false;return true};a.utils.mapLength=function(c){var e=0;for(var f in c)e++;return e};a.utils.log=function(c,e){if(typeof console!=
"undefined"&&typeof console.log!="undefined")e?console.log(c,e):console.log(c)};a.utils.css=function(c,e){if(a.utils.exists(c))for(var f in e)try{if(typeof e[f]!=="undefined"){if(typeof e[f]=="number"&&!(f=="zIndex"||f=="opacity")){if(isNaN(e[f]))continue;e[f]=f.match(/color/i)?"#"+a.utils.strings.pad(e[f].toString(16),6):Math.ceil(e[f])+"px"}c.style[f]=e[f]}}catch(h){}};a.utils.isYouTube=function(c){return c.indexOf("youtube.com")>-1||c.indexOf("youtu.be")>-1};a.utils.transform=function(c,e,f,h,
l){a.utils.exists(e)||(e=1);a.utils.exists(f)||(f=1);a.utils.exists(h)||(h=0);a.utils.exists(l)||(l=0);if(e==1&&f==1&&h==0&&l==0){c.style.webkitTransform="";c.style.MozTransform="";c.style.OTransform=""}else{e="scale("+e+","+f+") translate("+h+"px,"+l+"px)";c.style.webkitTransform=e;c.style.MozTransform=e;c.style.OTransform=e}};a.utils.stretch=function(c,e,f,h,l,o){if(!(typeof f=="undefined"||typeof h=="undefined"||typeof l=="undefined"||typeof o=="undefined")){var n=f/l,p=h/o,y=false,m={};if(e.parentElement)e.parentElement.style.overflow=
"hidden";a.utils.transform(e);switch(c.toUpperCase()){case a.utils.stretching.NONE:m.width=l;m.height=o;m.top=(h-m.height)/2;m.left=(f-m.width)/2;break;case a.utils.stretching.UNIFORM:if(n>p){m.width=l*p;m.height=o*p;if(m.width/f>0.95){y=true;n=Math.ceil(100*f/m.width)/100;p=1;m.width=f}}else{m.width=l*n;m.height=o*n;if(m.height/h>0.95){y=true;n=1;p=Math.ceil(100*h/m.height)/100;m.height=h}}m.top=(h-m.height)/2;m.left=(f-m.width)/2;break;case a.utils.stretching.FILL:if(n>p){m.width=l*n;m.height=o*
n}else{m.width=l*p;m.height=o*p}m.top=(h-m.height)/2;m.left=(f-m.width)/2;break;case a.utils.stretching.EXACTFIT:m.width=l;m.height=o;var v=Math.round(l/2*(1-1/n)),A=Math.round(o/2*(1-1/p));y=true;m.top=m.left=0;break;default:break}y&&a.utils.transform(e,n,p,v,A);a.utils.css(e,m)}};a.utils.stretching={NONE:"NONE",FILL:"FILL",UNIFORM:"UNIFORM",EXACTFIT:"EXACTFIT"};a.utils.deepReplaceKeyName=function(c,e,f){switch(a.utils.typeOf(c)){case "array":for(var h=0;h<c.length;h++)c[h]=a.utils.deepReplaceKeyName(c[h],
e,f);break;case "object":for(var l in c){var o;if(e instanceof Array&&f instanceof Array)if(e.length!=f.length)continue;else o=e;else o=[e];var n=l;for(h=0;h<o.length;h++)n=n.replace(new RegExp(e[h],"g"),f[h]);c[n]=a.utils.deepReplaceKeyName(c[l],e,f);l!=n&&delete c[l]}break}return c};a.utils.isInArray=function(c,e){if(!c||!(c instanceof Array))return false;for(var f=0;f<c.length;f++)if(e===c[f])return true;return false};a.utils.exists=function(c){switch(typeof c){case "string":return c.length>0;
case "object":return c!==null;case "undefined":return false}return true};a.utils.empty=function(c){if(typeof c.hasChildNodes=="function")for(;c.hasChildNodes();)c.removeChild(c.firstChild)};a.utils.parseDimension=function(c){if(typeof c=="string")return c===""?0:c.lastIndexOf("%")>-1?c:parseInt(c.replace("px",""),10);return c};a.utils.getDimensions=function(c){return c&&c.style?{x:a.utils.parseDimension(c.style.left),y:a.utils.parseDimension(c.style.top),width:a.utils.parseDimension(c.style.width),
height:a.utils.parseDimension(c.style.height)}:{}};a.utils.getElementWidth=function(c){return c?c==document.body?a.utils.parentNode(c).clientWidth:c.clientWidth>0?c.clientWidth:c.style?a.utils.parseDimension(c.style.width):null:null};a.utils.getElementHeight=function(c){return c?c==document.body?a.utils.parentNode(c).clientHeight:c.clientHeight>0?c.clientHeight:c.style?a.utils.parseDimension(c.style.height):null:null};a.utils.timeFormat=function(c){str="00:00";if(c>0){str=Math.floor(c/60)<10?"0"+
Math.floor(c/60)+":":Math.floor(c/60)+":";str+=Math.floor(c%60)<10?"0"+Math.floor(c%60):Math.floor(c%60)}return str};a.utils.useNativeFullscreen=function(){return navigator&&navigator.vendor&&navigator.vendor.indexOf("Apple")==0};a.utils.parentNode=function(c){return c?c.parentNode?c.parentNode:c.parentElement?c.parentElement:c:document.body};a.utils.getBoundingClientRect=function(c){return typeof c.getBoundingClientRect=="function"?c.getBoundingClientRect():{left:c.offsetLeft+document.body.scrollLeft,
top:c.offsetTop+document.body.scrollTop,width:c.offsetWidth,height:c.offsetHeight}};a.utils.translateEventResponse=function(c,e){e=a.utils.extend({},e);if(c==a.api.events.JWPLAYER_FULLSCREEN&&!e.fullscreen){e.fullscreen=e.message=="true"?true:false;delete e.message}else if(typeof e.data=="object"){e=a.utils.extend(e,e.data);delete e.data}else typeof e.metadata=="object"&&a.utils.deepReplaceKeyName(e.metadata,["__dot__","__spc__","__dsh__"],["."," ","-"]);c=["position","duration","offset"];for(var f in c)if(e[c[f]])e[c[f]]=
Math.round(e[c[f]]*1E3)/1E3;return e};a.utils.saveCookie=function(c,e){document.cookie="jwplayer."+c+"="+e+"; path=/"};a.utils.getCookies=function(){for(var c={},e=document.cookie.split("; "),f=0;f<e.length;f++){var h=e[f].split("=");if(h[0].indexOf("jwplayer.")==0)c[h[0].substring(9,h[0].length)]=h[1]}return c};a.utils.readCookie=function(c){return a.utils.getCookies()[c]}})(jwplayer);(function(a){a.events=function(){};a.events.COMPLETE="COMPLETE";a.events.ERROR="ERROR"})(jwplayer);(function(a){a.events.eventdispatcher=
function(b){var c,e;this.resetEventListeners=function(){c={};e=[]};this.resetEventListeners();this.addEventListener=function(f,h,l){try{a.utils.exists(c[f])||(c[f]=[]);typeof h=="string"&&eval("listener = "+h);c[f].push({listener:h,count:l})}catch(o){a.utils.log("error",o)}return false};this.removeEventListener=function(f,h){if(c[f]){try{for(var l=0;l<c[f].length;l++)if(c[f][l].listener.toString()==h.toString()){c[f].splice(l,1);break}}catch(o){a.utils.log("error",o)}return false}};this.addGlobalListener=
function(f,h){try{typeof f=="string"&&eval("listener = "+f);e.push({listener:f,count:h})}catch(l){a.utils.log("error",l)}return false};this.removeGlobalListener=function(f){if(f){try{for(var h=0;h<e.length;h++)if(e[h].listener.toString()==f.toString()){e.splice(h,1);break}}catch(l){a.utils.log("error",l)}return false}};this.sendEvent=function(f,h){a.utils.exists(h)||(h={});b&&a.utils.log(f,h);if(typeof c[f]!="undefined")for(var l=0;l<c[f].length;l++){try{c[f][l].listener(h)}catch(o){a.utils.log("There was an error while handling a listener: "+
o.toString(),c[f][l].listener)}if(c[f][l])if(c[f][l].count===1)delete c[f][l];else if(c[f][l].count>0)c[f][l].count-=1}for(f=0;f<e.length;f++){try{e[f].listener(h)}catch(n){a.utils.log("There was an error while handling a listener: "+n.toString(),e[f].listener)}if(e[f])if(e[f].count===1)delete e[f];else if(e[f].count>0)e[f].count-=1}}}})(jwplayer);(function(a){var b={};a.utils.animations=function(){};a.utils.animations.transform=function(c,e){c.style.webkitTransform=e;c.style.MozTransform=e;c.style.OTransform=
e;c.style.msTransform=e};a.utils.animations.transformOrigin=function(c,e){c.style.webkitTransformOrigin=e;c.style.MozTransformOrigin=e;c.style.OTransformOrigin=e;c.style.msTransformOrigin=e};a.utils.animations.rotate=function(c,e){a.utils.animations.transform(c,["rotate(",e,"deg)"].join(""))};a.utils.cancelAnimation=function(c){delete b[c.id]};a.utils.fadeTo=function(c,e,f,h,l,o){if(!(b[c.id]!=o&&a.utils.exists(o)))if(c.style.opacity!=e){var n=(new Date).getTime();o>n&&setTimeout(function(){a.utils.fadeTo(c,
e,f,h,0,o)},o-n);if(c.style.display=="none")c.style.display="block";a.utils.exists(h)||(h=c.style.opacity===""?1:c.style.opacity);if(c.style.opacity==e&&c.style.opacity!==""&&a.utils.exists(o)){if(e===0)c.style.display="none"}else{if(!a.utils.exists(o)){o=n;b[c.id]=o}a.utils.exists(l)||(l=0);n=f>0?(n-o)/(f*1E3):0;n=n>1?1:n;n=h+n*(e-h);if(n>1)n=1;else if(n<0)n=0;c.style.opacity=n;if(l>0){b[c.id]=o+l*1E3;a.utils.fadeTo(c,e,f,h,0,b[c.id])}else setTimeout(function(){a.utils.fadeTo(c,e,f,h,0,o)},10)}}}})(jwplayer);
(function(a){a.utils.arrays=function(){};a.utils.arrays.indexOf=function(b,c){for(var e=0;e<b.length;e++)if(b[e]==c)return e;return-1};a.utils.arrays.remove=function(b,c){c=a.utils.arrays.indexOf(b,c);c>-1&&b.splice(c,1)}})(jwplayer);(function(a){a.utils.extensionmap={"3gp":{html5:"video/3gpp",flash:"video"},"3gpp":{html5:"video/3gpp"},"3g2":{html5:"video/3gpp2",flash:"video"},"3gpp2":{html5:"video/3gpp2"},flv:{flash:"video"},f4a:{html5:"audio/mp4"},f4b:{html5:"audio/mp4",flash:"video"},f4v:{html5:"video/mp4",
flash:"video"},mov:{html5:"video/quicktime",flash:"video"},m4a:{html5:"audio/mp4",flash:"video"},m4b:{html5:"audio/mp4"},m4p:{html5:"audio/mp4"},m4v:{html5:"video/mp4",flash:"video"},mp4:{html5:"video/mp4",flash:"video"},rbs:{flash:"sound"},aac:{html5:"audio/aac",flash:"video"},mp3:{html5:"audio/mp3",flash:"sound"},ogg:{html5:"audio/ogg"},oga:{html5:"audio/ogg"},ogv:{html5:"video/ogg"},webm:{html5:"video/webm"},m3u8:{html5:"audio/x-mpegurl"},gif:{flash:"image"},jpeg:{flash:"image"},jpg:{flash:"image"},
swf:{flash:"image"},png:{flash:"image"},wav:{html5:"audio/x-wav"}}})(jwplayer);(function(a){function b(n,p){if(a.utils.exists(p))a.utils.extend(p,l[n]);else p=l[n];return p}function c(n,p){if(o[n.tagName.toLowerCase()]&&!a.utils.exists(p))return o[n.tagName.toLowerCase()](n);else{p=b("element",p);var y={};for(var m in p)if(m!="length"){var v=n.getAttribute(m);if(a.utils.exists(v))y[p[m]]=v}if((n=n.style["#background-color"])&&!(n=="transparent"||n=="rgba(0, 0, 0, 0)"))y.screencolor=n;return y}}function e(n,
p){p=b("media",p);var y=[],m=a.utils.selectors("source",n);for(var v in m)isNaN(v)||y.push(f(m[v]));n=c(n,p);if(a.utils.exists(n.file))y[0]={file:n.file};n.levels=y;return n}function f(n,p){p=b("source",p);n=c(n,p);n.width=n.width?n.width:0;n.bitrate=n.bitrate?n.bitrate:0;return n}function h(n,p){p=b("video",p);return e(n,p)}a.utils.mediaparser=function(){};var l={element:{width:"width",height:"height",id:"id","class":"className",name:"name"},media:{src:"file",preload:"preload",autoplay:"autostart",
loop:"repeat",controls:"controls"},source:{src:"file",type:"type",media:"media","data-jw-width":"width","data-jw-bitrate":"bitrate"},video:{poster:"image"}},o={};a.utils.mediaparser.parseMedia=function(n){return c(n)};o.media=e;o.audio=e;o.source=f;o.video=h})(jwplayer);(function(a){a.utils.loaderstatus={NEW:"NEW",LOADING:"LOADING",ERROR:"ERROR",COMPLETE:"COMPLETE"};a.utils.scriptloader=function(b){var c=a.utils.loaderstatus.NEW,e=new a.events.eventdispatcher;a.utils.extend(this,e);this.load=function(){if(c==
a.utils.loaderstatus.NEW){c=a.utils.loaderstatus.LOADING;var f=document.createElement("script");f.onload=function(){c=a.utils.loaderstatus.COMPLETE;e.sendEvent(a.events.COMPLETE)};f.onerror=function(){c=a.utils.loaderstatus.ERROR;e.sendEvent(a.events.ERROR)};f.onreadystatechange=function(){if(f.readyState=="loaded"||f.readyState=="complete"){c=a.utils.loaderstatus.COMPLETE;e.sendEvent(a.events.COMPLETE)}};document.getElementsByTagName("head")[0].appendChild(f);f.src=b}};this.getStatus=function(){return c}}})(jwplayer);
(function(a){a.utils.selectors=function(b,c){a.utils.exists(c)||(c=document);b=a.utils.strings.trim(b);var e=b.charAt(0);if(e=="#")return c.getElementById(b.substr(1));else if(e==".")return c.getElementsByClassName?c.getElementsByClassName(b.substr(1)):a.utils.selectors.getElementsByTagAndClass("*",b.substr(1));else if(b.indexOf(".")>0){b=b.split(".");return a.utils.selectors.getElementsByTagAndClass(b[0],b[1])}else return c.getElementsByTagName(b)};a.utils.selectors.getElementsByTagAndClass=function(b,
c,e){var f=[];a.utils.exists(e)||(e=document);b=e.getElementsByTagName(b);for(e=0;e<b.length;e++)if(a.utils.exists(b[e].className))for(var h=b[e].className.split(" "),l=0;l<h.length;l++)h[l]==c&&f.push(b[e]);return f}})(jwplayer);(function(a){a.utils.strings=function(){};a.utils.strings.trim=function(b){return b.replace(/^\s*/,"").replace(/\s*$/,"")};a.utils.strings.pad=function(b,c,e){for(e||(e="0");b.length<c;)b=e+b;return b};a.utils.strings.serialize=function(b){return b==null?null:b=="true"?true:
b=="false"?false:isNaN(Number(b))||b.length>5||b.length==0?b:Number(b)};a.utils.strings.seconds=function(b){b=b.replace(",",".");var c=b.split(":"),e=0;if(b.substr(-1)=="s")e=Number(b.substr(0,b.length-1));else if(b.substr(-1)=="m")e=Number(b.substr(0,b.length-1))*60;else if(b.substr(-1)=="h")e=Number(b.substr(0,b.length-1))*3600;else if(c.length>1){e=Number(c[c.length-1]);e+=Number(c[c.length-2])*60;if(c.length==3)e+=Number(c[c.length-3])*3600}else e=Number(b);return e};a.utils.strings.xmlAttribute=
function(b,c){for(var e=0;e<b.attributes.length;e++)if(b.attributes[e].name&&b.attributes[e].name.toLowerCase()==c.toLowerCase())return b.attributes[e].value.toString();return""};a.utils.strings.jsonToString=function(b){var c=c||{};if(c&&c.stringify)return c.stringify(b);c=typeof b;if(c!="object"||b===null)if(c=="string")b.replace(/"/g,'\\"');else return String(b);else{c=[];var e=b&&b.constructor==Array;for(var f in b){var h=b[f];switch(typeof h){case "string":h='"'+h.replace(/"/g,'\\"')+'"';break;
case "object":if(a.utils.exists(h))h=a.utils.strings.jsonToString(h);break}if(e)typeof h!="function"&&c.push(String(h));else typeof h!="function"&&c.push('"'+f+'":'+String(h))}return e?"["+String(c)+"]":"{"+String(c)+"}"}}})(jwplayer);(function(a){function b(h){if(["true","false","t","f"].toString().indexOf(h.toLowerCase().replace(" ",""))>=0)return"boolean";else if(f.test(h))return"color";else if(!isNaN(parseInt(h,10))&&parseInt(h,10).toString().length==h.length)return"integer";else if(!isNaN(parseFloat(h))&&
parseFloat(h).toString().length==h.length)return"float";return"string"}function c(h,l){if(!a.utils.exists(l))return h;switch(l){case "color":if(h.length>0)return e(h);return null;case "integer":return parseInt(h,10);case "float":return parseFloat(h);case "boolean":if(h.toLowerCase()=="true")return true;else if(h=="1")return true;return false}return h}function e(h){switch(h.toLowerCase()){case "blue":return parseInt("0000FF",16);case "green":return parseInt("00FF00",16);case "red":return parseInt("FF0000",
16);case "cyan":return parseInt("00FFFF",16);case "magenta":return parseInt("FF00FF",16);case "yellow":return parseInt("FFFF00",16);case "black":return parseInt("000000",16);case "white":return parseInt("FFFFFF",16);default:h=h.replace(/(#|0x)?([0-9A-F]{3,6})$/gi,"$2");if(h.length==3)h=h.charAt(0)+h.charAt(0)+h.charAt(1)+h.charAt(1)+h.charAt(2)+h.charAt(2);return parseInt(h,16)}}var f=new RegExp(/^(#|0x)[0-9a-fA-F]{3,6}/);a.utils.typechecker=function(h,l){l=!a.utils.exists(l)?b(h):l;return c(h,l)}})(jwplayer);
(function(a){a.utils.parsers=function(){};a.utils.parsers.localName=function(b){return b?b.localName?b.localName:b.baseName?b.baseName:"":""};a.utils.parsers.textContent=function(b){return b?b.textContent?b.textContent:b.text?b.text:"":""}})(jwplayer);(function(a){a.utils.parsers.jwparser=function(){};a.utils.parsers.jwparser.PREFIX="jwplayer";a.utils.parsers.jwparser.parseEntry=function(b,c){for(var e=0;e<b.childNodes.length;e++){if(b.childNodes[e].prefix==a.utils.parsers.jwparser.PREFIX){c[a.utils.parsers.localName(b.childNodes[e])]=
a.utils.strings.serialize(a.utils.parsers.textContent(b.childNodes[e]));a.utils.parsers.localName(b.childNodes[e])=="file"&&c.levels&&delete c.levels}if(!c.file&&String(c.link).toLowerCase().indexOf("youtube")>-1)c.file=c.link}return c};a.utils.parsers.jwparser.getProvider=function(b){if(b.type)return b.type;else if(b.file.indexOf("youtube.com/w")>-1||b.file.indexOf("youtube.com/v")>-1||b.file.indexOf("youtu.be/")>-1)return"youtube";else if(b.streamer&&b.streamer.indexOf("rtmp")==0)return"rtmp";else if(b.streamer&&
b.streamer.indexOf("http")==0)return"http";else{b=a.utils.strings.extension(b.file);if(extensions.hasOwnProperty(b))return extensions[b]}return""}})(jwplayer);(function(a){a.utils.parsers.mediaparser=function(){};a.utils.parsers.mediaparser.PREFIX="media";a.utils.parsers.mediaparser.parseGroup=function(b,c){for(var e=false,f=0;f<b.childNodes.length;f++)if(b.childNodes[f].prefix==a.utils.parsers.mediaparser.PREFIX)if(a.utils.parsers.localName(b.childNodes[f]))switch(a.utils.parsers.localName(b.childNodes[f]).toLowerCase()){case "content":if(!e)c.file=
a.utils.strings.xmlAttribute(b.childNodes[f],"url");if(a.utils.strings.xmlAttribute(b.childNodes[f],"duration"))c.duration=a.utils.strings.seconds(a.utils.strings.xmlAttribute(b.childNodes[f],"duration"));if(a.utils.strings.xmlAttribute(b.childNodes[f],"start"))c.start=a.utils.strings.seconds(a.utils.strings.xmlAttribute(b.childNodes[f],"start"));if(b.childNodes[f].childNodes&&b.childNodes[f].childNodes.length>0)c=a.utils.parsers.mediaparser.parseGroup(b.childNodes[f],c);if(a.utils.strings.xmlAttribute(b.childNodes[f],
"width")||a.utils.strings.xmlAttribute(b.childNodes[f],"bitrate")||a.utils.strings.xmlAttribute(b.childNodes[f],"url")){if(!c.levels)c.levels=[];c.levels.push({width:a.utils.strings.xmlAttribute(b.childNodes[f],"width"),bitrate:a.utils.strings.xmlAttribute(b.childNodes[f],"bitrate"),file:a.utils.strings.xmlAttribute(b.childNodes[f],"url")})}break;case "title":c.title=a.utils.parsers.textContent(b.childNodes[f]);break;case "description":c.description=a.utils.parsers.textContent(b.childNodes[f]);break;
case "keywords":c.tags=a.utils.parsers.textContent(b.childNodes[f]);break;case "thumbnail":c.image=a.utils.strings.xmlAttribute(b.childNodes[f],"url");break;case "credit":c.author=a.utils.parsers.textContent(b.childNodes[f]);break;case "player":var h=b.childNodes[f].url;if(h.indexOf("youtube.com")>=0||h.indexOf("youtu.be")>=0){e=true;c.file=a.utils.strings.xmlAttribute(b.childNodes[f],"url")}break;case "group":a.utils.parsers.mediaparser.parseGroup(b.childNodes[f],c);break}return c}})(jwplayer);(function(a){function b(c){for(var e=
{},f=0;f<c.childNodes.length;f++)if(a.utils.parsers.localName(c.childNodes[f]))switch(a.utils.parsers.localName(c.childNodes[f]).toLowerCase()){case "enclosure":e.file=a.utils.strings.xmlAttribute(c.childNodes[f],"url");break;case "title":e.title=a.utils.parsers.textContent(c.childNodes[f]);break;case "pubdate":e.date=a.utils.parsers.textContent(c.childNodes[f]);break;case "description":e.description=a.utils.parsers.textContent(c.childNodes[f]);break;case "link":e.link=a.utils.parsers.textContent(c.childNodes[f]);
break;case "category":if(e.tags)e.tags+=a.utils.parsers.textContent(c.childNodes[f]);else e.tags=a.utils.parsers.textContent(c.childNodes[f]);break}e=a.utils.parsers.mediaparser.parseGroup(c,e);e=a.utils.parsers.jwparser.parseEntry(c,e);return new a.html5.playlistitem(e)}a.utils.parsers.rssparser=function(){};a.utils.parsers.rssparser.parse=function(c){for(var e=[],f=0;f<c.childNodes.length;f++)if(a.utils.parsers.localName(c.childNodes[f]).toLowerCase()=="channel")for(var h=0;h<c.childNodes[f].childNodes.length;h++)a.utils.parsers.localName(c.childNodes[f].childNodes[h]).toLowerCase()==
"item"&&e.push(b(c.childNodes[f].childNodes[h]));return e}})(jwplayer);(function(a){var b={},c={};a.plugins=function(){};a.plugins.loadPlugins=function(e,f){c[e]=new a.plugins.pluginloader(new a.plugins.model(b),f);return c[e]};a.plugins.registerPlugin=function(e,f,h){var l=a.utils.getPluginName(e);if(b[l])b[l].registerPlugin(e,f,h);else{a.utils.log("A plugin ("+e+") was registered with the player that was not loaded. Please check your configuration.");for(var o in c)c[o].pluginFailed()}}})(jwplayer);
(function(a){a.plugins.model=function(b){this.addPlugin=function(c){var e=a.utils.getPluginName(c);b[e]||(b[e]=new a.plugins.plugin(c));return b[e]}}})(jwplayer);(function(a){a.plugins.pluginmodes={FLASH:"FLASH",JAVASCRIPT:"JAVASCRIPT",HYBRID:"HYBRID"};a.plugins.plugin=function(b){function c(){switch(a.utils.getPluginPathType(b)){case a.utils.pluginPathType.ABSOLUTE:return b;case a.utils.pluginPathType.RELATIVE:return a.utils.getAbsolutePath(b,window.location.href);case a.utils.pluginPathType.CDN:var m=
a.utils.getPluginName(b),v=a.utils.getPluginVersion(b);return(window.location.href.indexOf("https://")==0?h.replace("http://","https://secure"):h)+"/"+a.version.split(".")[0]+"/"+m+"/"+m+(v!==""?"-"+v:"")+".js"}}function e(){p=setTimeout(function(){l=a.utils.loaderstatus.COMPLETE;y.sendEvent(a.events.COMPLETE)},1E3)}function f(){l=a.utils.loaderstatus.ERROR;y.sendEvent(a.events.ERROR)}var h="http://lp.longtailvideo.com",l=a.utils.loaderstatus.NEW,o,n,p,y=new a.events.eventdispatcher;a.utils.extend(this,
y);this.load=function(){if(l==a.utils.loaderstatus.NEW)if(b.lastIndexOf(".swf")>0){o=b;l=a.utils.loaderstatus.COMPLETE;y.sendEvent(a.events.COMPLETE)}else{l=a.utils.loaderstatus.LOADING;var m=new a.utils.scriptloader(c());m.addEventListener(a.events.COMPLETE,e);m.addEventListener(a.events.ERROR,f);m.load()}};this.registerPlugin=function(m,v,A){if(p){clearTimeout(p);p=undefined}if(v&&A){o=A;n=v}else if(typeof v=="string")o=v;else if(typeof v=="function")n=v;else if(!v&&!A)o=m;l=a.utils.loaderstatus.COMPLETE;
y.sendEvent(a.events.COMPLETE)};this.getStatus=function(){return l};this.getPluginName=function(){return a.utils.getPluginName(b)};this.getFlashPath=function(){if(o)switch(a.utils.getPluginPathType(o)){case a.utils.pluginPathType.ABSOLUTE:return o;case a.utils.pluginPathType.RELATIVE:if(b.lastIndexOf(".swf")>0)return a.utils.getAbsolutePath(o,window.location.href);return a.utils.getAbsolutePath(o,c());case a.utils.pluginPathType.CDN:if(o.indexOf("-")>-1)return o+"h";return o+"-h"}return null};this.getJS=
function(){return n};this.getPluginmode=function(){if(typeof o!="undefined"&&typeof n!="undefined")return a.plugins.pluginmodes.HYBRID;else if(typeof o!="undefined")return a.plugins.pluginmodes.FLASH;else if(typeof n!="undefined")return a.plugins.pluginmodes.JAVASCRIPT};this.getNewInstance=function(m,v,A){return new n(m,v,A)};this.getURL=function(){return b}}})(jwplayer);(function(a){a.plugins.pluginloader=function(b,c){function e(){if(!n){n=true;l=a.utils.loaderstatus.COMPLETE;p.sendEvent(a.events.COMPLETE)}}
function f(){if(!n){var y=0;for(plugin in h){var m=h[plugin].getStatus();if(m==a.utils.loaderstatus.LOADING||m==a.utils.loaderstatus.NEW)y++}y==0&&e()}}var h={},l=a.utils.loaderstatus.NEW,o=false,n=false,p=new a.events.eventdispatcher;a.utils.extend(this,p);this.setupPlugins=function(y,m,v){var A={length:0,plugins:{}},B={length:0,plugins:{}};for(var s in h){var F=h[s].getPluginName();if(h[s].getFlashPath()){A.plugins[h[s].getFlashPath()]=m.plugins[s];A.plugins[h[s].getFlashPath()].pluginmode=h[s].getPluginmode();
A.length++}if(h[s].getJS()){var g=document.createElement("div");g.id=y.id+"_"+F;g.style.position="absolute";g.style.zIndex=B.length+10;B.plugins[F]=h[s].getNewInstance(y,m.plugins[s],g);B.length++;if(typeof B.plugins[F].resize!="undefined"){y.onReady(v(B.plugins[F],g,true));y.onResize(v(B.plugins[F],g))}}}y.plugins=B.plugins;return A};this.load=function(){l=a.utils.loaderstatus.LOADING;o=true;for(var y in c)if(a.utils.exists(y)){h[y]=b.addPlugin(y);h[y].addEventListener(a.events.COMPLETE,f);h[y].addEventListener(a.events.ERROR,
f)}for(y in h)h[y].load();o=false;f()};this.pluginFailed=function(){e()};this.getStatus=function(){return l}}})(jwplayer);(function(a){var b=[];a.api=function(c){function e(g,j){return function(q,t,w,r){if(g.renderingMode=="flash"||g.renderingMode=="html5"){var z;if(t){F[q]=t;z="jwplayer('"+g.id+"').callback('"+q+"')"}else!t&&F[q]&&delete F[q];y.jwDockSetButton(q,z,w,r)}return j}}function f(g){v=[];a.utils.getOuterHTML(g.container)!=B&&a.api.destroyPlayer(g.id,B)}function h(g){return function(j){var q=
j.newstate;j=j.oldstate;if(q==g){var t=n[q];if(t)for(var w=0;w<t.length;w++)typeof t[w]=="function"&&t[w].call(this,{oldstate:j,newstate:q})}}}function l(g,j){return function(q){if(g==q.component){var t=p[g][j];if(t)for(var w=0;w<t.length;w++)typeof t[w]=="function"&&t[w].call(this,q)}}}this.container=c;this.id=c.id;var o={},n={},p={},y=undefined,m=false,v=[],A=undefined,B=a.utils.getOuterHTML(c),s={},F={};this.getBuffer=function(){return this.callInternal("jwGetBuffer")};this.getContainer=function(){return this.container};
this.getPlugin=function(g){var j=this,q={};return g=="dock"?a.utils.extend(q,{setButton:e(j,q),show:function(){j.callInternal("jwDockShow");return q},hide:function(){j.callInternal("jwDockHide");return q},onShow:function(t){j.componentListener("dock",a.api.events.JWPLAYER_COMPONENT_SHOW,t);return q},onHide:function(t){j.componentListener("dock",a.api.events.JWPLAYER_COMPONENT_HIDE,t);return q}}):g=="controlbar"?a.utils.extend(q,{show:function(){j.callInternal("jwControlbarShow");return q},hide:function(){j.callInternal("jwControlbarHide");
return q},onShow:function(t){j.componentListener("controlbar",a.api.events.JWPLAYER_COMPONENT_SHOW,t);return q},onHide:function(t){j.componentListener("controlbar",a.api.events.JWPLAYER_COMPONENT_HIDE,t);return q}}):g=="display"?a.utils.extend(q,{show:function(){j.callInternal("jwDisplayShow");return q},hide:function(){j.callInternal("jwDisplayHide");return q},onShow:function(t){j.componentListener("display",a.api.events.JWPLAYER_COMPONENT_SHOW,t);return q},onHide:function(t){j.componentListener("display",
a.api.events.JWPLAYER_COMPONENT_HIDE,t);return q}}):this.plugins[g]};this.callback=function(g){if(F[g])return F[g]()};this.getDuration=function(){return this.callInternal("jwGetDuration")};this.getFullscreen=function(){return this.callInternal("jwGetFullscreen")};this.getHeight=function(){return this.callInternal("jwGetHeight")};this.getLockState=function(){return this.callInternal("jwGetLockState")};this.getMeta=function(){return this.getItemMeta()};this.getMute=function(){return this.callInternal("jwGetMute")};
this.getPlaylist=function(){var g=this.callInternal("jwGetPlaylist");this.renderingMode=="flash"&&a.utils.deepReplaceKeyName(g,["__dot__","__spc__","__dsh__"],["."," ","-"]);for(var j=0;j<g.length;j++)if(!a.utils.exists(g[j].index))g[j].index=j;return g};this.getPlaylistItem=function(g){a.utils.exists(g)||(g=this.getCurrentItem());return this.getPlaylist()[g]};this.getPosition=function(){return this.callInternal("jwGetPosition")};this.getRenderingMode=function(){return this.renderingMode};this.getState=
function(){return this.callInternal("jwGetState")};this.getVolume=function(){return this.callInternal("jwGetVolume")};this.getWidth=function(){return this.callInternal("jwGetWidth")};this.setFullscreen=function(g){a.utils.exists(g)?this.callInternal("jwSetFullscreen",g):this.callInternal("jwSetFullscreen",!this.callInternal("jwGetFullscreen"));return this};this.setMute=function(g){a.utils.exists(g)?this.callInternal("jwSetMute",g):this.callInternal("jwSetMute",!this.callInternal("jwGetMute"));return this};
this.lock=function(){return this};this.unlock=function(){return this};this.load=function(g){this.callInternal("jwLoad",g);return this};this.playlistItem=function(g){this.callInternal("jwPlaylistItem",g);return this};this.playlistPrev=function(){this.callInternal("jwPlaylistPrev");return this};this.playlistNext=function(){this.callInternal("jwPlaylistNext");return this};this.resize=function(g,j){if(this.renderingMode=="html5")y.jwResize(g,j);else{this.container.width=g;this.container.height=j;var q=
document.getElementById(this.id+"_wrapper");if(q){q.style.width=g+"px";q.style.height=j+"px"}}return this};this.play=function(g){if(typeof g=="undefined"){g=this.getState();g==a.api.events.state.PLAYING||g==a.api.events.state.BUFFERING?this.callInternal("jwPause"):this.callInternal("jwPlay")}else this.callInternal("jwPlay",g);return this};this.pause=function(g){if(typeof g=="undefined"){g=this.getState();g==a.api.events.state.PLAYING||g==a.api.events.state.BUFFERING?this.callInternal("jwPause"):this.callInternal("jwPlay")}else this.callInternal("jwPause",
g);return this};this.stop=function(){this.callInternal("jwStop");return this};this.seek=function(g){this.callInternal("jwSeek",g);return this};this.setVolume=function(g){this.callInternal("jwSetVolume",g);return this};this.loadInstream=function(g,j){return A=new a.api.instream(this,y,g,j)};this.onBufferChange=function(g){return this.eventListener(a.api.events.JWPLAYER_MEDIA_BUFFER,g)};this.onBufferFull=function(g){return this.eventListener(a.api.events.JWPLAYER_MEDIA_BUFFER_FULL,g)};this.onError=
function(g){return this.eventListener(a.api.events.JWPLAYER_ERROR,g)};this.onFullscreen=function(g){return this.eventListener(a.api.events.JWPLAYER_FULLSCREEN,g)};this.onMeta=function(g){return this.eventListener(a.api.events.JWPLAYER_MEDIA_META,g)};this.onMute=function(g){return this.eventListener(a.api.events.JWPLAYER_MEDIA_MUTE,g)};this.onPlaylist=function(g){return this.eventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,g)};this.onPlaylistItem=function(g){return this.eventListener(a.api.events.JWPLAYER_PLAYLIST_ITEM,
g)};this.onReady=function(g){return this.eventListener(a.api.events.API_READY,g)};this.onResize=function(g){return this.eventListener(a.api.events.JWPLAYER_RESIZE,g)};this.onComplete=function(g){return this.eventListener(a.api.events.JWPLAYER_MEDIA_COMPLETE,g)};this.onSeek=function(g){return this.eventListener(a.api.events.JWPLAYER_MEDIA_SEEK,g)};this.onTime=function(g){return this.eventListener(a.api.events.JWPLAYER_MEDIA_TIME,g)};this.onVolume=function(g){return this.eventListener(a.api.events.JWPLAYER_MEDIA_VOLUME,
g)};this.onBeforePlay=function(g){return this.eventListener(a.api.events.JWPLAYER_MEDIA_BEFOREPLAY,g)};this.onBeforeComplete=function(g){return this.eventListener(a.api.events.JWPLAYER_MEDIA_BEFORECOMPLETE,g)};this.onBuffer=function(g){return this.stateListener(a.api.events.state.BUFFERING,g)};this.onPause=function(g){return this.stateListener(a.api.events.state.PAUSED,g)};this.onPlay=function(g){return this.stateListener(a.api.events.state.PLAYING,g)};this.onIdle=function(g){return this.stateListener(a.api.events.state.IDLE,
g)};this.remove=function(){if(!m)throw"Cannot call remove() before player is ready";f(this)};this.setup=function(g){if(a.embed){var j=this.id;f(this);j=a(j);j.config=g;return new a.embed(j)}return this};this.registerPlugin=function(g,j,q){a.plugins.registerPlugin(g,j,q)};this.setPlayer=function(g,j){y=g;this.renderingMode=j};this.stateListener=function(g,j){if(!n[g]){n[g]=[];this.eventListener(a.api.events.JWPLAYER_PLAYER_STATE,h(g))}n[g].push(j);return this};this.detachMedia=function(){if(this.renderingMode==
"html5")return this.callInternal("jwDetachMedia")};this.attachMedia=function(){if(this.renderingMode=="html5")return this.callInternal("jwAttachMedia")};this.componentListener=function(g,j,q){p[g]||(p[g]={});if(!p[g][j]){p[g][j]=[];this.eventListener(j,l(g,j))}p[g][j].push(q);return this};this.addInternalListener=function(g,j){try{g.jwAddEventListener(j,'function(dat) { jwplayer("'+this.id+'").dispatchEvent("'+j+'", dat); }')}catch(q){a.utils.log("Could not add internal listener")}};this.eventListener=
function(g,j){if(!o[g]){o[g]=[];y&&m&&this.addInternalListener(y,g)}o[g].push(j);return this};this.dispatchEvent=function(g,j){if(o[g]){j=_utils.translateEventResponse(g,j);for(var q=0;q<o[g].length;q++)typeof o[g][q]=="function"&&o[g][q].call(this,j)}};this.dispatchInstreamEvent=function(g){A&&A.dispatchEvent(g,arguments)};this.callInternal=function(){if(m){for(var g=arguments[0],j=[],q=1;q<arguments.length;q++)j.push(arguments[q]);if(typeof y!="undefined"&&typeof y[g]=="function")return j.length==
2?y[g](j[0],j[1]):j.length==1?y[g](j[0]):y[g]();return null}else v.push(arguments)};this.playerReady=function(g){m=true;y||this.setPlayer(document.getElementById(g.id));this.container=document.getElementById(this.id);for(var j in o)this.addInternalListener(y,j);this.eventListener(a.api.events.JWPLAYER_PLAYLIST_ITEM,function(){s={}});this.eventListener(a.api.events.JWPLAYER_MEDIA_META,function(q){a.utils.extend(s,q.metadata)});for(this.dispatchEvent(a.api.events.API_READY);v.length>0;)this.callInternal.apply(this,
v.shift())};this.getItemMeta=function(){return s};this.getCurrentItem=function(){return this.callInternal("jwGetPlaylistIndex")};return this};a.api.selectPlayer=function(c){var e;a.utils.exists(c)||(c=0);if(c.nodeType)e=c;else if(typeof c=="string")e=document.getElementById(c);if(e)return(c=a.api.playerById(e.id))?c:a.api.addPlayer(new a.api(e));else if(typeof c=="number")return a.getPlayers()[c];return null};a.api.events={API_READY:"jwplayerAPIReady",JWPLAYER_READY:"jwplayerReady",JWPLAYER_FULLSCREEN:"jwplayerFullscreen",
JWPLAYER_RESIZE:"jwplayerResize",JWPLAYER_ERROR:"jwplayerError",JWPLAYER_MEDIA_BEFOREPLAY:"jwplayerMediaBeforePlay",JWPLAYER_MEDIA_BEFORECOMPLETE:"jwplayerMediaBeforeComplete",JWPLAYER_COMPONENT_SHOW:"jwplayerComponentShow",JWPLAYER_COMPONENT_HIDE:"jwplayerComponentHide",JWPLAYER_MEDIA_BUFFER:"jwplayerMediaBuffer",JWPLAYER_MEDIA_BUFFER_FULL:"jwplayerMediaBufferFull",JWPLAYER_MEDIA_ERROR:"jwplayerMediaError",JWPLAYER_MEDIA_LOADED:"jwplayerMediaLoaded",JWPLAYER_MEDIA_COMPLETE:"jwplayerMediaComplete",
JWPLAYER_MEDIA_SEEK:"jwplayerMediaSeek",JWPLAYER_MEDIA_TIME:"jwplayerMediaTime",JWPLAYER_MEDIA_VOLUME:"jwplayerMediaVolume",JWPLAYER_MEDIA_META:"jwplayerMediaMeta",JWPLAYER_MEDIA_MUTE:"jwplayerMediaMute",JWPLAYER_PLAYER_STATE:"jwplayerPlayerState",JWPLAYER_PLAYLIST_LOADED:"jwplayerPlaylistLoaded",JWPLAYER_PLAYLIST_ITEM:"jwplayerPlaylistItem",JWPLAYER_INSTREAM_CLICK:"jwplayerInstreamClicked",JWPLAYER_INSTREAM_DESTROYED:"jwplayerInstreamDestroyed"};a.api.events.state={BUFFERING:"BUFFERING",IDLE:"IDLE",
PAUSED:"PAUSED",PLAYING:"PLAYING"};a.api.playerById=function(c){for(var e=0;e<b.length;e++)if(b[e].id==c)return b[e];return null};a.api.addPlayer=function(c){for(var e=0;e<b.length;e++)if(b[e]==c)return c;b.push(c);return c};a.api.destroyPlayer=function(c,e){for(var f=-1,h=0;h<b.length;h++)if(b[h].id==c)f=h;if(f>=0){try{b[f].callInternal("jwDestroy")}catch(l){}c=document.getElementById(b[f].id);if(document.getElementById(b[f].id+"_wrapper"))c=document.getElementById(b[f].id+"_wrapper");if(c)if(e)a.utils.setOuterHTML(c,
e);else{e=document.createElement("div");h=c.id;if(c.id.indexOf("_wrapper")==c.id.length-8)newID=c.id.substring(0,c.id.length-8);e.setAttribute("id",h);c.parentNode.replaceChild(e,c)}b.splice(f,1)}return null};a.getPlayers=function(){return b.slice(0)}})(jwplayer);var _userPlayerReady=typeof playerReady=="function"?playerReady:undefined;playerReady=function(a){var b=jwplayer.api.playerById(a.id);b?b.playerReady(a):jwplayer.api.selectPlayer(a.id).playerReady(a);_userPlayerReady&&_userPlayerReady.call(this,
a)};(function(a){a.api.instream=function(b,c,e,f){function h(){y.callInternal("jwLoadInstream",e,f)}function l(B,s){m.jwInstreamAddEventListener(s,'function(dat) { jwplayer("'+y.id+'").dispatchInstreamEvent("'+s+'", dat); }')}function o(B,s){if(!v[B]){v[B]=[];l(m,B)}v[B].push(s);return this}function n(B,s){if(!A[B]){A[B]=[];o(a.api.events.JWPLAYER_PLAYER_STATE,p(B))}A[B].push(s);return this}function p(B){return function(s){var F=s.newstate,g=s.oldstate;if(F==B){var j=A[F];if(j)for(var q=0;q<j.length;q++)typeof j[q]==
"function"&&j[q].call(this,{oldstate:g,newstate:F,type:s.type})}}}var y=b,m=c,v={},A={};this.dispatchEvent=function(B,s){if(v[B]){s=_utils.translateEventResponse(B,s[1]);for(var F=0;F<v[B].length;F++)typeof v[B][F]=="function"&&v[B][F].call(this,s)}};this.onError=function(B){return o(a.api.events.JWPLAYER_ERROR,B)};this.onFullscreen=function(B){return o(a.api.events.JWPLAYER_FULLSCREEN,B)};this.onMeta=function(B){return o(a.api.events.JWPLAYER_MEDIA_META,B)};this.onMute=function(B){return o(a.api.events.JWPLAYER_MEDIA_MUTE,
B)};this.onComplete=function(B){return o(a.api.events.JWPLAYER_MEDIA_COMPLETE,B)};this.onSeek=function(B){return o(a.api.events.JWPLAYER_MEDIA_SEEK,B)};this.onTime=function(B){return o(a.api.events.JWPLAYER_MEDIA_TIME,B)};this.onVolume=function(B){return o(a.api.events.JWPLAYER_MEDIA_VOLUME,B)};this.onBuffer=function(B){return n(a.api.events.state.BUFFERING,B)};this.onPause=function(B){return n(a.api.events.state.PAUSED,B)};this.onPlay=function(B){return n(a.api.events.state.PLAYING,B)};this.onIdle=
function(B){return n(a.api.events.state.IDLE,B)};this.onInstreamClick=function(B){return o(a.api.events.JWPLAYER_INSTREAM_CLICK,B)};this.onInstreamDestroyed=function(B){return o(a.api.events.JWPLAYER_INSTREAM_DESTROYED,B)};this.play=function(B){m.jwInstreamPlay(B)};this.pause=function(B){m.jwInstreamPause(B)};this.seek=function(B){m.jwInstreamSeek(B)};this.destroy=function(){m.jwInstreamDestroy()};this.getState=function(){return m.jwInstreamGetState()};this.getDuration=function(){return m.jwInstreamGetDuration()};
this.getPosition=function(){return m.jwInstreamGetPosition()};h()}})(jwplayer);(function(a){function b(){if(!document.body)return setTimeout(b,15);for(var e=c.selectors.getElementsByTagAndClass("video","jwplayer"),f=0;f<e.length;f++){var h=e[f];if(h.id=="")h.id="jwplayer_"+Math.round(Math.random()*1E5);a(h.id).setup({})}}var c=a.utils;a.embed=function(e){function f(p,y){for(var m in y)typeof p[m]=="function"&&p[m].call(p,y[m])}function h(){if(n.getStatus()==c.loaderstatus.COMPLETE){for(var p=0;p<
o.modes.length;p++)if(o.modes[p].type&&a.embed[o.modes[p].type]){var y=o.modes[p].config,m=o;if(y){m=c.extend(c.clone(o),y);for(var v=["file","levels","playlist"],A=0;A<v.length;A++)if(c.exists(y[v[A]]))for(var B=0;B<v.length;B++)if(B!=A){var s=v[B];c.exists(m[s])&&!c.exists(y[s])&&delete m[s]}}y=new a.embed[o.modes[p].type](document.getElementById(e.id),o.modes[p],m,n,e);if(y.supportsConfig()){y.embed();f(e,o.events);return e}}c.log("No suitable players found");new a.embed.logo(c.extend({hide:true},
o.components.logo),"none",e.id)}}var l=c.mediaparser.parseMedia(e.container),o=new a.embed.config(c.extend({width:400,height:300,components:{controlbar:{position:"over"}}},l,e.config),this),n=a.plugins.loadPlugins(e.id,o.plugins);n.addEventListener(a.events.COMPLETE,h);n.addEventListener(a.events.ERROR,h);n.load();return e};b()})(jwplayer);(function(a){function b(p){p=[{type:"flash",src:p?p:"/jwplayer/player.swf"},{type:"html5"},{type:"download"}];if(l.isAndroid())p[0]=p.splice(1,1,p[0])[0];return p}
function c(p){var y=false;return y=p instanceof Array||typeof p=="object"&&!p.position&&!p.size}function e(p){if(typeof p=="string")if(parseInt(p).toString()==p||p.toLowerCase().indexOf("px")>-1)return parseInt(p);return p}function f(p){var y={};switch(l.typeOf(p.plugins)){case "object":for(var m in p.plugins)y[l.getPluginName(m)]=m;break;case "string":p=p.plugins.split(",");for(m=0;m<p.length;m++)y[l.getPluginName(p[m])]=p[m];break}return y}function h(p,y,m,v){if(l.typeOf(p[y])!="object")p[y]={};
var A=p[y][m];if(l.typeOf(A)!="object")p[y][m]=A={};if(v)if(y=="plugins"){y=l.getPluginName(m);A[v]=p[y+"."+v];delete p[y+"."+v]}else{A[v]=p[m+"."+v];delete p[m+"."+v]}}var l=a.utils,o={players:"modes",autoplay:"autostart"},n=["playlist","dock","controlbar","logo","display"];a.embed.deserialize=function(p){var y=f(p);for(var m in y)h(p,"plugins",y[m]);for(var v in p)if(v.indexOf(".")>-1){v=v.split(".");m=v[0];v=v[1];if(l.isInArray(n,m))h(p,"components",m,v);else y[m]&&h(p,"plugins",y[m],v)}return p};
a.embed.config=function(p){p=l.extend({},p);var y;if(c(p.playlist)){y=p.playlist;delete p.playlist}p=a.embed.deserialize(p);p.height=e(p.height);p.width=e(p.width);if(typeof p.plugins=="string"){var m=p.plugins.split(",");if(typeof p.plugins!="object")p.plugins={};for(var v=0;v<m.length;v++){var A=l.getPluginName(m[v]);if(typeof p[A]=="object"){p.plugins[m[v]]=p[A];delete p[A]}else p.plugins[m[v]]={}}}for(m=0;m<n.length;m++){v=n[m];if(l.exists(p[v])){if(typeof p[v]!="object"){p.components[v]||(p.components[v]=
{});if(v=="logo")p.components[v].file=p[v];else p.components[v].position=p[v]}else{p.components[v]||(p.components[v]={});l.extend(p.components[v],p[v])}delete p[v]}if(typeof p[v+"size"]!="undefined"){p.components[v]||(p.components[v]={});p.components[v].size=p[v+"size"];delete p[v+"size"]}}if(typeof p.icons!="undefined"){if(!p.components.display)p.components.display={};p.components.display.icons=p.icons;delete p.icons}for(var B in o)if(p[B]){p[o[B]]||(p[o[B]]=p[B]);delete p[B]}var s;if(p.flashplayer&&
!p.modes){s=b(p.flashplayer);delete p.flashplayer}else if(p.modes){if(typeof p.modes=="string")s=b(p.modes);else if(p.modes instanceof Array)s=p.modes;else if(typeof p.modes=="object"&&p.modes.type)s=[p.modes];delete p.modes}else s=b();p.modes=s;if(y)p.playlist=y;return p}})(jwplayer);(function(a){a.embed.download=function(b,c,e,f,h){function l(o,n,p){if(p)return false;p=["image","sound","youtube","http"];if(n&&p.toString().indexOf(n)>-1)return true;if(!n||n&&n=="video")if((o=a.utils.extension(o))&&
a.utils.extensionmap[o])return true;return false}this.embed=function(){function o(){_imageWidth=p.display_image.naturalWidth;_imageHeight=p.display_image.naturalHeight;n()}function n(){a.utils.stretch(a.utils.stretching.UNIFORM,p.display_image,y,m,_imageWidth,_imageHeight)}a.utils.extend({},e);var p={},y=e.width?e.width:480;if(typeof y!="number")y=parseInt(y,10);var m=e.height?e.height:320;if(typeof m!="number")m=parseInt(m,10);var v,A,B;B={};if(e.playlist&&e.playlist.length){B.file=e.playlist[0].file;
A=e.playlist[0].image;B.levels=e.playlist[0].levels}else{B.file=e.file;A=e.image;B.levels=e.levels}if(B.file)v=B.file;else if(B.levels&&B.levels.length)v=B.levels[0].file;B=v?"pointer":"auto";var s={display:{style:{cursor:B,width:y,height:m,backgroundColor:"#000",position:"relative",textDecoration:"none",border:"none",display:"block"}},display_icon:{style:{cursor:B,position:"absolute",display:v?"block":"none",top:0,left:0,border:0,margin:0,padding:0,zIndex:3,width:50,height:50,backgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAALdJREFUeNrs18ENgjAYhmFouDOCcQJGcARHgE10BDcgTOIosAGwQOuPwaQeuFRi2p/3Sb6EC5L3QCxZBgAAAOCorLW1zMn65TrlkH4NcV7QNcUQt7Gn7KIhxA+qNIR81spOGkL8oFJDyLJRdosqKDDkK+iX5+d7huzwM40xptMQMkjIOeRGo+VkEVvIPfTGIpKASfYIfT9iCHkHrBEzf4gcUQ56aEzuGK/mw0rHpy4AAACAf3kJMACBxjAQNRckhwAAAABJRU5ErkJggg==)"}},
display_iconBackground:{style:{cursor:B,position:"absolute",display:v?"block":"none",top:(m-50)/2,left:(y-50)/2,border:0,width:50,height:50,margin:0,padding:0,zIndex:2,backgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAEpJREFUeNrszwENADAIA7DhX8ENoBMZ5KR10EryckCJiIiIiIiIiIiIiIiIiIiIiIh8GmkRERERERERERERERERERERERGRHSPAAPlXH1phYpYaAAAAAElFTkSuQmCC)"}},display_image:{style:{width:y,height:m,display:A?"block":"none",
position:"absolute",cursor:B,left:0,top:0,margin:0,padding:0,textDecoration:"none",zIndex:1,border:"none"}}};B=function(F,g,j){F=document.createElement(F);F.id=j?j:b.id+"_jwplayer_"+g;a.utils.css(F,s[g].style);return F};p.display=B("a","display",b.id);v&&p.display.setAttribute("href",a.utils.getAbsolutePath(v));p.display_image=B("img","display_image");p.display_image.setAttribute("alt","Click to download...");A&&p.display_image.setAttribute("src",a.utils.getAbsolutePath(A));p.display_icon=B("div",
"display_icon");p.display_iconBackground=B("div","display_iconBackground");p.display.appendChild(p.display_image);p.display_iconBackground.appendChild(p.display_icon);p.display.appendChild(p.display_iconBackground);_css=a.utils.css;_hide=function(F){_css(F,{display:"none"})};p.display_image.onerror=function(){_hide(p.display_image)};p.display_image.onload=o;b.parentNode.replaceChild(p.display,b);p.display.appendChild(new a.embed.logo(e.components.logo,"download",b.id));h.container=document.getElementById(h.id);
h.setPlayer(p.display,"download")};this.supportsConfig=function(){if(e){var o=a.utils.getFirstPlaylistItemFromConfig(e);if(typeof o.file=="undefined"&&typeof o.levels=="undefined")return true;else if(o.file)return l(o.file,o.provider,o.playlistfile);else if(o.levels&&o.levels.length)for(var n=0;n<o.levels.length;n++)if(o.levels[n].file&&l(o.levels[n].file,o.provider,o.playlistfile))return true}else return true}}})(jwplayer);(function(a){a.embed.flash=function(b,c,e,f,h){function l(m,v,A){var B=document.createElement("param");
B.setAttribute("name",v);B.setAttribute("value",A);m.appendChild(B)}function o(m,v,A){return function(){A&&document.getElementById(h.id+"_wrapper").appendChild(v);var B=document.getElementById(h.id).getPluginConfig("display");m.resize(B.width,B.height);a.utils.css(v,{left:B.x,top:B.y})}}function n(m,v){if(m[v]){var A=m[v];for(var B in A){var s=A[B];if(typeof s=="string")m[B]||(m[B]=s);else for(var F in s)m[B+"."+F]||(m[B+"."+F]=s[F])}delete m[v]}}function p(m){if(!m)return{};var v={},A=[];for(var B in m){var s=
a.utils.getPluginName(B),F=m[B];A.push(B);for(var g in F)v[s+"."+g]=F[g]}v.plugins=A.join(",");return v}function y(m){var v=m.netstreambasepath?"":"netstreambasepath="+encodeURIComponent(window.location.href.split("#")[0])+"&";for(var A in m)v+=typeof m[A]=="object"?A+"="+encodeURIComponent("[[JSON]]"+a.utils.strings.jsonToString(m[A]))+"&":A+"="+encodeURIComponent(m[A])+"&";return v.substring(0,v.length-1)}this.embed=function(){e.id=h.id;var m,v=a.utils.extend({},e),A=v.width,B=v.height;if(b.id+
"_wrapper"==b.parentNode.id)document.getElementById(b.id+"_wrapper");else{m=document.createElement("div");m.id=b.id+"_wrapper";a.utils.wrap(b,m);a.utils.css(m,{position:"relative",width:A,height:B})}m=f.setupPlugins(h,v,o);if(m.length>0)a.utils.extend(v,p(m.plugins));else delete v.plugins;m=["height","width","modes","events"];for(A=0;A<m.length;A++)delete v[m[A]];m="opaque";if(v.wmode)m=v.wmode;n(v,"components");n(v,"providers");if(typeof v["dock.position"]!="undefined")if(v["dock.position"].toString().toLowerCase()==
"false"){v.dock=v["dock.position"];delete v["dock.position"]}A=a.utils.getCookies();for(var s in A)if(typeof v[s]=="undefined")v[s]=A[s];if(a.utils.isIE()){s='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" bgcolor="#000000" width="100%" height="100%" id="'+b.id+'" name="'+b.id+'" tabindex=0"">';s+='<param name="movie" value="'+c.src+'">';s+='<param name="allowfullscreen" value="true">';s+='<param name="allowscriptaccess" value="always">';s+='<param name="seamlesstabbing" value="true">';
s+='<param name="wmode" value="'+m+'">';s+='<param name="flashvars" value="'+y(v)+'">';s+="</object>";a.utils.setOuterHTML(b,s);v=document.getElementById(b.id)}else{s=document.createElement("object");s.setAttribute("type","application/x-shockwave-flash");s.setAttribute("data",c.src);s.setAttribute("width","100%");s.setAttribute("height","100%");s.setAttribute("bgcolor","#000000");s.setAttribute("id",b.id);s.setAttribute("name",b.id);s.setAttribute("tabindex",0);l(s,"allowfullscreen","true");l(s,"allowscriptaccess",
"always");l(s,"seamlesstabbing","true");l(s,"wmode",m);l(s,"flashvars",y(v));b.parentNode.replaceChild(s,b);v=s}h.container=v;h.setPlayer(v,"flash")};this.supportsConfig=function(){if(a.utils.hasFlash())if(e){var m=a.utils.getFirstPlaylistItemFromConfig(e);if(typeof m.file=="undefined"&&typeof m.levels=="undefined")return true;else if(m.file)return flashCanPlay(m.file,m.provider);else if(m.levels&&m.levels.length)for(var v=0;v<m.levels.length;v++)if(m.levels[v].file&&flashCanPlay(m.levels[v].file,
m.provider))return true}else return true;return false};flashCanPlay=function(m,v){var A=["video","http","sound","image"];if(v&&A.toString().indexOf(v)<0)return true;m=a.utils.extension(m);if(!m)return true;if(a.utils.exists(a.utils.extensionmap[m])&&!a.utils.exists(a.utils.extensionmap[m].flash))return false;return true}}})(jwplayer);(function(a){a.embed.html5=function(b,c,e,f,h){function l(o,n,p){return function(){var y=document.getElementById(b.id+"_displayarea");p&&y.appendChild(n);o.resize(y.clientWidth,
y.clientHeight);n.left=y.style.left;n.top=y.style.top}}this.embed=function(){if(a.html5){f.setupPlugins(h,e,l);b.innerHTML="";for(var o=a.utils.extend({screencolor:"0x000000"},e),n=["plugins","modes","events"],p=0;p<n.length;p++)delete o[n[p]];if(o.levels&&!o.sources)o.sources=e.levels;if(o.skin&&o.skin.toLowerCase().indexOf(".zip")>0)o.skin=o.skin.replace(/\.zip/i,".xml");o=new (a.html5(b).setup)(o);h.container=document.getElementById(h.id);h.setPlayer(o,"html5")}else return null};this.supportsConfig=
function(){if(a.vid.canPlayType)if(e){var o=a.utils.getFirstPlaylistItemFromConfig(e);if(typeof o.file=="undefined"&&typeof o.levels=="undefined")return true;else if(o.file)return html5CanPlay(a.vid,o.file,o.provider,o.playlistfile);else if(o.levels&&o.levels.length)for(var n=0;n<o.levels.length;n++)if(o.levels[n].file&&html5CanPlay(a.vid,o.levels[n].file,o.provider,o.playlistfile))return true}else return true;return false};html5CanPlay=function(o,n,p,y){if(y)return false;if(p&&p=="youtube")return true;
if(p&&p!="video"&&p!="http"&&p!="sound")return false;if(navigator.userAgent.match(/BlackBerry/i)!==null)return false;n=a.utils.extension(n);if(!a.utils.exists(n)||!a.utils.exists(a.utils.extensionmap[n]))return true;if(!a.utils.exists(a.utils.extensionmap[n].html5))return false;if(a.utils.isLegacyAndroid()&&n.match(/m4v|mp4/))return true;return browserCanPlay(o,a.utils.extensionmap[n].html5)};browserCanPlay=function(o,n){if(!n)return true;return o.canPlayType(n)?true:n=="audio/mp3"&&navigator.userAgent.match(/safari/i)?
o.canPlayType("audio/mpeg"):false}}})(jwplayer);(function(a){a.embed.logo=function(b,c,e){function f(){h();o();n()}function h(){if(v.prefix){var s=a.version.split(/\W/).splice(0,2).join("/");if(v.prefix.indexOf(s)<0)v.prefix+=s+"/"}B=a.utils.extend({},v,b)}function l(){var s={border:"none",textDecoration:"none",position:"absolute",cursor:"pointer",zIndex:10};s.display=B.hide?"none":"block";var F=B.position.toLowerCase().split("-");for(var g in F)s[F[g]]=B.margin;return s}function o(){A=document.createElement("img");
A.id=e+"_jwplayer_logo";A.style.display="none";A.onload=function(){_css(A,l());y()};if(B.file)A.src=B.file.indexOf("http://")===0?B.file:B.prefix+B.file}function n(){if(B.link){A.onmouseover=m;A.onmouseout=y;A.onclick=p}else this.mouseEnabled=false}function p(s){if(typeof s!="undefined"){s.preventDefault();s.stopPropagation()}B.link&&window.open(B.link,B.linktarget)}function y(){if(B.link)A.style.opacity=B.out}function m(){if(B.hide)A.style.opacity=B.over}var v={prefix:"http://l.longtailvideo.com/"+
c+"/",file:"",link:"",linktarget:"_top",margin:8,out:0.5,over:1,timeout:5,hide:false,position:"bottom-left"};_css=a.utils.css;var A,B;f();if(B.file)return A}})(jwplayer);(function(a){a.html5=function(b){this.setup=function(c){a.utils.extend(this,new a.html5.api(b,c));return this};return this}})(jwplayer);(function(a){var b=a.utils,c=b.css,e=b.isIOS();a.html5.view=function(f,h,l){function o(){function O(){if(t.skin.getComponentSettings("display")&&t.skin.getComponentSettings("display").backgroundcolor)return t.skin.getComponentSettings("display").backgroundcolor;
return parseInt("000000",16)}z=document.createElement("div");z.id=w.id;z.className=w.className;_videowrapper=document.createElement("div");_videowrapper.id=z.id+"_video_wrapper";w.id=z.id+"_video";c(z,{position:"relative",height:r.height,width:r.width,padding:0,backgroundColor:O(),zIndex:0});c(w,{width:"100%",height:"100%",top:0,left:0,zIndex:1,margin:"auto",display:"block"});c(_videowrapper,{overflow:"hidden",position:"absolute",top:0,left:0,bottom:0,right:0});b.wrap(w,z);b.wrap(w,_videowrapper);
C=document.createElement("div");C.id=z.id+"_displayarea";z.appendChild(C);_instreamArea=document.createElement("div");_instreamArea.id=z.id+"_instreamarea";c(_instreamArea,{overflow:"hidden",position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:100,background:"000000",display:"none"});z.appendChild(_instreamArea)}function n(){for(var O=0;O<r.plugins.order.length;O++){var U=r.plugins.order[O];if(b.exists(r.plugins.object[U].getDisplayElement)){r.plugins.object[U].height=b.parseDimension(r.plugins.object[U].getDisplayElement().style.height);
r.plugins.object[U].width=b.parseDimension(r.plugins.object[U].getDisplayElement().style.width);r.plugins.config[U].currentPosition=r.plugins.config[U].position}}m()}function p(){S=r.fullscreen}function y(O){if(!N){switch(O.newstate){case a.api.events.state.PLAYING:if(r.getMedia()&&r.getMedia().hasChrome())C.style.display="none";break;default:C.style.display="block";break}Q()}}function m(){var O=r.getMedia()?r.getMedia().getDisplayElement():null;if(b.exists(O)){if(T!=O){T&&T.parentNode&&T.parentNode.replaceChild(O,
T);T=O}for(O=0;O<r.plugins.order.length;O++){var U=r.plugins.order[O];if(b.exists(r.plugins.object[U].getDisplayElement))r.plugins.config[U].currentPosition=r.plugins.config[U].position}}A(r.width,r.height)}function v(O){switch(O.keyCode){case 27:t.jwGetFullscreen()&&t.jwSetFullscreen(false);break;case 32:t.jwGetState()!=a.api.events.state.IDLE&&t.jwGetState()!=a.api.events.state.PAUSED?t.jwPause():t.jwPlay();break}}function A(O,U){if(z.style.display!="none"){var X=[].concat(r.plugins.order);X.reverse();
L=X.length+2;if(S&&q())try{if(r.fullscreen&&!r.getMedia().getDisplayElement().webkitDisplayingFullscreen)r.fullscreen=false}catch(G){}if(r.fullscreen)!q()&&!e&&B(g,X,true);else{H=O;u=U;H=typeof O=="string"&&O.indexOf("%")>0?b.getElementWidth(b.parentNode(z))*parseInt(O.replace("%"),"")/100:O;u=typeof U=="string"&&U.indexOf("%")>0?b.getElementHeight(b.parentNode(z))*parseInt(U.replace("%"),"")/100:U;O={top:0,bottom:0,left:0,right:0,width:H,height:u,position:"absolute"};c(C,O);U={};var M;try{M=r.plugins.object.display.getDisplayElement()}catch(W){}if(M){U.width=
b.parseDimension(M.style.width);U.height=b.parseDimension(M.style.height)}M=b.extend({},O,U,{zIndex:_instreamArea.style.zIndex,display:_instreamArea.style.display});c(_instreamArea,M);c(z,{height:u,width:H});X=B(s,X);if(X.length>0){L+=X.length;M=X.indexOf("playlist");O=X.indexOf("controlbar");if(M>=0&&O>=0)X[M]=X.splice(O,1,X[M])[0];B(F,X,true)}J=b.getElementWidth(C);I=b.getElementHeight(C)}Q()}}function B(O,U,X){R=0;for(var G=[],M=0;M<U.length;M++){var W=U[M];if(b.exists(r.plugins.object[W].getDisplayElement))if(r.plugins.config[W].currentPosition!=
a.html5.view.positions.NONE){var ba=O(W,L--);if(ba){var D=ba.width,K=ba.height;if(X){delete ba.width;delete ba.height}c(r.plugins.object[W].getDisplayElement(),ba);r.plugins.object[W].resize(D,K)}else G.push(W)}else c(r.plugins.object[W].getDisplayElement(),{display:"none"})}return G}function s(O,U){if(b.exists(r.plugins.object[O].getDisplayElement))if(r.plugins.config[O].position&&j(r.plugins.config[O].position)){b.exists(r.plugins.object[O].getDisplayElement().parentNode)||z.appendChild(r.plugins.object[O].getDisplayElement());
O=da(O);O.zIndex=U;return O}return false}function F(O,U){b.exists(r.plugins.object[O].getDisplayElement().parentNode)||C.appendChild(r.plugins.object[O].getDisplayElement());return{position:"absolute",width:b.getElementWidth(C)-b.parseDimension(C.style.right),height:b.getElementHeight(C)-b.parseDimension(C.style.bottom),zIndex:U}}function g(O,U){return{position:"fixed",width:r.width,height:r.height,zIndex:U}}function j(O){return[a.html5.view.positions.TOP,a.html5.view.positions.RIGHT,a.html5.view.positions.BOTTOM,
a.html5.view.positions.LEFT].toString().indexOf(O.toUpperCase())>-1}function q(){if(t.jwGetState()!=a.api.events.state.IDLE&&!E&&r.getMedia()&&r.getMedia().getDisplayElement()&&r.getMedia().getDisplayElement().webkitSupportsFullscreen&&b.useNativeFullscreen())return true;return false}var t=f,w=h,r=l,z,H,u,C,L,T,E=false,S=false,J,I,N,Y;this.setup=function(){if(r&&r.getMedia())w=r.getMedia().getDisplayElement();o();n();t.jwAddEventListener(a.api.events.JWPLAYER_PLAYER_STATE,y);t.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_LOADED,
m);t.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_BEFOREPLAY,p);t.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_META,function(){Q()});var O;if(b.exists(window.onresize))O=window.onresize;window.onresize=function(U){if(b.exists(O))try{O(U)}catch(X){}if(t.jwGetFullscreen()){if(!q()){U=b.getBoundingClientRect(document.body);r.width=Math.abs(U.left)+Math.abs(U.right);r.height=window.innerHeight;A(r.width,r.height)}}else A(r.width,r.height)}};var R,Q=this.resizeMedia=function(){C.style.position="absolute";
var O=r.getMedia()?r.getMedia().getDisplayElement():Y;if(O)if(O&&O.tagName.toLowerCase()=="video")if(!O.videoWidth||!O.videoHeight){O.style.width=C.style.width;O.style.height=C.style.height}else{O.style.position="absolute";b.fadeTo(O,1,0.25);if(O.parentNode){O.parentNode.style.left=C.style.left;O.parentNode.style.top=C.style.top}if(r.fullscreen&&t.jwGetStretching()==a.utils.stretching.EXACTFIT&&!b.isMobile()){var U=document.createElement("div");b.stretch(a.utils.stretching.UNIFORM,U,b.getElementWidth(C),
b.getElementHeight(C),J,I);b.stretch(a.utils.stretching.EXACTFIT,O,b.parseDimension(U.style.width),b.parseDimension(U.style.height),O.videoWidth?O.videoWidth:400,O.videoHeight?O.videoHeight:300);c(O,{left:U.style.left,top:U.style.top})}else e||b.stretch(t.jwGetStretching(),O,b.getElementWidth(C),b.getElementHeight(C),O.videoWidth?O.videoWidth:400,O.videoHeight?O.videoHeight:300)}else(O=r.plugins.object.display.getDisplayElement())?r.getMedia().resize(b.parseDimension(O.style.width),b.parseDimension(O.style.height)):
r.getMedia().resize(b.parseDimension(C.style.width),b.parseDimension(C.style.height))},da=this.getComponentPosition=function(O){var U={position:"absolute",margin:0,padding:0,top:null},X=r.plugins.config[O].currentPosition.toLowerCase();switch(X.toUpperCase()){case a.html5.view.positions.TOP:U.top=b.parseDimension(C.style.top);U.left=b.parseDimension(C.style.left);U.width=b.getElementWidth(C)-b.parseDimension(C.style.left)-b.parseDimension(C.style.right);U.height=r.plugins.object[O].height;C.style[X]=
b.parseDimension(C.style[X])+r.plugins.object[O].height+"px";C.style.height=b.getElementHeight(C)-U.height+"px";break;case a.html5.view.positions.RIGHT:U.top=b.parseDimension(C.style.top);U.right=b.parseDimension(C.style.right);U.width=r.plugins.object[O].width;U.height=b.getElementHeight(C)-b.parseDimension(C.style.top)-b.parseDimension(C.style.bottom);C.style.width=b.getElementWidth(C)-U.width+"px";break;case a.html5.view.positions.BOTTOM:U.left=b.parseDimension(C.style.left);U.width=b.getElementWidth(C)-
b.parseDimension(C.style.left)-b.parseDimension(C.style.right);U.height=r.plugins.object[O].height;U.bottom=b.parseDimension(C.style.bottom+R);R+=U.height;C.style.height=b.getElementHeight(C)-U.height+"px";break;case a.html5.view.positions.LEFT:U.top=b.parseDimension(C.style.top);U.left=b.parseDimension(C.style.left);U.width=r.plugins.object[O].width;U.height=b.getElementHeight(C)-b.parseDimension(C.style.top)-b.parseDimension(C.style.bottom);C.style[X]=b.parseDimension(C.style[X])+r.plugins.object[O].width+
"px";C.style.width=b.getElementWidth(C)-U.width+"px";break;default:break}return U};this.resize=A;var Z,ga,V;this.fullscreen=function(O){if(!e){var U;try{U=r.getMedia().getDisplayElement()}catch(X){}if(O){ga=r.width;V=r.height}var G={position:"fixed",width:"100%",height:"100%",top:0,left:0,zIndex:2147483E3},M={position:"relative",height:ga,width:V,zIndex:0};if(q()&&U&&U.webkitSupportsFullscreen){if(O&&!U.webkitDisplayingFullscreen)try{c(U,G);b.transform(U);Z=C.style.display;C.style.display="none";
U.webkitEnterFullscreen()}catch(W){}else if(!O){c(U,M);Q();if(U.webkitDisplayingFullscreen)try{U.webkitExitFullscreen()}catch(ba){}C.style.display=Z}E=false}else{if(O){document.onkeydown=v;clearInterval(void 0);O=b.getBoundingClientRect(document.body);r.width=Math.abs(O.left)+Math.abs(O.right);r.height=window.innerHeight;c(z,G);G.zIndex=1;r.getMedia()&&r.getMedia().getDisplayElement()&&c(r.getMedia().getDisplayElement(),G);G.zIndex=2;c(C,G);E=true}else{document.onkeydown="";r.width=H;r.height=u;c(z,
M);E=false}A(r.width,r.height)}}};this.setupInstream=function(O,U){b.css(_instreamArea,{display:"block",position:"absolute"});C.style.display="none";_instreamArea.appendChild(O);Y=U;N=true};this.destroyInstream=function(){_instreamArea.style.display="none";_instreamArea.innerHTML="";C.style.display="block";Y=null;N=false;A(r.width,r.height)}};a.html5.view.positions={TOP:"TOP",RIGHT:"RIGHT",BOTTOM:"BOTTOM",LEFT:"LEFT",OVER:"OVER",NONE:"NONE"}})(jwplayer);(function(a){var b={backgroundcolor:"",margin:10,
font:"Arial,sans-serif",fontsize:10,fontcolor:parseInt("000000",16),fontstyle:"normal",fontweight:"bold",buttoncolor:parseInt("ffffff",16),position:a.html5.view.positions.BOTTOM,idlehide:false,hideplaylistcontrols:false,forcenextprev:false,layout:{left:{position:"left",elements:[{name:"play",type:"button"},{name:"divider",type:"divider"},{name:"prev",type:"button"},{name:"divider",type:"divider"},{name:"next",type:"button"},{name:"divider",type:"divider"},{name:"elapsed",type:"text"}]},center:{position:"center",
elements:[{name:"time",type:"slider"}]},right:{position:"right",elements:[{name:"duration",type:"text"},{name:"blank",type:"button"},{name:"divider",type:"divider"},{name:"mute",type:"button"},{name:"volume",type:"slider"},{name:"divider",type:"divider"},{name:"fullscreen",type:"button"}]}}};_utils=a.utils;_css=_utils.css;_hide=function(c){_css(c,{display:"none"})};_show=function(c){_css(c,{display:"block"})};a.html5.controlbar=function(c,e){function f(){if(!oa)(oa=Q.skin.getSkinElement("controlbar",
"background"))||(oa={width:0,height:0,src:null});return oa}function h(){ga=O=V=0;if(!ea){var P={height:f().height,backgroundColor:da.backgroundcolor};Z=document.createElement("div");Z.id=Q.id+"_jwplayer_controlbar";_css(Z,P)}P=Q.skin.getSkinElement("controlbar","capLeft");var aa=Q.skin.getSkinElement("controlbar","capRight");P&&g("capLeft","left",false,Z);v("background",Z,{position:"absolute",height:f().height,left:P?P.width:0,zIndex:0},"img");if(f().src)K.background.src=f().src;v("elements",Z,{position:"relative",
height:f().height,zIndex:1});aa&&g("capRight","right",false,Z)}function l(){var P=["timeSlider","volumeSlider","timeSliderRail","volumeSliderRail"];for(var aa in P){var ca=P[aa];if(typeof K[ca]!="undefined")ha[ca]=_utils.getBoundingClientRect(K[ca])}}function o(P){if(!ma){clearTimeout(na);if(da.position==a.html5.view.positions.OVER||Q.jwGetFullscreen())switch(Q.jwGetState()){case a.api.events.state.PAUSED:case a.api.events.state.IDLE:if(Z&&Z.style.opacity<1&&(!da.idlehide||_utils.exists(P))){ua=false;
setTimeout(function(){ua||p()},100)}if(da.idlehide)na=setTimeout(function(){n()},2E3);break;default:ua=true;P&&p();na=setTimeout(function(){n()},2E3);break}else p()}}function n(){if(!ma){wa();if(Z.style.opacity==1){_utils.cancelAnimation(Z);_utils.fadeTo(Z,0,0.1,1,0)}}}function p(){if(!ma){va();if(Z.style.opacity==0){_utils.cancelAnimation(Z);_utils.fadeTo(Z,1,0.1,0,0)}}}function y(P){return function(){if(pa&&la!=P){la=P;xa.sendEvent(P,{component:"controlbar",boundingRect:m()})}}}function m(){return da.position==
a.html5.view.positions.OVER||Q.jwGetFullscreen()?_utils.getDimensions(Z):{x:0,y:0,width:0,height:0}}function v(P,aa,ca,fa){if(ea)fa=document.getElementById(Z.id+"_"+P);else{fa||(fa="div");fa=document.createElement(fa);K[P]=fa;fa.id=Z.id+"_"+P;aa.appendChild(fa)}_utils.exists(ca)&&_css(fa,ca);return fa}function A(){if(Q.jwGetHeight()<=40){da.layout=_utils.clone(da.layout);for(var P=0;P<da.layout.left.elements.length;P++)da.layout.left.elements[P].name=="fullscreen"&&da.layout.left.elements.splice(P,
1);for(P=0;P<da.layout.right.elements.length;P++)da.layout.right.elements[P].name=="fullscreen"&&da.layout.right.elements.splice(P,1);S()}B(da.layout.left);B(da.layout.center);B(da.layout.right)}function B(P,aa){var ca=P.position=="right"?"right":"left",fa=_utils.extend([],P.elements);_utils.exists(aa)&&fa.reverse();P=v(P.position+"Group",K.elements,{"float":"left",styleFloat:"left",cssFloat:"left",height:"100%"});for(aa=0;aa<fa.length;aa++)F(fa[aa],ca,P)}function s(){return ga++}function F(P,aa,
ca){var fa;if(!ca)ca=K.elements;if(P.type=="divider")g("divider"+s(),aa,true,ca,undefined,P.width,P.element);else switch(P.name){case "play":g("playButton",aa,false,ca);g("pauseButton",aa,true,ca);r("playButton","jwPlay");r("pauseButton","jwPause");break;case "prev":g("prevButton",aa,true,ca);r("prevButton","jwPlaylistPrev");break;case "stop":g("stopButton",aa,true,ca);r("stopButton","jwStop");break;case "next":g("nextButton",aa,true,ca);r("nextButton","jwPlaylistNext");break;case "elapsed":g("elapsedText",
aa,true,ca,null,null,Q.skin.getSkinElement("controlbar","elapsedBackground"));break;case "time":!_utils.exists(Q.skin.getSkinElement("controlbar","timeSliderCapLeft"))||Q.skin.getSkinElement("controlbar","timeSliderCapLeft");!_utils.exists(Q.skin.getSkinElement("controlbar","timeSliderCapRight"))||Q.skin.getSkinElement("controlbar","timeSliderCapRight");P={height:f().height,position:"relative","float":"left",styleFloat:"left",cssFloat:"left"};ca=v("timeSlider",ca,P);g("timeSliderCapLeft",aa,true,
ca,"relative");g("timeSliderRail",aa,false,ca,"relative");g("timeSliderBuffer",aa,false,ca,"absolute");g("timeSliderProgress",aa,false,ca,"absolute");g("timeSliderThumb",aa,false,ca,"absolute");g("timeSliderCapRight",aa,true,ca,"relative");z("time");break;case "fullscreen":g("fullscreenButton",aa,false,ca);g("normalscreenButton",aa,true,ca);r("fullscreenButton","jwSetFullscreen",true);r("normalscreenButton","jwSetFullscreen",false);break;case "volume":P=!_utils.exists(Q.skin.getSkinElement("controlbar",
"volumeSliderCapLeft"))?0:Q.skin.getSkinElement("controlbar","volumeSliderCapLeft").width;fa=!_utils.exists(Q.skin.getSkinElement("controlbar","volumeSliderCapRight"))?0:Q.skin.getSkinElement("controlbar","volumeSliderCapRight").width;P=Q.skin.getSkinElement("controlbar","volumeSliderRail").width+P+fa;P={height:f().height,position:"relative",width:P,"float":"left",styleFloat:"left",cssFloat:"left"};ca=v("volumeSlider",ca,P);g("volumeSliderCapLeft",aa,false,ca,"relative");g("volumeSliderRail",aa,false,
ca,"relative");g("volumeSliderProgress",aa,false,ca,"absolute");g("volumeSliderThumb",aa,false,ca,"absolute");g("volumeSliderCapRight",aa,false,ca,"relative");z("volume");break;case "mute":g("muteButton",aa,false,ca);g("unmuteButton",aa,true,ca);r("muteButton","jwSetMute",true);r("unmuteButton","jwSetMute",false);break;case "duration":g("durationText",aa,true,ca,null,null,Q.skin.getSkinElement("controlbar","durationBackground"));break}}function g(P,aa,ca,fa,ia,ka,ta){if(_utils.exists(Q.skin.getSkinElement("controlbar",
P))||P.indexOf("Text")>0||P.indexOf("divider")===0){ia={height:"100%",position:ia?ia:"relative",display:"block","float":"left",styleFloat:"left",cssFloat:"left"};if((P.indexOf("next")===0||P.indexOf("prev")===0)&&(Q.jwGetPlaylist().length<2||da.hideplaylistcontrols.toString()=="true"))if(da.forcenextprev.toString()!="true"){ca=false;ia.display="none"}var ra;if(P.indexOf("Text")>0){P.innerhtml="00:00";ia.font=da.fontsize+"px/"+(f().height+1)+"px "+da.font;ia.color=da.fontcolor;ia.textAlign="center";
ia.fontWeight=da.fontweight;ia.fontStyle=da.fontstyle;ia.cursor="default";if(ta){ia.background="url("+ta.src+") no-repeat center";ia.backgroundSize="100% "+f().height+"px"}ia.padding="0 5px"}else if(P.indexOf("divider")===0)if(ka)isNaN(parseInt(ka))||(ra=parseInt(ka));else if(ta){if(ka=Q.skin.getSkinElement("controlbar",ta)){ia.background="url("+ka.src+") repeat-x center left";ra=ka.width}}else{ia.background="url("+Q.skin.getSkinElement("controlbar","divider").src+") repeat-x center left";ra=Q.skin.getSkinElement("controlbar",
"divider").width}else{ia.background="url("+Q.skin.getSkinElement("controlbar",P).src+") repeat-x center left";ra=Q.skin.getSkinElement("controlbar",P).width}if(aa=="left"){if(ca)V+=ra}else if(aa=="right")if(ca)O+=ra;if(_utils.typeOf(fa)=="undefined")fa=K.elements;ia.width=ra;if(ea)_css(K[P],ia);else{var sa=v(P,fa,ia);if(_utils.exists(Q.skin.getSkinElement("controlbar",P+"Over"))){sa.onmouseover=function(){sa.style.backgroundImage=["url(",Q.skin.getSkinElement("controlbar",P+"Over").src,")"].join("")};
sa.onmouseout=function(){sa.style.backgroundImage=["url(",Q.skin.getSkinElement("controlbar",P).src,")"].join("")}}P.indexOf("divider")==0&&sa.setAttribute("class","divider");sa.innerHTML="&nbsp;"}}}function j(){Q.jwAddEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,q);Q.jwAddEventListener(a.api.events.JWPLAYER_PLAYLIST_ITEM,t);Q.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_BUFFER,u);Q.jwAddEventListener(a.api.events.JWPLAYER_PLAYER_STATE,L);Q.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_TIME,
E);Q.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_MUTE,C);Q.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_VOLUME,N);Q.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_COMPLETE,T)}function q(){if(!da.hideplaylistcontrols){if(Q.jwGetPlaylist().length>1||da.forcenextprev.toString()=="true"){_show(K.nextButton);_show(K.prevButton)}else{_hide(K.nextButton);_hide(K.prevButton)}I();w()}}function t(P){M=Q.jwGetPlaylist()[P.index].duration;ja=-1;E({id:Q.id,duration:M,position:0});u({id:Q.id,bufferProgress:0})}
function w(){E({id:Q.id,duration:Q.jwGetDuration(),position:0});u({id:Q.id,bufferProgress:0});C({id:Q.id,mute:Q.jwGetMute()});L({id:Q.id,newstate:a.api.events.state.IDLE});N({id:Q.id,volume:Q.jwGetVolume()})}function r(P,aa,ca){if(!ea)if(_utils.exists(Q.skin.getSkinElement("controlbar",P))){P=K[P];if(_utils.exists(P)){_css(P,{cursor:"pointer"});P.onmouseup=aa=="fullscreen"?function(fa){fa.stopPropagation();Q.jwSetFullscreen(!Q.jwGetFullscreen())}:function(fa){fa.stopPropagation();_utils.exists(ca)?
Q[aa](ca):Q[aa]()}}}}function z(P){if(!ea){var aa=K[P+"Slider"];_css(K.elements,{cursor:"pointer"});_css(aa,{cursor:"pointer"});aa.onmousedown=function(){U=P};aa.onmouseup=function(ca){ca.stopPropagation();H(ca.pageX)};aa.onmousemove=function(ca){if(U=="time"){X=true;_css(K[U+"SliderThumb"],{left:ca.pageX-ha[P+"Slider"].left-window.pageXOffset})}}}}function H(P){X=false;if(U=="time"){P=P-ha.timeSliderRail.left+window.pageXOffset;P=P/ha.timeSliderRail.width*M;if(P<0)P=0;else if(P>M)P=M-3;if(Q.jwGetState()==
a.api.events.state.PAUSED||Q.jwGetState()==a.api.events.state.IDLE)Q.jwPlay();Q.jwSeek(P)}else if(U=="volume"){P=P-ha.volumeSliderRail.left-window.pageXOffset;P=Math.round(P/ha.volumeSliderRail.width*100);if(P<10)P=0;else if(P>100)P=100;Q.jwGetMute()&&Q.jwSetMute(false);Q.jwSetVolume(P)}U="none"}function u(P){if(_utils.exists(P.bufferPercent))W=P.bufferPercent;if(ha.timeSliderRail){P=Q.skin.getSkinElement("controlbar","timeSliderCapLeft");var aa=ha.timeSliderRail.width;aa=isNaN(Math.round(aa*W/100))?
0:Math.round(aa*W/100);_css(K.timeSliderBuffer,{width:aa,left:P?P.width:0})}}function C(P){if(P.mute){_hide(K.muteButton);_show(K.unmuteButton);_hide(K.volumeSliderProgress)}else{_show(K.muteButton);_hide(K.unmuteButton);_show(K.volumeSliderProgress)}}function L(P){if(P.newstate==a.api.events.state.BUFFERING||P.newstate==a.api.events.state.PLAYING){_show(K.pauseButton);_hide(K.playButton)}else{_hide(K.pauseButton);_show(K.playButton)}o();if(P.newstate==a.api.events.state.IDLE){_hide(K.timeSliderBuffer);
_hide(K.timeSliderProgress);_hide(K.timeSliderThumb);E({id:Q.id,duration:Q.jwGetDuration(),position:0})}else{_show(K.timeSliderBuffer);if(P.newstate!=a.api.events.state.BUFFERING){_show(K.timeSliderProgress);_show(K.timeSliderThumb)}}}function T(P){u({bufferPercent:0});E(_utils.extend(P,{position:0,duration:M}))}function E(P){if(_utils.exists(P.position))G=P.position;var aa=false;if(_utils.exists(P.duration)&&P.duration!=M){M=P.duration;aa=true}P=G===M===0?0:G/M;var ca=ha.timeSliderRail;if(ca){P=
isNaN(Math.round(ca.width*P))?0:Math.round(ca.width*P);ca=Q.skin.getSkinElement("controlbar","timeSliderCapLeft");var fa=P+(ca?ca.width:0);if(K.timeSliderProgress){_css(K.timeSliderProgress,{width:P,left:ca?ca.width:0});if(!X)if(K.timeSliderThumb)K.timeSliderThumb.style.left=fa+"px"}}if(K.durationText)K.durationText.innerHTML=_utils.timeFormat(M);if(K.elapsedText){P=_utils.timeFormat(G);K.elapsedText.innerHTML=P;if(ja!=P.length){aa=true;ja=P.length}}aa&&I()}function S(){for(var P=K.elements.childNodes,
aa,ca,fa=0;fa<P.length;fa++){var ia=P[fa].childNodes;for(var ka in ia)if(!isNaN(parseInt(ka,10))){if(ia[ka].id.indexOf(Z.id+"_divider")===0&&ca&&ca.id.indexOf(Z.id+"_divider")===0&&ia[ka].style.backgroundImage==ca.style.backgroundImage)ia[ka].style.display="none";else if(ia[ka].id.indexOf(Z.id+"_divider")===0&&aa&&aa.style.display!="none")ia[ka].style.display="block";if(ia[ka].style.display!="none")ca=ia[ka];aa=ia[ka]}}}function J(){if(Q.jwGetFullscreen()){_show(K.normalscreenButton);_hide(K.fullscreenButton)}else{_hide(K.normalscreenButton);
_show(K.fullscreenButton)}if(Q.jwGetState()==a.api.events.state.BUFFERING||Q.jwGetState()==a.api.events.state.PLAYING){_show(K.pauseButton);_hide(K.playButton)}else{_hide(K.pauseButton);_show(K.playButton)}if(Q.jwGetMute()==true){_hide(K.muteButton);_show(K.unmuteButton);_hide(K.volumeSliderProgress)}else{_show(K.muteButton);_hide(K.unmuteButton);_show(K.volumeSliderProgress)}}function I(){S();J();var P={width:ba},aa={"float":"left",styleFloat:"left",cssFloat:"left"};if(da.position==a.html5.view.positions.OVER||
Q.jwGetFullscreen()){P.left=da.margin;P.width-=2*da.margin;P.top=D-f().height-da.margin;P.height=f().height}var ca=Q.skin.getSkinElement("controlbar","capLeft"),fa=Q.skin.getSkinElement("controlbar","capRight");aa.width=P.width-(ca?ca.width:0)-(fa?fa.width:0);ca=_utils.getBoundingClientRect(K.leftGroup).width;fa=_utils.getBoundingClientRect(K.rightGroup).width;fa=ca=aa.width-ca-fa-1;var ia=Q.skin.getSkinElement("controlbar","timeSliderCapLeft"),ka=Q.skin.getSkinElement("controlbar","timeSliderCapRight");
if(_utils.exists(ia))fa-=ia.width;if(_utils.exists(ka))fa-=ka.width;K.timeSlider.style.width=ca+"px";K.timeSliderRail.style.width=fa+"px";_css(Z,P);_css(K.elements,aa);_css(K.background,aa);l();return P}function N(P){if(_utils.exists(K.volumeSliderRail)){var aa=isNaN(P.volume/100)?1:P.volume/100;P=_utils.parseDimension(K.volumeSliderRail.style.width);aa=isNaN(Math.round(P*aa))?0:Math.round(P*aa);_utils.parseDimension(K.volumeSliderRail.style.right);var ca=!_utils.exists(Q.skin.getSkinElement("controlbar",
"volumeSliderCapLeft"))?0:Q.skin.getSkinElement("controlbar","volumeSliderCapLeft").width;_css(K.volumeSliderProgress,{width:aa,left:ca});if(K.volumeSliderThumb){aa=aa-Math.round(_utils.parseDimension(K.volumeSliderThumb.style.width)/2);aa=Math.min(Math.max(aa,0),P-_utils.parseDimension(K.volumeSliderThumb.style.width));_css(K.volumeSliderThumb,{left:aa})}_utils.exists(K.volumeSliderCapLeft)&&_css(K.volumeSliderCapLeft,{left:0})}}function Y(){try{var P=Q.id.indexOf("_instream")>0?Q.id.replace("_instream",
""):Q.id;ya=document.getElementById(P);ya.addEventListener("mousemove",o)}catch(aa){_utils.log("Could not add mouse listeners to controlbar: "+aa)}}function R(){h();A();l();ea=true;j();da.idlehide=da.idlehide.toString().toLowerCase()=="true";if(da.position==a.html5.view.positions.OVER&&da.idlehide){Z.style.opacity=0;pa=true}else{Z.style.opacity=1;setTimeout(function(){pa=true;va()},1)}Y();w()}window.controlbar=this;var Q=c,da=_utils.extend({},b,Q.skin.getComponentSettings("controlbar"),e);if(!(da.position==
a.html5.view.positions.NONE||typeof a.html5.view.positions[da.position]=="undefined")){if(_utils.mapLength(Q.skin.getComponentLayout("controlbar"))>0)da.layout=Q.skin.getComponentLayout("controlbar");var Z,ga,V,O,U="none",X,G,M,W,ba,D,K={},ea=false,ha={},ja=-1,oa,ma=false,na,la,pa=false,qa=false,ya,xa=new a.html5.eventdispatcher;_utils.extend(this,xa);this.getDisplayElement=function(){return Z};this.resize=function(P,aa){Y();_utils.cancelAnimation(Z);ba=P;D=aa;if(qa!=Q.jwGetFullscreen()){(qa=Q.jwGetFullscreen())||
o();la=undefined}P=I();E({id:Q.id,duration:M,position:G});u({id:Q.id,bufferPercent:W});return P};this.show=function(){if(ma){ma=false;_show(Z);va()}};this.hide=function(){if(!ma){ma=true;_hide(Z);wa()}};var ua,va=y(a.api.events.JWPLAYER_COMPONENT_SHOW),wa=y(a.api.events.JWPLAYER_COMPONENT_HIDE);R();return this}}})(jwplayer);(function(a){var b=a.utils;a.html5.controller=function(c,e,f,h){function l(V){da?Z.sendEvent(V.type,V):Q.push(V)}function o(V){if(!da){da=true;Z.sendEvent(a.api.events.JWPLAYER_READY,
V);a.utils.exists(window.playerReady)&&playerReady(V);for(a.utils.exists(window[f.config.playerReady])&&window[f.config.playerReady](V);Q.length>0;){V=Q.shift();Z.sendEvent(V.type,V)}for(f.config.autostart&&!a.utils.isIOS()&&r();ga.length>0;){V=ga.shift();T(V.method,V.arguments)}}}function n(){try{R=n;if(!N){N=true;Z.sendEvent(a.api.events.JWPLAYER_MEDIA_BEFOREPLAY);N=false;if(Y){Y=false;R=null;return}}F(E.item);if(E.playlist[E.item].levels[0].file.length>0)if(J||E.state==a.api.events.state.IDLE){E.getMedia().load(E.playlist[E.item]);
J=false}else E.state==a.api.events.state.PAUSED&&E.getMedia().play();return true}catch(V){Z.sendEvent(a.api.events.JWPLAYER_ERROR,V);R=null}return false}function p(){try{if(E.playlist[E.item].levels[0].file.length>0)switch(E.state){case a.api.events.state.PLAYING:case a.api.events.state.BUFFERING:E.getMedia()&&E.getMedia().pause();break;default:if(N)Y=true}return true}catch(V){Z.sendEvent(a.api.events.JWPLAYER_ERROR,V)}return false}function y(V){try{if(E.playlist[E.item].levels[0].file.length>0){if(typeof V!=
"number")V=parseFloat(V);switch(E.state){case a.api.events.state.IDLE:if(I<0){I=E.playlist[E.item].start;E.playlist[E.item].start=V}N||n();break;case a.api.events.state.PLAYING:case a.api.events.state.PAUSED:case a.api.events.state.BUFFERING:E.seek(V);break}}return true}catch(O){Z.sendEvent(a.api.events.JWPLAYER_ERROR,O)}return false}function m(V){R=null;b.exists(V)||(V=true);try{if((E.state!=a.api.events.state.IDLE||V)&&E.getMedia())E.getMedia().stop(V);if(N)Y=true;return true}catch(O){Z.sendEvent(a.api.events.JWPLAYER_ERROR,
O)}return false}function v(){try{if(E.playlist[E.item].levels[0].file.length>0)if(E.config.shuffle)F(B());else E.item+1==E.playlist.length?F(0):F(E.item+1);if(E.state!=a.api.events.state.IDLE){var V=E.state;E.state=a.api.events.state.IDLE;Z.sendEvent(a.api.events.JWPLAYER_PLAYER_STATE,{oldstate:V,newstate:a.api.events.state.IDLE})}n();return true}catch(O){Z.sendEvent(a.api.events.JWPLAYER_ERROR,O)}return false}function A(){try{if(E.playlist[E.item].levels[0].file.length>0)if(E.config.shuffle)F(B());
else E.item===0?F(E.playlist.length-1):F(E.item-1);if(E.state!=a.api.events.state.IDLE){var V=E.state;E.state=a.api.events.state.IDLE;Z.sendEvent(a.api.events.JWPLAYER_PLAYER_STATE,{oldstate:V,newstate:a.api.events.state.IDLE})}n();return true}catch(O){Z.sendEvent(a.api.events.JWPLAYER_ERROR,O)}return false}function B(){var V=null;if(E.playlist.length>1)for(;!b.exists(V);){V=Math.floor(Math.random()*E.playlist.length);if(V==E.item)V=null}else V=0;return V}function s(V){if(!E.playlist||!E.playlist[V])return false;
try{if(E.playlist[V].levels[0].file.length>0){if(E.state!==a.api.events.state.IDLE)E.playlist[E.item]&&E.playlist[E.item].provider==E.playlist[V].provider?m(false):m();F(V);n()}return true}catch(O){Z.sendEvent(a.api.events.JWPLAYER_ERROR,O)}return false}function F(V){if(E.playlist[V]){E.setActiveMediaProvider(E.playlist[V]);if(E.item!=V){E.item=V;J=true;Z.sendEvent(a.api.events.JWPLAYER_PLAYLIST_ITEM,{index:V})}}}function g(V){try{F(E.item);var O=E.getMedia();switch(typeof V){case "number":O.volume(V);
break;case "string":O.volume(parseInt(V,10));break}E.setVolume(V);return true}catch(U){Z.sendEvent(a.api.events.JWPLAYER_ERROR,U)}return false}function j(V){try{F(E.item);var O=E.getMedia();if(typeof V=="undefined"){O.mute(!E.mute);E.setMute(!E.mute)}else if(V.toString().toLowerCase()=="true"){O.mute(true);E.setMute(true)}else{O.mute(false);E.setMute(false)}return true}catch(U){Z.sendEvent(a.api.events.JWPLAYER_ERROR,U)}return false}function q(V,O){try{E.width=V;E.height=O;S.resize(V,O);Z.sendEvent(a.api.events.JWPLAYER_RESIZE,
{width:E.width,height:E.height});return true}catch(U){Z.sendEvent(a.api.events.JWPLAYER_ERROR,U)}return false}function t(V,O){try{if(typeof V=="undefined")V=!E.fullscreen;if(typeof O=="undefined")O=true;if(V!=E.fullscreen){E.fullscreen=V.toString().toLowerCase()=="true";S.fullscreen(E.fullscreen);O&&Z.sendEvent(a.api.events.JWPLAYER_FULLSCREEN,{fullscreen:E.fullscreen});Z.sendEvent(a.api.events.JWPLAYER_RESIZE,{width:E.width,height:E.height})}return true}catch(U){Z.sendEvent(a.api.events.JWPLAYER_ERROR,
U)}return false}function w(V){try{m();if(N)Y=false;E.loadPlaylist(V);if(E.playlist[E.item].provider){F(E.item);E.config.autostart.toString().toLowerCase()=="true"&&!b.isIOS()&&!N&&n();return true}else return false}catch(O){Z.sendEvent(a.api.events.JWPLAYER_ERROR,O)}return false}function r(){if(!b.isIOS()){F(E.item);E.config.autostart.toString().toLowerCase()=="true"&&!b.isIOS()&&n()}}function z(V){t(V.fullscreen,false)}function H(){try{return E.getMedia().detachMedia()}catch(V){return null}}function u(){try{E.getMedia().attachMedia();
typeof R=="function"&&R()}catch(V){return null}}function C(){if(E.state==a.api.events.state.IDLE){R=C;switch(E.config.repeat.toUpperCase()){case a.html5.controller.repeatoptions.SINGLE:n();break;case a.html5.controller.repeatoptions.ALWAYS:E.item==E.playlist.length-1&&!E.config.shuffle?s(0):v();break;case a.html5.controller.repeatoptions.LIST:if(E.item==E.playlist.length-1&&!E.config.shuffle){m();F(0)}else v();break;default:m();break}}}function L(V){return function(){da?T(V,arguments):ga.push({method:V,
arguments:arguments})}}function T(V,O){var U=[];for(i=0;i<O.length;i++)U.push(O[i]);V.apply(this,U)}var E=f,S=h,J=true,I=-1,N=false,Y=false,R,Q=[],da=false;c=b.exists(E.config.debug)&&E.config.debug.toString().toLowerCase()=="console";var Z=new a.html5.eventdispatcher(e.id,c);b.extend(this,Z);E.addGlobalListener(l);E.addEventListener(a.api.events.JWPLAYER_MEDIA_BUFFER_FULL,function(){E.getMedia().play()});E.addEventListener(a.api.events.JWPLAYER_MEDIA_TIME,function(V){if(V.position>=E.playlist[E.item].start&&
I>=0){E.playlist[E.item].start=I;I=-1}});E.addEventListener(a.api.events.JWPLAYER_MEDIA_COMPLETE,function(){setTimeout(C,25)});E.addEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,r);E.addEventListener(a.api.events.JWPLAYER_FULLSCREEN,z);a.html5.controller.repeatoptions={LIST:"LIST",ALWAYS:"ALWAYS",SINGLE:"SINGLE",NONE:"NONE"};var ga=[];this.play=L(n);this.pause=L(p);this.seek=L(y);this.stop=L(m);this.next=L(v);this.prev=L(A);this.item=L(s);this.setVolume=L(g);this.setMute=L(j);this.resize=L(q);
this.setFullscreen=L(t);this.load=L(w);this.playerReady=o;this.detachMedia=H;this.attachMedia=u;this.beforePlay=function(){return N};this.destroy=function(){E.getMedia()&&E.getMedia().destroy()}}})(jwplayer);(function(a){a.html5.defaultSkin=function(){this.text='<?xml version="1.0" ?><skin author="LongTail Video" name="Five" version="1.1"><components><component name="controlbar"><settings><setting name="margin" value="20"/><setting name="fontsize" value="11"/><setting name="fontcolor" value="0x000000"/></settings><layout><group position="left"><button name="play"/><divider name="divider"/><button name="prev"/><divider name="divider"/><button name="next"/><divider name="divider"/><text name="elapsed"/></group><group position="center"><slider name="time"/></group><group position="right"><text name="duration"/><divider name="divider"/><button name="blank"/><divider name="divider"/><button name="mute"/><slider name="volume"/><divider name="divider"/><button name="fullscreen"/></group></layout><elements><element name="background" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAIAAABvFaqvAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAElJREFUOI3t1LERACAMQlFgGvcfxNIhHMK4gsUvUviOmgtNsiAZkBSEKxKEnCYkkQrJn/YwbUNiSDDYRZaQRDaShv+oX9GBZEIuK+8hXVLs+/YAAAAASUVORK5CYII="/><element name="blankButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAYCAYAAAAyJzegAAAAFElEQVQYV2P8//8/AzpgHBUc7oIAGZdH0RjKN8EAAAAASUVORK5CYII="/><element name="capLeft" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAYCAYAAAA7zJfaAAAAQElEQVQIWz3LsRGAMADDQJ0XB5bMINABZ9GENGrszxhjT2WLSqxEJG2JQrTMdV2q5LpOAvyRaVmsi7WdeZ/7+AAaOTq7BVrfOQAAAABJRU5ErkJggg=="/><element name="capRight" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAYCAYAAAA7zJfaAAAAQElEQVQIWz3LsRGAMADDQJ0XB5bMINABZ9GENGrszxhjT2WLSqxEJG2JQrTMdV2q5LpOAvyRaVmsi7WdeZ/7+AAaOTq7BVrfOQAAAABJRU5ErkJggg=="/><element name="divider" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAYCAIAAAC0rgCNAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAADhJREFUCB0FwcENgEAAw7Aq+893g8APUILNOQcbFRktVGqUVFRkWNz3xTa2sUaLNUosKlRUvvf5AdbWOTtzmzyWAAAAAElFTkSuQmCC"/><element name="playButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAYCAYAAAAVibZIAAAANUlEQVR42u2RsQkAAAjD/NTTPaW6dXLrINJA1kBpGPMAjDWmOgp1HFQXx+b1KOefO4oxY57R73YnVYCQUCQAAAAASUVORK5CYII="/><element name="pauseButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAYCAYAAAAVibZIAAAAIUlEQVQ4jWNgGAWjYOiD/0gYG3/U0FFDB4Oho2AUDAYAAEwiL9HrpdMVAAAAAElFTkSuQmCC"/><element name="prevButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAYCAYAAAAVibZIAAAAQklEQVQ4y2NgGAWjYOiD/1AMA/JAfB5NjCJD/YH4PRaLyDa0H4lNNUP/DxlD59PCUBCIp3ZEwYA+NZLUKBgFgwEAAN+HLX9sB8u8AAAAAElFTkSuQmCC"/><element name="nextButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAYCAYAAAAVibZIAAAAQElEQVQ4y2NgGAWjYOiD/0B8Hojl0cT+U2ooCL8HYn9qGwrD/bQw9P+QMXQ+tSMqnpoRBUpS+tRMUqNgFAwGAADxZy1/mHvFnAAAAABJRU5ErkJggg=="/><element name="timeSliderRail" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAOElEQVRIDe3BwQkAIRADwAhhw/nU/kWwUK+KPITMABFh19Y+F0acY8CJvX9wYpXgRElwolSIiMf9ZWEDhtwurFsAAAAASUVORK5CYII="/><element name="timeSliderBuffer" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAN0lEQVRIDe3BwQkAMQwDMBcc55mRe9zi7RR+FCwBEWG39vcfGHFm4MTuhhMlwYlVBSdKhYh43AW/LQMKm1spzwAAAABJRU5ErkJggg=="/><element name="timeSliderProgress" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAIElEQVRIiWNgGAWjYBTQBfynMR61YCRYMApGwSigMQAAiVWPcbq6UkIAAAAASUVORK5CYII="/><element name="timeSliderThumb" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAYCAYAAAA/OUfnAAAAO0lEQVQYlWP4//8/Awwz0JgDBP/BeN6Cxf/hnI2btiI4u/fsQ3AOHjqK4Jw4eQbBOX/hEoKDYjSd/AMA4cS4mfLsorgAAAAASUVORK5CYII="/><element name="muteButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAYCAYAAADKx8xXAAAAJklEQVQ4y2NgGAUjDcwH4v/kaPxPikZkxcNVI9mBQ5XoGAWDFwAAsKAXKQQmfbUAAAAASUVORK5CYII="/><element name="unmuteButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAYCAYAAADKx8xXAAAAMklEQVQ4y2NgGAWDHPyntub5xBr6Hwv/Pzk2/yfVG/8psRFE25Oq8T+tQnsIaB4FVAcAi2YVysVY52AAAAAASUVORK5CYII="/><element name="volumeSliderRail" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYAgMAAACdGdVrAAAACVBMVEUAAACmpqampqbBXAu8AAAAAnRSTlMAgJsrThgAAAArSURBVAhbY2AgErBAyA4I2QEhOyBkB4TsYOhAoaCCUCUwDTDtMMNgRuMHAFB5FoGH5T0UAAAAAElFTkSuQmCC"/><element name="volumeSliderProgress" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYAgMAAACdGdVrAAAACVBMVEUAAAAAAAAAAACDY+nAAAAAAnRSTlMAgJsrThgAAAArSURBVAhbY2AgErBAyA4I2QEhOyBkB4TsYOhAoaCCUCUwDTDtMMNgRuMHAFB5FoGH5T0UAAAAAElFTkSuQmCC"/><element name="volumeSliderCapRight" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAYCAYAAAAyJzegAAAAFElEQVQYV2P8//8/AzpgHBUc7oIAGZdH0RjKN8EAAAAASUVORK5CYII="/><element name="fullscreenButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAQklEQVRIiWNgGAWjYMiD/0iYFDmSLbDHImdPLQtgBpEiR7Zl2NijAA5oEkT/0Whi5UiyAJ8BVMsHNMtoo2AUDAIAAGdcIN3IDNXoAAAAAElFTkSuQmCC"/><element name="normalscreenButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAP0lEQVRIx2NgGAWjYMiD/1RSQ5QB/wmIUWzJfzx8qhj+n4DYCAY0DyJ7PBbYU8sHMEvwiZFtODXUjIJRMJgBACpWIN2ZxdPTAAAAAElFTkSuQmCC"/></elements></component><component name="display"><elements><element name="background" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyAQMAAAAk8RryAAAABlBMVEUAAAAAAAClZ7nPAAAAAnRSTlOZpuml+rYAAAASSURBVBhXY2AYJuA/GBwY6jQAyDyoK8QcL4QAAAAASUVORK5CYII="/><element name="playIcon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAiUlEQVR42u3XSw2AMBREURwgAQlIQAISKgUpSEFKJeCg5b0E0kWBTVcD9ySTsL0Jn9IBAAAA+K2UUrBlW/Rr5ZDoIeeuoFkxJD9ss03aIXXQqB9SttoG7ZA6qNcOKdttiwcJh9RB+iFl4SshkRBuLR72+9cvH0SOKI2HRo7x/Fi1/uoCAAAAwLsD8ki99IlO2dQAAAAASUVORK5CYII="/><element name="muteIcon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAVUlEQVR42u3WMQrAIAxAUW/g/SdvGmvpoOBeSHgPsjj5QTANAACARCJilIhYM0tEvJM+Ik3Id9E957kQIb+F3OdCPC0hPkQriqWx9hp/x/QGAABQyAPLB22VGrpLDgAAAABJRU5ErkJggg=="/><element name="errorIcon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAA/0lEQVR42u2U0QmEMBAF7cASLMESUoIlpARLSCkpwRJSgiWkhOvAXD4WsgRkyaG5DbyB+Yvg8KITAAAAAAAYk+u61mwk15EjPtlEfihmqIiZR1Qx80ghjgdUuiHXGHSVsoag0x6x8DUoyjD5KovmEJ9NTDMRPIT0mtdIUkjlonuNohO+Ha99DTmkuGgKCTcvebAzx82ZoCWC3/3aIMWSRucaxcjORSFY4xpFdjYJGp1rFGcyCYZ/RVh6AUnfcNZ2zih3/mGj1jVCdiNDwyrq1rA/xMdeEXvDVdnYc1vDc3uPkDObXrlaxbNHSOohQhr/WOeLEWfWTgAAAAAAADzNF9sHJ7PJ57MlAAAAAElFTkSuQmCC"/><element name="bufferIcon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAACBklEQVR42u3Zv0sCYRzH8USTzOsHHEWGkC1HgaDgkktGDjUYtDQ01RDSljQ1BLU02+rk1NTm2NLq4Nx/0L/h9fnCd3j4cnZe1/U8xiO8h3uurufF0/3COd/3/0UWYiEWYiEWYiGJQ+J8xuPxKhXjEMZANinjIZhkGuVRNioE4wVURo4JkHm0xKWmhRAc1bh1EyCUw5BcBIjHiApKa4CErko6DEJwuRo6IRKzyJD8FJAyI3Zp2zRImiBcRhlfo5RtlxCcE3CcDNpGrhYIT2IhAJKilO0VRmzJ32fAMTpBTS0QMfGwlcuKMRftE0DJ0wCJdcOsCkBdXP3Mh9CEFUBTPS9mDZJBG6io4aqVzMdCokCw9H3kT6j/C/9iDdSeUMNC7DkyyxAs/Rk6Qss8FPWRZgdVtUH4DjxEn1zxh+/zj1wHlf4MQhNGrwqA6sY40U8JonRJwEQh+AO3AvCG6gHv4U7IY4krxkroWoAOkoQMGfCBrgIm+YBGqPENpIJ66CJg3x66Y0gnSUidAEEnNr9jjLiWMn5DiWP0OC/oAsCgkq43xBdGDMQr7YASP/vEkHvdl1+JOCcEV5sC4hGEOzTlPuKgd0b0xD4JkRcOgnRRTjdErkYhAsQVq6IdUuPJtmk7BCL3t/h88cx91pKQkI/pkDx6pmYTIjEoxiHsN1YWYiEWYiEWknhflZ5IErA5nr8AAAAASUVORK5CYII="/></elements></component><component name="dock"><settings><setting name="fontcolor" value="0xffffff"/></settings><elements><element name="button" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyAQMAAAAk8RryAAAABlBMVEUAAAAAAAClZ7nPAAAAAnRSTlOZpuml+rYAAAASSURBVBhXY2AYJuA/GBwY6jQAyDyoK8QcL4QAAAAASUVORK5CYII="/></elements></component><component name="playlist"><settings><setting name="backgroundcolor" value="0xe8e8e8"/></settings><elements><element name="item" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAIAAAC1nk4lAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHBJREFUaN7t2MENwCAMBEEe9N8wSKYC/D8YV7CyJoRkVtVImxkZPQInMxoP0XiIxkM0HsGbjjSNBx544IEHHnjggUe/6UQeey0PIh7XTftGxKPj4eXCtLsHHh+ZxkO0Iw8PR55Ni8ZD9Hu/EAoP0dc5RRg9qeRjVF8AAAAASUVORK5CYII="/><element name="sliderCapTop" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAHCAYAAADnCQYGAAAAFUlEQVQokWP8//8/A7UB46ihI9hQAKt6FPPXhVGHAAAAAElFTkSuQmCC"/><element name="sliderRail" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAUCAYAAABiS3YzAAAAKElEQVQ4y2P4//8/Az68bNmy/+iYkB6GUUNHDR01dNTQUUNHDaXcUABUDOKhcxnsSwAAAABJRU5ErkJggg=="/><element name="sliderThumb" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAUCAYAAABiS3YzAAAAJUlEQVQ4T2P4//8/Ay4MBP9xYbz6Rg0dNXTU0FFDRw0dNZRyQwHH4NBa7GJsXAAAAABJRU5ErkJggg=="/><element name="sliderCapBottom" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAHCAYAAADnCQYGAAAAFUlEQVQokWP8//8/A7UB46ihI9hQAKt6FPPXhVGHAAAAAElFTkSuQmCC"/></elements></component></components></skin>';
this.xml=null;if(window.DOMParser){parser=new DOMParser;this.xml=parser.parseFromString(this.text,"text/xml")}else{this.xml=new ActiveXObject("Microsoft.XMLDOM");this.xml.async="false";this.xml.loadXML(this.text)}return this}})(jwplayer);(function(a){_utils=a.utils;_css=_utils.css;_hide=function(b){_css(b,{display:"none"})};_show=function(b){_css(b,{display:"block"})};a.html5.display=function(b,c){function e(){r.display=l("div","display");r.display_text=l("div","display_text");r.display.appendChild(r.display_text);
r.display_image=l("img","display_image");r.display_image.onerror=function(){_hide(r.display_image)};r.display_image.onload=f;r.display_icon=l("div","display_icon");r.display_iconBackground=l("div","display_iconBackground");r.display.appendChild(r.display_image);r.display_iconBackground.appendChild(r.display_icon);r.display.appendChild(r.display_iconBackground);o();setTimeout(function(){V=true;t.icons.toString()=="true"&&W()},1)}function f(){u=r.display_image.naturalWidth;C=r.display_image.naturalHeight;
h();if(w.jwGetState()==a.api.events.state.IDLE||w.jwGetPlaylist()[w.jwGetPlaylistIndex()].provider=="sound"){_css(r.display_image,{display:"block",opacity:0});_utils.fadeTo(r.display_image,1,0.1)}Q=false}function h(){if(w.jwGetFullscreen()&&w.jwGetStretching()==a.utils.stretching.EXACTFIT){var D=document.createElement("div");_utils.stretch(a.utils.stretching.UNIFORM,D,z,H,U,X);_utils.stretch(a.utils.stretching.EXACTFIT,r.display_image,_utils.parseDimension(D.style.width),_utils.parseDimension(D.style.height),
u,C);_css(r.display_image,{left:D.style.left,top:D.style.top})}else _utils.stretch(w.jwGetStretching(),r.display_image,z,H,u,C)}function l(D,K){D=document.createElement(D);D.id=w.id+"_jwplayer_"+K;_css(D,M[K].style);return D}function o(){for(var D in r)if(_utils.exists(M[D].click))r[D].onclick=M[D].click}function n(D){if(typeof D.preventDefault!="undefined")D.preventDefault();else D.returnValue=false;if(typeof O=="function")O(D);else w.jwGetState()!=a.api.events.state.PLAYING?w.jwPlay():w.jwPause()}
function p(D){if(E)y();else{r.display_icon.style.backgroundImage=["url(",w.skin.getSkinElement("display",D).src,")"].join("");_css(r.display_icon,{width:w.skin.getSkinElement("display",D).width,height:w.skin.getSkinElement("display",D).height,top:(w.skin.getSkinElement("display","background").height-w.skin.getSkinElement("display",D).height)/2,left:(w.skin.getSkinElement("display","background").width-w.skin.getSkinElement("display",D).width)/2});m();if(_utils.exists(w.skin.getSkinElement("display",
D+"Over"))){r.display_icon.onmouseover=function(){r.display_icon.style.backgroundImage=["url(",w.skin.getSkinElement("display",D+"Over").src,")"].join("")};r.display_icon.onmouseout=function(){r.display_icon.style.backgroundImage=["url(",w.skin.getSkinElement("display",D).src,")"].join("")}}else{r.display_icon.onmouseover=null;r.display_icon.onmouseout=null}}}function y(){if(t.icons.toString()=="true"){_hide(r.display_icon);_hide(r.display_iconBackground);ba()}}function m(){if(!ga&&t.icons.toString()==
"true"){_show(r.display_icon);_show(r.display_iconBackground);W()}}function v(D){E=true;y();r.display_text.innerHTML=D.message;_show(r.display_text);r.display_text.style.top=(H-_utils.getBoundingClientRect(r.display_text).height)/2+"px"}function A(){da=false;r.display_image.style.display="none"}function B(){N=""}function s(D){if((D.type==a.api.events.JWPLAYER_PLAYER_STATE||D.type==a.api.events.JWPLAYER_PLAYLIST_ITEM)&&E){E=false;_hide(r.display_text)}D=w.jwGetState();if(D!=N){N=D;I>=0&&clearTimeout(I);
if(Y||w.jwGetState()==a.api.events.state.PLAYING||w.jwGetState()==a.api.events.state.PAUSED)g(w.jwGetState());else I=setTimeout(F(w.jwGetState()),500)}}function F(D){return function(){g(D)}}function g(D){if(_utils.exists(T)){clearInterval(T);T=null;_utils.animations.rotate(r.display_icon,0)}switch(D){case a.api.events.state.BUFFERING:if(_utils.isIPod()){A();y()}else{w.jwGetPlaylist()[w.jwGetPlaylistIndex()].provider=="sound"&&j();L=0;T=setInterval(function(){L+=S;_utils.animations.rotate(r.display_icon,
L%360)},J);p("bufferIcon");Y=true}break;case a.api.events.state.PAUSED:if(!_utils.isIPod()){w.jwGetPlaylist()[w.jwGetPlaylistIndex()].provider!="sound"&&_css(r.display_image,{background:"transparent no-repeat center center"});p("playIcon");Y=true}break;case a.api.events.state.IDLE:w.jwGetPlaylist()[w.jwGetPlaylistIndex()]&&w.jwGetPlaylist()[w.jwGetPlaylistIndex()].image?j():A();p("playIcon");Y=true;break;default:if(w.jwGetPlaylist()[w.jwGetPlaylistIndex()]&&w.jwGetPlaylist()[w.jwGetPlaylistIndex()].provider==
"sound")if(_utils.isIPod()){A();Y=false}else j();else{A();Y=false}w.jwGetMute()&&t.showmute?p("muteIcon"):y();break}I=-1}function j(){if(w.jwGetPlaylist()[w.jwGetPlaylistIndex()]){var D=w.jwGetPlaylist()[w.jwGetPlaylistIndex()].image;if(D)if(D!=Z){Z=D;Q=true;r.display_image.src=_utils.getAbsolutePath(D)}else if(!(Q||da)){da=true;r.display_image.style.opacity=0;r.display_image.style.display="block";_utils.fadeTo(r.display_image,1,0.1)}}}function q(D){return function(){if(V)if(!ga&&R!=D){R=D;G.sendEvent(D,
{component:"display",boundingRect:_utils.getDimensions(r.display_iconBackground)})}}}var t=_utils.extend({},{icons:true,showmute:false},c),w=b,r={},z,H,u,C,L,T,E,S=!_utils.exists(w.skin.getComponentSettings("display").bufferrotation)?15:parseInt(w.skin.getComponentSettings("display").bufferrotation,10),J=!_utils.exists(w.skin.getComponentSettings("display").bufferinterval)?100:parseInt(w.skin.getComponentSettings("display").bufferinterval,10),I=-1,N=a.api.events.state.IDLE,Y=true,R,Q=false,da=true,
Z="",ga=false,V=false,O,U,X,G=new a.html5.eventdispatcher;_utils.extend(this,G);var M={display:{style:{cursor:"pointer",top:0,left:0,overflow:"hidden"},click:n},display_icon:{style:{cursor:"pointer",position:"absolute",top:(w.skin.getSkinElement("display","background").height-w.skin.getSkinElement("display","playIcon").height)/2,left:(w.skin.getSkinElement("display","background").width-w.skin.getSkinElement("display","playIcon").width)/2,border:0,margin:0,padding:0,zIndex:3,display:"none"}},display_iconBackground:{style:{cursor:"pointer",
position:"absolute",top:(H-w.skin.getSkinElement("display","background").height)/2,left:(z-w.skin.getSkinElement("display","background").width)/2,border:0,backgroundImage:["url(",w.skin.getSkinElement("display","background").src,")"].join(""),width:w.skin.getSkinElement("display","background").width,height:w.skin.getSkinElement("display","background").height,margin:0,padding:0,zIndex:2,display:"none"}},display_image:{style:{display:"none",width:z,height:H,position:"absolute",cursor:"pointer",left:0,
top:0,margin:0,padding:0,textDecoration:"none",zIndex:1}},display_text:{style:{zIndex:4,position:"relative",opacity:0.8,backgroundColor:parseInt("000000",16),color:parseInt("ffffff",16),textAlign:"center",fontFamily:"Arial,sans-serif",padding:"0 5px",fontSize:14}}};w.jwAddEventListener(a.api.events.JWPLAYER_PLAYER_STATE,s);w.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_MUTE,s);w.jwAddEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,B);w.jwAddEventListener(a.api.events.JWPLAYER_PLAYLIST_ITEM,
s);w.jwAddEventListener(a.api.events.JWPLAYER_ERROR,v);e();this.getDisplayElement=function(){return r.display};this.resize=function(D,K){if(!(w.jwGetFullscreen()&&_utils.isMobile())){_css(r.display,{width:D,height:K});_css(r.display_text,{width:D-10,top:(K-_utils.getBoundingClientRect(r.display_text).height)/2});_css(r.display_iconBackground,{top:(K-w.skin.getSkinElement("display","background").height)/2,left:(D-w.skin.getSkinElement("display","background").width)/2});if(z!=D||H!=K){z=D;H=K;R=undefined;
W()}if(!w.jwGetFullscreen()){U=D;X=K}h();s({})}};this.show=function(){if(ga){ga=false;g(w.jwGetState())}};this.hide=function(){if(!ga){y();ga=true}};var W=q(a.api.events.JWPLAYER_COMPONENT_SHOW),ba=q(a.api.events.JWPLAYER_COMPONENT_HIDE);this.setAlternateClickHandler=function(D){O=D};this.revertAlternateClickHandler=function(){O=undefined};return this}})(jwplayer);(function(a){var b=a.utils,c=b.css;a.html5.dock=function(e,f){function h(){return{align:a.html5.view.positions.RIGHT}}function l(J){return"url("+
J+") no-repeat center center"}function o(J,I){A();if(F.length>0){var N=10,Y=-1,R=e.skin.getSkinElement("dock","button").height,Q=e.skin.getSkinElement("dock","button").width,da=J-Q-10,Z,ga;if(B.align==a.html5.view.positions.LEFT){Y=1;da=10}for(var V=0;V<F.length;V++){var O=Math.floor(N/I);if(N+R+10>(O+1)*I){N=(O+1)*I+10;O=Math.floor(N/I)}var U=s[F[V]].div;U.style.top=N%I+"px";U.style.left=da+(e.skin.getSkinElement("dock","button").width+10)*O*Y+"px";O={x:b.parseDimension(U.style.left),y:b.parseDimension(U.style.top),
width:Q,height:R};if(!Z||O.x<=Z.x&&O.y<=Z.y)Z=O;if(!ga||O.x>=ga.x&&O.y>=ga.y)ga=O;U.style.width=Q+"px";U.style.height=R+"px";N+=e.skin.getSkinElement("dock","button").height+10}w={x:Z.x,y:Z.y,width:ga.x-Z.x+ga.width,height:Z.y-ga.y+ga.height}}if(t!=e.jwGetFullscreen()||g!=J||j!=I){g=J;j=I;t=e.jwGetFullscreen();r=undefined;setTimeout(L,1)}}function n(J){return function(){if(!q&&r!=J&&F.length>0){r=J;u.sendEvent(J,{component:"dock",boundingRect:w})}}}function p(J){if(b.isMobile())J.newstate==a.api.events.state.IDLE?
E():S();else y()}function y(J){if(!q){clearTimeout(H);if(f.position==a.html5.view.positions.OVER||e.jwGetFullscreen())switch(e.jwGetState()){case a.api.events.state.PAUSED:case a.api.events.state.IDLE:if(C&&C.style.opacity<1&&(!f.idlehide||b.exists(J)))v();if(f.idlehide)H=setTimeout(function(){m()},2E3);break;default:b.exists(J)&&v();H=setTimeout(function(){m()},2E3);break}else v()}}function m(){if(!q){T();if(C.style.opacity==1){b.cancelAnimation(C);b.fadeTo(C,0,0.1,1,0)}}}function v(){if(!q){L();
if(C.style.opacity==0){b.cancelAnimation(C);b.fadeTo(C,1,0.1,0,0)}}}function A(){try{z=document.getElementById(e.id);z.addEventListener("mousemove",y)}catch(J){b.log("Could not add mouse listeners to dock: "+J)}}var B=b.extend({},h(),f);if(B.align!="FALSE"){var s={},F=[],g,j,q=false,t=false,w={x:0,y:0,width:0,height:0},r,z,H,u=new a.html5.eventdispatcher;b.extend(this,u);var C=document.createElement("div");C.id=e.id+"_jwplayer_dock";C.style.opacity=1;A();e.jwAddEventListener(a.api.events.JWPLAYER_PLAYER_STATE,
p);this.getDisplayElement=function(){return C};this.setButton=function(J,I,N,Y){if(!I&&s[J]){b.arrays.remove(F,J);C.removeChild(s[J].div);delete s[J]}else if(I){s[J]||(s[J]={});s[J].handler=I;s[J].outGraphic=N;s[J].overGraphic=Y;if(!s[J].div){F.push(J);s[J].div=document.createElement("div");s[J].div.style.position="absolute";C.appendChild(s[J].div);s[J].div.appendChild(document.createElement("div"));s[J].div.childNodes[0].style.position="relative";s[J].div.childNodes[0].style.width="100%";s[J].div.childNodes[0].style.height=
"100%";s[J].div.childNodes[0].style.zIndex=10;s[J].div.childNodes[0].style.cursor="pointer";s[J].div.appendChild(document.createElement("img"));s[J].div.childNodes[1].style.position="absolute";s[J].div.childNodes[1].style.left=0;s[J].div.childNodes[1].style.top=0;if(e.skin.getSkinElement("dock","button"))s[J].div.childNodes[1].src=e.skin.getSkinElement("dock","button").src;s[J].div.childNodes[1].style.zIndex=9;s[J].div.childNodes[1].style.cursor="pointer";s[J].div.onmouseover=function(){if(s[J].overGraphic)s[J].div.childNodes[0].style.background=
l(s[J].overGraphic);if(e.skin.getSkinElement("dock","buttonOver"))s[J].div.childNodes[1].src=e.skin.getSkinElement("dock","buttonOver").src};s[J].div.onmouseout=function(){if(s[J].outGraphic)s[J].div.childNodes[0].style.background=l(s[J].outGraphic);if(e.skin.getSkinElement("dock","button"))s[J].div.childNodes[1].src=e.skin.getSkinElement("dock","button").src};if(e.skin.getSkinElement("dock","button"))s[J].div.childNodes[1].src=e.skin.getSkinElement("dock","button").src}if(s[J].outGraphic)s[J].div.childNodes[0].style.background=
l(s[J].outGraphic);else if(s[J].overGraphic)s[J].div.childNodes[0].style.background=l(s[J].overGraphic);if(I)s[J].div.onclick=function(R){R.preventDefault();a(e.id).callback(J);if(s[J].overGraphic)s[J].div.childNodes[0].style.background=l(s[J].overGraphic);if(e.skin.getSkinElement("dock","button"))s[J].div.childNodes[1].src=e.skin.getSkinElement("dock","button").src}}o(g,j)};var L=n(a.api.events.JWPLAYER_COMPONENT_SHOW),T=n(a.api.events.JWPLAYER_COMPONENT_HIDE);this.resize=o;var E=function(){c(C,
{display:"block"});if(q){q=false;L()}},S=function(){c(C,{display:"none"});if(!q){T();q=true}};this.hide=S;this.show=E;return this}}})(jwplayer);(function(a){a.html5.eventdispatcher=function(b,c){var e=new a.events.eventdispatcher(c);a.utils.extend(this,e);this.sendEvent=function(f,h){a.utils.exists(h)||(h={});a.utils.extend(h,{id:b,version:a.version,type:f});e.sendEvent(f,h)}}})(jwplayer);(function(a){var b=a.utils;a.html5.instream=function(c,e,f,h){function l(){_fakemodel=new a.html5.model(this,
q.getMedia()?q.getMedia().getDisplayElement():q.container,q);E=new a.html5.eventdispatcher;j.jwAddEventListener(a.api.events.JWPLAYER_RESIZE,B);j.jwAddEventListener(a.api.events.JWPLAYER_FULLSCREEN,B)}function o(){_fakemodel.setMute(q.mute);_fakemodel.setVolume(q.volume)}function n(){if(!u){u=new a.html5.mediavideo(_fakemodel,q.getMedia()?q.getMedia().getDisplayElement():q.container);u.addGlobalListener(p);u.addEventListener(a.api.events.JWPLAYER_MEDIA_META,v);u.addEventListener(a.api.events.JWPLAYER_MEDIA_COMPLETE,
m);u.addEventListener(a.api.events.JWPLAYER_MEDIA_BUFFER_FULL,y)}u.attachMedia()}function p(I){T&&A(I.type,I)}function y(){T&&u.play()}function m(){T&&setTimeout(function(){J.jwInstreamDestroy(true)},10)}function v(I){I.metadata.width&&I.metadata.height&&t.resizeMedia()}function A(I,N,Y){if(T||Y)E.sendEvent(I,N)}function B(){var I=q.plugins.object.display.getDisplayElement().style;if(C){var N=q.plugins.object.controlbar.getDisplayElement().style;C.resize(b.parseDimension(I.width),b.parseDimension(I.height));
_css(C.getDisplayElement(),b.extend({},N,{zIndex:1001,opacity:1}))}if(L){L.resize(b.parseDimension(I.width),b.parseDimension(I.height));_css(L.getDisplayElement(),b.extend({},I,{zIndex:1E3}))}t&&t.resizeMedia()}var s={controlbarseekable:"always",controlbarpausable:true,controlbarstoppable:true,playlistclickable:true},F,g,j=c,q=e,t=f,w,r,z,H,u,C,L,T=false,E,S,J=this;this.load=function(I,N){o();T=true;g=b.extend(s,N);F=a.html5.playlistitem(I);n();S=document.createElement("div");S.id=J.id+"_instream_container";
h.detachMedia();w=u.getDisplayElement();H=q.playlist[q.item];z=j.jwGetState();if(z==a.api.events.state.BUFFERING||z==a.api.events.state.PLAYING)w.pause();r=w.currentTime;L=new a.html5.display(J,b.extend({},q.plugins.config.display));L.setAlternateClickHandler(function(Y){_fakemodel.state==a.api.events.state.PAUSED?J.jwInstreamPlay():A(a.api.events.JWPLAYER_INSTREAM_CLICK,Y)});S.appendChild(L.getDisplayElement());if(!b.isMobile()){C=new a.html5.controlbar(J,b.extend({},q.plugins.config.controlbar,
{}));q.plugins.config.controlbar.position==a.html5.view.positions.OVER?S.appendChild(C.getDisplayElement()):q.plugins.object.controlbar.getDisplayElement().parentNode.appendChild(C.getDisplayElement())}t.setupInstream(S,w);B();u.load(F)};this.jwInstreamDestroy=function(I){if(T){T=false;if(z!=a.api.events.state.IDLE){u.load(H,false);u.stop(false)}else u.stop(true);u.detachMedia();t.destroyInstream();if(C)try{C.getDisplayElement().parentNode.removeChild(C.getDisplayElement())}catch(N){}A(a.api.events.JWPLAYER_INSTREAM_DESTROYED,
{reason:I?"complete":"destroyed"},true);h.attachMedia();if(z==a.api.events.state.BUFFERING||z==a.api.events.state.PLAYING){w.play();q.playlist[q.item]==H&&q.getMedia().seek(r)}}};this.jwInstreamAddEventListener=function(I,N){E.addEventListener(I,N)};this.jwInstreamRemoveEventListener=function(I,N){E.removeEventListener(I,N)};this.jwInstreamPlay=function(){T&&u.play(true)};this.jwInstreamPause=function(){T&&u.pause(true)};this.jwInstreamSeek=function(I){T&&u.seek(I)};this.jwInstreamGetState=function(){if(T)return _fakemodel.state};
this.jwInstreamGetPosition=function(){if(T)return _fakemodel.position};this.jwInstreamGetDuration=function(){if(T)return _fakemodel.duration};this.playlistClickable=function(){return!T||g.playlistclickable.toString().toLowerCase()=="true"};this.jwPlay=function(){g.controlbarpausable.toString().toLowerCase()=="true"&&this.jwInstreamPlay()};this.jwPause=function(){g.controlbarpausable.toString().toLowerCase()=="true"&&this.jwInstreamPause()};this.jwStop=function(){if(g.controlbarstoppable.toString().toLowerCase()==
"true"){this.jwInstreamDestroy();j.jwStop()}};this.jwSeek=function(I){switch(g.controlbarseekable.toLowerCase()){case "always":this.jwInstreamSeek(I);break;case "backwards":_fakemodel.position>I&&this.jwInstreamSeek(I);break}};this.jwGetPosition=function(){};this.jwGetDuration=function(){};this.jwGetWidth=j.jwGetWidth;this.jwGetHeight=j.jwGetHeight;this.jwGetFullscreen=j.jwGetFullscreen;this.jwSetFullscreen=j.jwSetFullscreen;this.jwGetVolume=function(){return q.volume};this.jwSetVolume=function(I){u.volume(I);
j.jwSetVolume(I)};this.jwGetMute=function(){return q.mute};this.jwSetMute=function(I){u.mute(I);j.jwSetMute(I)};this.jwGetState=function(){return _fakemodel.state};this.jwGetPlaylist=function(){return[F]};this.jwGetPlaylistIndex=function(){return 0};this.jwGetStretching=function(){return q.config.stretching};this.jwAddEventListener=function(I,N){E.addEventListener(I,N)};this.jwRemoveEventListener=function(I,N){E.removeEventListener(I,N)};this.skin=j.skin;this.id=j.id+"_instream";l();return this}})(jwplayer);
(function(a){var b={prefix:"",file:"",link:"",linktarget:"_top",margin:8,out:0.5,over:1,timeout:5,hide:true,position:"bottom-left"};_css=a.utils.css;a.html5.logo=function(c,e){function f(){h();s.jwAddEventListener(a.api.events.JWPLAYER_PLAYER_STATE,B);l();o()}function h(){if(b.prefix){var t=c.version.split(/\W/).splice(0,2).join("/");if(b.prefix.indexOf(t)<0)b.prefix+=t+"/"}if(e.position==a.html5.view.positions.OVER)e.position=b.position;try{if(window.location.href.indexOf("https")==0)b.prefix=b.prefix.replace("http://l.longtailvideo.com",
"https://securel.longtailvideo.com")}catch(w){}g=a.utils.extend({},b,e)}function l(){j=document.createElement("img");j.id=s.id+"_jwplayer_logo";j.style.display="none";j.onload=function(){_css(j,m());p()};if(g.file)j.src=g.file.indexOf("/")>=0?g.file:g.prefix+g.file}function o(){if(g.link){j.onmouseover=y;j.onmouseout=p;j.onclick=n}else this.mouseEnabled=false}function n(t){typeof t!="undefined"&&t.stopPropagation();if(q){s.jwPause();s.jwSetFullscreen(false);g.link&&window.open(g.link,g.linktarget)}}
function p(){if(g.link&&q)j.style.opacity=g.out}function y(){if(q)j.style.opacity=g.over}function m(){var t={textDecoration:"none",position:"absolute",cursor:"pointer"};t.display=g.hide.toString()=="true"&&!q?"none":"block";var w=g.position.toLowerCase().split("-");for(var r in w)t[w[r]]=parseInt(g.margin);return t}function v(){if(g.hide.toString()=="true"){j.style.display="block";j.style.opacity=0;a.utils.fadeTo(j,g.out,0.1,parseFloat(j.style.opacity));F=setTimeout(function(){A()},g.timeout*1E3)}q=
true}function A(){q=false;g.hide.toString()=="true"&&a.utils.fadeTo(j,0,0.1,parseFloat(j.style.opacity))}function B(t){if(t.newstate==a.api.events.state.BUFFERING){clearTimeout(F);v()}}var s=c,F,g,j,q=false;f();if(g.file){this.resize=function(){};this.getDisplayElement=function(){return j};return this}}})(jwplayer);(function(a){var b={ended:a.api.events.state.IDLE,playing:a.api.events.state.PLAYING,pause:a.api.events.state.PAUSED,buffering:a.api.events.state.BUFFERING},c=a.utils,e=c.isMobile(),f,
h,l={};a.html5.mediavideo=function(o,n){function p(D,K){J[D]||(J[D]=function(ea){c.exists(ea.target.parentNode)&&K(ea)});return J[D]}function y(){Q=a.api.events.state.IDLE;U=true;R=m();R.setAttribute("x-webkit-airplay","allow");if(Y.parentNode){R.id=Y.id;Y.parentNode.replaceChild(R,Y)}}function m(){var D=l[N.id];if(!D){D=Y.tagName.toLowerCase()=="video"?Y:document.createElement("video");l[N.id]=D;if(!D.id)D.id=Y.id}for(var K in S)D.addEventListener(K,p(K,S[K]),true);return D}function v(D){if(!(D==
a.api.events.state.PAUSED&&Q==a.api.events.state.IDLE)){if(e)switch(D){case a.api.events.state.PLAYING:L();break;case a.api.events.state.BUFFERING:case a.api.events.state.PAUSED:T();break}if(Q!=D){var K=Q;N.state=Q=D;E(a.api.events.JWPLAYER_PLAYER_STATE,{oldstate:K,newstate:D})}}}function A(){}function B(){var D=Math.round(R.volume*100);E(a.api.events.JWPLAYER_MEDIA_VOLUME,{volume:D},true);E(a.api.events.JWPLAYER_MEDIA_MUTE,{mute:R.muted},true)}function s(D){if(U){var K;if(c.exists(D)&&D.lengthComputable&&
D.total)K=D.loaded/D.total*100;else if(c.exists(R.buffered)&&R.buffered.length>0){D=R.buffered.length-1;if(D>=0)K=R.buffered.end(D)/R.duration*100}c.useNativeFullscreen()&&c.exists(R.webkitDisplayingFullscreen)&&N.fullscreen!=R.webkitDisplayingFullscreen&&E(a.api.events.JWPLAYER_FULLSCREEN,{fullscreen:R.webkitDisplayingFullscreen},true);if(M===false&&Q==a.api.events.state.BUFFERING){E(a.api.events.JWPLAYER_MEDIA_BUFFER_FULL);M=true}if(!G){if(K==100)G=true;if(c.exists(K)&&K>N.buffer){N.buffer=Math.round(K);
E(a.api.events.JWPLAYER_MEDIA_BUFFER,{bufferPercent:Math.round(K)})}}}}function F(D){if(U){if(c.exists(D)&&c.exists(D.target)){if(X>0)if(!isNaN(D.target.duration)&&(isNaN(N.duration)||N.duration<1))N.duration=D.target.duration==Infinity?0:Math.round(D.target.duration*10)/10;!da&&R.readyState>0&&v(a.api.events.state.PLAYING);if(Q==a.api.events.state.PLAYING){if(R.readyState>0&&(V>-1||!da)){da=true;try{if(R.currentTime!=V&&V>-1){R.currentTime=V;V=-1}}catch(K){}R.volume=N.volume/100;R.muted=N.mute}N.position=
N.duration>0?Math.round(D.target.currentTime*10)/10:0;E(a.api.events.JWPLAYER_MEDIA_TIME,{position:N.position,duration:N.duration});if(N.position>=N.duration&&(N.position>0||N.duration>0)){H();return}}}s(D)}}function g(){}function j(D){if(U){if(f&&h){R.style.width=f;R.style.height=h;f=_previousHieght=0}if(b[D.type])D.type=="ended"?H():v(b[D.type])}}function q(){if(U){var D=Math.round(R.duration*10)/10,K={height:R.videoHeight,width:R.videoWidth,duration:D};if(!X)if((N.duration<D||isNaN(N.duration))&&
R.duration!=Infinity)N.duration=D;E(a.api.events.JWPLAYER_MEDIA_META,{metadata:K})}}function t(D){if(U)if(Q!=a.api.events.state.IDLE){var K="There was an error: ";if(D.target.error&&D.target.tagName.toLowerCase()=="video"||D.target.parentNode.error&&D.target.parentNode.tagName.toLowerCase()=="video"){D=!c.exists(D.target.error)?D.target.parentNode.error:D.target.error;switch(D.code){case D.MEDIA_ERR_ABORTED:c.log("User aborted the video playback.");return;case D.MEDIA_ERR_NETWORK:K="A network error caused the video download to fail part-way: ";
break;case D.MEDIA_ERR_DECODE:K="The video playback was aborted due to a corruption problem or because the video used features your browser did not support: ";break;case D.MEDIA_ERR_SRC_NOT_SUPPORTED:K="The video could not be loaded, either because the server or network failed or because the format is not supported: ";break;default:K="An unknown error occurred: ";break}}else if(D.target.tagName.toLowerCase()=="source"){W--;if(W>0)return;if(c.userAgentMatch(/firefox/i)){c.log("The video could not be loaded, either because the server or network failed or because the format is not supported.");
ba(false);return}else K="The video could not be loaded, either because the server or network failed or because the format is not supported: "}else{c.log("An unknown error occurred.  Continuing...");return}ba(false);K+=w();_error=true;E(a.api.events.JWPLAYER_ERROR,{message:K})}}function w(){var D="";for(var K in Z.levels){var ea=Z.levels[K];Y.ownerDocument.createElement("source");D+=a.utils.getAbsolutePath(ea.file);if(K<Z.levels.length-1)D+=", "}return D}function r(){c.exists(ga)||(ga=setInterval(function(){s()},
100))}function z(){clearInterval(ga);ga=null}function H(){if(Q==a.api.events.state.PLAYING){ba(false);E(a.api.events.JWPLAYER_MEDIA_BEFORECOMPLETE);E(a.api.events.JWPLAYER_MEDIA_COMPLETE)}}function u(){c.exists(R.webkitDisplayingFullscreen)&&N.fullscreen&&!R.webkitDisplayingFullscreen&&E(a.api.events.JWPLAYER_FULLSCREEN,{fullscreen:false},true)}function C(D){if(D.length>0&&c.userAgentMatch(/Safari/i)&&!c.userAgentMatch(/Chrome/i)){for(var K=-1,ea=0;ea<D.length;ea++)switch(c.extension(D[ea].file)){case "mp4":if(K<
0)K=ea;break;case "webm":D.splice(ea,1);break}if(K>0){K=D.splice(K,1)[0];D.unshift(K)}}}function L(){setTimeout(function(){R.setAttribute("controls","controls")},100)}function T(){setTimeout(function(){R.removeAttribute("controls")},250)}function E(D,K,ea){if(U||ea)K?I.sendEvent(D,K):I.sendEvent(D)}var S={abort:A,canplay:j,canplaythrough:j,durationchange:q,emptied:A,ended:j,error:t,loadeddata:q,loadedmetadata:q,loadstart:j,pause:j,play:A,playing:j,progress:s,ratechange:A,seeked:j,seeking:j,stalled:j,
suspend:j,timeupdate:F,volumechange:B,waiting:j,canshowcurrentframe:A,dataunavailable:A,empty:A,load:g,loadedfirstframe:A,webkitfullscreenchange:u},J={},I=new a.html5.eventdispatcher;c.extend(this,I);var N=o,Y=n,R,Q,da,Z,ga,V,O=false,U=false,X=false,G,M,W;y();this.load=function(D,K){if(typeof K=="undefined")K=true;if(U){Z=D;X=Z.duration>0;N.duration=Z.duration;c.empty(R);R.style.display="block";R.style.opacity=1;if(f&&h){R.style.width=f;R.style.height=h;f=_previousHieght=0}W=0;C(D.levels);if(D.levels&&
D.levels.length>0)if(D.levels.length==1||c.isIOS())R.src=D.levels[0].file;else{R.src&&R.removeAttribute("src");for(var ea=0;ea<D.levels.length;ea++){var ha=R.ownerDocument.createElement("source");ha.src=D.levels[ea].file;R.appendChild(ha);W++}}else R.src=D.file;R.volume=N.volume/100;R.muted=N.mute;e&&L();G=M=da=false;N.buffer=0;if(!c.exists(D.start))D.start=0;V=D.start>0?D.start:-1;E(a.api.events.JWPLAYER_MEDIA_LOADED);if(!e&&D.levels.length==1||!O)R.load();O=false;if(K){v(a.api.events.state.BUFFERING);
E(a.api.events.JWPLAYER_MEDIA_BUFFER,{bufferPercent:0});r()}R.videoWidth>0&&R.videoHeight>0&&q()}};this.play=function(){if(U){r();if(M)v(a.api.events.state.PLAYING);else{R.load();v(a.api.events.state.BUFFERING)}R.play()}};this.pause=function(){if(U){R.pause();v(a.api.events.state.PAUSED)}};this.seek=function(D){if(U)if(!da&&R.readyState>0){if(!(N.duration<=0||isNaN(N.duration))&&!(N.position<=0||isNaN(N.position))){R.currentTime=D;R.play()}}else V=D};var ba=this.stop=function(D){if(U){c.exists(D)||
(D=true);z();if(D){M=false;if(R.webkitSupportsFullscreen)try{R.webkitExitFullscreen()}catch(K){}R.style.opacity=0;T();if(c.isIE())R.src="";else R.removeAttribute("src");c.empty(R);R.load();O=true}if(c.isIPod()){f=R.style.width;h=R.style.height;R.style.width=0;R.style.height=0}else if(c.isIPad()){R.style.display="none";try{R.webkitExitFullscreen()}catch(ea){}}v(a.api.events.state.IDLE)}};this.fullscreen=function(D){D===true?this.resize("100%","100%"):this.resize(N.config.width,N.config.height)};this.resize=
function(){};this.volume=function(D){if(!e){R.volume=D/100;E(a.api.events.JWPLAYER_MEDIA_VOLUME,{volume:D/100})}};this.mute=function(D){if(!e){R.muted=D;E(a.api.events.JWPLAYER_MEDIA_MUTE,{mute:D})}};this.getDisplayElement=function(){return R};this.hasChrome=function(){return e&&Q==a.api.events.state.PLAYING};this.detachMedia=function(){U=false;return this.getDisplayElement()};this.attachMedia=function(){U=true};this.destroy=function(){if(R&&R.parentNode){z();for(var D in S)R.removeEventListener(D,
p(D,S[D]),true);c.empty(R);Y=R.parentNode;R.parentNode.removeChild(R);delete l[N.id];R=null}}}})(jwplayer);(function(a){var b=a.utils.css;a.html5.mediayoutube=function(c,e){function f(A){if(y!=A){var B=y;y=n.state=A;o.sendEvent(a.api.events.JWPLAYER_PLAYER_STATE,{oldstate:B,newstate:A})}}function h(A){A=A.levels[0].file;A=["http://www.youtube.com/v/",l(A),"&amp;hl=en_US&amp;fs=1&autoplay=1"].join("");m=document.createElement("object");m.id=p.id;m.style.position="absolute";var B={movie:A,allowfullscreen:"true",
allowscriptaccess:"always"};for(var s in B){var F=document.createElement("param");F.name=s;F.value=B[s];m.appendChild(F)}v=document.createElement("embed");m.appendChild(v);s={src:A,type:"application/x-shockwave-flash",allowfullscreen:"true",allowscriptaccess:"always",width:m.width,height:m.height};for(var g in s)v.setAttribute(g,s[g]);m.appendChild(v);m.style.zIndex=2147483E3;p!=m&&p.parentNode&&p.parentNode.replaceChild(m,p);p=m}function l(A){for(var B=A.split(/\?|\#\!/),s="",F=0;F<B.length;F++)if(B[F].substr(0,
2)=="v=")s=B[F].substr(2);if(s=="")s=A.indexOf("/v/")>=0?A.substr(A.indexOf("/v/")+3):A.indexOf("youtu.be")>=0?A.substr(A.indexOf("youtu.be/")+9):A;if(s.indexOf("?")>-1)s=s.substr(0,s.indexOf("?"));if(s.indexOf("&")>-1)s=s.substr(0,s.indexOf("&"));return s}var o=new a.html5.eventdispatcher;a.utils.extend(this,o);var n=c,p=document.getElementById(e.id),y=a.api.events.state.IDLE,m,v;this.getDisplayElement=this.detachMedia=function(){return p};this.attachMedia=function(){};this.play=function(){if(y==
a.api.events.state.IDLE){o.sendEvent(a.api.events.JWPLAYER_MEDIA_BUFFER,{bufferPercent:100});o.sendEvent(a.api.events.JWPLAYER_MEDIA_BUFFER_FULL);f(a.api.events.state.PLAYING)}else y==a.api.events.state.PAUSED&&f(a.api.events.state.PLAYING)};this.pause=function(){f(a.api.events.state.PAUSED)};this.seek=function(){};this.stop=function(A){_utils.exists(A)||(A=true);n.position=0;f(a.api.events.state.IDLE);A&&b(p,{display:"none"})};this.volume=function(A){n.setVolume(A);o.sendEvent(a.api.events.JWPLAYER_MEDIA_VOLUME,
{volume:Math.round(A)})};this.mute=function(A){p.muted=A;o.sendEvent(a.api.events.JWPLAYER_MEDIA_MUTE,{mute:A})};this.resize=function(A,B){if(A*B>0&&m){m.width=v.width=A;m.height=v.height=B}};this.fullscreen=function(A){A===true?this.resize("100%","100%"):this.resize(n.config.width,n.config.height)};this.load=function(A){h(A);b(m,{display:"block"});f(a.api.events.state.BUFFERING);o.sendEvent(a.api.events.JWPLAYER_MEDIA_BUFFER,{bufferPercent:0});o.sendEvent(a.api.events.JWPLAYER_MEDIA_LOADED);this.play()};
this.hasChrome=function(){return y!=a.api.events.state.IDLE};this.embed=v;return this}})(jwplayer);(function(a){var b=["width","height","start","duration","volume","mute","fullscreen","item","plugins","stretching"],c=a.utils;a.html5.model=function(e,f,h){function l(z){var H=new a.html5.playlistloader;H.addEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,function(u){m.playlist=new a.html5.playlist(u);o(true)});H.addEventListener(a.api.events.JWPLAYER_ERROR,function(){m.playlist=new a.html5.playlist({playlist:[]});
o(false)});H.load(z)}function o(){if(m.config.shuffle)m.item=n();else{if(m.config.item>=m.playlist.length)m.config.item=m.playlist.length-1;else if(m.config.item<0)m.config.item=0;m.item=m.config.item}m.position=0;m.duration=m.playlist.length>0?m.playlist[m.item].duration:0;A.sendEvent(a.api.events.JWPLAYER_PLAYLIST_LOADED,{playlist:m.playlist});A.sendEvent(a.api.events.JWPLAYER_PLAYLIST_ITEM,{index:m.item})}function n(){var z=null;if(m.playlist.length>1)for(;!a.utils.exists(z);){z=Math.floor(Math.random()*
m.playlist.length);if(z==m.item)z=null}else z=0;return z}function p(z){switch(z.type){case a.api.events.JWPLAYER_MEDIA_LOADED:y=v.getDisplayElement();break;case a.api.events.JWPLAYER_MEDIA_MUTE:this.mute=z.mute;break;case a.api.events.JWPLAYER_MEDIA_VOLUME:this.volume=z.volume;break}A.sendEvent(z.type,z)}var y=f;f=c.getCookies();var m={id:y.id,playlist:[],state:a.api.events.state.IDLE,position:0,buffer:0,container:y,config:{width:480,height:320,item:-1,skin:undefined,file:undefined,image:undefined,
start:0,duration:0,bufferlength:5,volume:f.volume?f.volume:90,mute:f.mute&&f.mute.toString().toLowerCase()=="true"?true:false,fullscreen:false,repeat:"",stretching:a.utils.stretching.UNIFORM,autostart:false,debug:undefined,screencolor:undefined}},v,A=new a.html5.eventdispatcher;a.utils.extend(m,A);for(var B in h){if(typeof h[B]=="string"){f=/color$/.test(B)?"color":null;h[B]=a.utils.typechecker(h[B],f)}f=m.config;var s=B.split(".");for(var F in s)if(F==s.length-1)f[s[F]]=h[B];else{a.utils.exists(f[s[F]])||
(f[s[F]]={});f=f[s[F]]}}for(var g in b){h=b[g];m[h]=m.config[h]}g=["display","logo","controlbar","playlist","dock"].concat([]);if(a.utils.exists(m.plugins))if(typeof m.plugins=="string"){h=m.plugins.split(",");for(var j in h)typeof h[j]=="string"&&g.push(h[j].replace(/^\s+|\s+$/g,""))}if(a.utils.isMobile()){g=["display","logo","dock","playlist"];if(!a.utils.exists(m.config.repeat))m.config.repeat="list"}else if(m.config.chromeless){g=["logo","dock","playlist"];if(!a.utils.exists(m.config.repeat))m.config.repeat=
"list"}m.plugins={order:g,config:{},object:{}};if(typeof m.config.components!="undefined")for(var q in m.config.components)m.plugins.config[q]=m.config.components[q];j=false;for(var t in m.plugins.order){q=m.plugins.order[t];g=!a.utils.exists(m.plugins.config[q])?{}:m.plugins.config[q];m.plugins.config[q]=!a.utils.exists(m.plugins.config[q])?g:a.utils.extend(m.plugins.config[q],g);if(a.utils.exists(m.plugins.config[q].position)){if(q=="playlist")j=true;m.plugins.config[q].position=m.plugins.config[q].position.toString().toUpperCase()}else m.plugins.config[q].position=
q=="playlist"?a.html5.view.positions.NONE:a.html5.view.positions.OVER}if(m.plugins.config.controlbar&&j)m.plugins.config.controlbar.hideplaylistcontrols=true;if(typeof m.plugins.config.dock!="undefined"){if(typeof m.plugins.config.dock!="object"){t=m.plugins.config.dock.toString().toUpperCase();m.plugins.config.dock={position:t}}if(typeof m.plugins.config.dock.position!="undefined"){m.plugins.config.dock.align=m.plugins.config.dock.position;m.plugins.config.dock.position=a.html5.view.positions.OVER}if(typeof m.plugins.config.dock.idlehide==
"undefined")try{m.plugins.config.dock.idlehide=m.plugins.config.controlbar.idlehide}catch(w){}}m.loadPlaylist=function(z){var H;if(typeof z=="string")if(z.indexOf("[")==0||z.indexOf("{")=="0")try{H=eval(z)}catch(u){H=z}else H=z;else H=z;switch(a.utils.typeOf(H)){case "object":z=H;break;case "array":z={playlist:H};break;default:z={file:H};break}m.playlist=new a.html5.playlist(z);m.item=m.config.item>=0?m.config.item:0;!m.playlist[0].provider&&m.playlist[0].file?l(m.playlist[0].file):o()};var r={};
m.setActiveMediaProvider=function(z){if(z.provider=="audio")z.provider="sound";z=z.provider;var H=v?v.getDisplayElement():null;if(z=="sound"||z=="http"||z=="")z="video";if(a.utils.exists(r[z])){if(v!=r[z]){v&&v.stop();v=r[z]}}else{switch(z){case "video":v=new a.html5.mediavideo(m,H?H:y);break;case "youtube":v=new a.html5.mediayoutube(m,H?H:y);break}if(!a.utils.exists(v))return false;v.addGlobalListener(p);r[z]=v}return true};m.getMedia=function(){return v};m.seek=function(z){A.sendEvent(a.api.events.JWPLAYER_MEDIA_SEEK,
{position:m.position,offset:z});return v.seek(z)};m.setVolume=function(z){c.saveCookie("volume",z);m.volume=z};m.setMute=function(z){c.saveCookie("mute",z);m.mute=z};m.setupPlugins=function(){if(!a.utils.exists(m.plugins)||!a.utils.exists(m.plugins.order)||m.plugins.order.length==0){a.utils.log("No plugins to set up");return m}for(var z=0;z<m.plugins.order.length;z++)try{var H=m.plugins.order[z];if(a.utils.exists(a.html5[H]))m.plugins.object[H]=H=="playlist"?new a.html5.playlistcomponent(e,m.plugins.config[H]):
new a.html5[H](e,m.plugins.config[H]);else m.plugins.order.splice(plugin,plugin+1);typeof m.plugins.object[H].addGlobalListener=="function"&&m.plugins.object[H].addGlobalListener(p)}catch(u){a.utils.log("Could not setup "+H)}};return m}})(jwplayer);(function(a){a.html5.playlist=function(b){var c=[];if(b.playlist&&b.playlist instanceof Array&&b.playlist.length>0)for(var e in b.playlist)isNaN(parseInt(e))||c.push(new a.html5.playlistitem(b.playlist[e]));else c.push(new a.html5.playlistitem(b));return c}})(jwplayer);
(function(a){var b={size:180,position:a.html5.view.positions.NONE,itemheight:60,thumbs:true,fontcolor:"#000000",overcolor:"",activecolor:"",backgroundcolor:"#f8f8f8",font:"_sans",fontsize:"",fontstyle:"",fontweight:""},c={_sans:"Arial, Helvetica, sans-serif",_serif:"Times, Times New Roman, serif",_typewriter:"Courier New, Courier, monospace"};_utils=a.utils;_css=_utils.css;_hide=function(e){_css(e,{display:"none"})};_show=function(e){_css(e,{display:"block"})};a.html5.playlistcomponent=function(e,
f){function h(){w=document.createElement("div");w.id=q.id+"_jwplayer_playlistcomponent";w.style.overflow="hidden";switch(t.position){case a.html5.view.positions.RIGHT:case a.html5.view.positions.LEFT:w.style.width=t.size+"px";break;case a.html5.view.positions.TOP:case a.html5.view.positions.BOTTOM:w.style.height=t.size+"px";break}g();if(L.item)t.itemheight=L.item.height;w.style.backgroundColor="#C6C6C6";q.jwAddEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,y);q.jwAddEventListener(a.api.events.JWPLAYER_PLAYLIST_ITEM,
s);q.jwAddEventListener(a.api.events.JWPLAYER_PLAYER_STATE,F)}function l(){var T=document.createElement("ul");_css(T,{width:w.style.width,minWidth:w.style.width,height:w.style.height,backgroundColor:t.backgroundcolor,backgroundImage:L.background?"url("+L.background.src+")":"",color:t.fontcolor,listStyle:"none",margin:0,padding:0,fontFamily:c[t.font]?c[t.font]:c._sans,fontSize:(t.fontsize?t.fontsize:11)+"px",fontStyle:t.fontstyle,fontWeight:t.fontweight,overflowY:"auto"});return T}function o(T){return function(){var E=
u.getElementsByClassName("item")[T],S=t.fontcolor,J=L.item?"url("+L.item.src+")":"";if(T==q.jwGetPlaylistIndex()){if(t.activecolor!=="")S=t.activecolor;if(L.itemActive)J="url("+L.itemActive.src+")"}_css(E,{color:t.overcolor!==""?t.overcolor:S,backgroundImage:L.itemOver?"url("+L.itemOver.src+")":J})}}function n(T){return function(){var E=u.getElementsByClassName("item")[T],S=t.fontcolor,J=L.item?"url("+L.item.src+")":"";if(T==q.jwGetPlaylistIndex()){if(t.activecolor!=="")S=t.activecolor;if(L.itemActive)J=
"url("+L.itemActive.src+")"}_css(E,{color:S,backgroundImage:J})}}function p(T){var E=H[T],S=document.createElement("li");S.className="item";_css(S,{height:t.itemheight,display:"block",cursor:"pointer",backgroundImage:L.item?"url("+L.item.src+")":"",backgroundSize:"100% "+t.itemheight+"px"});S.onmouseover=o(T);S.onmouseout=n(T);var J=document.createElement("div"),I=new Image,N=T=0,Y=0;if(B()&&(E.image||E["playlist.image"]||L.itemImage)){I.className="image";if(L.itemImage){T=(t.itemheight-L.itemImage.height)/
2;N=L.itemImage.width;Y=L.itemImage.height}else{N=t.itemheight*4/3;Y=t.itemheight}_css(J,{height:Y,width:N,"float":"left",styleFloat:"left",cssFloat:"left",margin:"0 5px 0 0",background:"black",overflow:"hidden",margin:T+"px",position:"relative"});_css(I,{position:"relative"});J.appendChild(I);I.onload=function(){a.utils.stretch(a.utils.stretching.FILL,I,N,Y,this.naturalWidth,this.naturalHeight)};if(E["playlist.image"])I.src=E["playlist.image"];else if(E.image)I.src=E.image;else if(L.itemImage)I.src=
L.itemImage.src;S.appendChild(J)}var R=r-N-T*2;if(z<t.itemheight*H.length)R-=15;J=document.createElement("div");_css(J,{position:"relative",height:"100%",overflow:"hidden"});var Q=document.createElement("span");if(E.duration>0){Q.className="duration";_css(Q,{fontSize:(t.fontsize?t.fontsize:11)+"px",fontWeight:t.fontweight?t.fontweight:"bold",width:"40px",height:t.fontsize?t.fontsize+10:20,lineHeight:24,"float":"right",styleFloat:"right",cssFloat:"right"});Q.innerHTML=_utils.timeFormat(E.duration);
J.appendChild(Q)}Q=document.createElement("span");Q.className="title";_css(Q,{padding:"5px 5px 0 "+(T?0:"5px"),height:t.fontsize?t.fontsize+10:20,lineHeight:t.fontsize?t.fontsize+10:20,overflow:"hidden","float":"left",styleFloat:"left",cssFloat:"left",width:(E.duration>0?R-50:R)-10+"px",fontSize:(t.fontsize?t.fontsize:13)+"px",fontWeight:t.fontweight?t.fontweight:"bold"});Q.innerHTML=E?E.title:"";J.appendChild(Q);if(E.description){T=document.createElement("span");T.className="description";_css(T,
{display:"block","float":"left",styleFloat:"left",cssFloat:"left",margin:0,paddingLeft:Q.style.paddingLeft,paddingRight:Q.style.paddingRight,lineHeight:(t.fontsize?t.fontsize+4:16)+"px",overflow:"hidden",position:"relative"});T.innerHTML=E.description;J.appendChild(T)}S.appendChild(J);return S}function y(){w.innerHTML="";if(H=m()){items=[];u=l();for(var T=0;T<H.length;T++){var E=p(T);E.onclick=v(T);u.appendChild(E);items.push(E)}C=q.jwGetPlaylistIndex();n(C)();w.appendChild(u);if(_utils.isIOS()&&
window.iScroll){u.style.height=t.itemheight*H.length+"px";new iScroll(w.id)}}}function m(){for(var T=q.jwGetPlaylist(),E=[],S=0;S<T.length;S++)T[S]["ova.hidden"]||E.push(T[S]);return E}function v(T){return function(){q.jwPlaylistItem(T);q.jwPlay(true)}}function A(){u.scrollTop=q.jwGetPlaylistIndex()*t.itemheight}function B(){return t.thumbs.toString().toLowerCase()=="true"}function s(T){if(C>=0){n(C)();C=T.index}n(T.index)();A()}function F(){if(t.position==a.html5.view.positions.OVER)switch(q.jwGetState()){case a.api.events.state.IDLE:_show(w);
break;default:_hide(w);break}}function g(){for(var T in L)L[T]=j(T)}function j(T){return q.skin.getSkinElement("playlist",T)}var q=e,t=a.utils.extend({},b,q.skin.getComponentSettings("playlist"),f);if(!(t.position==a.html5.view.positions.NONE||typeof a.html5.view.positions[t.position]=="undefined")){var w,r,z,H,u,C=-1,L={background:undefined,item:undefined,itemOver:undefined,itemImage:undefined,itemActive:undefined};this.getDisplayElement=function(){return w};this.resize=function(T,E){r=T;z=E;q.jwGetFullscreen()?
_hide(w):_css(w,{display:"block",width:r,height:z})};this.show=function(){_show(w)};this.hide=function(){_hide(w)};h();return this}}})(jwplayer);(function(a){function b(c){if(a.utils.isYouTube(c.file))return"youtube";else{var e=a.utils.extension(c.file),f;if(e&&a.utils.extensionmap[e]){if(e=="m3u8")return"video";f=a.utils.extensionmap[e].html5}else if(c.type)f=c.type;if(f){c=f.split("/")[0];if(c=="audio")return"sound";else if(c=="video")return c}}return""}a.html5.playlistitem=function(c){c=a.utils.extend({},
{author:"",date:"",description:"",image:"",link:"",mediaid:"",tags:"",title:"",provider:"",file:"",streamer:"",duration:-1,start:0,currentLevel:-1,levels:[]},c);if(c.type){c.provider=c.type;delete c.type}if(c.levels.length===0)c.levels[0]=new a.html5.playlistitemlevel(c);c.provider=c.provider?c.provider.toLowerCase():b(c.levels[0]);return c}})(jwplayer);(function(a){a.html5.playlistitemlevel=function(b){var c={file:"",streamer:"",bitrate:0,width:0};for(var e in c)if(a.utils.exists(b[e]))c[e]=b[e];
return c}})(jwplayer);(function(a){a.html5.playlistloader=function(){function b(f){var h=[];try{h=a.utils.parsers.rssparser.parse(f.responseXML.firstChild);e.sendEvent(a.api.events.JWPLAYER_PLAYLIST_LOADED,{playlist:new a.html5.playlist({playlist:h})})}catch(l){c("Could not parse the playlist")}}function c(f){e.sendEvent(a.api.events.JWPLAYER_ERROR,{message:f?f:"Could not load playlist an unknown reason."})}var e=new a.html5.eventdispatcher;a.utils.extend(this,e);this.load=function(f){a.utils.ajax(f,
b,c)}}})(jwplayer);(function(a){a.html5.skin=function(){var b={},c=false;this.load=function(e,f){new a.html5.skinloader(e,function(h){c=true;b=h;f()},function(){new a.html5.skinloader("",function(h){c=true;b=h;f()})})};this.getSkinElement=function(e,f){if(c)try{return b[e].elements[f]}catch(h){a.utils.log("No such skin component / element: ",[e,f])}return null};this.getComponentSettings=function(e){if(c&&b&&b[e])return b[e].settings;return null};this.getComponentLayout=function(e){if(c)return b[e].layout;
return null}}})(jwplayer);(function(a){a.html5.skinloader=function(b,c,e){function f(){typeof F!="string"||F===""?h(a.html5.defaultSkin().xml):a.utils.ajax(a.utils.getAbsolutePath(F),function(j){try{if(a.utils.exists(j.responseXML)){h(j.responseXML);return}}catch(q){n()}h(a.html5.defaultSkin().xml)},function(){h(a.html5.defaultSkin().xml)})}function h(j){j=j.getElementsByTagName("component");if(j.length!==0)for(var q=0;q<j.length;q++){var t=j[q].getAttribute("name");m[t]={settings:{},elements:{},
layout:{}};for(var w=j[q].getElementsByTagName("elements")[0].getElementsByTagName("element"),r=0;r<w.length;r++)o(w[r],t);if((w=j[q].getElementsByTagName("settings")[0])&&w.childNodes.length>0){w=w.getElementsByTagName("setting");for(r=0;r<w.length;r++){var z=w[r].getAttribute("name"),H=w[r].getAttribute("value"),u=/color$/.test(z)?"color":null;m[t].settings[z]=a.utils.typechecker(H,u)}}if((w=j[q].getElementsByTagName("layout")[0])&&w.childNodes.length>0){w=w.getElementsByTagName("group");for(r=
0;r<w.length;r++){z=w[r];m[t].layout[z.getAttribute("position")]={elements:[]};for(H=0;H<z.attributes.length;H++){u=z.attributes[H];m[t].layout[z.getAttribute("position")][u.name]=u.value}H=z.getElementsByTagName("*");for(u=0;u<H.length;u++){var C=H[u];m[t].layout[z.getAttribute("position")].elements.push({type:C.tagName});for(var L=0;L<C.attributes.length;L++){var T=C.attributes[L];m[t].layout[z.getAttribute("position")].elements[u][T.name]=T.value}if(!a.utils.exists(m[t].layout[z.getAttribute("position")].elements[u].name))m[t].layout[z.getAttribute("position")].elements[u].name=
C.tagName}}}B=false;l()}}function l(){clearInterval(s);g||(s=setInterval(function(){p()},100))}function o(j,q){var t=new Image,w=j.getAttribute("name");j=j.getAttribute("src");if(j.indexOf("data:image/png;base64,")===0)j=j;else{var r=a.utils.getAbsolutePath(F);j=[r.substr(0,r.lastIndexOf("/")),q,j].join("/")}m[q].elements[w]={height:0,width:0,src:"",ready:false,image:t};t.onload=function(){y(t,w,q)};t.onerror=function(){g=true;l();A()};t.src=j}function n(){for(var j in m){var q=m[j];for(var t in q.elements){var w=
q.elements[t],r=w.image;r.onload=null;r.onerror=null;delete w.image;delete q.elements[t]}delete m[j]}}function p(){for(var j in m)if(j!="properties")for(var q in m[j].elements)if(!m[j].elements[q].ready)return;if(B===false){clearInterval(s);v(m)}}function y(j,q,t){if(m[t]&&m[t].elements[q]){m[t].elements[q].height=j.height;m[t].elements[q].width=j.width;m[t].elements[q].src=j.src;m[t].elements[q].ready=true;l()}else a.utils.log("Loaded an image for a missing element: "+t+"."+q)}var m={},v=c,A=e,B=
true,s,F=b,g=false;f()}})(jwplayer);(function(a){a.html5.api=function(b,c){function e(){m.state==a.api.events.state.PLAYING||m.state==a.api.events.state.BUFFERING?A.pause():A.play()}function f(s){return function(){return m[s]}}function h(s,F,g){return function(){var j=m.plugins.object[s];j&&j[F]&&typeof j[F]=="function"&&j[F].apply(j,g)}}function l(s){return function(){if(B&&typeof B[s]=="function")return B[s].apply(this,arguments);else _utils.log("Could not call instream method - instream API not initialized")}}
function o(){if(m.config.playlistfile){m.addEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,n);m.loadPlaylist(m.config.playlistfile)}else if(typeof m.config.playlist=="string"){m.addEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,n);m.loadPlaylist(m.config.playlist)}else{m.loadPlaylist(m.config);setTimeout(n,25)}}function n(s){m.removeEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,n);m.setupPlugins();v.setup();s={id:p.id,version:p.version};A.playerReady(s)}var p={},y=document.createElement("div");
b.parentNode.replaceChild(y,b);y.id=b.id;p.version=a.version;p.id=y.id;var m=new a.html5.model(p,y,c),v=new a.html5.view(p,y,m),A=new a.html5.controller(p,y,m,v);p.skin=new a.html5.skin;p.jwPlay=function(s){if(typeof s=="undefined")e();else s.toString().toLowerCase()=="true"?A.play():A.pause()};p.jwPause=function(s){if(typeof s=="undefined")e();else s.toString().toLowerCase()=="true"?A.pause():A.play()};p.jwStop=A.stop;p.jwSeek=A.seek;p.jwPlaylistItem=function(s){if(B){if(B.playlistClickable()){B.jwInstreamDestroy();
return A.item(s)}}else return A.item(s)};p.jwPlaylistNext=A.next;p.jwPlaylistPrev=A.prev;p.jwResize=A.resize;p.jwLoad=A.load;p.jwDetachMedia=A.detachMedia;p.jwAttachMedia=A.attachMedia;p.jwGetPlaylistIndex=f("item");p.jwGetPosition=f("position");p.jwGetDuration=f("duration");p.jwGetBuffer=f("buffer");p.jwGetWidth=f("width");p.jwGetHeight=f("height");p.jwGetFullscreen=f("fullscreen");p.jwSetFullscreen=A.setFullscreen;p.jwGetVolume=f("volume");p.jwSetVolume=A.setVolume;p.jwGetMute=f("mute");p.jwSetMute=
A.setMute;p.jwGetStretching=function(){return m.stretching.toUpperCase()};p.jwGetState=f("state");p.jwGetVersion=function(){return p.version};p.jwGetPlaylist=function(){return m.playlist};p.jwAddEventListener=A.addEventListener;p.jwRemoveEventListener=A.removeEventListener;p.jwSendEvent=A.sendEvent;p.jwDockSetButton=function(s,F,g,j){m.plugins.object.dock&&m.plugins.object.dock.setButton&&m.plugins.object.dock.setButton(s,F,g,j)};p.jwControlbarShow=h("controlbar","show");p.jwControlbarHide=h("controlbar",
"hide");p.jwDockShow=h("dock","show");p.jwDockHide=h("dock","hide");p.jwDisplayShow=h("display","show");p.jwDisplayHide=h("display","hide");var B;p.jwLoadInstream=function(s,F){B||(B=new a.html5.instream(p,m,v,A));setTimeout(function(){B.load(s,F)},10)};p.jwInstreamDestroy=function(){B&&B.jwInstreamDestroy()};p.jwInstreamAddEventListener=l("jwInstreamAddEventListener");p.jwInstreamRemoveEventListener=l("jwInstreamRemoveEventListener");p.jwInstreamGetState=l("jwInstreamGetState");p.jwInstreamGetDuration=
l("jwInstreamGetDuration");p.jwInstreamGetPosition=l("jwInstreamGetPosition");p.jwInstreamPlay=l("jwInstreamPlay");p.jwInstreamPause=l("jwInstreamPause");p.jwInstreamSeek=l("jwInstreamSeek");p.jwDestroy=function(){A.destroy()};p.jwGetLevel=function(){};p.jwGetBandwidth=function(){};p.jwGetLockState=function(){};p.jwLock=function(){};p.jwUnlock=function(){};m.config.chromeless&&!a.utils.isIOS()?o():p.skin.load(m.config.skin,o);return p}})(jwplayer)};var KongAds=function(){function a(f){return f.replace(/[^a-z0-9-+_]+/gi,"_").substr(0,10)}function b(f,h){var l=[],o=[],n=a(f);if(h instanceof Array){for(f=h.length;f--;)o[f]=a(h[f]);l.push([n,o])}else l.push([n,a(h)]);return l}function c(f){var h=[];if(1==f.length)for(var l in f[0])h=h.concat(b(l,f[0][l]));else if(2==f.length)h=h.concat(b(f[0],f[1]));return h}function e(f){this.initialize(f)}e.prototype={initialize:function(f){this._network_id=f.networkId;this._publisher_id=f.publisherId;this._rendering_mode=
f.renderingMode;this._slots={}},defineAd:function(f,h,l){var o=this,n="/"+this._network_id+"/"+this._publisher_id+"/"+f;googletag.cmd.push(function(){o._slots[f]=googletag.defineSlot(n,[h,l],f+"-ad-slot").addService(googletag.pubads())});return this},setTargeting:function(){var f=arguments;googletag.cmd.push(function(){for(var h=googletag.pubads(),l=c(f),o=l.length;o--;)h.setTargeting(l[o][0],l[o][1])});return this},setGenderTargeting:function(f){googletag.cmd.push(function(){googletag.pubads().set("demographic_gender",
f)});return this},setAgeTargeting:function(f){googletag.cmd.push(function(){googletag.pubads().set("demographic_age",f)});return this},displayAd:function(f){googletag.cmd.push(function(){googletag.display(f+"-ad-slot")});return this},requestAds:function(){if(document.location.search.match(/username=/)||document.referrer.match(/username=/))return this;googletag.cmd.push(function(){var f=googletag.pubads();f[renderingMode]();f.enableSingleRequest();googletag.enableServices()});return this},getSlot:function(f){return this._slots[f]},
onDealspotOfferUnavailable:function(){$("dealspot_banner_holder").remove();$("game_leaderboad_banner_holder").show()},onDealspotOfferAvailable:function(){$("game_leaderboad_banner_holder").remove();$("dealspot_target").update($("dealspot_banner_holder").addClassName("horizontal_ad").setStyle({top:"",left:""}))},onDealspotOpen:function(){$("game").setStyle({top:"-10000px",left:"-10000px"})},onDealspotClose:function(){$("game").setStyle({top:"",left:""})}};return{KongDFPAds:e}}(),KongDFPAds=KongAds.KongDFPAds;function KredPackagePicker(a){this.initialize(a)}
KredPackagePicker.prototype={initialize:function(a){this._kred_packages=a.kred_packages;this._active_user=a.active_user;this._purchase_methods={};this._package_purchase_selected_callbacks={};this._payment_options_preselected_callbacks={};this._payment_options_selected_callbacks={};this._kav_required=a.kav_required;this._package_choices_node=null;this._required_kreds=a.required_kreds;this._current_balance=a.current_balance;this._use_stored_cc=this._has_stored_cc=a.has_stored_cc;this._use_stored_paypal=
this._has_paypal_billing_agreement=a.has_paypal_billing_agreement;this._blocked_for_cc=a.blocked_for_cc;this._kred_deficit=[this._required_kreds-this._current_balance,0].max();this._payment_option_selected=false;var b=this;document.observe("dom:loaded",function(){b.showFirstPage(a.preselected_payment_method)})},showFirstPage:function(a){var b=this,c=this._purchase_methods[a],e=function(f){(f=b._payment_options_preselected_callbacks[f])&&f.each(function(h){h(c,b)})};if(c){e(c.purchase_record_class);
this.showPreselectedPaymentOption(a)}else{b.recordAnalyticsPageview("/kred_lightbox/payment_selection");$("payment_method_selection").show()}active_user.getsBonus()&&$$(".ugc_bonus").invoke("show")},customPackageVariables:function(){return Object.toQueryString({uid:this._active_user.id(),kpid:this._selected_kred_package.id})},returnToSelectPackage:function(){this.reselectPurchaseMethod()},reselectPurchaseMethod:function(){this.selectPaymentOption(this._selected_payment_option)},returnToSelectPaymentMethod:function(){$$(".kred_flow_step").each(Element.hide);
$("payment_method_selection").show();$("blocked_for_cc_message").hide();this._use_stored_cc=this._has_stored_cc;this.recordAnalyticsPageview("/kred_lightbox/payment_selection")},checkIfVerificationRequired:function(){if(this._kav_required){window.location="/accounts/"+active_user.username()+"/kred_account_verification/edit";return true}},hideKredFlow:function(){$$(".kred_flow_step").each(Element.hide)},addPurchaseMethod:function(a){this._purchase_methods[a.purchase_record_class]=a},showPreselectedPaymentOption:function(a){if(a=
this._purchase_methods[a])this.selectPaymentOption(a.purchase_record_class);else this._payment_option_selected||$("payment_method_selection").show()},returnToRegularPaypal:function(){this._use_stored_paypal=false;this.reselectPurchaseMethod()},resetStoredPaypal:function(){this._use_stored_paypal=this._has_paypal_billing_agreement},returnToRegularCC:function(){this._use_stored_cc=false;this.reselectPurchaseMethod()},blockForCC:function(){this._blocked_for_cc=true},selectPaymentOption:function(a){if(this.useStoredCC()&&
a=="CreditCardTransaction"){$("kred_discount_message")&&$("kred_discount_message").show();$("gamestop-employee-discount-message")&&$("gamestop-employee-discount-message").show()}else{$("kred_discount_message")&&$("kred_discount_message").hide();$("gamestop-employee-discount-message")&&$("gamestop-employee-discount-message").hide()}var b=this._purchase_methods[a];this._payment_option_selected=true;if(!this.checkIfVerificationRequired()){this.hideKredFlow();this._selected_payment_option=a;this.setPackageClassForPurchaseMethod(a);
this.recordSelectedPaymentOptionAnalytics(b);$$(".kred_purchase_method_name").each(function(f){f.update(b.name)});this.showPackageSelection(b);$$(".package-selection-footer, .package-selection-sidebar").each(Element.hide);$("generic-package-selection-sidebar").show();$("generic-package-selection-footer").show();$$(".package-selection-sidebar .powerup_rewards_upsell").each(Element.show);$$(".package-selection-sidebar .gamestop_employee_upsell").each(Element.show);$$("#employee_kred_text").each(Element.hide);
$$(".js_kred_discount_message").invoke("show");var c=this,e=this._payment_options_selected_callbacks[b.purchase_record_class];e&&e.each(function(f){f(b,c)});a.match(/Boku/)&&$$(".js_kred_discount_message").invoke("hide");this.populateFormValuesAndSummaries()}},setPackageClassForPurchaseMethod:function(a){a.match(/Boku/i)?$("kred_packages_choices_div").removeClassName("kred_sale_purchase_method"):$("kred_packages_choices_div").addClassName("kred_sale_purchase_method")},recordSelectedPaymentOptionAnalytics:function(a){a=
a.preselect_param;if("mobile"==a)a="boku";if("game_card"==a)this.recordAnalyticsPageview("/kred_lightbox/ugc/code_entry");else"offers"==a?this.recordAnalyticsPageview("/kred_lightbox/trialpay/iframe"):this.recordAnalyticsPageview("/kred_lightbox/"+a+"/package_selection")},addPackage:function(a){if(this._package_choices_node===null)this._package_choices_node=$("kred_package_choices_ul");this._package_choices_node.insert((new Template($(a.package_template_id||(a.discounted_dollar_price!=a.dollar_price?
"kred_package_discounted_template":"kred_package_template")).innerHTML)).evaluate(a),{position:"bottom"});a.special_info&&$("kred_package_special_info_"+a.id).update(this.processPackageSpecialInfo(a.id,a.special_info));a.kred_bonus&&active_user.getsBonus()&&$("kred_bonus_info_"+a.id).show();if(a=$$("#kred_package_"+a.id+" input,type[radio]")[0]){var b=this.populateFormValuesAndSummaries.bind(this);a.observe("click",b);a.observe("change",b)}},processPackageSpecialInfo:function(a,b){if(b.length<100)return b;
var c=this,e=new Element("a",{href:"#",id:"show_package_special_info_"+a});e.update("(show important info)");e.observe("click",function(f){c.packageSpecialInfoShowMore(a,b);Event.stop(f);return false});return e},packageSpecialInfoShowMore:function(a,b){var c=$("kred_package_special_info_hover_"+a),e=$("kred_package_special_info_hover_content_"+a);$("kred_package_special_info_hover_close_"+a).observe("click",function(f){package_picker.hideSpecialInfoHover(a);Event.stop(f);return false});e.update(b);
$("kred_package_special_info_"+a).hide();c.show()},hideSpecialInfoHover:function(a){$("kred_package_special_info_hover_"+a).hide();$("kred_package_special_info_"+a).show()},setPackagesForPurchaseMethod:function(a,b){var c=this;a=this._purchase_methods[a];var e=this._kred_packages.pluck("id"),f=b.pluck("id");a.kred_package_ids=f;b.each(function(h){if(!e.include(h.id)){c._kred_packages.push(h);c.addPackage(h)}})},updatePackageSelectionForPurchaseMethod:function(a){var b=this._purchase_methods[a],c=
this.recommendPackage(b);this._kred_packages.each(function(e){var f=$("kred_package_"+e.id);if(f){b.kred_package_ids.include(e.id)?f.show():f.hide();if(f=$("kred_package_radio_"+e.id))f.checked=e.id==c}})},showPackageSelection:function(a){var b=this.recommendPackage(a),c=$("kred_package_selection");this.hidePackageSelection();a.kred_package_ids.each(function(e){$("kred_package_"+e).show();$("kred_package_radio_"+e).checked=e==b});$("selectPackageButton").show();$("kred_package_choices_wrapper").writeAttribute("class",
"kred_package_wrapper_"+a.preselect_param);c.show()},kredDeficit:function(){return this._kred_deficit},kredPackageById:function(a){return this._kred_packages.find(function(b){return b.id==a})},recommendPackage:function(a){var b=this.dynamicPackageRecommendation(a);if(b)return b;if(!this.kredDeficit())return this.defaultRecommendation(a);return a.kred_package_ids.find(function(c){return(c=this.kredPackageById(c))&&c.kred_amount>=this.kredDeficit()}.bind(this))||this.defaultRecommendation(a)},dynamicPackageRecommendation:function(a){if("GameStopCardTransaction"==
a.purchase_record_class)if(a.kred_package_ids.include("gs_dynamic_package"))return"gs_dynamic_package";else if(a.kred_package_ids.length<5)return a.kred_package_ids.last();return null},defaultRecommendation:function(a){return a.preferred_kred_package_id||a.kred_package_ids.last()},hidePackageSelection:function(){$$(".kred_package").each(Element.hide)},selectedPurchaseMethod:function(){return this._purchase_methods[this._selected_payment_option]},selectedKredPackage:function(){var a=this.selectedPurchaseMethod().kred_package_ids.find(function(b){return $("kred_package_radio_"+
b).checked});return this._kred_packages.find(function(b){return b.id==a})},selectPackage:function(){$$(".kred_flow_step").each(Element.hide);var a=this._purchase_methods[this._selected_payment_option];this.recordSelectedPackageAnalytics(a);var b=this,c=this.selectedKredPackage();a=this._package_purchase_selected_callbacks[a.purchase_record_class];this._selected_kred_package=c;this.populateFormValuesAndSummaries();a&&a.each(function(e){e(c,b)});this.showPurchaseForm()},recordSelectedPackageAnalytics:function(a){var b;
if("KredPackageCreditCardPurchase"==a.purchase_record_class)b=this._has_stored_cc?"/kred_lightbox/credit_card/old_stored_card":"/kred_lightbox/credit_card/form";else if("PaypalTransaction"==a.purchase_record_class)b="/kred_lightbox/paypal/waiting_screen";else if("BokuTransaction"==a.purchase_record_class)b="/kred_lightbox/boku/iframe";else if("PaysafeTransaction"==a.purchase_record_class)b="/kred_lightbox/paysafe/iframe";b&&this.recordAnalyticsPageview(b)},populateFormValuesAndSummaries:function(){var a=
this,b=this.selectedKredPackage(),c;if(!(!b||"BokuTransaction"==this._selected_payment_option)){c=active_user.getsBonus()?b.kred_amount:b.kred_amount_without_bonus;$$(".kred_purchase_form_kred_package_id").each(function(e){e.value=b.id});$$(".kred_purchase_form_kred_package_dollar_price").each(function(e){var f=b.discounted_dollar_price.gsub("$","");e.value=f}.bind(this));$$(".kred_purchase_form_kred_package_kred_amount").each(function(e){e.value=c});$$(".kred_purchase_form_kred_package_item_name").each(function(e){e.value=
c+" Kreds"});$$(".kred_purchase_form_kred_package_custom_package_variables").each(function(e){e.value=a.customPackageVariables()});$$(".kred_purchase_summary_dollar_price").each(function(e){e.update(b.discounted_dollar_price)});$$(".kred_purchase_summary_kred_amount").each(function(e){e.update(c)})}},showPurchaseForm:function(){$("purchase_method_form_"+this._selected_payment_option).show()},addPreselectedPaymentOptionCallback:function(a,b){this._payment_options_preselected_callbacks[a]||(this._payment_options_preselected_callbacks[a]=
[]);this._payment_options_preselected_callbacks[a].push(b)},addSelectedPaymentOptionCallback:function(a,b){this._payment_options_selected_callbacks[a]||(this._payment_options_selected_callbacks[a]=[]);this._payment_options_selected_callbacks[a].push(b)},addSelectedPackageCallback:function(a,b){this._package_purchase_selected_callbacks[a]||(this._package_purchase_selected_callbacks[a]=[]);this._package_purchase_selected_callbacks[a].push(b)},displayCurrency:function(a,b){output="";if($w("USD CAD").include(a))output+=
"$";output+=b.toFixed(2);if("USD"!=a)output+=" "+a;return output},setCreditCardAsSelectedPaymentMethod:function(){this._selected_payment_option="KredPackageCreditCardPurchase"},reportKredPurchase:function(a){this.recordAnalyticsPageview("/purchase/kreds?"+Object.toQueryString(a))},recordAnalyticsPageview:function(a){pageTracker&&pageTracker._trackPageview(a)},handleSuccessfulStoredCCExpirationUpdate:function(a){$("update_expired_stored_cc_form").hide();$("stored_cc_expiration_date").update(a);$("stored_cc_form_container").show()},
handleFailedStoredCCExpirationUpdate:function(a){$("update_cc_expiration_submit_button").restore();$("expiration_update_error_message").update(a);$("expiration_update_error_message_block").show()},hasStoredPayPal:function(){return this._has_paypal_billing_agreement},useStoredPayPal:function(){return this._use_stored_paypal},hasStoredCC:function(){return this._has_stored_cc},useStoredCC:function(){return this._use_stored_cc},clearStoredCC:function(){this._has_stored_cc=this._use_stored_cc=false},isVerificationRequired:function(){return this._kav_required},
isBlockedForCC:function(){return this._blocked_for_cc},failedStoredCC:function(){this.clearStoredCC();this.selectPackage()},failStoredPayPal:function(){this._has_paypal_billing_agreement=this._use_stored_paypal=false}};var detect=navigator.userAgent.toLowerCase(),total,thestring,lightbox=Class.create();
lightbox.prototype={yPos:0,xPos:0,initialize:function(a,b){this.wait_for_shutdown=this._activated=false;this.done_class_name="done";if(typeof a=="string"){this.content=a;this.activate()}else{this.content=a.href;a.observer_function=this.activate.bindAsEventListener(this);Event.observe(a,"click",a.observer_function,true);a.onclick=function(){return false}}this._on_close_callbacks=[];b&&this._on_close_callbacks.push(b)},shutdown:function(){if(!this.wait_for_shutdown){this.stopListening();this.deactivate.apply(this,
arguments)}},shutdownWithoutCallbacks:function(){this._on_close_callbacks=[];this.shutdown.apply(this,arguments)},addOnCloseCallback:function(a){if(!this._on_close_callbacks)this._on_close_callbacks=[];this._on_close_callbacks.push(a)},clearOnCloseCallbacks:function(){this._on_close_callbacks=[]},initializeKredTipPurchaseFrame:function(a,b){b&&this.addOnCloseCallback(b);this.addOnCloseCallback(function(){new Ajax.Request(active_user.gamePath()+"/game_tips",{method:"get"})});this.initializeKredPurchaseFrame(a)},
initializeKredItemPurchaseFrame:function(a){top.kredPurchaseSuccess=false;top.kredItemOrderId=undefined;this.addOnCloseCallback(function(b){b=b||{success:false};b.success=!!b.success;if(!b.item_order_id)b.item_order_id=top.kredItemOrderId;try{holodeck.konduit().dispatchEvent({type:"purchase_result",data:b})}catch(c){}});this.initializeKredPurchaseFrame(a)},initializeKredCardCartPurchaseFrame:function(a){this.addOnCloseCallback(function(b){if(b&&b.success)top.location=top.location.href});this.initializeKredPurchaseFrame(a)},
secureUrlForPath:function(a){var b=window.location.host,c=window.lightboxSecureProtocol;if(b.match(/local/)||b.match(/webhop/))c="http://";return c+b+a},initializeKredPurchase:function(a,b){var c=this.secureUrlForPath("/kred_package_purchases/new"),e={};if(a)e.purchase_method=a;if(b)e.tracking_code=b;a=Object.toQueryString(e);if(a.length>0)c=c+"?"+a;this.initializeKredPurchaseFrame(c)},initializeShoutFrame:function(a,b){this.initializeKongregateLightboxFromAjax("/api/new_shout?game_id="+a+"&message="+
b,{done_class_name:"lightbox_login"})},initializeFeedPostFrame:function(a,b,c,e){var f="";$H(e).each(function(h){f+="kv_params["+h[0]+"]="+h[1]+"&"});this.initializeKongregateLightboxFromAjax("/api/feed_post?game_id="+a+"&message="+b+"&image_uri="+c+"&"+f,{done_class_name:"lightbox_login"})},initializeInvitationFrame:function(a,b,c,e){var f="";$H(e).each(function(h){f+="kv_params["+h[0]+"]="+h[1]+"&"});this.initializeKongregateLightboxFromAjax("/api/new_invitation?game_id="+a+"&message="+b+"&filter="+
c+"&"+f,{done_class_name:"lightbox_invite"})},initializeKredPurchaseFrame:function(a){if(!this._kongregate_lightbox_wrapper_template)this._kongregate_lightbox_wrapper_template=new Template($("kongregate_lightbox_wrapper_template").innerHTML);this.staticContent=this._kongregate_lightbox_wrapper_template.evaluate({iframe_src:a});this.done_class_name="kred_purchase";this.activate()},userAuthenticated:function(){if(active_user.isAuthenticated())return true;else{var a="/accounts/new/behind_login";if(typeof holodeck!=
"undefined")a=a+"?game_id="+holodeck.gameId();var b={done_class_name:"lightbox_login"};if(active_user.signinLightboxRegistrationFirst())b.afterStaticContentLoad=lightbox.prototype.toggleRegistration;this.initializeKongregateLightboxFromAjax(a,b);return false}},initializePremiumMembershipPurchase:function(a,b){a=this.secureUrlForPath("/premium_membership_purchases/new?referer="+a);var c=new Template($("kongregate_lightbox_wrapper_template").innerHTML);if(b)a+="&initial_tab="+b;this.staticContent=c.evaluate({iframe_src:a});
this.done_class_name="kred_purchase";this.activate()},initializeKongregateLightboxFromAjax:function(a,b){b||(b={});if(!this._kongregate_lightbox_wrapper_template_noframe)this._kongregate_lightbox_wrapper_template_noframe=new Template($("kongregate_lightbox_wrapper_template_noframe").innerHTML);this.staticContent=this._kongregate_lightbox_wrapper_template_noframe.evaluate({});this.staticContentDivUrl=a;this.afterStaticContentLoad=b.afterStaticContentLoad;if(b.no_class_name==undefined)this.done_class_name=
["kred_purchase"].concat(b.done_class_name||[]).join(" ");this.activate()},initializeKongregateLightboxFromContent:function(a,b){b||(b={});var c=$(document.createElement("div"));c.innerHTML=(new Template($("kongregate_lightbox_wrapper_template_noframe").innerHTML)).evaluate({});c.down("#lightbox_form").update(a);c.down("#kongregate_lightbox_spinner").hide();this.staticContent=c.innerHTML;this.done_class_name=["kred_purchase"].concat(b.done_class_name||[]).join(" ");this.afterStaticContentLoad=b.afterStaticContentLoad;
this.activate()},keyUpHandler:function(a){if(a.keyCode==27){if(this.ajaxRequest){this.ajaxRequest.transport.abort();this.ajaxRequest=null}this.deactivate()}},clickHandler:function(a){if(a.target.id=="overlay"){if(this.ajaxRequest){this.ajaxRequest.transport.abort();this.ajaxRequest=null}this.deactivate()}},activate:function(a){if($("lightbox"))if(!this._activated){this._activated=true;if(!this.done_class_name)this.done_class_name="done";if(Prototype.Browser.IE){this.getScroll();this.prepareIE("100%",
"hidden");this.setScroll(0,0);this.hideSelects("hidden")}this.cachedKeyUpHandler=this.keyUpHandler.bindAsEventListener(this);this.cachedClickHandler=this.clickHandler.bindAsEventListener(this);$(document).observe("keyup",this.cachedKeyUpHandler);$(document).observe("click",this.cachedClickHandler);this.hideHiddenElements();setTimeout(function(){$("lightbox").className="loading";this.displayLightbox("block")}.bind(this),10);a&&typeof a=="object"&&a.stopPropagation&&a.stopPropagation()}},deactivate:function(){if(this._activated){this._activated=
false;this.staticContent=undefined;var a=$("lbContent");a&&a.remove();if(Prototype.Browser.IE){this.setScroll(0,this.yPos);this.prepareIE("auto","auto");this.hideSelects("visible")}$(document).stopObserving("keyup",this.cachedKeyUpHandler);$(document).stopObserving("click",this.cachedClickHandler);this.displayLightbox("none");this.done_class_name="done";(function(b,c){b.onClose.apply(b,c)}).defer(this,arguments);this.showHiddenElements()}},prepareIE:function(a,b){Prototype.Browser.IE6&&$$("html, body").each(function(c){c.setStyle({height:a,
overflow:b})})},hideSelects:function(a){selects=document.getElementsByTagName("select");for(i=0;i<selects.length;i++)selects[i].style.visibility=a},domElementsToHide:function(){return $$("object").concat($$(".ad")).select(function(a){return a&&"konduit"!=a.id&&"gamediv"!=a.id})},hideHiddenElements:function(){this.moveGameDivOffScreen();var a=this._dom_elements_actually_hidden=[];this.domElementsToHide().each(function(b){if("visible"==b.getStyle("visibility")){a.push(b);Prototype.Browser.Safari503?
b.hide():b.setStyle({visibility:"hidden"});b.hiddenByLightbox=true}});this.hideGameInIFrame()},showHiddenElements:function(){this.moveGameDivOnScreen();if(this._dom_elements_actually_hidden){this._dom_elements_actually_hidden.each(function(a){Prototype.Browser.Safari503?a.show():a.setStyle({visibility:"visible"});a.hiddenByLightbox=false});this.showGameInIFrame()}},hideGameInIFrame:function(){},showGameInIFrame:function(){},shouldMoveGameDiv:function(){return active_user&&active_user.isGamePage()},
moveGameDivOffScreen:function(){$("game")&&this.shouldMoveGameDiv()&&$("game").setStyle({top:"-10000px",left:"-10000px"})},moveGameDivOnScreen:function(){$("game")&&this.shouldMoveGameDiv()&&$("game").setStyle({top:"",left:""})},getScroll:function(){if(self.pageYOffset)this.yPos=self.pageYOffset;else if(document.documentElement&&document.documentElement.scrollTop)this.yPos=document.documentElement.scrollTop;else if(document.body)this.yPos=document.body.scrollTop},setScroll:function(a,b){window.scrollTo(a,
b)},reloadInfoFromUrl:function(a,b){if($("lightbox_form")){if(b)$("lightbox").className=b;$("lightbox_form").update("");$("kongregate_lightbox_spinner").show();new Ajax.Updater("lightbox_form",a,{method:"get",evalScripts:true,onComplete:function(){Element.hide("kongregate_lightbox_spinner");this.afterStaticContentLoad&&this.afterStaticContentLoad();this.afterStaticContentLoad=undefined}.bind(this)})}},displayLightbox:function(a){$("overlay").style.display=a;$("lightbox").style.display=a;a!="none"&&
this.loadInfo()},loadInfo:function(){if(this.staticContent){this.renderContents(this.staticContent);this.staticContent=undefined;if(this.staticContentDivUrl){this.ajaxRequest=new Ajax.Updater("lightbox_form",this.staticContentDivUrl,{method:"get",evalScripts:true,onComplete:function(){Element.hide("kongregate_lightbox_spinner");this.afterStaticContentLoad&&this.afterStaticContentLoad();this.afterStaticContentLoad=undefined}.bind(this)});this.staticContentDivUrl=undefined}else{this.afterStaticContentLoad&&
this.afterStaticContentLoad();this.afterStaticContentLoad=undefined}}else new Ajax.Request(this.content,{method:"get",parameters:"",onComplete:this.processInfo.bindAsEventListener(this)})},processInfo:function(a){this.renderContents(a.responseText)},renderContents:function(a){a="<div id='lbContent'>"+a+"</div>";var b=$("lbLoadMessage");new Insertion.Before(b,a);b.hide();$("lightbox").className=this.done_class_name;this.actions()},actions:function(){lbActions=document.getElementsByClassName("lbAction");
var a=document.getElementById("username");a&&Prototype.Browser.Gecko&&Prototype.Platform.Macintosh&&a.focus();for(i=0;i<lbActions.length;i++){Event.observe(lbActions[i],"click",this[lbActions[i].rel].bindAsEventListener(this),false);lbActions[i].onclick=function(){return false}}},insert:function(a){link=Event.element(a).parentNode;Element.remove($("lbContent"));new Ajax.Request(link.href,{method:"post",parameters:"",onComplete:this.processInfo.bindAsEventListener(this)})},toggleRegistration:function(){var a=
$("lightbox"),b=$("lightboxlogin"),c=$("lightboxregister"),e,f,h;if(c.style.display=="block"){e="none";f="block";h="kred_purchase lightbox_login";active_user.focusFormField("username")}else{e="block";f="none";h="kred_purchase";active_user.focusFormField("user_username")}if(b)b.style.display=f;c.style.display=e;a.className=h;if(pageTracker){pageTracker._trackEvent("Registration","begin_create");pageTracker._trackPageview("/accounts/begin_create")}},onClose:function(){if(this._on_close_callbacks)for(var a=
arguments;this._on_close_callbacks.length>0;)this._on_close_callbacks.pop().apply(this,a);this._on_close_callbacks=[]},stopListening:function(){$$(".lbOn").each(function(a){a.stopObserving("click",a.observer_function,true);a.getElementsBySelector("a").each(function(b){if(b.original_onclick){b.onclick=b.original_onclick;b.original_onclick=null}})})}};function initialize(){addLightboxMarkup();lbox=document.getElementsByClassName("lbOn");for(i=0;i<lbox.length;i++)valid=new lightbox(lbox[i])}
function addLightboxMarkup(){bod=document.getElementsByTagName("body")[0];overlay=document.createElement("div");overlay.id="overlay";lb=document.createElement("div");lb.id="lightbox";lb.className="loading";lb.innerHTML='<div id="lbLoadMessage"><p><img src="/images/presentation/indicator.gif" class="indicator" style="width: 16px; height: 16px;" /> Loading</p></div>';bod.appendChild(overlay);bod.appendChild(lb)};var NoteWatcher={watch:function(){var a=$("note"),b=$("submit");if(a.value!="")b.enable();else{b.disable();a.focus()}},setFocus:function(){$("note")&&$("note").focus()}};var NativeApp=function(){var a={};a.isInstalled=function(b){return a.isNativeApp()?kongNativeApp.isInstalled(b):false};a.isNativeApp=function(){return typeof kongNativeApp!="undefined"};a.downloadGame=function(b){if(a.isNativeApp())window.open(b);else window.location=b};a.launchGame=function(b){a.isNativeApp()&&kongNativeApp.sendMessage(JSON.stringify({opcode:"launch_game",params:{game_id:b}}))};a.browseGames=function(){window.location=a.isNativeApp()?"/games/index_native?installed="+kongNativeApp.getInstalledGameIds():
"/games/index_native"};return a}();function NewsPostBox(){this.initialize()}
NewsPostBox.prototype={initialize:function(){this._spinner=$("news_post_box_submission_button_spinner");this._submit_button=$("news_post_box_submission_button");this._text_area=$("game_news_feed_item_content")},onSuccess:function(a){new Ajax.Request("/feed_items/"+a,{method:"get",onSuccess:function(b){this._text_area.setValue("");this.onComplete();$("news_post_success_message").update("Your update has been posted.").show();$("news_post_error_message").update("").hide();containers=$$(".js_news_posts");
containers.each(function(c){c.insert({top:b.responseText});new Effect.Highlight(c.down(".js_feed_item"));c.down(".js_feed_item")&&c.down(".js_feed_item").next(4)&&c.down(".js_feed_item").next(4).hide()});$("news_post_box").hide();$("news_post_link").show()}.bind(this),onFailure:function(){this.onFailure("Shout successfully created, but failed to update page.")}.bind(this)})},onFailure:function(a){$("news_post_error_message").update(a).show();this.onComplete()},onComplete:function(){this._spinner.hide();
this._submit_button.show()},deletePost:function(a){var b=$$(".js_delete_post_button_"+a),c=$$(".js_delete_post_spinner_"+a),e=$$(".js_game_post_"+a),f=$$(".js_news_item_error_message");b.invoke("hide");c.invoke("show");new Ajax.Request("/feed_items/"+a,{method:"delete",onSuccess:function(){c.invoke("hide");f.invoke("hide");e.each(function(h){new Effect.Fade(h,{duration:1})})}.bind(this),onFailure:function(){f.each(function(h){h.update("Failed to delete news item").show()});b.invoke("show");c.invoke("hide");
e.each(function(h){new Effect.Highlight(h,{startcolor:"#cc3333"})})}.bind(this)})}};d=document;ndc=[];coc=[];kg=true;function zelph_onDOMload(a,b){es=zelph_getElementsBySelector(a);if(ndc[a]==null){ndc[a]=0;coc[coc.length]="zelph_onDOMload('"+a+"', '"+b+"')"}if(es.length>ndc[a]){nes=es.length;for(var c=ndc[a];c<nes;c++){theTarget=es[c];eval(b)}ndc[a]=nes}kg==true&&setTimeout("zelph_onDOMload('"+a+"', '"+b+"')",100);return true}
function zelph_getElementsBySelector(a){var b=[];var c=b="",e=a,f=[];if(a.indexOf(" ")>0){b=a.split(" ");c=b[0].split("#");if(c.length==1)return f;if(d.getElementById(c[1]))return d.getElementById(c[1]).getElementsByTagName(b[1]);return false}if(a.indexOf("#")>0){b=a.split("#");e=b[0];b=b[1]}if(b!=""){if(d.getElementById(b)){f.push(d.getElementById(b));return f}return false}if(a.indexOf(".")>0){b=a.split(".");e=b[0];c=b[1]}b=d.getElementsByTagName(e);if(c=="")return b;for(a=0;a<b.length;a++){curClass=
" "+b[a].className+" ";curClass.indexOf(" "+c+" ")!="-1"&&f.push(b[a])}return f}function zelph_stopIt(){kg="";for(x=0;x<coc.length;x++)eval(coc[x])}function zelph_addLoadEvent(a){var b=window.onload;window.onload=typeof window.onload!="function"?a:function(){b();a()}}zelph_addLoadEvent(zelph_stopIt);var PaymentHelpText={showHelpText:function(a,b){var c=$("help_wrapper");b=$(b);if(!(a==""||a==null))if(b.className!="error_msg"){b.appendChild(c);$("help_text").innerHTML=a;c.show()}},hideHelpText:function(){$("help_wrapper").hide()}};function PostMessageHandler(a){function b(){return l}function c(o){var n;l.find(function(y){return n=y(o)});if(n)n();else try{bumper.embedAd(o)}catch(p){}}function e(o){c.defer(o.evalJSON())}function f(o){l.push(o)}function h(o){if(o.origin==window.location.protocol+"//"+window.location.host)try{e(o.data)}catch(n){}}var l=[];window.attachEvent?window.attachEvent("onmessage",h):window.addEventListener("message",h,false);return{addCallback:f,getHandlers:b,runCallbackForUnparsedPayload:e}};VALID_LOYALTY_CARD_NUMBER_LENGTH=12;VALID_LOYALTY_CARD_NUMBER_LENGTH_MAX=14;window.onPowerupRewardsLinkFailure=function(a){$("create_powerup_rewards_account_submit").restore();$("powerup_rewards_link_info").hide();if(a.match(/must be activated/)){a=a.split(". ");$("powerup_rewards_link_error_message").update(a[0]+".");$("please_check_number_content").update(a[1])}else $("powerup_rewards_link_error_message").update(a);$("powerup_rewards_link_errors").show()};
window.validatePowerupRewardsLoyaltyNumber=function(a){var b=a.length;if(window.luhn(a)&&(b>=VALID_LOYALTY_CARD_NUMBER_LENGTH||b<=VALID_LOYALTY_CARD_NUMBER_LENGTH_MAX)){$$("#powerup_rewards_link_errors,#powerup_rewards_link_info").each(Element.hide);return true}else{onPowerupRewardsLinkFailure("Loyalty card number is an invalid format");return false}};
window.luhn=function(a){var b=[[0,2,4,6,8,1,3,5,7,9],[0,1,2,3,4,5,6,7,8,9]],c=0;a.toString().replace(/\D+/g,"").replace(/[\d]/g,function(e,f,h){c+=b[h.length-f&1][parseInt(e,10)]});return 0===c%10&&c>0};
window.startPollingOnWork=function(a,b){var c=window.parent,e=c.powerupRewardsPoller,f=c.powerupRewardsPollerTimeout;e&&e.stop();f&&c.clearTimeout(f);e=new c.Ajax.Poller("/accounts/"+a+"/powerup_rewards/show_work?id="+b,{on200:function(h){f&&c.clearTimeout(f);e.stop();if(h.responseJSON.success){c.$("powerup_rewards_link_in_progress").hide();c.$("powerup_rewards_link_success").show();top.kredPurchaseSuccess=true;window.kongMobileApp&&window.kongMobileApp.dispatchEvent("power_up_rewards_account_linked",
"")}else c.onPowerupRewardsLinkFailure(h.responseJSON.message)}});f=c.setTimeout(function(){e.stop();c.onPowerupRewardsLinkFailure("Linking your account timed out, please try again later.")},12E4);c.powerupRewardsPollerTimeout=f;c.powerupRewardsPoller=e;e.start()};PremiumOnlyLinks={attachHandlers:function(){$$("a.premium_only").each(function(a){var b=a.onclick?a.onclick.bind(a):null;a.onclick=PremiumOnlyLinks.capturedSelectorWrapper.bindAsEventListener(active_user,b)});$$(".premium_icon").each(function(a){a.observe("click",function(){active_user.isPremium()||(a.up(".game")?lightbox.prototype.initializePremiumMembershipPurchase("beta_game","beta_tab"):lightbox.prototype.initializePremiumMembershipPurchase("username_icon","icon_tab"))})});active_user.isPremium()||
active_user.createCSS(".premium_icon","cursor: pointer");active_user.addRunWhenAuthenticatedObserver(function(){active_user.isPremium()&&active_user.createCSS(".premium_icon","cursor: default")})},capturedSelectorWrapper:function(a,b){var c="function"==typeof b;if(this.isPremium()){if(c)return b(a)}else{lightbox.prototype.initializePremiumMembershipPurchase("beta_game","beta_tab");Event.stop(a);return false}}};ProfileGearControl=function(a){this.initialize(a)};
ProfileGearControl.prototype={initialize:function(a){this._rollover_delay=a.rollover_delay||0.2;this._hover_target=$(a.hover_target_id);this._container=$(a.container_id);this._target_hovering_class=a.target_hovering_class;if(this._hover_target&&this._container){var b=this;this._hover_target.observe("mouseover",function(){b.onMouseOver()});this._container.observe("mouseover",function(){b.onMouseOver()});this._hover_target.observe("mouseout",function(){b.onMouseLeave()});this._container.observe("mouseout",
function(){b.onMouseLeave()})}},clearTimer:function(){this._reset_timer&&clearTimeout(this._reset_timer);this._reset_timer=null},showDropdown:function(){this._target_hovering_class&&this._hover_target.addClassName(this._target_hovering_class);this._container.show()},closeDropdown:function(){this._target_hovering_class&&this._hover_target.removeClassName(this._target_hovering_class);this._container.hide()},onMouseLeave:function(){this.clearTimer();this._waiting=false;this._reset_timer=this.closeDropdown.bind(this).delay(this._rollover_delay)},
onMouseOver:function(){this.clearTimer();if(this._waiting)this._reset_timer=this.showDropdown.bind(this).delay(this._rollover_delay);else{this._waiting=true;this._reset_timer=this.showDropdown.bind(this).delay(0)}}};function ProfileShoutBox(a){this.initialize(a)}
ProfileShoutBox.prototype={initialize:function(a){var b=a.submit_button_id||"shout_box_submission_button";this._shout_box=$(a.shout_box_id||"shout_content");this._submit_button=$(b);this._spinner=$(b+"_spinner");this._long_width=a.long_width||100;this._short_width=a.short_width||90;this.addShoutBoxObservers()},addShoutBoxObservers:function(){this._shout_box.observe("focus",this.onFocus.bind(this));this._shout_box.getValue()&&this.onFocus()},onFocus:function(){active_user.isAuthenticated()?this._shout_box.setAttribute("cols",
this._short_width):active_user.activateInlineLogin({},true)},onSuccess:function(a){new Ajax.Request("/feed_items/shout/"+a,{onSuccess:function(b){this._submit_button.show();this._shout_box.setValue("");this._spinner.hide();$("shout_error_message").update("");container=$("feed_items_container");container.insert({top:b.responseText});feedHandler.setFirstFeedItemClass();new Effect.Highlight(container.down(".feed_item"));$("empty_activit_feed")&&$("empty_activit_feed").remove()}.bind(this),onFailure:function(){this.onFailure("Shout successfully created, but failed to update feed.")}})},
onFailure:function(a){$("shout_error_message").update(a).show();this._submit_button.show();this._spinner.hide()}};var ProgressBar=function(a,b){b||(b={});this.value=b.value||0;this.maxValue=b.maxValue||100;a.addClassName("progress-bar");this.bar=new Element("div",{"class":"progress-bar-bar"});a.insert(this.bar);this.label=new Element("span",{"class":"progress-bar-label"});this.bar.insert(this.label);this.updateDisplay()};ProgressBar.prototype.setValue=function(a){this.value=a;this.updateDisplay()};ProgressBar.prototype.setMaxValue=function(a){this.maxValue=a;this.updateDisplay()};
ProgressBar.prototype.updateDisplay=function(){this.label.update('<a href="/accounts/'+active_user.getAttributes().username+'/points">'+this.value+" PTS</a>");this.bar.setStyle({width:this.value/this.maxValue*100+"%"})};function QuickPick(a){this.initialize(a)}
QuickPick.prototype={initialize:function(a){this._destination=a.destination;this._template=a.template;this._destination.down()},setQuickPicks:function(a){this._quick_picks=a.map(function(b){b.plays=b.plays.withDelimiters()+" plays";return b});this._last_pick=parseInt(Math.random()*a.length,10)},pickOne:function(){this._last_pick=(this._last_pick+1)%this._quick_picks.length;this._destination.update(this._template.evaluate(this._quick_picks[this._last_pick]))},spin:function(a,b,c){if(0==arguments.length)this.spin(10,
1.4,300);else{this.pickOne();a<c&&setTimeout(this.spin.bind(this,a*b,b,c),a)}if(!this._ever_spun){this._ever_spun=true;this.prefetchIcons()}},prefetchIcons:function(){var a=$(document.body);this._quick_picks.each(function(b){a.insert(new Element("img",{src:b.icon,style:"display:none"}))})}};RegistrationFormValidator=function(a,b){function c(y,m){if(y.getValue()==""){l(y,tr8nProxy.tr(m+" can't be blank"));return false}return true}function e(y,m,v){if(y.getValue().length<v){l(y,tr8nProxy.tr(m+" is too short, needs to be {minimum||character, characters} or longer","",{minimum:v}));return false}return true}function f(y){if(!y.getValue().match(RFC822SingleEmailRegex)){l(y,tr8nProxy.tr("Invalid email address"));return false}return true}function h(y,m){$(y).up("div.form_block, dl").down(".error_block").insert((new Element("span",
{"class":"name_validation validation_symbol",id:"availability_success"})).update(m||"&nbsp;"))}function l(y,m){y=$(y).up("div.form_block, dl").down(".error_block");var v=y.down("ul");if(!v){v=new Element("ul");y.insert(v)}v.insert((new Element("li")).update(m))}function o(y){$(y).up("div.form_block, dl").down(".error_block").innerHTML=""}function n(y){return y.sub("%s",b.fieldIdPrefix)}b||(b={});if(!b.fieldIdPrefix)b.fieldIdPrefix="user";var p=a.down(n("input#%s_username"));new AvailabilityCheck(p,
{clear:function(){o(p);p.removeClassName("with_error")},success:function(){h(p,tr8nProxy.tr("Username available!"))},failure:function(y){p.addClassName("with_error");l(p,y)},generatedUsername:b.generatedUsername,validateLength:true});$(n("%s_password")).observe("blur",function(y){y=y.element();o(y);if(c(y,"Password")&&e(y,"Password",5)){y.removeClassName("with_error");h(y)}else y.addClassName("with_error")});$(n("%s_email_address")).observe("blur",function(y){y=y.element();o(y);if(c(y,"Email address")&&
f(y)){y.removeClassName("with_error");h(y)}else y.addClassName("with_error")})};function ShareWithUsersTab(a,b,c){this.initialize(a,b,c)}
ShareWithUsersTab.prototype={initialize:function(a,b,c){this._share_dialog=b;this._tab_id=a;this._current_page=0;this._request_more_func=c;$(a+"_tab").observe("click",this.handleShowTab.bindAsEventListener(this))},getMore:function(){this._current_page++;this._request_more_func();$(this._tab_id+"_indicator").show()},handleShowTab:function(){this.refreshSelected()},handleScroll:function(){if($(this._tab_id).scrollTop+$(this._tab_id).getHeight()>=$(this._tab_id).scrollHeight){Event.stopObserving($(this._tab_id),
"scroll");this.getMore()}},onRequestSuccess:function(){$(this._tab_id).observe("scroll",this.handleScroll.bindAsEventListener(this))},onRequestComplete:function(){$(this._tab_id+"_indicator").hide();this.refreshSelected()},refreshSelected:function(){for(var a=$(this._tab_id).select(".user"),b=0;b<a.length;++b){var c=a[b].select("#recipient_ids_").first();c.checked=this._share_dialog.isSelected(c.value);this._share_dialog.isSelected(c.value)?a[b].addClassName("selected"):a[b].removeClassName("selected")}}};
function ShareWithFriendsDialog(a){this.initialize(a)}
ShareWithFriendsDialog.prototype={initialize:function(a){this._selected_users=[];this._user_limit=a;this._error_msg_timer=this._search_box_timer=null;$("max_users_error").hide();$("new_game_invite_feed_item").setAttribute("action","javascript:;")},setRequestFunctions:function(a,b,c){this._friends_tab=new ShareWithUsersTab("share_with_friends",this,a);this._friends_tab.getMore();this._fans_tab=new ShareWithUsersTab("share_with_fans",this,b);this._fans_tab.getMore();this._chat_members_tab=new ShareWithUsersTab("share_with_chat_members",
this,c);this._chat_members_tab.getMore()},toggleSelected:function(a,b){var c=this.findSelected(a),e=false;if(c>-1){this._selected_users.splice(c,1);e=true;$("error_messages").update("")}else if(this._selected_users.length<this._user_limit){c={};c.user_id=a;c.username=b;this._selected_users.push(c);e=true;$("error_messages").update("")}else if(this._selected_users.length>=this._user_limit){$("max_users_error").show();$("max_users_error").removeClassName("hidden");this._error_msg_timer!=null&&clearTimeout(this._search_box_timer);
this._error_msg_timer=setTimeout(function(){this._error_msg_timer=null;$("max_users_error").hide()},2500)}this._friends_tab.refreshSelected();this._fans_tab.refreshSelected();this._chat_members_tab.refreshSelected();$("selected_users").update(this.selectedUsersMessage());$("recipients").value=this.getSelectedUserIds();return e},selectedUsersMessage:function(){var a=this._selected_users.length;return a==0?"no users selected":a==1?this._selected_users[0].username+" selected":a==2?this._selected_users[0].username+
" and "+this._selected_users[1].username+" selected":a==3?this._selected_users[0].username+", "+this._selected_users[1].username+" and "+this._selected_users[2].username+" selected":a==4?this._selected_users[0].username+", "+this._selected_users[1].username+", "+this._selected_users[2].username+" and 1 other user selected":this._selected_users[0].username+", "+this._selected_users[1].username+", "+this._selected_users[2].username+" and "+(a-3)+" other users selected"},refreshSearchDropdown:function(){for(var a=
$$(".recipient_chooser").first().select(".user"),b=0;b<a.length;++b)this.isSelected(eval("("+a[b].down(".metadata").innerHTML+")").user_id)?a[b].addClassName("chosen"):a[b].removeClassName("chosen")},searchUserSelected:function(a){var b=shareWithFriendsDialog.toggleSelected(a.user_id,a.username);$("recipient_search").value="";if(b){$("recipient_search_container").hide();if(this.isSelected(a.user_id))$("recipient_list_updated_msg").innerHTML=a.username+" was added to the recipient list";else $("recipient_list_updated_msg").innerHTML=
a.username+" was removed from the recipient list";$("recipient_list_updated_msg").show();this._search_box_timer!=null&&clearTimeout(this._search_box_timer);this._search_box_timer=setTimeout(function(){this._search_box_timer=null;$("recipient_list_updated_msg").hide();$("recipient_search_container").show()},2500)}},findSelected:function(a){for(var b=0;b<this._selected_users.length;b++)if(this._selected_users[b].user_id==a)return b;return-1},isSelected:function(a){return this.findSelected(a)>-1},getSelectedUserIds:function(){for(var a=
"",b=0;b<this._selected_users.length;++b){a+=this._selected_users[b].user_id;if(b+1<this._selected_users.length)a+=","}return a}};SharedLinksController=function(a){this.container=$(a.id);this.select=this.container.down("select");this.checkbox=this.container.down("input[type=checkbox]");this.reload=this.container.down(".shared_link_reload");this.url=a.url;this.out_of_links=this.fetching=false;this.shown_items=0;this.addFormHandlers();this.addShowMoreHandler();this.addScrollHandler()};
SharedLinksController.prototype={fetch:function(a){if(!this.fetching){this.fetching=true;var b=this,c=this.container.down("ul");$("shared_link_list_container");var e=this.select.getValue();a||(a={});if(e!="All")a.shared_link_type_id=e;new Ajax.Request(b.url,{method:"get",parameters:a,onCreate:function(){c.insert((new Element("li",{id:"shared_links_loading"})).insert((new Element("span",{"class":"spinner spinner_big"})).update("Loading...")));b.hideShowMoreLink()},onComplete:function(){$("shared_links_loading").remove();
b.fetching=false},onSuccess:function(f){f=$A(f.responseJSON);var h;f.each(function(l){h=b.renderLink(l);c.insert(h);if(b.showHidden()||!h.hasClassName("visited"))b.shown_items++});if(f.length>0)b.maxId=f.last().id;b.showShowMoreLink();if(f.length<25){b.out_of_links=true;b.shown_items=0}else{b.out_of_links=false;if(b.shown_items<17){b.fetching=false;b.fetch({max_id:b.maxId})}else b.shown_items=0}}})}},renderLink:function(a){var b=$.jStorage.get(this.storageKey(a)),c=new Element("li",{id:"shared_link_"+
a.id,"class":"shared_link"}),e=(new Element("a",{"class":"shared_title_link"})).update(a.name),f;if(b){c.addClassName("visited");this.showHidden()||c.hide()}e.observe("click",this.handleClick.bindAsEventListener(this,a,c));c.insert((new Element("div",{"class":"shared_link_title truncate_one_line"})).insert(e));c.observe("click",function(){c.hasClassName("open")?c.removeClassName("open"):c.addClassName("open")});if(a.additional_params){c.addClassName("expandable");f=new Element("dl",{"class":"link_info mvm"});
$H(a.additional_params.evalJSON()).each(function(h){f.insert((new Element("dt",{"class":"truncate_one_line"})).update(h.key.stripTags()));f.insert((new Element("dd",{"class":"truncate_one_line"})).update(h.value.toString().stripTags()))});c.insert(f)}return c},handleClick:function(a,b,c){if($("gameiframe"))activateGame(b.link_params);else{a=$H(document.location.search.toQueryParams()).merge(b.link_params.toQueryParams()).toQueryString();window.open(document.location.pathname+"?"+a,"_blank")}$.jStorage.set(this.storageKey(b),
true,{TTL:b.ttl});c.addClassName("visited");this.showHidden()||c.hide()},addFormHandlers:function(){var a=this.container.down("ul");this.select.observe("change",function(){a.update();this.maxId=0;this.hideShowMoreLink();this.fetch()}.bind(this));this.reload.observe("click",function(){a.update();this.maxId=0;this.hideShowMoreLink();this.fetch()}.bind(this));this.checkbox.observe("change",function(){a.select("li.visited").invoke(this.checkbox.getValue()=="Y"?"show":"hide")}.bind(this))},addShowMoreHandler:function(){$("shared_link_show_more").observe("click",
function(){this.fetch({max_id:this.maxId});this.hideShowMoreLink()}.bind(this))},showShowMoreLink:function(){$("shared_link_show_more").show()},hideShowMoreLink:function(){$("shared_link_show_more").hide()},storageKey:function(a){return active_user.gameId()+"-"+a.id},addScrollHandler:function(){var a=$("shared_link_show_more"),b=0,c=$("shared_link_list_container");c.observe("scroll",function(){var e=c.scrollTop==0?c.parentNode.scrollTop:c.scrollTop;!this.out_of_links&&e+window.innerHeight>a.positionedOffset().top&&
e>b&&this.fetch({max_id:this.maxId});b=e}.bind(this))},showHidden:function(){return this.checkbox.getValue()=="Y"}};var Shim={shimElement:function(a){var b=$("shim")||this.createShim();b.show();b.absolutize();b.clonePosition(a);this.hideIframe()},hide:function(){var a=$("shim");a&&a.hide();this.showIframe()},createShim:function(){var a=new Element("iframe",{id:"shim",style:"display:none; z-index:1000000 ; border: 0;"});a.setOpacity(0);document.body.insert({top:a});return a},hideIframe:function(){var a=$("gameiframe");a&&!a.hasClassName("dont_hide")&&a.up("#game").setStyle({top:"-10000px",left:"-10000px"})},showIframe:function(){var a=
$("gameiframe");a&&!a.hasClassName("dont_hide")&&a.up("#game").setStyle({top:"",left:""})}};var SiteStatsUpdater=function(){var a=new Template("<strong>#{users_online_count_with_delimiter}</strong> online playing <strong>#{games_count_with_delimiter}</strong> free games!"),b=new Template('<a onclick="holodeck.showChatTab(); return false;" href="#" class="spritegame">Join #{people_online_text} in chat right now!</a>');return{update:function(){(function(){new Ajax.Request("/site_stats.json",{method:"get",onSuccess:function(c){c=c.responseJSON;$("playing").update(a.evaluate(c));$("holodeck_chat_promotion")&&
$("holodeck_chat_promotion").update(b.evaluate(c));if(ls)try{pageTracker._trackEvent("LoadTime","SiteStatsFinished",document.location.pathname,(new Date).getTime()-ls)}catch(e){}}})}).runWhenDomLoaded(true)}}}();function SkinChooser(a){this.initialize(a)}
SkinChooser.prototype={initialize:function(a){this._current_skin_class=a||"";this._default_style="background:#eee url(/images/presentation/new_homepage_background.png) repeat-x 0 0;";Roller.rolodex.user_skin_chooser=new Roller({scrollablePane:"user_skin_chooser_scrollable",scrollDuration:500,container:"user_skin_chooser_container",showDots:false});try{$("new_user_skin").down(".scroll_left").observe("click",function(){Roller.rolodex.user_skin_chooser.scrollToPreviousPaneAndStop()});$("new_user_skin").down(".scroll_right").observe("click",
function(){Roller.rolodex.user_skin_chooser.scrollToNextPaneAndStop()})}catch(b){}},updateSkin:function(a,b,c){if(!$("skins_pod_spinner").visible()){$("skins_pod_spinner").show();$("user_skin_skin_id").value=a;$("new_user_skin").onsubmit();$("primarywrap").setStyle(b);this.setBodyClass(c);$("new_user_skin").hide()}},setDefault:function(){if(!$("skins_pod_spinner").visible()){$("skins_pod_spinner").show();$("new_user_skin").hide()}this.setBodyClass("");$("primarywrap").setStyle(this._default_style)},
setBodyClass:function(a){var b=$$("body").first();b.removeClassName(this._current_skin_class);this._current_skin_class=a;b.addClassName(this._current_skin_class)},onSkinSet:function(){$("skins_pod_spinner").hide();$("new_user_skin").show()}};Element.addMethods({textNodes:function(a){return $A(a.childNodes).map(function(b){return b.nodeType==3?[b]:b.nodeType==1?$(b).textNodes():[]}).flatten()},splitLongWords:function(a){var b=/\S{30,}/,c=function(){return Prototype.Browser.IE?document.createElement("wbr"):document.createTextNode(String.fromCharCode(8203))};a.textNodes().each(function(e){var f=e.parentNode;e=e;for(var h;(h=e.nodeValue.search(b))>=0;)if(/http:/.test(e.nodeValue.substr(0,h+30)))if(/^\s/.test(e.nodeValue)){h=e.nodeValue.search(/\S/);
e=e.splitText(h)}else if((h=e.nodeValue.search(/\s+/))>=0)e=e.splitText(h);else return;else{e=e.splitText(h+30);f.insertBefore(c(),e)}})}});document.observe("dom:loaded",function(){$$(".splittext").invoke("splitLongWords")});var delayed_response;function facebookSignInSuccess(a){if(active_user.isAuthenticated()&&a.new_facebook_connection)existingUserConnected();else a.existing_user?setActiveUser(a):accountCreationSuccess(a)}
function existingUserConnected(){new FacebookFriendFinder(function(a){try{lightbox.prototype.shutdown()}catch(b){}lightbox.prototype.initializeKongregateLightboxFromAjax("/facebook_connection/confirm",{done_class_name:a.friends.length>0?"wide":"fb_confirm_narrow",afterStaticContentLoad:function(){a.friends.length>0?a.displayFriendForm("/account"+active_user.username()+"/friends/create_many",$("facebook_friends"),function(){try{lightbox.prototype.shutdown()}catch(c){}}):$("facebook_friends_wrapper").hide();
lightbox.prototype.addOnCloseCallback(function(){active_user.isGamePage()?$$(".facebook_nav_item").invoke("hide"):window.location.reload()})}})})}
function accountCreationSuccess(a){if(a.game){active_user.invokeConversionIframe();if(a.from_facebook){try{lightbox.prototype.shutdown()}catch(b){}lightbox.prototype.initializeKongregateLightboxFromAjax(a.full_finalize_form_facebook_connection_url,{done_class_name:"lightbox_login"});delayed_response=a}else setActiveUser(a)}else if(a.from_facebook){delayed_response=a;try{lightbox.prototype.shutdown()}catch(c){}lightbox.prototype.initializeKongregateLightboxFromAjax(a.full_finalize_form_facebook_connection_url,
{done_class_name:"lightbox_login"})}else{Cookie.set("_kong_acct_created","true",1,"/");window.location.href=a.destination_uri}}
function accountCreationFailure(a){typeof tracking_code_service!="undefined"&&tracking_code_service.reportTrackingCode();if(a.banned)if(a.from_lightbox)$("lightbox_email_register").replace(a.content);else window.location.href=a.banned_url;else if(a.from_lightbox){$("lightbox_form").update(a.content);lightbox.prototype.toggleRegistration()}else if(a.signup_tab)parent.$("signup_tab_form").update(a.content);else{var b=parent.$("signup_pod_form");if(b)b.update(a.content);else(b=parent.$("accounts_new_form")||
parent.$("new_user"))&&b.replace(a.content);active_user.solvedCaptcha()&&$("user_captcha_validation")&&$("user_captcha_validation").hide()}}
function sessionStatus(a){if(window.frames.secure_login_frame)window.frames.secure_login_frame.location.href="about:blank";if(Cookie.accept())if(a.authenticated)if(a.game)setActiveUser(a);else{try{$("welcome_box_sign_in_button").disable()}catch(b){}window.location.href=a.destination_uri}else if(a.ban_id)window.location.href=a.banned_url;else if(window.location.pathname=="/sessions/new")window.location.href="http://"+window.location.hostname+"/sessions/new";else if(window.location.pathname=="/session/new")window.location.href=
"http://"+window.location.hostname+"/session/new";else{a.from_lightbox&&$("lightboxlogin").replace(a.content);try{$("welcome_box_sign_in_button").restore()}catch(c){}try{$("sessions_new_form_spinner").restore()}catch(e){}a.native_app||active_user.activateInlineLogin()}else window.location.href="http://"+window.location.hostname+"/sessions/new"}function finalizeCompletion(a){setActiveUser(a&&a.response?a.response:delayed_response)}
function finalizeFailure(a){if($("lightbox").visible()||holodeck.isShowingSignupTab()){$$(".error_block").invoke("remove");$$(".with_error").invoke("removeClassName","with_error");$H(a.errors).each(function(b){var c=b[0];b=b[1];$("user_"+c+"_label").insert({before:"<span class='error_block error'>"+b+"</span>"});$("user_"+c).addClassName("with_error")});$("facebook_signup_submit_button").restore();$("facebook_signup_skip_button").show()}else setActiveUser(delayed_response)}
function showFriendFinderForm(a,b){var c="/accounts/"+b.username+"/friends/create_many",e=function(){b.new_facebook_connection=false;setActiveUser(b)};try{lightbox.prototype.shutdownWithoutCallbacks()}catch(f){}lightbox.prototype.initializeKongregateLightboxFromContent('<div id="facebook_friends"></div>',{done_class_name:"lightbox_login",afterStaticContentLoad:function(){a.displayFriendForm(c,$("facebook_friends"),function(){try{lightbox.prototype.shutdown()}catch(h){}});lightbox.prototype.addOnCloseCallback(e)}})}
function setupWelcomeMessageCookie(){var a=Cookie.get("temp_flash_message");if(a){Cookie.set(FlashMessages.COOKIE_NAME,Object.toJSON({messages:[a]}));Cookie.erase("temp_flash_message","/")}}
function setActiveUser(a){if(a&&a.new_facebook_connection)new FacebookFriendFinder(function(c){if(c.friends.length>0)showFriendFinderForm(c,a);else{a.new_facebook_connection=false;setActiveUser(a)}});else{try{top.lightbox.prototype.shutdown();typeof tracking_code_service!="undefined"&&tracking_code_service.reportTrackingCode()}catch(b){}if(active_user.isGamePage()){active_user.updateAttributes(a.user_data_sigil);if(window.holodeck){holodeck.switchUser(a.chat_username,a.chat_password,a.user_chat_hash,
a.game_auth_token,a.user_id,true);holodeck.closeSignupTab();holodeck.rebootstrapChat();GameMetricsUpdater.update();a.default_nag&&holodeck.updateDefaultChatNag(a.default_nag);$("share_tab_pane_content").update(a.shared_tab_pane_content);active_user.runCapturedFunction();holodeck.redoPromptSavedSharedContent();holodeck.redoShowSharedContentsIndex();holodeck.loadAdminControls(active_user);a.has_pending_collaborators&&holodeck.loadCollaborators();holodeck.loadDiscussions();holodeck.prepareAvatarTab()}else{active_user.runCapturedFunction();
GameMetricsUpdater.update()}}else{setupWelcomeMessageCookie(a);if(a.destination_uri)window.location.href=a.destination_uri;else window.location.reload()}}};function addDOMLoadEvent(a){if(!window.__load_events){var b=function(){if(!arguments.callee.done){arguments.callee.done=true;if(window.__load_timer){clearInterval(window.__load_timer);window.__load_timer=null}for(var c=0;c<window.__load_events.length;c++)window.__load_events[c]();window.__load_events=null}};document.addEventListener&&document.addEventListener("DOMContentLoaded",b,false);if(/WebKit/i.test(navigator.userAgent))window.__load_timer=setInterval(function(){/loaded|complete/.test(document.readyState)&&
b()},10);window.onload=b;window.__load_events=[]}window.__load_events.push(a)}
function tabset(){if(!document.getElementById)return false;var a=document.getElementsByTagName("dl");for(k=0;k<a.length;k++){var b=a[k];if(b.className.indexOf("tabset")!=-1){var c=0,e=b.getElementsByTagName("dd");for(i=0;i<e.length;i++)if(e[i].parentNode==b){if(i==0)var f=e.item(0);else e[i].style.display="none";e[i].count=c++}c=[];e=b.getElementsByTagName("dt");for(i=0;i<e.length;i++)if(e[i].parentNode==b)c[c.length]=e[i];b=[];for(i=0;i<c.length;i++){if(!c[i].transformed_to_tab){c[i].transformed_to_tab=
true;c[i].count=i;c[i].onclick=toggleDt;c[i].innerHTML="<a href='#' title='"+c[i].innerHTML+"'>"+c[i].innerHTML+"</a>";c[i].parentNode.removeChild(c[i]);f.parentNode.insertBefore(c[i],f)}if(c[i].className.indexOf("active")>=0)b[b.length]=c[i]}for(i=0;i<b.length;i++)b[i].onclick()}}}
function toggleDt(){var a=this.parentNode.getElementsByTagName("dt");for(i=0;i<a.length;i++)if(this==a[i]&&this.className.indexOf("dormant")>=0&&this.className.indexOf("active")==-1&&a[i].parentNode==this.parentNode){this.className+=" active";this.className=this.className.replace(/(?:^\s*|\s*$)/,"")}else if(this!=a[i]&&a[i].parentNode==this.parentNode)a[i].className=a[i].className.replace("active","dormant");a=this.parentNode.getElementsByTagName("dd");for(i=0;i<a.length;i++)if(a[i].parentNode==this.parentNode)a[i].style.display=
this.count==a[i].count?"block":"none";return false}addDOMLoadEvent(tabset);TimeInWordsHelper={distanceInWords:function(a,b,c){a=a.getTime();b=b.getTime();b=Math.round(Math.abs(a-b)/1E3);a=Math.round(b/60);if(a<=1){if(!c)return 0==a?"less than a minute":"1 minute";if(b<5)return"less than 5 seconds";if(b<10)return"less than 10 seconds";if(b<20)return"less than 20 seconds";if(b<40)return"half a minute";if(b<60)return"less than a minute";return"1 minute"}if(a<45)return a+" minutes";if(a<90)return"1 hour";if(a<1440)return Math.round(a/60)+" hours";if(a<2880)return"1 day";if(a<
43200)return Math.round(a/1440)+" days";if(a<86400)return"about 1 month";if(a<525600)return Math.round(a/43200)+" months";if(a<1051200)return"about 1 year";return"over "+Math.round(a/525600)+" years"},distanceInWordsFromNow:function(a,b){return TimeInWordsHelper.distanceInWords(new Date,a,b)}};TippingPointMeter=function(a){this.initialize(a)};
TippingPointMeter.prototype={initialize:function(a){this._target_node=$(a.target_node_id);this._current_value=a.current_value||0;this._max_value=a.max_value||100;this._value_label=a.value_label;this._meter_node=this._target_node.down(".meter");this._meter_node.addClassName("tipping-point-meter");this._bar_ele=new Element("div",{"class":"tipping-point-meter-bar"});this._meter_node.insert(this._bar_ele);this._label_ele=this._target_node.down(".number_gifts");this._label_ele.update(this._value_label);
this._bar_ele.setStyle({width:this._current_value/this._max_value*100+"%"})}};function TrackingCodeService(a){var b=a.dataProvider,c=a.pageTracker,e={},f=function(){l(b().tracking_code,function(n){c._trackPageview(n);(n=o(n))&&c._trackEvent(n[0],n[1])});b().tracking_code=undefined},h=function(){l(b().minor_tracking_code,function(n){(n=o(n))&&c._trackEvent(n[0],n[1])});b().minor_tracking_code=undefined},l=function(n,p){if(n&&c){var y=(new Date).getTime(),m=e[n];if(!m||y-m>15E3){e[n]=y;p(n)}}},o=function(n){if(!n)return null;if((n=n.match(/^\/([^\/]*)\/(.*)$/))&&3==n.length)return[TrackingCodeService.TRACKING_CODE_EVENT_CATEGORIES[n[1]],
n[2]]};a=function(){f();h()};a();return{reportTrackingCode:a}}TrackingCodeService.TRACKING_CODE_EVENT_CATEGORIES={games:"GameSubmission",accounts:"Registration",sessions:"Sessions"};function autoInit_trees(){for(var a=document.getElementsByTagName("ul"),b=0;b<a.length;b++)if(a[b].className&&a[b].className.indexOf("tree")!=-1){initTree(a[b]);a[b].className=a[b].className.replace(/ ?unformatted ?/," ")}}
function initTree(a){var b,c,e,f,h,l,o;for(b=0;b<a.childNodes.length;b++)if(a.childNodes[b].tagName&&a.childNodes[b].tagName.toLowerCase()=="li"){var n=a.childNodes[b];e=document.createElement("span");c=document.createElement("span");f=document.createElement("span");e.appendChild(c);c.appendChild(f);e.className="a "+n.className.replace("closed","spanClosed");e.onMouseOver=function(){};c.className="b";c.onclick=treeToggle;f.className="c";l=n.childNodes.length;h=0;o=null;for(c=0;c<n.childNodes.length;c++)if(n.childNodes[c].tagName&&
n.childNodes[c].tagName.toLowerCase()=="div")h=c+1;else if(n.childNodes[c].tagName&&n.childNodes[c].tagName.toLowerCase()=="ul"){o=n.childNodes[c];l=c;break}for(c=h;c<l;c++)f.appendChild(n.childNodes[h]);n.childNodes.length>h?n.insertBefore(e,n.childNodes[h]):n.appendChild(e);if(o!=null)if(initTree(o)){addClass(n,"children","closed");addClass(e,"children","spanClosed")}}if(n){addClass(n,"last","closed");addClass(e,"last","spanClosed");return true}else return false}
function treeToggle(a,b){for(a=this;a!=null&&(!a.tagName||a.tagName.toLowerCase()!="li");)a=a.parentNode;var c=findChildWithTag(a,"ul"),e=findChildWithTag(a,"span");if(b!=null)if(b=="open")treeOpen(e,a);else b=="close"&&treeClose(e,a);else if(c!=null)a.className.match(/(^| )closed($| )/)?treeOpen(e,a):treeClose(e,a)}function treeOpen(a,b){removeClass(a,"spanClosed");removeClass(b,"closed")}function treeClose(a,b){addClass(a,"spanClosed");addClass(b,"closed")}
function findChildWithTag(a,b){for(var c=0;c<a.childNodes.length;c++)if(a.childNodes[c].tagName!=null&&a.childNodes[c].tagName.toLowerCase()==b)return a.childNodes[c];return null}function addClass(a,b,c){if(c!=null&&a.className.match(new RegExp("(^| )"+c)))a.className=a.className.replace(new RegExp("( |^)"+c),"$1"+b+" "+c);else if(!a.className.match(new RegExp("(^| )"+b+"($| )"))){a.className+=" "+b;a.className=a.className.replace(/(^ +)|( +$)/g,"")}}
function removeClass(a,b){var c=" "+a.className+" ";c=c.replace(new RegExp(" ("+b+" +)+","g")," ");a.className=c.replace(/(^ +)|( +$)/g,"")}_LOADERS=Array();function callAllLoaders(){var a,b;for(a=0;a<_LOADERS.length;a++){b=_LOADERS[a];b!=callAllLoaders&&b()}}function appendLoader(a){if(window.onload&&window.onload!=callAllLoaders)_LOADERS[_LOADERS.length]=window.onload;window.onload=callAllLoaders;_LOADERS[_LOADERS.length]=a}appendLoader(autoInit_trees);UniversalTabs=function(){var a=0,b=function(e,f){var h=e.readAttribute("href"),l="dynamic-tab-"+a++;f=e.up(".tab_container").down(".tab_group");e.writeAttribute("href","#"+l);f.insert({bottom:(new Element("div",{id:l,"class":"tab"})).update('<span class="spinner spinner_big">Loading...</span>')});new Ajax.Request(h,{method:"get",evalScripts:true,onSuccess:function(o){$(l).update(o.responseText)},onFailure:function(){$(l).update("")}})},c=function(e){var f=e.readAttribute("href");f=$(f.sub("#",""));
f.siblings().each(function(h){h.removeClassName("active")});f.addClassName("active");e.up().siblings().each(function(h){h.down().removeClassName("active")});e.addClassName("active")};return{setup:function(){$$(".tab_container").each(function(e){$(e).addClassName("js")});$$(".tab_index a").each(function(e){if(e.hasClassName("active")&&!e.readAttribute("href").include("#")){b(e);c(e)}e.observe("click",function(f){f.stop();e.readAttribute("href").include("#")||b(e);c(e)})})}}}();
document.observe("dom:loaded",function(){UniversalTabs.setup()});
