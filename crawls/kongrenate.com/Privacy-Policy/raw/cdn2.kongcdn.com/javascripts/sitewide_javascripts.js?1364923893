var Prototype={Version:"1.7_rc3",Browser:function(){var a=navigator.userAgent,b=Object.prototype.toString.call(window.opera)=="[object Opera]";return{IE:!!window.attachEvent&&!b,Opera:b,WebKit:a.indexOf("AppleWebKit/")>-1,Gecko:a.indexOf("Gecko")>-1&&a.indexOf("KHTML")===-1,MobileSafari:/Apple.*Mobile/.test(a)}}(),BrowserFeatures:{XPath:!!document.evaluate,SelectorsAPI:!!document.querySelector,ElementExtensions:function(){var a=window.Element||window.HTMLElement;return!!(a&&a.prototype)}(),SpecificElementExtensions:function(){if(typeof window.HTMLDivElement!==
"undefined")return true;var a=document.createElement("div"),b=document.createElement("form"),c=false;if(a.__proto__&&a.__proto__!==b.__proto__)c=true;return c}()},ScriptFragment:"<script[^>]*>([\\S\\s]*?)<\/script>",JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,emptyFunction:function(){},K:function(a){return a}};if(Prototype.Browser.MobileSafari)Prototype.BrowserFeatures.SpecificElementExtensions=false;
var Abstract={},Try={these:function(){for(var a,b=0,c=arguments.length;b<c;b++){var e=arguments[b];try{a=e();break}catch(g){}}return a}},Class=function(){function a(){}function b(){function g(){this.initialize.apply(this,arguments)}var l=null,r=$A(arguments);if(Object.isFunction(r[0]))l=r.shift();Object.extend(g,Class.Methods);g.superclass=l;g.subclasses=[];if(l){a.prototype=l.prototype;g.prototype=new a;l.subclasses.push(g)}l=0;for(var u=r.length;l<u;l++)g.addMethods(r[l]);if(!g.prototype.initialize)g.prototype.initialize=
Prototype.emptyFunction;return g.prototype.constructor=g}function c(g){var l=this.superclass&&this.superclass.prototype,r=Object.keys(g);if(e){g.toString!=Object.prototype.toString&&r.push("toString");g.valueOf!=Object.prototype.valueOf&&r.push("valueOf")}for(var u=0,t=r.length;u<t;u++){var v=r[u],G=g[v];if(l&&Object.isFunction(G)&&G.argumentNames()[0]=="$super"){var q=G;G=function(D){return function(){return l[D].apply(this,arguments)}}(v).wrap(q);G.valueOf=q.valueOf.bind(q);G.toString=q.toString.bind(q)}this.prototype[v]=
G}return this}var e=function(){for(var g in{toString:1})if(g==="toString")return false;return true}();return{create:b,Methods:{addMethods:c}}}();
(function(){function a(ia){switch(ia){case null:return w;case void 0:return B}switch(typeof ia){case "boolean":return H;case "number":return z;case "string":return N}return U}function b(ia,W){for(var V in W)ia[V]=W[V];return ia}function c(ia){try{if(j(ia))return"undefined";if(ia===null)return"null";return ia.inspect?ia.inspect():String(ia)}catch(W){if(W instanceof RangeError)return"...";throw W;}}function e(ia){return g("",{"":ia},[])}function g(ia,W,V){W=W[ia];var ca=typeof W;if(a(W)===U&&typeof W.toJSON===
"function")W=W.toJSON(ia);ia=p.call(W);switch(ia){case O:case E:case aa:W=W.valueOf()}switch(W){case null:return"null";case true:return"true";case false:return"false"}ca=typeof W;switch(ca){case "string":return W.inspect(true);case "number":return isFinite(W)?String(W):"null";case "object":ca=0;for(var ra=V.length;ca<ra;ca++)if(V[ca]===W)throw new TypeError;V.push(W);var ga=[];if(ia===ja){ca=0;for(ra=W.length;ca<ra;ca++){var fa=g(ca,W,V);ga.push(typeof fa==="undefined"?"null":fa)}ga="["+ga.join(",")+
"]"}else{var za=Object.keys(W);ca=0;for(ra=za.length;ca<ra;ca++){ia=za[ca];fa=g(ia,W,V);typeof fa!=="undefined"&&ga.push(ia.inspect(true)+":"+fa)}ga="{"+ga.join(",")+"}"}V.pop();return ga}}function l(ia){return JSON.stringify(ia)}function r(ia){return $H(ia).toQueryString()}function u(ia){return ia&&ia.toHTML?ia.toHTML():String.interpret(ia)}function t(ia){if(a(ia)!==U)throw new TypeError;var W=[];for(var V in ia)ia.hasOwnProperty(V)&&W.push(V);return W}function v(ia){var W=[];for(var V in ia)W.push(ia[V]);
return W}function G(ia){return b({},ia)}function q(ia){return!!(ia&&ia.nodeType==1)}function D(ia){return p.call(ia)===ja}function J(ia){return ia instanceof Hash}function M(ia){return typeof ia==="function"}function A(ia){return p.call(ia)===aa}function Q(ia){return p.call(ia)===O}function j(ia){return typeof ia==="undefined"}var p=Object.prototype.toString,w="Null",B="Undefined",H="Boolean",z="Number",N="String",U="Object",E="[object Boolean]",O="[object Number]",aa="[object String]",ja="[object Array]",
P=window.JSON&&typeof JSON.stringify==="function"&&JSON.stringify(0)==="0"&&typeof JSON.stringify(Prototype.K)==="undefined";if(typeof Array.isArray=="function"&&Array.isArray([])&&!Array.isArray({}))D=Array.isArray;b(Object,{extend:b,inspect:c,toJSON:P?l:e,toQueryString:r,toHTML:u,keys:Object.keys||t,values:v,clone:G,isElement:q,isArray:D,isHash:J,isFunction:M,isString:A,isNumber:Q,isUndefined:j})})();
Object.extend(Function.prototype,function(){function a(q,D){for(var J=q.length,M=D.length;M--;)q[J+M]=D[M];return q}function b(q,D){q=G.call(q,0);return a(q,D)}function c(){var q=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return q.length==1&&!q[0]?[]:q}function e(q){if(arguments.length<2&&Object.isUndefined(arguments[0]))return this;var D=this,J=G.call(arguments,1);return function(){var M=b(J,arguments);
return D.apply(q,M)}}function g(q){var D=this,J=G.call(arguments,1);return function(M){M=a([M||window.event],J);return D.apply(q,M)}}function l(){if(!arguments.length)return this;var q=this,D=G.call(arguments,0);return function(){var J=b(D,arguments);return q.apply(this,J)}}function r(q){var D=this,J=G.call(arguments,1);q*=1E3;return window.setTimeout(function(){return D.apply(D,J)},q)}function u(){return this.delay.apply(this,a([0.01],arguments))}function t(q){var D=this;return function(){var J=
a([D.bind(this)],arguments);return q.apply(this,J)}}function v(){if(this._methodized)return this._methodized;var q=this;return this._methodized=function(){var D=a([this],arguments);return q.apply(null,D)}}var G=Array.prototype.slice;return{argumentNames:c,bind:e,bindAsEventListener:g,curry:l,delay:r,defer:u,wrap:t,methodize:v}}());
(function(a){function b(){return this.getUTCFullYear()+"-"+(this.getUTCMonth()+1).toPaddedString(2)+"-"+this.getUTCDate().toPaddedString(2)+"T"+this.getUTCHours().toPaddedString(2)+":"+this.getUTCMinutes().toPaddedString(2)+":"+this.getUTCSeconds().toPaddedString(2)+"Z"}function c(){return this.toISOString()}if(!a.toISOString)a.toISOString=b;if(!a.toJSON)a.toJSON=c})(Date.prototype);RegExp.prototype.match=RegExp.prototype.test;
RegExp.escape=function(a){return String(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")};
var PeriodicalExecuter=Class.create({initialize:function(a,b){this.callback=a;this.frequency=b;this.currentlyExecuting=false;this.registerCallback()},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1E3)},execute:function(){this.callback(this)},stop:function(){if(this.timer){clearInterval(this.timer);this.timer=null}},onTimerEvent:function(){if(!this.currentlyExecuting)try{this.currentlyExecuting=true;this.execute();this.currentlyExecuting=false}catch(a){this.currentlyExecuting=
false;throw a;}}});Object.extend(String,{interpret:function(a){return a==null?"":String(a)},specialChar:{"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r","\\":"\\\\"}});
Object.extend(String.prototype,function(){function a(V){if(Object.isFunction(V))return V;var ca=new Template(V);return function(ra){return ca.evaluate(ra)}}function b(V,ca){var ra="",ga=this,fa;ca=a(ca);if(Object.isString(V))V=RegExp.escape(V);if(!(V.length||V.source)){ca=ca("");return ca+ga.split("").join(ca)+ca}for(;ga.length>0;)if(fa=ga.match(V)){ra+=ga.slice(0,fa.index);ra+=String.interpret(ca(fa));ga=ga.slice(fa.index+fa[0].length)}else{ra+=ga;ga=""}return ra}function c(V,ca,ra){ca=a(ca);ra=
Object.isUndefined(ra)?1:ra;return this.gsub(V,function(ga){if(--ra<0)return ga[0];return ca(ga)})}function e(V,ca){this.gsub(V,ca);return String(this)}function g(V,ca){V=V||30;ca=Object.isUndefined(ca)?"...":ca;return this.length>V?this.slice(0,V-ca.length)+ca:String(this)}function l(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}function r(){return this.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,"")}function u(){return this.replace(new RegExp(Prototype.ScriptFragment,"img"),"")}
function t(){var V=new RegExp(Prototype.ScriptFragment,"img"),ca=new RegExp(Prototype.ScriptFragment,"im");return(this.match(V)||[]).map(function(ra){return(ra.match(ca)||["",""])[1]})}function v(){return this.extractScripts().map(function(V){return eval(V)})}function G(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function q(){return this.stripTags().replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function D(V){var ca=this.strip().match(/([^?#]*)(#.*)?$/);
if(!ca)return{};return ca[1].split(V||"&").inject({},function(ra,ga){if((ga=ga.split("="))[0]){var fa=decodeURIComponent(ga.shift());ga=ga.length>1?ga.join("="):ga[0];if(ga!=undefined)ga=decodeURIComponent(ga);if(fa in ra){Object.isArray(ra[fa])||(ra[fa]=[ra[fa]]);ra[fa].push(ga)}else ra[fa]=ga}return ra})}function J(){return this.split("")}function M(){return this.slice(0,this.length-1)+String.fromCharCode(this.charCodeAt(this.length-1)+1)}function A(V){return V<1?"":(new Array(V+1)).join(this)}
function Q(){return this.replace(/-+(.)?/g,function(V,ca){return ca?ca.toUpperCase():""})}function j(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()}function p(){return this.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/-/g,"_").toLowerCase()}function w(){return this.replace(/_/g,"-")}function B(V){var ca=this.replace(/[\x00-\x1f\\]/g,function(ra){if(ra in String.specialChar)return String.specialChar[ra];return"\\u00"+
ra.charCodeAt().toPaddedString(2,16)});if(V)return'"'+ca.replace(/"/g,'\\"')+'"';return"'"+ca.replace(/'/g,"\\'")+"'"}function H(V){return this.replace(V||Prototype.JSONFilter,"$1")}function z(){var V=this;if(V.blank())return false;V=V.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@");V=V.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]");V=V.replace(/(?:^|:|,)(?:\s*\[)+/g,"");return/^[\],:{}\s]*$/.test(V)}function N(V){var ca=this.unfilterJSON(),ra=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
if(ra.test(ca))ca=ca.replace(ra,function(fa){return"\\u"+("0000"+fa.charCodeAt(0).toString(16)).slice(-4)});try{if(!V||ca.isJSON())return eval("("+ca+")")}catch(ga){}throw new SyntaxError("Badly formed JSON string: "+this.inspect());}function U(){var V=this.unfilterJSON();return JSON.parse(V)}function E(V){return this.indexOf(V)>-1}function O(V){return this.lastIndexOf(V,0)===0}function aa(V){var ca=this.length-V.length;return ca>=0&&this.indexOf(V,ca)===ca}function ja(){return this==""}function P(){return/^\s*$/.test(this)}
function ia(V,ca){return(new Template(this,ca)).evaluate(V)}var W=window.JSON&&typeof JSON.parse==="function"&&JSON.parse('{"test": true}').test;return{gsub:b,sub:c,scan:e,truncate:g,strip:String.prototype.trim||l,stripTags:r,stripScripts:u,extractScripts:t,evalScripts:v,escapeHTML:G,unescapeHTML:q,toQueryParams:D,parseQuery:D,toArray:J,succ:M,times:A,camelize:Q,capitalize:j,underscore:p,dasherize:w,inspect:B,unfilterJSON:H,isJSON:z,evalJSON:W?U:N,include:E,startsWith:O,endsWith:aa,empty:ja,blank:P,
interpolate:ia}}());
var Template=Class.create({initialize:function(a,b){this.template=a.toString();this.pattern=b||Template.Pattern},evaluate:function(a){if(a&&Object.isFunction(a.toTemplateReplacements))a=a.toTemplateReplacements();return this.template.gsub(this.pattern,function(b){if(a==null)return b[1]+"";var c=b[1]||"";if(c=="\\")return b[2];var e=a,g=b[3],l=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;b=l.exec(g);if(b==null)return c;for(;b!=null;){var r=b[1].startsWith("[")?b[2].replace(/\\\\]/g,"]"):b[1];e=e[r];if(null==
e||""==b[3])break;g=g.substring("["==b[3]?b[1].length:b[0].length);b=l.exec(g)}return c+String.interpret(e)})}});Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;
var $break={},Enumerable=function(){function a(z,N){var U=0;try{this._each(function(O){z.call(N,O,U++)})}catch(E){if(E!=$break)throw E;}return this}function b(z,N,U){var E=-z,O=[],aa=this.toArray();if(z<1)return aa;for(;(E+=z)<aa.length;)O.push(aa.slice(E,E+z));return O.collect(N,U)}function c(z,N){z=z||Prototype.K;var U=true;this.each(function(E,O){U=U&&!!z.call(N,E,O);if(!U)throw $break;});return U}function e(z,N){z=z||Prototype.K;var U=false;this.each(function(E,O){if(U=!!z.call(N,E,O))throw $break;
});return U}function g(z,N){z=z||Prototype.K;var U=[];this.each(function(E,O){U.push(z.call(N,E,O))});return U}function l(z,N){var U;this.each(function(E,O){if(z.call(N,E,O)){U=E;throw $break;}});return U}function r(z,N){var U=[];this.each(function(E,O){z.call(N,E,O)&&U.push(E)});return U}function u(z,N,U){N=N||Prototype.K;var E=[];if(Object.isString(z))z=new RegExp(RegExp.escape(z));this.each(function(O,aa){z.match(O)&&E.push(N.call(U,O,aa))});return E}function t(z){if(Object.isFunction(this.indexOf))if(this.indexOf(z)!=
-1)return true;var N=false;this.each(function(U){if(U==z){N=true;throw $break;}});return N}function v(z,N){N=Object.isUndefined(N)?null:N;return this.eachSlice(z,function(U){for(;U.length<z;)U.push(N);return U})}function G(z,N,U){this.each(function(E,O){z=N.call(U,z,E,O)});return z}function q(z){var N=$A(arguments).slice(1);return this.map(function(U){return U[z].apply(U,N)})}function D(z,N){z=z||Prototype.K;var U;this.each(function(E,O){E=z.call(N,E,O);if(U==null||E>=U)U=E});return U}function J(z,
N){z=z||Prototype.K;var U;this.each(function(E,O){E=z.call(N,E,O);if(U==null||E<U)U=E});return U}function M(z,N){z=z||Prototype.K;var U=[],E=[];this.each(function(O,aa){(z.call(N,O,aa)?U:E).push(O)});return[U,E]}function A(z){var N=[];this.each(function(U){N.push(U[z])});return N}function Q(z,N){var U=[];this.each(function(E,O){z.call(N,E,O)||U.push(E)});return U}function j(z,N){return this.map(function(U,E){return{value:U,criteria:z.call(N,U,E)}}).sort(function(U,E){U=U.criteria;E=E.criteria;return U<
E?-1:U>E?1:0}).pluck("value")}function p(){return this.map()}function w(){var z=Prototype.K,N=$A(arguments);if(Object.isFunction(N.last()))z=N.pop();var U=[this].concat(N).map($A);return this.map(function(E,O){return z(U.pluck(O))})}function B(){return this.toArray().length}function H(){return"#<Enumerable:"+this.toArray().inspect()+">"}return{each:a,eachSlice:b,all:c,every:c,any:e,some:e,collect:g,map:g,detect:l,findAll:r,select:r,filter:r,grep:u,include:t,member:t,inGroupsOf:v,inject:G,invoke:q,
max:D,min:J,partition:M,pluck:A,reject:Q,sortBy:j,toArray:p,entries:p,zip:w,size:B,inspect:H,find:l}}();function $A(a){if(!a)return[];if("toArray"in Object(a))return a.toArray();for(var b=a.length||0,c=new Array(b);b--;)c[b]=a[b];return c}function $w(a){if(!Object.isString(a))return[];return(a=a.strip())?a.split(/\s+/):[]}Array.from=$A;
(function(){function a(w){for(var B=0,H=this.length;B<H;B++)w(this[B])}function b(){this.length=0;return this}function c(){return this[0]}function e(){return this[this.length-1]}function g(){return this.select(function(w){return w!=null})}function l(){return this.inject([],function(w,B){if(Object.isArray(B))return w.concat(B.flatten());w.push(B);return w})}function r(){var w=j.call(arguments,0);return this.select(function(B){return!w.include(B)})}function u(w){return(w===false?this.toArray():this)._reverse()}
function t(w){return this.inject([],function(B,H,z){if(0==z||(w?B.last()!=H:!B.include(H)))B.push(H);return B})}function v(w){return this.uniq().findAll(function(B){return w.detect(function(H){return B===H})})}function G(){return j.call(this,0)}function q(){return this.length}function D(){return"["+this.map(Object.inspect).join(", ")+"]"}function J(w,B){B||(B=0);var H=this.length;if(B<0)B=H+B;for(;B<H;B++)if(this[B]===w)return B;return-1}function M(w,B){B=isNaN(B)?this.length:(B<0?this.length+B:B)+
1;w=this.slice(0,B).reverse().indexOf(w);return w<0?w:B-w-1}function A(){for(var w=j.call(this,0),B,H=0,z=arguments.length;H<z;H++){B=arguments[H];if(Object.isArray(B)&&!("callee"in B))for(var N=0,U=B.length;N<U;N++)w.push(B[N]);else w.push(B)}return w}var Q=Array.prototype,j=Q.slice,p=Q.forEach;p||(p=a);Object.extend(Q,Enumerable);if(!Q._reverse)Q._reverse=Q.reverse;Object.extend(Q,{_each:p,clear:b,first:c,last:e,compact:g,flatten:l,without:r,reverse:u,uniq:t,intersect:v,clone:G,toArray:G,size:q,
inspect:D});if(function(){return[].concat(arguments)[0][0]!==1}(1,2))Q.concat=A;if(!Q.indexOf)Q.indexOf=J;if(!Q.lastIndexOf)Q.lastIndexOf=M})();function $H(a){return new Hash(a)}
var Hash=Class.create(Enumerable,function(){function a(A){this._object=Object.isHash(A)?A.toObject():Object.clone(A)}function b(A){for(var Q in this._object){var j=this._object[Q],p=[Q,j];p.key=Q;p.value=j;A(p)}}function c(A,Q){return this._object[A]=Q}function e(A){if(this._object[A]!==Object.prototype[A])return this._object[A]}function g(A){var Q=this._object[A];delete this._object[A];return Q}function l(){return Object.clone(this._object)}function r(){return this.pluck("key")}function u(){return this.pluck("value")}
function t(A){var Q=this.detect(function(j){return j.value===A});return Q&&Q.key}function v(A){return this.clone().update(A)}function G(A){return(new Hash(A)).inject(this,function(Q,j){Q.set(j.key,j.value);return Q})}function q(A,Q){if(Object.isUndefined(Q))return A;return A+"="+encodeURIComponent(String.interpret(Q))}function D(){return this.inject([],function(A,Q){var j=encodeURIComponent(Q.key);if((Q=Q.value)&&typeof Q=="object"){if(Object.isArray(Q))return A.concat(Q.map(q.curry(j)))}else A.push(q(j,
Q));return A}).join("&")}function J(){return"#<Hash:{"+this.map(function(A){return A.map(Object.inspect).join(": ")}).join(", ")+"}>"}function M(){return new Hash(this)}return{initialize:a,_each:b,set:c,get:e,unset:g,toObject:l,toTemplateReplacements:l,keys:r,values:u,index:t,merge:v,update:G,toQueryString:D,inspect:J,toJSON:l,clone:M}}());Hash.from=$H;
Object.extend(Number.prototype,function(){function a(){return this.toPaddedString(2,16)}function b(){return this+1}function c(t,v){$R(0,this,true).each(t,v);return this}function e(t,v){v=this.toString(v||10);return"0".times(t-v.length)+v}function g(){return Math.abs(this)}function l(){return Math.round(this)}function r(){return Math.ceil(this)}function u(){return Math.floor(this)}return{toColorPart:a,succ:b,times:c,toPaddedString:e,abs:g,round:l,ceil:r,floor:u}}());
function $R(a,b,c){return new ObjectRange(a,b,c)}
var ObjectRange=Class.create(Enumerable,function(){function a(e,g,l){this.start=e;this.end=g;this.exclusive=l}function b(e){for(var g=this.start;this.include(g);){e(g);g=g.succ()}}function c(e){if(e<this.start)return false;if(this.exclusive)return e<this.end;return e<=this.end}return{initialize:a,_each:b,include:c}}()),Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||
false},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(a){this.responders._each(a)},register:function(a){this.include(a)||this.responders.push(a)},unregister:function(a){this.responders=this.responders.without(a)},dispatch:function(a,b,c,e){this.each(function(g){if(Object.isFunction(g[a]))try{g[a].apply(g,[b,c,e])}catch(l){}})}};Object.extend(Ajax.Responders,Enumerable);Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++},onComplete:function(){Ajax.activeRequestCount--}});
Ajax.Base=Class.create({initialize:function(a){this.options={method:"post",asynchronous:true,contentType:"application/x-www-form-urlencoded",encoding:"UTF-8",parameters:"",evalJSON:true,evalJS:true};Object.extend(this.options,a||{});this.options.method=this.options.method.toLowerCase();if(Object.isHash(this.options.parameters))this.options.parameters=this.options.parameters.toObject()}});
Ajax.Request=Class.create(Ajax.Base,{_complete:false,initialize:function($super,b,c){$super(c);this.transport=Ajax.getTransport();this.request(b)},request:function(a){this.url=a;this.method=this.options.method;a=Object.isString(this.options.parameters)?this.options.parameters:Object.toQueryString(this.options.parameters);if(!["get","post"].include(this.method)){a+=(a?"&":"")+"_method="+this.method;this.method="post"}if(a)if(this.method=="get")this.url+=(this.url.include("?")?"&":"?")+a;else if(/Konqueror|Safari|KHTML/.test(navigator.userAgent))a+=
"&_=";this.parameters=a.toQueryParams();try{var b=new Ajax.Response(this);this.options.onCreate&&this.options.onCreate(b);Ajax.Responders.dispatch("onCreate",this,b);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);this.options.asynchronous&&this.respondToReadyState.bind(this).defer(1);this.transport.onreadystatechange=this.onStateChange.bind(this);this.setRequestHeaders();this.body=this.method=="post"?this.options.postBody||a:null;this.transport.send(this.body);!this.options.asynchronous&&
this.transport.overrideMimeType&&this.onStateChange()}catch(c){this.dispatchException(c)}},onStateChange:function(){var a=this.transport.readyState;a>1&&!(a==4&&this._complete)&&this.respondToReadyState(this.transport.readyState)},setRequestHeaders:function(){var a={"X-Requested-With":"XMLHttpRequest","X-Prototype-Version":Prototype.Version,Accept:"text/javascript, text/html, application/xml, text/xml, */*"};if(this.method=="post"){a["Content-type"]=this.options.contentType+(this.options.encoding?
"; charset="+this.options.encoding:"");if(this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005)a.Connection="close"}if(typeof this.options.requestHeaders=="object"){var b=this.options.requestHeaders;if(Object.isFunction(b.push))for(var c=0,e=b.length;c<e;c+=2)a[b[c]]=b[c+1];else $H(b).each(function(l){a[l.key]=l.value})}for(var g in a)this.transport.setRequestHeader(g,a[g])},success:function(){var a=this.getStatus();return!a||a>=200&&a<300},getStatus:function(){try{return this.transport.status||
0}catch(a){return 0}},respondToReadyState:function(a){a=Ajax.Request.Events[a];var b=new Ajax.Response(this);if(a=="Complete"){try{this._complete=true;(this.options["on"+b.status]||this.options["on"+(this.success()?"Success":"Failure")]||Prototype.emptyFunction)(b,b.headerJSON)}catch(c){this.dispatchException(c)}var e=b.getHeader("Content-type");if(this.options.evalJS=="force"||this.options.evalJS&&this.isSameOrigin()&&e&&e.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i))this.evalResponse()}try{(this.options["on"+
a]||Prototype.emptyFunction)(b,b.headerJSON);Ajax.Responders.dispatch("on"+a,this,b,b.headerJSON)}catch(g){this.dispatchException(g)}if(a=="Complete")this.transport.onreadystatechange=Prototype.emptyFunction},isSameOrigin:function(){var a=this.url.match(/^\s*https?:\/\/[^\/]*/);return!a||a[0]=="#{protocol}//#{domain}#{port}".interpolate({protocol:location.protocol,domain:document.domain,port:location.port?":"+location.port:""})},getHeader:function(a){try{return this.transport.getResponseHeader(a)||
null}catch(b){return null}},evalResponse:function(){try{return eval((this.transport.responseText||"").unfilterJSON())}catch(a){this.dispatchException(a)}},dispatchException:function(a){(this.options.onException||Prototype.emptyFunction)(this,a);Ajax.Responders.dispatch("onException",this,a)}});Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"];
Ajax.Response=Class.create({initialize:function(a){this.request=a;a=this.transport=a.transport;var b=this.readyState=a.readyState;if(b>2&&!Prototype.Browser.IE||b==4){this.status=this.getStatus();this.statusText=this.getStatusText();this.responseText=String.interpret(a.responseText);this.headerJSON=this._getHeaderJSON()}if(b==4){a=a.responseXML;this.responseXML=Object.isUndefined(a)?null:a;this.responseJSON=this._getResponseJSON()}},status:0,statusText:"",getStatus:Ajax.Request.prototype.getStatus,
getStatusText:function(){try{return this.transport.statusText||""}catch(a){return""}},getHeader:Ajax.Request.prototype.getHeader,getAllHeaders:function(){try{return this.getAllResponseHeaders()}catch(a){return null}},getResponseHeader:function(a){return this.transport.getResponseHeader(a)},getAllResponseHeaders:function(){return this.transport.getAllResponseHeaders()},_getHeaderJSON:function(){var a=this.getHeader("X-JSON");if(!a)return null;a=decodeURIComponent(escape(a));try{return a.evalJSON(this.request.options.sanitizeJSON||
!this.request.isSameOrigin())}catch(b){this.request.dispatchException(b)}},_getResponseJSON:function(){var a=this.request.options;if(!a.evalJSON||a.evalJSON!="force"&&!(this.getHeader("Content-type")||"").include("application/json")||this.responseText.blank())return null;try{return this.responseText.evalJSON(a.sanitizeJSON||!this.request.isSameOrigin())}catch(b){this.request.dispatchException(b)}}});
Ajax.Updater=Class.create(Ajax.Request,{initialize:function($super,b,c,e){this.container={success:b.success||b,failure:b.failure||(b.success?null:b)};e=Object.clone(e);var g=e.onComplete;e.onComplete=function(l,r){this.updateContent(l.responseText);Object.isFunction(g)&&g(l,r)}.bind(this);$super(c,e)},updateContent:function(a){var b=this.container[this.success()?"success":"failure"],c=this.options;c.evalScripts||(a=a.stripScripts());if(b=$(b))if(c.insertion)if(Object.isString(c.insertion)){var e=
{};e[c.insertion]=a;b.insert(e)}else c.insertion(b,a);else b.update(a)}});
Ajax.PeriodicalUpdater=Class.create(Ajax.Base,{initialize:function($super,b,c,e){$super(e);this.onComplete=this.options.onComplete;this.frequency=this.options.frequency||2;this.decay=this.options.decay||1;this.updater={};this.container=b;this.url=c;this.start()},start:function(){this.options.onComplete=this.updateComplete.bind(this);this.onTimerEvent()},stop:function(){this.updater.options.onComplete=undefined;clearTimeout(this.timer);(this.onComplete||Prototype.emptyFunction).apply(this,arguments)},
updateComplete:function(a){if(this.options.decay){this.decay=a.responseText==this.lastText?this.decay*this.options.decay:1;this.lastText=a.responseText}this.timer=this.onTimerEvent.bind(this).delay(this.decay*this.frequency)},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options)}});
function $(a){if(arguments.length>1){for(var b=0,c=[],e=arguments.length;b<e;b++)c.push($(arguments[b]));return c}if(Object.isString(a))a=document.getElementById(a);return Element.extend(a)}if(Prototype.BrowserFeatures.XPath)document._getElementsByXPath=function(a,b){var c=[];a=document.evaluate(a,$(b)||document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);b=0;for(var e=a.snapshotLength;b<e;b++)c.push(Element.extend(a.snapshotItem(b)));return c};if(!Node)var Node={};
Node.ELEMENT_NODE||Object.extend(Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12});
(function(a){var b=function(){try{var e=document.createElement('<input name="x">');return e.tagName.toLowerCase()==="input"&&e.name==="x"}catch(g){return false}}(),c=a.Element;a.Element=function(e,g){g=g||{};e=e.toLowerCase();var l=Element.cache;if(b&&g.name){e="<"+e+' name="'+g.name+'">';delete g.name;return Element.writeAttribute(document.createElement(e),g)}l[e]||(l[e]=Element.extend(document.createElement(e)));e="type"in g?document.createElement(e):l[e].cloneNode(false);return Element.writeAttribute(e,
g)};Object.extend(a.Element,c||{});if(c)a.Element.prototype=c.prototype})(this);Element.idCounter=1;Element.cache={};Element._purgeElement=function(a){var b=a._prototypeUID;if(b){Element.stopObserving(a);a._prototypeUID=void 0;delete Element.Storage[b]}};
Element.Methods={visible:function(a){return $(a).style.display!="none"},toggle:function(a){a=$(a);Element[Element.visible(a)?"hide":"show"](a);return a},hide:function(a){a=$(a);a.style.display="none";return a},show:function(a){a=$(a);a.style.display="";return a},remove:function(a){a=$(a);a.parentNode.removeChild(a);return a},update:function(){function a(g,l){g=$(g);for(var r=Element._purgeElement,u=g.getElementsByTagName("*"),t=u.length;t--;)r(u[t]);if(l&&l.toElement)l=l.toElement();if(Object.isElement(l))return g.update().insert(l);
l=Object.toHTML(l);r=g.tagName.toUpperCase();if(r==="SCRIPT"&&e){g.text=l;return g}if(b||c)if(r in Element._insertionTranslations.tags){for(;g.firstChild;)g.removeChild(g.firstChild);Element._getContentFromAnonymousElement(r,l.stripScripts()).each(function(v){g.appendChild(v)})}else g.innerHTML=l.stripScripts();else g.innerHTML=l.stripScripts();l.evalScripts.bind(l).defer();return g}var b=function(){var g=document.createElement("select"),l=true;g.innerHTML='<option value="test">test</option>';if(g.options&&
g.options[0])l=g.options[0].nodeName.toUpperCase()!=="OPTION";return l}(),c=function(){try{var g=document.createElement("table");if(g&&g.tBodies){g.innerHTML="<tbody><tr><td>test</td></tr></tbody>";return typeof g.tBodies[0]=="undefined"}}catch(l){return true}}(),e=function(){var g=document.createElement("script"),l=false;try{g.appendChild(document.createTextNode(""));l=!g.firstChild||g.firstChild&&g.firstChild.nodeType!==3}catch(r){l=true}return l}();return a}(),replace:function(a,b){a=$(a);if(b&&
b.toElement)b=b.toElement();else if(!Object.isElement(b)){b=Object.toHTML(b);var c=a.ownerDocument.createRange();c.selectNode(a);b.evalScripts.bind(b).defer();b=c.createContextualFragment(b.stripScripts())}a.parentNode.replaceChild(b,a);return a},insert:function(a,b){a=$(a);if(Object.isString(b)||Object.isNumber(b)||Object.isElement(b)||b&&(b.toElement||b.toHTML))b={bottom:b};var c,e,g;for(var l in b){c=b[l];l=l.toLowerCase();e=Element._insertionTranslations[l];if(c&&c.toElement)c=c.toElement();if(Object.isElement(c))e(a,
c);else{c=Object.toHTML(c);g=(l=="before"||l=="after"?a.parentNode:a).tagName.toUpperCase();g=Element._getContentFromAnonymousElement(g,c.stripScripts());if(l=="top"||l=="after")g.reverse();g.each(e.curry(a));c.evalScripts.bind(c).defer()}}return a},wrap:function(a,b,c){a=$(a);if(Object.isElement(b))$(b).writeAttribute(c||{});else b=Object.isString(b)?new Element(b,c):new Element("div",b);a.parentNode&&a.parentNode.replaceChild(b,a);b.appendChild(a);return b},inspect:function(a){a=$(a);var b="<"+
a.tagName.toLowerCase();$H({id:"id",className:"class"}).each(function(c){var e=c.first();c=c.last();if(e=(a[e]||"").toString())b+=" "+c+"="+e.inspect(true)});return b+">"},recursivelyCollect:function(a,b,c){a=$(a);c=c||-1;for(var e=[];a=a[b];){a.nodeType==1&&e.push(Element.extend(a));if(e.length==c)break}return e},ancestors:function(a){return Element.recursivelyCollect(a,"parentNode")},descendants:function(a){return Element.select(a,"*")},firstDescendant:function(a){for(a=$(a).firstChild;a&&a.nodeType!=
1;)a=a.nextSibling;return $(a)},immediateDescendants:function(a){var b=[];for(a=$(a).firstChild;a;){a.nodeType===1&&b.push(Element.extend(a));a=a.nextSibling}return b},previousSiblings:function(a){return Element.recursivelyCollect(a,"previousSibling")},nextSiblings:function(a){return Element.recursivelyCollect(a,"nextSibling")},siblings:function(a){a=$(a);return Element.previousSiblings(a).reverse().concat(Element.nextSiblings(a))},match:function(a,b){a=$(a);if(Object.isString(b))return Prototype.Selector.match(a,
b);return b.match(a)},up:function(a,b,c){a=$(a);if(arguments.length==1)return $(a.parentNode);var e=Element.ancestors(a);return Object.isNumber(b)?e[b]:Prototype.Selector.find(e,b,c)},down:function(a,b,c){a=$(a);if(arguments.length==1)return Element.firstDescendant(a);return Object.isNumber(b)?Element.descendants(a)[b]:Element.select(a,b)[c||0]},previous:function(a,b,c){a=$(a);if(Object.isNumber(b)){c=b;b=false}Object.isNumber(c)||(c=0);return b?Prototype.Selector.find(a.previousSiblings(),b,c):a.recursivelyCollect("previousSibling",
c+1)[c]},next:function(a,b,c){a=$(a);if(Object.isNumber(b)){c=b;b=false}Object.isNumber(c)||(c=0);if(b)return Prototype.Selector.find(a.nextSiblings(),b,c);else{Object.isNumber(c);return a.recursivelyCollect("nextSibling",c+1)[c]}},select:function(a){a=$(a);var b=Array.prototype.slice.call(arguments,1).join(", ");return Prototype.Selector.select(b,a)},adjacent:function(a){a=$(a);var b=Array.prototype.slice.call(arguments,1).join(", ");return Prototype.Selector.select(b,a.parentNode).without(a)},identify:function(a){a=
$(a);var b=Element.readAttribute(a,"id");if(b)return b;do b="anonymous_element_"+Element.idCounter++;while($(b));Element.writeAttribute(a,"id",b);return b},readAttribute:function(a,b){a=$(a);if(Prototype.Browser.IE){var c=Element._attributeTranslations.read;if(c.values[b])return c.values[b](a,b);if(c.names[b])b=c.names[b];if(b.include(":"))return!a.attributes||!a.attributes[b]?null:a.attributes[b].value}return a.getAttribute(b)},writeAttribute:function(a,b,c){a=$(a);var e={},g=Element._attributeTranslations.write;
if(typeof b=="object")e=b;else e[b]=Object.isUndefined(c)?true:c;for(var l in e){b=g.names[l]||l;c=e[l];if(g.values[l])b=g.values[l](a,c);if(c===false||c===null)a.removeAttribute(b);else c===true?a.setAttribute(b,b):a.setAttribute(b,c)}return a},getHeight:function(a){return Element.getDimensions(a).height},getWidth:function(a){return Element.getDimensions(a).width},classNames:function(a){return new Element.ClassNames(a)},hasClassName:function(a,b){if(a=$(a)){a=a.className;return a.length>0&&(a==b||
(new RegExp("(^|\\s)"+b+"(\\s|$)")).test(a))}},addClassName:function(a,b){if(a=$(a)){Element.hasClassName(a,b)||(a.className+=(a.className?" ":"")+b);return a}},removeClassName:function(a,b){if(a=$(a)){a.className=a.className.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)")," ").strip();return a}},toggleClassName:function(a,b){if(a=$(a))return Element[Element.hasClassName(a,b)?"removeClassName":"addClassName"](a,b)},cleanWhitespace:function(a){a=$(a);for(var b=a.firstChild;b;){var c=b.nextSibling;b.nodeType==
3&&!/\S/.test(b.nodeValue)&&a.removeChild(b);b=c}return a},empty:function(a){return $(a).innerHTML.blank()},descendantOf:function(a,b){a=$(a);b=$(b);if(a.compareDocumentPosition)return(a.compareDocumentPosition(b)&8)===8;if(b.contains)return b.contains(a)&&b!==a;for(;a=a.parentNode;)if(a==b)return true;return false},scrollTo:function(a){a=$(a);var b=Element.cumulativeOffset(a);window.scrollTo(b[0],b[1]);return a},getStyle:function(a,b){a=$(a);b=b=="float"?"cssFloat":b.camelize();var c=a.style[b];
if(!c||c=="auto")c=(a=document.defaultView.getComputedStyle(a,null))?a[b]:null;if(b=="opacity")return c?parseFloat(c):1;return c=="auto"?null:c},getOpacity:function(a){return $(a).getStyle("opacity")},setStyle:function(a,b){a=$(a);var c=a.style;if(Object.isString(b)){a.style.cssText+=";"+b;return b.include("opacity")?a.setOpacity(b.match(/opacity:\s*(\d?\.?\d*)/)[1]):a}for(var e in b)if(e=="opacity")a.setOpacity(b[e]);else c[e=="float"||e=="cssFloat"?Object.isUndefined(c.styleFloat)?"cssFloat":"styleFloat":
e]=b[e];return a},setOpacity:function(a,b){a=$(a);a.style.opacity=b==1||b===""?"":b<1.0E-5?0:b;return a},makePositioned:function(a){a=$(a);var b=Element.getStyle(a,"position");if(b=="static"||!b){a._madePositioned=true;a.style.position="relative";if(Prototype.Browser.Opera){a.style.top=0;a.style.left=0}}return a},undoPositioned:function(a){a=$(a);if(a._madePositioned){a._madePositioned=undefined;a.style.position=a.style.top=a.style.left=a.style.bottom=a.style.right=""}return a},makeClipping:function(a){a=
$(a);if(a._overflow)return a;a._overflow=Element.getStyle(a,"overflow")||"auto";if(a._overflow!=="hidden")a.style.overflow="hidden";return a},undoClipping:function(a){a=$(a);if(!a._overflow)return a;a.style.overflow=a._overflow=="auto"?"":a._overflow;a._overflow=null;return a},clonePosition:function(a,b,c){c=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},c||{});b=$(b);var e=Element.viewportOffset(b),g=[0,0],l=null;a=$(a);if(Element.getStyle(a,"position")==
"absolute"){l=Element.getOffsetParent(a);g=Element.viewportOffset(l)}if(l==document.body){g[0]-=document.body.offsetLeft;g[1]-=document.body.offsetTop}if(c.setLeft)a.style.left=e[0]-g[0]+c.offsetLeft+"px";if(c.setTop)a.style.top=e[1]-g[1]+c.offsetTop+"px";if(c.setWidth)a.style.width=b.offsetWidth+"px";if(c.setHeight)a.style.height=b.offsetHeight+"px";return a}};Object.extend(Element.Methods,{getElementsBySelector:Element.Methods.select,childElements:Element.Methods.immediateDescendants});
Element._attributeTranslations={write:{names:{className:"class",htmlFor:"for"},values:{}}};
if(Prototype.Browser.Opera){Element.Methods.getStyle=Element.Methods.getStyle.wrap(function(a,b,c){switch(c){case "left":case "top":case "right":case "bottom":if(a(b,"position")==="static")return null;case "height":case "width":if(!Element.visible(b))return null;var e=parseInt(a(b,c),10);if(e!==b["offset"+c.capitalize()])return e+"px";return(c==="height"?["border-top-width","padding-top","padding-bottom","border-bottom-width"]:["border-left-width","padding-left","padding-right","border-right-width"]).inject(e,
function(g,l){l=a(b,l);return l===null?g:g-parseInt(l,10)})+"px";default:return a(b,c)}});Element.Methods.readAttribute=Element.Methods.readAttribute.wrap(function(a,b,c){if(c==="title")return b.title;return a(b,c)})}else if(Prototype.Browser.IE){Element.Methods.getStyle=function(a,b){a=$(a);b=b=="float"||b=="cssFloat"?"styleFloat":b.camelize();var c=a.style[b];if(!c&&a.currentStyle)c=a.currentStyle[b];if(b=="opacity"){if(c=(a.getStyle("filter")||"").match(/alpha\(opacity=(.*)\)/))if(c[1])return parseFloat(c[1])/
100;return 1}if(c=="auto"){if((b=="width"||b=="height")&&a.getStyle("display")!="none")return a["offset"+b.capitalize()]+"px";return null}return c};Element.Methods.setOpacity=function(a,b){function c(l){return l.replace(/alpha\([^\)]*\)/gi,"")}a=$(a);var e=a.currentStyle;if(e&&!e.hasLayout||!e&&a.style.zoom=="normal")a.style.zoom=1;e=a.getStyle("filter");var g=a.style;if(b==1||b===""){(e=c(e))?(g.filter=e):g.removeAttribute("filter");return a}else if(b<1.0E-5)b=0;g.filter=c(e)+"alpha(opacity="+b*
100+")";return a};Element._attributeTranslations=function(){var a="className",b="for",c=document.createElement("div");c.setAttribute(a,"x");if(c.className!=="x"){c.setAttribute("class","x");if(c.className==="x")a="class"}c=null;c=document.createElement("label");c.setAttribute(b,"x");if(c.htmlFor!=="x"){c.setAttribute("htmlFor","x");if(c.htmlFor==="x")b="htmlFor"}c=null;return{read:{names:{"class":a,className:a,"for":b,htmlFor:b},values:{_getAttr:function(e,g){return e.getAttribute(g)},_getAttr2:function(e,
g){return e.getAttribute(g,2)},_getAttrNode:function(e,g){return(e=e.getAttributeNode(g))?e.value:""},_getEv:function(){var e=document.createElement("div"),g;e.onclick=Prototype.emptyFunction;e=e.getAttribute("onclick");if(String(e).indexOf("{")>-1)g=function(l,r){r=l.getAttribute(r);if(!r)return null;r=r.toString();r=r.split("{")[1];r=r.split("}")[0];return r.strip()};else if(e==="")g=function(l,r){r=l.getAttribute(r);if(!r)return null;return r.strip()};e=null;return g}(),_flag:function(e,g){return $(e).hasAttribute(g)?
g:null},style:function(e){return e.style.cssText.toLowerCase()},title:function(e){return e.title}}}}}();Element._attributeTranslations.write={names:Object.extend({cellpadding:"cellPadding",cellspacing:"cellSpacing"},Element._attributeTranslations.read.names),values:{checked:function(a,b){a.checked=!!b},style:function(a,b){a.style.cssText=b?b:""}}};Element._attributeTranslations.has={};$w("colSpan rowSpan vAlign dateTime accessKey tabIndex encType maxLength readOnly longDesc frameBorder").each(function(a){Element._attributeTranslations.write.names[a.toLowerCase()]=
a;Element._attributeTranslations.has[a.toLowerCase()]=a});(function(a){Object.extend(a,{href:a._getAttr2,src:a._getAttr2,type:a._getAttr,action:a._getAttrNode,disabled:a._flag,checked:a._flag,readonly:a._flag,multiple:a._flag,onload:a._getEv,onunload:a._getEv,onclick:a._getEv,ondblclick:a._getEv,onmousedown:a._getEv,onmouseup:a._getEv,onmouseover:a._getEv,onmousemove:a._getEv,onmouseout:a._getEv,onfocus:a._getEv,onblur:a._getEv,onkeypress:a._getEv,onkeydown:a._getEv,onkeyup:a._getEv,onsubmit:a._getEv,
onreset:a._getEv,onselect:a._getEv,onchange:a._getEv})})(Element._attributeTranslations.read.values);Prototype.BrowserFeatures.ElementExtensions&&function(){function a(b){b=b.getElementsByTagName("*");for(var c=[],e=0,g;g=b[e];e++)g.tagName!=="!"&&c.push(g);return c}Element.Methods.down=function(b,c,e){b=$(b);if(arguments.length==1)return b.firstDescendant();return Object.isNumber(c)?a(b)[c]:Element.select(b,c)[e||0]}}()}else if(Prototype.Browser.Gecko&&/rv:1\.8\.0/.test(navigator.userAgent))Element.Methods.setOpacity=
function(a,b){a=$(a);a.style.opacity=b==1?0.999999:b===""?"":b<1.0E-5?0:b;return a};else if(Prototype.Browser.WebKit)Element.Methods.setOpacity=function(a,b){a=$(a);a.style.opacity=b==1||b===""?"":b<1.0E-5?0:b;if(b==1)if(a.tagName.toUpperCase()=="IMG"&&a.width){a.width++;a.width--}else try{var c=document.createTextNode(" ");a.appendChild(c);a.removeChild(c)}catch(e){}return a};
if("outerHTML"in document.documentElement)Element.Methods.replace=function(a,b){a=$(a);if(b&&b.toElement)b=b.toElement();if(Object.isElement(b)){a.parentNode.replaceChild(b,a);return a}b=Object.toHTML(b);var c=a.parentNode,e=c.tagName.toUpperCase();if(Element._insertionTranslations.tags[e]){var g=a.next();e=Element._getContentFromAnonymousElement(e,b.stripScripts());c.removeChild(a);g?e.each(function(l){c.insertBefore(l,g)}):e.each(function(l){c.appendChild(l)})}else a.outerHTML=b.stripScripts();
b.evalScripts.bind(b).defer();return a};Element._returnOffset=function(a,b){var c=[a,b];c.left=a;c.top=b;return c};Element._getContentFromAnonymousElement=function(a,b){var c=new Element("div");if(a=Element._insertionTranslations.tags[a]){c.innerHTML=a[0]+b+a[1];for(b=a[2];b--;)c=c.firstChild}else c.innerHTML=b;return $A(c.childNodes)};
Element._insertionTranslations={before:function(a,b){a.parentNode.insertBefore(b,a)},top:function(a,b){a.insertBefore(b,a.firstChild)},bottom:function(a,b){a.appendChild(b)},after:function(a,b){a.parentNode.insertBefore(b,a.nextSibling)},tags:{TABLE:["<table>","</table>",1],TBODY:["<table><tbody>","</tbody></table>",2],TR:["<table><tbody><tr>","</tr></tbody></table>",3],TD:["<table><tbody><tr><td>","</td></tr></tbody></table>",4],SELECT:["<select>","</select>",1]}};
(function(){var a=Element._insertionTranslations.tags;Object.extend(a,{THEAD:a.TBODY,TFOOT:a.TBODY,TH:a.TD})})();Element.Methods.Simulated={hasAttribute:function(a,b){b=Element._attributeTranslations.has[b]||b;a=$(a).getAttributeNode(b);return!!(a&&a.specified)}};Element.Methods.ByTag={};Object.extend(Element,Element.Methods);
(function(a){if(!Prototype.BrowserFeatures.ElementExtensions&&a.__proto__){window.HTMLElement={};window.HTMLElement.prototype=a.__proto__;Prototype.BrowserFeatures.ElementExtensions=true}})(document.createElement("div"));
Element.extend=function(){function a(l){if(typeof window.Element!="undefined"){var r=window.Element.prototype;if(r){var u="_"+(Math.random()+"").slice(2);l=document.createElement(l);r[u]="x";l=l[u]!=="x";delete r[u];return l}}return false}function b(l,r){for(var u in r){var t=r[u];if(Object.isFunction(t)&&!(u in l))l[u]=t.methodize()}}var c=a("object");if(Prototype.BrowserFeatures.SpecificElementExtensions){if(c)return function(l){if(l&&typeof l._extendedByPrototype=="undefined"){var r=l.tagName;
if(r&&/^(?:object|applet|embed)$/i.test(r)){b(l,Element.Methods);b(l,Element.Methods.Simulated);b(l,Element.Methods.ByTag[r.toUpperCase()])}}return l};return Prototype.K}var e={},g=Element.Methods.ByTag;c=Object.extend(function(l){if(!l||typeof l._extendedByPrototype!="undefined"||l.nodeType!=1||l==window)return l;var r=Object.clone(e),u=l.tagName.toUpperCase();g[u]&&Object.extend(r,g[u]);b(l,r);l._extendedByPrototype=Prototype.emptyFunction;return l},{refresh:function(){if(!Prototype.BrowserFeatures.ElementExtensions){Object.extend(e,
Element.Methods);Object.extend(e,Element.Methods.Simulated)}}});c.refresh();return c}();Element.hasAttribute=document.documentElement.hasAttribute?function(a,b){return a.hasAttribute(b)}:Element.Methods.Simulated.hasAttribute;
Element.addMethods=function(a){function b(t){t=t.toUpperCase();Element.Methods.ByTag[t]||(Element.Methods.ByTag[t]={});Object.extend(Element.Methods.ByTag[t],a)}function c(t,v,G){G=G||false;for(var q in t){var D=t[q];if(Object.isFunction(D))if(!G||!(q in v))v[q]=D.methodize()}}function e(t){var v,G={OPTGROUP:"OptGroup",TEXTAREA:"TextArea",P:"Paragraph",FIELDSET:"FieldSet",UL:"UList",OL:"OList",DL:"DList",DIR:"Directory",H1:"Heading",H2:"Heading",H3:"Heading",H4:"Heading",H5:"Heading",H6:"Heading",
Q:"Quote",INS:"Mod",DEL:"Mod",A:"Anchor",IMG:"Image",CAPTION:"TableCaption",COL:"TableCol",COLGROUP:"TableCol",THEAD:"TableSection",TFOOT:"TableSection",TBODY:"TableSection",TR:"TableRow",TH:"TableCell",TD:"TableCell",FRAMESET:"FrameSet",IFRAME:"IFrame"};if(G[t])v="HTML"+G[t]+"Element";if(window[v])return window[v];v="HTML"+t+"Element";if(window[v])return window[v];v="HTML"+t.capitalize()+"Element";if(window[v])return window[v];t=document.createElement(t);return t.__proto__||t.constructor.prototype}
var g=Prototype.BrowserFeatures,l=Element.Methods.ByTag;if(!a){Object.extend(Form,Form.Methods);Object.extend(Form.Element,Form.Element.Methods);Object.extend(Element.Methods.ByTag,{FORM:Object.clone(Form.Methods),INPUT:Object.clone(Form.Element.Methods),SELECT:Object.clone(Form.Element.Methods),TEXTAREA:Object.clone(Form.Element.Methods)})}if(arguments.length==2){var r=a;a=arguments[1]}if(r)Object.isArray(r)?r.each(b):b(r);else Object.extend(Element.Methods,a||{});r=window.HTMLElement?HTMLElement.prototype:
Element.prototype;if(g.ElementExtensions){c(Element.Methods,r);c(Element.Methods.Simulated,r,true)}if(g.SpecificElementExtensions)for(var u in Element.Methods.ByTag){g=e(u);Object.isUndefined(g)||c(l[u],g.prototype)}Object.extend(Element,Element.Methods);delete Element.ByTag;Element.extend.refresh&&Element.extend.refresh();Element.cache={}};
document.viewport={getDimensions:function(){return{width:this.getWidth(),height:this.getHeight()}},getScrollOffsets:function(){return Element._returnOffset(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)}};
(function(a){function b(){if(e.WebKit&&!g.evaluate)return document;if(e.Opera&&window.parseFloat(window.opera.version())<9.5)return document.body;return document.documentElement}function c(u){l||(l=b());r[u]="client"+u;a["get"+u]=function(){return l[r[u]]};return a["get"+u]()}var e=Prototype.Browser,g=document,l,r={};a.getWidth=c.curry("Width");a.getHeight=c.curry("Height")})(document.viewport);Element.Storage={UID:1};
Element.addMethods({getStorage:function(a){if(a=$(a)){if(a===window)a=0;else{if(typeof a._prototypeUID==="undefined")a._prototypeUID=Element.Storage.UID++;a=a._prototypeUID}Element.Storage[a]||(Element.Storage[a]=$H());return Element.Storage[a]}},store:function(a,b,c){if(a=$(a)){arguments.length===2?Element.getStorage(a).update(b):Element.getStorage(a).set(b,c);return a}},retrieve:function(a,b,c){if(a=$(a)){a=Element.getStorage(a);var e=a.get(b);if(Object.isUndefined(e)){a.set(b,c);e=c}return e}},
clone:function(a,b){if(a=$(a)){a=a.cloneNode(b);a._prototypeUID=void 0;if(b){b=Element.select(a,"*");for(var c=b.length;c--;)b[c]._prototypeUID=void 0}return Element.extend(a)}},purge:function(a){if(a=$(a)){var b=Element._purgeElement;b(a);a=a.getElementsByTagName("*");for(var c=a.length;c--;)b(a[c]);return null}}});
(function(){function a(j){j=j.match(/^(\d+)%?$/i);if(!j)return null;return Number(j[1])/100}function b(j,p,w){var B=null;if(Object.isElement(j)){B=j;j=B.getStyle(p)}if(j===null)return null;if(/^(?:-)?\d+(\.\d+)?(px)?$/i.test(j))return window.parseFloat(j);var H=j.include("%"),z=w===document.viewport;if(/\d/.test(j)&&B&&B.runtimeStyle&&!(H&&z)){w=B.style.left;p=B.runtimeStyle.left;B.runtimeStyle.left=B.currentStyle.left;B.style.left=j||0;j=B.style.pixelLeft;B.style.left=w;B.runtimeStyle.left=p;return j}if(B&&
H){w=w||B.parentNode;j=a(j);H=null;B.getStyle("position");B=p.include("left")||p.include("right")||p.include("width");p=p.include("top")||p.include("bottom")||p.include("height");if(w===document.viewport)if(B)H=document.viewport.getWidth();else{if(p)H=document.viewport.getHeight()}else if(B)H=$(w).measure("width");else if(p)H=$(w).measure("height");return H===null?0:H*j}return 0}function c(j){for(;j&&j.parentNode;){if(j.getStyle("display")==="none")return false;j=$(j.parentNode)}return true}function e(j){if(j.include("border"))j+=
"-width";return j.camelize()}function g(j,p){return new Element.Layout(j,p)}function l(j,p){return $(j).getLayout().get(p)}function r(j){j=$(j);var p=Element.getStyle(j,"display");if(p&&p!=="none")return{width:j.offsetWidth,height:j.offsetHeight};p=j.style;p={visibility:p.visibility,position:p.position,display:p.display};var w={visibility:"hidden",display:"block"};if(p.position!=="fixed")w.position="absolute";Element.setStyle(j,w);w={width:j.offsetWidth,height:j.offsetHeight};Element.setStyle(j,p);
return w}function u(j){if(A(j))return $(document.body);if(Element.getStyle(j,"display")!=="inline"&&j.offsetParent)return $(j.offsetParent);if(j===document.body)return $(j);for(;(j=j.parentNode)&&j!==document.body;)if(Element.getStyle(j,"position")!=="static")return j.nodeName==="HTML"?$(document.body):$(j);return $(document.body)}function t(j){var p=0,w=0;if(j.parentNode){do{p+=j.offsetTop||0;w+=j.offsetLeft||0;j=j.offsetParent}while(j)}return new Element.Offset(w,p)}function v(j){var p=j.getLayout(),
w=0,B=0;do{w+=j.offsetTop||0;B+=j.offsetLeft||0;if(j=j.offsetParent){if(M(j))break;if(Element.getStyle(j,"position")!=="static")break}}while(j);B-=p.get("margin-top");w-=p.get("margin-left");return new Element.Offset(B,w)}function G(j){var p=0,w=0;do{p+=j.scrollTop||0;w+=j.scrollLeft||0;j=j.parentNode}while(j);return new Element.Offset(w,p)}function q(j){var p=0,w=0,B=document.body,H=j;do{p+=H.offsetTop||0;w+=H.offsetLeft||0;if(H.offsetParent==B&&Element.getStyle(H,"position")=="absolute")break}while(H=
H.offsetParent);H=j;do if(H!=B){p-=H.scrollTop||0;w-=H.scrollLeft||0}while(H=H.parentNode);return new Element.Offset(w,p)}function D(j){j=$(j);if(Element.getStyle(j,"position")==="absolute")return j;var p=u(j),w=j.viewportOffset();p=p.viewportOffset();w=w.relativeTo(p);p=j.getLayout();j.store("prototype_absolutize_original_styles",{left:j.getStyle("left"),top:j.getStyle("top"),width:j.getStyle("width"),height:j.getStyle("height")});j.setStyle({position:"absolute",top:w.top+"px",left:w.left+"px",width:p.get("width")+
"px",height:p.get("height")+"px"});return j}function J(j){j=$(j);if(Element.getStyle(j,"position")==="relative")return j;var p=j.retrieve("prototype_absolutize_original_styles");p&&j.setStyle(p);return j}function M(j){return j.nodeName.toUpperCase()==="BODY"}function A(j){return j!==document.body&&!Element.descendantOf(j,document.body)}var Q=Prototype.K;if("currentStyle"in document.documentElement)Q=function(j){if(!j.currentStyle.hasLayout)j.style.zoom=1;return j};Element.Layout=Class.create(Hash,
{initialize:function($super,p,w){$super();this.element=$(p);Element.Layout.PROPERTIES.each(function(B){this._set(B,null)},this);if(w){this._preComputing=true;this._begin();Element.Layout.PROPERTIES.each(this._compute,this);this._end();this._preComputing=false}},_set:function(j,p){return Hash.prototype.set.call(this,j,p)},set:function(){throw"Properties of Element.Layout are read-only.";},get:function($super,p){var w=$super(p);return w===null?this._compute(p):w},_begin:function(){if(!this._prepared){var j=
this.element;if(!c(j)){j.store("prototype_original_styles",{position:j.style.position||"",width:j.style.width||"",visibility:j.style.visibility||"",display:j.style.display||""});var p=j.getStyle("position"),w=j.getStyle("width"),B=p==="fixed"?document.viewport:j.parentNode;j.setStyle({position:"absolute",visibility:"hidden",display:"block"});var H=j.getStyle("width");p=w&&H===w?b(j,"width",B):p==="absolute"||p==="fixed"?b(j,"width",B):$(j.parentNode).getLayout().get("width")-this.get("margin-left")-
this.get("border-left")-this.get("padding-left")-this.get("padding-right")-this.get("border-right")-this.get("margin-right");j.setStyle({width:p+"px"})}this._prepared=true}},_end:function(){var j=this.element,p=j.retrieve("prototype_original_styles");j.store("prototype_original_styles",null);j.setStyle(p);this._prepared=false},_compute:function(j){var p=Element.Layout.COMPUTATIONS;if(!(j in p))throw"Property not found.";return this._set(j,p[j].call(this,this.element))},toObject:function(){var j=$A(arguments),
p={};(j.length===0?Element.Layout.PROPERTIES:j.join(" ").split(" ")).each(function(w){if(Element.Layout.PROPERTIES.include(w)){var B=this.get(w);if(B!=null)p[w]=B}},this);return p},toHash:function(){var j=this.toObject.apply(this,arguments);return new Hash(j)},toCSS:function(){var j=$A(arguments),p={};(j.length===0?Element.Layout.PROPERTIES:j.join(" ").split(" ")).each(function(w){if(Element.Layout.PROPERTIES.include(w))if(!Element.Layout.COMPOSITE_PROPERTIES.include(w)){var B=this.get(w);if(B!=null)p[e(w)]=
B+"px"}},this);return p},inspect:function(){return"#<Element.Layout>"}});Object.extend(Element.Layout,{PROPERTIES:$w("height width top left right bottom border-left border-right border-top border-bottom padding-left padding-right padding-top padding-bottom margin-top margin-bottom margin-left margin-right padding-box-width padding-box-height border-box-width border-box-height margin-box-width margin-box-height"),COMPOSITE_PROPERTIES:$w("padding-box-width padding-box-height margin-box-width margin-box-height border-box-width border-box-height"),
COMPUTATIONS:{height:function(){this._preComputing||this._begin();var j=this.get("border-box-height");if(j<=0){this._preComputing||this._end();return 0}var p=this.get("border-top"),w=this.get("border-bottom"),B=this.get("padding-top"),H=this.get("padding-bottom");this._preComputing||this._end();return j-p-w-B-H},width:function(){this._preComputing||this._begin();var j=this.get("border-box-width");if(j<=0){this._preComputing||this._end();return 0}var p=this.get("border-left"),w=this.get("border-right"),
B=this.get("padding-left"),H=this.get("padding-right");this._preComputing||this._end();return j-p-w-B-H},"padding-box-height":function(){var j=this.get("height"),p=this.get("padding-top"),w=this.get("padding-bottom");return j+p+w},"padding-box-width":function(){var j=this.get("width"),p=this.get("padding-left"),w=this.get("padding-right");return j+p+w},"border-box-height":function(j){this._preComputing||this._begin();j=j.offsetHeight;this._preComputing||this._end();return j},"border-box-width":function(j){this._preComputing||
this._begin();j=j.offsetWidth;this._preComputing||this._end();return j},"margin-box-height":function(){var j=this.get("border-box-height"),p=this.get("margin-top"),w=this.get("margin-bottom");if(j<=0)return 0;return j+p+w},"margin-box-width":function(){var j=this.get("border-box-width"),p=this.get("margin-left"),w=this.get("margin-right");if(j<=0)return 0;return j+p+w},top:function(j){return j.positionedOffset().top},bottom:function(j){var p=j.positionedOffset();j=j.getOffsetParent().measure("height");
var w=this.get("border-box-height");return j-w-p.top},left:function(j){return j.positionedOffset().left},right:function(j){var p=j.positionedOffset();j=j.getOffsetParent().measure("width");var w=this.get("border-box-width");return j-w-p.left},"padding-top":function(j){return b(j,"paddingTop")},"padding-bottom":function(j){return b(j,"paddingBottom")},"padding-left":function(j){return b(j,"paddingLeft")},"padding-right":function(j){return b(j,"paddingRight")},"border-top":function(j){return b(j,"borderTopWidth")},
"border-bottom":function(j){return b(j,"borderBottomWidth")},"border-left":function(j){return b(j,"borderLeftWidth")},"border-right":function(j){return b(j,"borderRightWidth")},"margin-top":function(j){return b(j,"marginTop")},"margin-bottom":function(j){return b(j,"marginBottom")},"margin-left":function(j){return b(j,"marginLeft")},"margin-right":function(j){return b(j,"marginRight")}}});"getBoundingClientRect"in document.documentElement&&Object.extend(Element.Layout.COMPUTATIONS,{right:function(j){var p=
Q(j.getOffsetParent());j=j.getBoundingClientRect();return(p.getBoundingClientRect().right-j.right).round()},bottom:function(j){var p=Q(j.getOffsetParent());j=j.getBoundingClientRect();return(p.getBoundingClientRect().bottom-j.bottom).round()}});Element.Offset=Class.create({initialize:function(j,p){this.left=j.round();this.top=p.round();this[0]=this.left;this[1]=this.top},relativeTo:function(j){return new Element.Offset(this.left-j.left,this.top-j.top)},inspect:function(){return"#<Element.Offset left: #{left} top: #{top}>".interpolate(this)},
toString:function(){return"[#{left}, #{top}]".interpolate(this)},toArray:function(){return[this.left,this.top]}});if(Prototype.Browser.IE){u=u.wrap(function(j,p){p=$(p);if(A(p))return $(document.body);var w=p.getStyle("position");if(w!=="static")return j(p);p.setStyle({position:"relative"});j=j(p);p.setStyle({position:w});return j});v=v.wrap(function(j,p){p=$(p);if(!p.parentNode)return new Element.Offset(0,0);var w=p.getStyle("position");if(w!=="static")return j(p);var B=p.getOffsetParent();B&&B.getStyle("position")===
"fixed"&&Q(B);p.setStyle({position:"relative"});j=j(p);p.setStyle({position:w});return j})}else if(Prototype.Browser.Webkit)t=function(j){var p=0,w=0;do{p+=j.offsetTop||0;w+=j.offsetLeft||0;if(j.offsetParent==document.body)if(Element.getStyle(j,"position")=="absolute")break;j=j.offsetParent}while(j);return new Element.Offset(w,p)};Element.addMethods({getLayout:g,measure:l,getDimensions:r,getOffsetParent:u,cumulativeOffset:t,positionedOffset:v,cumulativeScrollOffset:G,viewportOffset:q,absolutize:D,
relativize:J});"getBoundingClientRect"in document.documentElement&&Element.addMethods({viewportOffset:function(j){j=$(j);if(A(j))return new Element.Offset(0,0);j=j.getBoundingClientRect();var p=document.documentElement;return new Element.Offset(j.left-p.clientLeft,j.top-p.clientTop)}})})();window.$$=function(){var a=$A(arguments).join(", ");return Prototype.Selector.select(a,document)};
Prototype.Selector=function(){function a(){throw new Error('Method "Prototype.Selector.select" must be defined.');}function b(){throw new Error('Method "Prototype.Selector.match" must be defined.');}function c(l,r,u){u=u||0;var t=Prototype.Selector.match,v=l.length,G=0,q;for(q=0;q<v;q++)if(t(l[q],r)&&u==G++)return Element.extend(l[q])}function e(l){for(var r=0,u=l.length;r<u;r++)Element.extend(l[r]);return l}var g=Prototype.K;return{select:a,match:b,find:c,extendElements:Element.extend===g?g:e,extendElement:Element.extend}}();
Prototype._original_property=window.Sizzle;
(function(){function a(j,p,w,B,H,z){H=j=="previousSibling"&&!z;for(var N=0,U=B.length;N<U;N++){var E=B[N];if(E){if(H&&E.nodeType===1){E.sizcache=w;E.sizset=N}E=E[j];for(var O=false;E;){if(E.sizcache===w){O=B[E.sizset];break}if(E.nodeType===1&&!z){E.sizcache=w;E.sizset=N}if(E.nodeName===p){O=E;break}E=E[j]}B[N]=O}}}function b(j,p,w,B,H,z){H=j=="previousSibling"&&!z;for(var N=0,U=B.length;N<U;N++){var E=B[N];if(E){if(H&&E.nodeType===1){E.sizcache=w;E.sizset=N}E=E[j];for(var O=false;E;){if(E.sizcache===
w){O=B[E.sizset];break}if(E.nodeType===1){if(!z){E.sizcache=w;E.sizset=N}if(typeof p!=="string"){if(E===p){O=true;break}}else if(u.filter(p,[E]).length>0){O=E;break}}E=E[j]}B[N]=O}}}var c=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,e=0,g=Object.prototype.toString,l=false,r=true;[0,0].sort(function(){r=false;return 0});var u=function(j,p,w,B){w=w||[];var H=p=p||document;if(p.nodeType!==1&&p.nodeType!==9)return[];
if(!j||typeof j!=="string")return w;for(var z=[],N,U,E,O,aa=true,ja=A(p),P=j;(c.exec(""),N=c.exec(P))!==null;){P=N[3];z.push(N[1]);if(N[2]){O=N[3];break}}if(z.length>1&&v.exec(j))if(z.length===2&&t.relative[z[0]])U=Q(z[0]+z[1],p);else for(U=t.relative[z[0]]?[p]:u(z.shift(),p);z.length;){j=z.shift();if(t.relative[j])j+=z.shift();U=Q(j,U)}else{if(!B&&z.length>1&&p.nodeType===9&&!ja&&t.match.ID.test(z[0])&&!t.match.ID.test(z[z.length-1])){N=u.find(z.shift(),p,ja);p=N.expr?u.filter(N.expr,N.set)[0]:N.set[0]}if(p){N=
B?{expr:z.pop(),set:q(B)}:u.find(z.pop(),z.length===1&&(z[0]==="~"||z[0]==="+")&&p.parentNode?p.parentNode:p,ja);U=N.expr?u.filter(N.expr,N.set):N.set;if(z.length>0)E=q(U);else aa=false;for(;z.length;){var ia=z.pop();N=ia;if(t.relative[ia])N=z.pop();else ia="";if(N==null)N=p;t.relative[ia](E,N,ja)}}else E=[]}E||(E=U);if(!E)throw"Syntax error, unrecognized expression: "+(ia||j);if(g.call(E)==="[object Array]")if(aa)if(p&&p.nodeType===1)for(j=0;E[j]!=null;j++){if(E[j]&&(E[j]===true||E[j].nodeType===
1&&M(p,E[j])))w.push(U[j])}else for(j=0;E[j]!=null;j++)E[j]&&E[j].nodeType===1&&w.push(U[j]);else w.push.apply(w,E);else q(E,w);if(O){u(O,H,w,B);u.uniqueSort(w)}return w};u.uniqueSort=function(j){if(J){l=r;j.sort(J);if(l)for(var p=1;p<j.length;p++)j[p]===j[p-1]&&j.splice(p--,1)}return j};u.matches=function(j,p){return u(j,null,null,p)};u.find=function(j,p,w){var B,H;if(!j)return[];for(var z=0,N=t.order.length;z<N;z++){var U=t.order[z];if(H=t.leftMatch[U].exec(j)){var E=H[1];H.splice(1,1);if(E.substr(E.length-
1)!=="\\"){H[1]=(H[1]||"").replace(/\\/g,"");B=t.find[U](H,p,w);if(B!=null){j=j.replace(t.match[U],"");break}}}}B||(B=p.getElementsByTagName("*"));return{set:B,expr:j}};u.filter=function(j,p,w,B){for(var H=j,z=[],N=p,U,E,O=p&&p[0]&&A(p[0]);j&&p.length;){for(var aa in t.filter)if((U=t.match[aa].exec(j))!=null){var ja=t.filter[aa],P,ia;E=false;if(N==z)z=[];if(t.preFilter[aa])if(U=t.preFilter[aa](U,N,w,z,B,O)){if(U===true)continue}else E=P=true;if(U)for(var W=0;(ia=N[W])!=null;W++)if(ia){P=ja(ia,U,W,
N);var V=B^!!P;if(w&&P!=null)if(V)E=true;else N[W]=false;else if(V){z.push(ia);E=true}}if(P!==undefined){w||(N=z);j=j.replace(t.match[aa],"");if(!E)return[];break}}if(j==H)if(E==null)throw"Syntax error, unrecognized expression: "+j;else break;H=j}return N};var t=u.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,
TAG:/^((?:[\w\u00c0-\uFFFF\*-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF-]|\\.)+)(?:\((['"]*)((?:\([^\)]+\)|[^\2\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(j){return j.getAttribute("href")}},relative:{"+":function(j,p,w){var B=typeof p==="string",H=B&&!/\W/.test(p);B=B&&!H;if(H&&!w)p=p.toUpperCase();w=0;H=j.length;
for(var z;w<H;w++)if(z=j[w]){for(;(z=z.previousSibling)&&z.nodeType!==1;);j[w]=B||z&&z.nodeName===p?z||false:z===p}B&&u.filter(p,j,true)},">":function(j,p,w){var B=typeof p==="string";if(B&&!/\W/.test(p)){p=w?p:p.toUpperCase();w=0;for(var H=j.length;w<H;w++){var z=j[w];if(z){B=z.parentNode;j[w]=B.nodeName===p?B:false}}}else{w=0;for(H=j.length;w<H;w++)if(z=j[w])j[w]=B?z.parentNode:z.parentNode===p;B&&u.filter(p,j,true)}},"":function(j,p,w){var B=e++,H=b;if(!/\W/.test(p)){var z=p=w?p:p.toUpperCase();
H=a}H("parentNode",p,B,j,z,w)},"~":function(j,p,w){var B=e++,H=b;if(typeof p==="string"&&!/\W/.test(p)){var z=p=w?p:p.toUpperCase();H=a}H("previousSibling",p,B,j,z,w)}},find:{ID:function(j,p,w){if(typeof p.getElementById!=="undefined"&&!w)return(j=p.getElementById(j[1]))?[j]:[]},NAME:function(j,p){if(typeof p.getElementsByName!=="undefined"){var w=[];p=p.getElementsByName(j[1]);for(var B=0,H=p.length;B<H;B++)p[B].getAttribute("name")===j[1]&&w.push(p[B]);return w.length===0?null:w}},TAG:function(j,
p){return p.getElementsByTagName(j[1])}},preFilter:{CLASS:function(j,p,w,B,H,z){j=" "+j[1].replace(/\\/g,"")+" ";if(z)return j;z=0;for(var N;(N=p[z])!=null;z++)if(N)if(H^(N.className&&(" "+N.className+" ").indexOf(j)>=0))w||B.push(N);else if(w)p[z]=false;return false},ID:function(j){return j[1].replace(/\\/g,"")},TAG:function(j,p){for(var w=0;p[w]===false;w++);return p[w]&&A(p[w])?j[1]:j[1].toUpperCase()},CHILD:function(j){if(j[1]=="nth"){var p=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(j[2]=="even"&&"2n"||
j[2]=="odd"&&"2n+1"||!/\D/.test(j[2])&&"0n+"+j[2]||j[2]);j[2]=p[1]+(p[2]||1)-0;j[3]=p[3]-0}j[0]=e++;return j},ATTR:function(j,p,w,B,H,z){p=j[1].replace(/\\/g,"");if(!z&&t.attrMap[p])j[1]=t.attrMap[p];if(j[2]==="~=")j[4]=" "+j[4]+" ";return j},PSEUDO:function(j,p,w,B,H){if(j[1]==="not")if((c.exec(j[3])||"").length>1||/^\w/.test(j[3]))j[3]=u(j[3],null,null,p);else{j=u.filter(j[3],p,w,true^H);w||B.push.apply(B,j);return false}else if(t.match.POS.test(j[0])||t.match.CHILD.test(j[0]))return true;return j},
POS:function(j){j.unshift(true);return j}},filters:{enabled:function(j){return j.disabled===false&&j.type!=="hidden"},disabled:function(j){return j.disabled===true},checked:function(j){return j.checked===true},selected:function(j){return j.selected===true},parent:function(j){return!!j.firstChild},empty:function(j){return!j.firstChild},has:function(j,p,w){return!!u(w[3],j).length},header:function(j){return/h\d/i.test(j.nodeName)},text:function(j){return"text"===j.type},radio:function(j){return"radio"===
j.type},checkbox:function(j){return"checkbox"===j.type},file:function(j){return"file"===j.type},password:function(j){return"password"===j.type},submit:function(j){return"submit"===j.type},image:function(j){return"image"===j.type},reset:function(j){return"reset"===j.type},button:function(j){return"button"===j.type||j.nodeName.toUpperCase()==="BUTTON"},input:function(j){return/input|select|textarea|button/i.test(j.nodeName)}},setFilters:{first:function(j,p){return p===0},last:function(j,p,w,B){return p===
B.length-1},even:function(j,p){return p%2===0},odd:function(j,p){return p%2===1},lt:function(j,p,w){return p<w[3]-0},gt:function(j,p,w){return p>w[3]-0},nth:function(j,p,w){return w[3]-0==p},eq:function(j,p,w){return w[3]-0==p}},filter:{PSEUDO:function(j,p,w,B){var H=p[1],z=t.filters[H];if(z)return z(j,w,p,B);else if(H==="contains")return(j.textContent||j.innerText||"").indexOf(p[3])>=0;else if(H==="not"){p=p[3];w=0;for(B=p.length;w<B;w++)if(p[w]===j)return false;return true}},CHILD:function(j,p){var w=
p[1],B=j;switch(w){case "only":case "first":for(;B=B.previousSibling;)if(B.nodeType===1)return false;if(w=="first")return true;B=j;case "last":for(;B=B.nextSibling;)if(B.nodeType===1)return false;return true;case "nth":w=p[2];var H=p[3];if(w==1&&H==0)return true;p=p[0];var z=j.parentNode;if(z&&(z.sizcache!==p||!j.nodeIndex)){var N=0;for(B=z.firstChild;B;B=B.nextSibling)if(B.nodeType===1)B.nodeIndex=++N;z.sizcache=p}j=j.nodeIndex-H;return w==0?j==0:j%w==0&&j/w>=0}},ID:function(j,p){return j.nodeType===
1&&j.getAttribute("id")===p},TAG:function(j,p){return p==="*"&&j.nodeType===1||j.nodeName===p},CLASS:function(j,p){return(" "+(j.className||j.getAttribute("class"))+" ").indexOf(p)>-1},ATTR:function(j,p){var w=p[1];j=t.attrHandle[w]?t.attrHandle[w](j):j[w]!=null?j[w]:j.getAttribute(w);w=j+"";var B=p[2];p=p[4];return j==null?B==="!=":B==="="?w===p:B==="*="?w.indexOf(p)>=0:B==="~="?(" "+w+" ").indexOf(p)>=0:!p?w&&j!==false:B==="!="?w!=p:B==="^="?w.indexOf(p)===0:B==="$="?w.substr(w.length-p.length)===
p:B==="|="?w===p||w.substr(0,p.length+1)===p+"-":false},POS:function(j,p,w,B){var H=t.setFilters[p[2]];if(H)return H(j,w,p,B)}}},v=t.match.POS;for(var G in t.match){t.match[G]=new RegExp(t.match[G].source+/(?![^\[]*\])(?![^\(]*\))/.source);t.leftMatch[G]=new RegExp(/(^(?:.|\r|\n)*?)/.source+t.match[G].source)}var q=function(j,p){j=Array.prototype.slice.call(j,0);if(p){p.push.apply(p,j);return p}return j};try{Array.prototype.slice.call(document.documentElement.childNodes,0)}catch(D){q=function(j,p){p=
p||[];if(g.call(j)==="[object Array]")Array.prototype.push.apply(p,j);else if(typeof j.length==="number")for(var w=0,B=j.length;w<B;w++)p.push(j[w]);else for(w=0;j[w];w++)p.push(j[w]);return p}}var J;if(document.documentElement.compareDocumentPosition)J=function(j,p){if(!j.compareDocumentPosition||!p.compareDocumentPosition){if(j==p)l=true;return 0}j=j.compareDocumentPosition(p)&4?-1:j===p?0:1;if(j===0)l=true;return j};else if("sourceIndex"in document.documentElement)J=function(j,p){if(!j.sourceIndex||
!p.sourceIndex){if(j==p)l=true;return 0}j=j.sourceIndex-p.sourceIndex;if(j===0)l=true;return j};else if(document.createRange)J=function(j,p){if(!j.ownerDocument||!p.ownerDocument){if(j==p)l=true;return 0}var w=j.ownerDocument.createRange(),B=p.ownerDocument.createRange();w.setStart(j,0);w.setEnd(j,0);B.setStart(p,0);B.setEnd(p,0);j=w.compareBoundaryPoints(Range.START_TO_END,B);if(j===0)l=true;return j};(function(){var j=document.createElement("div"),p="script"+(new Date).getTime();j.innerHTML="<a name='"+
p+"'/>";var w=document.documentElement;w.insertBefore(j,w.firstChild);if(document.getElementById(p)){t.find.ID=function(B,H,z){if(typeof H.getElementById!=="undefined"&&!z)return(H=H.getElementById(B[1]))?H.id===B[1]||typeof H.getAttributeNode!=="undefined"&&H.getAttributeNode("id").nodeValue===B[1]?[H]:undefined:[]};t.filter.ID=function(B,H){var z=typeof B.getAttributeNode!=="undefined"&&B.getAttributeNode("id");return B.nodeType===1&&z&&z.nodeValue===H}}w.removeChild(j);w=j=null})();(function(){var j=
document.createElement("div");j.appendChild(document.createComment(""));if(j.getElementsByTagName("*").length>0)t.find.TAG=function(p,w){w=w.getElementsByTagName(p[1]);if(p[1]==="*"){p=[];for(var B=0;w[B];B++)w[B].nodeType===1&&p.push(w[B]);w=p}return w};j.innerHTML="<a href='#'></a>";if(j.firstChild&&typeof j.firstChild.getAttribute!=="undefined"&&j.firstChild.getAttribute("href")!=="#")t.attrHandle.href=function(p){return p.getAttribute("href",2)};j=null})();document.querySelectorAll&&function(){var j=
u,p=document.createElement("div");p.innerHTML="<p class='TEST'></p>";if(!(p.querySelectorAll&&p.querySelectorAll(".TEST").length===0)){u=function(B,H,z,N){H=H||document;if(!N&&H.nodeType===9&&!A(H))try{return q(H.querySelectorAll(B),z)}catch(U){}return j(B,H,z,N)};for(var w in j)u[w]=j[w];p=null}}();document.getElementsByClassName&&document.documentElement.getElementsByClassName&&function(){var j=document.createElement("div");j.innerHTML="<div class='test e'></div><div class='test'></div>";if(j.getElementsByClassName("e").length!==
0){j.lastChild.className="e";if(j.getElementsByClassName("e").length!==1){t.order.splice(1,0,"CLASS");t.find.CLASS=function(p,w,B){if(typeof w.getElementsByClassName!=="undefined"&&!B)return w.getElementsByClassName(p[1])};j=null}}}();var M=document.compareDocumentPosition?function(j,p){return j.compareDocumentPosition(p)&16}:function(j,p){return j!==p&&(j.contains?j.contains(p):true)},A=function(j){return j.nodeType===9&&j.documentElement.nodeName!=="HTML"||!!j.ownerDocument&&j.ownerDocument.documentElement.nodeName!==
"HTML"},Q=function(j,p){var w=[],B="",H;for(p=p.nodeType?[p]:p;H=t.match.PSEUDO.exec(j);){B+=H[0];j=j.replace(t.match.PSEUDO,"")}j=t.relative[j]?j+"*":j;H=0;for(var z=p.length;H<z;H++)u(j,p[H],w);return u.filter(B,w)};window.Sizzle=u})();(function(a){function b(g,l){return e(a(g,l||document))}function c(g,l){return a.matches(l,[g]).length==1}var e=Prototype.Selector.extendElements;Prototype.Selector.engine=a;Prototype.Selector.select=b;Prototype.Selector.match=c})(Sizzle);window.Sizzle=Prototype._original_property;
delete Prototype._original_property;
var Form={reset:function(a){a=$(a);a.reset();return a},serializeElements:function(a,b){if(typeof b!="object")b={hash:!!b};else if(Object.isUndefined(b.hash))b.hash=true;var c,e,g=false,l=b.submit,r;if(b.hash){b={};r=function(u,t,v){if(t in u){Object.isArray(u[t])||(u[t]=[u[t]]);u[t].push(v)}else u[t]=v;return u}}else{b="";r=function(u,t,v){return u+(u?"&":"")+encodeURIComponent(t)+"="+encodeURIComponent(v)}}return a.inject(b,function(u,t){if(!t.disabled&&t.name){c=t.name;e=$(t).getValue();if(e!=null&&
t.type!="file"&&(t.type!="submit"||!g&&l!==false&&(!l||c==l)&&(g=true)))u=r(u,c,e)}return u})}};
Form.Methods={serialize:function(a,b){return Form.serializeElements(Form.getElements(a),b)},getElements:function(a){a=$(a).getElementsByTagName("*");for(var b,c=[],e=Form.Element.Serializers,g=0;b=a[g];g++)c.push(b);return c.inject([],function(l,r){e[r.tagName.toLowerCase()]&&l.push(Element.extend(r));return l})},getInputs:function(a,b,c){a=$(a);a=a.getElementsByTagName("input");if(!b&&!c)return $A(a).map(Element.extend);for(var e=0,g=[],l=a.length;e<l;e++){var r=a[e];b&&r.type!=b||c&&r.name!=c||
g.push(Element.extend(r))}return g},disable:function(a){a=$(a);Form.getElements(a).invoke("disable");return a},enable:function(a){a=$(a);Form.getElements(a).invoke("enable");return a},findFirstElement:function(a){a=$(a).getElements().findAll(function(c){return"hidden"!=c.type&&!c.disabled});var b=a.findAll(function(c){return c.hasAttribute("tabIndex")&&c.tabIndex>=0}).sortBy(function(c){return c.tabIndex}).first();return b?b:a.find(function(c){return/^(?:input|select|textarea)$/i.test(c.tagName)})},
focusFirstElement:function(a){a=$(a);a.findFirstElement().activate();return a},request:function(a,b){a=$(a);b=Object.clone(b||{});var c=b.parameters,e=a.readAttribute("action")||"";if(e.blank())e=window.location.href;b.parameters=a.serialize(true);if(c){if(Object.isString(c))c=c.toQueryParams();Object.extend(b.parameters,c)}if(a.hasAttribute("method")&&!b.method)b.method=a.method;return new Ajax.Request(e,b)}};
Form.Element={focus:function(a){$(a).focus();return a},select:function(a){$(a).select();return a}};
Form.Element.Methods={serialize:function(a){a=$(a);if(!a.disabled&&a.name){var b=a.getValue();if(b!=undefined){var c={};c[a.name]=b;return Object.toQueryString(c)}}return""},getValue:function(a){a=$(a);var b=a.tagName.toLowerCase();return Form.Element.Serializers[b](a)},setValue:function(a,b){a=$(a);var c=a.tagName.toLowerCase();Form.Element.Serializers[c](a,b);return a},clear:function(a){$(a).value="";return a},present:function(a){return $(a).value!=""},activate:function(a){a=$(a);try{a.focus();
if(a.select&&(a.tagName.toLowerCase()!="input"||!/^(?:button|reset|submit)$/i.test(a.type)))a.select()}catch(b){}return a},disable:function(a){a=$(a);a.disabled=true;return a},enable:function(a){a=$(a);a.disabled=false;return a}};var Field=Form.Element,$F=Form.Element.Methods.getValue;
Form.Element.Serializers={input:function(a,b){switch(a.type.toLowerCase()){case "checkbox":case "radio":return Form.Element.Serializers.inputSelector(a,b);default:return Form.Element.Serializers.textarea(a,b)}},inputSelector:function(a,b){if(Object.isUndefined(b))return a.checked?a.value:null;else a.checked=!!b},textarea:function(a,b){if(Object.isUndefined(b))return a.value;else a.value=b},select:function(a,b){if(Object.isUndefined(b))return this[a.type=="select-one"?"selectOne":"selectMany"](a);
else for(var c,e,g=!Object.isArray(b),l=0,r=a.length;l<r;l++){c=a.options[l];e=this.optionValue(c);if(g){if(e==b){c.selected=true;return}}else c.selected=b.include(e)}},selectOne:function(a){var b=a.selectedIndex;return b>=0?this.optionValue(a.options[b]):null},selectMany:function(a){var b,c=a.length;if(!c)return null;var e=0;for(b=[];e<c;e++){var g=a.options[e];g.selected&&b.push(this.optionValue(g))}return b},optionValue:function(a){return Element.extend(a).hasAttribute("value")?a.value:a.text}};
Abstract.TimedObserver=Class.create(PeriodicalExecuter,{initialize:function($super,b,c,e){$super(e,c);this.element=$(b);this.lastValue=this.getValue()},execute:function(){var a=this.getValue();if(Object.isString(this.lastValue)&&Object.isString(a)?this.lastValue!=a:String(this.lastValue)!=String(a)){this.callback(this.element,a);this.lastValue=a}}});Form.Element.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.Element.getValue(this.element)}});
Form.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.serialize(this.element)}});
Abstract.EventObserver=Class.create({initialize:function(a,b){this.element=$(a);this.callback=b;this.lastValue=this.getValue();this.element.tagName.toLowerCase()=="form"?this.registerFormCallbacks():this.registerCallback(this.element)},onElementEvent:function(){var a=this.getValue();if(this.lastValue!=a){this.callback(this.element,a);this.lastValue=a}},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback,this)},registerCallback:function(a){if(a.type)switch(a.type.toLowerCase()){case "checkbox":case "radio":Event.observe(a,
"click",this.onElementEvent.bind(this));break;default:Event.observe(a,"change",this.onElementEvent.bind(this));break}}});Form.Element.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.Element.getValue(this.element)}});Form.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.serialize(this.element)}});
(function(){function a(E){return p(E,0)}function b(E){return p(E,1)}function c(E){return p(E,2)}function e(E){E=A.extend(E);var O=E.target,aa=E.type;if((E=E.currentTarget)&&E.tagName)if(aa==="load"||aa==="error"||aa==="click"&&E.tagName.toLowerCase()==="input"&&E.type==="radio")O=E;if(O.nodeType==Node.TEXT_NODE)O=O.parentNode;return Element.extend(O)}function g(E,O){E=A.element(E);if(!O)return E;for(;E;){if(Object.isElement(E)&&Prototype.Selector.match(E,O))return Element.extend(E);E=E.parentNode}}
function l(E){return{x:r(E),y:u(E)}}function r(E){var O=document.documentElement,aa=document.body||{scrollLeft:0};return E.pageX||E.clientX+(O.scrollLeft||aa.scrollLeft)-(O.clientLeft||0)}function u(E){var O=document.documentElement,aa=document.body||{scrollTop:0};return E.pageY||E.clientY+(O.scrollTop||aa.scrollTop)-(O.clientTop||0)}function t(E){A.extend(E);E.preventDefault();E.stopPropagation();E.stopped=true}function v(E,O,aa){var ja=Element.retrieve(E,"prototype_event_registry");if(Object.isUndefined(ja)){z.push(E);
ja=Element.retrieve(E,"prototype_event_registry",$H())}var P=ja.get(O);if(Object.isUndefined(P)){P=[];ja.set(O,P)}if(P.pluck("handler").include(aa))return false;var ia;if(O.include(":"))ia=function(W){if(Object.isUndefined(W.eventName))return false;if(W.eventName!==O)return false;A.extend(W,E);aa.call(E,W)};else if(!j&&(O==="mouseenter"||O==="mouseleave")){if(O==="mouseenter"||O==="mouseleave")ia=function(W){A.extend(W,E);for(var V=W.relatedTarget;V&&V!==E;)try{V=V.parentNode}catch(ca){V=E}V!==E&&
aa.call(E,W)}}else ia=function(W){A.extend(W,E);aa.call(E,W)};ia.handler=aa;P.push(ia);return ia}function G(){for(var E=0,O=z.length;E<O;E++){A.stopObserving(z[E]);z[E]=null}}function q(E,O,aa){E=$(E);aa=v(E,O,aa);if(!aa)return E;if(O.include(":"))if(E.addEventListener)E.addEventListener("dataavailable",aa,false);else{E.attachEvent("ondataavailable",aa);E.attachEvent("onlosecapture",aa)}else{O=N(O);E.addEventListener?E.addEventListener(O,aa,false):E.attachEvent("on"+O,aa)}return E}function D(E,O,
aa){E=$(E);var ja=Element.retrieve(E,"prototype_event_registry");if(!ja)return E;if(!O){ja.each(function(V){D(E,V.key)});return E}var P=ja.get(O);if(!P)return E;if(!aa){P.each(function(V){D(E,O,V.handler)});return E}var ia=P.find(function(V){return V.handler===aa});if(!ia)return E;if(O.include(":"))if(E.removeEventListener)E.removeEventListener("dataavailable",ia,false);else{E.detachEvent("ondataavailable",ia);E.detachEvent("onlosecapture",ia)}else{var W=N(O);E.removeEventListener?E.removeEventListener(W,
ia,false):E.detachEvent("on"+W,ia)}ja.set(O,P.without(ia));return E}function J(E,O,aa,ja){E=$(E);if(Object.isUndefined(ja))ja=true;if(E==document&&document.createEvent&&!E.dispatchEvent)E=document.documentElement;var P;if(document.createEvent){P=document.createEvent("HTMLEvents");P.initEvent("dataavailable",ja,true)}else{P=document.createEventObject();P.eventType=ja?"ondataavailable":"onlosecapture"}P.eventName=O;P.memo=aa||{};document.createEvent?E.dispatchEvent(P):E.fireEvent(P.eventType,P);return A.extend(P)}
function M(E,O,aa,ja){E=$(E);if(Object.isFunction(aa)&&Object.isUndefined(ja)){ja=aa;aa=null}return(new A.Handler(E,O,aa,ja)).start()}var A={KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45,cache:{}},Q=document.documentElement,j="onmouseenter"in Q&&"onmouseleave"in Q;Q=window.attachEvent&&!window.addEventListener;var p;if(Q){var w={0:1,1:4,2:2};p=function(E,O){return E.button===
w[O]}}else p=Prototype.Browser.WebKit?function(E,O){switch(O){case 0:return E.which==1&&!E.metaKey;case 1:return E.which==1&&E.metaKey;default:return false}}:function(E,O){return E.which?E.which===O+1:E.button===O};A.Methods={isLeftClick:a,isMiddleClick:b,isRightClick:c,element:e,findElement:g,pointer:l,pointerX:r,pointerY:u,stop:t};var B=Object.keys(A.Methods).inject({},function(E,O){E[O]=A.Methods[O].methodize();return E});if(Q){var H=function(E){switch(E.type){case "mouseover":E=E.fromElement;
break;case "mouseout":E=E.toElement;break;default:return null}return Element.extend(E)};Object.extend(B,{stopPropagation:function(){this.cancelBubble=true},preventDefault:function(){this.returnValue=false},inspect:function(){return"[object Event]"}});A.extend=function(E,O){if(!E)return false;if(E._extendedByPrototype)return E;E._extendedByPrototype=Prototype.emptyFunction;var aa=A.pointer(E);Object.extend(E,{target:E.srcElement||O,relatedTarget:H(E),pageX:aa.x,pageY:aa.y});return Object.extend(E,
B)}}else{A.prototype=window.Event.prototype||document.createEvent("HTMLEvents").__proto__;Object.extend(A.prototype,B);A.extend=Prototype.K}var z=[];Prototype.Browser.IE&&window.attachEvent("onunload",G);Prototype.Browser.WebKit&&window.addEventListener("unload",Prototype.emptyFunction,false);var N=Prototype.K,U={mouseenter:"mouseover",mouseleave:"mouseout"};j||(N=function(E){return U[E]||E});A.Handler=Class.create({initialize:function(E,O,aa,ja){this.element=$(E);this.eventName=O;this.selector=aa;
this.callback=ja;this.handler=this.handleEvent.bind(this)},start:function(){A.observe(this.element,this.eventName,this.handler);return this},stop:function(){A.stopObserving(this.element,this.eventName,this.handler);return this},handleEvent:function(E){var O=E.findElement(this.selector);O&&this.callback.call(this.element,E,O)}});Object.extend(A,A.Methods);Object.extend(A,{fire:J,observe:q,stopObserving:D,on:M});Element.addMethods({fire:J,observe:q,stopObserving:D,on:M});Object.extend(document,{fire:J.methodize(),
observe:q.methodize(),stopObserving:D.methodize(),on:M.methodize(),loaded:false});if(window.Event)Object.extend(window.Event,A);else window.Event=A})();
(function(){function a(){if(!document.loaded){e&&window.clearTimeout(e);document.loaded=true;document.fire("dom:loaded")}}function b(){if(document.readyState==="complete"){document.stopObserving("readystatechange",b);a()}}function c(){try{document.documentElement.doScroll("left")}catch(g){e=c.defer();return}a()}var e;if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,false);else{document.observe("readystatechange",b);if(window==top)e=c.defer()}Event.observe(window,"load",
a)})();Element.addMethods();Hash.toQueryString=Object.toQueryString;var Toggle={display:Element.toggle};Element.Methods.childOf=Element.Methods.descendantOf;
var Insertion={Before:function(a,b){return Element.insert(a,{before:b})},Top:function(a,b){return Element.insert(a,{top:b})},Bottom:function(a,b){return Element.insert(a,{bottom:b})},After:function(a,b){return Element.insert(a,{after:b})}},$continue=new Error('"throw $continue" is deprecated, use "return" instead'),Position={includeScrollOffsets:false,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;this.deltaY=window.pageYOffset||
document.documentElement.scrollTop||document.body.scrollTop||0},within:function(a,b,c){if(this.includeScrollOffsets)return this.withinIncludingScrolloffsets(a,b,c);this.xcomp=b;this.ycomp=c;this.offset=Element.cumulativeOffset(a);return c>=this.offset[1]&&c<this.offset[1]+a.offsetHeight&&b>=this.offset[0]&&b<this.offset[0]+a.offsetWidth},withinIncludingScrolloffsets:function(a,b,c){var e=Element.cumulativeScrollOffset(a);this.xcomp=b+e[0]-this.deltaX;this.ycomp=c+e[1]-this.deltaY;this.offset=Element.cumulativeOffset(a);
return this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+a.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+a.offsetWidth},overlap:function(a,b){if(!a)return 0;if(a=="vertical")return(this.offset[1]+b.offsetHeight-this.ycomp)/b.offsetHeight;if(a=="horizontal")return(this.offset[0]+b.offsetWidth-this.xcomp)/b.offsetWidth},cumulativeOffset:Element.Methods.cumulativeOffset,positionedOffset:Element.Methods.positionedOffset,absolutize:function(a){Position.prepare();return Element.absolutize(a)},
relativize:function(a){Position.prepare();return Element.relativize(a)},realOffset:Element.Methods.cumulativeScrollOffset,offsetParent:Element.Methods.getOffsetParent,page:Element.Methods.viewportOffset,clone:function(a,b,c){c=c||{};return Element.clonePosition(b,a,c)}};
if(!document.getElementsByClassName)document.getElementsByClassName=function(a){function b(c){return c.blank()?null:"[contains(concat(' ', @class, ' '), ' "+c+" ')]"}a.getElementsByClassName=Prototype.BrowserFeatures.XPath?function(c,e){e=e.toString().strip();return(e=/\s/.test(e)?$w(e).map(b).join(""):b(e))?document._getElementsByXPath(".//*"+e,c):[]}:function(c,e){e=e.toString().strip();var g=[],l=/\s/.test(e)?$w(e):null;if(!l&&!e)return g;c=$(c).getElementsByTagName("*");e=" "+e+" ";for(var r=
0,u,t;u=c[r];r++)if(u.className&&(t=" "+u.className+" ")&&(t.include(e)||l&&l.all(function(v){return!v.toString().blank()&&t.include(" "+v+" ")})))g.push(Element.extend(u));return g};return function(c,e){return $(e||document.body).getElementsByClassName(c)}}(Element.Methods);Element.ClassNames=Class.create();
Element.ClassNames.prototype={initialize:function(a){this.element=$(a)},_each:function(a){this.element.className.split(/\s+/).select(function(b){return b.length>0})._each(a)},set:function(a){this.element.className=a},add:function(a){this.include(a)||this.set($A(this).concat(a).join(" "))},remove:function(a){this.include(a)&&this.set($A(this).without(a).join(" "))},toString:function(){return $A(this).join(" ")}};Object.extend(Element.ClassNames.prototype,Enumerable);
(function(){window.Selector=Class.create({initialize:function(a){this.expression=a.strip()},findElements:function(a){return Prototype.Selector.select(this.expression,a)},match:function(a){return Prototype.Selector.match(a,this.expression)},toString:function(){return this.expression},inspect:function(){return"#<Selector: "+this.expression+">"}});Object.extend(Selector,{matchElements:function(a,b){for(var c=Prototype.Selector.match,e=[],g=0,l=a.length;g<l;g++){var r=a[g];c(r,b)&&e.push(Element.extend(r))}return e},
findElement:function(a,b,c){c=c||0;for(var e=0,g,l=0,r=a.length;l<r;l++){g=a[l];if(Prototype.Selector.match(g,b)&&c===e++)return Element.extend(g)}},findChildElements:function(a,b){b=b.toArray().join(", ");return Prototype.Selector.select(b,a||document)}})})();(function(a,b){function c(f){var h=f.length,n=m.type(f);if(m.isWindow(f))return false;if(f.nodeType===1&&h)return true;return n==="array"||n!=="function"&&(h===0||typeof h==="number"&&h>0&&h-1 in f)}function e(f){var h=vc[f]={};m.each(f.match(hb)||[],function(n,o){h[o]=true});return h}function g(f,h,n,o){if(m.acceptData(f)){var s=m.expando,y=typeof h==="string",C=f.nodeType,K=C?m.cache:f,S=C?f[s]:f[s]&&s;if(!((!S||!K[S]||!o&&!K[S].data)&&y&&n===b)){if(!S)if(C)f[s]=S=Za.pop()||m.guid++;else S=s;if(!K[S]){K[S]=
{};if(!C)K[S].toJSON=m.noop}if(typeof h==="object"||typeof h==="function")if(o)K[S]=m.extend(K[S],h);else K[S].data=m.extend(K[S].data,h);f=K[S];if(!o){if(!f.data)f.data={};f=f.data}if(n!==b)f[m.camelCase(h)]=n;if(y){n=f[h];if(n==null)n=f[m.camelCase(h)]}else n=f;return n}}}function l(f,h,n){if(m.acceptData(f)){var o,s,y,C=f.nodeType,K=C?m.cache:f,S=C?f[m.expando]:m.expando;if(K[S]){if(h)if(y=n?K[S]:K[S].data){if(m.isArray(h))h=h.concat(m.map(h,m.camelCase));else if(h in y)h=[h];else{h=m.camelCase(h);
h=h in y?[h]:h.split(" ")}o=0;for(s=h.length;o<s;o++)delete y[h[o]];if(!(n?u:m.isEmptyObject)(y))return}if(!n){delete K[S].data;if(!u(K[S]))return}if(C)m.cleanData([f],true);else if(m.support.deleteExpando||K!=K.window)delete K[S];else K[S]=null}}}function r(f,h,n){if(n===b&&f.nodeType===1){n="data-"+h.replace($c,"-$1").toLowerCase();n=f.getAttribute(n);if(typeof n==="string"){try{n=n==="true"?true:n==="false"?false:n==="null"?null:+n+""===n?+n:ad.test(n)?m.parseJSON(n):n}catch(o){}m.data(f,h,n)}else n=
b}return n}function u(f){var h;for(h in f)if(!(h==="data"&&m.isEmptyObject(f[h])))if(h!=="toJSON")return false;return true}function t(){return true}function v(){return false}function G(f,h){do f=f[h];while(f&&f.nodeType!==1);return f}function q(f,h,n){h=h||0;if(m.isFunction(h))return m.grep(f,function(s,y){return!!h.call(s,y,s)===n});else if(h.nodeType)return m.grep(f,function(s){return s===h===n});else if(typeof h==="string"){var o=m.grep(f,function(s){return s.nodeType===1});if(bd.test(h))return m.filter(h,
o,!n);else h=m.filter(h,o)}return m.grep(f,function(s){return m.inArray(s,h)>=0===n})}function D(f){var h=wc.split("|");f=f.createDocumentFragment();if(f.createElement)for(;h.length;)f.createElement(h.pop());return f}function J(f,h){return f.getElementsByTagName(h)[0]||f.appendChild(f.ownerDocument.createElement(h))}function M(f){var h=f.getAttributeNode("type");f.type=(h&&h.specified)+"/"+f.type;return f}function A(f){var h=cd.exec(f.type);if(h)f.type=h[1];else f.removeAttribute("type");return f}
function Q(f,h){for(var n,o=0;(n=f[o])!=null;o++)m._data(n,"globalEval",!h||m._data(h[o],"globalEval"))}function j(f,h){if(!(h.nodeType!==1||!m.hasData(f))){var n,o,s;o=m._data(f);f=m._data(h,o);var y=o.events;if(y){delete f.handle;f.events={};for(n in y){o=0;for(s=y[n].length;o<s;o++)m.event.add(h,n,y[n][o])}}if(f.data)f.data=m.extend({},f.data)}}function p(f,h){var n,o,s;if(h.nodeType===1){n=h.nodeName.toLowerCase();if(!m.support.noCloneEvent&&h[m.expando]){s=m._data(h);for(o in s.events)m.removeEvent(h,
o,s.handle);h.removeAttribute(m.expando)}if(n==="script"&&h.text!==f.text){M(h).text=f.text;A(h)}else if(n==="object"){if(h.parentNode)h.outerHTML=f.outerHTML;if(m.support.html5Clone&&f.innerHTML&&!m.trim(h.innerHTML))h.innerHTML=f.innerHTML}else if(n==="input"&&ec.test(f.type)){h.defaultChecked=h.checked=f.checked;if(h.value!==f.value)h.value=f.value}else if(n==="option")h.defaultSelected=h.selected=f.defaultSelected;else if(n==="input"||n==="textarea")h.defaultValue=f.defaultValue}}function w(f,
h){var n,o,s=0,y=typeof f.getElementsByTagName!==sa?f.getElementsByTagName(h||"*"):typeof f.querySelectorAll!==sa?f.querySelectorAll(h||"*"):b;if(!y){y=[];for(n=f.childNodes||f;(o=n[s])!=null;s++)!h||m.nodeName(o,h)?y.push(o):m.merge(y,w(o,h))}return h===b||h&&m.nodeName(f,h)?m.merge([f],y):y}function B(f){if(ec.test(f.type))f.defaultChecked=f.checked}function H(f,h){if(h in f)return h;for(var n=h.charAt(0).toUpperCase()+h.slice(1),o=h,s=xc.length;s--;){h=xc[s]+n;if(h in f)return h}return o}function z(f,
h){f=h||f;return m.css(f,"display")==="none"||!m.contains(f.ownerDocument,f)}function N(f,h){for(var n,o,s,y=[],C=0,K=f.length;C<K;C++){o=f[C];if(o.style){y[C]=m._data(o,"olddisplay");n=o.style.display;if(h){if(!y[C]&&n==="none")o.style.display="";if(o.style.display===""&&z(o))y[C]=m._data(o,"olddisplay",aa(o.nodeName))}else if(!y[C]){s=z(o);if(n&&n!=="none"||!s)m._data(o,"olddisplay",s?n:m.css(o,"display"))}}}for(C=0;C<K;C++){o=f[C];if(o.style)if(!h||o.style.display==="none"||o.style.display==="")o.style.display=
h?y[C]||"":"none"}return f}function U(f,h,n){return(f=dd.exec(h))?Math.max(0,f[1]-(n||0))+(f[2]||"px"):h}function E(f,h,n,o,s){h=n===(o?"border":"content")?4:h==="width"?1:0;for(var y=0;h<4;h+=2){if(n==="margin")y+=m.css(f,n+Ab[h],true,s);if(o){if(n==="content")y-=m.css(f,"padding"+Ab[h],true,s);if(n!=="margin")y-=m.css(f,"border"+Ab[h]+"Width",true,s)}else{y+=m.css(f,"padding"+Ab[h],true,s);if(n!=="padding")y+=m.css(f,"border"+Ab[h]+"Width",true,s)}}return y}function O(f,h,n){var o=true,s=h==="width"?
f.offsetWidth:f.offsetHeight,y=Bb(f),C=m.support.boxSizing&&m.css(f,"boxSizing",false,y)==="border-box";if(s<=0||s==null){s=Cb(f,h,y);if(s<0||s==null)s=f.style[h];if(Yb.test(s))return s;o=C&&(m.support.boxSizingReliable||s===f.style[h]);s=parseFloat(s)||0}return s+E(f,h,n||(C?"border":"content"),o,y)+"px"}function aa(f){var h=I,n=yc[f];if(!n){n=ja(f,h);if(n==="none"||!n){Ub=(Ub||m("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(h.documentElement);
h=(Ub[0].contentWindow||Ub[0].contentDocument).document;h.write("<!doctype html><html><body>");h.close();n=ja(f,h);Ub.detach()}yc[f]=n}return n}function ja(f,h){f=m(h.createElement(f)).appendTo(h.body);h=m.css(f[0],"display");f.remove();return h}function P(f,h,n,o){var s;if(m.isArray(h))m.each(h,function(y,C){n||ed.test(f)?o(f,C):P(f+"["+(typeof C==="object"?y:"")+"]",C,n,o)});else if(!n&&m.type(h)==="object")for(s in h)P(f+"["+s+"]",h[s],n,o);else o(f,h)}function ia(f){return function(h,n){if(typeof h!==
"string"){n=h;h="*"}var o=0,s=h.toLowerCase().match(hb)||[];if(m.isFunction(n))for(;h=s[o++];)if(h[0]==="+"){h=h.slice(1)||"*";(f[h]=f[h]||[]).unshift(n)}else(f[h]=f[h]||[]).push(n)}}function W(f,h,n,o){function s(K){var S;y[K]=true;m.each(f[K]||[],function(ka,ba){ka=ba(h,n,o);if(typeof ka==="string"&&!C&&!y[ka]){h.dataTypes.unshift(ka);s(ka);return false}else if(C)return!(S=ka)});return S}var y={},C=f===fc;return s(h.dataTypes[0])||!y["*"]&&s("*")}function V(f,h){var n,o,s=m.ajaxSettings.flatOptions||
{};for(o in h)if(h[o]!==b)(s[o]?f:n||(n={}))[o]=h[o];n&&m.extend(true,f,n);return f}function ca(f,h,n){var o,s,y,C,K=f.contents,S=f.dataTypes,ka=f.responseFields;for(C in ka)if(C in n)h[ka[C]]=n[C];for(;S[0]==="*";){S.shift();if(s===b)s=f.mimeType||h.getResponseHeader("Content-Type")}if(s)for(C in K)if(K[C]&&K[C].test(s)){S.unshift(C);break}if(S[0]in n)y=S[0];else{for(C in n){if(!S[0]||f.converters[C+" "+S[0]]){y=C;break}o||(o=C)}y=y||o}if(y){y!==S[0]&&S.unshift(y);return n[y]}}function ra(f,h){var n,
o,s,y,C={},K=0,S=f.dataTypes.slice(),ka=S[0];if(f.dataFilter)h=f.dataFilter(h,f.dataType);if(S[1])for(s in f.converters)C[s.toLowerCase()]=f.converters[s];for(;o=S[++K];)if(o!=="*"){if(ka!=="*"&&ka!==o){s=C[ka+" "+o]||C["* "+o];if(!s)for(n in C){y=n.split(" ");if(y[1]===o)if(s=C[ka+" "+y[0]]||C["* "+y[0]]){if(s===true)s=C[n];else if(C[n]!==true){o=y[0];S.splice(K--,0,o)}break}}if(s!==true)if(s&&f["throws"])h=s(h);else try{h=s(h)}catch(ba){return{state:"parsererror",error:s?ba:"No conversion from "+
ka+" to "+o}}}ka=o}return{state:"success",data:h}}function ga(){try{return new a.XMLHttpRequest}catch(f){}}function fa(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(f){}}function za(){setTimeout(function(){Kb=b});return Kb=m.now()}function ta(f,h){m.each(h,function(n,o){for(var s=(Vb[n]||[]).concat(Vb["*"]),y=0,C=s.length;y<C;y++)if(s[y].call(f,n,o))return})}function Ga(f,h,n){var o,s=0,y=Zb.length,C=m.Deferred().always(function(){delete K.elem}),K=function(){if(o)return false;var ka=
Kb||za();ka=Math.max(0,S.startTime+S.duration-ka);for(var ba=1-(ka/S.duration||0),pa=0,ya=S.tweens.length;pa<ya;pa++)S.tweens[pa].run(ba);C.notifyWith(f,[S,ba,ka]);if(ba<1&&ya)return ka;else{C.resolveWith(f,[S]);return false}},S=C.promise({elem:f,props:m.extend({},h),opts:m.extend(true,{specialEasing:{}},n),originalProperties:h,originalOptions:n,startTime:Kb||za(),duration:n.duration,tweens:[],createTween:function(ka,ba){ka=m.Tween(f,S.opts,ka,ba,S.opts.specialEasing[ka]||S.opts.easing);S.tweens.push(ka);
return ka},stop:function(ka){var ba=0,pa=ka?S.tweens.length:0;if(o)return this;for(o=true;ba<pa;ba++)S.tweens[ba].run(1);ka?C.resolveWith(f,[S,ka]):C.rejectWith(f,[S,ka]);return this}});n=S.props;for(la(n,S.opts.specialEasing);s<y;s++)if(h=Zb[s].call(S,f,n,S.opts))return h;ta(S,n);m.isFunction(S.opts.start)&&S.opts.start.call(f,S);m.fx.timer(m.extend(K,{elem:f,anim:S,queue:S.opts.queue}));return S.progress(S.opts.progress).done(S.opts.done,S.opts.complete).fail(S.opts.fail).always(S.opts.always)}
function la(f,h){var n,o,s,y,C;for(s in f){o=m.camelCase(s);y=h[o];n=f[s];if(m.isArray(n)){y=n[1];n=f[s]=n[0]}if(s!==o){f[o]=n;delete f[s]}if((C=m.cssHooks[o])&&"expand"in C){n=C.expand(n);delete f[o];for(s in n)if(!(s in f)){f[s]=n[s];h[s]=y}}else h[o]=y}}function da(f,h,n){var o,s,y,C,K,S,ka=this,ba=f.style,pa={},ya=[],Ca=f.nodeType&&z(f);if(!n.queue){K=m._queueHooks(f,"fx");if(K.unqueued==null){K.unqueued=0;S=K.empty.fire;K.empty.fire=function(){K.unqueued||S()}}K.unqueued++;ka.always(function(){ka.always(function(){K.unqueued--;
m.queue(f,"fx").length||K.empty.fire()})})}if(f.nodeType===1&&("height"in h||"width"in h)){n.overflow=[ba.overflow,ba.overflowX,ba.overflowY];if(m.css(f,"display")==="inline"&&m.css(f,"float")==="none")if(!m.support.inlineBlockNeedsLayout||aa(f.nodeName)==="inline")ba.display="inline-block";else ba.zoom=1}if(n.overflow){ba.overflow="hidden";m.support.shrinkWrapBlocks||ka.always(function(){ba.overflow=n.overflow[0];ba.overflowX=n.overflow[1];ba.overflowY=n.overflow[2]})}for(s in h){y=h[s];if(fd.exec(y)){delete h[s];
o=o||y==="toggle";if(y!==(Ca?"hide":"show"))ya.push(s)}}if(h=ya.length){y=m._data(f,"fxshow")||m._data(f,"fxshow",{});if("hidden"in y)Ca=y.hidden;if(o)y.hidden=!Ca;Ca?m(f).show():ka.done(function(){m(f).hide()});ka.done(function(){var Qa;m._removeData(f,"fxshow");for(Qa in pa)m.style(f,Qa,pa[Qa])});for(s=0;s<h;s++){o=ya[s];C=ka.createTween(o,Ca?y[o]:0);pa[o]=y[o]||m.style(f,o);if(!(o in y)){y[o]=C.start;if(Ca){C.end=C.start;C.start=o==="width"||o==="height"?1:0}}}}}function ha(f,h,n,o,s){return new ha.prototype.init(f,
h,n,o,s)}function qa(f,h){var n,o={height:f},s=0;for(h=h?1:0;s<4;s+=2-h){n=Ab[s];o["margin"+n]=o["padding"+n]=f}if(h)o.opacity=o.width=f;return o}function T(f){return m.isWindow(f)?f:f.nodeType===9?f.defaultView||f.parentWindow:false}var Y,oa,sa=typeof b,I=a.document,X=a.location,Ba=a.jQuery,Ha=a.$,Pa={},Za=[],cb=Za.concat,bb=Za.push,Ua=Za.slice,mb=Za.indexOf,pb=Pa.toString,tb=Pa.hasOwnProperty,Lb="1.9.1".trim,m=function(f,h){return new m.fn.init(f,h,oa)},ub=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,
hb=/\S+/g,ea=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ua=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,va=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,Fa=/^[\],:{}\s]*$/,La=/(?:^|:|,)(?:\s*\[)+/g,Va=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,Mb=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,qb=/^-ms-/,vb=/-([\da-z])/gi,gd=function(f,h){return h.toUpperCase()},wb=function(f){if(I.addEventListener||f.type==="load"||I.readyState==="complete"){zc();m.ready()}},zc=function(){if(I.addEventListener){I.removeEventListener("DOMContentLoaded",
wb,false);a.removeEventListener("load",wb,false)}else{I.detachEvent("onreadystatechange",wb);a.detachEvent("onload",wb)}};m.fn=m.prototype={jquery:"1.9.1",constructor:m,init:function(f,h,n){var o;if(!f)return this;if(typeof f==="string")if((o=f.charAt(0)==="<"&&f.charAt(f.length-1)===">"&&f.length>=3?[null,f,null]:ua.exec(f))&&(o[1]||!h)){if(o[1]){h=h instanceof m?h[0]:h;m.merge(this,m.parseHTML(o[1],h&&h.nodeType?h.ownerDocument||h:I,true));if(va.test(o[1])&&m.isPlainObject(h))for(o in h)m.isFunction(this[o])?
this[o](h[o]):this.attr(o,h[o])}else{if((h=I.getElementById(o[2]))&&h.parentNode){if(h.id!==o[2])return n.find(f);this.length=1;this[0]=h}this.context=I;this.selector=f}return this}else return!h||h.jquery?(h||n).find(f):this.constructor(h).find(f);else if(f.nodeType){this.context=this[0]=f;this.length=1;return this}else if(m.isFunction(f))return n.ready(f);if(f.selector!==b){this.selector=f.selector;this.context=f.context}return m.makeArray(f,this)},selector:"",length:0,size:function(){return this.length},
toArray:function(){return Ua.call(this)},get:function(f){return f==null?this.toArray():f<0?this[this.length+f]:this[f]},pushStack:function(f){f=m.merge(this.constructor(),f);f.prevObject=this;f.context=this.context;return f},each:function(f,h){return m.each(this,f,h)},ready:function(f){m.ready.promise().done(f);return this},slice:function(){return this.pushStack(Ua.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(f){var h=this.length;f=+f+
(f<0?h:0);return this.pushStack(f>=0&&f<h?[this[f]]:[])},map:function(f){return this.pushStack(m.map(this,function(h,n){return f.call(h,n,h)}))},end:function(){return this.prevObject||this.constructor(null)},push:bb,sort:[].sort,splice:[].splice};m.fn.init.prototype=m.fn;m.extend=m.fn.extend=function(){var f,h,n,o,s,y=arguments[0]||{},C=1,K=arguments.length,S=false;if(typeof y==="boolean"){S=y;y=arguments[1]||{};C=2}if(typeof y!=="object"&&!m.isFunction(y))y={};if(K===C){y=this;--C}for(;C<K;C++)if((s=
arguments[C])!=null)for(o in s){f=y[o];n=s[o];if(y!==n)if(S&&n&&(m.isPlainObject(n)||(h=m.isArray(n)))){if(h){h=false;f=f&&m.isArray(f)?f:[]}else f=f&&m.isPlainObject(f)?f:{};y[o]=m.extend(S,f,n)}else if(n!==b)y[o]=n}return y};m.extend({noConflict:function(f){if(a.$===m)a.$=Ha;if(f&&a.jQuery===m)a.jQuery=Ba;return m},isReady:false,readyWait:1,holdReady:function(f){if(f)m.readyWait++;else m.ready(true)},ready:function(f){if(!(f===true?--m.readyWait:m.isReady)){if(!I.body)return setTimeout(m.ready);
m.isReady=true;if(!(f!==true&&--m.readyWait>0)){Y.resolveWith(I,[m]);m.fn.trigger&&m(I).trigger("ready").off("ready")}}},isFunction:function(f){return m.type(f)==="function"},isArray:Array.isArray||function(f){return m.type(f)==="array"},isWindow:function(f){return f!=null&&f==f.window},isNumeric:function(f){return!isNaN(parseFloat(f))&&isFinite(f)},type:function(f){if(f==null)return String(f);return typeof f==="object"||typeof f==="function"?Pa[pb.call(f)]||"object":typeof f},isPlainObject:function(f){if(!f||
m.type(f)!=="object"||f.nodeType||m.isWindow(f))return false;try{if(f.constructor&&!tb.call(f,"constructor")&&!tb.call(f.constructor.prototype,"isPrototypeOf"))return false}catch(h){return false}var n;for(n in f);return n===b||tb.call(f,n)},isEmptyObject:function(f){var h;for(h in f)return false;return true},error:function(f){throw new Error(f);},parseHTML:function(f,h,n){if(!f||typeof f!=="string")return null;if(typeof h==="boolean"){n=h;h=false}h=h||I;var o=va.exec(f);n=!n&&[];if(o)return[h.createElement(o[1])];
o=m.buildFragment([f],h,n);n&&m(n).remove();return m.merge([],o.childNodes)},parseJSON:function(f){if(a.JSON&&a.JSON.parse)return a.JSON.parse(f);if(f===null)return f;if(typeof f==="string")if(f=m.trim(f))if(Fa.test(f.replace(Va,"@").replace(Mb,"]").replace(La,"")))return(new Function("return "+f))();m.error("Invalid JSON: "+f)},parseXML:function(f){var h,n;if(!f||typeof f!=="string")return null;try{if(a.DOMParser){n=new DOMParser;h=n.parseFromString(f,"text/xml")}else{h=new ActiveXObject("Microsoft.XMLDOM");
h.async="false";h.loadXML(f)}}catch(o){h=b}if(!h||!h.documentElement||h.getElementsByTagName("parsererror").length)m.error("Invalid XML: "+f);return h},noop:function(){},globalEval:function(f){if(f&&m.trim(f))(a.execScript||function(h){a.eval.call(a,h)})(f)},camelCase:function(f){return f.replace(qb,"ms-").replace(vb,gd)},nodeName:function(f,h){return f.nodeName&&f.nodeName.toLowerCase()===h.toLowerCase()},each:function(f,h,n){var o,s=0,y=f.length;o=c(f);if(n)if(o)for(;s<y;s++){o=h.apply(f[s],n);
if(o===false)break}else for(s in f){o=h.apply(f[s],n);if(o===false)break}else if(o)for(;s<y;s++){o=h.call(f[s],s,f[s]);if(o===false)break}else for(s in f){o=h.call(f[s],s,f[s]);if(o===false)break}return f},trim:Lb&&!Lb.call("\ufeff\u00a0")?function(f){return f==null?"":Lb.call(f)}:function(f){return f==null?"":(f+"").replace(ea,"")},makeArray:function(f,h){h=h||[];if(f!=null)c(Object(f))?m.merge(h,typeof f==="string"?[f]:f):bb.call(h,f);return h},inArray:function(f,h,n){var o;if(h){if(mb)return mb.call(h,
f,n);o=h.length;for(n=n?n<0?Math.max(0,o+n):n:0;n<o;n++)if(n in h&&h[n]===f)return n}return-1},merge:function(f,h){var n=h.length,o=f.length,s=0;if(typeof n==="number")for(;s<n;s++)f[o++]=h[s];else for(;h[s]!==b;)f[o++]=h[s++];f.length=o;return f},grep:function(f,h,n){var o,s=[],y=0,C=f.length;for(n=!!n;y<C;y++){o=!!h(f[y],y);n!==o&&s.push(f[y])}return s},map:function(f,h,n){var o,s=0,y=f.length,C=[];if(c(f))for(;s<y;s++){o=h(f[s],s,n);if(o!=null)C[C.length]=o}else for(s in f){o=h(f[s],s,n);if(o!=
null)C[C.length]=o}return cb.apply([],C)},guid:1,proxy:function(f,h){var n,o;if(typeof h==="string"){o=f[h];h=f;f=o}if(!m.isFunction(f))return b;n=Ua.call(arguments,2);o=function(){return f.apply(h||this,n.concat(Ua.call(arguments)))};o.guid=f.guid=f.guid||m.guid++;return o},access:function(f,h,n,o,s,y,C){var K=0,S=f.length,ka=n==null;if(m.type(n)==="object"){s=true;for(K in n)m.access(f,h,K,n[K],true,y,C)}else if(o!==b){s=true;m.isFunction(o)||(C=true);if(ka)if(C){h.call(f,o);h=null}else{ka=h;h=
function(ba,pa,ya){return ka.call(m(ba),ya)}}if(h)for(;K<S;K++)h(f[K],n,C?o:o.call(f[K],K,h(f[K],n)))}return s?f:ka?h.call(f):S?h(f[0],n):y},now:function(){return(new Date).getTime()}});m.ready.promise=function(f){if(!Y){Y=m.Deferred();if(I.readyState==="complete")setTimeout(m.ready);else if(I.addEventListener){I.addEventListener("DOMContentLoaded",wb,false);a.addEventListener("load",wb,false)}else{I.attachEvent("onreadystatechange",wb);a.attachEvent("onload",wb);var h=false;try{h=a.frameElement==
null&&I.documentElement}catch(n){}h&&h.doScroll&&function o(){if(!m.isReady){try{h.doScroll("left")}catch(s){return setTimeout(o,50)}zc();m.ready()}}()}}return Y.promise(f)};m.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(f,h){Pa["[object "+h+"]"]=h.toLowerCase()});oa=m(I);var vc={};m.Callbacks=function(f){f=typeof f==="string"?vc[f]||e(f):m.extend({},f);var h,n,o,s,y,C,K=[],S=!f.once&&[],ka=function(pa){n=f.memory&&pa;o=true;y=C||0;C=0;s=K.length;for(h=
true;K&&y<s;y++)if(K[y].apply(pa[0],pa[1])===false&&f.stopOnFalse){n=false;break}h=false;if(K)if(S)S.length&&ka(S.shift());else if(n)K=[];else ba.disable()},ba={add:function(){if(K){var pa=K.length;(function ya(Ca){m.each(Ca,function(Qa,Wa){Qa=m.type(Wa);if(Qa==="function"){if(!f.unique||!ba.has(Wa))K.push(Wa)}else Wa&&Wa.length&&Qa!=="string"&&ya(Wa)})})(arguments);if(h)s=K.length;else if(n){C=pa;ka(n)}}return this},remove:function(){K&&m.each(arguments,function(pa,ya){for(var Ca;(Ca=m.inArray(ya,
K,Ca))>-1;){K.splice(Ca,1);if(h){Ca<=s&&s--;Ca<=y&&y--}}});return this},has:function(pa){return pa?m.inArray(pa,K)>-1:!!(K&&K.length)},empty:function(){K=[];return this},disable:function(){K=S=n=b;return this},disabled:function(){return!K},lock:function(){S=b;n||ba.disable();return this},locked:function(){return!S},fireWith:function(pa,ya){ya=ya||[];ya=[pa,ya.slice?ya.slice():ya];if(K&&(!o||S))h?S.push(ya):ka(ya);return this},fire:function(){ba.fireWith(this,arguments);return this},fired:function(){return!!o}};
return ba};m.extend({Deferred:function(f){var h=[["resolve","done",m.Callbacks("once memory"),"resolved"],["reject","fail",m.Callbacks("once memory"),"rejected"],["notify","progress",m.Callbacks("memory")]],n="pending",o={state:function(){return n},always:function(){s.done(arguments).fail(arguments);return this},then:function(){var y=arguments;return m.Deferred(function(C){m.each(h,function(K,S){var ka=S[0],ba=m.isFunction(y[K])&&y[K];s[S[1]](function(){var pa=ba&&ba.apply(this,arguments);pa&&m.isFunction(pa.promise)?
pa.promise().done(C.resolve).fail(C.reject).progress(C.notify):C[ka+"With"](this===o?C.promise():this,ba?[pa]:arguments)})});y=null}).promise()},promise:function(y){return y!=null?m.extend(y,o):o}},s={};o.pipe=o.then;m.each(h,function(y,C){var K=C[2],S=C[3];o[C[1]]=K.add;S&&K.add(function(){n=S},h[y^1][2].disable,h[2][2].lock);s[C[0]]=function(){s[C[0]+"With"](this===s?o:this,arguments);return this};s[C[0]+"With"]=K.fireWith});o.promise(s);f&&f.call(s,s);return s},when:function(f){var h=0,n=Ua.call(arguments),
o=n.length,s=o!==1||f&&m.isFunction(f.promise)?o:0,y=s===1?f:m.Deferred(),C=function(ba,pa,ya){return function(Ca){pa[ba]=this;ya[ba]=arguments.length>1?Ua.call(arguments):Ca;if(ya===K)y.notifyWith(pa,ya);else--s||y.resolveWith(pa,ya)}},K,S,ka;if(o>1){K=new Array(o);S=new Array(o);for(ka=new Array(o);h<o;h++)if(n[h]&&m.isFunction(n[h].promise))n[h].promise().done(C(h,ka,n)).fail(y.reject).progress(C(h,S,K));else--s}s||y.resolveWith(ka,n);return y.promise()}});m.support=function(){var f,h,n,o,s,y,
C,K=I.createElement("div");K.setAttribute("className","t");K.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";h=K.getElementsByTagName("*");n=K.getElementsByTagName("a")[0];if(!h||!n||!h.length)return{};o=I.createElement("select");s=o.appendChild(I.createElement("option"));h=K.getElementsByTagName("input")[0];n.style.cssText="top:1px;float:left;opacity:.5";f={getSetAttribute:K.className!=="t",leadingWhitespace:K.firstChild.nodeType===3,tbody:!K.getElementsByTagName("tbody").length,
htmlSerialize:!!K.getElementsByTagName("link").length,style:/top/.test(n.getAttribute("style")),hrefNormalized:n.getAttribute("href")==="/a",opacity:/^0.5/.test(n.style.opacity),cssFloat:!!n.style.cssFloat,checkOn:!!h.value,optSelected:s.selected,enctype:!!I.createElement("form").enctype,html5Clone:I.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>",boxModel:I.compatMode==="CSS1Compat",deleteExpando:true,noCloneEvent:true,inlineBlockNeedsLayout:false,shrinkWrapBlocks:false,reliableMarginRight:true,
boxSizingReliable:true,pixelPosition:false};h.checked=true;f.noCloneChecked=h.cloneNode(true).checked;o.disabled=true;f.optDisabled=!s.disabled;try{delete K.test}catch(S){f.deleteExpando=false}h=I.createElement("input");h.setAttribute("value","");f.input=h.getAttribute("value")==="";h.value="t";h.setAttribute("type","radio");f.radioValue=h.value==="t";h.setAttribute("checked","t");h.setAttribute("name","t");n=I.createDocumentFragment();n.appendChild(h);f.appendChecked=h.checked;f.checkClone=n.cloneNode(true).cloneNode(true).lastChild.checked;
if(K.attachEvent){K.attachEvent("onclick",function(){f.noCloneEvent=false});K.cloneNode(true).click()}for(C in{submit:true,change:true,focusin:true}){K.setAttribute(n="on"+C,"t");f[C+"Bubbles"]=n in a||K.attributes[n].expando===false}K.style.backgroundClip="content-box";K.cloneNode(true).style.backgroundClip="";f.clearCloneStyle=K.style.backgroundClip==="content-box";m(function(){var ka,ba,pa=I.getElementsByTagName("body")[0];if(pa){ka=I.createElement("div");ka.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px";
pa.appendChild(ka).appendChild(K);K.innerHTML="<table><tr><td></td><td>t</td></tr></table>";ba=K.getElementsByTagName("td");ba[0].style.cssText="padding:0;margin:0;border:0;display:none";y=ba[0].offsetHeight===0;ba[0].style.display="";ba[1].style.display="none";f.reliableHiddenOffsets=y&&ba[0].offsetHeight===0;K.innerHTML="";K.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;";
f.boxSizing=K.offsetWidth===4;f.doesNotIncludeMarginInBodyOffset=pa.offsetTop!==1;if(a.getComputedStyle){f.pixelPosition=(a.getComputedStyle(K,null)||{}).top!=="1%";f.boxSizingReliable=(a.getComputedStyle(K,null)||{width:"4px"}).width==="4px";ba=K.appendChild(I.createElement("div"));ba.style.cssText=K.style.cssText="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;";ba.style.marginRight=ba.style.width="0";K.style.width="1px";
f.reliableMarginRight=!parseFloat((a.getComputedStyle(ba,null)||{}).marginRight)}if(typeof K.style.zoom!==sa){K.innerHTML="";K.style.cssText="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;width:1px;padding:1px;display:inline;zoom:1";f.inlineBlockNeedsLayout=K.offsetWidth===3;K.style.display="block";K.innerHTML="<div></div>";K.firstChild.style.width="5px";f.shrinkWrapBlocks=K.offsetWidth!==3;if(f.inlineBlockNeedsLayout)pa.style.zoom=
1}pa.removeChild(ka);K=null}});h=o=n=s=n=h=null;return f}();var ad=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,$c=/([A-Z])/g;m.extend({cache:{},expando:"jQuery"+("1.9.1"+Math.random()).replace(/\D/g,""),noData:{embed:true,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:true},hasData:function(f){f=f.nodeType?m.cache[f[m.expando]]:f[m.expando];return!!f&&!u(f)},data:function(f,h,n){return g(f,h,n)},removeData:function(f,h){return l(f,h)},_data:function(f,h,n){return g(f,h,n,true)},_removeData:function(f,
h){return l(f,h,true)},acceptData:function(f){if(f.nodeType&&f.nodeType!==1&&f.nodeType!==9)return false;var h=f.nodeName&&m.noData[f.nodeName.toLowerCase()];return!h||h!==true&&f.getAttribute("classid")===h}});m.fn.extend({data:function(f,h){var n,o,s=this[0],y=0,C=null;if(f===b){if(this.length){C=m.data(s);if(s.nodeType===1&&!m._data(s,"parsedAttrs")){for(n=s.attributes;y<n.length;y++){o=n[y].name;if(!o.indexOf("data-")){o=m.camelCase(o.slice(5));r(s,o,C[o])}}m._data(s,"parsedAttrs",true)}}return C}if(typeof f===
"object")return this.each(function(){m.data(this,f)});return m.access(this,function(K){if(K===b)return s?r(s,f,m.data(s,f)):null;this.each(function(){m.data(this,f,K)})},null,h,arguments.length>1,null,true)},removeData:function(f){return this.each(function(){m.removeData(this,f)})}});m.extend({queue:function(f,h,n){var o;if(f){h=(h||"fx")+"queue";o=m._data(f,h);if(n)if(!o||m.isArray(n))o=m._data(f,h,m.makeArray(n));else o.push(n);return o||[]}},dequeue:function(f,h){h=h||"fx";var n=m.queue(f,h),o=
n.length,s=n.shift(),y=m._queueHooks(f,h),C=function(){m.dequeue(f,h)};if(s==="inprogress"){s=n.shift();o--}if(y.cur=s){h==="fx"&&n.unshift("inprogress");delete y.stop;s.call(f,C,y)}!o&&y&&y.empty.fire()},_queueHooks:function(f,h){var n=h+"queueHooks";return m._data(f,n)||m._data(f,n,{empty:m.Callbacks("once memory").add(function(){m._removeData(f,h+"queue");m._removeData(f,n)})})}});m.fn.extend({queue:function(f,h){var n=2;if(typeof f!=="string"){h=f;f="fx";n--}if(arguments.length<n)return m.queue(this[0],
f);return h===b?this:this.each(function(){var o=m.queue(this,f,h);m._queueHooks(this,f);f==="fx"&&o[0]!=="inprogress"&&m.dequeue(this,f)})},dequeue:function(f){return this.each(function(){m.dequeue(this,f)})},delay:function(f,h){f=m.fx?m.fx.speeds[f]||f:f;h=h||"fx";return this.queue(h,function(n,o){var s=setTimeout(n,f);o.stop=function(){clearTimeout(s)}})},clearQueue:function(f){return this.queue(f||"fx",[])},promise:function(f,h){var n,o=1,s=m.Deferred(),y=this,C=this.length,K=function(){--o||s.resolveWith(y,
[y])};if(typeof f!=="string"){h=f;f=b}for(f=f||"fx";C--;)if((n=m._data(y[C],f+"queueHooks"))&&n.empty){o++;n.empty.add(K)}K();return s.promise(h)}});var Nb,Ac,gc=/[\t\r\n]/g,hd=/\r/g,id=/^(?:input|select|textarea|button|object)$/i,jd=/^(?:a|area)$/i,Bc=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,hc=/^(?:checked|selected)$/i,Db=m.support.getSetAttribute,ic=m.support.input;m.fn.extend({attr:function(f,h){return m.access(this,
m.attr,f,h,arguments.length>1)},removeAttr:function(f){return this.each(function(){m.removeAttr(this,f)})},prop:function(f,h){return m.access(this,m.prop,f,h,arguments.length>1)},removeProp:function(f){f=m.propFix[f]||f;return this.each(function(){try{this[f]=b;delete this[f]}catch(h){}})},addClass:function(f){var h,n,o,s,y,C=0,K=this.length;h=typeof f==="string"&&f;if(m.isFunction(f))return this.each(function(S){m(this).addClass(f.call(this,S,this.className))});if(h)for(h=(f||"").match(hb)||[];C<
K;C++){n=this[C];if(o=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(gc," "):" ")){for(y=0;s=h[y++];)if(o.indexOf(" "+s+" ")<0)o+=s+" ";n.className=m.trim(o)}}return this},removeClass:function(f){var h,n,o,s,y,C=0,K=this.length;h=arguments.length===0||typeof f==="string"&&f;if(m.isFunction(f))return this.each(function(S){m(this).removeClass(f.call(this,S,this.className))});if(h)for(h=(f||"").match(hb)||[];C<K;C++){n=this[C];if(o=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(gc,
" "):"")){for(y=0;s=h[y++];)for(;o.indexOf(" "+s+" ")>=0;)o=o.replace(" "+s+" "," ");n.className=f?m.trim(o):""}}return this},toggleClass:function(f,h){var n=typeof f,o=typeof h==="boolean";if(m.isFunction(f))return this.each(function(s){m(this).toggleClass(f.call(this,s,this.className,h),h)});return this.each(function(){if(n==="string")for(var s,y=0,C=m(this),K=h,S=f.match(hb)||[];s=S[y++];){K=o?K:!C.hasClass(s);C[K?"addClass":"removeClass"](s)}else if(n===sa||n==="boolean"){this.className&&m._data(this,
"__className__",this.className);this.className=this.className||f===false?"":m._data(this,"__className__")||""}})},hasClass:function(f){f=" "+f+" ";for(var h=0,n=this.length;h<n;h++)if(this[h].nodeType===1&&(" "+this[h].className+" ").replace(gc," ").indexOf(f)>=0)return true;return false},val:function(f){var h,n,o,s=this[0];if(arguments.length){o=m.isFunction(f);return this.each(function(y){var C=m(this);if(this.nodeType===1){y=o?f.call(this,y,C.val()):f;if(y==null)y="";else if(typeof y==="number")y+=
"";else if(m.isArray(y))y=m.map(y,function(K){return K==null?"":K+""});n=m.valHooks[this.type]||m.valHooks[this.nodeName.toLowerCase()];if(!n||!("set"in n)||n.set(this,y,"value")===b)this.value=y}})}else if(s){if((n=m.valHooks[s.type]||m.valHooks[s.nodeName.toLowerCase()])&&"get"in n&&(h=n.get(s,"value"))!==b)return h;h=s.value;return typeof h==="string"?h.replace(hd,""):h==null?"":h}}});m.extend({valHooks:{option:{get:function(f){var h=f.attributes.value;return!h||h.specified?f.value:f.text}},select:{get:function(f){for(var h,
n=f.options,o=f.selectedIndex,s=(f=f.type==="select-one"||o<0)?null:[],y=f?o+1:n.length,C=o<0?y:f?o:0;C<y;C++){h=n[C];if((h.selected||C===o)&&(m.support.optDisabled?!h.disabled:h.getAttribute("disabled")===null)&&(!h.parentNode.disabled||!m.nodeName(h.parentNode,"optgroup"))){h=m(h).val();if(f)return h;s.push(h)}}return s},set:function(f,h){var n=m.makeArray(h);m(f).find("option").each(function(){this.selected=m.inArray(m(this).val(),n)>=0});if(!n.length)f.selectedIndex=-1;return n}}},attr:function(f,
h,n){var o,s,y;s=f.nodeType;if(!(!f||s===3||s===8||s===2)){if(typeof f.getAttribute===sa)return m.prop(f,h,n);if(s=s!==1||!m.isXMLDoc(f)){h=h.toLowerCase();o=m.attrHooks[h]||(Bc.test(h)?Ac:Nb)}if(n!==b)if(n===null)m.removeAttr(f,h);else if(o&&s&&"set"in o&&(y=o.set(f,n,h))!==b)return y;else{f.setAttribute(h,n+"");return n}else if(o&&s&&"get"in o&&(y=o.get(f,h))!==null)return y;else{if(typeof f.getAttribute!==sa)y=f.getAttribute(h);return y==null?b:y}}},removeAttr:function(f,h){var n,o=0,s=h&&h.match(hb);
if(s&&f.nodeType===1)for(;h=s[o++];){n=m.propFix[h]||h;if(Bc.test(h))if(!Db&&hc.test(h))f[m.camelCase("default-"+h)]=f[n]=false;else f[n]=false;else m.attr(f,h,"");f.removeAttribute(Db?h:n)}},attrHooks:{type:{set:function(f,h){if(!m.support.radioValue&&h==="radio"&&m.nodeName(f,"input")){var n=f.value;f.setAttribute("type",h);if(n)f.value=n;return h}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",
rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(f,h,n){var o,s,y=f.nodeType;if(!(!f||y===3||y===8||y===2)){if(y!==1||!m.isXMLDoc(f)){h=m.propFix[h]||h;s=m.propHooks[h]}return n!==b?s&&"set"in s&&(o=s.set(f,n,h))!==b?o:(f[h]=n):s&&"get"in s&&(o=s.get(f,h))!==null?o:f[h]}},propHooks:{tabIndex:{get:function(f){var h=f.getAttributeNode("tabindex");return h&&h.specified?parseInt(h.value,10):id.test(f.nodeName)||jd.test(f.nodeName)&&
f.href?0:b}}}});Ac={get:function(f,h){var n=m.prop(f,h),o=typeof n==="boolean"&&f.getAttribute(h);return(f=typeof n==="boolean"?ic&&Db?o!=null:hc.test(h)?f[m.camelCase("default-"+h)]:!!o:f.getAttributeNode(h))&&f.value!==false?h.toLowerCase():b},set:function(f,h,n){if(h===false)m.removeAttr(f,n);else if(ic&&Db||!hc.test(n))f.setAttribute(!Db&&m.propFix[n]||n,n);else f[m.camelCase("default-"+n)]=f[n]=true;return n}};if(!ic||!Db)m.attrHooks.value={get:function(f,h){h=f.getAttributeNode(h);return m.nodeName(f,
"input")?f.defaultValue:h&&h.specified?h.value:b},set:function(f,h,n){if(m.nodeName(f,"input"))f.defaultValue=h;else return Nb&&Nb.set(f,h,n)}};if(!Db){Nb=m.valHooks.button={get:function(f,h){return(f=f.getAttributeNode(h))&&(h==="id"||h==="name"||h==="coords"?f.value!=="":f.specified)?f.value:b},set:function(f,h,n){var o=f.getAttributeNode(n);o||f.setAttributeNode(o=f.ownerDocument.createAttribute(n));o.value=h+="";return n==="value"||h===f.getAttribute(n)?h:b}};m.attrHooks.contenteditable={get:Nb.get,
set:function(f,h,n){Nb.set(f,h===""?false:h,n)}};m.each(["width","height"],function(f,h){m.attrHooks[h]=m.extend(m.attrHooks[h],{set:function(n,o){if(o===""){n.setAttribute(h,"auto");return o}}})})}if(!m.support.hrefNormalized){m.each(["href","src","width","height"],function(f,h){m.attrHooks[h]=m.extend(m.attrHooks[h],{get:function(n){n=n.getAttribute(h,2);return n==null?b:n}})});m.each(["href","src"],function(f,h){m.propHooks[h]={get:function(n){return n.getAttribute(h,4)}}})}if(!m.support.style)m.attrHooks.style=
{get:function(f){return f.style.cssText||b},set:function(f,h){return f.style.cssText=h+""}};if(!m.support.optSelected)m.propHooks.selected=m.extend(m.propHooks.selected,{get:function(){return null}});if(!m.support.enctype)m.propFix.enctype="encoding";m.support.checkOn||m.each(["radio","checkbox"],function(){m.valHooks[this]={get:function(f){return f.getAttribute("value")===null?"on":f.value}}});m.each(["radio","checkbox"],function(){m.valHooks[this]=m.extend(m.valHooks[this],{set:function(f,h){if(m.isArray(h))return f.checked=
m.inArray(m(f).val(),h)>=0}})});var jc=/^(?:input|select|textarea)$/i,kd=/^key/,ld=/^(?:mouse|contextmenu)|click/,Cc=/^(?:focusinfocus|focusoutblur)$/,Dc=/^([^.]*)(?:\.(.+)|)$/;m.event={global:{},add:function(f,h,n,o,s){var y,C,K,S,ka,ba,pa,ya,Ca;if(K=m._data(f)){if(n.handler){S=n;n=S.handler;s=S.selector}if(!n.guid)n.guid=m.guid++;if(!(C=K.events))C=K.events={};if(!(ka=K.handle)){ka=K.handle=function(Qa){return typeof m!==sa&&(!Qa||m.event.triggered!==Qa.type)?m.event.dispatch.apply(ka.elem,arguments):
b};ka.elem=f}h=(h||"").match(hb)||[""];for(K=h.length;K--;){y=Dc.exec(h[K])||[];ya=ba=y[1];Ca=(y[2]||"").split(".").sort();y=m.event.special[ya]||{};ya=(s?y.delegateType:y.bindType)||ya;y=m.event.special[ya]||{};ba=m.extend({type:ya,origType:ba,data:o,handler:n,guid:n.guid,selector:s,needsContext:s&&m.expr.match.needsContext.test(s),namespace:Ca.join(".")},S);if(!(pa=C[ya])){pa=C[ya]=[];pa.delegateCount=0;if(!y.setup||y.setup.call(f,o,Ca,ka)===false)if(f.addEventListener)f.addEventListener(ya,ka,
false);else f.attachEvent&&f.attachEvent("on"+ya,ka)}if(y.add){y.add.call(f,ba);if(!ba.handler.guid)ba.handler.guid=n.guid}s?pa.splice(pa.delegateCount++,0,ba):pa.push(ba);m.event.global[ya]=true}f=null}},remove:function(f,h,n,o,s){var y,C,K,S,ka,ba,pa,ya,Ca,Qa,Wa,ib=m.hasData(f)&&m._data(f);if(ib&&(ba=ib.events)){h=(h||"").match(hb)||[""];for(ka=h.length;ka--;){K=Dc.exec(h[ka])||[];Ca=Wa=K[1];Qa=(K[2]||"").split(".").sort();if(Ca){pa=m.event.special[Ca]||{};Ca=(o?pa.delegateType:pa.bindType)||Ca;
ya=ba[Ca]||[];K=K[2]&&new RegExp("(^|\\.)"+Qa.join("\\.(?:.*\\.|)")+"(\\.|$)");for(S=y=ya.length;y--;){C=ya[y];if((s||Wa===C.origType)&&(!n||n.guid===C.guid)&&(!K||K.test(C.namespace))&&(!o||o===C.selector||o==="**"&&C.selector)){ya.splice(y,1);C.selector&&ya.delegateCount--;pa.remove&&pa.remove.call(f,C)}}if(S&&!ya.length){if(!pa.teardown||pa.teardown.call(f,Qa,ib.handle)===false)m.removeEvent(f,Ca,ib.handle);delete ba[Ca]}}else for(Ca in ba)m.event.remove(f,Ca+h[ka],n,o,true)}if(m.isEmptyObject(ba)){delete ib.handle;
m._removeData(f,"events")}}},trigger:function(f,h,n,o){var s,y,C,K,S,ka,ba=[n||I],pa=tb.call(f,"type")?f.type:f;S=tb.call(f,"namespace")?f.namespace.split("."):[];C=s=n=n||I;if(!(n.nodeType===3||n.nodeType===8))if(!Cc.test(pa+m.event.triggered)){if(pa.indexOf(".")>=0){S=pa.split(".");pa=S.shift();S.sort()}y=pa.indexOf(":")<0&&"on"+pa;f=f[m.expando]?f:new m.Event(pa,typeof f==="object"&&f);f.isTrigger=true;f.namespace=S.join(".");f.namespace_re=f.namespace?new RegExp("(^|\\.)"+S.join("\\.(?:.*\\.|)")+
"(\\.|$)"):null;f.result=b;if(!f.target)f.target=n;h=h==null?[f]:m.makeArray(h,[f]);S=m.event.special[pa]||{};if(!(!o&&S.trigger&&S.trigger.apply(n,h)===false)){if(!o&&!S.noBubble&&!m.isWindow(n)){K=S.delegateType||pa;if(!Cc.test(K+pa))C=C.parentNode;for(;C;C=C.parentNode){ba.push(C);s=C}if(s===(n.ownerDocument||I))ba.push(s.defaultView||s.parentWindow||a)}for(ka=0;(C=ba[ka++])&&!f.isPropagationStopped();){f.type=ka>1?K:S.bindType||pa;(s=(m._data(C,"events")||{})[f.type]&&m._data(C,"handle"))&&s.apply(C,
h);(s=y&&C[y])&&m.acceptData(C)&&s.apply&&s.apply(C,h)===false&&f.preventDefault()}f.type=pa;if(!o&&!f.isDefaultPrevented())if((!S._default||S._default.apply(n.ownerDocument,h)===false)&&!(pa==="click"&&m.nodeName(n,"a"))&&m.acceptData(n))if(y&&n[pa]&&!m.isWindow(n)){if(s=n[y])n[y]=null;m.event.triggered=pa;try{n[pa]()}catch(ya){}m.event.triggered=b;if(s)n[y]=s}return f.result}}},dispatch:function(f){f=m.event.fix(f);var h,n,o,s,y=[],C=Ua.call(arguments);h=(m._data(this,"events")||{})[f.type]||[];
var K=m.event.special[f.type]||{};C[0]=f;f.delegateTarget=this;if(!(K.preDispatch&&K.preDispatch.call(this,f)===false)){y=m.event.handlers.call(this,f,h);for(h=0;(o=y[h++])&&!f.isPropagationStopped();){f.currentTarget=o.elem;for(s=0;(n=o.handlers[s++])&&!f.isImmediatePropagationStopped();)if(!f.namespace_re||f.namespace_re.test(n.namespace)){f.handleObj=n;f.data=n.data;n=((m.event.special[n.origType]||{}).handle||n.handler).apply(o.elem,C);if(n!==b)if((f.result=n)===false){f.preventDefault();f.stopPropagation()}}}K.postDispatch&&
K.postDispatch.call(this,f);return f.result}},handlers:function(f,h){var n,o,s,y,C=[],K=h.delegateCount,S=f.target;if(K&&S.nodeType&&(!f.button||f.type!=="click"))for(;S!=this;S=S.parentNode||this)if(S.nodeType===1&&(S.disabled!==true||f.type!=="click")){s=[];for(y=0;y<K;y++){o=h[y];n=o.selector+" ";if(s[n]===b)s[n]=o.needsContext?m(n,this).index(S)>=0:m.find(n,this,null,[S]).length;s[n]&&s.push(o)}s.length&&C.push({elem:S,handlers:s})}K<h.length&&C.push({elem:this,handlers:h.slice(K)});return C},
fix:function(f){if(f[m.expando])return f;var h,n,o;h=f.type;var s=f,y=this.fixHooks[h];y||(this.fixHooks[h]=y=ld.test(h)?this.mouseHooks:kd.test(h)?this.keyHooks:{});o=y.props?this.props.concat(y.props):this.props;f=new m.Event(s);for(h=o.length;h--;){n=o[h];f[n]=s[n]}if(!f.target)f.target=s.srcElement||I;if(f.target.nodeType===3)f.target=f.target.parentNode;f.metaKey=!!f.metaKey;return y.filter?y.filter(f,s):f},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(f,h){if(f.which==null)f.which=h.charCode!=null?h.charCode:h.keyCode;return f}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(f,h){var n,o,s=h.button,y=h.fromElement;if(f.pageX==null&&h.clientX!=null){n=f.target.ownerDocument||I;o=n.documentElement;n=n.body;f.pageX=h.clientX+(o&&o.scrollLeft||n&&n.scrollLeft||0)-(o&&o.clientLeft||
n&&n.clientLeft||0);f.pageY=h.clientY+(o&&o.scrollTop||n&&n.scrollTop||0)-(o&&o.clientTop||n&&n.clientTop||0)}if(!f.relatedTarget&&y)f.relatedTarget=y===f.target?h.toElement:y;if(!f.which&&s!==b)f.which=s&1?1:s&2?3:s&4?2:0;return f}},special:{load:{noBubble:true},click:{trigger:function(){if(m.nodeName(this,"input")&&this.type==="checkbox"&&this.click){this.click();return false}}},focus:{trigger:function(){if(this!==I.activeElement&&this.focus)try{this.focus();return false}catch(f){}},delegateType:"focusin"},
blur:{trigger:function(){if(this===I.activeElement&&this.blur){this.blur();return false}},delegateType:"focusout"},beforeunload:{postDispatch:function(f){if(f.result!==b)f.originalEvent.returnValue=f.result}}},simulate:function(f,h,n,o){f=m.extend(new m.Event,n,{type:f,isSimulated:true,originalEvent:{}});o?m.event.trigger(f,null,h):m.event.dispatch.call(h,f);f.isDefaultPrevented()&&n.preventDefault()}};m.removeEvent=I.removeEventListener?function(f,h,n){f.removeEventListener&&f.removeEventListener(h,
n,false)}:function(f,h,n){h="on"+h;if(f.detachEvent){if(typeof f[h]===sa)f[h]=null;f.detachEvent(h,n)}};m.Event=function(f,h){if(!(this instanceof m.Event))return new m.Event(f,h);if(f&&f.type){this.originalEvent=f;this.type=f.type;this.isDefaultPrevented=f.defaultPrevented||f.returnValue===false||f.getPreventDefault&&f.getPreventDefault()?t:v}else this.type=f;h&&m.extend(this,h);this.timeStamp=f&&f.timeStamp||m.now();this[m.expando]=true};m.Event.prototype={isDefaultPrevented:v,isPropagationStopped:v,
isImmediatePropagationStopped:v,preventDefault:function(){var f=this.originalEvent;this.isDefaultPrevented=t;if(f)if(f.preventDefault)f.preventDefault();else f.returnValue=false},stopPropagation:function(){var f=this.originalEvent;this.isPropagationStopped=t;if(f){f.stopPropagation&&f.stopPropagation();f.cancelBubble=true}},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=t;this.stopPropagation()}};m.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(f,h){m.event.special[f]=
{delegateType:h,bindType:h,handle:function(n){var o,s=n.relatedTarget,y=n.handleObj;if(!s||s!==this&&!m.contains(this,s)){n.type=y.origType;o=y.handler.apply(this,arguments);n.type=h}return o}}});if(!m.support.submitBubbles)m.event.special.submit={setup:function(){if(m.nodeName(this,"form"))return false;m.event.add(this,"click._submit keypress._submit",function(f){f=f.target;if((f=m.nodeName(f,"input")||m.nodeName(f,"button")?f.form:b)&&!m._data(f,"submitBubbles")){m.event.add(f,"submit._submit",
function(h){h._submit_bubble=true});m._data(f,"submitBubbles",true)}})},postDispatch:function(f){if(f._submit_bubble){delete f._submit_bubble;this.parentNode&&!f.isTrigger&&m.event.simulate("submit",this.parentNode,f,true)}},teardown:function(){if(m.nodeName(this,"form"))return false;m.event.remove(this,"._submit")}};if(!m.support.changeBubbles)m.event.special.change={setup:function(){if(jc.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){m.event.add(this,"propertychange._change",
function(f){if(f.originalEvent.propertyName==="checked")this._just_changed=true});m.event.add(this,"click._change",function(f){if(this._just_changed&&!f.isTrigger)this._just_changed=false;m.event.simulate("change",this,f,true)})}return false}m.event.add(this,"beforeactivate._change",function(f){f=f.target;if(jc.test(f.nodeName)&&!m._data(f,"changeBubbles")){m.event.add(f,"change._change",function(h){this.parentNode&&!h.isSimulated&&!h.isTrigger&&m.event.simulate("change",this.parentNode,h,true)});
m._data(f,"changeBubbles",true)}})},handle:function(f){var h=f.target;if(this!==h||f.isSimulated||f.isTrigger||h.type!=="radio"&&h.type!=="checkbox")return f.handleObj.handler.apply(this,arguments)},teardown:function(){m.event.remove(this,"._change");return!jc.test(this.nodeName)}};m.support.focusinBubbles||m.each({focus:"focusin",blur:"focusout"},function(f,h){var n=0,o=function(s){m.event.simulate(h,s.target,m.event.fix(s),true)};m.event.special[h]={setup:function(){n++===0&&I.addEventListener(f,
o,true)},teardown:function(){--n===0&&I.removeEventListener(f,o,true)}}});m.fn.extend({on:function(f,h,n,o,s){var y,C;if(typeof f==="object"){if(typeof h!=="string"){n=n||h;h=b}for(y in f)this.on(y,h,n,f[y],s);return this}if(n==null&&o==null){o=h;n=h=b}else if(o==null)if(typeof h==="string"){o=n;n=b}else{o=n;n=h;h=b}if(o===false)o=v;else if(!o)return this;if(s===1){C=o;o=function(K){m().off(K);return C.apply(this,arguments)};o.guid=C.guid||(C.guid=m.guid++)}return this.each(function(){m.event.add(this,
f,o,n,h)})},one:function(f,h,n,o){return this.on(f,h,n,o,1)},off:function(f,h,n){var o;if(f&&f.preventDefault&&f.handleObj){o=f.handleObj;m(f.delegateTarget).off(o.namespace?o.origType+"."+o.namespace:o.origType,o.selector,o.handler);return this}if(typeof f==="object"){for(o in f)this.off(o,h,f[o]);return this}if(h===false||typeof h==="function"){n=h;h=b}if(n===false)n=v;return this.each(function(){m.event.remove(this,f,n,h)})},bind:function(f,h,n){return this.on(f,null,h,n)},unbind:function(f,h){return this.off(f,
null,h)},delegate:function(f,h,n,o){return this.on(h,f,n,o)},undelegate:function(f,h,n){return arguments.length===1?this.off(f,"**"):this.off(h,f||"**",n)},trigger:function(f,h){return this.each(function(){m.event.trigger(f,h,this)})},triggerHandler:function(f,h){var n=this[0];if(n)return m.event.trigger(f,h,n,true)}});(function(f,h){function n(F){return md.test(F+"")}function o(){var F,R=[];return F=function(L,Z){if(R.push(L+=" ")>Da.cacheLength)delete F[R.shift()];return F[L]=Z}}function s(F){F[Sa]=
true;return F}function y(F){var R=db.createElement("div");try{return F(R)}catch(L){return false}finally{}}function C(F,R,L,Z){var ma,wa,na,Aa,xa;if((R?R.ownerDocument||R:Eb)!==db)$a(R);R=R||db;L=L||[];if(!F||typeof F!=="string")return L;if((Aa=R.nodeType)!==1&&Aa!==9)return[];if(!nb&&!Z){if(ma=nd.exec(F))if(na=ma[1])if(Aa===9)if((wa=R.getElementById(na))&&wa.parentNode){if(wa.id===na){L.push(wa);return L}}else return L;else{if(R.ownerDocument&&(wa=R.ownerDocument.getElementById(na))&&Wb(R,wa)&&wa.id===
na){L.push(wa);return L}}else if(ma[2]){Ob.apply(L,Pb.call(R.getElementsByTagName(F),0));return L}else if((na=ma[3])&&Ya.getByClassName&&R.getElementsByClassName){Ob.apply(L,Pb.call(R.getElementsByClassName(na),0));return L}if(Ya.qsa&&!ob.test(F)){ma=true;wa=Sa;na=R;xa=Aa===9&&F;if(Aa===1&&R.nodeName.toLowerCase()!=="object"){Aa=pa(F);if(ma=R.getAttribute("id"))wa=ma.replace(od,"\\$&");else R.setAttribute("id",wa);wa="[id='"+wa+"'] ";for(na=Aa.length;na--;)Aa[na]=wa+ya(Aa[na]);na=kc.test(F)&&R.parentNode||
R;xa=Aa.join(",")}if(xa)try{Ob.apply(L,Pb.call(na.querySelectorAll(xa),0));return L}catch(Ma){}finally{ma||R.removeAttribute("id")}}}return Ia(F.replace($b,"$1"),R,L,Z)}function K(F,R){var L=R&&F,Z=L&&(~R.sourceIndex||Ec)-(~F.sourceIndex||Ec);if(Z)return Z;if(L)for(;L=L.nextSibling;)if(L===R)return-1;return F?1:-1}function S(F){return function(R){return R.nodeName.toLowerCase()==="input"&&R.type===F}}function ka(F){return function(R){var L=R.nodeName.toLowerCase();return(L==="input"||L==="button")&&
R.type===F}}function ba(F){return s(function(R){R=+R;return s(function(L,Z){for(var ma,wa=F([],L.length,R),na=wa.length;na--;)if(L[ma=wa[na]])L[ma]=!(Z[ma]=L[ma])})})}function pa(F,R){var L,Z,ma,wa,na,Aa,xa;if(na=Fc[F+" "])return R?0:na.slice(0);na=F;Aa=[];for(xa=Da.preFilter;na;){if(!L||(Z=pd.exec(na))){if(Z)na=na.slice(Z[0].length)||na;Aa.push(ma=[])}L=false;if(Z=qd.exec(na)){L=Z.shift();ma.push({value:L,type:Z[0].replace($b," ")});na=na.slice(L.length)}for(wa in Da.filter)if((Z=ac[wa].exec(na))&&
(!xa[wa]||(Z=xa[wa](Z)))){L=Z.shift();ma.push({value:L,type:wa,matches:Z});na=na.slice(L.length)}if(!L)break}return R?na.length:na?C.error(F):Fc(F,Aa).slice(0)}function ya(F){for(var R=0,L=F.length,Z="";R<L;R++)Z+=F[R].value;return Z}function Ca(F,R,L){var Z=R.dir,ma=L&&Z==="parentNode",wa=rd++;return R.first?function(na,Aa,xa){for(;na=na[Z];)if(na.nodeType===1||ma)return F(na,Aa,xa)}:function(na,Aa,xa){var Ma,Ea,Na,Ka=rb+" "+wa;if(xa)for(;na=na[Z];){if(na.nodeType===1||ma)if(F(na,Aa,xa))return true}else for(;na=
na[Z];)if(na.nodeType===1||ma){Na=na[Sa]||(na[Sa]={});if((Ea=Na[Z])&&Ea[0]===Ka){if((Ma=Ea[1])===true||Ma===Xa)return Ma===true}else{Ea=Na[Z]=[Ka];Ea[1]=F(na,Aa,xa)||Xa;if(Ea[1]===true)return true}}}}function Qa(F){return F.length>1?function(R,L,Z){for(var ma=F.length;ma--;)if(!F[ma](R,L,Z))return false;return true}:F[0]}function Wa(F,R,L,Z,ma){for(var wa,na=[],Aa=0,xa=F.length,Ma=R!=null;Aa<xa;Aa++)if(wa=F[Aa])if(!L||L(wa,Z,ma)){na.push(wa);Ma&&R.push(Aa)}return na}function ib(F,R,L,Z,ma,wa){if(Z&&
!Z[Sa])Z=ib(Z);if(ma&&!ma[Sa])ma=ib(ma,wa);return s(function(na,Aa,xa,Ma){var Ea,Na,Ka=[],Ra=[],ab=Aa.length,Ta=na||bc(R||"*",xa.nodeType?[xa]:xa,[]);Ta=F&&(na||!R)?Wa(Ta,Ka,F,xa,Ma):Ta;var Oa=L?ma||(na?F:ab||Z)?[]:Aa:Ta;L&&L(Ta,Oa,xa,Ma);if(Z){Ea=Wa(Oa,Ra);Z(Ea,[],xa,Ma);for(xa=Ea.length;xa--;)if(Na=Ea[xa])Oa[Ra[xa]]=!(Ta[Ra[xa]]=Na)}if(na){if(ma||F){if(ma){Ea=[];for(xa=Oa.length;xa--;)if(Na=Oa[xa])Ea.push(Ta[xa]=Na);ma(null,Oa=[],Ea,Ma)}for(xa=Oa.length;xa--;)if((Na=Oa[xa])&&(Ea=ma?lc.call(na,Na):
Ka[xa])>-1)na[Ea]=!(Aa[Ea]=Na)}}else{Oa=Wa(Oa===Aa?Oa.splice(ab,Oa.length):Oa);ma?ma(null,Aa,Oa,Ma):Ob.apply(Aa,Oa)}})}function Qb(F){var R,L,Z,ma=F.length,wa=Da.relative[F[0].type];L=wa||Da.relative[" "];for(var na=wa?1:0,Aa=Ca(function(Ea){return Ea===R},L,true),xa=Ca(function(Ea){return lc.call(R,Ea)>-1},L,true),Ma=[function(Ea,Na,Ka){return!wa&&(Ka||Na!==Fb)||((R=Na).nodeType?Aa(Ea,Na,Ka):xa(Ea,Na,Ka))}];na<ma;na++)if(L=Da.relative[F[na].type])Ma=[Ca(Qa(Ma),L)];else{L=Da.filter[F[na].type].apply(null,
F[na].matches);if(L[Sa]){for(Z=++na;Z<ma;Z++)if(Da.relative[F[Z].type])break;return ib(na>1&&Qa(Ma),na>1&&ya(F.slice(0,na-1)).replace($b,"$1"),L,na<Z&&Qb(F.slice(na,Z)),Z<ma&&Qb(F=F.slice(Z)),Z<ma&&ya(F))}Ma.push(L)}return Qa(Ma)}function eb(F,R){var L=0,Z=R.length>0,ma=F.length>0,wa=function(na,Aa,xa,Ma,Ea){var Na,Ka,Ra=[],ab=0,Ta="0",Oa=na&&[],Gb=Ea!=null,Gc=Fb,sd=na||ma&&Da.find.TAG("*",Ea&&Aa.parentNode||Aa),Hc=rb+=Gc==null?1:Math.random()||0.1;if(Gb){Fb=Aa!==db&&Aa;Xa=L}for(;(Ea=sd[Ta])!=null;Ta++){if(ma&&
Ea){for(Na=0;Ka=F[Na++];)if(Ka(Ea,Aa,xa)){Ma.push(Ea);break}if(Gb){rb=Hc;Xa=++L}}if(Z){if(Ea=!Ka&&Ea)ab--;na&&Oa.push(Ea)}}ab+=Ta;if(Z&&Ta!==ab){for(Na=0;Ka=R[Na++];)Ka(Oa,Ra,Aa,xa);if(na){if(ab>0)for(;Ta--;)Oa[Ta]||Ra[Ta]||(Ra[Ta]=td.call(Ma));Ra=Wa(Ra)}Ob.apply(Ma,Ra);Gb&&!na&&Ra.length>0&&ab+R.length>1&&C.uniqueSort(Ma)}if(Gb){rb=Hc;Fb=Gc}return Oa};return Z?s(wa):wa}function bc(F,R,L){for(var Z=0,ma=R.length;Z<ma;Z++)C(F,R[Z],L);return L}function Ia(F,R,L,Z){var ma,wa,na,Aa,xa=pa(F);if(!Z)if(xa.length===
1){wa=xa[0]=xa[0].slice(0);if(wa.length>2&&(na=wa[0]).type==="ID"&&R.nodeType===9&&!nb&&Da.relative[wa[1].type]){R=Da.find.ID(na.matches[0].replace(xb,yb),R)[0];if(!R)return L;F=F.slice(wa.shift().value.length)}for(ma=ac.needsContext.test(F)?0:wa.length;ma--;){na=wa[ma];if(Da.relative[Aa=na.type])break;if(Aa=Da.find[Aa])if(Z=Aa(na.matches[0].replace(xb,yb),kc.test(wa[0].type)&&R.parentNode||R)){wa.splice(ma,1);F=Z.length&&ya(wa);if(!F){Ob.apply(L,Pb.call(Z,0));return L}break}}}Hb(F,xa)(Z,R,nb,L,kc.test(F));
return L}function Xb(){}var Ja,Xa,Da,Rb,fb,Hb,jb,Fb,$a,db,gb,nb,ob,Sb,cc,Wb,mc,Sa="sizzle"+-new Date,Eb=f.document,Ya={},rb=0,rd=0,Ic=o(),Fc=o(),Jc=o(),sb=typeof h,Ec=-2147483648,Ib=[],td=Ib.pop,Ob=Ib.push,Pb=Ib.slice,lc=Ib.indexOf||function(F){for(var R=0,L=this.length;R<L;R++)if(this[R]===F)return R;return-1};Ib="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w#");var Kc="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)[\\x20\\t\\r\\n\\f]*(?:([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+
Ib+")|)|)[\\x20\\t\\r\\n\\f]*\\]",nc=":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+Kc.replace(3,8)+")*)|.*)\\)|)",$b=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),pd=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,qd=/^[\x20\t\r\n\f]*([\x20\t\r\n\f>+~])[\x20\t\r\n\f]*/,ud=new RegExp(nc),vd=new RegExp("^"+Ib+"$"),ac={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,NAME:/^\[name=['"]?((?:\\.|[\w-]|[^\x00-\xa0])+)['"]?\]/,
TAG:new RegExp("^("+"(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:new RegExp("^"+Kc),PSEUDO:new RegExp("^"+nc),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),needsContext:new RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)",
"i")},kc=/[\x20\t\r\n\f]*[+~]/,md=/^[^{]+\{\s*\[native code/,nd=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,wd=/^(?:input|select|textarea|button)$/i,xd=/^h\d$/i,od=/'|\\/g,yd=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,xb=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,yb=function(F,R){F="0x"+R-65536;return F!==F?R:F<0?String.fromCharCode(F+65536):String.fromCharCode(F>>10|55296,F&1023|56320)};try{Pb.call(Eb.documentElement.childNodes,0)}catch(Wd){Pb=function(F){for(var R,L=[];R=this[F++];)L.push(R);return L}}fb=
C.isXML=function(F){return(F=F&&(F.ownerDocument||F).documentElement)?F.nodeName!=="HTML":false};$a=C.setDocument=function(F){var R=F?F.ownerDocument||F:Eb;if(R===db||R.nodeType!==9||!R.documentElement)return db;db=R;gb=R.documentElement;nb=fb(R);Ya.tagNameNoComments=y(function(L){L.appendChild(R.createComment(""));return!L.getElementsByTagName("*").length});Ya.attributes=y(function(L){L.innerHTML="<select></select>";L=typeof L.lastChild.getAttribute("multiple");return L!=="boolean"&&L!=="string"});
Ya.getByClassName=y(function(L){L.innerHTML="<div class='hidden e'></div><div class='hidden'></div>";if(!L.getElementsByClassName||!L.getElementsByClassName("e").length)return false;L.lastChild.className="e";return L.getElementsByClassName("e").length===2});Ya.getByName=y(function(L){L.id=Sa+0;L.innerHTML="<a name='"+Sa+"'></a><div name='"+Sa+"'></div>";gb.insertBefore(L,gb.firstChild);var Z=R.getElementsByName&&R.getElementsByName(Sa).length===2+R.getElementsByName(Sa+0).length;Ya.getIdNotName=!R.getElementById(Sa);
gb.removeChild(L);return Z});Da.attrHandle=y(function(L){L.innerHTML="<a href='#'></a>";return L.firstChild&&typeof L.firstChild.getAttribute!==sb&&L.firstChild.getAttribute("href")==="#"})?{}:{href:function(L){return L.getAttribute("href",2)},type:function(L){return L.getAttribute("type")}};if(Ya.getIdNotName){Da.find.ID=function(L,Z){if(typeof Z.getElementById!==sb&&!nb)return(L=Z.getElementById(L))&&L.parentNode?[L]:[]};Da.filter.ID=function(L){var Z=L.replace(xb,yb);return function(ma){return ma.getAttribute("id")===
Z}}}else{Da.find.ID=function(L,Z){if(typeof Z.getElementById!==sb&&!nb)return(Z=Z.getElementById(L))?Z.id===L||typeof Z.getAttributeNode!==sb&&Z.getAttributeNode("id").value===L?[Z]:h:[]};Da.filter.ID=function(L){var Z=L.replace(xb,yb);return function(ma){return(ma=typeof ma.getAttributeNode!==sb&&ma.getAttributeNode("id"))&&ma.value===Z}}}Da.find.TAG=Ya.tagNameNoComments?function(L,Z){if(typeof Z.getElementsByTagName!==sb)return Z.getElementsByTagName(L)}:function(L,Z){var ma=[],wa=0;Z=Z.getElementsByTagName(L);
if(L==="*"){for(;L=Z[wa++];)L.nodeType===1&&ma.push(L);return ma}return Z};Da.find.NAME=Ya.getByName&&function(L,Z){if(typeof Z.getElementsByName!==sb)return Z.getElementsByName(name)};Da.find.CLASS=Ya.getByClassName&&function(L,Z){if(typeof Z.getElementsByClassName!==sb&&!nb)return Z.getElementsByClassName(L)};Sb=[];ob=[":focus"];if(Ya.qsa=n(R.querySelectorAll)){y(function(L){L.innerHTML="<select><option selected=''></option></select>";L.querySelectorAll("[selected]").length||ob.push("\\[[\\x20\\t\\r\\n\\f]*(?:checked|disabled|ismap|multiple|readonly|selected|value)");
L.querySelectorAll(":checked").length||ob.push(":checked")});y(function(L){L.innerHTML="<input type='hidden' i=''/>";L.querySelectorAll("[i^='']").length&&ob.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:\"\"|'')");L.querySelectorAll(":enabled").length||ob.push(":enabled",":disabled");L.querySelectorAll("*,:x");ob.push(",.*:")})}if(Ya.matchesSelector=n(cc=gb.matchesSelector||gb.mozMatchesSelector||gb.webkitMatchesSelector||gb.oMatchesSelector||gb.msMatchesSelector))y(function(L){Ya.disconnectedMatch=cc.call(L,
"div");cc.call(L,"[s!='']:x");Sb.push("!=",nc)});ob=new RegExp(ob.join("|"));Sb=new RegExp(Sb.join("|"));Wb=n(gb.contains)||gb.compareDocumentPosition?function(L,Z){var ma=L.nodeType===9?L.documentElement:L;Z=Z&&Z.parentNode;return L===Z||!!(Z&&Z.nodeType===1&&(ma.contains?ma.contains(Z):L.compareDocumentPosition&&L.compareDocumentPosition(Z)&16))}:function(L,Z){if(Z)for(;Z=Z.parentNode;)if(Z===L)return true;return false};mc=gb.compareDocumentPosition?function(L,Z){var ma;if(L===Z){jb=true;return 0}if(ma=
Z.compareDocumentPosition&&L.compareDocumentPosition&&L.compareDocumentPosition(Z)){if(ma&1||L.parentNode&&L.parentNode.nodeType===11){if(L===R||Wb(Eb,L))return-1;if(Z===R||Wb(Eb,Z))return 1;return 0}return ma&4?-1:1}return L.compareDocumentPosition?-1:1}:function(L,Z){var ma=0,wa=L.parentNode,na=Z.parentNode,Aa=[L],xa=[Z];if(L===Z){jb=true;return 0}else if(!wa||!na)return L===R?-1:Z===R?1:wa?-1:na?1:0;else if(wa===na)return K(L,Z);for(L=L;L=L.parentNode;)Aa.unshift(L);for(L=Z;L=L.parentNode;)xa.unshift(L);
for(;Aa[ma]===xa[ma];)ma++;return ma?K(Aa[ma],xa[ma]):Aa[ma]===Eb?-1:xa[ma]===Eb?1:0};jb=false;[0,0].sort(mc);Ya.detectDuplicates=jb;return db};C.matches=function(F,R){return C(F,null,null,R)};C.matchesSelector=function(F,R){if((F.ownerDocument||F)!==db)$a(F);R=R.replace(yd,"='$1']");if(Ya.matchesSelector&&!nb&&(!Sb||!Sb.test(R))&&!ob.test(R))try{var L=cc.call(F,R);if(L||Ya.disconnectedMatch||F.document&&F.document.nodeType!==11)return L}catch(Z){}return C(R,db,null,[F]).length>0};C.contains=function(F,
R){if((F.ownerDocument||F)!==db)$a(F);return Wb(F,R)};C.attr=function(F,R){var L;if((F.ownerDocument||F)!==db)$a(F);nb||(R=R.toLowerCase());if(L=Da.attrHandle[R])return L(F);if(nb||Ya.attributes)return F.getAttribute(R);return((L=F.getAttributeNode(R))||F.getAttribute(R))&&F[R]===true?R:L&&L.specified?L.value:null};C.error=function(F){throw new Error("Syntax error, unrecognized expression: "+F);};C.uniqueSort=function(F){var R,L=[],Z=1,ma=0;jb=!Ya.detectDuplicates;F.sort(mc);if(jb){for(;R=F[Z];Z++)if(R===
F[Z-1])ma=L.push(Z);for(;ma--;)F.splice(L[ma],1)}return F};Rb=C.getText=function(F){var R,L="",Z=0;if(R=F.nodeType)if(R===1||R===9||R===11)if(typeof F.textContent==="string")return F.textContent;else for(F=F.firstChild;F;F=F.nextSibling)L+=Rb(F);else{if(R===3||R===4)return F.nodeValue}else for(;R=F[Z];Z++)L+=Rb(R);return L};Da=C.selectors={cacheLength:50,createPseudo:s,match:ac,find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},
preFilter:{ATTR:function(F){F[1]=F[1].replace(xb,yb);F[3]=(F[4]||F[5]||"").replace(xb,yb);if(F[2]==="~=")F[3]=" "+F[3]+" ";return F.slice(0,4)},CHILD:function(F){F[1]=F[1].toLowerCase();if(F[1].slice(0,3)==="nth"){F[3]||C.error(F[0]);F[4]=+(F[4]?F[5]+(F[6]||1):2*(F[3]==="even"||F[3]==="odd"));F[5]=+(F[7]+F[8]||F[3]==="odd")}else F[3]&&C.error(F[0]);return F},PSEUDO:function(F){var R,L=!F[5]&&F[2];if(ac.CHILD.test(F[0]))return null;if(F[4])F[2]=F[4];else if(L&&ud.test(L)&&(R=pa(L,true))&&(R=L.indexOf(")",
L.length-R)-L.length)){F[0]=F[0].slice(0,R);F[2]=L.slice(0,R)}return F.slice(0,3)}},filter:{TAG:function(F){if(F==="*")return function(){return true};F=F.replace(xb,yb).toLowerCase();return function(R){return R.nodeName&&R.nodeName.toLowerCase()===F}},CLASS:function(F){var R=Ic[F+" "];return R||(R=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+F+"([\\x20\\t\\r\\n\\f]|$)"))&&Ic(F,function(L){return R.test(L.className||typeof L.getAttribute!==sb&&L.getAttribute("class")||"")})},ATTR:function(F,R,L){return function(Z){Z=
C.attr(Z,F);if(Z==null)return R==="!=";if(!R)return true;Z+="";return R==="="?Z===L:R==="!="?Z!==L:R==="^="?L&&Z.indexOf(L)===0:R==="*="?L&&Z.indexOf(L)>-1:R==="$="?L&&Z.slice(-L.length)===L:R==="~="?(" "+Z+" ").indexOf(L)>-1:R==="|="?Z===L||Z.slice(0,L.length+1)===L+"-":false}},CHILD:function(F,R,L,Z,ma){var wa=F.slice(0,3)!=="nth",na=F.slice(-4)!=="last",Aa=R==="of-type";return Z===1&&ma===0?function(xa){return!!xa.parentNode}:function(xa,Ma,Ea){var Na,Ka,Ra,ab,Ta;Ma=wa!==na?"nextSibling":"previousSibling";
var Oa=xa.parentNode,Gb=Aa&&xa.nodeName.toLowerCase();Ea=!Ea&&!Aa;if(Oa){if(wa){for(;Ma;){for(Ka=xa;Ka=Ka[Ma];)if(Aa?Ka.nodeName.toLowerCase()===Gb:Ka.nodeType===1)return false;Ta=Ma=F==="only"&&!Ta&&"nextSibling"}return true}Ta=[na?Oa.firstChild:Oa.lastChild];if(na&&Ea){Ea=Oa[Sa]||(Oa[Sa]={});Na=Ea[F]||[];ab=Na[0]===rb&&Na[1];Ra=Na[0]===rb&&Na[2];for(Ka=ab&&Oa.childNodes[ab];Ka=++ab&&Ka&&Ka[Ma]||(Ra=ab=0)||Ta.pop();)if(Ka.nodeType===1&&++Ra&&Ka===xa){Ea[F]=[rb,ab,Ra];break}}else if(Ea&&(Na=(xa[Sa]||
(xa[Sa]={}))[F])&&Na[0]===rb)Ra=Na[1];else for(;Ka=++ab&&Ka&&Ka[Ma]||(Ra=ab=0)||Ta.pop();)if((Aa?Ka.nodeName.toLowerCase()===Gb:Ka.nodeType===1)&&++Ra){if(Ea)(Ka[Sa]||(Ka[Sa]={}))[F]=[rb,Ra];if(Ka===xa)break}Ra-=ma;return Ra===Z||Ra%Z===0&&Ra/Z>=0}}},PSEUDO:function(F,R){var L,Z=Da.pseudos[F]||Da.setFilters[F.toLowerCase()]||C.error("unsupported pseudo: "+F);if(Z[Sa])return Z(R);if(Z.length>1){L=[F,F,"",R];return Da.setFilters.hasOwnProperty(F.toLowerCase())?s(function(ma,wa){for(var na,Aa=Z(ma,R),
xa=Aa.length;xa--;){na=lc.call(ma,Aa[xa]);ma[na]=!(wa[na]=Aa[xa])}}):function(ma){return Z(ma,0,L)}}return Z}},pseudos:{not:s(function(F){var R=[],L=[],Z=Hb(F.replace($b,"$1"));return Z[Sa]?s(function(ma,wa,na,Aa){Aa=Z(ma,null,Aa,[]);for(var xa=ma.length;xa--;)if(na=Aa[xa])ma[xa]=!(wa[xa]=na)}):function(ma,wa,na){R[0]=ma;Z(R,null,na,L);return!L.pop()}}),has:s(function(F){return function(R){return C(F,R).length>0}}),contains:s(function(F){return function(R){return(R.textContent||R.innerText||Rb(R)).indexOf(F)>
-1}}),lang:s(function(F){vd.test(F||"")||C.error("unsupported lang: "+F);F=F.replace(xb,yb).toLowerCase();return function(R){var L;do if(L=nb?R.getAttribute("xml:lang")||R.getAttribute("lang"):R.lang){L=L.toLowerCase();return L===F||L.indexOf(F+"-")===0}while((R=R.parentNode)&&R.nodeType===1);return false}}),target:function(F){var R=f.location&&f.location.hash;return R&&R.slice(1)===F.id},root:function(F){return F===gb},focus:function(F){return F===db.activeElement&&(!db.hasFocus||db.hasFocus())&&
!!(F.type||F.href||~F.tabIndex)},enabled:function(F){return F.disabled===false},disabled:function(F){return F.disabled===true},checked:function(F){var R=F.nodeName.toLowerCase();return R==="input"&&!!F.checked||R==="option"&&!!F.selected},selected:function(F){return F.selected===true},empty:function(F){for(F=F.firstChild;F;F=F.nextSibling)if(F.nodeName>"@"||F.nodeType===3||F.nodeType===4)return false;return true},parent:function(F){return!Da.pseudos.empty(F)},header:function(F){return xd.test(F.nodeName)},
input:function(F){return wd.test(F.nodeName)},button:function(F){var R=F.nodeName.toLowerCase();return R==="input"&&F.type==="button"||R==="button"},text:function(F){var R;return F.nodeName.toLowerCase()==="input"&&F.type==="text"&&((R=F.getAttribute("type"))==null||R.toLowerCase()===F.type)},first:ba(function(){return[0]}),last:ba(function(F,R){return[R-1]}),eq:ba(function(F,R,L){return[L<0?L+R:L]}),even:ba(function(F,R){for(var L=0;L<R;L+=2)F.push(L);return F}),odd:ba(function(F,R){for(var L=1;L<
R;L+=2)F.push(L);return F}),lt:ba(function(F,R,L){for(R=L<0?L+R:L;--R>=0;)F.push(R);return F}),gt:ba(function(F,R,L){for(L=L<0?L+R:L;++L<R;)F.push(L);return F})}};for(Ja in{radio:true,checkbox:true,file:true,password:true,image:true})Da.pseudos[Ja]=S(Ja);for(Ja in{submit:true,reset:true})Da.pseudos[Ja]=ka(Ja);Hb=C.compile=function(F,R){var L,Z=[],ma=[],wa=Jc[F+" "];if(!wa){R||(R=pa(F));for(L=R.length;L--;){wa=Qb(R[L]);wa[Sa]?Z.push(wa):ma.push(wa)}wa=Jc(F,eb(ma,Z))}return wa};Da.pseudos.nth=Da.pseudos.eq;
Da.filters=Xb.prototype=Da.pseudos;Da.setFilters=new Xb;$a();C.attr=m.attr;m.find=C;m.expr=C.selectors;m.expr[":"]=m.expr.pseudos;m.unique=C.uniqueSort;m.text=C.getText;m.isXMLDoc=C.isXML;m.contains=C.contains})(a);var zd=/Until$/,Ad=/^(?:parents|prev(?:Until|All))/,bd=/^.[^:#\[\.,]*$/,Lc=m.expr.match.needsContext,Bd={children:true,contents:true,next:true,prev:true};m.fn.extend({find:function(f){var h,n,o,s=this.length;if(typeof f!=="string"){o=this;return this.pushStack(m(f).filter(function(){for(h=
0;h<s;h++)if(m.contains(o[h],this))return true}))}n=[];for(h=0;h<s;h++)m.find(f,this[h],n);n=this.pushStack(s>1?m.unique(n):n);n.selector=(this.selector?this.selector+" ":"")+f;return n},has:function(f){var h,n=m(f,this),o=n.length;return this.filter(function(){for(h=0;h<o;h++)if(m.contains(this,n[h]))return true})},not:function(f){return this.pushStack(q(this,f,false))},filter:function(f){return this.pushStack(q(this,f,true))},is:function(f){return!!f&&(typeof f==="string"?Lc.test(f)?m(f,this.context).index(this[0])>=
0:m.filter(f,this).length>0:this.filter(f).length>0)},closest:function(f,h){for(var n,o=0,s=this.length,y=[],C=Lc.test(f)||typeof f!=="string"?m(f,h||this.context):0;o<s;o++)for(n=this[o];n&&n.ownerDocument&&n!==h&&n.nodeType!==11;){if(C?C.index(n)>-1:m.find.matchesSelector(n,f)){y.push(n);break}n=n.parentNode}return this.pushStack(y.length>1?m.unique(y):y)},index:function(f){if(!f)return this[0]&&this[0].parentNode?this.first().prevAll().length:-1;if(typeof f==="string")return m.inArray(this[0],
m(f));return m.inArray(f.jquery?f[0]:f,this)},add:function(f,h){f=typeof f==="string"?m(f,h):m.makeArray(f&&f.nodeType?[f]:f);f=m.merge(this.get(),f);return this.pushStack(m.unique(f))},addBack:function(f){return this.add(f==null?this.prevObject:this.prevObject.filter(f))}});m.fn.andSelf=m.fn.addBack;m.each({parent:function(f){return(f=f.parentNode)&&f.nodeType!==11?f:null},parents:function(f){return m.dir(f,"parentNode")},parentsUntil:function(f,h,n){return m.dir(f,"parentNode",n)},next:function(f){return G(f,
"nextSibling")},prev:function(f){return G(f,"previousSibling")},nextAll:function(f){return m.dir(f,"nextSibling")},prevAll:function(f){return m.dir(f,"previousSibling")},nextUntil:function(f,h,n){return m.dir(f,"nextSibling",n)},prevUntil:function(f,h,n){return m.dir(f,"previousSibling",n)},siblings:function(f){return m.sibling((f.parentNode||{}).firstChild,f)},children:function(f){return m.sibling(f.firstChild)},contents:function(f){return m.nodeName(f,"iframe")?f.contentDocument||f.contentWindow.document:
m.merge([],f.childNodes)}},function(f,h){m.fn[f]=function(n,o){var s=m.map(this,h,n);zd.test(f)||(o=n);if(o&&typeof o==="string")s=m.filter(o,s);s=this.length>1&&!Bd[f]?m.unique(s):s;if(this.length>1&&Ad.test(f))s=s.reverse();return this.pushStack(s)}});m.extend({filter:function(f,h,n){if(n)f=":not("+f+")";return h.length===1?m.find.matchesSelector(h[0],f)?[h[0]]:[]:m.find.matches(f,h)},dir:function(f,h,n){var o=[];for(f=f[h];f&&f.nodeType!==9&&(n===b||f.nodeType!==1||!m(f).is(n));){f.nodeType===
1&&o.push(f);f=f[h]}return o},sibling:function(f,h){for(var n=[];f;f=f.nextSibling)f.nodeType===1&&f!==h&&n.push(f);return n}});var wc="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Cd=/ jQuery\d+="(?:null|\d+)"/g,Mc=new RegExp("<(?:"+wc+")[\\s/>]","i"),oc=/^\s+/,Nc=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Oc=/<([\w:]+)/,Pc=/<tbody/i,Dd=/<|&#?\w+;/,Ed=/<(?:script|style|link)/i,
ec=/^(?:checkbox|radio)$/i,Fd=/checked\s*(?:[^=]|=\s*.checked.)/i,Qc=/^$|\/(?:java|ecma)script/i,cd=/^true\/(.*)/,Gd=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,kb={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],
_default:m.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},pc=D(I).appendChild(I.createElement("div"));kb.optgroup=kb.option;kb.tbody=kb.tfoot=kb.colgroup=kb.caption=kb.thead;kb.th=kb.td;m.fn.extend({text:function(f){return m.access(this,function(h){return h===b?m.text(this):this.empty().append((this[0]&&this[0].ownerDocument||I).createTextNode(h))},null,f,arguments.length)},wrapAll:function(f){if(m.isFunction(f))return this.each(function(n){m(this).wrapAll(f.call(this,n))});if(this[0]){var h=
m(f,this[0].ownerDocument).eq(0).clone(true);this[0].parentNode&&h.insertBefore(this[0]);h.map(function(){for(var n=this;n.firstChild&&n.firstChild.nodeType===1;)n=n.firstChild;return n}).append(this)}return this},wrapInner:function(f){if(m.isFunction(f))return this.each(function(h){m(this).wrapInner(f.call(this,h))});return this.each(function(){var h=m(this),n=h.contents();n.length?n.wrapAll(f):h.append(f)})},wrap:function(f){var h=m.isFunction(f);return this.each(function(n){m(this).wrapAll(h?f.call(this,
n):f)})},unwrap:function(){return this.parent().each(function(){m.nodeName(this,"body")||m(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,true,function(f){if(this.nodeType===1||this.nodeType===11||this.nodeType===9)this.appendChild(f)})},prepend:function(){return this.domManip(arguments,true,function(f){if(this.nodeType===1||this.nodeType===11||this.nodeType===9)this.insertBefore(f,this.firstChild)})},before:function(){return this.domManip(arguments,false,
function(f){this.parentNode&&this.parentNode.insertBefore(f,this)})},after:function(){return this.domManip(arguments,false,function(f){this.parentNode&&this.parentNode.insertBefore(f,this.nextSibling)})},remove:function(f,h){for(var n,o=0;(n=this[o])!=null;o++)if(!f||m.filter(f,[n]).length>0){!h&&n.nodeType===1&&m.cleanData(w(n));if(n.parentNode){h&&m.contains(n.ownerDocument,n)&&Q(w(n,"script"));n.parentNode.removeChild(n)}}return this},empty:function(){for(var f,h=0;(f=this[h])!=null;h++){for(f.nodeType===
1&&m.cleanData(w(f,false));f.firstChild;)f.removeChild(f.firstChild);if(f.options&&m.nodeName(f,"select"))f.options.length=0}return this},clone:function(f,h){f=f==null?false:f;h=h==null?f:h;return this.map(function(){return m.clone(this,f,h)})},html:function(f){return m.access(this,function(h){var n=this[0]||{},o=0,s=this.length;if(h===b)return n.nodeType===1?n.innerHTML.replace(Cd,""):b;if(typeof h==="string"&&!Ed.test(h)&&(m.support.htmlSerialize||!Mc.test(h))&&(m.support.leadingWhitespace||!oc.test(h))&&
!kb[(Oc.exec(h)||["",""])[1].toLowerCase()]){h=h.replace(Nc,"<$1></$2>");try{for(;o<s;o++){n=this[o]||{};if(n.nodeType===1){m.cleanData(w(n,false));n.innerHTML=h}}n=0}catch(y){}}n&&this.empty().append(h)},null,f,arguments.length)},replaceWith:function(f){if(!m.isFunction(f)&&typeof f!=="string")f=m(f).not(this).detach();return this.domManip([f],true,function(h){var n=this.nextSibling,o=this.parentNode;if(o){m(this).remove();o.insertBefore(h,n)}})},detach:function(f){return this.remove(f,true)},domManip:function(f,
h,n){f=cb.apply([],f);var o,s,y,C,K=0,S=this.length,ka=this,ba=S-1,pa=f[0],ya=m.isFunction(pa);if(ya||!(S<=1||typeof pa!=="string"||m.support.checkClone||!Fd.test(pa)))return this.each(function(Ca){var Qa=ka.eq(Ca);if(ya)f[0]=pa.call(this,Ca,h?Qa.html():b);Qa.domManip(f,h,n)});if(S){C=m.buildFragment(f,this[0].ownerDocument,false,this);o=C.firstChild;if(C.childNodes.length===1)C=o;if(o){h=h&&m.nodeName(o,"tr");y=m.map(w(C,"script"),M);for(s=y.length;K<S;K++){o=C;if(K!==ba){o=m.clone(o,true,true);
s&&m.merge(y,w(o,"script"))}n.call(h&&m.nodeName(this[K],"table")?J(this[K],"tbody"):this[K],o,K)}if(s){C=y[y.length-1].ownerDocument;m.map(y,A);for(K=0;K<s;K++){o=y[K];if(Qc.test(o.type||"")&&!m._data(o,"globalEval")&&m.contains(C,o))o.src?m.ajax({url:o.src,type:"GET",dataType:"script",async:false,global:false,"throws":true}):m.globalEval((o.text||o.textContent||o.innerHTML||"").replace(Gd,""))}}C=o=null}}return this}});m.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",
replaceAll:"replaceWith"},function(f,h){m.fn[f]=function(n){for(var o=0,s=[],y=m(n),C=y.length-1;o<=C;o++){n=o===C?this:this.clone(true);m(y[o])[h](n);bb.apply(s,n.get())}return this.pushStack(s)}});m.extend({clone:function(f,h,n){var o,s,y,C,K,S=m.contains(f.ownerDocument,f);if(m.support.html5Clone||m.isXMLDoc(f)||!Mc.test("<"+f.nodeName+">"))y=f.cloneNode(true);else{pc.innerHTML=f.outerHTML;pc.removeChild(y=pc.firstChild)}if((!m.support.noCloneEvent||!m.support.noCloneChecked)&&(f.nodeType===1||
f.nodeType===11)&&!m.isXMLDoc(f)){o=w(y);K=w(f);for(C=0;(s=K[C])!=null;++C)o[C]&&p(s,o[C])}if(h)if(n){K=K||w(f);o=o||w(y);for(C=0;(s=K[C])!=null;C++)j(s,o[C])}else j(f,y);o=w(y,"script");o.length>0&&Q(o,!S&&w(f,"script"));return y},buildFragment:function(f,h,n,o){for(var s,y,C,K,S,ka,ba=f.length,pa=D(h),ya=[],Ca=0;Ca<ba;Ca++)if((y=f[Ca])||y===0)if(m.type(y)==="object")m.merge(ya,y.nodeType?[y]:y);else if(Dd.test(y)){C=C||pa.appendChild(h.createElement("div"));K=(Oc.exec(y)||["",""])[1].toLowerCase();
ka=kb[K]||kb._default;C.innerHTML=ka[1]+y.replace(Nc,"<$1></$2>")+ka[2];for(s=ka[0];s--;)C=C.lastChild;!m.support.leadingWhitespace&&oc.test(y)&&ya.push(h.createTextNode(oc.exec(y)[0]));if(!m.support.tbody)for(s=(y=K==="table"&&!Pc.test(y)?C.firstChild:ka[1]==="<table>"&&!Pc.test(y)?C:0)&&y.childNodes.length;s--;)if(m.nodeName(S=y.childNodes[s],"tbody")&&!S.childNodes.length)y.removeChild(S);m.merge(ya,C.childNodes);for(C.textContent="";C.firstChild;)C.removeChild(C.firstChild);C=pa.lastChild}else ya.push(h.createTextNode(y));
C&&pa.removeChild(C);m.support.appendChecked||m.grep(w(ya,"input"),B);for(Ca=0;y=ya[Ca++];)if(!(o&&m.inArray(y,o)!==-1)){f=m.contains(y.ownerDocument,y);C=w(pa.appendChild(y),"script");f&&Q(C);if(n)for(s=0;y=C[s++];)if(Qc.test(y.type||""))n.push(y)}return pa},cleanData:function(f,h){for(var n,o,s,y,C=0,K=m.expando,S=m.cache,ka=m.support.deleteExpando,ba=m.event.special;(n=f[C])!=null;C++)if(h||m.acceptData(n))if(y=(s=n[K])&&S[s]){if(y.events)for(o in y.events)ba[o]?m.event.remove(n,o):m.removeEvent(n,
o,y.handle);if(S[s]){delete S[s];if(ka)delete n[K];else if(typeof n.removeAttribute!==sa)n.removeAttribute(K);else n[K]=null;Za.push(s)}}}});var Ub,Bb,Cb,qc=/alpha\([^)]*\)/i,Hd=/opacity\s*=\s*([^)]*)/,Id=/^(top|right|bottom|left)$/,Jd=/^(none|table(?!-c[ea]).+)/,Rc=/^margin/,dd=new RegExp("^("+ub+")(.*)$","i"),Yb=new RegExp("^("+ub+")(?!px)[a-z%]+$","i"),Kd=new RegExp("^([+-])=("+ub+")","i"),yc={BODY:"block"},Ld={position:"absolute",visibility:"hidden",display:"block"},Sc={letterSpacing:0,fontWeight:400},
Ab=["Top","Right","Bottom","Left"],xc=["Webkit","O","Moz","ms"];m.fn.extend({css:function(f,h){return m.access(this,function(n,o,s){var y,C={},K=0;if(m.isArray(o)){y=Bb(n);for(s=o.length;K<s;K++)C[o[K]]=m.css(n,o[K],false,y);return C}return s!==b?m.style(n,o,s):m.css(n,o)},f,h,arguments.length>1)},show:function(){return N(this,true)},hide:function(){return N(this)},toggle:function(f){var h=typeof f==="boolean";return this.each(function(){(h?f:z(this))?m(this).show():m(this).hide()})}});m.extend({cssHooks:{opacity:{get:function(f,
h){if(h){f=Cb(f,"opacity");return f===""?"1":f}}}},cssNumber:{columnCount:true,fillOpacity:true,fontWeight:true,lineHeight:true,opacity:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":m.support.cssFloat?"cssFloat":"styleFloat"},style:function(f,h,n,o){if(!(!f||f.nodeType===3||f.nodeType===8||!f.style)){var s,y,C,K=m.camelCase(h),S=f.style;h=m.cssProps[K]||(m.cssProps[K]=H(S,K));C=m.cssHooks[h]||m.cssHooks[K];if(n!==b){y=typeof n;if(y==="string"&&(s=Kd.exec(n))){n=(s[1]+1)*s[2]+
parseFloat(m.css(f,h));y="number"}if(!(n==null||y==="number"&&isNaN(n))){if(y==="number"&&!m.cssNumber[K])n+="px";if(!m.support.clearCloneStyle&&n===""&&h.indexOf("background")===0)S[h]="inherit";if(!C||!("set"in C)||(n=C.set(f,n,o))!==b)try{S[h]=n}catch(ka){}}}else{if(C&&"get"in C&&(s=C.get(f,false,o))!==b)return s;return S[h]}}},css:function(f,h,n,o){var s,y;y=m.camelCase(h);h=m.cssProps[y]||(m.cssProps[y]=H(f.style,y));if((y=m.cssHooks[h]||m.cssHooks[y])&&"get"in y)s=y.get(f,true,n);if(s===b)s=
Cb(f,h,o);if(s==="normal"&&h in Sc)s=Sc[h];if(n===""||n){f=parseFloat(s);return n===true||m.isNumeric(f)?f||0:s}return s},swap:function(f,h,n,o){var s,y={};for(s in h){y[s]=f.style[s];f.style[s]=h[s]}n=n.apply(f,o||[]);for(s in h)f.style[s]=y[s];return n}});if(a.getComputedStyle){Bb=function(f){return a.getComputedStyle(f,null)};Cb=function(f,h,n){var o;var s=(n=n||Bb(f))?n.getPropertyValue(h)||n[h]:b,y=f.style;if(n){if(s===""&&!m.contains(f.ownerDocument,f))s=m.style(f,h);if(Yb.test(s)&&Rc.test(h)){f=
y.width;h=y.minWidth;o=y.maxWidth;y.minWidth=y.maxWidth=y.width=s;s=n.width;y.width=f;y.minWidth=h;y.maxWidth=o}}return s}}else if(I.documentElement.currentStyle){Bb=function(f){return f.currentStyle};Cb=function(f,h,n){var o,s,y=(n=n||Bb(f))?n[h]:b,C=f.style;if(y==null&&C&&C[h])y=C[h];if(Yb.test(y)&&!Id.test(h)){n=C.left;if(s=(o=f.runtimeStyle)&&o.left)o.left=f.currentStyle.left;C.left=h==="fontSize"?"1em":y;y=C.pixelLeft+"px";C.left=n;if(s)o.left=s}return y===""?"auto":y}}m.each(["height","width"],
function(f,h){m.cssHooks[h]={get:function(n,o,s){if(o)return n.offsetWidth===0&&Jd.test(m.css(n,"display"))?m.swap(n,Ld,function(){return O(n,h,s)}):O(n,h,s)},set:function(n,o,s){var y=s&&Bb(n);return U(n,o,s?E(n,h,s,m.support.boxSizing&&m.css(n,"boxSizing",false,y)==="border-box",y):0)}}});if(!m.support.opacity)m.cssHooks.opacity={get:function(f,h){return Hd.test((h&&f.currentStyle?f.currentStyle.filter:f.style.filter)||"")?0.01*parseFloat(RegExp.$1)+"":h?"1":""},set:function(f,h){var n=f.style;
f=f.currentStyle;var o=m.isNumeric(h)?"alpha(opacity="+h*100+")":"",s=f&&f.filter||n.filter||"";n.zoom=1;if((h>=1||h==="")&&m.trim(s.replace(qc,""))===""&&n.removeAttribute){n.removeAttribute("filter");if(h===""||f&&!f.filter)return}n.filter=qc.test(s)?s.replace(qc,o):s+" "+o}};m(function(){if(!m.support.reliableMarginRight)m.cssHooks.marginRight={get:function(f,h){if(h)return m.swap(f,{display:"inline-block"},Cb,[f,"marginRight"])}};!m.support.pixelPosition&&m.fn.position&&m.each(["top","left"],
function(f,h){m.cssHooks[h]={get:function(n,o){if(o){o=Cb(n,h);return Yb.test(o)?m(n).position()[h]+"px":o}}}})});if(m.expr&&m.expr.filters){m.expr.filters.hidden=function(f){return f.offsetWidth<=0&&f.offsetHeight<=0||!m.support.reliableHiddenOffsets&&(f.style&&f.style.display||m.css(f,"display"))==="none"};m.expr.filters.visible=function(f){return!m.expr.filters.hidden(f)}}m.each({margin:"",padding:"",border:"Width"},function(f,h){m.cssHooks[f+h]={expand:function(n){var o=0,s={};for(n=typeof n===
"string"?n.split(" "):[n];o<4;o++)s[f+Ab[o]+h]=n[o]||n[o-2]||n[0];return s}};if(!Rc.test(f))m.cssHooks[f+h].set=U});var Md=/%20/g,ed=/\[\]$/,Tc=/\r?\n/g,Nd=/^(?:submit|button|image|reset|file)$/i,Od=/^(?:input|select|textarea|keygen)/i;m.fn.extend({serialize:function(){return m.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var f=m.prop(this,"elements");return f?m.makeArray(f):this}).filter(function(){var f=this.type;return this.name&&!m(this).is(":disabled")&&
Od.test(this.nodeName)&&!Nd.test(f)&&(this.checked||!ec.test(f))}).map(function(f,h){f=m(this).val();return f==null?null:m.isArray(f)?m.map(f,function(n){return{name:h.name,value:n.replace(Tc,"\r\n")}}):{name:h.name,value:f.replace(Tc,"\r\n")}}).get()}});m.param=function(f,h){var n,o=[],s=function(y,C){C=m.isFunction(C)?C():C==null?"":C;o[o.length]=encodeURIComponent(y)+"="+encodeURIComponent(C)};if(h===b)h=m.ajaxSettings&&m.ajaxSettings.traditional;if(m.isArray(f)||f.jquery&&!m.isPlainObject(f))m.each(f,
function(){s(this.name,this.value)});else for(n in f)P(n,f[n],h,s);return o.join("&").replace(Md,"+")};m.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(f,h){m.fn[h]=function(n,o){return arguments.length>0?this.on(h,null,n,o):this.trigger(h)}});m.fn.hover=function(f,h){return this.mouseenter(f).mouseleave(h||f)};var Jb,zb,
rc=m.now(),sc=/\?/,Pd=/#.*$/,Uc=/([?&])_=[^&]*/,Qd=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,Rd=/^(?:GET|HEAD)$/,Sd=/^\/\//,Vc=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Wc=m.fn.load,Xc={},fc={},Yc="*/".concat("*");try{zb=X.href}catch(Xd){zb=I.createElement("a");zb.href="";zb=zb.href}Jb=Vc.exec(zb.toLowerCase())||[];m.fn.load=function(f,h,n){if(typeof f!=="string"&&Wc)return Wc.apply(this,arguments);var o,s,y,C=this,K=f.indexOf(" ");if(K>=0){o=f.slice(K,f.length);f=f.slice(0,K)}if(m.isFunction(h)){n=h;h=
b}else if(h&&typeof h==="object")y="POST";C.length>0&&m.ajax({url:f,type:y,dataType:"html",data:h}).done(function(S){s=arguments;C.html(o?m("<div>").append(m.parseHTML(S)).find(o):S)}).complete(n&&function(S,ka){C.each(n,s||[S.responseText,ka,S])});return this};m.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(f,h){m.fn[h]=function(n){return this.on(h,n)}});m.each(["get","post"],function(f,h){m[h]=function(n,o,s,y){if(m.isFunction(o)){y=y||s;s=o;o=b}return m.ajax({url:n,
type:h,dataType:y,data:o,success:s})}});m.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:zb,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Jb[1]),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Yc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",
text:"responseText"},converters:{"* text":a.String,"text html":true,"text json":m.parseJSON,"text xml":m.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(f,h){return h?V(V(f,m.ajaxSettings),h):V(m.ajaxSettings,f)},ajaxPrefilter:ia(Xc),ajaxTransport:ia(fc),ajax:function(f,h){function n(Ja,Xa,Da,Rb){var fb,Hb,jb,Fb,$a=Xa;if(eb!==2){eb=2;C&&clearTimeout(C);S=b;y=Rb||"";Ia.readyState=Ja>0?4:0;if(Da)Fb=ca(ba,Ia,Da);if(Ja>=200&&Ja<300||Ja===304){if(ba.ifModified){if(Da=Ia.getResponseHeader("Last-Modified"))m.lastModified[s]=
Da;if(Da=Ia.getResponseHeader("etag"))m.etag[s]=Da}if(Ja===204){fb=true;$a="nocontent"}else if(Ja===304){fb=true;$a="notmodified"}else{fb=ra(ba,Fb);$a=fb.state;Hb=fb.data;jb=fb.error;fb=!jb}}else{jb=$a;if(Ja||!$a){$a="error";if(Ja<0)Ja=0}}Ia.status=Ja;Ia.statusText=(Xa||$a)+"";fb?Ca.resolveWith(pa,[Hb,$a,Ia]):Ca.rejectWith(pa,[Ia,$a,jb]);Ia.statusCode(Wa);Wa=b;if(K)ya.trigger(fb?"ajaxSuccess":"ajaxError",[Ia,ba,fb?Hb:jb]);Qa.fireWith(pa,[Ia,$a]);if(K){ya.trigger("ajaxComplete",[Ia,ba]);--m.active||
m.event.trigger("ajaxStop")}}}if(typeof f==="object"){h=f;f=b}h=h||{};var o,s,y,C,K,S,ka,ba=m.ajaxSetup({},h),pa=ba.context||ba,ya=ba.context&&(pa.nodeType||pa.jquery)?m(pa):m.event,Ca=m.Deferred(),Qa=m.Callbacks("once memory"),Wa=ba.statusCode||{},ib={},Qb={},eb=0,bc="canceled",Ia={readyState:0,getResponseHeader:function(Ja){var Xa;if(eb===2){if(!ka)for(ka={};Xa=Qd.exec(y);)ka[Xa[1].toLowerCase()]=Xa[2];Xa=ka[Ja.toLowerCase()]}return Xa==null?null:Xa},getAllResponseHeaders:function(){return eb===
2?y:null},setRequestHeader:function(Ja,Xa){var Da=Ja.toLowerCase();if(!eb){Ja=Qb[Da]=Qb[Da]||Ja;ib[Ja]=Xa}return this},overrideMimeType:function(Ja){if(!eb)ba.mimeType=Ja;return this},statusCode:function(Ja){var Xa;if(Ja)if(eb<2)for(Xa in Ja)Wa[Xa]=[Wa[Xa],Ja[Xa]];else Ia.always(Ja[Ia.status]);return this},abort:function(Ja){Ja=Ja||bc;S&&S.abort(Ja);n(0,Ja);return this}};Ca.promise(Ia).complete=Qa.add;Ia.success=Ia.done;Ia.error=Ia.fail;ba.url=((f||ba.url||zb)+"").replace(Pd,"").replace(Sd,Jb[1]+
"//");ba.type=h.method||h.type||ba.method||ba.type;ba.dataTypes=m.trim(ba.dataType||"*").toLowerCase().match(hb)||[""];if(ba.crossDomain==null){f=Vc.exec(ba.url.toLowerCase());ba.crossDomain=!!(f&&(f[1]!==Jb[1]||f[2]!==Jb[2]||(f[3]||(f[1]==="http:"?80:443))!=(Jb[3]||(Jb[1]==="http:"?80:443))))}if(ba.data&&ba.processData&&typeof ba.data!=="string")ba.data=m.param(ba.data,ba.traditional);W(Xc,ba,h,Ia);if(eb===2)return Ia;(K=ba.global)&&m.active++===0&&m.event.trigger("ajaxStart");ba.type=ba.type.toUpperCase();
ba.hasContent=!Rd.test(ba.type);s=ba.url;if(!ba.hasContent){if(ba.data){s=ba.url+=(sc.test(s)?"&":"?")+ba.data;delete ba.data}if(ba.cache===false)ba.url=Uc.test(s)?s.replace(Uc,"$1_="+rc++):s+(sc.test(s)?"&":"?")+"_="+rc++}if(ba.ifModified){m.lastModified[s]&&Ia.setRequestHeader("If-Modified-Since",m.lastModified[s]);m.etag[s]&&Ia.setRequestHeader("If-None-Match",m.etag[s])}if(ba.data&&ba.hasContent&&ba.contentType!==false||h.contentType)Ia.setRequestHeader("Content-Type",ba.contentType);Ia.setRequestHeader("Accept",
ba.dataTypes[0]&&ba.accepts[ba.dataTypes[0]]?ba.accepts[ba.dataTypes[0]]+(ba.dataTypes[0]!=="*"?", "+Yc+"; q=0.01":""):ba.accepts["*"]);for(o in ba.headers)Ia.setRequestHeader(o,ba.headers[o]);if(ba.beforeSend&&(ba.beforeSend.call(pa,Ia,ba)===false||eb===2))return Ia.abort();bc="abort";for(o in{success:1,error:1,complete:1})Ia[o](ba[o]);if(S=W(fc,ba,h,Ia)){Ia.readyState=1;K&&ya.trigger("ajaxSend",[Ia,ba]);if(ba.async&&ba.timeout>0)C=setTimeout(function(){Ia.abort("timeout")},ba.timeout);try{eb=1;
S.send(ib,n)}catch(Xb){if(eb<2)n(-1,Xb);else throw Xb;}}else n(-1,"No Transport");return Ia},getScript:function(f,h){return m.get(f,b,h,"script")},getJSON:function(f,h,n){return m.get(f,h,n,"json")}});m.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(f){m.globalEval(f);return f}}});m.ajaxPrefilter("script",function(f){if(f.cache===b)f.cache=false;if(f.crossDomain){f.type=
"GET";f.global=false}});m.ajaxTransport("script",function(f){if(f.crossDomain){var h,n=I.head||m("head")[0]||I.documentElement;return{send:function(o,s){h=I.createElement("script");h.async=true;if(f.scriptCharset)h.charset=f.scriptCharset;h.src=f.url;h.onload=h.onreadystatechange=function(y,C){if(C||!h.readyState||/loaded|complete/.test(h.readyState)){h.onload=h.onreadystatechange=null;h.parentNode&&h.parentNode.removeChild(h);h=null;C||s(200,"success")}};n.insertBefore(h,n.firstChild)},abort:function(){h&&
h.onload(b,true)}}}});var Zc=[],tc=/(=)\?(?=&|$)|\?\?/;m.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var f=Zc.pop()||m.expando+"_"+rc++;this[f]=true;return f}});m.ajaxPrefilter("json jsonp",function(f,h,n){var o,s,y,C=f.jsonp!==false&&(tc.test(f.url)?"url":typeof f.data==="string"&&!(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&tc.test(f.data)&&"data");if(C||f.dataTypes[0]==="jsonp"){o=f.jsonpCallback=m.isFunction(f.jsonpCallback)?f.jsonpCallback():f.jsonpCallback;if(C)f[C]=
f[C].replace(tc,"$1"+o);else if(f.jsonp!==false)f.url+=(sc.test(f.url)?"&":"?")+f.jsonp+"="+o;f.converters["script json"]=function(){y||m.error(o+" was not called");return y[0]};f.dataTypes[0]="json";s=a[o];a[o]=function(){y=arguments};n.always(function(){a[o]=s;if(f[o]){f.jsonpCallback=h.jsonpCallback;Zc.push(o)}y&&m.isFunction(s)&&s(y[0]);y=s=b});return"script"}});var Tb,Td=0,uc=a.ActiveXObject&&function(){var f;for(f in Tb)Tb[f](b,true)};m.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&
ga()||fa()}:ga;X=m.ajaxSettings.xhr();m.support.cors=!!X&&"withCredentials"in X;(X=m.support.ajax=!!X)&&m.ajaxTransport(function(f){if(!f.crossDomain||m.support.cors){var h;return{send:function(n,o){var s,y,C=f.xhr();f.username?C.open(f.type,f.url,f.async,f.username,f.password):C.open(f.type,f.url,f.async);if(f.xhrFields)for(y in f.xhrFields)C[y]=f.xhrFields[y];f.mimeType&&C.overrideMimeType&&C.overrideMimeType(f.mimeType);if(!f.crossDomain&&!n["X-Requested-With"])n["X-Requested-With"]="XMLHttpRequest";
try{for(y in n)C.setRequestHeader(y,n[y])}catch(K){}C.send(f.hasContent&&f.data||null);h=function(S,ka){var ba,pa,ya,Ca;try{if(h&&(ka||C.readyState===4)){h=b;if(s){C.onreadystatechange=m.noop;uc&&delete Tb[s]}if(ka)C.readyState!==4&&C.abort();else{Ca={};ba=C.status;pa=C.getAllResponseHeaders();if(typeof C.responseText==="string")Ca.text=C.responseText;try{ya=C.statusText}catch(Qa){ya=""}if(!ba&&f.isLocal&&!f.crossDomain)ba=Ca.text?200:404;else if(ba===1223)ba=204}}}catch(Wa){ka||o(-1,Wa)}Ca&&o(ba,
ya,Ca,pa)};if(f.async)if(C.readyState===4)setTimeout(h);else{s=++Td;if(uc){if(!Tb){Tb={};m(a).unload(uc)}Tb[s]=h}C.onreadystatechange=h}else h()},abort:function(){h&&h(b,true)}}}});var Kb,dc,fd=/^(?:toggle|show|hide)$/,Ud=new RegExp("^(?:([+-])=|)("+ub+")([a-z%]*)$","i"),Vd=/queueHooks$/,Zb=[da],Vb={"*":[function(f,h){var n,o=this.createTween(f,h),s=Ud.exec(h),y=o.cur(),C=+y||0,K=1,S=20;if(s){h=+s[2];n=s[3]||(m.cssNumber[f]?"":"px");if(n!=="px"&&C){C=m.css(o.elem,f,true)||h||1;do{K=K||".5";C/=K;m.style(o.elem,
f,C+n)}while(K!==(K=o.cur()/y)&&K!==1&&--S)}o.unit=n;o.start=C;o.end=s[1]?C+(s[1]+1)*h:h}return o}]};m.Animation=m.extend(Ga,{tweener:function(f,h){if(m.isFunction(f)){h=f;f=["*"]}else f=f.split(" ");for(var n,o=0,s=f.length;o<s;o++){n=f[o];Vb[n]=Vb[n]||[];Vb[n].unshift(h)}},prefilter:function(f,h){h?Zb.unshift(f):Zb.push(f)}});m.Tween=ha;ha.prototype={constructor:ha,init:function(f,h,n,o,s,y){this.elem=f;this.prop=n;this.easing=s||"swing";this.options=h;this.start=this.now=this.cur();this.end=o;
this.unit=y||(m.cssNumber[n]?"":"px")},cur:function(){var f=ha.propHooks[this.prop];return f&&f.get?f.get(this):ha.propHooks._default.get(this)},run:function(f){var h,n=ha.propHooks[this.prop];this.pos=this.options.duration?(h=m.easing[this.easing](f,this.options.duration*f,0,1,this.options.duration)):(h=f);this.now=(this.end-this.start)*h+this.start;this.options.step&&this.options.step.call(this.elem,this.now,this);n&&n.set?n.set(this):ha.propHooks._default.set(this);return this}};ha.prototype.init.prototype=
ha.prototype;ha.propHooks={_default:{get:function(f){if(f.elem[f.prop]!=null&&(!f.elem.style||f.elem.style[f.prop]==null))return f.elem[f.prop];f=m.css(f.elem,f.prop,"");return!f||f==="auto"?0:f},set:function(f){if(m.fx.step[f.prop])m.fx.step[f.prop](f);else if(f.elem.style&&(f.elem.style[m.cssProps[f.prop]]!=null||m.cssHooks[f.prop]))m.style(f.elem,f.prop,f.now+f.unit);else f.elem[f.prop]=f.now}}};ha.propHooks.scrollTop=ha.propHooks.scrollLeft={set:function(f){if(f.elem.nodeType&&f.elem.parentNode)f.elem[f.prop]=
f.now}};m.each(["toggle","show","hide"],function(f,h){var n=m.fn[h];m.fn[h]=function(o,s,y){return o==null||typeof o==="boolean"?n.apply(this,arguments):this.animate(qa(h,true),o,s,y)}});m.fn.extend({fadeTo:function(f,h,n,o){return this.filter(z).css("opacity",0).show().end().animate({opacity:h},f,n,o)},animate:function(f,h,n,o){var s=m.isEmptyObject(f),y=m.speed(h,n,o),C=function(){var K=Ga(this,m.extend({},f),y);C.finish=function(){K.stop(true)};if(s||m._data(this,"finish"))K.stop(true)};C.finish=
C;return s||y.queue===false?this.each(C):this.queue(y.queue,C)},stop:function(f,h,n){var o=function(s){var y=s.stop;delete s.stop;y(n)};if(typeof f!=="string"){n=h;h=f;f=b}if(h&&f!==false)this.queue(f||"fx",[]);return this.each(function(){var s=true,y=f!=null&&f+"queueHooks",C=m.timers,K=m._data(this);if(y)K[y]&&K[y].stop&&o(K[y]);else for(y in K)K[y]&&K[y].stop&&Vd.test(y)&&o(K[y]);for(y=C.length;y--;)if(C[y].elem===this&&(f==null||C[y].queue===f)){C[y].anim.stop(n);s=false;C.splice(y,1)}if(s||!n)m.dequeue(this,
f)})},finish:function(f){if(f!==false)f=f||"fx";return this.each(function(){var h,n=m._data(this),o=n[f+"queue"];h=n[f+"queueHooks"];var s=m.timers,y=o?o.length:0;n.finish=true;m.queue(this,f,[]);h&&h.cur&&h.cur.finish&&h.cur.finish.call(this);for(h=s.length;h--;)if(s[h].elem===this&&s[h].queue===f){s[h].anim.stop(true);s.splice(h,1)}for(h=0;h<y;h++)o[h]&&o[h].finish&&o[h].finish.call(this);delete n.finish})}});m.each({slideDown:qa("show"),slideUp:qa("hide"),slideToggle:qa("toggle"),fadeIn:{opacity:"show"},
fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(f,h){m.fn[f]=function(n,o,s){return this.animate(h,n,o,s)}});m.speed=function(f,h,n){var o=f&&typeof f==="object"?m.extend({},f):{complete:n||!n&&h||m.isFunction(f)&&f,duration:f,easing:n&&h||h&&!m.isFunction(h)&&h};o.duration=m.fx.off?0:typeof o.duration==="number"?o.duration:o.duration in m.fx.speeds?m.fx.speeds[o.duration]:m.fx.speeds._default;if(o.queue==null||o.queue===true)o.queue="fx";o.old=o.complete;o.complete=function(){m.isFunction(o.old)&&
o.old.call(this);o.queue&&m.dequeue(this,o.queue)};return o};m.easing={linear:function(f){return f},swing:function(f){return 0.5-Math.cos(f*Math.PI)/2}};m.timers=[];m.fx=ha.prototype.init;m.fx.tick=function(){var f,h=m.timers,n=0;for(Kb=m.now();n<h.length;n++){f=h[n];!f()&&h[n]===f&&h.splice(n--,1)}h.length||m.fx.stop();Kb=b};m.fx.timer=function(f){f()&&m.timers.push(f)&&m.fx.start()};m.fx.interval=13;m.fx.start=function(){dc||(dc=setInterval(m.fx.tick,m.fx.interval))};m.fx.stop=function(){clearInterval(dc);
dc=null};m.fx.speeds={slow:600,fast:200,_default:400};m.fx.step={};if(m.expr&&m.expr.filters)m.expr.filters.animated=function(f){return m.grep(m.timers,function(h){return f===h.elem}).length};m.fn.offset=function(f){if(arguments.length)return f===b?this:this.each(function(y){m.offset.setOffset(this,f,y)});var h,n,o={top:0,left:0},s=(n=this[0])&&n.ownerDocument;if(s){h=s.documentElement;if(!m.contains(h,n))return o;if(typeof n.getBoundingClientRect!==sa)o=n.getBoundingClientRect();n=T(s);return{top:o.top+
(n.pageYOffset||h.scrollTop)-(h.clientTop||0),left:o.left+(n.pageXOffset||h.scrollLeft)-(h.clientLeft||0)}}};m.offset={setOffset:function(f,h,n){var o=m.css(f,"position");if(o==="static")f.style.position="relative";var s=m(f),y=s.offset(),C=m.css(f,"top"),K=m.css(f,"left"),S={},ka={};if((o==="absolute"||o==="fixed")&&m.inArray("auto",[C,K])>-1){ka=s.position();o=ka.top;K=ka.left}else{o=parseFloat(C)||0;K=parseFloat(K)||0}if(m.isFunction(h))h=h.call(f,n,y);if(h.top!=null)S.top=h.top-y.top+o;if(h.left!=
null)S.left=h.left-y.left+K;"using"in h?h.using.call(f,S):s.css(S)}};m.fn.extend({position:function(){if(this[0]){var f,h,n={top:0,left:0},o=this[0];if(m.css(o,"position")==="fixed")h=o.getBoundingClientRect();else{f=this.offsetParent();h=this.offset();m.nodeName(f[0],"html")||(n=f.offset());n.top+=m.css(f[0],"borderTopWidth",true);n.left+=m.css(f[0],"borderLeftWidth",true)}return{top:h.top-n.top-m.css(o,"marginTop",true),left:h.left-n.left-m.css(o,"marginLeft",true)}}},offsetParent:function(){return this.map(function(){for(var f=
this.offsetParent||I.documentElement;f&&!m.nodeName(f,"html")&&m.css(f,"position")==="static";)f=f.offsetParent;return f||I.documentElement})}});m.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(f,h){var n=/Y/.test(h);m.fn[f]=function(o){return m.access(this,function(s,y,C){var K=T(s);if(C===b)return K?h in K?K[h]:K.document.documentElement[y]:s[y];if(K)K.scrollTo(!n?C:m(K).scrollLeft(),n?C:m(K).scrollTop());else s[y]=C},f,o,arguments.length,null)}});m.each({Height:"height",Width:"width"},
function(f,h){m.each({padding:"inner"+f,content:h,"":"outer"+f},function(n,o){m.fn[o]=function(s,y){var C=arguments.length&&(n||typeof s!=="boolean"),K=n||(s===true||y===true?"margin":"border");return m.access(this,function(S,ka,ba){if(m.isWindow(S))return S.document.documentElement["client"+f];if(S.nodeType===9){ka=S.documentElement;return Math.max(S.body["scroll"+f],ka["scroll"+f],S.body["offset"+f],ka["offset"+f],ka["client"+f])}return ba===b?m.css(S,ka,K):m.style(S,ka,ba,K)},h,C?s:b,C,null)}})});
a.jQuery=a.$=m;typeof define==="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return m})})(window);jQuery.noConflict();var $j=jQuery;String.prototype.parseColor=function(a){var b="#";if(this.slice(0,4)=="rgb("){var c=this.slice(4,this.length-1).split(","),e=0;do b+=parseInt(c[e]).toColorPart();while(++e<3)}else if(this.slice(0,1)=="#"){if(this.length==4)for(e=1;e<4;e++)b+=(this.charAt(e)+this.charAt(e)).toLowerCase();if(this.length==7)b=this.toLowerCase()}return b.length==7?b:a||this};
Element.collectTextNodes=function(a){return $A($(a).childNodes).collect(function(b){return b.nodeType==3?b.nodeValue:b.hasChildNodes()?Element.collectTextNodes(b):""}).flatten().join("")};Element.collectTextNodesIgnoreClass=function(a,b){return $A($(a).childNodes).collect(function(c){return c.nodeType==3?c.nodeValue:c.hasChildNodes()&&!Element.hasClassName(c,b)?Element.collectTextNodesIgnoreClass(c,b):""}).flatten().join("")};
Element.setContentZoom=function(a,b){a=$(a);a.setStyle({fontSize:b/100+"em"});Prototype.Browser.WebKit&&window.scrollBy(0,0);return a};Element.getInlineOpacity=function(a){return $(a).style.opacity||""};Element.forceRerendering=function(a){try{a=$(a);var b=document.createTextNode(" ");a.appendChild(b);a.removeChild(b)}catch(c){}};
var Effect={_elementDoesNotExistError:{name:"ElementDoesNotExistError",message:"The specified DOM element does not exist, but is required for this effect to operate"},Transitions:{linear:Prototype.K,sinoidal:function(a){return-Math.cos(a*Math.PI)/2+0.5},reverse:function(a){return 1-a},flicker:function(a){a=-Math.cos(a*Math.PI)/4+0.75+Math.random()/4;return a>1?1:a},wobble:function(a){return-Math.cos(a*Math.PI*9*a)/2+0.5},pulse:function(a,b){return-Math.cos(a*((b||5)-0.5)*2*Math.PI)/2+0.5},spring:function(a){return 1-
Math.cos(a*4.5*Math.PI)*Math.exp(-a*6)},none:function(){return 0},full:function(){return 1}},DefaultOptions:{duration:1,fps:100,sync:false,from:0,to:1,delay:0,queue:"parallel"},tagifyText:function(a){var b="position:relative";if(Prototype.Browser.IE)b+=";zoom:1";a=$(a);$A(a.childNodes).each(function(c){if(c.nodeType==3){c.nodeValue.toArray().each(function(e){a.insertBefore((new Element("span",{style:b})).update(e==" "?String.fromCharCode(160):e),c)});Element.remove(c)}})},multiple:function(a,b,c){a=
(typeof a=="object"||Object.isFunction(a))&&a.length?a:$(a).childNodes;var e=Object.extend({speed:0.1,delay:0},c||{}),g=e.delay;$A(a).each(function(l,r){new b(l,Object.extend(e,{delay:r*e.speed+g}))})},PAIRS:{slide:["SlideDown","SlideUp"],blind:["BlindDown","BlindUp"],appear:["Appear","Fade"]},toggle:function(a,b,c){a=$(a);b=(b||"appear").toLowerCase();c=Object.extend({queue:{position:"end",scope:a.id||"global",limit:1}},c||{});Effect[a.visible()?Effect.PAIRS[b][1]:Effect.PAIRS[b][0]](a,c)}};
Effect.DefaultOptions.transition=Effect.Transitions.sinoidal;
Effect.ScopedQueue=Class.create(Enumerable,{initialize:function(){this.effects=[];this.interval=null},_each:function(a){this.effects._each(a)},add:function(a){var b=(new Date).getTime();switch(Object.isString(a.options.queue)?a.options.queue:a.options.queue.position){case "front":this.effects.findAll(function(c){return c.state=="idle"}).each(function(c){c.startOn+=a.finishOn;c.finishOn+=a.finishOn});break;case "with-last":b=this.effects.pluck("startOn").max()||b;break;case "end":b=this.effects.pluck("finishOn").max()||
b;break}a.startOn+=b;a.finishOn+=b;if(!a.options.queue.limit||this.effects.length<a.options.queue.limit)this.effects.push(a);if(!this.interval)this.interval=setInterval(this.loop.bind(this),15)},remove:function(a){this.effects=this.effects.reject(function(b){return b==a});if(this.effects.length==0){clearInterval(this.interval);this.interval=null}},loop:function(){for(var a=(new Date).getTime(),b=0,c=this.effects.length;b<c;b++)this.effects[b]&&this.effects[b].loop(a)}});
Effect.Queues={instances:$H(),get:function(a){if(!Object.isString(a))return a;return this.instances.get(a)||this.instances.set(a,new Effect.ScopedQueue)}};Effect.Queue=Effect.Queues.get("global");
Effect.Base=Class.create({position:null,start:function(a){if(a&&a.transition===false)a.transition=Effect.Transitions.linear;this.options=Object.extend(Object.extend({},Effect.DefaultOptions),a||{});this.currentFrame=0;this.state="idle";this.startOn=this.options.delay*1E3;this.finishOn=this.startOn+this.options.duration*1E3;this.fromToDelta=this.options.to-this.options.from;this.totalTime=this.finishOn-this.startOn;this.totalFrames=this.options.fps*this.options.duration;this.render=function(){function b(c,
e){c.options[e+"Internal"]&&c.options[e+"Internal"](c);c.options[e]&&c.options[e](c)}return function(c){if(this.state==="idle"){this.state="running";b(this,"beforeSetup");this.setup&&this.setup();b(this,"afterSetup")}if(this.state==="running"){this.position=c=this.options.transition(c)*this.fromToDelta+this.options.from;b(this,"beforeUpdate");this.update&&this.update(c);b(this,"afterUpdate")}}}();this.event("beforeStart");this.options.sync||Effect.Queues.get(Object.isString(this.options.queue)?"global":
this.options.queue.scope).add(this)},loop:function(a){if(a>=this.startOn)if(a>=this.finishOn){this.render(1);this.cancel();this.event("beforeFinish");this.finish&&this.finish();this.event("afterFinish")}else{a=(a-this.startOn)/this.totalTime;var b=(a*this.totalFrames).round();if(b>this.currentFrame){this.render(a);this.currentFrame=b}}},cancel:function(){this.options.sync||Effect.Queues.get(Object.isString(this.options.queue)?"global":this.options.queue.scope).remove(this);this.state="finished"},
event:function(a){this.options[a+"Internal"]&&this.options[a+"Internal"](this);this.options[a]&&this.options[a](this)},inspect:function(){var a=$H();for(property in this)Object.isFunction(this[property])||a.set(property,this[property]);return"#<Effect:"+a.inspect()+",options:"+$H(this.options).inspect()+">"}});
Effect.Parallel=Class.create(Effect.Base,{initialize:function(a,b){this.effects=a||[];this.start(b)},update:function(a){this.effects.invoke("render",a)},finish:function(a){this.effects.each(function(b){b.render(1);b.cancel();b.event("beforeFinish");b.finish&&b.finish(a);b.event("afterFinish")})}});
Effect.Tween=Class.create(Effect.Base,{initialize:function(a,b,c){a=Object.isString(a)?$(a):a;var e=$A(arguments),g=e.last();e=e.length==5?e[3]:null;this.method=Object.isFunction(g)?g.bind(a):Object.isFunction(a[g])?a[g].bind(a):function(l){a[g]=l};this.start(Object.extend({from:b,to:c},e||{}))},update:function(a){this.method(a)}});Effect.Event=Class.create(Effect.Base,{initialize:function(a){this.start(Object.extend({duration:0},a||{}))},update:Prototype.emptyFunction});
Effect.Opacity=Class.create(Effect.Base,{initialize:function(a,b){this.element=$(a);if(!this.element)throw Effect._elementDoesNotExistError;Prototype.Browser.IE&&!this.element.currentStyle.hasLayout&&this.element.setStyle({zoom:1});this.start(Object.extend({from:this.element.getOpacity()||0,to:1},b||{}))},update:function(a){this.element.setOpacity(a)}});
Effect.Move=Class.create(Effect.Base,{initialize:function(a,b){this.element=$(a);if(!this.element)throw Effect._elementDoesNotExistError;this.start(Object.extend({x:0,y:0,mode:"relative"},b||{}))},setup:function(){this.element.makePositioned();this.originalLeft=parseFloat(this.element.getStyle("left")||"0");this.originalTop=parseFloat(this.element.getStyle("top")||"0");if(this.options.mode=="absolute"){this.options.x-=this.originalLeft;this.options.y-=this.originalTop}},update:function(a){this.element.setStyle({left:(this.options.x*
a+this.originalLeft).round()+"px",top:(this.options.y*a+this.originalTop).round()+"px"})}});Effect.MoveBy=function(a,b,c,e){return new Effect.Move(a,Object.extend({x:c,y:b},e||{}))};
Effect.Scale=Class.create(Effect.Base,{initialize:function(a,b,c){this.element=$(a);if(!this.element)throw Effect._elementDoesNotExistError;this.start(Object.extend({scaleX:true,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:"box",scaleFrom:100,scaleTo:b},c||{}))},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||false;this.elementPositioning=this.element.getStyle("position");this.originalStyle={};["top","left","width","height","fontSize"].each(function(b){this.originalStyle[b]=
this.element.style[b]}.bind(this));this.originalTop=this.element.offsetTop;this.originalLeft=this.element.offsetLeft;var a=this.element.getStyle("font-size")||"100%";["em","px","%","pt"].each(function(b){if(a.indexOf(b)>0){this.fontSize=parseFloat(a);this.fontSizeType=b}}.bind(this));this.factor=(this.options.scaleTo-this.options.scaleFrom)/100;this.dims=null;if(this.options.scaleMode=="box")this.dims=[this.element.offsetHeight,this.element.offsetWidth];if(/^content/.test(this.options.scaleMode))this.dims=
[this.element.scrollHeight,this.element.scrollWidth];if(!this.dims)this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth]},update:function(a){a=this.options.scaleFrom/100+this.factor*a;this.options.scaleContent&&this.fontSize&&this.element.setStyle({fontSize:this.fontSize*a+this.fontSizeType});this.setDimensions(this.dims[0]*a,this.dims[1]*a)},finish:function(){this.restoreAfterFinish&&this.element.setStyle(this.originalStyle)},setDimensions:function(a,b){var c={};
if(this.options.scaleX)c.width=b.round()+"px";if(this.options.scaleY)c.height=a.round()+"px";if(this.options.scaleFromCenter){a=(a-this.dims[0])/2;b=(b-this.dims[1])/2;if(this.elementPositioning=="absolute"){if(this.options.scaleY)c.top=this.originalTop-a+"px";if(this.options.scaleX)c.left=this.originalLeft-b+"px"}else{if(this.options.scaleY)c.top=-a+"px";if(this.options.scaleX)c.left=-b+"px"}}this.element.setStyle(c)}});
Effect.Highlight=Class.create(Effect.Base,{initialize:function(a,b){this.element=$(a);if(!this.element)throw Effect._elementDoesNotExistError;this.start(Object.extend({startcolor:"#fffae2"},b||{}))},setup:function(){if(this.element.getStyle("display")=="none")this.cancel();else{this.oldStyle={};if(!this.options.keepBackgroundImage){this.oldStyle.backgroundImage=this.element.getStyle("background-image");this.element.setStyle({backgroundImage:"none"})}if(!this.options.endcolor)this.options.endcolor=
this.element.getStyle("background-color").parseColor("#ffffff");if(!this.options.restorecolor)this.options.restorecolor=this.element.getStyle("background-color");this._base=$R(0,2).map(function(a){return parseInt(this.options.startcolor.slice(a*2+1,a*2+3),16)}.bind(this));this._delta=$R(0,2).map(function(a){return parseInt(this.options.endcolor.slice(a*2+1,a*2+3),16)-this._base[a]}.bind(this))}},update:function(a){this.element.setStyle({backgroundColor:$R(0,2).inject("#",function(b,c,e){return b+
(this._base[e]+this._delta[e]*a).round().toColorPart()}.bind(this))})},finish:function(){this.element.setStyle(Object.extend(this.oldStyle,{backgroundColor:this.options.restorecolor}))}});Effect.ScrollTo=function(a,b){b=b||{};var c=document.viewport.getScrollOffsets();a=$(a).cumulativeOffset();if(b.offset)a[1]+=b.offset;return new Effect.Tween(null,c.top,a[1],b,function(e){scrollTo(c.left,e.round())})};
Effect.Fade=function(a,b){a=$(a);var c=a.getInlineOpacity();b=Object.extend({from:a.getOpacity()||1,to:0,afterFinishInternal:function(e){e.options.to==0&&e.element.hide().setStyle({opacity:c})}},b||{});return new Effect.Opacity(a,b)};
Effect.Appear=function(a,b){a=$(a);b=Object.extend({from:a.getStyle("display")=="none"?0:a.getOpacity()||0,to:1,afterFinishInternal:function(c){c.element.forceRerendering()},beforeSetup:function(c){c.element.setOpacity(c.options.from).show()}},b||{});return new Effect.Opacity(a,b)};
Effect.Puff=function(a,b){a=$(a);var c={opacity:a.getInlineOpacity(),position:a.getStyle("position"),top:a.style.top,left:a.style.left,width:a.style.width,height:a.style.height};return new Effect.Parallel([new Effect.Scale(a,200,{sync:true,scaleFromCenter:true,scaleContent:true,restoreAfterFinish:true}),new Effect.Opacity(a,{sync:true,to:0})],Object.extend({duration:1,beforeSetupInternal:function(e){Position.absolutize(e.effects[0].element)},afterFinishInternal:function(e){e.effects[0].element.hide().setStyle(c)}},
b||{}))};Effect.BlindUp=function(a,b){a=$(a);a.makeClipping();return new Effect.Scale(a,0,Object.extend({scaleContent:false,scaleX:false,restoreAfterFinish:true,afterFinishInternal:function(c){c.element.hide().undoClipping()}},b||{}))};
Effect.BlindDown=function(a,b){a=$(a);var c=a.getDimensions();return new Effect.Scale(a,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:c.height,originalWidth:c.width},restoreAfterFinish:true,afterSetup:function(e){e.element.makeClipping().setStyle({height:"0px"}).show()},afterFinishInternal:function(e){e.element.undoClipping()}},b||{}))};
Effect.SwitchOff=function(a,b){a=$(a);var c=a.getInlineOpacity();return new Effect.Appear(a,Object.extend({duration:0.4,from:0,transition:Effect.Transitions.flicker,afterFinishInternal:function(e){new Effect.Scale(e.element,1,{duration:0.3,scaleFromCenter:true,scaleX:false,scaleContent:false,restoreAfterFinish:true,beforeSetup:function(g){g.element.makePositioned().makeClipping()},afterFinishInternal:function(g){g.element.hide().undoClipping().undoPositioned().setStyle({opacity:c})}})}},b||{}))};
Effect.DropOut=function(a,b){a=$(a);var c={top:a.getStyle("top"),left:a.getStyle("left"),opacity:a.getInlineOpacity()};return new Effect.Parallel([new Effect.Move(a,{x:0,y:100,sync:true}),new Effect.Opacity(a,{sync:true,to:0})],Object.extend({duration:0.5,beforeSetup:function(e){e.effects[0].element.makePositioned()},afterFinishInternal:function(e){e.effects[0].element.hide().undoPositioned().setStyle(c)}},b||{}))};
Effect.Shake=function(a,b){a=$(a);b=Object.extend({distance:20,duration:0.5},b||{});var c=parseFloat(b.distance),e=parseFloat(b.duration)/10,g={top:a.getStyle("top"),left:a.getStyle("left")};return new Effect.Move(a,{x:c,y:0,duration:e,afterFinishInternal:function(l){new Effect.Move(l.element,{x:-c*2,y:0,duration:e*2,afterFinishInternal:function(r){new Effect.Move(r.element,{x:c*2,y:0,duration:e*2,afterFinishInternal:function(u){new Effect.Move(u.element,{x:-c*2,y:0,duration:e*2,afterFinishInternal:function(t){new Effect.Move(t.element,
{x:c*2,y:0,duration:e*2,afterFinishInternal:function(v){new Effect.Move(v.element,{x:-c,y:0,duration:e,afterFinishInternal:function(G){G.element.undoPositioned().setStyle(g)}})}})}})}})}})}})};
Effect.SlideDown=function(a,b){a=$(a).cleanWhitespace();var c=a.down().getStyle("bottom"),e=a.getDimensions();return new Effect.Scale(a,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:window.opera?0:1,scaleMode:{originalHeight:e.height,originalWidth:e.width},restoreAfterFinish:true,afterSetup:function(g){g.element.makePositioned();g.element.down().makePositioned();window.opera&&g.element.setStyle({top:""});g.element.makeClipping().setStyle({height:"0px"}).show()},afterUpdateInternal:function(g){g.element.down().setStyle({bottom:g.dims[0]-
g.element.clientHeight+"px"})},afterFinishInternal:function(g){g.element.undoClipping().undoPositioned();g.element.down().undoPositioned().setStyle({bottom:c})}},b||{}))};
Effect.SlideUp=function(a,b){a=$(a).cleanWhitespace();var c=a.down().getStyle("bottom"),e=a.getDimensions();return new Effect.Scale(a,window.opera?0:1,Object.extend({scaleContent:false,scaleX:false,scaleMode:"box",scaleFrom:100,scaleMode:{originalHeight:e.height,originalWidth:e.width},restoreAfterFinish:true,afterSetup:function(g){g.element.makePositioned();g.element.down().makePositioned();window.opera&&g.element.setStyle({top:""});g.element.makeClipping().show()},afterUpdateInternal:function(g){g.element.down().setStyle({bottom:g.dims[0]-
g.element.clientHeight+"px"})},afterFinishInternal:function(g){g.element.hide().undoClipping().undoPositioned();g.element.down().undoPositioned().setStyle({bottom:c})}},b||{}))};Effect.Squish=function(a){return new Effect.Scale(a,window.opera?1:0,{restoreAfterFinish:true,beforeSetup:function(b){b.element.makeClipping()},afterFinishInternal:function(b){b.element.hide().undoClipping()}})};
Effect.Grow=function(a,b){a=$(a);var c=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.full},b||{}),e={top:a.style.top,left:a.style.left,height:a.style.height,width:a.style.width,opacity:a.getInlineOpacity()},g=a.getDimensions(),l,r,u,t;switch(c.direction){case "top-left":l=r=u=t=0;break;case "top-right":l=g.width;r=t=0;u=-g.width;break;case "bottom-left":l=u=0;r=g.height;t=-g.height;break;
case "bottom-right":l=g.width;r=g.height;u=-g.width;t=-g.height;break;case "center":l=g.width/2;r=g.height/2;u=-g.width/2;t=-g.height/2;break}return new Effect.Move(a,{x:l,y:r,duration:0.01,beforeSetup:function(v){v.element.hide().makeClipping().makePositioned()},afterFinishInternal:function(v){new Effect.Parallel([new Effect.Opacity(v.element,{sync:true,to:1,from:0,transition:c.opacityTransition}),new Effect.Move(v.element,{x:u,y:t,sync:true,transition:c.moveTransition}),new Effect.Scale(v.element,
100,{scaleMode:{originalHeight:g.height,originalWidth:g.width},sync:true,scaleFrom:window.opera?1:0,transition:c.scaleTransition,restoreAfterFinish:true})],Object.extend({beforeSetup:function(G){G.effects[0].element.setStyle({height:"0px"}).show()},afterFinishInternal:function(G){G.effects[0].element.undoClipping().undoPositioned().setStyle(e)}},c))}})};
Effect.Shrink=function(a,b){a=$(a);b=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.none},b||{});var c={top:a.style.top,left:a.style.left,height:a.style.height,width:a.style.width,opacity:a.getInlineOpacity()},e=a.getDimensions(),g,l;switch(b.direction){case "top-left":g=l=0;break;case "top-right":g=e.width;l=0;break;case "bottom-left":g=0;l=e.height;break;case "bottom-right":g=e.width;l=
e.height;break;case "center":g=e.width/2;l=e.height/2;break}return new Effect.Parallel([new Effect.Opacity(a,{sync:true,to:0,from:1,transition:b.opacityTransition}),new Effect.Scale(a,window.opera?1:0,{sync:true,transition:b.scaleTransition,restoreAfterFinish:true}),new Effect.Move(a,{x:g,y:l,sync:true,transition:b.moveTransition})],Object.extend({beforeStartInternal:function(r){r.effects[0].element.makePositioned().makeClipping()},afterFinishInternal:function(r){r.effects[0].element.hide().undoClipping().undoPositioned().setStyle(c)}},
b))};Effect.Pulsate=function(a,b){a=$(a);var c=b||{},e=a.getInlineOpacity(),g=c.transition||Effect.Transitions.linear;return new Effect.Opacity(a,Object.extend(Object.extend({duration:2,from:0,afterFinishInternal:function(l){l.element.setStyle({opacity:e})}},c),{transition:function(l){return 1-g(-Math.cos(l*(c.pulses||5)*2*Math.PI)/2+0.5)}}))};
Effect.Fold=function(a,b){a=$(a);var c={top:a.style.top,left:a.style.left,width:a.style.width,height:a.style.height};a.makeClipping();return new Effect.Scale(a,5,Object.extend({scaleContent:false,scaleX:false,afterFinishInternal:function(){new Effect.Scale(a,1,{scaleContent:false,scaleY:false,afterFinishInternal:function(e){e.element.hide().undoClipping().setStyle(c)}})}},b||{}))};
Effect.Morph=Class.create(Effect.Base,{initialize:function(a,b){this.element=$(a);if(!this.element)throw Effect._elementDoesNotExistError;a=Object.extend({style:{}},b||{});if(Object.isString(a.style))if(a.style.include(":"))this.style=a.style.parseStyle();else{this.element.addClassName(a.style);this.style=$H(this.element.getStyles());this.element.removeClassName(a.style);var c=this.element.getStyles();this.style=this.style.reject(function(e){return e.value==c[e.key]});a.afterFinishInternal=function(e){e.element.addClassName(e.options.style);
e.transforms.each(function(g){e.element.style[g.style]=""})}}else this.style=$H(a.style);this.start(a)},setup:function(){function a(b){if(!b||["rgba(0, 0, 0, 0)","transparent"].include(b))b="#ffffff";b=b.parseColor();return $R(0,2).map(function(c){return parseInt(b.slice(c*2+1,c*2+3),16)})}this.transforms=this.style.map(function(b){var c=b[0];b=b[1];var e=null;if(b.parseColor("#zzzzzz")!="#zzzzzz"){b=b.parseColor();e="color"}else if(c=="opacity"){b=parseFloat(b);Prototype.Browser.IE&&!this.element.currentStyle.hasLayout&&
this.element.setStyle({zoom:1})}else if(Element.CSS_LENGTH.test(b)){e=b.match(/^([\+\-]?[0-9\.]+)(.*)$/);b=parseFloat(e[1]);e=e.length==3?e[2]:null}var g=this.element.getStyle(c);return{style:c.camelize(),originalValue:e=="color"?a(g):parseFloat(g||0),targetValue:e=="color"?a(b):b,unit:e}}.bind(this)).reject(function(b){return b.originalValue==b.targetValue||b.unit!="color"&&(isNaN(b.originalValue)||isNaN(b.targetValue))})},update:function(a){for(var b={},c,e=this.transforms.length;e--;)b[(c=this.transforms[e]).style]=
c.unit=="color"?"#"+Math.round(c.originalValue[0]+(c.targetValue[0]-c.originalValue[0])*a).toColorPart()+Math.round(c.originalValue[1]+(c.targetValue[1]-c.originalValue[1])*a).toColorPart()+Math.round(c.originalValue[2]+(c.targetValue[2]-c.originalValue[2])*a).toColorPart():(c.originalValue+(c.targetValue-c.originalValue)*a).toFixed(3)+(c.unit===null?"":c.unit);this.element.setStyle(b,true)}});
Effect.Transform=Class.create({initialize:function(a,b){this.tracks=[];this.options=b||{};this.addTracks(a)},addTracks:function(a){a.each(function(b){b=$H(b);var c=b.values().first();this.tracks.push($H({ids:b.keys().first(),effect:Effect.Morph,options:{style:c}}))}.bind(this));return this},play:function(){return new Effect.Parallel(this.tracks.map(function(a){var b=a.get("ids"),c=a.get("effect"),e=a.get("options");return[$(b)||$$(b)].flatten().map(function(g){return new c(g,Object.extend({sync:true},
e))})}).flatten(),this.options)}});Element.CSS_PROPERTIES=$w("backgroundColor backgroundPosition borderBottomColor borderBottomStyle borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth borderRightColor borderRightStyle borderRightWidth borderSpacing borderTopColor borderTopStyle borderTopWidth bottom clip color fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop markerOffset maxHeight maxWidth minHeight minWidth opacity outlineColor outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex");
Element.CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/;String.__parseStyleElement=document.createElement("div");
String.prototype.parseStyle=function(){var a,b=$H();if(Prototype.Browser.WebKit)a=(new Element("div",{style:this})).style;else{String.__parseStyleElement.innerHTML='<div style="'+this+'"></div>';a=String.__parseStyleElement.childNodes[0].style}Element.CSS_PROPERTIES.each(function(c){a[c]&&b.set(c,a[c])});Prototype.Browser.IE&&this.include("opacity")&&b.set("opacity",this.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1]);return b};
Element.getStyles=document.defaultView&&document.defaultView.getComputedStyle?function(a){var b=document.defaultView.getComputedStyle($(a),null);return Element.CSS_PROPERTIES.inject({},function(c,e){c[e]=b[e];return c})}:function(a){a=$(a);var b=a.currentStyle,c;c=Element.CSS_PROPERTIES.inject({},function(e,g){e[g]=b[g];return e});if(!c.opacity)c.opacity=a.getOpacity();return c};
Effect.Methods={morph:function(a,b,c){a=$(a);new Effect.Morph(a,Object.extend({style:b},c||{}));return a},visualEffect:function(a,b,c){a=$(a);b=b.dasherize().camelize();b=b.charAt(0).toUpperCase()+b.substring(1);new Effect[b](a,c);return a},highlight:function(a,b){a=$(a);new Effect.Highlight(a,b);return a}};
$w("fade appear grow shrink fold blindUp blindDown slideUp slideDown pulsate shake puff squish switchOff dropOut").each(function(a){Effect.Methods[a]=function(b,c){b=$(b);Effect[a.charAt(0).toUpperCase()+a.substring(1)](b,c);return b}});$w("getInlineOpacity forceRerendering setContentZoom collectTextNodes collectTextNodesIgnoreClass getStyles").each(function(a){Effect.Methods[a]=Element[a]});Element.addMethods(Effect.Methods);if(typeof Effect=="undefined")throw"controls.js requires including script.aculo.us' effects.js library";var Autocompleter={};
Autocompleter.Base=Class.create({baseInitialize:function(a,b,c){this.element=a=$(a);this.update=$(b);this.active=this.changed=this.hasFocus=false;this.entryCount=this.index=0;this.oldElementValue=this.element.value;if(this.setOptions)this.setOptions(c);else this.options=c||{};this.options.paramName=this.options.paramName||this.element.name;this.options.tokens=this.options.tokens||[];this.options.frequency=this.options.frequency||0.4;this.options.minChars=this.options.minChars||1;this.options.onShow=
this.options.onShow||function(e,g){if(!g.style.position||g.style.position=="absolute"){g.style.position="absolute";Position.clone(e,g,{setHeight:false,offsetTop:e.offsetHeight})}Effect.Appear(g,{duration:0.15})};this.options.onHide=this.options.onHide||function(e,g){new Effect.Fade(g,{duration:0.15})};if(typeof this.options.tokens=="string")this.options.tokens=new Array(this.options.tokens);this.options.tokens.include("\n")||this.options.tokens.push("\n");this.observer=null;this.element.setAttribute("autocomplete",
"off");Element.hide(this.update);Event.observe(this.element,"blur",this.onBlur.bindAsEventListener(this));Event.observe(this.element,"keydown",this.onKeyPress.bindAsEventListener(this))},show:function(){Element.getStyle(this.update,"display")=="none"&&this.options.onShow(this.element,this.update);if(!this.iefix&&Prototype.Browser.IE&&Element.getStyle(this.update,"position")=="absolute"){new Insertion.After(this.update,'<iframe id="'+this.update.id+'_iefix" style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);" src="javascript:false;" frameborder="0" scrolling="no"></iframe>');
this.iefix=$(this.update.id+"_iefix")}this.iefix&&setTimeout(this.fixIEOverlapping.bind(this),50)},fixIEOverlapping:function(){Position.clone(this.update,this.iefix,{setTop:!this.update.style.height});this.iefix.style.zIndex=1;this.update.style.zIndex=2;Element.show(this.iefix)},hide:function(){this.stopIndicator();Element.getStyle(this.update,"display")!="none"&&this.options.onHide(this.element,this.update);this.iefix&&Element.hide(this.iefix)},startIndicator:function(){this.options.indicator&&Element.show(this.options.indicator)},
stopIndicator:function(){this.options.indicator&&Element.hide(this.options.indicator)},onKeyPress:function(a){if(this.active)switch(a.keyCode){case Event.KEY_TAB:case Event.KEY_RETURN:this.selectEntry();Event.stop(a);case Event.KEY_ESC:this.hide();this.active=false;Event.stop(a);return;case Event.KEY_LEFT:case Event.KEY_RIGHT:return;case Event.KEY_UP:this.markPrevious();this.render();Event.stop(a);return;case Event.KEY_DOWN:this.markNext();this.render();Event.stop(a);return}else if(a.keyCode==Event.KEY_TAB||
a.keyCode==Event.KEY_RETURN||Prototype.Browser.WebKit>0&&a.keyCode==0)return;this.hasFocus=this.changed=true;this.observer&&clearTimeout(this.observer);this.observer=setTimeout(this.onObserverEvent.bind(this),this.options.frequency*1E3)},activate:function(){this.changed=false;this.hasFocus=true;this.getUpdatedChoices()},onHover:function(a){var b=Event.findElement(a,"LI");if(this.index!=b.autocompleteIndex){this.index=b.autocompleteIndex;this.render()}Event.stop(a)},onClick:function(a){this.index=
Event.findElement(a,"LI").autocompleteIndex;this.selectEntry();this.hide()},onBlur:function(){setTimeout(this.hide.bind(this),250);this.active=this.hasFocus=false},render:function(){if(this.entryCount>0){for(var a=0;a<this.entryCount;a++)this.index==a?Element.addClassName(this.getEntry(a),"selected"):Element.removeClassName(this.getEntry(a),"selected");if(this.hasFocus){this.show();this.active=true}}else{this.active=false;this.hide()}},markPrevious:function(){if(this.index>0)this.index--;else this.index=
this.entryCount-1;this.getEntry(this.index).scrollIntoView(true)},markNext:function(){if(this.index<this.entryCount-1)this.index++;else this.index=0;this.getEntry(this.index).scrollIntoView(false)},getEntry:function(a){return this.update.firstChild.childNodes[a]},getCurrentEntry:function(){return this.getEntry(this.index)},selectEntry:function(){this.active=false;this.updateElement(this.getCurrentEntry())},updateElement:function(a){if(this.options.updateElement)this.options.updateElement(a);else{var b=
"";if(this.options.select){var c=$(a).select("."+this.options.select)||[];if(c.length>0)b=Element.collectTextNodes(c[0],this.options.select)}else b=Element.collectTextNodesIgnoreClass(a,"informal");c=this.getTokenBounds();if(c[0]!=-1){var e=this.element.value.substr(0,c[0]),g=this.element.value.substr(c[0]).match(/^\s+/);if(g)e+=g[0];this.element.value=e+b+this.element.value.substr(c[1])}else this.element.value=b;this.oldElementValue=this.element.value;this.element.focus();this.options.afterUpdateElement&&
this.options.afterUpdateElement(this.element,a)}},updateChoices:function(a){if(!this.changed&&this.hasFocus){this.update.innerHTML=a;Element.cleanWhitespace(this.update);Element.cleanWhitespace(this.update.down());if(this.update.firstChild&&this.update.down().childNodes){this.entryCount=this.update.down().childNodes.length;for(a=0;a<this.entryCount;a++){var b=this.getEntry(a);b.autocompleteIndex=a;this.addObservers(b)}}else this.entryCount=0;this.stopIndicator();this.index=0;if(this.entryCount==1&&
this.options.autoSelect){this.selectEntry();this.hide()}else this.render()}},addObservers:function(a){Event.observe(a,"mouseover",this.onHover.bindAsEventListener(this));Event.observe(a,"click",this.onClick.bindAsEventListener(this))},onObserverEvent:function(){this.changed=false;this.tokenBounds=null;if(this.getToken().length>=this.options.minChars)this.getUpdatedChoices();else{this.active=false;this.hide()}this.oldElementValue=this.element.value},getToken:function(){var a=this.getTokenBounds();
return this.element.value.substring(a[0],a[1]).strip()},getTokenBounds:function(){if(null!=this.tokenBounds)return this.tokenBounds;var a=this.element.value;if(a.strip().empty())return[-1,0];for(var b=arguments.callee.getFirstDifferencePos(a,this.oldElementValue),c=b==this.oldElementValue.length?1:0,e=-1,g=a.length,l,r=0,u=this.options.tokens.length;r<u;++r){l=a.lastIndexOf(this.options.tokens[r],b+c-1);if(l>e)e=l;l=a.indexOf(this.options.tokens[r],b+c);if(-1!=l&&l<g)g=l}return this.tokenBounds=[e+
1,g]}});Autocompleter.Base.prototype.getTokenBounds.getFirstDifferencePos=function(a,b){for(var c=Math.min(a.length,b.length),e=0;e<c;++e)if(a[e]!=b[e])return e;return c};
Ajax.Autocompleter=Class.create(Autocompleter.Base,{initialize:function(a,b,c,e){this.baseInitialize(a,b,e);this.options.asynchronous=true;this.options.onComplete=this.onComplete.bind(this);this.options.defaultParams=this.options.parameters||null;this.url=c},getUpdatedChoices:function(){this.startIndicator();var a=encodeURIComponent(this.options.paramName)+"="+encodeURIComponent(this.getToken());this.options.parameters=this.options.callback?this.options.callback(this.element,a):a;if(this.options.defaultParams)this.options.parameters+=
"&"+this.options.defaultParams;new Ajax.Request(this.url,this.options)},onComplete:function(a){this.updateChoices(a.responseText)}});
Autocompleter.Local=Class.create(Autocompleter.Base,{initialize:function(a,b,c,e){this.baseInitialize(a,b,e);this.options.array=c},getUpdatedChoices:function(){this.updateChoices(this.options.selector(this))},setOptions:function(a){this.options=Object.extend({choices:10,partialSearch:true,partialChars:2,ignoreCase:true,fullSearch:false,selector:function(b){for(var c=[],e=[],g=b.getToken(),l=0;l<b.options.array.length&&c.length<b.options.choices;l++)for(var r=b.options.array[l],u=b.options.ignoreCase?
r.toLowerCase().indexOf(g.toLowerCase()):r.indexOf(g);u!=-1;){if(u==0&&r.length!=g.length){c.push("<li><strong>"+r.substr(0,g.length)+"</strong>"+r.substr(g.length)+"</li>");break}else if(g.length>=b.options.partialChars&&b.options.partialSearch&&u!=-1)if(b.options.fullSearch||/\s/.test(r.substr(u-1,1))){e.push("<li>"+r.substr(0,u)+"<strong>"+r.substr(u,g.length)+"</strong>"+r.substr(u+g.length)+"</li>");break}u=b.options.ignoreCase?r.toLowerCase().indexOf(g.toLowerCase(),u+1):r.indexOf(g,u+1)}if(e.length)c=
c.concat(e.slice(0,b.options.choices-c.length));return"<ul>"+c.join("")+"</ul>"}},a||{})}});Field.scrollFreeActivate=function(a){setTimeout(function(){Field.activate(a)},1)};
Ajax.InPlaceEditor=Class.create({initialize:function(a,b,c){this.url=b;this.element=a=$(a);this.prepareOptions();this._controls={};arguments.callee.dealWithDeprecatedOptions(c);Object.extend(this.options,c||{});if(!this.options.formId&&this.element.id){this.options.formId=this.element.id+"-inplaceeditor";if($(this.options.formId))this.options.formId=""}if(this.options.externalControl)this.options.externalControl=$(this.options.externalControl);if(!this.options.externalControl)this.options.externalControlOnly=
false;this._originalBackground=this.element.getStyle("background-color")||"transparent";this.element.title=this.options.clickToEditText;this._boundCancelHandler=this.handleFormCancellation.bind(this);this._boundComplete=(this.options.onComplete||Prototype.emptyFunction).bind(this);this._boundFailureHandler=this.handleAJAXFailure.bind(this);this._boundSubmitHandler=this.handleFormSubmission.bind(this);this._boundWrapperHandler=this.wrapUp.bind(this);this.registerListeners()},checkForEscapeOrReturn:function(a){if(!(!this._editing||
a.ctrlKey||a.altKey||a.shiftKey))if(Event.KEY_ESC==a.keyCode)this.handleFormCancellation(a);else Event.KEY_RETURN==a.keyCode&&this.handleFormSubmission(a)},createControl:function(a,b,c){var e=this.options[a+"Control"];b=this.options[a+"Text"];if("button"==e){c=document.createElement("input");c.type="submit";c.value=b;c.className="editor_"+a+"_button";if("cancel"==a)c.onclick=this._boundCancelHandler;this._form.appendChild(c);this._controls[a]=c}else if("link"==e){e=document.createElement("a");e.href=
"#";e.appendChild(document.createTextNode(b));e.onclick="cancel"==a?this._boundCancelHandler:this._boundSubmitHandler;e.className="editor_"+a+"_link";if(c)e.className+=" "+c;this._form.appendChild(e);this._controls[a]=e}},createEditField:function(){var a=this.options.loadTextURL?this.options.loadingText:this.getText(),b;if(1>=this.options.rows&&!/\r|\n/.test(this.getText())){b=document.createElement("input");b.type="text";var c=this.options.size||this.options.cols||0;if(0<c)b.size=c}else{b=document.createElement("textarea");
b.rows=1>=this.options.rows?this.options.autoRows:this.options.rows;b.cols=this.options.cols||40}b.name=this.options.paramName;b.value=a;b.className="editor_field";if(this.options.submitOnBlur)b.onblur=this._boundSubmitHandler;this._controls.editor=b;this.options.loadTextURL&&this.loadExternalText();this._form.appendChild(this._controls.editor)},createForm:function(){function a(c,e){c=b.options["text"+c+"Controls"];!c||e===false||b._form.appendChild(document.createTextNode(c))}var b=this;this._form=
$(document.createElement("form"));this._form.id=this.options.formId;this._form.addClassName(this.options.formClassName);this._form.onsubmit=this._boundSubmitHandler;this.createEditField();"textarea"==this._controls.editor.tagName.toLowerCase()&&this._form.appendChild(document.createElement("br"));this.options.onFormCustomization&&this.options.onFormCustomization(this,this._form);a("Before",this.options.okControl||this.options.cancelControl);this.createControl("ok",this._boundSubmitHandler);a("Between",
this.options.okControl&&this.options.cancelControl);this.createControl("cancel",this._boundCancelHandler,"editor_cancel");a("After",this.options.okControl||this.options.cancelControl)},destroy:function(){if(this._oldInnerHTML)this.element.innerHTML=this._oldInnerHTML;this.leaveEditMode();this.unregisterListeners()},enterEditMode:function(a){if(!(this._saving||this._editing)){this._editing=true;this.triggerCallback("onEnterEditMode");this.options.externalControl&&this.options.externalControl.hide();
this.element.hide();this.createForm();this.element.parentNode.insertBefore(this._form,this.element);this.options.loadTextURL||this.postProcessEditField();a&&Event.stop(a)}},enterHover:function(){this.options.hoverClassName&&this.element.addClassName(this.options.hoverClassName);this._saving||this.triggerCallback("onEnterHover")},getText:function(){return this.element.innerHTML.unescapeHTML()},handleAJAXFailure:function(a){this.triggerCallback("onFailure",a);if(this._oldInnerHTML){this.element.innerHTML=
this._oldInnerHTML;this._oldInnerHTML=null}},handleFormCancellation:function(a){this.wrapUp();a&&Event.stop(a)},handleFormSubmission:function(a){var b=this._form,c=$F(this._controls.editor);this.prepareSubmission();b=this.options.callback(b,c)||"";if(Object.isString(b))b=b.toQueryParams();b.editorId=this.element.id;if(this.options.htmlResponse){c=Object.extend({evalScripts:true},this.options.ajaxOptions);Object.extend(c,{parameters:b,onComplete:this._boundWrapperHandler,onFailure:this._boundFailureHandler});
new Ajax.Updater({success:this.element},this.url,c)}else{c=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(c,{parameters:b,onComplete:this._boundWrapperHandler,onFailure:this._boundFailureHandler});new Ajax.Request(this.url,c)}a&&Event.stop(a)},leaveEditMode:function(){this.element.removeClassName(this.options.savingClassName);this.removeForm();this.leaveHover();this.element.style.backgroundColor=this._originalBackground;this.element.show();this.options.externalControl&&this.options.externalControl.show();
this._editing=this._saving=false;this._oldInnerHTML=null;this.triggerCallback("onLeaveEditMode")},leaveHover:function(){this.options.hoverClassName&&this.element.removeClassName(this.options.hoverClassName);this._saving||this.triggerCallback("onLeaveHover")},loadExternalText:function(){this._form.addClassName(this.options.loadingClassName);this._controls.editor.disabled=true;var a=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(a,{parameters:"editorId="+encodeURIComponent(this.element.id),
onComplete:Prototype.emptyFunction,onSuccess:function(b){this._form.removeClassName(this.options.loadingClassName);b=b.responseText;if(this.options.stripLoadedTextTags)b=b.stripTags();this._controls.editor.value=b;this._controls.editor.disabled=false;this.postProcessEditField()}.bind(this),onFailure:this._boundFailureHandler});new Ajax.Request(this.options.loadTextURL,a)},postProcessEditField:function(){var a=this.options.fieldPostCreation;if(a)$(this._controls.editor)["focus"==a?"focus":"activate"]()},
prepareOptions:function(){this.options=Object.clone(Ajax.InPlaceEditor.DefaultOptions);Object.extend(this.options,Ajax.InPlaceEditor.DefaultCallbacks);[this._extraDefaultOptions].flatten().compact().each(function(a){Object.extend(this.options,a)}.bind(this))},prepareSubmission:function(){this._saving=true;this.removeForm();this.leaveHover();this.showSaving()},registerListeners:function(){this._listeners={};var a;$H(Ajax.InPlaceEditor.Listeners).each(function(b){a=this[b.value].bind(this);this._listeners[b.key]=
a;this.options.externalControlOnly||this.element.observe(b.key,a);this.options.externalControl&&this.options.externalControl.observe(b.key,a)}.bind(this))},removeForm:function(){if(this._form){this._form.remove();this._form=null;this._controls={}}},showSaving:function(){this._oldInnerHTML=this.element.innerHTML;this.element.innerHTML=this.options.savingText;this.element.addClassName(this.options.savingClassName);this.element.style.backgroundColor=this._originalBackground;this.element.show()},triggerCallback:function(a,
b){"function"==typeof this.options[a]&&this.options[a](this,b)},unregisterListeners:function(){$H(this._listeners).each(function(a){this.options.externalControlOnly||this.element.stopObserving(a.key,a.value);this.options.externalControl&&this.options.externalControl.stopObserving(a.key,a.value)}.bind(this))},wrapUp:function(a){this.leaveEditMode();this._boundComplete(a,this.element)}});Object.extend(Ajax.InPlaceEditor.prototype,{dispose:Ajax.InPlaceEditor.prototype.destroy});
Ajax.InPlaceCollectionEditor=Class.create(Ajax.InPlaceEditor,{initialize:function($super,b,c,e){this._extraDefaultOptions=Ajax.InPlaceCollectionEditor.DefaultOptions;$super(b,c,e)},createEditField:function(){var a=document.createElement("select");a.name=this.options.paramName;a.size=1;this._controls.editor=a;this._collection=this.options.collection||[];this.options.loadCollectionURL?this.loadCollection():this.checkForExternalText();this._form.appendChild(this._controls.editor)},loadCollection:function(){this._form.addClassName(this.options.loadingClassName);
this.showLoadingText(this.options.loadingCollectionText);var a=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(a,{parameters:"editorId="+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(b){b=b.responseText.strip();if(!/^\[.*\]$/.test(b))throw"Server returned an invalid collection representation.";this._collection=eval(b);this.checkForExternalText()}.bind(this),onFailure:this.onFailure});new Ajax.Request(this.options.loadCollectionURL,a)},
showLoadingText:function(a){this._controls.editor.disabled=true;var b=this._controls.editor.firstChild;if(!b){b=document.createElement("option");b.value="";this._controls.editor.appendChild(b);b.selected=true}b.update((a||"").stripScripts().stripTags())},checkForExternalText:function(){this._text=this.getText();this.options.loadTextURL?this.loadExternalText():this.buildOptionList()},loadExternalText:function(){this.showLoadingText(this.options.loadingText);var a=Object.extend({method:"get"},this.options.ajaxOptions);
Object.extend(a,{parameters:"editorId="+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(b){this._text=b.responseText.strip();this.buildOptionList()}.bind(this),onFailure:this.onFailure});new Ajax.Request(this.options.loadTextURL,a)},buildOptionList:function(){this._form.removeClassName(this.options.loadingClassName);this._collection=this._collection.map(function(e){return 2===e.length?e:[e,e].flatten()});var a="value"in this.options?this.options.value:this._text,
b=this._collection.any(function(e){return e[0]==a}.bind(this));this._controls.editor.update("");var c;this._collection.each(function(e,g){c=document.createElement("option");c.value=e[0];c.selected=b?e[0]==a:0==g;c.appendChild(document.createTextNode(e[1]));this._controls.editor.appendChild(c)}.bind(this));this._controls.editor.disabled=false;Field.scrollFreeActivate(this._controls.editor)}});
Ajax.InPlaceEditor.prototype.initialize.dealWithDeprecatedOptions=function(a){function b(c,e){c in a||e===undefined||(a[c]=e)}if(a){b("cancelControl",a.cancelLink?"link":a.cancelButton?"button":a.cancelLink==a.cancelButton==false?false:undefined);b("okControl",a.okLink?"link":a.okButton?"button":a.okLink==a.okButton==false?false:undefined);b("highlightColor",a.highlightcolor);b("highlightEndColor",a.highlightendcolor)}};
Object.extend(Ajax.InPlaceEditor,{DefaultOptions:{ajaxOptions:{},autoRows:3,cancelControl:"link",cancelText:"cancel",clickToEditText:"Click to edit",externalControl:null,externalControlOnly:false,fieldPostCreation:"activate",formClassName:"inplaceeditor-form",formId:null,highlightColor:"#ffff99",highlightEndColor:"#ffffff",hoverClassName:"",htmlResponse:true,loadingClassName:"inplaceeditor-loading",loadingText:"Loading...",okControl:"button",okText:"ok",paramName:"value",rows:1,savingClassName:"inplaceeditor-saving",
savingText:"Saving...",size:0,stripLoadedTextTags:false,submitOnBlur:false,textAfterControls:"",textBeforeControls:"",textBetweenControls:""},DefaultCallbacks:{callback:function(a){return Form.serialize(a)},onComplete:function(a,b){new Effect.Highlight(b,{startcolor:this.options.highlightColor,keepBackgroundImage:true})},onEnterEditMode:null,onEnterHover:function(a){a.element.style.backgroundColor=a.options.highlightColor;a._effect&&a._effect.cancel()},onFailure:function(a){alert("Error communication with the server: "+
a.responseText.stripTags())},onFormCustomization:null,onLeaveEditMode:null,onLeaveHover:function(a){a._effect=new Effect.Highlight(a.element,{startcolor:a.options.highlightColor,endcolor:a.options.highlightEndColor,restorecolor:a._originalBackground,keepBackgroundImage:true})}},Listeners:{click:"enterEditMode",keydown:"checkForEscapeOrReturn",mouseover:"enterHover",mouseout:"leaveHover"}});Ajax.InPlaceCollectionEditor.DefaultOptions={loadingCollectionText:"Loading options..."};
Form.Element.DelayedObserver=Class.create({initialize:function(a,b,c){this.delay=b||0.5;this.element=$(a);this.callback=c;this.timer=null;this.lastValue=$F(this.element);Event.observe(this.element,"keyup",this.delayedListener.bindAsEventListener(this))},delayedListener:function(){if(this.lastValue!=$F(this.element)){this.timer&&clearTimeout(this.timer);this.timer=setTimeout(this.onTimerEvent.bind(this),this.delay*1E3);this.lastValue=$F(this.element)}},onTimerEvent:function(){this.timer=null;this.callback(this.element,
$F(this.element))}});var RFC822SingleEmailRegex=/^(?:[^\x00-\x2a\x2c\x2e\x2f\x3a-\x40\x5b-\x5e\x60\x7b-\xff]+|\x22(?:[^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(?:\x2e(?:[^\x00-\x2a\x2c\x2e\x2f\x3a-\x40\x5b-\x5e\x60\x7b-\xff]+|\x22(?:[^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40(?:[^\x00-\x2a\x2c\x2e\x2f\x3a-\x40\x5b-\x5e\x60\x7b-\xff]+|\x5b(?:[^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(?:\x2e(?:[^\x00-\x2a\x2c\x2e\x2f\x3a-\x40\x5b-\x5e\x60\x7b-\xff]+|\x5b(?:[^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))+$/;
if(!document.onunload)document.onunload=function(){};function makeDynamicFrameTarget(a){var b="dynamic_frame_"+ +new Date,c=(new Element("iframe",{name:b})).setStyle({display:"none"});$(document.body).insert(c);a.target=b}function makeDynamicFrameTargetForUrl(a){a=(new Element("form",{action:a,method:"post"})).setStyle({display:"none"});$(document.body).insert(a);makeDynamicFrameTarget(a);return a}var lastFacebookStatus="unknown";
function requestAdditionalPermissions(){disableFacebookButtons();FB.login(function(a){FacebookApiLoader.updateLoginStatus();setTimeout(function(){window.location.reload()},2E3)},{scope:"email, user_birthday, publish_actions"})}function disableFacebookButtons(){$$("a.sprite_facebook").each(function(a){var b;a.hide();if(!a.next(".spinner")){b=a.hasClassName("no_inverse");a.insert({after:'<span class="spinner facebook_spinner'+(b?"":" spinner_inverse")+'">loading&hellip;</span>'})}})}
function reenableFacebookButtons(){$$("a.sprite_facebook").each(function(a){a.show();(a=a.next(".spinner"))&&a.remove()})}
function showFacebookErrorLightbox(){var a,b;if(active_user.isAuthenticated())a='<h1 class="phl">There\'s been an error!</h1><p class="regtext mhl mvm">The connection with Facebook\'s servers has timed out. Please refresh your page and try the linking process again.</p>';else{a='<h1 class="phl">There\'s been an error!</h1><p class="regtext mhl mvm">We were unable to create a Kongregate account with Facebook.</p><p class="regtext mhl mvm">Click on "Create My Account" below to create a Kongregate account using your email address instead.</p><a id="error_signup_link" href="#" class="submission_button mhl mvm">Create My Account</a>';b=
function(){$("error_signup_link").observe("click",function(e){e.preventDefault();try{lightbox.prototype.shutdown()}catch(g){}lightbox.prototype.initializeKongregateLightboxFromAjax("/accounts/new/behind_login?no_facebook_connect=true&game_id="+active_user.gameId(),{afterStaticContentLoad:function(){lightbox.prototype.toggleRegistration();$("lightbox_email_register").show();$("lightbox_facebook_register").hide();$("lightbox").removeClassName("lightbox_login")}})})}}try{lightbox.prototype.shutdown()}catch(c){}lightbox.prototype.initializeKongregateLightboxFromContent(a,
{done_class_name:"lightbox_login",afterStaticContentLoad:b});reenableFacebookButtons()}function showMatchingUserForm(a,b,c){a="/facebook_connection/login_lightbox?username="+a+"&matched_on="+b;if(active_user.gameId())a+="&game_id="+active_user.gameId();try{lightbox.prototype.shutdown()}catch(e){}lightbox.prototype.initializeKongregateLightboxFromAjax(a,{done_class_name:"lightbox_login"})}function write_to_document(a){document.write(a)}
function toggleTabs(a,b){Element.show(a);Element.show(a+"_title");Element.show(b+"_link");Element.hide(b);Element.hide(b+"_title");Element.hide(a+"_link");$(a+"_tab").className="tab current";$(b+"_tab").className="tab"}
var TopicForm={editNewTitle:function(a){$("new_topic").innerHTML=a.value.length>5?a.value:"New Topic"}},EditForm={init:function(a){$("edit-post-"+a+"_spinner").show();this.clearReplyId()},setReplyId:function(a){$("edit").setAttribute("post_id",a.toString());$("posts-"+a+"-row").addClassName("editing");$("reply")&&$("reply").hide()},clearReplyId:function(){var a=this.currentReplyId();if(!(!a||a==="")){(a=$("posts-"+a+"-row"))&&a.removeClassName("editing");$("edit").setAttribute("post_id","")}},currentReplyId:function(){return $("edit").getAttribute("post_id")},
isEditing:function(a){if(this.currentReplyId()==a.toString()){$("edit").show();$("edit_post_body").focus();return true}return false},cancel:function(){this.clearReplyId();$("edit").hide()}},ReplyForm={init:function(){EditForm.cancel();$("reply").toggle();$("post_body").focus()}};function showChatSelector(a,b){new lightbox("/rooms/change?game_rooms="+a+"&game_id="+b)}function limitText(a,b){if(a.value.length>b)a.value=a.value.substring(0,b)}
function limitCheckedBoxes(a,b,c){for(var e=0,g=0;g<a.length;g++)e+=a[g].checked?1:0;if(e>b)a[c].checked=false}function observePopup(a,b,c,e){var g=window.open(a,"",c||""),l=setInterval(function(){try{if(g.closed){clearInterval(l);e()}}catch(r){clearInterval(l)}},100);return g}Prototype.Platform={Windows:!!navigator.platform.match(/Win/),Macintosh:!!navigator.platform.match(/Mac/),Linux:!!navigator.platform.match(/Linux/)};
Hash.prototype.getWithDefault=function(a,b){var c=this.get(a);return undefined==c?this.set(a,b()):c};Hash.prototype.getOrSet=function(a,b){var c=this.get(a);return undefined==c?this.set(a,b):c};Element.addMethods("textarea",{positionCaretAtEnd:function(a){a=$(a);if(a.createTextRange){var b=a.createTextRange();b.move("character",a.value.length);b.select()}else if(a.selectionStart!==null){b=a.value.length;a.focus();a.setSelectionRange(b,b)}else{a.focus();a.value+=""}return a}});
Element.addMethods({ieHappyHide:function(a){a=$(a);a.style.display="none";a.style.visibility="hidden";return a},ieHappyShow:function(a){a=$(a);a.style.display="";a.style.visibility="visible";return a},setText:function(a,b){a=$(a);a[Prototype.Browser.Gecko?"textContent":"innerText"]=b;return a}});String.prototype.evalScripts=function(){return this.extractScripts?this.extractScripts().map(function(a){return eval(a)}):this};
function autoTruncate(a,b){b||(b=1);$$("."+a).each(function(c){var e=c.down("a"),g=e.getStyle("font-size");c=c.getWidth();var l=11;if(g)l=parseInt(g.sub("px",""),10);g=e.innerHTML;c=Math.round(c/(l-4.5)*b);e.update(g.truncate(c))})}function insertTrackingPixelWithTimestamp(a){stamp=+new Date;document.write('<img src="'+a+stamp+'?"/>')}
Prototype.Browser.Gecko&&function(){Event.observe(document,"keypress",function(a){if(a.keyCode==Event.KEY_TAB)if("select,input,button,textarea".indexOf(a.target.nodeName.toLowerCase())>-1){var b=$(a.target),c=b.up("form").getElements().findAll(function(g){return"hidden"!=g.type&&!g.disabled});b=c.indexOf(b);var e=null;if(e=a.shiftKey?b-1>=0?c[b-1]:null:b+1<c.length?c[b+1]:null){a.stop();e.focus()}}})}();function CommentsController(a){this.initialize(a)}
CommentsController.prototype={initialize:function(a){this._comments_path=a.comments_path;this._hidden_threshold=a.hidden_threshold;this._active_user=a.active_user;this._comment_ids=a.comment_ids;this._top_comments=a.top_comments;this._show_blog_comment=a.show_blog_comment;this._call_to_action=a.call_to_action},showNewCommentForm:function(a){if(a==undefined)a="";if(this._call_to_action||this._active_user.isAuthenticated()){try{holodeck.recordAnalyticsEvent("Comments","Add")}catch(b){}$("commentutility")&&
Element.hide("commentutility"+a);Element.show("comment_new"+a)}},showReplyToCommentForm:function(a){$("reply_to_comment").show();$("comment_"+a).insert($("reply_to_comment"));$("response_content").value="";a=a;$("reply_to_comment_submit").stopObserving("click");$("reply_to_comment_submit").on("click",function(){comments_controller.replyToComment(a)})},showEditReplyToCommentForm:function(a){$("reply_to_comment").show();$("comment_response_"+a).insert($("reply_to_comment"));$("response_content").value=
$("comment_response_content_"+a).innerHTML;a=a;$("reply_to_comment_submit").stopObserving("click");$("reply_to_comment_submit").on("click",function(){comments_controller.replyToComment(a)})},resetNewCommentForm:function(a){if(a==undefined)a="";$("comment_content"+a).value="";$("comment_errors"+a).hide();Element.hide("comment_new"+a);this.reenableNewCommentForm(a);$("commentutility")&&$("commentutility"+a).show()},reenableNewCommentForm:function(a){if(a==undefined)a="";Element.hide("comment_indicator"+
a);$("post_comment_submit"+a).disabled=false},submitNewCommentForm:function(a,b){if(b==undefined)b="";var c=this;Element.show("comment_indicator"+b);$("post_comment_submit"+b).disabled=true;c._call_to_action&&$("post_comment_submit"+b).hide();$(a).request({method:"post",onSuccess:function(e){var g;if(c._call_to_action){(g=$("added_comments_list"))&&g.insert({top:e.responseText});window.location.hash="_";window.location.hash="recent_comments";e=g.down();new Effect.Highlight(e,{});active_user.isFacebookConnected()||
e.insert({after:$("facebook_comment_upsell").show()})}else(g=$$(".comment_list").first())&&g.insert(e.responseText);$("no_comments").hide();c.resetNewCommentForm(b);if(c._call_to_action){$("comment_indicator"+b).hide();$("post_comment_submit"+b).show();c.showNewCommentForm(b)}urchinTracker("/new_comment")},on400:function(e){c.showNewCommentErrors(e.responseText,b)},on500:function(){c.showNewCommentErrors("A server error occured.",b)}})},showNewCommentErrors:function(a,b){if(b==undefined)b="";var c=
$("comment_errors"+b);c.show();c.update(a);if(this._call_to_action){$("comment_indicator"+b).hide();$("post_comment_submit"+b).show()}this.reenableNewCommentForm(b)},userSilenced:function(){var a=$("comment_user_silenced");$("comment_add_a_comment").hide();a.update(this._active_user.silencedMessage());a.show()},checkUserSilenced:function(){this._active_user.isSilenced()&&this.userSilenced()},lightUpSingleComment:function(a,b){a=$("comment_"+a);a.removeClassName("rated_negative");a.removeClassName("rated_positive");
a.addClassName(b?"rated_positive":"rated_negative")},currentRating:function(a){var b=$("comment_current_rating_"+a).innerHTML;return isNaN(b)?NaN:parseInt($("comment_current_rating_"+a).innerHTML,10)},opinionForComment:function(a){a=$("comment_"+a);return a.hasClassName("rated_negative")?false:a.hasClassName("rated_positive")?true:null},rateComment:function(a,b){var c=this.opinionForComment(a);if(c!==b){var e=this.currentRating(a);if(c===true)e-=1;else if(c===false)e+=1;if(b===true)e+=1;else if(b===
false)e-=1;c=$("comment_"+a);$("comment_rating_area_"+a);var g=this;this.hideRatingLinks(a);isNaN(e)||$("comment_current_rating_"+a).update(e);c.removeClassName("below_threshold");c.removeClassName("above_threshold");c.addClassName(e>this._hidden_threshold||isNaN(e)?"above_threshold":"below_threshold");this.lightUpSingleComment(a,b);new Ajax.Request(this._comments_path+"/"+a+"/ratings.js",{parameters:{opinion:b},onComplete:function(){g.showRatingLinks(a)}})}},flagComment:function(a){var b=this;this.hideRatingLinks(a);
new Ajax.Request(this._comments_path+"/"+a+"/flaggings.js",{onComplete:function(){b.showRatingLinks(a);$("comment_flagged_"+a).show();$("comment_flagged_"+a).update("<span>This comment has been flagged for review.</span>")}})},hideRatingLinks:function(a){var b=$("comment_rating_links_"+a),c=$("flag_indicator_"+a);a=$("comment_status_"+a);c.show();a.hide();b.hide()},showRatingLinks:function(a){var b=$("comment_rating_links_"+a),c=$("flag_indicator_"+a);a=$("comment_status_"+a);c.hide();b.show();a.show()},
showCommentContent:function(a){Element.hide("show_comment_content_"+a);Element.show("hide_comment_content_"+a);Element.show("comment_content_"+a)},hideCommentContent:function(a){Element.show("show_comment_content_"+a);Element.hide("hide_comment_content_"+a);Element.hide("comment_content_"+a)},removeComment:function(a){var b=this._comments_path+"/"+a+".js",c=$("flag_indicator_"+a),e=$("remove_comment_"+a),g=$("comment_"+a);c.show();e.hide();new Ajax.Request(b,{method:"delete",onSuccess:function(){g.remove()}})},
spamComment:function(a){var b=this._comments_path+"/"+a+"/spam.js",c=$("flag_indicator_"+a),e=$("spam_comment_"+a),g=$("comment_"+a);c.show();e.hide();new Ajax.Request(b,{method:"post",onSuccess:function(){g.remove()}})},replyToComment:function(a){var b=this._comments_path+"/"+a+"/reply",c=$("flag_indicator_"+a),e=$("reply_to_comment_"+a),g=$("comment_"+a);c.show();e&&e.hide();new Ajax.Request(b,{method:"post",parameters:{response_content:$("response_content").value,show_blog_comment:this._show_blog_comment},
onSuccess:function(l){var r=$("reply_to_comment");r.hide();$$(".user_message").last().insert({after:r});g.replace(l.responseText);comments_controller.showAdminControls();c.hide()}})},cancelReply:function(){$("reply_to_comment").hide();$("response_content").value=""},checkUserRatingStatus:function(){var a=this;(function(){new Ajax.Request(this._active_user.accountUrl()+"/comment_ratings.json",{method:"get",parameters:{comment_ids:Object.toJSON(this._comment_ids),game_id:this._active_user.gameId(),
top_comments:this._top_comments?true:""},onSuccess:function(b){a.lightUpComments(b.responseJSON)}})}).bind(this).runWhenDomLoaded(true)},clearReply:function(a){var b=this._comments_path+"/"+a+"/clear_reply",c=$("flag_indicator_"+a),e=$("clear_reply_to_comment_"+a),g=$("reply_to_comment_"+a),l=$("comment_"+a);c.show();e.hide();new Ajax.Request(b,{method:"post",onSuccess:function(){c.hide();g.show();l.down(".comment_reply").remove()}})},lightUpComments:function(a){var b=this;$H(a).each(function(c){b.lightUpSingleComment(c.key,
c.value)})},showAdminControls:function(){if(active_user.isAdmin()){$$(".admin_controls").each(Element.show);$$(".developer_controls").each(Element.show)}else active_user.isDeveloperOfGame()&&$$(".developer_controls").each(Element.show)}};FeedbackFormBuilder=Class.create();FeedbackFormType=Class.create();FeedbackFormType.prototype={initialize:function(a,b,c,e,g){this.type=a;this.property_class=b;this.desc_text_area=c;this.sidebar_id=e;this.login_required=g}};FeedbackFormBuilder.FEEDBACK_DESCRIPTION_TEXT_LIMIT=2E3;
FeedbackFormBuilder.selectAccomplishment=function(a){if(a=="")$("missing_accomplishment_options").innerHTML="Please select a game";else{$("missing_accomplishment_options").hide();$("missing_accomplishment_spinner").show();new Ajax.Request("/feedbacks/missing_accomplishments_for.json?game_id="+a,{method:"get",onComplete:function(b){$("missing_accomplishment_spinner").hide();$("missing_accomplishment_options").update(b.responseJSON.select_html).show()}})}};
FeedbackFormBuilder.prototype={initialize:function(a){var b=$("select_topic").options[$("select_topic").selectedIndex].value;this.currentTextArea=null;this._character_count_message_node=$("character_count_message");this._character_count_node=this._character_count_message_node.down("#character_count");this._character_count_node.update(FeedbackFormBuilder.FEEDBACK_DESCRIPTION_TEXT_LIMIT);this._addCharCounterToTextAreas();this._element=$(a);this._classes=new Array("abuse","general","game_missing_accomplishment",
"game_bug");this.types=[new FeedbackFormType("Feedback","general","feedback_general_content","general_feedback_instructions"),new FeedbackFormType("BugReport","general","feedback_general_content","general_bug_feedback_instructions"),new FeedbackFormType("FeatureRequest","general","feedback_general_content","general_feedback_instructions"),new FeedbackFormType("AdvertisingInquiryFeedback","general","feedback_general_content","advertiser_feedback_instructions"),new FeedbackFormType("MediaOpportunityFeedback",
"general","feedback_general_content","media_opportunity_feedback_instructions"),new FeedbackFormType("ArcadeAppFeedback","general","feedback_general_content","kongregate_arcade_feedback_instructions"),new FeedbackFormType("KredsInquiryFeedback","general","feedback_general_content","kreds_inquiry_feedback_instructions"),new FeedbackFormType("OtherInquiryFeedback","general","feedback_general_content","general_feedback_instructions"),new FeedbackFormType("DevelopmentSupportFeedback","general","feedback_general_content",
"developer_support_feedback_instructions"),new FeedbackFormType("AbusiveUser","abuse","feedback_abuse_content","abusive_user_feedback_instructions"),new FeedbackFormType("MissingAccomplishmentFeedback","game_missing_accomplishment","feedback_missing_accomplishment_content","missing_accomplishment_feedback_instructions",true),new FeedbackFormType("GameBugReport","game_bug","feedback_game_bug_content","game_bug_feedback_instructions"),new FeedbackFormType("PowerupRewardsFeedback","general","feedback_general_content",
"power_up_rewards_instructions")];this._text_area_names=this.types.map(function(c){return c.desc_text_area}).uniq();this._sidebar_ids=this.types.map(function(c){return c.sidebar_id}).uniq();this._clearContentExcept(b);this._hideAll();this.subjectChanged();this._setSubmitState()},_findTypeByTypeStr:function(a){return this.types.find(function(b){return b.type==a})},_clearContentExcept:function(a){var b=this._findTypeByTypeStr(a);this._text_area_names.each(function(c){if(c!=b.desc_text_area)$(c).value=
""})},_hideAll:function(){this._classes.each(function(a){this._getElementsForClass(a).each(function(b){b.hide()})}.bind(this));this._hideSidebars()},_hideSidebars:function(){this._sidebar_ids.each(function(a){$(a).hide()})},_showType:function(a){this.type=a=this._findTypeByTypeStr(a);this.showElementsOfClass(a.property_class);this._showSidebarForType(a);this.copyContent(a.desc_text_area)},_showSidebarForType:function(a){$(a.sidebar_id).show()},copyContent:function(a){a=$(a);if(this.currentTextArea&&
this.currentTextArea!=a){a.value=this.currentTextArea.value;this.currentTextArea.value=""}this.currentTextArea=a},_setSubmitState:function(){if($F("select_topic")=="Feedback"){$("feedback_submit_button").disable();$("feedback_submission_warning").show()}else{$("feedback_submit_button").enable();$("feedback_submission_warning").hide()}},_getElementsForClass:function(a){return this._element.select("."+a)},showElementsOfClass:function(a){this._getElementsForClass(a).each(function(b){b.show()})},select:function(a){this._hideAll();
this._showType(a)},_loginRequired:function(){return typeof this.type!="undefined"&&this.type.login_required},_enableForm:function(){$("login_message").hide();$("feedback_form_form").enable();$("feedback_submit_button").show()},_disableForm:function(){$("login_message").show();$("feedback_form_form").disable();$("select_topic").enable();$("feedback_submit_button").hide()},subjectChanged:function(){var a=$F("select_topic");this.select(a);this._loginRequired()&&!active_user.isAuthenticated()?this._disableForm():
this._enableForm();var b=$("chooser"),c=$("feedback_game_id");c.onchange=function(){};a=="GameBugReport"&&$("game_bug_input_cell").appendChild(b);if(a=="MissingAccomplishmentFeedback"){$("game_missing_accomplishment_input_cell").appendChild(b);c.onchange=function(){FeedbackFormBuilder.selectAccomplishment(c.value)};c.value!=""&&c.onchange()}this._setSubmitState()},_spin:function(){$("feedback_form_content").style.display="none";$("feedback_spinner").style.display="block"},_unspin:function(){$("feedback_spinner").style.display=
"none";$("feedback_form_content").style.display="block"},_addCharCounterToTextAreas:function(){var a=this;$$(".feedback_text_area").each(function(b){b.observe("keyup",a._checkCharCount)})},_checkCharCount:function(){var a=this.getValue().length;a=FeedbackFormBuilder.FEEDBACK_DESCRIPTION_TEXT_LIMIT-a;feedbackFormBuilder._character_count_node.update(a);a<0?feedbackFormBuilder._character_count_message_node.addClassName("negative"):feedbackFormBuilder._character_count_message_node.removeClassName("negative")}};Function.prototype.runWhenDomLoaded=function(a){if(a&&window.gameLoadObserver)this.runWhenGameLoaded();else if(document.loaded)this.defer();else{var b=this;document.observe("dom:loaded",function(){b()})}};function GameLoadObserver(a){this.initialize(a)}
GameLoadObserver.prototype=function(){return{initialize:function(a){this._loaded=false;this._startTime=(new Date).getTime();this._timeout=a.timeout||3E3;this._interval=null;this._debug=a.debug;this._queue=[];this.startObserving.bind(this).runWhenDomLoaded()},percentLoaded:function(){if($("gamediv"))try{return $("gamediv").PercentLoaded()}catch(a){return-1}},observeGameLoad:function(){var a=(new Date).getTime()-this._startTime,b=a>=this._timeout,c=this.percentLoaded();if(c>0||b){this._debug&&console.log("Firing onGameLoaded, percentLoaded: "+
c+", timeElapsed: "+a+", timedOut: "+b);this.onGameLoaded()}else if(c<0){this._debug&&console.log("Firing onGameLoaded, no flash gamediv found, percentLoaded: "+c+", timeElapsed: "+a);this.onGameLoaded()}},onGameLoaded:function(){if(!this._loaded){this._loaded=true;clearInterval(this._interval);this._queue.each(function(a){a.defer()});this._queue=[]}},runWhenGameLoaded:function(a){this._loaded?a.defer():this._queue.push(a)},startObserving:function(){this._interval&&clearInterval(this._interval);this._interval=
setInterval(this.observeGameLoad.bind(this),100)}}}();Function.prototype.runWhenGameLoaded=function(){window.gameLoadObserver?window.gameLoadObserver.runWhenGameLoaded(this):this.runWhenDomLoaded()};Cookie={set:function(a,b,c,e){a=encodeURIComponent(a)+"="+encodeURIComponent(b||"");if(c!==undefined){b=new Date;b.setTime(b.getTime()+864E5*parseFloat(c));a+="; expires="+b.toGMTString()}a+=e?"; path="+e:"; path=/";return document.cookie=a},setWithDate:function(a,b,c){a=encodeURIComponent(a)+"="+encodeURIComponent(b||"");if(c!==undefined)a+="; expires="+c.toGMTString();a+="; path=/";return document.cookie=a},get:function(a){return(a=document.cookie.match(new RegExp("(^|;)\\s*"+encodeURIComponent(a)+
"=([^;\\s]*)")))?decodeURIComponent(a[2].gsub(/\+/," ")):null},erase:function(a,b){var c=Cookie.get(a)||true;Cookie.set(a,"",-1,b);return c},accept:function(){if(typeof navigator.cookieEnabled=="boolean")return navigator.cookieEnabled;Cookie.set("_test","1");return Cookie.erase("_test")==="1"}};var swfobject=function(){function a(){if(!ta){try{var T=aa.getElementsByTagName("body")[0].appendChild(Q("span"));T.parentNode.removeChild(T)}catch(Y){return}ta=true;T=ia.length;for(var oa=0;oa<T;oa++)ia[oa]()}}function b(T){if(ta)T();else ia[ia.length]=T}function c(T){if(typeof O.addEventListener!=z)O.addEventListener("load",T,false);else if(typeof aa.addEventListener!=z)aa.addEventListener("load",T,false);else if(typeof O.attachEvent!=z)j(O,"onload",T);else if(typeof O.onload=="function"){var Y=
O.onload;O.onload=function(){Y();T()}}else O.onload=T}function e(){P?g():l()}function g(){var T=aa.getElementsByTagName("body")[0],Y=Q(N);Y.setAttribute("type",U);var oa=T.appendChild(Y);if(oa){var sa=0;(function(){if(typeof oa.GetVariable!=z){var I=oa.GetVariable("$version");if(I){I=I.split(" ")[1].split(",");qa.pv=[parseInt(I[0],10),parseInt(I[1],10),parseInt(I[2],10)]}}else if(sa<10){sa++;setTimeout(arguments.callee,10);return}T.removeChild(Y);oa=null;l()})()}else l()}function l(){var T=W.length;
if(T>0)for(var Y=0;Y<T;Y++){var oa=W[Y].id,sa=W[Y].callbackFn,I={success:false,id:oa};if(qa.pv[0]>0){var X=A(oa);if(X)if(p(W[Y].swfVersion)&&!(qa.wk&&qa.wk<312)){B(oa,true);if(sa){I.success=true;I.ref=r(oa);sa(I)}}else if(W[Y].expressInstall&&u()){I={};I.data=W[Y].expressInstall;I.width=X.getAttribute("width")||"0";I.height=X.getAttribute("height")||"0";if(X.getAttribute("class"))I.styleclass=X.getAttribute("class");if(X.getAttribute("align"))I.align=X.getAttribute("align");var Ba={};X=X.getElementsByTagName("param");
for(var Ha=X.length,Pa=0;Pa<Ha;Pa++)if(X[Pa].getAttribute("name").toLowerCase()!="movie")Ba[X[Pa].getAttribute("name")]=X[Pa].getAttribute("value");t(I,Ba,oa,sa)}else{v(X);sa&&sa(I)}}else{B(oa,true);if(sa){if((oa=r(oa))&&typeof oa.SetVariable!=z){I.success=true;I.ref=oa}sa(I)}}}}function r(T){var Y=null;if((T=A(T))&&T.nodeName=="OBJECT")if(typeof T.SetVariable!=z)Y=T;else if(T=T.getElementsByTagName(N)[0])Y=T;return Y}function u(){return!Ga&&p("6.0.65")&&(qa.win||qa.mac)&&!(qa.wk&&qa.wk<312)}function t(T,
Y,oa,sa){Ga=true;fa=sa||null;za={success:false,id:oa};var I=A(oa);if(I){if(I.nodeName=="OBJECT"){ra=G(I);ga=null}else{ra=I;ga=oa}T.id=E;if(typeof T.width==z||!/%$/.test(T.width)&&parseInt(T.width,10)<310)T.width="310";if(typeof T.height==z||!/%$/.test(T.height)&&parseInt(T.height,10)<137)T.height="137";aa.title=aa.title.slice(0,47)+" - Flash Player Installation";sa=qa.ie&&qa.win?"ActiveX":"PlugIn";sa="MMredirectURL="+encodeURI(O.location).toString().replace(/&/g,"%26")+"&MMplayerType="+sa+"&MMdoctitle="+
aa.title;if(typeof Y.flashvars!=z)Y.flashvars+="&"+sa;else Y.flashvars=sa;if(qa.ie&&qa.win&&I.readyState!=4){sa=Q("div");oa+="SWFObjectNew";sa.setAttribute("id",oa);I.parentNode.insertBefore(sa,I);I.style.display="none";(function(){I.readyState==4?I.parentNode.removeChild(I):setTimeout(arguments.callee,10)})()}q(T,Y,oa)}}function v(T){if(qa.ie&&qa.win&&T.readyState!=4){var Y=Q("div");T.parentNode.insertBefore(Y,T);Y.parentNode.replaceChild(G(T),Y);T.style.display="none";(function(){T.readyState==
4?T.parentNode.removeChild(T):setTimeout(arguments.callee,10)})()}else T.parentNode.replaceChild(G(T),T)}function G(T){var Y=Q("div");if(qa.win&&qa.ie)Y.innerHTML=T.innerHTML;else if(T=T.getElementsByTagName(N)[0])if(T=T.childNodes)for(var oa=T.length,sa=0;sa<oa;sa++)!(T[sa].nodeType==1&&T[sa].nodeName=="PARAM")&&T[sa].nodeType!=8&&Y.appendChild(T[sa].cloneNode(true));return Y}function q(T,Y,oa){var sa,I=A(oa);if(qa.wk&&qa.wk<312)return sa;if(I){if(typeof T.id==z)T.id=oa;if(qa.ie&&qa.win){var X="";
for(var Ba in T)if(T[Ba]!=Object.prototype[Ba])if(Ba.toLowerCase()=="data")Y.movie=T[Ba];else if(Ba.toLowerCase()=="styleclass")X+=' class="'+T[Ba]+'"';else if(Ba.toLowerCase()!="classid")X+=" "+Ba+'="'+T[Ba]+'"';Ba="";for(var Ha in Y)if(Y[Ha]!=Object.prototype[Ha])Ba+='<param name="'+Ha+'" value="'+Y[Ha]+'" />';I.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+X+">"+Ba+"</object>";V[V.length]=T.id;sa=A(T.id)}else{Ha=Q(N);Ha.setAttribute("type",U);for(X in T)if(T[X]!=Object.prototype[X])if(X.toLowerCase()==
"styleclass")Ha.setAttribute("class",T[X]);else X.toLowerCase()!="classid"&&Ha.setAttribute(X,T[X]);for(var Pa in Y)Y[Pa]!=Object.prototype[Pa]&&Pa.toLowerCase()!="movie"&&D(Ha,Pa,Y[Pa]);I.parentNode.replaceChild(Ha,I);sa=Ha}}return sa}function D(T,Y,oa){var sa=Q("param");sa.setAttribute("name",Y);sa.setAttribute("value",oa);T.appendChild(sa)}function J(T){var Y=A(T);if(Y&&Y.nodeName=="OBJECT")if(qa.ie&&qa.win){Y.style.display="none";(function(){Y.readyState==4?M(T):setTimeout(arguments.callee,10)})()}else Y.parentNode.removeChild(Y)}
function M(T){if(T=A(T)){for(var Y in T)if(typeof T[Y]=="function")T[Y]=null;T.parentNode.removeChild(T)}}function A(T){var Y=null;try{Y=aa.getElementById(T)}catch(oa){}return Y}function Q(T){return aa.createElement(T)}function j(T,Y,oa){T.attachEvent(Y,oa);ca[ca.length]=[T,Y,oa]}function p(T){var Y=qa.pv;T=T.split(".");T[0]=parseInt(T[0],10);T[1]=parseInt(T[1],10)||0;T[2]=parseInt(T[2],10)||0;return Y[0]>T[0]||Y[0]==T[0]&&Y[1]>T[1]||Y[0]==T[0]&&Y[1]==T[1]&&Y[2]>=T[2]?true:false}function w(T,Y,oa,
sa){if(!(qa.ie&&qa.mac)){var I=aa.getElementsByTagName("head")[0];if(I){oa=oa&&typeof oa=="string"?oa:"screen";if(sa)da=la=null;if(!la||da!=oa){sa=Q("style");sa.setAttribute("type","text/css");sa.setAttribute("media",oa);la=I.appendChild(sa);if(qa.ie&&qa.win&&typeof aa.styleSheets!=z&&aa.styleSheets.length>0)la=aa.styleSheets[aa.styleSheets.length-1];da=oa}if(qa.ie&&qa.win)la&&typeof la.addRule==N&&la.addRule(T,Y);else la&&typeof aa.createTextNode!=z&&la.appendChild(aa.createTextNode(T+" {"+Y+"}"))}}}
function B(T,Y){if(ha){Y=Y?"visible":"hidden";if(ta&&A(T))A(T).style.visibility=Y;else w("#"+T,"visibility:"+Y)}}function H(T){return/[\\\"<>\.;]/.exec(T)!=null&&typeof encodeURIComponent!=z?encodeURIComponent(T):T}var z="undefined",N="object",U="application/x-shockwave-flash",E="SWFObjectExprInst",O=window,aa=document,ja=navigator,P=false,ia=[e],W=[],V=[],ca=[],ra,ga,fa,za,ta=false,Ga=false,la,da,ha=true,qa=function(){var T=typeof aa.getElementById!=z&&typeof aa.getElementsByTagName!=z&&typeof aa.createElement!=
z,Y=ja.userAgent.toLowerCase(),oa=ja.platform.toLowerCase(),sa=oa?/win/.test(oa):/win/.test(Y);oa=oa?/mac/.test(oa):/mac/.test(Y);Y=/webkit/.test(Y)?parseFloat(Y.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false;var I=!+"\u000b1",X=[0,0,0],Ba=null;if(typeof ja.plugins!=z&&typeof ja.plugins["Shockwave Flash"]==N){if((Ba=ja.plugins["Shockwave Flash"].description)&&!(typeof ja.mimeTypes!=z&&ja.mimeTypes[U]&&!ja.mimeTypes[U].enabledPlugin)){P=true;I=false;Ba=Ba.replace(/^.*\s+(\S+\s+\S+$)/,"$1");X[0]=
parseInt(Ba.replace(/^(.*)\..*$/,"$1"),10);X[1]=parseInt(Ba.replace(/^.*\.(.*)\s.*$/,"$1"),10);X[2]=/[a-zA-Z]/.test(Ba)?parseInt(Ba.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else if(typeof O.ActiveXObject!=z)try{var Ha=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(Ha)if(Ba=Ha.GetVariable("$version")){I=true;Ba=Ba.split(" ")[1].split(",");X=[parseInt(Ba[0],10),parseInt(Ba[1],10),parseInt(Ba[2],10)]}}catch(Pa){}return{w3:T,pv:X,wk:Y,ie:I,win:sa,mac:oa}}();(function(){if(qa.w3){if(typeof aa.readyState!=
z&&aa.readyState=="complete"||typeof aa.readyState==z&&(aa.getElementsByTagName("body")[0]||aa.body))a();if(!ta){typeof aa.addEventListener!=z&&aa.addEventListener("DOMContentLoaded",a,false);if(qa.ie&&qa.win){aa.attachEvent("onreadystatechange",function(){if(aa.readyState=="complete"){aa.detachEvent("onreadystatechange",arguments.callee);a()}});O==top&&function(){if(!ta){try{aa.documentElement.doScroll("left")}catch(T){setTimeout(arguments.callee,0);return}a()}}()}qa.wk&&function(){ta||(/loaded|complete/.test(aa.readyState)?
a():setTimeout(arguments.callee,0))}();c(a)}}})();(function(){qa.ie&&qa.win&&window.attachEvent("onunload",function(){for(var T=ca.length,Y=0;Y<T;Y++)ca[Y][0].detachEvent(ca[Y][1],ca[Y][2]);T=V.length;for(Y=0;Y<T;Y++)J(V[Y]);for(var oa in qa)qa[oa]=null;qa=null;for(var sa in swfobject)swfobject[sa]=null;swfobject=null})})();return{registerObject:function(T,Y,oa,sa){if(qa.w3&&T&&Y){var I={};I.id=T;I.swfVersion=Y;I.expressInstall=oa;I.callbackFn=sa;W[W.length]=I;B(T,false)}else sa&&sa({success:false,
id:T})},getObjectById:function(T){if(qa.w3)return r(T)},embedSWF:function(T,Y,oa,sa,I,X,Ba,Ha,Pa,Za){var cb={success:false,id:Y};if(qa.w3&&!(qa.wk&&qa.wk<312)&&T&&Y&&oa&&sa&&I){B(Y,false);b(function(){oa+="";sa+="";var bb={};if(Pa&&typeof Pa===N)for(var Ua in Pa)bb[Ua]=Pa[Ua];bb.data=T;bb.width=oa;bb.height=sa;Ua={};if(Ha&&typeof Ha===N)for(var mb in Ha)Ua[mb]=Ha[mb];if(Ba&&typeof Ba===N)for(var pb in Ba)if(typeof Ua.flashvars!=z)Ua.flashvars+="&"+pb+"="+Ba[pb];else Ua.flashvars=pb+"="+Ba[pb];if(p(I)){mb=
q(bb,Ua,Y);bb.id==Y&&B(Y,true);cb.success=true;cb.ref=mb}else if(X&&u()){bb.data=X;t(bb,Ua,Y,Za);return}else B(Y,true);Za&&Za(cb)})}else Za&&Za(cb)},switchOffAutoHideShow:function(){ha=false},ua:qa,getFlashPlayerVersion:function(){return{major:qa.pv[0],minor:qa.pv[1],release:qa.pv[2]}},hasFlashPlayerVersion:p,createSWF:function(T,Y,oa){if(qa.w3)return q(T,Y,oa)},showExpressInstall:function(T,Y,oa,sa){qa.w3&&u()&&t(T,Y,oa,sa)},removeSWF:function(T){qa.w3&&J(T)},createCSS:function(T,Y,oa,sa){qa.w3&&
w(T,Y,oa,sa)},addDomLoadEvent:b,addLoadEvent:c,getQueryParamValue:function(T){var Y=aa.location.search||aa.location.hash;if(Y){if(/\?/.test(Y))Y=Y.split("?")[1];if(T==null)return H(Y);Y=Y.split("&");for(var oa=0;oa<Y.length;oa++)if(Y[oa].substring(0,Y[oa].indexOf("="))==T)return H(Y[oa].substring(Y[oa].indexOf("=")+1))}return""},expressInstallCallback:function(){if(Ga){var T=A(E);if(T&&ra){T.parentNode.replaceChild(ra,T);if(ga){B(ga,true);if(qa.ie&&qa.win)ra.style.display="block"}fa&&fa(za)}Ga=false}}}}();HandlerQueue=function(){function a(e){c.push(e)}function b(){for(var e=c.length-1;e>=0;e--)c[e].apply(this,arguments)}var c=[];return{add:a,handle:b}};ActiveUser=function(a){this.initialize(a)};ActiveUser.UPDATE_FREQUENCY=1200;ActiveUser.SILENCED_TEMPLATE=new Template('You have been silenced for #{until}. Click <a href="/pages/silenced">here</a> to read about silences.');ActiveUser.ADMIN_LOAD_TOOLS_PATH="/admin/load_toolbar";ActiveUser.USER_DATA_LS_KEY="kong_user_data";ActiveUser.SEEN_SHARED_CONTENT_WELCOME_LS_KEY="kong_seen_shared_content";
ActiveUser.prototype={initialize:function(a){this._dynamic_style_ele=this._holodeck=null;this._attributes=$H();this._game_attributes=$H();this._attribute_observer_handler=new HandlerQueue;this._on_authenticated_handler=new HandlerQueue;this._captured_inline_selectors=[];this._domain=a.domain;this._cdn_domain=a.cdn_domain;this._load_toolbar=a.load_toolbar;this._game_page=a.game_page;this._redirect_capture=a.redirect_capture;this._new_session_url=a.new_session_url;this.updateAttributes(a.kong_user_data);
this.split_treatments=this.getAttributes().split_treatments;this._more_game_tab_page=2;this._user_progress_bar=null;this._showing_blue_bar_message=false;if(this.isGamePage())window.gameLoadObserver=new GameLoadObserver({timeout:2E3,debug:false});this.isAuthenticated()&&this.createUpdater();this.addRunWhenAuthenticatedObserver(function(b){b.populateUserSpecificLinks();b.loadAdminToolbar();b.lightPowerupRewardsUpsell();b.initializeUserProgressBar()});this.lightUpBadgeOfTheDayOverlay();this.lightPowerupRewardsUpsell();
this._splitTreatmentPermalinks=(this._splitTreatmentPermalinks=Cookie.get("splitTreatmentPermalinks"))?this._splitTreatmentPermalinks.evalJSON():{}},setHolodeck:function(a){this._holodeck=a},createUpdater:function(){var a=this;new PeriodicalExecuter(function(){a.pullUserData(true)},ActiveUser.UPDATE_FREQUENCY)},isShowingBlueBar:function(){return this._showing_blue_bar_message},showingBlueBar:function(){this._showing_blue_bar_message=true;this._user_progress_bar&&this._user_progress_bar.hideForBlueBar()},
initializeUserProgressBar:function(){if(this.getsUserProgressBar()&&!this.isShowingBlueBar())this._user_progress_bar=new UserProgressBar(this)},getsUserProgressBar:function(){return(this.onOwnProfilePage()||!this._attributes.get("progress_bar_opt_out"))&&this._attributes.get("gets_progress_bar")},showProgressBarCompletionMessage:function(){return this._attributes.get("show_progress_completion_message")},inItemProgressBarTest:function(){return this.split_treatments.user_progress_bar.match("item")},
onOwnProfilePage:function(){return this.isAuthenticated()&&"/accounts/"+this.username().toLowerCase()==window.location.pathname.toLowerCase()},availableProgressBarSteps:function(){return this._attributes.get("available_progress_bar_steps")},progressBarPercentComplete:function(){return this._attributes.get("progress_bar_percent_complete")},pullUserData:function(a){var b=this;a="/accounts/"+this.username()+(a?"/info_update.json":"/info.json");new Ajax.Request(a,{method:"get",onSuccess:function(c){b.updateAttributes(c.responseJSON)}})},
addAttributesObserver:function(a){this._attribute_observer_handler.add(a)},addOnAuthenticatedObserver:function(a){this._on_authenticated_handler.add(a)},addRunWhenAuthenticatedObserver:function(a){this.isAuthenticated()?function(){a(this)}.bind(this).runWhenDomLoaded(true):this.addOnAuthenticatedObserver(a)},updateAttributes:function(a){var b=$.jStorage.get(ActiveUser.USER_DATA_LS_KEY),c=this._attributes.get("username");if(b&&(b.version>a.version||b.generated_at>a.generated_at))a=b;this._attributes.update(a);
this._attribute_observer_handler.handle(this);a.username&&a.username!=c&&this.usernameUpdated();$.jStorage.set(ActiveUser.USER_DATA_LS_KEY,this._attributes.toObject());this.updateNativeAppAttributes()},isNativeAppUser:function(){return!!window.kongNativeApp},sendNativeAppMessage:function(a,b){this.isNativeAppUser()&&kongNativeApp.sendMessage(Object.toJSON({opcode:a,params:b}))},closeNativeAppWindow:function(){this.sendNativeAppMessage("close",{})},updateNativeAppAttributes:function(){this.sendNativeAppMessage("user_info",
this._attributes)},updateGameAttributes:function(a){this._game_attributes.update(a)},gameCookieName:function(){if(this._game_id)return"kong_game_"+this._game_id},getAttributes:function(){return this._attributes.toObject()},getGameAttributes:function(){return this._game_attributes.toObject()},username:function(){return this._attributes.get("username")},siteVisitorUID:function(){return Cookie.get("kong_svid")},advertiserGender:function(a,b){var c=this._attributes.get("gender");if(/^m/i.match(c))return a;
else if(/^f/i.match(c))return b},videoEggGender:function(){return this.advertiserGender("m","f")},googleGender:function(){return this.advertiserGender(1,2)},googleAgeBracket:function(){var a=this._attributes.get("age");return a<=17?undefined:a<=24?1001:a<=34?1002:a<=44?1003:a<=54?1004:a<=64?1005:1006},avatarPath:function(){var a=this._attributes.get("avatar_url");if(!a)return"";if((a=a.match(/http:\/\/[a-z\.:0-9]*(.*)$/))&&a.length==2)return a[1]},id:function(){return this._attributes.get("id")},
facebook_uid:function(){return this._attributes.get("facebook_uid")},solvedCaptcha:function(){return this._attributes.get("solved_captcha")},chatUsername:function(){return this._attributes.get("chat_username")||this._attributes.get("username")},chatPassword:function(){return this._attributes.get("chat_password")},gameAuthToken:function(){return this._game_attributes.get("game_auth_token")},userVars:function(){return this._game_attributes.get("user_vars")},userVarsSig:function(){return this._game_attributes.get("user_vars_sig")},
specialChatVars:function(){return this._attributes.get("special_chat_vars")},gameplaysCount:function(){return this._attributes.get("gameplays_count")},ratingsCount:function(){return this._attributes.get("ratings_count")},gameplaysCountFromCookie:function(){try{return parseInt(Cookie.get(Holodeck.KONG_GAMEPLAYS_COOKIE_NAME)||1,10)}catch(a){return 0}},duelingGroup:function(){var a=this.specialChatVars();if(a)if(a=a.dueling_quest_data)return a.dueling_quest_slug||"";return""},age:function(){return this._attributes.get("age")},
points:function(){return this._attributes.get("points")},pointsAway:function(){return this._attributes.get("points_away")},friendsOnlineCount:function(){return this._attributes.get("friends_online_count")},friendsOnlineNames:function(){return this._attributes.get("friends_online_names")},unreadShoutsCount:function(){return this._attributes.get("unread_shouts_count")},unreadWhispersCount:function(){return this._attributes.get("unread_whispers_count")},pointsForLastLevel:function(){return this._attributes.get("points_for_last_level")},
pointsAfterLastLevel:function(){return active_user.points()-active_user.pointsForLastLevel()},level:function(){return this._attributes.get("level")},lastLevelupAt:function(){var a=this._attributes.get("last_levelup_at");return a?new Date(a):undefined},recentLevelup:function(){return this.lastLevelupAt()>new Date((new Date).getTime()-864E5)},senderNameOrEmail:function(){return this._attributes.get("sender_name_or_email")},boshEnabled:function(){return this._game_attributes.get("bosh_enabled")},compressionEnabled:function(){return this._game_attributes.get("compression_enabled")},
usernameUpdated:function(){var a=this;(function(){if(a.isAuthenticated()){a.createUpdater(a);a._on_authenticated_handler.handle(a)}}).runWhenDomLoaded(true)},isAuthenticated:function(){return!!(this.username()&&!/^Guest/.match(this.username()))},isAdmin:function(){return this.isAuthenticated()&&this._attributes.get("admin")},isPremium:function(){return!Cookie.get("admin_premium_off")&&this.isAuthenticated()&&this._attributes.get("premium")},hasPreroll:function(){return this.gameplaysCount()>0&&(this.split_treatments.split_killing_prerolls2==
undefined||this.split_treatments.split_killing_prerolls2=="control")},premiumizeUpsellNode:function(a,b,c){this.isPremium()||a.addClassName("clickable").observe("click",function(e){lightbox.prototype.initializePremiumMembershipPurchase(b,c);Event.stop(e);return false});return a},isDeveloperOfGame:function(){return document.location.pathname.split("/")[2].toLowerCase()==this.username().toLowerCase()},isDeveloper:function(){return this.isAuthenticated()&&this._attributes.get("developer")},isChatModerator:function(){return this.isAuthenticated()&&
this._attributes.get("moderator")},isSuperChatModerator:function(){return this.isAuthenticated()&&this._attributes.get("super_chat_moderator")},isCurator:function(){return this.isAuthenticated()&&this._attributes.get("curator")},isForumModerator:function(){return this.isAuthenticated()&&this._attributes.get("forum_moderator")},isGamestopEmployee:function(){return this.isAuthenticated()&&this._attributes.get("gamestop_employee")},getsAdminBar:function(){if(!this._load_toolbar)return false;return this.isChatModerator()||
this.isCurator()||this.isForumModerator()||this.isGamestopEmployee()},silencedUntil:function(){var a=this._attributes.get("silenced_until");return a?new Date(a):undefined},isSilenced:function(){var a=this.silencedUntil();return Boolean(a&&a>new Date)},silencedMessage:function(){return ActiveUser.SILENCED_TEMPLATE.evaluate({until:TimeInWordsHelper.distanceInWords(new Date,this.silencedUntil())})},populateUserSpecificLinks:function(a){var b=this.username();(a?a.select("a"):$$("a.user_specific")).each(function(c){c.href=
c.href.replace("Guest",b).replace("KongregateHolodeckTemplateUsername",b)})},addCapturedSelector:function(a,b){this._captured_inline_selectors.push(a);var c=this,e=function(g){var l=g.onclick;if(l)g.onclick=c.capturedSelectorWrapper.bindAsEventListener(c,l.bind(g),b)};$$(a).each(function(g){g.match("a, input[type=button]")?e(g):g.getElementsBySelector("a, input[type=button]").each(e);g.addClassName("lbOn")})},capturedSelectorWrapper:function(a,b,c){var e="function"==typeof b;if(this.isAuthenticated()){if(e)return b(a)}else{this._redirect_capture?
this.redirectToLogin():this.activateInlineLogin({},c);"function"==typeof b&&this.saveCapturedFunction(b.curry(a));a.preventDefault!=undefined&&Event.stop(a);return false}},activateInlineLogin:function(a,b){a||(a={});a=$H(a);var c="/accounts/new/behind_login";this._holodeck&&this._holodeck.recordAnalyticsEvent("Lightbox","Signin");this._game_id&&a.set("game_id",this._game_id);if(a.size()>0)c=c+"?"+a.toQueryString();b?lightbox.prototype.initializeKongregateLightboxFromAjax(c,{afterStaticContentLoad:function(){lightbox.prototype.toggleRegistration();
active_user.focusFormField("username")}}):lightbox.prototype.initializeKongregateLightboxFromAjax(c,{done_class_name:"lightbox_login",afterStaticContentLoad:function(){active_user.focusFormField("username")}})},focusFormField:function(a){var b=$(a);b&&setTimeout(function(){b.focus()},0)},activateKredPurchase:function(a){this.isAuthenticated()&&lightbox.prototype.initializeKredPurchase(a)},activatePasswordRecovery:function(){if(this.isGamePage())this.activateInlineLogin({recover:true});else document.location=
"/session/new?recover=true"},redirectToLogin:function(){top.location=this._new_session_url},debugLevel:function(){if(!this._debug_level)this._debug_level=this.documentLocationSearchQuery().debug_level;return this._debug_level},documentLocationSearchQuery:function(){if(!this._document_location_search_query)this._document_location_search_query=document.location.search.parseQuery();return this._document_location_search_query},seenSharedContentWelcomeKey:function(){return ActiveUser.SEEN_SHARED_CONTENT_WELCOME_LS_KEY+
"_"+this.gameId()},seenSharedContentWelcome:function(){return!!$.jStorage.get(this.seenSharedContentWelcomeKey())},setSeenSharedContentWelcome:function(a){a?$.jStorage.set(this.seenSharedContentWelcomeKey(),a):$.jStorage.deleteKey(this.seenSharedContentWelcomeKey())},saveCapturedFunction:function(a){this._capturedFunction=a},runCapturedFunction:function(){"function"==typeof this._capturedFunction&&this._capturedFunction.defer();this._capturedFunction=null},gameId:function(){return this._game_id},
setGame:function(a,b,c){this._game_id=a;this._game_resource_path=b;if(c){this.updateGameAttributes(c);Cookie.erase(this.gameCookieName(),this.gameCookiePath())}},gamePath:function(){if(!this._game_path){var a=document.location.pathname.match(/(.*)\/$/);this._game_path=a?a[1]:document.location.pathname}return this._game_path},gameResourcePath:function(){return this._game_resource_path},gameCookiePath:function(){if(!this._game_cookie_path)this._game_cookie_path=this.gamePath().match(/(.*)\/.*/)[1];
return this._game_cookie_path},referrerUrl:function(a){if(!this.isAuthenticated())return a;var b=a.match(/\?/)?"&":"?";return a+b+"referrer="+encodeURIComponent(this.username())},gameType:function(){return this._game_attributes.get("game_type")},hasRequiredPlugins:function(){return this.hasRequiredPluginsFor(this.gameType())},hasRequiredPluginsFor:function(a){if(a=="unity"){var b=false;unityObject.detectUnity(function(c){b=c=="installed"||c=="running"});return b}else return true},accountUrl:function(){return"/accounts/"+
this.username()},isGamePage:function(){return!!this._game_page},domain:function(){return this._domain},cdnDomain:function(){return this._cdn_domain},isMobileUserAgent:function(){return this._attributes.get("mobile_user_agent")},countryCode:function(){return this.valueOfSearchParameter("force_country_code")||this._attributes.get("country_code")},loadAdminToolbar:function(){this.getsAdminBar()&&new Ajax.Updater("admin_links_placeholder",ActiveUser.ADMIN_LOAD_TOOLS_PATH,{method:"get",evalScripts:true})},
recordTreatments:function(a){a&&this._attributes.get("treatments")&&this._attributes.get("treatments").each(function(b){b.analytics_slot&&a._setCustomVar(b.analytics_slot,b.group_permalink,b.treatment_permalink,2)})},valueOfSearchParameter:function(a){return location.search.parseQuery()[a]},powerupRewardsUser:function(){return this._attributes.get("powerup_rewards_user")},powerupRewardsProUser:function(){return!!this.powerupRewardsBonus()},powerupRewardsBonus:function(){return this._attributes.get("powerup_rewards_bonus")},
powerupRewardsBonusFor:function(a){a=parseInt(a,10);var b=this.powerupRewardsBonus();return a>0&&b?(a*b).ceil():a},showPowerupRewardsUpsell:function(){return"US"==this.countryCode()},occasionallyShowRegistrationLightbox:function(){!this.isAuthenticated()&&this.gameplaysCount()-1>=0&&(this.gameplaysCount()-1)%7==0&&this.activateInlineLogin({},true)},lightPowerupRewardsUpsell:function(){if(this.showPowerupRewardsUpsell()){this.createCSS(".powerup_rewards_upsell","display:block");this.createCSS(".powerup_rewards_botd_upsell",
"display:inline")}},lightUpBadgeOfTheDayOverlay:function(){var a=this._attributes.get("botd_badge_id");a&&this.createCSS(".badge_of_the_day_overlay span.botd_badge_id_"+a,"display:block")},createCSS:function(a,b){var c;if(!this._dynamic_style_ele){var e=$$("head")[0];c=new Element("style",{type:"text/css",media:"screen"});e.appendChild(c)}if(!this._dynamic_style_ele)if(Prototype.Browser.IE&&!Prototype.Browser.IE9){if((c=document.styleSheets)&&c.length>0)this._dynamic_style_ele=c[c.length-1]}else this._dynamic_style_ele=
c;if(Prototype.Browser.IE&&!Prototype.Browser.IE9)this._dynamic_style_ele&&typeof this._dynamic_style_ele.addRule=="object"&&this._dynamic_style_ele.addRule(a,b);else this._dynamic_style_ele&&typeof document.createTextNode!="undefined"&&this._dynamic_style_ele.appendChild(document.createTextNode(a+" {"+b+"}"))},invokeConversionIframe:function(){Cookie.erase("_kong_acct_created","/");try{$("conversion_dynamic_iframe_target").update((new Template($("conversion_dynamic_iframe").innerHTML)).evaluate())}catch(a){}},
ignoreBounceMessage:function(a,b){$(a).up(".sitemessage").hide();new Ajax.Request(b)},shoutForGame:function(a,b){a="/accounts/"+this.username()+"/permissions_for_game.json?game_id="+a;new Ajax.Request(a,{method:"get",onSuccess:function(c){json=c.responseJSON;allow=json!=null&&json.always_allow_shouts;b(allow)}})},kredBuyerType:function(){return this._attributes.get("kred_buyer_type")},isFacebookConnected:function(){return!!this._attributes.get("facebook_uid")},facebookAccessTokenNeedsUpdate:function(){return!!this._attributes.get("access_token_needs_update")},
facebookStatus:function(){return this._attributes.get("facebook_status")},facebookLoginUrl:function(){return this._attributes.get("facebook_url")},gameTagTreatment:function(){return this.split_treatments.tags_replace_description},hasGoogleADayForToday:function(){if(!this.isAuthenticated())return false;return!!this._attributes.get("gad_earned")},updateMoreGames:function(){if(!this.isAuthenticated())if(holodeck._permissions.microtransaction_api)holodeck.showSignupTab();else{holodeck.showMoreGamesTab();
holodeck.showSignupTab();new Ajax.Updater("replace_more_games","/recommended_games/show_more_tab",{parameters:{game_id:this.gameId(),show_more_tab:true},method:"get",onSuccess:function(){$("main_tab_set").select("a").each(function(a){$("more_games_tab")==undefined&&a.observe("click",function(){$("more_games_tab_pane").hide();clearTimeout(active_user.changeTabTimeout)})});holodeck.showSignupTab();active_user.changeTabTimeout=setTimeout(function(){holodeck.showMoreGamesTab()},3E5)},onFailure:function(){holodeck.showSignupTab()}})}},
moreGamesNextPage:function(){new Ajax.Request("/recommended_games/show_more_tab",{parameters:{game_id:this.gameId(),show_more_tab:true,page:this._more_game_tab_page},method:"get",onSuccess:function(a){active_user._more_game_tab_page+=1;$$(".more_games_load_btn")[0].insert({before:a.responseText});if(active_user._more_game_tab_page*4<48)$("load_more_games_button").restore();else{$("load_more_games_button").hide();$$(".more_games_load_btn").each(Element.hide)}}})},getSplitTreatmentPermalink:function(a,
b,c){if(this._splitTreatmentPermalinks[a])b(this._splitTreatmentPermalinks[a]);else new Ajax.Request("/site_visitor_split_treatments/"+a,{method:"get",onSuccess:function(e){b(e.responseText);active_user._splitTreatmentPermalinks[a]=e.responseText;Cookie.set("splitTreatmentPermalinks",Object.toJSON(active_user._splitTreatmentPermalinks))},onFailure:c})},favoritesCount:function(){return this._attributes.get("favorites_count")},playLatersCount:function(){return this._attributes.get("play_laters_count")},
getsImprovedBrowsing:function(){return this._attributes.get("gets_improved_browsing")},src:function(){return this._attributes.get("src")},crazyEggSplitTreatment:function(){return this._attributes.get("crazy_egg_split_treatment")},showFacebookRegistrationTab:function(){return this._attributes.get("show_facebook_registration")||false},gameSplitTreatments:function(a){var b=[];$H(this.split_treatments).each(function(c){c.key.substring(0,a.length)===a&&b.push(c.key+","+c.value)});return b.size()==0?"none":
b.join("|")}};Function.prototype.bufferingFunction=function(a,b){var c=Function.preconditionBufferingGroup(a,b),e=this,g=function(){c.push(e,arguments,this,g,b);a(this)&&c.unwind()};return g};
Function.preconditionBufferingGroup=function(a,b){if(!this._buffering_function_groups)this._buffering_function_groups=[];if(undefined===a._buffering_group_id)a._buffering_group_id=this._buffering_function_groups.length;a=a._buffering_group_id;this._buffering_function_groups[a]||(this._buffering_function_groups[a]=function(){var c=[];return{push:function(e,g,l,r,u){c.push({fn:e,outerFunction:r,args:g,bind_to:l,timestamp:new Date,tag:u})},unwind:function(){if(c.length){var e;e=function(g,l){var r=function(u,
t){if(u.localeCompare&&t.localeCompare)return u.localeCompare(t);if(u>t)return-1;if(u<t)return 1;return 0};return r(g.tag,l.tag)||r(g.timestamp,l.timestamp)};if(b instanceof Function)c.sort(b);else b&&c.sort(e);for(;e=c.shift();)e.fn.apply(e.bind_to,e.args)}}}}());return this._buffering_function_groups[a]};Function.unbufferBufferingGroup=function(a){a._buffering_group_id&&Function.preconditionBufferingGroup(a).unwind()};var hookup_hintables=function(){$$(".hintable").each(function(a){var b=a.title,c=a.form,e=c.restoreHints,g=function(){if(b==a.value||""==a.value){a.value="";a.removeClassName("hinted_value")}},l=function(){if(""==a.value){a.value=b;a.addClassName("hinted_value")}},r=a.form.onsubmit;l();a.observe("click",g);a.observe("focus",g);a.observe("blur",l);a.restoreHint=l;c.onsubmit=function(){var u=true;g();if(r)try{u=r.apply(this,arguments)}catch(t){}l();return u};c.restoreHints=function(){l();e&&e.apply(this,
arguments)}})};document.observe("dom:loaded",function(){hookup_hintables()});Ajax.CachedAutocompleter=Class.create();
Object.extend(Object.extend(Ajax.CachedAutocompleter.prototype,Autocompleter.Base.prototype),{initialize:function(a,b,c,e){this.baseInitialize(a,b,e);this.options.asynchronous=true;this.options.onComplete=this.onComplete.bind(this);this.options.defaultParams=this.options.parameters||null;this.url=c;this.cache={};if(this.options.forceActivation){Event.stopObserving(this.element,"keydown");Event.observe(this.element,"keydown",this.onKeyPressWithForcedActivation.bindAsEventListener(this));Event.observe(this.element,
"focus",this.onFocus.bindAsEventListener(this))}},getUpdatedChoices:function(){var a=this.getToken().toLowerCase();if(this.cache[a])this.updateChoices(this.cache[a]);else{this.startIndicator();entry=encodeURIComponent(this.options.paramName)+"="+encodeURIComponent(a);this.options.parameters=this.options.callback?this.options.callback(this.element,entry):entry;if(this.options.defaultParams)this.options.parameters+="&"+this.options.defaultParams;new Ajax.Request(this.url,this.options)}},onComplete:function(a){this.updateChoices(this.cache[a.request.parameters.search]=
a.responseText)},markPrevious:function(){if(this.index>0)this.index--;else{this.index=this.entryCount-1;this.update.scrollTop=this.update.scrollHeight}selection=this.getEntry(this.index);selection_top=selection.offsetTop;if(selection_top<this.update.scrollTop)this.update.scrollTop-=selection.offsetHeight},markNext:function(){if(this.index<this.entryCount-1)this.index++;else{this.index=0;this.update.scrollTop=0}selection=this.getEntry(this.index);selection_bottom=selection.offsetTop+selection.offsetHeight;
if(selection_bottom>this.update.scrollTop+this.update.offsetHeight)this.update.scrollTop+=selection.offsetHeight},selectEntry:function(){if(this.index>=0){this.active=false;this.updateElement(this.getCurrentEntry())}else{try{this.element.form.onsubmit()}catch(a){}this.element.form.submit()}},onFocus:function(){this.hasFocus=true;if(this.oldElementValue==this.element.value&&this.element.value.length>=this.options.minChars)this.entryCount>0?this.render():this.show()},onKeyPressWithForcedActivation:function(a){var b=
a.keyCode==Event.KEY_TAB||a.keyCode==Event.KEY_RETURN||Prototype.Browser.WebKit>0&&a.keyCode==0,c=this.element.value.length>=this.options.minChars;if(!this.active&&b&&c){Event.stop(a);this.observer&&clearTimeout(this.observer);this.changed=false;this.hasFocus=true;this.getUpdatedChoices()}else this.onKeyPress(a)},updateChoices:function(a){if(!this.changed&&this.hasFocus){this.update.innerHTML=a;Element.cleanWhitespace(this.update);Element.cleanWhitespace(this.update.down());if(this.update.firstChild&&
this.update.down().childNodes){this.entryCount=this.update.down().childNodes.length;for(a=0;a<this.entryCount;a++){var b=this.getEntry(a);b.autocompleteIndex=a;this.addObservers(b)}}else this.entryCount=0;this.stopIndicator();this.update.scrollTop=0;this.index=this.options.noAutoDefault?-1:0;if(this.entryCount==1&&this.options.autoSelect){this.selectEntry();this.hide()}else this.render()}}});Number.prototype.withDelimiters=function(a,b){a||(a=",");b||(b=1E3);for(var c=[],e=Math.floor(this);e;){c.unshift(e%b);e=Math.floor(e/b)}return[c.shift()].concat(c.map(function(g){return g.toPaddedString((b-1+"").length)})).join(a)};Ajax.Poller=function(a,b,c,e){this.initialize(a,b,c,e)};
Ajax.Poller.prototype={initialize:function(a,b,c,e){this._stopped=true;c=c||5E3;e=e||3E4;var g=this,l=Object.extend(Object.extend({method:"get"},b),{on202:function(){if(!g._stopped){setTimeout(g._poll,c);b.on202&&b.on202.apply(b,arguments)}},onFailure:function(){if(!g._stopped){setTimeout(g._poll,e);b.onFailure&&b.onFailure.apply(b,arguments)}}});this._poll=function(){new Ajax.Request(a,l)}},start:function(a){this._stopped=false;setTimeout(this._poll.bind(this),a||0)},stop:function(){this._stopped=
true}};Form.serializeElements=function(a,b){if(typeof b!="object")b={hash:!!b};else if(Object.isUndefined(b.hash))b.hash=true;var c,e,g=false,l=b.submit,r;if(b.hash){b={};r=function(u,t,v){if(t in u){Object.isArray(u[t])||(u[t]=[u[t]]);u[t].push(v)}else u[t]=v;return u}}else{b="";r=function(u,t,v){return u+(u?"&":"")+encodeURIComponent(t)+"="+encodeURIComponent(v)}}return a.inject(b,function(u,t){if(!t.disabled&&t.name){c=t.name;e=$(t).getValue();if(e!=null&&t.type!="file"&&(t.type!="submit"||!g&&l!==false&&
(!l||c==l)&&(g=true)))u=r(u,c,e)}return u})};(function(a,b){var c=0;b.prototype.toGlobalReference=function(){var e=this,g;g="_tgrFn"+c++;a[g]=function(){try{delete a[g]}catch(l){a[g]=undefined}e()};return g}})(this,Function);Prototype.Browser.IE6=navigator.userAgent.indexOf("MSIE 6.")>-1;Prototype.Browser.IE7=navigator.userAgent.indexOf("MSIE 7.")>-1;Prototype.Browser.IE8=navigator.userAgent.indexOf("MSIE 8.")>-1;Prototype.Browser.IE9=navigator.userAgent.indexOf("MSIE 9.")>-1;if(Prototype.Browser.IE8)Element._attributeTranslations.write.names["class"]=undefined;
if(Prototype.Browser.WebKit){var indexOfVersion=navigator.userAgent.indexOf("Version");if(indexOfVersion>-1){var versionString=navigator.userAgent.substr(indexOfVersion,13),version=versionString.split("/")[1];if(version){version=parseInt(version.gsub(".",""));if(version>=503)Prototype.Browser.Safari503=true}}};Element.collectTextNodesIgnoreClass=function(a,b){return $A($(a).childNodes).collect(function(c){return c.nodeType==3?c.nodeValue:c.hasChildNodes()&&!Element.hasClassName(c,b)?Element.collectTextNodesIgnoreClass(c,b):""}).flatten().join("").strip()};Element.Methods.collectTextNodesIgnoreClass=Element.collectTextNodesIgnoreClass;Element.addMethods(Element.Methods);Element.Methods.selectedOptionValue=function(a){a=$(a);if("SELECT"===a.tagName)return(a=a.select("option")[a.selectedIndex])&&a.readAttribute("value")};Element.Methods.selectOptionValue=function(a,b){a=$(a);if("SELECT"==a.tagName)a.selectedIndex=a.select("option").pluck("value").indexOf(b)};Element.addMethods(Element.Methods);(function(){function a(q){var D=document.createElement("div");q="on"+q;var J=q in D;if(!J){D.setAttribute(q,"return;");J=typeof D[q]=="function"}return J}function b(q){return Object.isElement(q)&&q.nodeName.toUpperCase()=="FORM"}function c(q){if(Object.isElement(q)){q=q.nodeName.toUpperCase();return q=="INPUT"||q=="SELECT"||q=="TEXTAREA"}else return false}function e(q){var D,J,M;if(q.fire("ajax:before").stopped)return false;if(q.tagName.toLowerCase()==="form"){D=q.readAttribute("method")||"post";
J=q.readAttribute("action");M=q.serialize({submit:q.retrieve("rails:submit-button")});q.store("rails:submit-button",null)}else{D=q.readAttribute("data-method")||"get";J=q.readAttribute("href");M={}}new Ajax.Request(J,{method:D,parameters:M,evalScripts:true,onCreate:function(A){q.fire("ajax:create",A)},onComplete:function(A){q.fire("ajax:complete",A)},onSuccess:function(A){q.fire("ajax:success",A)},onFailure:function(A){q.fire("ajax:failure",A)}});q.fire("ajax:after")}function g(q,D,J){q.insert(new Element("input",
{type:"hidden",name:D,value:J}))}function l(q){var D=q.readAttribute("data-method"),J=q.readAttribute("href"),M=$$("meta[name=csrf-param]")[0],A=$$("meta[name=csrf-token]")[0];J=new Element("form",{method:"POST",action:J,style:"display: none;"});$(q.parentNode).insert(J);D!=="post"&&g(J,"_method",D);M&&g(J,M.readAttribute("content"),A.readAttribute("content"));J.submit()}function r(q){q.select("input[type=submit][data-disable-with]").each(function(D){D.store("rails:original-value",D.getValue());D.setValue(D.readAttribute("data-disable-with")).disable()})}
function u(q){q.select("input[type=submit][data-disable-with]").each(function(D){D.setValue(D.retrieve("rails:original-value")).enable()})}function t(q){q=q.readAttribute("data-confirm");return!q||confirm(q)}Ajax.Responders.register({onCreate:function(q){var D=$$("meta[name=csrf-token]")[0];if(D){if(!q.options.requestHeaders)q.options.requestHeaders={};q.options.requestHeaders["X-CSRF-Token"]=D.readAttribute("content")}}});var v=a("submit"),G=a("change");if(!v||!G)Event.Handler.prototype.initialize=
Event.Handler.prototype.initialize.wrap(function(q,D,J,M,A){q(D,J,M,A);if(!v&&this.eventName=="submit"&&!b(this.element)||!G&&this.eventName=="change"&&!c(this.element))this.eventName="emulated:"+this.eventName});v||document.on("focusin","form",function(q,D){if(!D.retrieve("emulated:submit")){D.on("submit",function(J){D.fire("emulated:submit",J,true).returnValue===false&&J.preventDefault()});D.store("emulated:submit",true)}});G||document.on("focusin","input, select, textarea",function(q,D){if(!D.retrieve("emulated:change")){D.on("change",
function(J){D.fire("emulated:change",J,true)});D.store("emulated:change",true)}});document.on("click","a[data-confirm], a[data-remote], a[data-method], input[data-confirm], button[data-confirm]",function(q,D){if(!t(D)){q.stop();return false}if(D.readAttribute("data-remote")){e(D);q.stop()}else if(D.readAttribute("data-method")){l(D);q.stop()}});document.on("click","form input[type=submit], form button[type=submit], form button:not([type])",function(q,D){q.findElement("form").store("rails:submit-button",
D.name||false)});document.on("submit",function(q){var D=q.findElement();if(!t(D)){q.stop();return false}if(D.readAttribute("data-remote")){e(D);q.stop()}else r(D)});document.on("ajax:create","form",function(q,D){D==q.findElement()&&r(D)});document.on("ajax:complete","form",function(q,D){D==q.findElement()&&u(D)})})();FocusHandler=Class.create({initialize:function(a,b,c){this._row=a;this._text=b;this._callback=c;this._elementsToInspect=a.getInputElements();this._elementToAffect=a.getHelpElement()},setText:function(a){this._text=a},_inputIsValid:undefined,onFocus:function(){FocusHandler._last_row=this._row},onBlur:function(){if(this._inputIsValid()){this._elementsToInspect.each(function(a){Element.removeClassName(a,"error_field")});Element.removeClassName(this._elementToAffect,"error_msg");this._elementToAffect.innerHTML=
"";return false}else{this._elementsToInspect.each(function(a){Element.addClassName(a,"error_field")});Element.addClassName(this._elementToAffect,"error_msg");this._elementToAffect.innerHTML=this._text;this._callback();return true}},_rowChanged:function(){return this._row!=FocusHandler._last_row}});
HelpFocusHandler=Class.create(FocusHandler,{initialize:function($super,b,c){$super(b,c,function(){})},onBlur:function(){var a=this._elementToAffect.childNodes[0];a&&a.remove();return false},_createHelpDiv:function(){this._removeHelpDiv();var a=new Element("div");a.id="help_wrapper";var b=new Element("div");b.id="help_text";a.appendChild(b);this._elementToAffect.appendChild(a);return b},_removeHelpDiv:function(){var a=this._elementToAffect.childNodes[0];a&&a.remove()},_errorsArePresent:function(){return this._elementToAffect.hasClassName("error_msg")}});
HelpTextFocusHandler=Class.create(HelpFocusHandler,{initialize:function($super,b,c){$super(b,c)},onFocus:function($super){$super();if(this._errorsArePresent())return false;if(this._text)this._createHelpDiv().innerHTML=this._text;return true}});HelpImageFocusHandler=Class.create(HelpFocusHandler,{initialize:function($super,b,c){$super(b,null);this._imageElement=c},onFocus:function($super){$super();if(this._errorsArePresent())return false;this._setImage(this._imageElement);return true},_setImage:function(a){this._createHelpDiv().appendChild(a)}});
HelpCreditCardFocusHandler=Class.create(HelpImageFocusHandler,{initialize:function($super,b,c){$super(b,c);this._setImage(this._imageElement)},onBlur:function(){}});NonEmptyInputFocusHandler=Class.create(FocusHandler,{initialize:function($super,b,c,e){$super(b,c,e)},_inputIsValid:function(){return this._row.getInputValue()!=""}});
CreditCardValidationFocusHandler=Class.create(FocusHandler,{initialize:function($super,b,c,e){$super(b,c,e)},_inputIsValid:function(){for(var a=[/^4\d{12}(\d{3})?$/,/^(5[1-5]\d{4}|677189)\d{10}$/,/^(6011|65\d{2})\d{12}$/,/^3[47]\d{13}$/],b=["visa","master_card","discover","american_express"],c=0,e=a.length;c<e;c++)if(this._row.getInputValue().match(a[c])){this._creditCardType=b[c];return true}return false},getCreditCardType:function(){return this._creditCardType}});
DateValidationFocusHandler=Class.create(FocusHandler,{initialize:function($super,b,c,e){$super(b,c,e)},_deferValidation:function(){return!this._rowChanged()&&this._isIncomplete()},_isIncomplete:function(){return!this._month()||!this._year()},_month:function(){return this._row.getInputElements()[0].value},_year:function(){return this._row.getInputElements()[1].value}});
CompleteDateValidationFocusHandler=Class.create(DateValidationFocusHandler,{initialize:function($super,b,c,e){$super(b,c,e)},_inputIsValid:function(){if(this._deferValidation())return true;return this._row.getInputValue().length>=6}});
FutureDateValidationFocusHandler=Class.create(DateValidationFocusHandler,{initialize:function($super,b,c,e){$super(b,c,e)},_getCurrentDate:function(){return new Date},_inputIsValid:function(){if(this._deferValidation())return true;var a=this._row.getInputValue().split("/"),b=this._getCurrentDate();return!(a[1]==b.getFullYear()&&a[0]<b.getMonth()+1)}});
CvvValidationFocusHandler=Class.create(FocusHandler,{initialize:function($super,b,c){this._requiredCvvLength=0;$super(b,"credit card number must be valid",c)},setCreditCardType:function(a){this._requiredCvvLength=this._getRequiredCvvLengthFor(a);this.setText("code must be "+this._requiredCvvLength+" digits")},_getRequiredCvvLengthFor:function(a){if(a=="american_express")return 4;else if(a=="test")return 1;return 3},_inputIsValid:function(){return this._row.getInputValue().length==this._requiredCvvLength}});
ValidInputCallbackFocusHandler=Class.create(FocusHandler,{initialize:function($super,b,c){$super(b,"",c)},onBlur:function(){this._callback();return false}});CreditCardForm=Class.create({initialize:function(a,b,c,e,g){this._tableElement=a;this._rows=[];this._togglePayNow=g;this._ccImages={};$H({visa:"/images/ccmark_visa.gif",master_card:"/images/ccmark_mastercard.png",american_express:"/images/ccmark_amex.png",discover:"/images/ccmark_discover.gif"}).each(function(l){this._ccImages[l.key]=new Element("img");this._ccImages[l.key].src=l.value}.bind(this));this._ccNumberRow=new FormCreditCardNumberRow("Credit card number","number","credit_card",e.number,
this._checkAllRowsForValidity.bind(this),this._propagateCreditCardType.bind(this));this._rows.push(this._ccNumberRow);this._rows.push(new FormExpirationDateRow("Expiration Date","","credit_card",b,c,e.month,e.year,this._checkAllRowsForValidity.bind(this)));this._cvvRow=new FormCvvRow("Card security code","cvv","credit_card",e.cvv,this._checkAllRowsForValidity.bind(this));this._rows.push(this._cvvRow);this._rows.push(new FormNonEmptyRow("First name","first_name","billing","Please enter your first name exactly as it appears on your credit card",
e.first_name,this._checkAllRowsForValidity.bind(this),false));this._rows.push(new FormNonEmptyRow("Last name","last_name","billing","Please enter your last name exactly as it appears on your credit card",e.last_name,this._checkAllRowsForValidity.bind(this),false));this._rows.push(new FormNonEmptyRow("Billing address","street_address","billing","Enter the street address where your statements are mailed to. (eg, 12 Maple Drive)",e.street_address,this._checkAllRowsForValidity.bind(this),false));this._rows.push(new FormCanBeEmptyRow("Billing address (cont)",
"extended_address","billing","Apartment number, suite number or department",e.extended_address,this._checkAllRowsForValidity.bind(this),false));this._rows.push(new FormNonEmptyRow("City","locality","billing","",e.locality,this._checkAllRowsForValidity.bind(this),false));this._rows.push(new FormNonEmptyRow("State/Province/Region","region","billing","",e.region,this._checkAllRowsForValidity.bind(this),false));this._rows.push(new FormNonEmptyRow("Postal Code","postal_code","billing","",e.postal_code,
this._checkAllRowsForValidity.bind(this),true));this._attachRowsToTableElement()},rowCount:function(){return this._rows.length},reportAllErrors:function(){this._rows.each(function(a){a._callAllOnBlurHandlers()})},_checkAllRowsForValidity:function(){},_enablePayNow:function(){var a=$$(".checkout_button")[0];a.disabled=false;a.removeClassName("disabled")},_disablePayNow:function(){var a=$$(".checkout_button")[0];if(this._togglePayNow){a.disabled=true;a.addClassName("disabled")}},_attachRowsToTableElement:function(){this._rows.each(function(a){Element.insert(this._tableElement,
{before:a.getElement()})}.bind(this))},_propagateCreditCardType:function(){var a=this._ccNumberRow.getCreditCardType();this._ccNumberRow._helpCreditCardFocusHandler._setImage(this._ccImages[a]);this._cvvRow.setCreditCardType(a)}});function NewWelcomeBox(a,b){this.initialize(a,b)}
NewWelcomeBox.prototype={initialize:function(a,b){var c=this;this._user=a;this._navigation=b;this.updateValues();this.addObservers();a.addRunWhenAuthenticatedObserver(this.addObservers.bind(this));a.addAttributesObserver(function(){c.updateValues()});if(Prototype.Browser.IE6)this.orig_welcome_height=$("welcome").getHeight()},addObservers:function(){var a=this._navigation,b=$("profile_hover_area");$("profile_open_control").observe("mouseover",function(c){a.onMouseOverNavTab(c.target)});b.observe("mouseover",
function(){a.onMouseOverNavTab(b)});$("profile-box-tab-pane").observe("mouseover",function(){a.clearResetTimer()})},open:function(){var a=$("profile-box-tab-pane")?$("profile-box-tab-pane"):$("guest_user_welcome_content");$("welcome").addClassName("exposed");Prototype.Browser.IE6&&$("welcome").setStyle({height:this.orig_welcome_height+$("profile-box-tab-pane").getHeight()+"px"});a.show();Shim.shimElement(a);$("progress-bar").fire("progress-bar:show")},close:function(){var a=$("profile-box-tab-pane")?
$("profile-box-tab-pane"):$("guest_user_welcome_content");$("welcome").removeClassName("exposed");a.hide();Shim.hide();Prototype.Browser.IE6&&$("welcome").setStyle({height:this.orig_welcome_height+"px"})},updateValues:function(){if(this._user.isAuthenticated()){var a=this._user.getAttributes(),b=$("welcome");b.select(".kreds_balance_or_kreds_link").each(function(r){r.update(this.kredsBalanceOrKredsLinkString(a.kreds_balance));r.href=this.kredAccountUrlOrKredsLinkUrl(a.kreds_balance)}.bind(this));
this.updateFriendInfo(b);if(this._user.getsImprovedBrowsing()){$$(".improved_nav").invoke("show");if(this._user.isAuthenticated()){var c=$("playlist_nav_link");c.addClassName("user_visible");c.show()}this.updatePlaylist();this.updateFavorites()}else $$(".control_nav").invoke("show");c=(new Element("img")).writeAttribute({id:"welcome_box_small_user_avatar",src:a.avatar_url,title:a.username,name:"user_avatar",alt:"Avatar for "+a.username,height:28,width:28});b.down("span#small_avatar_placeholder").update(c);
var e,g;if(active_user.pointsAway()==0){e=active_user.points();g=e+" points"}else{e=active_user.pointsAway();g=e+" "+(e==1?$("points_to_level_template").innerHTML:$("plural_points_to_level_template").innerHTML)}b.select(".points_to_level_up").each(function(r){r.update(e)});b.select(".points_to_level_up_text").each(function(r){r.update(g)});b.select(".total_points_amount").each(function(r){r.update(active_user.points())});b.select(".facebook_nav_item").each(function(r){active_user.isFacebookConnected()&&
r.hide()});$("welcome_box_levelbug_img_placeholder").writeAttribute({id:"welcome_levelbug","class":"spritesite levelbug level_"+a.level,title:"Level "+a.level,name:"welcome_levelbug",alt:"Levelbug"+a.level});if(a.level==65){$("profile-section-points-needed").hide();$("max-level").show()}else{c=(new Element("span")).writeAttribute({id:"welcome_next_levelbug","class":"spritesite levelbug level_"+(a.level+1),title:"Level "+(a.level+1),name:"next_welcome_levelbug",alt:"Levelbug"+(a.level+1)});b.down("span#welcome_box_next_levelbug_img_placeholder").update(c)}active_user.isDeveloper()&&
$("profile_developer_section_placeholder").replace((new Template($("developer_section_template").innerHTML)).evaluate({username:active_user.username()}));var l=new ProgressBar($("progress-bar"),{value:active_user.pointsAfterLastLevel(),maxValue:active_user.pointsAway()+active_user.pointsAfterLastLevel()});Event.observe("progress-bar","progress-bar:show",function(){l.updateDisplay()});active_user.populateUserSpecificLinks(b);b.select(".username_holder").each(function(r){r.update(active_user.username())});
this.updateMessagesLink(active_user.unreadShoutsCount(),active_user.unreadWhispersCount());c=active_user.unreadShoutsCount()+active_user.unreadWhispersCount();b.down(".my_messages").update(this.messagesCountString(c));if(c>0){$("profile_bar_messages").addClassName("alert_messages");$("profile_control_unread_message_count").update(c);$("profile_control_unread_message_count").addClassName("has_messages");$("my-messages-link").setAttribute("title",active_user.unreadShoutsCount()+" shouts, "+active_user.unreadWhispersCount()+
" whispers");active_user.unreadShoutsCount()==0&&$("my-messages-link").setAttribute("href","/accounts/"+active_user.username()+"/private_messages")}$("guest_user_welcome_content").hide();$("nav_welcome_box").show()}},updatePlaylist:function(){var a=this._user.playLatersCount();$$(".play-laters-count-link").each(function(b){b.title=a+" games in your playlist.";b.down(".play-laters-count").update(a)})},updateFavorites:function(){var a=this._user.favoritesCount();$$(".favorites-count-link").each(function(b){b.title=
a+" favorites.";b.down(".favorites-count").update(a)})},updateFriendInfo:function(a){a.select(".friends_online_count").each(function(b){b.update(active_user.friendsOnlineCount())});a.down("#friends-online-header").update(this.friendsOnlineString(active_user.friendsOnlineCount()));if(active_user.friendsOnlineCount()>0){a.select(".friends_online_link").each(function(b){b.title=active_user.friendsOnlineNames()});a.down("#friends-online-list").update(this.getFriendLinks(active_user.friendsOnlineNames())).show()}else{a.select(".friends_online_link").each(function(b){b.title=
"No friends online."});a.down("#friends-online-list").hide()}$("profile_nav_following_link").update("Friends");$("profile_nav_follower_link").update("Fans")},getFriendLinks:function(a){a=a.split(", ");var b="",c=0;for(c=0;c<a.length;c++)b+=a[c].match(/and.*!/)?"<a href='/accounts/"+active_user.getAttributes().username+"/friends'>"+a[c]+"</a>":"<a href='/accounts/"+a[c]+"'>"+a[c]+"</a>"+(c==a.length-1?"":", ");return b},friendsOnlineString:function(a){friend_count_string=tr8nProxy.translate("No friends online");
if(a>=1)friend_count_string=tr8nProxy.translate("{count|| friend, friends} online",null,{count:a});return"<span>"+friend_count_string+"</span>"},messagesCountString:function(a){strongTemplate=$("message_count_template").innerHTML;emptyTemplate=$("empty_message_count_template").innerHTML;return a>0?(new Template(strongTemplate)).evaluate(a):(new Template(emptyTemplate)).evaluate(a)},updateMessagesLink:function(a,b){var c=$("unread_messages_welcome_box_links"),e=$("unread_shouts_welcome_box_link"),
g=$("unread_whispers_welcome_box_link"),l=$("shouts_whispers_comma"),r=a>0,u=b>0,t=r&&u,v=null;if(c){if(r){e.href="/accounts/"+encodeURIComponent(this._user.username())+"/messages";v=a>1?" shouts":" shout";e.update(a+v);e.show()}if(u){g.href="/accounts/"+encodeURIComponent(this._user.username())+"/private_messages";v=b>1?" whispers":" whisper";g.update(b+v);g.show()}t&&l.show();if(r||u)c.show()}},kredsBalanceOrKredsLinkString:function(a){return 0==a?"Get Kreds!":1==a?"1 Kred":a.withDelimiters()+" Kreds"},
kredAccountUrlOrKredsLinkUrl:function(a){return 0==a?"/kreds":"/accounts/"+encodeURIComponent(this._user.username())+"/kred_account"}};Prototype.extendFrame=function(a){a=$(a);for(var b in Element.Methods)if(Object.isFunction(Element.Methods[b]))a.contentWindow.Element.prototype[b]=Element.Methods[b].methodize();return a};function Navigation(a,b){this.initialize(a,b)}Navigation.COMMUNITY_MESSAGE_TEMPLATE=new Template("Get activity updates from #{friends} and your other friends on Kongregate.");
Navigation.prototype={initialize:function(a,b){this._user=a;this._rollover_delay=0.2;this._waiting=false;this._employee_link=$("nav_employee");this._moderator_link=$("nav_moderator");this._botd={};this._botd.image=$("nav-botd-image");this._botd.border=$("nav-botd-border");this._botd.overlay=$("nav-botd-overlay");this._botd.link=$("nav-botd-link");this._botd.badge_links=$$("#nav-botd .badge_link");this._botd.description=$("nav-botd-description");this._botd.game_name=$("nav-botd-game-name");this._challenge=
{};this._challenge.name_link=$("challenge-name-link");this._challenge.tiny_image=$("challenge-tiny-image");this._challenge.description=$("challenge-description");this._challenge.links=$$(".challenge_link");this._challenge.wrapper=$("current-challenge");this._challenge.header=$("challenge-header");this._community={};this._community.message=$("community-message-holder");if(b)(b=$("new_"+b+"_nav_tab"))&&b.addClassName("active");var c=this,e=$("new_nav_wrapper"),g=$("search_bar");$(document.body).observe("mouseover",
function(l){l=$(l.target);var r=$("profile_bar");if(l&&l.descendantOf&&(r&&l.descendantOf(r)||!l.descendantOf(e)||l.descendantOf(g)))c.onMouseLeave()});$$(".nav_tab_li").each(function(l){l.subnav=l.down("dl");l.subnav&&l.observe("mouseover",function(r){var u=$(r.target);if("LI"!=r.target.tagName)u=r.target.up("li");c.onMouseOverNavTab(u)})});$$(".nav-tab-pane").each(function(l){l.observe("mouseover",function(){c.clearResetTimer()})});this.updateValues();(function(){this.activateSignIn();a.addRunWhenAuthenticatedObserver(function(){c.welcome_box=
new NewWelcomeBox(a,c);c.updateValues();c.displayRecentlyPlayedGames()})}).bind(this).runWhenDomLoaded(true);a.addOnAuthenticatedObserver(function(){$("welcome").removeClassName("expanded")});a.addAttributesObserver(function(){c.updateValues()})},displayRecentlyPlayedGames:function(){new Ajax.Request("/accounts/"+active_user.username()+"/nav_recently_played",{method:"get",onSuccess:function(a){a=$A(a.responseJSON);var b,c;if(a.size()>0){c=(new Template($("recently_played_title_template").innerHTML)).evaluate({username:active_user.username()});
b=new Template('<dd class="media mini_game"><a href="#{url}" class="img mrs"><img src="#{icon_url}" /></a><span class="mini_game_info bd"><span class="truncate_one_line"><a href="#{url}">#{title}</a></span><span class="truncate_one_line">by <a href="#{url}">#{uploaded_by_username}</a></span></span></dd>');a.each(function(e){c+=b.evaluate(e)});$("nav-game-categories").insert({before:c})}}})},activateSignIn:function(){if(!active_user.isAuthenticated()){$("guest_user_welcome_content").show();var a=$("welcome_username"),
b=$("welcome_password"),c=$("welcome"),e=new PeriodicalExecuter(function(l){var r,u;if(a.getValue().empty())$("welcome_username_label").show();else{$("welcome_username_label").hide();r=true}if(b.getValue().empty())$("welcome_password_label").show();else{$("welcome_password_label").hide();u=true}r&&u&&l.stop()},0.5);a.observe("focus",function(){c.hasClassName("expanded")||c.addClassName("expanded");$("remember_holder").show();$("forgot_holder").show();$("welcome_username_label").hide();e.stop()});
a.observe("blur",function(){a.getValue().empty()&&$("welcome_username_label").show()});b.observe("focus",function(){c.hasClassName("expanded")||c.addClassName("expanded");$("remember_holder").show();$("forgot_holder").show();$("welcome_password_label").hide();e.stop()});b.observe("blur",function(){b.getValue().empty()&&$("welcome_password_label").show()});var g=$("nav_sign_in").down("#game_id");g&&g.setValue(active_user.gameId());(function(){e.stop()}).delay(45)}},buryElement:function(a,b){a.hasClassName("non-hideable-ad")||
(Prototype.Browser.IE6||Prototype.Browser.IE7?a.hide():b.descendants().each(function(c){if("shim"!=c.id&&c.tagName=="IFRAME")if(c.src.match(/^http:/))a.hide();else{c.relativize();c.setStyle({"z-index":-1});this.buryElement(a,Prototype.extendFrame(c).contentWindow.document.body)}}.bind(this)))},activateNav:function(a){this.iCanHazReset=true;this.resetCurrentNav();$$(".ad-container").each(function(b){this.buryElement(b,b)}.bind(this));if(a.hasClassName("profile_control"))this.welcome_box&&this.welcome_box.open(a);
else{a.addClassName("hover");a.subnav.show();Shim.shimElement(a.subnav)}this.iCanHazReset=true},clearResetTimer:function(){this._reset_timer&&clearTimeout(this._reset_timer);this._reset_timer=null},resetCurrentNav:function(){if(this.iCanHazReset){this.iCanHazReset=false;this.welcome_box&&this.welcome_box.close();game_title_auto_completer&&game_title_auto_completer.hide();$("game_title").blur();Shim.hide();$$(".nav_tab_li").each(function(a){a.removeClassName("hover")});$$(".nav-tab-pane").invoke("hide");
$$(".ad-container").invoke("show")}},onMouseLeave:function(){this.clearResetTimer();this._waiting=false;this._reset_timer=this.resetCurrentNav.bind(this).delay(this._rollover_delay)},onMouseOverNavTab:function(a){this.clearResetTimer();if(this._waiting)this._reset_timer=this.activateNav.bind(this).delay(this._rollover_delay,a);else{this._waiting=true;this._reset_timer=this.activateNav.bind(this).delay(0,a)}},updateValues:function(){var a=this._user.getAttributes(),b="Badge"+a.botd_badge_id;$$(".featured_link").invoke("hide");
[["admin",active_user.isAdmin()],["user",active_user.isAuthenticated()],["gamestop_employee",active_user.isGamestopEmployee()],["mod",active_user.isChatModerator()],["guest",!active_user.isAuthenticated()]].each(function(c){var e=c[1];$$("."+c[0]+"_visible").each(function(g){if(e){g.show();$("featured_section_"+g.getAttribute("name")).show()}})});if(this._user.isAuthenticated()){this._employee_link[this._user.isGamestopEmployee()?"show":"hide"]();this._moderator_link[this._user.isChatModerator()?
"show":"hide"]();$("headerwrap").addClassName("logged_in")}else{this._employee_link.hide();this._moderator_link.hide()}if(a.current_challenge_name){this._challenge.name_link.update(a.current_challenge_name);this._challenge.tiny_image.writeAttribute({src:a.current_challenge_tiny_image});this._challenge.description.update(a.current_challenge_description);this._challenge.links.each(function(c){c.writeAttribute({href:a.current_challenge_uri})})}else{this._challenge.wrapper.hide();this._challenge.header.hide();
$("new_achievements_nav_tab").addClassName("no-challenges")}if(a.botd_icon_uri){this._botd.image.writeAttribute({src:a.botd_icon_uri,alt:b,title:b});this._botd.border.writeAttribute({alt:b,title:b});this._botd.overlay.writeAttribute({alt:b,title:b});this._botd.overlay.addClassName("botd_badge_id_"+a.botd_badge_id);this._botd.link.update(a.botd_name);this._botd.badge_links.each(function(c){c.writeAttribute({href:a.botd_game_uri})});this._botd.description&&this._botd.description.update(a.botd_description);
this._botd.game_name.update(a.botd_game_name)}if(this._user.isAuthenticated()&&a.community_friends&&a.community_friends.length>0){b=a.community_friends.collect(function(c){return"<a href='/accounts/"+c+"'>"+c+"</a>"}).join(", ");this._community.message.update(Navigation.COMMUNITY_MESSAGE_TEMPLATE.evaluate({friends:b}))}}};function Home(a){this.initialize(a)}
Home.prototype={initialize:function(a){if(a.isAuthenticated()){if(a.recentLevelup())this.showLevelupBox();else if(a.level()>=6){$("recommended_badges_holder").show();$("recommended_badges_pod_spinner").show();this.getRecommendedBadges()}else $("tip_pod").show();a.ratingsCount()>=5&&this.getRecommendedGames()}else{$("captcha_holder").show();$("signup_pod_form").down("h3").hide();$("signup_pod_form").down(".intro").hide();var b=Cookie.get("guest_accomplishments");b=b?b.split(","):[];$("guest_accomplishments").update(b.length);
$("guest_points").update(Cookie.get("guest_points")||"0");if(Cookie.get("guest_points")||b.length>0){$("guest_accomplishment_upsell").show();$("guest_signup_intro").hide()}$("registration_showcase_1").hide();$("registration_showcase_2").hide();$("registration_showcase_1").update($("signup_pod"));$("registration_showcase_2").update($("staff_picks_pod"));$("registration_showcase_1").show();$("registration_showcase_2").show();$("signup_pod").show();$("staff_picks_pod").show();a.solvedCaptcha()&&$("user_captcha_validation")&&
$("user_captcha_validation").hide()}this._recommended_badges_page=0},showLevelupBox:function(){$$(".user_level").each(function(a){a.update(active_user.level());a.addClassName("level_"+active_user.level())});$("levelup_user_points").update(tr("That's right, you're only [strong: {points_away} points away] from your next level.","",{points_away:active_user.pointsAway()}));$("levelup_user_username").update(tr("Way to go, {username}!","",{username:active_user.username()}));$("levelup_pod").show();this.getLevelupRecommendedBadges()},
getLevelupRecommendedBadges:function(){new Ajax.Request("/recommended_badges?limit=2&levelup_module=true",{method:"get",onSuccess:function(a){$("levelup_recommended_badges").update(a.responseText);$("levelup_recommended_badges").show();$("recommended_badges_pod_spinner")!=undefined&&$("recommended_badges_pod_spinner").hide()}})},setRecommendedBadgesPage:function(a){this._recommended_badges_page=a},getRecommendedBadges:function(){new Ajax.Updater({success:"recommended_badges_holder"},"/recommended_badges",
{method:"get",evalScripts:true,onSuccess:function(){$("recommended_badges_holder").up("div").appendChild($("recommended_badges_pod_spinner"));$("recommended_badges_pod_spinner").hide()}})},getRecommendedGames:function(a){var b="/recommended_games/home_page";if(a)b+="?game_to_exclude="+a;new Ajax.Updater({success:"recommended_games_pod_holder"},b,{method:"get",onSuccess:function(){$("recommended_games_pod_spinner").hide()},evalScripts:true})}};if(typeof Control=="undefined")Control={};var $proc=function(a){return typeof a=="function"?a:function(){return a}},$value=function(a){return typeof a=="function"?a():a};
Object.Event={extend:function(a){a._objectEventSetup=function(b){this._observers=this._observers||{};this._observers[b]=this._observers[b]||[]};a.observe=function(b,c){if(typeof b=="string"&&typeof c!="undefined"){this._objectEventSetup(b);this._observers[b].include(c)||this._observers[b].push(c)}else for(var e in b)this.observe(e,b[e])};a.stopObserving=function(b,c){this._objectEventSetup(b);if(b&&c)this._observers[b]=this._observers[b].without(c);else if(b)this._observers[b]=[];else this._observers=
{}};a.observeOnce=function(b,c){var e=function(){c.apply(this,arguments);this.stopObserving(b,e)}.bind(this);this._objectEventSetup(b);this._observers[b].push(e)};a.notify=function(b){this._objectEventSetup(b);var c=[],e=$A(arguments).slice(1);try{for(var g=0;g<this._observers[b].length;++g)c.push(this._observers[b][g].apply(this._observers[b][g],e)||null)}catch(l){if(l==$break)return false;else throw l;}return c};if(a.prototype){a.prototype._objectEventSetup=a._objectEventSetup;a.prototype.observe=
a.observe;a.prototype.stopObserving=a.stopObserving;a.prototype.observeOnce=a.observeOnce;a.prototype.notify=function(b){if(a.notify){var c=$A(arguments).slice(1);c.unshift(this);c.unshift(b);a.notify.apply(a,c)}this._objectEventSetup(b);c=$A(arguments).slice(1);var e=[];try{if(this.options&&this.options[b]&&typeof this.options[b]=="function")e.push(this.options[b].apply(this,c)||null);for(var g=0;g<this._observers[b].length;++g)e.push(this._observers[b][g].apply(this._observers[b][g],c)||null)}catch(l){if(l==
$break)return false;else throw l;}return e}}}};Element.addMethods({observeOnce:function(a,b,c){var e=function(){c.apply(this,arguments);Element.stopObserving(a,b,e)};Element.observe(a,b,e)}});(function(){function a(b){var c;if(b.wheelDelta)c=b.wheelDelta/120;else if(b.detail)c=-b.detail/3;if(c)if(b.element().fire("mouse:wheel",{delta:c}).stopped){b.stop();return false}}document.observe("mousewheel",a)})();
var IframeShim=Class.create({initialize:function(){this.element=new Element("iframe",{style:"position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);display:none",src:"javascript:void(0);",frameborder:0});$(document.body).insert(this.element)},hide:function(){this.element.hide();return this},show:function(){this.element.show();return this},positionUnder:function(a){a=$(a);var b=a.cumulativeOffset(),c=a.getDimensions();this.element.setStyle({left:b[0]+"px",top:b[1]+"px",width:c.width+
"px",height:c.height+"px",zIndex:a.getStyle("zIndex")-1}).show();return this},setBounds:function(a){for(prop in a)a[prop]+="px";this.element.setStyle(a);return this},destroy:function(){this.element&&this.element.remove();return this}});if(typeof Draggable!="undefined")Draggable.prototype.draw=function(a){var b=Position.cumulativeOffset(this.element);if(this.options.ghosting){var c=Position.realOffset(this.element);b[0]+=c[0]-Position.deltaX;b[1]+=c[1]-Position.deltaY}c=this.currentDelta();b[0]-=c[0];b[1]-=c[1];if(this.options.scroll&&this.options.scroll!=window&&this._isScrollChild){b[0]-=this.options.scroll.scrollLeft-this.originalScrollLeft;b[1]-=this.options.scroll.scrollTop-this.originalScrollTop}c=[0,1].map(function(t){return a[t]-
b[t]-this.offset[t]}.bind(this));if(this.options.snap)c=typeof this.options.snap=="function"?this.options.snap(c[0],c[1],this):this.options.snap instanceof Array?c.map(function(t,v){return Math.round(t/this.options.snap[v])*this.options.snap[v]}.bind(this)):c.map(function(t){return Math.round(t/this.options.snap)*this.options.snap}.bind(this));if(this.options.onDraw)this.options.onDraw.bind(this)(c);else{var e=this.element.style;if(this.options.constrainToViewport){var g=document.viewport.getDimensions(),
l=this.element.getDimensions(),r=parseInt(this.element.getStyle("margin-top")),u=parseInt(this.element.getStyle("margin-left"));g=[[0-u,0-r],[g.width-l.width-u,g.height-l.height-r]];if(!this.options.constraint||this.options.constraint=="horizontal")this.element.style.left=c[0]>=g[0][0]&&c[0]<=g[1][0]?c[0]+"px":(c[0]<g[0][0]?g[0][0]:g[1][0])+"px";if(!this.options.constraint||this.options.constraint=="vertical")this.element.style.top=c[1]>=g[0][1]&&c[1]<=g[1][1]?c[1]+"px":(c[1]<=g[0][1]?g[0][1]:g[1][1])+
"px"}else{if(!this.options.constraint||this.options.constraint=="horizontal")e.left=c[0]+"px";if(!this.options.constraint||this.options.constraint=="vertical")e.top=c[1]+"px"}if(e.visibility=="hidden")e.visibility=""}};if(typeof Prototype=="undefined")throw"Control.Window requires Prototype to be loaded.";if(typeof IframeShim=="undefined")throw"Control.Window requires IframeShim to be loaded.";if(typeof Object.Event=="undefined")throw"Control.Window requires Object.Event to be loaded.";
Control.Window=Class.create({initialize:function(a,b){Control.Window.windows.push(this);this.remoteContentLoaded=this.ajaxRequest=this.sourceContainer=this.href=this.isOpen=this.container=false;this.numberInSequence=Control.Window.windows.length+1;this.indicator=false;this.effects={fade:false,appear:false};this.indicatorEffects={fade:false,appear:false};this.options=Object.extend({beforeOpen:Prototype.emptyFunction,afterOpen:Prototype.emptyFunction,beforeClose:Prototype.emptyFunction,afterClose:Prototype.emptyFunction,
height:null,width:null,className:false,position:"center",offsetLeft:0,offsetTop:0,iframe:false,hover:false,indicator:false,closeOnClick:false,iframeshim:true,fade:false,fadeDuration:0.75,draggable:false,onDrag:Prototype.emptyFunction,resizable:false,minHeight:false,minWidth:false,maxHeight:false,maxWidth:false,onResize:Prototype.emptyFunction,constrainToViewport:false,method:"post",parameters:{},onComplete:Prototype.emptyFunction,onSuccess:Prototype.emptyFunction,onFailure:Prototype.emptyFunction,
onException:Prototype.emptyFunction,onRemoteContentLoaded:Prototype.emptyFunction,insertRemoteContentAt:false},b||{});this.indicator=this.options.indicator?$(this.options.indicator):false;if(a)if(typeof a=="string"&&a.match(Control.Window.uriRegex))this.href=a;else{this.container=$(a);this.createDefaultContainer(a);if(this.container&&(this.container.readAttribute("href")&&this.container.readAttribute("href")!=""||this.options.hover&&this.options.hover!==true)){if(this.options.hover&&this.options.hover!==
true)this.sourceContainer=$(this.options.hover);else{this.sourceContainer=this.container;this.href=this.container.readAttribute("href");if((b=this.href.match(/^#(.+)$/))&&b[1]){this.container=$(b[1]);this.href=false}else this.container=false}this.sourceContainerOpenHandler=function(c){this.open(c);c.stop();return false}.bindAsEventListener(this);this.sourceContainerCloseHandler=function(c){this.close(c)}.bindAsEventListener(this);this.sourceContainerMouseMoveHandler=function(c){this.position(c)}.bindAsEventListener(this);
if(this.options.hover){this.sourceContainer.observe("mouseenter",this.sourceContainerOpenHandler);this.sourceContainer.observe("mouseleave",this.sourceContainerCloseHandler);this.options.position=="mouse"&&this.sourceContainer.observe("mousemove",this.sourceContainerMouseMoveHandler)}else this.sourceContainer.observe("click",this.sourceContainerOpenHandler)}}this.createDefaultContainer(a);if(this.options.insertRemoteContentAt===false)this.options.insertRemoteContentAt=this.container;a={margin:0,position:"absolute",
zIndex:Control.Window.initialZIndexForWindow()};if(this.options.width)a.width=$value(this.options.width)+"px";if(this.options.height)a.height=$value(this.options.height)+"px";this.container.setStyle(a);this.options.className&&this.container.addClassName(this.options.className);this.positionHandler=this.position.bindAsEventListener(this);this.outOfBoundsPositionHandler=this.ensureInBounds.bindAsEventListener(this);this.bringToFrontHandler=this.bringToFront.bindAsEventListener(this);this.container.observe("mousedown",
this.bringToFrontHandler);this.container.hide();this.closeHandler=this.close.bindAsEventListener(this);if(this.options.iframeshim){this.iFrameShim=new IframeShim;this.iFrameShim.hide()}this.applyResizable();this.applyDraggable();Event.observe(window,"resize",this.outOfBoundsPositionHandler);this.notify("afterInitialize")},open:function(a){if(this.isOpen){this.bringToFront();return false}if(this.notify("beforeOpen")===false)return false;if(this.options.closeOnClick){if(this.options.closeOnClick===
true)this.closeOnClickContainer=$(document.body);else if(this.options.closeOnClick=="container")this.closeOnClickContainer=this.container;else if(this.options.closeOnClick=="overlay"){Control.Overlay.load();this.closeOnClickContainer=Control.Overlay.container}else this.closeOnClickContainer=$(this.options.closeOnClick);this.closeOnClickContainer.observe("click",this.closeHandler)}if(this.href&&!this.options.iframe&&!this.remoteContentLoaded){this.remoteContentLoaded=true;if(this.href.match(/\.(jpe?g|gif|png|tiff?)$/i)){a=
new Element("img");a.observe("load",function(c){this.getRemoteContentInsertionTarget().insert(c);this.position();if(this.notify("onRemoteContentLoaded")!==false){this.options.indicator&&this.hideIndicator();this.finishOpen()}}.bind(this,a));a.writeAttribute("src",this.href)}else if(!this.ajaxRequest){this.options.indicator&&this.showIndicator();this.ajaxRequest=new Ajax.Request(this.href,{method:this.options.method,parameters:this.options.parameters,onComplete:function(c){this.notify("onComplete",
c);this.ajaxRequest=false}.bind(this),onSuccess:function(c){this.getRemoteContentInsertionTarget().insert(c.responseText);this.notify("onSuccess",c);if(this.notify("onRemoteContentLoaded")!==false){this.options.indicator&&this.hideIndicator();this.finishOpen()}}.bind(this),onFailure:function(c){this.notify("onFailure",c);this.options.indicator&&this.hideIndicator()}.bind(this),onException:function(c,e){this.notify("onException",c,e);this.options.indicator&&this.hideIndicator()}.bind(this)})}return true}else if(this.options.iframe&&
!this.remoteContentLoaded){this.remoteContentLoaded=true;this.options.indicator&&this.showIndicator();this.getRemoteContentInsertionTarget().insert(Control.Window.iframeTemplate.evaluate({href:this.href}));var b=this.container.down("iframe");b.onload=function(){this.notify("onRemoteContentLoaded");this.options.indicator&&this.hideIndicator();b.onload=null}.bind(this)}this.finishOpen(a);return true},close:function(a){if(!this.isOpen||this.notify("beforeClose",a)===false)return false;this.options.closeOnClick&&
this.closeOnClickContainer.stopObserving("click",this.closeHandler);if(this.options.fade)this.effects.fade=new Effect.Fade(this.container,{queue:{position:"front",scope:"Control.Window"+this.numberInSequence},from:1,to:0,duration:this.options.fadeDuration/2,afterFinish:function(){this.iFrameShim&&this.iFrameShim.hide();this.isOpen=false;this.notify("afterClose")}.bind(this)});else{this.container.hide();this.iFrameShim&&this.iFrameShim.hide()}this.ajaxRequest&&this.ajaxRequest.transport.abort();if(!(this.options.draggable||
this.options.resizable)&&this.options.position=="center")Event.stopObserving(window,"resize",this.positionHandler);!this.options.draggable&&this.options.position=="center"&&Event.stopObserving(window,"scroll",this.positionHandler);this.options.indicator&&this.hideIndicator();if(!this.options.fade){this.isOpen=false;this.notify("afterClose")}return true},position:function(a){if(this.options.position=="mouse"){var b=[Event.pointerX(a),Event.pointerY(a)];this.container.setStyle({top:b[1]+$value(this.options.offsetTop)+
"px",left:b[0]+$value(this.options.offsetLeft)+"px"})}else{a=this.container.getDimensions();var c=document.viewport.getDimensions();Position.prepare();var e=Position.deltaX+Math.floor((c.width-a.width)/2);b=Position.deltaY+(c.height>a.height?Math.floor((c.height-a.height)/2):0);if(this.options.position=="center")this.container.setStyle({top:a.height<=c.height?(b!=null&&b>0?b:0)+"px":0,left:a.width<=c.width?(e!=null&&e>0?e:0)+"px":0});else if(this.options.position=="relative"){b=this.sourceContainer.cumulativeOffset();
e=b[1]+$value(this.options.offsetTop);b=b[0]+$value(this.options.offsetLeft);this.container.setStyle({top:a.height<=c.height?(this.options.constrainToViewport?Math.max(0,Math.min(c.height-a.height,e)):e)+"px":0,left:a.width<=c.width?(this.options.constrainToViewport?Math.max(0,Math.min(c.width-a.width,b)):b)+"px":0})}else if(this.options.position.length){e=$value(this.options.position[1])+$value(this.options.offsetTop);b=$value(this.options.position[0])+$value(this.options.offsetLeft);this.container.setStyle({top:a.height<=
c.height?(this.options.constrainToViewport?Math.max(0,Math.min(c.height-a.height,e)):e)+"px":0,left:a.width<=c.width?(this.options.constrainToViewport?Math.max(0,Math.min(c.width-a.width,b)):b)+"px":0})}this.iFrameShim&&this.updateIFrameShimZIndex()}},ensureInBounds:function(){if(this.isOpen){var a=document.viewport.getDimensions(),b=this.container.cumulativeOffset(),c=this.container.getDimensions();b.left+c.width>a.width&&this.container.setStyle({left:Math.max(0,a.width-c.width)+"px"});b.top+c.height>
a.height&&this.container.setStyle({top:Math.max(0,a.height-c.height)+"px"})}},bringToFront:function(){Control.Window.bringToFront(this);this.notify("bringToFront")},destroy:function(){this.container.stopObserving("mousedown",this.bringToFrontHandler);if(this.draggable){Resizables.removeObserver(this.container);this.draggable.handle.stopObserving("mousedown",this.bringToFrontHandler);this.draggable.destroy()}if(this.resizable){Resizables.removeObserver(this.container);this.resizable.handle.stopObserving("mousedown",
this.bringToFrontHandler);this.resizable.destroy()}this.container&&!this.sourceContainer&&this.container.remove();if(this.sourceContainer)if(this.options.hover){this.sourceContainer.stopObserving("mouseenter",this.sourceContainerOpenHandler);this.sourceContainer.stopObserving("mouseleave",this.sourceContainerCloseHandler);this.options.position=="mouse"&&this.sourceContainer.stopObserving("mousemove",this.sourceContainerMouseMoveHandler)}else this.sourceContainer.stopObserving("click",this.sourceContainerOpenHandler);
this.iFrameShim&&this.iFrameShim.destroy();Event.stopObserving(window,"resize",this.outOfBoundsPositionHandler);Control.Window.windows=Control.Window.windows.without(this);this.notify("afterDestroy")},applyResizable:function(){if(this.options.resizable){if(typeof Resizable=="undefined")throw"Control.Window requires resizable.js to be loaded.";var a=null;if(this.options.resizable===true){a=new Element("div",{className:"resizable_handle"});this.container.insert(a)}else a=$(this.options.resziable);this.resizable=
new Resizable(this.container,{handle:a,minHeight:this.options.minHeight,minWidth:this.options.minWidth,maxHeight:this.options.constrainToViewport?function(b){return document.viewport.getDimensions().height-parseInt(b.style.top||0)-(b.getHeight()-parseInt(b.style.height||0))}:this.options.maxHeight,maxWidth:this.options.constrainToViewport?function(b){return document.viewport.getDimensions().width-parseInt(b.style.left||0)-(b.getWidth()-parseInt(b.style.width||0))}:this.options.maxWidth});this.resizable.handle.observe("mousedown",
this.bringToFrontHandler);Resizables.addObserver(new Control.Window.LayoutUpdateObserver(this,function(){this.iFrameShim&&this.updateIFrameShimZIndex();this.notify("onResize")}.bind(this)))}},applyDraggable:function(){if(this.options.draggable){if(typeof Draggables=="undefined")throw"Control.Window requires dragdrop.js to be loaded.";var a=null;if(this.options.draggable===true){a=new Element("div",{className:"draggable_handle"});this.container.insert(a)}else a=$(this.options.draggable);this.draggable=
new Draggable(this.container,{handle:a,constrainToViewport:this.options.constrainToViewport,zindex:this.container.getStyle("z-index"),starteffect:function(){if(Prototype.Browser.IE){this.old_onselectstart=document.onselectstart;document.onselectstart=function(){return false}}}.bind(this),endeffect:function(){document.onselectstart=this.old_onselectstart}.bind(this)});this.draggable.handle.observe("mousedown",this.bringToFrontHandler);Draggables.addObserver(new Control.Window.LayoutUpdateObserver(this,
function(){this.iFrameShim&&this.updateIFrameShimZIndex();this.notify("onDrag")}.bind(this)))}},createDefaultContainer:function(a){if(!this.container){this.container=new Element("div",{id:"control_window_"+this.numberInSequence});$(document.body).insert(this.container);typeof a=="string"&&$(a)==null&&!a.match(/^#(.+)$/)&&!a.match(Control.Window.uriRegex)&&this.container.update(a)}},finishOpen:function(a){this.bringToFront();if(this.options.fade){if(typeof Effect=="undefined")throw"Control.Window requires effects.js to be loaded.";
this.effects.fade&&this.effects.fade.cancel();this.effects.appear=new Effect.Appear(this.container,{queue:{position:"end",scope:"Control.Window."+this.numberInSequence},from:0,to:1,duration:this.options.fadeDuration/2,afterFinish:function(){this.iFrameShim&&this.updateIFrameShimZIndex();this.isOpen=true;this.notify("afterOpen")}.bind(this)})}else this.container.show();this.position(a);if(!(this.options.draggable||this.options.resizable)&&this.options.position=="center")Event.observe(window,"resize",
this.positionHandler,false);!this.options.draggable&&this.options.position=="center"&&Event.observe(window,"scroll",this.positionHandler,false);if(!this.options.fade){this.isOpen=true;this.notify("afterOpen")}return true},showIndicator:function(){this.showIndicatorTimeout=window.setTimeout(function(){if(this.options.fade)this.indicatorEffects.appear=new Effect.Appear(this.indicator,{queue:{position:"front",scope:"Control.Window.indicator."+this.numberInSequence},from:0,to:1,duration:this.options.fadeDuration/
2});else this.indicator.show()}.bind(this),Control.Window.indicatorTimeout)},hideIndicator:function(){this.showIndicatorTimeout&&window.clearTimeout(this.showIndicatorTimeout);this.indicator.hide()},getRemoteContentInsertionTarget:function(){return typeof this.options.insertRemoteContentAt=="string"?this.container.down(this.options.insertRemoteContentAt):$(this.options.insertRemoteContentAt)},updateIFrameShimZIndex:function(){this.iFrameShim&&this.iFrameShim.positionUnder(this.container)}});
Object.extend(Control.Window,{windows:[],baseZIndex:9999,indicatorTimeout:250,iframeTemplate:new Template('<iframe src="#{href}" width="100%" height="100%" frameborder="0"></iframe>'),uriRegex:/^(\/|\#|https?\:\/\/|[\w]+\/)/,bringToFront:function(a){Control.Window.windows=Control.Window.windows.without(a);Control.Window.windows.push(a);Control.Window.windows.each(function(b,c){c=Control.Window.baseZIndex+c;b.container.setStyle({zIndex:c});b.isOpen&&b.iFrameShim&&b.updateIFrameShimZIndex();if(b.options.draggable)b.draggable.options.zindex=
c})},open:function(a,b){a=new Control.Window(a,b);a.open();return a},initialZIndexForWindow:function(){return Control.Window.baseZIndex+(Control.Window.windows.length-1)}});Object.Event.extend(Control.Window);
Control.Window.LayoutUpdateObserver=Class.create({initialize:function(a,b){this.w=a;this.element=$(a.container);this.observer=b},onStart:Prototype.emptyFunction,onEnd:function(a,b){b.element==this.element&&this.iFrameShim&&this.w.updateIFrameShimZIndex()},onResize:function(a,b){b.element==this.element&&this.observer(this.element)},onDrag:function(a,b){b.element==this.element&&this.observer(this.element)}});
Control.Overlay={id:"control_overlay",loaded:false,container:false,lastOpacity:0,styles:{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:9998},ieStyles:{position:"absolute",top:0,left:0,zIndex:9998},effects:{fade:false,appear:false},load:function(){if(Control.Overlay.loaded)return false;Control.Overlay.loaded=true;Control.Overlay.container=new Element("div",{id:Control.Overlay.id});$(document.body).insert(Control.Overlay.container);if(Prototype.Browser.IE){Control.Overlay.container.setStyle(Control.Overlay.ieStyles);
Event.observe(window,"scroll",Control.Overlay.positionOverlay);Event.observe(window,"resize",Control.Overlay.positionOverlay);Control.Overlay.observe("beforeShow",Control.Overlay.positionOverlay)}else Control.Overlay.container.setStyle(Control.Overlay.styles);Control.Overlay.iFrameShim=new IframeShim;Control.Overlay.iFrameShim.hide();Event.observe(window,"resize",Control.Overlay.positionIFrameShim);Control.Overlay.container.hide();return true},unload:function(){if(!Control.Overlay.loaded)return false;
Event.stopObserving(window,"resize",Control.Overlay.positionOverlay);Control.Overlay.stopObserving("beforeShow",Control.Overlay.positionOverlay);Event.stopObserving(window,"resize",Control.Overlay.positionIFrameShim);Control.Overlay.iFrameShim.destroy();Control.Overlay.container.remove();Control.Overlay.loaded=false;return true},show:function(a,b){if(Control.Overlay.notify("beforeShow")===false)return false;Control.Overlay.lastOpacity=a;Control.Overlay.positionIFrameShim();Control.Overlay.iFrameShim.show();
if(b){if(typeof Effect=="undefined")throw"Control.Window requires effects.js to be loaded.";Control.Overlay.effects.fade&&Control.Overlay.effects.fade.cancel();Control.Overlay.effects.appear=new Effect.Appear(Control.Overlay.container,{queue:{position:"end",scope:"Control.Overlay"},afterFinish:function(){Control.Overlay.notify("afterShow")},from:0,to:Control.Overlay.lastOpacity,duration:(b===true?0.75:b)/2})}else{Control.Overlay.container.setStyle({opacity:a||1});Control.Overlay.container.show();
Control.Overlay.notify("afterShow")}return true},hide:function(a){if(Control.Overlay.notify("beforeHide")===false)return false;Control.Overlay.effects.appear&&Control.Overlay.effects.appear.cancel();Control.Overlay.iFrameShim.hide();if(a)Control.Overlay.effects.fade=new Effect.Fade(Control.Overlay.container,{queue:{position:"front",scope:"Control.Overlay"},afterFinish:function(){Control.Overlay.notify("afterHide")},from:Control.Overlay.lastOpacity,to:0,duration:(a===true?0.75:a)/2});else{Control.Overlay.container.hide();
Control.Overlay.notify("afterHide")}return true},positionIFrameShim:function(){Control.Overlay.container.visible()&&Control.Overlay.iFrameShim.positionUnder(Control.Overlay.container)},positionOverlay:function(){Control.Overlay.container.setStyle({width:document.body.clientWidth+"px",height:document.body.clientHeight+"px"})}};Object.Event.extend(Control.Overlay);
Control.ToolTip=Class.create(Control.Window,{initialize:function($super,b,c,e){$super(c,Object.extend(Object.extend(Object.clone(Control.ToolTip.defaultOptions),e||{}),{position:"mouse",hover:b}))}});Object.extend(Control.ToolTip,{defaultOptions:{offsetLeft:10}});Control.Modal=Class.create(Control.Window,{initialize:function($super,b,c){Control.Modal.InstanceMethods.beforeInitialize.bind(this)();$super(b,Object.extend(Object.clone(Control.Modal.defaultOptions),c||{}))}});
Object.extend(Control.Modal,{defaultOptions:{overlayOpacity:0.5,closeOnClick:"overlay"},current:false,open:function(a,b){a=new Control.Modal(a,b);a.open();return a},close:function(){Control.Modal.current&&Control.Modal.current.close()},InstanceMethods:{beforeInitialize:function(){Control.Overlay.load();this.overlayFinishedOpening=false;this.observe("beforeOpen",Control.Modal.Observers.beforeOpen.bind(this));this.observe("afterOpen",Control.Modal.Observers.afterOpen.bind(this));this.observe("afterClose",
Control.Modal.Observers.afterClose.bind(this))}},Observers:{beforeOpen:function(){if(this.overlayFinishedOpening)Control.Window.windows.without(this).invoke("close");else{Control.Overlay.observeOnce("afterShow",function(){this.overlayFinishedOpening=true;this.open()}.bind(this));Control.Overlay.show(this.options.overlayOpacity,this.options.fade?this.options.fadeDuration:false);throw $break;}},afterOpen:function(){Control.Modal.current=this},afterClose:function(){Control.Overlay.hide(this.options.fade?
this.options.fadeDuration:false);this.overlayFinishedOpening=Control.Modal.current=false}}});
Control.LightBox=Class.create(Control.Window,{initialize:function($super,b,c){this.allImagesLoaded=false;if(c.modal){c=Object.extend(Object.clone(Control.LightBox.defaultOptions),c||{});c=Object.extend(Object.clone(Control.Modal.defaultOptions),c);c=Control.Modal.InstanceMethods.beforeInitialize.bind(this)(c);$super(b,c)}else $super(b,Object.extend(Object.clone(Control.LightBox.defaultOptions),c||{}));(this.hasRemoteContent=this.href&&!this.options.iframe)?this.observe("onRemoteContentLoaded",Control.LightBox.Observers.onRemoteContentLoaded.bind(this)):
this.applyImageObservers();this.observe("beforeOpen",Control.LightBox.Observers.beforeOpen.bind(this))},applyImageObservers:function(){var a=this.getImages();this.numberImagesToLoad=a.length;this.numberofImagesLoaded=0;a.each(function(b){b.observe("load",function(){++this.numberofImagesLoaded;if(this.numberImagesToLoad==this.numberofImagesLoaded){this.allImagesLoaded=true;this.onAllImagesLoaded()}}.bind(this,b));b.hide()}.bind(this))},onAllImagesLoaded:function(){this.getImages().each(function(a){this.showImage(a)}.bind(this));
if(this.hasRemoteContent){this.options.indicator&&this.hideIndicator();this.finishOpen()}else this.open()},getImages:function(){return this.container.select(Control.LightBox.imageSelector)},showImage:function(a){a.show()}});Object.extend(Control.LightBox,{imageSelector:"img",defaultOptions:{},Observers:{beforeOpen:function(){if(!this.hasRemoteContent&&!this.allImagesLoaded)throw $break;},onRemoteContentLoaded:function(){this.applyImageObservers();if(!this.allImagesLoaded)throw $break;}}});function UserProfileHoverbox(){this.initialize()}
UserProfileHoverbox.prototype={initialize:function(){this._hoverboxCache={};this._timeout=this._currentHoverElement=this._currentUserAnchor=this._hoverbox=null;this._mouseOverHandler=this.handleMouseOverUser.bindAsEventListener(this);this.refreshMouseOverObservers()},refreshMouseOverObservers:function(){$$(".hover_profile",".hover_profile_simple").each(function(a){if(a.href!=undefined)a.observe("mouseover",this._mouseOverHandler);else{var b=a.down(".js_hover_profile_link");b!=undefined&&b.href!=undefined&&
a.observe("mouseover",this._mouseOverHandler)}}.bind(this))},handleMouseOverUser:function(a){var b=a.findElement("A")||a.findElement().down(".js_hover_profile_link")||null;if(b!=null)if(!(!b.hasClassName("js_hover_profile_link")&&!b.hasClassName("hover_profile")&&!b.hasClassName("hover_profile_simple")))if(!(b!=null&&this._currentUserAnchor!=null&&b.href==this._currentUserAnchor.href)){this.cancelOrCloseOpen();this._currentHoverElement=a.findElement(".hover_profile")||a.findElement(".hover_profile_simple");
this._currentUserAnchor=b;this._timeout=setTimeout(this.openHoverbox.bindAsEventListener(this),500);this._currentHoverElement.observe("mouseleave",this.cancelOrCloseOpen.bindAsEventListener(this))}},openHoverbox:function(){var a=this._currentHoverElement.cumulativeOffset();document.viewport.getDimensions();var b={},c=this._currentHoverElement.hasClassName("hover_profile_simple");if(c)b.simple="true";this._hoverbox=this._hoverboxCache[this._currentUserAnchor.href];if(this._hoverbox!=null&&this._hoverbox._is_simple!=
c){this._hoverbox.destroy();this._hoverbox=null;this._hoverboxCache[this._currentUserAnchor.href]=null}if(this._hoverbox==null){this._hoverbox=new Control.Window(this._currentUserAnchor,{method:"GET",parameters:b,offsetLeft:30,offsetTop:-22,className:"hover_profile_window"});this._hoverbox._is_simple=c;this._hoverbox.sourceContainer.stopObserving("click");this._hoverbox.observe("afterDestroy",this.handleBoxDestroy.bindAsEventListener(this,this._hoverbox))}this._hoverbox.observe("bringToFront",this.handleBoxBeforeOpen.bindAsEventListener(this));
this._hoverbox.observe("afterOpen",this.handleBoxOpened.bindAsEventListener(this));this._hoverbox.options.position=[a[0],a[1]];this._hoverbox.href+="/show_hover";this._hoverbox.open();this._currentHoverElement.stopObserving("mouseleave");this._currentHoverElement.observe("mouseleave",this.handleMouseLeaveUser.bindAsEventListener(this))},handleMouseLeaveUser:function(){if(this._hoverbox!=null)if(this._hoverbox.isOpen){this._currentHoverElement.stopObserving("mouseleave");this.startCloseTimeout()}else this.cancelOrCloseOpen()},
cancelOrCloseOpen:function(){if(this._hoverbox!=null){this._hoverbox.stopObserving("afterOpen");this._hoverbox.container.stopObserving("mouseenter");this._hoverbox.container.stopObserving("mouseleave");if(this._hoverbox.ajaxRequest){this._hoverbox.ajaxRequest.transport.abort();this._hoverbox.close();this._hoverbox.destroy()}else this._hoverbox.close();this._hoverbox=null}this._currentHoverElement=this._currentUserAnchor=null;this.cancelTimeout()},cancelTimeout:function(){if(this._timeout!=null){clearTimeout(this._timeout);
this._timeout=null}},startCloseTimeout:function(){this._timeout=setTimeout(this.mouseLeaveTimeout.bindAsEventListener(this),500)},mouseLeaveTimeout:function(){this.cancelOrCloseOpen()},handleBoxBeforeOpen:function(){var a=document.viewport.getDimensions();if(this._currentHoverElement.cumulativeOffset()[0]+this._currentHoverElement.getWidth()/2>a.width-440){this._hoverbox.options.offsetLeft=-this._hoverbox.container.getDimensions().width;$(this._hoverbox.container).addClassName("profile_left");$(this._hoverbox.container).removeClassName("profile_right")}else{this._hoverbox.options.offsetLeft=
this._currentHoverElement.getWidth()/2;$(this._hoverbox.container).addClassName("profile_right");$(this._hoverbox.container).removeClassName("profile_left")}},handleBoxOpened:function(){this._hoverboxCache[this._currentUserAnchor.href]=this._hoverbox;this._hoverbox.container.observe("mouseenter",this.cancelTimeout.bindAsEventListener(this));this._hoverbox.container.observe("mouseleave",this.startCloseTimeout.bindAsEventListener(this));var a=this._hoverbox.container.down(".mini_profile_bio");if(a!=
undefined){a.setStyle({width:a.getWidth()+"px"});a.show()}},handleBoxDestroy:function(a,b){b.container.remove()}};function registerHoverProfileObservers(){if(typeof userProfileHoverbox=="undefined")userProfileHoverbox=new UserProfileHoverbox;else userProfileHoverbox.refreshMouseOverObservers()}document.observe("dom:loaded",function(){registerHoverProfileObservers()});function FavoriteHoverbox(a,b,c,e,g){this.initialize(a,b,c,e,g)}
FavoriteHoverbox.prototype={initialize:function(a,b,c,e,g){var l="",r="";if(a!=undefined)rating_value=typeof a.rating=="number"?a.rating:a.rating.rating;if(a==undefined)l="You have already earned the "+b+" point maximum for ratings per day. Come back tomorrow to rate more!";else if(c)if(rating_value>=4){l="You have updated your rating."+String(g||"");r="hover_add_favorite hover_long"}else l="You have updated your rating.";else if(rating_value>=4){l="Thanks. You just earned 1 point!"+String(g||"");
r="hover_add_favorite hover_long"}else l="Sweet! You earned 1 point and improved your recommendations.";setTimeout(function(){var u=$(e+"rating-indicator").next(".star-rating"),t;if(u==undefined)u=$$("#star_ratings_block"+e.sub("game","").sub("-","")+" .star-rating-big").first();if(u==undefined)u=$(e+"rating-indicator").next(".star-rating-big");u.addClassName("rating_message_hover_anchor");u.visible()||u.show();t=new Control.Window(null,{closeOnClick:true,position:"relative",offsetLeft:u.getWidth(),
offsetTop:function(){return e=="quicklinks_"?u.getHeight()/2-t.container.getHeight()+12:u.getHeight()/2-12}});t.observe("afterClose",function(){t.destroy()});t.sourceContainer=u;t.container.insert('<div class="'+(e=="quicklinks_"?"hover_high ":"")+"rating_message hover_item "+r+'"><div class="hover_arrow_1"></div><div class="hover_arrow_2"></div><div class="hover_container pas media"><span class="rating_icon spritesite img"></span><p class="bd">'+l+"</p></div></div>");t.open();setTimeout(function(){t.close()},
5E3)},0)}};function LikesHoverbox(){this.initialize()}
LikesHoverbox.prototype={initialize:function(){this._hoverboxCache={};this._timeout=this._currentHoverElement=this._currentUserAnchor=this._hoverbox=null;this._mouseOverHandler=this.handleMouseOverUser.bindAsEventListener(this);this.refreshMouseOverObservers()},refreshMouseOverObservers:function(){$$(".like_count").each(function(a){a.observe("mouseover",this._mouseOverHandler)}.bind(this))},handleMouseOverUser:function(a){if(parseInt(a.target.innerHTML.gsub(/[()]/,""))!=0){this.cancelOrCloseOpen();
this._currentUserAnchor=this._currentHoverElement=a.target;this._timeout=setTimeout(this.openHoverbox.bindAsEventListener(this),500);this._currentHoverElement.observe("mouseleave",this.cancelOrCloseOpen.bindAsEventListener(this))}},openHoverbox:function(){var a=this._currentHoverElement.cumulativeOffset();document.viewport.getDimensions();var b={},c=this._currentHoverElement.up("li").id.sub("feed_item_",""),e=this._currentHoverElement.hasClassName("hover_profile_simple");this._likeHref="/user_likes?feed_item_id="+
c;if(e)b.simple="true";this._hoverbox=this._hoverboxCache[this._likeHref];if(this._hoverbox!=null){this._hoverbox.destroy();this._hoverbox=null;this._hoverboxCache[this._likeHref]=null}if(this._hoverbox==null){this._hoverbox=new Control.Window(this._currentUserAnchor,{method:"GET",parameters:b,offsetLeft:30,offsetTop:-22,className:"hover_likes_window"});this._hoverbox._is_simple=e;this._hoverbox.sourceContainer.stopObserving("click");this._hoverbox.observe("afterDestroy",this.handleBoxDestroy.bindAsEventListener(this,
this._hoverbox))}this._hoverbox.observe("bringToFront",this.handleBoxBeforeOpen.bindAsEventListener(this));this._hoverbox.observe("afterOpen",this.handleBoxOpened.bindAsEventListener(this));this._hoverbox.options.position=[a[0],a[1]];this._hoverbox.href="/user_likes?feed_item_id="+c;this._hoverbox.open();this._currentHoverElement.stopObserving("mouseleave");this._currentHoverElement.observe("mouseleave",this.handleMouseLeaveUser.bindAsEventListener(this))},handleMouseLeaveUser:function(){if(this._hoverbox!=
null)if(this._hoverbox.isOpen){this._currentHoverElement.stopObserving("mouseleave");this.startCloseTimeout()}else this.cancelOrCloseOpen()},cancelOrCloseOpen:function(){if(this._hoverbox!=null){this._hoverbox.stopObserving("afterOpen");this._hoverbox.container.stopObserving("mouseenter");this._hoverbox.container.stopObserving("mouseleave");if(this._hoverbox.ajaxRequest){this._hoverbox.ajaxRequest.transport.abort();this._hoverbox.close();this._hoverbox.destroy()}else this._hoverbox.close();this._hoverbox=
null}this._currentHoverElement=this._currentUserAnchor=null;this.cancelTimeout()},cancelTimeout:function(){if(this._timeout!=null){clearTimeout(this._timeout);this._timeout=null}},startCloseTimeout:function(){this._timeout=setTimeout(this.mouseLeaveTimeout.bindAsEventListener(this),500)},mouseLeaveTimeout:function(){this.cancelOrCloseOpen()},handleBoxBeforeOpen:function(){var a=document.viewport.getDimensions();if(this._currentHoverElement.cumulativeOffset()[0]+this._currentHoverElement.getWidth()/
2>a.width-440){this._hoverbox.options.offsetLeft=-this._hoverbox.container.getDimensions().width;$(this._hoverbox.container).addClassName("profile_left");$(this._hoverbox.container).removeClassName("profile_right")}else{this._hoverbox.options.offsetLeft=this._currentHoverElement.getWidth()/2;$(this._hoverbox.container).addClassName("profile_right");$(this._hoverbox.container).removeClassName("profile_left")}},handleBoxOpened:function(){this._hoverboxCache[this._likeHref]=this._hoverbox;this._hoverbox.container.observe("mouseenter",
this.cancelTimeout.bindAsEventListener(this));this._hoverbox.container.observe("mouseleave",this.startCloseTimeout.bindAsEventListener(this));var a=this._hoverbox.container.down(".mini_profile_bio");if(a!=undefined){a.setStyle({width:a.getWidth()+"px"});a.show()}},handleBoxDestroy:function(a,b){b.container.remove()}};function registerLikeObservers(){if(typeof likesHoverbox=="undefined")likesHoverbox=new LikesHoverbox;else likesHoverbox.refreshMouseOverObservers()}document.observe("dom:loaded",function(){registerLikeObservers()});function Roller(a){this.initialize(a)}
Roller.prototype={initialize:function(a){this._scrollDelay=a.scrollDelay;this._currentPane=0;this._paneScrollTimer=null;this._scrollDuration=a.scrollDuration?(a.scrollDuration||8E3)/1E3:1;this._effect=null;this._scrollablePane=$(a.scrollablePane)||$("featured_content_scrollable");this._scrollCallbacks=[];this._showDots=a.showDots===undefined?true:a.showDots;this._container=$(a.container);this._skipPaneClone=a.skipPaneClone;var b,c;if(a.targetableCountryCodes){b=".ind_pane.non_targeted";if(a.targetableCountryCodes.include(active_user.countryCode()))b+=
", .ind_pane."+active_user.countryCode()+"_only";if(active_user.countryCode()!="US")b+=", .ind_pane.Rest_Of_World_only"}else b=".ind_pane";this._panes=c=this._scrollablePane.select(b);this._scrollablePane.select(" .ind_pane").filter(function(e){return c.indexOf(e)<0}).each(Element.hide);if((this._nitems=c.length)&&!c[0].hasClassName("volatile")&&!c[0].hasClassName("loaded")){this._panes_loaded=[];this.loadPaneNumber(0)}if(!this._skipPaneClone){a=c[0].clone(true);c[c.length-1].insert({after:a});c.push(a)}this._panes_loaded=
c.map(function(e){return e.match(".volatile, .loaded")})},scrollToPane:function(a){this.loadPaneNumber(a);a=this._panes[a].positionedOffset();var b=this._scrollDuration;this._effect&&this._effect.cancel();this._effect=new Effect.Morph(this._scrollablePane,{style:"left:"+-a[0]+"px; top:0px;",duration:b});if(this._showDots&&this._container){this._container.down(".pane_dots").descendants().each(function(c){c.hasClassName("roller_dot")&&c.removeClassName("active_dot").addClassName("inactive_dot")});this._container.down(".pane_dots").down(".dot_"+
(this._currentPane<this._nitems?this._currentPane:0)).removeClassName("inactive_dot").addClassName("active_dot")}this._scrollCallbacks.each(function(c){c(this._currentPane)})},setPane:function(a){this.loadPaneNumber(a);var b=this._panes[a].positionedOffset();this._currentPane=a;this._effect&&this._effect.cancel();this._scrollablePane.setStyle({left:-b[0]+"px",top:"0px"})},loadPaneNumber:function(a){if(!this._panes_loaded[a]){var b=this._panes[a];this._panes_loaded[a]=true;b.update(Base64.decode(b.down(".pane_contents").innerHTML));
b.addClassName("loaded");$H(active_user.split_treatments.feature_roll).each(function(c){$$(".ind_pane."+c[0]+" div.featured_split_treatment").each(Element.hide);$$("."+c.join(" div.")).each(Element.show)})}},scrollToNextPane:function(){this.scrollToNextPaneAndStop();this.setNextPaneScrollTimeout()},scrollToNextPaneAndStop:function(){clearTimeout(this._paneScrollTimer);if(this._hasClonedPane()){if(this._currentPane==this._nitems){this._currentPane=0;this.isEffectRunning()||this.setPane(this._currentPane)}this._currentPane++}else this._currentPane=
this._currentPane==this._nitems-1?0:this._currentPane+1;this.scrollToPane(this._currentPane)},scrollToPreviousPaneAndStop:function(){clearTimeout(this._paneScrollTimer);if(this._hasClonedPane()){if(0==this._currentPane){this._currentPane=this._nitems;this.isEffectRunning()||this.setPane(this._currentPane)}this._currentPane--}else this._currentPane=this._currentPane===0?this._nitems-1:this._currentPane-1;this.scrollToPane(this._currentPane)},scrollToPreviousPane:function(){this.scrollToPreviousPaneAndStop();
this.setNextPaneScrollTimeout()},setNextPaneScrollTimeout:function(){this._paneScrollTimer=setTimeout(this.scrollToNextPane.bind(this),this._scrollDelay)},isEffectRunning:function(){return this._effect&&"finished"!=this._effect.state},addOnScrollObserver:function(a){this._scrollCallbacks.push(a)},paneCount:function(){return this._nitems},_hasClonedPane:function(){return!this._skipPaneClone}};Roller.rolodex={};function AjaxRoller(a){this.initialize(a)}AjaxRoller.prototype=Object.extend(AjaxRoller.prototype,Roller.prototype);
AjaxRoller.prototype=Object.extend(AjaxRoller.prototype,{loadPaneNumber:function(a){if(!this._panes_loaded[a]){var b=this,c=document.location.pathname.split("/")[2];new Ajax.Request("/accounts/"+c+"/games_pod",{method:"get",parameters:{page:this._currentPane},asynchronous:false,onSuccess:function(e){e=e.responseJSON;var g=b._panes[a];b._panes_loaded[a]=true;g.update(e.html);g.addClassName("loaded");active_user.isAdmin()&&$$(".admin_controls").each(Element.show)}})}}});AjaxRoller.rolodex={};var qq=qq||{};
qq=function(a){return{hide:function(){a.style.display="none";return this},attach:function(b,c){if(a.addEventListener)a.addEventListener(b,c,false);else a.attachEvent&&a.attachEvent("on"+b,c);return function(){qq(a).detach(b,c)}},detach:function(b,c){if(a.removeEventListener)a.removeEventListener(b,c,false);else a.attachEvent&&a.detachEvent("on"+b,c);return this},contains:function(b){if(a==b)return true;return a.contains?a.contains(b):!!(b.compareDocumentPosition(a)&8)},insertBefore:function(b){b.parentNode.insertBefore(a,b);
return this},remove:function(){a.parentNode.removeChild(a);return this},css:function(b){if(b.opacity!=null)if(typeof a.style.opacity!="string"&&typeof a.filters!="undefined")b.filter="alpha(opacity="+Math.round(100*b.opacity)+")";qq.extend(a.style,b);return this},hasClass:function(b){return(new RegExp("(^| )"+b+"( |$)")).test(a.className)},addClass:function(b){qq(a).hasClass(b)||(a.className+=" "+b);return this},removeClass:function(b){a.className=a.className.replace(new RegExp("(^| )"+b+"( |$)"),
" ").replace(/^\s+|\s+$/g,"");return this},getByClass:function(b){if(a.querySelectorAll)return a.querySelectorAll("."+b);for(var c=[],e=a.getElementsByTagName("*"),g=e.length,l=0;l<g;l++)qq(e[l]).hasClass(b)&&c.push(e[l]);return c},children:function(){for(var b=[],c=a.firstChild;c;){c.nodeType==1&&b.push(c);c=c.nextSibling}return b},setText:function(b){a.innerText=b;a.textContent=b;return this},clearText:function(){return qq(a).setText("")}}};
qq.log=function(a,b){if(window.console)if(!b||b==="info")window.console.log(a);else window.console[b]?window.console[b](a):window.console.log("<"+b+"> "+a)};qq.isObject=function(a){return a!==null&&a&&typeof a==="object"&&a.constructor===Object};qq.extend=function(a,b,c){var e;for(e in b)if(b.hasOwnProperty(e))if(c&&qq.isObject(b[e])){if(a[e]===undefined)a[e]={};qq.extend(a[e],b[e],true)}else a[e]=b[e]};
qq.indexOf=function(a,b,c){if(a.indexOf)return a.indexOf(b,c);c=c||0;var e=a.length;if(c<0)c+=e;for(;c<e;c++)if(c in a&&a[c]===b)return c;return-1};qq.getUniqueId=function(){var a=0;return function(){return a++}}();qq.ie=function(){return navigator.userAgent.indexOf("MSIE")!=-1};qq.ie10=function(){return navigator.userAgent.indexOf("MSIE 10")!=-1};qq.safari=function(){return navigator.vendor!=undefined&&navigator.vendor.indexOf("Apple")!=-1};
qq.chrome=function(){return navigator.vendor!=undefined&&navigator.vendor.indexOf("Google")!=-1};qq.firefox=function(){return navigator.userAgent.indexOf("Mozilla")!=-1&&navigator.vendor!=undefined&&navigator.vendor==""};qq.windows=function(){return navigator.platform=="Win32"};qq.preventDefault=function(a){if(a.preventDefault)a.preventDefault();else a.returnValue=false};qq.toElement=function(){var a=document.createElement("div");return function(b){a.innerHTML=b;b=a.firstChild;a.removeChild(b);return b}}();
qq.obj2url=function(a,b,c){var e=[],g="&",l=function(u,t){var v=b?/\[\]$/.test(b)?b:b+"["+t+"]":t;if(v!="undefined"&&t!="undefined")e.push(typeof u==="object"?qq.obj2url(u,v,true):Object.prototype.toString.call(u)==="[object Function]"?encodeURIComponent(v)+"="+encodeURIComponent(u()):encodeURIComponent(v)+"="+encodeURIComponent(u))};if(!c&&b){g=/\?/.test(b)?/\?$/.test(b)?"":"&":"?";e.push(b);e.push(qq.obj2url(a))}else if(Object.prototype.toString.call(a)==="[object Array]"&&typeof a!="undefined"){var r=
0;for(c=a.length;r<c;++r)l(a[r],r)}else if(typeof a!="undefined"&&a!==null&&typeof a==="object")for(r in a)l(a[r],r);else e.push(encodeURIComponent(b)+"="+encodeURIComponent(a));return b?e.join(g):e.join(g).replace(/^&/,"").replace(/%20/g,"+")};qq.DisposeSupport={_disposers:[],dispose:function(){for(var a;a=this._disposers.shift();)a()},addDisposer:function(a){this._disposers.push(a)},_attach:function(){this.addDisposer(qq(arguments[0]).attach.apply(this,Array.prototype.slice.call(arguments,1)))}};
qq.UploadButton=function(a){this._options={element:null,multiple:false,acceptFiles:null,name:"file",onChange:function(){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"};qq.extend(this._options,a);qq.extend(this,qq.DisposeSupport);this._element=this._options.element;qq(this._element).css({position:"relative",overflow:"hidden",direction:"ltr"});this._input=this._createInput()};
qq.UploadButton.prototype={getInput:function(){return this._input},reset:function(){this._input.parentNode&&qq(this._input).remove();qq(this._element).removeClass(this._options.focusClass);this._input=this._createInput()},_createInput:function(){var a=document.createElement("input");this._options.multiple&&a.setAttribute("multiple","multiple");this._options.acceptFiles&&a.setAttribute("accept",this._options.acceptFiles);a.setAttribute("type","file");a.setAttribute("name",this._options.name);qq(a).css({position:"absolute",
right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0});this._element.appendChild(a);var b=this;this._attach(a,"change",function(){b._options.onChange(a)});this._attach(a,"mouseover",function(){qq(b._element).addClass(b._options.hoverClass)});this._attach(a,"mouseout",function(){qq(b._element).removeClass(b._options.hoverClass)});this._attach(a,"focus",function(){qq(b._element).addClass(b._options.focusClass)});this._attach(a,"blur",function(){qq(b._element).removeClass(b._options.focusClass)});
window.attachEvent&&a.setAttribute("tabIndex","-1");return a}};
qq.FineUploaderBasic=function(a){this._options={debug:false,button:null,multiple:true,maxConnections:3,disableCancelForFormUploads:false,autoUpload:true,request:{endpoint:"/server/upload",params:{},customHeaders:{},forceMultipart:false,inputName:"qqfile"},validation:{allowedExtensions:[],sizeLimit:0,minSizeLimit:0,stopOnFirstInvalidFile:true},callbacks:{onSubmit:function(){},onComplete:function(){},onCancel:function(){},onUpload:function(){},onProgress:function(){},onError:function(){},onAutoRetry:function(){},
onManualRetry:function(){},onValidate:function(){}},messages:{typeError:"{file} has an invalid extension. Valid extension(s): {extensions}.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",noFilesError:"No files to upload.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},retry:{enableAuto:false,maxAutoAttempts:3,
autoAttemptDelay:5,preventRetryResponseProperty:"preventRetry"}};qq.extend(this._options,a,true);this._wrapCallbacks();qq.extend(this,qq.DisposeSupport);this._filesInProgress=0;this._storedFileIds=[];this._autoRetries=[];this._retryTimeouts=[];this._preventRetries=[];this._handler=this._createUploadHandler();if(this._options.button)this._button=this._createUploadButton(this._options.button);this._preventLeaveInProgress()};
qq.FineUploaderBasic.prototype={log:function(a,b){if(this._options.debug&&(!b||b==="info"))qq.log("[FineUploader] "+a);else b&&b!=="info"&&qq.log("[FineUploader] "+a,b)},setParams:function(a){this._options.request.params=a},getInProgress:function(){return this._filesInProgress},uploadStoredFiles:function(){for(;this._storedFileIds.length;){this._filesInProgress++;this._handler.upload(this._storedFileIds.shift(),this._options.request.params)}},clearStoredFiles:function(){this._storedFileIds=[]},retry:function(a){if(this._onBeforeManualRetry(a)){this._handler.retry(a);
return true}else return false},cancel:function(a){this._handler.cancel(a)},reset:function(){this.log("Resetting uploader...");this._handler.reset();this._filesInProgress=0;this._storedFileIds=[];this._autoRetries=[];this._retryTimeouts=[];this._preventRetries=[];this._button.reset()},_createUploadButton:function(a){var b=this,c=new qq.UploadButton({element:a,multiple:this._options.multiple&&qq.UploadHandlerXhr.isSupported(),acceptFiles:this._options.validation.acceptFiles,onChange:function(e){b._onInputChange(e)}});
this.addDisposer(function(){c.dispose()});return c},_createUploadHandler:function(){var a=this,b;b=qq.UploadHandlerXhr.isSupported()?"UploadHandlerXhr":"UploadHandlerForm";return new qq[b]({debug:this._options.debug,endpoint:this._options.request.endpoint,forceMultipart:this._options.request.forceMultipart,maxConnections:this._options.maxConnections,customHeaders:this._options.request.customHeaders,inputName:this._options.request.inputName,demoMode:this._options.demoMode,log:this.log,onProgress:function(c,
e,g,l){a._onProgress(c,e,g,l);a._options.callbacks.onProgress(c,e,g,l)},onComplete:function(c,e,g,l){a._onComplete(c,e,g,l);a._options.callbacks.onComplete(c,e,g)},onCancel:function(c,e){a._onCancel(c,e);a._options.callbacks.onCancel(c,e)},onUpload:function(c,e,g){a._onUpload(c,e,g);a._options.callbacks.onUpload(c,e,g)},onAutoRetry:function(c,e,g,l){a._preventRetries[c]=g[a._options.retry.preventRetryResponseProperty];if(a._shouldAutoRetry(c,e,g)){a._maybeParseAndSendUploadError(c,e,g,l);a._options.callbacks.onAutoRetry(c,
e,a._autoRetries[c]+1);a._onBeforeAutoRetry(c,e);a._retryTimeouts[c]=setTimeout(function(){a._onAutoRetry(c,e,g)},a._options.retry.autoAttemptDelay*1E3);return true}else return false}})},_preventLeaveInProgress:function(){var a=this;this._attach(window,"beforeunload",function(b){if(a._filesInProgress){b=b||window.event;return b.returnValue=a._options.messages.onLeave}})},_onSubmit:function(){this._options.autoUpload&&this._filesInProgress++},_onProgress:function(){},_onComplete:function(a,b,c,e){this._filesInProgress--;
this._maybeParseAndSendUploadError(a,b,c,e)},_onCancel:function(a){clearTimeout(this._retryTimeouts[a]);a=qq.indexOf(this._storedFileIds,a);if(this._options.autoUpload||a<0)this._filesInProgress--;else this._options.autoUpload||this._storedFileIds.splice(a,1)},_onUpload:function(){},_onInputChange:function(a){if(this._handler instanceof qq.UploadHandlerXhr)this._uploadFileList(a.files);else this._validateFile(a)&&this._uploadFile(a);this._button.reset()},_onBeforeAutoRetry:function(a,b){this.log("Waiting "+
this._options.retry.autoAttemptDelay+" seconds before retrying "+b+"...")},_onAutoRetry:function(a,b){this.log("Retrying "+b+"...");this._autoRetries[a]++;this._handler.retry(a)},_shouldAutoRetry:function(a){if(!this._preventRetries[a]&&this._options.retry.enableAuto){if(this._autoRetries[a]===undefined)this._autoRetries[a]=0;return this._autoRetries[a]<this._options.retry.maxAutoAttempts}return false},_onBeforeManualRetry:function(a){if(this._preventRetries[a]){this.log("Retries are forbidden for id "+
a,"warn");return false}else if(this._handler.isValid(a)){var b=this._handler.getName(a);if(this._options.callbacks.onManualRetry(a,b)===false)return false;this.log("Retrying upload for '"+b+"' (id: "+a+")...");this._filesInProgress++;return true}else{this.log("'"+a+"' is not a valid file ID","error");return false}},_maybeParseAndSendUploadError:function(a,b,c,e){c.success||(e&&e.status!==200&&!c.error?this._options.callbacks.onError(a,b,"XHR returned response code "+e.status):this._options.callbacks.onError(a,
b,c.error?c.error:"Upload failure reason unknown"))},_uploadFileList:function(a){var b,c;b=this._getValidationDescriptors(a);if(b.length>1)c=this._options.callbacks.onValidate(b)===false;if(!c)if(a.length>0)for(b=0;b<a.length;b++)if(this._validateFile(a[b]))this._uploadFile(a[b]);else{if(this._options.validation.stopOnFirstInvalidFile)return}else this._error("noFilesError","")},_uploadFile:function(a){a=this._handler.add(a);var b=this._handler.getName(a);if(this._options.callbacks.onSubmit(a,b)!==
false){this._onSubmit(a,b);this._options.autoUpload?this._handler.upload(a,this._options.request.params):this._storeFileForLater(a)}},_storeFileForLater:function(a){this._storedFileIds.push(a)},_validateFile:function(a){var b,c;a=this._getValidationDescriptor(a);b=a.name;c=a.size;if(this._options.callbacks.onValidate([a])===false)return false;if(this._isAllowedExtension(b))if(c===0){this._error("emptyError",b);return false}else if(c&&this._options.validation.sizeLimit&&c>this._options.validation.sizeLimit){this._error("sizeError",
b);return false}else{if(c&&c<this._options.validation.minSizeLimit){this._error("minSizeError",b);return false}}else{this._error("typeError",b);return false}return true},_error:function(a,b){function c(g,l){e=e.replace(g,l)}var e=this._options.messages[a];a=this._options.validation.allowedExtensions.join(", ");c("{file}",this._formatFileName(b));c("{extensions}",a);c("{sizeLimit}",this._formatSize(this._options.validation.sizeLimit));c("{minSizeLimit}",this._formatSize(this._options.validation.minSizeLimit));
this._options.callbacks.onError(null,b,e);return e},_formatFileName:function(a){if(a.length>33)a=a.slice(0,19)+"..."+a.slice(-13);return a},_isAllowedExtension:function(a){a=-1!==a.indexOf(".")?a.replace(/.*[.]/,"").toLowerCase():"";var b=this._options.validation.allowedExtensions;if(!b.length)return true;for(var c=0;c<b.length;c++)if(b[c].toLowerCase()==a)return true;return false},_formatSize:function(a){var b=-1;do{a/=1024;b++}while(a>99);return Math.max(a,0.1).toFixed(1)+["kB","MB","GB","TB","PB",
"EB"][b]},_wrapCallbacks:function(){var a,b;a=this;b=function(e,g,l){try{return g.apply(a,l)}catch(r){a.log("Caught exception in '"+e+"' callback - "+r,"error")}};for(var c in this._options.callbacks)(function(){var e=a._options.callbacks[c];a._options.callbacks[c]=function(){return b(c,e,arguments)}})()},_parseFileName:function(a){return a.value?a.value.replace(/.*(\/|\\)/,""):a.fileName!==null&&a.fileName!==undefined?a.fileName:a.name},_parseFileSize:function(a){var b;a.value||(b=a.fileSize!==null&&
a.fileSize!==undefined?a.fileSize:a.size);return b},_getValidationDescriptor:function(a){var b,c;c={};b=this._parseFileName(a);a=this._parseFileSize(a);c.name=b;if(a)c.size=a;return c},_getValidationDescriptors:function(a){var b,c;c=[];for(b=0;b<a.length;b++)c.push(a[b]);return c}};
qq.FineUploader=function(a){qq.FineUploaderBasic.apply(this,arguments);qq.extend(this._options,{element:null,listElement:null,dragAndDrop:{extraDropzones:[],hideDropzones:true,disableDefaultDropzone:false},text:{uploadButton:"Upload a file",cancelButton:"Cancel",retryButton:"Retry",failUpload:"Upload failed",dragZone:"Drop files here to upload",formatProgress:"{percent}% of {total_size}",waitingForResponse:"Processing..."},template:'<div class="qq-uploader">'+(!this._options.listElement?'<ul class="qq-upload-list mbs"></ul>':
"")+(!this._options.dragAndDrop||!this._options.dragAndDrop.disableDefaultDropzone?'<div class="qq-upload-drop-area"><span class="qq-upload-drop-text">{dragZoneText}</span>':"")+(!this._options.button?'<br/><div class="qq-upload-button btn"><div>{uploadButtonText}</div></div>':"")+(!this._options.dragAndDrop||!this._options.dragAndDrop.disableDefaultDropzone?"</div>":"")+"</div>",fileTemplate:'<li><div class="qq-progress-bar"></div><span class="qq-upload-spinner"></span><span class="qq-upload-finished"></span><span class="qq-upload-file"></span><span class="qq-upload-size"></span><a class="qq-upload-cancel" href="#">{cancelButtonText}</a><a class="qq-upload-retry" href="#">{retryButtonText}</a><span class="qq-upload-status-text">{statusText}</span></li>',
classes:{button:"qq-upload-button",drop:"qq-upload-drop-area",dropActive:"qq-upload-drop-area-active",dropDisabled:"qq-upload-drop-area-disabled",list:"qq-upload-list",progressBar:"qq-progress-bar",file:"qq-upload-file",spinner:"qq-upload-spinner",finished:"qq-upload-finished",retrying:"qq-upload-retrying",retryable:"qq-upload-retryable",size:"qq-upload-size",cancel:"qq-upload-cancel",retry:"qq-upload-retry",statusText:"qq-upload-status-text",success:"qq-upload-success",fail:"qq-upload-fail",successIcon:null,
failIcon:null},failedUploadTextDisplay:{mode:"default",maxChars:50,responseProperty:"error",enableTooltip:true},messages:{tooManyFilesError:"You may only drop one file"},retry:{showAutoRetryNote:true,autoRetryNote:"Retrying {retryNum}/{maxAuto}...",showButton:false},showMessage:function(b){alert(b)}},true);qq.extend(this._options,a,true);this._wrapCallbacks();this._options.template=this._options.template.replace(/\{dragZoneText\}/g,this._options.text.dragZone);this._options.template=this._options.template.replace(/\{uploadButtonText\}/g,
this._options.text.uploadButton);this._options.fileTemplate=this._options.fileTemplate.replace(/\{cancelButtonText\}/g,this._options.text.cancelButton);this._options.fileTemplate=this._options.fileTemplate.replace(/\{retryButtonText\}/g,this._options.text.retryButton);this._options.fileTemplate=this._options.fileTemplate.replace(/\{statusText\}/g,"");this._element=this._options.element;this._element.innerHTML=this._options.template;this._listElement=this._options.listElement||this._find(this._element,
"list");this._classes=this._options.classes;if(!this._button)this._button=this._createUploadButton(this._find(this._element,"button"));this._bindCancelAndRetryEvents();this._setupDragDrop()};qq.extend(qq.FineUploader.prototype,qq.FineUploaderBasic.prototype);
qq.extend(qq.FineUploader.prototype,{clearStoredFiles:function(){qq.FineUploaderBasic.prototype.clearStoredFiles.apply(this,arguments);this._listElement.innerHTML=""},addExtraDropzone:function(a){this._setupExtraDropzone(a)},removeExtraDropzone:function(a){var b=this._options.dragAndDrop.extraDropzones;for(var c in b)if(b[c]===a)return this._options.dragAndDrop.extraDropzones.splice(c,1)},getItemByFileId:function(a){for(var b=this._listElement.firstChild;b;){if(b.qqFileId==a)return b;b=b.nextSibling}},
reset:function(){qq.FineUploaderBasic.prototype.reset.apply(this,arguments);this._element.innerHTML=this._options.template;this._listElement=this._options.listElement||this._find(this._element,"list");if(!this._options.button)this._button=this._createUploadButton(this._find(this._element,"button"));this._bindCancelAndRetryEvents();this._setupDragDrop()},_leaving_document_out:function(a){return(qq.chrome()||qq.safari()&&qq.windows())&&a.clientX==0&&a.clientY==0||qq.firefox()&&!a.relatedTarget},_storeFileForLater:function(a){qq.FineUploaderBasic.prototype._storeFileForLater.apply(this,
arguments);var b=this.getItemByFileId(a);qq(this._find(b,"spinner")).hide()},_find:function(a,b){a=qq(a).getByClass(this._options.classes[b])[0];if(!a)throw new Error("element not found "+b);return a},_setupExtraDropzone:function(a){this._options.dragAndDrop.extraDropzones.push(a);this._setupDropzone(a)},_setupDropzone:function(a){var b=this,c=new qq.UploadDropZone({element:a,onEnter:function(e){qq(a).addClass(b._classes.dropActive);e.stopPropagation()},onLeave:function(){},onLeaveNotDescendants:function(){qq(a).removeClass(b._classes.dropActive)},
onDrop:function(e){b._options.dragAndDrop.hideDropzones&&qq(a).hide();qq(a).removeClass(b._classes.dropActive);e.dataTransfer.files.length>1&&!b._options.multiple?b._error("tooManyFilesError",""):b._uploadFileList(e.dataTransfer.files)}});this.addDisposer(function(){c.dispose()});this._options.dragAndDrop.hideDropzones&&qq(a).hide()},_setupDragDrop:function(){var a,b;a=this;if(!this._options.dragAndDrop.disableDefaultDropzone){b=this._find(this._element,"drop");this._options.dragAndDrop.extraDropzones.push(b)}var c=
this._options.dragAndDrop.extraDropzones,e;for(e=0;e<c.length;e++)this._setupDropzone(c[e]);if(!this._options.dragAndDrop.disableDefaultDropzone&&(!qq.ie()||qq.ie10()))this._attach(document,"dragenter",function(){if(!qq(b).hasClass(a._classes.dropDisabled)){b.style.display="block";for(e=0;e<c.length;e++)c[e].style.display="block"}});this._attach(document,"dragleave",function(g){if(a._options.dragAndDrop.hideDropzones&&qq.FineUploader.prototype._leaving_document_out(g))for(e=0;e<c.length;e++)qq(c[e]).hide()});
qq(document).attach("drop",function(g){if(a._options.dragAndDrop.hideDropzones)for(e=0;e<c.length;e++)qq(c[e]).hide();g.preventDefault()})},_onSubmit:function(a,b){qq.FineUploaderBasic.prototype._onSubmit.apply(this,arguments);this._addToList(a,b)},_onProgress:function(a,b,c,e){qq.FineUploaderBasic.prototype._onProgress.apply(this,arguments);var g,l,r,u;g=this.getItemByFileId(a);l=this._find(g,"progressBar");u=Math.round(c/e*100);if(c===e){r=this._find(g,"cancel");qq(r).hide();qq(l).hide();qq(this._find(g,
"statusText")).setText(this._options.text.waitingForResponse);r=this._formatSize(e)}else{r=this._formatProgress(c,e);qq(l).css({display:"block"})}qq(l).css({width:u+"%"});g=this._find(g,"size");qq(g).css({display:"inline"});qq(g).setText(r)},_onComplete:function(a,b,c){qq.FineUploaderBasic.prototype._onComplete.apply(this,arguments);var e=this.getItemByFileId(a);qq(this._find(e,"statusText")).clearText();qq(e).removeClass(this._classes.retrying);qq(this._find(e,"progressBar")).hide();if(!this._options.disableCancelForFormUploads||
qq.UploadHandlerXhr.isSupported())qq(this._find(e,"cancel")).hide();qq(this._find(e,"spinner")).hide();if(c.success){qq(e).addClass(this._classes.success);if(this._classes.successIcon){this._find(e,"finished").style.display="inline-block";qq(e).addClass(this._classes.successIcon)}}else{qq(e).addClass(this._classes.fail);if(this._classes.failIcon){this._find(e,"finished").style.display="inline-block";qq(e).addClass(this._classes.failIcon)}this._options.retry.showButton&&!this._preventRetries[a]&&qq(e).addClass(this._classes.retryable);
this._controlFailureTextDisplay(e,c)}},_onUpload:function(a){qq.FineUploaderBasic.prototype._onUpload.apply(this,arguments);this._showSpinner(this.getItemByFileId(a))},_onBeforeAutoRetry:function(a){var b,c,e,g,l;qq.FineUploaderBasic.prototype._onBeforeAutoRetry.apply(this,arguments);b=this.getItemByFileId(a);c=this._find(b,"progressBar");this._showCancelLink(b);c.style.width=0;qq(c).hide();if(this._options.retry.showAutoRetryNote){c=this._find(b,"statusText");e=this._autoRetries[a]+1;g=this._options.retry.maxAutoAttempts;
l=this._options.retry.autoRetryNote.replace(/\{retryNum\}/g,e);l=l.replace(/\{maxAuto\}/g,g);qq(c).setText(l);e===1&&qq(b).addClass(this._classes.retrying)}},_onBeforeManualRetry:function(a){if(qq.FineUploaderBasic.prototype._onBeforeManualRetry.apply(this,arguments)){var b=this.getItemByFileId(a);this._find(b,"progressBar").style.width=0;qq(b).removeClass(this._classes.fail);this._showSpinner(b);this._showCancelLink(b);return true}return false},_addToList:function(a,b){var c=qq.toElement(this._options.fileTemplate);
if(this._options.disableCancelForFormUploads&&!qq.UploadHandlerXhr.isSupported()){var e=this._find(c,"cancel");qq(e).remove()}c.qqFileId=a;a=this._find(c,"file");qq(a).setText(this._formatFileName(b));qq(this._find(c,"size")).hide();this._options.multiple||this._clearList();this._listElement.appendChild(c)},_clearList:function(){this._listElement.innerHTML="";this.clearStoredFiles()},_bindCancelAndRetryEvents:function(){var a=this;this._attach(this._listElement,"click",function(b){b=b||window.event;
var c=b.target||b.srcElement;if(qq(c).hasClass(a._classes.cancel)||qq(c).hasClass(a._classes.retry)){qq.preventDefault(b);for(b=c.parentNode;b.qqFileId==undefined;)b=c=c.parentNode;if(qq(c).hasClass(a._classes.cancel)){a.cancel(b.qqFileId);qq(b).remove()}else{qq(b).removeClass(a._classes.retryable);a.retry(b.qqFileId)}}})},_formatProgress:function(a,b){function c(g,l){e=e.replace(g,l)}var e=this._options.text.formatProgress;c("{percent}",Math.round(a/b*100));c("{total_size}",this._formatSize(b));
return e},_controlFailureTextDisplay:function(a,b){var c,e,g,l;c=this._options.failedUploadTextDisplay.mode;e=this._options.failedUploadTextDisplay.maxChars;g=this._options.failedUploadTextDisplay.responseProperty;if(c==="custom"){if(b=b[g]){if(b.length>e)l=b.substring(0,e)+"..."}else{b=this._options.text.failUpload;this.log("'"+g+"' is not a valid property on the server response.","warn")}qq(this._find(a,"statusText")).setText(l||b);this._options.failedUploadTextDisplay.enableTooltip&&this._showTooltip(a,
b)}else if(c==="default")qq(this._find(a,"statusText")).setText(this._options.text.failUpload);else c!=="none"&&this.log("failedUploadTextDisplay.mode value of '"+c+"' is not valid","warn")},_showTooltip:function(a,b){a.title=b},_showSpinner:function(a){this._find(a,"spinner").style.display="inline-block"},_showCancelLink:function(a){if(!this._options.disableCancelForFormUploads||qq.UploadHandlerXhr.isSupported())this._find(a,"cancel").style.display="inline"},_error:function(){this._options.showMessage(qq.FineUploaderBasic.prototype._error.apply(this,
arguments))}});qq.UploadDropZone=function(a){this._options={element:null,onEnter:function(){},onLeave:function(){},onLeaveNotDescendants:function(){},onDrop:function(){}};qq.extend(this._options,a);qq.extend(this,qq.DisposeSupport);this._element=this._options.element;this._disableDropOutside();this._attachEvents()};
qq.UploadDropZone.prototype={_dragover_should_be_canceled:function(){return qq.safari()||qq.firefox()&&qq.windows()},_disableDropOutside:function(){if(!qq.UploadDropZone.dropOutsideDisabled){this._dragover_should_be_canceled?qq(document).attach("dragover",function(a){a.preventDefault()}):qq(document).attach("dragover",function(a){if(a.dataTransfer){a.dataTransfer.dropEffect="none";a.preventDefault()}});qq.UploadDropZone.dropOutsideDisabled=true}},_attachEvents:function(){var a=this;a._attach(a._element,
"dragover",function(b){if(a._isValidFileDrag(b)){var c=qq.ie()?null:b.dataTransfer.effectAllowed;b.dataTransfer.dropEffect=c=="move"||c=="linkMove"?"move":"copy";b.stopPropagation();b.preventDefault()}});a._attach(a._element,"dragenter",function(b){a._isValidFileDrag(b)&&a._options.onEnter(b)});a._attach(a._element,"dragleave",function(b){if(a._isValidFileDrag(b)){a._options.onLeave(b);var c=document.elementFromPoint(b.clientX,b.clientY);qq(this).contains(c)||a._options.onLeaveNotDescendants(b)}});
a._attach(a._element,"drop",function(b){if(a._isValidFileDrag(b)){b.preventDefault();a._options.onDrop(b)}})},_isValidFileDrag:function(a){if(qq.ie()&&!qq.ie10())return false;a=a.dataTransfer;var b=qq.safari(),c=qq.ie10()?true:a.effectAllowed!="none";return a&&c&&(a.files||!b&&a.types.contains&&a.types.contains("Files"))}};
qq.UploadHandlerAbstract=function(a){this._options={debug:false,endpoint:"/upload.php",maxConnections:999,log:function(){},onProgress:function(){},onComplete:function(){},onCancel:function(){},onUpload:function(){},onAutoRetry:function(){}};qq.extend(this._options,a);this._queue=[];this._params=[];this.log=this._options.log};
qq.UploadHandlerAbstract.prototype={add:function(){},upload:function(a,b){var c=this._queue.push(a),e={};qq.extend(e,b);this._params[a]=e;c<=this._options.maxConnections&&this._upload(a,this._params[a])},retry:function(a){qq.indexOf(this._queue,a)>=0?this._upload(a,this._params[a]):this.upload(a,this._params[a])},cancel:function(a){this.log("Cancelling "+a);this._cancel(a);this._dequeue(a)},cancelAll:function(){for(var a=0;a<this._queue.length;a++)this._cancel(this._queue[a]);this._queue=[]},getName:function(){},
getSize:function(){},getQueue:function(){return this._queue},reset:function(){this.log("Resetting upload handler");this._queue=[];this._params=[]},_upload:function(){},_cancel:function(){},_dequeue:function(a){a=qq.indexOf(this._queue,a);this._queue.splice(a,1);var b=this._options.maxConnections;if(this._queue.length>=b&&a<b){a=this._queue[b-1];this._upload(a,this._params[a])}},isValid:function(){}};
qq.UploadHandlerForm=function(){qq.UploadHandlerAbstract.apply(this,arguments);this._inputs={};this._detach_load_events={}};qq.extend(qq.UploadHandlerForm.prototype,qq.UploadHandlerAbstract.prototype);
qq.extend(qq.UploadHandlerForm.prototype,{add:function(a){a.setAttribute("name",this._options.inputName);var b="qq-upload-handler-iframe"+qq.getUniqueId();this._inputs[b]=a;a.parentNode&&qq(a).remove();return b},getName:function(a){return this._inputs[a].value.replace(/.*(\/|\\)/,"")},isValid:function(a){return this._inputs[a]!==undefined},reset:function(){qq.UploadHandlerAbstract.prototype.reset.apply(this,arguments);this._inputs={};this._detach_load_events={}},_cancel:function(a){this._options.onCancel(a,
this.getName(a));delete this._inputs[a];delete this._detach_load_events[a];if(a=document.getElementById(a)){a.setAttribute("src","javascript:false;");qq(a).remove()}},_upload:function(a,b){this._options.onUpload(a,this.getName(a),false);var c=this._inputs[a];if(!c)throw new Error("file with passed id was not added, or already uploaded or cancelled");var e=this.getName(a);b[this._options.inputName]=e;var g=this._createIframe(a);b=this._createForm(g,b);b.appendChild(c);var l=this;this._attachLoadEvent(g,
function(){l.log("iframe loaded");var r=l._getIframeContentJSON(g);setTimeout(function(){l._detach_load_events[a]();delete l._detach_load_events[a];qq(g).remove()},1);if(!r.success)if(l._options.onAutoRetry(a,e,r))return;l._options.onComplete(a,e,r);l._dequeue(a)});this.log("Sending upload request for "+a);b.submit();qq(b).remove();return a},_attachLoadEvent:function(a,b){var c=this;this._detach_load_events[a.id]=qq(a).attach("load",function(){c.log("Received response for "+a.id);if(a.parentNode){try{if(a.contentDocument&&
a.contentDocument.body&&a.contentDocument.body.innerHTML=="false")return}catch(e){c.log("Error when attempting to access iframe during handling of upload response ("+e+")","error")}b()}})},_getIframeContentJSON:function(a){try{var b=a.contentDocument?a.contentDocument:a.contentWindow.document,c,e=b.body.innerHTML;this.log("converting iframe's innerHTML to JSON");this.log("innerHTML = "+e);if(e&&e.match(/^<pre/i))e=b.body.firstChild.firstChild.nodeValue;c=eval("("+e+")")}catch(g){this.log("Error when attempting to parse form upload response ("+
g+")","error");c={success:false}}return c},_createIframe:function(a){var b=qq.toElement('<iframe src="javascript:false;" name="'+a+'" />');b.setAttribute("id",a);b.style.display="none";document.body.appendChild(b);return b},_createForm:function(a,b){var c=qq.toElement('<form method="'+(this._options.demoMode?"GET":"POST")+'" enctype="multipart/form-data"></form>');b=qq.obj2url(b,this._options.endpoint);c.setAttribute("action",b);c.setAttribute("target",a.name);c.style.display="none";document.body.appendChild(c);
return c}});qq.UploadHandlerXhr=function(){qq.UploadHandlerAbstract.apply(this,arguments);this._files=[];this._xhrs=[];this._loaded=[]};qq.UploadHandlerXhr.isSupported=function(){var a=document.createElement("input");a.type="file";return"multiple"in a&&typeof File!="undefined"&&typeof FormData!="undefined"&&typeof(new XMLHttpRequest).upload!="undefined"};qq.extend(qq.UploadHandlerXhr.prototype,qq.UploadHandlerAbstract.prototype);
qq.extend(qq.UploadHandlerXhr.prototype,{add:function(a){if(!(a instanceof File))throw new Error("Passed obj in not a File (in qq.UploadHandlerXhr)");return this._files.push(a)-1},getName:function(a){a=this._files[a];return a.fileName!==null&&a.fileName!==undefined?a.fileName:a.name},getSize:function(a){a=this._files[a];return a.fileSize!=null?a.fileSize:a.size},getLoaded:function(a){return this._loaded[a]||0},isValid:function(a){return this._files[a]!==undefined},reset:function(){qq.UploadHandlerAbstract.prototype.reset.apply(this,
arguments);this._files=[];this._xhrs=[];this._loaded=[]},_upload:function(a,b){this._options.onUpload(a,this.getName(a),true);var c=this._files[a],e=this.getName(a);this.getSize(a);this._loaded[a]=0;var g=this._xhrs[a]=new XMLHttpRequest,l=this;g.upload.onprogress=function(r){if(r.lengthComputable){l._loaded[a]=r.loaded;l._options.onProgress(a,e,r.loaded,r.total)}};g.onreadystatechange=function(){g.readyState==4&&l._onComplete(a,g)};b=b||{};b[this._options.inputName]=e;b=qq.obj2url(b,this._options.endpoint);
g.open(this._options.demoMode?"GET":"POST",b,true);g.setRequestHeader("X-Requested-With","XMLHttpRequest");g.setRequestHeader("X-File-Name",encodeURIComponent(e));g.setRequestHeader("Cache-Control","no-cache");if(this._options.forceMultipart){b=new FormData;b.append(this._options.inputName,c);c=b}else{g.setRequestHeader("Content-Type","application/octet-stream");g.setRequestHeader("X-Mime-Type",c.type)}for(key in this._options.customHeaders)g.setRequestHeader(key,this._options.customHeaders[key]);
this.log("Sending upload request for "+a);g.send(c)},_onComplete:function(a,b){if(this._files[a]){var c=this.getName(a),e=this.getSize(a),g;this._options.onProgress(a,c,e,e);this.log("xhr - server response received for "+a);this.log("responseText = "+b.responseText);try{g=typeof JSON.parse==="function"?JSON.parse(b.responseText):eval("("+b.responseText+")")}catch(l){this.log("Error when attempting to parse xhr response text ("+l+")","error");g={}}if(b.status!==200||!g.success)if(this._options.onAutoRetry(a,
c,g,b))return;this._options.onComplete(a,c,g,b);this._xhrs[a]=null;this._dequeue(a)}},_cancel:function(a){this._options.onCancel(a,this.getName(a));this._files[a]=null;if(this._xhrs[a]){this._xhrs[a].abort();this._xhrs[a]=null}}});AjaxFileUploader=function(a){this.initialize(a)};
AjaxFileUploader.prototype={initialize:function(a){this._config=a;this._single_image=a.single_image;this._single_image=a.currentImageUrl||a.inputName&&a.inputName.match(/game_icon/)||this._single_image;var b={element:$(a.elementName),request:{endpoint:a.endpoint,forceMultipart:true,inputName:a.inputName,params:a.params},multiple:false,validation:{allowedExtensions:["jpeg","jpg","gif","png"]},failedUploadTextDisplay:{mode:"custom",responseProperty:"errors"},callbacks:{onComplete:this.onCompleteCallback.bind(this)},
text:{uploadButton:'<span id="game-icon-upload-button">Choose file</span>',dragZone:Prototype.Browser.IE?" ":"Drop files here to upload"},dragAndDrop:{hideDropzones:false}};if(a.currentImageUrl){b.text.uploadButton='<span id="game-icon-upload-button">Change image</span>';b.text.dragZone='<img src="'+a.currentImageUrl+'" alt="game icon" class="fineuploader_preview"/>'}else if(a.screenshots)b.text.uploadButton='<span id="game-icon-upload-button">Choose screenshot</span>';this._uploader=new qq.FineUploader(b);
if(a.screenshots)for(b=0;b<a.screenshots.length;b++)$$("#"+this._config.elementName+" .qq-upload-button").first().insert({after:this.screenshotDiv(a.screenshots[b])})},screenshotDiv:function(a){var b="";b='<div id="screenshot'+a.id+'" class="screenshot_img mtm">';b+="<a href='"+a.url+"' onclick='window.open(this.href);return false;'>";b+='<img src="'+a.url+'" alt="image" />';b+="</a>";b+="<a href='#' onclick='AjaxFileUploader.prototype.destroyScreenshot("+a.id+"); return false' class='close_button h6'>Remove</a>";
b+="</div>";return b},destroyScreenshot:function(a){new Ajax.Request(document.location.pathname.replace("edit","screenshots/"+a).replace("version/new","screenshots/"+a),{method:"delete",onComplete:function(){$("screenshot"+a).remove()}})},onCompleteCallback:function(a,b,c){if(c.success)if(this._single_image){$("game-icon-upload-button").update("Change image");$$("#"+this._config.elementName+" .qq-upload-drop-area span").first().update('<img src="'+c.filename+'" alt="uploaded image" class="fineuploader_preview"/>')}else $$("#"+
this._config.elementName+" .qq-upload-button").first().insert({after:this.screenshotDiv({url:c.filename,id:c.id})})}};var CinematicMode={initialize:function(a){this._disallow_cinematic_scaling=a;this._cinematic_mode_active=this._hooked_up_cinematic_mode_link=false;this._suppress_room_not_found=null;this._showingCinematicMessage=false;this._cinematic_messages=[];this._game_standard_layout=null},hookUpCinematicQuicklink:function(){if(!this._hooked_up_cinematic_mode_link){$("cinematic_mode_link").removeClassName("disabled");$("cinematic_mode_link").observe("click",function(a){a.stop();CinematicMode.activateCinematicMode()});
this._hooked_up_cinematic_mode_link=true}},isInCinematicMode:function(){return $("play").hasClassName("cinematic_mode")},addCinematicMessage:function(a){if(this.isInCinematicMode()){$("cinematic_close_link").addClassName("alt");this._cinematic_messages.push(a);this.showNextCinematicMessage()}},showNextCinematicMessage:function(){if(!this._showingCinematicMessage&&this._cinematic_messages.length>0){this._showingCinematicMessage=true;var a=CinematicMode._cinematic_messages.shift(),b=$("cinematic_close_container").getWidth(),
c=($("game").getWidth()-20-b)/2;$("game").insert('<p id="overlay_message" class="cinematic_alert" style="left:'+c+"px;width:"+b+'px; opacity:0;"><span class="spritegame cinematic_alert_ico mrm"></span><span class="cinematic_alert_text">'+a+"</span></p>");$("overlay_message").fade({duration:2,from:0,to:1,afterFinish:function(){setTimeout(function(){$("overlay_message").fade({duration:2,from:1,to:0,afterFinish:function(){if($("overlay_message")){$("overlay_message").remove();$("cinematic_close_link").removeClassName("alt")}CinematicMode._showingCinematicMessage=
false;CinematicMode.showNextCinematicMessage()}})},3E4)}})}},activateCinematicMode:function(){if(!this._cinematic_mode_active)if(active_user.isAuthenticated()){holodeck.recordAnalyticsEvent("CinematicMode","Enter");var a=$("play");a.addClassName("cinematic_mode");a.insert({top:(new Element("div")).addClassName("cinematic_overlay")});$("cinematic_close_link").show();document.viewport.getDimensions();$("game").getLayout();if($("game").cumulativeOffset()[1]>110)$("play").hasClassName("premium_user")?
$("game").setStyle({top:"50px"}):$("game").setStyle({top:"130px"});this._game_standard_layout=($("game_wrapper")||$("gameholder")).getLayout();$("cinematic_close_container").setStyle({width:this._game_standard_layout.get("width")+"px"});Event.observe(document,"click",this.handleClickInCinematicMode);window.scrollTo(0,0);this.refreshCinematicLayout();Event.observe(window,"resize",this.refreshCinematicLayout);$$(".square_ad").each(function(b){b.hide()});this._cinematic_mode_active=true}else active_user.activateInlineLogin({from_upsell:"cinematic_mode"},
true)},deactivateCinematicMode:function(){if(CinematicMode._cinematic_mode_active){holodeck.recordAnalyticsEvent("CinematicMode","Exit");this._cinematic_mode_active=false;Event.stopObserving(window,"resize",this.refreshCinematicLayout);Event.stopObserving(document,"click",this.deactivateCinematicMode);if(!CinematicMode._disallow_cinematic_scaling){var a=this._game_standard_layout;$("gamediv").width=a.get("width");$("gamediv").height=a.get("height");$("game_wrapper").setStyle({width:a.get("width")+
"px",height:a.get("height")+"px"});$("cinematic_close_container").setStyle({width:a.get("width")+"px"})}a=$("play");a.removeClassName("cinematic_mode");$("cinematic_close_link").hide();$$(".cinematic_overlay").each(Element.remove);$("play").removeClassName("cinematic_small");$$(".square_ad").each(function(b){b.show()});$("game").setStyle({left:"",top:"",width:this._game_standard_layout.get("width")+"px"})}CinematicMode._cinematic_messages=[];$("cinematic_close_link").removeClassName("alt");$("overlay_message")&&
$("overlay_message").remove();a=$("play");a.removeClassName("cinematic_mode");$("cinematic_close_link").hide();$$(".cinematic_overlay").each(Element.remove);$$(".square_ad").each(function(b){b.show()})},handleClickInCinematicMode:function(a){if(!a.findElement("#gamediv")){var b=$("game_wrapper")||$("gameiframe"),c=b.getDimensions();b=b.cumulativeOffset();var e=a.pointerX();a=a.pointerY();e>b.left-30&&e<b.left+c.width+30&&a>b.top-30&&a<b.top+c.height+30||CinematicMode.deactivateCinematicMode()}},refreshCinematicLayout:function(){if(!CinematicMode._disallow_cinematic_scaling){var a=
$("play").hasClassName("premium_user")?80:50,b=CinematicMode._game_standard_layout,c=b.get("width")/b.get("height"),e=document.viewport.getWidth()-110,g=e/c;if(g+$("gamediv").viewportOffset().top+a>document.viewport.getHeight()){g=document.viewport.getHeight()-$("gamediv").viewportOffset().top-a;e=g*c}if(e<b.get("width")){e=b.get("width");g=b.get("height")}$("gamediv").width=e.toFixed();$("gamediv").height=g.toFixed();$("game_wrapper").setStyle({width:e.toFixed()+"px",height:g.toFixed()+"px"});$("overlay_message")&&
$("overlay_message").setStyle({width:e+60+"px"})}a=$("gamediv")||$("gameholder");b=a.getWidth()+60;$("cinematic_close_container").setStyle({width:b+"px"});$("game").setStyle({width:b+"px"});a=(document.viewport.getWidth()-a.getWidth()-60)/2;b=document.viewport.getDimensions().height;$("game").setStyle({left:Math.max(0,a)+"px"});if(b>$("game").getHeight()+129)$("play").hasClassName("cinematic_small")||$("play").addClassName("cinematic_small");else if($("play").hasClassName("premium_user")&&b>$("game").getHeight()+
39)$("play").hasClassName("cinematic_small")||$("play").addClassName("cinematic_small");else $("play").hasClassName("cinematic_small")&&$("play").removeClassName("cinematic_small")}};var SocialHistory=function(a){function b(q,D,J){if(q.currentStyle)var M=q.currentStyle[J];else if(window.getComputedStyle)M=D.defaultView.getComputedStyle(q,null).getPropertyValue(J);return M}function c(q){q.parentNode.removeChild(q)}function e(){var q=document.createElement("iframe");q.style.position="absolute";q.style.visibility="hidden";document.body.appendChild(q);if(q.contentDocument)q.doc=q.contentDocument;else if(q.contentWindow)q.doc=q.contentWindow.document;q.doc.open();q.doc.write("<style>");
q.doc.write("a{color: #000000; display:none;}");q.doc.write("a:visited {color: #FF0000; display:inline;}");q.doc.write("</style>");q.doc.close();return q}function g(q){var D=t.doc.createElement("a");D.href=q;D.innerHTML=r;t.doc.body.appendChild(D)}var l={Digg:["http://digg.com","http://digg.com/login"],Reddit:["http://reddit.com","http://reddit.com/new/","http://reddit.com/controversial/","http://reddit.com/top/","http://reddit.com/r/reddit.com/","http://reddit.com/r/programming/"],StumbleUpon:["http://stumbleupon.com"],
"Yahoo Buzz":["http://buzz.yahoo.com"],Facebook:["http://facebook.com/home.php","http://facebook.com","https://login.facebook.com/login.php"],"Del.icio.us":["https://secure.del.icio.us/login","http://del.icio.us/"],MySpace:["http://www.myspace.com/"],Technorati:["http://www.technorati.com"],Newsvine:["https://www.newsvine.com","https://www.newsvine.com/_tools/user/login"],Songza:["http://songza.com"],Slashdot:["http://slashdot.org/"],"Ma.gnolia":["http://ma.gnolia.com/"],Blinklist:["http://www.blinklist.com"],
Furl:["http://furl.net","http://furl.net/members/login"],"Mister Wong":["http://www.mister-wong.com"],Current:["http://current.com","http://current.com/login.html"],Menaeme:["http://meneame.net","http://meneame.net/login.php"],Oknotizie:["http://oknotizie.alice.it","http://oknotizie.alice.it/login.html.php"],Diigo:["http://www.diigo.com/","https://secure.diigo.com/sign-in"],Funp:["http://funp.com","http://funp.com/account/loginpage.php"],Blogmarks:["http://blogmarks.net"],"Yahoo Bookmarks":["http://bookmarks.yahoo.com"],
Xanga:["http://xanga.com"],Blogger:["http://blogger.com"],"Last.fm":["http://www.last.fm/","https://www.last.fm/login/"],N4G:["http://www.n4g.com"],Faves:["http://faves.com","http://faves.com/home","https://secure.faves.com/signIn"],Simpy:["http://www.simpy.com","http://www.simpy.com/login"],Yigg:["http://www.yigg.de"],Kirtsy:["http://www.kirtsy.com","http://www.kirtsy.com/login.php"],Fark:["http://www.fark.com","http://cgi.fark.com/cgi/fark/users.pl?self=1"],Mixx:["https://www.mixx.com/login/dual",
"http://www.mixx.com"],"Google Bookmarks":["http://www.google.com/bookmarks","http://www.google.com/ig/add?moduleurl=bookmarks.xml&hl=en"],Subbmitt:["http://subbmitt.com/"],Twitter:["http://twitter.com","http://twitter.com/login"]};for(var r in a){if(typeof l[r]=="undefined")l[r]=[];if(typeof a[r]=="string")l[r].push(a[r]);else l[r]=l[r].concat(a[r])}var u={},t=e();for(r in l){var v=l[r];for(a=0;a<v.length;a++){g(v[a],r);if(v[a].match(/www\./)){var G=v[a].replace(/www\./,"");g(G,r)}else{G=v[a].indexOf("//")+
2;G=v[a].substring(0,G)+"www."+v[a].substring(G);g(G,r)}}}v=t.doc.body.childNodes;for(a=0;a<v.length;a++)if(b(v[a],t.doc,"display")!="none")u[v[a].innerHTML]=true;c(t);return new (function(){var q=[];for(var D in u)q.push(D);this.visitedSites=function(){return q};this.doesVisit=function(M){if(typeof l[M]=="undefined")return-1;return typeof u[M]!="undefined"};var J=[];for(D in l)J.push(D);this.checkedSites=function(){return J}})};function subjectChanged(a){if($("select_type")){var b=$F("select_type");b&&b!=""&&$("abuse_form_submit").enable();if(b=="OtherAbuseReport"||b=="InappropriateChatReport"||b=="UnderageUserReport"||b=="PermabanRequest"){$("description_field").show();updateDescriptionPrompt(true,a)}if(b=="InappropriateUsernameReport"||b=="InappropriateAvatarReport"||b=="InappropriateProfileReport"){$("description_field").show();updateDescriptionPrompt(false,a)}}}
function updateDescriptionPrompt(a,b){b="Please describe your reason for reporting "+b+" using as much detail as possible";var c=$("abuse_report_description_label_block").innerHTML;a=a?c.gsub("Please add any other information that would be helpful",b):c.gsub(b,"Please add any other information that would be helpful");$("abuse_report_description_label_block").update(a)};function upd(a,b,c){if(a.checked||c=="always"){if(c){index=a.id.substring(a.id.indexOf("[")+1,a.id.indexOf("]"));radio_id="handle["+index+"]";$(radio_id).checked="handle"}b&&b.show()}else b&&b.hide()};function AgeGate(a,b){a&&b?this.initialize(a,b):this.initialize(null,a)}AgeGate.MONTHS=["January","February","March","April","May","June","July","August","September","October","November","December"];
AgeGate.prototype={initialize:function(a,b){var c=this;this._cookie_name=b.cookie_name||"age_gate";this._active_user=b.active_user||active_user;this._required_age=b.required_age;this._age_met=false;if(this._use_form=b.use_form===undefined?true:b.use_form){this._element=$(a);this._button_text=b.button_text||"Go"}this._onSuccess=(b.onSuccess||function(){}).wrap(function(e){c._age_met=true;Cookie.set(c._cookie_name,"YES");return e()});this._onFailure=(b.onFailure||function(){}).wrap(function(e){Cookie.set(c._cookie_name,
"NO");return e()});this._onError=b.onError||function(){};this.preflight()||this._age_met||(this._use_form?this.writeForm():this._onFailure())},preflight:function(){var a=this._active_user.age();if(a){a>=this._required_age?this._onSuccess():this._onFailure();return true}a=Cookie.get(this._cookie_name);if(a=="YES"){this._onSuccess();return true}else if(a=="NO"){this._onFailure();return true}return false},writeForm:function(){var a=this,b="",c=0;b='<form action="#">';b+="<dl>";b+="<dt><label>Date of Birth</label></dt>";
b+='<dd id="date">';b+='<select id="user_month" name="user_month">';b+='<option value=""></option>';for(c=0;c<AgeGate.MONTHS.length;c++)b+='<option value="'+c+'">'+AgeGate.MONTHS[c]+"</option>";b+="</select>";b+='<select id="user_day" name="user_day">';b+='<option value=""></option>';for(c=1;c<=31;c++)b+='<option value="'+c+'">'+c+"</option>";b+="</select>";b+='<select id="user_year" name="user_year">';b+='<option value=""></option>';for(c=2005;c>=1908;c--)b+='<option value="'+c+'">'+c+"</option>";
b+="</select>";b+="</dd>";b+="</dl>";b+='<input type="submit" value="'+this._button_text+'" />';b+="</form>";this._element.innerHTML+=b;(function(){a._element.immediateDescendants()[0].onsubmit=function(){a.checkAge(this);return false}}).defer()},checkAge:function(a){var b=Number(a.user_month.getValue()),c=Number(a.user_day.getValue());a=Number(a.user_year.getValue());if(isNaN(b)||c===0||a===0)this._onError();else{b=new Date(a+this._required_age,b,c);(new Date).getTime()-b.getTime()<0?this._onFailure():
this._onSuccess()}}};AvailabilityCheck=function(a,b){this.initialize(a,b)};
AvailabilityCheck.prototype={initialize:function(a,b){b||(b={});this.request=null;this.generatedUsername=b.generatedUsername;this.validateLength=!!b.validateLength;this.blurHandler=null;this.clear=b.clear||function(){$("availability_success").hide();$("availability_failure").hide()};this.success=b.success||function(){$("availability_success").show()};this.failure=b.failure||function(c){$("availability_failure").update(c).show()};Event.observe(a,"blur",this.blur.bind(this));Event.observe(a,"keyup",
this.keyup.bind(this))},blur:function(a){if(this.checker||a.target.value)this.makeRequest(a)},keyup:function(a){if(this.request){this.request.transport.abort();this.request=null;$("checking_availability").hide()}this.checker&&clearTimeout(this.checker);this.checker=setTimeout(this.makeRequest.bind(this,a),1E3)},makeRequest:function(a){var b=this,c=a.target.value;if(this.generatedUsername&&this.generatedUsername==c){this.clear();this.success()}else if(c.length==0){if(this.validateLength){this.clear();
b.failure("Username can't be blank")}}else if(c.length<4){if(this.validateLength){this.clear();b.failure("Username is too short, needs to be between 4 to 16 characters")}}else if(c.length>16){if(this.validateLength){this.clear();b.failure("Username is too long, needs to be between 4 to 16 characters")}}else if(this.request==null){$("checking_availability").show();this.clear();this.request=new Ajax.Request("/accounts/availability",{parameters:{username:a.target.value},method:"get",onSuccess:function(e){e=
String(e.responseText).evalJSON();$("checking_availability").hide();e.success?b.success():b.failure("Username taken. Please try again.")}})}}};function hideAllButOne(a,b){$$(a).each(function(c){Element.hide(c)});Element.show(b)};Base64=function(){var a=function(c){c=c.replace(/\r\n/g,"\n");var e="",g,l,r;g=0;for(l=c.length;g<l;g++){r=c.charCodeAt(g);if(r<128)e+=String.fromCharCode(r);else{if(r>127&&r<2048)e+=String.fromCharCode(r>>6|192);else{e+=String.fromCharCode(r>>12|224);e+=String.fromCharCode(r>>6&63|128)}e+=String.fromCharCode(r&63|128)}}return e},b=function(c){for(var e="",g=0,l=c1=c2=0;g<c.length;){l=c.charCodeAt(g);if(l<128){e+=String.fromCharCode(l);g++}else if(l>191&&l<224){c2=c.charCodeAt(g+1);e+=String.fromCharCode((l&
31)<<6|c2&63);g+=2}else{c2=c.charCodeAt(g+1);c3=c.charCodeAt(g+2);e+=String.fromCharCode((l&15)<<12|(c2&63)<<6|c3&63);g+=3}}return e};return{encode:function(c){var e="",g,l,r,u,t,v,G=0;for(c=a(c);G<c.length;){g=c.charCodeAt(G++);l=c.charCodeAt(G++);r=c.charCodeAt(G++);u=g>>2;g=(g&3)<<4|l>>4;t=(l&15)<<2|r>>6;v=r&63;if(isNaN(l))t=v=64;else if(isNaN(r))v=64;e=e+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(u)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(v)}return e},decode:function(c){var e="",g,l,r,u,t,v=0;for(c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");v<c.length;){g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(v++));l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(v++));u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(v++));
t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(v++));g=g<<2|l>>4;l=(l&15)<<4|u>>2;r=(u&3)<<6|t;e+=String.fromCharCode(g);if(u!=64)e+=String.fromCharCode(l);if(t!=64)e+=String.fromCharCode(r)}return e=b(e)}}}();Array.prototype.binarySearch=function(a,b,c){b||(b=function(u,t){return u==t?0:u<t?-1:1});for(var e=0,g=this.length-1,l,r;e<=g;){l=Math.floor((e+g)/2);r=b(this[l],a);if(r<0)e=l+1;else if(r>0)g=l-1;else return l}if(c)return e;return-1};Array.prototype.orderedInsert=function(a,b){b=this.binarySearch(a,b,true);this.splice(b,0,a);return b};Array.prototype.orderedDelete=function(a,b){a=this.binarySearch(a,b);a>=0&&this.splice(a,1);return a};var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(a){for(var b=0;b<a.length;b++){var c=a[b].string,e=a[b].prop;this.versionSearchString=a[b].versionSearch||a[b].identity;if(c){if(c.indexOf(a[b].subString)!=-1)return a[b].identity}else if(e)return a[b].identity}},
searchVersion:function(a){var b=a.indexOf(this.versionSearchString);if(b!=-1)return parseFloat(a.substring(b+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,
subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},
{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};CampaignAvatarPicker=function(a){var b=function(c){var e=(c.element().up("a")||c.element()).readAttribute("data-avatar-id"),g="/accounts/"+active_user.username()+"/pick_campaign_avatar";if(active_user.isAuthenticated())new Ajax.Request(g,{parameters:{campaign_avatar_id:e},onCreate:function(){var l=$$(a).first();l.insert({after:new Element("img",{src:"/images/presentation/indicator_barbershop.gif",id:"campaign-avatar-picker-indicator"})});l.hide()},onSuccess:function(){window.location.reload()},onFailure:function(){alert("Sorry! We were unable to change your avatar. Please try again later.");
$$(a).first().show();$("campaign-avatar-picker-indicator").remove()}});else active_user.activateInlineLogin({},true);c.preventDefault()};$$(a+" li a").each(function(c){c.observe("click",b)})};function onClickablePodClick(a){if("A"!=a.element().nodeName){a=a.element();if(a=a.hasClassName("js_clickable_pod")?a:a.up(".js_clickable_pod")){a=a.down(".js_clickable_pod_link");document.location=a.href}}}function observeClickablePods(){$$(".js_clickable_pod").each(function(a){a.observe("click",onClickablePodClick)})};if(Object.isUndefined(Effect))throw"dragdrop.js requires including script.aculo.us' effects.js library";
var Droppables={drops:[],remove:function(a){this.drops=this.drops.reject(function(b){return b.element==$(a)})},add:function(a,b){a=$(a);var c=Object.extend({greedy:true,hoverclass:null,tree:false},b||{});if(c.containment){c._containers=[];b=c.containment;Object.isArray(b)?b.each(function(e){c._containers.push($(e))}):c._containers.push($(b))}if(c.accept)c.accept=[c.accept].flatten();Element.makePositioned(a);c.element=a;this.drops.push(c)},findDeepestChild:function(a){deepest=a[0];for(i=1;i<a.length;++i)if(Element.isParent(a[i].element,
deepest.element))deepest=a[i];return deepest},isContained:function(a,b){var c;c=b.tree?a.treeNode:a.parentNode;return b._containers.detect(function(e){return c==e})},isAffected:function(a,b,c){return c.element!=b&&(!c._containers||this.isContained(b,c))&&(!c.accept||Element.classNames(b).detect(function(e){return c.accept.include(e)}))&&Position.within(c.element,a[0],a[1])},deactivate:function(a){a.hoverclass&&Element.removeClassName(a.element,a.hoverclass);this.last_active=null},activate:function(a){a.hoverclass&&
Element.addClassName(a.element,a.hoverclass);this.last_active=a},show:function(a,b){if(this.drops.length){var c,e=[];this.drops.each(function(g){Droppables.isAffected(a,b,g)&&e.push(g)});if(e.length>0)c=Droppables.findDeepestChild(e);this.last_active&&this.last_active!=c&&this.deactivate(this.last_active);if(c){Position.within(c.element,a[0],a[1]);c.onHover&&c.onHover(b,c.element,Position.overlap(c.overlap,c.element));c!=this.last_active&&Droppables.activate(c)}}},fire:function(a,b){if(this.last_active){Position.prepare();
if(this.isAffected([Event.pointerX(a),Event.pointerY(a)],b,this.last_active))if(this.last_active.onDrop){this.last_active.onDrop(b,this.last_active.element,a);return true}}},reset:function(){this.last_active&&this.deactivate(this.last_active)}},Draggables={drags:[],observers:[],register:function(a){if(this.drags.length==0){this.eventMouseUp=this.endDrag.bindAsEventListener(this);this.eventMouseMove=this.updateDrag.bindAsEventListener(this);this.eventKeypress=this.keyPress.bindAsEventListener(this);
Event.observe(document,"mouseup",this.eventMouseUp);Event.observe(document,"mousemove",this.eventMouseMove);Event.observe(document,"keypress",this.eventKeypress)}this.drags.push(a)},unregister:function(a){this.drags=this.drags.reject(function(b){return b==a});if(this.drags.length==0){Event.stopObserving(document,"mouseup",this.eventMouseUp);Event.stopObserving(document,"mousemove",this.eventMouseMove);Event.stopObserving(document,"keypress",this.eventKeypress)}},activate:function(a){if(a.options.delay)this._timeout=
setTimeout(function(){Draggables._timeout=null;window.focus();Draggables.activeDraggable=a}.bind(this),a.options.delay);else{window.focus();this.activeDraggable=a}},deactivate:function(){this.activeDraggable=null},updateDrag:function(a){if(this.activeDraggable){var b=[Event.pointerX(a),Event.pointerY(a)];if(!(this._lastPointer&&this._lastPointer.inspect()==b.inspect())){this._lastPointer=b;this.activeDraggable.updateDrag(a,b)}}},endDrag:function(a){if(this._timeout){clearTimeout(this._timeout);this._timeout=
null}if(this.activeDraggable){this._lastPointer=null;this.activeDraggable.endDrag(a);this.activeDraggable=null}},keyPress:function(a){this.activeDraggable&&this.activeDraggable.keyPress(a)},addObserver:function(a){this.observers.push(a);this._cacheObserverCallbacks()},removeObserver:function(a){this.observers=this.observers.reject(function(b){return b.element==a});this._cacheObserverCallbacks()},notify:function(a,b,c){this[a+"Count"]>0&&this.observers.each(function(e){e[a]&&e[a](a,b,c)});b.options[a]&&
b.options[a](b,c)},_cacheObserverCallbacks:function(){["onStart","onEnd","onDrag"].each(function(a){Draggables[a+"Count"]=Draggables.observers.select(function(b){return b[a]}).length})}},Draggable=Class.create({initialize:function(a,b){var c={handle:false,reverteffect:function(e,g,l){var r=Math.sqrt(Math.abs(g^2)+Math.abs(l^2))*0.02;new Effect.Move(e,{x:-l,y:-g,duration:r,queue:{scope:"_draggable",position:"end"}})},endeffect:function(e){var g=Object.isNumber(e._opacity)?e._opacity:1;new Effect.Opacity(e,
{duration:0.2,from:0.7,to:g,queue:{scope:"_draggable",position:"end"},afterFinish:function(){Draggable._dragging[e]=false}})},zindex:1E3,revert:false,quiet:false,scroll:false,scrollSensitivity:20,scrollSpeed:15,snap:false,delay:0};if(!b||Object.isUndefined(b.endeffect))Object.extend(c,{starteffect:function(e){e._opacity=Element.getOpacity(e);Draggable._dragging[e]=true;new Effect.Opacity(e,{duration:0.2,from:e._opacity,to:0.7})}});b=Object.extend(c,b||{});this.element=$(a);if(b.handle&&Object.isString(b.handle))this.handle=
this.element.down("."+b.handle,0);if(!this.handle)this.handle=$(b.handle);if(!this.handle)this.handle=this.element;if(b.scroll&&!b.scroll.scrollTo&&!b.scroll.outerHTML){b.scroll=$(b.scroll);this._isScrollChild=Element.childOf(this.element,b.scroll)}Element.makePositioned(this.element);this.options=b;this.dragging=false;this.eventMouseDown=this.initDrag.bindAsEventListener(this);Event.observe(this.handle,"mousedown",this.eventMouseDown);Draggables.register(this)},destroy:function(){Event.stopObserving(this.handle,
"mousedown",this.eventMouseDown);Draggables.unregister(this)},currentDelta:function(){return[parseInt(Element.getStyle(this.element,"left")||"0"),parseInt(Element.getStyle(this.element,"top")||"0")]},initDrag:function(a){if(!(!Object.isUndefined(Draggable._dragging[this.element])&&Draggable._dragging[this.element]))if(Event.isLeftClick(a))if(!((tag_name=Event.element(a).tagName.toUpperCase())&&(tag_name=="INPUT"||tag_name=="SELECT"||tag_name=="OPTION"||tag_name=="BUTTON"||tag_name=="TEXTAREA"))){var b=
[Event.pointerX(a),Event.pointerY(a)],c=Position.cumulativeOffset(this.element);this.offset=[0,1].map(function(e){return b[e]-c[e]});Draggables.activate(this);Event.stop(a)}},startDrag:function(a){this.dragging=true;if(!this.delta)this.delta=this.currentDelta();if(this.options.zindex){this.originalZ=parseInt(Element.getStyle(this.element,"z-index")||0);this.element.style.zIndex=this.options.zindex}if(this.options.ghosting){this._clone=this.element.cloneNode(true);(this._originallyAbsolute=this.element.getStyle("position")==
"absolute")||Position.absolutize(this.element);this.element.parentNode.insertBefore(this._clone,this.element)}if(this.options.scroll)if(this.options.scroll==window){var b=this._getWindowScroll(this.options.scroll);this.originalScrollLeft=b.left;this.originalScrollTop=b.top}else{this.originalScrollLeft=this.options.scroll.scrollLeft;this.originalScrollTop=this.options.scroll.scrollTop}Draggables.notify("onStart",this,a);this.options.starteffect&&this.options.starteffect(this.element)},updateDrag:function(a,
b){this.dragging||this.startDrag(a);if(!this.options.quiet){Position.prepare();Droppables.show(b,this.element)}Draggables.notify("onDrag",this,a);this.draw(b);this.options.change&&this.options.change(this);if(this.options.scroll){this.stopScrolling();var c;if(this.options.scroll==window)with(this._getWindowScroll(this.options.scroll))c=[left,top,left+width,top+height];else{c=Position.page(this.options.scroll);c[0]+=this.options.scroll.scrollLeft+Position.deltaX;c[1]+=this.options.scroll.scrollTop+
Position.deltaY;c.push(c[0]+this.options.scroll.offsetWidth);c.push(c[1]+this.options.scroll.offsetHeight)}var e=[0,0];if(b[0]<c[0]+this.options.scrollSensitivity)e[0]=b[0]-(c[0]+this.options.scrollSensitivity);if(b[1]<c[1]+this.options.scrollSensitivity)e[1]=b[1]-(c[1]+this.options.scrollSensitivity);if(b[0]>c[2]-this.options.scrollSensitivity)e[0]=b[0]-(c[2]-this.options.scrollSensitivity);if(b[1]>c[3]-this.options.scrollSensitivity)e[1]=b[1]-(c[3]-this.options.scrollSensitivity);this.startScrolling(e)}Prototype.Browser.WebKit&&
window.scrollBy(0,0);Event.stop(a)},finishDrag:function(a,b){this.dragging=false;if(this.options.quiet){Position.prepare();var c=[Event.pointerX(a),Event.pointerY(a)];Droppables.show(c,this.element)}if(this.options.ghosting){this._originallyAbsolute||Position.relativize(this.element);delete this._originallyAbsolute;Element.remove(this._clone);this._clone=null}c=false;if(b)(c=Droppables.fire(a,this.element))||(c=false);c&&this.options.onDropped&&this.options.onDropped(this.element);Draggables.notify("onEnd",
this,a);if((a=this.options.revert)&&Object.isFunction(a))a=a(this.element);b=this.currentDelta();if(a&&this.options.reverteffect){if(c==0||a!="failure")this.options.reverteffect(this.element,b[1]-this.delta[1],b[0]-this.delta[0])}else this.delta=b;if(this.options.zindex)this.element.style.zIndex=this.originalZ;this.options.endeffect&&this.options.endeffect(this.element);Draggables.deactivate(this);Droppables.reset()},keyPress:function(a){if(a.keyCode==Event.KEY_ESC){this.finishDrag(a,false);Event.stop(a)}},
endDrag:function(a){if(this.dragging){this.stopScrolling();this.finishDrag(a,true);Event.stop(a)}},draw:function(a){var b=Position.cumulativeOffset(this.element);if(this.options.ghosting){var c=Position.realOffset(this.element);b[0]+=c[0]-Position.deltaX;b[1]+=c[1]-Position.deltaY}c=this.currentDelta();b[0]-=c[0];b[1]-=c[1];if(this.options.scroll&&this.options.scroll!=window&&this._isScrollChild){b[0]-=this.options.scroll.scrollLeft-this.originalScrollLeft;b[1]-=this.options.scroll.scrollTop-this.originalScrollTop}c=
[0,1].map(function(g){return a[g]-b[g]-this.offset[g]}.bind(this));if(this.options.snap)c=Object.isFunction(this.options.snap)?this.options.snap(c[0],c[1],this):Object.isArray(this.options.snap)?c.map(function(g,l){return(g/this.options.snap[l]).round()*this.options.snap[l]}.bind(this)):c.map(function(g){return(g/this.options.snap).round()*this.options.snap}.bind(this));var e=this.element.style;if(!this.options.constraint||this.options.constraint=="horizontal")e.left=c[0]+"px";if(!this.options.constraint||
this.options.constraint=="vertical")e.top=c[1]+"px";if(e.visibility=="hidden")e.visibility=""},stopScrolling:function(){if(this.scrollInterval){clearInterval(this.scrollInterval);this.scrollInterval=null;Draggables._lastScrollPointer=null}},startScrolling:function(a){if(a[0]||a[1]){this.scrollSpeed=[a[0]*this.options.scrollSpeed,a[1]*this.options.scrollSpeed];this.lastScrolled=new Date;this.scrollInterval=setInterval(this.scroll.bind(this),10)}},scroll:function(){var a=new Date,b=a-this.lastScrolled;
this.lastScrolled=a;if(this.options.scroll==window)with(this._getWindowScroll(this.options.scroll)){if(this.scrollSpeed[0]||this.scrollSpeed[1]){a=b/1E3;this.options.scroll.scrollTo(left+a*this.scrollSpeed[0],top+a*this.scrollSpeed[1])}}else{this.options.scroll.scrollLeft+=this.scrollSpeed[0]*b/1E3;this.options.scroll.scrollTop+=this.scrollSpeed[1]*b/1E3}Position.prepare();Droppables.show(Draggables._lastPointer,this.element);Draggables.notify("onDrag",this);if(this._isScrollChild){Draggables._lastScrollPointer=
Draggables._lastScrollPointer||$A(Draggables._lastPointer);Draggables._lastScrollPointer[0]+=this.scrollSpeed[0]*b/1E3;Draggables._lastScrollPointer[1]+=this.scrollSpeed[1]*b/1E3;if(Draggables._lastScrollPointer[0]<0)Draggables._lastScrollPointer[0]=0;if(Draggables._lastScrollPointer[1]<0)Draggables._lastScrollPointer[1]=0;this.draw(Draggables._lastScrollPointer)}this.options.change&&this.options.change(this)},_getWindowScroll:function(a){var b,c,e;with(a.document){if(a.document.documentElement&&
documentElement.scrollTop){b=documentElement.scrollTop;c=documentElement.scrollLeft}else if(a.document.body){b=body.scrollTop;c=body.scrollLeft}if(a.innerWidth){e=a.innerWidth;a=a.innerHeight}else if(a.document.documentElement&&documentElement.clientWidth){e=documentElement.clientWidth;a=documentElement.clientHeight}else{e=body.offsetWidth;a=body.offsetHeight}}return{top:b,left:c,width:e,height:a}}});Draggable._dragging={};
var SortableObserver=Class.create({initialize:function(a,b){this.element=$(a);this.observer=b;this.lastValue=Sortable.serialize(this.element)},onStart:function(){this.lastValue=Sortable.serialize(this.element)},onEnd:function(){Sortable.unmark();this.lastValue!=Sortable.serialize(this.element)&&this.observer(this.element)}}),Sortable={SERIALIZE_RULE:/^[^_\-](?:[A-Za-z0-9\-\_]*)[_](.*)$/,sortables:{},_findRootElement:function(a){for(;a.tagName.toUpperCase()!="BODY";){if(a.id&&Sortable.sortables[a.id])return a;
a=a.parentNode}},options:function(a){if(a=Sortable._findRootElement($(a)))return Sortable.sortables[a.id]},destroy:function(a){a=$(a);if(a=Sortable.sortables[a.id]){Draggables.removeObserver(a.element);a.droppables.each(function(b){Droppables.remove(b)});a.draggables.invoke("destroy");delete Sortable.sortables[a.element.id]}},create:function(a,b){a=$(a);var c=Object.extend({element:a,tag:"li",dropOnEmpty:false,tree:false,treeTag:"ul",overlap:"vertical",constraint:"vertical",containment:a,handle:false,
only:false,delay:0,hoverclass:null,ghosting:false,quiet:false,scroll:false,scrollSensitivity:20,scrollSpeed:15,format:this.SERIALIZE_RULE,elements:false,handles:false,onChange:Prototype.emptyFunction,onUpdate:Prototype.emptyFunction},b||{});this.destroy(a);var e={revert:true,quiet:c.quiet,scroll:c.scroll,scrollSpeed:c.scrollSpeed,scrollSensitivity:c.scrollSensitivity,delay:c.delay,ghosting:c.ghosting,constraint:c.constraint,handle:c.handle};if(c.starteffect)e.starteffect=c.starteffect;if(c.reverteffect)e.reverteffect=
c.reverteffect;else if(c.ghosting)e.reverteffect=function(r){r.style.top=0;r.style.left=0};if(c.endeffect)e.endeffect=c.endeffect;if(c.zindex)e.zindex=c.zindex;var g={overlap:c.overlap,containment:c.containment,tree:c.tree,hoverclass:c.hoverclass,onHover:Sortable.onHover},l={onHover:Sortable.onEmptyHover,overlap:c.overlap,containment:c.containment,hoverclass:c.hoverclass};Element.cleanWhitespace(a);c.draggables=[];c.droppables=[];if(c.dropOnEmpty||c.tree){Droppables.add(a,l);c.droppables.push(a)}(c.elements||
this.findElements(a,c)||[]).each(function(r,u){u=c.handles?$(c.handles[u]):c.handle?$(r).select("."+c.handle)[0]:r;c.draggables.push(new Draggable(r,Object.extend(e,{handle:u})));Droppables.add(r,g);if(c.tree)r.treeNode=a;c.droppables.push(r)});if(c.tree)(Sortable.findTreeElements(a,c)||[]).each(function(r){Droppables.add(r,l);r.treeNode=a;c.droppables.push(r)});this.sortables[a.id]=c;Draggables.addObserver(new SortableObserver(a,c.onUpdate))},findElements:function(a,b){return Element.findChildren(a,
b.only,b.tree?true:false,b.tag)},findTreeElements:function(a,b){return Element.findChildren(a,b.only,b.tree?true:false,b.treeTag)},onHover:function(a,b,c){if(!Element.isParent(b,a))if(!(c>0.33&&c<0.66&&Sortable.options(b).tree))if(c>0.5){Sortable.mark(b,"before");if(b.previousSibling!=a){c=a.parentNode;a.style.visibility="hidden";b.parentNode.insertBefore(a,b);b.parentNode!=c&&Sortable.options(c).onChange(a);Sortable.options(b.parentNode).onChange(a)}}else{Sortable.mark(b,"after");var e=b.nextSibling||
null;if(e!=a){c=a.parentNode;a.style.visibility="hidden";b.parentNode.insertBefore(a,e);b.parentNode!=c&&Sortable.options(c).onChange(a);Sortable.options(b.parentNode).onChange(a)}}},onEmptyHover:function(a,b,c){var e=a.parentNode,g=Sortable.options(b);if(!Element.isParent(b,a)){var l=Sortable.findElements(b,{tag:g.tag,only:g.only}),r=null;if(l){var u=Element.offsetSize(b,g.overlap)*(1-c);for(c=0;c<l.length;c+=1)if(u-Element.offsetSize(l[c],g.overlap)>=0)u-=Element.offsetSize(l[c],g.overlap);else{r=
u-Element.offsetSize(l[c],g.overlap)/2>=0?c+1<l.length?l[c+1]:null:l[c];break}}b.insertBefore(a,r);Sortable.options(e).onChange(a);g.onChange(a)}},unmark:function(){Sortable._marker&&Sortable._marker.hide()},mark:function(a,b){var c=Sortable.options(a.parentNode);if(!(c&&!c.ghosting)){if(!Sortable._marker){Sortable._marker=($("dropmarker")||Element.extend(document.createElement("DIV"))).hide().addClassName("dropmarker").setStyle({position:"absolute"});document.getElementsByTagName("body").item(0).appendChild(Sortable._marker)}var e=
Position.cumulativeOffset(a);Sortable._marker.setStyle({left:e[0]+"px",top:e[1]+"px"});if(b=="after")c.overlap=="horizontal"?Sortable._marker.setStyle({left:e[0]+a.clientWidth+"px"}):Sortable._marker.setStyle({top:e[1]+a.clientHeight+"px"});Sortable._marker.show()}},_tree:function(a,b,c){for(var e=Sortable.findElements(a,b)||[],g=0;g<e.length;++g){var l=e[g].id.match(b.format);if(l){l={id:encodeURIComponent(l?l[1]:null),element:a,parent:c,children:[],position:c.children.length,container:$(e[g]).down(b.treeTag)};
l.container&&this._tree(l.container,b,l);c.children.push(l)}}return c},tree:function(a,b){a=$(a);var c=this.options(a);b=Object.extend({tag:c.tag,treeTag:c.treeTag,only:c.only,name:a.id,format:c.format},b||{});return Sortable._tree(a,b,{id:null,parent:null,children:[],container:a,position:0})},_constructIndex:function(a){var b="";do if(a.id)b="["+a.position+"]"+b;while((a=a.parent)!=null);return b},sequence:function(a,b){a=$(a);var c=Object.extend(this.options(a),b||{});return $(this.findElements(a,
c)||[]).map(function(e){return e.id.match(c.format)?e.id.match(c.format)[1]:""})},setSequence:function(a,b,c){a=$(a);var e=Object.extend(this.options(a),c||{}),g={};this.findElements(a,e).each(function(l){if(l.id.match(e.format))g[l.id.match(e.format)[1]]=[l,l.parentNode];l.parentNode.removeChild(l)});b.each(function(l){var r=g[l];if(r){r[1].appendChild(r[0]);delete g[l]}})},serialize:function(a,b){a=$(a);var c=Object.extend(Sortable.options(a),b||{}),e=encodeURIComponent(b&&b.name?b.name:a.id);return c.tree?
Sortable.tree(a,b).children.map(function(g){return[e+Sortable._constructIndex(g)+"[id]="+encodeURIComponent(g.id)].concat(g.children.map(arguments.callee))}).flatten().join("&"):Sortable.sequence(a,b).map(function(g){return e+"[]="+encodeURIComponent(g)}).join("&")}};Element.isParent=function(a,b){if(!a.parentNode||a==b)return false;if(a.parentNode==b)return true;return Element.isParent(a.parentNode,b)};
Element.findChildren=function(a,b,c,e){if(!a.hasChildNodes())return null;e=e.toUpperCase();if(b)b=[b].flatten();var g=[];$A(a.childNodes).each(function(l){if(l.tagName&&l.tagName.toUpperCase()==e&&(!b||Element.classNames(l).detect(function(r){return b.include(r)})))g.push(l);if(c)(l=Element.findChildren(l,b,c,e))&&g.push(l)});return g.length>0?g.flatten():[]};Element.offsetSize=function(a,b){return a["offset"+(b=="vertical"||b=="height"?"Height":"Width")]};DynamicFrameTarget=function(a){this.initialize(a)};
DynamicFrameTarget.prototype={initialize:function(a){this.name="dynamic_frame_"+ +new Date;this.frame=new Element("iframe",{name:this.name,id:this.name});$(document.body).insert(this.frame);this.frame.setStyle({display:"none"});a.form.target=this.name;var b=this,c=function(){var e;if(this.contentDocument)e=this.contentDocument;else if(this.contentWindow)e=this.contentWindow.document;else if(window.frames[this.name])e=window.frames[iframe.name].document;else if(b.frame.contentWindow.document)e=b.frame.contentWindow.document;
if(e&&e.body.innerHTML.length>0){e=e.body;e=String((e.childElementCount>0?e.children[0]:e).innerHTML).evalJSON();b.callback(e)}};if(this.frame.attachEvent)this.frame.attachEvent("onload",c);else this.frame.onload=c;this.callback=a.callback?a.callback:function(e){if(e.success)a.success&&a.success(e);else a.failure&&a.failure(e)}}};DynamicFrameTarget.subclasses=[];var DynamicScriptLoader=function(){return{load:function(a,b){(function(){var c=new Element("script",{src:a,type:"text/javascript"});$$("head")[0].insert(c)}).runWhenDomLoaded(b)}}}();var FacebookApiLoader=function(){function a(t){t.status==="connected"&&t.authResponse.userID==active_user.facebook_uid()&&c(t.authResponse)}function b(){FB.getLoginStatus(a)}function c(t){var v=(new Element("form",{action:"https://"+location.hostname+"/facebook_connection/update_auth_token",method:"post"})).setStyle({display:"none"});$(document.body).insert(v);v.insert(new Element("input",{type:"hidden",name:"access_token",value:t.accessToken}));v.insert(new Element("input",{type:"hidden",name:"expires",
value:t.expiresIn}));new DynamicFrameTarget({form:v});v.submit()}function e(t,v){var G=new Element("div",{id:"fb-root"}),q=new Element("script",{async:true,src:window.location.protocol+"//connect.facebook.net/en_US/all.js"});u.app_id=t;$$(".js_facebook_like_button").each(function(D){var J=active_user.valueOfSearchParameter,M=(Math.floor(J("km_generation"))||-1)+1,A=new Template(D.innerHTML),Q=active_user.siteVisitorUID();D.replace(A.evaluate({url:Object.toQueryString({kme:"Followed fb_like",source:"fb_like",
km_orig_source:J("km_orig_source")||"fb_like",km_prev_source:J("km_source")||J("source"),km_orig_person:J("km_orig_person")||Q,km_prev_person:Q,km_generation:M})}))});window.fbAsyncInit=function(){FB.init({appId:t,status:true,cookie:true,xfbml:true,channelUrl:v,oauth:true});r=true;l.each(function(D){D()});active_user.facebookAccessTokenNeedsUpdate()&&b()};$$("head")[0].insert(G);G.insert(q)}function g(t){r?t():l.push(t)}var l=[],r=false,u;return u={populate:e,addApiLoadedCallback:g,updateLoginStatus:b}}();var facebook_api_timeout=5E3,FacebookApiWrapper=function(){function a(e,g){return function(l){if(c){clearTimeout(g);e(l)}}}function b(e){c=true;return setTimeout(function(){c=false;e&&e()},facebook_api_timeout)}var c;return{api:function(e,g,l){l=b(l);FB.api(e,a(g,l))}}}();var FacebookAuthenticator=function(a){a||(a={});if(active_user.isGamePage())a.game_id=active_user.gameId();if($("welcome_remember_me")&&$("welcome_remember_me").checked)a.remember_me=true;observePopup("https://"+location.hostname+"/auth/facebook?state="+encodeURIComponent($H(a).toQueryString()),"Log in with Facebook","menubar=no,toolbar=no,status=no,width=600,height=400",reenableFacebookButtons);disableFacebookButtons()};
$(document).observe("dom:loaded",function(){FacebookApiLoader.addApiLoadedCallback(function(){window.location.toString();!active_user.isAuthenticated()&&!Cookie.get("FacebookLoginAttempt")&&!active_user.isNativeAppUser()&&FB.getLoginStatus(function(a){a.status=="connected"&&new Ajax.Request("/facebook_connection/status",{method:"get",parameters:{uid:a.authResponse.userID},onSuccess:function(b){if(b.responseJSON.status=="linked"){Cookie.set("FacebookLoginAttempt",true);if(active_user.isGamePage()){b=
(new Element("form",{action:"/accounts/status",method:"get"})).setStyle({display:"none"});$(document.body).insert(b);new DynamicFrameTarget({form:b,success:function(c){user_status.setActiveUser(c)}});b.insert(new Element("input",{type:"hidden",name:"from_facebook",value:true}));b.insert(new Element("input",{type:"hidden",name:"game_id",value:active_user.gameId()}));b.insert(new Element("input",{type:"hidden",name:"authenticity_token",value:$$("meta[name=csrf-token]")[0]}));b.insert(new Element("input",
{type:"hidden",name:"existing_user",value:true}));b.submit()}else{lightbox.prototype.initializeKongregateLightboxFromContent('<div class="fb_oauth_content"><span class="med_fb_logo spritesite">Facebook</span><h1 class="mbl">Just a moment</h1><p class="regtextLrg">Signing you back into your Kongregate account&hellip; <br/>automatically!</p></div>',{done_class_name:"lightbox_login"});window.location.reload()}}}})})})});var FacebookFriendFinder=function(a){var b=this;FB.getLoginStatus(function(c){c.status==="connected"&&FB.api("me/friends",function(e){var g=$A(e.data).pluck("id");e&&new Ajax.Request("/facebook_connection/friends",{parameters:{"uid[]":g},onSuccess:function(l){b.friends=l.responseJSON;a(b)}})})},true)};
FacebookFriendFinder.prototype.clickFriend=function(a){if(a.hasClassName("selected")){a.removeClassName("selected");a.down("input").checked=false}else{a.addClassName("selected");a.down("input").checked=true}};
FacebookFriendFinder.prototype.displayFriendForm=function(a,b,c){var e=new Template('<h2 class="h2 phn bright">#{friend_count} of your Facebook Friends #{is_or_are} on Kongregate</h2><p class="intro regtext mbm">Kongregate is more fun with friends.</p><form id="facebook_friends_form" class="pan" action="#"><span class="mll spinner" style="display: none;" id="friend_finder_spinner">Loading...</span><div class="select_users"><ul id="facebook_friends_list" class="users medium_user"></ul></div><input class="btn btn_wide btn_action" id="friend_finder_button" type="submit" value="Connect with Friends" /><a id="facebook_friends_skip" class="mrm" href="#">Skip this step</a></form>'),g=
new Template('<li class="user medium_user clickable selected" onclick="FacebookFriendFinder.prototype.clickFriend(this)"><input type="checkbox" name="user_id[]" value="#{id}" class="mtm img" checked="checked" /><span class="check_mark spritesite"></span><img width="40" height="40" class="user_avatar" src="#{avatar_url}" /><span class="names"><strong class="sprite_facebook facebook_name first_name truncate_one_line">#{first_name} #{last_name}</strong><em class="second_name truncate_one_line">(<span class="spritesite levelbug level_#{level}">#{username}</span>)</em></span></li>'),
l,r,u;b.update(e.evaluate({friend_count:this.friends.length,is_or_are:this.friends.length==1?"is":"are"}));l=$("facebook_friends_form");r=$("facebook_friends_skip");u=$("facebook_friends_list");l.observe("submit",function(t){t.preventDefault();$("friend_finder_button").hide();r.hide();$("friend_finder_spinner").show();new Ajax.Request(a,{parameters:l.serialize(),onSuccess:function(){c()},onFailure:function(){alert("There was an error while trying to create your new friends.");$("friend_finder_spinner").hide();
r.show();$("friend_finder_button").show()}})});r.observe("click",c);this.friends.each(function(t){t=$H(t).inject({},function(v,G){v[G[0]]=Object.isString(G[1])?G[1].escapeHTML():G[1];return v});u.insert(g.evaluate(t))})};var FacebookWidgetLoader={load:function(){var a=new Template('<iframe src="http://www.facebook.com/plugins/#{widget_type}.php?site=kongregate.com&amp;width=297&amp;height=350&amp;header=true&amp;colorscheme=light scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:297px; height:350px"></iframe>'),b=Cookie.get("kong_fbwn"),c=location.search.parseQuery();if(c.fb_widget&&("recommendations"==c.fb_widget||"activity"==c.fb_widget))b=c.fb_widget;if(b&&"news_section"!=
b){$("facebook_content_holder").update(a.evaluate({widget_type:b}));$("facebook_content_holder").show()}else $("kongregate_announcements").show()}};FeedHandler=Class.create({_feedType:"self",_feedContainerName:"feed_items_container",_feedContainer:null,_feedItemIds:[],_offset:0,_pageSize:20,_morePath:null,_destroyPath:null,_blinking:false,initialize:function(a,b,c,e,g){this._feedType=a;this._feedContainerName=b;this._pageSize=c;this._morePath=e;this._destroyPath=g;this._self_disabling={};$(document).observe("click",this.clickHandler.bindAsEventListener(this))},setOffset:function(a){this._offset=a},addFeedItemIds:function(a){this._feedItemIds=
this._feedItemIds.concat(a||[])},updateFeedInfo:function(a,b){this.setOffset(a);this.addFeedItemIds(b);this.setFirstFeedItemClass()},container:function(){if(!this._feedContainer)this._feedContainer=$(this._feedContainerName);return this._feedContainer},indicator:function(){return this.container().select("#more_feed_items_indicator").first()},showMoreElement:function(){return this.container().select("#show_more_feed_items_label").first()},automaticallyFetchMore:function(){if(this._morePath.match(/mini_feed_items/)!=
null)$$(".mini_item").length<15&&this.requestNextPage();else $$(".feed_item").length<15&&this.requestNextPage()},setFirstFeedItemClass:function(){this.container().select(".first_feed_item").each(function(b){b.removeClassName("first_feed_item")});var a=this.container().select(".feed_item").first();a&&a.addClassName("first_feed_item")},insertMoreShoutComments:function(a){var b=a.message_id;if(a.new_url){$("show_more_comments_link_"+b).href=a.new_url;$("show_more_comments_link_"+b).show()}else $("show_more_comments_link_"+
b).hide();$("shout_indicator_"+b).hide();$("shout_short_comments_"+b).hide();$("shout_more_comments_"+b).insert({top:a.content})},requestNextPage:function(){var a=this.indicator(),b=this;if(!(!a||a.visible())){a.show();this.showMoreElement().hide();new Ajax.Request(this._morePath,{parameters:{feed_type:this._feedType,offset:this._offset,num:this._pageSize,excluded_ids:this._feedItemIds.join(","),excluded_followed_users:$$(".js_followed_username").map(function(c){return c.innerHTML}).uniq().join(","),
excluded_forum_users:$$(".js_forum_post_user").map(function(c){return c.innerHTML}).uniq().join(",")},method:"get",onSuccess:function(c){b.container().select("#additional_feed_items").first().remove();b.container().insert(c.responseText);b.setFirstFeedItemClass()},onFailure:function(){b.indicator().hide();b.showMoreElement().show()}})}},requestNextPageIfMoreItemsNeeded:function(){this.container().getHeight()<1500&&this.requestNextPage()},removeFeedItems:function(a){if(!(!(a instanceof Array)||a.length<=
0)){new Effect.DropOut("feed_item_"+a[0]);new Ajax.Request(this._destroyPath,{method:"post",parameters:{ids:a.join(","),context:this._feedType},onSuccess:function(){},onFailure:function(){}})}},unfollowUser:function(a,b){new Effect.DropOut("feed_item_"+b[0]);new Ajax.Request("/accounts/"+active_user.username()+"/friends/"+a+".json",{method:"put",parameters:{unfriend_from:"feed"},onSuccess:function(){},onFailure:function(){}})},blockGame:function(a,b,c){new Effect.DropOut("feed_item_"+c);new Ajax.Request("/games/"+
b+"/"+a+"/blocks",{method:"post",parameters:{user_game_permissions:{allow_something:false}},onSuccess:function(){},onFailure:function(){}})},isMiniFeed:function(){return this._morePath.match(/mini_feed_items/)!=null},feedItemElement:function(a){return this.isMiniFeed()?$("mini_item_"+a):$("feed_item_"+a)},observeUnlike:function(a){a=this.feedItemElement(a).down(".like_link");if(a!=null){a.observe("mouseenter",function(){this.down(".like_text").update("Unlike")});a.observe("mouseleave",function(){this.down(".like_text").update("Liked")})}},
likeFeedItem:function(a){var b=this;if(this._self_disabling[a]==null){this._self_disabling[a]=true;new Ajax.Request("/user_likes",{method:"post",parameters:{feed_item_id:a},onSuccess:function(c){if(b.isMiniFeed()){var e=$("mini_item_"+a);e.down(".like_link").removeClassName("feed_like");e.down(".like_link").addClassName("feed_unlike")}else{e=$("feed_item_"+a);e.down(".like_text").update("Liked")}e.down(".like_link").onclick=function(){feedHandler.unlikeFeedItem(a);return false};b._self_disabling[a]=
null;b.observeUnlike(a);e.down(".like_count").update("("+c.responseJSON.count+")")},onFailure:function(){b._self_disabling[a]=null}})}},unlikeFeedItem:function(a){var b=this;if(this._self_disabling[a]==null){this._self_disabling[a]=true;new Ajax.Request("/user_likes",{method:"delete",parameters:{feed_item_id:a},onSuccess:function(c){var e=b.isMiniFeed()?$("mini_item_"+a):$("feed_item_"+a);e.down(".like_link").onclick=function(){feedHandler.likeFeedItem(a);return false};b._self_disabling[a]=null;e.down(".like_text").update("Like");
e.down(".like_link").stopObserving("mouseenter");e.down(".like_link").stopObserving("mouseleave");if(b.isMiniFeed()){e.down(".like_link").removeClassName("feed_unlike");e.down(".like_link").addClassName("feed_like")}else e.down(".like_count").update("("+c.responseJSON.count+")")},onFailure:function(){b._self_disabling[a]=null}})}},clickHandler:function(a){var b=a.element();if(this.isMiniFeed()){if(a=b.hasClassName("mini_item")?b:b.up(".mini_item"))if(a=a.id.sub("mini_item_","")){b=(b=Cookie.get("feed_item_clicks"))?
b.evalJSON():{};b.mini=b.mini||[];b.mini=b.mini.concat([a]);Cookie.set("feed_item_clicks",Object.toJSON(b))}}else if(a=b.hasClassName("feed_item")?b:b.up(".feed_item")){var c=b.up("a");if("A"==b.nodeName||c){b="A"==b.nodeName?b.href:c.href;a=a.id.sub("feed_item_","");if(b&&!b.match(/#$/)){b=(b=Cookie.get("feed_item_clicks"))?b.evalJSON():{};b[this._feedType]=b[this._feedType]||[];b[this._feedType]=b[this._feedType].concat([a]);Cookie.set("feed_item_clicks",Object.toJSON(b))}}}}});FileField=function(a,b){function c(e){var g=e.pointerX();e=e.pointerY();var l=b.getOffsetParent().viewportOffset();b.setOpacity(0);if(!this.containerPositon)this.containerPositon=a.getBoundingClientRect();if(e>=this.containerPositon.top&&e<this.containerPositon.bottom&&g>=this.containerPositon.left&&g<this.containerPositon.right){b.style.left=g-this.containerPositon.left+30-b.getWidth()+"px";b.style.top=e-l[1]-10+"px"}else{b.style.left=0;b.style.top=0}}a.observe("mousemove",c.bind(this))};function FlashMessages(a){this.initialize(a)}FlashMessages.DISPLAY_TEMPLATE=new Template('<div class="sitemessage"><h2>#{message}</h2></div>');FlashMessages.COOKIE_NAME="kong_flash_messages";
FlashMessages.prototype={initialize:function(){this._data={};if(Cookie.accept()){this._messages_node=$("global");this._insertMessages()}},data:function(){this._getDataFromCookie();return this._data},_getDataFromCookie:function(){var a=Cookie.get(FlashMessages.COOKIE_NAME);if(a){a=a.evalJSON();if(this._data)Object.extend(this._data,a);else this._data=a}this._clearCookie()},_insertMessages:function(){var a=this.data().messages;if(this._messages_node&&a){this._messages_node.innerHTML=a.map(function(c){return FlashMessages.DISPLAY_TEMPLATE.evaluate({message:c})}).join();
try{active_user.showingBlueBar()}catch(b){}}},_clearCookie:function(){Cookie.erase(FlashMessages.COOKIE_NAME,"/")}};function FollowToggleButton(a){this.initialize(a)}FollowToggleButton.prototype={initialize:function(a){this._indicatorTag=a},mouseOver:function(a){a=Event.findElement(a);a.removeClassName("btn_alt");a.update("Unfriend")},mouseOut:function(a){a=Event.findElement(a);a.addClassName("btn_alt");a.update("Friend")},toggle:function(a){a=Event.findElement(a);a.update(this._indicatorTag);a.onmouseover="";a.onmouseout=""}};FormRow=Class.create({initialize:function(a,b,c,e,g){this._formCallback=g;this._tr=new Element("tr");this._tr.appendChild(this._createFieldNameColumn(a,b));this._tr.appendChild(this._createInputColumn(b,c,e));this._helpColumn=this._createHelpColumn(b);this._tr.appendChild(this._helpColumn);this._focusHandlers=[];this.getInputElements().each(function(l){l.onfocus=this._callAllOnFocusHandlers.bind(this);l.onblur=this._callAllOnBlurHandlers.bind(this)}.bind(this));this._hasValidInput=false;this._setInputValidityTrue=
function(){this.setInputValidity(true)}.bind(this);this._setInputValidityFalse=function(){this.setInputValidity(false)}.bind(this)},hasValidInput:function(){return this._hasValidInput},setInputValidity:function(a){this._hasValidInput=a;this._formCallback()},_callAllOnFocusHandlers:function(){for(var a=0;a<this._focusHandlers.length;a++)if(this._focusHandlers[a].onFocus())break},_callAllOnBlurHandlers:function(){for(var a=0;a<this._focusHandlers.length;a++)if(this._focusHandlers[a].onBlur())break},
getElement:function(){return this._tr},getInputElements:function(){return[this.getColumn(1).childNodes[0]]},getInputValue:function(){return this.getColumn(1).childNodes[0].value},getHelpElement:function(){return this.getColumn(2)},getColumn:function(a){return this._tr.childNodes[a]},addFocusHandler:function(a){this._focusHandlers.push(a)},focusHandlerCount:function(){return this._focusHandlers.length},_createFieldNameColumn:function(a,b){var c=new Element("td");c.innerHTML='<label for="credit_card_transaction_'+
b+'">'+a+"</label>";c.className="purchase_label";return c},_createInputColumn:function(a,b,c){var e=new Element("td");e.className="purchase_input";this._inputElement=new Element("input");this._inputElement.id="credit_card_transaction_"+a;this._inputElement.name="transaction["+b+"]["+a+"]";this._inputElement.size=30;this._inputElement.value=c?c:"";e.appendChild(this._inputElement);return e},_createHelpColumn:function(a){var b=new Element("td");b.id=a+"_help";return b}});
FormNonEmptyRow=Class.create(FormRow,{initialize:function($super,b,c,e,g,l,r,u){$super(b,c,e,l,r);u&&this.getInputElements().each(function(t){t.onkeyup=function(){this.getInputValue()!=""&&this._callAllOnBlurHandlers()}.bind(this)}.bind(this));this.addFocusHandler(new NonEmptyInputFocusHandler(this,"can't be blank",this._setInputValidityFalse));this._validInputCallbackFocusHandler=new ValidInputCallbackFocusHandler(this,this._setInputValidityTrue);this.addFocusHandler(this._validInputCallbackFocusHandler);
this.addFocusHandler(new HelpTextFocusHandler(this,g))}});FormCanBeEmptyRow=Class.create(FormRow,{initialize:function($super,b,c,e,g,l,r){$super(b,c,e,l,r);this._hasValidInput=true;this.addFocusHandler(new HelpTextFocusHandler(this,g))}});
FormCreditCardNumberRow=Class.create(FormRow,{initialize:function($super,b,c,e,g,l,r){$super(b,c,e,g,l);this.addFocusHandler(new NonEmptyInputFocusHandler(this,"can't be blank",this._setInputValidityFalse));this._ccNumberFocusHandler=new CreditCardValidationFocusHandler(this,"invalid account number",this._setInputValidityFalse);this.addFocusHandler(this._ccNumberFocusHandler);this._validInputCallbackFocusHandler=new ValidInputCallbackFocusHandler(this,r,this._setInputValidityFalse);this.addFocusHandler(this._validInputCallbackFocusHandler);
this._validInputCallbackFocusHandler=new ValidInputCallbackFocusHandler(this,this._setInputValidityTrue);this.addFocusHandler(this._validInputCallbackFocusHandler);b=new Element("img");b.src="/images/creditcard_marks.png";this._helpCreditCardFocusHandler=new HelpCreditCardFocusHandler(this,b);this.addFocusHandler(this._helpCreditCardFocusHandler)},getCreditCardType:function(){return this._ccNumberFocusHandler.getCreditCardType()},getInputValue:function(){return this.getColumn(1).childNodes[0].value.replace(/\s+/g,
"")}});
FormCvvRow=Class.create(FormRow,{initialize:function($super,b,c,e,g,l){$super(b,c,e,g,l);this.addFocusHandler(new NonEmptyInputFocusHandler(this,"can't be blank",this._setInputValidityFalse));this._cvvValidationFocusHandler=new CvvValidationFocusHandler(this,this._setInputValidityFalse);this.addFocusHandler(this._cvvValidationFocusHandler);this._validInputCallbackFocusHandler=new ValidInputCallbackFocusHandler(this,this._setInputValidityTrue);this.addFocusHandler(this._validInputCallbackFocusHandler);this._helpTextFocusHandler=
new HelpTextFocusHandler(this,"");this.addFocusHandler(this._helpTextFocusHandler)},setCreditCardType:function(a){this._cvvValidationFocusHandler.setCreditCardType(a);var b="";b=a=="american_express"?"Please enter the four digit code that's printed on the front of your card, just to the right of the account number.":"Please enter the last three digits printed on the signature line on the back side of your card.";this._helpTextFocusHandler.setText(b)}});
FormExpirationDateRow=Class.create(FormRow,{initialize:function($super,b,c,e,g,l,r,u,t){this._formCallback=t;this._monthHTML=g;this._yearHTML=l;this._defaultMonth=r;this._defaultYear=u;$super(b,c+"cc_month",e,"",t);this.addFocusHandler(new CompleteDateValidationFocusHandler(this,"month &amp; year are required",this._setInputValidityFalse));this.addFocusHandler(new FutureDateValidationFocusHandler(this,"date must be in the future",this._setInputValidityFalse));this._validInputCallbackFocusHandler=
new ValidInputCallbackFocusHandler(this,this._setInputValidityTrue);this.addFocusHandler(this._validInputCallbackFocusHandler);this.addFocusHandler(new HelpTextFocusHandler(this,""))},_createInputColumn:function(){var a=new Element("td");a.addClassName("purchase_input");Element.insert(a,this._monthHTML);a.childNodes[0].value=this._defaultMonth;Element.insert(a,this._yearHTML);a.childNodes[1].value=this._defaultYear;return a},getInputElements:function(){return[this.getColumn(1).childNodes[0],this.getColumn(1).childNodes[1]]},
getInputValue:function(){return this.getColumn(1).childNodes[0].value+"/"+this.getColumn(1).childNodes[1].value},setMonthInput:function(a){this.getColumn(1).childNodes[0].selectedIndex=a},setYearInput:function(a){this.getColumn(1).childNodes[1].selectedIndex=a}});function evalJS(a){eval(a)}function updateTaskProgress(a,b){try{$(a+"-progress-amount").update(b)}catch(c){console.warn("error during updateTaskProgress on %s to %s",a,b)}}function markTaskComplete(a){try{Element.addClassName(a,"complete");Element.removeClassName(a,"incomplete");$(a+"-progress")&&Element.hide(a+"-progress");new Effect.Highlight(a,{})}catch(b){console.warn("error during markTaskComplete on %s",a)}}
function markAccomplishmentComplete(a){try{Element.addClassName(a,"complete");Element.removeClassName(a,"incomplete");new Effect.Highlight(a,{})}catch(b){console.warn("error during markAccomplishmentComplete on %s",a)}};var GameBrowser={highlightCurrentSidebarItem:function(a){(a=$("browser-sidebar-"+a))&&a.addClassName("active")},updateTagSidebarItem:function(a,b){if(a&&b){$("browser-sidebar-tag-games-link").href=b;$("browser-sidebar-tag-games-link").update(a);$("browser-sidebar-tag-games").addClassName("active");$("browser-sidebar-tag-games").show()}}};var GameMetricsUpdater=function(){return{update:function(){new Ajax.Request(active_user.gameResourcePath()+"/metrics.json",{method:"get",onSuccess:function(a){a=a.responseJSON;[[".favorites_count",a.favorites_count_with_delimiter],[".gameplays_count",a.gameplays_count_with_delimiter],["#game_statistics",a.game_statistics],[".average_rating",a.average_rating_text],[".average_rating_with_count",a.average_rating_with_count],["#rating_message",a.rating_message],["#below_game_rating_message",a.below_game_rating_message],
["#star_ratings_block",a.user_rating],["#below_game_star_ratings_block",a.below_game_user_rating],["#quicklinks_star_ratings_block",a.quicklinks_user_rating],[".flag_game",a.flagged],["#favorite_game",a.favorite_message],["#below_game_favorite_game",a.below_game_favorite_message],["#quicklinks_favorite_block",a.quicklinks_favorite_message],["#quicklinks_play_later_block",a.quicklinks_play_later_message],["#below_game_play_later_block",a.below_game_play_later_message],["#user_donation_holder",a.last_tip_message],
["#combined_favorites_js",a.combined_favorites_js],["#game_block",a.block_game_js]].each(function(b){var c=b[0],e=b[1];e&&$$(c).each(function(g){g.update(e)})})},onFailure:function(a){console.error("Error loading game metrics: %o",a.responseText)}})}}}();var HoverboxGroup=function(){var a={},b={};a._action=b.action||"show_hover";a._hoverDelay=b._hoverDelay||500;a._rightFlipThreshold=b._rightFlipThreshold||440;a._bottomFlipThreshold=b._bottomFlipThreshold||300;var c={};c._hoverboxCache={};c._hoverbox=null;c._timeouts=[];a.registerHoverObservers=function(){active_user.getsImprovedBrowsing()&&$j(document).on("mouseover",".js-game-hover",c.handleMouseOver);Event.observe(window,"resize",function(){c._hoverboxCache={}}.bind(this))};c.handleMouseOver=function(e){var g=
e.currentTarget,l=g.select("a.hover_game_info","a.badge_link")[0]||g.select("a")[0];c.cancelOrCloseOpen();if(!e.target.hasClassName("hover_profile"))if(!e.target.hasClassName("close_remove"))if(typeof l!="undefined"){c._timeouts.push(setTimeout(c.openHoverbox.curry(l,g,e),a._hoverDelay));l.observe("mouseleave",c.handleMouseLeaveElement.curry(l));g.stopObserving("mouseleave");g.observe("mouseleave",c.handleMouseLeaveElement.curry(g))}};c.openHoverbox=function(e,g,l){g.cumulativeOffset();c._hoverbox=
c._hoverboxCache[e.pathname];if(c._hoverbox==null){Control.Window.baseZIndex=2E6;c._hoverbox=new Control.Window(e,{method:"GET",parameters:{},offsetLeft:0,offsetTop:-22,className:"hover_game_info_window"});c._hoverbox.sourceContainer.stopObserving("click");c._hoverbox.observe("afterDestroy",c._hoverbox.container.remove)}c._hoverbox.observe("bringToFront",c.handleBoxBeforeOpen.curry(g));c._hoverbox.observe("afterOpen",c.handleBoxOpened.curry(e));c._hoverbox.options.position=[l.pageX,l.pageY];e=e.pathname;
if(e[0]!=="/")e="/"+e;c._hoverbox.href=e+"/"+a._action;c._hoverbox.open()};c.handleBoxOpened=function(e){c._hoverboxCache[e.pathname]=c._hoverbox;c._hoverbox.container.observe("mouseenter",c.cancelTimeout);c._hoverbox.container.observe("mouseleave",c.startCloseTimeout);c._hoverbox.ajaxRequest&&c._hoverbox.ajaxRequest.transport.evalScripts()};c.handleBoxBeforeOpen=function(e){var g=document.viewport.getDimensions(),l=e.viewportOffset(),r=$(c._hoverbox.container);r.removeClassName("hoverbox_above_right");
r.removeClassName("hoverbox_above_left");r.removeClassName("hoverbox_left");if(l[0]+e.getWidth()/2>g.width-a._rightFlipThreshold){c._hoverbox.options.offsetLeft=-c._hoverbox.container.getDimensions().width;r.addClassName("hoverbox_left")}if(l[1]+e.getHeight()/2>g.height-a._bottomFlipThreshold){c._hoverbox.options.offsetTop=37-c._hoverbox.container.getDimensions().height;e=r.hasClassName("hoverbox_left")?"hoverbox_above_left":"hoverbox_above_right";r.addClassName(e)}else c._hoverbox.options.offsetTop=
-22};c.handleMouseLeaveElement=function(e){if(c._hoverbox!=null)if(c._hoverbox.isOpen){e.stopObserving("mouseleave");c.startCloseTimeout()}else c.cancelOrCloseOpen();else c.cancelTimeout()};c.startCloseTimeout=function(){c._timeouts.push(setTimeout(c.cancelOrCloseOpen,a._rightFlipThreshold))};c.cancelOrCloseOpen=function(){if(c._hoverbox!=null){c._hoverbox.stopObserving("afterOpen");c._hoverbox.stopObserving("bringToFront");c._hoverbox.container.stopObserving("mouseenter");c._hoverbox.container.stopObserving("mouseleave");
if(c._hoverbox.ajaxRequest){c._hoverbox.ajaxRequest.transport.abort();c._hoverbox.close();try{c._hoverbox.destroy()}catch(e){}}else c._hoverbox.close();c._hoverbox=null}c.cancelTimeout()};c.cancelTimeout=function(){if(c._timeouts.length!=0){c._timeouts.each(function(e){clearTimeout(e)});c._timeouts=[]}};return a};document.observe("dom:loaded",function(){GameInfoHoverGroup=typeof GameInfoHoverGroup=="undefined"?new HoverboxGroup:GameInfoHoverGroup;GameInfoHoverGroup.registerHoverObservers()});function ImageSwitcher(a){this.initialize(a)}
ImageSwitcher.prototype={initialize:function(a){var b=this;this._image_ids=a.image_ids;this._current_image=this._image_ids.first();this._current_text=this.makeTextId(this._current_image);document.observe("dom:loaded",function(){b._image_ids.each(function(c){$(b.makeTextId(c)).observe("mouseover",b.switchFunction(c))})})},switchFunction:function(a){var b=this;return function(){$(b._current_image).hide();$(b._current_text).removeClassName("selected");b._current_image=a;b._current_text=b.makeTextId(a);
$(b._current_image).show();$(b._current_text).addClassName("selected")}},makeTextId:function(a){return a+"Text"}};function showTrailerPopup(a){window.open(a,"","width=520,height=400,status=no,resizable=no,scrollbars=no")};InteractiveHover=Class.create(Control.Window,{initialize:function($super,b,c){var e;$super(b,c);b=function(g){this.open(g);if(e!=null){clearTimeout(e);e=null}}.bind(this);c=function(g){e=setTimeout(function(){this.close(g)}.bind(this),1E3)}.bind(this);this.sourceContainer.observe("mouseenter",b);this.container.observe("mouseenter",b);this.sourceContainer.observe("mouseleave",c);this.container.observe("mouseleave",c)}});(function(a){function b(){var A=false;if("localStorage"in window)try{window.localStorage.setItem("_tmptest","tmpval");A=true;window.localStorage.removeItem("_tmptest")}catch(Q){}if(A)try{if(window.localStorage){u=window.localStorage;D="localStorage"}}catch(j){}else if("globalStorage"in window)try{if(window.globalStorage){u=window.globalStorage[window.location.hostname];D="globalStorage"}}catch(p){}else{t=document.createElement("link");if(t.addBehavior){t.style.behavior="url(#default#userData)";document.getElementsByTagName("head")[0].appendChild(t);
t.load("jStorage");A="{}";try{A=t.getAttribute("jStorage")}catch(w){}u.jStorage=A;D="userDataBehavior"}else{t=null;return}}c();l()}function c(){if(u.jStorage)try{r=q(String(u.jStorage))}catch(A){u.jStorage="{}"}else u.jStorage="{}";v=u.jStorage?String(u.jStorage).length:0}function e(){try{u.jStorage=G(r);if(t){t.setAttribute("jStorage",u.jStorage);t.save("jStorage")}v=u.jStorage?String(u.jStorage).length:0}catch(A){}}function g(A){if(!A||typeof A!="string"&&typeof A!="number")throw new TypeError("Key name must be string or numeric");
if(A=="__jstorage_meta")throw new TypeError("Reserved key name");return true}function l(){var A,Q,j,p=Infinity,w=false;clearTimeout(J);if(!(!r.__jstorage_meta||typeof r.__jstorage_meta.TTL!="object")){A=+new Date;j=r.__jstorage_meta.TTL;for(Q in j)if(j.hasOwnProperty(Q))if(j[Q]<=A){delete j[Q];delete r[Q];w=true}else if(j[Q]<p)p=j[Q];if(p!=Infinity)J=setTimeout(l,p-A);w&&e()}}if(!a||!(a.toJSON||Object.toJSON||window.JSON))throw new Error("jQuery, MooTools or Prototype needs to be loaded before jStorage!");
var r={},u={jStorage:"{}"},t=null,v=0,G=a.toJSON||Object.toJSON||window.JSON&&(JSON.encode||JSON.stringify),q=a.evalJSON||window.JSON&&(JSON.decode||JSON.parse)||function(A){return String(A).evalJSON()},D=false,J,M={isXML:function(A){return(A=(A?A.ownerDocument||A:0).documentElement)?A.nodeName!=="HTML":false},encode:function(A){if(!this.isXML(A))return false;try{return(new XMLSerializer).serializeToString(A)}catch(Q){try{return A.xml}catch(j){}}return false},decode:function(A){var Q="DOMParser"in
window&&(new DOMParser).parseFromString||window.ActiveXObject&&function(j){var p=new ActiveXObject("Microsoft.XMLDOM");p.async="false";p.loadXML(j);return p};if(!Q)return false;A=Q.call("DOMParser"in window&&new DOMParser||window,A,"text/xml");return this.isXML(A)?A:false}};a.jStorage={version:"0.1.7.0",set:function(A,Q,j){g(A);j=j||{};if(M.isXML(Q))Q={_is_xml:true,xml:M.encode(Q)};else if(typeof Q=="function")Q=null;else if(Q&&typeof Q=="object")Q=q(G(Q));r[A]=Q;isNaN(j.TTL)?e():this.setTTL(A,j.TTL);
return Q},get:function(A,Q){g(A);if(A in r)return r[A]&&typeof r[A]=="object"&&r[A]._is_xml&&r[A]._is_xml?M.decode(r[A].xml):r[A];return typeof Q=="undefined"?null:Q},deleteKey:function(A){g(A);if(A in r){delete r[A];r.__jstorage_meta&&typeof r.__jstorage_meta.TTL=="object"&&A in r.__jstorage_meta.TTL&&delete r.__jstorage_meta.TTL[A];e();return true}return false},setTTL:function(A,Q){var j=+new Date;g(A);Q=Number(Q)||0;if(A in r){if(!r.__jstorage_meta)r.__jstorage_meta={};if(!r.__jstorage_meta.TTL)r.__jstorage_meta.TTL=
{};if(Q>0)r.__jstorage_meta.TTL[A]=j+Q;else delete r.__jstorage_meta.TTL[A];e();l();return true}return false},flush:function(){r={};e();return true},storageObj:function(){function A(){}A.prototype=r;return new A},index:function(){var A=[],Q;for(Q in r)r.hasOwnProperty(Q)&&Q!="__jstorage_meta"&&A.push(Q);return A},storageSize:function(){return v},currentBackend:function(){return D},storageAvailable:function(){return!!D},reInit:function(){var A;if(t&&t.addBehavior){A=document.createElement("link");
t.parentNode.replaceChild(A,t);t=A;t.style.behavior="url(#default#userData)";document.getElementsByTagName("head")[0].appendChild(t);t.load("jStorage");A="{}";try{A=t.getAttribute("jStorage")}catch(Q){}u.jStorage=A;D="userDataBehavior"}c()}};b()})($||window.jQuery);if(typeof jwplayer=="undefined"){var jwplayer=function(a){if(jwplayer.api)return jwplayer.api.selectPlayer(a)},$jw=jwplayer;jwplayer.version="5.10.2295 (Licensed version)";jwplayer.vid=document.createElement("video");jwplayer.audio=document.createElement("audio");jwplayer.source=document.createElement("source");(function(a){function b(c){if(a.utils.exists(c)){var e=c.indexOf("://");c=c.indexOf("?");return e>0&&(c<0||c>e)}}a.utils=function(){};a.utils.typeOf=function(c){var e=typeof c;if(e==="object")if(c){if(c instanceof
Array)e="array"}else e="null";return e};a.utils.extend=function(){var c=a.utils.extend.arguments;if(c.length>1){for(var e=1;e<c.length;e++)for(var g in c[e])c[0][g]=c[e][g];return c[0]}return null};a.utils.clone=function(){var c,e=a.utils.clone.arguments;if(e.length==1)switch(a.utils.typeOf(e[0])){case "object":c={};for(var g in e[0])c[g]=a.utils.clone(e[0][g]);break;case "array":c=[];for(g in e[0])c[g]=a.utils.clone(e[0][g]);break;default:return e[0]}return c};a.utils.extension=function(c){if(!c)return"";
c=c.substring(c.lastIndexOf("/")+1,c.length);c=c.split("?")[0];if(c.lastIndexOf(".")>-1)return c.substr(c.lastIndexOf(".")+1,c.length).toLowerCase()};a.utils.html=function(c,e){c.innerHTML=e};a.utils.wrap=function(c,e){c.parentNode&&c.parentNode.replaceChild(e,c);e.appendChild(c)};a.utils.ajax=function(c,e,g){var l;l=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");l.onreadystatechange=function(){if(l.readyState===4)if(l.status===200){if(e){if(!a.utils.exists(l.responseXML))try{if(window.DOMParser){var u=
(new DOMParser).parseFromString(l.responseText,"text/xml");if(u)l=a.utils.extend({},l,{responseXML:u})}else{u=new ActiveXObject("Microsoft.XMLDOM");u.async="false";u.loadXML(l.responseText);l=a.utils.extend({},l,{responseXML:u})}}catch(t){g&&g(c)}e(l)}}else g&&g(c)};try{l.open("GET",c,true);l.send(null)}catch(r){g&&g(c)}return l};a.utils.load=function(c,e,g){c.onreadystatechange=function(){if(c.readyState===4)if(c.status===200)e&&e();else g&&g()}};a.utils.find=function(c,e){return c.getElementsByTagName(e)};
a.utils.append=function(c,e){c.appendChild(e)};a.utils.isIE=function(){return!+"\u000b1"||typeof window.ActiveXObject!="undefined"};a.utils.userAgentMatch=function(c){return navigator.userAgent.toLowerCase().match(c)!==null};a.utils.isIOS=function(){return a.utils.userAgentMatch(/iP(hone|ad|od)/i)};a.utils.isIPad=function(){return a.utils.userAgentMatch(/iPad/i)};a.utils.isIPod=function(){return a.utils.userAgentMatch(/iP(hone|od)/i)};a.utils.isAndroid=function(){return a.utils.userAgentMatch(/android/i)};
a.utils.isLegacyAndroid=function(){return a.utils.userAgentMatch(/android 2.[012]/i)};a.utils.isBlackberry=function(){return a.utils.userAgentMatch(/blackberry/i)};a.utils.isMobile=function(){return a.utils.userAgentMatch(/(iP(hone|ad|od))|android/i)};a.utils.getFirstPlaylistItemFromConfig=function(c){var e={};c=c.playlist&&c.playlist.length?c.playlist[0]:c;e.file=c.file;e.levels=c.levels;e.streamer=c.streamer;e.playlistfile=c.playlistfile;e.provider=c.provider;if(!e.provider){if(e.file&&(e.file.toLowerCase().indexOf("youtube.com")>
-1||e.file.toLowerCase().indexOf("youtu.be")>-1))e.provider="youtube";if(e.streamer&&e.streamer.toLowerCase().indexOf("rtmp://")==0)e.provider="rtmp";if(c.type)e.provider=c.type.toLowerCase()}if(e.provider=="audio")e.provider="sound";return e};a.utils.getOuterHTML=function(c){if(c.outerHTML)return c.outerHTML;else try{return(new XMLSerializer).serializeToString(c)}catch(e){return""}};a.utils.setOuterHTML=function(c,e){if(c.outerHTML)c.outerHTML=e;else{var g=document.createElement("div");g.innerHTML=
e;e=document.createRange();e.selectNodeContents(g);g=e.extractContents();c.parentNode.insertBefore(g,c);c.parentNode.removeChild(c)}};a.utils.hasFlash=function(){if(typeof navigator.plugins!="undefined"&&typeof navigator.plugins["Shockwave Flash"]!="undefined")return true;if(typeof window.ActiveXObject!="undefined")try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash");return true}catch(c){}return false};a.utils.getPluginName=function(c){if(c.lastIndexOf("/")>=0)c=c.substring(c.lastIndexOf("/")+1,
c.length);if(c.lastIndexOf("-")>=0)c=c.substring(0,c.lastIndexOf("-"));if(c.lastIndexOf(".swf")>=0)c=c.substring(0,c.lastIndexOf(".swf"));if(c.lastIndexOf(".js")>=0)c=c.substring(0,c.lastIndexOf(".js"));return c};a.utils.getPluginVersion=function(c){if(c.lastIndexOf("-")>=0)return c.lastIndexOf(".js")>=0?c.substring(c.lastIndexOf("-")+1,c.lastIndexOf(".js")):c.lastIndexOf(".swf")>=0?c.substring(c.lastIndexOf("-")+1,c.lastIndexOf(".swf")):c.substring(c.lastIndexOf("-")+1);return""};a.utils.getAbsolutePath=
function(c,e){if(!a.utils.exists(e))e=document.location.href;if(a.utils.exists(c)){if(b(c))return c;var g=e.substring(0,e.indexOf("://")+3),l=e.substring(g.length,e.indexOf("/",g.length+1));if(c.indexOf("/")===0)c=c.split("/");else{e=e.split("?")[0];e=e.substring(g.length+l.length+1,e.lastIndexOf("/"));c=e.split("/").concat(c.split("/"))}e=[];for(var r=0;r<c.length;r++)!c[r]||!a.utils.exists(c[r])||c[r]=="."||(c[r]==".."?e.pop():e.push(c[r]));return g+l+"/"+e.join("/")}};a.utils.pluginPathType={ABSOLUTE:"ABSOLUTE",
RELATIVE:"RELATIVE",CDN:"CDN"};a.utils.getPluginPathType=function(c){if(typeof c=="string"){c=c.split("?")[0];var e=c.indexOf("://");if(e>0)return a.utils.pluginPathType.ABSOLUTE;var g=c.indexOf("/");c=a.utils.extension(c);if(e<0&&g<0&&(!c||!isNaN(c)))return a.utils.pluginPathType.CDN;return a.utils.pluginPathType.RELATIVE}};a.utils.mapEmpty=function(c){for(var e in c)return false;return true};a.utils.mapLength=function(c){var e=0;for(var g in c)e++;return e};a.utils.log=function(c,e){if(typeof console!=
"undefined"&&typeof console.log!="undefined")e?console.log(c,e):console.log(c)};a.utils.css=function(c,e){if(a.utils.exists(c))for(var g in e)try{if(typeof e[g]!=="undefined"){if(typeof e[g]=="number"&&!(g=="zIndex"||g=="opacity")){if(isNaN(e[g]))continue;e[g]=g.match(/color/i)?"#"+a.utils.strings.pad(e[g].toString(16),6):Math.ceil(e[g])+"px"}c.style[g]=e[g]}}catch(l){}};a.utils.isYouTube=function(c){return c.indexOf("youtube.com")>-1||c.indexOf("youtu.be")>-1};a.utils.transform=function(c,e,g,l,
r){a.utils.exists(e)||(e=1);a.utils.exists(g)||(g=1);a.utils.exists(l)||(l=0);a.utils.exists(r)||(r=0);if(e==1&&g==1&&l==0&&r==0){c.style.webkitTransform="";c.style.MozTransform="";c.style.OTransform=""}else{e="scale("+e+","+g+") translate("+l+"px,"+r+"px)";c.style.webkitTransform=e;c.style.MozTransform=e;c.style.OTransform=e}};a.utils.stretch=function(c,e,g,l,r,u){if(!(typeof g=="undefined"||typeof l=="undefined"||typeof r=="undefined"||typeof u=="undefined")){var t=g/r,v=l/u,G=false,q={};if(e.parentElement)e.parentElement.style.overflow=
"hidden";a.utils.transform(e);switch(c.toUpperCase()){case a.utils.stretching.NONE:q.width=r;q.height=u;q.top=(l-q.height)/2;q.left=(g-q.width)/2;break;case a.utils.stretching.UNIFORM:if(t>v){q.width=r*v;q.height=u*v;if(q.width/g>0.95){G=true;t=Math.ceil(100*g/q.width)/100;v=1;q.width=g}}else{q.width=r*t;q.height=u*t;if(q.height/l>0.95){G=true;t=1;v=Math.ceil(100*l/q.height)/100;q.height=l}}q.top=(l-q.height)/2;q.left=(g-q.width)/2;break;case a.utils.stretching.FILL:if(t>v){q.width=r*t;q.height=u*
t}else{q.width=r*v;q.height=u*v}q.top=(l-q.height)/2;q.left=(g-q.width)/2;break;case a.utils.stretching.EXACTFIT:q.width=r;q.height=u;var D=Math.round(r/2*(1-1/t)),J=Math.round(u/2*(1-1/v));G=true;q.top=q.left=0;break;default:break}G&&a.utils.transform(e,t,v,D,J);a.utils.css(e,q)}};a.utils.stretching={NONE:"NONE",FILL:"FILL",UNIFORM:"UNIFORM",EXACTFIT:"EXACTFIT"};a.utils.deepReplaceKeyName=function(c,e,g){switch(a.utils.typeOf(c)){case "array":for(var l=0;l<c.length;l++)c[l]=a.utils.deepReplaceKeyName(c[l],
e,g);break;case "object":for(var r in c){var u;if(e instanceof Array&&g instanceof Array)if(e.length!=g.length)continue;else u=e;else u=[e];var t=r;for(l=0;l<u.length;l++)t=t.replace(new RegExp(e[l],"g"),g[l]);c[t]=a.utils.deepReplaceKeyName(c[r],e,g);r!=t&&delete c[r]}break}return c};a.utils.isInArray=function(c,e){if(!c||!(c instanceof Array))return false;for(var g=0;g<c.length;g++)if(e===c[g])return true;return false};a.utils.exists=function(c){switch(typeof c){case "string":return c.length>0;
case "object":return c!==null;case "undefined":return false}return true};a.utils.empty=function(c){if(typeof c.hasChildNodes=="function")for(;c.hasChildNodes();)c.removeChild(c.firstChild)};a.utils.parseDimension=function(c){if(typeof c=="string")return c===""?0:c.lastIndexOf("%")>-1?c:parseInt(c.replace("px",""),10);return c};a.utils.getDimensions=function(c){return c&&c.style?{x:a.utils.parseDimension(c.style.left),y:a.utils.parseDimension(c.style.top),width:a.utils.parseDimension(c.style.width),
height:a.utils.parseDimension(c.style.height)}:{}};a.utils.getElementWidth=function(c){return c?c==document.body?a.utils.parentNode(c).clientWidth:c.clientWidth>0?c.clientWidth:c.style?a.utils.parseDimension(c.style.width):null:null};a.utils.getElementHeight=function(c){return c?c==document.body?a.utils.parentNode(c).clientHeight:c.clientHeight>0?c.clientHeight:c.style?a.utils.parseDimension(c.style.height):null:null};a.utils.timeFormat=function(c){str="00:00";if(c>0){str=Math.floor(c/60)<10?"0"+
Math.floor(c/60)+":":Math.floor(c/60)+":";str+=Math.floor(c%60)<10?"0"+Math.floor(c%60):Math.floor(c%60)}return str};a.utils.useNativeFullscreen=function(){return navigator&&navigator.vendor&&navigator.vendor.indexOf("Apple")==0};a.utils.parentNode=function(c){return c?c.parentNode?c.parentNode:c.parentElement?c.parentElement:c:document.body};a.utils.getBoundingClientRect=function(c){return typeof c.getBoundingClientRect=="function"?c.getBoundingClientRect():{left:c.offsetLeft+document.body.scrollLeft,
top:c.offsetTop+document.body.scrollTop,width:c.offsetWidth,height:c.offsetHeight}};a.utils.translateEventResponse=function(c,e){e=a.utils.extend({},e);if(c==a.api.events.JWPLAYER_FULLSCREEN&&!e.fullscreen){e.fullscreen=e.message=="true"?true:false;delete e.message}else if(typeof e.data=="object"){e=a.utils.extend(e,e.data);delete e.data}else typeof e.metadata=="object"&&a.utils.deepReplaceKeyName(e.metadata,["__dot__","__spc__","__dsh__"],["."," ","-"]);c=["position","duration","offset"];for(var g in c)if(e[c[g]])e[c[g]]=
Math.round(e[c[g]]*1E3)/1E3;return e};a.utils.saveCookie=function(c,e){document.cookie="jwplayer."+c+"="+e+"; path=/"};a.utils.getCookies=function(){for(var c={},e=document.cookie.split("; "),g=0;g<e.length;g++){var l=e[g].split("=");if(l[0].indexOf("jwplayer.")==0)c[l[0].substring(9,l[0].length)]=l[1]}return c};a.utils.readCookie=function(c){return a.utils.getCookies()[c]}})(jwplayer);(function(a){a.events=function(){};a.events.COMPLETE="COMPLETE";a.events.ERROR="ERROR"})(jwplayer);(function(a){a.events.eventdispatcher=
function(b){var c,e;this.resetEventListeners=function(){c={};e=[]};this.resetEventListeners();this.addEventListener=function(g,l,r){try{a.utils.exists(c[g])||(c[g]=[]);typeof l=="string"&&eval("listener = "+l);c[g].push({listener:l,count:r})}catch(u){a.utils.log("error",u)}return false};this.removeEventListener=function(g,l){if(c[g]){try{for(var r=0;r<c[g].length;r++)if(c[g][r].listener.toString()==l.toString()){c[g].splice(r,1);break}}catch(u){a.utils.log("error",u)}return false}};this.addGlobalListener=
function(g,l){try{typeof g=="string"&&eval("listener = "+g);e.push({listener:g,count:l})}catch(r){a.utils.log("error",r)}return false};this.removeGlobalListener=function(g){if(g){try{for(var l=0;l<e.length;l++)if(e[l].listener.toString()==g.toString()){e.splice(l,1);break}}catch(r){a.utils.log("error",r)}return false}};this.sendEvent=function(g,l){a.utils.exists(l)||(l={});b&&a.utils.log(g,l);if(typeof c[g]!="undefined")for(var r=0;r<c[g].length;r++){try{c[g][r].listener(l)}catch(u){a.utils.log("There was an error while handling a listener: "+
u.toString(),c[g][r].listener)}if(c[g][r])if(c[g][r].count===1)delete c[g][r];else if(c[g][r].count>0)c[g][r].count-=1}for(g=0;g<e.length;g++){try{e[g].listener(l)}catch(t){a.utils.log("There was an error while handling a listener: "+t.toString(),e[g].listener)}if(e[g])if(e[g].count===1)delete e[g];else if(e[g].count>0)e[g].count-=1}}}})(jwplayer);(function(a){var b={};a.utils.animations=function(){};a.utils.animations.transform=function(c,e){c.style.webkitTransform=e;c.style.MozTransform=e;c.style.OTransform=
e;c.style.msTransform=e};a.utils.animations.transformOrigin=function(c,e){c.style.webkitTransformOrigin=e;c.style.MozTransformOrigin=e;c.style.OTransformOrigin=e;c.style.msTransformOrigin=e};a.utils.animations.rotate=function(c,e){a.utils.animations.transform(c,["rotate(",e,"deg)"].join(""))};a.utils.cancelAnimation=function(c){delete b[c.id]};a.utils.fadeTo=function(c,e,g,l,r,u){if(!(b[c.id]!=u&&a.utils.exists(u)))if(c.style.opacity!=e){var t=(new Date).getTime();u>t&&setTimeout(function(){a.utils.fadeTo(c,
e,g,l,0,u)},u-t);if(c.style.display=="none")c.style.display="block";a.utils.exists(l)||(l=c.style.opacity===""?1:c.style.opacity);if(c.style.opacity==e&&c.style.opacity!==""&&a.utils.exists(u)){if(e===0)c.style.display="none"}else{if(!a.utils.exists(u)){u=t;b[c.id]=u}a.utils.exists(r)||(r=0);t=g>0?(t-u)/(g*1E3):0;t=t>1?1:t;t=l+t*(e-l);if(t>1)t=1;else if(t<0)t=0;c.style.opacity=t;if(r>0){b[c.id]=u+r*1E3;a.utils.fadeTo(c,e,g,l,0,b[c.id])}else setTimeout(function(){a.utils.fadeTo(c,e,g,l,0,u)},10)}}}})(jwplayer);
(function(a){a.utils.arrays=function(){};a.utils.arrays.indexOf=function(b,c){for(var e=0;e<b.length;e++)if(b[e]==c)return e;return-1};a.utils.arrays.remove=function(b,c){c=a.utils.arrays.indexOf(b,c);c>-1&&b.splice(c,1)}})(jwplayer);(function(a){a.utils.extensionmap={"3gp":{html5:"video/3gpp",flash:"video"},"3gpp":{html5:"video/3gpp"},"3g2":{html5:"video/3gpp2",flash:"video"},"3gpp2":{html5:"video/3gpp2"},flv:{flash:"video"},f4a:{html5:"audio/mp4"},f4b:{html5:"audio/mp4",flash:"video"},f4v:{html5:"video/mp4",
flash:"video"},mov:{html5:"video/quicktime",flash:"video"},m4a:{html5:"audio/mp4",flash:"video"},m4b:{html5:"audio/mp4"},m4p:{html5:"audio/mp4"},m4v:{html5:"video/mp4",flash:"video"},mp4:{html5:"video/mp4",flash:"video"},rbs:{flash:"sound"},aac:{html5:"audio/aac",flash:"video"},mp3:{html5:"audio/mp3",flash:"sound"},ogg:{html5:"audio/ogg"},oga:{html5:"audio/ogg"},ogv:{html5:"video/ogg"},webm:{html5:"video/webm"},m3u8:{html5:"audio/x-mpegurl"},gif:{flash:"image"},jpeg:{flash:"image"},jpg:{flash:"image"},
swf:{flash:"image"},png:{flash:"image"},wav:{html5:"audio/x-wav"}}})(jwplayer);(function(a){function b(t,v){if(a.utils.exists(v))a.utils.extend(v,r[t]);else v=r[t];return v}function c(t,v){if(u[t.tagName.toLowerCase()]&&!a.utils.exists(v))return u[t.tagName.toLowerCase()](t);else{v=b("element",v);var G={};for(var q in v)if(q!="length"){var D=t.getAttribute(q);if(a.utils.exists(D))G[v[q]]=D}if((t=t.style["#background-color"])&&!(t=="transparent"||t=="rgba(0, 0, 0, 0)"))G.screencolor=t;return G}}function e(t,
v){v=b("media",v);var G=[],q=a.utils.selectors("source",t);for(var D in q)isNaN(D)||G.push(g(q[D]));t=c(t,v);if(a.utils.exists(t.file))G[0]={file:t.file};t.levels=G;return t}function g(t,v){v=b("source",v);t=c(t,v);t.width=t.width?t.width:0;t.bitrate=t.bitrate?t.bitrate:0;return t}function l(t,v){v=b("video",v);return e(t,v)}a.utils.mediaparser=function(){};var r={element:{width:"width",height:"height",id:"id","class":"className",name:"name"},media:{src:"file",preload:"preload",autoplay:"autostart",
loop:"repeat",controls:"controls"},source:{src:"file",type:"type",media:"media","data-jw-width":"width","data-jw-bitrate":"bitrate"},video:{poster:"image"}},u={};a.utils.mediaparser.parseMedia=function(t){return c(t)};u.media=e;u.audio=e;u.source=g;u.video=l})(jwplayer);(function(a){a.utils.loaderstatus={NEW:"NEW",LOADING:"LOADING",ERROR:"ERROR",COMPLETE:"COMPLETE"};a.utils.scriptloader=function(b){var c=a.utils.loaderstatus.NEW,e=new a.events.eventdispatcher;a.utils.extend(this,e);this.load=function(){if(c==
a.utils.loaderstatus.NEW){c=a.utils.loaderstatus.LOADING;var g=document.createElement("script");g.onload=function(){c=a.utils.loaderstatus.COMPLETE;e.sendEvent(a.events.COMPLETE)};g.onerror=function(){c=a.utils.loaderstatus.ERROR;e.sendEvent(a.events.ERROR)};g.onreadystatechange=function(){if(g.readyState=="loaded"||g.readyState=="complete"){c=a.utils.loaderstatus.COMPLETE;e.sendEvent(a.events.COMPLETE)}};document.getElementsByTagName("head")[0].appendChild(g);g.src=b}};this.getStatus=function(){return c}}})(jwplayer);
(function(a){a.utils.selectors=function(b,c){a.utils.exists(c)||(c=document);b=a.utils.strings.trim(b);var e=b.charAt(0);if(e=="#")return c.getElementById(b.substr(1));else if(e==".")return c.getElementsByClassName?c.getElementsByClassName(b.substr(1)):a.utils.selectors.getElementsByTagAndClass("*",b.substr(1));else if(b.indexOf(".")>0){b=b.split(".");return a.utils.selectors.getElementsByTagAndClass(b[0],b[1])}else return c.getElementsByTagName(b)};a.utils.selectors.getElementsByTagAndClass=function(b,
c,e){var g=[];a.utils.exists(e)||(e=document);b=e.getElementsByTagName(b);for(e=0;e<b.length;e++)if(a.utils.exists(b[e].className))for(var l=b[e].className.split(" "),r=0;r<l.length;r++)l[r]==c&&g.push(b[e]);return g}})(jwplayer);(function(a){a.utils.strings=function(){};a.utils.strings.trim=function(b){return b.replace(/^\s*/,"").replace(/\s*$/,"")};a.utils.strings.pad=function(b,c,e){for(e||(e="0");b.length<c;)b=e+b;return b};a.utils.strings.serialize=function(b){return b==null?null:b=="true"?true:
b=="false"?false:isNaN(Number(b))||b.length>5||b.length==0?b:Number(b)};a.utils.strings.seconds=function(b){b=b.replace(",",".");var c=b.split(":"),e=0;if(b.substr(-1)=="s")e=Number(b.substr(0,b.length-1));else if(b.substr(-1)=="m")e=Number(b.substr(0,b.length-1))*60;else if(b.substr(-1)=="h")e=Number(b.substr(0,b.length-1))*3600;else if(c.length>1){e=Number(c[c.length-1]);e+=Number(c[c.length-2])*60;if(c.length==3)e+=Number(c[c.length-3])*3600}else e=Number(b);return e};a.utils.strings.xmlAttribute=
function(b,c){for(var e=0;e<b.attributes.length;e++)if(b.attributes[e].name&&b.attributes[e].name.toLowerCase()==c.toLowerCase())return b.attributes[e].value.toString();return""};a.utils.strings.jsonToString=function(b){var c=c||{};if(c&&c.stringify)return c.stringify(b);c=typeof b;if(c!="object"||b===null)if(c=="string")b.replace(/"/g,'\\"');else return String(b);else{c=[];var e=b&&b.constructor==Array;for(var g in b){var l=b[g];switch(typeof l){case "string":l='"'+l.replace(/"/g,'\\"')+'"';break;
case "object":if(a.utils.exists(l))l=a.utils.strings.jsonToString(l);break}if(e)typeof l!="function"&&c.push(String(l));else typeof l!="function"&&c.push('"'+g+'":'+String(l))}return e?"["+String(c)+"]":"{"+String(c)+"}"}}})(jwplayer);(function(a){function b(l){if(["true","false","t","f"].toString().indexOf(l.toLowerCase().replace(" ",""))>=0)return"boolean";else if(g.test(l))return"color";else if(!isNaN(parseInt(l,10))&&parseInt(l,10).toString().length==l.length)return"integer";else if(!isNaN(parseFloat(l))&&
parseFloat(l).toString().length==l.length)return"float";return"string"}function c(l,r){if(!a.utils.exists(r))return l;switch(r){case "color":if(l.length>0)return e(l);return null;case "integer":return parseInt(l,10);case "float":return parseFloat(l);case "boolean":if(l.toLowerCase()=="true")return true;else if(l=="1")return true;return false}return l}function e(l){switch(l.toLowerCase()){case "blue":return parseInt("0000FF",16);case "green":return parseInt("00FF00",16);case "red":return parseInt("FF0000",
16);case "cyan":return parseInt("00FFFF",16);case "magenta":return parseInt("FF00FF",16);case "yellow":return parseInt("FFFF00",16);case "black":return parseInt("000000",16);case "white":return parseInt("FFFFFF",16);default:l=l.replace(/(#|0x)?([0-9A-F]{3,6})$/gi,"$2");if(l.length==3)l=l.charAt(0)+l.charAt(0)+l.charAt(1)+l.charAt(1)+l.charAt(2)+l.charAt(2);return parseInt(l,16)}}var g=new RegExp(/^(#|0x)[0-9a-fA-F]{3,6}/);a.utils.typechecker=function(l,r){r=!a.utils.exists(r)?b(l):r;return c(l,r)}})(jwplayer);
(function(a){a.utils.parsers=function(){};a.utils.parsers.localName=function(b){return b?b.localName?b.localName:b.baseName?b.baseName:"":""};a.utils.parsers.textContent=function(b){return b?b.textContent?b.textContent:b.text?b.text:"":""}})(jwplayer);(function(a){a.utils.parsers.jwparser=function(){};a.utils.parsers.jwparser.PREFIX="jwplayer";a.utils.parsers.jwparser.parseEntry=function(b,c){for(var e=0;e<b.childNodes.length;e++){if(b.childNodes[e].prefix==a.utils.parsers.jwparser.PREFIX){c[a.utils.parsers.localName(b.childNodes[e])]=
a.utils.strings.serialize(a.utils.parsers.textContent(b.childNodes[e]));a.utils.parsers.localName(b.childNodes[e])=="file"&&c.levels&&delete c.levels}if(!c.file&&String(c.link).toLowerCase().indexOf("youtube")>-1)c.file=c.link}return c};a.utils.parsers.jwparser.getProvider=function(b){if(b.type)return b.type;else if(b.file.indexOf("youtube.com/w")>-1||b.file.indexOf("youtube.com/v")>-1||b.file.indexOf("youtu.be/")>-1)return"youtube";else if(b.streamer&&b.streamer.indexOf("rtmp")==0)return"rtmp";else if(b.streamer&&
b.streamer.indexOf("http")==0)return"http";else{b=a.utils.strings.extension(b.file);if(extensions.hasOwnProperty(b))return extensions[b]}return""}})(jwplayer);(function(a){a.utils.parsers.mediaparser=function(){};a.utils.parsers.mediaparser.PREFIX="media";a.utils.parsers.mediaparser.parseGroup=function(b,c){for(var e=false,g=0;g<b.childNodes.length;g++)if(b.childNodes[g].prefix==a.utils.parsers.mediaparser.PREFIX)if(a.utils.parsers.localName(b.childNodes[g]))switch(a.utils.parsers.localName(b.childNodes[g]).toLowerCase()){case "content":if(!e)c.file=
a.utils.strings.xmlAttribute(b.childNodes[g],"url");if(a.utils.strings.xmlAttribute(b.childNodes[g],"duration"))c.duration=a.utils.strings.seconds(a.utils.strings.xmlAttribute(b.childNodes[g],"duration"));if(a.utils.strings.xmlAttribute(b.childNodes[g],"start"))c.start=a.utils.strings.seconds(a.utils.strings.xmlAttribute(b.childNodes[g],"start"));if(b.childNodes[g].childNodes&&b.childNodes[g].childNodes.length>0)c=a.utils.parsers.mediaparser.parseGroup(b.childNodes[g],c);if(a.utils.strings.xmlAttribute(b.childNodes[g],
"width")||a.utils.strings.xmlAttribute(b.childNodes[g],"bitrate")||a.utils.strings.xmlAttribute(b.childNodes[g],"url")){if(!c.levels)c.levels=[];c.levels.push({width:a.utils.strings.xmlAttribute(b.childNodes[g],"width"),bitrate:a.utils.strings.xmlAttribute(b.childNodes[g],"bitrate"),file:a.utils.strings.xmlAttribute(b.childNodes[g],"url")})}break;case "title":c.title=a.utils.parsers.textContent(b.childNodes[g]);break;case "description":c.description=a.utils.parsers.textContent(b.childNodes[g]);break;
case "keywords":c.tags=a.utils.parsers.textContent(b.childNodes[g]);break;case "thumbnail":c.image=a.utils.strings.xmlAttribute(b.childNodes[g],"url");break;case "credit":c.author=a.utils.parsers.textContent(b.childNodes[g]);break;case "player":var l=b.childNodes[g].url;if(l.indexOf("youtube.com")>=0||l.indexOf("youtu.be")>=0){e=true;c.file=a.utils.strings.xmlAttribute(b.childNodes[g],"url")}break;case "group":a.utils.parsers.mediaparser.parseGroup(b.childNodes[g],c);break}return c}})(jwplayer);(function(a){function b(c){for(var e=
{},g=0;g<c.childNodes.length;g++)if(a.utils.parsers.localName(c.childNodes[g]))switch(a.utils.parsers.localName(c.childNodes[g]).toLowerCase()){case "enclosure":e.file=a.utils.strings.xmlAttribute(c.childNodes[g],"url");break;case "title":e.title=a.utils.parsers.textContent(c.childNodes[g]);break;case "pubdate":e.date=a.utils.parsers.textContent(c.childNodes[g]);break;case "description":e.description=a.utils.parsers.textContent(c.childNodes[g]);break;case "link":e.link=a.utils.parsers.textContent(c.childNodes[g]);
break;case "category":if(e.tags)e.tags+=a.utils.parsers.textContent(c.childNodes[g]);else e.tags=a.utils.parsers.textContent(c.childNodes[g]);break}e=a.utils.parsers.mediaparser.parseGroup(c,e);e=a.utils.parsers.jwparser.parseEntry(c,e);return new a.html5.playlistitem(e)}a.utils.parsers.rssparser=function(){};a.utils.parsers.rssparser.parse=function(c){for(var e=[],g=0;g<c.childNodes.length;g++)if(a.utils.parsers.localName(c.childNodes[g]).toLowerCase()=="channel")for(var l=0;l<c.childNodes[g].childNodes.length;l++)a.utils.parsers.localName(c.childNodes[g].childNodes[l]).toLowerCase()==
"item"&&e.push(b(c.childNodes[g].childNodes[l]));return e}})(jwplayer);(function(a){var b={},c={};a.plugins=function(){};a.plugins.loadPlugins=function(e,g){c[e]=new a.plugins.pluginloader(new a.plugins.model(b),g);return c[e]};a.plugins.registerPlugin=function(e,g,l){var r=a.utils.getPluginName(e);if(b[r])b[r].registerPlugin(e,g,l);else{a.utils.log("A plugin ("+e+") was registered with the player that was not loaded. Please check your configuration.");for(var u in c)c[u].pluginFailed()}}})(jwplayer);
(function(a){a.plugins.model=function(b){this.addPlugin=function(c){var e=a.utils.getPluginName(c);b[e]||(b[e]=new a.plugins.plugin(c));return b[e]}}})(jwplayer);(function(a){a.plugins.pluginmodes={FLASH:"FLASH",JAVASCRIPT:"JAVASCRIPT",HYBRID:"HYBRID"};a.plugins.plugin=function(b){function c(){switch(a.utils.getPluginPathType(b)){case a.utils.pluginPathType.ABSOLUTE:return b;case a.utils.pluginPathType.RELATIVE:return a.utils.getAbsolutePath(b,window.location.href);case a.utils.pluginPathType.CDN:var q=
a.utils.getPluginName(b),D=a.utils.getPluginVersion(b);return(window.location.href.indexOf("https://")==0?l.replace("http://","https://secure"):l)+"/"+a.version.split(".")[0]+"/"+q+"/"+q+(D!==""?"-"+D:"")+".js"}}function e(){v=setTimeout(function(){r=a.utils.loaderstatus.COMPLETE;G.sendEvent(a.events.COMPLETE)},1E3)}function g(){r=a.utils.loaderstatus.ERROR;G.sendEvent(a.events.ERROR)}var l="http://lp.longtailvideo.com",r=a.utils.loaderstatus.NEW,u,t,v,G=new a.events.eventdispatcher;a.utils.extend(this,
G);this.load=function(){if(r==a.utils.loaderstatus.NEW)if(b.lastIndexOf(".swf")>0){u=b;r=a.utils.loaderstatus.COMPLETE;G.sendEvent(a.events.COMPLETE)}else{r=a.utils.loaderstatus.LOADING;var q=new a.utils.scriptloader(c());q.addEventListener(a.events.COMPLETE,e);q.addEventListener(a.events.ERROR,g);q.load()}};this.registerPlugin=function(q,D,J){if(v){clearTimeout(v);v=undefined}if(D&&J){u=J;t=D}else if(typeof D=="string")u=D;else if(typeof D=="function")t=D;else if(!D&&!J)u=q;r=a.utils.loaderstatus.COMPLETE;
G.sendEvent(a.events.COMPLETE)};this.getStatus=function(){return r};this.getPluginName=function(){return a.utils.getPluginName(b)};this.getFlashPath=function(){if(u)switch(a.utils.getPluginPathType(u)){case a.utils.pluginPathType.ABSOLUTE:return u;case a.utils.pluginPathType.RELATIVE:if(b.lastIndexOf(".swf")>0)return a.utils.getAbsolutePath(u,window.location.href);return a.utils.getAbsolutePath(u,c());case a.utils.pluginPathType.CDN:if(u.indexOf("-")>-1)return u+"h";return u+"-h"}return null};this.getJS=
function(){return t};this.getPluginmode=function(){if(typeof u!="undefined"&&typeof t!="undefined")return a.plugins.pluginmodes.HYBRID;else if(typeof u!="undefined")return a.plugins.pluginmodes.FLASH;else if(typeof t!="undefined")return a.plugins.pluginmodes.JAVASCRIPT};this.getNewInstance=function(q,D,J){return new t(q,D,J)};this.getURL=function(){return b}}})(jwplayer);(function(a){a.plugins.pluginloader=function(b,c){function e(){if(!t){t=true;r=a.utils.loaderstatus.COMPLETE;v.sendEvent(a.events.COMPLETE)}}
function g(){if(!t){var G=0;for(plugin in l){var q=l[plugin].getStatus();if(q==a.utils.loaderstatus.LOADING||q==a.utils.loaderstatus.NEW)G++}G==0&&e()}}var l={},r=a.utils.loaderstatus.NEW,u=false,t=false,v=new a.events.eventdispatcher;a.utils.extend(this,v);this.setupPlugins=function(G,q,D){var J={length:0,plugins:{}},M={length:0,plugins:{}};for(var A in l){var Q=l[A].getPluginName();if(l[A].getFlashPath()){J.plugins[l[A].getFlashPath()]=q.plugins[A];J.plugins[l[A].getFlashPath()].pluginmode=l[A].getPluginmode();
J.length++}if(l[A].getJS()){var j=document.createElement("div");j.id=G.id+"_"+Q;j.style.position="absolute";j.style.zIndex=M.length+10;M.plugins[Q]=l[A].getNewInstance(G,q.plugins[A],j);M.length++;if(typeof M.plugins[Q].resize!="undefined"){G.onReady(D(M.plugins[Q],j,true));G.onResize(D(M.plugins[Q],j))}}}G.plugins=M.plugins;return J};this.load=function(){r=a.utils.loaderstatus.LOADING;u=true;for(var G in c)if(a.utils.exists(G)){l[G]=b.addPlugin(G);l[G].addEventListener(a.events.COMPLETE,g);l[G].addEventListener(a.events.ERROR,
g)}for(G in l)l[G].load();u=false;g()};this.pluginFailed=function(){e()};this.getStatus=function(){return r}}})(jwplayer);(function(a){var b=[];a.api=function(c){function e(j,p){return function(w,B,H,z){if(j.renderingMode=="flash"||j.renderingMode=="html5"){var N;if(B){Q[w]=B;N="jwplayer('"+j.id+"').callback('"+w+"')"}else!B&&Q[w]&&delete Q[w];G.jwDockSetButton(w,N,H,z)}return p}}function g(j){D=[];a.utils.getOuterHTML(j.container)!=M&&a.api.destroyPlayer(j.id,M)}function l(j){return function(p){var w=
p.newstate;p=p.oldstate;if(w==j){var B=t[w];if(B)for(var H=0;H<B.length;H++)typeof B[H]=="function"&&B[H].call(this,{oldstate:p,newstate:w})}}}function r(j,p){return function(w){if(j==w.component){var B=v[j][p];if(B)for(var H=0;H<B.length;H++)typeof B[H]=="function"&&B[H].call(this,w)}}}this.container=c;this.id=c.id;var u={},t={},v={},G=undefined,q=false,D=[],J=undefined,M=a.utils.getOuterHTML(c),A={},Q={};this.getBuffer=function(){return this.callInternal("jwGetBuffer")};this.getContainer=function(){return this.container};
this.getPlugin=function(j){var p=this,w={};return j=="dock"?a.utils.extend(w,{setButton:e(p,w),show:function(){p.callInternal("jwDockShow");return w},hide:function(){p.callInternal("jwDockHide");return w},onShow:function(B){p.componentListener("dock",a.api.events.JWPLAYER_COMPONENT_SHOW,B);return w},onHide:function(B){p.componentListener("dock",a.api.events.JWPLAYER_COMPONENT_HIDE,B);return w}}):j=="controlbar"?a.utils.extend(w,{show:function(){p.callInternal("jwControlbarShow");return w},hide:function(){p.callInternal("jwControlbarHide");
return w},onShow:function(B){p.componentListener("controlbar",a.api.events.JWPLAYER_COMPONENT_SHOW,B);return w},onHide:function(B){p.componentListener("controlbar",a.api.events.JWPLAYER_COMPONENT_HIDE,B);return w}}):j=="display"?a.utils.extend(w,{show:function(){p.callInternal("jwDisplayShow");return w},hide:function(){p.callInternal("jwDisplayHide");return w},onShow:function(B){p.componentListener("display",a.api.events.JWPLAYER_COMPONENT_SHOW,B);return w},onHide:function(B){p.componentListener("display",
a.api.events.JWPLAYER_COMPONENT_HIDE,B);return w}}):this.plugins[j]};this.callback=function(j){if(Q[j])return Q[j]()};this.getDuration=function(){return this.callInternal("jwGetDuration")};this.getFullscreen=function(){return this.callInternal("jwGetFullscreen")};this.getHeight=function(){return this.callInternal("jwGetHeight")};this.getLockState=function(){return this.callInternal("jwGetLockState")};this.getMeta=function(){return this.getItemMeta()};this.getMute=function(){return this.callInternal("jwGetMute")};
this.getPlaylist=function(){var j=this.callInternal("jwGetPlaylist");this.renderingMode=="flash"&&a.utils.deepReplaceKeyName(j,["__dot__","__spc__","__dsh__"],["."," ","-"]);for(var p=0;p<j.length;p++)if(!a.utils.exists(j[p].index))j[p].index=p;return j};this.getPlaylistItem=function(j){a.utils.exists(j)||(j=this.getCurrentItem());return this.getPlaylist()[j]};this.getPosition=function(){return this.callInternal("jwGetPosition")};this.getRenderingMode=function(){return this.renderingMode};this.getState=
function(){return this.callInternal("jwGetState")};this.getVolume=function(){return this.callInternal("jwGetVolume")};this.getWidth=function(){return this.callInternal("jwGetWidth")};this.setFullscreen=function(j){a.utils.exists(j)?this.callInternal("jwSetFullscreen",j):this.callInternal("jwSetFullscreen",!this.callInternal("jwGetFullscreen"));return this};this.setMute=function(j){a.utils.exists(j)?this.callInternal("jwSetMute",j):this.callInternal("jwSetMute",!this.callInternal("jwGetMute"));return this};
this.lock=function(){return this};this.unlock=function(){return this};this.load=function(j){this.callInternal("jwLoad",j);return this};this.playlistItem=function(j){this.callInternal("jwPlaylistItem",j);return this};this.playlistPrev=function(){this.callInternal("jwPlaylistPrev");return this};this.playlistNext=function(){this.callInternal("jwPlaylistNext");return this};this.resize=function(j,p){if(this.renderingMode=="html5")G.jwResize(j,p);else{this.container.width=j;this.container.height=p;var w=
document.getElementById(this.id+"_wrapper");if(w){w.style.width=j+"px";w.style.height=p+"px"}}return this};this.play=function(j){if(typeof j=="undefined"){j=this.getState();j==a.api.events.state.PLAYING||j==a.api.events.state.BUFFERING?this.callInternal("jwPause"):this.callInternal("jwPlay")}else this.callInternal("jwPlay",j);return this};this.pause=function(j){if(typeof j=="undefined"){j=this.getState();j==a.api.events.state.PLAYING||j==a.api.events.state.BUFFERING?this.callInternal("jwPause"):this.callInternal("jwPlay")}else this.callInternal("jwPause",
j);return this};this.stop=function(){this.callInternal("jwStop");return this};this.seek=function(j){this.callInternal("jwSeek",j);return this};this.setVolume=function(j){this.callInternal("jwSetVolume",j);return this};this.loadInstream=function(j,p){return J=new a.api.instream(this,G,j,p)};this.onBufferChange=function(j){return this.eventListener(a.api.events.JWPLAYER_MEDIA_BUFFER,j)};this.onBufferFull=function(j){return this.eventListener(a.api.events.JWPLAYER_MEDIA_BUFFER_FULL,j)};this.onError=
function(j){return this.eventListener(a.api.events.JWPLAYER_ERROR,j)};this.onFullscreen=function(j){return this.eventListener(a.api.events.JWPLAYER_FULLSCREEN,j)};this.onMeta=function(j){return this.eventListener(a.api.events.JWPLAYER_MEDIA_META,j)};this.onMute=function(j){return this.eventListener(a.api.events.JWPLAYER_MEDIA_MUTE,j)};this.onPlaylist=function(j){return this.eventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,j)};this.onPlaylistItem=function(j){return this.eventListener(a.api.events.JWPLAYER_PLAYLIST_ITEM,
j)};this.onReady=function(j){return this.eventListener(a.api.events.API_READY,j)};this.onResize=function(j){return this.eventListener(a.api.events.JWPLAYER_RESIZE,j)};this.onComplete=function(j){return this.eventListener(a.api.events.JWPLAYER_MEDIA_COMPLETE,j)};this.onSeek=function(j){return this.eventListener(a.api.events.JWPLAYER_MEDIA_SEEK,j)};this.onTime=function(j){return this.eventListener(a.api.events.JWPLAYER_MEDIA_TIME,j)};this.onVolume=function(j){return this.eventListener(a.api.events.JWPLAYER_MEDIA_VOLUME,
j)};this.onBeforePlay=function(j){return this.eventListener(a.api.events.JWPLAYER_MEDIA_BEFOREPLAY,j)};this.onBeforeComplete=function(j){return this.eventListener(a.api.events.JWPLAYER_MEDIA_BEFORECOMPLETE,j)};this.onBuffer=function(j){return this.stateListener(a.api.events.state.BUFFERING,j)};this.onPause=function(j){return this.stateListener(a.api.events.state.PAUSED,j)};this.onPlay=function(j){return this.stateListener(a.api.events.state.PLAYING,j)};this.onIdle=function(j){return this.stateListener(a.api.events.state.IDLE,
j)};this.remove=function(){if(!q)throw"Cannot call remove() before player is ready";g(this)};this.setup=function(j){if(a.embed){var p=this.id;g(this);p=a(p);p.config=j;return new a.embed(p)}return this};this.registerPlugin=function(j,p,w){a.plugins.registerPlugin(j,p,w)};this.setPlayer=function(j,p){G=j;this.renderingMode=p};this.stateListener=function(j,p){if(!t[j]){t[j]=[];this.eventListener(a.api.events.JWPLAYER_PLAYER_STATE,l(j))}t[j].push(p);return this};this.detachMedia=function(){if(this.renderingMode==
"html5")return this.callInternal("jwDetachMedia")};this.attachMedia=function(){if(this.renderingMode=="html5")return this.callInternal("jwAttachMedia")};this.componentListener=function(j,p,w){v[j]||(v[j]={});if(!v[j][p]){v[j][p]=[];this.eventListener(p,r(j,p))}v[j][p].push(w);return this};this.addInternalListener=function(j,p){try{j.jwAddEventListener(p,'function(dat) { jwplayer("'+this.id+'").dispatchEvent("'+p+'", dat); }')}catch(w){a.utils.log("Could not add internal listener")}};this.eventListener=
function(j,p){if(!u[j]){u[j]=[];G&&q&&this.addInternalListener(G,j)}u[j].push(p);return this};this.dispatchEvent=function(j,p){if(u[j]){p=_utils.translateEventResponse(j,p);for(var w=0;w<u[j].length;w++)typeof u[j][w]=="function"&&u[j][w].call(this,p)}};this.dispatchInstreamEvent=function(j){J&&J.dispatchEvent(j,arguments)};this.callInternal=function(){if(q){for(var j=arguments[0],p=[],w=1;w<arguments.length;w++)p.push(arguments[w]);if(typeof G!="undefined"&&typeof G[j]=="function")return p.length==
2?G[j](p[0],p[1]):p.length==1?G[j](p[0]):G[j]();return null}else D.push(arguments)};this.playerReady=function(j){q=true;G||this.setPlayer(document.getElementById(j.id));this.container=document.getElementById(this.id);for(var p in u)this.addInternalListener(G,p);this.eventListener(a.api.events.JWPLAYER_PLAYLIST_ITEM,function(){A={}});this.eventListener(a.api.events.JWPLAYER_MEDIA_META,function(w){a.utils.extend(A,w.metadata)});for(this.dispatchEvent(a.api.events.API_READY);D.length>0;)this.callInternal.apply(this,
D.shift())};this.getItemMeta=function(){return A};this.getCurrentItem=function(){return this.callInternal("jwGetPlaylistIndex")};return this};a.api.selectPlayer=function(c){var e;a.utils.exists(c)||(c=0);if(c.nodeType)e=c;else if(typeof c=="string")e=document.getElementById(c);if(e)return(c=a.api.playerById(e.id))?c:a.api.addPlayer(new a.api(e));else if(typeof c=="number")return a.getPlayers()[c];return null};a.api.events={API_READY:"jwplayerAPIReady",JWPLAYER_READY:"jwplayerReady",JWPLAYER_FULLSCREEN:"jwplayerFullscreen",
JWPLAYER_RESIZE:"jwplayerResize",JWPLAYER_ERROR:"jwplayerError",JWPLAYER_MEDIA_BEFOREPLAY:"jwplayerMediaBeforePlay",JWPLAYER_MEDIA_BEFORECOMPLETE:"jwplayerMediaBeforeComplete",JWPLAYER_COMPONENT_SHOW:"jwplayerComponentShow",JWPLAYER_COMPONENT_HIDE:"jwplayerComponentHide",JWPLAYER_MEDIA_BUFFER:"jwplayerMediaBuffer",JWPLAYER_MEDIA_BUFFER_FULL:"jwplayerMediaBufferFull",JWPLAYER_MEDIA_ERROR:"jwplayerMediaError",JWPLAYER_MEDIA_LOADED:"jwplayerMediaLoaded",JWPLAYER_MEDIA_COMPLETE:"jwplayerMediaComplete",
JWPLAYER_MEDIA_SEEK:"jwplayerMediaSeek",JWPLAYER_MEDIA_TIME:"jwplayerMediaTime",JWPLAYER_MEDIA_VOLUME:"jwplayerMediaVolume",JWPLAYER_MEDIA_META:"jwplayerMediaMeta",JWPLAYER_MEDIA_MUTE:"jwplayerMediaMute",JWPLAYER_PLAYER_STATE:"jwplayerPlayerState",JWPLAYER_PLAYLIST_LOADED:"jwplayerPlaylistLoaded",JWPLAYER_PLAYLIST_ITEM:"jwplayerPlaylistItem",JWPLAYER_INSTREAM_CLICK:"jwplayerInstreamClicked",JWPLAYER_INSTREAM_DESTROYED:"jwplayerInstreamDestroyed"};a.api.events.state={BUFFERING:"BUFFERING",IDLE:"IDLE",
PAUSED:"PAUSED",PLAYING:"PLAYING"};a.api.playerById=function(c){for(var e=0;e<b.length;e++)if(b[e].id==c)return b[e];return null};a.api.addPlayer=function(c){for(var e=0;e<b.length;e++)if(b[e]==c)return c;b.push(c);return c};a.api.destroyPlayer=function(c,e){for(var g=-1,l=0;l<b.length;l++)if(b[l].id==c)g=l;if(g>=0){try{b[g].callInternal("jwDestroy")}catch(r){}c=document.getElementById(b[g].id);if(document.getElementById(b[g].id+"_wrapper"))c=document.getElementById(b[g].id+"_wrapper");if(c)if(e)a.utils.setOuterHTML(c,
e);else{e=document.createElement("div");l=c.id;if(c.id.indexOf("_wrapper")==c.id.length-8)newID=c.id.substring(0,c.id.length-8);e.setAttribute("id",l);c.parentNode.replaceChild(e,c)}b.splice(g,1)}return null};a.getPlayers=function(){return b.slice(0)}})(jwplayer);var _userPlayerReady=typeof playerReady=="function"?playerReady:undefined;playerReady=function(a){var b=jwplayer.api.playerById(a.id);b?b.playerReady(a):jwplayer.api.selectPlayer(a.id).playerReady(a);_userPlayerReady&&_userPlayerReady.call(this,
a)};(function(a){a.api.instream=function(b,c,e,g){function l(){G.callInternal("jwLoadInstream",e,g)}function r(M,A){q.jwInstreamAddEventListener(A,'function(dat) { jwplayer("'+G.id+'").dispatchInstreamEvent("'+A+'", dat); }')}function u(M,A){if(!D[M]){D[M]=[];r(q,M)}D[M].push(A);return this}function t(M,A){if(!J[M]){J[M]=[];u(a.api.events.JWPLAYER_PLAYER_STATE,v(M))}J[M].push(A);return this}function v(M){return function(A){var Q=A.newstate,j=A.oldstate;if(Q==M){var p=J[Q];if(p)for(var w=0;w<p.length;w++)typeof p[w]==
"function"&&p[w].call(this,{oldstate:j,newstate:Q,type:A.type})}}}var G=b,q=c,D={},J={};this.dispatchEvent=function(M,A){if(D[M]){A=_utils.translateEventResponse(M,A[1]);for(var Q=0;Q<D[M].length;Q++)typeof D[M][Q]=="function"&&D[M][Q].call(this,A)}};this.onError=function(M){return u(a.api.events.JWPLAYER_ERROR,M)};this.onFullscreen=function(M){return u(a.api.events.JWPLAYER_FULLSCREEN,M)};this.onMeta=function(M){return u(a.api.events.JWPLAYER_MEDIA_META,M)};this.onMute=function(M){return u(a.api.events.JWPLAYER_MEDIA_MUTE,
M)};this.onComplete=function(M){return u(a.api.events.JWPLAYER_MEDIA_COMPLETE,M)};this.onSeek=function(M){return u(a.api.events.JWPLAYER_MEDIA_SEEK,M)};this.onTime=function(M){return u(a.api.events.JWPLAYER_MEDIA_TIME,M)};this.onVolume=function(M){return u(a.api.events.JWPLAYER_MEDIA_VOLUME,M)};this.onBuffer=function(M){return t(a.api.events.state.BUFFERING,M)};this.onPause=function(M){return t(a.api.events.state.PAUSED,M)};this.onPlay=function(M){return t(a.api.events.state.PLAYING,M)};this.onIdle=
function(M){return t(a.api.events.state.IDLE,M)};this.onInstreamClick=function(M){return u(a.api.events.JWPLAYER_INSTREAM_CLICK,M)};this.onInstreamDestroyed=function(M){return u(a.api.events.JWPLAYER_INSTREAM_DESTROYED,M)};this.play=function(M){q.jwInstreamPlay(M)};this.pause=function(M){q.jwInstreamPause(M)};this.seek=function(M){q.jwInstreamSeek(M)};this.destroy=function(){q.jwInstreamDestroy()};this.getState=function(){return q.jwInstreamGetState()};this.getDuration=function(){return q.jwInstreamGetDuration()};
this.getPosition=function(){return q.jwInstreamGetPosition()};l()}})(jwplayer);(function(a){function b(){if(!document.body)return setTimeout(b,15);for(var e=c.selectors.getElementsByTagAndClass("video","jwplayer"),g=0;g<e.length;g++){var l=e[g];if(l.id=="")l.id="jwplayer_"+Math.round(Math.random()*1E5);a(l.id).setup({})}}var c=a.utils;a.embed=function(e){function g(v,G){for(var q in G)typeof v[q]=="function"&&v[q].call(v,G[q])}function l(){if(t.getStatus()==c.loaderstatus.COMPLETE){for(var v=0;v<
u.modes.length;v++)if(u.modes[v].type&&a.embed[u.modes[v].type]){var G=u.modes[v].config,q=u;if(G){q=c.extend(c.clone(u),G);for(var D=["file","levels","playlist"],J=0;J<D.length;J++)if(c.exists(G[D[J]]))for(var M=0;M<D.length;M++)if(M!=J){var A=D[M];c.exists(q[A])&&!c.exists(G[A])&&delete q[A]}}G=new a.embed[u.modes[v].type](document.getElementById(e.id),u.modes[v],q,t,e);if(G.supportsConfig()){G.embed();g(e,u.events);return e}}c.log("No suitable players found");new a.embed.logo(c.extend({hide:true},
u.components.logo),"none",e.id)}}var r=c.mediaparser.parseMedia(e.container),u=new a.embed.config(c.extend({width:400,height:300,components:{controlbar:{position:"over"}}},r,e.config),this),t=a.plugins.loadPlugins(e.id,u.plugins);t.addEventListener(a.events.COMPLETE,l);t.addEventListener(a.events.ERROR,l);t.load();return e};b()})(jwplayer);(function(a){function b(v){v=[{type:"flash",src:v?v:"/jwplayer/player.swf"},{type:"html5"},{type:"download"}];if(r.isAndroid())v[0]=v.splice(1,1,v[0])[0];return v}
function c(v){var G=false;return G=v instanceof Array||typeof v=="object"&&!v.position&&!v.size}function e(v){if(typeof v=="string")if(parseInt(v).toString()==v||v.toLowerCase().indexOf("px")>-1)return parseInt(v);return v}function g(v){var G={};switch(r.typeOf(v.plugins)){case "object":for(var q in v.plugins)G[r.getPluginName(q)]=q;break;case "string":v=v.plugins.split(",");for(q=0;q<v.length;q++)G[r.getPluginName(v[q])]=v[q];break}return G}function l(v,G,q,D){if(r.typeOf(v[G])!="object")v[G]={};
var J=v[G][q];if(r.typeOf(J)!="object")v[G][q]=J={};if(D)if(G=="plugins"){G=r.getPluginName(q);J[D]=v[G+"."+D];delete v[G+"."+D]}else{J[D]=v[q+"."+D];delete v[q+"."+D]}}var r=a.utils,u={players:"modes",autoplay:"autostart"},t=["playlist","dock","controlbar","logo","display"];a.embed.deserialize=function(v){var G=g(v);for(var q in G)l(v,"plugins",G[q]);for(var D in v)if(D.indexOf(".")>-1){D=D.split(".");q=D[0];D=D[1];if(r.isInArray(t,q))l(v,"components",q,D);else G[q]&&l(v,"plugins",G[q],D)}return v};
a.embed.config=function(v){v=r.extend({},v);var G;if(c(v.playlist)){G=v.playlist;delete v.playlist}v=a.embed.deserialize(v);v.height=e(v.height);v.width=e(v.width);if(typeof v.plugins=="string"){var q=v.plugins.split(",");if(typeof v.plugins!="object")v.plugins={};for(var D=0;D<q.length;D++){var J=r.getPluginName(q[D]);if(typeof v[J]=="object"){v.plugins[q[D]]=v[J];delete v[J]}else v.plugins[q[D]]={}}}for(q=0;q<t.length;q++){D=t[q];if(r.exists(v[D])){if(typeof v[D]!="object"){v.components[D]||(v.components[D]=
{});if(D=="logo")v.components[D].file=v[D];else v.components[D].position=v[D]}else{v.components[D]||(v.components[D]={});r.extend(v.components[D],v[D])}delete v[D]}if(typeof v[D+"size"]!="undefined"){v.components[D]||(v.components[D]={});v.components[D].size=v[D+"size"];delete v[D+"size"]}}if(typeof v.icons!="undefined"){if(!v.components.display)v.components.display={};v.components.display.icons=v.icons;delete v.icons}for(var M in u)if(v[M]){v[u[M]]||(v[u[M]]=v[M]);delete v[M]}var A;if(v.flashplayer&&
!v.modes){A=b(v.flashplayer);delete v.flashplayer}else if(v.modes){if(typeof v.modes=="string")A=b(v.modes);else if(v.modes instanceof Array)A=v.modes;else if(typeof v.modes=="object"&&v.modes.type)A=[v.modes];delete v.modes}else A=b();v.modes=A;if(G)v.playlist=G;return v}})(jwplayer);(function(a){a.embed.download=function(b,c,e,g,l){function r(u,t,v){if(v)return false;v=["image","sound","youtube","http"];if(t&&v.toString().indexOf(t)>-1)return true;if(!t||t&&t=="video")if((u=a.utils.extension(u))&&
a.utils.extensionmap[u])return true;return false}this.embed=function(){function u(){_imageWidth=v.display_image.naturalWidth;_imageHeight=v.display_image.naturalHeight;t()}function t(){a.utils.stretch(a.utils.stretching.UNIFORM,v.display_image,G,q,_imageWidth,_imageHeight)}a.utils.extend({},e);var v={},G=e.width?e.width:480;if(typeof G!="number")G=parseInt(G,10);var q=e.height?e.height:320;if(typeof q!="number")q=parseInt(q,10);var D,J,M;M={};if(e.playlist&&e.playlist.length){M.file=e.playlist[0].file;
J=e.playlist[0].image;M.levels=e.playlist[0].levels}else{M.file=e.file;J=e.image;M.levels=e.levels}if(M.file)D=M.file;else if(M.levels&&M.levels.length)D=M.levels[0].file;M=D?"pointer":"auto";var A={display:{style:{cursor:M,width:G,height:q,backgroundColor:"#000",position:"relative",textDecoration:"none",border:"none",display:"block"}},display_icon:{style:{cursor:M,position:"absolute",display:D?"block":"none",top:0,left:0,border:0,margin:0,padding:0,zIndex:3,width:50,height:50,backgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAALdJREFUeNrs18ENgjAYhmFouDOCcQJGcARHgE10BDcgTOIosAGwQOuPwaQeuFRi2p/3Sb6EC5L3QCxZBgAAAOCorLW1zMn65TrlkH4NcV7QNcUQt7Gn7KIhxA+qNIR81spOGkL8oFJDyLJRdosqKDDkK+iX5+d7huzwM40xptMQMkjIOeRGo+VkEVvIPfTGIpKASfYIfT9iCHkHrBEzf4gcUQ56aEzuGK/mw0rHpy4AAACAf3kJMACBxjAQNRckhwAAAABJRU5ErkJggg==)"}},
display_iconBackground:{style:{cursor:M,position:"absolute",display:D?"block":"none",top:(q-50)/2,left:(G-50)/2,border:0,width:50,height:50,margin:0,padding:0,zIndex:2,backgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAEpJREFUeNrszwENADAIA7DhX8ENoBMZ5KR10EryckCJiIiIiIiIiIiIiIiIiIiIiIh8GmkRERERERERERERERERERERERGRHSPAAPlXH1phYpYaAAAAAElFTkSuQmCC)"}},display_image:{style:{width:G,height:q,display:J?"block":"none",
position:"absolute",cursor:M,left:0,top:0,margin:0,padding:0,textDecoration:"none",zIndex:1,border:"none"}}};M=function(Q,j,p){Q=document.createElement(Q);Q.id=p?p:b.id+"_jwplayer_"+j;a.utils.css(Q,A[j].style);return Q};v.display=M("a","display",b.id);D&&v.display.setAttribute("href",a.utils.getAbsolutePath(D));v.display_image=M("img","display_image");v.display_image.setAttribute("alt","Click to download...");J&&v.display_image.setAttribute("src",a.utils.getAbsolutePath(J));v.display_icon=M("div",
"display_icon");v.display_iconBackground=M("div","display_iconBackground");v.display.appendChild(v.display_image);v.display_iconBackground.appendChild(v.display_icon);v.display.appendChild(v.display_iconBackground);_css=a.utils.css;_hide=function(Q){_css(Q,{display:"none"})};v.display_image.onerror=function(){_hide(v.display_image)};v.display_image.onload=u;b.parentNode.replaceChild(v.display,b);v.display.appendChild(new a.embed.logo(e.components.logo,"download",b.id));l.container=document.getElementById(l.id);
l.setPlayer(v.display,"download")};this.supportsConfig=function(){if(e){var u=a.utils.getFirstPlaylistItemFromConfig(e);if(typeof u.file=="undefined"&&typeof u.levels=="undefined")return true;else if(u.file)return r(u.file,u.provider,u.playlistfile);else if(u.levels&&u.levels.length)for(var t=0;t<u.levels.length;t++)if(u.levels[t].file&&r(u.levels[t].file,u.provider,u.playlistfile))return true}else return true}}})(jwplayer);(function(a){a.embed.flash=function(b,c,e,g,l){function r(q,D,J){var M=document.createElement("param");
M.setAttribute("name",D);M.setAttribute("value",J);q.appendChild(M)}function u(q,D,J){return function(){J&&document.getElementById(l.id+"_wrapper").appendChild(D);var M=document.getElementById(l.id).getPluginConfig("display");q.resize(M.width,M.height);a.utils.css(D,{left:M.x,top:M.y})}}function t(q,D){if(q[D]){var J=q[D];for(var M in J){var A=J[M];if(typeof A=="string")q[M]||(q[M]=A);else for(var Q in A)q[M+"."+Q]||(q[M+"."+Q]=A[Q])}delete q[D]}}function v(q){if(!q)return{};var D={},J=[];for(var M in q){var A=
a.utils.getPluginName(M),Q=q[M];J.push(M);for(var j in Q)D[A+"."+j]=Q[j]}D.plugins=J.join(",");return D}function G(q){var D=q.netstreambasepath?"":"netstreambasepath="+encodeURIComponent(window.location.href.split("#")[0])+"&";for(var J in q)D+=typeof q[J]=="object"?J+"="+encodeURIComponent("[[JSON]]"+a.utils.strings.jsonToString(q[J]))+"&":J+"="+encodeURIComponent(q[J])+"&";return D.substring(0,D.length-1)}this.embed=function(){e.id=l.id;var q,D=a.utils.extend({},e),J=D.width,M=D.height;if(b.id+
"_wrapper"==b.parentNode.id)document.getElementById(b.id+"_wrapper");else{q=document.createElement("div");q.id=b.id+"_wrapper";a.utils.wrap(b,q);a.utils.css(q,{position:"relative",width:J,height:M})}q=g.setupPlugins(l,D,u);if(q.length>0)a.utils.extend(D,v(q.plugins));else delete D.plugins;q=["height","width","modes","events"];for(J=0;J<q.length;J++)delete D[q[J]];q="opaque";if(D.wmode)q=D.wmode;t(D,"components");t(D,"providers");if(typeof D["dock.position"]!="undefined")if(D["dock.position"].toString().toLowerCase()==
"false"){D.dock=D["dock.position"];delete D["dock.position"]}J=a.utils.getCookies();for(var A in J)if(typeof D[A]=="undefined")D[A]=J[A];if(a.utils.isIE()){A='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" bgcolor="#000000" width="100%" height="100%" id="'+b.id+'" name="'+b.id+'" tabindex=0"">';A+='<param name="movie" value="'+c.src+'">';A+='<param name="allowfullscreen" value="true">';A+='<param name="allowscriptaccess" value="always">';A+='<param name="seamlesstabbing" value="true">';
A+='<param name="wmode" value="'+q+'">';A+='<param name="flashvars" value="'+G(D)+'">';A+="</object>";a.utils.setOuterHTML(b,A);D=document.getElementById(b.id)}else{A=document.createElement("object");A.setAttribute("type","application/x-shockwave-flash");A.setAttribute("data",c.src);A.setAttribute("width","100%");A.setAttribute("height","100%");A.setAttribute("bgcolor","#000000");A.setAttribute("id",b.id);A.setAttribute("name",b.id);A.setAttribute("tabindex",0);r(A,"allowfullscreen","true");r(A,"allowscriptaccess",
"always");r(A,"seamlesstabbing","true");r(A,"wmode",q);r(A,"flashvars",G(D));b.parentNode.replaceChild(A,b);D=A}l.container=D;l.setPlayer(D,"flash")};this.supportsConfig=function(){if(a.utils.hasFlash())if(e){var q=a.utils.getFirstPlaylistItemFromConfig(e);if(typeof q.file=="undefined"&&typeof q.levels=="undefined")return true;else if(q.file)return flashCanPlay(q.file,q.provider);else if(q.levels&&q.levels.length)for(var D=0;D<q.levels.length;D++)if(q.levels[D].file&&flashCanPlay(q.levels[D].file,
q.provider))return true}else return true;return false};flashCanPlay=function(q,D){var J=["video","http","sound","image"];if(D&&J.toString().indexOf(D)<0)return true;q=a.utils.extension(q);if(!q)return true;if(a.utils.exists(a.utils.extensionmap[q])&&!a.utils.exists(a.utils.extensionmap[q].flash))return false;return true}}})(jwplayer);(function(a){a.embed.html5=function(b,c,e,g,l){function r(u,t,v){return function(){var G=document.getElementById(b.id+"_displayarea");v&&G.appendChild(t);u.resize(G.clientWidth,
G.clientHeight);t.left=G.style.left;t.top=G.style.top}}this.embed=function(){if(a.html5){g.setupPlugins(l,e,r);b.innerHTML="";for(var u=a.utils.extend({screencolor:"0x000000"},e),t=["plugins","modes","events"],v=0;v<t.length;v++)delete u[t[v]];if(u.levels&&!u.sources)u.sources=e.levels;if(u.skin&&u.skin.toLowerCase().indexOf(".zip")>0)u.skin=u.skin.replace(/\.zip/i,".xml");u=new (a.html5(b).setup)(u);l.container=document.getElementById(l.id);l.setPlayer(u,"html5")}else return null};this.supportsConfig=
function(){if(a.vid.canPlayType)if(e){var u=a.utils.getFirstPlaylistItemFromConfig(e);if(typeof u.file=="undefined"&&typeof u.levels=="undefined")return true;else if(u.file)return html5CanPlay(a.vid,u.file,u.provider,u.playlistfile);else if(u.levels&&u.levels.length)for(var t=0;t<u.levels.length;t++)if(u.levels[t].file&&html5CanPlay(a.vid,u.levels[t].file,u.provider,u.playlistfile))return true}else return true;return false};html5CanPlay=function(u,t,v,G){if(G)return false;if(v&&v=="youtube")return true;
if(v&&v!="video"&&v!="http"&&v!="sound")return false;if(navigator.userAgent.match(/BlackBerry/i)!==null)return false;t=a.utils.extension(t);if(!a.utils.exists(t)||!a.utils.exists(a.utils.extensionmap[t]))return true;if(!a.utils.exists(a.utils.extensionmap[t].html5))return false;if(a.utils.isLegacyAndroid()&&t.match(/m4v|mp4/))return true;return browserCanPlay(u,a.utils.extensionmap[t].html5)};browserCanPlay=function(u,t){if(!t)return true;return u.canPlayType(t)?true:t=="audio/mp3"&&navigator.userAgent.match(/safari/i)?
u.canPlayType("audio/mpeg"):false}}})(jwplayer);(function(a){a.embed.logo=function(b,c,e){function g(){l();u();t()}function l(){if(D.prefix){var A=a.version.split(/\W/).splice(0,2).join("/");if(D.prefix.indexOf(A)<0)D.prefix+=A+"/"}M=a.utils.extend({},D,b)}function r(){var A={border:"none",textDecoration:"none",position:"absolute",cursor:"pointer",zIndex:10};A.display=M.hide?"none":"block";var Q=M.position.toLowerCase().split("-");for(var j in Q)A[Q[j]]=M.margin;return A}function u(){J=document.createElement("img");
J.id=e+"_jwplayer_logo";J.style.display="none";J.onload=function(){_css(J,r());G()};if(M.file)J.src=M.file.indexOf("http://")===0?M.file:M.prefix+M.file}function t(){if(M.link){J.onmouseover=q;J.onmouseout=G;J.onclick=v}else this.mouseEnabled=false}function v(A){if(typeof A!="undefined"){A.preventDefault();A.stopPropagation()}M.link&&window.open(M.link,M.linktarget)}function G(){if(M.link)J.style.opacity=M.out}function q(){if(M.hide)J.style.opacity=M.over}var D={prefix:"http://l.longtailvideo.com/"+
c+"/",file:"",link:"",linktarget:"_top",margin:8,out:0.5,over:1,timeout:5,hide:false,position:"bottom-left"};_css=a.utils.css;var J,M;g();if(M.file)return J}})(jwplayer);(function(a){a.html5=function(b){this.setup=function(c){a.utils.extend(this,new a.html5.api(b,c));return this};return this}})(jwplayer);(function(a){var b=a.utils,c=b.css,e=b.isIOS();a.html5.view=function(g,l,r){function u(){function da(){if(B.skin.getComponentSettings("display")&&B.skin.getComponentSettings("display").backgroundcolor)return B.skin.getComponentSettings("display").backgroundcolor;
return parseInt("000000",16)}N=document.createElement("div");N.id=H.id;N.className=H.className;_videowrapper=document.createElement("div");_videowrapper.id=N.id+"_video_wrapper";H.id=N.id+"_video";c(N,{position:"relative",height:z.height,width:z.width,padding:0,backgroundColor:da(),zIndex:0});c(H,{width:"100%",height:"100%",top:0,left:0,zIndex:1,margin:"auto",display:"block"});c(_videowrapper,{overflow:"hidden",position:"absolute",top:0,left:0,bottom:0,right:0});b.wrap(H,N);b.wrap(H,_videowrapper);
O=document.createElement("div");O.id=N.id+"_displayarea";N.appendChild(O);_instreamArea=document.createElement("div");_instreamArea.id=N.id+"_instreamarea";c(_instreamArea,{overflow:"hidden",position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:100,background:"000000",display:"none"});N.appendChild(_instreamArea)}function t(){for(var da=0;da<z.plugins.order.length;da++){var ha=z.plugins.order[da];if(b.exists(z.plugins.object[ha].getDisplayElement)){z.plugins.object[ha].height=b.parseDimension(z.plugins.object[ha].getDisplayElement().style.height);
z.plugins.object[ha].width=b.parseDimension(z.plugins.object[ha].getDisplayElement().style.width);z.plugins.config[ha].currentPosition=z.plugins.config[ha].position}}q()}function v(){ia=z.fullscreen}function G(da){if(!ca){switch(da.newstate){case a.api.events.state.PLAYING:if(z.getMedia()&&z.getMedia().hasChrome())O.style.display="none";break;default:O.style.display="block";break}fa()}}function q(){var da=z.getMedia()?z.getMedia().getDisplayElement():null;if(b.exists(da)){if(ja!=da){ja&&ja.parentNode&&
ja.parentNode.replaceChild(da,ja);ja=da}for(da=0;da<z.plugins.order.length;da++){var ha=z.plugins.order[da];if(b.exists(z.plugins.object[ha].getDisplayElement))z.plugins.config[ha].currentPosition=z.plugins.config[ha].position}}J(z.width,z.height)}function D(da){switch(da.keyCode){case 27:B.jwGetFullscreen()&&B.jwSetFullscreen(false);break;case 32:B.jwGetState()!=a.api.events.state.IDLE&&B.jwGetState()!=a.api.events.state.PAUSED?B.jwPause():B.jwPlay();break}}function J(da,ha){if(N.style.display!=
"none"){var qa=[].concat(z.plugins.order);qa.reverse();aa=qa.length+2;if(ia&&w())try{if(z.fullscreen&&!z.getMedia().getDisplayElement().webkitDisplayingFullscreen)z.fullscreen=false}catch(T){}if(z.fullscreen)!w()&&!e&&M(j,qa,true);else{U=da;E=ha;U=typeof da=="string"&&da.indexOf("%")>0?b.getElementWidth(b.parentNode(N))*parseInt(da.replace("%"),"")/100:da;E=typeof ha=="string"&&ha.indexOf("%")>0?b.getElementHeight(b.parentNode(N))*parseInt(ha.replace("%"),"")/100:ha;da={top:0,bottom:0,left:0,right:0,
width:U,height:E,position:"absolute"};c(O,da);ha={};var Y;try{Y=z.plugins.object.display.getDisplayElement()}catch(oa){}if(Y){ha.width=b.parseDimension(Y.style.width);ha.height=b.parseDimension(Y.style.height)}Y=b.extend({},da,ha,{zIndex:_instreamArea.style.zIndex,display:_instreamArea.style.display});c(_instreamArea,Y);c(N,{height:E,width:U});qa=M(A,qa);if(qa.length>0){aa+=qa.length;Y=qa.indexOf("playlist");da=qa.indexOf("controlbar");if(Y>=0&&da>=0)qa[Y]=qa.splice(da,1,qa[Y])[0];M(Q,qa,true)}W=
b.getElementWidth(O);V=b.getElementHeight(O)}fa()}}function M(da,ha,qa){ga=0;for(var T=[],Y=0;Y<ha.length;Y++){var oa=ha[Y];if(b.exists(z.plugins.object[oa].getDisplayElement))if(z.plugins.config[oa].currentPosition!=a.html5.view.positions.NONE){var sa=da(oa,aa--);if(sa){var I=sa.width,X=sa.height;if(qa){delete sa.width;delete sa.height}c(z.plugins.object[oa].getDisplayElement(),sa);z.plugins.object[oa].resize(I,X)}else T.push(oa)}else c(z.plugins.object[oa].getDisplayElement(),{display:"none"})}return T}
function A(da,ha){if(b.exists(z.plugins.object[da].getDisplayElement))if(z.plugins.config[da].position&&p(z.plugins.config[da].position)){b.exists(z.plugins.object[da].getDisplayElement().parentNode)||N.appendChild(z.plugins.object[da].getDisplayElement());da=za(da);da.zIndex=ha;return da}return false}function Q(da,ha){b.exists(z.plugins.object[da].getDisplayElement().parentNode)||O.appendChild(z.plugins.object[da].getDisplayElement());return{position:"absolute",width:b.getElementWidth(O)-b.parseDimension(O.style.right),
height:b.getElementHeight(O)-b.parseDimension(O.style.bottom),zIndex:ha}}function j(da,ha){return{position:"fixed",width:z.width,height:z.height,zIndex:ha}}function p(da){return[a.html5.view.positions.TOP,a.html5.view.positions.RIGHT,a.html5.view.positions.BOTTOM,a.html5.view.positions.LEFT].toString().indexOf(da.toUpperCase())>-1}function w(){if(B.jwGetState()!=a.api.events.state.IDLE&&!P&&z.getMedia()&&z.getMedia().getDisplayElement()&&z.getMedia().getDisplayElement().webkitSupportsFullscreen&&
b.useNativeFullscreen())return true;return false}var B=g,H=l,z=r,N,U,E,O,aa,ja,P=false,ia=false,W,V,ca,ra;this.setup=function(){if(z&&z.getMedia())H=z.getMedia().getDisplayElement();u();t();B.jwAddEventListener(a.api.events.JWPLAYER_PLAYER_STATE,G);B.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_LOADED,q);B.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_BEFOREPLAY,v);B.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_META,function(){fa()});var da;if(b.exists(window.onresize))da=window.onresize;window.onresize=
function(ha){if(b.exists(da))try{da(ha)}catch(qa){}if(B.jwGetFullscreen()){if(!w()){ha=b.getBoundingClientRect(document.body);z.width=Math.abs(ha.left)+Math.abs(ha.right);z.height=window.innerHeight;J(z.width,z.height)}}else J(z.width,z.height)}};var ga,fa=this.resizeMedia=function(){O.style.position="absolute";var da=z.getMedia()?z.getMedia().getDisplayElement():ra;if(da)if(da&&da.tagName.toLowerCase()=="video")if(!da.videoWidth||!da.videoHeight){da.style.width=O.style.width;da.style.height=O.style.height}else{da.style.position=
"absolute";b.fadeTo(da,1,0.25);if(da.parentNode){da.parentNode.style.left=O.style.left;da.parentNode.style.top=O.style.top}if(z.fullscreen&&B.jwGetStretching()==a.utils.stretching.EXACTFIT&&!b.isMobile()){var ha=document.createElement("div");b.stretch(a.utils.stretching.UNIFORM,ha,b.getElementWidth(O),b.getElementHeight(O),W,V);b.stretch(a.utils.stretching.EXACTFIT,da,b.parseDimension(ha.style.width),b.parseDimension(ha.style.height),da.videoWidth?da.videoWidth:400,da.videoHeight?da.videoHeight:300);
c(da,{left:ha.style.left,top:ha.style.top})}else e||b.stretch(B.jwGetStretching(),da,b.getElementWidth(O),b.getElementHeight(O),da.videoWidth?da.videoWidth:400,da.videoHeight?da.videoHeight:300)}else(da=z.plugins.object.display.getDisplayElement())?z.getMedia().resize(b.parseDimension(da.style.width),b.parseDimension(da.style.height)):z.getMedia().resize(b.parseDimension(O.style.width),b.parseDimension(O.style.height))},za=this.getComponentPosition=function(da){var ha={position:"absolute",margin:0,
padding:0,top:null},qa=z.plugins.config[da].currentPosition.toLowerCase();switch(qa.toUpperCase()){case a.html5.view.positions.TOP:ha.top=b.parseDimension(O.style.top);ha.left=b.parseDimension(O.style.left);ha.width=b.getElementWidth(O)-b.parseDimension(O.style.left)-b.parseDimension(O.style.right);ha.height=z.plugins.object[da].height;O.style[qa]=b.parseDimension(O.style[qa])+z.plugins.object[da].height+"px";O.style.height=b.getElementHeight(O)-ha.height+"px";break;case a.html5.view.positions.RIGHT:ha.top=
b.parseDimension(O.style.top);ha.right=b.parseDimension(O.style.right);ha.width=z.plugins.object[da].width;ha.height=b.getElementHeight(O)-b.parseDimension(O.style.top)-b.parseDimension(O.style.bottom);O.style.width=b.getElementWidth(O)-ha.width+"px";break;case a.html5.view.positions.BOTTOM:ha.left=b.parseDimension(O.style.left);ha.width=b.getElementWidth(O)-b.parseDimension(O.style.left)-b.parseDimension(O.style.right);ha.height=z.plugins.object[da].height;ha.bottom=b.parseDimension(O.style.bottom+
ga);ga+=ha.height;O.style.height=b.getElementHeight(O)-ha.height+"px";break;case a.html5.view.positions.LEFT:ha.top=b.parseDimension(O.style.top);ha.left=b.parseDimension(O.style.left);ha.width=z.plugins.object[da].width;ha.height=b.getElementHeight(O)-b.parseDimension(O.style.top)-b.parseDimension(O.style.bottom);O.style[qa]=b.parseDimension(O.style[qa])+z.plugins.object[da].width+"px";O.style.width=b.getElementWidth(O)-ha.width+"px";break;default:break}return ha};this.resize=J;var ta,Ga,la;this.fullscreen=
function(da){if(!e){var ha;try{ha=z.getMedia().getDisplayElement()}catch(qa){}if(da){Ga=z.width;la=z.height}var T={position:"fixed",width:"100%",height:"100%",top:0,left:0,zIndex:2147483E3},Y={position:"relative",height:Ga,width:la,zIndex:0};if(w()&&ha&&ha.webkitSupportsFullscreen){if(da&&!ha.webkitDisplayingFullscreen)try{c(ha,T);b.transform(ha);ta=O.style.display;O.style.display="none";ha.webkitEnterFullscreen()}catch(oa){}else if(!da){c(ha,Y);fa();if(ha.webkitDisplayingFullscreen)try{ha.webkitExitFullscreen()}catch(sa){}O.style.display=
ta}P=false}else{if(da){document.onkeydown=D;clearInterval(void 0);da=b.getBoundingClientRect(document.body);z.width=Math.abs(da.left)+Math.abs(da.right);z.height=window.innerHeight;c(N,T);T.zIndex=1;z.getMedia()&&z.getMedia().getDisplayElement()&&c(z.getMedia().getDisplayElement(),T);T.zIndex=2;c(O,T);P=true}else{document.onkeydown="";z.width=U;z.height=E;c(N,Y);P=false}J(z.width,z.height)}}};this.setupInstream=function(da,ha){b.css(_instreamArea,{display:"block",position:"absolute"});O.style.display=
"none";_instreamArea.appendChild(da);ra=ha;ca=true};this.destroyInstream=function(){_instreamArea.style.display="none";_instreamArea.innerHTML="";O.style.display="block";ra=null;ca=false;J(z.width,z.height)}};a.html5.view.positions={TOP:"TOP",RIGHT:"RIGHT",BOTTOM:"BOTTOM",LEFT:"LEFT",OVER:"OVER",NONE:"NONE"}})(jwplayer);(function(a){var b={backgroundcolor:"",margin:10,font:"Arial,sans-serif",fontsize:10,fontcolor:parseInt("000000",16),fontstyle:"normal",fontweight:"bold",buttoncolor:parseInt("ffffff",
16),position:a.html5.view.positions.BOTTOM,idlehide:false,hideplaylistcontrols:false,forcenextprev:false,layout:{left:{position:"left",elements:[{name:"play",type:"button"},{name:"divider",type:"divider"},{name:"prev",type:"button"},{name:"divider",type:"divider"},{name:"next",type:"button"},{name:"divider",type:"divider"},{name:"elapsed",type:"text"}]},center:{position:"center",elements:[{name:"time",type:"slider"}]},right:{position:"right",elements:[{name:"duration",type:"text"},{name:"blank",type:"button"},
{name:"divider",type:"divider"},{name:"mute",type:"button"},{name:"volume",type:"slider"},{name:"divider",type:"divider"},{name:"fullscreen",type:"button"}]}}};_utils=a.utils;_css=_utils.css;_hide=function(c){_css(c,{display:"none"})};_show=function(c){_css(c,{display:"block"})};a.html5.controlbar=function(c,e){function g(){if(!Za)(Za=fa.skin.getSkinElement("controlbar","background"))||(Za={width:0,height:0,src:null});return Za}function l(){Ga=da=la=0;if(!Ba){var ea={height:g().height,backgroundColor:za.backgroundcolor};
ta=document.createElement("div");ta.id=fa.id+"_jwplayer_controlbar";_css(ta,ea)}ea=fa.skin.getSkinElement("controlbar","capLeft");var ua=fa.skin.getSkinElement("controlbar","capRight");ea&&j("capLeft","left",false,ta);D("background",ta,{position:"absolute",height:g().height,left:ea?ea.width:0,zIndex:0},"img");if(g().src)X.background.src=g().src;D("elements",ta,{position:"relative",height:g().height,zIndex:1});ua&&j("capRight","right",false,ta)}function r(){var ea=["timeSlider","volumeSlider","timeSliderRail",
"volumeSliderRail"];for(var ua in ea){var va=ea[ua];if(typeof X[va]!="undefined")Ha[va]=_utils.getBoundingClientRect(X[va])}}function u(ea){if(!cb){clearTimeout(bb);if(za.position==a.html5.view.positions.OVER||fa.jwGetFullscreen())switch(fa.jwGetState()){case a.api.events.state.PAUSED:case a.api.events.state.IDLE:if(ta&&ta.style.opacity<1&&(!za.idlehide||_utils.exists(ea))){m=false;setTimeout(function(){m||v()},100)}if(za.idlehide)bb=setTimeout(function(){t()},2E3);break;default:m=true;ea&&v();bb=
setTimeout(function(){t()},2E3);break}else v()}}function t(){if(!cb){hb();if(ta.style.opacity==1){_utils.cancelAnimation(ta);_utils.fadeTo(ta,0,0.1,1,0)}}}function v(){if(!cb){ub();if(ta.style.opacity==0){_utils.cancelAnimation(ta);_utils.fadeTo(ta,1,0.1,0,0)}}}function G(ea){return function(){if(mb&&Ua!=ea){Ua=ea;Lb.sendEvent(ea,{component:"controlbar",boundingRect:q()})}}}function q(){return za.position==a.html5.view.positions.OVER||fa.jwGetFullscreen()?_utils.getDimensions(ta):{x:0,y:0,width:0,
height:0}}function D(ea,ua,va,Fa){if(Ba)Fa=document.getElementById(ta.id+"_"+ea);else{Fa||(Fa="div");Fa=document.createElement(Fa);X[ea]=Fa;Fa.id=ta.id+"_"+ea;ua.appendChild(Fa)}_utils.exists(va)&&_css(Fa,va);return Fa}function J(){if(fa.jwGetHeight()<=40){za.layout=_utils.clone(za.layout);for(var ea=0;ea<za.layout.left.elements.length;ea++)za.layout.left.elements[ea].name=="fullscreen"&&za.layout.left.elements.splice(ea,1);for(ea=0;ea<za.layout.right.elements.length;ea++)za.layout.right.elements[ea].name==
"fullscreen"&&za.layout.right.elements.splice(ea,1);ia()}M(za.layout.left);M(za.layout.center);M(za.layout.right)}function M(ea,ua){var va=ea.position=="right"?"right":"left",Fa=_utils.extend([],ea.elements);_utils.exists(ua)&&Fa.reverse();ea=D(ea.position+"Group",X.elements,{"float":"left",styleFloat:"left",cssFloat:"left",height:"100%"});for(ua=0;ua<Fa.length;ua++)Q(Fa[ua],va,ea)}function A(){return Ga++}function Q(ea,ua,va){var Fa;if(!va)va=X.elements;if(ea.type=="divider")j("divider"+A(),ua,true,
va,undefined,ea.width,ea.element);else switch(ea.name){case "play":j("playButton",ua,false,va);j("pauseButton",ua,true,va);z("playButton","jwPlay");z("pauseButton","jwPause");break;case "prev":j("prevButton",ua,true,va);z("prevButton","jwPlaylistPrev");break;case "stop":j("stopButton",ua,true,va);z("stopButton","jwStop");break;case "next":j("nextButton",ua,true,va);z("nextButton","jwPlaylistNext");break;case "elapsed":j("elapsedText",ua,true,va,null,null,fa.skin.getSkinElement("controlbar","elapsedBackground"));
break;case "time":!_utils.exists(fa.skin.getSkinElement("controlbar","timeSliderCapLeft"))||fa.skin.getSkinElement("controlbar","timeSliderCapLeft");!_utils.exists(fa.skin.getSkinElement("controlbar","timeSliderCapRight"))||fa.skin.getSkinElement("controlbar","timeSliderCapRight");ea={height:g().height,position:"relative","float":"left",styleFloat:"left",cssFloat:"left"};va=D("timeSlider",va,ea);j("timeSliderCapLeft",ua,true,va,"relative");j("timeSliderRail",ua,false,va,"relative");j("timeSliderBuffer",
ua,false,va,"absolute");j("timeSliderProgress",ua,false,va,"absolute");j("timeSliderThumb",ua,false,va,"absolute");j("timeSliderCapRight",ua,true,va,"relative");N("time");break;case "fullscreen":j("fullscreenButton",ua,false,va);j("normalscreenButton",ua,true,va);z("fullscreenButton","jwSetFullscreen",true);z("normalscreenButton","jwSetFullscreen",false);break;case "volume":ea=!_utils.exists(fa.skin.getSkinElement("controlbar","volumeSliderCapLeft"))?0:fa.skin.getSkinElement("controlbar","volumeSliderCapLeft").width;
Fa=!_utils.exists(fa.skin.getSkinElement("controlbar","volumeSliderCapRight"))?0:fa.skin.getSkinElement("controlbar","volumeSliderCapRight").width;ea=fa.skin.getSkinElement("controlbar","volumeSliderRail").width+ea+Fa;ea={height:g().height,position:"relative",width:ea,"float":"left",styleFloat:"left",cssFloat:"left"};va=D("volumeSlider",va,ea);j("volumeSliderCapLeft",ua,false,va,"relative");j("volumeSliderRail",ua,false,va,"relative");j("volumeSliderProgress",ua,false,va,"absolute");j("volumeSliderThumb",
ua,false,va,"absolute");j("volumeSliderCapRight",ua,false,va,"relative");N("volume");break;case "mute":j("muteButton",ua,false,va);j("unmuteButton",ua,true,va);z("muteButton","jwSetMute",true);z("unmuteButton","jwSetMute",false);break;case "duration":j("durationText",ua,true,va,null,null,fa.skin.getSkinElement("controlbar","durationBackground"));break}}function j(ea,ua,va,Fa,La,Va,Mb){if(_utils.exists(fa.skin.getSkinElement("controlbar",ea))||ea.indexOf("Text")>0||ea.indexOf("divider")===0){La={height:"100%",
position:La?La:"relative",display:"block","float":"left",styleFloat:"left",cssFloat:"left"};if((ea.indexOf("next")===0||ea.indexOf("prev")===0)&&(fa.jwGetPlaylist().length<2||za.hideplaylistcontrols.toString()=="true"))if(za.forcenextprev.toString()!="true"){va=false;La.display="none"}var qb;if(ea.indexOf("Text")>0){ea.innerhtml="00:00";La.font=za.fontsize+"px/"+(g().height+1)+"px "+za.font;La.color=za.fontcolor;La.textAlign="center";La.fontWeight=za.fontweight;La.fontStyle=za.fontstyle;La.cursor=
"default";if(Mb){La.background="url("+Mb.src+") no-repeat center";La.backgroundSize="100% "+g().height+"px"}La.padding="0 5px"}else if(ea.indexOf("divider")===0)if(Va)isNaN(parseInt(Va))||(qb=parseInt(Va));else if(Mb){if(Va=fa.skin.getSkinElement("controlbar",Mb)){La.background="url("+Va.src+") repeat-x center left";qb=Va.width}}else{La.background="url("+fa.skin.getSkinElement("controlbar","divider").src+") repeat-x center left";qb=fa.skin.getSkinElement("controlbar","divider").width}else{La.background=
"url("+fa.skin.getSkinElement("controlbar",ea).src+") repeat-x center left";qb=fa.skin.getSkinElement("controlbar",ea).width}if(ua=="left"){if(va)la+=qb}else if(ua=="right")if(va)da+=qb;if(_utils.typeOf(Fa)=="undefined")Fa=X.elements;La.width=qb;if(Ba)_css(X[ea],La);else{var vb=D(ea,Fa,La);if(_utils.exists(fa.skin.getSkinElement("controlbar",ea+"Over"))){vb.onmouseover=function(){vb.style.backgroundImage=["url(",fa.skin.getSkinElement("controlbar",ea+"Over").src,")"].join("")};vb.onmouseout=function(){vb.style.backgroundImage=
["url(",fa.skin.getSkinElement("controlbar",ea).src,")"].join("")}}ea.indexOf("divider")==0&&vb.setAttribute("class","divider");vb.innerHTML="&nbsp;"}}}function p(){fa.jwAddEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,w);fa.jwAddEventListener(a.api.events.JWPLAYER_PLAYLIST_ITEM,B);fa.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_BUFFER,E);fa.jwAddEventListener(a.api.events.JWPLAYER_PLAYER_STATE,aa);fa.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_TIME,P);fa.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_MUTE,
O);fa.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_VOLUME,ca);fa.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_COMPLETE,ja)}function w(){if(!za.hideplaylistcontrols){if(fa.jwGetPlaylist().length>1||za.forcenextprev.toString()=="true"){_show(X.nextButton);_show(X.prevButton)}else{_hide(X.nextButton);_hide(X.prevButton)}V();H()}}function B(ea){Y=fa.jwGetPlaylist()[ea.index].duration;Pa=-1;P({id:fa.id,duration:Y,position:0});E({id:fa.id,bufferProgress:0})}function H(){P({id:fa.id,duration:fa.jwGetDuration(),
position:0});E({id:fa.id,bufferProgress:0});O({id:fa.id,mute:fa.jwGetMute()});aa({id:fa.id,newstate:a.api.events.state.IDLE});ca({id:fa.id,volume:fa.jwGetVolume()})}function z(ea,ua,va){if(!Ba)if(_utils.exists(fa.skin.getSkinElement("controlbar",ea))){ea=X[ea];if(_utils.exists(ea)){_css(ea,{cursor:"pointer"});ea.onmouseup=ua=="fullscreen"?function(Fa){Fa.stopPropagation();fa.jwSetFullscreen(!fa.jwGetFullscreen())}:function(Fa){Fa.stopPropagation();_utils.exists(va)?fa[ua](va):fa[ua]()}}}}function N(ea){if(!Ba){var ua=
X[ea+"Slider"];_css(X.elements,{cursor:"pointer"});_css(ua,{cursor:"pointer"});ua.onmousedown=function(){ha=ea};ua.onmouseup=function(va){va.stopPropagation();U(va.pageX)};ua.onmousemove=function(va){if(ha=="time"){qa=true;_css(X[ha+"SliderThumb"],{left:va.pageX-Ha[ea+"Slider"].left-window.pageXOffset})}}}}function U(ea){qa=false;if(ha=="time"){ea=ea-Ha.timeSliderRail.left+window.pageXOffset;ea=ea/Ha.timeSliderRail.width*Y;if(ea<0)ea=0;else if(ea>Y)ea=Y-3;if(fa.jwGetState()==a.api.events.state.PAUSED||
fa.jwGetState()==a.api.events.state.IDLE)fa.jwPlay();fa.jwSeek(ea)}else if(ha=="volume"){ea=ea-Ha.volumeSliderRail.left-window.pageXOffset;ea=Math.round(ea/Ha.volumeSliderRail.width*100);if(ea<10)ea=0;else if(ea>100)ea=100;fa.jwGetMute()&&fa.jwSetMute(false);fa.jwSetVolume(ea)}ha="none"}function E(ea){if(_utils.exists(ea.bufferPercent))oa=ea.bufferPercent;if(Ha.timeSliderRail){ea=fa.skin.getSkinElement("controlbar","timeSliderCapLeft");var ua=Ha.timeSliderRail.width;ua=isNaN(Math.round(ua*oa/100))?
0:Math.round(ua*oa/100);_css(X.timeSliderBuffer,{width:ua,left:ea?ea.width:0})}}function O(ea){if(ea.mute){_hide(X.muteButton);_show(X.unmuteButton);_hide(X.volumeSliderProgress)}else{_show(X.muteButton);_hide(X.unmuteButton);_show(X.volumeSliderProgress)}}function aa(ea){if(ea.newstate==a.api.events.state.BUFFERING||ea.newstate==a.api.events.state.PLAYING){_show(X.pauseButton);_hide(X.playButton)}else{_hide(X.pauseButton);_show(X.playButton)}u();if(ea.newstate==a.api.events.state.IDLE){_hide(X.timeSliderBuffer);
_hide(X.timeSliderProgress);_hide(X.timeSliderThumb);P({id:fa.id,duration:fa.jwGetDuration(),position:0})}else{_show(X.timeSliderBuffer);if(ea.newstate!=a.api.events.state.BUFFERING){_show(X.timeSliderProgress);_show(X.timeSliderThumb)}}}function ja(ea){E({bufferPercent:0});P(_utils.extend(ea,{position:0,duration:Y}))}function P(ea){if(_utils.exists(ea.position))T=ea.position;var ua=false;if(_utils.exists(ea.duration)&&ea.duration!=Y){Y=ea.duration;ua=true}ea=T===Y===0?0:T/Y;var va=Ha.timeSliderRail;
if(va){ea=isNaN(Math.round(va.width*ea))?0:Math.round(va.width*ea);va=fa.skin.getSkinElement("controlbar","timeSliderCapLeft");var Fa=ea+(va?va.width:0);if(X.timeSliderProgress){_css(X.timeSliderProgress,{width:ea,left:va?va.width:0});if(!qa)if(X.timeSliderThumb)X.timeSliderThumb.style.left=Fa+"px"}}if(X.durationText)X.durationText.innerHTML=_utils.timeFormat(Y);if(X.elapsedText){ea=_utils.timeFormat(T);X.elapsedText.innerHTML=ea;if(Pa!=ea.length){ua=true;Pa=ea.length}}ua&&V()}function ia(){for(var ea=
X.elements.childNodes,ua,va,Fa=0;Fa<ea.length;Fa++){var La=ea[Fa].childNodes;for(var Va in La)if(!isNaN(parseInt(Va,10))){if(La[Va].id.indexOf(ta.id+"_divider")===0&&va&&va.id.indexOf(ta.id+"_divider")===0&&La[Va].style.backgroundImage==va.style.backgroundImage)La[Va].style.display="none";else if(La[Va].id.indexOf(ta.id+"_divider")===0&&ua&&ua.style.display!="none")La[Va].style.display="block";if(La[Va].style.display!="none")va=La[Va];ua=La[Va]}}}function W(){if(fa.jwGetFullscreen()){_show(X.normalscreenButton);
_hide(X.fullscreenButton)}else{_hide(X.normalscreenButton);_show(X.fullscreenButton)}if(fa.jwGetState()==a.api.events.state.BUFFERING||fa.jwGetState()==a.api.events.state.PLAYING){_show(X.pauseButton);_hide(X.playButton)}else{_hide(X.pauseButton);_show(X.playButton)}if(fa.jwGetMute()==true){_hide(X.muteButton);_show(X.unmuteButton);_hide(X.volumeSliderProgress)}else{_show(X.muteButton);_hide(X.unmuteButton);_show(X.volumeSliderProgress)}}function V(){ia();W();var ea={width:sa},ua={"float":"left",
styleFloat:"left",cssFloat:"left"};if(za.position==a.html5.view.positions.OVER||fa.jwGetFullscreen()){ea.left=za.margin;ea.width-=2*za.margin;ea.top=I-g().height-za.margin;ea.height=g().height}var va=fa.skin.getSkinElement("controlbar","capLeft"),Fa=fa.skin.getSkinElement("controlbar","capRight");ua.width=ea.width-(va?va.width:0)-(Fa?Fa.width:0);va=_utils.getBoundingClientRect(X.leftGroup).width;Fa=_utils.getBoundingClientRect(X.rightGroup).width;Fa=va=ua.width-va-Fa-1;var La=fa.skin.getSkinElement("controlbar",
"timeSliderCapLeft"),Va=fa.skin.getSkinElement("controlbar","timeSliderCapRight");if(_utils.exists(La))Fa-=La.width;if(_utils.exists(Va))Fa-=Va.width;X.timeSlider.style.width=va+"px";X.timeSliderRail.style.width=Fa+"px";_css(ta,ea);_css(X.elements,ua);_css(X.background,ua);r();return ea}function ca(ea){if(_utils.exists(X.volumeSliderRail)){var ua=isNaN(ea.volume/100)?1:ea.volume/100;ea=_utils.parseDimension(X.volumeSliderRail.style.width);ua=isNaN(Math.round(ea*ua))?0:Math.round(ea*ua);_utils.parseDimension(X.volumeSliderRail.style.right);
var va=!_utils.exists(fa.skin.getSkinElement("controlbar","volumeSliderCapLeft"))?0:fa.skin.getSkinElement("controlbar","volumeSliderCapLeft").width;_css(X.volumeSliderProgress,{width:ua,left:va});if(X.volumeSliderThumb){ua=ua-Math.round(_utils.parseDimension(X.volumeSliderThumb.style.width)/2);ua=Math.min(Math.max(ua,0),ea-_utils.parseDimension(X.volumeSliderThumb.style.width));_css(X.volumeSliderThumb,{left:ua})}_utils.exists(X.volumeSliderCapLeft)&&_css(X.volumeSliderCapLeft,{left:0})}}function ra(){try{var ea=
fa.id.indexOf("_instream")>0?fa.id.replace("_instream",""):fa.id;tb=document.getElementById(ea);tb.addEventListener("mousemove",u)}catch(ua){_utils.log("Could not add mouse listeners to controlbar: "+ua)}}function ga(){l();J();r();Ba=true;p();za.idlehide=za.idlehide.toString().toLowerCase()=="true";if(za.position==a.html5.view.positions.OVER&&za.idlehide){ta.style.opacity=0;mb=true}else{ta.style.opacity=1;setTimeout(function(){mb=true;ub()},1)}ra();H()}window.controlbar=this;var fa=c,za=_utils.extend({},
b,fa.skin.getComponentSettings("controlbar"),e);if(!(za.position==a.html5.view.positions.NONE||typeof a.html5.view.positions[za.position]=="undefined")){if(_utils.mapLength(fa.skin.getComponentLayout("controlbar"))>0)za.layout=fa.skin.getComponentLayout("controlbar");var ta,Ga,la,da,ha="none",qa,T,Y,oa,sa,I,X={},Ba=false,Ha={},Pa=-1,Za,cb=false,bb,Ua,mb=false,pb=false,tb,Lb=new a.html5.eventdispatcher;_utils.extend(this,Lb);this.getDisplayElement=function(){return ta};this.resize=function(ea,ua){ra();
_utils.cancelAnimation(ta);sa=ea;I=ua;if(pb!=fa.jwGetFullscreen()){(pb=fa.jwGetFullscreen())||u();Ua=undefined}ea=V();P({id:fa.id,duration:Y,position:T});E({id:fa.id,bufferPercent:oa});return ea};this.show=function(){if(cb){cb=false;_show(ta);ub()}};this.hide=function(){if(!cb){cb=true;_hide(ta);hb()}};var m,ub=G(a.api.events.JWPLAYER_COMPONENT_SHOW),hb=G(a.api.events.JWPLAYER_COMPONENT_HIDE);ga();return this}}})(jwplayer);(function(a){var b=a.utils;a.html5.controller=function(c,e,g,l){function r(la){za?
ta.sendEvent(la.type,la):fa.push(la)}function u(la){if(!za){za=true;ta.sendEvent(a.api.events.JWPLAYER_READY,la);a.utils.exists(window.playerReady)&&playerReady(la);for(a.utils.exists(window[g.config.playerReady])&&window[g.config.playerReady](la);fa.length>0;){la=fa.shift();ta.sendEvent(la.type,la)}for(g.config.autostart&&!a.utils.isIOS()&&z();Ga.length>0;){la=Ga.shift();ja(la.method,la.arguments)}}}function t(){try{ga=t;if(!ca){ca=true;ta.sendEvent(a.api.events.JWPLAYER_MEDIA_BEFOREPLAY);ca=false;
if(ra){ra=false;ga=null;return}}Q(P.item);if(P.playlist[P.item].levels[0].file.length>0)if(W||P.state==a.api.events.state.IDLE){P.getMedia().load(P.playlist[P.item]);W=false}else P.state==a.api.events.state.PAUSED&&P.getMedia().play();return true}catch(la){ta.sendEvent(a.api.events.JWPLAYER_ERROR,la);ga=null}return false}function v(){try{if(P.playlist[P.item].levels[0].file.length>0)switch(P.state){case a.api.events.state.PLAYING:case a.api.events.state.BUFFERING:P.getMedia()&&P.getMedia().pause();
break;default:if(ca)ra=true}return true}catch(la){ta.sendEvent(a.api.events.JWPLAYER_ERROR,la)}return false}function G(la){try{if(P.playlist[P.item].levels[0].file.length>0){if(typeof la!="number")la=parseFloat(la);switch(P.state){case a.api.events.state.IDLE:if(V<0){V=P.playlist[P.item].start;P.playlist[P.item].start=la}ca||t();break;case a.api.events.state.PLAYING:case a.api.events.state.PAUSED:case a.api.events.state.BUFFERING:P.seek(la);break}}return true}catch(da){ta.sendEvent(a.api.events.JWPLAYER_ERROR,
da)}return false}function q(la){ga=null;b.exists(la)||(la=true);try{if((P.state!=a.api.events.state.IDLE||la)&&P.getMedia())P.getMedia().stop(la);if(ca)ra=true;return true}catch(da){ta.sendEvent(a.api.events.JWPLAYER_ERROR,da)}return false}function D(){try{if(P.playlist[P.item].levels[0].file.length>0)if(P.config.shuffle)Q(M());else P.item+1==P.playlist.length?Q(0):Q(P.item+1);if(P.state!=a.api.events.state.IDLE){var la=P.state;P.state=a.api.events.state.IDLE;ta.sendEvent(a.api.events.JWPLAYER_PLAYER_STATE,
{oldstate:la,newstate:a.api.events.state.IDLE})}t();return true}catch(da){ta.sendEvent(a.api.events.JWPLAYER_ERROR,da)}return false}function J(){try{if(P.playlist[P.item].levels[0].file.length>0)if(P.config.shuffle)Q(M());else P.item===0?Q(P.playlist.length-1):Q(P.item-1);if(P.state!=a.api.events.state.IDLE){var la=P.state;P.state=a.api.events.state.IDLE;ta.sendEvent(a.api.events.JWPLAYER_PLAYER_STATE,{oldstate:la,newstate:a.api.events.state.IDLE})}t();return true}catch(da){ta.sendEvent(a.api.events.JWPLAYER_ERROR,
da)}return false}function M(){var la=null;if(P.playlist.length>1)for(;!b.exists(la);){la=Math.floor(Math.random()*P.playlist.length);if(la==P.item)la=null}else la=0;return la}function A(la){if(!P.playlist||!P.playlist[la])return false;try{if(P.playlist[la].levels[0].file.length>0){if(P.state!==a.api.events.state.IDLE)P.playlist[P.item]&&P.playlist[P.item].provider==P.playlist[la].provider?q(false):q();Q(la);t()}return true}catch(da){ta.sendEvent(a.api.events.JWPLAYER_ERROR,da)}return false}function Q(la){if(P.playlist[la]){P.setActiveMediaProvider(P.playlist[la]);
if(P.item!=la){P.item=la;W=true;ta.sendEvent(a.api.events.JWPLAYER_PLAYLIST_ITEM,{index:la})}}}function j(la){try{Q(P.item);var da=P.getMedia();switch(typeof la){case "number":da.volume(la);break;case "string":da.volume(parseInt(la,10));break}P.setVolume(la);return true}catch(ha){ta.sendEvent(a.api.events.JWPLAYER_ERROR,ha)}return false}function p(la){try{Q(P.item);var da=P.getMedia();if(typeof la=="undefined"){da.mute(!P.mute);P.setMute(!P.mute)}else if(la.toString().toLowerCase()=="true"){da.mute(true);
P.setMute(true)}else{da.mute(false);P.setMute(false)}return true}catch(ha){ta.sendEvent(a.api.events.JWPLAYER_ERROR,ha)}return false}function w(la,da){try{P.width=la;P.height=da;ia.resize(la,da);ta.sendEvent(a.api.events.JWPLAYER_RESIZE,{width:P.width,height:P.height});return true}catch(ha){ta.sendEvent(a.api.events.JWPLAYER_ERROR,ha)}return false}function B(la,da){try{if(typeof la=="undefined")la=!P.fullscreen;if(typeof da=="undefined")da=true;if(la!=P.fullscreen){P.fullscreen=la.toString().toLowerCase()==
"true";ia.fullscreen(P.fullscreen);da&&ta.sendEvent(a.api.events.JWPLAYER_FULLSCREEN,{fullscreen:P.fullscreen});ta.sendEvent(a.api.events.JWPLAYER_RESIZE,{width:P.width,height:P.height})}return true}catch(ha){ta.sendEvent(a.api.events.JWPLAYER_ERROR,ha)}return false}function H(la){try{q();if(ca)ra=false;P.loadPlaylist(la);if(P.playlist[P.item].provider){Q(P.item);P.config.autostart.toString().toLowerCase()=="true"&&!b.isIOS()&&!ca&&t();return true}else return false}catch(da){ta.sendEvent(a.api.events.JWPLAYER_ERROR,
da)}return false}function z(){if(!b.isIOS()){Q(P.item);P.config.autostart.toString().toLowerCase()=="true"&&!b.isIOS()&&t()}}function N(la){B(la.fullscreen,false)}function U(){try{return P.getMedia().detachMedia()}catch(la){return null}}function E(){try{P.getMedia().attachMedia();typeof ga=="function"&&ga()}catch(la){return null}}function O(){if(P.state==a.api.events.state.IDLE){ga=O;switch(P.config.repeat.toUpperCase()){case a.html5.controller.repeatoptions.SINGLE:t();break;case a.html5.controller.repeatoptions.ALWAYS:P.item==
P.playlist.length-1&&!P.config.shuffle?A(0):D();break;case a.html5.controller.repeatoptions.LIST:if(P.item==P.playlist.length-1&&!P.config.shuffle){q();Q(0)}else D();break;default:q();break}}}function aa(la){return function(){za?ja(la,arguments):Ga.push({method:la,arguments:arguments})}}function ja(la,da){var ha=[];for(i=0;i<da.length;i++)ha.push(da[i]);la.apply(this,ha)}var P=g,ia=l,W=true,V=-1,ca=false,ra=false,ga,fa=[],za=false;c=b.exists(P.config.debug)&&P.config.debug.toString().toLowerCase()==
"console";var ta=new a.html5.eventdispatcher(e.id,c);b.extend(this,ta);P.addGlobalListener(r);P.addEventListener(a.api.events.JWPLAYER_MEDIA_BUFFER_FULL,function(){P.getMedia().play()});P.addEventListener(a.api.events.JWPLAYER_MEDIA_TIME,function(la){if(la.position>=P.playlist[P.item].start&&V>=0){P.playlist[P.item].start=V;V=-1}});P.addEventListener(a.api.events.JWPLAYER_MEDIA_COMPLETE,function(){setTimeout(O,25)});P.addEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,z);P.addEventListener(a.api.events.JWPLAYER_FULLSCREEN,
N);a.html5.controller.repeatoptions={LIST:"LIST",ALWAYS:"ALWAYS",SINGLE:"SINGLE",NONE:"NONE"};var Ga=[];this.play=aa(t);this.pause=aa(v);this.seek=aa(G);this.stop=aa(q);this.next=aa(D);this.prev=aa(J);this.item=aa(A);this.setVolume=aa(j);this.setMute=aa(p);this.resize=aa(w);this.setFullscreen=aa(B);this.load=aa(H);this.playerReady=u;this.detachMedia=U;this.attachMedia=E;this.beforePlay=function(){return ca};this.destroy=function(){P.getMedia()&&P.getMedia().destroy()}}})(jwplayer);(function(a){a.html5.defaultSkin=
function(){this.text='<?xml version="1.0" ?><skin author="LongTail Video" name="Five" version="1.1"><components><component name="controlbar"><settings><setting name="margin" value="20"/><setting name="fontsize" value="11"/><setting name="fontcolor" value="0x000000"/></settings><layout><group position="left"><button name="play"/><divider name="divider"/><button name="prev"/><divider name="divider"/><button name="next"/><divider name="divider"/><text name="elapsed"/></group><group position="center"><slider name="time"/></group><group position="right"><text name="duration"/><divider name="divider"/><button name="blank"/><divider name="divider"/><button name="mute"/><slider name="volume"/><divider name="divider"/><button name="fullscreen"/></group></layout><elements><element name="background" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAIAAABvFaqvAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAElJREFUOI3t1LERACAMQlFgGvcfxNIhHMK4gsUvUviOmgtNsiAZkBSEKxKEnCYkkQrJn/YwbUNiSDDYRZaQRDaShv+oX9GBZEIuK+8hXVLs+/YAAAAASUVORK5CYII="/><element name="blankButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAYCAYAAAAyJzegAAAAFElEQVQYV2P8//8/AzpgHBUc7oIAGZdH0RjKN8EAAAAASUVORK5CYII="/><element name="capLeft" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAYCAYAAAA7zJfaAAAAQElEQVQIWz3LsRGAMADDQJ0XB5bMINABZ9GENGrszxhjT2WLSqxEJG2JQrTMdV2q5LpOAvyRaVmsi7WdeZ/7+AAaOTq7BVrfOQAAAABJRU5ErkJggg=="/><element name="capRight" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAYCAYAAAA7zJfaAAAAQElEQVQIWz3LsRGAMADDQJ0XB5bMINABZ9GENGrszxhjT2WLSqxEJG2JQrTMdV2q5LpOAvyRaVmsi7WdeZ/7+AAaOTq7BVrfOQAAAABJRU5ErkJggg=="/><element name="divider" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAYCAIAAAC0rgCNAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAADhJREFUCB0FwcENgEAAw7Aq+893g8APUILNOQcbFRktVGqUVFRkWNz3xTa2sUaLNUosKlRUvvf5AdbWOTtzmzyWAAAAAElFTkSuQmCC"/><element name="playButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAYCAYAAAAVibZIAAAANUlEQVR42u2RsQkAAAjD/NTTPaW6dXLrINJA1kBpGPMAjDWmOgp1HFQXx+b1KOefO4oxY57R73YnVYCQUCQAAAAASUVORK5CYII="/><element name="pauseButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAYCAYAAAAVibZIAAAAIUlEQVQ4jWNgGAWjYOiD/0gYG3/U0FFDB4Oho2AUDAYAAEwiL9HrpdMVAAAAAElFTkSuQmCC"/><element name="prevButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAYCAYAAAAVibZIAAAAQklEQVQ4y2NgGAWjYOiD/1AMA/JAfB5NjCJD/YH4PRaLyDa0H4lNNUP/DxlD59PCUBCIp3ZEwYA+NZLUKBgFgwEAAN+HLX9sB8u8AAAAAElFTkSuQmCC"/><element name="nextButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAYCAYAAAAVibZIAAAAQElEQVQ4y2NgGAWjYOiD/0B8Hojl0cT+U2ooCL8HYn9qGwrD/bQw9P+QMXQ+tSMqnpoRBUpS+tRMUqNgFAwGAADxZy1/mHvFnAAAAABJRU5ErkJggg=="/><element name="timeSliderRail" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAOElEQVRIDe3BwQkAIRADwAhhw/nU/kWwUK+KPITMABFh19Y+F0acY8CJvX9wYpXgRElwolSIiMf9ZWEDhtwurFsAAAAASUVORK5CYII="/><element name="timeSliderBuffer" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAN0lEQVRIDe3BwQkAMQwDMBcc55mRe9zi7RR+FCwBEWG39vcfGHFm4MTuhhMlwYlVBSdKhYh43AW/LQMKm1spzwAAAABJRU5ErkJggg=="/><element name="timeSliderProgress" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAIElEQVRIiWNgGAWjYBTQBfynMR61YCRYMApGwSigMQAAiVWPcbq6UkIAAAAASUVORK5CYII="/><element name="timeSliderThumb" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAYCAYAAAA/OUfnAAAAO0lEQVQYlWP4//8/Awwz0JgDBP/BeN6Cxf/hnI2btiI4u/fsQ3AOHjqK4Jw4eQbBOX/hEoKDYjSd/AMA4cS4mfLsorgAAAAASUVORK5CYII="/><element name="muteButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAYCAYAAADKx8xXAAAAJklEQVQ4y2NgGAUjDcwH4v/kaPxPikZkxcNVI9mBQ5XoGAWDFwAAsKAXKQQmfbUAAAAASUVORK5CYII="/><element name="unmuteButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAYCAYAAADKx8xXAAAAMklEQVQ4y2NgGAWDHPyntub5xBr6Hwv/Pzk2/yfVG/8psRFE25Oq8T+tQnsIaB4FVAcAi2YVysVY52AAAAAASUVORK5CYII="/><element name="volumeSliderRail" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYAgMAAACdGdVrAAAACVBMVEUAAACmpqampqbBXAu8AAAAAnRSTlMAgJsrThgAAAArSURBVAhbY2AgErBAyA4I2QEhOyBkB4TsYOhAoaCCUCUwDTDtMMNgRuMHAFB5FoGH5T0UAAAAAElFTkSuQmCC"/><element name="volumeSliderProgress" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYAgMAAACdGdVrAAAACVBMVEUAAAAAAAAAAACDY+nAAAAAAnRSTlMAgJsrThgAAAArSURBVAhbY2AgErBAyA4I2QEhOyBkB4TsYOhAoaCCUCUwDTDtMMNgRuMHAFB5FoGH5T0UAAAAAElFTkSuQmCC"/><element name="volumeSliderCapRight" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAYCAYAAAAyJzegAAAAFElEQVQYV2P8//8/AzpgHBUc7oIAGZdH0RjKN8EAAAAASUVORK5CYII="/><element name="fullscreenButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAQklEQVRIiWNgGAWjYMiD/0iYFDmSLbDHImdPLQtgBpEiR7Zl2NijAA5oEkT/0Whi5UiyAJ8BVMsHNMtoo2AUDAIAAGdcIN3IDNXoAAAAAElFTkSuQmCC"/><element name="normalscreenButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAP0lEQVRIx2NgGAWjYMiD/1RSQ5QB/wmIUWzJfzx8qhj+n4DYCAY0DyJ7PBbYU8sHMEvwiZFtODXUjIJRMJgBACpWIN2ZxdPTAAAAAElFTkSuQmCC"/></elements></component><component name="display"><elements><element name="background" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyAQMAAAAk8RryAAAABlBMVEUAAAAAAAClZ7nPAAAAAnRSTlOZpuml+rYAAAASSURBVBhXY2AYJuA/GBwY6jQAyDyoK8QcL4QAAAAASUVORK5CYII="/><element name="playIcon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAiUlEQVR42u3XSw2AMBREURwgAQlIQAISKgUpSEFKJeCg5b0E0kWBTVcD9ySTsL0Jn9IBAAAA+K2UUrBlW/Rr5ZDoIeeuoFkxJD9ss03aIXXQqB9SttoG7ZA6qNcOKdttiwcJh9RB+iFl4SshkRBuLR72+9cvH0SOKI2HRo7x/Fi1/uoCAAAAwLsD8ki99IlO2dQAAAAASUVORK5CYII="/><element name="muteIcon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAVUlEQVR42u3WMQrAIAxAUW/g/SdvGmvpoOBeSHgPsjj5QTANAACARCJilIhYM0tEvJM+Ik3Id9E957kQIb+F3OdCPC0hPkQriqWx9hp/x/QGAABQyAPLB22VGrpLDgAAAABJRU5ErkJggg=="/><element name="errorIcon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAA/0lEQVR42u2U0QmEMBAF7cASLMESUoIlpARLSCkpwRJSgiWkhOvAXD4WsgRkyaG5DbyB+Yvg8KITAAAAAAAYk+u61mwk15EjPtlEfihmqIiZR1Qx80ghjgdUuiHXGHSVsoag0x6x8DUoyjD5KovmEJ9NTDMRPIT0mtdIUkjlonuNohO+Ha99DTmkuGgKCTcvebAzx82ZoCWC3/3aIMWSRucaxcjORSFY4xpFdjYJGp1rFGcyCYZ/RVh6AUnfcNZ2zih3/mGj1jVCdiNDwyrq1rA/xMdeEXvDVdnYc1vDc3uPkDObXrlaxbNHSOohQhr/WOeLEWfWTgAAAAAAADzNF9sHJ7PJ57MlAAAAAElFTkSuQmCC"/><element name="bufferIcon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAACBklEQVR42u3Zv0sCYRzH8USTzOsHHEWGkC1HgaDgkktGDjUYtDQ01RDSljQ1BLU02+rk1NTm2NLq4Nx/0L/h9fnCd3j4cnZe1/U8xiO8h3uurufF0/3COd/3/0UWYiEWYiEWYiGJQ+J8xuPxKhXjEMZANinjIZhkGuVRNioE4wVURo4JkHm0xKWmhRAc1bh1EyCUw5BcBIjHiApKa4CErko6DEJwuRo6IRKzyJD8FJAyI3Zp2zRImiBcRhlfo5RtlxCcE3CcDNpGrhYIT2IhAJKilO0VRmzJ32fAMTpBTS0QMfGwlcuKMRftE0DJ0wCJdcOsCkBdXP3Mh9CEFUBTPS9mDZJBG6io4aqVzMdCokCw9H3kT6j/C/9iDdSeUMNC7DkyyxAs/Rk6Qss8FPWRZgdVtUH4DjxEn1zxh+/zj1wHlf4MQhNGrwqA6sY40U8JonRJwEQh+AO3AvCG6gHv4U7IY4krxkroWoAOkoQMGfCBrgIm+YBGqPENpIJ66CJg3x66Y0gnSUidAEEnNr9jjLiWMn5DiWP0OC/oAsCgkq43xBdGDMQr7YASP/vEkHvdl1+JOCcEV5sC4hGEOzTlPuKgd0b0xD4JkRcOgnRRTjdErkYhAsQVq6IdUuPJtmk7BCL3t/h88cx91pKQkI/pkDx6pmYTIjEoxiHsN1YWYiEWYiEWknhflZ5IErA5nr8AAAAASUVORK5CYII="/></elements></component><component name="dock"><settings><setting name="fontcolor" value="0xffffff"/></settings><elements><element name="button" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyAQMAAAAk8RryAAAABlBMVEUAAAAAAAClZ7nPAAAAAnRSTlOZpuml+rYAAAASSURBVBhXY2AYJuA/GBwY6jQAyDyoK8QcL4QAAAAASUVORK5CYII="/></elements></component><component name="playlist"><settings><setting name="backgroundcolor" value="0xe8e8e8"/></settings><elements><element name="item" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAIAAAC1nk4lAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHBJREFUaN7t2MENwCAMBEEe9N8wSKYC/D8YV7CyJoRkVtVImxkZPQInMxoP0XiIxkM0HsGbjjSNBx544IEHHnjggUe/6UQeey0PIh7XTftGxKPj4eXCtLsHHh+ZxkO0Iw8PR55Ni8ZD9Hu/EAoP0dc5RRg9qeRjVF8AAAAASUVORK5CYII="/><element name="sliderCapTop" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAHCAYAAADnCQYGAAAAFUlEQVQokWP8//8/A7UB46ihI9hQAKt6FPPXhVGHAAAAAElFTkSuQmCC"/><element name="sliderRail" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAUCAYAAABiS3YzAAAAKElEQVQ4y2P4//8/Az68bNmy/+iYkB6GUUNHDR01dNTQUUNHDaXcUABUDOKhcxnsSwAAAABJRU5ErkJggg=="/><element name="sliderThumb" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAUCAYAAABiS3YzAAAAJUlEQVQ4T2P4//8/Ay4MBP9xYbz6Rg0dNXTU0FFDRw0dNZRyQwHH4NBa7GJsXAAAAABJRU5ErkJggg=="/><element name="sliderCapBottom" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAHCAYAAADnCQYGAAAAFUlEQVQokWP8//8/A7UB46ihI9hQAKt6FPPXhVGHAAAAAElFTkSuQmCC"/></elements></component></components></skin>';
this.xml=null;if(window.DOMParser){parser=new DOMParser;this.xml=parser.parseFromString(this.text,"text/xml")}else{this.xml=new ActiveXObject("Microsoft.XMLDOM");this.xml.async="false";this.xml.loadXML(this.text)}return this}})(jwplayer);(function(a){_utils=a.utils;_css=_utils.css;_hide=function(b){_css(b,{display:"none"})};_show=function(b){_css(b,{display:"block"})};a.html5.display=function(b,c){function e(){z.display=r("div","display");z.display_text=r("div","display_text");z.display.appendChild(z.display_text);
z.display_image=r("img","display_image");z.display_image.onerror=function(){_hide(z.display_image)};z.display_image.onload=g;z.display_icon=r("div","display_icon");z.display_iconBackground=r("div","display_iconBackground");z.display.appendChild(z.display_image);z.display_iconBackground.appendChild(z.display_icon);z.display.appendChild(z.display_iconBackground);u();setTimeout(function(){la=true;B.icons.toString()=="true"&&oa()},1)}function g(){E=z.display_image.naturalWidth;O=z.display_image.naturalHeight;
l();if(H.jwGetState()==a.api.events.state.IDLE||H.jwGetPlaylist()[H.jwGetPlaylistIndex()].provider=="sound"){_css(z.display_image,{display:"block",opacity:0});_utils.fadeTo(z.display_image,1,0.1)}fa=false}function l(){if(H.jwGetFullscreen()&&H.jwGetStretching()==a.utils.stretching.EXACTFIT){var I=document.createElement("div");_utils.stretch(a.utils.stretching.UNIFORM,I,N,U,ha,qa);_utils.stretch(a.utils.stretching.EXACTFIT,z.display_image,_utils.parseDimension(I.style.width),_utils.parseDimension(I.style.height),
E,O);_css(z.display_image,{left:I.style.left,top:I.style.top})}else _utils.stretch(H.jwGetStretching(),z.display_image,N,U,E,O)}function r(I,X){I=document.createElement(I);I.id=H.id+"_jwplayer_"+X;_css(I,Y[X].style);return I}function u(){for(var I in z)if(_utils.exists(Y[I].click))z[I].onclick=Y[I].click}function t(I){if(typeof I.preventDefault!="undefined")I.preventDefault();else I.returnValue=false;if(typeof da=="function")da(I);else H.jwGetState()!=a.api.events.state.PLAYING?H.jwPlay():H.jwPause()}
function v(I){if(P)G();else{z.display_icon.style.backgroundImage=["url(",H.skin.getSkinElement("display",I).src,")"].join("");_css(z.display_icon,{width:H.skin.getSkinElement("display",I).width,height:H.skin.getSkinElement("display",I).height,top:(H.skin.getSkinElement("display","background").height-H.skin.getSkinElement("display",I).height)/2,left:(H.skin.getSkinElement("display","background").width-H.skin.getSkinElement("display",I).width)/2});q();if(_utils.exists(H.skin.getSkinElement("display",
I+"Over"))){z.display_icon.onmouseover=function(){z.display_icon.style.backgroundImage=["url(",H.skin.getSkinElement("display",I+"Over").src,")"].join("")};z.display_icon.onmouseout=function(){z.display_icon.style.backgroundImage=["url(",H.skin.getSkinElement("display",I).src,")"].join("")}}else{z.display_icon.onmouseover=null;z.display_icon.onmouseout=null}}}function G(){if(B.icons.toString()=="true"){_hide(z.display_icon);_hide(z.display_iconBackground);sa()}}function q(){if(!Ga&&B.icons.toString()==
"true"){_show(z.display_icon);_show(z.display_iconBackground);oa()}}function D(I){P=true;G();z.display_text.innerHTML=I.message;_show(z.display_text);z.display_text.style.top=(U-_utils.getBoundingClientRect(z.display_text).height)/2+"px"}function J(){za=false;z.display_image.style.display="none"}function M(){ca=""}function A(I){if((I.type==a.api.events.JWPLAYER_PLAYER_STATE||I.type==a.api.events.JWPLAYER_PLAYLIST_ITEM)&&P){P=false;_hide(z.display_text)}I=H.jwGetState();if(I!=ca){ca=I;V>=0&&clearTimeout(V);
if(ra||H.jwGetState()==a.api.events.state.PLAYING||H.jwGetState()==a.api.events.state.PAUSED)j(H.jwGetState());else V=setTimeout(Q(H.jwGetState()),500)}}function Q(I){return function(){j(I)}}function j(I){if(_utils.exists(ja)){clearInterval(ja);ja=null;_utils.animations.rotate(z.display_icon,0)}switch(I){case a.api.events.state.BUFFERING:if(_utils.isIPod()){J();G()}else{H.jwGetPlaylist()[H.jwGetPlaylistIndex()].provider=="sound"&&p();aa=0;ja=setInterval(function(){aa+=ia;_utils.animations.rotate(z.display_icon,
aa%360)},W);v("bufferIcon");ra=true}break;case a.api.events.state.PAUSED:if(!_utils.isIPod()){H.jwGetPlaylist()[H.jwGetPlaylistIndex()].provider!="sound"&&_css(z.display_image,{background:"transparent no-repeat center center"});v("playIcon");ra=true}break;case a.api.events.state.IDLE:H.jwGetPlaylist()[H.jwGetPlaylistIndex()]&&H.jwGetPlaylist()[H.jwGetPlaylistIndex()].image?p():J();v("playIcon");ra=true;break;default:if(H.jwGetPlaylist()[H.jwGetPlaylistIndex()]&&H.jwGetPlaylist()[H.jwGetPlaylistIndex()].provider==
"sound")if(_utils.isIPod()){J();ra=false}else p();else{J();ra=false}H.jwGetMute()&&B.showmute?v("muteIcon"):G();break}V=-1}function p(){if(H.jwGetPlaylist()[H.jwGetPlaylistIndex()]){var I=H.jwGetPlaylist()[H.jwGetPlaylistIndex()].image;if(I)if(I!=ta){ta=I;fa=true;z.display_image.src=_utils.getAbsolutePath(I)}else if(!(fa||za)){za=true;z.display_image.style.opacity=0;z.display_image.style.display="block";_utils.fadeTo(z.display_image,1,0.1)}}}function w(I){return function(){if(la)if(!Ga&&ga!=I){ga=
I;T.sendEvent(I,{component:"display",boundingRect:_utils.getDimensions(z.display_iconBackground)})}}}var B=_utils.extend({},{icons:true,showmute:false},c),H=b,z={},N,U,E,O,aa,ja,P,ia=!_utils.exists(H.skin.getComponentSettings("display").bufferrotation)?15:parseInt(H.skin.getComponentSettings("display").bufferrotation,10),W=!_utils.exists(H.skin.getComponentSettings("display").bufferinterval)?100:parseInt(H.skin.getComponentSettings("display").bufferinterval,10),V=-1,ca=a.api.events.state.IDLE,ra=
true,ga,fa=false,za=true,ta="",Ga=false,la=false,da,ha,qa,T=new a.html5.eventdispatcher;_utils.extend(this,T);var Y={display:{style:{cursor:"pointer",top:0,left:0,overflow:"hidden"},click:t},display_icon:{style:{cursor:"pointer",position:"absolute",top:(H.skin.getSkinElement("display","background").height-H.skin.getSkinElement("display","playIcon").height)/2,left:(H.skin.getSkinElement("display","background").width-H.skin.getSkinElement("display","playIcon").width)/2,border:0,margin:0,padding:0,zIndex:3,
display:"none"}},display_iconBackground:{style:{cursor:"pointer",position:"absolute",top:(U-H.skin.getSkinElement("display","background").height)/2,left:(N-H.skin.getSkinElement("display","background").width)/2,border:0,backgroundImage:["url(",H.skin.getSkinElement("display","background").src,")"].join(""),width:H.skin.getSkinElement("display","background").width,height:H.skin.getSkinElement("display","background").height,margin:0,padding:0,zIndex:2,display:"none"}},display_image:{style:{display:"none",
width:N,height:U,position:"absolute",cursor:"pointer",left:0,top:0,margin:0,padding:0,textDecoration:"none",zIndex:1}},display_text:{style:{zIndex:4,position:"relative",opacity:0.8,backgroundColor:parseInt("000000",16),color:parseInt("ffffff",16),textAlign:"center",fontFamily:"Arial,sans-serif",padding:"0 5px",fontSize:14}}};H.jwAddEventListener(a.api.events.JWPLAYER_PLAYER_STATE,A);H.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_MUTE,A);H.jwAddEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,
M);H.jwAddEventListener(a.api.events.JWPLAYER_PLAYLIST_ITEM,A);H.jwAddEventListener(a.api.events.JWPLAYER_ERROR,D);e();this.getDisplayElement=function(){return z.display};this.resize=function(I,X){if(!(H.jwGetFullscreen()&&_utils.isMobile())){_css(z.display,{width:I,height:X});_css(z.display_text,{width:I-10,top:(X-_utils.getBoundingClientRect(z.display_text).height)/2});_css(z.display_iconBackground,{top:(X-H.skin.getSkinElement("display","background").height)/2,left:(I-H.skin.getSkinElement("display",
"background").width)/2});if(N!=I||U!=X){N=I;U=X;ga=undefined;oa()}if(!H.jwGetFullscreen()){ha=I;qa=X}l();A({})}};this.show=function(){if(Ga){Ga=false;j(H.jwGetState())}};this.hide=function(){if(!Ga){G();Ga=true}};var oa=w(a.api.events.JWPLAYER_COMPONENT_SHOW),sa=w(a.api.events.JWPLAYER_COMPONENT_HIDE);this.setAlternateClickHandler=function(I){da=I};this.revertAlternateClickHandler=function(){da=undefined};return this}})(jwplayer);(function(a){var b=a.utils,c=b.css;a.html5.dock=function(e,g){function l(){return{align:a.html5.view.positions.RIGHT}}
function r(W){return"url("+W+") no-repeat center center"}function u(W,V){J();if(Q.length>0){var ca=10,ra=-1,ga=e.skin.getSkinElement("dock","button").height,fa=e.skin.getSkinElement("dock","button").width,za=W-fa-10,ta,Ga;if(M.align==a.html5.view.positions.LEFT){ra=1;za=10}for(var la=0;la<Q.length;la++){var da=Math.floor(ca/V);if(ca+ga+10>(da+1)*V){ca=(da+1)*V+10;da=Math.floor(ca/V)}var ha=A[Q[la]].div;ha.style.top=ca%V+"px";ha.style.left=za+(e.skin.getSkinElement("dock","button").width+10)*da*ra+
"px";da={x:b.parseDimension(ha.style.left),y:b.parseDimension(ha.style.top),width:fa,height:ga};if(!ta||da.x<=ta.x&&da.y<=ta.y)ta=da;if(!Ga||da.x>=Ga.x&&da.y>=Ga.y)Ga=da;ha.style.width=fa+"px";ha.style.height=ga+"px";ca+=e.skin.getSkinElement("dock","button").height+10}H={x:ta.x,y:ta.y,width:Ga.x-ta.x+Ga.width,height:ta.y-Ga.y+Ga.height}}if(B!=e.jwGetFullscreen()||j!=W||p!=V){j=W;p=V;B=e.jwGetFullscreen();z=undefined;setTimeout(aa,1)}}function t(W){return function(){if(!w&&z!=W&&Q.length>0){z=W;E.sendEvent(W,
{component:"dock",boundingRect:H})}}}function v(W){if(b.isMobile())W.newstate==a.api.events.state.IDLE?P():ia();else G()}function G(W){if(!w){clearTimeout(U);if(g.position==a.html5.view.positions.OVER||e.jwGetFullscreen())switch(e.jwGetState()){case a.api.events.state.PAUSED:case a.api.events.state.IDLE:if(O&&O.style.opacity<1&&(!g.idlehide||b.exists(W)))D();if(g.idlehide)U=setTimeout(function(){q()},2E3);break;default:b.exists(W)&&D();U=setTimeout(function(){q()},2E3);break}else D()}}function q(){if(!w){ja();
if(O.style.opacity==1){b.cancelAnimation(O);b.fadeTo(O,0,0.1,1,0)}}}function D(){if(!w){aa();if(O.style.opacity==0){b.cancelAnimation(O);b.fadeTo(O,1,0.1,0,0)}}}function J(){try{N=document.getElementById(e.id);N.addEventListener("mousemove",G)}catch(W){b.log("Could not add mouse listeners to dock: "+W)}}var M=b.extend({},l(),g);if(M.align!="FALSE"){var A={},Q=[],j,p,w=false,B=false,H={x:0,y:0,width:0,height:0},z,N,U,E=new a.html5.eventdispatcher;b.extend(this,E);var O=document.createElement("div");
O.id=e.id+"_jwplayer_dock";O.style.opacity=1;J();e.jwAddEventListener(a.api.events.JWPLAYER_PLAYER_STATE,v);this.getDisplayElement=function(){return O};this.setButton=function(W,V,ca,ra){if(!V&&A[W]){b.arrays.remove(Q,W);O.removeChild(A[W].div);delete A[W]}else if(V){A[W]||(A[W]={});A[W].handler=V;A[W].outGraphic=ca;A[W].overGraphic=ra;if(!A[W].div){Q.push(W);A[W].div=document.createElement("div");A[W].div.style.position="absolute";O.appendChild(A[W].div);A[W].div.appendChild(document.createElement("div"));
A[W].div.childNodes[0].style.position="relative";A[W].div.childNodes[0].style.width="100%";A[W].div.childNodes[0].style.height="100%";A[W].div.childNodes[0].style.zIndex=10;A[W].div.childNodes[0].style.cursor="pointer";A[W].div.appendChild(document.createElement("img"));A[W].div.childNodes[1].style.position="absolute";A[W].div.childNodes[1].style.left=0;A[W].div.childNodes[1].style.top=0;if(e.skin.getSkinElement("dock","button"))A[W].div.childNodes[1].src=e.skin.getSkinElement("dock","button").src;
A[W].div.childNodes[1].style.zIndex=9;A[W].div.childNodes[1].style.cursor="pointer";A[W].div.onmouseover=function(){if(A[W].overGraphic)A[W].div.childNodes[0].style.background=r(A[W].overGraphic);if(e.skin.getSkinElement("dock","buttonOver"))A[W].div.childNodes[1].src=e.skin.getSkinElement("dock","buttonOver").src};A[W].div.onmouseout=function(){if(A[W].outGraphic)A[W].div.childNodes[0].style.background=r(A[W].outGraphic);if(e.skin.getSkinElement("dock","button"))A[W].div.childNodes[1].src=e.skin.getSkinElement("dock",
"button").src};if(e.skin.getSkinElement("dock","button"))A[W].div.childNodes[1].src=e.skin.getSkinElement("dock","button").src}if(A[W].outGraphic)A[W].div.childNodes[0].style.background=r(A[W].outGraphic);else if(A[W].overGraphic)A[W].div.childNodes[0].style.background=r(A[W].overGraphic);if(V)A[W].div.onclick=function(ga){ga.preventDefault();a(e.id).callback(W);if(A[W].overGraphic)A[W].div.childNodes[0].style.background=r(A[W].overGraphic);if(e.skin.getSkinElement("dock","button"))A[W].div.childNodes[1].src=
e.skin.getSkinElement("dock","button").src}}u(j,p)};var aa=t(a.api.events.JWPLAYER_COMPONENT_SHOW),ja=t(a.api.events.JWPLAYER_COMPONENT_HIDE);this.resize=u;var P=function(){c(O,{display:"block"});if(w){w=false;aa()}},ia=function(){c(O,{display:"none"});if(!w){ja();w=true}};this.hide=ia;this.show=P;return this}}})(jwplayer);(function(a){a.html5.eventdispatcher=function(b,c){var e=new a.events.eventdispatcher(c);a.utils.extend(this,e);this.sendEvent=function(g,l){a.utils.exists(l)||(l={});a.utils.extend(l,
{id:b,version:a.version,type:g});e.sendEvent(g,l)}}})(jwplayer);(function(a){var b=a.utils;a.html5.instream=function(c,e,g,l){function r(){_fakemodel=new a.html5.model(this,w.getMedia()?w.getMedia().getDisplayElement():w.container,w);P=new a.html5.eventdispatcher;p.jwAddEventListener(a.api.events.JWPLAYER_RESIZE,M);p.jwAddEventListener(a.api.events.JWPLAYER_FULLSCREEN,M)}function u(){_fakemodel.setMute(w.mute);_fakemodel.setVolume(w.volume)}function t(){if(!E){E=new a.html5.mediavideo(_fakemodel,
w.getMedia()?w.getMedia().getDisplayElement():w.container);E.addGlobalListener(v);E.addEventListener(a.api.events.JWPLAYER_MEDIA_META,D);E.addEventListener(a.api.events.JWPLAYER_MEDIA_COMPLETE,q);E.addEventListener(a.api.events.JWPLAYER_MEDIA_BUFFER_FULL,G)}E.attachMedia()}function v(V){ja&&J(V.type,V)}function G(){ja&&E.play()}function q(){ja&&setTimeout(function(){W.jwInstreamDestroy(true)},10)}function D(V){V.metadata.width&&V.metadata.height&&B.resizeMedia()}function J(V,ca,ra){if(ja||ra)P.sendEvent(V,
ca)}function M(){var V=w.plugins.object.display.getDisplayElement().style;if(O){var ca=w.plugins.object.controlbar.getDisplayElement().style;O.resize(b.parseDimension(V.width),b.parseDimension(V.height));_css(O.getDisplayElement(),b.extend({},ca,{zIndex:1001,opacity:1}))}if(aa){aa.resize(b.parseDimension(V.width),b.parseDimension(V.height));_css(aa.getDisplayElement(),b.extend({},V,{zIndex:1E3}))}B&&B.resizeMedia()}var A={controlbarseekable:"always",controlbarpausable:true,controlbarstoppable:true,
playlistclickable:true},Q,j,p=c,w=e,B=g,H,z,N,U,E,O,aa,ja=false,P,ia,W=this;this.load=function(V,ca){u();ja=true;j=b.extend(A,ca);Q=a.html5.playlistitem(V);t();ia=document.createElement("div");ia.id=W.id+"_instream_container";l.detachMedia();H=E.getDisplayElement();U=w.playlist[w.item];N=p.jwGetState();if(N==a.api.events.state.BUFFERING||N==a.api.events.state.PLAYING)H.pause();z=H.currentTime;aa=new a.html5.display(W,b.extend({},w.plugins.config.display));aa.setAlternateClickHandler(function(ra){_fakemodel.state==
a.api.events.state.PAUSED?W.jwInstreamPlay():J(a.api.events.JWPLAYER_INSTREAM_CLICK,ra)});ia.appendChild(aa.getDisplayElement());if(!b.isMobile()){O=new a.html5.controlbar(W,b.extend({},w.plugins.config.controlbar,{}));w.plugins.config.controlbar.position==a.html5.view.positions.OVER?ia.appendChild(O.getDisplayElement()):w.plugins.object.controlbar.getDisplayElement().parentNode.appendChild(O.getDisplayElement())}B.setupInstream(ia,H);M();E.load(Q)};this.jwInstreamDestroy=function(V){if(ja){ja=false;
if(N!=a.api.events.state.IDLE){E.load(U,false);E.stop(false)}else E.stop(true);E.detachMedia();B.destroyInstream();if(O)try{O.getDisplayElement().parentNode.removeChild(O.getDisplayElement())}catch(ca){}J(a.api.events.JWPLAYER_INSTREAM_DESTROYED,{reason:V?"complete":"destroyed"},true);l.attachMedia();if(N==a.api.events.state.BUFFERING||N==a.api.events.state.PLAYING){H.play();w.playlist[w.item]==U&&w.getMedia().seek(z)}}};this.jwInstreamAddEventListener=function(V,ca){P.addEventListener(V,ca)};this.jwInstreamRemoveEventListener=
function(V,ca){P.removeEventListener(V,ca)};this.jwInstreamPlay=function(){ja&&E.play(true)};this.jwInstreamPause=function(){ja&&E.pause(true)};this.jwInstreamSeek=function(V){ja&&E.seek(V)};this.jwInstreamGetState=function(){if(ja)return _fakemodel.state};this.jwInstreamGetPosition=function(){if(ja)return _fakemodel.position};this.jwInstreamGetDuration=function(){if(ja)return _fakemodel.duration};this.playlistClickable=function(){return!ja||j.playlistclickable.toString().toLowerCase()=="true"};this.jwPlay=
function(){j.controlbarpausable.toString().toLowerCase()=="true"&&this.jwInstreamPlay()};this.jwPause=function(){j.controlbarpausable.toString().toLowerCase()=="true"&&this.jwInstreamPause()};this.jwStop=function(){if(j.controlbarstoppable.toString().toLowerCase()=="true"){this.jwInstreamDestroy();p.jwStop()}};this.jwSeek=function(V){switch(j.controlbarseekable.toLowerCase()){case "always":this.jwInstreamSeek(V);break;case "backwards":_fakemodel.position>V&&this.jwInstreamSeek(V);break}};this.jwGetPosition=
function(){};this.jwGetDuration=function(){};this.jwGetWidth=p.jwGetWidth;this.jwGetHeight=p.jwGetHeight;this.jwGetFullscreen=p.jwGetFullscreen;this.jwSetFullscreen=p.jwSetFullscreen;this.jwGetVolume=function(){return w.volume};this.jwSetVolume=function(V){E.volume(V);p.jwSetVolume(V)};this.jwGetMute=function(){return w.mute};this.jwSetMute=function(V){E.mute(V);p.jwSetMute(V)};this.jwGetState=function(){return _fakemodel.state};this.jwGetPlaylist=function(){return[Q]};this.jwGetPlaylistIndex=function(){return 0};
this.jwGetStretching=function(){return w.config.stretching};this.jwAddEventListener=function(V,ca){P.addEventListener(V,ca)};this.jwRemoveEventListener=function(V,ca){P.removeEventListener(V,ca)};this.skin=p.skin;this.id=p.id+"_instream";r();return this}})(jwplayer);(function(a){var b={prefix:"",file:"",link:"",linktarget:"_top",margin:8,out:0.5,over:1,timeout:5,hide:true,position:"bottom-left"};_css=a.utils.css;a.html5.logo=function(c,e){function g(){l();A.jwAddEventListener(a.api.events.JWPLAYER_PLAYER_STATE,
M);r();u()}function l(){if(b.prefix){var B=c.version.split(/\W/).splice(0,2).join("/");if(b.prefix.indexOf(B)<0)b.prefix+=B+"/"}if(e.position==a.html5.view.positions.OVER)e.position=b.position;try{if(window.location.href.indexOf("https")==0)b.prefix=b.prefix.replace("http://l.longtailvideo.com","https://securel.longtailvideo.com")}catch(H){}j=a.utils.extend({},b,e)}function r(){p=document.createElement("img");p.id=A.id+"_jwplayer_logo";p.style.display="none";p.onload=function(){_css(p,q());v()};if(j.file)p.src=
j.file.indexOf("/")>=0?j.file:j.prefix+j.file}function u(){if(j.link){p.onmouseover=G;p.onmouseout=v;p.onclick=t}else this.mouseEnabled=false}function t(B){typeof B!="undefined"&&B.stopPropagation();if(w){A.jwPause();A.jwSetFullscreen(false);j.link&&window.open(j.link,j.linktarget)}}function v(){if(j.link&&w)p.style.opacity=j.out}function G(){if(w)p.style.opacity=j.over}function q(){var B={textDecoration:"none",position:"absolute",cursor:"pointer"};B.display=j.hide.toString()=="true"&&!w?"none":"block";
var H=j.position.toLowerCase().split("-");for(var z in H)B[H[z]]=parseInt(j.margin);return B}function D(){if(j.hide.toString()=="true"){p.style.display="block";p.style.opacity=0;a.utils.fadeTo(p,j.out,0.1,parseFloat(p.style.opacity));Q=setTimeout(function(){J()},j.timeout*1E3)}w=true}function J(){w=false;j.hide.toString()=="true"&&a.utils.fadeTo(p,0,0.1,parseFloat(p.style.opacity))}function M(B){if(B.newstate==a.api.events.state.BUFFERING){clearTimeout(Q);D()}}var A=c,Q,j,p,w=false;g();if(j.file){this.resize=
function(){};this.getDisplayElement=function(){return p};return this}}})(jwplayer);(function(a){var b={ended:a.api.events.state.IDLE,playing:a.api.events.state.PLAYING,pause:a.api.events.state.PAUSED,buffering:a.api.events.state.BUFFERING},c=a.utils,e=c.isMobile(),g,l,r={};a.html5.mediavideo=function(u,t){function v(I,X){W[I]||(W[I]=function(Ba){c.exists(Ba.target.parentNode)&&X(Ba)});return W[I]}function G(){fa=a.api.events.state.IDLE;ha=true;ga=q();ga.setAttribute("x-webkit-airplay","allow");if(ra.parentNode){ga.id=
ra.id;ra.parentNode.replaceChild(ga,ra)}}function q(){var I=r[ca.id];if(!I){I=ra.tagName.toLowerCase()=="video"?ra:document.createElement("video");r[ca.id]=I;if(!I.id)I.id=ra.id}for(var X in ia)I.addEventListener(X,v(X,ia[X]),true);return I}function D(I){if(!(I==a.api.events.state.PAUSED&&fa==a.api.events.state.IDLE)){if(e)switch(I){case a.api.events.state.PLAYING:aa();break;case a.api.events.state.BUFFERING:case a.api.events.state.PAUSED:ja();break}if(fa!=I){var X=fa;ca.state=fa=I;P(a.api.events.JWPLAYER_PLAYER_STATE,
{oldstate:X,newstate:I})}}}function J(){}function M(){var I=Math.round(ga.volume*100);P(a.api.events.JWPLAYER_MEDIA_VOLUME,{volume:I},true);P(a.api.events.JWPLAYER_MEDIA_MUTE,{mute:ga.muted},true)}function A(I){if(ha){var X;if(c.exists(I)&&I.lengthComputable&&I.total)X=I.loaded/I.total*100;else if(c.exists(ga.buffered)&&ga.buffered.length>0){I=ga.buffered.length-1;if(I>=0)X=ga.buffered.end(I)/ga.duration*100}c.useNativeFullscreen()&&c.exists(ga.webkitDisplayingFullscreen)&&ca.fullscreen!=ga.webkitDisplayingFullscreen&&
P(a.api.events.JWPLAYER_FULLSCREEN,{fullscreen:ga.webkitDisplayingFullscreen},true);if(Y===false&&fa==a.api.events.state.BUFFERING){P(a.api.events.JWPLAYER_MEDIA_BUFFER_FULL);Y=true}if(!T){if(X==100)T=true;if(c.exists(X)&&X>ca.buffer){ca.buffer=Math.round(X);P(a.api.events.JWPLAYER_MEDIA_BUFFER,{bufferPercent:Math.round(X)})}}}}function Q(I){if(ha){if(c.exists(I)&&c.exists(I.target)){if(qa>0)if(!isNaN(I.target.duration)&&(isNaN(ca.duration)||ca.duration<1))ca.duration=I.target.duration==Infinity?
0:Math.round(I.target.duration*10)/10;!za&&ga.readyState>0&&D(a.api.events.state.PLAYING);if(fa==a.api.events.state.PLAYING){if(ga.readyState>0&&(la>-1||!za)){za=true;try{if(ga.currentTime!=la&&la>-1){ga.currentTime=la;la=-1}}catch(X){}ga.volume=ca.volume/100;ga.muted=ca.mute}ca.position=ca.duration>0?Math.round(I.target.currentTime*10)/10:0;P(a.api.events.JWPLAYER_MEDIA_TIME,{position:ca.position,duration:ca.duration});if(ca.position>=ca.duration&&(ca.position>0||ca.duration>0)){U();return}}}A(I)}}
function j(){}function p(I){if(ha){if(g&&l){ga.style.width=g;ga.style.height=l;g=_previousHieght=0}if(b[I.type])I.type=="ended"?U():D(b[I.type])}}function w(){if(ha){var I=Math.round(ga.duration*10)/10,X={height:ga.videoHeight,width:ga.videoWidth,duration:I};if(!qa)if((ca.duration<I||isNaN(ca.duration))&&ga.duration!=Infinity)ca.duration=I;P(a.api.events.JWPLAYER_MEDIA_META,{metadata:X})}}function B(I){if(ha)if(fa!=a.api.events.state.IDLE){var X="There was an error: ";if(I.target.error&&I.target.tagName.toLowerCase()==
"video"||I.target.parentNode.error&&I.target.parentNode.tagName.toLowerCase()=="video"){I=!c.exists(I.target.error)?I.target.parentNode.error:I.target.error;switch(I.code){case I.MEDIA_ERR_ABORTED:c.log("User aborted the video playback.");return;case I.MEDIA_ERR_NETWORK:X="A network error caused the video download to fail part-way: ";break;case I.MEDIA_ERR_DECODE:X="The video playback was aborted due to a corruption problem or because the video used features your browser did not support: ";break;
case I.MEDIA_ERR_SRC_NOT_SUPPORTED:X="The video could not be loaded, either because the server or network failed or because the format is not supported: ";break;default:X="An unknown error occurred: ";break}}else if(I.target.tagName.toLowerCase()=="source"){oa--;if(oa>0)return;if(c.userAgentMatch(/firefox/i)){c.log("The video could not be loaded, either because the server or network failed or because the format is not supported.");sa(false);return}else X="The video could not be loaded, either because the server or network failed or because the format is not supported: "}else{c.log("An unknown error occurred.  Continuing...");
return}sa(false);X+=H();_error=true;P(a.api.events.JWPLAYER_ERROR,{message:X})}}function H(){var I="";for(var X in ta.levels){var Ba=ta.levels[X];ra.ownerDocument.createElement("source");I+=a.utils.getAbsolutePath(Ba.file);if(X<ta.levels.length-1)I+=", "}return I}function z(){c.exists(Ga)||(Ga=setInterval(function(){A()},100))}function N(){clearInterval(Ga);Ga=null}function U(){if(fa==a.api.events.state.PLAYING){sa(false);P(a.api.events.JWPLAYER_MEDIA_BEFORECOMPLETE);P(a.api.events.JWPLAYER_MEDIA_COMPLETE)}}
function E(){c.exists(ga.webkitDisplayingFullscreen)&&ca.fullscreen&&!ga.webkitDisplayingFullscreen&&P(a.api.events.JWPLAYER_FULLSCREEN,{fullscreen:false},true)}function O(I){if(I.length>0&&c.userAgentMatch(/Safari/i)&&!c.userAgentMatch(/Chrome/i)){for(var X=-1,Ba=0;Ba<I.length;Ba++)switch(c.extension(I[Ba].file)){case "mp4":if(X<0)X=Ba;break;case "webm":I.splice(Ba,1);break}if(X>0){X=I.splice(X,1)[0];I.unshift(X)}}}function aa(){setTimeout(function(){ga.setAttribute("controls","controls")},100)}
function ja(){setTimeout(function(){ga.removeAttribute("controls")},250)}function P(I,X,Ba){if(ha||Ba)X?V.sendEvent(I,X):V.sendEvent(I)}var ia={abort:J,canplay:p,canplaythrough:p,durationchange:w,emptied:J,ended:p,error:B,loadeddata:w,loadedmetadata:w,loadstart:p,pause:p,play:J,playing:p,progress:A,ratechange:J,seeked:p,seeking:p,stalled:p,suspend:p,timeupdate:Q,volumechange:M,waiting:p,canshowcurrentframe:J,dataunavailable:J,empty:J,load:j,loadedfirstframe:J,webkitfullscreenchange:E},W={},V=new a.html5.eventdispatcher;
c.extend(this,V);var ca=u,ra=t,ga,fa,za,ta,Ga,la,da=false,ha=false,qa=false,T,Y,oa;G();this.load=function(I,X){if(typeof X=="undefined")X=true;if(ha){ta=I;qa=ta.duration>0;ca.duration=ta.duration;c.empty(ga);ga.style.display="block";ga.style.opacity=1;if(g&&l){ga.style.width=g;ga.style.height=l;g=_previousHieght=0}oa=0;O(I.levels);if(I.levels&&I.levels.length>0)if(I.levels.length==1||c.isIOS())ga.src=I.levels[0].file;else{ga.src&&ga.removeAttribute("src");for(var Ba=0;Ba<I.levels.length;Ba++){var Ha=
ga.ownerDocument.createElement("source");Ha.src=I.levels[Ba].file;ga.appendChild(Ha);oa++}}else ga.src=I.file;ga.volume=ca.volume/100;ga.muted=ca.mute;e&&aa();T=Y=za=false;ca.buffer=0;if(!c.exists(I.start))I.start=0;la=I.start>0?I.start:-1;P(a.api.events.JWPLAYER_MEDIA_LOADED);if(!e&&I.levels.length==1||!da)ga.load();da=false;if(X){D(a.api.events.state.BUFFERING);P(a.api.events.JWPLAYER_MEDIA_BUFFER,{bufferPercent:0});z()}ga.videoWidth>0&&ga.videoHeight>0&&w()}};this.play=function(){if(ha){z();if(Y)D(a.api.events.state.PLAYING);
else{ga.load();D(a.api.events.state.BUFFERING)}ga.play()}};this.pause=function(){if(ha){ga.pause();D(a.api.events.state.PAUSED)}};this.seek=function(I){if(ha)if(!za&&ga.readyState>0){if(!(ca.duration<=0||isNaN(ca.duration))&&!(ca.position<=0||isNaN(ca.position))){ga.currentTime=I;ga.play()}}else la=I};var sa=this.stop=function(I){if(ha){c.exists(I)||(I=true);N();if(I){Y=false;if(ga.webkitSupportsFullscreen)try{ga.webkitExitFullscreen()}catch(X){}ga.style.opacity=0;ja();if(c.isIE())ga.src="";else ga.removeAttribute("src");
c.empty(ga);ga.load();da=true}if(c.isIPod()){g=ga.style.width;l=ga.style.height;ga.style.width=0;ga.style.height=0}else if(c.isIPad()){ga.style.display="none";try{ga.webkitExitFullscreen()}catch(Ba){}}D(a.api.events.state.IDLE)}};this.fullscreen=function(I){I===true?this.resize("100%","100%"):this.resize(ca.config.width,ca.config.height)};this.resize=function(){};this.volume=function(I){if(!e){ga.volume=I/100;P(a.api.events.JWPLAYER_MEDIA_VOLUME,{volume:I/100})}};this.mute=function(I){if(!e){ga.muted=
I;P(a.api.events.JWPLAYER_MEDIA_MUTE,{mute:I})}};this.getDisplayElement=function(){return ga};this.hasChrome=function(){return e&&fa==a.api.events.state.PLAYING};this.detachMedia=function(){ha=false;return this.getDisplayElement()};this.attachMedia=function(){ha=true};this.destroy=function(){if(ga&&ga.parentNode){N();for(var I in ia)ga.removeEventListener(I,v(I,ia[I]),true);c.empty(ga);ra=ga.parentNode;ga.parentNode.removeChild(ga);delete r[ca.id];ga=null}}}})(jwplayer);(function(a){var b=a.utils.css;
a.html5.mediayoutube=function(c,e){function g(J){if(G!=J){var M=G;G=t.state=J;u.sendEvent(a.api.events.JWPLAYER_PLAYER_STATE,{oldstate:M,newstate:J})}}function l(J){J=J.levels[0].file;J=["http://www.youtube.com/v/",r(J),"&amp;hl=en_US&amp;fs=1&autoplay=1"].join("");q=document.createElement("object");q.id=v.id;q.style.position="absolute";var M={movie:J,allowfullscreen:"true",allowscriptaccess:"always"};for(var A in M){var Q=document.createElement("param");Q.name=A;Q.value=M[A];q.appendChild(Q)}D=document.createElement("embed");
q.appendChild(D);A={src:J,type:"application/x-shockwave-flash",allowfullscreen:"true",allowscriptaccess:"always",width:q.width,height:q.height};for(var j in A)D.setAttribute(j,A[j]);q.appendChild(D);q.style.zIndex=2147483E3;v!=q&&v.parentNode&&v.parentNode.replaceChild(q,v);v=q}function r(J){for(var M=J.split(/\?|\#\!/),A="",Q=0;Q<M.length;Q++)if(M[Q].substr(0,2)=="v=")A=M[Q].substr(2);if(A=="")A=J.indexOf("/v/")>=0?J.substr(J.indexOf("/v/")+3):J.indexOf("youtu.be")>=0?J.substr(J.indexOf("youtu.be/")+
9):J;if(A.indexOf("?")>-1)A=A.substr(0,A.indexOf("?"));if(A.indexOf("&")>-1)A=A.substr(0,A.indexOf("&"));return A}var u=new a.html5.eventdispatcher;a.utils.extend(this,u);var t=c,v=document.getElementById(e.id),G=a.api.events.state.IDLE,q,D;this.getDisplayElement=this.detachMedia=function(){return v};this.attachMedia=function(){};this.play=function(){if(G==a.api.events.state.IDLE){u.sendEvent(a.api.events.JWPLAYER_MEDIA_BUFFER,{bufferPercent:100});u.sendEvent(a.api.events.JWPLAYER_MEDIA_BUFFER_FULL);
g(a.api.events.state.PLAYING)}else G==a.api.events.state.PAUSED&&g(a.api.events.state.PLAYING)};this.pause=function(){g(a.api.events.state.PAUSED)};this.seek=function(){};this.stop=function(J){_utils.exists(J)||(J=true);t.position=0;g(a.api.events.state.IDLE);J&&b(v,{display:"none"})};this.volume=function(J){t.setVolume(J);u.sendEvent(a.api.events.JWPLAYER_MEDIA_VOLUME,{volume:Math.round(J)})};this.mute=function(J){v.muted=J;u.sendEvent(a.api.events.JWPLAYER_MEDIA_MUTE,{mute:J})};this.resize=function(J,
M){if(J*M>0&&q){q.width=D.width=J;q.height=D.height=M}};this.fullscreen=function(J){J===true?this.resize("100%","100%"):this.resize(t.config.width,t.config.height)};this.load=function(J){l(J);b(q,{display:"block"});g(a.api.events.state.BUFFERING);u.sendEvent(a.api.events.JWPLAYER_MEDIA_BUFFER,{bufferPercent:0});u.sendEvent(a.api.events.JWPLAYER_MEDIA_LOADED);this.play()};this.hasChrome=function(){return G!=a.api.events.state.IDLE};this.embed=D;return this}})(jwplayer);(function(a){var b=["width",
"height","start","duration","volume","mute","fullscreen","item","plugins","stretching"],c=a.utils;a.html5.model=function(e,g,l){function r(N){var U=new a.html5.playlistloader;U.addEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,function(E){q.playlist=new a.html5.playlist(E);u(true)});U.addEventListener(a.api.events.JWPLAYER_ERROR,function(){q.playlist=new a.html5.playlist({playlist:[]});u(false)});U.load(N)}function u(){if(q.config.shuffle)q.item=t();else{if(q.config.item>=q.playlist.length)q.config.item=
q.playlist.length-1;else if(q.config.item<0)q.config.item=0;q.item=q.config.item}q.position=0;q.duration=q.playlist.length>0?q.playlist[q.item].duration:0;J.sendEvent(a.api.events.JWPLAYER_PLAYLIST_LOADED,{playlist:q.playlist});J.sendEvent(a.api.events.JWPLAYER_PLAYLIST_ITEM,{index:q.item})}function t(){var N=null;if(q.playlist.length>1)for(;!a.utils.exists(N);){N=Math.floor(Math.random()*q.playlist.length);if(N==q.item)N=null}else N=0;return N}function v(N){switch(N.type){case a.api.events.JWPLAYER_MEDIA_LOADED:G=
D.getDisplayElement();break;case a.api.events.JWPLAYER_MEDIA_MUTE:this.mute=N.mute;break;case a.api.events.JWPLAYER_MEDIA_VOLUME:this.volume=N.volume;break}J.sendEvent(N.type,N)}var G=g;g=c.getCookies();var q={id:G.id,playlist:[],state:a.api.events.state.IDLE,position:0,buffer:0,container:G,config:{width:480,height:320,item:-1,skin:undefined,file:undefined,image:undefined,start:0,duration:0,bufferlength:5,volume:g.volume?g.volume:90,mute:g.mute&&g.mute.toString().toLowerCase()=="true"?true:false,
fullscreen:false,repeat:"",stretching:a.utils.stretching.UNIFORM,autostart:false,debug:undefined,screencolor:undefined}},D,J=new a.html5.eventdispatcher;a.utils.extend(q,J);for(var M in l){if(typeof l[M]=="string"){g=/color$/.test(M)?"color":null;l[M]=a.utils.typechecker(l[M],g)}g=q.config;var A=M.split(".");for(var Q in A)if(Q==A.length-1)g[A[Q]]=l[M];else{a.utils.exists(g[A[Q]])||(g[A[Q]]={});g=g[A[Q]]}}for(var j in b){l=b[j];q[l]=q.config[l]}j=["display","logo","controlbar","playlist","dock"].concat([]);
if(a.utils.exists(q.plugins))if(typeof q.plugins=="string"){l=q.plugins.split(",");for(var p in l)typeof l[p]=="string"&&j.push(l[p].replace(/^\s+|\s+$/g,""))}if(a.utils.isMobile()){j=["display","logo","dock","playlist"];if(!a.utils.exists(q.config.repeat))q.config.repeat="list"}else if(q.config.chromeless){j=["logo","dock","playlist"];if(!a.utils.exists(q.config.repeat))q.config.repeat="list"}q.plugins={order:j,config:{},object:{}};if(typeof q.config.components!="undefined")for(var w in q.config.components)q.plugins.config[w]=
q.config.components[w];p=false;for(var B in q.plugins.order){w=q.plugins.order[B];j=!a.utils.exists(q.plugins.config[w])?{}:q.plugins.config[w];q.plugins.config[w]=!a.utils.exists(q.plugins.config[w])?j:a.utils.extend(q.plugins.config[w],j);if(a.utils.exists(q.plugins.config[w].position)){if(w=="playlist")p=true;q.plugins.config[w].position=q.plugins.config[w].position.toString().toUpperCase()}else q.plugins.config[w].position=w=="playlist"?a.html5.view.positions.NONE:a.html5.view.positions.OVER}if(q.plugins.config.controlbar&&
p)q.plugins.config.controlbar.hideplaylistcontrols=true;if(typeof q.plugins.config.dock!="undefined"){if(typeof q.plugins.config.dock!="object"){B=q.plugins.config.dock.toString().toUpperCase();q.plugins.config.dock={position:B}}if(typeof q.plugins.config.dock.position!="undefined"){q.plugins.config.dock.align=q.plugins.config.dock.position;q.plugins.config.dock.position=a.html5.view.positions.OVER}if(typeof q.plugins.config.dock.idlehide=="undefined")try{q.plugins.config.dock.idlehide=q.plugins.config.controlbar.idlehide}catch(H){}}q.loadPlaylist=
function(N){var U;if(typeof N=="string")if(N.indexOf("[")==0||N.indexOf("{")=="0")try{U=eval(N)}catch(E){U=N}else U=N;else U=N;switch(a.utils.typeOf(U)){case "object":N=U;break;case "array":N={playlist:U};break;default:N={file:U};break}q.playlist=new a.html5.playlist(N);q.item=q.config.item>=0?q.config.item:0;!q.playlist[0].provider&&q.playlist[0].file?r(q.playlist[0].file):u()};var z={};q.setActiveMediaProvider=function(N){if(N.provider=="audio")N.provider="sound";N=N.provider;var U=D?D.getDisplayElement():
null;if(N=="sound"||N=="http"||N=="")N="video";if(a.utils.exists(z[N])){if(D!=z[N]){D&&D.stop();D=z[N]}}else{switch(N){case "video":D=new a.html5.mediavideo(q,U?U:G);break;case "youtube":D=new a.html5.mediayoutube(q,U?U:G);break}if(!a.utils.exists(D))return false;D.addGlobalListener(v);z[N]=D}return true};q.getMedia=function(){return D};q.seek=function(N){J.sendEvent(a.api.events.JWPLAYER_MEDIA_SEEK,{position:q.position,offset:N});return D.seek(N)};q.setVolume=function(N){c.saveCookie("volume",N);
q.volume=N};q.setMute=function(N){c.saveCookie("mute",N);q.mute=N};q.setupPlugins=function(){if(!a.utils.exists(q.plugins)||!a.utils.exists(q.plugins.order)||q.plugins.order.length==0){a.utils.log("No plugins to set up");return q}for(var N=0;N<q.plugins.order.length;N++)try{var U=q.plugins.order[N];if(a.utils.exists(a.html5[U]))q.plugins.object[U]=U=="playlist"?new a.html5.playlistcomponent(e,q.plugins.config[U]):new a.html5[U](e,q.plugins.config[U]);else q.plugins.order.splice(plugin,plugin+1);typeof q.plugins.object[U].addGlobalListener==
"function"&&q.plugins.object[U].addGlobalListener(v)}catch(E){a.utils.log("Could not setup "+U)}};return q}})(jwplayer);(function(a){a.html5.playlist=function(b){var c=[];if(b.playlist&&b.playlist instanceof Array&&b.playlist.length>0)for(var e in b.playlist)isNaN(parseInt(e))||c.push(new a.html5.playlistitem(b.playlist[e]));else c.push(new a.html5.playlistitem(b));return c}})(jwplayer);(function(a){var b={size:180,position:a.html5.view.positions.NONE,itemheight:60,thumbs:true,fontcolor:"#000000",
overcolor:"",activecolor:"",backgroundcolor:"#f8f8f8",font:"_sans",fontsize:"",fontstyle:"",fontweight:""},c={_sans:"Arial, Helvetica, sans-serif",_serif:"Times, Times New Roman, serif",_typewriter:"Courier New, Courier, monospace"};_utils=a.utils;_css=_utils.css;_hide=function(e){_css(e,{display:"none"})};_show=function(e){_css(e,{display:"block"})};a.html5.playlistcomponent=function(e,g){function l(){H=document.createElement("div");H.id=w.id+"_jwplayer_playlistcomponent";H.style.overflow="hidden";
switch(B.position){case a.html5.view.positions.RIGHT:case a.html5.view.positions.LEFT:H.style.width=B.size+"px";break;case a.html5.view.positions.TOP:case a.html5.view.positions.BOTTOM:H.style.height=B.size+"px";break}j();if(aa.item)B.itemheight=aa.item.height;H.style.backgroundColor="#C6C6C6";w.jwAddEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,G);w.jwAddEventListener(a.api.events.JWPLAYER_PLAYLIST_ITEM,A);w.jwAddEventListener(a.api.events.JWPLAYER_PLAYER_STATE,Q)}function r(){var ja=document.createElement("ul");
_css(ja,{width:H.style.width,minWidth:H.style.width,height:H.style.height,backgroundColor:B.backgroundcolor,backgroundImage:aa.background?"url("+aa.background.src+")":"",color:B.fontcolor,listStyle:"none",margin:0,padding:0,fontFamily:c[B.font]?c[B.font]:c._sans,fontSize:(B.fontsize?B.fontsize:11)+"px",fontStyle:B.fontstyle,fontWeight:B.fontweight,overflowY:"auto"});return ja}function u(ja){return function(){var P=E.getElementsByClassName("item")[ja],ia=B.fontcolor,W=aa.item?"url("+aa.item.src+")":
"";if(ja==w.jwGetPlaylistIndex()){if(B.activecolor!=="")ia=B.activecolor;if(aa.itemActive)W="url("+aa.itemActive.src+")"}_css(P,{color:B.overcolor!==""?B.overcolor:ia,backgroundImage:aa.itemOver?"url("+aa.itemOver.src+")":W})}}function t(ja){return function(){var P=E.getElementsByClassName("item")[ja],ia=B.fontcolor,W=aa.item?"url("+aa.item.src+")":"";if(ja==w.jwGetPlaylistIndex()){if(B.activecolor!=="")ia=B.activecolor;if(aa.itemActive)W="url("+aa.itemActive.src+")"}_css(P,{color:ia,backgroundImage:W})}}
function v(ja){var P=U[ja],ia=document.createElement("li");ia.className="item";_css(ia,{height:B.itemheight,display:"block",cursor:"pointer",backgroundImage:aa.item?"url("+aa.item.src+")":"",backgroundSize:"100% "+B.itemheight+"px"});ia.onmouseover=u(ja);ia.onmouseout=t(ja);var W=document.createElement("div"),V=new Image,ca=ja=0,ra=0;if(M()&&(P.image||P["playlist.image"]||aa.itemImage)){V.className="image";if(aa.itemImage){ja=(B.itemheight-aa.itemImage.height)/2;ca=aa.itemImage.width;ra=aa.itemImage.height}else{ca=
B.itemheight*4/3;ra=B.itemheight}_css(W,{height:ra,width:ca,"float":"left",styleFloat:"left",cssFloat:"left",margin:"0 5px 0 0",background:"black",overflow:"hidden",margin:ja+"px",position:"relative"});_css(V,{position:"relative"});W.appendChild(V);V.onload=function(){a.utils.stretch(a.utils.stretching.FILL,V,ca,ra,this.naturalWidth,this.naturalHeight)};if(P["playlist.image"])V.src=P["playlist.image"];else if(P.image)V.src=P.image;else if(aa.itemImage)V.src=aa.itemImage.src;ia.appendChild(W)}var ga=
z-ca-ja*2;if(N<B.itemheight*U.length)ga-=15;W=document.createElement("div");_css(W,{position:"relative",height:"100%",overflow:"hidden"});var fa=document.createElement("span");if(P.duration>0){fa.className="duration";_css(fa,{fontSize:(B.fontsize?B.fontsize:11)+"px",fontWeight:B.fontweight?B.fontweight:"bold",width:"40px",height:B.fontsize?B.fontsize+10:20,lineHeight:24,"float":"right",styleFloat:"right",cssFloat:"right"});fa.innerHTML=_utils.timeFormat(P.duration);W.appendChild(fa)}fa=document.createElement("span");
fa.className="title";_css(fa,{padding:"5px 5px 0 "+(ja?0:"5px"),height:B.fontsize?B.fontsize+10:20,lineHeight:B.fontsize?B.fontsize+10:20,overflow:"hidden","float":"left",styleFloat:"left",cssFloat:"left",width:(P.duration>0?ga-50:ga)-10+"px",fontSize:(B.fontsize?B.fontsize:13)+"px",fontWeight:B.fontweight?B.fontweight:"bold"});fa.innerHTML=P?P.title:"";W.appendChild(fa);if(P.description){ja=document.createElement("span");ja.className="description";_css(ja,{display:"block","float":"left",styleFloat:"left",
cssFloat:"left",margin:0,paddingLeft:fa.style.paddingLeft,paddingRight:fa.style.paddingRight,lineHeight:(B.fontsize?B.fontsize+4:16)+"px",overflow:"hidden",position:"relative"});ja.innerHTML=P.description;W.appendChild(ja)}ia.appendChild(W);return ia}function G(){H.innerHTML="";if(U=q()){items=[];E=r();for(var ja=0;ja<U.length;ja++){var P=v(ja);P.onclick=D(ja);E.appendChild(P);items.push(P)}O=w.jwGetPlaylistIndex();t(O)();H.appendChild(E);if(_utils.isIOS()&&window.iScroll){E.style.height=B.itemheight*
U.length+"px";new iScroll(H.id)}}}function q(){for(var ja=w.jwGetPlaylist(),P=[],ia=0;ia<ja.length;ia++)ja[ia]["ova.hidden"]||P.push(ja[ia]);return P}function D(ja){return function(){w.jwPlaylistItem(ja);w.jwPlay(true)}}function J(){E.scrollTop=w.jwGetPlaylistIndex()*B.itemheight}function M(){return B.thumbs.toString().toLowerCase()=="true"}function A(ja){if(O>=0){t(O)();O=ja.index}t(ja.index)();J()}function Q(){if(B.position==a.html5.view.positions.OVER)switch(w.jwGetState()){case a.api.events.state.IDLE:_show(H);
break;default:_hide(H);break}}function j(){for(var ja in aa)aa[ja]=p(ja)}function p(ja){return w.skin.getSkinElement("playlist",ja)}var w=e,B=a.utils.extend({},b,w.skin.getComponentSettings("playlist"),g);if(!(B.position==a.html5.view.positions.NONE||typeof a.html5.view.positions[B.position]=="undefined")){var H,z,N,U,E,O=-1,aa={background:undefined,item:undefined,itemOver:undefined,itemImage:undefined,itemActive:undefined};this.getDisplayElement=function(){return H};this.resize=function(ja,P){z=
ja;N=P;w.jwGetFullscreen()?_hide(H):_css(H,{display:"block",width:z,height:N})};this.show=function(){_show(H)};this.hide=function(){_hide(H)};l();return this}}})(jwplayer);(function(a){function b(c){if(a.utils.isYouTube(c.file))return"youtube";else{var e=a.utils.extension(c.file),g;if(e&&a.utils.extensionmap[e]){if(e=="m3u8")return"video";g=a.utils.extensionmap[e].html5}else if(c.type)g=c.type;if(g){c=g.split("/")[0];if(c=="audio")return"sound";else if(c=="video")return c}}return""}a.html5.playlistitem=
function(c){c=a.utils.extend({},{author:"",date:"",description:"",image:"",link:"",mediaid:"",tags:"",title:"",provider:"",file:"",streamer:"",duration:-1,start:0,currentLevel:-1,levels:[]},c);if(c.type){c.provider=c.type;delete c.type}if(c.levels.length===0)c.levels[0]=new a.html5.playlistitemlevel(c);c.provider=c.provider?c.provider.toLowerCase():b(c.levels[0]);return c}})(jwplayer);(function(a){a.html5.playlistitemlevel=function(b){var c={file:"",streamer:"",bitrate:0,width:0};for(var e in c)if(a.utils.exists(b[e]))c[e]=
b[e];return c}})(jwplayer);(function(a){a.html5.playlistloader=function(){function b(g){var l=[];try{l=a.utils.parsers.rssparser.parse(g.responseXML.firstChild);e.sendEvent(a.api.events.JWPLAYER_PLAYLIST_LOADED,{playlist:new a.html5.playlist({playlist:l})})}catch(r){c("Could not parse the playlist")}}function c(g){e.sendEvent(a.api.events.JWPLAYER_ERROR,{message:g?g:"Could not load playlist an unknown reason."})}var e=new a.html5.eventdispatcher;a.utils.extend(this,e);this.load=function(g){a.utils.ajax(g,
b,c)}}})(jwplayer);(function(a){a.html5.skin=function(){var b={},c=false;this.load=function(e,g){new a.html5.skinloader(e,function(l){c=true;b=l;g()},function(){new a.html5.skinloader("",function(l){c=true;b=l;g()})})};this.getSkinElement=function(e,g){if(c)try{return b[e].elements[g]}catch(l){a.utils.log("No such skin component / element: ",[e,g])}return null};this.getComponentSettings=function(e){if(c&&b&&b[e])return b[e].settings;return null};this.getComponentLayout=function(e){if(c)return b[e].layout;
return null}}})(jwplayer);(function(a){a.html5.skinloader=function(b,c,e){function g(){typeof Q!="string"||Q===""?l(a.html5.defaultSkin().xml):a.utils.ajax(a.utils.getAbsolutePath(Q),function(p){try{if(a.utils.exists(p.responseXML)){l(p.responseXML);return}}catch(w){t()}l(a.html5.defaultSkin().xml)},function(){l(a.html5.defaultSkin().xml)})}function l(p){p=p.getElementsByTagName("component");if(p.length!==0)for(var w=0;w<p.length;w++){var B=p[w].getAttribute("name");q[B]={settings:{},elements:{},
layout:{}};for(var H=p[w].getElementsByTagName("elements")[0].getElementsByTagName("element"),z=0;z<H.length;z++)u(H[z],B);if((H=p[w].getElementsByTagName("settings")[0])&&H.childNodes.length>0){H=H.getElementsByTagName("setting");for(z=0;z<H.length;z++){var N=H[z].getAttribute("name"),U=H[z].getAttribute("value"),E=/color$/.test(N)?"color":null;q[B].settings[N]=a.utils.typechecker(U,E)}}if((H=p[w].getElementsByTagName("layout")[0])&&H.childNodes.length>0){H=H.getElementsByTagName("group");for(z=
0;z<H.length;z++){N=H[z];q[B].layout[N.getAttribute("position")]={elements:[]};for(U=0;U<N.attributes.length;U++){E=N.attributes[U];q[B].layout[N.getAttribute("position")][E.name]=E.value}U=N.getElementsByTagName("*");for(E=0;E<U.length;E++){var O=U[E];q[B].layout[N.getAttribute("position")].elements.push({type:O.tagName});for(var aa=0;aa<O.attributes.length;aa++){var ja=O.attributes[aa];q[B].layout[N.getAttribute("position")].elements[E][ja.name]=ja.value}if(!a.utils.exists(q[B].layout[N.getAttribute("position")].elements[E].name))q[B].layout[N.getAttribute("position")].elements[E].name=
O.tagName}}}M=false;r()}}function r(){clearInterval(A);j||(A=setInterval(function(){v()},100))}function u(p,w){var B=new Image,H=p.getAttribute("name");p=p.getAttribute("src");if(p.indexOf("data:image/png;base64,")===0)p=p;else{var z=a.utils.getAbsolutePath(Q);p=[z.substr(0,z.lastIndexOf("/")),w,p].join("/")}q[w].elements[H]={height:0,width:0,src:"",ready:false,image:B};B.onload=function(){G(B,H,w)};B.onerror=function(){j=true;r();J()};B.src=p}function t(){for(var p in q){var w=q[p];for(var B in w.elements){var H=
w.elements[B],z=H.image;z.onload=null;z.onerror=null;delete H.image;delete w.elements[B]}delete q[p]}}function v(){for(var p in q)if(p!="properties")for(var w in q[p].elements)if(!q[p].elements[w].ready)return;if(M===false){clearInterval(A);D(q)}}function G(p,w,B){if(q[B]&&q[B].elements[w]){q[B].elements[w].height=p.height;q[B].elements[w].width=p.width;q[B].elements[w].src=p.src;q[B].elements[w].ready=true;r()}else a.utils.log("Loaded an image for a missing element: "+B+"."+w)}var q={},D=c,J=e,M=
true,A,Q=b,j=false;g()}})(jwplayer);(function(a){a.html5.api=function(b,c){function e(){q.state==a.api.events.state.PLAYING||q.state==a.api.events.state.BUFFERING?J.pause():J.play()}function g(A){return function(){return q[A]}}function l(A,Q,j){return function(){var p=q.plugins.object[A];p&&p[Q]&&typeof p[Q]=="function"&&p[Q].apply(p,j)}}function r(A){return function(){if(M&&typeof M[A]=="function")return M[A].apply(this,arguments);else _utils.log("Could not call instream method - instream API not initialized")}}
function u(){if(q.config.playlistfile){q.addEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,t);q.loadPlaylist(q.config.playlistfile)}else if(typeof q.config.playlist=="string"){q.addEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,t);q.loadPlaylist(q.config.playlist)}else{q.loadPlaylist(q.config);setTimeout(t,25)}}function t(A){q.removeEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,t);q.setupPlugins();D.setup();A={id:v.id,version:v.version};J.playerReady(A)}var v={},G=document.createElement("div");
b.parentNode.replaceChild(G,b);G.id=b.id;v.version=a.version;v.id=G.id;var q=new a.html5.model(v,G,c),D=new a.html5.view(v,G,q),J=new a.html5.controller(v,G,q,D);v.skin=new a.html5.skin;v.jwPlay=function(A){if(typeof A=="undefined")e();else A.toString().toLowerCase()=="true"?J.play():J.pause()};v.jwPause=function(A){if(typeof A=="undefined")e();else A.toString().toLowerCase()=="true"?J.pause():J.play()};v.jwStop=J.stop;v.jwSeek=J.seek;v.jwPlaylistItem=function(A){if(M){if(M.playlistClickable()){M.jwInstreamDestroy();
return J.item(A)}}else return J.item(A)};v.jwPlaylistNext=J.next;v.jwPlaylistPrev=J.prev;v.jwResize=J.resize;v.jwLoad=J.load;v.jwDetachMedia=J.detachMedia;v.jwAttachMedia=J.attachMedia;v.jwGetPlaylistIndex=g("item");v.jwGetPosition=g("position");v.jwGetDuration=g("duration");v.jwGetBuffer=g("buffer");v.jwGetWidth=g("width");v.jwGetHeight=g("height");v.jwGetFullscreen=g("fullscreen");v.jwSetFullscreen=J.setFullscreen;v.jwGetVolume=g("volume");v.jwSetVolume=J.setVolume;v.jwGetMute=g("mute");v.jwSetMute=
J.setMute;v.jwGetStretching=function(){return q.stretching.toUpperCase()};v.jwGetState=g("state");v.jwGetVersion=function(){return v.version};v.jwGetPlaylist=function(){return q.playlist};v.jwAddEventListener=J.addEventListener;v.jwRemoveEventListener=J.removeEventListener;v.jwSendEvent=J.sendEvent;v.jwDockSetButton=function(A,Q,j,p){q.plugins.object.dock&&q.plugins.object.dock.setButton&&q.plugins.object.dock.setButton(A,Q,j,p)};v.jwControlbarShow=l("controlbar","show");v.jwControlbarHide=l("controlbar",
"hide");v.jwDockShow=l("dock","show");v.jwDockHide=l("dock","hide");v.jwDisplayShow=l("display","show");v.jwDisplayHide=l("display","hide");var M;v.jwLoadInstream=function(A,Q){M||(M=new a.html5.instream(v,q,D,J));setTimeout(function(){M.load(A,Q)},10)};v.jwInstreamDestroy=function(){M&&M.jwInstreamDestroy()};v.jwInstreamAddEventListener=r("jwInstreamAddEventListener");v.jwInstreamRemoveEventListener=r("jwInstreamRemoveEventListener");v.jwInstreamGetState=r("jwInstreamGetState");v.jwInstreamGetDuration=
r("jwInstreamGetDuration");v.jwInstreamGetPosition=r("jwInstreamGetPosition");v.jwInstreamPlay=r("jwInstreamPlay");v.jwInstreamPause=r("jwInstreamPause");v.jwInstreamSeek=r("jwInstreamSeek");v.jwDestroy=function(){J.destroy()};v.jwGetLevel=function(){};v.jwGetBandwidth=function(){};v.jwGetLockState=function(){};v.jwLock=function(){};v.jwUnlock=function(){};q.config.chromeless&&!a.utils.isIOS()?u():v.skin.load(q.config.skin,u);return v}})(jwplayer)};var KongAds=function(){function a(g){return g.replace(/[^a-z0-9-+_]+/gi,"_").substr(0,10)}function b(g,l){var r=[],u=[],t=a(g);if(l instanceof Array){for(g=l.length;g--;)u[g]=a(l[g]);r.push([t,u])}else r.push([t,a(l)]);return r}function c(g){var l=[];if(1==g.length)for(var r in g[0])l=l.concat(b(r,g[0][r]));else if(2==g.length)l=l.concat(b(g[0],g[1]));return l}function e(g){this.initialize(g)}e.prototype={initialize:function(g){this._network_id=g.networkId;this._publisher_id=g.publisherId;this._rendering_mode=
g.renderingMode;this._slots={}},defineAd:function(g,l,r){var u=this,t="/"+this._network_id+"/"+this._publisher_id+"/"+g;googletag.cmd.push(function(){u._slots[g]=googletag.defineSlot(t,[l,r],g+"-ad-slot").addService(googletag.pubads())});return this},setTargeting:function(){var g=arguments;googletag.cmd.push(function(){for(var l=googletag.pubads(),r=c(g),u=r.length;u--;)l.setTargeting(r[u][0],r[u][1])});return this},setGenderTargeting:function(g){googletag.cmd.push(function(){googletag.pubads().set("demographic_gender",
g)});return this},setAgeTargeting:function(g){googletag.cmd.push(function(){googletag.pubads().set("demographic_age",g)});return this},displayAd:function(g){googletag.cmd.push(function(){googletag.display(g+"-ad-slot")});return this},requestAds:function(){if(document.location.search.match(/username=/)||document.referrer.match(/username=/))return this;googletag.cmd.push(function(){var g=googletag.pubads();g[renderingMode]();g.enableSingleRequest();googletag.enableServices()});return this},getSlot:function(g){return this._slots[g]},
onDealspotOfferUnavailable:function(){$("dealspot_banner_holder").remove();$("game_leaderboad_banner_holder").show()},onDealspotOfferAvailable:function(){$("game_leaderboad_banner_holder").remove();$("dealspot_target").update($("dealspot_banner_holder").addClassName("horizontal_ad").setStyle({top:"",left:""}))},onDealspotOpen:function(){$("game").setStyle({top:"-10000px",left:"-10000px"})},onDealspotClose:function(){$("game").setStyle({top:"",left:""})}};return{KongDFPAds:e}}(),KongDFPAds=KongAds.KongDFPAds;function KredPackagePicker(a){this.initialize(a)}
KredPackagePicker.prototype={initialize:function(a){this._kred_packages=a.kred_packages;this._active_user=a.active_user;this._purchase_methods={};this._package_purchase_selected_callbacks={};this._payment_options_preselected_callbacks={};this._payment_options_selected_callbacks={};this._kav_required=a.kav_required;this._package_choices_node=null;this._required_kreds=a.required_kreds;this._current_balance=a.current_balance;this._use_stored_cc=this._has_stored_cc=a.has_stored_cc;this._use_stored_paypal=
this._has_paypal_billing_agreement=a.has_paypal_billing_agreement;this._blocked_for_cc=a.blocked_for_cc;this._kred_deficit=[this._required_kreds-this._current_balance,0].max();this._payment_option_selected=false;var b=this;document.observe("dom:loaded",function(){b.showFirstPage(a.preselected_payment_method)})},showFirstPage:function(a){var b=this,c=this._purchase_methods[a],e=function(g){(g=b._payment_options_preselected_callbacks[g])&&g.each(function(l){l(c,b)})};if(c){e(c.purchase_record_class);
this.showPreselectedPaymentOption(a)}else{b.recordAnalyticsPageview("/kred_lightbox/payment_selection");$("payment_method_selection").show()}},customPackageVariables:function(){return Object.toQueryString({uid:this._active_user.id(),kpid:this._selected_kred_package.id})},initializeXsollaPayBar:function(a){XPBWidget.__initialized=true;XPBWidget.init({element_id:"xsolla_paybar",type:"newwindow",project:a.project_id,v1:active_user.id(),v2:a.guid,v3:"",out:"",local:"en",icon_set:1,marketplace:{id:3,theme:20005},
scripthost:"//secure.xsolla.com",itemTemplate:'<span><a href="%HREF%" target="_blank"><img src="%ICON_SRC%" /><b>%NAME%</b></a></span>',errorCallback:function(b,c){typeof console!="undefined"&&console.log('Xsolla error: "'+b+'" at '+c);$("xsolla_paybar_holder").remove()},doneCallback:function(){$("xsolla_paybar").down().show()},template:{id:"slide",icon_count:4,shift_count:3,animation_speed:200}})},showXsollaConfirmation:function(a){$$(".kred_flow_step").each(Element.hide);$("xsolla_confirmation_content").update((new Template($("xsolla_"+
(a.guid?"success":"incomplete")).innerHTML)).evaluate(a));$("purchase_method_form_XsollaTransaction").show()},returnToSelectPackage:function(){this.reselectPurchaseMethod()},reselectPurchaseMethod:function(){this.selectPaymentOption(this._selected_payment_option)},returnToSelectPaymentMethod:function(){$$(".kred_flow_step").each(Element.hide);$("payment_method_selection").show();$("blocked_for_cc_message").hide();this._use_stored_cc=this._has_stored_cc;this.recordAnalyticsPageview("/kred_lightbox/payment_selection")},
checkIfVerificationRequired:function(){if(this._kav_required){window.location="/accounts/"+active_user.username()+"/kred_account_verification/edit";return true}},hideKredFlow:function(){$$(".kred_flow_step").each(Element.hide)},addPurchaseMethod:function(a){this._purchase_methods[a.purchase_record_class]=a},showPreselectedPaymentOption:function(a){if(a=this._purchase_methods[a])this.selectPaymentOption(a.purchase_record_class);else this._payment_option_selected||$("payment_method_selection").show()},
returnToRegularPaypal:function(){this._use_stored_paypal=false;this.reselectPurchaseMethod()},resetStoredPaypal:function(){this._use_stored_paypal=this._has_paypal_billing_agreement},returnToRegularCC:function(){this._use_stored_cc=false;this.reselectPurchaseMethod()},blockForCC:function(){this._blocked_for_cc=true},selectPaymentOption:function(a){if(this.useStoredCC()&&a=="CreditCardTransaction"){$("kred_discount_message")&&$("kred_discount_message").show();$("gamestop-employee-discount-message")&&
$("gamestop-employee-discount-message").show()}else{$("kred_discount_message")&&$("kred_discount_message").hide();$("gamestop-employee-discount-message")&&$("gamestop-employee-discount-message").hide()}var b=this._purchase_methods[a];this._payment_option_selected=true;if(!this.checkIfVerificationRequired()){this.hideKredFlow();this._selected_payment_option=a;this.setPackageClassForPurchaseMethod(a);this.recordSelectedPaymentOptionAnalytics(b);$$(".kred_purchase_method_name").each(function(g){g.update(b.name)});
this.showPackageSelection(b);$$(".package-selection-footer, .package-selection-sidebar").each(Element.hide);$("generic-package-selection-sidebar").show();$("generic-package-selection-footer").show();$$(".package-selection-sidebar .powerup_rewards_upsell").each(Element.show);$$(".package-selection-sidebar .gamestop_employee_upsell").each(Element.show);$$("#employee_kred_text").each(Element.hide);$$(".js_kred_discount_message").invoke("show");var c=this,e=this._payment_options_selected_callbacks[b.purchase_record_class];
e&&e.each(function(g){g(b,c)});a.match(/Boku/)&&$$(".js_kred_discount_message").invoke("hide");this.populateFormValuesAndSummaries()}},setPackageClassForPurchaseMethod:function(a){a.match(/Boku/i)?$("kred_packages_choices_div").removeClassName("kred_sale_purchase_method"):$("kred_packages_choices_div").addClassName("kred_sale_purchase_method")},recordSelectedPaymentOptionAnalytics:function(a){a=a.preselect_param;if("mobile"==a)a="boku";if("game_card"==a)this.recordAnalyticsPageview("/kred_lightbox/ugc/code_entry");
else"offers"==a?this.recordAnalyticsPageview("/kred_lightbox/trialpay/iframe"):this.recordAnalyticsPageview("/kred_lightbox/"+a+"/package_selection")},addPackage:function(a){if(this._package_choices_node===null)this._package_choices_node=$("kred_package_choices_ul");this._package_choices_node.insert((new Template($(a.package_template_id||(a.discounted_dollar_price!=a.dollar_price?"kred_package_discounted_template":"kred_package_template")).innerHTML)).evaluate(a),{position:"bottom"});a.special_info&&
$("kred_package_special_info_"+a.id).update(this.processPackageSpecialInfo(a.id,a.special_info));a.kred_bonus&&$("kred_bonus_info_"+a.id).show();if(a=$$("#kred_package_"+a.id+" input,type[radio]")[0]){var b=this.populateFormValuesAndSummaries.bind(this);a.observe("click",b);a.observe("change",b)}},processPackageSpecialInfo:function(a,b){if(b.length<100)return b;var c=this,e=new Element("a",{href:"#",id:"show_package_special_info_"+a});e.update("(show important info)");e.observe("click",function(g){c.packageSpecialInfoShowMore(a,
b);Event.stop(g);return false});return e},packageSpecialInfoShowMore:function(a,b){var c=$("kred_package_special_info_hover_"+a),e=$("kred_package_special_info_hover_content_"+a);$("kred_package_special_info_hover_close_"+a).observe("click",function(g){package_picker.hideSpecialInfoHover(a);Event.stop(g);return false});e.update(b);$("kred_package_special_info_"+a).hide();c.show()},hideSpecialInfoHover:function(a){$("kred_package_special_info_hover_"+a).hide();$("kred_package_special_info_"+a).show()},
setPackagesForPurchaseMethod:function(a,b){var c=this;a=this._purchase_methods[a];var e=this._kred_packages.pluck("id"),g=b.pluck("id");a.kred_package_ids=g;b.each(function(l){if(!e.include(l.id)){c._kred_packages.push(l);c.addPackage(l)}})},updatePackageSelectionForPurchaseMethod:function(a){var b=this._purchase_methods[a],c=this.recommendPackage(b);this._kred_packages.each(function(e){var g=$("kred_package_"+e.id);if(g){b.kred_package_ids.include(e.id)?g.show():g.hide();if(g=$("kred_package_radio_"+
e.id))g.checked=e.id==c}})},showPackageSelection:function(a){var b=this.recommendPackage(a),c=$("kred_package_selection");this.hidePackageSelection();a.kred_package_ids.each(function(e){$("kred_package_"+e).show();$("kred_package_radio_"+e).checked=e==b});$("selectPackageButton").show();$("kred_package_choices_wrapper").writeAttribute("class","kred_package_wrapper_"+a.preselect_param);c.show()},kredDeficit:function(){return this._kred_deficit},kredPackageById:function(a){return this._kred_packages.find(function(b){return b.id==
a})},recommendPackage:function(a){var b=this.dynamicPackageRecommendation(a);if(b)return b;if(!this.kredDeficit())return this.defaultRecommendation(a);return a.kred_package_ids.find(function(c){return(c=this.kredPackageById(c))&&c.kred_amount>=this.kredDeficit()}.bind(this))||this.defaultRecommendation(a)},dynamicPackageRecommendation:function(a){if("GameStopCardTransaction"==a.purchase_record_class)if(a.kred_package_ids.include("gs_dynamic_package"))return"gs_dynamic_package";else if(a.kred_package_ids.length<
5)return a.kred_package_ids.last();return null},defaultRecommendation:function(a){return a.preferred_kred_package_id||a.kred_package_ids.last()},hidePackageSelection:function(){$$(".kred_package").each(Element.hide)},selectedPurchaseMethod:function(){return this._purchase_methods[this._selected_payment_option]},selectedKredPackage:function(){var a=this.selectedPurchaseMethod().kred_package_ids.find(function(b){return $("kred_package_radio_"+b).checked});return this._kred_packages.find(function(b){return b.id==
a})},selectPackage:function(){$$(".kred_flow_step").each(Element.hide);var a=this._purchase_methods[this._selected_payment_option];this.recordSelectedPackageAnalytics(a);var b=this,c=this.selectedKredPackage();a=this._package_purchase_selected_callbacks[a.purchase_record_class];this._selected_kred_package=c;this.populateFormValuesAndSummaries();a&&a.each(function(e){e(c,b)});this.showPurchaseForm()},recordSelectedPackageAnalytics:function(a){var b;if("KredPackageCreditCardPurchase"==a.purchase_record_class)b=
this._has_stored_cc?"/kred_lightbox/credit_card/old_stored_card":"/kred_lightbox/credit_card/form";else if("PaypalTransaction"==a.purchase_record_class)b="/kred_lightbox/paypal/waiting_screen";else if("BokuTransaction"==a.purchase_record_class)b="/kred_lightbox/boku/iframe";else if("PaysafeTransaction"==a.purchase_record_class)b="/kred_lightbox/paysafe/iframe";b&&this.recordAnalyticsPageview(b)},populateFormValuesAndSummaries:function(){var a=this,b=this.selectedKredPackage();if(!(!b||"BokuTransaction"==
this._selected_payment_option)){$$(".kred_purchase_form_kred_package_id").each(function(c){c.value=b.id});$$(".kred_purchase_form_kred_package_dollar_price").each(function(c){var e=b.discounted_dollar_price.gsub("$","");c.value=e}.bind(this));$$(".kred_purchase_form_kred_package_kred_amount").each(function(c){c.value=b.kred_amount});$$(".kred_purchase_form_kred_package_item_name").each(function(c){c.value=b.kred_amount+" Kreds"});$$(".kred_purchase_form_kred_package_custom_package_variables").each(function(c){c.value=
a.customPackageVariables()});$$(".kred_purchase_summary_dollar_price").each(function(c){c.update(b.discounted_dollar_price)});$$(".kred_purchase_summary_kred_amount").each(function(c){c.update(b.kred_amount)})}},showPurchaseForm:function(){$("purchase_method_form_"+this._selected_payment_option).show()},addPreselectedPaymentOptionCallback:function(a,b){this._payment_options_preselected_callbacks[a]||(this._payment_options_preselected_callbacks[a]=[]);this._payment_options_preselected_callbacks[a].push(b)},
addSelectedPaymentOptionCallback:function(a,b){this._payment_options_selected_callbacks[a]||(this._payment_options_selected_callbacks[a]=[]);this._payment_options_selected_callbacks[a].push(b)},addSelectedPackageCallback:function(a,b){this._package_purchase_selected_callbacks[a]||(this._package_purchase_selected_callbacks[a]=[]);this._package_purchase_selected_callbacks[a].push(b)},displayCurrency:function(a,b){output="";if($w("USD CAD").include(a))output+="$";output+=b.toFixed(2);if("USD"!=a)output+=
" "+a;return output},setCreditCardAsSelectedPaymentMethod:function(){this._selected_payment_option="KredPackageCreditCardPurchase"},reportKredPurchase:function(a){this.recordAnalyticsPageview("/purchase/kreds?"+Object.toQueryString(a))},recordAnalyticsPageview:function(a){pageTracker&&pageTracker._trackPageview(a)},handleSuccessfulStoredCCExpirationUpdate:function(a){$("update_expired_stored_cc_form").hide();$("stored_cc_expiration_date").update(a);$("stored_cc_form_container").show()},handleFailedStoredCCExpirationUpdate:function(a){$("update_cc_expiration_submit_button").restore();
$("expiration_update_error_message").update(a);$("expiration_update_error_message_block").show()},hasStoredPayPal:function(){return this._has_paypal_billing_agreement},useStoredPayPal:function(){return this._use_stored_paypal},hasStoredCC:function(){return this._has_stored_cc},useStoredCC:function(){return this._use_stored_cc},clearStoredCC:function(){this._has_stored_cc=this._use_stored_cc=false},isVerificationRequired:function(){return this._kav_required},isBlockedForCC:function(){return this._blocked_for_cc},
failedStoredCC:function(){this.clearStoredCC();this.selectPackage()},failStoredPayPal:function(){this._has_paypal_billing_agreement=this._use_stored_paypal=false}};var detect=navigator.userAgent.toLowerCase(),total,thestring,lightbox=Class.create();
lightbox.prototype={yPos:0,xPos:0,initialize:function(a,b){this.wait_for_shutdown=this._activated=false;this.done_class_name="done";if(typeof a=="string"){this.content=a;this.activate()}else{this.content=a.href;a.observer_function=this.activate.bindAsEventListener(this);Event.observe(a,"click",a.observer_function,true);a.onclick=function(){return false}}this._on_close_callbacks=[];b&&this._on_close_callbacks.push(b)},shutdown:function(){if(!this.wait_for_shutdown){this.stopListening();this.deactivate.apply(this,
arguments)}},shutdownWithoutCallbacks:function(){this._on_close_callbacks=[];this.shutdown.apply(this,arguments)},addOnCloseCallback:function(a){if(!this._on_close_callbacks)this._on_close_callbacks=[];this._on_close_callbacks.push(a)},clearOnCloseCallbacks:function(){this._on_close_callbacks=[]},initializeKredTipPurchaseFrame:function(a,b){b&&this.addOnCloseCallback(b);this.addOnCloseCallback(function(){new Ajax.Request(active_user.gamePath()+"/game_tips",{method:"get"})});this.initializeKredPurchaseFrame(a)},
initializeKredItemPurchaseFrame:function(a){top.kredPurchaseSuccess=false;top.kredItemOrderId=undefined;this.addOnCloseCallback(function(b){b=b||{success:false};b.success=!!b.success;if(!b.item_order_id)b.item_order_id=top.kredItemOrderId;try{holodeck.konduit().dispatchEvent({type:"purchase_result",data:b})}catch(c){}});this.initializeKredPurchaseFrame(a)},initializeKredCardCartPurchaseFrame:function(a){this.addOnCloseCallback(function(b){if(b&&b.success)top.location=top.location.href});this.initializeKredPurchaseFrame(a)},
secureUrlForPath:function(a){var b=window.location.host,c=window.lightboxSecureProtocol;if(b.match(/local/)||b.match(/webhop/))c="http://";return c+b+a},initializeKredPurchase:function(a,b){var c=this.secureUrlForPath("/kred_package_purchases/new"),e={};if(a)e.purchase_method=a;if(b)e.tracking_code=b;a=Object.toQueryString(e);if(a.length>0)c=c+"?"+a;this.initializeKredPurchaseFrame(c)},initializeShoutFrame:function(a,b){this.initializeKongregateLightboxFromAjax("/api/new_shout?game_id="+a+"&message="+
b,{done_class_name:"lightbox_login"})},initializeFeedPostFrame:function(a,b,c,e){var g="";$H(e).each(function(l){g+="kv_params["+l[0]+"]="+l[1]+"&"});this.initializeKongregateLightboxFromAjax("/api/feed_post?game_id="+a+"&message="+b+"&image_uri="+c+"&"+g,{done_class_name:"lightbox_login"})},initializeInvitationFrame:function(a,b,c,e){var g="";$H(e).each(function(l){g+="kv_params["+l[0]+"]="+l[1]+"&"});this.initializeKongregateLightboxFromAjax("/api/new_invitation?game_id="+a+"&message="+b+"&filter="+
c+"&"+g,{done_class_name:"lightbox_invite"})},initializeKredPurchaseFrame:function(a){if(!this._kongregate_lightbox_wrapper_template)this._kongregate_lightbox_wrapper_template=new Template($("kongregate_lightbox_wrapper_template").innerHTML);this.staticContent=this._kongregate_lightbox_wrapper_template.evaluate({iframe_src:a});this.done_class_name="kred_purchase";this.activate()},userAuthenticated:function(){if(active_user.isAuthenticated())return true;else{var a="/accounts/new/behind_login";if(typeof holodeck!=
"undefined")a=a+"?game_id="+holodeck.gameId();var b={done_class_name:"lightbox_login"};if(active_user.signinLightboxRegistrationFirst())b.afterStaticContentLoad=lightbox.prototype.toggleRegistration;this.initializeKongregateLightboxFromAjax(a,b);return false}},initializePremiumMembershipPurchase:function(a,b){a=this.secureUrlForPath("/premium_membership_purchases/new?referer="+a);var c=new Template($("kongregate_lightbox_wrapper_template").innerHTML);if(b)a+="&initial_tab="+b;this.staticContent=c.evaluate({iframe_src:a});
this.done_class_name="kred_purchase";this.activate()},initializeKongregateLightboxFromAjax:function(a,b){b||(b={});if(!this._kongregate_lightbox_wrapper_template_noframe)this._kongregate_lightbox_wrapper_template_noframe=new Template($("kongregate_lightbox_wrapper_template_noframe").innerHTML);this.staticContent=this._kongregate_lightbox_wrapper_template_noframe.evaluate({});this.staticContentDivUrl=a;this.afterStaticContentLoad=b.afterStaticContentLoad;if(b.no_class_name==undefined)this.done_class_name=
["kred_purchase"].concat(b.done_class_name||[]).join(" ");this.activate()},initializeKongregateLightboxFromContent:function(a,b){b||(b={});var c=$(document.createElement("div"));c.innerHTML=(new Template($("kongregate_lightbox_wrapper_template_noframe").innerHTML)).evaluate({});c.down("#lightbox_form").update(a);c.down("#kongregate_lightbox_spinner").hide();this.staticContent=c.innerHTML;this.done_class_name=["kred_purchase"].concat(b.done_class_name||[]).join(" ");this.afterStaticContentLoad=b.afterStaticContentLoad;
this.activate()},keyUpHandler:function(a){if(a.keyCode==27){if(this.ajaxRequest){this.ajaxRequest.transport.abort();this.ajaxRequest=null}this.deactivate()}},clickHandler:function(a){if(a.target.id=="overlay"){if(this.ajaxRequest){this.ajaxRequest.transport.abort();this.ajaxRequest=null}this.deactivate()}},activate:function(a){if($("lightbox"))if(!this._activated){this._activated=true;if(!this.done_class_name)this.done_class_name="done";if(Prototype.Browser.IE){this.getScroll();this.prepareIE("100%",
"hidden");this.setScroll(0,0);this.hideSelects("hidden")}typeof holodeck!="undefined"&&CinematicMode.deactivateCinematicMode();this.cachedKeyUpHandler=this.keyUpHandler.bindAsEventListener(this);this.cachedClickHandler=this.clickHandler.bindAsEventListener(this);$(document).observe("keyup",this.cachedKeyUpHandler);$(document).observe("click",this.cachedClickHandler);this.hideHiddenElements();setTimeout(function(){$("lightbox").className="loading";this.displayLightbox("block")}.bind(this),10);a&&typeof a==
"object"&&a.stopPropagation&&a.stopPropagation()}},deactivate:function(){if(this._activated){this._activated=false;this.staticContent=undefined;var a=$("lbContent");a&&a.remove();if(Prototype.Browser.IE){this.setScroll(0,this.yPos);this.prepareIE("auto","auto");this.hideSelects("visible")}$(document).stopObserving("keyup",this.cachedKeyUpHandler);$(document).stopObserving("click",this.cachedClickHandler);this.displayLightbox("none");this.done_class_name="done";(function(b,c){b.onClose.apply(b,c)}).defer(this,
arguments);this.showHiddenElements()}},prepareIE:function(a,b){Prototype.Browser.IE6&&$$("html, body").each(function(c){c.setStyle({height:a,overflow:b})})},hideSelects:function(a){selects=document.getElementsByTagName("select");for(i=0;i<selects.length;i++)selects[i].style.visibility=a},domElementsToHide:function(){return $$("object").concat($$(".ad")).select(function(a){return a&&"konduit"!=a.id&&"gamediv"!=a.id})},hideHiddenElements:function(){this.moveGameDivOffScreen();var a=this._dom_elements_actually_hidden=
[];this.domElementsToHide().each(function(b){if("visible"==b.getStyle("visibility")){a.push(b);Prototype.Browser.Safari503?b.hide():b.setStyle({visibility:"hidden"});b.hiddenByLightbox=true}});this.hideGameInIFrame()},showHiddenElements:function(){this.moveGameDivOnScreen();if(this._dom_elements_actually_hidden){this._dom_elements_actually_hidden.each(function(a){Prototype.Browser.Safari503?a.show():a.setStyle({visibility:"visible"});a.hiddenByLightbox=false});this.showGameInIFrame()}},hideGameInIFrame:function(){},
showGameInIFrame:function(){},shouldMoveGameDiv:function(){return active_user&&active_user.isGamePage()},moveGameDivOffScreen:function(){$("game")&&this.shouldMoveGameDiv()&&$("game").setStyle({top:"-10000px",left:"-10000px"})},moveGameDivOnScreen:function(){$("game")&&this.shouldMoveGameDiv()&&$("game").setStyle({top:"",left:""})},getScroll:function(){if(self.pageYOffset)this.yPos=self.pageYOffset;else if(document.documentElement&&document.documentElement.scrollTop)this.yPos=document.documentElement.scrollTop;
else if(document.body)this.yPos=document.body.scrollTop},setScroll:function(a,b){window.scrollTo(a,b)},reloadInfoFromUrl:function(a,b){if($("lightbox_form")){if(b)$("lightbox").className=b;$("lightbox_form").update("");$("kongregate_lightbox_spinner").show();new Ajax.Updater("lightbox_form",a,{method:"get",evalScripts:true,onComplete:function(){Element.hide("kongregate_lightbox_spinner");this.afterStaticContentLoad&&this.afterStaticContentLoad();this.afterStaticContentLoad=undefined}.bind(this)})}},
displayLightbox:function(a){$("overlay").style.display=a;$("lightbox").style.display=a;a!="none"&&this.loadInfo()},loadInfo:function(){if(this.staticContent){this.renderContents(this.staticContent);this.staticContent=undefined;if(this.staticContentDivUrl){this.ajaxRequest=new Ajax.Updater("lightbox_form",this.staticContentDivUrl,{method:"get",evalScripts:true,onComplete:function(){Element.hide("kongregate_lightbox_spinner");this.afterStaticContentLoad&&this.afterStaticContentLoad();this.afterStaticContentLoad=
undefined}.bind(this)});this.staticContentDivUrl=undefined}else{this.afterStaticContentLoad&&this.afterStaticContentLoad();this.afterStaticContentLoad=undefined}}else new Ajax.Request(this.content,{method:"get",parameters:"",onComplete:this.processInfo.bindAsEventListener(this)})},processInfo:function(a){this.renderContents(a.responseText)},renderContents:function(a){a="<div id='lbContent'>"+a+"</div>";var b=$("lbLoadMessage");new Insertion.Before(b,a);b.hide();$("lightbox").className=this.done_class_name;
this.actions()},actions:function(){lbActions=document.getElementsByClassName("lbAction");var a=document.getElementById("username");a&&Prototype.Browser.Gecko&&Prototype.Platform.Macintosh&&a.focus();for(i=0;i<lbActions.length;i++){Event.observe(lbActions[i],"click",this[lbActions[i].rel].bindAsEventListener(this),false);lbActions[i].onclick=function(){return false}}},insert:function(a){link=Event.element(a).parentNode;Element.remove($("lbContent"));new Ajax.Request(link.href,{method:"post",parameters:"",
onComplete:this.processInfo.bindAsEventListener(this)})},toggleRegistration:function(){var a=$("lightbox"),b=$("lightboxlogin"),c=$("lightboxregister"),e,g,l;if(c.style.display=="block"){e="none";g="block";l="kred_purchase lightbox_login";active_user.focusFormField("username")}else{e="block";g="none";l="kred_purchase";active_user.focusFormField("user_username")}if(b)b.style.display=g;c.style.display=e;a.className=l;if(pageTracker){pageTracker._trackEvent("Registration","begin_create");pageTracker._trackPageview("/accounts/begin_create")}},
onClose:function(){if(this._on_close_callbacks)for(var a=arguments;this._on_close_callbacks.length>0;)this._on_close_callbacks.pop().apply(this,a);this._on_close_callbacks=[]},stopListening:function(){$$(".lbOn").each(function(a){a.stopObserving("click",a.observer_function,true);a.getElementsBySelector("a").each(function(b){if(b.original_onclick){b.onclick=b.original_onclick;b.original_onclick=null}})})}};
function initialize(){addLightboxMarkup();lbox=document.getElementsByClassName("lbOn");for(i=0;i<lbox.length;i++)valid=new lightbox(lbox[i])}
function addLightboxMarkup(){bod=document.getElementsByTagName("body")[0];overlay=document.createElement("div");overlay.id="overlay";lb=document.createElement("div");lb.id="lightbox";lb.className="loading";lb.innerHTML='<div id="lbLoadMessage"><p><img src="/images/presentation/indicator.gif" class="indicator" style="width: 16px; height: 16px;" /> Loading</p></div>';bod.appendChild(overlay);bod.appendChild(lb)};var NoteWatcher={watch:function(){var a=$("note"),b=$("submit");if(a.value!="")b.enable();else{b.disable();a.focus()}},setFocus:function(){$("note")&&$("note").focus()}};var NativeApp=function(){var a={};a.isInstalled=function(b){return a.isNativeApp()?kongNativeApp.isInstalled(b):false};a.isNativeApp=function(){return typeof kongNativeApp!="undefined"};a.downloadGame=function(b){if(a.isNativeApp())window.open(b);else window.location=b};a.launchGame=function(b){a.isNativeApp()&&kongNativeApp.sendMessage(JSON.stringify({opcode:"launch_game",params:{game_id:b}}))};a.browseGames=function(){window.location=a.isNativeApp()?"/games/index_native?installed="+kongNativeApp.getInstalledGameIds():
"/games/index_native"};return a}();function NewsPostBox(){this.initialize()}
NewsPostBox.prototype={initialize:function(){this._spinner=$("news_post_box_submission_button_spinner");this._submit_button=$("news_post_box_submission_button");this._text_area=$("game_news_feed_item_content")},onSuccess:function(a){new Ajax.Request("/feed_items/"+a,{method:"get",onSuccess:function(b){this._text_area.setValue("");this.onComplete();$("news_post_success_message").update("Your update has been posted.").show();$("news_post_error_message").update("").hide();containers=$$(".js_news_posts");
containers.each(function(c){c.insert({top:b.responseText});new Effect.Highlight(c.down(".js_feed_item"));c.down(".js_feed_item")&&c.down(".js_feed_item").next(4)&&c.down(".js_feed_item").next(4).hide()});$("news_post_box").hide();$("news_post_link").show()}.bind(this),onFailure:function(){this.onFailure("Shout successfully created, but failed to update page.")}.bind(this)})},onFailure:function(a){$("news_post_error_message").update(a).show();this.onComplete()},onComplete:function(){this._spinner.hide();
this._submit_button.show()},deletePost:function(a){var b=$$(".js_delete_post_button_"+a),c=$$(".js_delete_post_spinner_"+a),e=$$(".js_game_post_"+a),g=$$(".js_news_item_error_message");b.invoke("hide");c.invoke("show");new Ajax.Request("/feed_items/"+a,{method:"delete",onSuccess:function(){c.invoke("hide");g.invoke("hide");e.each(function(l){new Effect.Fade(l,{duration:1})})}.bind(this),onFailure:function(){g.each(function(l){l.update("Failed to delete news item").show()});b.invoke("show");c.invoke("hide");
e.each(function(l){new Effect.Highlight(l,{startcolor:"#cc3333"})})}.bind(this)})}};d=document;ndc=[];coc=[];kg=true;function zelph_onDOMload(a,b){es=zelph_getElementsBySelector(a);if(ndc[a]==null){ndc[a]=0;coc[coc.length]="zelph_onDOMload('"+a+"', '"+b+"')"}if(es.length>ndc[a]){nes=es.length;for(var c=ndc[a];c<nes;c++){theTarget=es[c];eval(b)}ndc[a]=nes}kg==true&&setTimeout("zelph_onDOMload('"+a+"', '"+b+"')",100);return true}
function zelph_getElementsBySelector(a){var b=[];var c=b="",e=a,g=[];if(a.indexOf(" ")>0){b=a.split(" ");c=b[0].split("#");if(c.length==1)return g;if(d.getElementById(c[1]))return d.getElementById(c[1]).getElementsByTagName(b[1]);return false}if(a.indexOf("#")>0){b=a.split("#");e=b[0];b=b[1]}if(b!=""){if(d.getElementById(b)){g.push(d.getElementById(b));return g}return false}if(a.indexOf(".")>0){b=a.split(".");e=b[0];c=b[1]}b=d.getElementsByTagName(e);if(c=="")return b;for(a=0;a<b.length;a++){curClass=
" "+b[a].className+" ";curClass.indexOf(" "+c+" ")!="-1"&&g.push(b[a])}return g}function zelph_stopIt(){kg="";for(x=0;x<coc.length;x++)eval(coc[x])}function zelph_addLoadEvent(a){var b=window.onload;window.onload=typeof window.onload!="function"?a:function(){b();a()}}zelph_addLoadEvent(zelph_stopIt);var PaymentHelpText={showHelpText:function(a,b){var c=$("help_wrapper");b=$(b);if(!(a==""||a==null))if(b.className!="error_msg"){b.appendChild(c);$("help_text").innerHTML=a;c.show()}},hideHelpText:function(){$("help_wrapper").hide()}};function PostMessageHandler(a){function b(){return r}function c(u){var t;r.find(function(G){return t=G(u)});if(t)t();else try{bumper.embedAd(u)}catch(v){}}function e(u){c.defer(u.evalJSON())}function g(u){r.push(u)}function l(u){if(u.origin==window.location.protocol+"//"+window.location.host)try{e(u.data)}catch(t){}}var r=[];window.attachEvent?window.attachEvent("onmessage",l):window.addEventListener("message",l,false);return{addCallback:g,getHandlers:b,runCallbackForUnparsedPayload:e}};VALID_LOYALTY_CARD_NUMBER_LENGTH=12;VALID_LOYALTY_CARD_NUMBER_LENGTH_MAX=14;window.onPowerupRewardsLinkFailure=function(a){$("create_powerup_rewards_account_submit").restore();$("powerup_rewards_link_info").hide();if(a.match(/must be activated/)){a=a.split(". ");$("powerup_rewards_link_error_message").update(a[0]+".");$("please_check_number_content").update(a[1])}else $("powerup_rewards_link_error_message").update(a);$("powerup_rewards_link_errors").show()};
window.validatePowerupRewardsLoyaltyNumber=function(a){var b=a.length;if(window.luhn(a)&&(b>=VALID_LOYALTY_CARD_NUMBER_LENGTH||b<=VALID_LOYALTY_CARD_NUMBER_LENGTH_MAX)){$$("#powerup_rewards_link_errors,#powerup_rewards_link_info").each(Element.hide);return true}else{onPowerupRewardsLinkFailure("Loyalty card number is an invalid format");return false}};
window.luhn=function(a){var b=[[0,2,4,6,8,1,3,5,7,9],[0,1,2,3,4,5,6,7,8,9]],c=0;a.toString().replace(/\D+/g,"").replace(/[\d]/g,function(e,g,l){c+=b[l.length-g&1][parseInt(e,10)]});return 0===c%10&&c>0};
window.startPollingOnWork=function(a,b){var c=window.parent,e=c.powerupRewardsPoller,g=c.powerupRewardsPollerTimeout;e&&e.stop();g&&c.clearTimeout(g);e=new c.Ajax.Poller("/accounts/"+a+"/powerup_rewards/show_work?id="+b,{on200:function(l){g&&c.clearTimeout(g);e.stop();if(l.responseJSON.success){c.$("powerup_rewards_link_in_progress").hide();c.$("powerup_rewards_link_success").show();top.kredPurchaseSuccess=true;window.kongMobileApp&&window.kongMobileApp.dispatchEvent("power_up_rewards_account_linked",
"")}else c.onPowerupRewardsLinkFailure(l.responseJSON.message)}});g=c.setTimeout(function(){e.stop();c.onPowerupRewardsLinkFailure("Linking your account timed out, please try again later.")},12E4);c.powerupRewardsPollerTimeout=g;c.powerupRewardsPoller=e;e.start()};PremiumOnlyLinks={attachHandlers:function(){$$("a.premium_only").each(function(a){var b=a.onclick?a.onclick.bind(a):null;a.onclick=PremiumOnlyLinks.capturedSelectorWrapper.bindAsEventListener(active_user,b)});$$(".premium_icon").each(function(a){a.observe("click",function(){active_user.isPremium()||(a.up(".game")?lightbox.prototype.initializePremiumMembershipPurchase("beta_game","beta_tab"):lightbox.prototype.initializePremiumMembershipPurchase("username_icon","icon_tab"))})});active_user.isPremium()||
active_user.createCSS(".premium_icon","cursor: pointer");active_user.addRunWhenAuthenticatedObserver(function(){active_user.isPremium()&&active_user.createCSS(".premium_icon","cursor: default")})},capturedSelectorWrapper:function(a,b){var c="function"==typeof b;if(this.isPremium()){if(c)return b(a)}else{lightbox.prototype.initializePremiumMembershipPurchase("beta_game","beta_tab");Event.stop(a);return false}}};ProfileGearControl=function(a){this.initialize(a)};
ProfileGearControl.prototype={initialize:function(a){this._rollover_delay=a.rollover_delay||0.2;this._hover_target=$(a.hover_target_id);this._container=$(a.container_id);this._target_hovering_class=a.target_hovering_class;if(this._hover_target&&this._container){var b=this;this._hover_target.observe("mouseover",function(){b.onMouseOver()});this._container.observe("mouseover",function(){b.onMouseOver()});this._hover_target.observe("mouseout",function(){b.onMouseLeave()});this._container.observe("mouseout",
function(){b.onMouseLeave()})}},clearTimer:function(){this._reset_timer&&clearTimeout(this._reset_timer);this._reset_timer=null},showDropdown:function(){this._target_hovering_class&&this._hover_target.addClassName(this._target_hovering_class);this._container.show()},closeDropdown:function(){this._target_hovering_class&&this._hover_target.removeClassName(this._target_hovering_class);this._container.hide()},onMouseLeave:function(){this.clearTimer();this._waiting=false;this._reset_timer=this.closeDropdown.bind(this).delay(this._rollover_delay)},
onMouseOver:function(){this.clearTimer();if(this._waiting)this._reset_timer=this.showDropdown.bind(this).delay(this._rollover_delay);else{this._waiting=true;this._reset_timer=this.showDropdown.bind(this).delay(0)}}};function ProfileShoutBox(a){this.initialize(a)}
ProfileShoutBox.prototype={initialize:function(a){var b=a.submit_button_id||"shout_box_submission_button";this._shout_box=$(a.shout_box_id||"shout_content");this._submit_button=$(b);this._spinner=$(b+"_spinner");this._long_width=a.long_width||100;this._short_width=a.short_width||90;this.addShoutBoxObservers()},addShoutBoxObservers:function(){this._shout_box.observe("focus",this.onFocus.bind(this));this._shout_box.getValue()&&this.onFocus()},onFocus:function(){active_user.isAuthenticated()?this._shout_box.setAttribute("cols",
this._short_width):active_user.activateInlineLogin({},true)},onSuccess:function(a){new Ajax.Request("/feed_items/shout/"+a,{onSuccess:function(b){this._submit_button.show();this._shout_box.setValue("");this._spinner.hide();$("shout_error_message").update("");container=$("feed_items_container");container.insert({top:b.responseText});feedHandler.setFirstFeedItemClass();new Effect.Highlight(container.down(".feed_item"));$("empty_activit_feed")&&$("empty_activit_feed").remove()}.bind(this),onFailure:function(){this.onFailure("Shout successfully created, but failed to update feed.")}})},
onFailure:function(a){$("shout_error_message").update(a).show();this._submit_button.show();this._spinner.hide()}};var ProgressBar=function(a,b){b||(b={});this.value=b.value||0;this.maxValue=b.maxValue||100;a.addClassName("progress-bar");this.bar=new Element("div",{"class":"progress-bar-bar"});a.insert(this.bar);this.label=new Element("span",{"class":"progress-bar-label"});this.bar.insert(this.label);this.updateDisplay()};ProgressBar.prototype.setValue=function(a){this.value=a;this.updateDisplay()};ProgressBar.prototype.setMaxValue=function(a){this.maxValue=a;this.updateDisplay()};
ProgressBar.prototype.updateDisplay=function(){this.label.update('<a href="/accounts/'+active_user.getAttributes().username+'/points">'+this.value+" PTS</a>");var a=this.value/this.maxValue*100;this.bar.setStyle({width:a+"%"});a<25&&this.label.addClassName("low_value")};function QuickPick(a){this.initialize(a)}
QuickPick.prototype={initialize:function(a){this._destination=a.destination;this._template=a.template;this._destination.down()},setQuickPicks:function(a){this._quick_picks=a.map(function(b){b.plays=b.plays.withDelimiters()+" plays";return b});this._last_pick=parseInt(Math.random()*a.length,10)},pickOne:function(){this._last_pick=(this._last_pick+1)%this._quick_picks.length;this._destination.update(this._template.evaluate(this._quick_picks[this._last_pick]))},spin:function(a,b,c){if(0==arguments.length)this.spin(10,
1.4,300);else{this.pickOne();a<c&&setTimeout(this.spin.bind(this,a*b,b,c),a)}if(!this._ever_spun){this._ever_spun=true;this.prefetchIcons()}},prefetchIcons:function(){var a=$(document.body);this._quick_picks.each(function(b){a.insert(new Element("img",{src:b.icon,style:"display:none"}))})}};RegistrationFormValidator=function(a,b){function c(G,q){if(G.getValue()==""){r(G,tr8nProxy.tr(q+" can't be blank"));return false}return true}function e(G,q,D){if(G.getValue().length<D){r(G,tr8nProxy.tr(q+" is too short, needs to be {minimum||character, characters} or longer","",{minimum:D}));return false}return true}function g(G){if(!G.getValue().match(RFC822SingleEmailRegex)){r(G,tr8nProxy.tr("Invalid email address"));return false}return true}function l(G,q){$(G).up("div.form_block, dl").down(".error_block").insert((new Element("span",
{"class":"name_validation validation_symbol",id:"availability_success"})).update(q||"&nbsp;"))}function r(G,q){G=$(G).up("div.form_block, dl").down(".error_block");var D=G.down("ul");if(!D){D=new Element("ul");G.insert(D)}D.insert((new Element("li")).update(q))}function u(G){$(G).up("div.form_block, dl").down(".error_block").innerHTML=""}function t(G){return G.sub("%s",b.fieldIdPrefix)}b||(b={});if(!b.fieldIdPrefix)b.fieldIdPrefix="user";var v=a.down(t("input#%s_username"));new AvailabilityCheck(v,
{clear:function(){u(v);v.removeClassName("with_error")},success:function(){l(v,tr8nProxy.tr("Username available!"))},failure:function(G){v.addClassName("with_error");r(v,G)},generatedUsername:b.generatedUsername,validateLength:true});$(t("%s_password")).observe("blur",function(G){G=G.element();u(G);if(c(G,"Password")&&e(G,"Password",5)){G.removeClassName("with_error");l(G)}else G.addClassName("with_error")});$(t("%s_email_address")).observe("blur",function(G){G=G.element();u(G);if(c(G,"Email address")&&
g(G)){G.removeClassName("with_error");l(G)}else G.addClassName("with_error")})};function ShareWithUsersTab(a,b,c){this.initialize(a,b,c)}
ShareWithUsersTab.prototype={initialize:function(a,b,c){this._share_dialog=b;this._tab_id=a;this._current_page=0;this._request_more_func=c;$(a+"_tab").observe("click",this.handleShowTab.bindAsEventListener(this))},getMore:function(){this._current_page++;this._request_more_func();$(this._tab_id+"_indicator").show()},handleShowTab:function(){this.refreshSelected()},handleScroll:function(){if($(this._tab_id).scrollTop+$(this._tab_id).getHeight()>=$(this._tab_id).scrollHeight){Event.stopObserving($(this._tab_id),
"scroll");this.getMore()}},onRequestSuccess:function(){$(this._tab_id).observe("scroll",this.handleScroll.bindAsEventListener(this))},onRequestComplete:function(){$(this._tab_id+"_indicator").hide();this.refreshSelected()},refreshSelected:function(){for(var a=$(this._tab_id).select(".user"),b=0;b<a.length;++b){var c=a[b].select("#recipient_ids_").first();c.checked=this._share_dialog.isSelected(c.value);this._share_dialog.isSelected(c.value)?a[b].addClassName("selected"):a[b].removeClassName("selected")}}};
function ShareWithFriendsDialog(a){this.initialize(a)}
ShareWithFriendsDialog.prototype={initialize:function(a){this._selected_users=[];this._user_limit=a;this._error_msg_timer=this._search_box_timer=null;$("max_users_error").hide();$("new_game_invite_feed_item").setAttribute("action","javascript:;")},setRequestFunctions:function(a,b,c){this._friends_tab=new ShareWithUsersTab("share_with_friends",this,a);this._friends_tab.getMore();this._fans_tab=new ShareWithUsersTab("share_with_fans",this,b);this._fans_tab.getMore();this._chat_members_tab=new ShareWithUsersTab("share_with_chat_members",
this,c);this._chat_members_tab.getMore()},toggleSelected:function(a,b){var c=this.findSelected(a),e=false;if(c>-1){this._selected_users.splice(c,1);e=true;$("error_messages").update("")}else if(this._selected_users.length<this._user_limit){c={};c.user_id=a;c.username=b;this._selected_users.push(c);e=true;$("error_messages").update("")}else if(this._selected_users.length>=this._user_limit){$("max_users_error").show();$("max_users_error").removeClassName("hidden");this._error_msg_timer!=null&&clearTimeout(this._search_box_timer);
this._error_msg_timer=setTimeout(function(){this._error_msg_timer=null;$("max_users_error").hide()},2500)}this._friends_tab.refreshSelected();this._fans_tab.refreshSelected();this._chat_members_tab.refreshSelected();$("selected_users").update(this.selectedUsersMessage());$("recipients").value=this.getSelectedUserIds();return e},selectedUsersMessage:function(){var a=this._selected_users.length;return a==0?"no users selected":a==1?this._selected_users[0].username+" selected":a==2?this._selected_users[0].username+
" and "+this._selected_users[1].username+" selected":a==3?this._selected_users[0].username+", "+this._selected_users[1].username+" and "+this._selected_users[2].username+" selected":a==4?this._selected_users[0].username+", "+this._selected_users[1].username+", "+this._selected_users[2].username+" and 1 other user selected":this._selected_users[0].username+", "+this._selected_users[1].username+", "+this._selected_users[2].username+" and "+(a-3)+" other users selected"},refreshSearchDropdown:function(){for(var a=
$$(".recipient_chooser").first().select(".user"),b=0;b<a.length;++b)this.isSelected(eval("("+a[b].down(".metadata").innerHTML+")").user_id)?a[b].addClassName("chosen"):a[b].removeClassName("chosen")},searchUserSelected:function(a){var b=shareWithFriendsDialog.toggleSelected(a.user_id,a.username);$("recipient_search").value="";if(b){$("recipient_search_container").hide();if(this.isSelected(a.user_id))$("recipient_list_updated_msg").innerHTML=a.username+" was added to the recipient list";else $("recipient_list_updated_msg").innerHTML=
a.username+" was removed from the recipient list";$("recipient_list_updated_msg").show();this._search_box_timer!=null&&clearTimeout(this._search_box_timer);this._search_box_timer=setTimeout(function(){this._search_box_timer=null;$("recipient_list_updated_msg").hide();$("recipient_search_container").show()},2500)}},findSelected:function(a){for(var b=0;b<this._selected_users.length;b++)if(this._selected_users[b].user_id==a)return b;return-1},isSelected:function(a){return this.findSelected(a)>-1},getSelectedUserIds:function(){for(var a=
"",b=0;b<this._selected_users.length;++b){a+=this._selected_users[b].user_id;if(b+1<this._selected_users.length)a+=","}return a}};SharedLinksController=function(a){this.container=$(a.id);this.select=this.container.down("select");this.checkbox=this.container.down("input[type=checkbox]");this.reload=this.container.down(".shared_link_reload");this.url=a.url;this.out_of_links=this.fetching=false;this.shown_items=0;this.addFormHandlers();this.addShowMoreHandler();this.addScrollHandler()};
SharedLinksController.prototype={fetch:function(a){if(!this.fetching){this.fetching=true;var b=this,c=this.container.down("ul");$("shared_link_list_container");var e=this.select.getValue();a||(a={});if(e!="All")a.shared_link_type_id=e;new Ajax.Request(b.url,{method:"get",parameters:a,onCreate:function(){c.insert((new Element("li",{id:"shared_links_loading"})).insert((new Element("span",{"class":"spinner spinner_big"})).update("Loading...")));b.hideShowMoreLink()},onComplete:function(){$("shared_links_loading").remove();
b.fetching=false},onSuccess:function(g){g=$A(g.responseJSON);var l;g.each(function(r){l=b.renderLink(r);c.insert(l);if(b.showHidden()||!l.hasClassName("visited"))b.shown_items++});if(g.length>0)b.maxId=g.last().id;b.showShowMoreLink();if(g.length<25){b.out_of_links=true;b.shown_items=0}else{b.out_of_links=false;if(b.shown_items<17){b.fetching=false;b.fetch({max_id:b.maxId})}else b.shown_items=0}}})}},renderLink:function(a){var b=$.jStorage.get(this.storageKey(a)),c=new Element("li",{id:"shared_link_"+
a.id,"class":"shared_link"}),e=(new Element("a",{"class":"shared_title_link"})).update(a.name),g;if(b){c.addClassName("visited");this.showHidden()||c.hide()}e.observe("click",this.handleClick.bindAsEventListener(this,a,c));c.insert((new Element("div",{"class":"shared_link_title truncate_one_line"})).insert(e));c.observe("click",function(){c.hasClassName("open")?c.removeClassName("open"):c.addClassName("open")});if(a.additional_params){c.addClassName("expandable");g=new Element("dl",{"class":"link_info mvm"});
$H(a.additional_params.evalJSON()).each(function(l){g.insert((new Element("dt",{"class":"truncate_one_line"})).update(l.key.stripTags()));g.insert((new Element("dd",{"class":"truncate_one_line"})).update(l.value.toString().stripTags()))});c.insert(g)}return c},handleClick:function(a,b,c){if($("gameiframe"))activateGame(b.link_params);else{a=$H(document.location.search.toQueryParams()).merge(b.link_params.toQueryParams()).toQueryString();window.open(document.location.pathname+"?"+a,"_blank")}$.jStorage.set(this.storageKey(b),
true,{TTL:b.ttl});c.addClassName("visited");this.showHidden()||c.hide()},addFormHandlers:function(){var a=this.container.down("ul");this.select.observe("change",function(){a.update();this.maxId=0;this.hideShowMoreLink();this.fetch()}.bind(this));this.reload.observe("click",function(){a.update();this.maxId=0;this.hideShowMoreLink();this.fetch()}.bind(this));this.checkbox.observe("change",function(){a.select("li.visited").invoke(this.checkbox.getValue()=="Y"?"show":"hide")}.bind(this))},addShowMoreHandler:function(){$("shared_link_show_more").observe("click",
function(){this.fetch({max_id:this.maxId});this.hideShowMoreLink()}.bind(this))},showShowMoreLink:function(){$("shared_link_show_more").show()},hideShowMoreLink:function(){$("shared_link_show_more").hide()},storageKey:function(a){return active_user.gameId()+"-"+a.id},addScrollHandler:function(){var a=$("shared_link_show_more"),b=0,c=$("shared_link_list_container");c.observe("scroll",function(){var e=c.scrollTop==0?c.parentNode.scrollTop:c.scrollTop;!this.out_of_links&&e+window.innerHeight>a.positionedOffset().top&&
e>b&&this.fetch({max_id:this.maxId});b=e}.bind(this))},showHidden:function(){return this.checkbox.getValue()=="Y"}};var Shim={shimElement:function(a){var b=$("shim")||this.createShim();b.show();b.absolutize();b.clonePosition(a);this.hideIframe()},hide:function(){var a=$("shim");a&&a.hide();this.showIframe()},createShim:function(){var a=new Element("iframe",{id:"shim",style:"display:none; z-index:1000000 ; border: 0;"});a.setOpacity(0);document.body.insert({top:a});return a},hideIframe:function(){var a=$("gameiframe");a&&!a.hasClassName("dont_hide")&&a.up("#game").setStyle({top:"-10000px",left:"-10000px"})},showIframe:function(){var a=
$("gameiframe");a&&!a.hasClassName("dont_hide")&&a.up("#game").setStyle({top:"",left:""})}};var SiteStatsUpdater=function(){var a=new Template("<strong>#{users_online_count_with_delimiter}</strong> online playing <strong>#{games_count_with_delimiter}</strong> free games!"),b=new Template('<a onclick="holodeck.showChatTab(); return false;" href="#" class="spritegame">Join #{people_online_text} in chat right now!</a>');return{update:function(){(function(){new Ajax.Request("/site_stats.json",{method:"get",onSuccess:function(c){c=c.responseJSON;$("playing").update(a.evaluate(c));$("holodeck_chat_promotion")&&
$("holodeck_chat_promotion").update(b.evaluate(c));if(ls)try{pageTracker._trackEvent("LoadTime","SiteStatsFinished",document.location.pathname,(new Date).getTime()-ls)}catch(e){}}})}).runWhenDomLoaded(true)}}}();function SkinChooser(a){this.initialize(a)}
SkinChooser.prototype={initialize:function(a){this._current_skin_class=a||"";this._default_style="background:#eee url(/images/presentation/new_homepage_background.png) repeat-x 0 0;";Roller.rolodex.user_skin_chooser=new Roller({scrollablePane:"user_skin_chooser_scrollable",scrollDuration:500,container:"user_skin_chooser_container",showDots:false});try{$("new_user_skin").down(".scroll_left").observe("click",function(){Roller.rolodex.user_skin_chooser.scrollToPreviousPaneAndStop()});$("new_user_skin").down(".scroll_right").observe("click",
function(){Roller.rolodex.user_skin_chooser.scrollToNextPaneAndStop()})}catch(b){}},updateSkin:function(a,b,c){if(!$("skins_pod_spinner").visible()){$("skins_pod_spinner").show();$("user_skin_skin_id").value=a;$("new_user_skin").onsubmit();$("primarywrap").setStyle(b);this.setBodyClass(c);$("new_user_skin").hide()}},setDefault:function(){if(!$("skins_pod_spinner").visible()){$("skins_pod_spinner").show();$("new_user_skin").hide()}this.setBodyClass("");$("primarywrap").setStyle(this._default_style)},
setBodyClass:function(a){var b=$$("body").first();b.removeClassName(this._current_skin_class);this._current_skin_class=a;b.addClassName(this._current_skin_class)},onSkinSet:function(){$("skins_pod_spinner").hide();$("new_user_skin").show()}};Element.addMethods({textNodes:function(a){return $A(a.childNodes).map(function(b){return b.nodeType==3?[b]:b.nodeType==1?$(b).textNodes():[]}).flatten()},splitLongWords:function(a){var b=/\S{30,}/,c=function(){return Prototype.Browser.IE?document.createElement("wbr"):document.createTextNode(String.fromCharCode(8203))};a.textNodes().each(function(e){var g=e.parentNode;e=e;for(var l;(l=e.nodeValue.search(b))>=0;)if(/http:/.test(e.nodeValue.substr(0,l+30)))if(/^\s/.test(e.nodeValue)){l=e.nodeValue.search(/\S/);
e=e.splitText(l)}else if((l=e.nodeValue.search(/\s+/))>=0)e=e.splitText(l);else return;else{e=e.splitText(l+30);g.insertBefore(c(),e)}})}});document.observe("dom:loaded",function(){$$(".splittext").invoke("splitLongWords")});function addDOMLoadEvent(a){if(!window.__load_events){var b=function(){if(!arguments.callee.done){arguments.callee.done=true;if(window.__load_timer){clearInterval(window.__load_timer);window.__load_timer=null}for(var c=0;c<window.__load_events.length;c++)window.__load_events[c]();window.__load_events=null}};document.addEventListener&&document.addEventListener("DOMContentLoaded",b,false);if(/WebKit/i.test(navigator.userAgent))window.__load_timer=setInterval(function(){/loaded|complete/.test(document.readyState)&&
b()},10);window.onload=b;window.__load_events=[]}window.__load_events.push(a)}
function tabset(){if(!document.getElementById)return false;var a=document.getElementsByTagName("dl");for(k=0;k<a.length;k++){var b=a[k];if(b.className.indexOf("tabset")!=-1){var c=0,e=b.getElementsByTagName("dd");for(i=0;i<e.length;i++)if(e[i].parentNode==b){if(i==0)var g=e.item(0);else e[i].style.display="none";e[i].count=c++}c=[];e=b.getElementsByTagName("dt");for(i=0;i<e.length;i++)if(e[i].parentNode==b)c[c.length]=e[i];b=[];for(i=0;i<c.length;i++){if(!c[i].transformed_to_tab){c[i].transformed_to_tab=
true;c[i].count=i;c[i].onclick=toggleDt;c[i].innerHTML="<a href='#' title='"+c[i].innerHTML+"'>"+c[i].innerHTML+"</a>";c[i].parentNode.removeChild(c[i]);g.parentNode.insertBefore(c[i],g)}if(c[i].className.indexOf("active")>=0)b[b.length]=c[i]}for(i=0;i<b.length;i++)b[i].onclick()}}}
function toggleDt(){var a=this.parentNode.getElementsByTagName("dt");for(i=0;i<a.length;i++)if(this==a[i]&&this.className.indexOf("dormant")>=0&&this.className.indexOf("active")==-1&&a[i].parentNode==this.parentNode){this.className+=" active";this.className=this.className.replace(/(?:^\s*|\s*$)/,"")}else if(this!=a[i]&&a[i].parentNode==this.parentNode)a[i].className=a[i].className.replace("active","dormant");a=this.parentNode.getElementsByTagName("dd");for(i=0;i<a.length;i++)if(a[i].parentNode==this.parentNode)a[i].style.display=
this.count==a[i].count?"block":"none";return false}addDOMLoadEvent(tabset);TimeInWordsHelper={distanceInWords:function(a,b,c){a=a.getTime();b=b.getTime();b=Math.round(Math.abs(a-b)/1E3);a=Math.round(b/60);if(a<=1){if(!c)return 0==a?"less than a minute":"1 minute";if(b<5)return"less than 5 seconds";if(b<10)return"less than 10 seconds";if(b<20)return"less than 20 seconds";if(b<40)return"half a minute";if(b<60)return"less than a minute";return"1 minute"}if(a<45)return a+" minutes";if(a<90)return"1 hour";if(a<1440)return Math.round(a/60)+" hours";if(a<2880)return"1 day";if(a<
43200)return Math.round(a/1440)+" days";if(a<86400)return"about 1 month";if(a<525600)return Math.round(a/43200)+" months";if(a<1051200)return"about 1 year";return"over "+Math.round(a/525600)+" years"},distanceInWordsFromNow:function(a,b){return TimeInWordsHelper.distanceInWords(new Date,a,b)}};TippingPointMeter=function(a){this.initialize(a)};
TippingPointMeter.prototype={initialize:function(a){this._target_node=$(a.target_node_id);this._current_value=a.current_value||0;this._max_value=a.max_value||100;this._value_label=a.value_label;this._meter_node=this._target_node.down(".meter");this._meter_node.addClassName("tipping-point-meter");this._bar_ele=new Element("div",{"class":"tipping-point-meter-bar"});this._meter_node.insert(this._bar_ele);this._label_ele=this._target_node.down(".number_gifts");this._label_ele.update(this._value_label);
this._bar_ele.setStyle({width:this._current_value/this._max_value*100+"%"})}};function TrackingCodeService(a){var b=a.dataProvider,c=a.pageTracker,e={},g=function(){r(b().tracking_code,function(t){c._trackPageview(t);(t=u(t))&&c._trackEvent(t[0],t[1])});b().tracking_code=undefined},l=function(){r(b().minor_tracking_code,function(t){(t=u(t))&&c._trackEvent(t[0],t[1])});b().minor_tracking_code=undefined},r=function(t,v){if(t&&c){var G=(new Date).getTime(),q=e[t];if(!q||G-q>15E3){e[t]=G;v(t)}}},u=function(t){if(!t)return null;if((t=t.match(/^\/([^\/]*)\/(.*)$/))&&3==t.length)return[TrackingCodeService.TRACKING_CODE_EVENT_CATEGORIES[t[1]],
t[2]]};a=function(){g();l()};a();return{reportTrackingCode:a}}TrackingCodeService.TRACKING_CODE_EVENT_CATEGORIES={games:"GameSubmission",accounts:"Registration",sessions:"Sessions"};function autoInit_trees(){for(var a=document.getElementsByTagName("ul"),b=0;b<a.length;b++)if(a[b].className&&a[b].className.indexOf("tree")!=-1){initTree(a[b]);a[b].className=a[b].className.replace(/ ?unformatted ?/," ")}}
function initTree(a){var b,c,e,g,l,r,u;for(b=0;b<a.childNodes.length;b++)if(a.childNodes[b].tagName&&a.childNodes[b].tagName.toLowerCase()=="li"){var t=a.childNodes[b];e=document.createElement("span");c=document.createElement("span");g=document.createElement("span");e.appendChild(c);c.appendChild(g);e.className="a "+t.className.replace("closed","spanClosed");e.onMouseOver=function(){};c.className="b";c.onclick=treeToggle;g.className="c";r=t.childNodes.length;l=0;u=null;for(c=0;c<t.childNodes.length;c++)if(t.childNodes[c].tagName&&
t.childNodes[c].tagName.toLowerCase()=="div")l=c+1;else if(t.childNodes[c].tagName&&t.childNodes[c].tagName.toLowerCase()=="ul"){u=t.childNodes[c];r=c;break}for(c=l;c<r;c++)g.appendChild(t.childNodes[l]);t.childNodes.length>l?t.insertBefore(e,t.childNodes[l]):t.appendChild(e);if(u!=null)if(initTree(u)){addClass(t,"children","closed");addClass(e,"children","spanClosed")}}if(t){addClass(t,"last","closed");addClass(e,"last","spanClosed");return true}else return false}
function treeToggle(a,b){for(a=this;a!=null&&(!a.tagName||a.tagName.toLowerCase()!="li");)a=a.parentNode;var c=findChildWithTag(a,"ul"),e=findChildWithTag(a,"span");if(b!=null)if(b=="open")treeOpen(e,a);else b=="close"&&treeClose(e,a);else if(c!=null)a.className.match(/(^| )closed($| )/)?treeOpen(e,a):treeClose(e,a)}function treeOpen(a,b){removeClass(a,"spanClosed");removeClass(b,"closed")}function treeClose(a,b){addClass(a,"spanClosed");addClass(b,"closed")}
function findChildWithTag(a,b){for(var c=0;c<a.childNodes.length;c++)if(a.childNodes[c].tagName!=null&&a.childNodes[c].tagName.toLowerCase()==b)return a.childNodes[c];return null}function addClass(a,b,c){if(c!=null&&a.className.match(new RegExp("(^| )"+c)))a.className=a.className.replace(new RegExp("( |^)"+c),"$1"+b+" "+c);else if(!a.className.match(new RegExp("(^| )"+b+"($| )"))){a.className+=" "+b;a.className=a.className.replace(/(^ +)|( +$)/g,"")}}
function removeClass(a,b){var c=" "+a.className+" ";c=c.replace(new RegExp(" ("+b+" +)+","g")," ");a.className=c.replace(/(^ +)|( +$)/g,"")}_LOADERS=Array();function callAllLoaders(){var a,b;for(a=0;a<_LOADERS.length;a++){b=_LOADERS[a];b!=callAllLoaders&&b()}}function appendLoader(a){if(window.onload&&window.onload!=callAllLoaders)_LOADERS[_LOADERS.length]=window.onload;window.onload=callAllLoaders;_LOADERS[_LOADERS.length]=a}appendLoader(autoInit_trees);document.observe("click",function(a){if(a.findElement(".click_box")){a=Event.element(a);a=$(a).down(".click_link");var b=a.readAttribute("href");if(a.hasAttribute("target"))window.open(b,"_blank");else window.location=b}});UniversalTabs=function(){var a=0,b=function(e,g){var l=e.readAttribute("href"),r="dynamic-tab-"+a++;g=e.up(".tab_container").down(".tab_group");e.writeAttribute("href","#"+r);g.insert({bottom:(new Element("div",{id:r,"class":"tab"})).update('<span class="spinner spinner_big">Loading...</span>')});new Ajax.Request(l,{method:"get",evalScripts:true,onSuccess:function(u){$(r).update(u.responseText)},onFailure:function(){$(r).update("")}})},c=function(e){var g=e.readAttribute("href");g=$(g.sub("#",""));
g.siblings().each(function(l){l.removeClassName("active")});g.addClassName("active");e.up().siblings().each(function(l){l.down().removeClassName("active")});e.addClassName("active")};return{setup:function(){$$(".tab_container").each(function(e){$(e).addClassName("js")});$$(".tab_index a").each(function(e){if(e.hasClassName("active")&&!e.readAttribute("href").include("#")){b(e);c(e)}e.observe("click",function(g){g.stop();e.readAttribute("href").include("#")||b(e);c(e)})})}}}();
document.observe("dom:loaded",function(){UniversalTabs.setup()});function UserProgressBar(a){this.initialize(a)}
UserProgressBar.prototype={initialize:function(a){this._active_user=a;this._progress_bar_container_node=$("user_progress_bar_container");this._progress_bar_steps_node=$("user_progress_bar_steps");this._target_node=$("progress_bar_target");this._active_step=null;this._progress_step_elements=this.makeListItemsForAvailableSteps();this.updateProgress()},updateProgress:function(){var a=this,b=this._active_user.progressBarPercentComplete()+"%";$("user_progress_percentage_number").update(b);$("user_progress_bar").setStyle({width:b});
this._active_user.onOwnProfilePage()?$("progress_bar_hide_control").remove():$("progress_bar_hide_control").observe("click",function(c){Event.stop(c);a.hideBar();return false});if(this._target_node){this._progress_bar_container_node.remove();this._target_node.update(this._progress_bar_container_node)}if(this._active_user.showProgressBarCompletionMessage()){$("user_progress_bar_complete_message").show();$("user_progress_bar_steps_container").remove();this._progress_bar_container_node.addClassName("completed")}else{this._progress_step_elements.each(function(c){a._progress_bar_steps_node.insert(c)});
a._active_user.isGamePage()&&$$(".user_step_link").map(function(c){c.observe("click",function(e){Event.stop(e);window.open(c.href);return false})});$("progress_bar_next_control").observe("click",function(c){Event.stop(c);a.gotoNextStep();return false});$("progress_bar_previous_control").observe("click",function(c){Event.stop(c);a.gotoPrevStep();return false});$$(".user_step_link").invoke("observe","mouseenter",function(){new Effect.Appear("user_progress_preview",{duration:0.12,from:0,to:1})}).invoke("observe",
"mouseleave",function(){new Effect.Fade("user_progress_preview",{duration:0.12,from:1,to:0})});this._active_step=this._progress_bar_steps_node.down("li").show()}this._progress_bar_container_node.show()},makeListItemsForAvailableSteps:function(){var a=this,b=new Template($("user_progress_bar_step_template").innerHTML);return this._active_user.availableProgressBarSteps().map(function(c){return b.evaluate({icon_id:c[0]+"_icon",link_content:c[1],link_path:c[2].sub("Guest",a._active_user.username()),onclick_content:a._active_user.isGamePage()?
'onclick="window.open(this.href);return false"':""})})},gotoNextStep:function(){Effect.Queues.get("fading").invoke("cancel");Effect.Queues.get("moving").invoke("cancel");var a=this._active_step.readAttribute("id"),b=this.nextStep().readAttribute("id");$(a).removeClassName("active").setStyle({left:"0"}).siblings().invoke("hide");new Effect.Fade($(a),{duration:0.2,from:1,to:0,queue:{position:"front",scope:"fading"}});new Effect.Move($(a),{duration:0.2,x:-50,y:0,mode:"relative",queue:{position:"front",
scope:"moving"}});$(b).addClassName("active").setStyle({left:"50px"});new Effect.Appear($(b),{duration:0.2,from:0,to:1,queue:{position:"end",scope:"fading"}});new Effect.Move($(b),{duration:0.2,x:-50,y:0,mode:"relative",queue:{position:"end",scope:"moving"}});this._active_step=this.nextStep()},gotoPrevStep:function(){Effect.Queues.get("fading").invoke("cancel");Effect.Queues.get("moving").invoke("cancel");var a=this._active_step.readAttribute("id"),b=this.prevStep().readAttribute("id");$(a).removeClassName("active").setStyle({left:"0"}).siblings().invoke("hide");
new Effect.Fade($(a),{duration:0.2,from:1,to:0,queue:{position:"front",scope:"fading"}});new Effect.Move($(a),{duration:0.2,x:50,y:0,mode:"relative",queue:{position:"front",scope:"moving"}});$(b).addClassName("active").setStyle({left:"-50px"});new Effect.Appear($(b),{duration:0.2,from:0,to:1,queue:{position:"end",scope:"fading"}});new Effect.Move($(b),{duration:0.2,x:50,y:0,mode:"relative",queue:{position:"end",scope:"moving"}});this._active_step=this.prevStep()},nextStep:function(){return this._active_step.next(0)||
this._active_step.siblings().first()},prevStep:function(){return this._active_step.previous(0)||this._active_step.siblings().last()},hideBar:function(){if(Cookie.get("kong_progress_bar_hidden")){var a=$("progress_never_show_again_message"),b=$("progress_never_show_again_confirm"),c=$("progress_never_show_again_deny"),e=this;b.observe("click",function(g){a.remove();Event.stop(g);new Ajax.Request("/accounts/"+e._active_user.username()+"/progress_bar_opt_out",{method:"post",onSuccess:function(){e._progress_bar_container_node.remove()}});
return false});c.observe("click",function(g){Event.stop(g);a.remove();e._progress_bar_container_node.remove()});this._progress_bar_container_node.addClassName("dimmed");a.show()}else{this._progress_bar_container_node.remove();Cookie.set("kong_progress_bar_hidden","true",1E4,"/")}},hideForBlueBar:function(){this._progress_bar_container_node.hide()}};UserStatus=function(){this.initialize()};
UserStatus.prototype={initialize:function(){this.delayed_response=null;this.triggerGoogleTagDelayed()},handleSignup:function(a){a.success?this.accountCreationSuccess(a):this.accountCreationFailure(a)},facebookSignInSuccess:function(a){if(active_user.isAuthenticated()&&a.new_facebook_connection)this.existingUserConnected();else a.existing_user?this.setActiveUser(a):this.accountCreationSuccess(a)},existingUserConnected:function(){new FacebookFriendFinder(function(a){try{lightbox.prototype.shutdown()}catch(b){}lightbox.prototype.initializeKongregateLightboxFromAjax("/facebook_connection/confirm",{done_class_name:a.friends.length>
0?"wide":"fb_confirm_narrow",afterStaticContentLoad:function(){a.friends.length>0?a.displayFriendForm("/account"+active_user.username()+"/friends/create_many",$("facebook_friends"),function(){try{lightbox.prototype.shutdown()}catch(c){}}):$("facebook_friends_wrapper").hide();lightbox.prototype.addOnCloseCallback(function(){active_user.isGamePage()?$$(".facebook_nav_item").invoke("hide"):window.location.reload()})}})})},accountCreationSuccess:function(a){if(a.game){active_user.invokeConversionIframe();
if(a.from_facebook){try{lightbox.prototype.shutdown()}catch(b){}lightbox.prototype.initializeKongregateLightboxFromAjax(a.full_finalize_form_facebook_connection_url,{done_class_name:"lightbox_login"});this.delayed_response=a}else this.setActiveUser(a);this.googleTagRegistration()}else if(a.from_facebook){this.delayed_response=a;try{lightbox.prototype.shutdown()}catch(c){}lightbox.prototype.initializeKongregateLightboxFromAjax(a.full_finalize_form_facebook_connection_url,{done_class_name:"lightbox_login"});
this.googleTagRegistration()}else{Cookie.set("_kong_acct_created","true",1,"/");active_user.src()!=undefined&&Cookie.set("delay_google_tag_src",active_user.src(),1,"/");window.location.href=a.destination_uri}},triggerGoogleTagDelayed:function(){this.previous_src=Cookie.get("delay_google_tag_src");if(this.previous_src!=null){Cookie.erase("delay_google_tag_src","/");setTimeout(this.delayedGoogleTagRegistration.bind(this),0)}},delayedGoogleTagRegistration:function(){typeof dataLayer!="undefined"?dataLayer.push({event:"registration_"+
this.previous_src}):setTimeout(this.delayedGoogleTagRegistration.bind(this),1E3)},googleTagRegistration:function(){var a=active_user.src()?"_"+active_user.src():"";dataLayer.push({event:"registration"+a})},accountCreationFailure:function(a){typeof tracking_code_service!="undefined"&&tracking_code_service.reportTrackingCode();if(a.banned)if(a.from_lightbox)$("lightbox_email_register").replace(a.content);else window.location.href=a.banned_url;else if(a.from_lightbox){$("lightbox_form").update(a.content);
lightbox.prototype.toggleRegistration()}else if(a.signup_tab)parent.$("signup_tab_form").update(a.content);else{var b=parent.$("signup_pod_form");if(b)b.update(a.content);else(b=parent.$("accounts_new_form")||parent.$("new_user"))&&b.replace(a.content);active_user.solvedCaptcha()&&$("user_captcha_validation")&&$("user_captcha_validation").hide()}},sessionStatus:function(a){if(window.frames.secure_login_frame)window.frames.secure_login_frame.location.href="about:blank";if(Cookie.accept())if(a.authenticated)if(a.game)user_status.setActiveUser(a);
else{try{$("welcome_box_sign_in_button").disable()}catch(b){}window.location.href=a.destination_uri}else if(a.ban_id)window.location.href=a.banned_url;else if(window.location.pathname=="/session/new")window.location.href="http://"+window.location.hostname+"/session/new";else{a.from_lightbox&&$("lightboxlogin").replace(a.content);try{$("welcome_box_sign_in_button").restore()}catch(c){}try{$("sessions_new_form_spinner").restore()}catch(e){}a.native_app||active_user.activateInlineLogin()}else window.location.href=
"http://"+window.location.hostname+"/session/new"},finalizeCompletion:function(a){response=a&&a.response?a.response:this.delayed_response;this.setActiveUser(response)},finalizeFailure:function(a){if($("lightbox").visible()||holodeck.isShowingSignupTab()){$$(".error_block").invoke("remove");$$(".with_error").invoke("removeClassName","with_error");$H(a.errors).each(function(b){var c=b[0];b=b[1];$("user_"+c+"_label").insert({before:"<span class='error_block error'>"+b+"</span>"});$("user_"+c).addClassName("with_error")});
$("facebook_signup_submit_button").restore();$("facebook_signup_skip_button").show()}else this.setActiveUser(this.delayed_response)},showFriendFinderForm:function(a,b){var c="/accounts/"+b.username+"/friends/create_many",e=function(){b.new_facebook_connection=false;this.setActiveUser(b)}.bind(this);try{lightbox.prototype.shutdownWithoutCallbacks()}catch(g){}lightbox.prototype.initializeKongregateLightboxFromContent('<div id="facebook_friends"></div>',{done_class_name:"lightbox_login",afterStaticContentLoad:function(){a.displayFriendForm(c,
$("facebook_friends"),function(){try{lightbox.prototype.shutdown()}catch(l){}});lightbox.prototype.addOnCloseCallback(e)}})},setupWelcomeMessageCookie:function(){var a=Cookie.get("temp_flash_message");if(a){Cookie.set(FlashMessages.COOKIE_NAME,Object.toJSON({messages:[a]}));Cookie.erase("temp_flash_message","/")}},setActiveUser:function(a){if(a&&a.new_facebook_connection)new FacebookFriendFinder(function(c){if(c.friends.length>0)this.showFriendFinderForm(c,a);else{a.new_facebook_connection=false;
this.setActiveUser(a)}}.bind(this));else{try{top.lightbox.prototype.shutdown();typeof tracking_code_service!="undefined"&&tracking_code_service.reportTrackingCode()}catch(b){}if(active_user.isGamePage()){active_user.updateAttributes(a.user_data_sigil);if(window.holodeck){holodeck.switchUser(a.chat_username,a.chat_password,a.user_chat_hash,a.game_auth_token,a.user_id,true);holodeck.closeSignupTab();holodeck.rebootstrapChat();GameMetricsUpdater.update();a.default_nag&&holodeck.updateDefaultChatNag(a.default_nag);
$("share_tab_pane_content").update(a.shared_tab_pane_content);active_user.runCapturedFunction();holodeck.redoPromptSavedSharedContent();holodeck.redoShowSharedContentsIndex();holodeck.loadAdminControls(active_user);a.has_pending_collaborators&&holodeck.loadCollaborators();holodeck.loadDiscussions();holodeck.prepareAvatarTab()}else{active_user.runCapturedFunction();GameMetricsUpdater.update()}}else{this.setupWelcomeMessageCookie(a);if(a.destination_uri)window.location.href=a.destination_uri;else window.location.reload()}}}};
var user_status=new UserStatus;
