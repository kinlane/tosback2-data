var providers_large={google:{name:"Google",url:"https://www.google.com/accounts/o8/id"},yahoo:{name:"Yahoo",url:"http://me.yahoo.com/"},myopenid:{name:"MyOpenId",url:"http://myopenid.com/"},mixi:{name:"Mixi",url:"http://mixi.jp"},openid:{name:"OpenID",label:"Enter your OpenID.",url:null}},providers_small={},providers=$.extend({},providers_large,providers_small),openid={cookie_expires:180,cookie_name:"openid_provider",cookie_path:"/",input_id:null,provider_url:null,init:function(a){var c=$("#openid_btns");
this.input_id=a;$("#openid_choice").show();$("#openid_input_area").empty();$.each(providers_large,function(a){c.append(openid.getBoxHTML(providers_large[a],"large",".gif"))});if(providers_small)for(id in c.append("<br/>"),providers_small)c.append(this.getBoxHTML(providers_small[id],"small",".ico"));$("#openid_form").submit(this.submit);(a=this.readCookie())&&this.signin(a,true)},getBoxHTML:function(a,c){if(!a||!a.name||!a.name.toLowerCase)return null;var d=a.name.toLowerCase();return'<a title="'+
a.name+'" href="javascript: openid.signin(\''+d+'\');"class="'+d+" openid_"+c+'_btn rb-a-3"></a>'},signin:function(a,c){var d=providers[a];if(d)this.highlight(a),this.setCookie(a),d.label?(this.useInputBox(d),this.provider_url=d.url):(this.setOpenIdUrl(d.url),this.provider_url=d.url,c||$("#openid_form").submit())},submit:function(){var a=openid.provider_url;a&&(a=a.replace("{username}",$("#openid_username").val()),openid.setOpenIdUrl(a));return true},setOpenIdUrl:function(a){var c=$("#"+this.input_id);
c.length>0?c.val(a):$("#openid_form").append('<input type="hidden" id="'+this.input_id+'" name="'+this.input_id+'" value="'+a+'"/>')},highlight:function(a){var c=$("#openid_highlight");c&&c.replaceWith($("#openid_highlight a")[0]);$("#openid_form").attr("showhighlight")!="false"&&$("."+a).wrap('<div id="openid_highlight"></div>')},setCookie:function(a){var c=new Date;c.setTime(c.getTime()+this.cookie_expires*864E5);c="; expires="+c.toGMTString();document.cookie=this.cookie_name+"="+a+c+"; path="+
this.cookie_path},readCookie:function(){for(var a=this.cookie_name+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var f=c[d];f.charAt(0)==" ";)f=f.substring(1,f.length);if(f.indexOf(a)==0)return f.substring(a.length,f.length)}return null},useInputBox:function(a){var c=$("#openid_input_area"),d="",f="openid_username",e="",b=a.label;b&&(d="<p>"+b+"</p>");if(a.name=="OpenID")f=this.input_id,e="http://";d+='<input id="'+f+'" class="action" type="text" name="'+f+'" value="'+e+'" /><a href="#" onclick="$(\'#openid_form\').submit(); return false;" id="openid_submit" class="btn-cmt">Sign In</a>';
(a=$("#"+this.input_id))&&a.remove();c.empty();c.append(d);$("#"+f).focus()}};var plans=plans?plans:{};
plans.initFeatureInfoPopup=function(){function a(a){return(a=/_feature_([^\s]+)/.exec(a))&&a.length>1?a[1]:null}function c(a,d){if(a){var b=$("#featureInfoPopup").length?$("#featureInfoPopup"):$('<div id="featureInfoPopup" style="display: none;"></div>'),c="",k=false;switch(a){case "networks":c+="<h3>"+translation._("What are Social Profiles?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Total owned social profiles* from Twitter, Facebook and other networks. <br/> <div style='font-size: 10px;padding-top:5px;'>* Limit of <strong>owned</strong> social profiles only. You can also add unlimited shared profiles as a team member.</div>");break;
case "rss":c+="<h3>"+translation._("What are RSS/Atom Feeds?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Number of RSS connections available to auto-update your social profiles from your blog or news feed.");break;case "team":c+="<h3>"+translation._("What are Team Members?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Collaborators who can help manage your social accounts.");break;case "ad_free":c+="<h3>"+translation._("What does Opt out of Ads mean?")+"</h3>";c+='<div class="arrowLeft"></div>'+
translation._("You can opt out of seeing promoted tweets in your search or social streams.");break;case "ads":c+="<h3>"+translation._("What does Opt out of Ads mean?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._('Clearly labeled "Promoted Tweets" from Twitter will appear in your search stream.');break;case "archive_messages":c+="<h3>"+translation._("What are HootSuite Archives?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Store up to 100 tweets free with your plan, and purchase up to 100,000 to archive and download all keyword related Twitter messages.");
break;case "archive_messages_pro":c+="<h3>"+translation._("What are HootSuite Archives?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Store up to 100,000 keyword related tweets free with the Enterprise plan. More are available for purchase upon request from your Account Manager.");break;case "support":c+="<h3>"+translation._("What is Enhanced Support?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Help tickets are prioritized and answered within a time-frame outlined in a service level agreement.");
break;case "brand":c+="<h3>"+translation._("What are Vanity URLs?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Custom branded web address shortening from Ow.ly Pro including statistic reports (additional fees required).");break;case "insights":c+="<h3>"+translation._("What are Social Insights?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Intelligence gathering tool to find public information about people on your social networks.");break;case "affiliate":c+="<h3>"+translation._("What is the Affiliate Program?")+
"</h3>";c+='<div class="arrowLeft"></div>'+translation._("The Affiliate Program is a way to earn commissions for new Pro, Enterprise and University customers that sign up as a result of your referrals.");break;case "ga":c+="<h3>"+translation._("What are Google Analytics?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Data from Google Analytics is displayed directly in HootSuite including parameter filtering and social statistics overlay.");break;case "learn":c+="<h3>"+translation._("What is included in VIP Set-up?")+
"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Personalized, on-line set-up assistance with VIP account executive.");break;case "cert":c+="<h3>"+translation._("What is the HootSuite Certification Program?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Enrollment for 10 team members in an on-going training program -- includes video modules, quizzes and professional development webinars.");break;case "url":c+="<h3>"+translation._("What are URL Parameters?")+"</h3>";c+='<div class="arrowLeft"></div>'+
translation._("Custom data variables (i.e. source, medium, client) which are added to a URL to help measure campaigns in analytics tools.");break;case "influence":c+="<h3>"+translation._("What are Influence Scores?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("View and filter by algorithmically-determined scores which measure the impact and reach of a social profile.");break;case "fb_insights":c+="<h3>"+translation._("What are Facebook Insights?")+"</h3>";c+='<div class="arrowLeft"></div>'+
translation._("Statistical tracking tool to display information about who engages with your Facebook page, including 'likes', page activity, post feedback and other analytics.");break;case "pro_analytics":case "enterprise_analytics":c+="<h3>"+translation._("What are Enhanced Social Analytics?")+'</h3><div class="arrowLeft"></div>'+translation._("Monitor sentiment and track your social reach with access to advanced reporting tools.");break;case "pro_points":case "num_reports":c+="<h3>"+translation._("What are Social Analytics Reports?")+
'</h3><div class="arrowLeft"></div>'+translation._("Custom reports with advanced tools like network Stats, Facebook Insights and Google Analytics to help you measure your social media efforts.");break;case "pro_profiles":c+="<h3>"+translation._("What are Social Profiles?")+'</h3><div class="arrowLeft"></div>'+translation._("Total owned accounts* on Twitter, Facebook and other social networks.");break;case "basic_analytics":c+="<h3>"+translation._("What are Social Analytics?")+'</h3><div class="arrowLeft"></div>'+
translation._("Monitor basic information from your social profiles including Click Stats, ReTweets and more.");break;case "app_directory":c+="<h3>"+translation._("What is the HootSuite App Directory?")+'</h3><div class="arrowLeft"></div>'+translation._("The App Directory is a collection of extensions and applications that HootSuite users can add to their dashboard to create a customized experience, including YouTube, Tumblr, Flickr, Constant Contact and more.");break;case "hsu":c+="<h3>"+translation._("What is HootSuite University?")+
'</h3><div class="arrowLeft"></div>'+translation._("Become a certified HootSuite professional with this advanced social media learning program. Receive advanced training from industry experts, get access to job boards and listing in our social media consultants directory.");break;case "analytics_points":c+="<h3>"+translation._("What are Social Analytics Points?")+'</h3><div class="arrowLeft"></div>'+translation._("These points allow you to select from a variety of modules including Google Analytics and Facebook Insights to build custom reports which you can share with clients and colleagues.");
break;case "why_credit_card":c+="<h3>"+translation._("Why do we need your credit card?")+'</h3><div class="arrowLeft"></div>'+translation._("We ask for your credit card to allow your Pro membership to continue should you keep your account open. This prevents any interruption of Pro features to your account. Collecting credit card information also allows us to reduce fraud and to limit customers to one free trial.")+"<br/><br/>"+translation._("Your credit card will not be charged at any point during your 30-day trial. After your 30-day trial, you will be charged $5.99 for each month thereafter (more if you purchase add-ons). If you decide that HootSuite Pro isn't for you, you can cancel anytime, both during and after your trial."),
k=true,hs.trackEvent({category:"Billing Signup Flow",action:"Why credit card"})}b.html(c);c.length?setTimeout(function(){$("#featureInfoPopup").length||b.appendTo("body");var c=d.offset().top-b.outerHeight(true)/2+10,a=d.offset().left+d.outerWidth(true);a+b.outerWidth(true)>$(window).width()&&(a-=100);b.css({top:c,left:a,position:"absolute"}).show();k&&b.css({width:"500px"})},1):b.hide()}}function d(){$("#featureInfoPopup").empty().hide()}$("._feature").live("mouseenter",function(d){var e=a($(this).get(0).className),
d=$(d.target);d.is("._feature")||(d=d.closest("._feature"));plans.featureInfoTimeout&&clearTimeout(plans.featureInfoTimeout);c(e,d)}).live("mouseleave",function(c){var e=a($(this).get(0).className),b=$(c.target);plans.featureInfoTimeout&&clearTimeout(plans.featureInfoTimeout);plans.featureInfoTimeout=setTimeout(function(){d(e,b)},200)});$("#featureInfoPopup").live("mouseenter",function(){plans.featureInfoTimeout&&clearTimeout(plans.featureInfoTimeout)}).live("mouseleave",function(){plans.featureInfoTimeout&&
clearTimeout(plans.featureInfoTimeout);plans.featureInfoTimeout=setTimeout(function(){d()},200)})};plans.startFeatureFreeTrial=function(a,c){ajaxCall({url:"/ajax/member/start-feature-free-trial?featureId="+a,success:function(a){a.success==1?($.isFunction(c)&&c(),hs.statusObj.update(translation._("Free trial started"),"success",true)):hs.statusObj.update(translation._("Sorry, you are not eligible to start a free trial for this feature."),"error",true)}},"q1")};
plans.downgradePlan=function(a){var c=translation._("Are you sure you want to downgrade to a Free Account?");a==2&&(c=translation._("Are you sure you want to downgrade to a Pro Account?"));confirm(c)&&(hs.statusObj.update(translation._("Plan downgrade in progress..."),"info"),ajaxCall({type:"POST",url:"/ajax/member/downgrade-plan?planId="+a,success:function(c){hs.statusObj.reset();if(c.loggedOut)window.location=hs.c.rootUrlSSL+"/login";if(c.invalidPlan)window.location=hs.c.rootUrl;c.noActionRequired&&
plans.save(a);if(c.addonRequired)window.location=hs.c.rootUrlSSL+"/billing?planId="+a;if(c.tooManyReports){hs.statusObj.update(translation._("You currently have more reports than allowed by the chosen plan. Please view the Analytics page and delete a few."),"error",true);var f=$("#reportCreditsErroMsg"),e=$("#reportCreditsDeleteErroMsg");a==1&&(f=$("#reportCreditsDeleteErroMsg"),e=$("#reportCreditsErroMsg"));f.length&&f.show();e.length&&e.hide()}c.output&&(f={width:525,maxHeight:700,resizable:false,
draggable:false,position:["center",80],modal:true,title:translation._("Attention Required"),content:c.output},$.dialogFactory.create("downgradePlanPopup",f),plans.initDowngradePlanPopup(c.matrix))},error:function(){hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",true)},abort:function(){hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",true)}},"q1"))};
plans.forceDowngradeToFree=function(){var a=translation._("Are you sure you want to downgrade to a Free account? Doing so will immediately remove all Custom Analytics Reports, all Team Members and all but 5 of your Social Networks.");confirm(a)&&(hs.statusObj.update(translation._("Plan downgrade in progress..."),"info"),ajaxCall({type:"POST",url:"/ajax/member/force-downgrade-to-free",success:function(c){hs.statusObj.reset();if(c.loggedOut)window.location=hs.c.rootUrlSSL+"/login";c.ok&&plans.save(1)},
error:function(){hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",true)},error:function(){hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",true)}},"q1"))};
plans.initDowngradePlanPopup=function(a){$("#downgradePlanPopup").find("._showTransferOwnershipPopup").bind("click",function(){settings.socialNetwork.showTransferOwnershipPopup($(this).data("social-network-id"));return false}).end().find("._toggleTeamMemberToRemoveTooltip").each(function(){var c=$(this),a=c.data("member-id");c.bind("mouseover",function(){billing.toggleTeamMemberToRemoveTooltip(this,a,true)}).bind("mouseout",function(){billing.toggleTeamMemberToRemoveTooltip(this,a)})});$("#changePlanActionButtons a._cancel").click(function(){$("#downgradePlanPopup").dialog("close")});
$("#changePlanActionButtons a._continue").click(function(){plans.submitRemoveExcessiveItemsForm();return false});$("#changePlanSectionErrorMsg").hide();$("#changePlanSectionForm input[type='checkbox']").click(function(){var c=$(this),d=$("#changePlanSectionForm");c.is(":checked")?(c.siblings("span._strikeThroughTxt").css("text-decoration","line-through"),c.closest("._socialNetwork").length&&$("#changePlanSectionForm ._rss ._fromSn"+c.attr("socialNetworkId")).find("input[type=checkbox]").each(function(){$(this).attr("checked",
"checked");$(this).parent().find("span._strikeThroughTxt").css("text-decoration","line-through")})):c.siblings("span._strikeThroughTxt").css("text-decoration","");if(c.closest("._socialNetwork").length||c.closest("._rss").length){var f=$("#changePlanSectionForm ._socialNetwork input:checkbox:not(:checked)").length,e=$("#changePlanSectionForm ._rss input:checkbox:not(:checked)").length;f>a.maxSocialNetworks?$("#changePlanSectionForm ._socialNetwork ._planPassIndicator").removeClass("passed").addClass("not-passed"):
$("#changePlanSectionForm ._socialNetwork ._planPassIndicator").removeClass("not-passed").addClass("passed");e>a.maxFeeds?$("#changePlanSectionForm ._rss ._planPassIndicator").removeClass("passed").addClass("not-passed"):$("#changePlanSectionForm ._rss ._planPassIndicator").removeClass("not-passed").addClass("passed");d.find("._socialNetwork ._numChecked").html(f).end().find("._rss ._numChecked").html(e)}if(c.closest("._teamMember").length>0)c=$("#changePlanSectionForm ._teamMember input:checkbox:not(:checked)").length,
c>a.maxTeamMembers?$("#changePlanSectionForm ._teamMember ._planPassIndicator").removeClass("passed").addClass("not-passed"):$("#changePlanSectionForm ._teamMember ._planPassIndicator").removeClass("not-passed").addClass("passed"),d.find("._teamMember ._numChecked").html(c)})};
plans.submitRemoveExcessiveItemsForm=function(){$("#changePlanSectionErrorMsg").text("").hide();if(confirm(translation._("Checked items will be deleted from HootSuite permanently"))){hs.throbberMgrObj.add("#changePlanActionButtons a._continue");var a=$("#changePlanSectionForm").serialize();ajaxCall({type:"POST",url:"/ajax/member/save-plan-remove-items",data:a,success:function(c){if(c.loggedOut)window.location=hs.c.rootUrlSSL+"/login";else if(c.invalidPlan)return $("#changePlanSectionErrorMsg").text("Invalid Plan").show(),
false;else if(c.excessiveMsg)return $("#changePlanSectionErrorMsg").text(c.excessiveMsg).show(),false;else c.ok&&plans.save(c.planId)},error:function(){$("#changePlanSectionErrorMsg").text(translation._("An error occurred while processing your request, please try again later")).show()},abort:function(){$("#changePlanSectionErrorMsg").text(translation._("An error occurred while processing your request, please try again later")).show()},complete:function(){hs.throbberMgrObj.removeAll()}},"q1")}};
plans.save=function(a){window.location=hs.c.rootUrl+"/save-plan?planId="+a};
plans.initSalesForceForm=function(a,c){var d=a?$("#"+a):$("#salesforceForm"),f=function(){function a(b){d.find("._errorMsg").text(b)}if(d.find("#first_name").val().length<1)return a(translation._("Please enter first name")),false;if(d.find("#last_name").val().length<1)return a(translation._("Please enter last name")),false;if(d.find("#email").val().length<1||!hs.util.isEmailValid(d.find("#email").val()))return a(translation._("Please enter valid email")),false;if(d.find("#phone").val().length<1)return a(translation._("Please enter a valid phone number")),
false;if(d.find("#00N30000005JLLo").val().length<1)return a(translation._("Please enter your company website")),false;$.isFunction(c)?c(d):d.submit();return false};d.find(":input").unbind("keydown").bind("keydown",function(a){checkForEnterKey(a,"_salesforceSubmit")}).end().find("._salesforceSubmit").unbind("click").click(function(a){a.preventDefault();f()})};plans.pro=plans.pro?plans.pro:{};
plans.pro.init=function(a,c){function d(){hs.timers.homeSlideTimer!=void 0&&(clearTimeout(hs.timers.homeSlideTimer),delete hs.timers.homeSlideTimer);hs.timers.homeSlideTimer=setTimeout(function(){$(".next").click()},6E3)}function f(){var a=currentPos+e*b-b;currentPos-h==0&&($("#featuresShowcase .unique").css("margin-left",currentPos-h),$("#featuresShowcase .clone").css("margin-left",currentPos-h-h),currentPos-=h);a==0&&($("#featuresShowcase .unique").css("margin-left",currentPos+h),$("#featuresShowcase .clone").css("margin-left",
currentPos+h-h),currentPos+=h)}a&&(c?function(){function b(){hs.statusObj?hs.statusObj.update(translation._("Your info has been submitted and your grace period has been extended."),"success",true):setTimeout(b,50)}b()}():(plans.initSalesForceForm(),ajaxCall({url:"/ajax/member/shoulder-group-popup",success:function(b){var a={modal:true,width:734,closeOnEscape:true,draggable:false,title:translation._("Upgrade to HootSuite Enterprise"),position:["center",50]},c=$.dialogFactory.create("shoulderGroupPopup",
a);c.html(b.output);c.find("._closeShoulderGroupPopup").bind("click",function(){c.dialog("close")})}},"q1")));plans.initFeatureInfoPopup();var e=$("#featuresShowcase .unique .item").size(),b=$("#featuresShowcase .unique .item:first").outerWidth(),h=e*b;$("#featuresShowcase .unique").width(h);$("#featuresShowcase .featuresHolder").outerWidth();currentPos=0;$("#featuresShowcase .unique").clone().prependTo($("#featuresShowcase .featuresHolder"));$("#featuresShowcase .unique:first-child").addClass("clone").removeClass("unique");
$("#featuresShowcase .clone").css("margin-left",h*-1);d();$(".prev").click(function(a){$("#featuresShowcase .unique:animated").length<=0&&(currentPos=targetPos=currentPos+b,$("#featuresShowcase .unique").animate({marginLeft:targetPos},700),$("#featuresShowcase .clone").animate({marginLeft:targetPos-h},700,f));d();a.preventDefault()});$(".next").click(function(a){$("#featuresShowcase .unique:animated").length<=0&&(currentPos=targetPos=currentPos-b,$("#featuresShowcase .unique").animate({marginLeft:targetPos},
700),$("#featuresShowcase .clone").animate({marginLeft:targetPos-h},700,f));d();a.preventDefault()})};plans.enterprise=plans.enterprise?plans.enterprise:{};
plans.enterprise.init=function(a,c){plans.initFeatureInfoPopup();plans.initSalesForceForm();a?function(){function a(){hs.statusObj?hs.statusObj.update(translation._("Your request has been submitted and a representative will contact you as soon as possible."),"success",true):setTimeout(a,50)}a()}():c&&function(){function a(){hs.statusObj?hs.statusObj.update(translation._("Your request has been submitted and a representative will contact you as soon as possible."),"success",true):setTimeout(a,50)}a()}()};var billing=billing?billing:{};billing.tiers=[];billing.activeCoupons=[];billing.currentCost=0;billing.countryList=[];billing.stateList=[];
billing.init=function(a,c){if(a!=void 0&&c!=void 0)billing.countryList=a,billing.stateList=c,billing.populateCountry();billing.checkTeamMemberRequirement($("#teamMembersFeature input[name='teamMembers']").val());billing.updatePrice();document.billingConfirmationLoaded=billing.confirmationLoaded;$("#teamMemberUpperLimitErroMsg a._close").click(function(){$("#teamMemberUpperLimitErroMsg").hide()});plans.initFeatureInfoPopup()};
billing.openPricingPopup=function(){var a='<table style="width: 100%; margin: 5px 0pt 15px;"><tbody>';a+="<tr><td><strong>"+translation._("1st Team Member")+"</strong></td><td>"+translation._("Always Free for Pro accounts")+"</td></tr>";a+="<tr><td><strong>"+translation._("Next 4 (2nd to 5th)")+"</strong></td><td>"+translation._("$15 each per month")+"</td></tr>";a+="<tr><td><strong>"+translation._("Next 5 (6th to 10th)")+"</strong></td><td>"+translation._("$30 each per month")+"</td></tr>";a+="<tr><td><strong>"+
translation._("Next 5 (11th to 15th)")+"</strong></td><td>"+translation._("$50 each per month")+"</td></tr>";a+="</tbody></table>";a+="<p>"+translation._("e.g. For a team of 6 members:")+"</p>";a+="<p>"+translation._("1st team member free, Next 4 team members @ $15 each per month, and the 6th team member @ $30 per month. Total is 1 x $0 + 4 x $15 + 1 x $30 = $90")+"</p>";a={width:450,autoOpen:true,modal:true,title:"Pricing Structure",content:'<div id="pricingInfoContent" class="ui-dialog-section rb-a-3"><h2>'+
translation._("Add Team Members")+"</h2><p>"+translation._("Pricing for additional team members is variable and based on the total number of contributors to your account. The chart below details the tiers and charges:")+"</p>"+a+"<h2>"+translation._("Add Priority Support")+"</h2><p>"+translation._("Receive prioritized response times for support tickets for an additional ")+"$"+billing.tiers.support[0].price+translation._(" per month for each team member associated with your plan.")+"</p></div>"};
$.dialogFactory.create("pricingInfo",a)};
billing.checkTeamMemberRequirement=function(a){var a=parseInt(a),c=true,d=$("#teamMembersFeature"),f=d.find("input[name='teamMembers']"),e=parseInt(d.find("input[name='teamMembers']").attr("minimumrequired")),d=parseInt(d.find("input[name='teamMembers']").attr("featurelimit"));e>d?(a>d&&($("#teamMemberUpperLimitErroMsg").show(),f.val(d)),billing.manageTeamMembers(),c=false):a>d?(f.val(d),$("#teamMemberUpperLimitErroMsg").show(),c=false):a<e&&(f.val(e),billing.manageTeamMembers(),c=false);return c};
billing.storeFeatures=function(){var a=$("#featuresForm").serialize();ajaxCall({type:"POST",url:"/ajax/member/billing-store-features",data:a,success:function(a){a.success||hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",true)}},"q1")};
billing.addCoupon=function(){var a={couponCode:$("#couponCode").val()};ajaxCall({type:"POST",url:"/ajax/member/billing-add-coupon",data:a,success:function(a){a.success=="1"?($("._addCoupon").slideToggle(),hs.statusObj.update(translation._("Coupon added!"),"success",true),document.location=document.location.href):hs.statusObj.update(translation._("Not a valid coupon code, please try again."),"error",true)}},"q1")};billing.saveFeatures=function(){hs.throbberMgrObj.add("._saveAddons");$("#featuresForm").submit()};
billing.showBillingSection=function(){$("#billingSection").show();$("#featuresSummary").show();$("#featuresSection").hide()};billing.hideBillingSection=function(){$("#billingSection").hide();$("#featuresSummary").hide();$("#featuresSection").show()};
billing.updatePrice=function(){billing.currentCost=parseFloat($("#selectedPlan").attr("cost"));var a={},c=$("#teamMembersFeature"),d=c.find("input[name='teamMembers']"),f=0;if(d.length&&!isNaN(parseInt(d.val()))){f=parseInt(d.val());f<0&&(f=0,d.val("0"),c.find("._subtotal").html("$0.00"));var e=billing.getTotalCostForTieredFeature(f,billing.tiers.teamMember);c.find("._subtotal").html("$"+e.toFixed(2));a[c.attr("featureid")]=e;var b=billing.getTierForAmount(f,billing.tiers.teamMember),b=b==void 0?
billing.getTierForAmount(1,billing.tiers.teamMember).price:b.price;c.find("._numericPrice").html(b);billing.currentCost+=e}else d.val("0"),c.find("._subtotal").html("$0.00"),c.find("._numericPrice").html("0.00");var h=$("#prioritySupportFeature"),c=h.find("input");c.length&&c.prop("checked")?(e=billing.getTotalCostForTieredFeature(f,billing.tiers.support),billing.currentCost+=e,a[h.attr("featureid")]=e,h.removeClass("unchecked"),h.find("._subtotal").html("$"+e.toFixed(2))):(h.addClass("unchecked"),
h.find("._subtotal").html("$0.00"));var k=$("#owlyFeature"),h=k.find("input");h.length&&h.prop("checked")?(e=parseFloat(h.attr("cost")),billing.currentCost+=e,a[k.attr("featureid")]=e,k.removeClass("unchecked"),k.find("._subtotal").html("$"+parseFloat(h.attr("cost")).toFixed(2))):(k.addClass("unchecked"),k.find("._subtotal").html("$0.00"));b=$("#owlyEnterpriseFeature");k=b.find("input");k.length&&k.prop("checked")?(e=parseFloat(k.attr("cost")),billing.currentCost+=e,a[b.attr("featureid")]=e,b.removeClass("unchecked"),
b.find("._subtotal").html("$"+parseFloat(k.attr("cost")).toFixed(2))):(b.addClass("unchecked"),b.find("._subtotal").html("$0.00"));var l=$("#archiveFeature"),b=l.find("select[name='messageArchiving']"),e=0;isNaN(parseInt(b.find("option:selected").val()))?(b.val("0"),l.find("._subtotal").html("$0.00"),l.find("._numericPrice").html("0.00")):(archiveLevel=parseInt(b.find("option:selected").val()),archiveLevel<=0?(archiveLevel=0,b.val("0"),l.find("._subtotal").html("$0.00")):(e=billing.getTotalCostForTieredFeature(archiveLevel,
billing.tiers.messageArchiving),l.find("._subtotal").html("$"+e.toFixed(2)),a[l.attr("featureid")]=e,b=billing.getTierForAmount(f,billing.tiers.messageArchiving),b=b==void 0?billing.getTierForAmount(1,billing.tiers.messageArchiving).price:b.price,l.find("._numericPrice").html(b),billing.currentCost+=e));var b=$("#hsuSeatsFeature"),e=b.find("input"),l=b.find("input:checked:enabled").length,m=b.attr("basefeature"),m=l-m>0?l-m:0;l?(e=m*e.attr("cost"),billing.currentCost+=e,a[b.attr("featureid")]=e,b.removeClass("unchecked"),
b.find("._subtotal").html("$"+parseFloat(e).toFixed(2))):(b.addClass("unchecked"),b.find("._subtotal").html("$0.00"));l=$("#reportFeature");m=l.find("select[name='reportingChunks']");isNaN(parseInt(m.find("option:selected").val()))?(m.val("0"),l.find("._subtotal").html("$0.00"),l.find("._numericPrice").html("0.00")):(e=parseInt(m.find("option:selected").val()),e*billing.reportingChunkUnits+billing.planBaseCredits<billing.currentReportCredits?($("#reportCreditsErroMsg").show(),m.val(billing.currentReportsVal),
e=billing.currentReportsVal):$("#reportCreditsErroMsg").hide(),e<0&&(e=0,m.val("0"),l.find("._subtotal").html("$0.00")),b=l.attr("cost")*e,e==0?(b=0,l.addClass("unchecked")):l.removeClass("unchecked"),e=b,l.find("._subtotal").html("$"+e.toFixed(2)),a[l.attr("featureid")]=e,l.find("._numericPrice").html(b),billing.currentCost+=e,billing.currentReportsVal=m.val());for(e=0;e<this.activeCoupons.length;e++)b=this.activeCoupons[e],b.amount!=0&&(b.featureId==0?b.priceType=="flat"?billing.currentCost-=b.amount:
b.priceType=="percentage"&&(billing.currentCost-=billing.currentCost*(b.amount/100)):b.priceType=="percentage"&&(l=a[b.featureId],l!=void 0&&l>0&&(billing.currentCost-=l*(b.amount/100))));if(billing.currentCost<0)billing.currentCost=0;billing.currentCost=Math.round(billing.currentCost*100)/100;$("#totalCost").html(billing.currentCost);$("#dynamicFeatures").length&&($("#dynamicFeatures ._totalCost").html(billing.currentCost),$("#dynamicFeatures ._teamMembers ._num").html(d.val()),$("#dynamicFeatures ._teamMembers ._cost").html(billing.getTotalCostForTieredFeature(f,
billing.tiers.teamMember).toFixed(2)),d.length&&!isNaN(parseInt(d.val()))&&parseInt(d.val())>0?$("#dynamicFeatures ._teamMembers").show():$("#dynamicFeatures ._teamMembers").hide(),c.length&&c.prop("checked")?($("#dynamicFeatures ._prioritySupport ._cost").html(billing.getTotalCostForTieredFeature(f,billing.tiers.support).toFixed(2)),$("#dynamicFeatures ._prioritySupport").show()):$("#dynamicFeatures ._prioritySupport").hide(),h.length&&h.prop("checked")?$("#dynamicFeatures ._owlyPro").show():$("#dynamicFeatures ._owlyPro").hide(),
k.length&&k.prop("checked")?$("#dynamicFeatures ._owlyEnterprise").show():$("#dynamicFeatures ._owlyEnterprise").hide())};billing.getTierForAmount=function(a,c){for(var d=0;d<c.length;d++)if(a>=c[d].min&&a<=c[d].max)return c[d]};billing.getTotalCostForTieredFeature=function(a,c){for(var d=0,f=0;f<=a;f++){var e=billing.getTierForAmount(f,c);e!=void 0&&(d+=e.price)}return d};
billing.decrementTeamMembers=function(){var a=$("#teamMembersFeature input[name='teamMembers']"),c=parseInt(a.val());a.length&&!isNaN(parseInt(c))&&parseInt(c)>0&&(c-=1,billing.checkTeamMemberRequirement(c)&&(a.val(c),billing.updatePrice(),$("#teamMemberUpperLimitErroMsg").hide()))};
billing.incrementTeamMembers=function(){var a=$("#teamMembersFeature input[name='teamMembers']"),c=parseInt(a.val());a.length&&!isNaN(parseInt(c))&&(c+=1,billing.checkTeamMemberRequirement(c)&&(a.val(c),billing.updatePrice(),billing.manageTeamMembersRemove()))};billing.showHistoryInvoice=function(a){a=window.open(hs.c.rootUrlSSL+"/show-history-invoice?id="+a,"Invoice","height=700,width=790,toolbar=no,menubar=yes,status=no,location=no,directories=no");window.focus&&a.focus()};
billing.manageTeamMembers=function(){$("#teamMemberManagement").html('<img src="'+hs.util.rootifyImage("/themes/"+(hs.prefs.theme||"blue_steel").toLowerCase()+"/loader.gif")+'" alt="" class="spinner _loading" />');var a=$("#featuresForm input[name='planId']").val();ajaxCall({type:"GET",url:"/ajax/member/billing-manage-team-member?planId="+a+"&n="+$("#teamMembersFeature input[name='teamMembers']").val(),success:function(a){$("#savePlanChangeButtons").hide();$("#teamMemberManagement").html(a.output);
$("#billingManageTeamMemberButton ._cancel").click(function(){billing.manageTeamMembersRemove()});$("#teamMemberManagement").find("._toggleTeamMemberToRemoveTooltip").each(function(){var a=$(this),c=a.data("member-id");a.bind("mouseover",function(){billing.toggleTeamMemberToRemoveTooltip(this,c,true)}).bind("mouseout",function(){billing.toggleTeamMemberToRemoveTooltip(this,c)})});$("#billingManageTeamMemberButton ._remove").click(function(){if(confirm(translation._("Are you sure you'd like to remove the selected team members from your HootSuite team?"))){hs.throbberMgrObj.add("#billingManageTeamMemberButton ._remove");
var a=$("#billingManageTeamMemberForm").serialize();a+="&form_submit=1";ajaxCall({type:"POST",url:"/ajax/member/billing-manage-team-member",data:a,success:function(a){a.success?($("#teamMembersFeature input").attr("minimumRequired",a.minimumRequired),billing.manageTeamMembersRemove(),hs.statusObj.update(translation._("Team member successfully removed"),"info",true,3E3),$("#teamMembersFeature input[name='teamMembers']").val(a.minimumRequired),billing.updatePrice(),billing.checkTeamMemberRequirement($("#teamMembersFeature input[name='teamMembers']").val())):
a.removeHsuFirst?hs.statusObj.update(translation._("Please remove HSU access for team members you wish to remove first."),"error",true):a.noTeamMember?hs.statusObj.update(translation._("Please select at least 1 team member to remove"),"error",true):(billing.manageTeamMembersRemove(),hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",true))},error:function(){billing.manageTeamMembersRemove();hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),
"error",true)},complete:function(){hs.throbberMgrObj.remove("#billingManageTeamMemberButton ._remove")}},"q1")}});$("#billingManageTeamMemberForm input[type='checkbox']").click(function(){var a=$(this);a.is(":checked")?a.siblings("span._strikeThroughTxt").css("text-decoration","line-through"):a.siblings("span._strikeThroughTxt").css("text-decoration","")})},error:function(){billing.manageTeamMembersRemove();hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),
"error",true)}},"q1")};billing.manageTeamMembersRemove=function(){$("#teamMemberManagement").html("");$("#savePlanChangeButtons").show()};billing.cancelPayment=function(){if(confirm("Are you sure you want to cancel this payment? Your account will be set back to Free plan!"))window.location=hs.c.rootUrl+"/member/cancel-payment";return false};
billing.toggleTeamMemberToRemoveTooltip=function(a,c,d){c=$("#socialNetworksFor"+c).length?$("#socialNetworksFor"+c):$("._socialNetworksFor"+c);a=$(a);d?(d=a.position().top+a.outerHeight(true),c.css("top",d).show()):c.hide()};
billing.addFeature=function(a,c,d,f,e){ajaxCall({type:"GET",url:"/ajax/member/billing-change-feature?featureId="+a+"&value="+c+"&itemId="+f,success:function(b){b.success=="1"?($("#permissionDeniedPopup").dialog("close"),e=e||translation._("Added feature"),hs.statusObj.update(e,"success",true),$.isFunction(d)&&d()):hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",true)},error:function(){hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),
"error",true)}},"q1")};
billing.deleteReports=function(a){ajaxCall({type:"GET",url:"/ajax/analytics/delete-all-reports?saveZeroCostReports=1",success:function(c){c.success=="1"?(hs.statusObj.update(translation._("Deleted all reports with analytics points"),"info",true),$.isFunction(a)&&a()):hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",true)},error:function(){hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",
true)}},"q1")};billing.focusCC=function(){$('#ccForm input[name="paymentType"][value="cc"]').attr("checked","checked")};billing.checkCCNum=function(a){var c=$(a),a=c.val(),c=c.closest("form").find("._ccNumError"),a=a.replace(/[ -]/g,"");billing.testCCNum(a)?c.html(""):c.html(translation._("Invalid Credit Card Number"))};
billing.testCCNum=function(a){var c=false,d=[/^4\d{15}$/,/^5[1-5]\d{14}$/,/^3[4,7]\d{13}$/,/^6011\d{12}$/,/^(?:2131|1800|35\d{3})\d{11}$/];for(i=0;i<d.length;i++)if(a.match(d[i])){c=true;break}return c};billing.checkCVV=function(a){var c=$(a),a=c.val(),c=c.closest("form").find("._cvvError");c.html("");a.length>0&&(a.length<3||a.length>4||isNaN(a))&&c.html(translation._("CVV code must be 3 or 4 digits"))};
billing.confirmationLoaded=function(a){hs.throbberMgrObj.remove("#ccForm a.btn-cmt");if(a.errorMessages&&a.errorMessages.length>0){var c=$.map(a.errorMessages,function(a){return"<p>"+a+"</p>"}).join("");$("#billingErrorMessages").html(c).show();a.validationFailed&&$("#billingZipContainer").show();a.errorTrackEvents&&a.errorTrackEvents.length>0&&$.map(a.errorTrackEvents,function(a){hs.trackEvent(a)})}else if(a.success)document.getElementById("ccForm").style.display="none",document.getElementById("ccSuccess").style.display=
"",document.getElementById("sasLeadPixel")&&$("#sasLeadPixel").html('<img src="https://shareasale.com/sale.cfm?amount=0.00&tracking='+document.getElementById("sasTrackingValue").value+"&transtype=lead&merchantID="+document.getElementById("sasMerchantIdValue").value+'" width="1" height="1">'),a.gaVirtualPageView&&a.gaVirtualPageView.length>0&&hs.track(a.gaVirtualPageView)};
billing.submitPayment=function(){if(!$("#submitPaymentBtn").hasClass("btn-cta-throbber")){var a=$("#billingCountry"),c=$("#billingState"),d=$("#billingZip");$("#submitPaymentBtn").addClass("btn-cta-throbber");hs.throbberMgrObj.add("#submitPaymentBtn",'<span class="btn-ts">'+translation.c.LOADING+"</span>");ajaxCall({type:"GET",url:"/ajax/member/billing-save-address?country="+a.val()+"&state="+c.val()+"&zip="+d.val(),success:function(a){a.success=="1"?($("#addressError").html(""),$("#paypalRadio:checked").length>
0?billing.startPaypal():$("#billingForm").submit()):(hs.throbberMgrObj.remove("#ccForm a.btn-cmt"),$("#addressError").html(translation._("Enter a Country")))},error:function(){hs.statusObj.update(translation._("An error occurred while processing your request, please try again later. Your credit card was not charged."),"error",true)}},"q1");var f="Billing Signup Flow";$("#ccRadio:checked").length>0&&(f="Start Free Trial");hs.trackEvent({category:f,action:a.val()+"/"+c.val(),label:d.val(),value:$("#authAttempts").val()})}};
billing.startPaypal=function(){ajaxCall({type:"GET",url:"/ajax/member/billing-start-paypal",success:function(a){a.success=="1"?document.location.href=a.returnUrl+a.token:hs.statusObj.update(translation._("An error occurred while processing your request, please try again later. Your PayPal account was not charged."),"error",true)},error:function(){hs.statusObj.update(translation._("An error occurred while processing your request, please try again later. Your PayPal account was not charged."),"error",
true)}},"q1")};billing.populateCountry=function(){var a=$("#billingCountry");a.length<1||(a.find("option").length<=0&&a.append($("<option/>").attr("value","").text(translation._("Select Country"))).val(""),$(billing.countryList).each(function(c,d){a.append($("<option/>").attr("value",d[0]).text(d[1]))}),a.val(a.attr("currval")),a.bind("change",billing.countryChanged),billing.countryChanged())};
billing.countryChanged=function(){var a=$("#billingCountry"),c=$("#billingState"),d=c.closest("p").find("label");a.val()=="US"?d.html(translation._("State")):a.val()=="CA"?d.html(translation._("Province")):d.html(translation._("State/Province"));var f;billing.stateList[a.val()]!=void 0?(f=$("<select/>"),$(billing.stateList[a.val()]).each(function(a,b){f.append($("<option/>").attr("value",b[0]).text(b[1]))})):f=$("<input/>");f.attr("name",c.attr("name")).attr("id",c.attr("id")).val(c.val());c.replaceWith(f);
return true};billing.showCvvPopup=function(){open("https://secure.ariasystems.net/webclients/HootSuitePay/whatisCVV.php","displayWindow","top=40,left=50,width=480,height=200,scroll=auto");hs.trackEvent({category:"Billing Signup Flow",action:"Why CVV"})};billing.submitCoupon=function(){$("._submitCoupon").hasClass("btn-cta-throbber")||($("._submitCoupon").addClass("btn-cta-throbber"),hs.throbberMgrObj.add("._submitCoupon",'<span class="btn-ts">'+translation.c.LOADING+"</span>"),$("#couponForm").submit())};var languageSwitcher={defaults:{selectSelector:"#languageSelectionForm select[name='language']",langSep:"ar"},init:function(a){var c=this;this.options=$.extend({},this.defaults,a);this.$select=$(this.options.selectSelector);this.$select.length!==0&&(this.$select.find("option[value='"+this.options.langSep+"']:not(:last)").before('<option disabled="disabled">--------------------</option>'),this.$select.bind("change",function(a){c.changeLanguage(a)}))},changeLanguage:function(){hs.statusObj.update(translation._("Switching language..."),
"info",true,8E3);var a=this.$select.find("option:selected").val();ajaxCall({type:"POST",data:"language="+a,url:"/ajax/index/change-language",success:function(a){hs.statusObj.reset();if(a.success)$.isFunction(window.location.reload)?window.location.reload(true):window.location=window.location.href.replace(window.location.hash,"");else if(a.inProgress)return a={width:347,maxHeight:700,resizable:false,draggable:false,position:["center",60],modal:true,title:translation._("HootSuite Translation Project"),
content:hsEjs.getEjs("index/language_translation").render(a)},$.dialogFactory.create("inProgressLanguagePopup",a),false;else a.paymentProcessorUnavailable&&hs.statusObj!=void 0&&hs.statusObj.update(translation._("Sorry, we are unable to complete this operation right now. Please try again later."),"error",true)},error:function(){hs.statusObj.reset()}},"abortOld");return false}};function adminGetUserInfo(){var a=encodeURI($("div._userInfoSection input[name='userEmailOrMemberId']").val());$("img._getUserInfoSpinner").show();a=a.match(/@/)?"?memberEmail="+a.replace("+","%2B"):"?memberId="+a;ajaxCall({url:"/ajax/admin/get-all-user-data"+a,success:function(a){a.error?alert(a.error):$("div._userInfoSection #userInfoResults").html(a.output);$("img._getUserInfoSpinner").hide()}},"q1")}
function adminGetTwitterUserInfo(){var a=$("div._userInfoSection input[name='twitterUsername']").val();$("img._getTwitterUserInfoSpinner").show();ajaxCall({url:"/ajax/admin/get-data-for-twitter-username?username="+a,success:function(a){a.error?alert(a.error):$("div._userInfoSection #userInfoResults").html(a.output);$("img._getTwitterUserInfoSpinner").hide()}},"q1")}
function adminGetUserLinkedinAccounts(){var a=encodeURI($("div._userInfoSection input[name='userEmailOrMemberId']").val()),c=$("img._getUserInfoSpinner"),a="?memberEmail="+a.replace("+","%2B");c.show();ajaxCall({url:"/ajax/admin/get-linkedin-data"+a,success:function(a){a.error?alert(a.error):($("div._userInfoSection #userInfoResults").html(a.output),$("#adminCreateLinkedinCompanyPage ._startOverLink").show(),$("#linkedinCompanyResults").empty(),$("#createdLinkedinCompanyPageSuccessResults").empty());
c.hide()}},"q1")}
function adminGetLinkedinCompanyInfo(a){var c=$("#userInfoResults"),d=c.find("._linkedinCompanyUrl").val();c.find("._errorNoLinkedinCompanyUrl").hide();if(!d||d.length==0)return c.find("._errorNoLinkedinCompanyUrl").show(),false;var f=$("img._getLinkedinAdminInfoSpinner"),a="?snId="+a+"&linkedinCompanyUrl="+encodeURI(d);f.show();ajaxCall({url:"/ajax/admin/get-linkedin-company-data"+a,success:function(a){a.error?alert(a.error):$("#linkedinCompanyResults").html(a.output);f.hide()}},"q1")}
function adminCreateLinkedinCompanyPage(){var a=$("#linkedinCompanyResults"),c=a.find("[name=companyId]").val(),a="?snId="+a.find("[name=snId]").val()+"&companyId="+c,d=$("img._createLinkedinCompanyPageSpinner");d.show();ajaxCall({url:"/ajax/admin/create-linkedin-company-page"+a,success:function(a){a.error?alert(a.error):$("#createdLinkedinCompanyPageSuccessResults").html(a.output);d.hide()}},"q1")}
function adminChangeMigrationStatus(a,c){ajaxCall({url:"/ajax/admin/change-migration-status?memberId="+a+"&status="+c,success:function(a){a.error?alert(a.error):adminGetUserInfo()}},"q1")}function adminClearCCAuthAttempts(a){ajaxCall({url:"/ajax/admin/clear-cc-auth-attempts?memberId="+a,success:function(a){a.error?alert(a.error):adminGetUserInfo()}},"q1")}
function adminObfuscateEmail(a){ajaxCall({url:"/ajax/admin/obfuscate-email?memberId="+a,success:function(a){a.error?alert(a.error):($("div._userInfoSection input[name='userEmail']").val(a.newEmail),adminGetUserInfo())}},"q1")}function adminEditMemberFeatures(){var a=$("#paidFeaturesEditForm").serialize();ajaxCall({url:"/ajax/admin/edit-member-features",data:a,success:function(a){a.error?alert(a.error):adminGetUserInfo()}},"q1")}
function adminSyncFeaturesFromAria(){$("#syncFeaturesButton").hide();$("#syncFeaturesBlurb").show();ajaxCall({url:"/ajax/admin/sync-from-aria?memberId="+$("#memberId").val(),success:function(a){a.error&&alert(a.error)}},"q1")}function adminChangeMemberFlag(a,c){ajaxCall({url:"/ajax/admin/change-member-flag?memberId="+$("#memberId").val()+"&flag="+a+"&val="+(c?"1":"0"),success:function(c){c.error?alert(c.error):$("#"+a+"Blurb").text(" - Updated")}},"q1")}
function adminAddCoupon(){var a=$("#createCouponForm").serialize();ajaxCall({url:"/ajax/admin/add-coupon",data:a,success:function(a){a.error?alert(a.error):($("#searchForm input").val($("#couponCodeInput").val()),$("#searchForm").submit())}},"q1")}
function adminLoadEditCoupon(a){$row=$(a).closest("tr");$row.find("td").each(function(a,d){var f=$(d).attr("field"),e=$(d).text().trim();$("#createCouponForm input[field="+f+"]").val(e)});$("#createCouponArea:visible").length||$("#createCouponArea").slideToggle()}
function adminLoadEditFeature(a){var c=$(a).closest("tr"),d=$(a).closest("td"),f=c.attr("featureid"),a=d.attr("field"),c=d.attr("currentvalue"),e=$("#"+a+"Template").clone();e.val(c).show();e.bind("keypress",function(b){(window.event?window.event.keyCode:b.which)==13&&b.target.blur()});d.html(e);e.focus();e.blur(function(){d.html(e.val());d.attr("currentvalue")!=e.val()&&(d.attr("currentvalue",e.val()),adminChangeFeatureValue(f))})}
function adminChangeFeatureValue(a){var c=$("tr[featureid="+a+"]"),d=c.find("td[field=restriction]").attr("currentvalue"),f=c.find("td[field=value]").attr("currentvalue");ajaxCall({url:"/ajax/admin/update-feature?featureId="+a+"&value="+f+"&restriction="+d,success:function(a){a.error?alert(a.error):c.effect("highlight",{},2E3)}},"q1")}function adminToggleEditForm(){$("#createCouponArea").slideToggle();$("#createCouponArea input,#createCouponArea select").each(function(a,c){$(c).val("")})}
function adminToggleEditApiKeyForm(){$("#editApiKeyArea").slideToggle();$("#editApiKeyArea input").each(function(a,c){$(c).val("")})}
function adminLoadEditApiKey(a){$row=$(a).closest("tr");$row.find("td").each(function(a,d){var f=$(d).attr("field"),e=$(d).text().trim();if(f=="apiKey"||f=="name")$("#editApiKeyForm span[name="+f+"]").html(e);else{if(e=="unlimited")e=-1;else if(e=="Basic"||e=="False")e=0;else if(e=="Advanced/Internal"||e=="True")e=1;$("#editApiKeyForm input[field="+f+"]").val(e)}});$("#editApiKeyForm:visible").length||$("#editApiKeyArea").slideToggle()}
function adminSaveApiKey(){var a=$("#editApiKeyForm").serialize();ajaxCall({url:"/ajax/admin/save-api-key",data:a,success:function(a){a.error?alert(a.error):window.location.reload()}},"q1")};var member=member?member:{};function updateMemberPreferenceWithTimer(a,c,d,f){d||(d=hs.c.delayPrefsMember*1E3);hs.timers.updateMemberPreferenceTimer!=void 0&&(clearTimeout(hs.timers.updateMemberPreferenceTimer),delete hs.timers.updateMemberPreferenceTimer);hs.timers.updateMemberPreferenceTimer=setTimeout(function(){updateMemberPreference(a,c,f)},d)}
function updateMemberPreference(a,c,d){ajaxCall({url:"/ajax/member/update-preference",data:"type="+encodeURIComponent(a)+"&value="+encodeURIComponent(c),complete:function(){$.isFunction(d)&&d()}},"q1")}member.invitation=member.invitation||{};member.invitation.COOKIE_NAME="member_invitation_code";member.invitation.COOKIE_EXPIRY_DAYS=20/1440;member.invitation.NOTE_MAX_LENGTH=200;member.invitation.storeCookie=function(a){$.cookie.create(member.invitation.COOKIE_NAME,a,member.invitation.COOKIE_EXPIRY_DAYS)};
member.invitation.removeCookie=function(){$.cookie.remove(member.invitation.COOKIE_NAME)};member.invitation.logout=function(){$.get(hs.c.rootUrl+"/ajax/member/logout")};member.invitation.acceptLoggedIn=function(a){member.invitation.storeCookie(a);setTimeout(function(){window.location.href=hs.c.rootUrlNoSSL+"/dashboard"},1)};member.invitation.acceptAndLogin=function(a){member.invitation.storeCookie(a);$("#memberLoginForm").submit()};
member.invitation.acceptAndSignup=function(a){member.invitation.storeCookie(a);setTimeout(function(){window.location.href=hs.c.rootUrl+"/signup"},1)};member.invitation.denySubmitClick=function(a){member.invitation.removeCookie();var c=$("input._denyNotes").val(),d=$("#miId").val(),a="code="+a+"&miId="+d+"&notes="+encodeURIComponent(c);hs.throbberMgrObj.add("._denySubmit");$.post(hs.c.rootUrl+"/ajax/member-invitation/reject",a,function(){setTimeout(function(){window.location.href=hs.c.rootUrl},1)})};
member.notificationPopup=function(){var a=function(){var a=this.$anchor.offset();this.$el.css({display:"block",top:a.top+this.$anchor.outerHeight(true),right:$(window).width()-a.left-this.$anchor.outerWidth(true)-30})},c=function(){this.$el.css({display:"none"})},d=function(){hs.reloadBrowser()};return{init:function(){var f=this;this.$container=$("._dashboardAlerts");this.$el=$("#notificationPopup");this.$anchor=$("._showNotificationPopup");this.$container.filter(":visible").length===0&&(this.$container.show(),
this.$el.show().find(".tip").css({left:"auto",right:35}).end().find("._closeNotificationPopup").bind("click",function(){c.call(f);return false}).end().find("._reloadDashboardBtn").bind("click",d).end(),this.$anchor.show().bind("click",function(){a.call(f)}).click())}}}();member.pingServer=function(){ajaxCall({type:"GET",url:"/ajax/member/ping",success:function(a){a&&a.isForce&&hs.c.jsver&&a.jsver!=hs.c.jsver&&member.notificationPopup.init()}},"qmNoAbort")};/*
 In-Field Label jQuery Plugin
 http://fuelyourcoding.com/scripts/infield.html

 Copyright (c) 2009-2010 Doug Neiner
 Dual licensed under the MIT and GPL licenses.
 Uses the same license as jQuery, see:
 http://docs.jquery.com/License

 Slightly modified by Alexandrine Boissiere
 @version 0.1.2
*/
(function(a){a.InFieldLabels=function(c,d,f){var e=this;e.$label=a(c);e.label=c;e.$field=a(d);e.field=d;e.showing=true;e.init=function(){e.options=a.extend({},a.InFieldLabels.defaultOptions,f);if(e.$field.val()!=="")e.$label.hide(),e.showing=false;e.$label.click(function(){e.$field.trigger("focus")});e.$field.focus(function(){e.fadeOnFocus()}).blur(function(){e.checkForEmpty(true)}).bind("keydown.infieldlabel",function(a){e.hideOnChange(a)}).bind("keyup.infieldlabel",function(a){e.showOnChange(a)}).bind("paste",
function(){e.setOpacity(0)}).change(function(){e.checkForEmpty()}).bind("onPropertyChange",function(){e.checkForEmpty()})};e.fadeOnFocus=function(){e.showing&&e.setOpacity(e.options.fadeOpacity)};e.setOpacity=function(a){e.$label.stop().animate({opacity:a},e.options.fadeDuration);e.showing=a>0};e.checkForEmpty=function(a){e.$field.val()===""?(e.prepForShow(),e.setOpacity(a?1:e.options.fadeOpacity)):e.setOpacity(0)};e.prepForShow=function(){e.showing||e.$label.css({opacity:0}).show()};e.hideOnChange=
function(a){if(!(a.keyCode===16||a.keyCode===9||a.keyCode===224||a.keyCode===17||a.keyCode===18)&&e.showing)e.setOpacity(0,600),e.showing=false};e.showOnChange=function(a){if(!(a.keyCode!==8&&a.keyCode!==46)&&e.$field.val().length===0)e.setOpacity(1),e.isShowing=true};e.init()};a.InFieldLabels.defaultOptions={fadeOpacity:0.6,fadeDuration:300};a.fn.improvedPlaceholder=function(c){return this.each(function(){$label=a(this).find("._placeholderLabel");$field=a(this).find("._placeholderField");$field.length===
0||$label.length===0||new a.InFieldLabels($label[0],$field[0],c)})}})(jQuery);function showVideoPopup(a,c,d,f){var f={modal:true,closeOnEscape:true,draggable:true,content:"<div class='large-loading'><img src='"+hs.util.rootifyImage("/themes/"+hs.prefs.theme.toLowerCase()+"/loader.gif")+"' /></div>",title:f,width:c+12,height:d+46,position:["center","center"]},e=$.dialogFactory.create("hsVideoPopup",f);ajaxCall({type:"GET",url:"/ajax/index/hs-video?hash="+a+"&w="+c+"&h="+d,success:function(a){e.html(a.output)}},"qm")}
function showImagePopup(a,c,d){var f=($(window).width()-c)/2,e=($(window).height()-(d+30))/2,a={modal:false,closeOnEscape:true,resizable:false,draggable:true,content:"<img src='"+hs.util.proxify(a)+"' width='"+c+"' height='"+d+"' />",width:c+13,height:d+47,position:[f,e]};$.dialogFactory.create("aboutImagePopup",a)}
$(function(){function a(b){b.preventDefault();c.toggleClass("btn-glass-dropdown");c.find(".icon-19").swapClass("collapse","expand");d.toggleClass("offScreen");setTimeout(function(){f.focus()},1);d.hasClass("offScreen")?$(document).unbind("click.outside_loginBox"):$(document).bind("click.outside_loginBox",function(b){e!==b.target&&!d.has(b.target).length&&a(b)});return false}var c=$("#loginButton"),d=$("#loginBox"),f=d.find("#loginEmail"),e=d.get();c.bind("click",function(){return false}).bind("mousedown",
a).bind("focus",function(b){setTimeout(function(){d.is(".visHide")&&a(b)},1)});f.focus().select();if($("#container").hasClass("home")){var b=$(".feature"),h=function(a,b,c){b.css("opacity",c?"1":"0.5");a.removeClass("animate");$(document).unbind("click.outside_features");setTimeout(function(){a.removeClass("expanded")},400)};b.mouseenter(function(){(!b.hasClass("expanded")||!b.hasClass("animate"))&&b.not($(this)).css("opacity","0.5")}).mouseleave(function(){(!b.hasClass("expanded")||!b.hasClass("animate"))&&
b.not($(this)).css("opacity","1")}).click(function(){var a=$(this),c=this,d=b.not(a);d.hasClass("expanded")||(!a.hasClass("expanded")||!a.hasClass("animate")?(a.addClass("expanded").addClass("animate"),d.css("opacity","0"),$(document).bind("click.outside_features",function(b){c!==b.target&&!a.has(b.target).length&&h(a,d,true)})):h(a,d,false))});var k=$("#memberSignupForm"),l=$("._submitSignup");l.bind("click",function(){k.submit();return false});k.bind("keypress",function(a){a.keyCode==13&&(l.click(),
a.preventDefault())});$("._placeholderContainer").improvedPlaceholder();k.find("#signupEmail").focus()}openid.init("openid_identifier");if($("#planMatrix").filter(".plansCompare").length||$("#page .comparisonChart").length)plans.initFeatureInfoPopup();else if($("._planEnterprise").length)typeof userInfoSubmitted!=="undefined"&&plans.enterprise.init(userInfoSubmitted);else if($("._planPro").length){if(typeof billingTiersObject!=="undefined")billing.tiers=billingTiersObject;plans.pro.init(isMemberInShoulderGroup,
userInfoSubmitted)}if($("#benefits").length){var m=$("#benefits");m.delegate("._tab","click",function(){var a=$(this);m.find("._tab").removeClass("active");a.addClass("active");m.find("._section").hide().filter(".content-"+a.data("section")).show()})}$("#priceDisclaimer").length&&$("#priceDisclaimer").bind("click",function(){$.fancybox($("#priceDisclaimerPopup"),{autoSize:false,height:520,width:600,openEffect:"fade",closeEffect:"fade",padding:10,fitToView:false});return false});languageSwitcher.init();
$("._lightbox").fancybox()});(function(a,c,d){var f=d(a),e=d(c),b=d.fancybox=function(){b.open.apply(this,arguments)},h=false,k=null;d.extend(b,{version:"2.0.2",defaults:{padding:0,margin:20,width:800,height:600,minWidth:200,minHeight:400,maxWidth:9999,maxHeight:9999,autoSize:true,fitToView:true,aspectRatio:false,topRatio:0.5,fixed:!d.browser.msie||d.browser.version>6,scrolling:"auto",wrapCSS:"fancybox-default",arrows:true,closeBtn:true,closeClick:false,nextClick:false,mouseWheel:true,autoPlay:false,playSpeed:3E3,modal:false,
loop:true,ajax:{},keys:{next:[13,32,34,39,40],prev:[8,33,37,38],close:[27]},index:0,type:null,href:null,content:null,title:null,tpl:{wrap:'<div class="fancybox-wrap"><div class="fancybox-outer"><div class="fancybox-inner"></div></div></div>',image:'<img class="fancybox-image" src="{href}" alt="" />',iframe:'<iframe class="fancybox-iframe" name="fancybox-frame{rnd}" frameborder="0" hspace="0" '+(d.browser.msie?'allowtransparency="true""':"")+' scrolling="{scrolling}" src="{href}"></iframe>',swf:'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"><param name="wmode" value="transparent" /><param name="allowfullscreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="movie" value="{href}" /><embed src="{href}" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="100%" height="100%" wmode="transparent"></embed></object>',
error:'<p class="fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',closeBtn:'<div title="Close" class="fancybox-item fancybox-close"></div>',next:'<a title="Next" class="fancybox-item fancybox-next"><span></span></a>',prev:'<a title="Previous" class="fancybox-item fancybox-prev"><span></span></a>'},openEffect:"elastic",openSpeed:500,openEasing:"easeOutBack",openOpacity:true,openMethod:"zoomIn",closeEffect:"elastic",closeSpeed:500,closeEasing:"easeInBack",closeOpacity:true,
closeMethod:"zoomOut",nextEffect:"none",nextSpeed:300,nextEasing:"swing",nextMethod:"changeIn",prevEffect:"none",prevSpeed:300,prevEasing:"swing",prevMethod:"changeOut",helpers:{overlay:{speedIn:0,speedOut:0,opacity:0.85,css:{cursor:"pointer","background-color":"rgba(0, 0, 0, 0.85)"},closeClick:true},title:{type:"over"}},onCancel:d.noop,beforeLoad:d.noop,afterLoad:d.noop,beforeShow:d.noop,afterShow:d.noop,beforeClose:d.noop,afterClose:d.noop},group:{},opts:{},coming:null,current:null,isOpen:false,
isOpened:false,wrap:null,outer:null,inner:null,player:{timer:null,isActive:false},ajaxLoad:null,imgPreload:null,transitions:{},helpers:{},open:function(a,c){d.isArray(a)||(a=[a]);if(a.length)b.close(true),b.opts=d.extend(true,{},b.defaults,c),b.group=a,b._start(b.opts.index||0)},cancel:function(){if(!(b.coming&&false===b.trigger("onCancel"))&&(b.coming=null,b.hideLoading(),b.ajaxLoad&&b.ajaxLoad.abort(),b.ajaxLoad=null,b.imgPreload))b.imgPreload.onload=b.imgPreload.onabort=b.imgPreload.onerror=null},
close:function(a){b.cancel();if(b.current&&false!==b.trigger("beforeClose"))b.unbindEvents(),!b.isOpen||a&&a[0]===true?(d(".fancybox-wrap").stop().trigger("onReset").remove(),b._afterZoomOut()):(b.isOpen=b.isOpened=false,d(".fancybox-item").remove(),b.wrap.stop(true).removeClass("fancybox-opened"),b.inner.css("overflow","hidden"),b.transitions[b.current.closeMethod]())},play:function(a){var c=function(){clearTimeout(b.player.timer)},e=function(){c();if(b.current&&b.player.isActive)b.player.timer=
setTimeout(b.next,b.current.playSpeed)},f=function(){c();d("body").unbind(".player");b.player.isActive=false;b.trigger("onPlayEnd")};if(b.player.isActive||a&&a[0]===false)f();else if(b.current&&(b.current.loop||b.current.index<b.group.length-1))b.player.isActive=true,e(),d("body").bind({"onCancel.player afterShow.player onUpdate.player":e,"beforeClose.player":f,"beforeLoad.player":c}),b.trigger("onPlayStart")},next:function(){b.current&&b.jumpto(b.current.index+1)},prev:function(){b.current&&b.jumpto(b.current.index-
1)},jumpto:function(a){b.current&&(a=parseInt(a,10),b.group.length>1&&b.current.loop&&(a>=b.group.length?a=0:a<0&&(a=b.group.length-1)),typeof b.group[a]!=="undefined"&&(b.cancel(),b._start(a)))},reposition:function(a){b.isOpen&&b.wrap.css(b._getPosition(a))},update:function(){b.isOpen&&(h||(k=setInterval(function(){if(h&&(h=false,clearTimeout(k),b.current)){if(b.current.autoSize)b.inner.height("auto"),b.current.height=b.inner.height();b._setDimension();b.current.canGrow&&b.inner.height("auto");b.reposition();
b.trigger("onUpdate")}},100)),h=true)},toggle:function(){if(b.isOpen)b.current.fitToView=!b.current.fitToView,b.update()},hideLoading:function(){d("#fancybox-loading").remove()},showLoading:function(){b.hideLoading();d('<div id="fancybox-loading"></div>').click(b.cancel).appendTo("body")},getViewport:function(){return{x:f.scrollLeft(),y:f.scrollTop(),w:f.width(),h:f.height()}},unbindEvents:function(){e.unbind(".fb");f.unbind(".fb")},bindEvents:function(){var a=b.current,c=a.keys;a&&(f.bind("resize.fb, orientationchange.fb",
b.update),c&&e.bind("keydown.fb",function(a){d.inArray(a.target.tagName.toLowerCase(),["input","textarea","select","button"])>-1||(d.inArray(a.keyCode,c.close)>-1?(b.close(),a.preventDefault()):d.inArray(a.keyCode,c.next)>-1?(b.next(),a.preventDefault()):d.inArray(a.keyCode,c.prev)>-1&&(b.prev(),a.preventDefault()))}),d.fn.mousewheel&&a.mouseWheel&&b.group.length>1&&b.wrap.bind("mousewheel.fb",function(a,c){if(d(a.target).get(0).clientHeight===0||d(a.target).get(0).scrollHeight===d(a.target).get(0).clientHeight)a.preventDefault(),
b[c>0?"prev":"next"]()}))},trigger:function(a){var c,e=d.inArray(a,["onCancel","beforeLoad","afterLoad"])>-1?"coming":"current";if(b[e]){d.isFunction(b[e][a])&&(c=b[e][a].apply(b[e],Array.prototype.slice.call(arguments,1)));if(c===false)return false;b[e].helpers&&d.each(b[e].helpers,function(c,e){if(e&&typeof b.helpers[c]!=="undefined"&&d.isFunction(b.helpers[c][a]))b.helpers[c][a](e)});d.event.trigger(a+".fb")}},isImage:function(a){return a&&a.match(/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i)},isSWF:function(a){return a&&
a.match(/\.(swf)(.*)?$/i)},_start:function(a){var c=b.group[a]||null,e,f,j,g=d.extend(true,{},b.opts,d.isPlainObject(c)?c:{},{index:a,element:c});if(typeof g.margin==="number")g.margin=[g.margin,g.margin,g.margin,g.margin];g.modal&&d.extend(true,g,{closeBtn:false,closeClick:false,nextClick:false,arrows:false,mouseWheel:false,keys:null,helpers:{overlay:{css:{cursor:"auto"},closeClick:false}}});b.coming=g;if(false===b.trigger("beforeLoad"))b.coming=null;else{if(typeof c==="object"&&(c.nodeType||c instanceof
d))e=true,g.href=d(c).attr("href")||g.href,g.title=d(c).attr("title")||g.title,d.metadata&&d.extend(g,d(c).metadata());f=g.type;a=g.href;if(!f)e&&(j=d(c).data("fancybox-type"),!j&&c.className&&(j=(j=c.className.match(/fancybox\.(\w+)/))?j[1]:false)),j?f=j:a&&(b.isImage(a)?f="image":b.isSWF(a)?f="swf":a.match(/^#/)&&(f="inline")),f||(f=e?"inline":"html"),g.type=f;if(f==="inline"||f==="html"){if(!g.content)g.content=f==="inline"&&a?d(a):c;g.content.length||(f=null)}else g.href=a||c,g.href||(f=null);
g.group=b.group;f==="image"?b._loadImage():f==="ajax"?b._loadAjax():f?b._afterLoad():b._error()}},_error:function(){b.coming.type="html";b.coming.minHeight=0;b.coming.autoSize=true;b.coming.content=b.coming.tpl.error;b._afterLoad()},_loadImage:function(){b.imgPreload=new Image;b.imgPreload.onload=function(){this.onload=this.onerror=null;b.coming.width=this.width;b.coming.height=this.height;b._afterLoad()};b.imgPreload.onerror=function(){this.onload=this.onerror=null;b._error()};b.imgPreload.src=b.coming.href;
b.imgPreload.complete||b.showLoading()},_loadAjax:function(){b.showLoading();b.ajaxLoad=d.ajax(d.extend({},b.coming.ajax,{url:b.coming.href,error:function(a,c,d){c!=="abort"?(b.coming.content=d,b._error()):b.hideLoading()},success:function(a,c){if(c==="success")b.coming.content=a,b._afterLoad()}}))},_afterLoad:function(){b.hideLoading();if(!b.coming||false===b.trigger("afterLoad",b.current))b.coming=false;else if(b.isOpened?(d(".fancybox-item").remove(),b.wrap.stop(true).removeClass("fancybox-opened"),
b.transitions[b.current.prevMethod]()):d(".fancybox-wrap").stop().trigger("onReset").remove(),b.isOpen=false,b.current=b.coming,b.coming=false,b.wrap=d(b.current.tpl.wrap).addClass(b.current.wrapCSS).hide().appendTo("body"),b.outer=d(".fancybox-outer",b.wrap).css("padding",b.current.padding+"px"),b.inner=d(".fancybox-inner",b.wrap),b._setContent(),b.unbindEvents(),b.bindEvents(),b.trigger("beforeShow"),b._setDimension(),b.isOpened)b.transitions[b.current.nextMethod]();else b.transitions[b.current.openMethod]()},
_setContent:function(){var a,c,e=b.current,f=e.type;switch(f){case "inline":case "ajax":case "html":f==="inline"?(a=e.content.show().detach(),a.parent().hasClass("fancybox-inner")&&a.parents(".fancybox-wrap").trigger("onReset").remove(),d(b.wrap).bind("onReset",function(){a.appendTo("body").hide()})):a=e.content;if(e.autoSize)c=d('<div class="fancybox-tmp"></div>').appendTo(d("body")).append(a),e.width=c.outerWidth(),e.height=c.outerHeight(true),a=c.contents().detach(),c.remove();break;case "image":a=
e.tpl.image.replace("{href}",e.href);e.aspectRatio=true;break;case "swf":a=e.tpl.swf.replace(/\{width\}/g,e.width).replace(/\{height\}/g,e.height).replace(/\{href\}/g,e.href);break;case "iframe":a=e.tpl.iframe.replace("{href}",e.href).replace("{scrolling}",e.scrolling).replace("{rnd}",(new Date).getTime())}if(d.inArray(f,["image","swf","iframe"])>-1)e.autoSize=false,e.scrolling=false;b.inner.append(a)},_setDimension:function(){var a=b.current,c=b.getViewport(),e=a.margin,f=a.padding*2,j=a.width+f,
g=a.height+f,h=a.width/a.height,k=a.maxWidth,n=a.maxHeight,o=a.minWidth,p=a.minHeight;c.w-=e[1]+e[3];c.h-=e[0]+e[2];j.toString().indexOf("%")>-1&&(j=c.w*parseFloat(j)/100);g.toString().indexOf("%")>-1&&(g=c.h*parseFloat(g)/100);a.fitToView&&(k=Math.min(c.w,k),n=Math.min(c.h,n));k=Math.max(o,k)*0.9;n=Math.max(p,n)*0.9;a.aspectRatio?(j>k&&(j=k,g=(j-f)/h+f),g>n&&(g=n,j=(g-f)*h+f),j<o&&(j=o,g=(j-f)/h+f),g<p&&(g=p,j=(g-f)*h+f)):(j=Math.max(o,Math.min(j,k)),g=Math.max(p,Math.min(g,n)));j=Math.round(j);
g=Math.round(g);d(b.wrap.add(b.outer).add(b.inner)).width("auto").height("auto");b.inner.width(j-f).height(g-f);b.wrap.width(j);e=b.wrap.height();if(j>k||e>n)for(;(j>k||e>n)&&j>o&&e>p;)g-=10,a.aspectRatio?(j=Math.round((g-f)*h+f),j<o&&(j=o,g=(j-f)/h+f)):j-=10,b.inner.width(j-f).height(g-f),b.wrap.width(j),e=b.wrap.height();a.dim={width:j,height:e};a.canGrow=a.autoSize&&g>p&&g<n;a.canShrink=false;a.canExpand=false;if(j-f<a.width||g-f<a.height)a.canExpand=true;else if((j>c.w||e>c.h)&&j>o&&g>p)a.canShrink=
true},_getPosition:function(a){var c=b.getViewport(),d=b.current.margin,e=b.wrap.width()+d[1]+d[3],f=b.wrap.height()+d[0]+d[2],g={position:"absolute",top:d[0]+c.y,left:d[3]+c.x};if(b.current.fixed&&(!a||a[0]===false)&&f<=c.h&&e<=c.w)g={position:"fixed",top:d[0],left:d[3]};g.top=Math.ceil(Math.max(g.top,g.top+(c.h-f)*b.current.topRatio))+"px";g.left=Math.ceil(Math.max(g.left,g.left+(c.w-e)*0.5))+"px";return g},_afterZoomIn:function(){var a=b.current;b.isOpen=b.isOpened=true;b.wrap.addClass("fancybox-opened").css("overflow",
"visible");b.update();b.inner.css("overflow",a.scrolling==="auto"?"auto":a.scrolling==="yes"?"scroll":"hidden");if(a.closeClick||a.nextClick)b.inner.bind("click.fb",a.nextClick?b.next:b.close);a.closeBtn&&d(b.current.tpl.closeBtn).appendTo(b.wrap).bind("click.fb",b.close);a.arrows&&b.group.length>1&&((a.loop||a.index>0)&&d(a.tpl.prev).appendTo(b.wrap).bind("click.fb",b.prev),(a.loop||a.index<b.group.length-1)&&d(a.tpl.next).appendTo(b.wrap).bind("click.fb",b.next));b.trigger("afterShow");if(b.opts.autoPlay&&
!b.player.isActive)b.opts.autoPlay=false,b.play()},_afterZoomOut:function(){b.trigger("afterClose");b.wrap.trigger("onReset").remove();d.extend(b,{group:{},opts:{},current:null,isOpened:false,isOpen:false,wrap:null,outer:null,inner:null})}});b.transitions={getOrigPosition:function(){var a=b.current.element,c={},e=50,f=50,j;a&&a.nodeName&&d(a).is(":visible")?(j=d(a).find("img:first"),j.length?(c=j.offset(),e=j.outerWidth(),f=j.outerHeight()):c=d(a).offset()):(a=b.getViewport(),c.top=a.y+(a.h-f)*0.5,
c.left=a.x+(a.w-e)*0.5);return c={top:Math.ceil(c.top)+"px",left:Math.ceil(c.left)+"px",width:Math.ceil(e)+"px",height:Math.ceil(f)+"px"}},step:function(a,c){var d,e,f;if(c.prop==="width"||c.prop==="height")e=f=Math.ceil(a-b.current.padding*2),c.prop==="height"&&(d=(a-c.start)/(c.end-c.start),c.start>c.end&&(d=1-d),e-=b.innerSpace*d,f-=b.outerSpace*d),b.inner[c.prop](e),b.outer[c.prop](f)},zoomIn:function(){var a,c;a=b.current.dim;c=a.height-b.current.padding*2;b.innerSpace=c-b.inner.height();b.outerSpace=
c-b.outer.height();if(b.current.openEffect==="elastic"){c=d.extend({},a,b._getPosition(true));delete c.position;a=this.getOrigPosition();if(b.current.openOpacity)a.opacity=0,c.opacity=1;b.wrap.css(a).show().animate(c,{duration:b.current.openSpeed,easing:b.current.openEasing,step:this.step,complete:b._afterZoomIn})}else b.wrap.css(d.extend({},b.current.dim,b._getPosition())),b.current.openEffect==="fade"?b.wrap.fadeIn(b.current.openSpeed,b._afterZoomIn):(b.wrap.show(),b._afterZoomIn())},zoomOut:function(){var a;
a=b.wrap.height()-b.current.padding*2;if(b.current.closeEffect==="elastic"){b.wrap.css("position")==="fixed"&&b.wrap.css(b._getPosition(true));b.innerSpace=a-b.inner.height();b.outerSpace=a-b.outer.height();a=this.getOrigPosition();if(b.current.closeOpacity)a.opacity=0;b.wrap.animate(a,{duration:b.current.closeSpeed,easing:b.current.closeEasing,step:this.step,complete:b._afterZoomOut})}else b.wrap.fadeOut(b.current.closeEffect==="fade"?b.current.Speed:0,b._afterZoomOut)},changeIn:function(){var a;
b.current.nextEffect==="elastic"?(a=b._getPosition(true),a.opacity=0,a.top=parseInt(a.top,10)-200+"px",b.wrap.css(a).show().animate({opacity:1,top:"+=200px"},{duration:b.current.nextSpeed,complete:b._afterZoomIn})):(b.wrap.css(b._getPosition()),b.current.nextEffect==="fade"?b.wrap.hide().fadeIn(b.current.nextSpeed,b._afterZoomIn):(b.wrap.show(),b._afterZoomIn()))},changeOut:function(){function a(){d(this).trigger("onReset").remove()}b.wrap.removeClass("fancybox-opened");b.current.prevEffect==="elastic"?
b.wrap.animate({opacity:0,top:"+=200px"},{duration:b.current.prevSpeed,complete:a}):b.wrap.fadeOut(b.current.prevEffect==="fade"?b.current.prevSpeed:0,a)}};b.helpers.overlay={overlay:null,update:function(){var a,b;this.overlay.width(0).height(0);d.browser.msie?(a=Math.max(c.documentElement.scrollWidth,c.body.scrollWidth),b=Math.max(c.documentElement.offsetWidth,c.body.offsetWidth),a=a<b?f.width():a):a=e.width();this.overlay.width(a).height(e.height())},beforeShow:function(a){if(!this.overlay)this.overlay=
d('<div id="fancybox-overlay"></div>').css(a.css||{background:"black"}).appendTo("body"),this.update(),a.closeClick&&this.overlay.bind("click.fb",b.close),f.bind("resize.fb",d.proxy(this.update,this)),this.overlay.fadeTo(a.speedIn||"fast",a.opacity||1)},onUpdate:function(){this.update()},afterClose:function(a){this.overlay&&this.overlay.fadeOut(a.speedOut||"fast",function(){d(this).remove()});this.overlay=null}};b.helpers.title={beforeShow:function(a){var c;if(c=b.current.title)c=d('<div class="fancybox-title fancybox-title-'+
a.type+'-wrap">'+c+"</div>").appendTo("body"),a.type==="float"&&(c.wrapInner('<span class="child"></span>'),b.current.margin[2]+=Math.abs(parseInt(c.css("margin-bottom"),10))),c.appendTo(a.type==="over"?b.inner:a.type==="outside"?b.wrap:b.outer)}};d.fn.fancybox=function(a){function c(a){var e=[],k=false,l=d(this).data("fancybox-group");a.preventDefault();if(typeof l!=="undefined")k=l?"data-fancybox-group":false;else if(this.rel&&this.rel!==""&&this.rel!=="nofollow")l=this.rel,k="rel";k&&(e=h.length?
d(h).filter("["+k+'="'+l+'"]'):d("["+k+'="'+l+'"]'));e.length?(f.index=e.index(this),b.open(e.get(),f)):b.open(this,f);return false}var f=a||{},h=this.selector||"";h?e.undelegate(h,"click.fb-start").delegate(h,"click.fb-start",c):d(this).unbind("click.fb-start").bind("click.fb-start",c);return this}})(window,document,jQuery);
