var providers_large={google:{name:"Google",url:"https://www.google.com/accounts/o8/id"},yahoo:{name:"Yahoo",url:"http://me.yahoo.com/"},myopenid:{name:"MyOpenId",url:"http://myopenid.com/"},mixi:{name:"Mixi",url:"http://mixi.jp"},openid:{name:"OpenID",label:"Enter your OpenID.",url:null}},providers_small={},providers=$.extend({},providers_large,providers_small),openid={cookie_expires:180,cookie_name:"openid_provider",cookie_path:"/",input_id:null,provider_url:null,init:function(a){var b=$("#openid_btns");
this.input_id=a;$("#openid_choice").show();$("#openid_input_area").empty();$.each(providers_large,function(a){b.append(openid.getBoxHTML(providers_large[a],"large",".gif"))});if(providers_small)for(id in b.append("<br/>"),providers_small)b.append(this.getBoxHTML(providers_small[id],"small",".ico"));$("#openid_form").submit(this.submit);(a=this.readCookie())&&this.signin(a,true)},getBoxHTML:function(a,b){if(!a||!a.name||!a.name.toLowerCase)return null;var c=a.name.toLowerCase();return'<a title="'+
a.name+'" href="javascript: openid.signin(\''+c+'\');"class="'+c+" openid_"+b+'_btn rb-a-3"></a>'},signin:function(a,b){var c=providers[a];if(c)this.highlight(a),this.setCookie(a),c.label?(this.useInputBox(c),this.provider_url=c.url):(this.setOpenIdUrl(c.url),this.provider_url=c.url,b||$("#openid_form").submit())},submit:function(){var a=openid.provider_url;a&&(a=a.replace("{username}",$("#openid_username").val()),openid.setOpenIdUrl(a));return true},setOpenIdUrl:function(a){var b=$("#"+this.input_id);
b.length>0?b.val(a):$("#openid_form").append('<input type="hidden" id="'+this.input_id+'" name="'+this.input_id+'" value="'+a+'"/>')},highlight:function(a){var b=$("#openid_highlight");b&&b.replaceWith($("#openid_highlight a")[0]);$("#openid_form").attr("showhighlight")!="false"&&$("."+a).wrap('<div id="openid_highlight"></div>')},setCookie:function(a){var b=new Date;b.setTime(b.getTime()+this.cookie_expires*864E5);b="; expires="+b.toGMTString();document.cookie=this.cookie_name+"="+a+b+"; path="+
this.cookie_path},readCookie:function(){for(var a=this.cookie_name+"=",b=document.cookie.split(";"),c=0;c<b.length;c++){for(var f=b[c];f.charAt(0)==" ";)f=f.substring(1,f.length);if(f.indexOf(a)==0)return f.substring(a.length,f.length)}return null},useInputBox:function(a){var b=$("#openid_input_area"),c="",f="openid_username",e="",d=a.label;d&&(c="<p>"+d+"</p>");if(a.name=="OpenID")f=this.input_id,e="http://";c+='<input id="'+f+'" class="action" type="text" name="'+f+'" value="'+e+'" /><a href="#" onclick="$(\'#openid_form\').submit(); return false;" id="openid_submit" class="btn-cmt">Sign In</a>';
(a=$("#"+this.input_id))&&a.remove();b.empty();b.append(c);$("#"+f).focus()}};var hsEjs=hsEjs?hsEjs:{};hsEjs.getEjs=function(a){var b=null;return b=typeof hs.ejsPackage=="object"&&hs.ejsPackage.hasOwnProperty(a)?new EJS({text:hs.ejsPackage[a]}):new EJS({url:hs.c.jsTemplateRootUrl+a+".ejs"})};hsEjs.loadPackage=function(){jsonpCall({url:hs.util.rootifyJs("/ejs-package.js"),cache:true})};hsEjs.ejsPackageCallback=function(a){hs.ejsPackage=a};hsEjs.cleanPage=function(a,b){return hs.str.clean(a,b)};(function(){var a=function(a,b){for(var e=b.exec(a),d=[],h;e!=null;)h=e.index,h!=0&&(a.substring(0,h),d.push(a.substring(0,h)),a=a.slice(h)),d.push(e[0]),a=a.slice(e[0].length),e=b.exec(a);!a==""&&d.push(a);return d},b=function(a,b){for(var e in b)b.hasOwnProperty(e)&&(a[e]=b[e])};EJS=function(a){a=typeof a=="string"?{view:a}:a;this.set_options(a);if(a.precompiled)this.template={},this.template.process=a.precompiled,EJS.update(this.name,this);else{if(a.element){if(typeof a.element=="string"){var b=
a.element;a.element=document.getElementById(a.element);if(a.element==null)throw b+"does not exist!";}this.text=a.element.value?a.element.value:a.element.innerHTML;this.name=a.element.id;this.type="["}else if(a.url){a.url=EJS.endExt(a.url,this.extMatch);this.name=this.name?this.name:a.url;var b=a.url,e=EJS.get(this.name,this.cache);if(e)return e;if(e==EJS.INVALID_PATH)return null;try{this.text=EJS.request(b+(this.cache?"":"?"+Math.random()))}catch(d){}if(this.text==null)throw{type:"EJS",message:"There is no template at "+
b};}e=new EJS.Compiler(this.text,this.type);e.compile(a,this.name);EJS.update(this.name,this);this.template=e}};EJS.prototype={render:function(a,b){a=a||{};this._extra_helpers=b;var e=new EJS.Helpers(a,b||{});return this.template.process.call(a,a,e)},update:function(a,b){typeof a=="string"&&(a=document.getElementById(a));if(b==null)return _template=this,function(b){EJS.prototype.update.call(_template,a,b)};typeof b=="string"?(params={},params.url=b,_template=this,params.onComplete=function(b){b=eval(b.responseText);
EJS.prototype.update.call(_template,a,b)},EJS.ajax_request(params)):a.innerHTML=this.render(b)},out:function(){return this.template.out},set_options:function(a){this.type=a.type||EJS.type;this.cache=a.cache!=null?a.cache:EJS.cache;this.text=a.text||null;this.name=a.name||null;this.ext=a.ext||EJS.ext;this.extMatch=RegExp(this.ext.replace(/\./,"."))}};EJS.endExt=function(a,b){if(!a)return null;b.lastIndex=0;return a+(b.test(a)?"":this.ext)};EJS.Scanner=function(a,f,e){b(this,{left_delimiter:f+"%",right_delimiter:"%"+
e,double_left:f+"%%",double_right:"%%"+e,left_equal:f+"%=",left_comment:f+"%#"});this.SplitRegexp=f=="["?/(\[%%)|(%%\])|(\[%=)|(\[%#)|(\[%)|(%\]\n)|(%\])|(\n)/:RegExp("("+this.double_left+")|(%%"+this.double_right+")|("+this.left_equal+")|("+this.left_comment+")|("+this.left_delimiter+")|("+this.right_delimiter+"\n)|("+this.right_delimiter+")|(\n)");this.source=a;this.stag=null;this.lines=0};EJS.Scanner.to_text=function(a){return a==null||a===void 0?"":a instanceof Date?a.toDateString():a.toString?
a.toString():""};EJS.Scanner.prototype={scan:function(b){scanline=this.scanline;regex=this.SplitRegexp;if(!this.source=="")for(var f=a(this.source,/\n/),e=0;e<f.length;e++)this.scanline(f[e],regex,b)},scanline:function(b,f,e){this.lines++;b=a(b,f);for(f=0;f<b.length;f++){var d=b[f];if(d!=null)try{e(d,this)}catch(h){throw{type:"EJS.Scanner",line:this.lines};}}}};EJS.Buffer=function(a,b){this.line=[];this.script="";this.pre_cmd=a;this.post_cmd=b;for(var e=0;e<this.pre_cmd.length;e++)this.push(a[e])};
EJS.Buffer.prototype={push:function(a){this.line.push(a)},cr:function(){this.script+=this.line.join("; ");this.line=[];this.script+="\n"},close:function(){if(this.line.length>0){for(var a=0;a<this.post_cmd.length;a++)this.push(pre_cmd[a]);this.script+=this.line.join("; ");line=null}}};EJS.Compiler=function(a,b){this.pre_cmd=["var ___ViewO = [];"];this.post_cmd=[];this.source=" ";if(a!=null){if(typeof a=="string")a=a.replace(/\r\n/g,"\n"),this.source=a=a.replace(/\r/g,"\n");else if(a.innerHTML)this.source=
a.innerHTML;if(typeof this.source!="string")this.source=""}var b=b||"<",e=">";switch(b){case "[":e="]";break;case "<":break;default:throw b+" is not a supported deliminator";}this.scanner=new EJS.Scanner(this.source,b,e);this.out=""};EJS.Compiler.prototype={compile:function(a,b){a=a||{};this.out="";var e=new EJS.Buffer(this.pre_cmd,this.post_cmd),d="",h=function(a){a=a.replace(/\\/g,"\\\\");a=a.replace(/\n/g,"\\n");return a=a.replace(/"/g,'\\"')};this.scanner.scan(function(a,b){if(b.stag==null)switch(a){case "\n":d+=
"\n";e.push('___ViewO.push("'+h(d)+'");');e.cr();d="";break;case b.left_delimiter:case b.left_equal:case b.left_comment:b.stag=a;d.length>0&&e.push('___ViewO.push("'+h(d)+'")');d="";break;case b.double_left:d+=b.left_delimiter;break;default:d+=a}else switch(a){case b.right_delimiter:switch(b.stag){case b.left_delimiter:d[d.length-1]=="\n"?(d=d.substr(0,d.length-1),e.push(d),e.cr()):e.push(d);break;case b.left_equal:e.push("___ViewO.push((EJS.Scanner.to_text("+d+")))")}b.stag=null;d="";break;case b.double_right:d+=
b.right_delimiter;break;default:d+=a}});d.length>0&&e.push('___ViewO.push("'+h(d)+'")');e.close();this.out=e.script+";";var l="/*"+b+"*/this.process = function(_CONTEXT,_VIEW) { try { with(_VIEW) { with (_CONTEXT) {"+this.out+" return ___ViewO.join('');}}}catch(e){e.lineNumber=null;throw e;}};";try{eval(l)}catch(g){if(typeof JSLINT!="undefined"){JSLINT(this.out);for(var j=0;j<JSLINT.errors.length;j++)if(l=JSLINT.errors[j],l.reason!="Unnecessary semicolon."){l.line++;j=Error();j.lineNumber=l.line;
j.message=l.reason;if(a.view)j.fileName=a.view;throw j;}}else throw g;}}};EJS.config=function(a){EJS.cache=a.cache!=null?a.cache:EJS.cache;EJS.type=a.type!=null?a.type:EJS.type;EJS.ext=a.ext!=null?a.ext:EJS.ext;var b=EJS.templates_directory||{};EJS.templates_directory=b;EJS.get=function(a,d){return d==false?null:b[a]?b[a]:null};EJS.update=function(a,d){a!=null&&(b[a]=d)};EJS.INVALID_PATH=-1};EJS.config({cache:true,type:"<",ext:".ejs"});EJS.Helpers=function(a,f){this._data=a;this._extras=f;b(this,
f)};EJS.Helpers.prototype={view:function(a,b,e){if(!e)e=this._extras;if(!b)b=this._data;return(new EJS(a)).render(b,e)},to_text:function(a,b){return a==null||a===void 0?b||"":a instanceof Date?a.toDateString():a.toString?a.toString().replace(/\n/g,"<br />").replace(/''/g,"'"):""}};EJS.newRequest=function(){for(var a=[function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new XMLHttpRequest},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],b=0;b<a.length;b++)try{var e=a[b]();
if(e!=null)return e}catch(d){}};EJS.request=function(a){var b=new EJS.newRequest;b.open("GET",a,false);try{b.send(null)}catch(e){return null}return b.status==404||b.status==2||b.status==0&&b.responseText==""?null:b.responseText};EJS.ajax_request=function(a){a.method=a.method?a.method:"GET";var b=new EJS.newRequest;b.onreadystatechange=function(){if(b.readyState==4)a.onComplete(b)};b.open(a.method,a.url);b.send(null)}})();EJS.Helpers.prototype.date_tag=function(a,b){b instanceof Date||(b=new Date);for(var c="January,February,March,April,May,June,July,August,September,October,November,December".split(","),f=[],e=[],d=[],h=b.getFullYear(),l=b.getMonth(),g=b.getDate(),j=h-15;j<h+15;j++)f.push({value:j,text:j});for(j=0;j<12;j++)e.push({value:j,text:c[j]});for(c=0;c<31;c++)d.push({value:c+1,text:c+1});f=this.select_tag(a+"[year]",h,f,{id:a+"[year]"});e=this.select_tag(a+"[month]",l,e,{id:a+"[month]"});d=this.select_tag(a+
"[day]",g,d,{id:a+"[day]"});return f+e+d};EJS.Helpers.prototype.form_tag=function(a,b){b=b||{};b.action=a;if(b.multipart==true)b.method="post",b.enctype="multipart/form-data";return this.start_tag_for("form",b)};EJS.Helpers.prototype.form_tag_end=function(){return this.tag_end("form")};EJS.Helpers.prototype.hidden_field_tag=function(a,b,c){return this.input_field_tag(a,b,"hidden",c)};
EJS.Helpers.prototype.input_field_tag=function(a,b,c,f){f=f||{};f.id=f.id||a;f.value=b||"";f.type=c||"text";f.name=a;return this.single_tag_for("input",f)};EJS.Helpers.prototype.is_current_page=function(a){return window.location.href==a||window.location.pathname==a?true:false};
EJS.Helpers.prototype.link_to=function(a,b,c){a||(a="null");c||(c={});if(c.confirm)c.onclick=' var ret_confirm = confirm("'+c.confirm+'"); if(!ret_confirm){ return false;} ',c.confirm=null;c.href=b;return this.start_tag_for("a",c)+a+this.tag_end("a")};
EJS.Helpers.prototype.submit_link_to=function(a,b,c){a||(a="null");c||(c={});c.onclick=c.onclick||"";if(c.confirm)c.onclick=' var ret_confirm = confirm("'+c.confirm+'"); if(!ret_confirm){ return false;} ',c.confirm=null;c.value=a;c.type="submit";c.onclick=c.onclick+(b?this.url_for(b):"")+"return false;";return this.start_tag_for("input",c)};EJS.Helpers.prototype.link_to_if=function(a,b,c,f,e,d){return this.link_to_unless(a==false,b,c,f,e,d)};
EJS.Helpers.prototype.link_to_unless=function(a,b,c,f,e){f=f||{};return a?e&&typeof e=="function"?e(b,c,f,e):b:this.link_to(b,c,f)};EJS.Helpers.prototype.link_to_unless_current=function(a,b,c,f){c=c||{};return this.link_to_unless(this.is_current_page(b),a,b,c,f)};EJS.Helpers.prototype.password_field_tag=function(a,b,c){return this.input_field_tag(a,b,"password",c)};
EJS.Helpers.prototype.select_tag=function(a,b,c,f){f=f||{};f.id=f.id||a;f.value=b;f.name=a;a="";a+=this.start_tag_for("select",f);for(f=0;f<c.length;f++){var e=c[f],d={value:e.value};if(e.value==b)d.selected="selected";a+=this.start_tag_for("option",d)+e.text+this.tag_end("option")}a+=this.tag_end("select");return a};EJS.Helpers.prototype.single_tag_for=function(a,b){return this.tag(a,b,"/>")};EJS.Helpers.prototype.start_tag_for=function(a,b){return this.tag(a,b)};
EJS.Helpers.prototype.submit_tag=function(a,b){b=b||{};b.type=b.type||"submit";b.value=a||"Submit";return this.single_tag_for("input",b)};EJS.Helpers.prototype.tag=function(a,b,c){c||(c=">");var f=" ",e;for(e in b){var d=b[e]!=null?b[e].toString():"";e=="Class"&&(e="class");f+=d.indexOf("'")!=-1?e+'="'+d+'" ':e+"='"+d+"' "}return"<"+a+f+c};EJS.Helpers.prototype.tag_end=function(a){return"</"+a+">"};
EJS.Helpers.prototype.text_area_tag=function(a,b,c){c=c||{};c.id=c.id||a;c.name=c.name||a;b=b||"";if(c.size)c.cols=c.size.split("x")[0],c.rows=c.size.split("x")[1],delete c.size;c.cols=c.cols||50;c.rows=c.rows||4;return this.start_tag_for("textarea",c)+b+this.tag_end("textarea")};EJS.Helpers.prototype.text_tag=EJS.Helpers.prototype.text_area_tag;EJS.Helpers.prototype.text_field_tag=function(a,b,c){return this.input_field_tag(a,b,"text",c)};
EJS.Helpers.prototype.url_for=function(a){return'window.location="'+a+'";'};EJS.Helpers.prototype.img_tag=function(a,b,c){c=c||{};c.src=a;c.alt=b;return this.single_tag_for("img",c)};(function(){var a=this,b=a.Backbone,c=Array.prototype.slice,f=Array.prototype.splice,e;e=typeof exports!=="undefined"?exports:a.Backbone={};e.VERSION="0.9.2";var d=a._;!d&&typeof require!=="undefined"&&(d=require("underscore"));var h=a.jQuery||a.Zepto||a.ender;e.setDomLibrary=function(a){h=a};e.noConflict=function(){a.Backbone=b;return this};e.emulateHTTP=false;e.emulateJSON=false;var l=/\s+/,g=e.Events={on:function(a,b,d){var c,e,f,g,j;if(!b)return this;a=a.split(l);for(c=this._callbacks||(this._callbacks=
{});e=a.shift();)f=(j=c[e])?j.tail:{},f.next=g={},f.context=d,f.callback=b,c[e]={tail:g,next:j?j.next:f};return this},off:function(a,b,c){var e,f,g,j,n,h;if(f=this._callbacks){if(!a&&!b&&!c)return delete this._callbacks,this;for(a=a?a.split(l):d.keys(f);e=a.shift();)if(g=f[e],delete f[e],g&&(b||c))for(j=g.tail;(g=g.next)!==j;)if(n=g.callback,h=g.context,b&&n!==b||c&&h!==c)this.on(e,n,h);return this}},trigger:function(a){var b,d,e,f,g,j;if(!(e=this._callbacks))return this;g=e.all;a=a.split(l);for(j=
c.call(arguments,1);b=a.shift();){if(d=e[b])for(f=d.tail;(d=d.next)!==f;)d.callback.apply(d.context||this,j);if(d=g){f=d.tail;for(b=[b].concat(j);(d=d.next)!==f;)d.callback.apply(d.context||this,b)}}return this}};g.bind=g.on;g.unbind=g.off;var j=e.Model=function(a,b){var c;a||(a={});b&&b.parse&&(a=this.parse(a));if(c=t(this,"defaults"))a=d.extend({},c,a);if(b&&b.collection)this.collection=b.collection;this.attributes={};this._escapedAttributes={};this.cid=d.uniqueId("c");this.changed={};this._silent=
{};this._pending={};this.set(a,{silent:true});this.changed={};this._silent={};this._pending={};this._previousAttributes=d.clone(this.attributes);this.initialize.apply(this,arguments)};d.extend(j.prototype,g,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(){return d.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;b=this.get(a);return this._escapedAttributes[a]=d.escape(b==
null?"":""+b)},has:function(a){return this.get(a)!=null},set:function(a,b,c){var e,f;d.isObject(a)||a==null?(e=a,c=b):(e={},e[a]=b);c||(c={});if(!e)return this;if(e instanceof j)e=e.attributes;if(c.unset)for(f in e)e[f]=void 0;if(!this._validate(e,c))return false;if(this.idAttribute in e)this.id=e[this.idAttribute];var b=c.changes={},g=this.attributes,n=this._escapedAttributes,h=this._previousAttributes||{};for(f in e){a=e[f];if(!d.isEqual(g[f],a)||c.unset&&d.has(g,f))delete n[f],(c.silent?this._silent:
b)[f]=true;c.unset?delete g[f]:g[f]=a;!d.isEqual(h[f],a)||d.has(g,f)!=d.has(h,f)?(this.changed[f]=a,c.silent||(this._pending[f]=true)):(delete this.changed[f],delete this._pending[f])}c.silent||this.change(c);return this},unset:function(a,b){(b||(b={})).unset=true;return this.set(a,null,b)},clear:function(a){(a||(a={})).unset=true;return this.set(d.clone(this.attributes),a)},fetch:function(a){var a=a?d.clone(a):{},b=this,c=a.success;a.success=function(d,e,f){if(!b.set(b.parse(d,f),a))return false;
c&&c(b,d)};a.error=e.wrapError(a.error,b,a);return(this.sync||e.sync).call(this,"read",this,a)},save:function(a,b,c){var f,g;d.isObject(a)||a==null?(f=a,c=b):(f={},f[a]=b);c=c?d.clone(c):{};if(c.wait){if(!this._validate(f,c))return false;g=d.clone(this.attributes)}a=d.extend({},c,{silent:true});if(f&&!this.set(f,c.wait?a:c))return false;var j=this,n=c.success;c.success=function(a,b,e){b=j.parse(a,e);c.wait&&(delete c.wait,b=d.extend(f||{},b));if(!j.set(b,c))return false;n?n(j,a):j.trigger("sync",
j,a,c)};c.error=e.wrapError(c.error,j,c);b=this.isNew()?"create":"update";b=(this.sync||e.sync).call(this,b,this,c);c.wait&&this.set(g,a);return b},destroy:function(a){var a=a?d.clone(a):{},b=this,c=a.success,f=function(){b.trigger("destroy",b,b.collection,a)};if(this.isNew())return f(),false;a.success=function(d){a.wait&&f();c?c(b,d):b.trigger("sync",b,d,a)};a.error=e.wrapError(a.error,b,a);var g=(this.sync||e.sync).call(this,"delete",this,a);a.wait||f();return g},url:function(){var a=t(this,"urlRoot")||
t(this.collection,"url")||v();return this.isNew()?a:a+(a.charAt(a.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(a){a||(a={});var b=this._changing;this._changing=true;for(var c in this._silent)this._pending[c]=true;var e=d.extend({},a.changes,this._silent);this._silent={};for(c in e)this.trigger("change:"+c,this,this.get(c),a);if(b)return this;for(;!d.isEmpty(this._pending);){this._pending=
{};this.trigger("change",this,a);for(c in this.changed)!this._pending[c]&&!this._silent[c]&&delete this.changed[c];this._previousAttributes=d.clone(this.attributes)}this._changing=false;return this},hasChanged:function(a){return!arguments.length?!d.isEmpty(this.changed):d.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?d.clone(this.changed):false;var b,c=false,e=this._previousAttributes,f;for(f in a)if(!d.isEqual(e[f],b=a[f]))(c||(c={}))[f]=b;return c},previous:function(a){return!arguments.length||
!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return d.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(a,b){if(b.silent||!this.validate)return true;var a=d.extend({},this.attributes,a),c=this.validate(a,b);if(!c)return true;b&&b.error?b.error(this,c,b):this.trigger("error",this,c,b);return false}});var r=e.Collection=function(a,b){b||(b={});if(b.model)this.model=b.model;if(b.comparator)this.comparator=
b.comparator;this._reset();this.initialize.apply(this,arguments);a&&this.reset(a,{silent:true,parse:b.parse})};d.extend(r.prototype,g,{model:j,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},add:function(a,b){var c,e,g,j,n,h={},m={},k=[];b||(b={});a=d.isArray(a)?a.slice():[a];for(c=0,e=a.length;c<e;c++){if(!(g=a[c]=this._prepareModel(a[c],b)))throw Error("Can't add an invalid model to a collection");j=g.cid;n=g.id;h[j]||this._byCid[j]||n!=null&&(m[n]||
this._byId[n])?k.push(c):h[j]=m[n]=g}for(c=k.length;c--;)a.splice(k[c],1);for(c=0,e=a.length;c<e;c++)(g=a[c]).on("all",this._onModelEvent,this),this._byCid[g.cid]=g,g.id!=null&&(this._byId[g.id]=g);this.length+=e;f.apply(this.models,[b.at!=null?b.at:this.models.length,0].concat(a));this.comparator&&this.sort({silent:true});if(b.silent)return this;for(c=0,e=this.models.length;c<e;c++)if(h[(g=this.models[c]).cid])b.index=c,g.trigger("add",g,this,b);return this},remove:function(a,b){var c,e,f,g;b||(b=
{});a=d.isArray(a)?a.slice():[a];for(c=0,e=a.length;c<e;c++)if(g=this.getByCid(a[c])||this.get(a[c])){delete this._byId[g.id];delete this._byCid[g.cid];f=this.indexOf(g);this.models.splice(f,1);this.length--;if(!b.silent)b.index=f,g.trigger("remove",g,this,b);this._removeReference(g)}return this},push:function(a,b){a=this._prepareModel(a,b);this.add(a,b);return a},pop:function(a){var b=this.at(this.length-1);this.remove(b,a);return b},unshift:function(a,b){a=this._prepareModel(a,b);this.add(a,d.extend({at:0},
b));return a},shift:function(a){var b=this.at(0);this.remove(b,a);return b},get:function(a){return a==null?void 0:this._byId[a.id!=null?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},where:function(a){return d.isEmpty(a)?[]:this.filter(function(b){for(var d in a)if(a[d]!==b.get(d))return false;return true})},sort:function(a){a||(a={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");var b=d.bind(this.comparator,this);this.comparator.length==
1?this.models=this.sortBy(b):this.models.sort(b);a.silent||this.trigger("reset",this,a);return this},pluck:function(a){return d.map(this.models,function(b){return b.get(a)})},reset:function(a,b){a||(a=[]);b||(b={});for(var c=0,e=this.models.length;c<e;c++)this._removeReference(this.models[c]);this._reset();this.add(a,d.extend({silent:true},b));b.silent||this.trigger("reset",this,b);return this},fetch:function(a){a=a?d.clone(a):{};if(a.parse===void 0)a.parse=true;var b=this,c=a.success;a.success=function(d,
e,f){b[a.add?"add":"reset"](b.parse(d,f),a);c&&c(b,d)};a.error=e.wrapError(a.error,b,a);return(this.sync||e.sync).call(this,"read",this,a)},create:function(a,b){var c=this,b=b?d.clone(b):{},a=this._prepareModel(a,b);if(!a)return false;b.wait||c.add(a,b);var e=b.success;b.success=function(d,f){b.wait&&c.add(d,b);e?e(d,f):d.trigger("sync",a,f,b)};a.save(null,b);return a},parse:function(a){return a},chain:function(){return d(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId=
{};this._byCid={}},_prepareModel:function(a,b){b||(b={});if(a instanceof j){if(!a.collection)a.collection=this}else{var d;b.collection=this;a=new this.model(a,b);a._validate(a.attributes,b)||(a=false)}return a},_removeReference:function(a){this==a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,d,c){(a=="add"||a=="remove")&&d!=this||(a=="destroy"&&this.remove(b,c),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=
b),this.trigger.apply(this,arguments))}});d.each("forEach,each,map,reduce,reduceRight,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,sortBy,sortedIndex,toArray,size,first,initial,rest,last,without,indexOf,shuffle,lastIndexOf,isEmpty,groupBy".split(","),function(a){r.prototype[a]=function(){return d[a].apply(d,[this.models].concat(d.toArray(arguments)))}});var n=e.Router=function(a){a||(a={});if(a.routes)this.routes=a.routes;this._bindRoutes();this.initialize.apply(this,
arguments)},m=/:\w+/g,k=/\*\w+/g,u=/[-[\]{}()+?.,\\^$|#\s]/g;d.extend(n.prototype,g,{initialize:function(){},route:function(a,b,c){e.history||(e.history=new o);d.isRegExp(a)||(a=this._routeToRegExp(a));c||(c=this[b]);e.history.route(a,d.bind(function(d){d=this._extractParameters(a,d);c&&c.apply(this,d);this.trigger.apply(this,["route:"+b].concat(d));e.history.trigger("route",this,b,d)},this));return this},navigate:function(a,b){e.history.navigate(a,b)},_bindRoutes:function(){if(this.routes){var a=
[],b;for(b in this.routes)a.unshift([b,this.routes[b]]);b=0;for(var d=a.length;b<d;b++)this.route(a[b][0],a[b][1],this[a[b][1]])}},_routeToRegExp:function(a){a=a.replace(u,"\\$&").replace(m,"([^/]+)").replace(k,"(.*?)");return RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}});var o=e.History=function(){this.handlers=[];d.bindAll(this,"checkUrl")},s=/^[#\/]/,p=/msie [\w.]+/;o.started=false;d.extend(o.prototype,g,{interval:50,getHash:function(a){return(a=(a?a.location:
window.location).href.match(/#(.*)$/))?a[1]:""},getFragment:function(a,b){if(a==null)if(this._hasPushState||b){var a=window.location.pathname,d=window.location.search;d&&(a+=d)}else a=this.getHash();a.indexOf(this.options.root)||(a=a.substr(this.options.root.length));return a.replace(s,"")},start:function(a){if(o.started)throw Error("Backbone.history has already been started");o.started=true;this.options=d.extend({},{root:"/"},this.options,a);this._wantsHashChange=this.options.hashChange!==false;
this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);var a=this.getFragment(),b=document.documentMode;if(b=p.exec(navigator.userAgent.toLowerCase())&&(!b||b<=7))this.iframe=h('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(a);if(this._hasPushState)h(window).bind("popstate",this.checkUrl);else if(this._wantsHashChange&&"onhashchange"in window&&!b)h(window).bind("hashchange",
this.checkUrl);else if(this._wantsHashChange)this._checkUrlInterval=setInterval(this.checkUrl,this.interval);this.fragment=a;a=window.location;b=a.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!b)return this.fragment=this.getFragment(null,true),window.location.replace(this.options.root+"#"+this.fragment),true;else if(this._wantsPushState&&this._hasPushState&&b&&a.hash)this.fragment=this.getHash().replace(s,""),window.history.replaceState({},document.title,
a.protocol+"//"+a.host+this.options.root+this.fragment);if(!this.options.silent)return this.loadUrl()},stop:function(){h(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);o.started=false},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();a==this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe)));if(a==this.fragment)return false;this.iframe&&this.navigate(a);
this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(a){var b=this.fragment=this.getFragment(a);return d.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),true})},navigate:function(a,b){if(!o.started)return false;if(!b||b===true)b={trigger:b};var d=(a||"").replace(s,"");if(this.fragment!=d)this._hasPushState?(d.indexOf(this.options.root)!=0&&(d=this.options.root+d),this.fragment=d,window.history[b.replace?"replaceState":"pushState"]({},document.title,d)):this._wantsHashChange?
(this.fragment=d,this._updateHash(window.location,d,b.replace),this.iframe&&d!=this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,d,b.replace))):window.location.assign(this.options.root+a),b.trigger&&this.loadUrl(a)},_updateHash:function(a,b,d){d?a.replace(a.toString().replace(/(javascript:|#).*$/,"")+"#"+b):a.hash=b}});var q=e.View=function(a){this.cid=d.uniqueId("view");this._configure(a||{});this._ensureElement();this.initialize.apply(this,
arguments);this.delegateEvents()},y=/^(\S+)\s*(.*)$/,w="model,collection,el,id,attributes,className,tagName".split(",");d.extend(q.prototype,g,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(a,b,d){a=document.createElement(a);b&&h(a).attr(b);d&&h(a).html(d);return a},setElement:function(a,b){this.$el&&this.undelegateEvents();this.$el=a instanceof h?a:h(a);this.el=this.$el[0];
b!==false&&this.delegateEvents();return this},delegateEvents:function(a){if(a||(a=t(this,"events"))){this.undelegateEvents();for(var b in a){var c=a[b];d.isFunction(c)||(c=this[a[b]]);if(!c)throw Error('Method "'+a[b]+'" does not exist');var e=b.match(y),f=e[1],e=e[2],c=d.bind(c,this);f+=".delegateEvents"+this.cid;e===""?this.$el.bind(f,c):this.$el.delegate(e,f,c)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=d.extend({},this.options,
a));for(var b=0,c=w.length;b<c;b++){var e=w[b];a[e]&&(this[e]=a[e])}this.options=a},_ensureElement:function(){if(this.el)this.setElement(this.el,false);else{var a=t(this,"attributes")||{};if(this.id)a.id=this.id;if(this.className)a["class"]=this.className;this.setElement(this.make(this.tagName,a),false)}}});j.extend=r.extend=n.extend=q.extend=function(a,b){var d=z(this,a,b);d.extend=this.extend;return d};var A={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};e.sync=function(a,b,c){var f=
A[a];c||(c={});var g={type:f,dataType:"json"};if(!c.url)g.url=t(b,"url")||v();if(!c.data&&b&&(a=="create"||a=="update"))g.contentType="application/json",g.data=JSON.stringify(b.toJSON());if(e.emulateJSON)g.contentType="application/x-www-form-urlencoded",g.data=g.data?{model:g.data}:{};if(e.emulateHTTP&&(f==="PUT"||f==="DELETE")){if(e.emulateJSON)g.data._method=f;g.type="POST";g.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",f)}}if(g.type!=="GET"&&!e.emulateJSON)g.processData=false;
return h.ajax(d.extend(g,c))};e.wrapError=function(a,b,d){return function(c,e){e=c===b?e:c;a?a(b,e,d):b.trigger("error",b,e,d)}};var x=function(){},z=function(a,b,c){var e;e=b&&b.hasOwnProperty("constructor")?b.constructor:function(){a.apply(this,arguments)};d.extend(e,a);x.prototype=a.prototype;e.prototype=new x;b&&d.extend(e.prototype,b);c&&d.extend(e,c);e.prototype.constructor=e;e.__super__=a.prototype;return e},t=function(a,b){return!a||!a[b]?null:d.isFunction(a[b])?a[b]():a[b]},v=function(){throw Error('A "url" property or function must be specified');
}}).call(this);var plans=plans?plans:{};
plans.initFeatureInfoPopup=function(){function a(a){return(a=/_feature_([^\s]+)/.exec(a))&&a.length>1?a[1]:null}function b(a,b){if(a){var d=$("#featureInfoPopup").length?$("#featureInfoPopup"):$('<div id="featureInfoPopup" style="display: none;"></div>'),c="",l=false;switch(a){case "conversations":c+="<h3>"+translation._("What is HootSuite Conversations?")+'</h3><div class="arrowLeft"></div>'+translation._("HootSuite Conversations is a new internal conversation tool that lets you easily collaborate with team members, colleagues and users in real time.");break;
case "networks":c+="<h3>"+translation._("What are Social Profiles?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Total owned social profiles* from Twitter, Facebook and other networks. <br/> <div style='font-size: 10px;padding-top:5px;'>* Limit of <strong>owned</strong> social profiles only. You can also add unlimited shared profiles as a team member.</div>");break;case "rss":c+="<h3>"+translation._("What are RSS/Atom Feeds?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Number of RSS connections available to auto-update your social profiles from your blog or news feed.");
break;case "team_members":c+="<h3>"+translation._("What are Team Members?")+'</h3><div class="arrowLeft"></div>'+translation._("Enterprise is built to scale from existing teams to the entire organization.");break;case "ent_social_profiles":c+="<h3>"+translation._("What are Social Profiles?")+'</h3><div class="arrowLeft"></div>'+translation._("Partnered with top social networks including Facebook, Linkedin, Twitter and Google+ Pages.");break;case "ent_security":c+="<h3>"+translation._("What is Advanced Security?")+
'</h3><div class="arrowLeft"></div>'+translation._("The most advanced security features to prevent mistakes and protect valuable corporate profiles.");break;case "compliance":c+="<h3>"+translation._("What is Compliance Integrations?")+'</h3><div class="arrowLeft"></div>'+translation._("Compliant archiving for FSI and regulated industries.");break;case "geotargeting":c+="<h3>"+translation._("What is Geo-Targeting?")+'</h3><div class="arrowLeft"></div>'+translation._("Language and geographic segmentation options for Facebook Pages.");
break;case "professional_services":c+="<h3>"+translation._("What are Professional Services?")+'</h3><div class="arrowLeft"></div>'+translation._("For customized training and setup, simulation and more.");break;case "hsu":c+="<h3>"+translation._("What is HootSuite University?")+'</h3><div class="arrowLeft"></div>'+translation._("24/7 self-directed social media education for all team members.");break;case "tier1":c+="<h3>"+translation._("What is Tier 1 Support?")+'</h3><div class="arrowLeft"></div>'+
translation._("Dedicated account management, live training sessions and priority support.");break;case "archive_messages_pro":c+="<h3>"+translation._("What are HootSuite Archives?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Store up to 100,000 keyword related tweets free with the Enterprise plan. More are available for purchase upon request from your Account Manager.");break;case "pro_points":case "num_reports":c+="<h3>"+translation._("What are Reports?")+'</h3><div class="arrowLeft"></div>'+
translation._("Custom reports with advanced tools like network stats, Facebook Insights and Google Analytics to help you measure your social media efforts.");break;case "team":c+="<h3>"+translation._("What are Users?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Team Members who can help manage your social accounts. The Pro plan includes yourself plus one additional team member. Up to 9 additional team members are available (team of 10).");break;case "ga":c+="<h3>"+translation._("What are Google Analytics?")+
"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Data from Google Analytics is displayed directly in HootSuite including parameter filtering and social statistics overlay.");break;case "fb_insights":c+="<h3>"+translation._("What are Facebook Insights?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Statistical tracking tool to display information about who engages with your Facebook page, including 'likes', page activity, post feedback and other analytics.");break;case "apps":c+=
"<h3>"+translation._("What are Apps?")+'</h3><div class="arrowLeft"></div>'+translation._("Apps are additional social networks and content management tools that you add to the dashboard from the App Directory. Example apps are: Instagram, YouTube, Tumblr and Evernote.");break;case "quick_reports":c+="<h3>"+translation._("What are Reports?")+'</h3><div class="arrowLeft"></div>'+translation._("Custom reports with advanced tools like network stats, Facebook Insights and Google Analytics to help you measure your social media efforts.");
break;case "message_scheduling":c+="<h3>"+translation._("What is Message Scheduling?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Draft and schedule messages to send when your audience is most likely to be engaged.");break;case "ad_free":c+="<h3>"+translation._("What does Opt out of Ads mean?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("You can opt out of seeing promoted tweets in your search or social streams.");break;case "ads":c+="<h3>"+translation._("What does Opt out of Ads mean?")+
"</h3>";c+='<div class="arrowLeft"></div>'+translation._('Clearly labeled "Promoted Tweets" from Twitter will appear in your search stream.');break;case "archive_messages":c+="<h3>"+translation._("What are HootSuite Archives?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Store up to 100 tweets free with your plan, and purchase up to 100,000 to archive and download all keyword related Twitter messages.");break;case "support":c+="<h3>"+translation._("What is Enhanced Support?")+"</h3>";
c+='<div class="arrowLeft"></div>'+translation._("Help tickets are prioritized and answered within a time-frame outlined in a service level agreement.");break;case "brand":c+="<h3>"+translation._("What are Vanity URLs?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Custom branded web address shortening from Ow.ly Pro including statistic reports (additional fees required).");break;case "insights":c+="<h3>"+translation._("What are Social Insights?")+"</h3>";c+='<div class="arrowLeft"></div>'+
translation._("Intelligence gathering tool to find public information about people on your social networks.");break;case "affiliate":c+="<h3>"+translation._("What is the Affiliate Program?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("The Affiliate Program is a way to earn commissions for new Pro, Enterprise and University customers that sign up as a result of your referrals.");break;case "message_scheduling_pro":c+="<h3>"+translation._("What is Advanced Message Scheduling?")+"</h3>";
c+='<div class="arrowLeft"></div>'+translation._("In addition to drafting and scheduling messages to optimize delivery and engagement, you can publish and bulk schedule your messages.");break;case "learn":c+="<h3>"+translation._("What is included in VIP Set-up?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Personalized, on-line set-up assistance with VIP account executive.");break;case "cert":c+="<h3>"+translation._("What is the HootSuite Certification Program?")+"</h3>";c+='<div class="arrowLeft"></div>'+
translation._("Enrollment for 10 team members in an on-going training program -- includes video modules, quizzes and professional development webinars.");break;case "url":c+="<h3>"+translation._("What are URL Parameters?")+"</h3>";c+='<div class="arrowLeft"></div>'+translation._("Custom data variables (i.e. source, medium, client) which are added to a URL to help measure campaigns in analytics tools.");break;case "influence":c+="<h3>"+translation._("What are Influence Scores?")+"</h3>";c+='<div class="arrowLeft"></div>'+
translation._("View and filter by algorithmically-determined scores which measure the impact and reach of a social profile.");break;case "pro_analytics":c+="<h3>"+translation._("What are Enhanced Analytics?")+'</h3><div class="arrowLeft"></div>'+translation._("Unlimited analytics and customized reporting including Facebook Insights, Google analytics and more.");break;case "enterprise_analytics":c+="<h3>"+translation._("What are Enhanced Analytics?")+'</h3><div class="arrowLeft"></div>'+translation._("Unlimited analytics and customized reporting including Facebook Insights, Google Analytics, WebTrends, Adobe SiteCatalyst, and more");
break;case "pro_profiles":c+="<h3>"+translation._("What are Social Profiles?")+'</h3><div class="arrowLeft"></div>'+translation._("Total owned accounts* on Twitter, Facebook and other social networks.");break;case "basic_analytics":c+="<h3>"+translation._("What are Social Analytics?")+'</h3><div class="arrowLeft"></div>'+translation._("Monitor basic information from your social profiles including Click Stats, ReTweets and more.");break;case "app_directory":c+="<h3>"+translation._("What is the HootSuite App Directory?")+
'</h3><div class="arrowLeft"></div>'+translation._("The App Directory is a collection of extensions and applications that HootSuite users can add to their dashboard to create a customized experience, including YouTube, Tumblr, Flickr, Constant Contact and more.");break;case "analytics_points":c+="<h3>"+translation._("What are Social Analytics Points?")+'</h3><div class="arrowLeft"></div>'+translation._("These points allow you to select from a variety of modules including Google Analytics and Facebook Insights to build custom reports which you can share with clients and colleagues.");
break;case "security":c+="<h3>"+translation._("What is Social Media Security?")+'</h3><div class="arrowLeft"></div>'+translation._("HootSuite's security tools lock down your HootSuite sessions, secure your online profiles and limit permissions with team collaboration.");break;case "analytics":c+="<h3>"+translation._("What are Enhanced Social Analytics?")+'</h3><div class="arrowLeft"></div>'+translation._("Monitor sentiment and track your social reach with access to advanced reporting tools.");break;
case "why_credit_card":var g=$("#dynamicFeatures ._subtotal._planCost").text();c+="<h3>"+translation._("Why do we need your credit card?")+'</h3><div class="arrowLeft"></div>'+translation._("The first 30 days of HootSuite Pro are free. We ask for your credit card to allow your Pro membership to continue should you keep your account open. This prevents any interruption of Pro features to your account. Collecting credit card information also allows us to reduce fraud and to limit customers to one free trial.")+
"<br/><br/>"+translation._("Your credit card will not be charged at any point during your 30-day trial. After your 30-day trial, you will be charged %s for each month thereafter (more if you purchase add-ons). If you decide that HootSuite Pro isn't for you, you can cancel anytime, both during and after your trial.").replace("%s",g);l=true;hs.trackEvent({category:"Billing Signup Flow",action:"Why credit card"})}d.html(c);c.length?setTimeout(function(){$("#featureInfoPopup").length||d.appendTo("body");
var a=b.offset().top-d.outerHeight(true)/2+10,c=b.offset().left+b.outerWidth(true);c+d.outerWidth(true)>$(window).width()&&(c-=100);d.css({top:a,left:c,position:"absolute"}).show();l&&d.css({width:"500px"})},1):d.hide()}}function c(){$("#featureInfoPopup").empty().hide()}$("._feature").live("mouseenter",function(c){var e=a($(this).get(0).className),c=$(c.target);c.is("._feature")||(c=c.closest("._feature"));plans.featureInfoTimeout&&clearTimeout(plans.featureInfoTimeout);b(e,c)}).live("mouseleave",
function(b){var e=a($(this).get(0).className),d=$(b.target);plans.featureInfoTimeout&&clearTimeout(plans.featureInfoTimeout);plans.featureInfoTimeout=setTimeout(function(){c(e,d)},200)});$("#featureInfoPopup").live("mouseenter",function(){plans.featureInfoTimeout&&clearTimeout(plans.featureInfoTimeout)}).live("mouseleave",function(){plans.featureInfoTimeout&&clearTimeout(plans.featureInfoTimeout);plans.featureInfoTimeout=setTimeout(function(){c()},200)})};
plans.startFeatureFreeTrial=function(a,b){ajaxCall({url:"/ajax/member/start-feature-free-trial?featureId="+a,success:function(a){a.success==1?($.isFunction(b)&&b(),hs.statusObj.update(translation._("Free trial started"),"success",true)):hs.statusObj.update(translation._("Sorry, you are not eligible to start a free trial for this feature."),"error",true)}},"q1")};
plans.downgradePlan=function(a){hs.statusObj.update(translation._("Checking feature usage..."),"info");ajaxCall({type:"POST",url:"/ajax/member/downgrade-plan?planId="+a,success:function(a){hs.statusObj.reset();if(a.loggedOut)window.location=hs.c.rootUrlSSL+"/login";if(a.invalidPlan)window.location=hs.c.rootUrl;a.output&&(a=$("._downgradePlanFancyBox").html(a.output),$.fancybox(a,{openEffect:"fade",closeEffect:"fade",padding:10,maxWidth:650,minHeight:"auto",fitToView:false}),plans.initDowngradePlanPopup())},
error:function(){hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",true)},abort:function(){hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",true)}},"q1")};
plans.forceDowngradeToFree=function(){var a=translation._("Are you sure you want to downgrade to a Free account? Doing so will immediately remove all Custom Analytics Reports, all Team Members and all but 5 of your Social Networks.");confirm(a)&&(hs.statusObj.update(translation._("Plan downgrade in progress..."),"info"),ajaxCall({type:"POST",url:"/ajax/member/force-downgrade-to-free",success:function(a){hs.statusObj.reset();if(a.loggedOut)window.location=hs.c.rootUrlSSL+"/login";a.ok&&plans.save(1)},
error:function(){hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",true)},abort:function(){hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",true)}},"q1"))};
plans.initDowngradePlanPopup=function(){var a=$("._downgradePlanFancyBox");$("#changePlanActionButtons ._cancel").click(function(){$.fancybox.close()});$("#changePlanActionButtons ._continue").click(function(){plans.save(a.find("#planChangeContent").attr("newPlanId"));return false});$("#changePlanActionButtons ._forceDowngrade").click(function(){plans.forceDowngradeToFree();return false});$("#changePlanSection ._removeFeature").click(function(){var b=$(this).closest("._featureSection").attr("featurecode"),
c=a.find("#planChangeContent").attr("newPlanId"),f=function(){plans.downgradePlan(c)},e=$(this).closest("._featureSection").attr("featuredata");b=="ORGANIZATIONS"?billing.deleteOrganization(e,f):b=="REPORTING_NUM_REPORTS"&&billing.deleteReports(f);return false});$("#changePlanSectionErrorMsg").hide()};plans.save=function(a){window.location=hs.c.rootUrl+"/save-plan?planId="+a};plans.pro=plans.pro?plans.pro:{};
plans.pro.init=function(){function a(){hs.timers.homeSlideTimer!=void 0&&(clearTimeout(hs.timers.homeSlideTimer),delete hs.timers.homeSlideTimer);hs.timers.homeSlideTimer=setTimeout(function(){$(".next").click()},6E3)}function b(){var a=currentPos+c*f-f;currentPos-e==0&&($("#featuresShowcase .unique").css("margin-left",currentPos-e),$("#featuresShowcase .clone").css("margin-left",currentPos-e-e),currentPos-=e);a==0&&($("#featuresShowcase .unique").css("margin-left",currentPos+e),$("#featuresShowcase .clone").css("margin-left",
currentPos+e-e),currentPos+=e)}plans.initFeatureInfoPopup();var c=$("#featuresShowcase .unique .item").size(),f=$("#featuresShowcase .unique .item:first").outerWidth(),e=c*f;$("#featuresShowcase .unique").width(e);$("#featuresShowcase .featuresHolder").outerWidth();currentPos=0;$("#featuresShowcase .unique").clone().prependTo($("#featuresShowcase .featuresHolder"));$("#featuresShowcase .unique:first-child").addClass("clone").removeClass("unique");$("#featuresShowcase .clone").css("margin-left",e*
-1);a();$(".prev").click(function(c){$("#featuresShowcase .unique:animated").length<=0&&(currentPos=targetPos=currentPos+f,$("#featuresShowcase .unique").animate({marginLeft:targetPos},700),$("#featuresShowcase .clone").animate({marginLeft:targetPos-e},700,b));a();c.preventDefault()});$(".next").click(function(c){$("#featuresShowcase .unique:animated").length<=0&&(currentPos=targetPos=currentPos-f,$("#featuresShowcase .unique").animate({marginLeft:targetPos},700),$("#featuresShowcase .clone").animate({marginLeft:targetPos-
e},700,b));a();c.preventDefault()})};plans.enterprise=plans.enterprise?plans.enterprise:{};plans.enterprise.init=function(){plans.initFeatureInfoPopup()};
plans.showTeamsPricingPopup=function(){ajaxCall({type:"POST",url:"/ajax/member/teams-pricing-popup",success:function(a){hs.statusObj.reset();if(a.loggedOut)window.location=hs.c.rootUrlSSL+"/login";if(a.output){var b=$("._fancyTeamsPricingPopup");b.html(a.output);$.fancybox(b,{openEffect:"fade",closeEffect:"fade",padding:10,maxWidth:650,minHeight:"auto",fitToView:false,afterShow:function(){$("#teamsPricingActionButtons a._cancel").click(function(){$.fancybox.close()});$("#teamsPricingActionButtons a._change").click(function(){var a=
translation._("Are you sure you want to permanently switch to the new pricing plan?");confirm(a)&&plans.switchToTeamsPricing()})}})}},error:function(){hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",true)},abort:function(){hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",true)}},"q1")};
plans.switchToTeamsPricing=function(){hs.statusObj.update(translation._("Switching pricing plan..."),"info");ajaxCall({type:"POST",url:"/ajax/member/start-teams-pricing?token="+plans.switchToTeamsPricingToken,success:function(a){if(a.loggedOut)window.location=hs.c.rootUrlSSL+"/login";a.success?window.location.reload(true):hs.statusObj.reset()},error:function(){hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",true)},abort:function(){hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),
"error",true)}},"q1")};var billing=billing?billing:{};billing.tiers=[];billing.activeCoupons=[];billing.currentCost=0;billing.chosenPlanId=0;billing.ajaxpage=false;billing.memberLoggedIn=false;billing.checkCouponToken="";billing.coupons=[];billing.signupErrorMessage=translation._("Could not complete sign up. Please check form and try again.");billing.spinnerHtml="<div class='loading-content c-c'><h2>Loading...</h2><img src='"+hs.util.rootifyImage("/loader.gif")+"' /></div>";billing.showSpinners=true;
billing.countryList=[];billing.stateList=[];billing.showSavePlanChangeButtons=function(){billing.ajaxpage&&!billing.memberLoggedIn?$("#savePlanChangeButtons").hide():$("#savePlanChangeButtons").show()};
billing.populateBillingHistorySection=function(a){var b=$(".billing #billinghistory");ajaxCall({type:"GET",url:"/ajax/billing/billing-history-section",success:function(c){c.success=="1"?(b.empty().html(c.output),$.isFunction(a)&&a()):hs.statusObj.update(translation._("Error retrieving billing history."),"error",true)}},"qmNoAbort")};
billing.populateEnhancePlanSection=function(a,b,c){var f=$(".billing #enhanceplan");billing.showSpinners&&f.html(billing.spinnerHtml).show();ajaxCall({type:"GET",url:"/ajax/billing/enhance-plan-section",data:"planId="+a+"&addHsuOption="+billing.addhsuoption,success:function(a){a.success=="1"?(billing.checkCouponToken=a.checkCouponToken,f.empty().html(a.output),$("#featuresForm").formValues(b),billing.updatePrice(),billing.showSavePlanChangeButtons(),billing.showFreeTrial(),$.isFunction(c)&&c()):(f.empty(),
hs.statusObj.update(translation._("Error retrieving plan information."),"error",true))}},"qmNoAbort")};
billing.populateBillingSection=function(a,b,c,f){var e=$(".billing #billing-section");billing.showSpinners&&e.html(billing.spinnerHtml).show();ajaxCall({type:"GET",url:"/ajax/billing/billing-section",data:"planId="+a+"&updateBilling="+b,success:function(a){a.success=="1"?(e.empty().html(a.output),$("#seatUpperLimitErroMsg a._close").click(function(){$("#seatUpperLimitErroMsg").hide()}),billing.populateCountry(),$("#ccForm").formValues(c),$("#billingStateContainer").formValues(c),$("#billingSection ._placeholderContainer").improvedPlaceholder(),
billing.showPaymentMethods(),billing.showFreeTrial(),$.isFunction(f)&&f()):(e.empty(),hs.statusObj.update(translation._("Error retrieving billing section."),"error",true))}},"qmNoAbort")};
billing.submitPaymentNotLoggedIn=function(){billing.checkCCForm()&&(billing.memberLoggedIn?billing.storeFeatures(function(){billing.submitPayment()}):billing.autoSubmitCreateAccount(null,function(a,b){billing.storeFeatures(function(){if(billing.billingABvariant==6)$("#createaccount").hide(),$("#enhanceplan").hide(),$("#billing-section").hide(),$("html, body").animate({scrollTop:0},"fast"),billing.showSpinners=false,$("#billing-please-wait #waitmessage").html("<h2>"+translation._("Please wait.")+"</h2><h2>"+
translation._("This process may take up to 15 seconds.")+"</h2>"),$("#billing-please-wait").show();billing.populateBillingSection(void 0,billing.updatebilling,b,function(){billing.submitPayment()})})}))};
billing.postConfirmationLoadedCallback=function(a){billing.ajaxpage&&($("#createaccount").empty(),$("#enhanceplan").empty(),billing.hidePaymentMethods(),billing.clearSubTitle(),$("html, body").animate({scrollTop:0},"fast"),$.isFunction(billing.callbacks[billing.billingABvariant].postConfirmationLoaded)&&billing.callbacks[billing.billingABvariant].postConfirmationLoaded(),$("#couponResults").empty().html(function(){var b="";if(a.couponError)return translation._("Could not process coupons. Please try again.");
if(a.couponCodeResults)for(var c=0;c<a.couponCodeResults.length;c++)b+=a.couponCodeResults[c].result?translation._("Coupon code '%s1%s2%s3' successfully applied. ").replace("%s1","<strong>").replace("%s2",a.couponCodeResults[c].code).replace("%s3","</strong>"):translation._("Coupon code '%s1%s2%s3' invalid. ").replace("%s1","<strong>").replace("%s2",a.couponCodeResults[c].code).replace("%s3","</strong>");return b}()))};billing.showPaymentMethods=function(){$("#paymentMethods").show()};
billing.hidePaymentMethods=function(){$("#paymentMethods").hide()};billing.showFreeTrial=function(){$("#freeTrial").show()};billing.hideFreeTrial=function(){$("#freeTrial").hide()};billing.setPageTitle=function(a){$("h1.pageTitle").html(a)};billing.showLoadingDiv=function(){$(".loadingContent").show()};billing.hideLoadingDiv=function(){$(".loadingContent").hide()};billing.billingNextHook=function(){billing.callbacks[billing.billingABvariant].billingNext()};
billing.enhancePlanNextHook=function(){$("html, body").animate({scrollTop:0},"fast");billing.callbacks[billing.billingABvariant].enhancePlanNext()};billing.createAccountNextHook=function(){$("html, body").animate({scrollTop:0},"fast");billing.callbacks[billing.billingABvariant].createAccountNext()};
billing.confirmationEnhancePlan=function(){billing.ajaxpage&&$.isFunction(billing.callbacks[billing.billingABvariant].confirmationEnhancePlan)?billing.callbacks[billing.billingABvariant].confirmationEnhancePlan():window.location="https://hootsuite.com/billing"};billing.horizontalStep=function(a){for(var b=1;b<=4;b++)$(".statusBox .steps").removeClass("active-"+b);$(".statusBox .steps").addClass("active-"+a)};
billing.titles={subtitle:{"create-account":translation._("Free for 30 days, then starting at $9.99/month"),billing:translation._("Enter your billing information - Secure")+'&nbsp;<span class="t-s link _feature _feature_why_credit_card">'+translation._("Why do we need this?")+"</span>","enhance-plan":translation._("Enhance your plan to take advantage of more Pro features.")},confirmation:{"start-hootsuite":translation._("Start Using HootSuite"),"thank-you":translation._("Thank You"),"plan-modified":translation._("Plan Modified")}};
billing.setSubTitle=function(a){$("#sub-title").html(billing.titles.subtitle[a])};billing.clearSubTitle=function(){$("#sub-title").empty()};billing.setConfirmationBanner=function(a){$("#billingSection .boxTitle span").html(billing.titles.confirmation[a])};
billing.loadBillingStep=function(a){billing.horizontalStep(billing.callbacks[billing.billingABvariant].billingStepNumber);billing.populateBillingSection(billing.chosenPlanId,billing.updatebilling,a,function(){$("#billing-section").show()});billing.setPageTitle(translation._("Billing Information"));billing.setSubTitle("billing");hs.track("/ga/billingABvariant="+billing.billingABvariant+"/billing")};
billing.loadEnhancePlanStep=function(a,b){b||billing.horizontalStep(billing.callbacks[billing.billingABvariant].enhancePlanStepNumber);billing.setPageTitle(translation._("Enhance Plan"));billing.setSubTitle("enhance-plan");billing.populateEnhancePlanSection(void 0,a,function(){$("#enhanceplan").show()});hs.track("/ga/billingABvariant="+billing.billingABvariant+"/enhanceplan")};billing.saveNextState=function(a){$.cookie.create("billingstate",a,30)};
billing.callbacks=[{},{billingStepNumber:2,enhancePlanStepNumber:3,postLoad:function(){billing.populateCreateAccount(billing.chosenPlanId,function(){$(".billing #createaccount").show()});billing.setPageTitle(translation._("Create Account"));billing.setSubTitle("create-account");billing.saveNextState("billing")},createAccountNext:function(){billing.autoSubmitCreateAccount(null,function(a,b){$("#createaccount").hide();billing.loadBillingStep(b)})},enhancePlanNext:function(){billing.saveFeatures(function(a){a.success?
(billing.clearSubTitle(),billing.hideFreeTrial(),billing.setPageTitle(translation._("Start Using HootSuite")),billing.horizontalStep(4),$(".billing #enhanceplan").hide(),billing.populateBillingSection(void 0,void 0,void 0,function(){$("#ccForm").hide();$("#ccSuccess").hide();$("#enhancePlanSuccess").show();billing.populateHsuLink(a.hsuData);billing.hidePaymentMethods();$("#billing-section").show();billing.setConfirmationBanner("thank-you")})):alert("problem saving features. please try again.")})},
billingNext:function(){billing.saveNextState("enhance");billing.submitPayment()},postConfirmationLoaded:function(){billing.setPageTitle(translation._("Start Using HootSuite"));billing.setConfirmationBanner("start-hootsuite")},confirmationEnhancePlan:function(){$("#billing-section").hide();billing.loadEnhancePlanStep(void 0)}},{enhancePlanStepNumber:2,billingStepNumber:3,postLoad:function(){billing.populateCreateAccount(billing.chosenPlanId,function(){$(".billing #createaccount").show()});billing.setPageTitle(translation._("Create Account"));
billing.setSubTitle("create-account");billing.saveNextState("enhance");billing.showFreeTrial()},createAccountNext:function(){billing.autoSubmitCreateAccount(null,function(a){$("#createaccount").hide();billing.hideFreeTrial();billing.loadEnhancePlanStep(a)})},enhancePlanNext:function(){billing.ariaacctvalid?billing.saveFeatures(function(a){a.success?(billing.clearSubTitle(),billing.hideFreeTrial(),billing.setPageTitle(translation._("Start Using HootSuite")),billing.populateHsuLink(a.hsuData),billing.horizontalStep(4),
$(".billing #enhanceplan").hide(),billing.populateBillingSection(void 0,void 0,void 0,function(){$("#ccForm").hide();$("#ccSuccess").hide();$("#enhancePlanSuccess").show();billing.populateHsuLink(a.hsuData);billing.hidePaymentMethods();$("#billing-section").show();billing.setConfirmationBanner("thank-you")})):alert(translation._("Problem saving features. Please try again."))}):billing.storeFeatures(function(a){a?($("#enhanceplan").hide(),billing.saveNextState("billing"),billing.loadBillingStep(void 0)):
alert(translation._("problem saving features. please try again."))})},billingNext:function(){billing.saveNextState("enhance");billing.submitPayment()},postConfirmationLoaded:function(){billing.setPageTitle(translation._("Start Using Hootsuite"));billing.setConfirmationBanner("thank-you");billing.horizontalStep(4)},confirmationEnhancePlan:function(){$("#billing-section").hide();billing.loadEnhancePlanStep(void 0,true)}},{postLoad:function(){billing.populateEnhancePlanSection(billing.chosenPlanId,void 0,
function(){$(".billing #enhanceplan").show()})},createAccountNext:function(){billing.autoSubmitCreateAccount(null,function(a,b){$("#createaccount").hide();billing.storeFeatures(function(){});billing.populateBillingSection(void 0,billing.updatebilling,b,function(){$("#billing-section").show()})})},enhancePlanNext:function(){$("#enhanceplan").hide();billing.populateCreateAccount(billing.chosenPlanId,function(){$(".billing #createaccount").show()})},billingNext:function(){billing.submitPayment()}},{postLoad:function(){billing.populateCreateAccount(billing.chosenPlanId,
function(){$(".billing #createaccount").show()})},createAccountNext:function(){billing.autoSubmitCreateAccount(null,function(a,b){$("#createaccount").hide();billing.populateEnhancePlanSection(void 0,a,function(){$("#enhanceplan").show()});billing.populateBillingSection(void 0,billing.updatebilling,b,function(){$("#billing-section").show()})})},enhancePlanNext:function(){},billingNext:function(){billing.storeFeatures(function(a){a||alert(translation._("An error occurred saving features. Please verify features after processing is complete."));
billing.submitPayment()})}},{postLoad:function(){billing.populateEnhancePlanSection(billing.chosenPlanId,void 0,function(){$(".billing #enhanceplan").show()})},createAccountNext:function(){},enhancePlanNext:function(){$("#enhanceplan").hide();billing.populateCreateAccount(billing.chosenPlanId,function(){$(".billing #createaccount").show()});billing.populateBillingSection(void 0,billing.updatebilling,void 0,function(){$("#billing-section").show()})},billingNext:function(){billing.submitPaymentNotLoggedIn()}},
{billingStepNumber:1,enhancePlanStepNumber:2,postLoad:function(){billing.setPageTitle(translation._("Create Account in 3 Easy Steps"));billing.setSubTitle("create-account");billing.saveNextState("billing");billing.showSpinners=false;$("#billing-please-wait").show();billing.populateAllSections(billing.chosenPlanId,billing.updatebiling,void 0,function(){$(".billing #createaccount, .billing #enhanceplan, .billing #billing-section").show();$("#billing-please-wait").hide();$("#memberSignupForm #email").focus()})},
createAccountNext:function(){},enhancePlanNext:function(){billing.saveFeatures(function(a){a.success?(billing.clearSubTitle(),billing.hideFreeTrial(),billing.setPageTitle(translation._("Start Using HootSuite")),billing.populateHsuLink(a.hsuData),billing.horizontalStep(2),$(".billing #enhanceplan").hide(),billing.populateBillingSection(void 0,void 0,void 0,function(){$("#ccForm").hide();$("#ccSuccess").hide();$("#enhancePlanSuccess").show();billing.populateHsuLink(a.hsuData);billing.hidePaymentMethods();
$("#billing-section").show();billing.setConfirmationBanner("thank-you")})):alert(translation._("Problem saving features. Please try again."))})},billingNext:function(){billing.submitPaymentNotLoggedIn()},postConfirmationLoaded:function(){billing.setPageTitle(translation._("Start Using Hootsuite"));billing.setConfirmationBanner("thank-you");billing.horizontalStep(2)},confirmationEnhancePlan:function(){$("#billing-section").hide();billing.loadEnhancePlanStep(void 0,true)}},{postLoad:function(){billing.populateCreateAccount(billing.chosenPlanId,
function(){$(".billing #createaccount").show()});billing.populateEnhancePlanSection(billing.chosenPlanId,void 0,function(){$(".billing #enhanceplan").show()});billing.populateBillingSection(billing.chosenPlanId,billing.updatebilling,void 0,function(){$(".billing #billing-section").show()})},createAccountNext:function(){},enhancePlanNext:function(){},billingNext:function(){billing.submitPaymentNotLoggedIn()}},{postLoad:function(){billing.populateCreateAccount(billing.chosenPlanId,function(){$(".billing #createaccount").show()});
$(".billing #enhanceplan").hide();$(".billing #billing-section").hide();billing.populateEnhancePlanSection(billing.chosenPlanId,void 0,function(){$(".billing #enhanceplan .preexpand").show()});billing.populateBillingSection(billing.chosenPlanId,billing.updatebilling,void 0,function(){$(".billing #billingSection .preexpand").show()})},createAccountNext:function(){billing.populateEnhancePlanSection(billing.chosenPlanId,void 0,function(){$("#enhanceplan").show()})},enhancePlanNext:function(){billing.populateBillingSection(void 0,
billing.updatebilling,void 0,function(){$("#billing-section").show()})},billingNext:function(){billing.submitPaymentNotLoggedIn()}},{postLoad:function(){billing.populateEnhancePlanSection(billing.chosenPlanId,void 0,function(){$(".billing #enhanceplan").show()});$(".billing #createaccount").hide();$(".billing #billing-section").hide();billing.populateCreateAccount(billing.chosenPlanId,function(){});billing.populateBillingSection(billing.chosenPlanId,billing.updatebilling,void 0,function(){})},createAccountNext:function(){billing.populateBillingSection(void 0,
billing.updatebilling,void 0,function(){$("#billing-section").show()})},enhancePlanNext:function(){billing.populateCreateAccount(billing.chosenPlanId,function(){$(".billing #createaccount").show()})},billingNext:function(){billing.submitPaymentNotLoggedIn()}}];
billing.postLoadHook=function(){if(billing.billingABvariant===0)billing.billingABvariant=1;if(billing.memberLoggedIn){var a=$.cookie.read("billingstate");if(billing.billinghistory)billing.populateBillingHistorySection();else if(billing.updatebilling)billing.populateBillingSection(billing.chosenPlanId,billing.updatebilling),$(".billing #billing-section").show();else if(a!==null)switch(a){case "billing":billing.loadBillingStep(void 0);break;case "enhance":billing.loadEnhancePlanStep(void 0)}else billing.ariaacctvalid?
billing.populateEnhancePlanSection(billing.chosenPlanId,void 0,function(){$(".billing #enhanceplan").show()}):billing.populateBillingSection(billing.chosenPlanId,billing.updatebilling,void 0,function(){$(".billing #billing-section").show()})}else billing.callbacks[billing.billingABvariant].postLoad()};
billing.ajaxSignUp=function(a){var b=$(".billing #createaccount"),c=$("#featuresForm").formValues(),f=$("#ccForm").formValues(),e=$("#memberSignupForm").serialize();$(".ajax-signup .formError").empty();ajaxCall({type:"POST",url:"/ajax/member/ajax-signup",data:e+"&addHsuOption="+billing.addhsuoption,success:function(d){d.success=="1"?(d.output&&b.empty().html(d.output),$.isFunction(a)&&a(c,f),c=f=null,billing.memberLoggedIn=true,d="/ga/billingABvariant="+billing.billingABvariant+"/create-account-complete?planId="+
billing.chosenPlanId,billing.addhsuoption&&(d+="&addHsuOption=1"),hs.track(d)):(billing.removeThrobbers(),$("#memberSignupForm input[name='token']").val(d.token),d.error&&(d.memberInvalid?$(".ajax-signup input[id=email]").siblings(".formError").html(d.error):$(".ajax-signup .formError.generalError").html(d.error)),$("html, body").animate({scrollTop:$(".ajax-signup").offset().top},500))}},"qmNoAbort")};
billing.autoSubmitCreateAccount=function(a,b){a!=null&&a.stopPropagation();$(".ajax-signup .formError").empty();var c=$(".ajax-signup input[id=email]").val(),f=$(".ajax-signup input[id=fullName]").val(),e=$(".ajax-signup input[id=password]").val(),d=$(".ajax-signup input[id=confirmPassword]").val(),h=false;hs.util.isEmailValid(c)||($(".ajax-signup input[id=email]").siblings(".formError").html(translation._("Please check e-mail address")),h=true);f==""&&($(".ajax-signup input[id=fullName]").siblings(".formError").html(translation._("Name cannot be empty")),
h=true);e==""&&($(".ajax-signup input[id=password]").siblings(".formError").html(translation._("Password cannot be empty")),h=true);e!==d&&($(".ajax-signup input[id=password]").siblings(".formError").html(translation._("Passwords must match")),h=true);if(!h)return billing.ajaxSignUp(b),true;billing.removeThrobbers();$("html, body").animate({scrollTop:$(".ajax-signup").offset().top},500);return false};
billing.populateAllSections=function(a,b,c,f){var e=$(".billing #allsections");billing.showSpinners&&e.html(billing.spinnerHtml).show();ajaxCall({type:"GET",url:"/ajax/billing/all-create-account-sections",data:"planId="+a+"&addHsuOption="+billing.addhsuoption,success:function(a){a.success=="1"?(a.output&&(e.empty().html(a.output),$(".ajax-signup ._placeholderContainer").improvedPlaceholder(),$("#billingSection ._placeholderContainer").improvedPlaceholder()),billing.checkCouponToken=a.checkCouponToken,
billing.memberLoggedIn=a.isMemberLoggedIn,billing.showFreeTrial(),billing.showPaymentMethods(),billing.showSavePlanChangeButtons(),billing.populateCountry(),billing.updatePrice(),$("#ccForm").formValues(c),$("#billingStateContainer").formValues(c),$.isFunction(f)&&f()):(e.empty(),hs.statusObj.update(translation._("Error retrieving create account forms."),"error",true))}},"qmNoAbort")};
billing.populateCreateAccount=function(a,b){var c=$(".billing #createaccount");billing.showSpinners&&c.html(billing.spinnerHtml).show();ajaxCall({type:"GET",url:"/ajax/billing/signup-section",data:"planId="+a+"&addHsuOption="+billing.addhsuoption,success:function(a){if(a.success=="1"){a.output&&(c.empty().html(a.output),$(".ajax-signup ._placeholderContainer").improvedPlaceholder());if(a.isMemberLoggedIn)billing.memberLoggedIn=true,c.empty();$.isFunction(b)&&b();billing.showFreeTrial();a="/ga/billingABvariant="+
billing.billingABvariant+"/create-account?planId="+billing.chosenPlanId;billing.addhsuoption&&(a+="&addHsuOption=1");hs.track(a)}else c.empty(),hs.statusObj.update(translation._("Error retrieving signup section."),"error",true)}},"qmNoAbort")};
billing.init=function(a,b){if(a!=void 0&&b!=void 0)billing.countryList=a,billing.stateList=b,billing.populateCountry();billing.checkSeatRequirement($("#seatsFeature input[name='seats']").val());billing.updatePrice();document.billingConfirmationLoaded=billing.confirmationLoaded;$("#seatUpperLimitErroMsg a._close").click(function(){$("#seatUpperLimitErroMsg").hide()});plans.initFeatureInfoPopup()};
billing.openPricingPopup=function(a){var b='<table style="width: 100%; margin: 5px 0pt 15px;"><tbody>';a=="PRICING_GRANDFATHER_PRE_TEAMS"?(b+="<tr><td><strong>"+translation._("1st User")+"</strong></td><td>"+translation._("You!")+"</td></tr>",b+="<tr><td><strong>"+translation._("2nd User")+"</strong></td><td>"+translation._("Always Free for Pro accounts")+"</td></tr>",b+="<tr><td><strong>"+translation._("Next 4 (3rd to 6th)")+"</strong></td><td>"+translation._("$15 each per month")+"</td></tr>",b+=
"<tr><td><strong>"+translation._("Next 5 (7th to 11th)")+"</strong></td><td>"+translation._("$30 each per month")+"</td></tr>",b+="<tr><td><strong>"+translation._("Next 4 (12th to 15th)")+"</strong></td><td>"+translation._("$50 each per month")+"</td></tr>",b+="</tbody></table>",b+="<p>"+translation._("e.g. For a team of 7 users:")+"</p>",b+="<p>"+translation._("Yourself and 1 other are included with the Pro account, the next 4 users are $15 each per month, and the remaining user is $30 per month. Total additional cost is $90 per month: 3rd to 6th user @ $60 (4 x $15) plus 7th user @ $30.")+
"</p>"):(b+="<tr><td><strong>"+translation._("1st User")+"</strong></td><td>"+translation._("You!")+"</td></tr>",b+="<tr><td><strong>"+translation._("2nd User")+"</strong></td><td>"+translation._("Always Free for Pro accounts")+"</td></tr>",b+="<tr><td><strong>"+translation._("3rd User")+"</strong></td><td>"+translation._("$10 per month")+"</td></tr>",b+="<tr><td><strong>"+translation._("Next 7 (4th to 10th)")+"</strong></td><td>"+translation._("$15 each per month")+"</td></tr>",b+="</tbody></table>",
b+="<p>"+translation._("e.g. For a team of 7 users:")+"</p>",b+="<p>"+translation._("Yourself and 1 other are included with the Pro account, the next user is $10 per month, and the remaining users are $15 each per month. Total additional cost is $70 per month: 3rd user @ $10 plus 4th to 7th user @ $60 (4 x $15).")+"</p>");a='<div id="pricingInfoContent" class="ui-dialog-section rb-a-3"><h2>'+translation._("Adding Users")+"</h2><p>"+translation._("Pricing for additional users depends on the total number of users added to your account. The chart below explains the pricing:")+
"</p>"+b+"</div>";a=$("._tierPlanPricingPopup").html(a);$.fancybox(a,{openEffect:"fade",closeEffect:"fade",padding:10,maxWidth:500,minHeight:"auto",fitToView:false})};
billing.checkSeatRequirement=function(a){var a=parseInt(a),b=true,c=$("#seatsFeature"),f=c.find("input[name='seats']"),e=parseInt(c.find("input[name='seats']").attr("minimumrequired")),c=parseInt(c.find("input[name='seats']").attr("featurelimit"));e>c?(a>c&&($("#seatUpperLimitErroMsg").show(),f.val(c)),billing.manageSeats(),b=false):a>c?(f.val(c),$("#seatUpperLimitErroMsg").show(),b=false):a<e&&(f.val(e),billing.manageSeats(),b=false);return b};
billing.storeFeatures=function(a){$("#couponCode").val(JSON.stringify(billing.coupons));var b=$("#featuresForm").serialize();ajaxCall({type:"POST",url:"/ajax/billing/billing-store-features",data:b,success:function(b){b.success||hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",true);$.isFunction(a)&&a(b.success)}},"qmNoAbort")};
billing.addCoupon=function(){var a=$("#couponCode").val(),b={couponCode:a,token:billing.checkCouponToken};billing.ajaxpage&&(!billing.memberLoggedIn||!billing.ariaacctvalid)?ajaxCall({type:"POST",url:"/ajax/billing/billing-check-coupon-code",data:b,success:function(b){b.success=="1"?(hs.statusObj.update(translation._("Coupon added!"),"success",true),billing.coupons.push(a),$("#couponCode").val(""),$("#couponCodes").html(translation._("Pending coupon codes: ")+billing.coupons.join())):hs.statusObj.update(translation._("Not a valid coupon code, please try again."),
"error",true)}},"qmNoAbort"):ajaxCall({type:"POST",url:"/ajax/billing/billing-add-coupon",data:b,success:function(a){a.success=="1"?($("._addCoupon").slideToggle(),hs.statusObj.update(translation._("Coupon added!"),"success",true),document.location=document.location.href):hs.statusObj.update(translation._("Not a valid coupon code, please try again."),"error",true)}},"qmNoAbort")};
billing.saveFeatures=function(a){hs.throbberMgrObj.add("._saveAddons");var b=$("#featuresForm").serialize();billing.ajaxpage?ajaxCall({type:"POST",url:"/ajax/member/save-plan",data:b,success:function(b){if(b.success=="1"){if(hs.statusObj.update(translation._("Features saved!"),"success",true),!billing.ajaxpage)document.location=document.location.href}else hs.statusObj.update(translation._("Error saving features"),"error",true);hs.throbberMgrObj.remove("._saveAddons");$.isFunction(a)&&a(b);b="/ga/billingABvariant="+
billing.billingABvariant+"/enhanceplan-complete/"+$("#featuresForm").serialize();hs.track(b)}},"qmNoAbort"):$("#featuresForm").submit()};billing.showBillingSection=function(){$("#billingSection").show();$("#featuresSummary").show();$("#featuresSection").hide()};billing.hideBillingSection=function(){$("#billingSection").hide();$("#featuresSummary").hide();$("#featuresSection").show()};
billing.updatePrice=function(){billing.currentCost=parseFloat($("#selectedPlan").attr("cost"));var a={},b=$("#seatsFeature"),c=b.find("input[name='seats']"),f=0;if(c.length&&!isNaN(parseInt(c.val()))){f=parseInt(c.val());f<0&&(f=0,c.val("0"),b.find("._subtotal").html("$0.00"));var e=billing.getTotalCostForTieredFeature(f,billing.tiers.seat);b.find("._subtotal").html("$"+e.toFixed(2));a[b.attr("featureid")]=e;var d=billing.getTierForAmount(f,billing.tiers.seat),d=d==void 0?billing.getTierForAmount(1,
billing.tiers.seat).price:d.price;b.find("._numericPrice").html(d);billing.currentCost+=e}else c.val("0"),b.find("._subtotal").html("$0.00"),b.find("._numericPrice").html("0.00");var h=$("#prioritySupportFeature"),b=h.find("input");b.length&&b.prop("checked")?(e=billing.getTotalCostForTieredFeature(f,billing.tiers.support),billing.currentCost+=e,a[h.attr("featureid")]=e,h.removeClass("unchecked"),h.find("._subtotal").html("$"+e.toFixed(2))):(h.addClass("unchecked"),h.find("._subtotal").html("$0.00"));
var l=$("#owlyFeature"),h=l.find("input");h.length&&h.prop("checked")?(e=parseFloat(h.attr("cost")),billing.currentCost+=e,a[l.attr("featureid")]=e,l.removeClass("unchecked"),l.find("._subtotal").html("$"+parseFloat(h.attr("cost")).toFixed(2))):(l.addClass("unchecked"),l.find("._subtotal").html("$0.00"));d=$("#owlyEnterpriseFeature");l=d.find("input");l.length&&l.prop("checked")?(e=parseFloat(l.attr("cost")),billing.currentCost+=e,a[d.attr("featureid")]=e,d.removeClass("unchecked"),d.find("._subtotal").html("$"+
parseFloat(l.attr("cost")).toFixed(2))):(d.addClass("unchecked"),d.find("._subtotal").html("$0.00"));var g=$("#archiveFeature"),d=g.find("select[name='messageArchiving']"),e=0;isNaN(parseInt(d.find("option:selected").val()))?(d.val("0"),g.find("._subtotal").html("$0.00"),g.find("._numericPrice").html("0.00")):(archiveLevel=parseInt(d.find("option:selected").val()),archiveLevel<=0?(archiveLevel=0,d.val("0"),g.find("._subtotal").html("$0.00")):(e=billing.getTotalCostForTieredFeature(archiveLevel,billing.tiers.messageArchiving),
g.find("._subtotal").html("$"+e.toFixed(2)),a[g.attr("featureid")]=e,d=billing.getTierForAmount(f,billing.tiers.messageArchiving),d=d==void 0?billing.getTierForAmount(1,billing.tiers.messageArchiving).price:d.price,g.find("._numericPrice").html(d),billing.currentCost+=e));var d=$("#hsuSeatsFeature"),e=d.find("input"),g=d.find("input:checked:enabled").length,j=d.attr("basefeature"),j=g-j>0?g-j:0;g?(e=j*e.attr("cost"),billing.currentCost+=e,a[d.attr("featureid")]=e,d.removeClass("unchecked"),d.find("._subtotal").html("$"+
parseFloat(e).toFixed(2))):(d.addClass("unchecked"),d.find("._subtotal").html("$0.00"));g=$("#reportFeature");j=g.find("select[name='reportingChunks']");isNaN(parseInt(j.find("option:selected").val()))?(j.val("0"),g.find("._subtotal").html("$0.00"),g.find("._numericPrice").html("0.00")):(e=parseInt(j.find("option:selected").val()),e*billing.reportingChunkUnits+billing.planBaseCredits<billing.currentReportCredits?($("#reportCreditsErroMsg").show(),j.val(billing.currentReportsVal),e=billing.currentReportsVal):
$("#reportCreditsErroMsg").hide(),e<0&&(e=0,j.val("0"),g.find("._subtotal").html("$0.00")),d=g.attr("cost")*e,e==0?(d=0,g.addClass("unchecked")):g.removeClass("unchecked"),e=d,g.find("._subtotal").html("$"+e.toFixed(2)),a[g.attr("featureid")]=e,g.find("._numericPrice").html(d),billing.currentCost+=e,billing.currentReportsVal=j.val());for(e=0;e<this.activeCoupons.length;e++)d=this.activeCoupons[e],d.amount!=0&&(d.featureId==0?d.priceType=="flat"?billing.currentCost-=d.amount:d.priceType=="percentage"&&
(billing.currentCost-=billing.currentCost*(d.amount/100)):d.priceType=="percentage"&&(g=a[d.featureId],g!=void 0&&g>0&&(billing.currentCost-=g*(d.amount/100))));if(billing.currentCost<0)billing.currentCost=0;billing.currentCost=Math.round(billing.currentCost*100)/100;$("#totalCost").html(billing.currentCost);$("#dynamicFeatures").length&&($("#dynamicFeatures ._totalCost").html(billing.currentCost),$("#dynamicFeatures ._seats ._num").html(c.val()),$("#dynamicFeatures ._seats ._cost").html(billing.getTotalCostForTieredFeature(f,
billing.tiers.seat).toFixed(2)),c.length&&!isNaN(parseInt(c.val()))&&parseInt(c.val())>0?$("#dynamicFeatures ._seats").show():$("#dynamicFeatures ._seats").hide(),b.length&&b.prop("checked")?($("#dynamicFeatures ._prioritySupport ._cost").html(billing.getTotalCostForTieredFeature(f,billing.tiers.support).toFixed(2)),$("#dynamicFeatures ._prioritySupport").show()):$("#dynamicFeatures ._prioritySupport").hide(),h.length&&h.prop("checked")?$("#dynamicFeatures ._owlyPro").show():$("#dynamicFeatures ._owlyPro").hide(),
l.length&&l.prop("checked")?$("#dynamicFeatures ._owlyEnterprise").show():$("#dynamicFeatures ._owlyEnterprise").hide())};billing.getTierForAmount=function(a,b){for(var c=0;c<b.length;c++)if(a>=b[c].min&&a<=b[c].max)return b[c]};billing.getTotalCostForTieredFeature=function(a,b){for(var c=0,f=0;f<=a;f++){var e=billing.getTierForAmount(f,b);e!=void 0&&(c+=e.price)}return c};
billing.decrementSeats=function(){var a=$("#seatsFeature input[name='seats']"),b=parseInt(a.val());a.length&&!isNaN(parseInt(b))&&parseInt(b)>0&&(b-=1,billing.checkSeatRequirement(b)&&(a.val(b),billing.updatePrice(),$("#seatUpperLimitErroMsg").hide()))};billing.incrementSeats=function(){var a=$("#seatsFeature input[name='seats']"),b=parseInt(a.val());a.length&&!isNaN(parseInt(b))&&(b+=1,billing.checkSeatRequirement(b)&&(a.val(b),billing.updatePrice(),billing.manageSeatsRemove()))};
billing.showHistoryInvoice=function(a){a=window.open(hs.c.rootUrlSSL+"/show-history-invoice?id="+a,"Invoice","height=700,width=790,toolbar=no,menubar=yes,status=no,location=no,directories=no");window.focus&&a.focus()};
billing.manageSeats=function(){$("#seatManagement").html('<img src="'+hs.util.rootifyImage("/themes/"+(hs.prefs.theme||"blue_steel").toLowerCase()+"/loader.gif")+'" alt="" class="spinner _loading" />');var a=$("#featuresForm input[name='planId']").val();ajaxCall({type:"GET",url:"/ajax/billing/billing-manage-seats?planId="+a+"&n="+$("#seatsFeature input[name='seats']").val(),success:function(a){$("#savePlanChangeButtons").hide();$("#seatManagement").html(a.output);$("#billingManageSeatButton ._cancel").click(function(){billing.manageSeatsRemove()})},
error:function(){billing.manageSeatsRemove();hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",true)}},"qmNoAbort")};billing.manageSeatsRemove=function(){$("#seatManagement").html("");billing.showSavePlanChangeButtons()};billing.cancelPayment=function(){if(confirm("Are you sure you want to cancel this payment? Your account will be set back to Free plan!"))window.location=hs.c.rootUrl+"/member/cancel-payment";return false};
billing.addFeature=function(a,b,c,f,e){ajaxCall({type:"GET",url:"/ajax/billing/billing-change-feature?featureId="+a+"&value="+b+"&itemId="+f,success:function(a){a.success=="1"?($("#featureAccessDeniedPopup").dialog("close"),e=e||translation._("Added feature"),hs.statusObj.update(e,"success",true),$.isFunction(c)&&c()):hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",true)},error:function(){hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),
"error",true)}},"qmNoAbort")};
billing.deleteReports=function(a){ajaxCall({type:"GET",url:"/ajax/analytics/delete-all-reports?saveZeroCostReports=1",success:function(b){b.success=="1"?(hs.statusObj.update(translation._("Deleted all reports with analytics points"),"info",true),$.isFunction(a)&&a()):hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",true)},error:function(){hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",
true)}},"qmNoAbort")};
billing.deleteOrganization=function(a,b){ajaxCall({type:"GET",url:"/ajax/organization/delete?organizationId="+a,success:function(a){a.success=="1"?(hs.statusObj.update(translation._("Deleted organization"),"info",true),$.isFunction(b)&&b()):hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",true)},error:function(){hs.statusObj.update(translation._("An error occurred while processing your request, please try again later"),"error",true)}},
"qmNoAbort")};billing.focusCC=function(){$('#ccForm input[name="paymentType"][value="cc"]').attr("checked","checked")};billing.checkCCNum=function(a){var b=$(a),a=b.val(),b=b.closest("form").find("._ccNumError"),a=a.replace(/[ -]/g,"");billing.testCCNum(a)?b.html(""):b.html(translation._("Invalid Credit Card Number"))};
billing.testCCNum=function(a){var b=false,c=[/^4\d{15}$/,/^5[1-5]\d{14}$/,/^3[4,7]\d{13}$/,/^6011\d{12}$/,/^(?:2131|1800|35\d{3})\d{11}$/];for(i=0;i<c.length;i++)if(a.match(c[i])){b=true;break}return b};billing.checkCVV=function(a){var b=$(a),a=b.val(),b=b.closest("form").find("._cvvError");b.html("");a.length>0&&(a.length<3||a.length>4||isNaN(a))&&b.html(translation._("CVV code must be 3 or 4 digits"))};billing.populateHsuLink=function(a){a!=null&&$("span.hsulink").show()};
billing.removeThrobbers=function(){hs.throbberMgrObj.remove("#ccForm span.btn-cmt");hs.throbberMgrObj.remove("#ccForm span.btn-cta");hs.throbberMgrObj.remove("#submitPaymentBtn");hs.throbberMgrObj.remove("._submitSignup");$("#submitPaymentBtn").removeClass("btn-cta-throbber")};billing.showBillingErrorMessages=function(a){a=$.map(a,function(a){return"<p>"+a+"</p>"}).join("");$("#billingErrorMessages").html(a).show()};
billing.confirmationLoaded=function(a){billing.removeThrobbers();$("#billing-please-wait").hide();$("#billing-section").show();$("html, body").animate({scrollTop:0},"fast");if(a.errorMessages&&a.errorMessages.length>0)billing.showBillingErrorMessages(a.errorMessages),a.validationFailed&&$("#billingZipContainer").show(),a.errorTrackEvents&&a.errorTrackEvents.length>0&&$.map(a.errorTrackEvents,function(a){hs.trackEvent(a)});else if(a.success){document.getElementById("ccForm").style.display="none";document.getElementById("ccSuccess").style.display=
"";document.getElementById("sasLeadPixel")&&$("#sasLeadPixel").html('<img src="https://shareasale.com/sale.cfm?amount=0.00&tracking='+document.getElementById("sasTrackingValue").value+"&transtype=lead&merchantID="+document.getElementById("sasMerchantIdValue").value+'" width="1" height="1">');document.getElementById("cjPixelContainer")&&$("#cjPixelContainer").html('<img src="https://www.emjcd.com/u?AMOUNT=0&CID=1520515&OID='+document.getElementById("cjMemberId").value+"&TYPE="+document.getElementById("cjActionId").value+
'&CURRENCY=USD&METHOD=IMG" height="1" width="20">');a.gaVirtualPageView&&a.gaVirtualPageView.length>0&&hs.track(a.gaVirtualPageView);billing.hidePaymentMethods();$.isFunction(billing.postConfirmationLoadedCallback)&&billing.postConfirmationLoadedCallback(a);var b="/ga/billingABvariant="+billing.billingABvariant+"/billing-complete/"+$("#featuresForm").serialize();hs.track(b);billing.ariaacctvalid=1;billing.populateHsuLink(a.hsuData)}};
billing.recordPaymentAction=function(){billing.ajaxpage&&(hs.track("/ga/billingABvariant="+billing.billingABvariant+"/submit-billing"),ajaxCall({type:"GET",url:"/ajax/billing/record-payment-start",success:function(){},error:function(){}},"q1"))};billing.recordBillingCancel=function(){billing.ajaxpage&&(hs.track("/ga/billingABvariant="+billing.billingABvariant+"/cancel-billing"),ajaxCall({type:"GET",url:"/ajax/billing/record-payment-cancel",success:function(){},error:function(){}},"q1"))};
billing.recordEnhancePlanCancel=function(){billing.ajaxpage&&(hs.track("/ga/billingABvariant="+billing.billingABvariant+"/enhanceplan-cancel"),ajaxCall({type:"GET",url:"/ajax/billing/record-enhanceplan-cancel",success:function(){},error:function(){}},"q1"))};
billing.checkCCForm=function(){var a=[];if($("input[name='paymentType']:checked").val()==="paypal")return true;$("#billingForm #paypalRadio");var b=$("#billingForm #cc_no").val(),c=$("#billingForm #cc_exp_mm").val(),f=$("#billingForm #cc_exp_yyyy").val(),e=$("#billingForm #cvv").val(),d=$("#billingSection #billingCountry").val(),h=$("#billingSeciton #billingState").val();(b.length<15||isNaN(b))&&a.push(translation._("Please enter a valid credit card number."));c==""&&a.push(translation._("Please choose credit card expiry month."));
f==""&&a.push(translation._("Please choose credit card expiry year."));(e.length<3||e.length>4||isNaN(e))&&a.push(translation._("Please enter a valid CVV."));d==""&&a.push(translation._("Please choose a Country."));h==""&&a.push(translation._("Please choose a State or Province."));return a.length>0?($("html, body").animate({scrollTop:$("#billingSection").offset().top},"fast"),billing.showBillingErrorMessages(a),false):true};
billing.submitPayment=function(){if(!$("#submitPaymentBtn").hasClass("btn-cta-throbber")){var a=$("#billingCountry"),b=$("#billingState"),c=$("#billingZip");$("#submitPaymentBtn").addClass("btn-cta-throbber");hs.throbberMgrObj.add("#submitPaymentBtn");billing.recordPaymentAction();ajaxCall({type:"GET",url:"/ajax/billing/billing-save-address?country="+a.val()+"&state="+b.val()+"&zip="+c.val(),success:function(a){a.success=="1"?($("#addressError").html(""),$("#paypalRadio:checked").length>0?billing.startPaypal():
$("#billingForm").submit()):(billing.removeThrobbers(),$("#addressError").html(translation._("Please verify that you have selected a valid Country.")))},error:function(){hs.statusObj.update(translation._("An error occurred while processing your request, please try again later. Your credit card was not charged."),"error",true)}},"q1");var f="Billing Signup Flow";$("#ccRadio:checked").length>0&&(f="Start Free Trial");hs.trackEvent({category:f,action:a.val()+"/"+b.val(),label:c.val(),value:$("#authAttempts").val()})}};
billing.startPaypal=function(){ajaxCall({type:"GET",url:"/ajax/billing/billing-start-paypal",success:function(a){a.success=="1"?(billing.saveNextState("billing"),document.location.href=a.returnUrl+a.token,a="/ga/billingABvariant="+billing.billingABvariant+"/start-paypal"):(hs.statusObj.update(translation._("An error occurred while processing your request, please try again later. Your PayPal account was not charged."),"error",true),a="/ga/billingABvariant="+billing.billingABvariant+"/start-paypal-error");
hs.track(a)},error:function(){hs.statusObj.update(translation._("An error occurred while processing your request, please try again later. Your PayPal account was not charged."),"error",true);hs.track("/ga/billingABvariant="+billing.billingABvariant+"/start-paypal-error")}},"qmNoAbort")};
billing.populateCountry=function(){var a=$("#billingCountry");a.length<1||(a.find("option").length<=0&&a.append($("<option/>").attr("value","").text(translation._("Select Country"))).val(""),$(billing.countryList).each(function(b,c){a.append($("<option/>").attr("value",c[0]).text(c[1]))}),a.val(a.attr("currval")),a.bind("change",billing.countryChanged),billing.countryChanged())};
billing.countryChanged=function(){var a=$("#billingCountry"),b=$("#billingState"),c=b.closest("p").find("label");a.val()=="US"?c.html(translation._("State")):a.val()=="CA"?c.html(translation._("Province")):c.html(translation._("State/Province"));var f;billing.stateList[a.val()]!=void 0?(f=$("<select/>"),$(billing.stateList[a.val()]).each(function(a,b){f.append($("<option/>").attr("value",b[0]).text(b[1]))})):f=$("<input/>");if(f[0].nodeName!=b[0].nodeName||f[0].nodeName=="SELECT")f.attr("name",b.attr("name")).attr("id",
b.attr("id")).attr("type","text").val(b.val()),b.replaceWith(f);a.val()!=""&&$("#billingStateContainer").show();return true};billing.showCvvPopup=function(){open("https://secure.ariasystems.net/webclients/HootSuitePay/whatisCVV.php","displayWindow","top=40,left=50,width=480,height=200,scroll=auto");hs.trackEvent({category:"Billing Signup Flow",action:"Why CVV"})};
billing.submitCoupon=function(){$("._submitCoupon").hasClass("btn-cta-throbber")||($("._submitCoupon").addClass("btn-cta-throbber"),hs.throbberMgrObj.add("._submitCoupon",'<span class="btn-ts">'+translation.c.LOADING+"</span>"),$("#couponForm").submit())};
billing.getAriaSessionInfo=function(){ajaxCall({type:"GET",url:"/ajax/billing/billing-get-aria-session-info",success:function(a){a.success=="1"?a.isAriaSessionValid?($("#billingForm").attr("action",a.ariaUrl),$('input[name="inSessionID"]').val(a.ariaSession),$('input[name="mode"]').val(a.ariaMode),$('input[name="client_no"]').val(a.clientNumber),a.ccSuffix&&$("#cc_no").val("XXXXXXXXXXXX"+a.ccSuffix),a.ccExpireMonth&&$("#cc_exp_mm").val(a.ccExpireMonth),a.ccExpireYear&&$("#cc_exp_yyyy").val(a.ccExpireYear),
a.billingCountry&&($("#billingCountry").val(a.billingCountry),billing.countryChanged(),a.billingState&&$("#billingState").val(a.billingState)),a.billingZip&&$("#billingZip").val(a.billingZip),$(".disabled").removeAttr("disabled").removeClass("disabled"),$(".fieldLoader").hide(),$("#billingCountry").bind("change",billing.countryChanged),$("#submitPaymentBtn").bind("click",function(){billing.submitPayment();return false})):($("#ccForm").hide(),$("#footer").hide(),$("#invalidAriaSession").show()):($("#ccForm").hide(),
$("#footer").hide(),$("#invalidAriaSession").show())},error:function(){$("#ccForm").hide();$("#footer").hide();$("#invalidAriaSession").show()}},"q1")};billing.abTesting={};
billing.abTesting.displayAlternativePaymentTypes=function(){var a=$("#alternativePaymentMethods");a.find("._payment-choice").unbind().click(function(){var a=$(this).attr("choice");billing.abTesting.createAlternativePaymentPopup(a)});a.find("._submit-payment-request").unbind().click(function(){var b=a.find("._requested-payment-type").val();billing.abTesting.submitPaymentChoice({choice:b,notifyMe:1});a.hide();$("._otherPaymentTypeContainer").hide();$("._after-ab-submit-message").show()});a.show()};
billing.abTesting.createAlternativePaymentPopup=function(a){var b=$("#abTestPaymentMethodInfoPopup");$.fancybox(b,{openEffect:"fade",closeEffect:"fade",padding:10,maxWidth:350,minHeight:"auto",fitToView:false,afterShow:function(){b.find("._notify-me-button").click(function(){b.find(".notify-me-input").val(1);$.fancybox.close()})},afterClose:function(){var c={choice:a,notifyMe:b.find(".notify-me-input").val()};billing.abTesting.submitPaymentChoice(c);$("#alternativePaymentMethods").hide();$("._otherPaymentTypeContainer").hide();
$("._after-ab-submit-message").show()}})};billing.abTesting.submitPaymentChoice=function(a){ajaxCall({url:"/ajax/billing/ab-test-save-payment-type-choice",data:"choice="+a.choice+"&notifyMe="+a.notifyMe,success:function(){hs.statusObj.update(translation._("Your choice has been submitted. Thank you!"),"success",true)}},"q1")};var languageSwitcher={defaults:{selectSelector:"#languageSelectionForm select[name='language']",langSep:"ar"},init:function(a){var b=this;this.options=$.extend({},this.defaults,a);this.$select=$(this.options.selectSelector);this.$select.length!==0&&(this.$select.find("option[value='"+this.options.langSep+"']:not(:last)").before('<option disabled="disabled">--------------------</option>'),this.$select.bind("change",function(a){b.changeLanguage(a)}))},changeLanguage:function(){hs.statusObj.update(translation._("Switching language..."),
"info",true,8E3);var a=this.$select.find("option:selected").val();ajaxCall({type:"POST",data:"language="+a,url:"/ajax/index/change-language",success:function(a){hs.statusObj.reset();if(a.success)$.isFunction(window.location.reload)?window.location.reload(true):window.location=window.location.href.replace(window.location.hash,"");else if(a.inProgress)return a={width:347,maxHeight:700,resizable:false,draggable:false,position:["center",60],modal:true,title:translation._("HootSuite Translation Project"),
content:hsEjs.getEjs("index/language_translation").render(a)},$.dialogFactory.create("inProgressLanguagePopup",a),false;else a.paymentProcessorUnavailable&&hs.statusObj!=void 0&&hs.statusObj.update(translation._("Sorry, we are unable to complete this operation right now. Please try again later."),"error",true)},error:function(){hs.statusObj.reset()}},"abortOld");return false}};function adminGetUserInfo(){var a=encodeURI($("div._userInfoSection input[name='userEmailOrMemberId']").val());$("img._getUserInfoSpinner").show();a=a.match(/@/)?"?memberEmail="+a.replace("+","%2B"):"?memberId="+a;ajaxCall({url:"/ajax/admin/get-all-user-data"+a,success:function(a){a.error?alert(a.error):$("div._userInfoSection #userInfoResults").html(a.output);$("img._getUserInfoSpinner").hide()}},"q1")}
function adminGetTwitterUserInfo(){var a=$("div._userInfoSection input[name='twitterUsername']").val();$("img._getTwitterUserInfoSpinner").show();ajaxCall({url:"/ajax/admin/get-data-for-twitter-username?username="+a,success:function(a){a.error?alert(a.error):$("div._userInfoSection #userInfoResults").html(a.output);$("img._getTwitterUserInfoSpinner").hide()}},"q1")}
function adminGetUserLinkedinAccounts(){var a=encodeURI($("div._userInfoSection input[name='userEmailOrMemberId']").val()),b=$("img._getUserInfoSpinner"),a="?memberEmail="+a.replace("+","%2B");b.show();ajaxCall({url:"/ajax/admin/get-linkedin-data"+a,success:function(a){a.error?alert(a.error):($("div._userInfoSection #userInfoResults").html(a.output),$("#adminCreateLinkedinCompanyPage ._startOverLink").show(),$("#linkedinCompanyResults").empty(),$("#createdLinkedinCompanyPageSuccessResults").empty());
b.hide()}},"q1")}
function adminGetLinkedinCompanyInfo(a){var b=$("#userInfoResults"),c=b.find("._linkedinCompanyUrl").val();b.find("._errorNoLinkedinCompanyUrl").hide();if(!c||c.length==0)return b.find("._errorNoLinkedinCompanyUrl").show(),false;var f=$("img._getLinkedinAdminInfoSpinner"),a="?snId="+a+"&linkedinCompanyUrl="+encodeURIComponent(c);f.show();ajaxCall({url:"/ajax/admin/get-linkedin-company-data"+a,success:function(a){a.error?alert(a.error):$("#linkedinCompanyResults").html(a.output);f.hide()}},"q1")}
function adminCreateLinkedinCompanyPage(){var a=$("#linkedinCompanyResults"),b=a.find("[name=companyId]").val(),a="?snId="+a.find("[name=snId]").val()+"&companyId="+b,c=$("img._createLinkedinCompanyPageSpinner");c.show();ajaxCall({url:"/ajax/admin/create-linkedin-company-page"+a,success:function(a){a.error?alert(a.error):$("#createdLinkedinCompanyPageSuccessResults").html(a.output);c.hide()}},"q1")}
function adminChangeMigrationStatus(a,b){ajaxCall({url:"/ajax/admin/change-migration-status?memberId="+a+"&status="+b,success:function(a){a.error?alert(a.error):adminGetUserInfo()}},"q1")}function adminClearCCAuthAttempts(a){ajaxCall({url:"/ajax/admin/clear-cc-auth-attempts?memberId="+a,success:function(a){a.error?alert(a.error):adminGetUserInfo()}},"q1")}
function adminObfuscateEmail(a){ajaxCall({url:"/ajax/admin/obfuscate-email?memberId="+a,success:function(a){a.error?alert(a.error):($("div._userInfoSection input[name='userEmail']").val(a.newEmail),adminGetUserInfo())}},"q1")}function adminEditMemberFeatures(){var a=$("#paidFeaturesEditForm").serialize();ajaxCall({url:"/ajax/admin/edit-member-features",data:a,success:function(a){a.error?alert(a.error):adminGetUserInfo()}},"q1")}
function adminSyncFeaturesFromAria(){$("#syncFeaturesButton").hide();$("#syncFeaturesBlurb").show();ajaxCall({url:"/ajax/admin/sync-from-aria?memberId="+$("#memberId").val(),success:function(a){a.error&&alert(a.error)}},"q1")}function adminChangeMemberFlag(a,b){ajaxCall({url:"/ajax/admin/change-member-flag?memberId="+$("#memberId").val()+"&flag="+a+"&val="+(b?"1":"0"),success:function(b){b.error?alert(b.error):$("#"+a+"Blurb").text(" - Updated")}},"q1")}
function adminChangeCheaterStartDate(a,b){$("#cheaterStartEdit").hide();ajaxCall({url:"/ajax/admin/change-cheater-start-date?memberId="+a+"&date="+b,success:function(a){a.error?alert(a.error):$("span._getUserInfoButton").click()}},"q1")}function adminAddCoupon(){var a=$("#createCouponForm").serialize();ajaxCall({url:"/ajax/admin/add-coupon",data:a,success:function(a){a.error?alert(a.error):($("#searchForm input").val($("#couponCodeInput").val()),$("#searchForm").submit())}},"q1")}
function adminLoadEditCoupon(a){$row=$(a).closest("tr");$row.find("td").each(function(a,c){var f=$(c).attr("field"),e=$(c).text().trim();$("#createCouponForm input[field="+f+"]").val(e)});$("#createCouponArea:visible").length||$("#createCouponArea").slideToggle()}
function adminShowFeatureEdit(a){a=$(a).closest("._row");adminInitializeFeatureEdit(a);a.find("._edit").hide().end().find("._submit").show().end().find("._cancel").show().end().find("._restriction-display").hide().end().find("._value-display").hide().end().find("._restriction-edit").show().end().find("._value-edit").show()}
function adminHideFeatureEdit(a){$(a).closest("._row").find("._edit").show().end().find("._submit").hide().end().find("._cancel").hide().end().find("._restriction-display").show().end().find("._value-display").show().end().find("._restriction-edit").hide().end().find("._value-edit").hide()}
function adminSubmitFeatureEdit(a){var b=$(a).closest("._row"),c=b.find("._restriction-list").val(),f=b.find("._valueInput").val(),e=b.find("._code-display").text(),d=b.attr("featureId"),h=$(a).closest(".primaryContent").find("._featuresViewType").val();if(!confirm("Are you sure you want to change the value of "+e+"?"))return false;ajaxCall({url:"/ajax/admin/update-feature?featureId="+d+"&value="+f+"&restriction="+c+"&view="+h,success:function(d){d.error?alert(d.error):(b.effect("highlight",{},2E3),
b.find("._currentVal").val(f),adminUpdateFeatureDisplay(a),adminHideFeatureEdit(a))}},"q1")}
function adminToggleFeatureQAState(a){var b=$(a).closest("._row"),c=b.find("._code-display").text(),f=b.attr("featureId"),a=$(a).closest(".primaryContent").find("._featuresViewType").val(),e=b.find("._qaState").val(),e=e==0?1:0;if(!confirm("Are you sure you want to change the QA state of "+c+" to "+e+"?"))return false;ajaxCall({url:"/ajax/admin/update-feature-qa-approved?featureId="+f+"&qaState="+e+"&view="+a,success:function(a){a.error?alert(a.error):(b.effect("highlight",{},2E3),b.find("._qaState").val(e),
b.find("._qabutton").removeClass("passed").removeClass("not-passed"),e?b.find("._qabutton").addClass("passed"):b.find("._qabutton").addClass("not-passed"))}},"q1")}
function adminUpdateFeatureDisplay(a){var a=$(a).closest("._row"),b=a.find("._valueInput").val();a.find("._restriction-display").text(a.find("._restriction-list").val());var c="";switch(a.find("._restriction-list").val()){case "boolean":c=b==1?"true":"false";break;case "percentage_static":case "percentage_random":c=b+"%";break;case "passthrough":case "member_list":case "organization_list":case "organization_percentage_static":c=b+"%";break;case "plan_code":c=b}a.find("._value-display").text(c)}
function adminInitializeFeatureEdit(a){var b=a.find("._restriction-list").val(),c="",f=a.find("._currentVal").val();switch(b){case "boolean":c='<select class="selectInput _valueInput" name="value"><option '+(f==1?'selected="selected"':"")+' value="1">True</option><option '+(f==0?'selected="selected"':"")+' value="0">False</option></select>';break;case "percentage_static":case "percentage_random":case "passthrough":case "member_list":case "organization_list":case "organization_percentage_static":c=
'<input class="tableTextInput _valueInput" type="text" value="'+f+'" name="value" style="width: 150px;" />';break;case "plan_code":a.find("._value-edit").empty().html('<span class="btn-throbber">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>'),ajaxCall({url:"/ajax/admin/get-valid-member-plans",success:function(b){b.success&&(c='<select class="selectInput _valueInput" name="value">',$.each(b.plans,function(a,b){c+='<option value="'+b.code+'">'+b.name+"</option>"}),c+="</select>",
a.find("._value-edit").empty().html(c))}},"q1")}b!="plan_code"&&a.find("._value-edit").empty().html(c)}function adminToggleEditForm(){$("#createCouponArea").slideToggle();$("#createCouponArea input,#createCouponArea select").each(function(a,b){$(b).val("")})}function adminToggleEditApiKeyForm(){$("#editApiKeyArea").slideToggle();$("#editApiKeyArea input").each(function(a,b){$(b).val("")});$("#editApiKeyForm div._sendEnabledEmail input").attr("checked",false)}
function adminLoadEditApiKey(a){$row=$(a).closest("tr");$row.find("td").each(function(a,c){var f=$(c).attr("field"),e=$(c).text().trim();if(f=="apiKey"||f=="name")$("#editApiKeyForm span[name="+f+"]").html(e);else{if(e=="unlimited")e=-1;else if(e=="Basic"||e=="False")e=0;else if(e=="Advanced/Internal"||e=="True")e=1;$("#editApiKeyForm input[field="+f+"]").val(e)}});$("#editApiKeyForm div._sendEnabledEmail input").attr("checked",false);$("#editApiKeyForm input[field=isActive]").val()==0?$("#editApiKeyForm div._sendEnabledEmail").show():
$("#editApiKeyForm div._sendEnabledEmail").hide();$("#editApiKeyForm:visible").length||$("#editApiKeyArea").slideToggle()}function adminSaveApiKey(){var a=$("#editApiKeyForm").serialize();0==$("#editApiKeyForm input[field=isActive]").val()&&$("#editApiKeyForm input[field=sendEnabledEmail]").is(":checked")?alert("You cannot send the email unless the key has been enabled"):ajaxCall({url:"/ajax/admin/save-api-key",data:a,success:function(a){a.error?alert(a.error):window.location.reload()}},"q1")}
$("._oauth2ClientsSection ._oauth2ClientShowSecret").click(function(a){var b=$(this).data("client_id"),c="clientSecretBox"+b;$(".clientSecretBox").remove();var f=$("<div>").attr("id",c).addClass("clientSecretBox");$(f).html("Loading...");$(f).insertAfter($(this));ajaxCall({url:"/ajax/admin/get-oauth2-client-secret",data:{clientId:b},success:function(a){var b="";b+=a.error?'<span class="error">'+a.error+"</span>":" "+a.clientSecret;b+=' <span class="icon-30 closeButton _close"></span>';$(f).html(b)}},
"q1");a.preventDefault()});$("._oauth2ClientsSection .clientSecretBox ._close").live("click",function(a){$(this).closest(".clientSecretBox").remove();a.preventDefault()});function adminCheckEnabledEmailNotChecked(){if($("#editOauthClientForm input[id=sendEnabledEmail]").is(":checked"))return alert('You have selected the "Enabled" email and hit the "Deny" button. Please review.'),false}
function adminCheckDeniedEmailNotChecked(){if($("#editOauthClientForm input[id=sendDeniedEmail]").is(":checked"))return alert('You have selected the "Denied" email and hit the "Approve" button. Please review.'),false}
function adminSendEmailAction(){document.getElementById("clientEmailMessage").style.display="";document.getElementById("clientEmailMessage").focus();if(document.getElementById("sendEnabledEmail").checked)document.getElementById("clientEmailMessage").value="Your HootSuite API app has been approved.\n\nPlease, visit My Apps to retrieve the OAuth 2 credentials that have been issued for your app: http://www.hootsuite.com/developers/my-apps .\n\nAnd make sure to read the OAuth 2 documentation for further information on using OAuth 2 with the API: http://www.hootsuite.com/developers/api/oauth2 .";if(document.getElementById("sendDeniedEmail").checked)document.getElementById("clientEmailMessage").value=
"Thank you for your interest in the HootSuite API. \n\nYour application is missing some key information that we require:\n- A valid redirect URI\n- A descriptive or unique application name\n- A description of what the application is intended to do"}
$("._oauth2PermissionsSection ._oauth2PermissionEndpointSelect").change(function(a){var b=$(this).val(),c=$("#oauthClientId").val();0!=b&&(ajaxCall({url:"/ajax/admin/get-api-permission-specs",data:{id:b,clientId:c},success:function(a){a.error?alert(a.error):$("form.editPermissions ._endpointSpecs").html(a.output)}},"q1"),a.preventDefault())});
function adminSaveOauthClientPermission(){var a=$("#editOauthPermissionsForm").serialize();ajaxCall({url:"/ajax/admin/save-api-permission-specs",data:a,success:function(a){a.error?alert(a.error):($("#clientPermId").val(a.clientPermId),alert("Settings saved"))}},"q1");event.preventDefault()}
function adminSaveGlobalRelayAccountInfo(){$("#globalRelayAccountInfoFormStatus").html('<img src="/images/buttons/btn-throbber.gif" />');var a=$("#globalRelayAccountInfo").serialize();ajaxCall({url:"/ajax/admin/save-global-relay-account-info",data:a,success:function(a){a.error?(alert(a.error),$("#globalRelayAccountInfoFormStatus").html("<strong>Error :/</strong>").css("color","red")):$("#globalRelayAccountInfoFormStatus").html("<strong>Saved</strong>").css("color","green")}},"q1")}
function adminRemoveHsAdmin(){var a=$(this).closest("._admin-row");if(!confirm("Are you sure you want to remove admin access?"))return false;ajaxCall({url:"/ajax/admin/remove-hs-admin",data:"adminId="+a.attr("adminId"),success:function(b){b.error?alert(b.error):fadeSlideRemove(a)}},"q1")}
function adminCreateHsAdmin(){var a=$(this).closest("._new-hs-admin-form"),b="email="+encodeURIComponent(a.find("input[name=email]").val());a.find("input:checkbox:checked").each(function(a,f){b+="&permissions[]="+$(f).val()});ajaxCall({url:"/ajax/admin/create-hs-admin",data:b,success:function(b){b.error?alert(b.error):($("._nameFilter").val(a.find("input[name=email]").val()),adminLoadHsAdminTable(),alert("Member has been added as an admin"))}},"q1")}
function adminShowModifyPermissions(){$(this).closest("._admin-row").find("._permission-list-text").hide().end().find("._permission-list-select").show().end().find("._removeAdmin").hide().end().find("._modifyPermissions").hide().end().find("._cancelModify").show().end().find("._submitModify").show()}
function adminHideModifyPermissions(){$(this).closest("._admin-row").find("._permission-list-select").hide().end().find("._permission-list-text").show().end().find("._cancelModify").hide().end().find("._submitModify").hide().end().find("._removeAdmin").show().end().find("._modifyPermissions").show()}
function adminSubmitHsAdminModifications(){var a=$(this).closest("._admin-row"),b="adminId="+a.find("input[name=adminId]").val();a.find("input:checkbox:checked").each(function(a,f){b+="&permissions[]="+$(f).val()});ajaxCall({url:"/ajax/admin/modify-hs-admin-permissions",data:b,success:function(b){if(b.error)alert(b.error);else{var f='<table border="0"><tbody>';$.each(b.permissionInfo,function(a,b){f+='<tr><td><label><span class="icon-19 checkmark"></span>&nbsp;<strong>'+b.name+"</strong> - "+b.description+
"</label></td></tr>"});f+="</tbody></table>";a.find("._permission-list-text").empty().html(f).end().find("._cancelModify").click()}}},"q1")}
function adminLoadHsAdminTable(){$("._permissionFilter").val();var a=$("._admin-table-content");a.html('<img class="table-loading-image" src="/images/buttons/btn-throbber.gif">');ajaxCall({url:"/ajax/admin/hs-admins-table",data:"permissionFilter="+$("._permissionFilter").val(),success:function(b){b.error?alert(b.error):(a.html(b.output),adminFilterHsAdminTableByName())}},"q1")}
function adminFilterHsAdminTableByName(){var a=$("._admin-search-filters ._nameFilter").val().toLowerCase(),b=$("._admin-table-content");$.each(b.find("._admin-row"),function(b,f){($(f).find("._admin-name").text().toLowerCase()+$(f).find("._admin-email").text().toLowerCase()+$(f).find("._admin-memberId").text().toLowerCase()).indexOf(a)>=0?$(f).show():$(f).hide()})}
function adminToggleVanityUrlForm(a){a=$(a).val();hideAndClearVanityUrlForm();a=="OWLY"?($("#addVanityUrlForm ._vanityurlFormUrl").show(),$("#addVanityUrlForm ._vanityurlFormHomeUrl").show()):a=="BITLY"?($($("#addVanityUrlForm ._vanityurlFormApiAuth1").find("td")[0]).html("Username"),$("#addVanityUrlForm ._vanityurlFormApiAuth1").show(),$("#addVanityUrlForm ._vanityurlFormApiAuth2").show()):a=="POST"&&($($("#addVanityUrlForm ._vanityurlFormApiAuth1").find("td")[0]).html("Api Key"),$("#addVanityUrlForm ._vanityurlFormApiAuth1").show())}
function hideAndClearVanityUrlForm(){$("#addVanityUrlForm ._vanityurlFormUrl").hide().find("input").val("");$("#addVanityUrlForm ._vanityurlFormHomeUrl").hide().find("input").val("");$("#addVanityUrlForm ._vanityurlFormApiAuth1").hide().find("input").val("");$("#addVanityUrlForm ._vanityurlFormApiAuth2").hide().find("input").val("")}
function adminSaveVanityUrl(){var a=$("#addVanityUrlForm").serialize();ajaxCall({url:"/ajax/admin/add-vanity-url",data:a,success:function(a){a.error?alert(a.error):($("#addVanityUrlForm #resetVanityUrlForm").click(),adminToggleVanityUrlForm($("#addVanityUrlForm select")),$("#vanityUrlList").append(a.output))}},"q1")}
function adminSaveOneLoginSettings(){var a=$("#oneloginInfo").serialize();ajaxCall({url:"/ajax/admin/save-one-login",data:a,success:function(a){a.error?alert(a.error):alert("OneLogin settings saved")}},"q1")}$(function(){$("._submitPreventCommits").on("click",function(){ajaxCall({url:"/ajax/admin/prevent-commits",data:$("form#preventCommitsForm").serialize(),success:function(a){a.success&&hs.reloadBrowser()}},"q1");return false})});
function adminGetABCampaignsTable(a){var b=a.attr("switchTo"),c=$("._ab-campaign-list-container"),b=b=="active"?true:false;c.empty().html('<span class="btn-throbber">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>');ajaxCall({url:"/ajax/admin/ab-campaigns-list",data:"isActive="+b,success:function(c){c.success&&($("._ab-campaign-list-container").html(c.output),b?($("._status-toggle ._inactive").hide(),$("._status-toggle ._active").show(),a.attr("switchTo","inactive")):($("._status-toggle ._active").hide(),
$("._status-toggle ._inactive").show(),a.attr("switchTo","active")))}},"q1")}
function adminFilterCampaignList(){var a=$("#adminManageAbCampaignsPage ._filter").val().toLowerCase(),b=$("#adminManageAbCampaignsPage ._ab-campaign-list-content");$.each(b.find("._row"),function(b,f){($(f).find("._member-name").text()+$(f).find("._member-email").text()+$(f).find("._member-id").text()+$(f).find("._campaign-code").text()+$(f).find("._campaign-description").text()).toLowerCase().indexOf(a)>=0?$(f).show():$(f).hide()})}
function adminSetABCampaignStatus(a,b){var c=b=="active"?true:false;if(!confirm("Marking the campaign as active / inactive will not turn the campaign on or off; you will need access to dark launching if you wish to do this. \nClick OK if you want to continue anyways."))return false;a.find("._toggleStatusButton").unbind();ajaxCall({url:"/ajax/admin/ab-campaign-set-campaign-status",data:"abCampaignId="+a.attr("campaignId")+"&status="+c,success:function(){fadeSlideRemove(a)}},"q1")}
function viewABCampaignDetails(a){$("._ab-campaign-list-container ._ab-campaign-list-content").find("._row").removeClass("highlight");a.addClass("highlight");ajaxCall({url:"/ajax/admin/ab-campaign-get-campaign-details",data:"campaignId="+a.attr("campaignid"),success:function(b){$("._ab-campaign-details-title").find("._campaign-code").text(a.find("._campaign-code").text()).end().show();$("._ab-campaign-details-container").html(b.output)}},"q1")}
function adminLoadEmailPreview(a){var b,c;b=$(a)[0];a=b.dataset.templateType;b=b.dataset.templateName;c=$("form._emailProperties").serialize();window.open("/admin/preview-email?"+(c+"&template="+b+"&format="+a))}
function adminSendEmailPreview(a){var b,c,a=$(a)[0];$("form._emailProperties #toAddress").val()==""?alert("Please enter an e-mail, so we know where to direct the test."):(a=a.dataset.templateName,c=$("form._emailProperties").serialize(),b=$("form._emailProperties #toAddress").val(),ajaxCall({url:"/ajax/admin/send-preview-email",data:c+"&template="+a,success:function(a){a.success&&alert("Email sent to "+b+".")}},"q1"))}
function adminUploadBulkFreeTrials(a){$error=a.find("._error-msg");$error.empty();a.find("._results").empty();_.isEmpty(a.find('input[name="csvFile"]').val())?$error.html("Please select a csv file to upload"):(a.find("._input-csvFile").hide().end().find("._submitBulkUploadForm").hide().end().find("._submitButtonLoading").show().end().find("._processing-upload-msg").show(),a.submit())}
function getOrgTeams(a){var b,c,f;b=a.find("._tabClonerOrg");c=a.find("._tabClonerTeam");a="orgId="+b.val();ajaxCall({url:"/ajax/admin/get-org-teams",data:a,success:function(a){a.teams&&(f='<option value="0">Select a team</option>',$.each(a.teams,function(a,b){f+='<option value="'+b.teamId+'">'+b.name+"</option>"}),c.removeAttr("disabled"),c.html(f))}},"q1")}
function getTeamMembers(a){var b,c,f;b=a.find("._tabClonerTeam");c=a.find("._tabClonerMember");a="teamId="+b.val();ajaxCall({url:"/ajax/admin/get-team-members",data:a,success:function(a){a.members&&(f='<option value="0">Select a member (optional)</option>',$.each(a.members,function(a,b){f+='<option value="'+b.memberId+'">'+b.fullName+"</option>"}),c.removeAttr("disabled"),c.html(f))}},"q1")}
function submitCloneRequest(a){var b,c,f;b=a.find("input[name=originMemberId]");c=a.find("._tabClonerOrg");f=a.find("._tabClonerTeam");a=a.find("._tabClonerMember");if(c.val()==0||f.val()==0)return alert("Sorry. You must select at least an organization and team to proceed."),false;data="originId="+b.val()+"&orgId="+c.val()+"&teamId="+f.val()+"&memberId="+a.val();b=a.val()==0?f.find("option:selected").text():a.find("option:selected").text();confirm("Are you sure you want to clone this users tabs to "+
b+"?")==true&&ajaxCall({url:"/ajax/admin/clone-dashboard",data:data,success:function(a){a.success?alert("Tabs cloned successfully!"):a.error&&alert("Tabs cloning failed. Depending on where it failed, some tabs and streams may have been cloned.")}},"q1")}
var Service=Backbone.Model.extend({initialize:function(){this.bind("change:serviceData",function(){this.get("serviceData")});this.bind("change:visibleSection",function(){this.get("serviceData");var a=this.get("visibleSection");$("#server"+id+" ._section").each(function(a){a.hide()});$("#server"+id+" ._section"+a).show()})}}),ServiceContainerView=Backbone.View.extend({tagName:"div",initialize:function(){},events:{"click ._dispatcherTab":"showDispatcherPane","click ._workerTab":"showWorkerPane"},showDispatcherPane:function(){this.$el.find("._dispatcherInfo").show();
this.$el.find("._dispatcherTab").css("font-weight","bold");this.$el.find("._workerInfo").hide();this.$el.find("._workerTab").css("font-weight","normal")},showWorkerPane:function(){this.$el.find("._dispatcherInfo").hide();this.$el.find("._dispatcherTab").css("font-weight","normal");this.$el.find("._workerInfo").show();this.$el.find("._workerTab").css("font-weight","bold")},render:function(){var a=this.model.get("serviceData");this.$el.html(hsEjs.getEjs("admin/service-container-view").render(a));this.$el.find("._workerInfo").hide();
return this}}),ServiceDispatcherInfoView=Backbone.View.extend({tagName:"div",initialize:function(){this.model.bind("change",this.render,this)},render:function(){var a=this.model.get("serviceData");this.$el.html(hsEjs.getEjs("admin/service-dispatcher-info-view").render(a));return this}}),ServiceWorkerInfoView=Backbone.View.extend({tagName:"div",selectedWorker:void 0,initialize:function(){this.model.bind("change",this.render,this)},events:{"click ._individualWorkerName":"showIndividualWorker"},showIndividualWorker:function(a){this.selectedWorker=
$(a.target).parent().attr("workerid");$(a.target).parent().find("._individualWorkerInfo").show()},render:function(){var a=this.model.get("serviceData");a.selectedWorker=this.selectedWorker;this.$el.html(hsEjs.getEjs("admin/service-worker-info-view").render(a));return this}}),ServiceList=Backbone.Collection.extend({model:Service,comparator:function(a){return a.get("stats.name")}}),services=new ServiceList;
function adminStartServicePolling(a){adminPollService(a);updateGraphs(a);setInterval(function(){adminPollService(a)},1E3);setInterval(function(){updateGraphs(a)},1E4)}
function updateGraphs(a){var b="bucky";window.location.href.indexOf("hootd")!=-1&&(b="graph",a="dev");$("#graph1").length?($("#graph1").attr("src","http://"+b+".hootsuitemedia.com/render?width=300&from=-1hours&until=now&height=200&target=stats.dashboard.zmq.service.*"+a+"*.dispatcher.messagesIn&hideLegend=true&title=Dispatcher_Messages_In&bgcolor=333333&uniq="+Math.random()),$("#graph2").attr("src","http://"+b+".hootsuitemedia.com/render?width=300&from=-1hours&until=now&height=200&target=scale(stats.dashboard.zmq.service.*"+
a+"*.dispatcher.availableWorkers%2C1.85)&title=Available_Workers&areaMode=stacked&hideLegend=true&bgcolor=333333&uniq="+Math.random()),$("#graph3").attr("src","http://"+b+".hootsuitemedia.com/render?width=300&from=-1hours&until=now&height=200&target=alias(scale(stats.dashboard.zmq.service.*"+a+"*.dispatcher.messageQueueSize%2C1.85)%2C%20'Queue%20Size')&target=alias(secondYAxis(stats.dashboard.zmq.service.*"+a+"*.dispatcher.expiredMessages.*)%2C%20'Expired%20Messages')&title=Message_Queue_Size&areaMode=stacked&hideLegend=true&bgcolor=333333&uniq="+
Math.random())):($("#graphs").append($('<img id="graph1" src="http://'+b+".hootsuitemedia.com/render?width=300&from=-1hours&until=now&height=200&target=stats.dashboard.zmq.service.*"+a+'*.dispatcher.messagesIn&hideLegend=true&title=Dispatcher_Messages_In&bgcolor=333333"/>')),$("#graphs").append($('<img id="graph2" src="http://'+b+".hootsuitemedia.com/render?width=300&from=-1hours&until=now&height=200&target=scale(stats.dashboard.zmq.service.*"+a+'*.dispatcher.availableWorkers%2C1.85)&title=Available_Workers&areaMode=stacked&hideLegend=true&bgcolor=333333"/>')),
$("#graphs").append($('<img id="graph3" src="http://'+b+".hootsuitemedia.com/render?width=300&from=-1hours&until=now&height=200&target=alias(scale(stats.dashboard.zmq.service.*"+a+"*.dispatcher.messageQueueSize%2C1.85)%2C%20'Queue%20Size')&target=alias(secondYAxis(stats.dashboard.zmq.service.*"+a+"*.dispatcher.expiredMessages.*)%2C%20'Expired%20Messages')&title=Message_Queue_Size&areaMode=stacked&hideLegend=true&bgcolor=333333\"/>")))}
function adminPollService(a){ajaxCall({url:"/ajax/admin/get-service-data?type="+a,success:function(a){if(a.error)alert(a.error);else{var c=a.serviceData.stats.name,f=c+a.serviceData.stats.pid;if(services.get(f))services.get(f).set(a);else{var e=new Service;e.set(a);e.id=f;a=(new ServiceContainerView({model:e,id:"server"+c+a.serviceData.stats.pid,attributes:{style:"float:left; margin-right:1px;"}})).render().el;c=new ServiceDispatcherInfoView({model:e,el:$(a).find("._dispatcherInfo")});f=new ServiceWorkerInfoView({model:e,
el:$(a).find("._workerInfo")});c.render();f.render();$("#serverInfo").append(a);services.push(e)}}}},"q1")};var member=member?member:{};function updateMemberPreferenceWithTimer(a,b,c,f){c||(c=hs.c.delayPrefsMember*1E3);hs.timers.updateMemberPreferenceTimer!=void 0&&(clearTimeout(hs.timers.updateMemberPreferenceTimer),delete hs.timers.updateMemberPreferenceTimer);hs.timers.updateMemberPreferenceTimer=setTimeout(function(){updateMemberPreference(a,b,f)},c)}
function updateMemberPreference(a,b,c){ajaxCall({url:"/ajax/member/update-preference",data:"type="+encodeURIComponent(a)+"&value="+encodeURIComponent(b),complete:function(){$.isFunction(c)&&c()}},"q1")}
member.notificationPopup=function(){var a=function(){var a=this.$anchor.offset();this.$el.css({display:"block",top:a.top+this.$anchor.outerHeight(true),right:$(window).width()-a.left-this.$anchor.outerWidth(true)-30});this.$anchor.unbind("click").bind("click",c)},b=function(){var b=this;this.$el.css({display:"none"});this.$anchor.unbind("click").bind("click",function(){a.call(b)})},c=function(){hs.reloadBrowser()};return{init:function(){var f=this;this.$container=$("._dashboardAlerts");this.$el=$("#notificationPopup");
this.$anchor=$("._showNotificationPopup");this.$container.filter(":visible").length===0&&(this.$container.show(),this.$el.show().find(".tip").css({left:"auto",right:35}).end().find("._closeNotificationPopup").bind("click",function(){b.call(f);return false}).end().find("._reloadDashboardBtn").bind("click",c).end(),this.$anchor.show().bind("click",function(){a.call(f)}).click())}}}();
member.pingServer=function(){ajaxCall({type:"GET",url:"/ajax/member/ping",success:function(a){a&&a.isForce&&hs.c.jsver&&a.jsver!=hs.c.jsver&&member.notificationPopup.init()}},"qmNoAbort")};/*
 In-Field Label jQuery Plugin
 http://fuelyourcoding.com/scripts/infield.html

 Copyright (c) 2009-2010 Doug Neiner
 Dual licensed under the MIT and GPL licenses.
 Uses the same license as jQuery, see:
 http://docs.jquery.com/License

 Slightly modified by Alexandrine Boissiere
 @version 0.1.2
*/
(function(a){a.InFieldLabels=function(b,c,f){var e=this;e.$label=a(b);e.label=b;e.$field=a(c);e.field=c;e.showing=true;e.init=function(){e.options=a.extend({},a.InFieldLabels.defaultOptions,f);if(e.$field.val()!=="")e.$label.hide(),e.showing=false;e.$label.click(function(){e.$field.trigger("focus")});e.$field.focus(function(){e.fadeOnFocus()}).blur(function(){e.checkForEmpty(true)}).bind("keydown.infieldlabel",function(a){e.hideOnChange(a)}).bind("keyup.infieldlabel",function(a){e.showOnChange(a)}).bind("paste",
function(){e.setOpacity(0)}).change(function(){e.checkForEmpty()}).bind("onPropertyChange",function(){e.checkForEmpty()})};e.fadeOnFocus=function(){e.showing&&e.setOpacity(e.options.fadeOpacity)};e.setOpacity=function(a){e.$label.stop().animate({opacity:a},e.options.fadeDuration,null,function(){e.showing=a>0;e.showing?e.$label.show():e.$label.hide()})};e.checkForEmpty=function(a){e.$field.val()===""?(e.prepForShow(),e.setOpacity(a?1:e.options.fadeOpacity)):e.setOpacity(0)};e.prepForShow=function(){e.showing||
e.$label.css({opacity:0}).show()};e.hideOnChange=function(a){if(!(a.keyCode===16||a.keyCode===9||a.keyCode===224||a.keyCode===17||a.keyCode===18)&&e.showing)e.setOpacity(0,600),e.showing=false};e.showOnChange=function(a){if(!(a.keyCode!==8&&a.keyCode!==46)&&e.$field.val().length===0)e.setOpacity(1),e.isShowing=true};e.init()};a.InFieldLabels.defaultOptions={fadeOpacity:0.6,fadeDuration:300};a.fn.improvedPlaceholder=function(b){return this.each(function(){$label=a(this).find("._placeholderLabel");
$field=a(this).find("._placeholderField");$field.length===0||$label.length===0||new a.InFieldLabels($label[0],$field[0],b)})}})(jQuery);function showVideoPopup(a,b,c,f){var f={modal:true,closeOnEscape:true,draggable:true,content:"<div class='large-loading'><img src='"+hs.util.rootifyImage("/themes/"+hs.prefs.theme.toLowerCase()+"/loader.gif")+"' /></div>",title:f,width:b+12,height:c+46,position:["center","center"]},e=$.dialogFactory.create("hsVideoPopup",f);ajaxCall({type:"GET",url:"/ajax/index/hs-video?hash="+a+"&w="+b+"&h="+c,success:function(a){e.html(a.output)}},"qm")}
function showImagePopup(a,b,c){var f=($(window).width()-b)/2,e=($(window).height()-(c+30))/2,a={modal:false,closeOnEscape:true,resizable:false,draggable:true,content:"<img src='"+hs.util.proxify(a)+"' width='"+b+"' height='"+c+"' />",width:b+13,height:c+47,position:[f,e]};$.dialogFactory.create("aboutImagePopup",a)}
$(function(){function a(d){d.preventDefault();b.toggleClass("btn-glass-dropdown");b.find(".icon-19").swapClass("collapse","expand");c.toggleClass("offScreen");setTimeout(function(){f.focus()},1);c.hasClass("offScreen")?$(document).unbind("click.outside_loginBox"):$(document).bind("click.outside_loginBox",function(b){e!==b.target&&!c.has(b.target).length&&a(b)});return false}var b=$("#loginButton"),c=$("#loginBox"),f=c.find("#loginEmail"),e=c.get();b.bind("click",function(){return false}).bind("mousedown",
a).bind("focus",function(b){setTimeout(function(){c.is(".visHide")&&a(b)},1)});f.focus().select();if($("#container").hasClass("home")){var d=$(".feature"),h=function(a,b,c){b.css("opacity",c?"1":"0.5");a.removeClass("animate");$(document).unbind("click.outside_features");setTimeout(function(){a.removeClass("expanded")},400)};d.mouseenter(function(){(!d.hasClass("expanded")||!d.hasClass("animate"))&&d.not($(this)).css("opacity","0.5")}).mouseleave(function(){(!d.hasClass("expanded")||!d.hasClass("animate"))&&
d.not($(this)).css("opacity","1")}).click(function(){var a=$(this),b=this,c=d.not(a);c.hasClass("expanded")||(!a.hasClass("expanded")||!a.hasClass("animate")?(a.addClass("expanded").addClass("animate"),c.css("opacity","0"),$(document).bind("click.outside_features",function(d){b!==d.target&&!a.has(d.target).length&&h(a,c,true)})):h(a,c,false))});var l=$("#memberSignupForm"),g=$("._submitSignup");g.bind("click",function(){hs.throbberMgrObj.add("._submitSignup");l.submit();return false});l.bind("keypress",
function(a){a.keyCode==13&&(g.click(),a.preventDefault())});$("._placeholderContainer").improvedPlaceholder();l.find("#signupEmail").focus()}$("#pageWrapper").hasClass("_placeholderInputs")&&$("._placeholderContainer").improvedPlaceholder();openid.init("openid_identifier");if($("#planMatrix").filter(".plansCompare").length||$("#page .comparisonChart").length)plans.initFeatureInfoPopup();else if($("._planEnterprise").length)plans.enterprise.init();else if($("._planPro").length){if(typeof billingTiersObject!==
"undefined")billing.tiers=billingTiersObject;plans.pro.init()}if($("#benefits").length){var j=$("#benefits");j.delegate("._tab","click",function(){var a=$(this);j.find("._tab").removeClass("active");a.addClass("active");j.find("._section").hide().filter(".content-"+a.data("section")).show()})}$("#priceDisclaimer").length&&$("#priceDisclaimer").bind("click",function(){$.fancybox($("#priceDisclaimerPopup"),{autoSize:false,height:520,width:600,openEffect:"fade",closeEffect:"fade",padding:10,fitToView:false});
return false});languageSwitcher.init();$("._lightbox").fancybox();var r=$("#bucket .bucket");r.hover(function(){$(this).toggleClass("hover")});r.click(function(){window.location=$(this).find("a").attr("href");return false});var n=0;(function(a){a=$(a);a.each(function(){$(this).height()>n&&(n=$(this).height())});a.height(n)})("#bucket .bucket");$("#oauth2AuthForm ._btnAuth").click(function(){var a=$("<input>").attr("type","hidden").attr("name","allow_access").val("1");$("#oauth2AuthForm").append(a).submit()});
$("#oauth2AuthForm ._btnDeny").click(function(){$("#oauth2AuthForm").submit()});$("#oauth2LogoutForm ._logoutLink").click(function(){$("#oauth2LogoutForm").submit()});if($("#pageWrapper").hasClass("_planPro"))return $("._videoLightbox").fancybox({autoDimensions:false,padding:0,autoScale:false,transitionIn:"fade",transitionOut:"fade",width:800,height:450,type:"swf",swf:{wmode:"transparent",allowfullscreen:"true"}}),false});(function(a,b,c){var f=c(a),e=c(b),d=c.fancybox=function(){d.open.apply(this,arguments)},h=false,l=null;c.extend(d,{version:"2.0.2",defaults:{padding:0,margin:20,width:800,height:600,minWidth:200,minHeight:400,maxWidth:9999,maxHeight:9999,autoSize:true,fitToView:true,aspectRatio:false,topRatio:0.5,fixed:!c.browser.msie||c.browser.version>6,scrolling:"auto",wrapCSS:"fancybox-default",arrows:true,closeBtn:true,closeClick:false,nextClick:false,mouseWheel:true,autoPlay:false,playSpeed:3E3,modal:false,
loop:true,ajax:{},keys:{next:[13,32,34,39,40],prev:[8,33,37,38],close:[27]},index:0,type:null,href:null,content:null,title:null,tpl:{wrap:'<div class="fancybox-wrap"><div class="fancybox-outer"><div class="fancybox-inner"></div></div></div>',image:'<img class="fancybox-image" src="{href}" alt="" />',iframe:'<iframe class="fancybox-iframe" name="fancybox-frame{rnd}" frameborder="0" hspace="0" '+(c.browser.msie?'allowtransparency="true""':"")+' scrolling="{scrolling}" src="{href}"></iframe>',swf:'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"><param name="wmode" value="transparent" /><param name="allowfullscreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="movie" value="{href}" /><embed src="{href}" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="100%" height="100%" wmode="transparent"></embed></object>',
error:'<p class="fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',closeBtn:'<div title="Close" class="fancybox-item fancybox-close"></div>',next:'<a title="Next" class="fancybox-item fancybox-next"><span></span></a>',prev:'<a title="Previous" class="fancybox-item fancybox-prev"><span></span></a>'},openEffect:"elastic",openSpeed:500,openEasing:"easeOutBack",openOpacity:true,openMethod:"zoomIn",closeEffect:"elastic",closeSpeed:500,closeEasing:"easeInBack",closeOpacity:true,
closeMethod:"zoomOut",nextEffect:"none",nextSpeed:300,nextEasing:"swing",nextMethod:"changeIn",prevEffect:"none",prevSpeed:300,prevEasing:"swing",prevMethod:"changeOut",helpers:{overlay:{speedIn:0,speedOut:0,opacity:0.85,css:{cursor:"pointer","background-color":"rgba(0, 0, 0, 0.85)"},closeClick:true},title:{type:"over"}},onCancel:c.noop,beforeLoad:c.noop,afterLoad:c.noop,beforeShow:c.noop,afterShow:c.noop,beforeClose:c.noop,afterClose:c.noop},group:{},opts:{},coming:null,current:null,isOpen:false,
isOpened:false,wrap:null,outer:null,inner:null,player:{timer:null,isActive:false},ajaxLoad:null,imgPreload:null,transitions:{},helpers:{},open:function(a,b){c.isArray(a)||(a=[a]);if(a.length)d.close(true),d.opts=c.extend(true,{},d.defaults,b),d.group=a,d._start(d.opts.index||0)},cancel:function(){if(!(d.coming&&false===d.trigger("onCancel"))&&(d.coming=null,d.hideLoading(),d.ajaxLoad&&d.ajaxLoad.abort(),d.ajaxLoad=null,d.imgPreload))d.imgPreload.onload=d.imgPreload.onabort=d.imgPreload.onerror=null},
close:function(a){d.cancel();if(d.current&&false!==d.trigger("beforeClose"))d.unbindEvents(),!d.isOpen||a&&a[0]===true?(c(".fancybox-wrap").stop().trigger("onReset").remove(),d._afterZoomOut()):(d.isOpen=d.isOpened=false,c(".fancybox-item").remove(),d.wrap.stop(true).removeClass("fancybox-opened"),d.inner.css("overflow","hidden"),d.transitions[d.current.closeMethod]())},play:function(a){var b=function(){clearTimeout(d.player.timer)},e=function(){b();if(d.current&&d.player.isActive)d.player.timer=
setTimeout(d.next,d.current.playSpeed)},f=function(){b();c("body").unbind(".player");d.player.isActive=false;d.trigger("onPlayEnd")};if(d.player.isActive||a&&a[0]===false)f();else if(d.current&&(d.current.loop||d.current.index<d.group.length-1))d.player.isActive=true,e(),c("body").bind({"onCancel.player afterShow.player onUpdate.player":e,"beforeClose.player":f,"beforeLoad.player":b}),d.trigger("onPlayStart")},next:function(){d.current&&d.jumpto(d.current.index+1)},prev:function(){d.current&&d.jumpto(d.current.index-
1)},jumpto:function(a){d.current&&(a=parseInt(a,10),d.group.length>1&&d.current.loop&&(a>=d.group.length?a=0:a<0&&(a=d.group.length-1)),typeof d.group[a]!=="undefined"&&(d.cancel(),d._start(a)))},reposition:function(a){d.isOpen&&d.wrap.css(d._getPosition(a))},update:function(){d.isOpen&&(h||(l=setInterval(function(){if(h&&(h=false,clearTimeout(l),d.current)){if(d.current.autoSize)d.inner.height("auto"),d.current.height=d.inner.height();d._setDimension();d.current.canGrow&&d.inner.height("auto");d.reposition();
d.trigger("onUpdate")}},100)),h=true)},toggle:function(){if(d.isOpen)d.current.fitToView=!d.current.fitToView,d.update()},hideLoading:function(){c("#fancybox-loading").remove()},showLoading:function(){d.hideLoading();c('<div id="fancybox-loading"></div>').click(d.cancel).appendTo("body")},getViewport:function(){return{x:f.scrollLeft(),y:f.scrollTop(),w:f.width(),h:f.height()}},unbindEvents:function(){e.unbind(".fb");f.unbind(".fb")},bindEvents:function(){var a=d.current,b=a.keys;a&&(f.bind("resize.fb, orientationchange.fb",
d.update),b&&e.bind("keydown.fb",function(a){c.inArray(a.target.tagName.toLowerCase(),["input","textarea","select","button"])>-1||(c.inArray(a.keyCode,b.close)>-1?(d.close(),a.preventDefault()):c.inArray(a.keyCode,b.next)>-1?(d.next(),a.preventDefault()):c.inArray(a.keyCode,b.prev)>-1&&(d.prev(),a.preventDefault()))}),c.fn.mousewheel&&a.mouseWheel&&d.group.length>1&&d.wrap.bind("mousewheel.fb",function(a,b){if(c(a.target).get(0).clientHeight===0||c(a.target).get(0).scrollHeight===c(a.target).get(0).clientHeight)a.preventDefault(),
d[b>0?"prev":"next"]()}))},trigger:function(a){var b,e=c.inArray(a,["onCancel","beforeLoad","afterLoad"])>-1?"coming":"current";if(d[e]){c.isFunction(d[e][a])&&(b=d[e][a].apply(d[e],Array.prototype.slice.call(arguments,1)));if(b===false)return false;d[e].helpers&&c.each(d[e].helpers,function(b,e){if(e&&typeof d.helpers[b]!=="undefined"&&c.isFunction(d.helpers[b][a]))d.helpers[b][a](e)});c.event.trigger(a+".fb")}},isImage:function(a){return a&&a.match(/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i)},isSWF:function(a){return a&&
a.match(/\.(swf)(.*)?$/i)},_start:function(a){var b=d.group[a]||null,e,f,m,k=c.extend(true,{},d.opts,c.isPlainObject(b)?b:{},{index:a,element:b});if(typeof k.margin==="number")k.margin=[k.margin,k.margin,k.margin,k.margin];k.modal&&c.extend(true,k,{closeBtn:false,closeClick:false,nextClick:false,arrows:false,mouseWheel:false,keys:null,helpers:{overlay:{css:{cursor:"auto"},closeClick:false}}});d.coming=k;if(false===d.trigger("beforeLoad"))d.coming=null;else{if(typeof b==="object"&&(b.nodeType||b instanceof
c))e=true,k.href=c(b).attr("href")||k.href,k.title=c(b).attr("title")||k.title,c.metadata&&c.extend(k,c(b).metadata());f=k.type;a=k.href;if(!f)e&&(m=c(b).data("fancybox-type"),!m&&b.className&&(m=(m=b.className.match(/fancybox\.(\w+)/))?m[1]:false)),m?f=m:a&&(d.isImage(a)?f="image":d.isSWF(a)?f="swf":a.match(/^#/)&&(f="inline")),f||(f=e?"inline":"html"),k.type=f;if(f==="inline"||f==="html"){if(!k.content)k.content=f==="inline"&&a?c(a):b;k.content.length||(f=null)}else k.href=a||b,k.href||(f=null);
k.group=d.group;f==="image"?d._loadImage():f==="ajax"?d._loadAjax():f?d._afterLoad():d._error()}},_error:function(){d.coming.type="html";d.coming.minHeight=0;d.coming.autoSize=true;d.coming.content=d.coming.tpl.error;d._afterLoad()},_loadImage:function(){d.imgPreload=new Image;d.imgPreload.onload=function(){this.onload=this.onerror=null;d.coming.width=this.width;d.coming.height=this.height;d._afterLoad()};d.imgPreload.onerror=function(){this.onload=this.onerror=null;d._error()};d.imgPreload.src=d.coming.href;
d.imgPreload.complete||d.showLoading()},_loadAjax:function(){d.showLoading();d.ajaxLoad=c.ajax(c.extend({},d.coming.ajax,{url:d.coming.href,error:function(a,b,c){b!=="abort"?(d.coming.content=c,d._error()):d.hideLoading()},success:function(a,b){if(b==="success")d.coming.content=a,d._afterLoad()}}))},_afterLoad:function(){d.hideLoading();if(!d.coming||false===d.trigger("afterLoad",d.current))d.coming=false;else if(d.isOpened?(c(".fancybox-item").remove(),d.wrap.stop(true).removeClass("fancybox-opened"),
d.transitions[d.current.prevMethod]()):c(".fancybox-wrap").stop().trigger("onReset").remove(),d.isOpen=false,d.current=d.coming,d.coming=false,d.wrap=c(d.current.tpl.wrap).addClass(d.current.wrapCSS).hide().appendTo("body"),d.outer=c(".fancybox-outer",d.wrap).css("padding",d.current.padding+"px"),d.inner=c(".fancybox-inner",d.wrap),d._setContent(),d.unbindEvents(),d.bindEvents(),d.trigger("beforeShow"),d._setDimension(),d.isOpened)d.transitions[d.current.nextMethod]();else d.transitions[d.current.openMethod]()},
_setContent:function(){var a,b,e=d.current,f=e.type;switch(f){case "inline":case "ajax":case "html":f==="inline"?(a=e.content.show().detach(),a.parent().hasClass("fancybox-inner")&&a.parents(".fancybox-wrap").trigger("onReset").remove(),c(d.wrap).bind("onReset",function(){a.appendTo("body").hide()})):a=e.content;if(e.autoSize)b=c('<div class="fancybox-tmp"></div>').appendTo(c("body")).append(a),e.width=b.outerWidth(),e.height=b.outerHeight(true),a=b.contents().detach(),b.remove();break;case "image":a=
e.tpl.image.replace("{href}",e.href);e.aspectRatio=true;break;case "swf":a=e.tpl.swf.replace(/\{width\}/g,e.width).replace(/\{height\}/g,e.height).replace(/\{href\}/g,e.href);break;case "iframe":a=e.tpl.iframe.replace("{href}",e.href).replace("{scrolling}",e.scrolling).replace("{rnd}",(new Date).getTime())}if(c.inArray(f,["image","swf","iframe"])>-1)e.autoSize=false,e.scrolling=false;d.inner.append(a)},_setDimension:function(){var a=d.current,b=d.getViewport(),e=a.margin,f=a.padding*2,m=a.width+f,
k=a.height+f,h=a.width/a.height,o=a.maxWidth,l=a.maxHeight,p=a.minWidth,q=a.minHeight;b.w-=e[1]+e[3];b.h-=e[0]+e[2];m.toString().indexOf("%")>-1&&(m=b.w*parseFloat(m)/100);k.toString().indexOf("%")>-1&&(k=b.h*parseFloat(k)/100);a.fitToView&&(o=Math.min(b.w,o),l=Math.min(b.h,l));o=Math.max(p,o)*0.9;l=Math.max(q,l)*0.9;a.aspectRatio?(m>o&&(m=o,k=(m-f)/h+f),k>l&&(k=l,m=(k-f)*h+f),m<p&&(m=p,k=(m-f)/h+f),k<q&&(k=q,m=(k-f)*h+f)):(m=Math.max(p,Math.min(m,o)),k=Math.max(q,Math.min(k,l)));m=Math.round(m);
k=Math.round(k);c(d.wrap.add(d.outer).add(d.inner)).width("auto").height("auto");d.inner.width(m-f).height(k-f);d.wrap.width(m);e=d.wrap.height();if(m>o||e>l)for(;(m>o||e>l)&&m>p&&e>q;)k-=10,a.aspectRatio?(m=Math.round((k-f)*h+f),m<p&&(m=p,k=(m-f)/h+f)):m-=10,d.inner.width(m-f).height(k-f),d.wrap.width(m),e=d.wrap.height();a.dim={width:m,height:e};a.canGrow=a.autoSize&&k>q&&k<l;a.canShrink=false;a.canExpand=false;if(m-f<a.width||k-f<a.height)a.canExpand=true;else if((m>b.w||e>b.h)&&m>p&&k>q)a.canShrink=
true},_getPosition:function(a){var b=d.getViewport(),c=d.current.margin,e=d.wrap.width()+c[1]+c[3],f=d.wrap.height()+c[0]+c[2],k={position:"absolute",top:c[0]+b.y,left:c[3]+b.x};if(d.current.fixed&&(!a||a[0]===false)&&f<=b.h&&e<=b.w)k={position:"fixed",top:c[0],left:c[3]};k.top=Math.ceil(Math.max(k.top,k.top+(b.h-f)*d.current.topRatio))+"px";k.left=Math.ceil(Math.max(k.left,k.left+(b.w-e)*0.5))+"px";return k},_afterZoomIn:function(){var a=d.current;d.isOpen=d.isOpened=true;d.wrap.addClass("fancybox-opened").css("overflow",
"visible");d.update();d.inner.css("overflow",a.scrolling==="auto"?"auto":a.scrolling==="yes"?"scroll":"hidden");if(a.closeClick||a.nextClick)d.inner.bind("click.fb",a.nextClick?d.next:d.close);a.closeBtn&&c(d.current.tpl.closeBtn).appendTo(d.wrap).bind("click.fb",d.close);a.arrows&&d.group.length>1&&((a.loop||a.index>0)&&c(a.tpl.prev).appendTo(d.wrap).bind("click.fb",d.prev),(a.loop||a.index<d.group.length-1)&&c(a.tpl.next).appendTo(d.wrap).bind("click.fb",d.next));d.trigger("afterShow");if(d.opts.autoPlay&&
!d.player.isActive)d.opts.autoPlay=false,d.play()},_afterZoomOut:function(){d.trigger("afterClose");d.wrap.trigger("onReset").remove();c.extend(d,{group:{},opts:{},current:null,isOpened:false,isOpen:false,wrap:null,outer:null,inner:null})}});d.transitions={getOrigPosition:function(){var a=d.current.element,b={},e=50,f=50,m;a&&a.nodeName&&c(a).is(":visible")?(m=c(a).find("img:first"),m.length?(b=m.offset(),e=m.outerWidth(),f=m.outerHeight()):b=c(a).offset()):(a=d.getViewport(),b.top=a.y+(a.h-f)*0.5,
b.left=a.x+(a.w-e)*0.5);return b={top:Math.ceil(b.top)+"px",left:Math.ceil(b.left)+"px",width:Math.ceil(e)+"px",height:Math.ceil(f)+"px"}},step:function(a,b){var c,e,f;if(b.prop==="width"||b.prop==="height")e=f=Math.ceil(a-d.current.padding*2),b.prop==="height"&&(c=(a-b.start)/(b.end-b.start),b.start>b.end&&(c=1-c),e-=d.innerSpace*c,f-=d.outerSpace*c),d.inner[b.prop](e),d.outer[b.prop](f)},zoomIn:function(){var a,b;a=d.current.dim;b=a.height-d.current.padding*2;d.innerSpace=b-d.inner.height();d.outerSpace=
b-d.outer.height();if(d.current.openEffect==="elastic"){b=c.extend({},a,d._getPosition(true));delete b.position;a=this.getOrigPosition();if(d.current.openOpacity)a.opacity=0,b.opacity=1;d.wrap.css(a).show().animate(b,{duration:d.current.openSpeed,easing:d.current.openEasing,step:this.step,complete:d._afterZoomIn})}else d.wrap.css(c.extend({},d.current.dim,d._getPosition())),d.current.openEffect==="fade"?d.wrap.fadeIn(d.current.openSpeed,d._afterZoomIn):(d.wrap.show(),d._afterZoomIn())},zoomOut:function(){var a;
a=d.wrap.height()-d.current.padding*2;if(d.current.closeEffect==="elastic"){d.wrap.css("position")==="fixed"&&d.wrap.css(d._getPosition(true));d.innerSpace=a-d.inner.height();d.outerSpace=a-d.outer.height();a=this.getOrigPosition();if(d.current.closeOpacity)a.opacity=0;d.wrap.animate(a,{duration:d.current.closeSpeed,easing:d.current.closeEasing,step:this.step,complete:d._afterZoomOut})}else d.wrap.fadeOut(d.current.closeEffect==="fade"?d.current.Speed:0,d._afterZoomOut)},changeIn:function(){var a;
d.current.nextEffect==="elastic"?(a=d._getPosition(true),a.opacity=0,a.top=parseInt(a.top,10)-200+"px",d.wrap.css(a).show().animate({opacity:1,top:"+=200px"},{duration:d.current.nextSpeed,complete:d._afterZoomIn})):(d.wrap.css(d._getPosition()),d.current.nextEffect==="fade"?d.wrap.hide().fadeIn(d.current.nextSpeed,d._afterZoomIn):(d.wrap.show(),d._afterZoomIn()))},changeOut:function(){function a(){c(this).trigger("onReset").remove()}d.wrap.removeClass("fancybox-opened");d.current.prevEffect==="elastic"?
d.wrap.animate({opacity:0,top:"+=200px"},{duration:d.current.prevSpeed,complete:a}):d.wrap.fadeOut(d.current.prevEffect==="fade"?d.current.prevSpeed:0,a)}};d.helpers.overlay={overlay:null,update:function(){var a,d;this.overlay.width(0).height(0);c.browser.msie?(a=Math.max(b.documentElement.scrollWidth,b.body.scrollWidth),d=Math.max(b.documentElement.offsetWidth,b.body.offsetWidth),a=a<d?f.width():a):a=e.width();this.overlay.width(a).height(e.height())},beforeShow:function(a){if(!this.overlay)this.overlay=
c('<div id="fancybox-overlay"></div>').css(a.css||{background:"black"}).appendTo("body"),this.update(),a.closeClick&&this.overlay.bind("click.fb",d.close),f.bind("resize.fb",c.proxy(this.update,this)),this.overlay.fadeTo(a.speedIn||"fast",a.opacity||1)},onUpdate:function(){this.update()},afterClose:function(a){this.overlay&&this.overlay.fadeOut(a.speedOut||"fast",function(){c(this).remove()});this.overlay=null}};d.helpers.title={beforeShow:function(a){var b;if(b=d.current.title)b=c('<div class="fancybox-title fancybox-title-'+
a.type+'-wrap">'+b+"</div>").appendTo("body"),a.type==="float"&&(b.wrapInner('<span class="child"></span>'),d.current.margin[2]+=Math.abs(parseInt(b.css("margin-bottom"),10))),b.appendTo(a.type==="over"?d.inner:a.type==="outside"?d.wrap:d.outer)}};c.fn.fancybox=function(a){function b(a){var e=[],g=false,h=c(this).data("fancybox-group");a.preventDefault();if(typeof h!=="undefined")g=h?"data-fancybox-group":false;else if(this.rel&&this.rel!==""&&this.rel!=="nofollow")h=this.rel,g="rel";g&&(e=n.length?
c(n).filter("["+g+'="'+h+'"]'):c("["+g+'="'+h+'"]'));e.length?(f.index=e.index(this),d.open(e.get(),f)):d.open(this,f);return false}var f=a||{},n=this.selector||"";n?e.undelegate(n,"click.fb-start").delegate(n,"click.fb-start",b):c(this).unbind("click.fb-start").bind("click.fb-start",b);return this}})(window,document,jQuery);hs.bubblePopup=function(){return new function(){var a=[],b=null,c,f,e={},d=this,h=function(a,b,c){f={top:a,left:b,orientation:c||"h"}},l=function(a){a=$(a);return!a.length?false:c&&c.length&&c.attr("href")==a.attr("href")?true:false},g=function(a){var b=false;if(a.type=="click")if(a=$(a.target),a.attr("id")=="bubblePopPane"||a.closest("#bubblePopPane").length||a.is("._bubblePopup")||a.closest("._bubblePopup").length)return;else b=true;else a.type=="scroll"?b=true:a.type=="blur"&&(b=true);b&&d.close()},
j=function(){$("body").unbind("click",g);$("#streamsScroll div._body").unbind("scroll",g);$("#streamsContainer").unbind("scroll",g);$("#analyticsContent").unbind("scroll",g)},r=function(){setTimeout(function(){var a=$("#bubblePopPane");if(a.length){var b=Math.ceil(a.position().left),c=a.outerWidth(true),d=$(window).width();b+c+10>d&&a.css({left:"auto",right:0})}},1)};this.open=function(b,d,f,u,o){$(b).is("._bubblePopup")||$(b).addClass("_bubblePopup");l(b)?a.length&&a.find("._loading").length||this.close():
(e=o=o||{},this.clearOpenDelay(),c=b?$(b):null,h(d,f),a=$("#bubblePopPane"),a.length||(a=$('<div id="bubblePopPane"></div>').appendTo("body")),a.html('<div class="_content"><img src="'+hs.util.rootifyImage("/module-loader-small.gif")+'" alt="" class="spinner _loading" /></div><span class="icon-static-19 tip"></span>'),this.detach=o.detach,o.isVertical?this.setPositionVertical():this.setPosition(),o.autoclose!=false&&(j(),$("body").bind("click",g),$("#streamsScroll div._body").bind("scroll",g),$("#streamsContainer").bind("scroll",
g),$("#analyticsContent").bind("scroll",g)),$.isFunction(u)&&u(this))};this.openWithDelay=function(a,c,e,f,g){g=g||1E3;l(a)||(b=setTimeout(function(){d.open(a,c,e,f)},g))};this.openVertical=function(a,b,c,d,e){e=$.extend(e,{isVertical:true});this.open(a,b,c,d,e)};this.clearOpenDelay=function(){clearTimeout(b)};this.close=function(){if(a.length)a[this.detach===true?"detach":"remove"]();c&&c.length&&c.trigger("close.bubblepopup")&&c.unbind("close.bubblepopup");f=c=null;j();clearTimeout(b)};this.setPosition=
function(b,d,g){if(a.length){var j=$("#footer").length?$("#footer").position().top:$(window).height(),l,s="right",p=a.outerWidth(),q=a.outerHeight();f&&f.top&&f.left?(d=f.top,g=f.left,l=c?c.outerWidth():13,b=c?c.outerHeight():13):(b=b?$(b):c)&&b.length?(g=b.offset(),d=g.top,g=g.left,l=b.outerWidth(),b=b.outerHeight()):(d=d||0,g=g||0,b=l=13);h(d,g,"h");d-=q/2-b/2;g+p>$(window).width()-l||e.pos=="left"?(g=g-14-p,s="left"):g+=l;d+q>j&&(d-=d+q-j);a.css("top",d+"px").css("left",g+"px").removeClass("right left up down").addClass(s);
r()}};this.setPositionVertical=function(b,d,g){if(a.length){var j=$("#footer").length?$("#footer").position().top:$(window).height(),l,s="down",p=a.outerWidth(),q=a.outerHeight();f&&f.top&&f.left?(d=f.top,g=f.left,l=c?c.outerHeight():13,b=c?c.outerWidth():13):(b=b?$(b):c)&&b.length?(g=b.offset(),d=g.top,g=g.left,l=b.outerHeight(),b=b.outerWidth()):(d=d||0,g=g||0,b=l=13);h(d,g,"v");g+=b/2-p/2;d+l+q>j||e.pos=="up"?(d=d-14-q,d<0&&(d=0),s="up"):d+=l;g+p>$(window).width()&&(j=g+p-$(window).width(),g-=
j,this.getTip().css("marginLeft",-12+j));a.css("top",d+"px").css("left",g+"px").removeClass("right left up down").addClass(s);r()}};this.getTip=function(){return a.find(".tip")};this.setContent=function(b){var c=this,d=function(){f&&f.orientation=="v"?c.setPositionVertical():c.setPosition()};a.length&&(a.find("._content").empty().append(b).find("img").bind("load",function(){_.defer(d);$(this).unbind("load")}),_.defer(d))};this.setPositionForCurrent=function(){f&&f.orientation=="v"?this.setPositionVertical():
this.setPosition()};this.isOpen=function(){return a.length>0}}}();hs.bubblePopup.wizard={queue:[]};
hs.bubblePopup.wizard.init=function(a){hs.bubblePopup.wizard.queue=[];_.each(a,function(a){hs.bubblePopup.wizard.queue.push(function(){var c=$(a.target),f=f=function(){_.isFunction(a.close)&&a.close();_.defer(hs.bubblePopup.wizard.show)};if(c.length)hs.bubblePopup[a.position=="vertical"?"openVertical":"open"](c,null,null,function(){(typeof a.autoclose==="undefined"||a.autoclose)&&$.isFunction(f)&&c.unbind("close.bubblepopup").bind("close.bubblepopup",f);if(typeof a.content==="string")a.content='<div class="wizard-step">'+
a.content+"</div>";hs.bubblePopup.setContent(a.content);var e=$("#bubblePopPane");_.each(a.events,function(a){e.find(a.selector).bind(a.event,function(){_.isFunction(a.handler)&&a.handler();return false})});_.defer(hs.bubblePopup.setPosition)},{autoclose:a.autoclose});else hs.bubblePopup.wizard.clearQueue()})})};
hs.bubblePopup.wizard.show=function(){if(hs.bubblePopup.wizard.queue.length){var a=hs.bubblePopup.wizard.queue.slice(0,1)[0];hs.bubblePopup.wizard.queue=hs.bubblePopup.wizard.queue.slice(1);_.isFunction(a)&&a()}else hs.bubblePopup.close()};hs.bubblePopup.wizard.clearQueue=function(){hs.bubblePopup.wizard.queue=[]};hs.bubblePopup.wizard.skipToLast=function(){if(hs.bubblePopup.wizard.queue.length)hs.bubblePopup.wizard.queue=[hs.bubblePopup.wizard.queue[hs.bubblePopup.wizard.queue.length-1]],hs.bubblePopup.wizard.show()};
