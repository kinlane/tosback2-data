/*!
 * CleanPrint
 * http://www.formatdynamics.com
 * Copyright Format Dynamics, Inc.  All rights reserved, 
 * CleanPrint and Format Dynamics are registered trademarks
 * US Patent 7386791
 */
var FDCPLoader={tmax:30000,logging:"false"=="true",analytics:"true"=="true",reporting:"true"=="true",productName:"CleanPrint/Save",mediaRoot:null,cpfServlet:null,cpjsServlet:null,helpUrl:null,pubKey:0,buttons:null,category:null,dynamic:false,name:null,logo:null,customCss:null,hint:null,page:"letter",articleId:0,headNode:document.getElementsByTagName("head")[0],articleUrl:window.location.href,isPfLink:false,loadcpjs:function(){var b=document.createElement("link");b.href=this.mediaRoot+"pfviewer/css/viewbox.css";b.type="text/css";b.rel="stylesheet";b.media="screen";this.headNode.appendChild(b);if(this.customCss!=null&&this.customCss.length>0){var a=document.createElement("link");a.href=this.customCss;a.type="text/css";a.rel="stylesheet";a.media="screen";this.headNode.appendChild(a)}this.loadHelper()},loadHelper:function(){var a=FDCPLoader.cpjsServlet+"?bn="+FDCPLoader.browserDetect.browser+"&bv="+FDCPLoader.browserDetect.version+"&fs="+(FDCPLoader.hasFlash()?"true":"false");var b=document.createElement("script");b.id="cpf_cpjs";b.src=a;b.type="text/javascript";this.headNode.appendChild(b)},getFlashVersion:function(b){var a=b.match(/[\d]+/g);a.length=1;return a.join(".")},hasFlash:function(){var l=navigator;var k=l.plugins;var b=(l.appVersion.indexOf("MSIE")!=-1)?true:false;var g=(l.appVersion.toLowerCase().indexOf("win")!=-1)?true:false;var a=(l.userAgent.indexOf("Opera")!=-1)?true:false;var f;if(l.plugins!=null&&k.length>0){if(k["Shockwave Flash 2.0"]||k["Shockwave Flash"]){var j=k["Shockwave Flash 2.0"]?" 2.0":"";var c=k["Shockwave Flash"+j].description.split(" ");var d=c[2].split(".");f=d[0]>5?d[0]:-1}}else{if(b&&g&&!a){var h;var i;try{h=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");f=h.GetVariable("$version")}catch(i){}if(!f){try{h=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");f="6"}catch(i){}}}}if(f){f=this.getFlashVersion(f)}return f&&f>0},browserDetect:{init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(d){for(var a=0;a<d.length;a++){var b=d[a].string;var c=d[a].prop;this.versionSearchString=d[a].versionSearch||d[a].identity;if(b){if(b.indexOf(d[a].subString)!=-1){return d[a].identity}}else{if(c){return d[a].identity}}}},searchVersion:function(b){var a=b.indexOf(this.versionSearchString);if(a==-1){return}return parseFloat(b.substring(a+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]},logMessage:function(a,k,c){try{if(this.logging){var f="action=logging&";if(typeof k!="undefined"&&k!=null){f+="msg="+encodeURIComponent(k)+"&"}f+="level="+a+"&";f+="url="+encodeURIComponent(FDCPLoader.articleUrl)+"&";f+="key="+encodeURIComponent(FDCPLoader.pubKey)+"&";var h=(new Date).getTime();var j=String(h++);f+="cacheKill="+j;if(typeof c!="undefined"&&c!=null){for(var b in c){f+="&"+encodeURIComponent(b)+"="+encodeURIComponent(c[b])}}var i=this.cpfServlet+"?"+f;var d=new Image();d.src=i}}catch(g){}},reportEvent:function(a,g,j){try{if(this.reporting){var c="action=reporting";c+="&event="+a;c+="&type="+g;c+="&key="+encodeURIComponent(FDCPLoader.pubKey);c+="&success="+j;c+="&url="+encodeURIComponent(FDCPLoader.articleUrl);var f=(new Date).getTime();var i=String(f++);c+="&cacheKill="+i;var h=this.cpfServlet+"?"+c;var b=new Image();b.src=h}}catch(d){}}};var regx=new RegExp("url=[^&]+");if(regx.test(window.location.search)){var str=""+regx.exec(window.location.search);FDCPLoader.articleUrl=decodeURIComponent(str.substring(4))}FDCPLoader.browserDetect.init();function CleanPrintPrintHtml(b,a){return FDCPUrl(b,true,"text/html","printViewer",null,a)}function CleanPrintGeneratePdf(b,a){return FDCPUrl(b,true,"application/pdf","pdfViewer",null,a)}function CleanPrintSendEmail(b,a){return FDCPUrl(b,true,"email/html","emailViewer",null,a)}function FDCPUrl(g,b,c,f,i,d){try{if(typeof g=="undefined"||g==null||g=="null"){g=window.location.href}else{if(g.charAt(0)=="/"){g=window.location.protocol+"//"+window.location.host+g}FDCPLoader.isPfLink=true;FDCPLoader.dynamic=false}FDCPLoader.articleUrl=g;b=typeof b=="undefined"?true:b;c=typeof c=="undefined"?"text/html":c;f=typeof f=="undefined"?"printViewer":f;i=typeof i=="undefined"?"":i;if(typeof d!="undefined"&&d!=null){FDCPLoader.articleId=d}if(typeof cpbridge!="undefined"&&cpbridge!=null){cpbridge.cleanPrint(g,c,f,FDCPLoader.tmax,null)}}catch(h){var j="";for(var a in h){j+=a+"["+h[a]+"], "}j+="["+h.toString()+"]";FDCPLoader.logMessage("INFO","FDCPUrl: "+j);alert(h.message)}return false}function onReady(d){var f=false;function c(){if(f){return}f=true;d()}if(document.getElementById("FDCPFBookmarklet")!=null){c()}if(document.addEventListener){document.addEventListener("DOMContentLoaded",c,false)}else{if(document.attachEvent){var a=false;try{a=window.frameElement!=null}catch(g){}if(document.documentElement.doScroll&&!a){function h(){if(f){return}try{document.documentElement.doScroll("left");c()}catch(i){setTimeout(h,10)}}h()}}}if(window.addEventListener){window.addEventListener("load",c,false)}else{if(window.attachEvent){window.attachEvent("onload",c)}else{var b=window.onload;window.onload=function(){b&&b();c()}}}setTimeout(c,8000)};FDCPLoader.pubKey = 'slate';
FDCPLoader.customCss = 'http://cache-02.cleanprint.net/media/campaigns/HP-Supplies_Q4/style.css';
FDCPLoader.tmax = 30000;
FDCPLoader.mediaRoot   = 'http://cache-02.cleanprint.net/media/';
FDCPLoader.cpfServlet  = 'http://cpf.cleanprint.net:80/cpf/cpf';
FDCPLoader.cpjsServlet = 'http://cache-02.cleanprint.net/cpf/cpjs';
FDCPLoader.helpUrl     = 'http://cache-02.cleanprint.net/cpf/help';
onReady(function(){ FDCPLoader.loadcpjs(); });