if(typeof window.console==="undefined"){console={};var i,max,funcs=["log","debug","info","warn","error","assert","dir","dirxml","trace","group","groupCollapsed","groupEnd","time","timeEnd","profile","profileEnd","count"];for(i=0,max=funcs.length;i<max;i++){console[funcs[i]]=function(){};}}/*
 * jQuery JavaScript Library v1.4.2
 * http://jquery.com/
 *
 * Copyright 2010, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 * Copyright 2010, The Dojo Foundation
 * Released under the MIT, BSD, and GPL Licenses.
 *
 * Date: Sat Feb 13 22:33:48 2010 -0500
 */
(function(A,w){function ma(){if(!c.isReady){try{s.documentElement.doScroll("left");}catch(a){setTimeout(ma,1);return;}c.ready();}}function Qa(a,b){b.src?c.ajax({url:b.src,async:false,dataType:"script"}):c.globalEval(b.text||b.textContent||b.innerHTML||"");b.parentNode&&b.parentNode.removeChild(b);}function X(a,b,d,f,e,j){var i=a.length;if(typeof b==="object"){for(var o in b){X(a,o,b[o],f,e,d);}return a;}if(d!==w){f=!j&&f&&c.isFunction(d);for(o=0;o<i;o++){e(a[o],b,f?d.call(a[o],o,e(a[o],b)):d,j);}return a;}return i?e(a[0],b):w;}function J(){return(new Date).getTime();}function Y(){return false;}function Z(){return true;}function na(a,b,d){d[0].type=a;return c.event.handle.apply(b,d);}function oa(a){var b,d=[],f=[],e=arguments,j,i,o,k,n,r;i=c.data(this,"events");if(!(a.liveFired===this||!i||!i.live||a.button&&a.type==="click")){a.liveFired=this;var u=i.live.slice(0);for(k=0;k<u.length;k++){i=u[k];i.origType.replace(O,"")===a.type?f.push(i.selector):u.splice(k--,1);}j=c(a.target).closest(f,a.currentTarget);n=0;for(r=j.length;n<r;n++){for(k=0;k<u.length;k++){i=u[k];if(j[n].selector===i.selector){o=j[n].elem;f=null;if(i.preType==="mouseenter"||i.preType==="mouseleave"){f=c(a.relatedTarget).closest(i.selector)[0];}if(!f||f!==o){d.push({elem:o,handleObj:i});}}}}n=0;for(r=d.length;n<r;n++){j=d[n];a.currentTarget=j.elem;a.data=j.handleObj.data;a.handleObj=j.handleObj;if(j.handleObj.origHandler.apply(j.elem,e)===false){b=false;break;}}return b;}}function pa(a,b){return"live."+(a&&a!=="*"?a+".":"")+b.replace(/\./g,"`").replace(/ /g,"&");}function qa(a){return !a||!a.parentNode||a.parentNode.nodeType===11;}function ra(a,b){var d=0;b.each(function(){if(this.nodeName===(a[d]&&a[d].nodeName)){var f=c.data(a[d++]),e=c.data(this,f);if(f=f&&f.events){delete e.handle;e.events={};for(var j in f){for(var i in f[j]){c.event.add(this,j,f[j][i],f[j][i].data);}}}}});}function sa(a,b,d){var f,e,j;b=b&&b[0]?b[0].ownerDocument||b[0]:s;if(a.length===1&&typeof a[0]==="string"&&a[0].length<512&&b===s&&!ta.test(a[0])&&(c.support.checkClone||!ua.test(a[0]))){e=true;if(j=c.fragments[a[0]]){if(j!==1){f=j;}}}if(!f){f=b.createDocumentFragment();c.clean(a,b,f,d);}if(e){c.fragments[a[0]]=j?f:1;}return{fragment:f,cacheable:e};}function K(a,b){var d={};c.each(va.concat.apply([],va.slice(0,b)),function(){d[this]=a;});return d;}function wa(a){return"scrollTo" in a&&a.document?a:a.nodeType===9?a.defaultView||a.parentWindow:false;}var c=function(a,b){return new c.fn.init(a,b);},Ra=A.jQuery,Sa=A.$,s=A.document,T,Ta=/^[^<]*(<[\w\W]+>)[^>]*$|^#([\w-]+)$/,Ua=/^.[^:#\[\.,]*$/,Va=/\S/,Wa=/^(\s|\u00A0)+|(\s|\u00A0)+$/g,Xa=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,P=navigator.userAgent,xa=false,Q=[],L,$=Object.prototype.toString,aa=Object.prototype.hasOwnProperty,ba=Array.prototype.push,R=Array.prototype.slice,ya=Array.prototype.indexOf;c.fn=c.prototype={init:function(a,b){var d,f;if(!a){return this;}if(a.nodeType){this.context=this[0]=a;this.length=1;return this;}if(a==="body"&&!b){this.context=s;this[0]=s.body;this.selector="body";this.length=1;return this;}if(typeof a==="string"){if((d=Ta.exec(a))&&(d[1]||!b)){if(d[1]){f=b?b.ownerDocument||b:s;if(a=Xa.exec(a)){if(c.isPlainObject(b)){a=[s.createElement(a[1])];c.fn.attr.call(a,b,true);}else{a=[f.createElement(a[1])];}}else{a=sa([d[1]],[f]);a=(a.cacheable?a.fragment.cloneNode(true):a.fragment).childNodes;}return c.merge(this,a);}else{if(b=s.getElementById(d[2])){if(b.id!==d[2]){return T.find(a);}this.length=1;this[0]=b;}this.context=s;this.selector=a;return this;}}else{if(!b&&/^\w+$/.test(a)){this.selector=a;this.context=s;a=s.getElementsByTagName(a);return c.merge(this,a);}else{return !b||b.jquery?(b||T).find(a):c(b).find(a);}}}else{if(c.isFunction(a)){return T.ready(a);}}if(a.selector!==w){this.selector=a.selector;this.context=a.context;}return c.makeArray(a,this);},selector:"",jquery:"1.4.2",length:0,size:function(){return this.length;},toArray:function(){return R.call(this,0);},get:function(a){return a==null?this.toArray():a<0?this.slice(a)[0]:this[a];},pushStack:function(a,b,d){var f=c();c.isArray(a)?ba.apply(f,a):c.merge(f,a);f.prevObject=this;f.context=this.context;if(b==="find"){f.selector=this.selector+(this.selector?" ":"")+d;}else{if(b){f.selector=this.selector+"."+b+"("+d+")";}}return f;},each:function(a,b){return c.each(this,a,b);},ready:function(a){c.bindReady();if(c.isReady){a.call(s,c);}else{Q&&Q.push(a);}return this;},eq:function(a){return a===-1?this.slice(a):this.slice(a,+a+1);},first:function(){return this.eq(0);},last:function(){return this.eq(-1);},slice:function(){return this.pushStack(R.apply(this,arguments),"slice",R.call(arguments).join(","));},map:function(a){return this.pushStack(c.map(this,function(b,d){return a.call(b,d,b);}));},end:function(){return this.prevObject||c(null);},push:ba,sort:[].sort,splice:[].splice};c.fn.init.prototype=c.fn;c.extend=c.fn.extend=function(){var a=arguments[0]||{},b=1,d=arguments.length,f=false,e,j,i,o;if(typeof a==="boolean"){f=a;a=arguments[1]||{};b=2;}if(typeof a!=="object"&&!c.isFunction(a)){a={};}if(d===b){a=this;--b;}for(;b<d;b++){if((e=arguments[b])!=null){for(j in e){i=a[j];o=e[j];if(a!==o){if(f&&o&&(c.isPlainObject(o)||c.isArray(o))){i=i&&(c.isPlainObject(i)||c.isArray(i))?i:c.isArray(o)?[]:{};a[j]=c.extend(f,i,o);}else{if(o!==w){a[j]=o;}}}}}}return a;};c.extend({noConflict:function(a){A.$=Sa;if(a){A.jQuery=Ra;}return c;},isReady:false,ready:function(){if(!c.isReady){if(!s.body){return setTimeout(c.ready,13);}c.isReady=true;if(Q){for(var a,b=0;a=Q[b++];){a.call(s,c);}Q=null;}c.fn.triggerHandler&&c(s).triggerHandler("ready");}},bindReady:function(){if(!xa){xa=true;if(s.readyState==="complete"){return c.ready();}if(s.addEventListener){s.addEventListener("DOMContentLoaded",L,false);A.addEventListener("load",c.ready,false);}else{if(s.attachEvent){s.attachEvent("onreadystatechange",L);A.attachEvent("onload",c.ready);var a=false;try{a=A.frameElement==null;}catch(b){}s.documentElement.doScroll&&a&&ma();}}}},isFunction:function(a){return $.call(a)==="[object Function]";},isArray:function(a){return $.call(a)==="[object Array]";},isPlainObject:function(a){if(!a||$.call(a)!=="[object Object]"||a.nodeType||a.setInterval){return false;}if(a.constructor&&!aa.call(a,"constructor")&&!aa.call(a.constructor.prototype,"isPrototypeOf")){return false;}var b;for(b in a){}return b===w||aa.call(a,b);},isEmptyObject:function(a){for(var b in a){return false;}return true;},error:function(a){throw a;},parseJSON:function(a){if(typeof a!=="string"||!a){return null;}a=c.trim(a);if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return A.JSON&&A.JSON.parse?A.JSON.parse(a):(new Function("return "+a))();}else{c.error("Invalid JSON: "+a);}},noop:function(){},globalEval:function(a){if(a&&Va.test(a)){var b=s.getElementsByTagName("head")[0]||s.documentElement,d=s.createElement("script");d.type="text/javascript";if(c.support.scriptEval){d.appendChild(s.createTextNode(a));}else{d.text=a;}b.insertBefore(d,b.firstChild);b.removeChild(d);}},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase();},each:function(a,b,d){var f,e=0,j=a.length,i=j===w||c.isFunction(a);if(d){if(i){for(f in a){if(b.apply(a[f],d)===false){break;}}}else{for(;e<j;){if(b.apply(a[e++],d)===false){break;}}}}else{if(i){for(f in a){if(b.call(a[f],f,a[f])===false){break;}}}else{for(d=a[0];e<j&&b.call(d,e,d)!==false;d=a[++e]){}}}return a;},trim:function(a){return(a||"").replace(Wa,"");},makeArray:function(a,b){b=b||[];if(a!=null){a.length==null||typeof a==="string"||c.isFunction(a)||typeof a!=="function"&&a.setInterval?ba.call(b,a):c.merge(b,a);}return b;},inArray:function(a,b){if(b.indexOf){return b.indexOf(a);}for(var d=0,f=b.length;d<f;d++){if(b[d]===a){return d;}}return -1;},merge:function(a,b){var d=a.length,f=0;if(typeof b.length==="number"){for(var e=b.length;f<e;f++){a[d++]=b[f];}}else{for(;b[f]!==w;){a[d++]=b[f++];}}a.length=d;return a;},grep:function(a,b,d){for(var f=[],e=0,j=a.length;e<j;e++){!d!==!b(a[e],e)&&f.push(a[e]);}return f;},map:function(a,b,d){for(var f=[],e,j=0,i=a.length;j<i;j++){e=b(a[j],j,d);if(e!=null){f[f.length]=e;}}return f.concat.apply([],f);},guid:1,proxy:function(a,b,d){if(arguments.length===2){if(typeof b==="string"){d=a;a=d[b];b=w;}else{if(b&&!c.isFunction(b)){d=b;b=w;}}}if(!b&&a){b=function(){return a.apply(d||this,arguments);};}if(a){b.guid=a.guid=a.guid||b.guid||c.guid++;}return b;},uaMatch:function(a){a=a.toLowerCase();a=/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||!/compatible/.test(a)&&/(mozilla)(?:.*? rv:([\w.]+))?/.exec(a)||[];return{browser:a[1]||"",version:a[2]||"0"};},browser:{}});P=c.uaMatch(P);if(P.browser){c.browser[P.browser]=true;c.browser.version=P.version;}if(c.browser.webkit){c.browser.safari=true;}if(ya){c.inArray=function(a,b){return ya.call(b,a);};}T=c(s);if(s.addEventListener){L=function(){s.removeEventListener("DOMContentLoaded",L,false);c.ready();};}else{if(s.attachEvent){L=function(){if(s.readyState==="complete"){s.detachEvent("onreadystatechange",L);c.ready();}};}}(function(){c.support={};var a=s.documentElement,b=s.createElement("script"),d=s.createElement("div"),f="script"+J();d.style.display="none";d.innerHTML="   <link/><table></table><a href='/a' style='color:red;float:left;opacity:.55;'>a</a><input type='checkbox'/>";var e=d.getElementsByTagName("*"),j=d.getElementsByTagName("a")[0];if(!(!e||!e.length||!j)){c.support={leadingWhitespace:d.firstChild.nodeType===3,tbody:!d.getElementsByTagName("tbody").length,htmlSerialize:!!d.getElementsByTagName("link").length,style:/red/.test(j.getAttribute("style")),hrefNormalized:j.getAttribute("href")==="/a",opacity:/^0.55$/.test(j.style.opacity),cssFloat:!!j.style.cssFloat,checkOn:d.getElementsByTagName("input")[0].value==="on",optSelected:s.createElement("select").appendChild(s.createElement("option")).selected,parentNode:d.removeChild(d.appendChild(s.createElement("div"))).parentNode===null,deleteExpando:true,checkClone:false,scriptEval:false,noCloneEvent:true,boxModel:null};
b.type="text/javascript";try{b.appendChild(s.createTextNode("window."+f+"=1;"));}catch(i){}a.insertBefore(b,a.firstChild);if(A[f]){c.support.scriptEval=true;delete A[f];}try{delete b.test;}catch(o){c.support.deleteExpando=false;}a.removeChild(b);if(d.attachEvent&&d.fireEvent){d.attachEvent("onclick",function k(){c.support.noCloneEvent=false;d.detachEvent("onclick",k);});d.cloneNode(true).fireEvent("onclick");}d=s.createElement("div");d.innerHTML="<input type='radio' name='radiotest' checked='checked'/>";a=s.createDocumentFragment();a.appendChild(d.firstChild);c.support.checkClone=a.cloneNode(true).cloneNode(true).lastChild.checked;c(function(){var k=s.createElement("div");k.style.width=k.style.paddingLeft="1px";s.body.appendChild(k);c.boxModel=c.support.boxModel=k.offsetWidth===2;s.body.removeChild(k).style.display="none";});a=function(k){var n=s.createElement("div");k="on"+k;var r=k in n;if(!r){n.setAttribute(k,"return;");r=typeof n[k]==="function";}return r;};c.support.submitBubbles=a("submit");c.support.changeBubbles=a("change");a=b=d=e=j=null;}})();c.props={"for":"htmlFor","class":"className",readonly:"readOnly",maxlength:"maxLength",cellspacing:"cellSpacing",rowspan:"rowSpan",colspan:"colSpan",tabindex:"tabIndex",usemap:"useMap",frameborder:"frameBorder"};var G="jQuery"+J(),Ya=0,za={};c.extend({cache:{},expando:G,noData:{embed:true,object:true,applet:true},data:function(a,b,d){if(!(a.nodeName&&c.noData[a.nodeName.toLowerCase()])){a=a==A?za:a;var f=a[G],e=c.cache;if(!f&&typeof b==="string"&&d===w){return null;}f||(f=++Ya);if(typeof b==="object"){a[G]=f;e[f]=c.extend(true,{},b);}else{if(!e[f]){a[G]=f;e[f]={};}}a=e[f];if(d!==w){a[b]=d;}return typeof b==="string"?a[b]:a;}},removeData:function(a,b){if(!(a.nodeName&&c.noData[a.nodeName.toLowerCase()])){a=a==A?za:a;var d=a[G],f=c.cache,e=f[d];if(b){if(e){delete e[b];c.isEmptyObject(e)&&c.removeData(a);}}else{if(c.support.deleteExpando){delete a[c.expando];}else{a.removeAttribute&&a.removeAttribute(c.expando);}delete f[d];}}}});c.fn.extend({data:function(a,b){if(typeof a==="undefined"&&this.length){return c.data(this[0]);}else{if(typeof a==="object"){return this.each(function(){c.data(this,a);});}}var d=a.split(".");d[1]=d[1]?"."+d[1]:"";if(b===w){var f=this.triggerHandler("getData"+d[1]+"!",[d[0]]);if(f===w&&this.length){f=c.data(this[0],a);}return f===w&&d[1]?this.data(d[0]):f;}else{return this.trigger("setData"+d[1]+"!",[d[0],b]).each(function(){c.data(this,a,b);});}},removeData:function(a){return this.each(function(){c.removeData(this,a);});}});c.extend({queue:function(a,b,d){if(a){b=(b||"fx")+"queue";var f=c.data(a,b);if(!d){return f||[];}if(!f||c.isArray(d)){f=c.data(a,b,c.makeArray(d));}else{f.push(d);}return f;}},dequeue:function(a,b){b=b||"fx";var d=c.queue(a,b),f=d.shift();if(f==="inprogress"){f=d.shift();}if(f){b==="fx"&&d.unshift("inprogress");f.call(a,function(){c.dequeue(a,b);});}}});c.fn.extend({queue:function(a,b){if(typeof a!=="string"){b=a;a="fx";}if(b===w){return c.queue(this[0],a);}return this.each(function(){var d=c.queue(this,a,b);a==="fx"&&d[0]!=="inprogress"&&c.dequeue(this,a);});},dequeue:function(a){return this.each(function(){c.dequeue(this,a);});},delay:function(a,b){a=c.fx?c.fx.speeds[a]||a:a;b=b||"fx";return this.queue(b,function(){var d=this;setTimeout(function(){c.dequeue(d,b);},a);});},clearQueue:function(a){return this.queue(a||"fx",[]);}});var Aa=/[\n\t]/g,ca=/\s+/,Za=/\r/g,$a=/href|src|style/,ab=/(button|input)/i,bb=/(button|input|object|select|textarea)/i,cb=/^(a|area)$/i,Ba=/radio|checkbox/;c.fn.extend({attr:function(a,b){return X(this,a,b,true,c.attr);},removeAttr:function(a){return this.each(function(){c.attr(this,a,"");this.nodeType===1&&this.removeAttribute(a);});},addClass:function(a){if(c.isFunction(a)){return this.each(function(n){var r=c(this);r.addClass(a.call(this,n,r.attr("class")));});}if(a&&typeof a==="string"){for(var b=(a||"").split(ca),d=0,f=this.length;d<f;d++){var e=this[d];if(e.nodeType===1){if(e.className){for(var j=" "+e.className+" ",i=e.className,o=0,k=b.length;o<k;o++){if(j.indexOf(" "+b[o]+" ")<0){i+=" "+b[o];}}e.className=c.trim(i);}else{e.className=a;}}}}return this;},removeClass:function(a){if(c.isFunction(a)){return this.each(function(k){var n=c(this);n.removeClass(a.call(this,k,n.attr("class")));});}if(a&&typeof a==="string"||a===w){for(var b=(a||"").split(ca),d=0,f=this.length;d<f;d++){var e=this[d];if(e.nodeType===1&&e.className){if(a){for(var j=(" "+e.className+" ").replace(Aa," "),i=0,o=b.length;i<o;i++){j=j.replace(" "+b[i]+" "," ");}e.className=c.trim(j);}else{e.className="";}}}}return this;},toggleClass:function(a,b){var d=typeof a,f=typeof b==="boolean";if(c.isFunction(a)){return this.each(function(e){var j=c(this);j.toggleClass(a.call(this,e,j.attr("class"),b),b);});}return this.each(function(){if(d==="string"){for(var e,j=0,i=c(this),o=b,k=a.split(ca);e=k[j++];){o=f?o:!i.hasClass(e);i[o?"addClass":"removeClass"](e);}}else{if(d==="undefined"||d==="boolean"){this.className&&c.data(this,"__className__",this.className);this.className=this.className||a===false?"":c.data(this,"__className__")||"";}}});},hasClass:function(a){a=" "+a+" ";for(var b=0,d=this.length;b<d;b++){if((" "+this[b].className+" ").replace(Aa," ").indexOf(a)>-1){return true;}}return false;},val:function(a){if(a===w){var b=this[0];if(b){if(c.nodeName(b,"option")){return(b.attributes.value||{}).specified?b.value:b.text;}if(c.nodeName(b,"select")){var d=b.selectedIndex,f=[],e=b.options;b=b.type==="select-one";if(d<0){return null;}var j=b?d:0;for(d=b?d+1:e.length;j<d;j++){var i=e[j];if(i.selected){a=c(i).val();if(b){return a;}f.push(a);}}return f;}if(Ba.test(b.type)&&!c.support.checkOn){return b.getAttribute("value")===null?"on":b.value;}return(b.value||"").replace(Za,"");}return w;}var o=c.isFunction(a);return this.each(function(k){var n=c(this),r=a;if(this.nodeType===1){if(o){r=a.call(this,k,n.val());}if(typeof r==="number"){r+="";}if(c.isArray(r)&&Ba.test(this.type)){this.checked=c.inArray(n.val(),r)>=0;}else{if(c.nodeName(this,"select")){var u=c.makeArray(r);c("option",this).each(function(){this.selected=c.inArray(c(this).val(),u)>=0;});if(!u.length){this.selectedIndex=-1;}}else{this.value=r;}}}});}});c.extend({attrFn:{val:true,css:true,html:true,text:true,data:true,width:true,height:true,offset:true},attr:function(a,b,d,f){if(!a||a.nodeType===3||a.nodeType===8){return w;}if(f&&b in c.attrFn){return c(a)[b](d);}f=a.nodeType!==1||!c.isXMLDoc(a);var e=d!==w;b=f&&c.props[b]||b;if(a.nodeType===1){var j=$a.test(b);if(b in a&&f&&!j){if(e){b==="type"&&ab.test(a.nodeName)&&a.parentNode&&c.error("type property can't be changed");a[b]=d;}if(c.nodeName(a,"form")&&a.getAttributeNode(b)){return a.getAttributeNode(b).nodeValue;}if(b==="tabIndex"){return(b=a.getAttributeNode("tabIndex"))&&b.specified?b.value:bb.test(a.nodeName)||cb.test(a.nodeName)&&a.href?0:w;}return a[b];}if(!c.support.style&&f&&b==="style"){if(e){a.style.cssText=""+d;}return a.style.cssText;}e&&a.setAttribute(b,""+d);a=!c.support.hrefNormalized&&f&&j?a.getAttribute(b,2):a.getAttribute(b);return a===null?w:a;}return c.style(a,b,d);}});var O=/\.(.*)$/,db=function(a){return a.replace(/[^\w\s\.\|`]/g,function(b){return"\\"+b;});};c.event={add:function(a,b,d,f){if(!(a.nodeType===3||a.nodeType===8)){if(a.setInterval&&a!==A&&!a.frameElement){a=A;}var e,j;if(d.handler){e=d;d=e.handler;}if(!d.guid){d.guid=c.guid++;}if(j=c.data(a)){var i=j.events=j.events||{},o=j.handle;if(!o){j.handle=o=function(){return typeof c!=="undefined"&&!c.event.triggered?c.event.handle.apply(o.elem,arguments):w;};}o.elem=a;b=b.split(" ");for(var k,n=0,r;k=b[n++];){j=e?c.extend({},e):{handler:d,data:f};if(k.indexOf(".")>-1){r=k.split(".");k=r.shift();j.namespace=r.slice(0).sort().join(".");}else{r=[];j.namespace="";}j.type=k;j.guid=d.guid;var u=i[k],z=c.event.special[k]||{};if(!u){u=i[k]=[];if(!z.setup||z.setup.call(a,f,r,o)===false){if(a.addEventListener){a.addEventListener(k,o,false);}else{a.attachEvent&&a.attachEvent("on"+k,o);}}}if(z.add){z.add.call(a,j);if(!j.handler.guid){j.handler.guid=d.guid;}}u.push(j);c.event.global[k]=true;}a=null;}}},global:{},remove:function(a,b,d,f){if(!(a.nodeType===3||a.nodeType===8)){var e,j=0,i,o,k,n,r,u,z=c.data(a),C=z&&z.events;if(z&&C){if(b&&b.type){d=b.handler;b=b.type;}if(!b||typeof b==="string"&&b.charAt(0)==="."){b=b||"";for(e in C){c.event.remove(a,e+b);}}else{for(b=b.split(" ");e=b[j++];){n=e;i=e.indexOf(".")<0;o=[];if(!i){o=e.split(".");e=o.shift();k=new RegExp("(^|\\.)"+c.map(o.slice(0).sort(),db).join("\\.(?:.*\\.)?")+"(\\.|$)");}if(r=C[e]){if(d){n=c.event.special[e]||{};for(B=f||0;B<r.length;B++){u=r[B];if(d.guid===u.guid){if(i||k.test(u.namespace)){f==null&&r.splice(B--,1);n.remove&&n.remove.call(a,u);}if(f!=null){break;}}}if(r.length===0||f!=null&&r.length===1){if(!n.teardown||n.teardown.call(a,o)===false){Ca(a,e,z.handle);}delete C[e];}}else{for(var B=0;B<r.length;B++){u=r[B];if(i||k.test(u.namespace)){c.event.remove(a,n,u.handler,B);r.splice(B--,1);}}}}}if(c.isEmptyObject(C)){if(b=z.handle){b.elem=null;}delete z.events;delete z.handle;c.isEmptyObject(z)&&c.removeData(a);}}}}},trigger:function(a,b,d,f){var e=a.type||a;if(!f){a=typeof a==="object"?a[G]?a:c.extend(c.Event(e),a):c.Event(e);if(e.indexOf("!")>=0){a.type=e=e.slice(0,-1);a.exclusive=true;}if(!d){a.stopPropagation();c.event.global[e]&&c.each(c.cache,function(){this.events&&this.events[e]&&c.event.trigger(a,b,this.handle.elem);});}if(!d||d.nodeType===3||d.nodeType===8){return w;}a.result=w;a.target=d;b=c.makeArray(b);b.unshift(a);}a.currentTarget=d;(f=c.data(d,"handle"))&&f.apply(d,b);f=d.parentNode||d.ownerDocument;try{if(!(d&&d.nodeName&&c.noData[d.nodeName.toLowerCase()])){if(d["on"+e]&&d["on"+e].apply(d,b)===false){a.result=false;}}}catch(j){}if(!a.isPropagationStopped()&&f){c.event.trigger(a,b,f,true);}else{if(!a.isDefaultPrevented()){f=a.target;var i,o=c.nodeName(f,"a")&&e==="click",k=c.event.special[e]||{};if((!k._default||k._default.call(d,a)===false)&&!o&&!(f&&f.nodeName&&c.noData[f.nodeName.toLowerCase()])){try{if(f[e]){if(i=f["on"+e]){f["on"+e]=null;
}c.event.triggered=true;f[e]();}}catch(n){}if(i){f["on"+e]=i;}c.event.triggered=false;}}}},handle:function(a){var b,d,f,e;a=arguments[0]=c.event.fix(a||A.event);a.currentTarget=this;b=a.type.indexOf(".")<0&&!a.exclusive;if(!b){d=a.type.split(".");a.type=d.shift();f=new RegExp("(^|\\.)"+d.slice(0).sort().join("\\.(?:.*\\.)?")+"(\\.|$)");}e=c.data(this,"events");d=e[a.type];if(e&&d){d=d.slice(0);e=0;for(var j=d.length;e<j;e++){var i=d[e];if(b||f.test(i.namespace)){a.handler=i.handler;a.data=i.data;a.handleObj=i;i=i.handler.apply(this,arguments);if(i!==w){a.result=i;if(i===false){a.preventDefault();a.stopPropagation();}}if(a.isImmediatePropagationStopped()){break;}}}}return a.result;},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),fix:function(a){if(a[G]){return a;}var b=a;a=c.Event(b);for(var d=this.props.length,f;d;){f=this.props[--d];a[f]=b[f];}if(!a.target){a.target=a.srcElement||s;}if(a.target.nodeType===3){a.target=a.target.parentNode;}if(!a.relatedTarget&&a.fromElement){a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement;}if(a.pageX==null&&a.clientX!=null){b=s.documentElement;d=s.body;a.pageX=a.clientX+(b&&b.scrollLeft||d&&d.scrollLeft||0)-(b&&b.clientLeft||d&&d.clientLeft||0);a.pageY=a.clientY+(b&&b.scrollTop||d&&d.scrollTop||0)-(b&&b.clientTop||d&&d.clientTop||0);}if(!a.which&&(a.charCode||a.charCode===0?a.charCode:a.keyCode)){a.which=a.charCode||a.keyCode;}if(!a.metaKey&&a.ctrlKey){a.metaKey=a.ctrlKey;}if(!a.which&&a.button!==w){a.which=a.button&1?1:a.button&2?3:a.button&4?2:0;}return a;},guid:100000000,proxy:c.proxy,special:{ready:{setup:c.bindReady,teardown:c.noop},live:{add:function(a){c.event.add(this,a.origType,c.extend({},a,{handler:oa}));},remove:function(a){var b=true,d=a.origType.replace(O,"");c.each(c.data(this,"events").live||[],function(){if(d===this.origType.replace(O,"")){return b=false;}});b&&c.event.remove(this,a.origType,oa);}},beforeunload:{setup:function(a,b,d){if(this.setInterval){this.onbeforeunload=d;}return false;},teardown:function(a,b){if(this.onbeforeunload===b){this.onbeforeunload=null;}}}}};var Ca=s.removeEventListener?function(a,b,d){a.removeEventListener(b,d,false);}:function(a,b,d){a.detachEvent("on"+b,d);};c.Event=function(a){if(!this.preventDefault){return new c.Event(a);}if(a&&a.type){this.originalEvent=a;this.type=a.type;}else{this.type=a;}this.timeStamp=J();this[G]=true;};c.Event.prototype={preventDefault:function(){this.isDefaultPrevented=Z;var a=this.originalEvent;if(a){a.preventDefault&&a.preventDefault();a.returnValue=false;}},stopPropagation:function(){this.isPropagationStopped=Z;var a=this.originalEvent;if(a){a.stopPropagation&&a.stopPropagation();a.cancelBubble=true;}},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=Z;this.stopPropagation();},isDefaultPrevented:Y,isPropagationStopped:Y,isImmediatePropagationStopped:Y};var Da=function(a){var b=a.relatedTarget;try{for(;b&&b!==this;){b=b.parentNode;}if(b!==this){a.type=a.data;c.event.handle.apply(this,arguments);}}catch(d){}},Ea=function(a){a.type=a.data;c.event.handle.apply(this,arguments);};c.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){c.event.special[a]={setup:function(d){c.event.add(this,b,d&&d.selector?Ea:Da,a);},teardown:function(d){c.event.remove(this,b,d&&d.selector?Ea:Da);}};});if(!c.support.submitBubbles){c.event.special.submit={setup:function(){if(this.nodeName.toLowerCase()!=="form"){c.event.add(this,"click.specialSubmit",function(a){var b=a.target,d=b.type;if((d==="submit"||d==="image")&&c(b).closest("form").length){return na("submit",this,arguments);}});c.event.add(this,"keypress.specialSubmit",function(a){var b=a.target,d=b.type;if((d==="text"||d==="password")&&c(b).closest("form").length&&a.keyCode===13){return na("submit",this,arguments);}});}else{return false;}},teardown:function(){c.event.remove(this,".specialSubmit");}};}if(!c.support.changeBubbles){var da=/textarea|input|select/i,ea,Fa=function(a){var b=a.type,d=a.value;if(b==="radio"||b==="checkbox"){d=a.checked;}else{if(b==="select-multiple"){d=a.selectedIndex>-1?c.map(a.options,function(f){return f.selected;}).join("-"):"";}else{if(a.nodeName.toLowerCase()==="select"){d=a.selectedIndex;}}}return d;},fa=function(a,b){var d=a.target,f,e;if(!(!da.test(d.nodeName)||d.readOnly)){f=c.data(d,"_change_data");e=Fa(d);if(a.type!=="focusout"||d.type!=="radio"){c.data(d,"_change_data",e);}if(!(f===w||e===f)){if(f!=null||e){a.type="change";return c.event.trigger(a,b,d);}}}};c.event.special.change={filters:{focusout:fa,click:function(a){var b=a.target,d=b.type;if(d==="radio"||d==="checkbox"||b.nodeName.toLowerCase()==="select"){return fa.call(this,a);}},keydown:function(a){var b=a.target,d=b.type;if(a.keyCode===13&&b.nodeName.toLowerCase()!=="textarea"||a.keyCode===32&&(d==="checkbox"||d==="radio")||d==="select-multiple"){return fa.call(this,a);}},beforeactivate:function(a){a=a.target;c.data(a,"_change_data",Fa(a));}},setup:function(){if(this.type==="file"){return false;}for(var a in ea){c.event.add(this,a+".specialChange",ea[a]);}return da.test(this.nodeName);},teardown:function(){c.event.remove(this,".specialChange");return da.test(this.nodeName);}};ea=c.event.special.change.filters;}s.addEventListener&&c.each({focus:"focusin",blur:"focusout"},function(a,b){function d(f){f=c.event.fix(f);f.type=b;return c.event.handle.call(this,f);}c.event.special[b]={setup:function(){this.addEventListener(a,d,true);},teardown:function(){this.removeEventListener(a,d,true);}};});c.each(["bind","one"],function(a,b){c.fn[b]=function(d,f,e){if(typeof d==="object"){for(var j in d){this[b](j,f,d[j],e);}return this;}if(c.isFunction(f)){e=f;f=w;}var i=b==="one"?c.proxy(e,function(k){c(this).unbind(k,i);return e.apply(this,arguments);}):e;if(d==="unload"&&b!=="one"){this.one(d,f,e);}else{j=0;for(var o=this.length;j<o;j++){c.event.add(this[j],d,i,f);}}return this;};});c.fn.extend({unbind:function(a,b){if(typeof a==="object"&&!a.preventDefault){for(var d in a){this.unbind(d,a[d]);}}else{d=0;for(var f=this.length;d<f;d++){c.event.remove(this[d],a,b);}}return this;},delegate:function(a,b,d,f){return this.live(b,d,f,a);},undelegate:function(a,b,d){return arguments.length===0?this.unbind("live"):this.die(b,null,d,a);},trigger:function(a,b){return this.each(function(){c.event.trigger(a,b,this);});},triggerHandler:function(a,b){if(this[0]){a=c.Event(a);a.preventDefault();a.stopPropagation();c.event.trigger(a,b,this[0]);return a.result;}},toggle:function(a){for(var b=arguments,d=1;d<b.length;){c.proxy(a,b[d++]);}return this.click(c.proxy(a,function(f){var e=(c.data(this,"lastToggle"+a.guid)||0)%d;c.data(this,"lastToggle"+a.guid,e+1);f.preventDefault();return b[e].apply(this,arguments)||false;}));},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a);}});var Ga={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};c.each(["live","die"],function(a,b){c.fn[b]=function(d,f,e,j){var i,o=0,k,n,r=j||this.selector,u=j?this:c(this.context);if(c.isFunction(f)){e=f;f=w;}for(d=(d||"").split(" ");(i=d[o++])!=null;){j=O.exec(i);k="";if(j){k=j[0];i=i.replace(O,"");}if(i==="hover"){d.push("mouseenter"+k,"mouseleave"+k);}else{n=i;if(i==="focus"||i==="blur"){d.push(Ga[i]+k);i+=k;}else{i=(Ga[i]||i)+k;}b==="live"?u.each(function(){c.event.add(this,pa(i,r),{data:f,selector:r,handler:e,origType:i,origHandler:e,preType:n});}):u.unbind(pa(i,r),e);}}return this;};});c.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" "),function(a,b){c.fn[b]=function(d){return d?this.bind(b,d):this.trigger(b);};if(c.attrFn){c.attrFn[b]=true;}});A.attachEvent&&!A.addEventListener&&A.attachEvent("onunload",function(){for(var a in c.cache){if(c.cache[a].handle){try{c.event.remove(c.cache[a].handle.elem);}catch(b){}}}});(function(){function a(g){for(var h="",l,m=0;g[m];m++){l=g[m];if(l.nodeType===3||l.nodeType===4){h+=l.nodeValue;}else{if(l.nodeType!==8){h+=a(l.childNodes);}}}return h;}function b(g,h,l,m,q,p){q=0;for(var v=m.length;q<v;q++){var t=m[q];if(t){t=t[g];for(var y=false;t;){if(t.sizcache===l){y=m[t.sizset];break;}if(t.nodeType===1&&!p){t.sizcache=l;t.sizset=q;}if(t.nodeName.toLowerCase()===h){y=t;break;}t=t[g];}m[q]=y;}}}function d(g,h,l,m,q,p){q=0;for(var v=m.length;q<v;q++){var t=m[q];if(t){t=t[g];for(var y=false;t;){if(t.sizcache===l){y=m[t.sizset];break;}if(t.nodeType===1){if(!p){t.sizcache=l;t.sizset=q;}if(typeof h!=="string"){if(t===h){y=true;break;}}else{if(k.filter(h,[t]).length>0){y=t;break;}}}t=t[g];}m[q]=y;}}}var f=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,e=0,j=Object.prototype.toString,i=false,o=true;[0,0].sort(function(){o=false;return 0;});var k=function(g,h,l,m){l=l||[];var q=h=h||s;if(h.nodeType!==1&&h.nodeType!==9){return[];}if(!g||typeof g!=="string"){return l;}for(var p=[],v,t,y,S,H=true,M=x(h),I=g;(f.exec(""),v=f.exec(I))!==null;){I=v[3];p.push(v[1]);if(v[2]){S=v[3];break;}}if(p.length>1&&r.exec(g)){if(p.length===2&&n.relative[p[0]]){t=ga(p[0]+p[1],h);}else{for(t=n.relative[p[0]]?[h]:k(p.shift(),h);p.length;){g=p.shift();if(n.relative[g]){g+=p.shift();}t=ga(g,t);}}}else{if(!m&&p.length>1&&h.nodeType===9&&!M&&n.match.ID.test(p[0])&&!n.match.ID.test(p[p.length-1])){v=k.find(p.shift(),h,M);h=v.expr?k.filter(v.expr,v.set)[0]:v.set[0];}if(h){v=m?{expr:p.pop(),set:z(m)}:k.find(p.pop(),p.length===1&&(p[0]==="~"||p[0]==="+")&&h.parentNode?h.parentNode:h,M);t=v.expr?k.filter(v.expr,v.set):v.set;if(p.length>0){y=z(t);}else{H=false;}for(;p.length;){var D=p.pop();v=D;if(n.relative[D]){v=p.pop();
}else{D="";}if(v==null){v=h;}n.relative[D](y,v,M);}}else{y=[];}}y||(y=t);y||k.error(D||g);if(j.call(y)==="[object Array]"){if(H){if(h&&h.nodeType===1){for(g=0;y[g]!=null;g++){if(y[g]&&(y[g]===true||y[g].nodeType===1&&E(h,y[g]))){l.push(t[g]);}}}else{for(g=0;y[g]!=null;g++){y[g]&&y[g].nodeType===1&&l.push(t[g]);}}}else{l.push.apply(l,y);}}else{z(y,l);}if(S){k(S,q,l,m);k.uniqueSort(l);}return l;};k.uniqueSort=function(g){if(B){i=o;g.sort(B);if(i){for(var h=1;h<g.length;h++){g[h]===g[h-1]&&g.splice(h--,1);}}}return g;};k.matches=function(g,h){return k(g,null,null,h);};k.find=function(g,h,l){var m,q;if(!g){return[];}for(var p=0,v=n.order.length;p<v;p++){var t=n.order[p];if(q=n.leftMatch[t].exec(g)){var y=q[1];q.splice(1,1);if(y.substr(y.length-1)!=="\\"){q[1]=(q[1]||"").replace(/\\/g,"");m=n.find[t](q,h,l);if(m!=null){g=g.replace(n.match[t],"");break;}}}}m||(m=h.getElementsByTagName("*"));return{set:m,expr:g};};k.filter=function(g,h,l,m){for(var q=g,p=[],v=h,t,y,S=h&&h[0]&&x(h[0]);g&&h.length;){for(var H in n.filter){if((t=n.leftMatch[H].exec(g))!=null&&t[2]){var M=n.filter[H],I,D;D=t[1];y=false;t.splice(1,1);if(D.substr(D.length-1)!=="\\"){if(v===p){p=[];}if(n.preFilter[H]){if(t=n.preFilter[H](t,v,l,p,m,S)){if(t===true){continue;}}else{y=I=true;}}if(t){for(var U=0;(D=v[U])!=null;U++){if(D){I=M(D,t,U,v);var Ha=m^!!I;if(l&&I!=null){if(Ha){y=true;}else{v[U]=false;}}else{if(Ha){p.push(D);y=true;}}}}}if(I!==w){l||(v=p);g=g.replace(n.match[H],"");if(!y){return[];}break;}}}}if(g===q){if(y==null){k.error(g);}else{break;}}q=g;}return v;};k.error=function(g){throw"Syntax error, unrecognized expression: "+g;};var n=k.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(g){return g.getAttribute("href");}},relative:{"+":function(g,h){var l=typeof h==="string",m=l&&!/\W/.test(h);l=l&&!m;if(m){h=h.toLowerCase();}m=0;for(var q=g.length,p;m<q;m++){if(p=g[m]){for(;(p=p.previousSibling)&&p.nodeType!==1;){}g[m]=l||p&&p.nodeName.toLowerCase()===h?p||false:p===h;}}l&&k.filter(h,g,true);},">":function(g,h){var l=typeof h==="string";if(l&&!/\W/.test(h)){h=h.toLowerCase();for(var m=0,q=g.length;m<q;m++){var p=g[m];if(p){l=p.parentNode;g[m]=l.nodeName.toLowerCase()===h?l:false;}}}else{m=0;for(q=g.length;m<q;m++){if(p=g[m]){g[m]=l?p.parentNode:p.parentNode===h;}}l&&k.filter(h,g,true);}},"":function(g,h,l){var m=e++,q=d;if(typeof h==="string"&&!/\W/.test(h)){var p=h=h.toLowerCase();q=b;}q("parentNode",h,m,g,p,l);},"~":function(g,h,l){var m=e++,q=d;if(typeof h==="string"&&!/\W/.test(h)){var p=h=h.toLowerCase();q=b;}q("previousSibling",h,m,g,p,l);}},find:{ID:function(g,h,l){if(typeof h.getElementById!=="undefined"&&!l){return(g=h.getElementById(g[1]))?[g]:[];}},NAME:function(g,h){if(typeof h.getElementsByName!=="undefined"){var l=[];h=h.getElementsByName(g[1]);for(var m=0,q=h.length;m<q;m++){h[m].getAttribute("name")===g[1]&&l.push(h[m]);}return l.length===0?null:l;}},TAG:function(g,h){return h.getElementsByTagName(g[1]);}},preFilter:{CLASS:function(g,h,l,m,q,p){g=" "+g[1].replace(/\\/g,"")+" ";if(p){return g;}p=0;for(var v;(v=h[p])!=null;p++){if(v){if(q^(v.className&&(" "+v.className+" ").replace(/[\t\n]/g," ").indexOf(g)>=0)){l||m.push(v);}else{if(l){h[p]=false;}}}}return false;},ID:function(g){return g[1].replace(/\\/g,"");},TAG:function(g){return g[1].toLowerCase();},CHILD:function(g){if(g[1]==="nth"){var h=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(g[2]==="even"&&"2n"||g[2]==="odd"&&"2n+1"||!/\D/.test(g[2])&&"0n+"+g[2]||g[2]);g[2]=h[1]+(h[2]||1)-0;g[3]=h[3]-0;}g[0]=e++;return g;},ATTR:function(g,h,l,m,q,p){h=g[1].replace(/\\/g,"");if(!p&&n.attrMap[h]){g[1]=n.attrMap[h];}if(g[2]==="~="){g[4]=" "+g[4]+" ";}return g;},PSEUDO:function(g,h,l,m,q){if(g[1]==="not"){if((f.exec(g[3])||"").length>1||/^\w/.test(g[3])){g[3]=k(g[3],null,null,h);}else{g=k.filter(g[3],h,l,true^q);l||m.push.apply(m,g);return false;}}else{if(n.match.POS.test(g[0])||n.match.CHILD.test(g[0])){return true;}}return g;},POS:function(g){g.unshift(true);return g;}},filters:{enabled:function(g){return g.disabled===false&&g.type!=="hidden";},disabled:function(g){return g.disabled===true;},checked:function(g){return g.checked===true;},selected:function(g){return g.selected===true;},parent:function(g){return !!g.firstChild;},empty:function(g){return !g.firstChild;},has:function(g,h,l){return !!k(l[3],g).length;},header:function(g){return/h\d/i.test(g.nodeName);},text:function(g){return"text"===g.type;},radio:function(g){return"radio"===g.type;},checkbox:function(g){return"checkbox"===g.type;},file:function(g){return"file"===g.type;},password:function(g){return"password"===g.type;},submit:function(g){return"submit"===g.type;},image:function(g){return"image"===g.type;},reset:function(g){return"reset"===g.type;},button:function(g){return"button"===g.type||g.nodeName.toLowerCase()==="button";},input:function(g){return/input|select|textarea|button/i.test(g.nodeName);}},setFilters:{first:function(g,h){return h===0;},last:function(g,h,l,m){return h===m.length-1;},even:function(g,h){return h%2===0;},odd:function(g,h){return h%2===1;},lt:function(g,h,l){return h<l[3]-0;},gt:function(g,h,l){return h>l[3]-0;},nth:function(g,h,l){return l[3]-0===h;},eq:function(g,h,l){return l[3]-0===h;}},filter:{PSEUDO:function(g,h,l,m){var q=h[1],p=n.filters[q];if(p){return p(g,l,h,m);}else{if(q==="contains"){return(g.textContent||g.innerText||a([g])||"").indexOf(h[3])>=0;}else{if(q==="not"){h=h[3];l=0;for(m=h.length;l<m;l++){if(h[l]===g){return false;}}return true;}else{k.error("Syntax error, unrecognized expression: "+q);}}}},CHILD:function(g,h){var l=h[1],m=g;switch(l){case"only":case"first":for(;m=m.previousSibling;){if(m.nodeType===1){return false;}}if(l==="first"){return true;}m=g;case"last":for(;m=m.nextSibling;){if(m.nodeType===1){return false;}}return true;case"nth":l=h[2];var q=h[3];if(l===1&&q===0){return true;}h=h[0];var p=g.parentNode;if(p&&(p.sizcache!==h||!g.nodeIndex)){var v=0;for(m=p.firstChild;m;m=m.nextSibling){if(m.nodeType===1){m.nodeIndex=++v;}}p.sizcache=h;}g=g.nodeIndex-q;return l===0?g===0:g%l===0&&g/l>=0;}},ID:function(g,h){return g.nodeType===1&&g.getAttribute("id")===h;},TAG:function(g,h){return h==="*"&&g.nodeType===1||g.nodeName.toLowerCase()===h;},CLASS:function(g,h){return(" "+(g.className||g.getAttribute("class"))+" ").indexOf(h)>-1;},ATTR:function(g,h){var l=h[1];g=n.attrHandle[l]?n.attrHandle[l](g):g[l]!=null?g[l]:g.getAttribute(l);l=g+"";var m=h[2];h=h[4];return g==null?m==="!=":m==="="?l===h:m==="*="?l.indexOf(h)>=0:m==="~="?(" "+l+" ").indexOf(h)>=0:!h?l&&g!==false:m==="!="?l!==h:m==="^="?l.indexOf(h)===0:m==="$="?l.substr(l.length-h.length)===h:m==="|="?l===h||l.substr(0,h.length+1)===h+"-":false;},POS:function(g,h,l,m){var q=n.setFilters[h[2]];if(q){return q(g,l,h,m);}}}},r=n.match.POS;for(var u in n.match){n.match[u]=new RegExp(n.match[u].source+/(?![^\[]*\])(?![^\(]*\))/.source);n.leftMatch[u]=new RegExp(/(^(?:.|\r|\n)*?)/.source+n.match[u].source.replace(/\\(\d+)/g,function(g,h){return"\\"+(h-0+1);}));}var z=function(g,h){g=Array.prototype.slice.call(g,0);if(h){h.push.apply(h,g);return h;}return g;};try{Array.prototype.slice.call(s.documentElement.childNodes,0);}catch(C){z=function(g,h){h=h||[];if(j.call(g)==="[object Array]"){Array.prototype.push.apply(h,g);}else{if(typeof g.length==="number"){for(var l=0,m=g.length;l<m;l++){h.push(g[l]);}}else{for(l=0;g[l];l++){h.push(g[l]);}}}return h;};}var B;if(s.documentElement.compareDocumentPosition){B=function(g,h){if(!g.compareDocumentPosition||!h.compareDocumentPosition){if(g==h){i=true;}return g.compareDocumentPosition?-1:1;}g=g.compareDocumentPosition(h)&4?-1:g===h?0:1;if(g===0){i=true;}return g;};}else{if("sourceIndex" in s.documentElement){B=function(g,h){if(!g.sourceIndex||!h.sourceIndex){if(g==h){i=true;}return g.sourceIndex?-1:1;}g=g.sourceIndex-h.sourceIndex;if(g===0){i=true;}return g;};}else{if(s.createRange){B=function(g,h){if(!g.ownerDocument||!h.ownerDocument){if(g==h){i=true;}return g.ownerDocument?-1:1;}var l=g.ownerDocument.createRange(),m=h.ownerDocument.createRange();l.setStart(g,0);l.setEnd(g,0);m.setStart(h,0);m.setEnd(h,0);g=l.compareBoundaryPoints(Range.START_TO_END,m);if(g===0){i=true;}return g;};}}}(function(){var g=s.createElement("div"),h="script"+(new Date).getTime();g.innerHTML="<a name='"+h+"'/>";var l=s.documentElement;l.insertBefore(g,l.firstChild);if(s.getElementById(h)){n.find.ID=function(m,q,p){if(typeof q.getElementById!=="undefined"&&!p){return(q=q.getElementById(m[1]))?q.id===m[1]||typeof q.getAttributeNode!=="undefined"&&q.getAttributeNode("id").nodeValue===m[1]?[q]:w:[];}};n.filter.ID=function(m,q){var p=typeof m.getAttributeNode!=="undefined"&&m.getAttributeNode("id");return m.nodeType===1&&p&&p.nodeValue===q;};}l.removeChild(g);l=g=null;})();(function(){var g=s.createElement("div");g.appendChild(s.createComment(""));if(g.getElementsByTagName("*").length>0){n.find.TAG=function(h,l){l=l.getElementsByTagName(h[1]);if(h[1]==="*"){h=[];for(var m=0;l[m];m++){l[m].nodeType===1&&h.push(l[m]);}l=h;}return l;};}g.innerHTML="<a href='#'></a>";if(g.firstChild&&typeof g.firstChild.getAttribute!=="undefined"&&g.firstChild.getAttribute("href")!=="#"){n.attrHandle.href=function(h){return h.getAttribute("href",2);};}g=null;})();s.querySelectorAll&&function(){var g=k,h=s.createElement("div");h.innerHTML="<p class='TEST'></p>";if(!(h.querySelectorAll&&h.querySelectorAll(".TEST").length===0)){k=function(m,q,p,v){q=q||s;if(!v&&q.nodeType===9&&!x(q)){try{return z(q.querySelectorAll(m),p);
}catch(t){}}return g(m,q,p,v);};for(var l in g){k[l]=g[l];}h=null;}}();(function(){var g=s.createElement("div");g.innerHTML="<div class='test e'></div><div class='test'></div>";if(!(!g.getElementsByClassName||g.getElementsByClassName("e").length===0)){g.lastChild.className="e";if(g.getElementsByClassName("e").length!==1){n.order.splice(1,0,"CLASS");n.find.CLASS=function(h,l,m){if(typeof l.getElementsByClassName!=="undefined"&&!m){return l.getElementsByClassName(h[1]);}};g=null;}}})();var E=s.compareDocumentPosition?function(g,h){return !!(g.compareDocumentPosition(h)&16);}:function(g,h){return g!==h&&(g.contains?g.contains(h):true);},x=function(g){return(g=(g?g.ownerDocument||g:0).documentElement)?g.nodeName!=="HTML":false;},ga=function(g,h){var l=[],m="",q;for(h=h.nodeType?[h]:h;q=n.match.PSEUDO.exec(g);){m+=q[0];g=g.replace(n.match.PSEUDO,"");}g=n.relative[g]?g+"*":g;q=0;for(var p=h.length;q<p;q++){k(g,h[q],l);}return k.filter(m,l);};c.find=k;c.expr=k.selectors;c.expr[":"]=c.expr.filters;c.unique=k.uniqueSort;c.text=a;c.isXMLDoc=x;c.contains=E;})();var eb=/Until$/,fb=/^(?:parents|prevUntil|prevAll)/,gb=/,/;R=Array.prototype.slice;var Ia=function(a,b,d){if(c.isFunction(b)){return c.grep(a,function(e,j){return !!b.call(e,j,e)===d;});}else{if(b.nodeType){return c.grep(a,function(e){return e===b===d;});}else{if(typeof b==="string"){var f=c.grep(a,function(e){return e.nodeType===1;});if(Ua.test(b)){return c.filter(b,f,!d);}else{b=c.filter(b,f);}}}}return c.grep(a,function(e){return c.inArray(e,b)>=0===d;});};c.fn.extend({find:function(a){for(var b=this.pushStack("","find",a),d=0,f=0,e=this.length;f<e;f++){d=b.length;c.find(a,this[f],b);if(f>0){for(var j=d;j<b.length;j++){for(var i=0;i<d;i++){if(b[i]===b[j]){b.splice(j--,1);break;}}}}}return b;},has:function(a){var b=c(a);return this.filter(function(){for(var d=0,f=b.length;d<f;d++){if(c.contains(this,b[d])){return true;}}});},not:function(a){return this.pushStack(Ia(this,a,false),"not",a);},filter:function(a){return this.pushStack(Ia(this,a,true),"filter",a);},is:function(a){return !!a&&c.filter(a,this).length>0;},closest:function(a,b){if(c.isArray(a)){var d=[],f=this[0],e,j={},i;if(f&&a.length){e=0;for(var o=a.length;e<o;e++){i=a[e];j[i]||(j[i]=c.expr.match.POS.test(i)?c(i,b||this.context):i);}for(;f&&f.ownerDocument&&f!==b;){for(i in j){e=j[i];if(e.jquery?e.index(f)>-1:c(f).is(e)){d.push({selector:i,elem:f});delete j[i];}}f=f.parentNode;}}return d;}var k=c.expr.match.POS.test(a)?c(a,b||this.context):null;return this.map(function(n,r){for(;r&&r.ownerDocument&&r!==b;){if(k?k.index(r)>-1:c(r).is(a)){return r;}r=r.parentNode;}return null;});},index:function(a){if(!a||typeof a==="string"){return c.inArray(this[0],a?c(a):this.parent().children());}return c.inArray(a.jquery?a[0]:a,this);},add:function(a,b){a=typeof a==="string"?c(a,b||this.context):c.makeArray(a);b=c.merge(this.get(),a);return this.pushStack(qa(a[0])||qa(b[0])?b:c.unique(b));},andSelf:function(){return this.add(this.prevObject);}});c.each({parent:function(a){return(a=a.parentNode)&&a.nodeType!==11?a:null;},parents:function(a){return c.dir(a,"parentNode");},parentsUntil:function(a,b,d){return c.dir(a,"parentNode",d);},next:function(a){return c.nth(a,2,"nextSibling");},prev:function(a){return c.nth(a,2,"previousSibling");},nextAll:function(a){return c.dir(a,"nextSibling");},prevAll:function(a){return c.dir(a,"previousSibling");},nextUntil:function(a,b,d){return c.dir(a,"nextSibling",d);},prevUntil:function(a,b,d){return c.dir(a,"previousSibling",d);},siblings:function(a){return c.sibling(a.parentNode.firstChild,a);},children:function(a){return c.sibling(a.firstChild);},contents:function(a){return c.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:c.makeArray(a.childNodes);}},function(a,b){c.fn[a]=function(d,f){var e=c.map(this,b,d);eb.test(a)||(f=d);if(f&&typeof f==="string"){e=c.filter(f,e);}e=this.length>1?c.unique(e):e;if((this.length>1||gb.test(f))&&fb.test(a)){e=e.reverse();}return this.pushStack(e,a,R.call(arguments).join(","));};});c.extend({filter:function(a,b,d){if(d){a=":not("+a+")";}return c.find.matches(a,b);},dir:function(a,b,d){var f=[];for(a=a[b];a&&a.nodeType!==9&&(d===w||a.nodeType!==1||!c(a).is(d));){a.nodeType===1&&f.push(a);a=a[b];}return f;},nth:function(a,b,d){b=b||1;for(var f=0;a;a=a[d]){if(a.nodeType===1&&++f===b){break;}}return a;},sibling:function(a,b){for(var d=[];a;a=a.nextSibling){a.nodeType===1&&a!==b&&d.push(a);}return d;}});var Ja=/ jQuery\d+="(?:\d+|null)"/g,V=/^\s+/,Ka=/(<([\w:]+)[^>]*?)\/>/g,hb=/^(?:area|br|col|embed|hr|img|input|link|meta|param)$/i,La=/<([\w:]+)/,ib=/<tbody/i,jb=/<|&#?\w+;/,ta=/<script|<object|<embed|<option|<style/i,ua=/checked\s*(?:[^=]|=\s*.checked.)/i,Ma=function(a,b,d){return hb.test(d)?a:b+"></"+d+">";},F={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};F.optgroup=F.option;F.tbody=F.tfoot=F.colgroup=F.caption=F.thead;F.th=F.td;if(!c.support.htmlSerialize){F._default=[1,"div<div>","</div>"];}c.fn.extend({text:function(a){if(c.isFunction(a)){return this.each(function(b){var d=c(this);d.text(a.call(this,b,d.text()));});}if(typeof a!=="object"&&a!==w){return this.empty().append((this[0]&&this[0].ownerDocument||s).createTextNode(a));}return c.text(this);},wrapAll:function(a){if(c.isFunction(a)){return this.each(function(d){c(this).wrapAll(a.call(this,d));});}if(this[0]){var b=c(a,this[0].ownerDocument).eq(0).clone(true);this[0].parentNode&&b.insertBefore(this[0]);b.map(function(){for(var d=this;d.firstChild&&d.firstChild.nodeType===1;){d=d.firstChild;}return d;}).append(this);}return this;},wrapInner:function(a){if(c.isFunction(a)){return this.each(function(b){c(this).wrapInner(a.call(this,b));});}return this.each(function(){var b=c(this),d=b.contents();d.length?d.wrapAll(a):b.append(a);});},wrap:function(a){return this.each(function(){c(this).wrapAll(a);});},unwrap:function(){return this.parent().each(function(){c.nodeName(this,"body")||c(this).replaceWith(this.childNodes);}).end();},append:function(){return this.domManip(arguments,true,function(a){this.nodeType===1&&this.appendChild(a);});},prepend:function(){return this.domManip(arguments,true,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild);});},before:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(b){this.parentNode.insertBefore(b,this);});}else{if(arguments.length){var a=c(arguments[0]);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments);}}},after:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(b){this.parentNode.insertBefore(b,this.nextSibling);});}else{if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,c(arguments[0]).toArray());return a;}}},remove:function(a,b){for(var d=0,f;(f=this[d])!=null;d++){if(!a||c.filter(a,[f]).length){if(!b&&f.nodeType===1){c.cleanData(f.getElementsByTagName("*"));c.cleanData([f]);}f.parentNode&&f.parentNode.removeChild(f);}}return this;},empty:function(){for(var a=0,b;(b=this[a])!=null;a++){for(b.nodeType===1&&c.cleanData(b.getElementsByTagName("*"));b.firstChild;){b.removeChild(b.firstChild);}}return this;},clone:function(a){var b=this.map(function(){if(!c.support.noCloneEvent&&!c.isXMLDoc(this)){var d=this.outerHTML,f=this.ownerDocument;if(!d){d=f.createElement("div");d.appendChild(this.cloneNode(true));d=d.innerHTML;}return c.clean([d.replace(Ja,"").replace(/=([^="'>\s]+\/)>/g,'="$1">').replace(V,"")],f)[0];}else{return this.cloneNode(true);}});if(a===true){ra(this,b);ra(this.find("*"),b.find("*"));}return b;},html:function(a){if(a===w){return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(Ja,""):null;}else{if(typeof a==="string"&&!ta.test(a)&&(c.support.leadingWhitespace||!V.test(a))&&!F[(La.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Ka,Ma);try{for(var b=0,d=this.length;b<d;b++){if(this[b].nodeType===1){c.cleanData(this[b].getElementsByTagName("*"));this[b].innerHTML=a;}}}catch(f){this.empty().append(a);}}else{c.isFunction(a)?this.each(function(e){var j=c(this),i=j.html();j.empty().append(function(){return a.call(this,e,i);});}):this.empty().append(a);}}return this;},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(c.isFunction(a)){return this.each(function(b){var d=c(this),f=d.html();d.replaceWith(a.call(this,b,f));});}if(typeof a!=="string"){a=c(a).detach();}return this.each(function(){var b=this.nextSibling,d=this.parentNode;c(this).remove();b?c(b).before(a):c(d).append(a);});}else{return this.pushStack(c(c.isFunction(a)?a():a),"replaceWith",a);}},detach:function(a){return this.remove(a,true);},domManip:function(a,b,d){function f(u){return c.nodeName(u,"table")?u.getElementsByTagName("tbody")[0]||u.appendChild(u.ownerDocument.createElement("tbody")):u;}var e,j,i=a[0],o=[],k;if(!c.support.checkClone&&arguments.length===3&&typeof i==="string"&&ua.test(i)){return this.each(function(){c(this).domManip(a,b,d,true);});}if(c.isFunction(i)){return this.each(function(u){var z=c(this);a[0]=i.call(this,u,b?z.html():w);z.domManip(a,b,d);});}if(this[0]){e=i&&i.parentNode;e=c.support.parentNode&&e&&e.nodeType===11&&e.childNodes.length===this.length?{fragment:e}:sa(a,this,o);k=e.fragment;if(j=k.childNodes.length===1?(k=k.firstChild):k.firstChild){b=b&&c.nodeName(j,"tr");for(var n=0,r=this.length;n<r;n++){d.call(b?f(this[n],j):this[n],n>0||e.cacheable||this.length>1?k.cloneNode(true):k);}}o.length&&c.each(o,Qa);}return this;}});c.fragments={};c.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){c.fn[a]=function(d){var f=[];d=c(d);var e=this.length===1&&this[0].parentNode;if(e&&e.nodeType===11&&e.childNodes.length===1&&d.length===1){d[b](this[0]);
return this;}else{e=0;for(var j=d.length;e<j;e++){var i=(e>0?this.clone(true):this).get();c.fn[b].apply(c(d[e]),i);f=f.concat(i);}return this.pushStack(f,a,d.selector);}};});c.extend({clean:function(a,b,d,f){b=b||s;if(typeof b.createElement==="undefined"){b=b.ownerDocument||b[0]&&b[0].ownerDocument||s;}for(var e=[],j=0,i;(i=a[j])!=null;j++){if(typeof i==="number"){i+="";}if(i){if(typeof i==="string"&&!jb.test(i)){i=b.createTextNode(i);}else{if(typeof i==="string"){i=i.replace(Ka,Ma);var o=(La.exec(i)||["",""])[1].toLowerCase(),k=F[o]||F._default,n=k[0],r=b.createElement("div");for(r.innerHTML=k[1]+i+k[2];n--;){r=r.lastChild;}if(!c.support.tbody){n=ib.test(i);o=o==="table"&&!n?r.firstChild&&r.firstChild.childNodes:k[1]==="<table>"&&!n?r.childNodes:[];for(k=o.length-1;k>=0;--k){c.nodeName(o[k],"tbody")&&!o[k].childNodes.length&&o[k].parentNode.removeChild(o[k]);}}!c.support.leadingWhitespace&&V.test(i)&&r.insertBefore(b.createTextNode(V.exec(i)[0]),r.firstChild);i=r.childNodes;}}if(i.nodeType){e.push(i);}else{e=c.merge(e,i);}}}if(d){for(j=0;e[j];j++){if(f&&c.nodeName(e[j],"script")&&(!e[j].type||e[j].type.toLowerCase()==="text/javascript")){f.push(e[j].parentNode?e[j].parentNode.removeChild(e[j]):e[j]);}else{e[j].nodeType===1&&e.splice.apply(e,[j+1,0].concat(c.makeArray(e[j].getElementsByTagName("script"))));d.appendChild(e[j]);}}}return e;},cleanData:function(a){for(var b,d,f=c.cache,e=c.event.special,j=c.support.deleteExpando,i=0,o;(o=a[i])!=null;i++){if(d=o[c.expando]){b=f[d];if(b.events){for(var k in b.events){e[k]?c.event.remove(o,k):Ca(o,k,b.handle);}}if(j){delete o[c.expando];}else{o.removeAttribute&&o.removeAttribute(c.expando);}delete f[d];}}}});var kb=/z-?index|font-?weight|opacity|zoom|line-?height/i,Na=/alpha\([^)]*\)/,Oa=/opacity=([^)]*)/,ha=/float/i,ia=/-([a-z])/ig,lb=/([A-Z])/g,mb=/^-?\d+(?:px)?$/i,nb=/^-?\d/,ob={position:"absolute",visibility:"hidden",display:"block"},pb=["Left","Right"],qb=["Top","Bottom"],rb=s.defaultView&&s.defaultView.getComputedStyle,Pa=c.support.cssFloat?"cssFloat":"styleFloat",ja=function(a,b){return b.toUpperCase();};c.fn.css=function(a,b){return X(this,a,b,true,function(d,f,e){if(e===w){return c.curCSS(d,f);}if(typeof e==="number"&&!kb.test(f)){e+="px";}c.style(d,f,e);});};c.extend({style:function(a,b,d){if(!a||a.nodeType===3||a.nodeType===8){return w;}if((b==="width"||b==="height")&&parseFloat(d)<0){d=w;}var f=a.style||a,e=d!==w;if(!c.support.opacity&&b==="opacity"){if(e){f.zoom=1;b=parseInt(d,10)+""==="NaN"?"":"alpha(opacity="+d*100+")";a=f.filter||c.curCSS(a,"filter")||"";f.filter=Na.test(a)?a.replace(Na,b):b;}return f.filter&&f.filter.indexOf("opacity=")>=0?parseFloat(Oa.exec(f.filter)[1])/100+"":"";}if(ha.test(b)){b=Pa;}b=b.replace(ia,ja);if(e){f[b]=d;}return f[b];},css:function(a,b,d,f){if(b==="width"||b==="height"){var e,j=b==="width"?pb:qb;function i(){e=b==="width"?a.offsetWidth:a.offsetHeight;f!=="border"&&c.each(j,function(){f||(e-=parseFloat(c.curCSS(a,"padding"+this,true))||0);if(f==="margin"){e+=parseFloat(c.curCSS(a,"margin"+this,true))||0;}else{e-=parseFloat(c.curCSS(a,"border"+this+"Width",true))||0;}});}a.offsetWidth!==0?i():c.swap(a,ob,i);return Math.max(0,Math.round(e));}return c.curCSS(a,b,d);},curCSS:function(a,b,d){var f,e=a.style;if(!c.support.opacity&&b==="opacity"&&a.currentStyle){f=Oa.test(a.currentStyle.filter||"")?parseFloat(RegExp.$1)/100+"":"";return f===""?"1":f;}if(ha.test(b)){b=Pa;}if(!d&&e&&e[b]){f=e[b];}else{if(rb){if(ha.test(b)){b="float";}b=b.replace(lb,"-$1").toLowerCase();e=a.ownerDocument.defaultView;if(!e){return null;}if(a=e.getComputedStyle(a,null)){f=a.getPropertyValue(b);}if(b==="opacity"&&f===""){f="1";}}else{if(a.currentStyle){d=b.replace(ia,ja);f=a.currentStyle[b]||a.currentStyle[d];if(!mb.test(f)&&nb.test(f)){b=e.left;var j=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;e.left=d==="fontSize"?"1em":f||0;f=e.pixelLeft+"px";e.left=b;a.runtimeStyle.left=j;}}}}return f;},swap:function(a,b,d){var f={};for(var e in b){f[e]=a.style[e];a.style[e]=b[e];}d.call(a);for(e in b){a.style[e]=f[e];}}});if(c.expr&&c.expr.filters){c.expr.filters.hidden=function(a){var b=a.offsetWidth,d=a.offsetHeight,f=a.nodeName.toLowerCase()==="tr";return b===0&&d===0&&!f?true:b>0&&d>0&&!f?false:c.curCSS(a,"display")==="none";};c.expr.filters.visible=function(a){return !c.expr.filters.hidden(a);};}var sb=J(),tb=/<script(.|\s)*?\/script>/gi,ub=/select|textarea/i,vb=/color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week/i,N=/=\?(&|$)/,ka=/\?/,wb=/(\?|&)_=.*?(&|$)/,xb=/^(\w+:)?\/\/([^\/?#]+)/,yb=/%20/g,zb=c.fn.load;c.fn.extend({load:function(a,b,d){if(typeof a!=="string"){return zb.call(this,a);}else{if(!this.length){return this;}}var f=a.indexOf(" ");if(f>=0){var e=a.slice(f,a.length);a=a.slice(0,f);}f="GET";if(b){if(c.isFunction(b)){d=b;b=null;}else{if(typeof b==="object"){b=c.param(b,c.ajaxSettings.traditional);f="POST";}}}var j=this;c.ajax({url:a,type:f,dataType:"html",data:b,complete:function(i,o){if(o==="success"||o==="notmodified"){j.html(e?c("<div />").append(i.responseText.replace(tb,"")).find(e):i.responseText);}d&&j.each(d,[i.responseText,o,i]);}});return this;},serialize:function(){return c.param(this.serializeArray());},serializeArray:function(){return this.map(function(){return this.elements?c.makeArray(this.elements):this;}).filter(function(){return this.name&&!this.disabled&&(this.checked||ub.test(this.nodeName)||vb.test(this.type));}).map(function(a,b){a=c(this).val();return a==null?null:c.isArray(a)?c.map(a,function(d){return{name:b.name,value:d};}):{name:b.name,value:a};}).get();}});c.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){c.fn[b]=function(d){return this.bind(b,d);};});c.extend({get:function(a,b,d,f){if(c.isFunction(b)){f=f||d;d=b;b=null;}return c.ajax({type:"GET",url:a,data:b,success:d,dataType:f});},getScript:function(a,b){return c.get(a,null,b,"script");},getJSON:function(a,b,d){return c.get(a,b,d,"json");},post:function(a,b,d,f){if(c.isFunction(b)){f=f||d;d=b;b={};}return c.ajax({type:"POST",url:a,data:b,success:d,dataType:f});},ajaxSetup:function(a){c.extend(c.ajaxSettings,a);},ajaxSettings:{url:location.href,global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,xhr:A.XMLHttpRequest&&(A.location.protocol!=="file:"||!A.ActiveXObject)?function(){return new A.XMLHttpRequest;}:function(){try{return new A.ActiveXObject("Microsoft.XMLHTTP");}catch(a){}},accepts:{xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"}},lastModified:{},etag:{},ajax:function(a){function b(){e.success&&e.success.call(k,o,i,x);e.global&&f("ajaxSuccess",[x,e]);}function d(){e.complete&&e.complete.call(k,x,i);e.global&&f("ajaxComplete",[x,e]);e.global&&!--c.active&&c.event.trigger("ajaxStop");}function f(q,p){(e.context?c(e.context):c.event).trigger(q,p);}var e=c.extend(true,{},c.ajaxSettings,a),j,i,o,k=a&&a.context||e,n=e.type.toUpperCase();if(e.data&&e.processData&&typeof e.data!=="string"){e.data=c.param(e.data,e.traditional);}if(e.dataType==="jsonp"){if(n==="GET"){N.test(e.url)||(e.url+=(ka.test(e.url)?"&":"?")+(e.jsonp||"callback")+"=?");}else{if(!e.data||!N.test(e.data)){e.data=(e.data?e.data+"&":"")+(e.jsonp||"callback")+"=?";}}e.dataType="json";}if(e.dataType==="json"&&(e.data&&N.test(e.data)||N.test(e.url))){j=e.jsonpCallback||"jsonp"+sb++;if(e.data){e.data=(e.data+"").replace(N,"="+j+"$1");}e.url=e.url.replace(N,"="+j+"$1");e.dataType="script";A[j]=A[j]||function(q){o=q;b();d();A[j]=w;try{delete A[j];}catch(p){}z&&z.removeChild(C);};}if(e.dataType==="script"&&e.cache===null){e.cache=false;}if(e.cache===false&&n==="GET"){var r=J(),u=e.url.replace(wb,"$1_="+r+"$2");e.url=u+(u===e.url?(ka.test(e.url)?"&":"?")+"_="+r:"");}if(e.data&&n==="GET"){e.url+=(ka.test(e.url)?"&":"?")+e.data;}e.global&&!c.active++&&c.event.trigger("ajaxStart");r=(r=xb.exec(e.url))&&(r[1]&&r[1]!==location.protocol||r[2]!==location.host);if(e.dataType==="script"&&n==="GET"&&r){var z=s.getElementsByTagName("head")[0]||s.documentElement,C=s.createElement("script");C.src=e.url;if(e.scriptCharset){C.charset=e.scriptCharset;}if(!j){var B=false;C.onload=C.onreadystatechange=function(){if(!B&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){B=true;b();d();C.onload=C.onreadystatechange=null;z&&C.parentNode&&z.removeChild(C);}};}z.insertBefore(C,z.firstChild);return w;}var E=false,x=e.xhr();if(x){e.username?x.open(n,e.url,e.async,e.username,e.password):x.open(n,e.url,e.async);try{if(e.data||a&&a.contentType){x.setRequestHeader("Content-Type",e.contentType);}if(e.ifModified){c.lastModified[e.url]&&x.setRequestHeader("If-Modified-Since",c.lastModified[e.url]);c.etag[e.url]&&x.setRequestHeader("If-None-Match",c.etag[e.url]);}r||x.setRequestHeader("X-Requested-With","XMLHttpRequest");x.setRequestHeader("Accept",e.dataType&&e.accepts[e.dataType]?e.accepts[e.dataType]+", */*":e.accepts._default);}catch(ga){}if(e.beforeSend&&e.beforeSend.call(k,x,e)===false){e.global&&!--c.active&&c.event.trigger("ajaxStop");x.abort();return false;}e.global&&f("ajaxSend",[x,e]);var g=x.onreadystatechange=function(q){if(!x||x.readyState===0||q==="abort"){E||d();E=true;if(x){x.onreadystatechange=c.noop;}}else{if(!E&&x&&(x.readyState===4||q==="timeout")){E=true;x.onreadystatechange=c.noop;i=q==="timeout"?"timeout":!c.httpSuccess(x)?"error":e.ifModified&&c.httpNotModified(x,e.url)?"notmodified":"success";var p;if(i==="success"){try{o=c.httpData(x,e.dataType,e);}catch(v){i="parsererror";p=v;}}if(i==="success"||i==="notmodified"){j||b();}else{c.handleError(e,x,i,p);}d();q==="timeout"&&x.abort();if(e.async){x=null;}}}};try{var h=x.abort;x.abort=function(){x&&h.call(x);g("abort");};}catch(l){}e.async&&e.timeout>0&&setTimeout(function(){x&&!E&&g("timeout");},e.timeout);try{x.send(n==="POST"||n==="PUT"||n==="DELETE"?e.data:null);}catch(m){c.handleError(e,x,null,m);
d();}e.async||g();return x;}},handleError:function(a,b,d,f){if(a.error){a.error.call(a.context||a,b,d,f);}if(a.global){(a.context?c(a.context):c.event).trigger("ajaxError",[b,a,f]);}},active:0,httpSuccess:function(a){try{return !a.status&&location.protocol==="file:"||a.status>=200&&a.status<300||a.status===304||a.status===1223||a.status===0;}catch(b){}return false;},httpNotModified:function(a,b){var d=a.getResponseHeader("Last-Modified"),f=a.getResponseHeader("Etag");if(d){c.lastModified[b]=d;}if(f){c.etag[b]=f;}return a.status===304||a.status===0;},httpData:function(a,b,d){var f=a.getResponseHeader("content-type")||"",e=b==="xml"||!b&&f.indexOf("xml")>=0;a=e?a.responseXML:a.responseText;e&&a.documentElement.nodeName==="parsererror"&&c.error("parsererror");if(d&&d.dataFilter){a=d.dataFilter(a,b);}if(typeof a==="string"){if(b==="json"||!b&&f.indexOf("json")>=0){a=c.parseJSON(a);}else{if(b==="script"||!b&&f.indexOf("javascript")>=0){c.globalEval(a);}}}return a;},param:function(a,b){function d(i,o){if(c.isArray(o)){c.each(o,function(k,n){b||/\[\]$/.test(i)?f(i,n):d(i+"["+(typeof n==="object"||c.isArray(n)?k:"")+"]",n);});}else{!b&&o!=null&&typeof o==="object"?c.each(o,function(k,n){d(i+"["+k+"]",n);}):f(i,o);}}function f(i,o){o=c.isFunction(o)?o():o;e[e.length]=encodeURIComponent(i)+"="+encodeURIComponent(o);}var e=[];if(b===w){b=c.ajaxSettings.traditional;}if(c.isArray(a)||a.jquery){c.each(a,function(){f(this.name,this.value);});}else{for(var j in a){d(j,a[j]);}}return e.join("&").replace(yb,"+");}});var la={},Ab=/toggle|show|hide/,Bb=/^([+-]=)?([\d+-.]+)(.*)$/,W,va=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];c.fn.extend({show:function(a,b){if(a||a===0){return this.animate(K("show",3),a,b);}else{a=0;for(b=this.length;a<b;a++){var d=c.data(this[a],"olddisplay");this[a].style.display=d||"";if(c.css(this[a],"display")==="none"){d=this[a].nodeName;var f;if(la[d]){f=la[d];}else{var e=c("<"+d+" />").appendTo("body");f=e.css("display");if(f==="none"){f="block";}e.remove();la[d]=f;}c.data(this[a],"olddisplay",f);}}a=0;for(b=this.length;a<b;a++){this[a].style.display=c.data(this[a],"olddisplay")||"";}return this;}},hide:function(a,b){if(a||a===0){return this.animate(K("hide",3),a,b);}else{a=0;for(b=this.length;a<b;a++){var d=c.data(this[a],"olddisplay");!d&&d!=="none"&&c.data(this[a],"olddisplay",c.css(this[a],"display"));}a=0;for(b=this.length;a<b;a++){this[a].style.display="none";}return this;}},_toggle:c.fn.toggle,toggle:function(a,b){var d=typeof a==="boolean";if(c.isFunction(a)&&c.isFunction(b)){this._toggle.apply(this,arguments);}else{a==null||d?this.each(function(){var f=d?a:c(this).is(":hidden");c(this)[f?"show":"hide"]();}):this.animate(K("toggle",3),a,b);}return this;},fadeTo:function(a,b,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,d);},animate:function(a,b,d,f){var e=c.speed(b,d,f);if(c.isEmptyObject(a)){return this.each(e.complete);}return this[e.queue===false?"each":"queue"](function(){var j=c.extend({},e),i,o=this.nodeType===1&&c(this).is(":hidden"),k=this;for(i in a){var n=i.replace(ia,ja);if(i!==n){a[n]=a[i];delete a[i];i=n;}if(a[i]==="hide"&&o||a[i]==="show"&&!o){return j.complete.call(this);}if((i==="height"||i==="width")&&this.style){j.display=c.css(this,"display");j.overflow=this.style.overflow;}if(c.isArray(a[i])){(j.specialEasing=j.specialEasing||{})[i]=a[i][1];a[i]=a[i][0];}}if(j.overflow!=null){this.style.overflow="hidden";}j.curAnim=c.extend({},a);c.each(a,function(r,u){var z=new c.fx(k,j,r);if(Ab.test(u)){z[u==="toggle"?o?"show":"hide":u](a);}else{var C=Bb.exec(u),B=z.cur(true)||0;if(C){u=parseFloat(C[2]);var E=C[3]||"px";if(E!=="px"){k.style[r]=(u||1)+E;B=(u||1)/z.cur(true)*B;k.style[r]=B+E;}if(C[1]){u=(C[1]==="-="?-1:1)*u+B;}z.custom(B,u,E);}else{z.custom(B,u,"");}}});return true;});},stop:function(a,b){var d=c.timers;a&&this.queue([]);this.each(function(){for(var f=d.length-1;f>=0;f--){if(d[f].elem===this){b&&d[f](true);d.splice(f,1);}}});b||this.dequeue();return this;}});c.each({slideDown:K("show",1),slideUp:K("hide",1),slideToggle:K("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"}},function(a,b){c.fn[a]=function(d,f){return this.animate(b,d,f);};});c.extend({speed:function(a,b,d){var f=a&&typeof a==="object"?a:{complete:d||!d&&b||c.isFunction(a)&&a,duration:a,easing:d&&b||b&&!c.isFunction(b)&&b};f.duration=c.fx.off?0:typeof f.duration==="number"?f.duration:c.fx.speeds[f.duration]||c.fx.speeds._default;f.old=f.complete;f.complete=function(){f.queue!==false&&c(this).dequeue();c.isFunction(f.old)&&f.old.call(this);};return f;},easing:{linear:function(a,b,d,f){return d+f*a;},swing:function(a,b,d,f){return(-Math.cos(a*Math.PI)/2+0.5)*f+d;}},timers:[],fx:function(a,b,d){this.options=b;this.elem=a;this.prop=d;if(!b.orig){b.orig={};}}});c.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this);(c.fx.step[this.prop]||c.fx.step._default)(this);if((this.prop==="height"||this.prop==="width")&&this.elem.style){this.elem.style.display="block";}},cur:function(a){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null)){return this.elem[this.prop];}return(a=parseFloat(c.css(this.elem,this.prop,a)))&&a>-10000?a:parseFloat(c.curCSS(this.elem,this.prop))||0;},custom:function(a,b,d){function f(j){return e.step(j);}this.startTime=J();this.start=a;this.end=b;this.unit=d||this.unit||"px";this.now=this.start;this.pos=this.state=0;var e=this;f.elem=this.elem;if(f()&&c.timers.push(f)&&!W){W=setInterval(c.fx.tick,13);}},show:function(){this.options.orig[this.prop]=c.style(this.elem,this.prop);this.options.show=true;this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());c(this.elem).show();},hide:function(){this.options.orig[this.prop]=c.style(this.elem,this.prop);this.options.hide=true;this.custom(this.cur(),0);},step:function(a){var b=J(),d=true;if(a||b>=this.options.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();this.options.curAnim[this.prop]=true;for(var f in this.options.curAnim){if(this.options.curAnim[f]!==true){d=false;}}if(d){if(this.options.display!=null){this.elem.style.overflow=this.options.overflow;a=c.data(this.elem,"olddisplay");this.elem.style.display=a?a:this.options.display;if(c.css(this.elem,"display")==="none"){this.elem.style.display="block";}}this.options.hide&&c(this.elem).hide();if(this.options.hide||this.options.show){for(var e in this.options.curAnim){c.style(this.elem,e,this.options.orig[e]);}}this.options.complete.call(this.elem);}return false;}else{e=b-this.startTime;this.state=e/this.options.duration;a=this.options.easing||(c.easing.swing?"swing":"linear");this.pos=c.easing[this.options.specialEasing&&this.options.specialEasing[this.prop]||a](this.state,e,0,1,this.options.duration);this.now=this.start+(this.end-this.start)*this.pos;this.update();}return true;}};c.extend(c.fx,{tick:function(){for(var a=c.timers,b=0;b<a.length;b++){a[b]()||a.splice(b--,1);}a.length||c.fx.stop();},stop:function(){clearInterval(W);W=null;},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){c.style(a.elem,"opacity",a.now);},_default:function(a){if(a.elem.style&&a.elem.style[a.prop]!=null){a.elem.style[a.prop]=(a.prop==="width"||a.prop==="height"?Math.max(0,a.now):a.now)+a.unit;}else{a.elem[a.prop]=a.now;}}}});if(c.expr&&c.expr.filters){c.expr.filters.animated=function(a){return c.grep(c.timers,function(b){return a===b.elem;}).length;};}c.fn.offset="getBoundingClientRect" in s.documentElement?function(a){var b=this[0];if(a){return this.each(function(e){c.offset.setOffset(this,a,e);});}if(!b||!b.ownerDocument){return null;}if(b===b.ownerDocument.body){return c.offset.bodyOffset(b);}var d=b.getBoundingClientRect(),f=b.ownerDocument;b=f.body;f=f.documentElement;return{top:d.top+(self.pageYOffset||c.support.boxModel&&f.scrollTop||b.scrollTop)-(f.clientTop||b.clientTop||0),left:d.left+(self.pageXOffset||c.support.boxModel&&f.scrollLeft||b.scrollLeft)-(f.clientLeft||b.clientLeft||0)};}:function(a){var b=this[0];if(a){return this.each(function(r){c.offset.setOffset(this,a,r);});}if(!b||!b.ownerDocument){return null;}if(b===b.ownerDocument.body){return c.offset.bodyOffset(b);}c.offset.initialize();var d=b.offsetParent,f=b,e=b.ownerDocument,j,i=e.documentElement,o=e.body;f=(e=e.defaultView)?e.getComputedStyle(b,null):b.currentStyle;for(var k=b.offsetTop,n=b.offsetLeft;(b=b.parentNode)&&b!==o&&b!==i;){if(c.offset.supportsFixedPosition&&f.position==="fixed"){break;}j=e?e.getComputedStyle(b,null):b.currentStyle;k-=b.scrollTop;n-=b.scrollLeft;if(b===d){k+=b.offsetTop;n+=b.offsetLeft;if(c.offset.doesNotAddBorder&&!(c.offset.doesAddBorderForTableAndCells&&/^t(able|d|h)$/i.test(b.nodeName))){k+=parseFloat(j.borderTopWidth)||0;n+=parseFloat(j.borderLeftWidth)||0;}f=d;d=b.offsetParent;}if(c.offset.subtractsBorderForOverflowNotVisible&&j.overflow!=="visible"){k+=parseFloat(j.borderTopWidth)||0;n+=parseFloat(j.borderLeftWidth)||0;}f=j;}if(f.position==="relative"||f.position==="static"){k+=o.offsetTop;n+=o.offsetLeft;}if(c.offset.supportsFixedPosition&&f.position==="fixed"){k+=Math.max(i.scrollTop,o.scrollTop);n+=Math.max(i.scrollLeft,o.scrollLeft);}return{top:k,left:n};};c.offset={initialize:function(){var a=s.body,b=s.createElement("div"),d,f,e,j=parseFloat(c.curCSS(a,"marginTop",true))||0;c.extend(b.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"});b.innerHTML="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";a.insertBefore(b,a.firstChild);d=b.firstChild;f=d.firstChild;e=d.nextSibling.firstChild.firstChild;this.doesNotAddBorder=f.offsetTop!==5;this.doesAddBorderForTableAndCells=e.offsetTop===5;
f.style.position="fixed";f.style.top="20px";this.supportsFixedPosition=f.offsetTop===20||f.offsetTop===15;f.style.position=f.style.top="";d.style.overflow="hidden";d.style.position="relative";this.subtractsBorderForOverflowNotVisible=f.offsetTop===-5;this.doesNotIncludeMarginInBodyOffset=a.offsetTop!==j;a.removeChild(b);c.offset.initialize=c.noop;},bodyOffset:function(a){var b=a.offsetTop,d=a.offsetLeft;c.offset.initialize();if(c.offset.doesNotIncludeMarginInBodyOffset){b+=parseFloat(c.curCSS(a,"marginTop",true))||0;d+=parseFloat(c.curCSS(a,"marginLeft",true))||0;}return{top:b,left:d};},setOffset:function(a,b,d){if(/static/.test(c.curCSS(a,"position"))){a.style.position="relative";}var f=c(a),e=f.offset(),j=parseInt(c.curCSS(a,"top",true),10)||0,i=parseInt(c.curCSS(a,"left",true),10)||0;if(c.isFunction(b)){b=b.call(a,d,e);}d={top:b.top-e.top+j,left:b.left-e.left+i};"using" in b?b.using.call(a,d):f.css(d);}};c.fn.extend({position:function(){if(!this[0]){return null;}var a=this[0],b=this.offsetParent(),d=this.offset(),f=/^body|html$/i.test(b[0].nodeName)?{top:0,left:0}:b.offset();d.top-=parseFloat(c.curCSS(a,"marginTop",true))||0;d.left-=parseFloat(c.curCSS(a,"marginLeft",true))||0;f.top+=parseFloat(c.curCSS(b[0],"borderTopWidth",true))||0;f.left+=parseFloat(c.curCSS(b[0],"borderLeftWidth",true))||0;return{top:d.top-f.top,left:d.left-f.left};},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||s.body;a&&!/^body|html$/i.test(a.nodeName)&&c.css(a,"position")==="static";){a=a.offsetParent;}return a;});}});c.each(["Left","Top"],function(a,b){var d="scroll"+b;c.fn[d]=function(f){var e=this[0],j;if(!e){return null;}if(f!==w){return this.each(function(){if(j=wa(this)){j.scrollTo(!a?f:c(j).scrollLeft(),a?f:c(j).scrollTop());}else{this[d]=f;}});}else{return(j=wa(e))?"pageXOffset" in j?j[a?"pageYOffset":"pageXOffset"]:c.support.boxModel&&j.document.documentElement[d]||j.document.body[d]:e[d];}};});c.each(["Height","Width"],function(a,b){var d=b.toLowerCase();c.fn["inner"+b]=function(){return this[0]?c.css(this[0],d,false,"padding"):null;};c.fn["outer"+b]=function(f){return this[0]?c.css(this[0],d,false,f?"margin":"border"):null;};c.fn[d]=function(f){var e=this[0];if(!e){return f==null?null:this;}if(c.isFunction(f)){return this.each(function(j){var i=c(this);i[d](f.call(this,j,i[d]()));});}return"scrollTo" in e&&e.document?e.document.compatMode==="CSS1Compat"&&e.document.documentElement["client"+b]||e.document.body["client"+b]:e.nodeType===9?Math.max(e.documentElement["client"+b],e.body["scroll"+b],e.documentElement["scroll"+b],e.body["offset"+b],e.documentElement["offset"+b]):f===w?c.css(e,d):this.css(d,typeof f==="string"?f:f+"px");};});A.jQuery=A.$=c;})(window);var requirejs,require,define;(function(){function J(b){return M.call(b)==="[object Function]";}function E(b){return M.call(b)==="[object Array]";}function Z(b,c,i){for(var j in c){if(!(j in K)&&(!(j in b)||i)){b[j]=c[j];}}return d;}function N(b,c,d){b=Error(c+"\nhttp://requirejs.org/docs/errors.html#"+b);if(d){b.originalError=d;}return b;}function $(b,c,d){var j,k,q;for(j=0;q=c[j];j++){q=typeof q==="string"?{name:q}:q;k=q.location;if(d&&(!k||k.indexOf("/")!==0&&k.indexOf(":")===-1)){k=d+"/"+(k||q.name);}b[q.name]={name:q.name,location:k||q.name,main:(q.main||"main").replace(ea,"").replace(aa,"")};}}function U(b,c){b.holdReady?b.holdReady(c):c?b.readyWait+=1:b.ready(!0);}function fa(b){function c(a,h){var e,s;if(a&&a.charAt(0)==="."){if(h){o.pkgs[h]?h=[h]:(h=h.split("/"),h=h.slice(0,h.length-1));e=a=h.concat(a.split("/"));var b;for(s=0;b=e[s];s++){if(b==="."){e.splice(s,1),s-=1;}else{if(b===".."){if(s===1&&(e[2]===".."||e[0]==="..")){break;}else{s>0&&(e.splice(s-1,2),s-=2);}}}}s=o.pkgs[e=a[0]];a=a.join("/");s&&a===e+"/"+s.main&&(a=e);}else{a.indexOf("./")===0&&(a=a.substring(2));}}return a;}function i(a,h){var e=a?a.indexOf("!"):-1,b=null,d=h?h.name:null,p=a,g,i;e!==-1&&(b=a.substring(0,e),a=a.substring(e+1,a.length));b&&(b=c(b,d));a&&(b?g=(e=l[b])&&e.normalize?e.normalize(a,function(a){return c(a,d);}):c(a,d):(g=c(a,d),i=E[g],i||(i=f.nameToUrl(a,null,h),E[g]=i)));return{prefix:b,name:g,parentMap:h,url:i,originalName:p,fullName:b?b+"!"+(g||""):g};}function j(){var a=!0,h=o.priorityWait,e,b;if(h){for(b=0;e=h[b];b++){if(!t[e]){a=!1;break;}}a&&delete o.priorityWait;}return a;}function k(a,h,e){return function(){var b=ga.call(arguments,0),c;if(e&&J(c=b[b.length-1])){c.__requireJsBuild=!0;}b.push(h);return a.apply(null,b);};}function q(a,h){var e=k(f.require,a,h);Z(e,{nameToUrl:k(f.nameToUrl,a),toUrl:k(f.toUrl,a),defined:k(f.requireDefined,a),specified:k(f.requireSpecified,a),isBrowser:d.isBrowser});return e;}function n(a){var h,e,b,c=a.callback,p=a.map,g=p.fullName,ba=a.deps;b=a.listeners;if(c&&J(c)){if(o.catchError.define){try{e=d.execCb(g,a.callback,ba,l[g]);}catch(j){h=j;}}else{e=d.execCb(g,a.callback,ba,l[g]);}if(g){(c=a.cjsModule)&&c.exports!==void 0&&c.exports!==l[g]?e=l[g]=a.cjsModule.exports:e===void 0&&a.usingExports?e=l[g]:(l[g]=e,F[g]&&(R[g]=!0));}}else{g&&(e=l[g]=c,F[g]&&(R[g]=!0));}if(C[a.id]){delete C[a.id],a.isDone=!0,f.waitCount-=1,f.waitCount===0&&(I=[]);}delete S[g];if(d.onResourceLoad&&!a.placeholder){d.onResourceLoad(f,p,a.depArray);}if(h){return e=(g?i(g).url:"")||h.fileName||h.sourceURL,b=h.moduleTree,h=N("defineerror",'Error evaluating module "'+g+'" at location "'+e+'":\n'+h+"\nfileName:"+e+"\nlineNumber: "+(h.lineNumber||h.line),h),h.moduleName=g,h.moduleTree=b,d.onError(h);}for(h=0;c=b[h];h++){c(e);}}function r(a,h){return function(e){a.depDone[h]||(a.depDone[h]=!0,a.deps[h]=e,a.depCount-=1,a.depCount||n(a));};}function v(a,h){var e=h.map,b=e.fullName,c=e.name,p=L[a]||(L[a]=l[a]),g;if(!h.loading){h.loading=!0,g=function(a){h.callback=function(){return a;};n(h);t[h.id]=!0;x();},g.fromText=function(a,h){var e=O;t[a]=!1;f.scriptCount+=1;f.fake[a]=!0;e&&(O=!1);d.exec(h);e&&(O=!0);f.completeLoad(a);},b in l?g(l[b]):p.load(c,q(e.parentMap,!0),g,o);}}function w(a){C[a.id]||(C[a.id]=a,I.push(a),f.waitCount+=1);}function D(a){this.listeners.push(a);}function u(a,h){var e=a.fullName,b=a.prefix,c=b?L[b]||(L[b]=l[b]):null,d,g;e&&(d=S[e]);if(!d&&(g=!0,d={id:(b&&!c?M+++"__p@:":"")+(e||"__r@"+M++),map:a,depCount:0,depDone:[],depCallbacks:[],deps:[],listeners:[],add:D},y[d.id]=!0,e&&(!b||L[b]))){S[e]=d;}b&&!c?(e=i(b),b in l&&!l[b]&&(delete l[b],delete P[e.url]),b=u(e,!0),b.add(function(){var b=i(a.originalName,a.parentMap),b=u(b,!0);d.placeholder=!0;b.add(function(a){d.callback=function(){return a;};n(d);});})):g&&h&&(t[d.id]=!1,f.paused.push(d),w(d));return d;}function B(a,b,e,c){var a=i(a,c),d=a.name,p=a.fullName,g=u(a),j=g.id,k=g.deps,m;if(p){if(p in l||t[j]===!0||p==="jquery"&&o.jQuery&&o.jQuery!==e().fn.jquery){return;}y[j]=!0;t[j]=!0;p==="jquery"&&e&&V(e());}g.depArray=b;g.callback=e;for(e=0;e<b.length;e++){if(j=b[e]){j=i(j,d?a:c),m=j.fullName,b[e]=m,m==="require"?k[e]=q(a):m==="exports"?(k[e]=l[p]={},g.usingExports=!0):m==="module"?g.cjsModule=k[e]={id:d,uri:d?f.nameToUrl(d,null,c):void 0,exports:l[p]}:m in l&&!(m in C)&&(!(p in F)||p in F&&R[m])?k[e]=l[m]:(p in F&&(F[m]=!0,delete l[m],P[j.url]=!1),g.depCount+=1,g.depCallbacks[e]=r(g,e),u(j,!0).add(g.depCallbacks[e]));}}g.depCount?w(g):n(g);}function m(a){B.apply(null,a);}function z(a,b){if(!a.isDone){var e=a.map.fullName,c=a.depArray,d,f,g,j;if(e){if(b[e]){return l[e];}b[e]=!0;}if(c){for(d=0;d<c.length;d++){if(f=c[d]){if((g=i(f).prefix)&&(j=C[g])&&z(j,b),(g=C[f])&&!g.isDone&&t[f]){f=z(g,b),a.depCallbacks[d](f);}}}}return e?l[e]:void 0;}}function A(){var a=o.waitSeconds*1000,b=a&&f.startTime+a<(new Date).getTime(),a="",e=!1,c=!1,i;if(!(f.pausedCount>0)){if(o.priorityWait){if(j()){x();}else{return;}}for(i in t){if(!(i in K)&&(e=!0,!t[i])){if(b){a+=i+" ";}else{c=!0;break;}}}if(e||f.waitCount){if(b&&a){return i=N("timeout","Load timeout for modules: "+a),i.requireType="timeout",i.requireModules=a,d.onError(i);}if(c||f.scriptCount){if((G||ca)&&!W){W=setTimeout(function(){W=0;A();},50);}}else{if(f.waitCount){for(H=0;a=I[H];H++){z(a,{});}f.paused.length&&x();X<5&&(X+=1,A());}X=0;d.checkReadyState();}}}}var f,x,o={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},catchError:{}},Q=[],y={require:!0,exports:!0,module:!0},E={},l={},t={},C={},I=[],P={},M=0,S={},L={},F={},R={},Y=0;V=function(a){if(!f.jQuery&&(a=a||(typeof jQuery!=="undefined"?jQuery:null))&&!(o.jQuery&&a.fn.jquery!==o.jQuery)&&("holdReady" in a||"readyWait" in a)){if(f.jQuery=a,m(["jquery",[],function(){return jQuery;}]),f.scriptCount){U(a,!0),f.jQueryIncremented=!0;}}};x=function(){var a,b,e,c,i,k;Y+=1;if(f.scriptCount<=0){f.scriptCount=0;}for(;Q.length;){if(a=Q.shift(),a[0]===null){return d.onError(N("mismatch","Mismatched anonymous define() module: "+a[a.length-1]));}else{m(a);}}if(!o.priorityWait||j()){for(;f.paused.length;){i=f.paused;f.pausedCount+=i.length;f.paused=[];for(c=0;a=i[c];c++){b=a.map,e=b.url,k=b.fullName,b.prefix?v(b.prefix,a):!P[e]&&!t[k]&&(d.load(f,k,e),e.indexOf("empty:")!==0&&(P[e]=!0));}f.startTime=(new Date).getTime();f.pausedCount-=i.length;}}Y===1&&A();Y-=1;};f={contextName:b,config:o,defQueue:Q,waiting:C,waitCount:0,specified:y,loaded:t,urlMap:E,urlFetched:P,scriptCount:0,defined:l,paused:[],pausedCount:0,plugins:L,needFullExec:F,fake:{},fullExec:R,managerCallbacks:S,makeModuleMap:i,normalize:c,configure:function(a){var b,e,c;a.baseUrl&&a.baseUrl.charAt(a.baseUrl.length-1)!=="/"&&(a.baseUrl+="/");b=o.paths;c=o.pkgs;Z(o,a,!0);if(a.paths){for(e in a.paths){e in K||(b[e]=a.paths[e]);}o.paths=b;}if((b=a.packagePaths)||a.packages){if(b){for(e in b){e in K||$(c,b[e],e);}}a.packages&&$(c,a.packages);o.pkgs=c;}if(a.priority){e=f.requireWait,f.requireWait=!1,f.takeGlobalQueue(),x(),f.require(a.priority),x(),f.requireWait=e,o.priorityWait=a.priority;}if(a.deps||a.callback){f.require(a.deps||[],a.callback);}},requireDefined:function(a,b){return i(a,b).fullName in l;},requireSpecified:function(a,b){return i(a,b).fullName in y;},require:function(a,c,e){if(typeof a==="string"){if(J(c)){return d.onError(N("requireargs","Invalid require call"));}if(d.get){return d.get(f,a,c);}c=i(a,c);a=c.fullName;return !(a in l)?d.onError(N("notloaded","Module name '"+c.fullName+"' has not been loaded yet for context: "+b)):l[a];}(a&&a.length||c)&&B(null,a,c,e);if(!f.requireWait){for(;!f.scriptCount&&f.paused.length;){f.takeGlobalQueue(),x();}}return f.require;},takeGlobalQueue:function(){T.length&&(ha.apply(f.defQueue,[f.defQueue.length-1,0].concat(T)),T=[]);},completeLoad:function(a){var b;for(f.takeGlobalQueue();Q.length;){if(b=Q.shift(),b[0]===null){b[0]=a;break;}else{if(b[0]===a){break;}else{m(b),b=null;}}}b?m(b):m([a,[],a==="jquery"&&typeof jQuery!=="undefined"?function(){return jQuery;}:null]);d.isAsync&&(f.scriptCount-=1);x();d.isAsync||(f.scriptCount-=1);},toUrl:function(a,b){var c=a.lastIndexOf("."),d=null;c!==-1&&(d=a.substring(c,a.length),a=a.substring(0,c));return f.nameToUrl(a,d,b);},nameToUrl:function(a,b,e){var i,j,k,g,l=f.config,a=c(a,e&&e.fullName);if(d.jsExtRegExp.test(a)){b=a+(b?b:"");}else{i=l.paths;j=l.pkgs;e=a.split("/");for(g=e.length;g>0;g--){if(k=e.slice(0,g).join("/"),i[k]){e.splice(0,g,i[k]);break;}else{if(k=j[k]){a=a===k.name?k.location+"/"+k.main:k.location;e.splice(0,g,a);break;}}}b=e.join("/")+(b||".js");b=(b.charAt(0)==="/"||b.match(/^\w+:/)?"":l.baseUrl)+b;}return l.urlArgs?b+((b.indexOf("?")===-1?"?":"&")+l.urlArgs):b;}};f.jQueryCheck=V;f.resume=x;return f;}function ia(){var b,c,d;if(m&&m.readyState==="interactive"){return m;}b=document.getElementsByTagName("script");for(c=b.length-1;c>-1&&(d=b[c]);c--){if(d.readyState==="interactive"){return m=d;}}return null;}var ja=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,ka=/require\(\s*["']([^'"\s]+)["']\s*\)/g,ea=/^\.\//,aa=/\.js$/,M=Object.prototype.toString,r=Array.prototype,ga=r.slice,ha=r.splice,G=!!(typeof window!=="undefined"&&navigator&&document),ca=!G&&typeof importScripts!=="undefined",la=G&&navigator.platform==="PLAYSTATION 3"?/^complete$/:/^(complete|loaded)$/,da=typeof opera!=="undefined"&&opera.toString()==="[object Opera]",K={},D={},T=[],m=null,X=0,O=!1,d,r={},I,w,u,y,v,z,A,H,B,V,W;if(typeof define==="undefined"){if(typeof requirejs!=="undefined"){if(J(requirejs)){return;}else{r=requirejs,requirejs=void 0;}}typeof require!=="undefined"&&!J(require)&&(r=require,require=void 0);d=requirejs=function(b,c,d){var j="_",k;!E(b)&&typeof b!=="string"&&(k=b,E(c)?(b=c,c=d):b=[]);if(k&&k.context){j=k.context;}d=D[j]||(D[j]=fa(j));k&&d.configure(k);return d.require(b,c);};d.config=function(b){return d(b);};require||(require=d);d.toUrl=function(b){return D._.toUrl(b);};d.version="1.0.4";d.jsExtRegExp=/^\/|:|\?|\.js$/;w=d.s={contexts:D,skipAsync:{}};if(d.isAsync=d.isBrowser=G){if(u=w.head=document.getElementsByTagName("head")[0],y=document.getElementsByTagName("base")[0]){u=w.head=y.parentNode;
}}d.onError=function(b){throw b;};d.load=function(b,c,i){d.resourcesReady(!1);b.scriptCount+=1;d.attach(i,b,c);if(b.jQuery&&!b.jQueryIncremented){U(b.jQuery,!0),b.jQueryIncremented=!0;}};define=function(b,c,d){var j,k;typeof b!=="string"&&(d=c,c=b,b=null);E(c)||(d=c,c=[]);!c.length&&J(d)&&d.length&&(d.toString().replace(ja,"").replace(ka,function(b,d){c.push(d);}),c=(d.length===1?["require"]:["require","exports","module"]).concat(c));if(O&&(j=I||ia())){b||(b=j.getAttribute("data-requiremodule")),k=D[j.getAttribute("data-requirecontext")];}(k?k.defQueue:T).push([b,c,d]);};define.amd={multiversion:!0,plugins:!0,jQuery:!0};d.exec=function(b){return eval(b);};d.execCb=function(b,c,d,j){return c.apply(j,d);};d.addScriptToDom=function(b){I=b;y?u.insertBefore(b,y):u.appendChild(b);I=null;};d.onScriptLoad=function(b){var c=b.currentTarget||b.srcElement,i;if(b.type==="load"||c&&la.test(c.readyState)){m=null,b=c.getAttribute("data-requirecontext"),i=c.getAttribute("data-requiremodule"),D[b].completeLoad(i),c.detachEvent&&!da?c.detachEvent("onreadystatechange",d.onScriptLoad):c.removeEventListener("load",d.onScriptLoad,!1);}};d.attach=function(b,c,i,j,k,m){var n;if(G){return j=j||d.onScriptLoad,n=c&&c.config&&c.config.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),n.type=k||c&&c.config.scriptType||"text/javascript",n.charset="utf-8",n.async=!w.skipAsync[b],c&&n.setAttribute("data-requirecontext",c.contextName),n.setAttribute("data-requiremodule",i),n.attachEvent&&!da?(O=!0,m?n.onreadystatechange=function(){if(n.readyState==="loaded"){n.onreadystatechange=null,n.attachEvent("onreadystatechange",j),m(n);}}:n.attachEvent("onreadystatechange",j)):n.addEventListener("load",j,!1),n.src=b,m||d.addScriptToDom(n),n;}else{ca&&(importScripts(b),c.completeLoad(i));}return null;};if(G){v=document.getElementsByTagName("script");for(H=v.length-1;H>-1&&(z=v[H]);H--){if(!u){u=z.parentNode;}if(A=z.getAttribute("data-main")){if(!r.baseUrl){v=A.split("/"),z=v.pop(),v=v.length?v.join("/")+"/":"./",r.baseUrl=v,A=z.replace(aa,"");}r.deps=r.deps?r.deps.concat(A):[A];break;}}}d.checkReadyState=function(){var b=w.contexts,c;for(c in b){if(!(c in K)&&b[c].waitCount){return;}}d.resourcesReady(!0);};d.resourcesReady=function(b){var c,i;d.resourcesDone=b;if(d.resourcesDone){for(i in b=w.contexts,b){if(!(i in K)&&(c=b[i],c.jQueryIncremented)){U(c.jQuery,!1),c.jQueryIncremented=!1;}}}};d.pageLoaded=function(){if(document.readyState!=="complete"){document.readyState="complete";}};if(G&&document.addEventListener&&!document.readyState){document.readyState="loading",window.addEventListener("load",d.pageLoaded,!1);}d(r);if(d.isAsync&&typeof setTimeout!=="undefined"){B=w.contexts[r.context||"_"],B.requireWait=!0,setTimeout(function(){B.requireWait=!1;B.takeGlobalQueue();B.scriptCount||B.resume();d.checkReadyState();},0);}}})();var iVillage=iVillage||{};iVillage={runners:{blocks:{},mixins:{}},siteName:"iVillage",timeouts:{},msie:null,msie6:null,msie7:null,msie8:null,random_avatar:function(){var avatars=["image1.png","image2.png","image3.png","image4.png"];var path="/public/images/avatars/";return(path+avatars[Math.floor(Math.random()*avatars.length)]);},omniCache:[],omniEvent:function(prop,events,message,verticalMsg,propVars){console.warn("omniEvent");try{if(s_iv&&s_iv.tl){var eventString="";if(events){if($.isArray(events)){for(var i=0;i<events.length;i++){if(events[i].toString()!=="false"){eventString+="event"+events[i].toString()+",";}}eventString=eventString.slice(0,eventString.length-1);}else{eventString="event"+events.toString();}}var cacheString=message+eventString;if(prop){cacheString=cacheString+prop+propVars.toString();}if(verticalMsg){cacheString=cacheString+verticalMsg;}if(iVillage.omniCache.length==0||iVillage.omniCache.indexOf(cacheString)===-1){iVillage.omniCache.push(cacheString);}else{return false;}if(events){s_iv.linkTrackVars="events";s_iv.linkTrackEvents=eventString;s_iv.events=s_iv.apl(s_iv.events,eventString,",",1);}if(prop){prop="prop"+prop.toString();s_iv[prop]=$.isArray(propVars)?propVars.join("|"):propVars;s_iv.linkTrackVars=s_iv.linkTrackVars!==null?s_iv.linkTrackVars+","+prop:prop;}if(verticalMsg){s_iv.eVar13=verticalMsg;s_iv.linkTrackVars=s_iv.linkTrackVars!==null?s_iv.linkTrackVars+",eVar13":"eVar13";}s_iv.tl(this,"o",message);s_iv[prop]=s_iv.linkTrackEvents=s_iv.linkTrackVars=s_iv.events=null;}}catch(e){}}};(function($){if(!Array.prototype.indexOf){Array.prototype.indexOf=function(elt){var len=this.length>>>0;var from=Number(arguments[1])||0;from=(from<0)?Math.ceil(from):Math.floor(from);if(from<0){from+=len;}for(;from<len;from++){if(from in this&&this[from]===elt){return from;}}return -1;};}iVillage.runners.global=function(){if(typeof iV_SSO!="undefined"&&iV_SSO){function preventDefault(e){e.preventDefault();}function bindSsoReady(){$("a.sso-sign-in").die("click",preventDefault).live("click",iV_SSO.login);$("a.sso-register").die("click",preventDefault).live("click",iV_SSO.register);$("a.sso-chime-in").die("click",preventDefault).live("click",iV_SSO.chime);$("a.sso-pick-avatar").die("click",preventDefault).live("click",iV_SSO.avatar);$("a.sso-logout").die("click",preventDefault).live("click",iV_SSO.logout);$("a.sso-newsletters").die("click",preventDefault).live("click",iV_SSO.newsletters);$("a.sso-upload-photo").die("click",preventDefault).live("click",iV_SSO.photo);$("a.sso-insert-photo").die("click",preventDefault).live("click",iV_SSO.insertPhoto);$("a.sso-add-save").die("click",preventDefault).live("click",iV_SSO.save);$("a.sso-delete-save").die("click",preventDefault).live("click",iV_SSO.deleteSave);$("a.sso-insert-save").die("click",preventDefault).live("click",iV_SSO.insertSave);$("a.sso-join-finish").die("click",preventDefault).live("click",iV_SSO.completeRegistration);$("ul.network-hat-buttons").fadeIn("slow");$(".iv_top .userbox .user-info-div").fadeIn("slow");if(typeof(ugc_data)!="undefined"&&(typeof(ugc_data.ugc_closed)=="undefined"||!ugc_data.ugc_closed)){$("a.sso_ugc_upload_link").die("click",preventDefault).live("click",iV_SSO.uploadUGC);}else{if(typeof(ugc_data)!="undefined"){$("a.sso_ugc_upload_link").die("click",function preventDefault(e){e.preventDefault();}).live("click",iV_SSO.uploadUGC);}}}$("a.sso-sign-in").live("click",preventDefault);$("a.sso-fb").live("click",preventDefault);$("a.sso-register").live("click",preventDefault);$("a.sso-chime-in").live("click",preventDefault);$("a.sso-pick-avatar").live("click",preventDefault);$("a.sso-logout").live("click",preventDefault);$("a.sso-newsletters").live("click",preventDefault);$("a.sso-upload-photo").live("click",preventDefault);$("a.sso-insert-photo").live("click",preventDefault);$("a.sso-add-save").live("click",preventDefault);$("a.sso-delete-save").live("click",preventDefault);$("a.sso-insert-save").live("click",preventDefault);$("a.sso-join-finish").live("click",preventDefault);$("a.sso_ugc_upload_link").live("click",preventDefault);iV_SSO.init({baseUrl:"/",vertical:iVillage.vertical_id});$(document).bind("sso.ready",bindSsoReady);}if(typeof(iV_SocialLife)!="undefined"){iV_SocialLife.init({});}if(typeof iVillage.loyalty!="undefined"){iVillage.loyalty.init({});}if(typeof iVillage.sweepstakes!="undefined"&&$(".sweeps-container").length>0){iVillage.sweepstakes.init({});}iVillage.msie=$.browser.msie;iVillage.msie6=iVillage.msie&&parseInt($.browser.version,10)===6;iVillage.msie7=iVillage.msie&&parseInt($.browser.version,10)===7;iVillage.msie8=iVillage.msie&&parseInt($.browser.version,10)===8;$("#network > ul > li > a, clearfix").bind("mouseover",function(){$(this).removeClass("opacity30");$(this).parent().removeClass("opacity30");}).bind("mouseout",function(){$(this).addClass("opacity30");$(this).parent().addClass("opacity30");});if(iVillage.msie6){$(".pngfix").ifixpng();}$(".label-hide").labelHide();$(".clear-default").clearDefault();$(".block-submit").blockSubmit();$(".input-rollover").inputRollover();$(".equalize").equalizeChildHeights();(function(){var typeahead_url="/search-ahead";$('form[name="ivSearchForm"]').each(function(){var $that=$(this),action=$that.attr("action"),$input=$that.find('input[type="text"]').first();$input.autocomplete(typeahead_url,{autoFill:true,minChars:2,extraParams:{action:action},scrollHeight:500,width:$input.outerWidth()});});})();};})(jQuery);function StringBuffer(){this.buffer=[];}StringBuffer.prototype.append=function append(string){this.buffer.push(string);return this;};StringBuffer.prototype.toString=function toString(){return this.buffer.join("");};var globalargs=null;String.prototype.ReplaceAll=function(stringToFind,stringToReplace){globalargs=arguments;var temp=this;var index=temp.indexOf(stringToFind);while(index!=-1){temp=temp.replace(stringToFind,stringToReplace);index=temp.indexOf(stringToFind);}return temp;};function isNegative(n){var num=Number(n);if(isNaN(num)){return false;}return(Math.abs(num)!=num)?true:false;}var randomOrd=Math.floor(Math.random()*10000000000);jQuery.ui||(function(b){var a=b.browser.mozilla&&(parseFloat(b.browser.version)<1.9);b.ui={version:"1.8rc3",plugin:{add:function(d,e,g){var f=b.ui[d].prototype;for(var c in g){f.plugins[c]=f.plugins[c]||[];f.plugins[c].push([e,g[c]]);}},call:function(c,e,d){var g=c.plugins[e];if(!g||!c.element[0].parentNode){return;}for(var f=0;f<g.length;f++){if(c.options[g[f][0]]){g[f][1].apply(c.element,d);}}}},contains:function(d,c){return document.compareDocumentPosition?d.compareDocumentPosition(c)&16:d!==c&&d.contains(c);},hasScroll:function(f,d){if(b(f).css("overflow")=="hidden"){return false;}var c=(d&&d=="left")?"scrollLeft":"scrollTop",e=false;if(f[c]>0){return true;}f[c]=1;e=(f[c]>0);f[c]=0;return e;},isOverAxis:function(d,c,e){return(d>c)&&(d<(c+e));},isOver:function(h,d,g,f,c,e){return b.ui.isOverAxis(h,g,c)&&b.ui.isOverAxis(d,f,e);},keyCode:{BACKSPACE:8,CAPS_LOCK:20,COMMA:188,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38}};b.fn.extend({_focus:b.fn.focus,focus:function(c,d){return typeof c==="number"?this.each(function(){var e=this;setTimeout(function(){b(e).focus();(d&&d.call(e));},c);}):this._focus.apply(this,arguments);},enableSelection:function(){return this.attr("unselectable","off").css("MozUserSelect","").unbind("selectstart.ui");},disableSelection:function(){return this.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return false;});},scrollParent:function(){var c;if((b.browser.msie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){c=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test(b.curCSS(this,"position",1))&&(/(auto|scroll)/).test(b.curCSS(this,"overflow",1)+b.curCSS(this,"overflow-y",1)+b.curCSS(this,"overflow-x",1));}).eq(0);}else{c=this.parents().filter(function(){return(/(auto|scroll)/).test(b.curCSS(this,"overflow",1)+b.curCSS(this,"overflow-y",1)+b.curCSS(this,"overflow-x",1));}).eq(0);}return(/fixed/).test(this.css("position"))||!c.length?b(document):c;},zIndex:function(f){if(f!==undefined){return this.css("zIndex",f);}if(this.length){var d=b(this[0]),c,e;while(d.length&&d[0]!==document){c=d.css("position");if(c=="absolute"||c=="relative"||c=="fixed"){e=parseInt(d.css("zIndex"));if(!isNaN(e)&&e!=0){return e;}}d=d.parent();}}return 0;}});b.extend(b.expr[":"],{data:function(e,d,c){return !!b.data(e,c[3]);},focusable:function(d){var e=d.nodeName.toLowerCase(),c=b.attr(d,"tabindex");return(/input|select|textarea|button|object/.test(e)?!d.disabled:"a"==e||"area"==e?d.href||!isNaN(c):!isNaN(c))&&!b(d)["area"==e?"parents":"closest"](":hidden").length;},tabbable:function(d){var c=b.attr(d,"tabindex");return(isNaN(c)||c>=0)&&b(d).is(":focusable");}});})(jQuery);(function(b){var a=b.fn.remove;b.fn.remove=function(c,d){return this.each(function(){if(!d){if(!c||b.filter(c,[this]).length){b("*",this).add(this).each(function(){b(this).triggerHandler("remove");});}}return a.call(b(this),c,d);});};b.widget=function(d,f,c){var e=d.split(".")[0],h;d=d.split(".")[1];h=e+"-"+d;if(!c){c=f;f=b.Widget;}b.expr[":"][h]=function(i){return !!b.data(i,d);};b[e]=b[e]||{};b[e][d]=function(i,j){if(arguments.length){this._createWidget(i,j);}};var g=new f();g.options=b.extend({},g.options);b[e][d].prototype=b.extend(true,g,{namespace:e,widgetName:d,widgetEventPrefix:b[e][d].prototype.widgetEventPrefix||d,widgetBaseClass:h},c);b.widget.bridge(d,b[e][d]);};b.widget.bridge=function(d,c){b.fn[d]=function(g){var e=typeof g==="string",f=Array.prototype.slice.call(arguments,1),h=this;g=!e&&f.length?b.extend.apply(null,[true,g].concat(f)):g;if(e&&g.substring(0,1)==="_"){return h;}if(e){this.each(function(){var i=b.data(this,d),j=i&&b.isFunction(i[g])?i[g].apply(i,f):i;if(j!==i&&j!==undefined){h=j;return false;}});}else{this.each(function(){var i=b.data(this,d);if(i){if(g){i.option(g);}i._init();}else{b.data(this,d,new c(g,this));}});}return h;};};b.Widget=function(c,d){if(arguments.length){this._createWidget(c,d);}};b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(d,e){this.element=b(e).data(this.widgetName,this);this.options=b.extend(true,{},this.options,b.metadata&&b.metadata.get(e)[this.widgetName],d);var c=this;this.element.bind("remove."+this.widgetName,function(){c.destroy();});this._create();this._init();},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled "+this.namespace+"-state-disabled");},widget:function(){return this.element;},option:function(e,f){var d=e,c=this;if(arguments.length===0){return b.extend({},c.options);}if(typeof e==="string"){if(f===undefined){return this.options[e];}d={};d[e]=f;}b.each(d,function(g,h){c._setOption(g,h);});return c;},_setOption:function(c,d){this.options[c]=d;if(c==="disabled"){this.widget()[d?"addClass":"removeClass"](this.widgetBaseClass+"-disabled "+this.namespace+"-state-disabled").attr("aria-disabled",d);}return this;},enable:function(){return this._setOption("disabled",false);},disable:function(){return this._setOption("disabled",true);},_trigger:function(d,e,f){var h=this.options[d];e=b.Event(e);e.type=(d===this.widgetEventPrefix?d:this.widgetEventPrefix+d).toLowerCase();f=f||{};if(e.originalEvent){for(var c=b.event.props.length,g;c;){g=b.event.props[--c];e[g]=e.originalEvent[g];}}this.element.trigger(e,f);return !(b.isFunction(h)&&h.call(this.element[0],e,f)===false||e.isDefaultPrevented());}};})(jQuery);(function(b){var a=0;b.widget("ui.tabs",{options:{add:null,ajaxOptions:null,cache:false,cookie:null,collapsible:false,disable:null,disabled:[],enable:null,event:"click",fx:null,idPrefix:"ui-tabs-",load:null,panelTemplate:"<div></div>",remove:null,select:null,show:null,spinner:"<em>Loading&#8230;</em>",tabTemplate:'<li><a href="#{href}"><span>#{label}</span></a></li>'},_create:function(){this._tabify(true);},_setOption:function(c,d){if(c=="selected"){if(this.options.collapsible&&d==this.options.selected){return;}this.select(d);}else{this.options[c]=d;this._tabify();}},_tabId:function(c){return c.title&&c.title.replace(/\s/g,"_").replace(/[^A-Za-z0-9\-_:\.]/g,"")||this.options.idPrefix+(++a);},_sanitizeSelector:function(c){return c.replace(/:/g,"\\:");},_cookie:function(){var c=this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+b.data(this.list[0]));return b.cookie.apply(null,[c].concat(b.makeArray(arguments)));},_ui:function(d,c){return{tab:d,panel:c,index:this.anchors.index(d)};},_cleanup:function(){this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function(){var c=b(this);c.html(c.data("label.tabs")).removeData("label.tabs");});},_tabify:function(p){this.list=this.element.find("ol,ul").eq(0);this.lis=b("li:has(a[href])",this.list);this.anchors=this.lis.map(function(){return b("a",this)[0];});this.panels=b([]);var q=this,e=this.options;var d=/^#.+/;this.anchors.each(function(s,o){var r=b(o).attr("href");var u=r.split("#")[0],v;if(u&&(u===location.toString().split("#")[0]||(v=b("base")[0])&&u===v.href)){r=o.hash;o.href=r;}if(d.test(r)){q.panels=q.panels.add(q._sanitizeSelector(r));}else{if(r!="#"){b.data(o,"href.tabs",r);b.data(o,"load.tabs",r.replace(/#.*$/,""));var x=q._tabId(o);o.href="#"+x;var w=b("#"+x);if(!w.length){w=b(e.panelTemplate).attr("id",x).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(q.panels[s-1]||q.list);w.data("destroy.tabs",true);}q.panels=q.panels.add(w);}else{e.disabled.push(s);}}});if(p){this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.lis.addClass("ui-state-default ui-corner-top");this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom");if(e.selected===undefined){if(location.hash){this.anchors.each(function(r,o){if(o.hash==location.hash){e.selected=r;return false;}});}if(typeof e.selected!="number"&&e.cookie){e.selected=parseInt(q._cookie(),10);}if(typeof e.selected!="number"&&this.lis.filter(".ui-tabs-selected").length){e.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"));}e.selected=e.selected||(this.lis.length?0:-1);}else{if(e.selected===null){e.selected=-1;}}e.selected=((e.selected>=0&&this.anchors[e.selected])||e.selected<0)?e.selected:0;e.disabled=b.unique(e.disabled.concat(b.map(this.lis.filter(".ui-state-disabled"),function(r,o){return q.lis.index(r);}))).sort();if(b.inArray(e.selected,e.disabled)!=-1){e.disabled.splice(b.inArray(e.selected,e.disabled),1);}this.panels.addClass("ui-tabs-hide");this.lis.removeClass("ui-tabs-selected ui-state-active");if(e.selected>=0&&this.anchors.length){this.panels.eq(e.selected).removeClass("ui-tabs-hide");this.lis.eq(e.selected).addClass("ui-tabs-selected ui-state-active");q.element.queue("tabs",function(){q._trigger("show",null,q._ui(q.anchors[e.selected],q.panels[e.selected]));});this.load(e.selected);}b(window).bind("unload",function(){q.lis.add(q.anchors).unbind(".tabs");q.lis=q.anchors=q.panels=null;});}else{e.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"));}this.element[e.collapsible?"addClass":"removeClass"]("ui-tabs-collapsible");if(e.cookie){this._cookie(e.selected,e.cookie);}for(var h=0,n;(n=this.lis[h]);h++){b(n)[b.inArray(h,e.disabled)!=-1&&!b(n).hasClass("ui-tabs-selected")?"addClass":"removeClass"]("ui-state-disabled");}if(e.cache===false){this.anchors.removeData("cache.tabs");}this.lis.add(this.anchors).unbind(".tabs");if(e.event!="mouseover"){var g=function(o,i){if(i.is(":not(.ui-state-disabled)")){i.addClass("ui-state-"+o);}};var k=function(o,i){i.removeClass("ui-state-"+o);};this.lis.bind("mouseover.tabs",function(){g("hover",b(this));});this.lis.bind("mouseout.tabs",function(){k("hover",b(this));});this.anchors.bind("focus.tabs",function(){g("focus",b(this).closest("li"));});this.anchors.bind("blur.tabs",function(){k("focus",b(this).closest("li"));});}var c,j;if(e.fx){if(b.isArray(e.fx)){c=e.fx[0];j=e.fx[1];}else{c=j=e.fx;}}function f(i,o){i.css({display:""});if(!b.support.opacity&&o.opacity){i[0].style.removeAttribute("filter");}}var l=j?function(i,o){b(i).closest("li").addClass("ui-tabs-selected ui-state-active");o.hide().removeClass("ui-tabs-hide").animate(j,j.duration||"normal",function(){f(o,j);q._trigger("show",null,q._ui(i,o[0]));});}:function(i,o){b(i).closest("li").addClass("ui-tabs-selected ui-state-active");o.removeClass("ui-tabs-hide");q._trigger("show",null,q._ui(i,o[0]));};var m=c?function(o,i){i.animate(c,c.duration||"normal",function(){q.lis.removeClass("ui-tabs-selected ui-state-active");i.addClass("ui-tabs-hide");f(i,c);q.element.dequeue("tabs");});}:function(o,i,r){q.lis.removeClass("ui-tabs-selected ui-state-active");i.addClass("ui-tabs-hide");q.element.dequeue("tabs");};this.anchors.bind(e.event+".tabs",function(){var o=this,s=b(this).closest("li"),i=q.panels.filter(":not(.ui-tabs-hide)"),r=b(q._sanitizeSelector(this.hash));if((s.hasClass("ui-tabs-selected")&&!e.collapsible)||s.hasClass("ui-state-disabled")||s.hasClass("ui-state-processing")||q._trigger("select",null,q._ui(this,r[0]))===false){this.blur();return false;}e.selected=q.anchors.index(this);q.abort();if(e.collapsible){if(s.hasClass("ui-tabs-selected")){e.selected=-1;if(e.cookie){q._cookie(e.selected,e.cookie);}q.element.queue("tabs",function(){m(o,i);}).dequeue("tabs");this.blur();return false;}else{if(!i.length){if(e.cookie){q._cookie(e.selected,e.cookie);}q.element.queue("tabs",function(){l(o,r);});q.load(q.anchors.index(this));this.blur();return false;}}}if(e.cookie){q._cookie(e.selected,e.cookie);}if(r.length){if(i.length){q.element.queue("tabs",function(){m(o,i);});}q.element.queue("tabs",function(){l(o,r);});q.load(q.anchors.index(this));}else{throw"jQuery UI Tabs: Mismatching fragment identifier.";}if(b.browser.msie){this.blur();}});this.anchors.bind("click.tabs",function(){return false;});},destroy:function(){var c=this.options;this.abort();this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs");this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.anchors.each(function(){var d=b.data(this,"href.tabs");if(d){this.href=d;}var e=b(this).unbind(".tabs");b.each(["href","load","cache"],function(f,g){e.removeData(g+".tabs");});});this.lis.unbind(".tabs").add(this.panels).each(function(){if(b.data(this,"destroy.tabs")){b(this).remove();}else{b(this).removeClass(["ui-state-default","ui-corner-top","ui-tabs-selected","ui-state-active","ui-state-hover","ui-state-focus","ui-state-disabled","ui-tabs-panel","ui-widget-content","ui-corner-bottom","ui-tabs-hide"].join(" "));}});if(c.cookie){this._cookie(null,c.cookie);}return this;},add:function(f,e,d){if(d===undefined){d=this.anchors.length;}var c=this,h=this.options,j=b(h.tabTemplate.replace(/#\{href\}/g,f).replace(/#\{label\}/g,e)),i=!f.indexOf("#")?f.replace("#",""):this._tabId(b("a",j)[0]);j.addClass("ui-state-default ui-corner-top").data("destroy.tabs",true);var g=b("#"+i);if(!g.length){g=b(h.panelTemplate).attr("id",i).data("destroy.tabs",true);}g.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide");if(d>=this.lis.length){j.appendTo(this.list);g.appendTo(this.list[0].parentNode);}else{j.insertBefore(this.lis[d]);g.insertBefore(this.panels[d]);}h.disabled=b.map(h.disabled,function(l,k){return l>=d?++l:l;});this._tabify();if(this.anchors.length==1){h.selected=0;j.addClass("ui-tabs-selected ui-state-active");g.removeClass("ui-tabs-hide");this.element.queue("tabs",function(){c._trigger("show",null,c._ui(c.anchors[0],c.panels[0]));});this.load(0);}this._trigger("add",null,this._ui(this.anchors[d],this.panels[d]));return this;},remove:function(c){var e=this.options,f=this.lis.eq(c).remove(),d=this.panels.eq(c).remove();if(f.hasClass("ui-tabs-selected")&&this.anchors.length>1){this.select(c+(c+1<this.anchors.length?1:-1));}e.disabled=b.map(b.grep(e.disabled,function(h,g){return h!=c;}),function(h,g){return h>=c?--h:h;});this._tabify();this._trigger("remove",null,this._ui(f.find("a")[0],d[0]));return this;},enable:function(c){var d=this.options;if(b.inArray(c,d.disabled)==-1){return;}this.lis.eq(c).removeClass("ui-state-disabled");d.disabled=b.grep(d.disabled,function(f,e){return f!=c;});this._trigger("enable",null,this._ui(this.anchors[c],this.panels[c]));return this;},disable:function(d){var c=this,e=this.options;if(d!=e.selected){this.lis.eq(d).addClass("ui-state-disabled");e.disabled.push(d);e.disabled.sort();this._trigger("disable",null,this._ui(this.anchors[d],this.panels[d]));}return this;},select:function(c){if(typeof c=="string"){c=this.anchors.index(this.anchors.filter("[href$="+c+"]"));}else{if(c===null){c=-1;}}if(c==-1&&this.options.collapsible){c=this.options.selected;}this.anchors.eq(c).trigger(this.options.event+".tabs");return this;},load:function(f){var d=this,h=this.options,c=this.anchors.eq(f)[0],e=b.data(c,"load.tabs");this.abort();if(!e||this.element.queue("tabs").length!==0&&b.data(c,"cache.tabs")){this.element.dequeue("tabs");return;}this.lis.eq(f).addClass("ui-state-processing");if(h.spinner){var g=b("span",c);g.data("label.tabs",g.html()).html(h.spinner);}this.xhr=b.ajax(b.extend({},h.ajaxOptions,{url:e,success:function(j,i){b(d._sanitizeSelector(c.hash)).html(j);d._cleanup();if(h.cache){b.data(c,"cache.tabs",true);}d._trigger("load",null,d._ui(d.anchors[f],d.panels[f]));
try{h.ajaxOptions.success(j,i);}catch(k){}},error:function(k,i,j){d._cleanup();d._trigger("load",null,d._ui(d.anchors[f],d.panels[f]));try{h.ajaxOptions.error(k,i,f,c);}catch(j){}}}));d.element.dequeue("tabs");return this;},abort:function(){this.element.queue([]);this.panels.stop(false,true);this.element.queue("tabs",this.element.queue("tabs").splice(-2,2));if(this.xhr){this.xhr.abort();delete this.xhr;}this._cleanup();return this;},url:function(d,c){this.anchors.eq(d).removeData("cache.tabs").data("load.tabs",c);return this;},length:function(){return this.anchors.length;}});b.extend(b.ui.tabs,{version:"1.8rc3"});b.extend(b.ui.tabs.prototype,{rotation:null,rotate:function(e,g){var c=this,h=this.options;var d=c._rotate||(c._rotate=function(i){clearTimeout(c.rotation);c.rotation=setTimeout(function(){var j=h.selected;c.select(++j<c.anchors.length?j:0);},e);if(i){i.stopPropagation();}});var f=c._unrotate||(c._unrotate=!g?function(i){if(i.clientX){c.rotate(null);}}:function(i){t=h.selected;d();});if(e){this.element.bind("tabsshow",d);this.anchors.bind(h.event+".tabs",f);d();}else{clearTimeout(c.rotation);this.element.unbind("tabsshow",d);this.anchors.unbind(h.event+".tabs",f);delete this._rotate;delete this._unrotate;}return this;}});})(jQuery);(function($){$.fn.hoverIntent=function(f,g){var cfg={sensitivity:7,interval:100,timeout:0};cfg=$.extend(cfg,g?{over:f,out:g}:f);var cX,cY,pX,pY;var track=function(ev){cX=ev.pageX;cY=ev.pageY;};var compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if((Math.abs(pX-cX)+Math.abs(pY-cY))<cfg.sensitivity){$(ob).unbind("mousemove",track);ob.hoverIntent_s=1;return cfg.over.apply(ob,[ev]);}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob);},cfg.interval);}};var delay=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=0;return cfg.out.apply(ob,[ev]);};var handleHover=function(e){var p=(e.type=="mouseover"?e.fromElement:e.toElement)||e.relatedTarget;while(p&&p!=this){try{p=p.parentNode;}catch(e){p=this;}}if(p==this){return false;}var ev=jQuery.extend({},e);var ob=this;if(ob.hoverIntent_t){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);}if(e.type=="mouseover"){pX=ev.pageX;pY=ev.pageY;$(ob).bind("mousemove",track);if(ob.hoverIntent_s!=1){ob.hoverIntent_t=setTimeout(function(){compare(ev,ob);},cfg.interval);}}else{$(ob).unbind("mousemove",track);if(ob.hoverIntent_s==1){ob.hoverIntent_t=setTimeout(function(){delay(ev,ob);},cfg.timeout);}}};return this.mouseover(handleHover).mouseout(handleHover);};})(jQuery);(function($){$.extend($.fn,{validate:function(options){if(!this.length){options&&options.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing");return;}var validator=$.data(this[0],"validator");if(validator){return validator;}validator=new $.validator(options,this[0]);$.data(this[0],"validator",validator);if(validator.settings.onsubmit){this.find("input, button").filter(".cancel").click(function(){validator.cancelSubmit=true;});if(validator.settings.submitHandler){this.find("input, button").filter(":submit").click(function(){validator.submitButton=this;});}this.submit(function(event){if(validator.settings.debug){event.preventDefault();}function handle(){if(validator.settings.submitHandler){if(validator.submitButton){var hidden=$("<input type='hidden'/>").attr("name",validator.submitButton.name).val(validator.submitButton.value).appendTo(validator.currentForm);}validator.settings.submitHandler.call(validator,validator.currentForm);if(validator.submitButton){hidden.remove();}return false;}return true;}if(validator.cancelSubmit){validator.cancelSubmit=false;return handle();}if(validator.form()){if(validator.pendingRequest){validator.formSubmitted=true;return false;}return handle();}else{validator.focusInvalid();return false;}});}return validator;},valid:function(){if($(this[0]).is("form")){return this.validate().form();}else{var valid=true;var validator=$(this[0].form).validate();this.each(function(){valid&=validator.element(this);});return valid;}},removeAttrs:function(attributes){var result={},$element=this;$.each(attributes.split(/\s/),function(index,value){result[value]=$element.attr(value);$element.removeAttr(value);});return result;},rules:function(command,argument){var element=this[0];if(command){var settings=$.data(element.form,"validator").settings;var staticRules=settings.rules;var existingRules=$.validator.staticRules(element);switch(command){case"add":$.extend(existingRules,$.validator.normalizeRule(argument));staticRules[element.name]=existingRules;if(argument.messages){settings.messages[element.name]=$.extend(settings.messages[element.name],argument.messages);}break;case"remove":if(!argument){delete staticRules[element.name];return existingRules;}var filtered={};$.each(argument.split(/\s/),function(index,method){filtered[method]=existingRules[method];delete existingRules[method];});return filtered;}}var data=$.validator.normalizeRules($.extend({},$.validator.metadataRules(element),$.validator.classRules(element),$.validator.attributeRules(element),$.validator.staticRules(element)),element);if(data.required){var param=data.required;delete data.required;data=$.extend({required:param},data);}return data;}});$.extend($.expr[":"],{blank:function(a){return !$.trim(""+a.value);},filled:function(a){return !!$.trim(""+a.value);},unchecked:function(a){return !a.checked;}});$.validator=function(options,form){this.settings=$.extend(true,{},$.validator.defaults,options);this.currentForm=form;this.init();};$.validator.format=function(source,params){if(arguments.length==1){return function(){var args=$.makeArray(arguments);args.unshift(source);return $.validator.format.apply(this,args);};}if(arguments.length>2&&params.constructor!=Array){params=$.makeArray(arguments).slice(1);}if(params.constructor!=Array){params=[params];}$.each(params,function(i,n){source=source.replace(new RegExp("\\{"+i+"\\}","g"),n);});return source;};$.extend($.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:true,errorContainer:$([]),errorLabelContainer:$([]),onsubmit:true,ignore:[],ignoreTitle:false,onfocusin:function(element){this.lastActive=element;if(this.settings.focusCleanup&&!this.blockFocusCleanup){this.settings.unhighlight&&this.settings.unhighlight.call(this,element,this.settings.errorClass,this.settings.validClass);this.errorsFor(element).hide();}},onfocusout:function(element){if(!this.checkable(element)&&(element.name in this.submitted||!this.optional(element))){this.element(element);}},onkeyup:function(element){if(element.name in this.submitted||element==this.lastElement){this.element(element);}},onclick:function(element){if(element.name in this.submitted){this.element(element);}else{if(element.parentNode.name in this.submitted){this.element(element.parentNode);}}},highlight:function(element,errorClass,validClass){$(element).addClass(errorClass).removeClass(validClass);},unhighlight:function(element,errorClass,validClass){$(element).removeClass(errorClass).addClass(validClass);}},setDefaults:function(settings){$.extend($.validator.defaults,settings);},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:$.validator.format("Please enter no more than {0} characters."),minlength:$.validator.format("Please enter at least {0} characters."),rangelength:$.validator.format("Please enter a value between {0} and {1} characters long."),range:$.validator.format("Please enter a value between {0} and {1}."),max:$.validator.format("Please enter a value less than or equal to {0}."),min:$.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:false,prototype:{init:function(){this.labelContainer=$(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&this.labelContainer||$(this.currentForm);this.containers=$(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var groups=(this.groups={});$.each(this.settings.groups,function(key,value){$.each(value.split(/\s/),function(index,name){groups[name]=key;});});var rules=this.settings.rules;$.each(rules,function(key,value){rules[key]=$.validator.normalizeRule(value);});function delegate(event){var validator=$.data(this[0].form,"validator"),eventType="on"+event.type.replace(/^validate/,"");validator.settings[eventType]&&validator.settings[eventType].call(validator,this[0]);}$(this.currentForm).validateDelegate(":text, :password, :file, select, textarea","focusin focusout keyup",delegate).validateDelegate(":radio, :checkbox, select, option","click",delegate);if(this.settings.invalidHandler){$(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler);}},form:function(){this.checkForm();$.extend(this.submitted,this.errorMap);this.invalid=$.extend({},this.errorMap);if(!this.valid()){$(this.currentForm).triggerHandler("invalid-form",[this]);}this.showErrors();return this.valid();},checkForm:function(){this.prepareForm();for(var i=0,elements=(this.currentElements=this.elements());elements[i];i++){this.check(elements[i]);}return this.valid();},element:function(element){element=this.clean(element);this.lastElement=element;this.prepareElement(element);this.currentElements=$(element);var result=this.check(element);if(result){delete this.invalid[element.name];}else{this.invalid[element.name]=true;}if(!this.numberOfInvalids()){this.toHide=this.toHide.add(this.containers);}this.showErrors();return result;},showErrors:function(errors){if(errors){$.extend(this.errorMap,errors);this.errorList=[];for(var name in errors){this.errorList.push({message:errors[name],element:this.findByName(name)[0]});}this.successList=$.grep(this.successList,function(element){return !(element.name in errors);});}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors();},resetForm:function(){if($.fn.resetForm){$(this.currentForm).resetForm();}this.submitted={};this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass);},numberOfInvalids:function(){return this.objectLength(this.invalid);},objectLength:function(obj){var count=0;for(var i in obj){count++;}return count;},hideErrors:function(){this.addWrapper(this.toHide).hide();},valid:function(){return this.size()==0;},size:function(){return this.errorList.length;},focusInvalid:function(){if(this.settings.focusInvalid){try{$(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin");}catch(e){}}},findLastActive:function(){var lastActive=this.lastActive;return lastActive&&$.grep(this.errorList,function(n){return n.element.name==lastActive.name;}).length==1&&lastActive;},elements:function(){var validator=this,rulesCache={};return $([]).add(this.currentForm.elements).filter(":input").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){!this.name&&validator.settings.debug&&window.console&&console.error("%o has no name assigned",this);if(this.name in rulesCache||!validator.objectLength($(this).rules())){return false;}rulesCache[this.name]=true;return true;});},clean:function(selector){return $(selector)[0];},errors:function(){return $(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext);},reset:function(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=$([]);this.toHide=$([]);this.currentElements=$([]);},prepareForm:function(){this.reset();this.toHide=this.errors().add(this.containers);},prepareElement:function(element){this.reset();this.toHide=this.errorsFor(element);},check:function(element){element=this.clean(element);if(this.checkable(element)){element=this.findByName(element.name)[0];}var rules=$(element).rules();var dependencyMismatch=false;for(method in rules){var rule={method:method,parameters:rules[method]};try{var result=$.validator.methods[method].call(this,element.value.replace(/\r/g,""),element,rule.parameters);if(result=="dependency-mismatch"){dependencyMismatch=true;
continue;}dependencyMismatch=false;if(result=="pending"){this.toHide=this.toHide.not(this.errorsFor(element));return;}if(!result){this.formatAndAdd(element,rule);return false;}}catch(e){this.settings.debug&&window.console&&console.log("exception occured when checking element "+element.id+", check the '"+rule.method+"' method",e);throw e;}}if(dependencyMismatch){return;}if(this.objectLength(rules)){this.successList.push(element);}return true;},customMetaMessage:function(element,method){if(!$.metadata){return;}var meta=this.settings.meta?$(element).metadata()[this.settings.meta]:$(element).metadata();return meta&&meta.messages&&meta.messages[method];},customMessage:function(name,method){var m=this.settings.messages[name];return m&&(m.constructor==String?m:m[method]);},findDefined:function(){for(var i=0;i<arguments.length;i++){if(arguments[i]!==undefined){return arguments[i];}}return undefined;},defaultMessage:function(element,method){return this.findDefined(this.customMessage(element.name,method),this.customMetaMessage(element,method),!this.settings.ignoreTitle&&element.title||undefined,$.validator.messages[method],"<strong>Warning: No message defined for "+element.name+"</strong>");},formatAndAdd:function(element,rule){var message=this.defaultMessage(element,rule.method),theregex=/\$?\{(\d+)\}/g;if(typeof message=="function"){message=message.call(this,rule.parameters,element);}else{if(theregex.test(message)){message=jQuery.format(message.replace(theregex,"{$1}"),rule.parameters);}}this.errorList.push({message:message,element:element});this.errorMap[element.name]=message;this.submitted[element.name]=message;},addWrapper:function(toToggle){if(this.settings.wrapper){toToggle=toToggle.add(toToggle.parent(this.settings.wrapper));}return toToggle;},defaultShowErrors:function(){for(var i=0;this.errorList[i];i++){var error=this.errorList[i];this.settings.highlight&&this.settings.highlight.call(this,error.element,this.settings.errorClass,this.settings.validClass);this.showLabel(error.element,error.message);}if(this.errorList.length){this.toShow=this.toShow.add(this.containers);}if(this.settings.success){for(var i=0;this.successList[i];i++){this.showLabel(this.successList[i]);}}if(this.settings.unhighlight){for(var i=0,elements=this.validElements();elements[i];i++){this.settings.unhighlight.call(this,elements[i],this.settings.errorClass,this.settings.validClass);}}this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show();},validElements:function(){return this.currentElements.not(this.invalidElements());},invalidElements:function(){return $(this.errorList).map(function(){return this.element;});},showLabel:function(element,message){var label=this.errorsFor(element);if(label.length){label.removeClass().addClass(this.settings.errorClass);label.attr("generated")&&label.html(message);}else{label=$("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(element),generated:true}).addClass(this.settings.errorClass).html(message||"");if(this.settings.wrapper){label=label.hide().show().wrap("<"+this.settings.wrapper+"/>").parent();}if(!this.labelContainer.append(label).length){this.settings.errorPlacement?this.settings.errorPlacement(label,$(element)):label.insertAfter(element);}}if(!message&&this.settings.success){label.text("");typeof this.settings.success=="string"?label.addClass(this.settings.success):this.settings.success(label);}this.toShow=this.toShow.add(label);},errorsFor:function(element){var name=this.idOrName(element);return this.errors().filter(function(){return $(this).attr("for")==name;});},idOrName:function(element){return this.groups[element.name]||(this.checkable(element)?element.name:element.id||element.name);},checkable:function(element){return/radio|checkbox/i.test(element.type);},findByName:function(name){var form=this.currentForm;return $(document.getElementsByName(name)).map(function(index,element){return element.form==form&&element.name==name&&element||null;});},getLength:function(value,element){switch(element.nodeName.toLowerCase()){case"select":return $("option:selected",element).length;case"input":if(this.checkable(element)){return this.findByName(element.name).filter(":checked").length;}}return value.length;},depend:function(param,element){return this.dependTypes[typeof param]?this.dependTypes[typeof param](param,element):true;},dependTypes:{"boolean":function(param,element){return param;},string:function(param,element){return !!$(param,element.form).length;},"function":function(param,element){return param(element);}},optional:function(element){return !$.validator.methods.required.call(this,$.trim(element.value),element)&&"dependency-mismatch";},startRequest:function(element){if(!this.pending[element.name]){this.pendingRequest++;this.pending[element.name]=true;}},stopRequest:function(element,valid){this.pendingRequest--;if(this.pendingRequest<0){this.pendingRequest=0;}delete this.pending[element.name];if(valid&&this.pendingRequest==0&&this.formSubmitted&&this.form()){$(this.currentForm).submit();this.formSubmitted=false;}else{if(!valid&&this.pendingRequest==0&&this.formSubmitted){$(this.currentForm).triggerHandler("invalid-form",[this]);this.formSubmitted=false;}}},previousValue:function(element){return $.data(element,"previousValue")||$.data(element,"previousValue",{old:null,valid:true,message:this.defaultMessage(element,"remote")});}},classRuleSettings:{required:{required:true},email:{email:true},url:{url:true},date:{date:true},dateISO:{dateISO:true},dateDE:{dateDE:true},number:{number:true},numberDE:{numberDE:true},digits:{digits:true},creditcard:{creditcard:true}},addClassRules:function(className,rules){className.constructor==String?this.classRuleSettings[className]=rules:$.extend(this.classRuleSettings,className);},classRules:function(element){var rules={};var classes=$(element).attr("class");classes&&$.each(classes.split(" "),function(){if(this in $.validator.classRuleSettings){$.extend(rules,$.validator.classRuleSettings[this]);}});return rules;},attributeRules:function(element){var rules={};var $element=$(element);for(method in $.validator.methods){var value=$element.attr(method);if(value){rules[method]=value;}}if(rules.maxlength&&/-1|2147483647|524288/.test(rules.maxlength)){delete rules.maxlength;}return rules;},metadataRules:function(element){if(!$.metadata){return{};}var meta=$.data(element.form,"validator").settings.meta;return meta?$(element).metadata()[meta]:$(element).metadata();},staticRules:function(element){var rules={};var validator=$.data(element.form,"validator");if(validator.settings.rules){rules=$.validator.normalizeRule(validator.settings.rules[element.name])||{};}return rules;},normalizeRules:function(rules,element){$.each(rules,function(prop,val){if(val===false){delete rules[prop];return;}if(val.param||val.depends){var keepRule=true;switch(typeof val.depends){case"string":keepRule=!!$(val.depends,element.form).length;break;case"function":keepRule=val.depends.call(element,element);break;}if(keepRule){rules[prop]=val.param!==undefined?val.param:true;}else{delete rules[prop];}}});$.each(rules,function(rule,parameter){rules[rule]=$.isFunction(parameter)?parameter(element):parameter;});$.each(["minlength","maxlength","min","max"],function(){if(rules[this]){rules[this]=Number(rules[this]);}});$.each(["rangelength","range"],function(){if(rules[this]){rules[this]=[Number(rules[this][0]),Number(rules[this][1])];}});if($.validator.autoCreateRanges){if(rules.min&&rules.max){rules.range=[rules.min,rules.max];delete rules.min;delete rules.max;}if(rules.minlength&&rules.maxlength){rules.rangelength=[rules.minlength,rules.maxlength];delete rules.minlength;delete rules.maxlength;}}if(rules.messages){delete rules.messages;}return rules;},normalizeRule:function(data){if(typeof data=="string"){var transformed={};$.each(data.split(/\s/),function(){transformed[this]=true;});data=transformed;}return data;},addMethod:function(name,method,message){$.validator.methods[name]=method;$.validator.messages[name]=message!=undefined?message:$.validator.messages[name];if(method.length<3){$.validator.addClassRules(name,$.validator.normalizeRule(name));}},methods:{required:function(value,element,param){if(!this.depend(param,element)){return"dependency-mismatch";}switch(element.nodeName.toLowerCase()){case"select":var val=$(element).val();return val&&val.length>0;case"input":if(this.checkable(element)){return this.getLength(value,element)>0;}default:return $.trim(value).length>0;}},remote:function(value,element,param){if(this.optional(element)){return"dependency-mismatch";}var previous=this.previousValue(element);if(!this.settings.messages[element.name]){this.settings.messages[element.name]={};}previous.originalMessage=this.settings.messages[element.name].remote;this.settings.messages[element.name].remote=previous.message;param=typeof param=="string"&&{url:param}||param;if(previous.old!==value){previous.old=value;var validator=this;this.startRequest(element);var data={};data[element.name]=value;$.ajax($.extend(true,{url:param,mode:"abort",port:"validate"+element.name,dataType:"json",data:data,success:function(response){validator.settings.messages[element.name].remote=previous.originalMessage;var valid=response===true;if(valid){var submitted=validator.formSubmitted;validator.prepareElement(element);validator.formSubmitted=submitted;validator.successList.push(element);validator.showErrors();}else{var errors={};var message=(previous.message=response||validator.defaultMessage(element,"remote"));errors[element.name]=$.isFunction(message)?message(value):message;validator.showErrors(errors);}previous.valid=valid;validator.stopRequest(element,valid);}},param));return"pending";}else{if(this.pending[element.name]){return"pending";}}return previous.valid;},minlength:function(value,element,param){return this.optional(element)||this.getLength($.trim(value),element)>=param;},maxlength:function(value,element,param){return this.optional(element)||this.getLength($.trim(value),element)<=param;
},rangelength:function(value,element,param){var length=this.getLength($.trim(value),element);return this.optional(element)||(length>=param[0]&&length<=param[1]);},min:function(value,element,param){return this.optional(element)||value>=param;},max:function(value,element,param){return this.optional(element)||value<=param;},range:function(value,element,param){return this.optional(element)||(value>=param[0]&&value<=param[1]);},email:function(value,element){return this.optional(element)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(value);},url:function(value,element){return this.optional(element)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(value);},date:function(value,element){return this.optional(element)||!/Invalid|NaN/.test(new Date(value));},dateISO:function(value,element){return this.optional(element)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(value);},number:function(value,element){return this.optional(element)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(value);},digits:function(value,element){return this.optional(element)||/^\d+$/.test(value);},creditcard:function(value,element){if(this.optional(element)){return"dependency-mismatch";}if(/[^0-9-]+/.test(value)){return false;}var nCheck=0,nDigit=0,bEven=false;value=value.replace(/\D/g,"");for(var n=value.length-1;n>=0;n--){var cDigit=value.charAt(n);var nDigit=parseInt(cDigit,10);if(bEven){if((nDigit*=2)>9){nDigit-=9;}}nCheck+=nDigit;bEven=!bEven;}return(nCheck%10)==0;},accept:function(value,element,param){param=typeof param=="string"?param.replace(/,/g,"|"):"png|jpe?g|gif";return this.optional(element)||value.match(new RegExp(".("+param+")$","i"));},equalTo:function(value,element,param){var target=$(param).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){$(element).valid();});return value==target.val();}}});$.format=$.validator.format;})(jQuery);(function($){var ajax=$.ajax;var pendingRequests={};$.ajax=function(settings){settings=$.extend(settings,$.extend({},$.ajaxSettings,settings));var port=settings.port;if(settings.mode=="abort"){if(pendingRequests[port]){pendingRequests[port].abort();}return(pendingRequests[port]=ajax.apply(this,arguments));}return ajax.apply(this,arguments);};})(jQuery);(function($){if(!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener){$.each({focus:"focusin",blur:"focusout"},function(original,fix){$.event.special[fix]={setup:function(){this.addEventListener(original,handler,true);},teardown:function(){this.removeEventListener(original,handler,true);},handler:function(e){arguments[0]=$.event.fix(e);arguments[0].type=fix;return $.event.handle.apply(this,arguments);}};function handler(e){e=$.event.fix(e);e.type=fix;return $.event.handle.call(this,e);}});}$.extend($.fn,{validateDelegate:function(delegate,type,handler){return this.bind(type,function(event){var target=$(event.target);if(target.is(delegate)){return handler.apply(target,arguments);}});}});})(jQuery);(function($){$.comments=function(el,options){var base=this;base.$el=$(el);base.id=base.$el.attr("id");base.el=el;base.$el.data("comments",base);base.init=function(){base.opts=$.extend({},$.comments.defaults,options);if(base.$el.attr("rev")){base.opts.limit=base.$el.attr("rev");}base.valid=true;base.text_input=base.$el.find(base.opts.text_input);base.title_input=base.$el.find(base.opts.title_input);base.bindSubmit();if(base.opts.content_type==="twists"){$(document).bind("sso.twist",base.ssoTwistListener);}else{$(document).bind("sso.chime",base.ssoChimeListener);}if(base.opts.valid_listener){base.invokeValidListener();}base.comments_container=base.$el.find(base.opts.comments_container);base.content_id=base.$el.attr("rel");base.comments_ul=base.$el.find(base.opts.comments_ul);if(base.comments_container.length==1&&!$("#comments").hasClass("do_not_load_comments_on_init")){base.invokeCall("receive");}};function ssoListener(type,params){if(params.type==="guest"){base.guest_name=params.guestName;base.guest_email=params.guestEmail;}if(params.dailyNews){}base.invokeCall("send","new");}base.ssoChimeListener=function(e,params){ssoListener("chime",params);};base.ssoTwistListener=function(e,params){ssoListener("twist",params);};base.invokeCall=function(method,status,elem){var call_type,call_file,call_data,call_content_type;if(method==="receive"){call_type="GET";call_file="list";process=true;call_data={id:base.content_id,type:base.opts.content_type,format:(base.opts.content_type!="twists")?"html":"json"};if(base.opts.limit){call_data.limit=base.opts.limit;}}else{if(method==="send"){call_type="POST";if(status==="new"){call_file="create";call_content_type="application/json";call_data={id:base.content_id,type:base.opts.content_type};process=false;if(base.title_input.length){call_data.title=(base.title_input.hasClass("active"))?$.stripHtml($.trim(base.title_input.val())):"";}call_data.comment=$.stripHtml($.trim(base.text_input.val()));if(!iV_SSO.isLoggedIn()){if(base.guest_name){call_data.guest_name=base.guest_name;}if(base.guest_email){call_data.guest_email=base.guest_email;}}call_data=$.toJSON(call_data);}else{if(status==="existing"){call_file="update";call_content_type="application/json";call_data=$.toJSON($.data(elem,"comment_data"));}}}}base.valid=false;if(base.title_input.length){base.title_input.val("").trigger("blur");}base.text_input.val("").trigger("blur");base.submit_btn.removeClass("hover").addClass("disabled");base.comments_container.find(".pagination-item").live("click",function(e){var url=$(this).children("a").attr("href");e.preventDefault();base.comments_container.load(url);});if(call_data){$.ajax({type:call_type,url:"/ajax/comments/"+call_file,dataType:call_data.format?call_data.format:"json",data:call_data,contentType:call_content_type,processData:process,success:function(json){if(method==="receive"){if(call_data.format=="html"){base.comments_container.html(json);base.comments_ul=$(base.opts.comments_ul,base.$el);base.comments_ul.find("li").each(function(i,e){base.attachCommentEvents($(this));});if(call_data.limit){$(".all-comments .mod-pagination").hide();}}else{base.renderComments(json);$(document).trigger("USER_RATING",base.user_rating);if(base.renderResult){base.truncateComments();}$(document).trigger("COMMENTS_UPDATED_"+base.id);}}else{if(method==="send"){if(status==="new"){base.renderComments(json);if(base.renderResult){base.truncateComments();}}$(document).trigger("COMMENTS_UPDATED_"+base.id);}}$("#comments").show();}});}};base.bindSubmit=function(e){base.submit_btn=base.$el.find(base.opts.submit_btn);if(iVillage.controller==="Entertainment_Controller"&&iVillage.action==="index"){base.submit_btn=$("#chime-in-form button");}if(!base.submit_btn.length||base.submit_btn.length>1){return false;}function handleClick(e){e.preventDefault();if(!$(this).hasClass("disabled")){iV_SSO.chime(e);}}function handleMouseover(e){var that=$(this);if(!that.hasClass("disabled")){that.addClass("hover");}}function handleMouseout(e){var that=$(this);if(!that.hasClass("disabled")){that.removeClass("hover");}}base.submit_btn.removeClass("hide").bind("click",handleClick).bind("mouseover",handleMouseover).bind("mouseout",handleMouseout);return true;};base.renderComments=function(data,source){var new_comments,new_comment,comment_array,i,the_comments;new_comments=[];the_comments=data[base.content_id]||data;$.each(the_comments,function(i,comment){comment_array={cid:comment.cid||"",author_id:comment.author_id||"",author:comment.author||"",author_rating:comment.author_rating||"",guest_name:comment.guest_name||"",guest_email:comment.guest_email||"",image:comment.image||"",date_posted_distance:comment.updated_distance_of_time_in_words||"",title:comment.title||"",message:comment.comment||""};if(base.opts.render_external){new_comment=base.opts.render_external(comment_array,comment);new_comments.push(base.attachCommentEvents(new_comment));}else{new_comment=base.buildComment(comment_array,comment);new_comments.push(base.attachCommentEvents(new_comment));}});for(i=0;i<new_comments.length;i++){base.comments_ul.prepend(new_comments[i]);}base.renderResult=the_comments.length;};base.attachCommentEvents=function(comment){var comment_data={flag:true,cid:comment.find("input[name=cid]").val(),id:comment.find("input[name=id]").val()};$.data(comment,"comment_data",comment_data);comment.find(".flag-link").bind("click",function(e){e.preventDefault();var that=$(this);base.invokeCall("send","existing",comment);comment.children().not(that.parent()).fadeTo("slow",0.2);that.fadeOut("fast",function(){that.text("Marked as inappropriate").fadeIn("fast");});});if($.data(comment,"comment_data").author!=null&&$.data(comment,"comment_data").author.user_id!=null){comment.find(".h5 a, .comment-img").bind("click",function(e){e.preventDefault();window.open(this.href,"profile","height=600,width=600,scrollbars=1");});}return comment;};base.buildComment=function(data,source_data){var rating="";var user,image,user_or_guest,comment;data.author_id=parseInt(data.author_id,10);data.image=data.image||iVillage.random_avatar();if(data.author_id){if(iV_SSO.isLoggedIn()&&iV_SSO.getUserId()===data.author_id){if(source_data.author_rating){base.user_rating=source_data.author_rating;}}}if(data.author_id){if(data.author!=null&&data.author!=""&&typeof(data.author)!="object"){profile_link="/profiles/user/"+data.author;}else{profile_link="/profiles/"+data.author_id;}image='<a href="'+profile_link+'" class="comment-img" title="View '+data.author+'&rsquo;s profile"><img src="'+data.image+'" width="60" height="60" alt="'+data.author+'" /></a>';user='<a href="'+profile_link+'" title="View '+data.author+'&rsquo;s profile">'+data.author+"</a>";}else{image='<div class="comment-img"><img src="'+data.image+'" width="60" height="60" alt="'+data.author+'" /></div>';user_or_guest=data.guest_name||"Anonymous";user="<span>"+user_or_guest+"</span>";}if(base.opts.rating&&source_data.author_rating!=null&&data.author_id!=null){rating='<div class="rating rating-'+source_data.author_rating+'"></div>';}comment=$("<li>"+rating+'<div class="h5">'+user+" replied about "+data.date_posted_distance+" ago</div>"+image+"<blockquote>"+data.message+'</blockquote><div class="flag-wrap"><a href="#" class="flag-link">Flag as Inappropriate</a></div></li>');if(source_data){$.data(comment,"comment_data",source_data);}else{$.data(comment,"comment_data",data);}return comment;};base.truncateComments=function(){if(base.opts.display_comments&&!base.opts.see_all_link){base.comments=base.comments_ul.children().not(".all");if(base.comments.length>base.opts.display_comments){base.comments.filter(":gt("+parseInt(base.opts.display_comments-1)+")").not(".all").hide();if(base.opts.show_all_link){var old_all_link=base.comments_ul.children(".all");if(old_all_link.length){old_all_link.remove();}$('<li class="all"><a href="#" class="more-link">Read All '+base.comments.length+" "+base.opts.comment_type+"</a></li>").appendTo(base.comments_ul).bind("click",function(e){e.preventDefault();base.comments.filter(":hidden").fadeIn("medium");$(this).remove();});}}}};base.invokeValidListener=function(){base.listener_id=base.opts.valid_listener+"_"+base.id;$(document).bind(base.listener_id,function(e,status){base.valid=status;base.updatePanel(status);});};base.updatePanel=function(status){switch(status){case true:base.submit_btn.removeClass("disabled");break;case false:base.submit_btn.addClass("disabled");break;}};base.init();};$.comments.defaults={rating:false,content_type:"comments",title_input:'input[type="text"]',text_input:"textarea",show_all_link:true,comments_container:".all-comments",comments_ul:"ul.comments",comment_type:"Comments",flag_inappropriate:false,submit_btn:".submit"};$.fn.comments=function(options){return this.each(function(){(new $.comments(this,options));});};})(jQuery);(function($){var o,console_enabled;$.fn.charcounter=function(options){o=$.extend({},$.fn.charcounter.defaults,options);if(window.console&&window.console.log){console_enabled=true;}return this.each(function(){$this=$(this);_initialize($this);});};function _initialize($this){var input_length,chars_remaining;debug("info","jQ CC > plugin initializing...");debug("time","jQ CC > Initialization");var text_input=$(o.text_input,$this);if(!text_input.length||text_input.length>1){debug("warn","jQ CC > Invalid number of text inputs, should be 1.");return;}var chars_elem=$(o.chars_elem,$this);if(!chars_elem.length||chars_elem.length>1){debug("warn","jQ CC > Invalid number of elements to display remaining characters, should be 1.");return;}var crl=o.chars_rem_low_class;var cro=o.chars_rem_over_class;var iv_flag=false,ok_flag=false;text_input.live("focus",function(){setTimeout(function(){$(this).trigger("keyup");},50);});text_input.live("blur",function(){setTimeout(function(){$(this).trigger("keyup");},50);});text_input.bind("keyup",function(){input_length=$.trim(text_input.val()).length;chars_remaining=parseInt(o.char_limit-input_length);if(!chars_elem.hasClass(o.chars_rem_active_class)){chars_elem.addClass(o.chars_rem_active_class);}chars_elem.text(chars_remaining);if(chars_remaining==o.char_limit||chars_remaining<0){sendBroadcast($this,o.status_trigger,false);}else{sendBroadcast($this,o.status_trigger,true);}if(chars_remaining<0){chars_elem.removeClass(crl).addClass(cro);}else{if(chars_remaining<21&&chars_remaining>-1){chars_elem.removeClass(cro).addClass(crl);}else{chars_elem.removeClass(crl).removeClass(cro);}}});sendBroadcast($this,o.status_trigger,false);chars_elem.text(o.char_limit+" character limit");debug("timeEnd","jQ CC > Initialization");}function sendBroadcast(elem,msg,status){var listener_id=msg+"_"+elem.attr("id");$(document).trigger(listener_id,status);}function debug(state,msg){if(o.debug&&console_enabled){try{eval("window.console."+state)(msg);}catch(err){}}}$.fn.charcounter.defaults={debug:false,text_input:"textarea",char_limit:140,chars_elem:".chars-rem",chars_rem_active_class:"chars-rem-active",chars_rem_low_class:"chars-rem-low",chars_rem_over_class:"chars-rem-over",status_trigger:"CC_STATUS"};})(jQuery);(function($){$.fn.extend({autocomplete:function(urlOrData,options){var isUrl=typeof urlOrData=="string";options=$.extend({},$.Autocompleter.defaults,{url:isUrl?urlOrData:null,data:isUrl?null:urlOrData,delay:isUrl?$.Autocompleter.defaults.delay:10,max:options&&!options.scroll?10:150},options);options.highlight=options.highlight||function(value){return value;};options.formatMatch=options.formatMatch||options.formatItem;return this.each(function(){new $.Autocompleter(this,options);});},result:function(handler){return this.bind("result",handler);},search:function(handler){return this.trigger("search",[handler]);},flushCache:function(){return this.trigger("flushCache");},setOptions:function(options){return this.trigger("setOptions",[options]);},unautocomplete:function(){return this.trigger("unautocomplete");}});$.Autocompleter=function(input,options){var KEY={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8};var $input=$(input).attr("autocomplete","off").addClass(options.inputClass);var timeout;var previousValue="";var cache=$.Autocompleter.Cache(options);var hasFocus=0;var lastKeyPressCode;var config={mouseDownOnSelect:false};var select=$.Autocompleter.Select(options,input,selectCurrent,config);var blockSubmit;$.browser.opera&&$(input.form).bind("submit.autocomplete",function(){if(blockSubmit){blockSubmit=false;return false;}});$input.bind(($.browser.opera?"keypress":"keydown")+".autocomplete",function(event){hasFocus=1;lastKeyPressCode=event.keyCode;switch(event.keyCode){case KEY.UP:event.preventDefault();if(select.visible()){select.prev();}else{onChange(0,true);}break;case KEY.DOWN:event.preventDefault();if(select.visible()){select.next();}else{onChange(0,true);}break;case KEY.PAGEUP:event.preventDefault();if(select.visible()){select.pageUp();}else{onChange(0,true);}break;case KEY.PAGEDOWN:event.preventDefault();if(select.visible()){select.pageDown();}else{onChange(0,true);}break;case options.multiple&&$.trim(options.multipleSeparator)==","&&KEY.COMMA:case KEY.TAB:case KEY.RETURN:if(selectCurrent()){event.preventDefault();blockSubmit=true;return false;}break;case KEY.ESC:select.hide();break;default:clearTimeout(timeout);timeout=setTimeout(onChange,options.delay);break;}}).focus(function(){hasFocus++;}).blur(function(){hasFocus=0;if(!config.mouseDownOnSelect){hideResults();}}).click(function(){if(hasFocus++>1&&!select.visible()){onChange(0,true);}}).bind("search",function(){var fn=(arguments.length>1)?arguments[1]:null;function findValueCallback(q,data){var result;if(data&&data.length){for(var i=0;i<data.length;i++){if(data[i].result.toLowerCase()==q.toLowerCase()){result=data[i];break;}}}if(typeof fn=="function"){fn(result);}else{$input.trigger("result",result&&[result.data,result.value]);}}$.each(trimWords($input.val()),function(i,value){request(value,findValueCallback,findValueCallback);});}).bind("flushCache",function(){cache.flush();}).bind("setOptions",function(){$.extend(options,arguments[1]);if("data" in arguments[1]){cache.populate();}}).bind("unautocomplete",function(){select.unbind();$input.unbind();$(input.form).unbind(".autocomplete");});function selectCurrent(){var selected=select.selected();if(!selected){return false;}var v=selected.result;previousValue=v;if(options.multiple){var words=trimWords($input.val());if(words.length>1){var seperator=options.multipleSeparator.length;var cursorAt=$(input).selection().start;var wordAt,progress=0;$.each(words,function(i,word){progress+=word.length;if(cursorAt<=progress){wordAt=i;return false;}progress+=seperator;});words[wordAt]=v;v=words.join(options.multipleSeparator);}v+=options.multipleSeparator;}$input.val(v);hideResultsNow();$input.trigger("result",[selected.data,selected.value]);return true;}function onChange(crap,skipPrevCheck){if(lastKeyPressCode==KEY.DEL){select.hide();return;}var currentValue=$input.val();if(!skipPrevCheck&&currentValue==previousValue){return;}previousValue=currentValue;currentValue=lastWord(currentValue);if(currentValue.length>=options.minChars){$input.addClass(options.loadingClass);if(!options.matchCase){currentValue=currentValue.toLowerCase();}request(currentValue,receiveData,hideResultsNow);}else{stopLoading();select.hide();}}function trimWords(value){if(!value){return[""];}if(!options.multiple){return[$.trim(value)];}return $.map(value.split(options.multipleSeparator),function(word){return $.trim(value).length?$.trim(word):null;});}function lastWord(value){if(!options.multiple){return value;}var words=trimWords(value);if(words.length==1){return words[0];}var cursorAt=$(input).selection().start;if(cursorAt==value.length){words=trimWords(value);}else{words=trimWords(value.replace(value.substring(cursorAt),""));}return words[words.length-1];}function autoFill(q,sValue){if(options.autoFill&&(lastWord($input.val()).toLowerCase()==q.toLowerCase())&&lastKeyPressCode!=KEY.BACKSPACE){$input.val($input.val()+sValue.substring(lastWord(previousValue).length));$(input).selection(previousValue.length,previousValue.length+sValue.length);}}function hideResults(){clearTimeout(timeout);timeout=setTimeout(hideResultsNow,200);}function hideResultsNow(){var wasVisible=select.visible();select.hide();clearTimeout(timeout);stopLoading();if(options.mustMatch){$input.search(function(result){if(!result){if(options.multiple){var words=trimWords($input.val()).slice(0,-1);$input.val(words.join(options.multipleSeparator)+(words.length?options.multipleSeparator:""));}else{$input.val("");$input.trigger("result",null);}}});}}function receiveData(q,data){if(data&&data.length&&hasFocus){stopLoading();select.display(data,q);autoFill(q,data[0].value);select.show();}else{hideResultsNow();}}function request(term,success,failure){if(!options.matchCase){term=term.toLowerCase();}var data=cache.load(term);if(data&&data.length){success(term,data);}else{if((typeof options.url=="string")&&(options.url.length>0)){var extraParams={timestamp:+new Date()};$.each(options.extraParams,function(key,param){extraParams[key]=typeof param=="function"?param():param;});$.ajax({mode:"abort",port:"autocomplete"+input.name,dataType:options.dataType,url:options.url,data:$.extend({q:lastWord(term),limit:options.max},extraParams),success:function(data){var parsed=options.parse&&options.parse(data)||parse(data);cache.add(term,parsed);success(term,parsed);}});}else{select.emptyList();failure(term);}}}function parse(data){var parsed=[];var rows=data.split("\n");for(var i=0;i<rows.length;i++){var row=$.trim(rows[i]);if(row){row=row.split("|");parsed[parsed.length]={data:row,value:row[0],result:options.formatResult&&options.formatResult(row,row[0])||row[0]};}}return parsed;}function stopLoading(){$input.removeClass(options.loadingClass);}};$.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:false,matchSubset:true,matchContains:false,cacheLength:10,max:100,mustMatch:false,extraParams:{},selectFirst:true,formatItem:function(row){return row[0];},formatMatch:null,autoFill:false,width:0,multiple:false,multipleSeparator:", ",highlight:function(value,term){return value.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+term.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>");},scroll:true,scrollHeight:180};$.Autocompleter.Cache=function(options){var data={};var length=0;function matchSubset(s,sub){if(!options.matchCase){s=s.toLowerCase();}var i=s.indexOf(sub);if(options.matchContains=="word"){i=s.toLowerCase().search("\\b"+sub.toLowerCase());}if(i==-1){return false;}return i==0||options.matchContains;}function add(q,value){if(length>options.cacheLength){flush();}if(!data[q]){length++;}data[q]=value;}function populate(){if(!options.data){return false;}var stMatchSets={},nullData=0;if(!options.url){options.cacheLength=1;}stMatchSets[""]=[];for(var i=0,ol=options.data.length;i<ol;i++){var rawValue=options.data[i];rawValue=(typeof rawValue=="string")?[rawValue]:rawValue;var value=options.formatMatch(rawValue,i+1,options.data.length);if(value===false){continue;}var firstChar=value.charAt(0).toLowerCase();if(!stMatchSets[firstChar]){stMatchSets[firstChar]=[];}var row={value:value,data:rawValue,result:options.formatResult&&options.formatResult(rawValue)||value};stMatchSets[firstChar].push(row);if(nullData++<options.max){stMatchSets[""].push(row);}}$.each(stMatchSets,function(i,value){options.cacheLength++;add(i,value);});}setTimeout(populate,25);function flush(){data={};length=0;}return{flush:flush,add:add,populate:populate,load:function(q){if(!options.cacheLength||!length){return null;}if(!options.url&&options.matchContains){var csub=[];for(var k in data){if(k.length>0){var c=data[k];$.each(c,function(i,x){if(matchSubset(x.value,q)){csub.push(x);}});}}return csub;}else{if(data[q]){return data[q];}else{if(options.matchSubset){for(var i=q.length-1;i>=options.minChars;i--){var c=data[q.substr(0,i)];if(c){var csub=[];$.each(c,function(i,x){if(matchSubset(x.value,q)){csub[csub.length]=x;}});return csub;}}}}}return null;}};};$.Autocompleter.Select=function(options,input,select,config){var CLASSES={ACTIVE:"ac_over"};var listItems,active=-1,data,term="",needsInit=true,element,list;function init(){if(!needsInit){return;}element=$("<div/>").hide().addClass(options.resultsClass).css("position","absolute").appendTo(document.body);list=$("<ul/>").appendTo(element).mouseover(function(event){if(target(event).nodeName&&target(event).nodeName.toUpperCase()=="LI"){active=$("li",list).removeClass(CLASSES.ACTIVE).index(target(event));$(target(event)).addClass(CLASSES.ACTIVE);}}).click(function(event){$(target(event)).addClass(CLASSES.ACTIVE);select();input.focus();return false;}).mousedown(function(){config.mouseDownOnSelect=true;}).mouseup(function(){config.mouseDownOnSelect=false;});if(options.width>0){element.css("width",options.width);}needsInit=false;}function target(event){var element=event.target;while(element&&element.tagName!="LI"){element=element.parentNode;
}if(!element){return[];}return element;}function moveSelect(step){listItems.slice(active,active+1).removeClass(CLASSES.ACTIVE);movePosition(step);var activeItem=listItems.slice(active,active+1).addClass(CLASSES.ACTIVE);if(options.scroll){var offset=0;listItems.slice(0,active).each(function(){offset+=this.offsetHeight;});if((offset+activeItem[0].offsetHeight-list.scrollTop())>list[0].clientHeight){list.scrollTop(offset+activeItem[0].offsetHeight-list.innerHeight());}else{if(offset<list.scrollTop()){list.scrollTop(offset);}}}}function movePosition(step){active+=step;if(active<0){active=listItems.size()-1;}else{if(active>=listItems.size()){active=0;}}}function limitNumberOfItems(available){return options.max&&options.max<available?options.max:available;}function fillList(){list.empty();var max=limitNumberOfItems(data.length);for(var i=0;i<max;i++){if(!data[i]){continue;}var formatted=options.formatItem(data[i].data,i+1,max,data[i].value,term);if(formatted===false){continue;}var li=$("<li/>").html(options.highlight(formatted,term)).addClass(i%2==0?"ac_even":"ac_odd").appendTo(list)[0];$.data(li,"ac_data",data[i]);}listItems=list.find("li");if(options.selectFirst){listItems.slice(0,1).addClass(CLASSES.ACTIVE);active=0;}if($.fn.bgiframe){list.bgiframe();}}return{display:function(d,q){init();data=d;term=q;fillList();},next:function(){moveSelect(1);},prev:function(){moveSelect(-1);},pageUp:function(){if(active!=0&&active-8<0){moveSelect(-active);}else{moveSelect(-8);}},pageDown:function(){if(active!=listItems.size()-1&&active+8>listItems.size()){moveSelect(listItems.size()-1-active);}else{moveSelect(8);}},hide:function(){element&&element.hide();listItems&&listItems.removeClass(CLASSES.ACTIVE);active=-1;},visible:function(){return element&&element.is(":visible");},current:function(){return this.visible()&&(listItems.filter("."+CLASSES.ACTIVE)[0]||options.selectFirst&&listItems[0]);},show:function(){var offset=$(input).offset();element.css({width:typeof options.width=="string"||options.width>0?options.width:$(input).width(),top:offset.top+input.offsetHeight,left:offset.left}).show();if(options.scroll){list.scrollTop(0);list.css({maxHeight:options.scrollHeight,overflow:"auto"});if($.browser.msie&&typeof document.body.style.maxHeight==="undefined"){var listHeight=0;listItems.each(function(){listHeight+=this.offsetHeight;});var scrollbarsVisible=listHeight>options.scrollHeight;list.css("height",scrollbarsVisible?options.scrollHeight:listHeight);if(!scrollbarsVisible){listItems.width(list.width()-parseInt(listItems.css("padding-left"))-parseInt(listItems.css("padding-right")));}}}},selected:function(){var selected=listItems&&listItems.filter("."+CLASSES.ACTIVE).removeClass(CLASSES.ACTIVE);return selected&&selected.length&&$.data(selected[0],"ac_data");},emptyList:function(){list&&list.empty();},unbind:function(){element&&element.remove();}};};$.fn.selection=function(start,end){if(start!==undefined){return this.each(function(){if(this.createTextRange){var selRange=this.createTextRange();if(end===undefined||start==end){selRange.move("character",start);selRange.select();}else{selRange.collapse(true);selRange.moveStart("character",start);selRange.moveEnd("character",end);selRange.select();}}else{if(this.setSelectionRange){this.setSelectionRange(start,end);}else{if(this.selectionStart){this.selectionStart=start;this.selectionEnd=end;}}}});}var field=this[0];if(field.createTextRange){var range=document.selection.createRange(),orig=field.value,teststring="<->",textLength=range.text.length;range.text=teststring;var caretAt=field.value.indexOf(teststring);field.value=orig;this.selection(caretAt,caretAt+textLength);return{start:caretAt,end:caretAt+textLength};}else{if(field.selectionStart!==undefined){return{start:field.selectionStart,end:field.selectionEnd};}}};})(jQuery);(function($){$.debug=function(msg){if(window.console&&window.console.log){console.log(msg);}};$.fn.addHover=function(){return this.bind("mouseenter",function(){$(this).addClass("hover");}).bind("mouseleave",function(){$(this).removeClass("hover");});};$.fn.remoteHover=function(selector,context){if(typeof selector!=="string"){return this;}return this.each(function(){var that=$(this);var target;if(context==="this"){target=that.find(selector);}else{if(typeof context==="object"){target=context.find(selector);}}that.hover(function(){if(iVillage.msie6){target.addClass("hover");}else{target.trigger("mouseenter");}},function(){if(iVillage.msie6){target.removeClass("hover");}else{target.trigger("mouseleave");}});});};$.fn.submitReplace=function(klass){return this.each(function(){var btn=$(this);var form=btn.closest("form");var text=btn.val();$('<a href="#" class="'+klass+'">'+text+"</a>").click(function(e){e.preventDefault();form.submit();}).insertAfter(btn).attr("name",btn.attr("name"));btn.css({position:iVillage.msie6?"absolute":"fixed",left:"-9999px",display:"block",width:"0px",height:"0px"});if(iVillage.msie6||iVillage.msie7){form.find("input:text, input:password").each(function(e){$(this).keypress(function(e){var code=e.keyCode||e.which;if(code===13){form.submit();}});});}});};$.fn.inputRollover=function(){return this.bind("mouseover",function(){if($(this).hasClass("new")){$(this).css("background-position","-181px -95px");}else{$(this).css("background-position","0 100%");}}).bind("mouseout",function(){if($(this).hasClass("new")){$(this).css("background-position","-181px -70px");}else{$(this).css("background-position","0 0");}});};$.fn.labelHide=function(){return this.each(function(){var that=$(this);var label=that.prev("label");if(label.length>0){label.hide();if(that.hasClass("clear-default")){that.val(label.text());}}});};$.fn.clearDefault=function(){return this.each(function(){var that=$(this);var default_text=that.val();that.bind("focus",function(){that.addClass("active");if(that.val()==default_text){that.val("");}}).bind("blur",function(){if(!that.val().length){that.removeClass("active").val(default_text);}});});};$.fn.blockSubmit=function(){return this.each(function(){var button=$(this).find(".block-submit-btn");var textbox=$(this).find(".block-submit-text");button.bind("click",function(){if(textbox.val().length>0){textbox.trigger("focus");if(textbox.val().length==0){textbox.trigger("blur");button.trigger("focus");return false;}return true;}else{return false;}});});};$.fn.equalizeChildHeights=function(options){var settings=$.extend({only_visible_children:false},options);if(iVillage.msie6){this.children().css("height","auto");}else{this.children().css("min-height","0px");}return this.each(function(){var childs,height;var tallest=0;var that=$(this);if(settings.only_visible_children){childs=that.children(":visible");}else{childs=that.children();}childs.each(function(){var height=$(this).outerHeight();if(height>tallest){tallest=height;}}).each(function(){var element=$(this);var remainder=element.outerHeight()-element.height();var newHeight=tallest-remainder;var property=iVillage.msie6?"height":"min-height";element.css(property,newHeight+"px");});});};$.fn.equalizeHeights=function(){var height;var tallest=0;if(iVillage.msie6){this.css("height","auto");}else{this.css("min-height","0px");}this.each(function(){height=$(this).outerHeight();if(height>tallest){tallest=height;}});this.each(function(){var element=$(this);var remainder=element.outerHeight()-element.height();var newHeight=tallest-remainder;var property=iVillage.msie6?"height":"min-height";element.css(property,newHeight+"px");});};$.stripHtml=function(text){var regexp=/<("[^"]*"|'[^']*'|[^'">])*>/gi;var new_text=text.replace(regexp,"");return new_text;};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1);};$.fn.staggerImages=function(){var that=this;window.onload=function(){that.each(function(){var that=$(this);that.css("backgroundImage","url("+that.attr("ivbgimg")+")");that.removeAttr("ivbgimg");});};};$.fn.dropCap=function(){return this.each(function(){var parent_elem,parent_elem_rem,first_letter,is_tag;var first_paragraph=$(this).find("p:first-child").filter(":first");var text=first_paragraph.html();if(text){if(text.substring(0,1)==="<"){parent_elem=first_paragraph.children().filter(":first");if(parent_elem.html().substring(0,1)==="<"){parent_elem=parent_elem.children().filter(":first");}is_tag=true;}else{parent_elem=first_paragraph;}first_letter=parent_elem.text().substring(0,1);if(!isNaN(first_letter)){return;}if(is_tag){parent_elem.text().substring(0,1);}parent_elem_rem=parent_elem.html().substring(1,parent_elem.html().length);parent_elem.html(parent_elem_rem);first_paragraph.prepend($('<span class="drop-cap">'+first_letter+"</span>"));}});};$.fn.centerHoriz=function(){return this.each(function(){var that=$(this);var parent=that.parent();var margin=parseInt(parent.width()/2,10)-parseInt(that.outerWidth()/2,10);if(margin>0&&margin<parent.width()){that.css("marginLeft",margin);}});};$.fn.iv_colorbox=function(iv_options,cbox_options){var onOpenCallback,onClosedCallback;var iv_settings=$.extend({cboxClass:""},iv_options);if(cbox_options.onOpen){onOpenCallback=cbox_options.onOpen;}else{if(iv_options.onOpen){onOpenCallback=iv_options.onOpen;}}if(cbox_options.onClosed){onClosedCallback=cbox_options.onClosed;}else{if(iv_options.onClosed){onClosedCallback=iv_options.onClosed;}}if(iv_settings.cboxClass){cbox_options.onOpen=function(){$("#cboxWrapper").addClass(iv_settings.cboxClass);if(onOpenCallback){onOpenCallback.call();}$(".ad-wrap").hide();};cbox_options.onClosed=function(){if(onClosedCallback){onClosedCallback.call();}$(".ad-wrap").show();};}return this.each(function(){$(this).colorbox(cbox_options);});};$.fn.delay=function(time,callback){return this.animate({opacity:"+=0"},time,callback);};$.fn.ivAjaxPost=function(options){var opts=$.extend({},$.fn.ivAjaxPost.defaults,options);return this.each(function(){var form_data,i;var form=$(this);var action=form.attr("action");var additional_data={};var submit_data={};function makeRequest(){if(opts.loading===true){form.addClass("loading").append('<span class="loading-icon">Loading</span>');}if($.isFunction(opts.validate)){if(!opts.validate(form)){return false;}}if($.isFunction(opts.onTrigger)){opts.onTrigger(form);}form_data=form.serializeArray();for(i=0;i<form_data.length;i++){submit_data[form_data[i].name]=form_data[i].value;}if($.isFunction(opts.additionalData)){additional_data=opts.additionalData(form);}else{if($.isPlainObject(opts.additionalData)){additional_data=opts.additionalData;}}$.extend(submit_data,additional_data);$.ajax({type:"POST",url:action,data:submit_data,success:function(data){if(opts.loading){form.removeClass("loading").find("span.loading-icon").remove();}if($.isFunction(opts.onSuccess)){opts.onSuccess(data,form);}},error:function(request,status,e){if(opts.loading){form.removeClass("loading").find("span.loading-icon").remove();}if($.isFunction(opts.onError)){opts.onError(form,request,status,e);}},dataType:"json"});return true;}if(opts.bindSubmit===true){form.submit(function(e){e.preventDefault();makeRequest();});}else{makeRequest();}});};$.fn.ivAjaxPost.defaults={bindSubmit:true,validate:null,onTrigger:null,onSuccess:null,onError:null,additionalData:{},loading:true};$.fn.validEmail=function(has_plus){var email,hasSpace,regex;if(this.length>1){return false;}email=$(this).val();hasSpace=email.indexOf(" ");if(hasSpace!==-1){return false;}if(email.length>75){return false;}if(typeof(has_plus)!="undefined"&&has_plus){regex=/^[\w-]+(\.[\w-]+)*(\+[\w-]+)*@([\w-]+\.)+[a-zA-Z]{2,7}$/;}else{regex=/^[\w-]+(\.[\w-]+)*@([\w-]+\.)+[a-zA-Z]{2,7}$/;}if(!email.match(regex)){return false;}return true;};$.extend({getUrlVars:function(){var vars=[],hash;var hashes=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var i=0;i<hashes.length;i++){hash=hashes[i].split("=");vars.push(hash[0]);vars[hash[0]]=hash[1];}return vars;},getUrlVar:function(name){return $.getUrlVars()[name];}});})(jQuery);var kohanaLog={add:function(message,level,url){if(typeof message=="undefined"){return false;}if(typeof level=="undefined"){level="debug";}$.ajax({type:"POST",url:"/add-to-logs",cache:false,data:{level:level,message:message,url:url},dataType:"json",error:function(data){return false;},success:function(data){return true;}});}};jQuery.cookie=function(name,value,options){if(typeof value!="undefined"){options=options||{};if(value===null){value="";options.expires=-1;}var expires="";if(options.expires&&(typeof options.expires=="number"||options.expires.toUTCString)){var date;if(typeof options.expires=="number"){date=new Date();date.setTime(date.getTime()+(options.expires*24*60*60*1000));}else{date=options.expires;}expires="; expires="+date.toUTCString();}var path=options.path?"; path="+(options.path):"";var domain=options.domain?"; domain="+(options.domain):"";var secure=options.secure?"; secure":"";document.cookie=[name,"=",encodeURIComponent(value),expires,path,domain,secure].join("");}else{var cookieValue=null;if(document.cookie&&document.cookie!=""){var cookies=document.cookie.split(";");for(var i=0;i<cookies.length;i++){var cookie=jQuery.trim(cookies[i]);if(cookie.substring(0,name.length+1)==(name+"=")){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break;}}}return cookieValue;}};define("jquery/plugin/deferred",[],function(){(function($){jQuery.Deferred=function(){this.callbacks=[];this.fired=false;$.extend(this,{resolve:function(resolveValue){this.resolveValue=resolveValue;this.fired=true;for(x in this.callbacks){this.callbacks[x](resolveValue);}},then:function(fn){if(!this.fired){this.callbacks.push(fn);}else{fn(this.resolveValue);}}});};}(jQuery));});var LazyLoader={};LazyLoader.timer={};LazyLoader.scripts=[];LazyLoader.load=function(url,context,callback){var classname=null,properties=null;try{LazyLoader.scripts.push(url);var script=document.createElement("script");script.src=url;script.type="text/javascript";context.get(0).appendChild(script);if(callback){script.onreadystatechange=function(){if(script.readyState==="loaded"||script.readyState==="complete"){callback();jQuery(script).remove();}};script.onload=function(){callback();jQuery(script).remove();return;};try{if(($.browser.webkit&&!navigator.userAgent.match(/Version\/3/))||$.browser.opera){LazyLoader.timer[url]=setInterval(function(){if(/loaded|complete/.test(document.readyState)){clearInterval(LazyLoader.timer[url]);callback();}},10);}}catch(e){}}}catch(er){alert(er);}};var xrayAd={div:null,viewport:null,thresold:200,elements:[],adBlockCount:0,w:160,h:200,init:function(){this.div=$("#xrayAd");if(!this.div){this.div=$("<div>",{id:"xrayAd",css:{position:"fixed",top:10,left:10,width:this.w,height:this.h,zIndex:10000,background:"rgba(0,0,0, 0.5)"}});this.div.appendTo($("body"));}},viewportUpdate:function(){if(!this.viewport){this.viewport=$("<div>",{id:"xrayAdViewport",css:{position:"absolute",width:this.w,height:10,zIndex:10001,background:"rgba(255,255,255, 0.3)"}});this.viewport.appendTo(this.div);}if(!this.viewThresoldTop){this.viewThresoldTop=$("<div>",{id:"xrayAdThresold",css:{position:"absolute",width:this.w,height:1,zIndex:10002,background:"rgba(255,0,0, 0.5)"}});this.viewThresoldTop.appendTo(this.div);this.viewThresoldBottom=this.viewThresoldTop.clone().appendTo(this.div);}this.bodyHeight=$(document).height();this.bodyWidth=$(window).width();var vH=($(window).height()/this.bodyHeight)*xrayAd.h,vT=($(window).scrollTop()/this.bodyHeight)*xrayAd.h;this.viewport.css({height:vH,top:vT});this.viewThresoldTop.css({top:(($(window).scrollTop()-xrayAd.thresold)/this.bodyHeight)*xrayAd.h});this.viewThresoldBottom.css({top:(($(window).scrollTop()+xrayAd.thresold)/this.bodyHeight)*xrayAd.h+vH-1});if(this.div&&this.div.length){var blocks=this.div.find(".xrayAdBlock");$.each(blocks,function(key,val){var xrayBlock=$(this);var adBlock=$(xrayAd.elements[key]);if(xrayBlock.length&&adBlock.length){var size={};size.off=adBlock.offset();if(size.off){size.top=(size.off.top/xrayAd.bodyHeight)*xrayAd.h;size.left=(size.off.left/xrayAd.bodyWidth)*xrayAd.w;size.w=(Math.max(adBlock.width(),10)/xrayAd.bodyWidth)*xrayAd.w;size.h=(Math.max(adBlock.height(),10)/xrayAd.bodyHeight)*xrayAd.h;var bgColor="#FF0071";bgColor=(adBlock.data("loading")==="true"?"orange":bgColor);bgColor=(adBlock.data("loaded")==="true"?"#00FF00":bgColor);xrayBlock.css({top:size.top,left:size.left,width:size.w,height:size.h,borderColor:bgColor});}}});}},load:function(el,thresold){this.thresold=thresold||0;this.init();var adBlock=$("<div>",{"class":"xrayAdBlock",css:{position:"absolute",background:"#ffffff",border:"1px solid #FF0071",top:0,left:0,width:0,height:0,zIndex:10003}});$.each(el,function(){adBlock.clone().attr("xrayblock","xrayAdBlock_"+(xrayAd.adBlockCount++)).appendTo(xrayAd.div);$(this).bind("onCompleteXray",function(){xrayAd.viewportUpdate();});$(this).bind("onLoadXray",function(){xrayAd.viewportUpdate();});xrayAd.elements.push(this);});xrayAd.viewportUpdate();$(window).bind("scroll",function(event){xrayAd.viewportUpdate();});}};(function($){$.lazyLoadAdRunning=false;$.lazyLoadAdTimers=[];$.fn.lazyLoadAd=function(options){var settings={threshold:0,failurelimit:1,forceLoad:false,event:"scroll",viewport:window,placeholder:false,onLoad:false,onComplete:false,timeout:1500,debug:false,xray:false};if(options){$.extend(settings,options);}function _debug(){if(typeof console!=="undefined"&&settings.debug){var args=[];for(var i=0;i<arguments.length;i++){args.push(arguments[i]);}try{console.info("LazyLoadAD |",args);}catch(e){}}}if(settings.xray&&(typeof xrayAd==="object")){xrayAd.load(this,settings.threshold);}var elements=this;$(settings.viewport).bind("checkLazyLoadAd",function(){var counter=0;elements.each(function(){if($.lazyLoadAdRunning){if($.lazyLoadAdTimers.runTimeOut){clearTimeout($.lazyLoadAdTimers.runTimeOut);}$.lazyLoadAdTimers.runTimeOut=setTimeout(function(){$(settings.viewport).trigger("checkLazyLoadAd");},300);return false;}else{if(settings.forceLoad===true){$(this).trigger("loadAd");}else{if(!$.belowthefold(this,settings)&&!$.abovethetop(this,settings)){$(this).trigger("loadAd");}else{if(counter++>settings.failurelimit){return false;}}}}});var temp=$.grep(elements,function(element){return !(($(element).data("loaded")==="true")?true:false);});elements=$(temp);});if("scroll"===settings.event){$(settings.viewport).bind("scroll",function(event){if(elements.length===0){return false;}$(settings.viewport).trigger("checkLazyLoadAd");});}this.each(function(_index,_value){var self=$(this);if(undefined===self.attr("original")){self.attr("original",self.attr("src"));}self.isLoaded=function(){return((self.data("loaded")==="true")?true:false);};self.bind("debug",function(e,status){status=status||"start";if(settings.xray){if(status==="start"){self.trigger("onLoadXray");}else{if(status==="error"){self.trigger("onErrorXray");}else{if(status==="complete"){self.trigger("onCompleteXray");}}}}if(settings.debug){if(status==="start"){self.css({border:"3px solid orange"});}else{if(status==="error"){self.css({border:"3px solid red"});}else{if(status==="complete"){self.css({border:"3px solid green"});}}}}});self.one("onComplete",function(events,elem){_debug("---> lazyLoadComplete");$(self).removeAttr("original");$.lazyLoadAdRunning=false;self.data("loaded","true");self.trigger("debug","complete");if(typeof settings.onComplete==="function"){try{settings.onComplete(elem[0]);}catch(e){}}});self.stack=[];self.makinaBlock=false;self.bind("makina_go",function(){if(self.makinaBlock){return false;}if(self.stack.length>0){var el=self.stack.shift();var wrapAd=self.find(".wrapAd");if(!wrapAd.length){wrapAd=$('<div class="wrapAd"></div>').clone();wrapAd.appendTo(self);}var wrap=$("<div>").clone().appendTo(wrapAd);if(typeof el==="string"){wrap.replaceWith(el);}else{if(typeof el==="object"){if(el.is("script")){if(el.attr("src")){_debug("JS to load !! --> "+el.attr("src"));LazyLoader.load(el.attr("src"),self,function(){self.makinaBlock=false;_debug("JS to load !! ++> "+el.attr("src"));self.trigger("makina_go");});}else{wrap.replaceWith(el);}}else{wrap.replaceWith(el);}}}self.trigger("makina_go");}else{if($.lazyLoadAdTimers.loadJS){clearTimeout($.lazyLoadAdTimers.loadJS);}$.lazyLoadAdTimers.loadJS=setTimeout(function(){self.trigger("onComplete",[self]);},settings.timeout);}});self.bind("docWrite_direct",function(e,html){var el=$(html);_debug("Fragment Direct Write : ",el,el.length);$.each(el,function(){self.stack.push($(this));});self.trigger("makina_go");});self.bind("docWrite_delayed",function(e,html){_debug("Fragment Delayed Write : ",html);self.numWrappers--;_debug("Fragment append : ",self.numWrappers,html);self.docHtmlCurrent+=html;if(self.numWrappers===0){html=self.docHtmlCurrent;self.docHtmlCurrent="";setTimeout(function(){self.stack.push(html);self.docHtmlCurrent="";self.trigger("makina_go");},0);}});self.numWrappers=0;self.docHtmlCurrent="";self.bind("docWrite_overload",function(){document._writeOriginal=document.write;document.write=document.writeln=function(){var args=arguments,id=null;var html="";for(var i=0;i<args.length;i++){html+=args[i];}var testHTML="",directWrite=false;try{testHTML=$(html);directWrite=((testHTML.is("div")||testHTML.is("script"))?true:false);}catch(e){}self.history[self.fragmentId]=self.history[self.fragmentId]||{};if(self.history[self.fragmentId][html]===undefined){self.history[self.fragmentId][html]=true;if(directWrite){self.trigger("docWrite_direct",html);}else{self.numWrappers++;setTimeout(function(){self.trigger("docWrite_delayed",html);},0);}}};});self.bind("evalCode",function(){var scripts=[],script,regexp=/<code[^>]*>([\s\S]*?)<\/code>/gi;while((script=regexp.exec(self.html()))){var _s=script[1];_s=_s.replace("<!--//<![CDATA[","").replace("//]]>-->","").replace("<!--","").replace("//-->","");_s=_s.replace(/\&gt\;/g,">").replace(/\&lt\;/g,"<");scripts.push($.trim(_s));}try{scripts=(scripts.length?scripts.join("\n"):"");_debug("Script to eval : ",scripts);if(scripts!==""){eval(scripts);}}catch(e){}});self.bind("loadJS",function(e,js2load){var callback=null,script=null;if(js2load.src){callback=js2load.callback||null;js2load=js2load.src;}if(js2load.indexOf("?")===-1){js2load+="?_="+(new Date().getTime());}else{js2load+="&_="+(new Date().getTime());}_debug("loadJS :: ",js2load);LazyLoader.load(js2load,self,function(){_debug("loadJS COMPLETE :: "+js2load);if(callback){callback();}else{$.lazyLoadAdTimers.loadJS=setTimeout(function(){self.trigger("onComplete",[self]);},settings.timeout);}});});self.one("loadAd",function(){if(!self.isLoaded()){$.lazyLoadAdRunning=true;self.data("loading","true");self.trigger("debug","start");var srcOriginal=$(self).attr("original");self.history={};_debug("------------------------------  Lazy Load Ad CALL ----");_debug("Context : ",self);self.trigger("docWrite_overload");self.trigger("evalCode");if(srcOriginal){self.trigger("loadJS",srcOriginal);}}});if("scroll"!==settings.event){self.bind(settings.event,function(event){if(!self.isLoaded()){self.trigger("loadAd");}});}});$(settings.viewport).trigger("checkLazyLoadAd");return this;};$.belowthefold=function(element,settings){var fold=0;if(settings.viewport===undefined||settings.viewport===window){fold=$(window).height()+$(window).scrollTop();}else{fold=$(settings.viewport).offset().top+$(settings.viewport).height();}return fold<=$(element).offset().top-settings.threshold;};$.abovethetop=function(element,settings){var fold=0;if(settings.viewport===undefined||settings.viewport===window){fold=$(window).scrollTop();}else{fold=$(settings.viewport).offset().top;}return fold>=$(element).offset().top+settings.threshold+$(element).height();};})(jQuery);(function($){$.jGrowl=function(m,o){if($("#jGrowl").size()==0){$('<div id="jGrowl"></div>').addClass((o&&o.position)?o.position:$.jGrowl.defaults.position).appendTo("body");}$("#jGrowl").jGrowl(m,o);};$.fn.jGrowl=function(m,o){if($.isFunction(this.each)){var args=arguments;return this.each(function(){var self=this;if($(this).data("jGrowl.instance")==undefined){$(this).data("jGrowl.instance",$.extend(new $.fn.jGrowl(),{notifications:[],element:null,interval:null}));$(this).data("jGrowl.instance").startup(this);}if($.isFunction($(this).data("jGrowl.instance")[m])){$(this).data("jGrowl.instance")[m].apply($(this).data("jGrowl.instance"),$.makeArray(args).slice(1));}else{$(this).data("jGrowl.instance").create(m,o);}});}};$.extend($.fn.jGrowl.prototype,{defaults:{pool:0,header:"",group:"",sticky:false,position:"top-right",glue:"after",theme:"default",themeState:"highlight",corners:"10px",check:250,life:3000,closeDuration:"normal",openDuration:"normal",easing:"swing",closer:true,closeTemplate:"&times;",closerTemplate:"<div>[ close all ]</div>",log:function(e,m,o){},beforeOpen:function(e,m,o){},afterOpen:function(e,m,o){},open:function(e,m,o){},beforeClose:function(e,m,o){},close:function(e,m,o){},animateOpen:{opacity:"show"},animateClose:{opacity:"hide"}},notifications:[],element:null,interval:null,create:function(message,o){var o=$.extend({},this.defaults,o);if(typeof o.speed!=="undefined"){o.openDuration=o.speed;o.closeDuration=o.speed;}this.notifications.push({message:message,options:o});o.log.apply(this.element,[this.element,message,o]);},render:function(notification){var self=this;var message=notification.message;var o=notification.options;var notification=$('<div class="jGrowl-notification '+o.themeState+" ui-corner-all"+((o.group!=undefined&&o.group!="")?" "+o.group:"")+'"><div class="jGrowl-close">'+o.closeTemplate+'</div><div class="jGrowl-header">'+o.header+'</div><div class="jGrowl-message">'+message+"</div></div>").data("jGrowl",o).addClass(o.theme).children("div.jGrowl-close").bind("click.jGrowl",function(){$(this).parent().trigger("jGrowl.close");}).parent();$(notification).bind("mouseover.jGrowl",function(){$("div.jGrowl-notification",self.element).data("jGrowl.pause",true);}).bind("mouseout.jGrowl",function(){$("div.jGrowl-notification",self.element).data("jGrowl.pause",false);}).bind("jGrowl.beforeOpen",function(){if(o.beforeOpen.apply(notification,[notification,message,o,self.element])!=false){$(this).trigger("jGrowl.open");}}).bind("jGrowl.open",function(){if(o.open.apply(notification,[notification,message,o,self.element])!=false){if(o.glue=="after"){$("div.jGrowl-notification:last",self.element).after(notification);}else{$("div.jGrowl-notification:first",self.element).before(notification);}$(this).animate(o.animateOpen,o.openDuration,o.easing,function(){if($.browser.msie&&(parseInt($(this).css("opacity"),10)===1||parseInt($(this).css("opacity"),10)===0)){this.style.removeAttribute("filter");}$(this).data("jGrowl").created=new Date();$(this).trigger("jGrowl.afterOpen");});}}).bind("jGrowl.afterOpen",function(){o.afterOpen.apply(notification,[notification,message,o,self.element]);}).bind("jGrowl.beforeClose",function(){if(o.beforeClose.apply(notification,[notification,message,o,self.element])!=false){$(this).trigger("jGrowl.close");}}).bind("jGrowl.close",function(){$(this).data("jGrowl.pause",true);$(this).animate(o.animateClose,o.closeDuration,o.easing,function(){$(this).remove();var close=o.close.apply(notification,[notification,message,o,self.element]);if($.isFunction(close)){close.apply(notification,[notification,message,o,self.element]);}});}).trigger("jGrowl.beforeOpen");if(o.corners!=""&&$.fn.corner!=undefined){$(notification).corner(o.corners);}if($("div.jGrowl-notification:parent",self.element).size()>1&&$("div.jGrowl-closer",self.element).size()==0&&this.defaults.closer!=false){$(this.defaults.closerTemplate).addClass("jGrowl-closer ui-state-highlight ui-corner-all").addClass(this.defaults.theme).appendTo(self.element).animate(this.defaults.animateOpen,this.defaults.speed,this.defaults.easing).bind("click.jGrowl",function(){$(this).siblings().trigger("jGrowl.beforeClose");if($.isFunction(self.defaults.closer)){self.defaults.closer.apply($(this).parent()[0],[$(this).parent()[0]]);}});}},update:function(){$(this.element).find("div.jGrowl-notification:parent").each(function(){if($(this).data("jGrowl")!=undefined&&$(this).data("jGrowl").created!=undefined&&($(this).data("jGrowl").created.getTime()+parseInt($(this).data("jGrowl").life))<(new Date()).getTime()&&$(this).data("jGrowl").sticky!=true&&($(this).data("jGrowl.pause")==undefined||$(this).data("jGrowl.pause")!=true)){$(this).trigger("jGrowl.beforeClose");}});if(this.notifications.length>0&&(this.defaults.pool==0||$(this.element).find("div.jGrowl-notification:parent").size()<this.defaults.pool)){this.render(this.notifications.shift());}if($(this.element).find("div.jGrowl-notification:parent").size()<2){$(this.element).find("div.jGrowl-closer").animate(this.defaults.animateClose,this.defaults.speed,this.defaults.easing,function(){$(this).remove();});}},startup:function(e){this.element=$(e).addClass("jGrowl").append('<div class="jGrowl-notification"></div>');this.interval=setInterval(function(){$(e).data("jGrowl.instance").update();},parseInt(this.defaults.check));if($.browser.msie&&parseInt($.browser.version)<7&&!window.XMLHttpRequest){$(this.element).addClass("ie6");}},shutdown:function(){$(this.element).removeClass("jGrowl").find("div.jGrowl-notification").remove();clearInterval(this.interval);},close:function(){$(this.element).find("div.jGrowl-notification").each(function(){$(this).trigger("jGrowl.beforeClose");});}});$.jGrowl.defaults=$.fn.jGrowl.prototype.defaults;})(jQuery);iVillage.runners.blocks.tabbed_side=function(){$(".mod-tabbed .tabbed-side").tabs({event:"mouseover",fx:[null,{opacity:"show"}],cookie:{name:"iv-tabbed-side",expires:30},rotate:2000}).addClass("ui-tabs-vertical ui-helper-clearfix").each(function(i,elem){elem=$(elem);if(elem.children(".rotate").length){elem.tabs("rotate",4000);}});$(".mod-tabbed .tabbed-side .ui-tabs-panel").not(".no-link").each(function(i,elem){var hero_link=$(this).find(".meta a").attr("href");$(this).hover(function(){$(this).css("cursor","pointer");},function(){$(this).css("cursor","default");}).click(function(e){if($(e.target).parent().attr("id")==$(this).attr("id")){e.preventDefault();window.location=hero_link;}});$(".tabbed-side-nav a[href='#"+$(this).attr("id")+"']").click(function(e){if(window.event){CS_onClickHandler(e);}window.location=hero_link;});});};iVillage.runners.blocks.hp_photos_tabbed_side=function(){$(".mod-tabbed .hp-tabbed-side").tabs({event:"mouseover",fx:[null,{opacity:"show"}],rotate:2000}).addClass("ui-tabs-vertical ui-helper-clearfix").each(function(i,elem){elem=$(elem);if(elem.children(".rotate").length){elem.tabs("rotate",4000);}});$(".mod-tabbed .hp-tabbed-side .ui-tabs-panel").not(".no-link").each(function(i,elem){var hero_link=$(this).find(".no-meta a").attr("href");$(this).hover(function(){$(this).css("cursor","pointer");},function(){$(this).css("cursor","default");}).click(function(e){if($(e.target).parent().attr("id")==$(this).attr("id")){e.preventDefault();window.location=hero_link;}});$(".tabbed-side-nav a[href='#"+$(this).attr("id")+"']").click(function(e){if(window.event){CS_onClickHandler(e);}window.location=hero_link;});});};iVillage.runners.blocks.tabbed_health_conditions=function(){$(".mod-tabbed .tabbed-health-conditions").tabs({fx:{opacity:"toggle",duration:"medium"},cookie:{name:"iv-tabbed-top",expires:30}});};iVillage.runners.blocks.tabbed_food_hero=function(){if(iVillage.msie6){$("#home-hero").tabs({cookie:{expires:30}});}else{$("#home-hero").tabs({cookie:{expires:30},fx:{opacity:"toggle",duration:"medium"}});}};iVillage.runners.blocks.tabbed_home_hero=function(){if(iVillage.msie6){$("#home-hero").tabs({event:"mouseover"});}else{$("#home-hero").tabs({event:"mouseover",fx:{opacity:"toggle",duration:"medium"}});}};(function($){iVillage.runners.blocks.nav=function(){var onNavMouseEnter=function(){$(this).find(".subnav").css("display","block");$("ul.current-page").css("z-index","100");$(this).find(".subnav").css("z-index","1000");$(this).children("a").addClass("current");if(!$(this).hasClass("l")&&!$(this).children("a").hasClass("current-page")){$(this).children("a").children("span").css("border-right","1px dotted transparent");}if($(this).prev().length!=0&&!$(this).prev().children("a").hasClass("current-page")){$(this).prev().children("a").children("span").css("border-right","1px dotted transparent");}if($(this).find(".subnav").length!=0){$(this).parent().find("a.current-page").css("padding-bottom","3px");$(this).children("a").css("padding-bottom","5px");}else{$(this).children("a").css("padding-bottom","3px");}};var onNavMouseLeave=function(){$(this).find(".subnav").css("display","none");$("ul.current-page").css("z-index","1000");$("ul.current-page").css("display","block");$(this).find(".subnav").css("z-index","100");$(this).children("a").removeClass("current");if(!$(this).hasClass("l")&&!$(this).next().children("a").hasClass("current-page")&&!$(this).children("a").hasClass("current-page")){$(this).children("a").children("span").css("border-right","1px dotted #000000");}if($(this).prev().length!=0&&!$(this).prev().children("a").hasClass("current-page")&&!$(this).children("a").hasClass("current-page")){$(this).prev().children("a").children("span").css("border-right","1px dotted #000000");}if($(this).find(".subnav").length!=0){$(this).parent().find("a.current-page").css("padding-bottom","5px");}else{$(this).children("a").css("padding-bottom","5px");}};var navHoverIntentConfig={over:onNavMouseEnter,out:onNavMouseLeave};$("#Top-Navigation > li").hoverIntent(navHoverIntentConfig).each(function(index,value){if($(this).children("a").hasClass("current-page")&&$(this).prev().length!=0){$(this).prev().children("a").children("span").css("border-right","1px dotted transparent");}});var onSubNavMouseEnter=function(){$(this).find(".sub-subnav").css("display","block");$(this).children("a").addClass("hover");};var onSubNavMouseLeave=function(){$(this).find(".sub-subnav").css("display","none");$(this).children("a").removeClass("hover");};var subNavHoverIntentConfig={over:onSubNavMouseEnter,out:onSubNavMouseLeave};$("#Top-Navigation").find(".subnav > li").hoverIntent(subNavHoverIntentConfig);};})(jQuery);(function($){iVillage.runners.blocks.newsletter_signup=function(){var signup=$(".mod-newsletter-signup #newsletter-signup");var webkit=(typeof $.browser.webkit!="undefined")?true:false;var Newsletter={hide_status:function(){var status=$(".mod-newsletter-signup .status");if(status.hasClass("showing")){status.fadeOut(0,function(){status.removeClass("showing error message");});}},reset_status:function(){$(".mod-newsletter-signup .status").removeClass("message error progress");},add_error:function(s){var status=$(".mod-newsletter-signup .status");Newsletter.reset_status();status.text(s).addClass("showing error").show(0);},add_message:function(s){var signup=$(".mod-newsletter-signup");var thanks=$(".mod-newsletter-thanks");if(!iVillage.msie){signup.fadeOut(((webkit)?0:"slow"),function(){thanks.hide(0).removeClass("hide").show(0);});}else{signup.hide(0);thanks.removeClass("hide");}},add_progress:function(s){var status=$(".mod-newsletter-signup").find(".status");Newsletter.reset_status();status.text(s).addClass("showing").addClass("progress");(webkit)?status.show(0):status.fadeIn();},bind_tout:function(email){$(".tout-form").bind("submit",function(e){var form=$(this);var tout=form.parents(".tout");var params=$(this).serialize();$.post(form.attr("action"),params,function(data){if(data.status){tout.hide(0);iVillage.omniEvent(null,28,"Newsletter Special Promotions");}});e.preventDefault();return false;});}};if($(".mod-newsletter-signup").length>0){var status=$(".mod-newsletter-signup .status");status.hide(0);signup.find("input.input-newsletter-signup").bind("focus",function(){if($(this).val()==$(this)[0].title){$(this).removeClass("default_text");$(this).val("");}});signup.find("input.input-newsletter-signup").bind("blur",function(){if($(this).val()==""){$(this).addClass("default_text");$(this).val($(this)[0].title);}});if(parseInt(signup.find("#hasdate").val())){signup.find("li.newsletter-types").each(function(index){var currentLi=$(this);var currentYY=currentLi.find("#startdate_yy");var currentMM=currentLi.find("#startdate_mm");var currentDD=currentLi.find("#startdate_dd");var letterStartDate=currentLi.find("#startdate");currentMM.bind("change",function(){date_string=currentYY.val()+"-"+currentMM.val()+"-"+currentDD.val();letterStartDate.val(date_string);});currentDD.bind("change",function(){date_string=currentYY.val()+"-"+currentMM.val()+"-"+currentDD.val();letterStartDate.val(date_string);});currentYY.bind("change",function(){date_string=currentYY.val()+"-"+currentMM.val()+"-"+currentDD.val();letterStartDate.val(date_string);});});}signup.find("input").bind("focus",Newsletter.hide_status);signup.find("input.input-newsletter-signup").blur();signup.find("input[type=checkbox]").bind("click",function(){console.log("am i checked: "+$(this).attr("checked"));var selectedBox=signup.find("li#"+$(this).attr("id")+" .date-select");if($(this).attr("checked")){selectedBox.css("display","none").removeClass("hide");selectedBox.fadeIn(500);}else{selectedBox.fadeOut(500);selectedBox.addClass("hide");}});signup.bind("submit",function(e){e.preventDefault();var form=$(this);var params=form.serialize();var action=$(this).attr("action");var email=signup.find("input.input-newsletter-signup");Newsletter.add_progress("Please wait, updating...");if(signup.find("input[type=checkbox]:checked").length==0){Newsletter.add_error("Please select a newsletter.");return false;}if($(".mod-newsletter-signup #startdate").length&&$(".mod-newsletter-signup .date-select").css("display")!="none"&&!($(".mod-newsletter-signup .date-select").hasClass("hide"))){if($(".mod-newsletter-signup #startdate_mm").length>0&&$.trim($(".mod-newsletter-signup #startdate_mm").val()).length==0){Newsletter.add_error("Please provide a month.");return false;}if($(".mod-newsletter-signup #startdate_mm").length>0&&$.trim($(".mod-newsletter-signup #startdate_dd").val()).length==0){Newsletter.add_error("Please provide a day.");return false;}if($(".mod-newsletter-signup #startdate_mm").length>0&&$.trim($(".mod-newsletter-signup #startdate_yy").val()).length==0){Newsletter.add_error("Please provide a year.");return false;}var re=/^\d{4}-\d{2}-\d{2}$/;if(!re.test($(".mod-newsletter-signup #startdate").val())){Newsletter.add_error("Please provide a valid date.");return false;}}if(email.val()==email[0].title||!email.validEmail(true)){Newsletter.add_error("Please provide a valid email address.");return false;}$(".tout-email").val(email.val());$.ajax({type:"POST",url:action,data:params,success:function(data){status.slideUp(((webkit)?0:"fast"),function(){if(data.status){Newsletter.bind_tout(email.val());Newsletter.add_message("Thanks for signing up!");if(typeof iVillage==="object"&&typeof iVillage.omniEvent==="function"){var omniIds=[];form.find("input.omniture_id").each(function(){var that=$(this);var nl=that.attr("id").replace("omniture","newsletter");nl="#"+nl+":checked";nl=$(nl);if(nl.length){omniIds.push(that.val());}});if(omniIds.length>0){if(window.location!=window.parent.location){parent.iVillage.omniEvent(31,24,"Newsletter registration",null,omniIds);}else{iVillage.omniEvent(31,24,"Newsletter registration",null,omniIds);}}}}else{Newsletter.add_error(data.error);}});},error:function(XMLHttpRequest,textStatus,errorThrown){console.log("XMLHttpRequest "+XMLHttpRequest);console.log("textStatus "+textStatus);console.log("errorThrown "+errorThrown);},dataType:"json"});return false;});}};})(jQuery);(function($){iVillage.runners.blocks.challenges_signup=function(){if($(".mod-challenges-signup").length>0){var $signup=$(".mod-challenges-signup .challenges-signup-form");var webkit=(typeof $.browser.webkit!="undefined")?true:false;console.log("Entering challenges");$signup.each(function(){var signup=this;var $signup=$(this);var $container=$(this).parents(".mod-challenges-signup");var $status=$container.find(".status");var $thanks=$container.find(".mod-challenges-thanks");var $tout_form=$container.find(".tout-form");var $tout_email=$container.find(".tout-email");console.log("Tout len: "+$tout_form.length);this.newsletter={hide_status:function(){if($status.hasClass("showing")){$status.fadeOut(0,function(){$status.removeClass("showing error message");});}},reset_status:function(){$status.removeClass("message error progress");},add_error:function(s){this.reset_status();$status.text(s).addClass("showing error").show(0);},add_message:function(s){if(!iVillage.msie){$signup.fadeOut(((webkit)?0:"slow"),function(){$thanks.hide(0).removeClass("hide").show(0);});}else{$signup.hide(0);$thanks.removeClass("hide");}},add_progress:function(s){this.reset_status();$status.text(s).addClass("showing").addClass("progress");if(webkit){$status.show(0);}else{$status.fadeIn();}},bind_tout:function(){console.log("Tout: "+$tout_form.length);$tout_form.bind("submit",function(e){var $form=$(this);var $tout=$tout_form.parent(".tout");var params=$(this).serialize();$.post($form.attr("action"),params,function(data){if(data.status){$tout.hide(0);iVillage.omniEvent(null,28,"Newsletter Special Promotions");}});e.preventDefault();return false;});}};if($(this).length>0){$(this).find("input.input-challenge-signup").bind("focus",function(){if($(this).val()==$(this)[0].title){$(this).removeClass("default_text");$(this).val("");}});$(this).find("input.input-challenge-signup").bind("blur",function(){if($(this).val()===""){$(this).addClass("default_text");$(this).val($(this)[0].title);}});if(parseInt($(this).find("input.hasdate").val(),10)){$(this).find("li.newsletter-types").each(function(index){var $currentLi=$(this);var $currentYY=$currentLi.find(".startdate_yy");var $currentMM=$currentLi.find(".startdate_mm");var $currentDD=$currentLi.find(".startdate_dd");var $letterStartDate=$currentLi.find(".startdate");$currentMM.bind("change",function(){date_string=$currentYY.val()+"-"+$currentMM.val()+"-"+$currentDD.val();$letterStartDate.val(date_string);});$currentDD.bind("change",function(){date_string=$currentYY.val()+"-"+$currentMM.val()+"-"+$currentDD.val();$letterStartDate.val(date_string);});$currentYY.bind("change",function(){date_string=$currentYY.val()+"-"+$currentMM.val()+"-"+$currentDD.val();$letterStartDate.val(date_string);});});}$(this).find("input").bind("focus",this.newsletter.hide_status);$(this).find("input.input-challenges-signup").blur();$(this).find("input[type=checkbox]").bind("click",function(){console.log("am i checked: "+$(this).attr("checked"));var $selectedBox=$(this).parent("li").find(".date-select");if($(this).attr("checked")){$selectedBox.css("display","none").removeClass("hide");$selectedBox.fadeIn(500);}else{$selectedBox.fadeOut(500);$selectedBox.addClass("hide");}});$(this).bind("submit",function(e){e.preventDefault();var $form=$(this);var $email=$(this).find("input.input-challenges-signup");var action=$(this).attr("action");var params=$form.serialize();if($(this).find("input[type=checkbox]:checked").length===0){this.newsletter.add_error("Please select a challenge.");return false;}if($(".mod-newsletter-signup .startdate").length&&$(".mod-newsletter-signup .date-select").css("display")!="none"&&!($(".mod-newsletter-signup .date-select").hasClass("hide"))){if($(".mod-newsletter-signup .startdate_mm").length>0&&$.trim($(".mod-newsletter-signup .startdate_mm").val()).length===0){this.newsletter.add_error("Please provide a month.");return false;}if($(".mod-newsletter-signup .startdate_mm").length>0&&$.trim($(".mod-newsletter-signup .startdate_dd").val()).length===0){this.newsletter.add_error("Please provide a day.");return false;}if($(".mod-newsletter-signup .startdate_mm").length>0&&$.trim($(".mod-newsletter-signup .startdate_yy").val()).length===0){this.newsletter.add_error("Please provide a year.");return false;}var re=/^\d{4}-\d{2}-\d{2}$/;if(!re.test($(".mod-newsletter-signup .startdate").val())){this.newsletter.add_error("Please provide a valid date.");return false;}}if($email.val()==$email[0].title||!$email.validEmail(true)){this.newsletter.add_error("Please provide a valid email address.");return false;}$tout_email.val($email.val());console.log("Email: "+$email.val());console.log("Tout email: "+$tout_email.val());$.ajax({type:"POST",url:action,data:params,success:function(data){console.log("Success");$signup.slideUp(((webkit)?0:"fast"),function(){$thanks.removeClass("hide");signup.newsletter.hide_status();console.log("Status: "+data.status);if(data.status){signup.newsletter.bind_tout();signup.newsletter.add_message("Thanks for signing up!");if(typeof iVillage==="object"&&typeof iVillage.omniEvent==="function"){var omniIds=[];$form.find("input.omniture_id").each(function(){var that=$(this);var nl=that.attr("id").replace("omniture","newsletter");nl="#"+nl+":checked";nl=$(nl);if(nl.length){omniIds.push(that.val());}});if(omniIds.length>0){if(window.location!=window.parent.location){parent.iVillage.omniEvent(31,24,"Newsletter registration",null,omniIds);}else{iVillage.omniEvent(31,24,"Newsletter registration",null,omniIds);}}}}else{signup.newsletter.add_error(data.error);console.log("Status error: "+data.error);}});},error:function(XMLHttpRequest,textStatus,errorThrown){console.log("XMLHttpRequest "+XMLHttpRequest);console.log("textStatus "+textStatus);console.log("errorThrown "+errorThrown);},dataType:"json"});return false;});}});}};})(jQuery);(function($){iVillage.runners.blocks.lazyloadad=function(){var options={bgColor:"#eee",forceLoad:true,debug:false,xray:false,debug:false,ids:[],onComplete:$.proxy(function(adLoaded){console.warn("lazy load ad completed");alignAds(adLoaded);},this)};$(".ad-wrap").each(function(){var id=$(this).parent().attr("id");options.ids.push(id);});function loadAds(){for(var i=0;i<options.ids.length;i++){if(options.ids[i]!=""){var ad=$("#"+options.ids[i]);if(ad.find("code").length>0){ad.find(".ad-wrap").lazyLoadAd(options);}}}}function alignAds(ad){$(ad).find("div").css("margin","0 auto");}loadAds();};})(jQuery);var google_adnum=0;var google_ad_placement="";function google_ad_request_done(google_ads){var s="";var i;if(google_ads.length==0){return;}if(google_ads[0].type=="flash"){s+='<a href="'+google_info.feedback_url+'" style="color:000000">Ads by Google</a><br><object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" WIDTH="'+google_ad.image_width+'" HEIGHT="'+google_ad.image_height+'"> <PARAM NAME="movie" VALUE="'+google_ad.image_url+'"><PARAM NAME="quality" VALUE="high"><PARAM NAME="AllowScriptAccess" VALUE="never"><EMBED src="'+google_ad.image_url+'" WIDTH="'+google_ad.image_width+'" HEIGHT="'+google_ad.image_height+'" TYPE="application/x-shockwave-flash" AllowScriptAccess="never"  PLUGINSPAGE="http://www.macromedia.com/go/getflashplayer"></EMBED></OBJECT>';}else{if(google_ads[0].type=="image"){s+='<a href="'+google_info.feedback_url+'" style="color:000000">Ads by Google</a><br> <a href="'+google_ads[0].url+'" target="_top" title="go to '+google_ads[0].visible_url+'" onmouseout="window.status=\'\'" onmouseover="window.status=\'go to '+google_ads[0].visible_url+'\';return true"><img border="0" src="'+google_ads[0].image_url+'"width="'+google_ads[0].image_width+'"height="'+google_ads[0].image_height+'"></a>';}else{if(google_ads[0].type=="html"){s+='<a href="'+google_info.feedback_url+'" style="color:000000">Ads by Google</a><br>'+google_ads[0].snippet;}else{s+='<a href="'+google_info.feedback_url+'" style="color:000000">Ads by Google</a><br>';for(i=0;i<google_ads.length;++i){var start_tag='<div class="adWrapper" style="float:left">';var end_tag="</div>";var googleAdOrientationClassName="googleAdOrientation_horizontal";if((typeof google_ad_orientation!="undefined"&&google_ad_orientation=="vertical")||google_ads.length==1){start_tag='<div class="adWrapper_vertical">';end_tag="</div>";googleAdOrientationClassName="googleAdOrientation_vertical";start_tag='<div class="adWrapper">';}s+=start_tag+'<a style="text-decoration:none" href="'+google_ads[i].url+'" onmouseout="window.status=\'\'" onmouseover="window.status=\'go to '+google_ads[i].visible_url+'\';return true"> <span style="text-decoration:underline"> <b>'+google_ads[i].line1+'</b><br></span></a> <span style="color:#000000">'+google_ads[i].line2;if((typeof google_ad_orientation!="undefined"&&google_ad_orientation=="vertical")||google_ads.length==1){s+="&nbsp;";}else{s+="<br>";}s+=google_ads[i].line3+'<br></span> <a style="color:#008000;text-decoration:none" href="'+google_ads[i].url+'" onmouseout="window.status=\'\'" onmouseover="window.status=\'go to '+google_ads[i].visible_url+"';return true\"><span>"+google_ads[i].visible_url+"</span></a>"+end_tag;}s=s+'<div class="adClearer"></div>';}}}if(google_ads[0].bidtype=="CPC"){google_adnum=google_adnum+google_ads.length;}document.getElementById(google_ad_placement).innerHTML="<div class='"+googleAdOrientationClassName+"'><div class='googleAdPlaceholder'>"+s+"</div></div>";return;}(function(){iVillage.defaults={comments:{display_comments:3,see_all_link:true,valid_listener:"CC_STATUS"},charcounter:{char_limit:800},shoppingList:function(){if($.isFunction($.shoppingList)){window.shopping_list=$(".mod-shopping-list").shoppingList();}},panelTabs:function(){var options={event:"mouseover",fx:[null,{opacity:"show"}],cookie:{name:"iv-tabbed-side",expires:30},rotate:2000};$(".pane-carousel-tabbed .content .container").tabs(options);$("#TabsCarousel").tabs({event:"click",fx:[null,{opacity:"show"}],cookie:{name:"iv-tabbed-side",expires:30},rotate:2000});$(".pane-carousel-tabbed .content .container ul li a").click(function(){var url=$(this).attr("data-href");window.location.href=url;});},panels:function(){$("img").error(function(){$(this).attr("src","/public/images/pixel.gif");});}};})();(function(){iVillage.templates={Global:{blocks:["nav","newsletter_signup","share_tools",["care_circle_globals","health"],["care_circle_overlay","health"],["care_circle_small","health"],"follow_save_share_print","third_party","lazyloadad","tests"]},Chooser_Controller:{index:{blocks:["chooser_tool"]}},Static_Page_Controller:{show:{blocks:["dream_kitchen_tool"]}},Content_Controller:{show:{blocks:[]}},Look_It_Up_Controller:{index:{blocks:["follow_ivillage"]},landing:{blocks:["follow_ivillage"]}},Advice_Controller:{index:{blocks:["carousel_horizontal","snack_swapper"]}},Food_For_Kids_Controller:{index:{blocks:["carousel_horizontal","snack_swapper","polls_standard"],plugins:[["#comments","comments",iVillage.defaults.comments],["#comments","charcounter",iVillage.defaults.charcounter]]}},Games_Controller:{index:{blocks:["carousel_horizontal","games"]},show:{blocks:["games"]},brain:{blocks:["carousel_horizontal","games"]}},pages_Controller:{funnel_two:{blocks:["funnel_two","faccordion"]},funnel_five:{blocks:["funnel_five","faccordion"]},funnel_two:{blocks:["funnel_nine","faccordion"]}},Entertainment_Controller:{index:{blocks:["carousel_big","nbc_player_4_0_large"],plugins:[["#comments","charcounter"]]}},Beauty_Controller:{index:{blocks:["hero_three_element_carousel","polls_beauty"]}},Deals_Controller:{index:{blocks:["polls_beauty"]}},Makeover_Controller:{index:{plugins:[[".top-items ul li","tryItOnOverlay"],[".top-items ul li","addHover"]]},member:{plugins:[[".top-items ul li","tryItOnOverlay"],[".top-items ul li","addHover"]]},makeover_tool:{blocks:["makeovermatic"],plugins:[[".top-items ul li","tryItOnOverlay"],[".top-items ul li","addHover"]]}},Skinsolver_Controller:{results:{blocks:["skinsolverAds"]}},Product_Lists_Controller:{show:{blocks:["article","follow_ivillage","characterCount"],plugins:[["#comments","comments",iVillage.defaults.comments],["#comments","charcounter",iVillage.defaults.charcounter]]}},Stuff_We_Love_Controller:{product_search:{blocks:["stuff_we_love"]}},Health_Controller:{index:{blocks:["follow_ivillage","tabbed_side","care_circle_home"]}},Health_Conditions_Controller:{index:{blocks:["follow_ivillage"]},show:{blocks:["healthwise","sponsored"]},show_sub:{blocks:["healthwise","follow_ivillage"]}},Healthwise_Controller:{show:{blocks:["follow_ivillage","healthwise"]},show_sub:{blocks:["healthwise"]},tier_c_condition_report:{blocks:["follow_ivillage","healthwise"]},drug_result:{blocks:["follow_ivillage","healthwise"]},test_proc_result:{blocks:["follow_ivillage","healthwise"]}},Articles_Controller:{show:{blocks:["article","follow_ivillage","polls_standard","sponsored",["rating","health"]],plugins:[["#comments","comments",{display_comments:3,see_all_link:true,valid_listener:"CC_STATUS",comments_ul:".comments"}],["#comments","charcounter",iVillage.defaults.charcounter]]},index:{blocks:["follow_ivillage","polls_multiple_choice","centered_title","carousel_horizontal","nbc_player_4_0_large"]}},Experts_Controller:{show:{blocks:["follow_ivillage","qa","qa_submit","centered_title","sponsored"],plugins:[[".expandable .trigger","qa"]]}},Diet_Fitness_Controller:{index:{blocks:["follow_ivillage","tabbed_side","toolkit","share_your_story"]}},Videos_Controller:{index:{blocks:["follow_ivillage","nbc_player_4_0_large","videos","new_this_week_carousel"]},show:{blocks:["follow_ivillage","nbc_player_4_0_large","videos","new_this_week_carousel"]}},Packages_Controller:{show:{blocks:["tabbed_side","follow_ivillage","nbc_player_4_0_large","polls_multiple_choice","new_this_week_carousel","carousel_horizontal"],plugins:[["#comments","comments",iVillage.defaults.comments],["#comments","charcounter",iVillage.defaults.charcounter]]}},Profile_Controller:{private_profile:{blocks:["private_profile"]},public_profile:{blocks:["public_profile"]},public_user_profile:{blocks:["public_profile"]},photos:{blocks:["private_photos"]},photo_public_view:{blocks:["public_photos"]},account_info:{blocks:["account_info"]},newsletters:{blocks:["account_newsletters"]},signatures:{blocks:["account_signatures"]},add_signatures:{blocks:["account_add_signatures"]},loyalty_rewards:{blocks:["user_rewards"]},public_user_rewards:{blocks:["user_rewards"]},public_rewards:{blocks:["user_rewards"]}},Healthy_Living_Controller:{index:{blocks:["centered_title","coupons","follow_ivillage","tabbed_side"]}},Health_Love_Sex_Controller:{index:{blocks:["centered_title","coupons","follow_ivillage","tabbed_side"]}},Kids_Health_Controller:{index:{blocks:["coupons","follow_ivillage","tabbed_side","newsletter_expecting","ask_your_question","health_by_age"]}},Panel_Pages_Controller:{routed:{blocks:["nbc_player_4_0_large","videos","stripCarousel","panel_tabbed_pane","tabbed_home_hero","challenges_signup","challenge_signup_form","challenge_assignment_slider","holidaily_bg_image_flip","ivote_bg_image","join_challenge_signup_form","google_conversion","height_equalize"],fire:function(){iVillage.defaults.panelTabs();iVillage.defaults.panels();}}},Parenting_Panel_Controller:{routed:{blocks:["stripCarousel","panel_tabbed_pane","tabbed_home_hero"],fire:function(){iVillage.defaults.panelTabs();iVillage.defaults.panels();}}},Health_Panel_Controller:{routed:{blocks:["stripCarousel","panel_tabbed_pane","tabbed_home_hero"],fire:function(){iVillage.defaults.panelTabs();iVillage.defaults.panels();}}},Entertainment_Panel_Controller:{routed:{blocks:["stripCarousel","panel_tabbed_pane","tabbed_home_hero"],fire:function(){iVillage.defaults.panelTabs();iVillage.defaults.panels();}}},Beauty_Panel_Controller:{routed:{blocks:["stripCarousel","panel_tabbed_pane","tabbed_home_hero"],fire:function(){iVillage.defaults.panelTabs();iVillage.defaults.panels();}}},Food_Panel_Controller:{routed:{blocks:["stripCarousel","panel_tabbed_pane","tabbed_home_hero"],fire:function(){iVillage.defaults.panelTabs();iVillage.defaults.panels();}}},Homeandgarden_Panel_Controller:{routed:{blocks:["stripCarousel","panel_tabbed_pane","tabbed_home_hero"],fire:function(){iVillage.defaults.panelTabs();iVillage.defaults.panels();}}},Love_Panel_Controller:{routed:{blocks:["stripCarousel","panel_tabbed_pane","tabbed_home_hero"],fire:function(){iVillage.defaults.panelTabs();iVillage.defaults.panels();}}},Photo_Hub_Panel_Controller:{routed:{blocks:["stripCarousel","panel_tabbed_pane","tabbed_home_hero"],fire:function(){iVillage.defaults.panelTabs();iVillage.defaults.panels();}}},Video_Hub_Panel_Controller:{routed:{blocks:["nbc_player_4_0_large","videos","stripCarousel","panel_tabbed_pane","tabbed_home_hero"],fire:function(){iVillage.defaults.panelTabs();iVillage.defaults.panels();$(".pane-ad").each(function(){var elem=$(this).find("object, embed");if(elem.length>0){var objectWidth=elem.width();$(this).find("div").width(objectWidth);$(this).width(objectWidth).css("margin","0 auto");}});if($("title").text().indexOf("My Best Idea")!=-1){$("body").addClass("layout-flexible-best-idea").removeClass("layout-flexible-challenges");}}}},Challenges_Panel_Controller:{routed:{blocks:["challenge_signup_form","challenge_assignment_slider","join_challenge_signup_form","challenges_signup","google_conversion"],fire:function(){iVillage.defaults.panelTabs();iVillage.defaults.panels();}}},Sweepstakes_Controller:{show:{blocks:["sweepstakes_runner"]}},Content_Rating_Page_Controller:{show:{blocks:["content_rating_page"],plugins:[["#comments","comments",iVillage.defaults.comments],["#comments","charcounter",iVillage.defaults.charcounter]]}},Quizzes_Controller:{show:{blocks:["follow_ivillage","quizzes","sponsored"],plugins:[["#comments","comments",iVillage.defaults.comments],["#comments","charcounter",iVillage.defaults.charcounter]]}},Slideshows_Controller:{show:{blocks:["slideshow","follow_ivillage","sponsored","polls_standard"],plugins:[["#comments","comments",iVillage.defaults.comments],["#comments","charcounter",iVillage.defaults.charcounter]]},index:{blocks:["carousel_horizontal"]}},Health_Topics_Controller:{show:{blocks:["follow_ivillage","tabbed_side","healthwise","sponsored"]}},Share_Your_Story_Controller:{index:{blocks:["follow_ivillage","share_your_story"],plugins:[["#comments","charcounter",iVillage.defaults.charcounter]]}},Calories_Burned_Calculator_Controller:{index:{blocks:["calories_burned_calculator"]}},Symptom_Checker_Controller:{index:{blocks:["follow_ivillage","symptom_checker_globals","symptom_checker_locals"]}},Beyond_Bmi_Controller:{index:{blocks:["follow_ivillage","beyond_bmi","jquery_validate_min"]},result:{blocks:["follow_ivillage","beyond_bmi"]}},Browse_Controller:{index:{blocks:["coupons","follow_ivillage","browse_shortcuts"]}},Tools_Controller:{index:{blocks:[]}},Health_Decision_Points_Controller:{show:{blocks:["healthwise","decision_point"]}},QA_Controller:{index:{blocks:["ask_your_question"]}},QA_Articles_Controller:{index:{plugins:[["#comments","comments",iVillage.defaults.comments],["#comments","charcounter",iVillage.defaults.charcounter]]},show:{blocks:[["ask_your_question","parenting"]],plugins:[["#comments","comments",iVillage.defaults.comments],["#comments","charcounter",iVillage.defaults.charcounter]]}},Parenting_Controller:{index:{blocks:["centered_title","tabbed_side","polls_parenting","chatter","ask_your_question"]},wrapper:{blocks:["centered_title","tabbed_side","polls_parenting","chatter","ask_your_question"]}},Products_Controller:{show:{blocks:["rating"],plugins:[["#comments","comments",iVillage.defaults.comments],["#comments","charcounter",iVillage.defaults.charcounter]]}},Parenting_Weeks_Controller:{show:{blocks:["tabbed_side","weeks_tabbed","centered_title","ask_your_question"],plugins:[[".my-week-by-week","parenting_calendar"]]}},Sub_Channel_Controller:{show:{blocks:["centered_title"]}},Pregnancy_Controller:{index:{blocks:["centered_title","ask_your_question"]}},Baby_Controller:{index:{blocks:["centered_title","ask_your_question"],plugins:[[".my-week-by-week","parenting_calendar"]]}},Toddler_Preschool_Controller:{index:{blocks:["centered_title","ask_your_question"]}},Due_Date_Predictor_Controller:{index:{blocks:["due_date"]}},Ovulation_Predictor_Controller:{index:{blocks:["ovulation_predictor"]}},Chinese_Gender_Chart_Controller:{index:{blocks:["chinese_gender_chart"]}},Pregnancy_Calendar_Controller:{index:{plugins:[[".my-week-by-week","parenting_calendar"]]}},Baby_Calendar_Controller:{index:{plugins:[[".my-week-by-week","parenting_calendar"]]}},Ivillage_Controller:{index:{blocks:["tabbed_home_hero","polls_standard","hp_photos_tabbed_side","vertical_ticker","new_window_opener","media_tabs"],plugins:[["#comments","comments",iVillage.defaults.comments],["#comments","charcounter",iVillage.defaults.charcounter]],fire:function(){}}},Food_Controller:{index:{blocks:["tabbed_food_hero","polls_standard"],plugins:[["#comments","comments",iVillage.defaults.comments],["#comments","charcounter",iVillage.defaults.charcounter]],fire:function(){iVillage.defaults.shoppingList();
}}},Love_Sex_Controller:{index:{blocks:["ask_your_question"]}},Big_Kids_Controller:{index:{blocks:["ask_your_question"]}},Parenting_Topics_Controller:{show:{blocks:["ask_your_question"]}},Homeandgarden_Controller:{index:{blocks:["tabbed_side","ask_your_question"]}},Family_Finance_Controller:{index:{blocks:["ask_your_question"]}},Homemaking_Controller:{index:{blocks:["ask_your_question"]}},Gardening_Controller:{index:{blocks:["ask_your_question"]}},Calendar_Controller:{index:{blocks:["activity_browser"]}},Calendar_Controller:{index:{blocks:["activity_browser"]}},Table_Talk_Controller:{index:{plugins:[["#comments","comments",iVillage.defaults.comments],["#comments","charcounter",iVillage.defaults.charcounter]]}},Baby_Calendar_Controller:{index:{plugins:[[".my-week-by-week","parenting_calendar"]]}},Food_Controller:{index:{blocks:["tabbed_food_hero","polls_standard"],plugins:[["#comments","comments",iVillage.defaults.comments],["#comments","charcounter",iVillage.defaults.charcounter]],fire:function(){iVillage.defaults.shoppingList();}}},Love_Sex_Controller:{index:{blocks:["ask_your_question"]}},Big_Kids_Controller:{index:{blocks:["ask_your_question"]}},Parenting_Topics_Controller:{show:{blocks:["ask_your_question"]}},Calendar_Controller:{index:{blocks:["activity_browser"]}},Table_Talk_Controller:{index:{plugins:[["#comments","comments",iVillage.defaults.comments],["#comments","charcounter",iVillage.defaults.charcounter]]}},Baby_Calendar_Controller:{index:{plugins:[[".my-week-by-week","parenting_calendar"]]}},Recipes_Controller:{show:{blocks:["rating","recipes","coupons"],plugins:[["#twists","twists"],["#comments","comments",{display_comments:3,see_all_link:true,valid_listener:"CC_STATUS",comments_container:"ul.pnl-twists",comments_ul:"ul.pnl-twists",content_type:"twists",submit_btn:".twists-submit",rating:true,render_external:function(data,source_data){return $.fn.twists.renderComment(data,source_data);}}],["#comments","charcounter",{char_limit:400}]],fire:function(){iVillage.defaults.shoppingList();}},index:{blocks:["recipe_tabs_hookup"],plugins:[["#comments","comments",iVillage.defaults.comments],["#comments","charcounter",iVillage.defaults.charcounter]]}},UGC_Recipes_Controller:{congrats:{plugins:[["#comments","comments",iVillage.defaults.comments],["#comments","charcounter",iVillage.defaults.charcounter]]}},Home_Inspiration_Controller:{slideshow:{blocks:["slideshow","follow_ivillage","sponsored","polls_standard","hig_slide_poster"],plugins:[["#comments","comments",iVillage.defaults.comments],["#comments","charcounter",iVillage.defaults.charcounter]]},user_board_single_view:{blocks:["slideshow","follow_ivillage","sponsored","polls_standard","hig_slide_poster"],plugins:[["#comments","comments",iVillage.defaults.comments],["#comments","charcounter",iVillage.defaults.charcounter]]},user_board_view_all:{blocks:["follow_ivillage","sponsored","polls_standard"],plugins:[["#comments","comments",iVillage.defaults.comments],["#comments","charcounter",iVillage.defaults.charcounter]]},create_board:{blocks:["hig_create_board"]},user_profile:{blocks:["hig_slide_manager"]}},Search_Controller:{go:{blocks:["recipe_search"]}},Love_Controller:{index:{blocks:["tabbed_side","video_carousel_small"]}},Shopping_List_Controller:{index:{fire:function(){iVillage.defaults.shoppingList();}},print_list:{fire:function(){iVillage.defaults.shoppingList();}}},Iframed_Components_Controller:{beautykit:{blocks:["beauty_kit"]}}};})();(function($){if($.cookie("debugger")==true||$.getUrlVar("debugger")=="true"){var growl,path="/public/javascripts/libs/jsGrowl/";$("document").ready(function(){$.cookie("debugger",true);$("body").append('<div id="jsGrowl">HELLO WORLD</div>');$.getScript(path+"jsGrowl.js",function(){$.getScript(path+"jsGrowl_jquery.js",function(){growl=new jsGrowl("js_growl");var nid=$(".canvas").data("nid");if(nid!=null){growl.addMessage({msg:"Page NID : "+nid,sticky:true});}$("#Debugger").children("input").each(function(){growl.addMessage({msg:$(this).attr("name")+" : "+$(this).attr("value"),sticky:true});});});});});}})(jQuery);(function($){iVillage.activate_runners=function(){var i,max,template,blocks,block;var siteName=iVillage.siteName.toLowerCase();var templates=iVillage.templates;var runners=iVillage.runners;var controller=iVillage.controller;var action=iVillage.action;runners.global();if(runners.application!=undefined){runners.application();}if(templates.Global){blocks=templates.Global.blocks;for(i=0,max=blocks.length;i<max;i++){block=blocks[i];if(typeof block==="string"){if(typeof runners.blocks[block]==="function"){runners.blocks[block]();}}else{if(block[1]===siteName){if(typeof runners.blocks[block[0]]==="function"){runners.blocks[block[0]]();}}}}}if(templates[controller]){if(templates[controller][action]){template=templates[controller][action];blocks=template.blocks;plugins=template.plugins;functs=template.functs;if(blocks){for(i=0,max=blocks.length;i<max;i++){block=blocks[i];if(typeof block==="string"){if(typeof runners.blocks[block]==="function"){runners.blocks[block]();}}else{if(block[1]===siteName){if(typeof runners.blocks[block[0]]==="function"){runners.blocks[block[0]]();}}}}}if(template.fire){template.fire();}if(functs){for(i=0;i<functs.length;i++){var funct=functs[i][0],params=(typeof(functs[i][1])!="Array")?[functs[i][1]]:functs[i][1],plugin=functs[i][2],selector=functs[i][3];if(funct=="$.fn"){$.fn[plugin].apply($(selector),params);}else{window[funct].apply(null,params);}}}if(plugins){for(i=0;i<plugins.length;i++){var selector=$(plugins[i][0]),plugin=plugins[i][1],opts=(typeof(plugins[i][2])!="Array")?[plugins[i][2]]:plugins[i][2];if($.fn[plugin]){$.fn[plugin].apply($(selector),opts);}else{console.warn("Missing Plugin: "+plugin);}}}}}};iVillage.activate_click=function(){if($("body").hasClass("iframed")){return true;}if(($.cookie("iVillagePrompt")!=1)&&(window.location.href.indexOf("nlcid=")==-1)&&!$("body").hasClass("no-intercept")){var nClick=parseInt($.cookie("iVillageClick"));if(isNaN(nClick)){nClick=0;}nClick++;if(nClick>=4){if(typeof iV_SSO!="undefined"){iV_SSO.newsletters_nudge();$.cookie("iVillagePrompt",1,{path:"/",expires:(iV_SSO.isLoggedIn()?182:91)});i;}}$.cookie("iVillageClick",nClick,{path:"/"});}};})(jQuery);var swfobject=function(){var D="undefined",r="object",S="Shockwave Flash",W="ShockwaveFlash.ShockwaveFlash",q="application/x-shockwave-flash",R="SWFObjectExprInst",x="onreadystatechange",O=window,j=document,t=navigator,T=false,U=[h],o=[],N=[],I=[],l,Q,E,B,J=false,a=false,n,G,m=true,M=function(){var aa=typeof j.getElementById!=D&&typeof j.getElementsByTagName!=D&&typeof j.createElement!=D,ah=t.userAgent.toLowerCase(),Y=t.platform.toLowerCase(),ae=Y?/win/.test(Y):/win/.test(ah),ac=Y?/mac/.test(Y):/mac/.test(ah),af=/webkit/.test(ah)?parseFloat(ah.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,X=!+"\v1",ag=[0,0,0],ab=null;if(typeof t.plugins!=D&&typeof t.plugins[S]==r){ab=t.plugins[S].description;if(ab&&!(typeof t.mimeTypes!=D&&t.mimeTypes[q]&&!t.mimeTypes[q].enabledPlugin)){T=true;X=false;ab=ab.replace(/^.*\s+(\S+\s+\S+$)/,"$1");ag[0]=parseInt(ab.replace(/^(.*)\..*$/,"$1"),10);ag[1]=parseInt(ab.replace(/^.*\.(.*)\s.*$/,"$1"),10);ag[2]=/[a-zA-Z]/.test(ab)?parseInt(ab.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0;}}else{if(typeof O.ActiveXObject!=D){try{var ad=new ActiveXObject(W);if(ad){ab=ad.GetVariable("$version");if(ab){X=true;ab=ab.split(" ")[1].split(",");ag=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)];}}}catch(Z){}}}return{w3:aa,pv:ag,wk:af,ie:X,win:ae,mac:ac};}(),k=function(){if(!M.w3){return;}if((typeof j.readyState!=D&&j.readyState=="complete")||(typeof j.readyState==D&&(j.getElementsByTagName("body")[0]||j.body))){f();}if(!J){if(typeof j.addEventListener!=D){j.addEventListener("DOMContentLoaded",f,false);}if(M.ie&&M.win){j.attachEvent(x,function(){if(j.readyState=="complete"){j.detachEvent(x,arguments.callee);f();}});if(O==top){(function(){if(J){return;}try{j.documentElement.doScroll("left");}catch(X){setTimeout(arguments.callee,0);return;}f();})();}}if(M.wk){(function(){if(J){return;}if(!/loaded|complete/.test(j.readyState)){setTimeout(arguments.callee,0);return;}f();})();}s(f);}}();function f(){if(J){return;}try{var Z=j.getElementsByTagName("body")[0].appendChild(C("span"));Z.parentNode.removeChild(Z);}catch(aa){return;}J=true;var X=U.length;for(var Y=0;Y<X;Y++){U[Y]();}}function K(X){if(J){X();}else{U[U.length]=X;}}function s(Y){if(typeof O.addEventListener!=D){O.addEventListener("load",Y,false);}else{if(typeof j.addEventListener!=D){j.addEventListener("load",Y,false);}else{if(typeof O.attachEvent!=D){i(O,"onload",Y);}else{if(typeof O.onload=="function"){var X=O.onload;O.onload=function(){X();Y();};}else{O.onload=Y;}}}}}function h(){if(T){V();}else{H();}}function V(){var X=j.getElementsByTagName("body")[0];var aa=C(r);aa.setAttribute("type",q);var Z=X.appendChild(aa);if(Z){var Y=0;(function(){if(typeof Z.GetVariable!=D){var ab=Z.GetVariable("$version");if(ab){ab=ab.split(" ")[1].split(",");M.pv=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)];}}else{if(Y<10){Y++;setTimeout(arguments.callee,10);return;}}X.removeChild(aa);Z=null;H();})();}else{H();}}function H(){var ag=o.length;if(ag>0){for(var af=0;af<ag;af++){var Y=o[af].id;var ab=o[af].callbackFn;var aa={success:false,id:Y};if(M.pv[0]>0){var ae=c(Y);if(ae){if(F(o[af].swfVersion)&&!(M.wk&&M.wk<312)){w(Y,true);if(ab){aa.success=true;aa.ref=z(Y);ab(aa);}}else{if(o[af].expressInstall&&A()){var ai={};ai.data=o[af].expressInstall;ai.width=ae.getAttribute("width")||"0";ai.height=ae.getAttribute("height")||"0";if(ae.getAttribute("class")){ai.styleclass=ae.getAttribute("class");}if(ae.getAttribute("align")){ai.align=ae.getAttribute("align");}var ah={};var X=ae.getElementsByTagName("param");var ac=X.length;for(var ad=0;ad<ac;ad++){if(X[ad].getAttribute("name").toLowerCase()!="movie"){ah[X[ad].getAttribute("name")]=X[ad].getAttribute("value");}}P(ai,ah,Y,ab);}else{p(ae);if(ab){ab(aa);}}}}}else{w(Y,true);if(ab){var Z=z(Y);if(Z&&typeof Z.SetVariable!=D){aa.success=true;aa.ref=Z;}ab(aa);}}}}}function z(aa){var X=null;var Y=c(aa);if(Y&&Y.nodeName=="OBJECT"){if(typeof Y.SetVariable!=D){X=Y;}else{var Z=Y.getElementsByTagName(r)[0];if(Z){X=Z;}}}return X;}function A(){return !a&&F("6.0.65")&&(M.win||M.mac)&&!(M.wk&&M.wk<312);}function P(aa,ab,X,Z){a=true;E=Z||null;B={success:false,id:X};var ae=c(X);if(ae){if(ae.nodeName=="OBJECT"){l=g(ae);Q=null;}else{l=ae;Q=X;}aa.id=R;if(typeof aa.width==D||(!/%$/.test(aa.width)&&parseInt(aa.width,10)<310)){aa.width="310";}if(typeof aa.height==D||(!/%$/.test(aa.height)&&parseInt(aa.height,10)<137)){aa.height="137";}j.title=j.title.slice(0,47)+" - Flash Player Installation";var ad=M.ie&&M.win?"ActiveX":"PlugIn",ac="MMredirectURL="+O.location.toString().replace(/&/g,"%26")+"&MMplayerType="+ad+"&MMdoctitle="+j.title;if(typeof ab.flashvars!=D){ab.flashvars+="&"+ac;}else{ab.flashvars=ac;}if(M.ie&&M.win&&ae.readyState!=4){var Y=C("div");X+="SWFObjectNew";Y.setAttribute("id",X);ae.parentNode.insertBefore(Y,ae);ae.style.display="none";(function(){if(ae.readyState==4){ae.parentNode.removeChild(ae);}else{setTimeout(arguments.callee,10);}})();}u(aa,ab,X);}}function p(Y){if(M.ie&&M.win&&Y.readyState!=4){var X=C("div");Y.parentNode.insertBefore(X,Y);X.parentNode.replaceChild(g(Y),X);Y.style.display="none";(function(){if(Y.readyState==4){Y.parentNode.removeChild(Y);}else{setTimeout(arguments.callee,10);}})();}else{Y.parentNode.replaceChild(g(Y),Y);}}function g(ab){var aa=C("div");if(M.win&&M.ie){aa.innerHTML=ab.innerHTML;}else{var Y=ab.getElementsByTagName(r)[0];if(Y){var ad=Y.childNodes;if(ad){var X=ad.length;for(var Z=0;Z<X;Z++){if(!(ad[Z].nodeType==1&&ad[Z].nodeName=="PARAM")&&!(ad[Z].nodeType==8)){aa.appendChild(ad[Z].cloneNode(true));}}}}}return aa;}function u(ai,ag,Y){var X,aa=c(Y);if(M.wk&&M.wk<312){return X;}if(aa){if(typeof ai.id==D){ai.id=Y;}if(M.ie&&M.win){var ah="";for(var ae in ai){if(ai[ae]!=Object.prototype[ae]){if(ae.toLowerCase()=="data"){ag.movie=ai[ae];}else{if(ae.toLowerCase()=="styleclass"){ah+=' class="'+ai[ae]+'"';}else{if(ae.toLowerCase()!="classid"){ah+=" "+ae+'="'+ai[ae]+'"';}}}}}var af="";for(var ad in ag){if(ag[ad]!=Object.prototype[ad]){af+='<param name="'+ad+'" value="'+ag[ad]+'" />';}}aa.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+ah+">"+af+"</object>";N[N.length]=ai.id;X=c(ai.id);}else{var Z=C(r);Z.setAttribute("type",q);for(var ac in ai){if(ai[ac]!=Object.prototype[ac]){if(ac.toLowerCase()=="styleclass"){Z.setAttribute("class",ai[ac]);}else{if(ac.toLowerCase()!="classid"){Z.setAttribute(ac,ai[ac]);}}}}for(var ab in ag){if(ag[ab]!=Object.prototype[ab]&&ab.toLowerCase()!="movie"){e(Z,ab,ag[ab]);}}aa.parentNode.replaceChild(Z,aa);X=Z;}}return X;}function e(Z,X,Y){var aa=C("param");aa.setAttribute("name",X);aa.setAttribute("value",Y);Z.appendChild(aa);}function y(Y){var X=c(Y);if(X&&X.nodeName=="OBJECT"){if(M.ie&&M.win){X.style.display="none";(function(){if(X.readyState==4){b(Y);}else{setTimeout(arguments.callee,10);}})();}else{X.parentNode.removeChild(X);}}}function b(Z){var Y=c(Z);if(Y){for(var X in Y){if(typeof Y[X]=="function"){Y[X]=null;}}Y.parentNode.removeChild(Y);}}function c(Z){var X=null;try{X=j.getElementById(Z);}catch(Y){}return X;}function C(X){return j.createElement(X);}function i(Z,X,Y){Z.attachEvent(X,Y);I[I.length]=[Z,X,Y];}function F(Z){var Y=M.pv,X=Z.split(".");X[0]=parseInt(X[0],10);X[1]=parseInt(X[1],10)||0;X[2]=parseInt(X[2],10)||0;return(Y[0]>X[0]||(Y[0]==X[0]&&Y[1]>X[1])||(Y[0]==X[0]&&Y[1]==X[1]&&Y[2]>=X[2]))?true:false;}function v(ac,Y,ad,ab){if(M.ie&&M.mac){return;}var aa=j.getElementsByTagName("head")[0];if(!aa){return;}var X=(ad&&typeof ad=="string")?ad:"screen";if(ab){n=null;G=null;}if(!n||G!=X){var Z=C("style");Z.setAttribute("type","text/css");Z.setAttribute("media",X);n=aa.appendChild(Z);if(M.ie&&M.win&&typeof j.styleSheets!=D&&j.styleSheets.length>0){n=j.styleSheets[j.styleSheets.length-1];}G=X;}if(M.ie&&M.win){if(n&&typeof n.addRule==r){n.addRule(ac,Y);}}else{if(n&&typeof j.createTextNode!=D){n.appendChild(j.createTextNode(ac+" {"+Y+"}"));}}}function w(Z,X){if(!m){return;}var Y=X?"visible":"hidden";if(J&&c(Z)){c(Z).style.visibility=Y;}else{v("#"+Z,"visibility:"+Y);}}function L(Y){var Z=/[\\\"<>\.;]/;var X=Z.exec(Y)!=null;return X&&typeof encodeURIComponent!=D?encodeURIComponent(Y):Y;}var d=function(){if(M.ie&&M.win){window.attachEvent("onunload",function(){var ac=I.length;for(var ab=0;ab<ac;ab++){I[ab][0].detachEvent(I[ab][1],I[ab][2]);}var Z=N.length;for(var aa=0;aa<Z;aa++){y(N[aa]);}for(var Y in M){M[Y]=null;}M=null;for(var X in swfobject){swfobject[X]=null;}swfobject=null;});}}();return{registerObject:function(ab,X,aa,Z){if(M.w3&&ab&&X){var Y={};Y.id=ab;Y.swfVersion=X;Y.expressInstall=aa;Y.callbackFn=Z;o[o.length]=Y;w(ab,false);}else{if(Z){Z({success:false,id:ab});}}},getObjectById:function(X){if(M.w3){return z(X);}},embedSWF:function(ab,ah,ae,ag,Y,aa,Z,ad,af,ac){var X={success:false,id:ah};if(M.w3&&!(M.wk&&M.wk<312)&&ab&&ah&&ae&&ag&&Y){w(ah,false);K(function(){ae+="";ag+="";var aj={};if(af&&typeof af===r){for(var al in af){aj[al]=af[al];}}aj.data=ab;aj.width=ae;aj.height=ag;var am={};if(ad&&typeof ad===r){for(var ak in ad){am[ak]=ad[ak];}}if(Z&&typeof Z===r){for(var ai in Z){if(typeof am.flashvars!=D){am.flashvars+="&"+ai+"="+Z[ai];}else{am.flashvars=ai+"="+Z[ai];}}}if(F(Y)){var an=u(aj,am,ah);if(aj.id==ah){w(ah,true);}X.success=true;X.ref=an;}else{if(aa&&A()){aj.data=aa;P(aj,am,ah,ac);return;}else{w(ah,true);}}if(ac){ac(X);}});}else{if(ac){ac(X);}}},switchOffAutoHideShow:function(){m=false;},ua:M,getFlashPlayerVersion:function(){return{major:M.pv[0],minor:M.pv[1],release:M.pv[2]};},hasFlashPlayerVersion:F,createSWF:function(Z,Y,X){if(M.w3){return u(Z,Y,X);}else{return undefined;}},showExpressInstall:function(Z,aa,X,Y){if(M.w3&&A()){P(Z,aa,X,Y);}},removeSWF:function(X){if(M.w3){y(X);}},createCSS:function(aa,Z,Y,X){if(M.w3){v(aa,Z,Y,X);}},addDomLoadEvent:K,addLoadEvent:s,getQueryParamValue:function(aa){var Z=j.location.search||j.location.hash;if(Z){if(/\?/.test(Z)){Z=Z.split("?")[1];}if(aa==null){return L(Z);}var Y=Z.split("&");for(var X=0;X<Y.length;X++){if(Y[X].substring(0,Y[X].indexOf("="))==aa){return L(Y[X].substring((Y[X].indexOf("=")+1)));
}}}return"";},expressInstallCallback:function(){if(a){var X=c(R);if(X&&l){X.parentNode.replaceChild(l,X);if(Q){w(Q,true);if(M.ie&&M.win){l.style.display="block";}}if(E){E(B);}}a=false;}}};}();(function($){var colorbox="colorbox",hover="hover",TRUE=true,FALSE=false,cboxPublic,isIE=!$.support.opacity,isIE6=isIE&&!window.XMLHttpRequest,cbox_open="sso_cbox_open",cbox_load="sso_cbox_load",cbox_complete="sso_cbox_complete",cbox_cleanup="sso_cbox_cleanup",cbox_closed="sso_cbox_closed",cbox_resize="resize.sso_cbox_resize",$overlay,$cbox,$wrap,$content,$topBorder,$leftBorder,$rightBorder,$bottomBorder,$related,$window,$loaded,$loadingBay,$loadingOverlay,$loadingGraphic,$title,$current,$slideshow,$next,$prev,$close,interfaceHeight,interfaceWidth,loadedHeight,loadedWidth,element,bookmark,index,settings,open,active,defaults={transition:"elastic",speed:350,width:FALSE,height:FALSE,innerWidth:FALSE,innerHeight:FALSE,initialWidth:"400",initialHeight:"400",maxWidth:FALSE,maxHeight:FALSE,scalePhotos:TRUE,scrolling:TRUE,inline:FALSE,html:FALSE,iframe:FALSE,photo:FALSE,href:FALSE,title:FALSE,rel:FALSE,opacity:0.9,preloading:TRUE,current:"image {current} of {total}",previous:"previous",next:"next",close:"close",open:FALSE,overlayClose:TRUE,slideshow:FALSE,slideshowAuto:TRUE,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",onOpen:FALSE,onLoad:FALSE,onComplete:FALSE,onCleanup:FALSE,onClosed:FALSE};function setSize(size,dimension){dimension=dimension==="x"?$window.width():$window.height();return(typeof size==="string")?Math.round((size.match(/%/)?(dimension/100)*parseInt(size,10):parseInt(size,10))):size;}function isImage(url){url=$.isFunction(url)?url.call(element):url;return settings.photo||url.match(/\.(gif|png|jpg|jpeg|bmp)(?:\?([^#]*))?(?:#(\.*))?$/i);}function process(){for(var i in settings){if($.isFunction(settings[i])&&i.substring(0,2)!=="on"){settings[i]=settings[i].call(element);}}settings.rel=settings.rel||element.rel;settings.href=settings.href||element.href;settings.title=settings.title||element.title;}function launch(elem){element=elem;settings=$(element).data(colorbox);process();if(settings.rel&&settings.rel!=="nofollow"){$related=$(".cboxElement").filter(function(){var relRelated=$(this).data(colorbox).rel||this.rel;return(relRelated===settings.rel);});index=$related.index(element);if(index<0){$related=$related.add(element);index=$related.length-1;}}else{$related=$(element);index=0;}if(!open){open=TRUE;active=TRUE;bookmark=element;bookmark.blur();$(document).bind("keydown.cbox_close",function(e){if(e.keyCode===27){e.preventDefault();cboxPublic.close();}}).bind("keydown.cbox_arrows",function(e){if($related.length>1){if(e.keyCode===37){e.preventDefault();$prev.click();}else{if(e.keyCode===39){e.preventDefault();$next.click();}}}});if(settings.overlayClose){$overlay.css({cursor:"pointer"}).one("click",cboxPublic.close);}$.event.trigger(cbox_open);if(settings.onOpen){settings.onOpen.call(element);}$overlay.css({opacity:settings.opacity}).show();settings.w=setSize(settings.initialWidth,"x");settings.h=setSize(settings.initialHeight,"y");cboxPublic.position(0);if(isIE6){$window.bind("resize.cboxie6 scroll.cboxie6",function(){$overlay.css({width:$window.width(),height:$window.height(),top:$window.scrollTop(),left:$window.scrollLeft()});}).trigger("scroll.cboxie6");}}$current.add($prev).add($next).add($slideshow).add($title).hide();$close.html(settings.close).show();cboxPublic.slideshow();cboxPublic.load();}cboxPublic=$.fn.ssoColorbox=function(options,callback){var $this=this;if(!$this.length){if($this.selector===""){$this=$("<a/>");options.open=TRUE;}else{return this;}}$this.each(function(){var data=$.extend({},$(this).data(colorbox)?$(this).data(colorbox):defaults,options);$(this).data(colorbox,data).addClass("cboxElement");if(callback){$(this).data(colorbox).onComplete=callback;}});if(options&&options.open){launch($this);}return this;};cboxPublic.init=function(){function $div(id){return $('<div id="sso-cbox-'+id+'"/>');}$window=$(window);$cbox=$('<div id="sso-cbox"/>');$overlay=$div("overlay").hide();$wrap=$div("wrapper");$content=$div("content").append($loaded=$div("loaded-content").addClass("clearfix").css({width:0,height:0}),$loadingOverlay=$div("loading-overlay"),$loadingGraphic=$div("loading-graphic"),$title=$div("title"),$current=$div("current"),$slideshow=$div("slideshow"),$next=$div("next"),$prev=$div("previous"),$close=$div("close"));$wrap.append($('<div id="sso-cbox-top-corners"/>').append($div("top-left"),$topBorder=$div("top-center"),$div("top-right")),$("<div/>").append($leftBorder=$div("middle-left"),$content,$rightBorder=$div("middle-right")),$('<div id="sso-cbox-bottom-corners"/>').append($div("bottom-left"),$bottomBorder=$div("bottom-center"),$div("bottom-right"))).children().children().css({"float":"left"});$loadingBay=$("<div style='position:absolute; top:0; left:0; width:9999px; height:0;'/>");$("body").append($overlay,$cbox.append($wrap,$loadingBay));if(isIE){$cbox.addClass("cbox-ie");if(isIE6){$overlay.css("position","absolute");}}$content.children().bind("mouseover mouseout",function(){$(this).toggleClass(hover);}).addClass(hover);interfaceHeight=$topBorder.height()+$bottomBorder.height()+$content.outerHeight(TRUE)-$content.height();interfaceWidth=$leftBorder.width()+$rightBorder.width()+$content.outerWidth(TRUE)-$content.width();loadedHeight=$loaded.outerHeight(TRUE);loadedWidth=$loaded.outerWidth(TRUE);$cbox.css({"padding-bottom":interfaceHeight,"padding-right":interfaceWidth}).hide();$next.click(cboxPublic.next);$prev.click(cboxPublic.prev);$close.click(cboxPublic.close);$content.children().removeClass(hover);$(".sso-cbox-element").live("click",function(e){if(e.button!==0&&typeof e.button!=="undefined"){return TRUE;}else{launch(this);return FALSE;}});};cboxPublic.position=function(speed,loadedCallback){var animate_speed,winHeight=$window.height(),posTop=Math.max(winHeight-settings.h-loadedHeight-interfaceHeight,0)/2+$window.scrollTop(),posLeft=Math.max(document.documentElement.clientWidth-settings.w-loadedWidth-interfaceWidth,0)/2+$window.scrollLeft();animate_speed=($cbox.width()===settings.w+loadedWidth&&$cbox.height()===settings.h+loadedHeight)?0:speed;$wrap[0].style.width=$wrap[0].style.height="9999px";function modalDimensions(that){$topBorder[0].style.width=$bottomBorder[0].style.width=$content[0].style.width=that.style.width;$loadingGraphic[0].style.height=$loadingOverlay[0].style.height=$content[0].style.height=$leftBorder[0].style.height=$rightBorder[0].style.height=that.style.height;}$cbox.dequeue().animate({width:settings.w+loadedWidth,height:settings.h+loadedHeight,top:posTop,left:posLeft},{duration:animate_speed,complete:function(){modalDimensions(this);active=FALSE;$wrap[0].style.width=(settings.w+loadedWidth+interfaceWidth)+"px";$wrap[0].style.height=(settings.h+loadedHeight+interfaceHeight)+"px";if(loadedCallback){loadedCallback();}},step:function(){modalDimensions(this);}});};cboxPublic.resize=function(object){if(!open){return;}var topMargin,prev,prevSrc,next,nextSrc,photo,timeout,speed=settings.transition==="none"?0:settings.speed;$window.unbind(cbox_resize);if(!object){timeout=setTimeout(function(){var $child=$loaded.wrapInner("<div style='overflow:auto'></div>").children();settings.h=$child.height();$loaded.css({height:settings.h});$child.replaceWith($child.children());cboxPublic.position(speed);},1);return;}$loaded.remove();$loaded=$('<div id="sso-cbox-loaded-content"/>').html(object);function getWidth(){settings.w=settings.w||$loaded.width();settings.w=settings.mw&&settings.mw<settings.w?settings.mw:settings.w;return settings.w;}function getHeight(){settings.h=settings.h||$loaded.height();settings.h=settings.mh&&settings.mh<settings.h?settings.mh:settings.h;return settings.h;}$loaded.hide().appendTo($loadingBay).css({width:getWidth(),overflow:settings.scrolling?"auto":"hidden"}).css({height:getHeight()}).prependTo($content);$("#sso-cbox-photo").css({cssFloat:"none"});if(isIE6){$("select:not(#sso-colorbox select)").filter(function(){return this.style.visibility!=="hidden";}).css({visibility:"hidden"}).one(cbox_cleanup,function(){this.style.visibility="inherit";});}function setPosition(s){cboxPublic.position(s,function(){if(!open){return;}if(isIE){if(photo){$loaded.fadeIn(100);}$cbox[0].style.removeAttribute("filter");}if(settings.iframe){$loaded.append("<iframe id='sso-cbox-iframe'"+(settings.scrolling?" ":"scrolling='no'")+" name='iframe_"+new Date().getTime()+"' frameborder=0 src='"+settings.href+"' "+(isIE?"allowtransparency='true'":"")+" />");}$loaded.show();$title.show().html(settings.title);if($related.length>1){$current.html(settings.current.replace(/\{current\}/,index+1).replace(/\{total\}/,$related.length)).show();$next.html(settings.next).show();$prev.html(settings.previous).show();if(settings.slideshow){$slideshow.show();}}$loadingOverlay.hide();$loadingGraphic.hide();$.event.trigger(cbox_complete);if(settings.onComplete){settings.onComplete.call(element);}if(settings.transition==="fade"){$cbox.fadeTo(speed,1,function(){if(isIE){$cbox[0].style.removeAttribute("filter");}});}$window.bind(cbox_resize,function(){cboxPublic.position(0);});});}if((settings.transition==="fade"&&$cbox.fadeTo(speed,0,function(){setPosition(0);}))||setPosition(speed)){}if(settings.preloading&&$related.length>1){prev=index>0?$related[index-1]:$related[$related.length-1];next=index<$related.length-1?$related[index+1]:$related[0];nextSrc=$(next).data(colorbox).href||next.href;prevSrc=$(prev).data(colorbox).href||prev.href;if(isImage(nextSrc)){$("<img />").attr("src",nextSrc);}if(isImage(prevSrc)){$("<img />").attr("src",prevSrc);}}$("#sso-cbox-content").css("paddingBottom","0");};cboxPublic.load=function(){var href,img,setResize,resize=cboxPublic.resize;active=TRUE;element=$related[index];settings=$(element).data(colorbox);process();$.event.trigger(cbox_load);if(settings.onLoad){settings.onLoad.call(element);}settings.h=settings.height?setSize(settings.height,"y")-loadedHeight-interfaceHeight:settings.innerHeight?setSize(settings.innerHeight,"y"):FALSE;settings.w=settings.width?setSize(settings.width,"x")-loadedWidth-interfaceWidth:settings.innerWidth?setSize(settings.innerWidth,"x"):FALSE;
settings.mw=settings.w;settings.mh=settings.h;if(settings.maxWidth){settings.mw=setSize(settings.maxWidth,"x")-loadedWidth-interfaceWidth;settings.mw=settings.w&&settings.w<settings.mw?settings.w:settings.mw;}if(settings.maxHeight){settings.mh=setSize(settings.maxHeight,"y")-loadedHeight-interfaceHeight;settings.mh=settings.h&&settings.h<settings.mh?settings.h:settings.mh;}href=settings.href;$loadingOverlay.show();$loadingGraphic.show();if(settings.inline){$('<div id="sso-cbox-inline-temp" />').hide().insertBefore($(href)[0]).bind(cbox_load+" "+cbox_cleanup,function(){$(this).replaceWith($loaded.children());});resize($(href));}else{if(settings.iframe){resize(" ");}else{if(settings.html){resize(settings.html);}else{if(isImage(href)){img=new Image();img.onload=function(){var percent;img.onload=null;img.id="sso-cbox-photo";$(img).css({margin:"auto",border:"none",display:"block",cssFloat:"left"});if(settings.scalePhotos){setResize=function(){img.height-=img.height*percent;img.width-=img.width*percent;};if(settings.mw&&img.width>settings.mw){percent=(img.width-settings.mw)/img.width;setResize();}if(settings.mh&&img.height>settings.mh){percent=(img.height-settings.mh)/img.height;setResize();}}if(settings.h){img.style.marginTop=Math.max(settings.h-img.height,0)/2+"px";}resize(img);if($related.length>1){$(img).css({cursor:"pointer"}).click(cboxPublic.next);}if(isIE){img.style.msInterpolationMode="bicubic";}};img.src=href;}else{$("<div />").appendTo($loadingBay).load(href,function(data,textStatus){if(textStatus==="success"){resize(this);}else{resize($("<p>Request unsuccessful.</p>"));}});}}}}};cboxPublic.next=function(){if(!active){index=index<$related.length-1?index+1:0;cboxPublic.load();}};cboxPublic.prev=function(){if(!active){index=index>0?index-1:$related.length-1;cboxPublic.load();}};cboxPublic.slideshow=function(){var stop,timeOut,className="sso-cbox-slideshow-";$slideshow.bind(cbox_closed,function(){$slideshow.unbind();clearTimeout(timeOut);$cbox.removeClass(className+"off "+className+"on");});function start(){$slideshow.text(settings.slideshowStop).bind(cbox_complete,function(){timeOut=setTimeout(cboxPublic.next,settings.slideshowSpeed);}).bind(cbox_load,function(){clearTimeout(timeOut);}).one("click",function(){stop();$(this).removeClass(hover);});$cbox.removeClass(className+"off").addClass(className+"on");}stop=function(){clearTimeout(timeOut);$slideshow.text(settings.slideshowStart).unbind(cbox_complete+" "+cbox_load).one("click",function(){start();timeOut=setTimeout(cboxPublic.next,settings.slideshowSpeed);$(this).removeClass(hover);});$cbox.removeClass(className+"on").addClass(className+"off");};if(settings.slideshow&&$related.length>1){if(settings.slideshowAuto){start();}else{stop();}}};cboxPublic.close=function(){$.event.trigger(cbox_cleanup);if(settings.onCleanup){settings.onCleanup.call(element);}open=FALSE;$(document).unbind("keydown.cbox_close keydown.cbox_arrows");$window.unbind(cbox_resize+" resize.cboxie6 scroll.cboxie6");$overlay.css({cursor:"auto"}).fadeOut("fast");$cbox.stop(TRUE,FALSE).fadeOut("fast",function(){$("#colorbox iframe").attr("src","about:blank");$loaded.remove();$cbox.css({opacity:1});try{bookmark.focus();}catch(er){}$.event.trigger(cbox_closed);if(settings.onClosed){settings.onClosed.call(element);}});};cboxPublic.element=function(){return $(element);};cboxPublic.settings=defaults;$(cboxPublic.init);}(jQuery));iVillage=window.iVillage||{omniEvent:function(){},siteName:"",gigya_api_key:"2_TAACrzG-_a9IkzLfWB3YsVoaBvKoZSfmy-eAfFSA0_XZPEk1Lpd5dWthUDHdRtu-"};var iV_SSO=(function(window,$){var ssoReady,htmlBase,uploadSwf,postPaths,getPaths,origEventTarget,origEventType,avatarOverlay,cropApi,chimeType,regNlid,userSocialData;var options={baseUrl:"/",proxyUrl:false,vertical:1,gigyaAPIURL:"http://cdn.gigya.com/JS/socialize.js",gigyaConfig:{enabledProviders:"facebook,twitter,yahoo,messenger,google,aol",newUsersPendingRegistration:false},basicLoginParams:{buttonsStyle:"standard",hideGigyaLink:true,includeiRank:true,width:240,height:165,showTermsLink:false,showTooltips:true,headerText:"<ul><li class='sc social-sign-in'>Save time by using your existing account to sign in to iVillage.</li><li class='sc social-privacy'>We'll never share your information or post anything to your account without your permission.</li></ul>",sessionExpiration:0,pendingRegistration:false,lastLoginIndication:"welcome",lastLoginButtonSize:30,UIConfig:'<config><body><controls><snbuttons buttonsize="35"></snbuttons></controls></body></config>',cid:"iVillage",context:"iVillage",onLoad:function(eventObj){log("Gigya: Signin Plugin Loaded.");}},loginUIParams:{containerID:"loginOptionsBox",includeiRank:true,onError:function(eventObj){log("Gigya: Unable to load Plugin.",eventObj);showGigyaError(eventObj,options.loginUIParams.containerID);}},registrationUIParams:{containerID:"registrationOptionsBox",includeiRank:true,onError:function(eventObj){log("Gigya: Unable to load Plugin.");showGigyaError(eventObj,options.registrationUIParams.containerID);}},forgotPwdLoginUIParams:{containerID:"forgotOptionsBox",includeiRank:true,onError:function(eventObj){log("Gigya: Unable to load Plugin.");showGigyaError(eventObj,options.forgotPwdLoginUIParams.containerID);}},chimeLoginUIParams:{containerID:"chimeLoginBox",UIConfig:'<config><body><controls><snbuttons buttonsize="25"></snbuttons></controls></body></config>',lastLoginButtonSize:25,height:92,width:200,includeiRank:true,onError:function(eventObj){log("Gigya: Unable to load Plugin.");showGigyaError(eventObj,options.chimeLoginUIParams.containerID);}},globalLayoutLoginUIParams:{containerID:"globalLayoutLoginBox",headerText:"",lastLoginIndication:"border",context:"iVillageHeader",width:100,height:26,includeiRank:true,UIConfig:'<config><body><controls><snbuttons buttonsize="20"></snbuttons></controls></body></config>'},channelLayoutLoginUIParams:{containerID:"channelLayoutLoginBox",headerText:"",lastLoginIndication:"border",context:"iVillageHeader",width:100,height:26,includeiRank:true,UIConfig:'<config><body><controls><snbuttons buttonsize="20"></snbuttons></controls></body></config>'},addConnectionsUIParams:{containerID:"addConnectionsBox",width:280,height:200,hideGigyaLink:true,showEditLink:true,showTermsLink:false,includeiRank:true,UIConfig:'<config><body><controls><snbuttons buttonsize="20"></snbuttons></controls></body></config>',sessionExpiration:0,cid:"iVillage"},addConnectionsUISmallParams:{containerID:"addConnectionsBoxSmall",width:130,height:26,hideGigyaLink:true,showTermsLink:false,includeiRank:true,UIConfig:'<config><body><controls><snbuttons buttonsize="20"></snbuttons></controls></body></config>',sessionExpiration:0,cid:"iVillage"},addConnectionsUILoaded:false,loginUILoadindAttempts:0,loginUILoaded:false,addConnectionsUILoadindAttempts:0,registrationBoxExpanded:false,onLoginParams:{onLogin:function(eventObj){steps.gigyaLogin(eventObj);}},onConnectionEditParams:{onConnectionAdded:function(eventObj){editedConnection(eventObj);},onConnectionRemoved:function(eventObj){editedConnection(eventObj);}},loginParamsPassed:false,submitUGCForm:false,slide_information:{},gigya_share_ugc_config:{operationMode:"multiSelect",containerID:"ugc-gigya-share-plugin",context:"UGCShare",cid:"iVillage",shortURLs:"always",showTooltips:true,showMoreButton:false,showEmailButton:true}};var inited=false;var isAuthenticated=false;var userId=0;var avatarId=0;var username="";var sessionToken="";var flowType="none";var lastFlow="none";var flowSuccess=false;var uploadPhotoId=0;var saveURL="";var saveId="";var errorArrow='<span class="error-arrow"></span>';var proxyOrBase="";var completeUploads=0;$.validator.addMethod("not_default",function(value,element){return this.optional(element)||value!=="default";},errorArrow+"Please select an option.");$.validator.addMethod("us_check",function(value,element){if(parseInt($("#sso_country_id").val(),10)===1){$("#sso_zip_code").rules("add",{required:true,minlength:5,maxlength:5,messages:{required:errorArrow+"Please enter a valid 5 digit US zip code.",minlength:errorArrow+"Please enter a valid 5 digit US zip code.",maxlength:errorArrow+"Please enter a valid 5 digit US zip code."}});}else{$("#sso_zip_code").rules("remove");}return true;},errorArrow+"Enter a zip.");$.validator.addMethod("start_date_check",function(value,element){element=$(element);var selects;if(element.hasClass("start-date-required")){selects=element.parent().find("select");if(element.is(":checked")){selects.each(function(){var type=this.id.split("_")[0];$(this).rules("add",{not_default:true,messages:{not_default:errorArrow+"Please select a "+type+"."}});});}else{selects.each(function(){$(this).rules("remove");});}}return true;},errorArrow+"Enter a start date.");$.validator.addMethod("at_least_one",function(value,element){return $.find(":checkbox:checked").length>0;},errorArrow+'Please select the newsletters you\'d like to receive before clicking "Subscribe"');$.validator.addMethod("community_leader_check",function(value,element){var firstThree=value.substring(0,3);return firstThree!=="cl-"&&firstThree!=="cl_";},errorArrow+'Your username cannot begin with "cl-" or "cl_"');$.validator.addMethod("additional_field_validation",function(value,element){return $(element).parent().css("display")=="none"||value!="";},errorArrow+"This field is required.");$.validator.addMethod("additional_field_length",function(value,element){return $(element).parent().css("display")=="none"||value.length<51;},errorArrow+"Should not be more than 50 characters.");$.validator.addMethod("selected_ugc_category",function(value,element){if($("#sso-upload #ugc_categorization_group").find("input[type=radio]:checked").length==0){if($("#sso-upload #ugc_categorization_group span.error").length>0){$("#sso-upload #ugc_categorization_group span.error").remove();}$("#sso-upload #ugc_categorization_group").append("<span class='error' style='line-height: 120%'>Please select one category.</span>");return false;}else{return true;}},"");var validation={login:{rules:{sso_email_username:{required:true},sso_password:{required:true}},messages:{sso_email_username:{required:errorArrow+"Please enter your email or username."},sso_password:{required:errorArrow+"Please provide a password."}},invalidHandler:function(){setTimeout(omnitureSignInErrors,100);}},register:{rules:{sso_email:{required:true,email:true},sso_username:{required:true,community_leader_check:true},sso_password:{required:true,minlength:4},sso_confirm_password:{required:true,equalTo:"#sso_password"},sso_dob_month:{not_default:true},sso_dob_day:{not_default:true},sso_dob_year:{not_default:true},sso_country_id:{not_default:true,us_check:true},sso_zip_code:{required:true},sso_terms:{required:true}},messages:{sso_username:{required:errorArrow+"Please enter a username."},sso_password:{required:errorArrow+"Please provide a password.",minlength:errorArrow+"Please choose at least 4 characters."},sso_confirm_password:{required:errorArrow+"Please provide a password.",equalTo:errorArrow+"Please enter the same password as above."},sso_dob_month:{not_default:errorArrow+"Please select your birth month."},sso_dob_day:{not_default:errorArrow+"Please select your birth day."},sso_dob_year:{not_default:errorArrow+"Please select your birth year."},sso_country_id:{not_default:errorArrow+"Please select your country."},sso_zip_code:{required:errorArrow+"Please enter a valid 5 digit US zip code."},sso_email:errorArrow+"Please enter a valid email address.",sso_terms:errorArrow+"Required."},invalidHandler:function(){setTimeout(omnitureRegistrationErrors,100);}},gigya_register:{rules:{sso_email:{required:true,email:true},sso_username:{required:true,community_leader_check:true},sso_password:{required:true,minlength:4},sso_confirm_password:{required:true,equalTo:"#sso_password2"},sso_dob_month:{not_default:true},sso_dob_day:{not_default:true},sso_dob_year:{not_default:true},sso_country_id:{not_default:true,us_check:true},sso_zip_code:{required:true},sso_terms:{required:true}},messages:{sso_username:{required:errorArrow+"Please enter a username."},sso_password:{required:errorArrow+"Please provide a password.",minlength:errorArrow+"Please choose at least 4 characters."},sso_confirm_password:{required:errorArrow+"Please provide a password.",equalTo:errorArrow+"Please enter the same password as above."},sso_dob_month:{not_default:errorArrow+"Please select your birth month."},sso_dob_day:{not_default:errorArrow+"Please select your birth day."},sso_dob_year:{not_default:errorArrow+"Please select your birth year."},sso_country_id:{not_default:errorArrow+"Please select your country."},sso_zip_code:{required:errorArrow+"Please enter a valid 5 digit US zip code."},sso_email:errorArrow+"Please enter a valid email address.",sso_terms:errorArrow+"Required."},invalidHandler:function(){setTimeout(omnitureGigyaRegistrationErrors,100);}},fb_link_existing:{rules:{sso_email:{required:true,email:true},sso_username:{required:true,community_leader_check:true},sso_password:{required:true,minlength:4},sso_confirm_password:{required:true,equalTo:"#sso_password3"},sso_dob_month:{not_default:true},sso_dob_day:{not_default:true},sso_dob_year:{not_default:true},sso_country_id:{not_default:true,us_check:true},sso_zip_code:{required:true},sso_terms:{required:true}},messages:{sso_username:{required:errorArrow+"Please enter a username."},sso_password:{required:errorArrow+"Please provide a password.",minlength:errorArrow+"Please choose at least 4 characters."},sso_confirm_password:{required:errorArrow+"Please provide a password.",equalTo:errorArrow+"Please enter the same password as above."},sso_dob_month:{not_default:errorArrow+"Please select your birth month."},sso_dob_day:{not_default:errorArrow+"Please select your birth day."},sso_dob_year:{not_default:errorArrow+"Please select your birth year."},sso_country_id:{not_default:errorArrow+"Please select your country."},sso_zip_code:{required:errorArrow+"Please enter a valid 5 digit US zip code."},sso_email:errorArrow+"Please enter a valid email address.",sso_terms:errorArrow+"Required."},invalidHandler:function(){setTimeout(omnitureGigyaRegistrationErrors,100);
}},chime:{rules:{sso_guest_name:{required:"#sso_guest_email:filled"},sso_guest_email:{email:true,required:"#sso_guest_name:filled"},sso_member_email:{email:true},sso_member_password:{required:"#sso_email_username:filled"}},messages:{sso_guest_name:{required:errorArrow+"Please enter your name."},sso_guest_email:{email:errorArrow+"Please enter a valid email address.",required:errorArrow+"Please enter an email address."},sso_member_email:{email:errorArrow+"Please enter a valid email address."},sso_member_password:{required:errorArrow+"Please enter your password."}}},social_email:{rules:{sso_social_email:{required:true,email:true}},messages:{sso_social_email:{required:errorArrow+"Please enter your email address.",email:errorArrow+"Please enter a valid email address."}}},ugc_upload:{rules:{title:{required:true,maxlength:50},description:{required:true,maxlength:140},additional_optin:{required:true},sso_additional_field_1:{additional_field_validation:true,additional_field_length:true},sso_additional_field_2:{additional_field_validation:true,additional_field_length:true},ugc_categories:{selected_ugc_category:true}},messages:{title:{required:errorArrow+"Please provide a title for this image.",maxlength:errorArrow+"Title should not be more than 50 characters."},description:{required:errorArrow+"Please describe this image in brief.",maxlength:errorArrow+"Descripiton should not be more than 140 characters."},additional_optin:{required:errorArrow+"Please accept the terms and conditions."}}}};var steps={addSave:function(e){log("steps.addSave()");requestHTML("addSave",function(){$("#sso-cbox-close").show();$("#sso-add-save .buttons a").click(handleAddSave);});},deleteSave:function(e){log("steps.deleteSave()");requestHTML("deleteSave",function(){$("#sso-cbox-close").show();$("#sso-delete-save #delete-save").click(handleDeleteSave);$("#sso-delete-save a.btn-nope").click(function(e){e.preventDefault();closeAfter(0);});});},editSave:function(e){log("steps.editSave()");requestHTML("editSave",function(){$("#sso-cbox-close").show();$("#sso-add-save a#edit-save").click(handleEditSave);});},insertSave:function(e){log("steps.insertSave()");requestHTML("insertSave",function(){$("#sso-cbox-close").show();$("#save-insert-list li").click(embedSaveToTextarea);});},login:function(){log("steps.login()");if(!isAuthenticated){requestHTML("login",function(){if(typeof(gigya)!="undefined"){options.gigyaConfig=$.extend(options.gigyaConfig,{APIKey:iVillage.gigya_api_key});if(!options.loginParamsPassed){gigya.services.socialize.addEventHandlers(options.gigyaConfig,options.onLoginParams);options.loginParamsPassed=true;}gigya.services.socialize.showLoginUI(options.gigyaConfig,$.extend({},options.basicLoginParams,options.loginUIParams));}else{var list=$("#sso-cbox-loaded-content div.social-connect > ul.error-list");displayErrors(list,{message:"Connecting via social networks is not available at the moment. Please use normal login option."});}$("#sso-cbox-close").show();$("#sso-sign-in").validate(validation.login);customOmniEvent(null,25,"Start sign-in process.");});}},gigyaLogin:function(eventObj){log("steps.gigyaLogin() > Start Authentication",eventObj);var omniVerticalMsg="gigyasignin_"+iVillage.siteName;omniVerticalMsg=omniVerticalMsg.toLowerCase();iVillage.omniEvent(null,null,"Start sign-in/registration process VIA Gigya.",omniVerticalMsg);$.ajax({type:"POST",url:postPaths.gigyaLogin,cache:false,data:{vertical:options.vertical,data:eventObj},dataType:"json",error:function(data){log("steps.gigyaLogin() error!",data);var list=$("#sso-cbox-loaded-content div.social-connect > ul");displayErrors(list,{message:"We're sorry, but we were unable to connect you with "+eventObj.provider+" at this time. Please try again later."});omnitureSignInErrors(true);},success:function(data){log("steps.gigyaLogin() > Success received from server!");userSocialData=eventObj;if(data.success){if(data.new_registration){if(typeof(data.new_email_id)!="undefined"&&data.new_email_id!=""){steps.registerNewUser(eventObj);}else{steps.askForEmail(eventObj,data);}}else{if(typeof(data.matched_id)!="undefined"&&data.matched_id){flowSuccess=true;if(eventObj.context=="iVillageHeader"){location.reload();}else{closeAfter(0);if(flowType==="chime"){triggerChimeEvent({type:"member"});}}}else{if(typeof(data.is_fb_user)!="undefined"&&data.is_fb_user){steps.linkExistingFBUser(eventObj,data);}else{steps.askForPassword(eventObj,data);}}}}else{log("steps.gigyaLogin() error!",data);var list=$("#sso-cbox-loaded-content div.social-connect > ul");displayErrors(list,{message:"We're sorry, but we were unable to connect you with "+eventObj.provider+" at this time. Please try again later."});omnitureSignInErrors(true);}}});},registerNewUser:function(eventObj,user_email){log("steps.registerNewUser()");requestHTML("gigyaRegister",function(){var custom_message="You're almost done. Fill in the fields below to complete your registration.";var fill_gigya_register_form=fillUserInfoHeader(eventObj,"link-or-register-forms",custom_message);fill_gigya_register_form=fillGigyaRegisterForm(eventObj,user_email);$("#sso-cbox-close").show();$("#sso-gigya-register").validate(validation.gigya_register);customOmniEvent(null,54,"Reg Missing Request");setTimeout(function(){$.fn.ssoColorbox.resize();},100);});},askForEmail:function(eventObj,data){log("steps.askForEmail()");if(flowType=="chime"){lastFlow="chime";}flowType="emailLookup";requestHTML("askForEmail",function(){var custom_message="Please provide your email address to complete your registration.";var fill_email_lookup_form=fillUserInfoHeader(eventObj,"ask-social-email",custom_message);$("#sso-social-get-email").find('input[name="email_lookup"]').val(1);$("#sso-cbox-close").show();$("#sso-social-get-email").validate(validation.social_email);customOmniEvent(null,52,"Reg Email Request");$.fn.ssoColorbox.resize();});},askForPassword:function(eventObj,data){log("steps.askForPassword()");if(flowType=="chime"){lastFlow="chime";}flowType="linkingAccounts";requestHTML("askForPassword",function(){var custom_message="We found an existing iVillage account for <strong>"+data.user.primary_email+"</strong>. Please enter your password to link your accounts and finish logging in.";var fill_password_form=fillUserInfoHeader(eventObj,"link-or-register-forms",custom_message);fill_password_form=fillAccountLinkForm(eventObj);$("#sso-ask-for-password").find('input[name="sso_email_username"]').val(data.user.primary_email).parents("li").hide();$("#sso-cbox-close").show();$("#sso-ask-for-password").validate(validation.login);customOmniEvent(null,53,"Reg Password Request");$.fn.ssoColorbox.resize();});},finalizeLinking:function(data){log("steps.finalizeLinking() > Accounts linked. Completing login process.");flowSuccess=true;closeAfter(0);if(flowType==="chime"||lastFlow=="chime"){triggerChimeEvent({type:"member"});}},linkExistingFBUser:function(eventObj,data){log("steps.linkExistingFBUser() > User was in iVillage via FB connect");if(flowType=="chime"){lastFlow="chime";}flowType="linkingAccounts";requestHTML("linkExistingFBUser",function(){var custom_message="You're almost done. Fill in the fields below to complete your registration.";var fill_password_form=fillUserInfoHeader(eventObj,"link-or-register-forms",custom_message);fill_password_form=fillFBAccountLinkForm(eventObj);if(!data.ask_for_email){$("#sso-link-existing-fb-user").find('input[name="sso_email"]').val(data.user.primary_email).parents("li").hide();}else{if(typeof(data.new_email_id)!="indefined"&&data.new_email_id!=""){$("#sso-link-existing-fb-user").find('input[name="sso_email"]').val(data.new_email_id).parents("li").hide();}}$("#sso-link-existing-fb-user").find('input[name="id"]').val(data.user.id);$("#sso-cbox-close").show();$("#sso-link-existing-fb-user").validate(validation.fb_link_existing);customOmniEvent(null,54,"Reg Missing Request");$.fn.ssoColorbox.resize();});},socialGetEmail:function(){requestHTML("socialGetEmail",function(){$("#sso-cbox-close").hide();$("#sso-social-get-email").validate(validation.social_email);});},forgotPassword:function(){log("steps.forgotPassword()");if(!isAuthenticated){requestHTML("forgotPassword",function(){if(typeof(gigya)!="undefined"){options.gigyaConfig=$.extend(options.gigyaConfig,{APIKey:iVillage.gigya_api_key});if(!options.loginParamsPassed){gigya.services.socialize.addEventHandlers(options.gigyaConfig,options.onLoginParams);options.loginParamsPassed=true;}gigya.services.socialize.showLoginUI(options.gigyaConfig,$.extend({},options.basicLoginParams,options.forgotPwdLoginUIParams));}else{var list=$("#sso-cbox-loaded-content div.social-connect > ul.error-list");displayErrors(list,{message:"Connecting via social networks is not available at the moment. Please use normal login option."});}$("#sso-cbox-close").show();});}},logout:function(){log("steps.logout()");function logoutPost(){$.ajax({type:"POST",url:postPaths.logout,cache:false,error:ajaxError,success:function(data,status,XHR){log("steps.logout() > Returned from server.",data);isAuthenticated=false;userId=0;flowSuccess=true;fireOriginalEventOrReload();}});}log("steps.logout() Authenticated, logging out...");if(typeof(gigya)!="undefined"){log("steps.logout() Logging out with Gigya...");options.gigyaConfig=$.extend(options.gigyaConfig,{APIKey:iVillage.gigya_api_key});var logoutParams={callback:function(responseObj){logoutPost();},forceProvidersLogout:true};gigya.services.socialize.logout(options.gigyaConfig,logoutParams);$(".add_connection_edit_btn").fadeOut("slow");}else{log("steps.logout() Logging out without Gigya...");logoutPost();}},register:function(){log("steps.register()");if(!isAuthenticated){requestHTML("register",function(){if(typeof(gigya)!="undefined"){if(!options.loginParamsPassed){gigya.services.socialize.addEventHandlers(options.gigyaConfig,options.onLoginParams);options.loginParamsPassed=true;}options.gigyaConfig=$.extend(options.gigyaConfig,{APIKey:iVillage.gigya_api_key});gigya.services.socialize.showLoginUI(options.gigyaConfig,$.extend({},options.basicLoginParams,options.registrationUIParams));
}else{var list=$("#sso-cbox-loaded-content div.social-connect > ul.error-list");displayErrors(list,{message:"Connecting via social networks is not available at the moment. Please use normal login option."});}$('[name="sso_confirm_password"]').live("focusin",function(e){if(!options.registrationBoxExpanded){e.preventDefault();var need_resize=displayHiddenFields("#sso-register","li");setTimeout(function(){$.fn.ssoColorbox.resize();},500);$(this).focus();options.registrationBoxExpanded=true;}});$("#sso-cbox-close").show();$("#sso-register").validate(validation.register);$("#sso-register").find('input[type="text"], input[type="password"]').keypress(function(e){var code=e.keyCode||e.which;if(code===13){$("#sso-register").submit();}});filterLoginMessage(false);customOmniEvent(null,20,"Start registration flow");});}},chime:function(){log("steps.chime()");if(!isAuthenticated){requestHTML("chime",function(){if(typeof(gigya)!="undefined"){options.gigyaConfig=$.extend(options.gigyaConfig,{APIKey:iVillage.gigya_api_key});if(!options.loginParamsPassed){gigya.services.socialize.addEventHandlers(options.gigyaConfig,options.onLoginParams);options.loginParamsPassed=true;}gigya.services.socialize.showLoginUI(options.gigyaConfig,$.extend({},options.basicLoginParams,options.chimeLoginUIParams));}else{var list=$("#sso-cbox-loaded-content div.social-connect > ul.error-list");displayErrors(list,{message:"Connecting via social networks is not available at the moment. Please use normal login option."});}$("#sso-cbox-close").show();$("#sso-chime-in").validate(validation.chime);});}},avatarOrUpload:function(that){log("steps.avatarOrUpload()");if(isAuthenticated){requestHTML("avatarOrUpload",function(){$("#sso-cbox-close").show();});}else{steps.login();}},allAvatars:function(that){log("steps.allAvatars()");if(isAuthenticated){requestHTML("allAvatars",function(){$("#sso-cbox-close").show();});}else{steps.login();}},uploadPhoto:function(that,isAvatar){isAvatar=isAvatar||false;var getPath=isAvatar?"uploadAvatar":"uploadPhoto";var postPath=postPaths.createPhoto;log("steps.uploadAvatar()",[that,isAvatar]);if(isAuthenticated){requestHTML(getPath,function(){$("#sso-cbox-close").show();var cancel=$("#sso-submit-photo a.btn-cancel.sso-close");$("#sso-upload input[type='file']").uploadify({uploader:uploadSwf,width:65,height:25,script:postPath,fileDataName:"photo",sizeLimit:2500000,scriptData:{token:sessionToken},cancelImg:options.baseUrl+"public/sso/images/cancel.png",buttonImg:options.baseUrl+"public/sso/images/btn-browse-for-flash.png",auto:true,fileExt:"*.gif;*.jpg;*.jpeg;*.png",fileDesc:"Choose a picture to upload.",onSelect:function(event,queueID,fileObj){cancel.addClass("btn-hide");$("#sso-cbox-close").hide();},onError:function(a,b,c,d){cancel.removeClass("btn-hide");$("#sso-cbox-close").show();},onComplete:function(event,queueID,fileObj,response){log("uploadify > onComplete()");establishSession(function(){response=$.parseJSON(response);uploadPhotoId=response.photo_id;$("#sso_photo_id").val(uploadPhotoId);finalizePhotoUpload(response.url,event,queueID,fileObj,response);});},onAllComplete:function(){log("uploadify > onAllComplete()");completeUploads=0;}});});}else{steps.login();}},uploadAvatar:function(that){log("steps.uploadAvatar()");this.uploadPhoto(that,true);},thanks:function(){log("steps.thanks()");if(isAuthenticated){avatarOverlayCleanup();}requestHTML("thanks",function(){$("#sso-cbox-close").show();});},newslettersByVertical:function(){log("steps.newslettersByVertical()");if(isAuthenticated||(typeof(newsletterOverride)!="undefined")){requestHTML("newsletterList",function(){$("#sso-cbox-close").show();if(flowType==="register"){var eventArray;if($.isArray(regNlid)&&regNlid.length>0){eventArray=[22,23,24];iVillage.omniEvent(31,eventArray,"Registration completed, newsletter signups, begin newsletter registration.",null,regNlid);}else{eventArray=[22,23];iVillage.omniEvent(null,eventArray,"Registration completed, begin newsletter registration.");}}else{iVillage.omniEvent(null,23,"Newsletter Intercept");}var form=$("#sso-newsletters");var validationSettings={rules:{email:{at_least_one:true,email:true}},messages:{email:{at_least_one:errorArrow+'Please select the newsletters you\'d like to receive before clicking "Subscribe"',email:errorArrow+"Please enter a valid email address."}}};if(form.length){form.find("input.start-date-required").each(function(){validationSettings.rules[this.id]={start_date_check:true};}).live("click",function(){$(this).closest("form").valid();});form.find("input.user-email").bind("focus",function(){if($(this).val()==$(this)[0].title){$(this).removeClass("default_text");$(this).val("");}});form.find("input.user-email").bind("blur",function(){if($(this).val()==""){$(this).addClass("default_text");$(this).val($(this)[0].title);}});if(form.find("input.user-email").length<=0){form.find("input[type=checkbox]").first().each(function(){validationSettings.rules[this.id]={at_least_one:true};});}form.validate(validationSettings);}});}else{steps.login();}},insertOrUploadPhoto:function(e){log("steps.insertOrUploadPhoto()");if(isAuthenticated){requestHTML("insertOrUploadPhoto",function(){$("#sso-cbox-close").show();});}else{steps.login();}},pickPhoto:function(){log("steps.pickPhoto()");if(isAuthenticated){requestHTML("pickPhoto",function(){$("#sso-cbox-close").show();});}else{steps.login();}},ugc_upload:function(){log("steps.ugc_upload()");if(typeof(ugc_data)!="undefined"&&typeof(ugc_data.permission)!="undefined"&&!ugc_data.permission){$.fn.ssoColorbox({title:"Welcome to iVillage!",html:"<div id='sso-cbox-intro' style='width: 400px; height: 100px;'><span class='error'>"+ugc_data.reason+"</span></div>",scrolling:false,onComplete:function(){closeAfter(7000);},overlayClose:false});return;}var postPath=postPaths.createUGCPhoto;var size_limit=2500000;var file_extension="*.gif;*.jpg;*.jpeg;*.png";var file_desc="Choose a picture to upload.";if(typeof(ugc_data)!="undefined"){size_limit=ugc_data.size_limit;file_extension=ugc_data.file_extension;file_desc=ugc_data.file_desc;}if(isAuthenticated){$("#ugc-preview-area a.sso-ugc-edit").unbind("click").live("click",function(e){e.preventDefault();options.submitUGCForm=false;steps.toggel_ugc_upload_form("upload");});requestHTML("uploadUGC",function(){updateUGCLayover("sso-upload-ugc");$.fn.ssoColorbox.resize();$("#sso-cbox-close").show();$("#sso-upload").validate(validation.ugc_upload);$("#sso-upload #ugc_categorization_group").find("input[type=radio]").change(function(){if($("#sso-upload #ugc_categorization_group span.error").length>0){$("#sso-upload #ugc_categorization_group span.error").remove();}});bind_uploadify_for_ugc_photo("sso-upload",postPath,size_limit,file_extension,file_desc);});}else{steps.login();}},toggel_ugc_upload_form:function(switch_option,form){log("steps.toggel_ugc_upload_form()",switch_option);if(typeof(switch_option)=="undefined"){return;}if(switch_option=="preview"){options.submitUGCForm=true;formData=form.serializeArray();log("formData:ugc_upload()",formData);hideUGCUploadError();if(typeof(ugc_data)!="undefined"){if(typeof(ugc_data.username)!="undefined"){var captionHeading=(ugc_data.ugc_caption_heading&&ugc_data.ugc_caption_heading!=undefined)?(ugc_data.ugc_caption_heading):"";}var ugcCaptionPresent=($(".ugc_caption").length>0)?true:false;if(!ugcCaptionPresent){var captionHeading=(ugc_data.ugc_caption_heading&&ugc_data.ugc_caption_heading!=undefined)?(ugc_data.ugc_caption_heading):"";$("#ugc-preview-area .ugc-preview-username").html("Uploaded by "+ugc_data.username+"<br/><br/><div class='ugc_caption'>"+captionHeading+"</div>");$("#ugc-preview-area .ugc-preview-username").html("Uploaded by "+ugc_data.username+"<br/>");}else{$("#ugc-preview-area .ugc-preview-username").html("Uploaded by "+ugc_data.username+"<br/>");}if(typeof(ugc_data.header_copy_preview_page)!="undefined"){$("#ugc-preview-header").html(ugc_data.header_copy_preview_page);}}for(var ii=0;ii<formData.length;ii++){switch(formData[ii].name){case"ugc_id":$("#ugc-preview-area .ugc-preview-image").html("<img alt='If you are seeing this message for more than 1 minute then please close this and try again.' src='/photo/get-for-ugc?photo_id="+formData[ii].value+"' />");options.slide_information.ugc_id=formData[ii].value;break;case"title":$("#ugc-preview-area .ugc-preview-photo-title").html(formData[ii].value);options.slide_information.title=formData[ii].value;break;case"description":$("#ugc-preview-area .ugc-preview-photo-desc").html(formData[ii].value);options.slide_information.description=formData[ii].value;break;}}if(typeof(ugc_data.sponsor_html)!="undefined"){$("#ugc-preview-area .ugc-sponsored-by").html(ugc_data.sponsor_html);}$("#sso-upload-ugc").hide();$("#ugc-preview-header").show();$("#ugc-preview-area").show();setTimeout(function(){$.fn.ssoColorbox.resize();},50);}else{if(switch_option=="upload"){options.submitUGCForm=false;hideUGCUploadError();$("#ugc-preview-header").hide();$("#ugc-preview-area").hide();$("#sso-upload-ugc").show();setTimeout(function(){$.fn.ssoColorbox.resize();},50);}else{if(switch_option=="share"){hideUGCUploadError();var final_image_url="/photo/get-for-ugc?photo_id="+options.slide_information.ugc_id;var poll_graphic_url="http://i.ivillage.com/ugc/hot_dad/poll_graphics.jpg";if(typeof(options.slide_information.image_url)!="undefined"&&options.slide_information.image_url!=""){final_image_url=options.slide_information.image_url;}$("#ugc-share-header").html(ugc_data.header_copy_thankyou_page);$("#ugc-share-area .ugc-share-image").html("<a class='anchor_with_delay' href='"+options.slide_information.full_url+"'><img alt='UGC Photo' src='"+final_image_url+"' /></a>");$("#ugc-share-area .ugc-share-username").html("Uploaded by "+ugc_data.username+"<br/><br/>"+ugc_data.ugc_caption_heading);$("#ugc-share-area .ugc-share-photo-title").html(options.slide_information.title);$("#ugc-share-area .ugc-share-photo-desc").html(options.slide_information.description);$("#ugc-share-area .ugc-share-poll-graphic").html("<a class='anchor_with_delay' href='"+options.slide_information.full_url+"'><img alt='UGC Photo' src='"+poll_graphic_url+"' /></a>");
$("#ugc-share-area a.btn-finish").live("click",function(e){e.preventDefault();$("#ugc-share-area .ugc-share-image").html("<img alt='UGC Photo' src='"+final_image_url+"' />");$("#ugc-share-area .ugc-share-poll-graphic").html("<img alt='UGC Photo' src='"+poll_graphic_url+"' />");$("#ugc-share-area .ugc-waiting-area .waiting-countdown").css("color","#090").html("We are taking you to the Gallery. Your photo could take up to 5 minutes to appear").css("line-height","20px");console.log("page url",options.slide_information.full_url,"/node/"+ugc_data.slideshow_nid);window.location="/node/"+ugc_data.slideshow_nid;});if(typeof(ugc_data.sponsor_html)!="undefined"){$("#ugc-share-area .ugc-sponsored-by").html(ugc_data.sponsor_html);}if(typeof(gigya)!="undefined"){var user_action=new gigya.services.socialize.UserAction();user_action.setUserMessage("This is the user message");user_action.setTitle(options.slide_information.title);user_action.setLinkBack(options.slide_information.full_url);user_action.setDescription(ugc_data.share_description);user_action.addMediaItem({type:"image",src:final_image_url,href:"http://www.ivillage.com"});gigya.services.socialize.showShareUI(options.gigyaConfig,$.extend({userAction:user_action},options.gigya_share_ugc_config));}else{log("Gigya Undefined!!");}$("#sso-cbox-close, a.btn-cancel").unbind("click",deletePhoto);$("#sso-upload-ugc").hide();$("#ugc-preview-header").hide();$("#ugc-preview-area").hide();$("#ugc-share-header").show();$("#ugc-share-area").show();setTimeout(function(){$.fn.ssoColorbox.resize();},50);}}}},create_ugc_slide:function(form){hideUGCUploadError();switchButtonToLoading(form);submitData=form.serializeArray();submitData.push({name:"slideshow_nid",value:ugc_data.slideshow_nid});submitData.push({name:"ugc_nid",value:ugc_data.ugc_nid});submitData.push({name:"channel_tid",value:ugc_data.channel_tid});log("steps.create_ugc_slide()",submitData);$.ajax({type:"POST",url:postPaths.createUGCSlide,cache:false,data:submitData,dataType:"json",beforeSend:function(){form.find("div.buttons").hide();form.find("#ugc-preview-area .ugc-waiting-area .waiting-message").html("Preparing data for submission...");form.find("#ugc-preview-area .ugc-waiting-area").show();var target_element=$("#ugc-preview-area .ugc-waiting-area .waiting-countdown");},success:function(data){log("steps.create_ugc_slide() > Returned from server.",data);switchLoadingToButton(form);form.find("div.buttons").show();form.find("#ugc-preview-area .ugc-waiting-area").hide();if(data&&data.success){flowSuccess=true;options.slide_information.full_url=data.full_url;options.slide_information.image_url=data.slide_image_url;steps.toggel_ugc_upload_form("share",form);}else{if(data&&!data.success){showUGCUploadError(data.error);}}},error:function(){switchLoadingToButton(form);showUGCUploadError("Sorry, we are unable to accept your submission at this time due to technical issues. Please try again later.");form.find("div.buttons").show();form.find("#ugc-preview-area .ugc-waiting-area").hide();$.fn.ssoColorbox.resize();}});}};function ajaxError(XHR,status,error){if(typeof window.console==="object"&&"log" in window.console){window.console.log("There was a server error, please try again later.",error);}}function handleStep(e){e.preventDefault();var that=$(this);var which=that.attr("step");if($.isFunction(steps[which])){steps[which](that);}}function handleNewWindow(e){e.preventDefault();window.open(this.href);}function handleFormSubmitter(e){log("handleFormSubmitter()");e.preventDefault();$(this).parents("form").submit();}function handleAddSave(e){e.preventDefault();log("handleAddSave()");var postData={privacy_level:$("#sso-add-save #save-privacy").val(),url:saveURL};$("#sso-add-save form, #sso-add-save p.query").hide();$("#sso-add-save").append('<div class="ajax-load"></div>');$.fn.ssoColorbox.resize();$.ajax({type:"POST",url:postPaths.addSave,cache:false,data:postData,dataType:"json",error:ajaxError,success:function(data){log("handleAddSave() > Returned from server.",data);closeAfter(0);if($("#profile-private").length){$.event.trigger("saveChange");}saveURL="";}});}function handleDeleteSave(e){e.preventDefault();log("handleDeleteSave()");$("#sso-delete-save").children().hide();$("#sso-delete-save").append('<div class="ajax-load"></div>');$.fn.ssoColorbox.resize();$.ajax({type:"POST",url:postPaths.deleteSave,cache:false,data:{id:saveId,url:saveURL},dataType:"json",error:ajaxError,success:function(data){log("handleDeleteSave() > Returned from server.",data);closeAfter(0);if($("#profile-private").length){$.event.trigger("saveChange");}saveId=0;}});}function handleEditSave(e){e.preventDefault();log("handleEditSave()");$("#sso-add-save").children().hide();$("#sso-add-save").append('<div class="ajax-load"></div>');$.fn.ssoColorbox.resize();var privacy=$("#sso-add-save form select.privacy").val();$.ajax({type:"POST",url:postPaths.editSave,cache:false,data:{id:saveId,privacy_level:privacy},dataType:"json",error:ajaxError,success:function(data){log("handleEditSave() > Returned from server.",data);closeAfter(0);saveId=0;}});}function embedSaveToTextarea(e){e.preventDefault();saveId=$(this).find("#save-id").attr("rel");log("embedSaveToTextarea()");$.ajax({type:"POST",url:postPaths.embedSave,cache:false,data:{id:saveId},error:ajaxError,success:function(data){log("embedSaveToTextarea() > Returned from server.",data);closeAfter(0);saveId=0;var textarea=origEventTarget.parent().siblings("textarea");if(typeof tinyMCE==="object"){textarea.tinymce().execCommand("mceInsertContent",false,data);}else{textarea.append(data);}}});}function handleChooseAvatar(e){e.preventDefault();var id=parseInt($(this).attr("rel"),10);$.ajax({type:"POST",url:postPaths.setAvatar,cache:false,data:{photo_id:id},dataType:"json",error:ajaxError,success:function(data){log("handleChooseAvatar() > Returned from server.",data);if(data&&data.success){if(flowType!=="register"){flowSuccess=true;}steps.thanks();}}});}function handleAddAnotherPhoto(e){e.preventDefault();$("input#sso-upload-more").attr("value","1");$("form#sso-upload").submit();uploadPhotoId=0;}function handlePickPhoto(e){var photo_id=$(this).attr("rel");e.preventDefault();embedPhotoToTextarea(photo_id);closeAfter(0);}function handlePaginate(e){var url=this.href;var con=$("#sso-cbox-loaded-content");e.preventDefault();con.html('<div class="ajax-load">Loading ...</div>');$.fn.ssoColorbox.resize();$.ajax({url:url,cache:false,error:ajaxError,dataType:"html",success:function(data){con.html(data);$.fn.ssoColorbox.resize();}});}function handleFinish(e){e.preventDefault();var that=$(this);if(that.hasClass("btn-finish")){sendDates(closeAfter);}else{sendDates(function(){window.location=that.attr("href");});}}function handleClose(e){e.preventDefault();closeAfter();}function fireOriginalEventOrReload(){log("fireOriginalEventOrReload() > Flow complete.",[flowType,flowSuccess]);options.registrationBoxExpanded=false;if(flowSuccess&&flowType!=="chime"&&lastFlow!=="chime"){if(typeof(origEventTarget)!="undefined"&&origEventTarget.hasClass("sso-pass-thru")){log("fireOriginalEventOrReload() > Fire original event!",[origEventTarget,origEventType]);if(origEventTarget.is("a")){log("fireOriginalEventOrReload() > It was a link.");var href=origEventTarget.attr("href");if(href==="#"){window.location.reload(true);}else{window.location=origEventTarget.attr("href");}}else{log("fireOriginalEventOrReload() > It was another element type.");origEventTarget.trigger(origEventType);}}else{log("fireOriginalEventOrReload() > Reload.");var theurl=window.location.href;if(theurl.indexOf("avatarOrUpload=true")>0){var randomnum=(Math.random()*11);$(location).attr("href","/profile/private?"+randomnum);}else{window.location.reload(true);}}}if(flowType==="chime"){closeAfter(20);}flowSuccess=false;flowType="none";}function log(str,vars){if(typeof iVillage!="undefined"&&typeof iVillage.showLogs!="undefined"&&iVillage.showLogs){if(window.console&&window.console.log){var date=new Date();var hours=date.getHours().toString();var mins=date.getMinutes().toString();var secs=date.getSeconds().toString();var msecs=date.getMilliseconds().toString();hours=(hours.length===1)?"0"+hours:hours;mins=(mins.length===1)?"0"+mins:mins;secs=(secs.length===1)?"0"+secs:secs;msecs+=(msecs.length===1)?"    ":(msecs.length===2)?" ":"";str=hours+":"+mins+":"+secs+":"+msecs+" > SSO > "+str;if(vars){console.log(str,vars);}else{console.log(str);}}}}function filterLoginMessage(login){if(origEventTarget.hasClass("sso-comment")){var head=$("#sso-cbox-intro h3");var para=$("#sso-cbox-intro p");var headerMsg,paraMsg;headerMsg="Want to post a comment? You need to be an iVillage member";if(login){paraMsg='Sign in below or log in through Social Providers. New around here? <a href="#" class="sso-register">Join now!</a>';}else{paraMsg='Be inspired, get advice, and find support from women with shared experiences. You can create<br />your very own iVillage user account or sign in through Social Provider. Already a member? <a href="#" class="sso-log-in">Sign in.</a>';}head.html(headerMsg);para.html(paraMsg);$.fn.ssoColorbox.resize();}}function createPhotoUrl(id,h,w){return options.baseUrl+"photo/get?photo_id="+id+"&height="+h+"&width="+w;}function switchButtonToLoading(form){form.find("div.buttons").hide().after('<div class="ajax-load">Loading...</div>');}function switchGigyaToLoading(){$("#sso-cbox-loaded-content").find("div#"+options.loginUIParams.containerID).hide().after('<div class="ajax-load">Loading...</div>');$.fn.ssoColorbox.resize();}function switchLoadingToButton(form){form.find("div.buttons").show().next().remove();}function switchLoadingToGigya(){$("#sso-cbox-loaded-content").find("div#"+options.loginUIParams.containerID).show().next().remove();$.fn.ssoColorbox.resize();}function closeAfter(msecs){if(typeof msecs==="number"&&msecs>0){setTimeout($.fn.ssoColorbox.close,msecs);}else{var theurl=window.location.href;if(theurl.indexOf("avatarOrUpload=true")>0){var randomnum=(Math.random()*11);$(location).attr("href","/profile/private#?"+randomnum);
}else{$.fn.ssoColorbox.close();}}}function serializedArrayToObject(data){var finalData={};for(var i=0;i<data.length;i++){finalData[data[i].name]=data[i].value;}return finalData;}function displayErrors(list,data){log("displayErrors()",[list,data]);removeErrors(list);if(data.message.length>0){list.prepend('<li class="error">'+data.message+"</li>");}if(typeof data.errors==="object"){$.each(data.errors,function(key,value){log("data.errors",[key,value]);var input=list.find("#"+key);if(input.length>0){var label=$('<label class="error">'+errorArrow+value+"</label>");var inputId=input.attr("id");if(inputId){label.attr("for",inputId);}input.addClass("error").after(label);}});}}function displaySuccess(list,data){log("displaySuccess()",[list,data]);removeErrors(list);if(data.message.length){list.prepend('<li class="success">'+data.message+"</li>");}closeAfter(4000);}function removeErrors(list){log("removeErrors()",list);list.find("li.error, label.error").remove();list.find("input.error").removeClass("error");}function getToken(){log("getToken()");if(typeof(iVillage)!="undefined"&&typeof(iVillage.arw_token)!="undefined"){isAuthenticated=true;userId=parseInt(iVillage.arw_person_id,10);avatarId=parseInt(iVillage.arw_avatar_id,10);username=iVillage.arw_username;if(sessionToken.length>23){}else{sessionToken=iVillage.arw_token;}}if(!ssoReady){ssoReady=true;setTimeout(function(){log("getToken() > Firing the sso.ready event.");$(document).trigger("sso.ready");},1000);}}function establishSession(callback,callonerror){log("establishSession()");$.ajax({type:"POST",url:postPaths.establishSession,cache:false,data:{token:sessionToken},dataType:"json",error:ajaxError,success:function(data){log("establishSession() > Returned from server.",data);isAuthenticated=data.success;if(data&&data.success){sessionToken=data.token;iVillage.arw_token=sessionToken;if($.isFunction(callback)){callback();}}else{if(data&&!data.success){if($.isFunction(callonerror)){callonerror(data);}}}}});}function requestHTML(which,complete){var url_params="?flow_type="+flowType+"&vertical="+options.vertical;var light_box_title="Welcome to iVillage!";if(flowType=="ugc-upload"){if(typeof(ugc_data)!="undefined"){if(typeof(ugc_data.lightbox_title)!="undefined"&&ugc_data.lightbox_title!=""){light_box_title=ugc_data.lightbox_title;}else{if(typeof(ugc_data.media_used)!="undefined"){light_box_title="Upload Your "+ugc_data.media_used;}else{light_box_title="Upload Your File";}}}else{light_box_title="Upload Your File";}}if(options.proxyUrl){url_params=escape(url_params);}log("requestHTML()",which,url_params);if(typeof getPaths[which]==="string"){$.ajax({type:"GET",url:getPaths[which]+url_params,cache:false,dataType:"html",error:ajaxError,success:function(data){if(data){$.fn.ssoColorbox({title:light_box_title,html:data,scrolling:false,onComplete:complete,overlayClose:false});}}});}}function formProcessor(e){log("submit");log("formProcessor()");e.preventDefault();var form=$(e.target);var id=form.attr("id");var name=form.attr("name");var submitData=form.serialize();switch(id){case"sso-sign-in":case"sso-ask-for-password":if(name==="forgot-password"){userForgotPassword(form,submitData);}else{userSignIn(form,submitData);}break;case"sso-register":flowType="register";userRegister(form,submitData);break;case"sso-gigya-register":if(flowType!="chime"){flowType="register";}userRegister(form,submitData,true);break;case"sso-link-existing-fb-user":userUpdateFBProfile(form,submitData);break;case"sso-newsletters":submitData=form.serializeArray();newsletterSignups(form,submitData);break;case"sso-chime-in":submitData=serializedArrayToObject(form.serializeArray());log("formProcessor() > sso-chime-in",submitData);if(submitData.sso_email_username&&submitData.sso_password){userSignIn(form,submitData);}else{guestChimeIn(form,submitData);}break;case"sso-upload":photoEdit(form);break;case"sso-social-get-email":submitSocialEmail(form,submitData);break;}}function userSignIn(form,submitData){log("userSignIn()",[form,submitData]);switchButtonToLoading(form);$.ajax({type:"POST",url:postPaths.login,cache:false,data:submitData,dataType:"json",success:function(data){log("userSignIn() > Returned from server.",data);isAuthenticated=data.success;if(data&&data.success){if(flowType==="login"){iVillage.omniEvent(null,27,"Succesfully finish sign-in.");}userId=parseInt(data.person_id,10);avatarId=parseInt(data.photo_id,10);username=data.username;sessionToken=data.token;if(flowType==="login"||flowType==="register"){flowSuccess=true;closeAfter(0);}else{if(flowType==="chime"){flowSuccess=true;closeAfter(0);triggerChimeEvent({type:"member",dailyNews:submitData.sso_daily_newsletter==="on"?true:false});}else{if(flowType==="avatar"){steps.avatarOrUpload();}else{if(flowType==="newsletters"){steps.newslettersByVertical();}else{if(flowType==="linkingAccounts"){steps.finalizeLinking(data);}}}}}}else{if(flowType==="linkingAccounts"){displayErrors(form.find("fieldset.sso-ask-for-password > ol"),data);}else{displayErrors(form.find("fieldset.sso-sign-in > ol"),data);}omnitureSignInErrors();switchLoadingToButton(form);$.fn.ssoColorbox.resize();}},error:function(){displayErrors(form.find("fieldset.sso-sign-in > ol"),{message:"We're sorry, but we were unable to log you in at this time. Please try again later."});omnitureSignInErrors();switchLoadingToButton(form);$.fn.ssoColorbox.resize();}});}function userForgotPassword(form,submitData){log("userForgotPassword()",[form,submitData]);switchButtonToLoading(form);$.ajax({type:"POST",url:postPaths.forgotPassword,cache:false,data:submitData,dataType:"json",error:ajaxError,success:function(data){log("userForgotPassword() > Returned from server.",data);if(data&&data.success){displaySuccess(form.find("fieldset.sso-sign-in > ol"),data);}else{displayErrors(form.find("fieldset.sso-sign-in > ol"),data);}switchLoadingToButton(form);}});}function userRegister(form,submitData,is_gigya){log("userRegister()",[form,submitData]);switchButtonToLoading(form);var register_path=postPaths.register;if(typeof(is_gigya)!="undefined"&&is_gigya){log("userRegister() via gigya");register_path=postPaths.gigyaRegister;}$.ajax({type:"POST",url:register_path,cache:false,data:submitData,dataType:"json",success:function(data){log("userRegister() > Returned from server.",data);isAuthenticated=data.success;flowSuccess=data.success;if(data&&data.success){userId=parseInt(data.person_id,10);username=data.username;sessionToken=data.token;var daily=$("#sso_daily_newsletter");var offer=$("#sso_offers_promotions");if(daily.length||offer.length){regNlid=[];if(daily.is(":checked")){regNlid.push(6);}if(offer.is(":checked")){regNlid.push(68);}}if(flowType==="chime"||lastFlow=="chime"){flowSuccess=true;closeAfter(0);triggerChimeEvent({type:"member",dailyNews:submitData.sso_daily_newsletter==="on"?true:false});}else{steps.newslettersByVertical();}}else{displayErrors(form.find("fieldset > ol"),data);omnitureRegistrationErrors();switchLoadingToButton(form);$.fn.ssoColorbox.resize();}},error:function(){displayErrors(form.find("fieldset.sso-sign-in > ol"),{message:"We're sorry, but we were unable to create your account at this time. Please try again later."});omnitureRegistrationErrors();switchLoadingToButton(form);$.fn.ssoColorbox.resize();}});}function userUpdateFBProfile(form,submitData){log("userUpdateFBProfile()",[form,submitData]);switchButtonToLoading(form);$.ajax({type:"POST",url:postPaths.userUpdateFBProfile,cache:false,data:submitData,dataType:"json",success:function(data){log("userUpdateFBProfile() > Returned from server.",data);isAuthenticated=data.success;flowSuccess=data.success;if(data&&data.success){userId=parseInt(data.person_id,10);username=data.username;sessionToken=data.token;flowSuccess=true;closeAfter(0);if(flowType==="chime"||lastFlow=="chime"){triggerChimeEvent({type:"member"});}}else{displayErrors(form.find("fieldset > ol"),data);omnitureRegistrationErrors();switchLoadingToButton(form);$.fn.ssoColorbox.resize();}},error:function(){displayErrors(form.find("fieldset.sso-sign-in > ol"),{message:"We're sorry, but we were unable to update your account at this time. Please try again later."});omnitureRegistrationErrors();switchLoadingToButton(form);$.fn.ssoColorbox.resize();}});}function guestChimeIn(form,submitData){var errorData={};log("guestChimeIn()",[form,submitData]);switchButtonToLoading(form);if(submitData.sso_guest_email&&submitData.sso_guest_name){log("guestChimeIn() > Guest chime success!");closeAfter(0);triggerChimeEvent({type:submitData.sso_anonymous==="on"?"anon":"guest",guestName:submitData.sso_guest_name,guestEmail:submitData.sso_guest_email,dailyNews:submitData.sso_daily_newsletter==="on"?true:false});}else{errorData.message="If you choose not to log in, you must enter your name and email.";if(submitData.sso_anonymous){errorData.message+=" Although we won't display this information, it's still required.";}displayErrors(form.find("fieldset.chime-guest > ol"),errorData);switchLoadingToButton(form);$.fn.ssoColorbox.resize();}}function submitSocialEmail(form,submitData){log("submitSocialEmail()",[form,submitData]);switchButtonToLoading(form);$.ajax({type:"POST",url:postPaths.socialEmail,cache:false,data:submitData,error:ajaxError,dataType:"json",success:function(data){if(data&&data.valid){if(flowType=="emailLookup"){if(data.new_registration){steps.registerNewUser(userSocialData,data.new_email_id);}else{steps.askForPassword(userSocialData,data);}}else{if(flowType==="avatar"){steps.avatarOrUpload();}else{steps.newslettersByVertical();}}}else{displayErrors(form.find("ol"),{message:"Please provide a valid email address."});switchLoadingToButton(form);$.fn.ssoColorbox.resize();}}});}function triggerChimeEvent(extras){log("triggerChimeEvent() > sso."+chimeType,extras);$(document).trigger("sso."+chimeType,extras);}function newsletterSignups(form,submitData){log("newsletterSignups()",[form,submitData]);switchButtonToLoading(form);var buttons=$("#sso-newsletters div.buttons");var nothanks=buttons.find("a.btn-no-thanks");
nothanks.hide();var error=false;var required=form.find("input.start-date-required");if(required.length){required.each(function(){var that,nl_id,li;if(error){return false;}that=$(this);nl_id=that.attr("id").replace("nl_","");if(that.is(":checked")){li=that.parent("li");nl_id=that.attr("id");li.find("select").each(function(){if($(this).val()==="default"){li.append('<label for="'+nl_id+'" generated="true" class="error"><span class="error-arrow"></span>Please provide a date</label>');switchLoadingToButton(form);nothanks.show();error=true;return false;}});}});}if(!error){submitData=prepareNewsletterData(submitData);log("newsletterSignups() > Final data.",submitData);$.ajax({type:"POST",url:postPaths.newsletterSignUp,cache:false,data:submitData,dataType:"json",error:ajaxError,success:function(data){if(data&&data.success){omnitureNewsletterEvent(submitData.newsletters,submitData.startDates);if(flowType==="chime"||lastFlow=="chime"){flowSuccess=true;closeAfter(0);triggerChimeEvent({type:"member",dailyNews:submitData.sso_daily_newsletter==="on"?true:false});}else{steps.thanks();}}else{switchLoadingToButton(form);nothanks.show();var nl_id=form.find('li:eq(0) input[type="checkbox"]').attr("id");buttons.append('<label for="'+nl_id+'" class="error" generated="true"><span class="error-arrow"></span>'+data.message+"</label>");error=true;return;}}});}}function prepareNewsletterData(data){var finalData={startDates:{},newsletters:[],funnelid:"",email:"",sourceid:0,verticalid:0};log("prepareNewsletterData()",data);$.each(data,function(i,item){var type=item.name.split("_")[0];var id=item.name.split("_")[1];if(type==="nl"){finalData.newsletters.push(item.value);}else{if(type==="email"){finalData.email=item.value;}else{if(type==="funnelid"){finalData.funnelid=item.value;}else{if(type==="sourceid"){finalData.sourceid=item.value;}else{if(type==="verticalid"){finalData.verticalid=item.value;}else{if(item.value!=="default"){finalData.startDates[id]=finalData.startDates[id]||{};finalData.startDates[id][type]=item.value;}}}}}}});return finalData;}function omnitureNewsletterEvent(newsletters,startDates){var omniIds=[];for(var i=0;i<newsletters.length;i++){var nlid=newsletters[i]*1;if(typeof(startDates[nlid])!=="undefined"&&typeof(startDates[nlid]["omni"])!=="undefined"){omniIds.push(startDates[nlid]["omni"]);}}iVillage.omniEvent(31,24,"Newsletter registration.",null,omniIds);}function avatarTelescope(e){var that=$(this);if(e.type==="mouseover"){that.data("over",true);setTimeout(function(){if(that.data("over")){avatarOverlayReveal(that);}},750);}else{that.data("over",false);}}function avatarOverlayReveal(that){var offset=that.offset();var outerWidth=that.outerWidth(true);var listOffset=that.parent().offset();var link=that.children("a");var photoId=parseInt(link.attr("rel"),10);var thumb=link.children("img");var bigLink=avatarOverlay.children("a");var bigThumb=new Image();var overlayCss={display:"block",top:offset.top-4,left:offset.left-4,opacity:0.5};bigLink.attr("name",":iv:registration:avatar-select");avatarOverlay.data("callerSize",outerWidth).data("alignLeft",true);if(outerWidth>60&&(offset.left-listOffset.left>268)){avatarOverlay.data("alignLeft",false);overlayCss.left-=154-outerWidth;}bigLink.empty();bigThumb.src=createPhotoUrl(photoId,150,150);bigThumb.onload=function(){bigLink.html(bigThumb);avatarOverlay.css("opacity",1);$(bigThumb).fadeIn("fast");};bigLink.attr("rel",photoId);avatarOverlay.css(overlayCss);}function avatarOverlayCheckPosition(e){var callerSize=avatarOverlay.data("callerSize");var outerWidth=avatarOverlay.outerWidth(true);var offset=avatarOverlay.offset();if(avatarOverlay.data("alignLeft")){if(e.pageX-offset.left>callerSize){avatarOverlayCleanup();}}else{if(offset.left+outerWidth-e.pageX>callerSize){avatarOverlayCleanup();}}if(e.pageY-offset.top>callerSize){avatarOverlayCleanup();}}function avatarOverlayCleanup(){avatarOverlay.hide().data("callerSize",0).data("alignLeft",true).data("over",false);avatarOverlay.children("a").empty();}function rotatePhoto(direction){log("rotatePhoto()",direction);var container=$("#sso-jcrop-container");var photoId=uploadPhotoId;var postData={photo_id:photoId,clockwise:direction};if(photoId){establishSession(function(){container.find("#sso-jcrop-target-img").remove();container.children().hide();container.find(".ajax-load").show();$.fn.ssoColorbox.resize();$.ajax({type:"POST",url:postPaths.rotatePhoto,cache:false,data:postData,dataType:"json",error:ajaxError,success:function(data){if(data&&data.success){if(flowType=="ugc-upload"){cleanUploadButtonForUploadify("sso-upload");}completeUploads=0;finalizePhotoUpload("/photo/get?photo_id="+photoId);}}});});}}function rotateClockwise(){rotatePhoto(1);}function rotateCounterClockwise(){rotatePhoto(0);}function deletePhoto(){log("deletePhoto()");establishSession(function(){if(uploadPhotoId!==0){$.ajax({type:"POST",url:postPaths.deletePhoto,cache:false,data:{photo_ids:{"0":uploadPhotoId}}});}if(flowType==="avatar"){steps.avatarOrUpload();}getToken();});}function finalizePhotoUpload(image_path){log("finalizePhotoUpload()",image_path);completeUploads++;if(completeUploads>1){log("finalizePhotoUpload() > completeUploads",completeUploads);return false;}$("#sso-cbox-close, a.btn-cancel").bind("click",deletePhoto);var container=$("#sso-jcrop-container");var cancel=$("#sso-upload a.btn-cancel");var controls=container.find("#sso-pic-controls");var loader=container.find(".ajax-load");var image=new Image();container.show();if(loader.length){loader.show();}else{controls.before('<div class="ajax-load"></div>');loader=container.find(".ajax-load");}$("#sso-jcrop-after").show();var stamp=new Date().getTime();image_path=options.baseUrl.replace(/\/$/,"")+image_path+"&"+stamp;log(image_path);$.fn.ssoColorbox.resize();image.id="sso-jcrop-target-img";image.onload=function(){var register=(flowType==="avatar"||flowType==="register");var cropHeight=register?160:image.height*0.95;var cropWidth=register?160:image.width*0.95;cancel.removeClass("btn-hide");$("#sso-cbox-close").show();loader.hide();controls.before(image).show();container.find("#sso-pic-controls").show();$.fn.ssoColorbox.resize();$("#sso-photo-details").fadeIn();cropApi=$.Jcrop("#sso-jcrop-target-img",{boxWidth:400,boxHeight:600,aspectRatio:register?1:"",setSelect:[10,10,cropWidth,cropHeight],allowSelect:false});if(flowType==="ugc-upload"){$("#sso-submit-ugc .sso-control-ugc").children().show();}else{$("#sso-submit-photo").children().show();}if(flowType==="insert-photo"){$("#sso-submit-photo #sso-upload-another").hide();}};image.src=image_path;return true;}function embedPhotoToTextarea(photo_id){var textarea=origEventTarget.parent().siblings("textarea");var string='<p><img src="/photo/get?photo_id='+photo_id+'" alt="" /></p>';if(window.tinyMCE){textarea.tinymce().execCommand("mceInsertContent",false,string);}else{textarea.append(string);}}function photoEdit(form){log("photoEdit()",form);if(flowType==="ugc-upload"){if(options.submitUGCForm&&$("#sso-upload-ugc").css("display")=="none"){steps.create_ugc_slide(form);return;}}var cropCoords=cropApi.tellSelect();var submitData={photo_id:uploadPhotoId,height:cropCoords.h,width:cropCoords.w,top:cropCoords.y,left:cropCoords.x,title:null,description:null};if(flowType!=="avatar"&&flowType!=="register"){submitData.title=$("input#sso_title").val();var subDesc=$("textarea#sso_description").val();subDesc=(subDesc.length>140)?subDesc.substring(0,140):subDesc;submitData.description=subDesc;}if(flowType=="ugc-upload"){submitData.privacy="hidden";}switchButtonToLoading(form);establishSession(function(){$.ajax({type:"POST",url:postPaths.cropAvatar,cache:false,data:submitData,dataType:"json",error:ajaxError,success:function(data){log("photoEdit() > Returned from server.",data);if(flowType==="avatar"||flowType==="register"){flowSuccess=true;setAvatar(uploadPhotoId,steps.thanks);}else{if(flowType==="insert-photo"){embedPhotoToTextarea(uploadPhotoId);closeAfter(0);}else{if(flowType==="ugc-upload"){switchLoadingToButton(form);steps.toggel_ugc_upload_form("preview",form);}else{if($("input#sso-upload-more").val()=="1"){steps.uploadPhoto();}else{closeAfter(0);window.location.reload(true);}}}}}});});}function setAvatar(id,callback){log("setAvatar()",[id,callback]);$.ajax({type:"POST",url:postPaths.setAvatar,cache:false,data:{photo_id:id},dataType:"json",error:ajaxError,success:function(data){log("setAvatar() > Returned from server.",data);if(data&&data.success){avatarId=parseInt(data.photo_id,10);if($.isFunction(callback)){callback();}}}});}function cloneBirthdayRow(e){log("cloneBirthdayRow()");e.preventDefault();var list=$("#sso-children > fieldset.child > ol");var items=list.children("li");var btnRow=list.children("li:last");var newLi=btnRow.prev().clone();newLi.children("select").each(function(){var that=$(this);var id=that.attr("id");var idArr=id.split("-");var name=that.attr("name");var nameArr=name.split("-");idArr[idArr.length-1]=items.length;that.attr("id",idArr.join("-"));nameArr[nameArr.length-1]=items.length;that.attr("name",nameArr.join("-"));});btnRow.before(newLi);$.fn.ssoColorbox.resize();}function prepareDates(data){log("prepareDates()",data);var finalData={birthdays:[],due_date:{}};$.each(data,function(itemIndex,item){var nameArr=item.name.replace("sso_","").split("_");var obj={};var index;if(nameArr[0]==="due"){finalData.due_date[nameArr[1]]=item.value;}else{if(nameArr[0]==="bday"){index=parseInt(nameArr[2],10)-1;if(finalData.birthdays[index]){finalData.birthdays[index][nameArr[1]]=item.value;}else{obj[nameArr[1]]=item.value;finalData.birthdays.push(obj);}}}});return finalData;}function sendDates(callback){log("sendDates()");var submitData=prepareDates($("#sso-children").serializeArray());$.ajax({type:"POST",url:postPaths.setChildren,cache:false,data:submitData,dataType:"json",error:ajaxError,success:function(data){log("sendDates() > Returned from server.",data);if(data&&data.success){if($.isFunction(callback)){callback();}}}});}function omnitureRegistrationErrors(){var form=$("#sso-register");
var errors=form.find("label.error");var propCodes=[];var errorMap={sso_email:3,sso_username:4,sso_dob_year:8,sso_dob_day:9,sso_dob_month:10,sso_country_id:11,sso_zip_code:12,sso_terms:13};errors.each(function(){if($(this).is(":visible")){var labelFor=$(this).attr("for");if(errorMap[labelFor]!=="undefined"&&errorMap[labelFor]){propCodes.push(errorMap[labelFor]);}else{if(labelFor==="sso_password"){var val=$("#sso_password").val();if(val.length===0){propCodes.push(5);}else{if(val.length<4){propCodes.push(6);}}}else{if(labelFor==="sso_confirm_password"){var val=$("#sso_password").val();if(val.length>0){propCodes.push(7);}}}}}});iVillage.omniEvent(32,21,"Registration Error",null,propCodes);}function omnitureGigyaRegistrationErrors(){var form=$("#sso-gigya-register");var errors=form.find("label.error");var propCodes=[];var errorMap={sso_email:3,sso_username:4,sso_dob_year:8,sso_dob_day:9,sso_dob_month:10,sso_country_id:11,sso_zip_code:12,sso_terms:13};errors.each(function(){if($(this).is(":visible")){var labelFor=$(this).attr("for");if(errorMap[labelFor]!=="undefined"&&errorMap[labelFor]){propCodes.push(errorMap[labelFor]);}else{if(labelFor==="sso_password"){var val=$("#sso_password2").val();if(val.length===0){propCodes.push(5);}else{if(val.length<4){propCodes.push(6);}}}else{if(labelFor==="sso_confirm_password"){var val=$("#sso_password2").val();if(val.length>0){propCodes.push(7);}}}}}});iVillage.omniEvent(32,21,"Gigya Registration Error",null,propCodes);}function omnitureSignInErrors(gigyalogin){var form=$("#sso-sign-in");var errors=form.find("label.error");var propCodes=[];if(typeof gigyalogin!=="undefined"&&gigyalogin===true){propCodes.push(27);}var errorMap={sso_password:2};if(form.find("fieldset ol li:eq(0)").hasClass("error")){propCodes.push(1);}errors.each(function(){var labelFor=$(this).attr("for");if(errorMap[labelFor]!=="undefined"&&errorMap[labelFor]){propCodes.push(errorMap[labelFor]);}});iVillage.omniEvent(32,26,"Sign-in Error",null,propCodes);}function customOmniEvent(prop,events,message){var verticalMsg=null;var vertical=iVillage.siteName;if(vertical.length&&typeof vertical==="string"){vertical=vertical.toLowerCase();switch(events){case 20:verticalMsg="joinnow_";break;case 25:if(message.indexOf("gigyaconnect")!==-1){verticalMsg="gigyasignin_";}else{verticalMsg="signin_";}if(flowType==="forgot-password"){vertical="forgotpassword";}break;}verticalMsg=verticalMsg+vertical;}log("Firing Omniture Event");iVillage.omniEvent(prop,events,message,verticalMsg);}function fillAccountLinkForm(eventObj){$("#sso-ask-for-password").find('input[name="link_accounts"]').val("1");$("#sso-ask-for-password").find('input[name="uid"]').val(eventObj.UID);$("#sso-ask-for-password").find('input[name="provider"]').val(eventObj.provider);if(typeof(eventObj.user.firstName)!="undefined"){$("#sso-ask-for-password").find('input[name="first_name"]').val(eventObj.user.firstName);}if(typeof(eventObj.user.lastName)!="undefined"){$("#sso-ask-for-password").find('input[name="last_name"]').val(eventObj.user.lastName);}if(typeof(eventObj.user.gender)!="undefined"){$("#sso-ask-for-password").find('input[name="gender"]').val(eventObj.user.gender);}if(typeof(eventObj.user.birthYear)!="undefined"){$("#sso-ask-for-password").find('input[name="birthYear"]').val(eventObj.user.birthYear);}if(typeof(eventObj.user.birthMonth)!="undefined"){$("#sso-ask-for-password").find('input[name="birthMonth"]').val(eventObj.user.birthMonth);}if(typeof(eventObj.user.birthDay)!="undefined"){$("#sso-ask-for-password").find('input[name="birthDay"]').val(eventObj.user.birthDay);}$.fn.ssoColorbox.resize();return true;}function fillUserInfoHeader(eventObj,user_info_container,custom_message){var user_information="";if(typeof(eventObj.user.thumbnailURL)!="undefined"&&eventObj.user.thumbnailURL!=""){user_information+='<img src="'+eventObj.user.thumbnailURL+'" alt="User Thumbnail" />';}user_information+=" Welcome";if(typeof(eventObj.user.firstName)!="undefined"&&eventObj.user.firstName!=""){user_information+=", "+eventObj.user.firstName;}else{if(typeof(eventObj.user.email)!="undefined"&&eventObj.user.email!=""){user_information+=", "+eventObj.user.firstName;}}user_information+="! "+custom_message;$("."+user_info_container+" .user-information").html(user_information);$.fn.ssoColorbox.resize();return true;}function fillGigyaRegisterForm(eventObj,user_email){$("#sso-gigya-register").find('input[name="uid"]').val(eventObj.UID);$("#sso-gigya-register").find('input[name="provider"]').val(eventObj.provider);if(typeof(user_email)!="undefined"&&user_email!=""){$("#sso-gigya-register").find('input[name="sso_email"]').val(user_email).parents("li").hide();}else{if(typeof(eventObj.user.email)!="undefined"&&eventObj.user.email!=""){$("#sso-gigya-register").find('input[name="sso_email"]').val(eventObj.user.email).parents("li").hide();user_email=eventObj.user.email;}}if(typeof(eventObj.user.gender)!="undefined"&&eventObj.user.gender!=""){$("#sso-gigya-register").find('[name="sso_gender"]').val(eventObj.user.gender).parents("li").hide();}if(typeof(eventObj.user.birthYear)!="undefined"&&typeof(eventObj.user.birthMonth)!="undefined"&&typeof(eventObj.user.birthDay)!="undefined"&&eventObj.user.birthYear!=""&&eventObj.user.birthMonth!=""&&eventObj.user.birthDay!=""){$("#sso-gigya-register").find('[name="sso_dob_year"]').val(eventObj.user.birthYear);$("#sso-gigya-register").find('[name="sso_dob_month"]').val(eventObj.user.birthMonth);$("#sso-gigya-register").find('[name="sso_dob_day"]').val(eventObj.user.birthDay).parents("li").hide();}if(typeof(eventObj.user.zip)!="undefined"&&eventObj.user.zip!=""){$("#sso-gigya-register").find('input[name="sso_zip_code"]').val(eventObj.user.zip);}var theUsername="";if(typeof(eventObj.user.nickname)!="undefined"){theUsername=eventObj.user.nickname;}if(theUsername==""&&(typeof(eventObj.user.firstName)!="undefined"||typeof(eventObj.user.lastName)!="undefined")){theUsername=typeof(eventObj.user.firstName)!="undefined"?eventObj.user.firstName:"";theUsername=(typeof(eventObj.user.lastName)!="undefined"&&theUsername.length>0)?theUsername.concat(".",eventObj.user.lastName):theUsername;}if(theUsername==""&&typeof(user_email)!="undefined"&&user_email!=""){theUsername=user_email.split("@");theUsername=theUsername[0];}$("#sso-gigya-register").find('input[name="sso_username"]').val(theUsername.toLowerCase());$.fn.ssoColorbox.resize();return true;}function fillFBAccountLinkForm(eventObj){$("#sso-link-existing-fb-user").find('input[name="uid"]').val(eventObj.UID);$("#sso-link-existing-fb-user").find('input[name="provider"]').val(eventObj.provider);if(typeof(eventObj.user.gender)!="undefined"&&eventObj.user.gender!=""){$("#sso-link-existing-fb-user").find('[name="sso_gender"]').val(eventObj.user.gender).parents("li").hide();}if(typeof(eventObj.user.birthYear)!="undefined"&&typeof(eventObj.user.birthMonth)!="undefined"&&typeof(eventObj.user.birthDay)!="undefined"&&eventObj.user.birthYear!=""&&eventObj.user.birthMonth!=""&&eventObj.user.birthDay!=""){$("#sso-link-existing-fb-user").find('[name="sso_dob_year"]').val(eventObj.user.birthYear);$("#sso-link-existing-fb-user").find('[name="sso_dob_month"]').val(eventObj.user.birthMonth);$("#sso-link-existing-fb-user").find('[name="sso_dob_day"]').val(eventObj.user.birthDay).parents("li").hide();}if(typeof(eventObj.user.zip)!="undefined"&&eventObj.user.zip!=""){$("#sso-link-existing-fb-user").find('input[name="sso_zip_code"]').val(eventObj.user.zip);}$.fn.ssoColorbox.resize();return true;}function displayHiddenFields(container,element){var need_resize=false;log("displayHiddenFields()");$(container).find(element).each(function(){if($(this).css("display")=="none"){$(this).show("fast","linear");$.fn.ssoColorbox.resize();need_resize=true;}else{if($(this).hasClass("hide")){$(this).css("display","none").removeClass("hide").show("fast","linear");$.fn.ssoColorbox.resize();need_resize=true;}}});return need_resize;}function showGigyaError(eventObj,container){var errorMessage="";if(eventObj.errorCode!=0){switch(eventObj.errorCode){case"100001":case"500001":case"500002":errorMessage="Seems like server is busy at the moment. Please try again after some time.";break;case"200001":errorMessage="Login process canceled. Please try again.";break;case"200003":errorMessage="Please try again and grant social network permission.";break;case"400001":case"400002":case"400004":case"400006":case"400008":case"400011":case"400012":case"400013":case"400014":case"400015":errorMessage="Invalid Request. Please try again.";break;case"400050":errorMessage="Invalid user data returned. Please try again after some time.";break;case"400122":case"500023":errorMessage="There is some issue with the social provider you are trying to connect to. Please try login with different provider or try again after some time.";break;case"403001":case"403002":case"403009":case"403011":case"403012":case"403030":case"500014":case"500024":errorMessage="Session Expired. Please login again.";break;case"403007":errorMessage="Permission Denied. Please try again after some time.";break;case"500026":errorMessage="Network connection issue. Please try again.";break;case"504001":errorMessage="Connection timeout. Please try again.";break;case"500032":errorMessage="Unalbe to load gigya service at the moment. Please try again after some time.";break;default:errorMessage=eventObj.errorMessage;}if($("#sso-cbox span.error").length){$("#sso-cbox span.error").remove();}$("#"+container).html('<span class="error">'+errorMessage+"</span>"+$("#"+container).html());}}function editedConnection(eventObj){$.ajax({type:"POST",url:postPaths.editedConnection,cache:false,data:eventObj,dataType:"json",error:ajaxError,success:function(data){log("editedConnection() > Returned from server.",data);}});}function updateUGCLayover(containerID){var container_object=$("#"+containerID);log("updateUGCLayover()",container_object);if(container_object.length&&typeof(ugc_data)!="undefined"){if(typeof(ugc_data.caption_upload_box)!="undefined"&&ugc_data.caption_upload_box!=""){container_object.find(".ugc_location").html(ugc_data.caption_upload_box);
}else{container_object.find(".ugc_location").html(ugc_data.media_used+" Location");}container_object.find(".upload_help_text").html(ugc_data.upload_help_text);if(typeof(ugc_data.additional_fields)!="undefined"){for(var key in ugc_data.additional_fields){$("label."+key).html(ugc_data.additional_fields[key]);$("input#"+key);$("input#"+key).parent().show();}}$(".sso_ugc_title").html(ugc_data.caption_image_title);$(".sso_ugc_description").html(ugc_data.caption_image_description);var category_select_boxes="";if(typeof(ugc_data.ugc_categories)!="undefined"){for(var key in ugc_data.ugc_categories){category_select_boxes+='<div style="float: left;"><input type="radio" id="ugc_category_'+key+'" name="ugc_categories" value="'+key+'" /> <label for="ugc_category_'+key+'">'+ugc_data.ugc_categories[key]+"</label></div>";}$(".ugc_categorization").show();$("#ugc_categorization_group").html(category_select_boxes);}if(typeof(ugc_data.terms_conditions)!="undefined"){$(".additional_optin").html('<ol><li><input type="checkbox" id="additional_optin" name="additional_optin" value="additional_optin" /> <label class="additional_option_label" for="additional_optin">'+ugc_data.terms_conditions+"</label></li></ol>");}}}function bind_uploadify_for_ugc_photo(container_id,post_path,size_limit,file_extension,file_desc){var cancel=$("#sso-submit-ugc a.btn-cancel.sso-close");$("#"+container_id+" input[type='file']").unbind().uploadify({uploader:uploadSwf,width:65,height:25,script:post_path,fileDataName:"photo",sizeLimit:size_limit,scriptData:{token:sessionToken},cancelImg:options.baseUrl+"public/sso/images/cancel.png",buttonImg:options.baseUrl+"public/sso/images/btn-browse-for-flash.png",auto:true,fileExt:file_extension,fileDesc:file_desc,onSelect:function(event,queueID,fileObj){cancel.addClass("btn-hide");$("#sso-cbox-close").hide();},onError:function(a,b,c,d){log("Uploadify error: ",[a,b,c,d]);showUGCUploadError("Sorry, we are unable to accept your submission at this time due to technical issues. Please try again later.");cancel.removeClass("btn-hide");$("#sso-cbox-close").show();},onComplete:function(event,queueID,fileObj,response){log("uploadify > onComplete()",response);establishSession(function(){response=$.parseJSON(response);uploadPhotoId=response.photo_id;$("#sso_ugc_id").val(uploadPhotoId);if(flowType=="ugc-upload"){cleanUploadButtonForUploadify(container_id);}finalizePhotoUpload(response.url,event,queueID,fileObj,response);},function(data){if(typeof(data)!="undefined"&&typeof(data.message)!="undefined"){if(data.message.indexOf("Token")!=-1&&data.message.indexOf("not valid")!=-1){showUGCUploadError("Sorry, we are unable to accept your submission at this time due to technical issues. Please logout and login again.");}else{showUGCUploadError("Sorry, we are unable to accept your submission at this time due to technical issues. Please try again later.");}cancel.removeClass("btn-hide");$("#sso-cbox-close").show();}});},onAllComplete:function(){log("uploadify > onAllComplete()");completeUploads=0;}});}function cleanUploadButtonForUploadify(container_id){if(!$.browser.msie){var input_box_id=$("#"+container_id+" input[type='file']").attr("id");var flash_var_to_update=$("#"+input_box_id+"Uploader param[name=flashvars]").attr("value");var dummy_param_array=flash_var_to_update.split("&");for(var count=0;count<dummy_param_array.length;count++){if(dummy_param_array[count].indexOf("scriptData")!=-1){dummy_param_array[count]="scriptData=token%3D"+sessionToken;}}$("#"+input_box_id+"Uploader param[name=flashvars]").attr("value",dummy_param_array.join("&"));var input_box_id=$("#"+container_id+" #sso-jcrop-container #sso-pic-controls").siblings().each(function(){$(this).remove();});}return;}function showUGCUploadError(ugc_error_detail){hideUGCUploadError();if(typeof(ugc_error_detail)=="undefined"){return;}$("#ugc-upload-errors").html("<p>"+ugc_error_detail+"</p>").show();$.fn.ssoColorbox.resize();}function hideUGCUploadError(){$("#ugc-upload-errors").html("").hide();$.fn.ssoColorbox.resize();}function initiateCountDown(container_id,settings,to){settings=jQuery.extend({startFontSize:"36px",endFontSize:"24px",duration:1000,startNumber:10,endNumber:0,callBack:function(){}},settings);if(!to&&to!=settings.endNumber){to=settings.startNumber;}container_id.text(to).css("fontSize",settings.startFontSize);container_id.animate({fontSize:settings.endFontSize},settings.duration,"",function(){if(container_id.parent().css("display")!="none"){if(to>settings.endNumber+1){container_id.css("fontSize",settings.startFontSize).text(to-1);initiateCountDown(container_id,settings,to-1);}else{settings.callBack();}}});}return{login:function(e){origEventType=e.type;origEventTarget=$(e.target);if(!isAuthenticated){e.preventDefault();flowType="login";steps.login();}},gigyaLogin:function(e){origEventType=e.type;origEventTarget=$(e.target);if(!isAuthenticated){e.preventDefault();flowType="gigyaLogin";steps.gigyaLogin();}},registerNewUser:function(e){origEventType=e.type;origEventTarget=$(e.target);if(!isAuthenticated){e.preventDefault();flowType="gigyaRegister";steps.registerNewUser();}},askForEmail:function(e){origEventType=e.type;origEventTarget=$(e.target);if(!isAuthenticated){e.preventDefault();flowType="emailLookup";steps.askForEmail();}},askForPassword:function(e){origEventType=e.type;origEventTarget=$(e.target);if(!isAuthenticated){e.preventDefault();flowType="linkingAccounts";steps.askForPassword();}},linkExistingFBUser:function(e){origEventType=e.type;origEventTarget=$(e.target);if(!isAuthenticated){e.preventDefault();flowType="linkingAccounts";steps.linkExistingFBUser();}},finalizeLinking:function(e){origEventType=e.type;origEventTarget=$(e.target);if(!isAuthenticated){e.preventDefault();steps.finalizeLinking();}},forgotPassword:function(e){origEventType=e.type;origEventTarget=$(e.target);if(!isAuthenticated){e.preventDefault();flowType="forgot-password";steps.forgotPassword();}},logout:function(e){origEventType=e.type;origEventTarget=$(e.target);e.preventDefault();flowType="logout";steps.logout();},register:function(e){origEventType=e.type;origEventTarget=$(e.target);if(!isAuthenticated){e.preventDefault();flowType="register";steps.register();}},chime:function(e){e.preventDefault();origEventType=e.type;origEventTarget=$(e.target);chimeType=e.target.className.indexOf("twist")===-1?"chime":"twist";if(!isAuthenticated){flowType="chime";steps.chime();}else{triggerChimeEvent({type:"member"});}},newsletters:function(e){origEventType=e.type;origEventTarget=$(e.target);e.preventDefault();flowType="newsletters";steps.newslettersByVertical();},newsletters_nudge:function(){newsletterOverride=true;this.newsletters(jQuery.Event("click"));},avatar:function(e){origEventType=e.type;origEventTarget=$(e.target);e.preventDefault();flowType="avatar";steps.avatarOrUpload(origEventTarget);},photo:function(e){origEventType=e.type;origEventTarget=$(e.target);e.preventDefault();flowType="photo";steps.uploadPhoto(origEventTarget);},insertPhoto:function(e){origEventType=e.type;origEventTarget=$(e.target);e.preventDefault();flowType="insert-photo";steps.insertOrUploadPhoto(origEventTarget);},save:function(e){origEventType=e.type;origEventTarget=$(e.target);e.preventDefault();if(!isAuthenticated){e.preventDefault();flowType="login";steps.login();}else{flowType="save";saveURL=origEventTarget.attr("href");steps.addSave(origEventTarget);}},deleteSave:function(e){origEventType=e.type;origEventTarget=$(e.target);e.preventDefault();flowType="delete-save";saveURL=origEventTarget.attr("href");saveId=origEventTarget.attr("rel");steps.deleteSave(origEventTarget);},editSave:function(e){origEventType=e.type;origEventTarget=$(e.target);e.preventDefault();flowType="edit-save";steps.editSave(origEventTarget);saveId=origEventTarget.attr("rel");},insertSave:function(e){origEventType=e.type;origEventTarget=$(e.target);e.preventDefault();flowType="insert-save";steps.insertSave(origEventTarget);},completeRegistration:function(){},isSsoReady:function(){return ssoReady;},isLoggedIn:function(){return isAuthenticated;},getUserId:function(){return isAuthenticated?userId:0;},getAvatarId:function(){return isAuthenticated?avatarId:0;},getUsername:function(){return isAuthenticated?username:"";},loadAddConnectionUI:function(attemptCount){if(typeof attemptCount=="undefined"){attemptCount=0;}log("Attempt Count for loadAddConnectionUI: "+attemptCount);if(typeof(gigya)!="undefined"&&!options.addConnectionsUILoaded){options.gigyaConfig=$.extend(options.gigyaConfig,{APIKey:iVillage.gigya_api_key});if($("#mod-social-connections").length>0){gigya.services.socialize.getUserInfo($.extend({APIKey:iVillage.gigya_api_key},options.gigyaConfig,{callback:function(response){var connectedProviders=response.user.identities;for(key in connectedProviders){$("#mod-social-connections .body ."+key).addClass("connected");$("#mod-social-connections .body ."+key+" .icon").empty().append($("<img />").attr("src","/public/images/icons/social/"+key+"_20_connected.png"));$("#mod-social-connections .body ."+key+" .connection").empty().html("Disconnect");}$("#mod-social-connections .body .provider-list").removeClass("processing");}}));$("#mod-social-connections .body .provider .icon").live("click",function(){var that=$(this);if(!that.parents(".provider").hasClass("connected")&&!that.parents(".provider-list").hasClass("processing")){var providerToCall=that.parents(".provider").find(".connection").attr("rel");gigya.services.socialize.addConnection({APIKey:iVillage.gigya_api_key,provider:providerToCall,callback:function(response){if(response.errorCode==0){that.parents(".provider").addClass("connected");that.empty().append($("<img />").attr("src","/public/images/icons/social/"+providerToCall+"_20_connected.png"));that.parents(".provider").find(".connection").empty().html("Disconnect");}}});}});$("#mod-social-connections .body .provider .connection").live("click",function(){var that=$(this);if(that.parents(".provider").hasClass("connected")&&!that.hasClass("processing")&&!that.parents(".provider-list").hasClass("processing")){that.addClass("processing").empty().html("Processing...");
var providerToCall=that.attr("rel");gigya.services.socialize.removeConnection({APIKey:iVillage.gigya_api_key,provider:providerToCall,callback:function(response){if(response.errorCode==0){that.parents(".provider").removeClass("connected");that.parents(".provider").find(".icon").empty();that.removeClass("processing").empty().html("Connect");}else{that.removeClass("processing").empty().html("Connect");}}});}else{var providerToCall=that.attr("rel");gigya.services.socialize.addConnection({APIKey:iVillage.gigya_api_key,provider:providerToCall,callback:function(response){if(response.errorCode==0){that.parents(".provider").addClass("connected");that.parents(".provider").find(".icon").empty().append($("<img />").attr("src","/public/images/icons/social/"+providerToCall+"_20_connected.png"));that.empty().html("Disconnect");}}});}});options.addConnectionsUILoaded=true;}else{if($("#"+options.addConnectionsUISmallParams.containerID).length>0){gigya.services.socialize.addEventHandlers(options.gigyaConfig,options.onConnectionEditParams);gigya.services.socialize.showAddConnectionsUI(options.gigyaConfig,options.addConnectionsUISmallParams);options.addConnectionsUILoaded=true;$(".add_connection_edit_btn").css("display","none").removeClass("hide").show().live("click",function(){gigya.services.socialize.showEditConnectionsUI(options.gigyaConfig,{});});}else{options.addConnectionsUILoaded=true;}}options.myConfig=$.extend({callback:function(response){console.log(response);},APIKey:iVillage.gigya_api_key},options.gigyaConfig);gigya.services.socialize.getUserInfo(options.myConfig);}else{if(attemptCount<20){setTimeout(function(){iV_SSO.loadAddConnectionUI(attemptCount+1);},200);}}},loadLoginUIOnPage:function(attempts){if(typeof attempts=="undefined"){attempts=0;}if(typeof(gigya)!="undefined"&&!options.loginUILoaded){options.gigyaConfig=$.extend(options.gigyaConfig,{APIKey:iVillage.gigya_api_key});if(!options.loginParamsPassed){gigya.services.socialize.addEventHandlers(options.gigyaConfig,options.onLoginParams);options.loginParamsPassed=true;}if($("#"+options.globalLayoutLoginUIParams.containerID).length>0){gigya.services.socialize.showLoginUI(options.gigyaConfig,$.extend({},options.basicLoginParams,options.globalLayoutLoginUIParams));options.loginUILoaded=true;$(".gigya-login-pretext").show();}else{if($("#"+options.channelLayoutLoginUIParams.containerID).length>0){gigya.services.socialize.showLoginUI(options.gigyaConfig,$.extend({},options.basicLoginParams,options.channelLayoutLoginUIParams));options.loginUILoaded=true;$(".gigya-login-pretext").show();}else{options.loginUILoaded=true;}}}else{if(attempts<20){setTimeout(function(){iV_SSO.loadLoginUIOnPage(attempts+1);},200);}}},uploadUGC:function(e){origEventType=e.type;origEventTarget=$(e.target);if(!isAuthenticated){e.preventDefault();flowType="login";steps.login();}else{e.preventDefault();flowType="ugc-upload";steps.ugc_upload();}},compareUsername:function(){if(!$.cookie("iv_id")){$(".if-logged-out").show();$(".if-logged-in").remove();}else{$(".if-logged-in").show();$(".if-logged-out").remove();$(".username").each(function(){var HTML=$(this).text(),cookie=$.cookie("iv_id");if(HTML.toLowerCase()!=cookie){$(this).text(cookie+"!");}$(this).show();});}},init:function(custom){var path,xd_receiver_path;if(inited){return;}var ssoBox=$("#sso-cbox-loaded-content");iVillage=window.iVillage||{};if(!ssoBox.length){setTimeout(init,20);}else{$.extend(options,custom);if(options.baseUrl.length-options.baseUrl.lastIndexOf("/")>1){options.baseUrl+="/";}log("init()",options);proxyOrBase=options.proxyUrl||options.baseUrl;uploadSwf=options.baseUrl+"public/flash/uploadify.swf";htmlBase=proxyOrBase+"ajax/sso-html/";if(typeof(iVillage.inside_iframe)=="undefined"){$.getScript(options.gigyaAPIURL+"?apikey="+iVillage.gigya_api_key,function(){log("init() > Loaded Gigya API");$(document).trigger("gigya.ready");});}getPaths={login:htmlBase+"login",forgotPassword:htmlBase+"forgot-password",register:htmlBase+"register",gigyaRegister:htmlBase+"gigya-register",askForPassword:htmlBase+"ask-for-password",askForEmail:htmlBase+"ask-for-email",linkExistingFBUser:htmlBase+"link-existing-fb-user",chime:htmlBase+"chime-in",avatarOrUpload:htmlBase+"avatar-or-upload",allAvatars:htmlBase+"all-avatars",uploadAvatar:htmlBase+"upload-avatar",uploadPhoto:htmlBase+"upload-photo",thanks:htmlBase+"thanks",newsletterList:htmlBase+"newsletter-list",insertOrUploadPhoto:htmlBase+"insert-or-upload-photo",pickPhoto:htmlBase+"pick-photo",uploadUGC:htmlBase+"upload-ugc",socialGetEmail:htmlBase+"social-get-email",addSave:htmlBase+"add-save",deleteSave:htmlBase+"delete-save",insertSave:htmlBase+"insert-save",editSave:htmlBase+"edit-save"};postPaths={login:proxyOrBase+"ajax/user/sign-in",gigyaLogin:proxyOrBase+"ajax/gigya/login",gigyaRegister:proxyOrBase+"ajax/gigya/register",editedConnection:proxyOrBase+"ajax/gigya/extend-profile",userUpdateFBProfile:proxyOrBase+"ajax/gigya/update-profile",logout:proxyOrBase+"ajax/user/sign-out",register:proxyOrBase+"ajax/user/sign-up",forgotPassword:proxyOrBase+"ajax/user/forgot-password",getToken:proxyOrBase+"ajax/user/get-token",establishSession:proxyOrBase+"ajax/user/establish-session",createPhoto:proxyOrBase+"photo/create",createUGCPhoto:proxyOrBase+"photo/create-ugc-photo",deletePhoto:proxyOrBase+"ajax/photo/delete",flipPhoto:proxyOrBase+"ajax/photo/flip",rotatePhoto:proxyOrBase+"ajax/photo/rotate",setAvatar:proxyOrBase+"ajax/photo/set-avatar",cropAvatar:proxyOrBase+"ajax/photo/crop",setChildren:proxyOrBase+"ajax/user/set-children",newslettersByVert:proxyOrBase+"ajax/newsletter/get-by-vertical",newsletterSignUp:proxyOrBase+"ajax/user/set-newsletters",socialEmail:proxyOrBase+"ajax/social/email",addSave:proxyOrBase+"ajax/saves/add",deleteSave:proxyOrBase+"ajax/saves/delete",embedSave:proxyOrBase+"ajax/saves/embed",editSave:proxyOrBase+"ajax/saves/edit",createUGCSlide:proxyOrBase+"ajax/ugc/create_slide"};ssoBox.parents("#sso-cbox").after('<div id="sso-avatar-overlay"><a class="sso-avatar" href="#"></a></div>');avatarOverlay=$("#sso-avatar-overlay");getToken();ssoBox.find("a.sso-step").live("click",handleStep);ssoBox.find("a.sso-new-window").live("click",handleNewWindow);ssoBox.find("a.sso-form-submit").live("click",handleFormSubmitter);ssoBox.find("a.sso-paginate").live("click",handlePaginate);ssoBox.find("a.sso-rotate-left").live("click",rotateCounterClockwise);ssoBox.find("a.sso-rotate-right").live("click",rotateClockwise);ssoBox.find("#sso-pick-photo a").live("click",handlePickPhoto);ssoBox.find("a.sso-finish").live("click",handleFinish);ssoBox.find("a.sso-close").live("click",handleClose);ssoBox.find("#sso-children a.btn-add-another").live("click",cloneBirthdayRow);ssoBox.find("#sso-upload-photo a#sso-upload-another").live("click",handleAddAnotherPhoto);ssoBox.find("form").live("submit",formProcessor);ssoBox.find("li.avatar").live("mouseover mouseout",avatarTelescope);avatarOverlay.hover(function(){avatarOverlay.data("over",true);},function(){if(avatarOverlay.data("over")){avatarOverlayCleanup();}}).mousemove(avatarOverlayCheckPosition);ssoBox.find("a.sso-avatar").live("click",handleChooseAvatar);avatarOverlay.children("a").click(handleChooseAvatar);$(document).bind("sso_cbox_closed",fireOriginalEventOrReload);if($.browser.msie&&parseInt($.browser.version,10)<8){ssoBox.find("input:text, input:password").live("keypress",function(e){var code=e.keyCode?e.keyCode:e.which;if(code===13){form.submit();}});}log("init() > Complete.");iV_SSO.loadLoginUIOnPage();iV_SSO.loadAddConnectionUI();iV_SSO.compareUsername();}}};})(this,jQuery);$(document).bind("gigya.ready",function(e){$("#comments").externalComments(gigya,iVillage);var chatId="gigyaChatPlugin";$("#"+chatId).gigyaChat(gigya,iVillage,chatId);});var app={};$.Deferred=function(){this.callbacks=[];this.fired=false;$.extend(this,{resolve:function(resolveValue){this.resolveValue=resolveValue;this.fired=true;for(x in this.callbacks){this.callbacks[x](resolveValue);}},then:function(fn){if(!this.fired){this.callbacks.push(fn);}else{fn(this.resolveValue);}}});};$.extend($,{genUid:function(){var result="";for(var i=0;i<32;i++){result+=Math.floor(Math.random()*16).toString(16).toUpperCase();}return result;}});(function(d){var cache={};d.publish=function(topic,args){d.each(cache[topic],function(){this.apply(d,args||[]);});};d.subscribe=function(topic,callback){if(!cache[topic]){cache[topic]=[];}cache[topic].push(callback);return[topic,callback];};d.unsubscribe=function(handle){var t=handle[0];cache[t]&&d.each(cache[t],function(idx){if(this==handle[1]){cache[t].splice(idx,1);}});};})(jQuery);(function(){var _after=1;var _afterThrow=2;var _afterFinally=3;var _before=4;var _around=5;var _intro=6;var _regexEnabled=true;var _arguments="arguments";var _undef="undefined";var getType=(function(){var toString=Object.prototype.toString,toStrings={},nodeTypes={1:"element",3:"textnode",9:"document",11:"fragment"},types="Arguments Array Boolean Date Document Element Error Fragment Function NodeList Null Number Object RegExp String TextNode Undefined Window".split(" ");for(var i=types.length;i--;){var type=types[i],constructor=window[type];if(constructor){try{toStrings[toString.call(new constructor)]=type.toLowerCase();}catch(e){}}}return function(item){return item==null&&(item===undefined?_undef:"null")||item.nodeType&&nodeTypes[item.nodeType]||typeof item.length=="number"&&(item.callee&&_arguments||item.alert&&"window"||item.item&&"nodelist")||toStrings[toString.call(item)];};})();var isFunc=function(obj){return getType(obj)=="function";};var weaveOne=function(source,method,advice){var old=source[method];if(advice.type!=_intro&&!isFunc(old)){var oldObject=old;old=function(){var code=arguments.length>0?_arguments+"[0]":"";for(var i=1;i<arguments.length;i++){code+=","+_arguments+"["+i+"]";}return eval("oldObject("+code+");");};}var aspect;if(advice.type==_after||advice.type==_afterThrow||advice.type==_afterFinally){aspect=function(){var returnValue,exceptionThrown=null;try{returnValue=old.apply(this,arguments);}catch(e){exceptionThrown=e;}if(advice.type==_after){if(exceptionThrown==null){returnValue=advice.value.apply(this,[returnValue,method]);}else{throw exceptionThrown;}}else{if(advice.type==_afterThrow&&exceptionThrown!=null){returnValue=advice.value.apply(this,[exceptionThrown,method]);}else{if(advice.type==_afterFinally){returnValue=advice.value.apply(this,[returnValue,exceptionThrown,method]);}}}return returnValue;};}else{if(advice.type==_before){aspect=function(){advice.value.apply(this,[arguments,method]);return old.apply(this,arguments);};}else{if(advice.type==_intro){aspect=function(){return advice.value.apply(this,arguments);};}else{if(advice.type==_around){aspect=function(){var invocation={object:this,args:Array.prototype.slice.call(arguments)};return advice.value.apply(invocation.object,[{arguments:invocation.args,method:method,proceed:function(){return old.apply(invocation.object,invocation.args);}}]);};}}}}aspect.unweave=function(){source[method]=old;pointcut=source=aspect=old=null;};source[method]=aspect;return aspect;};var search=function(source,pointcut,advice){var methods=[];for(var method in source){var item=null;try{item=source[method];}catch(e){}if(item!=null&&method.match(pointcut.method)&&isFunc(item)){methods[methods.length]={source:source,method:method,advice:advice};}}return methods;};var weave=function(pointcut,advice){var source=typeof(pointcut.target.prototype)!=_undef?pointcut.target.prototype:pointcut.target;var advices=[];if(advice.type!=_intro&&typeof(source[pointcut.method])==_undef){var methods=search(pointcut.target,pointcut,advice);if(methods.length==0){methods=search(source,pointcut,advice);}for(var i in methods){advices[advices.length]=weaveOne(methods[i].source,methods[i].method,methods[i].advice);}}else{advices[0]=weaveOne(source,pointcut.method,advice);}return _regexEnabled?advices:advices[0];};jQuery.aop={after:function(pointcut,advice){return weave(pointcut,{type:_after,value:advice});},afterThrow:function(pointcut,advice){return weave(pointcut,{type:_afterThrow,value:advice});},afterFinally:function(pointcut,advice){return weave(pointcut,{type:_afterFinally,value:advice});},before:function(pointcut,advice){return weave(pointcut,{type:_before,value:advice});},around:function(pointcut,advice){return weave(pointcut,{type:_around,value:advice});},introduction:function(pointcut,advice){return weave(pointcut,{type:_intro,value:advice});},setup:function(settings){_regexEnabled=settings.regexMatch;}};})();$.extend($,{declare:function(str_className,objArr_superclasses,obj_props){var arr_path=str_className.split(".");var anchor=window;for(var j=0;j<arr_path.length;j++){if(j+1<arr_path.length){if(anchor[arr_path[j]]==null){anchor[arr_path[j]]={};}else{if(typeof anchor[arr_path[j]]=="object"){}else{console.error("invalid namespace",anchor[arr_path[j]],arr_path[j]);throw"invalid namespace";}}anchor=anchor[arr_path[j]];}else{anchor[arr_path[j]]=function(obj_instanceProps){obj_instanceProps=(obj_instanceProps)?obj_instanceProps:{};this.declaredClass=str_className;this._inheritedClasses=objArr_superclasses;this.constructor=function(args){this.inherited(arguments);};this.inherited=function(args){for(x in this){if(this[x]==args.callee){for(var i=0;i<this._inheritedClasses.length;i++){var inheritedClass=this._inheritedClasses[i];if(inheritedClass!=null&&typeof inheritedClass.prototype[x]=="function"){inheritedClass.prototype[x].apply(this,args);}}}}};for(var inheritedSuperclasses in objArr_superclasses){var superClass=new objArr_superclasses[inheritedSuperclasses]();for(var scpk in superClass){if(scpk=="declaredClass"||scpk=="uid"){continue;}this[scpk]=superClass[scpk];}}window._registry=window._registry||{};this.register=function(){this.uid=this.uid||$.genUid();window._registry[this.uid]=this;};this.get=function(key){return this[key];};this.set=function(key,value){this[key]=value;return this[key];};$.extend(this,obj_props,obj_instanceProps);if(obj_props!=null){if(obj_props.constructor){$.proxy(obj_props.constructor,this)(obj_instanceProps);}else{$.proxy(this.constructor(obj_instanceProps),this);}}else{$.proxy(this.constructor(obj_instanceProps),this);}};for(var b in obj_props){anchor[arr_path[j]].prototype[b]=obj_props[b];}}}},getByUid:function(str_uid){return window._registry[str_uid];}});$.declare("ivillage.ui.Entity",[],{constructor:function(args){this.inherited(arguments);}});$.declare("ivillage.ui.Item",[],{constructor:function(args){this.inherited(arguments);}});$.declare("ivillage.ui.entity.User",[],{constructor:function(args){this.inherited(arguments);}});$.declare("ivillage.ui.entity.GigyaUser",[ivillage.ui.entity.User],{constructor:function(args){this.inherited(arguments);},getUserIdentities:function(){return this.get("user").identities;},get:function(str_key){if(str_key=="name"){return this.user.nickname;}else{if(str_key=="loginProvider"){console.log("user",this.user);return this.user.providers[0];}else{if(str_key=="photoURL"){return this.user.photoURL;}}}return this[str_key];}});$.declare("ivillage.ui.social.ShareEntity",[ivillage.ui.Item],{constructor:function(args){this.inherited(arguments);this.domNode=$("<div/>").addClass("shareEntity").append('<input type="checkbox"/>').children().last().parent().append("<div/>").children().last().addClass(this.get("loginProvider")+" icon").parent().append("<span/>").children().last().addClass("name").html(this.get("name")).parent();this.domNodeClones=[];},bindDomNode:function(domNode_dm){$(domNode_dm).bind("change",$.proxy(function(e){this.onChange(e);},this));},onChange:function(e){var value=e.target.checked;this.changeCheckbox(value);},changeCheckbox:function(boolean_checked){for(var i=0,l=this.domNodeClones.length;i<l;i++){var clone=this.domNodeClones[i];$(clone).find("input:checkbox").attr("checked",boolean_checked);}$(this.domNode).find("input:checkbox").attr("checked",boolean_checked);this.set("checked",boolean_checked);},get:function(key){if(key=="domNode"){var clone=$(this.domNode).clone();this.bindDomNode(clone);this.domNodeClones.push(clone);return clone;}else{if(key=="checked"){return $(this.domNode).find("input:checkbox").attr("checked");}}return this[key];}});$.declare("ivillage.ui.Thread",[],{constructor:function(args){this.inherited(arguments);}});$.declare("ivillage.ui.Comment",[],{constructor:function(args){this.inherited(arguments);this.children=[];this.generateChrome();},generateChrome:function(){this.domNode=$("<div/>").addClass("commentWrap").append("<div/>").children().last().append("<div/>").children().last().addClass("thumbnail").append("<img/>").children().last().addClass("avatar").parent().append("<span/>").children().last().addClass("icon").parent().parent().append("<div/>").children().last().addClass("main").append("<div/>").children().last().addClass("meta").append("<span/>").children().last().addClass("username").parent().append("<span/>").children().last().addClass("datetime").parent().parent().append("<div/>").children().last().addClass("text").append("<div/>").children().last().parent().parent().parent().append("<div/>").children().last().addClass("actions").append("<div/>").children().last().addClass("reply").html("Reply").parent().append("<div/>").children().last().addClass("flag").append("<span/>").children().last().html("Flag as inappropriate").parent().append('<img src="/public/images/icons/flag-inappropriate.png" />').children().last().attr("alt","Flag Inappropriate").parent().parent().parent().parent().append("<div/>").children().last().addClass("authoring").parent().append("<div/>").children().last().addClass("comments children").parent();
},markAsFlaggedError:function(message){this.get("domNode").find(" > div > .actions > .flag ").empty().append("<span>"+message+"</span>");},markAsFlagged:function(){this.get("domNode").find(" > div > .actions > .flag ").empty().append("<span>Flagged</span>");}});$.declare("ivillage.ui.GigyaComment",[ivillage.ui.Comment],{constructor:function(args){this.inherited(arguments);this.register();this.sender=this.sender||{loginProvider:"ivillage",name:"Guest",photoURL:"/public/images/components/comments/default_avatar.gif"};$(this.domNode).find(".username").html(this.get("sender").name||"Guest");$(this.domNode).find(".text").html(this.get("commentText"));var timeSinceReplied=parseInt((new Date()-this.get("timestamp"))/86400000);timeSinceReplied=(timeSinceReplied>=0)?timeSinceReplied:0;var timeUnit="day";if(timeSinceReplied>=1&&timeSinceReplied<30){}else{if(timeSinceReplied>=30&&timeSinceReplied<=360){timeSinceReplied=parseInt(timeSinceReplied/30);timeUnit="month";}else{if(timeSinceReplied>360){timeSinceReplied=parseInt(timeSinceReplied/365);timeUnit="year";}else{if(timeSinceReplied<1){timeSinceReplied=parseInt((new Date()-this.get("timestamp"))/1000);console.log("timeSinceReplied",timeSinceReplied);if(timeSinceReplied<60){timeSinceReplied=timeSinceReplied;timeUnit="second";}else{if(timeSinceReplied<3600){timeSinceReplied=parseInt(timeSinceReplied/60);timeUnit="minute";}else{timeSinceReplied=parseInt(timeSinceReplied/3600);timeUnit="hour";}}}else{timeSinceReplied=timeSinceReplied;timeUnit="day";}}}}if(timeSinceReplied>1){timeUnit=timeUnit+"s";}$(this.domNode).find(".datetime").html(" replied "+timeSinceReplied+" "+timeUnit+" ago");$(this.domNode).find(".avatar").attr("src",this.get("sender").photoURL||"/public/images/components/comments/default_avatar.gif").attr("alt",this.get("sender").name);$(this.domNode).find(".icon").addClass(this.get("sender").loginProvider).attr("alt",this.get("sender").loginProvider);$(this.domNode).find(".icon").append(this.get("sender").loginProvider||"");$(this.domNode).find(".reply").attr("uid",this.get("uid"));$(this.domNode).find(".flag").attr("uid",this.get("uid"));$(this.domNode).find(".flag > *").attr("uid",this.get("uid"));if(this.get("replies")){for(var i=this.get("replies").length-1;i>=0;i--){var childComment=new ivillage.ui.GigyaComment(this.get("replies")[i]);this.addChildComment(childComment);}}},addChildComment:function(GigyaComment_gc){this.get("children").push(GigyaComment_gc);$(this.domNode).find("> .children").prepend(GigyaComment_gc.get("domNode"));},setReply:function(AuthoringWidget_aw){this.get("domNode").find("> .authoring").append(AuthoringWidget_aw.get("domNode"));$.proxy(function(){this.get("domNode").find(".flag").empty().html("Marked as Inappropriate");},this);}});$.declare("ivillage.ui.IvillageComment",[ivillage.ui.Comment],{constructor:function(args){this.inherited(arguments);}});$.declare("ivillage.ui.store.Item",[ivillage.ui.Item],{constructor:function(args){this.inherited(arguments);}});$.declare("ivillage.ui.store.AsyncStore",[],{constructor:function(args){},fetch:function(){},_fetch:function($ajax_data){return $.ajax({url:this.url,global:false,type:"GET",data:$ajax_data});}});$.declare("ivillage.ui.store.JsonAsyncStore",[ivillage.ui.store.AsyncStore],{constructor:function(args){this.inherited(arguments);},_fetch:function($ajax_data){return $.ajax({url:this.url,global:false,type:"GET",dataType:"jsonp",data:$ajax_data});}});$.declare("ivillage.ui.store.GigyaAsyncStore",[ivillage.ui.store.JsonAsyncStore],{constructor:function(args){this.inherited(arguments);this.gigya=this.gigya||gigya;}});$.declare("ivillage.ui.store.GigyaCommentsAsyncStore",[ivillage.ui.store.GigyaAsyncStore],{constructor:function(args){this.inherited(arguments);this.url="http://socialize-api.gigya.com/socialize.getComments";this.gigya=this.gigya||window.gigya;this.guestName=this.guestName||"Guest";},fetch:function(){var conf={};var params={categoryID:this.categoryId,streamId:this.streamId,callback:console.log};gigya.services.comments.getComments(conf,params);this.get("gigya").services.comments.getComments(conf,params);var AsyncStoreDeferred_def=this._fetch(params);return AsyncStoreDeferred_def;},getComments:function(args){var conf={};var params={categoryID:this.categoryId,streamID:this.streamId};$.extend(params,args);this.get("gigya").services.comments.getComments(conf,params);},postComment:function(args){var conf={};var params={categoryID:this.categoryId,streamID:this.streamId};$.extend(params,args);if(!params.enabledProviders){params.guestName=this.guestName;}this.get("gigya").services.comments.postComment(conf,params);if(typeof iVillage.loyalty!="undefined"&&typeof iVillage.loyalty.commentPostCredit!="undefined"){iVillage.loyalty.commentPostCredit(params.enabledProviders);}},flagComment:function(args){var conf={};var params={categoryID:this.categoryId,streamID:this.streamId};$.extend(params,args);this.get("gigya").services.comments.flagComment(conf,params);},save:function(GigyaComment){return"unsupported";var conf={};var params={categoryID:this.categoryId,streamID:this.streamId,commentText:"Hello World!"};gigya.services.comments.postComment(conf,params);}});$.declare("ivillage.ui.Dialog",[],{constructor:function(args){this.inherited(arguments);},show:function(){$(this.get("domNode")).show();},hide:function(){$(this.get("domNode")).hide();}});$.declare("ivillage.ui.widget.comments.ShareDialog",[ivillage.ui.Dialog],{constructor:function(args){this.inherited(arguments);this.generateChrome();this.bindDom();},generateChrome:function(){this.domNode=$("<div/>").addClass("comment-modal-dialog").append("<div/>").children().last().addClass("bg").parent().append("<form/>").children().last().addClass("box").append("<div/>").children().last().append("<h3/>").children().last().html("User Comments").parent().parent().append("<div/>").children().last().addClass("main").append("<div/>").children().last().html("You're about to post this comment to iVillage and the following:").parent().append("<div/>").children().last().addClass("shareEntities").parent().append("<div/>").children().last().addClass("actions").append('<input type="button" />').children().last().attr("value","Cancel").addClass("cancel").parent().append('<input type="button" />').children().last().attr("value","Share").addClass("share").parent().parent().parent().append("<div/>").children().last().addClass("footer").append('<input type="checkbox"/>').children().last().addClass("showAgain").parent().append("<span/>").children().last().html("Don&#39;t show this again.").parent().parent().parent();},bindDom:function(){this.domNode.find(".actions input").bind("click",$.proxy(function(e){e.preventDefault();this.onClick(e);},this));this.domNode.find("form").bind("submit",$.proxy(function(e){e.preventDefault();this.onSubmit(e);},this));},getShowAgain:function(){return $(this.domNode.find("input.showAgain")[0]).attr("checked");},onClick:function(e){},onSubmit:function(e){},addShareEntity:function(ShareEntity_se){this.get("domNode").find(".shareEntities").append("<div/>").children().last().append(ShareEntity_se.get("domNode")).children().last().parent().parent();},clearShareEntities:function(){this.get("domNode").find(".shareEntities").empty();}});$.declare("ivillage.ui.widget.UserState",[],{constructor:function(args){this.inherited(arguments);this.generateChrome();this.sso=iV_SSO||{};this.user=new ivillage.ui.entity.User({loginProvider:"ivillage",name:this.get("sso").getUsername()||$("#iv_user_is_signed_in").html()||"Guest",photoURL:"/public/images/components/comments/default_avatar.gif"});this.set("loggedIn",this.get("sso").isLoggedIn());},generateChrome:function(){this.domNode=$("<div/>").addClass("userState").append("<div/>").children().last().addClass("thumbnail").append("<img/>").children().last().addClass("avatar").parent().append("<div/>").children().last().addClass("icon").parent().parent().append("<div/>").children().last().addClass("main").append("<div/>").children().last().addClass("username").parent().append('<a title="Sign Out of iVillage" name="iv:global:wel:logout" href="/user/logout?forward='+window.document.location.href+'" class="iv_home_link_general iv_home_link_emphisized sso-logout">(logout)</a>').children().last().parent().parent();},update:function(){if(this.get("gigyaUser")){this.user=this.get("gigyaUser");}else{}if(this.isLoggedIn()){this.get("domNode").show();}else{this.get("domNode").hide();}this.get("domNode").find(".username").html(this.user.get("name"));this.get("domNode").find(".avatar").attr("src",this.user.get("photoURL"));console.log("loginProvider",this.user.get("loginProvider"));this.get("domNode").find(".icon").addClass(this.user.get("loginProvider"));},isLoggedIn:function(){return this.get("loggedIn");},getUsername:function(){return this.user.name;},setGigyaUser:function(gu){if(gu.get("name")!=""){this.set("gigyaUser",gu);this.set("user",gu);this.set("loggedIn",true);}else{this.user=new ivillage.ui.entity.User({loginProvider:"ivillage",name:this.get("sso").getUsername()||$("#iv_user_is_signed_in").html()||"Guest",photoURL:"/public/images/components/comments/default_avatar.gif"});this.set("loggedIn",this.get("sso").isLoggedIn());if(!this.get("sso").getUsername()){this.set("loggedIn",false);}else{this.set("loggedIn",true);}}this.update();}});$.declare("ivillage.ui.widget.comments.Viewer",[],{constructor:function(args){this.inherited(arguments);this.threadsPerPage=this.threadsPerPage||10;this.generateChrome();this.bindDom();},generateChrome:function(){this.domNode=$("<div/>").addClass("viewer").append("<div/>").children().last().addClass("comments children").parent().append("<div/>").children().last().addClass("pagination").append("<span/>").children().last().addClass("resultText").append("<span/>").children().last().html("Results ").parent().append("<span/>").children().last().addClass("range").html(" - ").parent().append("<span/>").children().last().html(" out of ").parent().append("<span/>").children().last().addClass("threadCount").html("-").parent().parent().append("<span/>").children().last().addClass("next").html("Next").parent().append("<span/>").children().last().addClass("pages").parent().append("<div/>").children().last().addClass("prev").html("Previous").parent().parent();
this.get("domNode").find(".pagination").hide();},bindDom:function(){$(".reply",$(this.domNode)[0]).live("click",$.proxy(function(e){this.onReply(e);},this));$(".flag",$(this.domNode)[0]).live("click",$.proxy(function(e){this.onFlag(e);},this));$(".pagination .pages .page",$(this.domNode)[0]).live("click",$.proxy(function(e){this.goToPage($(e.target).html());},this));$(".pagination .prev",$(this.domNode)[0]).live("click",$.proxy(function(e){var prevPage=parseInt(this.get("currentPage"))-1;if(prevPage>0){this.goToPage(prevPage);}},this));$(".pagination .next",$(this.domNode)[0]).live("click",$.proxy(function(e){var numThreads=this.get("threadCount");var numPages=numThreads/this.get("threadsPerPage");var nextPage=parseInt(this.get("currentPage"))+1;if(nextPage<=numPages+1){this.goToPage(nextPage);}},this));},onClick:function(e){},onReply:function(e){},onFlag:function(e){},setCommentCount:function(int_val){this.set("commentCount",int_val);if(int_val==0){this.get("domNode").find(".pagination").hide();}else{this.get("domNode").find(".pagination").show();}this.get("domNode").find(".commentCount").html(int_val);},setThreadCount:function(int_val){this.set("threadCount",int_val);this.get("domNode").find(".threadCount").html(int_val);this.setPagination();$(".update-chime-count:first").html(int_val+" chime");},setPagination:function(){var numThreads=this.get("threadCount");var numPages=numThreads/this.get("threadsPerPage");this.get("domNode").find(".pagination .pages").empty();for(var i=0;i<numPages;i++){var page=$("<span/>").addClass("page").html(i+1);this.get("domNode").find(".pagination .pages").append(page);}this.goToPage(1);},goToPage:function(int_pageNum){this.domNode.find(".page").removeClass("selected");this.domNode.find(".page:nth-child("+int_pageNum+")").addClass("selected");this.set("currentPage",int_pageNum);var threads=this.get("domNode").find("> .comments .commentWrap");var pageIndexThread=(int_pageNum-1)*this.get("threadsPerPage");var pageIndexThreadEnd=pageIndexThread+this.get("threadsPerPage");if(this.get("threadCount")<this.get("threadsPerPage")+1){var startIndex=(this.get("threadCount")>0)?1:0;this.get("domNode").find(".pagination .range").empty().html(startIndex+" - "+this.get("threadCount"));this.get("domNode").find(".prev").empty();this.get("domNode").find(".next").empty();}else{if(this.get("threadCount")<pageIndexThreadEnd){this.get("domNode").find(".pagination .range").empty().html((pageIndexThread+1)+" - "+this.get("threadCount"));}else{this.get("domNode").find(".pagination .range").empty().html((pageIndexThread+1)+" - "+pageIndexThreadEnd);}}for(var i=0;i<threads.length;i++){if(i>=pageIndexThread&&i<pageIndexThreadEnd){$(threads[i]).show();}else{$(threads[i]).hide();}}},addComment:function(Comment_c){this.get("domNode").find("> .children").prepend(Comment_c.get("domNode"));},set:function(str_key,value){if(str_key=="count"){this.get("domNode").find("count").html(value);}this[str_key]=value;}});$.declare("ivillage.ui.widget.comments.Authoring",[],{charLimit:800,constructor:function(args){this.inherited(arguments);this.generateChrome();this.bindDom();this.set("charCount",this.charLimit);},generateChrome:function(){this.defaultQuestionText=this.get("defaultQuestionText")||"";this.defaultCommentText=this.get("defaultCommentText")||"";this.domNode=$("<div/>").addClass("btm").append("<div/>").children().last().addClass("comment-question-title subject").html(this.defaultQuestionText).parent().append("<form/>").children().last().addClass("comments-form").append("<fieldset/>").children().last().append("<textarea />").children().last().addClass("user-input label-hide clear-default").html(this.defaultCommentText).parent().append('<input type="button" />').children().last().addClass("submit btn-form-custom").parent().append("<div/>").children().last().addClass("chars-rem").append("<span/>").children().last().addClass("charCount").html("-").parent().append("<span/>").children().last().html(" Characters Remaining").parent().append("<div/>").children().last().parent().parent().parent().append("<div/>").children().last().append("<span/>").children().last().html("").parent().append("<span/>").children().last().addClass("shareEntities").append("<div/>").children().last().html(" ").parent().parent().parent().append("<div/>").children().last().parent().parent();},bindDom:function(){this.get("textarea").bind("click",$.proxy(function(e){this.onTextareaClick(e);},this)).bind("keyup",$.proxy(function(e){this.onKeyup(e);},this)).bind("focus",$.proxy(function(e){this.onFocus(e);},this)).bind("blur",$.proxy(function(e){this.onBlur(e);},this));this.get("form").bind("submit",$.proxy(function(e){e.preventDefault();this.onSubmit(e);},this));this.get("domNode").find("fieldset .submit").bind("click",$.proxy(function(e){e.preventDefault();this.onSubmit(e);},this));this.get("domNode").bind("click",$.proxy(function(e){this.onClick(e);},this));},onClick:function(e){},onTextareaClick:function(e){},onSubmit:function(e){e.preventDefault();},onKeyup:function(e){this.removeExtraChars();this.setCharCount();},removeExtraChars:function(){var textarea=this.get("textarea");if(textarea.val().length>this.charLimit){textarea.val(textarea.val().substr(0,this.charLimit));}},setCharCount:function(){var textarea=this.get("textarea");this.set("charCount",this.charLimit-textarea.val().length);},onFocus:function(e){var textarea=this.get("textarea")[0];if($(textarea).val()==this.defaultCommentText){$(textarea).val("");}else{$(textarea).select();}},onBlur:function(e){var textarea=this.get("textarea");if($(textarea).val()==""){$(textarea).val(this.defaultCommentText);this.set("charCount",this.charLimit);}},getCommentText:function(){return this.domNode.find("textarea").val();},setCommentText:function(str_text){return this.domNode.find("textarea").val(str_text);this.onBlur();},reset:function(){this.setCommentText("");this.setCharCount();},isCommentValid:function(){var commentText=this.getCommentText();if($.trim(commentText).length==0){return false;}if($.trim(commentText)==$.trim(this.get("defaultCommentText"))){return false;}return true;},get:function(key){if(key=="textarea"){return this.domNode.find("textarea");}else{if(key=="submitBtn"){return this.domNode.find("input");}else{if(key=="form"){return this.domNode;}else{if(key=="charCount"){return this.domNode.find(".charCount");}}}}return this[key];},set:function(key,value){if(key=="defaultCommentText"){this.get("textarea").html(value);}else{if(key=="charCount"){this.get("charCount").html(value);}}this[key]=value;},addShareEntity:function(ShareEntity_se){this.get("domNode").find(".shareEntities").append(ShareEntity_se.get("domNode")).children().last().parent();}});$.declare("ivillage.ui.CommentAnalytics",[],{constructor:function(args){this.inherited(arguments);},trackShowGigyaCommentDialog:function(social){this.trackEvent(social+"dialogShowGigyaComment");},trackCancelGigyaCommentShareDialog:function(social){this.trackEvent(social+"cancelShareDialogGigyaComment");},trackGigyaCommentShareAttempted:function(social){this.trackEvent(social+"shareAttemptedGigyaComment");},trackGigyaCommentShareComment:function(social){this.trackEvent(social+"shareComment0GigyaComment");},trackGigyaCommentShareReply1:function(social){this.trackEvent(social+"shareReply1GigyaComment");},trackGigyaCommentShareReply2:function(social){this.trackEvent(social+"shareReply2GigyaComment");},trackEvent:function(title){var trackStr=title;this._trackEvent(trackStr);},_trackEvent:function(nonPrefixed){var trackStr=$.trim(iVillage.ev13_prefix+":"+nonPrefixed);var trackSuccess=iv_doTracking(trackStr,"","s_iv.eVar13");}});$.declare("ivillage.ui._App",[],{constructor:function(args){this.inherited(arguments);}});$.declare("ivillage.ui.app.Comments",[ivillage.ui._App],{constructor:function(args){this.inherited(arguments);this.userStateWidget=this.userStateWidget||new ivillage.ui.widget.UserState();this.analyticsWidget=this.analyticsWidget||new ivillage.ui.CommentAnalytics();var defaultUsername="Anonymous";if(this.userStateWidget.isLoggedIn()){defaultUsername=this.userStateWidget.getUsername()||"Anonymous";}this.gigyaCommentsAS=this.gigyaCommentsAS||new ivillage.ui.store.GigyaCommentsAsyncStore({categoryId:"URI",streamId:document.location.href}),this.gigyaCommentsAS.set("guestName",defaultUsername);this.viewingWidget=this.viewingWidget||new ivillage.ui.widget.comments.Viewer();this.defaultQuestionText=this.defaultQuestionText||"Share your thoughts!";this.defaultCommentText=this.defaultCommentText||"What do you think?";this.authoringWidget=this.authoringWidget||new ivillage.ui.widget.comments.Authoring({defaultQuestionText:this.defaultQuestionText,defaultCommentText:this.defaultCommentText});this.replyWidget=this.replyWidget||new ivillage.ui.widget.comments.Authoring({defaultQuestionText:this.defaultQuestionText,defaultCommentText:this.defaultCommentText});this.get("replyWidget").get("domNode").addClass("authoring");this.lastTouch=this.authoringWidget;this.generateChrome();this.shareDialog=new ivillage.ui.widget.comments.ShareDialog();$("body").append(this.get("shareDialog").get("domNode"));this.get("shareDialog").hide();this.shareEntities=[];this.bindDom();this.bindEvents();this.bindAnalytics();},init:function(){this.get("gigyaCommentsAS").getComments({callback:$.proxy(function(response){this.onCommentsLoaded(response);},this)});this.loadSavedComment();this.initGigyaUserInfo();},onCommentsLoaded:function(response){var commentCount=response.commentCount;var threadCount=response.threadCount;var comments=response.comments;threadCount=0;for(var i=comments.length-1;i>=0;i--){var flagCount=comments[i].flagCount;if(flagCount>=2){continue;}threadCount++;var comment=comments[i];this.addCommentRoot(comment);}this.get("viewingWidget").setCommentCount(commentCount);this.get("viewingWidget").setThreadCount(threadCount);},setViewerPagination:function(){this.get("viewingWidget").setPagination();},bindAnalytics:function(){$.aop.before({target:this,method:"showShareDialog"},$.proxy(function(args){this.get("analyticsWidget").trackShowGigyaCommentDialog(this.getShareTargetsNames());
},this));$.aop.before({target:this,method:"cancelShareDialog"},$.proxy(function(args){this.get("analyticsWidget").trackCancelGigyaCommentShareDialog(this.getShareTargetsNames());},this));$.aop.before({target:this.get("authoringWidget"),method:"onSubmit"},$.proxy(function(args){this.get("analyticsWidget").trackGigyaCommentShareAttempted(this.getShareTargetsNames());},this));$.aop.before({target:this.get("replyWidget"),method:"onSubmit"},$.proxy(function(args){this.get("analyticsWidget").trackGigyaCommentShareAttempted(this.getShareTargetsNames());},this));$.aop.before({target:this,method:"shareComment"},$.proxy(function(args){var twoDepthAuthoring=$(".mod-comments .viewer > .comments > .commentWrap > .comments > .commentWrap .btm.authoring");var oneDepthAuthoring=$(".mod-comments .viewer > .comments > .commentWrap .btm.authoring");if(twoDepthAuthoring.length>0){this.get("analyticsWidget").trackGigyaCommentShareReply2(this.getShareTargetsNames());}else{if(twoDepthAuthoring.length>0){this.get("analyticsWidget").trackGigyaCommentShareReply1(this.getShareTargetsNames());}else{this.get("analyticsWidget").trackGigyaCommentShareComment(this.getShareTargetsNames());}}},this));},initGigyaUserInfo:function(){var shareEntities=[];gigya.services.socialize.getUserInfo({},{callback:$.proxy(function(GigyaUser_gu){console.log("init gigya user info returned!");var gu=new ivillage.ui.entity.GigyaUser(GigyaUser_gu);this.get("userStateWidget").setGigyaUser(gu);var obj_userIdentities=gu.getUserIdentities();for(var identity in obj_userIdentities){var shareEntity=new ivillage.ui.social.ShareEntity({name:identity.charAt(0).toUpperCase()+identity.slice(1),loginProvider:identity});shareEntities.push(shareEntity);}this.setShareEntities(shareEntities);},this)});},generateChrome:function(){var commentAuthoring=this.authoringWidget.get("domNode");var commentViewer=this.viewingWidget.get("domNode");var userState=this.userStateWidget.get("domNode");this.domNode=$("<div/>").addClass("comments").append("<div/>").children().last().addClass("pngfix sec-title").parent().append(userState).children().last().addClass("user-state").parent().append("<div/>").children().last().addClass("user-comment").append(commentAuthoring).children().last().addClass("authoring").parent().parent().append(commentViewer).children().last().parent().append("<div/>").children().last().parent();},bindDom:function(){},_bindAuthoringWidget:function(AuthoringWidget_aw){$.aop.before({target:AuthoringWidget_aw,method:"onSubmit"},$.proxy(function(result){this.saveComment();var aw=this.get("lastTouch");var commentValid=aw.isCommentValid();if(!commentValid){alert($.trim("Please enter a comment!"));return;}$(".sso-sign-in").trigger("click");if($(".sso-sign-in").length==0){if($.cookie("showDialogAgain")=="false"||this.shareEntities.length==0){this.shareComment();}else{this.showShareDialog();}}return result;},this));$.aop.before({target:AuthoringWidget_aw,method:"onClick"},$.proxy(function(result){var e=result[0];var aw=$(e.target).parents(".authoring")[0];if(aw==this.get("authoringWidget").get("domNode")[0]){this.set("replyTarget",null);this.set("lastTouch",this.get("authoringWidget"));}else{if(aw==this.get("replyWidget").get("domNode")[0]){this.set("lastTouch",this.get("replyWidget"));}}return result;},this));},bindEvents:function(){this._bindAuthoringWidget(this.authoringWidget);this._bindAuthoringWidget(this.replyWidget);$.aop.before({target:this.viewingWidget,method:"onReply"},$.proxy(function(args){var e=args[0];var uid=$(e.target).attr("uid");var commentWidget=$.getByUid(uid);this.set("replyTarget",commentWidget);commentWidget.setReply(this.replyWidget);return args;},this));$.aop.before({target:this.viewingWidget,method:"onFlag"},$.proxy(function(args){var e=args[0];var uid=$(e.target).attr("uid");var commentWidget=$.getByUid(uid);this.flagComment(commentWidget);return args;},this));$.aop.before({target:this.shareDialog,method:"onClick"},$.proxy(function(args){var e=args[0];if($(e.target).hasClass("share")){this.shareComment();}else{this.cancelShareDialog();}this.hideShareDialog();return args;},this));},cancelShareDialog:function(){},shareComment:function(){var showAgain=this.get("shareDialog").getShowAgain();$.cookie("showDialogAgain",!showAgain);var aw=this.get("lastTouch");var commentText=aw.getCommentText();var commentValid=aw.isCommentValid();if(!commentValid){return;}if(this.get("replyWidget")==aw){aw.get("domNode").detach();}var arr_shareTargets=this.getShareTargets();var str_shareTargets="";for(var i=0;i<arr_shareTargets.length;i++){var target=arr_shareTargets[i];if(i!=0){str_shareTargets=str_shareTargets+",";}str_shareTargets=str_shareTargets+target.get("loginProvider");}var act=new gigya.services.socialize.UserAction();act.setTitle($("title").html());act.setUserMessage(commentText);act.setDescription($("meta[name=description]").attr("content"));act.setLinkBack(document.location.href);var image_src=$("link[rel=image_src]").attr("href");var image={type:"image",src:image_src||"http://www.ivillage.com/public/images/logos/logo-ivillage-50x50.png",href:"http://www.ivillage.com/"};act.addMediaItem(image);if(this.get("replyTarget")){var callback=$.proxy(function(resp){var newGigyaComment=new ivillage.ui.GigyaComment(resp.comment);this.get("replyTarget").addChildComment(newGigyaComment);$.cookie("savedComment",null);},this);var parentId=this.get("replyTarget").get("ID");this.get("gigyaCommentsAS").postComment({commentText:commentText,enabledProviders:str_shareTargets,callback:callback,userAction:act,parentID:parentId});}else{var callback=$.proxy(function(resp){this.addCommentRoot(resp.comment);$.cookie("savedComment",null);},this);this.get("gigyaCommentsAS").postComment({commentText:commentText,enabledProviders:str_shareTargets,userAction:act,callback:callback});}this.get("lastTouch").reset();this.clearSavedComment();},flagComment:function(Comment_c){this.get("gigyaCommentsAS").flagComment({commentID:Comment_c.get("ID"),callback:function(response){console.log("flag",response);if(response.errorMessage=="Permission denied"){Comment_c.markAsFlaggedError("Error flagging");}else{Comment_c.markAsFlagged();}}});},showShareDialog:function(){this.get("shareDialog").show();},hideShareDialog:function(){this.get("shareDialog").hide();},clearSavedComment:function(){$.cookie("savedComment-text",null,{expires:-1});$.cookie("savedComment-location",null,{expires:-1});},saveComment:function(){$.cookie("savedComment-text",this.get("lastTouch").getCommentText());$.cookie("savedComment-location",document.location.pathname);},loadSavedComment:function(){var savedCommentText=$.cookie("savedComment-text");var savedCommentLocation=$.cookie("savedComment-location");if(savedCommentText&&(savedCommentLocation==document.location.pathname)){this.get("authoringWidget").setCommentText(savedCommentText);}},addShareEntity:function(ShareEntity_se){this.get("shareEntities").push(ShareEntity_se);this.get("shareDialog").addShareEntity(ShareEntity_se);this.get("authoringWidget").addShareEntity(ShareEntity_se);this.get("replyWidget").addShareEntity(ShareEntity_se);},setShareEntities:function(ShareEntity_Array_shareEntities){this.get("domNode").find("shareEntities").empty().html("Share to:");for(var i=0,l=ShareEntity_Array_shareEntities.length;i<l;i++){this.addShareEntity(ShareEntity_Array_shareEntities[i]);}},addCommentRoot:function(jsonComment_c){var c=new ivillage.ui.GigyaComment(jsonComment_c);this.get("viewingWidget").addComment(c);},getShareTargets:function(){var shareEntities=this.get("shareEntities");var ShareEntity_arr_targets=[];for(var i=0,l=this.shareEntities.length;i<l;i++){var se=this.shareEntities[i];if(typeof se.get("checked")=="undefined"||se.get("checked")==false){}else{ShareEntity_arr_targets.push(se);}}return ShareEntity_arr_targets;},getShareTargetsNames:function(){var shareEntities=this.get("shareEntities");var str_arr_names=[];for(var i=0,l=this.shareEntities.length;i<l;i++){var se=this.shareEntities[i];str_arr_names.push(se.get("name"));}return str_arr_names;}});$.declare("ivillage.ui.service.external.echo.EchoService",[ivillage.ui.store.JsonAsyncStore],{constructor:function(args){this.set("apiLoaded",new $.Deferred());if(typeof window.Echo==="undefined"){console.log("loading echo api");this.loadApi();}else{this.set("Echo",window.Echo);this.get("apiLoaded").resolve();}},loadApi:function(){var jqueryPackDef=new $.Deferred();$.getScript("http://cdn.echoenabled.com/clientapps/v2/jquery-pack.js",$.proxy(function(){jqueryPackDef.resolve();this.attemptApiLoadedResolve();},this));this.set("jqueryPackLoadDef",jqueryPackDef);var streamDef=new $.Deferred();$.getScript("http://cdn.echoenabled.com/clientapps/v2/stream.js",$.proxy(function(){streamDef.resolve();this.attemptApiLoadedResolve();},this));this.set("streamLoadDef",streamDef);},attemptApiLoadedResolve:function(){var streamLoadDef=this.get("streamLoadDef");var jqueryPackDef=this.get("jqueryPackLoadDef");jqueryPackDef.then($.proxy(function(){streamLoadDef.then($.proxy(function(){this.set("Echo",window.Echo);this.get("apiLoaded").resolve();},this));},this));},fetch:function(params){return this._fetch(params);},fetchItems:function(params){var itemsDef=new $.Deferred();this.get("apiLoaded").then($.proxy(function(){var query=params.query;this.fetch(params);itemsDef.resolve();},this));return itemsDef;}});$.declare("ivillage.ui.widget.comments.plugin.Echo",[ivillage.ui._App],{constructor:function(args){this.bindToCommentsWidget();this.set("echoService",new ivillage.ui.service.external.echo.EchoService());},bindToCommentsWidget:function(){var commentsWidget=this.get("commentsWidget");$.aop.after({target:commentsWidget,method:"onCommentsLoaded"},$.proxy(function(result){console.log("RESULT OF ON COMMENTS LOADED",result);this.attachEchoComments();return result;},this));},attachEchoComments:function(){console.log("attaching comments",this);this.loadEchoComments.then($.proxy(function(response){var items=response.items;for(var i=0;i<items.length;i++){var item=items[0];
this.attachComment(item);}},this));this.sortComments();this.setPagination();},attachComment:function(){this.get("commentsWidget").addCommentRoot();},sortComments:function(){},setPagination:function(){this.get("commentsWidget").setViewerPagination();},loadEchoComments:function(){var echoItemsDef=this.get("echoService").fetchItems();return echoItemsDef;}});$.fn.gigyaChat=function(gigya,iVillage,id){var params={categoryID:42187363,width:600,height:670,containerID:id,cid:""};gigya.socialize.showChatUI(params);};$.fn.externalComments=function(gigya,iVillage){if($("#comments").length==0){return;}var defaultQuestionText=$("#comments .comment-question-title").html()||"";var defaultCommentText=$("#comments textarea.user-input").html()||"";if($("#comments").width()<500){$("#comments").addClass("mini");}$(".update-chime-count:first").empty();$("#comments").empty();var categoryID="TestNodeID";var streamID="testStreamFoo";if(document.location.host=="www.ivillage.com"){categoryID="NodeID";}var urlNodeInfo=document.location.pathname.split("/")[2];var urlNodeId;if(!urlNodeInfo){urlNodeId=null;}else{urlNodeId=urlNodeInfo.split("-")[2];urlNodeId=parseInt(urlNodeId);}var nodeId;if(typeof urlNodeId==="number"&&urlNodeId%1==0){nodeId=urlNodeId;}else{nodeId=$(".canvas").attr("data-nid");}console.log("!!! comments stream nodeId",nodeId);streamID=nodeId;app=new ivillage.ui.app.Comments({store:{gigya:{}},categoryId:"URI",streamId:document.location.href,gigya:gigya,ivDefaults:iVillage.defaults,defaultQuestionText:defaultQuestionText,defaultCommentText:defaultCommentText,gigyaCommentsAS:new ivillage.ui.store.GigyaCommentsAsyncStore({categoryId:categoryID,streamId:streamID})});var echoEnabled=false;if(echoEnabled){console.log("ECHO ENABLED");new ivillage.ui.widget.comments.plugin.Echo({commentsWidget:app});}app.init();$(app.get("domNode")).appendTo(this);};var iV_SocialLife=(function(window,$){var options={gigya_api_key:"2_TAACrzG-_a9IkzLfWB3YsVoaBvKoZSfmy-eAfFSA0_XZPEk1Lpd5dWthUDHdRtu-",shareLink:"",shareValue:"",socialSharebarParams:{containerID:"socialShareTools",shortURLs:"never",shareButtons:[{provider:"facebook"},{provider:"pinterest"},{provider:"twitter-tweet",via:"iVillage",related:"iVillage"},{provider:"google-plusone"},{provider:"email"}],context:"iVillageShare",showSuccessMessage:true,operationMode:"multiSelect",onSendDone:function(eventObj){iVillage.loyalty.socialShareCredit(eventObj.providers);}},sweepsShareParams:{containerID:"sweepsShareTools",shortURLs:"never",enabledProviders:"facebook,twitter",showSuccessMessage:true,showEmailButton:true,showMoreButton:false,width:500,cid:"iVillage",onSendDone:function(eventObj){iVillage.loyalty.socialShareCredit(eventObj.providers);}},shareBarLoadingAttempts:0,shareBarMaxAttempts:20,shareBarLoaded:false,shareUILoadingAttempts:0,shareUILoaded:false,followBarLoadingAttempts:0,followBarLoaded:false,genericSharePopup:{enabledProviders:"facebook,twitter,google",shortURLs:"never",showEmailButton:true,showMoreButton:false,showSuccessMessage:true,cid:"iVillage",onSendDone:function(eventObj){iVillage.loyalty.socialShareCredit(eventObj.providers);}},showFollowBarUI:{containerID:"follow-ivillage-via-gigya",iconSize:32,buttons:[{provider:"facebook",actionURL:"http://www.facebook.com/iVillage",action:"dialog"},{provider:"twitter",action:"dialog",followUsers:"ivillage, ivillagehealth"}]},shareLinkLoaded:false,proMoSharebarParams:{containerClass:"promo-gigya-share-bar",shortURLs:"never",shareButtons:"Facebook,Twitter,Pinterest",context:"iVillageShare",showSuccessMessage:true,operationMode:"multiSelect",showCounts:"none",iconsOnly:true,onSendDone:function(eventObj){iVillage.loyalty.socialShareCredit(eventObj.providers);}}};function formatShareEmail(title,description,share_link){var shareEmail="$userMsg$<br><br>Check out this link from iVillage: ";if(typeof(share_link)=="undefined"||!share_link){share_link=window.location.href;}share_link=addUserEmailURL(share_link);shareEmail+=share_link+"<br>";if(typeof(title)=="undefined"||!title){title=document.title;}shareEmail+="<br><b>"+title+"</b>";if(typeof(description)!="undefined"){shareEmail+="<br>"+description;}shareEmail+="<br>";return shareEmail;}function getUserEmailEncodedURL(callback){if(typeof(iVillage.arw_person_id)!="undefined"){if(typeof iv_pageid!="undefined"){callUserEncodedEmail(iv_pageid,callback);}}else{callback();}}function callUserEncodedEmail(pageId,callback){$.ajax({type:"post",url:"/ajax/sharelink/get",data:"page_id="+pageId,success:function(data){options.shareValue=data;options.shareLinkLoaded=true;log("Sharelink Data is ",data);log("initiating the gigya plugin now");callback();},error:function(xhr,ajaxOptions,thrownError){options.shareValue=pageId;options.shareLinkLoaded=true;log("initiating the gigya plugin now");callback();}});}function addUserEmailURL(shareLink){shareLink=removeURLParam(shareLink,"sh");if(options.shareLinkLoaded){shareLink=prepareShareLink(shareLink);}return shareLink;}function prepareShareLink(shareLink){referrerLinkBack=shareLink.split("?").length>1?"&":"?";referrerLinkBack=referrerLinkBack+"sh="+options.shareValue;shareLink=shareLink+referrerLinkBack;return shareLink;}function removeURLParam(url,param){var urlparts=url.split("?");if(urlparts.length>=2){var prefix=encodeURIComponent(param)+"=";var pars=urlparts[1].split(/[&;]/g);for(var i=pars.length;i-->0;){if(pars[i].indexOf(prefix,0)==0){pars.splice(i,1);}}if(pars.length>0){return urlparts[0]+"?"+pars.join("&");}else{return urlparts[0];}}else{return url;}}function prepareUserAction(userAction,socialProvider){if(typeof(gigya)=="undefined"){return false;}var userAct={};if(typeof userAction!="undefined"&&userAction!=null){userAct.title=(typeof userAction.title!="undefined"&&userAction.title)?userAction.title:document.title;userAct.description=(typeof userAction.description!="undefined"&&userAction.description)?userAction.description:"";userAct.actionCopy=(typeof userAction.actionCopy!="undefined"&&userAction.actionCopy)?userAction.actionCopy:"Read More";userAct.actionLink=(typeof userAction.actionLink!="undefined"&&userAction.actionLink)?userAction.actionLink:window.location.href;userAct.linkBack=(typeof userAction.linkBack!="undefined"&&userAction.linkBack)?userAction.linkBack:userAct.actionLink;userAct.userMessage=(typeof userAction.userMessage!="undefined"&&userAction.userMessage)?userAction.userMessage:"";userAct.imageURL=(typeof userAction.imageURL!="undefined"&&userAction.imageURL)?userAction.imageURL:false;}else{userAct.title=document.title;userAct.description="";userAct.actionCopy="Read More";userAct.actionLink=window.location.href;userAct.linkBack=window.location.href;userAct.userMessage="";userAct.imageURL=false;}userAct.actionLink=addUserEmailURL(userAct.actionLink);userAct.linkBack=addUserEmailURL(userAct.linkBack);log("Final link for sharing is: ",userAct.actionLink);var shareAction=new gigya.services.socialize.UserAction();if(typeof socialProvider!="undefined"&&socialProvider=="pinterest"){shareAction.setDescription(userAct.title);}else{shareAction.setDescription(userAct.description);}shareAction.setTitle(userAct.title);shareAction.setLinkBack(userAct.linkBack);shareAction.addActionLink(userAct.actionCopy,userAct.actionLink);shareAction.setUserMessage(userAct.userMessage);var shareImage={src:"http://www.ivillage.com/public/images/logos/logo_large.jpg"};shareImage.src=$("meta[name=thumb]").attr("content")||"";function modifyShareImage(imgs,sic){var largestArea=0;for(var i=0;i<imgs.length;i++){var img=$(imgs[i]);var w=img.width();var h=img.height();var a=w*h;if(largestArea<a){largestArea=a;sic.src=img.attr("src");}}}var slideshowImgs=$("#slideshow img");var cmImgs=$(".content-main img");var cmmiwImgs=$(".content-main .main-img-wrap img");var mainImg=$("#main-img");var secondTypeOfSlideshowActiveImage=$("#slideshow").find(".nohide");modifyShareImage(slideshowImgs,shareImage);modifyShareImage(cmImgs,shareImage);modifyShareImage(cmmiwImgs,shareImage);modifyShareImage(mainImg,shareImage);modifyShareImage(secondTypeOfSlideshowActiveImage,shareImage);if(userAct.imageURL||shareImage.src){shareAction.addMediaItem({type:"image",src:userAct.imageURL||shareImage.src,href:userAct.linkBack||document.location.href});}return shareAction;}function log(str,vars){if(typeof iVillage!="undefined"&&typeof iVillage.showLogs!="undefined"&&iVillage.showLogs){if(window.console&&window.console.log){var date=new Date();var hours=date.getHours().toString();var mins=date.getMinutes().toString();var secs=date.getSeconds().toString();var msecs=date.getMilliseconds().toString();hours=(hours.length===1)?"0"+hours:hours;mins=(mins.length===1)?"0"+mins:mins;secs=(secs.length===1)?"0"+secs:secs;msecs+=(msecs.length===1)?"    ":(msecs.length===2)?" ":"";str=hours+":"+mins+":"+secs+":"+msecs+" > Gigya > "+str;if(vars){console.log(str,vars);}else{console.log(str);}}}}return{loadSocialShareBar:function(){if(typeof(gigya)!="undefined"&&!options.shareBarLoaded&&options.shareBarLoadingAttempts<options.shareBarMaxAttempts){if(typeof(social_share_params_gigya)!="undefined"&&false){$.extend(options.socialSharebarParams,social_share_params_gigya);}console.log("target sharebar",options.socialSharebarParams.containerID);if($("#"+options.socialSharebarParams.containerID).length>0){var shareAction="";var shareEmail="";var twitterShareAction="";if(typeof(social_share_user_action)!="undefined"){shareAction=prepareUserAction(social_share_user_action);twitterShareAction=prepareUserAction(social_share_user_action,"twitter");shareEmail=formatShareEmail(social_share_user_action.title,social_share_user_action.description,social_share_user_action.actionLink);}else{shareAction=prepareUserAction();twitterShareAction=prepareUserAction(null,"twitter");shareEmail=formatShareEmail(document.title,"",window.location.href);}var finalShareParams=$.extend({userAction:shareAction,emailBody:shareEmail,twitterUserAction:twitterShareAction},options.socialSharebarParams);log("finalShareParams",finalShareParams);gigya.services.socialize.showShareBarUI({APIKey:options.gigya_api_key},finalShareParams);options.shareBarLoaded=true;}else{options.shareBarLoaded=true;}}else{options.shareBarLoadingAttempts++;setTimeout(iV_SocialLife.loadSocialShareBar,20);}},updateSocialShareBar:function(client_side_data){if(typeof(gigya)!="undefined"&&typeof(client_side_data)!="undefined"&&options.shareBarLoaded){if($("#"+options.socialSharebarParams.containerID).length>0){if(typeof(social_share_user_action)!="undefined"){client_side_data.title=(typeof client_side_data.title!="undefined")?client_side_data.title:social_share_user_action.title;client_side_data.description=(typeof client_side_data.description!="undefined")?client_side_data.description:social_share_user_action.description;}var shareAction=prepareUserAction(client_side_data);var twitterShareAction=prepareUserAction(client_side_data,"twitter");var shareEmail=formatShareEmail(client_side_data.title,client_side_data.description,client_side_data.actionLink);var finalShareParams=$.extend({userAction:shareAction,emailBody:shareEmail,twitterUserAction:twitterShareAction},options.socialSharebarParams);log("finalShareParams",finalShareParams);$("#"+options.socialSharebarParams.containerID).html("");gigya.services.socialize.showShareBarUI({APIKey:options.gigya_api_key},finalShareParams);}}else{var ussb=arguments.callee;setTimeout(function(){ussb(client_side_data);},1000);}},loadSweepsSharePlugin:function(callback){if(typeof(gigya)!="undefined"&&!options.shareUILoaded&&options.shareUILoadingAttempts<options.shareBarMaxAttempts){if($("#"+options.sweepsShareParams.containerID)!="undefined"){var userAction={};userAction.actionLink=window.location.protocol+"//"+window.location.hostname+window.location.pathname;if(typeof(social_share_user_action)!="undefined"){userAction.description=(typeof social_share_user_action.description!="undefined")?social_share_user_action.description:"";
userAction.imageURL=(typeof social_share_user_action.imageURL!="undefined")?social_share_user_action.imageURL:false;}var shareAction=prepareUserAction(userAction);var twitterShareAction=prepareUserAction(userAction,"twitter");var shareEmail=formatShareEmail(document.title,"",userAction.actionLink);if(typeof(callback)!="undefined"&&callback){$.extend(options.sweepsShareParams,{onLoad:callback});}gigya.services.socialize.showShareUI({APIKey:iVillage.gigya_api_key},$.extend({userAction:shareAction,emailBody:shareEmail,twitterUserAction:twitterShareAction},options.sweepsShareParams));}}else{options.shareUILoadingAttempts++;var recallFunction=function(){iV_SocialLife.loadSweepsSharePlugin(callback);};setTimeout(recallFunction,20);}},loadGenericSharePopup:function(social_share_user_action_param){if(typeof(gigya)!="undefined"){var shareAction="";var shareLink=window.location.protocol+"//"+window.location.hostname+window.location.pathname;var shareEmail="";var socialShareUserAction="";var twitterShareAction="";if(typeof(social_share_user_action_param)!="undefined"){socialShareUserAction=social_share_user_action_param;}else{if(typeof(social_share_user_action)!="undefined"){socialShareUserAction=social_share_user_action;}}if(socialShareUserAction!=""){shareAction=prepareUserAction(socialShareUserAction);twitterShareAction=prepareUserAction(socialShareUserAction,"twitter");shareEmail=formatShareEmail(socialShareUserAction.title,socialShareUserAction.description,socialShareUserAction.actionLink);}else{shareAction=prepareUserAction();twitterShareAction=prepareUserAction(null,"twitter");shareEmail=formatShareEmail(document.title,"",window.location.href);}gigya.services.socialize.showShareUI({APIKey:iVillage.gigya_api_key},$.extend({userAction:shareAction,emailBody:shareEmail,twitterUserAction:twitterShareAction},options.genericSharePopup));}},loadSharebarInPopup:function(configs,dataToShare){if(typeof(gigya)!="undefined"){var shareAction=prepareUserAction(dataToShare),twitterShareAction=prepareUserAction(dataToShare,"twitter"),shareEmail=formatShareEmail(dataToShare.title,dataToShare.description,dataToShare.actionLink);var finalShareParams=$.extend({userAction:shareAction,emailBody:shareEmail,twitterUserAction:twitterShareAction},configs);if($("#"+configs.containerID).length>0){$("#"+configs.containerID).html("");gigya.services.socialize.showShareBarUI({APIKey:options.gigya_api_key},finalShareParams);}}},loadFollowUsBar:function(){if(typeof(gigya)!="undefined"&&!options.followBarLoaded&&options.followBarLoadingAttempts<50){options.followBarLoaded=true;gigya.services.socialize.showFollowBarUI($.extend(options.showFollowBarUI,{onLoad:function(){var followUsTracking=(typeof follow_tracking_prefix!="undefined")?follow_tracking_prefix:"iv:global:follow us";var pinterestButton='<a name="'+followUsTracking+':pinterest" class="follow-us-on-ivillage" onclick="window.open(\'http://pinterest.com/ivillage\', \'\', \'width=600,height=400,resizable=1,scrollbars=1\');" href="#"><img src="http://www.ivillage.com/public/images/icons/pinterest.png" width="32" height="32" alt="Follow Me on Pinterest" style="margin-right: 3px;" /></a>',tumblerButton='<a name="'+followUsTracking+':tumbler" class="follow-us-on-ivillage" onclick="window.open(\'http://www.ivillage.tumblr.com\', \'\', \'width=600,height=400,resizable=1,scrollbars=1\');" href="#"><img src="http://www.ivillage.com/public/images/icons/t-icon.png" width="32" height="32" alt="Share on Tumblr" style="margin-right: 3px;" /></a>',youtubeButton='<a name="'+followUsTracking+':youtube" class="follow-us-on-ivillage" onclick="window.open(\'http://www.youtube.com/user/ivillage\', \'\', \'width=600,height=400,resizable=1,scrollbars=1\');" href="#"><img src="http://www.ivillage.com/public/images/icons/youtube-icon.png" alt="Subscribe to me on YouTube"/></a><img src="http://s.ytimg.com/yt/img/creators_corner/YouTube/youtube_32x32.png" style="display: none;"/>',followBarDiv=$("#follow-ivillage-via-gigya");followBarDiv.find("a").each(function(){var icon_id=$(this).attr("id");if(typeof $(this).attr("id")!="undefined"&&$(this).attr("id").indexOf("facebook")!=-1){$(this).attr("name",followUsTracking+":facebook");}else{if(typeof $(this).attr("id")!="undefined"&&$(this).attr("id").indexOf("twitter")!=-1){$(this).attr("name",followUsTracking+":twitter");}}});if(typeof(followBarDiv)!="undefined"){followBarDiv.append(pinterestButton,tumblerButton,youtubeButton);}}}));}else{options.followBarLoadingAttempts++;var recallFunction=function(){iV_SocialLife.loadFollowUsBar();};setTimeout(recallFunction,1000);}},loadProMoShareBar:function(loadingAttempts){if(typeof(gigya)!="undefined"){$(".promo-gigya-share-bar").each(function(){var that=$(this);var containerID=that.children("div").attr("id");var userAct={};if(typeof promoActions!="undefined"&&typeof promoActions[containerID]!="undefined"){log("container is:",containerID);log("data is: ",promoActions[containerID]);userAct.title=promoActions[containerID].title;userAct.description=promoActions[containerID].description;userAct.actionCopy="Read More";userAct.actionLink=window.location.href;userAct.linkBack=window.location.href;userAct.userMessage="";userAct.imageURL=promoActions[containerID].imageURL;}else{userAct.title=document.title;userAct.description="";userAct.actionCopy="Read More";userAct.actionLink=window.location.href;userAct.linkBack=window.location.href;userAct.userMessage="";userAct.imageURL=false;}var shareAction=prepareUserAction(userAct);var twitterShareAction=prepareUserAction(userAct,"twitter");var pinterestShareAction=prepareUserAction(userAct,"pinterest");var shareEmail=formatShareEmail(userAct.title,"",window.location.href);var finalShareParams=$.extend({userAction:shareAction,emailBody:shareEmail,twitterUserAction:twitterShareAction},options.proMoSharebarParams,{containerID:containerID});if(containerID=="promo-msg-share-bar"){finalShareParams=$.extend(finalShareParams,{shareButtons:[{provider:"facebook",iconImgUp:"/public/images/icons/social/promo-fb-icon.png"},{provider:"twitter",iconImgUp:"/public/images/icons/social/promo-twitter-icon.png"},{provider:"pinterest",iconImgUp:"/public/images/icons/social/promo-pinterest-icon.png",userAction:pinterestShareAction}]});}else{finalShareParams=$.extend(finalShareParams,{shareButtons:[{provider:"facebook"},{provider:"twitter"},{provider:"pinterest",userAction:pinterestShareAction}]});}log("loadProMoShareBar: Final Params - ",finalShareParams);gigya.services.socialize.showShareBarUI({APIKey:options.gigya_api_key},finalShareParams);});}else{if(loadingAttempts<50){log("loadProMoShareBar Attempt: ",loadingAttempts);loadingAttempts++;setTimeout(function(){iV_SocialLife.loadProMoShareBar(loadingAttempts);},500);}}},loadPackageShareBar:function(loadingAttempts){if(typeof(gigya)!="undefined"){$(".edit-package-gigya-share-bar").each(function(){var that=$(this);var containerID=that.children("div").attr("id");var userAct={};if(typeof promoActions!="undefined"&&typeof promoActions[containerID]!="undefined"){log("container is:",containerID);log("data is: ",promoActions[containerID]);userAct.title=promoActions[containerID].title;userAct.description=promoActions[containerID].description;userAct.actionCopy="Read More";userAct.actionLink=window.location.href;userAct.linkBack=window.location.href;userAct.userMessage="";userAct.imageURL=promoActions[containerID].imageURL;}else{userAct.title=document.title;userAct.description="";userAct.actionCopy="Read More";userAct.actionLink=window.location.href;userAct.linkBack=window.location.href;userAct.userMessage="";userAct.imageURL=false;}var shareAction=prepareUserAction(userAct);var twitterShareAction=prepareUserAction(userAct,"twitter");var shareEmail=formatShareEmail(userAct.title,"",window.location.href);var finalShareParams=$.extend({userAction:shareAction,emailBody:shareEmail,twitterUserAction:twitterShareAction},options.proMoSharebarParams,{containerID:containerID});log("loadPackageShareBar: Final Params - ",finalShareParams);gigya.services.socialize.showShareBarUI({APIKey:options.gigya_api_key},finalShareParams);});}else{if(loadingAttempts<50){log("loadPackageShareBar Attempt: ",loadingAttempts);loadingAttempts++;setTimeout(function(){iV_SocialLife.loadPackageShareBar(loadingAttempts);},500);}}},init:function(custom){$.extend(options,custom);getUserEmailEncodedURL(function(){iV_SocialLife.loadSocialShareBar();});iV_SocialLife.loadFollowUsBar();if($("."+options.proMoSharebarParams.containerClass).length>0){iV_SocialLife.loadProMoShareBar(1);}if($(".edit-package-gigya-share-bar").length>0){iV_SocialLife.loadPackageShareBar(1);}}};})(this,jQuery);var _vrq=_vrq||[];_vrq.push(["id",39]);_vrq.push(["automate",true]);_vrq.push(["track",function(){}]);(function(d,a){var s=d.createElement(a),x=d.getElementsByTagName(a)[0];s.async=true;s.src="http://a.visualrevenue.com/vrs.js";x.parentNode.insertBefore(s,x);})(document,"script");(function($){$(document).ready(function(){var body=$("body");body.addClass("has-js");if($.browser.msie){body.addClass("msie");var version=parseInt($.browser.version,10);if(version<7){body.addClass("ie6");}else{if(version===7){body.addClass("ie7");}else{if(version<9){body.addClass("ie8");}}}}});})(jQuery);var s_account="nbcuivsites,nbcuglobal";var url=String(window.location);if(url.match("pressly.com")){s_account="nbcuivtabletdev";}else{if(url.match("tablet.ivillage.com")){s_account="nbcuivtabletprod";}}if(typeof iv_mobify_mobilesite!=="undefined"&&iv_mobify_mobilesite==1){s_account="nbcuivillagemobile";}if(navigator.userAgent.match("Opera Mini")){s_account="nbcuivillagemobile";}news_code_isLoaded=true;var s_iv=s_gi(s_account,1);s_iv.charSet="ISO-8859-1";s_iv.currencyCode="USD";s_iv.trackDownloadLinks=true;s_iv.trackExternalLinks=true;s_iv.trackInlineStats=true;s_iv.linkDownloadFileTypes="exe,zip,wav,mp3,mov,mpg,avi,wmv,doc,pdf,xls";s_iv.linkInternalFilters="javascript:,ivillage.com,204.12.94.41,greenisuniversal,ivillage.co.uk,astrology.com,dietanotherday.co.uk,momtourage.com,gardenweb.com,neversaydiet.com,webstakes.com,kalimocho.co.uk,healthylivingonline.com,healthvideo.com,healthology.com,petside.co.uk,travelskoot.com,ivillagecoupons.com,thepatientchannel.com,newborn.com,gardenbazaar.com,voices.gardenweb.com,babynamer.com,ca.astrology.shine.yahoo.net,pressly.com";s_iv.linkLeaveQueryString=false;s_iv.linkTrackVars="eVar13,prop66,prop67,prop68";s_iv.linkTrackEvents="None";s_iv._channelParameter="SKY|sky>Paid Syndication|psyd>Newsletter|nlcid,enid>Social Media|sm>Partners|PAR>DST|DST";s_iv._channelDomain="Newsletter|tk.ivillage.com>Mobile|m.ivillage.com>Social Media|facebook.com,twitter.com,t.co,hootsuite.com,tweetdeck.com,tumblr.com,pinterest.com>Referrers|stumbleupon.com>Paid Syndication|paid.outbrain.com,taboolasyndication.com";s_iv.usePlugins=true;function s_iv_doPlugins(s_iv){var url=String(window.location);var urlhost=String(window.location.host);if(url.match("ivillage.com")&&!url.match("tablet.ivillage.com")&&!url.match("pressly.com")&&!(typeof iv_mobify_mobilesite!=="undefined"&&iv_mobify_mobilesite==1)){s_iv.sa(s_account+",nbcuivprod");}if(url.match("greenisuniversal")){s_iv.sa(s_account+",nbcuivprod");}if(url.match("ivillage.co.uk")){s_iv.sa(s_account+",nbcuivuk");}if(url.match("momtourage")){s_iv.sa(s_account+",nbcuivmomtorage");}if(url.match("astrology")&&!url.match("xfinity.astrology.com")){s_iv.sa(s_account+",nbcuivastrology");}if(url.match("gardenweb")){s_iv.sa(s_account+",nbcuivgardenweb");}if(url.match("nature.net")){s_iv.sa(s_account+",nbcuivgardenweb");}if(url.match("neversaydiet")){s_iv.sa(s_account+",nbcuivneversaydiet");}if(url.match("webstakes")){s_iv.sa(s_account+",nbcuivwebstakes");}if(url.match("dietanotherday")){s_iv.sa(s_account+",nbcuivukdietanotherday");}if(url.match("kalimocho")){s_iv.sa(s_account+",nbcuivkalimocho");}if(url.match("healthylivingonline")){s_iv.sa(s_account+",nbcuivprod");}if(url.match("healthvideo")){s_iv.sa(s_account+",nbcuivhealthvideo");}if(url.match("healthology")){s_iv.sa(s_account+",nbcuivhealthology");}if(url.match("petside.co.uk")){s_iv.sa(s_account+",nbcuivpetsideuk");}if(url.match("travelskoot")){s_iv.sa(s_account+",nbcuivtravelskoot");}if(url.match("ivillagecoupons")){s_iv.sa(s_account+",nbcuivcoupon");}if(url.match("thepatientchannel")){s_iv.sa(s_account+",nbcuivpatientchannel");}if(url.match("newborn")){s_iv.sa(s_account+",nbcuivnewborn");}if(url.match("dinnertool")){s_iv.sa(s_account+",nbcuivdinnertool");}if(url.match("yourtotalhealth.com")){s_iv.sa(s_account+",nbcuivprod");}if(url.match("babynamer.com")){s_iv.sa(s_account+",nbcuivprod");}if(url.match("ca.astrology.shine.yahoo.net")){s_iv.sa("nbcuivastrologyyahooshine");}if(url.match("partnerpages/yahoo")){s_iv.sa("nbcuivastrologyyahoo");}if(urlhost.match("horoscopes.ivillage.ca")){s_iv.sa("nbcuivastrologyca");}if(urlhost.match("telemundo")){s_iv.sa("nbcuastrologytelemundo");}if(urlhost.match("xfinity.astrology.com")){s_iv.sa("nbcuastrologyx");}s_iv.server=window.location.host.toLowerCase();s_iv.campaign=s_iv.getQueryParam("cid,__source",":");s_iv.campaign=s_iv.getValOnce(s_iv.campaign,"s_v0",0);var ev23=s_iv.getQueryParam("par");window.optimizely=window.optimizely||[];window.optimizely.push(["sc_svar",s_iv]);window.optimizely.push("sc_activate");if(!s_iv.prop67){s_iv.prop67="D=pev1";if(s_iv.linkName){s_iv.prop67="D=pev2";}}s_iv.channelManager("cid,SKY,DST,VTY,PAR,_source,nlcid,sm,psyd,enid",":","s_iv_cm","","1","1");s_iv.eVar24=s_iv._campaignID;if(typeof s_iv._campaignID!=="undefined"&&s_iv._campaignID.match("http://")&&s_iv._campaignID.match("ivillage.com")){s_iv.eVar24=s_iv._campaignID.match(/:\/\/(.[^/]+)/)[1];}if(s_iv.eVar24=="n/a"){s_iv.eVar24="";}if(s_iv._channel=="Natural Search"){var searchDomain=s_iv._referringDomain.split(".");s_iv.eVar24="organic:";for(i=1;i<searchDomain.length;i++){s_iv.eVar24=s_iv.eVar24+searchDomain[i];if(i<searchDomain.length-1){s_iv.eVar24=s_iv.eVar24+".";}}}else{if(s_iv._channel=="Paid Syndication"||s_iv._channel=="Social Media"){s_iv.eVar24=s_iv._referringDomain;}}s_iv.eVar25=s_iv._keywords;if(s_iv.eVar25=="n/a"){s_iv.eVar25="";}s_iv.eVar26=s_iv._channel;switch(s_iv.eVar26){case"Typed/Bookmarked":s_iv.eVar26="Direct to Site";s_iv.eVar27=s_iv.crossVisitParticipation(s_iv.eVar26,"s_iv_ev27","7","5",">","",1);break;case"Other Natural Referrers":s_iv.eVar26="Referrers";s_iv.eVar27=s_iv.crossVisitParticipation(s_iv.eVar26,"s_iv_ev27","7","5",">","",1);break;default:s_iv.eVar27=s_iv.crossVisitParticipation(s_iv.eVar26,"s_iv_ev27","7","5",">","",1);}if(s_iv.eVar24){s_iv.events=s_iv.apl(s_iv.events,"event11",",",2);s_iv.ClickThroughCheck1="1";}if(!s_iv.eVar24){s_iv.ClickThroughCheck1="2";}s_iv.ClickThroughCheck2=s_iv.getPreviousValue(s_iv.ClickThroughCheck1,"ctc2","");if(!s_iv.eVar24&&s_iv.ClickThroughCheck2=="1"){s_iv.events=s_iv.apl(s_iv.events,"event12",",",2);}s_iv.prop65=s_iv.eVar26;if(window.location.href.toLowerCase().indexOf("astrology.com")>=0){if(s_iv.prop6==null||s_iv.prop6==""){s_iv.prop6=unescape(unescape(window.location.href)).split("?")[0].replace(/\d+/g,"");}}else{if(s_iv.prop6!=null||s_iv.prop6!=""){s_iv.prop6=unescape(unescape(window.location.href));}}if(s_iv.prop6.match(";")){var iv_c6=s_iv.prop6.split(";");s_iv.prop6=iv_c6[0];}if(s_iv.prop7){s_iv.prop7=s_iv.prop7.toLowerCase();s_iv.eVar6="D=c7";var t_search=s_iv.getValOnce(s_iv.eVar6,"s_v6",0);if(t_search){s_iv.events=s_iv.apl(s_iv.events,"event5",",",2);}}s_iv.prop13=s_iv.getNewRepeat();s_iv.prop14='D=c3+":"+ch';s_iv.prop16=s_iv.timeParting("-5");s_iv.prop21=s_iv.getQueryParam("nlcid");if(s_iv.prop20){s_iv.prop22=s_iv.channel+" | "+s_iv.prop20;}if(typeof(s_iv.prop30)=="undefined"||s_iv.prop30==""){someVar=document.getElementsByTagName("h1");for(var i=0;i<someVar.length;i++){if(someVar[i].className=="mbTitle"){s_iv.prop30=someVar[i].innerHTML;break;}}if(typeof(s_iv.prop30)=="undefined"||s_iv.prop30==""){s_iv.prop30=document.title;}}s_iv.eVar5=s_iv.getQueryParam("vty");s_iv.eVar5=s_iv.getValOnce(s_iv.eVar5,"s_v5",0);if(s_iv.eVar13==null||s_iv.eVar13==""){s_iv.eVar13=s_iv.getQueryParam("ice");}if(s_iv.prop21){s_iv.eVar14="D=c21";}s_iv.eVar15=s_iv.getQueryParam("ftr");if(s_iv.eVar15){s_iv.events=s_iv.apl(s_iv.events,"event10",",",2);}if(s_iv.prop16){s_iv.eVar16="D=c16";}s_iv.eVar18=s_iv.getQueryParam("sky");s_iv.eVar18=s_iv.getValOnce(s_iv.eVar18,"s_v18",0);if(s_iv.pageName){s_iv.eVar19="D=pageName";}s_iv.eVar20=s_iv.getQueryParam("dst");s_iv.eVar20=s_iv.getValOnce(s_iv.eVar20,"s_v20",0);if(s_iv.channel){s_iv.eVar22="D=ch";}s_iv.eVar23=ev23;s_iv.eVar23=s_iv.getValOnce(s_iv.eVar23,"s_v23",0);s_iv.eVar65=s_iv.getVisitNum("m","s_iv_vmonthnum","s_iv_monthinvisit");if(typeof(is_iv_slideshow)=="undefined"){is_iv_slideshow=false;}if(typeof(iv_slideshow_moved)=="undefined"){iv_slideshow_moved=false;}if(is_iv_slideshow&&iv_slideshow_moved){s_iv.eVar14="";s_iv.eVar24="";s_iv.eVar26="";}if(s_iv.prop27){s_iv.eVar27="D=c27";}if(s_iv.prop3){s_iv.eVar28="D=c3";}if(s_iv.prop14){s_iv.eVar29='D=c3+":"+ch';}s_iv.eVar33=s_iv.getQueryParam("sky");s_iv.eVar34=s_iv.getQueryParam("intcmp").toLowerCase();if(s_iv.prop39){s_iv.eVar39="D=c39";}if(s_iv.prop40){s_iv.eVar40="D=c40";}if(s_iv.prop41){s_iv.eVar41="D=c41";}if(s_iv.prop6){s_iv.eVar43="D=c6";}s_iv.eVar51=s_iv.getAndPersistValue(s_iv.eVar24,"temp_e_24",30);if(s_iv.prop20!=null||s_iv.prop20!=""){s_iv.eVar52=s_iv.prop20;}if(s_iv.prop30!=null||s_iv.prop30!=""){s_iv.eVar53=s_iv.prop30;}s_iv.events=s_iv.apl(s_iv.events,"event6",",",2);if((!document.referrer||document.referrer=="")&&s_iv.events.match("event32")){s_iv.events="event34,event6";}if(s_iv.events.match("event30")||s_iv.events.match("event31")||s_iv.events.match("event32")||s_iv.events.match("event33")||s_iv.events.match("event34")||s_iv.events.match("event35")){s_iv.products=s_iv.getAndPersistValue(s_iv.products,"s_prod",300);}s_iv.hier1=set_h3();}s_iv.doPlugins=s_iv_doPlugins;s_iv.getVisitNum=new Function("tp","c","c2","var s=this,e=new Date,cval,cvisit,ct=e.getTime(),d;if(!tp){tp='m';}if(tp=='m'||tp=='w'||tp=='d'){eo=s.endof(tp),y=eo.getTime();e.setTime(y);}else {d=tp*86400000;e.setTime(ct+d);}if(!c){c='s_vnum';}if(!c2){c2='s_invisit';}cval=s.c_r(c);if(cval){var i=cval.indexOf('&vn='),str=cval.substring(i+4,cval.length),k;}cvisit=s.c_r(c2);if(cvisit){if(str){e.setTime(ct+1800000);s.c_w(c2,'true',e);return str;}else {return 'unknown visit number';}}else {if(str){str++;k=cval.substring(0,i);e.setTime(k);s.c_w(c,k+'&vn='+str,e);e.setTime(ct+1800000);s.c_w(c2,'true',e);return str;}else {s.c_w(c,e.getTime()+'&vn=1',e);e.setTime(ct+1800000);s.c_w(c2,'true',e);return 1;}}");s_iv.dimo=new Function("m","y","var d=new Date(y,m+1,0);return d.getDate();");s_iv.endof=new Function("x","var t=new Date;t.setHours(0);t.setMinutes(0);t.setSeconds(0);if(x=='m'){d=s_iv.dimo(t.getMonth(),t.getFullYear())-t.getDate()+1;}else if(x=='w'){d=7-t.getDay();}else {d=1;}t.setDate(t.getDate()+d);return t;");if(!s_iv.__ccucr){s_iv.c_rr=s_iv.c_r;s_iv.__ccucr=true;s_iv.c_r=new Function("k","var s=this,d=new Date,v=s_iv.c_rr(k),c=s_iv.c_rr('s_pers'),i,m,e;if(v)return v;k=s_iv.ape(k);i=c.indexOf(' '+k+'=');c=i<0?s_iv.c_rr('s_sess'):c;i=c.indexOf(' '+k+'=');m=i<0?i:c.indexOf('|',i);e=i<0?i:c.indexOf(';',i);m=m>0?m:e;v=i<0?'':s_iv.epa(c.substring(i+2+k.length,m<0?c.length:m));if(m>0&&m!=e)if(parseInt(c.substring(m+1,e<0?c.length:e))<d.getTime()){d.setTime(d.getTime()-60000);s_iv.c_w(s_iv.epa(k),'',d);v='';}return v;");
}if(!s_iv.__ccucw){s_iv.c_wr=s_iv.c_w;s_iv.__ccucw=true;s_iv.c_w=new Function("k","v","e","this.new2 = true;var s=this,d=new Date,ht=0,pn='s_pers',sn='s_sess',pc=0,sc=0,pv,sv,c,i,t;d.setTime(d.getTime()-60000);if(s_iv.c_rr(k)) s_iv.c_wr(k,'',d);k=s_iv.ape(k);pv=s_iv.c_rr(pn);i=pv.indexOf(' '+k+'=');if(i>-1){pv=pv.substring(0,i)+pv.substring(pv.indexOf(';',i)+1);pc=1;}sv=s_iv.c_rr(sn);i=sv.indexOf(' '+k+'=');if(i>-1){sv=sv.substring(0,i)+sv.substring(sv.indexOf(';',i)+1);sc=1;}d=new Date;if(e){if(e.getTime()>d.getTime()){pv+=' '+k+'='+s_iv.ape(v)+'|'+e.getTime()+';';pc=1;}}else{sv+=' '+k+'='+s_iv.ape(v)+';';sc=1;}if(sc) s.c_wr(sn,sv,0);if(pc){t=pv;while(t&&t.indexOf(';')!=-1){var t1=parseInt(t.substring(t.indexOf('|')+1,t.indexOf(';')));t=t.substring(t.indexOf(';')+1);ht=ht<t1?t1:ht;}d.setTime(ht);s_iv.c_wr(pn,pv,d);}return v==s_iv.c_r(s_iv.epa(k));");}s_iv.getNewRepeat=new Function("var s=this,e=new Date(),cval,ct=e.getTime(),y=e.getYear();e.setTime(ct+30*24*60*60*1000);cval=s_iv.c_r('s_nr');if(cval.length==0){s_iv.c_w('s_nr',ct,e);return 'New';}if(cval.length!=0&&ct-cval<30*60*1000){s_iv.c_w('s_nr',ct,e);return 'New';}if(cval<1123916400001){e.setTime(cval+30*24*60*60*1000);s_iv.c_w('s_nr',ct,e);return 'Repeat';}else return 'Repeat';");s_iv.allTrafficSources=new Function("a","b","c","d","e","f","g","h","i","j","var s=this,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,T;A=s_iv.referrer?s_iv.referrer:document.referrer;j=j?j:'Typed/Bookmarked';if(!A)B=j;C=A.indexOf('?')>-1?A.indexOf('?'):A.length;D=A.substring(0,C);F=s_iv.split(s_iv.linkInternalFilters,',');E=F.length-1;for(G=0;G<=E;G++){H=D.indexOf(F[G])==-1?'':A;if(H)I=H}J=A.indexOf('//')>-1?A.indexOf('//')+2:0;if(!I&&!B){f=f?f:'Paid Search';g=g?g:'Natural Search';h=h?h:'Paid Non-Search';i=i?i:'Referrers';J=A.indexOf('//')>-1?A.indexOf('//')+2:0;K=A.indexOf('/',J)>-1?A.indexOf('/',J):C;L=A.substring(J,K);M=L;B=N=i;C='.google.|q>.yahoo.|p>.msn.|q>.live.|q>.ask.|q>.aol.|query>.myway.|searchfor>.netscape.|query>.altavista.|q>.lycos.|query>.bing.|q';C=c?C+'>'+c:C;D=s_iv.split(C,'>');E=D.length-1;for(G=0;G<=E;G++){F=D[G];F=s_iv.split(F,'|');O=L.indexOf(F[0]);if(O>-1){P=s_iv.getQueryParam(F[1],'',A);if(P)Q=P}}}R=s_iv.getQueryParam(a);if(R){M=R;if(Q){B=N=f}else{B=N=h}}if(!R&&Q){M=b+L;B=N=g}if(Q)Q=Q.toLowerCase();if(M){M=M.toLowerCase();M=s_iv.repl(M,'www.','')}T=Q+M;if(d){C=s_iv.split(d,'>');D=C.length;for(G=0;G<=D;G++){if(C[G]){E=s_iv.split(C[G],'|');F=s_iv.getQueryParam(E[1]);if(F)B=N=E[0]}}}if(e){C=s_iv.split(e,'>');D=C.length;for(G=0;G<=D;G++){if(C[G]){E=s_iv.split(C[G],'|');F=R.indexOf(E[1]);if(F==0)B=N=E[0]}}}if(T){s_iv.atsCampaign=T?M:'';s_iv.atsKeywords=T?Q:'';s_iv.atsChannel=T?N:''}B=s.getValOnce(B,'cs',0);s_iv.atsChannelStack=B;");s_iv.getPreviousValue=new Function("v","c","el","var s=this,t=new Date,i,j,r='';t.setTime(t.getTime()+1800000);if(el){if(s_iv.events){i=s_iv.split(el,',');j=s_iv.split(s_iv.events,',');for(x in i){for(y in j){if(i[x]==j[y]){if(s_iv.c_r(c)) r=s_iv.c_r(c);v?s_iv.c_w(c,v,t):s_iv.c_w(c,'no value',t);return r}}}}}else{if(s_iv.c_r(c)) r=s_iv.c_r(c);v?s_iv.c_w(c,v,t):s_iv.c_w(c,'no value',t);return r}");s_iv.clickThruQuality=new Function("scp","tcth_ev","cp_ev","cff_ev","cf_th","if(i<=1){var ev=(s_iv.events?s_iv.events+',':'');if(scp){s_iv.events=ev+tcth_ev;if(s_iv.c_r('cf')){var tct=parseInt(s_iv.c_r('cf'))+1;s_iv.c_w('cf',tct,0);if(tct==cf_th&&cff_ev){s_iv.events=s_iv.events+','+cff_ev;};}else{s_iv.c_w('cf',1,0);}}else{if(s_iv.c_r('cf')>=1){s_iv.c_w('cf',0,0);s_iv.events=ev+cp_ev;}}i++;}");s_iv.timeParting=new Function("z","var s=this,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;d = new Date();a=d.getFullYear();if(a=='2009'){b='08';c='01'}if(a=='2010'){b='14';c='07'}if(a=='2011'){b='13';c='06'}if(a=='2012'){b='11';c='04'}if(a=='2013'){b='10';c='03'}if(a=='2014'){b='09';c='02'}if(!b||!c){b='08';c='01'}b='03/'+b+'/'+a;c='11/'+c+'/'+a;e=new Date('1/1/2000');if(e.getDay()!=6||e.getMonth()!=0){return'Data Not Available'}else{z=parseFloat(z);f=new Date(b);g=new Date(c);fl=g;h=new Date();if(h>f&&h<fl){z=z+1}else{z=z};i=h.getTime()+(h.getTimezoneOffset()*60000);tz=new Date(i + (3600000*z));j=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];k=tz.getHours();l=tz.getMinutes();m=tz.getDay();n=j[m];o='AM';p='00';if(l>30){p='30'}if(k>=12){o='PM';k=k-12};if (k==0){k=12};q=k+':'+p+o;r=n+' : '+q;r=r.toLowerCase();return r;};");s_iv.getQueryParam=new Function("p","d","u","var s=this,v='',i,t;d=d?d:'';u=u?u:(s_iv.pageURL?s_iv.pageURL:s_iv.wd.location);if(u=='f')u=s_iv.gtfs().location;while(p){i=p.indexOf(',');i=i<0?p.length:i;t=s_iv.p_gpv(p.substring(0,i),u+'');if(t){t=t.indexOf('#')>-1?t.substring(0,t.indexOf('#')):t;}if(t)v+=v?d+t:t;p=p.substring(i==p.length?i:i+1)}return v");s_iv.p_gpv=new Function("k","u","var s=this,v='',i=u.indexOf('?'),q;if(k&&i>-1){q=u.substring(i+1);v=s_iv.pt(q,'&','p_gvf',k)}return v");s_iv.p_gvf=new Function("t","k","if(t){var s=this,i=t.indexOf('='),p=i<0?t:t.substring(0,i),v=i<0?'True':t.substring(i+1);if(p.toLowerCase()==k.toLowerCase())return s_iv.epa(v)}return ''");s_iv.getValOnce=new Function("v","c","e","var s=this,k=s_iv.c_r(c),a=new Date;e=e?e:0;if(v){a.setTime(a.getTime()+e*86400000);s_iv.c_w(c,v,e?a:0);}return v==k?'':v");s_iv.ia=new Function("ar","v","for(var i=0;i<ar.length;i++){if(ar[i]==v)return i}return -1");s_iv.repl=new Function("x","o","n","var i=x.indexOf(o),l=n.length;while(x&&i>=0){x=x.substring(0,i)+n+x.substring(i+o.length);i=x.indexOf(o,i+l)}return x");s_iv.split=new Function("l","d","var i,x=0,a=new Array;while(l){i=l.indexOf(d);i=i>-1?i:l.length;a[x++]=l.substring(0,i);l=l.substring(i+d.length);}return a");s_iv.apl=new Function("L","v","d","u","var s=this,m=0;if(!L)L='';if(u){var i,n,a=s_iv.split(L,d);for(i=0;i<a.length;i++){n=a[i];m=m||(u==1?(n==v):(n.toLowerCase()==v.toLowerCase()));}}if(!m)L=L?L+d+v:v;return L");s_iv.join=new Function("v","p","var s = this;var f,b,d,w;if(p){f=p.front?p.front:'';b=p.back?p.back:'';d=p.delim?p.delim:'';w=p.wrap?p.wrap:'';}var str='';for(var x=0;x<v.length;x++){if(typeof(v[x])=='object' )str+=s_iv.join( v[x],p);else str+=w+v[x]+w;if(x<v.length-1)str+=d;}return f+str+b;");s_iv.getAndPersistValue=new Function("v","c","e","var s=this,a=new Date;e=e?e:0;a.setTime(a.getTime()+e*86400000);if(v)s.c_w(c,v,e?a:0);return s.c_r(c);");var gigya_omniture_conf={linkName:"Gigya Action",eventMap:[{gigEvent:"login",omtrEvents:["event60"],mapVars:["eVar61=user.loginProvider","eVar60=getAge()","eVar60=getGender()","eVar62=getiRank()"]},{gigEvent:"sendDone",omtrEvents:["event61"],mapVars:["eVar61=providers","products"]},{gigEvent:"commentSubmitted",omtrEvents:["event62"],mapVars:["eVar61=providerPostIDs","products"]},{gigEvent:"reactionClicked",omtrEvents:["event63"],mapVars:["eVar63=reaction.ID","products"]}],getAge:function(evt){var a=evt.user.age;if(typeof(a)=="number"&&a>0){return a;}return"?";},getGender:function(evt){var g=evt.user.gender;if(typeof(g)=="string"&&g.length>0){return g;}return"?";},getiRank:function(evt){if(typeof(evt.user.iRank)=="string"){var r=parseFloat(evt.user.iRank).toFixed(0);if(r>=0.0001){return r;}}return"?";}};function set_h3(){h3=new String(document.location.host+document.location.pathname);if(h3.charAt(h3.length-1)=="/"){var temp=new String();for(var i=0;i<h3.length-1;i++){temp+=h3.charAt(i);}h3=temp;}var intIndexOfMatch=h3.indexOf("/");while(intIndexOfMatch!=-1){h3=h3.replace("/","|");intIndexOfMatch=h3.indexOf("/");}return h3;}s_iv.channelManager=new Function("a","b","c","d","e","f","var s=this,A,B,g,l,m,p,q,P,h,k,u,S,i,O,T,j,r,t,D,E,F,G,H,N,U,v=0,X,Y,W,n=new Date;n.setTime(n.getTime()+1800000);if(e){v=1;if(s.c_r(e))v=0;if(!s.c_w(e,1,n))s.c_w(e,1,0);if(!s.c_r(e))v=0;}g=s.referrer?s.referrer:document.referrer;g=g.toLowerCase();if(!g)h=1;i=g.indexOf('?')>-1?g.indexOf('?'):g.length;j=g.substring(0,i);k=s.linkInternalFilters.toLowerCase();k=s.split(k,',');for(m=0;m<k.length;m++){B=j.indexOf(k[m])==-1?'':g;if(B)O=B;}if(!O&&!h){p=g;U=g.indexOf('//');q=U>-1?U+2:0;Y=g.indexOf('/',q);r=Y>-1?Y:i;u=t=g.substring(q,r).toLowerCase();P='Other Natural Referrers';S=s.seList+'>'+s._extraSearchEngines;if(d==1){j=s.repl(j,'oogle','%');j=s.repl(j,'ahoo','^');g=s.repl(g,'as_q','*');}A=s.split(S,'>');for(i=0;i<A.length;i++){D=A[i];D=s.split(D,'|');E=s.split(D[0],',');for(G=0;G<E.length;G++){H=j.indexOf(E[G]);if(H>-1){if(D[2])N=u=D[2];else N=t;if(d==1){N=s.repl(N,'#',' - ');g=s.repl(g,'*','as_q');N=s.repl(N,'^','ahoo');N=s.repl(N,'%','oogle');}i=s.split(D[1],',');for(k=0;k<i.length;k++){l=s.getQueryParam(i[k],'',g).toLowerCase();if(l)break;}}}}}if(!O||f!='1'){O=s.getQueryParam(a,b);if(O){u=O;if(N)P='Paid Search';else P='Unknown Paid Channel';}if(!O&&N){u=N;P='Natural Search';}}if(h==1&&!O&&v==1)u=P=t=p='Typed/Bookmarked';g=s._channelDomain;if(g){k=s.split(g,'>');for(m=0;m<k.length;m++){q=s.split(k[m],'|');r=s.split(q[1],',');S=r.length;for(T=0;T<S;T++){Y=r[T].toLowerCase();i=j.indexOf(Y);if(i>-1)P=q[0];}}}g=s._channelParameter;if(g){k=s.split(g,'>');for(m=0;m<k.length;m++){q=s.split(k[m],'|');r=s.split(q[1],',');S=r.length;for(T=0;T<S;T++){U=s.getQueryParam(r[T]);if(U)P=q[0];}}}g=s._channelPattern;if(g){k=s.split(g,'>');for(m=0;m<k.length;m++){q=s.split(k[m],'|');r=s.split(q[1],',');S=r.length;for(T=0;T<S;T++){Y=r[T].toLowerCase();i=O.toLowerCase();H=i.indexOf(Y);if(H==0)P=q[0];}}}X=P+l+t;c=c?c:'c_m';if(c!='0')X=s.getValOnce(X,c,0);if(X){s._referrer=p?p:'n/a';s._referringDomain=t?t:'n/a';s._partner=N?N:'n/a';s._campaignID=O?O:'n/a';s._campaign=u?u:'n/a';s._keywords=l?l:N?'Keyword Unavailable':'n/a';s._channel=P?P:'n/a';}");s_iv.seList="altavista.co|q,r|AltaVista>aol.co.uk,search.aol.co.uk|query|AOL - United Kingdom>search.aol.com,search.aol.ca|query,q|AOL.com Search>ask.com,ask.co.uk|ask,q|Ask Jeeves>www.baidu.com|wd|Baidu>daum.net,search.daum.net|q|Daum>google.co,googlesyndication.com|q,as_q|Google>google.com.ar|q,as_q|Google - Argentina>google.com.au|q,as_q|Google - Australia>google.at|q,as_q|Google - Austria>google.com.bh|q,as_q|Google - Bahrain>google.com.bd|q,as_q|Google - Bangladesh>google.be|q,as_q|Google - Belgium>google.com.bo|q,as_q|Google - Bolivia>google.ba|q,as_q|Google - Bosnia-Hercegovina>google.com.br|q,as_q|Google - Brasil>google.bg|q,as_q|Google - Bulgaria>google.ca|q,as_q|Google - Canada>google.cl|q,as_q|Google - Chile>google.cn|q,as_q|Google - China>google.com.co|q,as_q|Google - Colombia>google.co.cr|q,as_q|Google - Costa Rica>google.hr|q,as_q|Google - Croatia>google.cz|q,as_q|Google - Czech Republic>google.dk|q,as_q|Google - Denmark>google.com.do|q,as_q|Google - Dominican Republic>google.com.ec|q,as_q|Google - Ecuador>google.com.eg|q,as_q|Google - Egypt>google.com.sv|q,as_q|Google - El Salvador>google.ee|q,as_q|Google - Estonia>google.fi|q,as_q|Google - Finland>google.fr|q,as_q|Google - France>google.de|q,as_q|Google - Germany>google.gr|q,as_q|Google - Greece>google.com.gt|q,as_q|Google - Guatemala>google.hn|q,as_q|Google - Honduras>google.com.hk|q,as_q|Google - Hong Kong>google.hu|q,as_q|Google - Hungary>google.co.in|q,as_q|Google - India>google.co.id|q,as_q|Google - Indonesia>google.ie|q,as_q|Google - Ireland>google.is|q,as_q|Google - Island>google.co.il|q,as_q|Google - Israel>google.it|q,as_q|Google - Italy>google.com.jm|q,as_q|Google - Jamaica>google.co.jp|q,as_q|Google - Japan>google.jo|q,as_q|Google - Jordan>google.co.ke|q,as_q|Google - Kenya>google.co.kr|q,as_q|Google - Korea>google.lv|q,as_q|Google - Latvia>google.lt|q,as_q|Google - Lithuania>google.com.my|q,as_q|Google - Malaysia>google.com.mt|q,as_q|Google - Malta>google.mu|q,as_q|Google - Mauritius>google.com.mx|q,as_q|Google - Mexico>google.co.ma|q,as_q|Google - Morocco>google.nl|q,as_q|Google - Netherlands>google.co.nz|q,as_q|Google - New Zealand>google.com.ni|q,as_q|Google - Nicaragua>google.com.ng|q,as_q|Google - Nigeria>google.no|q,as_q|Google - Norway>google.com.pk|q,as_q|Google - Pakistan>google.com.py|q,as_q|Google - Paraguay>google.com.pe|q,as_q|Google - Peru>google.com.ph|q,as_q|Google - Philippines>google.pl|q,as_q|Google - Poland>google.pt|q,as_q|Google - Portugal>google.com.pr|q,as_q|Google - Puerto Rico>google.com.qa|q,as_q|Google - Qatar>google.ro|q,as_q|Google - Romania>google.ru|q,as_q|Google - Russia>google.st|q,as_q|Google - Sao Tome and Principe>google.com.sa|q,as_q|Google - Saudi Arabia>google.com.sg|q,as_q|Google - Singapore>google.sk|q,as_q|Google - Slovakia>google.si|q,as_q|Google - Slovenia>google.co.za|q,as_q|Google - South Africa>google.es|q,as_q|Google - Spain>google.lk|q,as_q|Google - Sri Lanka>google.se|q,as_q|Google - Sweden>google.ch|q,as_q|Google - Switzerland>google.com.tw|q,as_q|Google - Taiwan>google.co.th|q,as_q|Google - Thailand>google.bs|q,as_q|Google - The Bahamas>google.tt|q,as_q|Google - Trinidad and Tobago>google.com.tr|q,as_q|Google - Turkey>google.com.ua|q,as_q|Google - Ukraine>google.ae|q,as_q|Google - United Arab Emirates>google.co.uk|q,as_q|Google - United Kingdom>google.com.uy|q,as_q|Google - Uruguay>google.co.ve|q,as_q|Google - Venezuela>google.com.vn|q,as_q|Google - Viet Nam>google.co.vi|q,as_q|Google - Virgin Islands>icqit.com|q|icq>bing.com|q|Microsoft Bing>myway.com|searchfor|MyWay.com>naver.com,search.naver.com|query|Naver>netscape.com|query,search|Netscape Search>reference.com|q|Reference.com>seznam|w|Seznam.cz>abcsok.no|q|Startsiden>tiscali.it|key|Tiscali>virgilio.it|qs|Virgilio>yahoo.com,search.yahoo.com|p|Yahoo!>ar.yahoo.com,ar.search.yahoo.com|p|Yahoo! - Argentina>au.yahoo.com,au.search.yahoo.com|p|Yahoo! - Australia>ca.yahoo.com,ca.search.yahoo.com|p|Yahoo! - Canada>fr.yahoo.com,fr.search.yahoo.com|p|Yahoo! - France>de.yahoo.com,de.search.yahoo.com|p|Yahoo! - Germany>hk.yahoo.com,hk.search.yahoo.com|p|Yahoo! - Hong Kong>in.yahoo.com,in.search.yahoo.com|p|Yahoo! - India>yahoo.co.jp,search.yahoo.co.jp|p,va|Yahoo! - Japan>kr.yahoo.com,kr.search.yahoo.com|p|Yahoo! - Korea>mx.yahoo.com,mx.search.yahoo.com|p|Yahoo! - Mexico>ph.yahoo.com,ph.search.yahoo.com|p|Yahoo! - Philippines>sg.yahoo.com,sg.search.yahoo.com|p|Yahoo! - Singapore>es.yahoo.com,es.search.yahoo.com|p|Yahoo! - Spain>telemundo.yahoo.com,espanol.search.yahoo.com|p|Yahoo! - Spanish (US : Telemundo)>tw.yahoo.com,tw.search.yahoo.com|p|Yahoo! - Taiwan>uk.yahoo.com,uk.search.yahoo.com|p|Yahoo! - UK and Ireland>yandex|text|Yandex.ru>search.cnn.com|query|CNN Web Search>search.earthlink.net|q|Earthlink Search>search.comcast.net|q|Comcast Search>search.rr.com|qs|RoadRunner Search>optimum.net|q|Optimum Search";
s_iv.crossVisitParticipation=new Function("v","cn","ex","ct","dl","ev","dv","var s=this,ce;if(typeof(dv)==='undefined')dv=0;if(s.events&&ev){var ay=s.split(ev,',');var ea=s.split(s.events,',');for(var u=0;u<ay.length;u++){for(var x=0;x<ea.length;x++){if(ay[u]==ea[x]){ce=1;}}}}if(!v||v==''){if(ce){s.c_w(cn,'');return'';}else return'';}v=escape(v);var arry=new Array(),a=new Array(),c=s.c_r(cn),g=0,h=new Array();if(c&&c!=''){arry=s.split(c,'],[');for(q=0;q<arry.length;q++){z=arry[q];z=s.repl(z,'[','');z=s.repl(z,']','');z=s.repl(z,\"'\",'');arry[q]=s.split(z,',')}}var e=new Date();e.setFullYear(e.getFullYear()+5);if(dv==0&&arry.length>0&&arry[arry.length-1][0]==v)arry[arry.length-1]=[v,new Date().getTime()];else arry[arry.length]=[v,new Date().getTime()];var start=arry.length-ct<0?0:arry.length-ct;var td=new Date();for(var x=start;x<arry.length;x++){var diff=Math.round((td.getTime()-arry[x][1])/86400000);if(diff<ex){h[g]=unescape(arry[x][0]);a[g]=[arry[x][0],arry[x][1]];g++;}}var data=s.join(a,{delim:',',front:'[',back:']',wrap:\"'\"});s.c_w(cn,data,e);var r=s.join(h,{delim:dl});if(ce)s.c_w(cn,'');return r;");s_iv.visitorNamespace="nbcuniversal";s_iv.trackingServer="oimg.nbcuni.com";s_iv.trackingServerSecure="osimg.nbcuni.com";var s_code="",s_objectID;function s_gi(un,pg,ss){var c="s.version='H.25';s.an=s_an;s.logDebug=function(m){var s=this,tcf=new Function('var e;try{console.log(\"'+s.rep(s.rep(s.rep(m,\"\\\\\",\"\\\\\\\\\"),\"\\n\",\"\\\\n\"),\"\\\"\",\"\\\\\\\"\")+'\");}catch(e){}');tcf()};s.cls=function(x,c){var i,y='';if(!c)c=this.an;for(i=0;i<x.length;i++){n=x.substring(i,i+1);if(c.indexOf(n)>=0)y+=n}return y};s.fl=function(x,l){return x?(''+x).substring(0,l):x};s.co=function(o){return o};s.num=function(x){x=''+x;for(var p=0;p<x.length;p++)if(('0123456789').indexOf(x.substring(p,p+1))<0)return 0;return 1};s.rep=s_rep;s.sp=s_sp;s.jn=s_jn;s.ape=function(x){var s=this,h='0123456789ABCDEF',i,c=s.charSet,n,l,e,y='';c=c?c.toUpperCase():'';if(x){x=''+x;if(s.em==3)x=encodeURIComponent(x);else if(c=='AUTO'&&('').charCodeAt){for(i=0;i<x.length;i++){c=x.substring(i,i+1);n=x.charCodeAt(i);if(n>127){l=0;e='';while(n||l<4){e=h.substring(n%16,n%16+1)+e;n=(n-n%16)/16;l++}y+='%u'+e}else if(c=='+')y+='%2B';else y+=escape(c)}x=y}else x=escape(''+x);x=s.rep(x,'+','%2B');if(c&&c!='AUTO'&&s.em==1&&x.indexOf('%u')<0&&x.indexOf('%U')<0){i=x.indexOf('%');while(i>=0){i++;if(h.substring(8).indexOf(x.substring(i,i+1).toUpperCase())>=0)return x.substring(0,i)+'u00'+x.substring(i);i=x.indexOf('%',i)}}}return x};s.epa=function(x){var s=this;if(x){x=s.rep(''+x,'+',' ');return s.em==3?decodeURIComponent(x):unescape(x)}return x};s.pt=function(x,d,f,a){var s=this,t=x,z=0,y,r;while(t){y=t.indexOf(d);y=y<0?t.length:y;t=t.substring(0,y);r=s[f](t,a);if(r)return r;z+=y+d.length;t=x.substring(z,x.length);t=z<x.length?t:''}return ''};s.isf=function(t,a){var c=a.indexOf(':');if(c>=0)a=a.substring(0,c);c=a.indexOf('=');if(c>=0)a=a.substring(0,c);if(t.substring(0,2)=='s_')t=t.substring(2);return (t!=''&&t==a)};s.fsf=function(t,a){var s=this;if(s.pt(a,',','isf',t))s.fsg+=(s.fsg!=''?',':'')+t;return 0};s.fs=function(x,f){var s=this;s.fsg='';s.pt(x,',','fsf',f);return s.fsg};s.mpc=function(m,a){var s=this,c,l,n,v;v=s.d.visibilityState;if(!v)v=s.d.webkitVisibilityState;if(v&&v=='prerender'){if(!s.mpq){s.mpq=new Array;l=s.sp('webkitvisibilitychange,visibilitychange',',');for(n=0;n<l.length;n++){s.d.addEventListener(l[n],new Function('var s=s_c_il['+s._in+'],c,v;v=s.d.visibilityState;if(!v)v=s.d.webkitVisibilityState;if(s.mpq&&v==\"visible\"){while(s.mpq.length>0){c=s.mpq.shift();s[c.m].apply(s,c.a)}s.mpq=0}'),false)}}c=new Object;c.m=m;c.a=a;s.mpq.push(c);return 1}return 0};s.si=function(){var s=this,i,k,v,c=s_gi+'var s=s_gi(\"'+s.oun+'\");s.sa(\"'+s.un+'\");';for(i=0;i<s.va_g.length;i++){k=s.va_g[i];v=s[k];if(v!=undefined){if(typeof(v)!='number')c+='s.'+k+'=\"'+s_fe(v)+'\";';else c+='s.'+k+'='+v+';'}}c+=\"s.lnk=s.eo=s.linkName=s.linkType=s.wd.s_objectID=s.ppu=s.pe=s.pev1=s.pev2=s.pev3='';\";return c};s.c_d='';s.c_gdf=function(t,a){var s=this;if(!s.num(t))return 1;return 0};s.c_gd=function(){var s=this,d=s.wd.location.hostname,n=s.fpCookieDomainPeriods,p;if(!n)n=s.cookieDomainPeriods;if(d&&!s.c_d){n=n?parseInt(n):2;n=n>2?n:2;p=d.lastIndexOf('.');if(p>=0){while(p>=0&&n>1){p=d.lastIndexOf('.',p-1);n--}s.c_d=p>0&&s.pt(d,'.','c_gdf',0)?d.substring(p):d}}return s.c_d};s.c_r=function(k){var s=this;k=s.ape(k);var c=' '+s.d.cookie,i=c.indexOf(' '+k+'='),e=i<0?i:c.indexOf(';',i),v=i<0?'':s.epa(c.substring(i+2+k.length,e<0?c.length:e));return v!='[[B]]'?v:''};s.c_w=function(k,v,e){var s=this,d=s.c_gd(),l=s.cookieLifetime,t;v=''+v;l=l?(''+l).toUpperCase():'';if(e&&l!='SESSION'&&l!='NONE'){t=(v!=''?parseInt(l?l:0):-60);if(t){e=new Date;e.setTime(e.getTime()+(t*1000))}}if(k&&l!='NONE'){s.d.cookie=k+'='+s.ape(v!=''?v:'[[B]]')+'; path=/;'+(e&&l!='SESSION'?' expires='+e.toGMTString()+';':'')+(d?' domain='+d+';':'');return s.c_r(k)==v}return 0};s.eh=function(o,e,r,f){var s=this,b='s_'+e+'_'+s._in,n=-1,l,i,x;if(!s.ehl)s.ehl=new Array;l=s.ehl;for(i=0;i<l.length&&n<0;i++){if(l[i].o==o&&l[i].e==e)n=i}if(n<0){n=i;l[n]=new Object}x=l[n];x.o=o;x.e=e;f=r?x.b:f;if(r||f){x.b=r?0:o[e];x.o[e]=f}if(x.b){x.o[b]=x.b;return b}return 0};s.cet=function(f,a,t,o,b){var s=this,r,tcf;if(s.apv>=5&&(!s.isopera||s.apv>=7)){tcf=new Function('s','f','a','t','var e,r;try{r=s[f](a)}catch(e){r=s[t](e)}return r');r=tcf(s,f,a,t)}else{if(s.ismac&&s.u.indexOf('MSIE 4')>=0)r=s[b](a);else{s.eh(s.wd,'onerror',0,o);r=s[f](a);s.eh(s.wd,'onerror',1)}}return r};s.gtfset=function(e){var s=this;return s.tfs};s.gtfsoe=new Function('e','var s=s_c_il['+s._in+'],c;s.eh(window,\"onerror\",1);s.etfs=1;c=s.t();if(c)s.d.write(c);s.etfs=0;return true');s.gtfsfb=function(a){return window};s.gtfsf=function(w){var s=this,p=w.parent,l=w.location;s.tfs=w;if(p&&p.location!=l&&p.location.host==l.host){s.tfs=p;return s.gtfsf(s.tfs)}return s.tfs};s.gtfs=function(){var s=this;if(!s.tfs){s.tfs=s.wd;if(!s.etfs)s.tfs=s.cet('gtfsf',s.tfs,'gtfset',s.gtfsoe,'gtfsfb')}return s.tfs};s.mrq=function(u){var s=this,l=s.rl[u],n,r;s.rl[u]=0;if(l)for(n=0;n<l.length;n++){r=l[n];s.mr(0,0,r.r,r.t,r.u)}};s.flushBufferedRequests=function(){};s.mr=function(sess,q,rs,ta,u){var s=this,dc=s.dc,t1=s.trackingServer,t2=s.trackingServerSecure,tb=s.trackingServerBase,p='.sc',ns=s.visitorNamespace,un=s.cls(u?u:(ns?ns:s.fun)),r=new Object,l,imn='s_i_'+(un),im,b,e;if(!rs){if(t1){if(t2&&s.ssl)t1=t2}else{if(!tb)tb='2o7.net';if(dc)dc=(''+dc).toLowerCase();else dc='d1';if(tb=='2o7.net'){if(dc=='d1')dc='112';else if(dc=='d2')dc='122';p=''}t1=un+'.'+dc+'.'+p+tb}rs='http'+(s.ssl?'s':'')+'://'+t1+'/b/ss/'+s.un+'/'+(s.mobile?'5.1':'1')+'/'+s.version+(s.tcn?'T':'')+'/'+sess+'?AQB=1&ndh=1'+(q?q:'')+'&AQE=1';if(s.isie&&!s.ismac)rs=s.fl(rs,2047)}if(s.d.images&&s.apv>=3&&(!s.isopera||s.apv>=7)&&(s.ns6<0||s.apv>=6.1)){if(!s.rc)s.rc=new Object;if(!s.rc[un]){s.rc[un]=1;if(!s.rl)s.rl=new Object;s.rl[un]=new Array;setTimeout('if(window.s_c_il)window.s_c_il['+s._in+'].mrq(\"'+un+'\")',750)}else{l=s.rl[un];if(l){r.t=ta;r.u=un;r.r=rs;l[l.length]=r;return ''}imn+='_'+s.rc[un];s.rc[un]++}if(s.debugTracking){var d='AppMeasurement Debug: '+rs,dl=s.sp(rs,'&'),dln;for(dln=0;dln<dl.length;dln++)d+=\"\\n\\t\"+s.epa(dl[dln]);s.logDebug(d)}im=s.wd[imn];if(!im)im=s.wd[imn]=new Image;im.s_l=0;im.onload=new Function('e','this.s_l=1;var wd=window,s;if(wd.s_c_il){s=wd.s_c_il['+s._in+'];s.bcr();s.mrq(\"'+un+'\");s.nrs--;if(!s.nrs)s.m_m(\"rr\")}');if(!s.nrs){s.nrs=1;s.m_m('rs')}else s.nrs++;im.src=rs;if(s.useForcedLinkTracking||s.bcf){if(!s.forcedLinkTrackingTimeout)s.forcedLinkTrackingTimeout=250;setTimeout('var wd=window,s;if(wd.s_c_il){s=wd.s_c_il['+s._in+'];s.bcr()}',s.forcedLinkTrackingTimeout);}else if((s.lnk||s.eo)&&(!ta||ta=='_self'||ta=='_top'||(s.wd.name&&ta==s.wd.name))){b=e=new Date;while(!im.s_l&&e.getTime()-b.getTime()<500)e=new Date}return ''}return '<im'+'g sr'+'c=\"'+rs+'\" width=1 height=1 border=0 alt=\"\">'};s.gg=function(v){var s=this;if(!s.wd['s_'+v])s.wd['s_'+v]='';return s.wd['s_'+v]};s.glf=function(t,a){if(t.substring(0,2)=='s_')t=t.substring(2);var s=this,v=s.gg(t);if(v)s[t]=v};s.gl=function(v){var s=this;if(s.pg)s.pt(v,',','glf',0)};s.rf=function(x){var s=this,y,i,j,h,p,l=0,q,a,b='',c='',t;if(x&&x.length>255){y=''+x;i=y.indexOf('?');if(i>0){q=y.substring(i+1);y=y.substring(0,i);h=y.toLowerCase();j=0;if(h.substring(0,7)=='http://')j+=7;else if(h.substring(0,8)=='https://')j+=8;i=h.indexOf(\"/\",j);if(i>0){h=h.substring(j,i);p=y.substring(i);y=y.substring(0,i);if(h.indexOf('google')>=0)l=',q,ie,start,search_key,word,kw,cd,';else if(h.indexOf('yahoo.co')>=0)l=',p,ei,';if(l&&q){a=s.sp(q,'&');if(a&&a.length>1){for(j=0;j<a.length;j++){t=a[j];i=t.indexOf('=');if(i>0&&l.indexOf(','+t.substring(0,i)+',')>=0)b+=(b?'&':'')+t;else c+=(c?'&':'')+t}if(b&&c)q=b+'&'+c;else c=''}i=253-(q.length-c.length)-y.length;x=y+(i>0?p.substring(0,i):'')+'?'+q}}}}return x};s.s2q=function(k,v,vf,vfp,f){var s=this,qs='',sk,sv,sp,ss,nke,nk,nf,nfl=0,nfn,nfm;if(k==\"contextData\")k=\"c\";if(v){for(sk in v)if((!f||sk.substring(0,f.length)==f)&&v[sk]&&(!vf||vf.indexOf(','+(vfp?vfp+'.':'')+sk+',')>=0)&&(!Object||!Object.prototype||!Object.prototype[sk])){nfm=0;if(nfl)for(nfn=0;nfn<nfl.length;nfn++)if(sk.substring(0,nfl[nfn].length)==nfl[nfn])nfm=1;if(!nfm){if(qs=='')qs+='&'+k+'.';sv=v[sk];if(f)sk=sk.substring(f.length);if(sk.length>0){nke=sk.indexOf('.');if(nke>0){nk=sk.substring(0,nke);nf=(f?f:'')+nk+'.';if(!nfl)nfl=new Array;nfl[nfl.length]=nf;qs+=s.s2q(nk,v,vf,vfp,nf)}else{if(typeof(sv)=='boolean'){if(sv)sv='true';else sv='false'}if(sv){if(vfp=='retrieveLightData'&&f.indexOf('.contextData.')<0){sp=sk.substring(0,4);ss=sk.substring(4);if(sk=='transactionID')sk='xact';else if(sk=='channel')sk='ch';else if(sk=='campaign')sk='v0';else if(s.num(ss)){if(sp=='prop')sk='c'+ss;else if(sp=='eVar')sk='v'+ss;else if(sp=='list')sk='l'+ss;else if(sp=='hier'){sk='h'+ss;sv=sv.substring(0,255)}}}qs+='&'+s.ape(sk)+'='+s.ape(sv)}}}}}if(qs!='')qs+='&.'+k}return qs};s.hav=function(){var s=this,qs='',l,fv='',fe='',mn,i,e;if(s.lightProfileID){l=s.va_m;fv=s.lightTrackVars;if(fv)fv=','+fv+','+s.vl_mr+','}else{l=s.va_t;if(s.pe||s.linkType){fv=s.linkTrackVars;fe=s.linkTrackEvents;if(s.pe){mn=s.pe.substring(0,1).toUpperCase()+s.pe.substring(1);if(s[mn]){fv=s[mn].trackVars;fe=s[mn].trackEvents}}}if(fv)fv=','+fv+','+s.vl_l+','+s.vl_l2;if(fe){fe=','+fe+',';if(fv)fv+=',events,'}if (s.events2)e=(e?',':'')+s.events2}for(i=0;i<l.length;i++){var k=l[i],v=s[k],b=k.substring(0,4),x=k.substring(4),n=parseInt(x),q=k;if(!v)if(k=='events'&&e){v=e;e=''}if(v&&(!fv||fv.indexOf(','+k+',')>=0)&&k!='linkName'&&k!='linkType'){if(k=='timestamp')q='ts';else if(k=='dynamicVariablePrefix')q='D';else if(k=='visitorID')q='vid';else if(k=='pageURL'){q='g';v=s.fl(v,255)}else if(k=='referrer'){q='r';v=s.fl(s.rf(v),255)}else if(k=='vmk'||k=='visitorMigrationKey')q='vmt';else if(k=='visitorMigrationServer'){q='vmf';if(s.ssl&&s.visitorMigrationServerSecure)v=''}else if(k=='visitorMigrationServerSecure'){q='vmf';if(!s.ssl&&s.visitorMigrationServer)v=''}else if(k=='charSet'){q='ce';if(v.toUpperCase()=='AUTO')v='ISO8859-1';else if(s.em==2||s.em==3)v='UTF-8'}else if(k=='visitorNamespace')q='ns';else if(k=='cookieDomainPeriods')q='cdp';else if(k=='cookieLifetime')q='cl';else if(k=='variableProvider')q='vvp';else if(k=='currencyCode')q='cc';else if(k=='channel')q='ch';else if(k=='transactionID')q='xact';else if(k=='campaign')q='v0';else if(k=='resolution')q='s';else if(k=='colorDepth')q='c';else if(k=='javascriptVersion')q='j';else if(k=='javaEnabled')q='v';else if(k=='cookiesEnabled')q='k';else if(k=='browserWidth')q='bw';else if(k=='browserHeight')q='bh';else if(k=='connectionType')q='ct';else if(k=='homepage')q='hp';else if(k=='plugins')q='p';else if(k=='events'){if(e)v+=(v?',':'')+e;if(fe)v=s.fs(v,fe)}else if(k=='events2')v='';else if(k=='contextData'){qs+=s.s2q('c',s[k],fv,k,0);v=''}else if(k=='lightProfileID')q='mtp';else if(k=='lightStoreForSeconds'){q='mtss';if(!s.lightProfileID)v=''}else if(k=='lightIncrementBy'){q='mti';if(!s.lightProfileID)v=''}else if(k=='retrieveLightProfiles')q='mtsr';else if(k=='deleteLightProfiles')q='mtsd';else if(k=='retrieveLightData'){if(s.retrieveLightProfiles)qs+=s.s2q('mts',s[k],fv,k,0);v=''}else if(s.num(x)){if(b=='prop')q='c'+n;else if(b=='eVar')q='v'+n;else if(b=='list')q='l'+n;else if(b=='hier'){q='h'+n;v=s.fl(v,255)}}if(v)qs+='&'+s.ape(q)+'='+(k.substring(0,3)!='pev'?s.ape(v):v)}}return qs};s.ltdf=function(t,h){t=t?t.toLowerCase():'';h=h?h.toLowerCase():'';var qi=h.indexOf('?');h=qi>=0?h.substring(0,qi):h;if(t&&h.substring(h.length-(t.length+1))=='.'+t)return 1;return 0};s.ltef=function(t,h){t=t?t.toLowerCase():'';h=h?h.toLowerCase():'';if(t&&h.indexOf(t)>=0)return 1;return 0};s.lt=function(h){var s=this,lft=s.linkDownloadFileTypes,lef=s.linkExternalFilters,lif=s.linkInternalFilters;lif=lif?lif:s.wd.location.hostname;h=h.toLowerCase();if(s.trackDownloadLinks&&lft&&s.pt(lft,',','ltdf',h))return 'd';if(s.trackExternalLinks&&h.substring(0,1)!='#'&&(lef||lif)&&(!lef||s.pt(lef,',','ltef',h))&&(!lif||!s.pt(lif,',','ltef',h)))return 'e';return ''};s.lc=new Function('e','var s=s_c_il['+s._in+'],b=s.eh(this,\"onclick\");s.lnk=this;s.t();s.lnk=0;if(b)return this[b](e);return true');s.bcr=function(){var s=this;if(s.bct&&s.bce)s.bct.dispatchEvent(s.bce);if(s.bcf){if(typeof(s.bcf)=='function')s.bcf();else if(s.bct&&s.bct.href)s.d.location=s.bct.href}s.bct=s.bce=s.bcf=0};s.bc=new Function('e','if(e&&e.s_fe)return;var s=s_c_il['+s._in+'],f,tcf,t,n;if(s.d&&s.d.all&&s.d.all.cppXYctnr)return;if(!s.bbc)s.useForcedLinkTracking=0;else if(!s.useForcedLinkTracking){s.b.removeEventListener(\"click\",s.bc,true);s.bbc=s.useForcedLinkTracking=0;return}else s.b.removeEventListener(\"click\",s.bc,false);s.eo=e.srcElement?e.srcElement:e.target;s.t();s.eo=0;if(s.nrs>0&&s.useForcedLinkTracking&&e.target){t=e.target.target;if(e.target.dispatchEvent&&(!t||t==\\'_self\\'||t==\\'_top\\'||(s.wd.name&&t==s.wd.name))){e.stopPropagation();e.stopImmediatePropagation();e.preventDefault();n=s.d.createEvent(\"MouseEvents\");n.initMouseEvent(\"click\",e.bubbles,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget);n.s_fe=1;s.bct=e.target;s.bce=n;}}');s.oh=function(o){var s=this,l=s.wd.location,h=o.href?o.href:'',i,j,k,p;i=h.indexOf(':');j=h.indexOf('?');k=h.indexOf('/');if(h&&(i<0||(j>=0&&i>j)||(k>=0&&i>k))){p=o.protocol&&o.protocol.length>1?o.protocol:(l.protocol?l.protocol:'');i=l.pathname.lastIndexOf('/');h=(p?p+'//':'')+(o.host?o.host:(l.host?l.host:''))+(h.substring(0,1)!='/'?l.pathname.substring(0,i<0?0:i)+'/':'')+h}return h};s.ot=function(o){var t=o.tagName;if(o.tagUrn||(o.scopeName&&o.scopeName.toUpperCase()!='HTML'))return '';t=t&&t.toUpperCase?t.toUpperCase():'';if(t=='SHAPE')t='';if(t){if((t=='INPUT'||t=='BUTTON')&&o.type&&o.type.toUpperCase)t=o.type.toUpperCase();else if(!t&&o.href)t='A';}return t};s.oid=function(o){var s=this,t=s.ot(o),p,c,n='',x=0;if(t&&!o.s_oid){p=o.protocol;c=o.onclick;if(o.href&&(t=='A'||t=='AREA')&&(!c||!p||p.toLowerCase().indexOf('javascript')<0))n=s.oh(o);else if(c){n=s.rep(s.rep(s.rep(s.rep(''+c,\"\\r\",''),\"\\n\",''),\"\\t\",''),' ','');x=2}else if(t=='INPUT'||t=='SUBMIT'){if(o.value)n=o.value;else if(o.innerText)n=o.innerText;else if(o.textContent)n=o.textContent;x=3}else if(o.src&&t=='IMAGE')n=o.src;if(n){o.s_oid=s.fl(n,100);o.s_oidt=x}}return o.s_oid};s.rqf=function(t,un){var s=this,e=t.indexOf('='),u=e>=0?t.substring(0,e):'',q=e>=0?s.epa(t.substring(e+1)):'';if(u&&q&&(','+u+',').indexOf(','+un+',')>=0){if(u!=s.un&&s.un.indexOf(',')>=0)q='&u='+u+q+'&u=0';return q}return ''};s.rq=function(un){if(!un)un=this.un;var s=this,c=un.indexOf(','),v=s.c_r('s_sq'),q='';if(c<0)return s.pt(v,'&','rqf',un);return s.pt(un,',','rq',0)};s.sqp=function(t,a){var s=this,e=t.indexOf('='),q=e<0?'':s.epa(t.substring(e+1));s.sqq[q]='';if(e>=0)s.pt(t.substring(0,e),',','sqs',q);return 0};s.sqs=function(un,q){var s=this;s.squ[un]=q;return 0};s.sq=function(q){var s=this,k='s_sq',v=s.c_r(k),x,c=0;s.sqq=new Object;s.squ=new Object;s.sqq[q]='';s.pt(v,'&','sqp',0);s.pt(s.un,',','sqs',q);v='';for(x in s.squ)if(x&&(!Object||!Object.prototype||!Object.prototype[x]))s.sqq[s.squ[x]]+=(s.sqq[s.squ[x]]?',':'')+x;for(x in s.sqq)if(x&&(!Object||!Object.prototype||!Object.prototype[x])&&s.sqq[x]&&(x==q||c<2)){v+=(v?'&':'')+s.sqq[x]+'='+s.ape(x);c++}return s.c_w(k,v,0)};s.wdl=new Function('e','var s=s_c_il['+s._in+'],r=true,b=s.eh(s.wd,\"onload\"),i,o,oc;if(b)r=this[b](e);for(i=0;i<s.d.links.length;i++){o=s.d.links[i];oc=o.onclick?\"\"+o.onclick:\"\";if((oc.indexOf(\"s_gs(\")<0||oc.indexOf(\".s_oc(\")>=0)&&oc.indexOf(\".tl(\")<0)s.eh(o,\"onclick\",0,s.lc);}return r');s.wds=function(){var s=this;if(s.apv>3&&(!s.isie||!s.ismac||s.apv>=5)){if(s.b&&s.b.attachEvent)s.b.attachEvent('onclick',s.bc);else if(s.b&&s.b.addEventListener){if(s.n&&s.n.userAgent.indexOf('WebKit')>=0&&s.d.createEvent){s.bbc=1;s.useForcedLinkTracking=1;s.b.addEventListener('click',s.bc,true)}s.b.addEventListener('click',s.bc,false)}else s.eh(s.wd,'onload',0,s.wdl)}};s.vs=function(x){var s=this,v=s.visitorSampling,g=s.visitorSamplingGroup,k='s_vsn_'+s.un+(g?'_'+g:''),n=s.c_r(k),e=new Date,y=e.getYear();e.setYear(y+10+(y<1900?1900:0));if(v){v*=100;if(!n){if(!s.c_w(k,x,e))return 0;n=x}if(n%10000>v)return 0}return 1};s.dyasmf=function(t,m){if(t&&m&&m.indexOf(t)>=0)return 1;return 0};s.dyasf=function(t,m){var s=this,i=t?t.indexOf('='):-1,n,x;if(i>=0&&m){var n=t.substring(0,i),x=t.substring(i+1);if(s.pt(x,',','dyasmf',m))return n}return 0};s.uns=function(){var s=this,x=s.dynamicAccountSelection,l=s.dynamicAccountList,m=s.dynamicAccountMatch,n,i;s.un=s.un.toLowerCase();if(x&&l){if(!m)m=s.wd.location.host;if(!m.toLowerCase)m=''+m;l=l.toLowerCase();m=m.toLowerCase();n=s.pt(l,';','dyasf',m);if(n)s.un=n}i=s.un.indexOf(',');s.fun=i<0?s.un:s.un.substring(0,i)};s.sa=function(un){var s=this;if(s.un&&s.mpc('sa',arguments))return;s.un=un;if(!s.oun)s.oun=un;else if((','+s.oun+',').indexOf(','+un+',')<0)s.oun+=','+un;s.uns()};s.m_i=function(n,a){var s=this,m,f=n.substring(0,1),r,l,i;if(!s.m_l)s.m_l=new Object;if(!s.m_nl)s.m_nl=new Array;m=s.m_l[n];if(!a&&m&&m._e&&!m._i)s.m_a(n);if(!m){m=new Object,m._c='s_m';m._in=s.wd.s_c_in;m._il=s._il;m._il[m._in]=m;s.wd.s_c_in++;m.s=s;m._n=n;m._l=new Array('_c','_in','_il','_i','_e','_d','_dl','s','n','_r','_g','_g1','_t','_t1','_x','_x1','_rs','_rr','_l');s.m_l[n]=m;s.m_nl[s.m_nl.length]=n}else if(m._r&&!m._m){r=m._r;r._m=m;l=m._l;for(i=0;i<l.length;i++)if(m[l[i]])r[l[i]]=m[l[i]];r._il[r._in]=r;m=s.m_l[n]=r}if(f==f.toUpperCase())s[n]=m;return m};s.m_a=new Function('n','g','e','if(!g)g=\"m_\"+n;var s=s_c_il['+s._in+'],c=s[g+\"_c\"],m,x,f=0;if(s.mpc(\"m_a\",arguments))return;if(!c)c=s.wd[\"s_\"+g+\"_c\"];if(c&&s_d)s[g]=new Function(\"s\",s_ft(s_d(c)));x=s[g];if(!x)x=s.wd[\\'s_\\'+g];if(!x)x=s.wd[g];m=s.m_i(n,1);if(x&&(!m._i||g!=\"m_\"+n)){m._i=f=1;if((\"\"+x).indexOf(\"function\")>=0)x(s);else s.m_m(\"x\",n,x,e)}m=s.m_i(n,1);if(m._dl)m._dl=m._d=0;s.dlt();return f');s.m_m=function(t,n,d,e){t='_'+t;var s=this,i,x,m,f='_'+t,r=0,u;if(s.m_l&&s.m_nl)for(i=0;i<s.m_nl.length;i++){x=s.m_nl[i];if(!n||x==n){m=s.m_i(x);u=m[t];if(u){if((''+u).indexOf('function')>=0){if(d&&e)u=m[t](d,e);else if(d)u=m[t](d);else u=m[t]()}}if(u)r=1;u=m[t+1];if(u&&!m[f]){if((''+u).indexOf('function')>=0){if(d&&e)u=m[t+1](d,e);else if(d)u=m[t+1](d);else u=m[t+1]()}}m[f]=1;if(u)r=1}}return r};s.m_ll=function(){var s=this,g=s.m_dl,i,o;if(g)for(i=0;i<g.length;i++){o=g[i];if(o)s.loadModule(o.n,o.u,o.d,o.l,o.e,1);g[i]=0}};s.loadModule=function(n,u,d,l,e,ln){var s=this,m=0,i,g,o=0,f1,f2,c=s.h?s.h:s.b,b,tcf;if(n){i=n.indexOf(':');if(i>=0){g=n.substring(i+1);n=n.substring(0,i)}else g=\"m_\"+n;m=s.m_i(n)}if((l||(n&&!s.m_a(n,g)))&&u&&s.d&&c&&s.d.createElement){if(d){m._d=1;m._dl=1}if(ln){if(s.ssl)u=s.rep(u,'http:','https:');i='s_s:'+s._in+':'+n+':'+g;b='var s=s_c_il['+s._in+'],o=s.d.getElementById(\"'+i+'\");if(s&&o){if(!o.l&&s.wd.'+g+'){o.l=1;if(o.i)clearTimeout(o.i);o.i=0;s.m_a(\"'+n+'\",\"'+g+'\"'+(e?',\"'+e+'\"':'')+')}';f2=b+'o.c++;if(!s.maxDelay)s.maxDelay=250;if(!o.l&&o.c<(s.maxDelay*2)/100)o.i=setTimeout(o.f2,100)}';f1=new Function('e',b+'}');tcf=new Function('s','c','i','u','f1','f2','var e,o=0;try{o=s.d.createElement(\"script\");if(o){o.type=\"text/javascript\";'+(n?'o.id=i;o.defer=true;o.onload=o.onreadystatechange=f1;o.f2=f2;o.l=0;':'')+'o.src=u;c.appendChild(o);'+(n?'o.c=0;o.i=setTimeout(f2,100)':'')+'}}catch(e){o=0}return o');o=tcf(s,c,i,u,f1,f2)}else{o=new Object;o.n=n+':'+g;o.u=u;o.d=d;o.l=l;o.e=e;g=s.m_dl;if(!g)g=s.m_dl=new Array;i=0;while(i<g.length&&g[i])i++;g[i]=o}}else if(n){m=s.m_i(n);m._e=1}return m};s.voa=function(vo,r){var s=this,l=s.va_g,i,k,v,x;for(i=0;i<l.length;i++){k=l[i];v=vo[k];if(v||vo['!'+k]){if(!r&&(k==\"contextData\"||k==\"retrieveLightData\")&&s[k])for(x in s[k])if(!v[x])v[x]=s[k][x];s[k]=v}}};s.vob=function(vo){var s=this,l=s.va_g,i,k;for(i=0;i<l.length;i++){k=l[i];vo[k]=s[k];if(!vo[k])vo['!'+k]=1}};s.dlt=new Function('var s=s_c_il['+s._in+'],d=new Date,i,vo,f=0;if(s.dll)for(i=0;i<s.dll.length;i++){vo=s.dll[i];if(vo){if(!s.m_m(\"d\")||d.getTime()-vo._t>=s.maxDelay){s.dll[i]=0;s.t(vo)}else f=1}}if(s.dli)clearTimeout(s.dli);s.dli=0;if(f){if(!s.dli)s.dli=setTimeout(s.dlt,s.maxDelay)}else s.dll=0');s.dl=function(vo){var s=this,d=new Date;if(!vo)vo=new Object;s.vob(vo);vo._t=d.getTime();if(!s.dll)s.dll=new Array;s.dll[s.dll.length]=vo;if(!s.maxDelay)s.maxDelay=250;s.dlt()};s.track=s.t=function(vo){var s=this,trk=1,tm=new Date,sed=Math&&Math.random?Math.floor(Math.random()*10000000000000):tm.getTime(),sess='s'+Math.floor(tm.getTime()/10800000)%10+sed,y=tm.getYear(),vt=tm.getDate()+'/'+tm.getMonth()+'/'+(y<1900?y+1900:y)+' '+tm.getHours()+':'+tm.getMinutes()+':'+tm.getSeconds()+' '+tm.getDay()+' '+tm.getTimezoneOffset(),tcf,tfs=s.gtfs(),ta=-1,q='',qs='',code='',vb=new Object;if(s.mpc('t',arguments))return;s.gl(s.vl_g);s.uns();s.m_ll();if(!s.td){var tl=tfs.location,a,o,i,x='',c='',v='',p='',bw='',bh='',j='1.0',k=s.c_w('s_cc','true',0)?'Y':'N',hp='',ct='',pn=0,ps;if(String&&String.prototype){j='1.1';if(j.match){j='1.2';if(tm.setUTCDate){j='1.3';if(s.isie&&s.ismac&&s.apv>=5)j='1.4';if(pn.toPrecision){j='1.5';a=new Array;if(a.forEach){j='1.6';i=0;o=new Object;tcf=new Function('o','var e,i=0;try{i=new Iterator(o)}catch(e){}return i');i=tcf(o);if(i&&i.next)j='1.7'}}}}}if(s.apv>=4)x=screen.width+'x'+screen.height;if(s.isns||s.isopera){if(s.apv>=3){v=s.n.javaEnabled()?'Y':'N';if(s.apv>=4){c=screen.pixelDepth;bw=s.wd.innerWidth;bh=s.wd.innerHeight}}s.pl=s.n.plugins}else if(s.isie){if(s.apv>=4){v=s.n.javaEnabled()?'Y':'N';c=screen.colorDepth;if(s.apv>=5){bw=s.d.documentElement.offsetWidth;bh=s.d.documentElement.offsetHeight;if(!s.ismac&&s.b){tcf=new Function('s','tl','var e,hp=0;try{s.b.addBehavior(\"#default#homePage\");hp=s.b.isHomePage(tl)?\"Y\":\"N\"}catch(e){}return hp');hp=tcf(s,tl);tcf=new Function('s','var e,ct=0;try{s.b.addBehavior(\"#default#clientCaps\");ct=s.b.connectionType}catch(e){}return ct');ct=tcf(s)}}}else r=''}if(s.pl)while(pn<s.pl.length&&pn<30){ps=s.fl(s.pl[pn].name,100)+';';if(p.indexOf(ps)<0)p+=ps;pn++}s.resolution=x;s.colorDepth=c;s.javascriptVersion=j;s.javaEnabled=v;s.cookiesEnabled=k;s.browserWidth=bw;s.browserHeight=bh;s.connectionType=ct;s.homepage=hp;s.plugins=p;s.td=1}if(vo){s.vob(vb);s.voa(vo)}if((vo&&vo._t)||!s.m_m('d')){if(s.usePlugins)s.doPlugins(s);var l=s.wd.location,r=tfs.document.referrer;if(!s.pageURL)s.pageURL=l.href?l.href:l;if(!s.referrer&&!s._1_referrer){s.referrer=r;s._1_referrer=1}s.m_m('g');if(s.lnk||s.eo){var o=s.eo?s.eo:s.lnk,p=s.pageName,w=1,t=s.ot(o),n=s.oid(o),x=o.s_oidt,h,l,i,oc;if(s.eo&&o==s.eo){while(o&&!n&&t!='BODY'){o=o.parentElement?o.parentElement:o.parentNode;if(o){t=s.ot(o);n=s.oid(o);x=o.s_oidt}}if(!n||t=='BODY')o='';if(o){oc=o.onclick?''+o.onclick:'';if((oc.indexOf('s_gs(')>=0&&oc.indexOf('.s_oc(')<0)||oc.indexOf('.tl(')>=0)o=0}}if(o){if(n)ta=o.target;h=s.oh(o);i=h.indexOf('?');h=s.linkLeaveQueryString||i<0?h:h.substring(0,i);l=s.linkName;t=s.linkType?s.linkType.toLowerCase():s.lt(h);if(t&&(h||l)){s.pe='lnk_'+(t=='d'||t=='e'?t:'o');s.pev1=(h?s.ape(h):'');s.pev2=(l?s.ape(l):'')}else trk=0;if(s.trackInlineStats){if(!p){p=s.pageURL;w=0}t=s.ot(o);i=o.sourceIndex;if(o.dataset&&o.dataset.sObjectId){s.wd.s_objectID=o.dataset.sObjectId;}else if(o.getAttribute&&o.getAttribute('data-s-object-id')){s.wd.s_objectID=o.getAttribute('data-s-object-id');}else if(s.useForcedLinkTracking){s.wd.s_objectID='';oc=o.onclick?''+o.onclick:'';if(oc){var ocb=oc.indexOf('s_objectID'),oce,ocq,ocx;if(ocb>=0){ocb+=10;while(ocb<oc.length&&(\"= \\t\\r\\n\").indexOf(oc.charAt(ocb))>=0)ocb++;if(ocb<oc.length){oce=ocb;ocq=ocx=0;while(oce<oc.length&&(oc.charAt(oce)!=';'||ocq)){if(ocq){if(oc.charAt(oce)==ocq&&!ocx)ocq=0;else if(oc.charAt(oce)==\"\\\\\")ocx=!ocx;else ocx=0;}else{ocq=oc.charAt(oce);if(ocq!='\"'&&ocq!=\"'\")ocq=0}oce++;}oc=oc.substring(ocb,oce);if(oc){o.s_soid=new Function('s','var e;try{s.wd.s_objectID='+oc+'}catch(e){}');o.s_soid(s)}}}}}if(s.gg('objectID')){n=s.gg('objectID');x=1;i=1}if(p&&n&&t)qs='&pid='+s.ape(s.fl(p,255))+(w?'&pidt='+w:'')+'&oid='+s.ape(s.fl(n,100))+(x?'&oidt='+x:'')+'&ot='+s.ape(t)+(i?'&oi='+i:'')}}else trk=0}if(trk||qs){s.sampled=s.vs(sed);if(trk){if(s.sampled)code=s.mr(sess,(vt?'&t='+s.ape(vt):'')+s.hav()+q+(qs?qs:s.rq()),0,ta);qs='';s.m_m('t');if(s.p_r)s.p_r();s.referrer=s.lightProfileID=s.retrieveLightProfiles=s.deleteLightProfiles=''}s.sq(qs)}}else s.dl(vo);if(vo)s.voa(vb,1);s.lnk=s.eo=s.linkName=s.linkType=s.wd.s_objectID=s.ppu=s.pe=s.pev1=s.pev2=s.pev3='';if(s.pg)s.wd.s_lnk=s.wd.s_eo=s.wd.s_linkName=s.wd.s_linkType='';return code};s.trackLink=s.tl=function(o,t,n,vo,f){var s=this;s.lnk=o;s.linkType=t;s.linkName=n;if(f){s.bct=o;s.bcf=f}s.t(vo)};s.trackLight=function(p,ss,i,vo){var s=this;s.lightProfileID=p;s.lightStoreForSeconds=ss;s.lightIncrementBy=i;s.t(vo)};s.setTagContainer=function(n){var s=this,l=s.wd.s_c_il,i,t,x,y;s.tcn=n;if(l)for(i=0;i<l.length;i++){t=l[i];if(t&&t._c=='s_l'&&t.tagContainerName==n){s.voa(t);if(t.lmq)for(i=0;i<t.lmq.length;i++){x=t.lmq[i];y='m_'+x.n;if(!s[y]&&!s[y+'_c']){s[y]=t[y];s[y+'_c']=t[y+'_c']}s.loadModule(x.n,x.u,x.d)}if(t.ml)for(x in t.ml)if(s[x]){y=s[x];x=t.ml[x];for(i in x)if(!Object.prototype[i]){if(typeof(x[i])!='function'||(''+x[i]).indexOf('s_c_il')<0)y[i]=x[i]}}if(t.mmq)for(i=0;i<t.mmq.length;i++){x=t.mmq[i];if(s[x.m]){y=s[x.m];if(y[x.f]&&typeof(y[x.f])=='function'){if(x.a)y[x.f].apply(y,x.a);else y[x.f].apply(y)}}}if(t.tq)for(i=0;i<t.tq.length;i++)s.t(t.tq[i]);t.s=s;return}}};s.wd=window;s.ssl=(s.wd.location.protocol.toLowerCase().indexOf('https')>=0);s.d=document;s.b=s.d.body;if(s.d.getElementsByTagName){s.h=s.d.getElementsByTagName('HEAD');if(s.h)s.h=s.h[0]}s.n=navigator;s.u=s.n.userAgent;s.ns6=s.u.indexOf('Netscape6/');var apn=s.n.appName,v=s.n.appVersion,ie=v.indexOf('MSIE '),o=s.u.indexOf('Opera '),i;if(v.indexOf('Opera')>=0||o>0)apn='Opera';s.isie=(apn=='Microsoft Internet Explorer');s.isns=(apn=='Netscape');s.isopera=(apn=='Opera');s.ismac=(s.u.indexOf('Mac')>=0);if(o>0)s.apv=parseFloat(s.u.substring(o+6));else if(ie>0){s.apv=parseInt(i=v.substring(ie+5));if(s.apv>3)s.apv=parseFloat(i)}else if(s.ns6>0)s.apv=parseFloat(s.u.substring(s.ns6+10));else s.apv=parseFloat(v);s.em=0;if(s.em.toPrecision)s.em=3;else if(String.fromCharCode){i=escape(String.fromCharCode(256)).toUpperCase();s.em=(i=='%C4%80'?2:(i=='%U0100'?1:0))}if(s.oun)s.sa(s.oun);s.sa(un);s.vl_l='timestamp,dynamicVariablePrefix,visitorID,vmk,visitorMigrationKey,visitorMigrationServer,visitorMigrationServerSecure,ppu,charSet,visitorNamespace,cookieDomainPeriods,cookieLifetime,pageName,pageURL,referrer,contextData,currencyCode,lightProfileID,lightStoreForSeconds,lightIncrementBy,retrieveLightProfiles,deleteLightProfiles,retrieveLightData';s.va_l=s.sp(s.vl_l,',');s.vl_mr=s.vl_m='timestamp,charSet,visitorNamespace,cookieDomainPeriods,cookieLifetime,contextData,lightProfileID,lightStoreForSeconds,lightIncrementBy';s.vl_t=s.vl_l+',variableProvider,channel,server,pageType,transactionID,purchaseID,campaign,state,zip,events,events2,products,linkName,linkType';var n;for(n=1;n<=75;n++){s.vl_t+=',prop'+n+',eVar'+n;s.vl_m+=',prop'+n+',eVar'+n}for(n=1;n<=5;n++)s.vl_t+=',hier'+n;for(n=1;n<=3;n++)s.vl_t+=',list'+n;s.va_m=s.sp(s.vl_m,',');s.vl_l2=',tnt,pe,pev1,pev2,pev3,resolution,colorDepth,javascriptVersion,javaEnabled,cookiesEnabled,browserWidth,browserHeight,connectionType,homepage,plugins';s.vl_t+=s.vl_l2;s.va_t=s.sp(s.vl_t,',');s.vl_g=s.vl_t+',trackingServer,trackingServerSecure,trackingServerBase,fpCookieDomainPeriods,disableBufferedRequests,mobile,visitorSampling,visitorSamplingGroup,dynamicAccountSelection,dynamicAccountList,dynamicAccountMatch,trackDownloadLinks,trackExternalLinks,trackInlineStats,linkLeaveQueryString,linkDownloadFileTypes,linkExternalFilters,linkInternalFilters,linkTrackVars,linkTrackEvents,linkNames,lnk,eo,lightTrackVars,_1_referrer,un';s.va_g=s.sp(s.vl_g,',');s.pg=pg;s.gl(s.vl_g);s.contextData=new Object;s.retrieveLightData=new Object;if(!ss)s.wds();if(pg){s.wd.s_co=function(o){return o};s.wd.s_gs=function(un){s_gi(un,1,1).t()};s.wd.s_dc=function(un){s_gi(un,1).t()}}",w=window,l=w.s_c_il,n=navigator,u=n.userAgent,v=n.appVersion,e=v.indexOf("MSIE "),m=u.indexOf("Netscape6/"),a,i,j,x,s;
if(un){un=un.toLowerCase();if(l){for(j=0;j<2;j++){for(i=0;i<l.length;i++){s=l[i];x=s._c;if((!x||x=="s_c"||(j>0&&x=="s_l"))&&(s.oun==un||(s.fs&&s.sa&&s.fs(s.oun,un)))){if(s.sa){s.sa(un);}if(x=="s_c"){return s;}}else{s=0;}}}}}w.s_an="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";w.s_sp=new Function("x","d","var a=new Array,i=0,j;if(x){if(x.split)a=x.split(d);else if(!d)for(i=0;i<x.length;i++)a[a.length]=x.substring(i,i+1);else while(i>=0){j=x.indexOf(d,i);a[a.length]=x.substring(i,j<0?x.length:j);i=j;if(i>=0)i+=d.length}}return a");w.s_jn=new Function("a","d","var x='',i,j=a.length;if(a&&j>0){x=a[0];if(j>1){if(a.join)x=a.join(d);else for(i=1;i<j;i++)x+=d+a[i]}}return x");w.s_rep=new Function("x","o","n","return s_jn(s_sp(x,o),n)");w.s_d=new Function("x","var t='`^@$#',l=s_an,l2=new Object,x2,d,b=0,k,i=x.lastIndexOf('~~'),j,v,w;if(i>0){d=x.substring(0,i);x=x.substring(i+2);l=s_sp(l,'');for(i=0;i<62;i++)l2[l[i]]=i;t=s_sp(t,'');d=s_sp(d,'~');i=0;while(i<5){v=0;if(x.indexOf(t[i])>=0) {x2=s_sp(x,t[i]);for(j=1;j<x2.length;j++){k=x2[j].substring(0,1);w=t[i]+k;if(k!=' '){v=1;w=d[b+l2[k]]}x2[j]=w+x2[j].substring(1)}}if(v)x=s_jn(x2,'');else{w=t[i]+' ';if(x.indexOf(w)>=0)x=s_rep(x,w,t[i]);i++;b+=62}}}return x");w.s_fe=new Function("c","return s_rep(s_rep(s_rep(c,'\\\\','\\\\\\\\'),'\"','\\\\\"'),\"\\n\",\"\\\\n\")");w.s_fa=new Function("f","var s=f.indexOf('(')+1,e=f.indexOf(')'),a='',c;while(s>=0&&s<e){c=f.substring(s,s+1);if(c==',')a+='\",\"';else if((\"\\n\\r\\t \").indexOf(c)<0)a+=c;s++}return a?'\"'+a+'\"':a");w.s_ft=new Function("c","c+='';var s,e,o,a,d,q,f,h,x;s=c.indexOf('=function(');while(s>=0){s++;d=1;q='';x=0;f=c.substring(s);a=s_fa(f);e=o=c.indexOf('{',s);e++;while(d>0){h=c.substring(e,e+1);if(q){if(h==q&&!x)q='';if(h=='\\\\')x=x?0:1;else x=0}else{if(h=='\"'||h==\"'\")q=h;if(h=='{')d++;if(h=='}')d--}if(d>0)e++}c=c.substring(0,s)+'new Function('+(a?a+',':'')+'\"'+s_fe(c.substring(o+1,e))+'\")'+c.substring(e+1);s=c.indexOf('=function(')}return c;");c=s_d(c);if(e>0){a=parseInt(i=v.substring(e+5));if(a>3){a=parseFloat(i);}}else{if(m>0){a=parseFloat(u.substring(m+10));}else{a=parseFloat(v);}}if(a<5||v.indexOf("Opera")>=0||u.indexOf("Opera")>=0){c=s_ft(c);}if(!s){s=new Object;if(!w.s_c_in){w.s_c_il=new Array;w.s_c_in=0;}s._il=w.s_c_il;s._in=w.s_c_in;s._il[s._in]=s;w.s_c_in++;}s._c="s_c";(new Function("s","un","pg","ss",c))(s,un,pg,ss);return s;}function s_giqf(){var w=window,q=w.s_giq,i,t,s;if(q){for(i=0;i<q.length;i++){t=q[i];s=s_gi(t.oun);s.sa(t.un);s.setTagContainer(t.tagContainerName);}}w.s_giq=0;}s_giqf();var iv_header_isLoaded=false;var isAstrologyPage=false;iv_searchType="";iv_searchword="";iv_site="";iv_section="";iv_subsection1="";iv_subsection2="";iv_titletag="";iv_contenttype="";iv_urlstring="";iv_packageid="";iv_pubDate="";iv_dartZone="";iv_pageType="";iv_hline="";iv_stitle="";iv_envelope="";iv_pageid="";iv_subcontenttype="";iv_event="";iv_events="";iv_product="";iv_slideshow_omni=false;iv_mbdiscustitle="";iv_mbauthor="";iv_mbauthorpost="";iv_mbtitle="";iv_partner="";iv_adcategory="";function iv_setBusinessProps(){if(iv_pageType!="undefined"&&iv_pageType=="errorPage"){s_iv.pageType="errorPage";}if(s_iv.pageType!="undefined"&&s_iv.pageType=="errorPage"){s_iv.pageName="";}else{s_iv.prop8="iVillage Sites";s_iv.prop7="";fullurl=String(window.location);var paths=fullurl.split("/");var domn=(paths[2]);if(domn.indexOf("ivillage.com")!=-1){s_iv.prop9="iVillage";s_iv.prop10="iVillage";}else{if(domn.indexOf("astrology")!=-1){s_iv.prop9="iVillage";s_iv.prop10="Astrology";}else{s_iv.prop9="iVillage_Default";s_iv.prop10=domn;}}if(iv_contenttype==null||iv_contenttype==""){iv_contenttype="NotDeclared:"+s_iv.prop10;}s_iv.pageName=s_iv.prop10+":"+iv_section;s_iv.prop3=iv_contenttype;s_iv.prop4=s_iv.prop10+":"+iv_section;if(iv_subsection1!=""){s_iv.pageName=s_iv.pageName+":"+iv_subsection1;s_iv.prop4=s_iv.prop4+":"+iv_subsection1;}s_iv.prop5=s_iv.prop4;if(iv_subsection2!=""){s_iv.pageName=s_iv.pageName+":"+iv_subsection2;s_iv.prop5=s_iv.prop5+":"+iv_subsection2;}if(typeof(iv_pageid)!="undefined"&&iv_pageid!=""){s_iv.pageName=s_iv.pageName+":"+iv_pageid;}else{s_iv.pageName=s_iv.pageName+":"+iv_titletag;}if(typeof(iv_stitle)!="undefined"&&iv_stitle!=""){s_iv.pageName=s_iv.pageName+":"+iv_stitle;}if(typeof(iv_mbdiscustitle)!=""){s_iv.pageName=s_iv.pageName+":"+iv_mbdiscustitle;}if(iv_searchType!=""){s_iv.prop7=iv_searchType;}if(typeof(packageid)!="undefined"&&packageid.length>1){iv_packageid=packageid;}if(iv_packageid!=""){s_iv.prop19=iv_packageid;}if(typeof(iv_dartZone)!="undefined"&&iv_dartZone!=""){s_iv.eVar7=iv_dartZone;}if(typeof(iv_pubDate)!="undefined"&&iv_pubDate!=""){s_iv.eVar8=iv_pubDate;}if(typeof(iv_hline)!="undefined"&&iv_hline!=""){s_iv.prop30=iv_hline;}if(typeof(iv_envelope)!="undefined"&&iv_envelope!=""){s_iv.prop20=iv_envelope;}if(typeof(iv_subcontenttype)!="undefined"&&iv_subcontenttype!=""){s_iv.prop15=iv_subcontenttype;}if(typeof(iv_byline)!="undefined"&&iv_byline!=""){s_iv.prop40=iv_byline;}s_iv.prop11="D=pageName";s_iv.prop12='D=c8+":"+c9';s_iv.prop14=iv_contenttype+":"+iv_section;s_iv.channel=s_iv.prop10+":"+iv_section;if(iv_mbdiscustitle!=""){s_iv.prop36=iv_mbdiscustitle;}if(iv_mbauthor!=""){s_iv.prop37=iv_mbauthor;}if(iv_mbauthorpost!=""){s_iv.prop38=iv_mbauthorpost;}if(iv_mbtitle!=""){s_iv.prop39=s_iv.prop10+":"+iv_mbtitle;}if(iv_event!=""){s_iv.events=s_iv.apl(s_iv.events,iv_event,",",2);}if(iv_events!=""){s_iv.events=s_iv.apl(s_iv.events,iv_events,",",2);}if(iv_product!=""){s_iv.products=";"+iv_product;}if(iv_partner!=""){s_iv.prop29=iv_partner;}if(iv_adcategory!=""){s_iv.prop58=iv_adcategory;s_iv.eVar58=iv_adcategory;}var omni_user_meta_data_cookie=iv_getCookie("iv_omni_pd");if(typeof(omni_user_meta_data_cookie)!="undefined"&&omni_user_meta_data_cookie!=null&&omni_user_meta_data_cookie.length>0){omni_user_meta_data_values=omni_user_meta_data_cookie.split("|");if(omni_user_meta_data_values.length>0){s_iv.eVar31=omni_user_meta_data_values[0];}if(omni_user_meta_data_values.length>1){s_iv.eVar32=omni_user_meta_data_values[1];}if(omni_user_meta_data_values.length>2){s_iv.eVar30=omni_user_meta_data_values[2];}if(typeof iVillage!="undefined"&&typeof iVillage.arw_token!="undefined"){s_iv.eVar35="Active-Login";}else{s_iv.eVar35="Passive-Login";}}else{s_iv.eVar35="Non-Registered";}}var s_code=s_iv.t();if(s_code){document.write(s_code);}}function iv_doTracking(trackStr,url,prop,linkType,linkName,gs,el){if(linkType==null||linkType==""){linkType="o";}if(linkName==null||linkName==""){linkName="Downloaded File";}if(prop!=null&&prop!=""){prop=prop.replace(/s_prop/,"s_iv.prop");}if(prop==null||prop==""){prop="s_iv.eVar13";}else{if(prop=="s.prop30"||prop=="s_prop30"){prop="s_iv.eVar13";}}if(s_account=="nbcuglobal"){s_account="nbcuivsites";}var s_iv=s_gi(s_account);var is_exit_link=true;if(typeof s_iv.linkInternalFilters!="undefined"&&typeof el!="undefined"){target_anchor=null;if(el.tagName=="A"){target_anchor=el;}else{tmp_parent_element=(window.event)?el.parentElement:el.parentNode;target_anchor=(tmp_parent_element.tagName=="A")?tmp_parent_element:null;}if(target_anchor!=null&&typeof target_anchor.href!="undefined"){var iv_internal_links=s_iv.linkInternalFilters.split(",");for(int_link_count=0;int_link_count<iv_internal_links.length;int_link_count++){if(target_anchor.href.indexOf(iv_internal_links[int_link_count])>=0){is_exit_link=false;break;}}}}else{is_exit_link=false;}s_iv.eVar13=linkName=trackStr;s_iv.prop66=s_iv.pageName;s_iv.prop67=trackStr;s_iv.prop68=iv_section;if(!is_exit_link){s_iv.tl(this,linkType,linkName);}redirectUrl=url;if(url!=null&&url!=""){setTimeout("document.location.replace(redirectUrl)",1000);}return true;}function iv_getCookieVal(offset){var endstr=document.cookie.indexOf(";",offset);if(endstr==-1){endstr=document.cookie.length;}return unescape(document.cookie.substring(offset,endstr));}function iv_DeleteCookie(name,path,domain){if(iv_GetCookie(name)){document.cookie=name+"=; path="+((path)?path:"/")+((domain)?"; domain="+domain:"")+"; expires=Thu, 01-Jan-1970 00:00:01 GMT";}}function iv_SetCookie(name,value,expires,path,domain){var ckToday=new Date();if(expires!=null){var exp=new Date(ckToday.getTime()+expires*24*60*60*1000);}document.cookie=name+"="+escape(value)+((expires)?"; expires="+exp.toGMTString():"")+"; path="+((path)?path:"/")+((domain)?"; domain="+domain:"");}function iv_getCookie(Name){var tCookie=document.cookie;if(tCookie.length==0){return null;}var search=Name+"=";offset=tCookie.indexOf(search);if(offset==-1){return null;}offset+=search.length;end=tCookie.indexOf(";",offset);if(end==-1){end=tCookie.length;}return unescape(tCookie.substring(offset,end));}function iv_getLoginTkt(){var logintkt=iv_getCookie("iv_tkt");if(!logintkt){return"";}return logintkt;}iVillage.runners.blocks.tests=function(){var sticky={sticky:true};function scrollTest(callback){var runs=500;var t=new Date(),i=1,timetaken,offset=$(window).scrollTop();$(window).bind("scroll.scrolltest",function(){if(i>=runs){timetaken=(new Date)-t;console.log("Time taken for "+runs+" scrolls: ",timetaken," - time per scroll: ",timetaken/runs);$(window).unbind("scroll.scrolltest");callback(runs,timetaken,timetaken/runs);return;}i++;doScroll();});function mod(x,y){return Math.round((x/y-Math.floor(x/y))*2);}function doScroll(){setTimeout(function(){$(window).scrollTop(offset+mod(i,2)*100);},0);}doScroll();}if(window.location.hash==="#tests"){$.jGrowl("<strong>Scroll Performance Test</strong> <p>Click start below to run a series of test.</p>",{sticky:true});$.jGrowl('<a href="#" class="scroll-test" id="ST_ASIS">CLICK HERE TO RUN TEST</a>',{sticky:true});var drop={};drop.toolbar=function(){$(".loyalty.toolbar").remove();scrollTest(function(runs,timetaken,diff){$.jGrowl(diff+" seconds Without Toolbar",sticky);drop.player();});};drop.player=function(){$("#Video-Player").remove();scrollTest(function(runs,timetaken,diff){$.jGrowl(diff+" seconds Without Brightcove Player",sticky);drop.activityBar();});};drop.activityBar=function(){$(".badgeville-activity-toolbar").remove();scrollTest(function(runs,timetaken,diff){$.jGrowl(diff+" seconds Without Badgeville Activity Widget",sticky);drop.mainNav();});};drop.mainNav=function(){$("#Top-Navigation").find("li").children(".subnav").remove();scrollTest(function(runs,timetaken,diff){$.jGrowl(diff+" seconds Without Main Navigation",sticky);drop.hatNav();});};drop.hatNav=function(){$("#Header").find(".top").remove();scrollTest(function(runs,timetaken,diff){$.jGrowl(diff+" seconds Without Top Hat Navigation",sticky);drop.middleNav();});};drop.middleNav=function(){$("#Header").find(".middle").remove();scrollTest(function(runs,timetaken,diff){$.jGrowl(diff+" seconds Without Middle Navigation",sticky);drop.hero();});};drop.hero=function(){$("#home-hero").remove();scrollTest(function(runs,timetaken,diff){$.jGrowl(diff+" seconds Without Photos/Videos Hero Tabs",sticky);drop.sharebar();});};drop.sharebar=function(){$("#Follow-Sharebar").remove();scrollTest(function(runs,timetaken,diff){$.jGrowl(diff+" seconds Without Gigya Sharebar",sticky);drop.footer();});};drop.footer=function(){$("#iv_Home_Footer").remove();scrollTest(function(runs,timetaken,diff){$.jGrowl(diff+" seconds Without Footer",sticky);drop.newsletter();});};drop.newsletter=function(){$("#Newsletter-Signup").remove();scrollTest(function(runs,timetaken,diff){$.jGrowl(diff+" seconds Without Newsletter Signup",sticky);drop.adsense();});};drop.adsense=function(){$("#ad-google-contextual-horizontal").remove();scrollTest(function(runs,timetaken,diff){$.jGrowl(diff+" seconds Without AdSense",sticky);drop.ads();});};drop.ads=function(){$("#ad-box-first").remove();$("#ad-top-banner").remove();scrollTest(function(runs,timetaken,diff){$.jGrowl(diff+" seconds Without Ads",sticky);drop.unbindAll();});};drop.unbindAll=function(){$("body").unbind();$("*").unbind();$(this).unbind();top.Window=null;window=null;delete Window;Window=null;var global=Function("return this")()||(42,eval)("this");scrollTest(function(runs,timetaken,diff){$.jGrowl(diff+" seconds Without Events or Globals",sticky);drop.finish();});};drop.finish=function(){$.jGrowl("Finished!",sticky);};$(".scroll-test").live("click",function(e){e.preventDefault();scrollTest(function(runs,timetaken,diff){$.jGrowl(diff+" seconds ASIS",sticky);drop.toolbar();});});}};