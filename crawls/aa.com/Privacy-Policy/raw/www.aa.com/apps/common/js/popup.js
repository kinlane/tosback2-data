function addEvent(elm,evType,fn,useCapture){if(elm.addEventListener){elm.addEventListener(evType,fn,useCapture);return true;}else{if(elm.attachEvent){var r=elm.attachEvent("on"+evType,fn);return r;}else{elm["on"+evType]=fn;}}}var newWindow=null;function closeWin(){if(newWindow!=null){if(!newWindow.closed){newWindow.close();}}}function popUpWin(url,type,strWidth,strHeight){closeWin();type=type.toLowerCase();if(type=="fullscreen"){strWidth=screen.availWidth;strHeight=screen.availHeight;}if(type=="small"){strWidth=400;strHeight=400;}if(type=="medium"){strWidth=550;strHeight=480;}if(type=="large"){strWidth=700;strHeight=480;}var tools="";if(type=="standard"||type=="small"||type=="medium"||type=="large"){tools="toolbar=1,location=0,status=1,menubar=0,scrollbars=1,resizable=1,directories=0,width="+strWidth+",height="+strHeight+",top=100,left=100";}if(type=="console"||type=="fullscreen"){tools="toolbar=1,location=0,status=1,menubar=0,scrollbars=1,resizable=1,directories=0,width="+strWidth+",height="+strHeight+",left=100,top=100";}newWindow=window.open(url,"newWin",tools);newWindow.focus();}function doPopUp(e){var t="standard";var w="700";var h="480";attribs=this.rel.split(" ");if(attribs[1]!=null){t=attribs[1];}if(attribs[2]!=null){w=attribs[2];}if(attribs[3]!=null){h=attribs[3];}popUpWin(this.href,t,w,h);if(window.event){window.event.returnValue=false;window.event.cancelBubble=true;}else{if(e){e.stopPropagation();e.preventDefault();}}}function findPopUps(){var popups=document.getElementsByTagName("a");for(i=0;i<popups.length;i++){if(popups[i].rel.indexOf("popup")!=-1){popups[i].onclick=doPopUp;}}}addEvent(window,"load",findPopUps,false);