(function($){if(!ViewVariables.location_error){$("#change-location-form.popout-dialog").toggle();$("#change-location-field").focus();}
$('li.link-to-categories').trackLink({tos:51});$(function(){$('div.list ul.list a').trackLink({tos:'34'});$('ul.top-searches > li > a').trackLink({pageName:'home_main_popularbusinesses'});});var voteItUpPollLoaded={};$('body').bind('voteitup:pollLoaded',function(event,$elem){if($elem[0]&&!voteItUpPollLoaded[$elem[0].id]){voteItUpPollLoaded[$elem[0].id]=true;var geo=VoteItUpHelper.location.getLocation();geo=geo.city+", "+geo.state;var count=$elem.find('.poll-candidates .candidate:not(.empty-candidate)').length;var title=$elem.find('.poll-title:first').text().trim();Analytics.impressions.emit({vertical:'vote_it_up',recommendation_count:count,geography:geo,feature_title:title});}});})(jQuery);(function(){var $dotd_lightbox=$('#dotd-lightbox');if($dotd_lightbox.length){$dotd_lightbox_form=$dotd_lightbox.find('form');var validator=DOTDSignupValidator.validate($dotd_lightbox_form);$.cookie('dotd_mip_lb',true,{expires:1000*365,path:'/'});$dotd_lightbox.bind(validator.options.notifications.subscriptionSuccess,function(event,resp){if($.cookie){var email=$dotd_lightbox_form.find('input[name="real_deals[email]"]').val();$.cookie(validator.options.subscribeCookieName,email,{expires:360,path:'/',domain:'yellowpages.com'});}
$dotd_lightbox.parent().addClass('deals-success');$('#dotd-lightbox').hide();$('#dotd-lightbox-success').show();$('#deals-sign-in').trigger(validator.options.notifications.subscriptionSuccess);$('#dotd-lightbox-success').trigger('fire_dotd_lightbox_impression');}).bind(validator.options.notifications.subscriptionFailure,function(){$dotd_lightbox.find('.status').html("<strong>Oops!</strong><br>Something went wrong. Please try again.");}).bind(validator.options.notifications.remoteWillStart,function(){$dotd_lightbox.find('.spinner').show();}).bind(validator.options.notifications.remoteDidEnd,function(){$dotd_lightbox.find('.spinner').hide();}).bind(validator.options.notifications.serviceFailure,function(event,resp){$dotd_lightbox.find('.spinner').hide();});}})();(function($){$ugcm=$('.ugc-mashup');if($ugcm.length>0){var path=$ugcm.data('path');$ugcm.load(path,function(){var $this=$(this)
$this.find("a.yp-auth").authLink();$this.find('a.more-like-this').trackLink({pageName:pageTracking.page_id,section:'ugc'})
$ugcm.trigger('ugc.loaded');});};})(jQuery);;(function($){var Superhero=(function(){var $superContent=$('#hero-slides');var $superNav=$('#hero-navigation ul');var $superThumbs=$('#hero-navigation img');var animateOn=true;var animationDelay=5000;var heroTimer=null;var nextHero=function(){var $nextLi=$superNav.find('.nav-link.active').parent().next('li').find('.nav-link');if($nextLi.length>0){$nextLi.trigger('animate.superhero',[true]);}else{animateOn=false;window.clearTimeout(heroTimer);$superNav.find('.nav-link:first').trigger('animate.superhero');}};var timedAnimation=function(animateNext){if(animateOn&&animateNext){heroTimer=window.setTimeout(nextHero,animationDelay);}};var rewriteSearchLinks=function(hero){var $s=new SuperheroContainer(hero);var location=Yacht.geo_terms.replace(/[\W]+/g,"-").toLowerCase();$s.slide.find('a').each(function(){var $link=$(this);$link.attr('href',$link.attr('href').replace(/\/\#\//i,"/"+location+"/"));});};var setupTracking=function(hero){var $s=new SuperheroContainer(hero);var tos=ViewVariables.type_of_search.home_cool_spots;$s.aside.find('.search-link a').trackLink({tos:tos,pageName:'home_main_super_hero_see_more'});sidebarType=$s.aside.attr('data-sidebar-type');if(sidebarType==='search'){$s.slide.bind('fire_tracking',function(){var count=0;$s.aside.find('li.result').each(function(index){count+=1;var $this=$(this);Analytics.impressions.atti.build({visitor_id:ViewVariables.visitor_id,module_of_impression:4,position_of_impression:index+1,listing_id:$this.attr('data-lid'),ypid:$this.attr('data-ypid')});});if(count>0){Analytics.impressions.atti.emit(Analytics.prepare('impressions','atti'));Analytics.reset();}});}
$s.aside.find('.hero-sidebar-category .category a').trackLink({tos:tos,pageName:'home_main_super_hero_categories'});};var SuperheroContainer=function(index){var $slide=$superContent.find('> .slide:eq('+index+')');var $section=$slide.find('.section');var $aside=$slide.find('.aside');var $nav=$superNav.find('> li:eq('+index+')');var $link=$nav.find('a');return{slide:$slide,section:$section,aside:$aside,navLi:$nav,navA:$link};};var callSuperhero=function(hero,animateNext){$.get('/superheroes/'+hero+'/'+location.search,function(data){var $s=new SuperheroContainer(hero);$s.slide.empty().html(data);setupTracking(hero);rewriteSearchLinks(hero);timedAnimation(animateNext);$s.slide.find('img[original]').lazyload();if(hero===0){var i=1;var len=$superContent.find('> .slide').length;for(;i<len;i++){callSuperhero(i,false);}}});};var init=function(){$superThumbs.lazyload();var $firstSuperhero=$superContent.find('> li:first');if($firstSuperhero.length){$firstSuperhero.show();$superNav.delegate('.nav-link','mouseenter',function(){$(this).next('.nav-popup').show();}).delegate('.nav-link','mouseleave',function(){$(this).next('.nav-popup').hide();}).delegate('.nav-link','animate.superhero',function(e,animateNext){var $this=$(this);var i=$superNav.find('> li').index($this.parent('li'));timedAnimation(animateNext);$superNav.find('.nav-link').removeClass('active');$this.addClass('active');$superContent.find('> .slide:not(:eq('+i+'))').stop(true,true).fadeOut('slow',function(){$(this).hide();});$superContent.find('> .slide:eq('+i+')').stop(true,true).fadeIn('slow',function(){$(this).show().trigger('fire_tracking');});}).delegate('.nav-link','click',function(e){e.preventDefault();animateOn=false;window.clearTimeout(heroTimer);$(this).trigger('animate.superhero');});setupTracking(0);rewriteSearchLinks(0);callSuperhero(0,true);}};return{init:init};})();Superhero.init();})(jQuery);