(function(d,c,a){var b={createSimpleToolbar:function(f,l,g){var j={cannedResponses:false,privateMessaging:false};var h=d.extend({},j,g);var e=b.SimpleButton;var i=[new e(c("Bold"),"'''","'''",c("bold text"),"btn-bold"),new e(c("Italic"),"''","''",c("italic text"),"btn-italic"),new b.Separator(),new b.LinkButton(),new b.Separator(),new e(c("Numbered List"),"# ","",c("Numbered list item"),"btn-ol",true),new e(c("Bulleted List"),"* ","",c("Bulleted list item"),"btn-ul",true)];if(h.mediaButton){i.splice(4,0,new b.MediaButton())}if(h.cannedResponses){i.push(new b.Separator(),new b.CannedResponsesButton())}if(h.privateMessaging){i.push(new b.Separator(),new b.QuoteButton())}b.createCustomToolbar(f,l,i)},createFullToolbar:function(f,h){var e=b.SimpleButton,g=b.allButtonsExceptShowfor();g.push(new b.Separator());g.push(new b.ShowForButton());b.createCustomToolbar(f,h,g)},createCustomToolbar:function(g,n,m){var h=d(g||".editor-tools"),f=d(n||"#reply-content, #id_content")[0];for(var j=0,e=m.length;j<e;j++){h.append(m[j].bind(f).node())}},allButtonsExceptShowfor:function(){var e=b.SimpleButton;return[new e(c("Bold"),"'''","'''",c("bold text"),"btn-bold"),new e(c("Italic"),"''","''",c("italic text"),"btn-italic"),new b.Separator(),new b.LinkButton(),new b.MediaButton(),new b.Separator(),new e(c("Numbered List"),"# ","",c("Numbered list item"),"btn-ol",true),new e(c("Bulleted List"),"* ","",c("Bulleted list item"),"btn-ul",true),new b.Separator(),new e(c("Heading 1"),"=","=",c("Heading 1"),"btn-h1",true),new e(c("Heading 2"),"==","==",c("Heading 2"),"btn-h2",true),new e(c("Heading 3"),"===","===",c("Heading 3"),"btn-h3",true)]}};b.SimpleButton=function(h,g,f,e,i,j){this.name=h;this.classes="";this.openTag=g;this.closeTag=f;this.defaultText=e;this.everyline=j;if(undefined!==i){this.classes=i}this.html='<button class="markup-toolbar-button" />'};b.SimpleButton.prototype={bind:function(e){this.textarea=e;return this},render:function(){var e=d(this.html).attr({title:this.name}).html(this.name);e.addClass(this.classes);return e},node:function(){var f=this,e=this.render();e.click(function(g){f.handleClick(g)});return e[0]},getSelectedText:function(){var f="";if(window.ace&&window.highlighting.isEnabled()){var e=window.highlighting.editor;return window.highlighting.session.getTextRange(e.getSelectionRange())}if(a.selection&&a.selection.createRange){f=a.selection.createRange().text}else{if(this.textarea.selectionStart||this.textarea.selectionStart=="0"){f=this.textarea.value.substring(this.textarea.selectionStart,this.textarea.selectionEnd)}}return f},handleClick:function(n){var g,l,i,q,p,j,f,s=this.textarea,h=d(s).scrollTop(),o=window.highlighting&&window.highlighting.session,m=window.highlighting&&window.highlighting.editor;if(window.ace&&window.highlighting&&window.highlighting.isEnabled()){l=m.getSelectionRange();g=o.getTextRange(l);f=l.start.column+this.openTag.length;if(!g.length){g=this.defaultText}m.insert(this.openTag+g+this.closeTag);if(g==this.defaultText){o.selection.setSelectionRange({start:{row:l.start.row,column:f},end:{row:l.end.row,column:f+g.length}})}m.focus();n.preventDefault();return false}s.focus();if(a.selection&&a.selection.createRange){j=a.selection.createRange();g=j.text;if(!g.length){g=this.defaultText}if(this.everyline&&-~g.indexOf("\n")){p=this._applyEveryLine(this.openTag,this.closeTag,g);j.text=p.join("\n")}else{j.text=this.openTag+g+this.closeTag;if(j.moveStart){j.moveStart("character",(-1*this.openTag.length)-g.length);j.moveEnd("character",(-1*this.closeTag.length))}}j.select()}else{if(s.selectionStart||s.selectionStart=="0"){i=s.selectionStart;q=s.selectionEnd;g=s.value.substring(i,q);if(!g.length){g=this.defaultText}if(this.everyline&&-~g.indexOf("\n")){p=this._applyEveryLine(this.openTag,this.closeTag,g).join("\n");s.value=s.value.substring(0,s.selectionStart)+p+s.value.substring(s.selectionEnd);s.selectionStart=i;s.selectionEnd=s.selectionStart+p.length}else{s.value=s.value.substring(0,s.selectionStart)+this.openTag+g+this.closeTag+s.value.substring(s.selectionEnd);s.selectionStart=i+this.openTag.length;s.selectionEnd=s.selectionStart+g.length}}}d(s).scrollTop(h);n.preventDefault();return false},_applyEveryLine:function(f,e,g){return d.map(g.split("\n"),function(h){return(h.replace(/\s+/,"").length?f+h+e:h)})}};b.ShowForButton=function(){this.name=c("Show for...");this.classes="btn-showfor";this.openTag="{for}";this.closeTag="{/for}";this.defaultText="Show for text.";this.everyline=false;this.tooltip=c("Show content only for specific versions of Firefox or operating systems.");this.html=interpolate('<a class="markup-toolbar-link" href="#show-for" title="%s">%s</a>',[this.tooltip,this.name])};b.ShowForButton.prototype=d.extend({},b.SimpleButton.prototype,{render:function(){return d(this.html)},node:function(){var f=this,e=this.render();e.click(function(g){f.openModal(g)});return e[0]},openModal:function(m){var j=this,f=d('<section class="marky"><div class="placeholder"/><div class="submit"><button type="button" class="btn btn-important"></button><a href="#cancel" class="kbox-cancel"></a></div></section>'),g=f.find("div.placeholder"),l=d(this.textarea).data("showfor"),h;f.find("button").text(c("Add Rule")).click(function(n){var o="";d("#showfor-modal input:checked").each(function(){o+=(d(this).val()+",")});j.openTag="{for "+o.slice(0,o.length-1)+"}";j.handleClick(n);h.close()});f.find("a.kbox-cancel").text(c("Cancel"));i(g,l.versions);i(g,l.oses);function i(n,e){d.each(e,function(o,p){n.append(d("<h2/>").text(p[0]));d.each(p[1],function(q,s){n.append(d("<label/>").text(s[1]).prepend(d('<input type="checkbox" name="showfor"/>').attr("value",s[0])))})})}h=new KBox(f,{title:this.name,destroy:true,modal:true,id:"showfor-modal",container:d("body")});h.open();m.preventDefault();return false}});b.Separator=function(){this.html='<span class="separator"></span>'};b.Separator.prototype={node:function(){return d(this.html)[0]},bind:function(){return this}};b.LinkButton=function(){this.name=c("Insert a link...");this.classes="btn-link";this.openTag="[http://example.com ";this.closeTag="]";this.defaultText=c("link text");this.everyline=false;this.origOpenTag=this.openTag;this.origCloseTag=this.closeTag;this.origDefaultText=this.defaultText;this.html='<button class="markup-toolbar-button" />'};b.LinkButton.prototype=d.extend({},b.SimpleButton.prototype,{node:function(){var f=this,e=this.render();e.click(function(g){f.openModal(g)});return e[0]},reset:function(){this.openTag=this.origOpenTag;this.closeTag=this.origCloseTag;this.defaultText=this.origDefaultText},openModal:function(m){var o=this,h=d('<section class="marky"><label>'+c("Link text:")+'</label><input type="text" name="link-text" /><label>'+c("Link target:")+'</label><ol><li><label><input type="radio" name="link-type" value="internal" /> '+c("Support article:")+'</label> <input type="text" name="internal" placeholder="'+c("Enter the name of the article")+'" /></li><li><label><input type="radio" name="link-type" value="external" /> '+c("External link:")+'</label> <input type="text" name="external" placeholder="'+c("Enter the URL of the external link")+'" /></li></ol><div class="submit"><button type="button" class="btn btn-important"></button><a href="#cancel" class="kbox-cancel">'+c("Cancel")+"</a></div></section>"),g=o.getSelectedText(),l;h.find('li input[type="text"]').focus(function(){d(this).closest("li").find('input[type="radio"]').click()});var n=function(e){return(e.term.indexOf("#")==e.term.length-1)};var i=[];var p=function(e){for(var q=0;q<i.length;q++){if(e==i[q].label){return i[q].url}}return null};var f=function(q,e){i=[];d.ajax({url:"/en-US/search",data:{format:"json",q:q.term,a:1,w:1,language:d("html").attr("lang")},dataType:"json",success:function(s,t){d.map(s.results,function(v,u){i.push({label:v.title,url:v.url})});e(i)}})};var j=function(q,e){var t=q.term.split("#")[0];var s=p(t);if(!s){return}d.ajax({url:s,dataType:"text",success:function(v,u){var w=d("[id^='w_']",v);var y=[];if(w.length===0){y.push({label:c("No sections found"),value:q.term.replace("#",""),target:""})}w.each(function(){var A=this.nodeName;var D=A.substring(1);var z=d(this).text();var C=d(this).attr("id");var B=q.term+C;y.push({label:z,value:B,target:C})});e(y)}})};h.find('input[name="internal"]').autocomplete({source:function(q,e){if(n(q)){j(q,e)}else{f(q,e)}},select:function(q,s){if(!s.item.target){return}var e=h.find("input[name=link-text]");if(e.val()===""){e.val(s.item.label)}}});h.find("button").text(c("Insert Link")).click(function(u){var y=h.find('input[type="radio"]:checked').val(),w=h.find("input[name=link-text]").val(),t=h.find('input[name="internal"]'),q=h.find('input[name="external"]');o.reset();if(y==="internal"){var v=t.val();if(v){if(v===g){o.openTag="[[";o.closeTag="]]";if(w){o.closeTag="|"+w+o.closeTag}}else{o.openTag="[["+v;if(w){o.openTag+="|"+w}o.openTag+="]] ";o.closeTag="";o.defaultText=""}}else{o.openTag="[[";o.closeTag="]]";if(w){o.closeTag="|"+w+"]]"}o.defaultText=c("Knowledge Base Article")}}else{var s=q.val();if(s){if(s.indexOf("http")!==0){s="http://"+s}o.openTag="["+s+" ";if(w){o.openTag+=w+"] ";o.closeTag="";o.defaultText=""}}else{if(w){o.defaultText=w}}}o.handleClick(u);l.close()});if(g){h.find('input[name="internal"]').val(g).focus()}l=new KBox(h,{title:this.name,destroy:true,modal:true,id:"link-modal",container:d("body")});l.open();m.preventDefault();return false}});b.MediaButton=function(){this.name=c("Insert media...");this.classes="btn-media";this.openTag="";this.closeTag="";this.defaultText=c("media");this.everyline=false;this.html='<button class="markup-toolbar-button" />'};b.MediaButton.prototype=d.extend({},b.SimpleButton.prototype,{node:function(){var f=this,e=this.render();e.click(function(g){f.openModal(g)});return e[0]},reset:function(){this.openTag="";this.closeTag="";this.defaultText=""},openModal:function(m){var o=this,h=d(o.textarea).closest(".editor"),t=h.data("media-search-url"),f=h.data("media-gallery-url"),j=d('<section class="marky"><div class="filter cf"><form class="simple-search-form" id="gallery-modal-search"><input type="text" name="q" class="searchbox"placeholder="'+c("Search Gallery")+'" /><button type="submit" class="submit-button" title="'+c("Search Gallery")+'">'+c("Search Gallery")+'</button></form><div class="type"><span>'+c("Show:")+'</span><ol><li data-type="image" class="selected">'+c("Images")+'</li><li data-type="video">'+c("Videos")+'</li></ol></div><div class="locale-filter">'+c("Show media for:")+' <select /></div></div><div class="placeholder" /><div class="submit"><button class="btn btn-important">'+c("Insert Media")+'</button><a href="'+f+'#upload" class="upload" target="_blank">'+c("Upload Media")+'</a><a href="#cancel" class="kbox-cancel">'+c("Cancel")+"</a></div></section>"),i=o.getSelectedText(),u=j.find("div.type li.selected").data("type"),g="",q=d("html").attr("lang"),s=1,l;j.find("div.type li").click(function(w){var v=d(this);if(!v.is(".selected")){j.find("div.type li.selected").removeClass("selected");v.addClass("selected");u=v.data("type");s=1;n()}w.preventDefault();return false});var p=j.find("div.locale-filter select");p.html(d("#_languages-select-box").html());p.on("change",function(){s=1;q=d(this).val();n()});j.find("form#gallery-modal-search").submit(function(v){g=j.find('input[name="q"]').val();s=1;n();v.preventDefault();return false});j.find("a.upload").click(function(v){l.close()});j.delegate("ol.pagination a","click",function(v){s=parseInt(d(this).attr("href").split("&page=")[1],10);n();v.preventDefault();return false});j.find("div.submit button").click(function(w){o.reset();var v=j.find("#media-list > li.selected");if(v.length<1){alert(c("Please select an image or video to insert."));return false}o.openTag="[[";o.openTag+=(u=="image")?"Image":"Video";o.openTag+=":"+v.find("a").attr("title")+"]] ";o.handleClick(w);l.close()});n();function n(e,v){j.addClass("processing");d.ajax({url:t,type:"GET",data:{type:u,q:g,page:s,locale:q},dataType:"html",success:function(w){j.find("div.placeholder").html(w);j.find("#media-list > li").click(function(A){var z=d(this),y=d(this).parent();y.find("li.selected").removeClass("selected");z.addClass("selected");A.preventDefault();return false})},error:function(){var w=c("Oops, there was an error.");j.find("div.placeholder").html('<div class="msg">'+w+"</div>")},complete:function(){j.removeClass("processing")}})}l=new KBox(j,{title:this.name,destroy:true,modal:true,id:"media-modal",container:d("body"),position:"none"});l.open();m.preventDefault();return false}});b.CannedResponsesButton=function(){this.name=c("Insert a canned response...");this.classes="btn-cannedresponses";this.openTag="";this.closeTag="";this.defaultText=c("cannedresponses");this.everyline=false;this.html='<button class="markup-toolbar-button" />'};b.CannedResponsesButton.prototype=d.extend({},b.SimpleButton.prototype,{node:function(){var f=this,e=this.render();e.click(function(g){f.openModal(g)});f.getPermissionBits();return e[0]},reset:function(){this.openTag="";this.closeTag="";this.defaultText=""},openModal:function(t){var w=this,j=d(w.textarea).closest(".editor"),p=d('<section class="marky"><div class="search"><input type="text" name="q" id="filter-responses-field" placeholder="'+c("Search for common responses")+'" class="searchbox"/></div></div><div class="area"><div id="responses-area"><h2 class="heading-label">'+c("Categories")+'</h2><ul class="category-list sidebar-nav"><li class="status-indicator busy">'+c("Loading...")+'</li></ul></div><div id="response-list-area"><h2 class="heading-label">'+c("Responses")+'</h2><h4 class="nocat-label">'+c("Please select a category from the previous column or start a search.")+'</h4><p class="response-list"/></div><div id="response-content-area"><h2 class="heading-label preview-label">'+c("Response editor")+'</h2><button class="toggle-view btn">'+c("Switch to preview mode")+'</button><p class="response-preview"><textarea id="response-content"></textarea></p><p class="response-preview-rendered"></p></div></div></div><div class="placeholder" /><div class="submit" id="response-submit-area"><button id="insert-response" class="btn btn-important">'+c("Insert Response")+'</button><a href="#cancel" class="kbox-cancel">'+c("Cancel")+"</a></div></section>"),q=w.getSelectedText(),i;var o="/kb/common-forum-responses";var l="answer-preview-async";function s(){var e=d("#response-content").val();var A=d("[name=csrfmiddlewaretoken]").attr("value");g(true);d.ajax({type:"POST",url:l,data:{content:e,csrfmiddlewaretoken:A},dataType:"html",success:function(C){var D=d(".response-preview-rendered");var B=d(C).find(".main-content");D.html(B)},complete:function(){g(false)}})}function y(e){if(!e||e.indexOf("/new")!==-1){return}e+="/edit";g(true);d.ajax({url:e,dataType:"html",success:function(B,A){var C=d("#id_content",B).val();var D=d("#response-content");D.val(C);s()},complete:function(){g(false)}})}function g(A){var e=d(".preview-label");if(A){e.addClass("busy")}else{e.removeClass("busy")}}function z(e){if(e.indexOf("#")===-1){return true}var B=e.split("#")[0];var D=e.split("#")[1];e=B;for(var A=0;A<D.length;A++){var C=D[A];if(w.permissionBits.indexOf(C)!==-1){return true}}return false}function h(){var B=d("#response-content").val();var e=d("#id_content");var A=e.val();e.val(A+B)}function v(D){D=D.toLowerCase().trim();var B=p.find("#response-list-area .heading-label");var F=p.find(".nocat-label");var E=p.find(".response-list ul");var A=p.find(".response");var C=p.find("#response-list-area");var e=p.find("#responses-area");if(D===""){B.text(c("Responses"));C.removeClass("filtered");e.removeClass("filtered");F.show();A.show();E.hide();return}C.addClass("filtered");e.addClass("filtered");B.text(c("Matching responses"));F.hide();E.show();A.each(function(){var G=d(this).text().toLowerCase();if(G.indexOf(D)===-1){d(this).hide()}else{d(this).show()}})}function u(){var e=window.location.pathname.split("/")[1];var A="/"+e+o;d.ajax({url:A,type:"GET",dataType:"html",success:function(E){var B=d(".category-list"),D=d(".response-list"),C=d(E).find("[id^=w_]");B.empty();D.empty();C.each(function(F,J){var M=d(this).text(),H=d(a.createElement("li")),G=d(a.createElement("ul")).addClass("sidebar-nav").hide(),K=d(this).nextUntil("[id^=w_]").find("a"),L=p.find(".nocat-label"),I,N;K.each(function(R,Q){var P=d(a.createElement("li")).addClass("response").text(d(this).text());var O=d(this).attr("href");var S=z(O);O=O.split("#")[0];if(S){P.click(function(){d(".response-list li").not(d(this)).removeClass("selected");d(this).addClass("selected");y(O)});G.append(P)}});H.addClass("response-heading").text(M).on("click",function(){L.hide();I=D.find("ul").not(G);I.hide();N=B.find(".response-heading").not(H);N.removeClass("selected");d(this).addClass("selected");G.show()});B.append(H);D.append(G)})},error:function(){var B=d(".status-indicator");B.removeClass("busy");B.text(c("There was an error checking for canned responses."))}});return true}i=new KBox(p,{title:this.name,destroy:true,modal:true,id:"media-modal",container:d("body"),position:"none",preOpen:u});i.open();p.find("#insert-response").click(function(){h();i.close()});p.find("#filter-responses-field").keyup(function(){var e=d(this).val();v(e)});var f=p.find(".preview-label");var m=p.find(".response-preview");var n=p.find(".response-preview-rendered");p.find(".toggle-view").toggle(function(){s();f.text(c("Response preview"));d(this).text(c("Switch to edit mode"));m.hide();n.show()},function(){f.text(c("Response editor"));d(this).text(c("Switch to preview mode"));m.show();n.hide()});t.preventDefault();return false},permissionBits:[],getPermissionBits:function(){var f=d("#aux-nav .user").attr("href"),e=this;if(!f||f===""){return}d.ajax({url:f,dataType:"html",success:function(i,g){var h=d("#groups li",i);h.each(function(){var j=d(this).text();if(j==="Contributors"){e.permissionBits.push("c")}if(j==="Forum Moderators"){e.permissionBits.push("m")}if(j==="Administrators"){e.permissionBits.push("a")}})}})}});b.QuoteButton=function(){var g=c("Quote previous message...");var i=d("#read-message").attr("data-message-content");var e=d(".from a").text();var h=d(".from a").attr("href");var f="["+h+" "+e+"]"+c(" said")+"\r\n";f+="<blockquote>\r\n";f+=i+"\r\n";f+="</blockquote>\r\n";return new b.SimpleButton(g,f,"","","btn-quote",true)};window.Marky=b}(jQuery,gettext,document));var LATIN_MAP={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Æ":"AE","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ő":"O","Ø":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ű":"U","Ý":"Y","Þ":"TH","ß":"ss","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","æ":"ae","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ő":"o","ø":"o","ù":"u","ú":"u","û":"u","ü":"u","ű":"u","ý":"y","þ":"th","ÿ":"y"};var LATIN_SYMBOLS_MAP={"©":"(c)"};var GREEK_MAP={"α":"a","β":"b","γ":"g","δ":"d","ε":"e","ζ":"z","η":"h","θ":"8","ι":"i","κ":"k","λ":"l","μ":"m","ν":"n","ξ":"3","ο":"o","π":"p","ρ":"r","σ":"s","τ":"t","υ":"y","φ":"f","χ":"x","ψ":"ps","ω":"w","ά":"a","έ":"e","ί":"i","ό":"o","ύ":"y","ή":"h","ώ":"w","ς":"s","ϊ":"i","ΰ":"y","ϋ":"y","ΐ":"i","Α":"A","Β":"B","Γ":"G","Δ":"D","Ε":"E","Ζ":"Z","Η":"H","Θ":"8","Ι":"I","Κ":"K","Λ":"L","Μ":"M","Ν":"N","Ξ":"3","Ο":"O","Π":"P","Ρ":"R","Σ":"S","Τ":"T","Υ":"Y","Φ":"F","Χ":"X","Ψ":"PS","Ω":"W","Ά":"A","Έ":"E","Ί":"I","Ό":"O","Ύ":"Y","Ή":"H","Ώ":"W","Ϊ":"I","Ϋ":"Y"};var TURKISH_MAP={"ş":"s","Ş":"S","ı":"i","İ":"I","ç":"c","Ç":"C","ü":"u","Ü":"U","ö":"o","Ö":"O","ğ":"g","Ğ":"G"};var RUSSIAN_MAP={"а":"a","б":"b","в":"v","г":"g","д":"d","е":"e","ё":"yo","ж":"zh","з":"z","и":"i","й":"j","к":"k","л":"l","м":"m","н":"n","о":"o","п":"p","р":"r","с":"s","т":"t","у":"u","ф":"f","х":"h","ц":"c","ч":"ch","ш":"sh","щ":"sh","ъ":"","ы":"y","ь":"","э":"e","ю":"yu","я":"ya","А":"A","Б":"B","В":"V","Г":"G","Д":"D","Е":"E","Ё":"Yo","Ж":"Zh","З":"Z","И":"I","Й":"J","К":"K","Л":"L","М":"M","Н":"N","О":"O","П":"P","Р":"R","С":"S","Т":"T","У":"U","Ф":"F","Х":"H","Ц":"C","Ч":"Ch","Ш":"Sh","Щ":"Sh","Ъ":"","Ы":"Y","Ь":"","Э":"E","Ю":"Yu","Я":"Ya"};var UKRAINIAN_MAP={"Є":"Ye","І":"I","Ї":"Yi","Ґ":"G","є":"ye","і":"i","ї":"yi","ґ":"g"};var CZECH_MAP={"č":"c","ď":"d","ě":"e","ň":"n","ř":"r","š":"s","ť":"t","ů":"u","ž":"z","Č":"C","Ď":"D","Ě":"E","Ň":"N","Ř":"R","Š":"S","Ť":"T","Ů":"U","Ž":"Z"};var POLISH_MAP={"ą":"a","ć":"c","ę":"e","ł":"l","ń":"n","ó":"o","ś":"s","ź":"z","ż":"z","Ą":"A","Ć":"C","Ę":"e","Ł":"L","Ń":"N","Ó":"o","Ś":"S","Ź":"Z","Ż":"Z"};var LATVIAN_MAP={"ā":"a","č":"c","ē":"e","ģ":"g","ī":"i","ķ":"k","ļ":"l","ņ":"n","š":"s","ū":"u","ž":"z","Ā":"A","Č":"C","Ē":"E","Ģ":"G","Ī":"i","Ķ":"k","Ļ":"L","Ņ":"N","Š":"S","Ū":"u","Ž":"Z"};var ALL_DOWNCODE_MAPS=new Array();ALL_DOWNCODE_MAPS[0]=LATIN_MAP;ALL_DOWNCODE_MAPS[1]=LATIN_SYMBOLS_MAP;ALL_DOWNCODE_MAPS[2]=GREEK_MAP;ALL_DOWNCODE_MAPS[3]=TURKISH_MAP;ALL_DOWNCODE_MAPS[4]=RUSSIAN_MAP;ALL_DOWNCODE_MAPS[5]=UKRAINIAN_MAP;ALL_DOWNCODE_MAPS[6]=CZECH_MAP;ALL_DOWNCODE_MAPS[7]=POLISH_MAP;ALL_DOWNCODE_MAPS[8]=LATVIAN_MAP;var Downcoder=new Object();Downcoder.Initialize=function(){if(Downcoder.map){return}Downcoder.map={};Downcoder.chars="";for(var a in ALL_DOWNCODE_MAPS){var b=ALL_DOWNCODE_MAPS[a];for(var d in b){Downcoder.map[d]=b[d];Downcoder.chars+=d}}Downcoder.regex=new RegExp("["+Downcoder.chars+"]|[^"+Downcoder.chars+"]+","g")};downcode=function(b){Downcoder.Initialize();var c="";var e=b.match(Downcoder.regex);if(e){for(var d=0;d<e.length;d++){if(e[d].length==1){var a=Downcoder.map[e[d]];if(a!=null){c+=a;continue}}c+=e[d]}}else{c=b}return c};function URLify(b,a){b=downcode(b);removelist=["a","an","as","at","before","but","by","for","from","is","in","into","like","of","off","on","onto","per","since","than","the","this","that","to","up","via","with"];r=new RegExp("\\b("+removelist.join("|")+")\\b","gi");b=b.replace(r,"");b=b.replace(/[^-\w\s]/g,"");b=b.replace(/^\s+|\s+$/g,"");b=b.replace(/[-\s]+/g,"-");b=b.toLowerCase();return b.substring(0,a)}(function(a){a.fn.prepopulate=function(c,b){return this.each(function(){var e=a(this);e.data("_changed",false);e.change(function(){e.data("_changed",true)});var d=function(){if(e.data("_changed")==true){return}var f=[],h,g;c.each(function(){if(a(this).val().length>0){f.push(a(this).val())}});g=f.join(" ");h=URLify(g,b)||g;e.val(h)};c.change(d)})}})(jQuery);var swfobject=function(){var aq="undefined",aD="object",ab="Shockwave Flash",X="ShockwaveFlash.ShockwaveFlash",aE="application/x-shockwave-flash",ac="SWFObjectExprInst",ax="onreadystatechange",af=window,aL=document,aB=navigator,aa=false,Z=[aN],aG=[],ag=[],al=[],aJ,ad,ap,at,ak=false,aU=false,aH,an,aI=true,ah=function(){var a=typeof aL.getElementById!=aq&&typeof aL.getElementsByTagName!=aq&&typeof aL.createElement!=aq,e=aB.userAgent.toLowerCase(),c=aB.platform.toLowerCase(),h=c?/win/.test(c):/win/.test(e),j=c?/mac/.test(c):/mac/.test(e),g=/webkit/.test(e)?parseFloat(e.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,d=!+"\v1",f=[0,0,0],l=null;if(typeof aB.plugins!=aq&&typeof aB.plugins[ab]==aD){l=aB.plugins[ab].description;if(l&&!(typeof aB.mimeTypes!=aq&&aB.mimeTypes[aE]&&!aB.mimeTypes[aE].enabledPlugin)){aa=true;d=false;l=l.replace(/^.*\s+(\S+\s+\S+$)/,"$1");f[0]=parseInt(l.replace(/^(.*)\..*$/,"$1"),10);f[1]=parseInt(l.replace(/^.*\.(.*)\s.*$/,"$1"),10);f[2]=/[a-zA-Z]/.test(l)?parseInt(l.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof af.ActiveXObject!=aq){try{var i=new ActiveXObject(X);if(i){l=i.GetVariable("$version");if(l){d=true;l=l.split(" ")[1].split(",");f=[parseInt(l[0],10),parseInt(l[1],10),parseInt(l[2],10)]}}}catch(b){}}}return{w3:a,pv:f,wk:g,ie:d,win:h,mac:j}}(),aK=function(){if(!ah.w3){return}if((typeof aL.readyState!=aq&&aL.readyState=="complete")||(typeof aL.readyState==aq&&(aL.getElementsByTagName("body")[0]||aL.body))){aP()}if(!ak){if(typeof aL.addEventListener!=aq){aL.addEventListener("DOMContentLoaded",aP,false)}if(ah.ie&&ah.win){aL.attachEvent(ax,function(){if(aL.readyState=="complete"){aL.detachEvent(ax,arguments.callee);aP()}});if(af==top){(function(){if(ak){return}try{aL.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}aP()})()}}if(ah.wk){(function(){if(ak){return}if(!/loaded|complete/.test(aL.readyState)){setTimeout(arguments.callee,0);return}aP()})()}aC(aP)}}();function aP(){if(ak){return}try{var b=aL.getElementsByTagName("body")[0].appendChild(ar("span"));b.parentNode.removeChild(b)}catch(a){return}ak=true;var d=Z.length;for(var c=0;c<d;c++){Z[c]()}}function aj(a){if(ak){a()}else{Z[Z.length]=a}}function aC(a){if(typeof af.addEventListener!=aq){af.addEventListener("load",a,false)}else{if(typeof aL.addEventListener!=aq){aL.addEventListener("load",a,false)}else{if(typeof af.attachEvent!=aq){aM(af,"onload",a)}else{if(typeof af.onload=="function"){var b=af.onload;af.onload=function(){b();a()}}else{af.onload=a}}}}}function aN(){if(aa){Y()}else{am()}}function Y(){var d=aL.getElementsByTagName("body")[0];var b=ar(aD);b.setAttribute("type",aE);var a=d.appendChild(b);if(a){var c=0;(function(){if(typeof a.GetVariable!=aq){var e=a.GetVariable("$version");if(e){e=e.split(" ")[1].split(",");ah.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)]}}else{if(c<10){c++;setTimeout(arguments.callee,10);return}}d.removeChild(b);a=null;am()})()}else{am()}}function am(){var g=aG.length;if(g>0){for(var h=0;h<g;h++){var c=aG[h].id;var m=aG[h].callbackFn;var a={success:false,id:c};if(ah.pv[0]>0){var i=aS(c);if(i){if(ao(aG[h].swfVersion)&&!(ah.wk&&ah.wk<312)){ay(c,true);if(m){a.success=true;a.ref=av(c);m(a)}}else{if(aG[h].expressInstall&&au()){var e={};e.data=aG[h].expressInstall;e.width=i.getAttribute("width")||"0";e.height=i.getAttribute("height")||"0";if(i.getAttribute("class")){e.styleclass=i.getAttribute("class")}if(i.getAttribute("align")){e.align=i.getAttribute("align")}var f={};var d=i.getElementsByTagName("param");var l=d.length;for(var j=0;j<l;j++){if(d[j].getAttribute("name").toLowerCase()!="movie"){f[d[j].getAttribute("name")]=d[j].getAttribute("value")}}ae(e,f,c,m)}else{aF(i);if(m){m(a)}}}}}else{ay(c,true);if(m){var b=av(c);if(b&&typeof b.SetVariable!=aq){a.success=true;a.ref=b}m(a)}}}}}function av(b){var d=null;var c=aS(b);if(c&&c.nodeName=="OBJECT"){if(typeof c.SetVariable!=aq){d=c}else{var a=c.getElementsByTagName(aD)[0];if(a){d=a}}}return d}function au(){return !aU&&ao("6.0.65")&&(ah.win||ah.mac)&&!(ah.wk&&ah.wk<312)}function ae(f,d,h,e){aU=true;ap=e||null;at={success:false,id:h};var a=aS(h);if(a){if(a.nodeName=="OBJECT"){aJ=aO(a);ad=null}else{aJ=a;ad=h}f.id=ac;if(typeof f.width==aq||(!/%$/.test(f.width)&&parseInt(f.width,10)<310)){f.width="310"}if(typeof f.height==aq||(!/%$/.test(f.height)&&parseInt(f.height,10)<137)){f.height="137"}aL.title=aL.title.slice(0,47)+" - Flash Player Installation";var b=ah.ie&&ah.win?"ActiveX":"PlugIn",c="MMredirectURL="+af.location.toString().replace(/&/g,"%26")+"&MMplayerType="+b+"&MMdoctitle="+aL.title;if(typeof d.flashvars!=aq){d.flashvars+="&"+c}else{d.flashvars=c}if(ah.ie&&ah.win&&a.readyState!=4){var g=ar("div");h+="SWFObjectNew";g.setAttribute("id",h);a.parentNode.insertBefore(g,a);a.style.display="none";(function(){if(a.readyState==4){a.parentNode.removeChild(a)}else{setTimeout(arguments.callee,10)}})()}aA(f,d,h)}}function aF(a){if(ah.ie&&ah.win&&a.readyState!=4){var b=ar("div");a.parentNode.insertBefore(b,a);b.parentNode.replaceChild(aO(a),b);a.style.display="none";(function(){if(a.readyState==4){a.parentNode.removeChild(a)}else{setTimeout(arguments.callee,10)}})()}else{a.parentNode.replaceChild(aO(a),a)}}function aO(b){var d=ar("div");if(ah.win&&ah.ie){d.innerHTML=b.innerHTML}else{var e=b.getElementsByTagName(aD)[0];if(e){var a=e.childNodes;if(a){var f=a.length;for(var c=0;c<f;c++){if(!(a[c].nodeType==1&&a[c].nodeName=="PARAM")&&!(a[c].nodeType==8)){d.appendChild(a[c].cloneNode(true))}}}}}return d}function aA(e,g,c){var d,a=aS(c);if(ah.wk&&ah.wk<312){return d}if(a){if(typeof e.id==aq){e.id=c}if(ah.ie&&ah.win){var f="";for(var i in e){if(e[i]!=Object.prototype[i]){if(i.toLowerCase()=="data"){g.movie=e[i]}else{if(i.toLowerCase()=="styleclass"){f+=' class="'+e[i]+'"'}else{if(i.toLowerCase()!="classid"){f+=" "+i+'="'+e[i]+'"'}}}}}var h="";for(var j in g){if(g[j]!=Object.prototype[j]){h+='<param name="'+j+'" value="'+g[j]+'" />'}}a.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>";ag[ag.length]=e.id;d=aS(e.id)}else{var b=ar(aD);b.setAttribute("type",aE);for(var l in e){if(e[l]!=Object.prototype[l]){if(l.toLowerCase()=="styleclass"){b.setAttribute("class",e[l])}else{if(l.toLowerCase()!="classid"){b.setAttribute(l,e[l])}}}}for(var m in g){if(g[m]!=Object.prototype[m]&&m.toLowerCase()!="movie"){aQ(b,m,g[m])}}a.parentNode.replaceChild(b,a);d=b}}return d}function aQ(b,d,c){var a=ar("param");a.setAttribute("name",d);a.setAttribute("value",c);b.appendChild(a)}function aw(a){var b=aS(a);if(b&&b.nodeName=="OBJECT"){if(ah.ie&&ah.win){b.style.display="none";(function(){if(b.readyState==4){aT(a)}else{setTimeout(arguments.callee,10)}})()}else{b.parentNode.removeChild(b)}}}function aT(a){var b=aS(a);if(b){for(var c in b){if(typeof b[c]=="function"){b[c]=null}}b.parentNode.removeChild(b)}}function aS(a){var c=null;try{c=aL.getElementById(a)}catch(b){}return c}function ar(a){return aL.createElement(a)}function aM(a,c,b){a.attachEvent(c,b);al[al.length]=[a,c,b]}function ao(a){var b=ah.pv,c=a.split(".");c[0]=parseInt(c[0],10);c[1]=parseInt(c[1],10)||0;c[2]=parseInt(c[2],10)||0;return(b[0]>c[0]||(b[0]==c[0]&&b[1]>c[1])||(b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]))?true:false}function az(b,f,a,c){if(ah.ie&&ah.mac){return}var e=aL.getElementsByTagName("head")[0];if(!e){return}var g=(a&&typeof a=="string")?a:"screen";if(c){aH=null;an=null}if(!aH||an!=g){var d=ar("style");d.setAttribute("type","text/css");d.setAttribute("media",g);aH=e.appendChild(d);if(ah.ie&&ah.win&&typeof aL.styleSheets!=aq&&aL.styleSheets.length>0){aH=aL.styleSheets[aL.styleSheets.length-1]}an=g}if(ah.ie&&ah.win){if(aH&&typeof aH.addRule==aD){aH.addRule(b,f)}}else{if(aH&&typeof aL.createTextNode!=aq){aH.appendChild(aL.createTextNode(b+" {"+f+"}"))}}}function ay(a,c){if(!aI){return}var b=c?"visible":"hidden";if(ak&&aS(a)){aS(a).style.visibility=b}else{az("#"+a,"visibility:"+b)}}function ai(b){var a=/[\\\"<>\.;]/;var c=a.exec(b)!=null;return c&&typeof encodeURIComponent!=aq?encodeURIComponent(b):b}var aR=function(){if(ah.ie&&ah.win){window.attachEvent("onunload",function(){var a=al.length;for(var b=0;b<a;b++){al[b][0].detachEvent(al[b][1],al[b][2])}var d=ag.length;for(var c=0;c<d;c++){aw(ag[c])}for(var e in ah){ah[e]=null}ah=null;for(var f in swfobject){swfobject[f]=null}swfobject=null})}}();return{registerObject:function(a,e,c,b){if(ah.w3&&a&&e){var d={};d.id=a;d.swfVersion=e;d.expressInstall=c;d.callbackFn=b;aG[aG.length]=d;ay(a,false)}else{if(b){b({success:false,id:a})}}},getObjectById:function(a){if(ah.w3){return av(a)}},embedSWF:function(l,e,h,f,c,a,b,i,g,j){var d={success:false,id:e};if(ah.w3&&!(ah.wk&&ah.wk<312)&&l&&e&&h&&f&&c){ay(e,false);aj(function(){h+="";f+="";var s={};if(g&&typeof g===aD){for(var p in g){s[p]=g[p]}}s.data=l;s.width=h;s.height=f;var o={};if(i&&typeof i===aD){for(var q in i){o[q]=i[q]}}if(b&&typeof b===aD){for(var m in b){if(typeof o.flashvars!=aq){o.flashvars+="&"+m+"="+b[m]}else{o.flashvars=m+"="+b[m]}}}if(ao(c)){var n=aA(s,o,e);if(s.id==e){ay(e,true)}d.success=true;d.ref=n}else{if(a&&au()){s.data=a;ae(s,o,e,j);return}else{ay(e,true)}}if(j){j(d)}})}else{if(j){j(d)}}},switchOffAutoHideShow:function(){aI=false},ua:ah,getFlashPlayerVersion:function(){return{major:ah.pv[0],minor:ah.pv[1],release:ah.pv[2]}},hasFlashPlayerVersion:ao,createSWF:function(a,b,c){if(ah.w3){return aA(a,b,c)}else{return undefined}},showExpressInstall:function(b,a,d,c){if(ah.w3&&au()){ae(b,a,d,c)}},removeSWF:function(a){if(ah.w3){aw(a)}},createCSS:function(b,a,c,d){if(ah.w3){az(b,a,c,d)}},addDomLoadEvent:aj,addLoadEvent:aC,getQueryParamValue:function(b){var a=aL.location.search||aL.location.hash;if(a){if(/\?/.test(a)){a=a.split("?")[1]}if(b==null){return ai(a)}var c=a.split("&");for(var d=0;d<c.length;d++){if(c[d].substring(0,c[d].indexOf("="))==b){return ai(c[d].substring((c[d].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(aU){var a=aS(ac);if(a&&aJ){a.parentNode.replaceChild(aJ,a);if(ad){ay(ad,true);if(ah.ie&&ah.win){aJ.style.display="block"}}if(ap){ap(at)}}aU=false}}}}();(function(b){b.fn.lazyload=function(f){var g=b.extend(b.fn.lazyload.defaults,f);var i=this;var j=false;loaded=i.length;b(window).bind("scroll",function(l){j=true});a(i,g,null);b(window).trigger("scroll");var e=window.location.hash;d();var h=setInterval(function(){if(loaded<=0){b(window).unbind("scroll");clearInterval(h);return}if(j){j=false;if(e!=window.location.hash){assocAnchor=window.location.hash;e=window.location.hash}else{assocAnchor=null}loadedCount=a(i,g,assocAnchor);loaded-=loadedCount}},250);return this};b.fn.lazyload.defaults={threshold:750};function d(){if(window.location.hash){window.location.hash=window.location.hash}}function c(g,f){var e=b(window).height()+b(window).scrollTop();return e>=b(g).offset().top-(f.threshold)}b.fn.lazyload.loadOriginalImage=function(e,f){if(f!=null){b(e).load(function(){d()})}b(e).attr("src",b(e).data("original-src")).removeData("original-src")};b.fn.loadnow=function(e){var f=this;f.each(function(){b.fn.lazyload.loadOriginalImage(this);b(this).removeClass("lazy")})};function a(h,f,g){var e=0;h.filter(".lazy").each(function(){if(b(this).hasClass("lazy")&&c(this,f)&&b(this).data("original-src")&&b(this).is(":visible")){b.fn.lazyload.loadOriginalImage(this,g);b(this).removeClass("lazy");e++}});return e}})(jQuery);jQuery.fn.extend({selectbox:function(a){return this.each(function(){new jQuery.SelectBox(this,a)})}});if(!window.console){var console={log:function(a){}}}jQuery.SelectBox=function(v,e){var b=e||{};b.inputType=b.inputType||"input";b.inputClass=b.inputClass||"selectbox";b.containerClass=b.containerClass||"selectbox-wrapper";b.hoverClass=b.hoverClass||"current";b.currentClass=b.currentClass||"selected";b.groupClass=b.groupClass||"groupname";b.maxHeight=b.maxHeight||200;b.loopnoStep=b.loopnoStep||false;b.onChangeCallback=b.onChangeCallback||false;b.onChangeParams=b.onChangeParams||false;b.debug=b.debug||false;var l=v.id;var f=0;var d=false;var u=0;var t=jQuery(v);var q=h(b);var c=n(b);t.hide().before(c).before(q);s();c.click(function(){if(!d){q.toggle()}}).focus(function(){if(q.not(":visible")){d=true;q.show()}}).keydown(function(w){switch(w.keyCode){case 38:w.preventDefault();m(-1);break;case 40:w.preventDefault();m(1);break;case 13:w.preventDefault();$("li."+b.hoverClass).trigger("click");break;case 27:i();break}}).blur(function(){if(q.is(":visible")&&u>0){if(b.debug){console.log("container visible and has focus")}}else{if((jQuery.browser.msie&&jQuery.browser.version.substr(0,1)<8)){if(document.activeElement.getAttribute("id").indexOf("_container")==-1){i()}else{c.focus()}}else{i()}}});function i(){u=0;q.hide()}function s(){q.append(o(c.attr("id"))).hide();var w=c.css("width");if(q.height()>b.maxHeight){q.height(b.maxHeight)}}function h(y){var w=document.createElement("div");q=jQuery(w);q.attr("id",l+"_container");q.addClass(y.containerClass);q.css("display","none");return q}function n(y){if(b.inputType=="span"){var w=document.createElement("span");var z=jQuery(w);z.attr("id",l+"_input");z.addClass(y.inputClass);z.attr("tabIndex",t.attr("tabindex"))}else{var w=document.createElement("input");var z=jQuery(w);z.attr("id",l+"_input");z.attr("type","text");z.addClass(y.inputClass);z.attr("autocomplete","off");z.attr("readonly","readonly");z.attr("tabIndex",t.attr("tabindex"));z.css("width",t.css("width"))}return z}function m(y){var w=jQuery("li",q);if(!w||w.length==0){return false}firstchoice=0;while($(w[firstchoice]).hasClass(b.groupClass)){firstchoice++}f+=y;if($(w[f]).hasClass(b.groupClass)){f+=y}if(f<firstchoice){(b.loopnoStep?f=w.size()-1:f=w.size())}else{if(b.loopnoStep&&f>w.size()-1){f=firstchoice}else{if(f>w.size()){f=firstchoice}}}a(w,f);w.removeClass(b.hoverClass);jQuery(w[f]).addClass(b.hoverClass)}function a(y,z){var w=jQuery(y[z]).get(0);var y=q.get(0);if(w.offsetTop+w.offsetHeight>y.scrollTop+y.clientHeight){y.scrollTop=w.offsetTop+w.offsetHeight-y.clientHeight}else{if(w.offsetTop<y.scrollTop){y.scrollTop=w.offsetTop}}}function g(){var w=jQuery("li."+b.currentClass,q).get(0);var y=(""+w.id).split("_");var z=y[y.length-1];if(b.onChangeCallback){t.get(0).selectedIndex=$("li",q).index(w);b.onChangeParams={selectedVal:t.val()};b.onChangeCallback(b.onChangeParams)}else{t.val(z);t.change()}if(b.inputType=="span"){c.html($(w).html())}else{c.val($(w).html())}return true}function p(){return t.val()}function j(){return c.val()}function o(A){var B=new Array();var z=document.createElement("ul");B=t.find("option");if(B.length==0){var y=new Array();y=t.children("optgroup");for(x=0;x<y.length;x++){B=$("#"+y[x].id).children("option");var w=document.createElement("li");w.setAttribute("id",A+"_"+$(this).val());w.innerHTML=$("#"+y[x].id).attr("label");w.className=b.groupClass;z.appendChild(w);B.each(function(){var C=document.createElement("li");C.setAttribute("id",A+"_"+$(this).val());C.innerHTML=$(this).html();if($(this).is(":selected")){c.html($(this).html());$(C).addClass(b.currentClass)}z.appendChild(C);$(C).mouseover(function(D){u=1;if(b.debug){console.log("over on : "+this.id)}jQuery(D.target,q).addClass(b.hoverClass)}).mouseout(function(D){u=-1;if(b.debug){console.log("out on : "+this.id)}jQuery(D.target,q).removeClass(b.hoverClass)}).click(function(D){var E=$("li."+b.hoverClass,q).get(0);if(b.debug){console.log("click on :"+this.id)}$("li."+b.currentClass,q).removeClass(b.currentClass);$(this).addClass(b.currentClass);g();t.get(0).blur();i()})})}}else{B.each(function(){var C=document.createElement("li");C.setAttribute("id",A+"_"+$(this).val());C.innerHTML=$(this).html();if($(this).is(":selected")){c.val($(this).html());$(C).addClass(b.currentClass)}z.appendChild(C);$(C).mouseover(function(D){u=1;if(b.debug){console.log("over on : "+this.id)}jQuery(D.target,q).addClass(b.hoverClass)}).mouseout(function(D){u=-1;if(b.debug){console.log("out on : "+this.id)}jQuery(D.target,q).removeClass(b.hoverClass)}).click(function(D){var E=$("li."+b.hoverClass,q).get(0);if(b.debug){console.log("click on :"+this.id)}$("li."+b.currentClass,q).removeClass(b.currentClass);$(this).addClass(b.currentClass);g();t.get(0).blur();i()})})}return z}};(function(e){var c={method:"GET",queryParam:"q",searchDelay:300,minChars:1,propertyToSearch:"name",jsonContainer:null,contentType:"json",prePopulate:null,processPrePopulate:false,hintText:"Type in a search term",noResultsText:"No results",searchingText:"Searching...",deleteText:"&times;",animateDropdown:true,theme:null,resultsFormatter:function(g){return"<li>"+g[this.propertyToSearch]+"</li>"},tokenFormatter:function(g){return"<li><p>"+g[this.propertyToSearch]+"</p></li>"},tokenLimit:null,tokenDelimiter:",",preventDuplicates:false,tokenValue:"id",onResult:null,onAdd:null,onDelete:null,onReady:null,idPrefix:"token-input-",disabled:false};var f={tokenList:"token-input-list",token:"token-input-token",tokenDelete:"token-input-delete-token",selectedToken:"token-input-selected-token",highlightedToken:"token-input-highlighted-token",dropdown:"token-input-dropdown",dropdownItem:"token-input-dropdown-item",dropdownItem2:"token-input-dropdown-item2",selectedDropdownItem:"token-input-selected-dropdown-item",inputToken:"token-input-input-token",disabled:"token-input-disabled"};var d={BEFORE:0,AFTER:1,END:2};var a={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUMPAD_ENTER:108,COMMA:188};var b={init:function(g,h){var i=e.extend({},c,h||{});return this.each(function(){e(this).data("tokenInputObject",new e.TokenList(this,g,i))})},clear:function(){this.data("tokenInputObject").clear();return this},add:function(g){this.data("tokenInputObject").add(g);return this},remove:function(g){this.data("tokenInputObject").remove(g);return this},get:function(){return this.data("tokenInputObject").getTokens()},toggleDisabled:function(g){this.data("tokenInputObject").toggleDisabled(g);return this}};e.fn.tokenInput=function(g){if(b[g]){return b[g].apply(this,Array.prototype.slice.call(arguments,1))}else{return b.init.apply(this,arguments)}};e.TokenList=function(i,u,U){if(e.type(u)==="string"||e.type(u)==="function"){U.url=u;var n=A();if(U.crossDomain===undefined){if(n.indexOf("://")===-1){U.crossDomain=false}else{U.crossDomain=(location.href.split(/\/+/g)[1]!==n.split(/\/+/g)[1])}}}else{if(typeof(u)==="object"){U.local_data=u}}if(U.classes){U.classes=e.extend({},f,U.classes)}else{if(U.theme){U.classes={};e.each(f,function(Z,aa){U.classes[Z]=aa+"-"+U.theme})}else{U.classes=f}}var I=[];var y=0;var t=new e.TokenList.Cache();var S;var P;var C=e('<input type="text"  autocomplete="off">').css({outline:"none"}).attr("id",U.idPrefix+i.id).focus(function(){if(U.disabled){return false}else{if(U.tokenLimit===null||U.tokenLimit!==y){m()}}}).blur(function(){J();e(this).val("")}).bind("keyup keydown blur update",g).keydown(function(aa){var ac;var Z;switch(aa.keyCode){case a.LEFT:case a.RIGHT:case a.UP:case a.DOWN:if(!e(this).val()){ac=o.prev();Z=o.next();if((ac.length&&ac.get(0)===G)||(Z.length&&Z.get(0)===G)){if(aa.keyCode===a.LEFT||aa.keyCode===a.UP){M(e(G),d.BEFORE)}else{M(e(G),d.AFTER)}}else{if((aa.keyCode===a.LEFT||aa.keyCode===a.UP)&&ac.length){V(e(ac.get(0)))}else{if((aa.keyCode===a.RIGHT||aa.keyCode===a.DOWN)&&Z.length){V(e(Z.get(0)))}}}}else{var ab=null;if(aa.keyCode===a.DOWN||aa.keyCode===a.RIGHT){ab=e(R).next()}else{ab=e(R).prev()}if(ab.length){Y(ab)}return false}break;case a.BACKSPACE:ac=o.prev();if(!e(this).val().length){if(G){l(e(G));H.change()}else{if(ac.length){V(e(ac.get(0)))}}return false}else{if(e(this).val().length===1){J()}else{setTimeout(function(){F()},5)}}break;case a.TAB:case a.ENTER:case a.NUMPAD_ENTER:case a.COMMA:if(R){O(e(R).data("tokeninput"));H.change();return false}break;case a.ESCAPE:J();return true;default:if(String.fromCharCode(aa.which)){setTimeout(function(){F()},5)}break}});var H=e(i).hide().val("").focus(function(){C.focus()}).blur(function(){C.blur()});var G=null;var K=0;var R=null;var q=e("<ul />").addClass(U.classes.tokenList).click(function(aa){var Z=e(aa.target).closest("li");if(Z&&Z.get(0)&&e.data(Z.get(0),"tokeninput")){X(Z)}else{if(G){M(e(G),d.END)}C.focus()}}).mouseover(function(aa){var Z=e(aa.target).closest("li");if(Z&&G!==this){Z.addClass(U.classes.highlightedToken)}}).mouseout(function(aa){var Z=e(aa.target).closest("li");if(Z&&G!==this){Z.removeClass(U.classes.highlightedToken)}}).insertBefore(H);var o=e("<li />").addClass(U.classes.inputToken).appendTo(q).append(C);var W=e("<div>").addClass(U.classes.dropdown).appendTo("body").hide();var N=e("<tester/>").insertAfter(C).css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:C.css("fontSize"),fontFamily:C.css("fontFamily"),fontWeight:C.css("fontWeight"),letterSpacing:C.css("letterSpacing"),whiteSpace:"nowrap"});H.val("");var B=U.prePopulate||H.data("pre");if(U.processPrePopulate&&e.isFunction(U.onResult)){B=U.onResult.call(H,B)}if(B&&B.length){e.each(B,function(Z,aa){j(aa);L()})}if(U.disabled){E(true)}if(e.isFunction(U.onReady)){U.onReady.call()}this.clear=function(){q.children("li").each(function(){if(e(this).children("input").length===0){l(e(this))}})};this.add=function(Z){O(Z)};this.remove=function(Z){q.children("li").each(function(){if(e(this).children("input").length===0){var ac=e(this).data("tokeninput");var aa=true;for(var ab in Z){if(Z[ab]!==ac[ab]){aa=false;break}}if(aa){l(e(this))}}})};this.getTokens=function(){return I};this.toggleDisabled=function(Z){E(Z)};function E(Z){if(typeof Z==="boolean"){U.disabled=Z}else{U.disabled=!U.disabled}C.prop("disabled",U.disabled);q.toggleClass(U.classes.disabled,U.disabled);if(G){M(e(G),d.END)}H.prop("disabled",U.disabled)}function L(){if(U.tokenLimit!==null&&y>=U.tokenLimit){C.hide();J();return}}function g(){if(P===(P=C.val())){return}var Z=P.replace(/&/g,"&amp;").replace(/\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");N.html(Z);C.width(N.width()+30)}function T(Z){return((Z>=48&&Z<=90)||(Z>=96&&Z<=111)||(Z>=186&&Z<=192)||(Z>=219&&Z<=222))}function j(Z){var ab=U.tokenFormatter(Z);ab=e(ab).addClass(U.classes.token).insertBefore(o);e("<span>"+U.deleteText+"</span>").addClass(U.classes.tokenDelete).appendTo(ab).click(function(){if(!U.disabled){l(e(this).parent());H.change();return false}});var aa=Z;e.data(ab.get(0),"tokeninput",Z);I=I.slice(0,K).concat([aa]).concat(I.slice(K));K++;z(I,H);y+=1;if(U.tokenLimit!==null&&y>=U.tokenLimit){C.hide();J()}return ab}function O(Z){var ab=U.onAdd;if(y>0&&U.preventDuplicates){var aa=null;q.children().each(function(){var ad=e(this);var ac=e.data(ad.get(0),"tokeninput");if(ac&&ac.id===Z.id){aa=ad;return false}});if(aa){V(aa);o.insertAfter(aa);C.focus();return}}if(U.tokenLimit==null||y<U.tokenLimit){j(Z);L()}C.val("");J();if(e.isFunction(ab)){ab.call(H,Z)}}function V(Z){if(!U.disabled){Z.addClass(U.classes.selectedToken);G=Z.get(0);C.val("");J()}}function M(aa,Z){aa.removeClass(U.classes.selectedToken);G=null;if(Z===d.BEFORE){o.insertBefore(aa);K--}else{if(Z===d.AFTER){o.insertAfter(aa);K++}else{o.appendTo(q);K=y}}C.focus()}function X(aa){var Z=G;if(G){M(e(G),d.END)}if(Z===aa.get(0)){M(aa,d.END)}else{V(aa)}}function l(aa){var ab=e.data(aa.get(0),"tokeninput");var ac=U.onDelete;var Z=aa.prevAll().length;if(Z>K){Z--}aa.remove();G=null;C.focus();I=I.slice(0,Z).concat(I.slice(Z+1));if(Z<K){K--}z(I,H);y-=1;if(U.tokenLimit!==null){C.show().val("").focus()}if(e.isFunction(ac)){ac.call(H,ab)}}function z(ab,Z){var aa=e.map(ab,function(ac){if(typeof U.tokenValue=="function"){return U.tokenValue.call(this,ac)}return ac[U.tokenValue]});Z.val(aa.join(U.tokenDelimiter))}function J(){W.hide().empty();R=null}function s(){W.css({position:"absolute",top:e(q).offset().top+e(q).outerHeight(),left:e(q).offset().left,width:e(q).width(),"z-index":999}).show()}function p(){if(U.searchingText){W.html("<p>"+U.searchingText+"</p>");s()}}function m(){if(U.hintText){W.html("<p>"+U.hintText+"</p>");s()}}function w(aa,Z){return aa.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+Z+")(?![^<>]*>)(?![^&;]+;)","gi"),"<b>$1</b>")}function D(aa,ab,Z){return aa.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+ab+")(?![^<>]*>)(?![^&;]+;)","g"),w(ab,Z))}function Q(ab,Z){if(Z&&Z.length){W.empty();var aa=e("<ul>").appendTo(W).mouseover(function(ac){Y(e(ac.target).closest("li"))}).mousedown(function(ac){O(e(ac.target).closest("li").data("tokeninput"));H.change();return false}).hide();e.each(Z,function(ac,ad){var ae=U.resultsFormatter(ad);ae=D(ae,ad[U.propertyToSearch],ab);ae=e(ae).appendTo(aa);if(ac%2){ae.addClass(U.classes.dropdownItem)}else{ae.addClass(U.classes.dropdownItem2)}if(ac===0){Y(ae)}e.data(ae.get(0),"tokeninput",ad)});s();if(U.animateDropdown){aa.slideDown("fast")}else{aa.show()}}else{if(U.noResultsText){W.html("<p>"+U.noResultsText+"</p>");s()}}}function Y(Z){if(Z){if(R){h(e(R))}Z.addClass(U.classes.selectedDropdownItem);R=Z.get(0)}}function h(Z){Z.removeClass(U.classes.selectedDropdownItem);R=null}function F(){var Z=C.val();if(Z&&Z.length){if(G){M(e(G),d.AFTER)}if(Z.length>=U.minChars){p();clearTimeout(S);S=setTimeout(function(){v(Z)},U.searchDelay)}else{J()}}}function v(af){var ab=af+A();var Z=t.get(ab);if(Z){Q(af,Z)}else{if(U.url){var ad=A();var ac={};ac.data={};if(ad.indexOf("?")>-1){var ag=ad.split("?");ac.url=ag[0];var aa=ag[1].split("&");e.each(aa,function(ah,aj){var ai=aj.split("=");ac.data[ai[0]]=ai[1]})}else{ac.url=ad}ac.data[U.queryParam]=af;ac.type=U.method;ac.dataType=U.contentType;if(U.crossDomain){ac.dataType="jsonp"}ac.success=function(ah){if(e.isFunction(U.onResult)){ah=U.onResult.call(H,ah)}t.add(ab,U.jsonContainer?ah[U.jsonContainer]:ah);if(C.val()===af){Q(af,U.jsonContainer?ah[U.jsonContainer]:ah)}};e.ajax(ac)}else{if(U.local_data){var ae=e.grep(U.local_data,function(ah){return ah[U.propertyToSearch].toLowerCase().indexOf(af.toLowerCase())>-1});if(e.isFunction(U.onResult)){ae=U.onResult.call(H,ae)}t.add(ab,ae);Q(af,ae)}}}}function A(){var Z=U.url;if(typeof U.url=="function"){Z=U.url.call(U)}return Z}};e.TokenList.Cache=function(h){var j=e.extend({max_size:500},h);var l={};var i=0;var g=function(){l={};i=0};this.add=function(n,m){if(i>j.max_size){g()}if(!l[n]){i+=1}l[n]=m};this.get=function(m){return l[m]}}}(jQuery));(function(a){function b(){function e(f,g){g=(g+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1");var h=new RegExp("("+g+")","gi");return f.replace(h,"<strong>$1</strong>")}var d=[];if(a("#id_to").val()){d=[{username:a("#id_to").val(),display_name:null}]}var c={theme:"facebook",hintText:gettext("Search for a user..."),queryParam:"term",propertyToSearch:"username",tokenValue:"username",prePopulate:d,resultsFormatter:function(g){var f=a("#token-input-id_to").val();if(g.display_name){return k.safeInterpolate('<li><div class="name_search">%(display_name)s [%(username)s]</div></li>',g,true)}return k.safeInterpolate('<li><div class="name_search">%(username)s</div></li>',g,true)},onAdd:function(f){a(this).closest(".single").closest("form").submit()}};a("input.user-autocomplete").tokenInput(a("body").data("usernames-api"),c)}a(document).ready(b)}(jQuery));(function(){var e="video-flash-",f=0,b="9.0.0",g={allowfullscreen:"true"},a={autoload:1,showtime:1,showvolume:1};function d(n){if(n[0].tagName.toUpperCase()!=="VIDEO"){return}var m={ogg:false,webm:false},o,q=Number(n.data("width")),l=Number(n.data("height")),p=e+f,j;f++;n.attr("id",p);$("source",n).each(function h(){for(o in m){if($(this).attr("type").indexOf(o)>-1){m[o]=true}}});if(Modernizr.video&&(m.webm&&Modernizr.video.webm)||(m.ogg&&Modernizr.video.ogg)){return false}j=n.data("fallback");if(j.substr(-4)===".swf"){swfobject.embedSWF(j,p,q,l,b,k.MEDIA_URL+"/media/swf/expressInstall.swf",a,g)}else{if(j){a.flv=j;swfobject.embedSWF(k.MEDIA_URL+"swf/screencast.swf",p,q,l,b,k.MEDIA_URL+"/media/swf/expressInstall.swf",a,g)}else{n.hide()}}}function c(){$("div.video video").each(function h(j){d($(this))})}$(document).ready(function(){c()});k.initVideo=c}());(function(d){var a,e,c,f;var b={detectBrowser:function(){function g(j,h){if((j===undefined)||(h===undefined)||!c[j]){return}for(var l=0;l<c[j].length;l++){if(h<c[j][l][0]){return j+c[j][l][1]}}}return g(BrowserDetect.browser,BrowserDetect.version)},hashFragment:function(){var j={},g=document.location.hash.substr(1).split("&"),l;for(var h=0;h<g.length;h++){l=g[h].split("=");j[l[0]]=l[1]}return j},initForTags:function(m,A){if(!A){A=d("body")}m=d.extend({osSelector:"#os",browserSelector:"#browser"},m);var v=this,h=A.find(m.osSelector),H=A.find(m.browserSelector),z=H.find("option").clone(),s={mobile:{browser:z.filter('[data-dependency="mobile"][data-default]').val(),os:h.find('[data-dependency="mobile"][data-default]').val()},desktop:{browser:z.filter('[data-dependency="desktop"][data-default]').val(),os:h.find('[data-dependency="desktop"][data-default]').val()}},y=d("body"),i=v.hashFragment(),D,l,j=BrowserDetect.OS;a=h.data("oses");e=H.data("browsers");c=H.data("version-groups");f=gettext("[missing header]");l=b.detectBrowser();function p(J,I){return J&&I.find("option[value="+J+"]").length===0}if(e[l]&&p(l,H)){b.addBrowserToSelect(H,l);z=H.find("option").clone()}if(e[i.browser]&&p(i.browser,H)){b.addBrowserToSelect(H,i.browser);z=H.find("option").clone()}if(a[j]&&p(j,h)){b.addOsToSelect(h,j)}if(a[i.os]&&p(i.os,h)){b.addOsToSelect(h,i.os)}d("#toc > h2").text(gettext("Table of Contents"));function t(L){var J,K,I;if(L.substring(0,1)=="="){I="=";J=L.substring(1)}else{I=">=";J=L}if(J=="fx3"||J=="fx35"){I="="}K=e[J];return{comparator:I,product:K.product,version:K.maxFloatVersion}}function o(I){E(h.val(),H.val());d("#toc > :not(h2)").remove();d("#toc").append(v.filteredToc(d("#doc-content"),"#toc h2"));if(true===I){var K=document.location.hash.substring(1),J;if(K){J=document.getElementById(K);if(J){J.scrollIntoView()}}}return false}function E(J,I){A.find(".for").each(function(O){var L=h.find("option:selected").data("dependency"),K={},Q=false,U=false,M,S,V,N=[];function P(W,Z){function Y(aa,ac){var ab=e[aa];if(!aa||ab.product!=ac.product){return false}switch(ac.comparator){case"=":return ab.maxFloatVersion==ac.version;case">=":return ab.maxFloatVersion>=ac.version}return false}for(var X=0;X<Z.length;X++){if(Y(W,Z[X])){return true}}}function R(W){return(W.substring(0,1)=="=")?W.substring(1):W}M=d(this).data("for");if(!M){return}S=M.substring(0,4)=="not ";if(S){M=M.substring(4)}d(M.split(",")).each(function(W){if(a[this]!==undefined){K[this]=true;Q=true}else{if(e[R(this)]!==undefined){N.push(t(this));U=true}}});if(J==="win"){for(var T in K){if(T.substring(0,3)==="win"){K.win=true;break}}}V=((Q&&(K[J]===undefined&&(K.win===undefined||J.substring(0,3)!=="win")))||(U&&!P(I,N)))&&!(K[s.mobile.os]&&L==="desktop"&&(P(s.mobile.browser,N)||!U))&&!(P(s.mobile.browser,N)&&L==="desktop"&&(K[s.mobile.os]||!Q))&&!(K[s.desktop.os]&&L==="mobile"&&(P(s.desktop.browser,N)||!U))&&!(K.win&&L==="mobile"&&(P(s.desktop.browser,N)||!U))&&!(P(s.desktop.browser,N)&&L==="mobile"&&(K[s.desktop.os]||!Q));if(V!=S){d(this).hide()}else{d(this).show()}})}function w(){if(d.fn.selectbox){H.siblings("input.selectbox, div.selectbox-wrapper").remove();h.siblings("input.selectbox, div.selectbox-wrapper").remove();H.selectbox();h.selectbox()}else{H.removeAttr("disabled");h.removeAttr("disabled")}}function u(){var J=v.hashFragment();if(!document.location.hash||J.hasOwnProperty("os")||J.hasOwnProperty("browser")){var I="os="+h.val()+"&browser="+H.val();document.location.replace(document.location.href.split("#")[0]+"#"+I)}}function F(){var I={path:"/",expires:new Date()};I.expires.setHours(I.expires.getHours()+12);d.cookie("for_os",h.val(),I);d.cookie("for_browser",H.val(),I);u()}function g(){d.cookie("for_os",null,{path:"/"});d.cookie("for_browser",null,{path:"/"})}function C(){return h.find('[value="'+h.val()+'"]').data("dependency")}function G(J){var M=C(),K,N,L;K=H.val();L=z.filter('[data-dependency="'+M+'"]');H.empty().append(L);H.val(H.find("option[data-default]").val());var I=K.replace(/^\D+/,"");H.find("option").each(function(){var O=d(this);if(O.val().replace(/^\D+/,"")===I){H.val(O.val())}});w()}function B(P,O,M,N,K){var J=M[O],I=true,L;if(!J){J=d.cookie(P);if(!J){J=N();I=false}}if(J){L=K.val();K.val(J);if(K.val()!=J){K.val(L)}w()}return I}function q(J,I){J.val(J.find('option:not([data-dependency="'+I+'"])[data-default]').attr("value"))}function n(){var K,I=false;if(y.is(".desktop, .mobile")){K=C();if(!y.is("."+K)){var J=h.find("[value="+BrowserDetect.OS+"]");if(BrowserDetect.OS&&J.length&&J.data("dependency")!=K){h.val(J.attr("value"));H.val(b.detectBrowser());g()}else{q(h,K);q(H,K);F();I=true}}}return I}D=B("for_os","os",i,function(){return BrowserDetect.OS},h);D|=B("for_browser","browser",i,b.detectBrowser,H);D|=n();G(null);if(D){u()}h.change(G);h.change(F);h.change(o);H.change(F);H.change(o);o(true);w()},filteredToc:function(l,m){function o(q,p){return parseInt(p.tagName.charAt(1),10)}var j=l.find(":header:not(:hidden)"),n=d("<ul />"),g=n,h=Math.min.apply(Math,j.map(o).get());j.each(function i(t){var q=o(0,this),p=d(this);if(m&&p.is(m)){return}for(;h>q;h--){g=g.parent().closest("ul")}for(;h<q;h++){var u=g.children().last();if(u.length===0){u=d("<li />").append(d("<em />").text(f)).appendTo(g)}g=d("<ul />").appendTo(u)}var s=p.clone(),v=p.find(":hidden").remove().end().text();p.replaceWith(s);g.append(d("<li />").text(v).wrapInner(d("<a>").attr("href","#"+p.attr("id"))))});return n},addBrowserToSelect:function(m,n){var g=d("<option/>"),p,i,h,o,l,j;g.attr("value",n);if(n.indexOf("fx")===0){i="desktop";j=2}else{i="mobile";j=1}p=parseInt(n.slice(j),10);g.attr("data-dependency",i);g.text("Firefox "+p);l='option[data-dependency="'+i+'"]';h=m.find(l+":first").val();h=parseInt(h.slice(j),10);o=m.find(l+":last").val();o=parseInt(o.slice(j),10);if(o===35){o=3.5}if(p>h){m.prepend(g)}else{if(p<o){m.append(g)}else{g.insertBefore(m.find(l+":last"))}}return m},addOsToSelect:function(g,h){var i=d("<option/>");i.attr("value",h).attr("text",h).attr("data-dependency","mobile");g.append(i)}};window.ShowFor=b})(jQuery);(function(a){function b(d,c){b.prototype.init.call(this,d,c)}b.prototype={init:function(g,f){var e=this,d=a(g),c=d.find('input[type="submit"], .btn[data-type="submit"]');f=a.extend({positionMessage:false,removeForm:false,replaceFormWithMessage:false},f);e.options=f;e.voted=false;e.$form=d;c.click(function(s){if(!e.voted){var o=a(this),j=o.closest("form"),m=j.attr("action"),q=j.serializeArray(),p={},n,h;c.attr("disabled","disabled");j.addClass("busy");for(n=0,h=q.length;n<h;n++){p[q[n].name]=q[n].value}p[o.attr("name")]=o.val();a.ajax({url:m,type:"POST",data:p,dataType:"json",success:function(i){if(i.survey){e.showSurvey(i.survey,j.parent())}if(i.message){e.showMessage(i.message,o,j)}o.addClass("active");c.removeAttr("disabled");j.removeClass("busy");e.voted=true;if(!p.ignored){a(document).trigger("vote",a.extend(p,{url:m}))}e.$form.filter(function(){return this!==j}).remove()},error:function(){var i=gettext("There was an error submitting your vote.");e.showMessage(i,o);c.removeAttr("disabled");j.removeClass("busy")}})}a(this).blur();s.preventDefault();return false})},showMessage:function(h,f,e){var d=this,c=a('<div class="ajax-vote-box"><p class="msg"></p></div>'),i=f.offset();c.find("p").html(h);if(d.options.positionMessage){a("body").append(c);c.css({top:i.top-c.height()-30,left:i.left+f.width()/2-c.width()/2});var j=setTimeout(g,10000);a("body").one("click",g)}else{if(d.options.replaceFormWithMessage){e.replaceWith(c.removeClass("ajax-vote-box"))}else{f.parent().parent().addClass(f.val()).append(c)}}function g(){c.fadeOut(function(){c.remove()});if(d.options.removeForm){d.$form.fadeOut(function(){d.$form.remove()})}a("body").unbind("click",g);clearTimeout(j)}},showSurvey:function(j,m){var d=a(j);var n=d.find("#remaining-characters");var i=d.find("textarea");var h=parseInt(n.text(),10);var g=d.find("input[type=radio][name=unhelpful-reason]");var f=d.find("input[type=submit], .btn[data-type=submit]");var c=d.find(".disabled-reason");var e=d.find("textarea");m.after(d);if(m.closest("aside").length){m.remove()}f.prop("disabled",true);function l(){var p=g.filter(":checked").val();var o=e.val();if(p===undefined||((p==="other"||p==="firefox-feedback")&&!o)){f.prop("disabled",true);c.fadeIn(600)}else{f.prop("disabled",false);c.fadeOut(600)}}i.bind("input",function(){var o=i.val().length;var p;if(h-o>=0){n.text(h-o)}else{n.text(0);i.val(i.val().substr(0,h))}l()});g.bind("change",l);new k.AjaxVote(d.find("form"),{replaceFormWithMessage:true})}};window.k=window.k||{};window.k.AjaxVote=b})(jQuery);(function(b){function a(d,c){a.prototype.init.call(this,d,c)}a.prototype={init:function(e,m){var l=this,j=b(e),d=m||{},h=d.previewUrl||j.data("preview-url"),f=(d.previewElement&&b(d.previewElement))||b("#"+j.data("preview-container-id")),c=(d.contentElement&&b(d.contentElement))||b("#"+j.data("preview-content-id")),g=j.closest("form").find("input[name=csrfmiddlewaretoken]").val(),i=d.changeHash===undefined?true:d.changeHash;j.click(function(n){n.preventDefault();b(this).attr("disabled","disabled");b(l).trigger("get-preview")});b(l).bind("get-preview",function(n){b.ajax({url:h,type:"POST",data:{content:c.val(),csrfmiddlewaretoken:g},dataType:"html",success:function(o){b(l).trigger("show-preview",[true,o])},error:function(){var o=gettext("There was an error generating the preview.");b(l).trigger("show-preview",[false,o])}})});b(l).bind("show-preview",function(o,p,n){f.html(n);if(i){document.location.hash=f.attr("id")}j.removeAttr("disabled");b("img.lazy").loadnow();b(l).trigger("done",[p])})}};window.k=window.k||{};window.k.AjaxPreview=a})(jQuery);(function(g){function p(){var z=g("body");g("select.enable-if-js").removeAttr("disabled");q();b();if(z.is(".document")){g("#support-search input[name=q]").val(k.unquote(g.cookie("last_search")));ShowFor.initForTags();d();new k.AjaxVote(".document-vote form",{positionMessage:true});f()}else{if(z.is(".review")){ShowFor.initForTags();v();g("img.lazy").loadnow();g("#actions input").removeAttr("disabled")}}if(z.is(".edit, .new, .translate")){g("#id_comment").keypress(function(A){if(A.which==13){g(this).blur();g(this).closest("form").find("input[type=submit]").focus().click();return false}});c();j();s();t();v();e();m();y();g("img.lazy").loadnow();g(".submit input").removeAttr("disabled")}if(z.is(".translate")){h()}i();a();Marky.createFullToolbar(".editor-tools","#id_content");l();w();g("img.lazy").lazyload()}function b(){if(!("open" in document.createElement("details"))){document.documentElement.className+=" no-details"}if(!("open" in document.createElement("details"))){g("details").each(function(){var z=g(this),B=g("summary",z),A=z.children(":not(summary)"),C=z.contents(":not(summary)");if(!B.length){B=g(document.createElement("summary")).text("Details").prependTo(z)}if(A.length!==C.length){C.filter(function(){return(this.nodeType===3)&&(/[^\t\n\r ]/.test(this.data))}).wrap("<span>");A=z.children(":not(summary)")}if(typeof z.attr("open")!=="undefined"){z.addClass("open");A.show()}else{A.hide()}B.attr("tabindex",0).click(function(){B.focus();if(typeof z.attr("open")!=="undefined"){z.removeAttr("open")}else{z.attr("open","open")}A.slideToggle();z.toggleClass("open")}).keyup(function(D){if(13===D.keyCode||32===D.keyCode){if(!(g.browser.opera&&13===D.keyCode)){D.preventDefault();B.click()}}})})}}function o(){function z(B,A){if((B===undefined)||(A===undefined)||!VERSIONS[B]){return}for(var C=0;C<VERSIONS[B].length;C++){if(A<VERSIONS[B][C][0]){return B+VERSIONS[B][C][1]}}}return z(BrowserDetect.browser,BrowserDetect.version)}function q(){var z={title:{id:"#id_slug",dependency_ids:["#id_title"],dependency_list:["#id_title"],maxLength:50}};g.each(z,function(A,B){g(B.id).addClass("prepopulated_field");g(B.id).data("dependency_list",B.dependency_list).prepopulate(g(B.dependency_ids.join(",")),B.maxLength)})}function e(){var A=g("#remaining-characters"),B=g("#id_summary"),C=160,D=A.text(),z=function(){var E=B.val().length;A.text(C-E);if(C-E>=0){A.css("color","black")}else{A.css("color","red");if(E>=D){B.val(B.val().substr(0,D))}}};z();B.bind("input",z)}function c(){var A=g("#preview"),z=g("#preview-bottom"),B=new k.AjaxPreview(g(".btn-preview"),{contentElement:g("#id_content"),previewElement:A});g(B).bind("done",function(C,D){if(D){z.show();ShowFor.initForTags();A.find("select.enable-if-js").removeAttr("disabled");A.find(".kbox").kbox();k.initVideo();g("#preview-diff .output").empty()}})}function j(){var z=g("#preview-diff"),A=g("#preview-bottom"),B=g(".btn-diff");z.addClass("diff-this");B.click(function(){z.find(".to").text(g("#id_content").val());k.initDiff(z.parent());A.show();g("#preview").empty()})}function s(){g("#id_title").change(function(){var E=g(this),D=E.closest("form"),F=E.val(),C=g("#id_slug").val();z(F,D);A(C,D)});g("#id_slug").change(function(){var E=g(this),D=E.closest("form"),C=g("#id_slug").val();A(C,D)});function z(E,C){var D=gettext("A document with this title already exists in this locale.");B("title",E,g("#id_title"),C,D)}function A(D,C){var E=gettext("A document with this slug already exists in this locale.");B("slug",D,g("#id_slug"),C,E)}function B(D,H,E,C,F){E.removeClass("error");E.parent().find("ul.errorlist").remove();var G={};G[D]=H;g.ajax({url:C.data("json-url"),type:"GET",data:G,dataType:"json",success:function(J){var I=C.data("document-id");if(!I||(J.id&&J.id!==parseInt(I))){E.addClass("error");E.before(g('<ul class="errorlist"><li/></ul>').find("li").text(F).end())}},error:function(J,I){if(J.status===404){}else{}}})}}function f(){var z=g("#banner"),A={top:-100},B={top:-10};if(z.length>0){setTimeout(function(){z.css({display:"block"}).css(A).animate(B,500).find("a.close").click(function(C){C.preventDefault();z.animate(A,500,"swing",function(){z.css({display:"none"})})})},500)}}function t(){var z=g("#submit-modal"),A=z.data("kbox");A.updateOptions({preOpen:function(){var B=g(".btn-submit").closest("form")[0];if(B.checkValidity&&!B.checkValidity()){z.find('button[type="submit"]').click();return false}z.find("#id_comment").attr("required",true);return true},preClose:function(){z.find("#id_comment").removeAttr("required");return true}})}function a(){g("div.revision-diff").each(function(){var z=g(this);z.find("div.picker a").unbind().click(function(A){A.preventDefault();g.ajax({url:g(this).attr("href"),type:"GET",dataType:"html",success:function(C){var B=new KBox(C,{modal:true,id:"diff-picker-kbox",closeOnOutClick:true,destroy:true,title:gettext("Choose revisions to compare")});B.open();u(B.$kbox.find("form"),B,z)},error:function(){var B=gettext("There was an error.");alert(B)}})})})}function u(z,B,A){z.submit(function(C){C.preventDefault();g.ajax({url:z.attr("action"),type:"GET",data:z.serialize(),dataType:"html",success:function(D){var E=A.parent();B.close();A.replaceWith(D);a();k.initDiff()}})})}function l(){var A=g("#revision-list div.l10n"),z,B;A.find("a.markasready").click(function(){var C=g(this);z=C.data("url");B=C.attr("id");g("#ready-for-l10n-modal span.revtime").html("("+C.data("revdate")+")")});g("#ready-for-l10n-modal input[type=submit], #ready-for-l10n-modal button[type=submit]").click(function(){var D=g("#ready-for-l10n-modal input[name=csrfmiddlewaretoken]").val(),C=g("#ready-for-l10n-modal").data("kbox");if(z!=undefined&&B!=undefined){g.ajax({type:"POST",url:z,data:{csrfmiddlewaretoken:D},success:function(E){g("#"+B).removeClass("markasready").addClass("yes");g("#"+B).unbind("click");C.close()},error:function(){C.close()}})}})}function d(){var z=k.getQueryParamsAsDict(),A=k.getReferrer(z),B=k.getSearchQuery(z,A);g(".document-vote form").append(g('<input type="hidden" name="referrer"/>').attr("value",A)).append(g('<input type="hidden" name="query"/>').attr("value",B))}function v(){var z=g("#id_needs_change"),A=g("#document-form li.comment,#approve-modal div.comment");if(z.length>0){B();z.change(B)}function B(){if(z.is(":checked")){A.slideDown();A.find("textarea").attr("required","required")}else{A.hide();A.find("textarea").removeAttr("required")}}}function n(){g(".watch-form").click(function(){var z=g(this);g.post(z.attr("action"),z.serialize(),function(){z.find(".watchtoggle").toggleClass("on")}).error(function(){});return false})}function i(){g("#quick-links .edit a").click(function(z){z.preventDefault();g("#doc-tabs").slideToggle("fast",function(){g("body").toggleClass("show-editing-tools")});if(g(this).is(".show")){g.cookie("show-editing-tools",1,{path:"/"})}else{g.cookie("show-editing-tools",null,{path:"/"})}})}function y(){window.highlighting={};var B=g("<div id='editor'></div>");var A=g("<div id='editor_wrapper'></div>");var z=function(){var F=window.highlighting.session;if(!F){return}var E=g("#id_content").val();F.setValue(E)};window.highlighting.updateEditor=z;var C=g("<a></a>").text(gettext("Toggle syntax highlighting")).css({cssFloat:"right",cursor:"pointer"}).toggle(function(){A.css("display","none");g("#id_content").css("display","block")},function(){z();A.css("display","block");g("#id_content").css("display","none")});var D=function(){return A.css("display")=="block"};window.highlighting.isEnabled=D;A.append(B);g("#id_content").after(C).after(A).hide();window.addEventListener("load",function(){var E=ace.edit("editor");window.highlighting.editor=E;var F=E.getSession();window.highlighting.session=F;F.setMode("ace/mode/sumo");F.setUseWrapMode(true);g("#id_content").bind("keyup",z);z();F.on("change",function(G){if(!D()){return}g("#id_content").val(F.getValue())})},false)}function m(){var A=g("#edit-document");if(!A.length){A=g("#localize-document")}if(A.is(".locked")){var z=A.find("input:enabled, textarea:enabled").prop("disabled",true)}g("#unlock-button").on("click",function(){z.prop("disabled",false);A.removeClass("locked");g("#locked-warning").slideUp(500);var C=A.data("slug");var B=window.location.toString();B=B.replace(/edit/,"steal_lock");g.ajax({url:B})})}function h(){var z=g("#content-diff");var A=g("#content-or-diff");if(z.length>0){A.append(z.clone()).append(g("<a/>").text(gettext("Toggle Diff")).click(function(B){B.preventDefault();A.toggleClass("content diff")}))}}function w(){var z=g("#revision-list form.filter");if(!z.length){return}function A(D){if(D===undefined){D=z.serialize()}if(D.charAt(0)!=="?"){D="?"+D}var C=z.attr("action")+D;var E=Math.min(g(document).scrollTop(),g("#revision-list").offset().top);g(document).scrollTop(E);history.replaceState({},"",C);g("#revisions-fragment").css("opacity",0);g.get(C+"&fragment=1",function(F){g(".loading").hide();g("#revisions-fragment").html(F).css("opacity",1)})}var B;z.on("change keyup","input, select",function(){g(".loading").show();clearTimeout(B);B=setTimeout(A,200)});g("#revision-list").on("click",".pagination a",function(){var C=g(this)[0].search;A(C);return false});g("#revision-list").on("click",".show-diff",function(){var E=g(this);E.hide();E.parent().find(".loading").show();var D=g('<div class="diff-view">').hide().appendTo(g(this).parents("li").first());var C=E.attr("href");g.get(C,function(F){D.html(F);D.find(".picker").html('<a href="" class="close-diff">Close diff</a>');D.slideDown();E.parent().find(".close-diff").show();E.parent().find(".loading").hide();k.initDiff()});return false});g("#revision-list").on("click",".close-diff",function(){var C=g(this).parents("li").first();C.find(".diff-view").slideUp(400,function(){C.find(".show-diff").show();C.find(".close-diff").hide();C.find(".diff-view").remove()});return false});z.find(".btn").remove();z.on("keydown",function(C){if(C.which===13){return false}});z.find("input[type=date]").datepicker()}g(document).ready(p);window.k.makeWikiCollapsable=function(){g("#toc").hide();g("#doc-content h1").each(function(){var E=g(this);var A=g(this).nextAll();var D=[];A.each(function(){if(g(this).is("h1")){return false}D.push(this)});var B=g("<div />");B.addClass("wiki-section").addClass("collapsed");E.before(B);B.append(E);var C=g("<section />");B.append(C);for(var z=0;z<D.length;z++){C.append(D[z])}});g("#doc-content").on("click","h1",function(){g(this).closest(".wiki-section").toggleClass("collapsed")});g("#doc-content h1:visible").first().click()}}(jQuery));(function(j){function n(){f();b();c();i()}function f(){j("div.tags[data-tag-vocab-json]").each(function(){var q=j(this);var p=q.data("tag-vocab-json");q.data("tagVocab",_.keys(p))})}function c(){function q(v){var A=v.find("input.adder"),z=v.find("input.autocomplete-tags"),t=z.closest("div.tags"),s=t.data("can-create-tags")!==undefined,w=t.data("tagVocab"),u=e(z);function y(){var D=j.trim(z.val()),C=h(D,w)!=-1,B=l(D,u);A.attr("disabled",!D.length||B||(!s&&!C))}return y}function p(v){var t=v.data("tagVocab"),s=v.find("ul.tag-list");function u(z,w){var y=g(s),A=j.grep(t,function(C,B){return j.inArray(C,y)==-1});w(d(A,z.term))}return u}j("input.autocomplete-tags").each(function(){var t=j(this),s=q(t.closest("form"));t.autocomplete({source:p(t.closest("div.tags")),delay:0,minLength:1,close:s});t.keyup(s);t.bind("autocompletechange",s)})}function i(){j("div.tags").each(function(){var p=j(this),q=!p.hasClass("deferred");p.find(".tag").each(function(){o(j(this),q)})});j("form.remove-tag-form").submit(function(){return false})}function o(p,q){p.find(".remover").click(function(){var u=j(this),t=u.closest(".tag"),w=t.find(".tag-name").text(),y=u.closest("form").find("input[name=csrfmiddlewaretoken]").val();function v(){t.remove()}if(q){t.addClass("in-progress");j.ajax({type:"POST",url:u.closest("form.remove-tag-form").data("action-async"),data:{name:w,csrfmiddlewaretoken:y},success:v,error:function s(){t.removeClass("in-progress")}})}else{v()}return false})}function a(B,u){var A=B.find("input.autocomplete-tags"),s=A.val(),t=A.closest("div.tags").data("tagVocab"),z=h(s,t),q=B.find("input[name=csrfmiddlewaretoken]").val(),y;function p(C){var D=e(A);if(!(l(C,D))){var F=j("<li class='tag'><span class='tag-name' /><input type='submit' value='&#x2716;' class='remover' /></li> ");if(u){F.addClass("in-progress")}else{var E=j("<input type='hidden' />");E.attr("value",C);E.attr("name",A.attr("name"));F.prepend(E);o(F,false)}F.find(".tag-name").text(C);F.find("input.remover").attr("name","remove-tag-"+C);D.append(F);return F}}if(z==-1){if(u){t.push(s)}}else{s=t[z]}y=p(s);if(y&&u){j.ajax({type:"POST",url:B.data("action-async"),data:{"tag-name":s,csrfmiddlewaretoken:q},success:function v(D){var C=D.tagUrl,E=y.find(".tag-name");E.replaceWith(j("<a class='tag-name' />").attr("href",C).text(E.text()));y.removeClass("in-progress");o(y,true)},error:function w(C){y.remove()}})}A.val("");B.find("input.adder").attr("disabled",true);return false}function b(){j("div.tags input.adder:enabled").attr("disabled",true);j(".tag-adder").each(function(){var s=j(this),q=!s.hasClass("deferred");function p(){return a(s,q)}if(s.is("form")){s.submit(p)}else{s.find("input.adder").click(p)}})}function e(p){return p.closest("div.tags").find("ul.tag-list")}function m(p){return p.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")}function d(s,p){var q=new RegExp(m(p),"i");return j.grep(s,function(t){return q.test(t.label||t.value||t)})}function h(t,q){var s=new RegExp("^"+m(t)+"$","i");for(var p=0;p<q.length;p++){if(s.test(q[p])){return p}}return -1}function g(q){var p=[];q.find(".tag .tag-name").each(function(s,t){p.push(j(t).text())});return p}function l(p,q){return h(p,g(q))!=-1}j(document).ready(n)}(jQuery));(function(c){function f(){e();b();a();d()}function e(){c(".readout-modes").each(function g(){var i=c(this),h=i.attr("data-slug");i.find(".mode").each(function(){var j=c(this);j.click(function l(){var m=c("#"+h+"-table");m.addClass("busy");i.find(".mode").removeClass("active");j.addClass("active");c.get(j.attr("data-url"),function n(o){m.html(o).removeClass("busy")});return false})})})}function b(){var h=c("#doc-watch"),i=h.find(".popup-menu");h.find(".popup-trigger").click(function j(){i.toggle()});h.find("input[type=checkbox]").click(function g(){var m=c(this),l=m.closest("form").find("input[name=csrfmiddlewaretoken]").val(),n=m.attr("checked");m.attr("disabled","disabled");c.ajax({type:"POST",url:n?m.data("action-watch"):m.data("action-unwatch"),data:{csrfmiddlewaretoken:l},success:function(){m.attr("disabled","")},error:function(){m.attr("checked",n?"":"checked").attr("disabled","")}})})}function a(){c("#need-changes-table tr").click(function(g){if(!c(g.target).is("a")){c(this).toggleClass("active")}})}function d(){var g=c("#create-announcement form");g.find("button.btn-submit").on("click",function(i){i.preventDefault();var h=c("#create-announcement .kbox");g.addClass("wait");g.find(".error").remove();c.ajax({type:"POST",url:g.prop("action"),data:g.serialize(),statusCode:{200:function(l){g.removeClass("wait");h.hide(200,function(){h.data("kbox").close();h.show()});var j=c("#create-announcement").children(".success").show().css({opacity:1});setTimeout(function(){j.animate({opacity:0},1000)},4000)},400:function(n){var j,m;g.removeClass("wait");try{j=JSON.parse(n.responseText)}catch(l){j={}}for(m in j){g.find("[name="+m+"]").parent().after('<li class="error">'+j[m]+"</li>")}}}})});c(".announcements li a.delete").on("click",function(h){h.preventDefault();var i=c(this);c.ajax({type:"POST",url:i.prop("href"),data:{csrfmiddlewaretoken:c("input[name=csrfmiddlewaretoken]").val()},success:function(){i.closest("li").remove()}})})}c(document).ready(f)}(jQuery));(function(b){function a(){b(".editable a.edit").each(function(){var c=b(this),d=c.text();c.click(function(e){var f=c.closest(".editable");f.toggleClass("edit-on");if(f.hasClass("edit-on")){c.text(gettext("Cancel"))}else{c.text(d)}e.preventDefault()})})}b(document).ready(a)}(jQuery));(function(a){function b(){if(!a("body").is(".document")){return}a(document).on("vote",function(e,g){var f;if(_gaq){if("helpful" in g){f="Helpful"}else{if("not-helpful" in g){f="Not Helpful"}else{return}}_gaq.push(["_trackEvent","Article Vote",g.source+" - "+f,c()+" / "+d()])}});a("#os").change(function(){if(_gaq){_gaq.push(["_trackEvent","ShowFor Switch","OS - "+a(this).val(),c()+" / "+d()])}});a("#browser").change(function(){if(_gaq){_gaq.push(["_trackEvent","ShowFor Switch","Version - "+a(this).val(),c()+" / "+d()])}});setTimeout(function(){if(_gaq){_gaq.push(["_trackEvent","Article Read",c()+" / "+d()])}},10000);function d(){return a("html").attr("lang")}function c(){return a("body").data("default-slug")}}a(document).ready(b)}(jQuery));