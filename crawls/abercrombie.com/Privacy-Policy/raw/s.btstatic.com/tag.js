window.BrightTag=function(b){function l(a,b){return Object.prototype.toString.call(a)==="[object "+b+"]"}if(b)return bt_log("tried to load tag.js again"),b;var b={pushIfDefined:function(a,b,d){a&&(a.constructor==Array&&null!=b)&&a.push(d||b)},trim:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},Escaper:{cookie:function(a){return!p.isString(a)?a:a.replace(/%/g,"%25").replace(/#/g,"%23").replace(/&/g,"%26").replace(/'/g,"%27").replace(/;/g,"%3B").replace(/</g,"%3C").replace(/>/g,"%3E")},
javascript:function(a){return!p.isString(a)?a:a.replace(/\\/g,"\\\\").replace(/'/g,"\\x27").replace(/"/g,"\\x22").replace(/\n/g,"\\n").replace(/\r/g,"\\r")}},Random:{integer:function(a){return Math.floor(Math.random()*(a||1E8))}},defaultConfig:function(){return{loadOnly:!1,window:window,document:document,host:"s.thebrighttag.com",parentReferrer:top!=self?self.window.location.href:null,docReferrer:document.referrer,data:{},errorManager:new b.ErrorManager(new b.HTTP.Cookie(document))}}},u=b.eval=function(a,
b){try{return eval.call(void 0,a)}catch(d){b&&b(d)}},q=b.extend=function(a,b){for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);return a},p=b.Types={isString:function(a){return l(a,"String")},isArray:function(a){return l(a,"Array")},isNumber:function(a){return l(a,"Number")},isFunction:function(a){return l(a,"Function")},isObject:function(a){return null===a||void 0===a?!1:l(a,"Object")}},o=b.each=function(a,b){if(a)if(p.isArray(a)||a.length)for(var d=0,e=a.length;d<e;d++)b(a[d],d);else if(p.isObject(a))for(d in a)a.hasOwnProperty(d)&&
b(d,a[d])};b.Blab={};b.Blab.Engine=function(a){function b(){v=!0;r=x.length;k("engine:off")}function d(){v=!1;n=0;(x[r++]||b)()}function e(){k("block:finish");d()}function c(c){return function(){var f=!1,h=a.createElement("script");h.onload=h.onreadystatechange=function(){var a;if(!(a=f)){a:{switch(h.readyState){case void 0:case "loaded":case "complete":a=!0;break a}a=!1}a=!a}a||(f=!0,e())};h.onerror=function(){k("block:error",{type:"script",exception:"Problem loading "+c});f||e()};h.src=c;k("block:start",
c);var g=a.getElementsByTagName("script")[0];g.parentNode.insertBefore(h,g)}}function f(c){return function(){try{k("block:start",c),c.constructor==String?a.defaultView?a.defaultView.eval.call(void 0,c):a.parentWindow?a.parentWindow.execScript(c):k("block:error",{type:"wait",exception:"Could not evaluate wait block ["+c+"]"}):c()}catch(f){k("block:error",{type:"wait",exception:f})}finally{e()}}}function h(a){x.push(a);v&&d();return g}function j(a){x.splice(r+n++,0,a);return g}function k(a){var c=Array.prototype.slice.call(arguments,
1);o(z,function(f){var h=[g].concat(c);(f[a]||s).apply(null,h)})}var g=this,s=function(){},z=[],v=!1,m={},x=[],r=0,n=0;g.run=function(){k("engine:on");d()};g.options=function(a){q(m,a);return g};g.option=function(a){return m[a]};g.script=function(a){return h(c(a))};g.wait=function(a){return h(f(a))};g.preemptScript=function(a){return j(c(a))};g.preemptWait=function(a){return j(f(a))};g.listen=function(a){z.push(a);(a["engine:listen"]||s).apply(null,[g]);return g}};b.Blab.Group=function(){function a(a){c.push(a)}
function b(a){a.run()}function d(){var a=c[f++];a?a.listen(h).run():e.doNotQueue()}var e=this,c=[],f=0,h={"engine:off":function(){d()}};e.doNotQueue=function(){a=b};e.push=function(c){a(c);return c};e.run=function(){d()};e.applyListener=function(a){for(var h=f,g=c.length;h<g;h++)c[h].listen(a)}};b.Blab.Manager=function(a){function i(f){var h=new d.Engine(a);o(c,function(a){h.listen(a)});return(e[f]||(e[f]=new d.Group)).push(h)}var d=b.Blab,e={undefined:new d.Group},c=[];e[void 0].doNotQueue();this.addGlobalListener=
function(a){c.push(a);o(e,function(c){e[c].applyListener(a)})};this.group=function(a){return i(a)};this.listen=function(){return i().listen.apply(null,arguments)};this.script=function(){return i().script.apply(null,arguments)};this.wait=function(){return i().wait.apply(null,arguments)};this.run=function(a){(e[a]||(e[a]=new d.Group)).run()};this.setOptions=function(){return i()}};var t,y=[],A=function(a){t.push(a)};b.Blab.SwapwriteListener=function(a){function b(a){a.src&&e.preemptScript(a.src);a.innerHTML&&
e.preemptWait(a.innerHTML)}function d(c){try{a.body.appendChild(c.cloneNode(!0))}catch(h){bt_log("error appending content to body: "+h)}}var e,c=a.createElement("div");this["block:start"]=function(){var c=a;y.push([t,c.write,c.writeln]);t=[];c.write=c.writeln=A};this["block:finish"]=function(){try{if(0!=t.length){c.innerHTML="<br/>"+t.join("");for(var f=c.childNodes||[],h=1,j=f.length;h<j;h++)("SCRIPT"==f[h].tagName?b:d)(f[h])}}finally{f=a,h=y.pop(),t=h[0],f.write=h[1],f.writeln=h[2]}};this["engine:listen"]=
function(a){e=a}};b.Blab.GlobalSwapwriteListener=function(a){var i=b.Blab;this["engine:listen"]=function(b){b.listen(new i.SwapwriteListener(a))}};b.EventsManager=function(){function a(){}function i(a,c,d){f(a,c,function(){(!d||d())&&b.EventListenerOverride(a,c)})}function d(a){var c=a.readyState;if("loading"==c)return!1;if("complete"==c)return!0;if(a.addEventListener)return"interactive"==c;a:{a=a.documentElement.doScroll||function(){throw"No doScroll";};try{a("left")}catch(b){a=!1;break a}a=!0}return a}
function e(a,c,b){var g=this;setTimeout(function(){a()?c.call(g):e(a,c,b)},b)}var c=this,f=c.listen=function(a,c,b){a.addEventListener?a.addEventListener(c,b,!1):a.attachEvent&&a.attachEvent("on"+c,b)};c.domReady=function(a,c){d(a)?c.call(this):a.addEventListener?f(a,"DOMContentLoaded",c):e(function(){return d(a)},c,1)};c.enablePageReadyOverrides=function(f,d){c.enablePageReadyOverrides=a;"complete"==d.readyState?b.EventListenerOverride(f,"load"):i(f,"load");if(d.addEventListener){var k=d.readyState;
"complete"==k||"interactive"==k?b.EventListenerOverride(d,"DOMContentLoaded"):i(d,"DOMContentLoaded")}}};b.EventListenerOverride=function(a,b){function d(a){var c=this;setTimeout(function(){try{a.call(c)}catch(d){bt_log("error overriding "+b+" event: "+d)}},0)}var e=a.addEventListener?"addEventListener":"attachEvent",c=a[e];a[e]=function(f,h,j){if("function"==typeof h)if(f==b||f=="on"+b)d(h);else try{"addEventListener"==e?c.call(a,f,h,j):c(f,h)}catch(k){bt_log("error proxying "+f+" event: "+k)}}};
b.Events=new b.EventsManager;b.EventBindingManager=function(a,i){function d(a,c){o(c,function(c,b){a[a.type+"."+c]=b});i.push(a)}function e(a){function b(a){var c=this,d=[];c.appendData=function(a){d.push(function(c){c.appendData(a)});return c};c.appendJs=function(a){d.push(function(c){c.appendJs(a)});return c};c.postProcess=function(a){o(d,function(c){c(a)})};c.tagId=a;c.execute=f.execute;c.fire=f.fire;c.evaluate=f.evaluate}var f=this,e=[],j=[],m="true";f.execute=function(c,b){var g=q({eventName:a},
b||{});if(p.isFunction(c))e.push(q(c,g));else if(p.isString(c))try{var j=h.functionWithAccess(["eventObject","eventData"],c);e.push(q(j,g))}catch(m){d({type:"evparse",message:"event handler parsing: "+m,tagId:g.tagId||-1},{eventName:a})}else bt_log("when.execute: unknown action: "+c);return f};f.evaluate=function(a){m=a;return f};f.fire=function(a){a=new b(a);j.push(a);return a};f.handler=function(a,b){var f=m;u(m,function(a){bt_log("Invalid post-event conditional fire expression: "+f+", exception = "+
a)})&&(c.executeActions(e,a,b),c.fireTags(j))}}var c={},f={},h=b.jQueryLoader(a,"BrightTag.jQuery");c.Binder=function(a,c){var e=this,j=[],i=c||{};e.data=function(a,c){j.push({name:a,dbe:c});return e};e.bindData=function(c,f,g){o(j,function(e){try{b.instance.data(e.name,h.functionWithAccess(["eventObject","eventData"],"return "+e.dbe+";").call(c,f,g))}catch(j){d({type:"evdbe",message:j.toString(),pageId:i.pageId||-1},{name:e.name,eventName:a})}})};e.handler=function(c){var b=f[a];if(b){var d=Array.prototype.slice.call(arguments,
1);e.bindData(c.target,c,d);b.handler(c,d)}}};var j=/^direct\//i;c.bind=function(a,b,f,d){var e=new c.Binder(a,d);h.ensureJQuery(function(){var a=h.getJQuery()(b);a.live&&b.constructor===String&&!j.test(f)?a.live(f,e.handler):a.bind(f.split(j).pop(),e.handler)});return e};c.when=function(a){return f[a]||(f[a]=new e(a))};c.executeActions=function(a,c,b){o(a,function(a){try{a.call(c.target,c,b)}catch(f){d({type:"evwait",message:"event handler running: "+f.toString(),tagId:a.tagId||-1},{eventName:a.eventName})}})};
c.fireTags=function(a){if(0<a.length){var c=b.instance.serverURL();o(a,function(a){c.cf(a.tagId);a.postProcess(c)});b.Blab.script(c.asString())}};return c};b.HTTP={};b.HTTP.Cookie=function(a){function i(a){for(var b,d,a=a.split(/; ?/),j=0,k=a.length;j<k;j++){d=a[j];b=d.indexOf("=");var g=e,i=d.slice(0,b);b=d.slice(b+1);b=unescape(b);g[i]=b}}var d=this,e={};d.get=function(a){return e[a]};d.remove=function(a,b){d.set(a,"",q(b||{},{expires:0}))};d.set=function(c,d,e){if(c){e=e||{};c=[c+"="+b.Escaper.cookie(d||
"")];if((d=e.expires)||0===d)p.isNumber(d)&&(d=(new Date(d)).toGMTString()),c.push("expires="+d);(d=e.path)&&c.push("path="+d);(d=e.domain)&&c.push("domain="+d);!0===e.secure&&c.push("Secure");!0===e.httponly&&c.push("HttpOnly");e=c.join(";");if(4096>e.length)a.cookie=e;else throw{name:"CookieTooLongError",message:"Cookie reached 4096 byte limit"};i(a.cookie)}};d.findEach=function(a,b){for(key in e)e.hasOwnProperty(key)&&key.match(a)&&b(key,e[key])};i(a.cookie||"")};b.HTTP.QueryString=function(a){function b(a){if(a&&
"string"==typeof a){var d=a.split("&"),a={};o(d,function(b){var d=b.split("="),b=decodeURIComponent(d[0]),d=d[1]&&decodeURIComponent(d[1].replace(/\+/g," "));a[b]=d})}return a}var d=this,e={};q(e,b(a));d.param=function(a){return e[a]||""};d.params=function(){return e};d.appendParam=function(a,b){a&&(void 0!=b&&""!==b)&&(e[a]=b);return this};d.appendParams=function(a){o(a,d.appendParam);return this};d.alwaysAppendParam=function(a,b){a&&(e[a]=void 0!=b?b:"");return this};d.alwaysAppendParams=function(a){o(a,
d.alwaysAppendParam);return this};d.appendPartialQueryString=function(a){a&&d.alwaysAppendParams(b(a));return this};d.deleteParam=function(a){delete e[a]};d.toString=function(){var a=[],b;for(b in e){var d=encodeURIComponent(b),j=encodeURIComponent(e[b]);a.push(d+"="+j)}return a.join("&")}};b.HTTP.URL=function(a){var i=this,d,e,c,f=a.indexOf("#");-1<f&&(c=a.substring(f+1),a=a.substring(0,f));f=a.indexOf("?");-1<f&&(e=a.substring(f+1),a=a.substring(0,f));d=a;a=new b.HTTP.QueryString(e);q(i,a);i.queryString=
a.toString;i.toString=function(){var a=i.queryString();return d+(a.length>0?"?"+a:"")};i.asString=i.toString;i.fragment=function(){return c}};b.ServerURL=function(a){function i(a,c){return function(b){bt_log("invalid "+a+" expression: "+c+", exception = "+b)}}var d=this,e=a.host,c=a.window,f=a.parentReferrer,h=a.referrer,j="";0<e.length&&(j=(e.match("^[a-z0-9+.-]+://.+")?"":"//")+e+"/tag");b.HTTP.URL.call(this,j);d.appendParams({site:a.site,referrer:h,docReferrer:a.docReferrer,mode:a.mode});h!==f&&
d.appendParam("parentReferrer",f);d.appendData=function(a){var b=bt_data(a),e;a:switch(Object.prototype.toString.apply(b)){case "[object Array]":case "[object Object]":e=!0;break a;default:e=!1}b=e?c.JSON.stringify(b):b;return d.alwaysAppendParam("_cb_"+("bt_data('"+a+"')"),b)};d.appendJs=function(a){var b=i("inline JavaScript",a);return d.alwaysAppendParam("_cb_"+a,u(a,b))};d.cf=function(a){a.constructor!=Array&&(a=[a]);var b=d.param("cf");b&&(a=Array(b).concat(a));d.appendParam("cf",a.join());return d};
d.addCf=function(a,b){if(!u(b,i("conditional fire",b)))return!1;var c=d.param("cf");d.appendParam("cf",c?c+","+a:a);return!0}};b.Page=function(a,i){function d(a){o(p.isArray(a)?a:[a],function(a){p.isFunction(a)?a():m.write('<script type="text/javascript" src="'+a+'"><\/script>')})}function e(a){var b=r.group().options({tagId:-2});o(p.isArray(a)?a:[a],function(a){(p.isFunction(a)?b.wait:b.script)(a)})}function c(a){m.write(a)}function f(a,b){var c={};b&&b.tagId&&(c.tagId=b.tagId);r.group(!w?"domready":
void 0).options(c).wait(function(){m.write(a)})}function h(a){o(a,function(a){if(a.name){var b=q({},a);delete b.name;delete b.value;t.set(a.name,a.value,b)}})}function j(b){n.hasErrors()&&(b.appendParam("errors",n.toJSON()),2083<b.toString().length&&(b.deleteParam("errors"),n.tooManyErrors(),b.appendParam("errors",n.toJSON())));n.reset({site:a.site,referrer:a.referrer||m.location.href})}function k(a){(new b.HTTP.Cookie(m)).findEach(/^btps\..+/,function(b,c){a.appendParam(b,c)})}var g=this,s=void 0,
l=a.data||{},v=void 0,m=a.document||{},x=a.window||{},r=a.blab||b.Blab,n=a.errorManager,t=a.store,w=!1;g.referrer=a.referrer;g.parentReferrer=a.parentReferrer;g.docReferrer=a.docReferrer;g.site=a.site;g.host=a.host;n&&r.addGlobalListener(n);var y="sync"===a.mode;g.writeScript=y?d:e;g.appendContent=y?c:f;g.domReady=function(){w=!0;r.addGlobalListener(new r.GlobalSwapwriteListener(m));"sync"===a.mode&&(g.writeScript=e,g.appendContent=f);r.run("domready")};g.parameter=function(a){void 0==s&&(s=new b.HTTP.URL(m.location.href));
return s.param(a)};g.meta=function(a){v||(v={},o(m.getElementsByTagName("meta"),function(a){v[a.getAttribute("name")]=a.getAttribute("content")}));return v[a]||""};g.cookie=function(a){return(new b.HTTP.Cookie(m)).get(a)||""};g.data=function(a,b){if(void 0!==b)return l[a]=b;b=l[a];return void 0==b?"":b};g.dbe=function(a,b,c){g.data(a,u(b,function(b){n&&n.push({type:"dbe",message:b.toString(),"dbe.name":a,pageId:(c||{}).pageId||-1})}))};g.errors=function(a){n.configure(a)};g.store=t?h:function(){};
g.serverURL=function(){return new b.ServerURL(a)};g.defaultBaseUri=function(){return("https:"==m.location.protocol?"https:":"http:")+"//s.btstatic.com/"};g.baseUri=function(){var a=/\btag(\.[^.]+|-n)?\.js(#.*)?$/;return i&&i.src&&i.src.replace(a,"")||g.defaultBaseUri()};g.primary=function(){var a=[];x.JSON||a.push(g.baseUri()+"json2.js");a.push(function(){var a=g.serverURL();k(a);n&&(n.processStoredErrors(),j(a));return a.toString()}());g.writeScript(a)};g.secondary=function(a){var b=g.serverURL(),
c=b.toString();a(b);b.toString()!=c&&(k(b),n&&j(b),g.writeScript(b.toString()))}};b.ErrorManager=function(a,b){function d(b){k.push(e(b));a.set(g,c.toJSON(),{path:"/"})}function e(a){var b=p.isObject(a)?q({},a):{};b.type=b.type||"unknown";b.message=b.message||a.toString();b.timestamp=s;return b}if(!a)throw"ErrorManager requires a store";var c={},f,h,j=!0,k=[],g="__bterr",s=+new Date,l=c.configure=function(a){a.hasOwnProperty("enabled")&&(j=a.enabled);a.hasOwnProperty("timestamp")&&(s=a.timestamp);
a.hasOwnProperty("site")&&(f=a.site);a.hasOwnProperty("referrer")&&(h=a.referrer)};b&&l(b);c.reset=function(b){b&&l(b);k=[];a.remove(g);a.remove(g,{path:"/"})};c.hasErrors=function(){return 0<k.length};c.toArray=function(){return k};c.toJSON=function(){try{return JSON.stringify({site:f,referrer:h,errors:k})}catch(a){bt_log("problem serializing errors: "+a.message)}};c.push=function(a){bt_log("error: "+JSON.stringify(a));if(j&&a&&!(-1>a.tagId||-1>a.pageId))try{d(a)}catch(b){if("CookieTooLongError"!=
b.name)throw b;c.tooManyErrors()}};c.tooManyErrors=function(){c.reset();d({type:"runtime",message:"Too many errors"})};c["block:error"]=function(a,b){if(b){var d=b.type,e=b.exception||b,f=a.option("tagId")||-1;c.push({type:d,message:e.toString(),tagId:f})}};c.processStoredErrors=function(){var b=a.get(g);if(b)try{var c=JSON.parse(b);f=c.site;h=c.referrer;p.isArray(c.errors)&&(k=k.concat(c.errors))}catch(d){bt_log("problem reading stored errors: "+d.message)}};return c};b.CookieSyncEngine=function(a){var i=
{fn:function(a){a()},next:null},d=i,e=a.document,c=function(a){if("function"!=typeof a)return!1;a={fn:a,next:null};d=d.next=a;return!0},f=function(){if(i){var a=i.fn;i=i.next;a(f)}},h=f;b.Events.listen(a,"load",h);return{sync:h,push:function(a){return c(a)},pushImage:function(b){return c(function(c){var d=new a.Image;d.onerror=d.onload=c;d.src=b})},pushIframe:function(a){return c(function(b){var c=e.createElement("iframe");c.onerror=c.onload=b;c.width=0;c.height=0;c.style.border=0;c.src=a;e.body.appendChild(c)})}}};
b.jQueryLoader=function(a,i){return new function(a,e){function c(a){g.wait(a)}function f(a){function d(){i=b.jQuery;c(a)}k="var $ = BrightTag.$; ";b.jQuery?d():g.script(b.instance.baseUri()+"BrightTag.jquery-1.5.1.js").wait(d)}var h={},i=a.jQuery,k="",g=b.Blab.group(e);h.getJQuery=function(){return i};h.functionWithAccess=function(a,b){return new Function(a,k+b)};h.ensureJQuery=function(a){h.ensureJQuery=c;(i?c:f)(a);b.Blab.run(e)};return h}(a,i)};b.Main=function(a){var i=b.Events,d;a:{d=/\/tag(\.[^.]+|-n)?\.js(#.*)?$/;
for(var e=a.document.getElementsByTagName("script"),c=e.length-1;-1<c;c--){var f=e[c];if(d.test(f.src)){d=f;break a}}d=void 0}d&&((e=(new b.HTTP.URL(d.src)).fragment())&&q(a,(new b.HTTP.QueryString(e)).params()),e=function(a){bt_log("configuration error: "+a)},c=b.trim(d.innerHTML),0!==c.length&&q(a,u("(\n"+c+"\n)",e)));if(void 0!=a.site){i.enablePageReadyOverrides(a.window,a.document);try{var h=new b.Page(a,d);i.domReady(a.document,function(){h.domReady()});a.loadOnly||h.primary();return h}catch(j){bt_log("execution error: "+
j)}}};var w=b.defaultConfig();q(b.Blab,new b.Blab.Manager(w.document));b.$LAB=b.Blab;b.EventBinding=b.EventBindingManager(w.window,w.errorManager);b.CookieSync=b.CookieSyncEngine(w.window);b.instance=b.Main(w);return b}(window.BrightTag);function bt_parameter(b){return BrightTag.instance.parameter(b)}function bt_meta(b){return BrightTag.instance.meta(b)}function bt_cookie(b){return BrightTag.instance.cookie(b)}function bt_data(b,l){return BrightTag.instance.data(b,l)}window.bt_data_escaped=bt_data;
function bt_log(b){window.console&&console.log&&console.log("BrightTag: "+b)}var bt_handle_exception=bt_log,_bt_url_prefix,_bt_referrer,_bt_site,_bt_mode;function btServe(b){if(void 0==BrightTag.instance){var l=BrightTag,u=l.extend({referrer:_bt_referrer,site:_bt_site,mode:_bt_mode},l.defaultConfig());void 0!=_bt_url_prefix&&(u.host=_bt_url_prefix);l.instance=l.Main(l.extend(u,b||{}))}};
