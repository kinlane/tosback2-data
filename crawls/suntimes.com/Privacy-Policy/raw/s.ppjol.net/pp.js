var DEBUG=!0;window.pressplus={profiler:{duration:{startTime:0,forInit:0}}};window.pressplus.profiler.duration.startTime=new Date;
(function(e,d){var b={},o="//h.ppjol.com",y="//s.ppjol.net",n="https://ui.ppjol.com",B=!1,C="",z=2,D=[],Q=1,g,t,G,L,H,p,l,q,u,v,E,A,k,m,w,I,M,F,J,r,s,x,K,N,i,j,O=!1;"undefined"!==typeof e.console&&e.console?(g=e.console,"undefined"===typeof g.debug&&(g.debug=g.log)):g={debug:function(){},error:function(){},info:function(){},log:function(){},warn:function(){}};b.status={target:{},mostRecent:{scroll:{timestamp:0}},manualPop:{triggered:!1}};-1!=t&&9>t&&(b.status.manualPop={triggered:!1},b.status.mostRecent=
{scroll:""},b.status.mostRecent.scroll={timestamp:0});DEBUG&&("undefined"!==typeof e.USE_LOCALHOST&&!0===e.USE_LOCALHOST?(o="//h-dev.ppjol.com:8080",y="//s-dev.ppjol.net:8080",n="//ui-dev.ppjol.com:8080"):"string"===typeof e.USE_SERVER?n=y=o=e.USE_SERVER:"object"===typeof e.USE_SERVER&&"undefined"!==typeof e.USE_SERVER.target&&("undefined"!==typeof e.USE_SERVER.target.hecate?o=e.USE_SERVER.target.hecate:g.log("HECATE_TARGET not overridden: no target specified in USE_SERVER config"),"undefined"!==
typeof e.USE_SERVER.target.css?y=e.USE_SERVER.target.css:g.log("CSS_TARGET not overridden: no target specified in USE_SERVER config"),"undefined"!==typeof e.USE_SERVER.target.ui?n=e.USE_SERVER.target.ui:g.log("UI_TARGET not overridden: no target specified in USE_SERVER config")),"undefined"!==typeof e.USE_LOCALHOST&&!0===e.USE_LOCALHOST&&g.log("window.USE_LOCALHOST is %s",e.USE_LOCALHOST));if("Microsoft Internet Explorer"==navigator.appName){var P=navigator.userAgent.match(/MSIE\s([\d+])/);t=P&&parseInt(P[1],
10)}else t=-1;G=/Safari/.test(navigator.userAgent)&&!/chrome/.test(navigator.userAgent.toLowerCase());/chrome/.test(navigator.userAgent.toLowerCase());L=/dolfin/.test(navigator.userAgent.toLowerCase())||!/chrome/.test(navigator.userAgent.toLowerCase())&&/mobile safari/.test(navigator.userAgent.toLowerCase())&&/\(khtml, like gecko\) version\/?/.test(navigator.userAgent.toLowerCase());H=/android/.test(navigator.userAgent.toLowerCase());Function.prototype.bind=Function.prototype.bind||function(){var a=
this,b=[].slice.call(arguments),c=b.shift();return function(){return a.apply(c,b.concat([].slice.call(arguments)))}};b.util={observe:function(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener&&a.addEventListener(b,c,false)},stopObserving:function(a,b,c){a.detachEvent?a.detachEvent("on"+b,c):a.removeEventListener&&a.removeEventListener(b,c,false)},onPageReady:function(a){e.addEventListener?e.document.readyState==="complete"?a():e.addEventListener("load",a,false):e.attachEvent&&e.attachEvent("onload",
a)},loadScript:function(a,f){var c=d.createElement("script"),h="_cb_"+b.util.uniqueString(),a=b.util.formUrl(a,{cb:h});e[h]=f;c.src=a;c.type="text/javascript";c.async=true;d.getElementsByTagName("body")[0].appendChild(c)},loadCSS:function(a){var b=d.createElement("link");b.media="screen";b.rel="stylesheet";b.type="text/css";b.href=a;d.getElementsByTagName("body")[0].appendChild(b)},trim:function(a){return a.replace(/^\s+|,?\s+$/g,"")},uniqueString:function(){var a=[],b=["0","1","2","3","4","5","6",
"7","8","9","A","B","C","D","E","F"],c;for(c=0;c<36;c++)a[c]=15&Math.random()*16;a[14]=4;a[19]=a[19]&3|8;for(c=0;c<36;c++)a[c]=b[a[c]];return a.join("")},formUrl:function(a,b){typeof b==="undefined"&&(b={});var c=a,h=[],d;for(d in b)h.push(d+"="+encodeURIComponent(b[d]));h.length>0&&c.indexOf("?")>-1?c=c+"&"+h.join("&"):h.length>0&&(c=c+"?"+h.join("&"));g.debug("formUrl: ",c);return c},isMobile:function(a){return a==="mobile"||a==="universal"&&this.isMobileBrowser()},isMobileBrowser:function(){var a=
navigator.userAgent.toLowerCase()||navigator.vendor.toLowerCase()||e.opera.toLowerCase();return/(android|bb\d+|meego).+(nexus|galaxy|droid|mobile)|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,
4))},getCookie:function(a){var b=a+"=",c="";if(d.cookie.length>0){a=d.cookie.indexOf(b);if(a!==-1){a=a+b.length;b=d.cookie.indexOf(";",a);if(b===-1)b=d.cookie.length;c=decodeURI(d.cookie.substring(a,b))}}return c},set_cookie:function(a,b,c,h,e,g,i,j){a=a+"="+escape(b);c&&(a=a+("; expires="+(new Date(c,h,e)).toGMTString()));g&&(a=a+("; path="+escape(g)));i&&(a=a+("; domain="+escape(i)));j&&location.protocol==="https"&&(a=a+"; secure");d.cookie=a},del_cookie:function(a){d.cookie=a+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"},
formCookieDomain:function(){var a=e.location.hostname,b=a,c=[],c=a.split("."),a=c.length;c&&a>2&&(b=c[a-1].length>=3?c[a-2]+"."+c[a-1]:c[a-3]+"."+c[a-2]+"."+c[a-1]);return b},setCookieWithExpiration:function(a,f,c){var h=b.util.formCookieDomain(),a=a+"="+escape(f);c&&(a=a+("; expires="+c.toGMTString()));a=a+("; path="+escape("/"));a=a+("; domain="+escape(h));location.protocol==="https"&&(a=a+"; secure");d.cookie=a},setCookie:function(a,f){var c=b.util.formCookieDomain(),h=new Date,d=h.getDate(),e=
h.getMonth()+1,h=h.getFullYear();d<10&&(d="0"+d);e<10&&(e="0"+e);navigator.appName=="Microsoft Internet Explorer"?b.util.set_cookie(a,f,h,e,d+1,"/",c,true):b.util.set_cookie(a,f,null,null,null,"/",c,true)},setCookieString:function(a){a=a.split("=");b.util.setCookie(a[0],a[1])},searchData:function(a){var b,c,h;for(b=0;b<a.length;b++){c=a[b].string;h=a[b].prop;this.versionSearchString=a[b].versionSearch||a[b].identity;if(c){if(c.indexOf(a[b].subString)!==-1)return a[b].identity}else if(h)return a[b].identity}},
searchVersion:function(a){var b=a.indexOf(this.versionSearchString);if(b!==-1)return parseFloat(a.substring(b+this.versionSearchString.length+1))},detectBrowser:function(a,b){return this.searchData(this.browserData)===a&&this.searchData(this.infoOS)===b},browserData:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.userAgent,subString:"Dolfin",identity:"Dolfin"},{string:navigator.vendor,
subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:e.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",
versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"}],infoOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"},{string:navigator.platform,subString:"Android",identity:"Android"},{string:navigator.platform,subString:"Berry",identity:"BlackBerry"}],
getParameterByName:function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=RegExp("[\\?&]"+a+"=([^&#]*)").exec(e.location.search);return a==null?"":decodeURIComponent(a[1].replace(/\+/g," "))}};b.ui={getScroll:function(){var a=0;if(e.pageYOffset)a=e.pageYOffset;else{a=d.documentElement||d.body.parentNode;a=typeof a.scrollTop==="number"?a.scrollTop:d.body.scrollTop}return a},getPageSize:function(){var a,b;a=Math.max(d.documentElement.clientWidth,d.body.scrollWidth,d.documentElement.scrollWidth,
d.body.offsetWidth,d.documentElement.offsetWidth);b=Math.max(d.documentElement.clientHeight,d.body.scrollHeight,d.documentElement.scrollHeight,d.body.offsetHeight,d.documentElement.offsetHeight);return{x:a,y:b}},getViewport:function(){var a,b;if(d.compatMode==="CSS1Compat"){a=d.documentElement.clientWidth;b=d.documentElement.clientHeight}else{a=d.body.clientWidth;b=d.body.clientHeight}return{x:a,y:b}}};b.lightbox={initLightwindow:function(){m=d.createElement("div");m.id="gregbox-outer"},initLightwindowFull:function(){m=
d.createElement("div");m.id="pressplus-outer"},initOverlay:function(){p=d.createElement("div");p.style.backgroundImage="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RDhCQzBDREZCQ0ZGMTFFMEIxQkFCQ0MxOEQzMzc5NTEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RDhCQzBDRTBCQ0ZGMTFFMEIxQkFCQ0MxOEQzMzc5NTEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpEOEJDMENEREJDRkYxMUUwQjFCQUJDQzE4RDMzNzk1MSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpEOEJDMENERUJDRkYxMUUwQjFCQUJDQzE4RDMzNzk1MSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PoOauxEAAAALSURBVAgdYzA+AwABNQEAGVbmvQAAAABJRU5ErkJggg%3D%3D)";
p.style.zIndex=99998;p.style.position="absolute";p.style.top=0;p.style.left=0;b.util.observe(p,"click",b.lightbox.overlayClickHandler)},overlayClickHandler:function(){return false},openLightBoxWindow:function(){var a=d.body;if(a){a.appendChild(m);a.appendChild(p);a.appendChild(q);a.appendChild(l);b.lightbox.positionOverlay();b.lightbox.positionLightwindow();m.appendChild(k);m.appendChild(u);I=true;w&&w()}},openFullLightBoxWindow:function(){var a=d.body;if(a){a.appendChild(m);a.appendChild(p);a.appendChild(q);
b.lightbox.positionOverlay();m.appendChild(k);I=true;m.style.top="0px";m.style.left="0px";m.style.width="100%";m.style.height="100%";m.style.border=0;w&&w()}},showLightBox:function(a,f){w=f;b.lightbox.initLightwindow();b.lightbox.initOverlay();b.lightbox.initIframe(a);b.lightbox.initCloseButton();b.lightbox.initSignInLink();b.lightbox.initFooter();b.lightbox.openLightBoxWindow()},showFullLightBox:function(a,f){w=f;b.lightbox.initLightwindowFull();b.lightbox.initOverlay();b.lightbox.initFullIframe(a);
b.lightbox.initSignInLink();b.lightbox.openFullLightBoxWindow()},go:function(a){g.log("Requesting to go to: "+a);if(I&&k!==null)k.contentWindow.location.href=a},initIframe:function(a){k=d.createElement("iFrame");k.src=a;k.style.width="600px";k.style.height="525px";k.style.border=0;k.frameBorder=0;k.scrolling="no";k.id="innerFrame"},initFullIframe:function(a){k=d.createElement("iFrame");k.src=a;k.style.position="absolute";k.style.top="0px";k.style.left="0px";k.style.width="100%";k.style.height="100%";
k.style.border=0;k.frameBorder=0;k.scrolling="no";k.id="innerFrame"},initSignInLink:function(){q=d.createElement("a");q.innerHTML="SIGN IN";q.id="gregbox-signInTab";b.util.observe(q,"click",b.client.signInClickHandler)},initCloseButton:function(){l=d.createElement("img");l.src="http://s.ppjol.net/static/fb/fancy_close.png";l.style.cursor="pointer";l.style.position="absolute";l.style.zIndex=100002;b.util.observe(l,"click",b.lightbox.handleCloseButton)},initFullCloseButton:function(){l=d.createElement("img");
l.src="http://s.ppjol.net/static/fb/fancy_close.png";l.style.cursor="pointer";l.style.position="absolute";l.style.top="0%";l.style.left="95%";l.style.zIndex=100002;b.util.observe(l,"click",b.lightbox.handleCloseButton)},handleCloseButton:function(){var a=b.config.getBorder(),f=null;if(typeof j!=="undefined"){j.getLightBoxTarget();a=j.getBorderUuid();f=j.isSocialvibeOn()}var c=n+"/closeLightbox/";if(b.util.getCookie(b.config.getZone())=="authorized"){b.client.setRefreshOnClose();b.client.closeLightBoxWindow()}else if(!f||
O||typeof a==="undefined"||a==="")b.client.closeLightBoxWindow();else{c=c+a+".json";g.log("closeUrl: "+c);b.util.loadScript(c,b.lightbox.catchCloseButton)}},catchCloseButton:function(a){a.action=="redirect"?b.lightbox.go(n+a.url):b.client.closeLightBoxWindow()},initFooter:function(){E=d.createElement("div");E.id="pp-branding-privacy";A=d.createElement("div");A.id="pp-branding-help";b.util.observe(A,"click",b.client.helpClickHandler);v=d.createElement("a");v.href="http://www.mypressplus.com/readers/privacy";
v.target="blank";v.appendChild(E);u=d.createElement("div");u.id="pp-branding";u.appendChild(A);u.appendChild(v)},positionOverlay:function(){var a=b.ui.getPageSize();p.style.width="100%";p.style.height=a.y+"px"},positionLightwindow:function(){var a=b.ui.getScroll(),f=b.ui.getViewport(),c=b.ui.getPageSize(),a=f.y/2-262+a;m.style.top=a+"px";m.style.left=c.x/2-300+"px";q.style.top=a-23+"px";q.style.left=c.x/2+150+"px";l.style.top=a-11+"px";l.style.left=c.x/2+293+"px";b.util.observe(e,"resize",b.lightbox.positionLightwindow);
b.util.observe(e,"scroll",b.lightbox.afterScrollPositionLightwindow)},afterScrollPositionLightwindow:function(){var a=Date.now();b.status.mostRecent.scroll.timestamp=a;setTimeout(function(){a-b.status.mostRecent.scroll.timestamp===0&&b.lightbox.positionLightwindow()},60)},closeLightBoxWindow:function(){var a=d.body;a.removeChild(m);a.removeChild(p);a.removeChild(l);a.removeChild(q)},displayDebugDialog:function(a){var b=d.createElement("div");b.id="ppdebug";b.style.zIndex=99999;b.style.position="absolute";
b.style.bottom="11px";b.style.right="10px";b.style.padding="2px";b.style.backgroundColor="#33aa33";b.style.width="380px";b.style.height="auto";b.style.textAlign="left";b.style.opacity="0.98";var c=d.createElement("div");c.id="ppdebugtxt";c.style.padding="10px";c.style.overflow="auto";c.style.width="360px";c.style.height="auto";c.style.fontSize="12px";c.style.fontFamily="consolas, inconsolata, courier, courier new";c.style.backgroundColor="#333";c.style.color="#33aa33";for(var h in a)if(a.hasOwnProperty(h)){var e=
d.createElement("div");e.innerHTML=a[h];c.appendChild(e)}b.appendChild(c);d.body.appendChild(b)},signIn:function(a){q.innerHTML=a},updateFooter:function(a,b,c,h){E.id=b;A.id=c;u.id=a;v.href=h}};b.postmessage={postMessage:function(a,b,c){if(b){c=c||e.parent;if(e.postMessage)c.postMessage(a,b.replace(/([^:]+:\/\/[^\/]+).*/,"$1"));else if(b)c.location=b.replace(/#.*$/,"")+"#"+ +new Date+Q++ +"&"+a}},receiveMessage:function(a,b){if(e.postMessage){a&&(J=function(c){if(typeof b==="string"&&c.origin!==b||
Object.prototype.toString.call(b)==="[object Function]"&&b(c.origin)===false)return false;a(c)});if(e.addEventListener)e[a?"addEventListener":"removeEventListener"]("message",J,false);else e[a?"attachEvent":"detachEvent"]("onmessage",J)}else{F&&clearInterval(F);F=null;a&&(F=setInterval(function(){var b=d.location.hash,f=/^#?\d+&/;if(b!==M&&f.test(b)){M=b;a({data:b.replace(f,"")})}},100))}}};b.cookieCheck={checkThirdPartyCookie:function(a,f){r=a;s=f;b.util.getCookie("ppThirdPartyCookieFound")==="true"?
r&&r():b.util.loadScript(o+"/hecate/cookie/write.json",b.cookieCheck.thirdPartyCookieLoaded)},thirdPartyCookieLoaded:function(){b.util.loadScript(o+"/hecate/cookie/check.json",b.cookieCheck.thirdPartyCookieCheck)},thirdPartyCookieCheck:function(a){var f=function(){if(b.util.isMobile(b.config.getMode()))if(G&&!H)b.lightbox.showFullLightBox(h,function(){q.style.visibility="hidden"});else{if(L&&H)d.location=h}else b.lightbox.showLightBox(c,function(){q.style.visibility="hidden"})};if(a.foundCookie){b.util.setCookie("ppThirdPartyCookieFound",
"true");b.client.setNormalOnClose();g.debug("Cookie Detector found the test cookie!");r?r():s&&s()}else{b.util.setCookie("ppThirdPartyCookieFound","false");g.debug("Cookie Detector did not find the test cookie Q_Q");var c=n+"/cookie/noCookieSupport.html",h=n+"/cookie/noCookieSupportMobile.html",c=b.util.formUrl(c,{parentURL:d.location.href}),h=b.util.formUrl(h,{parentURL:d.location.href});if(b.config.isCookieCheckHomeOnClose()){g.log("Setting 'go home' on close");b.client.setGoHomeOnClose()}else if(b.config.isCookieCheckDenyOnClose()){g.log("Setting 'deny url' on close");
b.client.setDenyOnClose()}var a=i.isCookieCheckForSessionOnly()&&b.util.getCookie("pp_session")!=="session_in_progress",e=i.isCookieCheckForSessionOnly()&&b.util.getCookie("pp_session")==="session_in_progress";if(a){g.log("First Session with Cookie Check");b.util.setCookie("pp_session","session_in_progress");f()}else if(e&&b.status.manualPop.triggered===false)g.log("Cookie Detector gives up: I have already showed the No Cookie lightbox during this session.");else{f();b.status.manualPop.triggered=
false}s&&s()}},checkThirdPartyCookieLight:function(a,f){r=a;s=f;b.util.getCookie("ppThirdPartyCookieFound")==="true"?r&&r():b.util.loadScript(o+"/hecate/cookie/write.json",b.cookieCheck.thirdPartyCookieLoadedLight)},thirdPartyCookieLoadedLight:function(){b.util.loadScript(o+"/hecate/cookie/check.json",b.cookieCheck.thirdPartyCookieCheckLight)},thirdPartyCookieCheckLight:function(a){if(a.foundCookie){b.util.setCookie("ppThirdPartyCookieFound","true");b.client.setNormalOnClose();g.debug("Cookie Detector found the test cookie!");
r?r():s&&s()}else{b.util.setCookie("ppThirdPartyCookieFound","false");s&&s()}}};b.safari={safariInitialCookiePost:function(){g.debug("executing safariInitialCookiePost");x=b.util.getCookie("saf")||0;g.debug("'saf' cookie / safariUserIsRecognized: "+x);if(x!=1){g.debug("Appears to be your first Safari session...");var a=d.createElement("iframe");a.id="ppses";a.src=o+"/hecate/0.jsp";a.style.visibility="hidden";b.util.observe(a,"click",function(){g.log("Onload of iFrame: "+x);if(x===0){x=1;b.util.setCookie("saf",
1);d.getElementById("polsf").submit()}});var f=d.createElement("form");f.id="polsf";f.enctype="application/x-www-form-urlencoded";f.action=o+"/hecate/1.html";f.method="POST";f.target="ppses";d.body.appendChild(f);d.body.appendChild(a)}}};K=function(a){function f(a){if(a!==null){a=a.split(" ");if(a.length>=2)return a[1]}return null}this.commands=[];this.blob=a;this.init=function(){if(this.blob.actions!==void 0&&this.blob.actions!==null)for(var a=0;a<this.blob.actions.length;a++){var b=this.blob.actions[a]!==
null?this.blob.actions[a].split(" ")[0]:null;b!==null&&this.commands.push(b)}};this.commandParameter=function(a){if(this.blob.actions!==null)for(var b=0;b<this.blob.actions.length;b++){var d=this.blob.actions[b]!==null?this.blob.actions[b].split(" ")[0]:null;if(d!==null&&d==a)return f(this.blob.actions[b])}return null};this.hasRscript=function(){for(var a in this.commands)if(this.commands[a]=="rscript")return true;return false};this.getRscript=function(){return this.hasRscript()?this.commandParameter("rscript"):
null};this.hasRedirect=function(){for(var a in this.commands)if(this.commands[a]=="redirect")return true;return false};this.getRedirect=function(){return this.hasRedirect()?this.commandParameter("redirect"):null};this.setFirstPartyCookies=function(){for(var a in this.commands)if(this.commands[a]=="cookie"){g.debug(f(this.blob.actions[a]));b.util.setCookieString(f(this.blob.actions[a]))}return false};this.hasDebug=function(){return typeof this.blob.debug!="undefined"&&this.blob.debug!==null};this.getDebug=
function(){return this.hasDebug()?this.blob.debug:null};this.getDenyUrl=function(){if(this.blob.denyUrl)return this.blob.denyUrl;throw"'denyUrl' was not defined in hecate blob";};this.getAffiliateToken=function(){if(this.blob.affiliateToken)return this.blob.affiliateToken;throw"'affiliateToken' was not defined in hecate blob";};this.getLightBoxTarget=function(){if(this.blob.lightBoxTarget)return this.blob.lightBoxTarget;throw"'lightBoxTarget' was not defined in hecate blob";};this.getBorderUuid=function(){if(this.blob.borderUuid)return this.blob.borderUuid;
throw"'borderUuid' was not defined in hecate blob";};this.isSocialvibeOn=function(){return this.blob.isSocialvibeOn?this.blob.isSocialvibeOn:false};this.init()};N=function(a){function f(a){for(var a=a.getElementsByTagName("script"),f=0;f<a.length;f++)if(b.client.regexForEmbed.test(a[f].src))return a[f];throw"Could not resolve pp.js script";}this.config={};this.init=function(){var c=f(a),d=eval("["+c.innerHTML+"]");if(d[0].mode!==null&&d[0].zone!==null){this.config.mode=d[0].mode;this.config.zone=
d[0].zone;this.config.border=d[0].border;this.config.debug=d[0].debug;this.config.customPreCheck=d[0].customPreCheck;this.config.cookieCheck=d[0].cookieCheck;this.config.cookieCheckCloseAction=d[0].cookieCheckCloseAction;this.config.hashbangAware=d[0].hashbangAware;this.config.affiliateToken=d[0].affiliateToken;b.status.target.src=c.src}else throw"PP.js script invalid couldn't resolve mode and zone";};this.isValidConfig=function(){return typeof this.config.mode!=="undefined"&&typeof this.config.zone!==
"undefined"};this.containsCustomPreCheck=function(){return typeof this.config.customPreCheck!=="undefined"&&this.config.customPreCheck!==null};this.getCustomPreCheckFunctionName=function(){return typeof this.config.customPreCheck!=="undefined"?this.config.customPreCheck:null};this.isInDebugMode=function(){return a.location.hash=="#ppDebug"||this.config.debug};this.shouldClearU=function(){return a.location.hash=="#ppClearU"};this.getMode=function(){return this.config.mode};this.getZone=function(){return this.config.zone};
this.hasBorder=function(){return typeof this.config.border!=="undefined"&&this.config.border!==null};this.getBorder=function(){return this.config.border};this.getAffiliateToken=function(){return this.config.affiliateToken};this.isCookieCheck=function(){var a=/\b(manual|session|onload|true|1)\b/i.test(this.config.cookieCheck)||this.config.cookieCheck===true,b=/\bsafari\b/i.test(this.config.cookieCheck);return b===true&&G===true?true:b===false&&a===true?true:false};this.isCookieCheckOnLoad=function(){return/\bonload\b/i.test(this.config.cookieCheck)&&
this.isCookieCheck()};this.isCookieCheckForSessionOnly=function(){return/\bsession\b/i.test(this.config.cookieCheck)&&this.isCookieCheck()};this.isCookieCheckOnlyForManualPop=function(){return/\b(manual|true|1)\b/i.test(this.config.cookieCheck)||this.isCookieCheck()};this.isCookieCheckDenyOnClose=function(){return/\bdeny\b/i.test(this.config.cookieCheckCloseAction)};this.isCookieCheckHomeOnClose=function(){return/\bhome\b/i.test(this.config.cookieCheckCloseAction)};this.isHashbangAware=function(){return this.config.hashbangAware};
this.init()};b.client={regexForEmbed:/\bpp(.min|s)?.js/,setupLegacyManualPop:function(a){typeof e[a]==="undefined"&&(e[a]=function(){return"This is a placeholder object created by pp.js"});e[a].pressplus={};e[a].pressplus.f={};e[a].pressplus.f.pop=b.client.pop},bindPostMessage:function(){b.postmessage.receiveMessage(function(a){g.log("Received postMessage: "+a.data);if(!e.postMessage&&e.parent.location.hash)e.parent.location.hash="";if(a.data&&a.data==="close")b.client.closeLightBoxWindow();else if(a.data&&
a.data==="refreshOnClose"||a.data==="closerefresh"){b.client.setRefreshOnClose();b.client.closeLightBoxWindow()}else if(a.data&&a.data==="disableDenyURL")b.client.setRefreshOnClose();else if(a.data&&a.data.match(/^setC/))b.util.setCookieString(a.data.substring(4));else if(a.data&&a.data.match(/^setAuth_/)){var f=a.data.substring(8).split(";");if(f[0]){a=f[0].split("=");if(f[1]){f=new Date(parseInt(f[1]));b.util.setCookieWithExpiration(a[0],a[1],f)}else b.util.setcookie(a[0],a[1])}b.client.setRefreshOnClose()}else a.data&&
a.data=="unauthorize"?b.util.del_cookie(b.config.getZone()):a.data&&a.data==="updateSignInTab"?b.client.updateSignInTab():a.data&&a.data==="setRefreshOnClose"?b.client.setRefreshOnClose():a.data&&a.data==="back"?e.history.back():a.data&&a.data==="setDenyOnClose"?b.client.setDenyOnClose():a.data&&a.data==="setSocialVibe"?b.client.setFromSocialVibe(true):g.log("Message received from postMessage was not recognized : "+a.data)})},hecate:function(){if(i.containsCustomPreCheck()){var a=b.client.executeCustomPreCheck();
if(a===0){g.log("Custom preCheck evaluated to %o, halting execution",a);b.client.executeNoMeterMode();return}g.debug("Custom preCheck was %o, proceeding with lightbox launch.",a)}b.client.executeHecate()},executeCustomPreCheck:function(){if(i.containsCustomPreCheck()){g.log("Custom PreCheck function was present evaluating: "+i.getCustomPreCheckFunctionName());return eval(i.getCustomPreCheckFunctionName()+"()")}return 1},paramsForMeter:function(){var a={};a.z=i.getZone();if(i.isInDebugMode())a.debug=
"1";if(i.hasBorder())a.border=i.getBorder();if(i.isHashbangAware())a.cid=d.location.href;if(d.referrer!=null&&d.referrer!="")a.entry=d.referrer;var b=d.location.hash;if(b!==null&&b.match(/^#p\+.=/)&&b.length>7){var c=b.substring(3,4),b=b.substring(5);a.pm=c;a.p=b}return a},executeNoMeterMode:function(){var a=o+"/hecate/hecate/nometer.json",f=this.paramsForMeter(),a=b.util.formUrl(a,f);g.log("HecateUrl: "+a);b.util.loadScript(a,b.client.meterModeCallBack)},executeHecate:function(){b.util.isMobile(i.getMode())?
this.executeMobileMode():this.executeMeterMode()},executeMeterMode:function(){var a=o+"/hecate/hecate/2.json",f=this.paramsForMeter(),a=b.util.formUrl(a,f);g.log("HecateUrl: "+a);b.util.loadScript(a,b.client.meterModeCallBack)},executeMobileMode:function(){var a=o+"/hecate/hecate/2.json",f=this.paramsForMeter();f.mobile=1;a=b.util.formUrl(a,f);g.log("executeMobileMode ...  HecateUrl: "+a);b.util.loadScript(a,b.client.mobileModeCallBack)},meterModeCallBack:function(a){if(a===null)throw"Unexpected response from hecate call";
j=new K(a);if(j.hasDebug()){a=j.getDebug();g.log("Debug info:\n"+a);b.lightbox.displayDebugDialog(a)}if(j.hasRscript()){var f=j.getRscript(),a={};a.parentURL=d.location.href;if(b.config.hasBorder())a.borderset=true;f=b.util.formUrl(f,a);g.log("Launching url in lightbox: "+f);b.util.getCookie("ppThirdPartyCookieFound")==="true"&&b.util.getCookie(b.config.getZone())!="authorized"?b.lightbox.showLightBox(f,b.client.onLightBoxWindowOpen):b.util.getCookie(b.config.getZone())!="authorized"&&b.cookieCheck.checkThirdPartyCookieLight(function(){b.lightbox.showLightBox(f,
b.client.onLightBoxWindowOpen)})}j.setFirstPartyCookies()},mobileModeCallBack:function(a){if(a===null)throw"Unexpected response from hecate call";j=new K(a);if(j.hasDebug()){a=j.getDebug();g.log("Debug info:\n"+a);b.lightbox.displayDebugDialog(a)}if(j.hasRedirect()){var a=j.getRedirect(),f={};f.parentURL=d.location.href;if(b.config.hasBorder())f.borderset=true;a=b.util.formUrl(a,f);if(b.util.getCookie("ppThirdPartyCookieFound")==="true"&&b.util.getCookie(b.config.getZone())!="authorized"){g.log("redirecting: "+
a);e.location=a}}},onLightBoxWindowOpen:function(){var a={};a.locale=C;b.client.querySession("isAuthenticated",a,function(a){B=a.isAuthenticated;C=a.locale;var c=a.footerId,d=a.ppBrandingPrivacyDivId,e=a.ppBrandingHelpDivId,g=a.ppPrivacyLinkURL;b.lightbox.signIn(a.signin);b.lightbox.updateFooter(c,d,e,g)})},updateSignInTab:function(){var a={};a.locale=C;b.client.querySession("isAuthenticated",a,function(a){B=a.isAuthenticated;C=a.locale;var c=a.footerId,d=a.ppBrandingPrivacyDivId,e=a.ppBrandingHelpDivId,
g=a.ppPrivacyLinkURL;b.lightbox.signIn(a.signin);b.lightbox.updateFooter(c,d,e,g)})},signInClickHandler:function(){var a=n,d=b.config.getAffiliateToken(),c=b.config.getBorder();if(typeof j!=="undefined"){a=j.getLightBoxTarget();if(typeof d==="undefined"||d==="")d=j.getAffiliateToken();c=j.getBorderUuid()}if(typeof c==="undefined"||c==="")B?b.lightbox.go(a+"/logout/NONE/u/NONE.html?zone="+b.config.getZone()):b.lightbox.go(a+"/login/NONE/u/NONE.html?zone="+b.config.getZone());else{if(typeof d==="undefined"||
d==="")d="jonline";B?b.lightbox.go(a+"/logout/"+d+"/u/"+c+".html"):b.lightbox.go(a+"/login/"+d+"/u/"+c+".html")}},helpClickHandler:function(){var a=b.config.getBorder();j!==void 0&&(a=j.getBorderUuid());b.config.getZone();var d="",d=a!==void 0&&a!="undefined"&&a!==""?n+"/help/"+a+".html":n+"/help/unknown.html";b.lightbox.go(d)},querySession:function(a,d,c){var e="";if(typeof j==="undefined"){g.debug("Bailing out of querySession: hecateBlob is undefined - getting it is UI_TARGET !");e=n}else{e=j.getLightBoxTarget();
g.debug("executing querySession: hecateBlob is %o",j)}e=e+("/session/"+a+".json");b.util.uniqueString();d&&(e=b.util.formUrl(e,d));g.log("Querying session: "+e);b.util.loadScript(e,c)},pop:function(a){var f=i.getZone();b.util.isMobile(i.getMode())&&(a="mobile_"+a);var c=n+"/which/"+encodeURI(a)+"/r/"+encodeURI(f)+".html",g={};g.parentURL=d.location.href;if(b.config.hasBorder()){c=n+"/which/"+encodeURI(a)+"/jonline/r/"+encodeURI(b.config.getBorder())+".html";g.borderset=true;g.zone=encodeURI(f)}c=
b.util.formUrl(c,g);b.status.manualPop.triggered=true;i.isCookieCheckOnlyForManualPop?b.cookieCheck.checkThirdPartyCookie(function(){if(b.util.isMobile(i.getMode()))e.location=c;else{b.lightbox.showLightBox(c,b.client.onLightBoxWindowOpen);b.client.setNormalOnClose()}}):b.util.isMobile(i.getMode())?e.location=c:b.lightbox.showLightBox(c,b.client.onLightBoxWindowOpen);return false},clearU:function(){b.client.querySession("clearu",null,function(){d.location=e.location.href.split("#")[0];b.util.del_cookie(b.config.getZone())})},
closeLightBoxWindow:function(){switch(z){case 3:e.location=e.location.protocol+"//"+e.location.hostname;break;case 1:try{e.location=j.getDenyUrl()}catch(a){e.location=e.location.protocol+"//"+e.location.hostname}break;case 0:b.lightbox.closeLightBoxWindow();e.location.reload(true);break;default:b.lightbox.closeLightBoxWindow()}},setGoHomeOnClose:function(){z=3},setDenyOnClose:function(){g.log("Setting deny on close");z=1},setRefreshOnClose:function(){g.log("Setting refresh on close");z=0},setNormalOnClose:function(){g.log("Setting normal on close");
z=2},setFromSocialVibe:function(a){O=a},runHecate:function(){g.debug("RunHecate ..... ");if(!b.config.shouldClearU())if(i.isCookieCheckOnLoad()||i.isCookieCheckForSessionOnly()){g.debug("RunHecate:::Cookie Detector activated! Performing cookie check");b.config.shouldClearU()||b.cookieCheck.checkThirdPartyCookie(function(){b.client.executeHecate()},function(){b.client.executeNoMeterMode()})}else b.cookieCheck.checkThirdPartyCookieLight(function(){b.client.executeHecate()},function(){b.client.executeNoMeterMode()})},
init:function(){b.client.preInit(function(){i=new N(d);b.config=i;if(!i.isValidConfig())throw"Config is invalid!";b.client.bindPostMessage();b.util.loadCSS(y+"/css/pp.css");if(!b.config.shouldClearU())if(i.isCookieCheckOnLoad()||i.isCookieCheckForSessionOnly())a:{g.debug("Cookie Detector activated! Performing cookie check");if(i.containsCustomPreCheck()){var a=b.client.executeCustomPreCheck();if(a===0){g.log("Cookie Detector: HALTING execution (custom preCheck evaluated to %o)",a);b.client.executeNoMeterMode();
break a}}b.config.shouldClearU()||b.cookieCheck.checkThirdPartyCookie(function(){b.client.hecate()},function(){b.client.executeNoMeterMode()})}else b.cookieCheck.checkThirdPartyCookieLight(function(){b.client.hecate()},function(){b.client.executeNoMeterMode()});b.client.setupLegacyManualPop("jQuery");b.client.setupLegacyManualPop("$")});if(t==-1||t>=9)e.pressplus.profiler.duration.forInit=Date.now()-e.pressplus.profiler.duration.startTime},preInit:function(a){for(var b=0;b<D.length;b++){g.log("Invoking: "+
D[b]);D[b]()}a()},registerPreInitFunction:function(a){typeof a=="function"&&D.push(new Function(a))}};e.pp=b;b.util.onPageReady(function(){b.util.setCookie("ppRef",e.document.location.href);b.client.init();b.status.target.hecate=o;b.status.target.css=y;b.status.target.ui=n;e.pressplus.client=b.client;e.pressplus.config=b.config;if(b.config.isInDebugMode()){b.status.target.loadPath=b.status.target.src.match(/^(.*\/).*$/)[1];var a=d.createElement("script");a.src=b.status.target.loadPath+"client_debugger.js";
a.type="text/javascript";a.async=true;d.body.appendChild(a)}a=b.util.getParameterByName("setAuth_"+b.config.getZone());if(a!=null&&a){a=new Date(parseInt(a));isNaN(a)||b.util.setCookieWithExpiration(b.config.getZone(),"authorized",a)}b.util.getParameterByName("unauthorize")&&b.util.del_cookie(b.config.getZone());b.config.shouldClearU()&&b.client.clearU()})})(window,document);
/* Copyright (c) 2012 Journalism Online, LLC. All Rights Reserved. 2013-05-13T14:37:25.029-04:00 6b816aa3a30ed90cf5d701f3357cd55ee8d472d7 */
