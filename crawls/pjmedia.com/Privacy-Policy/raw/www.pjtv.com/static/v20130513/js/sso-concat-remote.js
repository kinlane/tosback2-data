PJTV=(function(){function b(){$("body").on("click",".thumb-rating.votable .thumb-button",function(j){var k={},f=$(this),l=f.closest(".thumb-rating");$oppositeElement=f.data("up")?l.find(".thumbs-down"):l.find(".thumbs-up"),text=f.find(".thumb-count").text(),oppositeText=$oppositeElement.find(".thumb-count").text();k.cmd="thumb-rating";k.ajax=true;k["video-id"]=l.data("video-id");k["media-type-id"]=l.data("media-type-id");k["thumbs-up"]=f.data("up");if(f.hasClass("share-widget-thumbs-up-voted")||f.hasClass("share-widget-thumbs-down-voted")){return}if(l.data("is-expired")||l.data("is-in-progress")){return}function h(m){$(".thumb-rating-message").html(m);$(".thumb-rating-message").show().delay(10000).fadeOut("fast")}function i(){l.data("is-expired",true);if(!l.data("is-in-progress")){l.removeClass("votable");l.find(".share-widget-thumbs-down").addClass("share-widget-thumbs-down-fixed");l.find(".share-widget-thumbs-down").removeClass("share-widget-thumbs-down");l.find(".share-widget-thumbs-up").addClass("share-widget-thumbs-up-fixed");l.find(".share-widget-thumbs-up").removeClass("share-widget-thumbs-up")}}function g(){l.data("is-in-progress",true);l.removeClass("votable");l.addClass("thumb-rating-in-progress");l.find(".thumb-rating-loading").show()}function e(){l.removeClass("thumb-rating-in-progress");l.addClass("votable");l.find(".thumb-rating-loading").hide();l.data("is-in-progress",false);if(l.data("is-expired")){i()}}g();$.post("/",k,function(m){if(m.success){if(f.hasClass("share-widget-thumbs-up")||f.hasClass("share-widget-thumbs-down")){if(text.indexOf("k")===-1){f.find(".thumb-count").text(parseInt(text)+1)}if(oppositeText.indexOf("k")===-1&&l.data("is-voted")){$oppositeElement.find(".thumb-count").text(parseInt(oppositeText)-1)}}h(m.message);if(f.data("up")){f.addClass("share-widget-thumbs-up-voted");f.removeClass("share-widget-thumbs-up");$oppositeElement.addClass("share-widget-thumbs-down");$oppositeElement.removeClass("share-widget-thumbs-down-voted")}else{f.addClass("share-widget-thumbs-down-voted");f.removeClass("share-widget-thumbs-down");$oppositeElement.addClass("share-widget-thumbs-up");$oppositeElement.removeClass("share-widget-thumbs-up-voted")}if(!l.data("is-voted")){l.data("is-voted",true);setTimeout(function(){i()},m.revoteTime*1000)}}else{if(m.loggedIn===false){$(".thumb-rating-message").show();$(".thumb-rating-no-user-message").show()}else{h(m.message)}}}).fail(function(){h("An error occured, please try again.")}).always(function(){setTimeout(function(){e()},150)});j.stopPropagation();j.preventDefault()});$("body").on("click",".share-widget-show-url",function(e){var g=$(this).closest("#shareBarForVideo, .flash-snippet-share-widget, #ach-referral"),f=g.find($(".url-copy-div"));f.toggle();e.stopPropagation();e.preventDefault()})}function a(e){var f={};_.each(e.split(";"),function(h){var g=h.split(":");if(g.length===2){f[g[0]]=g[1]}});return f}function c(){var e=$(".hoverstyle");e.removeClass("hoverstyle");$.each(e,function(){var f=$(this),g=a(f.data("mouseenter")),h=a(f.data("mouseleave"));f.mouseenter(function(){f.css(g)});f.mouseleave(function(){f.css(h)})})}function d(){window.CKEDITOR_BASEPATH="/js/external/ckeditor/";jQuery.extend({postJSON:function(e,f,g){return jQuery.post(e,f,g,"json")}});b();PJTV.SearchOverlay.init()}$(document).ready(function(){c()});return{init:d}}());
PJTV.SingleSignOn=(function(I,w,z){try{if(jQuerySSO){w=jQuerySSO}}catch(H){}var A={},r="pjdialog",k="pjdialog-iframe",F="pjdialog-close",d="pjdialog-clickshield",E="#"+r,i="#"+k,a="#"+F,G="#"+d,p=false,B="sso-link",u=-1,f=0,y=1,b=2,v=3,s=4,o=2;function K(){w("video").each(function(){var e=w(this);if(e.data("controlsTemporarilyDisabled")){e.data("controlsTemporarilyDisabled",false);e.attr("controls",e.data("oldControlsValue"))}})}function c(){w("video").each(function(){var e=w(this);if(e.attr("controls")){e.data("oldControlsValue",e.attr("controls"));e.attr("controls",false);e.data("controlsTemporarilyDisabled",true)}})}function h(){return(window.location!==window.parent.location)}function J(){if(q()){top.videoDivWidths={};top.videoDivHeights={};w("video").each(function(M,N){var O=w(N).attr("id");var e=O.replace("Object","");top.videoDivWidths[e]=w("#"+e).css("width");top.videoDivHeights[e]=w("#"+e).css("height");w("#"+e).css("width",w(N).attr("width"));w("#"+e).css("height",w(N).attr("height"));w(N).css("display","none")})}}function j(){if(q()){w("video").each(function(M,N){var O=w(N).attr("id");var e=O.replace("Object","");w("#"+e).css("width",top.videoDivWidths[e]);w("#"+e).css("height",top.videoDivHeights[e]);w(N).css("display","block")})}}A.openDialog=function(O,S,M){var U=this.getVideoPlayer(),P,N,Q,V;c();w("body").append('<div id="'+r+'"></div><div id="'+F+'"></div><div id="'+d+'">&nbsp;</div>');if(!S){try{if(ReferUrlContext){S=ReferUrlContext.getUrl()}}catch(T){}}if(!S||S==null||S==""){S=top.location.toString()}if(S!=null&&S!=""){O+="&ssor="+escape(S)}S=C(S);var R="&start-videos=";try{if(U!=null&&U.isPlaying()){R+=U.getClip().videoID;P=U.getTime();if(typeof(P)==="object"){P=0}R+=":"+P;R+=","}}catch(T){}w("video").each(function(W,X){try{if(!X.paused&&!X.ended&&X.currentTime>0){R+=w(X).attr("data-video-id");R+=":"+X.currentTime;R+=","}}catch(Y){}});O+=R;p=true;this.pauseVideoPlayers();J();N='style="visibility:hidden;"';if(w.browser.mozilla||w.browser.safari){N=""}Q='<iframe allowtransparency="true" '+N+' onload="this.style.visibility =\'visible\';PJTV.SingleSignOn.runOnLoadActions();" scrolling="no" name="'+k+'" id="'+k+'" src="'+O+'" frameborder="0" scrollbars="no"></iframe>';V=w(E);V.html(Q);V.removeClass();V.addClass("pjdialog");if(O.indexOf("profile")>-1||O.indexOf("show-account")>-1||O.indexOf("confirm-email-verification")>-1){V.addClass("pjdialog-profile")}w(window).resize(function(e){if(!q()){I.SingleSignOn.positionDialog();I.SingleSignOn.showCloseButton()}});w(G).show();V.show();I.SingleSignOn.positionDialog();if(O.indexOf("cmd=logout")<0){w("body").on("click",a,function(){I.SingleSignOn.closeDialog(M,C(top.location.toString()))});w(G).on("click",function(){I.SingleSignOn.closeDialog(M,C(top.location.toString()))})}};A.showCloseButton=function(){w(a).show()};A.runOnLoadActions=function(){var e=w(E);A.showCloseButton();if(q()){if(e.hasClass("post-first-load")){I.Ui.scrollTo(e,5,100,true)}else{I.Ui.scrollTo(e,5,100,false);e.addClass("post-first-load")}}};A.getVideoPlayer=function(){var N=null;try{N=$f()}catch(M){}return N};A.positionDialog=function(){var R=w(a).height()/2,O=0,S=w(G),T=w(E),N=w(a),Q,P,M,e;Q=(w(window).width()/2)-(T.outerWidth()/2);P=(w(window).height()/2)-(T.outerHeight()/2)+(w(window).scrollTop());if(Q<O){Q=O}if(P<R){P=R}S.css("height",w(document).height());S.css("min-width",T.width());T.css("top",P);T.css("left",Q);M=Q+T.width();e=P-(N.height()/2);M=M-50;e=e+28;N.hide();N.css("top",e);N.css("left",M)};A.closeDialog=function(e,M){w(G).remove();w(a).remove();if(e){if(!M){M=top.location}if(M.indexOf("#")>0){M=M.split("#");M=M[0]}I.SingleSignOn.reload(M,"_top",true);return}w(E).remove();K();p=false;j();this.unPauseVideoPlayers()};A.gotoAfter=function(M,e){setTimeout("location = '"+M+"'",e)};A.reload=function(P,O,M){if(h()||M){if(!O||O==null){O="_top"}try{w(E).html("",window.parent);if(P&&P!=null&&P!=""){if(O=="_self"){setTimeout("location='"+P+"';",20)}else{setTimeout("top.location='"+P+"';",20)}}else{setTimeout("top.location.reload();",20)}}catch(N){}}};A.isLoggedIn=function(){return(m("pjtv-logged-in")==1)};A.openDialogIfNecessary=function(e,N,M){if(A.isLoggedIn()){location=N}else{A.openDialog(e,N,M)}};function m(O){var P=document.cookie.split(";");for(var M=0;M<P.length;M++){var e=P[M].substr(0,P[M].indexOf("="));var N=P[M].substr(P[M].indexOf("=")+1);e=e.replace(/^\s+|\s+$/g,"");if(e==O){return unescape(N)}}}function L(Q){var U=w(Q),e=U.attr("id"),S=10,P=4,V,M,T,N,O,R;if(U.attr("data-instruction")){w("body").append('<div class="tooltip" id="tooltip'+e+'"></div>');w("#tooltip"+e).html(U.attr("data-instruction"));V=parseInt(w("#tooltip"+e).css("height"),10);M=parseInt(w("#tooltip"+e).css("width"),10);T=parseInt(U.offset().top,10)-V-P;N=parseInt(U.offset().left,10);O=parseInt(w("body").css("height"),10);R=parseInt(w("body").css("width"),10);while((N+M+S)>R){N-=1}w("#tooltip"+e).css("top",T+"px");w("#tooltip"+e).css("left",N+"px");w("#tooltip"+e).show()}}function C(e){e=e.replace(/\?show-account=true.*/g,"");e=e.replace("&show-account=true","");e=e.replace("?cmd=confirm-email-verification","");return e}function D(){w(".tooltip").each(function(){w(this).html("").hide()})}function n(M){var N=w(M).attr("id"),e=w("#tooltip"+N);e.html("");e.hide()}function g(){w("body .text").each(function(){var N,M,e=w(this);if(e.attr("data-cover-id")){N="#"+e.attr("data-cover-id");M=w(N);e.attr("placeholder",M.val());e.attr("holder",e.attr("data-default-value"));e.show();M.remove()}else{if(e.attr("data-default-value")){e.attr("placeholder",e.attr("data-default-value"));e.attr("holder",e.attr("data-default-value"));e.removeAttr("data-default-value")}}});w("body").on("change","select.text",function(){var e=w(this);if(e.attr("holder")&&e.val()===e.attr("holder")){e.css("color","#8ca4af")}else{e.css("color","#000000")}w("select.text option").css("color","black")});w("body select.text").each(function(){w(this).trigger("change")});w("body").on("focus",".text",function(){var e=w(this);if(e.attr("placeholder")){e.attr("holder",e.attr("placeholder"));e.removeAttr("placeholder")}});w("body").on("blur",".text",function(){var e=w(this);if(e.attr("holder")){e.attr("placeholder",e.attr("holder"));e.removeAttr("holder")}})}function l(){w("body .text").each(function(){var e=w(this);if(!e.attr("data-default-value")&&!e.attr("data-cover-id")){return}if(e.val()===e.attr("data-default-value")||e.val()===""){e.css("color","#8ca4af");e.val(e.attr("data-default-value"))}});w(".password-cover").each(function(){var e=w(this);e.attr("data-default-value",e.val())});w(":password").each(function(){var e=w(this),O,N;if(e.attr("data-cover-id")&&e.attr("data-error")=="true"){O="#"+w(this).attr("data-cover-id");N=w(O);N.addClass("errored");N.attr("data-instruction",e.attr("data-instruction"))}});try{w("body").on("focus",".password-cover",function(){var P=w(this).attr("id").toString(),N="#"+P.replace("-cover",""),O=w(this),e=w(N);O.hide();e.css("color","#000000");e.focus();e.show();setTimeout(function(){w(N).focus()},10)});w("body").on("focus",".text",function(){var e=w(this),N;if(!e.attr("data-default-value")&&!e.attr("data-cover-id")){return}if(e.val()===e.attr("data-default-value")){e.css("color","#000000");e.val("")}if(e.attr("data-cover-id")){N="#"+e.attr("data-cover-id");w(N).css("color","#000000")}});w("body").on("blur",".text",function(){var e=w(this),O,N;if(e.attr("data-cover-id")){if(e.val()===w(this).attr("data-default-value")||e.val()===""){O="#"+w(this).attr("data-cover-id");N=w(O);e.css("color","#8ca4af");N.css("color","#8ca4af");N.val(w(O).attr("data-default-value"));e.hide();N.show()}}else{if(e.val()===""||e.val()===e.attr("data-default-value")){e.css("color","#8ca4af");e.val(e.attr("data-default-value"))}}})}catch(M){}}function t(){return"ontouchend" in document}function q(){if(navigator&&navigator.userAgent&&navigator.userAgent!=null){var e=navigator.userAgent.toLowerCase();if(e.match(/(iphone|ipod|ipad|android)/)){return true}}return false}function x(){if(z.input.placeholder){g()}else{l()}try{w("body").on("mouseover",".errored",function(){if(!t()){L(this)}});w("body").on("mouseleave",".errored",function(){if(!t()){n(this)}});w("body").on("focus",".errored",function(){if(t()){L(this)}});w("body").on("blur",".errored",function(){if(t()){n(this)}});w("body").on("click","a",function(){D()});w("body").on("click",".errored",function(N){if(!t()){N.preventDefault();n(this)}});w("body").on("change",".covered-file-input",function(O){var N="#"+w(this).attr("data-cover-id");w(N).val(w(this).val());O.preventDefault()})}catch(M){}}A.initialize=function(){try{w("body").on("click","."+B,function(O){var P=false;var N=false;if(w(this).data("confirm-message")!==undefined){if(confirm(w(this).data("confirm-message"))){window.onbeforeunload=null}else{return false}}if(w(this).attr("data_redirect")!=null&&w(this).attr("data_redirect")!=""){P=w(this).attr("data_redirect")}if(w(this).attr("data_reload")=="true"){N=true}var e=w(this).attr("rel");if(typeof e==="undefined"){e=w(this).attr("data_rel")}top.PJTV.SingleSignOn.openDialog(e,P,N);O.preventDefault()})}catch(M){}x()};A.setCloseButtonURL=function(e,M){if(!M){M=0}w("body").on("click",a,function(){I.SingleSignOn.gotoAfter(e,M)});w("body").on("click",G,function(){I.SingleSignOn.gotoAfter(e,M)})};A.unPauseVideoPlayers=function(){w("video").each(function(M,N){try{if(N.paused&&!N.ended&&N.currentTime>0&&w(N).attr("pausedBySSO")=="true"){N.play();w(N).attr("pausedBySSO","false")}}catch(O){}});var e=this.getVideoPlayer();if(e!=null&&e.getState()==s&&w(e).attr("pausedBySSO")=="true"){e.resume();w(e).attr("pausedBySSO"," false")}};A.pauseVideoPlayers=function(){w("video").each(function(O,P){try{if(!P.paused&&!P.ended&&P.currentTime>0){P.pause();w(P).attr("pausedBySSO","true")}}catch(Q){}});var M=this.getVideoPlayer();try{if(M!=null){if(M.getState()==v){M.pause();w(M).attr("pausedBySSO","true")}else{if(M.getState()<v){if(p){setTimeout(function(){I.SingleSignOn.pauseVideoPlayers()},1000)}}}}}catch(N){}};w(document).ready(function(){I.SingleSignOn.initialize()});return A}(PJTV,$,Modernizr));
PJTV.CommonComment=(function(J,w){var l;function E(O,N,L){var M={};M.cmd="add-common-comment-form";M["item-type"]=O;M["item-id"]=N;L.load("/",M)}function d(R,Q,M,P,O,L,S){var N={};N.cmd="view-common-comments-ajax";N["item-type"]=R;N["item-id"]=Q;N.style=M;N.commonCommentsSortType=P;N["common-comments-page"]=O;L.load("/",N,S)}function b(Q,P,O,M,N,R){var L={};L.cmd="process-new-comment";L["text-"+P+"-"+O]=encodeURIComponent(Q);L["item-type"]=P;L["item-id"]=O;L["root-item-type"]=M;L["root-item-id"]=N;w.post("/",L,R,"json")}function u(O,N,P){var M={},L=O+"-"+N;M.cmd="submit-comment-report";M["item-type"]=O;M["item-id"]=N;w.post("/",M,P,"json")}function x(N,M,O){var L={};L.cmd="ajax-restore-common-comment";L["item-type"]=N;L["item-id"]=M;w.post("/",L,O,"json")}function A(N,M,O){var L={};L.cmd="ajax-remove-common-comment";L["item-type"]=N;L["item-id"]=M;w.post("/",L,O,"json")}function y(L,O){var N=prompt("Please enter a reason for this ban (optional). Press escape or cancel if you do not wish to ban this user."),M;if(N!=null){M={};M.cmd="ajax-ban-common-commenter";M["user-id"]=L;M.reason=N;w.post("/",M,O,"json")}}function B(L,N){var M={};M.cmd="ajax-restore-banned-commenter";M.id=L;w.post("/",M,N,"json")}function i(L,N){var M={};M.cmd="ajax-restore-banned-ip-address";M.id=L;w.post("/",M,N,"json")}function s(L,N){var M={};M.cmd="ajax-restore-banned-word";M.id=L;w.post("/",M,N,"json")}function n(P,O,L,N){if(!w("#view-comments-"+P+"-"+O+"> .comments").length){var M={};M.cmd="view-common-comments-ajax";M["item-type"]=P;M["item-id"]=O;M.style=L;if(N){M["common-comments-page"]=N}w("#view-comments-"+P+"-"+O).load("/",M);w("#view-comments-"+P+"-"+O).show()}else{w("#view-comments-"+P+"-"+O).empty()}w("#usefulness-vote-message-"+P+"-"+O).empty();w("#common-comment-message-"+P+"-"+O).empty();w("#hide-comments-link-"+P+"-"+O).toggleClass("hidden");w("#view-comments-link-"+P+"-"+O).toggleClass("hidden")}function o(N,M){var L={};L["title-"+N+"-"+M]=w("#title-"+N+"-"+M).val();L["text-"+N+"-"+M]=w("#text-"+N+"-"+M).val();L["rating-"+N+"-"+M]=w("#rating-"+N+"-"+M).val();L.cmd="process-new-review";L["item-type"]=N;L["item-id"]=M;w.post("/",L,function(O){if(O.success.toString()=="false"){w("#add-common-review-message-"+N+"-"+M).text(O.message)}else{w(".add-common-review").remove()}},"json")}function p(M,L){w("#add-common-review").remove()}function k(N,M){if(!w(".add-common-review").length){var L={};L.cmd="add-common-review-form";L["item-type"]=N;L["item-id"]=M;w(".add-review").load("/",L);w(".add-review").show()}else{w(".add-common-review").remove();w(".add-review-"+N+"-"+M).hide()}}function C(N,M){var L=N+"-"+M;w("#review-upvotes-"+L).removeClass("hidden");w("#review-title-line-"+L).removeClass("hidden");w("#review-text-"+L).removeClass("hidden");w("#review-comment-links-"+L).removeClass("hidden");w("#report-review-"+L).removeClass("hidden");w("#review-content-"+L+" > .review-break").removeClass("hidden");w("#common-usefulness-vote-"+L).removeClass("hidden");w("#review-reported-message-"+L).addClass("hidden")}function e(O,N){var M={},L;M.cmd="submit-review-report";M["item-type"]=O;M["item-id"]=N;w.post("/",M,function(P){L=O+"-"+N;w("#usefulness-vote-message-"+O+"-"+N).empty();w("#report-review-"+O+"-"+N).text(P.message);if(P.success===true){w("#review-upvotes-"+L).addClass("hidden");w("#review-title-line-"+L).addClass("hidden");w("#review-text-"+L).addClass("hidden");w("#review-comment-links-"+L).addClass("hidden");w("#report-review-"+L).addClass("hidden");w("#review-content-"+L+" > .review-break").addClass("hidden");w("#common-usefulness-vote-"+L).addClass("hidden");w("#review-reported-message-"+L).removeClass("hidden");w("#restore-review-link-"+N).removeClass("hidden")}},"json")}function c(){w(".review-count-box-toggle-icon").toggle();w(".review-count-box").toggle()}function H(){w(".review-toggle-icon").toggle();w(".individual-reviews-content").toggle()}function r(N,O,M){var L;if(!N.success){alert(N.message)}else{L=N["item-type"]+"-"+N["item-id"];w("#report-review-"+N["item-type"]+"-"+N["item-id"]).text("Report");w("#review-upvotes-"+L).removeClass("hidden");w("#review-title-line-"+L).removeClass("hidden");w("#review-text-"+L).removeClass("hidden");w("#review-comment-links-"+L).removeClass("hidden");w("#report-review-"+L).removeClass("hidden");w("#review-content-"+L+" > .review-break").removeClass("hidden");w("#common-usefulness-vote-"+L).removeClass("hidden");w("#review-reported-message-"+L).addClass("hidden");w("#restore-review-link-"+N["item-id"]).addClass("hidden")}}function f(M,N,L){if(!M.success){alert(M.message)}else{w("#reported-review-row-"+M["item-id"]).remove()}}function G(N,M,O){var L={};L.cmd="ajax-restore-common-review";L["item-type"]=N;L["item-id"]=M;w.post("/",L,O,"json")}function F(N,O,M){var L;if(!N.success){alert(N.message)}else{L=N["item-type"]+"-"+N["item-id"];w("#review-"+L).remove()}}function t(M,N,L){if(!M.success){alert(M.message)}else{w("#reported-review-row-"+M["item-id"]).remove()}}function z(N,M,O){var L={};L.cmd="ajax-remove-common-review";L["item-type"]=N;L["item-id"]=M;w.post("/",L,O,"json")}function D(){w(".review[rank]").removeClass("hidden")}function m(L){w(".review[rank="+L+"]").removeClass("hidden");w(".review[rank!="+L+"]").addClass("hidden")}function g(L){return{$focusedElement:L,getContainer:function(){return this.$focusedElement.closest(".common-usefulness-vote")},storeData:function(M,N){this.getContainer().data(M,N)},getData:function(M){return this.getContainer().data(M)}}}function K(N,O,Q,P){var L={},M=O+"-"+Q;L.cmd="submit-common-vote";L["vote-value"]=N;L["commentable-item-type"]=O;L.id=Q;w.post("/",L,P,"json")}function h(M){var L=M.find(".comment-text-show-more-less");M.removeClass("comment-text-truncated comment-text-expanded");M.css("height","auto");L.remove()}function j(M){var L=M.find(".comment-text-show-more-less");M.removeClass("comment-text-truncated");M.addClass("comment-text-expanded");M.css("height","auto");L.empty();L.append('<span class="comment-text-show-more-less-click">(show less)</span>');L.find(".comment-text-show-more-less-click").on("click",function(){v(M)})}function v(N){var P=parseFloat(N.css("line-height")),O=P*22,L=P*18,M,Q;if(N.height()>O){N.css("height",L+"px");N.addClass("comment-text-truncated");M=N.find(".comment-text-show-more-less");if(M.length===0){M=w("<div />")}M.empty();M.addClass("comment-text-show-more-less");M.append('<span class="comment-text-show-more-less-fade-in"></span>');Q=w("<span />");Q.addClass("comment-text-show-more-less-content");Q.append("... ");Q.append('<span class="comment-text-show-more-less-click">(show more)</span>');M.append(Q);M.find(".comment-text-show-more-less-click").on("click",function(){j(N)});N.append(M)}}function q(){var L=w(".comment-text-to-truncate");L.removeClass("comment-text-to-truncate");w.each(L,function(){v(w(this))})}function a(){var L=w(".comment-text-truncated");w.each(L,function(){var M=w(this);h(M);v(M)})}function I(){q();w(document).ajaxComplete(function(){q()});w(window).resize(function(){if(l){clearTimeout(l)}l=setTimeout(function(){l=undefined;a()},100)})}w(document).ready(function(){I()});return{sortVoteDesc:"votes-desc",sortDateDesc:"date-desc",sortDateAsc:"date-asc",getUpvoteContext:g,insertAddCommentForm:E,processNewComment:b,toggleViewComments:n,loadComments:d,reportComment:u,restoreComment:x,removeComment:A,banCommenter:y,restoreBannedCommenter:B,processUsefulnessVote:K,processNewReview:o,cancelNewReview:p,toggleAddReviewForm:k,viewReportedReview:C,reportReview:e,restoreReviewFromAdminLink:r,restoreReviewFromTable:f,restoreReview:G,removeReviewFromAdminLink:F,removeReviewFromTable:t,removeReview:z,toggleReviewCountBox:c,toggleReviewsContent:H,showAllRanks:D,limitToRank:m,restoreBannedIPAddress:i,restoreBannedWord:s}}(PJTV,$));
PJTV.RemoteCommonComment=(function(z){var b;var n;var g;var u;var j;var M;var p;var x=false;function c(P){b=P}function o(P){n=P}function K(){if(PJInterop.CookieCache&&PJInterop.CookieCache){if(PJInterop.CookieCache.get("email")!=false){return true}}return false}function D(R,Q,P){var T=prompt("Please enter a reason for this ban (optional). Press escape or cancel if you do not wish to ban this user.","");if(!T||T==null){T=""}var S={};S.cmd="ban-common-commenter-remote";S["user-id"]=R;S.reason=T;S.id=Q;S["root-item-id"]=g;z.post(b,S,l,"json");S.container=P;top.pjRequestData=S}function l(Q){if(Q.success){z(".ban-user-link-"+top.pjRequestData["user-id"]).html("User Banned");z("body").undelegate(".ban-user-link-"+top.pjRequestData["user-id"],"click");z(".ban-user-link-"+top.pjRequestData["user-id"]).removeClass("ban-user-link");z(".ban-user-link-"+top.pjRequestData["user-id"]).addClass("user-banned-label")}else{var P=top.pjRequestData.container;P.find(".common-comment-message-"+top.pjRequestData.id).show();P.find(".common-comment-message-"+top.pjRequestData.id).html(Q.message)}}function E(Q,P){var R={};R.cmd="remove-common-comment-remote";R.id=Q;R["root-item-id"]=g;z.post(b,R,C,"json");R.container=P;top.pjRequestData=R}function C(Q){var P=top.pjRequestData.container;if(Q.success){z(".common-comment-"+top.pjRequestData.id).remove();z(".common-comment-total-count").html("&nbsp;&nbsp;("+Q.commentCount+")")}else{P.find(".common-comment-message-"+top.pjRequestData.id).show();P.find(".common-comment-message-"+top.pjRequestData.id).html(Q.message)}}function t(Q){var P={};P.cmd="submit-comment-report-remote";P["item-id"]=Q;P["root-item-id"]=g;top.pjRequestData=P;z.post(b,P,y,"json")}function y(Q){var P=top.pjRequestData["item-id"];if(Q.success){z(".comment-text-"+P).hide();z(".comment-meta-"+P).hide();z(".comment-reported-message-"+P).show();z(".report-comment-"+P).html("Reported");z(".restore-comment-section-"+P).show();z(".restore-comment-section-"+P+" .restore-comment-link").show()}else{z("#common-comment-message-"+P).show();z("#common-comment-message-"+P).html(Q.message)}}function B(Q,P){var R={};R.cmd="restore-common-comment-remote";R.id=Q;R["root-item-id"]=g;z.post(b,R,h,"json");R.container=P;top.pjRequestData=R}function h(Q){if(Q.success){PJTV.RemoteCommonComment.viewReportedComment(top.pjRequestData.id);z(".restore-comment-section-"+top.pjRequestData.id).hide();z(".restore-comment-section-"+top.pjRequestData.id+" .restore-comment-link").hide();z(".report-comment-"+top.pjRequestData.id).html("Report Abuse")}else{var P=top.pjRequestData.container;P.find(".common-comment-message-"+top.pjRequestData.id).show();P.find(".common-comment-message-"+top.pjRequestData.id).html(Q.message)}}function s(Q){var P=Q;z(".comment-text-"+P).show();z(".truncated-comment-text-"+P).show();z(".comment-meta-"+P).show();z(".common-comment-add-reply-link-"+P).hide();z(".comment-reported-message-"+P).hide()}function m(R,Q,P){if(!K()){z(".common-usefulness-vote-login-or-register-"+Q).toggle();return}var S={};S.cmd="submit-common-vote-remote";S["vote-value"]=R;S.id=Q;S["root-item-id"]=g;z.post(b,S,I,"json");S.container=P;top.pjRequestData=S}function I(S,U,R){var Q=top.pjRequestData.id;if(S.success){z(".common-usefulness-vote-block-"+Q).each(function(V){z(this).addClass("hidden")});z(".common-usefulness-vote-feedback-"+Q).each(function(V){z(this).removeClass("hidden")});if(S.upVoteCount>=S.upVoteThreshold){z(".common-usefulness-voted-below-threshold-"+Q).each(function(V){z(this).removeClass("common-usefulness-voted-below-threshold");z(this).addClass("common-usefulness-voted-above-threshold")})}z(".common-usefulness-vote-"+Q).each(function(V){z(this).attr("count",S.upVoteCount)});z(".vote-count-"+Q).each(function(V){z(this).text(S.upVoteCount)});z(".vote-count-text-"+Q).each(function(V){jQuerySSO(this).prop("onclick",null);z(this).removeClass("vote-count-text-live-link")});if(S.reloadTopComments&&!PJTV.RemoteCommonComment.viewMoreTop){z(".common-comment-top-comments").html(S.renderedTopComments)}}else{var P=top.pjRequestData.container;P.find(".common-comment-message-"+Q).text(S.message)}if(PJInterop&&PJInterop.CookieCache){try{PJInterop.CookieCache.bind()}catch(T){}}}function q(P){var Q={};Q.page=P;O(Q)}function N(){var P={};P.cmd="get-common-comments-pending";P["item-id"]=g;P["item-type"]=u;if(PJInterop.CookieCache.get("email")&&!PJInterop.CookieCache.get("isEmailVerified")){z.get(b,P,k,"json")}}function k(P){z("#view-pending-comments").html(P.renderedPendingComments)}function O(P){if(!P.sort){P.sort=PJTV.RemoteCommonComment.sort}if(!P["view-more-top"]){P["view-more-top"]=PJTV.RemoteCommonComment.viewMoreTop}P.cmd="get-common-comments-remote";P["item-id"]=g;P["item-type"]=u;top.pjRequestData=P;z.get(b,P,a,"json")}function a(P){jQuerySSO(window).trigger("pj:comments-loaded",P);var R=P.renderedComments;J().html(R);if(PJInterop&&PJInterop.CookieCache){try{PJInterop.CookieCache.bind()}catch(Q){}}}function i(){var P=top.location.protocol+"//"+top.location.host+top.location.pathname+"?x="+Math.random();P+="#pj-cc-header-a";top.location=P}function G(){z("#pj-cc-top-comments-wrapper").css("display","none")}function J(){return z("#pj-interop-comments")}function H(Q,R,P){P.find(".add-comment-"+Q).toggle()}function v(S,P){var R=S;var Q=top.location.toString();Q=Q.replace(/show-at-comment.*/,"");Q=Q.replace(/#.*/,"");if(Q.indexOf("?")>=0){Q+="&"}else{Q+="?"}Q+="show-at-comment="+escape(S);Q+="#comment-"+escape(S);P.find(".show-link-to-comment-div-"+R).toggle();P.find(".show-link-to-comment-textarea-"+R).val(Q)}function w(S,U,T,Q,P){if(this.submitting){return}var R={};R.cmd="save-common-comment-remote";R["item-type"]=U;R["item-id"]=S;R["root-item-id"]=g;R["root-item-type"]=u;R.text=encodeURIComponent(T);R.rawtext=T;R.instanceId=Q;R.identifier=U+"-"+S+"-"+Q;R.sort=PJTV.RemoteCommonComment.sort;R["view-more-top"]=PJTV.RemoteCommonComment.viewMoreTop;if(T.replace(/ /g,"").length==0){P.find(".add-common-comment-message-"+R.identifier).show();P.find(".add-common-comment-message-"+R.identifier).html("You must enter some text!");return}this.submitting=true;z(".submit-common-comment").each(function(V){if(z(this).attr("data-instance-id")==Q){z(this).addClass("common-comment-timestamp");z(this).removeClass("cursor-pointer")}});z.post(b,R,L,"json");R.container=P;top.pjRequestData=R}function L(R){PJTV.RemoteCommonComment.submitting=false;z(".submit-common-comment").each(function(S){if(z(this).attr("data-instance-id")==top.pjRequestData.instanceId){z(this).removeClass("common-comment-timestamp");z(this).addClass("cursor-pointer")}});var P=top.pjRequestData.container;if(R.action&&R.action=="show-screen-name-dialog"){var Q=n;Q+="?cmd=screenname-prompt";PJTV.SingleSignOn.openDialog(Q,null,true)}if(R.action&&R.action=="reload"){top.location.reload()}if(R.success){if(R.pending){k(R);z(".common-comment-textarea").val("")}else{a(R)}z("#"+P[0].id+" .add-common-comment-message-"+top.pjRequestData.identifier).show();z("#"+P[0].id+" .add-common-comment-message-"+top.pjRequestData.identifier).html(R.message);z("#"+P[0].id+" .add-common-comment-message-"+top.pjRequestData.identifier).delay(10000).fadeOut("fast")}else{P.find(".add-common-comment-message-"+top.pjRequestData.identifier).show();P.find(".add-common-comment-message-"+top.pjRequestData.identifier).html(R.message)}}function r(Q,P){P.find("#truncated-comment-text-"+Q).hide();P.find("#full-comment-text-"+Q).show()}function F(Q,P){P.find("#full-comment-text-"+Q).hide();P.find("#truncated-comment-text-"+Q).show()}function A(){z("body").delegate(".common-comment-add-reply-link","click",function(S){var Q=z(S.currentTarget).attr("data-item-id");var R=z(S.currentTarget).attr("data-item-type");var P=z(S.currentTarget).closest(".common-comment-container");PJTV.RemoteCommonComment.reply(Q,R,P)});z("body").delegate(".submit-common-comment","click",function(T){var Q=z(T.currentTarget).attr("data-item-id");var R=z(T.currentTarget).attr("data-item-type");var S=z(T.currentTarget).attr("data-instance-id");var U=z("#text-"+R+"-"+Q+"-"+S).val();var P=z(T.currentTarget).closest(".common-comment-container");PJTV.RemoteCommonComment.postComment(Q,R,U,S,P)});z("body").delegate(".common-comment-guidelines","click",function(P){if(e()){z(".comment-guidelines-iphone").toggle();return}});z("body").delegate(".common-comment-guidelines","mouseover",function(S){if(e()){return}var R=z('<img class="guidelines-popup">');R.attr("class","guidelines-popup");R.attr("src","/wp-content/plugins/pjinteropplugin/images/commoncomment/comment-guidelines.png");R.css("display","none");var Q=(parseInt(z(S.target).position().top,10)+15);var P=(parseInt(z(S.target).position().left,10)-80);R.css("top",Q);R.css("left",P);R.appendTo(S.target);R.fadeIn();jQuerySSO(S.target).on("mouseout",function(T){R.fadeOut(function(U){R.remove()})})});z("body").delegate(".common-comment-sort-link","click",function(Q){var P={};P.sort=z(Q.currentTarget).attr("data-sort-option");P.page=1;if(P.sort=="votes-desc"){P["view-more-top"]=1}else{P["view-more-top"]=0}PJTV.RemoteCommonComment.sort=P.sort;PJTV.RemoteCommonComment.viewMoreTop=P["view-more-top"];PJTV.RemoteCommonComment.getComments(P)});z("body").delegate(".common-comment-paging-page","click",function(Q){var P={};P.page=z(Q.currentTarget).attr("data-page");PJTV.RemoteCommonComment.getComments(P)});z("body").delegate("#common-comment-view-all-link","click",function(Q){var P={};P["view-all"]=1;PJTV.RemoteCommonComment.getComments(P)});z("body").delegate("#common-comment-view-more-top-link","click",function(Q){var P={};P["view-more-top"]=1;P.sort="votes-desc";PJTV.RemoteCommonComment.sort=P.sort;PJTV.RemoteCommonComment.viewMoreTop=P["view-more-top"];PJTV.RemoteCommonComment.getComments(P)});z("body").delegate(".report-comment","click",function(Q){var P=z(Q.currentTarget).attr("data-item-id");PJTV.RemoteCommonComment.reportComment(P)});z("body").delegate(".comment-view-reported","click",function(Q){var P=z(Q.currentTarget).attr("data-item-id");PJTV.RemoteCommonComment.viewReportedComment(P)});z("body").delegate(".common-usefulness-vote","click",function(S){var R=z(S.currentTarget).attr("data-item-id");var Q=z(S.currentTarget).attr("data-vote-value");var P=z(S.currentTarget).closest(".common-comment-container");PJTV.RemoteCommonComment.upVote(Q,R,P)});z("body").delegate(".link-to-comment","click",function(R){var Q=z(R.currentTarget).attr("data-item-id");var P=z(R.currentTarget).closest(".common-comment-container");PJTV.RemoteCommonComment.linkToComment(Q,P)});z("body").delegate(".remove-comment-link","click",function(R){var P=z(R.currentTarget).closest(".common-comment-container");var Q=z(R.currentTarget).attr("data-item-id");PJTV.RemoteCommonComment.removeComment(Q,P)});z("body").delegate(".ban-user-link","click",function(S){var P=z(S.currentTarget).closest(".common-comment-container");var R=z(S.currentTarget).attr("data-user-id");var Q=z(S.currentTarget).attr("data-item-id");PJTV.RemoteCommonComment.banCommenter(R,Q,P)});z("body").delegate(".restore-comment-link","click",function(R){var P=z(R.currentTarget).closest(".common-comment-container");var Q=z(R.currentTarget).attr("data-item-id");PJTV.RemoteCommonComment.restoreComment(Q,P)});z("body").delegate(".show-more-link","click",function(R){var P=z(R.currentTarget).closest(".common-comment-container");var Q=z(R.currentTarget).attr("data-item-id");PJTV.RemoteCommonComment.showMore(Q,P)});z("body").delegate(".show-less-link","click",function(R){var P=z(R.currentTarget).closest(".common-comment-container");var Q=z(R.currentTarget).attr("data-item-id");PJTV.RemoteCommonComment.showLess(Q,P)})}function d(S,P,Q,R){if(!j){j=true;g=S;u=P;c(Q);o(R);A()}setTimeout(function(){z(".comment-highlight").addClass("comment-highlight-fadeout")},3000);if(PJInterop.CookieCache.get("isEmailVerified")==false){z(".common-comment-textarea").attr("placeholder","Your comment will not appear until you verify your email address. Please check your email to complete the registration process.")}N()}function f(Q){var P=RegExp("[?&]"+Q+"=([^&]*)").exec(window.location.search);return P&&decodeURIComponent(P[1].replace(/\+/g," "))}function e(){if((navigator.userAgent.match(/iPhone/i))||(navigator.userAgent.match(/iPod/i))){return true}return false}return{restoreComment:B,reportComment:t,banCommenter:D,removeComment:E,upVote:m,hideTopComments:G,reply:H,postComment:w,viewReportedComment:s,getComments:O,getPendingComments:N,linkToComment:v,showMore:r,showLess:F,initialize:d,submitting:x}}($));
