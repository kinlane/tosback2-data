/*
 RequireJS text 1.0.7 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/jrburke/requirejs for details
*/

/** @license
 *
 * SoundManager 2: JavaScript Sound for the Web
 * ----------------------------------------------
 * http://schillmania.com/projects/soundmanager2/
 *
 * Copyright (c) 2007, Scott Schiller. All rights reserved.
 * Code provided under the BSD License:
 * http://schillmania.com/projects/soundmanager2/license.txt
 *
 * V2.97a.20120318
 */

define("assets/scripts/events",["jquery"],function(e){"use strict";return{ANIMATING_HEADER:"animatingHeader",PRODUCT_CONTEXT_CHANGE:"productContextChange",PRODUCT_APPEND_DATA:"productAppendData",PRODUCT_LISTING_UPDATED:"productListingUpdated",MODAL_OPEN:"modalOpen",MODAL_CLOSE:"modalClose",SCROLL_TO_TOP:"scrollToTop",NAVIGATION_DISPLAYED:"navigationDisplayed",DRAWER_DATA_UPDATED:"drawerDataUpdated",DRAWER_RESIZE_REQUESTED:"drawerResizeRequested",$:e({})}}),define("assets/scripts/presenters/Navigation",["jquery","assets/scripts/events"],function(e,t){"use strict";var n=function(e){this.speed=330,this.delay=360,this.isOpen=!1,this.isAnimating=!1,this.openTimeout=null,this.closeTimeout=null,this.$container=null,this.$currentNavigation=null,this.animationTimer=null,this.$navigationList=e,this.bind()};return n.prototype.bind=function(){var n=this;n.$container=e(".drawer"),n.$container.on({mouseenter:function(){n.openDrawer()},mouseleave:function(){n.closeDrawer()}}),e("body").on(t.DRAWER_RESIZE_REQUESTED,function(e){n.$container.animate({height:e.height},200)}),e("#li-home").click(function(e){n.setNavCookie("")}),e("#li-home").find("a").click(function(e){n.setNavCookie("")}),n.selectActiveDrawer(),this.$navigationList.on({mouseenter:function(){n.clearTimeout("closeTimeout");var t=e(".nav-secondary",this);if(t.children().length<=1)return;n.$currentNavigation&&n.$currentNavigation.parent().removeClass("drawer-open"),n.$currentNavigation=t;if(n.isOpen){n.showNavigation();return}if(t.queue().length>2)return;n.openDrawer()},mouseleave:function(){n.closeDrawer()}})},n.prototype.clearTimeout=function(e){this[e]&&(clearTimeout(this[e]),this[e]=null)},n.prototype.openDrawer=function(){this.clearTimeout("closeTimeout");var e=this;!this.isOpen&&!this.openTimeout&&(this.openTimeout=setTimeout(function(){e.isOpen=!0,clearInterval(e.animationTimer),e.animationTimer=setInterval(function(){t.$.trigger(t.ANIMATING_HEADER)},16),e.$container.stop(!0).slideDown(e.speed,function(){e.showNavigation(),e.openTimeout=null,clearInterval(e.animationTimer)})},e.delay))},n.prototype.closeDrawer=function(){this.clearTimeout("openTimeout");var n=this;if(!this.$currentNavigation||this.$currentNavigation.children().length<=1)return;if(this.$currentNavigation.queue()&&this.$currentNavigation.queue().length>2)return;this.closeTimeout=setTimeout(function(){n.isOpen=!1,clearInterval(n.animationTimer),n.animationTimer=setInterval(function(){t.$.trigger(t.ANIMATING_HEADER)},16),n.$currentNavigation.fadeOut(n.speed/2),n.$currentNavigation.parent().removeClass("drawer-open"),n.$container.stop(!0).slideUp(n.speed,function(){e(".nav-secondary").hide(),clearInterval(n.animationTimer)})},n.delay)},n.prototype.showNavigation=function(){var n=this;this.$currentNavigation.parent().addClass("drawer-open");if(this.$currentNavigation.queue()&&this.$currentNavigation.queue().length>2||this.$currentNavigation.is(":visible"))return;e(".nav-secondary").hide();var r=this.$currentNavigation.height();this.$container.stop(!0).animate({height:r},function(){n.$currentNavigation.fadeIn(n.speed,function(){var r=e.Event(t.NAVIGATION_DISPLAYED,{id:n.$currentNavigation.attr("id")});e(this).trigger(r)})}),e(n.$currentNavigation.parent()).attr("id")!=="li-my-hallmark"&&e(this.$currentNavigation.parent()).find("a").click(function(t){var r=e(this).attr("href"),i=e(this).html(),s=e(n.$currentNavigation.parent()).attr("id");n.setNavCookie(s),e("#li-shop").removeClass("active"),e("#li-explore").removeClass("active"),e("#li-stores").removeClass("active"),e("#li-my-hallmark").removeClass("active"),n.$currentNavigation.parent().addClass("active")})},n.prototype.selectActiveDrawer=function(){var t=this,n=t.getNavCookie("current-nav");n!==""&&e("#"+n).addClass("active")},n.prototype.setNavCookie=function(e){var t="current-nav",n=new Date,r=new Date;r.setTime(n.getTime()+6e4),document.cookie=t+"="+escape(e)+";expires="+r.toGMTString()},n.prototype.getNavCookie=function(e){var t=" "+document.cookie,n=t.indexOf(" "+e+"=");n===-1&&(n=t.indexOf(";"+e+"="));if(n===-1||e==="")return"";var r=t.indexOf(";",n+1);return r===-1&&(r=t.length),unescape(t.substring(n+e.length+2,r))},n}),define("assets/scripts/presenters/ExternalLinks",["jquery"],function(e){"use strict";return{init:function(){e("a[rel=external]").attr("target","_blank")}}}),define("assets/scripts/presenters/Search",["jquery"],function(e){"use strict";var t=function(){var t=this,n=e(".header-main").find(".js-search-container").find("[data-url]").data("url");t.url=n||"http://hallmark.com/search/",e(".js-search-container").each(function(){var n=e(this),r=e("input.input-text",n),i=e('button,input[type="submit"]',n),s=e(".search-icon",n),o=r.data("original-placeholder");r.focus(function(){s.addClass("focus")}).focusout(function(){s.removeClass("focus")}),s.click(function(e){e.preventDefault(),t.search(r.val(),o)}),r.keyup(function(e){e.keyCode==13&&t.search(r.val(),o)})})};return t.prototype.search=function(e,t){var n=this;if(e==t||e=="")location.href=n.url+"nothingentered/";else{var r=encodeURIComponent(e);location.href=n.url+"?searchTerm="+r}},t}),define("assets/scripts/models/Storage",[],function(){"use strict";var e="localStorage",t="cookie",n=function(){document.cookie=this.namespace+"=;expires=-1;path=/"},r=function(){var e=document.cookie.match("(^|;) ?"+this.namespace+"=([^;]*)(;|$)");return e&&e[2].length?JSON.parse(decodeURI(e[2])):{}},i=function(e){var t=new Date;t.setDate(t.getDate()+365);var n="expires="+t.toGMTString();document.cookie=this.namespace+"="+encodeURI(JSON.stringify(e))+";"+n+";path=/"},s=function(e,t){var n=r.call(this);n[e]=t,i.call(this,n)},o=function(e){var t=r.call(this);return t[e]},u=function(e){var t=r.call(this);delete t[e],i.call(this,t)},a=function(n){this.namespace=n,this.type=t;try{window.hasOwnProperty(e)&&typeof localStorage=="object"&&localStorage!==null&&(this.type=e)}catch(r){}};return a.prototype.getType=function(){return this.type},a.prototype.getKey=function(e){return this.namespace+"_"+e},a.prototype.setItem=function(t,n){var r=this.getKey(t);if(this.getType()===e)try{localStorage.setItem(r,JSON.stringify(n))}catch(i){}else s.call(this,r,n);return this},a.prototype.getItem=function(t){var n=this.getKey(t);return this.getType()===e?JSON.parse(localStorage.getItem(n)):o.call(this,n)},a.prototype.removeItem=function(t){return this.getType()===e?localStorage.removeItem(t):u.call(this,t),this},a.prototype.getList=function(){var t={},n=0;if(this.getType()!==e)return r.call(this);for(n;n<localStorage.length;n++){var i=localStorage.key(n);t[i]=JSON.parse(localStorage.getItem(i))}return t},a.prototype.clear=function(){var r=this.getType();return r===e?localStorage.clear():r===t&&n.call(this),this},a}),function(){var e=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],t=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,n=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,r=typeof location!="undefined"&&location.href,i=r&&location.protocol&&location.protocol.replace(/\:/,""),s=r&&location.hostname,o=r&&(location.port||void 0),u=[];define("assets/scripts/libs/text",[],function(){var a,f,l;return typeof window!="undefined"&&window.navigator&&window.document?f=function(e,t){var n=a.createXhr();n.open("GET",e,!0),n.onreadystatechange=function(){n.readyState===4&&t(n.responseText)},n.send(null)}:typeof process!="undefined"&&process.versions&&process.versions.node?(l=require.nodeRequire("fs"),f=function(e,t){var n=l.readFileSync(e,"utf8");n.indexOf("\ufeff")===0&&(n=n.substring(1)),t(n)}):typeof Packages!="undefined"&&(f=function(e,t){var n=new java.io.File(e),r=java.lang.System.getProperty("line.separator"),n=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(n),"utf-8")),i,s,o="";try{i=new java.lang.StringBuffer,(s=n.readLine())&&s.length()&&s.charAt(0)===65279&&(s=s.substring(1));for(i.append(s);(s=n.readLine())!==null;)i.append(r),i.append(s);o=String(i.toString())}finally{n.close()}t(o)}),a={version:"1.0.7",strip:function(e){if(e){var e=e.replace(t,""),r=e.match(n);r&&(e=r[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},createXhr:function(){var t,n,r;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(n=0;n<3;n++){r=e[n];try{t=new ActiveXObject(r)}catch(i){}if(t){e=[r];break}}if(!t)throw Error("createXhr(): XMLHttpRequest not available");return t},get:f,parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),e=e.substring(n+1,e.length),n=e.indexOf("!");return n!==-1&&(t=e.substring(n+1,e.length),t=t==="strip",e=e.substring(0,n)),{moduleName:r,ext:e,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,n,r){var i=a.xdRegExp.exec(e),s;return i?(e=i[2],i=i[3],i=i.split(":"),s=i[1],i=i[0],(!e||e===t)&&(!i||i===n)&&(!s&&!i||s===r)):!0},finishLoad:function(e,t,n,r,i){n=t?a.strip(n):n,i.isBuild&&(u[e]=n),r(n)},load:function(e,t,n,u){if(u.isBuild&&!u.inlineText)n();else{var f=a.parseName(e),l=f.moduleName+"."+f.ext,c=t.toUrl(l),h=u&&u.text&&u.text.useXhr||a.useXhr;!r||h(c,i,s,o)?a.get(c,function(t){a.finishLoad(e,f.strip,t,n,u)}):t([l],function(e){a.finishLoad(f.moduleName+"."+f.ext,f.strip,e,n,u)})}},write:function(e,t,n){if(t in u){var r=a.jsEscape(u[t]);n.asModule(e+"!"+t,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,t,n,r,i){var t=a.parseName(t),s=t.moduleName+"."+t.ext,o=n.toUrl(t.moduleName+"."+t.ext)+".js";a.load(s,n,function(){var t=function(e){return r(o,e)};t.asModule=function(e,t){return r.asModule(e,o,t)},a.write(e,s,t,i)},i)}}})}(),define("assets/scripts/libs/text!assets/scripts/views/modals/modal-template.html",[],function(){return'<div id="js-modal-container" class="modal modal-loading mod is-hidden">\n    <div class="modal-content js-modal-content">\n        <a href="#" class="icon icon-close icon-close-modal js-close-modal">Close Modal</a>\n        <img class="js-loading" src="/assets/images/loadingicon-big.gif" alt="Page is loading...">\n    </div>\n</div>'}),define("assets/scripts/libs/text!assets/scripts/views/modals/overlay-template.html",[],function(){return'<div id="js-modal-overlay" class="overlay overlay-modal is-hidden"></div>'}),define("assets/scripts/presenters/modals/ModalHelper",["jquery"],function(e){"use strict";var t=function(){this.modalWidths={tiny:264,small:348,medium:514,large:680,xlarge:846,full:980},this.$modalContainer=null,this.$modalOverlay=null};return t.prototype.setContainerAndOverlay=function(e,t){this.$modalContainer=e,this.$modalOverlay=t},t.prototype.positionLoader=function(){var e=this.$modalContainer.find(".js-loading").eq(0);if(e.css("position")!=="absolute"){var t=e.height(),n=e.width(),r="-"+parseInt(t/2,10)+"px",i="-"+parseInt(n/2,10)+"px",s=this.$modalContainer.find(".js-modal-content").eq(0);s.css({overflow:"hidden",height:t+32,padding:0}),e.css({position:"absolute",top:"50%",left:"50%","margin-top":r,"margin-left":i})}},t.prototype.addNewContent=function(e,t,n,r){var i=this.$modalContainer.height();e.css({visibility:"hidden",width:n});var s=this.$modalContainer.find(".modal-content").eq(0);s.css("height",i).append(e);var o=e.height();t.css("position","absolute"),this.$modalContainer.animate({width:n,"margin-left":"-"+parseInt(n/2,10)+"px"},150),s.animate({height:o},150),e.css({display:"none",visibility:"visible"}).fadeIn(150,function(){r&&r(),t.remove(),s.css("height","auto")}),t.fadeOut(150)},t.prototype.transitionInContent=function(t,n,r){var i=n.width(),s=n.height();t.animate({width:i,"margin-left":"-"+parseInt(i/2,10)+"px"}),t.find(".modal-content").eq(0).animate({height:s},function(){var t=e(this);t.find(".js-loading").fadeOut(150),n.css({display:"none",visibility:"visible"}).fadeIn(150,function(){t.css("height","auto"),r&&r()})})},t.prototype.closeAndRemoveModal=function(){this.$modalOverlay.fadeOut(150),this.$modalContainer.fadeOut(150,function(){e(this).remove()})},t.prototype.getCurrentContentContainer=function(){var e=this.$modalContainer.find(".modal-content > div");return e},t}),define("assets/scripts/presenters/modals/ModalTemplate",["jquery","assets/scripts/presenters/modals/ModalHelper"],function(e,t){"use strict";var n=function(){this.modalHelper=new t};return n}),define("assets/scripts/libs/text!assets/scripts/views/modals/modal-offers-signup-template.html",[],function(){return'<div id="js-special-offers-signup" class="retrofit">\n    <div class="layout-inside-md">\n        <h2 class="layout-vr-sm">\n            <img src="/assets/images/copy/copy-good-news.png" alt="Good News...">\n        </h2>\n\n        <div class="copy-c layout-vr-md">\n            <p>We\'ll send you our special offers and keep you in the loop on our latest products.</p>\n        </div>\n\n        <form id="js-email-signup-form" action="/formmail/AddOnTheFlyPreference" data-success-model="#js-success-modal">\n            <fieldset>\n                <ul class="form-list form-secondary">\n                    <li id="js-email-container">\n                        <label class="hidden-content" for="email-address">Enter your email for offers</label>\n                        <input id="email-address" type="text" class="form-input input-text form-input-alt js-required js-validate-email" name="email" placeholder="Your email address" />\n                        <div class="error is-hidden" id="js-inline-email-error"></div>\n                    </li>\n                    <li>\n                        <button class="button btn-secondary">Sign Up</button>\n                        <span class="form-note">See our <a href="/privacy">privacy and security policy</a></span>\n                    </li>\n                </ul>\n            </fieldset>\n        </form>\n\n    </div>\n</div>'}),define("assets/scripts/libs/text!assets/scripts/views/modals/modal-success.html",[],function(){return'<div id="js-success-modal">\n    <div class="layout-inside-md">\n        <h2 class="layout-vr-sm">\n            <img src="/assets/images/copy/copy-thanks.png" alt="Thanks!">\n        </h2>\n\n        <p id="js-success-message"></p>\n\n\n    </div> <!-- end .modal inside -->\n</div>'}),define("assets/scripts/presenters/AutoReplace",["jquery"],function(e){"use strict";return{$fields:undefined,init:function(){var t=e("[placeholder]");if(t.length!==0){var n=this;n.$fields=t.addClass("placeholder-text"),n.bind()}},bind:function(){var t=this;t.$fields.each(function(){var t=e(this),n=t.attr("placeholder");t.attr("data-original-placeholder")===undefined&&t.attr("placeholder","").attr("data-original-placeholder",n).val(n),t.focus(function(){t.val()===n&&t.val("").removeClass("placeholder-text")}),t.blur(function(){t.val()===""&&t.val(n).addClass("placeholder-text")}),t.parents("form").submit(function(){if(t.is(".required")&&(t.val()===n||t.val()===""))return!1})})}}}),define("assets/scripts/helpers/EmailValidator",[],function(){"use strict";var e=function(){};return e.prototype.isValid=function(e){var t=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;return t.test(e)},e}),define("assets/scripts/view-helpers/FormValidator",["jquery","assets/scripts/helpers/EmailValidator"],function(e,t){"use strict";var n=function(){this.emailValidator=new t,this.FIELD_CONTAINER_ERROR_CSS_CLASS="form-error",this.INLINE_ERROR_CSS_CLASS="error",this.DEFAULT_VALUE_ATTR="data-original-placeholder",this.$inlineErrorTemplate='<div class="'+this.INLINE_ERROR_CSS_CLASS+'"></div>',this.REQUIRED_SELECTOR=".js-required",this.LENGTH_SELECTOR="[data-max-length]",this.VALIDATE_EMAIL_SELECTOR=".js-validate-email",this.VALIDATE_EMAILS_SELECTOR=".js-validate-emails"};return n.prototype.validate=function(e,t,n){var r=this;this.clearFormErrors();var i=!0,s=this.LENGTH_SELECTOR+","+this.REQUIRED_SELECTOR+","+this.VALIDATE_EMAIL_SELECTOR+","+this.VALIDATE_EMAILS_SELECTOR,o=e.find(s);for(var u=0;u<o.length;u++){var a=!0,f=o.eq(u),l=f.val(),c=f.attr(r.DEFAULT_VALUE_ATTR),h=f.prev("label").text();if(f.is(r.REQUIRED_SELECTOR)&&a)if(l===""||l===c){var p=h+" is a required field.";t&&typeof t[f.attr("name")].required!==undefined&&(p=t[f.attr("name")].required),this.addError(f,p),a=!1,i=!1}if(f.is(r.LENGTH_SELECTOR)&&a){var d=this.getMaxLength(f);if(typeof l!="string"||l.length>d){var p=h+" must be less than or equal to "+d+" characters.";t&&typeof t[f.attr("name")].maxlength!==undefined&&(p=t[f.attr("name")].maxlength),this.addError(f,p),a=!1,i=!1}}if(f.is(r.VALIDATE_EMAIL_SELECTOR)&&a&&!this.emailValidator.isValid(l)){var p=h+" is an invalid email.";t&&typeof t[f.attr("name")].emailFormat!==undefined&&(p=t[f.attr("name")].emailFormat),this.addError(f,p),a=!1,i=!1}if(f.is(r.VALIDATE_EMAILS_SELECTOR)&&a){var v=!0,m=l.split(",");for(var g=0;g<m.length;g++)if(v){var y=m[g].trim();this.emailValidator.isValid(y)||(v=!1)}if(!v){var p=h+" email addresses need to be valid.";t&&typeof t[f.attr("name")].emailsFormat!==undefined&&(p=t[f.attr("name")].emailsFormat),this.addError(f,p),a=!1,i=!1}}}i&&n()},n.prototype.addError=function(t,n){var r=this,i=t.parents("li").eq(0);i.addClass(r.FIELD_CONTAINER_ERROR_CSS_CLASS);var s=e(r.$inlineErrorTemplate).text(n);t.after(s)},n.prototype.clearFormErrors=function(t){var n=this;e("."+n.FIELD_CONTAINER_ERROR_CSS_CLASS,t).removeClass(n.FIELD_CONTAINER_ERROR_CSS_CLASS);var r=e("."+n.INLINE_ERROR_CSS_CLASS,t);e("."+n.INLINE_ERROR_CSS_CLASS,t).remove()},n.prototype.getMaxLength=function(e){return parseInt(e.data("max-length"),10)},n}),define("assets/scripts/presenters/product/browse/SpecialOffersModal",["jquery","assets/scripts/presenters/modals/ModalTemplate","assets/scripts/libs/text!assets/scripts/views/modals/modal-offers-signup-template.html","assets/scripts/libs/text!assets/scripts/views/modals/modal-success.html","assets/scripts/presenters/AutoReplace","assets/scripts/view-helpers/FormValidator"],function(e,t,n,r,i,s){"use strict";var o=function(){this.$emailContainer=null,this.$inlineEmailErrorContainer=null,this.ERROR_CONTAINER_CSS_CLASS="form-error"};return o.prototype=new t,o.prototype.fetchContent=function(t,r,i){var s=this,o=e(n);o.css("width",s.modalHelper.modalWidths.small),r(o,i)},o.prototype.bind=function(){var t=this;this.$emailContainer=e("#js-email-container"),this.$inlineEmailErrorContainer=e("#js-inline-email-error"),i.init(),e("#js-email-signup-form").submit(function(n){var i=e(this).attr("data-success-model");n.preventDefault();var o=e(this),u=o.attr("action"),a=e(r),f="You\u2019ll hear from us soon.";a.find("#js-success-message").text(f);var l={email:{required:"E-mail address is required",emailFormat:"Invalid e-mail address"}},c=new s;c.validate(o,l,function(){var n=e(r),i="You\u2019ll hear from us soon.";n.find("#js-success-message").text(i),t.submitForm(u,{emailAddress:e("#email-address").val()},function(){t.modalHelper.addNewContent(n,e("#js-special-offers-signup"),t.modalHelper.modalWidths.tiny)})})})},o.prototype.showError=function(e){var t=this;this.$emailContainer.addClass(t.ERROR_CONTAINER_CSS_CLASS),this.$inlineEmailErrorContainer.html(e).fadeIn(150)},o.prototype.clearError=function(){var e=this;this.$emailContainer.removeClass(e.ERROR_CONTAINER_CSS_CLASS),this.$inlineEmailErrorContainer.html("").hide()},o.prototype.submitForm=function(t,n,r){var i=this;e.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:t,data:n,dataType:"json",success:function(e){e.JsonError!==null&&e.JsonError!==""?i.showError(e.JsonError):r()}})},o}),define("assets/scripts/presenters/product/detail/AlternateImages",["jquery"],function(e){"use strict";var t=function(e){this.$productView=null,this.ACTIVE_CSS_CLASS="active",this.FADE_DURATION=150,this.init(),this.bind(),this.joinedRotationControl=e,this.analyticsTracked=!1};return t.prototype.init=function(){this.$productView=e(".product-view").eq(0)},t.prototype.bind=function(){var t=this;e(".media-alt > li").on({click:function(n){n.preventDefault(),n.stopPropagation();var r=e(this),i=r.index(),o=r.find("img");o&&!t.$productView.find(".product-image").eq(i).hasClass(t.ACTIVE_CSS_CLASS)&&(r.hasClass("js-rotation")?t.updateImageView(i,"showSlider"):t.updateImageView(i,"hideSlider")),t.analyticsTracked||(t.analyticsTracked=!0,s.prop20="AlternateImage>"+s.prop7,s.linkTrackVars="prop20",s.tl(this,"o","AlternateImage"))}})},t.prototype.updateImageView=function(t,n){var r=this;this.$productView.find("img.active").fadeOut(r.FADE_DURATION,function(){var t=e(this);e(this).removeClass(r.ACTIVE_CSS_CLASS)}),r.$productView.find(".product-image").eq(t).fadeIn(r.FADE_DURATION,function(){e(this).addClass(r.ACTIVE_CSS_CLASS)}),n==="hideSlider"&&e(".slider").fadeOut(r.FADE_DURATION),n==="showSlider"&&(e(".slider").fadeIn(r.FADE_DURATION),this.joinedRotationControl.moveSlider(!0))},t}),define("assets/scripts/libs/text!assets/scripts/views/product/browse/product-grid-templates.html",[],function(){return'<div>\n    <ul>\n        <li class="js-hidden-items">\n            <ul></ul>\n        </li>\n    </ul>\n    <li class="more js-see-more">\n        <a href="#">See more</a>\n    </li>\n    <li class="more js-see-less" style="display:none;">\n        <a href="#">See less</a>\n    </li>\n\n    <div class="loader-icon js-loading-icon"><img src="/assets/images/loadingIcon-small.gif"/></div>\n    <div class="loader-overlay js-loading-overlay"></div>\n\n\n    <li class="js-featured-product mod mod-product mod-product-dbl grid grid-6" style="visibility: visible; display: list-item;">\n        <div class="item-feature-note"></div>\n\n        <ul class="item-features" style="display:none">\n            <li class="icon-set icon-sound">This product speaks</li>\n            <li class="icon-set icon-motion">This product has motion</li>\n            <li class="icon-set icon-light">This product has light</li>\n            <li class="icon-set icon-interactive">This product is interactive</li>\n        </ul>\n\n        <div class="icon-purchased icon" style="display:none">Purchased</div>\n\n        <div class="product-link">\n            <a data-modal-size="full" data-modal-persistence="true" data-modal-type="quicklook" style="" class="action-quick-look" href="#">Quick Look</a>\n            <a class="js-product-image" href="#">\n                <img alt="Hallmark Product" src="/assets/content/fpo-product-double.jpg">\n            </a>\n        </div> <!-- end .product-link -->\n\n        <div class="mod-body mod-body-dbl">\n            <ul class="color-swatches layout-vr-tiny" style="visibility:hidden">\n                <li class="active"><a href="#"><img alt="Lime Green" src="/assets/images/swatch-lime-green.png"></a></li>\n                <li><a href="#"><img alt="Lime Green" src="/assets/images/swatch-purple.png"></a></li>\n                <li><a href="#"><img alt="Maroon" src="/assets/images/swatch-maroon.png"></a></li>\n                <li><a href="#"><img alt="Blue" src="/assets/images/swatch-blue.png"></a></li>\n                <li><a href="#"><img alt="Yellow" src="/assets/images/swatch-yellow.png"></a></li>\n                <li><a href="#"><img alt="Magenta" src="/assets/images/swatch-magenta.png"></a></li>\n                <li><a href="#"><img alt="Green" src="/assets/images/swatch-green.png"></a></li>\n                <li><a href="#"><img alt="Tweed" src="/assets/images/swatch-tweed.png"></a></li>\n            </ul>\n            <div class="wrapper-rating">\n                <div class="rating-default"></div>\n                <div style="width:68%;" class="rating-percentage"></div>\n                <div class="rating-overlay">Rating 3.2 of 5 stars</div>\n            </div>\n            <h2 class="heading-f heading-product heading-heavy"><a href="#">Finished Good Name</a></h2>\n            <ul class="mod-description layout-vr-tiny">\n                <li></li>\n                <li></li>\n                <li></li>\n            </ul>\n            <div class="price layout-vr-tiny">$18.95</div>\n            <div class="copy-highlight-offer copy-d">SPECIAL OFFER</div>\n        </div> <!-- end .mod-body -->\n\n        <div class="item-note item-note-ext" style="visibility: hidden"></div>\n    </li>\n\n</div>'}),define("assets/scripts/presenters/product/LoaderIcon",["jquery","assets/scripts/libs/text!assets/scripts/views/product/browse/product-grid-templates.html"],function(e,t){"use strict";var n=function(n){this.$container=n,this.$overlay=e(t).find(".js-loading-overlay").clone(),this.$icon=e(t).find(".js-loading-icon").clone(),this.iconTopOffset=100,this.iconLeftOffset=23,this.fadeInDuration=200,this.fadeOutDuration=200,e("body").append(this.$overlay),this.$overlay.hide(),e("body").append(this.$icon),this.$icon.hide()};return n.prototype.calculatePosition=function(){var e=this.$container.width(),t=this.$container.height(),n=this.$container.offset().top,r=this.$container.offset().left;this.$overlay.css({top:n,left:r,width:e,height:t});var i=n+this.iconTopOffset,s=r+e/2-this.iconLeftOffset;this.$icon.css({top:i,left:s})},n.prototype.display=function(){this.calculatePosition(),this.$overlay.fadeIn(this.fadeInDuration),this.$icon.fadeIn(this.fadeInDuration)},n.prototype.hide=function(){var e=this;this.$overlay.fadeOut(this.fadeOutDuration,function(){e.$overlay.remove()}),this.$icon.fadeOut(this.fadeOutDuration,function(){e.$icon.remove()})},n}),define("assets/scripts/models/product/ProductApi",["jquery"],function(e){"use strict";var t,n="/products/search/",r=!1,i=null,s={requestedpage:1,includenavigation:"True"},o={filterby:"",filtervalue:"",sortby:"",sortdirection:""},u={},a=function(){u={}},f=function(){i!==null&&i.abort()},l=function(e){var t=JSON.stringify(e);return typeof u[t]!="undefined"},c=function(e){var t;for(t in o)o.hasOwnProperty(t)&&(typeof e[t]!="undefined"?o[t]=e[t]:o[t]!==""&&(e[t]=o[t]));for(t in s)s.hasOwnProperty(t)&&typeof e[t]=="undefined"&&(e[t]=s[t]);return e.sortby==="featured"&&delete e.sortby,e.sortdirection==="asc"&&delete e.sortdirection,e},h=function(t,n,s,o,a){var f=JSON.stringify(n);o=o||function(){},a=a||function(){},l(n)?o.call(s,u[f]):(r=!0,i=e.ajax({url:t,dataType:"html",data:n,success:function(e){u[f]=e,r=!1,o.call(s,e)},error:function(e){r=!1,a.call(s,e)}}))},p=function(e,t,n,i,s){var o;r?o=setInterval(function(){r||(clearInterval(o),h(e,t,n,i,s))},100):h(e,t,n,i,s)},d=function(){var e;for(e in o)o.hasOwnProperty(e)&&(o[e]="")},v=function(){return{fetchProductData:function(t,r,i,s){t=c(t),t.offset=0,e(".js-product-item[data-offset]").each(function(){var n=parseInt(e(this).data("offset"),10);n>t.offset&&(t.offset=n)}),p(n,t,r,i,s)},fetchProductPreviewData:function(e,t,n,r){var i={url:e,featured:!1};p(e,i,t,n,r)},fetchFeaturedProductData:function(e,t,n,r){var i={url:e,featured:!0};p(e,i,t,n,r)},killCurrentRequest:function(){f()},clearSavedSettings:function(){d()}}};return{getInstance:function(){return t||(t=v()),t}}}),define("assets/scripts/models/AjaxHelper",["jquery"],function(e){"use strict";var t=function(){};return t.prototype.doAjax=function(t,n,r,i,s){e.ajax({type:t,contentType:"application/x-www-form-urlencoded",url:n,data:r,success:function(e){i(e,s)}})},t}),define("assets/scripts/presenters/AddedTextChanger",["jquery","assets/scripts/models/AjaxHelper","assets/scripts/events"],function(e,t,n){"use strict";var r=function(e){this.$element=e};return r.prototype.bind=function(){var n=this;this.$element.click(function(r){r.preventDefault();var i=new t,s=e(this).attr("href"),o=function(e){typeof e=="string"?e.match(/not/i)?n.errorText():n.changeText():e.JsonError?n.errorText():n.changeText()};i.doAjax("POST",s,null,o,n)})},r.prototype.changeText=function(){e("body").trigger(e.Event(n.DRAWER_DATA_UPDATED));var t="js-copy-success",r=this.$element;if(!r.hasClass(t)){var i=r.text(),s=i.replace("Add ","Added ");r.addClass(t).text(s);var o=function(){r.text(i).removeClass(t)};setTimeout(o,2500)}},r.prototype.errorText=function(){var e="error",t=this.$element;if(!t.hasClass(e)){var n=t.text(),r="Unable to save this item";t.addClass(e).text(r);var i=function(){t.text(n).removeClass(e)};setTimeout(i,2500)}},r}),define("assets/scripts/presenters/product/AudioControl",["jquery"],function(e){"use strict";var t=function(t){var n=this;n.$audioElement=e(t),this.audioListen=e("#audio-listen",n.$audioElement[0]),this.$listenIcon=e(".icon-listen.icon",n.$audioElement),this.mp3Path=e(".mp3-source",n.$audioElement).attr("src"),this.finishedPlaying=function(){n.clearAnimate()},this.useSoundManager=function(){window.soundManager.beginDelayedInit(),this.playFlash()},this.$modalOverlay=e("#js-modal-overlay"),n.audioListen&&n.audioListen.canPlayType?n.audioListen.canPlayType("audio/mpeg")?this.bind():this.useSoundManager():this.useSoundManager()};return t.prototype.bind=function(){var t=this;t.$listenIcon.on({click:function(e){e.preventDefault(),t.audioListen.paused?(t.audioListen.play(),t.buttonPlay()):(t.audioListen.pause(),t.buttonPause())}}),e(t.$modalOverlay,".icon-close-modal").on({click:function(e){e.preventDefault(),t.stopPlayback()}}),e(window).on("keydown",function(e){e.keyCode=="27"&&t.stopPlayback()}),t.stopPlayback=function(){t.audioListen.playing&&t.audioListen.pause()},t.audioListen.addEventListener("ended",t.finishedPlaying)},t.prototype.playFlash=function(){var t=this;soundManager.onready(function(){var n="listenAudio"+t.$audioElement.attr("id"),r=soundManager.createSound({id:n,url:t.mp3Path,onfinish:t.finishedPlaying});t.$listenIcon.on({click:function(e){e.preventDefault(),r.playState===0||r.paused?(r.play("listenAudio"),t.buttonPlay()):(r.pause(),t.buttonPause())}}),e(".icon-close-modal").on({click:function(e){e.preventDefault(),t.stopPlayback()}}),e(window).on("keydown",function(e){e.keyCode=="27"&&t.stopPlayback()}),t.$modalOverlay.on({click:function(e){t.stopPlayback(),e.stopPropagation()}}),t.stopPlayback=function(){r.playState!==0&&r.pause()}})},t.prototype.buttonPlay=function(){var e=this,t=1,n=3;this.prevClass=null;var r="playing-"+t,i=function(){e.$listenIcon.removeClass(e.prevClass),e.$listenIcon.addClass(r),t<n?t++:t=1,e.prevClass=r,r="playing-"+t};e.$listenIcon.removeClass("paused"),i(),e.repeater=setInterval(function(){i()},400),e.clearAnimate=function(){clearInterval(e.repeater),e.$listenIcon.removeClass(e.prevClass)}},t.prototype.buttonPause=function(){this.clearAnimate(),this.$listenIcon.addClass("paused")},t}),function(e){function n(t,n){function Yt(e){return function(t){var n=this._t;return!n||!n._a?null:e.call(this,t)}}this.flashVersion=8,this.debugMode=!1,this.debugFlash=!1,this.useConsole=!0,this.consoleOnly=!0,this.waitForWindowLoad=!1,this.bgColor="#ffffff",this.useHighPerformance=!1,this.flashPollingInterval=null,this.html5PollingInterval=null,this.flashLoadTimeout=1e3,this.wmode=null,this.allowScriptAccess="always",this.useFlashBlock=!1,this.useHTML5Audio=!0,this.html5Test=/^(probably|maybe)$/i,this.preferFlash=!0,this.noSWFCache=!1,this.audioFormats={mp3:{type:['audio/mpeg; codecs="mp3"',"audio/mpeg","audio/mp3","audio/MPA","audio/mpa-robust"],required:!0},mp4:{related:["aac","m4a"],type:['audio/mp4; codecs="mp4a.40.2"',"audio/aac","audio/x-m4a","audio/MP4A-LATM","audio/mpeg4-generic"],required:!1},ogg:{type:["audio/ogg; codecs=vorbis"],required:!1},wav:{type:['audio/wav; codecs="1"',"audio/wav","audio/wave","audio/x-wav"],required:!1}},this.defaultOptions={autoLoad:!1,autoPlay:!1,from:null,loops:1,onid3:null,onload:null,whileloading:null,onplay:null,onpause:null,onresume:null,whileplaying:null,onposition:null,onstop:null,onfailure:null,onfinish:null,multiShot:!0,multiShotEvents:!1,position:null,pan:0,stream:!0,to:null,type:null,usePolicyFile:!1,volume:100},this.flash9Options={isMovieStar:null,usePeakData:!1,useWaveformData:!1,useEQData:!1,onbufferchange:null,ondataerror:null},this.movieStarOptions={bufferTime:3,serverURL:null,onconnect:null,duration:null},this.movieID="sm2-container",this.id=n||"sm2movie",this.debugID="soundmanager-debug",this.debugURLParam=/([#?&])debug=1/i,this.versionNumber="V2.97a.20120318",this.version=null,this.movieURL=null,this.url=t||null,this.altURL=null,this.swfLoaded=!1,this.enabled=!1,this.oMC=null,this.sounds={},this.soundIDs=[],this.muted=!1,this.didFlashBlock=!1,this.filePattern=null,this.filePatterns={flash8:/\.mp3(\?.*)?$/i,flash9:/\.mp3(\?.*)?$/i},this.features={buffering:!1,peakData:!1,waveformData:!1,eqData:!1,movieStar:!1},this.sandbox={},this.hasHTML5=function(){try{return typeof Audio!="undefined"&&typeof (new Audio).canPlayType!="undefined"}catch(e){return!1}}(),this.html5={usingFlash:null},this.flash={},this.html5Only=!1,this.ignoreFlash=!1;var r,i=this,s=null,o="soundManager",u=o+"::",a="HTML5::",f,l=navigator.userAgent,c=e,h=c.location.href.toString(),p=document,d,v,m,g=[],y=!0,b,w=!1,E=!1,S=!1,x=!1,T=!1,N,C=0,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V=["log","info","warn","error"],$=8,J,K,Q,G=null,Y=null,Z,et,tt,nt,rt,it,st,ot,ut,at=!1,ft=!1,lt,ct,ht,pt=0,dt=null,vt,mt=null,gt,yt,bt,wt,Et,St,xt,Tt,Nt=Array.prototype.slice,Ct=!1,kt,Lt,At,Ot,Mt,_t=l.match(/(ipad|iphone|ipod)/i),Dt=l.match(/firefox/i),Pt=l.match(/droid/i),Ht=l.match(/msie/i),Bt=l.match(/webkit/i),jt=l.match(/safari/i)&&!l.match(/chrome/i),Ft=l.match(/opera/i),It=l.match(/(mobile|pre\/|xoom)/i)||_t,qt=!h.match(/usehtml5audio/i)&&!h.match(/sm2\-ignorebadua/i)&&jt&&!l.match(/silk/i)&&l.match(/OS X 10_6_([3-7])/i),Rt=typeof console!="undefined"&&typeof console.log!="undefined",Ut=typeof p.hasFocus!="undefined"?p.hasFocus():null,zt=jt&&typeof p.hasFocus=="undefined",Wt=!zt,Xt=/(mp3|mp4|mpa)/i,Vt="about:blank",$t=p.location?p.location.protocol.match(/http/i):null,Jt=$t?"":"http://",Kt=/^\s*audio\/(?:x-)?(?:mpeg4|aac|flv|mov|mp4||m4v|m4a|mp4v|3gp|3g2)\s*(?:$|;)/i,Qt=["mpeg4","aac","flv","mov","mp4","m4v","f4v","m4a","mp4v","3gp","3g2"],Gt=new RegExp("\\.("+Qt.join("|")+")(\\?.*)?$","i");this.mimePattern=/^\s*audio\/(?:x-)?(?:mp(?:eg|3))\s*(?:$|;)/i,this.useAltURL=!$t,this._global_a=null,nt={swfBox:"sm2-object-box",swfDefault:"movieContainer",swfError:"swf_error",swfTimedout:"swf_timedout",swfLoaded:"swf_loaded",swfUnblocked:"swf_unblocked",sm2Debug:"sm2_debug",highPerf:"high_performance",flashDebug:"flash_debug"},It&&(i.useHTML5Audio=!0,i.preferFlash=!1,_t&&(i.ignoreFlash=!0,Ct=!0)),this.ok=function(){return mt?S&&!x:i.useHTML5Audio&&i.hasHTML5},this.supported=this.ok,this.getMovie=function(e){return f(e)||p[e]||c[e]},this.createSound=function(e){function f(){return o=it(o),i.sounds[a.id]=new r(a),i.soundIDs.push(a.id),i.sounds[a.id]}var t,n,o=null,u=null,a=null;return!S||!i.ok()?(ot(n),!1):(arguments.length===2&&(e={id:arguments[0],url:arguments[1]}),o=L(e),o.url=vt(o.url),a=o,ut(a.id,!0)?i.sounds[a.id]:(yt(a)?(u=f(),u._setup_html5(a)):(m>8&&(a.isMovieStar===null&&(a.isMovieStar=a.serverURL||(a.type?a.type.match(Kt):!1)||a.url.match(Gt)),a.isMovieStar&&a.usePeakData&&(a.usePeakData=!1)),a=st(a,t),u=f(),m===8?s._createSound(a.id,a.loops||1,a.usePolicyFile):(s._createSound(a.id,a.url,a.usePeakData,a.useWaveformData,a.useEQData,a.isMovieStar,a.isMovieStar?a.bufferTime:!1,a.loops||1,a.serverURL,a.duration||null,a.autoPlay,!0,a.autoLoad,a.usePolicyFile),a.serverURL||(u.connected=!0,a.onconnect&&a.onconnect.apply(u))),!a.serverURL&&(a.autoLoad||a.autoPlay)&&u.load(a)),!a.serverURL&&a.autoPlay&&u.play(),u))},this.destroySound=function(e,t){if(!ut(e))return!1;var n=i.sounds[e],r;n._iO={},n.stop(),n.unload();for(r=0;r<i.soundIDs.length;r++)if(i.soundIDs[r]===e){i.soundIDs.splice(r,1);break}return t||n.destruct(!0),n=null,delete i.sounds[e],!0},this.load=function(e,t){return ut(e)?i.sounds[e].load(t):!1},this.unload=function(e){return ut(e)?i.sounds[e].unload():!1},this.onPosition=function(e,t,n,r){return ut(e)?i.sounds[e].onposition(t,n,r):!1},this.onposition=this.onPosition,this.clearOnPosition=function(e,t,n){return ut(e)?i.sounds[e].clearOnPosition(t,n):!1},this.play=function(e,t){return!S||!i.ok()?(ot(o+".play(): "+Z(S?"notOK":"notReady")),!1):ut(e)?i.sounds[e].play(t):(t instanceof Object||(t={url:t}),t&&t.url?(t.id=e,i.createSound(t).play()):!1)},this.start=this.play,this.setPosition=function(e,t){return ut(e)?i.sounds[e].setPosition(t):!1},this.stop=function(e){return ut(e)?i.sounds[e].stop():!1},this.stopAll=function(){var e;for(e in i.sounds)i.sounds.hasOwnProperty(e)&&i.sounds[e].stop()},this.pause=function(e){return ut(e)?i.sounds[e].pause():!1},this.pauseAll=function(){var e;for(e=i.soundIDs.length-1;e>=0;e--)i.sounds[i.soundIDs[e]].pause()},this.resume=function(e){return ut(e)?i.sounds[e].resume():!1},this.resumeAll=function(){var e;for(e=i.soundIDs.length-1;e>=0;e--)i.sounds[i.soundIDs[e]].resume()},this.togglePause=function(e){return ut(e)?i.sounds[e].togglePause():!1},this.setPan=function(e,t){return ut(e)?i.sounds[e].setPan(t):!1},this.setVolume=function(e,t){return ut(e)?i.sounds[e].setVolume(t):!1},this.mute=function(e){var t=0;typeof e!="string"&&(e=null);if(!e){for(t=i.soundIDs.length-1;t>=0;t--)i.sounds[i.soundIDs[t]].mute();return i.muted=!0,!0}return ut(e)?i.sounds[e].mute():!1},this.muteAll=function(){i.mute()},this.unmute=function(e){var t;typeof e!="string"&&(e=null);if(!e){for(t=i.soundIDs.length-1;t>=0;t--)i.sounds[i.soundIDs[t]].unmute();return i.muted=!1,!0}return ut(e)?i.sounds[e].unmute():!1},this.unmuteAll=function(){i.unmute()},this.toggleMute=function(e){return ut(e)?i.sounds[e].toggleMute():!1},this.getMemoryUse=function(){var e=0;return s&&m!==8&&(e=parseInt(s._getMemoryUse(),10)),e},this.disable=function(e){var t;typeof e=="undefined"&&(e=!1);if(x)return!1;x=!0;for(t=i.soundIDs.length-1;t>=0;t--)J(i.sounds[i.soundIDs[t]]);return k(e),Tt.remove(c,"load",M),!0},this.canPlayMIME=function(e){var t;return i.hasHTML5&&(t=bt({type:e})),!mt||t?t:e&&i.ok()?!!((m>8?e.match(Kt):null)||e.match(i.mimePattern)):null},this.canPlayURL=function(e){var t;return i.hasHTML5&&(t=bt({url:e})),!mt||t?t:e&&i.ok()?!!e.match(i.filePattern):null},this.canPlayLink=function(e){return typeof e.type!="undefined"&&e.type&&i.canPlayMIME(e.type)?!0:i.canPlayURL(e.href)},this.getSoundById=function(e,t){if(!e)throw new Error(o+".getSoundById(): sID is null/undefined");var n=i.sounds[e];return n},this.onready=function(e,t){var n="onready";if(e&&e instanceof Function)return t||(t=c),A(n,e,t),O(),!0;throw Z("needFunction",n)},this.ontimeout=function(e,t){var n="ontimeout";if(e&&e instanceof Function)return t||(t=c),A(n,e,t),O({type:n}),!0;throw Z("needFunction",n)},this._writeDebug=function(e,t,n){return!0},this._wD=this._writeDebug,this._debug=function(){},this.reboot=function(){var e,t;for(e=i.soundIDs.length-1;e>=0;e--)i.sounds[i.soundIDs[e]].destruct();try{Ht&&(Y=s.innerHTML),G=s.parentNode.removeChild(s)}catch(n){}Y=G=mt=null,i.enabled=q=S=at=ft=w=E=x=i.swfLoaded=!1,i.soundIDs=[],i.sounds={},s=null;for(e in g)if(g.hasOwnProperty(e))for(t=g[e].length-1;t>=0;t--)g[e][t].fired=!1;c.setTimeout(i.beginDelayedInit,20)},this.getMoviePercent=function(){return s&&typeof s.PercentLoaded!="undefined"?s.PercentLoaded():null},this.beginDelayedInit=function(){T=!0,F(),setTimeout(function(){return ft?!1:(U(),j(),ft=!0,!0)},20),_()},this.destruct=function(){i.disable(!0)},r=function(e){var t=this,n,r,o,u,a,f,l=!1,c=[],h=0,p,d,v=null,g;g={duration:null,time:null},this.sID=e.id,this.url=e.url,this.options=L(e),this.instanceOptions=this.options,this._iO=this.instanceOptions,this.pan=this.options.pan,this.volume=this.options.volume,this.isHTML5=!1,this._a=null,this.id3={},this._debug=function(){},this.load=function(e){var n=null,r;typeof e!="undefined"?(t._iO=L(e,t.options),t.instanceOptions=t._iO):(e=t.options,t._iO=e,t.instanceOptions=t._iO,v&&v!==t.url&&(t._iO.url=t.url,t.url=null)),t._iO.url||(t._iO.url=t.url),t._iO.url=vt(t._iO.url);if(t._iO.url===t.url&&t.readyState!==0&&t.readyState!==2)return t.readyState===3&&t._iO.onload&&t._iO.onload.apply(t,[!!t.duration]),t;r=t._iO,v=t.url,t.loaded=!1,t.readyState=1,t.playState=0;if(yt(r))n=t._setup_html5(r),n._called_load||(t._html5_canplay=!1,t._a.autobuffer="auto",t._a.preload="auto",n.load(),n._called_load=!0,r.autoPlay&&t.play());else try{t.isHTML5=!1,t._iO=st(it(r)),r=t._iO,m===8?s._load(t.sID,r.url,r.stream,r.autoPlay,r.whileloading?1:0,r.loops||1,r.usePolicyFile):s._load(t.sID,r.url,!!r.stream,!!r.autoPlay,r.loops||1,!!r.autoLoad,r.usePolicyFile)}catch(i){z({type:"SMSOUND_LOAD_JS_EXCEPTION",fatal:!0})}return t},this.unload=function(){return t.readyState!==0&&(t.isHTML5?(u(),t._a&&(t._a.pause(),Et(t._a))):m===8?s._unload(t.sID,Vt):s._unload(t.sID),n()),t},this.destruct=function(e){t.isHTML5?(u(),t._a&&(t._a.pause(),Et(t._a),Ct||o(),t._a._t=null,t._a=null)):(t._iO.onfailure=null,s._destroySound(t.sID)),e||i.destroySound(t.sID,!0)},this.play=function(e,n){var r,i,o,u;n=n===undefined?!0:n,e||(e={}),t._iO=L(e,t._iO),t._iO=L(t._iO,t.options),t._iO.url=vt(t._iO.url),t.instanceOptions=t._iO;if(t._iO.serverURL&&!t.connected)return t.getAutoPlay()||t.setAutoPlay(!0),t;yt(t._iO)&&(t._setup_html5(t._iO),a());if(t.playState===1&&!t.paused){i=t._iO.multiShot;if(!i)return t}if(!t.loaded)if(t.readyState===0)t.isHTML5||(t._iO.autoPlay=!0),t.load(t._iO);else if(t.readyState===2)return t;!t.isHTML5&&m===9&&t.position>0&&t.position===t.duration&&(e.position=0);if(t.paused&&t.position&&t.position>0)t.resume();else{t._iO=L(e,t._iO);if(t._iO.from!==null&&t._iO.to!==null&&t.instanceCount===0&&t.playState===0&&!t._iO.serverURL){u=function(){t._iO=L(e,t._iO),t.play(t._iO)};if(t.isHTML5&&!t._html5_canplay)return t.load({_oncanplay:u}),!1;if(!t.isHTML5&&!t.loaded&&(!t.readyState||t.readyState!==2))return t.load({onload:u}),!1;t._iO=d()}(!t.instanceCount||t._iO.multiShotEvents||!t.isHTML5&&m>8&&!t.getAutoPlay())&&t.instanceCount++,t.playState===0&&t._iO.onposition&&f(t),t.playState=1,t.paused=!1,t.position=typeof t._iO.position!="undefined"&&!isNaN(t._iO.position)?t._iO.position:0,t.isHTML5||(t._iO=st(it(t._iO))),t._iO.onplay&&n&&(t._iO.onplay.apply(t),l=!0),t.setVolume(t._iO.volume,!0),t.setPan(t._iO.pan,!0),t.isHTML5?(a(),o=t._setup_html5(),t.setPosition(t._iO.position),o.play()):s._start(t.sID,t._iO.loops||1,m===9?t._iO.position:t._iO.position/1e3)}return t},this.start=this.play,this.stop=function(e){var n=t._iO,r;return t.playState===1&&(t._onbufferchange(0),t._resetOnPosition(0),t.paused=!1,t.isHTML5||(t.playState=0),p(),n.to&&t.clearOnPosition(n.to),t.isHTML5?t._a&&(r=t.position,t.setPosition(0),t.position=r,t._a.pause(),t.playState=0,t._onTimer(),u()):(s._stop(t.sID,e),n.serverURL&&t.unload()),t.instanceCount=0,t._iO={},n.onstop&&n.onstop.apply(t)),t},this.setAutoPlay=function(e){t._iO.autoPlay=e,t.isHTML5||(s._setAutoPlay(t.sID,e),e&&!t.instanceCount&&t.readyState===1&&t.instanceCount++)},this.getAutoPlay=function(){return t._iO.autoPlay},this.setPosition=function(e){e===undefined&&(e=0);var n,r,i,o=t.isHTML5?Math.max(e,0):Math.min(t.duration||t._iO.duration,Math.max(e,0));n=t.position,t.position=o,i=t.position/1e3,t._resetOnPosition(t.position),t._iO.position=o;if(!t.isHTML5)r=m===9?t.position:i,t.readyState&&t.readyState!==2&&s._setPosition(t.sID,r,t.paused||!t.playState);else if(t._a&&t._html5_canplay&&t._a.currentTime!==i)try{t._a.currentTime=i,(t.playState===0||t.paused)&&t._a.pause()}catch(u){}return t.isHTML5&&t.paused&&t._onTimer(!0),t},this.pause=function(e){return t.paused||t.playState===0&&t.readyState!==1?t:(t.paused=!0,t.isHTML5?(t._setup_html5().pause(),u()):(e||e===undefined)&&s._pause(t.sID),t._iO.onpause&&t._iO.onpause.apply(t),t)},this.resume=function(){var e=t._iO;return t.paused?(t.paused=!1,t.playState=1,t.isHTML5?(t._setup_html5().play(),a()):(e.isMovieStar&&!e.serverURL&&t.setPosition(t.position),s._pause(t.sID)),!l&&e.onplay?(e.onplay.apply(t),l=!0):e.onresume&&e.onresume.apply(t),t):t},this.togglePause=function(){return t.playState===0?(t.play({position:m===9&&!t.isHTML5?t.position:t.position/1e3}),t):(t.paused?t.resume():t.pause(),t)},this.setPan=function(e,n){return typeof e=="undefined"&&(e=0),typeof n=="undefined"&&(n=!1),t.isHTML5||s._setPan(t.sID,e),t._iO.pan=e,n||(t.pan=e,t.options.pan=e),t},this.setVolume=function(e,n){return typeof e=="undefined"&&(e=100),typeof n=="undefined"&&(n=!1),t.isHTML5?t._a&&(t._a.volume=Math.max(0,Math.min(1,e/100))):s._setVolume(t.sID,i.muted&&!t.muted||t.muted?0:e),t._iO.volume=e,n||(t.volume=e,t.options.volume=e),t},this.mute=function(){return t.muted=!0,t.isHTML5?t._a&&(t._a.muted=!0):s._setVolume(t.sID,0),t},this.unmute=function(){t.muted=!1;var e=typeof t._iO.volume!="undefined";return t.isHTML5?t._a&&(t._a.muted=!1):s._setVolume(t.sID,e?t._iO.volume:t.options.volume),t},this.toggleMute=function(){return t.muted?t.unmute():t.mute()},this.onPosition=function(e,n,r){return c.push({position:parseInt(e,10),method:n,scope:typeof r!="undefined"?r:t,fired:!1}),t},this.onposition=this.onPosition,this.clearOnPosition=function(e,t){var n;e=parseInt(e,10);if(isNaN(e))return!1;for(n=0;n<c.length;n++)e===c[n].position&&(!t||t===c[n].method)&&(c[n].fired&&h--,c.splice(n,1))},this._processOnPosition=function(){var e,n,r=c.length;if(!r||!t.playState||h>=r)return!1;for(e=r-1;e>=0;e--)n=c[e],!n.fired&&t.position>=n.position&&(n.fired=!0,h++,n.method.apply(n.scope,[n.position]));return!0},this._resetOnPosition=function(e){var t,n,r=c.length;if(!r)return!1;for(t=r-1;t>=0;t--)n=c[t],n.fired&&e<=n.position&&(n.fired=!1,h--);return!0},d=function(){var e=t._iO,n=e.from,r=e.to,i,s;return s=function(){t.clearOnPosition(r,s),t.stop()},i=function(){r!==null&&!isNaN(r)&&t.onPosition(r,s)},n!==null&&!isNaN(n)&&(e.position=n,e.multiShot=!1,i()),e},f=function(){var e,n=t._iO.onposition;if(n)for(e in n)n.hasOwnProperty(e)&&t.onPosition(parseInt(e,10),n[e])},p=function(){var e,n=t._iO.onposition;if(n)for(e in n)n.hasOwnProperty(e)&&t.clearOnPosition(parseInt(e,10))},a=function(){t.isHTML5&&lt(t)},u=function(){t.isHTML5&&ct(t)},n=function(){c=[],h=0,l=!1,t._hasTimer=null,t._a=null,t._html5_canplay=!1,t.bytesLoaded=null,t.bytesTotal=null,t.duration=t._iO&&t._iO.duration?t._iO.duration:null,t.durationEstimate=null,t.eqData=[],t.eqData.left=[],t.eqData.right=[],t.failures=0,t.isBuffering=!1,t.instanceOptions={},t.instanceCount=0,t.loaded=!1,t.metadata={},t.readyState=0,t.muted=!1,t.paused=!1,t.peakData={left:0,right:0},t.waveformData={left:[],right:[]},t.playState=0,t.position=null},n(),this._onTimer=function(e){var n,r=!1,i,s={};if(t._hasTimer||e)return t._a&&(e||(t.playState>0||t.readyState===1)&&!t.paused)?(n=t._get_html5_duration(),n!==g.duration&&(g.duration=n,t.duration=n,r=!0),t.durationEstimate=t.duration,i=t._a.currentTime*1e3||0,i!==g.time&&(g.time=i,r=!0),(r||e)&&t._whileplaying(i,s,s,s,s),r):!1},this._get_html5_duration=function(){var e=t._iO,n=t._a?t._a.duration*1e3:e?e.duration:undefined,r=n&&!isNaN(n)&&n!==Infinity?n:e?e.duration:null;return r},this._setup_html5=function(e){var s=L(t._iO,e),o=decodeURI,u=Ct?i._global_a:t._a,a=o(s.url),f=u&&u._t?u._t.instanceOptions:null;if(u){if(u._t){if(!Ct&&a===o(v))return u;if(Ct&&f.url===s.url&&(!v||v===f.url))return u}Ct&&u._t&&u._t.playState&&s.url!==f.url&&u._t.stop(),n(),u.src=s.url,t.url=s.url,v=s.url,u._called_load=!1}else u=new Audio(s.url),u._called_load=!1,Pt&&(u._called_load=!0),Ct&&(i._global_a=u);return t.isHTML5=!0,t._a=u,u._t=t,r(),u.loop=s.loops>1?"loop":"",s.autoLoad||s.autoPlay?t.load():(u.autobuffer=!1,u.preload="none"),u.loop=s.loops>1?"loop":"",u},r=function(){function n(e,n,r){return t._a?t._a.addEventListener(e,n,r||!1):null}if(t._a._added_events)return!1;var e;t._a._added_events=!0;for(e in Ot)Ot.hasOwnProperty(e)&&n(e,Ot[e]);return!0},o=function(){function n(e,n,r){return t._a?t._a.removeEventListener(e,n,r||!1):null}var e;t._a._added_events=!1;for(e in Ot)Ot.hasOwnProperty(e)&&n(e,Ot[e])},this._onload=function(e){var n,r=!!e;return t.loaded=r,t.readyState=r?3:2,t._onbufferchange(0),t._iO.onload&&t._iO.onload.apply(t,[r]),!0},this._onbufferchange=function(e){return t.playState===0?!1:e&&t.isBuffering||!e&&!t.isBuffering?!1:(t.isBuffering=e===1,t._iO.onbufferchange&&t._iO.onbufferchange.apply(t),!0)},this._onsuspend=function(){return t._iO.onsuspend&&t._iO.onsuspend.apply(t),!0},this._onfailure=function(e,n,r){t.failures++,t._iO.onfailure&&t.failures===1&&t._iO.onfailure(t,e,n,r)},this._onfinish=function(){var e=t._iO.onfinish;t._onbufferchange(0),t._resetOnPosition(0),t.instanceCount&&(t.instanceCount--,t.instanceCount||(p(),t.playState=0,t.paused=!1,t.instanceCount=0,t.instanceOptions={},t._iO={},u()),(!t.instanceCount||t._iO.multiShotEvents)&&e&&e.apply(t))},this._whileloading=function(e,n,r,i){var s=t._iO;t.bytesLoaded=e,t.bytesTotal=n,t.duration=Math.floor(r),t.bufferLength=i,s.isMovieStar?(t.durationEstimate=t.duration,t.readyState!==3&&s.whileloading&&s.whileloading.apply(t)):(s.duration?t.durationEstimate=t.duration>s.duration?t.duration:s.duration:t.durationEstimate=parseInt(t.bytesTotal/t.bytesLoaded*t.duration,10),t.durationEstimate===undefined&&(t.durationEstimate=t.duration),t.readyState!==3&&s.whileloading&&s.whileloading.apply(t))},this._whileplaying=function(e,n,r,i,s){var o=t._iO,u;return isNaN(e)||e===null?!1:(t.position=e,t._processOnPosition(),!t.isHTML5&&m>8&&(o.usePeakData&&typeof n!="undefined"&&n&&(t.peakData={left:n.leftPeak,right:n.rightPeak}),o.useWaveformData&&typeof r!="undefined"&&r&&(t.waveformData={left:r.split(","),right:i.split(",")}),o.useEQData&&typeof s!="undefined"&&s&&s.leftEQ&&(u=s.leftEQ.split(","),t.eqData=u,t.eqData.left=u,typeof s.rightEQ!="undefined"&&s.rightEQ&&(t.eqData.right=s.rightEQ.split(",")))),t.playState===1&&(!t.isHTML5&&m===8&&!t.position&&t.isBuffering&&t._onbufferchange(0),o.whileplaying&&o.whileplaying.apply(t)),!0)},this._onmetadata=function(e,n){var r={},i,s;for(i=0,s=e.length;i<s;i++)r[e[i]]=n[i];t.metadata=r,t._iO.onmetadata&&t._iO.onmetadata.apply(t)},this._onid3=function(e,n){var r=[],i,s;for(i=0,s=e.length;i<s;i++)r[e[i]]=n[i];t.id3=L(t.id3,r),t._iO.onid3&&t._iO.onid3.apply(t)},this._onconnect=function(e){e=e===1,t.connected=e,e&&(t.failures=0,ut(t.sID)&&(t.getAutoPlay()?t.play(undefined,t.getAutoPlay()):t._iO.autoLoad&&t.load()),t._iO.onconnect&&t._iO.onconnect.apply(t,[e]))},this._ondataerror=function(e){t.playState>0&&t._iO.ondataerror&&t._iO.ondataerror.apply(t)}},R=function(){return p.body||p._docElement||p.getElementsByTagName("div")[0]},f=function(e){return p.getElementById(e)},L=function(e,t){var n={},r,s,o;for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);s=typeof t=="undefined"?i.defaultOptions:t;for(o in s)s.hasOwnProperty(o)&&typeof n[o]=="undefined"&&(n[o]=s[o]);return n},Tt=function(){function n(t){var n=Nt.call(t),r=n.length;return e?(n[1]="on"+n[1],r>3&&n.pop()):r===3&&n.push(!1),n}function r(n,r){var i=n.shift(),s=[t[r]];e?i[s](n[0],n[1]):i[s].apply(i,n)}function i(){r(n(arguments),"add")}function s(){r(n(arguments),"remove")}var e=c.attachEvent,t={add:e?"attachEvent":"addEventListener",remove:e?"detachEvent":"removeEventListener"};return{add:i,remove:s}}(),Ot={abort:Yt(function(){}),canplay:Yt(function(){var e=this._t,t;if(e._html5_canplay)return!0;e._html5_canplay=!0,e._onbufferchange(0),t=isNaN(e.position)?null:e.position/1e3;if(e.position&&this.currentTime!==t)try{this.currentTime=t}catch(n){}e._iO._oncanplay&&e._iO._oncanplay()}),load:Yt(function(){var e=this._t;e.loaded||(e._onbufferchange(0),e._whileloading(e.bytesTotal,e.bytesTotal,e._get_html5_duration()),e._onload(!0))}),ended:Yt(function(){var e=this._t;e._onfinish()}),error:Yt(function(){this._t._onload(!1)}),loadeddata:Yt(function(){var e=this._t,t=e.bytesTotal||1;!e._loaded&&!jt&&(e.duration=e._get_html5_duration(),e._whileloading(t,t,e._get_html5_duration()),e._onload(!0))}),loadedmetadata:Yt(function(){}),loadstart:Yt(function(){this._t._onbufferchange(1)}),play:Yt(function(){this._t._onbufferchange(0)}),playing:Yt(function(){this._t._onbufferchange(0)}),progress:Yt(function(e){var t=this._t,n,r,i,s=0,o=e.type==="progress",u=e.target.buffered,a=e.loaded||0,f=e.total||1;if(t.loaded)return!1;if(u&&u.length){for(n=u.length-1;n>=0;n--)s=u.end(n)-u.start(n);a=s/e.target.duration}isNaN(a)||(t._onbufferchange(0),t._whileloading(a,f,t._get_html5_duration()),a&&f&&a===f&&Ot.load.call(this,e))}),ratechange:Yt(function(){}),suspend:Yt(function(e){var t=this._t;Ot.progress.call(this,e),t._onsuspend()}),stalled:Yt(function(){}),timeupdate:Yt(function(){this._t._onTimer()}),waiting:Yt(function(){var e=this._t;e._onbufferchange(1)})},yt=function(e){return!e.serverURL&&(e.type?bt({type:e.type}):bt({url:e.url})||i.html5Only)},Et=function(e){e&&(e.src=Dt?"":Vt)},bt=function(e){function f(e){return i.preferFlash&&kt&&!i.ignoreFlash&&typeof i.flash[e]!="undefined"&&i.flash[e]}if(!i.useHTML5Audio||!i.hasHTML5)return!1;var t=e.url||null,n=e.type||null,r=i.audioFormats,s,o,u,a;if(n&&typeof i.html5[n]!="undefined")return i.html5[n]&&!f(n);if(!wt){wt=[];for(a in r)r.hasOwnProperty(a)&&(wt.push(a),r[a].related&&(wt=wt.concat(r[a].related)));wt=new RegExp("\\.("+wt.join("|")+")(\\?.*)?$","i")}u=t?t.toLowerCase().match(wt):null;if(!u||!u.length){if(!n)return!1;o=n.indexOf(";"),u=(o!==-1?n.substr(0,o):n).substr(6)}else u=u[1];return u&&typeof i.html5[u]!="undefined"?i.html5[u]&&!f(u):(n="audio/"+u,s=i.html5.canPlayType({type:n}),i.html5[u]=s,s&&i.html5[n]&&!f(n))},xt=function(){function o(t){var n,r,s,o=!1;if(!e||typeof e.canPlayType!="function")return!1;if(t instanceof Array){for(r=0,s=t.length;r<s&&!o;r++)if(i.html5[t[r]]||e.canPlayType(t[r]).match(i.html5Test))o=!0,i.html5[t[r]]=!0,i.flash[t[r]]=!!(i.preferFlash&&kt&&t[r].match(Xt));return o}return n=e&&typeof e.canPlayType=="function"?e.canPlayType(t):!1,!!n&&!!n.match(i.html5Test)}if(!i.useHTML5Audio||typeof Audio=="undefined")return!1;var e=typeof Audio!="undefined"?Ft?new Audio(null):new Audio:null,t,n={},r,s;r=i.audioFormats;for(t in r)if(r.hasOwnProperty(t)){n[t]=o(r[t].type),n["audio/"+t]=n[t],i.preferFlash&&!i.ignoreFlash&&t.match(Xt)?i.flash[t]=!0:i.flash[t]=!1;if(r[t]&&r[t].related)for(s=r[t].related.length-1;s>=0;s--)n["audio/"+r[t].related[s]]=n[t],i.html5[r[t].related[s]]=n[t],i.flash[r[t].related[s]]=n[t]}return n.canPlayType=e?o:null,i.html5=L(i.html5,n),!0},B={},Z=function(){},it=function(e){return m===8&&e.loops>1&&e.stream&&(e.stream=!1),e},st=function(e,t){return e&&!e.usePolicyFile&&(e.onid3||e.usePeakData||e.useWaveformData||e.useEQData)&&(e.usePolicyFile=!0),e},ot=function(e){},d=function(){return!1},J=function(e){var t;for(t in e)e.hasOwnProperty(t)&&typeof e[t]=="function"&&(e[t]=d);t=null},K=function(e){typeof e=="undefined"&&(e=!1),(x||e)&&i.disable(e)},Q=function(e){var t=null,n;if(e)if(e.match(/\.swf(\?.*)?$/i)){t=e.substr(e.toLowerCase().lastIndexOf(".swf?")+4);if(t)return e}else e.lastIndexOf("/")!==e.length-1&&(e+="/");return n=(e&&e.lastIndexOf("/")!==-1?e.substr(0,e.lastIndexOf("/")+1):"./")+i.movieURL,i.noSWFCache&&(n+="?ts="+(new Date).getTime()),n},P=function(){m=parseInt(i.flashVersion,10),m!==8&&m!==9&&(i.flashVersion=m=$);var e=i.debugMode||i.debugFlash?"_debug.swf":".swf";i.useHTML5Audio&&!i.html5Only&&i.audioFormats.mp4.required&&m<9&&(i.flashVersion=m=9),i.version=i.versionNumber+(i.html5Only?" (HTML5-only mode)":m===9?" (AS3/Flash 9)":" (AS2/Flash 8)"),m>8?(i.defaultOptions=L(i.defaultOptions,i.flash9Options),i.features.buffering=!0,i.defaultOptions=L(i.defaultOptions,i.movieStarOptions),i.filePatterns.flash9=new RegExp("\\.(mp3|"+Qt.join("|")+")(\\?.*)?$","i"),i.features.movieStar=!0):i.features.movieStar=!1,i.filePattern=i.filePatterns[m!==8?"flash9":"flash8"],i.movieURL=(m===8?"soundmanager2.swf":"soundmanager2_flash9.swf").replace(".swf",e),i.features.peakData=i.features.waveformData=i.features.eqData=m>8},W=function(e,t){if(!s)return!1;s._setPolling(e,t)},X=function(){i.debugURLParam.test(h)&&(i.debugMode=!0)},ut=this.getSoundById,tt=function(){var e=[];return i.debugMode&&e.push(nt.sm2Debug),i.debugFlash&&e.push(nt.flashDebug),i.useHighPerformance&&e.push(nt.highPerf),e.join(" ")},et=function(){var e=Z("fbHandler"),t=i.getMoviePercent(),n=nt,r={type:"FLASHBLOCK"};if(i.html5Only)return!1;i.ok()?i.oMC&&(i.oMC.className=[tt(),n.swfDefault,n.swfLoaded+(i.didFlashBlock?" "+n.swfUnblocked:"")].join(" ")):(mt&&(i.oMC.className=tt()+" "+n.swfDefault+" "+(t===null?n.swfTimedout:n.swfError)),i.didFlashBlock=!0,O({type:"ontimeout",ignoreInit:!0,error:r}),z(r))},A=function(e,t,n){typeof g[e]=="undefined"&&(g[e]=[]),g[e].push({method:t,scope:n||null,fired:!1})},O=function(e){e||(e={type:"onready"});if(!S&&e&&!e.ignoreInit)return!1;if(e.type==="ontimeout"&&i.ok())return!1;var t={success:e&&e.ignoreInit?i.ok():!x},n=e&&e.type?g[e.type]||[]:[],r=[],s,o,u=[t],a=mt&&i.useFlashBlock&&!i.ok();e.error&&(u[0].error=e.error);for(s=0,o=n.length;s<o;s++)n[s].fired!==!0&&r.push(n[s]);if(r.length)for(s=0,o=r.length;s<o;s++)r[s].scope?r[s].method.apply(r[s].scope,u):r[s].method.apply(this,u),a||(r[s].fired=!0);return!0},M=function(){c.setTimeout(function(){i.useFlashBlock&&et(),O(),i.onload instanceof Function&&i.onload.apply(c),i.waitForWindowLoad&&Tt.add(c,"load",M)},1)},Lt=function(){if(kt!==undefined)return kt;var e=!1,t=navigator,n=t.plugins,r,i,s,o=c.ActiveXObject;if(n&&n.length)i="application/x-shockwave-flash",s=t.mimeTypes,s&&s[i]&&s[i].enabledPlugin&&s[i].enabledPlugin.description&&(e=!0);else if(typeof o!="undefined"){try{r=new o("ShockwaveFlash.ShockwaveFlash")}catch(u){}e=!!r}return kt=e,e},gt=function(){var e,t,n=_t&&!!l.match(/os (1|2|3_0|3_1)/i);if(n)return i.hasHTML5=!1,i.html5Only=!0,i.oMC&&(i.oMC.style.display="none"),!1;if(!i.useHTML5Audio)return!0;if(!i.html5||!i.html5.canPlayType)return i.hasHTML5=!1,!0;i.hasHTML5=!0;if(qt&&Lt())return!0;for(t in i.audioFormats)i.audioFormats.hasOwnProperty(t)&&(i.audioFormats[t].required&&!i.html5.canPlayType(i.audioFormats[t].type)||i.flash[t]||i.flash[i.audioFormats[t].type])&&(e=!0);return i.ignoreFlash&&(e=!1),i.html5Only=i.hasHTML5&&i.useHTML5Audio&&!e,!i.html5Only},vt=function(e){var t,n,r=0;if(e instanceof Array){for(t=0,n=e.length;t<n;t++)if(e[t]instanceof Object){if(i.canPlayMIME(e[t].type)){r=t;break}}else if(i.canPlayURL(e[t])){r=t;break}return e[r].url&&(e[r]=e[r].url),e[r]}return e},lt=function(t){t._hasTimer||(t._hasTimer=!0,!It&&i.html5PollingInterval&&(dt===null&&pt===0&&(dt=e.setInterval(ht,i.html5PollingInterval)),pt++))},ct=function(e){e._hasTimer&&(e._hasTimer=!1,!It&&i.html5PollingInterval&&pt--)},ht=function(){var t;if(dt!==null&&!pt)return e.clearInterval(dt),dt=null,!1;for(t=i.soundIDs.length-1;t>=0;t--)i.sounds[i.soundIDs[t]].isHTML5&&i.sounds[i.soundIDs[t]]._hasTimer&&i.sounds[i.soundIDs[t]]._onTimer()},z=function(e){e=typeof e!="undefined"?e:{},i.onerror instanceof Function&&i.onerror.apply(c,[{type:typeof e.type!="undefined"?e.type:null}]),typeof e.fatal!="undefined"&&e.fatal&&i.disable()},At=function(){if(!qt||!Lt())return!1;var e=i.audioFormats,t,n;for(n in e)if(e.hasOwnProperty(n))if(n==="mp3"||n==="mp4"){i.html5[n]=!1;if(e[n]&&e[n].related)for(t=e[n].related.length-1;t>=0;t--)i.html5[e[n].related[t]]=!1}},this._setSandboxType=function(e){},this._externalInterfaceOK=function(e,t){if(i.swfLoaded)return!1;var n,r=(new Date).getTime();i.swfLoaded=!0,zt=!1,qt&&At(),Ht?setTimeout(v,100):v()},U=function(e,t){function n(){}function C(e,t){return'<param name="'+e+'" value="'+t+'" />'}if(w&&E)return!1;if(i.html5Only)return P(),n(),i.oMC=f(i.movieID),v(),w=!0,E=!0,!1;var r=t||i.url,s=i.altURL||r,o="JS/Flash audio component (SoundManager 2)",u,a,c=R(),h,d,m,g=tt(),y,b,S,x=null,T=null,N=p.getElementsByTagName("html")[0];T=N&&N.dir&&N.dir.match(/rtl/i),e=typeof e=="undefined"?i.id:e,P(),i.url=Q($t?r:s),t=i.url,i.wmode=!i.wmode&&i.useHighPerformance?"transparent":i.wmode,i.wmode!==null&&(l.match(/msie 8/i)||!Ht&&!i.useHighPerformance)&&navigator.platform.match(/win32|win64/i)&&(i.wmode=null),u={name:e,id:e,src:t,quality:"high",allowScriptAccess:i.allowScriptAccess,bgcolor:i.bgColor,pluginspage:Jt+"www.macromedia.com/go/getflashplayer",title:o,type:"application/x-shockwave-flash",wmode:i.wmode,hasPriority:"true"},x!==null&&(u.width=x,u.height=x),i.debugFlash&&(u.FlashVars="debug=1"),i.wmode||delete u.wmode;if(Ht)a=p.createElement("div"),d=['<object id="'+e+'" data="'+t+'" type="'+u.type+'" title="'+u.title+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+Jt+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0" width="'+u.width+'" height="'+u.height+'">',C("movie",t),C("AllowScriptAccess",i.allowScriptAccess),C("quality",u.quality),i.wmode?C("wmode",i.wmode):"",C("bgcolor",i.bgColor),C("hasPriority","true"),i.debugFlash?C("FlashVars",u.FlashVars):"","</object>"].join("");else{a=p.createElement("embed");for(h in u)u.hasOwnProperty(h)&&a.setAttribute(h,u[h])}X(),g=tt(),c=R();if(c){i.oMC=f(i.movieID)||p.createElement("div");if(!i.oMC.id){i.oMC.id=i.movieID,i.oMC.className=nt.swfDefault+" "+g,y=null,m=null,i.useFlashBlock||(i.useHighPerformance?y={position:"fixed",width:"8px",height:"8px",bottom:"0px",left:"0px",overflow:"hidden"}:(y={position:"absolute",width:"6px",height:"6px",top:"-9999px",left:"-9999px"},T&&(y.left=Math.abs(parseInt(y.left,10))+"px"))),Bt&&(i.oMC.style.zIndex=1e4);if(!i.debugFlash)for(b in y)y.hasOwnProperty(b)&&(i.oMC.style[b]=y[b]);try{Ht||i.oMC.appendChild(a),c.appendChild(i.oMC),Ht&&(m=i.oMC.appendChild(p.createElement("div")),m.className=nt.swfBox,m.innerHTML=d),E=!0}catch(k){throw new Error(Z("domError")+" \n"+k.toString())}}else S=i.oMC.className,i.oMC.className=(S?S+" ":nt.swfDefault)+(g?" "+g:""),i.oMC.appendChild(a),Ht&&(m=i.oMC.appendChild(p.createElement("div")),m.className=nt.swfBox,m.innerHTML=d),E=!0}return w=!0,n(),!0},j=function(){return i.html5Only?(U(),!1):s?!1:(s=i.getMovie(i.id),s||(G?(Ht?i.oMC.innerHTML=Y:i.oMC.appendChild(G),G=null,w=!0):U(i.id,i.url),s=i.getMovie(i.id)),i.oninitmovie instanceof Function&&setTimeout(i.oninitmovie,1),!0)},_=function(){setTimeout(D,1e3)},D=function(){if(at)return!1;at=!0,Tt.remove(c,"load",_);if(zt&&!Ut)return!1;var e;S||(e=i.getMoviePercent()),setTimeout(function(){e=i.getMoviePercent(),!S&&Wt&&(e===null?i.useFlashBlock||i.flashLoadTimeout===0?i.useFlashBlock&&et():K(!0):i.flashLoadTimeout!==0&&K(!0))},i.flashLoadTimeout)},H=function(){function e(){Tt.remove(c,"focus",H),Tt.remove(c,"load",H)}return Ut||!zt?(e(),!0):(Wt=!0,Ut=!0,jt&&zt&&Tt.remove(c,"mousemove",H),at=!1,e(),!0)},Mt=function(){var e,t=[];if(i.useHTML5Audio&&i.hasHTML5)for(e in i.audioFormats)i.audioFormats.hasOwnProperty(e)&&t.push(e+": "+i.html5[e]+(!i.html5[e]&&kt&&i.flash[e]?" (using flash)":i.preferFlash&&i.flash[e]&&kt?" (preferring flash)":i.html5[e]?"":" ("+(i.audioFormats[e].required?"required, ":"")+"and no flash support)"))},k=function(e){if(S)return!1;if(i.html5Only)return S=!0,M(),!0;var t=i.useFlashBlock&&i.flashLoadTimeout&&!i.getMoviePercent(),n;return t||(S=!0,x&&(n={type:!kt&&mt?"NO_FLASH":"INIT_TIMEOUT"})),x||e?(i.useFlashBlock&&i.oMC&&(i.oMC.className=tt()+" "+(i.getMoviePercent()===null?nt.swfTimedout:nt.swfError)),O({type:"ontimeout",error:n}),z(n),!1):i.waitForWindowLoad&&!T?(Tt.add(c,"load",M),!1):(M(),!0)},v=function(){function e(){Tt.remove(c,"load",i.beginDelayedInit)}if(S)return!1;if(i.html5Only)return S||(e(),i.enabled=!0,k()),!0;j();try{s._externalInterfaceTest(!1),W(!0,i.flashPollingInterval||(i.useHighPerformance?10:50)),i.debugMode||s._disableDebug(),i.enabled=!0,i.html5Only||Tt.add(c,"unload",d)}catch(t){return z({type:"JS_TO_FLASH_EXCEPTION",fatal:!0}),K(!0),k(),!1}return k(),e(),!0},F=function(){return q?!1:(q=!0,X(),!kt&&i.hasHTML5&&(i.useHTML5Audio=!0,i.preferFlash=!1),xt(),i.html5.usingFlash=gt(),mt=i.html5.usingFlash,Mt(),!kt&&mt&&(i.flashLoadTimeout=1),p.removeEventListener&&p.removeEventListener("DOMContentLoaded",F,!1),j(),!0)},St=function(){return p.readyState==="complete"&&(F(),p.detachEvent("onreadystatechange",St)),!0},I=function(){T=!0,Tt.remove(c,"load",I)},Lt(),Tt.add(c,"focus",H),Tt.add(c,"load",H),Tt.add(c,"load",_),Tt.add(c,"load",I),jt&&zt&&Tt.add(c,"mousemove",H),p.addEventListener?p.addEventListener("DOMContentLoaded",F,!1):p.attachEvent?p.attachEvent("onreadystatechange",St):z({type:"NO_DOM2_EVENTS",fatal:!0}),p.readyState==="complete"&&setTimeout(F,100)}var t=null;if(typeof SM2_DEFER=="undefined"||!SM2_DEFER)t=new n;e.SoundManager=n,e.soundManager=t}(window),define("assets/scripts/libs/soundmanager/script/soundmanager2-nodebug",[],function(){}),window.SM2_DEFER=!0,define("assets/scripts/view-models/product/AudioPlayer",["jquery","assets/scripts/presenters/product/AudioControl","assets/scripts/libs/soundmanager/script/soundmanager2-nodebug"],function(e,t){"use strict";var n=function(n){window.soundManager=new SoundManager,window.soundManager.url="/assets/scripts/libs/soundmanager/swf/";var r=0,i=e(n);while(r<i.length){var s=e(i[r]).attr("id"),o="audioControl"+r;o=new t("#"+s),r++}};return n}),define("assets/scripts/presenters/SocialButtonTracker",["jquery","assets/scripts/events"],function(e,t){"use strict";var n=function(e){this.sku=e,this.bind()};return n.prototype.bind=function(){var n=this;typeof FB=="object"&&FB.Event.subscribe("edge.create",function(e,t){n.track("FacebookLike")}),e(".js-social-buttons").on(t.PLUS_ONE_CLICKED,function(e){e.state==="on"&&n.track("GooglePlus1")})},n.prototype.track=function(e){var t=this;typeof s=="object"&&typeof evalOmniture=="function"&&(s.eVar8=e+">"+t.sku,evalOmniture())},n}),define("assets/scripts/helpers/ScriptHandler",["jquery"],function(e){"use strict";var t=function(){};return t.prototype.addScriptsToHeader=function(t){e(t).each(function(){if(this.nodeName&&this.nodeName==="SCRIPT"){var e=document.createElement("script");e.type=this.type,this.src?e.src=this.src:e.text=this.text,document.getElementsByTagName("head")[0].appendChild(e)}})},new t}),define("assets/scripts/presenters/modals/QuickLookModal",["jquery","assets/scripts/presenters/modals/ModalTemplate","assets/scripts/presenters/product/detail/AlternateImages","assets/scripts/presenters/product/LoaderIcon","assets/scripts/models/product/ProductApi","assets/scripts/presenters/AddedTextChanger","assets/scripts/view-models/product/AudioPlayer","assets/scripts/presenters/SocialButtonTracker","assets/scripts/helpers/ScriptHandler"],function(e,t,n,r,i,s,o,u,a){"use strict";var f=function(){};return f.prototype=new t,f.prototype.fetchContent=function(t,n,r){var s=this;i.getInstance().fetchProductPreviewData(t.attr("href"),r,function(i){var o=t.attr("data-modal-size")||"full",u=e(i).unwrap(),f=u.find(".icon-close-modal");f.remove(),a.addScriptsToHeader(u),u=e("<div></div>").html(u.html()),u.css("width",s.modalHelper.modalWidths[o]),n(u,r)},null)},f.prototype.killDataRequest=function(){i.getInstance().killCurrentRequest()},f.prototype.bind=function(){var t=this;e("body").on({click:function(n){n.preventDefault(),t.displayVariant(e(this).find("a").attr("href"))}},".color-swatches li"),t.initAltImages(),t.initAudioPlayer();var n=e('#js-button-add-to-saved-items[data-ui="inline"]');if(n.length!==0){var r=new s(n);r.bind()}t.enableSocialButtons(),t.loadReviews(),t.updateMetadata()},f.prototype.initAltImages=function(){var e=new n},f.prototype.initAudioPlayer=function(){var e=new o(".js-audio-plugin")},f.prototype.displayVariant=function(t){var n=this,s=e("#js-modal-container"),o=s.find(".js-modal-content"),u=new r(o);u.display(),i.getInstance().fetchProductPreviewData(t,n,function(t){var r=e(t);u.hide(),s.html(r.html()),u=null,n.initAltImages(),n.enableSocialButtons(),n.loadReviews(),n.updateMetadata(),n.initAudioPlayer()})},f.prototype.updateMetadata=function(){var t=e("head"),n=t.find('[itemprop],[property^="og:"]');n.remove();var r=e(".quicklook-metadata"),i=r.children();t.append(i),r.remove()},f.prototype.loadReviews=function(){var t=e(".js-buy-online-data");t.length>0&&window.$BV!==null&&window.$BV.ui("rr","show_reviews",{productId:t.data("product-id"),doShowContent:function(){return window.location=t.data("product-url")+"#section-reviews",!1}})},f.prototype.enableSocialButtons=function(){var t=e(".js-buy-online-data");typeof gapi!="undefined"&&gapi.plusone.go();var n=new u(t.data("id"))},f}),define("assets/scripts/libs/text!assets/scripts/views/modals/modal-add-to-saved-items-template.html",[],function(){return'<div>\n    <div class="layout-inside-md">\n        <h2 class="layout-vr-sm">\n            <img src="/assets/images/copy/copy-add-to-saved-items.png" alt="Add to Saved Items">\n        </h2>\n\n        <div class="copy-c layout-vr-md">\n            Please give this item a name. We\u2019ll keep it in your Saved Items so you can find it later.\n        </div>\n\n        <form action="#" id="js-form-add-to-saved-items">\n            <fieldset>\n                <legend></legend>\n                <ul class="form-list form-secondary">\n                    <li id="js-name-container">\n                        <label class="hidden-content" for="saved-item-name">Name of saved item</label>\n                        <input id="saved-item-name" name="projectname" type="text" class="form-input input-text form-input-alt js-required" data-max-length="35" placeholder="MyProject" />\n                    </li>\n                    <li>\n                        <button class="button btn-secondary">Save</button>\n                        <a class="form-note" id="js-close-modal" href="#">Continue without saving</a>\n                    </li>\n                </ul>\n            </fieldset>\n        </form>\n    </div>\n</div>'}),define("assets/scripts/presenters/modals/AddToSavedItemsModal",["jquery","assets/scripts/presenters/modals/ModalTemplate","assets/scripts/libs/text!assets/scripts/views/modals/modal-add-to-saved-items-template.html","assets/scripts/presenters/AddedTextChanger","assets/scripts/models/AjaxHelper","assets/scripts/view-helpers/FormValidator"],function(e,t,n,r,i,s){"use strict";var o=function(){this.$nameContainer=null,this.$inlineNameErrorContainer=null,this.ERROR_CONTAINER_CSS_CLASS="form-error",this.url=null,this.urlParams={},this.textChanger=null,this.ajaxHelper=new i};return o.prototype=new t,o.prototype.fetchContent=function(t,i,s){var o=this;this.parseUrl(t.attr("href")),this.textChanger=new r(t);var u=e(n);u.css("width",o.modalHelper.modalWidths.small),u.find("#saved-item-name").attr("placeholder","Project Name").data("original-placeholder","Project Name"),i(u,s)},o.prototype.bind=function(){var t=this;this.$nameContainer=e("#js-name-container"),this.$inlineNameErrorContainer=e("#js-inline-name-error"),e("#js-close-modal").click(function(e){e.preventDefault(),t.modalHelper.closeAndRemoveModal()}),e("#js-form-add-to-saved-items").submit(function(n){n.preventDefault();var r=e(this);t.urlParams.projectname=r.find('input[type="text"]').val();var i={projectname:{required:"Please specify a project name",maxlength:"Project name must be 35 characters or less"}},o=new s;o.validate(r,i,function(){t.clearError();var e=function(e){typeof e=="string"?e.match(/not/i)?t.displayError(e):t.close():e.JsonError?t.displayError(e.JsonErrorMessage):t.close()};t.ajaxHelper.doAjax("POST",t.url,t.urlParams,e,t)})})},o.prototype.close=function(){var e=this;e.modalHelper.closeAndRemoveModal(),e.textChanger.changeText()},o.prototype.displayError=function(e){var t=this;t.$nameContainer.addClass(t.ERROR_CONTAINER_CSS_CLASS),t.$nameContainer.append("<div id='js-inline-name-error' class='error'>"+e+"</div>")},o.prototype.clearError=function(){var e=this;this.$nameContainer.removeClass(e.ERROR_CONTAINER_CSS_CLASS),this.$inlineNameErrorContainer.html("").hide()},o.prototype.parseUrl=function(e){var t=this,e=e.split("?");this.url=e[0];var n=e[1].split("&");for(var r=0;r<n.length;r++){var i=n[r];i=i.split("=");var s=i[0],o=i[1];this.urlParams[s]=o}},o}),define("assets/scripts/presenters/modals/StaticModal",["jquery","assets/scripts/presenters/modals/ModalTemplate"],function(e,t){"use strict";var n=function(){this.$nameContainer=null,this.$inlineNameErrorContainer=null,this.ERROR_CONTAINER_CSS_CLASS="form-error"};return n.prototype=new t,n.prototype.fetchContent=function(t,n,r){var i=this,s=t.attr("href"),o=t.attr("data-modal-size");e.ajax({url:s}).done(function(t){var s=e(t).find(".js-modal-content").addClass("layout-inside-md border-box");s=e("<div></div>").append(s),s.find(".js-modal-exclude").remove(),s.css("width",i.modalHelper.modalWidths[o]),n(s,r)})},n.prototype.bind=function(){var t=this;this.$nameContainer=e("#js-name-container"),this.$inlineNameErrorContainer=e("#js-inline-name-error"),e("#js-close-modal").click(function(e){e.preventDefault(),t.modalHelper.closeAndRemoveModal()})},n.prototype.showError=function(e){var t=this,n=this.$nameContainer;this.$nameContainer.addClass(t.ERROR_CONTAINER_CSS_CLASS),this.$inlineNameErrorContainer.html(e).fadeIn(150)},n.prototype.clearError=function(){var e=this;this.$nameContainer.removeClass(e.ERROR_CONTAINER_CSS_CLASS),this.$inlineNameErrorContainer.html("").hide()},n}),define("assets/scripts/presenters/modals/FindAStoreModal",["jquery","assets/scripts/presenters/modals/ModalTemplate","assets/scripts/models/AjaxHelper","assets/scripts/presenters/AutoReplace","assets/scripts/helpers/ScriptHandler"],function(e,t,n,r,i){"use strict";var s=function(){this.MODAL_ID="js-find-store-modal-content",this.ajaxHelper=new n,this.$zipContainer=null,this.$inlineZipErrorContainer=null,this.ERROR_CONTAINER_CSS_CLASS="form-error",this.resultsContainerId="js-find-results"};return s.prototype=new t,s.prototype.fetchContent=function(e,t,n){var r=this,s=e.attr("href"),o=function(e){i.addScriptsToHeader(e);var s=r.contentFilter(e,r.modalHelper.modalWidths.small,r.MODAL_ID);t(s,n)};r.ajaxHelper.doAjax("GET",s,null,o,n)},s.prototype.bind=function(){var t=this;r.init(),this.modalHelper.$modalContainer.on({submit:function(n){n.preventDefault();var s=e(this);t.setErrorContainers();var o=s.serialize(),u=s.attr("action"),a=function(e){i.addScriptsToHeader(e);var n=t.contentFilter(e,t.modalHelper.modalWidths.large,""),s=t.getCurrentContentContainer(),o=function(){r.init()};t.modalHelper.addNewContent(n,s,t.modalHelper.modalWidths.large,o)},f=e("#find-store-modal"),l=f.val(),c=f.attr("data-original-placeholder");l===""||l===c?t.showError("Please enter City, State or ZIP Code."):t.ajaxHelper.doAjax("GET",u,o,a,t)}},"form"),this.modalHelper.$modalContainer.on({click:function(n){n.preventDefault();var r=e(this).attr("href"),i=function(e){var n=t.resultsFilter(e);t.replaceResults(n)};t.ajaxHelper.doAjax("GET",r,null,i,t)}},".nav-link"),this.modalHelper.$modalContainer.on({keydown:function(t){var n=t.keyCode,r=e(this).val();n!==8&&n!==9&&n!==13&&n!==46&&n!==48&&n!==49&&n!==50&&n!==51&&n!==52&&n!==53&&n!==54&&n!==55&&n!==56&&n!==57&&n!==8&&n!==46&&n!==13&&n!==96&&n!==97&&n!==98&&n!==99&&n!==100&&n!==101&&n!==102&&n!==103&&n!==104&&n!==105&&t.preventDefault(),r.length>4&&n!==8&&n!==9&&n!==13&&n!==46&&t.preventDefault()}},"#find-store")},s.prototype.setErrorContainers=function(){this.$zipContainer=e("#js-zip-container"),this.$inlineZipErrorContainer=e("#js-zip-inline")},s.prototype.showError=function(e){var t=this;this.$zipContainer.addClass(t.ERROR_CONTAINER_CSS_CLASS),this.$inlineZipErrorContainer.html(e).fadeIn(150)},s.prototype.clearError=function(){var e=this;this.$zipContainer.removeClass(e.ERROR_CONTAINER_CSS_CLASS),this.$inlineZipErrorContainer.html("").hide()},s.prototype.contentFilter=function(t,n,r){var i=e(t).find(".grid-group").eq(0);i=e("<div></div>").append(i);var s=i.find(".icon-close-modal");return s.remove(),i.css("width",n).attr("id",r),i},s.prototype.resultsFilter=function(t){var n=this,r=e(t).find("#"+n.resultsContainerId);return r},s.prototype.replaceResults=function(t){var n=this;e("#"+n.resultsContainerId).html(t)},s.prototype.getCurrentContentContainer=function(){var e=this.modalHelper.$modalContainer.find(".modal-content > div");return e},s}),define("assets/scripts/presenters/modals/ShareModal",["jquery","assets/scripts/presenters/modals/ModalTemplate","assets/scripts/models/AjaxHelper","assets/scripts/presenters/AutoReplace","assets/scripts/view-helpers/FormValidator","assets/scripts/libs/text!assets/scripts/views/modals/modal-success.html"],function(e,t,n,r,i,s){"use strict";var o=function(){this.ERROR_CONTAINER_CSS_CLASS="form-error",this.ajaxHelper=new n};return o.prototype=new t,o.prototype.fetchContent=function(e,t,r){var i=this,s=e.attr("href"),o=function(e){var n=i.contentFilter(e,i.modalHelper.modalWidths.small);t(n,r)},u=new n;u.doAjax("GET",s,null,o,r)},o.prototype.bind=function(){var t=this;r.init();var n=this.modalHelper.$modalContainer.find("form");n.submit(function(n){n.preventDefault();var o=e(this),u=o.serialize(),a=o.attr("action"),f={To:{required:"Please enter an e-mail address.",emailsFormat:"Your e-mail address(es) is/are not formatted correctly. Please check it/them and re-enter."},From:{required:"Please enter an e-mail address.",emailFormat:"Your e-mail address is not formatted correctly. Please check it and re-enter."},Subject:{required:"Please enter a subject."},Message:{required:"Please enter a message."}},l=new i;l.validate(o,f,function(){var n=function(n){var i=t.contentFilter(n,t.modalHelper.modalWidths.small,""),o=t.modalHelper.getCurrentContentContainer(),u=function(){r.init()},a;if(i.find(".form-error").length!==0)a=t.modalHelper.modalWidths.small;else{i=e(s);var f="Your email is on the way.";i.find("#js-success-message").text(f),a=t.modalHelper.modalWidths.tiny}t.modalHelper.addNewContent(i,o,a,u)};t.ajaxHelper.doAjax("POST",a,u,n,t)})})},o.prototype.clearErrors=function(){},o.prototype.contentFilter=function(t,n){var r=e(t).find(".grid-group").eq(0).addClass("layout-inside-md");r=e("<div></div>").append(r);var i=r.find(".icon-close-modal");return i.remove(),r.css("width",n),r},o}),define("assets/scripts/presenters/modals/ECardSubscriptionModal",["jquery","assets/scripts/presenters/modals/ModalTemplate","assets/scripts/models/AjaxHelper"],function(e,t,n){"use strict";var r=function(){};return r.prototype=new t,r.prototype.fetchContent=function(e,t,r){var i=this,s=e.attr("href"),o=function(e){var n=i.contentFilter(e,i.modalHelper.modalWidths.xlarge);t(n,r)},u=new n;u.doAjax("GET",s,null,o,r)},r.prototype.bind=function(){},r.prototype.contentFilter=function(t,n){var r=e('<h2><img src="/assets/images/copy/copy-e-card-subscription.png" alt="Ecard Subscription" width="175" height="28"></h2>'),i=e(t).find(".js-modal-content").addClass("layout-inside-md grid-group").prepend(r);return i=e("<div></div>").append(i),i.css("width",n),i},r}),define("assets/scripts/libs/text!assets/scripts/views/modals/modal-shipping-delivery.html",[],function(){return'<div class="layout-inside-md">\n    <section class="wysiwyg layout-vr-lg">\n        <h2 class="heading-c layout-vr-sm"><img src="/assets/images/copy/copy-shipping-and-mailing.png" alt="Shipping &amp; Mailing"></h2>\n\n        <p>We are able to mail cards, invitations and announcements\u00a0only\u00a0to valid\n            U.S. Postal Service addresses. International mailing is not available yet.</p>\n\n        <p>\n            We are able to ship orders\u00a0only\u00a0to valid U.S. Postal Service addresses.\n            We cannot ship orders to post office (PO) boxes, U.S. territories\u00a0or\n            Overseas Military Mail (APO/FPO) addresses.</p>\n        <a href="/delivery-details-and-shipping-costs">Delivery details & shipping costs</a>\n    </section>\n\n    <section class="wysiwyg">\n        <h2 class="heading-c layout-vr-sm"><img src="/assets/images/copy/copy-payment.png" alt="Payment"></h2>\n\n        <p>Ecard subscriptions are available\u00a0to U.S. and Canadian billing addresses.</p>\n        <p>On all other orders, we can accept payment from U.S. billing addresses\n            only. This includes paper cards, party products, Keepsake Ornaments,\n            books and other items.</p>\n    </section>\n\n</div>'}),define("assets/scripts/presenters/modals/ShippingDeliveryModal",["jquery","assets/scripts/presenters/modals/ModalTemplate","assets/scripts/libs/text!assets/scripts/views/modals/modal-shipping-delivery.html"],function(e,t,n){"use strict";var r=function(){};return r.prototype=new t,r.prototype.fetchContent=function(t,r,i){var s=this,o=e(n);o=e("<div></div>").append(o),o.css("width",s.modalHelper.modalWidths.medium),r(o,i)},r.prototype.bind=function(){},r}),define("assets/scripts/libs/text!assets/scripts/views/modals/modal-need-help.html",[],function(){return'\n    <div class="layout-inside-md">\n        <ul class="blocks blocks-3up list-figures layout-vr-md copy-b">\n            <li>\n                <a href="http://hallmark.custhelp.com/app/chat/chat_launch" id="js-chat-window-launch-icon" class="icons-help icon-chat"></a>\n                <a href="http://hallmark.custhelp.com/app/chat/chat_launch" id="js-chat-window-launch">Chat</a> with us.\n            </li>\n            <li class="icons-help icon-call">\n                Call us at <br />\n                1-800-HALLMARK\n            </li>\n            <li>\n                <a href="http://hallmark.custhelp.com/app/ask" id="js-email-window-launch-icon" class="icons-help icon-email"></a>\n                <a href="http://hallmark.custhelp.com/app/ask" id="js-email-window-launch">Email </a> us anytime.\n            </li>\n        </ul>\n        <div class="layout-centered divided copy-d">\n            <div class="js-need-help-hours"></div>\n        </div>\n    </div> <!-- end .modal inside -->\n'}),define("assets/scripts/presenters/modals/NeedHelp",["jquery","assets/scripts/presenters/modals/ModalTemplate","assets/scripts/libs/text!assets/scripts/views/modals/modal-need-help.html"],function(e,t,n){"use strict";var r;e.get("/needhelp/loadchattime/",function(t){var n=e(t),i=e("#rn_ChatHours2_10_HoursBlock",n);r=i.html()},"html");var i=function(){this.$nameContainer=null,this.$inlineNameErrorContainer=null,this.ERROR_CONTAINER_CSS_CLASS="form-error"};return i.prototype=new t,i.prototype.fetchContent=function(t,i,s){var o=this,u=t.attr("href"),a=t.attr("data-modal-size"),f=e(n);f=e("<div></div>").append(f),r&&f.find(".js-need-help-hours").html(r),f.css("width",o.modalHelper.modalWidths[a]),i(f,s)},i.prototype.bind=function(){var t=this;this.$nameContainer=e("#js-name-container"),this.$inlineNameErrorContainer=e("#js-inline-name-error"),e("#js-close-modal").click(function(e){e.preventDefault(),t.modalHelper.closeAndRemoveModal()}),e("#js-chat-window-launch, #js-chat-window-launch-icon").on({click:function(n){n.preventDefault();var r=e(this).attr("href");window.open(r,"myWindow","location=1, status=1, scrollbars=1, width=675, height=520"),t.modalHelper.closeAndRemoveModal()}}),e("#js-email-window-launch, #js-email-window-launch-icon").on({click:function(n){n.preventDefault();var r=e(this).attr("href");window.open(r,"myWindow","status=1, height=600, width=860, resizable=0, scrollBars=1"),t.modalHelper.closeAndRemoveModal()}})},i.prototype.showError=function(e){var t=this,n=this.$nameContainer;this.$nameContainer.addClass(t.ERROR_CONTAINER_CSS_CLASS),this.$inlineNameErrorContainer.html(e).fadeIn(150)},i.prototype.clearError=function(){var e=this;this.$nameContainer.removeClass(e.ERROR_CONTAINER_CSS_CLASS),this.$inlineNameErrorContainer.html("").hide()},i}),define("assets/scripts/libs/text!assets/scripts/views/modals/modal-buy-error.html",[],function(){return'    <div class="layout-inside-md">\r\n        <a href="#" class="icon icon-close icon-close-modal">Close Error Modal</a>\r\n\r\n        <h2 class="layout-vr-sm">\r\n            <img src="/assets/images/copy/copy-sorry.png" alt="Sorry!">\r\n        </h2>\r\n\r\n        <p class="error-message-content copy-c"></p>\r\n\r\n    </div>'}),define("assets/scripts/presenters/modals/BuyOnlineModal",["jquery","assets/scripts/presenters/modals/ModalTemplate","assets/scripts/models/AjaxHelper","assets/scripts/libs/text!assets/scripts/views/modals/modal-buy-error.html"],function(e,t,n,r){"use strict";var i=function(){this.MODAL_ID="js-buy-online-error",this.ajaxHelper=new n,this.ErrorModal=r};return i.prototype=new t,i.prototype.fetchContent=function(t,n,r){var i=this,s=i.getPurchaseData(e(".js-buy-online-data"));e.post(s.url,s.data,function(e){if(e.JsonError){var t=i.contentFilter(i.ErrorModal,i.modalHelper.modalWidths.small,i.MODAL_ID);t.find(".error-message-content").text(e.JsonErrorMessage),n(t,r)}else setTimeout(function(){window.location=s.redirectUrl},1e3)},"json")},i.prototype.bind=function(){},i.prototype.getPurchaseData=function(e){var t=this;return{url:e.data("url"),redirectUrl:e.data("redirect-url"),data:{SelectedKitID:e.data("id"),ProjectName:encodeURIComponent(e.data("title")),"ProductInView.ProductLine":e.data("product-line"),"ProductInView.ProductID":e.data("product-id"),"ProductInView.ProjectID":e.data("project-id")}}},i.prototype.contentFilter=function(t,n,r){var i=e(t).unwrap();i=e("<div></div>").append(i);var s=i.find(".icon-close-modal");return s.remove(),i.css("width",n).attr("id",r),i},i}),define("assets/scripts/view-helpers/EscButtonManager",["jquery"],function(e){"use strict";var t={isButtonBound:!1,callbacks:[],pushCallbackAndConfirmBound:function(e){this.pushToBeginningOfCallbacks(e),this.isButtonBound||(this.bindEsc(),this.isButtonBound=!0)},bindEsc:function(){var t=this;e(window).on("keydown",function(e){e.keyCode=="27"&&(t.callbacks[0](),t.callbacks.shift())})},pushToBeginningOfCallbacks:function(e){this.callbacks.reverse(),this.callbacks.push(e),this.callbacks.reverse()}};return t}),define("assets/scripts/presenters/modals/ModalBuilder",["jquery","assets/scripts/libs/text!assets/scripts/views/modals/modal-template.html","assets/scripts/libs/text!assets/scripts/views/modals/overlay-template.html","assets/scripts/presenters/product/browse/SpecialOffersModal","assets/scripts/presenters/modals/QuickLookModal","assets/scripts/presenters/modals/AddToSavedItemsModal","assets/scripts/presenters/modals/StaticModal","assets/scripts/presenters/modals/FindAStoreModal","assets/scripts/presenters/modals/ShareModal","assets/scripts/presenters/modals/ECardSubscriptionModal","assets/scripts/presenters/modals/ShippingDeliveryModal","assets/scripts/presenters/modals/NeedHelp","assets/scripts/presenters/modals/BuyOnlineModal","assets/scripts/view-helpers/EscButtonManager","assets/scripts/events"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";var v=function(){this.modal=null,this.$modalContainer=null,this.$modalOverlay=null,this.confirmModalPresence()};return v.prototype.bind=function(t){var n=this;e("body").on({click:function(t){var d=e(this),v=d.attr("data-modal-type");d.attr("data-modal-persistence")&&(n.modalPersistence=!0);var m;switch(v){case"special-offers":m=r;break;case"quicklook":m=i;break;case"add-to-saved-items":m=s;break;case"static":m=o;break;case"find-a-store":m=u;break;case"share":m=a;break;case"ecard-subscription":m=f;break;case"shipping-delivery":m=l;break;case"need-help":m=c;break;case"buy-online":m=h}n.constructModal(m),t.preventDefault(),n.launchInitialModal(d,n.populateModal,n),p.pushCallbackAndConfirmBound(function(){n.closeModal()})}},t)},v.prototype.bindClose=function(){var t=this;this.$modalContainer.on({click:function(n){e(n.target).hasClass("js-close-modal")&&(n.preventDefault(),n.stopPropagation()),t.closeModal()}},'.js-close-modal, a[target="_blank"]'),this.$modalOverlay.on({click:function(e){t.closeModal(),e.stopPropagation()}})},v.prototype.closeModal=function(){this.$modalOverlay.fadeOut(350),this.$modalContainer.fadeOut(350,function(){e(this).remove(),d.$.trigger(d.MODAL_CLOSE)})},v.prototype.confirmModalPresence=function(){var n=this;this.$modalContainer=e("#js-modal-container"),this.$modalOverlay=e("#js-modal-overlay"),this.$loaderImage=this.$modalContainer.find(".js-loading").eq(0),this.$modalContainer.length===0&&(this.$modalContainer=e(t),e("body").append(this.$modalContainer)),this.$loaderImage.length===0&&(this.$loaderImage=this.$modalContainer.find(".js-loading").eq(0)),this.bindClose(),this.confirmOverlayPresence()},v.prototype.confirmOverlayPresence=function(){var t=this;this.$modalOverlay.length===0&&(this.$modalOverlay=e(n),e("body").append(this.$modalOverlay))},v.prototype.constructModal=function(e){this.modal=new e},v.prototype.launchInitialModal=function(e,t,n){this.confirmOverlayPresence(),this.showLoader(),this.modal.fetchContent(e,t,n)},v.prototype.populateModal=function(e,t){e.css("visibility","hidden"),t.modalPersistence===!0&&t.$modalContainer.attr("data-modal-persistence",!0);var n=t.$modalContainer.find(".js-modal-content").eq(0);n.append(e),t.modal.modalHelper.transitionInContent(t.$modalContainer,e,function(){t.modal.bind(),d.$.trigger(d.MODAL_OPEN)})},v.prototype.showLoader=function(){var t=this;this.confirmModalPresence(),this.modal.modalHelper.setContainerAndOverlay(t.$modalContainer,t.$modalOverlay);var n=this.modal.modalHelper.getCurrentContentContainer();if(n.length!==0)n.remove();else{var r=this.$modalContainer.css("top");this.$modalContainer.css("top",parseInt(r,10)+e(window).scrollTop()).fadeIn(150)}this.$modalOverlay.fadeIn(150),this.modal.modalHelper.positionLoader()},v}),define("assets/scripts/libs/text!assets/scripts/views/modals/modal-upgrade-browser.html",[],function(){return'<div class="layout-inside-md grid-group">\n    <h2 class="layout-vr-sm"><img src="/assets/images/copy/copy-please-upgrade.png" alt="Please Upgrade Your Web Browser"></h2>\n\n    <p class="copy-b layout-vr-md">Our site is best viewed using the latest version of <br />\n        <a href="\nhttp://windows.microsoft.com/en-US/internet-explorer/products/ie/home">Microsoft Internet Explorer<sup>&reg;</sup></a>, <a href="http://www.apple.com/safari/">Apple Safari<sup>&reg;</sup></a>, <a href="http://www.mozilla.org/en-US/firefox/new/?from=sfx&uid=267821&t=449">Mozilla Firefox<sup>&reg;</sup></a>, or\n        <br />\n        <a href="https://www.google.com/intl/en/chrome/browser/">Google Chrome&trade;</a>.\n    </p>\n</div>'}),define("assets/scripts/presenters/modals/BrowserDetectionModal",["jquery","assets/scripts/presenters/modals/ModalTemplate","assets/scripts/libs/text!assets/scripts/views/modals/modal-upgrade-browser.html"],function(e,t,n){"use strict";var r=function(){};return r.prototype=new t,r.prototype.fetchContent=function(t,r,i){var s=this,o=e(n);o.css("width",s.modalHelper.modalWidths.medium),r(o,i)},r.prototype.bind=function(){},r}),define("assets/scripts/presenters/BrowserDetection",["jquery","assets/scripts/models/Storage","assets/scripts/presenters/modals/ModalBuilder","assets/scripts/presenters/modals/BrowserDetectionModal"],function(e,t,n,r){"use strict";var i=function(){this.browser=this.browserType(this.dataBrowser)||"An unknown browser",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version",this.storage=new t("browserDetection"),this.checkAgainstSupportedBrowsers(this.browser,this.version)};return i.prototype.browserType=function(e){for(var t=0;t<e.length;t++){var n=e[t].string,r=e[t].prop;this.versionbrowserType=e[t].versionSearch||e[t].identity;if(n){if(n.indexOf(e[t].subString)!=-1)return e[t].identity}else if(r)return e[t].identity}},i.prototype.searchVersion=function(e){var t=e.indexOf(this.versionbrowserType);if(t==-1)return;return parseFloat(e.substring(t+this.versionbrowserType.length+1))},i.prototype.dataBrowser=[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"}],i.prototype.checkAgainstSupportedBrowsers=function(e,t){if(e==="Firefox"&&t<12||e==="Chrome"&&t<17||e==="Safari"&&t<5||e==="Explorer"&&t<8){var i=this.storage.getItem("hasVisited");if(typeof i=="undefined"||i===null){var s=new n;s.constructModal(r),s.launchInitialModal(null,s.populateModal,s),this.storage.setItem("hasVisited",!0)}}},i}),define("assets/scripts/presenters/StoreFinder",["jquery"],function(e){"use strict";var t=function(){var t=this,n=".js-store-finder-container,.store-finder-container",r=e("#StoreLocatorServerURL").attr("value")||"http://stores.hallmark.com";r=e.trim(r).replace(/\/$/,""),t.url=r+"/find/?search=",e(n).each(function(){var n=e(this),r=e("input.input-text",n),i=e(".error",n),s=e('button,input[type="submit"]',n);s.click(function(e){e.preventDefault(),t.search(r,i)}),r.keyup(function(e){e.keyCode==13&&t.search(r,i)})})};return t.prototype.search=function(e,t){var n=this,r=e.val();r=="City, State or ZIP Code"||r==""?t.show():location.href=n.url+r},t}),define("assets/scripts/presenters/Header",["jquery","assets/scripts/presenters/Navigation","assets/scripts/presenters/ExternalLinks","assets/scripts/presenters/Search","assets/scripts/presenters/BrowserDetection","assets/scripts/presenters/AutoReplace","assets/scripts/presenters/StoreFinder"],function(e,t,n,r,i,s,o){"use strict";var u=function(){n.init(),s.init();var u=new r,a=new o,f=new t(e(".nav-main > li:not(.js-exclude-nav), .nav-utility > li")),l=new i,c=e(".header-main");e(".error",c).hide(),e('[type="password"]',c).attr("autocomplete","off")};return u}),define("assets/scripts/presenters/ScrollTop",["jquery","assets/scripts/events"],function(e,t){"use strict";var n=function(){this.$browserWindow=e(window),this.scrollSpeed=600,this.contentWidth=e(".wrapper").width(),this.$scrollLink=e(".back-to-top"),this.linkWidth=parseInt(this.$scrollLink.width(),10),this.linkMargin=parseInt(this.$scrollLink.css("marginLeft"),10),this.linkTransitionSpeed=500,this.originalBottomPosition=parseInt(this.$scrollLink.css("bottom"),10),this.previousScrollLinkState=null,this.bind()};return n.prototype.bind=function(){var n=this;n.positionLink(),n.$browserWindow.on({resize:function(){n.positionLink(),n.positionLinkBottom()},scroll:function(){n.$browserWindow.scrollTop()===0?n.hideScrollLink():n.showScrollLink(),n.positionLinkBottom()}}),e("#main-content").on(t.PRODUCT_LISTING_UPDATED,function(){n.positionLinkBottom()}),n.$scrollLink.on({click:function(e){e.preventDefault(),n.scrollToTop()}}),e("#main-content").on(t.SCROLL_TO_TOP,function(){n.scrollToTop()})},n.prototype.scrollToTop=function(){var t=this;e("html, body").animate({scrollTop:0},t.scrollSpeed)},n.prototype.positionLinkBottom=function(){this.$scrollLink.css("bottom",this.originalBottomPosition);var t=e(window).scrollTop(),n=e(window).height(),r=e(".footer-main").offset(),i=t+n-r.top;i>=0&&this.$scrollLink.css("bottom",i+this.originalBottomPosition)},n.prototype.positionLink=function(){var e=this.$browserWindow.width(),t=(e-this.contentWidth)/2;t+=this.contentWidth;var n=t+this.linkWidth+this.linkMargin;this.$scrollLink.css("left",t),e<=n&&this.hideScrollLink(),e>=n&&this.$browserWindow.scrollTop()!==0&&this.showScrollLink()},n.prototype.hideScrollLink=function(){var e=this;this.previousScrollLinkState!=="hidden"&&(this.previousScrollLinkState="hidden",this.$scrollLink.delay(500).stop(!0,!0).fadeTo(e.linkTransitionSpeed,0))},n.prototype.showScrollLink=function(){var e=this;this.previousScrollLinkState!=="visible"&&(this.previousScrollLinkState="visible",this.$scrollLink.delay(500).stop(!0,!0).fadeTo(e.linkTransitionSpeed,1))},n}),function(e){e.fn.popupWindow=function(t){return this.each(function(){e(this).click(function(){e.fn.popupWindow.defaultSettings={centerBrowser:0,centerScreen:0,height:500,left:0,location:0,menubar:0,resizable:0,scrollbars:1,status:0,width:500,windowName:null,windowURL:null,top:0,toolbar:0},settings=e.extend({},e.fn.popupWindow.defaultSettings,t||{});var n="height="+settings.height+",width="+settings.width+",toolbar="+settings.toolbar+",scrollbars="+settings.scrollbars+",status="+settings.status+",resizable="+settings.resizable+",location="+settings.location+",menuBar="+settings.menubar;settings.windowName=this.name||settings.windowName,settings.windowURL=this.href||settings.windowURL;var r,i;return settings.centerBrowser?(e.browser.msie?(r=window.screenTop-120+((document.documentElement.clientHeight+120)/2-settings.height/2),i=window.screenLeft+((document.body.offsetWidth+20)/2-settings.width/2)):(r=window.screenY+(window.outerHeight/2-settings.height/2),i=window.screenX+(window.outerWidth/2-settings.width/2)),window.open(settings.windowURL,settings.windowName,n+",left="+i+",top="+r).focus()):settings.centerScreen?(r=(screen.height-settings.height)/2,i=(screen.width-settings.width)/2,window.open(settings.windowURL,settings.windowName,n+",left="+i+",top="+r).focus()):window.open(settings.windowURL,settings.windowName,n+",left="+settings.left+",top="+settings.top).focus(),!1})})}}(jQuery),define("assets/scripts/libs/jquery.popupWindow",[],function(){}),define("assets/scripts/helpers/CookieHandler",["jquery"],function(){"use strict";var e=864e5,t=function(e,t){var n="",r;if(e!==null){var i=e.split("&");for(r=0;r<i.length;r++){var s=i[r].split("=");if(s[0]===t){n=s[1];break}}}return n},n=function(e,t){var n;for(n=0;n<e.length;++n){var r,i,s,o=e[n].split(";");for(r=0;r<o.length;r++){i=o[r].substr(0,o[r].indexOf("=")),s=o[r].substr(o[r].indexOf("=")+1),i=i.replace(/^\s+|\s+$/g,"");if(i===t)return decodeURIComponent(s)}}return""},r=function(e){var t;for(t=0;t<e.length;++t)document.cookie=e[t]},i=function(e){document.cookie=e},s=function(t,n,r){var i;if(r){var s=new Date;s.setTime(s.getTime()+r*e),i="; expires="+s.toGMTString()}else i="";document.cookie=t+"="+n+i+"; path=/"},o=function(e){s(e,"",-1)};return{createCookie:s,getCookie:n,setCookies:r,parseCookie:t,deleteCookie:o}}),define("assets/scripts/presenters/MyHallmark",["jquery","assets/scripts/libs/jquery.popupWindow","assets/scripts/helpers/CookieHandler","assets/scripts/events"],function(e,t,n,r){"use strict";var i=function(){var t=this;e.support.cors=!0;var r=new Image;r.src="/assets/images/loadingIcon-big.gif",this.drawer=e("#my-hallmark-drawer"),this.currentUrl=encodeURIComponent(location.pathname)+encodeURIComponent(location.search)+encodeURIComponent(location.hash),this.maxDisplayCount=3,this.events=[];var i=n.getCookie([document.cookie],"UserInformation"),s=n.parseCookie(i,"UserEmail");t.doOverrides(),s?(t.getDrawerData(),e("#my-hallmark-drawer-logged-in").show(),e("#my-hallmark-drawer-logged-out").hide()):(t.getDrawerData(),e("#my-hallmark-drawer-logged-in").hide(),e("#my-hallmark-drawer-logged-out").show()),t.bind()};return i.prototype.bind=function(){var t=this;e("body").on(r.NAVIGATION_DISPLAYED,function(t){t.id==="my-hallmark-drawer"&&e("#my-hallmark-flag").hide()}).on(r.DRAWER_DATA_UPDATED,function(e){t.getDrawerData()})},i.prototype.doOverrides=function(){var t=this;e("#forgot-password-link").attr("href","/UserLogon/ForgotPassword?URL="+encodeURIComponent(t.currentUrl)),e("#create-account-link").attr("href","/UserLogon/SignInSignUp?URL="+encodeURIComponent(t.currentUrl)+"&drawerLogin=true"),e("#signin-password").keyup(function(e){e.keyCode===13&&t.signIn(e)}),e("#signin-remember-me").click(function(n){e("#signin-remember-me-warning").is(":visible")?e("#signin-remember-me-warning").hide():e("#signin-remember-me-warning").show();var i=e.Event(r.DRAWER_RESIZE_REQUESTED,{id:t.drawer,height:t.drawer.height()});e("body").trigger(i)}),e("#my-hallmark-flag").hide(),e(".error",e(".header-main")).hide(),e("#facebook-login-link").click(function(e){e.preventDefault(),t.facebookLogIn()}),e("#facebook-login-link-2").click(function(e){e.preventDefault(),t.facebookLogIn()}),e("#facebook-logout-link").click(function(e){e.preventDefault(),t.facebookLogOut()}),e("#facebook-logout-link-2").click(function(e){e.preventDefault(),t.facebookLogOut()}),e("#facebook-logout-link").hide(),e("#facebook-logout-link-2").hide(),e("#facebook-user-name").hide(),e("#facebook-user-name-2").hide(),e("#signin-submit-button").click(function(e){t.signIn(e)}),e("#logout-link").click(function(e){e.preventDefault(),t.showSpinner(!0),t.signOut()}),e("#event-count").html(""),e("#event-count").removeClass("inline-counter"),e("#address-count").html(""),e("#address-count").removeClass("inline-counter"),e("#saved-item-count").html("")},i.prototype.signIn=function(t){var n=this;t.preventDefault(),n.showSpinner(!0),e(".error",e(".header-main")).hide(),e("#signin-username").parent().removeClass("form-error"),e("#signin-password").parent().removeClass("form-error");var r=e("#signin-username").val();r==="Email Address"&&(r="");var i=e("#signin-password").val();i==="Password"&&(i="");var s=[];r||s.push({Key:"QuickSignInEmailAddress",Message:"Please enter an e-mail address."}),i||s.push({Key:"QuickSignInPassword",Message:"Please enter a password or click Forgot your password?"});if(s.length)return n.displayValidationErrors(s),!1;var o=e("#signin-remember-me").is(":checked"),u="https://"+location.hostname;location.hostname==="localhost"&&(u="http://"+location.host),n.formLogin(u,r,i,o)},i.prototype.formLogin=function(t,n,r,i){var s=e('<form id="js-logon-form" action="'+t+"/userlogon/usersignin/?postLogonUrl="+encodeURIComponent(location.pathname+location.search)+'" method="post"></form>');e('<input type="hidden" name="signInEmailAddress" />').attr("value",n).appendTo(s),e('<input type="hidden" name="signInPassword" />').attr("value",r).appendTo(s),e('<input type="hidden" name="signInRememberMe" />').attr("value",i).appendTo(s),e("#js-logon-form").remove(),e("body").append(s),e("#js-logon-form").submit()},i.prototype.ajaxLogin=function(t,r,i,s){var o=this,u=t+"/userlogon/quicksignin/";e.ajax({url:u,dataType:"json",type:"POST",data:{signInEmailAddress:r,signInPassword:i,signInRememberMe:s},success:function(t){if(t.Errors!==""&&t.Errors.length>0)t.Errors[0].Key!=="CommonError.FirstTimeResetPasswordException"||t.Errors[0].Tag!=="2"&&t.Errors[0].Tag!=="3"?o.displayValidationErrors(t.Errors):window.open("/userlogon/passwordreset/");else{e(".error",e(".header-main")).hide(),e("#signin-password").val("");var r=n.getCookie(t.Cookies,"UserInformation"),i=n.parseCookie(r,"UserEmail");i?(n.setCookies(t.Cookies),location.reload()):(e("#signin-password-error").html("We are unable to process your request. Please try again later."),e("#signin-password-error").show())}o.showSpinner(!1)},error:function(e,t,n){o.displayValidationErrors([{Key:"QuickSignInPassword",Message:"An error occurred sending your request. Please login from the Create Account page."}]),o.showSpinner(!1)}})},i.prototype.signOut=function(){location.href="/UserLogon/SignOff"},i.prototype.facebookLogIn=function(){var t=this;t.showSpinner(!0),e("#fbLoginAnchor").length===0&&e("body").append("<a href='' id='fbLoginAnchor' style='display:none;' target='_blank'>Open FB</a>"),e("#fbLoginAnchor").popupWindow({centerScreen:1,height:800,width:1100,location:1});var n=!1,r="",i="",s="",o="";s===""&&(s=document.location.pathname+document.location.search),e.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:"/ThirdPartyAuthorization/FacebookLogin",async:!1,dataType:"json",data:{redirectURL:"",scope:o},error:function(e){},success:function(e){n=!0,r=e.AuthorizationURL,i=e.ErrorMessage}}),n&&(null===i||""===i)&&(r!==""?(e("#fbLoginAnchor").attr("href",r),e("#fbLoginAnchor").click()):window.location=document.location.protocol+"//"+document.location.hostname+(document.location.port!==""?":"+document.location.port:"")+s),t.showSpinner(!1)},i.prototype.facebookLogOut=function(){var t=this,n;t.showSpinner(!0),e.post("/ThirdPartyAuthorization/Logout",{ServiceProvider:"facebook",RedirectURL:"",Code:""},function(e){if(null===e||""===e)if(null!==window.location.search&&window.location.search.length>0){var t=window.location.search,n="ContinueWithoutMerge=Y",r=t.indexOf("ContinueWithoutMerge");r!==-1&&(r===1?t="?"+t.substring(n.length+2,t.length):r>1&&(t=t.substring(0,r)+t.substring(n.length+1,t.length))),window.location.href=document.location.protocol+"//"+document.location.hostname+(document.location.port!==""?":"+document.location.port:"")+document.location.pathname+t}else window.location.reload()}),t.showSpinner(!1)},i.prototype.showSpinner=function(t){var n=this,r;t===!0?e("#spinner").length===0&&(r="top: "+n.drawer.css("margin-top")+"; width: "+n.drawer.width()+"px; height: "+n.drawer.outerHeight()+"px; ",n.drawer.append('<div id="spinner" class="spin_div" style="position: absolute; '+r+'"></div>')):e("#spinner").remove()},i.prototype.calculateDaysAway=function(e,t){var n=new Date,r=n.getDate(),i=n.getMonth()+1,s=n.getFullYear(),o=new Date(i+"/"+r+"/"+s),u=o.getFullYear(),a=new Date(e+"/"+t+"/"+u);a<o&&(u+=1,a=new Date(e+"/"+t+"/"+u));var f=parseFloat(Math.ceil(a-o)),l;return l=Math.round(f/864e5)+1,l},i.prototype.getDrawerData=function(){var t=this,n=0;e("#welcome-header").html("<img src='/assets/images/loadingIcon-small.gif' />"),t.showSpinner(!0),e("#event-ol-container").empty();var r="/myhallmark/getdrawerdata/",i={};e.ajax({url:r,dataType:"json",data:i,success:function(r){r.Data.AvatarUrl!==""?e("#avatar-image").attr({src:r.Data.AvatarUrl,title:r.Data.FirstName,alt:r.Data.FirstName,height:"67px",width:"67px"}):e("#avatar-image").attr({src:"/images/avatars/avatar_01.png",title:r.Data.FirstName,alt:r.Data.FirstName,height:"67px",width:"67px"}),e("#welcome-header").html("Hi, "+r.Data.DisplayName),r.Data.FacebookName!==""&&(e("#facebook-login-link").hide(),e("#facebook-login-link-2").hide(),e("#facebook-logout-link").show(),e("#facebook-logout-link-2").show(),e("#facebook-user-name").html(r.Data.FacebookName),e("#facebook-user-name-2").html(r.Data.FacebookName),e("#facebook-user-name").show(),e("#facebook-user-name-2").show()),r.Data.CrownRewards.IsMember===!0?(e("#crown-rewards-number").html(r.Data.CrownRewards.Number),e("#crown-rewards-points").html(r.Data.CrownRewards.Points),e("#crown-rewards-level").html(r.Data.CrownRewards.CurrentTier),e("#crown-rewards-order-status").html(r.Data.CrownRewards.DollarsRequired),e("#crown-rewards-cards").html(r.Data.CrownRewards.CardsRequired),e("#crown-rewards-true").show(),e("#crown-rewards-true-2").show(),e("#crown-rewards-false").hide()):(e("#crown-rewards-true").hide(),e("#crown-rewards-true-2").hide(),e("#crown-rewards-false").show()),r.Data.PendingInvitationCount>0||r.Data.PendingConnectionRequestCount>0?e("#my-hallmark-flag").show():e("#my-hallmark-flag").hide(),r.Data.PendingInvitationCount>0?(e("#event-count").html(r.Data.PendingInvitationCount),e("#event-count").addClass("inline-counter")):(e("#event-count").html(""),e("#event-count").removeClass("inline-counter")),r.Data.PendingConnectionRequestCount>0?(e("#address-count").html(r.Data.PendingConnectionRequestCount),e("#address-count").addClass("inline-counter")):(e("#address-count").html(""),e("#address-count").removeClass("inline-counter")),r.Data.SavedItemCount>0?e("#saved-item-count").html(r.Data.SavedItemCount):e("#saved-item-count").html(""),r.Data.ShoppingBagCount>0?(e("#shopping-bag-count").html(r.Data.ShoppingBagCount),e("#shopping-bag-count").show()):(e("#shopping-bag-count").html(""),e("#shopping-bag-count").hide());for(n=0;n<r.Data.Events.length;n++){var i=t.calculateDaysAway(r.Data.Events[n].Month,r.Data.Events[n].Day);t.events.push({ID:r.Data.Events[n].ID,Description:r.Data.Events[n].Description,Month:r.Data.Events[n].Month,MonthName:r.Data.Events[n].MonthName,Day:r.Data.Events[n].Day,Year:r.Data.Events[n].Year,DaysAway:i,Source:r.Data.Events[n].Source,Type:r.Data.Events[n].ProgramClassificationCode,CategoryID:r.Data.Events[n].CategoryID})}t.displayEvents()}}),t.showSpinner(!1)},i.prototype.displayValidationErrors=function(t){var n,i=this;e("#signin-username-error").empty(),e("#signin-password-error").empty(),i.showSpinner(!1);for(n=0;n<t.length;n++)t[n].Key.substr(0,t[n].Key.indexOf("."))!=="undefined"&&t[n].Key.substr(0,t[n].Key.indexOf("."))==="CommonError"?(e("#signin-password-error").append(t[n].Message),e("#signin-password-error").show()):t[n].Key==="QuickSignInEmailAddress"?(e("#signin-username").parent().addClass("form-error"),e("#signin-username-error").append(t[n].Message),e("#signin-username-error").show()):t[n].Key==="QuickSignInPassword"?(e("#signin-password").parent().addClass("form-error"),e("#signin-password-error").append(t[n].Message),e("#signin-password-error").show()):(e("#signin-password-error").append(t[n].Message),e("#signin-password-error").show());var s=e.Event(r.DRAWER_RESIZE_REQUESTED,{id:i.drawer,height:i.drawer.height()});e("body").trigger(s)},i.prototype.sortByDaysAway=function(e,t){return e.DaysAway===t.DaysAway?0:e.DaysAway>t.DaysAway?1:-1},i.prototype.appendWithApostrophe=function(e){return e!==null?e.lastIndexOf("s")!==e.length-1?e+"'s":e+"'":""},i.prototype.displayEvents=function(){var t=this,n=0;e("#event-ol-container").empty(),e("#event-ol-container").append("<li><a href='#'><span class='heading-caps'></span><img src='/assets/images/loadingIcon-small.gif' /></a></li>"),t.events.sort(t.sortByDaysAway),e("#event-ol-container").empty();var r=t.maxDisplayCount;t.events.length<r&&(r=t.events.length);for(n=0;n<r;n++)if(t.events[n].Source==="F"){var i=t.appendWithApostrophe(t.events[n].Description);e("#event-ol-container").append("<li><span class='heading-caps'>"+t.events[n].MonthName.toUpperCase().substring(0,3)+" "+t.events[n].Day+"</span> <span class='icon icon-inline icon-inline-facebook'>Facebook Icon</span>"+i+" Birthday"+"</li>")}else{var s=t.events[n].Month+"/"+t.events[n].Day+"/"+t.events[n].Year;t.events[n].Type==="C"?e("#event-ol-container").append("<li><a href='/Programs/LoadProgramDetails/"+t.events[n].ID+"/C?StartDate="+s+"'><span class='heading-caps'>"+t.events[n].MonthName.toUpperCase().substring(0,3)+" "+t.events[n].Day+"</span> <span class=''>"+t.events[n].Description+"</span></a></li>"):t.events[n].Type==="I"?e("#event-ol-container").append("<li><a href='/Programs/LoadProgramDetails/"+t.events[n].ID+"/I?StartDate="+s+"'><span class='heading-caps'>"+t.events[n].MonthName.toUpperCase().substring(0,3)+" "+t.events[n].Day+"</span> <span class=''>"+t.events[n].Description+"</span></a></li>"):t.events[n].CategoryID==="H"?e("#event-ol-container").append("<li><span class='heading-caps'>"+t.events[n].MonthName.toUpperCase().substring(0,3)+" "+t.events[n].Day+"</span> <span class=''>"+t.events[n].Description+"</span></li>"):e("#event-ol-container").append("<li><a href='/Events/LoadEventDetails/"+t.events[n].ID+"/?StartDate="+s+"'><span class='heading-caps'>"+t.events[n].MonthName.toUpperCase().substring(0,3)+" "+t.events[n].Day+"</span> <span class=''>"+t.events[n].Description+"</span></a></li>")}},i}),define("assets/scripts/libs/text!assets/scripts/views/modals/modal-template-secondary.html",[],function(){return'<div id="js-modal-container-secondary" class="modal modal-secondary modal-loading mod is-hidden">\n    <div class="modal-content modal-content-secondary js-modal-content-secondary">\n        <a href="#" class="icon icon-close icon-close-modal js-close-modal">Close Modal</a>\n        <img class="js-loading" src="/assets/images/loadingicon-big.gif" alt="Page is loading...">\n    </div>\n</div>'}),define("assets/scripts/libs/text!assets/scripts/views/modals/overlay-template-secondary.html",[],function(){return'<div id="js-modal-overlay-secondary" class="overlay overlay-modal overlay-modal-secondary is-hidden"></div>'}),define("assets/scripts/presenters/modals/ModalSecondaryBuilder",["jquery","assets/scripts/libs/text!assets/scripts/views/modals/modal-template-secondary.html","assets/scripts/libs/text!assets/scripts/views/modals/overlay-template-secondary.html","assets/scripts/presenters/product/browse/SpecialOffersModal","assets/scripts/presenters/modals/QuickLookModal","assets/scripts/presenters/modals/AddToSavedItemsModal","assets/scripts/presenters/modals/StaticModal","assets/scripts/presenters/modals/FindAStoreModal","assets/scripts/presenters/modals/ShareModal","assets/scripts/presenters/modals/ECardSubscriptionModal","assets/scripts/presenters/modals/ShippingDeliveryModal","assets/scripts/presenters/modals/NeedHelp","assets/scripts/presenters/modals/BuyOnlineModal","assets/scripts/view-helpers/EscButtonManager"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";var d=function(){this.modal=null,this.$modalContainer=null,this.$modalOverlay=null,this.confirmModalPresence()};return d.prototype.bind=function(t){var n=this;e("body").on({click:function(t){var d=e(this),v=d.attr("data-modal-type"),m;switch(v){case"special-offers":m=r;break;case"quicklook":m=i;break;case"add-to-saved-items":m=s;break;case"static":m=o;break;case"find-a-store":m=u;break;case"share":m=a;break;case"ecard-subscription":m=f;break;case"shipping-delivery":m=l;break;case"need-help":m=c;break;case"buy-online":m=h}n.constructModal(m),t.preventDefault(),n.launchInitialModal(d,n.populateModal,n),p.pushCallbackAndConfirmBound(function(){n.closeModal()})}},t)},d.prototype.bindClose=function(){var t=this;this.$modalContainer.on({click:function(n){e(n.target).hasClass("js-close-modal")&&(n.preventDefault(),n.stopPropagation()),t.closeModal()}},'.js-close-modal, a[target="_blank"]'),this.$modalOverlay.on({click:function(e){t.closeModal(),e.stopPropagation()}})},d.prototype.closeModal=function(){this.$modalOverlay.fadeOut(350),this.$modalContainer.fadeOut(350,function(){e(this).remove()})},d.prototype.confirmModalPresence=function(){var n=this;this.$modalContainer=e("#js-modal-container-secondary"),this.$modalOverlay=e("#js-modal-overlay-secondary"),this.$loaderImage=this.$modalContainer.find(".js-loading-secondary").eq(0),this.$modalContainer.length===0&&(this.$modalContainer=e(t),e("body").append(this.$modalContainer)),this.$loaderImage.length===0&&(this.$loaderImage=this.$modalContainer.find(".js-loading-secondary").eq(0)),this.bindClose(),this.confirmOverlayPresence()},d.prototype.confirmOverlayPresence=function(){var t=this;this.$modalOverlay.length===0&&(this.$modalOverlay=e(n),e("body").append(this.$modalOverlay))},d.prototype.constructModal=function(e){this.modal=new e},d.prototype.launchInitialModal=function(e,t,n){this.confirmOverlayPresence(),this.showLoader(),this.modal.fetchContent(e,t,n)},d.prototype.populateModal=function(e,t){e.css("visibility","hidden");var n=t.$modalContainer.find(".js-modal-content-secondary").eq(0);n.append(e),t.modal.modalHelper.transitionInContent(t.$modalContainer,e,function(){t.modal.bind()})},d.prototype.showLoader=function(){var t=this;this.confirmModalPresence(),this.modal.modalHelper.setContainerAndOverlay(t.$modalContainer,t.$modalOverlay);var n=this.modal.modalHelper.getCurrentContentContainer();if(n.length!==0)n.remove();else{var r=this.$modalContainer.css("top");this.$modalContainer.css("top",parseInt(r,10)+e(window).scrollTop()).fadeIn(150)}this.$modalOverlay.fadeIn(150),this.modal.modalHelper.positionLoader()},d}),require(["jquery","assets/scripts/presenters/Header","assets/scripts/presenters/ScrollTop","assets/scripts/presenters/MyHallmark","assets/scripts/presenters/modals/ModalBuilder","assets/scripts/presenters/modals/ModalSecondaryBuilder"],function(e,t,n,r,i,s){"use strict";e(function(){e(".nav-main > li:eq(2)").addClass("js-exclude-nav no-drawer").find("div").remove();var o=new t,u=new r;if(e(".back-to-top").length!==0)var a=new n;var f="#js-modal-container[data-modal-persistence] a[data-modal-type]",l="a[data-modal-type]:not("+f+")",c=e(l);if(c.length!==0){var h=this,p=new i;p.bind(l),e(l).on("click",function(){var t=e(this);t.unbind("click"),h.mySecondaryModals===undefined&&t.attr("data-modal-persistence")==="true"&&(h.mySecondaryModals=new s,h.mySecondaryModals.bind(f))})}})}),define("assets/scripts/global",[],function(){})