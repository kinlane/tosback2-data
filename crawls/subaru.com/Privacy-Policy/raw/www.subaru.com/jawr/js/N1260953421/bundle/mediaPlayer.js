
var soaMediaPlayer={expressInstallPath:pathPrefix+"js/expressinstall.fla",open_modalPlayer:function(swfPath,media,xmlType,width,height,closeAlignment,fullScreen){var swf='<script type="text/javascript">';swf+='var flashvars = {'+xmlType+': "'+media+'", siteUrl: "'+mediaPlayerPrefix+'"};';swf+='var params = {quality: "high", allowscriptaccess: "always", allowfullscreen: "'+fullScreen+'", menu: "false"};';swf+='var attributes = {id: "media-gallery", align: "'+closeAlignment+'"};';swf+='swfobject.embedSWF("'+pathPrefix+swfPath+'", "TB_flash_content", "'+width+'", "'+height+'", "9", "'+soaMediaPlayer.expressInstallPath+'", flashvars, params, attributes);';swf+='</script>';window.scrollTo(0,0);$("#mediaGalleryCont").modal({containerId:'modal950Cont',overlayClose:true,escClose:true});$('#TB_flash_content').empty().append(swf);return false;},open_modalHtmlPlayer:function(swfPath,media,xmlType,playerId,playerType,width,height,closeAlignment,fullScreen){var swf='<div id="'+playerType+playerId+'" data-rel="'+media+'" data-id="'+playerId+'" class="'+playerType+playerId+' '+playerType+'_container"></div>';swf+='<script type="text/javascript">';swf+='var flashvars = {'+xmlType+': "'+media+'", siteUrl: "'+mediaPlayerPrefix+'"};';swf+='var params = {quality: "high", allowscriptaccess: "always", allowfullscreen: "'+fullScreen+'", menu: "false"};';swf+='var attributes = {id: "media-gallery", align: "'+closeAlignment+'"};';swf+='swfobject.embedSWF("'+pathPrefix+swfPath+'", "TB_flash_content", "'+width+'", "'+height+'", "9", "'+soaMediaPlayer.expressInstallPath+'", flashvars, params, attributes);';swf+='</script>';swf+='<script type="text/javascript">buildHtmlMediaGalleries();</script>';var modal_container_id=soaMediaPlayer.set_containerId(width);window.scrollTo(0,0);$("#mediaGalleryCont").modal({containerId:modal_container_id,overlayClose:true,escClose:true});$('#TB_flash_content').width(width);$('#TB_flash_content').empty().append(swf);return false;},open_modalHtmlPlayerModal:function(swfPath,media,xmlType,playerId,playerType,width,height,closeAlignment,fullScreen){var swf='<div id="'+playerType+playerId+'" data-rel="'+media+'" data-id="'+playerId+'" class="'+playerType+playerId+' '+playerType+'_container"></div>';swf+='<script type="text/javascript">';swf+='var flashvars = {'+xmlType+': "'+media+'", siteUrl: "'+mediaPlayerPrefix+'"};';swf+='var params = {quality: "high", allowscriptaccess: "always", allowfullscreen: "'+fullScreen+'", menu: "false"};';swf+='var attributes = {id: "media-gallery", align: "'+closeAlignment+'"};';swf+='swfobject.embedSWF("'+pathPrefix+swfPath+'", "TB_flash_content", "'+width+'", "'+height+'", "9", "'+soaMediaPlayer.expressInstallPath+'", flashvars, params, attributes);';swf+='</script>';swf+='<script type="text/javascript">buildHtmlMediaGalleries();</script>';var modal_container_id=soaMediaPlayer.set_containerId(width);window.scrollTo(0,0);$("#mediaGalleryCont").modal({containerId:modal_container_id,overlayClose:false,escClose:false});$('#TB_flash_content').width(width);$('#TB_flash_content').empty().append(swf);return false;},open_modalImage:function(imagePath,modaltype){var html="";if(modaltype==undefined){html='<img src="'+pathPrefix+imagePath+'" alt="Modal Image" />';}
else if(modaltype=="zipcode"){html='<a href="#" onClick="closeModal();BRZ.Form.modal_check_zip();"><img src="'+pathPrefix+imagePath+'" alt="Modal Image" /></a>';}
$("#mediaGalleryCont").modal({containerId:'modal950Cont',overlayClose:true,escClose:true});$('#TB_flash_content').empty().append(html);$('#modalOverlay').css({height:($(document).height().toString()+"px"),overflow:"hidden"});window.scrollTo(0,0);return false;},open_modalImageLinkToAvailability:function(imagePath){var html='<a href="#" onClick="closeModal(); listen_formFindDealerVME();"><img src="'+pathPrefix+imagePath+'" alt="Modal Image" /></a>';$("#mediaGalleryCont").modal({containerId:'modal950Cont',overlayClose:true,escClose:true});$('#TB_flash_content').empty().append(html);window.scrollTo(0,0);return false;},set_containerId:function(width){var containerId='modal950Cont';if(width==590){containerId='modal590Cont';}
return containerId;}};$(function(){$("body").on('click',"a.mediaPlayerStart",function(){openMediaPlayerModal(this,"swf/ssp-gallery.swf",950,566,"left",false);});$(".mediaPlayerFeatures").click(function(){var media=$(this).attr("id");var playerId=media.match(/(\d+)/)[1];soaMediaPlayer.open_modalHtmlPlayer('media/mp_secondary/SubaruSecondaryGallery.swf',media,'xmlFilePath',playerId,'gallery',590,394,'center',true);});$(".mediaPlayerClose").click(function(){closeModal();});});function closeModal(){$.modal.close();try{$('#TB_flash_content').empty();}catch(e){}}
function openMediaPlayerModal(element,swfGalleryPath,width,height,closeAlignment,fullScreen){var mediaPath=$(element).attr("id");var xmlFilePath=mediaPath;var swfPath=pathPrefix+swfGalleryPath;var expressInstallPath=pathPrefix+"js/expressinstall.fla";var swf="<script type=\"text/javascript\">\nvar params = {";swf+="\n\tquality: \"high\",";swf+="\n\tallowscriptaccess: \"always\",";swf+="\n\tallowfullscreen: \""+fullScreen+"\",";swf+="\n\tmenu: \"false\"";swf+="\n};";swf+="\n\tvar attributes = {";swf+="\n\tid: \"media-gallery\",";swf+="\n\talign: \""+closeAlignment+"\"";swf+="\n};";swf+="\nvar flashvars ={";swf+="\nxmlFilePath: \""+xmlFilePath+"\",";swf+="siteUrl:\""+mediaPlayerPrefix+"\"";swf+="\n};";swf+="\nswfobject.embedSWF(\""+swfPath+"\", \"TB_flash_content\", \""+width+"\", \""+height+"\", \"9\",\""+expressInstallPath+"\", flashvars, params, attributes);</script>";$('body, html').scrollTop(0);if($(element).hasClass('chinese')){$("#mediaGalleryCont").modal({containerId:'rallyMediaContChinese',closeHTML:''});}else{$("#mediaGalleryCont").modal({containerId:'rallyMediaCont'});}
$('#TB_flash_content').append(swf);return false;}
function openMediaPlayer(){var mediaPath=$(this).attr("id");var xmlFilePath=mediaPath;var swfPath=pathPrefix+"swf/ssp-gallery.swf";var expressInstallPath=pathPrefix+"js/expressinstall.fla";var swf="<script type=\"text/javascript\">\nvar params = {";swf+="\n\tquality: \"high\",";swf+="\n};";swf+="\n\tvar attributes = {";swf+="\n\tid: \"media-gallery\",";swf+="\n\talign: \"left\"";swf+="\n};";swf+="\nvar flashvars ={";swf+="\nxmlFilePath: \""+xmlFilePath+"\"";swf+="\n};";swf+="\nswfobject.embedSWF(\""+swfPath+"\", \"TB_flash_content\", \"950\", \"566\", \"9\",\""+expressInstallPath+"\", flashvars, params, attributes);</script>";$('body, html').scrollTop(0);$("#mediaGalleryCont").modal({containerId:'rallyMediaCont'});$("#mediaGalleryFeat").modal({containerId:'rallyMediaCont'});$('#TB_flash_content').append(swf);return false;}
function openMediaPlayer2(xmlFilePath){var swfPath=pathPrefix+"swf/ssp-gallery.swf";var expressInstallPath=pathPrefix+"js/expressinstall.fla";var swf="<script type=\"text/javascript\">\\nvar params = {";swf+="\n\tquality: \"high\",";swf+="\n};";swf+="\n\tvar attributes = {";swf+="\n\tid: \"media-gallery\",";swf+="\n\talign: \"left\"";swf+="\n};";swf+="\nvar flashvars ={";swf+="\nxmlFilePath: \""+xmlFilePath+"\"";swf+="\n};";swf+="\nswfobject.embedSWF(\""+swfPath+"\", \"TB_flash_content\", \"950\", \"566\", \"9\",\""+expressInstallPath+"\", attributes, params);</script>";$('body, html').scrollTop(0);$("#mediaGalleryCont").modal({containerId:'rallyMediaCont'});$('#TB_flash_content').append(swf);return false;}
var direction=1;var xmlProxyPath="";jQuery(document).ready(function($){buildHtmlMediaGalleries();});function buildHtmlMediaGalleries(){try{$("div.mediaplayer_container").each(function(){$.ajax({type:"GET",url:$(this).attr("data-rel"),dataType:"xml",success:mediaplayerXmlParser});});$("div.gallery_container").each(function(){$.ajax({type:"GET",url:$(this).attr("data-rel"),dataType:"xml",success:galleryXmlParser});});}catch(buildHtmlMediaGalleriesException){logException("buildHtmlMediaGalleries",buildHtmlMediaGalleriesException);}}
function mediaplayerXmlParser(xml){try{$(xml).find("mediaPlayers").each(function(){var mediaPlayer=new MediaPlayer(this);if(mediaPlayer.mediaPlayerTypeData.mediaPlayerTypeCss.length>0){$('head').append('<br /><style type="text/css">'+mediaPlayer.mediaPlayerTypeData.mediaPlayerTypeCss+'</style>');}
$.data(document.body,"mediaplayer"+mediaPlayer.mediaPlayerID,{mediaplayerdata:mediaPlayer,currentitemcount:0});$(".mediaplayer"+mediaPlayer.mediaPlayerID).addClass(mediaPlayer.mediaPlayerTypeData.mediaPlayerTypeName);if(mediaPlayer.mediaPlayerTypeData.mediaPlayerTypeScript.length>0){try{var customMediaPlayerScript=mediaPlayer.mediaPlayerTypeData.mediaPlayerTypeScript;while(customMediaPlayerScript.indexOf("' + mediaPlayer.mediaPlayerID + '")>-1){customMediaPlayerScript=customMediaPlayerScript.replace("' + mediaPlayer.mediaPlayerID + '",mediaPlayer.mediaPlayerID);}
while(customMediaPlayerScript.indexOf('" + mediaPlayer.mediaPlayerID + "')>-1){customMediaPlayerScript=customMediaPlayerScript.replace('" + mediaPlayer.mediaPlayerID + "',mediaPlayer.mediaPlayerID);}
while(customMediaPlayerScript.indexOf('" + mediaPlayer.mediaPlayerID')>-1){customMediaPlayerScript=customMediaPlayerScript.replace('" + mediaPlayer.mediaPlayerID',mediaPlayer.mediaPlayerID+'"');}
jQuery.globalEval(customMediaPlayerScript);}catch(evalException){logException("mediaplayerXmlParser evalException",evalException);}}
else{}
$(".mp_"+mediaPlayer.mediaPlayerID+"_cover").click(function(){});$(".mp_"+mediaPlayer.mediaPlayerID+"_cover").hide();setupMediaPlayerNavigation(mediaPlayer.mediaPlayerID);$(".mediaplayer"+mediaPlayer.mediaPlayerID).children().addClass("noselect");if(mediaPlayer.mediaDataCollection.galleryCollection.length>0){mediaPlayer.mediaPlayerSize=mediaPlayer.mediaDataCollection.galleryCollection.length;showMediaPlayerItem(mediaPlayer.mediaPlayerID);}
setMediaPlayerState(mediaPlayer.mediaPlayerID,"ready");});}catch(mediaplayerXmlParserException){logException("mediaplayerXmlParser",mediaplayerXmlParserException);}}
function setupMediaPlayerNavigation(id){try{var mediaPlayer=getMediaPlayerData(id);var mp_nav_container=$(".mediaplayer"+mediaPlayer.mediaPlayerID+" .mp_nav_container");mp_nav_container.append('<ul></ul>');var mp_nav_ul=$(".mediaplayer"+mediaPlayer.mediaPlayerID+" .mp_nav_container ul");var navTotalWidth=0;var showOverflow=false;if(mediaPlayer.mediaDataCollection.galleryCollection.length>0){for(var i=0;i<mediaPlayer.mediaDataCollection.galleryCollection.length;i++){if(mediaPlayer.mediaDataCollection.galleryCollection[i].mediaTypeName=="Gallery"){var mp_gallery=mediaPlayer.mediaDataCollection.galleryCollection[i].gallery;if(showOverflow==false){mp_nav_ul.append('<li class="mp_'+mediaPlayer.mediaPlayerID+'_nav_'+i+' mp_nav_item"><span class="mp_nav_item_marker"></span><span class="mp_nav_item_divider"></span><div class="mp_nav_item_text">'+mp_gallery.galleryNavTitle+'</div></li>');}
navTotalWidth+=$("li.mp_"+mediaPlayer.mediaPlayerID+"_nav_"+i).width();if(navTotalWidth+200>mediaPlayer.mediaPlayerTypeData.mediaPlayerTypeWidth&&(i<mediaPlayer.mediaDataCollection.galleryCollection.length-1)&&showOverflow==false){showOverflow=true;mp_nav_container.append('<div class="mp_nav_overflow"><div class="mp_nav_overflow_label">Choose Another Gallery</div><ul></ul></div>');navTotalWidth-=$("li.mp_"+mediaPlayer.mediaPlayerID+"_nav_"+i).width();$("li.mp_"+mediaPlayer.mediaPlayerID+"_nav_"+i).remove();$(".mediaplayer"+mediaPlayer.mediaPlayerID+" div.mp_nav_overflow").width(mediaPlayer.mediaPlayerTypeData.mediaPlayerTypeWidth-(navTotalWidth+1));$(".mediaplayer"+mediaPlayer.mediaPlayerID+" div.mp_nav_overflow").bind('click',function(){if($(this).hasClass("hover")){$(this).removeClass("hover");}else{$(this).addClass("hover");}});$(".mediaplayer"+mediaPlayer.mediaPlayerID+" div.mp_nav_overflow").mouseover(function(){$(this).addClass("hover");});$(".mediaplayer"+mediaPlayer.mediaPlayerID+" div.mp_nav_overflow").mouseout(function(){$(this).removeClass("hover");});}
if(showOverflow==true){$(".mediaplayer"+mediaPlayer.mediaPlayerID+" div.mp_nav_overflow ul").append('<li class="mp_'+mediaPlayer.mediaPlayerID+'_nav_'+i+' mp_nav_item"><span class="mp_nav_item_marker"></span><span class="mp_nav_item_divider"></span><div class="mp_nav_item_text">'+mp_gallery.galleryNavTitle+'</div></li>');}
$(".mp_"+mediaPlayer.mediaPlayerID+"_nav_"+i).bind('click',{id:i,mediaplayerdata:mediaPlayer,gallerydata:mp_gallery},function(event){if(getMediaPlayerState(mediaPlayer.mediaPlayerID)!="busy"){if(getMediaPlayerSelectedIndex(mediaPlayer.mediaPlayerID)!=event.data.id){if(getMediaPlayerSelectedIndex(mediaPlayer.mediaPlayerID)>event.data.id){setDirection("left");}else{setDirection("right");}
setMediaPlayerSelectedIndex(mediaPlayer.mediaPlayerID,event.data.id);showMediaPlayerItem(mediaPlayer.mediaPlayerID);if(!$(".mediaplayer"+mediaPlayer.mediaPlayerID+" div.mp_nav_overflow").hasClass("hover")){$(".mediaplayer"+mediaPlayer.mediaPlayerID+" div.mp_nav_overflow").removeClass("hover");}}}});}}
$(".mediaplayer"+mediaPlayer.mediaPlayerID+" .mp_nav_container ul li").mouseover(function(){$(this).addClass("hover");});$(".mediaplayer"+mediaPlayer.mediaPlayerID+" .mp_nav_container ul li").mouseout(function(){$(this).removeClass("hover");});}}catch(setupMediaPlayerNavigationException){logException("setupMediaPlayerNavigation",setupMediaPlayerNavigationException);}}
function showMediaPlayerItem(mediaPlayerID){try{var currentItemCount=$.data(document.body,"mediaplayer"+mediaPlayerID).currentitemcount++;var currentStatus=getMediaPlayerState(mediaPlayerID);if(currentStatus!="busy"){setMediaPlayerState(mediaPlayerID,"busy");var mediaPlayer=getMediaPlayerData(mediaPlayerID);var mp_gallery=mediaPlayer.mediaDataCollection.galleryCollection[mediaPlayer.selectedIndex].gallery;$("div.mediaplayer"+mediaPlayer.mediaPlayerID+" .mp_nav_item").removeClass("selected");$(".mp_"+mediaPlayer.mediaPlayerID+"_nav_"+mediaPlayer.selectedIndex).addClass("selected");var mp_item_container=$(".mediaplayer"+mediaPlayer.mediaPlayerID+" .mp_item_container");var updatedGalleryID="-mp-"+mediaPlayer.mediaPlayerID+"-g-"+mp_gallery.galleryID;mp_item_container.append('<div id="gallery'+updatedGalleryID+'" class="mp_gallery_container gallery'+updatedGalleryID+' gallery_item_'+currentItemCount+'" style="left:'+(mp_item_container.width()*direction)+'px"></div>');if(mediaPlayer.currentGalleryID!=''){mediaPlayer.previousGalleryID=mediaPlayer.currentGalleryID;}
mediaPlayer.currentGalleryID=updatedGalleryID;var gallery_url=xmlProxyPath+mp_gallery.galleryXmlPath;$.ajax({type:"GET",url:gallery_url,dataType:"xml",success:function(xml){galleryXmlParser(xml,updatedGalleryID);if($("div.mp_"+mediaPlayer.mediaPlayerID+"_item_container div.gallery_item_"+(currentItemCount-1)).length){if(mediaPlayer.previousGalleryID!=''){removeAutoCycle(getGalleryData(mediaPlayer.previousGalleryID));}
$("div.mp_"+mediaPlayer.mediaPlayerID+"_item_container div.gallery_item_"+currentItemCount).css("left",mp_item_container.width()*direction);if(direction==1){$("div.mp_"+mediaPlayer.mediaPlayerID+"_item_container div.gallery_item_"+(currentItemCount-1)).animate({"left":"-="+mp_item_container.width()+"px"},500,function(){$(this).remove();setMediaPlayerState(mediaPlayer.mediaPlayerID,"ready");$(".mp_"+mediaPlayer.mediaPlayerID+"_cover").hide();});$("div.mp_"+mediaPlayer.mediaPlayerID+"_item_container div.gallery_item_"+currentItemCount).animate({"left":"-="+mp_item_container.width()+"px"},500);}else{$("div.mp_"+mediaPlayer.mediaPlayerID+"_item_container div.gallery_item_"+(currentItemCount-1)).animate({"left":"+="+mp_item_container.width()+"px"},500,function(){$(this).remove();setMediaPlayerState(mediaPlayer.mediaPlayerID,"ready");$(".mp_"+mediaPlayer.mediaPlayerID+"_cover").hide();});$("div.mp_"+mediaPlayer.mediaPlayerID+"_item_container div.gallery_item_"+currentItemCount).animate({"left":"+="+mp_item_container.width()+"px"},500);}}else{$("div.mp_"+mediaPlayer.mediaPlayerID+"_item_container div.gallery_item_"+currentItemCount).css("left","0").css("opacity",".5");$("div.mp_"+mediaPlayer.mediaPlayerID+"_item_container div.gallery_item_"+currentItemCount).animate({"opacity":"1"},500,function(){setMediaPlayerState(mediaPlayer.mediaPlayerID,"ready");$(".mp_"+mediaPlayer.mediaPlayerID+"_cover").hide();});}}});setMediaPlayerState(mediaPlayerID,"ready");}}catch(showMediaPlayerItemException){logException("showMediaPlayerItem",showMediaPlayerItemException);}}
function getMediaPlayerData(id){return $.data(document.body,"mediaplayer"+id).mediaplayerdata;}
function setMediaPlayerState(id,status){$.data(document.body,"mediaplayer"+id).status=status;if(status=="busy"){$('.mediaplayer_'+id+'_cover').css("display","inherit");}else if(status=="ready"){}}
function getMediaPlayerState(id){return $.data(document.body,"mediaplayer"+id).status;}
function setMediaPlayerSelectedIndex(id,index){$.data(document.body,"mediaplayer"+id).mediaplayerdata.selectedIndex=index;}
function getMediaPlayerSelectedIndex(id){return $.data(document.body,"mediaplayer"+id).mediaplayerdata.selectedIndex;}
function galleryXmlParser(xml,updatedGalleryID){try{$(xml).find("galleries").each(function(){var allowCustom=true;var gallery=new Gallery(this);if($('div.gallery'+updatedGalleryID,'div.mp_item_container').length==1){gallery.galleryID=updatedGalleryID;}
if(gallery.galleryTypeData.galleryTypeCss.length>0&&allowCustom==true){$('head').append('<br /><style type="text/css">'+gallery.galleryTypeData.galleryTypeCss+'</style>');}
$.data(document.body,"gallery"+gallery.galleryID,{gallerydata:gallery,currentitemcount:0});$(".gallery"+gallery.galleryID).addClass(gallery.galleryTypeData.galleryTypeName);$(".gallery"+gallery.galleryID).attr("tabIndex",gallery.galleryID);if(gallery.galleryTypeData.galleryTypeScript.length>0&&allowCustom==true){try{var customGalleryScript=gallery.galleryTypeData.galleryTypeScript;while(customGalleryScript.indexOf("' + gallery.galleryID + '")>-1){customGalleryScript=customGalleryScript.replace("' + gallery.galleryID + '",gallery.galleryID);}
while(customGalleryScript.indexOf('" + gallery.galleryID + "')>-1){customGalleryScript=customGalleryScript.replace('" + gallery.galleryID + "',gallery.galleryID);}
while(customGalleryScript.indexOf('" + gallery.galleryID')>-1){customGalleryScript=customGalleryScript.replace('" + gallery.galleryID',gallery.galleryID+'"');}
jQuery.globalEval(customGalleryScript);}catch(evalException){}}
else{switch(gallery.galleryTypeData.galleryTypeName){case"SubaruHero480Gallery":$(".gallery"+gallery.galleryID).html('<div class="item_container"></div><div class="gallery_nav_container"><div class="gallery_nav_collapse">Rollover/Click For Thumbnails</div><div class="gallery_nav"><div class="gallery_nav_bg"></div><div class="gallery_title_container"><div class="gallery_title"></div><div class="gallery_description"></div></div><div class="nav_divider divider1"></div><div class="nav_viewall"></div><div class="nav_divider divider2"></div><div class="gallery_'+gallery.galleryID+'_thumb_container thumb_container"></div><div class="thumb_left_arrow"></div><div class="thumb_right_arrow"></div><div class="nav_divider divider3"></div><div class="nav_controls_container"><div class="nav_fullscreen"></div><div class="nav_download"></div></div></div></div><div class="arrow_container"><div class="left_arrow"><div class="icon"></div></div><div class="right_arrow"><div class="icon"></div></div></div><div class="gallery_footer"><div class="gallery_item_count"></div><div class="gallery_item_title_container"><div class="gallery_item_title"></div><div class="gallery_item_description"></div></div></div><div class="gallery_'+gallery.galleryID+'_view_all_container gallery_view_all_container"></div><div class="gallery_'+gallery.galleryID+'_cover gallery_cover"></div>');gallery.galleryOptions.useNav=1;gallery.galleryOptions.useArrows=1;break;case"SubaruHeroGallery":$(".gallery"+gallery.galleryID).html('<div class="item_container"></div><div class="gallery_nav_container"><div class="gallery_nav_collapse">Rollover/Click For Thumbnails</div><div class="gallery_nav"><div class="gallery_nav_bg"></div><div class="gallery_title_container"><div class="gallery_title"></div><div class="gallery_description"></div></div><div class="nav_divider divider1"></div><div class="nav_viewall"></div><div class="nav_divider divider2"></div><div class="gallery_'+gallery.galleryID+'_thumb_container thumb_container"></div><div class="thumb_left_arrow"></div><div class="thumb_right_arrow"></div><div class="nav_divider divider3"></div><div class="nav_controls_container"><div class="nav_fullscreen"></div><div class="nav_download"></div></div></div></div><div class="arrow_container"><div class="left_arrow"><div class="icon"></div></div><div class="right_arrow"><div class="icon"></div></div></div><div class="gallery_footer"><div class="gallery_item_count"></div><div class="gallery_item_title_container"><div class="gallery_item_title"></div><div class="gallery_item_description"></div></div></div><div class="gallery_'+gallery.galleryID+'_view_all_container gallery_view_all_container"></div><div class="gallery_'+gallery.galleryID+'_cover gallery_cover"></div>');gallery.galleryOptions.useNav=1;gallery.galleryOptions.useArrows=1;break;case"SubaruSecondaryGallery":$(".gallery"+gallery.galleryID).html('<div class="item_container"></div><div class="gallery_nav_container"><div class="gallery_nav_collapse">Rollover/Click For Thumbnails</div><div class="gallery_nav"><div class="gallery_nav_bg"></div><div class="gallery_title_container"><div class="gallery_title"></div><div class="gallery_description"></div></div><div class="nav_divider divider1"></div><div class="nav_viewall"></div><div class="nav_divider divider2"></div><div class="gallery_'+gallery.galleryID+'_thumb_container thumb_container"></div><div class="thumb_left_arrow"></div><div class="thumb_right_arrow"></div><div class="nav_divider divider3"></div><div class="nav_controls_container"><div class="nav_fullscreen"></div><div class="nav_download"></div></div></div></div><div class="arrow_container"><div class="left_arrow"><div class="icon"></div></div><div class="right_arrow"><div class="icon"></div></div></div><div class="gallery_footer"><div class="gallery_item_count"></div><div class="gallery_item_title_container"><div class="gallery_item_title"></div><div class="gallery_item_description"></div></div></div><div class="gallery_'+gallery.galleryID+'_view_all_container gallery_view_all_container"></div><div class="gallery_'+gallery.galleryID+'_cover gallery_cover"></div>');gallery.galleryOptions.useNav=1;gallery.galleryOptions.useArrows=1;break;case"SubaruRallyGallery":$(".gallery"+gallery.galleryID).html('<div class="item_container"></div><div class="gallery_nav_container"><div class="gallery_nav_collapse">Rollover/Click For Thumbnails</div><div class="gallery_nav"><div class="gallery_nav_bg"></div><div class="gallery_title_container"><div class="gallery_title"></div><div class="gallery_description"></div></div><div class="nav_divider divider1"></div><div class="nav_viewall"></div><div class="nav_divider divider2"></div><div class="gallery_'+gallery.galleryID+'_thumb_container thumb_container"></div><div class="thumb_left_arrow"></div><div class="thumb_right_arrow"></div><div class="nav_divider divider3"></div><div class="nav_controls_container"><div class="nav_fullscreen"></div><div class="nav_download"></div></div></div></div><div class="arrow_container"><div class="left_arrow"><div class="icon"></div></div><div class="right_arrow"><div class="icon"></div></div></div><div class="gallery_footer"><div class="gallery_item_count"></div><div class="gallery_item_title_container"><div class="gallery_item_title"></div><div class="gallery_item_description"></div></div></div><div class="gallery_'+gallery.galleryID+'_view_all_container gallery_view_all_container"></div><div class="gallery_'+gallery.galleryID+'_cover gallery_cover"></div>');break;case"SubaruInlineGallery":$(".gallery"+gallery.galleryID).append('<div class="item_container"></div><div class="arrow_container"><div class="left_arrow"><div class="icon"></div></div><div class="right_arrow"><div class="icon"></div></div></div><div class="gallery_'+gallery.galleryID+'_cover gallery_cover"></div>');gallery.galleryOptions.useNav=0;gallery.galleryOptions.useArrows=1;break;case"WeathermanGallery":$(".gallery"+gallery.galleryID).html('<div class="item_container"></div><div class="gallery_nav_container"><div class="gallery_nav_collapse">Rollover/Click For Thumbnails</div><div class="gallery_nav"><div class="gallery_nav_bg"></div><div class="gallery_title_container"><div class="gallery_item_title"></div><div class="gallery_item_description"></div></div><div class="nav_divider divider1"></div><div class="nav_viewall"></div><div class="nav_divider divider2"></div><div class="gallery_'+gallery.galleryID+'_thumb_container thumb_container"></div><div class="thumb_left_arrow"></div><div class="thumb_right_arrow"></div><div class="nav_divider divider3"></div><div class="nav_controls_container"><div class="nav_fullscreen"></div><div class="nav_download"></div></div></div></div><div class="arrow_container"><div class="left_arrow"><div class="icon"></div></div><div class="right_arrow"><div class="icon"></div></div></div><div class="gallery_'+gallery.galleryID+'_view_all_container gallery_view_all_container"></div><div class="gallery_'+gallery.galleryID+'_cover gallery_cover"></div>');break;default:$(".gallery"+gallery.galleryID).append('<div class="item_container"></div><div class="thumb_container"></div><div class="fullscreen_button">Fullscreen</div><div id="arrow_container"><div class="left_arrow"><div class="icon"></div></div><div class="right_arrow"><div class="icon"></div></div></div><div id="gallery_'+gallery.galleryID+'_cover" class="gallery_cover"></div>');gallery.galleryOptions.useNav=1;gallery.galleryOptions.useArrows=1;break;}}
if(gallery.galleryTypeData.galleryTypeOptionCollection.optionCollection.length>0){for(var i=0;i<gallery.galleryTypeData.galleryTypeOptionCollection.optionCollection.length;i++){var galleryTypeOption=gallery.galleryTypeData.galleryTypeOptionCollection.optionCollection[i];switch(galleryTypeOption.param){case"defaultView":gallery.galleryOptions.defaultView=galleryTypeOption.value;break;case"useNav":gallery.galleryOptions.useNav=galleryTypeOption.value;break;case"useArrows":gallery.galleryOptions.useArrows=galleryTypeOption.value;break;case"autoCycle":gallery.galleryOptions.autoCycle=galleryTypeOption.value;break;case"transitionType":gallery.galleryOptions.transitionType=galleryTypeOption.value;break;}}}
if(gallery.gallerySize==1){gallery.galleryOptions.useNav=0;gallery.galleryOptions.useArrows=0;gallery.autoCycle=0;}
$(".gallery_"+gallery.galleryID+"_cover").click(function(){});$(".gallery"+gallery.galleryID+" .gallery_title").append(gallery.galleryName);$(".gallery"+gallery.galleryID+" .gallery_description").append(gallery.galleryDescription);if(gallery.galleryOptions.useArrows==1){setupArrows(gallery);}else{$(".gallery"+gallery.galleryID+" .left_arrow").hide();$(".gallery"+gallery.galleryID+" .right_arrow").hide();}
setupKeyboard(gallery);$(".gallery_"+gallery.galleryID+"_cover").spin("large","white");if(gallery.galleryOptions.useNav==1){setupNavigation(gallery);setupPagingObject(gallery.galleryID);setupThumbs(gallery);updateThumbContainerSize(gallery);updatePagination(gallery);managePageButtons(gallery);}
else{setupPagingObject(gallery.galleryID);$(".gallery"+gallery.galleryID+" .gallery_nav_container").hide();}
$(".gallery"+gallery.galleryID).children().addClass("noselect");updateMediaContainerSize(gallery.galleryID);setGalleryState(gallery.galleryID,"ready");showGalleryItem(gallery.galleryID);if(gallery.galleryOptions.useNav==1&&gallery.galleryOptions.defaultView=="viewall"){$(".gallery"+gallery.galleryID+" .gallery_view_all_container").fadeIn(500);$(".gallery"+gallery.galleryID+" .gallery_nav_container").fadeOut(500);$(".gallery"+gallery.galleryID+" .arrow_container").fadeOut(500);}else{if(gallery.autoCycle==1){setupAutoCycle(gallery);}}});}catch(galleryXmlParserException){logException("galleryXmlParser",galleryXmlParserException);}}
function setupAutoCycle(gallery){try{var autoCycleInterval=setInterval(function(){if(getGalleryState(gallery.galleryID)!="busy"){var currIndex=$.data(document.body,"gallery"+gallery.galleryID).gallerydata.selectedIndex;if($.data(document.body,"gallery"+gallery.galleryID).gallerydata.gallerySize>(currIndex+1)){$.data(document.body,"gallery"+gallery.galleryID).gallerydata.selectedIndex++;}else{$.data(document.body,"gallery"+gallery.galleryID).gallerydata.selectedIndex=0;}
setDirection("right");showGalleryItem(gallery.galleryID);}},6000);setGalleryAutoCycleInterval(gallery.galleryID,autoCycleInterval);}catch(setupAutoCycleException){logException("setupAutoCycle",setupAutoCycleException);}}
function removeAutoCycle(gallery){try{if(gallery.autoCycle==1){clearInterval(getGalleryAutoCycleInterval(gallery.galleryID));}}catch(removeAutoCycleException){logException("removeAutoCycle",removeAutoCycleException);}}
function setupNavigation(gallery){try{setGalleryNavState(gallery.galleryID,'open');$(".gallery"+gallery.galleryID).mousemove(function(e){if(!$(".gallery"+gallery.galleryID+" .gallery_view_all_container").is(':visible')){var x=e.pageX-$("div.gallery"+gallery.galleryID).offset().left;var y=e.pageY-$("div.gallery"+gallery.galleryID).offset().top;var paging=getPagingData(gallery.galleryID);if(y<$("div.gallery"+gallery.galleryID+" .gallery_nav_container").height()){if(getGalleryNavState(gallery.galleryID)=='closing'||getGalleryNavState(gallery.galleryID)=='closed'){clearTimeout(getGalleryNavCloseTimeout(gallery.galleryID));setGalleryNavState(gallery.galleryID,'opening');$(".gallery"+gallery.galleryID+" .gallery_nav_collapse").fadeOut("slow");$(".gallery"+gallery.galleryID+" .gallery_nav").fadeIn("slow",function(){setGalleryNavState(gallery.galleryID,'open');});}}
else{if(getGalleryNavState(gallery.galleryID)=='open'||getGalleryNavState(gallery.galleryID)=='opening'){setGalleryNavState(gallery.galleryID,'closing');var navTimeout=setTimeout(function(){if(getGalleryNavState(gallery.galleryID)=='closing'){$(".gallery"+gallery.galleryID+" .gallery_nav_collapse").fadeIn("slow");$(".gallery"+gallery.galleryID+" .gallery_nav").fadeOut("slow",function(){setGalleryNavState(gallery.galleryID,'closed');});}},2000);setGalleryNavCloseTimeout(gallery.galleryID,navTimeout);}}}});$(".gallery"+gallery.galleryID+" .nav_right_arrow").click(function(){});$(".gallery"+gallery.galleryID+" .nav_left_arrow").click(function(){});$(".gallery"+gallery.galleryID+" .nav_viewall").mouseover(function(){$(this).addClass("hover");});$(".gallery"+gallery.galleryID+" .nav_viewall").mouseout(function(){$(this).removeClass("hover");});if($(".gallery"+gallery.galleryID+" .gallery_view_all_container").length>0){setupViewAllGrid(gallery);}
$(".gallery"+gallery.galleryID+" .nav_fullscreen").mouseover(function(){$(this).addClass("hover");});$(".gallery"+gallery.galleryID+" .nav_fullscreen").mouseout(function(){$(this).removeClass("hover");});$(".gallery"+gallery.galleryID+" .nav_fullscreen").click(function(){var galleryElement=document.getElementById("gallery"+gallery.galleryID);if($(".gallery"+gallery.galleryID).hasClass("fullscreen")){$(window).unbind("resize");var media_img=$(".gallery"+gallery.galleryID+" > div.item_container > div.media_holder > img.media_img");media_img.removeAttr("style");if(window.fullScreenApi.supportsFullScreen){window.fullScreenApi.cancelFullScreen(galleryElement);}else{if(gallery.galleryID.indexOf("-mp-")>-1){$(".gallery"+gallery.galleryID).parent().parent().removeClass("fullscreen");}
$(".gallery"+gallery.galleryID).removeClass("fullscreen");$('body').css('overflow','');updateThumbContainerSize(gallery);updateMediaContainerSize(gallery.galleryID);setupViewAllGrid(gallery);}
$(".gallery"+gallery.galleryID+" > div.gallery_footer").show();swapCurrentImage(gallery);}else{$(window).bind("resize",{gallerydata:gallery},fullscreenResize);if(window.fullScreenApi.supportsFullScreen){window.fullScreenApi.fullScreenGallery=gallery;window.fullScreenApi.requestFullScreen(galleryElement);}else{window.scrollTo(0,0);$('body').css('overflow','hidden');if(gallery.galleryID.indexOf("-mp-")>-1){$(".gallery"+gallery.galleryID).parent().parent().addClass("fullscreen");}
$(".gallery"+gallery.galleryID).addClass("fullscreen");updateThumbContainerSize(gallery);updateMediaContainerSize(gallery.galleryID);setupViewAllGrid(gallery);}
if(gallery.galleryCatalogTypeName=="video"){var video_player=$(".gallery"+gallery.galleryID+" > div.item_container > div.media_holder > div.video_container > video");if(video_player.length){$(".gallery"+gallery.galleryID+" > div.gallery_footer").hide();}}
swapCurrentImage(gallery);$(window).trigger("resize");}});if(!window.fullScreenApi.supportsFullScreen){$(".gallery"+gallery.galleryID+" .nav_fullscreen").css("display","none");}
$(".gallery"+gallery.galleryID+" .nav_download").mouseover(function(){$(this).addClass("hover");});$(".gallery"+gallery.galleryID+" .nav_download").mouseout(function(){$(this).removeClass("hover");});if(gallery.galleryCatalogTypeName=="image"){$(".gallery"+gallery.galleryID+" .nav_download").click(function(e){e.preventDefault();var downloadPath=getDownloadImagePath(gallery.galleryID);window.open(downloadPath,'downloadImage');});}else{$(".gallery"+gallery.galleryID+" .nav_download").addClass("disable");}}catch(setupNavigationException){logException("setupNavigation",setupNavigationException);}}
function swapCurrentImage(gallery){try{var currentItemCount=$.data(document.body,"gallery"+gallery.galleryID).currentitemcount-1;if(gallery.galleryCatalogTypeName=="image"){var imagedata=new ImageData($(gallery.catalog.mediaCollection[gallery.selectedIndex]));var itemImagePath='';if($(".gallery"+gallery.galleryID).hasClass("fullscreen")){itemImagePath=gallery.gallerySettings.liveSiteUrl+gallery.gallerySettings.galleryAssetPath+gallery.galleryTypeData.fullscreenFormat.formatDirectory+'/'+imagedata.imageFileName;$(".gallery_"+gallery.galleryID+"_enlarge_image_"+currentItemCount).attr("width",gallery.galleryTypeData.fullscreenFormat.formatWidth);$(".gallery_"+gallery.galleryID+"_enlarge_image_"+currentItemCount).attr("height",gallery.galleryTypeData.fullscreenFormat.formatHeight);$(".gallery_"+gallery.galleryID+"_enlarge_image_"+currentItemCount).attr("src",itemImagePath).load(function(){$(window).trigger("resize");});}else{itemImagePath=gallery.gallerySettings.liveSiteUrl+gallery.gallerySettings.galleryAssetPath+gallery.galleryTypeData.enlargeFormat.formatDirectory+'/'+imagedata.imageFileName;$(".gallery_"+gallery.galleryID+"_enlarge_image_"+currentItemCount).attr("width",gallery.galleryTypeData.enlargeFormat.formatWidth);$(".gallery_"+gallery.galleryID+"_enlarge_image_"+currentItemCount).attr("height",gallery.galleryTypeData.enlargeFormat.formatHeight);$(".gallery_"+gallery.galleryID+"_enlarge_image_"+currentItemCount).attr("src",itemImagePath).load(function(){$(window).trigger("resize");});}}
else if(gallery.galleryCatalogTypeName=="video"){var videodata=new VideoData($(gallery.catalog.mediaCollection[gallery.selectedIndex]));var itemImagePath='';if($(".gallery"+gallery.galleryID).hasClass("fullscreen")){itemImagePath=gallery.gallerySettings.liveSiteUrl+gallery.gallerySettings.galleryAssetPath+gallery.galleryTypeData.fullscreenFormat.formatDirectory+'/'+videodata.coverImageData.imageFileName;$(".gallery_"+gallery.galleryID+"_enlarge_image_"+currentItemCount).attr("width",gallery.galleryTypeData.fullscreenFormat.formatWidth);$(".gallery_"+gallery.galleryID+"_enlarge_image_"+currentItemCount).attr("height",gallery.galleryTypeData.fullscreenFormat.formatHeight);$(".gallery_"+gallery.galleryID+"_enlarge_image_"+currentItemCount).attr("src",itemImagePath).load(function(){$(window).trigger("resize");});}else{itemImagePath=gallery.gallerySettings.liveSiteUrl+gallery.gallerySettings.galleryAssetPath+gallery.galleryTypeData.enlargeFormat.formatDirectory+'/'+videodata.coverImageData.imageFileName;$(".gallery_"+gallery.galleryID+"_enlarge_image_"+currentItemCount).attr("width",gallery.galleryTypeData.enlargeFormat.formatWidth);$(".gallery_"+gallery.galleryID+"_enlarge_image_"+currentItemCount).attr("height",gallery.galleryTypeData.enlargeFormat.formatHeight);$(".gallery_"+gallery.galleryID+"_enlarge_image_"+currentItemCount).attr("src",itemImagePath).load(function(){$(window).trigger("resize");});}}}catch(swapCurrentImageException){logException("swapCurrentImage",swapCurrentImageException);}}
function fullscreenResize(e){try{var media_img=$("div.fullscreen > div.item_container > div.media_holder > img.media_img");if(media_img.length){media_img.css("top","50%");media_img.css("margin-top",((media_img.height()/2)*-1)+'px');updateThumbContainerSize(e.data.gallerydata);updateMediaContainerSize(e.data.gallerydata.galleryID);setupViewAllGrid(e.data.gallerydata);}else{var media_img=$(".gallery"+e.data.gallerydata.galleryID+" > div.item_container > div.media_holder > img.media_img");media_img.css("top","0");media_img.css("margin-top","0");}
if($(".gallery"+e.data.gallerydata.galleryID+" .gallery_view_all_container").is(':visible')){$(".gallery"+e.data.gallerydata.galleryID+" .gallery_view_all_container").fadeOut(500);$(".gallery"+e.data.gallerydata.galleryID+" .gallery_nav_container").fadeIn(500);$(".gallery"+e.data.gallerydata.galleryID+" .arrow_container").fadeIn(500);}
$(".gallery_"+e.data.gallerydata.galleryID+"_cover").spin(false);$(".gallery_"+e.data.gallerydata.galleryID+"_cover").spin("large","white");}catch(fullscreenResizeException){logException("fullscreenResize",fullscreenResizeException);}}
function setupViewAllGrid(gallery){try{var gallery_view_all_container=$(".gallery"+gallery.galleryID+" .gallery_view_all_container");gallery_view_all_container.html('<div class="gallery'+gallery.galleryID+'_grid_thumb_sample grid_thumb" style="position:absolute;"></div><div class="gallery_view_all_bg"></div><div class="view_all_top_container"><div class="view_all_title_container"><div class="view_all_gallery_title"></div><div class="view_all_gallery_description"></div></div><div class="view_all_close_btn"></div><div class="view_all_paging"></div></div><div class="view_all_bottom_container"><div class="view_all_left_arrow"></div><div class="view_all_thumb_container"></div><div class="view_all_right_arrow"></div></div>');gallery_view_all_container.show();if($(".gallery"+gallery.galleryID).hasClass("fullscreen")){gallery.galleryGridOptions.defaultGridHeight=$(".gallery"+gallery.galleryID+" div.item_container").height();gallery.galleryGridOptions.defaultGridWidth=$(".gallery"+gallery.galleryID+" div.item_container").width()-$(".gallery"+gallery.galleryID+" div.view_all_left_arrow").width()-$(".gallery"+gallery.galleryID+" div.view_all_right_arrow").width();}else{gallery.galleryGridOptions.defaultGridHeight=$(".gallery"+gallery.galleryID+" .view_all_bottom_container").height();gallery.galleryGridOptions.defaultGridWidth=gallery.galleryTypeData.enlargeFormat.formatWidth-$(".gallery"+gallery.galleryID+" div.view_all_left_arrow").width()-$(".gallery"+gallery.galleryID+" div.view_all_right_arrow").width();}
gallery.galleryGridOptions.gridThumbWidth=$(".gallery"+gallery.galleryID+"_grid_thumb_sample").width();gallery.galleryGridOptions.gridThumbHeight=$(".gallery"+gallery.galleryID+"_grid_thumb_sample").height();$(".gallery"+gallery.galleryID+"_grid_thumb_sample").remove();gallery_view_all_container.hide();$(".gallery"+gallery.galleryID+" .view_all_close_btn").mouseover(function(){$(this).addClass("hover");});$(".gallery"+gallery.galleryID+" .view_all_close_btn").mouseout(function(){$(this).removeClass("hover");});$(".gallery"+gallery.galleryID+" .nav_viewall").click(function(){removeAutoCycle(gallery);$(".gallery"+gallery.galleryID+" .gallery_view_all_container").fadeIn(500);$(".gallery"+gallery.galleryID+" .gallery_nav_container").fadeOut(500);$(".gallery"+gallery.galleryID+" .arrow_container").fadeOut(500);});$(".gallery"+gallery.galleryID+" .view_all_close_btn").click(function(){$(".gallery"+gallery.galleryID+" .gallery_view_all_container").fadeOut(500);$(".gallery"+gallery.galleryID+" .gallery_nav_container").fadeIn(500);$(".gallery"+gallery.galleryID+" .arrow_container").fadeIn(500);});$(".gallery"+gallery.galleryID+" .view_all_left_arrow").mouseover(function(){$(this).addClass("hover");});$(".gallery"+gallery.galleryID+" .view_all_left_arrow").mouseout(function(){$(this).removeClass("hover");});$(".gallery"+gallery.galleryID+" .view_all_left_arrow").click(function(){if(getGalleryState(gallery.galleryID)!="busy"){setGalleryState(gallery.galleryID,"busy");gallery.galleryGridOptions.currentPage=gallery.galleryGridOptions.currentPage-1;setViewAllGridPage(gallery);}});$(".gallery"+gallery.galleryID+" .view_all_right_arrow").mouseover(function(){$(this).addClass("hover");});$(".gallery"+gallery.galleryID+" .view_all_right_arrow").mouseout(function(){$(this).removeClass("hover");});$(".gallery"+gallery.galleryID+" .view_all_right_arrow").click(function(){if(getGalleryState(gallery.galleryID)!="busy"){setGalleryState(gallery.galleryID,"busy");gallery.galleryGridOptions.currentPage=gallery.galleryGridOptions.currentPage+1;setViewAllGridPage(gallery);}});$(".gallery"+gallery.galleryID+" .view_all_gallery_title").html(gallery.galleryName);$(".gallery"+gallery.galleryID+" .view_all_gallery_description").html(gallery.galleryDescription);$(".gallery"+gallery.galleryID+" .view_all_paging").html("Viewing 1-1 of 1");setupViewAllThumbs(gallery);}catch(setupViewAllGridException){logException("setupViewAllGrid",setupViewAllGridException);}}
function setupViewAllThumbs(gallery){try{if(gallery.galleryOptions.defaultGridWidth<0){return false;}
var thumb_container=$(".gallery"+gallery.galleryID+" .view_all_thumb_container");thumb_container.html("");thumb_container.append('<div class="gallery_'+gallery.galleryID+'_grid thumb_grid"></div>');gallery.galleryGridOptions.thumbsPerRow=getMaxThumbCount(gallery.galleryGridOptions.defaultGridWidth,gallery.galleryGridOptions.gridThumbWidth);gallery.galleryGridOptions.rowsPerPage=getMaxThumbCount(gallery.galleryGridOptions.defaultGridHeight,gallery.galleryGridOptions.gridThumbHeight);gallery.galleryGridOptions.thumbsPerPage=gallery.galleryGridOptions.thumbsPerRow*gallery.galleryGridOptions.rowsPerPage;thumb_container.width(gallery.galleryGridOptions.thumbsPerRow*gallery.galleryGridOptions.gridThumbWidth);if($(".gallery"+gallery.galleryID).hasClass("fullscreen")){}
var view_all_bottom_container=$(".gallery"+gallery.galleryID+" .view_all_bottom_container");if(gallery.catalog.mediaCollection.length<=gallery.galleryGridOptions.thumbsPerPage){gallery.galleryGridOptions.currentPage=1;gallery.galleryGridOptions.totalPages=1;view_all_bottom_container.height(Math.ceil(gallery.catalog.mediaCollection.length/gallery.galleryGridOptions.thumbsPerRow)*gallery.galleryGridOptions.gridThumbHeight);}else{gallery.galleryGridOptions.currentPage=1;gallery.galleryGridOptions.totalPages=Math.ceil(gallery.catalog.mediaCollection.length/gallery.galleryGridOptions.thumbsPerPage);view_all_bottom_container.height(gallery.galleryGridOptions.rowsPerPage*gallery.galleryGridOptions.gridThumbHeight);}
thumb_container.height(gallery.galleryGridOptions.rowsPerPage*gallery.galleryGridOptions.gridThumbHeight);$(".gallery"+gallery.galleryID+" .view_all_top_container").width(thumb_container.width());var left_arrow=$(".gallery"+gallery.galleryID+" .view_all_left_arrow");left_arrow.css("margin-top",((thumb_container.height()-left_arrow.height())/2));var right_arrow=$(".gallery"+gallery.galleryID+" .view_all_right_arrow");right_arrow.css("margin-top",((thumb_container.height()-right_arrow.height())/2));view_all_bottom_container.width(thumb_container.width()+left_arrow.width()+right_arrow.width());if(gallery.galleryCatalogTypeName=="image"){for(var i=0;i<gallery.catalog.mediaCollection.length;i++){var image=new ImageData($(gallery.catalog.mediaCollection[i]));var thumbImagePath=gallery.gallerySettings.liveSiteUrl+gallery.gallerySettings.galleryAssetPath+gallery.galleryTypeData.thumbFormat.formatDirectory+'/'+image.imageFileName;var thumb_grid=$(".gallery"+gallery.galleryID+"."+gallery.galleryTypeData.galleryTypeName+" .thumb_grid");thumb_grid.append('<div class="gallery_'+gallery.galleryID+'_grid_thumb'+i+' grid_thumb"><img class="gallery_'+gallery.galleryID+'_grid_thumb_image_'+i+' thumb_image" width="'+gallery.galleryTypeData.thumbFormat.formatWidth+'" height="'+gallery.galleryTypeData.thumbFormat.formatHeight+'" border="0" alt="'+image.imageTitle+'" src="'+thumbImagePath+'" /></div>');$(".gallery_"+gallery.galleryID+"_grid_thumb"+i).bind('click',{id:i,gallerydata:gallery,imagedata:image},function(event){if(getGalleryState(gallery.galleryID)!="busy"){if(getSelectedIndex(gallery.galleryID)!=event.data.id){if(getSelectedIndex(gallery.galleryID)>event.data.id){setDirection("left");}else{setDirection("right");}
setSelectedIndex(gallery.galleryID,event.data.id);showGalleryItem(gallery.galleryID);$(".gallery"+gallery.galleryID+" .gallery_view_all_container").fadeOut(500);$(".gallery"+gallery.galleryID+" .gallery_nav_container").fadeIn(500);$(".gallery"+gallery.galleryID+" .arrow_container").fadeIn(500);}else{$(".gallery"+gallery.galleryID+" .gallery_view_all_container").fadeOut(500);$(".gallery"+gallery.galleryID+" .gallery_nav_container").fadeIn(500);$(".gallery"+gallery.galleryID+" .arrow_container").fadeIn(500);}}});$(".gallery_"+gallery.galleryID+"_grid_thumb"+i).mouseover(function(){$(this).css('cursor','pointer');});$(".gallery_"+gallery.galleryID+"_grid_thumb"+i+" img").mouseover(function(){$(this).addClass("hover");});$(".gallery_"+gallery.galleryID+"_grid_thumb"+i+" img").mouseout(function(){$(this).removeClass("hover");});}}else if(gallery.galleryCatalogTypeName=="video"){for(var i=0;i<gallery.catalog.mediaCollection.length;i++){var video=new VideoData($(gallery.catalog.mediaCollection[i]));var thumbImagePath=gallery.gallerySettings.liveSiteUrl+gallery.gallerySettings.galleryAssetPath+gallery.galleryTypeData.thumbFormat.formatDirectory+'/'+video.coverImageData.imageFileName;var thumb_grid=$(".gallery"+gallery.galleryID+"."+gallery.galleryTypeData.galleryTypeName+" .thumb_grid");thumb_grid.append('<div class="gallery_'+gallery.galleryID+'_grid_thumb'+i+' grid_thumb"><img class="gallery_'+gallery.galleryID+'_grid_thumb_image_'+i+' thumb_image" width="'+gallery.galleryTypeData.thumbFormat.formatWidth+'" height="'+gallery.galleryTypeData.thumbFormat.formatHeight+'" border="0" alt="'+video.videoTitle+'" src="'+thumbImagePath+'" /></div>');$(".gallery_"+gallery.galleryID+"_grid_thumb"+i).bind('click',{id:i,gallerydata:gallery,imagedata:image},function(event){if(getGalleryState(gallery.galleryID)!="busy"){if(getSelectedIndex(gallery.galleryID)!=event.data.id){if(getSelectedIndex(gallery.galleryID)>event.data.id){setDirection("left");}else{setDirection("right");}
setSelectedIndex(gallery.galleryID,event.data.id);showGalleryItem(gallery.galleryID);$(".gallery"+gallery.galleryID+" .gallery_view_all_container").fadeOut(500);$(".gallery"+gallery.galleryID+" .gallery_nav_container").fadeIn(500);$(".gallery"+gallery.galleryID+" .arrow_container").fadeIn(500);}else{$(".gallery"+gallery.galleryID+" .gallery_view_all_container").fadeOut(500);$(".gallery"+gallery.galleryID+" .gallery_nav_container").fadeIn(500);$(".gallery"+gallery.galleryID+" .arrow_container").fadeIn(500);}}});$(".gallery_"+gallery.galleryID+"_grid_thumb"+i).mouseover(function(){$(this).css('cursor','pointer');});}}
setViewAllGridPage(gallery);}catch(setupViewAllThumbsException){logException("setupViewAllThumbs",setupViewAllThumbsException);}}
function setViewAllGridPage(gallery){try{if(gallery.galleryGridOptions.totalPages==1){$(".gallery"+gallery.galleryID+" .view_all_left_arrow").addClass("disable");$(".gallery"+gallery.galleryID+" .view_all_right_arrow").addClass("disable");}else{if(gallery.galleryGridOptions.currentPage==1){$(".gallery"+gallery.galleryID+" .view_all_left_arrow").addClass("disable");$(".gallery"+gallery.galleryID+" .view_all_right_arrow").removeClass("disable");}else if(gallery.galleryGridOptions.currentPage==gallery.galleryGridOptions.totalPages){$(".gallery"+gallery.galleryID+" .view_all_left_arrow").removeClass("disable");$(".gallery"+gallery.galleryID+" .view_all_right_arrow").addClass("disable");}else{$(".gallery"+gallery.galleryID+" .view_all_left_arrow").removeClass("disable");$(".gallery"+gallery.galleryID+" .view_all_right_arrow").removeClass("disable");}}
var itemCountHigh=1;var itemCountLow=1;if(gallery.galleryGridOptions.thumbsPerPage<gallery.catalog.mediaCollection.length){itemCountHigh=gallery.galleryGridOptions.currentPage*gallery.galleryGridOptions.thumbsPerPage;itemCountLow=itemCountHigh-(gallery.galleryGridOptions.thumbsPerPage-1);}else{itemCountHigh=gallery.galleryGridOptions.currentPage*gallery.catalog.mediaCollection.length;itemCountLow=itemCountHigh-(gallery.catalog.mediaCollection.length-1);}
if(itemCountHigh>gallery.catalog.mediaCollection.length){itemCountHigh=gallery.catalog.mediaCollection.length;}
$(".gallery"+gallery.galleryID+" .view_all_paging").text("Viewing "+itemCountLow+"-"+itemCountHigh+" of "+gallery.catalog.mediaCollection.length);var thumb_grid=$(".gallery"+gallery.galleryID+"."+gallery.galleryTypeData.galleryTypeName+" .thumb_grid");var grid_offset=((gallery.galleryGridOptions.currentPage-1)*$(".gallery"+gallery.galleryID+" .view_all_bottom_container").height())*-1;thumb_grid.fadeOut(350,function(){$(this).css("margin-top",grid_offset);$(this).fadeIn(350);});setGalleryState(gallery.galleryID,"ready");}catch(setViewAllGridPageException){logException("setViewAllGridPage",setViewAllGridPageException);}}
function getMaxThumbCount(totalWidth,thumbWidth){var thumbCount=0;thumbCount=Math.floor(totalWidth/thumbWidth);return thumbCount;}
function setupArrows(gallery){try{$(".gallery"+gallery.galleryID+" .left_arrow").mouseover(function(){$(this).addClass("hover");});$(".gallery"+gallery.galleryID+" .left_arrow").mouseout(function(){$(this).removeClass("hover");});$(".gallery"+gallery.galleryID+" .left_arrow").click(function(){if(getGalleryState(gallery.galleryID)!="busy"){removeAutoCycle(gallery);var currIndex=$.data(document.body,"gallery"+gallery.galleryID).gallerydata.selectedIndex;if((currIndex-1)>=0){$.data(document.body,"gallery"+gallery.galleryID).gallerydata.selectedIndex--;}else{$.data(document.body,"gallery"+gallery.galleryID).gallerydata.selectedIndex=$.data(document.body,"gallery"+gallery.galleryID).gallerydata.gallerySize-1;}
setDirection("left");showGalleryItem(gallery.galleryID);}});$(".gallery"+gallery.galleryID+" .right_arrow").mouseover(function(){$(this).addClass("hover");});$(".gallery"+gallery.galleryID+" .right_arrow").mouseout(function(){$(this).removeClass("hover");});$(".gallery"+gallery.galleryID+" .right_arrow").click(function(){if(getGalleryState(gallery.galleryID)!="busy"){removeAutoCycle(gallery);var currIndex=$.data(document.body,"gallery"+gallery.galleryID).gallerydata.selectedIndex;if($.data(document.body,"gallery"+gallery.galleryID).gallerydata.gallerySize>(currIndex+1)){$.data(document.body,"gallery"+gallery.galleryID).gallerydata.selectedIndex++;}else{$.data(document.body,"gallery"+gallery.galleryID).gallerydata.selectedIndex=0;}
setDirection("right");showGalleryItem(gallery.galleryID);}});}catch(setupArrowsException){logException("setupArrows",setupArrowsException);}}
function setupKeyboard(gallery){try{$(".gallery"+gallery.galleryID).bind('click',function(clickEvt){$(this).focus();});$(".gallery"+gallery.galleryID).bind('keyup',function(evt){if(evt.keyCode==39){if(getGalleryState(gallery.galleryID)!="busy"){removeAutoCycle(gallery);var currIndex=$.data(document.body,"gallery"+gallery.galleryID).gallerydata.selectedIndex;if($.data(document.body,"gallery"+gallery.galleryID).gallerydata.gallerySize>(currIndex+1)){$.data(document.body,"gallery"+gallery.galleryID).gallerydata.selectedIndex++;}else{$.data(document.body,"gallery"+gallery.galleryID).gallerydata.selectedIndex=0;}
setDirection("right");showGalleryItem(gallery.galleryID);}}else if(evt.keyCode==37){if(getGalleryState(gallery.galleryID)!="busy"){removeAutoCycle(gallery);var currIndex=$.data(document.body,"gallery"+gallery.galleryID).gallerydata.selectedIndex;if((currIndex-1)>=0){$.data(document.body,"gallery"+gallery.galleryID).gallerydata.selectedIndex--;}else{$.data(document.body,"gallery"+gallery.galleryID).gallerydata.selectedIndex=$.data(document.body,"gallery"+gallery.galleryID).gallerydata.gallerySize-1;}
setDirection("left");showGalleryItem(gallery.galleryID);}}
logMessage("setupKeyboardEvents","evt.keyCode: "+evt.keyCode+" | "+gallery.galleryID);});}catch(setupKeyboardException){logException("setupKeyboardEvents",setupKeyboardException);}}
function updateThumbScroller(gallery){try{var paging=getPagingData(gallery.galleryID);var selectedIndex=getSelectedIndex(gallery.galleryID);var page=Math.ceil((selectedIndex+1)/paging.thumbsPerPage);var scrollAmount=$('.gallery'+gallery.galleryID+' div.thumb_container').width();paging.currentPage=page;setPagingData(gallery.galleryID,paging);if(page==1){scrollAmount=0;}
else{scrollAmount=((page-1)*scrollAmount)*-1;}
$(".gallery"+gallery.galleryID+" .thumb_scroller").animate({"left":scrollAmount+"px"},500,function(){managePageButtons(gallery)});}catch(updateThumbScrollerException){logException("updateThumbScroller",updateThumbScrollerException);}}
function updatePagination(gallery){try{$(".gallery"+gallery.galleryID+" .thumb_right_arrow").click(function(){var paging=getPagingData(gallery.galleryID);paging.currentPage=paging.currentPage+1;setPagingData(gallery.galleryID,paging);var scrollAmount=$('.gallery'+gallery.galleryID+' div.thumb_container').width();$(".gallery"+gallery.galleryID+" .thumb_scroller").animate({"left":"-="+scrollAmount+"px"},500,function(){managePageButtons(gallery)});});$(".gallery"+gallery.galleryID+" .thumb_left_arrow").click(function(){var paging=getPagingData(gallery.galleryID);paging.currentPage=paging.currentPage-1;setPagingData(gallery.galleryID,paging);var scrollAmount=$('.gallery'+gallery.galleryID+' div.thumb_container').width();$(".gallery"+gallery.galleryID+" .thumb_scroller").animate({"left":"+="+scrollAmount+"px"},500,function(){managePageButtons(gallery)});});}catch(updatePaginationException){logException("updatePagination",updatePaginationException);}}
function updateThumbContainerSize(gallery){try{var gallery=getGalleryData(gallery.galleryID);var paging=getPagingData(gallery.galleryID);var gallery_nav_container=$('.gallery'+gallery.galleryID+' div.gallery_nav_container');var thumb_container=$('.gallery'+gallery.galleryID+' div.thumb_container');var thumb_scroller=$('.gallery'+gallery.galleryID+' div.thumb_container div.thumb_scroller');var availableWidthForThumbTrack=gallery_nav_container.width()-paging.navReservedWidth;if($(".gallery"+gallery.galleryID).hasClass("fullscreen")){availableWidthForThumbTrack=$("body").width()-paging.navReservedWidth;}
var thumbsPerPage=Math.floor(availableWidthForThumbTrack/paging.thumbWidth);var tempThumbTotalWidth=thumbsPerPage*paging.thumbWidth;var tempThumbGapTotalWidth=tempThumbTotalWidth+(thumbsPerPage*paging.thumbGap);if(tempThumbGapTotalWidth-paging.thumbGap>availableWidthForThumbTrack){thumbsPerPage=thumbsPerPage-1;tempThumbTotalWidth=thumbsPerPage*paging.thumbWidth;tempThumbGapTotalWidth=tempThumbTotalWidth+((thumbsPerPage)*paging.thumbGap);}
paging.currentPage=1;paging.thumbsPerPage=thumbsPerPage;paging.totalPages=Math.ceil(gallery.catalog.mediaCount/paging.thumbsPerPage);setPagingData(gallery.galleryID,paging);thumb_container.width(tempThumbGapTotalWidth);updateThumbScroller(gallery);}catch(updateThumbContainerSizeException){logException("updateThumbContainerSize",updateThumbContainerSizeException);}}
function updateMediaContainerSize(id){try{var gallery=getGalleryData(id);if(gallery.galleryCatalogTypeName=="video"){var media_holder=$('.gallery'+id+' div.media_holder');var play_button=$('.gallery'+id+' div.video_play_overlay');var left_position=Math.floor((media_holder.width()/2)-(play_button.width()/2));var top_position=Math.floor((media_holder.height()/2)-(play_button.height()/2));play_button.scrollLeft(left_position);play_button.scrollTop(top_position);}}catch(updateMediaContainerSizeException){logException("updateMediaContainerSize",updateMediaContainerSizeException);}}
function managePageButtons(gallery){try{var pagingObj=getPagingData(gallery.galleryID);if(pagingObj.currentPage<pagingObj.totalPages){$(".gallery"+gallery.galleryID+" .thumb_right_arrow").show();}else{$(".gallery"+gallery.galleryID+" .thumb_right_arrow").hide();}
if(pagingObj.currentPage!=1){$(".gallery"+gallery.galleryID+" .thumb_left_arrow").show();}else{$(".gallery"+gallery.galleryID+" .thumb_left_arrow").hide();}}catch(managePageButtonsException){logException("managePageButtons",managePageButtonsException);}}
function setDirection(dir){if(dir=="left"){direction=-1;}else{direction=1;}}
function showGalleryItem(galleryID){try{var currentItemCount=$.data(document.body,"gallery"+galleryID).currentitemcount++;var currentStatus=getGalleryState(galleryID);if(currentStatus!="busy"){setGalleryState(galleryID,"busy");var gallerydata=getGalleryData(galleryID);$('.gallery_'+galleryID+'_cover').show();$(".gallery"+galleryID+" div.arrow_container").show();if(gallerydata.galleryOptions.useNav==1){updateThumbScroller(gallerydata);}
if(gallerydata.selectedIndex==0){$(".gallery"+galleryID+" .left_arrow").hide();}else{$(".gallery"+galleryID+" .left_arrow").show();}
if(gallerydata.selectedIndex==(gallerydata.catalog.mediaCollection.length-1)){$(".gallery"+galleryID+" .right_arrow").hide();}else{$(".gallery"+galleryID+" .right_arrow").show();}
if(gallerydata.galleryCatalogTypeName=="image"){var imagedata=new ImageData($(gallerydata.catalog.mediaCollection[gallerydata.selectedIndex]));var itemImagePath=gallerydata.gallerySettings.liveSiteUrl+gallerydata.gallerySettings.galleryAssetPath+gallerydata.galleryTypeData.enlargeFormat.formatDirectory+'/'+imagedata.imageFileName;var itemImageWidth=gallerydata.galleryTypeData.enlargeFormat.formatWidth;var itemImageHeight=gallerydata.galleryTypeData.enlargeFormat.formatHeight;if($(".gallery"+galleryID).hasClass("fullscreen")){itemImagePath=gallerydata.gallerySettings.liveSiteUrl+gallerydata.gallerySettings.galleryAssetPath+gallerydata.galleryTypeData.fullscreenFormat.formatDirectory+'/'+imagedata.imageFileName;itemImageWidth=gallerydata.galleryTypeData.fullscreenFormat.formatWidth;itemImageHeight=gallerydata.galleryTypeData.fullscreenFormat.formatHeight;}
var downloadImagePath=gallerydata.gallerySettings.liveSiteUrl+gallerydata.gallerySettings.galleryAssetPath+gallerydata.galleryTypeData.downloadLargeFormat.formatDirectory+'/'+imagedata.imageFileName;setDownloadImagePath(gallerydata.galleryID,downloadImagePath);if(imagedata.preventDownload==1){$("div.gallery"+gallerydata.galleryID+" .nav_download").addClass("disable");}else{$("div.gallery"+gallerydata.galleryID+" .nav_download").removeClass("disable");}
var item_container=$("div.gallery"+gallerydata.galleryID+" .item_container");var galleryImageContainerDivID="gallery_"+gallerydata.galleryID+"_image_"+currentItemCount;var galleryImageID="gallery_"+gallerydata.galleryID+"_enlarge_image_"+currentItemCount;item_container.append('<div class="'+galleryImageContainerDivID+' media_holder loading noselect" data-id="'+currentItemCount+'" style="left:'+(item_container.width()*direction)+'px;"><img class="'+galleryImageID+' media_img noselect" width="'+itemImageWidth+'" height="'+itemImageHeight+'" border="0" alt="'+imagedata.imageTitle+'" /></div>');if(gallerydata.gallerySize>1){var image_container=$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount);image_container.gallerySlider(gallerydata.galleryID,image_container,swipeGallery);}
$(".gallery"+gallerydata.galleryID+" .gallery_item_title").html(imagedata.imageTitle);$(".gallery"+gallerydata.galleryID+" .gallery_item_description").html(imagedata.imageDescription);$(".gallery"+gallerydata.galleryID+" .gallery_item_count").html((getSelectedIndex(gallerydata.galleryID)+1)+" / "+gallerydata.catalog.mediaCollection.length);$(".gallery_"+gallerydata.galleryID+"_enlarge_image_"+currentItemCount).attr("src",itemImagePath).load(function(){$(".media_holder.loading").removeClass("loading");$('.gallery_'+gallerydata.galleryID+'_cover').hide();if($(".gallery_"+gallerydata.galleryID+"_image_"+(currentItemCount-1)).length){$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount).css("left",item_container.width()*direction);if(direction==1){$(".gallery_"+gallerydata.galleryID+"_image_"+(currentItemCount-1)).animate({"left":"-="+item_container.width()+"px"},500,function(){$(this).remove();setGalleryState(gallerydata.galleryID,"ready");$('.gallery_'+gallerydata.galleryID+'_cover').hide();});$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount).animate({"left":"-="+item_container.width()+"px"},500);}else{$(".gallery_"+gallerydata.galleryID+"_image_"+(currentItemCount-1)).animate({"left":"+="+item_container.width()+"px"},500,function(){$(this).remove();setGalleryState(gallerydata.galleryID,"ready");$('.gallery_'+gallerydata.galleryID+'_cover').hide();});$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount).animate({"left":"+="+item_container.width()+"px"},500);}}else{$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount).css("left","0").css("opacity",".5");$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount).animate({"opacity":"1"},500,function(){setGalleryState(gallerydata.galleryID,"ready");$('.gallery_'+gallerydata.galleryID+'_cover').hide();});}});}
else if(gallerydata.galleryCatalogTypeName=="video"){var videodata=new VideoData($(gallerydata.catalog.mediaCollection[gallerydata.selectedIndex]));var itemImagePath=gallerydata.gallerySettings.liveSiteUrl+gallerydata.gallerySettings.galleryAssetPath+gallerydata.galleryTypeData.enlargeFormat.formatDirectory+'/'+videodata.coverImageData.imageFileName;if($(".gallery"+galleryID).hasClass("fullscreen")){itemImagePath=gallerydata.gallerySettings.liveSiteUrl+gallerydata.gallerySettings.galleryAssetPath+gallerydata.galleryTypeData.fullscreenFormat.formatDirectory+'/'+videodata.coverImageData.imageFileName;}
var itemVideoPath;if(gallerydata.gallerySettings.useStreaming==1){itemVideoPath=gallerydata.gallerySettings.streamHttpUrl+gallerydata.galleryTypeData.videoFormat.formatDirectory+'/'+videodata.videoFlvName.replace(".flv",".mp4");}
else{itemVideoPath=gallerydata.gallerySettings.liveSiteUrl+gallerydata.gallerySettings.galleryAssetPath+gallerydata.galleryTypeData.videoFormat.formatDirectory+'/'+videodata.videoFlvName.replace(".flv",".mp4");}
var item_container=$(".gallery"+gallerydata.galleryID+" .item_container");item_container.append('<div class="gallery_'+gallerydata.galleryID+'_image_'+currentItemCount+' media_holder loading" data-id="'+currentItemCount+'" style="left:'+(item_container.width()*direction)+'px;"><img class="gallery_'+gallerydata.galleryID+'_enlarge_image_'+currentItemCount+' media_img" width="'+gallerydata.galleryTypeData.enlargeFormat.formatWidth+'" height="'+gallerydata.galleryTypeData.enlargeFormat.formatHeight+'" border="0" alt="'+videodata.videoTitle+'" /><div class="video_container"></div><div class="video_play_overlay"></div></div>');if(gallerydata.gallerySize>1){var image_container=$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount);image_container.gallerySlider(gallerydata.galleryID,image_container,swipeGallery);}
$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount+" div.video_container").hide();$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount+" div.video_play_overlay").mouseover(function(){$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount+" div.video_play_overlay").addClass("hover");});$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount+" div.video_play_overlay").mouseout(function(){$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount+" div.video_play_overlay").removeClass("hover");});$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount+" .video_play_overlay").click(function(){removeAutoCycle(gallerydata);setAllowGallerySlider(gallerydata.galleryID,false);var video_container=$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount+" div.video_container");if(video_container.is(":visible")){var video=document.getElementById("video_"+getActiveVideoID(gallerydata.galleryID));video.play();}
else{var ua=navigator.userAgent.toLowerCase();var isAndroid=ua.indexOf("android")>-1;if(window.Touch||isAndroid||'ontouchstart'in document.documentElement){var videodata=new VideoData($(gallerydata.catalog.mediaCollection[gallerydata.selectedIndex]));var itemVideoPath;if(gallerydata.gallerySettings.useStreaming==1){itemVideoPath=gallerydata.gallerySettings.streamHttpUrl+gallerydata.galleryTypeData.videoFormat.formatDirectory+'/'+videodata.videoFlvName.replace(".flv",".mp4");}
else{itemVideoPath=gallerydata.gallerySettings.liveSiteUrl+gallerydata.gallerySettings.galleryAssetPath+gallerydata.galleryTypeData.videoFormat.formatDirectory+'/'+videodata.videoFlvName.replace(".flv",".mp4");}
window.open(itemVideoPath,'_self');}
else{var videodata=new VideoData($(gallerydata.catalog.mediaCollection[gallerydata.selectedIndex]));var itemVideoPath;var mp4VideoPath;var webmVideoPath;if(gallerydata.gallerySettings.useStreaming==1){mp4VideoPath=gallerydata.gallerySettings.streamHttpUrl+gallerydata.galleryTypeData.videoFormat.formatDirectory+'/'+videodata.videoFlvName.replace(".flv",".mp4");webmVideoPath=mp4VideoPath.replace(".mp4",".webm");}
else{mp4VideoPath=gallerydata.gallerySettings.liveSiteUrl+gallerydata.gallerySettings.galleryAssetPath+gallerydata.galleryTypeData.videoFormat.formatDirectory+'/'+videodata.videoFlvName.replace(".flv",".mp4");webmVideoPath=mp4VideoPath.replace(".mp4",".webm");}
video_container.html('<video id="video_'+videodata.videoID+'" poster="'+itemImagePath+'" controls="controls" autoplay="autoplay" preload="true" webkit-playsinline="no"><source src="'+mp4VideoPath+'" type="video/mp4" /><source src="'+webmVideoPath+'" type="video/webm" /></video>');setActiveVideoID(gallerydata.galleryID,videodata.videoID);$("#video_"+videodata.videoID).bind('pause',function(){$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount+" .video_play_overlay").show();});$("#video_"+videodata.videoID).bind('play',function(){$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount+" .video_play_overlay").hide();if(getGalleryNavState(gallerydata.galleryID)=='open'||getGalleryNavState(gallerydata.galleryID)=='opening'){setGalleryNavState(gallerydata.galleryID,'closing');$(".gallery"+gallerydata.galleryID+" .gallery_nav").fadeOut(400,function(){setGalleryNavState(gallerydata.galleryID,'closed');});$(".gallery"+gallerydata.galleryID+" .gallery_nav_collapse").fadeIn(400);}});$("#video_"+videodata.videoID).bind('ended',function(){$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount+" div.video_container").hide();$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount+" .video_play_overlay").show();$(".gallery"+gallerydata.galleryID+" div.arrow_container").show();$(".gallery"+gallerydata.galleryID+" > div.gallery_footer").show();});video_container.show();$(this).hide();$(".gallery"+gallerydata.galleryID+" div.arrow_container").hide();if($(".gallery"+gallerydata.galleryID).hasClass("fullscreen")){$(".gallery"+gallerydata.galleryID+" > div.gallery_footer").hide();}}}});$(".gallery"+gallerydata.galleryID+" .gallery_item_title").text(videodata.videoTitle);$(".gallery"+gallerydata.galleryID+" .gallery_item_description").text(videodata.videoDescription);$(".gallery"+gallerydata.galleryID+" .gallery_item_count").text((getSelectedIndex(gallerydata.galleryID)+1)+" / "+gallerydata.catalog.mediaCollection.length);$(".gallery_"+gallerydata.galleryID+"_enlarge_image_"+currentItemCount).attr("src",itemImagePath).load(function(){$(".media_holder.loading").removeClass("loading");$('.gallery_'+gallerydata.galleryID+'_cover').hide();if($(".gallery_"+gallerydata.galleryID+"_image_"+(currentItemCount-1)).length){$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount).css("left",item_container.width()*direction);if(direction==1){$(".gallery_"+gallerydata.galleryID+"_image_"+(currentItemCount-1)).animate({"left":"-="+item_container.width()+"px"},500,function(){$(this).remove();setGalleryState(gallerydata.galleryID,"ready");$('.gallery_'+gallerydata.galleryID+'_cover').hide();});$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount).animate({"left":"-="+item_container.width()+"px"},500);}else{$(".gallery_"+gallerydata.galleryID+"_image_"+(currentItemCount-1)).animate({"left":"+="+item_container.width()+"px"},500,function(){$(this).remove();setGalleryState(gallerydata.galleryID,"ready");$('.gallery_'+gallerydata.galleryID+'_cover').hide();});$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount).animate({"left":"+="+item_container.width()+"px"},500);}}else{$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount).css("left","0").css("opacity",".5");$(".gallery_"+gallerydata.galleryID+"_image_"+currentItemCount).animate({"opacity":"1"},500,function(){setGalleryState(gallerydata.galleryID,"ready");$('.gallery_'+gallerydata.galleryID+'_cover').hide();});}});}
setAllowGallerySlider(gallerydata.galleryID,true);$(".gallery"+gallerydata.galleryID+" .thumb").removeClass("selected");$(".gallery"+gallerydata.galleryID+" .thumb_image").removeClass("selected");$(".gallery_"+gallerydata.galleryID+"_thumb"+gallerydata.selectedIndex).addClass("selected");$(".gallery_"+gallerydata.galleryID+"_thumb_image_"+gallerydata.selectedIndex).addClass("selected");$(".gallery_"+gallerydata.galleryID+"_grid_thumb_image_"+gallerydata.selectedIndex).addClass("selected");$(".gallery"+gallerydata.galleryID+" > div.gallery_footer").show();if($(".gallery"+gallerydata.galleryID).hasClass("fullscreen")){fullscreenResize();}}}
catch(showGalleryItemException){logException("showGalleryItem",showGalleryItemException);}}
function videoFullScreen(gallery){var vid=$("#video_"+videodata.videoID);if(vid.webkitSupportsFullscreen){vid.webkitEnterFullscreen();}}
function getGalleryData(id){return $.data(document.body,"gallery"+id).gallerydata;}
function setPagingData(id,paging){$.data(document.body,"gallery"+id).gallerypaging=paging;}
function getPagingData(id){return $.data(document.body,"gallery"+id).gallerypaging;}
function setGalleryState(id,status){$.data(document.body,"gallery"+id).status=status;if(status=="busy"){$('gallery_'+id+'_cover').css("display","inherit");}else if(status=="ready"){}}
function getGalleryState(id){return $.data(document.body,"gallery"+id).status;}
function setGalleryNavState(id,status){$.data(document.body,"gallery"+id).nav_status=status;}
function getGalleryNavState(id){return $.data(document.body,"gallery"+id).nav_status;}
function setGalleryNavCloseTimeout(id,timeout){$.data(document.body,"gallery"+id).nav_close_timeout=timeout;}
function getGalleryNavCloseTimeout(id){return $.data(document.body,"gallery"+id).nav_close_timeout;}
function setGalleryAutoCycleInterval(id,interval){$.data(document.body,"gallery"+id).auto_cycle_interval=interval;}
function getGalleryAutoCycleInterval(id){return $.data(document.body,"gallery"+id).auto_cycle_interval;}
function setSelectedIndex(id,index){$.data(document.body,"gallery"+id).gallerydata.selectedIndex=index;}
function getSelectedIndex(id){return $.data(document.body,"gallery"+id).gallerydata.selectedIndex;}
function setScrollPosition(id,y){$.data(document.body,"gallery"+id).scrollPosition=y;}
function getScrollPosition(id){return $.data(document.body,"gallery"+id).scrollPosition;}
function setActiveVideoID(id,videoID){$.data(document.body,"gallery"+id).videoID=videoID;}
function getActiveVideoID(id){return $.data(document.body,"gallery"+id).videoID;}
function setDownloadImagePath(id,path){$.data(document.body,"gallery"+id).downloadPath=path;}
function getDownloadImagePath(id){return $.data(document.body,"gallery"+id).downloadPath;}
function setAllowGallerySlider(id,status){$.data(document.body,"gallery"+id).slider_status=status;}
function getAllowGallerySlider(id){return $.data(document.body,"gallery"+id).slider_status;}
function swipeThumbContainer(gallerySliderOptions){try{var gallery=getGalleryData(gallerySliderOptions.galleryID);switch(gallerySliderOptions.swipeDirection){case'right':removeAutoCycle(gallery);var paging=getPagingData(gallery.galleryID);if(paging.currentPage>1){paging.currentPage=paging.currentPage-1;setPagingData(gallery.galleryID,paging);var scrollAmount=$('.gallery'+gallery.galleryID+' div.thumb_container').width();$(".gallery"+gallery.galleryID+" .thumb_scroller").animate({"left":"+="+scrollAmount+"px"},500,function(){managePageButtons(gallery)});}
break;case'left':removeAutoCycle(gallery);var paging=getPagingData(gallery.galleryID);if(paging.currentPage<paging.totalPages){paging.currentPage=paging.currentPage+1;setPagingData(gallery.galleryID,paging);var scrollAmount=$('.gallery'+gallery.galleryID+' div.thumb_container').width();$(".gallery"+gallery.galleryID+" .thumb_scroller").animate({"left":"-="+scrollAmount+"px"},500,function(){managePageButtons(gallery)});}
break;}}catch(swipeThumbContainerException){logException("swipeThumbContainer",swipeThumbContainerException);}}
function swipeGallery(gallerySliderOptions){try{var gallery=getGalleryData(gallerySliderOptions.galleryID);switch(gallerySliderOptions.swipeDirection){case'right':if(getGalleryState(gallery.galleryID)!="busy"){removeAutoCycle(gallery);var currIndex=$.data(document.body,"gallery"+gallery.galleryID).gallerydata.selectedIndex;if((currIndex-1)>=0){$.data(document.body,"gallery"+gallery.galleryID).gallerydata.selectedIndex--;setDirection("left");showGalleryItem(gallery.galleryID);}}
break;case'left':if(getGalleryState(gallery.galleryID)!="busy"){removeAutoCycle(gallery);var currIndex=$.data(document.body,"gallery"+gallery.galleryID).gallerydata.selectedIndex;if($.data(document.body,"gallery"+gallery.galleryID).gallerydata.gallerySize>(currIndex+1)){$.data(document.body,"gallery"+gallery.galleryID).gallerydata.selectedIndex++;setDirection("right");showGalleryItem(gallery.galleryID);}}
break;}}catch(swipeGalleryException){logException("swipeGallery",swipeGalleryException);}}
function setupThumbs(gallery){try{var thumb_container=$(".gallery"+gallery.galleryID+"."+gallery.galleryTypeData.galleryTypeName+" .thumb_container");thumb_container.html("");var thumb_container_id="gallery_"+gallery.galleryID+"_thumb_container";thumb_container.gallerySlider(gallery.galleryID,thumb_container,swipeThumbContainer);if(gallery.galleryCatalogTypeName=="image"){thumb_container.append('<div class="gallery_'+gallery.galleryID+'_scroller thumb_scroller"></div>');for(var i=0;i<gallery.catalog.mediaCollection.length;i++){var image=new ImageData($(gallery.catalog.mediaCollection[i]));var thumbImagePath=gallery.gallerySettings.liveSiteUrl+gallery.gallerySettings.galleryAssetPath+gallery.galleryTypeData.thumbFormat.formatDirectory+'/'+image.imageFileName;var thumb_scroller=$(".gallery"+gallery.galleryID+"."+gallery.galleryTypeData.galleryTypeName+" .thumb_scroller");thumb_scroller.append('<div class="gallery_'+gallery.galleryID+'_thumb'+i+' thumb"><img class="gallery_'+gallery.galleryID+'_thumb_image_'+i+' thumb_image" width="'+gallery.galleryTypeData.thumbFormat.formatWidth+'" height="'+gallery.galleryTypeData.thumbFormat.formatHeight+'" border="0" alt="'+image.imageTitle+'" src="'+thumbImagePath+'" /></div>');$(".gallery_"+gallery.galleryID+"_thumb"+i).bind('click',{id:i,gallerydata:gallery,imagedata:image},function(event){if(getGalleryState(gallery.galleryID)!="busy"){if(getSelectedIndex(gallery.galleryID)!=event.data.id){if(getSelectedIndex(gallery.galleryID)>event.data.id){setDirection("left");}else{setDirection("right");}
removeAutoCycle(gallery);setSelectedIndex(gallery.galleryID,event.data.id);showGalleryItem(gallery.galleryID);}}});$(".gallery_"+gallery.galleryID+"_thumb"+i).mouseover(function(){$(this).css('cursor','pointer');});$(".gallery_"+gallery.galleryID+"_thumb"+i+" img").mouseover(function(){$(this).addClass("hover");});$(".gallery_"+gallery.galleryID+"_thumb"+i+" img").mouseout(function(){$(this).removeClass("hover");});}}
else if(gallery.galleryCatalogTypeName=="video"){thumb_container.append('<div class="thumb_scroller"></div>');for(var i=0;i<gallery.catalog.mediaCollection.length;i++){var video=new VideoData($(gallery.catalog.mediaCollection[i]));var thumbImagePath=gallery.gallerySettings.liveSiteUrl+gallery.gallerySettings.galleryAssetPath+gallery.galleryTypeData.thumbFormat.formatDirectory+'/'+video.coverImageData.imageFileName;$(".gallery"+gallery.galleryID+"."+gallery.galleryTypeData.galleryTypeName+" .thumb_scroller").append('<div class="gallery_'+gallery.galleryID+'_thumb'+i+' thumb"><img class="gallery_'+gallery.galleryID+'_thumb_image_'+i+' thumb_image" width="'+gallery.galleryTypeData.thumbFormat.formatWidth+'" height="'+gallery.galleryTypeData.thumbFormat.formatHeight+'" border="0" alt="'+video.videoTitle+'" src="'+thumbImagePath+'" /></div>');$(".gallery_"+gallery.galleryID+"_thumb"+i).bind('click',{id:i,gallerydata:gallery,videodata:video},function(event){if(getGalleryState(gallery.galleryID)!="busy"){if(getSelectedIndex(gallery.galleryID)!=event.data.id){if(getSelectedIndex(gallery.galleryID)>event.data.id){setDirection("left");}else{setDirection("right");}
removeAutoCycle(gallery);setSelectedIndex(gallery.galleryID,event.data.id);showGalleryItem(gallery.galleryID);}}});$(".gallery_"+gallery.galleryID+"_thumb"+i).mouseover(function(){$(this).css('cursor','pointer');});}}}catch(exception){}}
(function($){$.fn.gallerySlider=function(galleryID,sliderElement,targetFunction){try{if(this.length>1){this.each(function(){$(this).gallerySlider(sliderOptions)});return this;}
var gallerySliderOptions=new GallerySliderOptions();gallerySliderOptions.galleryID=galleryID;gallerySliderOptions.sliderID=sliderElement;gallerySliderOptions.handlerFunction=targetFunction;setAllowGallerySlider(galleryID,true);var ua=navigator.userAgent.toLowerCase();var isAndroid=ua.indexOf("android")>-1;if(window.Touch||isAndroid||'ontouchstart'in document.documentElement){$(this).bind('touchstart',{galleryid:galleryID,sliderid:sliderElement,sliderOptions:gallerySliderOptions},function(e){var orig=e.originalEvent;if(orig.touches.length==1){e.data.sliderOptions.fingerCount=orig.touches.length;e.data.sliderOptions.startX=orig.changedTouches[0].pageX;e.data.sliderOptions.startY=orig.changedTouches[0].pageY;}});$(this).bind('touchmove',{galleryid:galleryID,sliderid:sliderElement,sliderOptions:gallerySliderOptions},function(e){e.preventDefault();var orig=e.originalEvent;if(e.data.sliderOptions.fingerCount==1){e.data.sliderOptions.curX=orig.changedTouches[0].pageX;e.data.sliderOptions.curY=orig.changedTouches[0].pageY;if(isValidSwipe(e.data.sliderOptions)){e.data.sliderOptions=calculateAngle(e.data.sliderOptions);e.data.sliderOptions=determineSwipeDirection(e.data.sliderOptions);if(e.data.sliderOptions.handlerFunction!=null){e.data.sliderOptions.handlerFunction(e.data.sliderOptions);}
e.data.sliderOptions=resetSlider(e.data.sliderOptions);}else{}}});}
else{$(this).bind('mousedown',{galleryid:galleryID,sliderid:sliderElement,sliderOptions:gallerySliderOptions},function(event){if(getAllowGallerySlider(event.data.galleryid)){event.preventDefault();event.data.sliderOptions.startX=event.pageX;event.data.sliderOptions.startY=event.pageY;}});$(this).bind('mouseup',{galleryid:galleryID,sliderid:sliderElement,sliderOptions:gallerySliderOptions},function(event){if(getAllowGallerySlider(event.data.galleryid)){event.preventDefault();if(event.data.sliderOptions.curX!=0){if(isValidSwipe(event.data.sliderOptions)){event.data.sliderOptions=calculateAngle(event.data.sliderOptions);event.data.sliderOptions=determineSwipeDirection(event.data.sliderOptions);if(event.data.sliderOptions.handlerFunction!=null){event.data.sliderOptions.handlerFunction(event.data.sliderOptions);}
event.data.sliderOptions=resetSlider(event.data.sliderOptions);}else{event.data.sliderOptions=resetSlider(event.data.sliderOptions);}}else{event.data.sliderOptions=resetSlider(event.data.sliderOptions);}}});$(this).bind('mousemove',{galleryid:galleryID,sliderid:sliderElement,sliderOptions:gallerySliderOptions},function(event){if(getAllowGallerySlider(event.data.galleryid)){event.preventDefault();event.data.sliderOptions.curX=event.pageX;event.data.sliderOptions.curY=event.pageY;}});$(this).bind('mouseout',{galleryid:galleryID,sliderid:sliderElement,sliderOptions:gallerySliderOptions},function(event){if(getAllowGallerySlider(event.data.galleryid)){event.preventDefault();}});}
var intialize=function(){return this;};var resetSlider=function(sliderOptions){sliderOptions.fingerCount=0;sliderOptions.isMoving=false;sliderOptions.startX=0;sliderOptions.startY=0;sliderOptions.curX=0;sliderOptions.curY=0;sliderOptions.deltaX=0;sliderOptions.deltaY=0;sliderOptions.horzDiff=0;sliderOptions.vertDiff=0;sliderOptions.minLength=40;sliderOptions.swipeLength=0;sliderOptions.swipeAngle=0;sliderOptions.swipeDirection='right';return sliderOptions;}
var calculateAngle=function(sliderOptions){var X=sliderOptions.startX-sliderOptions.curX;var Y=sliderOptions.curY-sliderOptions.startY;var Z=Math.round(Math.sqrt(Math.pow(X,2)+Math.pow(Y,2)));var r=Math.atan2(Y,X);sliderOptions.swipeAngle=Math.round(r*180/Math.PI);if(sliderOptions.swipeAngle<0){sliderOptions.swipeAngle=360-Math.abs(sliderOptions.swipeAngle);}
return sliderOptions;}
var determineSwipeDirection=function(sliderOptions){var direction;if((sliderOptions.swipeAngle<=45)&&(sliderOptions.swipeAngle>=0)){direction='left';}else if((sliderOptions.swipeAngle<=360)&&(sliderOptions.swipeAngle>=315)){direction='left';}else if((sliderOptions.swipeAngle>=135)&&(sliderOptions.swipeAngle<=225)){direction='right';}else if((sliderOptions.swipeAngle>45)&&(sliderOptions.swipeAngle<135)){direction='down';}else{direction='up';}
sliderOptions.swipeDirection=direction;return sliderOptions;}
var isValidSwipe=function(sliderOptions){sliderOptions.swipeLength=Math.round(Math.sqrt(Math.pow(sliderOptions.curX-sliderOptions.startX,2)+Math.pow(sliderOptions.curY-sliderOptions.startY,2)));if(sliderOptions.swipeLength>=sliderOptions.minLength){return true;}else{return false;}}
return intialize();}catch(gallerySliderEx){logException("gallerySlider",gallerySliderEx);}}})(jQuery);function setupPagingObject(id){var gallery=getGalleryData(id);var paging=new GalleryPaging();paging.currentPage=1;paging.thumbsPerPage=3;paging.totalThumbs=gallery.catalog.mediaCount;paging.totalPages=Math.ceil(gallery.catalog.mediaCount/paging.thumbsPerPage);paging.thumbWidth=70;paging.thumbGap=4;paging.navReservedWidth=371;setPagingData(gallery.galleryID,paging);}
function MediaPlayer(xml){this.mediaPlayerID=$(xml).find("mediaPlayer > mediaPlayerID").text();this.mediaPlayerName=$(xml).find("mediaPlayer > mediaPlayerName").text();this.mediaPlayerDescription=$(xml).find("mediaPlayer > mediaPlayerDescription").text();this.mediaPlayerXmlPath=$(xml).find("mediaPlayer > mediaPlayerXmlPath").text();this.mediaPlayerTypeData=new MediaPlayerTypeData($(xml).find("mediaPlayer > mediaPlayerTypeData"));this.mediaPlayerColor=$(xml).find("mediaPlayer > mediaPlayerColor").text();this.autoPlay=$(xml).find("mediaPlayer > autoPlay").text();this.autoCycle=$(xml).find("mediaPlayer > autoCycle").text();this.autoCycleDelay=$(xml).find("mediaPlayer > autoCycleDelay").text();this.enableEmbed=$(xml).find("mediaPlayer > enableEmbed").text();this.enableSharing=$(xml).find("mediaPlayer > enableSharing").text();this.coverImageData=new ImageData($(xml).find("mediaPlayer > coverImageData"));this.mediaPlayerSettings=new MediaPlayerSettings($(xml).find("mediaPlayer > settings"));this.mediaDataCollection=new MediaDataCollection($(xml).find("mediaPlayer > medias"));this.mediaPlayerSize=0;this.selectedIndex=0;this.currentGalleryID='';this.previousGalleryID='';}
function MediaPlayerTypeData(xml){this.mediaPlayerTypeID=$(xml).find("mediaPlayerType > mediaPlayerTypeID").text();this.mediaPlayerTypeName=$(xml).find("mediaPlayerType > mediaPlayerTypeName").text();this.mediaPlayerTypeDisplay=$(xml).find("mediaPlayerType > mediaPlayerTypeDisplay").text();this.mediaPlayerTypePath=$(xml).find("mediaPlayerType > mediaPlayerTypePath").text();this.thumbFormat=new FormatData($(xml).find("mediaPlayerType > thumbFormat"));this.enlargeFormat=new FormatData($(xml).find("mediaPlayerType > enlargeFormat"));this.fullscreenFormat=new FormatData($(xml).find("mediaPlayerType > fullscreenFormat"));this.mediaPlayerTypeWidth=$(xml).find("mediaPlayerType > mediaPlayerTypeWidth").text();this.mediaPlayerTypeHeight=$(xml).find("mediaPlayerType > mediaPlayerTypeHeight").text();this.mediaPlayerTypeScript=$(xml).find("mediaPlayerType > mediaPlayerTypeScript").text();this.mediaPlayerTypeCss=$(xml).find("mediaPlayerType > mediaPlayerTypeCss").text();this.includeGalleries=$(xml).find("mediaPlayerType > includeGalleries").text();}
function MediaPlayerSettings(xml){this.galleryAssetPath=$(xml).find("galleryAssetPath").text();this.galleryElementsPath=$(xml).find("galleryElementsPath").text();this.mediaPlayerSwfPath=$(xml).find("mediaPlayerSwfPath").text();this.imageGallerySwfPath=$(xml).find("imageGallerySwfPath").text();this.videoGallerySwfPath=$(xml).find("videoGallerySwfPath").text();this.liveSiteUrl=$(xml).find("liveSiteUrl").text();this.useStreaming=$(xml).find("useStreaming").text();}
function MediaDataCollection(xml){var mediaArray=new Array();var galleryArray=new Array();var medias=$(xml).find("media");for(var i=0;i<medias.length;i++){var mediaData=new MediaData(medias[i]);mediaArray.push(mediaData);if(mediaData.mediaTypeName=="Gallery"){galleryArray.push(mediaData);}}
this.mediaCollection=mediaArray;this.galleryCollection=galleryArray;}
function MediaData(xml,onlyGallery){this.mediaTypeName=$(xml).find("mediaTypeName").text();this.mediaTitle=$(xml).find("mediaTitle").text();this.mediaDescription=$(xml).find("mediaDescription").text();this.mediaDataID=$(xml).find("mediaDataID").text();this.mediaTypePlusID=this.mediaTypeName+this.mediaDataID;if(this.mediaTypeName=="Gallery"){this.mediaData=$(xml).find("mediaData");this.gallery=new Gallery($(xml).find("mediaData"));}else if(this.mediaTypeName=="SWF"){this.mediaData=$(xml).find("mediaData > swf");this.swfData=new SwfData($(xml).find("mediaData"));}}
function Catalog(xml){this.catalogID=$(xml).find("catalogID").text();this.catalogTypeName=$(xml).find("catalogTypeName").text();this.catalogName=$(xml).find("catalogID").text();this.catalogDescription=$(xml).find("catalogID").text();this.catalogTag=$(xml).find("catalogID").text();var mediaArray=new Array();if(this.catalogTypeName=="video"){this.mediaCount=$(xml).find("media > video").size();$(xml).find("media > video").each(function(index,element){mediaArray.push(this);});}else{this.mediaCount=$(xml).find("media > image").size();$(xml).find("media > image").each(function(index,element){mediaArray.push(this);});}
this.mediaCollection=mediaArray;}
function Gallery(xml){this.galleryID=$(xml).find("gallery > galleryID").text();this.galleryName=$(xml).find("gallery > galleryName").text();this.galleryDescription=$(xml).find("gallery > galleryDescription").text();this.galleryXmlPath=$(xml).find("gallery > galleryXmlPath").text();this.galleryNavTitle=$(xml).find("gallery > galleryNavTitle").text();this.galleryTypeData=new GalleryTypeData($(xml).find("gallery > galleryTypeData"));this.galleryCatalogTypeName=$(xml).find("gallery > galleryCatalogTypeName").text();this.galleryColor=$(xml).find("gallery > galleryColor").text();this.autoPlay=$(xml).find("gallery > autoPlay").text();this.autoCycle=$(xml).find("gallery > autoCycle").text();this.autoCycleDelay=$(xml).find("gallery > autoCycleDelay").text();this.enableEmbed=$(xml).find("gallery > enableEmbed").text();this.enableSharing=$(xml).find("gallery > enableSharing").text();this.mediaCount=$(xml).find("gallery > mediaCount").text();this.coverImageData=new ImageData($(xml).find("gallery > coverImageData"));this.gallerySettings=new GallerySettings($(xml).find("gallery > settings"));this.galleryOptions=new GalleryOptions();this.galleryGridOptions=new GalleryGridOptions();this.gallerySize=0;this.selectedIndex=0;this.mpContainerClass="";if(this.galleryCatalogTypeName=="video"){this.gallerySize=$(xml).find("gallery > catalogs > catalog > media > video").size();}else{this.gallerySize=$(xml).find("gallery > catalogs > catalog > media > image").size();}
this.catalog=new Catalog($(xml).find("gallery > catalogs > catalog"));}
function GalleryTypeData(xml){this.galleryTypeID=$(xml).find("galleryType > galleryTypeID").text();this.galleryTypeName=$(xml).find("galleryType > galleryTypeName").text();this.galleryTypeDisplay=$(xml).find("galleryType > galleryTypeDisplay").text();this.galleryTypePath=$(xml).find("galleryType > galleryTypePath").text();this.thumbFormat=new FormatData($(xml).find("galleryType > thumbFormat"));this.enlargeFormat=new FormatData($(xml).find("galleryType > enlargeFormat"));this.fullscreenFormat=new FormatData($(xml).find("galleryType > fullscreenFormat"));this.videoFormat=new FormatData($(xml).find("galleryType > videoFormat"));this.downloadSmallFormat=new FormatData($(xml).find("galleryType > downloadSmallFormat"));this.downloadLargeFormat=new FormatData($(xml).find("galleryType > downloadLargeFormat"));this.galleryTypeWidth=$(xml).find("galleryType > galleryTypeWidth").text();this.galleryTypeHeight=$(xml).find("galleryType > galleryTypeHeight").text();this.galleryTypeOptions=$(xml).find("galleryType > galleryTypeOptions").text();this.galleryTypeOptionCollection=new GalleryTypeOptionCollection($(xml).find("galleryType > galleryTypeOptions").text());this.galleryTypeScript=$(xml).find("galleryType > galleryTypeScript").text();this.galleryTypeCss=$(xml).find("galleryType > galleryTypeCss").text();}
function GalleryTypeOptionCollection(options){var optionsArray=new Array();try{var optionPairs=options.split(",");for(var i=0;i<optionPairs.length;i++){var optionPair=optionPairs[i].split("=");if(optionPair.length==2){var galleryTypeOption=new GalleryTypeOption(optionPair[0],optionPair[1]);optionsArray.push(galleryTypeOption);}}}catch(exception){logException("GetGalleryTypeOptionsArray",exception)}
this.optionCollection=optionsArray;}
function GalleryTypeOption(param,value){this.param=param;this.value=value;}
function FormatData(xml){this.formatID=$(xml).find("format > formatID").text();this.formatName=$(xml).find("format > formatName").text();this.formatDirectory=$(xml).find("format > formatDirectory").text();this.formatHeight=$(xml).find("format > formatHeight").text();this.formatWidth=$(xml).find("format > formatWidth").text();}
function SwfData(xml){this.swfID=$(xml).find("swf > swfID").text();this.swfTitle=$(xml).find("swf > swfTitle").text();this.swfDescription=$(xml).find("swf > swfDescription").text();this.swfTags=$(xml).find("swf > swfTags").text();this.swfFileName=$(xml).find("swf > swfFileName").text();this.enlargeFormat=new FormatData($(xml).find("swf > enlargeFormat"));this.swfHeight=$(xml).find("swf > swfHeight").text();this.swfWidth=$(xml).find("swf > swfWidth").text();this.swfVars=$(xml).find("swf > swfVars").text();this.coverImageData=new ImageData($(xml).find("swf > coverImageData"));this.swfEmbedCss=$(xml).find("swf > swfEmbedCss").text();this.swfCoverImageEmbedCss=$(xml).find("swf > swfCoverImageEmbedCss").text();}
function ImageData(xml){this.imageID=$(xml).find("imageID").text();this.imageTitle=$(xml).find("imageTitle").text();this.imageDescription=$(xml).find("imageDescription").text();this.imageFileName=$(xml).find("imageFileName").text();this.imageTags=$(xml).find("imageTags").text();this.copyright=$(xml).find("copyright").text();this.license=$(xml).find("license").text();this.photographer=$(xml).find("photographer").text();this.copyrightDescription=$(xml).find("copyrightDescription").text();this.preventDownload=$(xml).find("preventDownload").text();}
function VideoData(xml){this.videoID=$(xml).find("videoID").text();this.videoTitle=$(xml).find("videoTitle").text();this.videoDescription=$(xml).find("videoDescription").text();this.videoFileName=$(xml).find("videoFileName").text();this.videoFlvName=$(xml).find("videoFlvName").text();this.videoTags=$(xml).find("videoTags").text();this.copyright=$(xml).find("copyright").text();this.license=$(xml).find("license").text();this.photographer=$(xml).find("photographer").text();this.copyrightDescription=$(xml).find("copyrightDescription").text();this.coverImageData=new ImageData($(xml).find("coverImageData"));}
function GallerySettings(xml){this.galleryAssetPath=$(xml).find("galleryAssetPath").text();this.galleryElementsPath=$(xml).find("galleryElementsPath").text();this.imageGallerySwfPath=$(xml).find("imageGallerySwfPath").text();this.videoGallerySwfPath=$(xml).find("videoGallerySwfPath").text();this.liveSiteUrl=$(xml).find("liveSiteUrl").text();this.useStreaming=$(xml).find("useStreaming").text();this.streamHttpUrl=$(xml).find("streamHttpUrl").text();}
function GalleryPaging(){this.thumbsPerPage=3;this.totalThumbs=10;this.currentPage=1;this.totalPages=4;this.thumbWidth=100;this.thumbGap=4;this.navReservedWidth=371;}
function GalleryOptions(){this.useNav=1;this.useArrows=1;this.defaultView="";this.useAutoCycle=0;this.transitionType="horizontal";}
function GalleryGridOptions(){this.defaultGridWidth=0;this.defaultGridHeight=0;this.fullGridWidth=0;this.fullGridHeight=0;this.gridThumbWidth=0;this.gridThumbHeight=0;this.thumbsPerRow=0;this.rowsPerPage=0;this.thumbsPerPage=0;this.currentPage=1;this.totalPages=1;}
function GallerySliderOptions(){this.galleryID;this.sliderID;this.fingerCount=0;this.isMoving=false;this.startX=0;this.startY=0;this.curX=0;this.curY=0;this.deltaX=0;this.deltaY=0;this.horzDiff=0;this.vertDiff=0;this.minLength=20;this.swipeLength=0;this.swipeAngle=0;this.swipeDirection='right';this.handlerFunction=null;}
(function(){try{var
fullScreenApi={supportsFullScreen:false,isFullScreen:function(){return false;},requestFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:'',prefix:'',fullScreenGallery:''},browserPrefixes='webkit moz o ms khtml'.split(' ');if(typeof document.cancelFullScreen!='undefined'){fullScreenApi.supportsFullScreen=true;}else{for(var i=0,il=browserPrefixes.length;i<il;i++){fullScreenApi.prefix=browserPrefixes[i];if(typeof document[fullScreenApi.prefix+'CancelFullScreen']!='undefined'){fullScreenApi.supportsFullScreen=true;break;}}}
if(fullScreenApi.supportsFullScreen){try{fullScreenApi.fullScreenEventName=fullScreenApi.prefix+'fullscreenchange';fullScreenApi.isFullScreen=function(){switch(this.prefix){case'':return document.fullScreen;case'webkit':return document.webkitIsFullScreen;default:return document[this.prefix+'FullScreen'];}}
fullScreenApi.requestFullScreen=function(el){$(".gallery"+fullScreenApi.fullScreenGallery.galleryID).addClass("fullscreen");updateThumbContainerSize(fullScreenApi.fullScreenGallery);updateMediaContainerSize(fullScreenApi.fullScreenGallery.galleryID);setupViewAllGrid(fullScreenApi.fullScreenGallery);return(this.prefix==='')?el.requestFullScreen():el[this.prefix+'RequestFullScreen']();}
fullScreenApi.cancelFullScreen=function(el){$(".gallery"+fullScreenApi.fullScreenGallery.galleryID).removeClass("fullscreen");updateThumbContainerSize(fullScreenApi.fullScreenGallery);updateMediaContainerSize(fullScreenApi.fullScreenGallery.galleryID);setupViewAllGrid(fullScreenApi.fullScreenGallery);var media_img=$(".gallery"+fullScreenApi.fullScreenGallery.galleryID+" > div.item_container > div.media_holder > img.media_img");media_img.removeAttr("style");$(".gallery"+fullScreenApi.fullScreenGallery.galleryID+" > div.gallery_footer").show();return(this.prefix==='')?document.cancelFullScreen():document[this.prefix+'CancelFullScreen']();}}
catch(fullScreenException){logException("fullScreenException",fullScreenException);}}
if(typeof jQuery!='undefined'){jQuery.fn.requestFullScreen=function(){return this.each(function(){var el=jQuery(this);if(fullScreenApi.supportsFullScreen){fullScreenApi.requestFullScreen(el);}});};}
window.addEventListener(fullScreenApi.fullScreenEventName,function(){if(window.fullScreenApi.supportsFullScreen&&window.fullScreenApi.isFullScreen()==false){var galleryElement=document.getElementById("gallery"+window.fullScreenApi.fullScreenGallery.galleryID);window.fullScreenApi.cancelFullScreen(galleryElement);}});window.fullScreenApi=fullScreenApi;}
catch(exception){logException("setupFullscreenApi",exception)}})();(function(a,b,c){function g(a,c){var d=b.createElement(a||"div"),e;for(e in c)d[e]=c[e];return d}function h(a){for(var b=1,c=arguments.length;b<c;b++)a.appendChild(arguments[b]);return a}function j(a,b,c,d){var g=["opacity",b,~~(a*100),c,d].join("-"),h=.01+c/d*100,j=Math.max(1-(1-a)/b*(100-h),a),k=f.substring(0,f.indexOf("Animation")).toLowerCase(),l=k&&"-"+k+"-"||"";return e[g]||(i.insertRule("@"+l+"keyframes "+g+"{"+"0%{opacity:"+j+"}"+h+"%{opacity:"+a+"}"+(h+.01)+"%{opacity:1}"+(h+b)%100+"%{opacity:"+a+"}"+"100%{opacity:"+j+"}"+"}",0),e[g]=1),g}function k(a,b){var e=a.style,f,g;if(e[b]!==c)return b;b=b.charAt(0).toUpperCase()+b.slice(1);for(g=0;g<d.length;g++){f=d[g]+b;if(e[f]!==c)return f}}function l(a,b){for(var c in b)a.style[k(a,c)||c]=b[c];return a}function m(a){for(var b=1;b<arguments.length;b++){var d=arguments[b];for(var e in d)a[e]===c&&(a[e]=d[e])}return a}function n(a){var b={x:a.offsetLeft,y:a.offsetTop};while(a=a.offsetParent)b.x+=a.offsetLeft,b.y+=a.offsetTop;return b}var d=["webkit","Moz","ms","O"],e={},f,i=function(){var a=g("style");return h(b.getElementsByTagName("head")[0],a),a.sheet||a.styleSheet}(),o={lines:12,length:7,width:5,radius:10,rotate:0,color:"#000",speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto"},p=function q(a){if(!this.spin)return new q(a);this.opts=m(a||{},q.defaults,o)};p.defaults={},m(p.prototype,{spin:function(a){this.stop();var b=this,c=b.opts,d=b.el=l(g(0,{className:c.className}),{position:"relative",zIndex:c.zIndex}),e=c.radius+c.length+c.width,h,i;a&&(a.insertBefore(d,a.firstChild||null),i=n(a),h=n(d),l(d,{left:(c.left=="auto"?i.x-h.x+(a.offsetWidth>>1):c.left+e)+"px",top:(c.top=="auto"?i.y-h.y+(a.offsetHeight>>1):c.top+e)+"px"})),d.setAttribute("aria-role","progressbar"),b.lines(d,b.opts);if(!f){var j=0,k=c.fps,m=k/c.speed,o=(1-c.opacity)/(m*c.trail/100),p=m/c.lines;!function q(){j++;for(var a=c.lines;a;a--){var e=Math.max(1-(j+a*p)%m*o,c.opacity);b.opacity(d,c.lines-a,e,c)}b.timeout=b.el&&setTimeout(q,~~(1e3/k))}()}return b},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=c),this},lines:function(a,b){function e(a,d){return l(g(),{position:"absolute",width:b.length+b.width+"px",height:b.width+"px",background:a,boxShadow:d,transformOrigin:"left",transform:"rotate("+~~(360/b.lines*c+b.rotate)+"deg) translate("+b.radius+"px"+",0)",borderRadius:(b.width>>1)+"px"})}var c=0,d;for(;c<b.lines;c++)d=l(g(),{position:"absolute",top:1+~(b.width/2)+"px",transform:b.hwaccel?"translate3d(0,0,0)":"",opacity:b.opacity,animation:f&&j(b.opacity,b.trail,c,b.lines)+" "+1/b.speed+"s linear infinite"}),b.shadow&&h(d,l(e("#000","0 0 4px #000"),{top:"2px"})),h(a,h(d,e(b.color,"0 0 1px rgba(0,0,0,.1)")));return a},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}}),!function(){function a(a,b){return g("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',b)}var b=l(g("group"),{behavior:"url(#default#VML)"});!k(b,"transform")&&b.adj?(i.addRule(".spin-vml","behavior:url(#default#VML)"),p.prototype.lines=function(b,c){function f(){return l(a("group",{coordsize:e+" "+e,coordorigin:-d+" "+-d}),{width:e,height:e})}function k(b,e,g){h(i,h(l(f(),{rotation:360/c.lines*b+"deg",left:~~e}),h(l(a("roundrect",{arcsize:1}),{width:d,height:c.width,left:c.radius,top:-c.width>>1,filter:g}),a("fill",{color:c.color,opacity:c.opacity}),a("stroke",{opacity:0}))))}var d=c.length+c.width,e=2*d,g=-(c.width+c.length)*2+"px",i=l(f(),{position:"absolute",top:g,left:g}),j;if(c.shadow)for(j=1;j<=c.lines;j++)k(j,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(j=1;j<=c.lines;j++)k(j);return h(b,i)},p.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}):f=k(b,"animation")}(),a.Spinner=p})(window,document);(function($){$.fn.spin=function(opts,color){var presets={"tiny":{lines:8,length:2,width:2,radius:3},"small":{lines:8,length:4,width:3,radius:5},"large":{lines:10,length:8,width:4,radius:8}};if(Spinner){return this.each(function(){var $this=$(this),data=$this.data();if(data.spinner){data.spinner.stop();delete data.spinner;}
if(opts!==false){if(typeof opts==="string"){if(opts in presets){opts=presets[opts];}else{opts={};}
if(color){opts.color=color;}}
data.spinner=new Spinner($.extend({color:$this.css('color')},opts)).spin(this);}});}else{throw"Spinner class not available.";}};})(jQuery);function logMessage(methodName,methodMessage){try{console.log(methodName+" message: "+methodMessage);}catch(exception){}}
function logException(methodName,methodException){try{console.log(methodName+" exception: "+methodException.message);}catch(exception){}}
var swfobject=function(){var UNDEF="undefined",OBJECT="object",SHOCKWAVE_FLASH="Shockwave Flash",SHOCKWAVE_FLASH_AX="ShockwaveFlash.ShockwaveFlash",FLASH_MIME_TYPE="application/x-shockwave-flash",EXPRESS_INSTALL_ID="SWFObjectExprInst",ON_READY_STATE_CHANGE="onreadystatechange",win=window,doc=document,nav=navigator,plugin=false,domLoadFnArr=[main],regObjArr=[],objIdArr=[],listenersArr=[],storedAltContent,storedAltContentId,storedCallbackFn,storedCallbackObj,isDomLoaded=false,isExpressInstallActive=false,dynamicStylesheet,dynamicStylesheetMedia,autoHideShow=true,ua=function(){var w3cdom=typeof doc.getElementById!=UNDEF&&typeof doc.getElementsByTagName!=UNDEF&&typeof doc.createElement!=UNDEF,u=nav.userAgent.toLowerCase(),p=nav.platform.toLowerCase(),windows=p?/win/.test(p):/win/.test(u),mac=p?/mac/.test(p):/mac/.test(u),webkit=/webkit/.test(u)?parseFloat(u.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,ie=!+"\v1",playerVersion=[0,0,0],d=null;if(typeof nav.plugins!=UNDEF&&typeof nav.plugins[SHOCKWAVE_FLASH]==OBJECT){d=nav.plugins[SHOCKWAVE_FLASH].description;if(d&&!(typeof nav.mimeTypes!=UNDEF&&nav.mimeTypes[FLASH_MIME_TYPE]&&!nav.mimeTypes[FLASH_MIME_TYPE].enabledPlugin)){plugin=true;ie=false;d=d.replace(/^.*\s+(\S+\s+\S+$)/,"$1");playerVersion[0]=parseInt(d.replace(/^(.*)\..*$/,"$1"),10);playerVersion[1]=parseInt(d.replace(/^.*\.(.*)\s.*$/,"$1"),10);playerVersion[2]=/[a-zA-Z]/.test(d)?parseInt(d.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0;}}
else if(typeof win.ActiveXObject!=UNDEF){try{var a=new ActiveXObject(SHOCKWAVE_FLASH_AX);if(a){d=a.GetVariable("$version");if(d){ie=true;d=d.split(" ")[1].split(",");playerVersion=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10)];}}}
catch(e){}}
return{w3:w3cdom,pv:playerVersion,wk:webkit,ie:ie,win:windows,mac:mac};}(),onDomLoad=function(){if(!ua.w3){return;}
if((typeof doc.readyState!=UNDEF&&doc.readyState=="complete")||(typeof doc.readyState==UNDEF&&(doc.getElementsByTagName("body")[0]||doc.body))){callDomLoadFunctions();}
if(!isDomLoaded){if(typeof doc.addEventListener!=UNDEF){doc.addEventListener("DOMContentLoaded",callDomLoadFunctions,false);}
if(ua.ie&&ua.win){doc.attachEvent(ON_READY_STATE_CHANGE,function(){if(doc.readyState=="complete"){doc.detachEvent(ON_READY_STATE_CHANGE,arguments.callee);callDomLoadFunctions();}});if(win==top){(function(){if(isDomLoaded){return;}
try{doc.documentElement.doScroll("left");}
catch(e){setTimeout(arguments.callee,0);return;}
callDomLoadFunctions();})();}}
if(ua.wk){(function(){if(isDomLoaded){return;}
if(!/loaded|complete/.test(doc.readyState)){setTimeout(arguments.callee,0);return;}
callDomLoadFunctions();})();}
addLoadEvent(callDomLoadFunctions);}}();function callDomLoadFunctions(){if(isDomLoaded){return;}
try{var t=doc.getElementsByTagName("body")[0].appendChild(createElement("span"));t.parentNode.removeChild(t);}
catch(e){return;}
isDomLoaded=true;var dl=domLoadFnArr.length;for(var i=0;i<dl;i++){domLoadFnArr[i]();}}
function addDomLoadEvent(fn){if(isDomLoaded){fn();}
else{domLoadFnArr[domLoadFnArr.length]=fn;}}
function addLoadEvent(fn){if(typeof win.addEventListener!=UNDEF){win.addEventListener("load",fn,false);}
else if(typeof doc.addEventListener!=UNDEF){doc.addEventListener("load",fn,false);}
else if(typeof win.attachEvent!=UNDEF){addListener(win,"onload",fn);}
else if(typeof win.onload=="function"){var fnOld=win.onload;win.onload=function(){fnOld();fn();};}
else{win.onload=fn;}}
function main(){if(plugin){testPlayerVersion();}
else{matchVersions();}}
function testPlayerVersion(){var b=doc.getElementsByTagName("body")[0];var o=createElement(OBJECT);o.setAttribute("type",FLASH_MIME_TYPE);var t=b.appendChild(o);if(t){var counter=0;(function(){if(typeof t.GetVariable!=UNDEF){var d=t.GetVariable("$version");if(d){d=d.split(" ")[1].split(",");ua.pv=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10)];}}
else if(counter<10){counter++;setTimeout(arguments.callee,10);return;}
b.removeChild(o);t=null;matchVersions();})();}
else{matchVersions();}}
function matchVersions(){var rl=regObjArr.length;if(rl>0){for(var i=0;i<rl;i++){var id=regObjArr[i].id;var cb=regObjArr[i].callbackFn;var cbObj={success:false,id:id};if(ua.pv[0]>0){var obj=getElementById(id);if(obj){if(hasPlayerVersion(regObjArr[i].swfVersion)&&!(ua.wk&&ua.wk<312)){setVisibility(id,true);if(cb){cbObj.success=true;cbObj.ref=getObjectById(id);cb(cbObj);}}
else if(regObjArr[i].expressInstall&&canExpressInstall()){var att={};att.data=regObjArr[i].expressInstall;att.width=obj.getAttribute("width")||"0";att.height=obj.getAttribute("height")||"0";if(obj.getAttribute("class")){att.styleclass=obj.getAttribute("class");}
if(obj.getAttribute("align")){att.align=obj.getAttribute("align");}
var par={};var p=obj.getElementsByTagName("param");var pl=p.length;for(var j=0;j<pl;j++){if(p[j].getAttribute("name").toLowerCase()!="movie"){par[p[j].getAttribute("name")]=p[j].getAttribute("value");}}
showExpressInstall(att,par,id,cb);}
else{displayAltContent(obj);if(cb){cb(cbObj);}}}}
else{setVisibility(id,true);if(cb){var o=getObjectById(id);if(o&&typeof o.SetVariable!=UNDEF){cbObj.success=true;cbObj.ref=o;}
cb(cbObj);}}}}}
function getObjectById(objectIdStr){var r=null;var o=getElementById(objectIdStr);if(o&&o.nodeName=="OBJECT"){if(typeof o.SetVariable!=UNDEF){r=o;}
else{var n=o.getElementsByTagName(OBJECT)[0];if(n){r=n;}}}
return r;}
function canExpressInstall(){return!isExpressInstallActive&&hasPlayerVersion("6.0.65")&&(ua.win||ua.mac)&&!(ua.wk&&ua.wk<312);}
function showExpressInstall(att,par,replaceElemIdStr,callbackFn){isExpressInstallActive=true;storedCallbackFn=callbackFn||null;storedCallbackObj={success:false,id:replaceElemIdStr};var obj=getElementById(replaceElemIdStr);if(obj){if(obj.nodeName=="OBJECT"){storedAltContent=abstractAltContent(obj);storedAltContentId=null;}
else{storedAltContent=obj;storedAltContentId=replaceElemIdStr;}
att.id=EXPRESS_INSTALL_ID;if(typeof att.width==UNDEF||(!/%$/.test(att.width)&&parseInt(att.width,10)<310)){att.width="310";}
if(typeof att.height==UNDEF||(!/%$/.test(att.height)&&parseInt(att.height,10)<137)){att.height="137";}
doc.title=doc.title.slice(0,47)+" - Flash Player Installation";var pt=ua.ie&&ua.win?"ActiveX":"PlugIn",fv="MMredirectURL="+win.location.toString().replace(/&/g,"%26")+"&MMplayerType="+pt+"&MMdoctitle="+doc.title;if(typeof par.flashvars!=UNDEF){par.flashvars+="&"+fv;}
else{par.flashvars=fv;}
if(ua.ie&&ua.win&&obj.readyState!=4){var newObj=createElement("div");replaceElemIdStr+="SWFObjectNew";newObj.setAttribute("id",replaceElemIdStr);obj.parentNode.insertBefore(newObj,obj);obj.style.display="none";(function(){if(obj.readyState==4){obj.parentNode.removeChild(obj);}
else{setTimeout(arguments.callee,10);}})();}
createSWF(att,par,replaceElemIdStr);}}
function displayAltContent(obj){if(ua.ie&&ua.win&&obj.readyState!=4){var el=createElement("div");obj.parentNode.insertBefore(el,obj);el.parentNode.replaceChild(abstractAltContent(obj),el);obj.style.display="none";(function(){if(obj.readyState==4){obj.parentNode.removeChild(obj);}
else{setTimeout(arguments.callee,10);}})();}
else{obj.parentNode.replaceChild(abstractAltContent(obj),obj);}}
function abstractAltContent(obj){var ac=createElement("div");if(ua.win&&ua.ie){ac.innerHTML=obj.innerHTML;}
else{var nestedObj=obj.getElementsByTagName(OBJECT)[0];if(nestedObj){var c=nestedObj.childNodes;if(c){var cl=c.length;for(var i=0;i<cl;i++){if(!(c[i].nodeType==1&&c[i].nodeName=="PARAM")&&!(c[i].nodeType==8)){ac.appendChild(c[i].cloneNode(true));}}}}}
return ac;}
function createSWF(attObj,parObj,id){var r,el=getElementById(id);if(ua.wk&&ua.wk<312){return r;}
if(el){if(typeof attObj.id==UNDEF){attObj.id=id;}
if(ua.ie&&ua.win){var att="";for(var i in attObj){if(attObj[i]!=Object.prototype[i]){if(i.toLowerCase()=="data"){parObj.movie=attObj[i];}
else if(i.toLowerCase()=="styleclass"){att+=' class="'+attObj[i]+'"';}
else if(i.toLowerCase()!="classid"){att+=' '+i+'="'+attObj[i]+'"';}}}
var par="";for(var j in parObj){if(parObj[j]!=Object.prototype[j]){par+='<param name="'+j+'" value="'+parObj[j]+'" />';}}
el.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+att+'>'+par+'</object>';objIdArr[objIdArr.length]=attObj.id;r=getElementById(attObj.id);}
else{var o=createElement(OBJECT);o.setAttribute("type",FLASH_MIME_TYPE);for(var m in attObj){if(attObj[m]!=Object.prototype[m]){if(m.toLowerCase()=="styleclass"){o.setAttribute("class",attObj[m]);}
else if(m.toLowerCase()!="classid"){o.setAttribute(m,attObj[m]);}}}
for(var n in parObj){if(parObj[n]!=Object.prototype[n]&&n.toLowerCase()!="movie"){createObjParam(o,n,parObj[n]);}}
el.parentNode.replaceChild(o,el);r=o;}}
return r;}
function createObjParam(el,pName,pValue){var p=createElement("param");p.setAttribute("name",pName);p.setAttribute("value",pValue);el.appendChild(p);}
function removeSWF(id){var obj=getElementById(id);if(obj&&obj.nodeName=="OBJECT"){if(ua.ie&&ua.win){obj.style.display="none";(function(){if(obj.readyState==4){removeObjectInIE(id);}
else{setTimeout(arguments.callee,10);}})();}
else{obj.parentNode.removeChild(obj);}}}
function removeObjectInIE(id){var obj=getElementById(id);if(obj){for(var i in obj){if(typeof obj[i]=="function"&&obj[i]!=null){obj[i]=null;}}
obj.parentNode.removeChild(obj);}}
function getElementById(id){var el=null;try{el=doc.getElementById(id);}
catch(e){}
return el;}
function createElement(el){return doc.createElement(el);}
function addListener(target,eventType,fn){target.attachEvent(eventType,fn);listenersArr[listenersArr.length]=[target,eventType,fn];}
function hasPlayerVersion(rv){var pv=ua.pv,v=rv.split(".");v[0]=parseInt(v[0],10);v[1]=parseInt(v[1],10)||0;v[2]=parseInt(v[2],10)||0;return(pv[0]>v[0]||(pv[0]==v[0]&&pv[1]>v[1])||(pv[0]==v[0]&&pv[1]==v[1]&&pv[2]>=v[2]))?true:false;}
function createCSS(sel,decl,media,newStyle){if(ua.ie&&ua.mac){return;}
var h=doc.getElementsByTagName("head")[0];if(!h){return;}
var m=(media&&typeof media=="string")?media:"screen";if(newStyle){dynamicStylesheet=null;dynamicStylesheetMedia=null;}
if(!dynamicStylesheet||dynamicStylesheetMedia!=m){var s=createElement("style");s.setAttribute("type","text/css");s.setAttribute("media",m);dynamicStylesheet=h.appendChild(s);if(ua.ie&&ua.win&&typeof doc.styleSheets!=UNDEF&&doc.styleSheets.length>0){dynamicStylesheet=doc.styleSheets[doc.styleSheets.length-1];}
dynamicStylesheetMedia=m;}
if(ua.ie&&ua.win){if(dynamicStylesheet&&typeof dynamicStylesheet.addRule==OBJECT){dynamicStylesheet.addRule(sel,decl);}}
else{if(dynamicStylesheet&&typeof doc.createTextNode!=UNDEF){dynamicStylesheet.appendChild(doc.createTextNode(sel+" {"+decl+"}"));}}}
function setVisibility(id,isVisible){if(!autoHideShow){return;}
var v=isVisible?"visible":"hidden";if(isDomLoaded&&getElementById(id)){getElementById(id).style.visibility=v;}
else{createCSS("#"+id,"visibility:"+v);}}
function urlEncodeIfNecessary(s){var regex=/[\\\"<>\.;]/;var hasBadChars=regex.exec(s)!=null;return hasBadChars&&typeof encodeURIComponent!=UNDEF?encodeURIComponent(s):s;}
var cleanup=function(){if(ua.ie&&ua.win){window.attachEvent("onunload",function(){var ll=listenersArr.length;for(var i=0;i<ll;i++){listenersArr[i][0].detachEvent(listenersArr[i][1],listenersArr[i][2]);}
var il=objIdArr.length;for(var j=0;j<il;j++){removeSWF(objIdArr[j]);}
for(var k in ua){ua[k]=null;}
ua=null;for(var l in swfobject){swfobject[l]=null;}
swfobject=null;});}}();return{registerObject:function(objectIdStr,swfVersionStr,xiSwfUrlStr,callbackFn){if(ua.w3&&objectIdStr&&swfVersionStr){var regObj={};regObj.id=objectIdStr;regObj.swfVersion=swfVersionStr;regObj.expressInstall=xiSwfUrlStr;regObj.callbackFn=callbackFn;regObjArr[regObjArr.length]=regObj;setVisibility(objectIdStr,false);}
else if(callbackFn){callbackFn({success:false,id:objectIdStr});}},getObjectById:function(objectIdStr){if(ua.w3){return getObjectById(objectIdStr);}},embedSWF:function(swfUrlStr,replaceElemIdStr,widthStr,heightStr,swfVersionStr,xiSwfUrlStr,flashvarsObj,parObj,attObj,callbackFn){var callbackObj={success:false,id:replaceElemIdStr};if(ua.w3&&!(ua.wk&&ua.wk<312)&&swfUrlStr&&replaceElemIdStr&&widthStr&&heightStr&&swfVersionStr){setVisibility(replaceElemIdStr,false);addDomLoadEvent(function(){widthStr+="";heightStr+="";var att={};if(attObj&&typeof attObj===OBJECT){for(var i in attObj){att[i]=attObj[i];}}
att.data=swfUrlStr;att.width=widthStr;att.height=heightStr;var par={};if(parObj&&typeof parObj===OBJECT){for(var j in parObj){par[j]=parObj[j];}}
if(flashvarsObj&&typeof flashvarsObj===OBJECT){for(var k in flashvarsObj){if(typeof par.flashvars!=UNDEF){par.flashvars+="&"+k+"="+flashvarsObj[k];}
else{par.flashvars=k+"="+flashvarsObj[k];}}}
if(hasPlayerVersion(swfVersionStr)){var obj=createSWF(att,par,replaceElemIdStr);if(att.id==replaceElemIdStr){setVisibility(replaceElemIdStr,true);}
callbackObj.success=true;callbackObj.ref=obj;}
else if(xiSwfUrlStr&&canExpressInstall()){att.data=xiSwfUrlStr;showExpressInstall(att,par,replaceElemIdStr,callbackFn);return;}
else{setVisibility(replaceElemIdStr,true);}
if(callbackFn){callbackFn(callbackObj);}});}
else if(callbackFn){callbackFn(callbackObj);}},switchOffAutoHideShow:function(){autoHideShow=false;},ua:ua,getFlashPlayerVersion:function(){return{major:ua.pv[0],minor:ua.pv[1],release:ua.pv[2]};},hasFlashPlayerVersion:hasPlayerVersion,createSWF:function(attObj,parObj,replaceElemIdStr){if(ua.w3){return createSWF(attObj,parObj,replaceElemIdStr);}
else{return undefined;}},showExpressInstall:function(att,par,replaceElemIdStr,callbackFn){if(ua.w3&&canExpressInstall()){showExpressInstall(att,par,replaceElemIdStr,callbackFn);}},removeSWF:function(objElemIdStr){if(ua.w3){removeSWF(objElemIdStr);}},createCSS:function(selStr,declStr,mediaStr,newStyleBoolean){if(ua.w3){createCSS(selStr,declStr,mediaStr,newStyleBoolean);}},addDomLoadEvent:addDomLoadEvent,addLoadEvent:addLoadEvent,getQueryParamValue:function(param){var q=doc.location.search||doc.location.hash;if(q){if(/\?/.test(q)){q=q.split("?")[1];}
if(param==null){return urlEncodeIfNecessary(q);}
var pairs=q.split("&");for(var i=0;i<pairs.length;i++){if(pairs[i].substring(0,pairs[i].indexOf("="))==param){return urlEncodeIfNecessary(pairs[i].substring((pairs[i].indexOf("=")+1)));}}}
return"";},expressInstallCallback:function(){if(isExpressInstallActive){var obj=getElementById(EXPRESS_INSTALL_ID);if(obj&&storedAltContent){obj.parentNode.replaceChild(storedAltContent,obj);if(storedAltContentId){setVisibility(storedAltContentId,true);if(ua.ie&&ua.win){storedAltContent.style.display="block";}}
if(storedCallbackFn){storedCallbackFn(storedCallbackObj);}}
isExpressInstallActive=false;}}};}();