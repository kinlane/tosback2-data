/** Copyright (c) 2013 Sailthru, Inc. | Generated: Wed Mar 13 15:57:34 EDT 2013 **/
SailthruScout={config:{numVisible:10},allContent:[],visibleContent:[],lastIndex:-1,setup:function(options){for(var k in options){SailthruScout.config[k]=options[k]}if(options.renderItem){SailthruScout.renderItem=options.renderItem}SailthruScout.fetchContent(SailthruScout.config.numVisible+5);var set_scout_vars="var index = $(this).parents('.content-item').index();var id = SailthruScout.visibleContent[index].id;var url = SailthruScout.visibleContent[index].url;";function mousedown_handler(){eval(set_scout_vars);SailthruScout.track(id,"mhit",{index:index,url:url});return true}function hide_handler(){eval(set_scout_vars);SailthruScout.removeContentItem(this);SailthruScout.track(id,"mhide",{index:index,url:url});return true}if($().jquery>"1.7.0"){$(document).on("mousedown","#sailthru-scout a",mousedown_handler);$(document).on("click","#sailthru-scout .hide",hide_handler)}else{$("#sailthru-scout a").live("mousedown",mousedown_handler);$("#sailthru-scout .hide").live("click",hide_handler)}},track:function(e,d,a){var c="http://"+SailthruScout.config.domain+"/horizon/recommendtrack?event="+d;if(e){c+="&id="+e}if(SailthruScout.method){c+="&method="+SailthruScout.method}if(SailthruScout.config.trackType){c+="&type="+encodeURIComponent(SailthruScout.config.trackType)}if(a){for(var b in a){c+="&"+b+"="+encodeURIComponent(a[b])}}c+="&cb="+Math.random();SailthruScout.jq("body").append('<img src="'+c+'" />')},debug:function(){console.log("ALL CONTENT");for(var a=0;a<SailthruScout.allContent.length;a++){console.log(SailthruScout.allContent[a].url)}console.log("VISIBLE CONTENT");for(var a=0;a<SailthruScout.visibleContent.length;a++){console.log(SailthruScout.visibleContent[a].url)}},renderItem:function(a,b){return SailthruScout.defaultItemRender(a,b)},defaultItemRender:function(b,c){var a="";a+='<div class="content-item">';a+='<div class="hide">X</div>';if(b.image){a+='<div class="image"><a href="'+b.url+'" target="_blank"><img src="'+b.image.thumb+'" /></a></div>'}a+='<div class="title"><a href="'+b.url+'" target="_blank">'+b.title+"</a></div>";a+="</div>";return a},contentItemExists:function(b){if(!b){return false}for(var a=0;a<SailthruScout.allContent.length;a++){if(SailthruScout.allContent[a].url==b.url){return true}}return false},addContentItem:function(a){if(!a){return false}if(SailthruScout.contentItemExists(a)){return}a.index=SailthruScout.allContent.length;SailthruScout.allContent.push(a)},refreshVisibleItems:function(){if(SailthruScout.visibleContent.length<SailthruScout.config.numVisible){var d=SailthruScout.lastIndex;SailthruScout.visibleContent=SailthruScout.visibleContent.concat(SailthruScout.allContent.slice(d+1,d+1+SailthruScout.config.numVisible-SailthruScout.visibleContent.length));if(SailthruScout.visibleContent.length){SailthruScout.lastIndex=Math.max(SailthruScout.lastIndex,SailthruScout.visibleContent[SailthruScout.visibleContent.length-1].index)}var b="";for(var a=0;a<SailthruScout.visibleContent.length;a++){var c=SailthruScout.visibleContent[a];b+=SailthruScout.renderItem(c,a)}$("#sailthru-scout").html(b);$(".sailthru-scout-loaded").show()}},removeContentItem:function(b){var a=$(b).parents(".content-item").index();SailthruScout.visibleContent.splice(a,1);$(b).parents(".content-item").fadeOut(500,function(){SailthruScout.refreshVisibleItems()});if(SailthruScout.allContent.length<SailthruScout.lastIndex+3){SailthruScout.fetchContent(SailthruScout.allContent.length+10)}},fetchContent:function(b){var a="http://"+SailthruScout.config.domain+"/horizon/recommend?format=jsonp&number="+b+"&nospider=1";if(SailthruScout.config.includeConsumed){a+="&include_consumed=1"}if(SailthruScout.config.noPageview){a+="&nopageview=1"}if(SailthruScout.config.alternateJsonpMode){SailthruScout.jq("body").append('<script type="text/javascript" src="'+a+'&callback=SailthruScout.fetchContentCallback"><\/script>')}else{SailthruScout.jq.ajax(a,{dataType:"jsonp",success:SailthruScout.fetchContentCallback})}},fetchContentCallback:function(b){if(!SailthruScout.method&&b.method){SailthruScout.method=b.method;var c="";for(var a=0;a<b.content.length;a++){c+=","+b.content[a].id}c=c.substring(1);SailthruScout.track(null,"mshow",{ids:c,visible:SailthruScout.config.numVisible})}for(var a=0;a<b.content.length;a++){SailthruScout.addContentItem(b.content[a])}SailthruScout.refreshVisibleItems()},jq:window.$?window.$:null};