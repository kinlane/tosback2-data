function loadScriptTag(fullUrl){var scriptId="JscriptId"+(new Date()).getTime()+Math.floor(Math.random()*11);var scriptObj=document.createElement("script");scriptObj.setAttribute("type","text/javascript");scriptObj.setAttribute("charset","utf-8");scriptObj.setAttribute("src",fullUrl+"&reqID="+scriptId);scriptObj.setAttribute("id",scriptId);document.getElementsByTagName("head").item(0).appendChild(scriptObj);}
function removeScriptTagById(id){var jScriptTag=document.getElementById(id);jScriptTag.parentNode.removeChild(jScriptTag);}
function ISuggest(){var _active=true;var _requestClient=null;var _trackingElement=null;var _activeElement=null;var _activeQuery=new function(){this.query=null;this.response=null;};var _timeoutPeriod=0;var _currentSelection=-1;var _selectedValue=null;var _suggestionsPanel=null;var _jsonClient=null;var _findPos=function(obj){var curleft=curtop=0;try{if(obj.offsetParent){do{curleft+=obj.offsetLeft;curtop+=obj.offsetTop;}while(obj=obj.offsetParent);return{left:curleft,top:curtop};}}
catch(e){}
return null;};var _changeCallbacks={};var _logCallbacks={};var _openOverSearchBox={};var _selectPrevious=function(){if(_currentSelection>=0)
_suggestionsPanel.childNodes[_currentSelection].className='suggest_link';if(_currentSelection==0||_currentSelection==-1)
_currentSelection=_suggestionsPanel.childNodes.length-1;else
_currentSelection--;_suggestionsPanel.childNodes[_currentSelection].className='suggest_link_over';if(_currentSelection>-1){var value=_suggestionsPanel.childNodes[_currentSelection].childNodes[0].nodeValue;_activeQuery.query=value;_activeQuery.response=null;_activeElement.value=value;_selectedValue=value;_updateLoggingValues('True',114);}};var _selectNext=function(){if(_currentSelection>=0)
_suggestionsPanel.childNodes[_currentSelection].className='suggest_link';if(_currentSelection==(_suggestionsPanel.childNodes.length-1))
_currentSelection=0;else
++_currentSelection;_suggestionsPanel.childNodes[_currentSelection].className='suggest_link_over';if(_currentSelection>-1){var value=_suggestionsPanel.childNodes[_currentSelection].childNodes[0].nodeValue;_activeQuery.query=value;_activeQuery.response=null;_activeElement.value=value;_selectedValue=value;_updateLoggingValues('True',114);}};var _updateLoggingValues=function(value){var inputElement=document.getElementById(_activeElement.id+'Qlnk');if(inputElement==null||inputElement.value!=value){var qlnkField=document.createElement('input');qlnkField.id=_activeElement.id+'Qlnk';qlnkField.type='hidden';qlnkField.name='qlnk';qlnkField.value=value;if(inputElement==null){_activeElement.parentNode.appendChild(qlnkField);}
else{_activeElement.parentNode.replaceChild(qlnkField,inputElement);}}};var _showSuggestions=function(){_suggestionsPanel.style['display']='block';_currentSelection=-1;var pos=_findPos(_trackingElement);_suggestionsPanel.style['left']=pos.left+'px';if(_openOverSearchBox[_activeElement.id]){_suggestionsPanel.style['top']=pos.top-_suggestionsPanel.offsetHeight+'px';}
else{_suggestionsPanel.style['top']=pos.top+_trackingElement.offsetHeight+'px';}
_suggestionsPanel.style['width']=$(_trackingElement).outerWidth()-$(_suggestionsPanel).outerWidth()+$(_suggestionsPanel).innerWidth()+'px';};var _hideSuggestions=function(){_suggestionsPanel.innerHTML='';_suggestionsPanel.style['display']='none';};this.insertScriptTag=function(){if(!_activeElement||_activeElement.value==_activeQuery.query)return;_trackingElement=_activeElement;var str=escape(_activeElement.value);if(str==''){_suggestionsPanel.style['display']='none';return;}
_activeQuery.query=str;var host='suggest.infospace.com';loadScriptTag('http://'+host+'/QuerySuggest/SuggestServlet?prefix='+str);};var _onEditKeyUp=function(e){if(!_active)return;if(!e)var e=window.event;var code;if(e.keyCode)code=e.keyCode;else if(e.which)code=e.which;if(code!=27&&code!=40&&code!=38&&code!=13)
window.setTimeout("iSuggest.insertScriptTag()",_timeoutPeriod);};this.onKeyUp=function(e){if(!_active)return;if(_suggestionsPanel.style['display']!='block'&&_suggestionsPanel.childNodes.length==0)return;var code;if(e.keyCode)code=e.keyCode;else if(e.which)code=e.which;switch(code)
{case 40:_selectNext();break;case 38:_selectPrevious();break;case 27:_hideSuggestions();_activeQuery.query=null;_activeQuery.response=null;break;}};this.PopulateResults=function(suggestions,reqID){_suggestionsPanel.innerHTML='';_currentSelection=-1;if(suggestions){for(var i=0;i<suggestions.length;i++){var suggest='<div onmouseover="javascript:iSuggest.suggestOver(this);" onmouseout="javascript:iSuggest.suggestOut(this);" onclick="javascript:iSuggest.setSearch(this.childNodes[0].nodeValue);" class="suggest_link" id="suggest_link_'+i+'">'+suggestions[i]+'</div>';_suggestionsPanel.innerHTML+=suggest;}}
removeScriptTagById(reqID);if(_suggestionsPanel.innerHTML==""||suggestions==null)
_hideSuggestions();else
_showSuggestions();};this.onMouseClick=function(){_hideSuggestions();_activeQuery.query=null;_activeQuery.response=null;};this.suggestOver=function(div_value){div_value.className='suggest_link_over';};this.suggestOut=function(div_value){div_value.className='suggest_link';};this.setSearch=function(value){if(_logCallbacks[_activeElement.id]){_logCallbacks[_activeElement.id]();}
_activeQuery.query=value;_activeQuery.response=null;_hideSuggestions();_activeElement.value=value;_updateLoggingValues('True');if(_changeCallbacks[_activeElement.id]){_changeCallbacks[_activeElement.id]();}
return false;};this.init=function(inputsToTrack){_suggestionsPanel=document.createElement('div');_suggestionsPanel.className='suggestPanel';_suggestionsPanel.id='suggestPanel';document.body.insertBefore(_suggestionsPanel,document.body.firstChild);for(var i=0;i<inputsToTrack.length;i++){var field=inputsToTrack[i];if(typeof(field)=="string"){this.addField(field);}
else if(field.id){this.addField(field.id);if(field.callback){_changeCallbacks[field.id]=field.callback;}
if(field.logCallback){_logCallbacks[field.id]=field.logCallback;}
if(field.openOverSearchBox){_openOverSearchBox[field.id]=true;}}}};this.addField=function(txtID){var textBox=document.getElementById(txtID);if(!textBox){return;}
textBox.oldOnFocus=(textBox.onfocus)?textBox.onfocus:function(){};function newOnFocus(e){_activeElement=this;this.oldOnFocus();}
textBox.onfocus=newOnFocus;textBox.oldOnBlur=(textBox.onblur)?textBox.onblur:function(){};function newOnBlur(e){if(_suggestionsPanel.style['display']!='block')_activeElement=null;this.oldOnBlur();}
textBox.onblur=newOnBlur;textBox.oldEditKey=(textBox.onkeyup)?textBox.onkeyup:function(){};function newEditKeyUp(e){_activeElement=this;this.oldEditKey();if(!e)var e=window.event;_onEditKeyUp(e);}
textBox.onkeyup=newEditKeyUp;textBox.setAttribute('autocomplete','off');};this.setActive=function(active){_active=active;var element;for(var i=0;i<ispace_txtElements.length;++i){element=document.getElementById(ispace_txtElements[i].id);if(element)element.setAttribute('autocomplete',_active?'off':'on');}};}
var iSuggest;function Initialize(){iSuggest=new ISuggest();iSuggest.init(ispace_txtElements);var oldOnClick=(document.onclick)?document.onclick:function(){};function newOnClick(e){oldOnClick();if(!e)var e=window.event;iSuggest.onMouseClick(e);}
document.onclick=newOnClick;var oldOnKeyUp=(document.onkeyup)?document.onkeyup:function(){};function newOnKeyUp(e){oldOnKeyUp();if(!e)var e=window.event;iSuggest.onKeyUp(e);}
document.onkeyup=newOnKeyUp;}
document.write('<iframe style="height:0px;width:0px;visibility:hidden;display:none;" src="about:blank">this prevents back forward cache</iframe>');document.writeln('<style type="text/css">');document.writeln('.suggest_link {overflow:hidden;}');document.writeln('.suggest_link_over {overflow:hidden;cursor:pointer;}');document.writeln('.suggestPanel {position:absolute;display:none;text-align:left;}');document.writeln('</style>');Initialize();