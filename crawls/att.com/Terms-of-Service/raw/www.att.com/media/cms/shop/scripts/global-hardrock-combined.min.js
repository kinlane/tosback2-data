/*! $Revision: 498287 $ $Date: 2012-11-29 14:56:20 -0800 (Thu, 29 Nov 2012) $ GENERATED FILE DO NOT MODIFY: concatination of modalHardrock_extended.js form-exception-manager.js shopping-cart.js cart-summary.js shoppingassistant.js ATT.sessionexpire.js modal-spinner.js */
jQuery(document).ready(function(c){var a=null,b=null;if((navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i))&&navigator.userAgent.match(/Safari/i)){jQuery(document).bind("cbox_complete",function(){jQuery.colorbox.resize();jQuery(window).unbind("resize."+jQuery.colorbox.prefix);jQuery("#cboxContent").css({"-webkit-text-size-adjust":"none",zoom:1})});if(navigator.userAgent.match(/iPhone/i)&&navigator.userAgent.match(/Safari/i)){c(document).bind("cbox_open",function(){if(b){b.remove()}b=jQuery("<meta>",{name:"viewport",content:"width=device-width; initial-scale=1.0;"});jQuery("head").append(b)}).bind("cbox_closed",function(){b.remove();b=jQuery("<meta>",{name:"viewport",content:"width=1047;"});jQuery("head").append(b)})}}if(jQuery(document.body).data("initModals")!=true){jQuery(document.body).data("initModals",true);jQuery(document.body).delegate("a.openModal","click",function(){var d=this.className.split(" ");if(d.length>1&&modalProfiles[d[1]]){var e=modalProfiles[d[1]];e.preConfig({element:this,config:e});jQuery.colorbox(e.cbConfig);return false}})}});var modalUtils={modalExpanded:false,modalSize:{min:315,max:610},init:function(){log("modal util init");var a=jQuery(".modalContent");modalUtils.loadModalFiles(a);jQuery.fn.morphForms();if(jQuery(".toggle",a)!=0){toggle()}if(jQuery(".toggleGroup",a)!=0){toggleGroup()}jQuery(".modalHeader .closeModal, .modalContent .closeModal").click(function(){jQuery.colorbox.close();return false})},initNoUniform:function(){log("modal util init");var a=jQuery(".modalContent");modalUtils.loadModalFiles(a);jQuery(".modalHeader .closeModal, .modalContent .closeModal").click(function(){jQuery.colorbox.close();return false})},initIframe:function(){setTimeout(function(){log("modal iframe init");jQuery(".genericmodal").find(".modalHeader .closeModal, .modalContent .closeModal").click(function(){jQuery.colorbox.close();return false})},1500);jQuery("#zipCodeEntryForm").ajaxForm({dataType:"text",beforeSubmit:function(){jQuery("#zipValidate").removeClass("error");jQuery(".wait").css("display","block")},success:function(b){localizationCallback(b)}});jQuery("#zipCodeEntry").focus();jQuery("#zipCodeEntry").keypress(function(c){var b=window.event?c.keyCode:c.which;if(b===13){c.preventDefault();jQuery("#zipSubmit").click()}else{return true}});var a=jQuery(".modalContent");if(jQuery(".toggle",a)!=0){toggle()}},loadModalFiles:function(a){if(!jQuery.uniform&&jQuery("form",a)!=0){jQuery.getScript("//www.att.com/scripts/jquery.uniform.js",function(){},true)}},localModalInit:function(b){ATT.log("localmodal init");var c=jQuery(".modalContent");modalUtils.loadModalFiles(c);if(jQuery(".toggle",c)!=0){toggle()}var d=(window.location.href.indexOf("/shop/")>=0)?"/shop":"/homepage";jQuery.getScript("/media/cms/shop/scripts/localization_extended.js",function(){},true);if(b!=undefined&&b.element!=undefined){var a=jQuery(b.element).attr("data-sku");if(a!=undefined&&a!=null){if(b.config.cbConfig.href.indexOf("?")>-1){b.config.cbConfig.href=b.config.cbConfig.href+"&q_skuId="+a}else{b.config.cbConfig.href=b.config.cbConfig.href+"?q_skuId="+a}}}},config:function(a){a.config.cbConfig.href=a.element.href},openModal:function(b,a){var c=a||modalProfiles.modal505;c.cbConfig.href=b;jQuery.colorbox(c.cbConfig)},resizeModal:function(){log("resize modal");var a=(modalUtils.modalExpanded)?modalUtils.modalSize.min:modalUtils.modalSize.max;modalUtils.modalExpanded=!modalUtils.modalExpanded;setTimeout(function(){jQuery.colorbox.resize({height:a})},900)}};var log=this.log=function log(a){ATT.log(a)};var templateSelector=function(c){var d=window.location.pathname;var b=d.substr(d.lastIndexOf("/"),d.length);var a=(b.split(".").length-1)>=2;if(a){pageNameWithoutSelector=b.substr(b.indexOf("/"),b.indexOf("."))+".html";d=d.replace(b,pageNameWithoutSelector);ATT.log("converted location from"+b+" to "+d)}if(d.lastIndexOf(".html")==-1){d=location.protocol+"//"+location.host+d;var e=location.protocol+"//"+location.host+"/";if(d.charAt(d.length-1)!="/"){d+="/"}if(d==e){d+="homepage/"}d+="index.html"}d=d.replace(".html","."+c+".html");return d};var PageMessagingBox=function(c,b,a){if(typeof c==="string"&&c){jQuery(a.selector).remove();if(!jQuery(a.selector).length){jQuery.ajax({url:templateSelector(c),cache:false,success:function(d){jQuery(d).hide().prependTo(b.selector).fadeIn("slow");jQuery(".collapseImg").bind("click",function(){jQuery(a.selector).fadeOut("slow",function(){jQuery(this).remove()})})}})}}};var pageLocation=function(){var c=window.location.pathname;var b=c.lastIndexOf("/");var a=c.substring(b+1,c.length);return a};var testProfile=function(i){var c=jQuery.parseJSON(i);ATT.log("uverseQual="+c.uverseQual);ATT.log("customerState="+c.cState);var j="";var e=["u-verse.html","internet.html","bundles.html","home-phone.html"];var g=["u-verse.html","internet.html","bundles.html","home-phone.html"];var b=["home-phone.html"];var d=["internet.html","bundles.html","tv.html","home-phone.html"];var a=["tv.html"];var f=document.referrer;if(c.cState=="qualified"){if(jQuery.inArray(pageLocation(),g)!=-1&&c.uverseQual=="N"){j="uverseRed"}if(jQuery.inArray(pageLocation(),a)!=-1&&c.uverseIPTVQual=="N"){j="uverseRed"}if(jQuery.inArray(pageLocation(),d)!=-1&&c.uverseQual=="N"&&c.dslQual=="Y"){j="uverseRedIpdslGreen"}if(jQuery.inArray(pageLocation(),e)!=-1&&c.uverseQual=="Y"&&f.search("availability")!=-1){j="uverseGreen"}PageMessagingBox(j,{selector:"#main-container"},{selector:"#inPageMessagingBox"})}jQuery.ajax({url:templateSelector("localizationCheck.xhr"),cache:false,dataType:"text",success:function(l){ATT.log("loaded it:"+l);var k=jQuery.parseJSON(l);if(k.localizationAttempted=="true"){PageMessagingBox("inPageMessageBox",{selector:"#main-container"},{selector:"#inPageMessagingBox"})}}})};var modalProfiles={modalXXX:{cbConfig:{iframe:false,scrolling:false,onComplete:modalUtils.init,href:""},preConfig:modalUtils.config},modal505:{cbConfig:{iframe:false,scrolling:false,width:505,onComplete:modalUtils.init,href:""},preConfig:modalUtils.config},modal705:{cbConfig:{iframe:false,scrolling:false,width:705,onComplete:modalUtils.init,href:""},preConfig:modalUtils.config},modalXLarge:{cbConfig:{iframe:false,scrolling:false,width:1000,onComplete:modalUtils.init,href:""},preConfig:modalUtils.config},intentModal:{cbConfig:{iframe:false,scrolling:false,width:505,onComplete:modalUtils.init,href:""},preConfig:modalUtils.config},modal705x400:{cbConfig:{iframe:false,scrolling:false,width:705,onComplete:modalUtils.init,href:"",overlayClose:false},preConfig:modalUtils.config},modalNoUniform:{cbConfig:{iframe:false,scrolling:false,width:705,onComplete:modalUtils.initNoUniform,href:"",overlayClose:false},preConfig:modalUtils.config},channelModal:{cbConfig:{iframe:false,scrolling:false,width:860,onComplete:modalUtils.init,href:""},preConfig:modalUtils.config},localModal:{cbConfig:{iframe:false,scrolling:false,width:505,height:315,onComplete:modalUtils.initIframe,href:templateSelector("changeZipModal")},preConfig:modalUtils.localModalInit}};ATT.namespace("FEM");ATT.FEM=new function(){var e=jQuery;var d=this.observe=["CartCallback","FormResponseReturned"];var m=this.treatments=[];var g=this.queue={page:[]};var n=this.init=function(){ATT.log("inside ATT.FEM.init()");e(document).bind(d.join(" "),i)};var b=this.treatment=function(r,q,p){return{errorCode:r,displayHandler:q,extra:(p)?p:""}};var o=this.add=function(r,q,p){m.push(b(r,q,p));return true};var f=this.clear=function(){m=[];return true};var i=this.handle=function(u,w){ATT.log("inside ATT.FEM.handle()");ATT.log(w);var t=(typeof w.queue==="undefined")?"page":w.queue;qlength=(typeof g[t]==="undefined")?0:g[t].length;if(typeof g[t]!=="undefined"&&g[t].length>0){for(var q=0;q<g[t].length;q++){var s=g[t][q];for(x in m){if(typeof(m[x])==="object"&&m[x].errorCode==s){m[x].displayHandler(s,v,m[x].extra,true)}}}g[t]=[]}if(typeof(w.messages)==="object"&&w.messages.length>0){for(var q=0;q<w.messages.length;q++){var p=[];var r=w.messages[q];if(typeof r.errorCode!=="string"){continue}var s=r.errorCode.replace("errorCode.","");s=s.replace("messageCode.","");ATT.log(s+" error code returned");var v=r.errorMessage;p.push(s);for(x in m){if(typeof(m[x])==="object"&&m[x].errorCode==s){m[x].displayHandler(s,v,m[x].extra,false)}}}}else{if(typeof(w.data)==="object"&&typeof(w.data.wirelessAddToCartResultHolder)==="object"&&w.data.wirelessAddToCartResultHolder.results.length>0&&w.data.wirelessAddToCartResultHolder.results.rollupStatus=="ERROR"){for(var q=0;q<w.data.wirelessAddToCartResultHolder.results.length;q++){var p=[];var r=w.data.wirelessAddToCartResultHolder.results[q];if(typeof r.errorCode!=="string"){continue}var s=r.errorCode.replace("errorCode.","");s=s.replace("messageCode.","");ATT.log(s+" error code returned");var v=r.errorMessage;p.push(s);for(x in m){if(typeof(m[x])==="object"&&m[x].errorCode==s){m[x].displayHandler(s,v,m[x].extra,false)}}}}}g[t]=p};var k=this.display={errorBox:function l(r,t,p,s){ATT.log("inside errorBox()");var q=(p.selector)?e(p.selector):e("#error-box");if(s){e("#errBox-"+r).remove();if(e(q).find("span").length==0){e(q).hide()}}else{if(q){q.find("p").append('<span id="errBox-'+r+'">'+t+"&nbsp;(errorCode."+r+")<br/><br/></span>");if(!q.is("visible")){q.show()}e.colorbox.resize()}else{ATT.log("No error box found to display exception")}}},inline:function j(q,s,p,r){ATT.log("inside inline()");fields=(p.selector)?e(p.selector):e("[data-handleError="+q+"]");if(r){if(fields){e(fields).each(function(t,u){e(u).removeClass("error")})}else{ATT.log("No field(s) found to remove error")}}else{if(fields){e(fields).each(function(t,u){e(u).addClass("error")})}else{ATT.log("No field(s) found to highlight for error")}}},dialogBox:function a(q,s,p,r){ATT.log("inside dialogBox()");if(r){e.colorbox.close()}else{e.colorbox({html:'<div id="error-box"><div class="modalHeader"><h1></h1><a href="#Close" class="closeModal">Close</a></div><div style="padding:20px;"><div class="errorMsg box"><p>'+s+"</p></div></div>",width:705,onComplete:function(){modalUtils.init();e.colorbox.resize()}})}},alertErr:function c(q,s,p,r){alert(s+" ("+q+")")}}};jQuery(document).ready(function(){ATT.FEM.init()});ATT.namespace("ShoppingCart",new function(){var $=jQuery;var by=ATT.util.sortBy;ATT.log("jQuery.min.js "+($?"installed version:"+jQuery().jquery:"NOT installed."));var OrderItem=this.OrderItem=function(item){return{pid:{name:"productId",value:getData.call(item,"pid")},sku:{name:"catalogRefId",value:getData.call(item,"sku")},qty:{name:"quantity",value:getData.call(item,"qty","1")<<0},losg:{name:"losgId",value:getData.call(item,"losg","")},parentSku:{name:"parentLosgId",value:getData.call(item,"parentLosgId","")},dataGroup:{name:"dataGroupId",value:getData.call(item,"dataGroupId","")},parentCxid:{name:"parentCommerceItemId",value:getData.call(item,"parentCxid","")}}};var CommerceItem=this.CommerceItem=function(item){return{cxid:{name:"removalCommerceId",value:getData.call(item,"cxid")}}};var AccountItem=this.AccountItem=function(item){return{id:{name:"id",value:getData.call(item,"id")},itemId:{name:"itemId",value:getData.call(item,"itemId")},socCode:{name:"socCode",value:getData.call(item,"socCode")}}};var Item=this.Item=function(item){var itemType=getData.call(item,"itemType");if(itemType==undefined){ATT.log("No data-item-type specified for cartItem "+item.tagName+"#"+item.id)}if(itemType=="OrderItem"||itemType==undefined){var orderItem=new OrderItem(item);if(orderItem.pid.value&&orderItem.sku.value&&orderItem.qty.value){return orderItem}else{ATT.log("Missing OrderItem data-pid, data-sku, or data-qty")}}if(itemType=="CommerceItem"||itemType==undefined){var commerceItem=new CommerceItem(item);if(commerceItem.cxid.value&&commerceItem.cxid.value!="undefined"){return commerceItem}else{ATT.log("Missing CommerceItem data-cxid or data-cxid is undefined")}}if(itemType=="AccountItem"||itemType==undefined){var accountItem=new AccountItem(item);if(accountItem.id.value&&accountItem.itemId.value&&accountItem.socCode.value){return accountItem}else{ATT.log("Missing AccountItem data-id, data-itemId, or data-socCode")}}return null};var getItems=this.getItems=function(target,classes){var items={};var cartItemClass=$(target).data("items")||".cartItem";var removalItemClass=$(target).data("removalItems")||".removeCartItem";var itemGroupClass=$(target).data("itemGroup")||".cartItemGroup";var multiItemClass=$(target).data("multiItem")||".multiCartItem";for(var x in classes){var itemClass=classes[x].replace(".cartItem",cartItemClass).replace(".removeCartItem",removalItemClass);var solo=$(target).parents(itemClass);var group=$(target).parents(itemGroupClass).find(itemClass);var all=$(itemClass).not(itemGroupClass+" "+itemClass);var multi=$(target).parents(itemGroupClass).find(multiItemClass);var selections=solo.length?solo:group.length?group:all;items[x]=[];for(var i=0;i<selections.length;++i){var m=$(selections[i]).parents(multiItemClass).index(),m=~m?m:0;var item=new Item(selections[i]);if(item.constructor!=Item){(items[x][m]=items[x][m]||[]).push(item)}}}return items};var getData=this.getData=function(key,def,val){try{var jsonData=eval($(this).data("json"))||{}}catch(e){var jsonData={}}var hasInput=false;if(val==undefined){var checkbox=$(this).filter(":checkbox[data-"+key+"]").add(":checkbox[data-"+key+"]",this);checkbox.each(function(){hasInput=true;val=this.checked?$(this).data(key):val})}if(val==undefined){var radiobutton=$(this).filter(":radio[data-"+key+"]").add(":radio[data-"+key+"]",this);radiobutton.each(function(){hasInput=true;val=this.checked?$(this).data(key):val})}if(val==undefined){var option=$(this).filter("option[data-"+key+"]").add("option[data-"+key+"]",this);option.each(function(){hasInput=true;val=this.selected?$(this).data(key):val})}if(val==undefined){var textbox=$(this).filter(":text[data-"+key+"]").add(":text[data-"+key+"]",this);textbox.each(function(){hasInput=true;val=this.value?$(this).val():val})}if(val==undefined&&!hasInput){val=$(this).data(key)}if(val==undefined&&!hasInput){val=jsonData[key]}if(val==undefined&&!hasInput){val=def}return val};var curry=function(fn,loadVar){return function(){var args=Array.prototype.slice.call(arguments);args.unshift(loadVar);fn.apply(this,args)}};var executeOrder=this.executeOrder=function(order){ATT.log("items to add...");ATT.log(order.items);if(order.form){var deferredForm=new $.Deferred().resolve(order.form)}else{var deferredForm=getDeferredForm(order.items,order.params)}$.when(deferredForm).done(function(deferredForm){ATT.log("constructing form...");var orderForm=getOrderForm(order.items,deferredForm);ATT.log(decodeURIComponent($(orderForm).serialize()).split("&"));$.post(orderForm.action,$(orderForm).serialize(),curry(callback,order),"json").fail(function(jqXHR,textStatus,errorThrown){ATT.log("ajax error .. triggering Cart Failure");msgResp=$.trim(jqXHR.responseText);$(document).trigger("CartFailure",msgResp);ATT.log(msgResp);ATT.log(textStatus);ATT.log(errorThrown);ATT.log(jqXHR)});ATT.log("form posted.")})};var getDeferredForm=this.getDeferredForm=function(items,params){for(var x in items){for(var y in items[x]){if(!items[x][y].slice){items[x]=[items[x]]}break}for(var m=0,lengths=[];m<items[x].length;m++){lengths[m]=(!!items[x][m])?items[x][m].length:0}params+="&"+x+"="+lengths}commitmentTermSelect=jQuery(".priceBlock #commitmentTerm");if(!commitmentTermSelect.length){commitmentTermSelect=jQuery('.priceBlock select[id="commitmentTerm"]')}if(commitmentTermSelect&&commitmentTermSelect.length){params+=("&commitmentTerm="+commitmentTermSelect.val())}var deferredForm=$.get(ATT.CartSummary.cartPagePath+"/jcr:content/cart.buildform.xhr.html?"+params);return deferredForm.promise()};var getOrderForm=this.getOrderForm=function(items,form){var orderForm=$(form)[0];for(var x in items){var inputs=$(orderForm).find("input[id*="+x+'][value=""]');if(inputs.length){for(var m=0;m<items[x].length;m++){for(var i=0;i<((!!items[x][m])?items[x][m].length:0);++i){for(var param in items[x][m][i]){var thisInput=$(inputs).filter("#"+m+"-"+x+i+"-"+items[x][m][i][param].name);if(thisInput.length){thisInput[0].value=items[x][m][i][param].value}}}}}}return orderForm};var callback=this.callback=function(order,json,textStatus,jqXHR){if(typeof order!="undefined"){json.originatingOrder=order}ATT.log("callback status: "+(json.status.toLowerCase()||textStatus));$(document).trigger("CartCallback",json);if(/undefined|exception|failure/i.test(json.status)){$(document).trigger("CartFailure",json)}else{if(/error|replace|remove|empty_cart/i.test(json.status)){$(document).trigger("CartConflict",json)}else{if(/hard_stop/i.test(json.status)){$(document).trigger("CartHardStop",json)}else{$(document).trigger("CartSuccess",json)}}}};var onCartHardStop=function(event,json){var nextStep=json.data.wirelessAddToCartResultHolder.nextStepURL||json.successUrl||"";ATT.log("hard stop url: "+nextStep);if(nextStep){location.href=nextStep}return true};var onCartSuccess=function(event,json){var successFunc=$(event.data).data("successFunc")||$(event.data).data("success-func");var successUrl=$(event.data).data("successUrl")||$(event.data).data("success-url")||json.successUrl;ATT.log("success url: "+successUrl);if(successFunc){eval(successFunc+"()");return true}else{if(successUrl){location.href=successUrl}}return true};var Order=this.Order=function(target,classes){target.hijacked=new $.Deferred();$(document).bind("CartSuccess",target,onCartSuccess);$(document).bind("CartHardStop",target,onCartHardStop);var executor=function(){executeOrder(order)};var order={originatingTarget:target,items:getItems(target,classes),params:$(target).data("extraParams")||$(target).data("extra-params"),form:$(target).data("useForm")||$(target).data("use-form"),execute:function(){$.when(target.hijacked).done(executor)}};var i=0;processHijacks(i,target,order);return order};var cartTrigger=this.cartTrigger=function(dfd,target,order){$(document).trigger("CartTrigger",[target,order]);dfd.resolve();$(document).trigger("CartTriggerDone",[target,order])};var hijacks=this.hijacks=[{index:9999,name:"cartTrigger",process:cartTrigger}];var hijack=this.hijack=function(index,name,fn){hijacks.push({index:index,name:name,process:fn})};var removeHijacksByName=this.removeHijacksByName=function(name){for(h in hijacks){if(hijacks[h].name==name){delete hijacks[h]}}};var customerIntentModal=this.customerIntentModal=function(dfd,target,order){var thisDfd=dfd,commitmentTermSelect=jQuery(".priceBlock #commitmentTerm");if(!commitmentTermSelect.length){commitmentTermSelect=jQuery('.priceBlock select[id="commitmentTerm"]')}if(commitmentTermSelect&&commitmentTermSelect.length){ATT.globalVars.cartContents.commitmentTerm=commitmentTermSelect.val()}jQuery.when(reporting_ready).done(function(){if(ATT.globalVars.cartContents.isDataOnlyDevice===true){ATT.globalVars.cartContents.modalSteps=0;if(ATT.globalVars.cartContents.buyFlowTypeShown===false){if(ATT.globalVars.cartContents.authenticated==="authenticated"&&ATT.globalVars.cartContents.wirelessAuthenticated===true){ATT.globalVars.cartContents.modalSteps+=1}else{if(ATT.globalVars.cartContents.authenticated!=="authenticated"){ATT.globalVars.cartContents.modalSteps+=1}}}if(ATT.globalVars.cartContents.isDeviceOnly===true&&ATT.globalVars.cartContents.commitmentTerm==="1"&&ATT.globalVars.cartContents.isMobileShareInCart===false){ATT.globalVars.cartContents.modalSteps+=2}var modalURL="/shop/wireless/modals/shopmodals/jcr:content/mainpar/customertypedeviceon.html";if(window.location.pathname.match(/\/es\//)){modalURL="/shop/es/wireless/modals/shopmodals/jcr:content/mainpar/customertypedeviceon.html"}switch(ATT.globalVars.cartContents.modalSteps){case 1:jQuery.colorbox({iframe:false,scrolling:false,width:700,height:400,href:modalURL+"?steps="+ATT.globalVars.cartContents.modalSteps+"&deviceSku="+ATT.globalVars.cartContents.deviceSku});jQuery("#continue").live("click",function(){thisDfd.resolve()});break;case 2:jQuery.colorbox({iframe:false,scrolling:false,width:700,height:310,href:modalURL+"?steps="+ATT.globalVars.cartContents.modalSteps+"&deviceSku="+ATT.globalVars.cartContents.deviceSku});jQuery("#dataPlan, #wifiOnly").live("click",function(){thisDfd.resolve()});break;case 3:jQuery.colorbox({iframe:false,scrolling:false,width:700,height:400,href:modalURL+"?steps="+ATT.globalVars.cartContents.modalSteps+"&deviceSku="+ATT.globalVars.cartContents.deviceSku});jQuery("#dataPlan, #wifiOnly").live("click",function(){thisDfd.resolve()});break;default:thisDfd.resolve()}}else{if(ATT.globalVars.cartContents.buyFlowTypeShown==false&&!(ATT.globalVars.cartContents.isAccessoriesInCart==true&&window.location.pathname.match(/\/cart\//))){if(ATT.globalVars.cartContents.authenticated==true&&ATT.globalVars.cartContents.wirelessAuthenticated==false){thisDfd.resolve()}else{if(window.location.pathname.match(/\/es\//)){jQuery.colorbox({iframe:false,scrolling:false,width:705,height:300,href:"/shop/es/wireless/modals/shopmodals/jcr:content/mainpar/customertype.xhr.html"})}else{jQuery.colorbox({iframe:false,scrolling:false,width:705,height:300,href:"/shop/wireless/modals/shopmodals/jcr:content/mainpar/customertype_0.xhr.html"})}jQuery("#addaline, #continue, #upgrades").live("click",ATT.ShoppingCart.buyFlowTypeShown);jQuery("#continue").live("click",function(){thisDfd.resolve()})}}else{thisDfd.resolve()}}})};var processHijacks=function processHijacks(index,target,order){hijacks=hijacks.sort(by.property("index",+1));var priorityDfd=new $.Deferred();var thisTarget=target;var thisOrder=order;var thisIndex=index;if(typeof hijacks[index]!="object"){priorityDfd.resolve()}else{hijacks[index].process(priorityDfd,thisTarget,thisOrder)}$.when(priorityDfd).done(function(){thisIndex++;if(thisIndex<hijacks.length){processHijacks(thisIndex,thisTarget,thisOrder)}else{thisTarget.hijacked.resolve()}})};$(".addToCart").live("click",function(e){$(document).trigger("CartTriggerStart",[target,order]);ATT.log("addToCart button clicked.");var target=e.currentTarget;var order=new Order(target,{items:".cartItem"});if(ATT.globalVars.cartContents.modalSteps>1){$("#dataPlan").live("click",{ord:order},function(e){e.data.ord.params+=("&commitmentTerm=1");e.data.ord.execute()});$("#wifiOnly").live("click",{ord:order},function(e){e.data.ord.params+=("&commitmentTerm=0");e.data.ord.execute()})}else{if(typeof ATT.globalVars.cartContents.commitmentTerm!=="undefined"){order.params+=("&commitmentTerm="+ATT.globalVars.cartContents.commitmentTerm)}order.execute()}});$(".removeFromCart").live("click",function(e){$(document).trigger("CartTriggerStart",[target,order]);var target=e.currentTarget;var order=new Order(target,{removalCommerceIds:".removeCartItem"});order.execute()});$(".removeFromCartSummary").live("click",function(e){$(document).trigger("CartTriggerStart",[target,order]);var target=e.currentTarget;var order=new Order(target,{RemovalCommerceIds:".removeCartItem"});order.execute()});$(".replaceCart").live("click",function(e){$(document).trigger("CartTriggerStart",[target,order]);var target=e.currentTarget;var order=new Order(target,{items:".cartItem:not([data-type])",wirelessPackageItems:".cartItem[data-type=package]",deviceItem:".cartItem[data-type=device]",planItem:".cartItem[data-type=plan]",requiredServices:".cartItem[data-type=service][data-required=true]",optionalServices:".cartItem[data-type=service]:not([data-required=true])",requiredAccessories:".cartItem[data-type=accessory][data-required=true]",optionalAccessories:".cartItem[data-type=accessory]:not([data-required=true])",removalCommerceIds:".removeCartItem",accountItemsToBeRemoved:".removeAccountItem"});var removeConfirm=$(target).data("removeConfirm")||$(target).data("remove-confirm");if(removeConfirm){order.params+="&removeConfirm="+removeConfirm}commitmentTermSelect=jQuery(".priceBlock #commitmentTerm");if(!commitmentTermSelect.length){commitmentTermSelect=jQuery('.priceBlock select[id="commitmentTerm"]')}if(commitmentTermSelect&&commitmentTermSelect.length){order.params+=("&commitmentTerm="+commitmentTermSelect.val())}order.execute()});$(".addPackageToCart").live("click",function(e){$(document).trigger("CartTriggerStart",[target,order]);var target=e.currentTarget;var order=new Order(target,{wirelessPackageItems:".cartItem[data-type=package]",deviceItem:".cartItem[data-type=device]",planItem:".cartItem[data-type=plan]",requiredServices:".cartItem[data-type=service][data-required=true]",optionalServices:".cartItem[data-type=service]:not([data-required=true])",requiredAccessories:".cartItem[data-type=accessory][data-required=true]",optionalAccessories:".cartItem[data-type=accessory]:not([data-required=true])"});commitmentTermSelect=jQuery(".priceBlock #commitmentTerm");if(!commitmentTermSelect.length){commitmentTermSelect=jQuery('.priceBlock select[id="commitmentTerm"]')}if(commitmentTermSelect&&commitmentTermSelect.length){order.params+=("&commitmentTerm="+commitmentTermSelect.val())}order.execute()});$(".noThanksCart").live("click",function(e){$(document).trigger("CartTriggerStart",[target,order]);var target=e.currentTarget;var order=new Order(target,{});order.params+="&noThanks=true";order.execute()});var buyFlowTypeShown=this.buyFlowTypeShown=function(){$.ajax({async:false,url:ATT.CartSummary.cartPagePath+"/jcr:content/cart.buyflowtypeshown.xhr.html"})}});ATT.FEM.add("SHOPERR_ATC_EXCEPTION",ATT.FEM.display.dialogBox);ATT.FEM.add("W_SC_121",ATT.FEM.display.dialogBox);ATT.FEM.add("W_SC_318",ATT.FEM.display.dialogBox);jQuery(document).ready(function(){ATT.ShoppingCart.hijack(0,"customerTypeModal",ATT.ShoppingCart.customerIntentModal)});ATT.namespace("CartSummary");ATT.CartSummary=new function(){var w=this.cartPagePath=(window.location.pathname.match(/\/es\//))?"/shop/es/cart/cartsummary":"/shop/cart/cartsummary";var F=this.employeeCallback=function(I,K,L,M){var J=L;if(!!J&&!!J.data){J.data.employeeId=I}if(L.status=="success"){ATT.log("employeeCallback -- success");jQuery("#cart-container").load(w+"/jcr:content/cart.xhr.html",function(){c(J);if(K){jQuery("#coupon-code-input").val(K);ATT.FEM.display.inline("","",{selector:"#coupon-field-group"},false)}})}else{ATT.log("employeeCallback -- failure");y(J)}};var p=this.couponCallback=function(I,K,L,M){var J=L;if(!!J&&!!J.data){J.data.promoCode=I}if(L.status=="success"){ATT.log("couponCallback -- success");jQuery("#cart-container").load(w+"/jcr:content/cart.xhr.html",function(){c(J);if(K){jQuery("#employee-refid-input").val(K);ATT.FEM.display.inline("","",{selector:"#employee-referral-field-group"},false)}})}else{ATT.log("couponCallback -- failure");jQuery("#coupon-code-input").val(J.data.promoCode);y(J)}};var b=this.shippingCallback=function(K,J,L,M){var I=L;if(L.status=="success"){ATT.log("shippingCallback -- success");jQuery("#cart-container").load(w+"/jcr:content/cart.xhr.html",function(){c(I);if(J){jQuery("#employee-refid-input").val(J);ATT.FEM.display.inline("","",{selector:"#employee-referral-field-group"},false)}if(K){jQuery("#coupon-code-input").val(K);ATT.FEM.display.inline("","",{selector:"#coupon-field-group"},false)}})}else{ATT.log("shippingCallback -- failure");y(I)}};var t=this.cartSummaryCallback=function(I,K,L){var J=K;if(!!K.url){I=K.url}if(K.status=="success"){ATT.log("cartSummaryCallback -- success");if(I){location.href=I}else{jQuery("#cart-container").load(w+"/jcr:content/cart.xhr.html",function(){c(J)})}}else{ATT.log("cartSummaryCallback -- failure");y(J)}};var y=this.handleCartException=function(I){jQuery(document).trigger("FormResponseReturned",I);if(jQuery.browser.msie){jQuery("#cart-container").css("zoom",1)}ATT.modalSpinner.close();jQuery.colorbox.close()};var c=this.handleCartLoaded=function(I){ATT.log("inside handleCartLoaded");if(jQuery("#checkout-btn-enabled-bottom").length>0){ATT.log("enable checkout button");jQuery("#checkout-btn-enabled-top").show();jQuery("#checkout-btn-disabled-top").hide()}else{ATT.log("disable checkout button");jQuery("#checkout-btn-enabled-top").hide();jQuery("#checkout-btn-disabled-top").show()}jQuery.fn.morphForms();if(jQuery.browser.msie){jQuery("#cart-container").css("zoom",1)}if(!!I){jQuery(document).trigger("FormResponseReturned",I)}ATT.modalSpinner.close();jQuery.colorbox.close()};var C=this.reloadCartContainer=function(){ATT.log("inside reloadCartContainer()");var J=jQuery("#coupon-code-input").val()||"";var I=jQuery("#employee-refid-input").val()||"";if(!jQuery("#cart-container").length){ATT.modalSpinner.close();jQuery.colorbox.close();ATT.CartSummary.showCartPreview();return false}jQuery("#cart-container").load(w+"/jcr:content/cart.xhr.html",function(){c(false);if(I){jQuery("#employee-refid-input").val(I);ATT.FEM.display.inline("","",{selector:"#employee-referral-field-group"},false)}if(J){jQuery("#coupon-code-input").val(J);ATT.FEM.display.inline("","",{selector:"#coupon-field-group"},false)}})};var u=this.applyEmployeeReferral=function(J){referEmployeeForm=jQuery("#ReferEmployeeForm");jQuery("#employee-referal-id").val(encodeURIComponent(jQuery.trim(J)));var I=jQuery("#coupon-code-input").val()||"";ATT.modalSpinner.show();jQuery.post(referEmployeeForm.attr("action"),referEmployeeForm.serialize(),ATT.util.curry(F,J,I),"json")};var G=this.applyCoupon=function(K){var J=jQuery("#ApplyCouponForm");var I=jQuery("#employee-refid-input").val()||"";jQuery(".coupon-claim-code").val(encodeURIComponent(jQuery.trim(K)));ATT.modalSpinner.show();jQuery.post(J.attr("action"),J.serialize(),ATT.util.curry(p,K,I),"json");document.getElementById("coupon-code-input").value=""};var e=this.removeCouponCode=function(I){var K=jQuery("#RemoveCouponForm");ATT.modalSpinner.show();jQuery("#remove-coupon-code").val(I);var J=jQuery("#employee-refid-input").val()||"";jQuery.post(K.attr("action"),K.serialize(),ATT.util.curry(p,I,J),"json")};var A=this.removeCouponPromo=function(I){var J=jQuery("#RemoveCouponPromotionForm");ATT.modalSpinner.show();jQuery("#remove-promotion-id").val(I);var K=jQuery("#employee-refid-input").val()||"";jQuery.post(J.attr("action"),J.serialize(),ATT.util.curry(p,I,K),"json")};var o=this.removeEmployeeReferral=function(){var I=jQuery("#RemoveEmployeeReferralForm");ATT.modalSpinner.show();var K=jQuery("#employeeId").html();var J=jQuery("#coupon-code-input").val()||"";jQuery.post(I.attr("action"),I.serialize(),ATT.util.curry(F,K,J),"json")};var H=this.editCouponCode=function(){jQuery(".already-entered").toggle();jQuery("#enter-coupon-line").toggle()};var i=this.addOrChange=function(J,I){jQuery("#addOrChangeLosgId").val(I);ATT.modalSpinner.show();var K=jQuery("#AddOrChangeCommerceItem");jQuery.post(K.attr("action"),K.serialize(),ATT.util.curry(t,J),"json")};var d=this.addOrChangePlan=function(K,J){jQuery("#addOrChangePlanLosgId").val(J);ATT.modalSpinner.show();var I=jQuery("#AddOrChangePlan");jQuery.post(I.attr("action"),I.serialize(),ATT.util.curry(t,K),"json")};var f=this.viewCommerceItemDetail=function(J,I){jQuery("#viewCommerceItemDetailLosgId").val(I);ATT.modalSpinner.show();var K=jQuery("#viewCommerceItemDetail");jQuery.post(K.attr("action"),K.serialize(),ATT.util.curry(t,J),"json")};var s=this.addALine=function(){var I=jQuery("#AddALineForm");ATT.modalSpinner.show();jQuery.post(I.attr("action"),I.serialize(),ATT.util.curry(t,""),"json")};var D=this.addAnAccessory=function(){var I=jQuery("#AddAnAccessoryForm");ATT.modalSpinner.show();jQuery.post(I.attr("action"),I.serialize(),ATT.util.curry(t,""),"json")};var j=this.selectShippingMethod=function(){jQuery("#shippingMethod").val(jQuery("#shipping-select").val());ATT.modalSpinner.show();var I=jQuery("#ShippingMethodForm");var K=jQuery("#coupon-code-input").val()||"";var J=jQuery("#employee-refid-input").val()||"";jQuery.post(I.attr("action"),I.serialize(),ATT.util.curry(b,K,J),"json")};var g=this.simulateOverLayClick=function(I){I=I?I:window.event;var J=I.target?I.target:I.srcElement;if(!jQuery(J).is("#cart-preview-container *")){ATT.CartSummary.hideCartPreview()}};var z=this.hideCartPreview=function(){jQuery("#cart-preview-container").hide();jQuery(document).unbind("click",ATT.CartSummary.simulateOverLayClick)};var k=this.showCartPreview=function(){ATT.log("inside showCartPreview()");ATT.log("loading ... "+w+"/jcr:content/cart.previewcart.xhr.html");ATT.util.ajaxSpinner(true,{selector:"#cart-preview-container"});jQuery("#cart-preview-container").show().load(w+"/jcr:content/cart.previewcart.xhr.html",function(){jQuery("#cart-preview-container").css("width",ATT.globalVars.cartContents.cartIsEmpty?"332px":"575px");jQuery(document).bind("click",ATT.CartSummary.simulateOverLayClick);if(jQuery.browser.msie){jQuery("#cart-preview-container").css("border","1px solid #ccc");jQuery("#cart-preview-container").prepend('<div class="topRound"><div></div></div>').append('<div class="bottomRound"><div></div></div>')}})};var a=this.loadMiniCart=function(){ATT.log("getting minicart");jQuery.when(ATT.globalVars.cartPromise).done(function(){var I=ATT.globalVars.cartContents;if(I&&I.miniCartInfo){if(I.miniCartInfo.data.commerceItemsCount>0){jQuery("#minicart-count").html("("+I.miniCartInfo.data.commerceItemsCount+")")}else{if(I.miniCartInfo.data.existingCustomer=="true"){jQuery("#minicart-link").attr("onclick","");jQuery("#minicart-link").attr("href",I.miniCartInfo.url)}}}})};var E=this.miniCartCallback=function(I){ATT.log("minicart response returned from server");if(I.data.commerceItemsCount>0){jQuery("#minicart-count").html("("+I.data.commerceItemsCount+")")}else{if(I.data.existingCustomer=="true"){jQuery("#minicart-link").attr("onclick","");jQuery("#minicart-link").attr("href",I.url)}}};var r=this.showCartBubble=function(){jQuery.when(ATT.globalVars.cartPromise).done(function(){var J=ATT.globalVars.cartContents;if(J&&J.showCartBubble){ATT.log("inside showCartBubble()");ATT.log("loading ... "+w+"/jcr:content/cart.cartbubble.xhr.html");var I=jQuery("#cart-bubble-container");I.load(w+"/jcr:content/cart.cartbubble.xhr.html",function(K,M,L){if(M==="success"){ATT.log("cart bubble loaded from server");jQuery("#minicart-link").poshytip({content:I.html(),className:"tip-white",alignTo:"target",alignX:"center",alignY:"bottom",offsetX:0,offsetY:-8,allowTipHover:true,bgImageFrameSize:6,backgroundGradient:"//www.att.com/images/global/tooltip/tip-white/backgroundwhite.gif",fade:false,slide:true});jQuery("#minicart-link").poshytip("show")}else{ATT.log("cart bubble load request status: "+M);ATT.log("cart bubble load response text: "+K);ATT.log(L)}})}})};var m=this.closeCartBubble=function(){ATT.log("inside closeCartBubble()");jQuery("#minicart-link").poshytip("hide").poshytip("disable")};var v=this.showExistingEquipmentModal=function(I){jQuery.colorbox({iframe:false,scrolling:false,width:"705px",innerWidth:"680px",onComplete:function(){jQuery.colorbox.resize();jQuery.fn.morphForms()},href:I})};var l=this.updateIMEI=function(I,J){jQuery("#changeIMEINumber").val(J);jQuery("#changeIMEILosgId").val(I);var K=jQuery("#UpdateIMEIForm");ATT.modalSpinner.show();jQuery.post(K.attr("action"),K.serialize(),ATT.util.curry(t,""),"json")};var q=this.getJSON=function(){return jQuery.getJSON(w+"/jcr:content/cart.cartcontent.xhr.json")};var B=this.showRemoveLineConfirmModal=function(I){thisLosgId=I;jQuery("#confirm-remove-line-continue-btn").click(function(){jQuery("#removeLosgId").val(thisLosgId);jQuery("#RemoveLineForm").submit();return false});jQuery.colorbox({inline:true,href:"#remove-line-interstitial",innerWidth:"505px",innerHeight:"270px"})};var n=this.showCancelConfirmModal=function(I){thisLosgId=I;jQuery("#confirm-remove-line-continue-btn").click(function(){jQuery("#CancelUpgradeForm-removeLosgId").val(thisLosgId);jQuery("#CancelUpgradeForm input[type=submit]").click();return false});jQuery.colorbox({inline:true,href:"#remove-line-interstitial",innerWidth:"505px",innerHeight:"270px"})}};jQuery(document).ready(function(){if(jQuery("#minicart-link").size()>0){ATT.CartSummary.loadMiniCart();ATT.CartSummary.showCartBubble();setTimeout(function(){ATT.CartSummary.closeCartBubble()},5000)}});ATT.namespace("sA");ATT.sA={steps:[],headerText:"",footerText:"",footerUrl:"",stepText:[],editText:[],editingText:[],editUrl:[],completeTxt:[],step:"div#shopping-assistant ol li.step",itemCountTag:[],hasReqServices:"false",init:function(){ATT.sA.steps=shoppingAssistant.steps;ATT.sA.setSteps();ATT.sA.formEventsBind()},formEventsBind:function(){if(jQuery("#addLineNewLink").length){jQuery("#addLineNewLink").click(function(){jQuery("#addaline").click();return false})}if(jQuery("#upgradeLinkNew").length){jQuery("#upgradeLinkNew").click(function(){jQuery("#upgrades").click();return false})}if(jQuery("#addAnotherLineNew").length){jQuery("#addAnotherLineNew").click(function(){jQuery("#AddALineForm input[type=submit]").click();return false})}},setCompletedText:function(a){if(ATT.sA.steps[a].itemCount>1){(function(b){ATT.sA.itemCountTag[b]=jQuery("<span/>",{text:" ("+ATT.sA.steps[b].itemCount+")",className:"item-count"})})(a);ATT.sA.completeTxt[a]=ATT.sA.stepText[a]}else{if(ATT.sA.steps[a].displayName!==null&&ATT.sA.steps[a].displayName!==""){ATT.sA.completeTxt[a]=ATT.sA.steps[a].displayName}else{ATT.sA.completeTxt[a]=ATT.sA.stepText[a]}}},setSteps:function(){var c=ATT.sA.steps,d,b;for(d=0,b=c.length;d<b;++d){stepNum=d+1;switch(c[d].stepName){case"Device":ATT.sA.stepText[d]=sAStrings.optionsTxt.selectdevicepackageoption;ATT.sA.editText[d]=sAStrings.optionsTxt.changedeviceoption;ATT.sA.editingText[d]=sAStrings.optionsTxt.changingdeviceoption;ATT.sA.editUrl[d]=shoppingAssistant.detailListUrl;break;case"Plan":ATT.sA.stepText[d]=sAStrings.optionsTxt.selectaplanoption;ATT.sA.editText[d]=sAStrings.optionsTxt.changeplansoption;ATT.sA.editingText[d]=sAStrings.optionsTxt.changingplansoption;ATT.sA.editUrl[d]=shoppingAssistant.plansListURL;break;case"Services":ATT.sA.stepText[d]=sAStrings.optionsTxt.planaddonsoption;ATT.sA.editText[d]=sAStrings.optionsTxt.changeservicesoption;ATT.sA.editingText[d]=sAStrings.optionsTxt.changingservicesoption;ATT.sA.editUrl[d]=shoppingAssistant.servicesURL;if(c[d].hasAllRequired=="true"){ATT.sA.hasReqServices="true"}break;case"Accessories":ATT.sA.stepText[d]=sAStrings.optionsTxt.addaccessoriesoption;ATT.sA.editText[d]=sAStrings.optionsTxt.changeaccessoriesoption;ATT.sA.editingText[d]=sAStrings.optionsTxt.changingaccessoriesoption;ATT.sA.editUrl[d]=shoppingAssistant.accessoriesURL;break;case"Package":ATT.sA.stepText[d]=sAStrings.optionsTxt.configureyourpackage;ATT.sA.editText[d]=sAStrings.optionsTxt.changepackage;ATT.sA.editingText[d]=sAStrings.optionsTxt.changingpackage;ATT.sA.editUrl[d]=shoppingAssistant.packagesListURL;break;default:break}ATT.sA.setCompletedText(d);ATT.sA.helperFn.setStepLink({stepName:c[d].stepName,editTxt:ATT.sA.editText[d],editURL:ATT.sA.editUrl[d],compTxt:ATT.sA.completeTxt[d],complete:c[d].complete,showAsComplete:c[d].showAsComplete,nextIncompleteStep:ATT.sA.steps[d].nextIncompleteStep,stepText:ATT.sA.stepText[d],highlight:c[d].highlight,itemCountTag:ATT.sA.itemCountTag[d]});if(c[d].complete=="true"||c[d].showAsComplete=="true"){jQuery(ATT.sA.step+"#step-"+stepNum).addClass("completed");if(c[d].highlight=="true"&&c[d].itemCount>0){jQuery(ATT.sA.step+"#step-"+stepNum).find("span").text(ATT.sA.editingText[d])}else{if(c[d].itemCount>1){jQuery(ATT.sA.step+"#step-"+stepNum).find("span").text(ATT.sA.completeTxt[d]).append(ATT.sA.itemCountTag[d])}else{if(ATT.sA.steps[d].highlight=="true"){var a=ATT.sA.completeTxt[d].substring(0,30).split(" ").slice(0,-1).join(" ")+"...";jQuery(ATT.sA.step+"#step-"+stepNum).find("span ").text(a)}else{jQuery(ATT.sA.step+"#step-"+stepNum).find("span").text(ATT.sA.completeTxt[d])}}}}else{if((c[d].stepName!=="Device"&&ATT.sA.steps[d].nextIncompleteStep=="false")||ATT.sA.steps[d].highlight=="true"){if(ATT.sA.completeTxt[d]==ATT.sA.steps[d].displayName){jQuery(ATT.sA.step+"#step-"+stepNum).find("span").text(ATT.sA.completeTxt[d])}else{jQuery(ATT.sA.step+"#step-"+stepNum).find("span ").text(ATT.sA.stepText[d])}}else{}}if(c[d].highlight=="true"){jQuery(ATT.sA.step+"#step-"+stepNum).addClass("active");jQuery(ATT.sA.step+"#step-"+stepNum).find("div").css("background-image","none");jQuery(ATT.sA.step+".active ~ li").addClass("belowActive")}else{}}},helperFn:{populatePackageConfig:function(){var c=jQuery("#optionalAccessories");var b=jQuery("#optionalPlanServices");var a=jQuery("#saPackageItems");a.html("");var e=jQuery(".buildpackagetab input[type=radio]:visible").filter(":checked").map(function(g,m){if(typeof jQuery(m).data("displayname")=="undefined"){return}var n=jQuery(m).data("sku")||jQuery(m).closest(".cartItem").data("sku");var j=jQuery("#mrc_for_"+n).html();var l=jQuery("<span class='configPrice'><span class='orange'>"+j+"</span>/mo</span>");var k=jQuery("<span class='displayName'>"+jQuery(m).data("displayname")+"</span>");var f=jQuery("<a href='#' class='saPackageConfigurable saPackageItem'></a>");if(!j){l=null;k.addClass("fullWidth")}f.append(k);f.append(l);f.data("relatedElement",jQuery(m).closest(".box"));f.click(function(){jQuery(window).scrollTop(jQuery(this).data("relatedElement").offset().top-10);return false});return f}).each(function(f,g){a.append(g)});var d=jQuery(".checkmarkImg:visible").map(function(g,j){if(typeof jQuery(j).data("displayname")=="undefined"){return}var f=jQuery("<div class='saPackageIncluded saPackageItem'>"+jQuery(j).data("displayname")+"</div>");return f}).each(function(f,g){a.append(g)});if(c.length){jQuery("#addOptionalAccessories").unbind("click");jQuery("#addOptionalAccessories").click(function(){jQuery(window).scrollTop(c.offset().top);return false})}else{jQuery("#addOptionalAccessories").hide()}if(b.length){jQuery("#addOptionalServices").unbind("click");jQuery("#addOptionalServices").click(function(){jQuery(window).scrollTop(b.offset().top);return false})}else{jQuery("#addOptionalServices").hide()}if(!c.length&&!b.length){jQuery(".saPackageLinks").hide()}},setStepLink:function(b){function d(g,j,i){var f=jQuery("<a/>",{href:g,text:j,className:i});return f}if((b.complete=="true"||b.showAsComplete=="true")&&b.highlight=="false"){var c=d(b.editURL,b.editTxt,"edit-link");var a=jQuery(ATT.sA.step+"#step-"+stepNum).find("span");var e;jQuery(ATT.sA.step+"#step-"+stepNum).hover(function(){jQuery(this).addClass("changing");e=a.height();a.empty().append(c);if(e>38){a.height(e)}},function(){jQuery(this).removeClass("changing");a.text(b.compTxt);a.append(b.itemCountTag)})}else{if(b.nextIncompleteStep=="true"&&b.highlight=="false"||(b.stepName=="Device"&&b.highlight=="false"&&b.complete=="false")){var c=d(b.editURL,b.stepText);jQuery(ATT.sA.step+"#step-"+stepNum).find("span").empty().append(c);jQuery(ATT.sA.step+"#step-"+stepNum).addClass("next-step")}else{}}}}};ATT.namespace("sessionExpire");ATT.sessionExpire.refreshSession=function(){jQuery("#sessionExpire").css("display","none");window.clearTimeout(ATT.sessionExpire.informTimeout);window.clearTimeout(ATT.sessionExpire.warnTimeout);jQuery.get(templateSelector("ping.xhr"));ATT.sessionExpire.init()};ATT.sessionExpire.init=function(){var e,a,i,d,j,f,c,b,g;e=30;a=5;i=e*1000*60;d=a*1000*60;ATT.sessionExpire.warn=function(){var l,k,m;l=!(ATT.globalVars.cartContents.miniCartInfo.data.commerceItemsCount/1);k=ATT.globalVars.cartContents.authState=="authenticated";m=k?"authWarn":"unauthWarn";if(l&&!k){return}jQuery("#sessionExpireSaveCart").click(function(){jQuery("#sessionExpire").css("display","none")});jQuery("#sessionExpireSaveCart").toggle(!l);jQuery("#sessionExpire .scenarioContent").css("display","none");jQuery("#sessionExpire ."+m).css("display","block");jQuery("#sessionExpire").css("display","block");jQuery("#sessionExpire .inlineModalHeader").addClass("modalHeader");jQuery("#sessionExpire .inlineModalContent").addClass("modalContent");jQuery.colorbox({inline:true,width:700,href:"#sessionExpire",overlayClose:false,scrolling:false,onComplete:function(){jQuery.colorbox.resize()}})};ATT.sessionExpire.inform=function(){var m,l,k;m=!(ATT.globalVars.cartContents.miniCartInfo.data.commerceItemsCount/1);l=ATT.globalVars.cartContents.authState=="authenticated";k=l?"authExpire":"unauthExpire";if(m&&!l){return}jQuery("#sessionExpire .scenarioContent").css("display","none");jQuery("#sessionExpire ."+k).css("display","block");jQuery("#sessionExpire .inlineModalHeader").addClass("modalHeader");jQuery("#sessionExpire .inlineModalContent").addClass("modalContent");jQuery("#sessionExpire").css("display","block");jQuery.colorbox({inline:true,width:700,href:"#sessionExpire",overlayClose:false,scrolling:false,onComplete:function(){jQuery.colorbox.resize()}})};ATT.sessionExpire.warnTimeout=window.setTimeout(ATT.sessionExpire.warn,i-d);ATT.sessionExpire.informTimeout=window.setTimeout(ATT.sessionExpire.inform,i)};jQuery(function(){ATT.sessionExpire.init()});ATT.namespace("modalSpinner");ATT.modalSpinner=new function(){var c=jQuery;var b=false;var a=this.show=function a(e,f,j){if(!b){b=true;var e=e||"body";var f=f||20000;var j=j||10000;var i=(e=="body")?"fixed":"absolute";c(e).append('<div id="modal-spinner" style="position:'+i+";left:0;top:0;width:100%;height:100%;background-color:white;z-index:"+j+';">&nbsp;</div>');c("#modal-spinner").fadeTo(0,0.5);ATT.util.ajaxSpinner(true,{selector:"#modal-spinner"});c("#modal-spinner div").css("position","relative");var g=setTimeout(d,f);c("select, radio").hide();ATT.log("showing modalSpinner.");if(typeof window.lpSendData=="function"){lpSendData("page","modalFlag","on")}}else{ATT.log("modalSpinner already alive, ignoring.")}};var d=this.close=function d(){if(b){c("select, radio").show();ATT.util.ajaxSpinner(false,{selector:"#modal-spinne"});c("#modal-spinner").remove();ATT.log("modalSpinner closed.");if(typeof window.lpSendData=="function"){lpSendData("page","modalFlag","off")}}else{ATT.log("modalSpinner not alive therefore nothing to close. ignoring.")}b=false}};jQuery(document).bind("CartFailure CartConflict cbox_complete",function(){ATT.modalSpinner.close()});jQuery(document).bind("CartTriggerStart",function(){ATT.modalSpinner.show()});