(function(f,g,j,h){var i=(function(a){a.Personalization=(function(){var aO=[2],ap="",aC=false,ao="",aB="";var aH=true;var au=true;var aG=new Array(0);var aD=false;var ag=(propertyValues.reviewsMasterSwitch=="ON")?true:false;var d=new Object();var aA="<h4 class='a200'>{HEADLINE}</h4><div class='perpage'>{PAGES}</div><div class='b201'>{CURRENTHTML}<div>{CONTENT}</div></div>";function an(k){k.data("prevButton",k.find("div.prevButton a:first"));k.data("nextButton",k.find("div.nextButton a:first"));k.data("prevButton").click(function(l){l.preventDefault();aN(k,0,-1);});k.data("nextButton").click(function(l){l.preventDefault();aN(k,0,1);});k.data("nextButton").mouseover(function(){ah(k,0,1);});}function aK(l){var n,m="",k;l.data("pageStatus").find("li a").click(function(o){o.preventDefault();m=j(this).html();k=parseInt(m);n=l.data("currentPage");if(k==n||m=="&#133;"){return false;}aN(l,k,0);});l.data("pageStatus").find("li a").mouseover(function(){m=j(this).html();k=parseInt(m);n=l.data("currentPage");if(k==n||m=="&#133;"){return false;}ah(l,k,0);});}function ab(l){var m=1,o=l.data("maxpages"),k='<ul class="pageStatus">',n='<li class="ellipsis" style="display:none"><a href="#">&#133;</a></li>';if(o<2){return false;}k+='<li class="first active"><a href="#">1</a></li>';k+=n;for(m=2;m<o;m++){k+='<li><a href="#">'+m+"</a></li>";}k+=n;k+='<li class="last"><a href="#">'+m+"</a></li>";k+='</ul><span class="note"></span>';l.data("pageStatus",l.find("div.perpage:first"));l.data("pageStatus").html(k);aS(l);aK(l);if(o>10){at(l);}}function c(){aB=Math.floor(Math.random()*1000000000000000)+"";var m=new Date();var l=m.getFullYear()+"";var k=(m.getMonth()+1)+"";var n=m.getDate()+"";var o=m.getHours()+"";aB="res"+l.substring(2)+aq(k,2)+aq(n,2)+aq(o,2)+aB;return aB;}function aR(){if(aB){return aB;}else{return c();}}function aS(l){var k,o=l.data("carwide"),n=l.data("currentPage"),m,q,p;p=(o*n)-1;m=p-o+1;if(p>l.data("size")-1){p=l.data("size")-1;}if(l.attr("id")==="item_box"){if(l.data("size")===1){q=" "+propertyValues.CartItem;}else{q=" "+propertyValues.CartItems;}k=(l.data("size")+q);}else{k=propertyValues.Carousel.carouselitemcounter;k=k.replace(/\{0\}/g,(m+1));k=k.replace(/\{1\}/g,(p+1));k=k.replace(/\{2\}/g,l.data("size"));}l.data("pageStatus").find(".note").html(k);}function ae(n,o){var k=n.data("pageStatus").find(".active").index();var l=n.data("pageStatus");var m=n.data("maxpages")+1;var p=n.attr("id");o--;if(o>0){o++;}if(o==m-1){o++;}if(k==o){return false;}l.find(".active").removeClass("active");l.find("li").eq(o).addClass("active");if(m-1>10){at(n);}}function at(o){var m=o.data("pageStatus"),k=o.data("pageStatus").find(".active").index(),l=k-3,n=o.data("maxpages")+1;if(n-1<=10){return false;}m.find("li").hide();if(l<0){l=0;}if(l+7>n){l=n-7;}for(var p=l;p<7;p++){m.find("li").eq(p).show();}m.find("li").eq(0).show();m.find("li").eq(-1).show();m.find(".ellipsis").hide();if(l<2){m.find("li").eq(7).show();}if(l+6>n-2){m.find("li").eq(n).show();}if(l>2){m.find("li").eq(1).show();}if(l+6<n-2){m.find("li").eq(-2).show();}}function af(k){if(typeof(propertyValues.personalizationSwitch)!=="undefined"&&propertyValues.personalizationSwitch!=null&&propertyValues.personalizationSwitch!="ON"&&propertyValues.personalizationSwitch!="on"){return;}if(k.indexOf("&pageId")==-1){k+="&pageId="+aB;}if(k.indexOf("&pageType")==-1){k+="&pageType="+ap;}ay(k);}function ay(k){if(typeof(propertyValues.personalizationSwitch)!=="undefined"&&propertyValues.personalizationSwitch!=null&&propertyValues.personalizationSwitch!="ON"&&propertyValues.personalizationSwitch!="on"){return;}if(!aC){ao=k;b(ao);ao="";aC=true;}else{b(k);}}function aF(l,k){if(!aC){aO[0]=l;aO[1]=k;aJ(aO[0],aO[1]);aC=true;}else{aJ(l,k);}}function aq(m,l){var k=m+"";while(k.length<l){k="0"+k;}return k;}function az(k){if(debugMode!=null&&debugMode=="true"){aG.push(k);j("#debug").append("<br />"+k);}}function b(l){var n="";var k=(new Date()).getTime(),o;try{j.ajax({url:l,type:"GET",dataType:"xml",timeout:propertyValues.ajaxTimeout,error:function(){az("Personalization: timeout or xml parse error on "+l);n="Personalization: timeout or xml parse error";doOmnitureErrorTracking("loadPersonalized_worker",n);},success:function(p){o=(new Date()).getTime();a.Onload.addLoadEvent(function(){am(p);});if(aH){var q=o-k;az("PerfForLoadPersonalized ="+q);}}});}catch(m){az("Personalization: invalid return on "+l);n="Personalization: timeout or xml parse error";doOmnitureErrorTracking("loadPersonalized_worker",n);}}function am(k){var l=j(k).find("timestamp").text();aD=(j(k).find("pricingLinkSwitch").text()=="ON")?true:false;if(debugMode!=null&&debugMode=="true"){var m=j(k).find("fragmentsource").text();j("#bmsging > ul").append("<li>"+propertyValues.Personalization.source+m+"</li>");}j(k).find("scheme").each(function(){var q=j(this).attr("id");q=q.replace(/_data$/,"");d[q]=j("#"+q);var x=d[q].html();d[q].addClass("hide");if(d[q].hasClass("carousel")){var p="<div class='prevButton'><a href='#'>"+propertyValues.Carousel.previous+"</a></div><div class='nextButton'><a href='#'>"+propertyValues.Carousel.next+"</a></div><h4 class='a200'>{HEADLINE}</h4><div class='perpage'></div><div class='b201'>{CURRENTHTML}{CONTENT}<span class='footline'>{FOOTLINE}</span></div><hr /><div class='carouselStatus'></div>";d[q].html(aM(p,j(this).find("headline").text(),x,j(this).find("content").text(),j(this).find("footline").text()));aJ(q,aD);}else{if(d[q].hasClass("feature")&&d[q].hasClass("hero")){var p="<h4 class='a200'>{HEADLINE}</h4><div class='b201'>{CURRENTHTML}<div class='heroleft'></div><div class='heroright'>{CONTENT}</div></div>";d[q].html(aM(p,j(this).find("headline").text(),x,j(this).find("content").text()));d[q].find("div.p01:not(:has(h4))").remove();var t=d[q].find("div.heroleft:first");t.append(d[q].find("div.p01:first"));t.find("img:first").addClass("hero");var y=d[q].attr("class").match("c(\\d+)");if(y){d[q].data("carwide",parseInt(y[1])-1);}else{d[q].data("carwide",1);}var r=d[q].find("div.heroright");var s=d[q].attr("class").match("r(\\d+)");if(s){d[q].data("carrows",parseInt(s[1]));}else{d[q].data("carrows",0);}if(d[q].data("carwide")>1&&d[q].data("carrows")>0){var n=(d[q].data("carwide")*d[q].data("carrows"))-1;r.find("div.p01:gt("+n+")").remove();}d[q].data("p01s",d[q].find("div.p01"));d[q].data("size",d[q].data("p01s").size());r.find("div.p01:nth-child("+(d[q].data("carwide"))+"n)").after("<hr />");r.find("hr:last-child").remove();if(d[q].data("size")>=1){d[q].removeClass("hide");aP(d[q],0,-1,0,-1);if(d[q].data("carwide")>1){r.data("p01s",r.find("div.p01"));r.data("carwide",d[q].data("carwide"));r.data("maxpages",Math.ceil((d[q].data("size")-1)/r.data("carwide")));ac(r);}}else{az("Personalization: no products on "+q);}}else{if(d[q].hasClass("feature")&&d[q].hasClass("recommended")){var p="<form id='skuForm_"+q+"' method='post' action='' name='skuForm_"+q+"'><h4 class='a200'>{HEADLINE}</h4><div class='b201'>";j("#certona_replace_header").html(j(this).find("headline").text());if(typeof(bothtabs)!="undefined"){j("#saheader").removeClass("current noSwitch");j("#certona_replace_header").removeClass("hide");j("#certona_replace_header").addClass("current");j("#supplies").removeClass("show");j("#supplies").addClass("hide");j("#certona").removeClass("hide");j("#certona").addClass("current");}p+="{CURRENTHTML}<div>{CONTENT}</div></div></form>";var u="<div class='recommendedaddtocart'><a class='d01' href='#' onclick='addPersonalizedToCart(\""+propertyValues.POST_DOMAIN+'StaplesAddToCart?ST_viewFrom=sku&langId=-1&storeId=10001&URL=yourorder&catalogId=10051", "skuForm_'+q+"\"); return false;'>"+propertyValues.addtocart+"</a></div>";d[q].html(aM(p,j(this).find("headline").text(),x,j(this).find("content").text()));d[q].find("div.p01:not(:has(h4))").remove();d[q].data("p01s",d[q].find("div.p01"));d[q].data("p01s").wrapInner("<div class='recommendedleft'></div>");d[q].data("size",d[q].data("p01s").size());var y=d[q].attr("class").match("c(\\d+)");if(y){d[q].data("carwide",parseInt(y[1])-1);}else{d[q].data("carwide",1);}if(d[q].data("size")>=1){d[q].removeClass("hide");aP(d[q],0,-1,0,-1);}else{az("Personalization: no products on "+q);}}else{if(d[q].hasClass("feature")){var p=aA;d[q].html(aM(p,j(this).find("headline").text(),x,j(this).find("content").text()));d[q].find("div.p01:not(:has(h4))").remove();var y=d[q].attr("class").match("c(\\d+)");if(y){d[q].data("carwide",parseInt(y[1]));}else{d[q].data("carwide",1);}var s=d[q].attr("class").match("r(\\d+)");if(s){d[q].data("carrows",parseInt(s[1]));}else{d[q].data("carrows",0);}if(d[q].data("carwide")>1&&d[q].data("carrows")>0){var n=(d[q].data("carwide")*d[q].data("carrows"))-1;d[q].find("div.p01:gt("+n+")").remove();}d[q].data("p01s",d[q].find("div.p01"));d[q].data("size",d[q].data("p01s").size());if(d[q].data("carwide")>1){d[q].find("div.p01:nth-child("+d[q].data("carwide")+"n)").after("<hr />");d[q].find("div.b201 hr:last-child").remove();}if(d[q].data("size")>=1){d[q].removeClass("hide");aP(d[q],0,-1,0,-1);if(d[q].data("carwide")>1){d[q].data("maxpages",Math.ceil(d[q].data("size")/d[q].data("carwide")));ac(d[q]);}}else{az("Personalization: no products on "+q);}}else{var p="{CONTENT}";if(d[q].find("div.productdetail").size()>0){if(d[q].find("div.productdetail").text().length>0){d[q].find("div.p01").empty();}}if(d[q].find("div.notfounderror").text().length>0){d[q].empty();}d[q].append(aM(p,null,null,null,j(this).find("content").text()));if(d[q].find("div.productdetail").size()>0){var o=q.split("_");var B="item"+o[1];var A="li"+o[1];if((j.trim(d[q].find("div.productdetail").text()).length)==0){d[q].find("div.p01").empty();d[q].empty();var p='<div class="notfounderror">Item Not Found</div>';d[q].append(aM(p,null,null,j(this).find("content").text()));var C=j("#"+B).attr("name").split("_");var D=C[0]+"_"+C[1]+"_error";j("#"+B).attr("name",D);j("#"+A).removeClass("prodempty");j("#"+A).addClass("prodnotfound");}else{if(d[q].find("div.mathstory dl:first dd:first b:first i:first").text()=="$9,999,999.99"){d[q].find("div.p01").empty();d[q].empty();var p='<div class="notfounderror">Item Not Found</div>';d[q].append(aM(p,null,null,j(this).find("content").text()));var C=j("#"+B).attr("name").split("_");var D=C[0]+"_"+C[1]+"_error";j("#"+B).attr("name",D);j("#"+A).removeClass("prodempty");j("#"+A).addClass("prodnotfound");}else{d[q].data("p01s",d[q].find("div.p01"));d[q].data("size",d[q].data("p01s").size());aD="ON";aP(d[q],0,-1,0,-1);var C=j("#"+B).attr("name").split("_");var D=C[0]+"_"+C[1]+"_success";j("#"+B).attr("name",D);j("#"+A).removeClass("prodempty");j("#"+A).removeClass("prodnotfound");}}}else{if(d[q].find("div.productdetail").size()==0&&pageId=="orderbycat"){var o=q.split("_");var A="li"+o[1];var p='<div class="notfounderror">Item Not Found</div>';d[q].append(aM(p,null,null,j(this).find("content").text()));j("#"+A).removeClass("prodempty");j("#"+A).addClass("prodnotfound");}}d[q].removeClass("hide");}}}}if(debugMode!=null&&debugMode=="true"){if(d[q].data("p01s")!=h){d[q].data("p01s").each(function(){var E=j(this).find("div.timestamp").text();if(E!=""&&E>l){j(this).css("background-color","#fee");}});}}var z=d[q].find("a");if(propertyValues.analyticsSwitch=="ON"){z.click(function(){aQ(q);});}z.attr("target","_parent");if(isMsie7){try{var w=d[q][0].offsetTop;}catch(v){}}});}function aJ(o,p){var l=(new Date()).getTime();aD=p;d[o]=j("#"+o);if(o=="cart_overlay_box"&&d[o].data("initialized")==true){return;}if(!d[o]){d[o]=j("#"+o);var s="";}var t=d[o].attr("class").match("c(\\d+)");if(t){d[o].data("carwide",parseInt(t[1]));}else{d[o].data("carwide",1);}if(typeof(anchoredPage)!="undefined"){if(anchoredPage!=h&&anchoredPage!=""){d[o].data("currentPage",parseInt(anchoredPage));}else{d[o].data("currentPage",1);}}else{d[o].data("currentPage",1);}d[o].find("div.p01:not(:has(h4))").remove();d[o].find("div.p01:nth-child("+d[o].data("carwide")+"n)").after("<hr />");d[o].find("div.b201 hr:last-child").remove();d[o].data("p01s",d[o].find("div.p01"));d[o].data("carouselStatus",d[o].find("div.carouselStatus:first"));d[o].data("b201",d[o].find("div.b201:first"));d[o].data("size",d[o].data("p01s").size());if(d[o].closest("#previouslyPurchasedTab").length!=0){if(typeof s_previouslyOrderedSearchBox!=="undefined"){s_previouslyOrderedSearchBox(d[o].data("size"));}}else{if(d[o].closest("#productResearchTab").length!=0){if(typeof s_prodResearchToolsSearchBox!=="undefined"){s_prodResearchToolsSearchBox(d[o].data("size"));}}}d[o].data("maxpages",Math.ceil(d[o].data("size")/d[o].data("carwide")));if(d[o].data("maxpages")<=1&&d[o].data("size")>=1){var n=aA;var k=j(this).find("headline").text();k=k?k:d[o].find("h4.a200").html();var v=d[o].find("div.p01").length;var m;if(v===1){m=" "+propertyValues.CartItem;}else{m=" "+propertyValues.CartItems;}if(d[o].find("h4.a200").html()==null||d[o].find("h4.a200").html()==""){k="<span>"+v+m+"</span>";}var s=s?s:"";var u="<span class='note'>"+v+m+"</span>";d[o].empty().html(aM(n,k,u,s,""));d[o].find("div.b201:first").append(d[o].data("p01s"));d[o].removeClass("carousel").addClass("feature").removeClass("hide");aP(d[o],0,-1,0,-1);ac(d[o]);}else{if(d[o].data("size")>=1){if(d[o].hasClass("feature")){d[o].removeClass("feature").addClass("carousel");aF(o,true);}d[o].removeClass("hide");ab(d[o]);an(d[o]);aN(d[o],0,0);}else{az("Personalization: no products on "+o);}}var q=(new Date()).getTime();if(aH){var r=q-l;az("PerfForPrepCarousel ="+r);}}function ai(k){k.data("p01s").removeClass("show").addClass("hide");}function ak(k){if(!k.data("h4height")){k.data("h4height",0);}if(!k.data("mathheight")){k.data("mathheight",0);}k.data("p01s").each(function(){if(j(this).hasClass("show")){var o=j(this).children("h4");var l=o.totalHeight();if(l>k.data("h4height")){k.data("h4height",l);}var m=j(this).find("div.mathstory");var n=m.superHeight();if(n>k.data("mathheight")){k.data("mathheight",n);}}});k.data("p01s").each(function(){if(j(this).hasClass("show")){var m=j(this).children("h4");m.css("height",k.data("h4height"));var l=j(this).find("div.mathstory");l.css("height","auto");}});}function aP(m,k,o,l,p){var q=m.data("p01s");if(k<0){k=0;}if(k>m.data("size")-1){k=m.data("size")-1;}if(o<0||o>m.data("size")-1){o=m.data("size")-1;}if(p<0){p=m.data("size")-1;}for(var n=k;n<=o;n++){av(q.eq(n),m.attr("id"));if(!q.eq(n).hasClass("ready")){if(aD){ad(q.eq(n),m.attr("id"),n,m.data("carwide"));}else{aE(q.eq(n));}}if(ag){al(q.eq(n));}if(n>=l&&n<=p){q.eq(n).removeClass("hide").addClass("show");}}}function aM(m,n,o,p,k,l){m=m.replace(/\{HEADLINE\}/,n);m=m.replace(/\{PAGES\}/,o);m=m.replace(/\{CURRENTHTML\}/,p);var k=k?k:"";m=m.replace(/\{CONTENT\}/,k);var l=l?l:"";m=m.replace(/\{FOOTLINE\}/,l);return m;}function aE(k){k.addClass("ready");}function ad(o,l,q,r){var p=o.find("a.mathstoryurl:first");var k=o.find("div.mathstory:first");if(p[0]){var n=p[0].href;p.remove();try{j.ajax({url:n,type:"GET",dataType:"html",timeout:propertyValues.ajaxTimeout,error:function(){aE(o);},success:function(s){k.html(s);aL(o,k,l,q,r);}});}catch(m){aE(o);}}if(k[0]){aL(o,k,l,q,r);}else{aE(o);}}function aL(q,s,t,n,r){q.find("div.details").remove();q.append(q.find("div.recommendedleft label.note"));q.append(q.find("div.recommendedleft input.text3"));q.append(q.find("div.recommendedleft a.d01"));s.find("input[name^=cmArea]").attr("value",t);s.find("a").attr("cmArea",t);var k=s.find("div.mathflyout");var m=k.parents("div").filter(".pricenew");var l=s.find("a.psavelink > b > i");if(l[0]){var o=l.text().replace(/[^0-9\.\,]/g,"").split(".",2);if(typeof(o[1])=="undefined"){o=l.text().replace(/[^0-9\.\,]/g,"").split(",",2);}var u;for(u in o){if(o[0]==""){o[u]="0";}}av(q,t,o);}s.find("dd.psave").hover(function(){m.css("zIndex",8010);k.removeClass("hide");return false;},function(){m.css("zIndex",0);k.addClass("hide");return false;}).children("a.psavelink:not(.spic)").each(function(){disableLink(j(this));});j(".tabSuppliesAccessories-Content").find("dd.psave").hover(function(){j(this).parents("div:first").find(".mathflyout").removeClass("hide");},function(){j(this).parents("div:first").find(".mathflyout").addClass("hide");});j(".tabSuppliesAccessories-Content").find("dd.psave").click(function(){return false;});if(isOverlay){q.find("a.spic").each(function(){disableLink(j(this));});}var p=(n%r)+1;var v=Math.ceil(r/2);if(p>v||r==1||pageId=="orderbycat"){k.addClass("left");}else{k.removeClass("left");}if(pageId=="orderbycat"){q.find("a").each(function(){disableLink(j(this));});}aE(q);}function av(m,k,l){m.find("img:first").each(function(){var p=j(this).attr("src");var n=p.indexOf(propertyValues.COMMON_ICON_PATH+"blank.gif");if(n!==-1||l){if(!m.data("image")){m.data("image",j(this).attr("name"));j(this).removeAttr("name");}var o=propertyValues.s7nonsecure;if(isSecure){if(isKiosk){o=propertyValues.s7kiosksecure;}else{o=propertyValues.s7secure;}}if(m.data("image")){if(l){o+=propertyValues.s7reddotpath;o=o.replace(/\{0\}/g,escape("is{Staples/"+m.data("image")+"_sc7}"));o=o.replace(/\{1\}/g,escape(l[0]));o=o.replace(/\{2\}/g,escape(l[1]));}else{o+=propertyValues.s7path+"?{3}";o=o.replace(/\{0\}/g,m.data("image"));}}else{o+=propertyValues.s7noimagepath+"?{3}";o=o.replace(/\{0\}/g,"noimageavailable");}if(j(this).hasClass("hero")){o=o.replace(/\{3\}/g,"$hero$");}else{if(pageId=="home"||k.match(/_rr$/)||pageId=="samhome"){o=o.replace(/\{3\}/g,"$small$");}else{if(k=="samoverlay"){o=o.replace(/\{3\}/g,"$smaller$");}else{if(pageId=="orderbycat"){o=o.replace(/\{3\}/g,"$thb$");}else{o=o.replace(/\{3\}/g,"$lnk$");}}}}j(this).attr("src",o);}});}function al(k){if(typeof(pr_merchant_group_id)!="undefined"){k.find("div.reviewsprodmod:not(:has(div))").each(function(){var s=j(this).attr("id");var n=s.match("^pwr(.*?)-");var l=n[1];pr_page_id=l;pr_snippet_id=s;pr_snippet_min_reviews=parseInt(propertyValues.reviewsFeaturedItemsThreshold);var q=j("#prSnippet"+pr_page_id);if(q.length>0){var o=j(this);var r=setInterval(function(){ax(o,q,r);},100);setTimeout(function(){aj(o,r);},propertyValues.ajaxTimeout*5);}else{j(this).append("<div id='prSnippet"+pr_page_id+"'></div>");var m;j(this).append("<iframe id='prIframe_"+pr_page_id+"' src='' class='hide'></iframe>");var p=j("#prIframe_"+pr_page_id+"")[0];m=p.contentWindow.document;m.open();m.write=aI;snippet(m);m.close();}});}}function ax(k,l,m){if(l.html()!=""){var n=l.clone();n.removeAttr("id");k.html(j(n));clearInterval(m);}}function aj(k,l){if(k.find("div").length==0){k.append("<div></div>");}clearInterval(l);}function aI(k){j("#"+pr_snippet_id).append(k);}function ah(q,l,r){var t=q.data("carwide");var n=q.data("currentPage");var p=0;if(l>=1){p=l;}if(r!=0){if(l>=1){p+=r;}else{p=n+r;}}if(p<0){n=0;}else{if(p>q.data("maxpages")){p=q.data("maxpages");}}var m=(t*n)-1;var k=m-t+1;if(m>q.data("size")-1){m=q.data("size")-1;}if(k<0){k=0;}if(p>0){var s=(t*p)-1;var o=m-t+1;if(s>q.data("size")-1){s=q.data("size")-1;}if(o<0){o=0;}}else{if(r==0){var s=q.data("size")-1;var o=0;}}if(p>0||r==0){aP(q,o,s,k,m);}}function aN(u,x,B){var o=(new Date()).getTime();var w=u.attr("id");var k=u.data("carwide");var q=u.data("currentPage");var r=1;if(pageId=="home"){r=0;}if(x!=0||B!=0){var l=u.data("b201").superWidth();var p=u.data("b201").superHeight();var m="min-width:"+l+"px;width:auto !important;width:"+l+"px;min-height:auto !important;height:auto !important;height:auto !important;";u.data("b201").css("cssText",m);}if(x>0){q=x;}q+=B;if(q<1){q=1;}else{if(q>u.data("maxpages")){q=u.data("maxpages");}}if(x==0&&B==0&&u.data("initialized")!=h){u.data("b201").removeClass("expanded");}u.data("initialized",true);u.data("currentPage",q);var n=(k*q)-1;var v=n-k+1;if(n>u.data("size")-1){n=u.data("size")-1;}if(v<0){v=0;}var A=n+(k*r);var t=v-(k*r);if(A>u.data("size")-1){A=u.data("size")-1;}if(t<0){t=0;}ai(u);aP(u,t,A,v,n);ak(u);ae(u,q);aS(u);u.data("carouselStatus").html('<a href="#" class="expand">'+propertyValues.Carousel.expand+'<img src="" alt="" class="expandAll" border="0" /></a>');u.data("carouselStatus").find("a.expand").click(function(D){D.preventDefault();aw(u);});u.data("carouselStatus").find("a.expand").mouseover(function(){ah(u,0,0);});u.data("nextButton").show();u.data("prevButton").show();var y=j("#"+w).find("li.pageNext");var z=j("#"+w).find("li.pagePrev");if(q>1){u.data("prevButton").removeClass("inactive");z.show();}else{u.data("prevButton").addClass("inactive");z.hide();}if(q<u.data("maxpages")){u.data("nextButton").removeClass("inactive");y.show();}else{u.data("nextButton").addClass("inactive");y.hide();}var C=(new Date()).getTime();if(au){var s=C-o;az("PerfForPageChanger ="+s);}}function aw(l){var m=l.attr("id");if(l.data("maxpages")<=1){return false;}l.data("b201").css("width",l.data("b201").superWidth());l.data("b201").addClass("expanded");aP(l,0,-1,0,-1);ac(l);var m=l.attr("id");var k=propertyValues.Carousel.carouselitemtotal;k=k.replace(/\{0\}/g,l.data("size"));l.data("pageStatus").find(".note").html(k);l.data("pageStatus").find(".pageStatus").hide();l.data("carouselStatus").html('<a href="#" class="collapse">'+propertyValues.Carousel.collapse+'<img src="" alt="" class="collapseAll" border="0" /></a> ');l.data("carouselStatus").find("a.collapse").click(function(n){n.preventDefault();f.scrollTo(0,findPos(g.getElementById(m)));aN(l,0,0);l.data("pageStatus").find(".pageStatus").show();});l.data("prevButton").hide();l.data("nextButton").hide();}function ar(k){aw(d[k]);}function ac(t){for(var o=1;o<=t.data("maxpages");o++){var p=0;var m=0;for(var n=1;n<=t.data("carwide");n++){var k=(n+((o-1)*t.data("carwide")))-1;var q=t.data("p01s").eq(k).children("h4");var r=t.data("p01s").eq(k).find("div.mathstory");var s=q.totalHeight();if(s>p){p=s;}var l=r.superHeight();if(l>m){m=l;}}for(var n=1;n<=t.data("carwide");n++){var k=(n+((o-1)*t.data("carwide")))-1;var q=t.data("p01s").eq(k).children("h4");var r=t.data("p01s").eq(k).find("div.mathstory");q.css("height",p);r.css("height",m);}}}function aQ(k){var l="";if(typeof(variantPartnumber)!="undefined"){l="variant_"+k+"_"+variantPartnumber;}var m=g.getElementById(l);var n="0";if((typeof(m)!="undefined")&&(null!=m)){n=m.value;}variantPartnumber="";if(typeof(parentSku)!="undefined"){if(typeof s_prodAffinity!=="undefined"){s_prodAffinity(parentSku,"Recommendations",k,n);}}else{if(typeof s_findMethod!=="undefined"){s_findMethod("Recommendations",k,n);}}}function e(){var k=g.title,l=k.indexOf("|");c();ap=encodeURIComponent(k.substring(0,l-1));if(ao!=""){b(ao);ao="";}if(aO[1]!=h){aJ(aO[0],aO[1]);personalizationDivId="";}}return{init:e,createResxPageId:c,getResxPageId:aR,loadCarousel:ay,loadPersonalizationImages:av,loadPersonalized:af,pageChanger:aN,prepCarousel:aF,processMath:aL,showAll:ar};})();return a;}(f.STAPLES||{}));f.STAPLES=i;i.Personalization.init();}(window,document,jQuery));