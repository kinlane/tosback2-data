(function(b,a,c,e){var d=(function(f){f.Personalization=(function(){var k=[2],H="",w=false,I="",x="";var r=true;var D=true;var s=new Array(0);var v=false;var Q=(propertyValues.reviewsMasterSwitch=="ON")?true:false;var X=new Object();var y="<h4 class='a200'>{HEADLINE}</h4>"+"<div class='perpage'>{PAGES}</div>"+"<div class='b201'>"+"{CURRENTHTML}"+"<div>"+"{CONTENT}"+"</div>"+"</div>";function J(ab){ab.data("prevButton",ab.find("div.prevButton a:first"));ab.data("nextButton",ab.find("div.nextButton a:first"));ab.data("prevButton").click(function(ac){ac.preventDefault();l(ab,0,-1);});ab.data("nextButton").click(function(ac){ac.preventDefault();l(ab,0,1);});ab.data("nextButton").mouseover(function(){P(ab,0,1);});}function o(ad){var ab,ac="",ae;ad.data("pageStatus").find("li a").click(function(af){af.preventDefault();ac=c(this).html();ae=parseInt(ac);ab=ad.data("currentPage");if(ae==ab||ac=="&#133;"){return false;}l(ad,ae,0);});ad.data("pageStatus").find("li a").mouseover(function(){ac=c(this).html();ae=parseInt(ac);ab=ad.data("currentPage");if(ae==ab||ac=="&#133;"){return false;}P(ad,ae,0);});}function V(ae){var ad=1,ab=ae.data("maxpages"),af='<ul class="pageStatus">',ac='<li class="ellipsis" style="display:none"><a href="#">&#133;</a></li>';if(ab<2){return false;}af+='<li class="first active"><a href="#">1</a></li>';af+=ac;for(ad=2;ad<ab;ad++){af+='<li><a href="#">'+ad+"</a></li>";}af+=ac;af+='<li class="last"><a href="#">'+ad+"</a></li>";af+='</ul><span class="note"></span>';ae.data("pageStatus",ae.find("div.perpage:first"));ae.data("pageStatus").html(af);g(ae);o(ae);if(ab>10){E(ae);}}function Y(){x=Math.floor(Math.random()*1000000000000000)+"";var ad=new Date();var ae=ad.getFullYear()+"";var af=(ad.getMonth()+1)+"";var ac=ad.getDate()+"";var ab=ad.getHours()+"";x="res"+ae.substring(2)+G(af,2)+G(ac,2)+G(ab,2)+x;return x;}function h(){if(x){return x;}else{return Y();}}function g(ag){var ah,ad=ag.data("carwide"),ae=ag.data("currentPage"),af,ab,ac;ac=(ad*ae)-1;af=ac-ad+1;if(ac>ag.data("size")-1){ac=ag.data("size")-1;}if(ag.attr("id")==="item_box"){if(ag.data("size")===1){ab=" "+propertyValues.CartItem;}else{ab=" "+propertyValues.CartItems;}ah=(ag.data("size")+ab);}else{ah=propertyValues.Carousel.carouselitemcounter;ah=ah.replace(/\{0\}/g,(af+1));ah=ah.replace(/\{1\}/g,(ac+1));ah=ah.replace(/\{2\}/g,ag.data("size"));}ag.data("pageStatus").find(".note").html(ah);}function S(ad,ac){var ag=ad.data("pageStatus").find(".active").index();var af=ad.data("pageStatus");var ae=ad.data("maxpages")+1;var ab=ad.attr("id");ac--;if(ac>0){ac++;}if(ac==ae-1){ac++;}if(ag==ac){return false;}af.find(".active").removeClass("active");af.find("li").eq(ac).addClass("active");if(ae-1>10){E(ad);}}function E(ac){var ae=ac.data("pageStatus"),ag=ac.data("pageStatus").find(".active").index(),af=ag-3,ad=ac.data("maxpages")+1;if(ad-1<=10){return false;}ae.find("li").hide();if(af<0){af=0;}if(af+7>ad){af=ad-7;}for(var ab=af;ab<7;ab++){ae.find("li").eq(ab).show();}ae.find("li").eq(0).show();ae.find("li").eq(-1).show();ae.find(".ellipsis").hide();if(af<2){ae.find("li").eq(7).show();}if(af+6>ad-2){ae.find("li").eq(ad).show();}if(af>2){ae.find("li").eq(1).show();}if(af+6<ad-2){ae.find("li").eq(-2).show();}}function R(ab){if(typeof(propertyValues.personalizationSwitch)!=="undefined"&&propertyValues.personalizationSwitch!=null&&propertyValues.personalizationSwitch!="ON"&&propertyValues.personalizationSwitch!="on"){return;}if(ab.indexOf("&pageId")==-1){ab+="&pageId="+x;}if(ab.indexOf("&pageType")==-1){ab+="&pageType="+H;}aa(ab);}function aa(ab){if(typeof(propertyValues.personalizationSwitch)!=="undefined"&&propertyValues.personalizationSwitch!=null&&propertyValues.personalizationSwitch!="ON"&&propertyValues.personalizationSwitch!="on"){return;}if(!w){I=ab;Z(I);I="";w=true;}else{Z(ab);}}function t(ab,ac){if(!w){k[0]=ab;k[1]=ac;p(k[0],k[1]);w=true;}else{p(ab,ac);}}function G(ab,ac){var ad=ab+"";while(ad.length<ac){ad="0"+ad;}return ad;}function z(ab){if(debugMode!=null&&debugMode=="true"){s.push(ab);c("#debug").append("<br />"+ab);}}function Z(ae){var ac="";var af=(new Date()).getTime(),ab;try{c.ajax({url:ae,type:"GET",dataType:"xml",timeout:propertyValues.ajaxTimeout,error:function(){z("Personalization: timeout or xml parse error on "+ae);ac="Personalization: timeout or xml parse error";doOmnitureErrorTracking("loadPersonalized_worker",ac);},success:function(ah){ab=(new Date()).getTime();f.Onload.addLoadEvent(function(){K(ah);});if(r){var ag=ab-af;z("PerfForLoadPersonalized ="+ag);}}});}catch(ad){z("Personalization: invalid return on "+ae);ac="Personalization: timeout or xml parse error";doOmnitureErrorTracking("loadPersonalized_worker",ac);}}function K(ad){var ac=c(ad).find("timestamp").text();v=(c(ad).find("pricingLinkSwitch").text()=="ON")?true:false;if(debugMode!=null&&debugMode=="true"){var ab=c(ad).find("fragmentsource").text();c("#bmsging > ul").append("<li>"+propertyValues.Personalization.source+ab+"</li>");}c(ad).find("scheme").each(function(){var ar=c(this).attr("id");ar=ar.replace(/_data$/,"");X[ar]=c("#"+ar);var ak=X[ar].html();X[ar].addClass("hide");if(X[ar].hasClass("carousel")){var at="<div class='prevButton'><a href='#'>"+propertyValues.Carousel.previous+"</a></div>"+"<div class='nextButton'><a href='#'>"+propertyValues.Carousel.next+"</a></div>"+"<h4 class='a200'>{HEADLINE}</h4>"+"<div class='perpage'></div>"+"<div class='b201'>"+"{CURRENTHTML}"+"{CONTENT}"+"<span class='footline'>{FOOTLINE}</span>"+"</div>"+"<hr /><div class='carouselStatus'></div>";X[ar].html(m(at,c(this).find("headline").text(),ak,c(this).find("content").text(),c(this).find("footline").text()));p(ar,v);}else{if(X[ar].hasClass("feature")&&X[ar].hasClass("hero")){var at="<h4 class='a200'>{HEADLINE}</h4>"+"<div class='b201'>"+"{CURRENTHTML}"+"<div class='heroleft'></div>"+"<div class='heroright'>"+"{CONTENT}"+"</div>"+"</div>";X[ar].html(m(at,c(this).find("headline").text(),ak,c(this).find("content").text()));X[ar].find("div.p01:not(:has(h4))").remove();var ao=X[ar].find("div.heroleft:first");ao.append(X[ar].find("div.p01:first"));ao.find("img:first").addClass("hero");var aj=X[ar].attr("class").match("c(\\d+)");if(aj){X[ar].data("carwide",parseInt(aj[1])-1);}else{X[ar].data("carwide",1);}var aq=X[ar].find("div.heroright");var ap=X[ar].attr("class").match("r(\\d+)");if(ap){X[ar].data("carrows",parseInt(ap[1]));}else{X[ar].data("carrows",0);}if(X[ar].data("carwide")>1&&X[ar].data("carrows")>0){var av=(X[ar].data("carwide")*X[ar].data("carrows"))-1;aq.find("div.p01:gt("+av+")").remove();}X[ar].data("p01s",X[ar].find("div.p01"));X[ar].data("size",X[ar].data("p01s").size());aq.find("div.p01:nth-child("+(X[ar].data("carwide"))+"n)").after("<hr />");aq.find("hr:last-child").remove();if(X[ar].data("size")>=1){X[ar].removeClass("hide");j(X[ar],0,-1,0,-1);if(X[ar].data("carwide")>1){aq.data("p01s",aq.find("div.p01"));aq.data("carwide",X[ar].data("carwide"));aq.data("maxpages",Math.ceil((X[ar].data("size")-1)/aq.data("carwide")));U(aq);}}else{z("Personalization: no products on "+ar);}}else{if(X[ar].hasClass("feature")&&X[ar].hasClass("recommended")){var at="<form id='skuForm_"+ar+"' method='post' action='' name='skuForm_"+ar+"'>"+"<h4 class='a200'>{HEADLINE}</h4>"+"<div class='b201'>";c("#certona_replace_header").html(c(this).find("headline").text());if(typeof(bothtabs)!="undefined"){c("#saheader").removeClass("current noSwitch");c("#certona_replace_header").removeClass("hide");c("#certona_replace_header").addClass("current");c("#supplies").removeClass("show");c("#supplies").addClass("hide");c("#certona").removeClass("hide");c("#certona").addClass("current");}at+="{CURRENTHTML}"+"<div>"+"{CONTENT}"+"</div>"+"</div>"+"</form>";var an="<div class='recommendedaddtocart'><a class='d01' href='#' onclick='addPersonalizedToCart(\""+propertyValues.POST_DOMAIN+'StaplesAddToCart?ST_viewFrom=sku&langId=-1&storeId=10001&URL=yourorder&catalogId=10051", "skuForm_'+ar+"\"); return false;'>"+propertyValues.addtocart+"</a></div>";X[ar].html(m(at,c(this).find("headline").text(),ak,c(this).find("content").text()));X[ar].find("div.p01:not(:has(h4))").remove();X[ar].data("p01s",X[ar].find("div.p01"));X[ar].data("p01s").wrapInner("<div class='recommendedleft'></div>");X[ar].data("size",X[ar].data("p01s").size());var aj=X[ar].attr("class").match("c(\\d+)");if(aj){X[ar].data("carwide",parseInt(aj[1])-1);}else{X[ar].data("carwide",1);}if(X[ar].data("size")>=1){X[ar].removeClass("hide");j(X[ar],0,-1,0,-1);}else{z("Personalization: no products on "+ar);}}else{if(X[ar].hasClass("feature")){var at=y;X[ar].html(m(at,c(this).find("headline").text(),ak,c(this).find("content").text()));X[ar].find("div.p01:not(:has(h4))").remove();var aj=X[ar].attr("class").match("c(\\d+)");if(aj){X[ar].data("carwide",parseInt(aj[1]));}else{X[ar].data("carwide",1);}var ap=X[ar].attr("class").match("r(\\d+)");if(ap){X[ar].data("carrows",parseInt(ap[1]));}else{X[ar].data("carrows",0);}if(X[ar].data("carwide")>1&&X[ar].data("carrows")>0){var av=(X[ar].data("carwide")*X[ar].data("carrows"))-1;X[ar].find("div.p01:gt("+av+")").remove();}X[ar].data("p01s",X[ar].find("div.p01"));X[ar].data("size",X[ar].data("p01s").size());if(X[ar].data("carwide")>1){X[ar].find("div.p01:nth-child("+X[ar].data("carwide")+"n)").after("<hr />");X[ar].find("div.b201 hr:last-child").remove();}if(X[ar].data("size")>=1){X[ar].removeClass("hide");j(X[ar],0,-1,0,-1);if(X[ar].data("carwide")>1){X[ar].data("maxpages",Math.ceil(X[ar].data("size")/X[ar].data("carwide")));U(X[ar]);}}else{z("Personalization: no products on "+ar);}}else{var at="{CONTENT}";if(X[ar].find("div.productdetail").size()>0){if(X[ar].find("div.productdetail").text().length>0){X[ar].find("div.p01").empty();}}if(X[ar].find("div.notfounderror").text().length>0){X[ar].empty();}X[ar].append(m(at,null,null,null,c(this).find("content").text()));if(X[ar].find("div.productdetail").size()>0){var au=ar.split("_");var ag="item"+au[1];var ah="li"+au[1];if((c.trim(X[ar].find("div.productdetail").text()).length)==0){X[ar].find("div.p01").empty();X[ar].empty();var at='<div class="notfounderror">'+"Item Not Found"+"</div>";X[ar].append(m(at,null,null,c(this).find("content").text()));var af=c("#"+ag).attr("name").split("_");var ae=af[0]+"_"+af[1]+"_error";c("#"+ag).attr("name",ae);c("#"+ah).removeClass("prodempty");c("#"+ah).addClass("prodnotfound");}else{if(X[ar].find("div.mathstory dl:first dd:first b:first i:first").text()=="$9,999,999.99"){X[ar].find("div.p01").empty();X[ar].empty();var at='<div class="notfounderror">'+"Item Not Found"+"</div>";X[ar].append(m(at,null,null,c(this).find("content").text()));var af=c("#"+ag).attr("name").split("_");var ae=af[0]+"_"+af[1]+"_error";c("#"+ag).attr("name",ae);c("#"+ah).removeClass("prodempty");c("#"+ah).addClass("prodnotfound");}else{X[ar].data("p01s",X[ar].find("div.p01"));X[ar].data("size",X[ar].data("p01s").size());v="ON";j(X[ar],0,-1,0,-1);var af=c("#"+ag).attr("name").split("_");var ae=af[0]+"_"+af[1]+"_success";c("#"+ag).attr("name",ae);c("#"+ah).removeClass("prodempty");c("#"+ah).removeClass("prodnotfound");}}}else{if(X[ar].find("div.productdetail").size()==0&&pageId=="orderbycat"){var au=ar.split("_");var ah="li"+au[1];var at='<div class="notfounderror">'+"Item Not Found"+"</div>";X[ar].append(m(at,null,null,c(this).find("content").text()));c("#"+ah).removeClass("prodempty");c("#"+ah).addClass("prodnotfound");}}X[ar].removeClass("hide");}}}}if(debugMode!=null&&debugMode=="true"){if(X[ar].data("p01s")!=e){X[ar].data("p01s").each(function(){var aw=c(this).find("div.timestamp").text();if(aw!=""&&aw>ac){c(this).css("background-color","#fee");}});}}var ai=X[ar].find("a");if(propertyValues.analyticsSwitch=="ON"){ai.click(function(){i(ar);});}ai.attr("target","_parent");if(isMsie7){try{var al=X[ar][0].offsetTop;}catch(am){}}});}function p(ai,ah){var al=(new Date()).getTime();v=ah;X[ai]=c("#"+ai);if(ai=="cart_overlay_box"&&X[ai].data("initialized")==true){return;}if(!X[ai]){X[ai]=c("#"+ai);var ae="";}var ad=X[ai].attr("class").match("c(\\d+)");if(ad){X[ai].data("carwide",parseInt(ad[1]));}else{X[ai].data("carwide",1);}if(typeof(anchoredPage)!="undefined"){if(anchoredPage!=e&&anchoredPage!=""){X[ai].data("currentPage",parseInt(anchoredPage));}else{X[ai].data("currentPage",1);}}else{X[ai].data("currentPage",1);}X[ai].find("div.p01:not(:has(h4))").remove();X[ai].find("div.p01:nth-child("+X[ai].data("carwide")+"n)").after("<hr />");X[ai].find("div.b201 hr:last-child").remove();X[ai].data("p01s",X[ai].find("div.p01"));X[ai].data("carouselStatus",X[ai].find("div.carouselStatus:first"));X[ai].data("b201",X[ai].find("div.b201:first"));X[ai].data("size",X[ai].data("p01s").size());if(X[ai].closest("#previouslyPurchasedTab").length!=0){if(typeof s_previouslyOrderedSearchBox!=="undefined"){s_previouslyOrderedSearchBox(X[ai].data("size"));}}else{if(X[ai].closest("#productResearchTab").length!=0){if(typeof s_prodResearchToolsSearchBox!=="undefined"){s_prodResearchToolsSearchBox(X[ai].data("size"));}}}X[ai].data("maxpages",Math.ceil(X[ai].data("size")/X[ai].data("carwide")));if(X[ai].data("maxpages")<=1&&X[ai].data("size")>=1){var aj=y;var am=c(this).find("headline").text();am=am?am:X[ai].find("h4.a200").html();var ab=X[ai].find("div.p01").length;var ak;if(ab===1){ak=" "+propertyValues.CartItem;}else{ak=" "+propertyValues.CartItems;}if(X[ai].find("h4.a200").html()==null||X[ai].find("h4.a200").html()==""){am="<span>"+ab+ak+"</span>";}var ae=ae?ae:"";var ac="<span class='note'>"+ab+ak+"</span>";X[ai].empty().html(m(aj,am,ac,ae,""));X[ai].find("div.b201:first").append(X[ai].data("p01s"));X[ai].removeClass("carousel").addClass("feature").removeClass("hide");j(X[ai],0,-1,0,-1);U(X[ai]);}else{if(X[ai].data("size")>=1){if(X[ai].hasClass("feature")){X[ai].removeClass("feature").addClass("carousel");t(ai,true);}X[ai].removeClass("hide");V(X[ai]);J(X[ai]);l(X[ai],0,0);}else{z("Personalization: no products on "+ai);}}var ag=(new Date()).getTime();if(r){var af=ag-al;z("PerfForPrepCarousel ="+af);}}function O(ab){ab.data("p01s").removeClass("show").addClass("hide");}function M(ab){if(!ab.data("h4height")){ab.data("h4height",0);}if(!ab.data("mathheight")){ab.data("mathheight",0);}ab.data("p01s").each(function(){if(c(this).hasClass("show")){var ac=c(this).children("h4");var af=ac.totalHeight();if(af>ab.data("h4height")){ab.data("h4height",af);}var ae=c(this).find("div.mathstory");var ad=ae.superHeight();if(ad>ab.data("mathheight")){ab.data("mathheight",ad);}}});ab.data("p01s").each(function(){if(c(this).hasClass("show")){var ac=c(this).children("h4");ac.css("height",ab.data("h4height"));var ad=c(this).find("div.mathstory");ad.css("height","auto");}});}function j(af,ah,ad,ag,ac){var ab=af.data("p01s");if(ah<0){ah=0;}if(ah>af.data("size")-1){ah=af.data("size")-1;}if(ad<0||ad>af.data("size")-1){ad=af.data("size")-1;}if(ac<0){ac=af.data("size")-1;}for(var ae=ah;ae<=ad;ae++){C(ab.eq(ae),af.attr("id"));if(!ab.eq(ae).hasClass("ready")){if(v){T(ab.eq(ae),af.attr("id"),ae,af.data("carwide"));}else{u(ab.eq(ae));}}if(Q){L(ab.eq(ae));}if(ae>=ag&&ae<=ac){ab.eq(ae).removeClass("hide").addClass("show");}}}function m(ae,ad,ac,ab,ag,af){ae=ae.replace(/\{HEADLINE\}/,ad);ae=ae.replace(/\{PAGES\}/,ac);ae=ae.replace(/\{CURRENTHTML\}/,ab);var ag=ag?ag:"";ae=ae.replace(/\{CONTENT\}/,ag);var af=af?af:"";ae=ae.replace(/\{FOOTLINE\}/,af);return ae;}function u(ab){ab.addClass("ready");}function T(ae,ah,ac,ab){var ad=ae.find("a.mathstoryurl:first");var ai=ae.find("div.mathstory:first");if(ad[0]){var af=ad[0].href;ad.remove();try{c.ajax({url:af,type:"GET",dataType:"html",timeout:propertyValues.ajaxTimeout,error:function(){u(ae);},success:function(aj){ai.html(aj);n(ae,ai,ah,ac,ab);}});}catch(ag){u(ae);}}if(ai[0]){n(ae,ai,ah,ac,ab);}else{u(ae);}}function n(ag,ae,ad,aj,af){ag.find("div.details").remove();ag.append(ag.find("div.recommendedleft label.note"));ag.append(ag.find("div.recommendedleft input.text3"));ag.append(ag.find("div.recommendedleft a.d01"));ae.find("input[name^=cmArea]").attr("value",ad);ae.find("a").attr("cmArea",ad);var am=ae.find("div.mathflyout");var ak=am.parents("div").filter(".pricenew");var al=ae.find("a.psavelink > b > i");if(al[0]){var ai=al.text().replace(/[^0-9\.\,]/g,"").split(".",2);if(typeof(ai[1])=="undefined"){ai=al.text().replace(/[^0-9\.\,]/g,"").split(",",2);}var ac;for(ac in ai){if(ai[0]==""){ai[ac]="0";}}C(ag,ad,ai);}ae.find("dd.psave").hover(function(){ak.css("zIndex",8010);am.removeClass("hide");return false;},function(){ak.css("zIndex",0);am.addClass("hide");return false;}).children("a.psavelink:not(.spic)").each(function(){disableLink(c(this));});c(".tabSuppliesAccessories-Content").find("dd.psave").hover(function(){c(this).parents("div:first").find(".mathflyout").removeClass("hide");},function(){c(this).parents("div:first").find(".mathflyout").addClass("hide");});c(".tabSuppliesAccessories-Content").find("dd.psave").click(function(){return false;});if(isOverlay){ag.find("a.spic").each(function(){disableLink(c(this));});}var ah=(aj%af)+1;var ab=Math.ceil(af/2);if(ah>ab||af==1||pageId=="orderbycat"){am.addClass("left");}else{am.removeClass("left");}if(pageId=="orderbycat"){ag.find("a").each(function(){disableLink(c(this));});}u(ag);}function C(ab,ad,ac){ab.find("img:first").each(function(){var ae=c(this).attr("src");var ag=ae.indexOf(propertyValues.COMMON_ICON_PATH+"blank.gif");if(ag!==-1||ac){if(!ab.data("image")){ab.data("image",c(this).attr("name"));c(this).removeAttr("name");}var af=propertyValues.s7nonsecure;if(isSecure){if(isKiosk){af=propertyValues.s7kiosksecure;}else{af=propertyValues.s7secure;}}if(ab.data("image")){if(ac){af+=propertyValues.s7reddotpath;af=af.replace(/\{0\}/g,escape("is{Staples/"+ab.data("image")+"_sc7}"));af=af.replace(/\{1\}/g,escape(ac[0]));af=af.replace(/\{2\}/g,escape(ac[1]));}else{af+=propertyValues.s7path+"?{3}";af=af.replace(/\{0\}/g,ab.data("image"));}}else{af+=propertyValues.s7noimagepath+"?{3}";af=af.replace(/\{0\}/g,"noimageavailable");}if(c(this).hasClass("hero")){af=af.replace(/\{3\}/g,"$hero$");}else{if(pageId=="home"||ad.match(/_rr$/)||pageId=="samhome"){af=af.replace(/\{3\}/g,"$small$");}else{if(ad=="samoverlay"){af=af.replace(/\{3\}/g,"$smaller$");}else{if(pageId=="orderbycat"){af=af.replace(/\{3\}/g,"$thb$");}else{af=af.replace(/\{3\}/g,"$lnk$");}}}}c(this).attr("src",af);}});}function L(ab){if(typeof(pr_merchant_group_id)!="undefined"){ab.find("div.reviewsprodmod:not(:has(div))").each(function(){var aj=c(this).attr("id");var ag=aj.match("^pwr(.*?)-");var ai=ag[1];pr_page_id=ai;pr_snippet_id=aj;pr_snippet_min_reviews=parseInt(propertyValues.reviewsFeaturedItemsThreshold);var ad=c("#prSnippet"+pr_page_id);if(ad.length>0){var af=c(this);var ac=setInterval(function(){A(af,ad,ac);},100);setTimeout(function(){N(af,ac);},propertyValues.ajaxTimeout*5);}else{c(this).append("<div id='prSnippet"+pr_page_id+"'></div>");var ah;c(this).append("<iframe id='prIframe_"+pr_page_id+"' src='' class='hide'></iframe>");var ae=c("#prIframe_"+pr_page_id+"")[0];ah=ae.contentWindow.document;ah.open();ah.write=q;snippet(ah);ah.close();}});}}function A(ae,ad,ac){if(ad.html()!=""){var ab=ad.clone();ab.removeAttr("id");ae.html(c(ab));clearInterval(ac);}}function N(ac,ab){if(ac.find("div").length==0){ac.append("<div></div>");}clearInterval(ab);}function q(ab){c("#"+pr_snippet_id).append(ab);}function P(ae,aj,ad){var ab=ae.data("carwide");var ah=ae.data("currentPage");var af=0;if(aj>=1){af=aj;}if(ad!=0){if(aj>=1){af+=ad;}else{af=ah+ad;}}if(af<0){ah=0;}else{if(af>ae.data("maxpages")){af=ae.data("maxpages");}}var ai=(ab*ah)-1;var ak=ai-ab+1;if(ai>ae.data("size")-1){ai=ae.data("size")-1;}if(ak<0){ak=0;}if(af>0){var ac=(ab*af)-1;var ag=ai-ab+1;if(ac>ae.data("size")-1){ac=ae.data("size")-1;}if(ag<0){ag=0;}}else{if(ad==0){var ac=ae.data("size")-1;var ag=0;}}if(af>0||ad==0){j(ae,ag,ac,ak,ai);}}function l(aj,ag,ac){var ap=(new Date()).getTime();var ah=aj.attr("id");var au=aj.data("carwide");var an=aj.data("currentPage");var am=1;if(pageId=="home"){am=0;}if(ag!=0||ac!=0){var at=aj.data("b201").superWidth();var ao=aj.data("b201").superHeight();var ar="min-width:"+at+"px;"+"width:auto !important;"+"width:"+at+"px;"+"min-height:auto !important;"+"height:auto !important;"+"height:auto !important;";aj.data("b201").css("cssText",ar);}if(ag>0){an=ag;}an+=ac;if(an<1){an=1;}else{if(an>aj.data("maxpages")){an=aj.data("maxpages");}}if(ag==0&&ac==0&&aj.data("initialized")!=e){aj.data("b201").removeClass("expanded");}aj.data("initialized",true);aj.data("currentPage",an);var aq=(au*an)-1;var ai=aq-au+1;if(aq>aj.data("size")-1){aq=aj.data("size")-1;}if(ai<0){ai=0;}var ad=aq+(au*am);var ak=ai-(au*am);if(ad>aj.data("size")-1){ad=aj.data("size")-1;}if(ak<0){ak=0;}O(aj);j(aj,ak,ad,ai,aq);M(aj);S(aj,an);g(aj);aj.data("carouselStatus").html('<a href="#" class="expand">'+propertyValues.Carousel.expand+'<img src="" alt="" class="expandAll" border="0" /></a>');aj.data("carouselStatus").find("a.expand").click(function(av){av.preventDefault();B(aj);});aj.data("carouselStatus").find("a.expand").mouseover(function(){P(aj,0,0);});aj.data("nextButton").show();aj.data("prevButton").show();var af=c("#"+ah).find("li.pageNext");var ae=c("#"+ah).find("li.pagePrev");if(an>1){aj.data("prevButton").removeClass("inactive");ae.show();}else{aj.data("prevButton").addClass("inactive");ae.hide();}if(an<aj.data("maxpages")){aj.data("nextButton").removeClass("inactive");af.show();}else{aj.data("nextButton").addClass("inactive");af.hide();}var ab=(new Date()).getTime();if(D){var al=ab-ap;z("PerfForPageChanger ="+al);}}function B(ac){var ab=ac.attr("id");if(ac.data("maxpages")<=1){return false;}ac.data("b201").css("width",ac.data("b201").superWidth());ac.data("b201").addClass("expanded");j(ac,0,-1,0,-1);U(ac);var ab=ac.attr("id");var ad=propertyValues.Carousel.carouselitemtotal;ad=ad.replace(/\{0\}/g,ac.data("size"));ac.data("pageStatus").find(".note").html(ad);ac.data("pageStatus").find(".pageStatus").hide();ac.data("carouselStatus").html('<a href="#" class="collapse">'+propertyValues.Carousel.collapse+'<img src="" alt="" class="collapseAll" border="0" /></a> ');ac.data("carouselStatus").find("a.collapse").click(function(ae){ae.preventDefault();b.scrollTo(0,findPos(a.getElementById(ab)));l(ac,0,0);ac.data("pageStatus").find(".pageStatus").show();});ac.data("prevButton").hide();ac.data("nextButton").hide();}function F(ab){B(X[ab]);}function U(ab){for(var ag=1;ag<=ab.data("maxpages");ag++){var af=0;var ai=0;for(var ah=1;ah<=ab.data("carwide");ah++){var ak=(ah+((ag-1)*ab.data("carwide")))-1;var ae=ab.data("p01s").eq(ak).children("h4");var ad=ab.data("p01s").eq(ak).find("div.mathstory");var ac=ae.totalHeight();if(ac>af){af=ac;}var aj=ad.superHeight();if(aj>ai){ai=aj;}}for(var ah=1;ah<=ab.data("carwide");ah++){var ak=(ah+((ag-1)*ab.data("carwide")))-1;var ae=ab.data("p01s").eq(ak).children("h4");var ad=ab.data("p01s").eq(ak).find("div.mathstory");ae.css("height",af);ad.css("height",ai);}}}function i(ae){var ad="";if(typeof(variantPartnumber)!="undefined"){ad="variant_"+ae+"_"+variantPartnumber;}var ac=a.getElementById(ad);var ab="0";if((typeof(ac)!="undefined")&&(null!=ac)){ab=ac.value;}variantPartnumber="";if(typeof(parentSku)!="undefined"){if(typeof s_prodAffinity!=="undefined"){s_prodAffinity(parentSku,"Recommendations",ae,ab);}}else{if(typeof s_findMethod!=="undefined"){s_findMethod("Recommendations",ae,ab);}}}function W(){var ac=a.title,ab=ac.indexOf("|");Y();H=encodeURIComponent(ac.substring(0,ab-1));if(I!=""){Z(I);I="";}if(k[1]!=e){p(k[0],k[1]);personalizationDivId="";}}return{init:W,createResxPageId:Y,getResxPageId:h,loadCarousel:aa,loadPersonalizationImages:C,loadPersonalized:R,pageChanger:l,prepCarousel:t,processMath:n,showAll:F};})();return f;}(b.STAPLES||{}));b.STAPLES=d;d.Personalization.init();}(window,document,jQuery));