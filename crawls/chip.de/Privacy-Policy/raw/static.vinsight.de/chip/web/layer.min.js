(function(){var e,t,n,r,i=Array.prototype.slice,s=Object.prototype.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};if(typeof t=="undefined"||t===null)t={};t.util==null&&(t.util={}),t.layer==null&&(t.layer={}),t.layer.base==null&&(t.layer.base={}),t.layer.logging==null&&(t.layer.logging={}),t.layer.dispatch==null&&(t.layer.dispatch={}),t.layer.event==null&&(t.layer.event={}),t.layer.cookie==null&&(t.layer.cookie={}),t.layer.optout==null&&(t.layer.optout={}),t.adapters==null&&(t.adapters={}),t.adapters.base==null&&(t.adapters.base={}),t.adapters.logging==null&&(t.adapters.logging={}),t.adapters.vInsight==null&&(t.adapters.vInsight={}),this.vInsight==null&&(this.vInsight=t),t.collector==null&&(t.collector={}),t.collector.api==null&&(t.collector.api={}),t.collector.logging==null&&(t.collector.logging={}),t.util.Messages={ERROR_MIN_TWO_ARGUMENTS:"you need at least to specify 2 objects!",ERROR_WRONG_ARGUMENT_TYPES:"you need at least 2 objects to call this function",FATAL_TRACK:"track-method threw exception 0"},t.util.Logger=function(){function n(){}var e,t;return e=typeof console!="undefined"&&console!==null?console:null,n.debug=function(){var e;return e=1<=arguments.length?i.call(arguments,0):[],t("DEBUG",e)},n.info=function(){var e;return e=1<=arguments.length?i.call(arguments,0):[],t("INFO",e)},n.error=function(){var e;return e=1<=arguments.length?i.call(arguments,0):[],t("ERROR",e)},n.fatal=function(){var e;return e=1<=arguments.length?i.call(arguments,0):[],t("FATAL",e)},n.setConsole=function(t){return e=t},t=function(t,n){var r,i,s,o,u,a;if(typeof (e!=null?e.log:void 0)!="function")return;i=""+t+": "+n[0],a=n.splice(1);for(r=0,u=a.length;r<u;r++)o=a[r],s=new RegExp("#{"+r+"\\}","gi"),i=i.replace(s,o);return e.log(i)},n}(),t.util.DateUtil=function(){function e(){}return e.getCurrentTime=function(){return(new Date).getTime()},e}(),t.util.Properties=function(){function o(){}var e,n,r;return n=t.util.Messages,e=t.util.Logger,o.extend=function(){var t,s,o,u,a,f;return t=1<=arguments.length?i.call(arguments,0):[],t.length<2?(e.error(n.ERROR_MIN_TWO_ARGUMENTS),{}):(t.length===2&&(a=[!1,t[0],t[1]],s=a[0],o=a[1],u=a[2]),t.length>2&&(f=[t[0],t[1],t[2]],s=f[0],o=f[1],u=f[2]),typeof s!="boolean"||typeof o!="object"||typeof u!="object"?(e.error(n.ERROR_WRONG_ARGUMENT_TYPES),{}):r(s,o,u))},r=function(e,t,n){var i,o;for(i in n){if(!s.call(n,i))continue;o=n[i],t[i]==null||typeof o!="object"||!e?t[i]=o:t[i]=r(e,t[i],o)}return t},o}(),t.layer.logging.Messages={ERROR_DEFAULT_CONFIG_NO_OBJECT:"your default config specified is no valid object",ERROR_NO_EVENT:"event is not defined",ERROR_NO_MODULE:"module is not defined",ERROR_NO_TRACKER_NAME:"no tracker.NAME",ERROR_NO_VALID_CONFIG_OBJECT:"no valid config-object in setConfig",ERROR_OVERRIDE_CONFIG_NO_OBJECT:"your override config specified is no valid object",ERROR_PROCESS_DID_NOT_RETURN_OBJECT:"processConfig did not return an object, and is not used!",ERROR_PROCESS_PARAM_IS_NOT_A_FUNCTION:"param to processConfig is not a function",ERROR_REGISTER_NO_VALID_TRACKER:"you tried to register a not valid tracker-object #{0}",ERROR_WHILE_TRACKING_DOCUMENT_COMPLETE:"error while tracking document complete event #{0}",FATAL_DISPATCHER_CALL_TRACK:"There was an error while binding the objects metaData to the trackers #{0}",FATAL_DISPATCHER_HAS_NO_VALID_OBJ:"track method of dispatcher needs a valid pageObj",FATAL_NO_TRACKERS_IN_DISPATCHER:"you need to register at least 1 tracker in dispatcher"},t.layer.event.EventHandler=function(){function e(){}return e.addEvent=function(e,t){if(typeof window!="undefined"&&window!==null&&window.addEventListener!=null){window.addEventListener(e,t,!1);return}if(typeof document!="undefined"&&document!==null&&document.addEventListener!=null){document.addEventListener(e,t,!1);return}if(typeof window!="undefined"&&window!==null&&window.attachEvent!=null){window.attachEvent("on"+e,t);return}typeof document!="undefined"&&document!==null&&document.attachEvent!=null&&document.attachEvent("on"+e,t)},e}(),t.layer.dispatch.Dispatcher=function(){function o(){}var e,n,r,i,s;return r=null,s=null,i=null,e=t.util.Logger,n=t.layer.logging.Messages,o.INSTANCE=function(){return r==null&&(r=new this,r._init()),r},o.prototype.track=function(t){var i,o,u,a;if(t==null||t.tracker==null){e.fatal(n.FATAL_DISPATCHER_HAS_NO_VALID_OBJ);return}a=[];for(o=0,u=s.length;o<u;o++){i=s[o];if(r._isValidTracker(i)&&t.tracker.indexOf(i.NAME)!==-1)try{a.push(i.track(t))}catch(f){a.push(e.fatal(n.FATAL_DISPATCHER_CALL_TRACK,f))}else a.push(void 0)}return a},o.prototype.getTrackers=function(){return s},o.prototype.getTrackerNames=function(){return i},o.prototype.register=function(e){var t,n,i,s;n=typeof e=="object"&&e.length!=null?e:[e];for(i=0,s=n.length;i<s;i++)t=n[i],r._registerTracker(t);return r._setTrackerNames()},o.prototype._registerTracker=function(t){var i;return r._isValidTracker(t)?s.push(t):(i=t!=null&&t.NAME!=null?t.NAME:n.ERROR_NO_TRACKER_NAME,e.error(n.ERROR_REGISTER_NO_VALID_TRACKER,i))},o.prototype._setTrackerNames=function(){var e;return i=function(){var t,n,r;r=[];for(t=0,n=s.length;t<n;t++)e=s[t],r.push(e.NAME);return r}().join(",")},o.prototype._isValidTracker=function(e){return typeof e=="object"&&typeof e.track=="function"&&e.NAME!=null},o.prototype._init=function(){return s=[],i=""},o}(),t.layer.dispatch.PreDispatcher=function(){function r(){}var e,n;return r.DEFAULT_MODULE="page",r.DEFAULT_EVENT="view",r.EMPTY_DEFAULT_VALUE="null",e=t.util.Logger,n=t.layer.logging.Messages,r.getConfigForTrack=function(t,r,i){return r!=null?(r.module==null&&r.event==null&&(r.module=this.DEFAULT_MODULE,r.event=this.DEFAULT_EVENT),r.module==null&&(r.module=this.EMPTY_DEFAULT_VALUE,e.error(n.ERROR_NO_MODULE)),r.event==null&&(r.event=this.EMPTY_DEFAULT_VALUE,e.error(n.ERROR_NO_EVENT)),r.tracker==null&&(r.tracker=t!=null&&t.tracker!=null?t.tracker:i),r):t!=null?(t.module==null&&t.event==null&&(t.module=this.DEFAULT_MODULE,t.event=this.DEFAULT_EVENT),t.tracker==null&&(t.tracker=i),t):{module:this.EMPTY_DEFAULT_VALUE,event:this.EMPTY_DEFAULT_VALUE,tracker:this.EMPTY_DEFAULT_VALUE}},r}(),t.layer.cookie.CookieHandler=function(){function e(){}return e.getCookieArray=function(){var e;return e=document.cookie.split(";")},e.getCookie=function(e){var t,n,r,i,s,o;t=this.getCookieArray();for(n=0,o=t.length-1;0<=o?n<=o:n>=o;0<=o?n++:n--){r=t[n].indexOf("="),i=t[n].substr(0,r),s=t[n].substr(r+1),i=i.replace(/^\s+|\s+$/g,"");if(i===e)return s}return null},e.setCookie=function(e,t,n){var r,i;return i=new Date,i.setDate(i.getDate()+n),r=escape(t)+(n===null?"":"; expires="+i.toUTCString()),document.cookie=""+e+"="+r+";"},e.removeCookie=function(e){return this.setCookie(e,null,-1)},e}(),t.layer.optout.OptOut=function(){function e(){}return e.c_name="optedOut",e.__CookieHandler=t.layer.cookie.CookieHandler,e.optOut=function(){return this.setOptCookie(!0,99999)},e.optIn=function(){return this.setOptCookie(!1,99999)},e.isOptedOut=function(){var e;return e=this.__CookieHandler.getCookie(this.c_name),e!=null?e==="true":!1},e.setOptCookie=function(e,t){return this.__CookieHandler.setCookie(this.c_name,e,t)},e.removeOptCookie=function(){return this.__CookieHandler.removeCookie(this.c_name)},e}(),t.layer.base.Base=function(){function v(){}var e,n,r,i,s,o,u,a,f,l,c,h,p,d;return v.NO_DOCUMENT_TITLE="notitle",f=null,l=null,c=null,h=null,n=t.layer.dispatch.Dispatcher,u=t.layer.dispatch.PreDispatcher,i=t.util.Logger,s=t.layer.logging.Messages,r=t.layer.event.EventHandler,e=t.util.DateUtil,a=t.util.Properties,o=t.layer.optout.OptOut,v.init=function(){return p(),d()},v.track=function(e){var t,r;if(o.isOptedOut())return;t=n.INSTANCE().getTrackerNames();if(t==null||t.length<=0){i.fatal(s.FATAL_NO_TRACKERS_IN_DISPATCHER);return}return r=u.getConfigForTrack(this.getConfig(),e,t),n.INSTANCE().track(r)},v.setConfig=function(e){var t,n;if(e==null||typeof e!="object"){i.error(s.ERROR_NO_VALID_CONFIG_OBJECT);return}f=e,this.getDefaultConfig()&&(f=a.extend(this.getDefaultConfig(),f)),this.getOverrideConfig()&&(f=a.extend(f,this.getOverrideConfig())),typeof this.getProcessConfig()=="function"&&(n=this.getProcessConfig()(f),typeof n=="object"?f=n:i.error(s.ERROR_PROCESS_DID_NOT_RETURN_OBJECT)),t=typeof document!="undefined"&&document!==null&&document.title!=null?document.title:this.NO_DOCUMENT_TITLE,f=a.extend(f,{titel:t});if(f.firsttracker!=null)return f.tracker=f.firsttracker,delete f.firsttracker},v.getConfig=function(){return f},v.resetConfig=function(){return f=null},v.setDefaultConfig=function(e){return typeof e=="object"?l=e:i.error(s.ERROR_DEFAULT_CONFIG_NO_OBJECT)},v.getDefaultConfig=function(){return l},v.setOverrideConfig=function(e){return typeof e=="object"?c=e:i.error(s.ERROR_OVERRIDE_CONFIG_NO_OBJECT)},v.getOverrideConfig=function(){return c},v.setProcessConfig=function(e){return typeof e=="function"||e===null?h=e:i.error(s.ERROR_PROCESS_PARAM_IS_NOT_A_FUNCTION)},v.getProcessConfig=function(){return h},v.getLastTrackers=function(){return f!=null?f.lasttracker:void 0},d=function(){return r.addEvent("unload",function(){return t.layer.base.Base.track({module:"document",event:"unloaded"})})},p=function(){return r.addEvent("load",function(){t.layer.base.Base.track({module:"document",event:"loaded"});if(t.layer.base.Base.getLastTrackers()!=null)try{return t.layer.base.Base.track({tracker:t.layer.base.Base.getLastTrackers()})}catch(e){return i.error(s.ERROR_WHILE_TRACKING_DOCUMENT_COMPLETE,e)}})},v}(),t.adapters.logging.Messages={INFO_UNHANDLED_EVENT:"unhandled event in Adapter #{0}: #{1}",ERROR_IN_CONFIG_OF_TRACK_METHOD:"you called the track-method of adapter #{0} with a non valid config",ERROR_NO_VALID_EVENT:"you tried to register non valid events to adapter #{0}",ERROR_NO_VALID_OBJECT:"no valid object in adapter #{0}",ERROR_NOT_ALL_PROPERTIES_OF_EVENTS_ARE_VALID:"not all properties when registering events to adapter #{0} are correct (string: function)"},t.adapters.base.BaseAdapter=function(){function i(e,t){this.NAME=e,this.NATIVE=t,this.events={}}var e,n,r;return e=t.util.Logger,r=t.util.Properties,n=t.adapters.logging.Messages,i.prototype.track=function(t){var r;if(t==null||typeof t!="object"){e.error(n.ERROR_IN_CONFIG_OF_TRACK_METHOD,this.NAME);return}return r=""+t.module+"_"+t.event,this.events[r]!=null&&typeof this.events[r]=="function"?this.events[r].call(this.NATIVE,t):e.info(n.INFO_UNHANDLED_EVENT,this.NAME,r)},i.prototype.registerEvents=function(t){var i,s;if(typeof t!="object"){e.error(n.ERROR_NO_VALID_EVENT,this.NAME);return}for(i in t){s=t[i];if(typeof i!="string"||typeof s!="function"){e.error(n.ERROR_NOT_ALL_PROPERTIES_OF_EVENTS_ARE_VALID,this.NAME);return}}return r.extend(this.events,t)},i.prototype.getEvents=function(){return this.events},i}(),t.adapters.vInsight.VInsightAdapter=function(e){function n(e,r,i){this.NAME=e,this.NATIVE=r,n.__super__.constructor.apply(this,arguments);if(typeof i!="object"){t.util.Logger.error(t.adapters.logging.Messages.ERROR_NO_VALID_OBJECT,this.NAME);return}this.NATIVE.setConfig(i)}return o(n,e),n}(t.adapters.base.BaseAdapter),t.collector.logging.Messages={INFO_WRONG_NUMBER_OF_ARGUMENTS:"The Function 'pushVar' has not the right number of arguments: must have a valid (String)key,(String)value"},t.collector.Api=function(){function c(){}var e,n,r,i,s,o,u,a,f,l;return a="nourl",f="nourl",r={},s={},o={},l={},u={},i={page:s,session:o,visitor:l,"vinsight-test":u},e=t.util.Logger,n=t.collector.logging.Messages,c.setConfig=function(e){return a=e.trackerURL,f=e.trackerURLSSL},c.trackPageview=function(){return this.pushEvent("page_view"),t.collector.Sender.send(this.getVariables()),this.clearEvents()},c.clearEvents=function(){return r={}},c.resetCollector=function(){return r={},s={},o={},l={},u={}},c.pushVar=function(t,r,o){var u;return o==null&&(o="page"),u=i[o]||s,t!=null&&r!=null&&t!==""&&r!==""&&r!=="undefined"?u[this.clearOffSpecialChars(t)]=this.clearOffSpecialChars(r):e.info(n.INFO_WRONG_NUMBER_OF_ARGUMENTS,"vInsight.collector.Api.pushVar",t,r)},c.pushEvent=function(e){if(e==null)return;return e=this.clearOffSpecialChars(e),r[e]!=null?r[e]=r[e]+1:r[e]=1},c.getVariables=function(){return{__pageVariables:s,__sessionVariables:o,__visitorVariables:l,__events:r,__testVariables:u,__trackerURL:a,__trackerURLSSL:f}},c.getTrackerURL=function(){return a},c.getTrackerURLSSL=function(){return f},c.clearOffSpecialChars=function(e){return e.replace(/[^a-zA-Z 0-9 . -]+/g,"")},c}(),t.collector.Sender=function(){function i(){}var n,r;return r="nourl",n=t.util.Logger,i.send=function(e){var t;return r=this.toURL(e),t=this.createNewImage(),t.src=r},i.toURL=function(e){var t;return e=this.extendObj(e),t=this.createParams(),this.createBaseUrl(e,t)},i.createParams=function(){var t,n,r;t=(typeof e!="undefined"&&e!==null?e.INFO:void 0)||{};if(typeof document=="undefined"||document===null)document={};return r=(typeof window!="undefined"&&window!==null?window.screen:void 0)||{},n={t:(new Date).getTime(),ref:this.ensure(document.referrer,"direct"),url:this.ensure(document.URL,"nourl"),width:this.ensure(r.width),height:this.ensure(r.height),customer_id:this.ensure(t.customer_id,"nocustomerid"),versions:{framework:this.ensure(t.version,"noversion"),layer:this.ensure(t.layer_version,"noversion"),util:this.ensure(t.util_version,"noversion"),adapter:this.ensure(t.adapter_version,"noversion"),collector:this.ensure(t.collector_version,"noversion")}}},i.ensure=function(e,t){return e!=null&&e!==""?e:t},i.extendObj=function(e){var t,n,r,i;return e.__pageVariables==null&&(e.__pageVariables={}),n=typeof document!="undefined"&&document!==null&&document.title!=null&&document.title!==""?document.title:"notitle",((r=e.__pageVariables)!=null?r.pagename:void 0)==null?e.__pageVariables.pagename=n:e.__pageVariables.doctitle=n,t=typeof document!="undefined"&&document!==null&&document.domain!=null&&document.domain!==""?document.domain:"nodomain",((i=e.__pageVariables)!=null?i.domain:void 0)==null&&(e.__pageVariables.domain=t),e},i.createBaseUrl=function(e,t){var n,r,i;return n="https:"===document.location.protocol?""+((i=e.__trackerURLSSL)!=null?i:e.__trackerURL):""+e.__trackerURL,r=this.appendToObj({},"pv",e.__pageVariables),r=this.appendToObj(r,"sv",e.__sessionVariables),r=this.appendToObj(r,"vv",e.__visitorVariables),r=this.appendToObj(r,"ev",e.__events),r=this.appendToObj(r,"pr",t),r=this.appendToObj(r,"testparams",e.__testVariables),this.appendToURL(n,"vidat",r)},i.appendToObj=function(e,t,n){return typeof e!="object"&&(e={}),typeof t=="string"&&typeof n=="object"&&!this.isEmptyObj(n)&&(e[t]=n),e},i.appendToURL=function(e,t,r){var i;if(e==null)return n.error("not a valid url, could not append params"),"";if(r==null||r===""||t==null||t==="")return e;if(typeof r=="object"){r=JSON.stringify(r);if(r==="{}")return e}else if(typeof r!="string")return e;return i="&",e.match(/\?/)||(i="?"),e+=""+i+t+"="+encodeURIComponent(r)},i.isEmptyObj=function(e){var t,n;for(t in e){n=e[t];if(e.hasOwnProperty(t))return!1}return!0},i.createNewImage=function(){return new Image},i}(),this.VALITON_WA=e={run:t.layer.base.Base.init(),setProp:function(e){return t.layer.base.Base.setConfig(e)},track:function(e){try{return t.layer.base.Base.track(e)}catch(n){return t.util.Logger.fatal(t.util.Messages.FATAL_TRACK,n)}},register:function(e){return t.layer.dispatch.Dispatcher.INSTANCE().register(e)},setDefaultProp:function(e){return t.layer.base.Base.setDefaultConfig(e)},setOverrideProp:function(e){return t.layer.base.Base.setOverrideConfig(e)},setProcessProp:function(e){return t.layer.base.Base.setProcessConfig(e)},optOut:function(){return t.layer.optout.OptOut.optOut()},optIn:function(){return t.layer.optout.OptOut.optIn()},isOptedOut:function(){return t.layer.optout.OptOut.isOptedOut()}},r={page_view:function(e){return(e!=null?e.domain:void 0)!=null&&this.pushVar("domain",e.domain),(e!=null?e.subdomain:void 0)!=null&&this.pushVar("subdomain",e.subdomain),(e!=null?e.pagename:void 0)!=null&&this.pushVar("pagename",e.pagename),(e!=null?e.section_1:void 0)!=null&&this.pushVar("section_1",e.section_1),(e!=null?e.section_2:void 0)!=null&&this.pushVar("section_2",e.section_2),(e!=null?e.section_3:void 0)!=null&&this.pushVar("section_3",e.section_3),(e!=null?e.section_4:void 0)!=null&&this.pushVar("section_4",e.section_4),(e!=null?e.section_5:void 0)!=null&&this.pushVar("section_5",e.section_5),(e!=null?e.contentType:void 0)!=null&&this.pushVar("contentType",e.contentType),this.trackPageview()},document_loaded:function(e){},document_unloaded:function(e){}},n=new t.adapters.vInsight.VInsightAdapter("vInsightAdapter",this.vInsight.collector.Api,{trackerURL:"http://tracker.vinsight.de/",trackerURLSSL:"https://tracker.vinsight.de"}),n.registerEvents(r),e.register(n),e.INFO={name:"layer",environment:"production",customer_id:"chip",version:"4.0.2",description:"WA-Framework for chip.de",author:"Valiton GmbH",created:"Mon Jul 09 2012 13:32:51 GMT+0200 (CEST)",util_version:"0.1.3",layer_version:"0.1.4",adapter_version:"0.1.2",collector_version:"0.4.8"}}).call(this)