if(!Function.prototype.bind){Function.prototype.bind=function(a){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")}var e=Array.prototype.slice.call(arguments,1),d=this,b=function(){},c=function(){return d.apply(this instanceof b&&a?this:a,e.concat(Array.prototype.slice.call(arguments)))};b.prototype=this.prototype;c.prototype=new b();return c}}var skroller;var faqObj;var downloadLayer;var isMobile=false;function updateFeatureScrollerSize(){var e=900;if(!isMobile){var d=1.5;if($("#featureScroller").size()>0){var a=imgHeight=$(window).height();var c=0;if(a>$(window).width()/d){imgHeight=$(window).width()/d}if(imgHeight>e){c=(($(window).height())-e)/2;imgHeight=e}$("LI","#featureScroller").css("height",a);$(".backgroundHolder","#featureScroller").css("height",a);$(".backgroundHolder","#featureScroller").css("background-size",(imgHeight*d)+"px "+imgHeight+"px");var b=$("#featureScroller").width()-$(".featureWrapper > DIV").offset().left-(imgHeight*d);$(".featureWrapper .backgroundHolder","#featureScroller").css({"background-position":b+"px "+c+"px","background-attachment":"fixed"});$("#feature1 .backgroundHolder","#featureScroller").attr({"data-top":"background-position: "+b+"px "+c+"px","data-bottom-top":"background-position: "+b+"px "+a+"px"});$("#feature3 .backgroundHolder","#featureScroller").attr({"data-bottom":"background-position: "+b+"px "+c+"px","data-top-bottom":"background-position: "+b+"px -"+a+"px"})}}}$(document).ready(function(){(function(b){if(/android|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(ad|hone|od)|iris|kindle|lge |maemo|meego.+mobile|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|playbook|silk/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4))){isMobile=true}})(navigator.userAgent||navigator.vendor||window.opera);updateFeatureScrollerSize();if(!isMobile){skroller=skrollr.init({smoothScrolling:true,forceHeight:false})}$(".carousel").carousel({interval:5000}).carousel("cycle");faqObj=new FAQ("faqQuestionWrapper");downloadLayer=new DownloadLayer("download");$("#btnGetApp").bind("vclick",function(){downloadLayer.toggle()})});$(window).resize(function(){updateFeatureScrollerSize();skroller.refresh()});function checkPassword(b,a){var d=getPasswordStrength($(b).val());var c="none";$("#"+a).parents(".control-group").removeClass("error info success");var e=new Array(Translator.get("passwordStrength.blank"),Translator.get("passwordStrength.very_weak"),Translator.get("passwordStrength.weak"),Translator.get("passwordStrength.medium"),Translator.get("passwordStrength.strong"),Translator.get("passwordStrength.very_strong"));switch(d){case 0:case 1:c="error";break;case 2:case 3:c="info";break;case 4:case 5:c="success";break}if(e&&e[d]){$("#"+a).text(e[d])}$("#"+a).parents(".control-group").addClass(c)}function checkPasswordRepeat(c,b,a){$("#"+a).parents(".control-group").removeClass("error success");$("#"+a).parents(".control-group").addClass(($(b).val()==c)?"success":"error")}function getPasswordStrength(a){var b=1;if(a.length<1){return 0}if(a.length<6){return 1}if(a.length>=6){b++}if(a.length>=12){b++}if(/[a-z]/.test(a)&&/[A-Z]/.test(a)){b++}if(/[0-9]/.test(a)){b++}if(/.[!,@,#,$,%,^,&,*,?,_,~,-,ï¿½,(,)]/.test(a)){b++}return b}function updateExportProgress(b,d,a){var c=false;$.ajax({url:d,success:function(f){if(f.progressData){var e=f.progressData.progress;if(e<100||f.progressData.url==null){$(".progress .bar",b).css("width",e+"%");$(".progress .bar SPAN",b).text(e+"%");$("#exportButton",b).hide();c=true;a=false}else{$(".progress",b).hide();$("#exportButton",b).show();$(".downloadLink",b).show();$(".downloadLink",b).attr("href",f.progressData.url)}}else{if(a){window.location.reload()}else{c=true;a=true}}},error:function(){if(a){window.location.reload()}else{c=true;a=true}},complete:function(){if(c){window.setTimeout(function(){updateExportProgress(b,d,a)},2000)}}})};
var DownloadLayer=function(a){this._scrollTop=0;this._wrapper=$("#"+a);this._maxHeight=this._wrapper.height();if(this._wrapper.size()>0){$(window).scroll(function(){this.scroll()}.bind(this))}this.scroll=function(){if(this._wrapper.size()){if(this._wrapper.is(":visible")){var e=$(window).scrollTop();var c=this._scrollTop-e;var d=this._wrapper.height();var b=d+c;b=Math.max(0,Math.min(b,this._maxHeight));if(b==0){this._wrapper.css("display","none");b=this._maxHeight}if(Math.abs(c)>30){this._wrapper.animate({height:b},Math.abs(c))}else{this._wrapper.css("height",b)}this._scrollTop=e}}}};DownloadLayer.prototype.scrollTop=function(a){if(a){this._scrollTop=a}else{return this._scrollTop}};DownloadLayer.prototype.toggle=function(){this._wrapper.removeClass("animating").slideToggle(400,function(){this.scrollTop($(window).scrollTop());this._wrapper.css("height",this._maxHeight)}.bind(this))};
var FAQ=function(a){this._wrapper=$("#"+a);$(".question",this._wrapper).on("vclick",this.questionClickHandler.bind(this)).attr("href","#")};FAQ.prototype.questionClickHandler=function(b){var a=$(b.target).parents("li");this.questionToggle($(".answerWrapper",a));return false};FAQ.prototype.getNeededSpace=function(a){var c=$(a).clone();c.appendTo(a.parent());c.css("opacity","0.1");c.css("height","auto");var b=c.height();c.remove();return b};FAQ.prototype.questionToggle=function(a){if($(a).height()==0){this.questionOpen($(a))}else{this.questionClose($(a))}};FAQ.prototype.questionOpen=function(b){if($(b).height()==0){this.closeAll();var a=this.getNeededSpace(b);b.css("height",a+11);b.css("top",$(b).parent().height()-10);$(b).parent().nextAll().css("marginTop",(a-30))}};FAQ.prototype.questionClose=function(b){if($(b).height()>0){var a=this.getNeededSpace(b);b.css("height",0);$(b).parent().nextAll().css("marginTop","0")}};FAQ.prototype.closeAll=function(){$("LI",this._wrapper).each(function(a,b){this.questionClose($(".answerWrapper",b))}.bind(this))};
var DeviceManager=function(){this._deviceList=null;this._devices=new Array();this.init=function(){var a=this;$(".device",this.getDeviceList()).each(function(b,c){this._devices.push(new Device(c,this))}.bind(this));$(document).on("click.editable",function(f){var b=$(f.target),c,d=[".device"];for(c=0;c<d.length;c++){if(b.is(d[c])||b.parents(d[c]).length){return}}a.closeOthers(b)})};this.closeOthers=function(a){this._devices.forEach(function(b){if(b===a||$(b._item).find(a).length){return}b.cancel()})};this.getDeviceList=function(){if(this._deviceList==null){this._deviceList=$("#deviceList")}return this._deviceList};this.removeDevice=function(a){if($.contains(this._devices,a)){this._devices.splice(this._devices.indexOf(a),1)}if(this._devices.length==0){window.location.reload()}};this.init()};var Device=function(b,a){this._item=b;this._id=$(b).attr("id");this._value=$("INPUT",b).val();this._state=null;this._manager=a;this.init=function(){$(".actionEdit",this._item).on("click",$.proxy(this.toggleEdit,this));$(".actionOk",this._item).on("click",$.proxy(this.submit,this));$(".actionRemove",this._item).on("click",$.proxy(this.remove,this));this._state="disabled"};this.keyUp=function(c){if(c.which===27){this.cancel()}if(c.which===13){this.submit()}};this.hasChanges=function(){return this._value!=$("INPUT",this._item).val()};this.onSaved=function(){this._value=$("INPUT",this._item).val()};this.onError=function(c){$(".alert",$(this._item)).remove();$('<div class="alert alert-block alert-error">'+c+"</div>").prependTo($(this._item))};this.toggleEdit=function(){if(this._state=="disabled"){this.enableEditing()}else{this.disableEditing()}return false};this.submit=function(){if(this.hasChanges()){this.save($("INPUT",this._item).val())}this.disableEditing();return false};this.cancel=function(){$("INPUT",this._item).val(this._value);$(".alert",$(this._item)).remove();this.disableEditing()};this.enableEditing=function(){this._manager.closeOthers(this);$("INPUT",this._item).attr("disabled",false);$("INPUT",this._item).on("keyup",$.proxy(this.keyUp,this));$("INPUT",this._item).focus();$(".actionEdit",this._item).addClass("hidden");$(".actionOk",this._item).removeClass("hidden");this._state="editing"};this.disableEditing=function(){$("INPUT",this._item).attr("disabled",true);$("INPUT",this._item).off("keyup");$("INPUT",this._item).blur();$(".actionEdit",this._item).removeClass("hidden");$(".actionOk",this._item).addClass("hidden");this._state="disabled"};this.save=function(d){var c=this;$.ajax({type:"POST",url:Routing.generate("pd2013_account_devices_rename",{deviceId:this._id}),data:{value:d},context:$("#"+this._id)}).success(function(){c.onSaved()}).error(function(g,e,f){c.onError(g.responseText);c.enableEditing()})};this.remove=function(){var c=this;if(window.confirm(Translator.get("device.remove.confirm",{name:this._value}))){$.ajax({url:Routing.generate("pd2013_account_devices_remove",{deviceId:this._id}),context:$("#"+this._id)}).success(function(){c._manager.removeDevice(c);$(this).hide("blind",500,function(){this.remove()})}).error(function(f,d,e){$(".alert",this).remove();$('<div class="alert alert-block alert-error">'+f.responseText+"</div>").prependTo($(this))})}return false};this.init()};