/*
	Copyright (c) 2004-2010, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

/*
	This is an optimized version of Dojo, built for deployment and not for
	development. To get sources and documentation, please visit:

		http://dojotoolkit.org
*/

dojo.provide("ag.layers.ext");if(!dojo._hasResource["ag.ads._base"]){dojo._hasResource["ag.ads._base"]=true;dojo.provide("ag.ads._base");ag.ads.toString=function(){return "AGAds";};ag.ads._728x90="agi-ad728x90";ag.ads._160x600="agi-ad160x600";ag.ads._336x280="agi-ad336x280";}if(!dojo._hasResource["ag.ads"]){dojo._hasResource["ag.ads"]=true;dojo.provide("ag.ads");}if(!dojo._hasResource["ag.ads.AdManagerMixin"]){dojo._hasResource["ag.ads.AdManagerMixin"]=true;dojo.provide("ag.ads.AdManagerMixin");dojo.declare("ag.ads.AdManagerMixin",[ag.classes._Mixin],{adManagerIframes:[],ADS_728x90_QUERY:"#"+ag.ads._728x90+" iframe",ADS_160x600_QUERY:"#"+ag.ads._160x600+" iframe",ADS_336x280_QUERY:"#"+ag.ads._336x280+" iframe",constructor:function(){this.adManagerInitIframes();},adManagerInitIframes:function(){this.adManagerIframes=[];this.adManagerIframes.extend(dojo.query(this.ADS_728x90_QUERY));this.adManagerIframes.extend(dojo.query(this.ADS_160x600_QUERY));this.adManagerIframes.extend(dojo.query(this.ADS_336x280_QUERY));},adManagerReload:function(){dojo.forEach(this.adManagerIframes,function(_1){_1.src=_1.src;});}});}if(!dojo._hasResource["agi.go.flashalbum"]){dojo._hasResource["agi.go.flashalbum"]=true;dojo.provide("agi.go.flashalbum");agi.go.flashalbum.window=null;agi.go.flashalbum.close=function(){try{if(agi.go.flashalbum.window){agi.go.flashalbum.window.close();}}catch(e){}agi.go.flashalbum.window=null;};agi.go.flashalbum.open=function(_2,_3,_4){if(!_3){_3=625;}if(!_4){_4=525;}var _5="location=0,menubar=0,toolbar=0,status=1,scrollbars=1,resizable=1,directories=0";var l=(screen.width-_3)/2;var t=(screen.height-_4)/2;if(l<0){l=0;}if(t<0){t=0;}var w=_3-12;var h=_4-61;var _6="width="+w+",height="+h+",left="+l+",top="+t;agi.go.flashalbum.window=window.open(_2,"fpaPopupWindow",_6+","+_5);};}if(!dojo._hasResource["ag.go.flashalbum"]){dojo._hasResource["ag.go.flashalbum"]=true;dojo.provide("ag.go.flashalbum");ag.go.flashalbum=agi.go.flashalbum;}if(!dojo._hasResource["ag.nav.AppState"]){dojo._hasResource["ag.nav.AppState"]=true;dojo.provide("ag.nav.AppState");dojo.declare("ag.nav.AppState",[ag.classes.Identified],{changeUrl:null,filterText:null,goAlpha:null,pageNumber:null,pageSetter:null,sortOrder:null,viewAll:null,windowSize:null,constructor:function(_7){this.pageSetter=_7.pageSetter;this.filterText=_7.filterText||"";this.goAlpha=_7.goAlpha||"";this.pageNumber=_7.pageNumber||"";this.sortOrder=_7.sortOrder||"";this.viewAll=_7.viewAll||0;this.windowSize=_7.windowSize||"";this.changeUrl=this._makeHash();},setPage:function(){var hf=dojo.byId("hidden-filter");var hp=dojo.byId("hidden-page");var hs=dojo.byId("hidden-sort");var hv=dojo.byId("hidden-viewall");var hw=dojo.byId("hidden-window");if(hf){hf.value=this.filterText||"";}if(hp){hp.value=this.pageNumber||"";}if(hs){hs.value=this.sortOrder||"";}if(hv){hv.value=this.viewAll||0;}if(hw){hw.value=this.windowSize||"";}},back:function(){if(!this.pageSetter){return;}this.setPage();this.pageSetter(this.pageNumber);if(dojo.isIE){location.hash="";}},forward:function(){if(!this.pageSetter){return;}this.setPage();this.pageSetter(this.pageNumber);},_makeHash:function(){args=[this.pageNumber];if(this.viewAll){args.push("al1");}if(this.sortOrder){args.push("so"+this.sortOrder);}return args.join("_");}});}if(!dojo._hasResource["dojo.back"]){dojo._hasResource["dojo.back"]=true;dojo.provide("dojo.back");(function(){var _8=dojo.back;function _9(){var h=window.location.hash;if(h.charAt(0)=="#"){h=h.substring(1);}return dojo.isMozilla?h:decodeURIComponent(h);};function _a(h){if(!h){h="";}window.location.hash=encodeURIComponent(h);_b=history.length;};if(dojo.exists("tests.back-hash")){_8.getHash=_9;_8.setHash=_a;}var _c=(typeof (window)!=="undefined")?window.location.href:"";var _d=(typeof (window)!=="undefined")?_9():"";var _e=null;var _f=null;var _10=null;var _11=null;var _12=[];var _13=[];var _14=false;var _15=false;var _b;function _16(){var _17=_13.pop();if(!_17){return;}var _18=_13[_13.length-1];if(!_18&&_13.length==0){_18=_e;}if(_18){if(_18.kwArgs["back"]){_18.kwArgs["back"]();}else{if(_18.kwArgs["backButton"]){_18.kwArgs["backButton"]();}else{if(_18.kwArgs["handle"]){_18.kwArgs.handle("back");}}}}_12.push(_17);};_8.goBack=_16;function _19(){var _1a=_12.pop();if(!_1a){return;}if(_1a.kwArgs["forward"]){_1a.kwArgs.forward();}else{if(_1a.kwArgs["forwardButton"]){_1a.kwArgs.forwardButton();}else{if(_1a.kwArgs["handle"]){_1a.kwArgs.handle("forward");}}}_13.push(_1a);};_8.goForward=_19;function _1b(url,_1c,_1d){return {"url":url,"kwArgs":_1c,"urlHash":_1d};};function _1e(url){var _1f=url.split("?");if(_1f.length<2){return null;}else{return _1f[1];}};function _20(){var url=(dojo.config["dojoIframeHistoryUrl"]||dojo.moduleUrl("dojo","resources/iframe_history.html"))+"?"+(new Date()).getTime();_14=true;if(_11){dojo.isWebKit?_11.location=url:window.frames[_11.name].location=url;}else{}return url;};function _21(){if(!_15){var hsl=_13.length;var _22=_9();if((_22===_d||window.location.href==_c)&&(hsl==1)){_16();return;}if(_12.length>0){if(_12[_12.length-1].urlHash===_22){_19();return;}}if((hsl>=2)&&(_13[hsl-2])){if(_13[hsl-2].urlHash===_22){_16();return;}}if(dojo.isSafari&&dojo.isSafari<3){var _23=history.length;if(_23>_b){_19();}else{if(_23<_b){_16();}}_b=_23;}}};_8.init=function(){if(dojo.byId("dj_history")){return;}var src=dojo.config["dojoIframeHistoryUrl"]||dojo.moduleUrl("dojo","resources/iframe_history.html");if(dojo._postLoad){}else{document.write("<iframe style=\"border:0;width:1px;height:1px;position:absolute;visibility:hidden;bottom:0;right:0;\" name=\"dj_history\" id=\"dj_history\" src=\""+src+"\"></iframe>");}};_8.setInitialState=function(_24){_e=_1b(_c,_24,_d);};_8.addToHistory=function(_25){_12=[];var _26=null;var url=null;if(!_11){if(dojo.config["useXDomain"]&&!dojo.config["dojoIframeHistoryUrl"]){}_11=window.frames["dj_history"];}if(!_10){_10=dojo.create("a",{style:{display:"none"}},dojo.body());}if(_25["changeUrl"]){_26=""+((_25["changeUrl"]!==true)?_25["changeUrl"]:(new Date()).getTime());if(_13.length==0&&_e.urlHash==_26){_e=_1b(url,_25,_26);return;}else{if(_13.length>0&&_13[_13.length-1].urlHash==_26){_13[_13.length-1]=_1b(url,_25,_26);return;}}_15=true;setTimeout(function(){_a(_26);_15=false;},1);_10.href=_26;if(dojo.isIE){url=_20();var _27=_25["back"]||_25["backButton"]||_25["handle"];var tcb=function(_28){if(_9()!=""){setTimeout(function(){_a(_26);},1);}_27.apply(this,[_28]);};if(_25["back"]){_25.back=tcb;}else{if(_25["backButton"]){_25.backButton=tcb;}else{if(_25["handle"]){_25.handle=tcb;}}}var _29=_25["forward"]||_25["forwardButton"]||_25["handle"];var tfw=function(_2a){if(_9()!=""){_a(_26);}if(_29){_29.apply(this,[_2a]);}};if(_25["forward"]){_25.forward=tfw;}else{if(_25["forwardButton"]){_25.forwardButton=tfw;}else{if(_25["handle"]){_25.handle=tfw;}}}}else{if(!dojo.isIE){if(!_f){_f=setInterval(_21,200);}}}}else{url=_20();}_13.push(_1b(url,_25,_26));};_8._iframeLoaded=function(evt,_2b){var _2c=_1e(_2b.href);if(_2c==null){if(_13.length==1){_16();}return;}if(_14){_14=false;return;}if(_13.length>=2&&_2c==_1e(_13[_13.length-2].url)){_16();}else{if(_12.length>0&&_2c==_1e(_12[_12.length-1].url)){_19();}}};})();}if(!dojo._hasResource["dijit._Contained"]){dojo._hasResource["dijit._Contained"]=true;dojo.provide("dijit._Contained");dojo.declare("dijit._Contained",null,{getParent:function(){var _2d=dijit.getEnclosingWidget(this.domNode.parentNode);return _2d&&_2d.isContainer?_2d:null;},_getSibling:function(_2e){var _2f=this.domNode;do{_2f=_2f[_2e+"Sibling"];}while(_2f&&_2f.nodeType!=1);return _2f&&dijit.byNode(_2f);},getPreviousSibling:function(){return this._getSibling("previous");},getNextSibling:function(){return this._getSibling("next");},getIndexInParent:function(){var p=this.getParent();if(!p||!p.getIndexOfChild){return -1;}return p.getIndexOfChild(this);}});}if(!dojo._hasResource["dijit.layout._LayoutWidget"]){dojo._hasResource["dijit.layout._LayoutWidget"]=true;dojo.provide("dijit.layout._LayoutWidget");dojo.declare("dijit.layout._LayoutWidget",[dijit._Widget,dijit._Container,dijit._Contained],{baseClass:"dijitLayoutContainer",isLayoutContainer:true,postCreate:function(){dojo.addClass(this.domNode,"dijitContainer");this.inherited(arguments);},startup:function(){if(this._started){return;}this.inherited(arguments);var _30=this.getParent&&this.getParent();if(!(_30&&_30.isLayoutContainer)){this.resize();this.connect(dojo.isIE?this.domNode:dojo.global,"onresize",function(){this.resize();});}},resize:function(_31,_32){var _33=this.domNode;if(_31){dojo.marginBox(_33,_31);if(_31.t){_33.style.top=_31.t+"px";}if(_31.l){_33.style.left=_31.l+"px";}}var mb=_32||{};dojo.mixin(mb,_31||{});if(!("h" in mb)||!("w" in mb)){mb=dojo.mixin(dojo.marginBox(_33),mb);}var cs=dojo.getComputedStyle(_33);var me=dojo._getMarginExtents(_33,cs);var be=dojo._getBorderExtents(_33,cs);var bb=(this._borderBox={w:mb.w-(me.w+be.w),h:mb.h-(me.h+be.h)});var pe=dojo._getPadExtents(_33,cs);this._contentBox={l:dojo._toPixelValue(_33,cs.paddingLeft),t:dojo._toPixelValue(_33,cs.paddingTop),w:bb.w-pe.w,h:bb.h-pe.h};this.layout();},layout:function(){},_setupChild:function(_34){dojo.addClass(_34.domNode,this.baseClass+"-child");if(_34.baseClass){dojo.addClass(_34.domNode,this.baseClass+"-"+_34.baseClass);}},addChild:function(_35,_36){this.inherited(arguments);if(this._started){this._setupChild(_35);}},removeChild:function(_37){dojo.removeClass(_37.domNode,this.baseClass+"-child");if(_37.baseClass){dojo.removeClass(_37.domNode,this.baseClass+"-"+_37.baseClass);}this.inherited(arguments);}});dijit.layout.marginBox2contentBox=function(_38,mb){var cs=dojo.getComputedStyle(_38);var me=dojo._getMarginExtents(_38,cs);var pb=dojo._getPadBorderExtents(_38,cs);return {l:dojo._toPixelValue(_38,cs.paddingLeft),t:dojo._toPixelValue(_38,cs.paddingTop),w:mb.w-(me.w+pb.w),h:mb.h-(me.h+pb.h)};};(function(){var _39=function(_3a){return _3a.substring(0,1).toUpperCase()+_3a.substring(1);};var _3b=function(_3c,dim){_3c.resize?_3c.resize(dim):dojo.marginBox(_3c.domNode,dim);dojo.mixin(_3c,dojo.marginBox(_3c.domNode));dojo.mixin(_3c,dim);};dijit.layout.layoutChildren=function(_3d,dim,_3e){dim=dojo.mixin({},dim);dojo.addClass(_3d,"dijitLayoutContainer");_3e=dojo.filter(_3e,function(_3f){return _3f.layoutAlign!="client";}).concat(dojo.filter(_3e,function(_40){return _40.layoutAlign=="client";}));dojo.forEach(_3e,function(_41){var elm=_41.domNode,pos=_41.layoutAlign;var _42=elm.style;_42.left=dim.l+"px";_42.top=dim.t+"px";_42.bottom=_42.right="auto";dojo.addClass(elm,"dijitAlign"+_39(pos));if(pos=="top"||pos=="bottom"){_3b(_41,{w:dim.w});dim.h-=_41.h;if(pos=="top"){dim.t+=_41.h;}else{_42.top=dim.t+dim.h+"px";}}else{if(pos=="left"||pos=="right"){_3b(_41,{h:dim.h});dim.w-=_41.w;if(pos=="left"){dim.l+=_41.w;}else{_42.left=dim.l+dim.w+"px";}}else{if(pos=="client"){_3b(_41,dim);}}}});};})();}if(!dojo._hasResource["dijit.layout.ContentPane"]){dojo._hasResource["dijit.layout.ContentPane"]=true;dojo.provide("dijit.layout.ContentPane");dojo.declare("dijit.layout.ContentPane",dijit._Widget,{href:"",extractContent:false,parseOnLoad:true,preventCache:false,preload:false,refreshOnShow:false,loadingMessage:"<span class='dijitContentPaneLoading'>${loadingState}</span>",errorMessage:"<span class='dijitContentPaneError'>${errorState}</span>",isLoaded:false,baseClass:"dijitContentPane",doLayout:true,ioArgs:{},isContainer:true,isLayoutContainer:true,onLoadDeferred:null,attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{title:[]}),postMixInProperties:function(){this.inherited(arguments);var _43=dojo.i18n.getLocalization("dijit","loading",this.lang);this.loadingMessage=dojo.string.substitute(this.loadingMessage,_43);this.errorMessage=dojo.string.substitute(this.errorMessage,_43);if(!this.href&&this.srcNodeRef&&this.srcNodeRef.innerHTML){this.isLoaded=true;}},buildRendering:function(){this.inherited(arguments);if(!this.containerNode){this.containerNode=this.domNode;}},postCreate:function(){this.domNode.title="";if(!dojo.attr(this.domNode,"role")){dijit.setWaiRole(this.domNode,"group");}dojo.addClass(this.domNode,this.baseClass);},startup:function(){if(this._started){return;}var _44=dijit._Contained.prototype.getParent.call(this);this._childOfLayoutWidget=_44&&_44.isLayoutContainer;this._needLayout=!this._childOfLayoutWidget;if(this.isLoaded){dojo.forEach(this.getChildren(),function(_45){_45.startup();});}if(this._isShown()||this.preload){this._onShow();}this.inherited(arguments);},_checkIfSingleChild:function(){var _46=dojo.query("> *",this.containerNode).filter(function(_47){return _47.tagName!=="SCRIPT";}),_48=_46.filter(function(_49){return dojo.hasAttr(_49,"dojoType")||dojo.hasAttr(_49,"widgetId");}),_4a=dojo.filter(_48.map(dijit.byNode),function(_4b){return _4b&&_4b.domNode&&_4b.resize;});if(_46.length==_48.length&&_4a.length==1){this._singleChild=_4a[0];}else{delete this._singleChild;}dojo.toggleClass(this.containerNode,this.baseClass+"SingleChild",!!this._singleChild);},setHref:function(_4c){dojo.deprecated("dijit.layout.ContentPane.setHref() is deprecated. Use set('href', ...) instead.","","2.0");return this.set("href",_4c);},_setHrefAttr:function(_4d){this.cancel();this.onLoadDeferred=new dojo.Deferred(dojo.hitch(this,"cancel"));this.href=_4d;if(this._created&&(this.preload||this._isShown())){this._load();}else{this._hrefChanged=true;}return this.onLoadDeferred;},setContent:function(_4e){dojo.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use set('content', ...) instead.","","2.0");this.set("content",_4e);},_setContentAttr:function(_4f){this.href="";this.cancel();this.onLoadDeferred=new dojo.Deferred(dojo.hitch(this,"cancel"));this._setContent(_4f||"");this._isDownloaded=false;return this.onLoadDeferred;},_getContentAttr:function(){return this.containerNode.innerHTML;},cancel:function(){if(this._xhrDfd&&(this._xhrDfd.fired==-1)){this._xhrDfd.cancel();}delete this._xhrDfd;this.onLoadDeferred=null;},uninitialize:function(){if(this._beingDestroyed){this.cancel();}this.inherited(arguments);},destroyRecursive:function(_50){if(this._beingDestroyed){return;}this.inherited(arguments);},resize:function(_51,_52){if(!this._wasShown){this._onShow();}this._resizeCalled=true;if(_51){dojo.marginBox(this.domNode,_51);}var cn=this.containerNode;if(cn===this.domNode){var mb=_52||{};dojo.mixin(mb,_51||{});if(!("h" in mb)||!("w" in mb)){mb=dojo.mixin(dojo.marginBox(cn),mb);}this._contentBox=dijit.layout.marginBox2contentBox(cn,mb);}else{this._contentBox=dojo.contentBox(cn);}this._layoutChildren();},_isShown:function(){if(this._childOfLayoutWidget){if(this._resizeCalled&&"open" in this){return this.open;}return this._resizeCalled;}else{if("open" in this){return this.open;}else{var _53=this.domNode;return (_53.style.display!="none")&&(_53.style.visibility!="hidden")&&!dojo.hasClass(_53,"dijitHidden");}}},_onShow:function(){if(this.href){if(!this._xhrDfd&&(!this.isLoaded||this._hrefChanged||this.refreshOnShow)){this.refresh();}}else{if(!this._childOfLayoutWidget&&this._needLayout){this._layoutChildren();}}this.inherited(arguments);this._wasShown=true;},refresh:function(){this.cancel();this.onLoadDeferred=new dojo.Deferred(dojo.hitch(this,"cancel"));this._load();return this.onLoadDeferred;},_load:function(){this._setContent(this.onDownloadStart(),true);var _54=this;var _55={preventCache:(this.preventCache||this.refreshOnShow),url:this.href,handleAs:"text"};if(dojo.isObject(this.ioArgs)){dojo.mixin(_55,this.ioArgs);}var _56=(this._xhrDfd=(this.ioMethod||dojo.xhrGet)(_55));_56.addCallback(function(_57){try{_54._isDownloaded=true;_54._setContent(_57,false);_54.onDownloadEnd();}catch(err){_54._onError("Content",err);}delete _54._xhrDfd;return _57;});_56.addErrback(function(err){if(!_56.canceled){_54._onError("Download",err);}delete _54._xhrDfd;return err;});delete this._hrefChanged;},_onLoadHandler:function(_58){this.isLoaded=true;try{this.onLoadDeferred.callback(_58);this.onLoad(_58);}catch(e){}},_onUnloadHandler:function(){this.isLoaded=false;try{this.onUnload();}catch(e){}},destroyDescendants:function(){if(this.isLoaded){this._onUnloadHandler();}var _59=this._contentSetter;dojo.forEach(this.getChildren(),function(_5a){if(_5a.destroyRecursive){_5a.destroyRecursive();}});if(_59){dojo.forEach(_59.parseResults,function(_5b){if(_5b.destroyRecursive&&_5b.domNode&&_5b.domNode.parentNode==dojo.body()){_5b.destroyRecursive();}});delete _59.parseResults;}dojo.html._emptyNode(this.containerNode);delete this._singleChild;},_setContent:function(_5c,_5d){this.destroyDescendants();var _5e=this._contentSetter;if(!(_5e&&_5e instanceof dojo.html._ContentSetter)){_5e=this._contentSetter=new dojo.html._ContentSetter({node:this.containerNode,_onError:dojo.hitch(this,this._onError),onContentError:dojo.hitch(this,function(e){var _5f=this.onContentError(e);try{this.containerNode.innerHTML=_5f;}catch(e){}})});}var _60=dojo.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:this.parseOnLoad,dir:this.dir,lang:this.lang},this._contentSetterParams||{});dojo.mixin(_5e,_60);_5e.set((dojo.isObject(_5c)&&_5c.domNode)?_5c.domNode:_5c);delete this._contentSetterParams;if(!_5d){dojo.forEach(this.getChildren(),function(_61){if(!this.parseOnLoad||_61.getParent){_61.startup();}},this);this._scheduleLayout();this._onLoadHandler(_5c);}},_onError:function(_62,err,_63){this.onLoadDeferred.errback(err);var _64=this["on"+_62+"Error"].call(this,err);if(_63){}else{if(_64){this._setContent(_64,true);}}},_scheduleLayout:function(){if(this._isShown()){this._layoutChildren();}else{this._needLayout=true;}},_layoutChildren:function(){if(this.doLayout){this._checkIfSingleChild();}if(this._singleChild&&this._singleChild.resize){var cb=this._contentBox||dojo.contentBox(this.containerNode);this._singleChild.resize({w:cb.w,h:cb.h});}else{dojo.forEach(this.getChildren(),function(_65){if(_65.resize){_65.resize();}});}delete this._needLayout;},onLoad:function(_66){},onUnload:function(){},onDownloadStart:function(){return this.loadingMessage;},onContentError:function(_67){},onDownloadError:function(_68){return this.errorMessage;},onDownloadEnd:function(){}});}if(!dojo._hasResource["ag.widget.AGContentPane"]){dojo._hasResource["ag.widget.AGContentPane"]=true;dojo.provide("ag.widget.AGContentPane");dojo.declare("ag.widget.AGContentPane",[dijit.layout.ContentPane,ag.classes.Publisher],{buildRendering:function(){this.publishBuildBegin();this.inherited(arguments);},postCreate:function(){this.publishBuildComplete();this.inherited(arguments);},onLoad:function(){var pub="/"+this.id+"/loaded/";dojo.publish(pub);}});}if(!dojo._hasResource["agi.util.selection"]){dojo._hasResource["agi.util.selection"]=true;dojo.provide("agi.util.selection");agi.util.selection={get_cursor_position:function(_69){return this.get_end(_69);},length:function(_6a){_6a=dojo.byId(_6a);_6a.focus();if(_6a.createTextRange){return document.selection.createRange().text.length;}else{return _6a.selectionEnd-_6a.selectionStart;}},get_start:function(_6b){_6b=dojo.byId(_6b);_6b.focus();if(_6b.createTextRange){var _6c=document.selection.createRange().text.length;var end=agi.util.selection.get_end(_6b);return end-_6c;}else{return _6b.selectionStart;}},get_end:function(_6d){_6d=dojo.byId(_6d);_6d.focus();if(_6d.createTextRange){var r=document.selection.createRange().duplicate();r.moveStart("character",-_6d.value.length);return r.text.length;}else{return _6d.selectionEnd;}},set:function(_6e,_6f,end){var _6e=dojo.byId(_6e);if(!dojo.isIE){_6e.setSelectionRange(_6f,end);}else{var _70=_6e.createTextRange();_70.collapse(true);_70.moveStart("character",_6f);_70.moveEnd("character",end-_6f);_70.select();}}};}if(!dojo._hasResource["agi.widget.AutoComplete"]){dojo._hasResource["agi.widget.AutoComplete"]=true;dojo.provide("agi.widget.AutoComplete");dojo.declare("agi.widget.AutoComplete",[agi.classes.Identified],{node:null,url:null,suggestions:null,input_text:null,search_text:null,cursor:-1,min_len:0,selected_index:-1,open:false,multiple:true,class_name:imgbase+"-auto-complete",class_selected:imgbase+"-auto-complete-selected",popup:null,iframe:null,deferred:null,cursor_position:0,view_limit:10,constructor:function(_71,url,_72){if(typeof _72!="undefined"){this.multiple=_72;}this.node=dojo.byId(_71);dojo.attr(this.node,"autocomplete","off");this.create();this.url=url;this.suggestions=[];this.wire(this.node);},is_open:function(){return this.open;},create:function(){var _73=this.node.id+"-auto-complete-list";this.popup=dojo.create("UL",{id:_73,className:this.class_name},dojo.body());dojo.style(this.popup,{display:"none"});dojo.connect(this.popup,"onmouseover",this,this.list_onmouseover);dojo.connect(this.popup,"onclick",this,this.list_onclick);if(dojo.isIE){this.create_iframe();}},create_iframe:function(){var _74=this.node.id+"-auto-complete-iframe";this.iframe=dojo.create("IFRAME",{id:_74},dojo.body());dojo.style(this.iframe,{display:"none",position:"absolute",border:"none",margin:0,padding:0});dojo.style(this.iframe,{zIndex:dojo.style(this.popup).zIndex-1});},show:function(){this.selected_index=-1;var _75=dojo.coords(this.node,true);dojo.style(this.popup,{visibility:"hidden",display:"block",left:_75.x+"px",top:(_75.y+_75.h)+"px"});this.popup.scrollTop=0;var lis=dojo.query("li",this.popup);if(lis.length>this.view_limit){lineHeight=dojo.coords(lis[0],true).h;divHeight=lineHeight*this.view_limit;dojo.style(this.popup,{height:divHeight+"px",overflow:"auto",overflowX:"hidden"});}else{dojo.style(this.popup,{height:"auto",overflow:"auto"});}this.make_visible();if(dojo.isIE){this.show_iframe();}this.open=true;},show_iframe:function(){var _76=dojo.coords(this.popup,true);dojo.style(this.iframe,{width:_76.w+"px",height:_76.h+"px",top:_76.t,left:_76.l,display:"block",background:"#FFFFFF"});},make_visible:function(){var _77=dojo.coords(this.node,true);var _78=dojo.coords(this.popup,true);var _79=dijit.getViewport();var _7a=_78.t+_78.h;var _7b=_79.t+_79.h;if(_7a>_7b){dojo.style(this.popup,{top:(_77.y-_78.h)+"px"});}dojo.style(this.popup,{visibility:"visible"});},cancel:function(){if(this.deferred!=null){this.deferred.cancel();}},hide:function(evt){if(typeof evt!="undefined"){var ids=[this.node.id,this.popup.id];var _7c=dojo.query("li",this.popup);_7c.forEach(function(_7d){ids.push(_7d.id);});if(!this.is_open()){this.cancel();}else{if(dojo.indexOf(ids,evt.target.id)>-1){return;}}}this.cancel();this.selected_index=-1;if(dojo.isIE){this.hide_iframe();}dojo.style(this.popup,{display:"none"});this.open=false;},hide_iframe:function(){dojo.style(this.iframe,{display:"none"});},stop_event:function(evt){if(this.is_open()){dojo.stopEvent(evt);}},onkeypress:function(evt){switch(evt.keyCode){case dojo.keys.TAB:case dojo.keys.UP_ARROW:case dojo.keys.DOWN_ARROW:case dojo.keys.ENTER:case dojo.keys.ESC:this.stop_event(evt);default:return true;}},onkeyup:function(evt){this.cursor_position=agi.util.selection.get_end(this.node);switch(evt.keyCode){case dojo.keys.TAB:case dojo.keys.ESC:case dojo.keys.UP_ARROW:case dojo.keys.DOWN_ARROW:this.stop_event(evt);case dojo.keys.SHIFT:return true;default:var _7e="";var _7e=this.get_search_value(this.node);if(_7e!=this.input_text){this.input_text=_7e;if(_7e.length>this.min_len){this.send_search();}else{this.hide();}}}},onkeydown:function(evt){switch(evt.keyCode){case dojo.keys.ENTER:this.use_suggestion();break;case dojo.keys.TAB:if(this.selected_index>-1){this.use_suggestion();}else{this.hide();agi.widget.focus_next_element(this.node);}break;case dojo.keys.ESC:this.stop_event(evt);this.hide();break;case dojo.keys.UP_ARROW:if(this.selected_index>0){this.selected_index--;}this.change_selection(evt.keyCode);this.stop_event(evt);break;case dojo.keys.DOWN_ARROW:if(this.selected_index<(this.suggestions.length-1)){this.selected_index++;}this.change_selection(evt.keyCode);this.stop_event(evt);break;}},wire:function(_7f){this.node=_7f;dojo.connect(_7f,"onkeypress",this,this.onkeypress);dojo.connect(_7f,"onkeydown",this,this.onkeydown);dojo.connect(_7f,"onkeyup",this,this.onkeyup);dojo.connect((dojo.isIE)?document:null,"onmouseup",this,this.hide);dojo.subscribe("agi/widget/autocomplete/hide",dojo.hitch(this,this.hide));},change_selection:function(_80){if(!_80){_80="";}var lis=dojo.query("li",this.popup);if(lis.length==0){return;}var _81=dojo.marginBox(lis[0]).h;var _82=dojo.marginBox(this.popup);var _83=this.popup.scrollTop+_82.h;lis.forEach(dojo.hitch(this,function(_84,_85,_86){if(_85==this.selected_index){dojo.attr(_84,"className",this.class_selected);if(_86.length>this.view_limit&&(_80==dojo.keys.DOWN_ARROW||_80==dojo.keys.UP_ARROW)){if(_80==dojo.keys.DOWN_ARROW){scroll_factor=_85+1;}else{scroll_factor=_85;}var _87=_81*scroll_factor;if(_87>_83){this.popup.scrollTop=this.popup.scrollTop+_81;}else{if(_87<this.popup.scrollTop){this.popup.scrollTop=_87;}}}}else{dojo.attr(_84,"className",this.class_name);}}));},list_onmouseover:function(evt){var _88=evt.target;this.selected_index=_88.id.replace(this.node.id,"").replace(/\D*/,"")*1;this.change_selection();},list_onclick:function(evt){this.use_suggestion();this.hide();dojo.stopEvent(evt);},onsearchsuccess:function(_89){var _8a=this.get_search_value(this.node);if(_8a!=this.search_text&&_8a.length>this.min_len){this.send_search();return;}this.suggestions=_89;this.suggestions.sort();this.create_suggestions(this.search_text);if(this.suggestions.length>0){this.show();}else{this.hide();}},send_search:function(){this.search_text=this.get_search_value(this.node);var _8b={q:encodeURIComponent(this.search_text)};var _8c={url:this.url,handleAs:"json",load:dojo.hitch(this,this.onsearchsuccess),content:_8b,preventCache:true};this.deferred=dojo.xhrGet(_8c);},format_suggestion:function(_8d){return dojo.toJson(_8d);},apply_suggestion:function(_8e){if(this.multiple){var _8f=this.node.value;var _90=this.cursor_position;var _91=_90-this.get_search_value(this.node).length;var _92=_8f.substring(0,_91);var _93=_8f.substring(_90);var _94=(_92.search(/\s+$/g)!=-1||_92.length==0);var _95=(_93.search(/^\s+/g)!=-1);var _96=(_94)?"":" ";var _97=(_95)?",":", ";var _98=_96+_8e+_97;this.node.value=_92+_98+_93;this.cursor=_91+_98.length;}else{this.node.value=_8e;}},get_search_value:function(_99){if(this.multiple){var _9a=_99.value;var _9b=this.cursor_position;var _9c=[","," ",";","\n"];var idx=-1;dojo.forEach(_9c,function(_9d){var _9e=_9a.lastIndexOf(_9d,_9b);idx=Math.max(idx,_9e);});var _9f=(idx==-1)?0:idx+1;var idx=-1;dojo.forEach(_9c,function(_a0){var _a1=_9a.indexOf(_a0,_9b);idx=Math.max(idx,_a1);});var end=(idx==-1)?_9a.length-1:idx-1;return _9a.substring(_9f,_9b).replace(/^\s*|\s*$/g,"");}else{return this.node.value;}},create_suggestions:function(_a2){dojo.query("li",this.popup).forEach(dojo.destroy);dojo.forEach(this.suggestions,dojo.hitch(this,function(_a3,_a4){var _a5=this.format_suggestion(_a3);var _a6=this.node.id+"-li-"+_a4;var _a7=(this.selected_index==_a4)?this.class_selected:this.class_name;if(_a2){fidx=_a5.toLowerCase().indexOf(_a2);_a5=_a5.substring(0,fidx)+"<b>"+_a5.substring(fidx,fidx+_a2.length)+"</b>"+_a5.substring(fidx+_a2.length);}_a5=_a5.replace(/ /g,"&nbsp;");var li=dojo.create("LI",{id:_a6,className:_a7,innerHTML:_a5},this.popup);}));},use_suggestion:function(){if(this.selected_index>-1){this.apply_suggestion(this.suggestions[this.selected_index]);this.hide();this.selected_index=-1;this.input_text="";this.search_text="";this.node.blur();setTimeout("agi.widget.focus_element('"+this.node.id+"')",10);if(this.cursor!=-1){setTimeout("agi.util.selection.set('"+this.node.id+"',"+this.cursor+","+this.cursor+")",15);}}}});agi.widget.focus_next_element=function(_a8){var idx=-1;for(var i=0;i<_a8.form.elements.length;i++){if(_a8.form.elements[i]==_a8&&i<(_a8.form.elements.length-1)){idx=i;}}if(idx!=-1){_a8.form.elements[idx].focus();}};agi.widget.focus_element=function(_a9){try{dojo.byId(_a9).focus();}catch(e){}};}if(!dojo._hasResource["agi.widget.StorageComplete"]){dojo._hasResource["agi.widget.StorageComplete"]=true;dojo.provide("agi.widget.StorageComplete");dojo.declare("agi.widget.StorageComplete",[agi.widget.AutoComplete],{require_email:true,send_search:function(){if(!agx.currentPage.controller.contacts.loaded){this.inherited(arguments);return;}this.suggestions=[];var _aa=(this.get_search_value(this.node)+"").toLowerCase();if(agx.currentPage.controller.groups.loaded){for(g in agx.currentPage.groups){var _ab=(agx.currentPage.groups[g].label+"").toLowerCase();if(_ab.indexOf(_aa)==0){this.suggestions.push(agx.currentPage.groups[g]);}}}for(i in agx.currentPage.contacts){var _ac=(agx.currentPage.contacts[i].first_name+"").toLowerCase();var _ad=(agx.currentPage.contacts[i].last_name+"").toLowerCase();var _ae=(agx.currentPage.contacts[i].email+"").toLowerCase();var f=(_ac.length>0)?_ac+" ":"";var l=(_ad.length>0)?_ad+" ":"";var _af=f+l;if(_ae.toLowerCase()==_aa){this.suggestions=[];break;}if(((_ae.indexOf(_aa)==0||_ac.indexOf(_aa)==0||_ad.indexOf(_aa)==0)||_af.indexOf(_aa)==0)&&(_ae.length>0||!this.require_email)){this.suggestions.push(agx.currentPage.contacts[i]);}}this.suggestions.sort(this.compare_contacts);this.create_suggestions(_aa);if(this.suggestions.length>0){this.show();}else{this.hide();}},assemble_contact:function(_b0){if(!_b0.label){var _b1=(_b0.first_name==null)?"":_b0.first_name;var _b2=(_b0.last_name==null)?"":_b0.last_name;var _b3=(_b2.length>0&&_b1.length>0)?" ":"";var _b4=(_b2.length>0||_b1.length>0)?"\""+_b1+_b3+_b2+"\"":"";var _b5=(_b0.email==null||_b0.email.length==0)?"":" <"+_b0.email+">";return _b4+_b5;}else{return _b0.label+" (group)";}},format_suggestion:function(_b6){return this.assemble_contact(_b6).replace("<","&#60;").replace(">","&#62;");},apply_suggestion:function(_b7){var _b8="";if(!_b7.label){_b8=_b7.email;}else{_b8=this.get_group_emails(_b7);}this.inherited(arguments,[_b8]);},get_contact:function(id){for(var c in agx.currentPage.contacts){var _b9=agx.currentPage.contacts[c];_b9.id=_b9.id+"";if(_b9.id==id||_b9.id.startswith(id+"-")){return _b9;}}return {};},get_group_emails:function(_ba){var _bb="";for(i=0;i<_ba.contacts.length;i++){var _bc=_ba.contacts[i];var _bd=this.get_contact(_bc).email;if(typeof _bd!="undefined"&&_bd.length>0){if(_bb.length>0){_bb+=", "+_bd;}else{_bb+=_bd;}}}return _bb;},compare_contacts:function(a,b){if(!a.label){var _be=a.last_name+a.first_name+a.email;}else{var _be=a.label;}if(!b.label){var _bf=b.last_name+b.first_name+b.email;}else{var _bf=b.label;}if(_be>_bf){return 1;}else{return -1;}}});}if(!dojo._hasResource["ag.nav.ProductNavMixin"]){dojo._hasResource["ag.nav.ProductNavMixin"]=true;dojo.provide("ag.nav.ProductNavMixin");dojo.declare("ag.nav.ProductNavMixin",[ag.classes._Mixin],{prodInfoPage:"products.pd",prodNavChangeUrl:"",prodNavContentUrl:"",prodNavCurrentMode:"grid",prodNavCurrentPage:1,prodNavCurrentSort:null,prodNavPageNumber:0,prodNavPaneId:null,prodNavStickyViewAll:false,prodNavSubscribeEvent:null,_prodNavSwitchDiscon:null,_prodNavSorter:null,_prodNavPagePickers:null,_prodNavResultsPane:null,_prodNavGridSwitch:null,_prodNavDetailSwitch:null,_prodNavSwitchDiscon:null,_prodNavWireHandle:null,_prodNavSorterHandle:null,_prodNavAgiLegendCopy:null,_prodNavPagePickerHandles:[],_prodNavReady:false,AppStateClass:ag.nav.AppState,ContentPaneClass:ag.widget.AGContentPane,ADISPLAY:"adisplay",ALL:"all",CLASS_PAGENUMBER:".pagenumber",CURRENT:"current",PRODNAV_NAVCONTROLS_ID:"agi-legend",PRODNAV_PAGINATION_ID:"agi-pagination",PAGINATION_NODE:3,PAGE_PICKER_NODE_TYPE:"li",PRODNAV_PANE_ID:"docpane",PRODNAV_PANE_ID_ENDECA:"agi-products-and-nav",PRODNAV_PANE_LOADED:"/docpane/loaded/",PRODNAV_PANE_LOADED_ENDECA:"/agi-products-and-nav/loaded/",PRODNAV_PANE_PRELOAD:true,PRODNAV_PANE_LOADING_MESSAGE:"<p class=\"loading\">Loading...</p>",PRODNAV_PANE_ERROR_MESSAGE:"<p class=\"error\">Load failed...</p>",GO_ALL:"go_to_all",LIST_STYLE:"list-style",MODE_DETAIL:"detail",MODE_DETAIL_LIST:"detail-list",MODE_GRID:"grid",PAGE:"go_to_page",PRODUCT_LIST:"productlist",QV_PATH:"path",SORT:"sort",SORTER:"sorter",SORTER_NODE_TYPE:"select",SORTER_LABEL_NODE_TYPE:"label",SORTER_CHILD_NODE_TYPE:"option",SORT_ASC:"asc",SORT_DESC:"desc",SORT_NEW:"new",SORT_RATING:"rating",SORT_RELEVANCE:"relevance",SORT_START_DATE:"startdate",SORT_USAGE:"usage",SORT_CTD:"ctd",SWITCHVIEW:"switchview",SWITCHVIEW_SELECTED:"switchview-selected",VIEWALL_COOKIE_KEY:"viewall",VIEWBY_DETAIL:"viewby_detail",VIEWBY_PAGE:"viewby_page",DETAIL_PRODUCT_LIST_QUERY:".productlist.detail-list",PAGE_NUMBER_QUERY:".pagenumber",GRID_PRODUCT_LIST_QUERY:".productlist.grid",VIEWALL_QUERY:".viewall",constructor:function(){if(this._prodNavReady){return arguments;}this.prodNavSubscribeEvent=this.PRODNAV_PANE_LOADED;this.prodNavPaneId=this.PRODNAV_PANE_ID;if(agx.currentPage.hasEndeca){this.prodNavSubscribeEvent=this.PRODNAV_PANE_LOADED_ENDECA;this.prodNavPaneId=this.PRODNAV_PANE_ID_ENDECA;}this.prodNavInitBackButton();this.prodNavGetCurrentMode();this.prodNavGetResultsPane();this.prodNavResultsPaneWire();this._prodNavReady=true;this.prodNavCheckHash();dojo.subscribe(this.prodNavSubscribeEvent,this,this.prodNavResultsPaneWire);},prodNavCheckHash:function(){if(!location.hash){return;}if(isNaN(location.hash.substring(1))){return;}this.prodNavGoToPageNumber(parseInt(location.hash.substring(1)));},prodNavResultsPaneWire:function(){if(agx.currentPage.disableXhrPaging==true){}else{this.prodNavInitStyleSwitchers();this.prodNavToggleStyleSwitchers();this.prodNavInitPageChangers();this.prodNavGetPagePickers();this.prodNavUpdateChangerClasses(this.prodNavCurrentPage);this.prodNavInitSorter();}},prodNavInitBackButton:function(){var _c0={pageNumber:this.prodNavCurrentPage};_c0.pageSetter=dojo.hitch(this,function(n){this.prodNavGoToPageNumber(n);});var _c1=new this.AppStateClass(_c0);dojo.back.setInitialState(_c1);},prodNavGoToPageNumber:function(_c2){var _c3={pageNumber:_c2};_c3.pageSetter=dojo.hitch(this,function(n){this.prodNavGoToPageNumber(n);});var _c4=new this.AppStateClass(_c3);dojo.back.addToHistory(_c4);this.prodNavCurrentPage=_c2;this.prodNavUpdateChangerClasses(_c2);this._prodNavStyleTo(this.prodNavCurrentMode);},prodNavSort:function(){this.prodNavUpdateSort();},prodNavUpdate:function(_c5){_c5=_c5||1;this.prodNavPageNumber=_c5;this.prodNavChangeUrl=_c5;},prodNavSetCurrentMode:function(_c6){this.prodNavCurrentMode=_c6;},prodNavGetCurrentMode:function(){cookie_mode=this.prodNavGetModeCookie();var ret;if(cookie_mode){this.prodNavCurrentMode=cookie_mode;ret=cookie_mode;}else{this.prodNavCurrentMode=this.MODE_GRID;ret=this.MODE_GRID;}return ret;},prodNavSetModeCookie:function(_c7){var key=this.LIST_STYLE;ag.cookie.MagicCookie.setCookieValue(key,_c7,true);},prodNavGetModeCookie:function(_c8){var key=this.LIST_STYLE;return ag.cookie.MagicCookie.getCookieValue(key);},prodNavStyleToDetail:function(){this._prodNavStyleTo(this.MODE_DETAIL);},prodNavStyleToGrid:function(){this._prodNavStyleTo(this.MODE_GRID);},_prodNavStyleTo:function(_c9){this.prodNavCurrentMode=_c9;this.prodNavSetModeCookie(_c9);this.prodNavGetPageFromQs();this.prodNavToggleStyleSwitchers(_c9);this.prodNavGetResultsPane();this.prodNavLoadNewContent();},prodNavLoadNewContent:function(){this.prodNavGetContentUrl();if(this.prodNavContentUrl==this._prodNavResultsPane.href){return;}this._prodNavResultsPane.setHref(this.prodNavContentUrl);},prodNavGetPageFromQs:function(){this.prodNavPageNumber=1;},prodNavToggleStyleSwitchers:function(_ca){if(!this._prodNavGridSwitch||!this._prodNavDetailSwitch){return;}_ca=_ca||this.prodNavCurrentMode;dojo.disconnect(this._prodNavSwitchDiscon);if(_ca==this.MODE_GRID){this._prodNavSwitchDiscon=dojo.connect(this._prodNavDetailSwitch,"onclick",this,this.prodNavStyleToDetail);this._prodNavGridSwitch.className=this.SWITCHVIEW_SELECTED;this._prodNavDetailSwitch.className=this.SWITCHVIEW;}else{if(_ca==this.MODE_DETAIL){this._prodNavSwitchDiscon=dojo.connect(this._prodNavGridSwitch,"onclick",this,this.prodNavStyleToGrid);this._prodNavDetailSwitch.className=this.SWITCHVIEW_SELECTED;this._prodNavGridSwitch.className=this.SWITCHVIEW;}else{return;}}},prodNavInitStyleSwitchers:function(){this._prodNavGridSwitch=dojo.byId(this.VIEWBY_PAGE);this._prodNavDetailSwitch=dojo.byId(this.VIEWBY_DETAIL);},prodNavInitPageChangers:function(){dojo.forEach(this._prodNavPagePickerHandles,function(h){dojo.disconnect(h);});dojo.forEach(dojo.query(this.PAGE_NUMBER_QUERY),dojo.hitch(this,function(_cb){this._prodNavPagePickerHandles.push(dojo.connect(_cb,"onclick",this,this.prodNavGoToPage));}));dojo.forEach(dojo.query(this.VIEWALL_QUERY),dojo.hitch(this,function(_cc){this._prodNavPagePickerHandles.push(dojo.connect(_cc,"onclick",this,this.prodNavGoToAll));}));if(this.prodNavStickyViewAll&&this.prodNavGetViewallCookie()==this.ALL){this.prodNavUpdateChangerClasses(this.ALL);this.prodNavCurrentPage=this.ALL;}},prodNavGetPagePickers:function(){this._prodNavPagePickers=[];dojo.forEach(dojo.query(this.PAGE_NUMBER_QUERY),dojo.hitch(this,function(_cd){this._prodNavPagePickers.push(_cd);}));return this._prodNavPagePickers;},prodNavInitSorter:function(){this._prodNavSorter=dojo.byId(this.SORTER);if(this._prodNavSorter){dojo.disconnect(this._prodNavSorterHandle);this._prodNavSorterHandle=dojo.connect(this._prodNavSorter,"onchange",this,this.prodNavSort);if(this.prodNavCurrentSort){dojo.query(this.SORTER_CHILD_NODE_TYPE,this._prodNavSorter).forEach(dojo.hitch(this,function(n){if(n.value==this.prodNavCurrentSort){n.selected=true;}else{n.selected=false;}}));}else{this.prodNavCurrentSort=this._prodNavSorter.value;}}else{}},prodNavUpdateSort:function(){this._prodNavSorter=dojo.byId(this.SORTER);if(!this._prodNavSorter){return;}var _ce=null;var _cf=this._prodNavSorter.value;dojo.forEach([this.SORT_NEW,this.SORT_USAGE,this.SORT_RATING,this.SORT_ASC,this.SORT_DESC,this.SORT_RELEVANCE,this.SORT_CTD],function(o){if(_cf==o){_ce=o;}});if(_ce){this.prodNavSortBy(_ce);}},prodNavSortBy:function(_d0){this.prodNavUpdateCurrentSort(_d0);this._prodNavStyleTo(this.prodNavCurrentMode);this.prodNavCurrentPage=1;},prodNavGetContentUrl:function(){var _d1=dojo.doc.location.search.substring(1).split("&");var _d2=null;var _d3=null;var _d4=null;var _d5=null;var _d6=function(x,v){return (x.indexOf(v)>-1);};for(i=0;i<_d1.length;i++){var x=_d1[i];if(_d6(x,"strSearch")){_d2=x;}else{if(_d6(x,"qs_occasion")){_d3=x;}else{if(_d6(x,"qs_recipient")){_d4=x;}else{if(_d6(x,"qs_sentiment")){_d5=x;}}}}}var _d7="viewmode=";var _d8="path=";var _d9=this.prodNavGetCurrentMode();var _da="";if(this.productLine&&this.productLine.length>0){_da="/"+this.productLine;}var url=this.khost+_da+"/"+this.prodInfoPage;var _db=null;if(_db){url=[url,"?",_d8,_db,"&",_d7,_d9].join("");}else{var _dc=dojo.doc.location.search.substring(1);if(agx.currentPage.pathInfo){path_info="_path_info="+agx.currentPage.pathInfo;if(_dc){_dc=_dc+"&"+path_info;}else{_dc=path_info;}}var _dd=ag.util.getFriendlyPath();url=[url,_dd,"?",_d7,_d9].join("");url=[url,_dc].join("&");}var _de=this.prodNavCurrentPage;if(_de==null||_de==this.ALL){url+="&va=1";this.prodNavSetViewallCookie(this.ALL);}else{url=url+"&adisplay="+_de;this.prodNavSetViewallCookie("");}url=url+"&sortby="+this.prodNavCurrentSort;var _df=[];dojo.forEach([_d2,_d3,_d4,_d5],function(v){if(v){_df.push(v);}});url=[url].concat(_df).join("&");this.prodNavContentUrl=url;return url;},prodNavSetPageNumber:function(_e0){this.prodNavCurrentPage=_e0;},prodNavSetViewallCookie:function(_e1){if(this.prodNavStickyViewAll){var key=this.VIEWALL_COOKIE_KEY;ag.cookie.MagicCookie.setCookieValue(key,_e1,true);}},prodNavGetViewallCookie:function(){return ag.cookie.MagicCookie.getCookieValue(this.VIEWALL_COOKIE_KEY);},prodNavGetResultsPane:function(){if(!this._prodNavResultsPane){var _e2={id:this.prodNavPaneId,widgetId:this.prodNavPaneId,errorMessage:this.PRODNAV_PANE_ERROR_MESSAGE,preload:this.PRODNAV_PANE_PRELOAD,loadingMessage:this.PRODNAV_PANE_LOADING_MESSAGE};var _e3=dojo.byId(this.prodNavPaneId);if(agx.currentPage.hasEndeca){var _e4=dojo.byId(this.PRODNAV_NAVCONTROLS_ID);if(!_e4){return;}this._prodNavAgiLegendCopy=dojo.doc.createElement("div");this._prodNavAgiLegendCopy.innerHTML=_e4.innerHTML;var _e5=function(n){dojo.style(n,"visibility","hidden");};dojo.query(this.PAGE_PICKER_NODE_TYPE,this._prodNavAgiLegendCopy).forEach(_e5);dojo.query(this.SORTER_NODE_TYPE,this._prodNavAgiLegendCopy).forEach(_e5);dojo.query(this.SORTER_LABEL_NODE_TYPE,this._prodNavAgiLegendCopy).forEach(_e5);_e2.loadingMessage="<div><div id=\""+this.PRODNAV_NAVCONTROLS_ID+"\">"+this._prodNavAgiLegendCopy.innerHTML+"</div>"+this.PRODNAV_PANE_LOADING_MESSAGE+"</div>";}this._prodNavResultsPane=new this.ContentPaneClass(_e2,_e3);this._prodNavResultsPane.startup();}else{}return this._prodNavResultsPane;},prodNavCurrentListStyle:function(){var _e6=dojo.query(this.GRID_PRODUCT_LIST_QUERY);if(_e6.length>0){return this.MODE_GRID;}var _e7=dojo.query(this.DETAIL_PRODUCT_LIST_QUERY);if(_e7.length>0){return this.MODE_DETAIL_LIST;}},prodNavUpdateCurrentSort:function(_e8){if(_e8!=this.prodNavCurrentSort){this.prodNavCurrentPage=1;}this.prodNavCurrentSort=_e8;},prodNavUpdateChangerClasses:function(_e9){dojo.forEach(this._prodNavPagePickers,dojo.hitch(this,function(n){if(n.title==(_e9)){dojo.addClass(n,this.CURRENT);}else{dojo.removeClass(n,this.CURRENT);}}));dojo.forEach(dojo.query(this.VIEWALL_QUERY),dojo.hitch(this,function(n){if(_e9==this.ALL){dojo.addClass(n,this.CURRENT);}else{dojo.removeClass(n,this.CURRENT);}}));},prodNavInitRecipientAutoComplete:function(_ea){var _eb=new agi.widget.StorageComplete(_ea,ahost+"/reminders/contactsearch.pd",true);},prodNavGoToPage:function(evt){this.prodNavGoToPageNumber(evt.target.title);},prodNavGoToAll:function(){this.prodNavGoToPageNumber("all");},prodNavSort:function(){this.prodNavUpdateSort();}});}if(!dojo._hasResource["agi.navtype"]){dojo._hasResource["agi.navtype"]=true;dojo.provide("agi.navtype");agi.navtype.toString=function(){return "AGNavtype";};agi.navtype.KEYS={"ecards":"ec","printables":"cnp","downloads":"dl","wallpapers":"wp","screensavers":"sv","invitations":"inv","photocards":"pc"};agi.navtype.to_string=function(_ec){var _ed="";for(value in _ec){if(typeof value=="string"){_ed+=("\""+value+"\""+":"+"\""+_ec[value]+"\""+",");}}return "{"+_ed.slice(0,-1)+"}";};agi.navtype.set_cookie=function(key,_ee){var _ef="navtype";var _f0=agi.cookie.MagicCookie.getCookieValue(_ef);var _f1={};if(_f0){var _f2=dojo.fromJson(_f0);for(x in _f2){_f1[x]=_f2[x];}}else{}if(typeof _f1[key]=="string"&&_f1[key].indexOf("|")>0){_f1[key]=_f1[key].split("|")[0]+"|"+_ee;}else{if(typeof _f1[key]=="string"){_f1[key]=_f1[key]+"|"+_ee;}else{_f1[key]=_ee+"|"+_ee;}}var _f3=agi.navtype.to_string(_f1);agi.cookie.MagicCookie.setCookieValue(_ef,_f3);};agi.navtype.get_key=function(){var _f4=window.location.pathname.split("/")[1];return agi.navtype.KEYS[_f4];};agi.navtype.get_from_cookie=function(){var key="navtype";var _f5=agi.cookie.MagicCookie.getCookieValue(key);if(_f5){try{var _f6=dojo.eval("x = "+_f5+";");return _f6[agi.navtype.get_key()].toLowerCase();}catch(e){return "others";}}else{return "others";}};agi.navtype.remove_from_cookie=function(_f7){var key="navtype";var _f8=agi.cookie.MagicCookie.getCookieValue(key);if(_f8){dojo.eval("var ary_navtype ="+_f8+";");key=agi.navtype.get_key();if(dojo.eval("delete ary_navtype."+key+";")){var _f9=agi.navtype.to_string(ary_navtype);agi.cookie.MagicCookie.setCookieValue(key,_f9);}}};}if(!dojo._hasResource["ag.navtype"]){dojo._hasResource["ag.navtype"]=true;dojo.provide("ag.navtype");ag.navtype=agi.navtype;}if(!dojo._hasResource["ag.sifr._base"]){dojo._hasResource["ag.sifr._base"]=true;dojo.provide("ag.sifr._base");ag.sifr.toString=function(){return "AGsIFR";};ag.sifr.sIFR=new function(){var O=this;var E={ACTIVE:"sIFR-active",UNLOADING:"sIFR-unloading",REPLACED:"sIFR-replaced",IGNORE:"sIFR-ignore",ALTERNATE:"sIFR-alternate",CLASS:"sIFR-class",LAYOUT:"sIFR-layout",FLASH:"sIFR-flash",FIX_FOCUS:"sIFR-fixfocus",DUMMY:"sIFR-dummy"};E.IGNORE_CLASSES=[E.REPLACED,E.IGNORE,E.ALTERNATE];this.MIN_FONT_SIZE=6;this.MAX_FONT_SIZE=126;this.FLASH_PADDING_BOTTOM=5;this.VERSION="395";this.isActive=false;this.isEnabled=true;this.fixHover=true;this.autoInitialize=true;this.setPrefetchCookie=true;this.cookiePath="/";this.domains=[];this.forceWidth=true;this.fitExactly=false;this.forceTextTransform=true;this.useDomLoaded=true;this.useStyleCheck=false;this.hasFlashClassSet=false;this.repaintOnResize=true;this.replacements=[];var L=0;var R=false;function Y(){};function D(b){function c(d){return d.toLocaleUpperCase();};this.normalize=function(d){return d.replace(/\n|\r|\xA0/g,D.SINGLE_WHITESPACE).replace(/\s+/g,D.SINGLE_WHITESPACE);};this.textTransform=function(d,e){switch(d){case "uppercase":return e.toLocaleUpperCase();case "lowercase":return e.toLocaleLowerCase();case "capitalize":return e.replace(/^\w|\s\w/g,c);}return e;};this.toHexString=function(d){if(typeof (d)!="string"||d.charAt(0)!="#"||d.length!=4&&d.length!=7){return d;}d=d.substring(1);return "0x"+(d.length==3?d.replace(/(.)(.)(.)/,"$1$1$2$2$3$3"):d);};this.convertCssArg=function(d){if(!d){return {};}if(typeof (d)=="object"){if(d.constructor==Array){d=d.join("");}else{return d;}}var k={};var l=d.split("}");for(var g=0;g<l.length;g++){var h=l[g].match(/([^\s{]+)\s*\{(.+)\s*;?\s*/);if(!h||h.length!=3){continue;}if(!k[h[1]]){k[h[1]]={};}var f=h[2].split(";");for(var e=0;e<f.length;e++){var m=f[e].match(/\s*([^:\s]+)\s*\:\s*([^;]+)/);if(!m||m.length!=3){continue;}k[h[1]][m[1]]=m[2].replace(/\s+$/,"");}}return k;};this.extractFromCss=function(f,e,h,d){var g=null;if(f&&f[e]&&f[e][h]){g=f[e][h];if(d){delete f[e][h];}}return g;};this.cssToString=function(e){var f=[];for(var d in e){var i=e[d];if(i==Object.prototype[d]){continue;}f.push(d,"{");for(var h in i){if(i[h]==Object.prototype[h]){continue;}var g=i[h];if(D.UNIT_REMOVAL_PROPERTIES[h]){g=parseInt(g,10);}f.push(h,":",g,";");}f.push("}");}return f.join("");};this.escape=function(d){return escape(d).replace(/\+/g,"%2B");};this.encodeVars=function(d){return d.join("&").replace(/%/g,"%25");};this.copyProperties=function(f,e){for(var d in f){if(e[d]===undefined){e[d]=f[d];}}return e;};this.domain=function(){var d="";try{d=document.domain;}catch(f){}return d;};this.domainMatches=function(g,f){if(f=="*"||f==g){return true;}var e=f.lastIndexOf("*");if(e>-1){f=f.substr(e+1);var d=g.lastIndexOf(f);if(d>-1&&(d+f.length)==g.length){return true;}}return false;};this.uriEncode=function(d){return encodeURI(decodeURIComponent(d));};this.delay=function(e,g,f){var d=Array.prototype.slice.call(arguments,3);setTimeout(function(){g.apply(f,d);},e);};};D.UNIT_REMOVAL_PROPERTIES={leading:true,"margin-left":true,"margin-right":true,"text-indent":true};D.SINGLE_WHITESPACE=" ";function T(d){var c=this;function b(f,h,g){var j=c.getStyleAsInt(f,h,d.ua.ie);if(j==0){j=f[g];for(var e=3;e<arguments.length;e++){j-=c.getStyleAsInt(f,arguments[e],true);}}return j;};this.getBody=function(){return document.getElementsByTagName("body")[0]||null;};this.querySelectorAll=function(e){return ag.sifr.parseSelector(e);};this.addClass=function(e,f){if(f){f.className=((f.className||"")==""?"":f.className+" ")+e;}};this.removeClass=function(e,f){if(f){f.className=f.className.replace(new RegExp("(^|\\s)"+e+"(\\s|$)"),"").replace(/^\s+|(\s)\s+/g,"$1");}};this.hasClass=function(e,f){return new RegExp("(^|\\s)"+e+"(\\s|$)").test(f.className);};this.hasOneOfClassses=function(g,f){for(var e=0;e<g.length;e++){if(this.hasClass(g[e],f)){return true;}}return false;};this.ancestorHasClass=function(f,e){f=f.parentNode;while(f&&f.nodeType==1){if(this.hasClass(e,f)){return true;}f=f.parentNode;}return false;};this.create=function(e,f){var g=document.createElementNS?document.createElementNS(T.XHTML_NS,e):document.createElement(e);if(f){g.className=f;}return g;};this.getComputedStyle=function(g,h){var e;if(document.defaultView&&document.defaultView.getComputedStyle){var f=document.defaultView.getComputedStyle(g,null);e=f?f[h]:null;}else{if(g.currentStyle){e=g.currentStyle[h];}}return e||"";};this.getStyleAsInt=function(f,h,e){var g=this.getComputedStyle(f,h);if(e&&!/px$/.test(g)){return 0;}return parseInt(g)||0;};this.getWidthFromStyle=function(e){return b(e,"width","offsetWidth","paddingRight","paddingLeft","borderRightWidth","borderLeftWidth");};this.getHeightFromStyle=function(e){return b(e,"height","offsetHeight","paddingTop","paddingBottom","borderTopWidth","borderBottomWidth");};this.getDimensions=function(h){var g=h.offsetWidth;var e=h.offsetHeight;if(g==0||e==0){for(var f=0;f<h.childNodes.length;f++){var j=h.childNodes[f];if(j.nodeType!=1){continue;}g=Math.max(g,j.offsetWidth);e=Math.max(e,j.offsetHeight);}}return {width:g,height:e};};this.getViewport=function(){return {width:window.innerWidth||document.documentElement.clientWidth||this.getBody().clientWidth,height:window.innerHeight||document.documentElement.clientHeight||this.getBody().clientHeight};};this.blurElement=function(g){try{g.blur();return;}catch(h){}var f=this.create("input");f.style.width="0px";f.style.height="0px";g.parentNode.appendChild(f);f.focus();f.blur();f.parentNode.removeChild(f);};};T.XHTML_NS="http://www.w3.org/1999/xhtml";function H(l){var c=navigator.userAgent.toLowerCase();var k=(navigator.product||"").toLowerCase();var d=navigator.platform.toLowerCase();this.parseVersion=function(e){return e.replace(/(^|\D)(\d)(?=\D|$)/g,"$10000$2");};this.macintosh=/^mac/.test(d);this.windows=/^win/.test(d);this.quicktime=false;this.opera=/opera/.test(c);this.konqueror=/konqueror/.test(k);this.ie=false;this.ieSupported=this.ie&&!/ppc|smartphone|iemobile|msie\s5\.5/.test(c);this.ieWin=this.ie&&this.windows;this.windows=this.windows&&(!this.ie||this.ieWin);this.ieMac=this.ie&&this.macintosh;this.macintosh=this.macintosh&&(!this.ie||this.ieMac);this.safari=/safari/.test(c);this.webkit=!this.konqueror&&/applewebkit/.test(c);this.khtml=this.webkit||this.konqueror;this.gecko=!this.webkit&&k=="gecko";this.ieVersion=this.ie&&/.*msie\s(\d\.\d)/.exec(c)?this.parseVersion(RegExp.$1):"0";this.operaVersion=this.opera&&/.*opera(\s|\/)(\d+\.\d+)/.exec(c)?this.parseVersion(RegExp.$2):"0";this.webkitVersion=this.webkit&&/.*applewebkit\/(\d+).*/.exec(c)?this.parseVersion(RegExp.$1):"0";this.geckoVersion=this.gecko&&/.*rv:\s*([^\)]+)\)\s+gecko/.exec(c)?this.parseVersion(RegExp.$1):"0";this.konquerorVersion=this.konqueror&&/.*konqueror\/([\d\.]+).*/.exec(c)?this.parseVersion(RegExp.$1):"0";this.flashVersion=0;if(this.ieWin){var g;var j=false;try{g=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");}catch(h){try{g=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");this.flashVersion=6;g.AllowScriptAccess="always";}catch(h){j=this.flashVersion==6;}if(!j){try{g=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");}catch(h){}}}if(!j&&g){this.flashVersion=parseFloat(/([\d,?]+)/.exec(g.GetVariable("$version"))[1].replace(/,/g,"."));}}else{if(navigator.plugins&&navigator.plugins["Shockwave Flash"]){this.flashVersion=parseFloat(/(\d+\.?\d*)/.exec(navigator.plugins["Shockwave Flash"].description)[1]);var f=0;while(this.flashVersion>=H.MIN_FLASH_VERSION&&f<navigator.mimeTypes.length){var b=navigator.mimeTypes[f];if(b.type=="application/x-shockwave-flash"&&b.enabledPlugin.description.toLowerCase().indexOf("quicktime")>-1){this.flashVersion=0;this.quicktime=true;}f++;}}}this.flash=this.flashVersion>=H.MIN_FLASH_VERSION;this.transparencySupport=this.macintosh||this.windows;this.computedStyleSupport=this.ie||!!(document.defaultView&&document.defaultView.getComputedStyle);this.requiresPrefetch=this.ieWin||this.khtml;this.fixFocus=this.gecko&&this.windows;this.nativeDomLoaded=this.gecko||this.webkit&&this.webkitVersion>=this.parseVersion("525")||this.konqueror&&this.konquerorMajor>this.parseVersion("03")||this.opera;this.mustCheckStyle=this.khtml||this.opera;this.forcePageLoad=this.webkit&&this.webkitVersion<this.parseVersion("523");this.properDocument=typeof (document.location)=="object";this.supported=this.flash&&this.properDocument&&(!this.ie||this.ieSupported)&&this.computedStyleSupport&&(!this.opera||this.operaVersion>=this.parseVersion("9.50"))&&(!this.webkit||this.webkitVersion>=this.parseVersion("412"))&&(!this.gecko||this.geckoVersion>=this.parseVersion("1.8.0.12"))&&(!this.konqueror);};H.MIN_FLASH_VERSION=8;function F(b){this.fix=b.ua.ieWin&&window.location.hash!="";var c;this.cache=function(){c=document.title;};function d(){document.title=c;};this.restore=function(){if(this.fix){setTimeout(d,0);}};};function S(e){var i=null;function f(){try{if(e.ua.ie||document.readyState!="loaded"&&document.readyState!="complete"){document.documentElement.doScroll("left");}}catch(j){return setTimeout(f,10);}b();};function b(){if(e.useStyleCheck){d();}else{if(!e.ua.mustCheckStyle){g(null,true);}}};function d(){i=e.dom.create("div",E.DUMMY);e.dom.getBody().appendChild(i);c();};function c(){if(e.dom.getComputedStyle(i,"marginLeft")=="42px"){h();}else{setTimeout(c,10);}};function h(){if(i&&i.parentNode){i.parentNode.removeChild(i);}i=null;g(null,true);};function g(j,k){e.initialize(k);if(j&&j.type=="load"){if(document.removeEventListener){document.removeEventListener("DOMContentLoaded",g,false);}if(window.removeEventListener){window.removeEventListener("load",g,false);}}};this.attach=function(){if(window.addEventListener){window.addEventListener("load",g,false);}else{window.attachEvent("onload",g);}if(!e.useDomLoaded||e.ua.forcePageLoad||e.ua.ie&&window.top!=window){return;}if(e.ua.nativeDomLoaded){document.addEventListener("DOMContentLoaded",b,false);}else{if(e.ua.ie||e.ua.khtml){f();}}};};var Q="sifrFetch";function N(b){var d=false;this.fetchMovies=function(f){if(b.setPrefetchCookie&&new RegExp(";?"+Q+"=true;?").test(document.cookie)){return;}try{d=true;c(f);}catch(g){if(b.debug){throw g;}}if(b.setPrefetchCookie){document.cookie=Q+"=true;path="+b.cookiePath;}};this.clear=function(){if(!d){return;}try{var f=document.getElementsByTagName("script");for(var g=f.length-1;g>=0;g--){var h=f[g];if(h.type=="sifr/prefetch"){h.parentNode.removeChild(h);}}}catch(j){}};function c(e){for(var f=0;f<e.length;f++){document.write("<script defer type=\"sifr/prefetch\" src=\""+e[f].src+"\"></script>");}};};function K(c,f,e,b,d){this.sIFR=c;this.id=f;this.vars=e;this.movie=null;this.__forceWidth=b;this.__events=d;this.__resizing=0;};K.prototype={getFlashElement:function(){return document.getElementById(this.id);},getAlternate:function(){return document.getElementById(this.id+"_alternate");},getAncestor:function(){var b=this.getFlashElement().parentNode;return !this.sIFR.dom.hasClass(E.FIX_FOCUS,b)?b:b.parentNode;},available:function(){var b=this.getFlashElement();return b&&b.parentNode;},call:function(b){if(!this.available()){return false;}var c=this.getFlashElement();try{c[b].apply(c,Array.prototype.slice.call(arguments,1));}catch(d){return false;}return true;},updateVars:function(b,d){for(var c=0;c<this.vars.length;c++){if(this.vars[c].split("=")[0]==b){this.vars[c]=b+"="+d;break;}}var e=this.sIFR.util.encodeVars(this.vars);this.movie.injectVars(this.getFlashElement(),e);this.movie.injectVars(this.movie.html,e);},storeSize:function(b,c){this.movie.setSize(b,c);this.updateVars(b,c);},fireEvent:function(b){if(this.available()&&this.__events[b]){this.sIFR.util.delay(0,this.__events[b],this,this);}},resizeFlashElement:function(b,c,d){if(!this.available()){return;}this.__resizing++;var e=this.getFlashElement();e.setAttribute("height",b);this.updateVars("renderheight",b);this.storeSize("height",b);if(c!==null){e.setAttribute("width",c);this.storeSize("width",c);}if(this.__events.onReplacement){this.sIFR.util.delay(0,this.__events.onReplacement,this,this);delete this.__events.onReplacement;}if(d){this.sIFR.util.delay(0,function(){this.call("scaleMovie");this.__resizing--;},this);}else{this.__resizing--;}},blurFlashElement:function(){if(this.available()){this.sIFR.dom.blurElement(this.getFlashElement());}},resetMovie:function(){this.sIFR.util.delay(0,this.movie.reset,this.movie,this.getFlashElement(),this.getAlternate());},resizeAfterScale:function(c,d){if(this.available()&&this.__resizing==0){this.sIFR.util.delay(0,this.resize,this);}},resize:function(){if(!this.available()){return;}this.__resizing++;var f=this.getFlashElement();var e=f.offsetWidth;if(e==0){return;}var d=f.getAttribute("width");var j=f.getAttribute("height");var k=this.getAncestor();var m=this.sIFR.dom.getHeightFromStyle(k);f.style.width="1px";f.style.height="1px";k.style.minHeight=m+"px";var b=this.getAlternate().childNodes;var l=[];for(var h=0;h<b.length;h++){var g=b[h].cloneNode(true);l.push(g);k.appendChild(g);}var c=this.sIFR.dom.getWidthFromStyle(k);for(var h=0;h<l.length;h++){k.removeChild(l[h]);}f.style.width=f.style.height=k.style.minHeight="";f.setAttribute("width",this.__forceWidth?c:d);f.setAttribute("height",j);if(c!=e){if(this.__forceWidth){this.storeSize("width",c);}this.call("resize",c);}this.__resizing--;},replaceText:function(f,h){var c=this.sIFR.util.escape(f);if(!this.call("replaceText",c)){return false;}this.updateVars("content",c);var d=this.getAlternate();if(h){while(d.firstChild){d.removeChild(d.firstChild);}for(var b=0;b<h.length;b++){d.appendChild(h[b]);}}else{try{d.innerHTML=f;}catch(g){}}return true;},changeCSS:function(b){b=this.sIFR.util.escape(this.sIFR.util.cssToString(this.sIFR.util.convertCssArg(b)));this.updateVars("css",b);return this.call("changeCSS",b);}};var X=new function(){this.create=function(n,i,h,e,d,f,m,k,g,l){var j=n.ua.ie?c:b;return new j(n,i,h,e,d,f,m,["flashvars",k,"wmode",g,"bgcolor",l,"allowScriptAccess","always","quality","best"]);};function b(q,k,g,e,d,f,p,m){var l=q.dom.create("object",E.FLASH);var o=["type","application/x-shockwave-flash","id",e,"name",e,"data",d,"width",f,"height",p];for(var n=0;n<o.length;n+=2){l.setAttribute(o[n],o[n+1]);}var h=l;if(g){h=W.create("div",E.FIX_FOCUS);h.appendChild(l);}for(var n=0;n<m.length;n+=2){if(m[n]=="name"){continue;}var j=W.create("param");j.setAttribute("name",m[n]);j.setAttribute("value",m[n+1]);l.appendChild(j);}while(k.firstChild){k.removeChild(k.firstChild);}k.appendChild(h);this.html=h.cloneNode(true);};b.prototype={reset:function(d,e){d.parentNode.replaceChild(this.html.cloneNode(true),d);},setSize:function(d,e){this.html.setAttribute(d,e);},injectVars:function(d,f){var g=d.getElementsByTagName("param");for(var e=0;e<g.length;e++){if(g[e].getAttribute("name")=="flashvars"){g[e].setAttribute("value",f);break;}}}};function c(n,h,g,e,d,f,m,j){this.dom=n.dom;this.html="<object classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" id=\""+e+"\" width=\""+f+"\" height=\""+m+"\" class=\""+E.FLASH+"\"><param name=\"movie\" value=\""+d+"\"></param></object>";var l="";for(var k=0;k<j.length;k+=2){l+="<param name=\""+j[k]+"\" value=\""+j[k+1]+"\"></param>";}this.html=this.html.replace(/(<\/object>)/,l+"$1");h.innerHTML=this.html;};c.prototype={reset:function(e,f){var d=e.parentNode;d.innerHTML=this.html;d.appendChild(f);},setSize:function(d,e){this.html=this.html.replace(d=="height"?/(height)="\d+"/:/(width)="\d+"/,"$1=\""+e+"\"");},injectVars:function(d,e){if(d!=this.html){return;}this.html=this.html.replace(/(flashvars(=|\"\svalue=)\")[^\"]+/,"$1"+e);}};};this.errors=new Y(O);var A=this.util=new D(O);var W=this.dom=new T(O);var U=this.ua=new H(O);var G={fragmentIdentifier:new F(O),pageLoad:new S(O),prefetch:new N(O)};var J={kwargs:[],replaceAll:function(c){for(var b=0;b<this.kwargs.length;b++){O.replace(this.kwargs[b]);}if(!c){this.kwargs=[];}}};this.activate=function(){if(!U.supported||!this.isEnabled||this.isActive||!C()||a()){return;}if(U.requiresPrefetch){G.prefetch.fetchMovies(arguments);}this.isActive=true;this.setFlashClass();G.fragmentIdentifier.cache();if(!this.autoInitialize){return;}G.pageLoad.attach();if(U.ie){window.attachEvent("onunload",function(){W.addClass(E.UNLOADING,document.documentElement);});}};this.setFlashClass=function(){if(this.hasFlashClassSet){return;}W.addClass(E.ACTIVE,W.getBody()||document.documentElement);this.hasFlashClassSet=true;};this.removeFlashClass=function(){if(!this.hasFlashClassSet){return;}W.removeClass(E.ACTIVE,W.getBody());W.removeClass(E.ACTIVE,document.documentElement);this.hasFlashClassSet=false;};this.initialize=function(b){if(!this.isActive||!this.isEnabled){return;}if(R){if(!b){J.replaceAll(false);}return;}R=true;J.replaceAll(b);if(O.repaintOnResize){if(window.addEventListener){window.addEventListener("resize",Z,false);}else{window.attachEvent("onresize",Z);}}G.prefetch.clear();};this.replace=function(v,s){if(!U.supported){return;}if(s){v=A.copyProperties(v,s);}if(!R){return J.kwargs.push(v);}if(this.onReplacementStart){this.onReplacementStart(v);}var AK=v.elements||W.querySelectorAll(v.selector);if(AK.length==0){return;}var u=M(v.src);var AP=A.convertCssArg(v.css);var t=B(v.filters);var AL=v.forceSingleLine===true;var AQ=v.preventWrap===true&&!AL;var o=AL||(v.fitExactly==null?this.fitExactly:v.fitExactly)===true;var AB=o||(v.forceWidth==null?this.forceWidth:v.forceWidth)===true;var q=v.ratios||[];var AC=v.pixelFont===true;var p=parseInt(v.tuneHeight)||0;var x=!!v.onRelease||!!v.onRollOver||!!v.onRollOut;if(o){A.extractFromCss(AP,".sIFR-root","text-align",true);}var r=A.extractFromCss(AP,".sIFR-root","font-size",true)||"0";var d=A.extractFromCss(AP,".sIFR-root","background-color",true)||"#FFFFFF";var m=A.extractFromCss(AP,".sIFR-root","kerning",true)||"";var AU=A.extractFromCss(AP,".sIFR-root","opacity",true)||"100";var h=A.extractFromCss(AP,".sIFR-root","cursor",true)||"default";var AN=parseInt(A.extractFromCss(AP,".sIFR-root","leading"))||0;var AH=v.gridFitType||(A.extractFromCss(AP,".sIFR-root","text-align")=="right")?"subpixel":"pixel";var g=this.forceTextTransform===false?"none":A.extractFromCss(AP,".sIFR-root","text-transform",true)||"none";r=/^\d+(px)?$/.test(r)?parseInt(r):0;AU=parseFloat(AU)<1?100*parseFloat(AU):AU;var AA=v.modifyCss?"":A.cssToString(AP);var AE=v.wmode||"";if(!AE){if(v.transparent){AE="transparent";}else{if(v.opaque){AE="opaque";}}}if(AE=="transparent"){if(!U.transparencySupport){AE="opaque";}else{d="transparent";}}for(var AT=0;AT<AK.length;AT++){var AD=AK[AT];if(W.hasOneOfClassses(E.IGNORE_CLASSES,AD)||W.ancestorHasClass(AD,E.ALTERNATE)){continue;}var AM=W.getDimensions(AD);var e=AM.height;var b=AM.width;var y=W.getComputedStyle(AD,"display");if(!e||!b||!y||y=="none"){continue;}b=W.getWidthFromStyle(AD);var k,AF;if(!r){var AJ=I(AD);k=Math.min(this.MAX_FONT_SIZE,Math.max(this.MIN_FONT_SIZE,AJ.fontSize));if(AC){k=Math.max(8,8*Math.round(k/8));}AF=AJ.lines;if(isNaN(AF)||!isFinite(AF)||AF==0){AF=1;}if(AF>1&&AN){e+=Math.round((AF-1)*AN);}}else{k=r;AF=1;}var c=W.create("span",E.ALTERNATE);var AV=AD.cloneNode(true);AD.parentNode.appendChild(AV);for(var AS=0,AR=AV.childNodes.length;AS<AR;AS++){c.appendChild(AV.childNodes[AS].cloneNode(true));}if(v.modifyContent){v.modifyContent(AV,v.selector);}if(v.modifyCss){AA=v.modifyCss(AP,AV,v.selector);}var n=P(AV,g,v.uriEncode);AV.parentNode.removeChild(AV);if(v.modifyContentString){n.text=v.modifyContentString(n.text,v.selector);}if(n.text==""){continue;}e=Math.round(AF*k);var AI=Math.round(AF*V(k,q)*k)+this.FLASH_PADDING_BOTTOM+p;var z=AB?b:"100%";var AG="sIFR_replacement_"+L++;var AO=["id="+AG,"content="+A.escape(n.text),"width="+b,"height="+e,"renderheight="+AI,"link="+A.escape(n.primaryLink.href||""),"target="+A.escape(n.primaryLink.target||""),"size="+k,"css="+A.escape(AA),"cursor="+h,"tunewidth="+(v.tuneWidth||0),"tuneheight="+p,"offsetleft="+(v.offsetLeft||""),"offsettop="+(v.offsetTop||""),"fitexactly="+o,"preventwrap="+AQ,"forcesingleline="+AL,"antialiastype="+(v.antiAliasType||""),"thickness="+(v.thickness||""),"sharpness="+(v.sharpness||""),"kerning="+m,"gridfittype="+AH,"flashfilters="+t,"opacity="+AU,"blendmode="+(v.blendMode||""),"selectable="+(v.selectable==null?"true":v.selectable===true),"fixhover="+(this.fixHover===true),"events="+x,"version="+this.VERSION];var w=A.encodeVars(AO);var f=new K(O,AG,AO,AB,{onReplacement:v.onReplacement,onRollOver:v.onRollOver,onRollOut:v.onRollOut,onRelease:v.onRelease});f.movie=X.create(ag.sifr.sIFR,AD,U.fixFocus&&v.fixFocus,AG,u,z,AI,w,AE,d);this.replacements.push(f);this.replacements[AG]=f;if(v.selector){if(!this.replacements[v.selector]){this.replacements[v.selector]=[f];}else{this.replacements[v.selector].push(f);}}c.setAttribute("id",AG+"_alternate");AD.appendChild(c);W.addClass(E.REPLACED,AD);}G.fragmentIdentifier.restore();};this.getReplacementByFlashElement=function(c){for(var b=0;b<O.replacements.length;b++){if(O.replacements[b].id==c.getAttribute("id")){return O.replacements[b];}}};this.redraw=function(){for(var b=0;b<O.replacements.length;b++){O.replacements[b].resetMovie();}};function C(){if(O.domains.length==0){return true;}var c=A.domain();for(var b=0;b<O.domains.length;b++){if(A.domainMatches(c,O.domains[b])){return true;}}return false;};function a(){if(document.location.protocol=="file:"){if(O.debug){O.errors.fire("isFile");}return true;}return false;};function M(b){if(U.ie&&b.charAt(0)=="/"){b=window.location.toString().replace(/([^:]+)(:\/?\/?)([^\/]+).*/,"$1$2$3")+b;}return b;};function V(c,d){for(var b=0;b<d.length;b+=2){if(c<=d[b]){return d[b+1];}}return d[d.length-1]||1;};function B(f){var d=[];for(var c in f){if(f[c]==Object.prototype[c]){continue;}var b=f[c];c=[c.replace(/filter/i,"")+"Filter"];for(var e in b){if(b[e]==Object.prototype[e]){continue;}c.push(e+":"+A.escape("\""+A.toHexString(b[e])+"\""));}d.push(c.join(","));}return A.escape(d.join(";"));};function Z(c){var d=Z.viewport;var b=W.getViewport();if(d&&b.width==d.width&&b.height==d.height){return;}Z.viewport=b;if(Z.timer){clearTimeout(Z.timer);}Z.timer=setTimeout(function(){delete Z.timer;for(var e=0;e<O.replacements.length;e++){O.replacements[e].resize();}},200);};function I(f){var g,c;if(!U.ie){g=W.getStyleAsInt(f,"lineHeight");c=Math.floor(W.getStyleAsInt(f,"height")/g);}else{if(U.ie){var g=W.getComputedStyle(f,"fontSize");if(g.indexOf("px")>0){g=parseInt(g);}else{var e=f.innerHTML;f.style.visibility="visible";f.style.overflow="visible";f.style.position="static";f.style.zoom="normal";f.style.writingMode="lr-tb";f.style.width=f.style.height="auto";f.style.maxWidth=f.style.maxHeight=f.style.styleFloat="none";var h=f;var b=f.currentStyle.hasLayout;if(b){f.innerHTML="<div class=\""+E.LAYOUT+"\">X<br>X<br>X</div>";h=f.firstChild;}else{f.innerHTML="X<br>X<br>X";}var d=h.getClientRects();g=d[1].bottom-d[1].top;g=Math.ceil(g*0.8);if(b){f.innerHTML="<div class=\""+E.LAYOUT+"\">"+e+"</div>";h=f.firstChild;}else{f.innerHTML=e;}d=h.getClientRects();c=d.length;if(b){f.innerHTML=e;}f.style.visibility=f.style.width=f.style.height=f.style.maxWidth=f.style.maxHeight=f.style.overflow=f.style.styleFloat=f.style.position=f.style.zoom=f.style.writingMode="";}}}return {fontSize:g,lines:c};};function P(b,f,p){p=p||A.uriEncode;var n=[],l=[];var j=null;var d=b.childNodes;var h=0;while(h<d.length){var e=d[h];if(e.nodeType==3){l.push(A.textTransform(f,A.normalize(e.nodeValue)).replace(/</g,"&lt;"));}if(e.nodeType==1){var g=[];var o=e.nodeName.toLowerCase();var m=e.className||"";if(/\s+/.test(m)){if(m.indexOf(E.CLASS)>-1){m=m.match("(\\s|^)"+E.CLASS+"-([^\\s$]*)(\\s|$)")[2];}else{m=m.match(/^([^\s]+)/)[1];}}if(m!=""){g.push("class=\""+m+"\"");}if(o=="a"){var c=p(e.getAttribute("href")||"");var k=e.getAttribute("target")||"";g.push("href=\""+c+"\"","target=\""+k+"\"");if(!j){j={href:c,target:k};}}l.push("<"+o+(g.length>0?" ":"")+g.join(" ")+">");if(e.hasChildNodes()){n.push(h);h=0;d=e.childNodes;continue;}else{if(!/^(br|img)$/i.test(e.nodeName)){l.push("</",e.nodeName.toLowerCase(),">");}}}if(n.length>0&&!e.nextSibling){do{h=n.pop();d=e.parentNode.parentNode.childNodes;e=d[h];if(e){l.push("</",e.nodeName.toLowerCase(),">");}}while(h==d.length-1&&n.length>0);}h++;}return {text:l.join("").replace(/^\s+|\s+$|\s+(<br>)\s+/g,"$1"),primaryLink:j||{}};};};ag.sifr.parseSelector=(function(){var B=/\s*,\s*/;var A=/\s*([\s>+~(),]|^|$)\s*/g;var K=/([\s>+~,]|[^(]\+|^)([#.:@])/g;var E=/^[^\s>+~]/;var J=/[\s#.:>+~()@]|[^\s#.:>+~()@]+/g;function G(P,N){N=N||document.documentElement;var Q=P.split(B),V=[];for(var S=0;S<Q.length;S++){var L=[N],U=F(Q[S]);for(var R=0;R<U.length;){var O=U[R++],M=U[R++],T="";if(U[R]=="("){while(U[R++]!=")"&&R<U.length){T+=U[R];}T=T.slice(0,-1);}L=H(L,O,M,T);}V=V.concat(L);}return V;};function F(L){var M=L.replace(A,"$1").replace(K,"$1*$2");if(E.test(M)){M=" "+M;}return M.match(J)||[];};function H(L,N,O,M){return (G.selectors[N])?G.selectors[N](L,O,M):[];};var D={toArray:function(M){var L=[];for(var N=0;N<M.length;N++){L.push(M[N]);}return L;}};var C={isTag:function(M,L){return (L=="*")||(L.toLowerCase()==M.nodeName.toLowerCase());},previousSiblingElement:function(L){do{L=L.previousSibling;}while(L&&L.nodeType!=1);return L;},nextSiblingElement:function(L){do{L=L.nextSibling;}while(L&&L.nodeType!=1);return L;},hasClass:function(L,M){return (M.className||"").match("(^|\\s)"+L+"(\\s|$)");},getByTag:function(L,M){return M.getElementsByTagName(L);}};var I={"#":function(L,N){for(var M=0;M<L.length;M++){if(L[M].getAttribute("id")==N){return [L[M]];}}return [];}," ":function(M,O){var L=[];for(var N=0;N<M.length;N++){L=L.concat(D.toArray(C.getByTag(O,M[N])));}return L;},">":function(M,P){var L=[];for(var O=0,Q;O<M.length;O++){Q=M[O];for(var N=0,R;N<Q.childNodes.length;N++){R=Q.childNodes[N];if(R.nodeType==1&&C.isTag(R,P)){L.push(R);}}}return L;},".":function(M,O){var L=[];for(var N=0,P;N<M.length;N++){P=M[N];if(C.hasClass([O],P)){L.push(P);}}return L;},":":function(L,N,M){return (G.pseudoClasses[N])?G.pseudoClasses[N](L,M):[];}};G.selectors=I;G.pseudoClasses={};G.util=D;G.dom=C;return G;})();}if(!dojo._hasResource["ag.sifr.config"]){dojo._hasResource["ag.sifr.config"]=true;dojo.provide("ag.sifr.config");ag.sifr.config.helneu={};ag.sifr.config.helneu.src=dojo.moduleUrl("ag","sifr/helveticaneuelt_v3.swf").toString();ag.sifr.sIFR.activate(ag.sifr.config.helneu);ag.sifr.config.go=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"h2.foo",css:{".sIFR-root":{"font-size":"48px","color":"#ff00ff"}},wmode:"transparent"});};ag.sifr.config.banner=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-category-banner h1",wmode:"transparent",css:{".sIFR-root":{"color":"#ffffff","text-transform":"lowercase"}}});};ag.sifr.config.bannerl3=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-category-banner h2",wmode:"transparent",css:{".sIFR-root":{"color":"#ffffff","text-transform":"lowercase"}}});};ag.sifr.config.ecardtitle=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-ecardtitle h1",wmode:"transparent",css:{".sIFR-root":{"color":"#000000","text-align":"center","text-transform":"lowercase"}}});};ag.sifr.config.ecardtitlety=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-ecardtitlety h1",wmode:"transparent",css:{".sIFR-root":{"color":"#9d0017","text-transform":"lowercase"}}});};ag.sifr.config.ecardtitlel=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-ecardtitlel h1",wmode:"transparent",css:{".sIFR-root":{"color":"#9d0017","text-transform":"lowercase"}}});};ag.sifr.config.ecardtitleleft=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-ecardtitleleft h1",wmode:"transparent",css:{".sIFR-root":{"color":"#9d0017","text-transform":"lowercase"}}});};ag.sifr.config.ecardtitleleftsm=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-ecardtitleleftsm h1",wmode:"transparent",css:{".sIFR-root":{"color":"#9d0017","text-transform":"lowercase"}}});};ag.sifr.config.ecardtitleleftsm2=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-ecardtitleleftsm2 h1",wmode:"transparent",css:{".sIFR-root":{"color":"#9d0017","text-transform":"lowercase"}}});};ag.sifr.config.othertitlety=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-othertitlety h1",wmode:"transparent",css:{".sIFR-root":{"color":"#9d0017","text-transform":"lowercase"}}});};ag.sifr.config.printabletitle=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-printabletitle h1",wmode:"transparent",css:{".sIFR-root":{"color":"#9d0017","text-align":"center","text-transform":"lowercase"}}});};ag.sifr.config.invitetitle=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-invitetitle h1",wmode:"transparent",css:{".sIFR-root":{"color":"#9d0017","text-align":"center","text-transform":"lowercase"}}});};ag.sifr.config.invitetitleleft=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-invitetitleleft h1",wmode:"transparent",css:{".sIFR-root":{"color":"#9d0017","text-transform":"lowercase"}}});};ag.sifr.config.invitetitlefl=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-invitetitlefl h1",wmode:"transparent",css:{".sIFR-root":{"color":"#9d0017","text-transform":"lowercase"}}});};ag.sifr.config.invitetitlefls=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-invitetitlefls h1",wmode:"transparent",css:{".sIFR-root":{"color":"#9d0017","text-transform":"lowercase"}}});};ag.sifr.config.dltitle=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-dltitle h1",wmode:"transparent",css:{".sIFR-root":{"color":"#9d0017","text-align":"center","text-transform":"lowercase"}}});};ag.sifr.config.thumbsvlist=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-thumbs-vlist h2",wmode:"transparent",css:{".sIFR-root":{"color":"#b0ad89"}}});};ag.sifr.config.featuredcontent=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-featuredcontent h2",wmode:"transparent",css:{".sIFR-root":{"color":"#c73e30","text-transform":"lowercase"}}});};ag.sifr.config.printable=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-printable h2",wmode:"transparent",css:{".sIFR-root":{"color":"#aeab8d","text-transform":"lowercase"}}});};ag.sifr.config.printableproj=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-printableproj h2",wmode:"transparent",css:{".sIFR-root":{"color":"#aeab8d","text-transform":"lowercase"}}});};ag.sifr.config.myinvmain=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-myinvmain h2",wmode:"transparent",css:{".sIFR-root":{"color":"#aeab8d","text-transform":"lowercase"}}});};ag.sifr.config.instructions=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-instructions h2",wmode:"transparent",css:{".sIFR-root":{"color":"#aeab8d","text-transform":"lowercase"}}});};ag.sifr.config.rcolumn=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-rcolumn h2",wmode:"transparent",css:{".sIFR-root":{"color":"#aeab8d","text-transform":"lowercase"}}});};ag.sifr.config.lcolumn=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-lcolumn h2",wmode:"transparent",css:{".sIFR-root":{"color":"#aeab8d","text-transform":"lowercase"}}});};ag.sifr.config.headtitle=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#headtitle h1",wmode:"transparent",css:{".sIFR-root":{"color":"#98936c","text-align":"left","text-transform":"lowercase"}}});};ag.sifr.config.seohallow=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-seohallow #agi-seohead #headtitle h1",wmode:"transparent",css:{".sIFR-root":{"color":"#e55800","text-align":"left","text-transform":"lowercase"}}});};ag.sifr.config.seobday=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-seobday #agi-seohead #headtitle h1",wmode:"transparent",css:{".sIFR-root":{"color":"#e92e37","text-align":"left","text-transform":"lowercase"}}});};ag.sifr.config.seodisney=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-seodisney #agi-seohead #headtitle h1",wmode:"transparent",css:{".sIFR-root":{"color":"#333399","text-align":"center","text-transform":"lowercase"}}});};ag.sifr.config.seothanks=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-seothanks #agi-seohead #headtitle h1",wmode:"transparent",css:{".sIFR-root":{"color":"#CC6633","text-align":"left","text-transform":"lowercase"}}});};ag.sifr.config.seosweet=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-seosweet #agi-seohead #headtitle h1",wmode:"transparent",css:{".sIFR-root":{"color":"#CC3366","text-align":"left","text-transform":"lowercase"}}});};ag.sifr.config.momcount=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#momcount h1",wmode:"transparent",css:{".sIFR-root":{"color":"#ee353d","text-align":"right","text-transform":"lowercase","font-size":"24px"}}});};ag.sifr.config.agierrors=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-errors h1",wmode:"transparent",css:{".sIFR-root":{"color":"#ee353d","text-align":"left","text-transform":"lowercase","font-size":"24px"}}});};ag.sifr.config.mdtoc=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#mdtoc h1",wmode:"transparent",css:{".sIFR-root":{"color":"#ee353d","text-align":"left","text-transform":"lowercase","font-size":"24px"}}});};ag.sifr.config.mdtoc2=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#mdtoc h2",wmode:"transparent",css:{".sIFR-root":{"color":"#333333","text-transform":"lowercase","font-size":"20px"}}});};ag.sifr.config.mompage=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:".momforward h1",wmode:"transparent",css:{".sIFR-root":{"color":"#ee353d","text-transform":"lowercase","font-size":"20px","text-align":"right"}}});};ag.sifr.config.mompage2=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#momview #agi-content #momtexttop h1",wmode:"transparent",css:{".sIFR-root":{"color":"#ee353d","text-transform":"lowercase"}}});};ag.sifr.config.mompage3=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#momview #agi-content .momtext h2",wmode:"transparent",css:{".sIFR-root":{"color":"#aeab8d","text-transform":"lowercase","font-size":"24px"}}});};ag.sifr.config.choosemomcard=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#mdchoose h1",wmode:"transparent",css:{".sIFR-root":{"color":"#ee353d","text-transform":"lowercase"}}});};ag.sifr.config.choosemomcard2=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#mdchoose h2",wmode:"transparent",css:{".sIFR-root":{"color":"#484848","text-transform":"lowercase"}}});};ag.sifr.config.choosemomcard3=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#mdchoose .momintrot h1",wmode:"transparent",css:{".sIFR-root":{"color":"#ee353d","text-transform":"lowercase"}}});};ag.sifr.config.mompopup=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#agi-flashAlbum-popUp h1",wmode:"transparent",css:{".sIFR-root":{"color":"#ee353d","text-transform":"lowercase"}}});};ag.sifr.config.mompageview=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#momviewpd .momreport h1",wmode:"transparent",css:{".sIFR-root":{"color":"#ee353d","text-transform":"lowercase","text-align":"right"}}});};ag.sifr.config.mompageview2=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#momviewpd .momforward h1",wmode:"transparent",css:{".sIFR-root":{"color":"#ee353d","text-transform":"lowercase","text-align":"right"}}});};ag.sifr.config.mompageview3=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#momviewpd .momviewtrib h2",wmode:"transparent",css:{".sIFR-root":{"color":"#ee353d","text-transform":"lowercase","text-align":"center"}}});};ag.sifr.config.momstep1=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:"#mdcustom2 h2",wmode:"transparent",css:{".sIFR-root":{"color":"#808080","text-transform":"lowercase","text-align":"left"}}});};ag.sifr.config.mompreview=function(){ag.sifr.sIFR.replace(ag.sifr.config.helneu,{selector:".agi-face-tribmsg",wmode:"transparent",css:{".sIFR-root":{"color":"#ee353d","text-transform":"lowercase","text-align":"left"}}});};}if(!dojo._hasResource["ag.widget._base"]){dojo._hasResource["ag.widget._base"]=true;dojo.provide("ag.widget._base");(function(){var w=ag.widget;dojo.mixin(w,{toString:function(){return "AGWidget";},__culprit__:"$Author: dbuch $"});w.placeOffScreen=function(_fa){var _fb=false;var st=_fa.style;var _fc=st.top||"0px";var _fd=st.left||"0px";try{_fb=(parseInt(_fc.replace(/px|pt|em/g,""),10)<0&&parseInt(_fd.replace(/px|pt|em/g,""),10)<0);}catch(e){}if(_fb){return;}else{var _fe=_fa.id||"<NO ID>";st.left="-9999px";st.top="-9999px";return;}};w.getSize=function(_ff){ret=dojo.marginBox(_ff);ret.w=_ff.offsetWidth;ret.h=_ff.offsetHeight;return ret;};w.placeBeside=function(_100,_101,_102,_103,_104){_104=_104||true;var c={};var d={};var toPx=ag.util.toPx;var pToS=ag.util.posToString;var _105=dijit.getViewport();_102=_102||0;d.node=dojo.byId(_100);c.node=dojo.byId(_101);c.pos=ag.util.getPosition(c.node);c.size=this.getSize(c.node);d.size=this.getSize(d.node);var side="right";var _106=(c.pos.x+d.size.w+c.size.w+_103);var _107=(c.pos.x-d.size.w-_103-(_105.l||0));var topY=(c.pos.y+_102);d.bottomEdge=(topY+d.size.h);d.topEdge=topY;if((d.bottomEdge-_105.t)>_105.h){topY=((_105.h-d.size.h)+_105.t);}else{if(d.topEdge<(_105.t||0)){topY=(_105.t||0);}}var best={position:"absolute",top:toPx(topY),left:null};if(_106<_105.w){best.left=toPx(c.pos.x+c.size.w);side="right";}else{if(_107>0){best.left=toPx(c.pos.x-d.size.w);side="left";}else{best.left=toPx((c.pos.x+(c.size.w/2))-(d.size.w/2));side="center";}}if(_104){dojo.style(d.node,best);}return {newPosition:best,side:side};};w.placeInCenter=function(_108){_108=_108||dojo.doc.createElement("div");var toPx=ag.util.toPx;var pToS=ag.util.posToString;var _109=dijit.getViewport();var _10a=this.getSize(_108);var newX=_109.l+(_109.w-_10a.w)/2;var newY=_109.t+(_109.h-_10a.h)/2;var best={left:toPx(newX),top:toPx(newY),position:"absolute"};dojo.style(_108,best);best.x=newX;best.y=newY;return best;};w.getResultsPaneTopCenter=function(){var _10b=dijit.byId("docpane");var _10c=dijit.getViewport();var ret={};if(!_10b){ret.x=((_10c.w/2)-_10c.l);ret.y=((_10c.h/2)-_10c.t);}else{var p={};p.size=this.getSize(_10b.domNode);p.pos=ag.util.getPosition(_10b.domNode);ret.x=((p.size.w/2)-_10c.l)+p.pos.x;ret.y=_10c.t+p.pos.y;}return ret;};w.adjustPosition=function(id,adj,rel,_10d){var node=dojo.byId(id);var pos=rel||ag.util.getPosition(node);var _10e={x:pos.x+adj.x,y:pos.y+adj.y};_10d=_10d||["BR","BL","TR","TL"];dijit.placeOnScreen(node,_10e,_10d,false);return _10e;};})();}if(!dojo._hasResource["ag.widget"]){dojo._hasResource["ag.widget"]=true;dojo.provide("ag.widget");}if(!dojo._hasResource["ag.widget._TemplatedWidget"]){dojo._hasResource["ag.widget._TemplatedWidget"]=true;dojo.provide("ag.widget._TemplatedWidget");ag.widget._TemplatedWidget=agi.widget._TemplatedWidget;}if(!dojo._hasResource["ag.widget._ProtoDetailPane"]){dojo._hasResource["ag.widget._ProtoDetailPane"]=true;dojo.provide("ag.widget._ProtoDetailPane");dojo.declare("ag.widget._ProtoDetailPane",[ag.widget.AGContentPane,ag.widget._TemplatedWidget,ag.classes.Publisher],{templatePath:null,title:null,synopsis:null,product_number:null,display_url:null,connectId:null,big_thumb_url:null,price:null,imghost:null,imgbase:null,ahost:null,khost:null,path_number:null,rating_pct:null,rating_owned:null,fromNode:true,fromAjax:false,qsToggle:null,BUILD_DELAY:null,TITLE_QUERY:null,SYNOPSIS_QUERY:null,DISPLAY_URL_QUERY:null,BIG_THUMB_URL_QUERY:null,FORMAT_QUERY:null,QS_TOGGLE_QUERY:null,QS_TOGGLE_ID_BASE:null,postMixinProperties:function(){this._connectNode=dojo.byId(this.connectId);},buildRendering:function(){if(this.autoPublishBuild&&this.publishBuildBegin){this.publishBuildBegin();}this.inherited(arguments);this.delayBuildTimer=setTimeout(dojo.hitch(this,function(){this.delayedBuild();if(this.autoPublishBuild){this.publishBuildComplete();}}),this.BUILD_DELAY);},delayedBuild:function(){this.isBuilt=true;}});}if(!dojo._hasResource["ag.widget.QuickSendPane"]){dojo._hasResource["ag.widget.QuickSendPane"]=true;dojo.provide("ag.widget.QuickSendPane");dojo.declare("ag.widget.QuickSendPane",[ag.widget._ProtoDetailPane],{templateString:"<div>\n<div class=\"agi-tabless\">\n    <span class=\"card-details clickable\">\n        <img src=\"{{imghost}}/{{imgbase}}/details/gray_card_details.gif\"\n            width=\"112\"\n            height=\"18\"\n            alt=\"card details\"\n            border=\"0\"\n            id=\"card-detail-toggle-{{id}}\"/>\n    </span>\n    <span>\n        <img src=\"{{imghost}}/{{imgbase}}/details/red_quick_send.gif\"\n            width=\"108\"\n            height=\"18\"\n            alt=\"quick send\"\n            border=\"0\"\n            title=\"quick send\"\n            id=\"quick-send-toggle-{{id}}\"/>\n    </span>\n    <br style=\"clear:both;\" />\n</div>\n\n<div class=\"agi-quickpad\">\n<div class=\"agi-formpage\">\n    <form action=\"{{khost}}/ecards/custom.pd\"\n        id=\"input-form-{{id}}\"\n        method=\"POST\">\n        <fieldset>\n        <div class=\"agi-poppertitle\">to</div>\n        <label for=\"toemail-{{id}}\">email</label>\n        <span>\n            <textarea cols=\"60\"\n                rows=\"2\"\n                name=\"toemail\"\n                id=\"toemail-{{id}}\"\n                class=\"to-email\"></textarea>\n        </span>\n        </fieldset>\n        <fieldset>\n        <div class=\"agi-poppertitle\">from</div>\n        <label for=\"{{id}}-fromname\">name</label>\n        <span><input id='{{id}}-fromname' type='text'\n            maxlength=75 name='fromname' value='{{full_name}}'/>\n        </span>\n        <label for=\"{{id}}-fromemail\">email</label>\n        <span><input id='{{id}}-fromemail' type='text'\n            maxlength=75 name='fromemail' class='agi-lazyinput'\n            disabled='disabled'  value='{{email_address}}'/>\n        </span>\n        <label for=\"{{id}}-frommessage\">message</label>\n        <span>\n            <textarea name=\"pn1465\"\n                id=\"{{id}}-frommessage\"\n                class=\"quicksend-message\"></textarea>\n        </span>\n        </fieldset>\n        <div class=\"agi-buttons\">\n            <div class=\"agi-button\">\n                <input type=\"image\"\n                    id=\"send-button-{{id}}\"\n                    class=\"send-button\"\n                    src=\"{{imghost}}/{{imgbase}}/button/sendecard.gif\"\n                    style=\"width:110px;height:20px;\" />\n            </div>\n            <div class=\"agi-button\">\n                <input type=\"image\"\n                    id=\"preview-button-{{id}}\"\n                    class=\"preview-button\"\n                    src=\"{{imghost}}/{{imgbase}}/button/preview.gif\"\n                    style=\"width:80px;height:20px;\" />\n            </div>\n        </div>\n        <input type=\"hidden\" name=\"action\" value=\"\" />\n        <input type=\"hidden\" name=\"prodnum\" value=\"{{product_number}}\" />\n        <input type=\"hidden\" name=\"path\" value=\"{{path_number}}\" />\n        <input type=\"hidden\" name=\"blnquicksend\" value=\"1\"/>\n        <input type=\"hidden\" name=\"navtype\" value=\"qsend\"/>\n        <input type=\"hidden\" name=\"notify_nopickup\" value=\"Y\" />\n        <input type=\"hidden\" name=\"reply_request\" value=\"Y\" />\n        <input type=\"hidden\" name=\"cc_sender\" value=\"Y\" />\n    </form>\n</div>\n</div>\n</div>\n",ahost:"",customer_type:"free",display_url:"",email_address:"",from_email:"",from_name:"",full_name:"",imgbase:"agbeta",imghost:"",khost:"",path_number:"",product_number:"",autoPublishBuild:true,delayBuildTimer:null,inputForm:null,sendButton:null,previewButton:null,detailToggle:null,qsToggle:null,toEmailTextarea:null,fromEmailInput:null,BUILD_BEGIN_EVENT_TMPL:"/quicksend-pane-${id}/build/begin/",BUILD_COMPLETE_EVENT_TMPL:"/quicksend-pane-${id}/build/complete/",LAZY_INPUT_CLASS:"agi-lazyinput",BUILD_DELAY:200,INPUT_FORM_QUERY:null,INPUT_FORM_ID_BASE:"input-form-",DETAIL_TOGGLE_QUERY:null,DETAIL_TOGGLE_ID_BASE:"card-detail-toggle-",FROMEMAIL_INPUT_BASE:"-fromemail",FROMEMAIL_INPUT_QUERY:null,SEND_BUTTON_QUERY:null,SEND_BUTTON_ID_BASE:"send-button-",PREVIEW_BUTTON_QUERY:null,PREVIEW_BUTTON_ID_BASE:"preview-button-",TOEMAIL_TEXTAREA_ID_BASE:"toemail-",TOEMAIL_TEXTAREA_QUERY:null,getAddress:function(){if(!this.toEmailTextarea){return;}try{agx.currentPage.controller.connectAutoComplete(this.toEmailTextarea.id,agx.currentPage.customerIsSignedIn);}catch(e){connectAutoComplete(this.toEmailTextarea.id);}},buildRendering:function(){this.getQueries();this.inherited(arguments);},delayedBuild:function(){this.getFormAndButtons();this.connectButtonEvents();this.inherited(arguments);},getQueries:function(){this.INPUT_FORM_QUERY=this.INPUT_FORM_ID_BASE+this.id;this.DETAIL_TOGGLE_QUERY=this.DETAIL_TOGGLE_ID_BASE+this.id;this.SEND_BUTTON_QUERY=this.SEND_BUTTON_ID_BASE+this.id;this.PREVIEW_BUTTON_QUERY=this.PREVIEW_BUTTON_ID_BASE+this.id;this.TOEMAIL_TEXTAREA_QUERY=this.TOEMAIL_TEXTAREA_ID_BASE+this.id;this.FROMEMAIL_INPUT_QUERY=this.id+this.FROMEMAIL_INPUT_BASE;},getFormAndButtons:function(){this.sendButton=dojo.byId(this.SEND_BUTTON_QUERY);this.previewButton=dojo.byId(this.PREVIEW_BUTTON_QUERY);this.inputForm=dojo.byId(this.INPUT_FORM_QUERY);this.detailToggle=dojo.byId(this.DETAIL_TOGGLE_QUERY);this.toEmailTextarea=dojo.byId(this.TOEMAIL_TEXTAREA_QUERY);this.fromEmailInput=dojo.byId(this.FROMEMAIL_INPUT_QUERY);},connectButtonEvents:function(){if(this.inputForm){this.connect(this.inputForm,"onsubmit",this._OnSubmit);}if(this.sendButton){this.connect(this.sendButton,"onclick",this._sendOnClick);}if(this.previewButton){this.connect(this.previewButton,"onclick",this._previewOnClick);}if(this.toEmailTextarea){this.connect(this.toEmailTextarea,"onfocus",this.getAddress);}if(this.fromEmailInput){if(!dojo.trim(this.fromEmailInput.value)){this.fromEmailInput.disabled=false;dojo.removeClass(this.fromEmailInput,this.LAZY_INPUT_CLASS);}}},_OnSubmit:function(){return ag.util.debounce(this.inputForm,null,20);},_sendOnClick:function(){if(this.inputForm){this.inputForm.action.value="send";this.inputForm.action.name="btnSend";}},_previewOnClick:function(){if(this.inputForm){this.inputForm.action.value="preview";this.inputForm.action.name="btnPreview";}}});}if(!dojo._hasResource["ag.widget.FreeQuickSendPane"]){dojo._hasResource["ag.widget.FreeQuickSendPane"]=true;dojo.provide("ag.widget.FreeQuickSendPane");dojo.declare("ag.widget.FreeQuickSendPane",[ag.widget.QuickSendPane],{templateString:"<div>\n    <div class=\"agi-tabless\">\n        <span class=\"clickable\">\n            <img src=\"{{imghost}}/{{imgbase}}/details/gray_card_details.gif\" \n                width=\"112\" \n                height=\"18\" \n                alt=\"card details\" \n                border=\"0\" \n                id=\"card-detail-toggle-{{id}}\"/>\n        </span>\n        <span>\n            <img src=\"{{imghost}}/{{imgbase}}/details/red_quick_send.gif\" \n                width=\"108\" \n                height=\"18\" \n                alt=\"quick send\" \n                border=\"0\" \n                title=\"quick send\"\n                id=\"quick-send-toggle-{{id}}\"/>\n        </span>\n        <br clear=\"all\" />\n    </div>\n    <div class=\"agi-quickpad\">\n        <p>You must be a paid member to quick send a card. \n            Please sign in or join now to send.</p>\n    </div>\n\t\t<div class=\"agi-buttons\">\n        <div class=\"agi-button\">\n            <a href=\"javascript:agx.currentPage.doJoin()\"><img \n                src=\"{{imghost}}/{{imgbase}}/button/joinnow.gif\" \n                border=\"0\"\n                id=\"join-now-button-{{id}}\"/></a>\n        </div>\n        <div class=\"agi-button\">\n            <a href=\"{{display_url}}\"><img \n                src=\"{{imghost}}/{{imgbase}}/button/viewecard.gif\" \n                border=\"0\" \n                width=\"110\" \n                height=\"20\" \n                alt=\"view ecard\" \n                title=\"view ecard\"\n                id=\"view-card-button-{{id}}\"/></a>\n        </div>\n    </div>\n</div>     \n",BUILD_DELAY:300});}if(!dojo._hasResource["ag.widget.ProductDetailPane"]){dojo._hasResource["ag.widget.ProductDetailPane"]=true;dojo.provide("ag.widget.ProductDetailPane");dojo.declare("ag.widget.ProductDetailPane",[ag.widget._ProtoDetailPane],{templateString:"<div>\n<div class=\"agi-tabless\">\n    <span> \n        <img src=\"{{imghost}}/{{imgbase}}/details/card_details.gif\" \n            width=\"112\" \n            height=\"18\" \n            alt=\"ecard detail\" \n            border=\"0\" \n            title=\"ecard detail\" \n            id=\"card-detail-toggle-{{id}}\"/>\n    </span>\n    <span class=\"quicksend-button clickable\">  \n        <img src=\"{{imghost}}/{{imgbase}}/details/quick_send.gif\" \n            width=\"108\" \n            height=\"18\" \n            alt=\"quick send\" \n            border=\"0\" \n            title=\"quick send\" \n            id=\"quick-send-toggle-{{id}}\"/>\n    </span>\n    <br clear=\"all\" />\n</div>\n<div class=\"detail-panel\" id=\"detail-panel-{{product_number}}\" > \n    <div class=\"agi-largethumb\">\n        <a href=\"{{display_url}}\"><img \n            id=\"largethumb-{{product_number}}\" \n            src=\"{{big_thumb_url}}\" \n            width=\"200\" \n            height=\"108\" \n            alt=\"{{title}}\" \n            border=\"0\" \n            title=\"{{title}}\" /></a>\n    </div>\n</div>\n<div id=\"agi-largethumbdetail\">\n    <h2>{{title}}</h2>\n    <p><strong>ecard message</strong>\n      {{synopsis}} \n    </p>    \n    <div class=\"agi-button\">\n        <a class=\"agi-button-red-dflt\" href=\"{{display_url}}\">\n\t\t\t\t\t<div class=\"agi-button-inner\">\n\t\t\t\t\t\t<div class=\"agi-button-copy\">view ecard</div>\n\t\t\t\t\t</div>\n\t\t\t\t</a>\n    </div>\n</div>\n</div> \n",autoPublishBuild:true,BUILD_BEGIN_EVENT_TMPL:"/detail-pane-${id}/build/begin",BUILD_COMPLETE_EVENT_TMPL:"/detail-pane-${id}/build/complete",BUILD_DELAY:200,TITLE_QUERY:"a.title",SYNOPSIS_QUERY:"dd.synopsis",DISPLAY_URL_QUERY:"a.title",BIG_THUMB_URL_QUERY:"img.big-thumb",FORMAT_QUERY:"dd.format",QS_TOGGLE_ID_BASE:"quick-send-toggle-",delayedBuild:function(){this.getToggleButton();this.inherited(arguments);},getToggleButton:function(){this.QS_TOGGLE_QUERY=this.QS_TOGGLE_ID_BASE+this.id;this.qsToggle=dojo.byId(this.QS_TOGGLE_QUERY);}});}if(!dojo._hasResource["ag.widget._ProtoPopper"]){dojo._hasResource["ag.widget._ProtoPopper"]=true;dojo.provide("ag.widget._ProtoPopper");dojo.declare("ag.widget._ProtoPopper",[ag.widget._TemplatedWidget,ag.classes.Publisher],{templatePath:"",templateString:"",templateCssPath:"",ahost:null,big_thumb_url:null,customer_type:null,customer_status:null,display_url:null,email_address:null,format:null,full_name:null,imgbase:null,imghost:null,khost:null,mature_message:null,path:null,price:null,product_number:null,small_thumb_url:null,synopsis:null,title:null,isLoaded:false,isMature:false,isQuickSend:true,isCentered:false,autoPublishBuild:false,connectEvents:[],dataId:null,connectId:[],_connectHandles:[],_winOnScrollHandle:null,_winOnResizeHandle:null,DetailPaneClass:null,QuickSendPaneClass:null,srcNodeRef:null,fromNode:true,fadeInArgs:null,fadeOutArgs:null,quickSendPaneExtraArgs:null,detailPaneExtraArgs:null,buildRenderingFuncs:[],_bgIframe:null,_quickSendPane:null,_productDetailPane:null,_dataNode:null,_connectNode:null,_connectNodes:[],_fadeIn:null,_fadeOut:null,_fadeInConn:null,_fadeOutConn:null,_showTimer:null,_hideTimer:null,BUILD_BEGIN_EVENT_TMPL:null,BUILD_COMPLETE_EVENT_TMPL:null,DETAIL_PANE_ID_SUFFIX:null,HIDE_DELAY:null,MATURE_MESSAGE:null,OPEN_DOMNODE_MAX_PADDING:null,OPEN_DOMNODE_POSITION:null,OPEN_DOMNODE_VISIBILITY:null,OPEN_DOMNODE_VOFFSET:null,OPEN_DOMNODE_ZINDEX:null,QUICKSEND_PANE_ID_SUFFIX:null,SHOW_DELAY:null,FADE_DELAY:null,BIG_THUMB_URL_QUERY:null,CLOSE_ELEMENT_QUERY:null,CUSTOMER_TYPE_QUERY:null,DISPLAY_URL_QUERY:null,FORMAT_QUERY:null,ISMATURE_QUERY:null,PATH_QUERY:null,PRICE_QUERY:null,QUICKSEND_STATUS_QUERY:null,SMALL_THUMB_URL_QUERY:null,SYNOPSIS_QUERY:null,TITLE_QUERY:null,postMixInProperties:function(){if(dojo.isString(this.connectId)){this.connectId=[this.connectId];}this.parent=null;},buildRendering:function(){this.publishBuildBegin();this._dataNode=dojo.byId(this.dataId);this.getMatureFlag();this.getFormatNode();this.inherited(arguments);this._connectNode=dojo.byId(this.connectId[0]);this._dataNode=dojo.byId(this.dataId);if(this.fromNode){this.getQuickSendStatus();this.getProductNumber();this.getTitle();this.getPrice();this.getSynopsis();this.getDisplayUrl();this.getThumbUrls();this.getCustomerType();this.getPathNode();this.buildFaders();this.connectToFaders();dojo.forEach(this.buildRenderingFuncs,dojo.hitch(this,function(f){this[f]();}));}this.getCustomerStatus();if(this.customer_type!="free"||this.customer_status==5){this.getCustomerInfo();}var _10f;if(this.customer_type=="free"&&parseInt(this.price,10)!==0){_10f=this.FreeQuickSendPaneClass;}else{_10f=this.QuickSendPaneClass;}if(this.fromNode){this.buildQuickSendPane(_10f);this.buildDetailPane();this.connectCloseX();}this.publishBuildComplete();},getCustomerStatus:function(){var _110=agi.cookie.AGICookie.getCookieName("customer");this.customer_status=agi.cookie.AGICookie.getCookieValue(_110,"status");},getProductNumber:function(){this.product_number=this._dataNode.id;},getCustomerInfo:function(){this.email_address=agi.cookie.AGICookie.getCookieValue("customer","email");if(this.email_address=="null"){this.email_address="";}var _111=agi.cookie.AGICookie.getCookieValue("customer","name");var _112=agi.cookie.AGICookie.getCookieValue("customer","lname");var _113=function(s){var ret=s;if(!s){ret="";}else{if(s&&dojo.trim(s)=="null"){ret="";}}return ret;};this.full_name=_113(_111)+" "+_113(_112);},getQuickSendStatus:function(){var qs=agi.util.query_one(this.QUICKSEND_STATUS_QUERY,this._dataNode).firstChild.nodeValue;if(qs.indexOf("True")>-1){this.isQuickSend=true;}else{this.isQuickSend=false;}},disableQuickSend:function(){dojo.addClass(this.domNode,"non-quicksend");},getTitle:function(){this.title=agi.util.query_one(this.TITLE_QUERY,this._dataNode).getAttribute("title");},getPrice:function(){this.price=agi.util.query_one(this.PRICE_QUERY,this._dataNode).firstChild.nodeValue;},getSynopsis:function(){var _114="";synopsisNode=agi.util.query_one(this.SYNOPSIS_QUERY,this._dataNode);if(synopsisNode.firstChild!==null){_114=synopsisNode.innerHTML;}this.synopsis=agi.util.truncate(_114,250);},getDisplayUrl:function(){this.display_url=agi.util.query_one(this.DISPLAY_URL_QUERY,this._dataNode).getAttribute("href");},getThumbUrls:function(){this.big_thumb_url=agi.util.query_one(this.BIG_THUMB_URL_QUERY,this._dataNode).firstChild.nodeValue;this.small_thumb_url=agi.util.query_one(this.SMALL_THUMB_URL_QUERY,this._dataNode).getAttribute("src");},getMatureFlag:function(){mature_nodes=dojo.query(this.ISMATURE_QUERY,this._dataNode);if(mature_nodes.length>0){mature=mature_nodes[0].firstChild.nodeValue;if(mature.indexOf("1")>-1){this.isMature=true;}else{this.isMature=false;}if(this.isMature){this.mature_message=this.MATURE_MESSAGE;}else{this.mature_message="";}}else{this.mature_message="";}},getCustomerType:function(){var _115=agi.util.query_one(this.CUSTOMER_TYPE_QUERY,this._dataNode);if(_115.hasChildNodes()){var cust=_115.firstChild.nodeValue;if(cust.indexOf("free")>-1){this.customer_type="free";}else{this.customer_type="pay";}}},getFormatNode:function(){var _116=agi.util.query_one(this.FORMAT_QUERY,this._dataNode);if(_116.hasChildNodes()){this.format=_116.firstChild.nodeValue;}},getPathNode:function(){var _117=agi.util.query_one(this.PATH_QUERY,this._dataNode);if(_117.hasChildNodes()){this.path=_117.firstChild.nodeValue;}},connectToFaders:function(){dojo.disconnect(this._fadeInConn);dojo.disconnect(this._fadeOutConn);this._fadeInConn=dojo.connect(this._fadeIn,"beforeBegin",this,this.preFadeIn);this._fadeOutConn=dojo.connect(this._fadeOut,"onEnd",this,this.postFadeOut);},buildFaders:function(){var a={};if(!this.fadeInArgs){a.node=this.domNode;a.duration=this.FADE_DELAY;this.fadeInArgs=a;}if(!this.fadeOutArgs){a.node=this.domNode;a.duration=this.FADE_DELAY;this.fadeOutArgs=a;}this._fadeIn=dojo.fadeIn(this.fadeInArgs);this._fadeOut=dojo.fadeOut(this.fadeOutArgs);},preFadeIn:function(){dojo.style(this.domNode,{visibility:""});},postFadeOut:function(){ag.widget.placeOffScreen(this.domNode);this.isShowingNow=false;this.showDetailPane();this.postCreate();},destroy:function(_118){this.parent=null;this.inherited(arguments);},prepare:function(node){var s=node.style;s.visibility="hidden";s.position="absolute";s.top="-9999px";if(s.display=="none"){s.display="";}dojo.body().appendChild(node);},_setUpTearDown:function(_119){this._connectNodes=[];var _11a=[this.domNode];if(this._connectHandles){dojo.forEach(this._connectHandles,dojo.hitch(this,function(_11b){try{this.disconnect(_11b);}catch(e){}}));this._connectHandles=[];}if(_119=="disconnect"){return;}dojo.forEach(this.connectId,function(id){if(id.indexOf("small-thumb")!=-1){try{this._connectNode=dojo.byId(id);_11a.push(this._connectNode);}catch(e){}}},this);dojo.forEach(_11a,function(id){var node=dojo.byId(id);try{this._connectNodes.push(node);dojo.forEach(this.connectEvents,dojo.hitch(this,function(evts){var _11c=this[_119](node,evts[0],evts[1]);this._connectHandles.push(_11c);}));if(dojo.isIE){dojo.style(node,{zoom:1});}}catch(e){}},this);this.prepare(this.domNode);},_disconnectFromWindowEvents:function(){this.disconnect(this._winOnScrollHandle);this.disconnect(this._winOnResizeHandle);},_connectToWindowEvents:function(){this._winOnScrollHandle=this.connect(window,"onscroll","layout");this._winOnResizeHandle=this.connect(window,"onresize","layout");},postCreate:function(){this._setUpTearDown("connect");if(!this._bgIframe&&dojo.isIE){this._bgIframe=new dijit.BackgroundIframe(this.domNode);}},uninitialize:function(){this._setUpTearDown("disconnect");this.stopFadeIn();this.stopFadeOut();this.inherited(arguments);},getConnectNode:function(){dojo.forEach(this._connectNodes,dojo.hitch(this,function(node){var _11d=node.id;if(_11d.indexOf("small-thumb")>-1){this._connectNode=node;}}));},open:function(_11e){try{this.stopShowTimer();this.stopHideTimer();this._disconnectFromWindowEvents();this._connectToWindowEvents();this.layout(null,_11e);this._completePop();this.isShowingNow=true;}catch(e){}},layout:function(evt,_11f){dojo.style(this.domNode,{position:this.OPEN_DOMNODE_POSITION,visibility:this.OPEN_DOMNODE_VISIBILITY,zIndex:this.OPEN_DOMNODE_ZINDEX});var pt=_11f||this.point;if(pt){this._popHere(pt);}else{if(this.isCentered){this._popCenter();}else{this._popToSide();}}},startup:function(){if(!this._started){this.aboutToShow();}this.inherited(arguments);},getProductDetailPaneHandle:function(_120){var ret=dojo.string.substitute(_120.prototype.BUILD_COMPLETE_EVENT_TMPL,{id:this.id+this.DETAIL_PANE_ID_SUFFIX});return ret;},buildDetailPane:function(){var _121=ag.widget[this.DetailPaneClass];var _122={ahost:this.ahost,big_thumb_url:this.big_thumb_url,connectId:this._connectNode.id,customer_type:this.customer_type,display_url:this.display_url,email_address:this.email_address,fromNode:false,full_name:this.full_name,id:this.id+this.DETAIL_PANE_ID_SUFFIX,imgbase:this.imgbase,imghost:this.imghost,isMature:this.isMature,khost:this.khost,path_number:this.path,price:this.price,product_number:this.product_number,synopsis:this.synopsis,title:this.title};if(this.detailPaneExtraArgs){dojo.mixin(_122,this.detailPaneExtraArgs);}this._productDetailPane=new _121(_122);this.domNode.appendChild(this._productDetailPane.domNode);dojo.subscribe(this.getProductDetailPaneHandle(_121),dojo.hitch(this,function(){if(this._productDetailPane.qsToggle){this.connect(this._productDetailPane.qsToggle,"onclick",this.showQuickSendPane);}}));},getQuickSendPaneHandle:function(_123){var ret=dojo.string.substitute(_123.prototype.BUILD_COMPLETE_EVENT_TMPL,{id:this.id+this.QUICKSEND_PANE_ID_SUFFIX});return ret;},quickDetailToggle:function(){this.connect(this._quickSendPane.detailToggle,"onclick",this.showDetailPane);},buildQuickSendPane:function(_124){if(!this.isQuickSend){this.disableQuickSend();}var _125=ag.widget[_124];if(!_125){_125=ag.widget[this.QuickSendPaneClass];}var _126={ahost:this.ahost,connectId:this._connectNode.id,customer_type:this.customer_type,display_url:this.display_url,email_address:this.email_address,fromNode:false,full_name:this.full_name,id:this.id+this.QUICKSEND_PANE_ID_SUFFIX,imgbase:this.imgbase,imghost:this.imghost,isMature:this.isMature,khost:this.khost,path_number:this.path,product_number:this.product_number};if(this.quickSendPaneExtraArgs){dojo.mixin(_126,this.quickSendPaneExtraArgs);}this._quickSendPane=new _125(_126);this.domNode.appendChild(this._quickSendPane.domNode);dojo.subscribe(this.getQuickSendPaneHandle(_125),dojo.hitch(this,function(){this.connect(this._quickSendPane.detailToggle,"onclick",this.showDetailPane);}));},aboutToShow:function(){dojo._setOpacity(this.domNode,0);agi.util.hide(this._quickSendPane.domNode);agi.util.show(this._productDetailPane.domNode);},close:function(){if(!this.isShowingNow){return;}this.stopListening();if(this._fadeIn&&this._fadeIn.status()=="playing"){this._fadeIn.stop();}this.stopHideTimer();this.stopShowTimer();this._fadeOut.play();},startShowTimer:function(){if(!this.isShowingNow){if(!this._showTimer){this._showTimer=setTimeout(dojo.hitch(this,function(){this.open();}),this.SHOW_DELAY);}}else{}},stopShowTimer:function(){if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}},stopHideTimer:function(){if(this._hideTimer){clearTimeout(this._hideTimer);delete this._hideTimer;}},setDetailPane:function(pane){this._productDetailPane=pane;},setQuickSendPane:function(pane){this._quickSendPane=pane;},showDetailPane:function(){agi.util.hide(this._quickSendPane.domNode);agi.util.show(this._productDetailPane.domNode);},showQuickSendPane:function(){agi.util.hide(this._productDetailPane.domNode);agi.util.show(this._quickSendPane.domNode);this.uninitialize();dojo.connect(this,"showDetailPane",this,this.postCreate);},connectCloseX:function(){this.connect(agi.util.q1(this.CLOSE_ELEMENT_QUERY,this.domNode),"onclick",this.forceClose);},forceClose:function(){this.close();},_onMouseOver:function(evt){if(this._hideTimer){this.stopHideTimer();return;}this.startShowTimer();},_onMouseOut:function(evt){if(this._showTimer){this.stopShowTimer();return;}else{if(!this.isShowingNow){return;}}if(dojo.isDescendant(evt.relatedTarget,evt.target)){return;}if(this.isShowingNow){this._hideTimer=setTimeout(dojo.hitch(this,function(){dojo.hitch(this,this.close());}),this.HIDE_DELAY);}},_popToSide:function(){var _127=ag.widget.placeBeside(this.domNode,this._connectNode,this.OPEN_DOMNODE_VOFFSET,this.OPEN_DOMNODE_MAX_PADDING,false);this._position(_127);dojo.addClass(this._connectNode,"popped_"+_127.side);},_popHere:function(_128){var _129={left:agi.util.toPx(_128.x),top:agi.util.toPx(_128.y)};this._position(_129);},_popCenter:function(){var toPx=agi.util.toPx;var _12a=ag.widget.getSize(this.domNode);var rel=ag.widget.getResultsPaneTopCenter();var _12b={left:toPx(rel.x-(_12a.w/2)),top:toPx(rel.y-(_12a.h/2))};this._position(_12b);},_position:function(pos){dojo.style(this.domNode,pos);},_completePop:function(){this.stopFadeOut();this._fadeIn.play();},stopFadeOut:function(){if(this._fadeOut&&this._fadeOut.status()=="playing"){this._fadeOut.stop();}},stopFadeIn:function(){if(this._fadeIn&&this._fadeIn.status()=="playing"){this._fadeIn.stop();}},stopListening:function(){this._hover=false;this.uninitialize();this._disconnectFromWindowEvents();}});}if(!dojo._hasResource["ag.widget.Popper"]){dojo._hasResource["ag.widget.Popper"]=true;dojo.provide("ag.widget.Popper");dojo.declare("ag.widget.Popper",[ag.widget._ProtoPopper],{templateString:"<div \n    style=\"display:none;position:absolute;\"\n    id=\"popper-contents\" \n    class=\"agi-detailpopup\">\n\n    <div class=\"agi-close\">\n        <span>{{format}} {{mature_message}}</span>     \n        <img class=\"pop-closer\" src=\"{{imghost}}/{{imgbase}}/x.gif\"/> \n    </div>\n</div>\n",templateCssPath:"",ahost:"",big_thumb_url:"",customer_type:"free",display_url:"",email_address:"",format:"",fromNode:true,full_name:"",imgbase:"agbeta",imghost:"",khost:"",mature_message:"",path:"",price:1,product_number:"",small_thumb_url:"",synopsis:"",title:"",isLoaded:false,isMature:false,isQuickSend:true,publishBuild:true,connectEvents:[["onmouseover","_onMouseOver"],["onmouseout","_onMouseOver"],["onmouseout","_onMouseOut"]],dataId:null,connectId:[],DetailPaneClass:"ProductDetailPane",QuickSendPaneClass:"QuickSendPane",FreeQuickSendPaneClass:"FreeQuickSendPane",fadeInArgs:null,fadeOutArgs:null,BUILD_BEGIN_EVENT_TMPL:"/popper-${id}/build/begin",BUILD_COMPLETE_EVENT_TMPL:"/popper-${id}/build/complete",DETAIL_PANE_ID_SUFFIX:"-product-detail-pane",HIDE_DELAY:200,MATURE_MESSAGE:" (mature)",OPEN_DOMNODE_MAX_PADDING:20,OPEN_DOMNODE_POSITION:"absolute",OPEN_DOMNODE_VISIBILITY:"visible",OPEN_DOMNODE_VOFFSET:-80,OPEN_DOMNODE_ZINDEX:300,QUICKSEND_PANE_ID_SUFFIX:"-quicksend-pane",SHOW_DELAY:800,FADE_DELAY:150,BIG_THUMB_URL_QUERY:"dd.large-preview",CLOSE_ELEMENT_QUERY:"div.agi-close",CUSTOMER_TYPE_QUERY:"dd.customertype",DISPLAY_URL_QUERY:".title",FORMAT_QUERY:"dd.format",ISMATURE_QUERY:"dd.mature",PATH_QUERY:"dd.path",PRICE_QUERY:"dd.price",QUICKSEND_STATUS_QUERY:"dd.isquicksend",SMALL_THUMB_URL_QUERY:"img.small-thumb",SYNOPSIS_QUERY:"dd.synopsis",TITLE_QUERY:".title"});}if(!dojo._hasResource["ag.widget.PopperManagerMixin"]){dojo._hasResource["ag.widget.PopperManagerMixin"]=true;dojo.provide("ag.widget.PopperManagerMixin");dojo.declare("ag.widget.PopperManagerMixin",[ag.classes._Mixin],function(){var self={};var d=dojo;d.mixin(self,{popperProducts:[],popperType:"",popperIds:[],connect_handles:{},PopperClass:undefined,POPPER_PRODUCT_QUERY:"div.product2"});self.constructor=function(){this.popperGetType();};self.popperQueryAttach=function(){this.popperProducts=[];d.query(this.POPPER_PRODUCT_QUERY).forEach(d.hitch(this,function(item){this.popperProducts.push(item.id);this.popperInitOne(item.id);}));};self.popperInitOne=function(_12c){var _12d="small-thumb-"+_12c.toString();var _12e=dojo.byId(_12d);if(_12e){this.connect_handles[_12c]=dojo.connect(_12e,"onmouseover",this,this.popperCreate);}else{}};self.popperInit=function(){if(agx.currentPage.disablePoppers){return;}if(typeof agx.currentPage.popperType!="undefined"){this.popperType=agx.currentPage.popperType;}this.popperQueryAttach();};self.popperGetType=function(){var pop="";try{pop=this.popperType.charAt(0).toUpperCase();pop+=this.popperType.substring(1).toLowerCase();}catch(e){}this.PopperClass=pop+"Popper";};self.popperGetTypeConstructor=function(){if(!ag.widget[this.PopperClass]){throw new Error(this+": you must explicitly require the popper "+"class prior to calling popperInit because of the way"+" d.require works.");}return ag.widget[this.PopperClass];};self.popperCreate=function(_12f){var _130=_12f.target.id;var _131=_130.split("-")[2];if(!_131){_131=_130.split("-")[1];}var _132=ag.util.getProdId(_131);var _133=dijit.byId(_132);var _134;if(!_133){var _135=this.popperGetTypeConstructor();var _136=dojo.doc.createElement("div");_136.style.position="absolute";this.popperGetProductInfo(_131,_132);var widg=new _135(this._popperTmpInfo,_136);dojo.body().appendChild(widg.domNode);this.popperIds.push(_132);widg.startup();dojo.disconnect(this.connect_handles[_131]);widg.startShowTimer();_134=widg;}else{_133.startup();_134=_133;}return _134;};self.popperGetProductInfo=function(_137,_138){this._popperTmpInfo={imghost:this.imghost,ahost:this.ahost,khost:this.khost,imgbase:this.imgbase,connectId:["small-thumb-"+_137],dataId:_137,containerNode:d.doc.createElement("div"),id:_138};};self.popperGetAll=function(){return dijit.registry.byClass("ag.widget."+this.PopperClass.toString());};self.popperDestroyAll=function(){this.popperGetAll().forEach(function(_139){try{_139.parent=null;_139._quickSendPane.destroyRecursive();_139._productDetailPane.destroyRecursive();_139.destroyRecursive();}catch(e){}});};return self;}());}if(!dojo._hasResource["ag.classes._base"]){dojo._hasResource["ag.classes._base"]=true;dojo.provide("ag.classes._base");ag.classes=agi.classes;}if(!dojo._hasResource["ag.classes"]){dojo._hasResource["ag.classes"]=true;dojo.provide("ag.classes");}if(!dojo._hasResource["ag.widget._AGTemplated"]){dojo._hasResource["ag.widget._AGTemplated"]=true;dojo.provide("ag.widget._AGTemplated");dojo.declare("ag.widget._AGTemplated",[dijit._Templated],{__culprit__:"$Author: dbuch $"});}if(!dojo._hasResource["ag.widget._AGWidget"]){dojo._hasResource["ag.widget._AGWidget"]=true;dojo.provide("ag.widget._AGWidget");dojo.declare("ag.widget._AGWidget",[dijit._Widget],{__culprit__:"$Author: dbuch $"});}if(!dojo._hasResource["ag.dom.window"]){dojo._hasResource["ag.dom.window"]=true;dojo.provide("ag.dom.window");ag.dom.window=agi.dom.window;}if(!dojo._hasResource["agi.event"]){dojo._hasResource["agi.event"]=true;dojo.provide("agi.event");agi.event.toString=function(){return "AGEvent";};agi.event._anonCtr=0;agi.event._anon={};agi.event.nameAnonFunc=function(_13a,_13b){var jpn="$joinpoint";var nso=(_13b||agi.event._anon);if(dojo.isIE){var cn=_13a["__dojoNameCache"];if(cn&&nso[cn]===_13a){return _13a["__dojoNameCache"];}}var ret="__"+agi.event._anonCtr++;while(typeof nso[ret]!="undefined"){ret="__"+agi.event._anonCtr++;}nso[ret]=_13a;return ret;};(function(){agi.event._canTimeout=dojo.isFunction(dojo.global["setTimeout"])||dojo.isAlien(dojo.global["setTimeout"]);function _13c(args,_13d){var ao={srcObj:dojo.global,srcFunc:null,adviceObj:dojo.global,adviceFunc:null,aroundObj:null,aroundFunc:null,adviceType:(args.length>2)?args[0]:"after",precedence:"last",once:false,delay:null,rate:0,adviceMsg:false};switch(args.length){case 0:return;case 1:return;case 2:ao.srcFunc=args[0];ao.adviceFunc=args[1];break;case 3:if((dojo.isObject(args[0]))&&(dojo.isString(args[1]))&&(dojo.isString(args[2]))){ao.adviceType="after";ao.srcObj=args[0];ao.srcFunc=args[1];ao.adviceFunc=args[2];}else{if((dojo.isString(args[1]))&&(dojo.isString(args[2]))){ao.srcFunc=args[1];ao.adviceFunc=args[2];}else{if((dojo.isObject(args[0]))&&(dojo.isString(args[1]))&&(dojo.isFunction(args[2]))){ao.adviceType="after";ao.srcObj=args[0];ao.srcFunc=args[1];var _13e=agi.event.nameAnonFunc(args[2],ao.adviceObj,_13d);ao.adviceFunc=_13e;}else{if((dojo.isFunction(args[0]))&&(dojo.isObject(args[1]))&&(dojo.isString(args[2]))){ao.adviceType="after";ao.srcObj=dojo.global;var _13e=agi.event.nameAnonFunc(args[0],ao.srcObj,_13d);ao.srcFunc=_13e;ao.adviceObj=args[1];ao.adviceFunc=args[2];}}}}break;case 4:if((dojo.isObject(args[0]))&&(dojo.isObject(args[2]))){ao.adviceType="after";ao.srcObj=args[0];ao.srcFunc=args[1];ao.adviceObj=args[2];ao.adviceFunc=args[3];}else{if((dojo.isString(args[0]))&&(dojo.isString(args[1]))&&(dojo.isObject(args[2]))){ao.adviceType=args[0];ao.srcObj=dojo.global;ao.srcFunc=args[1];ao.adviceObj=args[2];ao.adviceFunc=args[3];}else{if((dojo.isString(args[0]))&&(dojo.isFunction(args[1]))&&(dojo.isObject(args[2]))){ao.adviceType=args[0];ao.srcObj=dojo.global;var _13e=agi.event.nameAnonFunc(args[1],dojo.global,_13d);ao.srcFunc=_13e;ao.adviceObj=args[2];ao.adviceFunc=args[3];}else{if((dojo.isString(args[0]))&&(dojo.isObject(args[1]))&&(dojo.isString(args[2]))&&(dojo.isFunction(args[3]))){ao.srcObj=args[1];ao.srcFunc=args[2];var _13e=agi.event.nameAnonFunc(args[3],dojo.global,_13d);ao.adviceObj=dojo.global;ao.adviceFunc=_13e;}else{if(dojo.isObject(args[1])){ao.srcObj=args[1];ao.srcFunc=args[2];ao.adviceObj=dojo.global;ao.adviceFunc=args[3];}else{if(dojo.isObject(args[2])){ao.srcObj=dojo.global;ao.srcFunc=args[1];ao.adviceObj=args[2];ao.adviceFunc=args[3];}else{ao.srcObj=ao.adviceObj=ao.aroundObj=dojo.global;ao.srcFunc=args[1];ao.adviceFunc=args[2];ao.aroundFunc=args[3];}}}}}}break;case 6:ao.srcObj=args[1];ao.srcFunc=args[2];ao.adviceObj=args[3];ao.adviceFunc=args[4];ao.aroundFunc=args[5];ao.aroundObj=dojo.global;break;default:ao.srcObj=args[1];ao.srcFunc=args[2];ao.adviceObj=args[3];ao.adviceFunc=args[4];ao.aroundObj=args[5];ao.aroundFunc=args[6];ao.once=args[7];ao.delay=args[8];ao.rate=args[9];ao.adviceMsg=args[10];break;}if(dojo.isFunction(ao.aroundFunc)){var _13e=agi.event.nameAnonFunc(ao.aroundFunc,ao.aroundObj,_13d);ao.aroundFunc=_13e;}if(dojo.isFunction(ao.srcFunc)){ao.srcFunc=agi.util.getNameInObj(ao.srcObj,ao.srcFunc);}if(dojo.isFunction(ao.adviceFunc)){ao.adviceFunc=agi.util.getNameInObj(ao.adviceObj,ao.adviceFunc);}if((ao.aroundObj)&&(dojo.isFunction(ao.aroundFunc))){ao.aroundFunc=agi.util.getNameInObj(ao.aroundObj,ao.aroundFunc);}if(!ao.srcObj){agi.util.raise("bad srcObj for srcFunc: "+ao.srcFunc);}if(!ao.adviceObj){agi.util.raise("bad adviceObj for adviceFunc: "+ao.adviceFunc);}if(!ao.adviceFunc){}return ao;};agi.event.connect=function(){if(arguments.length==1){var ao=arguments[0];}else{var ao=_13c(arguments,true);}if(dojo.isString(ao.srcFunc)&&(ao.srcFunc.toLowerCase()=="onkey")){if(dojo.isIE){ao.srcFunc="onkeydown";agi.event.connect(ao);}ao.srcFunc="onkeypress";}if(dojo.isArray(ao.srcObj)&&ao.srcObj!=""){var _13f={};for(var x in ao){_13f[x]=ao[x];}var mjps=[];dojo.forEach(ao.srcObj,function(src){if((dojo.isBrowser)&&(dojo.isString(src))){src=dojo.byId(src);}_13f.srcObj=src;mjps.push(agi.event.connect.call(agi.event,_13f));});return mjps;}var mjp=agi.event.MethodJoinPoint.getForMethod(ao.srcObj,ao.srcFunc);if(ao.adviceFunc){var mjp2=agi.event.MethodJoinPoint.getForMethod(ao.adviceObj,ao.adviceFunc);}mjp.kwAddAdvice(ao);return mjp;};agi.event.log=function(a1,a2){var _140;if((arguments.length==1)&&(typeof a1=="object")){_140=a1;}else{_140={srcObj:a1,srcFunc:a2};}_140.adviceFunc=function(){var _141=[];for(var x=0;x<arguments.length;x++){_141.push(arguments[x]);}};agi.event.kwConnect(_140);};agi.event.connectBefore=function(){var args=["before"];for(var i=0;i<arguments.length;i++){args.push(arguments[i]);}return agi.event.connect.apply(this,args);};agi.event.connectAround=function(){var args=["around"];for(var i=0;i<arguments.length;i++){args.push(arguments[i]);}return agi.event.connect.apply(this,args);};agi.event.connectOnce=function(){var ao=_13c(arguments,true);ao.once=true;return agi.event.connect(ao);};agi.event._kwConnectImpl=function(_142,_143){var fn=(_143)?"disconnect":"connect";if(typeof _142["srcFunc"]=="function"){_142.srcObj=_142["srcObj"]||dojo.global;var _144=agi.event.nameAnonFunc(_142.srcFunc,_142.srcObj,true);_142.srcFunc=_144;}if(typeof _142["adviceFunc"]=="function"){_142.adviceObj=_142["adviceObj"]||dojo.global;var _144=agi.event.nameAnonFunc(_142.adviceFunc,_142.adviceObj,true);_142.adviceFunc=_144;}_142.srcObj=_142["srcObj"]||dojo.global;_142.adviceObj=_142["adviceObj"]||_142["targetObj"]||dojo.global;_142.adviceFunc=_142["adviceFunc"]||_142["targetFunc"];return agi.event[fn](_142);};agi.event.kwConnect=function(_145){return agi.event._kwConnectImpl(_145,false);};agi.event.disconnect=function(){if(arguments.length==1){var ao=arguments[0];}else{var ao=_13c(arguments,true);}if(!ao.adviceFunc){return;}if(dojo.isString(ao.srcFunc)&&(ao.srcFunc.toLowerCase()=="onkey")){if(dojo.isIE){ao.srcFunc="onkeydown";agi.event.disconnect(ao);}ao.srcFunc="onkeypress";}if(!ao.srcObj[ao.srcFunc]){return null;}var mjp=agi.event.MethodJoinPoint.getForMethod(ao.srcObj,ao.srcFunc,true);mjp.removeAdvice(ao.adviceObj,ao.adviceFunc,ao.adviceType,ao.once);return mjp;};agi.event.kwDisconnect=function(_146){return agi.event._kwConnectImpl(_146,true);};agi.event.MethodInvocation=function(_147,obj,args){this.jp_=_147;this.object=obj;this.args=[];for(var x=0;x<args.length;x++){this.args[x]=args[x];}this.around_index=-1;};agi.event.MethodInvocation.prototype.proceed=function(){this.around_index++;if(this.around_index>=this.jp_.around.length){return this.jp_.object[this.jp_.methodname].apply(this.jp_.object,this.args);}else{var ti=this.jp_.around[this.around_index];var mobj=ti[0]||dojo.global;var meth=ti[1];return mobj[meth].call(mobj,this);}};agi.event.MethodJoinPoint=function(obj,_148){this.object=obj||dojo.global;this.methodname=_148;this.methodfunc=this.object[_148];this.squelch=false;};agi.event.MethodJoinPoint.getForMethod=function(obj,_149){if(!obj){obj=dojo.global;}if(!obj[_149]){obj[_149]=function(){};if(!obj[_149]){agi.util.raise("Cannot set do-nothing method on that object "+_149);}}else{if((!dojo.isFunction(obj[_149]))&&(!dojo.isAlien(obj[_149]))){return null;}}var _14a=_149+"$joinpoint";var _14b=_149+"$joinpoint$method";var _14c=obj[_14a];if(!_14c){var _14d=false;if(agi.event["browser"]){if((obj["attachEvent"])||(obj["nodeType"])||(obj["addEventListener"])){_14d=true;agi.event.browser.addClobberNodeAttrs(obj,[_14a,_14b,_149]);}}var _14e=obj[_149].length;obj[_14b]=obj[_149];_14c=obj[_14a]=new agi.event.MethodJoinPoint(obj,_14b);obj[_149]=function(){var args=[];if((_14d)&&(!arguments.length)){var evt=null;try{if(obj.ownerDocument){evt=obj.ownerDocument.parentWindow.event;}else{if(obj.documentElement){evt=obj.documentElement.ownerDocument.parentWindow.event;}else{if(obj.event){evt=obj.event;}else{evt=window.event;}}}}catch(e){evt=window.event;}if(evt){args.push(agi.event.browser.fixEvent(evt,this));}}else{for(var x=0;x<arguments.length;x++){if((x==0)&&(_14d)&&(agi.event.browser.isEvent(arguments[x]))){args.push(agi.event.browser.fixEvent(arguments[x],this));}else{args.push(arguments[x]);}}}return _14c.run.apply(_14c,args);};obj[_149].__preJoinArity=_14e;}return _14c;};dojo.extend(agi.event.MethodJoinPoint,{unintercept:function(){this.object[this.methodname]=this.methodfunc;this.before=[];this.after=[];this.around=[];},disconnect:agi.util.forward("unintercept"),run:function(){var obj=this.object||dojo.global;var args=arguments;var _14f=[];for(var x=0;x<args.length;x++){_14f[x]=args[x];}var _150=function(marr){if(!marr){return;}var _151=marr[0]||dojo.global;var _152=marr[1];if(!_151[_152]){agi.util.raise("function \""+_152+"\" does not exist on \""+_151+"\"");}var _153=marr[2]||dojo.global;var _154=marr[3];var msg=marr[6];var _155;var to={args:[],jp_:this,object:obj,proceed:function(){return _151[_152].apply(_151,to.args);}};to.args=_14f;var _156=parseInt(marr[4]);var _157=((!isNaN(_156))&&(marr[4]!==null)&&(typeof marr[4]!="undefined"));if(marr[5]){var rate=parseInt(marr[5]);var cur=new Date();var _158=false;if((marr["last"])&&((cur-marr.last)<=rate)){if(agi.event._canTimeout){if(marr["delayTimer"]){clearTimeout(marr.delayTimer);}var tod=parseInt(rate*2);var mcpy=agi.util.shallowCopy(marr);marr.delayTimer=setTimeout(function(){mcpy[5]=0;_150(mcpy);},tod);}return;}else{marr.last=cur;}}if(_154){_153[_154].call(_153,to);}else{if((_157)&&(dojo.isBrowser)){dojo.global["setTimeout"](function(){if(msg){_151[_152].call(_151,to);}else{_151[_152].apply(_151,args);}},_156);}else{if(msg){_151[_152].call(_151,to);}else{_151[_152].apply(_151,args);}}}};var _159=function(){if(this.squelch){try{return _150.apply(this,arguments);}catch(e){}}else{return _150.apply(this,arguments);}};if((this["before"])&&(this.before.length>0)){dojo.forEach(this.before.concat(new Array()),_159);}var _15a;try{if((this["around"])&&(this.around.length>0)){var mi=new agi.event.MethodInvocation(this,obj,args);_15a=mi.proceed();}else{if(this.methodfunc){_15a=this.object[this.methodname].apply(this.object,args);}}}catch(e){if(!this.squelch){agi.util.raise(e);}}if((this["after"])&&(this.after.length>0)){dojo.forEach(this.after.concat(new Array()),_159);}return (this.methodfunc)?_15a:null;},getArr:function(kind){var type="after";if((typeof kind=="string")&&(kind.indexOf("before")!=-1)){type="before";}else{if(kind=="around"){type="around";}}if(!this[type]){this[type]=[];}return this[type];},kwAddAdvice:function(args){this.addAdvice(args["adviceObj"],args["adviceFunc"],args["aroundObj"],args["aroundFunc"],args["adviceType"],args["precedence"],args["once"],args["delay"],args["rate"],args["adviceMsg"]);},addAdvice:function(_15b,_15c,_15d,_15e,_15f,_160,once,_161,rate,_162){var arr=this.getArr(_15f);if(!arr){agi.util.raise("bad this: "+this);}var ao=[_15b,_15c,_15d,_15e,_161,rate,_162];if(once){if(this.hasAdvice(_15b,_15c,_15f,arr)>=0){return;}}if(_160=="first"){arr.unshift(ao);}else{arr.push(ao);}},hasAdvice:function(_163,_164,_165,arr){if(!arr){arr=this.getArr(_165);}var ind=-1;for(var x=0;x<arr.length;x++){var aao=(typeof _164=="object")?(new String(_164)).toString():_164;var a1o=(typeof arr[x][1]=="object")?(new String(arr[x][1])).toString():arr[x][1];if((arr[x][0]==_163)&&(a1o==aao)){ind=x;}}return ind;},removeAdvice:function(_166,_167,_168,once){var arr=this.getArr(_168);var ind=this.hasAdvice(_166,_167,_168,arr);if(ind==-1){return false;}while(ind!=-1){arr.splice(ind,1);if(once){break;}ind=this.hasAdvice(_166,_167,_168,arr);}return true;}});agi.event._ie_clobber=new function(){this.clobberNodes=[];function _169(node,prop){try{node[prop]=null;}catch(e){}try{delete node[prop];}catch(e){}try{node.removeAttribute(prop);}catch(e){}};this.clobber=function(_16a){var na;var tna;if(_16a){tna=_16a.all||_16a.getElementsByTagName("*");na=[_16a];for(var x=0;x<tna.length;x++){if(tna[x]["__doClobber__"]){na.push(tna[x]);}}}else{try{window.onload=null;}catch(e){}na=(this.clobberNodes.length)?this.clobberNodes:document.all;}tna=null;var _16b={};for(var i=na.length-1;i>=0;i=i-1){var el=na[i];try{if(el&&el["__clobberAttrs__"]){for(var j=0;j<el.__clobberAttrs__.length;j++){_169(el,el.__clobberAttrs__[j]);}_169(el,"__clobberAttrs__");_169(el,"__doClobber__");}}catch(e){}}na=null;};};if(dojo.isIE){dojo.addOnUnload(function(){agi.event._ie_clobber.clobber();try{if(dijit&&dijit.registry){dijit.registry.forEach(function(_16c){_16c.destroy();});}}catch(e){}if(dijit){for(var name in dijit._Templated._templateCache){var n=dijit._Templated._templateCache[name].node;if(n){n.parentNode.removeChild(n);dijit._Templated._templateCache[name].node=null;delete dijit._Templated._templateCache[name].node;}}}try{window.onload=null;}catch(e){}try{window.onunload=null;}catch(e){}agi.event._ie_clobber.clobberNodes=[];});}agi.event.browser=new function(){var _16d=0;this.normalizedEventName=function(_16e){switch(_16e){case "CheckboxStateChange":case "DOMAttrModified":case "DOMMenuItemActive":case "DOMMenuItemInactive":case "DOMMouseScroll":case "DOMNodeInserted":case "DOMNodeRemoved":case "RadioStateChange":return _16e;break;default:return _16e.toLowerCase();break;}};this.clean=function(node){if(dojo.isIE){agi.event._ie_clobber.clobber(node);}};this.addClobberNode=function(node){if(!dojo.isIE){return;}if(!node["__doClobber__"]){node.__doClobber__=true;agi.event._ie_clobber.clobberNodes.push(node);node.__clobberAttrs__=[];}};this.addClobberNodeAttrs=function(node,_16f){if(!dojo.isIE){return;}this.addClobberNode(node);for(var x=0;x<_16f.length;x++){node.__clobberAttrs__.push(_16f[x]);}};this.removeListener=function(node,_170,fp,_171){if(!_171){var _171=false;}_170=agi.event.browser.normalizedEventName(_170);if((_170=="onkey")||(_170=="key")){if(dojo.isIE){this.removeListener(node,"onkeydown",fp,_171);}_170="onkeypress";}if(_170.substr(0,2)=="on"){_170=_170.substr(2);}if(node.removeEventListener){node.removeEventListener(_170,fp,_171);}};this.addListener=function(node,_172,fp,_173,_174){if(!node){return;}if(!_173){var _173=false;}_172=agi.event.browser.normalizedEventName(_172);if((_172=="onkey")||(_172=="key")){if(dojo.isIE){this.addListener(node,"onkeydown",fp,_173,_174);}_172="onkeypress";}if(_172.substr(0,2)!="on"){_172="on"+_172;}if(!_174){var _175=function(evt){if(!evt){evt=window.event;}var ret=fp(agi.event.browser.fixEvent(evt,this));if(_173){agi.event.browser.stopEvent(evt);}return ret;};}else{_175=fp;}if(node.addEventListener){node.addEventListener(_172.substr(2),_175,_173);return _175;}else{if(typeof node[_172]=="function"){var _176=node[_172];node[_172]=function(e){_176(e);return _175(e);};}else{node[_172]=_175;}if(dojo.isIE){this.addClobberNodeAttrs(node,[_172]);}return _175;}};this.isEvent=function(obj){return (typeof obj!="undefined")&&(obj)&&(typeof Event!="undefined")&&(obj.eventPhase);};this.currentEvent=null;this.callListener=function(_177,_178){if(typeof _177!="function"){agi.util.raise("listener not a function: "+_177);}agi.event.browser.currentEvent.currentTarget=_178;return _177.call(_178,agi.event.browser.currentEvent);};this._stopPropagation=function(){agi.event.browser.currentEvent.cancelBubble=true;};this._preventDefault=function(){agi.event.browser.currentEvent.returnValue=false;};this.keys={KEY_BACKSPACE:8,KEY_TAB:9,KEY_CLEAR:12,KEY_ENTER:13,KEY_SHIFT:16,KEY_CTRL:17,KEY_ALT:18,KEY_PAUSE:19,KEY_CAPS_LOCK:20,KEY_ESCAPE:27,KEY_SPACE:32,KEY_PAGE_UP:33,KEY_PAGE_DOWN:34,KEY_END:35,KEY_HOME:36,KEY_LEFT_ARROW:37,KEY_UP_ARROW:38,KEY_RIGHT_ARROW:39,KEY_DOWN_ARROW:40,KEY_INSERT:45,KEY_DELETE:46,KEY_HELP:47,KEY_LEFT_WINDOW:91,KEY_RIGHT_WINDOW:92,KEY_SELECT:93,KEY_NUMPAD_0:96,KEY_NUMPAD_1:97,KEY_NUMPAD_2:98,KEY_NUMPAD_3:99,KEY_NUMPAD_4:100,KEY_NUMPAD_5:101,KEY_NUMPAD_6:102,KEY_NUMPAD_7:103,KEY_NUMPAD_8:104,KEY_NUMPAD_9:105,KEY_NUMPAD_MULTIPLY:106,KEY_NUMPAD_PLUS:107,KEY_NUMPAD_ENTER:108,KEY_NUMPAD_MINUS:109,KEY_NUMPAD_PERIOD:110,KEY_NUMPAD_DIVIDE:111,KEY_F1:112,KEY_F2:113,KEY_F3:114,KEY_F4:115,KEY_F5:116,KEY_F6:117,KEY_F7:118,KEY_F8:119,KEY_F9:120,KEY_F10:121,KEY_F11:122,KEY_F12:123,KEY_F13:124,KEY_F14:125,KEY_F15:126,KEY_NUM_LOCK:144,KEY_SCROLL_LOCK:145};this.revKeys=[];for(var key in this.keys){this.revKeys[this.keys[key]]=key;}this.fixEvent=function(evt,_179){if(!evt){if(window["event"]){evt=window.event;}}if((evt["type"])&&(evt["type"].indexOf("key")==0)){evt.keys=this.revKeys;for(var key in this.keys){evt[key]=this.keys[key];}if(evt["type"]=="keydown"&&dojo.render.html.ie){switch(evt.keyCode){case evt.KEY_SHIFT:case evt.KEY_CTRL:case evt.KEY_ALT:case evt.KEY_CAPS_LOCK:case evt.KEY_LEFT_WINDOW:case evt.KEY_RIGHT_WINDOW:case evt.KEY_SELECT:case evt.KEY_NUM_LOCK:case evt.KEY_SCROLL_LOCK:case evt.KEY_NUMPAD_0:case evt.KEY_NUMPAD_1:case evt.KEY_NUMPAD_2:case evt.KEY_NUMPAD_3:case evt.KEY_NUMPAD_4:case evt.KEY_NUMPAD_5:case evt.KEY_NUMPAD_6:case evt.KEY_NUMPAD_7:case evt.KEY_NUMPAD_8:case evt.KEY_NUMPAD_9:case evt.KEY_NUMPAD_PERIOD:break;case evt.KEY_NUMPAD_MULTIPLY:case evt.KEY_NUMPAD_PLUS:case evt.KEY_NUMPAD_ENTER:case evt.KEY_NUMPAD_MINUS:case evt.KEY_NUMPAD_DIVIDE:break;case evt.KEY_PAUSE:case evt.KEY_TAB:case evt.KEY_BACKSPACE:case evt.KEY_ENTER:case evt.KEY_ESCAPE:case evt.KEY_PAGE_UP:case evt.KEY_PAGE_DOWN:case evt.KEY_END:case evt.KEY_HOME:case evt.KEY_LEFT_ARROW:case evt.KEY_UP_ARROW:case evt.KEY_RIGHT_ARROW:case evt.KEY_DOWN_ARROW:case evt.KEY_INSERT:case evt.KEY_DELETE:case evt.KEY_F1:case evt.KEY_F2:case evt.KEY_F3:case evt.KEY_F4:case evt.KEY_F5:case evt.KEY_F6:case evt.KEY_F7:case evt.KEY_F8:case evt.KEY_F9:case evt.KEY_F10:case evt.KEY_F11:case evt.KEY_F12:case evt.KEY_F12:case evt.KEY_F13:case evt.KEY_F14:case evt.KEY_F15:case evt.KEY_CLEAR:case evt.KEY_HELP:evt.key=evt.keyCode;break;default:if(evt.ctrlKey||evt.altKey){var _17a=evt.keyCode;if(_17a>=65&&_17a<=90&&evt.shiftKey==false){_17a+=32;}if(_17a>=1&&_17a<=26&&evt.ctrlKey){_17a+=96;}evt.key=String.fromCharCode(_17a);}}}else{if(evt["type"]=="keypress"){if(dojo.isOpera){if(evt.which==0){evt.key=evt.keyCode;}else{if(evt.which>0){switch(evt.which){case evt.KEY_SHIFT:case evt.KEY_CTRL:case evt.KEY_ALT:case evt.KEY_CAPS_LOCK:case evt.KEY_NUM_LOCK:case evt.KEY_SCROLL_LOCK:break;case evt.KEY_PAUSE:case evt.KEY_TAB:case evt.KEY_BACKSPACE:case evt.KEY_ENTER:case evt.KEY_ESCAPE:evt.key=evt.which;break;default:var _17a=evt.which;if((evt.ctrlKey||evt.altKey||evt.metaKey)&&(evt.which>=65&&evt.which<=90&&evt.shiftKey==false)){_17a+=32;}evt.key=String.fromCharCode(_17a);}}}}else{if(dojo.isIE){if(!evt.ctrlKey&&!evt.altKey&&evt.keyCode>=evt.KEY_SPACE){evt.key=String.fromCharCode(evt.keyCode);}}else{if(dojo.isSafari){switch(evt.keyCode){case 25:evt.key=evt.KEY_TAB;evt.shift=true;break;case 63232:evt.key=evt.KEY_UP_ARROW;break;case 63233:evt.key=evt.KEY_DOWN_ARROW;break;case 63234:evt.key=evt.KEY_LEFT_ARROW;break;case 63235:evt.key=evt.KEY_RIGHT_ARROW;break;case 63236:evt.key=evt.KEY_F1;break;case 63237:evt.key=evt.KEY_F2;break;case 63238:evt.key=evt.KEY_F3;break;case 63239:evt.key=evt.KEY_F4;break;case 63240:evt.key=evt.KEY_F5;break;case 63241:evt.key=evt.KEY_F6;break;case 63242:evt.key=evt.KEY_F7;break;case 63243:evt.key=evt.KEY_F8;break;case 63244:evt.key=evt.KEY_F9;break;case 63245:evt.key=evt.KEY_F10;break;case 63246:evt.key=evt.KEY_F11;break;case 63247:evt.key=evt.KEY_F12;break;case 63250:evt.key=evt.KEY_PAUSE;break;case 63272:evt.key=evt.KEY_DELETE;break;case 63273:evt.key=evt.KEY_HOME;break;case 63275:evt.key=evt.KEY_END;break;case 63276:evt.key=evt.KEY_PAGE_UP;break;case 63277:evt.key=evt.KEY_PAGE_DOWN;break;case 63302:evt.key=evt.KEY_INSERT;break;case 63248:case 63249:case 63289:break;default:evt.key=evt.charCode>=evt.KEY_SPACE?String.fromCharCode(evt.charCode):evt.keyCode;}}else{evt.key=evt.charCode>0?String.fromCharCode(evt.charCode):evt.keyCode;}}}}}}if(dojo.isIE){if(!evt.target){evt.target=evt.srcElement;}if(!evt.currentTarget){evt.currentTarget=(_179?_179:evt.srcElement);}if(!evt.layerX){evt.layerX=evt.offsetX;}if(!evt.layerY){evt.layerY=evt.offsetY;}var doc=(evt.srcElement&&evt.srcElement.ownerDocument)?evt.srcElement.ownerDocument:document;var _17b=((dojo.isIE==5)||(doc["compatMode"]=="BackCompat"))?doc.body:doc.documentElement;if(!evt.pageX){evt.pageX=evt.clientX+(_17b.scrollLeft||0);}if(!evt.pageY){evt.pageY=evt.clientY+(_17b.scrollTop||0);}if(evt.type=="mouseover"){evt.relatedTarget=evt.fromElement;}if(evt.type=="mouseout"){evt.relatedTarget=evt.toElement;}this.currentEvent=evt;evt.callListener=this.callListener;evt.stopPropagation=this._stopPropagation;evt.preventDefault=this._preventDefault;}return evt;};this.stopEvent=function(evt){if(window.event){evt.cancelBubble=true;evt.returnValue=false;}else{evt.preventDefault();evt.stopPropagation();}};};})();}if(!dojo._hasResource["ag.event"]){dojo._hasResource["ag.event"]=true;dojo.provide("ag.event");ag.event=agi.event;}if(!dojo._hasResource["ag.wombat.storage"]){dojo._hasResource["ag.wombat.storage"]=true;dojo.provide("ag.wombat.storage");ag.wombat.storage.toString=function(){return "AGWombatStorage";};ag.wombat.storage.preloaded=false;ag.wombat.storage.pl_contacts={};ag.wombat.storage.groups_loaded=false;ag.wombat.storage.pl_groups={};ag.wombat.storage.add_html="";ag.wombat.storage._getCurrentTimeStamp=function(){return new Date().getTime();};ag.wombat.storage.init=function(_17c){if(_17c){ag.wombat.storage.Data.force_reload=true;}if(ag.wombat.storage.Data._initialized){if(_17c){ag.wombat.storage.Data.data=new ag.wombat.storage.DataItem(Data.wid);ag.wombat.storage.preloaded=ag.wombat.storage.Data.data.loaded;ag.wombat.storage.pl_contacts=ag.wombat.storage.Data.data.contacts;ag.wombat.storage.Data._initialized=true;ag.wombat.storage.Data.force_reload=false;}ag.wombat.storage.Data.load();}else{ag.event.connectOnce(ag.wombat.storage.Data,"initialize",ag.wombat.storage.Data,"load");}};ag.wombat.storage.DataItem=function(wid){this.wid=wid;this.contacts={};this.loaded=false;this.groups={};this.groups_loaded=false;this.last_updated=ag.wombat.storage._getCurrentTimeStamp();this.toString=function(){return "[AGWombatDataItem]";};};var cache_wid=ag.cookie.AGCookie.getCookieValue("customer","wid");var contacts_loading=false;ag.wombat.storage.Data={wid:(cache_wid>0)?cache_wid:"demo",key:"womcache_"+((cache_wid>0)?cache_wid:"demo"),data:new ag.wombat.storage.DataItem((cache_wid>0)?cache_wid:"demo"),_initialized:false,force_reload:false,toString:function(){return "AGWombatStorageData";},initialize:function(){this.data=dojox.storage.get(this.key);if(!this.data){this.data=new ag.wombat.storage.DataItem(this.wid);}else{if(ag.wombat.storage._getCurrentTimeStamp()>this.data.last_updated+86400000){this.data=new ag.wombat.storage.DataItem(this.wid);}else{if(this.force_reload){this.data=new ag.wombat.storage.DataItem(this.wid);}}}ag.wombat.storage.preloaded=this.data.loaded;ag.wombat.storage.pl_contacts=this.data.contacts;try{ag.wombat.storage.groups_loaded=this.data.groups_loaded;if(!ag.wombat.storage.groups_loaded){ag.wombat.storage.pl_groups={};}else{ag.wombat.storage.pl_groups=this.data.groups;}}catch(e1){ag.wombat.storage.groups_loaded=false;ag.wombat.storage.pl_groups={};}if(ag.wombat.storage.preloaded){try{if(contact_update){ag.wombat.storage.append_addresses(contact_update);}}catch(e2){}try{if(contact_delete){ag.wombat.storage.remove_addresses(contact_delete);}}catch(e3){}}this._initialized=true;this.force_reload=false;},load:function(){if(contacts_loading){return;}var wdl=new ag.wombat.storage.DataLoader();wdl.load_address_data();contacts_loading=true;},store_contacts:function(_17d){this.data.contacts=_17d;this.data.loaded=true;this.last_updated=ag.wombat.storage._getCurrentTimeStamp();try{dojox.storage.put(this.key,this.data,function(_17e,key,_17f){});}catch(exp){}},store_groups:function(_180){this.data.groups=_180;this.data.groups_loaded=true;this.last_updated=ag.wombat.storage._getCurrentTimeStamp();try{dojox.storage.put(this.key,this.data,function(_181,key,_182){});}catch(exp){}}};dojo.addOnLoad(function(){if(!dojox.storage.manager.isInitialized()){dojo.connect(dojox.storage.manager,"loaded",ag.wombat.storage.Data,"initialize");}else{dojo.connect(dojo,"loaded",ag.wombat.storage.Data,"initialize");}});ag.wombat.storage.contact_idx=0;ag.wombat.storage.DataLoader=function(_183){var _184=this;this.swindow=100;this.offset=0;this.group_offset=0;this.toString=function(){return "[AGWombatDataLoader]";};this.on_complete=_183;this.load_data=function(){this.load_add_page();};this.load_address_data=function(type){if(typeof type=="undefined"){type="b";}if(!ag.wombat.storage.preloaded&&(type=="c"||type=="b")){var _185=_184.swindow+1;var _186=new ag.requester.Requester(ahost+"/reminders/contactsearch.pd","POST",true,false);var _187={q:"",o:_184.offset,w:_185};_186.sendRequest(_187);_186.onsuccess=_184.load_addresses;_184.offset=_184.offset+_184.swindow;}if(!ag.wombat.storage.groups_loaded&&(type=="g"||type=="b")){var _185=_184.swindow+1;var _188=new ag.requester.Requester(ahost+"/reminders/groupsearch.pd","POST",true,false);var _187={q:"",o:_184.group_offset,w:_185};_188.sendRequest(_187);_188.onsuccess=_184.load_groups;_184.group_offset=_184.group_offset+_184.swindow;}};this.load_addresses=function(data,_189){try{var _18a=dojo.fromJson(data);}catch(e){ag.wombat.storage.preloaded=false;ag.wombat.storage.pl_contacts={};return;}for(i=0;i<_18a.length&&i<_184.swindow;i++){ag.wombat.storage.contact_idx++;ag.wombat.storage.pl_contacts[ag.wombat.storage.contact_idx]=_18a[i];}if(_18a.length>_184.swindow){_184.load_address_data("c");}else{ag.wombat.storage.preloaded=true;try{ag.wombat.storage.Data.store_contacts(ag.wombat.storage.pl_contacts);}catch(e){}}};this.load_groups=function(data,_18b){try{var _18c=dojo.fromJson(data);}catch(e){ag.wombat.storage.groups_loaded=false;ag.wombat.storage.pl_groups={};return;}for(i=0;i<_18c.length&&i<_184.swindow;i++){var _18d=_18c[i].id;ag.wombat.storage.pl_groups[_18d]=_18c[i];}if(_18c.length>_184.swindow){_184.load_address_data("g");}else{ag.wombat.storage.groups_loaded=true;try{ag.wombat.storage.Data.store_groups(ag.wombat.storage.pl_groups);}catch(e){}}};this.load_add_page=function(){var _18e=new ag.requester.Requester(ahost+"/reminders/event_add.pd","GET",true,false);_18e.onsuccess=function(data,_18f){ag.wombat.storage.add_html=data;try{_184.on_complete();}catch(e){}};_18e.sendRequest();};};ag.wombat.storage.remove_addresses=function(_190){for(i in ag.wombat.storage.pl_contacts){if(ag.wombat.storage.pl_contacts[i].id==_190){delete ag.wombat.storage.pl_contacts[i];}}try{ag.wombat.storage.Data.store_contacts(ag.wombat.storage.pl_contacts);}catch(e){}};ag.wombat.storage.append_addresses=function(_191){var len=ag.wombat.storage.count_contacts();for(i=0;i<_191.length;i++){ag.wombat.storage.pl_contacts[++len]=_191[i];}try{ag.wombat.storage.Data.store_contacts(ag.wombat.storage.pl_contacts);}catch(e){}};ag.wombat.storage.get_contact=function(_192){for(i in ag.wombat.storage.pl_contacts){if(ag.wombat.storage.pl_contacts[i].id==_192){return ag.wombat.storage.pl_contacts[i];}}return {};};ag.wombat.storage.count_contacts=function(){var i=0;for(i in ag.wombat.storage.pl_contacts){i++;}return i;};ag.wombat.storage.compare_contacts=function(a,b){if(!a.label){var _193=a.last_name+a.first_name+a.email;}else{var _193=a.label;}if(!b.label){var _194=b.last_name+b.first_name+b.email;}else{var _194=b.label;}if(_193>_194){return 1;}else{return -1;}};ag.wombat.storage.get_group_emails=function(_195){var _196=[];for(var i=0;i<_195.contacts.length;i++){var _197=_195.contacts[i];var _198=ag.wombat.storage.get_contact(_197).email;if(typeof _198!="undefined"&&_198.length>0){_196.push(_198);}}return _196.join(", ");};}if(!dojo._hasResource["ag.wombat.blobs"]){dojo._hasResource["ag.wombat.blobs"]=true;dojo.provide("ag.wombat.blobs");ag.wombat.blobs.relate_options=[];ag.wombat.blobs.event_options=[];ag.wombat.blobs.times=[];ag.wombat.blobs.times_no_hours=[];ag.wombat.blobs.types=[];ag.wombat.blobs.reminders;}if(!dojo._hasResource["ag.wombat.utils"]){dojo._hasResource["ag.wombat.utils"]=true;dojo.provide("ag.wombat.utils");ag.wombat.utils.determine_site=function(){var bma="bluemountain.";var ag="americangreetings.";var _199="beta.";var url=window.location.toString().toLowerCase();if(url.indexOf(_199)>-1){return "agbeta";}if(url.indexOf(bma)>-1){return "bma";}if(url.indexOf(ag)>-1){return "ag";}return "ag";};ag.wombat.utils.is_beta=function(){var _19a=dojo.byId("fcookie");if(_19a!=null){return true;}else{return false;}};ag.wombat.utils.change_nav_text=function(demo){if(demo==undefined){demo=true;}var _19b=demo?"womprefd":"wompref";var _19c="View Events";var _19d=ag.wombat.utils.get_double_nvp_value(_19b,"wview");if(!_19d){_19d="Calendar";}var _19e=dojo.byId("agi-view-events");try{_19d=_19d.charAt(0).toUpperCase()+_19d.substr(1).toLowerCase();}catch(e){_19d=_19c;}try{_19e.innerHTML="";_19e.appendChild(document.createTextNode("View "+_19d));}catch(e){}};ag.wombat.utils.check_for_message=function(_19f,_1a0,_1a1,_1a2){if(!_1a0){return;}if(_1a0=="demo"){ag.wombat.utils.write_demo_message(_19f,_1a2);return;}ag.validation.write_message(_19f,_1a0,_1a1);};ag.wombat.utils.write_demo_message=function(_1a3,_1a4){if(ag.wombat.utils.is_beta()){return ag.wombat.utils.write_notdemo_message(_1a3,_1a4);}var _1a5="";if(ag.wombat.utils.is_beta()){var _1a6=ahost+"/auth/signin.pd";var _1a7=ahost+"/register/register.pd?app=reminders";}else{var _1a6=ahost+"/members/signin.pd";var _1a7=ahost+"/members/register.pd?app=reminders";}var _1a8=ahost+"/reminders/index.pd";if(!_1a4){_1a4="_default";}var _1a9={};_1a9.add="add events to your calendar";_1a9.edit="edit event details on your calendar";_1a9.holiday="add holidays to your calendar";_1a9.option="change your preferences";_1a9.request="request birthdays and other events";_1a9.share="share events with others";_1a9._default="use Reminders";_1a5+="<p><strong>You must be signed in to "+_1a9[_1a4]+".</strong></p>";_1a5+="<p><a href=\""+_1a6+"\">Sign in</a> or ";_1a5+="<a href=\""+_1a7+"\">Register</a> to get started now!</p>";_1a5+="<p><a href=\""+_1a8+"\">Continue tour</a> of example calendar.</p>";ag.validation.write_message(_1a3,_1a5,"agi-message-area agi-message-demo");};ag.wombat.utils.write_demo_saved_message=function(_1aa,_1ab){if(ag.wombat.utils.is_beta()){return ag.wombat.utils.write_notdemo_saved_message(_1aa,_1ab);}var _1ac="";if(ag.wombat.utils.is_beta()){var _1ad=ahost+"/auth/signin.pd";var _1ae=ahost+"/register/register.pd?app=reminders";}else{var _1ad=ahost+"/members/signin.pd";var _1ae=ahost+"/members/register.pd?app=reminders";}if(_1ab){var _1af="javascript:ag.wombat.event.wevent.reset_form();";}else{var _1af="javascript:dojo.publish('ag/Lightbox/hide');";}_1ac+="<p><strong>You must be signed in to view the event you just added.</strong></p>";_1ac+="<p><a href=\""+_1ad+"\">Sign in</a> or ";_1ac+="<a href=\""+_1ae+"\">Register</a> to view your event now!</p>";_1ac+="<p><a href=\""+_1af+"\">Continue tour</a> of example calendar.</p>";ag.validation.write_message(_1aa,_1ac,"agi-message-area agi-message-demo");};ag.wombat.utils.write_notdemo_message=function(_1b0,_1b1){var _1b2="";var _1b3=ahost+"/auth/signin.pd";var _1b4=ahost+"/register/register.pd?app=reminders";var _1b5=ahost+"/reminders/index.pd";if(!_1b1){_1b1="_default";}var _1b6={};_1b6.add="To save this event and receive FREE reminders by email or cell phone, ";_1b6.edit="To edit event details and receive FREE reminders by email or cell phone, ";_1b6.holiday="To add holidays to your calendar and receive FREE reminders by email or cell phone, ";_1b6.option="To save your preferences, ";_1b6.request="To request events, ";_1b6.share="To share events, ";_1b6._default="To start receiving your FREE reminders, ";var _1b7={};_1b7.add="";_1b7.edit="";_1b7.holiday="";_1b7.option="";_1b7.request="";_1b7.share="";_1b7._default="";_1b2+="<p class=\"agi-siteerror\">";_1b2+=_1b6[_1b1];_1b2+="<span class=\"agi-reminders-black\"><a href=\""+_1b4+"\">register now</a>. Already registered? <a href=\""+_1b3+"\">Sign in</a>.</span>";_1b2+=_1b7[_1b1];_1b2+="</p>";ag.validation.write_message(_1b0,_1b2,"agi-message-area agi-message-demo");};ag.wombat.utils.write_notdemo_saved_message=function(_1b8,_1b9){var _1ba="";var _1bb=ahost+"/auth/signin.pd";var _1bc=ahost+"/register/register.pd?app=reminders";if(_1b9){var _1bd="<a href='javascript:ag.wombat.event.wevent.reset_form();'>continue</a>";}else{var _1bd="<a href='javascript:dojo.publish('ag/Lightbox/hide');'>close window</a>";}_1ba+="<p class=\"agi-siteerror\">To save this event and receive FREE reminders by email or cell phone, <span class=\"agi-reminders-black\"><a href=\""+_1bc+"\">register</a> now. Already registered? <a href=\""+_1bb+"\">Sign in</a>.</span></p>";_1ba+="<p class=\"agi-siteerror\" style=\"margin: 1em 0px 0px 0px; text-align: right; font-size: 11px; font-weight: normal;\">"+_1bd+"</p>";ag.validation.write_message(_1b8,_1ba,"agi-message-area agi-message-demo");};ag.wombat.utils.expire_cookie=function(_1be){ag.cookie.AGCookie.expireCookie(_1be);ag.cookie.MagicCookie.delCookieValue(_1be,true);ag.cookie.MagicCookie.delCookieValue(_1be,false);};ag.wombat.utils.set_double_nvp_value=function(_1bf,key,_1c0,_1c1,_1c2){if(_1c1==undefined){_1c1=true;}if(_1c2==undefined){_1c2=false;}var _1c3;var _1c4=ag.cookie.MagicCookie.getCookieValue(_1bf);if(!_1c4){_1c3=key+"="+escape(_1c0);}else{if(_1c1){_1c4=ag.base64.decode(unescape(_1c4));}var _1c5=ag.wombat.utils.get_nvp_value(_1c4,key);if(_1c5){_1c3=_1c4.replace(key+"="+_1c5,key+"="+escape(_1c0));}else{_1c3=_1c4+"&"+key+"="+escape(_1c0);}}if(_1c1){_1c3=ag.base64.encode(_1c3);}ag.cookie.MagicCookie.setCookieValue(_1bf,_1c3,_1c2);};ag.wombat.utils.get_double_nvp_value=function(_1c6,key,_1c7){if(_1c7==undefined){_1c7=true;}var _1c8=ag.cookie.MagicCookie.getCookieValue(_1c6);if(!_1c8){return "";}if(_1c7){_1c8=ag.base64.decode(unescape(_1c8));}return ag.wombat.utils.get_nvp_value(_1c8,key);};ag.wombat.utils.get_nvp_value=function(_1c9,key){if(!_1c9||!key){return "";}return ag.cookie.NVP.getValue(_1c9,key,"=","&");};ag.wombat.utils.ThemeChanger=function(id,_1ca,demo){if(demo==undefined){demo=true;}var _1cb=true;var tc=this;this.list=dojo.byId(id);this.c_anchor="";this.which="";this.opening_theme="";this.queue_theme="";this.demo=demo;this.cookie=this.demo?"womprefd":"wompref";this.style_div=_1ca;this.req="";this.do_onload=function(){this.which=ag.wombat.utils.get_double_nvp_value(this.cookie,"wtheme");if(!this.which){this.which="dflt";}this.opening_theme=this.which;this.change_theme();if(!this.list){return;}this.set_theme_listeners();window.onunload=this.set_theme_pref;};this.set_theme_listeners=function(){var _1cc=this.list.getElementsByTagName("a");for(var i=0;i<_1cc.length;i++){try{_1cc[i].onclick=function(){tc.c_anchor=this;tc.change_theme();};var _1cd=function(){this.style.width="15px";this.style.height="15px";this.parentNode.style.width="15px";this.parentNode.style.height="15px";this.parentNode.style.position="relative";this.parentNode.style.top="0px";this.parentNode.style.left="0px";};_1cc[i].getElementsByTagName("IMG")[0].onmouseout=_1cd;_1cc[i].getElementsByTagName("IMG")[0].onclick=_1cd;_1cc[i].getElementsByTagName("IMG")[0].onmouseover=function(){this.style.width="25px";this.style.height="25px";this.parentNode.style.width="25px";this.parentNode.style.height="25px";this.parentNode.style.position="absolute";this.parentNode.style.top="-5px";this.parentNode.style.left="-5px";};}catch(e){}}};this.change_theme=function(){if(this.req){if(this.req.in_process){this.queue_theme=this.c_anchor;return;}}if(this.c_anchor){this.which=this.c_anchor.firstChild.src.split("/theme/")[1].split(".")[0];}var _1ce=ag.wombat.utils.get_double_nvp_value(this.cookie,"wtheme");if(this.c_anchor&&_1ce==this.which){return;}this.set_selected();this.change_stylesheet();this.change_print_image();};this.set_selected=function(){if(!this.list){return;}var _1cf=this.list.getElementsByTagName("span");for(var i=0;i<_1cf.length;i++){try{_1cf[i].removeAttribute("class");_1cf[i].removeAttribute("className");}catch(e){}}var elem=this.get_theme_span();try{if(elem.tagName.toLowerCase()=="span"){elem.setAttribute("class","agi-selectedt");elem.setAttribute("className","agi-selectedt");}}catch(e){}};this.get_theme_span=function(){var elem;if(this.c_anchor){elem=this.c_anchor.parentNode.parentNode;}else{var _1d0=this.list.getElementsByTagName("img");for(var i=0;i<_1d0.length;i++){if(_1d0[i].src.indexOf(this.which)!=-1){elem=_1d0[i].parentNode.parentNode.parentNode;break;}}}return elem;};this.change_stylesheet=function(){if(!this.which){this.which="dflt";}this.set_theme_cookie();this.load_genix();};this.load_stylesheet=function(){if(!this.which){this.which="dflt";}var ss=document.styleSheets;var _1d1=false;for(var i=0;i<ss.length;i++){if(ss[i].title&&ss[i].title==this.which){this.load_genix();ss[i].disabled=false;ss[i].rel="stylesheet";_1d1=true;}else{if(ss[i].title){ss[i].disabled=true;ss[i].rel="alternate stylesheet";}}}return _1d1;};this.load_genix=function(){var _1d2=ahost+"/reminders/getgenix.pd?var=UIBremtheme"+this.which;var _1d3="GET";var _1d4=true;var _1d5=false;var req=new ag.requester.Requester(_1d2,_1d3,_1d4,_1d5,"json");req.onsuccess=this.load_genix_success;req.onerror=this.load_genix_error;req.sendRequest();this.req=req;};this.load_genix_success=function(data,_1d6){var _1d7=data;ag.dom.insert_css_text(_1d7);};this.load_genix_error=function(data,_1d8){};this.set_theme_cookie=function(){ag.wombat.utils.set_double_nvp_value(this.cookie,"wtheme",this.which);if(this.queue_theme){this.c_anchor=this.queue_theme;this.queue_theme="";this.change_theme();}};this.set_theme_pref=function(){if(tc.which==tc.opening_theme){return;}var _1d9=ahost+"/reminders/setprefs.pd?p=THEME&v="+tc.which;var _1da="GET";var _1db=false;var _1dc=false;var req=new ag.requester.Requester(_1d9,_1da,_1db,_1dc);req.onsuccess=tc.set_pref_success;req.onerror=tc.set_pref_error;req.sendRequest();};this.set_pref_success=function(data,_1dd){};this.set_pref_error=function(data,_1de){};this.change_print_image=function(){try{var _1df=ag.wombat.utils.determine_site();var _1e0=dojo.byId("agi-printheader");var _1e1=_1e0.getElementsByTagName("img")[1];_1e1.src=imghost+"/"+_1df+"/reminders/theme/"+this.which+"/print_theme.jpg";}catch(e){}};this.do_onload();};ag.wombat.utils.is_leap_year=function(year){return (year%4===0&&((year%100!==0)||(year%400===0)));};ag.wombat.utils.days_in_month=function(year){var days=[];days[0]=31;days[1]=31;days[2]=ag.wombat.utils.is_leap_year(year)?29:28;days[3]=31;days[4]=30;days[5]=31;days[6]=30;days[7]=31;days[8]=31;days[9]=30;days[10]=31;days[11]=30;days[12]=31;return days;};ag.wombat.utils.fix_day=function(date){var days=ag.wombat.utils.days_in_month(date.year);var _1e2=days[date.month];date.day=Math.min(date.day,_1e2);return date;};ag.wombat.utils.make_option=function(_1e3,_1e4){if(!_1e4){_1e4=_1e3;}var _1e5=document.createElement("option");_1e5.setAttribute("value",_1e3);_1e5.appendChild(document.createTextNode(_1e4));return _1e5;};}if(!dojo._hasResource["ag.widget.autocomplete"]){dojo._hasResource["ag.widget.autocomplete"]=true;dojo.provide("ag.widget.autocomplete");ag.widget.autocomplete._complete={};if(!onupfunctions){var onupfunctions=[];}ag.widget.autocomplete.check_complete=function(e){e=(e)?e:((window.event)?window.event:null);if(e!=null){for(id in ag.widget.autocomplete._complete){ag.widget.autocomplete._complete[id].check_click_source(e,id);}}};ag.widget.autocomplete.unregister=function(id){if(ag.widget.autocomplete._complete[id]){delete ag.widget.autocomplete._complete[id];}};dojo.connect((dojo.isIE)?document:null,"onmouseup",ag.widget.autocomplete,"check_complete");ag.widget.autocomplete.AutoComplete=function(_1e6,_1e7){var auto=this;ag.widget.autocomplete._complete[_1e6.id]=this;this.request=new ag.requester.Requester(_1e7,"POST",true,false);this.debug=dojo.byId("debug");this.element=_1e6;this.suggestions=new Array();this.inputText=null;this.search_text=null;this.top=0;this.left=0;this.cursor=-1;this.open=false;this.max_suggestions=15;this.selectedIdx=-1;this.suggest_url=_1e7;this.class_name="agi-auto-complete";this.class_selected="agi-auto-complete-selected";this.min_len=0;this.popup=dojo.byId(_1e6.id+"-auto-complete-div");if(!this.popup){this.popup=ag.widget.autocomplete.createDiv(this.element.id);}this.iframe=dojo.byId(_1e6.id+"-auto-complete-iframe");if(!this.iframe){this.iframe=ag.widget.autocomplete.createIFrame(this.element.id);}var TAB=9;var _1e8=13;var ESC=27;var _1e9=38;var _1ea=40;var _1eb=37;var _1ec=39;var _1ed=16;this.element.setAttribute("autocomplete","off");this.is_open=function(){return ag.widget.autocomplete._complete[_1e6.id].open;};this.check_click_source=function(e,id){var _1ee=ag.widget.autocomplete._complete[_1e6.id];if(!_1ee.is_open()){if(_1ee.request.in_process){_1ee.request.onsuccess=null;}return;}else{var _1ef=new Array(id,id+"-auto-complete-div",id+"-auto-complete-ifram");var _1f0=ag.widget.autocomplete.get_event_source(e);if(dojo.indexOf(_1ef,_1f0.id)==-1){if((_1f0.id.indexOf(id+"-href-")!=0)&&(_1f0.id.indexOf(id+"-li-")!=0)&&(_1f0.id.indexOf(id+"-div-")!=0)){if(_1ee.request.in_process){_1ee.request.onsuccess=null;}_1ee.hidePopup();}}}};this.makeVisible=function(){var _1f1=this.popup.clientHeight+this.top-ag.dom.window.getScrollOffset().pageYOffset;var _1f2=this.top-this.element.offsetHeight-this.popup.clientHeight;var _1f3=ag.dom.window.getSize().height;if(_1f1>_1f3&&_1f2>0){this.popup.style.top=_1f2+"px";this.iframe.style.top=_1f2+"px";}};this.positionPopup=function(){var elem=this.element;this.left=0;this.top=elem.offsetHeight;while(elem.offsetParent&&elem.tagName.toUpperCase()!="BODY"){this.left+=elem.offsetLeft;this.top+=elem.offsetTop;elem=elem.offsetParent;}this.left+=elem.offsetLeft;this.top+=elem.offsetTop;this.popup.style.left=this.left+"px";this.popup.style.top=this.top+"px";};this.showPopup=function(){this.selectedIdx=-1;this.iframe.style.display="block";this.popup.style.display="block";this.popup.scrollTop=0;var _1f4=this.popup.clientWidth+"px";var ul=dojo.byId(_1e6.id+"-ul");var lis=dojo.query("div",ul);for(i=0;i<lis.length;i++){lis[i].style.width=_1f4;}if(lis.length>15){lineHeight=lis[0].scrollHeight;divHeight=lineHeight*15;this.popup.style.height=divHeight+"px";this.iframe.style.height=divHeight+"px";this.popup.style.overflow="auto";this.popup.style.overflowX="hidden";}else{this.popup.style.height="";this.iframe.style.height="";this.popup.style.overflow="";}this.popup.style.zIndex="1000";this.iframe.style.zIndex="499";this.iframe.style.background="#FFFFFF";this.iframe.style.width=this.popup.clientWidth+"px";this.iframe.style.height=this.popup.clientHeight+"px";this.iframe.style.left=this.popup.style.left;this.iframe.style.top=this.popup.style.top;this.open=true;this.makeVisible();};this.hidePopup=function(){this.selectedIdx=-1;this.iframe.style.display="none";this.popup.style.display="none";this.open=false;};this.bind_element=function(_1f5){this.element=_1f5;_1f5.onkeypress=function(e){var _1f6=auto.getKeyCode(e);switch(_1f6){case TAB:case _1e9:case _1ea:case _1eb:case _1ec:case _1e8:case ESC:return (auto.popup.style.display=="none");default:return true;}};_1f5.onkeyup=function(e){var _1f7=auto.getKeyCode(e);switch(_1f7){case TAB:case ESC:case _1e9:case _1ea:case _1eb:case _1ec:return (auto.popup.style.display=="none");case _1ed:return true;default:undefined;var _1f8="";var _1f8=auto.getSearchValue(auto.element);if(_1f8!=auto.inputText){auto.inputText=_1f8;if(_1f8.length>auto.min_len){auto.searchSuggestions();}else{auto.hidePopup();}}}};_1f5.onkeydown=function(e){var _1f9=auto.getKeyCode(e);switch(_1f9){case _1e8:auto.useSuggestion();break;case TAB:if(auto.selectedIdx>-1){auto.useSuggestion();}else{auto.hidePopup();if(auto.request.in_process){auto.request.onsuccess=null;}ag.widget.autocomplete.focus_next_element(auto.element);}break;case ESC:var _1fa=(auto.popup.style.display=="none");auto.hidePopup();return _1fa;break;case _1e9:if(auto.selectedIdx>0){auto.selectedIdx--;}auto.changeSelected(_1f9);return (auto.popup.style.display=="none");break;case _1ea:if(auto.selectedIdx<(auto.suggestions.length-1)){auto.selectedIdx++;}auto.changeSelected(_1f9);return (auto.popup.style.display=="none");break;}};};this.bind_element(this.element);this.getKeyCode=function(e){if(e){return e.keyCode;}if(window.event){return window.event.keyCode;}};this.createSuggestions=function(_1fb){var ul=document.createElement("ul");ul.setAttribute("id",_1e6.id+"-ul");ul.style.listStyleType="none";ul.style.margin="0px";ul.style.padding="0px";ul.style.cursor="pointer";for(i=0;i<this.suggestions.length;i++){var _1fc=this.getDisplaySuggestion(this.suggestions[i]);if(_1fb){fidx=_1fc.toLowerCase().indexOf(_1fb);_1fc=_1fc.substring(0,fidx)+"<b>"+_1fc.substring(fidx,fidx+_1fb.length)+"</b>"+_1fc.substring(fidx+_1fb.length);}_1fc=_1fc.replace(/ /g,"&nbsp;");var li=document.createElement("li");li.setAttribute("id",_1e6.id+"-li-"+i);var d=document.createElement("div");d.setAttribute("id",_1e6.id+"-div-"+i);d.setAttribute("style","cursor: pointer;");var a=document.createElement("a");a.href="javascript:void(null)";a.innerHTML=_1fc;a.setAttribute("class",this.class_name);a.setAttribute("className",this.class_name);a.setAttribute("id",_1e6.id+"-href-"+i);d.appendChild(a);li.appendChild(d);if(auto.selectedIdx==i){li.setAttribute("class",this.class_selected);li.setAttribute("className",this.class_selected);a.className=this.class_selected;}else{li.setAttribute("class",this.class_name);li.setAttribute("className",this.class_name);}ul.appendChild(li);}this.popup.replaceChild(ul,this.popup.childNodes[0]);ul.onmouseover=function(ev){var _1fd=auto.getEventSource(ev);while(_1fd.parentNode&&_1fd.tagName.toUpperCase()!="LI"){_1fd=_1fd.parentNode;}var lis=dojo.query("li",auto.popup);for(i=0;i<lis.length;i++){var li=lis[i];if(li==_1fd){auto.selectedIdx=i;break;}}auto.changeSelected();};ul.onclick=function(ev){auto.useSuggestion();auto.hidePopup();auto.cancelEvent(ev);return false;};this.popup.className=this.class_name;this.popup.style.position="absolute";};this.useSuggestion=function(){if(this.selectedIdx>-1){this.applySuggestion(this.suggestions[this.selectedIdx]);this.hidePopup();this.selectedIdx=-1;this.inputText="";this.search_text="";this.element.blur();setTimeout("ag.widget.autocomplete.focus_element('"+this.element.id+"')",10);if(this.cursor!=-1){setTimeout("ag.widget.autocomplete.set_cursor_position('"+this.element.id+"',"+this.cursor+","+this.cursor+")",15);}}};this.changeSelected=function(_1fe){if(!_1fe){_1fe="";}var lis=dojo.query("li",this.popup);if(lis.length>0){var _1ff=lis[0].scrollHeight;}if(!dojo.isIE){_1ff=_1ff+1;}var _200=this.popup.scrollTop+(this.popup.clientHeight*1);for(i=0;i<lis.length;i++){var li=lis[i];if(this.selectedIdx==i){var a=dojo.query("a",li)[0];li.className=this.class_selected;a.className=this.class_selected;if(lis.length>15&&(_1fe==_1ea||_1fe==_1e9)){var _201=_1ff*i;if(_201>_200){this.popup.scrollTop=this.popup.scrollTop+_1ff;}else{if(_201<this.popup.scrollTop){this.popup.scrollTop=_201;}}}}else{var a=dojo.query("a",li)[0];li.className=this.class_name;a.className=this.class_name;}}};this.getEventSource=function(ev){if(ev){return ev.target;}if(window.event){return window.event.srcElement;}};this.cancelEvent=function(ev){if(ev){ev.preventDefault();ev.stopPropagation();}if(window.event){window.event.returnValue=false;}};this.searchSuggestions=function(){auto.request.onsuccess=auto.onsuccess;if(!auto.request.in_process){auto.search_text=auto.getSearchValue(auto.element);auto.request.sendRequest("q="+encodeURIComponent(auto.getSearchValue(auto.element)));}};this.onsuccess=function(req){var _202=auto.getSearchValue(auto.element);if(_202!=auto.search_text&&_202.length>auto.min_len){auto.searchSuggestions();return;}try{eval("auto.suggestions = "+req.responseText);}catch(e){auto.hidePopup();return;}auto.suggestions.sort(ag.wombat.storage.compare_contacts);auto.createSuggestions(auto.search_text);auto.positionPopup();if(auto.suggestions.length>0){auto.showPopup();}else{auto.hidePopup();}};this.getDisplaySuggestion=function(_203){return _203;};this.applySuggestion=function(_204){this.element.value=_204;};this.getSearchValue=function(el){return this.element.value;};};ag.widget.autocomplete.createIFrame=function(_205){var _206=document.createElement("IFRAME");_206.setAttribute("src","javascript:void(null)");_206.setAttribute("scrolling","no");_206.setAttribute("frameBorder","0");_206.setAttribute("id",_205+"-auto-complete-iframe");_206.style.width="0px";_206.style.height="0px";_206.style.position="absolute";_206.style.display="none";document.body.appendChild(_206);return _206;};ag.widget.autocomplete.createDiv=function(_207){var div=document.createElement("DIV");div.setAttribute("id",_207+"-auto-complete-div");div.style.display="none";var list=document.createElement("UL");div.appendChild(list);document.body.appendChild(div);return div;};ag.widget.autocomplete.CustomEventComplete=function(elId,_208,_209){var _20a=this;var _20b=_208;var _20c=_209;if(ag.widget.autocomplete._complete[elId]){var _20d=ag.widget.autocomplete._complete[elId];_20d.bind_element(dojo.byId(elId));}else{var _20d=new ag.widget.autocomplete.AutoComplete(dojo.byId(elId),ahost+"/reminders/contactsearch.pd");}var _20e=_20d.searchSuggestions;_20d.searchSuggestions=function(){if(!ag.wombat.storage.preloaded){_20e();return;}_20d.suggestions=[];var _20f=(_20d.getSearchValue(_20d.element)+"").toLowerCase();for(i in ag.wombat.storage.pl_contacts){var _210=(ag.wombat.storage.pl_contacts[i].first_name+"").toLowerCase();var _211=(ag.wombat.storage.pl_contacts[i].last_name+"").toLowerCase();var _212=(ag.wombat.storage.pl_contacts[i].email+"").toLowerCase();if(_212.indexOf(_20f)==0||_210.indexOf(_20f)==0||_211.indexOf(_20f)==0){_20d.suggestions.push(ag.wombat.storage.pl_contacts[i]);}}_20d.suggestions.sort(ag.wombat.storage.compare_contacts);_20d.createSuggestions(_20f);_20d.positionPopup();if(_20d.suggestions.length>0){_20d.showPopup();}else{_20d.hidePopup();}};_20d.getDisplaySuggestion=function(_213){return _20a.assembleContact(_213).replace("<","&#60;").replace(">","&#62;");};this.assembleContact=function(_214){var _215=(_214.first_name==null)?"":_214.first_name;var _216=(_214.last_name==null)?"":_214.last_name;var _217=(_216.length>0&&_215.length>0)?" ":"";var name=(_216.length>0||_215.length>0)?"\""+_215+_217+_216+"\"":"";var _218=(_214.email==null||_214.email.length==0)?"":" <"+_214.email+">";return name+_218;};_20d.applySuggestion=function(_219){var re=/\&\#(\d*)\;/g;if(_20b){if(_219.first_name!=null&&_219.last_name!=""){_20b.value=_219.first_name.replace(re,ag.dom.get_unicode);}}if(_20c){if(_219.email!=null&&_219.email!=""){_20c.value=_219.email;}}};};ag.widget.autocomplete.WombatEventComplete=function(elId,_21a){var _21b=this;var _21a=_21a;if(ag.widget.autocomplete._complete[elId]){var _21c=ag.widget.autocomplete._complete[elId];_21c.bind_element(dojo.byId(elId));}else{var _21c=new ag.widget.autocomplete.AutoComplete(dojo.byId(elId),ahost+"/reminders/contactsearch.pd");}var _21d=_21c.searchSuggestions;_21c.searchSuggestions=function(){if(!ag.wombat.storage.preloaded){_21d();return;}_21c.suggestions=new Array();var _21e=(_21c.getSearchValue(_21c.element)+"").toLowerCase();for(i in ag.wombat.storage.pl_contacts){var _21f=(ag.wombat.storage.pl_contacts[i].first_name+"").toLowerCase();var _220=(ag.wombat.storage.pl_contacts[i].last_name+"").toLowerCase();var _221=(ag.wombat.storage.pl_contacts[i].email+"").toLowerCase();if(_221.indexOf(_21e)==0||_21f.indexOf(_21e)==0||_220.indexOf(_21e)==0){_21c.suggestions.push(ag.wombat.storage.pl_contacts[i]);}}_21c.suggestions.sort(ag.wombat.storage.compare_contacts);_21c.createSuggestions(_21e);_21c.positionPopup();if(_21c.suggestions.length>0){_21c.showPopup();}else{_21c.hidePopup();}};_21c.getDisplaySuggestion=function(_222){return _21b.assembleContact(_222).replace("<","&#60;").replace(">","&#62;");};this.assembleContact=function(_223){var _224=(_223.first_name==null)?"":_223.first_name;var _225=(_223.last_name==null)?"":_223.last_name;var _226=(_225.length>0&&_224.length>0)?" ":"";var name=(_225.length>0||_224.length>0)?"\""+_224+_226+_225+"\"":"";var _227=(_223.email==null||_223.email.length==0)?"":" <"+_223.email+">";return name+_227;};_21c.applySuggestion=function(_228){var re=/\&\#(\d*)\;/g;if(_21a.lname){if(_228.last_name!=null&&_228.last_name!=""){_21a.lname.value=_228.last_name.replace(re,ag.dom.get_unicode);}}if(_21a.fname){if(_228.first_name!=null&&_228.last_name!=""){_21a.fname.value=_228.first_name.replace(re,ag.dom.get_unicode);}}if(_21a.email){if(_228.email!=null&&_228.email!=""){_21a.email.value=_228.email;}}if(_21a.male&&_228.gender!=null&&_228.gender.toLowerCase()=="m"){_21a.male.checked=true;}else{if(_21a.female){_21a.female.checked=true;}}if(_21a.relationship_type&&_228.relate_type!=null){_21a.relationship_type.value=_228.relate_type;var _229=ag.wombat.blobs.relate_options[_228.relate_type];for(var j=_21a.relationship.options.length-1;j>-1;j--){_21a.relationship.remove(j);}_21a.relationship.appendChild(ag.wombat.utils.make_option("","Relationship"));for(var i=0;i<_229.length;i++){var _22a=ag.wombat.utils.make_option(_229[i].id,_229[i].description);if(_21a.relationship&&_228.relationship!=null&&_229[i].id==_228.relationship){_22a.setAttribute("selected",true);}_21a.relationship.appendChild(_22a);}}try{if(_228.first_name!=null&&_228.first_name!=""){_21a.fname_display.innerHTML=_21a.fname.value+"&nbsp;";}if(_228.last_name!=null&&_228.last_name!=""){_21a.lname_display.innerHTML=_21a.lname.value+"&nbsp;";}if(_228.email!=null&&_228.email!=""){_21a.email_display.innerHTML=_21a.email.value+"&nbsp;";}_21a.gender_display.innerHTML=(_21a.male.checked)?"Male":"Female";_21a.relationship_display.innerHTML=_21a.relationship.options[_21a.relationship.selectedIndex].text+"&nbsp;";}catch(e){}};};ag.widget.autocomplete.TextAreaComplete=function(elId){var _22b=this;if(ag.widget.autocomplete._complete[elId]){var _22c=ag.widget.autocomplete._complete[elId];_22c.bind_element(dojo.byId(elId));}else{var _22c=new ag.widget.autocomplete.AutoComplete(dojo.byId(elId),ahost+"/reminders/contactsearch.pd");}this.baseCompleter=_22c;var _22d=_22c.searchSuggestions;_22c.searchSuggestions=function(){if(!ag.wombat.storage.preloaded){_22d();return;}_22c.suggestions=[];var _22e=(_22c.getSearchValue(_22c.element)+"").toLowerCase();for(g in ag.wombat.storage.pl_groups){var _22f=(ag.wombat.storage.pl_groups[g].label+"").toLowerCase();if(_22f.indexOf(_22e)==0){_22c.suggestions.push(ag.wombat.storage.pl_groups[g]);}}for(i in ag.wombat.storage.pl_contacts){var _230=(ag.wombat.storage.pl_contacts[i].first_name+"").toLowerCase();var _231=(ag.wombat.storage.pl_contacts[i].last_name+"").toLowerCase();var _232=(ag.wombat.storage.pl_contacts[i].email+"").toLowerCase();var f=(_230.length>0)?_230+" ":"";var l=(_231.length>0)?_231+" ":"";var full=f+l;if(_232.toLowerCase()==_22e){_22c.suggestions=[];break;}if(((_232.indexOf(_22e)==0||_230.indexOf(_22e)==0||_231.indexOf(_22e)==0)||full.indexOf(_22e)==0)&&(_232.length>0)){_22c.suggestions.push(ag.wombat.storage.pl_contacts[i]);}}_22c.suggestions.sort(ag.wombat.storage.compare_contacts);_22c.createSuggestions(_22e);_22c.positionPopup();if(_22c.suggestions.length>0){_22c.showPopup();}else{_22c.hidePopup();}};_22c.getDisplaySuggestion=function(_233){return _22b.assembleContact(_233).replace("<","&#60;").replace(">","&#62;");};_22c.applySuggestion=function(_234){var _235="";if(!_234.label){_235=_234.email;}else{_235=ag.wombat.storage.get_group_emails(_234);}if(this.element.type=="textarea"){var _236=this.element.value;var _237=ag.widget.autocomplete.get_cursor_position(this.element);var _238=_237-_22c.getSearchValue(_22c.element).length;var _239=_236.substring(0,_238);var _23a=_236.substring(_237);var _23b=(_239.search(/\s+$/g)!=-1||_239.length==0);var _23c=(_23a.search(/^\s+/g)!=-1);var _23d=(_23b)?"":" ";var _23e=(_23c)?",":", ";var _23f=_23d+_235+_23e;this.element.value=_239+_23f+_23a;this.cursor=_238+_23f.length;}else{this.element.value=_235;}};_22c.getSearchValue=function(el){var _240=el.value;var _241=ag.widget.autocomplete.get_cursor_position(el);var idx=_240.lastIndexOf(",",_241);var _242=(idx==-1)?0:idx+1;idx=_240.indexOf(",",_241);var end=(idx==-1)?_240.length-1:idx-1;return _240.substring(_242,_241).replace(/^\s*|\s*$/g,"");};this.assembleContact=function(_243){if(!_243.label){var _244=(_243.first_name==null)?"":_243.first_name;var _245=(_243.last_name==null)?"":_243.last_name;var _246=(_245.length>0&&_244.length>0)?" ":"";var name=(_245.length>0||_244.length>0)?"\""+_244+_246+_245+"\"":"";var _247=(_243.email==null||_243.email.length==0)?"":" <"+_243.email+">";return name+_247;}else{return _243.label+" (group)";}};};ag.widget.autocomplete.get_cursor_position=function(area){try{area.focus();}catch(e){}if(document.selection&&area.type=="textarea"){var _248=document.selection.createRange();var _249=_248.duplicate();_249.moveToElementText(area);_249.setEndPoint("EndToEnd",_248);area.selectionStart=_249.text.length-_248.text.length;area.selectionEnd=area.selectionStart+_248.text.length;}return area.selectionEnd;};ag.widget.autocomplete.set_cursor_position=function(_24a,_24b,end){var area=dojo.byId(_24a);if(navigator.appName.indexOf("Microsoft")==-1){area.setSelectionRange(_24b,end);}else{var _24c=area.createTextRange();_24c.collapse(true);_24c.moveStart("character",_24b);_24c.moveEnd("character",end-_24b);_24c.select();}};ag.widget.autocomplete.focus_next_element=function(_24d){var idx=-1;for(var i=0;i<_24d.form.elements.length;i++){if(_24d.form.elements[i]==_24d&&i<(_24d.form.elements.length-1)){idx=i;}}if(idx!=-1){_24d.form.elements[idx].focus();}};ag.widget.autocomplete.focus_element=function(_24e){try{dojo.byId(_24e).focus();}catch(e){}};ag.widget.autocomplete.get_event_source=function(ev){if(ev){if(ev.target){return ev.target;}else{if(ev.srcElement){return ev.srcElement;}}}if(window.event){return window.event.srcElement;}};}dojo.publish("/ag.layers.ext/loaded/");dojo.i18n._preloadLocalizations("ag.layers.nls.ext",["ROOT","ar","ca","cs","da","de","de-de","el","en","en-gb","en-us","es","es-es","fi","fi-fi","fr","fr-fr","he","he-il","hu","it","it-it","ja","ja-jp","ko","ko-kr","nb","nl","nl-nl","pl","pt","pt-br","pt-pt","ru","sk","sl","sv","th","tr","xx","zh","zh-cn","zh-tw"]);
