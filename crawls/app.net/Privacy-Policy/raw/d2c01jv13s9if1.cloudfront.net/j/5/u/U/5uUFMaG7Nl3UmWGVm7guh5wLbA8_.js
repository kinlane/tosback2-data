var image_map,Sentry;function get_img_url(e){return image_map[e]?page_context.autochrome_img_url_base+image_map[e]:(console.log("get_img_url failed for",e),!1)}image_map={},window.console===void 0&&(window.console={log:function(){return!0}}),window.TAPP===void 0&&(window.TAPP={}),TAPP.jQuery=jQuery,$._ajax=$.ajax,$.ajax=function(e){var t=e.success;return e.success=function(e,n,i){var s=e&&e.result?e.result:null,a=e&&e.value?e.value:"ajax failed",o=e&&e.text?e.text:"ajax failed";return s&&"ok"!==s?(this.error&&this.error(i,a,o),void 0):(t&&t.apply(this,[e,n,i]),void 0)},$._ajax(e)},function(){var e="",t=($.browser.mozilla?e+=" mozilla":0,$.browser.msie?e+=" ie":0,$.browser.opera?e+=" opera":0,$.browser.chrome?e+=" chrome":0,$.browser.webkit?e+=" webkit":0,$.browser.version.replace(/\./g,"_"));e+=" v"+t,$("html").addClass(e)}(),window.refresh_page_context=function(){var e,t;e=document.getElementById("adn-page-context"),e&&(t=e.getAttribute("data-adn-page-context"),window.page_context=JSON.parse(t),e.parentNode.removeChild(e))},window.refresh_page_context(),function(e){e.authedAjax=function(t){var n,i,s,a,o,r,c,l;return n={no_login_required:!1,user_action:!0},t=e.extend({},n,t),i=t.event_tracking,s=t.success||e.noop,a=t.error||e.noop,o=t.complete||e.noop,t.user_action&&(page_context.user_actions_complete=!1),r=function(e,n,i){e&&(s(n),t.user_action&&(page_context.user_actions_complete=!0)),e||a(n,i),o(n,i)},(c=!page_context.is_authenticated&&!t.no_login_required)?(l=function(n){var s,a,o;s=n?i.name_for_success:i.name_for_failure,a=function(){n?e.authedAjax(t):r(!1,null,"authentication failed")},i?(o=_.map(e.makeArray(s),function(e){return[e,i.properties]}),e.waitForFuncs(o,TAPP.event_tracking.fire_off_event,a)):a()},TAPP.auth.start_login_process(l),void 0):(page_context&&(page_context.auth_use_xdm?TAPP.wakea.send_to_provider("ajax",[t],r):e.ajax(t)),void 0)}}(jQuery),function(){var e,t;e=$(window),t=function(){return 480>=e.width()},TAPP.is_narrow=t(),e.on("resize",function(){TAPP.is_narrow=t()})}(),function(){TAPP.in_iframe=!1;try{top.location.href!==window.location.href&&(TAPP.in_iframe=!0)}catch(e){TAPP.in_iframe=!0}}(),function(){var e,t,n;e=[],t=[],n=[],$.fn.tapp_on=function(t,n,i,s){return e.push([this,t,n]),this.on(t,n,i,s)},$.tapp_subscribe=function(e,n){var i=$.subscribe(e,n);return t.push(i),i},TAPP.setInterval=function(e,t){var i=setInterval(e,t);return n.push(i),i},TAPP.clearInterval=function(e){$.map(n,function(t){return e===t?null:t})},TAPP.clear_event_handles=function(){$.each(e,function(e,t){$(t[0]).off(t[1],t[2])})},TAPP.clear_subscribe_handles=function(){$.each(t,function(e,t){$.unsubscribe(t)})},TAPP.clear_intervals=function(){$.each(n,function(){clearInterval(this)})},TAPP.unload=function(){TAPP.clear_event_handles(),TAPP.clear_subscribe_handles(),TAPP.clear_intervals()},TAPP.lock_up=function(e,t){t=t||"click";var n=function(e){e.preventDefault(),e.stopImmediatePropagation()};return e.on(t,n),function(){setTimeout(function(){e.off(t,n)},0)}}}(),function(){$.waitForFuncs=function(e,t,n){var i=[];$.each(e,function(e,n){var s=$.Deferred();i.push(s),n.push(function(){s.resolve()}),t.apply(this,n)}),$.when.apply(this,i).done(n)}}(),page_context&&page_context.br_page_name&&(window.BOOMR.init({beacon_url:"/s/boomerang",BW:{enabled:!1}}),window.BOOMR.addVar("page_name",page_context.br_page_name)),function(){TAPP.initialize_widget_code=function(){("dev"===page_context.environment||"sandbox"===page_context.environment)&&(window.APP_NET_SETTINGS=page_context.widget_overrides);var e={post_load_scripts:window.TAPP_CDN_JS_ASSETS,wakea_remote_url:"https://app.net/wakea/widget/",widget_base_url:"https://app.net/w/el/",data_attr_prefix:"data-an-"};TAPP.settings||(TAPP.settings=TAPP.jQuery.extend({},e,window.APP_NET_SETTINGS)),$.each(page_context.widget_post_load_urls,function(){$("<script />").attr({type:"text/javascript",src:this}).appendTo("body")})}}(),void 0===Sentry&&(Sentry={}),function(){Sentry.client={};var e=Sentry.client;Sentry.client.loaded=!1,Sentry.client.options={site:page_context&&page_context.environment?page_context.environment:"prod"},Sentry.client.parseUrl=function(e){var t=e.split("?");return t[1],{url:t[0],querystring:t[1]}},Sentry.client.process=function(t){var n,i,s,a;if(t.project=e.options.projectId,t.logger=e.options.logger,t.site=e.options.site,n=["authenticated_user_id","build_info","canvas_mode"],i={},window.page_context)for(s in n)a=n[s],window.page_context[a]&&(i[a]=page_context[a]);t.extra=i,t.extra.user_agent=navigator.userAgent,t.extra.referrer=document.referrer?document.referrer:"n/a",console.log("window error",t),$.ajax({type:"POST",url:"/_jserror/",data:{message:JSON.stringify(t)}})},Sentry.client.parseTraceback=function(e){var t,n,i,s,a,o,r;for(t=[],n=e.split("\n"),s=1;i=n[s];s++)a=i.split(":"),o=a.slice(-2)[0],r=a.slice(0,-2).join(":").split(" at ")[1],t.push({lineno:o,filename:r,module:"unknown","function":"unknown"});return t},Sentry.client.captureException=function(t){var n,i,s,a,o,r,c,l;if(i=window.location.href,t.line?n=t.line:t.lineNumber&&(n=t.lineNumber),t.sourceURL?o=t.sourceURL:t.fileName&&(o=t.fileName),t.stack)try{s=e.parseTraceback(t.stack)}catch(d){}r=e.parseUrl(i),c=""+t,n&&(c=c+" at "+n),s?(a={frames:s},o=s[0].filename):o&&(a={frames:[{filename:o,lineno:n,module:"unknown","function":"unknown"}]}),l={message:c,culprit:o||void 0,"sentry.interfaces.Stacktrace":a||void 0,"sentry.interfaces.Exception":{type:t.name,value:t.message},"sentry.interfaces.Http":{url:r.url,querystring:r.querystring}},e.process(l)},Sentry.client.registerGlobalHandler=function(){Sentry.client.handled_global_error=!1,window.onerror=function(t,n,i,s){var a,o,r,c,l,d;return Sentry.client.handled_global_error?!0:(r=window.location.href,c=e.parseUrl(r),"object"==typeof t&&(o=t.name,t=t.message),-1!==t.toLowerCase().indexOf("script error")?!1:(Sentry.client.handled_global_error=!0,l=i?t+" at "+i:t,s?(a={frames:s},n=n||s[0].filename):n&&(a={frames:[{filename:n,lineno:i}]}),d={message:l,culprit:n,"sentry.interfaces.Stacktrace":a,"sentry.interfaces.Exception":{type:o,value:t},"sentry.interfaces.Http":{url:c.url,querystring:c.querystring}},e.process(d),void 0))}},Sentry.client.registerGlobalHandler()}(),function(e){function t(){if(e.fn.ajaxSubmit.debug){var t="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(t):window.opera&&window.opera.postError&&window.opera.postError(t)}}e.fn.ajaxSubmit=function(n){var i,s,a,o,r,c,l,d,u,h,p,f,m,g;function v(){var i,s,a,o,r,c,l,d,h,p,f,m,g,v,b,_,w;function y(){var t,n,c,l;t=u.attr("target"),n=u.attr("action"),i.setAttribute("target",a),"POST"!=i.getAttribute("method")&&i.setAttribute("method","POST"),i.getAttribute("action")!=s.url&&i.setAttribute("action",s.url),s.skipEncodingOverride||u.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),s.timeout&&(d=setTimeout(function(){h=!0,x(!0)},s.timeout)),c=[];try{if(s.extraData)for(l in s.extraData)c.push(e('<input type="hidden" name="'+l+'" value="'+s.extraData[l]+'" />').appendTo(i)[0]);o.appendTo("body"),r.attachEvent?r.attachEvent("onload",x):r.addEventListener("load",x,!1),i.submit()}finally{i.setAttribute("action",n),t?i.setAttribute("target",t):u.removeAttr("target"),e(c).remove()}}function x(n){var i,a,u,p,f,_,y;if(!c.aborted&&!g){if(n===!0&&c)return c.abort("timeout"),void 0;if(i=r.contentWindow?r.contentWindow.document:r.contentDocument?r.contentDocument:r.document,i&&i.location.href!=s.iframeSrc||h){r.detachEvent?r.detachEvent("onload",x):r.removeEventListener("load",x,!1),a=!0;try{if(h)throw"timeout";if(u="xml"==s.dataType||i.XMLDocument||e.isXMLDoc(i),t("isXml="+u),!u&&window.opera&&(null==i.body||""==i.body.innerHTML)&&--v)return t("requeing onLoad callback, DOM not available"),setTimeout(x,250),void 0;c.responseText=i.body?i.body.innerHTML:i.documentElement?i.documentElement.innerHTML:null,c.responseXML=i.XMLDocument?i.XMLDocument:i,u&&(s.dataType="xml"),c.getResponseHeader=function(e){var t={"content-type":s.dataType};return t[e]},p=/(json|script|text)/.test(s.dataType),p||s.textarea?(f=i.getElementsByTagName("textarea")[0],f?c.responseText=f.value:p&&(_=i.getElementsByTagName("pre")[0],y=i.getElementsByTagName("body")[0],_?c.responseText=_.textContent:y&&(c.responseText=y.innerHTML))):"xml"!=s.dataType||c.responseXML||null==c.responseText||(c.responseXML=b(c.responseText)),m=w(c,s.dataType,s)}catch(n){t("error caught:",n),a=!1,c.error=n,s.error&&s.error.call(s.context,c,"error",n),l&&e.event.trigger("ajaxError",[c,s,n])}c.aborted&&(t("upload aborted"),a=!1),a&&(s.success&&s.success.call(s.context,m,"success",c),l&&e.event.trigger("ajaxSuccess",[c,s])),l&&e.event.trigger("ajaxComplete",[c,s]),l&&!--e.active&&e.event.trigger("ajaxStop"),s.complete&&s.complete.call(s.context,c,a?"success":"error"),g=!0,s.timeout&&clearTimeout(d),setTimeout(function(){o.removeData("form-plugin-onload"),o.remove(),c.responseXML=null},100)}}}return i=u[0],e(":input[name=submit],:input[id=submit]",i).length?(alert('Error: Form elements must not have name or id of "submit".'),void 0):(s=e.extend(!0,{},e.ajaxSettings,n),s.context=s.context||s,a="jqFormIO"+(new Date).getTime(),o=e('<iframe id="'+a+'" name="'+a+'" src="'+s.iframeSrc+'" />'),r=o[0],o.css({position:"absolute",top:"-1000px",left:"-1000px"}),c={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(n){var i="timeout"===n?"timeout":"aborted";t("aborting upload... "+i),this.aborted=1,o.attr("src",s.iframeSrc),c.error=i,s.error&&s.error.call(s.context,c,i,i),l&&e.event.trigger("ajaxError",[c,s,i]),s.complete&&s.complete.call(s.context,c,i)}},l=s.global,l&&!e.active++&&e.event.trigger("ajaxStart"),l&&e.event.trigger("ajaxSend",[c,s]),s.beforeSend&&s.beforeSend.call(s.context,c,s)===!1?(s.global&&e.active--,void 0):(c.aborted||(h=0,p=i.clk,p&&(f=p.name,f&&!p.disabled&&(s.extraData=s.extraData||{},s.extraData[f]=p.value,"image"==p.type&&(s.extraData[f+".x"]=i.clk_x,s.extraData[f+".y"]=i.clk_y))),s.forceSync?y():setTimeout(y,10),v=50,b=e.parseXML||function(e,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&"parsererror"!=t.documentElement.nodeName?t:null},_=e.parseJSON||function(e){return window.eval("("+e+")")},w=function(t,n,i){var s=t.getResponseHeader("content-type")||"",a="xml"===n||!n&&s.indexOf("xml")>=0,o=a?t.responseXML:t.responseText;return a&&"parsererror"===o.documentElement.nodeName&&e.error&&e.error("parsererror"),i&&i.dataFilter&&(o=i.dataFilter(o,n)),"string"==typeof o&&("json"===n||!n&&s.indexOf("json")>=0?o=_(o):("script"===n||!n&&s.indexOf("javascript")>=0)&&e.globalEval(o)),o}),void 0))}if(!this.length)return t("ajaxSubmit: skipping submit process - no element selected"),this;if("function"==typeof n&&(n={success:n}),i=this.attr("action"),s="string"==typeof i?e.trim(i):"",s&&(s=(s.match(/^([^#]+)/)||[])[1]),s=s||window.location.href||"",n=e.extend(!0,{url:s,success:e.ajaxSettings.success,type:this[0].getAttribute("method")||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},n),a={},this.trigger("form-pre-serialize",[this,n,a]),a.veto)return t("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(n.beforeSerialize&&n.beforeSerialize(this,n)===!1)return t("ajaxSubmit: submit aborted via beforeSerialize callback"),this;if(c=this.formToArray(n.semantic),n.data){n.extraData=n.data;for(o in n.data)if(n.data[o]instanceof Array)for(l in n.data[o])c.push({name:o,value:n.data[o][l]});else r=n.data[o],r=e.isFunction(r)?r():r,c.push({name:o,value:r})}return n.beforeSubmit&&n.beforeSubmit(c,this,n)===!1?(t("ajaxSubmit: submit aborted via beforeSubmit callback"),this):(this.trigger("form-submit-validate",[c,this,n,a]),a.veto?(t("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this):(d=e.param(c),"GET"==n.type.toUpperCase()?(n.url+=(n.url.indexOf("?")>=0?"&":"?")+d,n.data=null):n.data=d,u=this,h=[],n.resetForm&&h.push(function(){u.resetForm()}),n.clearForm&&h.push(function(){u.clearForm()}),!n.dataType&&n.target?(p=n.success||function(){},h.push(function(t){var i=n.replaceTarget?"replaceWith":"html";e(n.target)[i](t).each(p,arguments)})):n.success&&h.push(n.success),n.success=function(e,t,i){var s,a,o;for(s=n.context||n,a=0,o=h.length;o>a;a++)h[a].apply(s,[e,t,i||u,u])},f=e("input:file",this).length>0,m="multipart/form-data",g=u.attr("enctype")==m||u.attr("encoding")==m,n.iframe!==!1&&(f||n.iframe||g)?n.closeKeepAlive?e.get(n.closeKeepAlive,v):v():e.ajax(n),this.trigger("form-submit-notify",[this,n]),this))},e.fn.ajaxForm=function(n){if(0===this.length){var i={s:this.selector,c:this.context};return!e.isReady&&i.s?(t("DOM not ready, queuing ajaxForm"),e(function(){e(i.s,i.c).ajaxForm(n)}),this):(t("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)")),this)}return this.ajaxFormUnbind().bind("submit.form-plugin",function(t){t.isDefaultPrevented()||(t.preventDefault(),e(this).ajaxSubmit(n))}).bind("click.form-plugin",function(t){var n,i,s,a,o;if(n=t.target,i=e(n),!i.is(":submit,input:image")){if(s=i.closest(":submit"),0==s.length)return;n=s[0]}a=this,a.clk=n,"image"==n.type&&(void 0!=t.offsetX?(a.clk_x=t.offsetX,a.clk_y=t.offsetY):"function"==typeof e.fn.offset?(o=i.offset(),a.clk_x=t.pageX-o.left,a.clk_y=t.pageY-o.top):(a.clk_x=t.pageX-n.offsetLeft,a.clk_y=t.pageY-n.offsetTop)),setTimeout(function(){a.clk=a.clk_x=a.clk_y=null},100)})},e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},e.fn.formToArray=function(t){var n,i,s,a,o,r,c,l,d,u,h,p;if(n=[],0===this.length)return n;if(i=this[0],s=t?i.getElementsByTagName("*"):i.elements,!s)return n;for(a=0,d=s.length;d>a;a++)if(l=s[a],r=l.name)if(t&&i.clk&&"image"==l.type)l.disabled||i.clk!=l||(n.push({name:r,value:e(l).val()}),n.push({name:r+".x",value:i.clk_x},{name:r+".y",value:i.clk_y}));else if(c=e.fieldValue(l,!0),c&&c.constructor==Array)for(o=0,u=c.length;u>o;o++)n.push({name:r,value:c[o]});else null!==c&&c!==void 0&&n.push({name:r,value:c});return!t&&i.clk&&(h=e(i.clk),p=h[0],r=p.name,r&&!p.disabled&&"image"==p.type&&(n.push({name:r,value:h.val()}),n.push({name:r+".x",value:i.clk_x},{name:r+".y",value:i.clk_y}))),n},e.fn.formSerialize=function(t){return e.param(this.formToArray(t))},e.fn.fieldSerialize=function(t){var n=[];return this.each(function(){var i,s,a,o;if(i=this.name)if(s=e.fieldValue(this,t),s&&s.constructor==Array)for(a=0,o=s.length;o>a;a++)n.push({name:i,value:s[a]});else null!==s&&s!==void 0&&n.push({name:this.name,value:s})}),e.param(n)},e.fn.fieldValue=function(t){var n,i,s,a,o;for(n=[],i=0,s=this.length;s>i;i++)a=this[i],o=e.fieldValue(a,t),null===o||void 0===o||o.constructor==Array&&!o.length||(o.constructor==Array?e.merge(n,o):n.push(o));return n},e.fieldValue=function(t,n){var i,s,a,o,r,c,l,d,u,h,p;if(i=t.name,s=t.type,a=t.tagName.toLowerCase(),void 0===n&&(n=!0),n&&(!i||t.disabled||"reset"==s||"button"==s||("checkbox"==s||"radio"==s)&&!t.checked||("submit"==s||"image"==s)&&t.form&&t.form.clk!=t||"select"==a&&-1==t.selectedIndex))return null;if("select"==a){if(o=t.selectedIndex,0>o)return null;for(r=[],c=t.options,l="select-one"==s,d=l?o+1:c.length,u=l?o:0;d>u;u++)if(h=c[u],h.selected){if(p=h.value,p||(p=h.attributes&&h.attributes.value&&!h.attributes.value.specified?h.text:h.value),l)return p;r.push(p)}return r}return e(t).val()},e.fn.clearForm=function(){return this.each(function(){e("input,select,textarea",this).clearFields()})},e.fn.clearFields=e.fn.clearInputs=function(){return this.each(function(){var e=this.type,t=this.tagName.toLowerCase();"text"==e||"password"==e||"textarea"==t?this.value="":"checkbox"==e||"radio"==e?this.checked=!1:"select"==t&&(this.selectedIndex=-1)})},e.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},e.fn.enable=function(e){return void 0===e&&(e=!0),this.each(function(){this.disabled=!e})},e.fn.selected=function(t){return void 0===t&&(t=!0),this.each(function(){var n,i;n=this.type,"checkbox"==n||"radio"==n?this.checked=t:"option"==this.tagName.toLowerCase()&&(i=e(this).parent("select"),t&&i[0]&&"select-one"==i[0].type&&i.find("option").selected(!1),this.selected=t)})}}(jQuery),function(e){function t(t){var n={},i=/^jQuery\d+$/;return e.each(t.attributes,function(e,t){t.specified&&!i.test(t.name)&&(n[t.name]=t.value)}),n}function n(){var t=e(this);t.val()===t.attr("placeholder")&&t.hasClass("placeholder")&&(t.data("placeholder-password")?t.hide().next().attr("id",t.removeAttr("id").data("placeholder-id")).show().focus():t.val("").removeClass("placeholder"))}function i(){var i,s=e(this),a=this.id;if(""===s.val()){if(s.is(":password")){if(!s.data("placeholder-textinput")){try{i=s.clone().attr({type:"text"})}catch(o){i=e("<input>").attr(e.extend(t(this),{type:"text"}))}i.removeAttr("name").data("placeholder-password",!0).data("placeholder-id",a).bind("focus.placeholder",n),s.data("placeholder-textinput",i).data("placeholder-id",a).before(i)}s=s.removeAttr("id").hide().prev().attr("id",a).show()}s.addClass("placeholder").val(s.attr("placeholder"))}else s.removeClass("placeholder")}var s="placeholder"in document.createElement("input"),a="placeholder"in document.createElement("textarea");s&&a?(e.fn.placeholder=function(){return this},e.fn.placeholder.input=e.fn.placeholder.textarea=!0):(e.fn.placeholder=function(){return this.filter((s?"textarea":":input")+"[placeholder]").bind("focus.placeholder",n).bind("blur.placeholder",i).trigger("blur.placeholder").end()},e.fn.placeholder.input=s,e.fn.placeholder.textarea=a),e(function(){e("form").bind("submit.placeholder",function(){var t=e(".placeholder",this).each(n);setTimeout(function(){t.each(i)},10)})}),e(window).bind("unload.placeholder",function(){e(".placeholder").val("")})}(jQuery),function(e){e.fn.each2===void 0&&e.fn.extend({each2:function(t){for(var n=e([0]),i=-1,s=this.length;s>++i&&(n.context=n[0]=this[i])&&t.call(n[0],i,n)!==!1;);return this}})}(jQuery),function(e,t){"use strict";function n(e,n){var i,s=0,a=n.length;if(e===t)return-1;if(e.constructor===String){for(;a>s;s+=1)if(0===e.localeCompare(n[s]))return s}else for(;a>s;s+=1)if(i=n[s],i.constructor===String){if(0===i.localeCompare(e))return s}else if(i===e)return s;return-1}function i(e,n){return e===n?!0:e===t||n===t?!1:null===e||null===n?!1:e.constructor===String?0===e.localeCompare(n):n.constructor===String?0===n.localeCompare(e):!1}function s(t,n){var i,s,a;if(null===t||1>t.length)return[];for(i=t.split(n),s=0,a=i.length;a>s;s+=1)i[s]=e.trim(i[s]);return i}function a(e){return e.outerWidth()-e.width()}function o(e){e.bind("keydown",function(){e.data("keyup-change-value",e.val())}),e.bind("keyup",function(){e.val()!==e.data("keyup-change-value")&&e.trigger("keyup-change")})}function r(n){n.bind("mousemove",function(n){var i=e(document).data("select2-lastpos");(i===t||i.x!==n.pageX||i.y!==n.pageY)&&e(n.target).trigger("mousemove-filtered",n)})}function c(e,t){var n;return function(){window.clearTimeout(n),n=window.setTimeout(t,e)}}function l(e,t){var i=c(e,function(e){t.trigger("scroll-debounced",e)});t.bind("scroll",function(e){n(e.target,t.get())>=0&&i(e)})}function d(e){e.preventDefault(),e.stopPropagation()}function u(t){if(!P){var n=t[0].currentStyle||window.getComputedStyle(t[0],null);P=e("<div></div>").css({position:"absolute",left:"-1000px",top:"-1000px",display:"none",fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,textTransform:n.textTransform,whiteSpace:"nowrap"}),e("body").append(P)}return P.text(t.val()),P.width()}function h(e,n,i){var s=e.toUpperCase().indexOf(n.toUpperCase()),a=n.length;return 0>s?(i.push(e),t):(i.push(e.substring(0,s)),i.push("<span class='select2-match'>"),i.push(e.substring(s,s+a)),i.push("</span>"),i.push(e.substring(s+a,e.length)),t)}function p(t){var n,i=0,s=null,a=t.quietMillis||100;return function(o){window.clearTimeout(n),n=window.setTimeout(function(){i+=1;var n=i,a=t.data,r=t.transport||e.ajax,c=t.type||"GET";a=a.call(this,o.term,o.page,o.context),null!==s&&s.abort(),s=r.call(null,{url:t.url,dataType:t.dataType,data:a,type:c,success:function(e){if(!(i>n)){var s=t.results(e,o.page);o.callback(s)}}})},a)}}function f(n){var i,s=n,a=function(e){return""+e.text};return e.isArray(s)||(a=s.text,e.isFunction(a)||(i=s.text,a=function(e){return e[i]}),s=s.results),function(n){var i=n.term,o={};return""===i?(n.callback({results:s}),t):(o.results=e(s).filter(function(){return n.matcher(i,a(this))}).get(),n.callback(o),t)}}function m(n){return e.isFunction(n)?n:function(i){var s=i.term,a={results:[]};e(n).each(function(){var e=this.text!==t,n=e?this.text:this;(""===s||i.matcher(s,n))&&a.results.push(e?this:{id:this,text:this})}),i.callback(a)}}function g(t){return e.isFunction(t)?t():t}function v(t,n){var i=function(){};return i.prototype=new t,i.prototype.constructor=i,i.prototype.parent=t.prototype,i.prototype=e.extend(i.prototype,n),i}if(window.Select2===t){var b,_,w,y,x,P;b={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){switch(e=e.which?e.which:e){case b.LEFT:case b.RIGHT:case b.UP:case b.DOWN:return!0}return!1},isControl:function(e){switch(e=e.which?e.which:e){case b.SHIFT:case b.CTRL:case b.ALT:return!0}return e.metaKey?!0:!1},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&123>=e}},x=function(){var e=1;return function(){return e++}}(),e(document).delegate("*","mousemove",function(t){e(document).data("select2-lastpos",{x:t.pageX,y:t.pageY})}),e(document).ready(function(){e(document).delegate("*","mousedown focusin touchend",function(t){var n=e(t.target).closest("div.select2-container").get(0);n?e(document).find("div.select2-container-active").each(function(){this!==n&&e(this).data("select2").blur()}):(n=e(t.target).closest("div.select2-drop").get(0),e(document).find("div.select2-drop-active").each(function(){this!==n&&e(this).data("select2").blur()}))})}),_=v(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(n){var i,s,a=".select2-results";this.opts=n=this.prepareOpts(n),this.id=n.id,n.element.data("select2")!==t&&null!==n.element.data("select2")&&this.destroy(),this.enabled=!0,this.container=this.createContainer(),this.body=n.element.closest("body"),n.element.attr("class")!==t&&this.container.addClass(n.element.attr("class")),this.container.css(g(n.containerCss)),this.container.addClass(g(n.containerCssClass)),this.opts.element.data("select2",this).hide().after(this.container),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),this.dropdown.css(g(n.dropdownCss)),this.dropdown.addClass(g(n.dropdownCssClass)),this.dropdown.data("select2",this),this.results=i=this.container.find(a),this.search=s=this.container.find("input.select2-input"),this.resultsPage=0,this.context=null,this.initContainer(),r(this.results),this.dropdown.delegate(a,"mousemove-filtered",this.bind(this.highlightUnderEvent)),l(80,this.results),this.dropdown.delegate(a,"scroll-debounced",this.bind(this.loadMoreIfNeeded)),e.fn.mousewheel&&i.mousewheel(function(e,t,n,s){var a=i.scrollTop();s>0&&0>=a-s?(i.scrollTop(0),d(e)):0>s&&i.height()>=i.get(0).scrollHeight-i.scrollTop()+s&&(i.scrollTop(i.get(0).scrollHeight-i.height()),d(e))}),o(s),s.bind("keyup-change",this.bind(this.updateResults)),s.bind("focus",function(){s.addClass("select2-focused")," "===s.val()&&s.val("")}),s.bind("blur",function(){s.removeClass("select2-focused")}),this.dropdown.delegate(a,"click",this.bind(function(t){e(t.target).closest(".select2-result-selectable:not(.select2-disabled)").length>0?(this.highlightUnderEvent(t),this.selectHighlighted(t)):(d(t),this.focusSearch())})),e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),n.element.is(":disabled")&&this.disable()},destroy:function(){var e=this.opts.element.data("select2");e!==t&&(e.container.remove(),e.dropdown.remove(),e.opts.element.removeData("select2").unbind(".select2").show())},prepareOpts:function(n){var i,a,o;if(i=n.element,"select"===i.get(0).tagName.toLowerCase()&&(this.select=a=n.element),a&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in n)throw Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),n=e.extend({},{containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",populateResults:function(i,s,a){var o,r,c,l={},d=[],u=this.opts.id;o=function(e,i){var s,r,h,p,f,m;for(s=0,r=e.length;r>s;s+=1)p=e[s],f=u(p)!==t,m="children"in p&&p.children.length>0,d.push("<li class='select2-result-depth-"+i),d.push(" select2-result"),d.push(f?" select2-result-selectable":" select2-result-unselectable"),m&&d.push(" select2-result-with-children"),d.push("'"),h=x(),d.push(" id='select2-result-"+h+"'"),l[h]=p,d.push("><div class='select2-result-label'>"),c=n.formatResult(p,a,d),c!==t&&d.push(c),d.push("</div>"),m&&(d.push("<ul class='select2-result-sub'>"),o(p.children,i+1),d.push("</ul>")),d.push("</li>")},o(s,0),i.append(d.join(""));for(r in l)e("#select2-result-"+r,i).data("select2-data",l[r])},formatResult:function(e,t,n){h(e.text,t.term,n)},formatSelection:function(e){return e.fullText||e.text},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,t){return"Please enter "+(t-e.length)+" more characters"},formatLoadMore:function(){return"Loading more results..."},minimumResultsForSearch:0,minimumInputLength:0,id:function(e){return e.id},matcher:function(e,t){return t.toUpperCase().indexOf(e.toUpperCase())>=0}},n),"function"!=typeof n.id&&(o=n.id,n.id=function(e){return e[o]}),a?(n.query=this.bind(function(n){var s,a,o,r={results:[],more:!1},c=n.term;o=function(e,t){var i;e.is("option")?n.matcher(c,e.text())&&t.push({id:e.attr("value"),text:e.text(),element:e.get()}):e.is("optgroup")&&(i={text:e.attr("label"),children:[],element:e.get()},e.children().each2(function(e,t){o(t,i.children)}),i.children.length>0&&t.push(i))},s=i.children(),this.getPlaceholder()!==t&&s.length>0&&(a=s[0],""===e(a).text()&&(s=s.not(a))),s.each2(function(e,t){o(t,r.results)}),n.callback(r)}),n.id=function(e){return e.id}):"query"in n||("ajax"in n?n.query=p(n.ajax):"data"in n?n.query=f(n.data):"tags"in n&&(n.query=m(n.tags),n.createSearchChoice=function(e){return{id:e,text:e}},n.initSelection=function(t,n){var i=[];e(s(t.val(),",")).each(function(){i.push({id:this,text:this})}),n(i)})),"function"!=typeof n.query)throw"query function not defined for Select2 "+n.element.attr("id");return n},monitorSource:function(){this.opts.element.bind("change.select2",this.bind(function(){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()}))},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1)},enable:function(){this.enabled||(this.enabled=!0,this.container.removeClass("select2-container-disabled"))},disable:function(){this.enabled&&(this.close(),this.enabled=!1,this.container.addClass("select2-container-disabled"))},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var e,t,n=this.container.offset(),i=this.container.outerHeight(),s=this.container.outerWidth(),a=this.dropdown.outerHeight(),o=document.body.scrollTop+document.documentElement.clientHeight,r=n.top+i,c=o>=r+a,l=n.top-a>=document.body.scrollTop,d=this.dropdown.hasClass("select2-drop-above");d?(e=!0,!l&&c&&(e=!1)):(e=!1,!c&&l&&(e=!0)),e?(r=n.top-a,this.container.addClass("select2-drop-above"),this.dropdown.addClass("select2-drop-above")):(this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")),t={top:r,left:n.left,width:s},this.dropdown.css(t)},shouldOpen:function(){var e;return this.opened()?!1:(e=jQuery.Event("open"),this.opts.element.trigger(e),!e.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(this.clearDropdownAlignmentPreference()," "===this.search.val()&&this.search.val(""),this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.dropdown[0]!==this.body.children().last()[0]&&this.dropdown.detach().appendTo(this.body),this.dropdown.addClass("select2-drop-active"),this.positionDropdown(),this.updateResults(!0),this.dropdown.show(),this.ensureHighlightVisible(),this.focusSearch(),!0):!1},close:function(){this.opened()&&(this.clearDropdownAlignmentPreference(),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open"),this.results.empty(),this.clearSearch())},clearSearch:function(){},ensureHighlightVisible:function(){var n,i,s,a,o,r,c,l=this.results;if(i=this.highlight(),!(0>i)){if(0==i)return l.scrollTop(0),t;n=l.find(".select2-result-selectable"),s=e(n[i]),a=s.offset().top+s.outerHeight(),i===n.length-1&&(c=l.find("li.select2-more-results"),c.length>0&&(a=c.offset().top+c.outerHeight())),o=l.offset().top+l.outerHeight(),a>o&&l.scrollTop(l.scrollTop()+(a-o)),r=s.offset().top-l.offset().top,0>r&&l.scrollTop(l.scrollTop()+r)}},moveHighlight:function(t){var n,i,s;for(n=this.results.find(".select2-result-selectable"),i=this.highlight();i>-1&&n.length>i;)if(i+=t,s=e(n[i]),s.hasClass("select2-result-selectable")&&!s.hasClass("select2-disabled")){this.highlight(i);break}},highlight:function(i){var s=this.results.find(".select2-result-selectable");return 0===arguments.length?n(s.filter(".select2-highlighted")[0],s.get()):(i>=s.length&&(i=s.length-1),0>i&&(i=0),s.removeClass("select2-highlighted"),e(s[i]).addClass("select2-highlighted"),this.ensureHighlightVisible(),t)},highlightUnderEvent:function(t){var n,i;n=e(t.target).closest(".select2-result-selectable"),n.length>0&&!n.is(".select2-highlighted")?(i=this.results.find(".select2-result-selectable"),this.highlight(i.index(n))):0==n.length&&this.results.find(".select2-highlighted").removeClass("select2-highlighted")},loadMoreIfNeeded:function(){var e,t=this.results,n=t.find("li.select2-more-results"),i=this.resultsPage+1,s=this,a=this.search.val(),o=this.context;0!==n.length&&(e=n.offset().top-t.offset().top-t.height(),0>=e&&(n.addClass("select2-active"),this.opts.query({term:a,page:i,context:o,matcher:this.opts.matcher,callback:this.bind(function(e){s.opts.populateResults.call(this,t,e.results,{term:a,page:i,context:o}),e.more===!0?(n.detach().appendTo(t.children(":last")).text(s.opts.formatLoadMore(i+1)),window.setTimeout(function(){s.loadMoreIfNeeded()},10)):n.remove(),s.positionDropdown(),s.resultsPage=i})})))},updateResults:function(n){function s(){r.scrollTop(0),o.removeClass("select2-active"),l.positionDropdown()}function a(e){r.html(e),s()}var o=this.search,r=this.results,c=this.opts,l=this;if(n===!0||this.showSearchInput!==!1){if(o.addClass("select2-active"),c.minimumInputLength>o.val().length)return a("<li class='select2-no-results'>"+c.formatInputTooShort(o.val(),c.minimumInputLength)+"</li>"),t;this.resultsPage=1,c.query({term:o.val(),page:this.resultsPage,context:null,matcher:c.matcher,callback:this.bind(function(d){var u;return this.context=d.context===t?null:d.context,this.opts.createSearchChoice&&""!==o.val()&&(u=this.opts.createSearchChoice.call(null,o.val(),d.results),u!==t&&null!==u&&l.id(u)!==t&&null!==l.id(u)&&0===e(d.results).filter(function(){return i(l.id(this),l.id(u))}).length&&d.results.unshift(u)),0===d.results.length?(a("<li class='select2-no-results'>"+c.formatNoMatches(o.val())+"</li>"),t):(r.empty(),l.opts.populateResults.call(this,r,d.results,{term:o.val(),page:this.resultsPage,context:null}),s(),d.more===!0&&(r.children().filter(":last").append("<li class='select2-more-results'>"+c.formatLoadMore(this.resultsPage)+"</li>"),window.setTimeout(function(){l.loadMoreIfNeeded()
},10)),this.postprocessResults(d,n),t)})})}},cancel:function(){this.close()},blur:function(){this.close(),this.container.removeClass("select2-container-active"),this.dropdown.removeClass("select2-drop-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){window.setTimeout(this.bind(function(){this.search.focus()}),10)},selectHighlighted:function(){var e=this.results.find(".select2-highlighted").not(".select2-disabled").closest(".select2-result-selectable").data("select2-data");e&&this.onSelect(e)},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},getContainerWidth:function(){var e,n,i,s,a;if(this.opts.width!==t)return this.opts.width;if(e=this.opts.element.attr("style"),e!==t)for(n=e.split(";"),s=0,a=n.length;a>s;s+=1)if(i=n[s].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/),null!==i&&i.length>=1)return i[1];return e=this.opts.element.css("width"),e.indexOf("%")>0?e:0===this.opts.element.width()?"auto":this.opts.element.outerWidth()+"px"}}),w=v(_,{createContainer:function(){return e("<div></div>",{"class":"select2-container",style:"width: "+this.getContainerWidth()}).html(["    <a href='javascript:void(0)' class='select2-choice'><input type='text' class='select2-offscreen select2-focusser'/>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>","   <div><b></b></div>","</a>","    <div class='select2-drop' style='display:none;'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.selection.focus()},isFocused:function(){return this.selection[0]===document.activeElement},cancel:function(){this.parent.cancel.apply(this,arguments),this.selection.focus()},initContainer:function(){var n,i=this.container,s=this.dropdown,a=e([this.container.get(0),this.dropdown.get(0)]),o=!1,r=".select2-choice",c=i.find("input.select2-focusser");this.selection=n=i.find(r),this.search.bind("keydown",this.bind(function(e){switch(e.which){case b.UP:case b.DOWN:return this.moveHighlight(e.which===b.UP?-1:1),d(e),t;case b.TAB:case b.ENTER:return this.selectHighlighted(),d(e),t;case b.ESC:return this.cancel(e),d(e),t}})),a.delegate(r,"click",this.bind(function(e){o=!0,this.opened()?(this.close(),n.focus()):this.enabled&&this.open(),e.preventDefault(),o=!1})),a.delegate(r,"keydown",this.bind(function(e){!this.enabled||e.which===b.TAB||b.isControl(e)||b.isFunctionKey(e)||e.which===b.ESC||(this.open(),(e.which===b.PAGE_UP||e.which===b.PAGE_DOWN||e.which===b.SPACE)&&d(e),e.which===b.ENTER&&d(e))})),a.delegate(r,"focus",function(){this.enabled&&(a.addClass("select2-container-active"),s.addClass("select2-drop-active"))}),a.delegate(r,"blur",this.bind(function(e){o||e.target!==c.get(0)&&(this.opened()||this.blur())})),n.delegate("abbr","click",this.bind(function(e){this.enabled&&(this.clear(),d(e),this.close(),this.triggerChange(),n.focus())})),this.setPlaceholder(),c.bind("focus",function(){n.focus()}),n.bind("focus",this.bind(function(){c.hide(),this.container.addClass("select2-container-active")})),n.bind("blur",function(){c.show()}),this.opts.element.bind("open",function(){c.hide()})},clear:function(){this.opts.element.val(""),this.selection.find("span").empty(),this.selection.removeData("select2-data"),this.setPlaceholder()},initSelection:function(){if(""===this.opts.element.val())this.updateSelection({id:"",text:""}),this.close(),this.setPlaceholder();else{var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.setPlaceholder())})}},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);return"select"===t.element.get(0).tagName.toLowerCase()&&(t.initSelection=function(t,n){var i=t.find(":selected");e.isFunction(n)&&n({id:i.attr("value"),text:i.text()})}),t},setPlaceholder:function(){var e=this.getPlaceholder();if(""===this.opts.element.val()&&e!==t){if(this.select&&""!==this.select.find("option:first").text())return;"object"==typeof e?this.updateSelection(e):this.selection.find("span").html(e),this.selection.addClass("select2-default"),this.selection.find("abbr").hide()}},postprocessResults:function(n,s){var a=0,o=this,r=!0;this.results.find(".select2-result-selectable").each2(function(e,n){return i(o.id(n.data("select2-data")),o.opts.element.val())?(a=e,!1):t}),this.highlight(a),s===!0&&(r=this.showSearchInput=n.results.length>=this.opts.minimumResultsForSearch,this.dropdown.find(".select2-search")[r?"removeClass":"addClass"]("select2-search-hidden"),e(this.dropdown,this.container)[r?"addClass":"removeClass"]("select2-with-searchbox"))},onSelect:function(e){var t=this.opts.element.val();this.opts.element.val(this.id(e)),this.updateSelection(e),this.close(),this.selection.focus(),i(t,this.id(e))||this.triggerChange()},updateSelection:function(e){this.selection.data("select2-data",e),this.selection.find("span").html(this.opts.formatSelection(e)),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.selection.find("abbr").show()},val:function(){var e,n=null;return 0===arguments.length?this.opts.element.val():(e=arguments[0],this.select?(this.select.val(e).find(":selected").each2(function(e,t){return n={id:t.attr("value"),text:t.text()},!1}),this.updateSelection(n)):(this.opts.element.val(e?this.id(e):""),this.updateSelection(e)),this.setPlaceholder(),t)},clearSearch:function(){this.search.val("")},data:function(e){return 0===arguments.length?this.selection.data("select2-data"):(e&&""!==e?(this.opts.element.val(e?this.id(e):""),this.updateSelection(e)):this.clear(),t)}}),y=v(_,{createContainer:function(){return e("<div></div>",{"class":"select2-container select2-container-multi",style:"width: "+this.getContainerWidth()}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' style='width: 25px;' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""))},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);return t=e.extend({},{closeOnSelect:!0},t),"select"===t.element.get(0).tagName.toLowerCase()&&(t.initSelection=function(t,n){var i=[];t.find(":selected").each2(function(e,t){i.push({id:t.attr("value"),text:t.text()})}),e.isFunction(n)&&n(i)}),t},initContainer:function(){var e,n=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=e=this.container.find(n),this.search.bind("keydown",this.bind(function(n){if(this.enabled){if(n.which===b.BACKSPACE&&""===this.search.val()){this.close();var i,s=e.find(".select2-search-choice-focus");if(s.length>0)return this.unselect(s.first()),this.search.width(10),d(n),t;i=e.find(".select2-search-choice"),i.length>0&&i.last().addClass("select2-search-choice-focus")}else e.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");if(this.opened())switch(n.which){case b.UP:case b.DOWN:return this.moveHighlight(n.which===b.UP?-1:1),d(n),t;case b.ENTER:case b.TAB:return this.selectHighlighted(),d(n),t;case b.ESC:return this.cancel(n),d(n),t}n.which===b.TAB||b.isControl(n)||b.isFunctionKey(n)||n.which===b.BACKSPACE||n.which===b.ESC||(this.open(),(n.which===b.PAGE_UP||n.which===b.PAGE_DOWN)&&d(n))}})),this.search.bind("keyup",this.bind(this.resizeSearch)),this.container.delegate(n,"click",this.bind(function(e){this.enabled&&(this.clearPlaceholder(),this.open(),this.focusSearch(),e.preventDefault())})),this.container.delegate(n,"focus",this.bind(function(){this.enabled&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.clearSearch()},enable:function(){this.enabled||(this.parent.enable.apply(this,arguments),this.search.show())},disable:function(){this.enabled&&(this.parent.disable.apply(this,arguments),this.search.hide())},initSelection:function(){if(""===this.opts.element.val()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder();e!==t&&0===this.getVal().length&&this.search.hasClass("select2-focused")===!1?(this.search.val(e).addClass("select2-default"),this.search.width("auto")):this.search.val(" ").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")?this.search.val("").removeClass("select2-default"):" "===this.search.val()&&this.search.val("")},open:function(){return this.parent.open.apply(this,arguments)===!1?!1:(this.clearPlaceholder(),this.resizeSearch(),this.focusSearch(),!0)},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var i=[],s=[],a=this;e(t).each(function(){0>n(a.id(this),i)&&(i.push(a.id(this)),s.push(this))}),t=s,this.selection.find(".select2-search-choice").remove(),e(t).each(function(){a.addSelectedChoice(this)}),a.postprocessResults()},onSelect:function(e){this.addSelectedChoice(e),this.select&&this.postprocessResults(),this.opts.closeOnSelect?(this.close(),this.search.width(10)):(this.search.width(10),this.resizeSearch()),this.triggerChange({added:e}),this.focusSearch()},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(t){var n,i,s=this.id(t),a=this.getVal();i=["<li class='select2-search-choice'>",this.opts.formatSelection(t),"<a href='javascript:void(0)' class='select2-search-choice-close' tabindex='-1'></a>","</li>"],n=e(i.join("")),n.find("a").bind("click dblclick",this.bind(function(t){this.enabled&&(this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),d(t),this.close(),this.focusSearch())})).bind("focus",this.bind(function(){this.enabled&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),n.data("select2-data",t),n.insertBefore(this.searchContainer),a.push(s),this.setVal(a)},unselect:function(e){var t,i,s=this.getVal();if(e=e.closest(".select2-search-choice"),0===e.length)throw"Invalid argument: "+e+". Must be .select2-search-choice";t=e.data("select2-data"),i=n(this.id(t),s),i>=0&&(s.splice(i,1),this.setVal(s),this.select&&this.postprocessResults()),e.remove(),this.triggerChange({removed:t})},postprocessResults:function(){var e=this.getVal(),i=this.results.find(".select2-result-selectable"),s=this;i.each2(function(t,i){var a=s.id(i.data("select2-data"));n(a,e)>=0?i.addClass("select2-disabled"):i.removeClass("select2-disabled")}),i.each2(function(e,n){return n.hasClass("select2-disabled")?t:(s.highlight(e),!1)})},resizeSearch:function(){var e,t,n,i,s,o=a(this.search);e=u(this.search)+10,t=this.search.offset().left,n=this.selection.width(),i=this.selection.offset().left,s=n-(t-i)-o,e>s&&(s=n-o),40>s&&(s=n-o),this.search.width(s)},getVal:function(){var e;return this.select?(e=this.select.val(),null===e?[]:e):(e=this.opts.element.val(),s(e,","))},setVal:function(t){var i;this.select?this.select.val(t):(i=[],e(t).each(function(){0>n(this,i)&&i.push(this)}),this.opts.element.val(0===i.length?"":i.join(",")))},val:function(){var n,i=[],s=this;return 0===arguments.length?this.getVal():(n=arguments[0],this.select?(this.setVal(n),this.select.find(":selected").each(function(){i.push({id:e(this).attr("value"),text:e(this).text()})}),this.updateSelection(i)):(n=null===n?[]:n,e(n).each(function(){i.push(s.id(this))}),this.setVal(i),this.updateSelection(n)),this.clearSearch(),t)},onSortStart:function(){if(this.select)throw Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],n=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(n.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(n){var i,s=this;return 0===arguments.length?this.selection.find(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get():(i=e.map(n,function(e){return s.opts.id(e)}),this.setVal(i),this.updateSelection(n),this.clearSearch(),t)}}),e.fn.select2=function(){var i,s,a,o,r=Array.prototype.slice.call(arguments,0),c=["val","destroy","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data"];return this.each(function(){if(0===r.length||"object"==typeof r[0])i=0===r.length?{}:e.extend({},r[0]),i.element=e(this),"select"===i.element.get(0).tagName.toLowerCase()?o=i.element.attr("multiple"):(o=i.multiple||!1,"tags"in i&&(i.multiple=o=!0)),s=o?new y:new w,s.init(i);else{if("string"!=typeof r[0])throw"Invalid arguments to select2 plugin: "+r;if(0>n(r[0],c))throw"Unknown method: "+r[0];if(a=t,s=e(this).data("select2"),s===t)return;if(a="container"===r[0]?s.container:s[r[0]].apply(s,r.slice(1)),a!==t)return!1}}),a===t?this:a},window.Select2={query:{ajax:p,local:f,tags:m},util:{debounce:c,markMatch:h},"class":{"abstract":_,single:w,multi:y}}}}(jQuery),function(){var e=Array.prototype,t=(Object.prototype,Function.prototype,e.slice),n=function(){},i=function(e){return $.each(t.call(arguments,1),function(t,n){var i;for(i in n)void 0!==n[i]&&(e[i]=n[i])}),e},s=function(e,t,s){var a;return a=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return e.apply(this,arguments)},i(a,e),n.prototype=e.prototype,a.prototype=new n,t&&i(a.prototype,t),s&&i(a,s),a.prototype.constructor=a,a.__super__=e.prototype,a},a=function(e,t){var n=s(this,e,t);return n.extend=this.extend,n},o=function(){};o.extend=a,TAPP.Klass=o,TAPP.Module=o.extend({register_for_event:function(e,t){$.subscribe(e,$.proxy(t,this))},register_post_load_hooks:function(e){var t=this;$.each(e,function(e,n){t.register_for_event(e,n)})},register_app_hooks:function(e){var t=this;$.each(e,function(e,n){t.register_for_event(e,n)})},publish_app_event:function(e,t){$.publish(e,t)},unload_functions:[],unload:function(){$.each(this.unload_functions,function(){this()}),this.unload_functions=[]}})}(TAPP),function(){TAPP.utils={intcomma:function(e){return e=""+e,e.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},show_form_errors:function(e,t){$.each(t,function(t,n){var i,s,a,o;i=e.find(".field-"+t),i.addClass("bad"),s=i.find("input"),s.addClass("bad"),a="",$.each(n,function(e,t){a+="<li>"+t+"</li>"}),o=i.find("ul.error"),o.length||(s.after('<ul class="error"></ul>'),o=i.find("ul.error")),o.html(a)})},is_touch:function(){return $("html").hasClass("touch")},is_widescreen:function(){return $("html").hasClass("breakpoint-widescreen")},handle_resize:function(){$(window).on("resize",_.debounce(Modernizr.test_media_queries,50))}}}(TAPP),function(){var e,t,n,i,s;e={backdrop:!1,zIndex:1e4,buttons:{Close:function(){$(this).modal("close")}}},t=function(e,t,n){e=$("<div/>").addClass("modal-header").html(e),t=$("<div/>").addClass("modal-body").html(t),n=$("<div/>").addClass("modal-footer btn-group-spaced").html(n);var i=$("<div/>").addClass("modal").append(e).append(t).append(n);return i.addClass("hide").appendTo($("body")),$(i)},n=function(e){if(!e)return null;var t=$("<div/>");return $.each(e,function(e,n){var i,s,a;i=n.text||e,s=n["class"]||"mgt-btn",a=n.click||$.noop(),t.append($("<button/>").text(i).addClass(s).on("click",a))}),t},i=function(i,s){var a,o,r,c;return"string"!=typeof i&&(i=i.html()),a=s.title||"",o=s.buttons?n(s.buttons):s.footer||"",r=$.extend({},e,s),c=t(a,i,o),c.modal(r),c},s=TAPP.Module.extend({markup_dialog:function(e,t){return i(e,t)},error_dialog:function(e,t,n){var s,a;e=e||"Something is wrong with the server. Please wait a moment and try again.",a=$.extend({},n,{title:"<h3>An error occurred<h3>",dialogClass:"error-dialog",buttons:{Ok:{click:function(){s.modal("hide"),t&&t()}}}}),s=i(e,a),s.modal("show")},confirm_dialog:function(e,t,n,s,a,o){var r,c;s=s||"<h3>Are you sure?</h3>",a=(a||"")+" confirmation-dialog",r=$(e),c=function(e){var r,c,l,d;return e.preventDefault(),e.stopImmediatePropagation(),c=$(this),l=o||{Cancel:{click:function(){r.modal("hide")}},Continue:{click:function(){c.unbind(e),c.trigger($.Event(t)),r.modal("hide")},text:"Continue","class":"mgt-btn mgt-btn-primary"}},c.data("dialog-init")?r=c.data("dialog-init"):(d={title:s,dialogClass:a,buttons:l},r=i(n,d),c.data("dialog-init",r)),r.modal("show"),!1},r.bind(t,c)}}),TAPP.dialogs=new s,TAPP.dialogs.register_post_load_hooks({confirm_dialog:TAPP.dialogs.confirm_dialog,error_dialog:TAPP.dialogs.error_dialog})}(TAPP),function(){var e=TAPP.Module.extend({get_cc_data:function(){return{number:$("#card-number").val(),cvc:$("#card-cvc").val(),exp_month:$("#card-exp-month").val(),exp_year:$("#card-exp-year").val(),name:$("#card-name").val(),address_country:$("#id_country_code").val(),address_zip:$("#card-address-zip").val()}},handle_form_submit:function(e){var t,n,i;return t=$("#card-exp-year").val(),2===t.length&&$("#card-exp-year").val("20"+t),n=$(".submit-button",e),n.attr("disabled","disabled"),i=$.Deferred(),Stripe.createToken(this.get_cc_data(),function(e,t){var s,a,o;t.error?(t.error.param&&(s=$("#card-"+t.error.param.replace("_","-")),a=s.closest(".control-group"),a.addClass("error"),$("body").on("change",s,function(){a.removeClass("error")})),o=t.error.message,window._kmq=window._kmq||[],window._kmq.push(["record","Stripe Error",{"Error Message":o}]),o[0].toUpperCase()!==o[0]&&(o="We couldn't process your order. Please fix the following information:"),$(".payment-errors").text(o),n.removeAttr("disabled"),i.reject(t)):($("#stripe_token").val(t.id),i.resolve(t))}),i},init:function(){Stripe.setPublishableKey(page_context.stripe_publishable_key)}});TAPP.stripe=new e}(TAPP),function(){var e=TAPP.Module.extend({settings_view_init:function(){this.file_uploads(),this.confirm_deauthorize(),this.my_stream_settings_form(),this.hash_expand(),this.settings_accordion(),this.authorized_apps_accordion(),this.confirm_username(),this.confirm_account_upgrade(),this.discounted_user_creator(),this.cancel_flow(),TAPP.utils.handle_resize(),$("#id_language,#id_timezone").select2({width:"250px"}),$("[data-error-form]").click()},file_uploads:function(){return void 0!==$("[data-image-upload]").attr("disabled")?($("[data-image-uploads]").addClass("hide"),$("[data-impage-upload-unsupported]").removeClass("hide"),!1):($("body").on("change","[data-image-upload]",function(){var e=$(this).closest(".uploader-block");e.find(".icon-check, .icon-check-empty").addClass("hide"),e.find(".spinner").removeClass("hide"),$(this).closest("form").submit()}),void 0)},confirm_deauthorize:function(){$("body").tapp_on("click","[data-deauthorize]",function(){var e,t,n,i,s,a,o;return e=$(this),t=TAPP.lock_up(e),n=e.closest("form"),i=e.data("app-name"),a={Cancel:{click:function(){return s.remove(),t(),!1},"class":"btn-bold gray"},Deauthorize:{click:function(){return s.remove(),t(),n.submit(),!1},text:"Deauthorize","class":"btn-bold danger"}},o={title:"<strong>Deauthorize "+i+"</strong>",buttons:a},s=TAPP.dialogs.markup_dialog("Are you sure you want to deauthorize this app?",o),s.show(),!1})},confirm_username:function(){$("body").tapp_on("click","[data-change-username]",function(){var e,t,n,i;return e=$(this).closest("form"),n={Cancel:{click:function(){t.remove()},"class":"btn-bold gray"},Confirm:{click:function(){return e.submit(),t.remove(),!1},text:"Change Username","class":"btn-bold danger"}},i={title:"<strong>Change Username</strong>",buttons:n},t=TAPP.dialogs.markup_dialog("Are you sure you want to change your username? You will not be able to change it ever again after this.",i),t.show(),!1})},confirm_account_upgrade:function(){$("body").tapp_on("click","[data-upgrade-account]",function(){var e,t,n,i,s,a;return e=$(this).attr("data-upgrade-last-4"),t=$(this).attr("data-upgrade-amount"),n=$(this).closest("form"),s={Cancel:{click:function(){i.remove()},"class":"btn-bold gray"},Confirm:{click:function(){return n.submit(),i.remove(),!1},text:"Upgrade Account","class":"btn-bold"}},a={title:"<strong>Upgrade Account</strong>",buttons:s},i=TAPP.dialogs.markup_dialog("Are you sure you want to upgrade your account? Your card ending in "+e+" will be billed $"+t+".",a),i.show(),!1})},my_stream_settings_form:function(){$("body").tapp_on("change","[data-my-stream-settings] input",function(){var e=$(this).closest("form");e.submit()})},hash_expand:function(){var e,t;e=window.location.hash,t=e.substr(1,e.length),t&&($("[data-expandable-setting]").each(function(e,t){$(t).removeClass("expanded")}),$("[name="+t+"]").addClass("expanded"))},settings_accordion:function(){$("body").on("click","[data-expandable-setting]",function(){var e=$(this);e.hasClass("expanded")||($("[data-expandable-setting].expanded").removeClass("expanded"),e.addClass("expanded"))})},authorized_apps_accordion:function(){$("body").on("click","[data-expand-authorized-app]",function(){var e=$(this).closest(".authorized-app");return e.hasClass("expanded")||($(".authorized-apps-list .authorized-app").removeClass("expanded"),e.addClass("expanded")),!1})},payment_details_init:function(){var e,t,n;$("#id_country_code,#id_plan_choice").select2({width:"250px"}),e=$("[data-card-details]"),t=$("[data-card-details-form]"),$("body").on("click","[data-edit-card-details]",function(){return e.addClass("hide"),t.removeClass("hide"),!1}),TAPP.stripe.init(),n=$("#payment-form"),n.on("submit",function(e){var t=$("[data-spinner]");return t.removeClass("hide"),e.preventDefault(),TAPP.stripe.handle_form_submit(n).done(function(){var e={stripe_token:$("#stripe_token").val(),country_code:$("#id_country_code").val(),action:"update_payment_details"};$(".payment-errors").text(""),$.post(window.location.href,e).done(function(e){if("error"===e.result)if($(".payment-errors").text(e.response.message),$(".hide-on-payment-error").addClass("hide"),"card"===e.response.error_type){var t=$("#card-number");t.closest(".control-group").addClass("error"),$("body").on("change",t,function(){t.closest(".control-group").removeClass("error"),$("body").off("change",t)})}else"user_details"===e.response.error_type&&TAPP.utils.show_form_errors(n,e.response.form_errors);else $("[data-card-update-complete]").submit()}).fail(function(){$(".payment-errors").text("Something is wrong with the server. Please wait a moment and try again.")}).always(function(){$(".submit-button").removeAttr("disabled"),t.addClass("hide")})}).fail(function(e){$.publish("track_event",["pau-payment-info-change-error",{type:e.error.type,param:e.error.param?e.error.param:"no param",code:e.error.code?e.error.code:"no code"}]),t.addClass("hide")}),!1})},developer_enrollment_init:function(){$("#id_country").select2({width:"250px"})},discounted_user_creator:function(){$("body").on("click","[data-create-discounted-user]",function(){return $.ajax({url:window.location.href,type:"POST",data:{action:"add_discounted_code"},success:function(){window.location.reload()}}),!1})},submission_lockup:function(){$("body").on("click","[data-submit-for-approval]",function(){TAPP.lock_up($(this))})},init_app_feedback:function(){fdSlider.rescanDocument(),$(".feedback-widget").each(function(){var e=$(this);e.find(".notch").css({width:e.find(".fd-slider-range").css("width")})})},init_star_app_feedback:function(){var e=function(e){$.ajax({url:window.location.href,type:"POST",data:{action:"star_rating",rating:e}})};$("[data-star-rating]").each(function(){var t,n;t=$(this),n=t.data("target"),t.raty({cancel:!0,target:n,targetKeep:!0,targetType:"number",number:10,size:74,hintList:["","","","","","","","","",""],path:"/static/palama/images/",click:e})})},cancel_flow:function(){$("body").tapp_on("click","[data-cancel-account-btn], [data-resubscribe-btn]",function(){$(".user-settings .non-standalone").addClass("hide"),$(".user-settings .standalone").removeClass("hide"),$(this).is("[data-cancel-account-btn]")?$(".user-settings .standalone .are-you-sure-cancel").removeClass("hide"):$(".user-settings .standalone .resubscribe").removeClass("hide")}),$("body").tapp_on("click","[data-resubscribe-btn]",function(){})}});TAPP.settings_view=new e,TAPP.settings_view.register_post_load_hooks({settings_view_init:TAPP.settings_view.settings_view_init,payment_details_init:TAPP.settings_view.payment_details_init,developer_enrollment_init:TAPP.settings_view.developer_enrollment_init,submission_lockup:TAPP.settings_view.submission_lockup,init_app_feedback:TAPP.settings_view.init_app_feedback,init_star_app_feedback:TAPP.settings_view.init_star_app_feedback})}(),function(){var e=TAPP.Module.extend({init_developer:function(){this.edit_redirect_uris()},edit_redirect_uris:function(){var e,t,n,i;$("body").on("click","[data-remove-redirect-uri]",function(){var e,t,n;return e=$(this),t=e.data("remove-redirect-uri"),n=e.closest("li"),n.addClass("hide"),$.post(window.location.href,{action:"modify_redirect_uris",redirect_uri:t,app_id:page_context.app_id}).fail(function(){n.removeClass("hide"),TAPP.dialogs.error_dialog("Sorry we couldn't remove that Callback URL. Please wait a moment and try again.")}).done(function(){n.remove()}),!1}),e=$("[data-add-redirect-uri-input]"),t=$("[data-redirect-uris]"),n=function(e,t,n){e.remove(),t.val(n)},i=function(e){TAPP.dialogs.error_dialog(e+" is a duplicate Callback URL.")},$("body").on("click","[data-add-redirect-uri-button]",function(){var s,a,o,r,c;return s=$(this),a=TAPP.lock_up(s),o=$.trim(e.val()).toLowerCase(),""===o?(a(),!1):(r=!1,t.find("li a").each(function(){var e=$(this).data("remove-redirect-uri").toLowerCase();e===o&&(r=!0,i(o))}),r?(a(),!1):(c=$('<li><a href="#remove" data-remove-redirect-uri="'+o+'">&times;</a> '+o+"</li>"),t.append(c),e.val(""),$.post(window.location.href,{action:"modify_redirect_uris",redirect_uri:o,app_id:page_context.app_id,add:"1"}).always(a).fail(function(){n(c,e,o),TAPP.dialogs.error_dialog("Sorry we couldn't add that Callback URL. Please wait a moment and try again.")}).done(function(t){"error"===t.status&&(n(c,e,o),t.form_errors&&t.form_errors.redirect_uri&&i(o))}),!1))})},init_screenshots:function(){$("body").tapp_on("change","[data-image-upload] input[type=file]",function(){$(this).closest("form").submit()}),$("[data-image-upload]").tapp_on("submit",function(){var e,t,n;return e=$(this),t=e.data("replace"),n=$(e.data("asset-output")),e.ajaxSubmit({iframe:!0,resetForm:!0,url:""+window.location,dataType:"json",success:function(e){n.data("has-assets")||(t=!0),"ok"===e.status?(t?n.html(e.html):n.append(e.html),n.data("has-assets",!0)):TAPP.dialogs.error_dialog(e.msg)},error:function(){TAPP.dialogs.error_dialog(),e.resetForm()}}),!1}),$("body").tapp_on("click","[data-delete-asset]",function(){var e,t,n,i,s,a,o;return e=$(this),t=TAPP.lock_up(e),n=e.data("asset-id"),i=function(){var i=e.closest(".screenshot-container");i.hide(),$.ajax({type:"POST",url:""+window.location,data:{asset_id:n,action:"delete_image"}}).fail(function(){TAPP.dialogs.error_dialog(),i.show()}).done(function(){i.remove()}).always(function(){t()})},a={Cancel:{click:function(){s.remove(),t()}},Delete:{click:function(){return i(),s.remove(),!1},text:"Delete","class":"btn btn-danger"}},o={title:"<strong>Delete Screenshot</strong>",buttons:a},s=TAPP.dialogs.markup_dialog("Are you sure you want to delete this screenshot?",o),s.show(),!1})},init_markdown_preview:function(){var e,t,n,i,s;e=$("[data-markdown-widget]"),t=e.find("[data-markdown-widget-body]"),n=t.find("[data-markdown-preview]"),i=t.find("textarea"),s=function(){var e=i.val();n.html('<div class="loader"></div>'),$.post(window.location.href,{markdown:e,action:"markdown_preview"}).done(function(e){n.html(e)}).fail(function(){n.html(""),TAPP.dialogs.error()})},$("body").tapp_on("click","[data-markdown-toggle]",function(){return e.toggleClass("previewing").toggleClass("editing"),e.hasClass("previewing")&&s(),!1})},init_delete_page:function(){$("body").tapp_on("click","[data-delete-page]",function(){var e,t,n,i,s,a;return e=$(this),t=TAPP.lock_up(e),n=function(){$.ajax({type:"POST",url:window.location.href,data:{action:"delete_page"}}).fail(function(){TAPP.dialogs.error_dialog()}).done(function(e){window.location=e}).always(function(){t()})},s={Cancel:{click:function(){i.remove(),t()},"class":"btn-bold float-left"},Delete:{click:function(){return n(),i.remove(),!1},text:"Delete","class":"btn-bold danger"}},a={title:"<strong>Delete This Page</strong>",buttons:s},i=TAPP.dialogs.markup_dialog("Are you sure you want to delete this page?",a),i.show(),!1})}});TAPP.developer=new e,TAPP.developer.register_post_load_hooks({init_developer:TAPP.developer.init_developer,init_screenshots:TAPP.developer.init_screenshots,init_markdown_preview:TAPP.developer.init_markdown_preview,init_delete_page:TAPP.developer.init_delete_page})}(),$(document).ready(function(){var e=function(){var e=page_context.page_load_hooks;e&&($.isArray(page_context.page_load_hooks)||(e=[e]),$.each(page_context.page_load_hooks,function(e,t){var n,i,s;-1!==t.indexOf(".")?(n=t.split("."),i=TAPP,$.each(n,function(e,t){s=i,i=i[t]}),$.isFunction(i)&&i.call(s)):$.publish(t)}))};e(),$.publish("js_init_done"),$.subscribe("pjax.end",function(){TAPP.unload(),$.each(TAPP,function(){this&&this.unload&&this.unload()}),e()})});