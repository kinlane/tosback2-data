function get_img_url(a){return image_map[a]?page_context.autochrome_img_url_base+image_map[a]:(console.log("get_img_url failed for",a),!1)}var Sentry,fdSlider,image_map={"/static/palama/images/star-on.png":"/i/D/q/6/Dq6PaBeuPL3JUzxCRiEOt60V1Sk.png","/static/palama/images/cancel-off.png":"/i/3/f/m/3fm-Q5pPOAI6ZrWVqwF2aNzVNjU.png","/static/palama/images/cancel-on.png":"/i/8/H/N/8HNFGEFmaLV_JKPd3vEwBF38ADg.png","/static/palama/images/star-off.png":"/i/Y/a/V/YaVzbfSu6JBdhOMS58LxeTcgWfs.png"};typeof window.console=="undefined"&&(window.console={log:function(){return!0}}),typeof window.TAPP=="undefined"&&(window.TAPP={}),TAPP.jQuery=jQuery,$._ajax=$.ajax,$.ajax=function(a){var b=a.success;return a.success=function(a,c,d){var e=a&&a.result?a.result:null,f=a&&a.value?a.value:"ajax failed",g=a&&a.text?a.text:"ajax failed";if(e&&e!=="ok"){this.error&&this.error(d,f,g);return}b&&b.apply(this,[a,c,d])},$._ajax(a)},function(){var a="",b=$.browser.mozilla?a+=" mozilla":0,c=$.browser.msie?a+=" ie":0,d=$.browser.opera?a+=" opera":0,e=$.browser.chrome?a+=" chrome":0,f=$.browser.webkit?a+=" webkit":0,g=$.browser.version.replace(/\./g,"_");a+=" v"+g,$("html").addClass(a)}(),window.refresh_page_context=function(){var a,b=document.getElementById("adn-page-context");b&&(a=b.getAttribute("data-adn-page-context"),window.page_context=JSON.parse(a),b.parentNode.removeChild(b))},window.refresh_page_context(),function(a){a.authedAjax=function(b){var c,d,e,f,g,h,i,j={no_login_required:!1,user_action:!0};b=a.extend({},j,b),c=b.event_tracking,d=b.success||a.noop,e=b.error||a.noop,f=b.complete||a.noop,b.user_action&&(page_context.user_actions_complete=!1),g=function(a,c,g){a&&(d(c),b.user_action&&(page_context.user_actions_complete=!0)),a||e(c,g),f(c,g)},h=!page_context.is_authenticated&&!b.no_login_required;if(h){i=function(d){var e=d?c.name_for_success:c.name_for_failure,f=function(){d?a.authedAjax(b):g(!1,null,"authentication failed")};if(c){var h=_.map(a.makeArray(e),function(a){return[a,c.properties]});a.waitForFuncs(h,TAPP.event_tracking.fire_off_event,f)}else f()},TAPP.auth.start_login_process(i);return}page_context&&(page_context.auth_use_xdm?TAPP.wakea.send_to_provider("ajax",[b],g):a.ajax(b))}}(jQuery),function(){var a=$(window),b=function(){return a.width()<=480};TAPP.is_narrow=b(),a.on("resize",function(){TAPP.is_narrow=b()})}(),function(){TAPP.in_iframe=!1;try{top.location.href!==window.location.href&&(TAPP.in_iframe=!0)}catch(a){TAPP.in_iframe=!0}}(),function(){var a=[],b=[],c=[];$.fn.tapp_on=function(b,c,d,e){return a.push([this,b,c]),this.on(b,c,d,e)},$.tapp_subscribe=function(a,c){var d=$.subscribe(a,c);return b.push(d),d},TAPP.setInterval=function(a,b){var d=setInterval(a,b);return c.push(d),d},TAPP.clearInterval=function(a){$.map(c,function(b){return a===b?null:b})},TAPP.clear_event_handles=function(){$.each(a,function(a,b){$(b[0]).off(b[1],b[2])})},TAPP.clear_subscribe_handles=function(){$.each(b,function(a,b){$.unsubscribe(b)})},TAPP.clear_intervals=function(){$.each(c,function(){clearInterval(this)})},TAPP.unload=function(){TAPP.clear_event_handles(),TAPP.clear_subscribe_handles(),TAPP.clear_intervals()},TAPP.lock_up=function(a,b){var c,d;return b=b||"click",c=function(a){a.preventDefault(),a.stopImmediatePropagation()},d=a.on(b,c),function(){setTimeout(function(){a.off(b,c)},0)}}}(),function(){$.waitForFuncs=function(a,b,c){var d=[];$.each(a,function(a,c){var e=$.Deferred();d.push(e),c.push(function(){e.resolve()}),b.apply(this,c)}),$.when.apply(this,d).done(c)}}(),page_context&&page_context.br_page_name&&(window.BOOMR.init({beacon_url:"/s/boomerang",BW:{enabled:!1}}),window.BOOMR.addVar("page_name",page_context.br_page_name)),function(){TAPP.initialize_widget_code=function(){var a;if(page_context.environment==="dev"||page_context.environment==="sandbox")window.APP_NET_SETTINGS=page_context.widget_overrides;a={post_load_scripts:window.TAPP_CDN_JS_ASSETS,wakea_remote_url:"https://app.net/wakea/widget/",widget_base_url:"https://app.net/w/el/",data_attr_prefix:"data-an-"},TAPP.settings||(TAPP.settings=TAPP.jQuery.extend({},a,window.APP_NET_SETTINGS)),$.each(page_context.widget_post_load_urls,function(){$("<script />").attr({type:"text/javascript",src:this}).appendTo("body")})}}(),window.APPDOTNET=function(){var a={api_host:"api.app.net",url_base:"/stream/0/"},b={init:function(b){this.options=$.extend({},a,b),this.options.root_url="https://"+this.options.api_host+this.options.url_base;if(this.options.no_globals)try{delete window.APPDOTNET}catch(c){}return this},request:function(a,b){return b.url=this.options.root_url+a,$.ajax(b)},post:function(a,b){var c={type:"POST",data:{text:a}};return b&&(c.data.reply_to=b),this.request("posts",c)},follow:function(a,b){var c={data:{user_id:a}};if(b===1)c.type="POST";else if(b===0)c.type="DELETE";else throw"Invalid follow state.";return this.request("users/"+a+"/follow",c)},delete_post:function(a){var b={type:"DELETE"},c="posts/"+a;return this.request(c,b)},mute_user:function(a){var b={type:"POST"},c="users/"+a+"/mute";return this.request(c,b)},unmute_user:function(a){var b={type:"delete"},c="users/"+a+"/mute";return this.request(c,b)},star_post:function(a,b){var c={};if(b===1)c.type="POST";else if(b===0)c.type="DELETE";else throw"Invalid star state.";return this.request("posts/"+a+"/star",c)},repost_post:function(a,b){var c={};if(b===1)c.type="POST";else if(b===0)c.type="DELETE";else throw"Invalid repost state.";return this.request("posts/"+a+"/repost",c)}};return b}(),Sentry===undefined&&(Sentry={}),function(){var a;Sentry.client={},a=Sentry.client,Sentry.client.loaded=!1,Sentry.client.options={site:page_context&&page_context.environment?page_context.environment:"prod"},Sentry.client.parseUrl=function(a){var b=a.split("?"),c=b[1];return{url:b[0],querystring:b[1]}},Sentry.client.process=function(b){var c,d,e,f;b.project=a.options.projectId,b.logger=a.options.logger,b.site=a.options.site,c=["authenticated_user_id","build_info","canvas_mode"],d={};if(window.page_context)for(e in c)f=c[e],window.page_context[f]&&(d[f]=page_context[f]);b.extra=d,b.extra.user_agent=navigator.userAgent,b.extra.referrer=document.referrer?document.referrer:"n/a",console.log("window error",b),$.ajax({type:"POST",url:"/_jserror/",data:{message:JSON.stringify(b)}})},Sentry.client.parseTraceback=function(a){var b,c,d,e,f,g=[],h=a.split("\n");for(b=1;c=h[b];b++)d=c.split(":"),e=d.slice(-2)[0],f=d.slice(0,-2).join(":").split(" at ")[1],g.push({lineno:e,filename:f,module:"unknown","function":"unknown"});return g},Sentry.client.captureException=function(b){var c,d,e,f,g,h,i,j=window.location.href;b.line?c=b.line:b.lineNumber&&(c=b.lineNumber),b.sourceURL?f=b.sourceURL:b.fileName&&(f=b.fileName);if(b.stack)try{d=a.parseTraceback(b.stack)}catch(k){}g=a.parseUrl(j),h=b.toString(),c&&(h=h+" at "+c),d?(e={frames:d},f=d[0].filename):f&&(e={frames:[{filename:f,lineno:c,module:"unknown","function":"unknown"}]}),i={message:h,culprit:f||undefined,"sentry.interfaces.Stacktrace":e||undefined,"sentry.interfaces.Exception":{type:b.name,value:b.message},"sentry.interfaces.Http":{url:g.url,querystring:g.querystring}},a.process(i)},Sentry.client.registerGlobalHandler=function(){Sentry.client.handled_global_error=!1,window.onerror=function(b,c,d,e){var f,g,h,i,j,k;if(Sentry.client.handled_global_error)return!0;h=window.location.href,i=a.parseUrl(h),typeof b=="object"&&(g=b.name,b=b.message);if(b.toLowerCase().indexOf("script error")!==-1)return!1;Sentry.client.handled_global_error=!0,j=d?b+" at "+d:b,e?(f={frames:e},c=c||e[0].filename):c&&(f={frames:[{filename:c,lineno:d}]}),k={message:j,culprit:c,"sentry.interfaces.Stacktrace":f,"sentry.interfaces.Exception":{type:g,value:b},"sentry.interfaces.Http":{url:i.url,querystring:i.querystring}},a.process(k)}},Sentry.client.registerGlobalHandler()}(),function(a){var b,c,d;a.fn.pjax=function(b,c){c?c.container=b:c=a.isPlainObject(b)?b:{container:b};if(c.container&&typeof c.container!="string")throw"pjax container must be a string selector!";return this.live("click",function(b){var d;if(b.which>1||b.metaKey)return!0;d={url:this.href,container:a(this).attr("data-pjax"),clickedElement:a(this),fragment:null},a.pjax(a.extend({},d,c)),b.preventDefault()})},b=a.pjax=function(c){var d=a(c.container),e=c.success||a.noop;delete c.success;if(typeof c.container!="string")throw"pjax container must be a string selector!";c=a.extend(!0,{},b.defaults,c),a.isFunction(c.url)&&(c.url=c.url()),c.context=d,c.success=function(d,f,g){var h=g.getResponseHeader("X-Build-Info"),i;if(h&&h!==page_context.build_info)return window.location=c.url;if(c.fragment){i=a(d).find(c.fragment);if(i.length)d=i.children();else return window.location=c.url}else if(!a.trim(d)||/<html/i.test(d))return window.location=c.url;this.html(d),window.refresh_page_context();var j=document.title,k=a.trim(this.find("title").remove().text());k&&(document.title=k),i&&!k&&c.fragment&&(k=i.attr("title")||i.data("title"));var l={pjax:c.container,fragment:c.fragment,timeout:c.timeout},m=a.param(c.data);m!=="_pjax=true"&&(l.url=c.url+(/\?/.test(c.url)?"&":"?")+m),c.replace?window.history.replaceState(l,document.title,c.url):c.push&&(b.active||(window.history.replaceState(a.extend({},l,{url:null}),j),b.active=!0),window.history.pushState(l,document.title,c.url)),(c.replace||c.push)&&window._gaq&&_gaq.push(["_trackPageview"]);var n=window.location.hash.toString();n!==""&&(window.location.href=n),e.apply(this,arguments)};var f=b.xhr;return f&&f.readyState<4&&(f.onreadystatechange=a.noop,f.abort()),b.options=c,b.xhr=a.ajax(c),a(document).trigger("pjax",[b.xhr,c]),b.xhr},b.defaults={timeout:650,push:!0,replace:!1,data:{_pjax:!0},type:"GET",dataType:"html",beforeSend:function(c){this.trigger("pjax:start",[c,b.options]),this.trigger("start.pjax",[c,b.options]),a.publish("pjax.start"),c.setRequestHeader("X-PJAX","true")},error:function(a,c){c!=="abort"&&(window.location=b.options.url)},complete:function(c){this.trigger("pjax:end",[c,b.options]),this.trigger("end.pjax",[c,b.options]),a.publish("pjax.end")}},c="state"in window.history,d=location.href,(page_context.canvas_mode==="mobile"||page_context.canvas_mode==="pau")&&a(window).bind("popstate",function(b){var e,f,g=!c&&location.href===d;c=!0;if(g)return;e=b.state,e&&e.pjax&&(f=e.pjax,a(f+"").length?a.pjax({url:e.url||location.href,fragment:e.fragment,container:f,push:!1,timeout:e.timeout,success:function(){a.publish("pjax-popstate",[e])}}):window.location=location.href)}),a.inArray("state",a.event.props)<0&&a.event.props.push("state"),a.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/(WebApps\/[\w\d-_]+CFNetwork)/)&&(!TAPP.in_frame||!a.browser.webkit),a.support.pjax||(a.pjax=function(b){window.location=a.isFunction(b.url)?b.url():b.url},a.fn.pjax=function(){return this})}(jQuery),function(a){function b(){var b;a.fn.ajaxSubmit.debug&&(b="[jquery.form] "+Array.prototype.join.call(arguments,""),window.console&&window.console.log?window.console.log(b):window.opera&&window.opera.postError&&window.opera.postError(b))}a.fn.ajaxSubmit=function(c){function r(){function w(){var b,c,f=l.attr("target"),i=l.attr("action");v.setAttribute("target",e),v.getAttribute("method")!="POST"&&v.setAttribute("method","POST"),v.getAttribute("action")!=d.url&&v.setAttribute("action",d.url),d.skipEncodingOverride||l.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),d.timeout&&(m=setTimeout(function(){k=!0,x(!0)},d.timeout)),b=[];try{if(d.extraData)for(c in d.extraData)b.push(a('<input type="hidden" name="'+c+'" value="'+d.extraData[c]+'" />').appendTo(v)[0]);g.appendTo("body"),h.attachEvent?h.attachEvent("onload",x):h.addEventListener("load",x,!1),v.submit()}finally{v.setAttribute("action",i),f?v.setAttribute("target",f):l.removeAttr("target"),a(b).remove()}}function x(c){var e,f,l,n,o,t,v;if(i.aborted||r)return;if(c===!0&&i){i.abort("timeout");return}e=h.contentWindow?h.contentWindow.document:h.contentDocument?h.contentDocument:h.document;if(!e||e.location.href==d.iframeSrc)if(!k)return;h.detachEvent?h.detachEvent("onload",x):h.removeEventListener("load",x,!1),f=!0;try{if(k)throw"timeout";l=d.dataType=="xml"||e.XMLDocument||a.isXMLDoc(e),b("isXml="+l);if(!l&&window.opera&&(e.body==null||e.body.innerHTML=="")&&--q){b("requeing onLoad callback, DOM not available"),setTimeout(x,250);return}i.responseText=e.body?e.body.innerHTML:e.documentElement?e.documentElement.innerHTML:null,i.responseXML=e.XMLDocument?e.XMLDocument:e,l&&(d.dataType="xml"),i.getResponseHeader=function(a){var b={"content-type":d.dataType};return b[a]},n=/(json|script|text)/.test(d.dataType),n||d.textarea?(o=e.getElementsByTagName("textarea")[0],o?i.responseText=o.value:n&&(t=e.getElementsByTagName("pre")[0],v=e.getElementsByTagName("body")[0],t?i.responseText=t.textContent:v&&(i.responseText=v.innerHTML))):d.dataType=="xml"&&!i.responseXML&&i.responseText!=null&&(i.responseXML=s(i.responseText)),p=u(i,d.dataType,d)}catch(c){b("error caught:",c),f=!1,i.error=c,d.error&&d.error.call(d.context,i,"error",c),j&&a.event.trigger("ajaxError",[i,d,c])}i.aborted&&(b("upload aborted"),f=!1),f&&(d.success&&d.success.call(d.context,p,"success",i),j&&a.event.trigger("ajaxSuccess",[i,d])),j&&a.event.trigger("ajaxComplete",[i,d]),j&&!--a.active&&a.event.trigger("ajaxStop"),d.complete&&d.complete.call(d.context,i,f?"success":"error"),r=!0,d.timeout&&clearTimeout(m),setTimeout(function(){g.removeData("form-plugin-onload"),g.remove(),i.responseXML=null},100)}var d,e,f,g,h,i,j,k,m,n,o,p,q,r,s,t,u,v=l[0];if(a(":input[name=submit],:input[id=submit]",v).length){alert('Error: Form elements must not have name or id of "submit".');return}d=a.extend(!0,{},a.ajaxSettings,c),d.context=d.context||d,e="jqFormIO"+(new Date).getTime(),f="_"+e,g=a('<iframe id="'+e+'" name="'+e+'" src="'+d.iframeSrc+'" />'),h=g[0],g.css({position:"absolute",top:"-1000px",left:"-1000px"}),i={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(c){var e=c==="timeout"?"timeout":"aborted";b("aborting upload... "+e),this.aborted=1,g.attr("src",d.iframeSrc),i.error=e,d.error&&d.error.call(d.context,i,e,e),j&&a.event.trigger("ajaxError",[i,d,e]),d.complete&&d.complete.call(d.context,i,e)}},j=d.global,j&&!(a.active++)&&a.event.trigger("ajaxStart"),j&&a.event.trigger("ajaxSend",[i,d]);if(d.beforeSend&&d.beforeSend.call(d.context,i,d)===!1){d.global&&a.active--;return}if(i.aborted)return;k=0,n=v.clk,n&&(o=n.name,o&&!n.disabled&&(d.extraData=d.extraData||{},d.extraData[o]=n.value,n.type=="image"&&(d.extraData[o+".x"]=v.clk_x,d.extraData[o+".y"]=v.clk_y))),d.forceSync?w():setTimeout(w,10),q=50,s=a.parseXML||function(a,b){return window.ActiveXObject?(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml"),b&&b.documentElement&&b.documentElement.nodeName!="parsererror"?b:null},t=a.parseJSON||function(a){return window.eval("("+a+")")},u=function(b,c,d){var e=b.getResponseHeader("content-type")||"",f=c==="xml"||!c&&e.indexOf("xml")>=0,g=f?b.responseXML:b.responseText;return f&&g.documentElement.nodeName==="parsererror"&&a.error&&a.error("parsererror"),d&&d.dataFilter&&(g=d.dataFilter(g,c)),typeof g=="string"&&(c==="json"||!c&&e.indexOf("json")>=0?g=t(g):(c==="script"||!c&&e.indexOf("javascript")>=0)&&a.globalEval(g)),g}}var d,e,f,g,h,i,j,k,l,m,n,o,p,q;if(!this.length)return b("ajaxSubmit: skipping submit process - no element selected"),this;typeof c=="function"&&(c={success:c}),d=this.attr("action"),e=typeof d=="string"?a.trim(d):"",e&&(e=(e.match(/^([^#]+)/)||[])[1]),e=e||window.location.href||"",c=a.extend(!0,{url:e,success:a.ajaxSettings.success,type:this[0].getAttribute("method")||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},c),f={},this.trigger("form-pre-serialize",[this,c,f]);if(f.veto)return b("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(c.beforeSerialize&&c.beforeSerialize(this,c)===!1)return b("ajaxSubmit: submit aborted via beforeSerialize callback"),this;i=this.formToArray(c.semantic);if(c.data){c.extraData=c.data;for(g in c.data)if(c.data[g]instanceof Array)for(j in c.data[g])i.push({name:g,value:c.data[g][j]});else h=c.data[g],h=a.isFunction(h)?h():h,i.push({name:g,value:h})}return c.beforeSubmit&&c.beforeSubmit(i,this,c)===!1?(b("ajaxSubmit: submit aborted via beforeSubmit callback"),this):(this.trigger("form-submit-validate",[i,this,c,f]),f.veto?(b("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this):(k=a.param(i),c.type.toUpperCase()=="GET"?(c.url+=(c.url.indexOf("?")>=0?"&":"?")+k,c.data=null):c.data=k,l=this,m=[],c.resetForm&&m.push(function(){l.resetForm()}),c.clearForm&&m.push(function(){l.clearForm()}),!c.dataType&&c.target?(n=c.success||function(){},m.push(function(b){var d=c.replaceTarget?"replaceWith":"html";a(c.target)[d](b).each(n,arguments)})):c.success&&m.push(c.success),c.success=function(a,b,d){var e,f,g=c.context||c;for(e=0,f=m.length;e<f;e++)m[e].apply(g,[a,b,d||l,l])},o=a("input:file",this).length>0,p="multipart/form-data",q=l.attr("enctype")==p||l.attr("encoding")==p,c.iframe!==!1&&(o||c.iframe||q)?c.closeKeepAlive?a.get(c.closeKeepAlive,r):r():a.ajax(c),this.trigger("form-submit-notify",[this,c]),this))},a.fn.ajaxForm=function(c){var d;return this.length===0?(d={s:this.selector,c:this.context},!a.isReady&&d.s?(b("DOM not ready, queuing ajaxForm"),a(function(){a(d.s,d.c).ajaxForm(c)}),this):(b("terminating; zero elements found by selector"+(a.isReady?"":" (DOM not ready)")),this)):this.ajaxFormUnbind().bind("submit.form-plugin",function(b){b.isDefaultPrevented()||(b.preventDefault(),a(this).ajaxSubmit(c))}).bind("click.form-plugin",function(b){var c,d,e,f=b.target,g=a(f);if(!g.is(":submit,input:image")){c=g.closest(":submit");if(c.length==0)return;f=c[0]}d=this,d.clk=f,f.type=="image"&&(b.offsetX!=undefined?(d.clk_x=b.offsetX,d.clk_y=b.offsetY):typeof a.fn.offset=="function"?(e=g.offset(),d.clk_x=b.pageX-e.left,d.clk_y=b.pageY-e.top):(d.clk_x=b.pageX-f.offsetLeft,d.clk_y=b.pageY-f.offsetTop)),setTimeout(function(){d.clk=d.clk_x=d.clk_y=null},100)})},a.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},a.fn.formToArray=function(b){var c,d,e,f,g,h,i,j,k,l,m,n=[];if(this.length===0)return n;c=this[0],d=b?c.getElementsByTagName("*"):c.elements;if(!d)return n;for(e=0,j=d.length;e<j;e++){i=d[e],g=i.name;if(!g)continue;if(b&&c.clk&&i.type=="image"){!i.disabled&&c.clk==i&&(n.push({name:g,value:a(i).val()}),n.push({name:g+".x",value:c.clk_x},{name:g+".y",value:c.clk_y}));continue}h=a.fieldValue(i,!0);if(h&&h.constructor==Array)for(f=0,k=h.length;f<k;f++)n.push({name:g,value:h[f]});else h!==null&&typeof h!="undefined"&&n.push({name:g,value:h})}return!b&&c.clk&&(l=a(c.clk),m=l[0],g=m.name,g&&!m.disabled&&m.type=="image"&&(n.push({name:g,value:l.val()}),n.push({name:g+".x",value:c.clk_x},{name:g+".y",value:c.clk_y}))),n},a.fn.formSerialize=function(b){return a.param(this.formToArray(b))},a.fn.fieldSerialize=function(b){var c=[];return this.each(function(){var d,e,f,g=this.name;if(!g)return;d=a.fieldValue(this,b);if(d&&d.constructor==Array)for(e=0,f=d.length;e<f;e++)c.push({name:g,value:d[e]});else d!==null&&typeof d!="undefined"&&c.push({name:this.name,value:d})}),a.param(c)},a.fn.fieldValue=function(b){var c,d,e,f,g;for(c=[],d=0,e=this.length;d<e;d++){f=this[d],g=a.fieldValue(f,b);if(g===null||typeof g=="undefined"||g.constructor==Array&&!g.length)continue;g.constructor==Array?a.merge(c,g):c.push(g)}return c},a.fieldValue=function(b,c){var d,e,f,g,h,i,j,k,l=b.name,m=b.type,n=b.tagName.toLowerCase();c===undefined&&(c=!0);if(c&&(!l||b.disabled||m=="reset"||m=="button"||(m=="checkbox"||m=="radio")&&!b.checked||(m=="submit"||m=="image")&&b.form&&b.form.clk!=b||n=="select"&&b.selectedIndex==-1))return null;if(n=="select"){d=b.selectedIndex;if(d<0)return null;e=[],f=b.options,g=m=="select-one",h=g?d+1:f.length;for(i=g?d:0;i<h;i++){j=f[i];if(j.selected){k=j.value,k||(k=j.attributes&&j.attributes.value&&!j.attributes.value.specified?j.text:j.value);if(g)return k;e.push(k)}}return e}return a(b).val()},a.fn.clearForm=function(){return this.each(function(){a("input,select,textarea",this).clearFields()})},a.fn.clearFields=a.fn.clearInputs=function(){return this.each(function(){var a=this.type,b=this.tagName.toLowerCase();a=="text"||a=="password"||b=="textarea"?this.value="":a=="checkbox"||a=="radio"?this.checked=!1:b=="select"&&(this.selectedIndex=-1)})},a.fn.resetForm=function(){return this.each(function(){(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)&&this.reset()})},a.fn.enable=function(a){return a===undefined&&(a=!0),this.each(function(){this.disabled=!a})},a.fn.selected=function(b){return b===undefined&&(b=!0),this.each(function(){var c,d=this.type;d=="checkbox"||d=="radio"?this.checked=b:this.tagName.toLowerCase()=="option"&&(c=a(this).parent("select"),b&&c[0]&&c[0].type=="select-one"&&c.find("option").selected(!1),this.selected=b)})}}(jQuery),!function(a){function d(){a(b).parent().removeClass("open")}var b='[data-toggle="dropdown"]',c=function(b){var c=a(b).on("click.dropdown.data-api",this.toggle);a("html").on("click.dropdown.data-api",function(){c.parent().removeClass("open")})};"use strict",c.prototype={constructor:c,toggle:function(){var b,c,e,f=a(this);if(f.is(".disabled, :disabled"))return;return c=f.attr("data-target"),c||(c=f.attr("href"),c=c&&c.replace(/.*(?=#[^\s]*$)/,"")),b=a(c),b.length||(b=f.parent()),e=b.hasClass("open"),d(),e||b.toggleClass("open"),!1}},a.fn.dropdown=function(b){return this.each(function(){var d=a(this),e=d.data("dropdown");e||d.data("dropdown",e=new c(this)),typeof b=="string"&&e[b].call(d)})},a.fn.dropdown.Constructor=c,a(function(){a("html").on("click.dropdown.data-api",d),a("body").on("click.dropdown",".dropdown form",function(a){a.stopPropagation()}).on("click.dropdown.data-api",b,c.prototype.toggle)})}(window.jQuery),!function(a){var b=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.typeahead.defaults,c),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.$menu=a(this.options.menu).appendTo("body"),this.source=this.options.source,this.shown=!1,this.listen()};"use strict",b.prototype={constructor:b,select:function(){var a=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(a)).change(),this.hide()},updater:function(a){return a},show:function(){var b=a.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});return this.$menu.css({top:b.top+b.height,left:b.left}),this.$menu.show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(){var b;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(b=a.isFunction(this.source)?this.source(this.query,a.proxy(this.process,this)):this.source,b?this.process(b):this)},process:function(b){var c=this;return b=a.grep(b,function(a){return c.matcher(a)}),b=this.sorter(b),b.length?this.render(b.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(a){return~a.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(a){var b,c=[],d=[],e=[];while(b=a.shift())b.toLowerCase().indexOf(this.query.toLowerCase())?~b.indexOf(this.query)?d.push(b):e.push(b):c.push(b);return c.concat(d,e)},highlighter:function(a){var b=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return a.replace(new RegExp("("+b+")","ig"),function(a,b){return"<strong>"+b+"</strong>"})},render:function(b){var c=this;return b=a(b).map(function(b,d){return b=a(c.options.item).attr("data-value",d),b.find("a").html(c.highlighter(d)),b[0]}),b.first().addClass("active"),this.$menu.html(b),this},next:function(){var b=this.$menu.find(".active").removeClass("active"),c=b.next();c.length||(c=a(this.$menu.find("li")[0])),c.addClass("active")},prev:function(){var a=this.$menu.find(".active").removeClass("active"),b=a.prev();b.length||(b=this.$menu.find("li").last()),b.addClass("active")},listen:function(){this.$element.on("blur",a.proxy(this.blur,this)).on("keypress",a.proxy(this.keypress,this)).on("keyup",a.proxy(this.keyup,this)),(a.browser.chrome||a.browser.webkit||a.browser.msie)&&this.$element.on("keydown",a.proxy(this.keydown,this)),this.$menu.on("click",a.proxy(this.click,this)).on("mouseenter","li",a.proxy(this.mouseenter,this))},move:function(a){if(!this.shown)return;switch(a.keyCode){case 9:case 13:case 27:a.preventDefault();break;case 38:a.preventDefault(),this.prev();break;case 40:a.preventDefault(),this.next()}a.stopPropagation()},keydown:function(b){this.suppressKeyPressRepeat=!~a.inArray(b.keyCode,[40,38,9,13,27]),this.move(b)},keypress:function(a){if(this.suppressKeyPressRepeat)return;this.move(a)},keyup:function(a){switch(a.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}a.stopPropagation(),a.preventDefault()},blur:function(){var a=this;setTimeout(function(){a.hide()},150)},click:function(a){a.stopPropagation(),a.preventDefault(),this.select()},mouseenter:function(b){this.$menu.find(".active").removeClass("active"),a(b.currentTarget).addClass("active")}},a.fn.typeahead=function(c){return this.each(function(){var d=a(this),e=d.data("typeahead"),f=typeof c=="object"&&c;e||d.data("typeahead",e=new b(this,f)),typeof c=="string"&&e[c]()})},a.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},a.fn.typeahead.Constructor=b,a(function(){a("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(b){var c=a(this);if(c.data("typeahead"))return;b.preventDefault(),c.typeahead(c.data())})})}(window.jQuery),function(a){function d(b){var c={},d=/^jQuery\d+$/;return a.each(b.attributes,function(a,b){b.specified&&!d.test(b.name)&&(c[b.name]=b.value)}),c}function e(){var b=a(this);b.val()===b.attr("placeholder")&&b.hasClass("placeholder")&&(b.data("placeholder-password")?b.hide().next().attr("id",b.removeAttr("id").data("placeholder-id")).show().focus():b.val("").removeClass("placeholder"))}function f(){var b,c=a(this),f=c,g=this.id;if(c.val()===""){if(c.is(":password")){if(!c.data("placeholder-textinput")){try{b=c.clone().attr({type:"text"})}catch(h){b=a("<input>").attr(a.extend(d(this),{type:"text"}))}b.removeAttr("name").data("placeholder-password",!0).data("placeholder-id",g).bind("focus.placeholder",e),c.data("placeholder-textinput",b).data("placeholder-id",g).before(b)}c=c.removeAttr("id").hide().prev().attr("id",g).show()}c.addClass("placeholder").val(c.attr("placeholder"))}else c.removeClass("placeholder")}var b="placeholder"in document.createElement("input"),c="placeholder"in document.createElement("textarea");b&&c?(a.fn.placeholder=function(){return this},a.fn.placeholder.input=a.fn.placeholder.textarea=!0):(a.fn.placeholder=function(){return this.filter((b?"textarea":":input")+"[placeholder]").bind("focus.placeholder",e).bind("blur.placeholder",f).trigger("blur.placeholder").end()},a.fn.placeholder.input=b,a.fn.placeholder.textarea=c),a(function(){a("form").bind("submit.placeholder",function(){var b=a(".placeholder",this).each(e);setTimeout(function(){b.each(f)},10)})}),a(window).bind("unload.placeholder",function(){a(".placeholder").val("")})}(jQuery),function(a){typeof a.fn.each2=="undefined"&&a.fn.extend({each2:function(b){var c=a([0]),d=-1,e=this.length;while(++d<e&&(c.context=c[0]=this[d])&&b.call(c[0],d,c)!==!1);return this}})}(jQuery),function(a,b){function i(a,b){var c,d=0,e=b.length;if(typeof a=="undefined")return-1;if(a.constructor===String){for(;d<e;d+=1)if(a.localeCompare(b[d])===0)return d}else for(;d<e;d+=1){c=b[d];if(c.constructor===String){if(c.localeCompare(a)===0)return d}else if(c===a)return d}return-1}function j(a,c){return a===c?!0:a===b||c===b?!1:a===null||c===null?!1:a.constructor===String?a.localeCompare(c)===0:c.constructor===String?c.localeCompare(a)===0:!1}function k(b,c){var d,e,f;if(b===null||b.length<1)return[];d=b.split(c);for(e=0,f=d.length;e<f;e+=1)d[e]=a.trim(d[e]);return d}function l(a){return a.outerWidth()-a.width()}function m(a){a.bind("keydown",function(){a.data("keyup-change-value",a.val())}),a.bind("keyup",function(){a.val()!==a.data("keyup-change-value")&&a.trigger("keyup-change")})}function n(c){c.bind("mousemove",function(c){var d=a(document).data("select2-lastpos");(d===b||d.x!==c.pageX||d.y!==c.pageY)&&a(c.target).trigger("mousemove-filtered",c)})}function o(a,b){var c;return function(){window.clearTimeout(c),c=window.setTimeout(b,a)}}function p(a,b){var c=o(a,function(a){b.trigger("scroll-debounced",a)});b.bind("scroll",function(a){i(a.target,b.get())>=0&&c(a)})}function q(a){a.preventDefault(),a.stopPropagation()}function r(b){var c;return h||(c=b[0].currentStyle||window.getComputedStyle(b[0],null),h=a("<div></div>").css({position:"absolute",left:"-1000px",top:"-1000px",display:"none",fontSize:c.fontSize,fontFamily:c.fontFamily,fontStyle:c.fontStyle,fontWeight:c.fontWeight,letterSpacing:c.letterSpacing,textTransform:c.textTransform,whiteSpace:"nowrap"}),a("body").append(h)),h.text(b.val()),h.width()}function s(a,b,c){var d=a.toUpperCase().indexOf(b.toUpperCase()),e=b.length;if(d<0){c.push(a);return}c.push(a.substring(0,d)),c.push("<span class='select2-match'>"),c.push(a.substring(d,d+e)),c.push("</span>"),c.push(a.substring(d+e,a.length))}function t(b){var c,d=0,e=null,f=b.quietMillis||100;return function(g){window.clearTimeout(c),c=window.setTimeout(function(){var c,f,h,i;d+=1,c=d,f=b.data,h=b.transport||a.ajax,i=b.type||"GET",f=f.call(this,g.term,g.page,g.context),null!==e&&e.abort(),e=h.call(null,{url:b.url,dataType:b.dataType,data:f,type:i,success:function(a){var e;if(c<d)return;e=b.results(a,g.page),g.callback(e)}})},f)}}function u(b){var c,d=b,e=function(a){return""+a.text};return a.isArray(d)||(e=d.text,a.isFunction(e)||(c=d.text,e=function(a){return a[c]}),d=d.results),function(b){var c=b.term,f={};if(c===""){b.callback({results:d});return}f.results=a(d).filter(function(){return b.matcher(c,e(this))}).get(),b.callback(f)}}function v(c){return a.isFunction(c)?c:function(d){var e=d.term,f={results:[]};a(c).each(function(){var a=this.text!==b,c=a?this.text:this;(e===""||d.matcher(e,c))&&f.results.push(a?this:{id:this,text:this})}),d.callback(f)}}function w(b){return a.isFunction(b)?b():b}function x(b,c){var d=function(){};return d.prototype=new b,d.prototype.constructor=d,d.prototype.parent=b.prototype,d.prototype=a.extend(d.prototype,c),d}var c,d,e,f,g,h;"use strict";if(window.Select2!==b)return;c={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(a){a=a.which?a.which:a;switch(a){case c.LEFT:case c.RIGHT:case c.UP:case c.DOWN:return!0}return!1},isControl:function(a){a=a.which?a.which:a;switch(a){case c.SHIFT:case c.CTRL:case c.ALT:return!0}return a.metaKey?!0:!1},isFunctionKey:function(a){return a=a.which?a.which:a,a>=112&&a<=123}},g=function(){var a=1;return function(){return a++}}(),a(document).delegate("*","mousemove",function(b){a(document).data("select2-lastpos",{x:b.pageX,y:b.pageY})}),a(document).ready(function(){a(document).delegate("*","mousedown focusin touchend",function(b){var c=a(b.target).closest("div.select2-container").get(0);c?a(document).find("div.select2-container-active").each(function(){this!==c&&a(this).data("select2").blur()}):(c=a(b.target).closest("div.select2-drop").get(0),a(document).find("div.select2-drop-active").each(function(){this!==c&&a(this).data("select2").blur()}))})}),d=x(Object,{bind:function(a){var b=this;return function(){a.apply(b,arguments)}},init:function(c){var d,e,f=".select2-results";this.opts=c=this.prepareOpts(c),this.id=c.id,c.element.data("select2")!==b&&c.element.data("select2")!==null&&this.destroy(),this.enabled=!0,this.container=this.createContainer(),this.body=c.element.closest("body"),c.element.attr("class")!==b&&this.container.addClass(c.element.attr("class")),this.container.css(w(c.containerCss)),this.container.addClass(w(c.containerCssClass)),this.opts.element.data("select2",this).hide().after(this.container),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),this.dropdown.css(w(c.dropdownCss)),this.dropdown.addClass(w(c.dropdownCssClass)),this.dropdown.data("select2"
,this),this.results=d=this.container.find(f),this.search=e=this.container.find("input.select2-input"),this.resultsPage=0,this.context=null,this.initContainer(),n(this.results),this.dropdown.delegate(f,"mousemove-filtered",this.bind(this.highlightUnderEvent)),p(80,this.results),this.dropdown.delegate(f,"scroll-debounced",this.bind(this.loadMoreIfNeeded)),a.fn.mousewheel&&d.mousewheel(function(a,b,c,e){var f=d.scrollTop();e>0&&f-e<=0?(d.scrollTop(0),q(a)):e<0&&d.get(0).scrollHeight-d.scrollTop()+e<=d.height()&&(d.scrollTop(d.get(0).scrollHeight-d.height()),q(a))}),m(e),e.bind("keyup-change",this.bind(this.updateResults)),e.bind("focus",function(){e.addClass("select2-focused"),e.val()===" "&&e.val("")}),e.bind("blur",function(){e.removeClass("select2-focused")}),this.dropdown.delegate(f,"click",this.bind(function(b){a(b.target).closest(".select2-result-selectable:not(.select2-disabled)").length>0?(this.highlightUnderEvent(b),this.selectHighlighted(b)):(q(b),this.focusSearch())})),a.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),c.element.is(":disabled")&&this.disable()},destroy:function(){var a=this.opts.element.data("select2");a!==b&&(a.container.remove(),a.dropdown.remove(),a.opts.element.removeData("select2").unbind(".select2").show())},prepareOpts:function(c){var d,e,f=c.element;f.get(0).tagName.toLowerCase()==="select"&&(this.select=d=c.element),d&&a.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in c)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),c=a.extend({},{containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",populateResults:function(d,e,f){var h,i,j={},k=[],l=this.opts.id,m=function(a,d){var e,h,n,o,p,q;for(e=0,h=a.length;e<h;e+=1)o=a[e],p=l(o)!==b,q="children"in o&&o.children.length>0,k.push("<li class='select2-result-depth-"+d),k.push(" select2-result"),k.push(p?" select2-result-selectable":" select2-result-unselectable"),q&&k.push(" select2-result-with-children"),k.push("'"),n=g(),k.push(" id='select2-result-"+n+"'"),j[n]=o,k.push("><div class='select2-result-label'>"),i=c.formatResult(o,f,k),i!==b&&k.push(i),k.push("</div>"),q&&(k.push("<ul class='select2-result-sub'>"),m(o.children,d+1),k.push("</ul>")),k.push("</li>")};m(e,0),d.append(k.join(""));for(h in j)a("#select2-result-"+h,d).data("select2-data",j[h])},formatResult:function(a,b,c){s(a.text,b.term,c)},formatSelection:function(a){return a.fullText||a.text},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(a,b){return"Please enter "+(b-a.length)+" more characters"},formatLoadMore:function(){return"Loading more results..."},minimumResultsForSearch:0,minimumInputLength:0,id:function(a){return a.id},matcher:function(a,b){return b.toUpperCase().indexOf(a.toUpperCase())>=0}},c),typeof c.id!="function"&&(e=c.id,c.id=function(a){return a[e]}),d?(c.query=this.bind(function(c){var d,e={results:[],more:!1},g=c.term,h=function(a,b){var d;a.is("option")?c.matcher(g,a.text())&&b.push({id:a.attr("value"),text:a.text(),element:a.get()}):a.is("optgroup")&&(d={text:a.attr("label"),children:[],element:a.get()},a.children().each2(function(a,b){h(b,d.children)}),d.children.length>0&&b.push(d))},i=f.children();this.getPlaceholder()!==b&&i.length>0&&(d=i[0],a(d).text()===""&&(i=i.not(d))),i.each2(function(a,b){h(b,e.results)}),c.callback(e)}),c.id=function(a){return a.id}):"query"in c||("ajax"in c?c.query=t(c.ajax):"data"in c?c.query=u(c.data):"tags"in c&&(c.query=v(c.tags),c.createSearchChoice=function(a){return{id:a,text:a}},c.initSelection=function(b,c){var d=[];a(k(b.val(),",")).each(function(){d.push({id:this,text:this})}),c(d)}));if(typeof c.query!="function")throw"query function not defined for Select2 "+c.element.attr("id");return c},monitorSource:function(){this.opts.element.bind("change.select2",this.bind(function(){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()}))},triggerChange:function(b){b=b||{},b=a.extend({},b,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(b),this.opts.element.data("select2-change-triggered",!1)},enable:function(){if(this.enabled)return;this.enabled=!0,this.container.removeClass("select2-container-disabled")},disable:function(){if(!this.enabled)return;this.close(),this.enabled=!1,this.container.addClass("select2-container-disabled")},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var a,b,c=this.container.offset(),d=this.container.outerHeight(),e=this.container.outerWidth(),f=this.dropdown.outerHeight(),g=document.body.scrollTop+document.documentElement.clientHeight,h=c.top+d,i=h+f<=g,j=c.top-f>=document.body.scrollTop,k=this.dropdown.hasClass("select2-drop-above");k?(a=!0,!j&&i&&(a=!1)):(a=!1,!i&&j&&(a=!0)),a?(h=c.top-f,this.container.addClass("select2-drop-above"),this.dropdown.addClass("select2-drop-above")):(this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")),b={top:h,left:c.left,width:e},this.dropdown.css(b)},shouldOpen:function(){var a;return this.opened()?!1:(a=jQuery.Event("open"),this.opts.element.trigger(a),!a.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(this.clearDropdownAlignmentPreference(),this.search.val()===" "&&this.search.val(""),this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.dropdown[0]!==this.body.children().last()[0]&&this.dropdown.detach().appendTo(this.body),this.dropdown.addClass("select2-drop-active"),this.positionDropdown(),this.updateResults(!0),this.dropdown.show(),this.ensureHighlightVisible(),this.focusSearch(),!0):!1},close:function(){if(!this.opened())return;this.clearDropdownAlignmentPreference(),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open"),this.results.empty(),this.clearSearch()},clearSearch:function(){},ensureHighlightVisible:function(){var b,c,d,e,f,g,h=this.results,i=this.highlight();if(i<0)return;if(i==0){h.scrollTop(0);return}b=h.find(".select2-result-selectable"),c=a(b[i]),d=c.offset().top+c.outerHeight(),i===b.length-1&&(g=h.find("li.select2-more-results"),g.length>0&&(d=g.offset().top+g.outerHeight())),e=h.offset().top+h.outerHeight(),d>e&&h.scrollTop(h.scrollTop()+(d-e)),f=c.offset().top-h.offset().top,f<0&&h.scrollTop(h.scrollTop()+f)},moveHighlight:function(b){var c,d=this.results.find(".select2-result-selectable"),e=this.highlight();while(e>-1&&e<d.length){e+=b,c=a(d[e]);if(c.hasClass("select2-result-selectable")&&!c.hasClass("select2-disabled")){this.highlight(e);break}}},highlight:function(b){var c=this.results.find(".select2-result-selectable");if(arguments.length===0)return i(c.filter(".select2-highlighted")[0],c.get());b>=c.length&&(b=c.length-1),b<0&&(b=0),c.removeClass("select2-highlighted"),a(c[b]).addClass("select2-highlighted"),this.ensureHighlightVisible()},highlightUnderEvent:function(b){var c,d=a(b.target).closest(".select2-result-selectable");d.length>0&&!d.is(".select2-highlighted")?(c=this.results.find(".select2-result-selectable"),this.highlight(c.index(d))):d.length==0&&this.results.find(".select2-highlighted").removeClass("select2-highlighted")},loadMoreIfNeeded:function(){var a,b=this.results,c=b.find("li.select2-more-results"),d=-1,e=this.resultsPage+1,f=this,g=this.search.val(),h=this.context;if(c.length===0)return;a=c.offset().top-b.offset().top-b.height(),a<=0&&(c.addClass("select2-active"),this.opts.query({term:g,page:e,context:h,matcher:this.opts.matcher,callback:this.bind(function(a){f.opts.populateResults.call(this,b,a.results,{term:g,page:e,context:h}),a.more===!0?(c.detach().appendTo(b.children(":last")).text(f.opts.formatLoadMore(e+1)),window.setTimeout(function(){f.loadMoreIfNeeded()},10)):c.remove(),f.positionDropdown(),f.resultsPage=e})}))},updateResults:function(c){function h(){e.scrollTop(0),d.removeClass("select2-active"),g.positionDropdown()}function i(a){e.html(a),h()}var d=this.search,e=this.results,f=this.opts,g=this;if(c!==!0&&this.showSearchInput===!1)return;d.addClass("select2-active");if(d.val().length<f.minimumInputLength){i("<li class='select2-no-results'>"+f.formatInputTooShort(d.val(),f.minimumInputLength)+"</li>");return}this.resultsPage=1,f.query({term:d.val(),page:this.resultsPage,context:null,matcher:f.matcher,callback:this.bind(function(k){var l;this.context=k.context===b?null:k.context,this.opts.createSearchChoice&&d.val()!==""&&(l=this.opts.createSearchChoice.call(null,d.val(),k.results),l!==b&&l!==null&&g.id(l)!==b&&g.id(l)!==null&&a(k.results).filter(function(){return j(g.id(this),g.id(l))}).length===0&&k.results.unshift(l));if(k.results.length===0){i("<li class='select2-no-results'>"+f.formatNoMatches(d.val())+"</li>");return}e.empty(),g.opts.populateResults.call(this,e,k.results,{term:d.val(),page:this.resultsPage,context:null}),h(),k.more===!0&&(e.children().filter(":last").append("<li class='select2-more-results'>"+f.formatLoadMore(this.resultsPage)+"</li>"),window.setTimeout(function(){g.loadMoreIfNeeded()},10)),this.postprocessResults(k,c)})})},cancel:function(){this.close()},blur:function(){this.close(),this.container.removeClass("select2-container-active"),this.dropdown.removeClass("select2-drop-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){window.setTimeout(this.bind(function(){this.search.focus()}),10)},selectHighlighted:function(){var a=this.results.find(".select2-highlighted").not(".select2-disabled").closest(".select2-result-selectable").data("select2-data");a&&this.onSelect(a)},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},getContainerWidth:function(){var a,c,d,e,f;if(this.opts.width!==b)return this.opts.width;a=this.opts.element.attr("style");if(a!==b){c=a.split(";");for(e=0,f=c.length;e<f;e+=1){d=c[e].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/);if(d!==null&&d.length>=1)return d[1]}}return a=this.opts.element.css("width"),a.indexOf("%")>0?a:this.opts.element.width()===0?"auto":this.opts.element.outerWidth()+"px"}}),e=x(d,{createContainer:function(){return a("<div></div>",{"class":"select2-container",style:"width: "+this.getContainerWidth()}).html(["    <a href='javascript:void(0)' class='select2-choice'><input type='text' class='select2-offscreen select2-focusser'/>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>","   <div><b></b></div>","</a>","    <div class='select2-drop' style='display:none;'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.selection.focus()},isFocused:function(){return this.selection[0]===document.activeElement},cancel:function(){this.parent.cancel.apply(this,arguments),this.selection.focus()},initContainer:function(){var b,d=this.container,e=this.dropdown,f=a([this.container.get(0),this.dropdown.get(0)]),g=!1,h=".select2-choice",i=d.find("input.select2-focusser");this.selection=b=d.find(h),this.search.bind("keydown",this.bind(function(a){switch(a.which){case c.UP:case c.DOWN:this.moveHighlight(a.which===c.UP?-1:1),q(a);return;case c.TAB:case c.ENTER:this.selectHighlighted(),q(a);return;case c.ESC:this.cancel(a),q(a);return}})),f.delegate(h,"click",this.bind(function(a){g=!0,this.opened()?(this.close(),b.focus()):this.enabled&&this.open(),a.preventDefault(),g=!1})),f.delegate(h,"keydown",this.bind(function(a){if(!this.enabled||a.which===c.TAB||c.isControl(a)||c.isFunctionKey(a)||a.which===c.ESC)return;this.open(),(a.which===c.PAGE_UP||a.which===c.PAGE_DOWN||a.which===c.SPACE)&&q(a),a.which===c.ENTER&&q(a)})),f.delegate(h,"focus",function(){this.enabled&&(f.addClass("select2-container-active"),e.addClass("select2-drop-active"))}),f.delegate(h,"blur",this.bind(function(a){if(g)return;if(a.target===i.get(0))return;this.opened()||this.blur()})),b.delegate("abbr","click",this.bind(function(a){if(!this.enabled)return;this.clear(),q(a),this.close(),this.triggerChange(),b.focus()})),this.setPlaceholder(),i.bind("focus",function(){b.focus()}),b.bind("focus",this.bind(function(){i.hide(),this.container.addClass("select2-container-active")})),b.bind("blur",function(){i.show()}),this.opts.element.bind("open",function(){i.hide()})},clear:function(){this.opts.element.val(""),this.selection.find("span").empty(),this.selection.removeData("select2-data"),this.setPlaceholder()},initSelection:function(){var a;this.opts.element.val()===""?(this.updateSelection({id:"",text:""}),this.close(),this.setPlaceholder()):(a=this,this.opts.initSelection.call(null,this.opts.element,function(c){c!==b&&c!==null&&(a.updateSelection(c),a.close(),a.setPlaceholder())}))},prepareOpts:function(){var b=this.parent.prepareOpts.apply(this,arguments);return b.element.get(0).tagName.toLowerCase()==="select"&&(b.initSelection=function(b,c){var d=b.find(":selected");a.isFunction(c)&&c({id:d.attr("value"),text:d.text()})}),b},setPlaceholder:function(){var a=this.getPlaceholder();if(this.opts.element.val()===""&&a!==b){if(this.select&&this.select.find("option:first").text()!=="")return;typeof a=="object"?this.updateSelection(a):this.selection.find("span").html(a),this.selection.addClass("select2-default"),this.selection.find("abbr").hide()}},postprocessResults:function(b,c){var d=0,e=this,f=!0;this.results.find(".select2-result-selectable").each2(function(a,b){if(j(e.id(b.data("select2-data")),e.opts.element.val()))return d=a,!1}),this.highlight(d),c===!0&&(f=this.showSearchInput=b.results.length>=this.opts.minimumResultsForSearch,this.dropdown.find(".select2-search")[f?"removeClass":"addClass"]("select2-search-hidden"),a(this.dropdown,this.container)[f?"addClass":"removeClass"]("select2-with-searchbox"))},onSelect:function(a){var b=this.opts.element.val();this.opts.element.val(this.id(a)),this.updateSelection(a),this.close(),this.selection.focus(),j(b,this.id(a))||this.triggerChange()},updateSelection:function(a){this.selection.data("select2-data",a),this.selection.find("span").html(this.opts.formatSelection(a)),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==b&&this.selection.find("abbr").show()},val:function(){var a,b=null;if(arguments.length===0)return this.opts.element.val();a=arguments[0],this.select?(this.select.val(a).find(":selected").each2(function(a,c){return b={id:c.attr("value"),text:c.text()},!1}),this.updateSelection(b)):(this.opts.element.val(a?this.id(a):""),this.updateSelection(a)),this.setPlaceholder()},clearSearch:function(){this.search.val("")},data:function(a){if(arguments.length===0)return this.selection.data("select2-data");!a||a===""?this.clear():(this.opts.element.val(a?this.id(a):""),this.updateSelection(a))}}),f=x(d,{createContainer:function(){return a("<div></div>",{"class":"select2-container select2-container-multi",style:"width: "+this.getContainerWidth()}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' style='width: 25px;' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""))},prepareOpts:function(){var b=this.parent.prepareOpts.apply(this,arguments);return b=a.extend({},{closeOnSelect:!0},b),b.element.get(0).tagName.toLowerCase()==="select"&&(b.initSelection=function(b,c){var d=[];b.find(":selected").each2(function(a,b){d.push({id:b.attr("value"),text:b.text()})}),a.isFunction(c)&&c(d)}),b},initContainer:function(){var a,b=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=a=this.container.find(b),this.search.bind("keydown",this.bind(function(b){var d,e;if(!this.enabled)return;if(b.which===c.BACKSPACE&&this.search.val()===""){this.close(),e=a.find(".select2-search-choice-focus");if(e.length>0){this.unselect(e.first()),this.search.width(10),q(b);return}d=a.find(".select2-search-choice"),d.length>0&&d.last().addClass("select2-search-choice-focus")}else a.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");if(this.opened())switch(b.which){case c.UP:case c.DOWN:this.moveHighlight(b.which===c.UP?-1:1),q(b);return;case c.ENTER:case c.TAB:this.selectHighlighted(),q(b);return;case c.ESC:this.cancel(b),q(b);return}if(b.which===c.TAB||c.isControl(b)||c.isFunctionKey(b)||b.which===c.BACKSPACE||b.which===c.ESC)return;this.open(),(b.which===c.PAGE_UP||b.which===c.PAGE_DOWN)&&q(b)})),this.search.bind("keyup",this.bind(this.resizeSearch)),this.container.delegate(b,"click",this.bind(function(a){if(!this.enabled)return;this.clearPlaceholder(),this.open(),this.focusSearch(),a.preventDefault()})),this.container.delegate(b,"focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder()})),this.clearSearch()},enable:function(){if(this.enabled)return;this.parent.enable.apply(this,arguments),this.search.show()},disable:function(){if(!this.enabled)return;this.parent.disable.apply(this,arguments),this.search.hide()},initSelection:function(){var a;this.opts.element.val()===""&&(this.updateSelection([]),this.close(),this.clearSearch());if(this.select||this.opts.element.val()!=="")a=this,this.opts.initSelection.call(null,this.opts.element,function(c){c!==b&&c!==null&&(a.updateSelection(c),a.close(),a.clearSearch())})},clearSearch:function(){var a=this.getPlaceholder();a!==b&&this.getVal().length===0&&this.search.hasClass("select2-focused")===!1?(this.search.val(a).addClass("select2-default"),this.search.width("auto")):this.search.val(" ").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")?this.search.val("").removeClass("select2-default"):this.search.val()===" "&&this.search.val("")},open:function(){return this.parent.open.apply(this,arguments)===!1?!1:(this.clearPlaceholder(),this.resizeSearch(),this.focusSearch(),!0)},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(b){var c=[],d=[],e=this;a(b).each(function(){i(e.id(this),c)<0&&(c.push(e.id(this)),d.push(this))}),b=d,this.selection.find(".select2-search-choice").remove(),a(b).each(function(){e.addSelectedChoice(this)}),e.postprocessResults()},onSelect:function(a){this.addSelectedChoice(a),this.select&&this.postprocessResults(),this.opts.closeOnSelect?(this.close(),this.search.width(10)):(this.search.width(10),this.resizeSearch()),this.triggerChange({added:a}),this.focusSearch()},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(b){var c=this.id(b),d=this.getVal(),e=["<li class='select2-search-choice'>",this.opts.formatSelection(b),"<a href='javascript:void(0)' class='select2-search-choice-close' tabindex='-1'></a>","</li>"],f=a(e.join(""));f.find("a").bind("click dblclick",this.bind(function(b){if(!this.enabled)return;this.unselect(a(b.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),q(b),this.close(),this.focusSearch()})).bind("focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active")})),f.data("select2-data",b),f.insertBefore(this.searchContainer),d.push(c),this.setVal(d)},unselect:function(a){var b,c,d=this.getVal();a=a.closest(".select2-search-choice");if(a.length===0)throw"Invalid argument: "+a+". Must be .select2-search-choice";b=a.data("select2-data"),c=i(this.id(b),d),c>=0&&(d.splice(c,1),this.setVal(d),this.select&&this.postprocessResults()),a.remove(),this.triggerChange({removed:b})},postprocessResults:function(){var a=this.getVal(),b=this.results.find(".select2-result-selectable"),c=this;b.each2(function(b,d){var e=c.id(d.data("select2-data"));i(e,a)>=0?d.addClass("select2-disabled"):d.removeClass("select2-disabled")}),b.each2(function(a,b){if(!b.hasClass("select2-disabled"))return c.highlight(a),!1})},resizeSearch:function(){var a=l(this.search),b=r(this.search)+10,c=this.search.offset().left,d=this.selection.width(),e=this.selection.offset().left,f=d-(c-e)-a;f<b&&(f=d-a),f<40&&(f=d-a),this.search.width(f)},getVal:function(){var a;return this.select?(a=this.select.val(),a===null?[]:a):(a=this.opts.element.val(),k(a,","))},setVal:function(b){var c;this.select?this.select.val(b):(c=[],a(b).each(function(){i(this,c)<0&&c.push(this)}),this.opts.element.val(c.length===0?"":c.join(",")))},val:function(){var b,c=[],d=this;if(arguments.length===0)return this.getVal();b=arguments[0],this.select?(this.setVal(b),this.select.find(":selected").each(function(){c.push({id:a(this).attr("value"),text:a(this).text()})}),this.updateSelection(c)):(b=b===null?[]:b,a(b).each(function(){c.push(d.id(this))}),this.setVal(c),this.updateSelection(b)),this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var b=[],c=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){b.push(c.opts.id(a(this).data("select2-data")))}),this.setVal(b),this.triggerChange()},data:function(b){var c,d=this;if(arguments.length===0)return this.selection.find(".select2-search-choice").map(function(){return a(this).data("select2-data")}).get();c=a.map(b,function(a){return d.opts.id(a)}),this.setVal(c),this.updateSelection(b),this.clearSearch()}}),a.fn.select2=function(){var c,d,g,h,j=Array.prototype.slice.call(arguments,0),k=["val","destroy","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data"];return this.each(function(){if(j.length===0||typeof j[0]=="object")c=j.length===0?{}:a.extend({},j[0]),c.element=a(this),c.element.get(0).tagName.toLowerCase()==="select"?h=c.element.attr("multiple"):(h=c.multiple||!1,"tags"in c&&(c.multiple=h=!0)),d=h?new f:new e,d.init(c);else{if(typeof j[0]!="string")throw"Invalid arguments to select2 plugin: "+j;if(i(j[0],k)<0)throw"Unknown method: "+j[0];g=b,d=a(this).data("select2");if(d===b)return;j[0]==="container"?g=d.container:g=d[j[0]].apply(d,j.slice(1));if(g!==b)return!1}}),g===b?this:g},window.Select2={query:{ajax:t,local:u,tags:v},util:{debounce:o,markMatch:s},"class":{"abstract":d,single:e,multi:f}}}(jQuery),fdSlider=function(){function F(a){function bl(a){a=!!a,a!=bd&&(bd=a,bL(bI()))}function bm(a){if(h&&!a)return;try{bZ(bi,-1),o(bi,"focus",br),o(bi,"blur",bs),i?o(bi,"keypress",bv):(o(bi,"keydown",bv),o(bi,"keypress",bu)),o(bf,"mouseover",bw),o(bf,"mouseout",bx),o(bf,"mousedown",by),o(bf,"touchstart",by),c&&(window.addEventListener&&!window.devicePixelRatio?window.removeEventListener("DOMMouseScroll",bt,!1):(o(document,"mousewheel",bt),o(window,"mousewheel",bt)))}catch(d){}s(bg,"fd-slider-focused"),s(bg,"fd-slider-active"),r(bg,"fd-slider-disabled"),bf.setAttribute("aria-disabled",!0),b.disabled=h=!0,clearTimeout(N),a||bq("disable")}function bn(a){if(!h&&!a)return;bZ(bi,0),n(bi,"focus",br),n(bi,"blur",bs),i?n(bi,"keypress",bv):(n(bi,"keydown",bv),n(bi,"keypress",bu)),n(bf,"touchstart",by),n(bf,"mousedown",by),n(bf,"mouseover",bw),n(bf,"mouseout",bx),s(bg,"fd-slider-disabled"),bf.setAttribute("aria-disabled",!1),b.disabled=h=be=!1,a||bq("enable")}function bo(){clearTimeout(N),bh=bk=bi=bf=bg=N=null,bq("destroy"),D=null}function bp(){bD();try{var a=bf.offsetWidth,c=bf.offsetHeight,d=bi.offsetWidth,e=bi.offsetHeight,f=bk.offsetHeight,g=bk.offsetWidth,h=C?c-e:a-d;bc=h/y,$=Math.max(z?bP(bO(m)):Math.abs((m-k)/v)*bc,0),Z=Math.min(z?bP(bO(t)):Math.abs((t-k)/v)*bc,Math.floor(C?c-e:a-d)),R=a,Q=c,bL(I?bI():j=="select"?b.selectedIndex:parseFloat(b.value),!1)}catch(i){}bq("redraw")}function bq(a){if(!F){if(D.hasOwnProperty(a)){var c={userSet:bd,disabled:h,elem:b,value:j=="select"?b.options[b.selectedIndex].value:b.value};for(var d=0,e;e=D[a][d];d++)e.call(b,c)}}else if(a.match(/^(blur|focus|change)$/i)){var f;if(typeof document.createEventObject!="undefined")try{f=document.createEventObject(),b.fireEvent("on"+a.toLowerCase(),f)}catch(g){}else typeof document.createEvent!="undefined"&&(f=document.createEvent("HTMLEvents"),f.initEvent(a,!0,!0),b.dispatchEvent(f))}}function br(a){return r(bg,"fd-slider-focused"),f.onfocus&&(bd=!0,bL(bI())),c&&(n(window,"DOMMouseScroll",bt),n(document,"mousewheel",bt),i||n(window,"mousewheel",bt)),bq("focus"),!0}function bs(a){s(bg,"fd-slider-focused"),c&&(o(document,"mousewheel",bt),o(window,"DOMMouseScroll",bt),i||o(window,"mousewheel",bt)),O=!0,bq("blur")}function bt(a){if(!O)return;a=a||window.event;var b=0,c;a.wheelDelta?(b=a.wheelDelta/120,i&&window.opera.version()<9.2&&(b=-b)):a.detail&&(b=-a.detail/3),C&&(b=-b),b&&(c=bI(),c+=b<0?-v:v,bd=!0,bL(bJ(c))),q(a)}function bu(a){return a=a||window.event,a.keyCode>=33&&a.keyCode<=40||!O||a.keyCode==45||a.keyCode==46?p(a):!0}function bv(a){if(!O)return!0;a=a||window.event;var b=a.keyCode!==null?a.keyCode:a.charCode,c;if(b<33||b>40&&b!=45&&b!=46)return!0;c=bI(),b==37||b==40||b==46||b==34?c-=a.ctrlKey||b==34?+w:+v:b==39||b==38||b==45||b==33?c+=a.ctrlKey||b==33?+w:+v:b==35?c=t:b==36&&(c=m),bd=!0,bL(bJ(c)),bq("update"),q(a)}function bw(a){r(bg,"fd-slider-hover")}function bx(a){s(bg,"fd-slider-hover")}function by(a){a=a||window.event,q(a);var b;a.target?b=a.target:a.srcElement&&(b=a.srcElement),b&&b.nodeType==3&&(b=b.parentNode);if(a.touches){if(a.targetTouches&&a.targetTouches.length!=1)return!1;a=a.touches[0],be=!0}clearTimeout(N),N=null,O=!1,bd=!0;if(b.className.search("fd-slider-handle")!=-1)bb=C?a.clientY:a.clientX,_=parseInt(C?bi.offsetTop:bi.offsetLeft)||0,bB(a),be?(n(document,"touchmove",bB),n(document,"touchend",bA),o(bf,"mousedown",by)):(n(document,"mousemove",bB),n(document,"mouseup",bA)),r(bg,"fd-slider-active"),r(document.body,"fd-slider-drag-"+(C?"vertical":"horizontal")),bq("dragstart");else{bD();var c=0;if(a.pageX||a.pageY)c=C?a.pageY:a.pageX;else if(a.clientX||a.clientY)c=C?a.clientY+document.body.scrollTop+document.documentElement.scrollTop:a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;c-=C?Y+Math.round(bi.offsetHeight/2):X+Math.round(bi.offsetWidth/2),c=bM(c),B=="tween"?(r(bg,"fd-slider-active"),bG(c)):B=="timed"?(r(bg,"fd-slider-active"),n(document,be?"touchend":"mouseup",bz),ba=c,bE()):bK(c)}return!1}function bz(a){return a=a||window.event,q(a),o(document,be?"touchend":"mouseup",bz),s(bg,"fd-slider-active"),clearTimeout(N),N=null,O=!0,!1}function bA(a){return a=a||window.event,q(a),be?(o(document,"touchmove",bB),o(document,"touchend",bA)):(o(document,"mousemove",bB),o(document,"mouseup",bA)),O=!0,s(document.body,"fd-slider-drag-"+(C?"vertical":"horizontal")),s(bg,"fd-slider-active"),bq("dragend"),!1}function bB(a){a=a||window.event,q(a);if(a.touches){if(a.targetTouches&&a.targetTouches.length!=1)return!1;a=a.touches[0]}return bK(bM(_+(C?a.clientY-bb:a.clientX-bb))),!1}function bC(a){var b=bI();bd=!0,b+=a*v,bL(bJ(b))}function bD(){var a=0,b=0,c=bf;try{while(c.offsetParent)a+=c.offsetLeft,b+=c.offsetTop,c=c.offsetParent}catch(d){}X=a,Y=b}function bE(){var a=parseInt(C?bi.offsetTop:bi.offsetLeft,10);a=Math.round(ba<a?Math.max(ba,Math.floor(a-bc)):Math.min(ba,Math.ceil(a+bc))),bK(bM(a)),a!=ba?N=setTimeout(bE,y>20?50:100):(O=!0,s(bg,"fd-slider-active"),bq("finalise"))}function bG(a){O=!1,S=parseInt(a,10),T=parseInt(C?bi.offsetTop:bi.offsetLeft,10),U=S-T,V=20,W=0,N||(N=setTimeout(bF,20))}function bH(a){return isNaN(a)||a===""||typeof a=="undefined"?(bd=!1,G):a<Math.min(m,t)?(bd=!1,Math.min(m,t)):a>Math.max(m,t)?(bd=!1,Math.max(m,t)):(bd=!0,a)}function bI(){return bJ(j=="input"?parseFloat(b.value):b.selectedIndex)}function bJ(a){return isNaN(a)||a===""||typeof a=="undefined"?G:Math.min(Math.max(a,Math.min(m,t)),Math.max(m,t))}function bK(a){var b=bJ(z?bN(bQ(a)):C?l-Math.round(a/bc)*v:k+Math.round(a/bc)*v);bi.style[C?"top":"left"]=(a||0)+"px",bU(),bR(j=="select"||v==1?Math.round(b):b)}function bL(a,b){var c=!1,d;(typeof a=="undefined"||isNaN(a)||a==="")&&j=="input"&&!I?(d=G,c=!0,bd=!1):d=bH(a),bi.style[C?"top":"left"]=(z?bP(bO(d)):C?Math.round((l-d)/v*bc):Math.round((d-k)/v*bc))+"px",bU(),typeof b!==!1&&bR(c?"":d)}function bM(a){if(z)return Math.max(Math.min(Z,a),$);var b=a%bc;return b&&b>=bc/2?a+=bc-b:a-=b,a<Math.min(Math.abs($),Math.abs(Z))?a=Math.min(Math.abs($),Math.abs(Z)):a>Math.max(Math.abs($),Math.abs(Z))&&(a=Math.max(Math.abs($),Math.abs(Z))),Math.min(Math.max(a,0),Z)}function bN(a){var b=0,c=k,d;for(var e in z){if(!z.hasOwnProperty(e))continue;a>=b&&a<=+e&&(d=c+(a-b)*(+z[e]-c)/(+e-b)),b=+e,c=+z[e]}return d}function bO(a){var b=0,c=k,d=0;for(var e in z){if(!z.hasOwnProperty(e))continue;a>=c&&a<=+z[e]&&(d=b+(a-c)*(+e-b)/(+z[e]-c)),b=+e,c=+z[e]}return d}function bP(a){return(bf[C?"offsetHeight":"offsetWidth"]-bi[C?"offsetHeight":"offsetWidth"])/100*a}function bQ(a){return a/((bf[C?"offsetHeight":"offsetWidth"]-bf[bi?"offsetHeight":"offsetWidth"])/100)}function bR(a){bq("update"),bd?s(bg,"fd-slider-no-value"):r(bg,"fd-slider-no-value");if(j=="select")try{a=parseInt(a,10);if(b.selectedIndex===a){bW();return}b.options[a].selected=!0}catch(c){}else{a!==""&&!M&&(a=(k+Math.round((a-k)/v)*v).toFixed(x));if(b.value===a){bW();return}b.value=a}bW(),bq("change")}function bS(a){return!(isNaN(a)||a===""||a<Math.min(m,t)||a>Math.max(m,t))}function bT(a,c){m>t?(a=Math.min(k,Math.max(a,c)),c=Math.max(l,Math.min(a,c)),m=Math.max(a,c),t=Math.min(a,c)):(a=Math.max(k,Math.min(a,c)),c=Math.min(l,Math.max(a,c)),m=Math.min(a,c),t=Math.max(a,c)),G<Math.min(m,t)?G=Math.min(m,t):G>Math.max(m,t)&&(G=Math.max(m,t)),bi.setAttribute("aria-valuemin",m),bi.setAttribute("aria-valuemax",t),bH(j=="input"?parseFloat(b.value):b.selectedIndex),bp()}function bU(){if(g)return;C?bj.style.height=Math.max(1,bk.offsetHeight-bi.offsetTop)+"px":bj.style.width=Math.max(1,bi.offsetLeft)+"px"}function bV(){var a=!1,c=document.getElementsByTagName("label");for(var d=0,e;e=c[d];d++)if(e.htmlFor&&e["htmlFor"]==b.id||e.getAttribute("for")==b.id){a=e;break}return a&&!a.id&&(a.id=b.id+"_label"),a}function bW(){var a=j=="select"?b.options[b.selectedIndex].value:b.value,c=K?K(a):j=="select"?b.options[b.selectedIndex].text?b.options[b.selectedIndex].text:a:a;bi.setAttribute("aria-valuenow",a),bi.setAttribute("aria-valuetext",c)}function bX(a){bd=!0,M=L,bL(j=="input"?parseFloat(b.value):b.selectedIndex),bW(),M=!1}function bY(a){j=="input"?b.value=b.defaultValue:b.selectedIndex=H,bH(j=="select"?b.options[b.selectedIndex].value:b.value),bp(),bW()}function bl(a){bd=!!a}function bZ(a,b){a.setAttribute("tabIndex",b),a.tabIndex=b}var b=a.inp,h=!1,j=b.tagName.toLowerCase(),k=+a.min,l=+a.max,m=+a.min,t=+a.max,u=Math.abs(l-k),v=j=="select"?1:+a.step,w=a.maxStep?+a.maxStep:v*2,x=a.precision||0,y=Math.ceil(u/v),z=a.scale||!1,A=!!a.hideInput,B=a.animation||"",C=!!a.vertical,D=a.callbacks||{},E=a.classNames||"",F=!!a.html5Shim,G=l<k?k:k+(l-k)/2,H=j=="select"?b.selectedIndex:b.defaultValue||G,I=F||!!a.forceValue,J=F&&C&&"inpHeight"in a?a.inpHeight:!1,K=!F&&a.ariaFormat?a.ariaFormat:!1,L=!F&&j!="select"&&"userSnap"in a?!!a.userSnap:!1,M=!1,N=null,O=!0,P=j=="select"?b.selectedIndex:b.value,Q=0,R=0,S=0,T=0,U=0,V=0,W=0,X=0,Y=0,Z=0,$=0,_=0,ba=0,bb=0,bc=0,bd=!1,be=!1,bf,bg,bh,bi,bj,bk;j=="input"&&I&&!b.defaultValue&&(b.defaultValue=bI()),l<k&&(v=-Math.abs(v),w=-Math.abs(w)),z&&(z[100]=l);var bF=function(){W++;var a=U,b=20,c=W,d=T,e=Math.ceil(c==b?d+a:a*(-Math.pow(2,-10*c/b)+1)+d);bK(c==b?S:e),c!=b?(bq("move"),N=setTimeout(bF,20)):(clearTimeout(N),N=null,O=!0,s(bg,"fd-slider-focused"),s(bg,"fd-slider-active"),bq("finalise"))};return function(){F||A?r(b,"fd-form-element-hidden"):n(b,"change",bX),F&&(b.stepUp=function(a){bC(a||1)},b.stepDown=function(a){bC(a||-1)}),bf=document.createElement("span"),bf.className="fd-slider"+(C?"-vertical ":" ")+E,bf.id="fd-slider-"+b.id,C&&
J&&(bf.style.height=J+"px"),bg=document.createElement("span"),bg.className="fd-slider-wrapper"+(F?"":" fd-slider-no-value"),bh=document.createElement("span"),bh.className="fd-slider-inner",bk=document.createElement("span"),bk.className="fd-slider-bar",d?bi=document.createElement("span"):(bi=document.createElement("a"),bi.setAttribute("href","#"),n(bi,"click",p)),bZ(bi,0),bi.className="fd-slider-handle",bi.appendChild(document.createTextNode(String.fromCharCode(160))),bg.appendChild(bh),g||(bj=document.createElement("span"),bj.className="fd-slider-range",bg.appendChild(bj)),bg.appendChild(bk),bg.appendChild(bi),bf.appendChild(bg),b.parentNode.insertBefore(bf,b);if(i||!1)bi.unselectable="on",bk.unselectable="on",bh.unselectable="on",bf.unselectable="on",bg.unselectable="on",g||(bj.unselectable="on");bf.setAttribute("role","application"),bi.setAttribute("role","slider"),bi.setAttribute("aria-valuemin",j=="select"?b.options[0].value:k),bi.setAttribute("aria-valuemax",j=="select"?b.options[b.options.length-1].value:l);var a=bV();a&&(bi.setAttribute("aria-labelledby",a.id),bi.id="fd-slider-handle-"+b.id,a.setAttribute("for",bi.id)),document.getElementById(e)&&bi.setAttribute("aria-describedby",e),b.getAttribute("disabled")==1?bm(!0):bn(!0),f.onvalue&&(bd=!0,bH(j=="input"?parseFloat(b.value):b.selectedIndex)),b.form&&n(b.form,"reset",bY),bW(),bq("create"),bp()}(),{onResize:function(a){(bf.offsetHeight!=Q||bf.offsetWidth!=R)&&bp()},destroy:function(){bo()},reset:function(){bL(j=="input"?parseFloat(b.value):b.selectedIndex)},stepUp:function(a){bC(Math.abs(a)||1)},stepDown:function(a){bC(-Math.abs(a)||-1)},increment:function(a){bC(a)},disable:function(){bm()},enable:function(){bn()},setRange:function(a,b){bT(a,b)},getValueSet:function(){return!!bd},setValueSet:function(a){bl(a)},checkValue:function(){f.onvalue&&(bd=!0,bH(j=="input"?parseFloat(b.value):b.selectedIndex)),bW(),bp()}}}var a={},b=0,c=!0,d=!0,e="fd-slider-describedby",f={onfocus:!0,onvalue:!0},g=!1,h="jump",i=Object.prototype.toString.call(window.opera)==="[object Opera]",j=/^([\-]{0,1}[0-9]+(\.[0-9]+){0,1})$/,k=/^([0-9]+(\.[0-9]+){0,1})$/,l=function(a){if(typeof a!="string"||a==="")return{};try{if(typeof JSON=="object"&&typeof JSON.parse=="function")return JSON.parse(a);if(/mousewheelenabled|fullaria|describedby|norangebar|html5animation|varsetrules/.test(a.toLowerCase())){var b=Function(["var document,top,self,window,parent,Number,Date,Object,Function,","Array,String,Math,RegExp,Image,ActiveXObject;","return (",a.replace(/<\!--.+-->/gim,"").replace(/\bfunction\b/g,"function-"),");"].join(""));return b()}}catch(c){}return{err:"Could not parse the JSON object"}},m=function(a){if(typeof a!="object")return;for(var b in a){value=a[b];switch(b.toLowerCase()){case"mousewheelenabled":c=!!value;break;case"fullaria":d=!!value;break;case"describedby":e=String(value);break;case"norangebar":g=!!value;break;case"html5animation":h=String(value).search(/^(jump|tween|timed)$/i)!=-1?String(value).toLowerCase():"jump";break;case"varsetrules":"onfocus"in value&&(f.onfocus=!!value.onfocus),"onvalue"in value&&(f.onvalue=!!value.onvalue)}}},n=function(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener(b,c,!0)},o=function(a,b,c){try{a.detachEvent?a.detachEvent("on"+b,c):a.removeEventListener(b,c,!0)}catch(d){}},p=function(a){return a=a||window.event,a.stopPropagation&&(a.stopPropagation(),a.preventDefault()),!1},q=function(a){a=a||window.event;if(a.preventDefault){a.preventDefault();return}a.returnValue=!1},r=function(a,b){if((new RegExp("(^|\\s)"+b+"(\\s|$)")).test(a.className))return;a.className+=(a.className?" ":"")+b},s=function(a,b){a.className=b?a.className.replace(new RegExp("(^|\\s)"+b+"(\\s|$)")," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""):""},t=function(){var b={};for(var c in a)b[c]=a[c].getValueSet();return b},u=function(b,c){a[b].setValueSet(!!c)},v=function(b){return!!(b in a&&a.hasOwnProperty(b))},w=function(b){if(!b||!b.inp||!b.inp.tagName||b.inp.tagName.search(/^input|select/i)==-1)return!1;b.html5Shim=!1;if(b.inp.tagName.toLowerCase()=="select"){if(b.inp.options.length<2)return!1;b.min=0,b.max=b.inp.options.length-1,b.step=1,b.precision=0,b.scale=!1,b.forceValue=!0}else{if(String(b.inp.type).search(/^(text|range)$/i)==-1)return!1;b.min=b.min&&String(b.min).search(j)!=-1?+b.min:0,b.max=b.max&&String(b.max).search(j)!=-1?+b.max:100,b.step=b.step&&String(b.step).search(k)!=-1?b.step:1,b.precision=b.precision&&String(b.precision).search(/^[0-9]+$/)!=-1?b.precision:String(b.step).search(/\.([0-9]+)$/)!=-1?String(b.step).match(/\.([0-9]+)$/)[1].length:0,b.scale=b.scale||!1,b.forceValue="forceValue"in b?!!b.forceValue:!1,b.userSnap="userSnap"in b?!!b.userSnap:!1}return b.ariaFormat="ariaFormat"in b&&typeof b.ariaFormat=="function"?b.ariaFormat:!1,b.maxStep=b.maxStep&&String(b.maxStep).search(k)!=-1?+b.maxStep:+b.step*2,b.classNames=b.classNames||"",b.callbacks=b.callbacks||!1,z(b.inp.id),a[b.inp.id]=new F(b),!0},x=function(a,b){return a.getAttribute(b)||""},y=function(){var c=document.getElementsByTagName("input"),d;for(var e=0,f;f=c[e];e++)if(f.tagName.toLowerCase()=="input"&&f.type.toLowerCase()=="text"&&(x(f,"min")&&x(f,"min").search(j)!=-1||x(f,"max")&&x(f,"max").search(j)!=-1||x(f,"step")&&x(f,"step").search(/^(any|([0-9]+(\.[0-9]+){0,1}))$/i)!=-1)){if(f.id&&document.getElementById("fd-slider-"+f.id))continue;f.id&&!document.getElementById("fd-slider-"+f.id)&&z(f.id),f.id||(f.id="fd-slider-form-elem-"+b++),d={inp:f,callbacks:[],animation:h,vertical:x(f,"data-fd-slider-vertical")?!0:f.offsetHeight>f.offsetWidth,classNames:x(f,"data-fd-slider-vertical"),html5Shim:!0},d.vertical&&!x(f,"data-fd-slider-vertical")&&(d.inpHeight=f.offsetHeight),d.min=x(f,"min")||0,d.max=x(f,"max")||100,d.step=x(f,"step").search(/^any$/i)!=-1?d.max-d.min:x(f,"step").search(k)!=-1?f.getAttribute("step"):1,d.precision=String(d.step).search(/\.([0-9]+)$/)!=-1?String(d.step).match(/\.([0-9]+)$/)[1].length:0,d.maxStep=d.step*2,z(d.inp.id),a[d.inp.id]=new F(d)}return!0},z=function(b){return b in a&&a.hasOwnProperty(b)?(a[b].destroy(),delete a[b],!0):!1},A=function(b){for(var c in a)a.hasOwnProperty(c)&&a[c].destroy();a=[]},B=function(b){A(),a=null},C=function(b){for(var c in a)a.hasOwnProperty(c)&&a[c].onResize()},D=function(){E(),y()},E=function(){o(window,"load",y)};return n(window,"resize",C),n(window,"unload",B),function(){var a=document.getElementsByTagName("script"),b=String(a[a.length-1].innerHTML).replace(/[\n\r\s\t]+/g," ").replace(/^\s+/,"").replace(/\s+$/,""),c=l(b);typeof c=="object"&&!("err"in c)&&m(c)}(),{rescanDocument:y,createSlider:function(a){return w(a)},onDomReady:function(){D()},destroyAll:function(){A()},destroySlider:function(a){return z(a)},redrawAll:function(){C()},addEvent:n,removeEvent:o,stopEvent:p,increment:function(b,c){if(!v(b))return!1;a[b].increment(c)},stepUp:function(b,c){if(!v(b))return!1;a[b].stepUp(Math.abs(c)||1)},stepDown:function(b,c){if(!v(b))return!1;a[b].stepDown(-Math.abs(c)||-1)},setRange:function(b,c,d){if(!v(b))return!1;a[b].setRange(c,d)},updateSlider:function(b){if(!v(b))return!1;a[b].onResize(),a[b].reset()},disable:function(b){if(!v(b))return!1;a[b].disable()},enable:function(b){if(!v(b))return!1;a[b].enable()},getValueSet:function(){return t()},setValueSet:function(a,b){if(!v(id))return!1;u(a,b)},setGlobalVariables:function(a){m(a)},removeOnload:function(){E()}}}(),function(a){var b={init:function(c){return this.each(function(){var d=a.extend({},a.fn.raty.defaults,c),e=a(this).data("options",d);d.number>20?d.number=20:d.number<0&&(d.number=0),d.round.down===undefined&&(d.round.down=a.fn.raty.defaults.round.down),d.round.full===undefined&&(d.round.full=a.fn.raty.defaults.round.full),d.round.up===undefined&&(d.round.up=a.fn.raty.defaults.round.up),d.path.substring(d.path.length-1,d.path.length)!="/"&&(d.path+="/"),typeof d.start=="function"&&(d.start=d.start.call(this));var f=!isNaN(parseInt(d.start,10)),g="";f&&(g=d.start>d.number?d.number:d.start);var h=d.starOn,i=d.space?4:0,j="";for(var k=1;k<=d.number;k++)h=g<k?d.starOff:d.starOn,j=k<=d.hintList.length&&d.hintList[k-1]!==null?d.hintList[k-1]:k,e.append('<img src="'+get_img_url(d.path+h)+'" alt="'+k+'" title="'+j+'" />'),d.space&&e.append(k<d.number?"&nbsp;":"");var l=a("<input/>",{type:"hidden",name:d.scoreName}).appendTo(e);f&&(d.start>0&&l.val(g),b.roundStar.call(e,g)),d.iconRange&&b.fillStar.call(e,g),b.setTarget.call(e,g,d.targetKeep);var m=d.width||d.number*d.size+d.number*i;if(d.cancel){var n=a('<img src="'+get_img_url(d.path+d.cancelOff)+'" alt="x" title="'+d.cancelHint+'" class="raty-cancel"/>');d.cancelPlace=="left"?e.prepend("&nbsp;").prepend(n):e.append("&nbsp;").append(n),m+=d.size+i}d.readOnly?(b.fixHint.call(e),e.children(".raty-cancel").hide()):(e.css("cursor","pointer"),b.bindAction.call(e)),e.css("width","auto")})},bindAction:function(){var c=this,d=this.data("options"),e=this.children("input");c.mouseleave(function(){b.initialize.call(c,e.val()),b.setTarget.call(c,e.val(),d.targetKeep)});var f=this.children("img").not(".raty-cancel"),g=d.half?"mousemove":"mouseover";d.cancel&&c.children(".raty-cancel").mouseenter(function(){a(this).attr("src",get_img_url(d.path+d.cancelOn)),f.attr("src",get_img_url(d.path+d.starOff)),b.setTarget.call(c,null,!0)}).mouseleave(function(){a(this).attr("src",get_img_url(d.path+d.cancelOff)),c.mouseout()}).click(function(a){e.removeAttr("value"),d.click&&d.click.call(c[0],null,a)}),f.bind(g,function(e){var f=parseInt(this.alt,10);if(d.half){var g=parseFloat((e.pageX-a(this).offset().left)/d.size),h=g>.5?1:.5;f=parseFloat(this.alt)-1+h,b.fillStar.call(c,f),d.precision&&(f=f-h+g),b.showHalf.call(c,f)}else b.fillStar.call(c,f);c.data("score",f),b.setTarget.call(c,f,!0)}).click(function(a){e.val(d.half||d.precision?c.data("score"):this.alt),d.click&&d.click.call(c[0],e.val(),a)})},cancel:function(c){return this.each(function(){var d=a(this);if(d.data("readonly")=="readonly")return!1;c?b.click.call(d,null):b.start.call(d,null),d.mouseleave().children("input").removeAttr("value")})},click:function(c){return this.each(function(){var d=a(this);if(d.data("readonly")=="readonly")return!1;b.initialize.call(d,c);var e=d.data("options");e.click?e.click.call(d[0],c):a.error('you must add the "click: function(score, evt) { }" callback.'),b.setTarget.call(d,c,!0)})},fillStar:function(a){var b=this.data("options"),c=this.children("img").not(".raty-cancel"),d=c.length,e=0,f,g,h;for(var i=1;i<=d;i++)f=c.eq(i-1),b.iconRange&&b.iconRange.length>e?(g=b.iconRange[e],b.single?h=i==a?g.on||b.starOn:g.off||b.starOff:h=i<=a?g.on||b.starOn:g.off||b.starOff,i<=g.range&&f.attr("src",get_img_url(b.path+h)),i==g.range&&e++):(b.single?h=i==a?b.starOn:b.starOff:h=i<=a?b.starOn:b.starOff,f.attr("src",get_img_url(b.path+h)))},fixHint:function(){var a=this.data("options"),b=this.children("input"),c=parseInt(b.val(),10),d=a.noRatedMsg;!isNaN(c)&&c>0&&(d=c<=a.hintList.length&&a.hintList[c-1]!==null?a.hintList[c-1]:c),b.attr("readonly","readonly"),this.css("cursor","default").data("readonly","readonly").attr("title",d).children("img").attr("title",d)},readOnly:function(c){return this.each(function(){var d=a(this),e=d.children(".raty-cancel");e.length&&(c?e.hide():e.show()),c?(d.unbind(),d.children("img").unbind(),b.fixHint.call(d)):(b.bindAction.call(d),b.unfixHint.call(d))})},roundStar:function(a){var b=this.data("options"),c=(a-Math.floor(a)).toFixed(2);if(c>b.round.down){var d=b.starOn;c<b.round.up&&b.halfShow?d=b.starHalf:c<b.round.full&&(d=b.starOff),this.children("img").not(".raty-cancel").eq(Math.ceil(a)-1).attr("src",get_img_url(b.path+d))}},score:function(){var b=[],c;return this.each(function(){c=a(this).children("input").val(),c=c==""?null:parseFloat(c),b.push(c)}),b.length>1?b:b[0]},setTarget:function(b,c){var d=this.data("options");if(d.target){var e=a(d.target);if(e.length==0)a.error("target selector invalid or missing!");else{var f=b;f==null&&!d.cancel?a.error('you must enable the "cancel" option to set hint on target.'):(!c||f==""?f=d.targetText:d.targetType=="hint"?f===null&&d.cancel?f=d.cancelHint:f=d.hintList[Math.ceil(f-1)]:f!=""&&!d.precision?f=parseInt(f,10):f=parseFloat(f).toFixed(1),d.targetFormat.indexOf("{score}")<0?a.error('template "{score}" missing!'):b!==null&&(f=d.targetFormat.toString().replace("{score}",f)),e.is(":input")?(f===""&&(f=0),e.val(f)):e.html(f))}}},showHalf:function(a){var b=this.data("options"),c=(a-Math.floor(a)).toFixed(1);c>0&&c<.6&&this.children("img").not(".raty-cancel").eq(Math.ceil(a)-1).attr("src",get_img_url(b.path+b.starHalf))},start:function(c){return this.each(function(){var d=a(this);if(d.data("readonly")=="readonly")return!1;b.initialize.call(d,c);var e=d.data("options");b.setTarget.call(d,c,!0)})},initialize:function(a){var c=this.data("options");a<0?a=0:a>c.number&&(a=c.number),b.fillStar.call(this,a),a!=""&&(c.halfShow&&b.roundStar.call(this,a),this.children("input").val(a))},unfixHint:function(){var a=this.data("options"),b=this.children("img").filter(":not(.raty-cancel)");for(var c=0;c<a.number;c++)b.eq(c).attr("title",c<a.hintList.length&&a.hintList[c]!==null?a.hintList[c]:c);this.css("cursor","pointer").removeData("readonly").removeAttr("title").children("input").attr("readonly","readonly")}};a.fn.raty=function(c){if(b[c])return b[c].apply(this,Array.prototype.slice.call(arguments,1));if(typeof c=="object"||!c)return b.init.apply(this,arguments);a.error("Method "+c+" does not exist!")},a.fn.raty.defaults={cancel:!1,cancelHint:"cancel this rating!",cancelOff:"cancel-off.png",cancelOn:"cancel-on.png",cancelPlace:"left",click:undefined,half:!1,halfShow:!0,hintList:["bad","poor","regular","good","gorgeous"],iconRange:undefined,noRatedMsg:"not rated yet",number:5,path:"img/",precision:!1,round:{down:.25,full:.6,up:.76},readOnly:!1,scoreName:"score",single:!1,size:16,space:!0,starHalf:"star-half.png",starOff:"star-off.png",starOn:"star-on.png",start:0,target:undefined,targetFormat:"{score}",targetKeep:!1,targetText:"",targetType:"hint",width:undefined}}(jQuery),function(){var a=!0,b=!a,c=Array.prototype,d=Object.prototype,e=Function.prototype,f=c.slice,g=function(){},h=function(a){return $.each(f.call(arguments,1),function(b,c){var d;for(d in c)c[d]!==void 0&&(a[d]=c[d])}),a},i=function(a,b,c){var d;return b&&b.hasOwnProperty("constructor")?d=b.constructor:d=function(){return a.apply(this,arguments)},h(d,a),g.prototype=a.prototype,d.prototype=new g,b&&h(d.prototype,b),c&&h(d,c),d.prototype.constructor=d,d.__super__=a.prototype,d},j=function(a,b){var c=i(this,a,b);return c.extend=this.extend,c},k=function(){};k.extend=j,TAPP.Klass=k,TAPP.Module=k.extend({register_for_event:function(a,b){$.subscribe(a,$.proxy(b,this))},register_post_load_hooks:function(a){var b=this;$.each(a,function(a,c){b.register_for_event(a,c)})},register_app_hooks:function(a){var b=this;$.each(a,function(a,c){b.register_for_event(a,c)})},publish_app_event:function(a,b){$.publish(a,b)},unload_functions:[],unload:function(){$.each(this.unload_functions,function(){this()}),this.unload_functions=[]}})}(TAPP),function(){var a=TAPP.Module.extend({intcomma:function(a){return a=""+a,a.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},show_form_errors:function(a,b){$.each(b,function(b,c){var d=a.find(".field-"+b);d.addClass("bad");var e=d.find("input");e.addClass("bad");var f="";$.each(c,function(a,b){f+="<li>"+b+"</li>"});var g=d.find("ul.error");g.length||(e.after('<ul class="error"></ul>'),g=d.find("ul.error")),g.html(f)})},is_touch:function(){return $("html").hasClass("touch")},is_widescreen:function(){return $("html").hasClass("breakpoint-widescreen")}});TAPP.utils=new a}(TAPP),function(){var a={backdrop:!1,zIndex:1e4,buttons:{Close:function(){$(this).modal("close")}}},b=function(a,b,c){a=$("<div/>").addClass("modal-header").html(a),b=$("<div/>").addClass("modal-body").html(b),c=$("<div/>").addClass("modal-footer btn-group-spaced").html(c);var d=$("<div/>").addClass("modal").append(a).append(b).append(c);return d.addClass("hide").appendTo($("body")),$(d)},c=function(a){if(!a)return null;var b=$("<div/>");return $.each(a,function(a,c){var d=c.text||a,e=c["class"]||"mgt-btn",f=c.click||$.noop();b.append($("<button/>").text(d).addClass(e).on("click",f))}),b},d=function(d,e){typeof d!="string"&&(d=d.html());var f=e.title||"",g=e.buttons?c(e.buttons):e.footer||"",h=$.extend({},a,e),i=b(f,d,g);return i.modal(h),i},e=TAPP.Module.extend({markup_dialog:function(a,b){return d(a,b)},error_dialog:function(a,b,c){var e;a=a||"Something is wrong with the server. Please wait a moment and try again.";var f=$.extend({},c,{title:"<h3>An error occurred<h3>",dialogClass:"error-dialog",buttons:{Ok:{click:function(){e.modal("hide"),b&&b()}}}});e=d(a,f),e.modal("show")},confirm_dialog:function(a,b,c,e,f,g){e=e||"<h3>Are you sure?</h3>",f=(f||"")+" confirmation-dialog";var h=$(a),i=function(a){a.preventDefault(),a.stopImmediatePropagation();var h,i=$(this),j=g||{Cancel:{click:function(){h.modal("hide")}},Continue:{click:function(){i.unbind(a),i.trigger($.Event(b)),h.modal("hide")},text:"Continue","class":"mgt-btn mgt-btn-primary"}};if(!i.data("dialog-init")){var k={title:e,dialogClass:f,buttons:j};h=d(c,k),i.data("dialog-init",h)}else h=i.data("dialog-init");return h.modal("show"),!1};h.bind(b,i)}});TAPP.dialogs=new e,TAPP.dialogs.register_post_load_hooks({confirm_dialog:TAPP.dialogs.confirm_dialog,error_dialog:TAPP.dialogs.error_dialog})}(TAPP),function(){var a=TAPP.Module.extend({get_cc_data:function(){return{number:$("#card-number").val(),cvc:$("#card-cvc").val(),exp_month:$("#card-exp-month").val(),exp_year:$("#card-exp-year").val(),name:$("#card-name").val(),address_country:$("#id_country_code").val(),address_zip:$("#card-address-zip").val()}},handle_form_submit:function(a){var b=$("#card-exp-year").val();b.length===2&&$("#card-exp-year").val("20"+b);var c=$(".submit-button",a);c.attr("disabled","disabled");var d=$.Deferred();return Stripe.createToken(this.get_cc_data(),function(a,b){if(b.error){if(b.error.param){var e=$("#card-"+b.error.param.replace("_","-")),f=e.closest(".control-group");f.addClass("error"),$("body").on("change",e,function(){f.removeClass("error")})}var g=b.error.message;window._kmq=window._kmq||[],window._kmq.push(["record","Stripe Error",{"Error Message":g}]),g[0].toUpperCase()!==g[0]&&(g="We couldn't process your order. Please fix the following information:"),$(".payment-errors").text(g),c.removeAttr("disabled"),d.reject(b)}else $("#stripe_token").val(b.id),d.resolve(b)}),d},init:function(){Stripe.setPublishableKey(page_context.stripe_publishable_key)}});TAPP.stripe=new a}(TAPP),function(){var a={},b=[],c=TAPP.Module.extend({fire_off_event:function(a,b,c){if(page_context.disable_mixpanel)return;var d,e=function(){clearTimeout(d),c&&c()};$.extend(b,{distinct_id:page_context.cookie_value}),b.user_id&&mixpanel.name_tag(b.user_id),mixpanel.track(a,b,function(){e()}),c&&(d=setTimeout(c,300)),page_context.console_log_mixpanel&&console.log(a+", "+JSON.stringify(b))},mixpanel_process_event_queue:function(a){var c=function(){b=[],a()};$.waitForFuncs(b,TAPP.event_tracking.fire_off_event,c)},mixpanel_empty_event_queue:function(){b=[]},mixpanel_event_delegate:function(){$("body").delegate("[data-mixpanel-event]","click",function(a){var c=$(this).data("mixpanel-event"),d=TAPP.event_tracking.mixpanel_global_metadata();$.extend(d,$(this).data("mixpanel-info"));if($(this).data("mixpanel-deferred"))b.push([c,d]);else if($(this).attr("data-mixpanel-navigate-wait")&&!page_context.is_pjax){var e=$(this).attr("href"),f=function(){window.top.location=e};a.stopImmediatePropagation(),a.preventDefault(),TAPP.event_tracking.fire_off_event(c,d,f)}else TAPP.event_tracking.fire_off_event(c,d)})},mixpanel_global_metadata:function(){var a={app_display_name:page_context.fb_app_display_name,page_id:page_context.fb_page_id,user_id:page_context.authenticated_user_id,device:$(".app-platform-carousel a.selected").data("mixpanel-device"),href:window.location.href};page_context.mixpanel_data&&$.extend(a,page_context.mixpanel_data);var b={};return _.each(a,function(a,c){typeof a!="undefined"&&(b[c]=a)}),b},track_event:function(a,b,c){var d=this.mixpanel_global_metadata();return b&&$.extend(d,b),this.fire_off_event(a,d,c)},track_event_server_side:function(a,b){var c={action:"receive_event",event_name:a};return b&&$.extend(c,b),$.ajax({type:"POST",url:""+window.location,data:c})}});TAPP.event_tracking=new c,TAPP.event_tracking.register_app_hooks({track_event:TAPP.event_tracking.track_event,process_event_tracking_queue:TAPP.event_tracking.mixpanel_process_event_queue,empty_event_tracking_queue:TAPP.event_tracking.mixpanel_empty_event_queue})}(TAPP),TAPP.event_tracking.mixpanel_event_delegate(),function(){var a,b,c=$.extend({},page_context.api_options,{no_globals:!0});TAPP.appdotnet_api=window.APPDOTNET.init(c),a={container:"#pjax-container",push:!0,timeout:1e4,success:function(){$(window).scrollTop(0);return}},b=TAPP.Module.extend({init_pau:function(){this.intercept_links(),this.handle_resize(),this.confirm_email_dialog(),$("body").on("click","[data-remove-alpha-warning]",function(){return $("body").addClass("hide-alpha-warning").removeClass("fixed-top-banner"),$.cookie("hide_alpha_warning",1,{expires:365}),!1})},init_placeholder:function(){$("input[placeholder], textarea[placeholder]").placeholder()},intercept_links:function(){var a=this,b=!1;$("body").tapp_on("keydown",function(){b=!0}),$("body").tapp_on("keyup",function(){b=!1}),$("body").tapp_on("click.intercept_links","a",function(c){var d=$(this),e=d.attr("href");if(e&&!d.attr("target")&&e.substring(0,1)!=="#"&&e.substring(0,11)!=="javascript:"&&!d.data("non-pjax")&&!b)return a.pjax_load_page({url:e})})},pjax_load_page:function(b){var c=$.extend({},a,b);return $.pjax(c),!1},handle_resize:function(){$(window).on("resize",_.debounce(Modernizr.test_media_queries,50))},highlight_in_reply_to:function(){var a=window.location.hash,b=a.substr(1,a.length),c=$("[name="+b+"]");if(c.length){c.addClass("highlight");var d=120;$("body,html").scrollTop(c.offset().top-d)}},confirm_email_dialog:function(){$("body").tapp_on("click","[data-confirm-email]",function(){var a=TAPP.lock_up($("[data-confirm-email]"));$.post("/settings/",{action:"resend_confirmation_email"});var b,c=function(){b.remove(),a()},d={Ok:{click:c}},e={title:"<strong>Email Confirmation Sent</strong>",buttons:d},f=$("[data-email-dialog-body]").html();return b=TAPP.dialogs.markup_dialog(f,e),b.tapp_on("click","a",c),b.show(),!1})}}),TAPP.pau=new b,TAPP.pau.register_post_load_hooks({init_pau:TAPP.pau.init_pau,init_placeholder:TAPP.pau.init_placeholder,highlight_in_reply_to:TAPP.pau.highlight_in_reply_to})}(),function(){$.fn.setCursorPosition=function(a){return this.length===0?this:$(this).setSelection(a,a)},$.fn.setSelection=function(a,b){var c,d;return this.length===0?this:(c=this[0],c.createTextRange?(d=c.createTextRange(),d.collapse(!0),d.moveEnd("character",b),d.moveStart("character",a),d.select()):c.setSelectionRange&&(c.focus(),c.setSelectionRange(a,b)),this)},$.fn.focusEnd=function(){return this.setCursorPosition(this.val().length),this},TAPP.post_create={init:function(){var a,b,c,d,e=$('[name="post"]'),f=$("[data-new-post] [data-in-reply-to]"),g=f.find("[data-post-copy]"),h=$("[data-success-post]"),i=function(){f.get(0).className="hide",e.data("in-reply-to-post-id",null)},j=null,k=function(){h.removeClass("hide").removeClass("fade"),clearTimeout(j),j=setTimeout(function(){h.addClass("fade")},3e3)};$("body").on("click","[data-remove-reply]",function(){i()}),$("body").tapp_on("click","[data-reply-to]",function(){var a,b=$(this),c=b.closest("[data-post-id]"),d=c.data("post-id"),h=c.attr("data-post-author-username");return g.html(c.html()),g.addClass(c.get(0).className),g.find(".post-footer").remove(),f.removeClass("hide"),a=e.val(),a.match("@"+h)||e.val("@"+h+" "+a),e.data("in-reply-to-post-id",d),$(window).scrollTop(e.scrollTop()+100),e.focusEnd(),!1}),a=$('[data-char-counter-for="post"]'),b=$("[data-submit-post-button]"),c=function(){var c=e.val(),d=c.length,f=a.data("total-chars"),g=f-d;a.data("chars-left",g).text(g),g<0?(a.addClass("error"),b.addClass("disabled")):(a.hasClass("error")&&a.removeClass("error"),b.hasClass("disabled")&&b.removeClass("disabled"))},$("body").tapp_on("keyup",'[name="post"]',function(){_.defer(c)}),d=!1,$("body").tapp_on("click","[data-submit-post-button]",function(){var a,b,f,g=$(this);return d?!1:g.hasClass("disabled")?(TAPP.dialogs.error_dialog("Your post can't be longer than 256 characters."),!1):(a=TAPP.lock_up(g),b=$.trim(e.val()),b===""?(a(),!1):(f=e.data("in-reply-to-post-id"),TAPP.appdotnet_api.post(b,f).done(function(a){var b,d,f;e.val(""),c(),i(),b=page_context.insert_post_client_side_based_on_entity,d=function(c){return _.any(a.data.entities[c],function(a){return b.name===a.name})},f=b&&d(b.type),page_context.insert_post_client_side||f?TAPP.stream_view.insert_post($(a.html)):page_context.refresh_on_post_create?TAPP.stream_view.update_stream():page_context.after_post_goto?window.location=page_context.after_post_goto+"?post_id="+a.data.id:k();return}).fail(function(a){var b;a.status===429?b="Please try your operation again in a moment.":b="There was an error creating that post. Please wait a moment and try again",d=!0,TAPP.dialogs.error_dialog(b,function(){d=!1});return}).always(a),!0))}),$("html").hasClass("touch")?a.addClass("hide"):$("body").tapp_on("keyup",'[name="post"]',function(){var a=$(this),b=a.data("text-line-height"),c=a.data("current-height"),d=this.scrollHeight;b||(b=parseInt(a.css("line-height"),10),c=a.height(),a.css("overflow","hidden")),d>c&&(d+=1*b,a.height(d),a.data("current-height",d))}),e.length&&c()}}}(),function(){var a=TAPP.Module.extend({init_stream:function(){this.setup_infinte_scroll()},update_stream:function(){TAPP.pau.pjax_load_page({url:window.location.href})},insert_post:function(a){a.addClass("higlight-fade");var b=$("[data-stream]").prepend(a);setTimeout(function(){a.addClass("higlight-fade-in")},50)},scroll_stream:function(a){var b=$("[data-stream]"),c=b.data("max-id");if(b.data("finished")||c===-1)return a(),!1;var d=window.location.protocol+"//"+window.location.host+window.location.pathname;d=d+"?max_id="+c,$.get(d).done(function(d){var e=$(d),f=e.find("[data-stream]"),g=f.data("max-id");(g===-1||g===c)&&b.data("finished",!0),b.data("max-id",g),b.append(f.html()),a()})},setup_infinte_scroll:function(){var a=!1,b=$(window),c=$(document),d=this,e=!1,f=function(){if(a)return!1;var e=b.scrollTop()>c.height()-b.height()-200;e&&(a=!0,$("[data-stream-loader]").removeClass("hide"),d.scroll_stream(function(){$("[data-stream-loader]").addClass("hide"),a=!1}))},g=function(){e=!0};b.tapp_on("touchstart",function(){b.on("touchmove.scroll",g)}),b.tapp_on("touchend",function(){b.off("touchmove.scroll")}),b.tapp_on("scroll",g),TAPP.setInterval(function(){e&&(e=!1,f())},100)},init_mute_user:function(){var a=function(a,b,c){var d=$('[data-post-author-id="'+b+'"]'),e=TAPP.lock_up(a);d.addClass("hide"),TAPP.appdotnet_api.mute_user(b).always(e).fail(function(){d.removeClass("hide"),TAPP.dialogs.error_dialog("We were unable to block "+c+". Wait a moment, and try again");return}).done(function(){d.remove()})};$("body").tapp_on("click","[data-post-mute-user]",function(){var b=$(this),c=$(this).closest("[data-post-id]"),d=$(c).data("post-author-username"),e=$(c).data("post-author-id"),f,g={Cancel:{click:function(){f.remove()}},Mute:{click:function(){return a(b,e,d),f.remove(),!1},text:"Mute "+d,"class":"mgt-btn mgt-btn-danger"}},h={title:"<strong>Mute "+d+"</strong>",buttons:g};return f=TAPP.dialogs.markup_dialog("Are you sure you want to mute "+d+"?",h),f.show(),!1})},init_post_delete:function(){var a=function(a){var b=a.find(".post-content");b.html(a.data("redacted")),a.removeClass("deleted")},b=function(a){var b=a.find(".post-content");a.data("redacted",b.html()),b.text("[deleted]"),a.addClass("deleted")},c=function(c,d){var e=d.data("post-id"),f=TAPP.lock_up(c),g=d.data("post-remove-from-page")===1?!0:!1;g?d.addClass("hide"):b(d),TAPP.appdotnet_api.delete_post(e).always(f).fail(function(){g?d.removeClass("hide"):a(d),TAPP.dialogs.error_dialog("We were unable to delete that post. Wait a moment, and try again");return}).done(function(){g?d.remove():d.data("redacted",null)})};$("body").tapp_on("click","[data-post-delete]",function(){var a=$(this),b=$(this).closest("[data-post-id]"),d,e={Cancel:{click:function(){d.remove()}},Delete:{click:function(){return c(a,b),d.remove(),!1},text:"Delete","class":"mgt-btn mgt-btn-danger"}},f={title:"<strong>Delete Post</strong>",buttons:e};return d=TAPP.dialogs.markup_dialog("Are you sure you want to delete this post?",f),d.show(),!1})},init_star_post:function(){$("body").tapp_on("click","[data-star-button]",function(){var a=$(this),b=$(this).find("i"),c=$(this).data("post-id"),d=a.data("starred"),e=-1;if(d===1)e=0;else if(d===0)e=1;else return!1;var f=TAPP.lock_up(a);return b.toggleClass("icon-star").toggleClass("icon-star-empty"),a.data("starred",e),TAPP.appdotnet_api.star_post(c,e).always(f).fail(function(){b.toggleClass("icon-star").toggleClass("icon-star-empty"),a.data("starred",d);var c=e==="0"?"un":"";TAPP.dialogs.error_dialog("Unable to "+c+"star this post. Wait a moment, and try again");return}),!1})},init_repost:function(){var a=this;$("body").tapp_on("click","[data-repost-button]",function(){var b=$(this),c=b.closest(".post-container"),d=$(this).find("i"),e=$(this).data("post-id"),f=b.data("reposted"),g=-1;if(f===1)g=0;else if(f===0)g=1;else return!1;var h=TAPP.lock_up(b),i=b.attr("title"),j=g===1?"remove repost":"repost";return d.toggleClass("reposted"),b.data("reposted",g),b.attr("title",j),a.decorate_repost(c,g),TAPP.appdotnet_api.repost_post(e,g).always(h).fail(function(){d.toggleClass("reposted"),b.data("reposted",f),b.attr("title",i),a.decorate_repost(c,f),TAPP.dialogs.error_dialog("Unable to "+i+". Wait a moment, and try again");return}),!1})},decorate_repost:function(a,b){var c=a.find(".footer-top"),d=a.find(".post-reposted-by"),e=function(a){d.length?d.replaceWith(a):c.prepend(a)},f=function(a){return $("<p>").append(a.clone()).html()},g=a.data("old-repost-html");if(g)a.data("old-repost-html",f(d)),e(g);else{g=f(d),a.data("old-repost-html",g);var h;b===1?h='<div class="post-reposted-by yui3-u"><span class="reposted-by-text"><i class="icon-repost"></i><span> Reposted by <a href="/'+page_context.viewer_username+'">you</a></span></span></div>':h="",e(h)}}});TAPP.stream_view=new a,TAPP.stream_view.register_post_load_hooks({init_stream:TAPP.stream_view.init_stream,init_post_delete:TAPP.stream_view.init_post_delete,init_mute_user:TAPP.stream_view.init_mute_user,init_star_post:TAPP.stream_view.init_star_post,init_repost:TAPP.stream_view.init_repost})}(),function(){var a=TAPP.Module.extend({init_follow:function(){var a=this;$("body").tapp_on("click","[data-follow-btn]",function(){var b=$(this).data("user-id"),c=$(this).data("follow-status"),d;c===1?d=0:d=1;var e=$(this),f=$(this).closest("[data-follow-details]"),g=d===1?1:-1;e.data("follow-status",d).toggleClass("following").toggleClass("btn-primary"),a.update_follow_stats(f,g),TAPP.appdotnet_api.follow(b,d).fail(function(){e.data("follow-status",c).toggleClass("following").toggleClass("btn-primary"),a.update_follow_stats(f,g*-1),TAPP.dialogs.error_dialog("There was a problem "+(d===0?"un":"")+"following"+" this user. Please wait a moment and try again.")})})},update_follow_stats:function(a,b){var c=a.find(".follow-to"),d=c.find("[data-follow-to-count]"),e=d.data("follow-to-count"),f=c.find(".text"),g=e+b,h=f.text(),i=h;e===1?i=" Followers":g===1&&(i=" Follower"),d.text(TAPP.utils.intcomma(g)).data("follow-to-count",g),f.text(i)}});TAPP.follow=new a,TAPP.follow.register_post_load_hooks({init_follow:TAPP.follow.init_follow})}(),function(){var a=TAPP.Module.extend({init_welcome:function(){this.init_events(),this.user_search()},init_events:function(){$("body").tapp_on("click","[data-track-event]",function(a){var b=$(this),c=TAPP.lock_up(b),d=b.data("event-name"),e=b.data("event-properties");TAPP.event_tracking.track_event_server_side(d,e).always(c)})},user_search:function(){$.fn.typeahead.Constructor.prototype.render=function(a){var b=this;return a=$(a).map(function(a,b){return a=$("<li class='user-search-item yui3-u-1'></li>"),a.html(b),a[0]}),a.first().addClass("active"),this.$menu.html(a),this},$.fn.typeahead.Constructor.prototype.click=function(a){$(a.target).is(".follow-btn, .follow-btn span")?window.setTimeout(function(){a.stopPropagation(),a.preventDefault()},1):$(a.target).is("a")?(a.stopPropagation(),a.preventDefault()):(a.stopPropagation(),a.preventDefault(),this.select())},$.fn.typeahead.Constructor.prototype.keyup=function(a){switch(a.keyCode){case 40
:case 38:break;case 9:break;case 13:this.lookup();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}},$.fn.typeahead.Constructor.prototype.blur=function(a){return!1},$("body").tapp_on("click","*",function(a){$(a.target).is(".dropdown-menu-user-search .follow-btn, .dropdown-menu-user-search .follow-btn span, .dropdown-menu-user-search .a")||$(".dropdown-menu-user-search").hide()});var a=function(a){return a},b=function(a){return!0},c=function(a,b){return $.post(window.location.href,{action:"user_search",query:a}).fail(function(){return b([])}).done(function(a){return b(a.data)})};$("[data-user-search-typeahead]").typeahead({items:5,minLength:1,source:c,highlighter:a,matcher:b,menu:'<ul class="typeahead dropdown-menu-user-search"></ul>'}),$("body").tapp_on("click",".dropdown-menu-user-search .follow-btn[data-follow-status=0]",function(){TAPP.event_tracking.track_event_server_side("find-friends-click-follow")})}});TAPP.welcome=new a,TAPP.welcome.register_post_load_hooks({init_welcome:TAPP.welcome.init_welcome})}(),function(){var a=TAPP.Module.extend({settings_view_init:function(){this.file_uploads(),this.confirm_deauthorize(),this.my_stream_settings_form(),this.hash_expand(),this.settings_accordion(),this.authorized_apps_accordion(),this.confirm_username(),this.confirm_account_upgrade(),this.discounted_user_creator(),$("#id_language,#id_timezone").select2({width:"250px"}),$("[data-error-form]").click()},file_uploads:function(){if($("[data-image-upload]").attr("disabled")!==undefined)return $("[data-image-uploads]").addClass("hide"),$("[data-impage-upload-unsupported]").removeClass("hide"),!1;$("body").on("change","[data-image-upload]",function(){var a=$(this).closest(".uploader-block");a.find(".icon-check, .icon-check-empty").addClass("hide"),a.find(".spinner").removeClass("hide"),$(this).closest("form").submit()})},confirm_deauthorize:function(){$("body").tapp_on("click","[data-deauthorize]",function(){var a=$(this),b=TAPP.lock_up(a),c=a.closest("form"),d=a.data("app-name"),e,f={Cancel:{click:function(){return e.remove(),b(),!1}},Deauthorize:{click:function(){return e.remove(),b(),c.submit(),!1},text:"Deauthorize","class":"btn btn-danger"}},g={title:"<strong>Deauthorize "+d+"</strong>",buttons:f};return e=TAPP.dialogs.markup_dialog("Are you sure you want to deauthorize this app?",g),e.show(),!1})},confirm_username:function(){$("body").tapp_on("click","[data-change-username]",function(){var a=$(this).closest("form"),b,c={Cancel:{click:function(){b.remove()}},Confirm:{click:function(){return a.submit(),b.remove(),!1},text:"Change Username","class":"btn btn-danger"}},d={title:"<strong>Change Username</strong>",buttons:c};return b=TAPP.dialogs.markup_dialog("Are you sure you want to change your username? You will not be able to change it ever again after this.",d),b.show(),!1})},confirm_account_upgrade:function(){$("body").tapp_on("click","[data-upgrade-account]",function(){var a=$(this).attr("data-upgrade-last-4"),b=$(this).attr("data-upgrade-amount"),c=$(this).closest("form"),d,e={Cancel:{click:function(){d.remove()}},Confirm:{click:function(){return c.submit(),d.remove(),!1},text:"Upgrade Account","class":"btn btn-primary"}},f={title:"<strong>Upgrade Account</strong>",buttons:e};return d=TAPP.dialogs.markup_dialog("Are you sure you want to upgrade your account? Your card ending in "+a+" will be billed $"+b+".",f),d.show(),!1})},my_stream_settings_form:function(){$("body").tapp_on("change","[data-my-stream-settings] input",function(){var a=$(this).closest("form");a.submit()})},hash_expand:function(){var a=window.location.hash,b=a.substr(1,a.length);b&&($("[data-expandable-setting]").each(function(a,b){$(b).removeClass("expanded")}),$("[name="+b+"]").addClass("expanded"))},settings_accordion:function(){var a=250;$("body").on("click","[data-expandable-setting]",function(){var a=$(this);a.hasClass("expanded")||($("[data-expandable-setting].expanded").removeClass("expanded"),a.addClass("expanded"))})},authorized_apps_accordion:function(){$("body").on("click","[data-expand-authorized-app]",function(){var a=$(this).closest(".authorized-app");return a.hasClass("expanded")||($(".authorized-apps-list .authorized-app").removeClass("expanded"),a.addClass("expanded")),!1})},payment_details_init:function(){$("#id_country_code,#id_plan_choice").select2({width:"250px"});var a=$("[data-card-details]"),b=$("[data-card-details-form]");$("body").on("click","[data-edit-card-details]",function(){return a.addClass("hide"),b.removeClass("hide"),!1}),TAPP.stripe.init();var c=$("#payment-form");c.on("submit",function(a){var b=$("[data-spinner]");return b.removeClass("hide"),a.preventDefault(),TAPP.stripe.handle_form_submit(c).done(function(){var a={stripe_token:$("#stripe_token").val(),country_code:$("#id_country_code").val(),action:"update_payment_details"};$(".payment-errors").text(""),$.post(window.location.href,a).done(function(a){if(a.result==="error"){$(".payment-errors").text(a.response.message),$(".hide-on-payment-error").addClass("hide");if(a.response.error_type==="card"){var b=$("#card-number");b.closest(".control-group").addClass("error"),$("body").on("change",b,function(){b.closest(".control-group").removeClass("error"),$("body").off("change",b)})}else a.response.error_type==="user_details"&&TAPP.utils.show_form_errors(c,a.response.form_errors)}else $("[data-card-update-complete]").submit()}).fail(function(){$(".payment-errors").text("Something is wrong with the server. Please wait a moment and try again.")}).always(function(){$(".submit-button").removeAttr("disabled"),b.addClass("hide")})}).fail(function(a){$.publish("track_event",["pau-payment-info-change-error",{type:a.error.type,param:a.error.param?a.error.param:"no param",code:a.error.code?a.error.code:"no code"}]),b.addClass("hide")}),!1})},developer_enrollment_init:function(){$("#id_country").select2({width:"250px"})},discounted_user_creator:function(){$("body").on("click","[data-create-discounted-user]",function(){return $.ajax({url:window.location.href,type:"POST",data:{action:"add_discounted_code"},success:function(a){window.location.reload()}}),!1})},submission_lockup:function(){$("body").on("click","[data-submit-for-approval]",function(){TAPP.lock_up($(this))})},init_app_feedback:function(){fdSlider.rescanDocument(),$(".feedback-widget").each(function(){var a=$(this);a.find(".notch").css({width:a.find(".fd-slider-range").css("width")})})},init_star_app_feedback:function(){var a=function(a){$.ajax({url:window.location.href,type:"POST",data:{action:"star_rating",rating:a}})};$("[data-star-rating]").each(function(){var b=$(this),c=b.data("target");b.raty({cancel:!0,target:c,targetKeep:!0,targetType:"number",number:10,size:74,hintList:["","","","","","","","","",""],path:"/static/palama/images/",click:a})})}});TAPP.settings_view=new a,TAPP.settings_view.register_post_load_hooks({settings_view_init:TAPP.settings_view.settings_view_init,payment_details_init:TAPP.settings_view.payment_details_init,developer_enrollment_init:TAPP.settings_view.developer_enrollment_init,submission_lockup:TAPP.settings_view.submission_lockup,init_app_feedback:TAPP.settings_view.init_app_feedback,init_star_app_feedback:TAPP.settings_view.init_star_app_feedback})}(),function(){var a=TAPP.Module.extend({init_developer:function(){this.edit_redirect_uris()},edit_redirect_uris:function(a,b){$("body").on("click","[data-remove-redirect-uri]",function(){var a=$(this),b=a.data("remove-redirect-uri"),c=a.closest("li");return c.addClass("hide"),$.post(window.location.href,{action:"modify_redirect_uris",redirect_uri:b,app_id:page_context.app_id}).fail(function(){c.removeClass("hide"),TAPP.dialogs.error_dialog("Sorry we couldn't remove that Callback URL. Please wait a moment and try again.")}).done(function(){c.remove()}),!1});var c=$("[data-add-redirect-uri-input]"),d=$("[data-redirect-uris]"),e=function(a,b,c){a.remove(),b.val(c)},f=function(a){TAPP.dialogs.error_dialog(a+" is a duplicate Callback URL.")};$("body").on("click","[data-add-redirect-uri-button]",function(){var a=$(this),b=TAPP.lock_up(a),g=$.trim(c.val()).toLowerCase();if(g==="")return b(),!1;var h=!1;d.find("li a").each(function(){var a=$(this).data("remove-redirect-uri").toLowerCase();a===g&&(h=!0,f(g))});if(h)return b(),!1;var i=$('<li><a href="#remove" data-remove-redirect-uri="'+g+'">&times;</a> '+g+"</li>");return d.append(i),c.val(""),$.post(window.location.href,{action:"modify_redirect_uris",redirect_uri:g,app_id:page_context.app_id,add:"1"}).always(b).fail(function(){e(i,c,g),TAPP.dialogs.error_dialog("Sorry we couldn't add that Callback URL. Please wait a moment and try again.")}).done(function(a){a.status==="error"&&(e(i,c,g),a.form_errors&&a.form_errors.redirect_uri&&f(g))}),!1})},init_screenshots:function(){$("body").tapp_on("change","[data-image-upload] input[type=file]",function(a){$(this).closest("form").submit()}),$("[data-image-upload]").tapp_on("submit",function(a){var b=$(this),c=b.data("replace"),d=$(b.data("asset-output"));return b.ajaxSubmit({iframe:!0,resetForm:!0,url:""+window.location,dataType:"json",success:function(a){d.data("has-assets")||(c=!0),a.status==="ok"?(c?d.html(a.html):d.append(a.html),d.data("has-assets",!0)):TAPP.dialogs.error_dialog(a.msg)},error:function(){TAPP.dialogs.error_dialog(),b.resetForm()}}),!1}),$("body").tapp_on("click","[data-delete-asset]",function(a){var b=$(this),c=TAPP.lock_up(b),d=b.data("asset-id"),e=function(){var a=b.closest(".screenshot-container");a.hide(),$.ajax({type:"POST",url:""+window.location,data:{asset_id:d,action:"delete_image"}}).fail(function(){TAPP.dialogs.error_dialog(),a.show()}).done(function(){a.remove()}).always(function(){c()})},f,g={Cancel:{click:function(){f.remove(),c()}},Delete:{click:function(){return e(),f.remove(),!1},text:"Delete","class":"btn btn-danger"}},h={title:"<strong>Delete Screenshot</strong>",buttons:g};return f=TAPP.dialogs.markup_dialog("Are you sure you want to delete this screenshot?",h),f.show(),!1})},init_markdown_preview:function(){var a=$("[data-markdown-widget]"),b=a.find("[data-markdown-widget-body]"),c=b.find("[data-markdown-preview]"),d=b.find("textarea"),e=function(){var a=d.val();c.html('<div class="loader"></div>'),$.post(window.location.href,{markdown:a,action:"markdown_preview"}).done(function(a){c.html(a)}).fail(function(){c.html(""),TAPP.dialogs.error()})};$("body").tapp_on("click","[data-markdown-toggle]",function(){return a.toggleClass("previewing").toggleClass("editing"),a.hasClass("previewing")&&e(),!1})},init_delete_page:function(){$("body").tapp_on("click","[data-delete-page]",function(a){var b=$(this),c=TAPP.lock_up(b),d=function(){$.ajax({type:"POST",url:window.location.href,data:{action:"delete_page"}}).fail(function(){TAPP.dialogs.error_dialog()}).done(function(a){window.location=a}).always(function(){c()})},e,f={Cancel:{click:function(){e.remove(),c()}},Delete:{click:function(){return d(),e.remove(),!1},text:"Delete","class":"btn btn-danger"}},g={title:"<strong>Delete This Page</strong>",buttons:f};return e=TAPP.dialogs.markup_dialog("Are you sure you want to delete this page?",g),e.show(),!1})}});TAPP.developer=new a,TAPP.developer.register_post_load_hooks({init_developer:TAPP.developer.init_developer,init_screenshots:TAPP.developer.init_screenshots,init_markdown_preview:TAPP.developer.init_markdown_preview,init_delete_page:TAPP.developer.init_delete_page})}(),$(document).ready(function(){var a=function(){var a=page_context.page_load_hooks;a&&($.isArray(page_context.page_load_hooks)||(a=[a]),$.each(page_context.page_load_hooks,function(a,b){if(b.indexOf(".")!==-1){var c=b.split("."),d=TAPP,e;$.each(c,function(a,b){e=d,d=d[b]}),$.isFunction(d)&&d.call(e)}else $.publish(b)}))};a(),$.publish("js_init_done"),$.subscribe("pjax.end",function(){TAPP.unload(),$.each(TAPP,function(){this&&this.unload&&this.unload()}),a()})});