(function(a,d,e){var g=a.Sys,b=a.$addHandler,f=a.$removeHandler,c=a.Function.createDelegate;CF.BookingEngineType.trackingNames=["FLI","FLI","FLI","CAR","ACC","F_H","F_C","FCH","HOL"];CF.BETripType.trackingNames=["OW","RT","MD"];CF.BETicketClass=function(){};CF.BETicketClass.prototype={Economy:0,Business:1,First:2};e(CF.BETicketClass,"CF.BETicketClass");CF.BETicketClass.trackingNames=["E","B","F"];CF.BookingEngineStepOneBehavior=function(h){this._newSearchLink=null;this._onNewSearchLinkClickHandler=null;this._hourlyBookingEngineTypes=null;this._headerElement=null;this._messagePanelElement=null;CF.BookingEngineStepOneBehavior.initializeBase(this,[h])};CF.BookingEngineStepOneBehavior.prototype={initialize:function(){this._newSearchLink=this.getChildElement("NewSearch");if(this._newSearchLink){this._onNewSearchLinkClickHandler=c(this,this._onNewSearchLinkClick);this._newSearchLink.href="javascript:void(0);";b(this._newSearchLink,"click",this._onNewSearchLinkClickHandler)}CF.BookingEngineStepOneBehavior.callBaseMethod(this,"initialize")},dispose:function(){if(this._newSearchLink){f(this._newSearchLink,"click",this._onNewSearchLinkClickHandler)}CF.BookingEngineStepOneBehavior.callBaseMethod(this,"dispose")},set_value:function(m){if(m){var i=this.get_fieldBehaviors();for(var j in m){var k=CF.BookingEngineFieldType[j];if(typeof(k)==="number"){var l=m[j];var h=i[k];if(l&&h&&h.set_value){h.set_value(l)}}}this.raisePropertyChanged("value")}},get_hourlyBookingEngineTypes:function(){return this._hourlyBookingEngineTypes},set_hourlyBookingEngineTypes:function(h){this._hourlyBookingEngineTypes=h},get_headerElement:function(){return this._headerElement},set_headerElement:function(h){this._headerElement=h},get_messagePanelElement:function(){return this._messagePanelElement},set_messagePanelElement:function(h){this._messagePanelElement=h},set_active_impl:function(h){CF.BookingEngineStepOneBehavior.callBaseMethod(this,"set_active_impl",[h]);this.foreachField(function(k,j,i){if(j&&typeof j.enabledIfActiveStepOnly==="boolean"&&i&&i.set_enabled){i.set_enabled(!j.enabledIfActiveStepOnly||h)}})},set_nextStep:function(h){CF.BookingEngineStepOneBehavior.callBaseMethod(this,"set_nextStep",[h]);if(h&&this.get_active()){h.set_active(false)}this.doStartupCheck()},selectBookingType:function(j){var h=this.getChildElement("BookingEngineType");if(h==null){return}var l=h.getElementsByTagName("input");for(var k=0;k<l.length;k++){if(l[k].value==j){l[k].click();break}}},createResources:function(){var h=new CF.ResourceCombiner();h.add(CF.BookingEngineStepOneBehavior.callBaseMethod(this,"createResources"));h.add(CF.BookingEngineExtResources);return h},createBehaviorInfos:function(h){var i=CF.BookingEngineStepOneBehavior.callBaseMethod(this,"createBehaviorInfos",[h]);i[CF.BookingEngineFieldType.DepartureRegion].type=CF.BookingEngineRegionTextBoxBehavior;i[CF.BookingEngineFieldType.DestinationRegion].references={pairedRegionTextBox:this.getFieldElementId(CF.BookingEngineFieldType.DepartureRegion)+"$BookingEngineRegionTextBoxBehavior"};i[CF.BookingEngineFieldType.DestinationRegion].type=CF.BookingEngineRegionTextBoxBehavior;i[CF.BookingEngineFieldType.DepartureDateTime].type=CF.BookingEngineDateTimeSelectorBehavior;i[CF.BookingEngineFieldType.DepartureDateTime].references={returnDateTimeSelector:this.getFieldElementId(CF.BookingEngineFieldType.ReturnDateTime)+"$BookingEngineDateTimeSelectorBehavior"};i[CF.BookingEngineFieldType.ReturnDateTime].type=CF.BookingEngineDateTimeSelectorBehavior;i[CF.BookingEngineFieldType.EmailSignup]={type:CF.BookingEngineEmailSignupFieldBehavior,properties:{stepOne:this}};return i},createFieldRules:function(){var i=CF.BookingEngineStepOneBehavior.callBaseMethod(this,"createFieldRules");var h=function(j){var k=i[CF.BookingEngineFieldType.DepartureRegion];if(jQuery.isArray(k)){k=k[0]}k.enabledIfActiveStepOnly=true};h(CF.BookingEngineFieldType.DepartureRegion);h(CF.BookingEngineFieldType.DestinationRegion);return i},displayErrors:function(i){CF.BookingEngineStepOneBehavior.callBaseMethod(this,"displayErrors",[i]);var j=(i&&i.get_errorCount()>0);var l=this.getChildElement("MainFields");var h=l.firstChild;while(h){var m=h.nextSibling;if(h.nodeType===1&&(g.UI.DomElement.containsCssClass(h,"cf-be-error-header")||g.UI.DomElement.containsCssClass(h,"cf-be-error-message"))){l.removeChild(h)}h=m}this.foreachField(function(q,p,n){if(n){var o=(n.get_container?n.get_container():n.get_element());if(i&&i.hasError(q)){var r=i.getMessage(q);if(r){var t=o;while(t&&t.parentNode!==l){t=t.parentNode}var s=document.createElement("strong");s.appendChild(document.createTextNode(r));s.className="cf-be-error-message";l.insertBefore(s,t)}}}});if(j){var k=document.createElement("strong");k.appendChild(document.createTextNode(this.get_resources().ErrorHeader));k.className="cf-be-error-header";l.insertBefore(k,l.firstChild)}},logSearchRequest:function(k){if(typeof(BEsearch)==="function"){var i=86400000;var j=Math.floor(new Date().getTime()/i)*i;var h=function(l){return l?l.Text+(l.RegionCode?"("+l.RegionCode+")":""):""};BEsearch(document.forms[0].action.replace(location.protocol+"//"+location.host,""),h(k.DepartureRegion),h(k.DestinationRegion),CF.BookingEngineType.trackingNames[k.BookingEngineType],CF.BETripType.trackingNames[k.TripType],CF.BETicketClass.trackingNames[k.TicketClass],(k.DepartureDateTime?Math.floor((k.DepartureDateTime.DateTime.getTime()-j)/i):null),(k.DepartureDateTime&&k.ReturnDateTime?Math.floor((k.ReturnDateTime.DateTime.getTime()-k.DepartureDateTime.DateTime.getTime())/i):null),(k.DepartureDateTime?CF.BookingEngineTime.toString(k.DepartureDateTime.TimeType):null),(k.ReturnDateTime?CF.BookingEngineTime.toString(k.ReturnDateTime.TimeType):null),(k.NumberOfAdults||0)+"|"+(k.NumberOfChildren||0)+"|"+(k.NumberOfInfants||0),(k.NumberOfRooms||0),(k.StarRating||0),(k.DriverAge||0))}},updateMessages:function(h){var l=this.get_resources();var i=CF.BookingEngineType.toString(h);if(this.get_headerElement()){this.get_headerElement().innerHTML=(l["Header"+i]||l.Header)}if(this.get_messagePanelElement()){var k=this.get_messagePanelElement().getElementsByTagName("p");var j;if(k&&k.length>0){j=k[0]}else{j=document.createElement("p");this.get_messagePanelElement().appendChild(j)}j.innerHTML=(l["Description"+i]||l.Description)}},add_searchRequested:function(h){this.get_events().addHandler("searchRequested",h)},remove_searchRequested:function(h){this.get_events().removeHandler("searchRequested",h)},add_principalFieldValueChanged:function(h){this.get_events().addHandler("principalFieldValueChanged",h)},remove_principalFieldValueChanged:function(h){this.get_events().removeHandler("principalFieldValueChanged",h)},onPrincipalFieldValueChanged:function(i){CF.BookingEngineStepOneBehavior.callBaseMethod(this,"onPrincipalFieldValueChanged",[i]);var j=this.get_events().getHandler("principalFieldValueChanged");if(j){var h=new g.EventArgs();var k=this.get_value();h.get_value=function(){return k};h.get_fieldType=function(){return i};j(this,h)}if(i==CF.BookingEngineFieldType.BookingEngineType){this.updateMessages(this.get_bookingEngineType());this._updateTimeGranularity(this.get_bookingEngineType())}},doSearch:function(m){var i=false;var l=this.get_events().getHandler("searchRequested");this.logSearchRequest(m);if(l){var h=new g.EventArgs();h.get_value=function(){return m};h.handled=false;l(this,h);i=h.handled}if(!i){var k=this.get_postBackUrl();if(k){CF.FormSubmitter.submit({"cf-be-state":m},"post",k,"");i=true}else{i=this.doPostback()}}else{var j=jQuery.noConflict();if(typeof j==="function"){j("body").trigger("search.bookingengine")}}return i},doPostback:function(){var h=this.get_searchButton();if(h){if(typeof __doPostBack=="function"){__doPostBack(h.name,"");return true}}return false},_onNewSearchLinkClick:function(i){this.set_active(true);var h=this.get_fieldBehaviors();var k=function(l){return l&&l.get_visible&&l.get_visible()?l.get_element():null};var j=k(h[CF.BookingEngineFieldType.DepartureRegion])||k(h[CF.BookingEngineFieldType.DestinationRegion]);if(j){j.focus();j.select()}CF.Track.trackAdditional("ChangeSearch","","BE")},_updateTimeGranularity:function(h){var i=this.get_hourlyBookingEngineTypes();var j=(i&&a.Array.contains(i,h));this._updateFieldTimeGranularity(CF.BookingEngineFieldType.DepartureDateTime,j);this._updateFieldTimeGranularity(CF.BookingEngineFieldType.ReturnDateTime,j)},_updateFieldTimeGranularity:function(j,k){var h=this.get_fieldBehaviors()[j];if(h){var i=h.get_value();if(i&&(i.TimeType===CF.BookingEngineTime.UseDate)!=k){i.TimeType=(k?CF.BookingEngineTime.UseDate:CF.BookingEngineTime.Anytime);h.set_value(i)}}}};d(CF.BookingEngineStepOneBehavior,"CF.BookingEngineStepOneBehavior",CF.BookingEngineStepOneBehaviorBase);CF.BookingEngineSearchPartnersStatus=function(){};CF.BookingEngineSearchPartnersStatus.prototype={OK:0,InvalidDeparture:1,InvalidDestination:2,DuplicateRegion:3,ServiceError:4};e(CF.BookingEngineSearchPartnersStatus,"CF.BookingEngineSearchPartnersStatus");CF.BookingEnginePositionType=function(){};CF.BookingEnginePositionType.prototype={Image:0,Link:1,DropDown:2};e(CF.BookingEnginePositionType,"CF.BookingEnginePositionType");CF.BookingEngineStepTwoBehavior=function(h){CF.BookingEngineStepTwoBehavior.initializeBase(this,[h]);this._onStepOneSearchRequestedHandler=c(this,this._onStepOneSearchRequested);this._onStepOnePrincipalFieldValueChangedHandler=c(this,this._onStepOnePrincipalFieldValueChanged);this._onSearchCompleteHandler=null;this._onSearchErrorHandler=null;this._callIndex=0;this._disposed=false;this._partners=null;this._onPartnerClickHandler=null;this._onTabClickHandler=c(this,this._onTabClick);this._showStageTwoTabs=false;this._thirdLevelSelect=null;this._inActiveImageFormat="/i/IMG-BE-LOGOS.gif";this._progressIndicator=null;this._searchSelectionUrl="/workers/selection.aspx";this._partnerSelectUrl="/workers/partnerselect.aspx";this._enableAjaxRegionSearch=false;this._siteVersion=5;this._responseId=null;this._trackingImages=null;this._partnerDisplayDescription=null;this._progressImage=null;this._partnerLinksInitialized=false;this._searchPending=false;this._trackingMarker=" SITECONFIDENCE "};CF.BookingEngineStepTwoBehavior.prototype={initialize:function(){var h=this.get_partners();if(h){this._initPartnerLinks(h);this._impressionTrackPartners(h)}if(this._showStageTwoTabs){this._initTabLinks()}CF.BookingEngineStepTwoBehavior.callBaseMethod(this,"initialize")},dispose:function(){this._disposed=true;CF.BookingEngineStepTwoBehavior.callBaseMethod(this,"dispose")},get_trackingMarker:function(){return this._trackingMarker},get_inActiveImageFormat:function(){return this._inActiveImageFormat},set_inActiveImageFormat:function(h){this._inActiveImageFormat=h},get_enableAjaxRegionSearch:function(){return this._enableAjaxRegionSearch},set_enableAjaxRegionSearch:function(h){this._enableAjaxRegionSearch=h},get_siteVersion:function(){return this._siteVersion},set_siteVersion:function(h){this._siteVersion=h},get_partners:function(){return this._partners},set_partners:function(h){this._partners=h},get_responseId:function(){return this._responseId},set_responseId:function(h){this._responseId=h},get_partnerDisplayDescription:function(){return this._partnerDisplayDescription},set_partnerDisplayDescription:function(h){this._partnerDisplayDescription=h},get_searchSelectionUrl:function(){return this._searchSelectionUrl},set_searchSelectionUrl:function(h){this._searchSelectionUrl=h},get_partnerSelectUrl:function(){return this._partnerSelectUrl},set_partnerSelectUrl:function(h){this._partnerSelectUrl=h},get_showStageTwoTabs:function(){return this._showStageTwoTabs},set_showStageTwoTabs:function(h){this._showStageTwoTabs=h},set_previousStep:function(i){var h=this.get_previousStep();if(h!==i){if(h){h.remove_searchRequested(this._onStepOneSearchRequestedHandler);h.remove_principalFieldValueChanged(this._onStepOnePrincipalFieldValueChangedHandler)}if(i){i.add_searchRequested(this._onStepOneSearchRequestedHandler);i.add_principalFieldValueChanged(this._onStepOnePrincipalFieldValueChangedHandler)}CF.BookingEngineStepTwoBehavior.callBaseMethod(this,"set_previousStep",[i])}},set_active_impl:function(j){var h=this.get_active();CF.BookingEngineStepTwoBehavior.callBaseMethod(this,"set_active_impl",[j]);if(!j){var i=this.get_previousStep();if(i){this._displayInActiveState(i.get_bookingEngineType(),!h)}}},_getContainer:function(){return this.getChildElement("Container")},_getTabs:function(){return this.getChildElement("Tabs")},createResources:function(){var h=new CF.ResourceCombiner();h.add(CF.BookingEngineStepTwoBehavior.callBaseMethod(this,"createResources"));h.add(CF.BookingEngineExtResources);return h},performSearch:function(h){if(this._showStageTwoTabs){this.setTabState(h.BookingEngineType)}if(!this._onSearchCompleteHandler){this._onSearchCompleteHandler=c(this,this._onSearchComplete);this._onSearchErrorHandler=c(this,this._onSearchError)}this._removePartnerLinkHandlers();g.Net.WebServiceProxy.invoke("/ajax/BookingEngineService.asmx","SearchPartners",false,{state:h,targetPageTypeCode:this.get_previousStep().get_targetPageTypeCode()},this._onSearchCompleteHandler,this._onSearchErrorHandler,{callIndex:++this._callIndex});this._showProgressIndicator()},setTabState:function(h){var j=a.$get("cf-be-step2-tab-flightsonly");var i=a.$get("cf-be-step2-tab-flightshotels");j.className=j.className.replace(" selected","");i.className=i.className.replace(" selected","");switch(h){case CF.BookingEngineType.EconomyFlight:j.className=j.className+" selected";break;case CF.BookingEngineType.FlightHotel:i.className=i.className+" selected";break;default:j.className=j.className.replace("selected","");i.className=i.className.replace("selected","");break}},_initTabLinks:function(){var l=this._getTabs();var k=l.getElementsByTagName("a");for(var h=0;h<k.length;h++){var j=k[h];if(j){j.tabIdx=h;b(j,"click",this._onTabClickHandler)}}},_onTabClick:function(i){var k=i.target;if(!k.rel){k=i.target.parentNode}var h=CF.BookingEngineType.EconomyFlight;if(k.rel=="flightsonly"){h=CF.BookingEngineType.EconomyFlight}else{if(k.rel=="flightshotels"){h=CF.BookingEngineType.FlightHotel}}var j=this.get_previousStep();if(j){j.selectBookingType(h)}i.preventDefault()},_onStepOneSearchRequested:function(i,h){if(this.get_enableAjaxRegionSearch()){this.performSearch(h.get_value());h.handled=true}},_onStepOnePrincipalFieldValueChanged:function(j,h){if(this.get_active()){var i=h.get_fieldType(),k=this.get_previousStep().validate(true);if(this._searchPending||i==CF.BookingEngineFieldType.BookingEngineType||i==CF.BookingEngineFieldType.TripType||i==CF.BookingEngineFieldType.TicketClass||i==CF.BookingEngineFieldType.DepartureDateTime){this._searchPending=!k;if(k){this.performSearch(h.get_value())}else{if(i==CF.BookingEngineFieldType.BookingEngineType){this.set_active(false);this._searchPending=false}}}}else{this._displayInActiveState(h.get_value().BookingEngineType,true)}},_displayInActiveState:function(h,n){var j=this._getContainer();var i=CF.BookingEngineType.toString(h);var m=j.getElementsByTagName("img"),l;if(n&&m.length==1){l=m[0]}if(!l){j.innerHTML="";var k=document.createElement("h3");k.innerHTML=this.get_resources().StepTwoDescription;j.appendChild(k);l=document.createElement("img");j.appendChild(l)}l.src=this.get_inActiveImageFormat().replace(/(\{0\})/g,i)},_onSearchComplete:function(j,l,i){if(!this._disposed&&l.callIndex===this._callIndex){var k=this.get_previousStep();this._hideProgressIndicator();this._partners=null;this._thirdLevelSelect=null;switch(j.Status){case CF.BookingEngineSearchPartnersStatus.OK:this.set_active(true);k.set_value(j.ReturnState);this.set_partners(j.Partners);this.set_responseId(j.ResponseId);this._displaySearchPartners(j.Partners);this._impressionTrackPartners(j.Partners);break;case CF.BookingEngineSearchPartnersStatus.DuplicateRegion:var h=new CF.BookingEngineFieldErrors(this.get_resources());h.add(CF.BookingEngineFieldType.DepartureRegion);h.add(CF.BookingEngineFieldType.DestinationRegion,this.get_resources().DuplicateRegionErrorMessage);k.displayErrors(h);this.set_active(false);break;case CF.BookingEngineSearchPartnersStatus.InvalidDeparture:case CF.BookingEngineSearchPartnersStatus.InvalidDestination:window.location.href=this.get_searchSelectionUrl();break;default:this._showSearchErrorMessage(this.get_resources().GenericSearchErrorMessage);break}}},_displaySearchPartners:function(p){var h=this._getContainer();if(p&&p.length>0){h.innerHTML="";var j=document.createElement("h3");j.appendChild(document.createTextNode(this.get_resources().SearchPartnersHeading));h.appendChild(j);var s;for(var k=0;k<p.length;k++){var o=p[k];switch(o.PositionType){case CF.BookingEnginePositionType.Image:var l=document.createElement("a");var n=document.createElement("img");n.src=o.LogoUrl;n.alt=o.LogoAltText;l.className="cf-be-prem-partner";l.appendChild(n);h.appendChild(l);break;case CF.BookingEnginePositionType.Link:var m=document.createElement("a");m.className="cf-be-level2-partner";m.appendChild(document.createTextNode(o.BrandName));h.appendChild(m);break;default:if(!s){s=document.createElement("select");var q=document.createElement("button");s.id=this.get_element().id+"_thirdLevelSelect";if(k){var r=document.createElement("label");r.appendChild(document.createTextNode(this.get_resources().OtherWebsitesLabelText));r.htmlFor=s.id;h.appendChild(r)}h.appendChild(s);h.appendChild(q)}s.options[s.length]=new Option(o.BrandName);break}}h.appendChild(document.createComment(this.get_trackingMarker()));this._initPartnerLinks(p)}else{this._showSearchErrorMessage(this.get_resources().NoPartnersSearchErrorMessage)}},_initPartnerLinks:function(t){if(t){if(!this._onPartnerClickHandler){this._onPartnerClickHandler=c(this,this._onPartnerClick)}var k=this._getContainer();var q=k.getElementsByTagName("a");var u=k.getElementsByTagName("select");var p=0,r=0;var h=(this.get_partnerDisplayDescription()===CF.DescriptionLinkType.Hover&&CF.DescriptionLink);if(u&&u.length>0){this._thirdLevelSelect=u[0];var j=k.getElementsByTagName("button");if(j&&j.length>0){b(j[0],"click",this._onPartnerClickHandler);var m=new CF.HoverCssClassBehavior(j[0]);m.initialize()}}for(var n=0;n<t.length;n++){var s=t[n];switch(t[n].PositionType){case CF.BookingEnginePositionType.Image:case CF.BookingEnginePositionType.Link:var o=q[p];if(o){o._partnerIndex=n;o._partner=s;o.href="javascript:void(0);";b(o,"click",this._onPartnerClickHandler);if(h&&s.DisplayDescription){var l=new CF.DescriptionLink(o);l.set_message(s.DisplayDescription);l.initialize()}}p++;break;default:if(this._thirdLevelSelect){this._thirdLevelSelect.options[r]._partnerIndex=n;this._thirdLevelSelect.options[r]._partner=s;r++}break}}this._partnerLinksInitialized=true}},_removePartnerLinkHandlers:function(){if(this._partnerLinksInitialized){var j=this._getContainer();var l=j.getElementsByTagName("a");var h=j.getElementsByTagName("button");for(var k=0;k<l.length;k++){f(l[k],"click",this._onPartnerClickHandler)}if(h&&h.length>0){f(h[0],"click",this._onPartnerClickHandler)}this._partnerLinksInitialized=false}},_onSearchError:function(j,i,h){this._showSearchErrorMessage(this.get_resources().GenericSearchErrorMessage)},_showSearchErrorMessage:function(i){var h=this._getContainer();var j=document.createElement("strong");this._hideProgressIndicator();this.set_active(true);j.appendChild(document.createTextNode(i));h.innerHTML="";h.appendChild(j)},_onPartnerClick:function(h){if(this.get_previousStep().validate(true)){var i;if(h.target.tagName==="BUTTON"&&this._thirdLevelSelect&&this._thirdLevelSelect.selectedIndex>=0){i=this._thirdLevelSelect.options[this._thirdLevelSelect.selectedIndex]}else{i=h.target;if(!i._partner){i=h.target.parentNode}}if(i._partner){this._partnerSelect(i._partner,i._partnerIndex+1,this.get_partners().length,i._partnerIndex+1);h.preventDefault()}}},_partnerSelect:function(l,k,h,r){if(l){var q=this.get_previousStep();var p=q.get_value();var o={State:p,BrandCode:l.BrandCode};var j=jQuery.noConflict();var i=CreateDuplicateClickDetectionHash(_tag.DCSext.eid,l.CampaignItemCode,null,null,j.toJSON(o));var m=this.get_partnerSelectUrl();var n={State:p,Partner:{InventoryId:l.InventoryId,BrandName:l.BrandName,DepartureRegionCode:l.DepartureRegionCode,DestinationRegionCode:l.DestinationRegionCode,LogoUrl:l.LogoUrl,PositionType:l.PositionType,TrackingCode:l.TrackingCode,LinkCode:l.LinkCode,CampaignItemCode:l.CampaignItemCode,Id:l.Id},PagePosition:k,BlockSize:h,SubPosition:r,PageType:this.get_previousStep().get_targetPageTypeCode(),ResponseId:this.get_responseId(),EventId:createEid(),ClickOutId:i};this._trackPartnerSelect(n,m);CF.FormSubmitter.submit({"cf-be-ps-request":n},"post",m,"_partner"+l.InventoryId);var s="_partner"+l.InventoryId}},_trackPartnerSelect:function(k,j,m){if(typeof(LogToSS)==="function"){var l=k.State;var i=k.Partner;if(l.TicketClass==m){l.TicketClass=0}var h="/goto.aspx?clickoutid="+k.ClickOutId+"&y=be&bi="+i.InventoryId+"&pi="+k.PageType+"&pagedep="+(l.DepartureRegion?l.DepartureRegion.RegionCode:"")+"&pagedest="+(l.DestinationRegion?l.DestinationRegion.RegionCode:"")+"&linkdep="+i.DepartureRegionCode+"&linkdest="+i.DestinationRegionCode+"&pt=PRM&pp="+k.PagePosition+"&bs="+k.BlockSize+"&sp="+k.SubPosition+"&v="+this.get_siteVersion()+"&cls="+CF.BETicketClass.trackingNames[l.TicketClass]+"&pd="+CF.BookingEngineType.trackingNames[l.BookingEngineType]+"&eid="+k.EventId+"&ci="+i.CampaignItemCode+"&dl="+i.LinkCode+"&tl="+i.TrackingCode+"&dc=WW&t="+encodeURIComponent(j);if(logExitEvent){logExitEvent(h,k.EventId)}}},_showProgressIndicator:function(){if(!this._progressIndicator){if(!this._progressImage){this._progressImage=new Image();this._progressImage.src=g.Net.UrlResolver.resolveStaticsUrl("/images/i/IMG-BE-progress-UMXj5w.gif")}var h=this._getContainer();this._progressIndicator=document.createElement("div");this._progressIndicator.className="cf-be-progress";this._progressIndicator.style.height=Math.max(h.offsetHeight-10,0)+"px";h.appendChild(this._progressIndicator)}},_hideProgressIndicator:function(){if(this._progressIndicator){this._progressIndicator.parentNode.removeChild(this._progressIndicator);this._progressIndicator=null}},_impressionTrackPartners:function(m){if(m){var h=this._getContainer();this._trackingImages=[];for(var k=0;k<m.length;k++){var p=m[k].Tracking;if(!p){var j=new Date();if(m[k].InventoryId===1491){p={ImageUrl:"http://ad.doubleclick.net/ad/N6333.1452.CHEAPFLIGHTS/B6163325;sz=1x1;ord="+j.getTime()+"?"}}else{if(m[k].InventoryId===2754){p={ImageUrl:"http://ad.doubleclick.net/ad/N6333.1452.CHEAPFLIGHTS/B5865488;sz=1x1;ord="+j.getTime()+"?"}}}}if(p){if(p.ImageUrl){var l=new Image();l.src=p.ImageUrl;this._trackingImages[this._trackingImages.length]=l}if(p.ScriptUrl){var o=document.createElement("script");o.type="text/javascript";o.src=p.ScriptUrl;h.appendChild(o)}if(p.Script){var n=document.createElement("script");n.type="text/javascript";n.text=p.Script;h.appendChild(n)}}}}}};d(CF.BookingEngineStepTwoBehavior,"CF.BookingEngineStepTwoBehavior",CF.BookingEngineStepBehavior);CF.DescriptionLinkType=function(){};CF.DescriptionLinkType.prototype={None:0,Inline:1,Hover:2};e(CF.DescriptionLinkType,"CF.DescriptionLinkType");CF.DescriptionLink=function(h){CF.DescriptionLink.initializeBase(this,[h]);this._message=null;this._messagePanel=null;this._onMessagePanelClickHandler=null};CF.DescriptionLink.prototype={initialize:function(){CF.DescriptionLink.callBaseMethod(this,"initialize");var i=this.get_message();if(i){var h=this.get_element();var j=this._messagePanel=document.createElement("strong");j.className="cf-link-description-panel";this._onMessagePanelClickHandler=c(this,this._onMessagePanelClick);b(j,"click",this._onMessagePanelClickHandler);j.appendChild(document.createTextNode(i));h.appendChild(j)}},dispose:function(){CF.DescriptionLink.callBaseMethod(this,"dispose");if(this._onMessagePanelClickHandler){f(this._messagePanel,"click",this._onMessagePanelClickHandler)}},get_message:function(){return this._message},set_message:function(h){this._message=h},_onMessagePanelClick:function(h){h.stopPropagation()}};d(CF.DescriptionLink,"CF.DescriptionLink",CF.StandardBehavior);CF.BookingEngineEmailSignupFieldBehavior=function(h){CF.BookingEngineEmailSignupFieldBehavior.initializeBase(this,[h]);this._stepOne=null;this._radioButtonElements=[];this._textBoxElement=null;this._radioButtonClickedHandler=c(this,this._radioButtonClicked);this._selectedYes=false};CF.BookingEngineEmailSignupFieldBehavior.prototype={initialize:function(){var k=this.get_element().getElementsByTagName("input"),h,j;for(h=0;h<k.length;h++){j=k[h];if(j.type=="radio"){this._radioButtonElements.push(j);b(j,"click",this._radioButtonClickedHandler);if(j.checked&&j.value=="1"){this._showOrHideSignup(true)}}else{this._textBoxElement=j}}CF.BookingEngineEmailSignupFieldBehavior.callBaseMethod(this,"initialize")},dispose:function(){for(var h=0;h<this._radioButtonElements.length;h++){f(this._radioButtonElements[h],"click",this._radioButtonClickedHandler)}CF.BookingEngineEmailSignupFieldBehavior.callBaseMethod(this,"dispose")},get_container:function(){return this.get_element()},get_value:function(){return this._selectedYes&&this._textBoxElement?this._textBoxElement.value:""},get_stepOne:function(){return this._stepOne},set_stepOne:function(h){this._stepOne=h},validate:function(i,h){if(this._selectedYes&&this._textBoxElement){if(!this._textBoxElement.value){h.add(i,h.get_resources().ErrorMessageEmailSignup)}else{if(!a.isValidEmail(this._textBoxElement.value)){h.add(i,h.get_resources().ErrorMessageEmailSignup)}}}},_radioButtonClicked:function(h){var i=h.target.value=="1";if(i){}this._showOrHideSignup(i)},_showOrHideSignup:function(i){var h=this.get_element().getElementsByTagName("div");if(h&&h.length>0){h[0].style.display=i?"block":"none"}if(i){var j=this.get_stepOne(),k=j?j.get_nextStep():null;if(k){k.set_enableAjaxRegionSearch(false)}}else{if(this._textBoxElement){this._textBoxElement.value=""}}this._selectedYes=i}};d(CF.BookingEngineEmailSignupFieldBehavior,"CF.BookingEngineEmailSignupFieldBehavior",CF.StandardBehavior);CF.MiniBookingEngineBehavior=function(h){CF.MiniBookingEngineBehavior.initializeBase(this,[h])};CF.MiniBookingEngineBehavior.prototype={initialize:function(){CF.MiniBookingEngineBehavior.callBaseMethod(this,"initialize")},dispose:function(){CF.MiniBookingEngineBehavior.callBaseMethod(this,"dispose")},createFieldRules:function(){var h=CF.MiniBookingEngineBehavior.callBaseMethod(this,"createFieldRules");linkPositions=[];linkPositions[CF.BookingEngineType.EconomyFlight]=CF.LinkPosition.before;linkPositions[CF.BookingEngineType.FlightHotel]=CF.LinkPosition.before;linkPositions[CF.BookingEngineType.Hotel]=CF.LinkPosition.after;linkPositions[CF.BookingEngineType.CarRental]=CF.LinkPosition.after;h[CF.BookingEngineFieldType.DepartureRegion].listAllLinkPositions=linkPositions;h[CF.BookingEngineFieldType.DestinationRegion].listAllLinkPositions=linkPositions;return h},onPrincipalFieldValueChanged:function(m){CF.MiniBookingEngineBehavior.callBaseMethod(this,"onPrincipalFieldValueChanged",[m]);if(m==CF.BookingEngineFieldType.BookingEngineType){var h=this.get_bookingEngineType();var n=this.get_fieldRules();var j=n[CF.BookingEngineFieldType.DepartureRegion].listAllLinkPositions[h];j=j||CF.LinkPosition.unknown;var l=n[CF.BookingEngineFieldType.DestinationRegion].listAllLinkPositions[h];l=l||CF.LinkPosition.unknown;var i=this.get_fieldBehaviors()[CF.BookingEngineFieldType.DepartureRegion];i.set_listAllLinkPosition(j);var k=this.get_fieldBehaviors()[CF.BookingEngineFieldType.DestinationRegion];k.set_listAllLinkPosition(l)}}};d(CF.MiniBookingEngineBehavior,"CF.MiniBookingEngineBehavior",CF.BookingEngineStepOneBehavior);CF.LinkPosition=function(){};CF.LinkPosition.prototype={unknown:0,before:1,after:2};e(CF.LinkPosition,"CF.LinkPosition",false);CF.BookingEngineRegionTextBoxBehavior=function(h){CF.BookingEngineRegionTextBoxBehavior.initializeBase(this,[h])};CF.BookingEngineRegionTextBoxBehavior.prototype={initialize:function(){CF.BookingEngineRegionTextBoxBehavior.callBaseMethod(this,"initialize")},dispose:function(){CF.BookingEngineRegionTextBoxBehavior.callBaseMethod(this,"dispose")},set_enabled:function(j){var h=this.get_element();if(j){var i=this._getReadOnlyElement(false);if(i){i.parentNode.removeChild(i)}}else{this._getReadOnlyElement(true).innerHTML=this.get_text();h.blur()}h.style.display=j?"":"none"},get_enabled:function(){return this._getReadOnlyElement(false)!=null},set_text:function(i){var h=this._getReadOnlyElement(false);if(h){h.innerHTML=i}CF.BookingEngineRegionTextBoxBehavior.callBaseMethod(this,"set_text",[i])},get_listAllLinkPosition:function(){if(this.get_listAllLink()){var h=this.get_listAllLink().nextSibling;while(h){if(h===this.get_element()){return CF.LinkPosition.before}h=h.nextSibling}return CF.LinkPosition.after}return CF.LinkPosition.unknown},set_listAllLinkPosition:function(h){if(this.get_listAllLink()&&h!==CF.LinkPosition.unknown&&this.get_listAllLinkPosition()!=h){if(h===CF.LinkPosition.before){this.get_container().insertBefore(this.get_listAllLink(),this.get_element())}else{this.get_container().insertBefore(this.get_element(),this._listAllLink)}}},_getReadOnlyElement:function(h){var j,i=this.get_container().getElementsByTagName("p");if(i&&i.length){j=i[0]}else{if(h){j=document.createElement("p");this.get_container().insertBefore(j,this.get_element())}}return j}};d(CF.BookingEngineRegionTextBoxBehavior,"CF.BookingEngineRegionTextBoxBehavior",CF.RegionTextBoxBehavior);CF.BookingEngineDateTimeSelectorBehavior=function(h){CF.BookingEngineDateTimeSelectorBehavior.initializeBase(this,[h]);this._defaultHour=9;this._timeElement=null};CF.BookingEngineDateTimeSelectorBehavior.prototype={initialize:function(){CF.BookingEngineDateTimeSelectorBehavior.callBaseMethod(this,"initialize")},dispose:function(){CF.BookingEngineDateTimeSelectorBehavior.callBaseMethod(this,"dispose")},get_value:function(){var k=CF.BookingEngineDateTimeSelectorBehavior.callBaseMethod(this,"get_value");var j=this.get_timeType();var h=k.DateTime;if(j===CF.BookingEngineTime.UseDate&&h){var i=this._getTimeElement();if(i.selectedIndex>=0){h.setHours(parseInt(i.options[i.selectedIndex].value.substr(1),10))}}k.TimeType=j;return k},set_value:function(h){if(h){this.set_timeType(h.TimeType)}CF.BookingEngineDateTimeSelectorBehavior.callBaseMethod(this,"set_value",[h])},get_defaultHour:function(){return this._defaultHour},set_defaultHour:function(h){if(this.get_defaultHour()!=h){this._defaultHour=h;this.raisePropertyChanged("defaultHour")}},get_timeType:function(){var h=this._getRawTimeValue();if(h){return h.charAt(0)=="h"?CF.BookingEngineTime.UseDate:parseInt(h,10)}return CF.BookingEngineTime.Anytime},set_timeType:function(t){if(typeof t==="number"&&this.get_timeType()!=t){var j=(t===CF.BookingEngineTime.UseDate||this.get_timeType()===CF.BookingEngineTime.UseDate);var p=CF.BookingEngineCoreResources,q=this._getTimeElement();var o=q.options;if(j){o.length=0;if(t!==CF.BookingEngineTime.UseDate){o[o.length]=new Option(p.TimeTypeAnytime,CF.BookingEngineTime.Anytime);o[o.length]=new Option(p.TimeTypeMorning,CF.BookingEngineTime.Morning);o[o.length]=new Option(p.TimeTypeAfternoon,CF.BookingEngineTime.Afternoon);o[o.length]=new Option(p.TimeTypeEvening,CF.BookingEngineTime.Evening)}else{var n=new Date(),s=new Date(n.getFullYear(),n.getMonth(),n.getDate());var k=this.get_defaultHour(),l,r;for(l=0;l<24;l++){s.setHours(l);switch(l){case 0:r=p.HourlyMidnight;break;case 12:r=p.HourlyMidday;break;default:r=s.localeFormat?s.localeFormat("t"):a.Date.localeFormat(s,"t")}o[o.length]=new Option(r,(l<10?"h0":"h")+l,false,(l==k))}}}if(t!==CF.BookingEngineTime.UseDate){for(var m=0;m<o.length;m++){if(o[m].value===t){q.selectedIndex=m;break}}}this.raisePropertyChanged("timeType")}},validate:function(j,i){CF.BookingEngineDateTimeSelectorBehavior.callBaseMethod(this,"validate",[j,i]);var h=this.get_date(),l=this.get_returnDateTimeSelector(),k=l?l.get_date():null;if(h!=null&&k!=null&&h.getTime()==k.getTime()&&this.get_timeType()!=CF.BookingEngineTime.Anytime&&this._getRawTimeValue()>l._getRawTimeValue()){i.add(j);i.add(CF.BookingEngineFieldType.ReturnDateTime,i.get_resources().ErrorMessageDateSequence)}},_getRawTimeValue:function(){var h=this._getTimeElement();return h!=null&&h.selectedIndex>=0?h.options[h.selectedIndex].value:null},_getTimeElement:function(){if(!this._timeElement){var h=this.get_element().getElementsByTagName("select");this._timeElement=h&&h.length?h[h.length-1]:null}return this._timeElement}};d(CF.BookingEngineDateTimeSelectorBehavior,"CF.BookingEngineDateTimeSelectorBehavior",CF.BookingEngineDateSelectorBehavior)}).apply(window,typeof CF=="object"&&CF.Sys?[CF,CF.Type.registerClass,CF.Type.registerEnum]:[window,function(b,c,a){b.registerClass(c,a)},function(c,b,a){c.registerEnum(b,a||false)}]);CF.BookingEngineExtResources={ErrorMessageDestinationRegion:'Please enter a destination point into the "To" field.',DescriptionFlightHotel:"Get premium travel deals when you book cheap flights and hotel reservations at the same time. Let our partners find you the best travel deals available right now.",HeaderHotel:"Book Hotel Reservations",ErrorMessageDepartureRegionCannotBeTheSame:"Sorry but your departure and destination cannot be the same",ErrorMessageReturnDateTime:'Please enter a return date into the "Return" field.',ErrorMessageEmailSignup:"Please enter a valid email address",ErrorMessageDestinationRegionCannotBeTheSame:"Sorry but your departure and destination cannot be the same",ErrorMessageDepartureDateTimeReturnDateTime:'Please enter a valid departure date into the "Depart" field and a valid return date into the "Return" field.',DuplicateRegionErrorMessage:"Sorry but your departure and destination can not be the same.",DescriptionHotel:"Looking for the best deals on hotel reservations for your next trip? Type in your desired travel dates and destination and compare a wide range of travel deals available from our partners.",ErrorMessageDepartureRegionDestinationRegionCannotBeTheSame:"Sorry but your departure and destination cannot be the same",DescriptionCarRental:"Need to book car rentals for your next vacation? Type in your travel dates and we\u0027ll find you the best car rental deals.",SearchPartnersHeading:"Search recommended websites",ErrorMessagePastDate:"Sorry but the departure and/or return dates are in the past. Please check the dates and try again.",GenericSearchErrorMessage:"Sorry but we are unable to search for recommended websites at the moment please try again later.",OtherWebsitesLabelText:"Other websites",ErrorHeader:"Please complete all required fields!",Description:"Know when you want to fly?  Enter your dates for the best airfare deals to your destination.",StepTwoDescription:"Enter your information and click \u2018Search recommended websites\u2019 to find airfare deals with one of our partners, including\u2026",ErrorMessageDateSequence:"Please enter a return date later than the departure date.",NoPartnersSearchErrorMessage:"Sorry we do not have any partners that match your search criteria.",ErrorMessageDepartureRegionDestinationRegion:'Please enter a departure point in the "From" field and a destination point into the "To" field.',ErrorMessageDepartureDateTime:'Please enter a valid departure date into the "Depart" field.',Header:"Book Airline Tickets",HeaderFlightHotel:"Book Flights & Hotels",HeaderCarRental:"Book Car Rental",ErrorMessageDepartureRegion:'Please enter a departure point into the "From" field.'};