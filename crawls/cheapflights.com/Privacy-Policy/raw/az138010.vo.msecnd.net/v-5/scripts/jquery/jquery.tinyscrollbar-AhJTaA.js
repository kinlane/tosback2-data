(function(a){a.tiny=a.tiny||{};a.tiny.scrollbar={options:{axis:"y",wheel:40,scroll:true,lockscroll:true,size:"auto",sizethumb:"auto"}};a.fn.tinyscrollbar=function(d){var c=a.extend({},a.tiny.scrollbar.options,d);this.each(function(){a(this).data("tsb",new b(a(this),c))});return this};a.fn.tinyscrollbar_update=function(c){return a(this).data("tsb").update(c)};function b(q,j){var l=this,p=q,o={obj:a(".viewport",q)},i={obj:a(".overview",q)},k={obj:a(".scrollbar",q)},n={obj:a(".track",k.obj)},m={obj:a(".thumb",k.obj)},r=j.axis==="x",s=r?"left":"top",v=r?"Width":"Height",h=0,g={start:0,now:0},e={},y=("ontouchstart" in document.documentElement)?true:false,x=parseInt(m.obj.css("border-top-width"))+parseInt(m.obj.css("border-bottom-width"));function f(){l.update();t();return l}this.update=function(A){o[j.axis]=o.obj[0]["offset"+v];i[j.axis]=i.obj[0]["scroll"+v];i.ratio=o[j.axis]/i[j.axis];k.obj.toggleClass("disable",i.ratio>=1);n[j.axis]=j.size==="auto"?o[j.axis]:j.size;m[j.axis]=Math.min(n[j.axis],Math.max(0,(j.sizethumb==="auto"?(n[j.axis]*i.ratio):j.sizethumb)));k.ratio=j.sizethumb==="auto"?(i[j.axis]/n[j.axis]):(i[j.axis]-o[j.axis])/(n[j.axis]-m[j.axis]);h=(A==="relative"&&i.ratio<=1)?Math.min((i[j.axis]-o[j.axis]),Math.max(0,h)):0;h=(A==="bottom"&&i.ratio<=1)?(i[j.axis]-o[j.axis]):isNaN(parseInt(A,10))?h:parseInt(A,10);u()};function u(){var A=v.toLowerCase();m.obj.css(s,h/k.ratio);i.obj.css(s,-h);e.start=m.obj.offset()[s];k.obj.css(A,n[j.axis]);n.obj.css(A,n[j.axis]);m.obj.css(A,m[j.axis]-x)}function t(){if(!y){m.obj.bind("mousedown",w);n.obj.bind("mouseup",c)}else{o.obj[0].ontouchstart=function(A){if(1===A.touches.length){w(A.touches[0]);A.stopPropagation()}}}if(j.scroll&&window.addEventListener){p[0].addEventListener("DOMMouseScroll",z,false);p[0].addEventListener("mousewheel",z,false)}else{if(j.scroll){p[0].onmousewheel=z}}}function w(A){var B=parseInt(m.obj.css(s),10);e.start=r?A.pageX:A.pageY;g.start=B=="auto"?0:B;if(!y){a(document).bind("mousemove",c);a(document).bind("mouseup",d);m.obj.bind("mouseup",d)}else{document.ontouchmove=function(C){C.preventDefault();c(C.touches[0])};document.ontouchend=d}}function z(A){if(i.ratio<1){var C=A||window.event,B=C.wheelDelta?C.wheelDelta/120:-C.detail/3;h-=B*j.wheel;h=Math.min((i[j.axis]-o[j.axis]),Math.max(0,h));m.obj.css(s,h/k.ratio);i.obj.css(s,-h);if(j.onmoved){j.onmoved({element:p,direction:s,position:h,maximum:i[j.axis]-o[j.axis]})}if(j.lockscroll||(h!==(i[j.axis]-o[j.axis])&&h!==0)){C=a.event.fix(C);C.preventDefault()}}}function c(A){if(i.ratio<1){if(!y){g.now=Math.min((n[j.axis]-m[j.axis]),Math.max(0,(g.start+((r?A.pageX:A.pageY)-e.start))))}else{g.now=Math.min((n[j.axis]-m[j.axis]),Math.max(0,(g.start+(e.start-(r?A.pageX:A.pageY)))))}h=g.now*k.ratio;i.obj.css(s,-h);m.obj.css(s,g.now);if(j.onmoved){j.onmoved({element:p,direction:s,position:h,maximum:i[j.axis]-o[j.axis]})}}}function d(){a(document).unbind("mousemove",c);a(document).unbind("mouseup",d);m.obj.unbind("mouseup",d);document.ontouchmove=document.ontouchend=null}return f()}}(jQuery));