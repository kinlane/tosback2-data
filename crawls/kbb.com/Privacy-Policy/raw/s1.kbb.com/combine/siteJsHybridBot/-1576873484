(function(a){a.fn.jCarouselLite=function(e){e=a.extend({btnPrev:null,btnNext:null,btnGo:null,btnGoScroll:null,mouseWheel:false,auto:null,resetTimer:false,speed:200,easing:null,vertical:false,circular:false,visible:4,start:0,scroll:1,beforeStart:null,afterEnd:null,split:false},e||{});return this.each(function(){var o=false,f=e.vertical?"top":"left",p=e.vertical?"height":"width";var i=a(this),s=a("ul",i),r=a("li",s),q=r.size(),u=e.visible;var g;if(e.circular){s.prepend(r.slice(q-u-1+1).clone()).append(r.slice(0,u).clone());e.start+=u}var m=(e.split)?a("> li",s.eq(0)):a("> li",s),l=m.size(),h=e.start;if(e.split){if(a.browser.msie&&a.browser.version.substr(0,1)<7){i.css({position:"relative"})}s.parent().css({visibility:"visible",position:"relative","z-index":"2",left:"0px",overflow:"hidden"})}else{i.css({visibility:"visible",position:"relative","z-index":"2",left:"0px",overflow:"hidden"})}m.css({overflow:"hidden","float":e.vertical?"none":"left"});s.css({margin:"0",padding:"0",position:"relative","list-style-type":"none","z-index":"1"});var n=e.vertical?c(m):d(m);var t=n*l;var j=n*u;m.css({width:m.width(),height:m.height()});s.css(p,t+"px").css(f,-(h*n));(e.split)?s.parent().css(p,j+"px"):i.css(p,j+"px");if(e.btnPrev){a(e.btnPrev).click(function(){return k(h-e.scroll)})}if(e.btnNext){a(e.btnNext).click(function(){return k(h+e.scroll)})}if(e.btnGo){a.each(e.btnGo,function(v,x){a(x).click(function(){if(e.resetTimer&&e.auto){clearInterval(g);g=setInterval(function(){k(h+e.scroll)},e.auto+e.speed)}if(e.btnGoScroll!=null){return k(v*e.btnGoScroll)}else{return k(e.circular?e.visible+v:v)}})})}if(e.mouseWheel&&i.mousewheel){i.mousewheel(function(x,v){return v>0?k(h-e.scroll):k(h+e.scroll)})}if(e.auto){g=setInterval(function(){k(h+e.scroll)},e.auto+e.speed)}function w(){return m.slice(h).slice(0,u)}function k(v){if(!o){if(e.beforeStart){e.beforeStart.call(this,w())}if(e.circular){if(v<=e.start-u-1){s.css(f,-((l-(u*2))*n)+"px");h=v==e.start-u-1?l-(u*2)-1:l-(u*2)-e.scroll}else{if(v>=l-u+1){s.css(f,-((u)*n)+"px");h=v==l-u+1?u+1:u+e.scroll}else{h=v}}}else{if(v<0||v>l-u){return}else{h=v}}o=true;s.animate(f=="left"?{left:-(h*n)}:{top:-(h*n)},e.speed,e.easing,function(){if(e.afterEnd){e.afterEnd.call(this,w())}o=false});if(!e.circular){a(e.btnPrev+","+e.btnNext).removeClass("btn-disabled");a((h-e.scroll<0&&e.btnPrev)||(h+e.scroll>l-u&&e.btnNext)||[]).addClass("btn-disabled")}}return false}})};function b(e,f){return parseInt(a.css(e[0],f))||0}function d(e){return e[0].offsetWidth+b(e,"marginLeft")+b(e,"marginRight")}function c(e){return e[0].offsetHeight+b(e,"marginTop")+b(e,"marginBottom")}})(jQuery);KBB.modules.socialToolbar=(function(){var c,b=KBB.helpers,j={fixed:true,toolTipClass:"aToolTip",xOffset:-115,yOffset:0},h={btnNext:"#Toolbar-carousel .btn-cir-right",btnPrev:"#Toolbar-carousel .btn-cir-left",visible:4,scroll:1,start:0,circular:false,vertical:false},i={closePopups:"#Social-popup .close"},f={toggleToolbar:$("#Social-trigger, #Hide-toolbar-trigger"),errorContainer:$("#Toolbar-error"),saveVehicle:$("#Save-car-btn"),savedCount:$("#Saved-vehicle-count"),recentCount:$("#Recently-viewed-count")},g={saveError:"There was an error saving, please try again later.",compareTooMany:"You may only compare up to 4 vehicles.",compareTooFew:"Please select at least two vehicles to compare."},e=function(k){var m=KBB.modules.socialToolbar.panels;for(var l in m){if(k(m[l],l)===false){break}}};var d=function(l,k){e(function(o,n){var m=o.element.is(":visible");if(!m&&o===l){if(o.onShow(k)!==false){if(c.isHidden){c.toggleSocialToolbar()}o.element.slideUp().show();KBB.events.fire("KbbToolbar.{0}.OnShow".format(n),k);KBB.events.fire("KbbToolbar.OnShowPanel",k,n)}}else{if(m&&o!==l){o.element.stop(true,true).slideDown().hide();KBB.events.fire("KbbToolbar.{0}.OnHide".format(n),k);KBB.events.fire("KbbToolbar.OnHidePanel",k,n)}}})};var a=function(k){var l=$(this).parent(),m=l.data("panel");KBB.events.fire("KbbToolbar.{0}.OnHide".format(m),k);KBB.events.fire("KbbToolbar.OnHidePanel",k,m);l.slideToggle("fast")};return{panels:{},element:$("#Social-toolbar"),isHidden:KBB.cookies.get("ToolbarHidden")==="true",jCarouselSettings:h,init:function(){c=this;$(i.closePopups).click(a);f.saveVehicle.click(this.saveVehicleClicked);f.toggleToolbar.click(this.toggleSocialToolbar);KBB.modules.myKbb.onSaveVehicleComplete(this.saveVehicleComplete);KBB.modules.myKbb.onGetPersonalizationDataComplete(this.personalizationDataReceived);KBB.modules.myKbb.onAuthenticationChange(this.authenticationChanged);KBB.events.on("MyKbb.OnRecentlyViewedAdded",function(k){f.recentCount.html("({0})".format(k.count))});e(this.initPanel);$("span.tip",$("#Social-toolbar, #Social-trigger")).aToolTip(j)},initPanel:function(l,k){l.init();l.element.data("panel",k);l.Show=function(m){d(l,m)};l.trigger.click(l.Show)},hidePanels:function(k){d(null,k)},showError:function(k){c.hideError();f.errorContainer.html(k).show().delay(5000).fadeOut(2000)},hideError:function(){f.errorContainer.hide()},toggleSocialToolbar:function(k){c.isHidden=c.element.is(":visible");if(c.isHidden){c.hidePanels(k);$(".clickTip","#Social-popup").hide()}c.element.add(f.toggleToolbar).fadeToggle("slow");KBB.cookies.set("ToolbarHidden",c.isHidden,"365");KBB.events.fire("KbbToolbar.OnToggle",!c.isHidden);KBB.events.fire("KbbToolbar.On"+(c.isHidden?"Collapse":"Expand"))},saveVehicleClicked:function(k){var l=$(this);if(l.hasClass("disabled")){return}if(!KBB.modules.myKbb.isAuthenticated){KBB.modules.headerShare.signInPopUp.Show(k);return}KBB.modules.myKbb.saveVehicle({vehicleid:l.data("vid"),vehicleclass:l.data("vclass"),mileage:l.data("mileage"),selectionhistory:l.data("options"),condition:l.data("condition"),intent:l.data("intent")})},saveVehicleComplete:function(k){if(k.success){$("span.saved-arrow",c.element).fadeIn().fadeOut(2500);c.hideError()}else{c.showError(g.saveError)}},personalizationDataReceived:function(k){if(k){f.savedCount.html("({0})".format(k.SavedVehicleCount));f.recentCount.html("({0})".format(k.RecentlyViewedCount))}},authenticationChanged:function(k){c.hidePanels();f.savedCount.toggle(k.IsAuthenticated);f.recentCount.toggle(k.IsAuthenticated);if(k.IsAuthenticated){var l=k.User.FirstName.length?k.User.FirstName:k.User.DisplayName;$(".sign-in-message",c.element).html("Welcome Back, {0}!".format(l)).show("fast").delay(2000).fadeOut(2000)}else{$(".sign-out-message",c.element).show("fast").delay(2000).fadeOut(2000)}},createCompareVehiclesClickHandler:function(k){return function(l){l.preventDefault();c.hideError();var m=[];$(".mod-compare-checkbox:checked",k).each(function(){m.push($(this).val())});if(m.length>4){c.showError(g.compareTooMany)}else{if(m.length<2){c.showError(g.compareTooFew)}else{self.location.href="{0}/{1}".format($(this).attr("href"),m.join("-vs-"))}}}},OnToggle:function(k){KBB.events.on("KbbToolbar.OnToggle",k)},OnCollapse:function(k){KBB.events.on("KbbToolbar.OnCollapse",k)},OnExpand:function(k){KBB.events.on("KbbToolbar.OnExpand",k)},OnShowPanel:function(k){KBB.events.on("KbbToolbar.OnShowPanel",k)},OnHidePanel:function(k){KBB.events.on("KbbToolbar.OnHidePanel",k)}}}());KBB.modules.socialToolbar.panels.savedVehicles=(function(){var a,b=KBB.modules.socialToolbar,h=$("#Saved-vehicle-service").val(),d=$("#Saved-vehicle-data"),e={removeConfirmOverlay:$("#Saved-vehicle-remove-overlay"),removeCancel:$("#Saved-vehicle-remove-overlay-cancel"),removeConfirm:$("#Saved-vehicle-remove-overlay-ok"),removeMessage:$("#Saved-vehicle-remove-message")},g={removeTooFew:"Please select at least one vehicle to remove.",removeFailed:"There was an error saving, please try again later.",confirmRemove:"Are you sure you want to remove?",confirmRemoveAll:"Are you sure you want to remove?"},f=false,c;return{element:$("#Saved-vehicles-panel"),trigger:$("#Saved-vehicles-link"),init:function(){a=this;e.removeCancel.click(this.removeVehiclesCancelClicked);e.removeConfirm.click(this.removeVehiclesConfirmClicked)},initAjaxContent:function(){$(".compare-vehicles",a.element).click(b.createCompareVehiclesClickHandler(a.element));$("#Remove-vehicles").click(a.removeVehiclesClicked);$("#Remove-all-vehicles").click(a.removeAllVehiclesClicked)},onShow:function(i){if(!KBB.modules.myKbb.isAuthenticated){KBB.modules.headerShare.signInPopUp.Show(i);return false}a.loadSavedVehicles()},loadSavedVehicles:function(){d.html('<span class="loader"></span>');$.getJSON(KBB.helpers.appendUrlParameter(h,"r",KBB.helpers.randomString()),a.onGetSavedVehiclesComplete)},onGetSavedVehiclesComplete:function(i){if(!i){return}d.html(i.Html).find("#Toolbar-carousel .container").jCarouselLite(b.jCarouselSettings);a.initAjaxContent()},removeVehiclesClicked:function(j){var i=$(".mod-compare-checkbox:checked",a.element);if(!i.length){return b.showError(g.removeTooFew)}c=[];i.each(function(){c.push($(this).data("vid"))});e.removeMessage.html(g.confirmRemove);a.showConfirmRemoveModal()},removeAllVehiclesClicked:function(i){c=[];$(".mod-compare-checkbox",a.element).each(function(){c.push($(this).data("vid"))});e.removeMessage.html(g.confirmRemoveAll);a.showConfirmRemoveModal()},showConfirmRemoveModal:function(){if(!f){e.removeConfirmOverlay.jqm({modal:false,overlay:0,overlayClass:"mod-modal-overlay",toTop:true});f=true}e.removeConfirmOverlay.css("top",$(document).scrollTop()+170).jqmShow()},removeVehiclesCancelClicked:function(i){e.removeConfirmOverlay.jqmHide()},removeVehiclesConfirmClicked:function(j){e.removeConfirmOverlay.jqmHide();var i=function(k){if(!k||!k.success){b.showError(g.removeFailed)}else{a.loadSavedVehicles()}};KBB.modules.myKbb.removeVehicles(c,i)}}}());KBB.modules.socialToolbar.panels.recentlyViewed=(function(){var a,b=KBB.modules.socialToolbar,d={saveVehiclesError:"Please select at least one vehicle.",compareTooMany:"You may only compare up to 4 vehicles.",compareTooFew:"Please select at least two vehicles to compare."},f=$("#Recently-viewed-service").val(),c=$("#Recently-viewed-data"),e=false;return{element:$("#Recently-viewed-panel"),trigger:$("#Recently-viewed-link"),init:function(){a=this;KBB.events.on("MyKbb.OnRecentlyViewedAdded",function(g){e=false})},initAjaxContent:function(){$("#Save-vehicles-btn").click(this.saveVehiclesClicked);$(".compare-vehicles",a.element).click(b.createCompareVehiclesClickHandler(a.element))},onShow:function(g){if(!e){a.getRecentlyViewedVehicles(a.onGetRecentlyViewedComplete)}},getRecentlyViewedVehicles:function(g){c.html('<span class="loader"></span>');$.getJSON(f,g)},onGetRecentlyViewedComplete:function(g){if(!g){return}c.html(g.Html).find("#Toolbar-carousel .container").jCarouselLite(b.jCarouselSettings);a.initAjaxContent();e=true},saveVehiclesClicked:function(g){b.hideError();if(!KBB.modules.myKbb.isAuthenticated){KBB.modules.headerShare.signInPopUp.Show(g);return}var h=[];$(".mod-compare-checkbox:checked",a.element).each(function(){h.push("{0}-{1}".format($(this).data("vid"),$(this).data("vclass")))});if(h.length>0){KBB.modules.myKbb.saveVehicles(h.join("|"))}else{b.showError(d.saveVehiclesError)}}}}());var tbHeight=550;var tbWidth=1012;var toolbarContent=$("#ToolbarAd-Content");var toolbarToggleDiv=$("#ToolbarAd-toggle div");function showToolbarAdOverlay(a){toolbarContent.show();toolbarToggleDiv.addClass("down").removeClass("up");$("#ToolbarAd-Content-Overlay").addClass("mod-modal-overlay").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":toolbarContent.css("z-index")-1,opacity:0.5}).fadeIn();toolbarContent.width(tbWidth);$("#ToolbarAd-Content .close").css({top:"-40px",right:"45px"}).fadeIn("fast");$("#ToolbarAd-Content .content").stop(true,true).show().width(tbWidth).animate({height:tbHeight},"fast");var b=$("#ToolbarAd-Content-src").val();if(a!=undefined&&b.indexOf("dyn=")<0){b=b+"&dyn="+a}$("#ToolbarAd-Content-iframe").attr("src",b)}function collapseToolbarAd(){$("#ToolbarAd-Content-Overlay").fadeOut();$("#ToolbarAd-Content .close").stop(true,true).fadeOut("fast",function(){$("#ToolbarAd-Content .content").stop(true,true).animate({height:0},"fast",function(){$(this).hide();toolbarToggleDiv.removeClass("down").addClass("up")})});$("#ToolbarAd-Content-iframe").attr("src","")}$("#ToolbarAd-Content .close").live("click",function(){collapseToolbarAd();toolbarToggleDiv.removeClass("down").addClass("up")});var dyn="";function ShowToolbarAdToggle(e){var d=e.split("|");var c=d[0];var b=d[1];var a=d[2];dyn=d[3];if(c==undefined){c="background:#000"}if(b==undefined){b="background:#fff"}if(a==undefined){a="#fff"}$("#ToolbarAd-toggle-container").show().attr("style",b).find("#ToolbarAd-toggle").attr("style",c).find(".arrow").css("border-top-color",a).css("border-bottom-color",a)}$("#ToolbarAd-toggle").live("click",function(){var a=$(this).find("div");if(a.hasClass("up")){showToolbarAdOverlay(dyn);a.removeClass("up").addClass("down")}else{collapseToolbarAd();a.removeClass("down").addClass("up")}});$("#Social-toolbar .toggle-down").live("click",function(){$("#ToolbarAd-Collapsed-Content-iframe").attr("src","")});$("#Social-trigger").live("click",function(){if($("#ToolbarAd-Collapsed-Content-iframe").attr("src").length<1){var a=$("#ToolbarAd-Collapsed-Content-src").val();$("#ToolbarAd-Collapsed-Content-iframe").attr("src",a)}});$(document).ready(function(){$("#ToolbarAd-Content-iframe").load(function(){var a=$(this).contents().find("object, embed").attr("height");if(a!==undefined&&a!==$(this).attr("height")){$(this).attr("height",a)}var b=$(this).contents().find("object, embed").attr("width");if(b!==undefined&&b!==$(this).attr("width")){$(this).attr("width",b)}});$("#ToolbarAd-Collapsed-Content-iframe").load(function(){var a=$(this).contents().find("object, embed").attr("height");if(a!==undefined&&a!==$(this).attr("height")){$(this).attr("height",a)}var b=$(this).contents().find("object, embed").attr("width");if(b!==undefined&&b!==$(this).attr("width")){$(this).attr("width",b)}})});function toolbaronload(){var a=document.getElementById("ToolbarAd-Content-iframe").contentWindow.document.body.scrollHeight;document.getElementById("ToolbarAd-Content-iframe").height=a}KBB.sockets.read(function(b){try{var a=JSON.parse(b.data);if(a.dyn&&(a.type==="OverlayAd")){showToolbarAdOverlay(a.dyn)}}catch(c){}},"http://ad.doubleclick.net");$(document).ready(function(){$(".photos-modal").click(PhotosModalIconClick)});function PhotosModalIconClick(a){var b=$("#Vehicle-info .content-title").text();if(b==""){b="Go Back to Original Page"}if(b=="New Car Pricing"){b=$("#Vehicle-info h1").text()}if($("#Model-year-select").length>0){if($(this).parents(".model-year-container").find(".model-year-name").text().length>0){b=$(this).parents(".model-year-container").find(".model-year-name").text()}}var c=$(this).attr("data-photos-modal-url");$("#Photos-modal-iframe").attr("src",c);$("#Photos-modal-overlay").jqm({modal:true,overlay:50,overlayClass:"mod-modal-overlay",closeClass:"close",overlayClass:"mod-modal-overlay",toTop:true,onShow:function(d){d.w.show().hvCenter();if(d.w.offset().top<14){d.w.css("top","14px")}},onHide:function(d){$("#Photos-modal-iframe").attr("src","");d.w.fadeOut("2000",function(){d.o.remove()})}});$("#Photos-modal-overlay").jqmShow();$("#GalleryModalDiv").show();$("#Photos-modal-overlay-confirm .close").click(function(){$("#Photos-modal-overlay-confirm").jqmHide();$("#Has-modal-vehicle-changed").val("true");$("div.mod-modal-overlay").css("z-index",$("#Photos-modal-overlay").css("z-index")-11)})}function ToFriendlyKBBURLValue(b){var a=/[^a-z0-9\-\s]*/ig;var c=/\s/g;b=b.replace(a,"").replace(c,"-");return b}function GalleryModalConfirm(){if($("#Has-modal-vehicle-changed").val()=="true"){var f=$("#Modal-year").val();var b=$("#Modal-manufacturer").val();var c=$("#Modal-model").val();var a=ToFriendlyKBBURLValue(c);var e="/"+b+"/"+a+"/"+f+"-"+b+"-"+a+"/";var d=f+" "+b+" "+c;$("#Photos-modal-overlay-confirm").jqm({modal:true,overlay:50,overlayClass:"mod-modal-overlay",toTop:true,onShow:function(g){g.w.hvCenter().show().ctaFix();if(g.w.find("p").css("margin-bottom")=="0px"){g.w.find("p").css({"font-family":"tahoma, arial","font-size":"12px","margin-bottom":"12px"})}}}).jqmShow();$("#Photos-modal-overlay-confirm-ok").attr("href",e);if($("#Photos-modal-overlay-confirm-ok").hasClass("btn-cta-fix")){$("#Photos-modal-overlay-confirm-ok .btn-center").html(d)}else{$("#Photos-modal-overlay-confirm-ok").html(d)}$("#Photos-modal-overlay").css("z-index",$("#Photos-modal-overlay").css("z-index")-10);$("#mod-modal-overlay").css("z-index",$("#mod-modal-overlay").css("z-index")-9);$("#Has-modal-vehicle-changed").val("false")}else{$("#Photos-modal-overlay").jqmHide()}}function GotoOriginal(){$("#Photos-modal-overlay").jqmHide();$("#Photos-modal-overlay-confirm").jqmHide();$("#Has-modal-vehicle-changed").val("false")};