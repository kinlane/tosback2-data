function RunAQuery(Query) {var UGen=new UrlGen(Query);var ArticleId=UGen.GetParam("a");var ArticlePage=UGen.GetParam("p");var strURL=WebRoot+"controls/ajaxcalls/DetailArticlePath.aspx?"+UGen.ToString();$AJAX.GetForDelegate(function(AjaxResponse) {window.location.href=AjaxResponse;}, strURL);}
function ResultsQuery(Query){var UGen=new UrlGen(Query);var strURL=WebRoot+"controls/ajaxcalls/DetailResultsPath.aspx?"+UGen.ToString();$AJAX.GetForDelegate(function(AjaxResponse) {window.location.href=AjaxResponse;}, strURL);}
function MortgageCalc(num) {alert(num);}
function Article(Query, ArticleSection, ArticleHeadline) {var UGen=new UrlGen(Query);UGen.RemoveParam("news");UGen.AddParam("news", "false");if(ArticleHeadline!=undefined) {ArticleHeadline=CleanHeadline(ArticleHeadline);}
if(ArticleSection!=undefined) {ArticleSection=ArticleSection.replace(/\s+/gi, '-')
UGen.AddParam("s", ArticleSection);UGen.AddParam("h", ArticleHeadline);}
RunAQuery(UGen.ToString());}
function ArticleSubPage(num, ArticleSection, ArticleHeadline) {var isPaginated=false;var href=window.location.href;href=href.replace("http://", "");var QryArr=href.split('?');var arrHref=QryArr[0].split('/');var newHREF=new Array();var PageExp=/^p[0-9]{1,3}$/i;for (var x=0; x<arrHref.length; x++) {if(arrHref[x].match(PageExp)) {isPaginated=true;newHREF.push("p"+num);}else{if(arrHref[x]!=''){newHREF.push(arrHref[x]);}}}
if(!isPaginated) {newHREF.push("p"+num);}
if(num>1){if(newHREF[newHREF.length-1].toString().indexOf("nl")!=-1){newHREF.splice(newHREF.length-1, 1);}}
var QryArrTmp=new Array();if(num>1 && QryArr.length>1){var Qrys=QryArr[1].split('&');for(var i=0; i<Qrys.length; i++){if(Qrys[i].toString().indexOf("syc")==-1){QryArrTmp.push(Qrys[i]);}}
if(QryArrTmp.length>0){newHREF.push('?'+QryArrTmp.join('&'));}}
window.location.href="http://"+newHREF.join('/');return;}
function CleanHeadline(ArticleHeadline) {if(ArticleHeadline!=undefined) {ArticleHeadline=ArticleHeadline.replace(/<[^>]+>/g, '');ArticleHeadline=ArticleHeadline.replace(/[']+/g, '');ArticleHeadline=ArticleHeadline.replace(/^\s+|\s+$/g, '');ArticleHeadline=ArticleHeadline.replace(/[^a-z0-9]+/gi, '-');ArticleHeadline=ArticleHeadline.replace(/\-+/g, '-');return ArticleHeadline;}
return "";}
function OpenPrint(IdArticle) {window.open("/news/article/"+IdArticle+"/print");}
function ArticlePrint(IdArticle) {window.print();}
function ArticleEmail(IdArticle) {void (null);}
function ArticleSave(IdArticle) {void (null);}
function ArticleShare(IdArticle) {Facebook.ShareFavoritesFriend(document.CanonicalURL(),'Article',IdArticle,'','','','emailshare');}
function ArticlePage(No, Position) {QSCache.Position=Position;var UGen=new UrlGen(QSCache.QueryString);UGen.RemoveParam("No");UGen.AddParam("No", No);UGen.AddParam("news", "false");QSCache.QueryString=UGen.ToString();$AJAX.GetForDelegate(ArticlePageHandler, WebRoot+"Controls/AjaxCalls/ArticleIds.aspx?"+QSCache.QueryString);}
function ArticlePageHandler(AJAXResponse) {if(AJAXResponse.length>0) {var arrListingIds;var articlesection="";var articleheadline="";var ListingIds="";var params=AJAXResponse.split("&");for (var m=0; m<params.length; m++) {if(params[m].split("=")[0].indexOf("aids")>-1) {arrListingIds=params[m].split("=")[1].split(',');ListingIds=params[m].split("=")[1];}
if(params[m].split("=")[0].indexOf("s")>-1) {articlesection=params[m].split("=")[1];articlesection=articlesection.replace(/\s+/gi, '-')}
if(params[m].split("=")[0].indexOf("h")>-1) {articleheadline=params[m].split("=")[1];articleheadline=CleanHeadline(articleheadline);}}
var UGen=new UrlGen(QSCache.QueryString);UGen.RemoveParams(["aids", "a", "s", "h"]);UGen.AddParam("news", "false");UGen.AddParam("aids", ListingIds);UGen.AddParam("a", arrListingIds[QSCache.Position]);UGen.AddParam("s", articlesection);UGen.AddParam("h", articleheadline);RunAQuery(UGen.ToString());}};function initialize(){var $bookmarkedInfo;var $bookmarkedProperty;var $innerBalloon;var $innerBookmarkedInfo;var $close;var $hover;var $articles=$('.article, .saved-wrap');var $articleOverlay=$('.article-overlay, .saved-overlay');var $articleHover=$('.article-hover, .saved-hover');var $searches=$('.search');var $searchOverlay=$('.search-overlay');var $searchHover=$('.search-hover');function bookmarkedPropHovers(){$bookmarkedInfo=$('.bookmarked-info');$bookmarkedProperty=$('.bookmarked-property');$innerBalloon=$('.inner-bookmarked-info');$innerBookmarkedInfo=$('.inner-bookmarked-info .img, .inner-bookmarked-info .address, .inner-bookmarked-info .city-state, .inner-bookmarked-info .price, .inner-bookmarked-info .bed-bath');$innerBookmarkedAddress=$('.inner-bookmarked-info .address');$innerBookmarkedCityState=$('.inner-bookmarked-info .city-state');$close=$('.inner-bookmarked-info .close');$hover=$('.hover');$innerBookmarkedAddress.each(function(){if($(this).text().length>11){$(this).text($(this).text().substr(0, 11)+'...');}});$innerBookmarkedCityState.each(function(){if($(this).text().length>18){$(this).text($(this).text().substr(0, 18)+'...');}});$bookmarkedProperty.each(function(index){$(this).hover(function(){$($bookmarkedInfo[index]).stop(true, true).fadeIn(100);$(this).css('z-index', '999');$('#global_header').css('position','static');},function(event){$($bookmarkedInfo[index]).stop(true, true).fadeOut(100);$(this).css('z-index', 0);$('#global_header').css('position','relative');});});$innerBalloon.each(function(index){$(this).hover(function(){$(this).parent().addClass('mouseover');$($innerBookmarkedInfo).stop(true, true).animate({"opacity":".2"}, 250);$($close).addClass('close-mouseover');$($hover).stop(true, true).fadeIn(250);},function(){$(this).parent().removeClass('mouseover');$($innerBookmarkedInfo).stop(true, true).animate({"opacity":"1"}, 250);$($close).removeClass('close-mouseover');$($hover).css('display', 'none');});});}
bookmarkedPropHovers();emailHover();$($close).click(function(){$($bookmarkedProperty).trigger("mouseout")});$articles.each(function(index){$(this).hover(function(){$($articleOverlay[index]).stop(true, true).animate({"opacity":".70"}, 100);$($articleHover[index]).stop(true, true).fadeIn(100);},function(){$($articleOverlay[index]).stop(true, true).animate({"opacity":"0"}, 100);$($articleHover[index]).stop(true, true).fadeOut(100);});});$searches.each(function(index){$(this).hover(function(){$($searchOverlay[index]).stop(true, true).animate({"opacity":".70"}, 100);$($searchHover[index]).stop(true, true).fadeIn(100);},function(){$($searchOverlay[index]).stop(true, true).animate({"opacity":"0"}, 100);$($searchHover[index]).stop(true, true).fadeOut(100);});});var $listing=$('.listing-wrap');var $listingOverlay=$('.listing-wrap .overlay');var $listingTools=$('.listing-wrap .tools');$($listing).each(function(index){$(this).hover(function(){$($listingOverlay[index]).stop(true, true).animate({"opacity":".70"}, 100);$($listingTools[index]).stop(true, true).fadeIn(100);},function(){$($listingOverlay[index]).stop(true, true).animate({"opacity":"0"}, 100);$($listingTools[index]).stop(true, true).fadeOut(100);});});var $viewBtn=$('.view ul li.grid, .view ul li.list');$viewBtn.click(function(){HideToolTip();if(!$('body').hasClass('map')){$('body').removeClass();$('body').addClass($(this).attr('class'));}});var $sortMenu=$('.sort-menu');var $sortClose=$('.sort-drop-hat .close');var $sortDrop=$('.sort-drop-wrap');var $sortOption=$('.sort-drop-body ul li a');var $sortOptionText=$('.sort-drop-body ul li a span');var $sortValue=$('#SortValue');var tempSortValue;$sortClose.click(function(){$sortDrop.hide();$("#Sorting").css('z-index' , '98');});$sortValue.click(function(){$sortDrop.show();$("#Sorting").css('z-index' , '999');});$sortMenu.mouseleave(function(){$sortDrop.hide();$("#Sorting").css('z-index' , '98');});$sortMenu.hover(function(){$listing.css('position', 'static');$(this).addClass('sort-menu-hover');},function(){$listing.css('position', 'relative');$(this).removeClass('sort-menu-hover');});$sortOption.each(function(index){$(this).click(function(){if($(this).text().length>15){tempSortValue=$(this).text().substr(0, 15)+'...';}else{tempSortValue=$(this).text();}
$sortValue.text(tempSortValue);$sortClose.trigger('click');});});var $shareallMenu=$('.fbsall-menu');var $shareallClose=$('.fbsall-drop-hat .close');var $shareallDrop=$('.fbsall-drop-wrap');var $shareallOption=$('.fbsall-drop-body ul li a');var $shareallOptionText=$('.fbsall-drop-body ul li a span');var $shareallValue=$('#fbshareallValue');var tempshareallValue;$shareallClose.click(function(){$shareallDrop.hide();});$shareallValue.click(function(){$shareallDrop.show();$('.accounts-header').css({'z-index' : '99'});});$shareallMenu.mouseleave(function(){$shareallDrop.hide();});$shareallMenu.hover(function(){$listing.css('position', 'static');$(this).addClass('fbsall-menu-hover');},function(){$listing.css('position', 'relative');$(this).removeClass('fbsall-menu-hover');});$shareallOption.each(function(index){$(this).click(function(){if($(this).text().length>15){tempshareallValue=$(this).text().substr(0, 15)+'...';}else{tempshareallValue=$(this).text();}
$shareallValue.text(tempshareallValue);$shareallClose.trigger('click');});});var $sectionItem=$('.filter-type ul.options li,  .filter-type ul.zips li, .show-all');$($sectionItem).click(function(){$sectionItem.removeClass('active');$(this).addClass('active');});var $sectionNav=$('.filter-type ul.section-options li');$($sectionItem).click(function(){$sectionItem.removeClass('active');$(this).addClass('active');});if($sortOptionText.text().length>21){$sortOptionText.text($sortOptionText.text().substr(0, 18)+'...')}
var $cityZip=$('ul.city-zip li');var $cities=$('ul.cities');var $zips=$('ul.zips');$cityZip.each(function(index){$(this).click(function(){if($(this).hasClass('zip')){$cityZip.removeClass('city-active')
$(this).addClass('zip-active');$cities.hide();$zips.show();}else{$cityZip.removeClass('zip-active')
$(this).addClass('city-active');$zips.hide();$cities.show();}});});function paginationFix(){var $GLOBAL_paginationWidth=$("#Pagination ul").width();$("#Pagination ul").css({"width":$GLOBAL_paginationWidth+"px","float":"none","visibility":"visible"});}
paginationFix();$('input.text-input').each(function(){var DefaultValue;$(this).focus(function(){DefaultValue=$(this).val();$(this).addClass('text-input-changed');$(this).val('')});$(this).blur(function(){if($(this).val()==""||$(this).val('')==DefaultValue){$(this).val(DefaultValue);$(this).removeClass('text-input-changed');}});});var $zipInputs=$("#OtherInterest .input input");var $autoSuggest=$("#sbsuggest");var $accountsHeader=$(".accounts-header");$zipInputs.each(function(index){$(this).focus(function(){$accountsHeader.css("position", "static");switch(index){case 0:$autoSuggest.css({"top":"83px","left":"0"});break;case 1:$autoSuggest.css({"top":"83px","left":"308px"});break;case 2:$autoSuggest.css({"top":"119px","left":"0"});break;case 3:$autoSuggest.css({"top":"119px","left":"308px"});break;}});$(this).blur(function(){$accountsHeader.css("position", null);});});if(gE("BookmarkedMap")){var newOverlay;var isMarker=false;var activeMarker=null;var BM_latlng=new Array();var tempAddr;function realignOverlay(){if(activeMarker==null) return;var markerLoc=map.fromLatLngToDivPixel(activeMarker.getLatLng());newOverlay.div_.style.left=(markerLoc.x - 81)+'px';newOverlay.div_.style.top=(markerLoc.y - 235)+'px';}
function CustomOverlay (address, taxonomy, price, bed, bath, thumb, detailseourl, idlisting, root, fbtracking){this.address_=address;this.taxonomy_=taxonomy;this.price_=price;this.bed_=bed;this.bath_=bath;this.thumb_=thumb;this.detailseourl_=detailseourl;this.idlisting_=idlisting;this.root_=root;this.fbtracking_=fbtracking;}
CustomOverlay.prototype=new GOverlay();CustomOverlay.prototype.initialize=function(map){var div=document.createElement('div');div.className="bookmarked-info";div.style.display="block";var divHTML="<div class='inner-bookmarked-info'>";divHTML+="<div class='close'></div>";divHTML+="<div class='img'><img src='"+this.thumb_+"' alt='thumb' /></div>";divHTML+="<div class='address'>"+this.address_+"</div>";divHTML+="<div class='city-state'>"+this.taxonomy_+"</div>";divHTML+="<div class='price'>"+this.price_+"</div>";divHTML+="<div class='bed-bath'>"+this.bed_+" | "+this.bath_+"</div>";divHTML+="<div class='hover'>";divHTML+="<div onclick=\" window.location='"+this.detailseourl_+"' \" class='details'></div>";divHTML+="<div onclick=\" Facebook.ShareFavoritesFriend('"+this.detailseourl_+"', 'Listing', '"+this.idlisting_+"', '"+this.address_+"','','', 'emailshare')\" class='share_sm'></div>";divHTML+="<div onclick=\" Facebook.ShareFavoritesFriend('"+this.detailseourl_+this.fbtracking_+"', 'Listing', '"+this.idlisting_+"', '"+this.address_+"','', '"+this.thumb_+"', 'fbshare')\" class='fbshare_sm'></div>";if(!ReadOnly){divHTML+="<div onclick=\" RemoveThisListing('"+this.idlisting_+"','','','','mp')\" class='remove'></div>";}
divHTML+="</div>";divHTML+="</div>";div.innerHTML=divHTML;map.getPane(G_MAP_MAP_PANE).appendChild(div);this.map_=map;this.div_=div;emailHover();};CustomOverlay.prototype.remove=function() {this.div_.parentNode.removeChild(this.div_);};CustomOverlay.prototype.copy=function() {return new CustomOverlay(this.address_, this.taxonomy_, this.price_, this.bed_, this.bath_, this.thumb_);};CustomOverlay.prototype.redraw=function(force) {if(!force) return;};var latlngBounds=new GLatLngBounds();for(i in mapMarkersArr){var markerC=mapMarkersArr[i].split(":");var markerP=new GLatLng(parseFloat(markerC[0]), parseFloat(markerC[1]));BM_latlng.push(markerP);}
for(n in BM_latlng){latlngBounds.extend(BM_latlng[n]);}
var map=new GMap2(gE("BookmarkedMap"));map.setCenter(latlngBounds.getCenter(), map.getBoundsZoomLevel(latlngBounds));map.addControl(new GSmallMapControl());map.addControl(new GMapTypeControl());var baseIcon=new GIcon();baseIcon.image='/images/map_markers/singlepoint_off.png';baseIcon.shadow='/images/map_markers/singlepoint_shadow.png';baseIcon.iconSize=new GSize(18.0, 30.0);baseIcon.shadowSize=new GSize(34.0, 30.0);baseIcon.iconAnchor=new GPoint(9.0, 15.0);baseIcon.infoWindowAnchor=new GPoint(9.0, 15.0);baseIcon.transparent='/images/map_markers/singlepoint_transparent.png';baseIcon.imageMap=[1,5,8,1,16,5,16,15,12,15,10,26,6,15,1,15];GEvent.addListener(map, "zoomend", function(){realignOverlay();});function createMarker(point, index){var marker=new GMarker(point, { icon:baseIcon });marker.value=index;var markerLoc;GEvent.addListener(marker, "click", function(){if(isMarker){map.removeOverlay(newOverlay)}
markerLoc=map.fromLatLngToDivPixel(point);map.panTo(map.fromDivPixelToLatLng(new GPoint(markerLoc.x, markerLoc.y-150)));newOverlay=new CustomOverlay(mapOverlays[index]["address"], mapOverlays[index]["city-state"], mapOverlays[index]["price"], mapOverlays[index]["bedrooms"], mapOverlays[index]["baths"], mapOverlays[index]["thumbnail"], mapOverlays[index]["detailseourl"], mapOverlays[index]["idlisting"], mapOverlays[index]["root"], mapOverlays[index]["fbtracking"]);map.addOverlay(newOverlay);isMarker=true;newOverlay.div_.style.left=(markerLoc.x - 81)+'px';newOverlay.div_.style.top=(markerLoc.y - 235)+'px';$('.bookmarked-info').parent().css('zIndex', '110');$('.inner-bookmarked-info .close').click(function(){map.removeOverlay(newOverlay);isMarker=false;});bookmarkedPropHovers();activeMarker=marker;});return marker;}
for(m in BM_latlng){map.addOverlay(createMarker(BM_latlng[m], m));}}}
$(window).load(function(){initialize();});function emailHover(){var shareInfoTextInstance;var $shareSmall=$('.share_sm, .fbshare_sm');$shareSmall.each(function(index){$(this).hover(function(){$("#global_content_right").css('zIndex', '3');$(".saved-wrap").css('zIndex', '1000');shareInfoTextInstance=new shareInfoText($(this).attr('class'))
$(this).append(shareInfoTextInstance);$(shareInfoTextInstance).mouseenter(function(){$(shareInfoTextInstance).remove();});},function(){$("#global_content_right").css('zIndex', '1');$(".saved-wrap").css('zIndex', '10');$(shareInfoTextInstance).remove();});});function shareInfoText(shareType){var div=document.createElement('div');switch(shareType){case "share_sm":div.className="email-fbshare";div.innerHTML="E-mail a Friend";break;case "fbshare_sm":div.className="email-fbshare";div.innerHTML="Share on Facebook";break;}
return div;}}
function ToolTips(){var ToolTipsTextInstance;var $ToolTips=$('.bookmark-tt, .alert-tt, .email-tt, .fb-tt, .mobile-tt, .print-tt, .tw-tt');$ToolTips.each(function(index){$(this).hover(function(){ToolTipsTextInstance=new ToolTipsText($(this).attr('class'))
$(this).append(ToolTipsTextInstance);$(ToolTipsTextInstance).mouseenter(function(){$(ToolTipsTextInstance).remove();});},function(){$(ToolTipsTextInstance).remove();});});function ToolTipsText(shareTypeText){var div=document.createElement('div');switch(shareTypeText){case "bookmark-tt":div.className="tooltip";div.innerHTML="Bookmark";break;case "alert-tt":div.className="tooltip";div.innerHTML="Alert me";break;case "email-tt":div.className="tooltip";div.innerHTML="E-mail a Friend";break;case "fb-tt":div.className="tooltip";div.innerHTML="Share on Facebook";break;case "mobile-tt":div.className="tooltip";div.innerHTML="Send to Mobile";break;case "print-tt":div.className="tooltip";div.innerHTML="Print";break;case "tw-tt":div.className="tooltip";div.innerHTML="Share on Twitter";break;}
return div;}}
eval(function(p,a,c,k,e,r){e=function(c){return(c<62?'':e(parseInt(c/62)))+((c=c%62)>35?String.fromCharCode(c+29):c.toString(36))};if('0'.replace(0,e)==0){while(c--)r[e(c)]=k[c];k=[function(e){return r[e]||e}];e=function(){return'([237-9n-zA-Z]|1\\w)'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('(s(m){3.fn.pngFix=s(c){c=3.extend({P:\'blank.gif\'},c);8 e=(o.Q=="t R S"&&T(o.u)==4&&o.u.A("U 5.5")!=-1);8 f=(o.Q=="t R S"&&T(o.u)==4&&o.u.A("U 6.0")!=-1);p(3.browser.msie&&(e||f)){3(2).B("img[n$=.C]").D(s(){3(2).7(\'q\',3(2).q());3(2).7(\'r\',3(2).r());8 a=\'\';8 b=\'\';8 g=(3(2).7(\'E\'))?\'E="\'+3(2).7(\'E\')+\'" \':\'\';8 h=(3(2).7(\'F\'))?\'F="\'+3(2).7(\'F\')+\'" \':\'\';8 i=(3(2).7(\'G\'))?\'G="\'+3(2).7(\'G\')+\'" \':\'\';8 j=(3(2).7(\'H\'))?\'H="\'+3(2).7(\'H\')+\'" \':\'\';8 k=(3(2).7(\'V\'))?\'float:\'+3(2).7(\'V\')+\';\':\'\';8 d=(3(2).parent().7(\'href\'))?\'cursor:hand;\':\'\';p(2.9.v){a+=\'v:\'+2.9.v+\';\';2.9.v=\'\'}p(2.9.w){a+=\'w:\'+2.9.w+\';\';2.9.w=\'\'}p(2.9.x){a+=\'x:\'+2.9.x+\';\';2.9.x=\'\'}8 l=(2.9.cssText);b+=\'<y \'+g+h+i+j;b+=\'9="W:X;white-space:pre-line;Y:Z-10;I:transparent;\'+k+d;b+=\'q:\'+3(2).q()+\'z;r:\'+3(2).r()+\'z;\';b+=\'J:K:L.t.M(n=\\\'\'+3(2).7(\'n\')+\'\\\', N=\\\'O\\\');\';b+=l+\'"></y>\';p(a!=\'\'){b=\'<y 9="W:X;Y:Z-10;\'+a+d+\'q:\'+3(2).q()+\'z;r:\'+3(2).r()+\'z;">\'+b+\'</y>\'}3(2).hide();3(2).after(b)});3(2).B("*").D(s(){8 a=3(2).11(\'I-12\');p(a.A(".C")!=-1){8 b=a.13(\'url("\')[1].13(\'")\')[0];3(2).11(\'I-12\',\'none\');3(2).14(0).15.J="K:L.t.M(n=\'"+b+"\',N=\'O\')"}});3(2).B("input[n$=.C]").D(s(){8 a=3(2).7(\'n\');3(2).14(0).15.J=\'K:L.t.M(n=\\\'\'+a+\'\\\', N=\\\'O\\\');\';3(2).7(\'n\',c.P)})}return 3}})(3);',[],68,'||this|jQuery||||attr|var|style||||||||||||||src|navigator|if|width|height|function|Microsoft|appVersion|border|padding|margin|span|px|indexOf|find|png|each|id|class|title|alt|background|filter|progid|DXImageTransform|AlphaImageLoader|sizingMethod|scale|blankgif|appName|Internet|Explorer|parseInt|MSIE|align|position|relative|display|inline|block|css|image|split|get|runtimeStyle'.split('|'),0,{}));function RemoveThisListing(listingId, address, IsPageRefresh, webroot, origin) {if(IsPageRefresh==undefined) { IsPageRefresh=false; }
strURL="/Accounts/AJAXCalls/Remove.aspx?type=listing&id="+listingId+"&IsPageRefresh="+IsPageRefresh+"&add="+address;$.ajax({type: "POST",url: strURL,data: "",success: function(data) {if(origin=='mf') {Facebook.Confirmation_Modal(address+" is no longer bookmarked.", "Success!");window.setTimeout(function(){window.location="/account/my-folders/";},600)}
else if(origin=='mp') {window.location="/myfolders.aspx?viewtype=map";}
else if(origin=='ra') {Facebook.Confirmation_Modal(address+" is no longer bookmarked.", "Success!");window.setTimeout(function(){Facebook.Modal_Close();Facebook.fadeOutBackground();},5000);ChangeUserAction();}else{Facebook.Confirmation_Modal(address+" is no longer bookmarked.", "Success!");window.setTimeout(function(){window.location="/account/recent-activity/";},600)}
if(data==1) {}else{}},error: function(XMLHttpRequest, textStatus, errorThrown) {}});}
function RemoveAllListings() {strURL="/Accounts/AJAXCalls/Remove.aspx?type=alllistings" ;$.ajax({url: strURL,type: 'GET',dataType: 'text',success: function(data) {Facebook.Confirmation_Modal("All properties are deleted successfully.", "Success!");window.setTimeout(function(){Facebook.Modal_Close();Facebook.fadeOutBackground();},5000);ChangeUserAction();if(data==1) {}else{}},error: function(XMLHttpRequest, textStatus, errorThrown) {}});}
function RemoveThisarticle(articleId, articleName, IsPageRefresh, webroot) {if(IsPageRefresh==undefined) { IsPageRefresh=false; }
strURL="/Accounts/AJAXCalls/Remove.aspx?type=article&id="+articleId+"&IsPageRefresh="+IsPageRefresh+"&add="+articleName;$.ajax({url: strURL,type: 'GET',dataType: 'text',success: function(data) {if(window.location.href.indexOf("/account/recent-activity")!=-1) {window.setTimeout(function(){ window.location="/account/recent-activity"; },600)}
else if(window.location.href.indexOf("/account/my-folders/articles")!=-1) {window.setTimeout(function(){ window.location="/account/my-folders/articles"; },600)}
else if(window.location.href.indexOf("/pro/account/dashboard")!=-1) {window.setTimeout(function(){ window.location="/pro/account/dashboard"; },600)}else{ChangeUserAction();var html='"'+articleName+'" is no longer bookmarked.';Facebook.Confirmation_Modal(html);TimeOutModal=window.setTimeout(function(){Facebook.Modal_Close();Facebook.fadeOutBackground();},5000)}},error: function(XMLHttpRequest, textStatus, errorThrown) {}});}
function RemoveThisSearch(searchId, SearchName, IsPageRefresh) {if(IsPageRefresh==undefined) { IsPageRefresh=false; }
strURL="/Accounts/AjaxCalls/Remove.aspx?type=search&id="+searchId+"&IsPageRefresh="+IsPageRefresh+"&add="+encodeURIComponent(SearchName);$.ajax({url: strURL,type: 'GET',dataType: 'text',success: function(data) {if(window.location.href.indexOf("/account/recent-activity/")!=-1) {window.setTimeout(function(){ window.location="/account/recent-activity/"; },600)}else{window.setTimeout(function(){ window.location="/account/my-folders/searches/"; },600)}},error: function(XMLHttpRequest, textStatus, errorThrown) {alert('error this:'+this+'\n XMLHttpRequest:'+XMLHttpRequest+'\ntextStatus:'+textStatus);}});}
function RemoveItemFromList(Id, ItemType, IsPageRefresh) {var querystring="Id="+Id+"&ItemType="+ItemType;querystring+='&PathInfo='+GetPageName()+'&action=removeitem&IsPageRefresh='+IsPageRefresh;$AJAX.GetForDelegate(UserOptionsDelegate, PersonalizationRoot+"/Accounts/AJAXCalls/My_Options.aspx?"+querystring);}
function ShareAllListings(shareType) {if(shareType==undefined){shareType="emailshare";}
strURL="/controls/ajaxcalls/accounts/ShareAllListings.aspx";try {$.ajax({url: strURL,type: 'GET',dataType: 'text',success: function(data) {Facebook.ShareList(data, "List", "", shareType)},error: function(XMLHttpRequest, textStatus, errorThrown) {alert('error this:'+this+'\n XMLHttpRequest:'+XMLHttpRequest+'\ntextStatus:'+textStatus);}});}
catch (e) {alert('error:'+e);}}
function ChangeView(viewType) {HideToolTip();if((currentViewType=='map' && viewType!='map')||(currentViewType!='map' && viewType=='map')){window.setTimeout(function(){if(ListId!="" && ListId!=undefined) {window.location='/MyFolders.aspx?viewtype='+viewType+'&listid='+ListId;}else{window.location='/MyFolders.aspx?viewtype='+viewType;}},600);}}
function ChangeAgentFoldersView(viewType, profile) {HideToolTip();if((currentViewType=='map' && viewType!='map')||(currentViewType!='map' && viewType=='map')) {window.setTimeout(function() {if(ListId!="" && ListId!=undefined) {window.location='/AgentFolders.aspx?ProfileAddress='+profile+'&viewtype='+viewType+'&listid='+ListId;}else{window.location='/AgentFolders.aspx?ProfileAddress='+profile+'&viewtype='+viewType;}}, 600);}}
function ChangeViewType(type) {HideToolTip();if((currentViewType=='map' && viewType!='map')||(currentViewType!='map' && viewType=='map')){window.setTimeout(function(){if(ListId!="" && ListId!=undefined) {window.location='/MyFolders.aspx?type='+type+'&listid='+ListId;}else{window.location='/MyFolders.aspx?type='+type;}},600);}}
function BookmarkChangeView(viewType) {HideToolTip();window.setTimeout(function(){if(ListId!="" && ListId!=undefined) {window.location='/agent-tools/bookmarks.aspx?viewtype='+viewType+'&listid='+ListId;}else{window.location='/agent-tools/bookmarks.aspx?viewtype='+viewType;}},600)}
function BookmarkChangeViewType(type) {HideToolTip();window.setTimeout(function(){if(ListId!="" && ListId!=undefined) {window.location='/agent-tools/bookmarks.aspx?type='+type+'&listid='+ListId;}else{window.location='/agent-tools/bookmarks.aspx?type='+type;}},600)}
function AgentEmailCheckKeyPress(e){var keynum=0;if(window.event) {keynum=e.keyCode;}
else if(e.which) {keynum=e.which;}
switch (keynum) {case 13:if(gE("agent-email-send-button")) {gE("agent-email-send-button").click();}
break;default:break;}};function FilterBy(txtFilterId) {var query=PageCache.QueryString;if(PageCache.TotalRecords==0) {if(trim(PageCache.LastQueryString)!="") {query=PageCache.LastQueryString;}}
var UGquery=new UrlGen(query);UGquery.RemoveParam("sid");var strURL=WebRoot+"controls/ajaxcalls/filterby.aspx?query="+escape(UGquery.ToString());var FilterName=gE("filter_"+txtFilterId+"_name").value;var FilterInfo=txtFilterId.split("_");if(FilterInfo[0]=="range"){var Min=gE("filter_"+txtFilterId+"_min").value;var Max=gE("filter_"+txtFilterId+"_max").value;Min=Min.replace(/[$,]+/g, '');Max=Max.replace(/[$,]+/g, '');if(isNaN(Min)||isNaN(Max)) {window.alert("Please provide a minimum and maximum numeric value for your filter");return;}
if(parseInt(Max, 10)<=parseInt(Min, 10)) {window.alert("The upper range of your filter must be greater than the lower range");return;}
strURL+=String.format("&type=range&name={0}&min={1}&max={2}", FilterName, Min, Max);}else{window.alert("This filter is not supported");return;}
$AJAX.GetForDelegate(function(AjaxResponse) {RefinementQuery(AjaxResponse);}, strURL);}
function RequeryByLocation(EndecaId) {var UGen=new UrlGen(PageCache.QueryString);if(PageCache.TotalRecords==0) {if(trim(PageCache.LastQueryString)!="") {UGen=new UrlGen(PageCache.LastQueryString);}}
var strNf="";strNf=UGen.GetParam("Nf");var PriceNf="";if((strNf!=undefined) && (strNf.length>0)) {if(strNf.indexOf("Price")>-1) {arrNf=strNf.split("||")
PriceNf=arrNf[0];}}
var NewN=UGen.GetParam("N");if(NewN!=undefined) {arrNewN=NewN.split('+');var _tempN=new Array();for (var i=0; i<arrNewN.length; i++) {if(arrNewN[i]!=PageCache.Location) {_tempN.push(arrNewN[i]);}}
_tempN.push(EndecaId);if(UGen.GetParam("Ntk").indexOf("CodeListingType")>-1) {UGen.RemoveParam("Ntt");UGen.RemoveParam("Ntk");UGen.AddParam("Ntk", "CodeListingType");UGen.AddParam("Ntt", "F");}else{UGen.RemoveParam("Ntt");UGen.RemoveParam("Ntk");}
UGen.RemoveParam("Ntx");UGen.RemoveParam("N");UGen.AddParam("N", _tempN.join('+'));UGen.RemoveParams(["Nf", "No", "Ne"]);if(PriceNf.length>0) {UGen.AddParam("Nf", PriceNf);}}
UGen.RemoveParam("Z");Recenter=true;ReloadMapOnly=false;AddToHistory=false;RunQuery(UGen.ToString(), Recenter, ReloadMapOnly, AddToHistory);}
function RequeryOnBounds(Recenter, AddZoom, AddToHistory) {AddToHistory=false;if(Recenter==undefined) {Recenter=false;}
if(AddZoom==undefined) {AddZoom=true;}
var CurrentBounds=map.getBounds();var SW=CurrentBounds.getSouthWest();var NE=CurrentBounds.getNorthEast();var LngMin=SW.lng();var LngMax=NE.lng();var LatMin=SW.lat();var LatMax=NE.lat();var searchBounds=String.format('Latitude|BTWN+{0}+{1}||Longitude|BTWN+{2}+{3}', LatMin, LatMax, LngMin, LngMax);var UGen=new UrlGen(PageCache.QueryString);if(PageCache.TotalRecords==0) {if(trim(PageCache.LastQueryString)!="") {UGen=new UrlGen(PageCache.LastQueryString);}}
var strNf="";strNf=UGen.GetParam("Nf");var PriceNf="";if((strNf!=undefined) && (strNf.length>0)) {if(strNf.indexOf("Price")>-1) {arrNf=strNf.split("||")
PriceNf=arrNf[0];}}
var NewN=UGen.GetParam("N");if(NewN!=undefined) {arrNewN=NewN.split('+');var _tempN=new Array();for (var i=0; i<arrNewN.length; i++) {if(arrNewN[i]!=PageCache.Location) {_tempN.push(arrNewN[i]);}}
if(!DoReloadResults()) {_tempN.push(PageCache.Location);}
if(UGen.GetParam("Ntk").indexOf("CodeListingType")>-1) {UGen.RemoveParam("Ntt");UGen.RemoveParam("Ntk");UGen.AddParam("Ntk", "CodeListingType");UGen.AddParam("Ntt", "F");}
UGen.RemoveParam("Ntx");UGen.RemoveParam("N");UGen.AddParam("N", _tempN.join('+'));UGen.RemoveParams(["Nf", "No", "Ne"]);if(PriceNf.length>0) {searchBounds=PriceNf+"||"+searchBounds;}
UGen.AddParam("Nf", searchBounds);}
if(AddZoom) {UGen.RemoveParam("Z");UGen.AddParam("Z", map.getZoom());}
ReloadMapOnly=false;if(!DoReloadResults()) {Recenter=false;ReloadMapOnly=true;}
RunQuery(UGen.ToString(), Recenter, ReloadMapOnly, AddToHistory);ReloadFrameAds();OmEvent(gE("map"), 6, "map_event");}
function RefinementQuery(Query) {RunQuery(Query, true, false);var WrapTop=RecurseOffset(gE("results")).offsetTop;if(document.documentElement) {var scrollTop=document.documentElement.scrollTop;}else{var scrollTop=document.body.scrollTop;}
if(scrollTop>WrapTop) {window.scrollTo(0, WrapTop);}}
function PagingQuery(Query) {loading(true);OverlayCache.RemoveOverlayTypes(["Neighborhood", "PrimeNeighborhood"]);OverlayCache.RemoveCacheTypes(["Neighborhood", "PrimeNeighborhood"]);RunQuery(Query, true, false);loading(false);toogle_map_view(false);var WindowBounds=new GetWindowBunds();var Target=(RecurseOffset(gE("map")).offsetTop - 15);if(WindowBounds.VisibleTop>Target) {window.scrollTo(0, 0);}
paginationWidth();var resultsH=gE('results').style.height;if(gE('results').style.height<gE('global_content_left')) {pagH-=19;var conH=$('#global_content_left').height();gE('right_rail').style.height=conH+'px';}else{var conH=$('#results').height();gE('right_rail').style.height=conH+'px';}}
var Locationclicked=new Object();function LocationStatus(location) {Locationclicked.status=location;}
function LocationQuery(Query, Recenter, ReloadMapOnly, AddToHistory) {loading(true);RunQuery(Query, Recenter, ReloadMapOnly, AddToHistory);paginationWidth();loading(false);toogle_map_view(false);}
var XSLProcessors=new Object();XSLProcessors.listings=null;XSLProcessors.paging=null;XSLProcessors.toppaging=null;XSLProcessors.bottompaging=null;XSLProcessors.status=null;XSLProcessors.sortoptions=null;XSLProcessors.navrefinements=null;XSLProcessors.rss=null;XSLProcessors.results=null;XSLProcessors.header=null;XSLProcessors.propertytypes=null;XSLProcessors.amenities=null;XSLProcessors.listinginfobubble=null;XSLProcessors.nearestneighborhoods=null;XSLProcessors.seoblurb=null;XSLProcessors.openhouses=null;XSLProcessors.virtualtours=null;XSLProcessors.loaded=false;XSLProcessors.load=function(XSLPath) {var processor=new XSLTProcessor();var xslDoc=Sarissa.getDomDocument();xslDoc.async=false;var xmlhttp=new XMLHttpRequest();xmlhttp.open('GET', AbsoluteWebRoot+XSLPath, false);xmlhttp.send('');xslDoc=xmlhttp.responseXML;processor.importStylesheet(xslDoc);return processor;};XSLProcessors.loadAll=function () {XSLProcessors.listings=XSLProcessors.load("Includes/XSL/Results_Listings.xsl");XSLProcessors.listings.setParameter('', "BypassGlobalProxy", typeof (bypassGlobalImgProxy)==undefined ? true : bypassGlobalImgProxy);XSLProcessors.listings.setParameter('', "ImageProxyHostname", typeof (imgProxyHostname)==undefined ? "" : imgProxyHostname);XSLProcessors.listings.setParameter('', "LogoImageProxyHostname", typeof (logoImgProxyHostname)==undefined ? "" : logoImgProxyHostname);XSLProcessors.listings.setParameter('', "StaticImageHostname", typeof (staticImgHostname)==undefined ? "" : staticImgHostname);XSLProcessors.listings.setParameter('', "ResourceVersion", typeof (resourceVersion)==undefined ? "" : resourceVersion);XSLProcessors.paging=XSLProcessors.load("Includes/XSL/Results_Pagination.xsl");XSLProcessors.paging.setParameter('', "IsSeoUrl", 'true');XSLProcessors.toppaging=XSLProcessors.load("Includes/XSL/Results_Pagination.xsl");XSLProcessors.toppaging.setParameter('', "IsSeoUrl", 'false');XSLProcessors.toppaging.setParameter('', "Pagination", 'top');XSLProcessors.bottompaging=XSLProcessors.load("Includes/XSL/Results_Pagination.xsl");XSLProcessors.bottompaging.setParameter('', "IsSeoUrl", 'false');XSLProcessors.bottompaging.setParameter('', "Pagination", 'bottom');XSLProcessors.status=XSLProcessors.load("Includes/XSL/Results_Status.xsl");XSLProcessors.sortoptions=XSLProcessors.load("Includes/XSL/Results_SortOptions.xsl");XSLProcessors.navrefinements=XSLProcessors.load("Includes/XSL/Results_NavRefinements.xsl");XSLProcessors.navselections=XSLProcessors.load("Includes/XSL/Results_NavSelections.xsl");XSLProcessors.rss=XSLProcessors.load("Includes/XSL/Results_RSS.xsl");XSLProcessors.propertytypes=XSLProcessors.load("Includes/XSL/Results_PropertyType.xsl");XSLProcessors.amenities=XSLProcessors.load("Includes/XSL/Results_Amenities.xsl");XSLProcessors.listinginfobubble=XSLProcessors.load("Includes/XSL/Results_ListingInfoBubble.xsl");XSLProcessors.listinginfobubble.setParameter('', "BypassGlobalProxy", typeof (bypassGlobalImgProxy)==undefined ? true : bypassGlobalImgProxy);XSLProcessors.listinginfobubble.setParameter('', "ImageProxyHostname", typeof (imgProxyHostname)==undefined ? "" : imgProxyHostname);XSLProcessors.listinginfobubble.setParameter('', "StaticImageHostname", typeof (staticImgHostname)==undefined ? "" : staticImgHostname);XSLProcessors.listinginfobubble.setParameter('', "ResourceVersion", typeof (resourceVersion)==undefined ? "" : resourceVersion);XSLProcessors.results=XSLProcessors.load("Includes/XSL/Results_Results.xsl");XSLProcessors.header=XSLProcessors.load("Includes/XSL/Results_Header.xsl");XSLProcessors.seoblurb=XSLProcessors.load("Includes/XSL/Results_SEOBlurb.xsl");XSLProcessors.paging=XSLProcessors.load("Includes/XSL/Results_Pagination.xsl");XSLProcessors.mapstatus=XSLProcessors.load("Includes/XSL/Results_MapStatus.xsl");XSLProcessors.openhouses=XSLProcessors.load("Includes/XSL/results_openhouses.xsl");XSLProcessors.virtualtours=XSLProcessors.load("Includes/XSL/Results_VirtualTours.xsl");XSLProcessors.beds=XSLProcessors.load("Includes/XSL/results_beds.xsl");XSLProcessors.baths=XSLProcessors.load("Includes/XSL/results_baths.xsl");XSLProcessors.breadcrumbs=XSLProcessors.load("Includes/XSL/Results_Breadcrumbs.xsl");XSLProcessors.loaded=true;};function RunQuery(Query, Recenter, ReloadMapOnly, AddToHistory) {AddToHistory=false;Recenter=SetDefault(Recenter, true);ReloadMapOnly=SetDefault(ReloadMapOnly, false);$("#nearestcities #result_wrapper").html("&nbsp;");$("#nearestneighborhoods #result_wrapper").html("&nbsp;");jsQueryString=Query;var isMapSearch=false;var isMapPanSearch=false;var meta;if(document.createElement && (meta=document.createElement('meta'))) {var pos=Query.indexOf("&No=")
if(pos>=0) {meta.name="robots";meta.content="noindex";document.getElementsByTagName('head').item(0).appendChild(meta);}}
if(!DoReloadResults()) {isMapSearch=true;}
if(unescape(Query).toLowerCase().indexOf("latitude|btwn")>-1 &&
unescape(Query).toLowerCase().indexOf("longitude|btwn")>-1) {isMapPanSearch=true;}
var QGen=new UrlGen(Query);var isZipSearch=false;if(QGen.GetParam("Ntk").indexOf("AddrZip")>-1) {isZipSearch=true;}
if((!window.XSLTProcessor) && (!window.ActiveXObject)) {var QGen=new UrlGen(Query);QGen.RemoveParams(["sb", "ms"]);QGen.AddParam("sb", sb);QGen.AddParam("ms", MapState.Current);window.location.href=window.location.href.substr(0, indexOf('?'))+QGen.ToString();return;}
try { LdImgs.Dispose(); } catch (ex) { }
if(XSLProcessors.loaded==false) {XSLProcessors.loadAll();}
var xmlDocPath="";xmlDocPath="Results_XML.aspx?"+Query;var XMLDoc=Sarissa.getDomDocument();XMLDoc.async=false;var xmlhttp=new XMLHttpRequest();xmlhttp.open("GET", AbsoluteWebRoot+xmlDocPath, false);try {xmlhttp.setRequestHeader("Authorization", XKp);}
catch (ex) {}
xmlhttp.send('');XMLDoc=xmlhttp.responseXML;if(PageCache==null) PageCache=new Object();PageCache.XML=XMLDoc;var NoResults=GetSingleNodeContent(XMLDoc, '/results/breadcrumbs/noresults');var ListingPoints=GetSingleNodeContent(XMLDoc, '/results/listings/mappedlistingsjs');var RegionPoints=GetSingleNodeContent(XMLDoc, "/results/regions");var viewstate=GetSingleNodeContent(XMLDoc, "/results/viewstate");var locationmoduletext=GetSingleNodeContent(XMLDoc, "/results/locationmoduletext");FDS.locationfield=locationmoduletext;PageCache.ShowListingsOnMap=GetSingleNodeContent(XMLDoc, "/results/showlistingsonmap");PageCache.MapBestFit=GetSingleNodeContent(XMLDoc, "/results/mapbestfit");var SELECTED="";if(DoReloadResults()) {SELECTED="checked=checked";}
if(gE("map_function_toggle")!=null) {gE("map_function_toggle").innerHTML=String.format("<div><input type='checkbox' id='mlo' name='mlo' onclick='ToggleMapLoadOption(this);' {0}><label for='mlo'>update the results below while I navigate the map</label></div>", SELECTED);}
if(gE("testingQuery")!=null) {gE("testingQuery").value=Query;gE("viewstate").value=viewstate;}
NbMg.NextLoad("closed", "closed");Sarissa.updateContentFromNode(XMLDoc, gE("resultsrss"), XSLProcessors.rss);if(ReloadMapOnly) {map.clearOverlays();OverlayCache.RemoveCacheType("Region");eval(RegionPoints);OverlayCache.RenderOverlayTypes(["Listing", "Region", "PrimeNeighborhood"]);return;}
PageCache.CenterOnRegions=eval(GetSingleNodeContent(XMLDoc, "/results/centeronregions"));NextLoad(ListingPoints, RegionPoints, Recenter);PageCache.SEOPath=GetSingleNodeContent(XMLDoc, '/results/seopath');window.location.href="#"+PageCache.SEOPath;var RefinementMetaText=GetSingleNodeContent(XMLDoc, '/results/refinementmetatext');if(RefinementMetaText==undefined){RefinementMetaText="";}
var newTitle=GetSingleNodeContent(XMLDoc, "/results/addrcitydisplay")+" Real Estate & Homes for Sale in "+GetSingleNodeContent(XMLDoc, "/results/centerregionname")+" : "+WebsiteName;if(RefinementMetaText.indexOf("Foreclosed")>-1){newTitle=GetSingleNodeContent(XMLDoc, "/results/addrcitydisplay")+" Real Estate Foreclosure Listings in "+GetSingleNodeContent(XMLDoc, "/results/centerregionname")+" : "+WebsiteName;}
else if(RefinementMetaText.indexOf("New Homes")>-1){newTitle=GetSingleNodeContent(XMLDoc, "/results/addrcitydisplay")+" Real Estate New Home Listings in "+GetSingleNodeContent(XMLDoc, "/results/centerregionname")+" : "+WebsiteName;}
else if(RefinementMetaText!=""){newTitle=RefinementMetaText+" for Sale in "+GetSingleNodeContent(XMLDoc, "/results/centerregionname")+" : "+WebsiteName;}
else{newTitle=GetSingleNodeContent(XMLDoc, "/results/addrcitydisplay")+" Real Estate & Homes for Sale in "+GetSingleNodeContent(XMLDoc, "/results/centerregionname")+" : "+WebsiteName;}
document.title=newTitle;var hasNeighborhoods=false;var hasCities=false;Sarissa.updateContentFromNode(XMLDoc, gE("results_term"), XSLProcessors.results);UnescapeCommonInnerHTML(gE("results_term"));Sarissa.updateContentFromNode(XMLDoc, gE("results_text"), XSLProcessors.header);UnescapeCommonInnerHTML(gE("results_text"));fc_query=unescapeAmp(GetSingleNodeContent(XMLDoc, '/results/foreclosurequery'));ap_query=unescapeAmp(GetSingleNodeContent(XMLDoc, '/results/allpropertiesquery'));nh_query=unescapeAmp(GetSingleNodeContent(XMLDoc, '/results/newhomesquery'));PageCache.TotalRecords=parseInt(GetSingleNodeContent(XMLDoc, '/results/pagination/pages/totalrecords'), 10);if(isNaN(PageCache.TotalRecords)) {PageCache.TotalRecords=0;}
Sarissa.updateContentFromNode(XMLDoc, gE("pagingtop"), XSLProcessors.toppaging);Sarissa.updateContentFromNode(XMLDoc, gE("pagingbottom"), XSLProcessors.bottompaging);Sarissa.updateContentFromNode(XMLDoc, gE("sortoptions"), XSLProcessors.sortoptions);Sarissa.updateContentFromNode(XMLDoc, gE("status"), XSLProcessors.status);Sarissa.updateContentFromNode(XMLDoc, gE("map_status"), XSLProcessors.mapstatus);Sarissa.updateContentFromNode(XMLDoc, gE("results_listings"), XSLProcessors.listings);Sarissa.updateContentFromNode(XMLDoc, gE("what_is"), XSLProcessors.seoblurb);Sarissa.updateContentFromNode(XMLDoc, gE("propertytype_drop_div"), XSLProcessors.propertytypes);Sarissa.updateContentFromNode(XMLDoc, gE("amenities_drop_div"), XSLProcessors.amenities);Sarissa.updateContentFromNode(XMLDoc, gE("openhouses"), XSLProcessors.openhouses);Sarissa.updateContentFromNode(XMLDoc, gE("virtualtours"), XSLProcessors.virtualtours);Sarissa.updateContentFromNode(XMLDoc, gE("bedrooms_drop_div"), XSLProcessors.beds);Sarissa.updateContentFromNode(XMLDoc, gE("bathrooms_drop_div"), XSLProcessors.baths);Sarissa.updateContentFromNode(XMLDoc, gE("bathrooms_drop_div"), XSLProcessors.baths);Sarissa.updateContentFromNode(XMLDoc, gE("breadcrumb"), XSLProcessors.breadcrumbs);var UGQuery=new UrlGen(Query);var FilterQuery=UGQuery.GetParam("N").split("+");for (i=0; i<FilterQuery.length; i++) {var Query1=FilterQuery[i];if(Query1=="19" && gE("results_Single-family")!=null) { gE("results_Single-family").checked=true; $('#results_Single-family').parent().addClass('selected');   }
if(Query1=="21" && gE("results_Multi-family")!=null) { gE("results_Multi-family").checked=true; $('#results_Multi-family').parent().addClass('selected'); }
if(Query1=="26" && gE("results_Land")!=null) { gE("results_Land").checked=true; $('#results_Land').parent().addClass('selected');  }
if(Query1=="878100" && gE("results_Townhouse")!=null) { gE("results_Townhouse").checked=true; $('#results_Townhouse').parent().addClass('selected'); }
if(Query1=="829171" && gE("results_Other")!=null) { gE("results_Other").checked=true; $('#results_Other').parent().addClass('selected'); }
if(Query1=="829180" && gE("results_Condo")!=null) { gE("results_Condo").checked=true; $('#results_Condo').parent().addClass('selected'); }
if(Query1=="1305609" && gE("results_55-community")!=null) { gE("results_55-community").checked=true; $('#results_55-Community').parent().addClass('selected'); }
if(Query1=="1305610" && gE("results_Apartment")!=null) { gE("results_Apartment").checked=true; $('#results_Apartment').parent().addClass('selected'); }
if(Query1=="1305611" && gE("results_Duplex")!=null) { gE("results_Duplex").checked=true; $('#results_Duplex').parent().addClass('selected'); }
if(Query1=="1305612" && gE("results_Loft")!=null) { gE("results_Loft").checked=true; $('#results_Loft').parent().addClass('selected'); }
if(Query1=="1305613" && gE("results_New-Construction")!=null) { gE("results_New-Construction").checked=true; $('#results_New-Construction').parent().addClass('selected'); }
if(Query1=="878103" && gE("results_a-c")!=null) { gE("results_a-c").checked=true; $('#results_a-c').parent().addClass('selected');  }
if(Query1=="878105" && gE("results_fireplace")!=null) { gE("results_fireplace").checked=true; $('#results_fireplace').parent().addClass('selected'); }
if(Query1=="878102" && gE("results_garage")!=null) { gE("results_garage").checked=true; $('#results_garage').parent().addClass('selected');  }
if(Query1=="975577" && gE("results_golf-course")!=null) { gE("results_golf-course").checked=true; $('#results_golf-course').parent().addClass('selected'); }
if(Query1=="878106" && gE("results_patio-deck")!=null) { gE("results_patio-deck").checked=true; $('#results_patio-deck').parent().addClass('selected'); }
if(Query1=="878104" && gE("results_pool")!=null) { gE("results_pool").checked=true; $('#results_pool').parent().addClass('selected'); }
if(Query1=="1015760" && gE("results_retirement")!=null) { gE("results_retirement").checked=true; $('#results_retirement').parent().addClass('selected'); }
if(Query1=="878107" && gE("results_waterfront")!=null) { gE("results_waterfront").checked=true; $('#results_waterfront').parent().addClass('selected'); }
if(Query1=="1305619" && gE("results_central-air-conditioning")!=null) { gE("results_central-air-conditioning").checked=true; $('#results_central-air-conditioning').parent().addClass('selected'); }
if(Query1=="1305620" && gE("results_dishwasher")!=null) { gE("results_dishwasher").checked=true; $('#results_dishwasher').parent().addClass('selected'); }
if(Query1=="1305621" && gE("results_doorman")!=null) { gE("results_doorman").checked=true; $('#results_doorman').parent().addClass('selected'); }
if(Query1=="1305622" && gE("results_washer-dryer-hookups")!=null) { gE("results_washer-dryer-hookups").checked=true; $('#results_washer-dryer-hookups').parent().addClass('selected'); }
if(Query1=="1305623" && gE("results_washer-dryer-in-bldg")!=null) { gE("results_washer-dryer-in-bldg").checked=true; $('#results_washer-dryer-in-bldg').parent().addClass('selected'); }
if(Query1=="1305624" && gE("results_washer-dryer-in-unit")!=null) { gE("results_washer-dryer-in-unit").checked=true; $('#results_washer-dryer-in-unit').parent().addClass('selected'); }
if(Query1=="1305625" && gE("results_waterfront-beach")!=null) { gE("results_waterfront-beach").checked=true; $('#results_waterfront-beach').parent().addClass('selected'); }
if(Query1=="1305626" && gE("results_waterfront-river")!=null) { gE("results_waterfront-river").checked=true; $('#results_waterfront-river').parent().addClass('selected'); }
if(Query1=="1305627" && gE("results_waterfront-lake")!=null) { gE("results_waterfront-lake").checked=true; $('#results_waterfront-lake').parent().addClass('selected'); }
if(Query1=="1305628" && gE("results_waterfront-bay")!=null) { gE("results_waterfront-bay").checked=true; $('#results_waterfront-bay').parent().addClass('selected'); }
if(Query1=="1305629" && gE("results_mountain-view")!=null) { gE("results_mountain-view").checked=true; $('#results_mountain-view').parent().addClass('selected'); }
if(Query1=="1305630" && gE("results_yard")!=null) { gE("results_yard").checked=true; $('#results_yard').parent().addClass('selected'); }
if(Query1=="1305631" && gE("results_senior-community")!=null) { gE("results_senior-community").checked=true; $('#results_senior-community').parent().addClass('selected'); }}
if(gE("results_All-Dates")!=null) {if(Query.indexOf("+1118487")>0 && gE("results_All-Dates")!=null) { gE("results_All-Dates").checked=true; }
if(Query.indexOf("+1118483")>0 && gE("results_Today")!=null) { gE("results_Today").checked=true; gE("results_All-Dates").checked=false; }
if(Query.indexOf("+1118484")>0 && gE("results_Tomorrow")!=null) { gE("results_Tomorrow").checked=true; gE("results_All-Dates").checked=false; }
if(Query.indexOf("+1118485")>0 && gE("results_This-weekend")!=null) { gE("results_This-weekend").checked=true; gE("results_All-Dates").checked=false; }
if(Query.indexOf("+1118486")>0 && gE("results_Next-weekend")!=null) { gE("results_Next-weekend").checked=true; gE("results_All-Dates").checked=false; }}
if(gE("results_With_virtualtours")!=null){if(Query.indexOf("+878065")>0 ){gE("results_With_virtualtours").checked=true;}}
var filterGen=new UrlGen(Query);if(filterGen.GetParam("Nf").indexOf('OpenHouse1Date')>-1) {if(gE("CustomDateRange")!=null) {gE("CustomDateRange").checked=true;showOHcustomdates(gE("CustomDateRange"));startpos=filterGen.GetParam("Nf").indexOf('+');endpos=filterGen.GetParam("Nf").lastIndexOf('+');if(startpos>-1 && endpos>-1) {if(gE("ohstart")!=null) { gE("ohstart").value=FormatDate(filterGen.GetParam("Nf").substr(startpos+1, endpos - startpos - 1)); }
if(gE("ohend")!=null) { gE("ohend").value=FormatDate(filterGen.GetParam("Nf").substr(endpos+1)); }}}}
$("#ohstart").datepicker({minDate: 0,monthNames: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],dayNamesMin: ['Su', 'M', 'Tu', 'W', 'Th', 'F', 'Sa'],duration: 0,onClose: function() { LeftNavBusy='false'; }});$("#ohend").datepicker({minDate: 0,monthNames: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],dayNamesMin: ['Su', 'M', 'Tu', 'W', 'Th', 'F', 'Sa'],duration: 0,onClose: function() { LeftNavBusy='false'; RFQuery(LeftNavBusy); }});UnescapeCommonInnerHTML(gE("results_listings"));MapState.Render(true);if(gE("featuredListingsCarousel") && MapState.Current=='map_hidden') {showNewResults(Query);}
PageCache.ListingIds=GetSingleNodeContent(XMLDoc, "/results/listingids");SearchCriteria=GetSingleNodeContent(XMLDoc, '/results/centerregionname');var TmpSearchCriteria=GetSingleNodeContent(XMLDoc, "/results/searchcriteria");if(GetSingleNodeContent(XMLDoc, '/results/centerregionname')!="" && TmpSearchCriteria!="" && TmpSearchCriteria!=undefined) {SearchCriteria+=", ";}
if(TmpSearchCriteria!=undefined){SearchCriteria+=GetSingleNodeContent(XMLDoc, "/results/searchcriteria");}
if(SearchCriteria.length>50) {SearchCriteria=SearchCriteria.substr(0, 47)+"...";}
PageCache.QueryString=Query;SetCookieState("CurrentSearch", "Result", escape(Query));if(PageCache.TotalRecords>0) {PageCache.LastQueryString=Query;}
var lcount=unescapeAmp(GetSingleNodeContent(XMLDoc, '/results/listings/ListingCount'));if(parseInt(lcount)>0){MapState.Render(true);}
else{if(gE("map_border")){gE("map_border").style.display="none";}}
gE("txtAboutPageSearch").value=locationmoduletext;if(typeof BookmarkModuleRequery=='function' && gE("properties-drop-box")) {BookmarkModuleRequery("", "results-module", "results-module");}
ChangeResultUserAction(PageCache.ListingIds);};var MapClicked=false;var map=null;function DoReloadResults(){if(gE("mlo")){return gE("mlo").checked;}
else{return true;}}
function PageLoader(){CaptureMouseXY();LoadMap();}
try{function TextualZoomControl() {}
TextualZoomControl.prototype=new GControl();TextualZoomControl.prototype.initialize=function(map) {var container=document.createElement("div");container.className="map_zoom clearfix";container.id="ZoomContainer";var zoomInDiv=document.createElement("div");zoomInDiv.className="zoom_in";container.appendChild(zoomInDiv);zoomInDiv.innerHTML="<img src='"+WebRoot+"images/zoom_bar/zoom_in.gif' />";GEvent.addDomListener(zoomInDiv, "click", function() {DoZoomIn();});var zoomLevel=document.createElement("div");zoomLevel.className="level";container.appendChild(zoomLevel);if(map.getZoom()<=18) {zoomLevel.innerHTML="<img src='"+WebRoot+"images/zoom_bar/"+map.getZoom()+".gif' usemap='#ZTracker' />";}else{zoomLevel.innerHTML="<img src='"+WebRoot+"images/zoom_bar/18.gif' usemap='#ZTracker' />";}
GEvent.addDomListener(map, "zoomend", function() {if(map.getZoom()<=18) {zoomLevel.innerHTML="<img src='"+WebRoot+"images/zoom_bar/"+map.getZoom()+".gif' usemap='#ZTracker' />";}else{zoomLevel.innerHTML="<img src='"+WebRoot+"images/zoom_bar/18.gif' usemap='#ZTracker' />";}});var zoomOutDiv=document.createElement("div");zoomOutDiv.className="zoom_out";container.appendChild(zoomOutDiv);zoomOutDiv.innerHTML="<img src='"+WebRoot+"images/zoom_bar/zoom_out.gif' />";GEvent.addDomListener(zoomOutDiv, "click", function() {DoZoomOut();});map.getContainer().appendChild(container);return container;};TextualZoomControl.prototype.getDefaultPosition=function(){return new GControlPosition(G_ANCHOR_TOP_LEFT, new GSize(8, 8));};}
catch(ex){}
function DoZoomOut(){map.zoomOut();RequeryOnBounds(false,true);}
function DoZoomIn(){if((map.getZoom()+1)<=16){map.zoomIn();RequeryOnBounds(false,true);}}
function DoZoom(num){if(num<=16){map.setZoom(num);RequeryOnBounds(false,true);}}
function LoadMap(){map=new GMap2(gE("map"));map.addControl(new GMapTypeControl());map.addControl(new TextualZoomControl());map.setCenter(new GLatLng(DefaultLatitude, DefaultLongitude), DefaultZoom);GEvent.addListener(map, "dragend", function(){crosshair();if(map.getInfoWindow().isHidden()){window.setTimeout(function(){RequeryOnBounds(false,true);},100);}});GEvent.addListener(map, "dragstart", function(){crosshair();});GEvent.addListener(map, "mousedown", function(){if(MapClicked==false){OmEvent(this, 6, 'map_clicked');MapClicked=true;}});GEvent.addListener(map, "infowindowopen", function(){map.savePosition();});GEvent.addListener(map, "infowindowclose", function(){map.returnToSavedPosition();});if(PageCache.XML!=null){var ListingsJS=GetSingleNodeContent(PageCache.XML, '/results/listings/mappedlistingsjs');var RegionsJS=GetSingleNodeContent(PageCache.XML, "/results/regions");NextLoad(ListingsJS, RegionsJS, true);}
else{FirstLoad();}}
function NextLoad(ListingsJS, RegionsJS, Recenter){OverlayCache.RemoveCacheTypes(["GLatLng", "Listing", "Region", "Neighborhood"]);if(map){map.clearOverlays();}
eval(RegionsJS);eval(ListingsJS);if(map){if(PageCache.MapBestFit!="neighborhoods"){RenderMapOptions(Recenter);}}}
function PostPointLoading(Recenter){if(Recenter==true){MapBestFit();}}
function MapBestFit(){var GLatLngs=OverlayCache.GetType("GLatLng");if(GLatLngs.length==0){return;}
var Bounds=new GLatLngBounds();for (var i=0; i<GLatLngs.length; i++){Bounds.extend(GLatLngs[i]);}
var Zoom=map.getBoundsZoomLevel(Bounds);var Center=Bounds.getCenter();map.setCenter(Center, Zoom);OverlayCache.RemoveCacheType("GLatLng");}
function MapBestFitBounds(Bounds){if(map){map.checkResize();var Zoom=map.getBoundsZoomLevel(Bounds);var Center=Bounds.getCenter();map.setCenter(Center, Zoom);}}
function RenderMapOptions(Recenter){if(Recenter){var MapBounds;switch(PageCache.MapBestFit){case "mapbounds":MapBounds=GetBoundsFromQueryString(PageCache.QueryString);break;case "regions":MapBounds=OverlayCache.GetMapBoundsByType("Region");break;case "neighborhoods":MapBounds=OverlayCache.GetMapBoundsByType("PrimeNeighborhood");break;case "listings":MapBounds=OverlayCache.GetMapBoundsByType("Listing");break;default:MapBounds=OverlayCache.GetMapBoundsByType("Listing");break;}
MapBestFitBounds(MapBounds);}
var RenderMapTypes=["Region", "PrimeNeighborhood"];if(PageCache.ShowListingsOnMap){RenderMapTypes.push("Listing");}
OverlayCache.RenderOverlayTypes(RenderMapTypes);LdImgs.Init("listingimg", "images/no_photo2.gif");}
function GetBoundsFromQueryString(QueryString){var LatMin, LatMax, LngMin, LngMax;var Bounds=new GLatLngBounds();var UGen=new UrlGen(QueryString);var eles=unescape(UGen.GetParam("Nf")).split("||");for (var x=0;x<eles.length;x++){var Filter=eles[x].split("|");if(Filter[0].toLowerCase()=="Latitude"){var FilterVals=Filter[1].split(" ");LatMin=parseFloat(FilterVals[1]);LatMax=parseFloat(FilterVals[2]);}
else if(Filter[0].toLowerCase()=="Longitude"){var FilterVals=Filter[1].split(" ");LngMin=parseFloat(FilterVals[1]);LngMax=parseFloat(FilterVals[2]);}}
Bounds.Extend(new GLatLng(LatMin, LngMin));Bounds.Extend(new GLatLng(LatMax, LngMax));return Bounds;}
function gEOpenNearCities(objId, objId2, display){gE(objId).style.visibility="hidden";gE(objId).style.display=display;gE(objId2).style.background='#E9F3F3';var ObjMenuOffset=new RecurseOffset(objId);var ObjAnchorOffset=new RecurseOffset(objId2);var WinBounds=new GetWindowBunds();var MenuBottom=ObjMenuOffset.offsetTop+ObjMenuOffset.offsetHeight;var ScrollBottom=WinBounds.VisibleTop+WinBounds.VisibleHeight;if(MenuBottom>ScrollBottom){var buffer=10;var MoveTo=((MenuBottom - ScrollBottom)+buffer) * -1;}
SweepSelects(objId);gE(objId).style.visibility="visible";gE(objId2).style.fontWeight='bold';}
function gECloseNearCities(objId, objId2, display){gE(objId).style.top="0";gE(objId).style.display=display;gE(objId2).style.background='none';gE(objId2).style.fontWeight='normal';RestoreSelects();}
function gEShowNearestCities(){jQuery('.moreNearestCities').show();jQuery('#showMoreNearestCities').hide();jQuery('#hideMoreNearestCities').show();}
function gEHideNearestCities(){jQuery('.moreNearestCities').hide();jQuery('#showMoreNearestCities').show();jQuery('#hideMoreNearestCities').hide();}
function gEShowMoreNeighborhoods(){jQuery('.moreNeighborhoods').show();jQuery('#showMoreNeighborhoods').hide();jQuery('#hideMoreNeighborhoods').show();}
function gEHideMoreNeighborhoods(){jQuery('.moreNeighborhoods').hide();jQuery('#showMoreNeighborhoods').show();jQuery('#hideMoreNeighborhoods').hide();}
function crosshair(){var C=new RecurseOffset(gE("crosshair"));var M=new RecurseOffset(gE("map"));var D=gE("crosshair").style.display;switch(D){case "block":gE("crosshair").style.left="-100px"
gE("crosshair").style.display="none";break;case "none":gE("crosshair").style.left=(parseInt((M.offsetWidth/2)+M.offsetLeft,10) -4 )+"px";gE("crosshair").style.top=(parseInt((M.offsetHeight/2)+M.offsetTop,10) -3 )+"px";gE("crosshair").style.display="block";break;}}
function getN(strRID, fillColor, borderColor, boolPrimaryNeighborhood){var NiD="Neighborhood";if(boolPrimaryNeighborhood==true){NiD="Prime"+NiD;}
else{boolPrimaryNeighborhood=false;removeN(strRID);}
var strURL=String.format("{0}Controls/AjaxCalls/GetN.aspx?RID={1}&B={2}", WebRoot, strRID, borderColor);if(OverlayCache.GetByTypeId("PrimeNeighborhood", strRID)!=null){return;}
$AJAX.GetForDelegate(function(AjaxResponse){OverlayCache.Add(NiD, strRID, eval("new GPolygon.fromEncoded({\
polylines: ["+AjaxResponse+"],\
fill: true,\
color: '#"+fillColor+"',\
outline: true\});"));OverlayCache.RenderOverlayType(NiD);if(NiD=="PrimeNeighborhood"){RenderMapOptions(true);}}, strURL);return;}
function removeN(strRID){OverlayCache.RemoveOverlayType("Neighborhood");OverlayCache.RemoveCacheType("Neighborhood");}
function CustomZIndexOrder(Marker, b){return GOverlay.getZIndex(Marker.getPoint().lat())+Marker.CustomZIndex * 1000000;}
function ReturnLastPan(){RunQuery(PageCache.LastQueryString, true);}
function Get_Detail(IdListing, e, eleDiv, SeoUrl){var target;var evt=e||window.event;target=evt.srcElement||evt.target;if((target.id.indexOf("link_result_advertisername_")>-1)||(target.id.indexOf("result_logo_")>-1)||(target.id.indexOf("vt_")>-1)) return;if(SeoUrl==undefined||SeoUrl==''||SeoUrl==null){if(target==undefined||target==''||target==null){target=e;}
if(target.tagName.toLowerCase()=='img'){if(target.parentNode.tagName.toLowerCase()=='a'){target=target.parentNode;}else{target=target.parentNode.parentNode;}}}
else{target=SeoUrl;}
var isCTRL=false;if(evt.ctrlKey!=undefined && evt.ctrlKey!=null){isCTRL=evt.ctrlKey;}
var UGen=new UrlGen(PageCache.QueryString);UGen.RemoveParams(["LID","LIDS","T"]);UGen.AddParam("T",PageCache.TotalRecords);UGen.AddParam("LID",IdListing.toUpperCase());UGen.AddParam("LIDS",PageCache.ListingIds.toUpperCase());var strURL=WebRoot+"controls/ajaxcalls/DetailListingPath.aspx?"+UGen.ToString();$AJAX.GetForDelegate(function(AjaxResponse){var w=window;if(isCTRL)
{w=window.open();w.opener.focus()}
w.location.href=target;}, strURL);}
function ToggleMapLoadOption(ele){var CookieName=LastSearchCookieName;var Key="MapLoadOption";var Value="False";if(ele.checked){Value="True";window.setTimeout(function(){RequeryOnBounds(false, true);},100);}
SetCookieState(CookieName, Key, Value);}
function CustomPriceRangeToggle(objOpener, strMin, strMax){var ele=gE("custom_price");if(ele.style.display=="block"){ele.style.left="1px";ele.style.top="1px";ele.style.display="none";}
else{if(strMin!=undefined && strMax!=undefined){gE("custom_price_min").value=strMin;gE("custom_price_max").value=strMax;}
else{gE("custom_price_min").value="";gE("custom_price_max").value="";}
ele.style.left=(RecurseOffset(objOpener).offsetLeft+RecurseOffset(objOpener).offsetWidth )+"px";ele.style.top=RecurseOffset(objOpener).offsetTop+"px";ele.style.display="block";}}
function CustomPrice(FilterName){var CustomPrice=gE("custom_price");var Min=gE("custom_price_min").value;var Max=gE("custom_price_max").value;var MinHeader=gE("custom_price_min_header");var MaxHeader=gE("custom_price_max_header");var MinFooter=gE("custom_price_min_footer");var MaxFooter=gE("custom_price_max_footer");var Message=gE("custom_price_message");MinHeader.innerHTML="Minimum Price";MaxHeader.innerHTML="Maximum Price";MinFooter.innerHTML="i.e. 100,000";MaxFooter.innerHTML="i.e. 153,000";Message.innerHTML="";MinHeader.className="CustomPriceNorm";MaxHeader.className="CustomPriceNorm";MinFooter.className="CustomPriceNorm";MaxFooter.className="CustomPriceNorm";Message.style.display="none";Min=Min.replace(/[$,]+/g,'');Max=Max.replace(/[$,]+/g,'');if(isNaN(Min)||trim(Min)==""){MinHeader.className="CustomPriceError";MinFooter.className="CustomPriceError";MinFooter.innerHTML="please enter a number";return;}
if(isNaN(Max)||trim(Max)==""){MaxHeader.className="CustomPriceError";MaxFooter.className="CustomPriceError";MaxFooter.innerHTML="please enter a number";return;}
if(parseInt(Max,10)<=parseInt(Min,10)){MaxHeader.className="CustomPriceError";MinHeader.className="CustomPriceError";Message.className="CustomPriceError";Message.style.display="block";Message.innerHTML="The minimum price cannot be greater than the maximum price";return;}
var query=PageCache.QueryString;if(PageCache.TotalRecords==0){if(trim(PageCache.LastQueryString)!=""){query=PageCache.LastQueryString;}}
var UGquery=new UrlGen(query);UGquery.RemoveParam("sid");var strURL=WebRoot+"controls/ajaxcalls/filterby.aspx?query="+escape(UGquery.ToString());strURL+=String.format("&type=range&name={0}&min={1}&max={2}", FilterName, Min, Max);CustomPriceRangeToggle();$AJAX.GetForDelegate(function(AjaxResponse){RefinementQuery(AjaxResponse);},strURL);}
function DivObjOpacity(DivObj, Op){if(DivObj.id=="dMap"){var tmp=/MSIE\s(\d+\.\d+);/;if(tmp.test(navigator.userAgent)){var matches=tmp.exec(navigator.userAgent);var ieversion=new Number(matches[1]);if(ieversion<7){return;}}}
DivObj.style.opacity=Op / 100;DivObj.style.filter='alpha(opacity='+Op+')';};function NearestRedirect(path) {location.href=path;}
function NearbyManagerElement(strId, strStatus, divObject){this.Id=strId;this.Status=strStatus;this.DivObj=divObject;NearbyManagerElement.prototype.Render=function(){if(this.DivObj==null) return;with(this){switch(Status){case "open":DivObj.style.display="block";DivObj.className="accordion_selected";SetListDiv("block");break;case "closed":DivObj.style.display="block";DivObj.className="";SetListDiv("none");break;case "none":DivObj.style.display="none";DivObj.className="";SetListDiv("none");break;}}};NearbyManagerElement.prototype.SetListDiv=function(style){if(this.DivObj.getElementsByTagName("div")[0]){this.DivObj.getElementsByTagName("div")[0].style.display=style;}};}
function NearbyManager(initCity, initNeig) {this.ObjNeig=null;this.ObjCity=null;NearbyManager.prototype.Render=function(){this.ObjNeig.Render();this.ObjCity.Render();};NearbyManager.prototype.Control=function(eleId) {with (this) {switch (eleId) {case "city":if(ObjNeig.Status=="open") {GetNearestRegions('cities');ObjNeig.Status="closed";ObjCity.Status="open";$('#location').addClass('expand');Render();break;}
if(ObjCity.Status=="closed") {GetNearestRegions('cities');ObjCity.Status="open";$('#location').addClass('expand');Render();break;}
if(ObjCity.Status=="open") {ObjCity.Status="closed";$('#location').removeClass('expand');$("#nearestcities #result_wrapper").html("&nbsp;");Render();break;}
break;case "neig":if(ObjCity.Status=="open") {GetNearestRegions('neighborhoods');ObjNeig.Status="open";ObjCity.Status="closed";$('#location').addClass('expand');Render();break;}
if(ObjNeig.Status=="closed") {GetNearestRegions('neighborhoods');ObjNeig.Status="open";$('#location').addClass('expand');Render();break;}
if(ObjNeig.Status=="open") {ObjNeig.Status="closed";$('#location').removeClass('expand');$("#nearestneighborhoods #result_wrapper_n").html("&nbsp;");Render();break;}
break;}}};NearbyManager.prototype.NextLoad=function(statusCity, statusNeig){this.ObjCity.Status=statusCity;this.ObjNeig.Status=statusNeig;this.Render();};NearbyManager.prototype.Init=function(initCity, initNeig) {this.ObjCity=new NearbyManagerElement("city", initCity, gE("nearestcities"));this.ObjNeig=new NearbyManagerElement("neig", initNeig, gE("nearestneighborhoods"));this.Render();};this.Init(initCity, initNeig);}
function GetNearestRegions(RegionType){var level=3;if(RegionType=='neighborhoods'){level=4;}
var query="";if(PageCache.QueryString!=undefined){query=PageCache.QueryString;}
$(function() {$.ajax({type: "POST",url: "/controls/AjaxCalls/GetNearestRegions.aspx?"+query+"&lvl="+level,data: "",success: function(output) {if(level==3){$("#nearestcities #result_wrapper").show();$("#nearestcities #result_wrapper").html(output);}else{$("#nearestneighborhoods #result_wrapper_n").show();$("#nearestneighborhoods #result_wrapper_n").html(output);}}});});};var swfobject=function() {var UNDEF="undefined",OBJECT="object",SHOCKWAVE_FLASH="Shockwave Flash",SHOCKWAVE_FLASH_AX="ShockwaveFlash.ShockwaveFlash",FLASH_MIME_TYPE="application/x-shockwave-flash",EXPRESS_INSTALL_ID="SWFObjectExprInst",win=window,doc=document,nav=navigator,domLoadFnArr=[],regObjArr=[],objIdArr=[],listenersArr=[],script,timer=null,storedAltContent=null,storedAltContentId=null,isDomLoaded=false,isExpressInstallActive=false,noPlayerMessage='For the best website experience please<a href="http://www.adobe.com/go/getflashplayer">install Adobe Flash Player</a>version 9 or higher.';var ua=function() {var w3cdom=typeof doc.getElementById!=UNDEF && typeof doc.getElementsByTagName!=UNDEF && typeof doc.createElement!=UNDEF,playerVersion=[0,0,0],d=null;if(typeof nav.plugins!=UNDEF && typeof nav.plugins[SHOCKWAVE_FLASH]==OBJECT) {d=nav.plugins[SHOCKWAVE_FLASH].description;if(d && !(typeof nav.mimeTypes!=UNDEF && nav.mimeTypes[FLASH_MIME_TYPE] && !nav.mimeTypes[FLASH_MIME_TYPE].enabledPlugin)) {d=d.replace(/^.*\s+(\S+\s+\S+$)/, "$1");playerVersion[0]=parseInt(d.replace(/^(.*)\..*$/, "$1"), 10);playerVersion[1]=parseInt(d.replace(/^.*\.(.*)\s.*$/, "$1"), 10);playerVersion[2]=/r/.test(d) ? parseInt(d.replace(/^.*r(.*)$/, "$1"), 10) : 0;}}
else if(typeof win.ActiveXObject!=UNDEF) {var a=null, fp6Crash=false;try {a=new ActiveXObject(SHOCKWAVE_FLASH_AX+".7");}
catch(e) {try {a=new ActiveXObject(SHOCKWAVE_FLASH_AX+".6");playerVersion=[6,0,21];a.AllowScriptAccess="always";}
catch(e) {if(playerVersion[0]==6) {fp6Crash=true;}}
if(!fp6Crash) {try {a=new ActiveXObject(SHOCKWAVE_FLASH_AX);}
catch(e) {}}}
if(!fp6Crash && a) {try {d=a.GetVariable("$version");if(d) {d=d.split(" ")[1].split(",");playerVersion=[parseInt(d[0], 10), parseInt(d[1], 10), parseInt(d[2], 10)];}}
catch(e) {}}}
var u=nav.userAgent.toLowerCase(),p=nav.platform.toLowerCase(),webkit=/webkit/.test(u) ? parseFloat(u.replace(/^.*webkit\/(\d+(\.\d+)?).*$/, "$1")) : false,ie=/msie/.test(u) && !/opera/.test(u),windows=p ? /win/.test(p) : /win/.test(u),mac=p ? /mac/.test(p) : /mac/.test(u);return { w3cdom:w3cdom, pv:playerVersion, webkit:webkit, ie:ie, win:windows, mac:mac };}();var onDomLoad=function() {if(!ua.w3cdom) {return;}
addDomLoadEvent(main);if(ua.ie && ua.win) {try {doc.write("<scr"+"ipt id=__ie_ondomload defer=true src=//:></scr"+"ipt>");script=getElementById("__ie_ondomload");if(script) {addListener(script, "onreadystatechange", checkReadyState);}}
catch(e) {}}
if(ua.webkit && typeof doc.readyState!=UNDEF) {timer=setInterval(function() { if(/loaded|complete/.test(doc.readyState)) { callDomLoadFunctions(); }}, 10);}
if(typeof doc.addEventListener!=UNDEF) {doc.addEventListener("DOMContentLoaded", callDomLoadFunctions, null);}
addLoadEvent(callDomLoadFunctions);}();function checkReadyState() {if(script.readyState=="complete") {script.parentNode.removeChild(script);callDomLoadFunctions();}}
function callDomLoadFunctions() {if(isDomLoaded) {return;}
if(ua.ie && ua.win) {var s=createElement("span");try {var t=doc.getElementsByTagName("body")[0].appendChild(s);t.parentNode.removeChild(t);}
catch (e) {return;}}
isDomLoaded=true;if(timer) {clearInterval(timer);timer=null;}
var dl=domLoadFnArr.length;for (var i=0; i<dl; i++) {domLoadFnArr[i]();}}
function addDomLoadEvent(fn) {if(isDomLoaded) {fn();}else{domLoadFnArr[domLoadFnArr.length]=fn;}}
function addLoadEvent(fn) {if(typeof win.addEventListener!=UNDEF) {win.addEventListener("load", fn, false);}
else if(typeof doc.addEventListener!=UNDEF) {doc.addEventListener("load", fn, false);}
else if(typeof win.attachEvent!=UNDEF) {addListener(win, "onload", fn);}
else if(typeof win.onload=="function") {var fnOld=win.onload;win.onload=function() {fnOld();fn();};}else{win.onload=fn;}}
function main() {var rl=regObjArr.length;for (var i=0; i<rl; i++) {var id=regObjArr[i].id;if(ua.pv[0]>0) {var obj=getElementById(id);if(obj) {regObjArr[i].width=obj.getAttribute("width") ? obj.getAttribute("width") : "0";regObjArr[i].height=obj.getAttribute("height") ? obj.getAttribute("height") : "0";if(hasPlayerVersion(regObjArr[i].swfVersion)) {if(ua.webkit && ua.webkit<312) {fixParams(obj);}
setVisibility(id, true);}
else if(regObjArr[i].expressInstall && !isExpressInstallActive && hasPlayerVersion("6.0.65") && (ua.win||ua.mac)) {showExpressInstall(regObjArr[i]);}else{displayAltContent(obj);}}}else{setVisibility(id, true);}}}
function fixParams(obj) {var nestedObj=obj.getElementsByTagName(OBJECT)[0];if(nestedObj) {var e=createElement("embed"), a=nestedObj.attributes;if(a) {var al=a.length;for (var i=0; i<al; i++) {if(a[i].nodeName=="DATA") {e.setAttribute("src", a[i].nodeValue);}else{e.setAttribute(a[i].nodeName, a[i].nodeValue);}}}
var c=nestedObj.childNodes;if(c) {var cl=c.length;for (var j=0; j<cl; j++) {if(c[j].nodeType==1 && c[j].nodeName=="PARAM") {e.setAttribute(c[j].getAttribute("name"), c[j].getAttribute("value"));}}}
obj.parentNode.replaceChild(e, obj);}}
function showExpressInstall(regObj) {isExpressInstallActive=true;var obj=getElementById(regObj.id);if(obj) {if(regObj.altContentId) {var ac=getElementById(regObj.altContentId);if(ac) {storedAltContent=ac;storedAltContentId=regObj.altContentId;}}else{storedAltContent=abstractAltContent(obj);}
if(!(/%$/.test(regObj.width)) && parseInt(regObj.width, 10)<310) {regObj.width="310";}
if(!(/%$/.test(regObj.height)) && parseInt(regObj.height, 10)<137) {regObj.height="137";}
doc.title=doc.title.slice(0, 47)+" - Flash Player Installation";var pt=ua.ie && ua.win ? "ActiveX" : "PlugIn",dt=doc.title,fv="MMredirectURL="+win.location+"&MMplayerType="+pt+"&MMdoctitle="+dt,replaceId=regObj.id;if(ua.ie && ua.win && obj.readyState!=4) {var newObj=createElement("div");replaceId+="SWFObjectNew";newObj.setAttribute("id", replaceId);obj.parentNode.insertBefore(newObj, obj);obj.style.display="none";var fn=function() {obj.parentNode.removeChild(obj);};addListener(win, "onload", fn);}
createSWF({ data:regObj.expressInstall, id:EXPRESS_INSTALL_ID, width:regObj.width, height:regObj.height }, { flashvars:fv }, replaceId);}}
function showNoPlayerMessage(regObj) {var obj=getElementById(regObj.id);if(obj) {obj.style.width=regObj.width+"px";obj.style.height=regObj.height+"px";var newObj=createElement("div");newObj.className="no-player-installed";newObj.innerHTML=noPlayerMessage;obj.appendChild(newObj);}}
function displayAltContent(obj) {if(ua.ie && ua.win && obj.readyState!=4) {var el=createElement("div");obj.parentNode.insertBefore(el, obj);el.parentNode.replaceChild(abstractAltContent(obj), el);obj.style.display="none";var fn=function() {obj.parentNode.removeChild(obj);};addListener(win, "onload", fn);}else{obj.parentNode.replaceChild(abstractAltContent(obj), obj);}}
function abstractAltContent(obj) {var ac=createElement("div");if(ua.win && ua.ie) {ac.innerHTML=obj.innerHTML;}else{var nestedObj=obj.getElementsByTagName(OBJECT)[0];if(nestedObj) {var c=nestedObj.childNodes;if(c) {var cl=c.length;for (var i=0; i<cl; i++) {if(!(c[i].nodeType==1 && c[i].nodeName=="PARAM") && !(c[i].nodeType==8)) {ac.appendChild(c[i].cloneNode(true));}}}}}
return ac;}
function createSWF(attObj, parObj, id) {var r, el=getElementById(id);if(el) {if(typeof attObj.id==UNDEF) {attObj.id=id;}
if(ua.ie && ua.win) {var att="";for (var i in attObj) {if(attObj[i]!=Object.prototype[i]) {if(i.toLowerCase()=="data") {parObj.movie=attObj[i];}
else if(i.toLowerCase()=="styleclass") {att+=' class="'+attObj[i]+'"';}
else if(i.toLowerCase()!="classid") {att+=' '+i+'="'+attObj[i]+'"';}}}
var par="";for (var j in parObj) {if(parObj[j]!=Object.prototype[j]) {par+='<param name="'+j+'" value="'+parObj[j]+'" />';}}
el.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+att+'>'+par+'</object>';objIdArr[objIdArr.length]=attObj.id;r=getElementById(attObj.id);}
else if(ua.webkit && ua.webkit<312) {var e=createElement("embed");e.setAttribute("type", FLASH_MIME_TYPE);for (var k in attObj) {if(attObj[k]!=Object.prototype[k]) {if(k.toLowerCase()=="data") {e.setAttribute("src", attObj[k]);}
else if(k.toLowerCase()=="styleclass") {e.setAttribute("class", attObj[k]);}
else if(k.toLowerCase()!="classid") {e.setAttribute(k, attObj[k]);}}}
for (var l in parObj) {if(parObj[l]!=Object.prototype[l]) {if(l.toLowerCase()!="movie") {e.setAttribute(l, parObj[l]);}}}
el.parentNode.replaceChild(e, el);r=e;}else{var o=createElement(OBJECT);o.setAttribute("type", FLASH_MIME_TYPE);for (var m in attObj) {if(attObj[m]!=Object.prototype[m]) {if(m.toLowerCase()=="styleclass") {o.setAttribute("class", attObj[m]);}
else if(m.toLowerCase()!="classid") {o.setAttribute(m, attObj[m]);}}}
for (var n in parObj) {if(parObj[n]!=Object.prototype[n] && n.toLowerCase()!="movie") {createObjParam(o, n, parObj[n]);}}
el.parentNode.replaceChild(o, el);r=o;}}
return r;}
function createObjParam(el, pName, pValue) {var p=createElement("param");p.setAttribute("name", pName);p.setAttribute("value", pValue);el.appendChild(p);}
function removeSWF(id) {var obj=getElementById(id);if(obj && (obj.nodeName=="OBJECT"||obj.nodeName=="EMBED")) {if(ua.ie && ua.win) {if(obj.readyState==4) {removeObjectInIE(id);}else{win.attachEvent("onload", function() {removeObjectInIE(id);});}}else{obj.parentNode.removeChild(obj);}}}
function removeObjectInIE(id) {var obj=getElementById(id);if(obj) {for (var i in obj) {if(typeof obj[i]=="function") {obj[i]=null;}}
obj.parentNode.removeChild(obj);}}
function getElementById(id) {var el=null;try {el=doc.getElementById(id);}
catch (e) {}
return el;}
function createElement(el) {return doc.createElement(el);}
function addListener(target, eventType, fn) {target.attachEvent(eventType, fn);listenersArr[listenersArr.length]=[target, eventType, fn];}
function hasPlayerVersion(rv) {var pv=ua.pv, v=rv.split(".");v[0]=parseInt(v[0], 10);v[1]=parseInt(v[1], 10)||0;v[2]=parseInt(v[2], 10)||0;return (pv[0]>v[0]||(pv[0]==v[0] && pv[1]>v[1])||(pv[0]==v[0] && pv[1]==v[1] && pv[2]>=v[2])) ? true : false;}
function createCSS(sel, decl) {if(ua.ie && ua.mac) {return;}
var h=doc.getElementsByTagName("head")[0], s=createElement("style");s.setAttribute("type", "text/css");s.setAttribute("media", "screen");if(!(ua.ie && ua.win) && typeof doc.createTextNode!=UNDEF) {s.appendChild(doc.createTextNode(sel+" {"+decl+"}"));}
h.appendChild(s);if(ua.ie && ua.win && typeof doc.styleSheets!=UNDEF && doc.styleSheets.length>0) {var ls=doc.styleSheets[doc.styleSheets.length - 1];if(typeof ls.addRule==OBJECT) {ls.addRule(sel, decl);}}}
function setVisibility(id, isVisible) {var v=isVisible ? "visible" : "hidden";if(isDomLoaded && getElementById(id)) {getElementById(id).style.visibility=v;}else{createCSS("#"+id, "visibility:"+v);}}
function urlEncodeIfNecessary(s) {var regex=/[\\\"<>\.;]/;var hasBadChars=regex.exec(s)!=null;return hasBadChars ? encodeURIComponent(s) : s;}
var cleanup=function() {if(ua.ie && ua.win) {window.attachEvent("onunload", function() {var ll=listenersArr.length;for (var i=0; i<ll; i++) {listenersArr[i][0].detachEvent(listenersArr[i][1], listenersArr[i][2]);}
var il=objIdArr.length;for (var j=0; j<il; j++) {removeSWF(objIdArr[j]);}
for (var k in ua) {ua[k]=null;}
ua=null;for (var l in swfobject) {swfobject[l]=null;}
swfobject=null;});}}();return {registerObject: function(objectIdStr, swfVersionStr, xiSwfUrlStr) {if(!ua.w3cdom||!objectIdStr||!swfVersionStr) {return;}
var regObj={};regObj.id=objectIdStr;regObj.swfVersion=swfVersionStr;regObj.expressInstall=xiSwfUrlStr ? xiSwfUrlStr : false;regObjArr[regObjArr.length]=regObj;setVisibility(objectIdStr, false);},getObjectById: function(objectIdStr) {var r=null;if(ua.w3cdom) {var o=getElementById(objectIdStr);if(o) {var n=o.getElementsByTagName(OBJECT)[0];if(!n||(n && typeof o.SetVariable!=UNDEF)) {r=o;}
else if(typeof n.SetVariable!=UNDEF) {r=n;}}}
return r;},embedSWF: function(swfUrlStr, replaceElemIdStr, widthStr, heightStr, swfVersionStr, xiSwfUrlStr, flashvarsObj, parObj, attObj) {if(!ua.w3cdom||!swfUrlStr||!replaceElemIdStr||!widthStr||!heightStr||!swfVersionStr) {return;}
widthStr+="";heightStr+="";if(hasPlayerVersion(swfVersionStr)) {setVisibility(replaceElemIdStr, false);var att={};if(attObj && typeof attObj===OBJECT) {for (var i in attObj) {if(attObj[i]!=Object.prototype[i]) {att[i]=attObj[i];}}}
att.data=swfUrlStr;att.width=widthStr;att.height=heightStr;var par={};if(parObj && typeof parObj===OBJECT) {for (var j in parObj) {if(parObj[j]!=Object.prototype[j]) {par[j]=parObj[j];}}}
if(flashvarsObj && typeof flashvarsObj===OBJECT) {for (var k in flashvarsObj) {if(flashvarsObj[k]!=Object.prototype[k]) {if(typeof par.flashvars!=UNDEF) {par.flashvars+="&"+k+"="+flashvarsObj[k];}else{par.flashvars=k+"="+flashvarsObj[k];}}}}
addDomLoadEvent(function() {createSWF(att, par, replaceElemIdStr);if(att.id==replaceElemIdStr) {setVisibility(replaceElemIdStr, true);}});}
else if(xiSwfUrlStr && !isExpressInstallActive && hasPlayerVersion("6.0.65") && (ua.win||ua.mac)) {isExpressInstallActive=true;setVisibility(replaceElemIdStr, false);addDomLoadEvent(function() {var regObj={};regObj.id=regObj.altContentId=replaceElemIdStr;regObj.width=widthStr;regObj.height=heightStr;regObj.expressInstall=xiSwfUrlStr;showExpressInstall(regObj);});}else{addDomLoadEvent(function() {var regObj={};regObj.id=regObj.altContentId=replaceElemIdStr;regObj.width=widthStr;regObj.height=heightStr;showNoPlayerMessage(regObj);});}},getFlashPlayerVersion: function() {return { major:ua.pv[0], minor:ua.pv[1], release:ua.pv[2] };},hasFlashPlayerVersion: hasPlayerVersion,createSWF: function(attObj, parObj, replaceElemIdStr) {if(ua.w3cdom) {return createSWF(attObj, parObj, replaceElemIdStr);}else{return undefined;}},removeSWF: function(objElemIdStr) {if(ua.w3cdom) {removeSWF(objElemIdStr);}},createCSS: function(sel, decl) {if(ua.w3cdom) {createCSS(sel, decl);}},addDomLoadEvent: addDomLoadEvent,addLoadEvent: addLoadEvent,getQueryParamValue: function(param) {var q=doc.location.search||doc.location.hash;if(param==null) {return urlEncodeIfNecessary(q);}
if(q) {var pairs=q.substring(1).split("&");for (var i=0; i<pairs.length; i++) {if(pairs[i].substring(0, pairs[i].indexOf("="))==param) {return urlEncodeIfNecessary(pairs[i].substring((pairs[i].indexOf("=")+1)));}}}
return "";},expressInstallCallback: function() {if(isExpressInstallActive && storedAltContent) {var obj=getElementById(EXPRESS_INSTALL_ID);if(obj) {obj.parentNode.replaceChild(storedAltContent, obj);if(storedAltContentId) {setVisibility(storedAltContentId, true);if(ua.ie && ua.win) {storedAltContent.style.display="block";}}
storedAltContent=null;storedAltContentId=null;isExpressInstallActive=false;}}}};}();;function Sarissa(){};var arrMXXMLWriters=["Msxml2.MXXMLWriter.3.0", "Msxml2.MXXMLWriter.6.0", "MSXML2.MXXMLWriter", "MSXML.MXXMLWriter", "Microsoft.XMLDOM"];var arrXMLHTTPs=["MSXML2.XMLHTTP.3.0", "Msxml2.XMLHTTP.6.0", "MSXML2.XMLHTTP", "Microsoft.XMLHTTP"];var arrDOMDocuments=["Msxml2.DOMDocument.3.0", "Msxml2.DOMDocument.6.0", "MSXML2.DOMDocument", "MSXML.DOMDocument", "Microsoft.XMLDOM"];var arrXSLTemplates=["MSXML2.XSLTemplate.3.0", "Msxml2.XSLTemplate.6.0"];var arrFreeThreads=["MSXML2.FreeThreadedDOMDocument.3.0", "MSXML2.FreeThreadedDOMDocument.6.0"];Sarissa.VERSION="${project.version}";Sarissa.PARSED_OK="Document contains no parsing errors";Sarissa.PARSED_EMPTY="Document is empty";Sarissa.PARSED_UNKNOWN_ERROR="Not well-formed or other error";Sarissa.IS_ENABLED_TRANSFORM_NODE=false;var _sarissa_iNsCounter=0;var _SARISSA_IEPREFIX4XSLPARAM="";var _SARISSA_HAS_DOM_IMPLEMENTATION=document.implementation && true;var _SARISSA_HAS_DOM_CREATE_DOCUMENT=_SARISSA_HAS_DOM_IMPLEMENTATION && document.implementation.createDocument;var _SARISSA_HAS_DOM_FEATURE=_SARISSA_HAS_DOM_IMPLEMENTATION && document.implementation.hasFeature;var _SARISSA_IS_MOZ=_SARISSA_HAS_DOM_CREATE_DOCUMENT && _SARISSA_HAS_DOM_FEATURE;var _SARISSA_IS_SAFARI=navigator.userAgent.toLowerCase().indexOf("safari")!=-1||navigator.userAgent.toLowerCase().indexOf("konqueror")!=-1;var _SARISSA_IS_SAFARI_OLD=_SARISSA_IS_SAFARI && parseInt((navigator.userAgent.match(/AppleWebKit\/(\d+)/)||{})[1])<420;var _SARISSA_IS_IE=document.all && window.ActiveXObject && navigator.userAgent.toLowerCase().indexOf("msie")>-1  && navigator.userAgent.toLowerCase().indexOf("opera")==-1;var _SARISSA_IS_IE9=_SARISSA_IS_IE && (parseFloat(navigator.appVersion.substring(navigator.appVersion.indexOf("MSIE")+5)))>=9;var _SARISSA_IS_OPERA=navigator.userAgent.toLowerCase().indexOf("opera")!=-1;if(!window.Node||!Node.ELEMENT_NODE){Node={ELEMENT_NODE: 1, ATTRIBUTE_NODE: 2, TEXT_NODE: 3, CDATA_SECTION_NODE: 4, ENTITY_REFERENCE_NODE: 5,  ENTITY_NODE: 6, PROCESSING_INSTRUCTION_NODE: 7, COMMENT_NODE: 8, DOCUMENT_NODE: 9, DOCUMENT_TYPE_NODE: 10, DOCUMENT_FRAGMENT_NODE: 11, NOTATION_NODE: 12};};if(_SARISSA_IS_SAFARI_OLD){HTMLHtmlElement=document.createElement("html").constructor;Node=HTMLElement={};HTMLElement.prototype=HTMLHtmlElement.__proto__.__proto__;HTMLDocument=Document=document.constructor;var x=new DOMParser();XMLDocument=x.constructor;Element=x.parseFromString("<Single />", "text/xml").documentElement.constructor;x=null;}
if(typeof XMLDocument=="undefined" && typeof Document!="undefined"){ XMLDocument=Document; }
if(_SARISSA_IS_IE){_SARISSA_IEPREFIX4XSLPARAM="xsl:";var _SARISSA_DOM_PROGID="";var _SARISSA_XMLHTTP_PROGID="";var _SARISSA_DOM_XMLWRITER="";Sarissa.pickRecentProgID=function (idList){var bFound=false, e;for(var i=0; i<idList.length && !bFound; i++){try{var oDoc=new ActiveXObject(idList[i]);var o2Store=idList[i];bFound=true;}catch (objException){e=objException;};};if(!bFound) {throw "Could not retrieve a valid progID of Class: "+idList[idList.length-1]+". (original exception: "+e+")";};idList=null;return o2Store;};_SARISSA_DOM_PROGID=null;_SARISSA_THREADEDDOM_PROGID=null;_SARISSA_XSLTEMPLATE_PROGID=null;_SARISSA_XMLHTTP_PROGID=null;if(!window.XMLHttpRequest){XMLHttpRequest=function() {if(!_SARISSA_XMLHTTP_PROGID){_SARISSA_XMLHTTP_PROGID=Sarissa.pickRecentProgID(arrXMLHTTPs);};return new ActiveXObject(_SARISSA_XMLHTTP_PROGID);};};Sarissa.getDomDocument=function(sUri, sName){if(!_SARISSA_DOM_PROGID){_SARISSA_DOM_PROGID=Sarissa.pickRecentProgID(arrDOMDocuments);};var oDoc=new ActiveXObject(_SARISSA_DOM_PROGID);if(sName){var prefix="";if(sUri){if(sName.indexOf(":")>1){prefix=sName.substring(0, sName.indexOf(":"));sName=sName.substring(sName.indexOf(":")+1);}else{prefix="a"+(_sarissa_iNsCounter++);};};if(sUri){oDoc.loadXML('<'+prefix+':'+sName+" xmlns:"+prefix+"=\""+sUri+"\""+" />");}else{oDoc.loadXML('<'+sName+" />");};};return oDoc;};Sarissa.getParseErrorText=function (oDoc) {var parseErrorText=Sarissa.PARSED_OK;if(oDoc && oDoc.parseError && oDoc.parseError.errorCode && oDoc.parseError.errorCode!=0){parseErrorText="XML Parsing Error: "+oDoc.parseError.reason+"\nLocation: "+oDoc.parseError.url+"\nLine Number "+oDoc.parseError.line+", Column "+oDoc.parseError.linepos+":\n"+oDoc.parseError.srcText+"\n";for(var i=0;  i<oDoc.parseError.linepos;i++){parseErrorText+="-";};parseErrorText+="^\n";}
else if(oDoc.documentElement==null){parseErrorText=Sarissa.PARSED_EMPTY;};return parseErrorText;};Sarissa.setXpathNamespaces=function(oDoc, sNsSet) {oDoc.setProperty("SelectionLanguage", "XPath");oDoc.setProperty("SelectionNamespaces", sNsSet);};XSLTProcessor=function(){if(!_SARISSA_XSLTEMPLATE_PROGID){_SARISSA_XSLTEMPLATE_PROGID=Sarissa.pickRecentProgID(arrXSLTemplates);};this.template=new ActiveXObject(_SARISSA_XSLTEMPLATE_PROGID);this.processor=null;};XSLTProcessor.prototype.importStylesheet=function(xslDoc){if(!_SARISSA_THREADEDDOM_PROGID){_SARISSA_THREADEDDOM_PROGID=Sarissa.pickRecentProgID(arrFreeThreads);};xslDoc.setProperty("SelectionLanguage", "XPath");xslDoc.setProperty("SelectionNamespaces", "xmlns:xsl='http://www.w3.org/1999/XSL/Transform'");var converted=new ActiveXObject(_SARISSA_THREADEDDOM_PROGID);try{converted.resolveExternals=true;converted.setProperty("AllowDocumentFunction", true);}
catch(e){};if(xslDoc.url && xslDoc.selectSingleNode("//xsl:*[local-name()='import' or local-name()='include']")!=null){converted.async=false;converted.load(xslDoc.url);}else{converted.loadXML(xslDoc.xml);};converted.setProperty("SelectionNamespaces", "xmlns:xsl='http://www.w3.org/1999/XSL/Transform'");var output=converted.selectSingleNode("//xsl:output");this.outputMethod=output ? output.getAttribute("method") : "html";this.template.stylesheet=converted;this.processor=this.template.createProcessor();this.paramsSet=[];};XSLTProcessor.prototype.transformToDocument=function(sourceDoc){if(_SARISSA_THREADEDDOM_PROGID){this.processor.input=sourceDoc;var outDoc=new ActiveXObject(_SARISSA_DOM_PROGID);this.processor.output=outDoc;this.processor.transform();return outDoc;}
else{if(!_SARISSA_DOM_XMLWRITER){_SARISSA_DOM_XMLWRITER=Sarissa.pickRecentProgID(arrMXXMLWriters);};this.processor.input=sourceDoc;var outDoc=new ActiveXObject(_SARISSA_DOM_XMLWRITER);this.processor.output=outDoc;this.processor.transform();var oDoc=new ActiveXObject(_SARISSA_DOM_PROGID);oDoc.loadXML(outDoc.output+"");return oDoc;};};XSLTProcessor.prototype.transformToFragment=function (sourceDoc, ownerDoc) {this.processor.input=sourceDoc;this.processor.transform();var s=this.processor.output;var f=ownerDoc.createDocumentFragment();if(this.outputMethod=='text') {f.appendChild(ownerDoc.createTextNode(s));} else if(ownerDoc.body && ownerDoc.body.innerHTML) {var container=ownerDoc.createElement('div');container.innerHTML=s;while (container.hasChildNodes()) {f.appendChild(container.firstChild);}}else{var oDoc=new ActiveXObject(_SARISSA_DOM_PROGID);if(s.substring(0, 5)=='<?xml') {s=s.substring(s.indexOf('?>')+2);}
var xml=''.concat('<my>', s, '</my>');oDoc.loadXML(xml);var container=oDoc.documentElement;while (container.hasChildNodes()) {f.appendChild(container.firstChild);}}
return f;};XSLTProcessor.prototype.setParameter=function(nsURI, name, value) {value=value ? value : "";if(nsURI){this.processor.addParameter(name, value, nsURI);}else{this.processor.addParameter(name, value);};nsURI=""+(nsURI||"");if(!this.paramsSet[nsURI]){this.paramsSet[nsURI]=new Array();};this.paramsSet[nsURI][name]=value;};XSLTProcessor.prototype.getParameter=function(nsURI, name){nsURI=""+(nsURI||"");if(this.paramsSet[nsURI] && this.paramsSet[nsURI][name]){return this.paramsSet[nsURI][name];}else{return null;};};XSLTProcessor.prototype.clearParameters=function(){for(var nsURI in this.paramsSet){for(var name in this.paramsSet[nsURI]){if(nsURI!=""){this.processor.addParameter(name, "", nsURI);}else{this.processor.addParameter(name, "");};};};this.paramsSet=new Array();};}
else{if(_SARISSA_HAS_DOM_CREATE_DOCUMENT){Sarissa.__handleLoad__=function(oDoc){Sarissa.__setReadyState__(oDoc, 4);};_sarissa_XMLDocument_onload=function(){Sarissa.__handleLoad__(this);};Sarissa.__setReadyState__=function(oDoc, iReadyState){oDoc.readyState=iReadyState;oDoc.readystate=iReadyState;if(oDoc.onreadystatechange!=null && typeof oDoc.onreadystatechange=="function") {oDoc.onreadystatechange();}};Sarissa.getDomDocument=function(sUri, sName){var oDoc=document.implementation.createDocument(sUri?sUri:null, sName?sName:null, null);if(!oDoc.onreadystatechange){oDoc.onreadystatechange=null;};if(!oDoc.readyState){oDoc.readyState=0;};oDoc.addEventListener("load", _sarissa_XMLDocument_onload, false);return oDoc;};if(window.XMLDocument){}
else if(_SARISSA_HAS_DOM_FEATURE && window.Document && !Document.prototype.load && document.implementation.hasFeature('LS', '3.0')){Sarissa.getDomDocument=function(sUri, sName){var oDoc=document.implementation.createDocument(sUri?sUri:null, sName?sName:null, null);return oDoc;};}else{Sarissa.getDomDocument=function(sUri, sName){var oDoc=document.implementation.createDocument(sUri?sUri:null, sName?sName:null, null);if(oDoc && (sUri||sName) && !oDoc.documentElement){oDoc.appendChild(oDoc.createElementNS(sUri, sName));};return oDoc;};};};};if(!window.DOMParser){if(_SARISSA_IS_SAFARI||_SARISSA_IS_IE9){DOMParser=function() { };DOMParser.prototype.parseFromString=function(sXml, contentType){var xmlhttp=new XMLHttpRequest();xmlhttp.open("GET", "data:text/xml;charset=utf-8,"+encodeURIComponent(sXml), false);xmlhttp.send(null);return xmlhttp.responseXML;};}else if(Sarissa.getDomDocument && Sarissa.getDomDocument() && Sarissa.getDomDocument(null, "bar").xml){DOMParser=function() { };DOMParser.prototype.parseFromString=function(sXml, contentType){var doc=Sarissa.getDomDocument();doc.loadXML(sXml);return doc;};};};if((typeof(document.importNode)=="undefined") && _SARISSA_IS_IE && !_SARISSA_IS_IE9){try{document.importNode=function(oNode, bChildren){var tmp;if(oNode.nodeName=='#text') {return document.createTextElement(oNode.data);}else{if(oNode.nodeName=="tbody"||oNode.nodeName=="tr"){tmp=document.createElement("table");}
else if(oNode.nodeName=="td"){tmp=document.createElement("tr");}
else if(oNode.nodeName=="option"){tmp=document.createElement("select");}
else{tmp=document.createElement("div");};if(bChildren){tmp.innerHTML=oNode.xml ? oNode.xml : oNode.outerHTML;}else{tmp.innerHTML=oNode.xml ? oNode.cloneNode(false).xml : oNode.cloneNode(false).outerHTML;};return tmp.getElementsByTagName("*")[0];};};}catch(e){ };};if(!Sarissa.getParseErrorText){Sarissa.getParseErrorText=function (oDoc){var parseErrorText=Sarissa.PARSED_OK;if(!oDoc.documentElement){parseErrorText=Sarissa.PARSED_EMPTY;} else if(oDoc.documentElement.tagName=="parsererror"){parseErrorText=oDoc.documentElement.firstChild.data;parseErrorText+="\n"+oDoc.documentElement.firstChild.nextSibling.firstChild.data;} else if(oDoc.getElementsByTagName("parsererror").length>0){var parsererror=oDoc.getElementsByTagName("parsererror")[0];parseErrorText=Sarissa.getText(parsererror, true)+"\n";} else if(oDoc.parseError && oDoc.parseError.errorCode!=0){parseErrorText=Sarissa.PARSED_UNKNOWN_ERROR;};return parseErrorText;};};Sarissa.getText=function(oNode, deep){var s="";var nodes=oNode.childNodes;for(var i=0; i<nodes.length; i++){var node=nodes[i];var nodeType=node.nodeType;if(nodeType==Node.TEXT_NODE||nodeType==Node.CDATA_SECTION_NODE){s+=node.data;} else if(deep==true
&& (nodeType==Node.ELEMENT_NODE||nodeType==Node.DOCUMENT_NODE||nodeType==Node.DOCUMENT_FRAGMENT_NODE)){s+=Sarissa.getText(node, true);};};return s;};if((!window.XMLSerializer||_SARISSA_IS_IE9)
&& Sarissa.getDomDocument
&& Sarissa.getDomDocument("","foo", null).xml){XMLSerializer=function(){};XMLSerializer.prototype.serializeToString=function(oNode) {return oNode.xml;};};Sarissa.stripTags=function (s) {return s.replace(/<[^>]+>/g,"");};Sarissa.clearChildNodes=function(oNode) {if(oNode){while(oNode.firstChild) {oNode.removeChild(oNode.firstChild);};}};Sarissa.copyChildNodes=function(nodeFrom, nodeTo, bPreserveExisting) {if(_SARISSA_IS_SAFARI && nodeTo.nodeType==Node.DOCUMENT_NODE){nodeTo=nodeTo.documentElement;}
if((!nodeFrom)||(!nodeTo)){throw "Both source and destination nodes must be provided";};if(!bPreserveExisting){Sarissa.clearChildNodes(nodeTo);};var ownerDoc=nodeTo.nodeType==Node.DOCUMENT_NODE ? nodeTo : nodeTo.ownerDocument;var nodes=nodeFrom.childNodes;if(typeof(ownerDoc.importNode)!="undefined")  {for(var i=0;i<nodes.length;i++) {nodeTo.appendChild(ownerDoc.importNode(nodes[i], true));};}else{for(var i=0;i<nodes.length;i++) {nodeTo.appendChild(nodes[i].cloneNode(true));};};};Sarissa.moveChildNodes=function(nodeFrom, nodeTo, bPreserveExisting) {if((!nodeFrom)||(!nodeTo)){throw "Both source and destination nodes must be provided";};if(!bPreserveExisting){Sarissa.clearChildNodes(nodeTo);};var nodes=nodeFrom.childNodes;if(nodeFrom.ownerDocument==nodeTo.ownerDocument){while(nodeFrom.firstChild){nodeTo.appendChild(nodeFrom.firstChild);};}else{var ownerDoc=nodeTo.nodeType==Node.DOCUMENT_NODE ? nodeTo : nodeTo.ownerDocument;if(typeof(ownerDoc.importNode)!="undefined") {for(var i=0;i<nodes.length;i++) {nodeTo.appendChild(ownerDoc.importNode(nodes[i], true));};}else{for(var i=0;i<nodes.length;i++) {nodeTo.appendChild(nodes[i].cloneNode(true));};};Sarissa.clearChildNodes(nodeFrom);};};Sarissa.xmlize=function(anyObject, objectName, indentSpace){indentSpace=indentSpace?indentSpace:'';var s=indentSpace+'<'+objectName+'>';var isLeaf=false;if(!(anyObject instanceof Object)||anyObject instanceof Number||anyObject instanceof String||anyObject instanceof Boolean||anyObject instanceof Date){s+=Sarissa.escape(""+anyObject);isLeaf=true;}else{s+="\n";var isArrayItem=anyObject instanceof Array;for(var name in anyObject){s+=Sarissa.xmlize(anyObject[name], (isArrayItem?"array-item key=\""+name+"\"":name), indentSpace+"   ");};s+=indentSpace;};return (s+=(objectName.indexOf(' ')!=-1?"</array-item>\n":"</"+objectName+">\n"));};Sarissa.escape=function(sXml){return sXml.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&apos;");};Sarissa.unescape=function(sXml){return sXml.replace(/&apos;/g,"'").replace(/&#39;/,"'").replace(/&quot;/g,"\"").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&");};Sarissa.updateCursor=function(oTargetElement, sValue) {if(oTargetElement && oTargetElement.style && oTargetElement.style.cursor!=undefined){oTargetElement.style.cursor=sValue;};};Sarissa.updateContentFromURI=function(sFromUrl, oTargetElement, xsltproc, callback, skipCache) {try{Sarissa.updateCursor(oTargetElement, "wait");var xmlhttp=new XMLHttpRequest();xmlhttp.open("GET", sFromUrl, true);function sarissa_dhtml_loadHandler() {if(xmlhttp.readyState==4) {Sarissa.updateContentFromNode(xmlhttp.responseXML, oTargetElement, xsltproc, callback);};};xmlhttp.onreadystatechange=sarissa_dhtml_loadHandler;if(skipCache) {var oldage="Sat, 1 Jan 2000 00:00:00 GMT";xmlhttp.setRequestHeader("If-Modified-Since", oldage);};xmlhttp.send("");}
catch(e){Sarissa.updateCursor(oTargetElement, "auto");throw e;};};Sarissa.updateContentFromNode=function(oNode, oTargetElement, xsltproc, callback) {try {Sarissa.updateCursor(oTargetElement, "wait");Sarissa.clearChildNodes(oTargetElement);var ownerDoc=oNode.nodeType==Node.DOCUMENT_NODE?oNode:oNode.ownerDocument;if(ownerDoc.parseError && ownerDoc.parseError!=0) {var pre=document.createElement("pre");pre.appendChild(document.createTextNode(Sarissa.getParseErrorText(ownerDoc)));oTargetElement.appendChild(pre);}else{if(xsltproc) {oNode=xsltproc.transformToDocument(oNode);};if(oTargetElement) {if(oTargetElement.tagName.toLowerCase()=="textarea"||oTargetElement.tagName.toLowerCase()=="input") {oTargetElement.value=new XMLSerializer().serializeToString(oNode);}else{if(oNode.nodeType==Node.DOCUMENT_NODE||oNode.ownerDocument.documentElement==oNode) {oTargetElement.innerHTML=new XMLSerializer().serializeToString(oNode);}
else{oTargetElement.appendChild(oTargetElement.ownerDocument.importNode(oNode, true));};};}};if(callback) {callback(oNode, oTargetElement);};}
catch(e){}
finally{Sarissa.updateCursor(oTargetElement, "auto");};};if(!_SARISSA_IS_IE||_SARISSA_IS_IE9){if(_SARISSA_HAS_DOM_CREATE_DOCUMENT){Sarissa.__handleLoad__=function(oDoc){Sarissa.__setReadyState__(oDoc, 4);};function SarissaParseError() {this.errorCode=0;};_sarissa_XMLDocument_onload=function(){Sarissa.__handleLoad__(this);};Sarissa.__setReadyState__=function(oDoc, iReadyState){oDoc.readyState=iReadyState;oDoc.readystate=iReadyState;if(oDoc.onreadystatechange!=null && typeof oDoc.onreadystatechange=="function")
oDoc.onreadystatechange();};Sarissa.getDomDocument=function(sUri, sName){var oDoc=document.implementation.createDocument(sUri?sUri:null, sName?sName:null, null);if(!oDoc.onreadystatechange){oDoc.onreadystatechange=null;};if(!oDoc.readyState){oDoc.readyState=0;};if(!oDoc.parseError){oDoc.parseError=new SarissaParseError();};oDoc.addEventListener("load", _sarissa_XMLDocument_onload, false);return oDoc;};if(window.XMLDocument){XMLDocument.prototype._sarissa_load=XMLDocument.prototype.load;XMLDocument.prototype.load=function(sURI) {var oDoc=Sarissa.getDomDocument();Sarissa.copyChildNodes(this, oDoc);this.parseError.errorCode=0;Sarissa.__setReadyState__(this, 1);try {if(this.async==false && _SARISSA_SYNC_NON_IMPLEMENTED) {var tmp=new XMLHttpRequest();tmp.open("GET", sURI, false);tmp.send(null);Sarissa.__setReadyState__(this, 2);Sarissa.copyChildNodes(tmp.responseXML, this);Sarissa.__setReadyState__(this, 3);}else{this._sarissa_load(sURI);};}
catch (objException) {oDoc.parseError.errorCode=-1;}
finally {if(!oDoc.documentElement||oDoc.documentElement.tagName=="parsererror"){oDoc.parseError.errorCode=-1;};if(this.async==false){Sarissa.__handleLoad__(this);};};return oDoc;};}
else if(document.implementation && document.implementation.hasFeature && document.implementation.hasFeature('LS', '3.0')){Document.prototype.async=true;Document.prototype.onreadystatechange=null;Document.prototype.load=function(sURI) {var oldDoc=Sarissa.getDomDocument();Sarissa.copyChildNodes(this, oldDoc, false);var parser=document.implementation.createLSParser(this.async ? document.implementation.MODE_ASYNCHRONOUS : document.implementation.MODE_SYNCHRONOUS, null);if(this.async){var self=this;parser.addEventListener("load",function(e) {self.readyState=4;Sarissa.copyChildNodes(e.newDocument, self, false);self.onreadystatechange.call();},false);};try {var oDoc=parser.parseURI(sURI);if(!this.async) {Sarissa.copyChildNodes(oDoc, this, false);};}
catch(e){this.parseError.errorCode=-1;};return oldDoc;};Sarissa.getDomDocument=function(sUri, sName){var oDoc=document.implementation.createDocument(sUri?sUri:null, sName?sName:null, null);if(!oDoc.parseError){oDoc.parseError={errorCode:0};};return oDoc;};}else{Sarissa.getDomDocument=function(sUri, sName){var oDoc=document.implementation.createDocument(sUri?sUri:null, sName?sName:null, null);if(oDoc && (sUri||sName) && !oDoc.documentElement){oDoc.appendChild(oDoc.createElementNS(sUri, sName));};if(!oDoc.load) {oDoc.load=function(sUrl) {var oldDoc=document.implementation.createDocument();Sarissa.copyChildNodes(this, oldDoc);this.parseError={errorCode : 0};Sarissa.__setReadyState__(this, 1);if(this.async==false) {var tmp=new XMLHttpRequest();tmp.open("GET", sUrl, false);tmp.send(null);Sarissa.__setReadyState__(this, 2);Sarissa.copyChildNodes(tmp.responseXML, oDoc);if(!oDoc.documentElement||oDoc.getElementsByTagName("parsererror").length>0){oDoc.parseError.errorCode=-1;};Sarissa.__setReadyState__(this, 3);Sarissa.__setReadyState__(this, 4);}else{var xmlhttp=new XMLHttpRequest();xmlhttp.open('GET', sUrl, true);xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4) {Sarissa.copyChildNodes(xmlhttp.responseXML, oDoc);if(!oDoc.documentElement||oDoc.getElementsByTagName("parsererror").length>0){oDoc.parseError.errorCode=-1;};};Sarissa.__setReadyState__(oDoc, xmlhttp.readyState);};xmlhttp.send(null);};return oldDoc;};};return oDoc;};};};};if(_SARISSA_HAS_DOM_FEATURE && document.implementation.hasFeature("XPath", "3.0")){function SarissaNodeList(i){this.length=i;};SarissaNodeList.prototype=new Array(0);SarissaNodeList.prototype.constructor=Array;SarissaNodeList.prototype.item=function(i) {return (i<0||i>=this.length)?null:this[i];};SarissaNodeList.prototype.expr="";if(window.XMLDocument && (!XMLDocument.prototype.setProperty)){XMLDocument.prototype.setProperty=function(x,y){};};Sarissa.setXpathNamespaces=function(oDoc, sNsSet) {oDoc._sarissa_useCustomResolver=true;var namespaces=sNsSet.indexOf(" ")>-1?sNsSet.split(" "):new Array(sNsSet);oDoc._sarissa_xpathNamespaces=new Array(namespaces.length);for(var i=0;i<namespaces.length;i++){var ns=namespaces[i];var colonPos=ns.indexOf(":");var assignPos=ns.indexOf("=");if(colonPos>0 && assignPos>colonPos+1){var prefix=ns.substring(colonPos+1, assignPos);var uri=ns.substring(assignPos+2, ns.length-1);oDoc._sarissa_xpathNamespaces[prefix]=uri;}else{throw "Bad format on namespace declaration(s) given";};};};XMLDocument.prototype._sarissa_useCustomResolver=false;XMLDocument.prototype._sarissa_xpathNamespaces=new Array();XMLDocument.prototype.selectNodes=function(sExpr, contextNode, returnSingle){var nsDoc=this;var nsresolver=this._sarissa_useCustomResolver? function(prefix){var s=nsDoc._sarissa_xpathNamespaces[prefix];if(s)return s;else throw "No namespace URI found for prefix: '"+prefix+"'";}: this.createNSResolver(this.documentElement);var result=null;if(!returnSingle){var oResult=this.evaluate(sExpr,(contextNode?contextNode:this),nsresolver,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);var nodeList=new SarissaNodeList(oResult.snapshotLength);nodeList.expr=sExpr;for(var i=0;i<nodeList.length;i++)
nodeList[i]=oResult.snapshotItem(i);result=nodeList;}else{result=oResult=this.evaluate(sExpr,(contextNode?contextNode:this),nsresolver,XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;};return result;};Element.prototype.selectNodes=function(sExpr){var doc=this.ownerDocument;if(doc.selectNodes)
return doc.selectNodes(sExpr, this);else
throw "Method selectNodes is only supported by XML Elements";};XMLDocument.prototype.selectSingleNode=function(sExpr, contextNode){var ctx=contextNode?contextNode:null;return this.selectNodes(sExpr, ctx, true);};Element.prototype.selectSingleNode=function(sExpr){var doc=this.ownerDocument;if(doc.selectSingleNode)
return doc.selectSingleNode(sExpr, this);else
throw "Method selectNodes is only supported by XML Elements";};Sarissa.IS_ENABLED_SELECT_NODES=true;};if(!Sarissa.IS_ENABLED_TRANSFORM_NODE && window.XSLTProcessor && self.XMLElement){XMLElement.prototype.transformNodeToObject=function(xslDoc, oResult){var oDoc=document.implementation.createDocument("", "", null);Sarissa.copyChildNodes(this, oDoc);oDoc.transformNodeToObject(xslDoc, oResult);};Document.prototype.transformNodeToObject=function(xslDoc, oResult){var xsltProcessor=null;try{xsltProcessor=new XSLTProcessor();if(xsltProcessor.reset){xsltProcessor.importStylesheet(xslDoc);var newFragment=xsltProcessor.transformToFragment(this, oResult);Sarissa.copyChildNodes(newFragment, oResult);}else{xsltProcessor.transformDocument(this, xslDoc, oResult, null);};}catch(e){if(xslDoc && oResult)
throw "Failed to transform document. (original exception: "+e+")";else if(!xslDoc)
throw "No Stylesheet Document was provided. (original exception: "+e+")";else if(!oResult)
throw "No Result Document was provided. (original exception: "+e+")";else if(xsltProcessor==null)
throw "Could not instantiate an XSLTProcessor object. (original exception: "+e+")";else
throw e;};};XMLElement.prototype.transformNode=function(xslDoc){var oDoc=document.implementation.createDocument("", "", null);Sarissa.copyChildNodes(this, oDoc);return oDoc.transformNode(xslDoc);};Document.prototype.transformNode=function(xslDoc){var out=document.implementation.createDocument("", "", null);this.transformNodeToObject(xslDoc, out);var str=null;try{var serializer=new XMLSerializer();str=serializer.serializeToString(out);}catch(e){throw "Failed to serialize result document. (original exception: "+e+")";};return str;};Sarissa.IS_ENABLED_TRANSFORM_NODE=true;};Sarissa.setXslParameter=function(oXslDoc, sParamQName, sParamValue){try{var params=oXslDoc.getElementsByTagName(_SARISSA_IEPREFIX4XSLPARAM+"param");var iLength=params.length;var bFound=false;var param;if(sParamValue){for(var i=0; i<iLength && !bFound;i++){if(params[i].getAttribute("name")==sParamQName){param=params[i];while(param.firstChild)
param.removeChild(param.firstChild);if(!sParamValue||sParamValue==null){}else if(typeof sParamValue=="string"){param.setAttribute("select", sParamValue);bFound=true;}else if(sParamValue.nodeName){param.removeAttribute("select");param.appendChild(sParamValue.cloneNode(true));bFound=true;}else if(sParamValue.item(0) && sParamValue.item(0).nodeType){for(var j=0;j<sParamValue.length;j++)
if(sParamValue.item(j).nodeType)
param.appendChild(sParamValue.item(j).cloneNode(true));bFound=true;}else
throw "Failed to set xsl:param "+sParamQName+" (original exception: "+e+")";};};};return bFound;}catch(e){throw e;return false;};};function UnescapeCommon(str){return str.replace(/&gt;/gi, ">").replace(/&lt;/gi, "<").replace(/&amp;/gi, "&").replace(/%25/gi, "%");}
function UnescapeCommonInnerHTML(DivObject){DivObject.innerHTML=UnescapeCommon(DivObject.innerHTML);}
function unescapeAmp(str){return str.replace(/&amp;/g,"&");}
function GetSingleNodeDoc(XMLDoc, NodePath){try{var TempXMLDoc=XMLDoc.selectSingleNode(NodePath);return TempXMLDoc;}
catch(e){return null;}}
function GetSingleNodeContent(XMLDoc, NodePath, Default) {try {var content="";if(XMLDoc.selectSingleNode(NodePath).childNodes.length>0) {if(XMLDoc.selectSingleNode(NodePath).childNodes.length>1) {for (var x=0; x<XMLDoc.selectSingleNode(NodePath).childNodes.length; x++) {var TempXMLDoc=XMLDoc.selectSingleNode(NodePath).childNodes[x].item(0);content+=new XMLSerializer().serializeToString(TempXMLDoc);}}else{var TempXMLDoc=XMLDoc.selectSingleNode(NodePath).childNodes.item(0);content=new XMLSerializer().serializeToString(TempXMLDoc);}
content=content.replace("<![CDATA[", "");content=content.replace("]]>", "");return content;}
return;}
catch (e) {if(Default!=undefined) {return Default;}
return "";}};