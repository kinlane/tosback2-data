/* OnlineOpinion v5.2.2 Released: 5/6/2011 Branch: master fbc30f6ca6527b2824b2ca1c6f274e452522cf2b Components: Full The following code is Copyright 1998-2011 Opinionlab, Inc. All rights reserved. Unauthorized use is prohibited. This product and other products of OpinionLab, Inc. are protected by U.S. Patent No. 6606581, 6421724, 6785717 B1 and other patents pending. http://www.opinionlab.com */var OOo={Browser:(function(){var a=navigator.userAgent,b=Object.prototype.toString.call(window.opera)=='[object Opera]',c={IE:!!window.attachEvent&&!b,Opera:b,WebKit:a.indexOf('AppleWebKit/')>-1,Chrome:a.indexOf('Chrome')>-1,Gecko:a.indexOf('Gecko')>-1&&a.indexOf('KHTML')===-1,MobileSafari:/Apple.*Mobile.*Safari/.test(a),PalmPre:a.indexOf('Pre/')>-1,BlackBerry:a.indexOf('BlackBerry')>-1,Fennec:a.indexOf('Fennec')>-1,IEMobile:a.indexOf('IEMobile')>-1,OperaMobile:a.search(/Opera (?:Mobi|Mini)/)>-1},d=0,f,h=false;if(c.IE){f=/msie.(\d\.\d+)/i;d=a.match(f)[1]}else if(c.Gecko){f=/gecko.(\d+)/i;d=a.match(f)[1]}else if(c.WebKit){f=/applewebkit\/(\d+)/i;d=a.match(f)[1]}else if(c.Opera){f=/opera.(\d\.\d+)/i;d=a.match(f)[1]}else{h=true}c.isMobile=(c.MobileSafari||c.PalmPre||c.BlackBerry||c.Fennec||c.IEMobile||c.OperaMobile);c.Version=parseFloat(d);c.isModern=(!(h||(c.IE&&c.Version<6)||(c.Opera&&c.Version<8)||(c.Gecko=='gecko'&&c.Version<20041107)));return c})()};OOo.Cache={};OOo.instanceCount=0;if(!OnlineOpinion)var OnlineOpinion=OOo;(function(){function h(a){return document.getElementById(a)}function g(a,b){for(var c in b)a[c]=b[c];return a}function i(a,b,c,d){if(a.addEventListener)a.addEventListener(b,c,d);else if(a.attachEvent)a.attachEvent('on'+b,c)}function j(a,b,c,d){if(a.removeEventListener)a.removeEventListener(b,c,d);else if(a.detachEvent)a.detachEvent('on'+b,c)};function k(a){var b=[];for(var c in a)b.push(c+'='+(encodeURIComponent(a[c])||''));return b.join('&')}function l(a){var b=k(a.metrics);b+='&custom_var='+a.tealeafId+'|'+a.clickTalePID+'/'+a.clickTaleUID+'/'+a.clickTaleSID;if(a.legacyVariables)b+="|"+encodeURIComponent(a.legacyVariables);if(a.metrics.type=='OnPage')b+='|iframe';if(a.asm)b+='&asm=1';b+='&_'+"rev=2";if(a.customVariables)b+='&customVars='+encodeURIComponent(OOo.serialize(a.customVariables));return b}function o(a,b){var c=document,d=c.createElement('form'),f=c.createElement('input');d.style.display='none';d.method='post';d.target=b||'OnlineOpinion';d.action=a.onPageCard?'https://secure.opinionlab.com/ccc01/comment_card_json_4_0_b.asp?r='+location.href:'https://secure.opinionlab.com/ccc01/comment_card_d.asp';f.name='params';f.value=l(a);d.appendChild(f);c.body.appendChild(d);return d}function p(){return{width:screen.width,height:screen.height,referer:location.href,prev:document.referrer,time1:(new Date()).getTime(),time2:null,currentURL:location.href,ocodeVersion:'5.2.2'}}g(OOo,{extend:g,toQueryString:k,addEventListener:i,$:h,appendOOForm:o,removeEventListener:j,createMetrics:p})})();(function(){function h(a){if(!a)return null;switch(typeof a){case'number':case'boolean':case'function':return a;break;case'string':return'\''+a+'\'';break;case'object':var b;if(a.constructor===Array||typeof a.callee!=='undefined'){b='[';var c,d=a.length;for(c=0;c<d-1;c++){b+=h(a[c])+','}b+=h(a[c])+']'}else{b='{';var f;for(f in a){b+=f+':'+h(a[f])+','}b=b.replace(/\,$/,'')+'}'}return b;break;default:return null}}OOo.extend(OOo,{serialize:h})})();(function(){function f(a,b){var c=location.pathname,d;if(c.search(a[0])!=-1){OOo.createCookie(b,0);return false}else if(OOo.readCookie(b)){d=parseInt(OOo.readCookie(b));if((c.search(a[d+1])!=-1)&&(d+1!=a.length-1)){OOo.createCookie(b,d+1);return false}else if(c.search(a[d])!=-1)return false;else if(d+1==a.length-1&&c.search(a.pop())!=-1){OOo.eraseCookie(b);return true}else{OOo.eraseCookie(b);return false}}else return false}OOo.extend(OOo,{checkTunnel:f})})();(function(){function s(a){var b="";for(var c=7;c>=0;c--)b+='0123456789abcdef'.charAt((a>>(c*4))&0x0F);return b}function v(a){var b=((a.length+8)>>6)+1,c=new Array(b*16);for(var d=0;d<b*16;d++)c[d]=0;for(var d=0;d<a.length;d++)c[d>>2]|=a.charCodeAt(d)<<(24-(d%4)*8);c[d>>2]|=0x80<<(24-(d%4)*8);c[b*16-1]=a.length*8;return c}function n(a,b){var c=(a&0xFFFF)+(b&0xFFFF),d=(a>>16)+(b>>16)+(c>>16);return(d<<16)|(c&0xFFFF)}function q(a,b){return(a<<b)|(a>>>(32-b))}function w(a,b,c,d){if(a<20)return(b&c)|((~b)&d);if(a<40)return b^c^d;if(a<60)return(b&c)|(b&d)|(c&d);return b^c^d}function r(a){return(a<20)?1518500249:(a<40)?1859775393:(a<60)?-1894007588:-899497514}function y(a){var b=v(a),c=new Array(80),d=1732584193,f=-271733879,h=-1732584194,g=271733878,i=-1009589776,j,k,l,o,p,t;for(var u=0;u<b.length;u+=16){j=d,k=f,l=h,o=g,p=i;for(var m=0;m<80;m++){if(m<16)c[m]=b[u+m];else c[m]=q(c[m-3]^c[m-8]^c[m-14]^c[m-16],1);t=n(n(q(d,5),w(m,f,h,g)),n(n(i,c[m]),r(m)));i=g;g=h;h=q(f,30);f=d;d=t}d=n(d,j);f=n(f,k);h=n(h,l);g=n(g,o);i=n(i,p)}return s(d)+s(f)+s(h)+s(g)+s(i)}OOo.extend(OOo,{sha1:y})})();(function(){function g(a){var b=a.cookieName||'oo_abandon',c=OOo.readCookie(b),d=a.startPage,f=a.endPage,h=a.middle;if(!c){if(location.pathname.indexOf(d)!=-1)OOo.createCookie(b);return false}else if(location.pathname.indexOf(f)!=-1){OOo.eraseCookie(b);return false}else if(location.pathname.search(h)!=-1)return false;else{OOo.eraseCookie(b);return true}}OOo.extend(OOo,{checkAbandonment:g})})();(function(){function c(a){for(var b=a.length-1;b>=0;b--){if(a[b].read){if(!!(cookieValue=OOo.readCookie(a[b].name))&&cookieValue==a[b].value)return true;else if(typeof a[b].value=='undefined'&&!!OOo.readCookie(a[b].name))return true}}return false}function d(a){for(var b=a.length-1;b>=0;b--){if(a[b].set)OOo.createCookie(a[b].name,a[b].value,a[b].expiration)}}OOo.extend(OOo,{checkThirdPartyCookies:c,setThirdPartyCookies:d})})();OOo.extend(Function.prototype,(function(){if(typeof(Prototype)!="undefined")return;var f=Array.prototype.slice;function h(a,b){var c=a.length,d=b.length;while(d--)a[c+d]=b[d];return a}function g(a,b){a=f.call(a,0);return h(a,b)}function i(b){if(arguments.length<2&&typeof arguments[0]==="undefined")return this;var c=this,d=f.call(arguments,1);return function(){var a=g(d,arguments);return c.apply(b,a)}}return{bind:i}})());(function(){var h;if(location.host.search(/\d+\.\d+\.\d+\.\d+/)===0)h=location.host;else{h=location.host.split('.').reverse();h='.'+h[1]+'.'+h[0]}function g(a,b,c){var d='',f='';if(c){d=new Date();d.setTime(d.getTime()+(c*1000));f="; expires="+d.toGMTString()}document.cookie=a+"="+b+f+"; path=/; domain="+h+";"}function i(a){var b=a+"=",c=document.cookie.split(';'),d;for(var f=0;f<c.length;f++){d=c[f];while(d.charAt(0)==' ')d=d.substring(1,d.length);if(d.indexOf(b)===0)return d.substring(b.length,d.length)}return null}function j(a){g(a,"",-1)}OOo.extend(OOo,{createCookie:g,readCookie:i,eraseCookie:j})})();OOo.Ocode=function(a){var b=OOo.Browser;if(!b.isModern||(a.disableMobile&&b.isMobile))return;if(a.disableNoniOS&&(navigator.userAgent.search('Android')!=-1||b.PalmPre||b.IEMobile||b.OperaMobile||b.Fennec))return;OOo.instanceCount++;this.options={tealeafCookieName:'TLTSID'};OOo.extend(this.options,a);var c=this.options,d=c.referrerRewrite;c.metrics=OOo.createMetrics();this.frameName=c.onPageCard?'OnlineOpinion'+OOo.instanceCount:'OnlineOpinion';if(c.cookie&&this.matchUrl())return;if(c.thirdPartyCookies&&OOo.checkThirdPartyCookies(c.thirdPartyCookies))return;if(c.abandonment&&!OOo.checkAbandonment(c.abandonment))return;if(c.tunnel&&!OOo.checkTunnel(c.tunnel.path,c.tunnel.cookieName))return;if(c.events&&c.events.onSingleClick)this.singProbability=Math.random()<1-c.events.onSingleClick/100;c.tealeafId=OOo.readCookie(c.tealeafCookieName)||OOo.readCookie(c.sessionCookieName);if(d)c.metrics.referer=d.searchPattern?window.location.href.replace(d.searchPattern,d.replacePattern):d.replacePattern;if(c.events){this.setupEvents();if(c.events.disableLinks||c.events.disableFormElements)this.setupDisableElements()}if(c.floating)this.floating();else if(c.bar)this.bar();else if(c.tab)this.tab()};OOo.Ocode.prototype={show:function(){var a=this.options;if(this.interruptShow)return;if(!this.floatingLogo&&a.cookie&&this.matchUrl())return;if(!a.floating&&a.events&&this.singProbability)return;if(a.events&&a.events.onSingleClick)this.singProbability=true;if(a.cookie)this.tagUrl();if(a.thirdPartyCookies){if(OOo.checkThirdPartyCookies(a.thirdPartyCookies))return;OOo.setThirdPartyCookies(a.thirdPartyCookies)}if(this.floatingLogo&&a.disappearOnClick)this.floatingLogo.style.display='none';if(typeof arguments[0]=='string')a.metrics.trigger=arguments[0];if(a.clickTalePID&&typeof ClickTale=='function'){a.clickTaleUID=ClickTaleGetUID();a.clickTaleSID=ClickTaleGetSID()}if(a.onPageCard)this.setupOnPageCC();else this.launchOOPopup()},tagUrl:function(){if(this.matchUrl())return;var a=this.options.cookie,b=a.type=='page'?location.href:location.hostname,c=OOo.readCookie(a.name||'oo_r')||'';OOo.createCookie(a.name||'oo_r',c+OOo.sha1(b),a.expiration)},matchUrl:function(){var a=this.options.cookie.type=='page'?location.href:location.hostname,b=OOo.readCookie(this.options.cookie.name||'oo_r');if(!b)return false;return b.search(OOo.sha1(a))!=-1}};(function(){function h(){var a=this.options,b=a.newWindowSize||[545,325],c=[parseInt((a.metrics.height-b[1])/2),parseInt((a.metrics.width-b[0])/2)],a=this.options,d,f;a.metrics.time2=(new Date()).getTime();a.metrics.type='Popup';d=OOo.appendOOForm(a);f=window.open('','OnlineOpinion','location=no,status=no,width='+b[0]+',height='+b[1]+',top='+c[0]+',left='+c[1]);if(f)d.submit()}OOo.extend(OOo.Ocode.prototype,{launchOOPopup:h})})();(function(){function k(){var a=this.options.events,b=[false,false],c=['onExit','onEntry'],d=OOo.Browser.Opera?'unload':'beforeunload',f,h;for(var g=c.length-1;g>=0;g--){f=c[g];if(a[f]instanceof Array){var i=a[f],j=i.length;while(j--&&!b[g]){if(window.location.href.search(i[j].url)!=-1&&Math.random()>=1-i[j].p/100)b[g]=true}}else if(a[f]&&Math.random()>=1-a[f]/100)b[g]=true}if(b[0])OOo.addEventListener(window,d,this.show.bind(this,'onExit'),false);if(b[1]){if(a.delayEntry){window.setTimeout(function(){this.show()}.bind(this,'onEntry'),a.delayEntry*1000)}else{this.show('onEntry')}}}function l(){OOo.addEventListener(document.body,'mousedown',o.bind(this));if(!this.options.events.disableFormElements)return;var a=document.getElementsByTagName('form');for(var b=a.length-1;b>=0;b--)OOo.addEventListener(a[b],'submit',p.bind(this))}function o(a){var b=a||window.event,c=a.target||a.srcElement,d=this.options.events,f=c.parentNode,h=5,g=0;while(f&&(c.nodeName!='A'||c.nodeName!='INPUT')&&g!=h){if(f.nodeName=='A')c=f;f=f.parentNode;g++}if(d.disableFormElements&&c.tagName=="INPUT"&&(c.type=='submit'||c.type=='image'))this.interruptShow=true;if(c.nodeName=='A'&&c.href.substr(0,4)=='http'&&c.href.search(d.disableLinks)!=-1)this.interruptShow=true}function p(a){this.interruptShow=true}OOo.extend(OOo.Ocode.prototype,{setupEvents:k,setupDisableElements:l})})();OOo.extend(OOo.Ocode.prototype,{floating:function(){var d=document,f=this.floatingLogo=document.createElement('div'),h=d.createElement('div'),g=d.createElement('div'),i=d.createElement('div'),j=d.createElement('span'),k=this.options.floating,l=OOo.$(k.contentId),o='10px',p=false,t=k.id;if(t)f.id=t;f.className='oo_feedback_float';g.className='oo_transparent';h.className='olUp';i.className='olOver';h.tabIndex=0;h.onkeyup=function(a){var b=a||window.event;if(b.keyCode!=13)return;this.show()}.bind(this);h.innerHTML=k.caption||'Feedback';f.appendChild(h);j.innerHTML=k.hoverCaption||'Click here to<br>rate this page';i.appendChild(j);f.appendChild(i);f.appendChild(g);if(OOo.Browser.IE&&OOo.Browser.Version<7){f.style.position='absolute';f.style.bottom='';OOo.addEventListener(window,'scroll',u,false);OOo.addEventListener(window,'resize',u,false);function u(a){f.style.top=(d.documentElement.scrollTop+document.documentElement.clientHeight-f.clientHeight)+'px'};p=true}else if(OOo.Browser.MobileSafari){var m=window.innerHeight,s;f.style.bottom=null;f.style.top=(pageYOffset+window.innerHeight-60)+'px';OOo.addEventListener(window,'scroll',function(a){s=pageYOffset-(m-window.innerHeight);f.style.webkitTransform='translateY('+s+'px)'},false)}if(k.position&&k.position.search(/Content/)&&l){var v=this.spacer=d.createElement('div'),n=OOo.Browser.WebKit?d.body:d.documentElement,q;v.id='oo_feedback_fl_spacer';v.style.left=r(l)+'px';d.body.appendChild(v);switch(k.position){case'rightOfContent':q=function(a){f.style.left=(r(l)-n.scrollLeft)+'px';if(p)q=null};break;case'fixedPreserveContent':q=function(a){var b=OOo.Browser.IE?d.body.clientWidth:window.innerWidth,c=!p?n.scrollLeft:0;if(b<=r(l)+f.offsetWidth+parseInt(o))f.style.left=(r(l)-c)+'px';else{f.style.left='';f.style.right=o}};break;case'fixedContentMax':q=function(a){var b=OOo.Browser.IE?d.body.clientWidth:window.innerWidth;if(b<=r(l)+f.offsetWidth+parseInt(o)){f.style.left='';f.style.right=o;if(a&&a.type=='scroll'&&p)f.style.left=(d.documentElement.clientWidth+n.scrollLeft-105)+'px'}else{f.style.left=(r(l)-n.scrollLeft)+'px';f.style.right=''}};break}q();OOo.addEventListener(window,'scroll',q,false);OOo.addEventListener(window,'resize',q,false);function w(a){v.style.left=r(l)+'px'};OOo.addEventListener(window,'resize',w,false)}else{f.style.right=o}OOo.addEventListener(f,'click',this.show.bind(this,'Floating'),false);OOo.addEventListener(f,'touchstart',this.show.bind(this,'Floating'),false);d.body.appendChild(f);if(OOo.Browser.IE&&OOo.Browser.Version<7){f.style.top=(d.documentElement.clientHeight-f.clientHeight)+'px';g.style.height=f.clientHeight+'px'}function r(a){return a.offsetLeft+a.offsetWidth}},removeFloatingLogo:function(){document.body.removeChild(this.floatingLogo);if(this.spacer)document.body.removeChild(this.spacer)}});OOo.extend(OOo.Ocode.prototype,{bar:function(){var c=document,d=this.floatingLogo=c.createElement('div'),f=c.createElement('span');d.id='oo_bar';f.innerHTML=this.options.bar.caption||'Feedback';d.appendChild(f);d.tabIndex=0;d.onkeyup=function(a){var b=a||window.event;if(b.keyCode!=13)return;this.show()}.bind(this);OOo.addEventListener(d,'click',this.show.bind(this,'Bar'));document.body.className+=document.body.className<1?'oo_bar':' oo_bar';document.body.appendChild(d);if(OOo.Browser.IE){var h;if(c.compatMode=='CSS1Compat'){h=function(a){if(a&&a.type=='resize')setTimeout(h,50);d.style.top=(c.documentElement.scrollTop+document.documentElement.clientHeight-d.clientHeight-1)+'px';d.style.width=(Math.max(c.documentElement.clientWidth,c.body.offsetWidth))+'px'}}else{h=function(a){d.style.top=(c.body.scrollTop+document.body.clientHeight-d.clientHeight-1)+'px';d.style.width=(Math.max(c.documentElement.clientWidth,c.body.offsetWidth)-22)+'px'}}d.style.position='absolute';OOo.addEventListener(window,'scroll',h,false);OOo.addEventListener(window,'resize',h,false);h()}else if(OOo.Browser.MobileSafari){var g=window.innerHeight,i;d.style.bottom=null;d.style.top=(pageYOffset+window.innerHeight-22)+'px';OOo.addEventListener(window,'scroll',function(a){i=pageYOffset-(g-window.innerHeight);d.style.webkitTransform='translateY('+i+'px)'},false)}}});OOo.extend(OOo.Ocode.prototype,{tab:function(){var c=document,d=this.floatingLogo=c.createElement('div'),f=c.createElement('a'),h=c.createElement('span'),g=this.options.tab;d.id='oo_tab';d.className='oo_tab_'+(g.position||'right');if(OOo.Browser.IE&&OOo.Browser.Version<7){d.style.position='absolute';if(g.position=='right')d.className+=' oo_tab_ie_right'}else if(OOo.Browser.MobileSafari){d.style.top=(pageYOffset+window.innerHeight/2)+'px';OOo.addEventListener(window,'scroll',function(a){d.style.top=(pageYOffset+window.innerHeight/2)+'px'},false)}f.href="javascript:void(0)";f.title=g.title||'Feedback';d.tabIndex=0;d.onkeyup=function(a){var b=a||window.event;if(b.keyCode!=13)return;this.show()}.bind(this);f.appendChild(h);d.appendChild(f);OOo.addEventListener(d,'click',this.show.bind(this,'Tab'),false);c.body.appendChild(d)}});OOo.extend(OOo.Ocode.prototype,{setupOnPageCC:function(){var g=document,i=OOo.Cache.overlay||g.createElement('div'),j=this.wrapper=g.createElement('div'),k=g.createElement('a'),l=g.createElement('div'),o=g.createElement('span'),p=this.frameName,t=g.createElement(OOo.Browser.IE&&OOo.Browser.Version<9?'<iframe name="'+p+'">':'iframe'),u=g.createDocumentFragment(),m=this.options,s=m.onPageCard,v='https://secure.opinionlab.com/ccc01/comment_card_json_4_0_b.asp',n,q,w,r=false;m.metrics.type='OnPage';OOo.Cache.overlay=i;i.id='oo_overlay';i.style.display='block';i.className='';l.className='iwrapper';j.className='oo_cc_wrapper';k.className='oo_cc_close';k.href="javascript:void(0)";k.title=s.closeTitle||"Close Feedback Card";j.style.visibility='hidden';if(OOo.Browser.IE){if(!window.XMLHttpRequest){i.style.position='absolute';i.style.width=Math.max(g.documentElement.clientWidth,g.body.offsetWidth)+'px';i.style.height=Math.max(g.documentElement.clientHeight,g.body.offsetHeight)+'px';j.style.position='absolute'}else{var y=g.createElement("div"),A=g.createElement("div"),B=g.createElement("div"),x=g.createElement("div");x.className="oo_shadows";y.className='oo_body';A.className='oo_top';B.className='oo_bottom';x.appendChild(y);x.appendChild(A);x.appendChild(B);l.appendChild(x)}}OOo.addEventListener(k,'click',z);if(s.closeWithOverlay&&!OOo.Browser.isMobile){j.appendChild(o);o.onclick=z;i.onclick=z}t.src=v;t.name=p;l.appendChild(k);l.appendChild(t);j.appendChild(l);u.appendChild(j);u.appendChild(i);g.body.appendChild(u);w=C.bind(this);window.postMessage?OOo.addEventListener(window,"message",w):q=setInterval(C.bind(this),500);n=OOo.appendOOForm(m,p);m.metrics.time2=(new Date()).getTime();n.submit();function C(a){if((a&&a.origin!='https://secure.opinionlab.com')||(!a&&location.hash.substr(1,3)!='OL='))return;var b=a?a.data:location.hash.slice(4),c=parseInt(b),d=document;if(!a)location.hash='';if(c>0){if(r)return;r=true;var f=window.innerHeight||d.documentElement.clientHeight,h=c;if(h>f){h=f-40;t.style.width='555px'}t.style.height=h+'px';if(OOo.Browser.IE&&OOo.Browser.Version<7)o.style.height=j.offsetHeight+'px';j.style.visibility='visible';i.className="no_loading"}else if(b=='submitted')z()}function z(){i.style.display='none';i.className='';g.body.removeChild(j);window.postMessage?OOo.removeEventListener(window,'message',w):window.clearInterval(q);r=false}}});OOo.Invitation=function(a){this.options={tunnelCookie:'oo_inv_tunnel',repromptTime:604800,responseRate:50,repromptCookie:'oo_inv_reprompt',promptMarkup:'oo_inv_prompt.html',promptStyles:'oo_inverstitial_style.css',percentageCookie:'oo_inv_percent',pagesHitCookie:'oo_inv_hit',popupType:'popunder',promptDelay:0,neverShowAgainButton:false,loadPopupInBackground:false,tealeafCookieName:'TLTSID',monitorWindow:'oo_inv_monitor.html'};this.popupShown=false;OOo.extend(this.options,a);var b=this.options,c=parseInt(OOo.readCookie(b.pagesHitCookie))||0;OOo.Invitation.friendlyDomains=b.friendlyDomains||null;if(location.search.search('evs')!=-1){b.loadPopupInBackground=true;this.launchPopup();OOo.createCookie(b.repromptCookie,1,b.repromptTime==-1?0:b.repromptTime)}setTimeout(function(){if(!window.oo_inv_monitor)return;if(b.area&&location.href.search(b.area)==-1){this.options.popupType='popup';this.launchPopup()}else if(b.goal&&location.href.search(b.goal)!=-1){oo_inv_monitor.close()}}.bind(this),1000);if(OOo.readCookie(b.repromptCookie))return;if(b.thirdPartyCookies&&OOo.checkThirdPartyCookies(b.thirdPartyCookies))return;if(!OOo.readCookie(b.percentageCookie)){OOo.createCookie(b.percentageCookie,(Math.random()>1-(b.responseRate/100))?"1":"0")}if(typeof(b.promptTrigger)!='undefined'){if(b.promptTrigger instanceof RegExp){if(!window.location.href.match(b.promptTrigger))return}else if(b.promptTrigger instanceof Array){if(!OOo.checkTunnel(b.promptTrigger,b.tunnelCookie))return}}c++;OOo.createCookie(b.pagesHitCookie,c);if(b.pagesHit&&c<b.pagesHit)return;OOo.eraseCookie(b.tunnelCookie);if(OOo.readCookie(b.percentageCookie)=='1'){window.setTimeout(function(){OOo.createCookie(b.repromptCookie,1,b.repromptTime);this.getPrompt()}.bind(this),b.promptDelay*1000)}};OOo.Invitation.prototype={getPrompt:function(){var a=window.XMLHttpRequest?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP"),b=this,c=document.createElement('link'),d;a.onreadystatechange=function(){if(a.readyState!=4)return;b.showPrompt(a.responseText)};a.open("GET",this.options.pathToAssets+this.options.promptMarkup,true);a.send(null)},showPrompt:function(a){var b=document,c=b.createElement('div'),d=OOo.Cache.overlay||b.createElement('div'),f,h,g=this.options;d.id='oo_overlay';c.id='oo_container';c.style.visibility='hidden';c.innerHTML=a;c.appendChild(d);b.body.appendChild(c);if(g.companyLogo){f=new Image();f.src=g.companyLogo;OOo.$('oo_company_logo').appendChild(f)}OOo.addEventListener(OOo.$('oo_launch_prompt'),'click',this.launchPopup.bind(this),false);if(g.neverShowAgainButton){h=OOo.$('oo_never_show');h.style.visibility='visible';OOo.addEventListener(h,'click',this.killPrompt.bind(this),false)}if(OOo.Browser.IE&&!window.XMLHttpRequest){d.style.position='absolute';d.style.width=Math.max(document.documentElement.clientWidth,document.body.offsetWidth)+'px';d.style.height=Math.max(document.documentElement.clientHeight,document.body.offsetHeight)+'px';c.style.position='absolute'}c.style.visibility='visible';d.className='no_loading'},launchPopup:function(){if(this.popupShown)return;this.popupShown=true;var a=this.options,b=window.location.href,c=a.popupType=='popup'?'https://secure.opinionlab.com/ccc01/comment_card.asp?':a.pathToAssets+a.monitorWindow+'?'+(new Date()).getTime()+'&',d,f=[],h=a.asm?[555,500]:[545,200],g,i=OOo.readCookie(a.teleafId),j=OOo.createMetrics();h=a.newWindowSize||h;if(a.referrerRewrite){j.referer=a.referrerRewrite.searchPattern?window.location.href.replace(a.referrerRewrite.searchPattern,a.referrerRewrite.replacePattern):a.referrerRewrite.replacePattern}if(a.thirdPartyCookies)OOo.setThirdPartyCookies(a.thirdPartyCookies);d=OOo.toQueryString(j)+'&type=Invitation';if(a.customVariables)d+='&customVars='+encodeURIComponent(OOo.serialize(a.customVariables));d+='&custom_var='+i;if(a.clickTalePID&&ClickTaleGetUID&&ClickTaleGetSID)d+='|'+[a.clickTalePID,ClickTaleGetUID(),ClickTaleGetSID()].join('/');g=window.open(c+d,'OnlineOpinionInvitation','location=no,status=no,width='+h[0]+',height='+h[1]);if(!a.loadPopupInBackground&&OOo.$('oo_container'))OOo.Invitation.hidePrompt();if(a.popupType=='popunder'){if(!OOo.Browser.Chrome){g.blur();window.focus()}else{if(!a.loadPopupInBackground)alert(a.chromeMainWinPrompt||'Please fill out the form behind this window when you are finished.');if(a.chromeSurveyPrompt)setTimeout(function(e){g.postMessage(a.chromeSurveyPrompt,"*")},500)}}else if(window.oo_inv_monitor){window.blur();g.focus()}},killPrompt:function(){OOo.createCookie(this.options.repromptCookie,1,1825);OOo.Invitation.hidePrompt()}};OOo.extend(OOo.Invitation,{hidePrompt:function(){OOo.$('oo_container').style.display='none'},navigateToFriendlyDomain:function(a){location=a}});