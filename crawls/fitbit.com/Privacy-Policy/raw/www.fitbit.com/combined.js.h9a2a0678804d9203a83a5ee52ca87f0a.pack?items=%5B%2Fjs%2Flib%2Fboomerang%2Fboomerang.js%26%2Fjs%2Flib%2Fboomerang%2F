(function(h){var k,l,d,i=h.document;if(typeof BOOMR==="undefined"){BOOMR={};}if(BOOMR.version){return;}BOOMR.version="0.9";k={beacon_url:"",site_domain:h.location.hostname.replace(/.*?([^.]+\.[^.]+)\.?$/,"$1").toLowerCase(),user_ip:"",events:{"page_ready":[],"page_unload":[],"visibility_changed":[],"before_beacon":[]},vars:{},disabled_plugins:{},fireEvent:function(f,b){var e,c,a;if(!this.events.hasOwnProperty(f)){return false;}a=this.events[f];for(e=0;e<a.length;e++){c=a[e];c[0].call(c[2],b,c[1]);}return true;},addListener:function(b,a,c,e){if(b.addEventListener){b.addEventListener(a,c,(e));}else{if(b.attachEvent){b.attachEvent("on"+a,c);}}}};l={utils:{getCookie:function(c){if(!c){return null;}c=" "+c+"=";var b,a;a=" "+i.cookie+";";if((b=a.indexOf(c))>=0){b+=c.length;a=a.substring(b,a.indexOf(";",b));return a;}return null;},setCookie:function(v,w,f,a,s,g){var b="",t,c,e,u="";if(!v){return false;}for(t in w){if(w.hasOwnProperty(t)){b+="&"+encodeURIComponent(t)+"="+encodeURIComponent(w[t]);}}b=b.replace(/^&/,"");if(f){u=new Date();u.setTime(u.getTime()+f*1000);u=u.toGMTString();}c=v+"="+b;e=c+((f)?"; expires="+u:"")+((a)?"; path="+a:"")+((typeof s!=="undefined")?"; domain="+(s!==null?s:k.site_domain):"")+((g)?"; secure":"");if(c.length<4000){i.cookie=e;return(b===this.getCookie(v));}return false;},getSubCookies:function(b){var c,e,f,g,a={};if(!b){return null;}c=b.split("&");if(c.length===0){return null;}for(e=0,f=c.length;e<f;e++){g=c[e].split("=");g.push("");a[decodeURIComponent(g[0])]=decodeURIComponent(g[1]);}return a;},removeCookie:function(a){return this.setCookie(a,{},0,"/",null);},pluginConfig:function(a,g,c,e){var f,b=0;if(!g||!g[c]){return false;}for(f=0;f<e.length;f++){if(typeof g[c][e[f]]!=="undefined"){a[e[f]]=g[c][e[f]];b++;}}return(b>0);}},init:function(c){var a,e,b=["beacon_url","site_domain","user_ip"];if(!c){c={};}for(a=0;a<b.length;a++){if(typeof c[b[a]]!=="undefined"){k[b[a]]=c[b[a]];}}if(typeof c.log!=="undefined"){this.log=c.log;}if(!this.log){this.log=function(g,f,m){};}for(e in this.plugins){if(c[e]&&typeof c[e].enabled!=="undefined"&&c[e].enabled===false){k.disabled_plugins[e]=1;continue;}else{if(k.disabled_plugins[e]){delete k.disabled_plugins[e];}}if(this.plugins.hasOwnProperty(e)&&typeof this.plugins[e].init==="function"){this.plugins[e].init(c);}}if(typeof c.autorun==="undefined"||c.autorun!==false){k.addListener(h,"load",function(){k.fireEvent("page_ready");});}k.addListener(i,"webkitvisibilitychange",function(){k.fireEvent("visibility_changed");});k.addListener(h,"unload",function(){h=null;});return this;},page_ready:function(){k.fireEvent("page_ready");return this;},subscribe:function(g,a,e,f){var c,b,p;if(!k.events.hasOwnProperty(g)){return this;}p=k.events[g];for(c=0;c<p.length;c++){b=p[c];if(b[0]===a&&b[1]===e&&b[2]===f){return this;}}p.push([a,e||{},f||null]);if(g==="page_unload"){k.addListener(h,"unload",function(){if(a){a.call(f,null,e);}a=f=e=null;});k.addListener(h,"beforeunload",function(){if(a){a.call(f,null,e);}a=f=e=null;});}return this;},addVar:function(c,b){if(typeof c==="string"){k.vars[c]=b;}else{if(typeof c==="object"){var a=c,e;for(e in a){if(a.hasOwnProperty(e)){k.vars[e]=a[e];}}}}return this;},removeVar:function(){var b,a;if(!arguments.length){return this;}if(arguments.length===1&&Object.prototype.toString.apply(arguments[0])==="[object Array]"){a=arguments[0];}else{a=arguments;}for(b=0;b<a.length;b++){if(k.vars.hasOwnProperty(a[b])){delete k.vars[a[b]];}}return this;},sendBeacon:function(){var b,a,c,e=0;for(b in this.plugins){if(this.plugins.hasOwnProperty(b)){if(k.disabled_plugins[b]){continue;}if(!this.plugins[b].is_complete()){return this;}}}k.fireEvent("before_beacon",k.vars);if(!k.beacon_url){return this;}a=k.beacon_url+"?v="+encodeURIComponent(BOOMR.version)+"&u="+encodeURIComponent(i.URL.replace(/#.*/,""));for(b in k.vars){if(k.vars.hasOwnProperty(b)){e++;a+="&"+encodeURIComponent(b)+"="+encodeURIComponent(k.vars[b]);}}if(e){c=new Image();c.src=a;}return this;}};var j=function(a){return function(c,b){this.log(c,a,"boomerang"+(b?"."+b:""));return this;};};l.debug=j("debug");l.info=j("info");l.warn=j("warn");l.error=j("error");if(h.YAHOO&&h.YAHOO.widget&&h.YAHOO.widget.Logger){l.log=h.YAHOO.log;}else{if(typeof h.Y!=="undefined"&&typeof h.Y.log!=="undefined"){l.log=h.Y.log;}}for(d in l){if(l.hasOwnProperty(d)){BOOMR[d]=l[d];}}BOOMR.plugins=BOOMR.plugins||{};}(window));(function(e){var f=e.document;BOOMR=BOOMR||{};BOOMR.plugins=BOOMR.plugins||{};var d={complete:false,timers:{},cookie:"RT",cookie_exp:600,strict_referrer:true,navigationStart:undefined,responseStart:undefined,start:function(){var a,b=new Date().getTime();if(!this.cookie){return this;}if(!BOOMR.utils.setCookie(this.cookie,{s:b,r:f.URL.replace(/#.*/,"")},this.cookie_exp,"/",null)){BOOMR.error("cannot set start cookie","rt");return this;}a=new Date().getTime();if(a-b>50){BOOMR.utils.removeCookie(this.cookie);BOOMR.error("took more than 50ms to set cookie... aborting: "+b+" -> "+a,"rt");}return this;},initNavTiming:function(){var b,a;if(this.navigationStart){return;}a=e.performance||e.msPerformance||e.webkitPerformance||e.mozPerformance;if(a&&a.timing){b=a.timing;}else{if(e.chrome&&e.chrome.csi){b={navigationStart:e.chrome.csi().startE,responseStart:undefined};BOOMR.addVar("rt.start","csi");}else{if(e.gtbExternal){b={navigationStart:e.gtbExternal.startE(),responseStart:undefined};BOOMR.addVar("rt.start","gtb");}}}if(b){BOOMR.addVar("rt.start","navigation");this.navigationStart=b.navigationStart||undefined;this.responseStart=b.responseStart||undefined;}else{BOOMR.warn("This browser doesn't support the WebTiming API","rt");}return;}};BOOMR.plugins.RT={init:function(a){d.complete=false;d.timers={};BOOMR.utils.pluginConfig(d,a,"RT",["cookie","cookie_exp","strict_referrer"]);BOOMR.subscribe("page_ready",this.done,null,this);BOOMR.subscribe("page_unload",d.start,null,d);return this;},startTimer:function(b,a){if(b){if(b==="t_page"){this.endTimer("t_resp",a);}d.timers[b]={start:(typeof a==="number"?a:new Date().getTime())};d.complete=false;}return this;},endTimer:function(b,a){if(b){d.timers[b]=d.timers[b]||{};if(typeof d.timers[b].end==="undefined"){d.timers[b].end=(typeof a==="number"?a:new Date().getTime());}}return this;},setTimer:function(b,a){if(b){d.timers[b]={delta:a};}return this;},done:function(){var c,r,n,q,m={t_done:1,t_resp:1,t_page:1},o=0,b,p,a=[];if(d.complete){return this;}d.initNavTiming();if(document.webkitVisibilityState&&document.webkitVisibilityState==="prerender"){this.startTimer("t_load",d.navigationStart);this.endTimer("t_load");this.startTimer("t_prerender",d.navigationStart);this.startTimer("t_postrender");BOOMR.subscribe("visibility_changed",this.done,null,this);return this;}this.endTimer("t_done");if(d.responseStart){this.setTimer("t_resp",d.responseStart-d.navigationStart);if(d.timers.t_load){this.setTimer("t_page",d.timers.t_load.end-d.responseStart);}else{this.setTimer("t_page",new Date().getTime()-d.responseStart);}}else{if(d.timers.hasOwnProperty("t_page")){this.endTimer("t_page");}}if(d.timers.hasOwnProperty("t_postrender")){this.endTimer("t_postrender");this.endTimer("t_prerender");}r=n=f.referrer.replace(/#.*/,"");if(d.cookie){q=BOOMR.utils.getSubCookies(BOOMR.utils.getCookie(d.cookie));BOOMR.utils.removeCookie(d.cookie);if(q!==null&&typeof q.s!=="undefined"&&typeof q.r!=="undefined"){r=q.r;if(!d.strict_referrer||r===n){c=parseInt(q.s,10);}}}if(c){BOOMR.addVar("rt.start","cookie");}else{c=d.navigationStart;}BOOMR.removeVar("t_done","t_page","t_resp","r","r2");for(b in d.timers){if(!d.timers.hasOwnProperty(b)){continue;}p=d.timers[b];if(typeof p.delta!=="number"){if(typeof p.start!=="number"){p.start=c;}p.delta=p.end-p.start;}if(isNaN(p.delta)){continue;}if(m.hasOwnProperty(b)){BOOMR.addVar(b,p.delta);}else{a.push(b+"|"+p.delta);}o++;}if(o){BOOMR.addVar("r",r);if(n!==r){BOOMR.addVar("r2",n);}if(a.length){BOOMR.addVar("t_other",a.join(","));}}d.timers={};d.complete=true;BOOMR.sendBeacon();return this;},is_complete:function(){return d.complete;}};}(window));(function(d){var g=d.document;BOOMR=BOOMR||{};BOOMR.plugins=BOOMR.plugins||{};var f=[{name:"image-0.png",size:11483,timeout:1400},{name:"image-1.png",size:40658,timeout:1200},{name:"image-2.png",size:164897,timeout:1300},{name:"image-3.png",size:381756,timeout:1500},{name:"image-4.png",size:1234664,timeout:1200},{name:"image-5.png",size:4509613,timeout:1200},{name:"image-6.png",size:9084559,timeout:1200}];f.end=f.length;f.start=0;f.l={name:"image-l.gif",size:35,timeout:1000};var h={base_url:"images/",timeout:15000,nruns:5,latency_runs:10,user_ip:"",cookie_exp:7*86400,cookie:"BA",results:[],latencies:[],latency:null,runs_left:0,aborted:false,complete:false,running:false,ncmp:function(a,b){return(a-b);},iqr:function(e){var i=e.length-1,l,a,b,n=[],c;l=(e[Math.floor(i*0.25)]+e[Math.ceil(i*0.25)])/2;a=(e[Math.floor(i*0.75)]+e[Math.ceil(i*0.75)])/2;b=(a-l)*1.5;i++;for(c=0;c<i&&e[c]<a+b;c++){if(e[c]>l-b){n.push(e[c]);}}return n;},calc_latency:function(){var n,q,i=0,p=0,e,b,r,a,c;c=this.iqr(this.latencies.sort(this.ncmp));q=c.length;BOOMR.debug(c,"bw");for(n=1;n<q;n++){i+=c[n];p+=c[n]*c[n];}q--;e=Math.round(i/q);r=Math.sqrt(p/q-i*i/(q*q));a=(1.96*r/Math.sqrt(q)).toFixed(2);r=r.toFixed(2);q=c.length-1;b=Math.round((c[Math.floor(q/2)]+c[Math.ceil(q/2)])/2);return{mean:e,median:b,stddev:r,stderr:a};},calc_bw:function(){var b,c,n=0,H,N=[],i=[],O=0,I=0,D=0,j=0,F,G,E,M,P,e,L,J,K,a,r;for(b=0;b<this.nruns;b++){if(!this.results[b]||!this.results[b].r){continue;}H=this.results[b].r;K=0;for(c=H.length-1;c>=0&&K<3;c--){if(typeof H[c]==="undefined"){break;}if(H[c].t===null){continue;}n++;K++;a=f[c].size*1000/H[c].t;N.push(a);r=f[c].size*1000/(H[c].t-this.latency.mean);i.push(r);}}BOOMR.debug("got "+n+" readings","bw");BOOMR.debug("bandwidths: "+N,"bw");BOOMR.debug("corrected: "+i,"bw");if(N.length>3){N=this.iqr(N.sort(this.ncmp));i=this.iqr(i.sort(this.ncmp));}else{N=N.sort(this.ncmp);i=i.sort(this.ncmp);}BOOMR.debug("after iqr: "+N,"bw");BOOMR.debug("corrected: "+i,"bw");n=Math.max(N.length,i.length);for(b=0;b<n;b++){if(b<N.length){O+=N[b];I+=Math.pow(N[b],2);}if(b<i.length){D+=i[b];j+=Math.pow(i[b],2);}}n=N.length;F=Math.round(O/n);G=Math.sqrt(I/n-Math.pow(O/n,2));E=Math.round(1.96*G/Math.sqrt(n));G=Math.round(G);n=N.length-1;M=Math.round((N[Math.floor(n/2)]+N[Math.ceil(n/2)])/2);n=i.length;P=Math.round(D/n);e=Math.sqrt(j/n-Math.pow(D/n,2));L=(1.96*e/Math.sqrt(n)).toFixed(2);e=e.toFixed(2);n=i.length-1;J=Math.round((i[Math.floor(n/2)]+i[Math.ceil(n/2)])/2);BOOMR.debug("amean: "+F+", median: "+M,"bw");BOOMR.debug("corrected amean: "+P+", "+"median: "+J,"bw");return{mean:F,stddev:G,stderr:E,median:M,mean_corrected:P,stddev_corrected:e,stderr_corrected:L,median_corrected:J};},defer:function(a){var b=this;return setTimeout(function(){a.call(b);b=null;},10);},load_img:function(n,c,a){var o=this.base_url+f[n].name+"?t="+(new Date().getTime())+Math.random(),b=0,e=0,p=new Image(),i=this;p.onload=function(){p.onload=p.onerror=null;p=null;clearTimeout(b);if(a){a.call(i,n,e,c,true);}i=a=null;};p.onerror=function(){p.onload=p.onerror=null;p=null;clearTimeout(b);if(a){a.call(i,n,e,c,false);}i=a=null;};b=setTimeout(function(){if(a){a.call(i,n,e,c,null);}},f[n].timeout+Math.min(400,this.latency?this.latency.mean:400));e=new Date().getTime();p.src=o;},lat_loaded:function(i,e,b,a){if(b!==this.latency_runs+1){return;}if(a!==null){var c=new Date().getTime()-e;this.latencies.push(c);}if(this.latency_runs===0){this.latency=this.calc_latency();}this.defer(this.iterate);},img_loaded:function(e,c,b,a){if(b!==this.runs_left+1){return;}if(this.results[this.nruns-b].r[e]){return;}if(a===null){this.results[this.nruns-b].r[e+1]={t:null,state:null,run:b};return;}var i={start:c,end:new Date().getTime(),t:null,state:a,run:b};if(a){i.t=i.end-i.start;}this.results[this.nruns-b].r[e]=i;if(e>=f.end-1||typeof this.results[this.nruns-b].r[e+1]!=="undefined"){BOOMR.debug(this.results[this.nruns-b],"bw");if(b===this.nruns){f.start=e;}this.defer(this.iterate);}else{this.load_img(e+1,b,this.img_loaded);}},finish:function(){if(!this.latency){this.latency=this.calc_latency();}var a=this.calc_bw(),b={bw:a.median_corrected,bw_err:parseFloat(a.stderr_corrected,10),lat:this.latency.mean,lat_err:parseFloat(this.latency.stderr,10),bw_time:Math.round(new Date().getTime()/1000)};BOOMR.addVar(b);if(!isNaN(b.bw)){BOOMR.utils.setCookie(this.cookie,{ba:Math.round(b.bw),be:b.bw_err,l:b.lat,le:b.lat_err,ip:this.user_ip,t:b.bw_time},(this.user_ip?this.cookie_exp:0),"/",null);}this.complete=true;BOOMR.sendBeacon();this.running=false;},iterate:function(){if(this.aborted){return false;}if(!this.runs_left){this.finish();}else{if(this.latency_runs){this.load_img("l",this.latency_runs--,this.lat_loaded);}else{this.results.push({r:[]});this.load_img(f.start,this.runs_left--,this.img_loaded);}}},setVarsFromCookie:function(b){var n=parseInt(b.ba,10),c=parseFloat(b.be,10),e=parseInt(b.l,10)||0,q=parseFloat(b.le,10)||0,r=b.ip.replace(/\.\d+$/,"0"),a=parseInt(b.t,10),o=this.user_ip.replace(/\.\d+$/,"0"),p=Math.round((new Date().getTime())/1000);if(r===o&&a>=p-this.cookie_exp){this.complete=true;BOOMR.addVar({"bw":n,"lat":e,"bw_err":c,"lat_err":q});return true;}return false;}};BOOMR.plugins.BW={init:function(b){var a;BOOMR.utils.pluginConfig(h,b,"BW",["base_url","timeout","nruns","cookie","cookie_exp"]);if(b&&b.user_ip){h.user_ip=b.user_ip;}f.start=0;h.runs_left=h.nruns;h.latency_runs=10;h.results=[];h.latencies=[];h.latency=null;h.complete=false;h.aborted=false;BOOMR.removeVar("ba","ba_err","lat","lat_err");a=BOOMR.utils.getSubCookies(BOOMR.utils.getCookie(h.cookie));if(!a||!a.ba||!h.setVarsFromCookie(a)){BOOMR.subscribe("page_ready",this.run,null,this);}return this;},run:function(){if(h.running||h.complete){return this;}if(d.location.protocol==="https:"){BOOMR.info("HTTPS detected, skipping bandwidth test","bw");h.complete=true;return this;}h.running=true;setTimeout(this.abort,h.timeout);h.defer(h.iterate);return this;},abort:function(){h.aborted=true;if(h.running){h.finish();}return this;},is_complete:function(){return h.complete;}};}(window));(function(d){BOOMR=BOOMR||{};BOOMR.plugins=BOOMR.plugins||{};var c={complete:false,done:function(){var a,h,b,g;a=d.performance||d.msPerformance||d.webkitPerformance||d.mozPerformance;if(a&&a.timing&&a.navigation){BOOMR.info("This user agent supports NavigationTiming.","nt");h=d.performance.navigation;b=d.performance.timing;g={nt_red_cnt:h.redirectCount,nt_nav_type:h.type,nt_nav_st:b.navigationStart,nt_red_st:b.redirectStart,nt_red_end:b.redirectEnd,nt_fet_st:b.fetchStart,nt_dns_st:b.domainLookupStart,nt_dns_end:b.domainLookupEnd,nt_con_st:b.connectStart,nt_con_end:b.connectEnd,nt_req_st:b.requestStart,nt_res_st:b.responseStart,nt_res_end:b.responseEnd,nt_domloading:b.domLoading,nt_domint:b.domInteractive,nt_domcontloaded:b.domContentLoaded,nt_domcomp:b.domComplete,nt_load_st:b.loadEventStart,nt_load_end:b.loadEventEnd,nt_unload_st:b.unloadEventStart,nt_unload_end:b.unloadEventEnd};if(b.secureConnectionStart){g.nt_ssl_st=b.secureConnectionStart;}BOOMR.addVar(g);}this.complete=true;BOOMR.sendBeacon();}};BOOMR.plugins.NavigationTiming={init:function(){BOOMR.subscribe("page_ready",c.done,null,c);return this;},is_complete:function(){return c.complete;}};}(window));