var Debug=(function(){var methods=['log','debug','info','warn','error','assert','dir','dirxml','group','groupEnd','time','timeEnd','count','trace','profile','profileEnd'];function initialize(){if(!window.console){window.console={}}for(var i=0;i<methods.length;++i){if(!window.console[methods[i]]){window.console[methods[i]]=function(){}}}}return{initialize:initialize}})();Debug.initialize();
function _(s){return gettext(s)}function gettext(s){if(typeof(L10N)!='undefined'&&L10N[s]){return L10N[s]}return s}function ngettext(s,p,n){if(n!=1)return gettext(p);return gettext(s)}function sprintf(s){var bits=s.split('%');var out=bits[0];var re=/^([ds])(.*)$/;for(var i=1;i<bits.length;i++){p=re.exec(bits[i]);if(!p||arguments[i]==null)continue;if(p[1]=='d'){out+=parseInt(arguments[i],10)}else if(p[1]=='s'){out+=arguments[i]}out+=p[2]}return out}
var Bootstrap=(function(){var isReady=false;var Hooks={onloadhooks:[],onloadmodalhooks:[]};function onloadRegister(func){if(isReady){func();return}Hooks.onloadhooks.push(func)}function onloadmodalRegister(func){Hooks.onloadmodalhooks.push(func)}function runHooks(hook){isReady=true;for(var i=0,h=Hooks[hook],l=h.length;i<l;++i){h[i]()}Hooks[hook]=null}return{onloadRegister:onloadRegister,onloadmodalRegister:onloadmodalRegister,runHooks:runHooks}})();if(window.goog){goog.events.listen(window,'load',function(){Bootstrap.runHooks('onloadhooks')});goog.events.listen(window,'lightview:loaded',function(){Bootstrap.runHooks('onloadmodalhooks')})}else if(window.Prototype){document.observe('dom:loaded',function(){Bootstrap.runHooks('onloadhooks')});document.observe('lightview:loaded',function(){Bootstrap.runHooks('onloadmodalhooks')})}else{window.addEventListener('load',function(){Bootstrap.runHooks('onloadhooks')});window.addEventListener('lightview:loaded',function(){Bootstrap.runHooks('onloadmodalhooks')})}try{document.execCommand("BackgroundImageCache",false,true)}catch(err){}
var Zoosk=(function(){var session,referrer=null;function initialize(_session,_infoFlirtsReferrer){if(_session){session=_session}if(_infoFlirtsReferrer){referrer=_infoFlirtsReferrer}if(cupid.$(document.body).select){var inputs=cupid.$(document.body).select('input.text','input.password','textarea');if(inputs){for(var i=0,l=inputs.length;i<l;++i){inputs[i].observe('focus',toggleFormField).observe('blur',toggleFormField)}}}cupid.popManager=cupid.pop.Manager.getInstance();cupid.triggerManagers={}}function registerPop(element,triggers,isPopNow){element=cupid.$(element);if(!element){return}Bootstrap.onloadRegister(function(){var popover=cupid.popManager.create(element);if(triggers){popover.addTriggers(triggers)}if(isPopNow){popover.pop()}})}function addPopTriggers(popover,triggers){triggers=cupid.normalizeTriggers(triggers);for(var eventType in triggers){if(!(eventType in cupid.triggerManagers)){cupid.triggerManagers[eventType]=new cupid.TriggerManager(2).listenTo(document,eventType)}cupid.triggerManagers[eventType].addTrigger(triggers[eventType],popover.pop,popover)}}function getSession(){return session}function getReferrer(){return referrer}function toggleFormField(e){switch(e.type){case'focus':this.addClassName('active');break;case'blur':this.removeClassName('active');break}}return{IEVersion:(function(a){var b=new RegExp("MSIE ([\\d.]+)").exec(a);return b?parseFloat(b[1]):-1})(navigator.userAgent),initialize:initialize,getSession:getSession,getReferrer:getReferrer,registerPop:registerPop,addPopTriggers:addPopTriggers}})();Zoosk.Platform=(function(){function initialize(args){if(!args)return;Zoosk.Platform.platformName=args.platformName;Zoosk.Platform.providerName=args.providerName;if(args.fx){for(var i=0;i<args.fx.length;i++){var platform=args.fx[i];if(!platform)continue;Zoosk[platform.name].initialize(platform.name)}}}return{initialize:initialize,getPlatformName:null,providerName:null}})();var Page={};try{document.execCommand("BackgroundImageCache",false,true)}catch(err){}
Event.delegate=(function(){function createRules(rules){var cache={};for(var behavior in rules){if(!cache[behavior]){cache[behavior]=Object.extend([],{selector:new Selector(behavior)})}cache[behavior].push(rules[behavior])}return cache}return function(rules){rules=createRules(rules);return function(e){var element=e.target;do{if(element.nodeType==1){for(var behavior in rules){if((rules[behavior].selector).match(element)){Object.extend(e,{trigger:element});for(var i=0,handlers=rules[behavior],l=handlers.length;i<l;++i){handlers[i].call(this,e)}}}}}while((element!=this)&&(element=element.parentNode))}}})();Ajax.Responders.register((function(){function callInProgress(xmlhttp){switch(xmlhttp.readyState){case 1:case 2:case 3:return true;break;default:return false;break}}function onCreate(request){request['timeoutId']=setTimeout(function(){if(callInProgress(request.transport)){request.transport.abort();if(request.options['onFailure']){request.options['onFailure'](request.transport,request.json)}}},60000)}function onComplete(request){clearTimeout(request['timeoutId'])}return{onCreate:onCreate,onComplete:onComplete}})());Zoosk.Request=Class.create((function(){function successWrapper(success,transport){if(transport.getHeader('Content-Type')=='application/javascript'){return}success(transport)}function initialize(url){var options=arguments[1]||{};var addParams=[];var session=Zoosk.getSession(true);if(session){addParams.push(session)}var referrer=Zoosk.getReferrer();if(referrer){addParams.push('ifr='+referrer)}if(addParams.length){if(url.lastIndexOf('?')==-1){url+='?'+addParams.join('&')}else{url+='&'+addParams.join('&')}}if(options.onSuccess){options.onSuccess=options.onSuccess.wrap(successWrapper)}new Ajax.Request(url,options)}return{initialize:initialize}})());
var Utilities={Focup:function(){this.Focus('focup');if(window==window.top){window.scrollTo(0,0)}},Focus:function(target){var focup=$(target);if(focup){focup.focus();focup.blur()}},StopEvent:function(e){e.stop()},Blur:function(e){this.blur()},ThreadSafeRemove:function(el){el=$(el);if(el.parentNode){el.remove()}},ThreadSafeReplace:function(el,content){el=$(el);if(el.parentNode){el.replace(content)}},Replace:function(el,html){var oldEl=typeof el==="string"?document.getElementById(el):el;if(Prototype.Browser.IE){oldEl.innerHTML=html;return oldEl}var newEl=oldEl.cloneNode(false);newEl.innerHTML=html;oldEl.parentNode.replaceChild(newEl,oldEl);return newEl},GetTimestamp:function(){return Math.round(new Date().getTime()/1000.0)},UpdateHeaderCoins:function(newBalance,_isPulsate){var coinsEl=$('header-coin-balance');if(!coinsEl){return}coinsEl.innerHTML=newBalance;if(_isPulsate){Effect.Pulsate(coinsEl,{pulses:5,duration:2.5});Effect.ScrollTo(coinsEl)}},ModifyHeaderCoins:function(diff,_polarity,_isPulsate){if(!diff){return}if(_polarity&&_polarity>0){_polarity=1}else{_polarity=-1}Utilities.UpdateHeaderCoins(Utilities.GetNumCoins()+(_polarity*diff),_isPulsate)},GetNumCoins:function(){var coinsEl=$('header-coin-balance');if(!coinsEl){return 0}return parseInt(coinsEl.innerHTML)},Extend:function(child,methods){var property,value;for(property in methods){value=methods[property];if(!(property in child)&&Object.isFunction(value)&&property!='extend'){child[property]=value.methodize()}}return child}};
var Validation={};Validation.Element={extend:function(element){Utilities.Extend(element,Validation.Element);element.label=null;element.errs=null;element.lastVal=null;element.lastErr=null;element.validators=[];return element},attachValidators:function(element,labelElement,errListElement,validators){element.label=labelElement;element.errs=errListElement.select('li');element.validators=validators;if(Object.isElement(element)){if(element.tagName=='SELECT'){element.observe('change',Validation.Events.Element.validate)}else{element.observe('focus',element.hideErr).observe('blur',Validation.Events.Element.validate)}}else if(Object.isArray(element)){var boundFocus=element.hideErr.bind(element);var boundBlur=Validation.Events.Element.validate.bind(element);for(var i=0,l=element.length;i<l;++i){element[i].observe('focus',boundFocus).observe('blur',boundBlur)}}return element},validate:function(element){var result=-1;for(var i=0;i<element.validators.length;++i){if(!element.validators[i](element)){result=i;break}}if(result===-1){return true}element.lastVal=element.validators[result];element.lastErr=element.errs[result];return false},showErr:function(element){if(!Object.isElement(element.lastErr)){return}if(Object.isElement(element)){element.addClassName('form_error')}if(element.label){element.label.addClassName('form_error')}element.lastErr.show();return element},hideErr:function(element){if(Object.isElement(element)){element.removeClassName('form_error')}if(element.label){element.label.removeClassName('form_error')}element.errs.invoke('hide');return element},validationFailed:function(element,validatorOffset){var msgEl=element.errs[validatorOffset];element.lastErr=msgEl;element.showErr();if(window.top==window){(function(){var offset=-1*Math.round(document.viewport.getHeight()/3);Effect.Pulsate(msgEl)}).defer()}else{(function(){msgEl.show();Effect.Pulsate(msgEl)}).defer()}return element}};Validation.Form={extend:function(element){Utilities.Extend(element,Validation.Form);element.validators=[];element.firstFail=null;return element},attachElement:function(element,fieldElement){element.validators.push(fieldElement);return element},validate:function(element){var invalidFields=element.validators.invoke('hideErr').reject(Validation.Element.validate).invoke('showErr');if(invalidFields.length==0){return true}element.firstFail=invalidFields[0];return false},focusErr:function(element){element=element.firstFail;if(!element){return}else if(element.fxLock>Utilities.GetTimestamp()){return}var target=Object.isArray(element)?element[0]:element;if(window.top==window){var offset=-1*Math.round(document.viewport.getHeight()/3);var goTo=element.label?element.label.identify():target.identify();Effect.ScrollTo.defer(goTo,{offset:offset})}else{target.focus();target.blur();Validation.Element.showErr.defer(element)}element.fxLock=Utilities.GetTimestamp()+3;var effectElements=[];if(!Object.isArray(element)&&(element.tagName!='TEXTAREA')){effectElements.push(target)}effectElements.push(element.lastErr);Effect.multiple(effectElements,Effect.Pulsate,{speed:0});return element}};Validation.Form.SuggestEmail={extend:function(element,emailField){Validation.Form.extend(element);element.emailField=emailField;element.emailOriginal=emailField.getValue();element.emailSuggestContainer=$('suggest_container');Bootstrap.onloadRegister(function(){$=zsk_$;element.popover=cupid.popManager.create(element.emailSuggestContainer);goog.events.listen(element.popover,cupid.pop.EventType.HIDE_DONE,Validation.Events.Form.SuggestEmail.close.bind(element));$('suggest_container').observe('click',Event.delegate({'.email_suggest':Validation.Events.Form.SuggestEmail.save.bind(element)}))})}};Validation.Events={};Validation.Events.Element={validate:function(e){if(!this.validate()&&(this.lastVal!=Validation.Validators.Required&&this.lastVal!=Validation.Validators.EditHeightRequired)){this.showErr()}else{this.hideErr()}}};Validation.Events.Form={validate:function(e){if(this.validate()){return}e.stop();this.focusErr()}};Validation.Events.Form.SuggestEmail={validate:function(e){e.stop();if(!this.validate()){this.focusErr();return}if(this.emailOriginal==this.emailField.getValue()){this.submit();return}if(this.inAjax===true){return}this.inAjax=true;new Zoosk.Request('/ajax/validate_email.php',{method:'post',parameters:{email:this.emailField.getValue()},onSuccess:Validation.Events.Form.SuggestEmail.callback.bind(this),onFailure:Validation.Events.Form.SuggestEmail.ignore.bind(this)})},callback:function(transport){var response=transport.responseJSON,data=response.data;if(data.code===1){this.submit()}else{this.emailSuggestContainer.update(data.details);this.popover.pop()}},save:function(e){e.stop();this.emailField.value=$F(this.emailSuggestContainer.down('input:checked'));if(this.emailField.getValue().length>0){this.submit()}else{this.validate();this.focusErr();this.popover.hide()}},close:function(){this.inAjax=false},ignore:function(){Validation.Events.Form.SuggestEmail.close.call(this);this.submit()}};Validation.Validators={Required:function(_element){_element.value=$F(_element).strip();return _element.present()&&$F(_element)!='#NA#'},RequiredWithOverride:function(override,_element){if(override()){return true}_element.value=$F(_element).strip();return _element.present()&&$F(_element)!='#NA#'},RequiredRadio:function(_element){return _element.any(function(e){return e.checked})},RequiredFileUpload:function(_element){var value=$F(_element).strip();return value!=''&&$F(_element)!='#NA#'},RequiredCheckbox:function(_element){return _element.checked},RequiredCheckboxGroupWithOverride:function(override,_element){if(override()){return true}for(var i=0;i<_element.length;i++){if(_element[i].checked){return true}}return false},Account:function(_element){var value=$F(_element).strip();_element.value=value;if(!_element.present()){return true}value=value.gsub(/[\s-_.]+/,'');return(Validation.Validators.CCNumType.Default.test(value)||Validation.Validators.CCNumType.Masked.test(value))},Digits:function(_element){var value=$F(_element).strip();_element.value=value;if(!_element.present()){return true}return Validation.Validators.DDNum.Digits.test(value)},DDMasked:function(_element){var value=$F(_element).strip();_element.value=value;if(!_element.present()){return true}return Validation.Validators.DDNum.Masked.test(value)},AlphaNumeric:function(_element){var value=$F(_element).strip();_element.value=value;if(!_element.present()){return true}return Validation.Validators.DDNum.AlphaNumeric.test(value)},AlphaNumericUnicode:function(_element){var value=$F(_element).strip();_element.value=value;return Validation.Validators.AlphaNum.Unicode.test(value)},AlphaNumericWsUnicode:function(_element){var value=$F(_element).strip();_element.value=value;return Validation.Validators.AlphaNum.WsUnicode.test(value)},AlphaNumericWsPunctUnicode:function(_element){var value=$F(_element).strip();_element.value=value;return Validation.Validators.AlphaNum.WsPunctUnicodeUnicode.test(value)},CCNumType:function(_typeField,_maskedDefault,_element){var value=$F(_element).strip();_element.value=value;if(!_element.present()){return true}var cardType=$F(_typeField);if(Validation.Validators.CCNumType.Masked.test(value)){return _maskedDefault==cardType}var passed=true;switch(cardType){case'visa':passed=Validation.Validators.CCNumType.Visa.test(value);break;case'mastercard':passed=Validation.Validators.CCNumType.Mastercard.test(value);break;case'amex':passed=Validation.Validators.CCNumType.Amex.test(value);break;case'discover':passed=Validation.Validators.CCNumType.Discover.test(value);break;case'maestro':passed=Validation.Validators.CCNumType.Maestro.test(value);break;case'solo':passed=Validation.Validators.CCNumType.Solo.test(value);break;case'switch':passed=Validation.Validators.CCNumType.Switch.test(value);break;case'carte_bleue':passed=Validation.Validators.CCNumType.CarteBleue.test(value);break;case'diners':passed=Validation.Validators.CCNumType.DinersClub.test(value);break}return passed},CCNumSpaces:function(_element){var value=$F(_element).strip();return value.indexOf(' ')===-1},Cvv:function(_typeField,_element){var value=$F(_element).strip();var cardType=$F(_typeField);_element.value=value;if(!_element.present()){return true}if(cardType=='amex'){return(/^[0-9]{4}$/).test(value)}return(/^[0-9]{3}$/).test(value)},EditHeightRequired:function(_element){if(!$(_element).up('div').visible()){return true}return Validation.Validators.Required(_element)},MetricHeight:function(_element){if(!$(_element).up('div').visible()){return true}var cmHeight=$F(_element);if(!/[0-9]+/.test(cmHeight)){return false}if(cmHeight<91||cmHeight>241){return false}return true},MaxLength:function(_element){var element=$(_element),elementVal=$F(element),maxlength=element.getAttribute('maxlength');if(!element.maxlength&&maxlength){if(maxlength){element.maxlength=parseInt(maxlength)}}if(!element.maxlength){return true}return elementVal.length<=element.maxlength},MinLength:function(minLength,opt_override,element){var element=$(element);if(opt_override&&opt_override()){return true}return $F(element).length>=minLength},NonDefaultText:function(defaultText,opt_override,element){var element=$(element);defaultText=defaultText.replace(/^\s+|\s+$/g,"");if(opt_override&&opt_override()){return true}return $F(element).replace(/^\s+|\s+$/g,"")!==defaultText},InvalidLengths:function(_element){var element=$(_element),elementVal=$F(element),range=element.getAttribute('invalidlengths');if(!element.invalidLenParams&&range){var match=/(\d+)-(\d+)/.exec(range);if(match[1]&&match[1].length&&match[2]&&match[2].length){var start=parseInt(match[1],10),end=parseInt(match[2],10);element.invalidLenParams={start:start,end:end}}}if(!element.invalidLenParams){return true}return elementVal.length<element.invalidLenParams.start||elementVal.length>element.invalidLenParams.end},Safe:function(_element){_element.value=$F(_element).strip();if(!_element.present()){return true}return $F(_element).search(/^[^!@\[\]\{\}<>?=]+$/i)!=-1},Safe2:function(_element){_element.value=$F(_element).strip();if(!_element.present()){return true}return $F(_element).search(/^[^!@\[\]\{\}\\\"\|\?\*<>&=]+$/i)!=-1},Email:function(_element){_element.value=$F(_element).strip();return $F(_element).search(Validation.Validators.Email.Regex)!=-1},EmailOptional:function(_element){if($F(_element).blank()){return true}return Validation.Validators.Email(_element)},Matches:function(_element){if(!_element.matches){_element.matches=_element.readAttribute('matches')}return($F(_element).strip()==$F(_element.matches).strip())},Noop:function(_element){return true}};Validation.Validators.Email.Regex=/^[a-z0-9_-]+(?:[a-z0-9._%+-]+)*@(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?\.)+(?:[A-Z]{2}|aero|arpa|asia|biz|cat|com|coop|edu|gov|info|int|jobs|mil|mobi|museum|name|net|org|pro|tel|travel)$/i;Validation.Validators.DDNum={};Validation.Validators.DDNum.Digits=/^[0-9\s]+$/;Validation.Validators.DDNum.AlphaNumeric=/^[\s0-9A-Za-z]+$/;Validation.Validators.DDNum.Masked=/^[0-9A-Za-z\*\s]+$/;Validation.Validators.CCNumType.Default=/^[0-9]{13,20}$/;Validation.Validators.CCNumType.Masked=/^\*{9,16}[0-9]{4}$/;Validation.Validators.CCNumType.Visa=/^4[0-9]{12}(?:[0-9]{3})?$/;Validation.Validators.CCNumType.Discover=/^6(?:011|5[0-9]{2})[0-9]{12}$/;Validation.Validators.CCNumType.Mastercard=/^5[1-5][0-9]{14}$/;Validation.Validators.CCNumType.Amex=/^3[47][0-9]{13}$/;Validation.Validators.CCNumType.Maestro=/^[0-9]{13,20}$/;Validation.Validators.CCNumType.Solo=/^[0-9]{13,20}$/;Validation.Validators.CCNumType.Switch=/^[0-9]{13,20}$/;Validation.Validators.CCNumType.CarteBleue=/^[0-9]{13,20}$/;Validation.Validators.CCNumType.DinersClub=/^5[4-5][0-9]{14}$/;Validation.Validators.AlphaNum={};Validation.Validators.AlphaNum._AccentedWestern='\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE';Validation.Validators.AlphaNum.Unicode=new RegExp("^[a-zA-Z0-9"+Validation.Validators.AlphaNum._AccentedWestern+"]+$");Validation.Validators.AlphaNum.WsUnicode=new RegExp("^[\\sa-zA-Z0-9"+Validation.Validators.AlphaNum._AccentedWestern+"]+$");Validation.Validators.AlphaNum.WsPunctUnicode=new RegExp("^[\\sa-zA-Z0-9\\-,.\\'"+Validation.Validators.AlphaNum._AccentedWestern+"]+$");
Zoosk.Form={extend:function(element,submitBtn,_cancelElm,_methods,_eventHandlers){element=$(element);Validation.Form.extend(element);if(!_methods)_methods=Zoosk.Form.Methods;Utilities.Extend(element,_methods);if(!_eventHandlers)_eventHandlers=Zoosk.Form.Events;element.submitBtn=$(submitBtn);Zoosk.Form.Element.SubmitBtn.extend(element.submitBtn);element.observe('submit',_eventHandlers.z_onsubmit);if(_cancelElm){element.cancelElm=$(_cancelElm);Zoosk.Form.Element.CancelElm.extend(element.cancelElm)}Event.observe(window,'unload',_eventHandlers.z_onunload.bind(element));return element}};Zoosk.Form.Methods={addValidator:function(element,fieldName,validators,opt_hasLabelWrap){var field=$(element[fieldName]);if(!Object.isElement(field)){return}Validation.Element.extend(field);if(!!opt_hasLabelWrap){var labelEl=element.getWrappedFieldLabel(field);var errorEl=element.getWrappedFieldErrList(field)}else{var labelEl=element.getFieldLabel(field);var errorEl=element.getFieldErrList(field)}field.attachValidators(labelEl,errorEl,validators);return element.attachElement(field)},addRadioValidator:function(element,fieldName,validators,errors,label){var field=element.select('input[name='+fieldName+']');if(field.length==0)return;errors=$(errors);var label=label?$(label):null;Validation.Element.extend(field);field.attachValidators(label,errors,validators);return element.attachElement(field)},getFieldLabel:function(element,field){return field.up().down('label')},getWrappedFieldLabel:function(element,field){return field.up()},getFieldErrList:function(element,field){return field.next('ul')},getWrappedFieldErrList:function(element,field){return field.up().next('ul')}};Zoosk.Form.Events={z_onsubmit:function(e){Validation.Events.Form.validate.call(this,e);if(!e.stopped){this.submitBtn.z_disable();if(this.cancelElm){this.cancelElm.z_disable()}}},z_onunload:function(e){this.submitBtn.z_enable();if(this.cancelElm){this.cancelElm.z_enable()}}};Zoosk.Form.Element={};Zoosk.Form.Element.SubmitBtn={extend:function(element){$=zsk_$;element=$(element);Utilities.Extend(element,Zoosk.Form.Element.SubmitBtn.Methods);element.oldVal=element.getValue();return element}};Zoosk.Form.Element.CancelElm={extend:function(element){element=$(element);Utilities.Extend(element,Zoosk.Form.Element.CancelElm.Methods)}};Zoosk.Form.Element.SubmitBtn.Methods={z_disable:function(element){element.disable().removeClassName('submit_pref').addClassName('submit_disabled').value=_('please wait...');Zoosk.Form.Element.SubmitBtn.Methods.z_enable.delay(180,element);return element},z_enable:function(element){element.enable().removeClassName('submit_disabled').addClassName('submit_pref').value=element.oldVal;return element}};Zoosk.Form.Element.CancelElm.Methods={z_disable:function(element){element.hide();Zoosk.Form.Element.CancelElm.Methods.z_enable.delay(180,element);return element},z_enable:function(element){element.show();return element}};
Zoosk.Form.Callback={extend:function(element,submitBtn,callback){var events=Object.clone(Zoosk.Form.Events);events.z_onsubmit=events.z_onsubmit.wrap(function(proceed,e){proceed(e);if(e&&!e.stopped){callback(e)}});return Zoosk.Form.extend(element,submitBtn,null,null,events)}};Zoosk.Form.Referral={extend:function(element,submitBtn){return Zoosk.Form.extend(element,submitBtn,null,Zoosk.Form.Referral.Methods)}};Zoosk.Form.Referral.Methods=Object.extend(Object.clone(Zoosk.Form.Methods),{getFieldLabel:function(element,field){return null},getFieldErrList:function(element,field){return $('manual_emails_errs').down('ul')}});Zoosk.Form.EmailSuggestorEvents=Object.extend(Object.clone(Zoosk.Form.Events),{z_onsubmit:function(e){Validation.Events.Form.validate.call(this,e);if(!e.stopped){Validation.Events.Form.SuggestEmail.validate.call(this,e);if(!e.stopped){this.submitBtn.z_disable();if(this.cancelElm){this.cancelElm.z_disable()}}}}});Zoosk.Form.CreditCardFormEvents=Object.extend(Object.clone(Zoosk.Form.Events),(function(){this.isFormSubmitted=false;function z_onsubmit(e){Validation.Events.Form.validate.call(this,e);if(!e.stopped){this.submitBtn.z_disable();e.stop();var itemId=$F($('plans').down("input:checked"));var promoCode=$('pm_promoCode');if(promoCode){promoCode=$F(promoCode)}var storeItemType=$('plans').getAttribute('item_type');var innerLog='';if(!itemId&&$('store_form')){innerLog=$('store_form').innerHTML}new Zoosk.Request('/ajax/confirm_purchase.php',{method:'post',parameters:{item_id:itemId,promo_code:promoCode,inner_log:innerLog,item_type:storeItemType},onSuccess:function(transport){var response=transport.responseJSON;setTimeout(function(){Zoosk.Form.Element.SubmitBtn.Methods.z_enable($('pm_submit'))},1000);if(response.isConfirmed){popConfirmation.call(this,response);return}else if(response.isJustSubmit){if(this.isFormSubmitted)return;this.isFormSubmitted=true;$('store_form').submit();return}popRestriction.call(this,response)},onFailure:function(){if(this.isFormSubmitted)return;this.isFormSubmitted=true;$('store_form').submit()}})}}function popRestriction(response){if(!this.purchaseErrorPop){var popId='purchase_error_pop';var errorDiv=new Element('div',{id:popId,className:'popover rounded restriction-popover'}).setStyle({display:'none'});document.body.appendChild(errorDiv);this.purchaseErrorPop=cupid.popManager.create($(popId))}this.purchaseErrorPop.getWrappedElement().update('<div><h1>'+response.message+'</h1><p>'+response.details+'</p></div>');this.purchaseErrorPop.pop()}function popConfirmation(response){if(!this.purchaseConfirmationPop){var storeABTestClass=!!window.store_ab_test_confirmation_popover?' store-b-test-confirmation':'';var purchaseDiv=new Element('div',{id:'purchase_confirmation_pop',className:'popover rounded'+storeABTestClass}).setStyle({display:'none'});document.body.appendChild(purchaseDiv);this.purchaseConfirmationPop=cupid.popManager.create($('purchase_confirmation_pop'));var ccFormEvents=this;document.observe('click',Event.delegate({'.submit_confirm':function(){if(ccFormEvents.isFormSubmitted)return;ccFormEvents.isFormSubmitted=true;Zoosk.Form.Element.SubmitBtn.Methods.z_disable($('pm_submit'));ccFormEvents.purchaseConfirmationPop.hide();$('store_form').submit()}}))}this.purchaseConfirmationPop.getWrappedElement().update(response.payload);this.purchaseConfirmationPop.pop()}return{z_onsubmit:z_onsubmit}})());Zoosk.Form.DirectDebitFormEvents=Object.extend(Object.clone(Zoosk.Form.Events),(function(){this.isFormSubmitted=false;function z_onsubmit(e){Validation.Events.Form.validate.call(this,e);if(!e.stopped){this.submitBtn.z_disable();e.stop();var itemId=$F($('plans').down("input:checked"));var storeItemType=$('plans').getAttribute('item_type');var ddBankcode=$F($('ddBankcode'));var ddAccountNumber=$F($('ddAccountNumber'));if($F($('HAN'))&&(new RegExp("[\*]+").exec(ddAccountNumber))instanceof Array){ddAccountNumber=$F($('HAN'))}var ddAccountName=$F($('ddAccountName'));var parameters={item_id:itemId,item_type:storeItemType,ddBankcode:ddBankcode,ddAccountNumber:ddAccountNumber,ddAccountName:ddAccountName};var ddBankCheckDigit=$('ddBankCheckDigit');if(ddBankCheckDigit){ddBankCheckDigit=$F(ddBankCheckDigit);parameters['ddBankCheckDigit']=ddBankCheckDigit}var ddBranchcode=$('ddBranchcode');if(ddBranchcode){ddBranchcode=$F(ddBranchcode);parameters['ddBranchcode']=ddBranchcode}var ddFirstName=$('ddFirstName');if(ddFirstName){ddFirstName=$F(ddFirstName);parameters['ddFirstName']=ddFirstName}var ddLastName=$('ddLastName');if(ddLastName){ddLastName=$F(ddLastName);parameters['ddLastName']=ddLastName}var ddStreet=$('ddStreet');if(ddStreet){ddStreet=$F(ddStreet);parameters['ddStreet']=ddStreet}var ddCity=$('ddCity');if(ddCity){ddCity=$F(ddCity);parameters['ddCity']=ddCity}var ddZip=$('ddZip');if(ddZip){ddZip=$F(ddZip);parameters['ddZip']=ddZip}new Zoosk.Request('/ajax/confirm_purchase.php',{method:'post',parameters:parameters,onSuccess:function(transport){var response=transport.responseJSON;setTimeout(function(){Zoosk.Form.Element.SubmitBtn.Methods.z_enable($('pm_submit'))},1000);if(response.isConfirmed){popConfirmation.call(this,response);return}else if(response.isJustSubmit){if(this.isFormSubmitted)return;this.isFormSubmitted=true;$('store_form').submit();return}popRestriction.call(this,response)},onFailure:function(){if(this.isFormSubmitted)return;this.isFormSubmitted=true;$('store_form').submit()}})}}function popRestriction(response){if(!this.purchaseErrorPop){var popId='purchase_error_pop';var errorDiv=new Element('div',{id:popId,className:'popover rounded restriction-popover'}).setStyle({display:'none'});document.body.appendChild(errorDiv);this.purchaseErrorPop=cupid.popManager.create($(popId))}this.purchaseErrorPop.getWrappedElement().update('<div><h1>'+response.message+'</h1><p>'+response.details+'</p></div>');this.purchaseErrorPop.pop()}function popConfirmation(response){if(!this.purchaseConfirmationPop){var storeABTestClass=!!window.store_ab_test_confirmation_popover?' store-b-test-confirmation':'';var purchaseDiv=new Element('div',{id:'purchase_confirmation_pop',className:'popover rounded'+storeABTestClass}).setStyle({display:'none'});document.body.appendChild(purchaseDiv);this.purchaseConfirmationPop=cupid.popManager.create($('purchase_confirmation_pop'));var ccFormEvents=this;document.observe('click',Event.delegate({'.submit_confirm':function(){if(ccFormEvents.isFormSubmitted)return;ccFormEvents.isFormSubmitted=true;Zoosk.Form.Element.SubmitBtn.Methods.z_disable($('pm_submit'));ccFormEvents.purchaseConfirmationPop.hide();$('store_form').submit()}}))}this.purchaseConfirmationPop.getWrappedElement().update(response.payload);this.purchaseConfirmationPop.pop()}return{z_onsubmit:z_onsubmit}})());Zoosk.Form.Ajaxie=Object.extend(Object.clone(Zoosk.Form.Events),(function(){function extend(_element,_onSuccess,_onFailure,_setUp){element=$(_element);element.method=element.getAttribute('method');element.ajaxUrl=element.getAttribute('ajax_action');element.onSuccess=_onSuccess;element.onFailure=_onFailure;element.setUp=_setUp;return this}function z_onsubmit(e){var form=e.element();Validation.Events.Form.validate.call(this,e);if(!e.stopped){e.stop();var contentDiv=form.up('div');if(form.setUp){form.setUp(contentDiv)}new Zoosk.Request(form.ajaxUrl,{method:form.method,parameters:form.serialize(true),onSuccess:function(transport){form.onSuccess(transport,contentDiv)},onFailure:function(){form.onFailure(contentDiv)}})}}return{extend:extend,z_onsubmit:z_onsubmit}})());Zoosk.SelectableText=(function(){var element;function extend(element){this.element=$(element);this.element.observe('focus',highlightText.bind(this))}function highlightText(e){e.stop();if(this.element.selectionEnd-this.element.selectionStart>0){return}var thisElement=this.element;setTimeout(function(){thisElement.select()},50)}return{extend:extend}})();Zoosk.DefaultText=(function(){var element;var defaultText;function extend(element,defaultText){this.element=$(element);this.defaultText=defaultText.replace(/^\s+|\s+$/g,"");this.element.observe('click',removeDefaultText.bind(this)).observe('blur',restoreDefaultText.bind(this))}function removeDefaultText(e){if(this.element.value==this.defaultText){this.element.value=''}}function restoreDefaultText(e){if(this.element.value==''){this.element.value=this.defaultText}}return{extend:extend}})();Zoosk.TextCharCounter=(function(){function extend(element,displayElement,maxText,errorClass,enclosingElement){element=$(element);displayElement=$(displayElement);enclosingElement=$(enclosingElement);var maxTextByTwo=maxText/2;var timer;var boundCount=function(){count(element,displayElement,maxText,errorClass,enclosingElement,maxTextByTwo)};element.observe('focus',function(){timer=setInterval(boundCount,250)}).observe('blur',function(){clearInterval(timer);boundCount()});return element}function count(element,displayElement,maxText,errorClass,enclosingElement,maxTextByTwo){var textValue=$F(element);var textLength=textValue.length;if(textLength<maxTextByTwo){if(enclosingElement.visible()){enclosingElement.hide()}return}var charsLeft=maxText-textLength;if(charsLeft<0){displayElement.update(Math.abs(charsLeft)+_(' characters too long, please shorten.'))}else{displayElement.update(charsLeft+_(' characters remaining.'))}displayElement[(textLength>maxText?'add':'remove')+'ClassName'](errorClass);if(!enclosingElement.visible()){enclosingElement.show()}}return{extend:extend}})();
var Control={};
var FbReview=Class.create(function(){function initialize(_element){this.element=$(_element);this.addBehaviors()}function addBehaviors(){this.element.observe('click',Event.delegate({'.send_analytics':sendAnalytics.bindAsEventListener(this)}))}function sendAnalytics(e){if(!pageTracker)return;e.stop();var analytics=e.element().up('.analytics');var pageName=analytics.getAttribute('page_name');var reviewUrl=analytics.getAttribute('review_url');if(!pageName)return;pageTracker._trackPageview(pageName);(function(){window.top.location=reviewUrl}).delay(2)}return{initialize:initialize,addBehaviors:addBehaviors}}());
Page.WinkAutoReply=Class.create((function(){var popover=null;var popContainer=null;var exception=null;function initialize(popElementId,formElementId,textAreaName,textAreaId,formSubmitId,exceptionId,popoverName){this.popContainer=$(popElementId);this.exception=$(exceptionId);this.popover=cupid.popManager.create(this.popContainer);cupid.ga.track(this.popover,cupid.pop.EventType.SHOW,'popover.pop',popoverName);this.popover.pop();var ajaxieAutoWinkReply=Zoosk.Form.Ajaxie.extend(formElementId,onSuccess.bind(this),onFailure.bind(this),setUp.bind(this));var autoWinkReplyForm=Zoosk.Form.extend(formElementId,formSubmitId,null,null,ajaxieAutoWinkReply);var validatorsArr=[Validation.Validators.Required,Validation.Validators.MaxLength];Zoosk.SelectableText.extend(textAreaId);autoWinkReplyForm.addValidator(textAreaName,validatorsArr)}function onFailure(contentDiv){this.popover.hide()}function onSuccess(transport,contentDiv){var response=transport.responseJSON;if(response.exception){this.exception.update(response.exception);return}this.popContainer.update(response.payload);var thisWink=this;setTimeout(function(){thisWink.popover.hide()},2000)}function setUp(contentDiv){this.exception.update('')}return{initialize:initialize}})());