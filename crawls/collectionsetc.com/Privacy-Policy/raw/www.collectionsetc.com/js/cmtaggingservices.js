var G_PS_DEBUG_MODE=2;var G_PS_ARR_DOMAIN=new Array("collectionsetc.com");var G_PS_URL_PATH=""+document.location.href.toLowerCase();var G_PS_PATHNAME=document.location.pathname.toLowerCase();var G_PS_QUERYSTRING=document.location.search.toLowerCase();var G_PS_URL_REFERRER=document.referrer.toLowerCase();var G_PS_COOKIE_LIFETIME=432000;var G_PS_COOKIE_PROD_CATID="PS_PROD_CATID";var G_PS_COOKIE_PROD_CATID_TEMP="PS_PROD_CATID_TEMP";var G_PS_COOKIE_PROFILE="PS_PROFILE";var G_PS_COOKIE_FLAG="PS_FLAG";if(psGetDomain(G_PS_URL_PATH).search(/collectionsetc\.com/gi)>-1){if(psGetValueFromCookie(G_PS_COOKIE_FLAG,"flag_account")=="login"&&psIsLoginSuccess()){psPostRegistrationTag();}psInitialFunctions();if(psGetDomain(G_PS_URL_PATH).search(/www\.collectionsetc\.com/gi)<0&&psGetDomain(G_PS_URL_PATH).search(/([^\/\.]+)\.collectionsetc\.com/gi)>-1){pCatId=RegExp.$1;psSetValueToCookie(G_PS_COOKIE_FLAG,"$ProList",pCatId);if(G_PS_PATHNAME.search(/^(\/?|index.aspx)$/gi)>-1){psCreatePageviewTag("Home",pCatId,null,null);}else{psCreatePageviewTag(G_PS_PATHNAME,pCatId,null,null);}}else{if(G_PS_PATHNAME.search(/^(\/?|index\.aspx)$/gi)>-1){psCreatePageviewTag("Home Page","Home Page",null,null);}else{if(G_PS_PATHNAME.search(/^\/SiteIsBusy\.aspx/gi)>-1){psCreatePageviewTag("SITE IS BUSY","SITE IS BUSY",null,null);psDeleteKey_Value(G_PS_COOKIE_FLAG,"flag_account");}else{if(G_PS_PATHNAME.search(/^\/popup\_lgview\.aspx/gi)>-1){psCreatePageviewTag("View Image","View Image",null,null);}else{if(G_PS_PATHNAME.search(/^\/powerreviews\/review\.aspx/gi)>-1){psCreatePageviewTag("Write a review of product","Write a review of product",null,null);psSetValueToCookie(G_PS_COOKIE_FLAG,"$ProList","Write a review of product");}else{if(G_PS_PATHNAME.search(/^\/orderDisplayPaymentStatus.aspx/gi)>-1){psCreatePageviewTag("Order Processing","CHECKOUT",null,null);}else{if(G_PS_PATHNAME.search(/^\/orderprocesspayment.aspx/gi)>-1){psCreatePageviewTag("Order Process Payment","CHECKOUT",null,null);}else{if(G_PS_PATHNAME.search(/^\/orderReceipt\.aspx/gi)>-1){psCreatePageviewTag("Print Order "+psGetValueFromUrl(G_PS_URL_PATH,"ShoppingCartID"),"Print Order",null,null);}else{if(G_PS_PATHNAME.search(/\/search\.aspx/gi)>-1){psPostSearchView();psHijackRecommend();}else{if(psIsProductView()){psPostProductView();}else{if(psIsEnsembleView()){psPostEnsembleView();}else{if(G_PS_PATHNAME.search(/^\/shopCart\.aspx/gi)>-1){psPostCartView();}else{if(G_PS_PATHNAME.search(/^\/(checkoutoption|billinginfo|AddressVerification|orderPayment)\.aspx/gi)>-1){psPostCheckOutView();}else{if(G_PS_PATHNAME.search(/^\/orderConfirmation\.aspx/gi)>-1){psPostOrderView();}else{if(psCheckArrayExist(psGetElementsByClassName(document,"div","BreadCrumbs"))){pPageId=pCatId=psGetValueFromBreadCrumb("last");if(pPageId.search(/Catalog\s*Quick\s*Order/gi)>-1){psSetCookie(G_PS_COOKIE_PROD_CATID_TEMP,"","delete");if(psCheckArrayExist(pTdOrder=psGetElementsByClassName(document,"td","BorderLeft BorderTop"))){if(psCheckArrayExist(pTableOrder=pTdOrder[0].getElementsByTagName("table"))){if(psCheckElementExist(pButton=document.getElementById("ctl00_ContentPlaceHolder1_btnAddToCart"))){psHijackAddToCartQuickOrder(pTableOrder[0],pTableOrder[0],pCatId,"onkeypress");psHijackAddToCartQuickOrder(pButton,pTableOrder[0],pCatId,"onclick");}}}}else{if(pPageId.search(/Preferred\s*Customer\s*Account\s*Update/gi)>-1){pCatId="My Account";if(psIsErrorOnPage()){psDeleteKey_Value(G_PS_COOKIE_FLAG,"flag_account");}if(document.body.innerHTML.search(/Thank\s+you\s+for\s+registering/i)>=0||psIsLoginSuccess()){if(psGetValueFromCookie(G_PS_COOKIE_FLAG,"flag_account")=="register"){psPostRegistrationTag();}if(document.body.innerHTML.search(/Thank\s+you\s+for\s+updating\s+your\s+profile/gi)>=0){if(psGetValueFromCookie(G_PS_COOKIE_FLAG,"flag_account")=="update"){psUpdateSubscribe();psPostUpdateProfile();}pPageId="Preferred Customer Account Update Successful";}else{psHijackAccGeneral("ctl00_ContentPlaceHolder1_btnRegister",psHijackUpdateProf);}}}else{if(pPageId.search(/Survey\s*Response/gi)>-1){pCatId="My Account";if(psCheckElementExist(document.getElementById("ctl00_ContentPlaceHolder1_btnSubmit"))){psHijackAccGeneral("ctl00_ContentPlaceHolder1_btnSubmit",psSetRegAttrbToCookie);}else{psUpdateSubscribe();pPageId="SURVEY RESPONSE CHANGED";}}else{if(psCheckArrayExist(p2ndBread=psGetValueFromBreadCrumb("2nd"))&&p2ndBread.search(/(Preferred\s*Customer\s*Registration|Log\s*In\s*or\s*Register|Customer\s*Service\/Help)/gi)>-1){if(p2ndBread.search(/Preferred\s*Customer\s*Registration/gi)>-1){pCatId="My Account";psDeleteKey_Value(G_PS_COOKIE_FLAG,"flag_account");pPageId="Preferred Customer Registration";psHijackAccGeneral("ctl00_ContentPlaceHolder1_btnRegister",psHijackRegister);}else{if(p2ndBread.search(/(Log\s*In\s*or\s*Register)/gi)>-1){pCatId="My Account";if(!psIsLoginSuccess()){if(psIsErrorOnPage()){psDeleteKey_Value(G_PS_COOKIE_FLAG,"flag_account");}psHijackAccGeneral("ctl00_ContentPlaceHolder1_btnLogin",psHijackLogIn);}else{pPageId=pCatId;}}else{pCatId=p2ndBread;}}}else{if(psCheckArrayExist(p2ndBread=psGetValueFromBreadCrumb("2nd"))&&p2ndBread.search(/(My\s*Account)/gi)>-1){pCatId=p2ndBread;if(psIsEqual(pPageId,"My Favorites")){if(psCheckArrayExist(pShop5=psGetValueFromCookie(G_PS_COOKIE_FLAG,"$MoveToCart"))&&psCheckArrayExist(pMessage=psGetElementValueById("ctl00_ContentPlaceHolder1_lblActionMessage"))){if(pMessage.search(/\#(\d+)\s*/gi)>-1){pProdId=psCleanPrice(RegExp.$1);}var pShop5List=pShop5.split("|");for(s=0;s<pShop5List.length;s++){if(psCheckArrayExist(pShop5List[s])){pShop5=pShop5List[s].split("-_-");if(psIsEqual(pShop5[0],pProdId)){psCreateShopAction5Tag(pShop5[0],pShop5[1],1,pShop5[2],pShop5[3]);psDisplayShop5s();psSetValueToCookie(G_PS_COOKIE_PROD_CATID,pShop5[0],pCatId);psSetCookie(G_PS_COOKIE_FLAG,"","delete");break;}}}}psSetCookie(G_PS_COOKIE_FLAG,"","delete");psSetValueToCookie(G_PS_COOKIE_FLAG,"$ProList",pCatId);if(psCheckArrayExist(pDiv=document.getElementsByTagName("div"))){var k=1;for(i=0;i<pDiv.length;i++){if(psIsEqual(pDiv[i].id,"CartItem")||psIsEqual(pDiv[i].id,"CartAltItem")){if(psCheckElementExist(pMove=document.getElementById("ctl00_ContentPlaceHolder1_repCart_ctl0"+k+"_lbMove"))){psHijackMoveToCart(pMove,k,pCatId);}k++;}}}}else{if(pPageId.search(/My\s*Account/gi)>-1){if(!psIsLoginSuccess()){if(psIsErrorOnPage()){psDeleteKey_Value(G_PS_COOKIE_FLAG,"flag_account");}psHijackAccGeneral("ctl00_ContentPlaceHolder1_btnLogin",psHijackLogIn);}}}}else{if(psCheckArrayExist(pLastBread=psGetValueFromBreadCrumb("last"))&&pLastBread.search(/(Order\s*List|Order\s*Status)/gi)>-1){pCatId="My Account";pPageId=psCheckArrayExist(pOrderNum=psGetValueFromUrl(G_PS_URL_PATH,"txtOrderNumber"))?RegExp.$1+":"+pOrderNum:RegExp.$1;}else{if(psCheckElementExist(document.getElementById("thumbnail_table"))){pCatId=psGetCatIdForProductFromURL(G_PS_PATHNAME);if(psCheckArrayExist(pLastBread=psGetValueFromBreadCrumb("last"))&&psIsEqual(pLastBread,"Home Page")){pPageId=pCatId;}if(psCheckArrayExist(p3rdBread=psGetValueFromBreadCrumb("3rd"))&&psCheckArrayExist(p2ndBread=psGetValueFromBreadCrumb("2nd"))){if(!psIsCategory(p2ndBread,p3rdBread)){pPageId=p2ndBread+"-_-"+psGetValueFromBreadCrumb("last");}}if(psCheckArrayExist(p2ndBread=psGetValueFromBreadCrumb("2nd"))&&p2ndBread.search(/(New|Sale)/gi)>-1&&psCheckArrayExist(pLastBread=psGetValueFromBreadCrumb("last"))&&!psIsEqual(pLastBread,p2ndBread)){if(psIsCategory(p2ndBread,psGetValueFromBreadCrumb("3rd"))){pPageId=psGetValueFromBreadCrumb("2nd")+": "+psGetValueFromBreadCrumb("last");}else{pPageId=psGetValueFromBreadCrumb("2nd")+"-_-"+psGetValueFromBreadCrumb("last");}}if(psCheckArrayExist(pPageList=psGetElementsByClassName(document,"div","PageList"))&&pPageList.length>1){var pPageNum=psGetElementsByClassName(pPageList[1],"li","page_link active");pPageNum=psCheckArrayExist(pPageNum)?pPageNum:psGetElementsByClassName(pPageList[1],"li","page_link first active");if(psCheckArrayExist(pPageNum)&&psTrim(pPageNum[0].innerHTML)>1){pPageId+=" PAGE "+psTrim(pPageNum[0].innerHTML);}}psSetValueToCookie(G_PS_COOKIE_FLAG,"$ProList",pCatId);if(psCheckElementExist(pTdSale=document.getElementById("product_info_td"))){if(psCheckArrayExist(pImgButton=psGetElementsByClassName(pTdSale,"img","button"))){if(psCheckArrayExist(pIdField=psGetElementsByClassName(pTdSale,"td","GreyTextDark B"))){pImgButton[pImgButton.length-1].oldFunc=pImgButton[pImgButton.length-1].onclick;pImgButton[pImgButton.length-1].onclick=function(){psSetValueToCookie(G_PS_COOKIE_PROD_CATID,psCleanValue(pIdField[0].innerHTML).replace("#",""),pCatId);if(this.oldFunc!=null){return this.oldFunc();}};}}}if(psCheckElementExist(pTableFeatured=document.getElementById("featured_images"))){if(psCheckArrayExist(pATag=pTableFeatured.getElementsByTagName("a"))){for(i=0;i<pATag.length;i++){psHijackToSetCookie(pATag[i],"$ProList","Featured Items");}}}}}}}}}}psCreatePageviewTag(pPageId,pCatId,null,null);}else{if(G_PS_PATHNAME.search(/\/([^\/\.]+)\.aspx/gi)>-1){psCreatePageviewTag(RegExp.$1,RegExp.$1,null,null);psSetValueToCookie(G_PS_COOKIE_FLAG,"$ProList",RegExp.$1);}else{psCreatePageviewTag(G_PS_PATHNAME,"ADD URL",null,null);}}}}}}}}}}}}}}}}}function psIsProductView(){return psCheckElementExist(document.getElementById("ProductMain"));}function psIsEnsembleView(){return psCheckElementExist(document.getElementById("ens"));}function psIsCategory(pCatName,pSubName){if(psCheckArrayExist(pMenu=psGetElementsByClassName(document,"div","menu"))){for(i=0;i<pMenu.length;i++){var pATag=psGetElementsByClassName(pMenu[i],"a","navLink navLinkSelected ");pATag=psCheckArrayExist(pATag)?pATag:psGetElementsByClassName(pMenu[i],"a","navLinkWhite ");pATag=psCheckArrayExist(pATag)?pATag:psGetElementsByClassName(pMenu[i],"a","navLink ");pATag=psCheckArrayExist(pATag)?pATag:psGetElementsByClassName(pMenu[i],"a","navLinkWhite navLinkSelected ");if(psCheckArrayExist(pATag)&&psIsEqual(psCleanValue(pATag[0].innerHTML).replace(/[\%\&\>\$\s]/g,""),psCleanValue(pCatName).replace(/[\%\&\>\$\s]/g,""))){if(psCheckArrayExist(pLi=psGetElementsByClassName(pMenu[i],"li","secondary"))){for(j=0;j<pLi.length;j++){if(psIsEqual(psCleanValue(pLi[j].innerHTML).replace(/[\%\&\>\$\s]/g,""),psCleanValue(pSubName).replace(/[\%\&\>\$\s]/g,""))){return true;}}}break;}}}return false;}function psInitialFunctions(){if(!psIsProductView()){psDeleteKey_Value(G_PS_COOKIE_FLAG,"catId");psDeleteKey_Value(G_PS_COOKIE_FLAG,"$ProList");psDeleteKey_Value(G_PS_COOKIE_FLAG,"$CartView");}}function psGetCatIdForProductFromURL(pURL){if(pURL.search(/\/Products\/([^\/\.]+)(\/[^\/\.]+)?(\/.+)?\/category\.aspx/gi)>-1){var pFolder1=RegExp.$1;var pFolder2=RegExp.$2;pFolder1=pFolder1.replace(/(\/|\-amp\-)/gi," ").replace(/\-s\-/gi,"s ").replace(/\-/gi," ");pFolder2=pFolder2.replace(/(\/|\-amp\-)/gi," ").replace(/\-s\-/gi,"s ").replace(/\-/gi," ");if(psCheckArrayExist(pFolder2)&&psIsCategory(psGetValueFromBreadCrumb("2nd"),pFolder2)){if(pFolder1.search(/^(New|Sale)$/gi)>-1){pCatId=pFolder1+": "+pFolder2;}else{pCatId=pFolder2;}}else{pCatId=pFolder1;}return pCatId;}else{if(window.location.href.search(/\/promo_landing\.aspx/gi)>-1){if(window.location.href.search(/categoryname=(.+?&)/)>-1){pCatId=RegExp.$1.replace("&","");return pCatId;}}}return null;}function psGetValueFromBreadCrumb(pPosition){if(psCheckArrayExist(pBreadcrumbs=psGetElementsByClassName(document,"div","BreadCrumbs"))){var pLi=psTrim(psCleanPageId(psCleanHtmlTag(pBreadcrumbs[0].innerHTML))).split(/\&gt\;/i);try{var pBreadcrumbs=pLi[pLi.length-1];if(psIsEqual(pPosition,"nextlast")){pBreadcrumbs=pLi[pLi.length-2];}else{if(psIsEqual(pPosition,"2nd")){pBreadcrumbs=pLi[1];}else{if(psIsEqual(pPosition,"3rd")){pBreadcrumbs=pLi[2];}else{if(psIsEqual(pPosition,"onelast")){pBreadcrumbs=pLi[pLi.length-1];}else{if(pLi.length>3){pBreadcrumbs=pLi[2];for(i=3;i<pLi.length;i++){pBreadcrumbs+="-_-"+pLi[i];}}}}}}return psTrim(psHtmlDecode(pBreadcrumbs).replace(/[\%\&\>\$]/g,""));}catch(Ex){return null;}}return null;}function psHijackAddToCartQuickOrder(pElement,pContainer,pCatId,pEvent){pElement.oldFunc=pElement[pEvent];pElement[pEvent]=function(e){var pDoHijack=true;if(psIsEqual(pEvent,"onkeypress")){var pKey=window.event?event.keyCode:e.keyCode;pDoHijack=(pKey==13);}if(pDoHijack){if(psCheckArrayExist(pInput=pContainer.getElementsByTagName("input"))){for(i=0;i<pInput.length;i++){if(psCheckArrayExist(pInput[i])){var pProdId=pInput[i].value;if(pProdId.search(/\d{2,3}\-\d{2,3}\-(\d+)/gi)>-1){pProdId=RegExp.$1;}psSetValueToCookie(G_PS_COOKIE_PROD_CATID_TEMP,pProdId.replace(/[^\w]/gi,""),pCatId);}}}}if(this.oldFunc!=null){return this.oldFunc();}};}function psPostSearchView(){var pageId="SEARCH SUCCESSFUL";var sTerm="";var sResult="0";var pageNo="1";var pBody=psTrim(unescape(psHtmlDecode(document.body.innerHTML)));if(pBody.search(/We\'re sorry\,\s+we\s+could\s+not\s+find\s+a\s+match\s+for\s+your\s+search\s+\<span[^\>]*\>([^\<\/]+)<\/span\>/gi)>=0){sTerm=RegExp.$1;pageId="SEARCH UNSUCCESSFUL";}else{var pSubBreadCrumbs=document.getElementById("subBreadCrumbs");if(psCheckElementExist(pSubBreadCrumbs)){sTerm=psTrim(psHtmlDecode(unescape(psGetInnerText(pSubBreadCrumbs))).replace(/Your\s+Search\:\s*/gi,"").replace(/\s*\>/g,"|").replace(/\s+/g," "));}var pPagination=document.getElementById("category_content_td");if(psCheckElementExist(pPagination)){var pItemCount=psGetElementsByClassName(pPagination,"div","ItemsCount");if(psCheckArrayExist(pItemCount)){for(var i=0;i<pItemCount.length;i++){if(pItemCount[i].innerHTML.search(/(\d*)\s*Items/gi)>=0){sResult=RegExp.$1;}}}}pPagination=psGetElementsByClassName(pPagination,"div","PageList");if(psCheckArrayExist(pPagination)){for(var i=0;i<pPagination.length;i++){if(pPagination[i].innerHTML.search(/Page\:/gi)>=0){var pLiTags=pPagination[i].getElementsByTagName("li");if(psCheckArrayExist(pLiTags)){for(var j=0;j<pLiTags.length;j++){if(pLiTags[j].className.indexOf("active")>=0){pageNo=psTrim(psHtmlDecode(unescape(pLiTags[j].innerHTML)));}}}}}}pageId+=" PAGE "+parseInt(pageNo);}psCreatePageviewTag(pageId,"SEARCH RESULTS",sTerm,sResult);}function psPostEnsembleView(){var ensName="Ensemble: "+psGetValueFromBreadCrumb("onelast");var ensCatId=psGetValueFromBreadCrumb("nextlast");psCreatePageviewTag(ensName,ensCatId,null,null);if(psCheckElementExist(pProduct=document.getElementById("aspnetForm"))){if(psCheckArrayExist(pSpan=psGetElementsByClassName(document,"div","ItemInfo"))){var itemName;var itemNumber;for(i=0;i<pSpan.length;i++){var elem=pSpan[i].getElementsByTagName("h2");if(elem.length>0){itemName=psGetInnerText(elem[0]);}if(psCheckArrayExist(pDivItmNbr=psGetElementsByClassName(pSpan[i],"div","ItemNumber"))){itemNumber=psGetInnerText(pDivItmNbr[0]).substring(6);}psCreateProductviewTag(itemNumber,itemName,ensCatId);}}}}function psPostProductView(){var prd=new psProduct();if(psCheckElementExist(pProduct=document.getElementById("ctl00_ContentPlaceHolder1_pnlProductVariantsCol"))){var pCatId=null;if(psCheckArrayExist(psGetValueFromCookie(G_PS_COOKIE_FLAG,"$CartView"))&&psCheckArrayExist(pSku=psGetValueFromUrl(G_PS_URL_PATH,"sku"))){pCatId=psGetValueFromCookie(G_PS_COOKIE_PROD_CATID,pSku);}var pPostPageView=true;if(psCheckArrayExist(pSpan=psGetElementsByClassName(pProduct,"span","GreyTextDark"))){for(i=0;i<pSpan.length;i++){if(pSpan[i].innerHTML.search(/\#\s*(\w*\d+)/gi)>-1){if(prd.getProduct(psCleanValue(RegExp.$1),pCatId)){if(pPostPageView){psCreatePageviewTag("Product: "+prd.name+" ("+prd.id+")",prd.catId,null,null);pPostPageView=false;}psCreateProductviewTag(prd.id,prd.name,prd.catId);}}}}}else{pProdId=psCleanValue(psGetElementValueById("hidProductVariant"));if(prd.getProduct(pProdId)){psCreatePageviewTag("Product: "+prd.name+" ("+prd.id+")",prd.catId,null,null);psCreateProductviewTag(prd.id,prd.name,prd.catId);}}if(psCheckElementExist(pJoin=document.getElementById("ctl00_ContentPlaceHolder1_hlJoinNow"))){pJoin.oldFunc=pJoin.onclick;pJoin.onclick=function(){psSetValueToCookie(G_PS_COOKIE_FLAG,"$CartView","");psSetValueToCookie(G_PS_COOKIE_FLAG,"$ProList","");psSetValueToCookie(G_PS_COOKIE_FLAG,"catid","");if(this.oldFunc!=null){return this.oldFunc();}};}}function psAddToCartCM(ItemNumber){var prd=new psProduct();var pCatId=null;if(psCheckArrayExist(psGetValueFromCookie(G_PS_COOKIE_FLAG,"$CartView"))&&psCheckArrayExist(pSku=psGetValueFromUrl(G_PS_URL_PATH,"sku"))){pCatId=psGetValueFromCookie(G_PS_COOKIE_PROD_CATID,pSku);}pProdId=ItemNumber;if(prd.getProduct(pProdId)){psSetValueToCookie(G_PS_COOKIE_PROD_CATID,prd.id,prd.catId);}if(psCheckElementExist(pJoin=document.getElementById("ctl00_ContentPlaceHolder1_hlJoinNow"))){pJoin.oldFunc=pJoin.onclick;pJoin.onclick=function(){psSetValueToCookie(G_PS_COOKIE_FLAG,"$CartView","");psSetValueToCookie(G_PS_COOKIE_FLAG,"$ProList","");psSetValueToCookie(G_PS_COOKIE_FLAG,"catid","");if(this.oldFunc!=null){return this.oldFunc();}};}}function psAddToCartENS(ItemNumber){var prd=new psProduct();var pCatId=null;if(psCheckArrayExist(psGetValueFromCookie(G_PS_COOKIE_FLAG,"$CartView"))&&psCheckArrayExist(pSku=psGetValueFromUrl(G_PS_URL_PATH,"sku"))){pCatId=psGetValueFromCookie(G_PS_COOKIE_PROD_CATID,pSku);}pProdId=ItemNumber;if(prd.getProduct(pProdId)){psSetValueToCookie(G_PS_COOKIE_PROD_CATID,prd.id,prd.catId);}}function psPostCartView(){psCreatePageviewTag("Shopping Cart","Shopping Cart",null,null);if(psCheckArrayExist(psGetCookie(G_PS_COOKIE_PROD_CATID_TEMP))){var pCookie=psGetCookie(G_PS_COOKIE_PROD_CATID_TEMP).split("#");for(ck=0;ck<pCookie.length;ck++){if(psCheckArrayExist(pCookie[ck])){var pRealCookie=pCookie[ck].split("~");psSetValueToCookie(G_PS_COOKIE_PROD_CATID,pRealCookie[0],pRealCookie[1]);}}psSetCookie(G_PS_COOKIE_PROD_CATID_TEMP,"","delete");}if(psCheckArrayExist(pCartTable=psGetElementsByClassName(document,"div","BorderLeft BorderRight"))){if(psCheckArrayExist(pDiv=pCartTable[0].getElementsByTagName("div"))){var prd=new psProduct();var pFlag=false;var k=1;for(i=0;i<pDiv.length;i++){if(psIsEqual(pDiv[i].id,"SCItem")||psIsEqual(pDiv[i].id,"SCAltItem")){psHijackToSetCookie(pDiv[i],"$CartView","yes");if(prd.getItem5(k)){psCreateShopAction5Tag(prd.id,prd.name,prd.quantity,prd.price,prd.catId);pFlag=true;}k++;}}if(pFlag){psDisplayShop5s();}}}}function psPostCheckOutView(){pCatId="CHECKOUT";pPageId=psGetValueFromBreadCrumb("onelast");if(psIsEqual(pPageId,"TBD")){if(psIsErrorOnPage()){psDeleteKey_Value(G_PS_COOKIE_FLAG,"flag_account");}psHijackAccGeneral("ctl00_ContentPlaceHolder1_imgLogin",psHijackLogIn);}else{if(psIsEqual(pPageId,"Billing  Shipping Information")){psDeleteKey_Value(G_PS_COOKIE_FLAG,"reg_att");psDeleteKey_Value(G_PS_COOKIE_FLAG,"flag_account");psHijackAccGeneral("ctl00_ContentPlaceHolder1_imgContinue",psExcBillngInfo);}else{if(psIsEqual(pPageId,"Payment Information")){psUpdateSubscribe();psSaveCusInfo();psPostShop5_Order("shop5");}else{if(psIsEqual(pPageId,"Address Verification")){if(psGetValueFromCookie(G_PS_COOKIE_FLAG,"flag_account")=="gues_register"&&psIsLoginSuccess()){psUpdateSubscribe();psPostRegistrationTag();}}}}}psCreatePageviewTag(pPageId,pCatId,null,null);}function psPostOrderView(){psCreatePageviewTag("Order Confirmation","CHECKOUT",null,null);psPostShop5_Order("order");}function psPostShop5_Order(pShop){if(psCheckElementExist(pCartTable=document.getElementById("ctl00_ContentPlaceHolder1_gvShopCart"))){if(psCheckArrayExist(pRows=pCartTable.rows)){var pOrder=new psOrder();pOrder.getOrder();var pProfile=new psProfile();pProfile.readProfile();var prd=new psProduct();var pFlag=false;var k=2;for(i=0;i<pRows.length;i++){if(psIsEqual(pRows[i].className,"CartRow")||psIsEqual(pRows[i].className,"CartAltRow")){if(psIsEqual(pShop,"order")){psHijackToSetCookie(pRows[i],"$CartView","yes");if(prd.getItem9(k)){psCreateShopAction9Tag(prd.id,prd.name,prd.quantity,prd.price,pProfile.cusId,pOrder.id,pOrder.subtotal,prd.catId);pFlag=true;}}else{psHijackToSetCookie(pRows[i],"$CartView","yes");if(prd.getItem9(k)){psCreateShopAction5Tag(prd.id,prd.name,prd.quantity,prd.price,prd.catId);pFlag=true;}}k++;}}if(pFlag){if(psIsEqual(pShop,"order")){psDisplayShop9s();psCreateOrderTag(pOrder.id,pOrder.subtotal,pOrder.shipping,pProfile.cusId,pProfile.city,pProfile.state,pProfile.zipcode);psCreateRegistrationTag(pProfile.cusId,pProfile.email,pProfile.city,pProfile.state,pProfile.zipcode,pProfile.newsletter,pProfile.subscribe);}else{psDisplayShop5s();}}}}}function psHijackToSetCookie(pElement,pKey,pValue){pElement.oldFunc=pElement.onmousedown;pElement.onmousedown=function(){psSetValueToCookie(G_PS_COOKIE_FLAG,pKey,pValue);if(this.oldFunc!=null){return this.oldFunc();}};}function psHijackMoveToCart(pElement,pRowNum,pCatId){pElement.oldFunc=pElement.onclick;pElement.onclick=function(){var prd=new psProduct();if(prd.getItem5(pRowNum)){psSetValueToCookie(G_PS_COOKIE_FLAG,"$MoveToCart",psGetValueFromCookie(G_PS_COOKIE_FLAG,"$MoveToCart")+"|"+prd.id+"-_-"+prd.name+"-_-"+prd.price+"-_-"+pCatId);}if(this.oldFunc!=null){return this.oldFunc();}};}function psHijackRecommend(){var pCross_Sells=document.getElementById("cross_sells");if(!psCheckElementExist(pCross_Sells)){return;}pCross_Sells=pCross_Sells.getElementsByTagName("a");if(!psCheckArrayExist(pCross_Sells)){return;}for(var i=0;i<pCross_Sells.length;i++){pCross_Sells[i].psOldf=pCross_Sells[i].onclick;pCross_Sells[i].onclick=function(){psSetValueToCookie(G_PS_COOKIE_FLAG,"catid","recommend");if(psCheckElementExist(this.psOldf)){return this.psOldf();}};}}function psIsErrorOnPage(){var pMessages=document.getElementById("ctl00_ContentPlaceHolder1_vsMessages");return((psCheckElementExist(pMessages)&&pMessages.style.display.indexOf("none")<0)||psCheckElementExist(document.getElementById("ctl00_ContentPlaceHolder1_lblLoginError"))||psCheckElementExist(document.getElementById("ctl00_ContentPlaceHolder1_lblLoginErrorMessage"))||psCheckElementExist(document.getElementById("ctl00_ContentPlaceHolder1_pnlAddressError")));}function psHijackAccGeneral(pElementId,psExFunc){var pBtn=document.getElementById(pElementId);if(!psCheckElementExist(pBtn)){return;}pBtn.Oldf=pBtn.onclick;pBtn.onclick=function(){psExFunc();if(psCheckElementExist(this.Oldf)){return this.Oldf();}};}function psHijackLogIn(){var pUserName=psGetElementValueById("ctl00_ContentPlaceHolder1_txtUserName");if(!psCheckElementExist(pUserName)){pUserName=psGetElementValueById("ctl00_ContentPlaceHolder1_txtEmailAddress");}if(psCheckEmail(pUserName)){var uP=new psProfile();uP.cusId=uP.email=pUserName;uP.writeProfile();psSetValueToCookie(G_PS_COOKIE_FLAG,"flag_account","login");}}function psIsLoginSuccess(){return psCheckElementExist(document.getElementById("ctl00_ucHeader1_hlLogout_hlGeneric"));}function psHijackRegister(){var pEmail=psGetElementValueById("ctl00_ContentPlaceHolder1_txtEmail");if(!psCheckEmail(pEmail)){return;}psSetRegAttrbToCookie();var uP=new psProfile();uP.cusId=uP.email=pEmail;uP.city=psGetElementValueById("ctl00_ContentPlaceHolder1_txtCity");uP.state=psGetElementValueById("ctl00_ContentPlaceHolder1_cmbState",true);uP.zipcode=psGetElementValueById("ctl00_ContentPlaceHolder1_txtZip");uP.subscribe=psGetValueFromCookie(G_PS_COOKIE_FLAG,"reg_att");uP.writeProfile();psDeleteKey_Value(G_PS_COOKIE_FLAG,"reg_att");psSetValueToCookie(G_PS_COOKIE_FLAG,"flag_account","register");}function psHijackUpdateProf(){psSetRegAttrbToCookie();var pEmail=psGetElementValueById("ctl00_ContentPlaceHolder1_txtEmail");if(!psCheckEmail(pEmail)){return;}pCity=psGetElementValueById("ctl00_ContentPlaceHolder1_txtCity");pState=psGetElementValueById("ctl00_ContentPlaceHolder1_cmbState",true);pZip=psGetElementValueById("ctl00_ContentPlaceHolder1_txtZip");psSetValueToCookie(G_PS_COOKIE_FLAG,"profile_temp",pEmail+"-_-"+pCity+"-_-"+pState+"-_-"+pZip);psSetValueToCookie(G_PS_COOKIE_FLAG,"flag_account","update");}function psUpdateSubscribe(){var pSubsTemp_1=psGetValueFromCookie(G_PS_COOKIE_FLAG,"reg_att");if(!psCheckElementExist(pSubsTemp_1)){return;}var uP=new psProfile();uP.readProfile();if(!psCheckElementExist(uP.subscribe)){uP.subscribe=pSubsTemp_1;}else{var pSubsTemp_2=uP.subscribe.split("-_-");if(psCheckArrayExist(pSubsTemp_2)){pSubsTemp_1=pSubsTemp_1.split("-_-");for(var i=0;i<pSubsTemp_1.length;i++){if(pSubsTemp_1[i]!=""){pSubsTemp_2[i]=pSubsTemp_1[i];}}uP.subscribe=pSubsTemp_2.join("-_-");}}uP.writeProfile();psDeleteKey_Value(G_PS_COOKIE_FLAG,"reg_att");}function psPostUpdateProfile(){var profile_temp=psGetValueFromCookie(G_PS_COOKIE_FLAG,"profile_temp");if(profile_temp==null){return;}profile_temp=profile_temp.split("-_-");if(!psCheckArrayExist(profile_temp)){return;}var uP=new psProfile();uP.readProfile();uP.cusId=uP.email=profile_temp[0];uP.city=profile_temp[1];uP.state=profile_temp[2];uP.zipcode=profile_temp[3];uP.writeProfile();psCreateRegistrationTag(uP.cusId,uP.email,uP.city,uP.state,uP.zipcode,uP.newsletter,uP.subscribe);psDeleteKey_Value(G_PS_COOKIE_FLAG,"flag_account");psDeleteKey_Value(G_PS_COOKIE_FLAG,"profile_temp");}function psSetRegAttrbToCookie(){var pEmailOffer=document.getElementById("ctl00_ContentPlaceHolder1_chkOptIn");pEmailOffer=psCheckElementExist(pEmailOffer)?(pEmailOffer.checked?"Y":"N"):"";var pGender=psGetElementValueById("ctl00_ContentPlaceHolder1_dlSurvey_ctl00_ctrSingleQuestion_ddlAnswers",true);pGender=psCheckElementExist(pGender)?pGender:"";var pBirthMonth=psGetElementValueById("ctl00_ContentPlaceHolder1_dlSurvey_ctl01_ctrSingleQuestion_ddlAnswers",true);pBirthMonth=psCheckElementExist(pBirthMonth)?pBirthMonth:"";var pCat=document.getElementById("ctl00_ContentPlaceHolder1_dlSurvey_ctl02_ctrMultiChoiceQuestion_cblAnswers_0");pCat=psCheckElementExist(pCat)?(pCat.checked?"Y":"N"):"";var pDog=document.getElementById("ctl00_ContentPlaceHolder1_dlSurvey_ctl02_ctrMultiChoiceQuestion_cblAnswers_1");pDog=psCheckElementExist(pDog)?(pDog.checked?"Y":"N"):"";var pFish=document.getElementById("ctl00_ContentPlaceHolder1_dlSurvey_ctl02_ctrMultiChoiceQuestion_cblAnswers_2");pFish=psCheckElementExist(pFish)?(pFish.checked?"Y":"N"):"";var pOther=document.getElementById("ctl00_ContentPlaceHolder1_dlSurvey_ctl02_ctrMultiChoiceQuestion_cblAnswers_3");pOther=psCheckElementExist(pOther)?(pOther.checked?"Y":"N"):"";psSetValueToCookie(G_PS_COOKIE_FLAG,"reg_att",pEmailOffer+"-_-"+pGender+"-_-"+pBirthMonth+"-_-"+pCat+"-_-"+pDog+"-_-"+pFish+"-_-"+pOther);}function psExcBillngInfo(){psSetRegAttrbToCookie();var pConfPass=psGetElementValueById("ctl00_ContentPlaceHolder1_txtPassword2");if(pConfPass==null){return psSetValueToCookie(G_PS_COOKIE_FLAG,"flag_account","edit_bill");}else{if(pConfPass==""){return;}}psSetValueToCookie(G_PS_COOKIE_FLAG,"flag_account","gues_register");var pEmail=psGetElementValueById("ctl00_ContentPlaceHolder1_txtBillEmail");if(!psCheckEmail(pEmail)){return;}var uP=new psProfile();uP.cusId=uP.email=pEmail;uP.city=psGetElementValueById("ctl00_ContentPlaceHolder1_txtBillCity");uP.state=psGetElementValueById("ctl00_ContentPlaceHolder1_ddlBillState",true);uP.zipcode=psGetElementValueById("ctl00_ContentPlaceHolder1_txtBillZip");uP.subscribe=psGetValueFromCookie(G_PS_COOKIE_FLAG,"reg_att");uP.writeProfile();psDeleteKey_Value(G_PS_COOKIE_FLAG,"reg_att");}function psSaveCusInfo(){var uP=new psProfile();uP.readProfile();uP.cusId=uP.email=psGetElementValueById("ctl00_ContentPlaceHolder1_lblBillingEmail");uP.city=psGetElementValueById("ctl00_ContentPlaceHolder1_lblBillingCityStateZip");if(psCheckElementExist(uP.city)&&uP.city.indexOf(",")>=0){uP.city=uP.city.split(",");uP.state=psTrim(uP.city[1].replace(/\s+/g," "));uP.city=psTrim(uP.city[0]);if(uP.state.indexOf(" ")>=0){uP.zipcode=psTrim(uP.state.substr(uP.state.indexOf(" "),uP.state.length-1));uP.state=psTrim(uP.state.substr(0,uP.state.indexOf(" ")));}}uP.writeProfile();if(psGetValueFromCookie(G_PS_COOKIE_FLAG,"flag_account")=="edit_bill"&&psIsLoginSuccess()){psPostRegistrationTag();}psDeleteKey_Value(G_PS_COOKIE_FLAG,"flag_account");}function psPostRegistrationTag(){var uP=new psProfile();uP.readProfile();psCreateRegistrationTag(uP.cusId,uP.email,uP.city,uP.state,uP.zipcode,uP.newsletter,uP.subscribe);psDeleteKey_Value(G_PS_COOKIE_FLAG,"flag_account");}function psProduct(){this.id=null;this.name=null;this.catId=null;this.price=null;this.quantity=null;this.reset=function(){this.id=null;this.name=null;this.catId=null;this.price=null;this.quantity=null;};this.getProduct=function(pProdId,pCatId){try{this.reset();this.id=pProdId;if(psCheckArrayExist(pH1=document.getElementsByTagName("H1"))){this.name=psCleanValue(pH1[0].innerHTML);}this.catId="UNKNOWN";if(psCheckArrayExist(pCatId)){this.catId=pCatId;}else{if(psCheckArrayExist(pXsell=psGetValueFromUrl(G_PS_URL_PATH,"xsell"))){this.catId="xsell="+pXsell;}else{if(psCheckArrayExist(pRvi=psGetValueFromUrl(G_PS_URL_PATH,"rvi"))){this.catId="rvi="+pRvi;}else{if(psCheckArrayExist(pUpSell=psGetValueFromUrl(G_PS_URL_PATH,"upsell"))){this.catId="upsell="+pUpSell;}else{if(psGetValueFromCookie(G_PS_COOKIE_FLAG,"catid")=="recommend"){this.catId="Recommended Products";}else{if(psCheckArrayExist(p2ndBread=psGetValueFromBreadCrumb("2nd"))&&psIsEqual(p2ndBread,"Search Results")){this.catId="Search Results";}else{if(psCheckArrayExist(psGetValueFromCookie(G_PS_COOKIE_FLAG,"$ProList"))){this.catId=psGetValueFromCookie(G_PS_COOKIE_FLAG,"$ProList");}else{if(psCheckArrayExist(psGetValueFromCookie(G_PS_COOKIE_FLAG,"$CartView"))){this.catId=psGetValueFromCookie(G_PS_COOKIE_PROD_CATID,this.id);}else{if(psCheckArrayExist(G_PS_URL_REFERRER)){this.catId=psGetCatIdForProductFromURL(G_PS_URL_REFERRER);this.catId=psCheckArrayExist(this.catId)?this.catId:"Home Page";}else{if(!psCheckArrayExist(G_PS_URL_REFERRER)){this.catId="BOOKMARK";}}}}}}}}}}if(this.catId==null||this.catId==""){this.catId=this.name.search(/(Green\s*\&\s*Gold\s*Savings\s*Club\s*Membership|G\s*\&\s*G\s*Club\s*Membership\-im)/gi)>=0?this.name:"Unknown";}return true;}catch(ex){return false;}};this.getItem5=function(itemRow){try{this.reset();this.id=psCleanValue(psGetElementValueById("ctl00_ContentPlaceHolder1_repCart_ctl0"+itemRow+"_lbItemNumber"));this.name=psCleanValue(psGetElementValueById("ctl00_ContentPlaceHolder1_repCart_ctl0"+itemRow+"_hlItemName"));this.quantity=psCleanValue(psGetElementValueById("ctl00_ContentPlaceHolder1_repCart_ctl0"+itemRow+"_ddQuantity"));this.quantity=psCheckArrayExist(this.quantity)?this.quantity:1;this.price=psCleanValue(psGetElementValueById("ctl00_ContentPlaceHolder1_repCart_ctl0"+itemRow+"_lblPrice"));var pMemberPrice=psCleanValue(psGetElementValueById("ctl00_ContentPlaceHolder1_repCart_ctl0"+itemRow+"_lblMemberPrice"));if(!psCheckArrayExist(pMemberPrice)){pMemberPrice=psCleanValue(psGetElementValueById("ctl00_ContentPlaceHolder1_repCart_ctl0"+itemRow+"_lblDiscountPrice"));}if(psCheckArrayExist(pMemberPrice)){this.price=pMemberPrice;}if(this.catId==null){this.catId=psGetValueFromCookie(G_PS_COOKIE_PROD_CATID,this.id);}if(this.catId==null||this.catId==""){this.catId=this.name.search(/(Green\s*\&\s*Gold\s*Savings\s*Club\s*Membership|G\s*\&\s*G\s*Club\s*Membership\-im)/gi)>=0?this.name:"Unknown";}return true;}catch(ex){return false;}};this.getItem9=function(itemRow){try{this.reset();this.id=psCleanValue(psGetElementValueById("ctl00_ContentPlaceHolder1_gvShopCart_ctl0"+itemRow+"_lbShopItemNumber"));this.name=psCleanValue(psGetElementValueById("ctl00_ContentPlaceHolder1_gvShopCart_ctl0"+itemRow+"_hlShopItemName"));this.quantity=psCleanValue(psGetElementValueById("ctl00_ContentPlaceHolder1_gvShopCart_ctl0"+itemRow+"_lblQnty"));this.price=psCleanValue(psGetElementValueById("ctl00_ContentPlaceHolder1_gvShopCart_ctl0"+itemRow+"_lblItemPrice"));var pMemberPrice=psCleanValue(psGetElementValueById("ctl00_ContentPlaceHolder1_gvShopCart_ctl0"+itemRow+"_lblClubPrice"));if(!psCheckArrayExist(pMemberPrice)){pMemberPrice=psCleanValue(psGetElementValueById("ctl00_ContentPlaceHolder1_gvShopCart_ctl0"+itemRow+"_lblDiscountPrice"));}if(psCheckArrayExist(pMemberPrice)){this.price=pMemberPrice;}if(this.catId==null){this.catId=psGetValueFromCookie(G_PS_COOKIE_PROD_CATID,this.id);}if(this.catId==null||this.catId==""){this.catId=this.name.search(/(Green\s*\&\s*Gold\s*Savings\s*Club\s*Membership|G\s*\&\s*G\s*Club\s*Membership\-im)/gi)>=0?this.name:"Unknown";}return this.id!=null;}catch(ex){return false;}};}function psProfile(){this.cusId=null;this.email=null;this.city=null;this.state=null;this.zipcode=null;this.newsletter=null;this.subscribe=null;this.readProfile=function(){try{this.cusId=psGetCookie(G_PS_COOKIE_PROFILE);if(this.cusId!=null){var buf=this.cusId.split("|");for(var i=0;i<buf.length;i++){var tempVal=buf[i];buf[i]=(tempVal=="null"?null:tempVal);}this.cusId=buf[0];this.email=buf[1];this.city=buf[2];this.state=buf[3];this.zipcode=buf[4];this.newsletter=buf[5];this.subscribe=buf[6];}if(!this.cusId){this.cusId=psGenerateRandomValue();}return true;}catch(ex){return false;}};this.writeProfile=function(){try{if(this.cusId==null){return;}var data=this.cusId+"|"+this.email+"|"+this.city+"|"+this.state+"|"+this.zipcode+"|"+this.newsletter+"|"+this.subscribe;psSetCookie(G_PS_COOKIE_PROFILE,data,G_PS_COOKIE_LIFETIME);return true;}catch(ex){return false;}};}function psOrder(){this.id="UNKNOWN";this.subtotal=null;this.shipping=null;this.getOrder=function(){try{var pOrderID=psGetElementValueById("ctl00_ContentPlaceHolder1_hidOrderNumber");if(!psCheckElementExist(pOrderID)){pOrderID=psGetElementValueById("ctl00_ContentPlaceHolder1_lblOrderNumber");}if(psCheckElementExist(pOrderID)){this.id=pOrderID.search(/\<\/span\>\s*(\d+)/gi)>-1?psCleanValue(RegExp.$1):pOrderID;}this.subtotal=psCleanPrice(psGetElementValueById("ctl00_ContentPlaceHolder1_lblSubtotal"));this.shipping=psCleanPrice(psGetElementValueById("ctl00_ContentPlaceHolder1_lblShipping"));this.shipping=psCheckArrayExist(this.shipping)?this.shipping:0;}catch(ex){return false;}};}function psIsEqual(){for(var i=0;i<arguments.length;i++){if(arguments[i]==null||typeof(arguments[i])!="string"){return false;}else{if(arguments[0].toUpperCase()!=arguments[i].toUpperCase()){return false;}}}return true;}function psGetInnerText(pTagOjb){var pattern=/<script[\s\S]*?<\/script>/gi;if(pTagOjb!=null){var sT=(typeof(pTagOjb)=="object")?pTagOjb.innerHTML:pTagOjb;while(sT.search(pattern)>-1){sT=sT.replace(pattern,"");}return sT.replace(/\<+.+?\>+/g,"");}return null;}function psCleanCatId(pCatId){return(pCatId!=null)?pCatId.replace(/[\'\":,\™\®\!\%]/g,""):null;}function psCleanPageId(pPageId){return(pPageId!=null)?pPageId.replace(/[\n\t\v\r’\'\"\™\®\!\%]/gi,""):null;}function psCleanProductName(pProductName){return(pProductName!=null)?pProductName.replace(/[\n\t\v\r’\'\"\™\®\!\%\@]/gi,""):null;}function psTrim(pStr){if(pStr==null||typeof(pStr)!="string"){return pStr;}return(pStr!=null)?pStr.replace(/&nbsp;|\u00A0/gi," ").replace(/^\s+|\s+$/g,""):null;}function psGetValueFromUrl(pUrl,pKey){pUrl=(pUrl!=null)?"?"+psTrim(pUrl.toLowerCase()):null;pKey=(pKey!=null)?psTrim(pKey.toLowerCase()):null;if(pUrl==null||pKey==null||pUrl.indexOf(pKey)==-1){return null;}var start=pUrl.indexOf("&"+pKey+"=");start=(start==-1)?pUrl.indexOf("?"+pKey+"="):start;if(start>=0){start=start+pKey.length;var end=pUrl.indexOf("&",start);if(end==-1){end=pUrl.length;}var middle=pUrl.indexOf("=",start);return pUrl.substring(middle+1,end);}return null;}function psGetElementValueById(pTagId,pValueFlag){var tag=document.getElementById(pTagId);return psGetElementValue(tag,pValueFlag);}function psGetElementValue(pTagObj,pValueFlag){var tagValue=null;if(pTagObj!=null){if(pTagObj.tagName.search(/^INPUT$/i)>-1){tagValue=pTagObj.value;}else{if(pTagObj.tagName.search(/^SELECT$/i)>-1){if(pValueFlag==true){tagValue=pTagObj.options[pTagObj.selectedIndex].value;}else{tagValue=psHtmlDecode(pTagObj.options[pTagObj.selectedIndex].innerHTML);}}else{tagValue=psHtmlDecode(pTagObj.innerHTML);}}}return tagValue;}function psCheckEmail(pEmail){if(pEmail){var i=pEmail.search(/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/);return(i>-1);}return false;}function psHtmlDecode(pValue){if(pValue){pValue=pValue.replace(/&nbsp;/gi," ");pValue=pValue.replace(/&quot;/gi,'"');pValue=pValue.replace(/&amp;/gi,"&");pValue=pValue.replace(/&lt;/gi,"<");pValue=pValue.replace(/&gt;/gi,">");}return pValue;}function psGetMainDomain(pUrl){var se=/^https*\:\/\/([^\/\:]+)/gi;var domain=(pUrl.search(se)>-1)?RegExp.$1:null;if(domain!=null){if(domain.indexOf("www")==0){domain=domain.substring(4,domain.length);}if(G_PS_ARR_DOMAIN!=null){for(var i=0;i<G_PS_ARR_DOMAIN.length;i++){se=new RegExp("[.]"+G_PS_ARR_DOMAIN[i]+"$","gi");if(("."+domain).search(se)>-1){domain=G_PS_ARR_DOMAIN[i];break;}}}domain="."+domain;}return domain;}function psGetDomain(pUrl){var se=/^https*\:\/\/([^\/\:]+)/gi;return(pUrl.search(se)>-1)?RegExp.$1:null;}function psCleanPrice(pPrice){var pattern=/[^0-9\.]/gi;return(pPrice!=null?pPrice.toString().replace(pattern,""):null);}function psGetCookie(pCookieName){var cookies=document.cookie;if(!pCookieName||!cookies){return null;}cookies="; "+cookies.toLowerCase();var key="; "+pCookieName.toLowerCase()+"=";var start=cookies.lastIndexOf(key);if(start>=0){start=start+key.length;var end=cookies.indexOf(";",start);if(end==-1){end=cookies.length;}return unescape(cookies.substring(start,end));}return null;}function psCookieBase(pCookieName,pCookieValue,pLifeTime){var pDomain=psGetMainDomain(G_PS_URL_PATH);CC(pCookieName,pDomain);if(pLifeTime=="delete"){return true;}var expire=(pLifeTime)?(new Date((new Date()).getTime()+(1000*pLifeTime))).toGMTString():null;return CB(pCookieName,escape(pCookieValue),expire,pDomain);}function encodeHtml(strValue){if(strValue!=null){strValue=escape(strValue);strValue=strValue.replace(/\//g,"%2F");strValue=strValue.replace(/\?/g,"%3F");strValue=strValue.replace(/=/g,"%3D");strValue=strValue.replace(/&/g,"%26");strValue=strValue.replace(/@/g,"%40");}return strValue;}function decodeHtml(strValue){if(strValue!=null){strValue=strValue.replace(/\%2F/gi,"/");strValue=strValue.replace(/\%3F/gi,"?");strValue=strValue.replace(/\%3D/gi,"=");strValue=strValue.replace(/\%26/gi,"&");strValue=strValue.replace(/\%40/gi,"@");strValue=strValue.replace(/\%20/gi," ");}return strValue;}function psSetCookie(pCookieName,pCookieValue,pLifeTime){if(!pCookieName){return false;}pCookieValue=(pCookieValue==null)?"null":pCookieValue;if(pLifeTime!="delete"){pCookieName=psTrim(pCookieName);var oldCookieValue=psGetCookie(pCookieName);oldCookieValue=(oldCookieValue==null)?"null":oldCookieValue;var totalSize;if(document.cookie.indexOf(pCookieName)>-1){totalSize=document.cookie.length+encodeHtml(pCookieValue).length-encodeHtml(oldCookieValue).length;}else{totalSize=document.cookie.length+encodeHtml(pCookieValue).length+encodeHtml(pCookieName).length;}if(totalSize>3500){return false;}}psCookieBase(pCookieName,pCookieValue,pLifeTime);}function psSetValueToCookie(pCookieName,pKey,pValue){if(!pCookieName||!pKey){return false;}pCookieName=psTrim(pCookieName);pKey=(pKey!=null)?"#"+psTrim(pKey).toLowerCase()+"~":pKey;var catCookie=psGetCookie(pCookieName);catCookie=(catCookie==null)?"":catCookie;pValue=(pValue==null)?"null":pValue;var oldCatCookie=catCookie;var start=catCookie.indexOf(pKey);var totalsize;if(start>=0){var oldValue=psGetValueFromCookie(pCookieName,pKey.replace(/[\~\#]/gi,""));oldValue=(oldValue==null)?"null":oldValue;var end=catCookie.indexOf("#",start+pKey.length);if(end==-1){end=catCookie.length;}catCookie=catCookie.replace(catCookie.substring(start,end),"");totalsize=document.cookie.length+encodeHtml(pKey).length+encodeHtml(pValue).length-encodeHtml(oldValue).length;}else{totalsize=document.cookie.length+encodeHtml(pKey).length+encodeHtml(pValue).length;if(document.cookie.indexOf(pCookieName)<0){totalsize+=encodeHtml(pCookieName).length;}}catCookie=pKey+pValue+catCookie;var cookieArray=null;var count=0;while(totalsize>3500&&count<1000){var l1=encodeHtml(catCookie).length;cookieArray=catCookie.split("#");cookieArray.pop();catCookie=cookieArray.join("#");var l2=encodeHtml(catCookie).length;totalsize-=(l1-l2);count++;}if(catCookie==null||catCookie==""){catCookie=oldCatCookie;}psCookieBase(pCookieName,catCookie,G_PS_COOKIE_LIFETIME);}function psGetValueFromCookie(pCookieName,pKey){pCookieName=psTrim(pCookieName);pKey=(pKey!=null)?"#"+psTrim(pKey).toLowerCase()+"~":pKey;var catCookie=psGetCookie(pCookieName);if(catCookie!=null){var start=catCookie.indexOf(pKey);if(start>=0){start=start+pKey.length;var end=catCookie.indexOf("#",start);if(end==-1){end=catCookie.length;}return catCookie.substring(start,end);}return null;}return null;}function psGenerateRandomValue(){var dtDate=new Date();var cusRandom=(dtDate.getTime()%10000000)+(Math.floor(Math.random()*10000));return cusRandom;}function psShorttenPageID(pLink){var temp1=pLink;if(temp1!=null){temp1=(temp1.length>255)?temp1.substr(0,255):temp1;}return temp1;}function psCheckArrayExist(pArrElement){return(typeof(pArrElement)=="undefined"||pArrElement==null||pArrElement.length<=0)?false:true;}function psCheckElementExist(pElement){return(typeof(pElement)=="undefined"||pElement==null)?false:true;}function psGetElementsByClassName(psDocument,psElementTagName,psClassName){var arrResult=new Array();var index=0;var arrInputs=psDocument.getElementsByTagName(psElementTagName);if(arrInputs==null){return null;}for(var i=0;i<arrInputs.length;i++){if(arrInputs[i].className.toLowerCase()==psClassName.toLowerCase()){arrResult[index++]=arrInputs[i];}}return arrResult;}function psCleanHtmlTag(pValue){return(typeof(pValue)=="string")?pValue.replace(/\<+.+?\>+/g,""):null;}function psCleanValue(pValue){return psCheckArrayExist(pValue)?psTrim(psHtmlDecode(psCleanPageId(psCleanHtmlTag(pValue)))):pValue;}function psDeleteKey_Value(pCookieName,pKey){var pCookie=psGetCookie(pCookieName);if(pCookie==null){return;}var pValue=psGetValueFromCookie(pCookieName,pKey);if(pValue==null){return;}pKey=("#"+pKey+"~"+pValue).toLowerCase();if(pCookie.indexOf(pKey)<0){return;}pCookie=pCookie.replace(pKey,"");return(pCookie.indexOf("#")<0)?psSetCookie(pCookieName,"","delete"):psSetCookie(pCookieName,pCookie);}function psGetPageVersion(){var pPageVersion="";var pPV=document.getElementById("_PAGEVERSION");pPV=psCheckElementExist(pPV)?pPV:document.getElementById("PAGEVERSION");if(psCheckElementExist(pPV)&&psIsEqual(pPV.type,"hidden")){pPageVersion=" "+psTrim(psHtmlDecode(unescape(pPV.value)));}else{if(psCheckArrayExist(pInput=document.getElementsByTagName("input"))){for(i=0;i<pInput.length;i++){if(psIsEqual(pInput[i].type,"hidden")&&(psIsEqual(pInput[i].name,"_PAGEVERSION")||psIsEqual(pInput[i].name,"PAGEVERSION"))){pPageVersion=" "+psTrim(psHtmlDecode(unescape(pInput[i].value)));break;}}}}return pPageVersion;}function psCreatePageviewTag(pId,pCatId,pSrchTerm,pSrchResult){pId+=psGetPageVersion();pId=psCleanPageId(pId);pId=psShorttenPageID(pId);pCatId=psCleanPageId(pCatId);if(pSrchResult!=null){pSrchResult+="";}if(G_PS_DEBUG_MODE==1||G_PS_DEBUG_MODE==3){alert("cmCreatePageviewTag("+pId+", "+pCatId+", "+pSrchTerm+", "+pSrchResult+")");}if(G_PS_DEBUG_MODE==2||G_PS_DEBUG_MODE==3){cmCreatePageviewTag(pId,pCatId,pSrchTerm,pSrchResult);}}function psCreateProductviewTag(pId,pName,pCatId){pName=psCleanProductName(pName);pCatId=psCleanPageId(pCatId);if(G_PS_DEBUG_MODE==1||G_PS_DEBUG_MODE==3){alert("cmCreateProductviewTag("+pId+", "+pName+", "+pCatId+")");}if(G_PS_DEBUG_MODE==2||G_PS_DEBUG_MODE==3){cmCreateProductviewTag(pId,pName,pCatId);}}function psCreateShopAction5Tag(pId,pName,pQuantity,pPrice,pCatId){pName=psCleanProductName(pName);pCatId=psCleanPageId(pCatId);pQuantity=psCleanPrice(pQuantity);pPrice=psCleanPrice(pPrice);if(G_PS_DEBUG_MODE==1||G_PS_DEBUG_MODE==3){alert("cmCreateShopAction5Tag("+pId+", "+pName+", "+pQuantity+", "+pPrice+", "+pCatId+")");}if(G_PS_DEBUG_MODE==2||G_PS_DEBUG_MODE==3){cmCreateShopAction5Tag(pId,pName,pQuantity,pPrice,pCatId);}}function psCreateShopAction9Tag(pId,pName,pQuantity,pPrice,pCusID,pOrderID,pOrderTotal,pCatId){pName=psCleanProductName(pName);pCatId=psCleanPageId(pCatId);pQuantity=psCleanPrice(pQuantity);pPrice=psCleanPrice(pPrice);pOrderTotal=psCleanPrice(pOrderTotal);if(G_PS_DEBUG_MODE==1||G_PS_DEBUG_MODE==3){alert("cmCreateShopAction9Tag("+pId+", "+pName+", "+pQuantity+", "+pPrice+", "+pCusID+", "+pOrderID+", "+pOrderTotal+", "+pCatId+")");}if(G_PS_DEBUG_MODE==2||G_PS_DEBUG_MODE==3){cmCreateShopAction9Tag(pId,pName,pQuantity,pPrice,pCusID,pOrderID,pOrderTotal,pCatId);}}function psCreateOrderTag(pId,pOrderTotal,pOrderShipping,pCusID,pCusCity,pCusState,pCusZip){pOrderTotal=psCleanPrice(pOrderTotal);pOrderShipping=psCleanPrice(pOrderShipping);if(G_PS_DEBUG_MODE==1||G_PS_DEBUG_MODE==3){alert("cmCreateOrderTag("+pId+", "+pOrderTotal+", "+pOrderShipping+", "+pCusID+", "+pCusCity+", "+pCusState+", "+pCusZip+")");}if(G_PS_DEBUG_MODE==2||G_PS_DEBUG_MODE==3){cmCreateOrderTag(pId,pOrderTotal,pOrderShipping,pCusID,pCusCity,pCusState,pCusZip);}}function psCreateConversionEventTag(pId,pActionType,pCatID,pPoints){pCatID=psCleanCatId(pCatID);if(G_PS_DEBUG_MODE==1||G_PS_DEBUG_MODE==3){alert("cmCreateConversionEventTag("+pId+", "+pActionType+", "+pCatID+", "+pPoints+")");}if(G_PS_DEBUG_MODE==2||G_PS_DEBUG_MODE==3){cmCreateConversionEventTag(pId,pActionType,pCatID,pPoints);}}function psCreateRegistrationTag(pCusID,pCustEmail,pCusCity,pCusState,pCusZip,pNewsletter,pSubscribe){if(G_PS_DEBUG_MODE==1||G_PS_DEBUG_MODE==3){alert("cmCreateRegistrationTag("+pCusID+", "+pCustEmail+", "+pCusCity+", "+pCusState+", "+pCusZip+", "+pNewsletter+", "+pSubscribe+")");}if(G_PS_DEBUG_MODE==2||G_PS_DEBUG_MODE==3){cmCreateRegistrationTag(pCusID,pCustEmail,pCusCity,pCusState,pCusZip,pNewsletter,pSubscribe);}}function psCreateErrorTag(pPageID,pCatId){pPageID=psCleanPageId(pPageID);pCatId=psCleanCatId(pCatId);if(G_PS_DEBUG_MODE==1||G_PS_DEBUG_MODE==3){alert("cmCreateErrorTag("+pPageID+", "+pCatId+")");}if(G_PS_DEBUG_MODE==2||G_PS_DEBUG_MODE==3){cmCreateErrorTag(pPageID,pCatId);}}function psDisplayShop5s(){if(G_PS_DEBUG_MODE==1||G_PS_DEBUG_MODE==3){alert("cmDisplayShop5s()");}if(G_PS_DEBUG_MODE==2||G_PS_DEBUG_MODE==3){cmDisplayShop5s();}}function psDisplayShop9s(){if(G_PS_DEBUG_MODE==1||G_PS_DEBUG_MODE==3){alert("cmDisplayShop9s()");}if(G_PS_DEBUG_MODE==2||G_PS_DEBUG_MODE==3){cmDisplayShop9s();}}