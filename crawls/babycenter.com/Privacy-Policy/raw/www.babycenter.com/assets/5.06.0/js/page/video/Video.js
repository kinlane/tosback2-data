bc.namespace("bc.video");bc.video.Video=new function(){this._initialVideoReferenceId=null;this._contentIdParamName=null;this._transcriptURL=null;this._transcriptContainer=null;this._transcriptBodyId=null;this._experienceModule=null;this._advertisingModule=null;this._videoPlayerModule=null;this._contentModule=null;this._socialModule=null;this._currentVideoReferenceId=null;this._currentVideoDisplayName=null;this._didTrackingOnAdComplete=false;};bc.video.Video.init=function(j){var f=j.brcvExperience;this._initialVideoReferenceId=j.initialVideoReferenceId;this._contentIdParamName=j.contentIdParamName;this._transcriptURL=j.transcriptURL;var k=j.transcriptContainerId;var e=j.transcriptBodyId;this._transcriptContainerId=k;this._transcriptContainer=document.getElementById(k);this._transcriptBody=document.getElementById(e);this._experienceModule=f.getModule(APIModules.EXPERIENCE);this._advertisingModule=f.getModule(APIModules.ADVERTISING);this._videoPlayerModule=f.getModule(APIModules.VIDEO_PLAYER);this._contentModule=f.getModule(APIModules.CONTENT);this._socialModule=f.getModule(APIModules.SOCIAL);var h=this;var d=function(l){h._onAdStart(l);};var i=function(l){h._onAdComplete(l);};var g=function(l){h._onAdClick(l);};var a=function(l){h._onStreamStart(l);};var b=function(l){h._onVideoComplete(l);};var c=function(l){h._onExternalAd(l);};this._advertisingModule.enableExternalAds(true);this._experienceModule.addEventListener(BCExperienceEvent.TEMPLATE_READY,bc.video.Video._onTemplateReady);this._advertisingModule.addEventListener(BCAdvertisingEvent.AD_START,d);this._advertisingModule.addEventListener(BCAdvertisingEvent.AD_COMPLETE,i);this._advertisingModule.addEventListener(BCAdvertisingEvent.AD_CLICK,g);this._advertisingModule.addEventListener(BCAdvertisingEvent.AD_PAUSE,g);this._advertisingModule.addEventListener(BCAdvertisingEvent.EXTERNAL_AD,c);this._videoPlayerModule.addEventListener(BCVideoEvent.STREAM_START,a);this._videoPlayerModule.addEventListener(BCVideoEvent.VIDEO_COMPLETE,b);this._advertisingModule.addEventListener(BCAdvertisingEvent.AD_RECEIVED,onAdReceived);if(k!=""){$("#transcriptOpener").click(function(l){l.preventDefault();$("#"+k).removeClass("hidden");$("#transcriptOpenerContainer").addClass("hidden");});}$(".videoPlaylist a").click(function(m){var l="";if(m.target.id=="playlistSeeAll"){l="BC_MoreVideo_SeeAll";}else{if($(m.target).parents(".sponsoredVideo").length>0){l="BC_MoreVideo_Sponsored";}else{if($(m.target).parents("li.featuredVideo").length>0){l="BC_MoreVideo_Featured";}else{l="BC_MoreVideo_Standard";}}}if(bc.mobile){l+="_Mobile";}bc.frag.tracking.OmnitureManager.trackPageExitAction(null,null,{prop11:((bc.mobile)?"BC_Body":"BC_RightRail"),prop12:l},null);});};bc.video.Video._onTemplateReady=function(a){bc.video.Video._videoPlayerModule.loadVideo(bc.video.Video._initialVideoReferenceId,"referenceId");bc.video.Video._setShareLinkURL(bc.video.Video._initialVideoReferenceId);if($("#pinterestContainer").length>0){$("#pinterestContainer iframe").attr("src","http://d3io1k5o0zdpqr.cloudfront.net/pinit.html?url="+escape(document.location.href+"?scid=pinterest:pinbutton")+"&media="+escape(bc.video.Video._getCurrentVideoStillURL())+"&description="+escape("BabyCenter Video: "+bc.video.Video._getCurrentVideoDisplayName())+"&layout=horizontal");}};bc.video.Video._onAdStart=function(a){bc.video.Video._advertisingModule.showSponsorMessage(true);this._currentVideoDisplayName=this._getCurrentVideoDisplayName();};bc.video.Video._onAdComplete=function(a){bc.video.Video._advertisingModule.showSponsorMessage(false);this._didTrackingOnAdComplete=true;this._doOmnitureTracking(a);};bc.video.Video._onAdClick=function(a){bc.video.Video._advertisingModule.showSponsorMessage(false);};bc.video.Video._onExternalAd=function(a){var g;if(window.ActiveXObject){g=new ActiveXObject("Microsoft.XMLDOM");g.async=false;g.loadXML(a.ad);}else{if(window.XMLHttpRequest){g=(new DOMParser()).parseFromString(a.ad,"text/xml");}}var c=false;var f=new Object();var k=false;var j=new Object();var l=false;var h=new Object();f.type="videoAd";f.duration=g.firstChild.getAttribute("duration");f.trackStartURLs=g.firstChild.getAttribute("trackStartURLs").replace("[%Track Start URLs%]","").split(",");f.trackMidURLs=g.firstChild.getAttribute("trackMidURLs").replace("[%Track Mid URLs%]","").split(",");f.trackEndURLs=g.firstChild.getAttribute("trackEndURLs").replace("[%Track End URLs%]","").split(",");f.trackPointTime="0";j.type="Banner468x60";var b=g.firstChild.firstChild;for(var e=0;e<g.firstChild.childNodes.length;e++){var d=null;var m=null;if(b.firstChild){switch(b.nodeName){case"videoURL":c=true;f.videoURL=b.firstChild.nodeValue;break;case"videoClickURL":f.videoClickURL=b.firstChild.nodeValue;break;case"collapsedBannerURL":k=true;j.bannerURL=b.firstChild.nodeValue;break;case"collapsedBannerClickURL":j.bannerClickURL=b.firstChild.nodeValue;break;case"expandedBannerURL":l=true;h.bannerURL=b.firstChild.nodeValue;break;case"expandedBannerClickURL":h.bannerClickURL=b.firstChild.nodeValue;break;default:continue;}}b=b.nextSibling;}if(k){$("#logoAd").html("<span style='display: inline-block; vertical-align: top;'>Sponsored by&nbsp;</span><a href='"+j.bannerClickURL+"' target='_blank'><img src='"+j.bannerURL+"'/></a>");}if(l){if(h.bannerURL.match(/\.swf$/)){swfobject.embedSWF(h.bannerURL+"?clickTag="+h.bannerClickURL+"&clickTAG="+h.bannerClickURL,"mediumRectangleAd","301","250","9.0.0",false,null,{wmode:"opaque"},null);}else{$("#mediumRectangleAd").html("<a href='"+h.bannerClickURL+"' target='_blank'><img src='"+h.bannerURL+"'/></a>");}}if(c){bc.video.Video._advertisingModule.showAd(f);}};bc.video.Video._onStreamStart=function(a){if(!this._didTrackingOnAdComplete){this._currentVideoDisplayName=this._getCurrentVideoDisplayName();this._doOmnitureTracking(a);this._didTrackingOnAdComplete=false;}};bc.video.Video._onVideoComplete=function(b){var a=$(".videoPlaylist li a");if(a.length>0&&doCountdownToNextVideo&&a[0].href!=document.location.href){$("#videoPlayerCountdown").html('Next video begins in <span id="videoPlayerCountdownNumber"></span>&nbsp;seconds');this._startVideoCountDown(5,1000,this._gotoNextVideoAfterCountDown,$("#videoPlayerCountdownNumber")[0]);}};bc.video.Video._startVideoCountDown=function(d,b,a,f){var g=b;var e=a;var c=f;if(c==null){return;}c.count=function(h){if(h==-1){e();return;}c.innerHTML=h;setTimeout(function(){c.count(h-1);},g);};c.count(d);};bc.video.Video._gotoNextVideoAfterCountDown=function(){var a=$(".videoPlaylist li a");document.location.href=a[0].href+"#videoplaylist";};bc.video.Video._getCurrentVideoDisplayName=function(){var b=this._videoPlayerModule.getCurrentVideo();var a=b.displayName;return a;};bc.video.Video._getCurrentVideoStillURL=function(){var b=this._videoPlayerModule.getCurrentVideo();var a=b.videoStillURL;return a;};bc.video.Video._getCurrentAdUrl=function(){var b=this._advertisingModule.getCurrentAdProperties();var a=b.videoURL;return a;};bc.video.Video._getCurrentVideoId=function(){var b=this._videoPlayerModule.getCurrentVideo();var a=b.id;return a;};bc.video.Video._getCurrentVideoReferenceId=function(){var b=this._videoPlayerModule.getCurrentVideo();var a=b.referenceId;return a;};bc.video.Video._doOmnitureTracking=function(b){var a=b.type;s.eVar20=this._currentVideoDisplayName;var d="event16";var c="";if(document.location.hash=="#videoplaylist"){c=" | Auto Play";}if(bc.mobile){c=" Content | Mobile";}bc.frag.tracking.OmnitureManager.trackAction(d,{eVar20:"Standalone Video | "+this._getCurrentVideoDisplayName()+c},null);};bc.video.Video._updateParamValue=function(a,d,f){var e=new RegExp(d+"=[^&]*","g");var b=d+"="+f;var c=a.replace(e,b);return c;};bc.video.Video._setShareLinkURL=function(b){var a=$('meta[property="og:url"]').attr("content");if(!a){a="http://"+window.location.host+"/2_video_"+b+".bc";}this._socialModule.setLink(a);};function bcsyncroadblock(e){var c;c=$($.parseXML(e));var h=c.find("Companion[width='300'][height='250'] IFrameResource").text();var f=c.find("Companion[width='300'][height='250'] HTMLResource").text();var a=c.find("Companion[width='300'][height='250'] StaticResource").text();if(h!=""){$("#mediumRectangleAd").html('<iframe src="'+h+'" width="301" height="250" frameborder="0" scrolling="no"></iframe>');}else{if(f!=""){$("#mediumRectangleAd").html(f);}else{if(a!=""){var b=c.find("Companion[width='300'][height='250'] CompanionClickThrough").text();if(a.match(/\.swf$/)||c.find("Companion[width='300'][height='250'] StaticResource[creativeType*='flash']").length>0){if(!a.match(/\?/)){a=a+"?";}else{a=a+"&";}swfobject.embedSWF(a+"clickTag="+encodeURIComponent(b)+"&clickTAG="+encodeURIComponent(b),"mediumRectangleAd","301","250","9.0.0",false,null,{wmode:"opaque"},null);}else{$("#mediumRectangleAd").html('<a href="'+b+'" target="_blank"><img src="'+a+'" width="300" height="250"></a>');}}}}var i=c.find("Companion[width='88'][height='31'] IFrameResource").text();var d=c.find("Companion[width='88'][height='31'] HTMLResource").text();var g=c.find("Companion[width='88'][height='31'] StaticResource").text();if(i!=""&&$("#logoAd").html()==""){$("#logoAd").html('<iframe src="'+i+'" width="89" height="31" frameborder="0" scrolling="no"></iframe>');}else{if(d!=""&&$("#logoAd").html()==""){$("#logoAd").html(d);}}}function onAdReceived(a){var e=$($.parseXML(a.ad));var c=e.find("Companion[width='88'][height='31']");if(c.length>0&&$("#logoAd").html()==""){var b=c.find("StaticResource").text();var d=c.find("CompanionClickThrough").text();$("#logoAd").html("<span style='display: inline-block; vertical-align: top;'>Sponsored by&nbsp;</span><a href='"+d+"' target='_blank'><img src='"+b+"'/></a>");}}