function initBarScroll(){var i=document.getElementById("af_navUserBar"),n=document.getElementById("af_userBar"),c=document.getElementById("af_nav"),l=document.getElementById("af_headerDiv"),r=0,f=document.getElementById("af_navSites"),e=0,u,t;if(f!=undefined&&(e=f.offsetHeight),u=document.getElementById("af_fakeNavUserBar"),(document.doctype!=null||navigator.appName.indexOf("Microsoft")==-1)&&i!=null&&n!=null&&af_getCookie("cu")!=""){if(t=n,t.offsetParent)for(r=t.offsetTop;t=t.offsetParent;)r+=t.offsetTop;var h=document.documentElement.scrollTop|document.body.scrollTop,o=h>r+e,s=n.className.indexOf(" af_userBarFixed")>0;o&&!s?(i.style.position="fixed",n.className=n.className+" af_userBarFixed",u.style.display="block"):!o&&s&&(i.style.position="static",n.className=n.className.replace(" af_userBarFixed",""),u.style.display="none")}}function af_getCookie(n){for(var f,e,u=document.cookie.split(";"),i,o,r,t=0;t<u.length;t++)if(f=u[t].substr(0,u[t].indexOf("=")),e=u[t].substr(u[t].indexOf("=")+1),f=f.replace(/^\s+|\s+$/g,""),f=="afperso")for(r=e.split("&"),i=0;i<r.length;i++)if(o=r[i].substr(0,r[i].indexOf("=")),o==n)return unescape(r[i].substr(r[i].indexOf("=")+1));return""}function af_requestGet(n,t,i,r){var u=af_getXMLHttpRequest();i=i||null,r=r||!0,n.substr(0,1)=="/"&&(n=document.location.protocol+"//"+document.location.host+n),u.onreadystatechange=function(){u.readyState==4&&(u.status==200||u.status==0)&&(data=u.responseText?r?eval("("+u.responseText+")"):u.responseText:null,i&&i(data))},u.open("GET",n+"?"+t,!0),u.send(null)}function af_requestPost(n,t,i,r){var u=af_getXMLHttpRequest();i=i||null,r=r||!0,t+="&personalKey="+af_personalHashValue,n.substr(0,1)=="/"&&(n=document.location.protocol+"//"+document.location.host+n),u.onreadystatechange=function(){u.readyState==4&&(u.status==200||u.status==0)&&(data=u.responseText?r?eval("("+u.responseText+")"):u.responseText:null,i&&i(data))},u.open("POST",n,!0),u.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),u.setRequestHeader("X-Requested-With","XMLHttpRequest"),u.send(t)}function af_getXMLHttpRequest(){var n=null;if(window.XMLHttpRequest||window.ActiveXObject)if(window.ActiveXObject)try{n=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){n=new ActiveXObject("Microsoft.XMLHTTP")}else n=new XMLHttpRequest;return n}function af_urlencode(n){return n=(n+"").toString(),encodeURIComponent(n).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")}function af_findPos(n){if(!n||n==document.body)return{l:0,t:0};var i=t=0,r=document.body,u=n.offsetWidth,f=n.offsetHeight;if(n.offsetParent)for(i=n.offsetLeft-n.scrollLeft,t=n.offsetTop-n.scrollTop;n=n.offsetParent;)i+=n.offsetLeft-(n!=r?n.scrollLeft:0),t+=n.offsetTop-(n!=r?n.scrollTop:0);return{l:i,t:t,r:i+u,b:t+f,w:u,h:f}}function af_windowSize(){var i=window,n=document.documentElement,t=document.body,r=i.innerWidth?i.innerWidth:n&&n.clientWidth?n.clientWidth:t&&t.clientWidth?t.clientWidth:0,u=i.innerHeight?i.innerHeight:n&&n.clientHeight?n.clientHeight:t&&t.clientHeight?t.clientHeight:0,f=i.pageXOffset?i.pageXOffset:n&&n.scrollLeft?n.scrollLeft:t&&t.scrollLeft?t.scrollLeft:0,e=i.pageYOffset?i.pageYOffset:n&&n.scrollTop?n.scrollTop:t&&t.scrollTop?t.scrollTop:0;return{l:f,t:e,r:f+r,b:e+u,w:r,h:u}}function af_lazyloading(){af_lazyloading_timeout==null&&(af_lazyloading_timeout=setTimeout(af_lazyloading_real,50))}function af_lazyloading_real(){for(var r=af_windowSize(),u=af_lazyloading_imgs.length,n,i,t=0;t<u;t++)n=af_lazyloading_imgs[t],i=n.getAttribute("dataorigin"),i&&i!=""&&r.b+af_lazyloading_dist>=af_findPos(n).b&&(n.src=i,n.setAttribute("dataorigin",""));af_lazyloading_timeout=null}function af_gaqRePush(){var n=(""+document.location).replace(/^http:\/\/.*?\//gi,"/virtual/");typeof _gaq!="undefined"?_gaq.push(["_trackPageview",n]):typeof pageTracker!="undefined"&&pageTracker._trackPageview(n)}var AF_APP_FB,onloadorig,onscrollorig,af_dynamicSA;document.addEventListener?document.addEventListener("scroll",initBarScroll,!1):window.attachEvent&&window.attachEvent("onscroll",initBarScroll,!1),AF_FB_DEBUG=(document.location.href.indexOf("http://dev")!=-1||document.location.href.indexOf("http://local.")!=-1)&&console&&console.log,AF_APP_FB={initFB:function(){AF_FB_DEBUG&&console.log("AF_APP_FB => initFB"),FB.getLoginStatus(function(n){n.status==="connected"?(AF_FB_DEBUG&&console.log("Connected to Facebook => Fetching datas"),USER_FB.idFB=n.authResponse.userID,USER_FB.accessToken=n.authResponse.accessToken,AF_APP_FB.setInfoUser(),AF_APP_FB.initBar(),AF_APP_FB.showFacepileEdito()):(AF_FB_DEBUG&&console.log("Not connected to Facebook"),af_getCookie("fbid")!=""&&AF_APP_FB.deconnectFB(),n.status=="not_authorized"&&AF_APP_FB.showFacepileEdito())})},deconnectFB:function(){AF_FB_DEBUG&&console.log("AF_APP_FB => deconnectFB : Will refresh..."),setAfXperso("afperso","fbid",""),setAfXperso("afperso","timeline",""),setAfXperso("afperso","feature",""),setAfXperso("afperso","popup",""),window.location.reload()},initBar:function(){if(AF_FB_DEBUG&&console.log("AF_APP_FB => initBar, featuretour status = "+USER_FB.feature),AF_APP_FB.initPartage(!1),USER_FB.feature>0&&SITEID!=7&&SITEID!=8){var n,t="featuretour-script";if(document.getElementById(t))return;n=document.createElement("script"),n.id=t,n.async=!1,n.src="/world/static/js/featuretour.js",document.getElementsByTagName("head")[0].appendChild(n),AF_FB_DEBUG&&console.log("Load feature tour")}},initPartage:function(n){var t=document.getElementById("activationPartage"),i;t&&(i=n?af_getCookie("timeline")==1:USER_FB.timeline==1,i?(t.className="activationPartageOn",t.onclick=function(){AF_APP_FB.setPartage(0)}):(t.className="activationPartageOff",t.onclick=function(){AF_APP_FB.setPartage(1)}))},setInfoUser:function(){AF_FB_DEBUG&&console.log("AF_APP_FB => setInfoUser");var i=af_getCookie("timeline"),r=af_getCookie("feature"),t=af_getCookie("popup"),n=af_getCookie("fbid");n!=""&&parseFloat(n)>0&&t!=""?(AF_FB_DEBUG&&console.log("setInfoUser with valid cookies. cookieFbid = "+n),USER_FB.timeline=i,USER_FB.feature=r,USER_FB.popup=t):(AF_FB_DEBUG&&console.log("setInfoUser needs to ask server => AJAX"),FB.api("/me",function(n){USER_FB.fbun=n.name,af_requestGet("/world/communaute/users/users_og_ajax.asp","t=get&fbid="+USER_FB.idFB+"&fbun="+USER_FB.fbun,function(n){USER_FB.timeline=n.t,USER_FB.feature=n.f,USER_FB.popup=n.p,AF_APP_FB.setUserCookie(),typeof notFBConnectedBar=="undefined"&&(AF_APP_FB.setFriends(),AF_APP_FB.initBar())})}))},setUserCookie:function(){var n,t;AF_FB_DEBUG&&console.log("AF_APP_FB => setUserCookie"),n=af_getCookie("fbid"),setAfXperso("afperso","timeline",USER_FB.timeline),setAfXperso("afperso","feature",USER_FB.feature),setAfXperso("afperso","popup",USER_FB.popup),setAfXperso("afperso","fbid",USER_FB.idFB),n!=""&&parseFloat(n)>0||af_getCookie("cu")!=""||(AF_FB_DEBUG&&console.log("setUserCookie => Push Iframe with AuthURL"),t=document.createElement("div"),t.innerHTML='<div><iframe src="'+fbConnectAuthURL+'" border="0" scrolling="no" frameborder="0" hspace="0" style="position:absolute;"><\/iframe><\/div>',document.getElementById("af_btnFacebook").appendChild(t)),n==""&&typeof notFBConnectedBar!="undefined"&&window.location.reload()},setOffPopup:function(){USER_FB.popup=0,AF_APP_FB.setUserCookie(),af_requestGet("/world/communaute/users/users_og_ajax.asp","t=popup&v=0&fbid="+USER_FB.idFB)},setPartage:function(n){USER_FB.timeline=n,AF_APP_FB.setUserCookie(),AF_APP_FB.initPartage(!1),af_requestGet("/world/communaute/users/users_og_ajax.asp","t=timeline&v="+n+"&fbid="+USER_FB.idFB),n==1&&AF_APP_FB.share()},setFeatureTour:function(n){USER_FB.feature=n,AF_APP_FB.setUserCookie(),af_requestGet("/world/communaute/users/users_og_ajax.asp","t=feature_tour&v="+n+"&fbid="+USER_FB.idFB)},setDtLastClick:function(){document.getElementById("chiffre_pop").innerHTML=0,document.getElementById("chiffre").innerHTML=0,af_requestGet("/world/communaute/users/users_og_ajax.asp","t=dtLastClick&fbid="+USER_FB.idFB)},setFriends:function(){AF_FB_DEBUG&&console.log("AF_APP_FB => setFriends"),FB.api("/me/friends/",function(n){var r=n.data,u=r.length,i,t;for(AF_FB_DEBUG&&console.log("Friends found : "+r.length),i="",t=0;t<u;t++)i+=r[t].id,t!=u-1&&(i+=",");af_requestPost("/world/communaute/users/users_og_ajax.asp","t=addfriends&fbid="+USER_FB.idFB+"&flist="+i)})},showPopupPublication:function(){AF_FB_DEBUG&&console.log("AF_APP_FB => showPopupPublication"),USER_FB.popup==1&&(document.getElementById("af_popupPartage").style.display="block")},showFacepileEdito:function(){var n=document.getElementById("af_editoFacepile");n!=null&&(n.style.display="")},publishOnTimeline:function(n,t,i,r,u){USER_FB.timeline==1&&r>0&&u>0&&(typeof af_globalSocialVar.ogIdFb=="undefined"||af_globalSocialVar.ogIdFb==0)&&(n=af_urlencode(n),AF_FB_DEBUG&&console.log("AF_APP_FB => publishOnTimeline with: /me/"+i+"?"+t+"="+n+"&access_token="+USER_FB.accessToken),FB.api("/me/"+i+"?"+t+"="+n+"&access_token="+USER_FB.accessToken,"post",{expires_in:180},function(n){AF_FB_DEBUG&&console.log("Facebook sharing callback: "+n.id),n&&n.id&&(AF_FB_DEBUG&&console.log("Action published on fb, save it! ID="+n.id),af_globalSocialVar.ogIdFb=n.id,af_requestGet("/world/communaute/users/users_og_ajax.asp","t=addactivities&fbid="+USER_FB.idFB+"&ogid="+n.id+"&act="+i+"&obj="+t+"&objid="+r+"&ouid="+u),AF_APP_FB.showPopupPublication())}))},deleteAction:function(n){FB.api("/"+n+"?access_token="+USER_FB.accessToken,"delete",function(t){t&&(typeof af_globalSocialVar!="undefined"&&(af_globalSocialVar.ogIdFb=0),af_requestGet("/world/communaute/users/users_og_ajax.asp","t=kill&ogid="+n+"&fbid="+USER_FB.idFB))})},shareWithTimeout:function(){typeof af_globalSocialVar!="undefined"&&setTimeout(AF_APP_FB.share,af_globalSocialVar.timeToWait)},share:function(){AF_FB_DEBUG&&console.log("Try to share"),typeof af_globalSocialVar!="undefined"&&(AF_FB_DEBUG&&console.log("Autosharing"),AF_APP_FB.publishOnTimeline(af_globalSocialVar.url,af_globalSocialVar.ogType,af_globalSocialVar.ogAction,af_globalSocialVar.objid,af_globalSocialVar.ouid))}},typeof APP_FB_ID!="undefined"&&(window.fbAsyncInit=function(){AF_FB_DEBUG&&console.log("Facebook SDK loaded"),FB.init({appId:APP_FB_ID,status:!0,cookie:!0,xfbml:!0}),window.addEventListener?(window.addEventListener("load",AF_APP_FB.initFB,!1),window.addEventListener("load",AF_APP_FB.shareWithTimeout,!1)):window.attachEvent&&(window.attachEvent("onload",AF_APP_FB.initFB),window.attachEvent("onload",AF_APP_FB.shareWithTimeout)),USER_FB.idFB=af_getCookie("fbid"),AF_APP_FB.initPartage(!0)},function(n){var t,i="facebook-jssdk";n.getElementById(i)||(t=n.createElement("script"),t.id=i,t.async=!0,t.src="//connect.facebook.net/en_US/all.js",n.getElementsByTagName("head")[0].appendChild(t),AF_FB_DEBUG&&console.log("Load Facebook SDK"))}(document));var af_lazyloading_timeout=null,af_lazyloading_dist=200,af_lazyloading_imgs=document.getElementsByTagName("img");window.addEventListener?(window.addEventListener("load",af_lazyloading,!1),window.addEventListener("scroll",af_lazyloading,!1)):window.attachEvent?(window.attachEvent("onload",af_lazyloading),window.attachEvent("onscroll",af_lazyloading)):(onloadorig=window.onload,window.onload=function(){onloadorig&&onloadorig(),af_lazyloading()},onscrollorig=window.onscroll,window.onscroll=function(){onscrollorig&&onscrollorig(),af_lazyloading()}),af_dynamicSA={onScroll:function(){af_dynamicSA.update()},update:function(){var n,t;(this.links===undefined&&(this.links=this.getFirstElementWithClassName("afsa_relLinks","div")),this.links!=null)&&(this.startHeight===undefined&&(n=af_findPos(this.links),this.startHeight=n.t-150),this.generated==!0?this.updatePosition():(t=af_windowSize(),t.b>=this.startHeight&&(this.generated=!0,this.generate(),this.display())))},getFirstElementWithClassName:function(n,t){var i,r;if(document.getElementsByClassName){if(i=document.getElementsByClassName(n),i&&i.length>0)return i[0]}else for(i=document.getElementsByTagName(t),r=0;r<i.length;r++)if(i[r].className==n)return i[r];return null},generate:function(){var r,u,f,s,n,e,i,t,o;for(r=!0,u=7258372,f=7258367,s="af_dynamic_seealso3",this.mainDiv=document.createElement("div"),this.mainDiv.id=s,n="<a href=\"#\" class=\"close\" title=\"Fermer\" onclick=\"af_dynamicSA.mainDiv.style.display='none';setAfXperso('afperso', 'stopDySA', '1');return false;\">x<\/a>",e=Math.round(Math.random()*99999),n=n+'<img src="http://www.smartadserver.com/call/adimppixel/'+f+"/"+e+'?" width=1 height=1 border=0 style="position:absolute;">',n=n+"<b>Sur le même thème :<\/b>",n=n+"<ul>",i=this.links.getElementsByTagName("a"),t=0;t<i.length;t++)i[t].href.replace("http://","").split("/")[1]==""?(o=Math.round(Math.random()*99999),n=n+'<li class=homepage><img src="http://www.smartadserver.com/call/adimppixel/'+u+"/"+o+'?" width=1 height=1 border=0 style="position:absolute;"><a href="'+i[t].href+'" title="'+i[t].title+'" onmousedown="this.href=\'http://www.smartadserver.com/call/cliccommand/'+u+"/"+o+"?'+escape(this.href);this.onmousedown=null;\" >",r&&(n=n+'<img src="/world/semantic/link2img.asp?link='+escape(i[t].href)+'" width=30 height=30 border=0 class="teaser">'),n=n+i[t].innerHTML+"<\/a><\/li>"):(n=n+'<li><a href="'+i[t].href+'" title="'+i[t].title+'" onmousedown="this.href=\'http://www.smartadserver.com/call/cliccommand/'+f+"/"+e+"?'+escape(this.href);this.onmousedown=null;\" >",r&&(n=n+'<img src="/world/semantic/link2img.asp?link='+escape(i[t].href)+'" width=30 height=30 border=0 class="teaser">'),n=n+i[t].innerHTML+"<\/a><\/li>");n=n+"<\/ul>",this.mainDiv.innerHTML=n,document.body.appendChild(this.mainDiv)},display:function(){this.isIE()?this.displayAbsolute():this.displayFixed()},displayFixed:function(){this.bottom=-300,this.mainDiv.style.position="fixed",this.mainDiv.style.bottom=this.bottom+"px",this.displayInterval=setInterval(this.displayFixedCallback,20)},displayFixedCallback:function(){af_dynamicSA.bottom+=20,af_dynamicSA.mainDiv.style.bottom=af_dynamicSA.bottom+"px",af_dynamicSA.bottom>0&&clearInterval(af_dynamicSA.displayInterval)},displayAbsolute:function(){this.top=0,this.mainDiv.style.position="absolute";var n=af_windowSize().b;this.mainDiv.style.top=n-this.top+"px",this.displayInterval=setInterval(this.displayAbsoluteCallBack,20)},displayAbsoluteCallBack:function(){var n,t;af_dynamicSA.top+=20,n=af_windowSize().b,af_dynamicSA.mainDiv.style.top=n-af_dynamicSA.top+"px",t=af_dynamicSA.mainDiv.offsetHeight,af_dynamicSA.top>t&&clearInterval(af_dynamicSA.displayInterval)},updatePosition:function(){var t=af_windowSize(),n=t.b;this.isIE()?n>=this.startHeight&&(this.mainDiv.style.top=n-this.top+"px"):n<this.startHeight?this.mainDiv.style.position=="fixed"&&(this.mainDiv.style.position="absolute",this.mainDiv.style.bottom=0-t.t+this.bottom+"px"):(this.mainDiv.style.position="fixed",this.mainDiv.style.bottom=this.bottom+"px")},isIE:function(){return navigator.appName=="Microsoft Internet Explorer"}},typeof SITEID!="undefined"&&SITEID==1&&af_getCookie("stopDySA")!="1"&&(window.addEventListener?window.addEventListener("scroll",af_dynamicSA.onScroll,!1):window.attachEvent&&window.attachEvent("onscroll",af_dynamicSA.onScroll))