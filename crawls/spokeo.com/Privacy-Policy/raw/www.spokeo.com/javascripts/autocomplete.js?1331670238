
AutoComplete=Class.create();AutoComplete.Remote=Class.create();AutoComplete.START=1;AutoComplete.GLOBAL=2;AutoComplete.WORDS=3;AutoComplete.STATUS_FAMOUS_REDIRECT=2;AutoComplete.STATUS_DISAMBIGUATION=1;AutoComplete.STATUS_NORMAL=0;AutoComplete.DefaultOptions={caseSensitive:false,matching:AutoComplete.START,showIfEmpty:false,onSelect:null};AutoComplete.Remote.DefaultOptions={minLength:3};AutoComplete.prototype={initialize:function(element,dataArray,displayArray,options){element=$(element);if(!element||!element.parentNode||(element.tagName||'').toLowerCase()!='input'||(element.getAttribute('type')||'').toLowerCase()!='text')return;this.options=Object.extend(Object.extend({},AutoComplete.DefaultOptions),options||{});if(typeof this.options.onSelect!='function')this.options.onSelect=null;this.dataArray=dataArray||[];this.displayArray=(displayArray&&displayArray.length==this.dataArray.length)?displayArray:this.dataArray;this.displayedIndexes=[];this.displayedIndex=-1;this.element=element;this.visible=false;this.container=document.createElement('div');this.container.style.display='none';this.container.className='autocomplete';this.container.appendChild(document.createElement('div'));try{if(this.options.cityFlag!="findByCity")
{if(AutoComplete.documentLoaded)this.element.parentNode.appendChild(this.container);else Event.observe(window,'load',function(){this.element.parentNode.appendChild(this.container);}.bind(this));}}
catch(e)
{}
this.valueDivOnclick=function(e){var elem=Event.element(window.event||e);while(elem&&!elem.className.match('autocomplete_value'))
elem=elem.parentNode;this.displayedIndex=elem.displayedIndex;this.valueChosen();this.element.focus();return false;}.bind(this);Event.observe(this.element,'keydown',this.onKeyDown.bindAsEventListener(this),false);Event.observe(this.element,'keyup',this.onKeyUp.bindAsEventListener(this),false);Event.observe(this.element,'click',this.onClick.bindAsEventListener(this),false);Event.observe(this.element,'focus',this.onFocus.bindAsEventListener(this),false);Event.observe(this.element,'blur',this.onBlur.bindAsEventListener(this),false);Event.observe(document,'click',this.hide.bindAsEventListener(this),false);AutoCompleteManager.register(this);},show:function(){if(!this.visible)this.displayedIndex=-1;this.updateValue();if(this.displayedIndexes.length>0){this.initPosition();this.visible=true;Element.show(this.container);}else if(this.visible){this.hide();}},hide:function(){this.visible=false;Element.hide(this.container);},updateValue:function(){this.valueUpdated=true;var compareVal=this.options.caseSensitive?this.element.value:this.element.value.toLowerCase();var prevIndex=this.dataArrayIndex();this.displayedIndexes=[];this.selectedElem=null;var valuesDiv=document.createElement('div');valuesDiv.className='autocomplete_values';if(compareVal.length>0||this.options.showIfEmpty){for(var i=0;i<this.displayArray.length;i++){var arrayVal=this.displayArray[i]?this.displayArray[i].toString():'';var compareArrayVal=this.options.caseSensitive?arrayVal:arrayVal.toLowerCase();var index=compareArrayVal.indexOf(compareVal);var isMatched=false;switch(this.options.matching){case AutoComplete.START:isMatched=(index==0);break;case AutoComplete.GLOBAL:isMatched=(index!=-1);break;case AutoComplete.WORDS:if(index==0){isMatched=true;break;}
while(index!=-1){var c=arrayVal.charAt(index-1);isMatched=(c==' '||c=='(');if(isMatched)break;index=compareArrayVal.indexOf(compareVal,index+1);}
break;}
if(isMatched){var valueDiv=document.createElement('a');valueDiv.href='#';valueDiv.onclick=this.valueDivOnclick;valueDiv.displayedIndex=this.displayedIndexes.length;valueDiv.className=(i==prevIndex)?'autocomplete_value autocomplete_selected':'autocomplete_value';valueDiv.innerHTML=arrayVal.substring(0,index)+'<span class="autocomplete_highlight">'+
arrayVal.substring(index,index+compareVal.length)+'</span>'+
arrayVal.substring(index+compareVal.length);valuesDiv.appendChild(valueDiv);if(i==prevIndex){this.selectedElem=valueDiv;this.displayedIndex=this.displayedIndexes.length;}
this.displayedIndexes.push(i);}}}
this.container.replaceChild(valuesDiv,this.container.firstChild);if(!this.selectedElem)this.displayedIndex=-1;},selectPrevious:function(){if(this.displayedIndex<1)return;this.select(-1);},selectNext:function(){if(this.displayedIndex>=this.displayedIndexes.length-1)return;this.select(1);},dataArrayIndex:function(){return(this.displayedIndex==-1?-1:this.displayedIndexes[this.displayedIndex]);},onKeyDown:function(event){if(event.altKey||event.ctrlKey||event.metaKey)return;switch(event.keyCode){case Event.KEY_TAB:case Event.KEY_RETURN:if(this.visible){this.valueChosen();if(this.displayedIndex>-1){Event.stop(event);return false;}}
break;case Event.KEY_ESC:if(this.visible){this.hide();Event.stop(event);}
break;case Event.KEY_UP:this.visible?this.selectPrevious():this.show();Event.stop(event);break;case Event.KEY_DOWN:this.visible?this.selectNext():this.show();Event.stop(event);break;case Event.KEY_LEFT:case Event.KEY_RIGHT:case Event.KEY_HOME:case Event.KEY_END:case Event.KEY_PAGEUP:case Event.KEY_PAGEDOWN:break;default:this.allowUpdateValue=true;}},onKeyUp:function(){if(this.allowUpdateValue){this.allowUpdateValue=false;this.show();}},onClick:function(){try{var input_underlay=$('input_underlay');var p="[a-zA-Z]{1,}\\s[a-zA-Z]{2,}, Enter a City";var commaPos=input_underlay.value.search(", Enter a City");var pos=this.getCaretPosition(this.element);if(input_underlay.value.strip().match(p)){hide($('input_underlay'));if(pos<commaPos){input_underlay.value=input_underlay.value.replace(', Enter a City','');this.element.focus();this.setCaretPosition(this.element,pos);}else{input_underlay.value=input_underlay.value.replace(', Enter a City',', ');this.element.value=this.element.value+', ';this.element.focus();this.setCaretPosition(this.element,commaPos+2);}}}catch(e){}},onFocus:function(){if(this.alreadyFocused){}else{this.alreadyFocused=true;hide($('input_underlay'));this.element.focus();this.setCaretPosition(this.element,this.element.value.length);}},onBlur:function(){this.alreadyFocused=false;var p="[a-zA-Z]{1,}\\s[a-zA-Z]{2,},\\s*$";if(this.element.value.match(p)){var commaPos=this.element.value.search(", $");this.element.value=this.element.value.replace(/,\s*$/,'');this.element.focus();this.setCaretPosition(this.element,commaPos);}},setCaretPosition:function(o,pos){if(o.setSelectionRange){o.focus();o.setSelectionRange(pos,pos);}
else if(o.createTextRange){var range=o.createTextRange();range.collapse(true);range.moveEnd('character',pos);range.moveStart('character',pos);range.select();}},getCaretPosition:function(o){var CaretPos=0;if(document.selection){o.focus();var sel=document.selection.createRange();sel.moveStart('character',-o.value.length);CaretPos=sel.text.length;}
else if(o.selectionStart||o.selectionStart=='0')
CaretPos=o.selectionStart;return CaretPos;},select:function(incr){this.displayedIndex+=incr;if(this.selectedElem)this.selectedElem.className='autocomplete_value';this.selectedElem=this.container.firstChild.childNodes[this.displayedIndex];this.selectedElem.className='autocomplete_value autocomplete_selected';var scrollTop=this.container.firstChild.scrollTop;var scrollBottom=scrollTop+this.container.firstChild.offsetHeight;var elemTop=this.selectedElem.offsetTop;var elemBottom=elemTop+this.selectedElem.offsetHeight;if(elemTop<scrollTop)this.container.firstChild.scrollTop=elemTop;else if(elemBottom>scrollBottom)this.container.firstChild.scrollTop=elemBottom-this.container.firstChild.offsetHeight;},valueChosen:function(){this.hide();if(this.displayedIndex>-1){this.element.value=(this.dataArray[this.dataArrayIndex()]||'').toString();if(this.options.onSelect)this.options.onSelect(this.element.value);}},initPosition:function(){var x=this.getX(this.element);var y=this.getY(this.element);if(this.positionInitialized&&this.x==x&&this.y==y)return;this.positionInitialized=true;this.x=x;this.y=y;this.w=this.getW(this.element);this.container.style.position='absolute';this.container.style.left=this.x+'px';this.container.style.top=this.y+'px';this.container.style.width=this.w+'px';},getX:function(elem){return this.left(elem);},getY:function(elem){return this.top(elem)+this.height(elem);},getW:function(elem){return this.width(elem);},left:function(elem){return elem?((Prototype.Browser.IE?elem.clientLeft+elem.offsetLeft:elem.offsetLeft)+this.left(elem.offsetParent)):0;},top:function(elem){return elem?((Prototype.Browser.IE?elem.clientTop+elem.offsetTop:elem.offsetTop)+this.top(elem.offsetParent)):0;},width:function(elem){return elem.offsetWidth;},height:function(elem){return elem.offsetHeight;}};Object.extend(Object.extend(AutoComplete.Remote.prototype,AutoComplete.prototype),{initialize:function(element,url,options){options=Object.extend(Object.extend({},AutoComplete.DefaultOptions),options||{});AutoComplete.prototype.initialize.call(this,element,[],[],options);this.url=url;this.tries=0;this.complete=true;},show:function(){if(this.element.value.strip().length>=this.options.minLength){this.updateValue();}else if(this.visible){this.hide();}},updateValue:function(tries){var t=tries||++this.tries;if(this.complete){this.complete=false;if(t==this.tries){var q=this.element.value;new Ajax.Request(this.url,{asynchronous:true,evalScripts:false,parameters:('q='+q.strip()),onComplete:function(r){this.onUpdate(r,q,t);}.bind(this)});}else{this.complete=true;}}else{setTimeout(function(){this.updateValue(t);}.bind(this),100);}},onUpdate:function(req,query,tries){var validResponse=this.handleResponse(req,query);if(tries==this.tries){this.displayedIndexes=[];this.selectedElem=null;var valuesDiv=document.createElement('div');valuesDiv.className='autocomplete_values';for(var i=0;i<this.dataArray.length;i++){var valueDiv=document.createElement('a');valueDiv.href='#';valueDiv.displayedIndex=this.displayedIndexes.length;valueDiv.className='autocomplete_value';valueDiv.innerHTML=this.displayArray[i];valueDiv.onclick=this.valueDivOnclick;valuesDiv.appendChild(valueDiv);this.displayedIndexes.push(i);}
if(tries==this.tries){this.container.replaceChild(valuesDiv,this.container.firstChild);this.displayedIndex=-1;if(this.displayedIndexes.length>0){this.initPosition();this.visible=true;try{$('city_filter_input').className="reset_edges";}catch(e)
{}
Element.show(this.container);}else if(this.visible){this.hide();}}}
this.complete=true;},handleResponse:function(request,query){var values=null;try{values=eval(request.responseText);}catch(e){}
if(!values||!(values instanceof Array))return false;this.dataArray=values;this.displayArray=values;return true;}});AutoCompleteManager={nextId:1,autoCompletes:{},register:function(autoComplete){var id='autocomplete_'+(autoComplete.element.id||this.nextId++);while(this.autoCompletes[id])id='autocomplete_'+this.nextId++;autoComplete.id=id;autoComplete.container.id=id;this.autoCompletes[id]=autoComplete;}};Event.observe(window,'load',function(){AutoComplete.documentLoaded=true;});AutoComplete.Spokeo=Class.create();Object.extend(Object.extend(AutoComplete.Spokeo.prototype,AutoComplete.Remote.prototype),{handleResponse:function(request,query){var values=null;try{values=eval(request.responseText);}catch(e){}
if(!values||!(values instanceof Array))return false;this.dataArray=[];this.displayArray=[];var q=query.match(/^www\.(.+)/i);if(q)query=q[1];var query_split=query.split(' ');if(query_split.length>2){if(!query_split[1].match(/^.+,$/)){query_split[1]=query_split[1]+',';}}
query=query_split.join(' ');var r=new RegExp('^('+query.strip()+')(.*)$','i');for(var i=0;i<values.length;i++){var m=null;var display='';var name=values[i][0];var url=values[i][1];if(url&&(m=url.match(/^http:\/\/(www\.)?(.+)/i)))url=m[2];if(m=name.match(r)){display='<b>'+m[1]+'</b>'+m[2]+'<span>'+url+'</span>';}else if(m=url.match(r)){display=name+'<span>'+'<b>'+m[1]+'</b>'+m[2]+'</span>';}else{display=name+'<span>'+url+'</span>';}
this.dataArray.push(name);this.displayArray.push(display);}
return true;}});AutoComplete.NameCityHomeSearch=Class.create(AutoComplete.Remote,{initialize:function(element,url,options){AutoComplete.Remote.prototype.initialize.call(this,element,url,options);this.globalSearch=$(this.options.searchFlagInput);this.sideSelection="left";this.dataListings=[];this.dataListingIndex=-1;this.selectedElem=null;this.container.className='name_autocomplete';Event.observe(this.element,'onchange',this.onChange.bindAsEventListener(this),false);this.initPosition();},normalize_input:function(input){var normalized=input.replace(/[^a-zA-Z0-9\s]/gi,'').toLowerCase().strip();normalized=normalized.replace(/\s+(?= )/g,'');return normalized;},selectPrevious:function(){if(this.sideSelection=="left")
{if(this.displayedIndex<1)return;}
else
{if(this.dataListingIndex<0)return;}
this.select(-1);},selectNext:function(){if(this.sideSelection=="left")
{if(this.displayedIndex>=this.displayedIndexes.length-1)return;}
else
{if(this.dataListingIndex>=this.dataListings.length-1)return;}
this.select(1);},onKeyDown:function(event){if(event.altKey||event.ctrlKey||event.metaKey)return;switch(event.keyCode){case Event.KEY_TAB:case Event.KEY_RETURN:if(this.visible){this.valueChosen();if(this.displayedIndex>-1){Event.stop(event);return false;}}
break;case Event.KEY_ESC:if(this.visible){this.hide();Event.stop(event);}
break;case Event.KEY_UP:this.visible?this.selectPrevious():this.show();Event.stop(event);break;case Event.KEY_DOWN:this.visible?this.selectNext():this.show();Event.stop(event);break;case Event.KEY_LEFT:this.sideSelection="left";this.dataListingIndex=-1;if(this.selectedListing){this.activateBorder();this.selectedListing.className='autocomplete_namedata_listing';}
if(this.selectedElem){this.toggleHighlight(this.selectedElem,"active");}
break;case Event.KEY_RIGHT:if(this.displayedIndex<0)
return;if(this.selectedElem){var resultType=this.selectedElem.resultType;if(resultType=="name")
{this.sideSelection="right";this.toggleHighlight(this.selectedElem,"blue");this.visible?this.highlightFirstListing():this.show();}}
break;case Event.KEY_HOME:case Event.KEY_END:case Event.KEY_PAGEUP:case Event.KEY_PAGEDOWN:break;default:this.allowUpdateValue=true;}},highlightFirstListing:function(){if(this.dataListingIndex<0||this.dataListingIndex>this.dataListings.length-1)
{var nameDataDiv=document.getElementById('nameData');if(this.selectedListing)
this.selectedListing.className='autocomplete_namedata_listing';var listings=nameDataDiv.childNodes[0];this.selectedListing=listings.firstChild;this.selectedListing.className='autocomplete_listing_selected';if(this.selectedListing.listType=="fp_listing"){this.selectedListing.className="autocomplete_listing_selected fp_highlight";}
this.dataListingIndex++;}},onChange:function(){this.sideSelection="left";},onFocus:function(){this.sideSelection="left";if(this.alreadyFocused){}else{this.alreadyFocused=true;hide($('input_underlay'));this.element.focus();this.setCaretPosition(this.element,this.element.value.length);}},onBlur:function(){this.sideSelection="left";this.alreadyFocused=false;var p="[a-zA-Z]{1,}\\s[a-zA-Z]{2,},\\s*$";if(this.element.value.match(p)){var commaPos=this.element.value.search(", $");this.element.value=this.element.value.replace(/,\s*$/,'');this.element.focus();this.setCaretPosition(this.element,commaPos);}},valueOnMouseClick:function(e){try
{var elem=(e.currentTarget)?e.currentTarget:e.srcElement;if(elem.tagName!='LI')
{while(elem.tagName!='LI')
{elem=elem.parentNode;}}
this.displayedIndex=elem.displayedIndex;this.selectedElem=this.container.firstChild.childNodes[this.displayedIndex];this.valueChosen();this.element.focus();return false;}
catch(e)
{}},fpOnClick:function(){this.fpValueChosen();this.element.focus();return false;},valueOnMouseOver:function(e){try
{var elem=(e.currentTarget)?e.currentTarget:e.srcElement;this.displayedIndex=elem.displayedIndex;if(this.selectedElem)
{this.removeHighlight(this.selectedElem);}
this.selectedElem=this.container.firstChild.childNodes[this.displayedIndex];this.createHighlight(this.selectedElem);if(this.selectedElem.resultType=="name")
{this.showNameData();}
else
{var nameData=document.getElementById("nameData");nameData.style.display="none";}}
catch(e)
{}},listingMouseOver:function(e){try{var elem=(e.currentTarget)?e.currentTarget:e.srcElement;if(elem.tagName!='LI')
{while(elem.tagName!='LI')
{elem=elem.parentNode;}}
if(this.selectedElem)
{this.toggleHighlight(this.selectedElem,"blue");}
if(this.selectedListing)
{this.activateBorder();this.selectedListing.className="autocomplete_namedata_listing";}
this.selectedListing=elem;this.selectedListing.className='autocomplete_listing_selected';this.fadeBorder();if(this.selectedListing.listType=="fp_listing"){this.selectedListing.className="autocomplete_listing_selected fp_highlight";}}
catch(e)
{}},select:function(incr){if(this.sideSelection=="right")
{if(this.selectedElem)
{this.toggleHighlight(this.selectedElem,"blue");}
this.dataListingIndex+=incr;if(this.selectedListing){this.activateBorder();this.selectedListing.className='autocomplete_namedata_listing';}
try
{var dataDiv=document.getElementById('nameData');var listings=dataDiv.firstChild;this.selectedListing=listings.childNodes[this.dataListingIndex];this.selectedListing.className='autocomplete_listing_selected';this.fadeBorder();if(this.selectedListing.listType=="fp_listing"){this.selectedListing.className="autocomplete_listing_selected fp_highlight";}}
catch(e){}}
else{this.displayedIndex+=incr;if(this.selectedListing){this.selectedListing.className='autocomplete_namedata_listing';}
if(this.selectedElem){this.removeHighlight(this.selectedElem);}
this.selectedElem=this.container.firstChild.childNodes[this.displayedIndex];this.createHighlight(this.selectedElem);var selectedRecord=this.dataArray[this.displayedIndex];if(this.selectedElem.resultType=="name")
{this.element.value=selectedRecord.query;z('input_underlay').value=this.element.value+', Enter a City';this.showNameData();}
else
{this.element.value=selectedRecord.query+", "+selectedRecord.city_data;z('input_underlay').value=this.element.value+', Enter a City';var nameData=document.getElementById("nameData");nameData.style.display="none";}}
try{var scrollTop=this.container.firstChild.scrollTop;var scrollBottom=scrollTop+this.container.firstChild.offsetHeight;var elemTop=this.selectedElem.offsetTop;var elemBottom=elemTop+this.selectedElem.offsetHeight;if(elemTop<scrollTop)this.container.firstChild.scrollTop=elemTop;else if(elemBottom>scrollBottom)this.container.firstChild.scrollTop=elemBottom-this.container.firstChild.offsetHeight;}catch(e)
{}},fadeBorder:function(){try
{this.selectedListing.className="autocomplete_listing_selected fade_listing_border";var elem=this.selectedListing.previousSibling;elem.style.borderBottom='1px solid #fff';}
catch(e)
{}},activateBorder:function(){try
{var nameData=document.getElementById('nameData');var listings=nameData.firstChild;for(var i=0;i<listings.childNodes.length;i++)
{listings.childNodes[i].style.borderBottom='1px solid #f0f0f0';}}
catch(e)
{}},createHighlight:function(elem){try
{elem.className='name_autocomplete_selected';if(elem.resultType=="name"){var arrowDiv=document.createElement('div');arrowDiv.className='autocomplete_arrow';if(BrowserDetect.browser=="Explorer"){arrowDiv.style.left=this.arrowLeft;}
elem.appendChild(arrowDiv);}}
catch(e)
{}},removeHighlight:function(elem){elem.className='name_autocomplete_value';if(elem.resultType=="name")
elem.removeChild(elem.lastChild);},toggleHighlight:function(elem,color){try
{var arrowDiv;elem.className='name_autocomplete_selected';if(elem.resultType=="name")
arrowDiv=elem.lastChild;if(color=="active")
{elem.style.className="name_autocomplete_selected active_highlight";arrowDiv.className="autocomplete_arrow active_arrow"}
else
{elem.className="name_autocomplete_selected fade_highlight";arrowDiv.className="autocomplete_arrow fade_arrow"}}
catch(e)
{}},showNameData:function(){this.dataListingIndex=-1;this.dataListings=[];var nameDataDiv=document.getElementById("nameData");nameDataDiv.innerHTML="";var listings=document.createElement('ul');var nameData=(this.dataArray[this.displayedIndex]).query_data;var displayStyle=nameData.status;switch(displayStyle){case AutoComplete.STATUS_FAMOUS_REDIRECT:this.famousPersonLink(listings,nameData);this.otherListings(listings,nameData);break;case AutoComplete.STATUS_DISAMBIGUATION:this.otherListings(listings,nameData);this.famousPersonLink(listings,nameData);break;case AutoComplete.STATUS_NORMAL:this.otherListings(listings,nameData);break;}
nameDataDiv.appendChild(listings);nameDataDiv.style.display="block";},famousPersonLink:function(listings,nameData){var famousPersonElement=document.createElement('li');famousPersonElement.displayedIndex=this.displayedIndex;famousPersonElement.className='autocomplete_namedata_listing';Event.observe(famousPersonElement,'click',this.fpOnClick.bindAsEventListener(this),false);Event.observe(famousPersonElement,'mouseover',this.listingMouseOver.bindAsEventListener(this),false);famousPersonElement.setStyle({height:'56px'});famousPersonElement.innerHTML+=nameData.profile_image;if(nameData.display_name==null)
{nameData.display_name=(this.dataArray[this.displayedIndex]).query}
famousPersonElement.innerHTML+="<h1>"+nameData.display_name+"</h1>";if(nameData.occupation!=null)
{famousPersonElement.innerHTML+="<h2>"+nameData.occupation+"</h2>";}
listings.appendChild(famousPersonElement);this.dataListings.push("fp_listing");famousPersonElement.listType="fp_listing";},otherListings:function(listings,nameData){var name=(this.dataArray[this.displayedIndex]).query;var allMatchesListing=document.createElement('li');Event.observe(allMatchesListing,'mouseover',this.listingMouseOver.bindAsEventListener(this),false);var peopleIcon=document.createElement("div");peopleIcon.id="listing_icon";allMatchesListing.displayedIndex=this.displayedIndex;var dataDiv=document.createElement('div');dataDiv.className="listing_data";if(nameData.all_count>0){dataDiv.innerHTML+="<span>"+nameData.all_count+" People Found</span>";peopleIcon.className="active_people";allMatchesListing.className="autocomplete_namedata_listing";Event.observe(allMatchesListing,'click',this.valueOnMouseClick.bindAsEventListener(this),false);}
else{dataDiv.innerHTML+='<span>No Matches Found</span>';peopleIcon.className="inactive_people";allMatchesListing.className="autocomplete_namedata_listing_empty";}
this.dataListings.push("all_listing");allMatchesListing.listType="all_listing";allMatchesListing.appendChild(peopleIcon);allMatchesListing.appendChild(dataDiv);var celebrityListing=document.createElement('li');Event.observe(celebrityListing,'mouseover',this.listingMouseOver.bindAsEventListener(this),false);var celebIcon=document.createElement("div");celebIcon.id="listing_icon";var celebDataDiv=document.createElement('div');celebDataDiv.className="listing_data";if(nameData.fp_count>0){var name_url=name.replace(/\s/,'+');celebDataDiv.innerHTML+="<a href='/famous/"+name_url+"'><span>"+nameData.fp_count+" Celebrity Listings Found</span></a>";celebIcon.className="active_celeb";celebrityListing.className="autocomplete_namedata_listing";}
else{celebDataDiv.innerHTML+="<span>No Celebrity Listings Found</span>";celebIcon.className="inactive_celeb";celebrityListing.className="autocomplete_namedata_listing_empty";}
this.dataListings.push("celeb_listing");celebrityListing.listType="celeb_listing";celebrityListing.appendChild(celebIcon);celebrityListing.appendChild(celebDataDiv);listings.appendChild(allMatchesListing);listings.appendChild(celebrityListing);},valueChosen:function(){this.hide();this.element.onEnter=null;if(this.sideSelection=="right")
{var type=this.dataListings[this.dataListingIndex];if(type=="fp_listing")
{this.fpValueChosen();return;}
else if(type=="celeb_listing")
{this.celebListingChosen();return;}}
if(this.displayedIndex>-1){var selectedElement=this.dataArray[this.dataArrayIndex()];var value;if(selectedElement!=null)
{if(selectedElement.query_data){value=selectedElement.query;this.globalSearch.value="all_name_search";}
else if(selectedElement.city_data){value=selectedElement.query+", "+selectedElement.city_data;this.globalSearch.value="name_city_search";}}
this.element.value=(value||'').toString();z('input_underlay').value=this.element.value+', Enter a City';if(this.options.onSelect){this.options.onSelect(this.element.value);}}},celebListingChosen:function(){this.hide();if(this.displayedIndex>-1){var name=this.dataArray[this.dataArrayIndex()].query;var nameData=this.dataArray[this.dataArrayIndex()].query_data;if(nameData.fp_count>0)
{var name_url=name.replace(/\s/,'+');var url="famous/"+name_url;this.element.value=(name||'').toString();this.globalSearch.value=(url||'').toString();z('input_underlay').value=this.element.value;if(this.options.onSelect){this.options.onSelect(this.element.value);}}}},fpValueChosen:function(){this.hide();if(this.displayedIndex>-1){var nameData=this.dataArray[this.dataArrayIndex()].query_data;this.globalSearch.value=(nameData.url_key||'').toString();this.element.value=(nameData.display_name||'').toString();z('input_underlay').value=this.element.value;if(this.options.onSelect){this.options.onSelect(this.element.value);}}},updateValue:function(tries){var t=tries||++this.tries;if(this.complete){this.complete=false;if(t==this.tries){var q=this.element.value;if(this.ac_type=="name_autocomplete"){q=this.normalize_input(q);}
new Ajax.Request(this.url,{asynchronous:true,evalScripts:false,parameters:('q='+q.strip()+'&ac_type='+this.ac_type),onComplete:function(r){this.onUpdate(r,q,t);}.bind(this)});}else{this.complete=true;}}else{setTimeout(function(){this.updateValue(t);}.bind(this),100);}},onUpdate:function(req,query,tries){this.handleResponse(req,query);if(tries==this.tries){this.displayedIndexes=[];this.selectedElem=null;this.container.innerHTML="<div></div>";this.sideSelection="left";var valuesDiv=document.createElement('ul');valuesDiv.className='name_autocomplete_values';for(var i=0;i<this.dataArray.length;i++){var result=this.dataArray[i];var resultType=(result.query_data)?"name":"city";var nameDiv=document.createElement('li');nameDiv.className='name_autocomplete_value';nameDiv.resultType=resultType;nameDiv.displayedIndex=this.displayedIndexes.length;nameDiv.innerHTML=this.displayArray[i];if(i==0)
{this.createHighlight(nameDiv);this.selectedElem=nameDiv;}
Event.observe(nameDiv,'click',this.valueOnMouseClick.bindAsEventListener(this),false);Event.observe(nameDiv,'mouseover',this.valueOnMouseOver.bindAsEventListener(this),false);valuesDiv.appendChild(nameDiv);this.displayedIndexes.push(i);}
var nameDataDiv=document.createElement('div');nameDataDiv.setAttribute('id',"nameData");nameDataDiv.className='autocomplete_namedata';valuesDiv.appendChild(nameDataDiv);this.container.replaceChild(valuesDiv,this.container.firstChild);this.displayedIndex=0;if(this.displayedIndexes.length>0){this.visible=true;Element.show(this.container);this.showNameData();}else if(this.visible){this.hide();}}
this.complete=true;},handleResponse:function(request,query){var values=null;try{values=eval(request.responseText);}catch(e){}
if(!values)return false;this.dataArray=[];this.displayArray=[];values=request.responseText.evalJSON(true);for(var i=0;i<values.length;i++){var result=values[i];var suggestedQuery=result.query;var pattern;if(result.query_data)
{var m=null;var display=null;pattern=new RegExp('^('+query.strip()+')(.*)$','i');if(m=suggestedQuery.match(pattern)){display=m[1]+'<b>'+m[2]+'</b>';}}
else if(result.city_data){var query_split=query.split(' ');if(query_split.length>2){if(!query_split[1].match(/^.+,$/)){query_split[1]=query_split[1]+',';}}
query=query_split.join(' ');pattern=new RegExp('^('+query.strip()+')(.*)$','i');suggestedQuery=suggestedQuery+", "+result.city_data;if(m=suggestedQuery.match(pattern)){display=m[1]+'<b>'+m[2]+'</b>';}}
this.displayArray.push(display);this.dataArray.push(result);}
return true;},show:function(elem){var cityPattern="[a-zA-Z0-9]{1,}\\s[a-zA-Z0-9\\s]{1,},?\\s[a-zA-Z0-9\\s]{3,}";var namePattern="[a-zA-Z0-9]{1,}\\s[a-z0-9A-Z]{1,}";var enterCityPattern="^[a-zA-Z]{1,}\\s[a-zA-Z]{2,}$";if(!z('input_underlay')){var input_underlay=document.createElement('input');input_underlay.id='input_underlay';input_underlay.tabIndex=-1;this.element.parentNode.insertBefore(input_underlay,this.element);}
hide($('input_underlay'));if(this.element.value.strip().match(enterCityPattern))
{z('input_underlay').value=this.element.value+', Enter a City';show(z('input_underlay'));}else{hide($('input_underlay'));}
if(this.element.value.strip().match(cityPattern)){this.ac_type="city_autocomplete";this.updateValue();}else if(this.element.value.strip().match(namePattern)){this.ac_type="name_autocomplete";this.updateValue();}
if(this.visible){this.hide();}
this.complete=true;},initPosition:function(){this.container.className="name_autocomplete home_autocomplete";}});AutoComplete.NameCityHeaderSearch=Class.create(AutoComplete.NameCityHomeSearch,{initPosition:function(){this.container.className="name_autocomplete header_autocomplete";var header=$$('div.header_search');header.each(function(item){item.className="header_search ac_header";});if(BrowserDetect.browser=="Explorer")
{this.arrowLeft='46%';}}});AutoComplete.SplitHomeSearch=Class.create(AutoComplete.Remote,{initialize:function(element,cityElement,url,options){AutoComplete.Remote.prototype.initialize.call(this,element,url,options);cityElement=$(cityElement);this.cityElement=cityElement;Event.observe(this.cityElement,'keydown',this.onKeyDown.bindAsEventListener(this),false);Event.observe(this.cityElement,'keyup',this.onKeyUp.bindAsEventListener(this),false);Event.observe(this.cityElement,'blur',this.onBlur.bindAsEventListener(this),false);this.initPosition();},handleResponse:function(request,query){var values=null;try{values=eval(request.responseText);}catch(e){}
if(!values||!(values instanceof Array))return false;this.dataArray=[];this.displayArray=[];var r=new RegExp('^('+this.cityElement.value.strip()+')(.*)','i');for(var i=0;i<values.length;i++){var m=null;var display='';var name=values[i][0];var nameSplit=name.split(",");var city=nameSplit[1]+","+nameSplit[2];city=city.strip();if(m=city.match(r)){display='<b>'+m[1]+'</b>'+m[2];}
this.dataArray.push(city);this.displayArray.push(display);}
return true;},updateValue:function(tries){var t=tries||++this.tries;if(this.complete){this.complete=false;if(t==this.tries){var c=this.cityElement.value;var n=this.element.value;var q=n+", "+c;new Ajax.Request(this.url,{asynchronous:true,evalScripts:false,parameters:('q='+q.strip()),onComplete:function(r){this.onUpdate(r,q,t);}.bind(this)});}else{this.complete=true;}}else{setTimeout(function(){this.updateValue(t);}.bind(this),100);}},valueChosen:function(){this.hide();if(this.displayedIndex>-1){this.cityElement.value=(this.dataArray[this.dataArrayIndex()]||'').toString();if(this.options.onSelect)this.options.onSelect(this.element.value);}},show:function(elem){var r="[a-zA-Z-]{1,}\\s[a-zA-Z-]{2,},?\\s[a-zA-Z-\\s]{3,}";var name=this.element.value.strip();var city=this.cityElement.value.strip();var name_city=name+", "+city;if(name_city.strip().match(r)){this.updateValue();}else if(this.visible){this.hide();}},initPosition:function(){this.container.className="autocomplete home_split_autocomplete";}});AutoComplete.SplitHeaderSearch=Class.create(AutoComplete.SplitHomeSearch,{initPosition:function(){this.container.className="autocomplete header_split_autocomplete";this.element.style.width='30%';}});AutoComplete.FindCityHeaderSearch=Class.create(AutoComplete.SplitHomeSearch,{initialize:function(element,cityElement,url,options){AutoComplete.Remote.prototype.initialize.call(this,element,url,options);cityElement=$(cityElement);this.cityElement=cityElement;try{if(AutoComplete.documentLoaded)((this.cityElement).parentNode).appendChild(this.container);else Event.observe(window,'load',function(){((this.cityElement).parentNode).appendChild(this.container);}.bind(this));}
catch(e)
{}
Event.observe(this.cityElement,'keydown',this.onKeyDown.bindAsEventListener(this),false);Event.observe(this.cityElement,'keyup',this.onKeyUp.bindAsEventListener(this),false);Event.observe(this.cityElement,'blur',this.onBlur.bindAsEventListener(this),false);},updateValue:function(tries){var t=tries||++this.tries;if(this.complete){this.complete=false;if(t==this.tries){var loc=this.cityElement.value;var name=this.name_city_separator();var q=name+", "+loc;new Ajax.Request(this.url,{asynchronous:true,evalScripts:false,parameters:('q='+q.strip()),onComplete:function(r){this.onUpdate(r,q,t);}.bind(this)});}else{this.complete=true;}}else{setTimeout(function(){this.updateValue(t);}.bind(this),100);}},valueChosen:function(){this.hide();if(this.displayedIndex>-1){this.cityElement.value=(this.dataArray[this.dataArrayIndex()]||'').toString();var name=this.name_city_separator();this.element.value=name+", "+this.cityElement.value;if(this.options.onSelect)this.options.onSelect(this.element.value);}},name_city_separator:function()
{var r="[a-zA-Z-]{1,}\\s[a-zA-Z-]{2,},?\\s[a-zA-Z-\\s]{3,}";var name=this.element.value.strip();if(name.match(r))
{var nameSplit=name.split(" ");if(nameSplit[1].match(/^.+,$/)){nameSplit[1]=nameSplit[1].slice(0,-1);}
name=nameSplit[0]+" "+nameSplit[1];}
return name;},show:function(elem){var r="[a-zA-Z-]{1,}\\s[a-zA-Z-]{2,},?\\s[a-zA-Z-\\s]{3,}";var name=this.name_city_separator();var city=this.cityElement.value.strip();var name_city=name+", "+city;if(city.length<3)
{$('city_filter_input').className="round_edges";}
if(name_city.strip().match(r)){this.updateValue();}else if(this.visible){this.hide();}},initPosition:function(){this.container.className="autocomplete header_city_filter_autocomplete";var values=$$('a.autocomplete_value');values.each(function(item){item.setStyle({color:'#2D6DA6',fontSize:'13pt',fontWeight:'bold'})});}});AutoComplete.HomeSearch=Class.create(AutoComplete.Spokeo,{show:function(elem){var r="[a-zA-Z-]{1,}\\s[a-zA-Z-]{2,},?\\s[a-zA-Z-\\s]{3,}";if(this.element.value.strip().match(r)){this.updateValue();}else if(this.visible){this.hide();}},initPosition:function(){this.container.className="autocomplete home_city_autocomplete"}});AutoComplete.HeaderSearch=Class.create(AutoComplete.HomeSearch,{initPosition:function(){this.container.className="autocomplete header_city_autocomplete"}});