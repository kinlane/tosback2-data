/* OnlineOpinion v5.1.7 Released: 1/12/2011 Branch: hotfix/5.1.8 b83508d0b62506b920a090b03745f962a3450325 Components: Full The following code is Copyright 1998-2011 Opinionlab, Inc. All rights reserved. Unauthorized use is prohibited. This product and other products of OpinionLab, Inc. are protected by U.S. Patent No. 6606581, 6421724, 6785717 B1 and other patents pending. http://www.opinionlab.com */var OOo={Browser:(function(){var a=navigator.userAgent,b=Object.prototype.toString.call(window.opera)=='[object Opera]',c={IE:!!window.attachEvent&&!b,Opera:b,WebKit:a.indexOf('AppleWebKit/')>-1,Chrome:a.indexOf('Chrome')>-1,Gecko:a.indexOf('Gecko')>-1&&a.indexOf('KHTML')===-1,MobileSafari:/Apple.*Mobile.*Safari/.test(a),PalmPre:a.indexOf('Pre/')>-1,BlackBerry:a.indexOf('BlackBerry')>-1,Fennec:a.indexOf('Fennec')>-1,IEMobile:a.indexOf('IEMobile')>-1,OperaMobile:a.search(/Opera (?:Mobi|Mini)/)>-1},d=0,e,g=false;if(c.IE){e=/msie.(\d\.\d+)/i;d=a.match(e)[1]}else if(c.Gecko){e=/gecko.(\d+)/i;d=a.match(e)[1]}else if(c.WebKit){e=/applewebkit\/(\d+)/i;d=a.match(e)[1]}else if(c.Opera){e=/opera.(\d\.\d+)/i;d=a.match(e)[1]}else{g=true}c.isMobile=(c.MobileSafari||c.PalmPre||c.BlackBerry||c.Fennec||c.IEMobile||c.OperaMobile);c.Version=parseFloat(d);c.isModern=(!(g||(c.IE&&c.Version<6)||(c.Opera&&c.Version<8)||(c.Gecko=='gecko'&&c.Version<20041107)));return c})()};OOo.Cache={};OOo.instanceCount=0;if(!OnlineOpinion)var OnlineOpinion=OOo;(function(){function g(a){return document.getElementById(a)}function f(a,b){for(var c in b)a[c]=b[c];return a}function h(a,b,c,d){if(a.addEventListener)a.addEventListener(b,c,d);else if(a.attachEvent)a.attachEvent('on'+b,c)}function i(a,b,c,d){if(a.removeEventListener)a.removeEventListener(b,c,d);else if(a.detachEvent)a.detachEvent('on'+b,c)};function j(a){var b=[];for(var c in a)b.push(c+'='+(encodeURIComponent(a[c])||''));return b.join('&')}function k(a){var b=j(a.metrics);b+='&custom_var='+a.tealeafId+'|'+a.clickTalePID+'/'+a.clickTaleUID+'/'+a.clickTaleSID;if(a.legacyVariables)b+="|"+a.legacyVariables;if(a.metrics.type=='OnPage')b+='|iframe';b+='&_'+"rev=2";if(a.customVariables)b+='&customVars='+encodeURIComponent(OOo.serialize(a.customVariables));return b}function n(a,b){var c=document,d=c.createElement('form'),e=c.createElement('input');d.style.display='none';d.method='post';d.target=b||'OnlineOpinion';d.action=a.onPageCard?'https://secure.opinionlab.com/ccc01/comment_card_json_4_0_b.asp?r='+location.href:'https://secure.opinionlab.com/ccc01/comment_card_d.asp';e.name='params';e.value=k(a);d.appendChild(e);c.body.appendChild(d);return d}function o(){return{width:screen.width,height:screen.height,referer:location.href,prev:document.referrer,time1:(new Date()).getTime(),time2:null,currentURL:location.href,ocodeVersion:'5.1.7'}}f(OOo,{extend:f,toQueryString:j,addEventListener:h,$:g,appendOOForm:n,removeEventListener:i,createMetrics:o})})();(function(){function g(a){if(!a)return null;switch(typeof a){case'number':case'boolean':case'function':return a;break;case'string':return'\''+a+'\'';break;case'object':var b;if(a.constructor===Array||typeof a.callee!=='undefined'){b='[';var c,d=a.length;for(c=0;c<d-1;c++){b+=g(a[c])+','}b+=g(a[c])+']'}else{b='{';var e;for(e in a){b+=e+':'+g(a[e])+','}b=b.replace(/\,$/,'')+'}'}return b;break;default:return null}}OOo.extend(OOo,{serialize:g})})();(function(){function e(a,b){var c=location.pathname,d;if(c.search(a[0])!=-1){OOo.createCookie(b,0);return false}else if(OOo.readCookie(b)){d=parseInt(OOo.readCookie(b));if((c.search(a[d+1])!=-1)&&(d+1!=a.length-1)){OOo.createCookie(b,d+1);return false}else if(c.search(a[d])!=-1)return false;else if(d+1==a.length-1)return true;else{OOo.eraseCookie(b);return false}}else return false}OOo.extend(OOo,{checkTunnel:e})})();(function(){function r(a){var b="";for(var c=7;c>=0;c--)b+='0123456789abcdef'.charAt((a>>(c*4))&0x0F);return b}function u(a){var b=((a.length+8)>>6)+1,c=new Array(b*16);for(var d=0;d<b*16;d++)c[d]=0;for(var d=0;d<a.length;d++)c[d>>2]|=a.charCodeAt(d)<<(24-(d%4)*8);c[d>>2]|=0x80<<(24-(d%4)*8);c[b*16-1]=a.length*8;return c}function m(a,b){var c=(a&0xFFFF)+(b&0xFFFF),d=(a>>16)+(b>>16)+(c>>16);return(d<<16)|(c&0xFFFF)}function p(a,b){return(a<<b)|(a>>>(32-b))}function v(a,b,c,d){if(a<20)return(b&c)|((~b)&d);if(a<40)return b^c^d;if(a<60)return(b&c)|(b&d)|(c&d);return b^c^d}function q(a){return(a<20)?1518500249:(a<40)?1859775393:(a<60)?-1894007588:-899497514}function x(a){var b=u(a),c=new Array(80),d=1732584193,e=-271733879,g=-1732584194,f=271733878,h=-1009589776,i,j,k,n,o,s;for(var t=0;t<b.length;t+=16){i=d,j=e,k=g,n=f,o=h;for(var l=0;l<80;l++){if(l<16)c[l]=b[t+l];else c[l]=p(c[l-3]^c[l-8]^c[l-14]^c[l-16],1);s=m(m(p(d,5),v(l,e,g,f)),m(m(h,c[l]),q(l)));h=f;f=g;g=p(e,30);e=d;d=s}d=m(d,i);e=m(e,j);g=m(g,k);f=m(f,n);h=m(h,o)}return r(d)+r(e)+r(g)+r(f)+r(h)}OOo.extend(OOo,{sha1:x})})();(function(){function f(a){var b=a.cookieName||'oo_abandon',c=OOo.readCookie(b),d=a.startPage,e=a.endPage,g=a.middle;if(!c){if(location.pathname.indexOf(d)!=-1)OOo.createCookie(b);return false}else if(location.pathname.indexOf(e)!=-1){OOo.eraseCookie(b);return false}else if(location.pathname.search(g)!=-1)return false;else{OOo.eraseCookie(b);return true}}OOo.extend(OOo,{checkAbandonment:f})})();(function(){function c(a){for(var b=a.length-1;b>=0;b--){if(a[b].read){if(!!(cookieValue=OOo.readCookie(a[b].name))&&cookieValue==a[b].value)return true;else if(typeof a[b].value=='undefined'&&!!OOo.readCookie(a[b].name))return true}}return false}function d(a){for(var b=a.length-1;b>=0;b--){if(a[b].set)OOo.createCookie(a[b].name,a[b].value,a[b].expiration)}}OOo.extend(OOo,{checkThirdPartyCookies:c,setThirdPartyCookies:d})})();OOo.extend(Function.prototype,(function(){if(typeof(Prototype)!="undefined")return;var e=Array.prototype.slice;function g(a,b){var c=a.length,d=b.length;while(d--)a[c+d]=b[d];return a}function f(a,b){a=e.call(a,0);return g(a,b)}function h(b){if(arguments.length<2&&typeof arguments[0]==="undefined")return this;var c=this,d=e.call(arguments,1);return function(){var a=f(d,arguments);return c.apply(b,a)}}return{bind:h}})());(function(){var g=location.host.split('.').reverse();g='.'+g[1]+'.'+g[0];function f(a,b,c){var d='',e='';if(c){d=new Date();d.setTime(d.getTime()+(c*1000));e="; expires="+d.toGMTString()}document.cookie=a+"="+b+e+"; path=/; domain="+g+";"}function h(a){var b=a+"=",c=document.cookie.split(';'),d;for(var e=0;e<c.length;e++){d=c[e];while(d.charAt(0)==' ')d=d.substring(1,d.length);if(d.indexOf(b)===0)return d.substring(b.length,d.length)}return null}function i(a){f(a,"",-1)}OOo.extend(OOo,{createCookie:f,readCookie:h,eraseCookie:i})})();OOo.Ocode=function(a){var b=OOo.Browser;if(!b.isModern||(a.disableMobile&&b.isMobile))return;if(a.disableNoniOS&&(navigator.userAgent.search('Android')!=-1||b.PalmPre||b.IEMobile||b.OperaMobile||b.Fennec))return;OOo.instanceCount++;this.options={tealeafCookieName:'TLTSID'};OOo.extend(this.options,a);var c=this.options,d=c.referrerRewrite;if(c.cookie&&this.matchUrl())return;if(c.thirdPartyCookies&&OOo.checkThirdPartyCookies(c.thirdPartyCookies))return;if(c.abandonment&&!OOo.checkAbandonment(c.abandonment))return;if(c.tunnel&&!OOo.checkTunnel(c.tunnel.path,c.tunnel.cookieName))return;if(c.events&&c.events.onSingleClick)this.singProbability=Math.random()<1-c.events.onSingleClick/100;c.tealeafId=OOo.readCookie(c.tealeafCookieName);this.frameName=c.onPageCard?'OnlineOpinion'+OOo.instanceCount:'OnlineOpinion';c.metrics=OOo.createMetrics();if(d)c.metrics.referer=d.searchPattern?window.location.href.replace(d.searchPattern,d.replacePattern):d.replacePattern;if(c.events){this.setupEvents();if(c.events.disableLinks||c.events.disableFormElements)this.setupDisableElements()}if(c.floating)this.floating();else if(c.bar)this.bar();else if(c.tab)this.tab()};OOo.Ocode.prototype={show:function(){var a=this.options;if(this.interruptShow)return;if(!a.floating&&a.events&&this.singProbability)return;if(a.events&&a.events.onSingleClick)this.singProbability=true;if(a.cookie)this.tagUrl();if(a.thirdPartyCookies){if(OOo.checkThirdPartyCookies(a.thirdPartyCookies))return;OOo.setThirdPartyCookies(a.thirdPartyCookies)}if(this.floatingLogo&&a.disappearOnClick)this.floatingLogo.style.display='none';if(typeof arguments[0]=='string')a.metrics.trigger=arguments[0];if(a.clickTalePID&&typeof ClickTale=='function'){a.clickTaleUID=ClickTaleGetUID();a.clickTaleSID=ClickTaleGetSID()}if(a.onPageCard)this.setupOnPageCC();else this.launchOOPopup()},tagUrl:function(){if(this.matchUrl())return;var a=this.options.cookie,b=a.type=='page'?location.href:location.hostname,c=OOo.readCookie(a.name||'oo_r')||'';OOo.createCookie(a.name||'oo_r',c+OOo.sha1(b),a.expiration)},matchUrl:function(){var a=this.options.cookie.type=='page'?location.href:location.hostname,b=OOo.readCookie(this.options.cookie.name||'oo_r');if(!b)return false;return b.search(OOo.sha1(a))!=-1}};(function(){function g(){var a=this.options,b=a.newWindowSize||[545,325],c=[parseInt((a.metrics.height-b[1])/2),parseInt((a.metrics.width-b[0])/2)],a=this.options,d,e;a.metrics.time2=(new Date()).getTime();a.metrics.type='Popup';d=OOo.appendOOForm(a);e=window.open('','OnlineOpinion','location=no,status=no,width='+b[0]+',height='+b[1]+',top='+c[0]+',left='+c[1]);if(e)d.submit()}OOo.extend(OOo.Ocode.prototype,{launchOOPopup:g})})();(function(){function j(){var a=this.options.events,b=[false,false],c=['onExit','onEntry'],d=OOo.Browser.Opera?'unload':'beforeunload',e,g;for(var f=c.length-1;f>=0;f--){e=c[f];if(a[e]instanceof Array){var h=a[e],i=h.length;while(i--&&!b[f]){if(window.location.href.search(h[i].url)!=-1&&Math.random()>=1-h[i].p/100)b[f]=true}}else if(a[e]&&Math.random()>=1-a[e]/100)b[f]=true}if(b[0])OOo.addEventListener(window,d,this.show.bind(this,'onExit'),false);if(b[1]){if(a.delayEntry){window.setTimeout(function(){this.show()}.bind(this,'onEntry'),a.delayEntry*1000)}else{this.show('onEntry')}}}function k(){OOo.addEventListener(document.body,'mousedown',n.bind(this));if(!this.options.events.disableFormElements)return;var a=document.getElementsByTagName('form');for(var b=a.length-1;b>=0;b--)OOo.addEventListener(a[b],'submit',o.bind(this))}function n(a){var b=a||window.event,c=a.target||a.srcElement,d=this.options.events,e=c.parentNode,g=5,f=0;while(e&&(c.nodeName!='A'||c.nodeName!='INPUT')&&f!=g){if(e.nodeName=='A')c=e;e=e.parentNode;f++}if(d.disableFormElements&&c.tagName=="INPUT"&&(c.type=='submit'||c.type=='image'))this.interruptShow=true;if(c.nodeName=='A'&&c.href.substr(0,4)=='http'&&c.href.search(d.disableLinks)!=-1)this.interruptShow=true}function o(a){this.interruptShow=true}OOo.extend(OOo.Ocode.prototype,{setupEvents:j,setupDisableElements:k})})();OOo.extend(OOo.Ocode.prototype,{floating:function(){var d=document,e=this.floatingLogo=document.createElement('div'),g=d.createElement('div'),f=d.createElement('div'),h=d.createElement('div'),i=d.createElement('span'),j=this.options.floating,k=OOo.$(j.contentId),n='10px',o=false,s=j.id;if(s)e.id=s;e.className='oo_feedback_float';f.className='oo_transparent';g.className='olUp';h.className='olOver';g.tabIndex=0;g.onkeyup=function(a){var b=a||window.event;if(b.keyCode!=13)return;this.show()}.bind(this);g.innerHTML=j.caption||'Feedback';e.appendChild(g);i.innerHTML=j.hoverCaption||'Click here to<br>rate this page';h.appendChild(i);e.appendChild(h);e.appendChild(f);if(OOo.Browser.IE&&OOo.Browser.Version<7){e.style.position='absolute';e.style.bottom='';OOo.addEventListener(window,'scroll',t,false);OOo.addEventListener(window,'resize',t,false);function t(a){e.style.top=(d.documentElement.scrollTop+document.documentElement.clientHeight-e.clientHeight)+'px'};o=true}else if(OOo.Browser.MobileSafari){var l=window.innerHeight,r;e.style.bottom=null;e.style.top=(pageYOffset+window.innerHeight-60)+'px';OOo.addEventListener(window,'scroll',function(a){r=pageYOffset-(l-window.innerHeight);e.style.webkitTransform='translateY('+r+'px)'},false)}if(j.position&&j.position.search(/Content/)&&k){var u=this.spacer=d.createElement('div'),m=OOo.Browser.WebKit?d.body:d.documentElement,p;u.id='oo_feedback_fl_spacer';u.style.left=q(k)+'px';d.body.appendChild(u);switch(j.position){case'rightOfContent':p=function(a){e.style.left=(q(k)-m.scrollLeft)+'px';if(o)p=null};break;case'fixedPreserveContent':p=function(a){var b=OOo.Browser.IE?d.body.clientWidth:window.innerWidth,c=!o?m.scrollLeft:0;if(b<=q(k)+e.offsetWidth+parseInt(n))e.style.left=(q(k)-c)+'px';else{e.style.left='';e.style.right=n}};break;case'fixedContentMax':p=function(a){var b=OOo.Browser.IE?d.body.clientWidth:window.innerWidth;if(b<=q(k)+e.offsetWidth+parseInt(n)){e.style.left='';e.style.right=n;if(a&&a.type=='scroll'&&o)e.style.left=(d.documentElement.clientWidth+m.scrollLeft-105)+'px'}else{e.style.left=(q(k)-m.scrollLeft)+'px';e.style.right=''}};break}p();OOo.addEventListener(window,'scroll',p,false);OOo.addEventListener(window,'resize',p,false);function v(a){u.style.left=q(k)+'px'};OOo.addEventListener(window,'resize',v,false)}else{e.style.right=n}OOo.addEventListener(e,'click',this.show.bind(this,'Floating'),false);OOo.addEventListener(e,'touchstart',this.show.bind(this,'Floating'),false);d.body.appendChild(e);if(OOo.Browser.IE&&OOo.Browser.Version<7){e.style.top=(d.documentElement.clientHeight-e.clientHeight)+'px';f.style.height=e.clientHeight+'px'}function q(a){return a.offsetLeft+a.offsetWidth}},removeFloatingLogo:function(){document.body.removeChild(this.floatingLogo);if(this.spacer)document.body.removeChild(this.spacer)}});OOo.extend(OOo.Ocode.prototype,{bar:function(){var c=document,d=this.floatingLogo=c.createElement('div'),e=c.createElement('span');d.id='oo_bar';e.innerHTML=this.options.bar.caption||'Feedback';d.appendChild(e);d.tabIndex=0;d.onkeyup=function(a){var b=a||window.event;if(b.keyCode!=13)return;this.show()}.bind(this);OOo.addEventListener(d,'click',this.show.bind(this,'Bar'));document.body.className+=document.body.className<1?'oo_bar':' oo_bar';document.body.appendChild(d);if(OOo.Browser.IE){var g;if(c.compatMode=='CSS1Compat'){g=function(a){if(a&&a.type=='resize')setTimeout(g,50);d.style.top=(c.documentElement.scrollTop+document.documentElement.clientHeight-d.clientHeight-1)+'px';d.style.width=(Math.max(c.documentElement.clientWidth,c.body.offsetWidth))+'px'}}else{g=function(a){d.style.top=(c.body.scrollTop+document.body.clientHeight-d.clientHeight-1)+'px';d.style.width=(Math.max(c.documentElement.clientWidth,c.body.offsetWidth)-22)+'px'}}d.style.position='absolute';OOo.addEventListener(window,'scroll',g,false);OOo.addEventListener(window,'resize',g,false);g()}else if(OOo.Browser.MobileSafari){var f=window.innerHeight,h;d.style.bottom=null;d.style.top=(pageYOffset+window.innerHeight-22)+'px';OOo.addEventListener(window,'scroll',function(a){h=pageYOffset-(f-window.innerHeight);d.style.webkitTransform='translateY('+h+'px)'},false)}}});OOo.extend(OOo.Ocode.prototype,{tab:function(){var c=document,d=this.floatingLogo=c.createElement('div'),e=c.createElement('a'),g=c.createElement('span'),f=this.options.tab;d.id='oo_tab';d.className='oo_tab_'+(f.position||'right');if(OOo.Browser.IE&&OOo.Browser.Version<7){d.style.position='absolute';if(f.position=='right')d.className+=' oo_tab_ie_right'}else if(OOo.Browser.MobileSafari){d.style.top=(pageYOffset+window.innerHeight/2)+'px';OOo.addEventListener(window,'scroll',function(a){d.style.top=(pageYOffset+window.innerHeight/2)+'px'},false)}e.href="javascript:void(0)";e.title=f.title||'Feedback';d.tabIndex=0;d.onkeyup=function(a){var b=a||window.event;if(b.keyCode!=13)return;this.show()}.bind(this);e.appendChild(g);d.appendChild(e);OOo.addEventListener(d,'click',this.show.bind(this,'Tab'),false);c.body.appendChild(d)}});OOo.extend(OOo.Ocode.prototype,{setupOnPageCC:function(){var f=document,h=OOo.Cache.overlay||f.createElement('div'),i=this.wrapper=f.createElement('div'),j=f.createElement('a'),k=f.createElement('div'),n=f.createElement('span'),o=this.frameName,s=f.createElement(OOo.Browser.IE?'<iframe name="'+o+'">':'iframe'),t=f.createDocumentFragment(),l=this.options,r=l.onPageCard,u='https://secure.opinionlab.com/ccc01/comment_card_json_4_0_b.asp',m,p,v,q=false;l.metrics.type='OnPage';OOo.Cache.overlay=h;h.id='oo_overlay';h.style.display='block';h.className='';k.className='iwrapper';i.className='oo_cc_wrapper';j.className='oo_cc_close';j.href="javascript:void(0)";j.title=r.closeTitle||"Close Feedback Card";i.style.visibility='hidden';if(OOo.Browser.IE){if(!window.XMLHttpRequest){h.style.position='absolute';h.style.width=Math.max(f.documentElement.clientWidth,f.body.offsetWidth)+'px';h.style.height=Math.max(f.documentElement.clientHeight,f.body.offsetHeight)+'px';i.style.position='absolute'}else{var x=f.createElement("div"),z=f.createElement("div"),A=f.createElement("div"),w=f.createElement("div");w.className="oo_shadows";x.className='oo_body';z.className='oo_top';A.className='oo_bottom';w.appendChild(x);w.appendChild(z);w.appendChild(A);k.appendChild(w)}}OOo.addEventListener(j,'click',y);if(r.closeWithOverlay&&!OOo.Browser.isMobile){i.appendChild(n);n.onclick=y;h.onclick=y}s.src=u;s.name=o;k.appendChild(j);k.appendChild(s);i.appendChild(k);t.appendChild(i);t.appendChild(h);f.body.appendChild(t);v=B.bind(this);window.postMessage?OOo.addEventListener(window,"message",v):p=setInterval(B.bind(this),500);m=OOo.appendOOForm(l,o);l.metrics.time2=(new Date()).getTime();m.submit();function B(a){if((a&&a.origin!='https://secure.opinionlab.com')||(!a&&location.hash.substr(1,3)!='OL='))return;var b=a?a.data:location.hash.slice(4),c=parseInt(b),d=document;if(!a)location.hash='';if(c>0){if(q)return;q=true;var e=window.innerHeight||d.documentElement.clientHeight,g=c;if(g>e){g=e-40;s.style.width='555px'}s.style.height=g+'px';if(OOo.Browser.IE&&OOo.Browser.Version<7)n.style.height=i.offsetHeight+'px';i.style.visibility='visible';h.className="no_loading"}else if(b=='submitted')y()}function y(){h.style.display='none';h.className='';f.body.removeChild(i);window.postMessage?OOo.removeEventListener(window,'message',v):window.clearInterval(p);q=false}}});OOo.Invitation=function(a){this.options={tunnelCookie:'oo_inv_tunnel',repromptTime:604800,responseRate:50,repromptCookie:'oo_inv_reprompt',promptMarkup:'oo_inv_prompt.html',promptStyles:'oo_inverstitial_style.css',percentageCookie:'oo_inv_percent',pagesHitCookie:'oo_inv_hit',popupType:'popunder',promptDelay:0,neverShowAgainButton:false,loadPopupInBackground:false,tealeafCookieName:'TLTSID'};this.popupShown=false;OOo.extend(this.options,a);var b=this.options,c=parseInt(OOo.readCookie(b.pagesHitCookie))||0;OOo.Invitation.friendlyDomains=b.friendlyDomains||null;if(location.search.search('evs')!=-1){b.loadPopupInBackground=true;this.launchPopup();OOo.createCookie(b.repromptCookie,1,b.repromptTime==-1?0:b.repromptTime)}setTimeout(function(){if(b.area&&location.href.search(b.area)==-1&&window.oo_inv_monitor){this.options.popupType='popup';this.launchPopup()}}.bind(this),1000);if(OOo.readCookie(b.repromptCookie))return;if(b.thirdPartyCookies&&OOo.checkThirdPartyCookies(b.thirdPartyCookies))return;if(!OOo.readCookie(b.percentageCookie)){OOo.createCookie(b.percentageCookie,(Math.random()>1-(b.responseRate/100))?"1":"0")}if(typeof(b.promptTrigger)!='undefined'){if(b.promptTrigger instanceof RegExp){if(!window.location.href.match(b.promptTrigger))return}else if(b.promptTrigger instanceof Array){if(!OOo.checkTunnel(b.promptTrigger,b.tunnelCookie))return}}c++;OOo.createCookie(b.pagesHitCookie,c);if(b.pagesHit&&c<b.pagesHit)return;OOo.eraseCookie(b.tunnelCookie);if(OOo.readCookie(b.percentageCookie)=='1'){window.setTimeout(function(){OOo.createCookie(b.repromptCookie,1,b.repromptTime);this.getPrompt()}.bind(this),b.promptDelay*1000)}};OOo.Invitation.prototype={getPrompt:function(){var a=window.XMLHttpRequest?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP"),b=this,c=document.createElement('link'),d;a.onreadystatechange=function(){if(a.readyState!=4)return;b.showPrompt(a.responseText)};a.open("GET",this.options.pathToAssets+this.options.promptMarkup,true);a.send(null)},showPrompt:function(a){var b=document,c=b.createElement('div'),d=OOo.Cache.overlay||b.createElement('div'),e,g,f=this.options;d.id='oo_overlay';c.id='oo_container';c.style.visibility='hidden';c.innerHTML=a;c.appendChild(d);b.body.appendChild(c);if(f.companyLogo){e=new Image();e.src=f.companyLogo;OOo.$('oo_company_logo').appendChild(e)}OOo.addEventListener(OOo.$('oo_launch_prompt'),'click',this.launchPopup.bind(this),false);if(f.neverShowAgainButton){g=OOo.$('oo_never_show');g.style.visibility='visible';OOo.addEventListener(g,'click',this.killPrompt.bind(this),false)}if(OOo.Browser.IE&&!window.XMLHttpRequest){d.style.position='absolute';d.style.width=Math.max(document.documentElement.clientWidth,document.body.offsetWidth)+'px';d.style.height=Math.max(document.documentElement.clientHeight,document.body.offsetHeight)+'px';c.style.position='absolute'}c.style.visibility='visible';d.className='no_loading'},launchPopup:function(){if(this.popupShown)return;this.popupShown=true;var a=this.options,b=window.location.href,c=a.popupType=='popup'?'https://secure.opinionlab.com/ccc01/comment_card.asp?':a.pathToAssets+'oo_inv_monitor.html?',d,e=[],g=a.asm?[555,500]:[545,200],f,h=OOo.readCookie(a.teleafId),i=OOo.createMetrics();g=a.newWindowSize||g;if(a.referrerRewrite){i.referer=a.referrerRewrite.searchPattern?window.location.href.replace(a.referrerRewrite.searchPattern,a.referrerRewrite.replacePattern):a.referrerRewrite.replacePattern}if(a.thirdPartyCookies)OOo.setThirdPartyCookies(a.thirdPartyCookies);d=OOo.toQueryString(i)+'&type=Invitation';if(a.customVariables)d+='&customVars='+encodeURIComponent(OOo.serialize(a.customVariables));d+='&custom_var='+h;if(a.clickTalePID&&ClickTaleGetUID&&ClickTaleGetSID)d+='|'+[a.clickTalePID,ClickTaleGetUID(),ClickTaleGetSID()].join('/');f=window.open(c+d,'OnlineOpinionInvitation','location=no,status=no,width='+g[0]+',height='+g[1]);if(!a.loadPopupInBackground&&OOo.$('oo_container'))OOo.Invitation.hidePrompt();if(a.popupType=='popunder'){if(!OOo.Browser.Chrome){f.blur();window.focus()}else{alert(a.chromeMainWinPrompt||'Please fill out the form behind this window when you are finished.');f.window.prompt=a.chromeSurveyPrompt}}else if(window.oo_inv_monitor){window.blur();f.focus()}},killPrompt:function(){OOo.createCookie(this.options.repromptCookie,1,1825);OOo.Invitation.hidePrompt()}};OOo.extend(OOo.Invitation,{hidePrompt:function(){OOo.$('oo_container').style.display='none'}});