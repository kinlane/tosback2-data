(function(c,f){var g=[],h={success:c.noop,error:c.noop};f.InlineHeartsModule=function(b,a){a||(a={});this.options=c.extend({},h,a);if(!(c.inArray(b,g)>=0)){this.element_selector=b;this.element=c(b);this._initialize()}};f.InlineHeartsModule.prototype={_handleError:function(){},_showButtons:function(b){this._getListingContainer(c(b)).addClass("show-inline-buttons")},_hideButtons:function(b){this._getListingContainer(c(b)).removeClass("show-inline-buttons")},_getListingContainer:function(b){return b.closest(".listing-card, .listing")},
_getListingContainerForListingID:function(b){return this.element.find("#lid"+b).parents("div.listing-card-container")},_doHeartOrUnheart:function(b){var a=this._getListingContainer(b);if(a){a=a.find(".button-favorite");if(!a.hasClass("inline-overlay-trigger")){this._sendHeartOrUnheart(b,a.hasClass("button-favorite-active"));a.toggleClass("button-favorite-active")}a={php_event_name:"favorite_item",source:"casanova"};b=/listing\/(\d+)\/heart/.exec(b.attr("href")||b.attr("data-href"));if(b!==null)a.listing_id=
b[1];Etsy.EventLogger.logEvent(a)}},_sendHeartOrUnheart:function(b,a){var d=this,i=b.attr("href")||b.attr("data-href");c.ajax({url:i,data:{unheart:a,_nnc:Etsy.csrf_nonce},dataType:"json",type:"POST",success:function(e){d.options.success(e,b,a)},error:function(e){d.options.success(e,b,a)}})},_isTouchScreen:function(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)},_initialize:function(){if(!this._isTouchScreen()){var b=
this;c(this.element_selector+" .listing-card").live("mouseover",function(a){a.preventDefault();b._showButtons(a.target)});c(this.element_selector+" .listing-card").live("mouseout",function(a){a.preventDefault();b._hideButtons(a.target)});c(this.element_selector+" .button-favorite").live("click",function(a){if(a.which&&a.which!=1)return true;var d=c(a.target);if(!d.hasClass("button-favorite"))return true;d.attr("disabled","disabled");a.target.blur();a.preventDefault();b._doHeartOrUnheart(d)})}}};c(document).ready(function(){new Etsy.InlineHeartsModule("ul.listings:not(.no-inline-hearts)")})})(jQuery,
window.Etsy);
