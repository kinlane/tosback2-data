var xing=xing||{};xing.utils=xing.utils||{};xing.utils.documentHasFocus=function(){if("webkitHidden"in document){var a=document.webkitHidden;$(document).on("webkitvisibilitychange",function(){a=document.webkitHidden});return function(){return!a}}if(document.hasFocus)return function(){return document.hasFocus()};var b=!0;$(window).focus(function(){b=!0}).blur(function(){b=!1});return function(){return b}}();xing=xing||{};xing.controls=xing.controls||{};
xing.controls.FeedTicker=function(){var a={url:"/app/startpage",op:"get_stories",wrapper:"ul.logged-out-feed",random:!0,delay:5,parameters:{}};return Class.create({initialize:function(b){this._options=$.extend({},a,b);this._feed=$(document.body).find(this._options.wrapper);this._firstRun=!0;this._delay=this._options.random?3+10*Math.random()>>0:this._options.delay;this._renderData=this._renderData.bind(this);this._updateStories=this._updateStories.bind(this);this._deleteAndRecall=this._deleteAndRecall.bind(this);
this._updateStories()},_updateStories:function(){var a=this._feed.children();a.length&&(this._preloadImage(a),this._fadeStories(a),this._firstRun=!1)},_preloadImage:function(a){var a=a.filter("li.hidden-activity").last().find("img").first(),c=a.attr("data-img");c&&a.attr("src",c).removeAttr("data-img")},_fadeStories:function(a){var c=a.filter("li.hidden-activity"),d=c.last(),e=a.last(),f=this._deleteAndRecall;3<a.length&&c.length&&xing.utils.documentHasFocus()&&!this._firstRun?(e.fadeOut(),d.removeClass("hidden-activity").slideDown().fadeIn().queue(function(){e.remove();
f(c)})):f(c)},_deleteAndRecall:function(a){3>a.length&&this._getStories();setTimeout(this._updateStories,1E3*this._delay)},_getStories:function(){$.ajax(this._options.url,{type:"POST",data:$.extend({},this._options.parameters,{op:this._options.op})}).done(this._renderData)},_renderData:function(a){this._feed.prepend(a)}})}();xing=xing||{};xing.controls=xing.controls||{};
xing.controls.TestimonialFader=Class.create(function(){return{initialize:function(a){this._options=$.extend({time:10},a);this._container=$(this._options.container);this._control=$(this._options.control);this._controlLinks=this._control.find("a");this._actualElement=this._container.find("li").filter(":visible");this._markControlLink();this._observe();this._startTimer()},_getNext:function(){var a=this._actualElement.next();a.length||(a=this._container.find("li").first());return a},_getPrevious:function(){var a=
this._actualElement.prev();a.length||(a=this._container.find("li").last());return a},_observe:function(){this._controlLinks.click(function(a){this._jumpTo($(a.currentTarget).index());a.preventDefault()}.bind(this))},_markControlLink:function(){this._controlLinks.removeClass("active");$(this._controlLinks[this._getNumber()]).addClass("active");this._preloadNextImage()},_getNumber:function(){return this._actualElement.index()},_preloadNextImage:function(){var a=this._getNext(),b=a.index();a.addClass("graphic-#{nr}".replace("#{nr}",
b))},_jumpTo:function(a){this._actualElement.hide();this._actualElement=this._container.find("li:eq("+a+")").show().addClass("graphic-#{nr}".replace("#{nr}",a));this._markControlLink();this._startTimer()},_startTimer:function(){this._stopTimer();this._options.time&&(this._interval=setInterval(function(){var a=this._getNext();this._actualElement.fadeOut();a.fadeIn();this._actualElement=a;this._markControlLink()}.bind(this),1E3*this._options.time))},_stopTimer:function(){this._interval&&clearInterval(this._interval)},
start:function(){this._interval||this._startTimer()},restart:function(){this._startTimer()},stop:function(){this._stopTimer()}}}());xing=xing||{};xing.controls=xing.controls||{};
xing.controls.MiniSignup=Class.create(function(){return{initialize:function(a,b,c){this._form=$(a);this._textResources=b;this._options=c||{};this._options.beforeSubmit=this._options.beforeSubmit||$.noop;this._errorBubbles=[];this._errorShown=!1;this._initElements();this._observe();this._options.browserAutoComplete&&this._enableAutoComplete()},_initElements:function(){this._termsAndConditions=$("#terms-and-conditions, #lightbox-termns-and-conditions");this._inputs=this._form.find("input");this._passwordInput=
this._form.find("input[type=password]")},_enableAutoComplete:function(){var a=this._form.find("input[type=text]");a.on("focus",function(){a.attr("autocomplete","on")})},_observe:function(){this._form.submit(function(a){this._errorShown=!1;this._ajax();a.preventDefault()}.bind(this))},_ajax:function(){var a=this._form.serializeObject();delete a.password;delete a.op;this._disableInputs.bind(this,this._form);$.ajax("/app/signup?op=minireg_validate",{type:"POST",data:a,dataType:"json"}).done(this._handleResponse.bind(this))},
_disableInputs:function(a){a.find("input").attr("disabled",!0)},_enableInputs:function(a){a.find("input").attr("disabled",!1)},_handleResponse:function(a){this._enableInputs(this._form);this._hideAllErrors();var b=a.captcha_required,c=this._isPasswordValid();a.success?c?b?new xing.controls.Captcha(this._captchaSolved.bind(this)):(this._options.beforeSubmit(),this._form[0].submit()):this._passwordInput.focus():(this._inputs.each(function(b,c){var c=$(c),f=c.attr("name");a[f]&&this._showError(c,a[f])}.bind(this)),
a.inputFocus&&"terms-and-conditions"!==a.inputFocus?this._form.find("input[name="+a.inputFocus+"]").focus():c||this._passwordInput.focus())},_isPasswordValid:function(){var a=this._passwordInput.val(),b;4>a.length?b=this._textResources.PASSWORD_LESS_THAN_FOUR_CHARS:a===this._form.find("[name=email]").val()?b=this._textResources.PASSWORD_SAME_AS_EMAIL:a===this._form.find("[name=first_name]").val()?b=this._textResources.PASSWORD_SAME_AS_FIRSTNAME:a===this._form.find("[name=last_name]").val()&&(b=this._textResources.PASSWORD_SAME_AS_LASTNAME);
b&&b.length&&this._showError(this._passwordInput,b);return!b||!b.length},_hideAllErrors:function(){this._options.errorBubbles?(this._errorBubbles.forEach(function(a){a.remove()}),this._errorBubbles=[]):this._form.find("div.input-error").remove();this._inputs.removeClass("input-error");this._termsAndConditions.closest("label").removeClass("input-error");this._inputs.removeClass("input-error")},_captchaSolved:function(a){$("#captcha_secret").val(a);this._options.beforeSubmit();this._form[0].submit()},
_showError:function(a,b){var c,d;a.attr("data-error-position")?(c=a.attr("data-error-position"),d=10):(c=this._options.signupOnLeft?"right":"left",d=this._options.signupOnLeft?10:100);this._options.errorBubbles?a[0]===this._termsAndConditions[0]?this._errorBubbles.push(new xing.controls.FormErrorMessage(a,"hover",b,{margin:this._options.signupOnLeft?380:5,position:c})):this._errorBubbles.push(new xing.controls.FormErrorMessage(a,"focus",b,{margin:d,position:c})):(c=$("<div>").html(b).addClass("input-error"),
a.addClass("input-error"),a.parent().append(c),"checkbox"!==a.attr("type")&&!this._errorShown&&(a.focus(),this._errorShown=!0));a[0]===this._termsAndConditions[0]&&this._termsAndConditions.closest("label").addClass("input-error");a.addClass("input-error")}}}());xing=xing||{};xing.controls=xing.controls||{};
xing.controls.Captcha=function(){var a={get_captcha_url:"/app/signup?op=get_captcha",validate_captcha_url:"/app/signup?op=captcha_validate",dialog:"#captcha-lightbox",stack:"#captcha-lightbox",recaptcha:{asset_url:"https://www.google.com/recaptcha/api/js/recaptcha_ajax.js?legacy",api_key:"6LcNK8ASAAAAALCqg1Oa2FyKDIWzcQE6ivOh3krF",theme:"white"}};return Class.create({initialize:function(b,c){this.config=$.extend({},a,c);this.lightbox=$(this.config.dialog);this.callback=b;new xing.utils.LazyLoader(this.config.recaptcha.asset_url,
function(){this.captcha=this._getCaptcha();this._observe();this._preventClose()}.bind(this))},_observe:function(){this.captcha.on("load",this._initCaptcha.bind(this));this.captcha.on("close",function(){this.lightbox.off("submit")}.bind(this));this.lightbox.on("submit","form",this._validateCaptcha.bind(this))},_getCaptcha:function(){return new xing.controls.Lightbox({src:this.config.get_captcha_url,stack:this.config.stack,dialog:this.config.dialog})},_initCaptcha:function(){Recaptcha.create(this.config.recaptcha.api_key,
$("#captcha-lightbox\\:text")[0],{theme:this.config.recaptcha.theme,lang:xing.user.language,callback:Recaptcha.focus_response_field})},_preventClose:function(){var a=this.lightbox;if($(document.body).find(".minireg-lightbox").length&&a)a.on("click",function(a){a.stopPropagation()})},_validateCaptcha:function(a){$.ajax(this.config.validate_captcha_url,{dataType:"json",data:{recaptcha_response_field:Recaptcha.get_response(),recaptcha_challenge_field:Recaptcha.get_challenge()},type:"POST"}).done(function(a){var b=
this.lightbox.find(".captcha-error-message");b.hide();1===a.is_valid?(this.captcha.close(),this.callback(a.secret)):(Recaptcha.reload(),b.show())}.bind(this));a.preventDefault()}})}();xing=xing||{};xing.controls=xing.controls||{};
xing.controls.FormErrorMessage=function(){var a,b;return function(c,d,e,f){var c=$(c),g;a=a||$("#signup-error-message");g=a.clone().removeAttr("id");"right"===f.position&&g.addClass("form-error-message-left");g.find("p").html(e);d=new xing.controls.Layer(c,$.extend({layer:g,event:d,position:f.position||"left",forcePosition:!0},{onOpen:function(a,c){b&&b!==c&&b.close();b=c}},f||{}));return{remove:d.stop.bind(d)}}}();xing=xing||{};xing.utils=xing.utils||{};xing.globals=xing.globals||{};
xing.utils.Preloader=function(){if(!this.complete){var a=xing.globals,b=a.baseUrl;"/img/n/body-m-1-2.png /img/n/ill_contacts_of_r2.png /img/n/ill_premium_small.png /img/n/nobody_f.140x185.jpg /img/n/nobody_f.18x24.jpg /img/n/nobody_f.30x40.jpg /img/n/nobody_f.57x75.jpg /img/n/nobody_f.70x93.jpg /img/n/nobody_f_s2.png /img/n/nobody_m.140x185.jpg /img/n/nobody_m.18x24.jpg /img/n/nobody_m.30x40.jpg /img/n/nobody_m.57x75.jpg /img/n/nobody_m.70x93.jpg /img/n/nobody_m_s2.png /img/s/icn-sprite_r1209271230.png /img/s/upgrade-sprite_r1203131705.png /img/s/xtsearch-sprite_r1111221449.png /img/s/icna-sprite_r1210041646.png /img/v/ajax_wait_r1.gif /img/v/transparent_r1.gif".split(" ").concat(a.preloadAssets||
[]).forEach(function(a){(new Image).src=b+a});this.complete=!0}};$(window).on("load",function(){var a=xing.utils.Preloader,b=$("[data-preloader]");b.length&&(b.one("keyup input",function(){a()}),setTimeout(function(){b.val()&&a()},500))});
xing.define("ContentSwitcher",function(){function a(a,g){var d={};d[c]=a;g&&(d[b]=g);return d}var b,c,d,e;return Class.create({initialize:function(f,g){var i=document.createElement("span"),h=i.style;if($.isUndefined(e)&&(e=!1,"transform"in h&&(d="transitionend",b="transform",c="transition"),"WebkitTransform"in h&&(d="webkitTransitionEnd",b="WebkitTransform",c="WebkitTransition"),"MozTransform"in h&&(d="transitionend",b="MozTransform",c="MozTransition"),"MSTransform"in h&&(d="msTransitionEnd",b="MSTransform",
c="MSTransition"),"OTransform"in h&&(d="oTransitionEnd",b="OTransform",c="OTransition"),b))i.style[b]="rotateY(180deg)",e="rotateY(180deg)"===i.style[b];this.transitionSupported=e;g&&(g.simple&&xing.browser[g.simple])&&(this.transitionSupported=!1);this.layer=$(f);this.front=this.layer.find(".front");this.back=this.layer.find(".back");this.transitionSupported&&(this.layer.css(a("0.3s")),this.front.css(a("opacity 0.2s")),this.back.css(a("opacity 0.2s","rotateY(180deg)")));this.getData=""===this.back.html().trim();
this.arrow=this.layer.find("div.upper-login-arrow");this.finishSwitch=this.finishSwitch.bind(this);this.observe()},observe:function(){this.layer.on("click","a[data-switch]",function(a){var b=$(a.currentTarget),c=b.attr("data-switch"),c="href"===c?b.attr("href"):c;this.getData&&!this.loaded?(b.hasClass("icon-links")&&b.addClass("loading"),new xing.utils.ContentLoader(c,this.back,{done:function(){this.loaded=!0;b.hasClass("icon-links")&&b.removeClass("loading");this.switchContent()}.bind(this)})):this.switchContent();
a.preventDefault()}.bind(this))},switchContent:function(){this.switched?this.setContent("front",this.afterFinishBackward.bind(this)):this.setContent("back",this.afterFinishForward.bind(this));this.switched=!this.switched},setContent:function(a,c){var e={},h="front"===a;this.arrow.hide();this.transitionSupported?(e[b]=h?"rotateY(0deg)":"rotateY(180deg)",this.layer.css(e),this.front.css({opacity:h?1:0}),this.back.css({opacity:h?0:1}),this.layer.on(d,c)):(this.front[h?"fadeIn":"fadeOut"](),this.back[h?
"fadeOut":"fadeIn"](),c())},afterFinishForward:function(){this.setArrow({left:"auto",right:50});this.front.hide();this.back.show();setTimeout(this.finishSwitch,10)},afterFinishBackward:function(){this.front.css({height:""}).show();this.back.hide();this.setArrow({left:"",right:""});setTimeout(this.finishSwitch,10)},finishSwitch:function(){var a=this.back.add(this.front).filter(":visible").find(":focusable-input");a.length&&a.first().focus();this.transitionSupported&&this.layer.off(d)},setArrow:function(a){this.arrow.css(e?
a:{}).show()}})}());
