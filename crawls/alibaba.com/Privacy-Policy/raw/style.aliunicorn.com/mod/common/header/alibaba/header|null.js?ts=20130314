
var globalImgServer='http://style.alibaba.com';if(location.protocol==="https:"){globalImgServer='https://ipaystyle.alibaba.com';};

AE.define('common.beacon.cookieInfo',['core'],function(core){var win=window,AE=win.AE,util=AE.util,_data={},exports=null;function parseSubCookie(name,filter){var cookie=util.getCookie(name),data=_data;if(cookie){data[name]=cookie;var parts=cookie.split('&'),i,len=parts.length,pair,key,value;for(i=0;i<len;i++){pair=parts[i];pair=pair.split('=');key=pair[0];value=pair[1];if(!filter||filter[key]){data[key]=value;}}}}
function parseUserInfo(){var userInfo=null,data=_data,x_user=data['x_user'],parts=x_user.split('|');userInfo={"country":parts[0],"firstName":parts[1],"lastName":parts[2],"memberType":parts[3],"memberSeq":parts[4]};data['userInfo']=userInfo;}
function init(){var data=_data;parseSubCookie('xman_us_f',{x_local:true,x_user:true});parseSubCookie('xman_us_t',{sign:true});data['isNew']=false;data['isMember']=false;data['isLogin']=false;if(data['xman_us_f']&&data['x_user']){data['isMember']=true;parseUserInfo();}else{data['isNew']=true;}
if(data['isMember']&&data['sign']=='y'){data['isLogin']=true;}}
init();exports={get:function(name){return _data[name];},getUser:function(key){if(this.get('isMember')){var info=_data['userInfo'];if(key){info=info[key];}
return info;}}};return exports;});;

AE.define('common.beacon.user',['core','dom','common.beacon.cookieInfo'],function(core,dom,cookieInfo){var NEW_USER_HTML='Welcome to Alibaba.com , <a rel="nofollow" href="http://us.my.alibaba.com/user/join/join_step1.htm"><strong>Join Free</strong></a> | <a rel="nofollow" href="https://login.alibaba.com/">Sign In</a>',MEMBER_USER_HTML='Welcome {firstName}, <a rel="nofollow" href="https://login.alibaba.com/">Sign In</a> (<a rel="nofollow" href="https://login.alibaba.com/">Not you?</a>) ',LOGIN_USER_HTML='Welcome {firstName}, <a href="http://us.my.alibaba.com/user/sign/sign_out.htm" rel="nofollow">Sign Out</a>',doc=dom.Document();this.exports.init=function(config){config=config||{};var info=cookieInfo,html='',container=doc.byId(config.containerId||'beacon-user');if(!container){return;}
if(info.get('isLogin')){html=LOGIN_USER_HTML;html=html.replace('{firstName}',info.getUser('firstName').substr(0,20));}else if(info.get('isMember')){html=MEMBER_USER_HTML;html=html.replace('{firstName}',info.getUser('firstName').substr(0,20));}else{html=NEW_USER_HTML;}
container.set('innerHTML',html);};});;

AE.define('common.beacon.dropdown',['core','dom','ua'],function(core,dom,ua){var defConfig={containerId:'beacon-main',menuClass:'ui-beacon-drop',linkClass:'ui-beacon-item-link',hoverClass:'ui-beacon-drop-hover'};this.exports.init=function(config){var doc=dom.Document(),config=core.merge(defConfig,config||{});var header=doc.byId(config.containerId),items=header.byClass(config.menuClass,'li');if(!header){return;}
if(ua.ie===6){items.forEach(function(item,index){item.on('mouseover',function(e){item.addClass(config.hoverClass);});item.on('mouseout',function(e){item.removeClass(config.hoverClass);});});}};});;

AE.define('common.beacon.dropdownMessage',['core','dom','lang'],function(core,dom,lang){var YUG=YAHOO.util.Get,isHomePage=(window.location.pathname==='/'||window.location.pathname===''),defConfig={targetId:'beacon-message',dataUrl:'http://notification.alibaba.com/notification.do',countElClass:'ui-beacon-message-count',countClass:'ui-beacon-message-has-count',subMenuClass:'ui-beacon-subs',subMenuItemTpl:'<li class="ui-beacon-sub"><a class="{className}" rel="nofollow" target="_blank" href="{link}">{content}</a></li>',subMenuItemLinkClass:{notification:'ui-beacon-sub-note',message:'ui-beacon-sub-link',separator:'ui-beacon-sub-separator',entrance:'ui-beacon-sub-entrance'},message:{no:'No new notifications',view:'View {name}',have:'<strong>{count}</strong> New {name}'}},BLANK_LINK='javascript:;';function jsonp(url,callback){var callbackName;if(url&&lang.isString(url)){callbackName='jsonp_callback_'+(new Date().getTime());AE[callbackName]=callback;url=url+'?callback=AE.'+callbackName;YUG.script(url,{onSuccess:function(o){o.purge();delete AE[callbackName];},onFailure:function(o){o.purge();delete AE[callbackName];}});}}
function addTracelog(url,log){var logKey='?tracelog=',added=false,result='';if(url&&log){result=url.replace(/\?((?:\&?[^\&#]+)+)/,function($0,$1){added=true;return logKey+log+'&'+$1;});if(!added){result=url.replace(/#(?:[^\?]+)/,function($0){added=true;return logKey+log+$0;});}
if(!added){result+=(logKey+log);}}
return result;}
function substitute(str,obj){if(lang.isString(str)&&lang.isObject(obj)){str=str.replace(/\{(\w+)\}/gi,function(s,k){return(typeof obj[k]==='undefined')?s:obj[k];}).replace(/(\\\{)|\\\}/g,function(s,k){return k?'{':'}';});}
return str;}
this.exports.init=function(config){config=core.merge(defConfig,config||{});var doc=dom.Document(),item=doc.byId(config.targetId),subMenu=item&&item.byClass(config.subMenuClass,'ul')[0],countEl=item&&item.byClass(config.countElClass,'span')[0],callback;if(!item||!subMenu){return;}
callback=function(data){var subMenuHtml='',allCount=0,newArr=[],defArr=[],dataArr=[],linkClass=config.subMenuItemLinkClass,message=config.message,separatorItem;if(!lang.isArray(data)){return;}
data.forEach(function(d,k){var content=message.no,tracelog='';if(!d.name){return;}
tracelog='notification_'+d.name.toLowerCase().replace(' ','_');tracelog=tracelog+(isHomePage?'_homepage':'');if(d.count>0){content=substitute(message.have,{count:d.count,name:d.name});newArr.push({className:linkClass.message,link:addTracelog(d.url,tracelog),content:content});}else if(d.count===0){content=substitute(message.view,{name:d.name});defArr.push({className:linkClass.entrance,link:addTracelog(d.url,tracelog),content:content});}
allCount+=d.count;});if(countEl){if(allCount===0){countEl.removeClass(config.countClass);countEl.set('innerHTML','');}else{countEl.addClass(config.countClass);allCount=allCount<100?allCount:'99+';countEl.set('innerHTML',allCount);}}
separatorItem={className:linkClass.separator,link:BLANK_LINK,content:''};if(newArr.length===0){newArr=[{className:linkClass.notification,link:BLANK_LINK,content:message.no}];}
if(defArr.length===0){dataArr=newArr.concat(defArr);}else{dataArr=newArr.concat(separatorItem).concat(defArr);}
dataArr.forEach(function(d,k){subMenuHtml+=substitute(config.subMenuItemTpl,d);});subMenu.set('innerHTML',subMenuHtml);};jsonp(config.dataUrl,callback);};});;

AE.define('common.header.Base',['lang','core','dom'],function(lang,core,dom){var doc=dom.Document(),Base;Base=core.extend(core.Base,{_izer:function(config){this.disabled=true;this._mods=config.mods;this.controllers=config.controllers;this.mods=undefined;this._modList={};this._container=doc.byId(config.containerId);},_getMods:function(modules){if(modules===undefined){modules=this._mods;}
this.mods=modules;return modules;},getModList:function(){return this._modList;},_mergeConfig:function(uConfig){var config=core.merge({},uConfig);return config;},init:function(uConfig){var modules,config;config=this.config=this._mergeConfig(uConfig);modules=this._getMods(config.mod);if(this._container&&modules){this.enable();}else{this.disable();}},getContainer:function(){return this._container;},_addModList:function(modList){var modName,i,len;if(lang.isArray(modList)){for(i=0,len=modList.length;i<len;i++){modName=modList[i];this._addMod(modName);}}},_addMod:function(modName){var mod=this._modList[modName],controller;if(!mod){controller=this.controllers[modName];if(controller){mod=controller(this);}
if(mod){this._modList[modName]=mod;}}},enable:function(){this.disabled=false;this._addModList(this.mods);},disable:function(){this.disabled=true;this.mods=this._mods;this._modList={};if(this._container){this._container.setStyle('display','none');}},getOperation:function(){return{};}},{containerId:'',mods:[],controllers:{}});return Base;});;

AE.define('common.beacon',['lang','core','dom','common.beacon.cookieInfo','common.beacon.user','common.beacon.dropdown','common.beacon.dropdownMessage','common.header.Base'],function(lang,core,dom,cookieinfo,user,dropdown,dropdownMessage,Base){var doc=dom.Document(),ID_USER='beacon-user',ID_MAIN='beacon-main',header=doc.byId('header2012'),uiClass='ui-header-normal-beacon',Beacon=null;Beacon=core.extend(Base,{enable:function(){Beacon.superclass.enable.call(this);header.addClass(uiClass);},disable:function(){Beacon.superclass.disable.call(this);header.removeClass(uiClass);}},{containerId:'mod-beacon',mods:['user','nav'],controllers:{'user':function(){user.init({containerId:ID_USER});},'nav':function(){dropdown.init({containerId:ID_MAIN});dropdownMessage.init();}}});return new Beacon;});;

AE.define('common.header.sundry.Base',['core','dom'],function(core,dom){var Base,doc=dom.Document();Base=core.extend(core.Base,{_izer:function(uConfig){var config=this.config=uConfig;this.disabled=true;this._mod=doc.byId(config.modId);this._uiClass=config.uiClass;},init:function(base){this._container=base.getContainer();if(this._mod){this.enable();}},getContainer:function(){return this._mod;},enable:function(){this.disabled=false;this._container.addClass(this._uiClass);},disable:function(){this.disabled=true;this._container.removeClass(this._uiClass);},html:function(html){if(!this.disabled){this._mod.set('innerHTML',html);}
return this;}},{modId:'',uiClass:''});return Base;});;

AE.define('common.header.sundry.anchor',['common.header.sundry.Base'],function(Base){var anchor;anchor=new Base({modId:'header-anchor',uiClass:'ui-header-mod-anchor'});return anchor;});;

AE.define('common.header.sundry.action',['core','common.header.sundry.Base'],function(core,Base){var Action;Action=core.extend(Base,{href:function(url){if(!this.disabled){this._mod.byTag('A')[0].set('href',url);}
return this;},buttonText:function(text){if(!this.disabled){this._mod.byTag('A')[0].set('innerHTML',text);}
return this;}},{modId:'header-action',uiClass:'ui-header-mod-action'});return new Action;});;

AE.define('common.header.sundry.extend',['common.header.sundry.Base'],function(Base){var extend;extend=new Base({modId:'header-extend',uiClass:'ui-header-mod-extend'});return extend;});;

AE.define('common.header.sundry',['core','common.header.sundry.anchor','common.header.sundry.action','common.header.sundry.extend','common.header.Base'],function(core,anchor,action,extend,Base){var Sundry,exports;Sundry=core.extend(Base,{getOperation:function(){return this.getModList();}},{containerId:'header2012',mods:['anchor','action','extend'],controllers:{'anchor':function(sundry){anchor.init(sundry);if(!anchor.disabled){return anchor;}},'action':function(sundry){action.init(sundry);if(!action.disabled){return action;}},'extend':function(sundry){extend.init(sundry);if(!extend.disabled){return extend;}}}});exports=new Sundry;exports.Base=Sundry;return exports;});;

AE.define("aisn.home.position",["dom","lang","ua"],function(f,e,b){var c="viewport",a={TL:"tl",TC:"tc",TR:"tr",CL:"cl",CC:"cc",CR:"cr",BL:"bl",BC:"bc",BR:"br",VIEWPORT:c};a.align=function(i,h){var g=[0,0];if(!i&&!i.el){throw("no element to be positioned!")}i=d(i);h=d(h);g[0]=h.referPoint[0]-i.referPoint[0];g[1]=h.referPoint[1]-i.referPoint[1];if(g[0]!==g[1]||(g[0]+g[1]!==0)){i.el.setXY([i.pos.left+g[0],i.pos.top+g[1]])}};a.center=function(h,g){a.align({el:h,point:"cc"},{el:g,point:"cc"})};function d(i){var j,h,m,g=[0,0],k="getRegion",l;if(i instanceof f.Element||i===c||!i){if(i===c||!i){j=f.Document();k="getClientRegion"}else{j=i}h="tl";m=[0,0];i={el:j,point:h,offset:m}}else{j=i.el;if(!j||j===c){j=f.Document();k="getClientRegion"}if(!(j instanceof f.Node)){throw("el is invalid!")}h=(i.point||a.TL).toLowerCase();if(a[h.toUpperCase()]!==h){throw("point is invalid!")}m=i.offset;if(e.isArray(m)){if(!e.isNumber(m[0])||!e.isNumber(m[1])){throw("offset is invalid!")}}else{m=[0,0]}}l=j[k]();!l.width&&(l.width=l.right-l.left);!l.height&&(l.height=l.bottom-l.top);switch(h.charAt(0)){case"b":g[1]=l.bottom;break;case"c":g[1]=l.top+Math.floor(l.height/2);break;case"t":default:g[1]=l.top;break}switch(h.charAt(1)){case"r":g[0]=l.right;break;case"c":g[0]=l.left+Math.floor(l.width/2);break;case"l":default:g[0]=l.left;break}g[0]+=m[0];g[1]+=m[1];i.referPoint=g;i.pos={top:l.top,left:l.left};return i}return a});;AE.define("aisn.home.triggershow.Base",["core","dom","lang","ua","aisn.home.position"],function(c,e,b,a,g){var d=true,i=false,k=function(l){return l.substring(0,1).toUpperCase()+l.substring(1)},j="visible",h="disabled",f=c.extend(c.Base,{_izer:function(l){if(!(l.triggerNode instanceof e.Node)){throw("triggerNode is invalid!")}if(!(l.contentNode instanceof e.Node)){throw("contentNode is invalid!")}this._triggerNode=l.triggerNode;this._contentNode=l.contentNode;this._showDelayTime=l.showDelayTime;this._hiddenDelayTime=l.hiddenDelayTime;this._timer=-1;this._property2UI();this._initPropertys(l);this._initEvent();this._bindUI();this._initPosition(l.positionCfg)},_dtor:function(){this.rescue("set");this.rescue("show");this.rescue("hide");this._triggerNode.detach();this._contentNode.detach();this.detach();this.removeProperty(j);this.removeProperty(h);this._triggerNode=null;this._contentNode=null},_initPropertys:function(l){this.set(j,l.visible);this.set(h,l.disabled)},_initEvent:function(){this.hijack("show");this.hijack("hide");this.on("before:show",function(){return!this.getDisabled()});this.on("before:hide",function(){return!this.getDisabled()})},_bindUI:function(){},_handleShow:function(n,l){var m=this._showDelayTime;this._clearTimer();if(m){this._timer=setTimeout((function(){this.show()}).bind(this),m)}else{this.show()}},_handleHide:function(n,l){var m=this._hiddenDelayTime;this._clearTimer();if(m){this._timer=setTimeout((function(){this.hide()}).bind(this),m)}else{this.hide()}},_clearTimer:function(){if(this._timer!=-1){clearTimeout(this._timer);this._timer=-1}},_initPosition:function(l){var n,m;if(b.isArray(l)){n=c.mix({el:this._contentNode},l[0]||{},i);m=c.mix({el:this._triggerNode},l[1]||{});this.on("after:show",function(p,o){g.align(n,m)})}},_property2UI:function(){var l={};this._UI_ATTRS.forEach(function(m){l[m]=d});this.hijack("set");this.on("before:set",function(r,p){var n=p.args,o=n[0],q=n[1],m=this.get(o);return m!==q});this.on("after:set",function(q,o){var m=o.args,n=m[0],p=m[1];if(l[n]){this["_uiSet"+k(n)](p)}})},getTrigger:function(){return this._triggerNode},getContent:function(){return this._contentNode},show:function(){this._clearTimer();this.set(j,d)},hide:function(){this._clearTimer();this.set(j,i)},enable:function(){this.set(h,i)},disable:function(){this.set(h,d)},getDisabled:function(){return this.get(h)},_uiSetVisible:function(l){this._contentNode.setStyle("display",l?"":"none")},_UI_ATTRS:[j]},{triggerNode:null,contentNode:null,showDelayTime:100,hiddenDelayTime:100,positionCfg:null,visible:i,disabled:i});return f});;AE.define("aisn.home.triggershow.Overshow",["core","aisn.home.triggershow.Base"],function(a,b){var c=a.extend(b,{_bindUI:function(){this._triggerNode.on("mouseover",this._handleShow.bind(this));this._triggerNode.on("mouseout",this._handleHide.bind(this));this._contentNode.on("mouseover",this._handleShow.bind(this));this._contentNode.on("mouseout",this._handleHide.bind(this))}});return c});;AE.define("aisn.home.triggershow.Clickshow",["core","dom","aisn.home.triggershow.Base"],function(a,d,b){var c=a.extend(b,{_initEvent:function(){c.superclass._initEvent.call(this);this.hijack("_handleShow");this.on("after:_handleShow",function(h,g){var f=g.args;if(f[0]){f[0].stopPropagation()}})},_dtor:function(){this.rescue("_handleShow")},_bindUI:function(){this._triggerNode.on("click",this._handleShow.bind(this));d.Document().on("click",this._handleHide.bind(this));this._contentNode.on("click",this._handleShow.bind(this))}});return c});;AE.define("aisn.home.triggershow",["aisn.home.triggershow.Overshow","aisn.home.triggershow.Clickshow"],function(e,d){var b="over",c="click",a=this.exports={OVER:b,CLICK:c};a.create=function(g,f){switch(g){case b:return new e(f);case c:return new d(f);default:throw("type is invalid!");break}}});;;

AE.define("aisn.home.position",["dom","lang","ua"],function(f,e,b){var c="viewport",a={TL:"tl",TC:"tc",TR:"tr",CL:"cl",CC:"cc",CR:"cr",BL:"bl",BC:"bc",BR:"br",VIEWPORT:c};a.align=function(i,h){var g=[0,0];if(!i&&!i.el){throw("no element to be positioned!")}i=d(i);h=d(h);g[0]=h.referPoint[0]-i.referPoint[0];g[1]=h.referPoint[1]-i.referPoint[1];if(g[0]!==g[1]||(g[0]+g[1]!==0)){i.el.setXY([i.pos.left+g[0],i.pos.top+g[1]])}};a.center=function(h,g){a.align({el:h,point:"cc"},{el:g,point:"cc"})};function d(i){var j,h,m,g=[0,0],k="getRegion",l;if(i instanceof f.Element||i===c||!i){if(i===c||!i){j=f.Document();k="getClientRegion"}else{j=i}h="tl";m=[0,0];i={el:j,point:h,offset:m}}else{j=i.el;if(!j||j===c){j=f.Document();k="getClientRegion"}if(!(j instanceof f.Node)){throw("el is invalid!")}h=(i.point||a.TL).toLowerCase();if(a[h.toUpperCase()]!==h){throw("point is invalid!")}m=i.offset;if(e.isArray(m)){if(!e.isNumber(m[0])||!e.isNumber(m[1])){throw("offset is invalid!")}}else{m=[0,0]}}l=j[k]();!l.width&&(l.width=l.right-l.left);!l.height&&(l.height=l.bottom-l.top);switch(h.charAt(0)){case"b":g[1]=l.bottom;break;case"c":g[1]=l.top+Math.floor(l.height/2);break;case"t":default:g[1]=l.top;break}switch(h.charAt(1)){case"r":g[0]=l.right;break;case"c":g[0]=l.left+Math.floor(l.width/2);break;case"l":default:g[0]=l.left;break}g[0]+=m[0];g[1]+=m[1];i.referPoint=g;i.pos={top:l.top,left:l.left};return i}return a});;AE.define("aisn.home.Placeholder",["core","dom","lang","aisn.home.position"],function(d,f,a,i){var e=true,k=false,g="placeholder",h="input",o="textarea",m=f.Document(),l=function(q){var p;if(!(q instanceof f.Node)){throw("node is invalid!")}p=q.get("tagName").toLowerCase();if(p!=h&&p!=o){throw("node is no input/textarea!")}},n={cursor:"text",position:"absolute",overflow:"hidden",whiteSpace:"nowrap"},j=["fontSize","fontFamily","paddingTop","paddingBottom","paddingLeft","paddingRight","height","lineHeight"],b={parentNode:m.byTag("body")[0]},c;if(g in document.createElement(h)){return function(){}}c=d.extend(d.Base,{_izer:function(p){b=d.merge(b,p);this._node=b.node;l(this._node);AE.defer(function(){this._createPlaceholder();this._bindUI()},this)},_dtor:function(){this.detach()},_createPlaceholder:function(){var s=f.Document(),p=s.createElement("div"),r=this._node,q;for(q in n){if(n.hasOwnProperty(q)){p.setStyle(q,n[q])}}j.forEach(function(t){if(t.indexOf("padding")!=-1){p.setStyle(t,parseInt(r.getStyle(t))+parseInt(r.getStyle(t.replace("padding","border")+"Width"))+"px")}else{if(t=="lineHeight"){p.setStyle(t,Math.max(parseInt(r.getStyle(t))||0,parseInt(r.getStyle("height"))||0)+"px")}else{p.setStyle(t,r.getStyle(t))}}});p.set("innerHTML",r.getAttribute(g)).set("className",r.get("className")+"-placeholder-hint");p.setStyle("display",r.get("value")?"none":"");this._visible=r.get("value")?k:e;p.appendTo(b.parentNode);this._phNode=p;p=null;this._align()},_bindUI:function(){this._node.on("focus",this._hideHint.bind(this));this._node.on("blur",this._showHint.bind(this));this._phNode.on("click",this._hideHint.bind(this));f(window).on("resize",(function(){var p=this;this._fixed=k;setTimeout(function(){p._align()},200)}).bind(this))},_hideHint:function(){this._phNode.setStyle("display","none");this._node[0].focus();this._visible=k},_showHint:function(){if(!this._node.get("value")){this._phNode.setStyle("display","");this._visible=e;if(!this._fixed){this._align()}}},_align:function(){if(this._visible){i.align(this._phNode,this._node);this._fixed=e}},setValue:function(p){if(this._phNode){this._phNode.set("innerHTML",p)}}},{node:null});return c});;;;

AE.define('common.searchbar.history',['core'],function(core){var exports=this.exports;var Cookies={set:function(name,value){var argv=arguments;var argc=arguments.length;var expires=(argc>2)?argv[2]:null;var domain=(argc>3)?argv[3]:null;var path=(argc>4)?argv[4]:'/';var secure=(argc>5)?argv[5]:false;document.cookie=name+"="+escape(value)+
((expires==null)?"":("; expires="+expires.toGMTString()))+
((path==null)?"":("; path="+path))+
((domain==null)?"":("; domain="+domain))+
((secure==true)?"; secure":"");},get:function(name){var arg=name+"=";var alen=arg.length;var clen=document.cookie.length;var i=0;var j=0;while(i<clen){j=i+alen;if(document.cookie.substring(i,j)==arg)
return this.__get(j);i=document.cookie.indexOf(" ",i)+1;if(i==0)
break;}
return null;},__get:function(offset){var endstr=document.cookie.indexOf(";",offset);if(endstr==-1){endstr=document.cookie.length;}
return unescape(document.cookie.substring(offset,endstr));},clear:function(name){var argv=arguments;var argc=arguments.length;var domain=(argc>1)?argv[1]:null;var path=(argc>2)?argv[2]:'/';var secure=(argc>3)?argv[3]:false;if(this.get(name)){document.cookie=name+"="+
((path)?"; path="+path:"")+
((domain)?"; domain="+domain:"")+"; expires=Thu, 01-Jan-70 00:00:01 GMT";}},cookieCache:{},getCookieTable:function(name,domain){var table=Cookies.cookieCache[name];if(null==table||table.changed){table=new CookieTable(name);var str=Cookies.get(name);if(null!=str&&str!=""){table.parseFromString(str);}
if(domain){table.domain=domain;}
Cookies.cookieCache[name]=table;}
return table;}};var noExpires=new Date();noExpires.setTime(noExpires.getTime()+60*60*1000*24*60);var SEP_GROUP="\n\n";var SEP_GROUP_NAME="^\n";var SEP_GROUP_ITEM="$\n";var SEP_ATTR="\t";var NO_SET_STR="NOSET";function isArray(object){return object!=null&&typeof object=="object"&&'join'in object;}
function CookieTable(name,arrOrString,expires,domain,path,secure){this.expires=expires?expires:noExpires;this.domain=domain?domain:null;this.path=path?path:'/';this.secure=secure?secure:false;this.name=name?name:null;this.groups=arrOrString&&isArray(arrOrString)?arrOrString:[];this.__tree={};this.changed=false;this.buildString=function(arr){if(null!=arr&&arr.length>0){return arr.join(SEP_GROUP);}
return null;}
this.parseFromString=function(str){if(null==str||""==str)return this;var arr=str.split(SEP_GROUP);this.removeAll();for(var i=0;i<arr.length;i++){if(null!=arr[i]&&""!=arr[i]){var group=new CookieGroup();group.parseFromString(arr[i]);this.add(group);}}
return this;}
this.toString=function(){return this.buildString(this.groups);}
this.size=function(){return this.groups.length;}
this.arrange=function(){var arr=[],obj={};for(var i=0;i<this.size();i++){if(null!=this.groups[i]){arr[arr.length]=this.groups[i];obj[this.groups[i].name]=this.groups[i];}}
this.removeAll();this.groups=arr;this.__tree=obj;}
this.__clearTree=function(){this.__tree={};}
this.__addToTree=function(obj){if(null!=obj){this.__tree[obj.name]=obj;}}
this.__removeFromTree=function(obj){if(null!=obj){delete this.__tree[obj.name];}}
this.removeAll=function(){this.groups=[];this.__clearTree();}
this.get=function(name){if(this.__tree[name]){return this.__tree[name];}
return null;}
this.add=function(obj){if(null==obj)return;for(var i=0;i<this.size();i++){if(obj.name.toLowerCase()==this.groups[i].name.toLowerCase()){this.remove(obj.name);}}
obj.parent=this;this.groups[this.size()]=obj;this.__addToTree(obj);return this;}
this.remove=function(str){if(null==str||""==str)return;for(var i=0;i<this.size();i++){if(str.toLowerCase()==this.groups[i].name.toLowerCase()){this.__removeFromTree(this.groups[i]);this.groups[i]=null;}}
this.arrange();return this;}
this.save=function(){this.changed=true;Cookies.set(this.name,this.toString(),this.expires,this.domain,this.path,this.secure);}
this.clear=function(){Cookies.clear(this.name);}
if(this.name!=null&&typeof(arrOrString)=="string"){this.parseFromString(arrOrString);}else if(this.name!=null&&isArray(arrOrString)){for(var i=0;i<this.size();i++){if(null!=this.groups[i]){this.__addToTree(this.groups[i]);this.groups[i].parent=this;}}}}
function CookieGroup(name,arrOrString){this.name=name?name:null;this.items=arrOrString&&isArray(arrOrString)?arrOrString:[];this.__tree={};this.max=20;this.parent=null;this.buildString=function(arr){var str=this.name?this.name:NO_SET_STR;if(null!=arr&&arr.length>0){return str+SEP_GROUP_NAME+arr.join(SEP_GROUP_ITEM);}
return str;}
this.parseFromString=function(str){if(null==str||""==str)return this;var name_end=str.indexOf(SEP_GROUP_NAME);if(name_end>-1){this.name=str.substring(0,name_end);var itemsStr=str.substring(name_end+SEP_GROUP_NAME.length);if(null!=itemsStr&&itemsStr!=""){this.removeAll();var arr=itemsStr.split(SEP_GROUP_ITEM);for(var i=0;i<arr.length;i++){if(null!=arr[i]&&""!=arr[i]){var item=new CookieItem();item.parseFromString(arr[i]);this.add(item);}}}}else{this.name=str;}
return this;}
this.toString=function(){return this.buildString(this.items);}
this.getReverse=function(){var arr=[];if(this.size()>0){return this.items.slice(0,this.items.length).reverse();}
return arr;}
this.setMax=function(max){this.max=max;this.arrange();}
this.size=function(){return this.items.length;}
this.arrange=function(){var arr=[],obj={};for(var i=0;i<this.size();i++){if(null!=this.items[i]){arr[arr.length]=this.items[i];}}
if(arr.length>this.max){arr=arr.slice(arr.length-this.max,arr.length);}
for(var i=0;i<arr.length;i++){obj[arr.key]=arr[i];}
this.removeAll();this.items=arr;this.__tree=obj;}
this.__clearTree=function(){this.__tree={};}
this.__addToTree=function(obj){if(null!=obj){this.__tree[obj.key]=obj;}}
this.__removeFromTree=function(obj){if(null!=obj){delete this.__tree[obj.key];}}
this.removeAll=function(){this.items=[];this.__clearTree();}
this.get=function(key){if(this.__tree[key]){return this.__tree[key];}
return null;}
this.add=function(obj){if(null==obj)return;for(var i=0;i<this.size();i++){if(obj.key.toLowerCase()==this.items[i].key.toLowerCase()){this.remove(obj.key);}}
obj.parent=this;this.items[this.size()]=obj;this.__addToTree(obj);return this;}
this.remove=function(str){if(null==str||""==str)return;for(var i=0;i<this.size();i++){if(str.toLowerCase()==this.items[i].key.toLowerCase()){this.__removeFromTree(this.items[i]);this.items[i]=null;}}
this.arrange();return this;}
this.save=function(){if(null!=this.parent){this.arrange();this.parent.save();}}
if(this.name!=null&&typeof(arrOrString)=="string"){this.parseFromString(this.name+SEP_GROUP_NAME+arrOrString);}else if(this.name!=null&&isArray(arrOrString)){for(var i=0;i<this.size();i++){if(null!=this.items[i]){this.__addToTree(this.items[i]);this.items[i].parent=this;}}}}
function CookieItem(key,arrOrString){this.key=key?key:null;this.attributes=arrOrString&&isArray(arrOrString)?arrOrString:[];this.max=20;this.parent=null;this.buildString=function(arr){var str=this.key?this.key:NO_SET_STR;if(null!=arr&&arr.length>0){return str+SEP_ATTR+arr.join(SEP_ATTR);}
return str;}
this.parseFromString=function(str){if(null==str||""==str)return this;var arr=str.split(SEP_ATTR);if(arr.length>0){this.key=arr[0];this.attributes=arr.slice(1,arr.length);}
return this;}
this.setMax=function(max){this.max=max;this.arrange();}
this.size=function(){return this.attributes.length;}
this.toString=function(){return this.buildString(this.attributes);}
this.getReverse=function(){var arr=[];if(this.size()>0){return this.attributes.slice(0,this.attributes.length).reverse();}
return arr;}
this.reverseString=function(){return this.buildString(this.getReverse());}
this.arrange=function(){var arr=[];for(var i=0;i<this.size();i++){if(null!=this.attributes[i]){arr[arr.length]=this.attributes[i];}}
if(arr.length>this.max){this.attributes=arr.slice(arr.length-this.max,arr.length);}else{this.attributes=arr;}}
this.removeAll=function(){this.attributes=[];}
this.get=function(index){return index<this.size()?this.attributes[index]:null;}
this.add=function(str){if(null==str||""==str)return;this.remove(str);this.attributes[this.size()]=str;this.arrange();return this;}
this.remove=function(str){if(null==str||""==str)return;for(var i=0;i<this.size();i++){if(str.toLowerCase()==this.attributes[i].toLowerCase()){this.attributes[i]=null;}}
this.arrange();return this;}
this.contains=function(str){for(var i=0;i<this.size();i++){if(str.toLowerCase()==this.attributes[i].toLowerCase()){return true;}}}
this.save=function(){if(null!=this.parent){this.arrange();this.parent.save();}}
if(this.key!=null&&typeof(arrOrString)=="string"){this.parseFromString(this.key+SEP_ATTR+arrOrString);}}
var TOP_DOMAIN="alibaba.com";var HISTORY_COOKIE_NAME="history";var GROUP_KEYWORDS="keywords";var GROUP_PRODUCT="product";var GROUP_SELLOFFER="selloffer";var GROUP_BUYOFFER="buyoffer";var GROUP_COMPANY="company";var GROUP_CATEGORY="category";var GROUP_PRODUCT_SELLOFFER=GROUP_PRODUCT+"_"+GROUP_SELLOFFER;var MAX_KEYWORDS=8;var MAX_PRODUCT=8;var MAX_SELLOFFER=8;var MAX_BUYOFFER=6;var MAX_COMPANY=4;var MAX_CATEGORY=6;var MAX_PRODUCT_SELLOFFER=8;function getHistoryCookieTable(){return Cookies.getCookieTable(HISTORY_COOKIE_NAME,TOP_DOMAIN);};function addOrUpdateHistoryCookieItem(groupName,itemKey,value,max){if(null==value||""==value)return;var group=getHistoryCookieGroup(groupName);var item=group.get(itemKey);var changed=false;if(isArray(value)){item=new CookieItem(itemKey,value);changed=true;}else{item=(null==item)?new CookieItem(itemKey):item;item.add(value);changed=true;}
group.add(item);if(groupName==GROUP_KEYWORDS){item.setMax(max);}else{group.setMax(max);}
if(changed){group.save();}};function getHistoryCookieGroup(groupName){var table=getHistoryCookieTable();var group=table.get(groupName);if(null==group){group=new CookieGroup(groupName);table.add(group);group.parent=table;}
return group;};function logKeywordsHistory(value){addOrUpdateHistoryCookieItem(GROUP_KEYWORDS,GROUP_KEYWORDS,value,MAX_KEYWORDS);};function logProductHistory(itemKey,value){addOrUpdateHistoryCookieItem(GROUP_PRODUCT_SELLOFFER,itemKey,value,MAX_PRODUCT_SELLOFFER);};function logSellOfferHistory(itemKey,value){addOrUpdateHistoryCookieItem(GROUP_PRODUCT_SELLOFFER,itemKey,value,MAX_PRODUCT_SELLOFFER);};function logCompanyHistory(itemKey,value){addOrUpdateHistoryCookieItem(GROUP_COMPANY,itemKey,value,MAX_COMPANY);};function logBuyOfferHistory(itemKey,value){addOrUpdateHistoryCookieItem(GROUP_BUYOFFER,itemKey,value,MAX_BUYOFFER);};function logCategoryHistory(itemKey,value){addOrUpdateHistoryCookieItem(GROUP_CATEGORY,itemKey,value,MAX_CATEGORY);};core.mix(exports,{getHistoryCookieGroup:getHistoryCookieGroup,logKeywordsHistory:logKeywordsHistory});});;

AE.define('common.searchbar.statistics',['lang','core','common.searchbar.searchbarData'],function(lang,core,searchbarData){var win=window,dmtrack=win.dmtrack||{clickstat:function(url,args){var str=url+'?',parts=[];Object.keys(args).forEach(function(key){parts.push(key+'='+args[key]);});str+=parts.join('&');var img=new Image();img.src=str;}},data=null,intell=null,pid=(win.dmstat&&win.dmstat.pid)||'0bdbc7f56188458aa0a002d4aff8a65c',REPORT_URL='http://stat.alibaba.com/qr/queryreport.html'
return{init:function(_intell){data=searchbarData;_intell.on(_intell.ITEM_SELECTED,this._intellItemSelected.bind(this));_intell.on(_intell.DATA_BACK,this._intellDataBack.bind(this));intell=_intell;},_createReport:function(args){var defaultArgs={time:(new Date).getTime(),pid:pid,set:data.get('statis')||'s',area:'sb1',value:''};args=core.merge(defaultArgs,args);var parts=[];Object.keys(args).forEach(function(key){parts.push(key+'='+args[key]);});var img=new Image();img.src=REPORT_URL+'?'+parts.join('&');},_intellReport:function(){if(intell.isSuggestKeyword()){var keyword=intell.getKeywordInfo(),catId=keyword.suggestCatId,ckw=keyword.suggestValue;if(catId){ckw+='^'+catId;}
this._createReport({type:'select',ckw:ckw,ckw2:keyword.lastValue,value:keyword.suggestIndex,ispersonal:keyword.isPersonal});}},_intellDataBack:function(){var keyword=intell.getKeywordInfo(),hasPersonal=intell.getHasPersonal();this._createReport({type:'select',ckw:keyword.currentValue,ckw2:'',value:'',ispersonal:hasPersonal});},_intellItemSelected:function(e){this._intellReport();},onTypeChange:function(e,ev){var statisValue=data.get('name');if(statisValue){dmtrack.clickstat('http://stat.alibaba.com/performance/list.html',{'click_region':'top_switch_button','click_value':statisValue.toLowerCase()});}},onSubmit:function(e){if(!intell){return;}
var keyword=intell.getKeywordInfo();this._createReport({ckw:keyword.currentValue,ckw2:'',value:'',type:'sbtn'});this._intellReport();}};});;

AE.define('common.searchbar.searchForm',['lang','core','dom','aisn.home.Placeholder','common.searchbar.history','common.searchbar.cem'],function(lang,core,dom,Placeholder,history,cem){var doc=dom.Document(),config={keywordId:'',cateId:'',typeId:'',formId:'',searbarId:'',placeholder:''},formNode=null,keywordNode=null,cateNode=null,typeNode=null,exports={},placeholderCtrl=null;core.mix(exports,core.IEventable.prototype,{CHANGE_VALUE:'changeValue',SUBMIT:'submit',BEFORE_SUBMIT:'beforeSubmit',init:function(_config){config=core.merge(config,_config);formNode=doc.byId(config.formId);keywordNode=doc.byId(config.keywordId);cateNode=doc.byId(config.cateId);typeNode=doc.byId(config.typeId);this._initDefaultValue(keywordNode);this._bingEv();this._bindUI();this.setPlaceholderValue(config.placeholder);placeholderCtrl=new Placeholder({node:keywordNode,parentNode:doc.byId(config.searbarId)});},setPlaceholderValue:function(value){if(placeholderCtrl&&placeholderCtrl.setValue){placeholderCtrl.setValue(value);}else{keywordNode.setAttribute('placeholder',value);}},_initDefaultValue:function(node){if(!node.get('defaultValue')){try{var doc=window.opener.document,value=doc.getElementById(config.keywordId).value;node.set('value',value);}catch(e){}}},_bingEv:function(){cem.subscribe(exports.CHANGE_VALUE,function(e,args){var keyword=args.keyword,cateId=args.cateId,type=args.type,formAction=args.formAction;if(keyword!==undefined){keywordNode.set('value',keyword);}
if(cateId!==undefined){cateNode.set('value',cateId);}
if(type!==undefined){typeNode.set('value',type);}
if(formAction!==undefined){formNode[0].action=formAction;}});cem.subscribe(exports.SUBMIT,function(e,args){if(exports._onSubmit()){setTimeout(function(){formNode[0].submit();},100);}});},_bindUI:function(){formNode.on('submit',function(e){e.preventDefault();cem.trigger(exports.SUBMIT);});},_verifyKeyword:function(keyword){if(''===keyword){alert('Please input a search term.');return false;}else if(keyword.length>50){alert('please input a search term less than 50 characters.');return false;}else if(!keyword.search(/[^\x00-\x80]/g)){alert('Sorry, the information you filled in is not in English.\nPlease input the information in English instead.');return false;}
return true;},_onSubmit:function(){var value=keywordNode.get('value').trim();if(this._verifyKeyword(value)){this._fire(exports.BEFORE_SUBMIT);return cem.trigger(exports.BEFORE_SUBMIT);}else{keywordNode[0].focus();return false;}}});core.IEventable.apply(exports);return exports;});;

AE.define('common.searchbar.searchAdvanced',['core','dom'],function(core,dom){var doc=dom.Document(),defConfig={inputId:'',btnId:'',url:'http://www.alibaba.com/trade/advancesearch'};function encode(str){return encodeURIComponent(str).replace(/%20/g,'+');}
this.exports.init=function(config,searchbar){config=core.merge(defConfig,config);var inputNode=doc.byId(config.inputId),btnNode=doc.byId(config.btnId),params=[];if(!btnNode){return;}
searchbar.getContainer().addClass(config.uiClass);btnNode.on('click',function(e){e.preventDefault();params.push('advancedSearchText='+encode(inputNode.get('value')));AE.util.redirect(config.url+'?'+params.join('&'));});};});;

AE.define('common.searchbar.searchbarData',['lang','core'],function(lang,core){var datas=new core.Base(),defaultData=[],dataBase={},currentType='products',plainData={'staticSuggestType':'recentKeywords'};core.mix(datas,{_key4Data:function(key){var data=dataBase[currentType];if(!data[key]){data=plainData;}
return data;},_availableData:function(config){var tempData=null,tempObj={},isDefaultData=true,self=this;if(config.data&&lang.isArray(config.data)){config.data.forEach(function(item,index){if(lang.isString(item)&&defaultData.some(function(obj){return item===obj.name;})){var itemData=defaultData.filter(function(obj){return item===obj.name;});if(itemData&&tempData===null){tempData=[];}
if(itemData){tempData.push(itemData[0]);}}else if(lang.isObject(item)){tempData.push(item);}});}
if(tempData!==null){isDefaultData=false;}
plainData=core.merge(plainData,{'isDefaultData':isDefaultData});tempData=tempData||defaultData;tempData.forEach(function(item,index){var key=item['name'].toLowerCase();self.addType(key);tempObj[key]=item;});return tempObj;},init:function(config){if(config.currentType){currentType=config.currentType;delete config.currentType;}
defaultData=[{'action':config.aisnServer+'/trade/search','name':'Products','typeValue':'product_en','statis':'p','recentUrl':'http://www.alibaba.com/products/{@}.html'},{'action':config.aisnServer+'/trade/search','name':'Suppliers','typeValue':'company_en','statis':'c','recentUrl':'http://sourcing.alibaba.com/rfq_search_list.htm?SearchText={@}'},{'action':'http://sourcing.alibaba.com/rfq_search_list.htm','name':'Buyers','typeValue':'offer_en','statis':'b','recentUrl':'http://www.alibaba.com/corporations/{@}.html'}];plainData=core.merge(plainData,config);this.registerTypeData(this._availableData(config));this.hijack('set');},getType:function(){return currentType;},setType:function(type){if(dataBase[type]){currentType=type;}},registerTypeData:function(data){var args=arguments,arr=null;types=Object.keys(data);types.forEach(function(type){if(dataBase[type]){core.mix(dataBase[type],data[type]);}});},addType:function(type){dataBase[type]={};},getData:function(){return dataBase;}});datas.defineProperties({'*':{get:function(key){var data=this._key4Data(key),value=data[key];return value;},set:function(key,value){var data=this._key4Data(key);data[key]=value;}}});return datas;});;

AE.define('common.searchbar.searchTypeSelect',['core','dom','aisn.home.triggershow','common.searchbar.searchbarData','common.searchbar.cem'],function(core,dom,triggershow,searchbarData,cem){var defConfig={containerId:'',dropdownId:'',displayId:''},data=null,doc=dom.Document(),dropdown=null,container=null,displayNode=null,tsInstance=null,exports=new core.Base(),DEF_KEYWORD_FIELD_NAME='SearchText';core.mix(exports,{ITEM_SELECTED:'changeValue',disabled:true,syncType:function(type){if(this.disabled){return;}
if(type){data.setType(type);}
displayNode.set('innerHTML',data.get('name'));cem.trigger(this.ITEM_SELECTED,{type:data.get('typeValue')||'',formAction:data.get('action')});},init:function(config,searchbar){config=core.merge(defConfig,config);data=searchbarData;dropdown=doc.byId(config.dropdownId);container=doc.byId(config.containerId);displayNode=doc.byId(config.displayId);if(!container){return;}
this.disabled=false;this.searchbar=searchbar;searchbar.getContainer().addClass(config.uiClass);if(!data.get('isDefaultData')){this._renderUI();}
this._initClickshow();},_renderUI:function(){var objectList=data.getData(),html=[],item;for(item in objectList){html.push('<li class="ui-searchbar-type-option"><a href="javascript:void(0)" data-value="'+item+'" rel="nofollow">'+objectList[item].name+'</a></li>');}
dropdown.set('innerHTML',html.join(''));},_initClickshow:function(){var self=this;tsInstance=triggershow.create('click',{triggerNode:container,contentNode:dropdown});dropdown.on('click',function(e){var target=e.target,type=target.getAttribute('data-value');if(type){exports.syncType(type);exports._fire(exports.ITEM_SELECTED,{type:type});cem.trigger('typeSelected',core.mix({},{type:type},self.searchbar.getOperation()));}
tsInstance.hide();e.stopPropagation();});}});return exports;});;

AE.define('common.searchbar.searchSuggestStatic.recentKeywords',['core','dom','common.searchbar.history','aisn.home.triggershow','common.searchbar.searchbarData'],function(core,dom,history,triggerShow,searchbarData){var doc=dom.Document(),GROUP_KEYWORDS='keywords',defConfig={keywordId:'header-search-keyword',containerId:'header-suggest-static',contentId:'header-suggest-static-content'},keywordNode=null,containerNode=null,contentNode=null,data=null,exports=this.exports;function getRecentKeywordsHtml(){var keywordsItems=null,keywords=null,html=[],group=null;group=history.getHistoryCookieGroup(GROUP_KEYWORDS);function encode(str){if(str==null)return'';var retStr=escape(str);if(str.indexOf('+')!=-1){retStr=retStr.replace(/\+/g,'%2B');}
if(str.indexOf('/')!=-1){retStr=retStr.replace(/\//g,'%2F');}
return retStr;}
function encodeKeyword(str){if(str==null)return'';str=str.replace(/^\s*|\s*$/g,'');str=str.replace(/\s+/g,'_');str=encode(str);return encode(str);}
if(group&&group.size()>0){keywordsItems=group.get(GROUP_KEYWORDS);if(keywordsItems&&keywordsItems.size()>0){keywords=keywordsItems.getReverse();keywords.forEach(function(keyword){html.push('<a ref="nofollow" href="javascript:void(0);" data-keyword="'+encodeKeyword(keyword)+'">'
+AE.util.xmlEncode(keyword)
+'</a>');});}}
return html.join(', ');}
function showRecentKeywords(){var html=getRecentKeywordsHtml(),tsInstance=triggerShow.create('over',{triggerNode:keywordNode,contentNode:containerNode,hiddenDelayTime:200});function onInputChange(e){if(keywordNode.get('value')===''){tsInstance.show();}else{tsInstance.hide();}}
keywordNode.on('click',onInputChange);keywordNode.on('keyup',onInputChange);contentNode.on('click',function(e){var target=e.target,keyword=target.getAttribute('data-keyword');if(keyword){AE.util.redirect(data.get('recentUrl').replace('{@}',keyword));}});contentNode.set('innerHTML',html);}
core.IEventable.apply(exports);core.mix(exports,core.IEventable.prototype,{init:function(config){config=core.merge(defConfig,config);data=searchbarData;keywordNode=doc.byId(config.keywordId);containerNode=doc.byId(config.containerId);contentNode=doc.byId(config.contentId);},renderUI:function(){showRecentKeywords();},logKeywords:function(){history.logKeywordsHistory(keywordNode.get('value').trim());}});});;

AE.define('common.searchbar.searchSuggestStatic.popularKeywords',['core','dom','aisn.home.triggershow'],function(core,dom,triggerShow){var defConfig={keywordId:'header-search-keyword',containerId:'header-suggest-static',contentId:'header-suggest-static-content'};this.exports.init=function(config){config=core.merge(defConfig,config);var doc=dom.Document(),keywordNode=doc.byId(config.keywordId),containerNode=doc.byId(config.containerId),contentNode=doc.byId(config.contentId),tsInstance=triggerShow.create('over',{triggerNode:keywordNode,contentNode:containerNode,hiddenDelayTime:200});};});;

AE.define('common.searchbar.SearchSuggestDynamic',['lang','core','dom','common.searchbar.cem'],function(lang,core,dom,cem){var Y=YAHOO,doc=dom.Document(),ITEM_ID_PREFIX='__suggest-item-',CAT_CLASS='header-dynamic-search-category',CAN_BE_USE=false;var SuggestDynamic=core.extend(core.Base,{PRESS_ENTER:'press_enter',ITEM_SELECTED:'changeValue',DATA_BACK:'data_back',_izer:function(config){this._config=config;this._keywordNode=doc.byId(config.keywordId);this._typeNode=doc.byId(config.typeFieldId);this._contentNode=doc.byId(config.contentId);this._requestURL=config.requestURL;if(typeof config.autoSuggestCateId!=='undefined'){this._autoSuggestionCateId=config.autoSuggestCateId;}else{this._autoSuggestionCateId='';}
this._hasPersonal=0;this._enableNetInvoke=false;this._keyword={lastValue:'',currentValue:'',suggestIndex:-1,suggestValue:'',suggestCatId:'',isPersonal:0};this._itemsNode=[];this._activeLength=0;this._renderUI();this._bindUI();},_renderUI:function(){var UL=doc.createElement('ul'),LI=null;for(var i=0;i<10;i++){LI=doc.createElement('li');LI.set('index',i);LI.set('id',ITEM_ID_PREFIX+i);LI.appendTo(UL);this._itemsNode.push(LI);}
this._hideItems();UL.appendTo(this._contentNode);},_bindUI:function(){var self=this;doc.on('click',function(){self.hide();});YUE.on(this._keywordNode[0],'paste',function(e){AE.defer(function(){self.enable();self._netInvoke();});});this._keywordNode.on('keyup',function(e){self._netInvoke();});this._keywordNode.on('click',function(e){if(self._getKeyword()){self.show();}else{self.hide();}
e.stopPropagation();});this._keywordNode.on('keydown',this._onInputKeyDown.bind(this));this._onItemMouseOver=this._onItemMouseOver.bind(this);this._onItemClick=this._onItemClick.bind(this);this._itemsNode.forEach(function(item){item.on('click',self._onItemClick);item.on('mouseover',self._onItemMouseOver);});},_syncUI:function(datas){var items=this._itemsNode,item=null,data=null,html='',len=this._activeLength=datas.length<items.length?datas.length:items.length;this._hideItems();for(var i=0;i<len;i++){item=items[i];data=datas[i];html='<a href="javascript:void(0)">';html+=data.keywords;item.set('catId','');if(data.cat){var catIds=Object.keys(data.cat);catIds.forEach(function(catId){item.set('catId',catId);html+='<span class="'+CAT_CLASS+'"> in '+data.cat[catId]+'</span>';});}
html+='</a>';item.set('keyword',data.keywords);item.set('innerHTML',html);item.set('personal',data.personal);item.setStyle('display','block');}},_getKeyword:function(){return this._keywordNode.get('value').trim();},getKeywordInfo:function(){return core.merge(this._keyword,{currentValue:this._getKeyword()});},isSuggestKeyword:function(){var word=this._keyword;if(word.suggestValue&&word.suggestIndex>=0&&this._getKeyword()===word.suggestValue){return true;}else{return false;}},_updateSuggestItem:function(suggestItem){var value=this._urldecode(suggestItem.get('keyword')),catId=suggestItem.get('catId');this._keyword.suggestCatId=catId;this._keyword.suggestValue=value;this._keyword.isPersonal=suggestItem.get('personal');cem.trigger(this.ITEM_SELECTED,{keyword:value,cateId:catId});},_urldecode:function(str){if(!str){return'';}
str=str.replace(/\&lt;/g,'<');str=str.replace(/\&gt;/g,'>');str=str.replace(/\&quot;/g,'"');str=str.replace(/\&#39;/g,"'");str=str.replace(/\&amp;/g,'&');return str;},_buildURL:function(keyword){var hasOwn=Object.prototype.hasOwnProperty,parts=[],args={},url=this._requestURL;args={iframe_delete:'true',time:Date.now(),varname:this._config.JSONP,keyword:keyword,searchType:this._typeNode.get('value'),cateId:this._autoSuggestionCateId,cookieId:AE.util.getCookie("ali_beacon_id")};for(var i in args){if(hasOwn.call(args,i)){parts.push(i+'='+args[i]);}}
if(url.indexOf('?')<0){url+='?';}
url=url+parts.join('&');return url;},_parseData:function(data){var items=[],hasPersonal=0;for(var i=0,l=data.length;i<l;i++){if(data[i].personal==='1'){hasPersonal=1;}
if(data[i].cat){items.push({keywords:data[i].keywords,personal:data[i].personal});for(var j=0,k=data[i].cat.length;j<k;j++){items.push({keywords:data[i].keywords,cat:data[i].cat[j],personal:data[i].personal});}}else{items.push(data[i]);}}
this._hasPersonal=hasPersonal;return items;},getHasPersonal:function(){return this._hasPersonal;},_netInvoke:function(keyword){if(this._enableNetInvoke===false){return false;}
var keyword=this._getKeyword();if(!keyword){this.hide();return false;}
Y.util.Get.script(this._buildURL(keyword),{onSuccess:this._netSuccess,scope:this,data:keyword,charset:'utf-8'});},_netSuccess:function(o){var data=eval('window.'+this._config.JSONP)||[];if(lang.isArray(data)&&data.length){var parsedData=this._parseData(data);this._fire(this.DATA_BACK);this._syncUI(parsedData);this._keyword.lastValue=o.data;this._keyword.suggestValue='';CAN_BE_USE=true;this.show();}else{this.hide();}},_hideItems:function(){this._itemsNode.forEach(function(item){item.setStyle('display','none');});},_onItemClick:function(e){var item=e.currentTarget,self=this;self.hide();self._updateSuggestItem(item);self._fire(self.ITEM_SELECTED);cem.trigger('submit');e.stopPropagation();},_onItemMouseOver:function(e){var item=e.currentTarget;this._switchItem(this._keyword.suggestIndex,item.get('index'),true);},_onInputKeyDown:function(e){var keyCode=e.keyCode;this.enable();switch(keyCode){case 13:this._fire(this.PRESS_ENTER);this.disable();cem.trigger('submit');break;case 38:this.disable();this._moveItemHandler('up');break;case 40:this.disable();this._moveItemHandler('down');break;}},_moveItemHandler:function(action){var lastIndex=this._keyword.suggestIndex,index=lastIndex;switch(action){case'up':index--;if(index<-1){index=this._activeLength-1;}
break;case'down':index++;if(index>=this._activeLength){index=-1;}
break;default:return false;}
this._switchItem(lastIndex,index);},_switchItem:function(last,current,keepValue){var lastItem=null,currentItem=null;if(last>-1){this._getByIndex(last).removeClass('current');}
if(current>-1){currentItem=this._getByIndex(current);currentItem.addClass('current');if(!keepValue){this._updateSuggestItem(currentItem);}}
else{cem.trigger(this.ITEM_SELECTED,{keyword:this._keyword.lastValue,cateId:''});}
this._keyword.suggestIndex=current;},_getByIndex:function(index){return doc.byId(ITEM_ID_PREFIX+index);},show:function(){if(CAN_BE_USE){this._contentNode.setStyle('display','block');}},hide:function(){this._contentNode.setStyle('display','none');},enable:function(){this._enableNetInvoke=true;},disable:function(){this._enableNetInvoke=false;}},{keywordId:'header-search-keyword',contentId:'header-suggest-dynamic',typeFieldId:'',requestURL:'http://connectkeyword.alibaba.com/lenoIframeJson.htm',JSONP:'intelSearchData',itemLength:10});return SuggestDynamic;});;

AE.define('common.searchbar.searchRelated',['core','dom'],function(core,dom){var doc=dom.Document(),config={containerId:'searchbar-related'},exports=new core.Base();core.mix(exports,{init:function(uConfig){config=core.merge(config,uConfig);this.container=doc.byId(config.containerId);},html:function(text){if(this.container&&text){this.container.set('innerHTML',text).setStyle('display','block');}}});return exports;});;

AE.define('common.cem',['core','lang'],function(core,lang){var CEM,ctor,cem,domain={},_config={name:'',obj:null,bubble:true};ctor=function(config){var name=config.name,obj=config.obj,bubble=config.bubble;this.domainType='unnamed';if(name){this.name=name;this.domainType='named';}
this._bubble=bubble;this._ranCE={};if(obj){this._context=obj;core.mix(obj,this);core.mix(obj,CEM.prototype);}};CEM=core.extend(core.Base,{_izer:ctor,_trigger:function(e,args,bubble){var result=false;if(lang.isString(e)){e={type:e};}
e.target=e.target||this._context||this;result=this._fire(e,args);bubble=bubble||true;if((bubble||this._bubble)&&this!==cem){cem.trigger(e,args,false);}
this._ranCE[e.type]=[e.target,args];return result;},trigger:function(e,args,bubble){var i,len,type=e,_type,result=[];if(!lang.isArray(e)){type=[e];}
for(i=0,len=type.length;i<len;i++){_type=type[i];result.push(this._trigger.apply(this,arguments));}
return result.length>1?result:result.shift();},_instant:function(type,listener,data){var e={type:type},o=this._ranCE[type];if(o!==undefined){e.target=o[0];if(data){e.data=data;}
listener.call(o[0],e,o[1]);}},subscribe:function(type,listener,data,instant){if(lang.isBoolean(Array.prototype.slice.call(arguments).pop())){instant=data;data=undefined;}
this.on(type,data,listener);if(instant){this._instant(type,listener,data);}},subscribeOnce:function(type,listener,data,instant){if(instant){this._instant(type,listener,data);}else{this.once(type,data,listener);}},unbind:function(type){var events=this._events;this.unsubscribeAll(type);delete events[type];},unsubscribe:function(type,listener){this.detach(type,listener);},unsubscribeAll:function(type){var events=this._events,listeners=events[type],i,len;for(i=0,len=listeners.length;i<len;++i){this.unsubscribe(type,listeners[i]);}}},_config);if(cem===undefined){cem=new CEM({bubble:false});core.mix(cem,{domain:function(name,obj,bubble){if(arguments.length<3){if(lang.isBoolean(name)){bubble=name;name='';obj=null;}
if(lang.isObject(name)){obj=name;bubble=obj;name='';}}
var _cem;if(name){_cem=domain[name];}
if(_cem===undefined){_cem=new CEM({name:name,obj:obj,bubble:bubble||true});}
if(name){domain[name]=_cem;}
return _cem;},domainType:'global'},true);}
return cem;});;

AE.define('common.searchbar.cem',['common.cem'],function(cem){var SEARCH='searchbar',cemSearch=cem.domain(SEARCH,false);return cemSearch;});;

AE.define('common.searchbar',['lang','core','dom','common.searchbar.searchbarData','common.searchbar.searchTypeSelect','common.searchbar.searchSuggestStatic.recentKeywords','common.searchbar.searchSuggestStatic.popularKeywords','common.searchbar.SearchSuggestDynamic','common.searchbar.searchForm','common.searchbar.searchAdvanced','common.searchbar.statistics','common.searchbar.searchRelated','common.header.Base'],function(lang,core,dom,searchbarData,typeSelect,recentKeywords,pulularKeywords,DynamicSuggest,searchForm,advanced,statistics,related,Base){var SearchBar,ID_SEARCHBAR='mod-searchbar',ID_FORM='searchbar-form',ID_TYPE='searchbar-type',ID_FIELD_TYPE='searchbar-field-type',ID_FIELD_CATEGORY='searchbar-field-category',ID_TYPE_OPTIONS='searchbar-type-options',ID_TYPE_DISPLAY='searchbar-type-display',ID_FIELD_KEYWORD='searchbar-keyword',ID_STATIC='searchbar-static',ID_STATIC_CONTENT='searchbar-static-content',ID_DYNAMIC='searchbar-dynamic',ID_ADVANCED='searchbar-advanced',ID_RELATED='searchbar-related',ID_SUBMIT='searchbar-submit',UI_MOD_TYPE='ui-searchbar-mod-type',UI_MOD_ADVANCED='ui-searchbar-mod-advanced',intelligentSearch,doc=dom.Document(),controller=null,config={'data':null,'currentType':'products','currentKeyword':'','staticSuggestType':'','aisnServer':'http://www.alibaba.com','autoSuggestionCateId':'','placeholder':'Please input a keyword'};controller={initSearchForm:function(){searchForm.init({keywordId:ID_FIELD_KEYWORD,cateId:ID_FIELD_CATEGORY,typeId:ID_FIELD_TYPE,formId:ID_FORM,searbarId:ID_SEARCHBAR,placeholder:config.placeholder});},initStatistics:function(){var stat=statistics;if(intelligentSearch){stat.init(intelligentSearch);}
searchForm.on(searchForm.BEFORE_SUBMIT,stat.onSubmit.bind(stat));typeSelect.on(typeSelect.ITEM_SELECTED,stat.onTypeChange.bind(stat));}};SearchBar=core.extend(Base,{_mergeConfig:function(uConfig){config=core.merge(config,uConfig);(function(){var aisnServer=config.aisnServer,len=aisnServer.length;if('/'===aisnServer[len-1]){config.aisnServer=aisnServer.substr(0,len-1);}})();return config;},init:function(uConfig){this.formMod=doc.byId(ID_FORM);if(!this.formMod){this.disable();}
SearchBar.superclass.init.call(this,uConfig);},enable:function(){searchbarData.init(this.config);controller.initSearchForm();SearchBar.superclass.enable.call(this);controller.initStatistics();},_getField:function(name){var list=this.formMod.byTag('input'),element=null;list.forEach(function(item,index){if(item.get('name')===name&&item.get('type')==='hidden'){element=item;}});return element;},_addField:function(name,value,id){var input=this._getField(name);if(input){input.set('value',value);}else{input=dom.Element({node:document.createElement("input")});input.set('name',name).set('value',value).set('type','hidden');if(id){input.set('id',id);}
input.appendTo(this.formMod);}
return input;},_removeField:function(name){var input=this._getField(name);if(input){input.remove();}},_setFormAction:function(url){this.formMod.set('action',url);},getOperation:function(){return{addField:this._addField.bind(this),removeField:this._removeField.bind(this),setFormAction:this._setFormAction.bind(this),setPlaceholder:searchForm.setPlaceholderValue.bind(this),related:related};}},{containerId:'mod-searchbar',mods:['type','static','dynamic','advanced','related'],controllers:{'type':function(searchbar){typeSelect.init({containerId:ID_TYPE,dropdownId:ID_TYPE_OPTIONS,displayId:ID_TYPE_DISPLAY,uiClass:UI_MOD_TYPE},searchbar);typeSelect.syncType();},'static':function(){var container=doc.byId(ID_STATIC);if(!container||!container.getFirstChild()){return;}
recentKeywords.init({keywordId:ID_FIELD_KEYWORD,containerId:ID_STATIC,contentId:ID_STATIC_CONTENT});searchForm.on(searchForm.BEFORE_SUBMIT,recentKeywords.logKeywords.bind(recentKeywords));if(searchbarData.get('staticSuggestType')==='recentKeywords'){recentKeywords.renderUI();}else{pulularKeywords.init({keywordId:ID_FIELD_KEYWORD,containerId:ID_STATIC,contentId:ID_STATIC_CONTENT});}},'dynamic':function(){var container=doc.byId(ID_DYNAMIC);if(!container){return;}
intelligentSearch=new DynamicSuggest({keywordId:ID_FIELD_KEYWORD,contentId:ID_DYNAMIC,typeFieldId:ID_FIELD_TYPE,autoSuggestCateId:config.autoSuggestionCateId});},'advanced':function(searchbar){advanced.init({inputId:ID_FIELD_KEYWORD,btnId:ID_ADVANCED,uiClass:UI_MOD_ADVANCED},searchbar);},'related':function(){related.init({containerId:ID_RELATED});}}});return new SearchBar;});;

AE.define('common.header',['lang','core','dom','common.beacon','common.header.sundry','common.searchbar'],function(lang,core,dom,beacon,sundry,searchbar){var config={mod:{},beacon:{},searchbar:{},sundry:{}},exports=new core.Base();core.mix(exports,{init:function(uConfig){config=core.merge(config,uConfig);var mods=config.mod;beacon.init(core.mix({},config,{mod:mods.beacon},config.beacon,true));searchbar.init(core.mix({},config,{mod:mods.searchbar},config.searchbar,true));sundry.init(core.mix({},config,{mod:mods.sundry},config.sundry,true));if(lang.isFunction(config.initComplete)){config.initComplete.call(this,beacon.getOperation(),sundry.getOperation(),searchbar.getOperation());}}});return exports;});;
;
