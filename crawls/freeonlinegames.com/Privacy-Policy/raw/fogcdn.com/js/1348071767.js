MooTools.More={version:"1.4.0.1",build:"a4244edf2aa97ac8a196fc96082dd35af1abab87"};
var Drag=new Class({Implements:[Events,Options],options:{snap:6,unit:"px",grid:!1,style:!0,limit:!1,handle:!1,invert:!1,preventDefault:!1,stopPropagation:!1,modifiers:{x:"left",y:"top"}},initialize:function(){var a=Array.link(arguments,{options:Type.isObject,element:function(a){return null!=a}});this.element=document.id(a.element);this.document=this.element.getDocument();this.setOptions(a.options||{});a=typeOf(this.options.handle);this.handles=("array"==a||"collection"==a?$$(this.options.handle):
document.id(this.options.handle))||this.element;this.mouse={now:{},pos:{}};this.value={start:{},now:{}};this.selection=Browser.ie?"selectstart":"mousedown";Browser.ie&&!Drag.ondragstartFixed&&(document.ondragstart=Function.from(!1),Drag.ondragstartFixed=!0);this.bound={start:this.start.bind(this),check:this.check.bind(this),drag:this.drag.bind(this),stop:this.stop.bind(this),cancel:this.cancel.bind(this),eventStop:Function.from(!1)};this.attach()},attach:function(){this.handles.addEvent("mousedown",
this.bound.start);return this},detach:function(){this.handles.removeEvent("mousedown",this.bound.start);return this},start:function(a){var b=this.options;if(!a.rightClick){b.preventDefault&&a.preventDefault();b.stopPropagation&&a.stopPropagation();this.mouse.start=a.page;this.fireEvent("beforeStart",this.element);var c=b.limit;this.limit={x:[],y:[]};var e,g;for(e in b.modifiers)if(b.modifiers[e]){var h=this.element.getStyle(b.modifiers[e]);h&&!h.match(/px$/)&&(g||(g=this.element.getCoordinates(this.element.getOffsetParent())),
h=g[b.modifiers[e]]);this.value.now[e]=b.style?(h||0).toInt():this.element[b.modifiers[e]];b.invert&&(this.value.now[e]*=-1);this.mouse.pos[e]=a.page[e]-this.value.now[e];if(c&&c[e])for(h=2;h--;){var f=c[e][h];if(f||0===f)this.limit[e][h]="function"==typeof f?f():f}}"number"==typeOf(this.options.grid)&&(this.options.grid={x:this.options.grid,y:this.options.grid});a={mousemove:this.bound.check,mouseup:this.bound.cancel};a[this.selection]=this.bound.eventStop;this.document.addEvents(a)}},check:function(a){this.options.preventDefault&&
a.preventDefault();Math.round(Math.sqrt(Math.pow(a.page.x-this.mouse.start.x,2)+Math.pow(a.page.y-this.mouse.start.y,2)))>this.options.snap&&(this.cancel(),this.document.addEvents({mousemove:this.bound.drag,mouseup:this.bound.stop}),this.fireEvent("start",[this.element,a]).fireEvent("snap",this.element))},drag:function(a){var b=this.options;b.preventDefault&&a.preventDefault();this.mouse.now=a.page;for(var c in b.modifiers)if(b.modifiers[c]){this.value.now[c]=this.mouse.now[c]-this.mouse.pos[c];b.invert&&
(this.value.now[c]*=-1);if(b.limit&&this.limit[c])if((this.limit[c][1]||0===this.limit[c][1])&&this.value.now[c]>this.limit[c][1])this.value.now[c]=this.limit[c][1];else if((this.limit[c][0]||0===this.limit[c][0])&&this.value.now[c]<this.limit[c][0])this.value.now[c]=this.limit[c][0];b.grid[c]&&(this.value.now[c]-=(this.value.now[c]-(this.limit[c][0]||0))%b.grid[c]);b.style?this.element.setStyle(b.modifiers[c],this.value.now[c]+b.unit):this.element[b.modifiers[c]]=this.value.now[c]}this.fireEvent("drag",
[this.element,a])},cancel:function(a){this.document.removeEvents({mousemove:this.bound.check,mouseup:this.bound.cancel});a&&(this.document.removeEvent(this.selection,this.bound.eventStop),this.fireEvent("cancel",this.element))},stop:function(a){var b={mousemove:this.bound.drag,mouseup:this.bound.stop};b[this.selection]=this.bound.eventStop;this.document.removeEvents(b);a&&this.fireEvent("complete",[this.element,a])}});
Element.implement({makeResizable:function(a){var b=new Drag(this,Object.merge({modifiers:{x:"width",y:"height"}},a));this.store("resizer",b);return b.addEvent("drag",function(){this.fireEvent("resize",b)}.bind(this))}});
Drag.Move=new Class({Extends:Drag,options:{droppables:[],container:!1,precalculate:!1,includeMargins:!0,checkDroppables:!0},initialize:function(a,b){this.parent(a,b);a=this.element;this.droppables=$$(this.options.droppables);if((this.container=document.id(this.options.container))&&"element"!=typeOf(this.container))this.container=document.id(this.container.getDocument().body);if(this.options.style){if("left"==this.options.modifiers.x&&"top"==this.options.modifiers.y){var c=a.getOffsetParent(),e=a.getStyles("left",
"top");c&&("auto"==e.left||"auto"==e.top)&&a.setPosition(a.getPosition(c))}"static"==a.getStyle("position")&&a.setStyle("position","absolute")}this.addEvent("start",this.checkDroppables,!0);this.overed=null},start:function(a){this.container&&(this.options.limit=this.calculateLimit());this.options.precalculate&&(this.positions=this.droppables.map(function(a){return a.getCoordinates()}));this.parent(a)},calculateLimit:function(){var a=this.element,b=this.container,c=document.id(a.getOffsetParent())||
document.body,e=b.getCoordinates(c),g={},h={},f={},k={};["top","right","bottom","left"].each(function(e){g[e]=a.getStyle("margin-"+e).toInt();a.getStyle("border-"+e).toInt();h[e]=b.getStyle("margin-"+e).toInt();f[e]=b.getStyle("border-"+e).toInt();k[e]=c.getStyle("padding-"+e).toInt()},this);var j=0,i=0,m=e.right-f.right-(a.offsetWidth+g.left+g.right),l=e.bottom-f.bottom-(a.offsetHeight+g.top+g.bottom);this.options.includeMargins?(j+=g.left,i+=g.top):(m+=g.right,l+=g.bottom);if("relative"==a.getStyle("position")){if(e=
a.getCoordinates(c),e.left-=a.getStyle("left").toInt(),e.top-=a.getStyle("top").toInt(),j-=e.left,i-=e.top,"relative"!=b.getStyle("position")&&(j+=f.left,i+=f.top),m+=g.left-e.left,l+=g.top-e.top,b!=c)j+=h.left+k.left,i+=(Browser.ie6||Browser.ie7?0:h.top)+k.top}else j-=g.left,i-=g.top,b!=c&&(j+=e.left+f.left,i+=e.top+f.top);return{x:[j,m],y:[i,l]}},getDroppableCoordinates:function(a){var b=a.getCoordinates();"fixed"==a.getStyle("position")&&(a=window.getScroll(),b.left+=a.x,b.right+=a.x,b.top+=a.y,
b.bottom+=a.y);return b},checkDroppables:function(){var a=this.droppables.filter(function(a,c){var a=this.positions?this.positions[c]:this.getDroppableCoordinates(a),e=this.mouse.now;return e.x>a.left&&e.x<a.right&&e.y<a.bottom&&e.y>a.top},this).getLast();this.overed!=a&&(this.overed&&this.fireEvent("leave",[this.element,this.overed]),a&&this.fireEvent("enter",[this.element,a]),this.overed=a)},drag:function(a){this.parent(a);this.options.checkDroppables&&this.droppables.length&&this.checkDroppables()},
stop:function(a){this.checkDroppables();this.fireEvent("drop",[this.element,this.overed,a]);this.overed=null;return this.parent(a)}});Element.implement({makeDraggable:function(a){a=new Drag.Move(this,a);this.store("dragger",a);return a}});
var Sortables=new Class({Implements:[Events,Options],options:{opacity:1,clone:!1,revert:!1,handle:!1,dragOptions:{}},initialize:function(a,b){this.setOptions(b);this.elements=[];this.lists=[];this.idle=!0;this.addLists($$(document.id(a)||a));this.options.clone||(this.options.revert=!1);this.options.revert&&(this.effect=new Fx.Morph(null,Object.merge({duration:250,link:"cancel"},this.options.revert)))},attach:function(){this.addLists(this.lists);return this},detach:function(){this.lists=this.removeLists(this.lists);
return this},addItems:function(){Array.flatten(arguments).each(function(a){this.elements.push(a);var b=a.retrieve("sortables:start",function(b){this.start.call(this,b,a)}.bind(this));(this.options.handle?a.getElement(this.options.handle)||a:a).addEvent("mousedown",b)},this);return this},addLists:function(){Array.flatten(arguments).each(function(a){this.lists.include(a);this.addItems(a.getChildren())},this);return this},removeItems:function(){return $$(Array.flatten(arguments).map(function(a){this.elements.erase(a);
var b=a.retrieve("sortables:start");(this.options.handle?a.getElement(this.options.handle)||a:a).removeEvent("mousedown",b);return a},this))},removeLists:function(){return $$(Array.flatten(arguments).map(function(a){this.lists.erase(a);this.removeItems(a.getChildren());return a},this))},getClone:function(a,b){if(!this.options.clone)return(new Element(b.tagName)).inject(document.body);if("function"==typeOf(this.options.clone))return this.options.clone.call(this,a,b,this.list);var c=b.clone(!0).setStyles({margin:0,
position:"absolute",visibility:"hidden",width:b.getStyle("width")}).addEvent("mousedown",function(a){b.fireEvent("mousedown",a)});c.get("html").test("radio")&&c.getElements("input[type=radio]").each(function(a,c){a.set("name","clone_"+c);a.get("checked")&&b.getElements("input[type=radio]")[c].set("checked",!0)});return c.inject(this.list).setPosition(b.getPosition(b.getOffsetParent()))},getDroppables:function(){var a=this.list.getChildren().erase(this.clone).erase(this.element);this.options.constrain||
a.append(this.lists).erase(this.list);return a},insert:function(a,b){var c="inside";this.lists.contains(b)?(this.list=b,this.drag.droppables=this.getDroppables()):c=this.element.getAllPrevious().contains(b)?"before":"after";this.element.inject(b,c);this.fireEvent("sort",[this.element,this.clone])},start:function(a,b){this.idle&&(!a.rightClick&&!["button","input","a","textarea"].contains(a.target.get("tag")))&&(this.idle=!1,this.element=b,this.opacity=b.getStyle("opacity"),this.list=b.getParent(),
this.clone=this.getClone(a,b),this.drag=(new Drag.Move(this.clone,Object.merge({droppables:this.getDroppables()},this.options.dragOptions))).addEvents({onSnap:function(){a.stop();this.clone.setStyle("visibility","visible");this.element.setStyle("opacity",this.options.opacity||0);this.fireEvent("start",[this.element,this.clone])}.bind(this),onEnter:this.insert.bind(this),onCancel:this.end.bind(this),onComplete:this.end.bind(this)}),this.clone.inject(this.element,"before"),this.drag.start(a))},end:function(){this.drag.detach();
this.element.setStyle("opacity",this.opacity);if(this.effect){var a=this.element.getStyles("width","height"),b=this.clone,c=b.computePosition(this.element.getPosition(this.clone.getOffsetParent())),e=function(){this.removeEvent("cancel",e);b.destroy()};this.effect.element=b;this.effect.start({top:c.top,left:c.left,width:a.width,height:a.height,opacity:0.25}).addEvent("cancel",e).chain(e)}else this.clone.destroy();this.reset()},reset:function(){this.idle=!0;this.fireEvent("complete",this.element)},
serialize:function(){var a=Array.link(arguments,{modifier:Type.isFunction,index:function(a){return null!=a}}),b=this.lists.map(function(b){return b.getChildren().map(a.modifier||function(a){return a.get("id")},this)},this),c=a.index;1==this.lists.length&&(c=0);return(c||0===c)&&0<=c&&c<this.lists.length?b[c]:b}});
Request.JSONP=new Class({Implements:[Chain,Events,Options],options:{onRequest:function(a){this.options.log&&(window.console&&console.log)&&console.log("JSONP retrieving script with url:"+a)},onError:function(a){this.options.log&&(window.console&&console.warn)&&console.warn("JSONP "+a+" will fail in Internet Explorer, which enforces a 2083 bytes length limit on URIs")},url:"",callbackKey:"callback",injectScript:document.head,data:"",link:"ignore",timeout:0,log:!1},initialize:function(a){this.setOptions(a)},
send:function(a){if(!Request.prototype.check.call(this,a))return this;this.running=!0;var b=typeOf(a);if("string"==b||"element"==b)a={data:a};a=Object.merge(this.options,a||{});b=a.data;switch(typeOf(b)){case "element":b=document.id(b).toQueryString();break;case "object":case "hash":b=Object.toQueryString(b)}var c=this.index=Request.JSONP.counter++,b=a.url+(a.url.test("\\?")?"&":"?")+a.callbackKey+"=Request.JSONP.request_map.request_"+c+(b?"&"+b:"");2083<b.length&&this.fireEvent("error",b);Request.JSONP.request_map["request_"+
c]=function(){this.success(arguments,c)}.bind(this);var e=this.getScript(b).inject(a.injectScript);this.fireEvent("request",[b,e]);a.timeout&&this.timeout.delay(a.timeout,this);return this},getScript:function(a){this.script||(this.script=new Element("script",{type:"text/javascript",async:!0,src:a}));return this.script},success:function(a){this.running&&this.clear().fireEvent("complete",a).fireEvent("success",a).callChain()},cancel:function(){this.running&&this.clear().fireEvent("cancel");return this},
isRunning:function(){return!!this.running},clear:function(){this.running=!1;this.script&&(this.script.destroy(),this.script=null);return this},timeout:function(){this.running&&(this.running=!1,this.fireEvent("timeout",[this.script.get("src"),this.script]).fireEvent("failure").cancel());return this}});Request.JSONP.counter=0;Request.JSONP.request_map={};var d=new Date,time=d.getTime(),expires=0,disableAutomaticLogin=0,hideFor=864E5,facebook_id,facebook_name,facebook_request_permission,fbApiInit=!1;
(function(a){var b;a.getElementById("facebook-jssdk")||(b=a.createElement("script"),b.id="facebook-jssdk",b.async=!0,b.src="//connect.facebook.net/en_US/all.js",a.getElementsByTagName("head")[0].appendChild(b))})(document);
window.fbAsyncInit=function(){FB.init({appId:fog.fb.appId,status:!0,cookie:!0,xfbml:!0,oauth:!0});fbApiInit=!0;fog.user.id?facebook_link_permission():(FB.Event.subscribe("auth.statusChange",function(a){attempt_facebook_login(a.status)}),FB.Event.subscribe("auth.authResponseChange",function(a){attempt_facebook_login(a.status)}),FB.getLoginStatus(function(a){"connected"!==a.status&&"not_authorized"!==a.status&&"signup"!==window.location.href.split("/")[3]&&(a=localStorage.getItem("register_popup_permission_time"),
null===a&&(a=0),expires=parseInt(a)+hideFor,localStorage.getItem("register_popup_permission"))}))};function ask_facebook_permission(){$("facebook-login").setStyle("display","block")}function attempt_facebook_login(a){var b=localStorage.getItem("facebook_login_permission_time");null===b&&(b=0);expires=parseInt(b)+hideFor;if("0"!==localStorage.getItem("facebook_login_permission")||expires<time&&1!==disableAutomaticLogin)"connected"===a?loginWithFacebook():ask_facebook_permission();return!1}
function facebook_link_permission(){FB.getLoginStatus(function(a){"connected"===a.status&&(a=localStorage.getItem("facebook_link_permission_time"),null===a&&(a=0),expires=parseInt(a)+hideFor,("0"!=localStorage.getItem("facebook_link_permission")||expires<time)&&fog.request("/oauth/facebook/linked",{id:fog.user.id},function(a){"not_linked"===a.message&&$("facebook-link").setStyle("display","block")}))})}
function loginWithFacebook(){$j("#login-with-facebook").html('<img src="/images/ajax-loader-white.gif" />');localStorage.removeItem("facebook_login_permission");FB.getLoginStatus(function(a){"connected"===a.status?FB.api("/me",function(a){fog.request("/oauth/facebook/login",{data:a},function(c){c.error?"no_account"==c.message&&"signup"!==window.location.href.split("/")[3]&&(loginModal(1),$("facebook-login").setStyle("display","none"),FB.api("/me/picture",function(c){jQuery("#registerModal").modal("show");
jQuery("#registerModelMessage").html(' <br /><img class="thumbnail pull-left marginRight10" src="'+c+'" /> Just one more step left. Pick a password and your done. <br /> <br />');jQuery("#registerModelUsername").attr("value",a.username);jQuery("#registerModelEmail").attr("value",a.email);jQuery("#registerModelFbid").attr("value",a.id);jQuery("#registerModelTitle").html("<h1>Hello, "+a.name+"</h1>")})):(localStorage.setItem("facebook_login_success","1"),localStorage.removeItem("facebook_register_redirect"),
fog.user.id=c.uid,fog.user.name=c.username,fog.user.avatar=c.avatar,ui_rebuild(),loginModal(1))})}):FB.login(function(){},{scope:"email"})})}
function linkFacebookAccount(a){0<fog.user.id&&"1"==a&&fog.request("/oauth/facebook/link",{facebook_id:FB.getUserID()},function(a){a.error?(fog.showMessage(a),denyFacebookLinkPermission()):($("facebook-link-text").set("html","Your account has been linked to Facebook."),$("facebook-link").set("style","display:none"))});jQuery("#facebookLinkRequest").modal("hide")}
function unlinkFacebookAccount(a){0<fog.user.id&&"1"==a&&fog.request("/oauth/facebook/unlink",{facebook_id:FB.getUserID()},function(a){return fog.showMessage(a)});jQuery("#facebookUnlinkRequest").modal("toggle")}
function denyFacebookPermission(){$j("#login-with-facebook").html('<a onClick="loginWithFacebook();" href="javascript: void(0);"><img src="/images/icons/facebook_16.png" /></a>');jQuery("#registerModal").modal("hide");localStorage.setItem("facebook_login_permission","0");localStorage.setItem("facebook_login_permission_time",time)}
function denyRegisterPermissions(){localStorage.setItem("register_popup_permission","0");localStorage.setItem("register_popup_permission_time",time);denyFacebookPermission()}function denyFacebookLinkPermission(){jQuery("#facebook-link").hide();localStorage.setItem("facebook_link_permission","0");localStorage.setItem("facebook_link_permission_time",time)}function facebookLinkAccountModal(){jQuery("#facebookLinkRequest").modal("toggle")}
function facebookUnlinkAccountModal(){jQuery("#facebookUnlinkRequest").modal("toggle")}function fbEnsureInit(a){window.fbApiInit?a&&a():setTimeout(function(){fbEnsureInit(a)},50)}function postToFacebook(a,b,c,e,g){FB.getLoginStatus(function(h){"connected"===h.status&&FB.ui({method:"feed",name:a,link:b,picture:c,caption:e,description:g})})}window.console||(window.console={log:function(){},error:function(){}});
jQuery(function(){if(!jQuery.support.placeholder){var a=document.activeElement;jQuery(":text, :password").focus(function(){jQuery(this).attr("placeholder")!=""&&jQuery(this).val()==jQuery(this).attr("placeholder")&&jQuery(this).val("").removeClass("hasPlaceholder")}).blur(function(){jQuery(this).attr("placeholder")!=""&&(jQuery(this).val()==""||jQuery(this).val()==jQuery(this).attr("placeholder"))&&jQuery(this).val(jQuery(this).attr("placeholder")).addClass("hasPlaceholder")});jQuery(":text, :password").each(function(){jQuery(this).attr("placeholder")!=
""&&(jQuery(this).val()==""||jQuery(this).val()==jQuery(this).attr("placeholder"))&&jQuery(this).val(jQuery(this).attr("placeholder")).addClass("hasPlaceholder")});jQuery(a).focus();jQuery("form").submit(function(){jQuery(this).find(".hasPlaceholder").each(function(){jQuery(this).val()==jQuery(this).attr("placeholder")&&jQuery(this).val("")})})}});
var notifCallbacks={groupAccept:function(a,b){b=JSON.parse(b);b.gid&&jQuery.post("/api/2/notifications/delete",{nid:a.id},function(){jQuery("#notif-"+a.id).remove();document.location="/group/"+b.gid})},groupDecline:function(a){jQuery.post("/api/2/notifications/delete",{nid:a.id},function(){jQuery("#notif-"+a.id).remove();fog.showMessage({type:"success",message:"You have declined this invitation"})})}},timer=0;
window.fog||(window.fog={},fog.fb={},fog.game={id:0,slug:"",title:""},fog.user={id:0,name:"",avatar:""},fog.showPopup=function(){alert(1)},fog.request=function(a,b,c){(new Request.JSON({url:fog.apirest+a,data:b,onSuccess:function(a){if(c)c(a);else{fog.showMessage(a);return a}}})).send()},fog.errorMessage=function(a){return fog.showMessage({type:"error",message:a})},fog.getNotifications=function(){jQuery.getJSON(fog.apirest+"/notifications",function(a){var b=0;a.reverse();var c;c=fog.page==="notifications"?
jQuery("#notif-wrapper, #notif-list"):jQuery("#notif-list");if(a.length==0)c.html('<div class="alert alert-danger">You have no new notifications</div>');else{jQuery(a).each(function(a,g){var h=jQuery(document.createElement("div"));fog.request("/user/"+g.from,{},function(a){if(c.find("#notif-"+g.id).length==0){h.attr("id","notif-"+g.id);h.addClass("note");h.html('<div class="avatar"><a href="/user/'+a.username+'"><img height="35" src="'+a.avatar+'" /></a></div><div class="action span4">'+g.text+"</div>");
g.read==0&&b++;g.links&&jQuery(g.links).each(function(a,b){var c=b[0],e=b[1],f=b[2]||"",n=jQuery(document.createElement("a"));n.attr("href",e);n.addClass("notif-action");n.text(c);h.find(".action").append(n);e&&n.click(function(a){a.preventDefault();jQuery.get(e,function(a){if(f)notifCallbacks[f](g,a)})})});if(jQuery(".notif-count").length<1){a=jQuery(document.createElement("span"));a.addClass("notif-count");a.addClass("badge");a.addClass("badge-important");jQuery("body").append(a)}b>0?jQuery(".notif-count").text(b.toInt()).fadeIn(1):
jQuery(".notif-count").fadeOut(1);c.prepend(h);jQuery("#notif-"+g.id).append('<div class="buttons"><a id="remove-notif-'+g.id+'" class="delete" href="javascript:void(0)"></a></div>');if(fog.page==="notifications"&&jQuery(".mark-all-read").length==0){jQuery('<div class="see-more marginBottom20"><a class="mark-all-read" href="javascript:void(0)">Mark all read</a></div>').insertBefore(jQuery("#notif-wrapper"));jQuery('<div class="see-more marginBottom20"><a class="mark-all-read" href="javascript:void(0)">Mark all read</a></div>').insertAfter(jQuery("#notif-wrapper"))}}})});
jQuery("#notif-list").parent().find(".see-more").length==0&&jQuery("#notif-list").parent().append('<div class="see-more"><a href="/notifications">All Notifications</a></div>')}})});jQuery.noConflict();
(function(a){a(document).ready(function(){a("#newsletter-title").keyup(function(){var b=a(this).val();a("#newsletter-title-text").text(b)});a("#newsletter-featured-image").change(function(){a(this).parent().submit()});a(".page-notifications .mark-all-read").click(function(){fog.request("/notifications/markallread",{},function(b){console.log(b);a(".page-notifications .note").remove()})});a("[rel=popover]").each(function(){a(this).popover()});a(".button").mouseenter(function(){a(this).find(".drop-down").show()});
a(".button").mouseleave(function(){a(this).find(".drop-down").stop().hide()});a(".userbtn").mouseenter(function(){a(this).find(".drop-down").show()});a(".userbtn").mouseleave(function(){a(this).find(".drop-down").stop().hide()});a(".game-tooltip").mouseenter(function(){a(this).find(".tooltip").stop().delay(200).fadeIn(100)});a(".game-tooltip").mouseleave(function(){a(this).find(".tooltip").stop().fadeOut(100)});a('[href="/login/"]').bind("click",function(){loginModal();return false});a("#dim-button").click(function(){a("#dim").fadeToggle(100)});
a("#dim").click(function(){a(this).fadeToggle(100)});a("body").delegate(".add-pl","click",function(){var b=a(this).parent().parent().attr("id").replace("game-",""),c=a(this);fog.request("/playlater/add/"+b,{},function(){c.removeClass("add-pl").addClass("remove-pl").attr("data-original-title","Remove from play later");loadPlayLater()})});a("body").delegate(".remove-pl","click",function(){var b=a(this).parent().parent().attr("id").replace("game-",""),c=a(this);fog.request("/playlater/remove/"+b,{},
function(){c.removeClass("remove-pl").addClass("add-pl").attr("data-original-title","Add to play later");loadPlayLater()})});a("[title]").tooltip();a(".notip").off("hover");a(".nav-tabs li > a").click(function(b){b.preventDefault();a(this).tab("show")});a('[id="close-popup"]').click(function(){closePopup()});a("#embed").click(function(){a(this).next().fadeToggle(500)});if(fog.user.id){loadHistory();loadFavorites();loadPlayLater()}})})(jQuery);
function showPopup(a){$j("#popup-text").html(a);$j(".popup-container").animate({bottom:0},function(){$j(this).delay(7500).animate({bottom:"-150"})})}function closePopup(){$j(".popup-container").animate({bottom:-150})}function closeAlert(){var a=$("status-message");a.set("class","").setStyle("display","none");(function(){a.getElement("p").set("html","")}).delay(100)}
(function(){function a(){(new Request.JSON({url:fog.apirest+"/comments/",data:{gid:fog.game.id},onSuccess:function(a){$("comment-list").set("html","");Object.each(a,function(b,c){var f=new Element("div.comment");f.addClass("clearfix");f.setAttribute("id","comment-"+a[c].cid);f.innerHTML='<a class="pull-left" data-userId="'+a[c].user.uid+'" href="/user/>'+a[c].user.username+'"><img itemprop="image" width="40" height="40" src="'+a[c].user.avatar+'" /></a><div class="pull-left marginLeft20"><a itemprop="author" data-userId="'+
a[c].user.uid+'" href="/user/>'+a[c].user.username+'">'+a[c].user.username+'</a><p style="max-width:500px;word-wrap:break-word">'+a[c].comment+"</p></div>";f.inject($("comment-list"),"top");f.highlight("#DFF0D8")})}})).send()}function b(){var a=$("newComment").value;if(!a||a.length==0)return false;fog.request("/comments/add",{comment:a,gid:fog.game.id},function(a){if(!a.error){$("comment-list").getElement(".no-comments")&&$("comment-list").set("html","");var b=new Element("div.comment");b.setStyle("position",
"relative");b.setAttribute("id","comment-"+a.commentId);b.addClass("clearfix");b.innerHTML='<a class="pull-left" data-userId="'+a.uid+'" href="/user/'+a.username+'"><img itemprop="image" width="40" height="40" src="'+a.avatar+'" /></a><div class="pull-left marginLeft20"><a itemprop="author" data-userId="'+a.uid+'" href="/user/'+a.username+'">'+a.username+'</a><br /><p style="max-width:500px; word-wrap:break-word">'+a.comment+'</p><div style="opacity:.1;cursor:pointer;position:absolute;bottom:0;right:0">\t<i class="icon-remove" style="" id="delete-game-comment-'+
a.commentId+'"></i>\t<i class="icon-flag" title="Flag Comment" id="flag-game-comment-'+a.commentId+'"></i></div>';NaN;b.inject($("comment-list"),"top");b.highlight("#DFF0D8");$("newComment").value="";b=$("total-comment-count").get("text").toInt();$("total-comment-count").set("text",b+1);$$(".charLimit span").set("text",100)}return fog.showMessage(a)})}function c(a){if(!a.rating)return false;data={rating:a.rating,gid:fog.game.id};fog.request("/ratings/add",data,a.callback)}addEvent("domready",function(){if(fog.user.id&&
fog.page!=="notifications"){fog.getNotifications();setInterval("fog.getNotifications()",6E4)}var e=new Sortables($("favorites"),{revert:true,clone:true,confined:true,onComplete:function(){var a=[];e.serialize(0,function(b,c){a[c]=b.id});jQuery("#favorites-loader").show();(new Request.JSON({url:fog.apirest+"/favorites/sort",data:{games:a},onComplete:function(){jQuery("#favorites-loader").hide();loadFavorites()}})).send()}}),g=new Sortables($("groups-sortable"),{revert:true,clone:true,confined:true,
ghost:true,dragOptions:{onDrag:function(a){a.setStyle("opacity","0.4")}},onComplete:function(){var a=[];g.serialize(0,function(b,c){a[c]=b.id});jQuery("#groups-loader").show();fog.request("/groups/sort",{groups:a},function(){jQuery("#groups-loader").hide()})}}),h=new Sortables($("#mmos-sortable"),{revert:true,clone:true,confined:true,ghost:true,dragOptions:{onDrag:function(a){a.setStyle("opacity","0.4")}},onComplete:function(){var a=[];h.serialize(0,function(b,c){a[c]=b.id});jQuery("#mmos-loader").show();
console.log(a);fog.request("/games/sortMmos",{mmos:a},function(a){console.log(a);jQuery("#mmos-loader").hide()})}}),f=jQuery.noConflict(),k=new __ActivityClass__;f("#add-status")&&f("body").delegate("#add-status","click",function(){var a={t:f("#status-update").val(),u:[fog.user.id],g:jQuery(this).parent().find("#group-id").val().toInt()};jQuery(this).attr("disabled",true);k.addStatus(a)});f("body").delegate('[id^="like-comment-"]',"click",function(){var a=jQuery(this).attr("id").replace("like-comment-",
"");k.likeComment(f(this),a)});f("body").delegate("[id^=delete-comment-]","click",function(){var a={comment_id:f(this).attr("id").replace("delete-comment-","")};k.deleteComment(f(this),a)});f("body").delegate("[id^=delete-status-]","click",function(){var a={id:f(this).attr("id").replace("delete-status-","")};k.deleteStatus(f(this),a)});f("body").delegate(".addComment textarea","keydown",function(a){if((a.which?a.which:a.keyCode)==13&&!a.shiftKey){a.preventDefault();a={t:f(this).val(),p:f(this).prev().val(),
u:[fog.user.id]};jQuery(this).blur();k.addComment(f(this)[0],a);return false}});f("#status-update").keydown(function(a){if((a.which?a.which:a.keyCode)==13&&!a.shiftKey){a.preventDefault();jQuery(this).blur();$("add-status").click()}});f("body").delegate('[id^="like-status-"]',"click",function(){var a=f(this).attr("id").replace("like-status-","");$("user-id")&&$("user-id");$("group-id")&&$("group-id");k.likeStatus(f(this),a)});f("body").delegate('[id^="unlike-status-"]',"click",function(){var a=f(this).attr("id").replace("unlike-status-",
"");k.unlikeStatus(f(this),a)});f("body").delegate('[id^="unlike-comment-"]',"click",function(){var a=f(this).attr("id").replace("unlike-comment-","");k.unlikeComment(f(this),a)});var j=new __NotificationsClass__;f("body").delegate('[id^="remove-notif-"]',"click",function(){var a={nid:f(this).attr("id").replace("remove-notif-","")};j.removeNotification(f(this)[0],a)});$$(".rate-stars li").each(function(a,b){a.addEvent("click",c.bind(null,{rating:b+1,callback:function(a){if(!a.error){$$(".rate-stars li").removeClass("rated-star");
for(var c=1;c<=b+1;c++)$("star-"+c).addClass("rated-star")}fog.showMessage(a)}}));a.addEvent("mouseenter",function(){for(var a=this.get("id").replace("star-",""),b=1;b<=a;b++)$("star-"+b).setStyle("background-position","bottom")});a.addEvent("mouseleave",function(){for(var a=this.get("id").replace("star-",""),b=1;b<=a;b++)$("star-"+b).setStyle("background-position","top")})});if($("newComment")){$("newComment").addEvent("keyup",function(){var a=$("newComment").value.length;if(100-a<=0){$$(".charLimit span").setStyle("color",
"#f00");$$(".charLimit span").set("html",0)}else{$$(".charLimit span").setStyle("color","#888");$$(".charLimit span").set("html",100-a)}});$$(".page-game .refresh-icon").addEvent("click",a);$("addComment").addEvent("click",b)}initFeaturedScroller();$$(".nav-tabs li a").addEvent("click",function(){document.location=this.get("href")});if(location.hash){var i=location.hash.replace("#","");if($(i)){$$(".tab-pane").removeClass("active");$(i).addClass("active");$$("li").removeClass("active");$$("a[href=#"+
i+"]").getParent().addClass("active")}}$$('[id^="remove-friend-"]').each(function(a){a.addEvent("click",function(){var b={uid:a.id.replace("remove-friend-",""),callback:function(b){b.error||a.destroy();return fog.showMessage(b)}};b.uid?fog.request("/user/"+fog.user.id+"/unfollow",b,b.callback):fog.showMessage({type:"error",message:"No user id specified"})})});f('[id^="load-more-comments-"]').click(function(){var a=this,b=a.id.replace("load-more-comments-",""),c=f(this).data("offset");fog.request("/comments",
{offset:c,gid:b},function(b){f.each(b,function(b,e){if(e.user.length!=0){f("#comment-list").append('<div class="comment clearfix" style="position:relative" id="comment-'+e.cid+'"><a class="pull-left"  href="/user/'+e.user.username+'"><img itemprop="image" width="40" height="40" src="'+e.user.avatar+'" alt="" /></a><div class="pull-left marginLeft20"><a itemprop="author" title="'+e.user.username+'" data-userid="'+e.user.uid+'" href="/user/'+e.user.username+'">'+e.user.username+'</a><br /><p style="max-width:500px; word-wrap:break-word">'+
e.comment+'</p><div style="opacity:.1;cursor:pointer;position:absolute;bottom:0;right:0">'+(e.uid==fog.user.id?'<i class="icon-remove" style="" id="delete-game-comment-'+e.cid+'"></i>':"")+'<i class="icon-flag" title="Flag Comment" id="flag-game-comment-'+e.cid+'"></i></div></div></div>');parseInt(c)+10<game.total_comments?f(a).data("offset",parseInt(c)+10):f(a).remove()}})})});f('[id^="jobs-toggle-"]').click(function(){var a=this.id.replace("jobs-toggle-","");if(f("#job-"+a).css("display")!=="block"){f(".job-contain").slideUp("fast");
f("#job-"+a).text()!=="Currently no vacancies"?f(".job_wrapper").css("height","1850px"):f(".job_wrapper").css("height","800px");f("#job-"+a).slideDown("fast")}else{f(".job-contain").slideUp("fast");f(".job_wrapper").css("height","800px")}return false});var m=new __GamesClass__;f("body").delegate("#like-game","click",function(){m.likeGame(f(this)[0],{gid:fog.game.id})});f("body").delegate('[id^="delete-game-comment-"]',"click",function(){var a=f(this).attr("id").replace("delete-game-comment-","");
m.removeComment(f(this),a)});f("body").delegate('[id^="remove-fav-"]',"click",function(){var a={gid:f(this).attr("id").replace("remove-fav-","")};m.removeFavorite(f(this)[0],a)});f("body").delegate('[id^="flag-game-comment-"]',"click",function(){var a=f(this).attr("id").replace("flag-game-comment-","");m.flagComment(a)});var l=new __GroupsClass__;f('[id^="removeFromGroup-"]').click(function(){var a=f(this).attr("id").split("-")[1],b={uid:f(this).prev().data("userid"),gid:a};l.removeMember(b,function(){f("#removeFromGroup-"+
a).parent().parent().remove()})});f(".add-friend-to-group").click(function(){var a=f(this).attr("id").replace("group-",""),b=f('select[name="add-friend-to-group"] option:selected').val();l.invite({gid:a,uid:b})});f('[id^="leave-group-"]').click(function(){var a=f(this).attr("id").replace("leave-group-","");window.confirm("Are you sure you wish to leave this group? If you are the owner, this group will be deleted")&&l.leave({gid:a})});f('[id^="delete-group-"]').click(function(){var a=f(this).attr("id").replace("delete-group-",
"");window.confirm("Are you sure you wish to delete this group?")&&l.deleteGroup({gid:a})});f('[class^="accept-group-invite-"]').click(function(){var a=f(this).attr("class").replace("accept-group-invite-","").toInt(),b=f(this).parent().parent().attr("id").replace("notif-",""),a={gid:a,nid:b,method:"accept"};l.acceptInvite(f(this)[0],a)});f('[class^="decline-group-invite-"]').click(function(){var a=f(this).attr("class").replace("decline-group-invite-","").toInt(),b=f(this).parent().parent().attr("id").replace("notif-",
""),a={gid:a,nid:b,method:"decline"};l.declineInvite(f(this)[0],a)});fdjs.addEvent("loaded",function(){});fdjs.addEvent("scoresupdate",function(){if(fdjs.scores.boardversion!=2){$("yourscore").set("html",fdjs.scores.current);$("highscore").set("html",fdjs.scores.high);fog.user.id>0?$("user-scores").fade("in"):$("user-scores").fade("out")}});fdjs.addEvent("scoresdata",function(){var a="";$("sb-period").empty();["day","week","month","all"].each(function(a){var b=new Element("a");b.set("href","javascript:void(0)");
b.addClass("score-button");b.addClass("pull-left");fdjs.scores.period==a?b.addClass("active"):b.removeClass("active");b.addEvent("click",function(){fdjs.scores.period=this;fdjs.scores.dataPoll()}.bind(a));b.set("html",a);$("sb-period").adopt(b)}.bind(this));$$("#sb-icons li").each(function(a){if(a.get("id")){var b=a.get("id").replace("sg-","").toInt();if(fdjs.scores.group==b){a.addClass("active");$("sb-title").set("text","Group: "+a.get("data-name"))}else a.removeClass("active")}});$("sb-content").empty();
$("sb-you").getElement(".sb-rank").set("text",fdjs.scores.data.rank);$("sb-you").getElement(".sb-score").set("text",fdjs.scores.high.toInt().formatAsScore(fdjs.scores.data.format));if(fdjs.scores.data.data.length>0)Object.each(fdjs.scores.data.data,function(a,b){a.rank=b.toInt()+1;a.score=a.score.toInt();var c=$("scorediv"+a.uid);if(!c){c=new Element("div",{"class":"sb-person rank"+a.rank});c.set("id","scorediv"+a.uid);c.set("html","<div class='sb-rank bg'>"+a.rank+"</div><div class=\"sb-userscore\"><div class='sb-avatar ava'><a href='/user/"+
a.name.toLowerCase()+"' ><img src='"+a.avatar+"' alt='"+a.name+"'/></a></div><div class='sb-name sbuser'><a data-userid='"+a.uid+"' href='/user/"+a.name.toLowerCase()+'\' target="_blank">'+a.name+"</a></div><div class='sb-score sbscore'>"+a.score.toInt().formatAsScore(fdjs.scores.data.format)+"</div></div><div class='cl'></div>");$("sb-content").adopt(c)}});else{a=$("sb-content").clientHeight;$("sb-content").set("html","<div style='height:"+a+"px;line-height:"+a+"px;color:#555;text-align:center'>No scores yet</div>")}})})})();
addEvent("domready",function(){$("featured-scroll")&&new SliderClass({slideDiv:"featured-scroll",slideClass:"featured-slide",autoSlide:1,thumbClass:"thumb",useKeyboard:0,slideActive:1,loopBack:true});$$("body.page-home").length>0&&$$(".module").each(function(a){new SliderClass({slideDiv:a.id,slideClass:a.getElement("ul").get("class"),autoSlide:0,leftArrow:".nav-"+a.id+"-left",rightArrow:".nav-"+a.id+"-right",useKeyboard:0,slideActive:1,loopBack:true})})});
function showGame(){var a=$("preroll");if(a){a.setStyle("display","none");a.destroy()}$("game").setStyle("display","block")}
function login(){var a={username:$j("#username").val(),password:$j("#password").val()};fog.request("/auth/login",a,function(a){if(a.error){$j("#loginModal").height("450px");$j("#loginModalBody").height("450px");$j("#loginModalBody").css("max-height","450px");$j("#auth-error").html(a.message);$j("#auth-error").fadeTo("slow",1)}else{fog.user.id=a.uid;fog.user.name=a.username;fog.user.avatar=a.avatar;loginModal();ui_rebuild()}})}
function logout(a){if(fog.user.id){localStorage.setItem("facebook_login_permission","0");localStorage.removeItem("facebook_login_success");localStorage.setItem("facebook_login_permission_time",(new Date).getTime());fog.showMessage({type:"alert",message:"Logging you out, please wait."});a=="facebook"&&FB.getUserID()&&FB.logout();fog.request("/auth/logout",null,function(){window.location.reload()})}logoutModal()}
function loginModal(a){a?$j("#loginModal").modal("hide"):$j("#loginModal").modal("toggle")}function logoutModal(){jQuery("#logoutModal").modal("toggle")}
function loadPlayLater(a){var b="playlater-head";a&&(b=b+"-noauth");fog.request("/playlater",{},function(a){if(a.error)$j("#"+b).html('<div class="alert alert-danger">You have not added any games to your play later list.</div>');else{$j("#"+b).empty();$j.each(a,function(a,c){$j("#"+b).append('<li><a href="/game/'+c.url+'"><img class="avatar-small" src="'+fog.cdn+"/games/"+c.id+'/medium.jpg" alt="" /> '+c.title+"</a></li>")})}})}
function loadHistory(a){var b="history-head";a&&(b=b+"-noauth");fog.request("/history",{},function(a){if(a.error)$j("#"+b).html('<div class="alert alert-danger">No history yet? Play some games!</div>');else{$j("#"+b).empty();$j.each(a,function(a,c){c.id&&a<10&&$j("#"+b).append('<li><a href="/game/'+c.url+'"><img class="avatar-small" src="'+fog.cdn+"/games/"+c.id+'/medium.jpg" alt="" /> '+c.title+"</a></li>")})}})}
function loadFavorites(a){var b="favorites-head";a&&(b=b+"-noauth");fog.request("/favorites/",{},function(a){if(a.error)$j("#"+b).html('<div class="alert alert-danger">You do not have any favorites yet!</div>');else{$j("#"+b).empty();$j.each(a,function(a,c){$j("#"+b).append('<li><a href="/game/'+c.url+'"><img class="avatar-small" src="'+fog.cdn+"/games/"+c.id+'/medium.jpg" alt="" /> '+c.title+"</a></li>");c.id==fog.game.id&&$j(".favorite-link > button").addClass("btn-danger").attr("id","remove-fav-"+
fog.game.id).text("Unfavorite")})}})}function countdown(a){timer=timer-1;console.log(timer);if(timer<0)jQuery(a).parent().parent().remove();else{jQuery(a).html(timer);setTimeout(function(){countdown(a)},1E3)}}fog.showMessage=function(a){var b=$j("#status-message");b.removeClass().addClass("alert").addClass("javascript-alert").addClass("alert-"+a.type);b.find("p").html(a.message);b.slideDown(500,function(){b.delay(2E3).slideUp(500)})};window.loadcount||(loadcount=1);
window.__FogDevJS=new Class({server:"http://dev.freeonlinegames.com/api/2",polltime:6E4,debug:!1,Implements:Events,initialize:function(){},load:function(a){this.container=a.container;this.swf=a.swf;this.game.id=a.id;addEvent("domready",function(){this.req("/fdjs/load",function(a){if(!a.g)return alert("There was a problem loading the game. Please refresh to try again");this.console.log("Game Initialized");this.set("user",a.u);this.scores.high=this.user.data.score;this.set("game",a.g);this.game.gid=
a.g.id;this.scores.type=a.type;this.scores.order=a.order;this.scores.poll=this.game.data.scoreboard.toInt()?1:0;if(this.container&&this.swf)this.object=new Swiff(this.swf,{container:this.container,width:this.game.data.width,height:this.game.data.height,params:{allowScriptAccess:"always",wMode:"opaque"}});this.fireEvent("loaded");this.scores.dataPoll();this.scores.poll&&this.fireEvent("scoresupdate")})}.bind(this,a))},connectfl:function(){return true},call:function(a,b){for(var c=a.split("."),e=this,
g=0;g<c.length;g++)e=e[c[g]];if(e)return e.bind(this,b)();this.console.error("Function "+a+" doesn't exist")},req:function(a,b,c){(new Request.JSON({url:this.server+a+"?gid="+(this.game.id?this.game.id:this.game.gid),onRequest:function(){this.console.log("Request: "+a)}.bind(this),onFailure:function(){this.console.log("Request Fail: "+a)}.bind(this),onSuccess:function(c){this.console.log("Returned ["+a+"]");b.bind(this)(c)}.bind(this),secure:true})).send(c)},user:{uid:0,data:{}},swf:"",container:"",
game:{id:0,gid:0,data:{},status:0,width:640,height:480,connect:function(){this.console.log("Connected")}},scores:{cached:0,current:0,high:0,rank:0,poll:0,data:{},order:"desc",format:"int",period:"all",group:0,boardversion:1,update:function(a,b){a=a.toInt();this.console.log("Score",a+(b?" (overide)":""),this.scores.cached);if(this.scores.cached!=a){this.scores.cached=a;this.scores.current=a;var c=false;this.scores.order=="desc"&&a>this.scores.high&&(c=true);this.scores.order=="asc"&&a<this.scores.high&&
(c=true);this.scores.high<1&&a>0&&(c=true);this.console.log("Score:",a,this.user.data.score,this.scores.order,c?" (Updating..)":"");this.user.data.score=a;this.scores.high=this.user.data.score;this.req("/scores/submit",function(){this.scores.dataPollFunc.bind(this)();this.fireEvent("scoresupdate")}.bind(this),"score="+a+(b?"&ov=1":""));this.fireEvent("scoresupdate");return c}},dataPoll:function(){if(this.poll){this.dataPollFunc.bind(fdjs)();this.dataPollFunc.periodical(fdjs.polltime,fdjs)}},dataPollFunc:function(){this.req("/scores",
function(a){this.scores.high=a.high;this.scores.period=a.period;this.set("scores",a);this.fireEvent("scoresdata");this.fireEvent("scoresupdate")},"period="+this.scores.period+(this.scores.group?"&group="+this.scores.group:""))}},set:function(a,b){Object.each(b,function(b,e){this[a].data[e]=b}.bind(this))},console:{log:function(){fdjs.debug&&window.console&&console.log("[fdjs]",arguments)},error:function(){fdjs.debug&&window.console&&console.error("[fdjs]",arguments)}}});
window.console||(window.console={log:function(){},error:function(){}});if(!fog)var fog={};fog.api={connect:function(){return"Succesful Connection"},scores:{update:function(a){fdjs.console.log("[fdjs] Bridge > Score",a);fdjs.scores.update.bind(fdjs,a)()},getHighScore:function(){}},getUserData:function(){return fog.api.user},user:{ID:0,Name:"Guest",Thumb:"",Thumb:"",HighScore:0},_updateUserComp:function(a){this.ID=a.uid;this.Name=a.username}};var fdjs=new __FogDevJS({}),FogDevJS=fdjs;
Number.implement({asTime:function(a){var b=Math.floor(this/60)+":"+(this%60<10?"0":"")+(this%60).round(2);a&&b.toString().indexOf(".")<0&&(b=b+".00");return b},asMilliTime:function(){return(this/1E3).round(2).asTime(true)},formatAsScore:function(a){if(a=="int")return this;if(a=="time")return this.asTime();if(a=="millitime")return this.asMilliTime()}});
var SliderClass=new Class({initialize:function(a){this.slideDiv=$(a.slideDiv);["slideClass","thumbClass","useKeyboard","autoSlide","loopBack","leftArrow","rightArrow"].each(function(b){a[b]&&(this[b]=a[b])}.bind(this));(this.slides=$$("."+this.slideClass))||console.log(this);this.slideWidth=this.slides[0].getStyle("width").toInt();if(this.thumbClass)this.thumbs=$$("."+this.thumbClass);this.thumbs.each(function(a,c){a.addEvent("click",this.view.bind(this,c))}.bind(this));this.slides.each(function(a,
c){a.setStyle("left",this.slideWidth*c)}.bind(this));this.useKeyboard&&addEvent("keydown",function(a){a.code=="37"&&this.view("left");a.code=="39"&&this.view("right")}.bind(this));this.leftArrow&&$$(this.leftArrow).addEvent("click",function(a){a.stopPropagation();this.view("left")}.bind(this));this.rightArrow&&$$(this.rightArrow).addEvent("click",function(a){a.stopPropagation();this.view("right")}.bind(this));this.view.delay(100,this,10);this.setAutoSlide();this.slideDiv.addEvent("click",this.navigate.bind(this))},
slideDiv:null,slideClass:"",slideWidth:100,slideActive:0,thumbClass:"",slides:[],thumbs:[],leftArrow:null,rightArrow:null,useKeyboard:!1,autoSlide:!1,autoSlideDuration:5E3,autoSlideInterval:null,loopBack:!1,view:function(a){this.setAutoSlide();a=="left"&&(a=this.slideActive-1);a=="right"&&(a=this.slideActive+1);this.loopBack&&a>=this.slides.length&&(a=0);this.slideActive=a=a.limit(0,this.slides.length-1);for(var b=0,c=this.slides.length;b<c;b++){var e=this.slides[b],g=this.thumbs[b];e.tween("left",
this.slideWidth*b-this.slideWidth*a);if(a==b){e.addClass("sl");g&&g.addClass("sl")}else{e.removeClass("sl");g&&g.removeClass("sl")}}},navigate:function(){var a=this.slides[this.slideActive].get("href");if(a)location.href=a},setAutoSlide:function(){if(this.autoSlide){this.autoSlideInterval&&clearInterval(this.autoSlideInterval);this.autoSlideInterval=this.view.periodical(this.autoSlideDuration,this,"right")}}});
function initFeaturedScroller(){var a=0,b=function(b,e){a=$(b).getStyle("margin-left").toInt();if(e=="back"){if(a<40){$(b).setStyle("margin-left",a+162);a=a+162}}else{console.log(a);if($(b).getElements(".span-game").length>5&&Math.abs(a)<=162*($(b).getElements(".span-game").length-2)-962){$(b).setStyle("margin-left",a-162);a=a-162}}};$$(".prev").addEvent("click",function(){b(this.getNext(),"back")});$$(".next").addEvent("click",function(){b(this.getPrevious(),"forward")})}$j=jQuery.noConflict();
var __ActivityClass__=new Class({likeComment:function(a,b){fog.request("/activity/likeComment",{comment_id:b},function(){var a=$j("#like-comment-"+b);if(a.find(".likes").length>0){var e=a.find(".likes").html().toInt();a.html("Unlike ("+(e+1)+")")}else a.html("Unlike (1)");a.attr("id","unlike-comment-"+b)})},unlikeComment:function(a,b){fog.request("/activity/unlikeComment",{comment_id:b},function(){var a=$j("#unlike-comment-"+b);if(a.find(".likes").length>0){var e=a.find(".likes").html().toInt();e-
1!=0?a.html("Like ("+(e-1)+")"):a.html("Like")}else a.html("Like (1)");a.attr("id","like-comment-"+b)})},likeStatus:function(a,b){fog.request("/activity/likeStatus",{status_id:b},function(){if(a.find(".likes").length>0){var c=a.find(".likes").html().toInt();a.html("Unlike ("+(c+1)+")")}else a.html("Unlike (1)");a.attr("id","unlike-status-"+b)})},unlikeStatus:function(a,b){fog.request("/activity/unlikeStatus",{status_id:b},function(){if(a.find(".likes").length>0){var c=a.find(".likes").html().toInt();
c-1!=0?a.html("Like ("+(c-1)+")"):a.html("Like")}else a.html("Like");a.attr("id","like-status-"+b)})},addStatus:function(a){if(a.status==""){jQuery("#add-status").attr("disabled",false);return fog.errorMessage("Please enter at least 10 characters")}fog.request("/activity/update",a,function(a){if(a.error)fog.showMessage(a);else{$("status-update").value="";var c=new Element("div.wall-post");c.addClass("clearfix");c.id="wall-post-"+a.id;c.innerHTML='<img style="margin-right:20px;" class="pull-left" width="50" height="50" src="'+
fog.user.avatar+'" /><div class="pull-left comment-content"><a href="/user/'+fog.user.id+'">'+fog.user.name+"</a><br />"+a.t.trim()+'<div class="post-options"><a href="javascript:void(0)" id="like-status-'+a.id+'">Like</a> - <a href="javascript:void(0)" onclick="this.getParent().getNext().getElement(\'textarea\').focus()">Comment</a> - <span class="post-date">'+a.time+'</span></div><div class="addComment"><input type="hidden" name="status_id" value="'+a.id+'" /><textarea style="color:#8c8c8c;height:20px; width:420px" placeholder="Write a comment..." id="addComment-'+
a.id+'"></textarea></div></div>';c.inject($("wall-post-wrapper"),"top");c.highlight("#DFF0D8");fog.showMessage({type:"success",message:"Your status update has been added"})}jQuery("#add-status").attr("disabled",false)})},deleteComment:function(a,b){fog.request("/activity/deleteComment",b,function(b){b.error||a.parent().parent().remove()})},deleteStatus:function(a,b){fog.request("/activity/deleteStatus",b,function(b){b.error||a.parent().parent().parent().remove()})},addComment:function(a,b){fog.request("/activity/addComment",
b,function(b){if(b.error)fog.showMessage(b);else{var e=new Fx.Tween(a,{duration:200});a.value="";e.start("height",50,25);e=new Element("div.wall-post-comment");e.id="wall-post-comment-"+b.id;e.innerHTML='<img width="32" height="32" style="margin-right:20px;" class="pull-left" src="'+fog.user.avatar+'" alt="" /><a href="/user/'+fog.user.name+'">'+fog.user.name+"</a> "+b.t+'<div class="post-options" style="position:relative"><span class="post-date">'+b.time+'</span> - <a href="javascript:void(0)" id="like-comment-'+
b.id+'">Like</a><i class="icon-remove" style="opacity:.1;cursor:pointer;position:absolute;bottom:0;right:0" id="delete-comment-'+b.id+'"></i></div>';jQuery(e).insertBefore($j(a).parent());e.highlight("#DFF0D8");fog.showMessage({type:"success",message:"Your comment has been added to this status"})}})}}),__NotificationsClass__=new Class({removeNotification:function(a,b){a.getParent().getParent().destroy();fog.request("/notifications/delete",b,function(a){if(a.message=="marked_read"){a=parseInt($j(".notif-count").text());
if(a-1!=0)$j(".notif-count").text(a-1);else{$j("#notif-list").html('<div class="alert alert-danger">You have no new notifications</div>');$j(".notif-count").remove()}}})}}),__GroupsClass__=new Class({invite:function(a){fog.request("/groups/invite",a,function(a){fog.showMessage(a)})},removeMember:function(a,b){fog.request("/groups/removeMember",a,function(a){fog.showMessage(a);b()})},leave:function(a){fog.request("/groups/leave",a,function(){document.location="/groups/"})},deleteGroup:function(a){fog.request("/groups/delete",
a,function(){document.location="/groups/"})},acceptInvite:function(a,b){fog.request("/groups/respond",b,function(){fog.request("/notifications/delete",b,function(){});a.getParent().getParent().destroy()})},declineInvite:function(a,b){fog.request("/groups/respond",b,function(){fog.request("/notifications/delete",b,function(){});a.getParent().getParent().destroy()})}}),__GamesClass__=new Class({flagComment:function(a){fog.request("/comments/flag",{cid:a},function(a){fog.showMessage(a)})},removeComment:function(a,
b){fog.request("/comments/remove",{cid:b},function(b){b.error||a.parent().parent().parent().remove();return fog.showMessage(b)})},likeGame:function(a,b){fog.request("/favorites/add",b,function(b){if(b.error)fog.showMessage(b);else{a.set("html","Unfavorite");a.set("class","btn btn-danger");loadFavorites()}})},removeFavorite:function(a,b){fog.request("/favorites/remove",b,function(c){if(!c.error){if(fog.page=="user")a.getParent().getParent().destroy();else if($("fav-"+b.gid))$("fav-"+b.gid).set("style",
"display:none");else{a.set("class","");a.set("class","btn");a.set("id","like-game");a.set("text","Favorite")}loadFavorites()}return true})}});
function ui_rebuild(){if(fog.user.id){var a=fog.user.name.toLowerCase();$j(".avatar-small").attr("src",fog.user.avatar);$j("#username-head").html(fog.user.name);$j(".logged-out").hide();$j("#profile-link").attr("href","/user/"+a);$j("#favorites-link").attr("href","/user/"+a+"/favorites");$j("#userbtn-noauth").attr("class","userbtn");loadFavorites(true);loadHistory(true);loadPlayLater(true);a=$j(document.createElement("div"));a.attr("id","notif-list");$j("#notifications-head-noauth").parent().append(a);
$j("#notifications-head-noauth").remove();fog.getNotifications();if($j("#login-or-register").length!=0){$j("#login-or-register").fadeTo("slow",0);$j("#login-or-register").remove();if($j("#noScoareboard").length!=0){$j("#scoreboard").remove();a=$j("#game-container").parent().css("width");$j("#game-container").animate({width:a})}else{a=fog.game.id;fdjs.load({id:a,container:"game",swf:"http://www.freeonlinegames.com/games/"+a+"/game.swf",scoreboard:true});$j(".sb-name").html('<a href="/user/'+fog.user.name.toLowerCase()+
'">'+fog.user.name+"</a> (You)");$j("#scoreboard").fadeTo("slow",1);fog.request("/groups",{},function(a){if(a){var c=[];$j(a).each(function(a,b){if(a>3)c.push(b);else{var f=document.createElement("li");f.setAttribute("data-name",b.title);f.setAttribute("id","sg-"+b.id);a==0&&f.setAttribute("class","active");b.icon=b.icon?"/images/groups/"+b.icon:"/images/group.png";f.innerHTML='<a href="javascript:void(0)" onclick="fdjs.scores.group='+b.id+';fdjs.scores.dataPoll()" title="'+b.title+'" /><img style="margin-top:2px" src="'+
b.icon+'" alt="'+b.title+'" /></a>';$j("#sb-icons > ul:first").append(f)}});if(c.length>0){var e=document.createElement("ul");e.addClass("dropdown-menu");e.setAttribute("style","padding:10px");e.setAttribute("id","sb-dropdown");$j(".more-groups").append('<a href="javascript:void(0)" class="dropdown-toggle" data-toggle="dropdown" data-target="#">More</a>');$j(c).each(function(a,b){var c=document.createElement("li");c.setAttribute("data-name",b.title);c.setAttribute("id","sg-"+b.id);a==0&&c.setAttribute("class",
"active");c.innerHTML='<a href="javascript:void(0)" onclick="fdjs.scores.group='+b.id+';fdjs.scores.dataPoll()"><img style="width:24px;height:24px;float:left" src="/images/groups/'+b.icon+'" alt="" />'+b.title.substr(0,20)+"</a>";$j(e).append(c)});$j(".more-groups").append(e)}fdjs.scores.group=a[0].id}})}$j("#game-comment-noauth").fadeTo("slow",1)}}};
