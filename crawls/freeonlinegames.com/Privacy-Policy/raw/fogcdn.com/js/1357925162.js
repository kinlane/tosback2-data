if(typeof(console)==='undefined'){var console={log:function(data){},error:function(data){}}}
(function(){"use strict";String.prototype.ucfirst=function(){return this.charAt(0).toUpperCase()+ this.slice(1);};String.prototype.nl2br=function(xhtml){return(this.toString()).replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,'$1'+(xhtml===undefined?'<br>':'<br />')+'$2');};Number.prototype.toDeg=function(){return this*(180/Math.PI);}
Number.prototype.toRad=function(){return this*(Math.PI/180);}}());!function($){$(function(){$.support.transition=(function(){var transitionEnd=(function(){var el=document.createElement("bootstrap"),transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},name;for(name in transEndEventNames){if(el.style[name]!==undefined){return transEndEventNames[name]}}}());return transitionEnd&&{end:transitionEnd}})()})}(window.jQuery);!function($){var Modal=function(element,options){this.options=options;this.$element=$(element).delegate('[data-dismiss="modal"]',"click.dismiss.modal",$.proxy(this.hide,this));this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};Modal.prototype={constructor:Modal,toggle:function(){return this[!this.isShown?"show":"hide"]()},show:function(){var that=this,e=$.Event("show");this.$element.trigger(e);if(this.isShown||e.isDefaultPrevented()){return}this.isShown=true;this.escape();this.backdrop(function(){var transition=$.support.transition&&that.$element.hasClass("fade");if(!that.$element.parent().length){that.$element.appendTo(document.body)}that.$element.show();if(transition){that.$element[0].offsetWidth}that.$element.addClass("in").attr("aria-hidden",false);that.enforceFocus();transition?that.$element.one($.support.transition.end,function(){that.$element.focus().trigger("shown")}):that.$element.focus().trigger("shown")})},hide:function(e){e&&e.preventDefault();var that=this;e=$.Event("hide");this.$element.trigger(e);if(!this.isShown||e.isDefaultPrevented()){return}this.isShown=false;this.escape();$(document).off("focusin.modal");this.$element.removeClass("in").attr("aria-hidden",true);$.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()},enforceFocus:function(){var that=this;$(document).on("focusin.modal",function(e){if(that.$element[0]!==e.target&&!that.$element.has(e.target).length){that.$element.focus()}})},escape:function(){var that=this;if(this.isShown&&this.options.keyboard){this.$element.on("keyup.dismiss.modal",function(e){e.which==27&&that.hide()})}else{if(!this.isShown){this.$element.off("keyup.dismiss.modal")}}},hideWithTransition:function(){var that=this,timeout=setTimeout(function(){that.$element.off($.support.transition.end);that.hideModal()},500);this.$element.one($.support.transition.end,function(){clearTimeout(timeout);that.hideModal()})},hideModal:function(that){this.$element.hide().trigger("hidden");this.backdrop()},removeBackdrop:function(){this.$backdrop.remove();this.$backdrop=null},backdrop:function(callback){var that=this,animate=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var doAnimate=$.support.transition&&animate;this.$backdrop=$('<div class="modal-backdrop '+animate+'" />').appendTo(document.body);this.$backdrop.click(this.options.backdrop=="static"?$.proxy(this.$element[0].focus,this.$element[0]):$.proxy(this.hide,this));if(doAnimate){this.$backdrop[0].offsetWidth}this.$backdrop.addClass("in");doAnimate?this.$backdrop.one($.support.transition.end,callback):callback()}else{if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");$.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one($.support.transition.end,$.proxy(this.removeBackdrop,this)):this.removeBackdrop()}else{if(callback){callback()}}}}};$.fn.modal=function(option){return this.each(function(){var $this=$(this),data=$this.data("modal"),options=$.extend({},$.fn.modal.defaults,$this.data(),typeof option=="object"&&option);if(!data){$this.data("modal",(data=new Modal(this,options)))}if(typeof option=="string"){data[option]()}else{if(options.show){data.show()}}})};$.fn.modal.defaults={backdrop:true,keyboard:true,show:true};$.fn.modal.Constructor=Modal;$(document).on("click.modal.data-api",'[data-toggle="modal"]',function(e){var $this=$(this),href=$this.attr("href"),$target=$($this.attr("data-target")||(href&&href.replace(/.*(?=#[^\s]+$)/,""))),option=$target.data("modal")?"toggle":$.extend({remote:!/#/.test(href)&&href},$target.data(),$this.data());e.preventDefault();$target.modal(option).one("hide",function(){$this.focus()})})}(window.jQuery);!function($){var toggle="[data-toggle=dropdown]",Dropdown=function(element){var $el=$(element).on("click.dropdown.data-api",this.toggle);$("html").on("click.dropdown.data-api",function(){$el.parent().removeClass("open")})};Dropdown.prototype={constructor:Dropdown,toggle:function(e){var $this=$(this),$parent,isActive;if($this.is(".disabled, :disabled")){return}$parent=getParent($this);isActive=$parent.hasClass("open");clearMenus();if(!isActive){$parent.toggleClass("open");$this.focus()}return false},keydown:function(e){var $this,$items,$active,$parent,isActive,index;if(!/(38|40|27)/.test(e.keyCode)){return}$this=$(this);e.preventDefault();e.stopPropagation();if($this.is(".disabled, :disabled")){return}$parent=getParent($this);isActive=$parent.hasClass("open");if(!isActive||(isActive&&e.keyCode==27)){return $this.click()}$items=$("[role=menu] li:not(.divider) a",$parent);if(!$items.length){return}index=$items.index($items.filter(":focus"));if(e.keyCode==38&&index>0){index--}if(e.keyCode==40&&index<$items.length-1){index++}if(!~index){index=0}$items.eq(index).focus()}};function clearMenus(){$(toggle).each(function(){getParent($(this)).removeClass("open")})}function getParent($this){var selector=$this.attr("data-target"),$parent;if(!selector){selector=$this.attr("href");selector=selector&&/#/.test(selector)&&selector.replace(/.*(?=#[^\s]*$)/,"")}$parent=$(selector);$parent.length||($parent=$this.parent());return $parent}$.fn.dropdown=function(option){return this.each(function(){var $this=$(this),data=$this.data("dropdown");if(!data){$this.data("dropdown",(data=new Dropdown(this)))}if(typeof option=="string"){data[option].call($this)}})};$.fn.dropdown.Constructor=Dropdown;$(document).on("click.dropdown.data-api touchstart.dropdown.data-api",clearMenus).on("click.dropdown touchstart.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.dropdown.data-api touchstart.dropdown.data-api",toggle,Dropdown.prototype.toggle).on("keydown.dropdown.data-api touchstart.dropdown.data-api",toggle+", [role=menu]",Dropdown.prototype.keydown)}(window.jQuery);!function($){function ScrollSpy(element,options){var process=$.proxy(this.process,this),$element=$(element).is("body")?$(window):$(element),href;this.options=$.extend({},$.fn.scrollspy.defaults,options);this.$scrollElement=$element.on("scroll.scroll-spy.data-api",process);this.selector=(this.options.target||((href=$(element).attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,""))||"")+" .nav li > a";this.$body=$("body");this.refresh();this.process()}ScrollSpy.prototype={constructor:ScrollSpy,refresh:function(){var self=this,$targets;this.offsets=$([]);this.targets=$([]);$targets=this.$body.find(this.selector).map(function(){var $el=$(this),href=$el.data("target")||$el.attr("href"),$href=/^#\w/.test(href)&&$(href);return($href&&$href.length&&[[$href.position().top,href]])||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){self.offsets.push(this[0]);self.targets.push(this[1])})},process:function(){var scrollTop=this.$scrollElement.scrollTop()+this.options.offset,scrollHeight=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,maxScroll=scrollHeight-this.$scrollElement.height(),offsets=this.offsets,targets=this.targets,activeTarget=this.activeTarget,i;if(scrollTop>=maxScroll){return activeTarget!=(i=targets.last()[0])&&this.activate(i)}for(i=offsets.length;i--;){activeTarget!=targets[i]&&scrollTop>=offsets[i]&&(!offsets[i+1]||scrollTop<=offsets[i+1])&&this.activate(targets[i])}},activate:function(target){var active,selector;this.activeTarget=target;$(this.selector).parent(".active").removeClass("active");selector=this.selector+'[data-target="'+target+'"],'+this.selector+'[href="'+target+'"]';active=$(selector).parent("li").addClass("active");if(active.parent(".dropdown-menu").length){active=active.closest("li.dropdown").addClass("active")}active.trigger("activate")}};$.fn.scrollspy=function(option){return this.each(function(){var $this=$(this),data=$this.data("scrollspy"),options=typeof option=="object"&&option;if(!data){$this.data("scrollspy",(data=new ScrollSpy(this,options)))}if(typeof option=="string"){data[option]()}})};$.fn.scrollspy.Constructor=ScrollSpy;$.fn.scrollspy.defaults={offset:10};$(window).on("load",function(){$('[data-spy="scroll"]').each(function(){var $spy=$(this);$spy.scrollspy($spy.data())})})}(window.jQuery);!function($){var Tab=function(element){this.element=$(element)};Tab.prototype={constructor:Tab,show:function(){var $this=this.element,$ul=$this.closest("ul:not(.dropdown-menu)"),selector=$this.attr("data-target"),previous,$target,e;if(!selector){selector=$this.attr("href");selector=selector&&selector.replace(/.*(?=#[^\s]*$)/,"")}if($this.parent("li").hasClass("active")){return}previous=$ul.find(".active:last a")[0];e=$.Event("show",{relatedTarget:previous});$this.trigger(e);if(e.isDefaultPrevented()){return}$target=$(selector);this.activate($this.parent("li"),$ul);this.activate($target,$target.parent(),function(){$this.trigger({type:"shown",relatedTarget:previous})})},activate:function(element,container,callback){var $active=container.find("> .active"),transition=callback&&$.support.transition&&$active.hasClass("fade");function next(){$active.removeClass("active").find("> .dropdown-menu > .active").removeClass("active");element.addClass("active");if(transition){element[0].offsetWidth;element.addClass("in")}else{element.removeClass("fade")}if(element.parent(".dropdown-menu")){element.closest("li.dropdown").addClass("active")}callback&&callback()}transition?$active.one($.support.transition.end,next):next();$active.removeClass("in")}};$.fn.tab=function(option){return this.each(function(){var $this=$(this),data=$this.data("tab");if(!data){$this.data("tab",(data=new Tab(this)))}if(typeof option=="string"){data[option]()}})};$.fn.tab.Constructor=Tab;$(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(e){e.preventDefault();$(this).tab("show")})}(window.jQuery);!function($){var Tooltip=function(element,options){this.init("tooltip",element,options)};Tooltip.prototype={constructor:Tooltip,init:function(type,element,options){var eventIn,eventOut;this.type=type;this.$element=$(element);this.options=this.getOptions(options);this.enabled=true;if(this.options.trigger=="click"){this.$element.on("click."+this.type,this.options.selector,$.proxy(this.toggle,this))}else{if(this.options.trigger!="manual"){eventIn=this.options.trigger=="hover"?"mouseenter":"focus";eventOut=this.options.trigger=="hover"?"mouseleave":"blur";this.$element.on(eventIn+"."+this.type,this.options.selector,$.proxy(this.enter,this));this.$element.on(eventOut+"."+this.type,this.options.selector,$.proxy(this.leave,this))}}this.options.selector?(this._options=$.extend({},this.options,{trigger:"manual",selector:""})):this.fixTitle()},getOptions:function(options){options=$.extend({},$.fn[this.type].defaults,options,this.$element.data());if(options.delay&&typeof options.delay=="number"){options.delay={show:options.delay,hide:options.delay}}return options},enter:function(e){var self=$(e.currentTarget)[this.type](this._options).data(this.type);if(!self.options.delay||!self.options.delay.show){return self.show()}clearTimeout(this.timeout);self.hoverState="in";this.timeout=setTimeout(function(){if(self.hoverState=="in"){self.show()}},self.options.delay.show)},leave:function(e){var self=$(e.currentTarget)[this.type](this._options).data(this.type);if(this.timeout){clearTimeout(this.timeout)}if(!self.options.delay||!self.options.delay.hide){return self.hide()}self.hoverState="out";this.timeout=setTimeout(function(){if(self.hoverState=="out"){self.hide()}},self.options.delay.hide)},show:function(){var $tip,inside,pos,actualWidth,actualHeight,placement,tp;if(this.hasContent()&&this.enabled){$tip=this.tip();this.setContent();if(this.options.animation){$tip.addClass("fade")}placement=typeof this.options.placement=="function"?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement;inside=/in/.test(placement);$tip.detach().css({top:0,left:0,display:"block"}).insertAfter(this.$element);pos=this.getPosition(inside);actualWidth=$tip[0].offsetWidth;actualHeight=$tip[0].offsetHeight;switch(inside?placement.split(" ")[1]:placement){case"bottom":tp={top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2};break;case"top":tp={top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2};break;case"left":tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth};break;case"right":tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width};break}$tip.offset(tp).addClass(placement).addClass("in")}},setContent:function(){var $tip=this.tip(),title=this.getTitle();$tip.find(".tooltip-inner")[this.options.html?"html":"text"](title);$tip.removeClass("fade in top bottom left right")},hide:function(){var that=this,$tip=this.tip();$tip.removeClass("in");function removeWithAnimation(){var timeout=setTimeout(function(){$tip.off($.support.transition.end).detach()},500);$tip.one($.support.transition.end,function(){clearTimeout(timeout);$tip.detach()})}$.support.transition&&this.$tip.hasClass("fade")?removeWithAnimation():$tip.detach();return this},fixTitle:function(){var $e=this.$element;if($e.attr("title")||typeof($e.attr("data-original-title"))!="string"){$e.attr("data-original-title",$e.attr("title")||"").removeAttr("title")}},hasContent:function(){return this.getTitle()},getPosition:function(inside){return $.extend({},(inside?{top:0,left:0}:this.$element.offset()),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var title,$e=this.$element,o=this.options;title=$e.attr("data-original-title")||(typeof o.title=="function"?o.title.call($e[0]):o.title);return title},tip:function(){return this.$tip=this.$tip||$(this.options.template)},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(e){var self=$(e.currentTarget)[this.type](this._options).data(this.type);self[self.tip().hasClass("in")?"hide":"show"]()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};$.fn.tooltip=function(option){return this.each(function(){var $this=$(this),data=$this.data("tooltip"),options=typeof option=="object"&&option;if(!data){$this.data("tooltip",(data=new Tooltip(this,options)))}if(typeof option=="string"){data[option]()}})};$.fn.tooltip.Constructor=Tooltip;$.fn.tooltip.defaults={animation:true,placement:"top",selector:false,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0,html:false}}(window.jQuery);!function($){var Popover=function(element,options){this.init("popover",element,options)};Popover.prototype=$.extend({},$.fn.tooltip.Constructor.prototype,{constructor:Popover,setContent:function(){var $tip=this.tip(),title=this.getTitle(),content=this.getContent();$tip.find(".popover-title")[this.options.html?"html":"text"](title);$tip.find(".popover-content > *")[this.options.html?"html":"text"](content);$tip.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var content,$e=this.$element,o=this.options;content=$e.attr("data-content")||(typeof o.content=="function"?o.content.call($e[0]):o.content);return content},tip:function(){if(!this.$tip){this.$tip=$(this.options.template)}return this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});$.fn.popover=function(option){return this.each(function(){var $this=$(this),data=$this.data("popover"),options=typeof option=="object"&&option;if(!data){$this.data("popover",(data=new Popover(this,options)))}if(typeof option=="string"){data[option]()}})};$.fn.popover.Constructor=Popover;$.fn.popover.defaults=$.extend({},$.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery);!function($){var Affix=function(element,options){this.options=$.extend({},$.fn.affix.defaults,options);this.$window=$(window).on("scroll.affix.data-api",$.proxy(this.checkPosition,this)).on("click.affix.data-api",$.proxy(function(){setTimeout($.proxy(this.checkPosition,this),1)},this));this.$element=$(element);this.checkPosition()};Affix.prototype.checkPosition=function(){if(!this.$element.is(":visible")){return}var scrollHeight=$(document).height(),scrollTop=this.$window.scrollTop(),position=this.$element.offset(),offset=this.options.offset,offsetBottom=offset.bottom,offsetTop=offset.top,reset="affix affix-top affix-bottom",affix;if(typeof offset!="object"){offsetBottom=offsetTop=offset}if(typeof offsetTop=="function"){offsetTop=offset.top()}if(typeof offsetBottom=="function"){offsetBottom=offset.bottom()}affix=this.unpin!=null&&(scrollTop+this.unpin<=position.top)?false:offsetBottom!=null&&(position.top+this.$element.height()>=scrollHeight-offsetBottom)?"bottom":offsetTop!=null&&scrollTop<=offsetTop?"top":false;if(this.affixed===affix){return}this.affixed=affix;this.unpin=affix=="bottom"?position.top-scrollTop:null;this.$element.removeClass(reset).addClass("affix"+(affix?"-"+affix:""))};$.fn.affix=function(option){return this.each(function(){var $this=$(this),data=$this.data("affix"),options=typeof option=="object"&&option;if(!data){$this.data("affix",(data=new Affix(this,options)))}if(typeof option=="string"){data[option]()}})};$.fn.affix.Constructor=Affix;$.fn.affix.defaults={offset:0};$(window).on("load",function(){$('[data-spy="affix"]').each(function(){var $spy=$(this),data=$spy.data();data.offset=data.offset||{};data.offsetBottom&&(data.offset.bottom=data.offsetBottom);data.offsetTop&&(data.offset.top=data.offsetTop);$spy.affix(data)})})}(window.jQuery);!function($){var dismiss='[data-dismiss="alert"]',Alert=function(el){$(el).on("click",dismiss,this.close)};Alert.prototype.close=function(e){var $this=$(this),selector=$this.attr("data-target"),$parent;if(!selector){selector=$this.attr("href");selector=selector&&selector.replace(/.*(?=#[^\s]*$)/,"")}$parent=$(selector);e&&e.preventDefault();$parent.length||($parent=$this.hasClass("alert")?$this:$this.parent());$parent.trigger(e=$.Event("close"));if(e.isDefaultPrevented()){return}$parent.removeClass("in");function removeElement(){$parent.trigger("closed").remove()}$.support.transition&&$parent.hasClass("fade")?$parent.on($.support.transition.end,removeElement):removeElement()};$.fn.alert=function(option){return this.each(function(){var $this=$(this),data=$this.data("alert");if(!data){$this.data("alert",(data=new Alert(this)))}if(typeof option=="string"){data[option].call($this)}})};$.fn.alert.Constructor=Alert;$(document).on("click.alert.data-api",dismiss,Alert.prototype.close)}(window.jQuery);!function($){var Button=function(element,options){this.$element=$(element);this.options=$.extend({},$.fn.button.defaults,options)};Button.prototype.setState=function(state){var d="disabled",$el=this.$element,data=$el.data(),val=$el.is("input")?"val":"html";state=state+"Text";data.resetText||$el.data("resetText",$el[val]());$el[val](data[state]||this.options[state]);setTimeout(function(){state=="loadingText"?$el.addClass(d).attr(d,d):$el.removeClass(d).removeAttr(d)},0)};Button.prototype.toggle=function(){var $parent=this.$element.closest('[data-toggle="buttons-radio"]');$parent&&$parent.find(".active").removeClass("active");this.$element.toggleClass("active")};$.fn.button=function(option){return this.each(function(){var $this=$(this),data=$this.data("button"),options=typeof option=="object"&&option;if(!data){$this.data("button",(data=new Button(this,options)))}if(option=="toggle"){data.toggle()}else{if(option){data.setState(option)}}})};$.fn.button.defaults={loadingText:"loading..."};$.fn.button.Constructor=Button;$(document).on("click.button.data-api","[data-toggle^=button]",function(e){var $btn=$(e.target);if(!$btn.hasClass("btn")){$btn=$btn.closest(".btn")}$btn.button("toggle")})}(window.jQuery);!function($){var Collapse=function(element,options){this.$element=$(element);this.options=$.extend({},$.fn.collapse.defaults,options);if(this.options.parent){this.$parent=$(this.options.parent)}this.options.toggle&&this.toggle()};Collapse.prototype={constructor:Collapse,dimension:function(){var hasWidth=this.$element.hasClass("width");return hasWidth?"width":"height"},show:function(){var dimension,scroll,actives,hasData;if(this.transitioning){return}dimension=this.dimension();scroll=$.camelCase(["scroll",dimension].join("-"));actives=this.$parent&&this.$parent.find("> .accordion-group > .in");if(actives&&actives.length){hasData=actives.data("collapse");if(hasData&&hasData.transitioning){return}actives.collapse("hide");hasData||actives.data("collapse",null)}this.$element[dimension](0);this.transition("addClass",$.Event("show"),"shown");$.support.transition&&this.$element[dimension](this.$element[0][scroll])},hide:function(){var dimension;if(this.transitioning){return}dimension=this.dimension();this.reset(this.$element[dimension]());this.transition("removeClass",$.Event("hide"),"hidden");this.$element[dimension](0)},reset:function(size){var dimension=this.dimension();this.$element.removeClass("collapse")[dimension](size||"auto")[0].offsetWidth;this.$element[size!==null?"addClass":"removeClass"]("collapse");return this},transition:function(method,startEvent,completeEvent){var that=this,complete=function(){if(startEvent.type=="show"){that.reset()}that.transitioning=0;that.$element.trigger(completeEvent)};this.$element.trigger(startEvent);if(startEvent.isDefaultPrevented()){return}this.transitioning=1;this.$element[method]("in");$.support.transition&&this.$element.hasClass("collapse")?this.$element.one($.support.transition.end,complete):complete()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};$.fn.collapse=function(option){return this.each(function(){var $this=$(this),data=$this.data("collapse"),options=typeof option=="object"&&option;if(!data){$this.data("collapse",(data=new Collapse(this,options)))}if(typeof option=="string"){data[option]()}})};$.fn.collapse.defaults={toggle:true};$.fn.collapse.Constructor=Collapse;$(document).on("click.collapse.data-api","[data-toggle=collapse]",function(e){var $this=$(this),href,target=$this.attr("data-target")||e.preventDefault()||(href=$this.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,""),option=$(target).data("collapse")?"toggle":$this.data();$this[$(target).hasClass("in")?"addClass":"removeClass"]("collapsed");$(target).collapse(option)})}(window.jQuery);!function($){var Carousel=function(element,options){this.$element=$(element);this.options=options;this.options.slide&&this.slide(this.options.slide);this.options.pause=="hover"&&this.$element.on("mouseenter",$.proxy(this.pause,this)).on("mouseleave",$.proxy(this.cycle,this))};Carousel.prototype={cycle:function(e){if(!e){this.paused=false}this.options.interval&&!this.paused&&(this.interval=setInterval($.proxy(this.next,this),this.options.interval));return this},to:function(pos){var $active=this.$element.find(".item.active"),children=$active.parent().children(),activePos=children.index($active),that=this;if(pos>(children.length-1)||pos<0){return}if(this.sliding){return this.$element.one("slid",function(){that.to(pos)})}if(activePos==pos){return this.pause().cycle()}return this.slide(pos>activePos?"next":"prev",$(children[pos]))},pause:function(e){if(!e){this.paused=true}if(this.$element.find(".next, .prev").length&&$.support.transition.end){this.$element.trigger($.support.transition.end);this.cycle()}clearInterval(this.interval);this.interval=null;return this},next:function(){if(this.sliding){return}return this.slide("next")},prev:function(){if(this.sliding){return}return this.slide("prev")},slide:function(type,next){var $active=this.$element.find(".item.active"),$next=next||$active[type](),isCycling=this.interval,direction=type=="next"?"left":"right",fallback=type=="next"?"first":"last",that=this,e;this.sliding=true;isCycling&&this.pause();$next=$next.length?$next:this.$element.find(".item")[fallback]();e=$.Event("slide",{relatedTarget:$next[0]});if($next.hasClass("active")){return}if($.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(e);if(e.isDefaultPrevented()){return}$next.addClass(type);$next[0].offsetWidth;$active.addClass(direction);$next.addClass(direction);this.$element.one($.support.transition.end,function(){$next.removeClass([type,direction].join(" ")).addClass("active");$active.removeClass(["active",direction].join(" "));that.sliding=false;setTimeout(function(){that.$element.trigger("slid")},0)})}else{this.$element.trigger(e);if(e.isDefaultPrevented()){return}$active.removeClass("active");$next.addClass("active");this.sliding=false;this.$element.trigger("slid")}isCycling&&this.cycle();return this}};$.fn.carousel=function(option){return this.each(function(){var $this=$(this),data=$this.data("carousel"),options=$.extend({},$.fn.carousel.defaults,typeof option=="object"&&option),action=typeof option=="string"?option:options.slide;if(!data){$this.data("carousel",(data=new Carousel(this,options)))}if(typeof option=="number"){data.to(option)}else{if(action){data[action]()}else{if(options.interval){data.cycle()}}}})};$.fn.carousel.defaults={interval:5000,pause:"hover"};$.fn.carousel.Constructor=Carousel;$(document).on("click.carousel.data-api","[data-slide]",function(e){var $this=$(this),href,$target=$($this.attr("data-target")||(href=$this.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,"")),options=$.extend({},$target.data(),$this.data());$target.carousel(options);e.preventDefault()})}(window.jQuery);!function($){var Typeahead=function(element,options){this.$element=$(element);this.options=$.extend({},$.fn.typeahead.defaults,options);this.matcher=this.options.matcher||this.matcher;this.sorter=this.options.sorter||this.sorter;this.highlighter=this.options.highlighter||this.highlighter;this.updater=this.options.updater||this.updater;this.$menu=$(this.options.menu).appendTo("body");this.source=this.options.source;this.shown=false;this.listen()};Typeahead.prototype={constructor:Typeahead,select:function(){var val=this.$menu.find(".active").attr("data-value");this.$element.val(this.updater(val)).change();return this.hide()},updater:function(item){return item},show:function(){var pos=$.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});this.$menu.css({top:pos.top+pos.height,left:pos.left});this.$menu.show();this.shown=true;return this},hide:function(){this.$menu.hide();this.shown=false;return this},lookup:function(event){var items;this.query=this.$element.val();if(!this.query||this.query.length<this.options.minLength){return this.shown?this.hide():this}items=$.isFunction(this.source)?this.source(this.query,$.proxy(this.process,this)):this.source;return items?this.process(items):this},process:function(items){var that=this;items=$.grep(items,function(item){return that.matcher(item)});items=this.sorter(items);if(!items.length){return this.shown?this.hide():this}return this.render(items.slice(0,this.options.items)).show()},matcher:function(item){return~item.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(items){var beginswith=[],caseSensitive=[],caseInsensitive=[],item;while(item=items.shift()){if(!item.toLowerCase().indexOf(this.query.toLowerCase())){beginswith.push(item)}else{if(~item.indexOf(this.query)){caseSensitive.push(item)}else{caseInsensitive.push(item)}}}return beginswith.concat(caseSensitive,caseInsensitive)},highlighter:function(item){var query=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return item.replace(new RegExp("("+query+")","ig"),function($1,match){return"<strong>"+match+"</strong>"})},render:function(items){var that=this;items=$(items).map(function(i,item){i=$(that.options.item).attr("data-value",item);i.find("a").html(that.highlighter(item));return i[0]});items.first().addClass("active");this.$menu.html(items);return this},next:function(event){var active=this.$menu.find(".active").removeClass("active"),next=active.next();if(!next.length){next=$(this.$menu.find("li")[0])}next.addClass("active")},prev:function(event){var active=this.$menu.find(".active").removeClass("active"),prev=active.prev();if(!prev.length){prev=this.$menu.find("li").last()}prev.addClass("active")},listen:function(){this.$element.on("blur",$.proxy(this.blur,this)).on("keypress",$.proxy(this.keypress,this)).on("keyup",$.proxy(this.keyup,this));if(this.eventSupported("keydown")){this.$element.on("keydown",$.proxy(this.keydown,this))}this.$menu.on("click",$.proxy(this.click,this)).on("mouseenter","li",$.proxy(this.mouseenter,this))},eventSupported:function(eventName){var isSupported=eventName in this.$element;if(!isSupported){this.$element.setAttribute(eventName,"return;");isSupported=typeof this.$element[eventName]==="function"}return isSupported},move:function(e){if(!this.shown){return}switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault();this.prev();break;case 40:e.preventDefault();this.next();break}e.stopPropagation()},keydown:function(e){this.suppressKeyPressRepeat=!~$.inArray(e.keyCode,[40,38,9,13,27]);this.move(e)},keypress:function(e){if(this.suppressKeyPressRepeat){return}this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown){return}this.select();break;case 27:if(!this.shown){return}this.hide();break;default:this.lookup()}e.stopPropagation();e.preventDefault()},blur:function(e){var that=this;setTimeout(function(){that.hide()},150)},click:function(e){e.stopPropagation();e.preventDefault();this.select()},mouseenter:function(e){this.$menu.find(".active").removeClass("active");$(e.currentTarget).addClass("active")}};$.fn.typeahead=function(option){return this.each(function(){var $this=$(this),data=$this.data("typeahead"),options=typeof option=="object"&&option;if(!data){$this.data("typeahead",(data=new Typeahead(this,options)))}if(typeof option=="string"){data[option]()}})};$.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1};$.fn.typeahead.Constructor=Typeahead;$(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(e){var $this=$(this);if($this.data("typeahead")){return}e.preventDefault();$this.typeahead($this.data())})}(window.jQuery);(function($){$.timeago=function(timestamp){if(timestamp instanceof Date){return inWords(timestamp)}else{if(typeof timestamp==="string"){return inWords($.timeago.parse(timestamp))}else{return inWords($.timeago.datetime(timestamp))}}};var $t=$.timeago;$.extend($.timeago,{settings:{refreshMillis:60000,allowFuture:false,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",numbers:[]}},inWords:function(distanceMillis){var $l=this.settings.strings;var prefix=$l.prefixAgo;var suffix=$l.suffixAgo;if(this.settings.allowFuture){if(distanceMillis<0){prefix=$l.prefixFromNow;suffix=$l.suffixFromNow}distanceMillis=Math.abs(distanceMillis)}var seconds=distanceMillis/1000;var minutes=seconds/60;var hours=minutes/60;var days=hours/24;var years=days/365;function substitute(stringOrFunction,number){var string=$.isFunction(stringOrFunction)?stringOrFunction(number,distanceMillis):stringOrFunction;var value=($l.numbers&&$l.numbers[number])||number;return string.replace(/%d/i,value)}var words=seconds<45&&substitute($l.seconds,Math.round(seconds))||seconds<90&&substitute($l.minute,1)||minutes<45&&substitute($l.minutes,Math.round(minutes))||minutes<90&&substitute($l.hour,1)||hours<24&&substitute($l.hours,Math.round(hours))||hours<48&&substitute($l.day,1)||days<30&&substitute($l.days,Math.floor(days))||days<60&&substitute($l.month,1)||days<365&&substitute($l.months,Math.floor(days/30))||years<2&&substitute($l.year,1)||substitute($l.years,Math.floor(years));return $.trim([prefix,words,suffix].join(" "))},parse:function(iso8601){var s=$.trim(iso8601);s=s.replace(/\.\d\d\d+/,"");s=s.replace(/-/,"/").replace(/-/,"/");s=s.replace(/T/," ").replace(/Z/," UTC");s=s.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2");return new Date(s)},datetime:function(elem){var isTime=$(elem).get(0).tagName.toLowerCase()==="time";var iso8601=isTime?$(elem).attr("datetime"):$(elem).attr("title");return $t.parse(iso8601)}});$.fn.timeago=function(){var self=this;self.each(refresh);var $s=$t.settings;if($s.refreshMillis>0){setInterval(function(){self.each(refresh)},$s.refreshMillis)}return self};function refresh(){var data=prepareData(this);if(!isNaN(data.datetime)){$(this).text(inWords(data.datetime))}return this}function prepareData(element){element=$(element);if(!element.data("timeago")){element.data("timeago",{datetime:$t.datetime(element)});var text=$.trim(element.text());if(text.length>0){element.attr("title",text)}}return element.data("timeago")}function inWords(date){return $t.inWords(distance(date))}function distance(date){return(new Date().getTime()-date.getTime())}document.createElement("abbr");document.createElement("time")}(jQuery));jQuery.extend({stringify:function(obj){var t=typeof(obj);if(t!="object"||obj===null){if(t=="string")obj='"'+ obj+'"';return String(obj);}else{var n,v,json=[],arr=(obj&&obj.constructor==Array);for(n in obj){v=obj[n];t=typeof(v);if(obj.hasOwnProperty(n)){if(t=="string")v='"'+ v+'"';else if(t=="object"&&v!==null)v=jQuery.stringify(v);json.push((arr?"":'"'+ n+'":')+ String(v));}}
return(arr?"[":"{")+ String(json)+(arr?"]":"}");}}});var fog={init:function(){},user:{uid:0},message:function(object){var str=object.message,type=object.type,container=object.container,title='',alert;if(!type){type='info';}
if(object.title!==false){switch(type){case'danger':title='Oops, something went wrong';break;case'success':title='Yay! Success!';break;default:title='Here\'s the low down';break;}
title='<h4>'+ title+'</h4>';}
if($(document.body).find('.js-alert')){$('.js-alert').remove();}
alert=$('<div />');alert.addClass('cl js-alert alert-block alert alert-'+ type);alert.html('<button type="button" class="close" data-dismiss="alert">x</button>'+ title+'<p>'+ str+'</p>');if(!container){container=document.body;alert.css({position:'fixed',top:144,right:50});}
$(container).prepend(alert);alert.fadeIn(fog.normalSpeed);if(type==='success'||type==='info'){setTimeout(function(){alert.fadeOut(fog.normalSpeed);},5000);}},request:function(url,data,callback){var base=fog.baseUrl+'ajax/call/';$.post(base+ url,{data:data},function(r){r=JSON.parse(r);if(!r||r===null){return;}
if(!r.error){if(callback){callback(r);}}else{fog.message(r);}});},cdnServer:'http://freeonlinegames.com',slowSpeed:200,normalSpeed:500,fastSpeed:1000,buttons:{addFavorite:'[data-method="add-favorite"]',removeFavorite:'[data-method="remove-favorite"]'},switchElement:function(element,data,current,callback){$.ajax({url:fog.baseUrl+'ajax/create_element',type:'post',data:{element:element,data:data},async:false,success:function(rendered){$(current).replaceWith(rendered);fog.timeago();if(typeof callback==='function'){callback();}}});},createElement:function(element,data,container,replace,callback,append,after){$.ajax({url:fog.baseUrl+'ajax/create_element',type:'post',data:{element:element,data:data},async:false,success:function(rendered){if(replace===true){$(container).html(rendered);}else{if(append){$(container).append(rendered);}else if(!append&&!after){$(container).prepend(rendered);}else if(after){$(rendered).insertAfter(container);}else{$(container).prepend(rendered);}}
fog.timeago();if(typeof callback==='function'){callback();}}});},updateAvatar:function(){this.request('avatars/update',null,function(data){$('.myAvatar').attr('src',data);return true;});return false;},addFavorite:function(el,gameId){el.attr('disabled',true);gameId=parseInt(gameId,10);fog.request('/favorites/add_favorite',{game_id:gameId},function(){if(fog.user.fbid){fbEnsureInit(function(){FB.api('/me/fogconnect:favorite','post',{game:fog.url},function(response){});});}
el.children('i').addClass('favorited');el.attr('data-callback','fog.removeFavorite').attr('disabled',false).data('title','Remove from Favorites');el.data('tooltip').options.title='Remove from Favorites';});},removeFavorite:function(el,gameId){el.attr('disabled',true);gameId=parseInt(gameId,10);fog.request('/favorites/remove_favorite',{game_id:gameId},function(){el.children('i').removeClass('favorited');el.attr('data-callback','fog.addFavorite').attr('disabled',false).data('title','Add to Favorites');el.data('tooltip').options.title='Add to Favorites';});},addComment:function(el,gameId){el.attr('disabled',true);var comment=el.prev().prev().val();gameId=parseInt(gameId,10);if(comment.length<10){el.attr('disabled',false);return fog.message({message:'Your comment must be longer than 10 characters',type:'danger',container:'#create-comment'});}
fog.request('/comments/add_comment',{game_id:gameId,comment:comment},function(data){el.prev().prev().val('');$('.character-count span').text('100');if($('#game-comments-wrapper article').length===0){$('#game-comments-wrapper').empty();}
fog.createElement('game/comments',{comment:data.comment,username:fog.user.username,timestamp:new Date().getTime()/1000,id:data.comment,flags:0,likes:0,data:{u_email:fog.user.email,u_avatar:fog.user.avatar,u_avatar_type:fog.user.avatar_type}},'#game-comments-wrapper');});el.attr('disabled',false);},characterCount:function(el,maxLength){var chars=el.val().length;if(maxLength- chars<=0){$('.character-count span').css('color','#f00');$('.character-count span').html(0);}else{$('.character-count span').css('color','#888');$('.character-count span').html(maxLength- chars);}},loadGameComments:function(gameId,offset,limit){var container='#game-comments-wrapper';$('#load-more-comments').text('Loading...').attr('disabled',true);if(!offset){offset=0;}
if(!limit){limit=3;}
fog.request('/comments/find_by_game',{game_id:gameId,limit:limit,offset:offset,json:'true'},function(data){var comments=data.comments,append=false;if(!comments||(comments.length===0&&offset===0)){$(container).html('<div class="alert alert-warn"><h4>No comments made yet.</h4>Be the first to comment on this game</div>');return;}else{append=true;if($(container).find('.loading').length){$(container).empty();append=false;}
$('#load-more-comments').text('Load more').removeAttr('disabled');if(comments.length!==0){$.each(comments,function(k,v){fog.createElement('/game/comments',{username:v.u_username,avatar:v.u_avatar,comment:v.comment,timestamp:v.timestamp,id:v.cid,flags:v.flags,likes:v.likes,data:v},container,false,{},append);});$('.timeago').timeago();if(data.more){$('#load-more-comments').fadeIn();}else{$('#load-more-comments').remove();}}else{$('#load-more-comments').remove();}}});},deleteComment:function(el,commentId){if(!commentId){return;}
fog.request('/comments/delete_comment',{comment_id:commentId},function(r){if(!r.error){$('#warn-modal').modal('show');$('#warn-modal input[type=hidden]').val(r.user_id);var container=el.parent().parent().find('p')[0];$('#warn-modal textarea').val('This is a warning about the comment you made on '+ fog.game.title+"\n"+'Please refrain from posting comments such as this. The comment is below:'+"\n"+
r.comment);if($('#game-comments-wrapper article').length===1){$('#game-comments-wrapper').html('<div class="alert alert-warn"><h4>No comments made yet.</h4>Be the first to comment on this game</div>');}else{el.parent().parent().parent().remove();}}else{return fog.message(r);}});},warnUser:function(el){var user_id=parseInt($('#warn-modal input[name="user_id"]').val(),10),warning=$('#warn-modal textarea').val();fog.request('/users/warn_user',{user_id:user_id,warning:warning},function(r){fog.message(r);$('#warn-modal').modal('hide');});},banUser:function(el){var user_id=parseInt($('#ban-modal input[name="user_id"]').val(),10);fog.request('/users/ban_user',{user_id:user_id},function(r){fog.message(r);$('#ban-modal').modal('hide');$('[data-target="#ban-modal"]').text('Un-Ban').attr('data-target','#unban-modal');});},unbanUser:function(el){var user_id=parseInt($('#unban-modal input[name="user_id"]').val(),10);fog.request('/users/unban_user',{user_id:user_id},function(r){fog.message(r);$('#unban-modal').modal('hide');$('[data-target="#unban-modal"]').text('Ban').attr('data-target','#ban-modal');});},flagComment:function(el,commentId){if(!commentId){return;}
fog.request('/comments/flag_comment',{comment_id:commentId},function(r){fog.message(r);});},likeComment:function(el,commentId){if(!commentId){return;}
if(!fog.user.uid){return;}
fog.request('/comments/like_comment',{comment_id:commentId},function(r){if(!r.error){var currentLikes=parseInt($('#comment-'+ commentId).find('.comment-likes').find('span').text(),10);$('#comment-'+ commentId).find('.comment-likes').find('span').text(currentLikes+ 1);}else{fog.message(r);}});},toggleFlaggedComment:function(el,commentId){if(!commentId){return;}
var showHide=$(el).text()==='Show'?'Hide':'Show';$('#comment-'+ commentId+' div').toggleClass('hide');$(el).text(showHide);},rateGame:function(el,params){var rating=params[0],gameId=fog.game.id;if(!rating||!gameId){return;}
fog.request('/ratings/add',{game_id:gameId,rating:rating},function(r){el.addClass('active');var index=el.index(),i;for(i=index;i>=0;i-=1){$('.star').eq(i).addClass('active');}
for(i=index+ 1;i<=5;i+=1){$('.star').eq(i).removeClass('active');}
if(fog.user.fbid){fbEnsureInit(function(){FB.api('/me/fogconnect:rate','post',{game:fog.url,rating:rating},function(response){});});}
fog.message(r);});},timeago:function(){$('time.timeago').timeago();},addPlaylater:function(el,gameId){if(!gameId){return;}
fog.request('/playlater/add_playlater',{game_id:gameId},function(r){if(!r.error){$(el).removeClass('icon-plus-sign').addClass('icon-minus-sign').data('original-title','Remove from playlater').data('callback','fog.removePlaylater');if($('#playlater-banner li').length===11){$('#playlater-banner li:last').remove();}
fog.createElement('/playlater/game',{title:$(el).parent().find('h6 > a').text().trim(),game_id:gameId,url:$(el).parent().find('h6 > a').attr('href').replace('/game/','')},'#playlater-banner');$('[rel="tooltip"]').tooltip();}else{fog.message(r);}});},removePlaylater:function(el,gameId){if(!gameId){return;}
fog.request('/playlater/remove_playlater',{game_id:gameId},function(r){if(!r.error){if($(el).hasClass('icon-minus-sign')){$(el).removeClass('icon-minus-sign').addClass('icon-plus-sign').data('original-title','Add to playlater').data('callback','fog.addPlaylater');}
$('#playlater-'+ gameId).remove();}else{fog.message(r);}});},leaveGroup:function(el,groupId){if(!groupId){return;}
fog.request('/groups/leave',{group_id:groupId},function(r){if(r.error){return fog.message(r);}
if(fog.page==='groups'&&fog.action){location.href='/groups';}});},joinGroup:function(el,groupId){if(!groupId){return;}
fog.request('/groups/join',{group_id:groupId},function(r){if(r.error){return fog.message(r);}else{location.reload();}});},createGroup:function(el){var p=$('input[name="private"]').is(':checked')?1:0;fog.request('/groups/create',{owner:fog.user.uid,icon:$('input[name="icon"]:checked').val(),'private':p,title:$('input[name="title"]').val()},function(r){location.href='/groups/'+ r;});},editGroup:function(el,groupId){var p=$('input[name="status"]:checked').val();fog.request('/groups/edit',{owner:fog.user.uid,icon:$('input[name="icon"]:checked').val(),status:p,title:$('input[name="title"]').val(),group_id:groupId},function(r){fog.message(r);});},addGroupMember:function(el,groupId){var member=$('select[name="members"] option:selected').val();fog.request('/groups/add_members',{group_id:groupId,members:member},function(r){location.reload();});},removeGroupMember:function(el,params){var groupId=params[0],userId=params[1];fog.request('/groups/remove_member',{user_id:userId,group_id:groupId},function(r){$(el).parent().remove();});},followUser:function(el,userId){if(!userId){return;}
fog.request('/relationships/follow',{user_id:userId},function(r){el.removeClass('btn-success').addClass('btn-danger').text('Unfollow').attr('data-callback','fog.unfollowUser');fog.request('/notifications/add',{to:userId,from:fog.user.uid,text:'is now following you',link:'/user/'+ fog.user.username});});},unfollowUser:function(el,userId){if(!userId){return false;}
fog.request('/relationships/unfollow',{user_id:userId},function(r){el.removeClass('btn-danger').addClass('btn-success').text('Follow').attr('data-callback','fog.followUser');});},acceptGroupInvite:function(el,groupId){fog.request('groups/accept_invite',{group_id:groupId},function(r){var notif_id=el.parent().attr('id');fog.markNotificationRead(el,notif_id);if(fog.action==='group'&&fog.page==='groups'){window.location.reload();return true;}});},declineGroupInvite:function(el,groupId){fog.request('groups/decline_invite',{group_id:groupId},function(r){var notif_id=el.parent().attr('id');fog.markNotificationRead(el,notif_id);if(fog.action==='group'&&fog.page==='groups'){window.location.reload();return true;}});},markNotificationRead:function(el,notifId){fog.request('notifications/mark_read',{notif_id:notifId},function(r){el.parent().parent().parent().removeClass('unread');$('#mark-read-'+ notifId).remove();$('#options-'+ notifId).remove();if($('#unread-count')){var count=parseInt($('#unread-count').text().trim(),10);count-=1;if(count<=0){$('#unread-count').remove();}else{$('#unread-count').text(count);}}});},markAllNotificationsRead:function(){fog.request('notifications/mark_all_read',{});},ad:{topPosition:0,documentMargin:0,showGame:function(){$('#game-wrap').css({display:'block'});$('#preroll').remove();},countdown:function(element,timer){timer-=1;if(timer<=0){fdjs.game.adComplete=true;fdjs.game.showGame();}else{if(element!==undefined){$(element).html(timer);}}
setTimeout(fog.ad.countdown,1000,element,timer);},drawSkin:function(url,image_url,background_color,top_margin){var id='adskin';var ad=$('<a></a>').attr('id',id).attr('href',url).attr('target','_blank');fog.ad.topPosition=115;if(fog.user.uid>0){fog.ad.topPosition=147;}
ad.css({'display':'block','position':'fixed','top':fog.ad.topPosition+'px','left':'0','zIndex':0,'width':'100%','height':$(window).height()- 75,'textAlign':'center','background':'url('+ image_url+') no-repeat','backgroundPosition':'center top',});if(typeof background_color!==undefined){$('html, body').css('background-color','#'+ background_color);}
if(typeof top_margin!==undefined){fog.ad.documentMargin=top_margin;$('#main-container').css('margin-top',top_margin);}
$('body').append(ad);},updateSkinPosition:function(){var scrollY=$(window).scrollTop();fog.ad.topPosition=115;if(fog.user.uid>0){fog.ad.topPosition=147;}
if(scrollY<0){return false;}else if(scrollY>70&&fog.user.uid>0){$('#adskin').css({'top':70});}else if(scrollY>70){$('#adskin').css({'top':40});}else{$('#adskin').css({'top':fog.ad.topPosition- scrollY});}}},oAuth:{fb:{appId:202834586920}},badgePopup:function(data){$('.achi').html('<div class="badge_level_'+ data.level+'_small"></div>'
+'<div class="'+ data.badge.replace(' ','_').toLowerCase()+'_small"></div>');$('#popup-text').text(data.description);$('.popup-container').animate({bottom:0});},sendChat:function(message){var user=false,data;if(!message){$('input[data-callback="fog.sendChat"]').attr('disabled',true);message=$('input[name="chat"]').val();user=true;if(message.length===0){return;}}
data={gameId:fog.game.id,user:fog.user,chat:message};if(typeof socket!=='undefined'){socket.emit('chat',data);}
if(user){$('input[name="chat"]').val('');}},leaveChat:function(){socket.emit('leaveChat',fog.user,fog.game.id);},toggleChatUsers:function(){var el=$('#toggleRoom');if($('#room-wrapper ul').hasClass('hide')){$('#room-wrapper ul').removeClass('hide');}else{$('#room-wrapper ul').addClass('hide');}},getUser:function(){return fog.user;},addTranslation:function(el){var trans=el.prev().val(),id=el.parent().attr('id'),eng=el.prev().prev().val(),cont=el.parent().attr('data-controller');console.log(id);if(trans.length<1){fog.message({message:'Please enter your translation',type:'error'});return false;}
$.post(fog.baseUrl+'ajax/call/language/submit',{data:{id:id,translation:trans,eng:eng}},function(r){r=JSON.parse(r);el.prev().val('');var parent=el.parent().parent().parent();parent.next().removeClass('hide').addClass('active');parent.remove();fog.message(r);});},voteupTranslation:function(el){$.post(fog.baseUrl+'ajax/call/language/voteup',{data:{id:el.parent().attr('id')}},function(r){r=JSON.parse(r);fog.message(r);el.attr('disabled',true);el.next().attr('disabled',false);});},votedownTranslation:function(el){$.post(fog.baseUrl+'ajax/call/language/votedown',{data:{id:el.parent().attr('id')}},function(r){r=JSON.parse(r);fog.message(r);el.attr('disabled',true);el.prev().attr('disabled',false);});},createForumPost:function(el,topicId){if(!topicId){return;}
el.attr('disabled',true);topicId=topicId.split('-');topicId=topicId[topicId.length- 1];var content=$('textarea[name="content"]').val();fog.request('/posts/create',{content:content,tid:topicId},function(r){fog.createElement('forum/post',{post:r},'#post-wrapper',false,null,true);el.removeAttr('disabled');});},getPost:function(el,pid){if(!pid){return;}
fog.request('/posts/find_by_id',{pid:pid},function(r){$('#quick-reply').find('textarea').val('[quote='+ r.u_username+']'+ r.p_content+'[/quote]'+"\n\n");$('#quick-reply').find('textarea').animate({scrollTop:$(this).height()}).focus();$('#quick-reply').find('.well').slideDown();$(document.body).animate({scrollTop:$(document.body).height()});});},editPost:function(el,pid){if(!pid){return;}
el.parent().prev().attr('contenteditable',true).focus();},savePost:function(id){if(!id){return;}
fog.request('/posts/save',{content:$('#post-'+ id).text(),pid:id},function(r){fog.message(r);});},deletePost:function(el,pid){if(!pid){return;}
if(window.confirm('Are you sure you want to delete this post?')){fog.request('posts/delete',{id:pid},function(r){fog.message(r);el.parent().prev('.content').html('[This post has been deleted]');});}},deleteTopic:function(el,tid){if(!tid){return false;}
if(window.confirm('Are you sure you want to delete the whole thread?')){fog.request('/topics/delete',{id:tid},function(r){fog.message(r);});}},saveTopic:function(el,tid){if(!tid){return false;}
var modal=$('#edit-topic-modal');fog.request('/topics/save',{name:modal.find('input[name="name"]').val(),locked:modal.find('input[name="locked"]').is(':checked')?1:0,sticky:modal.find('input[name="sticky"]').is(':checked')?1:0,id:tid},function(r){location.reload();});},createTopic:function(el,fid){if(!fid){return;}
var modal=$('#new-topic-modal');fog.request('topics/create',{fid:fid,name:modal.find('input[name="name"]').val(),locked:modal.find('input[name="locked"]').is(':checked')?1:0,sticky:modal.find('input[name="sticky"]').is(':checked')?1:0,content:modal.find('textarea[name="content"]').val()},function(r){fog.createElement('forum/topic',{topic:r,forum_name:r.forum},'#topic-wrapper',false,function(){$('#new-topic-modal').modal('hide');},true);});},flagPost:function(el,pid){if(!pid){return;}
fog.request('/posts/flag',{pid:pid},function(r){fog.message(r);});},avatarChange:function(){var avatar=$('.myAvatar');avatar.attr('data-old',avatar.attr('src'));avatar.attr('src','/images/loading.gif');}};(function(){"use strict";var FogApi=function(base){$.extend(this,{server:base+'/api/2/',polltime:60000,debug:false,fb_post_id:0,game:{adComplete:false,gameComplete:false,showGame:function(){if(this.adComplete===true&&this.gameComplete===true){showGame();$('#game-preloader-swf').remove();}},loadComplete:function(){this.gameComplete=true;this.showGame();},connect:function(){console.log("Connect.");}},connectfl:function(){if(this.debug){console.log("Connected to Flash.");}
fog.scoreboard.timeout=false;return true;},call:function(func,var1,var2){if(this.debug){console.log("Calling function "+ func+"("+ var1+")");}
var f=func.split('.'),t=this,i;for(i=0;i<f.length;i+=1){t=t[f[i]];}
if(t){if(this.debug){console.log("Found function "+ func+"("+ var1+")");}
return t.bind(this,var1,var2)();}else{if(this.debug){console.error("Function "+ func+" does not exist!");}
return false;}},request:function(method,func,data){if(this.debug){console.log("Ajax Request: "+ method+"/"+ func+"\nData: "+ $.stringify(data));}
var success=false;$.ajax({url:this.server+ method+'/'+ func,dataType:'json',async:false,type:'get',data:data,success:function(ret){if(this.debug){console.log('Success');}
success=ret;},error:function(ret){if(this.debug){console.log('Error');}
success=ret;}});if(this.debug){console.log("Server Response: "+ $.stringify(success));}
return success;},scores:{dataPoll:function(){},dataPollFunc:function(){},refresh:function(score,message){fog.scoreboard.board();if(message.type==="success"){fog.sendChat("I Just got my highest score ("+ score+")! Can you beat it?");fog.scoreboard.user();}
if(message.type==='success'||message.type==='error'){message.container='#scores_update';message.title=false;fog.message(message);}},update:function(score){if(this.debug){console.log("scores.update called, Game "+ fog.game.id+" Score: "+ score);}
var request=this.request('scores','submit',{gid:fog.game.id,score:score,period:fog.scoreboard.data.period,group:fog.scoreboard.data.group}),fb_post_id;if(request!==undefined){fog.scoreboard.board();if(request.type==="success"){fog.sendChat("I Just got my highest score ("+ score+")! Can you beat it?");if(fog.user.fbid){fb_post_id=fog.url+':fb_post_id';fbEnsureInit(function(){FB.api('/me/fogconnect:score','post',{game:fog.url,score:score},function(response){if(localStorage.getItem(fb_post_id)){FB.api('/'+ localStorage.getItem(fb_post_id),'delete',function(del_response){});}
localStorage.setItem(fb_post_id,response.id);});});}
fog.scoreboard.user();}
if(request.type==='success'||request.type==='error'){request.container='#scores_update';request.title=false;}
return true;}
return false;}}});},__FogDevJS=FogApi,fdjs=new FogApi(domain),FogDevJS=fdjs;fog=(fog===undefined?{}:fog);fog.api={fdjs:new FogApi(domain),connect:function(){return this.fdjs.connectfl();},scores:{update:function(s){return fog.api.fdjs.call('scores.update',s);},getHighScore:function(){return fog.api.fdjs.call('scores.getHighScore');}},getUserData:function(){return this.user;},user:{'ID':'Guest','Name':'Guest','Thumb':'','HighScore':0},_updateUserComp:function(u){this.ID=u.uid;this.Name=u.username;}};}());var Api3=function(){"use strict";var t=this;t.debug=true;t.base='/api/3/';t.user=false;t.swf=false;t.fetchUser=function(callback){if(typeof t.user.uid==='undefined'){$.ajax({url:t.base+'me',async:false,success:function(response){t.user=response;if(typeof callback!=='undefined'){callback(t.user);}}});}else{if(typeof callback!=='undefined'){callback(t.user);}}};t.call=function(method,args,callback){if(typeof args!=='object'){args=JSON.parse(args);}
var f=method.split('.'),func=t,i;for(i=0;i<f.length;i+=1){func=func[f[i]];}
if(!func){if(t.debug){console.error("Function "+ method+" does not exist!");}}else{return func.bind(t,args,callback)();}
return false;};t.game={scores:function(args,callback){if(typeof fog!=='undefined'){fog.scoreboard.board();fog.scoreboard.user();args.container='#scores_update';args.title=false;fog.message(args);}
if(typeof callback!=='undefined'){callback(args);}},storage:function(args,callback){if(typeof fog!=='undefined'){if(args.type==='success'||args.type==='error'){args.container='#scores_update';args.title=false;fog.message(args);}}
if(typeof callback!=='undefined'){callback(args);}},events:function(args,callback){if(typeof fog!=='undefined'){if(args.type==='success'||args.type==='error'){args.container='#scores_update';args.title=false;fog.message(args);}}
if(typeof callback!=='undefined'){callback(args);}},defaultSize:{width:0,height:0},resize:function(args,callback){var size={width:window.width- 50,height:window.height- 50},elements=[$('#game-wrap'),$('#game-holder-game'),$('#game-holder')],element=t.swf!==false?t.swf:'#game-holder-game-element',i;if(this.defaultSize.width===0){this.defaultSize.width=element.width();}
if(this.defaultSize.height===0){this.defaultSize.height=element.height();}
if(args.type==='big'){if(args.maxWidth&&size.width>args.maxWidth){size.width=args.maxWidth;}
if(args.maxHeight&&size.height>args.maxHeight){size.height=args.maxHeight;}}
if(args.type==='small'){if(this.defaultSize.width!==0){size.width=this.defaultSize.width;}
if(this.defaultSize.height!==0){size.height=this.defaultSize.height;}}
$('#game-holder, #game-holder-game, #game-wrap, '+ element).animate(size,300);if(typeof callback!=='undefined'){callback(size);}}};t.xp={refresh:function(args,callback){$.post('auth/status',function(data){console.log(data);if(typeof fog!=='undefined'){$('.myLevel').text(parseInt(data.level['int'],10));$('.myXp').css('width',data.level.percent+'%');$('.progress-fog').attr('title',parseInt(data.xp,10)+'XP - '+ parseInt(data.level.percent,10)+'%');$('.myCoins').text(parseInt(data.coins,10));$('.myBadges').text(parseInt(data.badges,10));}
if(typeof callback!=='undefined'){callback(data);}});}};t.coins={refresh:function(callback){$.post('/ajax/call/coins/count',function(data){console.log(data);if(typeof fog!=='undefined'){$('.myCoins').text(parseInt(data,10));}
if(typeof callback!=='undefined'){callback(data);}});},buy:function(){t.swf.fromJS('boughtCoins');}};t.avatar={update:function(){fog.updateAvatar();}};t.connect=function(args,callback){var id,options={debug:false,game:'#game-holder-game-element'};for(id in args){if(args.hasOwnProperty(id)){options[id]=args[id];}}
if(options.debug===true){t.debug=true;}
t.game.defaultSize={width:$(options.game).width(),height:$(options.game).height()};t.swf=$(options.game)[0];if(typeof fog!=='undefined'){fog.scoreboard.timeout=false;if(fog.user){t.swf.fromJS('connected');}}
if(typeof callback!=='undefined'){callback();}};t.auth=function(args,callback){var options={type:'get'},opt;for(opt in args){if(args.hasOwnProperty(opt)){options[opt]=args[opt];}}
if(options.type==='login'||options.type==='get'){t.fetchUser(function(){if(typeof t.user.uid==='undefined'){if(options.type==='login'){$.post('/ajax/auth',options,function(){t.fetchUser(function(){if(typeof callback!=='undefined'){callback(t.user);}});},'json');return;}}
callback(t.user);});}else{$.post('/ajax/auth',options,function(response){t.user=false;t.fetchUser();callback(response);},'json');}
if(options.type!=='get'&&t.swf!==false){t.swf.fromJS('auth'+ options.type.ucfirst());}};t.fetchUser();};$(window).scroll(function(){var scrollY=$(window).scrollTop();if(scrollY>=70&&fog.user.uid>0){$('#stats-navbar').css({position:'fixed',width:'100%',top:40});$('#main-container').css('margin-top',25+ fog.ad.documentMargin);$('.dropdown-menu').css('margin-top',35);$('#head-avatar').css({width:30,height:30,top:5});$('.user-dropdown').css({marginTop:40});}else{$('#stats-navbar').css({position:'',width:'100%',top:0,zIndex:100});$('#head-avatar').css({width:100,height:100});$('.user-dropdown').css({marginTop:0});$('#main-container').css('margin-top',0);$('.dropdown-menu').css('margin-top',0);}
if(scrollY>0&&scrollY<=70){$('#head-avatar').css({width:100- scrollY,height:100- scrollY});}
fog.ad.updateSkinPosition();});$(document).ready(function(){$('body').delegate('button[data-debug_method],a[data-debug_method]','click',function(){var method=$(this).data('debug_method');if(method=='skip_preroll'){showGame();return;}
$('#debug_method').val(method);$('#debug_method').parent().submit();});$('.debug-country-other').click(function(){var CC=prompt('Type the country code of your choice:');if(!CC)return;document.location='/?set_cc='+ CC.toUpperCase();});fog.timeago();$('.notifications-icon').click(function(){fog.markAllNotificationsRead();$(this).find('.badge').remove();});$('#load-more-comments').on('click',function(){fog.loadGameComments(fog.game.id,$('.game-comment').length,3);});$('.job_wrapper a[id^="jobs-toggle"]').click(function(){$(this).parent().next().slideToggle();});$(document.body).delegate('.post-content > div[contenteditable]','blur',function(){var id=$(this).parent().attr('id').replace('post-','');fog.savePost(id);$(this).attr('contenteditable',false);});$(document.body).delegate('[data-handle="click"]','click',function(){var callback=$(this).attr('data-callback');if(callback){var parts=callback.split('.');var method=window;$(parts).each(function(){method=method[this];});var params=$(this).attr('data-params');if(params){if(params.indexOf(',')!==-1){params=params.split(',');}}else{params={};}
method($(this),params);}});$(document.body).delegate('[data-handle="keyup"]','keyup',function(){var callback=$(this).attr('data-callback');if(callback){var parts=callback.split('.');var method=window;$(parts).each(function(){method=method[this];});var params=$(this).attr('data-params');if(params&&params.indexOf(',')!==-1){params=params.split(',');}
method($(this),params);}});$('#navbar ul li').mouseover(function(){if($(this).hasClass("divider")){return;}
if($(this).next().find('.dropdown').length>0){$(this).addClass('hover');}});$('#navbar ul li').mouseout(function(){if($(this).hasClass("divider")){return;}
if(!$(this).find('.dropdown')){return;}
$(this).removeClass('hover');});$('.dropdown-toggle').dropdown();$('.module .module-left').click(function(){var currentGames=$(this).parent().parent().parent().find('.sub-module:visible')
var nextGames=currentGames.prev('.sub-module');if(nextGames.length==0){nextGames=$(this).parent().parent().parent().find('.sub-module').last();}
var tabNumber=nextGames.index();var totalTabs=nextGames.parent().find('div.sub-module').length;$(this).parent().find('span').text(tabNumber+' / '+ totalTabs);currentGames.hide();nextGames.show();});$('.module .module-right').click(function(){var currentGames=$(this).parent().parent().parent().find('.sub-module:visible')
var nextGames=currentGames.next('.sub-module');if(nextGames.length==0){nextGames=$(this).parent().parent().parent().find('.sub-module').first();}
var tabNumber=nextGames.index();var totalTabs=nextGames.parent().find('div.sub-module').length;$(this).parent().find('span').text(tabNumber+' / '+ totalTabs);currentGames.hide();nextGames.show();});$('img').error(function(){$(this).attr('data-original',$(this).attr('src'));$(this).attr('src','/images/icons/noimage.png');});$('body').tooltip({selector:'[rel="tooltip"]'});$('[rel="popover"]').popover({html:true});$('[rel="popover-hover"]').popover({trigger:'hover',html:true});$('form[data-ajax="true"]').submit(function(e){e.preventDefault();});$('#dim-button, #lights-out').off('click').on('click',function(){if($('#lights-out').hasClass('active')){$('#lights-out').removeClass('active');}else{$('#lights-out').addClass('active');}})
$(document.body).off('click.scoreboard').on('click.scoreboard','.scoreboard-link:not(.active)',function(){$('.group-title-name').html($(this).data('name'));fog.scoreboard.data.group=$(this).prop('id').replace('sg-','');$('.active','#sb-icons').removeClass('active');$(this).addClass('active');fog.scoreboard.board();fog.scoreboard.user();}).off('click.period').on('click.period','#sb-period a',function(){$('.active','#sb-period').removeClass('active');$(this).addClass('active');fog.scoreboard.board();fog.scoreboard.user();});$('.module-toggle h2').click(function(){$(this).parent().children('.hide').stop(true,true).slideToggle();});if(fog.game.scoreboard===true&&fog.user.uid!=0){fog.scoreboard=new Scoreboard();}});$(window).load(function(){fog.init();});var showGame=fog.ad.showGame;$.fn.slider=function(options){options=$.extend({},$.fn.slider.options,options);var el=$(this);var left=$(options.left);var right=$(options.right);var container=el.find('#'+ options.sliderId);var numSlides=container.find('li').length;var slider=container.find('ul');var slideWidth=slider.find('li').outerWidth();var slideHeight=slider.find('li').outerHeight();var current=0;var prev=0;var next=0;var position=0;var direction=0;var start=options.start||current;var autoSpeed=options.autoSpeed;var interval;var sliding=false;if(options.captions){slider.children().each(function(i){var caption=$(this).find('.caption');caption.css('bottom',-200);});slider.children(':eq('+current+')').find('.caption').stop().animate({bottom:0});}
slider.children().css({position:'absolute',top:0,left:slider.children().outerWidth(),zIndex:0,display:'none'});slider.css({position:'relative',width:(slideWidth*3),height:slideHeight,minHeight:250,left:-slideWidth});slider.children(':eq('+start+')').css({display:'block'});if(options.autoSlide){play();if(options.pauseHover){slider.bind('mouseover',function(){pause()});slider.bind('mouseleave',function(){play()});}}
function play(){interval=setInterval(function(){animate('next');},options.autoSpeed);}
function pause(){clearInterval(interval);}
if(options.pagination){$('.'+ options.paginationClass+' li').each(function(i){if(i==start){$(this).addClass('current');}
$(this).attr('id','#'+(i));});$('.'+ options.paginationClass+' li').click(function(){var page=$(this).attr('id');paginate(page);});}
function paginate(page){animate('pagination',page);}
if(options.prevNext){right.click(function(){animate('next');});left.click(function(){animate('prev');});}
if(options.keyboard){$(window).keydown(function(e){var code=e.which?e.which:e.keyCode;if(code==37){animate('prev');}
if(code==39){animate('next');}});}
function animate(direction,page){if(!sliding){sliding=true;switch(direction){case'next':prev=current;next=current+ 1;next=numSlides===next?0:next;position=(options.direction==='horizontal'?slideWidth:slideHeight)*2;direction=-(options.direction==='horizontal'?slideWidth:slideHeight)*2;current=next;break;case'prev':prev=current;next=current- 1;next=next===-1?numSlides-1:next;position=0;direction=0;current=next;break;case'pagination':next=parseInt(page.replace('#',''));prev=parseInt($('.'+ options.paginationClass+' li.current').attr('id').match('[^#/]+$'),10);if(next>prev){position=(options.direction==='horizontal'?slideWidth:slideHeight)*2;direction=-(options.direction==='horizontal'?slideWidth:slideHeight)*2;}else if(next<prev){position=0;direction=0;}else{}
current=next;break;}
options.slideStart(next);sliding=true;if(options.direction==='horizontal'){slider.children(':eq('+next+')').css({left:position,display:'block'});}else{slider.children(':eq('+next+')').css({top:position,display:'block'});}
if(options.captions){slider.children().each(function(i){var caption=$(this).find('.caption');caption.css('bottom',-200);});slider.children(':eq('+next+')').find('.caption').stop().animate({bottom:0});}
if(options.direction==='horizontal'){slider.stop().animate({left:direction},options.slideSpeed,function(){slider.css({left:-slideWidth});slider.children(':eq('+next+')').css({left:slideWidth,zIndex:5});slider.children(':eq('+prev+')').css({left:slideWidth,display:'block',zIndex:0});options.slideEnd(next+1);sliding=false;});}else{slider.stop().animate({top:direction},options.slideSpeed,function(){slider.css({top:-slideHeight});slider.children(':eq('+next+')').css({top:slideHeight,zIndex:5});slider.children(':eq('+prev+')').css({top:slideHeight,display:'none',zIndex:0});options.slideEnd(next+1);sliding=false;});}
if(options.pagination){$('.'+ options.paginationClass+' li.current').removeClass('current');$('.'+ options.paginationClass+' li:eq('+next+')').addClass('current');}}}};$.fn.slider.options={sliderId:'slider',direction:'horizontal',prevNext:true,left:'#left',right:'#right',keyboard:false,autoSlide:false,pagination:true,pauseHover:true,autoSpeed:3000,slideSpeed:500,paginationClass:'slide-pagination',slideStart:function(){},slideEnd:function(){}};var Scoreboard=function(){this.data={};this.setData=function(){this.data={group:$('.scoreboard-link.active').prop('id').replace('sg-',''),game_id:fog.game.id,period:$('.score-period.active').data('period')};};this.board=function()
{this.setData();this.refresh('data','#sb-content');};this.resize=function(){$('.sb-userscore').each(function(){$('.sb-name',this).width($(this).innerWidth()-($('.sb-avatar',this).outerWidth()+ $('.sb-score',this).outerWidth()+ 12));});};this.user=function(){this.setData();this.refresh('my','#sb-you');};this.reload=function(){var t=this;t.board();t.user();if(this.timeout==true){setTimeout(function(){t.reload();},20000);}};this.refresh=function(url,target){fog.createElement('game/scoreboard/'+ url,this.data,target,true);this.resize();};this.timeout=true;this.reload();};var populated=false;var hideGameTypes=['unity3d','dir','dcr'];$(document.body).ready(function(){$('.switch-register-modal').off('click.modal-2-modal').on('click.modal-2-modal',function(){$('#login-modal').modal('hide');$('#register-modal').modal('show');});if($.inArray(fog.game.type,hideGameTypes)>-1){$('#game-holder-game').css({width:fog.game.width,height:fog.game.height,overflow:'hidden'});$('.modal').on('show',function(){$('#game-holder-game').css({width:0,height:0});});$('.modal').on('hidden',function(){$('#game-holder-game').css({width:fog.game.width,height:fog.game.height});});}
$('.modal form[data-type]').off('submit').on('submit',function(e){e.preventDefault();var t=this;$('.btn',this).prop('disabled','disabled');var success_text=$('.btn-success',this).html();$('.btn-success',this).html('<img src="/images/ajax-loader-white.gif"> '+ success_text);var data={};data.type=$(this).data('type');data.username=$('[name=username]',this).val();data.password=$('[name=password]',this).val();if(data.type==='register'){data.email=$('[name=email]',this).val();data.fbid=$('[name=fbid]',this).val();}
$.ajax({'url':'/ajax/auth/','data':data,'dataType':'json','type':'post','success':function(response){if(response.u_uid){if(fog.game.scoreboard==true){window.location.reload();return true;}
fog.user={uid:response.u_uid,username:response.u_username,avatar:response.u_avatar,avatar_type:response.u_avatar_type,email:response.u_email};rerender_page();}else{response.container='#'+ $('.status-message',t).attr('id');response.title=false;fog.message(response);$('.btn',t).removeProp('disabled');$('.btn-success',t).text(success_text);}}});});$('.facebook-login').off('click.fb').on('click.fb',function(){$t=$(this);$icon=$('.icon',this);$icon=$icon.length>0?$icon:$('.icon');$('#other-login-head').attr('disabled','true');$t.attr('disabled','true');$('.facebook-login').html('<img src="/images/ajax-loader-white.gif">');FB.login(function(response){if(response.authResponse){FB.api('/me',function(response){$.ajax({url:'/ajax/oauth',data:{fb_id:response.id,fb_user:response.username,fb_email:response.email,fb_token:FB.getAuthResponse()['accessToken']},type:'post',success:function(data){if(data.loggedin=='true'){fog.user.uid=data.u_uid;if(fog.game.scoreboard==true){window.location.reload();return true;}
rerender_page();$('.modal').modal('hide');}else{if(data.reason=='specify_username'){$('.modal').modal('hide');$('#register-modal').modal('show');if(populated!=true){$('#register-modal .info-message').html("Please choose a password for your new FOG account.");$('.info-message').show();$('#register-modal input[name=email]').val(response.email).after('<input type="hidden" name="fbid" value="'+response.id+'">');$('#register-modal .facebook-login').hide();populated=true;}}else{$('.modal').modal('hide');fog.message({message:'There was a problem logging you in.',type:'error'});}}
$('.facebook-login').html('<i class="icon-facebook"></i>');$('#other-login-head').removeAttr('disabled');$t.removeAttr('disabled');}});});}else{;$('.facebook-login').html('<i class="icon-facebook"></i>');$('#other-login-head').removeAttr('disabled');$t.removeAttr('disabled');}},{scope:'email,user_birthday,user_hometown,user_location,user_website,read_friendlists,publish_stream,create_event,rsvp_event,publish_actions,user_games_activity'});})});var rerender_page=function(){if(fog.action==='group'&&fog.page==='groups'){window.location.reload();return;}
fog.switchElement('/global/navmenu',{},'.navbar.navbar-inverse.navbar-fixed-top');fog.createElement('/global/stats',{},'#header-container',false,null,false,true);$('#user-modules').empty();fog.createElement('/home/recent',{module_title:'Recent Games',logged_in:true},'#user-modules');fog.createElement('/home/favorites',{module_title:'Favorite Games',logged_in:true},'#user-modules');if(window.scrollY>=70){$('#stats-navbar').css({zIndex:120,position:'fixed',width:'100%',top:40});$('#main-container').css('margin-top',25+ fog.ad.documentMargin);$('.dropdown-menu').css('margin-top',35);$('#head-avatar').css({width:30,height:30,top:5});$('.user-dropdown').css({marginTop:40});}
if(fog.game.id!=0)
{if(fog.api3)
{fog.api3.auth.login();}
if(fog.game.scoreboard==true){fog.switchElement('/game/scoreboard/holder',{'game_id':fog.game.id},'.scoreboard-element',function(){fog.scoreboard=new Scoreboard();});}else{$('.scoreboard-element').remove();}
fog.switchElement('/game/ratings',{'game_id':fog.game.id},'#game-rating-module');$('#addcomment').removeAttr('disabled').attr('placeholder','Please leave a comment...');$('#addcomment_submit').removeAttr('disabled');$('#create-comment').slideDown();$('#signup-tab').next().addClass('active');$('#signup-tab').remove();$('#register-wrapper').next().addClass('active');$('#register-wrapper').remove();}
$('.modal').modal('hide');fog.ad.updateSkinPosition();}